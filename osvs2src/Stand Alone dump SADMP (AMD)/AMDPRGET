         TITLE 'AMDPRGET -TRACE RECORD GET ROUTINE                     *00001000
                        '                                               00002000
AMDPRGET CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'AMDPRGET  78.074'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @11,0                                               0001 00011000
@PSTART  LA    @05,4095(,@11)                                      0001 00012000
         USING @PSTART,@11                                         0001 00013000
         USING @PSTART+4095,@05                                    0001 00014000
         ST    @13,@SA00001+4                                      0001 00015000
         LA    @14,@SA00001                                        0001 00016000
         ST    @14,8(,@13)                                         0001 00017000
         LR    @13,@14                                             0001 00018000
         EQUATES                                                        00019000
         COMMON                                                         00020000
         USING COMMON,COMBASE      BASE AMDPRCOM                        00021000
         SYNEPS                                                         00022000
         USING SYNTAX,R15          BASE AMDPRSYN EP-S                   00023000
         DCBD  DSORG=PS,DEVD=(DA,TA)                                    00024000
         USING IHADCB,R8           BASE DCB MAPPING MACRO               00025000
AMDPRGET  CSECT                                                         00026000
*                                      ADDRESS OF AMDPRTAB REG 12  0147 00027000
*                                      (COMBASE) IS POINTER TO     0147 00028000
*                                      AMDPRDMP COMMON CSECT       0147 00029000
*                                      (AMDPRCOM)              Y02014*/ 00030000
*   AEDITCBR=AEDITCB;               /* SET UP AMDPRTAB REG           */ 00031000
         L     AEDITCBR,AEDITCB                                    0148 00032000
*   GET='1'B;                       /* INDICATE AMDRPGET IN CONTROL  */ 00033000
         OI    GET(AEDITCBR),B'00100000'                           0149 00034000
*   IF TERM='1'B THEN               /* TEST TERM. REQUEST BIT        */ 00035000
*                                                                  0150 00036000
         TM    TERM(AEDITCBR),B'01000000'                          0150 00037000
         BNO   @RF00150                                            0150 00038000
*     /***************************************************************/ 00039000
*     /*                                                             */ 00040000
*     /* IF ON, CLOSED DOWN GET OPERATIONS                           */ 00041000
*     /*                                                             */ 00042000
*     /***************************************************************/ 00043000
*                                                                  0151 00044000
*CLOSDOWN:                                                         0151 00045000
*     DO;                                                          0151 00046000
CLOSDOWN DS    0H                                                  0152 00047000
*       IF FIRSTGET='0'B THEN       /* TEST IF GET WAS SET UP AT ALL */ 00048000
         TM    FIRSTGET,B'10000000'                                0152 00049000
         BZ    @RT00152                                            0152 00050000
*         GO TO GETDONE;            /* IF NOT, NO CLOSE DOWN       0153 00051000
*                                      REQUIRED, SO BRANCH TO EXIT   */ 00052000
*                                                                  0153 00053000
*       /*************************************************************/ 00054000
*       /*                                                           */ 00055000
*       /* IF GET WAS SET UP, TEST WHETHER DATA WAS EXTERNAL OR DUMP */ 00056000
*       /* TO DETERMINE HOW MUCH SHUT DOWN IS REQUIRED               */ 00057000
*       /*                                                           */ 00058000
*       /*************************************************************/ 00059000
*                                                                  0154 00060000
*       IF EXTTRC='0'B THEN         /* IF DUMP DATA SET BEING      0154 00061000
*                                      PROCESSED,                    */ 00062000
         TM    EXTTRC(AEDITCBR),B'00000100'                        0154 00063000
         BZ    @RT00154                                            0154 00064000
*         GO TO GETFREE;            /* BRANCH TO FREE TRACE BUILD  0155 00065000
*                                      AREA                          */ 00066000
*                                                                  0155 00067000
*       /*************************************************************/ 00068000
*       /*                                                           */ 00069000
*       /* IF PROCESSING EXTERNAL TRACE DATA SET IN PROCESS,         */ 00070000
*       /*                                                           */ 00071000
*       /*************************************************************/ 00072000
*                                                                  0156 00073000
*       RFY                                                        0156 00074000
*        (REG8) RSTD;               /* REG 8 FOR BASE OF DCB MAPPING    00075000
*                                      MACRO                   Y02014*/ 00076000
*       REG8=ADDR(GTFDCB);          /* LOAD REG 8 FOR EOF HANDLER,   */ 00077000
         LA    REG8,GTFDCB                                         0157 00078000
*       CLOSE='1'B;                 /* INDICATE CLOSE DOWN REQUIRED, */ 00079000
         OI    CLOSE,B'00000100'                                   0158 00080000
*       GO TO EOFHANDL;             /* BRANCH TO PROCESS EOF         */ 00081000
         B     EOFHANDL                                            0159 00082000
*     END CLOSDOWN;                                                0160 00083000
*   IF DDNAME=BLANKS THEN           /* DETERMINE TYPE OF DATA SET  0161 00084000
*                                      BEING PROCESSED               */ 00085000
@RF00150 CLC   DDNAME(8,AEDITCBR),BLANKS                           0161 00086000
         BE    @RT00161                                            0161 00087000
*     GO TO DUMPTRC;                /* IF DDNAME SLOT IN AMDPRTAB IS    00088000
*                                      BLANK, GO PROCESS DUMP DATA IF   00089000
*                                      DDNAME HAS BEEN SPECIFIED,  0162 00090000
*                                      FALL THROUGH TO PROCESS     0162 00091000
*                                      EXTERNAL TRACE DATA SET       */ 00092000
*   REG8=ADDR(GTFDCB);              /* POINT TO INPUT DCB            */ 00093000
         LA    REG8,GTFDCB                                         0163 00094000
*   IF FIRSTGET='1'B THEN           /* IF NOT FIRST TIME INTO      0164 00095000
*                                      AMDRGET,                      */ 00096000
         TM    FIRSTGET,B'10000000'                                0164 00097000
         BO    @RT00164                                            0164 00098000
*     GO TO GETREC;                 /* GO GET NEXT RECORD            */ 00099000
*                                                                  0166 00100000
*/********************************************************************  00101000
*                                                                    */ 00102000
*/*                                                                  */ 00103000
*/*  THE FOLLOWING CODE SETS UP TO PROCESS AN EXTERNAL GTF DATA SET. */ 00104000
*/*  THIS CODE IS EXECUTED ONCE PER EDIT CONTROL STATEMENT.          */ 00105000
*/*                                                                  */ 00106000
*/********************************************************************  00107000
*                                                                    */ 00108000
*                                                                  0166 00109000
*   EXTTRC='1'B;                    /* INDICATE EXTERNAL DATA SET IN    00110000
*                                      PROCESS                       */ 00111000
         OI    EXTTRC(AEDITCBR),B'00000100'                        0166 00112000
*   AEIOCT=ADDR(EIOCTL);            /* POINT TAB TO I/O CONTROL TABLE*/ 00113000
         LA    @10,EIOCTL                                          0167 00114000
         ST    @10,AEIOCT(,AEDITCBR)                               0167 00115000
*   SYNMSGA=ADDR(AMDPRE01);         /* POINT TO GET ERROR MESSAGE  0168 00116000
*                                      ARRAY IN MESSAGE CSECT -    0168 00117000
*                                      AMDPRFMG                      */ 00118000
         L     @10,AFMG(,AEDITCBR)                                 0168 00119000
         ST    @10,SYNMSGA                                         0168 00120000
*   REG2=ADDR(DDNAME);              /* POINT TO DDNAME FIELD IN    0169 00121000
*                                      AMDPRTAB                      */ 00122000
*                                                                  0169 00123000
         LA    REG2,DDNAME(,AEDITCBR)                              0169 00124000
*   /*****************************************************************/ 00125000
*   /*                                                               */ 00126000
*   /* ISSUE DEVTYPE TO VERIFY THAT DD CARD HAS BEEN GIVEN AND TO    */ 00127000
*   /* DETERMINE DEVICE TYPE OF ALLOCATED DEVICE                     */ 00128000
*   /*                                                               */ 00129000
*   /*****************************************************************/ 00130000
*                                                                  0170 00131000
*   GEN(DEVTYPE  (REG2),EIODEV);                                   0170 00132000
         DEVTYPE  (REG2),EIODEV                                         00133000
*   IF REG15^=0 THEN                                               0171 00134000
         LTR   REG15,REG15                                         0171 00135000
         BZ    @RF00171                                            0171 00136000
*     DO;                           /* IF RETURN CODE FROM DEVTYPE 0172 00137000
*                                      INDICATES NO DD CARD, EXIT  0172 00138000
*                                      WITH MESSAGE AMD220I          */ 00139000
*       REG2=SYNMSGA;               /* POINT TO AMD22OI ENTRY IN MSG    00140000
*                                      ARRAY - 1-ST MESSAGE          */ 00141000
         L     REG2,SYNMSGA                                        0173 00142000
*       MSGTEXT(27:34)=DDNAME;      /* MOVE SPECIFIED DD NAME TO MSG */ 00143000
         L     @10,MSGAD(,REG2)                                    0174 00144000
         MVC   MSGTEXT+26(8,@10),DDNAME(AEDITCBR)                  0174 00145000
*       GEN(OI  SWD,NOSTDMG);       /* REQUEST THAT MEESAGE AMD165I     00146000
*                                      NOT BE ISSUED                 */ 00147000
         OI  SWD,NOSTDMG                                                00148000
*       REG15=ASYNTAX;              /* POINT TO MESSAGE WRITER       */ 00149000
         L     REG15,ASYNTAX                                       0176 00150000
*       CALL SYNTAXA;               /* LINK TO MESSAGE WRITING     0177 00151000
*                                      ROUTINE REQUESTING 1-ST MSG.     00152000
*                                      IN LIST                       */ 00153000
         BAL   @14,SYNTAXA                                         0177 00154000
*/* BRANCH HERE TO REQUEST TERMINATION OF EDIT PROCESSING            */ 00155000
*                                                                  0178 00156000
*GETTERM:                                                          0178 00157000
*       TERM='1'B;                  /* SET TERM BIT IN AMDPRTAB      */ 00158000
GETTERM  OI    TERM(AEDITCBR),B'01000000'                          0178 00159000
*/* BRANCH HERE TO EXIT FROM AMDPRGET                                */ 00160000
*                                                                  0179 00161000
*GETDONE:                                                          0179 00162000
*       GET='0'B;                   /* RESET AMDPRGET PATH FLAG      */ 00163000
GETDONE  NI    GET(AEDITCBR),B'11011111'                           0179 00164000
*       RETURN;                     /* RETURN TO AMDPRFRM - THIS IS     00165000
*                                      THE ONLY EXIT FROM AMDPRGET   */ 00166000
@EL00001 L     @13,4(,@13)                                         0180 00167000
@EF00001 DS    0H                                                  0180 00168000
@ER00001 LM    @14,@12,12(@13)                                     0180 00169000
         BR    @14                                                 0180 00170000
*     END;                                                         0181 00171000
*   IF EIODEV(3)='20'X THEN         /* TEST FOR D/A DATA SET         */ 00172000
@RF00171 CLI   EIODEV+2,X'20'                                      0182 00173000
         BNE   @RF00182                                            0182 00174000
*     DAWRAP='1'B;                  /* IF SO, SET WRAP INDICATOR IN     00175000
*                                      EIOCT. WRAP POSITIONING IN  0183 00176000
*                                      PROCESS INDICATED BY PSITWRAP    00177000
*                                      BIT OFF                       */ 00178000
         OI    DAWRAP,B'00100000'                                  0183 00179000
*   EIOERCT=3;                      /* INITIALIZE ERROR COUNTER      */ 00180000
@RF00182 MVC   EIOERCT(2),@CH00198                                 0184 00181000
*   EIODCB=REG8;                    /* STORE DCB ADDRESS IN EIOCT    */ 00182000
         ST    REG8,EIODCB                                         0185 00183000
*   DCBDDNAM=DDNAME;                /* MOVE GIVEN DDNAME TO DCB      */ 00184000
         MVC   DCBDDNAM(8),DDNAME(AEDITCBR)                        0186 00185000
*   EIOX1=DCBRECFM;                 /* SAVE HIGH ORDER BYTE IN     0187 00186000
*                                      DCBEXLST FIELD                */ 00187000
         MVC   EIOX1(1),DCBRECFM                                   0187 00188000
*   DCBEXLST=ADDR(EIODCBEX);        /* STORE LIST ADDRESS IN DCB     */ 00189000
         LA    @10,EIODCBEX                                        0188 00190000
         ST    @10,DCBEXLST                                        0188 00191000
*   DCBRECFM=EIOX1;                 /* RESTORE HIGH BYTE             */ 00192000
         MVC   DCBRECFM(1),EIOX1                                   0189 00193000
*   EIODCBEX=ADDR(DCBEXIT);         /* SET EXIT ADDRESS IN EXIT LIST */ 00194000
         LA    @10,DCBEXIT                                         0190 00195000
         ST    @10,EIODCBEX                                        0190 00196000
*   EIOX1='85'X;                    /* SET EXIT LIST FLAGS           */ 00197000
         MVI   EIOX1,X'85'                                         0191 00198000
*   GEN(OPEN  ((R8),INPUT));        /* OPEN INPUT DCB - EXIT ROUTINE    00199000
*                                      TO PROCESS DURING OPEN        */ 00200000
         OPEN  ((R8),INPUT)                                             00201000
*   IF OPENFAIL='1'B THEN           /* TEST IF EXIT ROUTINE WAS      */ 00202000
         TM    OPENFAIL,B'01000000'                                0193 00203000
         BNO   @RF00193                                            0193 00204000
*     DO;                           /* SUCCESSFUL - IF NOT,          */ 00205000
*       GEN(CLOSE ((R8)));          /* ISSUE CLOSE                   */ 00206000
         CLOSE ((R8))                                                   00207000
*       GO TO UNSPIE;               /* IF NOT, GO TERMINATE EDIT     */ 00208000
         B     UNSPIE                                              0196 00209000
*     END;                                                         0197 00210000
*   FIRSTGET='1'B;                  /* INDICATE SET UP COMPLETE      */ 00211000
@RF00193 OI    FIRSTGET,B'10000000'                                0198 00212000
*                                                                  0199 00213000
*/********************************************************************  00214000
*                                                                    */ 00215000
*/*                                                                  */ 00216000
*/*  GET MAINLINE IF EXTERNAL TRACE DATA SET IS BEING PROCESSED      */ 00217000
*/*                                                                  */ 00218000
*/********************************************************************  00219000
*                                                                    */ 00220000
*/* BRANCH HERE TO GET LOGICAL TRACE RECORD                          */ 00221000
*                                                                  0199 00222000
*GETREC:                                                           0199 00223000
*   SYNADSW='0'B;                   /* RESET SYNAD ENTERED INDICATOR */ 00224000
GETREC   NI    SYNADSW,B'11111101'                                 0199 00225000
*   TRCCOUNT=TRCCOUNT+1;            /* UPDATE READ COUNT IN AMDPRCOM */ 00226000
         LA    @10,1                                               0200 00227000
         AL    @10,TRCCOUNT                                        0200 00228000
         ST    @10,TRCCOUNT                                        0200 00229000
*   RFY                                                            0201 00230000
*    (REG1) RSTD;                   /* REG 1 USED BY DATA MGT. LOCATE   00231000
*                                      MODE                    Y02014*/ 00232000
*   GEN(GET  (R8));                 /* GET LOGICAL TRACE RECORD      */ 00233000
*                                                                  0202 00234000
         GET  (R8)                                                      00235000
*   /*****************************************************************/ 00236000
*   /*                                                               */ 00237000
*   /* LOCATE MODE RETURNS RECORD ADDRESS IN REG 1 LOCATE MODE IS    */ 00238000
*   /* USED SO THAT LITTLE-LL CAN BE VERIFIED                        */ 00239000
*   /*                                                               */ 00240000
*   /*****************************************************************/ 00241000
*                                                                  0203 00242000
*   REG2=REG1->LLVAL;               /* PICK UP LITTLE-LL VALUE       */ 00243000
         LH    REG2,LLVAL(,REG1)                                   0203 00244000
*   IF REG2<4|                      /* LL MUST BE GREATER THAN 4 AND    00245000
*                                      LESS THAN MAXIMUM TRACE RECORD   00246000
*                                      SIZE                          */ 00247000
*       REG2>284 THEN                                              0204 00248000
*                                                                  0204 00249000
         C     REG2,@CF00065                                       0204 00250000
         BL    @RT00204                                            0204 00251000
         C     REG2,@CF01337                                       0204 00252000
         BNH   @RF00204                                            0204 00253000
@RT00204 DS    0H                                                  0205 00254000
*     /***************************************************************/ 00255000
*     /*                                                             */ 00256000
*     /* LL ERROR, PRINT MESSAGE ON PRINTER DATA SET AND TERMINATE   */ 00257000
*     /* EDIT FUNCTION                                               */ 00258000
*     /*                                                             */ 00259000
*     /***************************************************************/ 00260000
*                                                                  0205 00261000
*GBADLL:                                                           0205 00262000
*     DO;                                                          0205 00263000
GBADLL   DS    0H                                                  0206 00264000
*       GEN(BRWRITE  SKIP,IMM);     /* SKIP TO NEW PAGE M0866        */ 00265000
         BRWRITE  SKIP,IMM                                              00266000
*       LLERR(29:36)=DDNAME;        /* MOVE DDNAME TO MESSAGE        */ 00267000
         MVC   LLERR+28(8),DDNAME(AEDITCBR)                        0207 00268000
*       REG2=DCBBLKCT;              /* GET BAD BLOCK NUMBER FROM DCB */ 00269000
         L     REG2,DCBBLKCT                                       0208 00270000
*       GEN(CVD  REG2,WORK1);       /* CONVERT TO DEC IN COM WORK  0209 00271000
*                                      AREA                          */ 00272000
*                                                                  0209 00273000
         CVD  REG2,WORK1                                                00274000
*       /*************************************************************/ 00275000
*       /*                                                           */ 00276000
*       /* POINT TO FIELD IN MESSAGE TO RECEIVE BLOCK NUMBER         */ 00277000
*       /*                                                           */ 00278000
*       /*************************************************************/ 00279000
*                                                                  0210 00280000
*       REG2=ADDR(LLERR(48));                                      0210 00281000
         LA    REG2,LLERR+47                                       0210 00282000
*       GEN;                                                       0211 00283000
*                                                                  0211 00284000
         UNPK  0(6,REG2),WORK1(8)     CONVERT TO CHAR IN MESSAGE        00285000
         OI    5(REG2),X'F0'          FIXED SIGN DIGIT                  00286000
*       /*************************************************************/ 00287000
*       /*                                                           */ 00288000
*       /* SUPPRESS LEADING ZEROS IN BLOCK NUMBER                    */ 00289000
*       /*                                                           */ 00290000
*       /*************************************************************/ 00291000
*                                                                  0212 00292000
*       DO I=48 TO 53;                                             0212 00293000
*                                                                  0212 00294000
         LA    I,48                                                0212 00295000
@DL00212 DS    0H                                                  0213 00296000
*         /***********************************************************/ 00297000
*         /*                                                         */ 00298000
*         /* ONCE NOT ZERO, GET OUT                                  */ 00299000
*         /*                                                         */ 00300000
*         /***********************************************************/ 00301000
*                                                                  0213 00302000
*         IF LLERR(I)^='0' THEN                                    0213 00303000
         LA    @10,LLERR-1(I)                                      0213 00304000
         CLI   0(@10),C'0'                                         0213 00305000
         BNE   @RT00213                                            0213 00306000
*           GO TO BADLLMSG;                                        0214 00307000
*                                                                  0214 00308000
*         /***********************************************************/ 00309000
*         /*                                                         */ 00310000
*         /* CHANGE LEADING ZERO TO BLANK                            */ 00311000
*         /*                                                         */ 00312000
*         /***********************************************************/ 00313000
*                                                                  0215 00314000
*         ELSE                                                     0215 00315000
*           LLERR(I)=' ';                                          0215 00316000
         LA    @10,LLERR-1(I)                                      0215 00317000
         MVI   0(@10),C' '                                         0215 00318000
*       END;                                                       0216 00319000
*                                                                  0216 00320000
         AL    I,@CF00076                                          0216 00321000
         C     I,@CF01251                                          0216 00322000
         BNH   @DL00212                                            0216 00323000
*       /*************************************************************/ 00324000
*       /*                                                           */ 00325000
*       /* MOVE MESSAGE TO CURRENT OUTPUT BUFFER                     */ 00326000
*       /*                                                           */ 00327000
*       /*************************************************************/ 00328000
*                                                                  0217 00329000
*BADLLMSG:                                                         0217 00330000
*       OUTBUF(1:53)=LLERR;                                        0217 00331000
BADLLMSG L     @10,CURBUF                                          0217 00332000
         MVC   OUTBUF(53,@10),LLERR                                0217 00333000
*       OUTBUF(55:82)=TERMSG;       /* IND. EDIT TERMINATING         */ 00334000
         MVC   OUTBUF+54(28,@10),TERMSG                            0218 00335000
*       GEN(BRWRITE  1);            /* WRITE BAD LL MESSAGE          */ 00336000
         BRWRITE  1                                                     00337000
*       CLOSE='1'B;                 /* REQUEST TERMINATION BY EOF  0220 00338000
*                                      HANDLER                       */ 00339000
         OI    CLOSE,B'00000100'                                   0220 00340000
*       GO TO EOFHANDL;             /* SHUT DOWN                     */ 00341000
         B     EOFHANDL                                            0221 00342000
*     END GBADLL;                                                  0222 00343000
*                                                                  0222 00344000
*   /*****************************************************************/ 00345000
*   /*                                                               */ 00346000
*   /* LL-FIELD IS OK, POINT CURREC AT RECORD                  Y02014*/ 00347000
*   /*                                                               */ 00348000
*   /*****************************************************************/ 00349000
*                                                                  0223 00350000
*   RECDLL=REG2;                    /* SAVE RECORD LENGTH      Y02014*/ 00351000
@RF00204 STCM  REG2,7,RECDLL(AEDITCBR)                             0223 00352000
*   CURREC=REG1;                    /* PT CURREC TO DM BUFF REC    0224 00353000
*                                                              Y02014*/ 00354000
         ST    REG1,CURREC(,AEDITCBR)                              0224 00355000
*   RFY                                                            0225 00356000
*    (REG1) UNRSTD;                 /*                         Y02014*/ 00357000
*   IF SYNADSW='0'B THEN            /* TEST FOR SYNAD ROUTINE HAVING    00358000
*                                      BEEN CALLED                   */ 00359000
         TM    SYNADSW,B'00000010'                                 0226 00360000
         BNZ   @RF00226                                            0226 00361000
*     EIOERCT=3;                    /* RESET ERROR COUNT IF NOT      */ 00362000
         MVC   EIOERCT(2),@CH00198                                 0227 00363000
*   IF DAWRAP='0'B THEN             /* TEST FOR PROCESSING WRAP DATA    00364000
*                                      SET                           */ 00365000
@RF00226 TM    DAWRAP,B'00100000'                                  0228 00366000
         BZ    @RT00228                                            0228 00367000
*     GO TO GETDONE;                /* IF NOT, GET REQUIREMENTS ARE     00368000
*                                      COMPLETE, GO RETURN TO      0229 00369000
*                                      AMDPRFRM                      */ 00370000
*   IF PSITWRAP='0'B THEN           /* TEST FOR WRAP POSITIONING   0230 00371000
*                                      REQUIRED                      */ 00372000
         TM    PSITWRAP,B'00010000'                                0230 00373000
         BZ    @RT00230                                            0230 00374000
*     GO TO POSIT;                  /* IF SO, BRANCH TO POSITIONING     00375000
*                                      ROUTINE                       */ 00376000
*                                                                  0231 00377000
*   /*****************************************************************/ 00378000
*   /*                                                               */ 00379000
*   /* TEST FOR TIME-STAMP RECORD                                    */ 00380000
*   /*                                                               */ 00381000
*   /*****************************************************************/ 00382000
*                                                                  0232 00383000
*   IF RECAID='00'X&                /* TIME-STAMP RECORD INDENTIFIED    00384000
*                                      BY AID '00'X AND              */ 00385000
*       RECFID='01'X THEN           /* FID '04'X                     */ 00386000
         L     @10,CURREC(,AEDITCBR)                               0232 00387000
         CLI   RECAID(@10),X'00'                                   0232 00388000
         BNE   @RF00232                                            0232 00389000
         CLI   RECFID(@10),X'01'                                   0232 00390000
         BNE   @RF00232                                            0232 00391000
*TESTTIME:                                                         0233 00392000
*     DO;                                                          0233 00393000
*                                                                  0233 00394000
TESTTIME DS    0H                                                  0234 00395000
*       /*************************************************************/ 00396000
*       /*                                                           */ 00397000
*       /* TEST VALUE OF TIME-STAMP TO DETERMINE IF LOGICAL END OF   */ 00398000
*       /* DATA SET HAS BEEN ENCOUNTERED. TIME VALUE WILL DECREASING */ 00399000
*       /* AT POINT AT WHICH WRAP STOPPED FIRST COMPARE DATES        */ 00400000
*       /*                                                           */ 00401000
*       /*************************************************************/ 00402000
*                                                                  0234 00403000
*       IF RECTOD<EIOTOD THEN                                      0234 00404000
*                                                                  0234 00405000
         L     @10,CURREC(,AEDITCBR)                               0234 00406000
         CLC   RECTOD(8,@10),EIOTOD                                0234 00407000
         BNL   @RF00234                                            0234 00408000
*         /***********************************************************/ 00409000
*         /*                                                         */ 00410000
*         /* LOGOICAL END-OF FILE HAS BEEN FOUND                     */ 00411000
*         /*                                                         */ 00412000
*         /***********************************************************/ 00413000
*                                                                  0235 00414000
*LOGEND:                                                           0235 00415000
*         DO;                                                      0235 00416000
LOGEND   DS    0H                                                  0236 00417000
*           CLOSE='1'B;             /* INDICATE DONE PROCESSING      */ 00418000
         OI    CLOSE,B'00000100'                                   0236 00419000
*           GO TO EOFHANDL;         /* GO TO EOF HANDLER TO CLOSE  0237 00420000
*                                      DOWN                          */ 00421000
         B     EOFHANDL                                            0237 00422000
*         END LOGEND;                                              0238 00423000
*                                                                  0238 00424000
*       /*************************************************************/ 00425000
*       /*                                                           */ 00426000
*       /* IF TIME DOES NOT DECREASE, SAVE TIME VALUE AND RETURN TO  */ 00427000
*       /* CALLER                                                    */ 00428000
*       /*                                                           */ 00429000
*       /*************************************************************/ 00430000
*                                                                  0239 00431000
*       ELSE                                                       0239 00432000
*SAVETME:                                                          0239 00433000
*         DO;                                                      0239 00434000
*                                                                  0239 00435000
@RF00234 DS    0H                                                  0239 00436000
SAVETME  DS    0H                                                  0240 00437000
*           /*********************************************************/ 00438000
*           /*                                                       */ 00439000
*           /* SAVE TIME FROM CURRENT RECORD                         */ 00440000
*           /*                                                       */ 00441000
*           /*********************************************************/ 00442000
*                                                                  0240 00443000
*           EIOTIME=RECTOD;                                        0240 00444000
*                                                                  0240 00445000
         L     @10,CURREC(,AEDITCBR)                               0240 00446000
         MVC   EIOTIME(8),RECTOD(@10)                              0240 00447000
*           /*********************************************************/ 00448000
*           /*                                                       */ 00449000
*           /* GO EXIT TO CALLER                                     */ 00450000
*           /*                                                       */ 00451000
*           /*********************************************************/ 00452000
*                                                                  0241 00453000
*           GO TO GETDONE;                                         0241 00454000
         B     GETDONE                                             0241 00455000
*         END SAVETME;                                             0242 00456000
*     END TESTTIME;                                                0243 00457000
*                                                                  0243 00458000
*   /*****************************************************************/ 00459000
*   /*                                                               */ 00460000
*   /* IF NOT TIME-STAMP RECORD RETURN TO CALLER                     */ 00461000
*   /*                                                               */ 00462000
*   /*****************************************************************/ 00463000
*                                                                  0244 00464000
*   ELSE                                                           0244 00465000
*     GO TO GETDONE;                /* GO EXIT TO CALLER             */ 00466000
*                                                                  0245 00467000
*/********************************************************************  00468000
*                                                                    */ 00469000
*/*                                                                  */ 00470000
*/*  POSITIONING SUBROUTINE.  THIS ROUTINE POSITIONS A GTF WRAP DATA */ 00471000
*/*  SET TO THE TIME STAMP RECORD WITH THE LOWEST TIME VALUE.        */ 00472000
*/*  THIS RECORD MARKS THE LOGICAL BEGINNING OF THE TRACE DATA.      */ 00473000
*/*                                                                  */ 00474000
*/********************************************************************  00475000
*                                                                    */ 00476000
*/* BRANCH HERE IF POSITIONING WRAP DATA SET IS IN PROCESS           */ 00477000
*                                                                  0245 00478000
*POSIT:                                                            0245 00479000
*   IF RECAID='00'X&                /* TEST FOR TIME-STAMP RECORD BY    00480000
*                                      AID OF '00'X AND              */ 00481000
*       RECFID='01'X THEN           /* FID OF '04'X                  */ 00482000
POSIT    L     @10,CURREC(,AEDITCBR)                               0245 00483000
         CLI   RECAID(@10),X'00'                                   0245 00484000
         BNE   @RF00245                                            0245 00485000
         CLI   RECFID(@10),X'01'                                   0245 00486000
         BNE   @RF00245                                            0245 00487000
*TIMEREC:                                                          0246 00488000
*     DO;                                                          0246 00489000
TIMEREC  DS    0H                                                  0247 00490000
*       IF FRSTWRAP='0'B THEN       /* TEST FOR FIRST TIME INTO    0247 00491000
*                                      POSITIONING ROUTINE           */ 00492000
         TM    FRSTWRAP,B'00001000'                                0247 00493000
         BNZ   @RF00247                                            0247 00494000
*         DO;                                                      0248 00495000
*                                                                  0248 00496000
*           /*********************************************************/ 00497000
*           /*                                                       */ 00498000
*           /* SAVE TIME FROM CURRENT RECORD                         */ 00499000
*           /*                                                       */ 00500000
*           /*********************************************************/ 00501000
*                                                                  0249 00502000
*           EIOTIME=RECTOD;                                        0249 00503000
         L     @10,CURREC(,AEDITCBR)                               0249 00504000
         MVC   EIOTIME(8),RECTOD(@10)                              0249 00505000
*           FRSTWRAP='1'B;          /* SET FIRST TIME POSIT. SWITCH  */ 00506000
         OI    FRSTWRAP,B'00001000'                                0250 00507000
*           GO TO GETREC;           /* GO SEARCH FOR NEXT TIME-STAMP    00508000
*                                      RECORD                        */ 00509000
         B     GETREC                                              0251 00510000
*         END;                      /* END FIRST-TIME POSITIONING  0252 00511000
*                                      PROCESSING                    */ 00512000
*                                                                  0252 00513000
*       /*************************************************************/ 00514000
*       /*                                                           */ 00515000
*       /* IF NOT FIRST TIME INTO POSITIONING ROUTINE, COMPARE NEW   */ 00516000
*       /* TIME VALUE TO SAVED TIME, LOOKING FOR POINT IN DATA SET   */ 00517000
*       /* WHERE TIME VALUES DECREASE                                */ 00518000
*       /*                                                           */ 00519000
*       /*************************************************************/ 00520000
*                                                                  0253 00521000
*       ELSE                                                       0253 00522000
*         DO;                                                      0253 00523000
@RF00247 DS    0H                                                  0254 00524000
*           IF RECTOD<EIOTOD THEN                                  0254 00525000
         L     @10,CURREC(,AEDITCBR)                               0254 00526000
         CLC   RECTOD(8,@10),EIOTOD                                0254 00527000
         BNL   @RF00254                                            0254 00528000
*DECFND:                                                           0255 00529000
*             DO;                   /* TIME DECREASES - LOGICAL    0255 00530000
*                                      BEGINNING HAS BEEN FOUND      */ 00531000
DECFND   DS    0H                                                  0256 00532000
*               PSITWRAP='1'B;      /* INDICATE POSITIONING COMPLETE */ 00533000
*                                                                  0256 00534000
         OI    PSITWRAP,B'00010000'                                0256 00535000
*               /*****************************************************/ 00536000
*               /*                                                   */ 00537000
*               /* SAVE TIME FROM CURRENT RECORD                     */ 00538000
*               /*                                                   */ 00539000
*               /*****************************************************/ 00540000
*                                                                  0257 00541000
*               EIOTIME=RECTOD;                                    0257 00542000
         L     @10,CURREC(,AEDITCBR)                               0257 00543000
         MVC   EIOTIME(8),RECTOD(@10)                              0257 00544000
*               GO TO GETDONE;      /* GO RETURN TO CALLER           */ 00545000
         B     GETDONE                                             0258 00546000
*             END DECFND;                                          0259 00547000
*                                                                  0259 00548000
*           /*********************************************************/ 00549000
*           /*                                                       */ 00550000
*           /* IF TIME DOES NOT DECREASE, SAVE NEW TIME AND CONTINUE */ 00551000
*           /* SCAN                                                  */ 00552000
*           /*                                                       */ 00553000
*           /*********************************************************/ 00554000
*                                                                  0260 00555000
*           ELSE                                                   0260 00556000
*             DO;                                                  0260 00557000
*                                                                  0260 00558000
@RF00254 DS    0H                                                  0261 00559000
*               /*****************************************************/ 00560000
*               /*                                                   */ 00561000
*               /* SAVE TIME FROM CURRENT RECORD                     */ 00562000
*               /*                                                   */ 00563000
*               /*****************************************************/ 00564000
*                                                                  0261 00565000
*               EIOTIME=RECTOD;                                    0261 00566000
         L     @10,CURREC(,AEDITCBR)                               0261 00567000
         MVC   EIOTIME(8),RECTOD(@10)                              0261 00568000
*               GO TO GETREC;       /* GO READ FOR NEXT TIME-STAMP 0262 00569000
*                                      RECORD                        */ 00570000
         B     GETREC                                              0262 00571000
*             END;                                                 0263 00572000
*         END;                                                     0264 00573000
*     END TIMEREC;                                                 0265 00574000
*   ELSE                                                           0266 00575000
*     GO TO GETREC;                 /* IF NOT TIME-STAMP RECORD LOOP    00576000
*                                      BACK TO GET NEXT RECORD       */ 00577000
*                                                                  0267 00578000
*/********************************************************************  00579000
*                                                                    */ 00580000
*/*                                                                  */ 00581000
*/*  DCB EXIT ROUTINE.  THE PURPOSE OF THIS ROUTINE IS TO            */ 00582000
*/*  SET THE DCBBLKSI AND THE DCBBUFNO AND TO OBTAIN THE             */ 00583000
*/*  INPUT BUFFER AREA.                                              */ 00584000
*/*                                                                  */ 00585000
*/********************************************************************  00586000
*                                                                    */ 00587000
*                                                                  0267 00588000
*DCBEXIT:                                                          0267 00589000
*   EIOR14SV=REG14;                 /* SAVE RETURN POINT ADDRESS     */ 00590000
DCBEXIT  ST    REG14,EIOR14SV                                      0267 00591000
*   DCBBLKSI=4096;                  /* 4K BUFFERS WANTED       Y02014*/ 00592000
         L     @10,@CF01192                                        0268 00593000
         STH   @10,DCBBLKSI                                        0268 00594000
*   DCBLRECL=4000;                  /*                       @YM04522*/ 00595000
         MVC   DCBLRECL(2),@CH01482                                0269 00596000
*   DCBBUFNO=3;                     /* 3 BUFFERS WANTED        Y02014*/ 00597000
         LA    @04,3                                               0270 00598000
         STC   @04,DCBBUFNO                                        0270 00599000
*   REG2=DCBBLKSI*DCBBUFNO;         /* COMPUTE AMOUNT OF STORAGE   0271 00600000
*                                      NEEDED FOR BUFFERS            */ 00601000
         LR    @01,@10                                             0271 00602000
         MR    @00,@04                                             0271 00603000
         LR    REG2,@01                                            0271 00604000
*   REG1=DCBBLKSI//4;               /* BLKSIZE MULTIPLE OF 4?      0272 00605000
*                                                            @ZA28699*/ 00606000
         LR    @00,@10                                             0272 00607000
         SRDA  @00,32                                              0272 00608000
         D     @00,@CF00065                                        0272 00609000
         LR    REG1,@00                                            0272 00610000
*   RFY                                                            0273 00611000
*    (REG1) RSTD;                   /* KEEP IT FROM COMPILER @ZA28699*/ 00612000
*   IF REG1^=0 THEN                 /* IF NOT, ROUND UP FOR  @ZA28699*/ 00613000
         LTR   REG1,REG1                                           0274 00614000
         BZ    @RF00274                                            0274 00615000
*     REG2=REG2+((4-REG1)*DCBBUFNO);/* EACH BUFFER           @ZA28699*/ 00616000
         LA    @07,4                                               0275 00617000
         SLR   @07,REG1                                            0275 00618000
         MR    @06,@04                                             0275 00619000
         ALR   REG2,@07                                            0275 00620000
*   RFY                                                            0276 00621000
*    (REG1) UNRSTD;                 /* GIVE IT BACK TO CMPLR @ZA28699*/ 00622000
@RF00274 DS    0H                                                  0277 00623000
*   REG2=REG2+8;                    /* ACCOUNT FOR BUFFER CONTROL BLK*/ 00624000
         AL    REG2,@CF00039                                       0277 00625000
*   LNGTH1=REG2;                    /* LNGTH PARM FOR GETMAIN        */ 00626000
         ST    REG2,LNGTH1                                         0278 00627000
*   LNGTH2=REG2;                    /* LNGTH PARM FOR GETMAIN        */ 00628000
         ST    REG2,LNGTH2                                         0279 00629000
*   EIOSTOR=REG2|'01000000'X;       /* STORE TOTAL LENGTH IN CONTROL    00630000
*                                      TABLE                         */ 00631000
*                                                                  0280 00632000
         LR    @10,REG2                                            0280 00633000
         O     @10,@CF01483                                        0280 00634000
         ST    @10,EIOSTOR                                         0280 00635000
*   /*****************************************************************/ 00636000
*   /*                                                               */ 00637000
*   /* ISSUE CONDITONAL GETMAIN FOR BUFFERS                          */ 00638000
*   /*                                                               */ 00639000
*   /*****************************************************************/ 00640000
*                                                                  0281 00641000
*   RFY                                                            0281 00642000
*    (REG1,                                                        0281 00643000
*     REG0) RSTD;                   /*                         Y02014*/ 00644000
*   GEN(GETMAIN VC,LA=LNGTH,A=BUFADDR,SP=1);                       0282 00645000
         GETMAIN VC,LA=LNGTH,A=BUFADDR,SP=1                             00646000
*   IF REG15^=0 THEN                                               0283 00647000
         LTR   REG15,REG15                                         0283 00648000
         BZ    @RF00283                                            0283 00649000
*     DO;                           /* TEST FOR INSUFFICIENT STORAGE */ 00650000
*       REG2=SYNMSGA+8;             /* POINT TO AMD225I ENTRY IN MSG    00651000
*                                      ARRAY                         */ 00652000
*                                                                  0285 00653000
         LA    REG2,8                                              0285 00654000
         AL    REG2,SYNMSGA                                        0285 00655000
*       /*************************************************************/ 00656000
*       /*                                                           */ 00657000
*       /* REQUEST THAT MESSAGE AMD165I NOT BE ISSUED                */ 00658000
*       /*                                                           */ 00659000
*       /*************************************************************/ 00660000
*                                                                  0286 00661000
*NOSPACEM:                                                         0286 00662000
*       GEN(OI  SWD,NOSTDMG);                                      0286 00663000
NOSPACEM OI  SWD,NOSTDMG                                                00664000
*       REG15=ASYNTAX;              /* POINT TO MESSAGE WRITER       */ 00665000
         L     REG15,ASYNTAX                                       0287 00666000
*       CALL SYNTAXC;               /* LINK TO MESSAGE WRITER - C  0288 00667000
*                                      INDICATES THIRD MESSAGE IN  0288 00668000
*                                      ARRAY                         */ 00669000
*                                                                  0288 00670000
         BAL   @14,SYNTAXC                                         0288 00671000
*       /*************************************************************/ 00672000
*       /*                                                           */ 00673000
*       /* SET UP BUFNO AND BLKSIZE TO AVOID 80A IN OPEN             */ 00674000
*       /*                                                           */ 00675000
*       /*************************************************************/ 00676000
*                                                                  0289 00677000
*       DCBBUFNO=1;                                                0289 00678000
         MVI   DCBBUFNO,X'01'                                      0289 00679000
*       DCBBLKSI=8;                                                0290 00680000
         MVC   DCBBLKSI(2),@CH00039                                0290 00681000
*       OPENFAIL='1'B;              /* SIGNAL OPEN FAILED            */ 00682000
         OI    OPENFAIL,B'01000000'                                0291 00683000
*       GO TO EXITDONE;             /* GO RETURN TO OPEN ROUTINES    */ 00684000
         B     EXITDONE                                            0292 00685000
*     END;                                                         0293 00686000
*                                                                  0293 00687000
*   /*****************************************************************/ 00688000
*   /*                                                               */ 00689000
*   /* BUILD PARMS FOR BUFFER BUILD                                  */ 00690000
*   /*                                                               */ 00691000
*   /*****************************************************************/ 00692000
*                                                                  0294 00693000
*   WORK1(1)='00'X;                 /* CLEAR HIGH ORDER BYTE         */ 00694000
@RF00283 MVI   WORK1,X'00'                                         0294 00695000
*   WORK1(2)=DCBBUFNO;              /* NUMBER OF BUFFERS             */ 00696000
         IC    @10,DCBBUFNO                                        0295 00697000
         STC   @10,WORK1+1                                         0295 00698000
*   WORK1(3:4)=DCBBLKSI;            /* SIZE OF EACH BUFFER           */ 00699000
         MVC   WORK1+2(2),DCBBLKSI                                 0296 00700000
*   REG0=WORK1(1:4);                /* LOAD PARAMETER REG            */ 00701000
         ICM   REG0,15,WORK1                                       0297 00702000
*   REG1=BUFFER;                    /* REG1 CONTAINS ADDR BUFF Y02014*/ 00703000
         L     REG1,BUFFER                                         0298 00704000
*   DCBBUFCB=REG1;                  /* SET BUFFER CONTROL BLOCK ADDR    00705000
*                                      IN DCB                        */ 00706000
         ST    REG1,DCBBUFCB                                       0299 00707000
*   DCBBUFNO=WORK1(2);              /* RESTORE BUFFER COUNT          */ 00708000
         IC    @10,WORK1+1                                         0300 00709000
         STC   @10,DCBBUFNO                                        0300 00710000
*   GEN(BUILD  (1),(0));            /* BUILD BUFFER AREA             */ 00711000
         BUILD  (1),(0)                                                 00712000
*/* BRANCH HERE TO COMPLETE DCB EXIT PROCESSING                      */ 00713000
*                                                                  0302 00714000
*EXITDONE:                                                         0302 00715000
*   REG14=EIOR14SV;                 /* RESTORE REG 14 VALUE          */ 00716000
EXITDONE L     REG14,EIOR14SV                                      0302 00717000
*   GEN(BR  R14);                   /* RETURN TO OPEN - EXIT COMPLETE*/ 00718000
         BR  R14                                                        00719000
*   RFY                                                            0304 00720000
*    (REG0,                                                        0304 00721000
*     REG1) UNRSTD;                                                0304 00722000
*                                                                  0305 00723000
*/********************************************************************  00724000
*                                                                    */ 00725000
*/*                                                                  */ 00726000
*/*  SYNAD ROUTINE.  THIS ROUTINE ISSUES SYNADAF AND PRINTS THE ERROR*/ 00727000
*/*  ANALYSIS BUFFER.  THE CONSECUTIVE ERROR COUNT IS DECREMENTED.   */ 00728000
*/*  IF THIS BECOMES 0, EDIT EXECUTION IS TERMINATED.                */ 00729000
*/*                                                                  */ 00730000
*/********************************************************************  00731000
*                                                                    */ 00732000
*                                                                  0305 00733000
*SYNAD:                                                            0305 00734000
*   EIOR14SV=REG14;                 /* SAVE RETURN ADDRESS           */ 00735000
SYNAD    ST    REG14,EIOR14SV                                      0305 00736000
*   GEN(SYNADAF  ACSMETH=QSAM);     /* GET ERROR DESCRIPTION         */ 00737000
         SYNADAF  ACSMETH=QSAM                                          00738000
*   RFY                                                            0307 00739000
*    (REG1) RSTD;                   /* REG 1 REST IN EXIT RTN  Y02014*/ 00740000
*   REG2=REG1;                      /* SAVE ADDRESS OF MESSAGE BUFFER*/ 00741000
         LR    REG2,REG1                                           0308 00742000
*   SYNADSW='1'B;                   /* INDICATE SYNAD ROUTINE ENTERED   00743000
*                                      SO MAINLINE WILL NOT RESET  0309 00744000
*                                      ERROR COUNT                   */ 00745000
         OI    SYNADSW,B'00000010'                                 0309 00746000
*   EIOERCT=EIOERCT-1;              /* DECREMENT ERROR COUNT         */ 00747000
*                                                                  0310 00748000
         LH    @10,EIOERCT                                         0310 00749000
         BCTR  @10,0                                               0310 00750000
         STH   @10,EIOERCT                                         0310 00751000
*   /*****************************************************************/ 00752000
*   /*                                                               */ 00753000
*   /* CONSTRUCT I/O ERROR MESSAGE AND INDICATE ACTION               */ 00754000
*   /*                                                               */ 00755000
*   /*****************************************************************/ 00756000
*                                                                  0311 00757000
*   IF EIOERCT=2 THEN               /* IF APPARENT FIRST ERROR,      */ 00758000
         C     @10,@CF00109                                        0311 00759000
         BNE   @RF00311                                            0311 00760000
*     GEN(BRWRITE  SKIP,IMM);       /* SKIP TO NEW PAGE              */ 00761000
         BRWRITE  SKIP,IMM                                              00762000
*   OUTBUF(1:12)=ERMSG;             /* MOVE I/O ERROR MESSAGE TO   0313 00763000
*                                      OUTPUT BUFFER                 */ 00764000
@RF00311 L     @10,CURBUF                                          0313 00765000
         MVC   OUTBUF(12,@10),ERMSG                                0313 00766000
*   OUTBUF(14:21)=DDNAME;           /* MOVE DD NAME TO BUFFER        */ 00767000
         MVC   OUTBUF+13(8,@10),DDNAME(AEDITCBR)                   0314 00768000
*   IF EIOERCT=0 THEN               /* TEST ERROR COUNT FOR ZERO     */ 00769000
         LH    @04,EIOERCT                                         0315 00770000
         LTR   @04,@04                                             0315 00771000
         BNZ   @RF00315                                            0315 00772000
*     OUTBUF(23:50)=TERMSG;         /* IF ZERO, MOVE TERMINATION   0316 00773000
*                                      MESSAGE TO OUTPUT BUFFER      */ 00774000
         MVC   OUTBUF+22(28,@10),TERMSG                            0316 00775000
*   ELSE                                                           0317 00776000
*     OUTBUF(23:34)=CONMSG;         /* IF ERROR COUNT NOT YET ZERO,     00777000
*                                      MOVE CONTINUING MESSAGE TO  0317 00778000
*                                      OUTPUT BUFFER                 */ 00779000
         B     @RC00315                                            0317 00780000
@RF00315 L     @10,CURBUF                                          0317 00781000
         MVC   OUTBUF+22(12,@10),CONMSG                            0317 00782000
*   RFY                                                            0318 00783000
*    (REG1) UNRSTD;                 /*                         Y02014*/ 00784000
@RC00315 DS    0H                                                  0319 00785000
*   GEN(BRWRITE  1);                /* PRINT MESSAGE ON PRINTER DATA    00786000
*                                      SET                           */ 00787000
         BRWRITE  1                                                     00788000
*   OUTBUF=SYNADBUF;                /* MOVE SYNADAF MESSAGE TO OUTPUT   00789000
*                                      AREA - SYNADBUF BASED ON REG 2*/ 00790000
         L     @10,CURBUF                                          0320 00791000
         MVI   OUTBUF+77(@10),C' '                                 0320 00792000
         MVC   OUTBUF+78(54,@10),OUTBUF+77(@10)                    0320 00793000
         MVC   OUTBUF(77,@10),SYNADBUF(REG2)                       0320 00794000
*   GEN;                                                           0321 00795000
    BRWRITE  2                 /*  WRITE SYNADAF MSG ON PRINTER DATA */ 00796000
*                             /*  SET - SPACE A LINE AFTER PRINTING */  00797000
    SYNADRLS                       RELEASE SYNADAF BUFFER               00798000
*   IF EIOERCT=0 THEN               /* IF ERROR COUNT IS ZERO,       */ 00799000
         LH    @10,EIOERCT                                         0322 00800000
         LTR   @10,@10                                             0322 00801000
         BNZ   @RF00322                                            0322 00802000
*TERMER:                                                           0323 00803000
*     DO;                           /* SET UP TO TERMINATE EDIT      */ 00804000
TERMER   DS    0H                                                  0324 00805000
*       CLOSE='1'B;                 /* REQUEST CLOSE DOWN            */ 00806000
         OI    CLOSE,B'00000100'                                   0324 00807000
*       GO TO EOFHANDL;             /* GO TO EOF HANDLER TO CLOSE  0325 00808000
*                                      TRACE DATA SET                */ 00809000
         B     EOFHANDL                                            0325 00810000
*     END TERMER;                                                  0326 00811000
*                                                                  0326 00812000
*   /*****************************************************************/ 00813000
*   /*                                                               */ 00814000
*   /* IF ERROR COUNT IS NOT ZERO, IGNORE BAD BLOCK BY RETURNING TO  */ 00815000
*   /* SYSTEM                                                        */ 00816000
*   /*                                                               */ 00817000
*   /*****************************************************************/ 00818000
*                                                                  0327 00819000
*   REG14=EIOR14SV;                 /* RESTORE REG 14                */ 00820000
@RF00322 L     REG14,EIOR14SV                                      0327 00821000
*   GEN(BR  R14);                   /* RETURN TO SYSTEM              */ 00822000
         BR  R14                                                        00823000
*                                                                  0329 00824000
*/********************************************************************  00825000
*                                                                    */ 00826000
*/*                                                                  */ 00827000
*/*  EOF HANDLER.  THE FUNCTION OF THIS ROUTINE IS TO CLOSE THE      */ 00828000
*/*  TRACE DATA SET AND, IF THE EDIT FUNCTION IS TERMINATING,        */ 00829000
*/*  TO FREE INPUT BUFFERS AND WORKING STORAGE.                      */ 00830000
*/*  IF A D/A WRAP DATA SET IS BEING PROCESSED AND THE LOGICAL END OF*/ 00831000
*/*  FILE HAS NOT BEEN REACHED, THE DATA SET IS RE-OPENED TO POSITION*/ 00832000
*/*  TO THE BEGINNING OF THE DATA SET.  THIS ROUTINE IS ALSO USED TO */ 00833000
*/*  FREE WORKING STORAGE WHEN TRACE DATA IS BEING EDITED FROM A DUMP*/ 00834000
*/*  DATA SET.                                                       */ 00835000
*/*                                                                  */ 00836000
*/********************************************************************  00837000
*                                                                    */ 00838000
*                                                                  0329 00839000
*EOFHANDL:                                                         0329 00840000
*   GEN(CLOSE  ((R8)));             /* ISSUE CLOSE SVC               */ 00841000
EOFHANDL CLOSE  ((R8))                                                  00842000
*   IF EXTTRC='1'B THEN             /* PROCESSING EXTERNAL     Y02014*/ 00843000
         TM    EXTTRC(AEDITCBR),B'00000100'                        0330 00844000
         BNO   @RF00330                                            0330 00845000
*     DO;                                                          0331 00846000
*       IF((DAWRAP='1'B&FRSTWRAP='0'B)|/* TIME STAMP FOUND     Y02014*/ 00847000
*           (DAWRAP='0'B&TSFOUND='0'B))&TRCCOUNT^=0&/* WAS A RECORD     00848000
*                                      READ                    Y02014*/ 00849000
*           CLOSE='0'B&             /* CLOSE DOWN NOT REQUESTED    0332 00850000
*                                                              Y02014*/ 00851000
*           TERM='0'B THEN          /* TERM NOT REQUESTED      Y02014*/ 00852000
         TM    DAWRAP,B'00100000'                                  0332 00853000
         BNO   @GL00007                                            0332 00854000
         TM    FRSTWRAP,B'00001000'                                0332 00855000
         BZ    @GL00006                                            0332 00856000
@GL00007 TM    DAWRAP,B'00100000'                                  0332 00857000
         BNZ   @RF00332                                            0332 00858000
         TM    TSFOUND(AEDITCBR),B'00100000'                       0332 00859000
         BNZ   @RF00332                                            0332 00860000
@GL00006 L     @10,TRCCOUNT                                        0332 00861000
         LTR   @10,@10                                             0332 00862000
         BZ    @RF00332                                            0332 00863000
         TM    CLOSE,B'00000100'                                   0332 00864000
         BNZ   @RF00332                                            0332 00865000
         TM    TERM(AEDITCBR),B'01000000'                          0332 00866000
         BNZ   @RF00332                                            0332 00867000
*         DO;                                                      0333 00868000
*           SYNMSGA=ADDR(AMDPRE11); /* PT TO NON VS2 ERROR MSG Y02014*/ 00869000
         L     @10,AFMG(,AEDITCBR)                                 0334 00870000
         LA    @10,AMDPRE11(,@10)                                  0334 00871000
         ST    @10,SYNMSGA                                         0334 00872000
*           GEN(OI SWD,NOSTDMG);    /* NO PRDMP MSG WANTED     Y02014*/ 00873000
         OI SWD,NOSTDMG                                                 00874000
*           REG15=ASYNTAX;          /* POINT TO MSG WRITER     Y02014*/ 00875000
         L     REG15,ASYNTAX                                       0336 00876000
*           CALL SYNTAXA;           /* CALL MESSAGE WRITER     Y02014*/ 00877000
         BAL   @14,SYNTAXA                                         0337 00878000
*           GO TO GETFREE;          /* GO CLEAN UP GET         Y02014*/ 00879000
         B     GETFREE                                             0338 00880000
*         END;                                                     0339 00881000
*     END;                                                         0340 00882000
*                                                                  0340 00883000
@RF00332 DS    0H                                                  0341 00884000
*   /*****************************************************************/ 00885000
*   /*                                                               */ 00886000
*   /* TEST FOR WRAP DATA SET, IN WHICH CASE RE-POSITIONING MAY BE   */ 00887000
*   /* REQUIRED.                                                     */ 00888000
*   /*                                                               */ 00889000
*   /*****************************************************************/ 00890000
*                                                                  0341 00891000
*   IF DAWRAP='1'B THEN             /* TEST WRAP INDICATOR IN CONTROL   00892000
*                                      TABLE                         */ 00893000
@RF00330 TM    DAWRAP,B'00100000'                                  0341 00894000
         BNO   @RF00341                                            0341 00895000
*REPOS:                                                            0342 00896000
*     DO;                           /* IF PROCESSING WRAP DATA SET,     00897000
*                                      MAY REQUIRE RE-POSITIONING    */ 00898000
REPOS    DS    0H                                                  0343 00899000
*       IF CLOSE='1'B THEN          /* IF CLOSE DOWN IS REQUESTED ON    00900000
*                                      ANY EOF, GO BACK TO GET     0343 00901000
*                                      TERMINATION CODE. THIS CAN  0343 00902000
*                                      HAPPEN IF LOGICAL END HAS BEEN   00903000
*                                      FOUND                         */ 00904000
         TM    CLOSE,B'00000100'                                   0343 00905000
         BO    @RT00343                                            0343 00906000
*         GO TO GETFINAL;                                          0344 00907000
*       IF PSITWRAP='0'B THEN       /* IF EOF HAS BEEN ENCOUNTERED,     00908000
*                                      DURING WRAP POSITIONING THEN     00909000
*                                      ACTUAL WRAP DID NOT OCCUR     */ 00910000
         TM    PSITWRAP,B'00010000'                                0345 00911000
         BNZ   @RF00345                                            0345 00912000
*         DAWRAP='0'B;              /* PROCESS WITHOUT WRAP          */ 00913000
         NI    DAWRAP,B'11011111'                                  0346 00914000
*       GEN(OPEN  ((R8),INPUT));    /* RE-OPEN TO POSITION TO      0347 00915000
*                                      BEGINNING OF DATA SET         */ 00916000
@RF00345 DS    0H                                                  0347 00917000
         OPEN  ((R8),INPUT)                                             00918000
*       GO TO GETREC;               /* GO CONTINUE PROCESSING        */ 00919000
         B     GETREC                                              0348 00920000
*     END REPOS;                                                   0349 00921000
*                                                                  0349 00922000
*/* BRANCH HERE TO SET GET EOF AND FREE GET STORAGE                  */ 00923000
*                                                                  0350 00924000
*GETFINAL:                                                         0350 00925000
*   IF TERM='0'B THEN               /* IF TERM BIT SET BY PRGET ONLY,*/ 00926000
@RF00341 DS    0H                                                  0350 00927000
GETFINAL TM    TERM(AEDITCBR),B'01000000'                          0350 00928000
         BNZ   @RF00350                                            0350 00929000
*     GETEOF='1'B;                  /* THEN SIGNAL EOF               */ 00930000
         OI    GETEOF(AEDITCBR),B'10000000'                        0351 00931000
*/* BRANCH HERE TO JUST FREE - THIS IS USED IF ERROR OCCURS        0352 00932000
*   PROCESSING TRACE BUFFERS IN DUMP                                 */ 00933000
*                                                                  0352 00934000
*GETFREE:                           /*                       @AZ30042*/ 00935000
*   TRCCOUNT=TRCCOUNT-1;            /* EOF MEANS NO TRC REC  @AZ30042*/ 00936000
@RF00350 DS    0H                                                  0352 00937000
GETFREE  L     @10,TRCCOUNT                                        0352 00938000
         BCTR  @10,0                                               0352 00939000
         ST    @10,TRCCOUNT                                        0352 00940000
*   RFY                                                            0353 00941000
*    (REG1,                                                        0353 00942000
*     REG0) RSTD;                   /*                       @ZA30042*/ 00943000
*   REG0=EIOSTOR;                   /* REG0 CONTAINS LENGTH, SBP00L  */ 00944000
         L     REG0,EIOSTOR                                        0354 00945000
*   REG1=BUFFER;                    /* RECORD ADDRESS IN REG 1       */ 00946000
         L     REG1,BUFFER                                         0355 00947000
*   GEN(FREEMAIN R,LV=(0),A=(1));   /* RELEASE BUFFER AREA           */ 00948000
         FREEMAIN R,LV=(0),A=(1)                                        00949000
*UNSPIE:                                                           0357 00950000
*   IF EXTTRC='0'B THEN             /* TEST FOR EXT DATA SET,  Y02014*/ 00951000
UNSPIE   TM    EXTTRC(AEDITCBR),B'00000100'                        0357 00952000
         BNZ   @RF00357                                            0357 00953000
*     ERRADDR=EIOERR;               /* IF PROCESSING DUMP DATA SET,     00954000
*                                      MUST RESTORE CALLER-S ERROR 0358 00955000
*                                      ROUTINE ADDRESS.              */ 00956000
         L     @10,EIOERR                                          0358 00957000
         ST    @10,ERRADDR                                         0358 00958000
*   RFY                                                            0359 00959000
*    (REG1,                                                        0359 00960000
*     REG0) UNRSTD;                 /*                         Y02014*/ 00961000
@RF00357 DS    0H                                                  0360 00962000
*   EIOFLGS='00000000'X;            /* RESET ALL SWITCHES            */ 00963000
         MVC   EIOFLGS(4),@CB01261                                 0360 00964000
*   IF EOF='1'B&                    /* USER WANTS EOF EXIT     Y02014*/ 00965000
*       USEREXIT^='        ' THEN   /* EXIT EXISTS             Y02014*/ 00966000
         TM    EOF(AEDITCBR),B'00000001'                           0361 00967000
         BNO   @RF00361                                            0361 00968000
         CLC   USEREXIT(8,AEDITCBR),@CC01502                       0361 00969000
         BE    @RF00361                                            0361 00970000
*     DO;                           /* YES                     Y02014*/ 00971000
*       EOFINPRO='1'B;              /* EOF IN PROCESS BIT      Y02014*/ 00972000
         OI    EOFINPRO(AEDITCBR),B'01000000'                      0363 00973000
*       CALL PREXT;                 /* GO INTERFACE WITH USER  Y02014*/ 00974000
         L     @10,AFRMAD(,AEDITCBR)                               0364 00975000
         L     @15,AEXT(,@10)                                      0364 00976000
         BALR  @14,@15                                             0364 00977000
*     END;                          /*                         Y02014*/ 00978000
*   GO TO GETTERM;                  /* GO INDICATE TERMINATION OF  0366 00979000
*                                      EDIT REQUIRED                 */ 00980000
         B     GETTERM                                             0366 00981000
*   RFY                                                            0367 00982000
*    (REG8) UNRSTD;                 /*                         Y02014*/ 00983000
*   GEN;                                                           0368 00984000
GTFDCB    DCB  DSORG=PS,            SEQUENTIAL ORGANIZATION            X00985000
               EODAD=EOFHANDL,                                         X00986000
               EROPT=SKP,           SKIP ERROR RECORDS                 X00987000
               MACRF=(GL),          GET - LOCATE MODE                  X00988000
               RECFM=VB,            VARIABLE BLOCKED RECORDS           X00989000
               DDNAME=XXXXXXXX,     DDNAME TO BE FILLED IN BY GET INIT X00990000
               SYNAD=SYNAD                                              00991000
*                                                                  0369 00992000
*/********************************************************************  00993000
*                                                                    */ 00994000
*/*                                                                  */ 00995000
*/*  DUMP PROCESSING INITIALIZATION.  THE CVT IN THE DUMP SYSTEM IS  */ 00996000
*/*  TESTED TO INSURE THAT GTF WAS ACTIVE AT THE TIME OF THE DUMP    */ 00997000
*/*  GTF BUFFERS ARE LOCATED BY THE FOLLOWING SCHEME.                */ 00998000
*/*                                                                  */ 00999000
*/*    CVT-->MCHEAD-->MCCE-->GTF'S MCQE-->GTFPCT-->BUFFERS           */ 01000000
*/*  IF PROCESSING A S/A DUMP                                        */ 01001000
*/*    CVT-->MCHEAD-->MCCE-->GTF'S MCQE--GTFPCT-->SLE-->BUFFERS      */ 01002000
*/*                                         |---->BLOKING AREA       */ 01003000
*/*                                                                  */ 01004000
*/*  EDITING BEGINS WITH OLDEST BUFFER.                              */ 01005000
*/*  IN THE CASE OF A S/A DUMP THE BLOKING AREAS WILL BE             */ 01006000
*/*  FORMATTED LAST.                                                 */ 01007000
*/*                                                                  */ 01008000
*/********************************************************************  01009000
*                                                                    */ 01010000
*/* BRANCH HERE IF TRACE DATA TO BE EDITED FROM DUMP                 */ 01011000
*                                                                  0369 01012000
*DUMPTRC:                           /* DUMP PROCESSING         Y02014*/ 01013000
*   IF BLOKPROC='1'B THEN           /* S/A DUMP PROCESSING REQ Y02014*/ 01014000
DUMPTRC  TM    BLOKPROC,B'10000000'                                0369 01015000
         BO    @RT00369                                            0369 01016000
*     GO TO DEBLKSA;                /* GO DEBLOCK GTFBLOKS     Y02014*/ 01017000
*   IF FIRSTGET='1'B THEN           /* HAS SET UP BEEN DONE    Y02014*/ 01018000
         TM    FIRSTGET,B'10000000'                                0371 01019000
         BO    @RT00371                                            0371 01020000
*     GO TO DEBLOCK;                /* GO DEBLOCK BUFFERS      Y02014*/ 01021000
*   AEIOCT=ADDR(EIOCTL);            /* PT PRTAB TO I/O TABLE   Y02014*/ 01022000
         LA    @10,EIOCTL                                          0373 01023000
         ST    @10,AEIOCT(,AEDITCBR)                               0373 01024000
*   SYNMSGA=ADDR(AMDPRE01);         /* PT TO ERROR MSG ARRAY   Y02014*/ 01025000
         L     @10,AFMG(,AEDITCBR)                                 0374 01026000
         ST    @10,SYNMSGA                                         0374 01027000
*   RFY                                                            0375 01028000
*    (REG1,                                                        0375 01029000
*     REG2) RSTD;                   /*                         Y02014*/ 01030000
*   REG2=572;                       /* SIZE OF BUILD AREA      Y02014*/ 01031000
         LA    REG2,572                                            0376 01032000
*   GEN(GETMAIN R,LV=(R2));         /* GET TRACE BUILD AREA    Y02014*/ 01033000
         GETMAIN R,LV=(R2)                                              01034000
*   BLDAREA=REG1;                   /* STORE ADDR              Y02014*/ 01035000
         ST    REG1,BLDAREA                                        0378 01036000
*   EIOSTOR=REG2;                   /* STORE LENGTH IN TABLE   Y02014*/ 01037000
         ST    REG2,EIOSTOR                                        0379 01038000
*   EIOERR=ERRADDR;                 /* SAVE CALLER'S ERROR RTN Y02014*/ 01039000
         L     @10,ERRADDR                                         0380 01040000
         ST    @10,EIOERR                                          0380 01041000
*   ERRADDR=ADDR(DUMPER);           /* ESTAB GET'S ERROR RTN   Y02014*/ 01042000
         LA    @10,DUMPER                                          0381 01043000
         ST    @10,ERRADDR                                         0381 01044000
*   FIRSTGET='1'B;                  /* INDICATE INIT COMPLETE  Y02014*/ 01045000
         OI    FIRSTGET,B'10000000'                                0382 01046000
*   REG2=CVTADDR+DISP1;             /* GET ADDR OF GTF CVT WD  Y02014*/ 01047000
         L     REG2,CVTADDR                                        0383 01048000
         AL    REG2,DISP1                                          0383 01049000
*   GEN(BRREAD (R2),DATA,ASID=AID); /* READ FOR GTF CVT WD     Y02014*/ 01050000
         BRREAD (R2),DATA,ASID=AID                                      01051000
*   IF CVTGTFAT^='1'B THEN          /* GTF ACTIVE AT TIME      Y02014*/ 01052000
         TM    CVTGTFAT(REG1),B'10000000'                          0385 01053000
         BO    @RF00385                                            0385 01054000
*     DO;                           /* OF DUMP                 Y02014*/ 01055000
*       REG2=ADDR(NOTACMSG);        /* PT TO NOT ACTIVE MSG    Y02014*/ 01056000
         LA    REG2,NOTACMSG                                       0387 01057000
*       I=30;                       /* SET LENGTH OF MESSAGE   Y02014*/ 01058000
         LA    I,30                                                0388 01059000
*       GO TO WRITERR;              /* GO WRITE MESSAGE        Y02014*/ 01060000
         B     WRITERR                                             0389 01061000
*     END;                          /*                         Y02014*/ 01062000
*                                                                  0390 01063000
*   /*****************************************************************/ 01064000
*   /*                                                               */ 01065000
*   /* THE MCHEAD IS THE NEXT STEP IN THE BUFFER LOCATING SCHEME     */ 01066000
*   /*                                                         Y02014*/ 01067000
*   /*                                                               */ 01068000
*   /*****************************************************************/ 01069000
*                                                                  0391 01070000
*   ADDRSAVE=P;                     /* SAVE ADDR OF MCHEAD     Y02014*/ 01071000
@RF00385 L     @10,P(,REG1)                                        0391 01072000
         ST    @10,ADDRSAVE                                        0391 01073000
*   IDVALID='MCHEAD';               /* COMPARE ELEMENT SAVED   Y02014*/ 01074000
         MVI   IDVALID+6,C' '                                      0392 01075000
         MVI   IDVALID+7,C' '                                      0392 01076000
         MVC   IDVALID(6),@CC01507                                 0392 01077000
*   CALL IDCHECK;                   /* CHECK FOR VALID ID      Y02014*/ 01078000
         BAL   @14,IDCHECK                                         0393 01079000
*/* NEXT STEP IS THE MCCE                                      Y02014*/ 01080000
*                                                                  0394 01081000
*   REG2=ADDRSAVE+DISP2;            /* ADD OFFSET TO MCCE ADDR Y02014*/ 01082000
         L     REG2,ADDRSAVE                                       0394 01083000
         AL    REG2,DISP2                                          0394 01084000
*   GEN(BRREAD (R2),DATA,ASID=AID); /* READ FOR MCCE ADDR      Y02014*/ 01085000
         BRREAD (R2),DATA,ASID=AID                                      01086000
*   ADDRSAVE=P;                     /* SAVE ADDR OF MCCE       Y02014*/ 01087000
         L     @10,P(,REG1)                                        0396 01088000
         ST    @10,ADDRSAVE                                        0396 01089000
*   IDVALID='MCCE';                 /* COMPARE ELEMENT SAVED   Y02014*/ 01090000
         MVI   IDVALID+4,C' '                                      0397 01091000
         MVC   IDVALID+5(3),IDVALID+4                              0397 01092000
         MVC   IDVALID(4),@CC01509                                 0397 01093000
*   CALL IDCHECK;                   /* CHECK FOR VALID ID      Y02014*/ 01094000
*                                                                  0398 01095000
         BAL   @14,IDCHECK                                         0398 01096000
*   /*****************************************************************/ 01097000
*   /*                                                               */ 01098000
*   /* NEXT STEP IS LOCATING GTF'S MCQE                        Y02014*/ 01099000
*   /*                                                               */ 01100000
*   /*****************************************************************/ 01101000
*                                                                  0399 01102000
*   REG2=ADDRSAVE+DISP3;            /* ADD OFFSET TO MCQE ADDR Y02014*/ 01103000
         L     REG2,ADDRSAVE                                       0399 01104000
         AL    REG2,DISP3                                          0399 01105000
*   GEN(BRREAD (R2),DATA,ASID=AID); /* READ FOR MCQE POINTER   Y02014*/ 01106000
         BRREAD (R2),DATA,ASID=AID                                      01107000
*   ADDRSAVE=P;                     /* SAVE ADDR OF 1ST MCQE   Y02014*/ 01108000
         L     @10,P(,REG1)                                        0401 01109000
         ST    @10,ADDRSAVE                                        0401 01110000
*   IDVALID='MCQE';                 /* SAVE COMPARE ELEMENT    Y02014*/ 01111000
         MVI   IDVALID+4,C' '                                      0402 01112000
         MVC   IDVALID+5(3),IDVALID+4                              0402 01113000
         MVC   IDVALID(4),@CC01510                                 0402 01114000
*MCQESRCH:                          /*                         Y02014*/ 01115000
*   IF ADDRSAVE=0 THEN              /* IS THERE A CHAIN PTR    Y02014*/ 01116000
MCQESRCH L     @10,ADDRSAVE                                        0403 01117000
         LTR   @10,@10                                             0403 01118000
         BZ    @RT00403                                            0403 01119000
*     GO TO CHAINERR;               /* GO PUT OUT ERROR MSG    Y02014*/ 01120000
*   CALL IDCHECK;                   /* CHECK FOR VALID ID      Y02014*/ 01121000
         BAL   @14,IDCHECK                                         0405 01122000
*   REG2=ADDRSAVE+DISP4;            /* ADD OFFSET TO APP NAME  Y02014*/ 01123000
         L     REG2,ADDRSAVE                                       0406 01124000
         AL    REG2,DISP4                                          0406 01125000
*   GEN(BRREAD (R2),DATA,ASID=AID); /* READ FOR APP ID         Y02014*/ 01126000
         BRREAD (R2),DATA,ASID=AID                                      01127000
*   IDHOLD1=TABLEID;                /* SAVE APP ID             Y02014*/ 01128000
         MVC   IDHOLD1(4),TABLEID(REG1)                            0408 01129000
*   IF IDHOLD1^='GTF ' THEN         /* IS THIS GTF'S MCQE      Y02014*/ 01130000
         CLC   IDHOLD1(4),@CC01514                                 0409 01131000
         BE    @RF00409                                            0409 01132000
*     DO;                           /* NO                      Y02014*/ 01133000
*       REG2=ADDRSAVE+DISP5;        /* ADD OFFSET TO MCQE PTR  Y02014*/ 01134000
         L     REG2,ADDRSAVE                                       0411 01135000
         AL    REG2,DISP5                                          0411 01136000
*       GEN(BRREAD (R2),DATA,ASID=AID);/* READ FOR MCQE ADDR   Y02014*/ 01137000
         BRREAD (R2),DATA,ASID=AID                                      01138000
*       ADDRSAVE=P;                 /* SAVE ADDR OF MCQE       Y02014*/ 01139000
         L     @10,P(,REG1)                                        0413 01140000
         ST    @10,ADDRSAVE                                        0413 01141000
*       GO TO MCQESRCH;             /* GO SEARCH FOR GTF'S     Y02014*/ 01142000
         B     MCQESRCH                                            0414 01143000
*     END;                          /*                         Y02014*/ 01144000
*                                                                  0415 01145000
*   /*****************************************************************/ 01146000
*   /*                                                               */ 01147000
*   /* NEXT STEP IS THE GTFPCT                                 Y02014*/ 01148000
*   /*                                                               */ 01149000
*   /*****************************************************************/ 01150000
*                                                                  0416 01151000
*   REG2=ADDRSAVE+DISP6;            /* ADD OFFSET TO PCT PTR   Y02014*/ 01152000
@RF00409 L     REG2,ADDRSAVE                                       0416 01153000
         AL    REG2,DISP6                                          0416 01154000
*   GEN(BRREAD (R2),DATA,ASID=AID); /* READ FOR PCT ADDR       Y02014*/ 01155000
         BRREAD (R2),DATA,ASID=AID                                      01156000
*   ADDRSAVE=P;                     /* SAVE ADDRESS OF GTFPCT  Y02014*/ 01157000
         L     @10,P(,REG1)                                        0418 01158000
         ST    @10,ADDRSAVE                                        0418 01159000
*   PCTSAVE=ADDRSAVE;               /* SAVE ADDRESS OF GTFPCT  Y02014*/ 01160000
         ST    @10,PCTSAVE                                         0419 01161000
*   IDVALID='GTFPCT';               /* SAVE COMPARE ELEMENT    Y02014*/ 01162000
         MVI   IDVALID+6,C' '                                      0420 01163000
         MVI   IDVALID+7,C' '                                      0420 01164000
         MVC   IDVALID(6),@CC01515                                 0420 01165000
*   CALL IDCHECK;                   /* CHECK FOR VALID ID      Y02014*/ 01166000
         BAL   @14,IDCHECK                                         0421 01167000
*   REG2=ADDRSAVE+DISP7;            /* ADD OFFSET TO HQ LENGTH Y02014*/ 01168000
         L     REG2,ADDRSAVE                                       0422 01169000
         AL    REG2,DISP7                                          0422 01170000
*   GEN(BRREAD (R2),DATA,ASID=AID); /* READ FOR HQ LENGTH      Y02014*/ 01171000
         BRREAD (R2),DATA,ASID=AID                                      01172000
*   BUFFCNT=P;                      /* SAVE HQ LENGTH          Y02014*/ 01173000
         L     @10,P(,REG1)                                        0424 01174000
         ST    @10,BUFFCNT                                         0424 01175000
*   REG2=ADDRSAVE+DISP21;           /* ADD OFFSET TO ASCB ADDR Y02014*/ 01176000
         L     REG2,ADDRSAVE                                       0425 01177000
         AL    REG2,DISP21                                         0425 01178000
*   GEN(BRREAD (R2),DATA,ASID=AID); /* READ FOR ASCB ADDRESS   Y02014*/ 01179000
         BRREAD (R2),DATA,ASID=AID                                      01180000
*   ASCBGTF=P;                      /* SAVE ASCB ADDRESS       Y02014*/ 01181000
         L     ASCBGTF,P(,REG1)                                    0427 01182000
*   REG2=ASCBGTF+DISP22;            /* ADD OFFSET TO ASID      Y02014*/ 01183000
         LR    REG2,ASCBGTF                                        0428 01184000
         AL    REG2,DISP22                                         0428 01185000
*   GEN(BRREAD (R2),DATA,ASID=AID); /* READ FOR ASID           Y02014*/ 01186000
         BRREAD (R2),DATA,ASID=AID                                      01187000
*   GTFASID=P2;                     /* SAVE ASID               Y02014*/ 01188000
         LH    GTFASID,P2(,REG1)                                   0430 01189000
*/********************************************************************/ 01190000
*/*                                                            Y02014*/ 01191000
*/* DETERMINE WHAT TYPE OF DUMP IN ORDER TO DECIDE WHAT SCHEME Y02014*/ 01192000
*/*     TO USE IN LOCATING THE GTF BUFFERS                     Y02014*/ 01193000
*/*                                                            Y02014*/ 01194000
*/********************************************************************/ 01195000
*                                                                  0431 01196000
*   IF SADMP='0'B THEN              /* PROCESSING A S/A        Y02014*/ 01197000
         TM    SADMP,B'00100000'                                   0431 01198000
         BZ    @RT00431                                            0431 01199000
*     GO TO SLQREQ;                 /* NO, LOOK AT SLQ         Y02014*/ 01200000
*   REG2=ADDRSAVE+DISP8;            /* ADD OFFSET TO HQHEAD    Y02014*/ 01201000
         L     REG2,ADDRSAVE                                       0433 01202000
         AL    REG2,DISP8                                          0433 01203000
*   GEN(BRREAD (R2),DATA,ASID=AID); /* READ FOR HQHEAD         Y02014*/ 01204000
         BRREAD (R2),DATA,ASID=AID                                      01205000
*   ADDRSAVE=P;                     /* SAVE ADDR OF GTFBCB     Y02014*/ 01206000
         L     @10,P(,REG1)                                        0435 01207000
         ST    @10,ADDRSAVE                                        0435 01208000
*   AID=GTFASID;                    /* DO READS IN GTF'S MEMORY    0436 01209000
*                                                              Y02014*/ 01210000
         STH   GTFASID,AID                                         0436 01211000
*BCBVAL:                            /*                         Y02014*/ 01212000
*   IDVALID='GTFBCB';               /* COMPARE ELEMENT SAVED   Y02014*/ 01213000
BCBVAL   MVI   IDVALID+6,C' '                                      0437 01214000
         MVI   IDVALID+7,C' '                                      0437 01215000
         MVC   IDVALID(6),@CC01518                                 0437 01216000
*   CALL IDCHECK;                   /* CHECK FOR VALID ID      Y02014*/ 01217000
         BAL   @14,IDCHECK                                         0438 01218000
*   REG2=ADDRSAVE+DISP9;            /* ADD OFFSET TO BUF ADDR  Y02014*/ 01219000
         L     REG2,ADDRSAVE                                       0439 01220000
         AL    REG2,DISP9                                          0439 01221000
*   GEN(BRREAD (R2),DATA,ASID=AID); /* READ FOR BUFFER ADDR    Y02014*/ 01222000
         BRREAD (R2),DATA,ASID=AID                                      01223000
*   REG2=P;                         /* PREPARE TO READ IN BUF  Y02014*/ 01224000
         L     REG2,P(,REG1)                                       0441 01225000
*   GEN(BRREAD (R2),DATA,ASID=AID); /* READ IN BUFFER          Y02014*/ 01226000
*                                                                  0442 01227000
         BRREAD (R2),DATA,ASID=AID                                      01228000
*   /*****************************************************************/ 01229000
*   /*                                                               */ 01230000
*   /* ONLY ONE BRREAD IS NECESSARY DUE                        Y02014*/ 01231000
*   /* TO THE BUFFER BEING ON 4K BOUNDRY                       Y02014*/ 01232000
*   /*                                                               */ 01233000
*   /*****************************************************************/ 01234000
*                                                                  0443 01235000
*   BUFPTR=REG1;                    /* SAVE PTR TO BUFFER      Y02014*/ 01236000
         ST    REG1,BUFPTR                                         0443 01237000
*   RECPTR=REG1;                    /* PTR TO RECORDS          Y02014*/ 01238000
         ST    REG1,RECPTR                                         0444 01239000
*NEWBUF:                            /*                         Y02014*/ 01240000
*   IF(BLL<4)|(BLL>4096)            /* VALID BIG LL FIELD      Y02014*/ 01241000
*     THEN                                                         0445 01242000
NEWBUF   LA    @10,4                                               0445 01243000
         L     @08,BUFPTR                                          0445 01244000
         LH    @04,BLL(,@08)                                       0445 01245000
         CR    @04,@10                                             0445 01246000
         BL    @RT00445                                            0445 01247000
         C     @04,@CF01192                                        0445 01248000
         BH    @RT00445                                            0445 01249000
*     GO TO BADLL;                  /* GO ISSUE ERROR MSG      Y02014*/ 01250000
*   RECDLL=4;                       /* VALUE TO BYPASS PREFIX  Y02014*/ 01251000
         STCM  @10,7,RECDLL(AEDITCBR)                              0447 01252000
*   BLL=BLL-4;                      /* SUBT PREFIX LENGTH      Y02014*/ 01253000
         SLR   @04,@10                                             0448 01254000
         STH   @04,BLL(,@08)                                       0448 01255000
*DEBLOCK:                           /*                         Y02014*/ 01256000
*   IF BLL<4 THEN                   /* RECORDS REMAINING       Y02014*/ 01257000
DEBLOCK  LA    @10,4                                               0449 01258000
         L     @08,BUFPTR                                          0449 01259000
         LH    @04,BLL(,@08)                                       0449 01260000
         CR    @04,@10                                             0449 01261000
         BL    @RT00449                                            0449 01262000
*     GO TO NEXTBUF;                /* GO GET NEXT BUFFER      Y02014*/ 01263000
*   RECPTR=RECPTR+RECDLL;           /* POINT TO NEXT RECORD    Y02014*/ 01264000
         L     @03,RECDLL-1(,AEDITCBR)                             0451 01265000
         LA    @03,0(,@03)                                         0451 01266000
         AL    @03,RECPTR                                          0451 01267000
         ST    @03,RECPTR                                          0451 01268000
*   IF(LLL<4)|(LLL>284) THEN        /* VALID LITTLE LL         Y02014*/ 01269000
         LH    @15,LLL(,@03)                                       0452 01270000
         CR    @15,@10                                             0452 01271000
         BL    @RT00452                                            0452 01272000
         C     @15,@CF01337                                        0452 01273000
         BH    @RT00452                                            0452 01274000
*     GO TO BADLL;                  /* GO ISSUE ERR MSG        Y02014*/ 01275000
*   BLL=BLL-LLL;                    /* SUBT REC LNG FROM TOTAL Y02014*/ 01276000
         SLR   @04,@15                                             0454 01277000
         STH   @04,BLL(,@08)                                       0454 01278000
*   IF BLL<0 THEN                   /* INVALID LITTLE LL       Y02014*/ 01279000
         LTR   @04,@04                                             0455 01280000
         BM    @RT00455                                            0455 01281000
*     GO TO BADLL;                  /* GO ISSUE ERR MSG        Y02014*/ 01282000
*   RECDLL=LLL;                     /* SAVE LL VALUE           Y02014*/ 01283000
         STCM  @15,7,RECDLL(AEDITCBR)                              0457 01284000
*   CURREC=RECPTR;                  /* POINT CURREC AT RECORD  Y02014*/ 01285000
         ST    @03,CURREC(,AEDITCBR)                               0458 01286000
*   TRCCOUNT=TRCCOUNT+1;            /* INCR TRACE REC COUNT    Y02014*/ 01287000
         LA    @10,1                                               0459 01288000
         AL    @10,TRCCOUNT                                        0459 01289000
         ST    @10,TRCCOUNT                                        0459 01290000
*   GO TO GETDONE;                  /* SET UP FOR RETURN       Y02014*/ 01291000
         B     GETDONE                                             0460 01292000
*NEXTBUF:                           /*                         Y02014*/ 01293000
*   BUFFCNT=BUFFCNT-1;              /* CALC # OF BUFFERS LEFT  Y02014*/ 01294000
NEXTBUF  L     @10,BUFFCNT                                         0461 01295000
         BCTR  @10,0                                               0461 01296000
         ST    @10,BUFFCNT                                         0461 01297000
*   IF BUFFCNT=0 THEN               /* NO BUFFERS LEFT         Y02014*/ 01298000
         LTR   @10,@10                                             0462 01299000
         BZ    @RT00462                                            0462 01300000
*     GO TO TESTSADP;               /* CHECK IF S|A DUMP       Y02014*/ 01301000
*   REG2=ADDRSAVE+DISP10;           /* ADD OFFSET FOR CHAIN    Y02014*/ 01302000
         L     REG2,ADDRSAVE                                       0464 01303000
         AL    REG2,DISP10                                         0464 01304000
*   GEN(BRREAD (R2),DATA,ASID=AID); /* READ FOR BCB ADDR       Y02014*/ 01305000
         BRREAD (R2),DATA,ASID=AID                                      01306000
*   ADDRSAVE=P;                     /* SAVE BCB ADDR           Y02014*/ 01307000
         L     @10,P(,REG1)                                        0466 01308000
         ST    @10,ADDRSAVE                                        0466 01309000
*   GO TO BCBVAL;                   /* CHECK OUT BCB           Y02014*/ 01310000
         B     BCBVAL                                              0467 01311000
*TESTSADP:                          /*                         Y02014*/ 01312000
*   IF SADMP='0'B THEN              /* S|A DUMP PROCESSING     Y02014*/ 01313000
TESTSADP TM    SADMP,B'00100000'                                   0468 01314000
         BZ    @RT00468                                            0468 01315000
*     GO TO GETFINAL;               /* NO GO CLEAN UP          Y02014*/ 01316000
*SAPROC:                            /*                         Y02014*/ 01317000
*   AID=0;                          /* BLOKS ARE IN COMMON     Y02014*/ 01318000
SAPROC   SLR   @10,@10                                             0470 01319000
         STH   @10,AID                                             0470 01320000
*   BLOKPROC='1'B;                  /* DO BLOKING AREAS        Y02014*/ 01321000
         OI    BLOKPROC,B'10000000'                                0471 01322000
*   ADDRSAVE=PCTSAVE;               /* RESTORE PTR TO GTFPCT   Y02014*/ 01323000
         L     @10,PCTSAVE                                         0472 01324000
         ST    @10,ADDRSAVE                                        0472 01325000
*   REG2=ADDRSAVE+DISP11;           /* ADD OFFSET FOR CURRBLOK     0473 01326000
*                                      ADDRESS                 Y02014*/ 01327000
         AL    @10,DISP11                                          0473 01328000
         LR    REG2,@10                                            0473 01329000
*   GEN(BRREAD (R2),DATA,ASID=AID); /* READ FOR ADDRESS        Y02014*/ 01330000
         BRREAD (R2),DATA,ASID=AID                                      01331000
*   EIOSTOP=P;                      /* SAVE CURRBLOK ADDRESS   Y02014*/ 01332000
         L     @10,P(,REG1)                                        0475 01333000
         ST    @10,EIOSTOP                                         0475 01334000
*   REG2=ADDRSAVE+DISP12;           /* ADD OFFSET FOR NEXTBLOK Y02014*/ 01335000
         L     REG2,ADDRSAVE                                       0476 01336000
         AL    REG2,DISP12                                         0476 01337000
*   CURREC=BLDAREA;                 /* RESTORE CURREC          Y02014*/ 01338000
         L     @10,BLDAREA                                         0477 01339000
         ST    @10,CURREC(,AEDITCBR)                               0477 01340000
*   GEN(BRREAD (R2),DATA,ASID=AID); /* READ FOR ADDRESS        Y02014*/ 01341000
         BRREAD (R2),DATA,ASID=AID                                      01342000
*   EIOCUR=P;                       /* SAVE NEXTBLOK ADDR      Y02014*/ 01343000
         L     @10,P(,REG1)                                        0479 01344000
         ST    @10,EIOCUR                                          0479 01345000
*   IDVALID='GTFBLOK';              /* SAVE COMPARE ELEMENT    Y02014*/ 01346000
         MVI   IDVALID+7,C' '                                      0480 01347000
         MVC   IDVALID(7),@CC01530                                 0480 01348000
*   ADDRSAVE=EIOCUR;                /* SET UP FOR IDCHECK      Y02014*/ 01349000
         ST    @10,ADDRSAVE                                        0481 01350000
*   CALL IDCHECK;                   /* CHECK FOR VALID ID      Y02014*/ 01351000
         BAL   @14,IDCHECK                                         0482 01352000
*NEWSABUF:                          /*                         Y02014*/ 01353000
*   IF EIOSTOP=(EIOCUR&ADDRMASK)    /* LAST BLOKING AREA     @YM03670*/ 01354000
*       |COUNT=3 THEN               /* 4 BLOKS MAXIMUM         Y02014*/ 01355000
NEWSABUF L     @10,EIOCUR                                          0483 01356000
         N     @10,ADDRMASK                                        0483 01357000
         CL    @10,EIOSTOP                                         0483 01358000
         BE    @RT00483                                            0483 01359000
         CLC   COUNT(4),@CF00198                                   0483 01360000
         BNE   @RF00483                                            0483 01361000
@RT00483 DS    0H                                                  0484 01362000
*     THATSALL='1'B;                /* YES INDICATE SO         Y02014*/ 01363000
         OI    THATSALL,B'01000000'                                0484 01364000
*   REG2=ADDRSAVE+DISP13;           /* ADD OFFSET FOR USE CNT  Y02014*/ 01365000
@RF00483 L     REG2,ADDRSAVE                                       0485 01366000
         AL    REG2,DISP13                                         0485 01367000
*   GEN(BRREAD (R2),DATA,ASID=AID); /* READ FOR USE COUNT      Y02014*/ 01368000
         BRREAD (R2),DATA,ASID=AID                                      01369000
*   IF USECNT^=0 THEN               /* USE COUNT ZERO          Y02014*/ 01370000
         LH    @10,USECNT(,REG1)                                   0487 01371000
         LTR   @10,@10                                             0487 01372000
         BNZ   @RT00487                                            0487 01373000
*     GO TO HEXBUFDP;               /* NO,GO DUMP BUF IN HEX   Y02014*/ 01374000
*   REG2=ADDRSAVE+DISP14;           /* ADD OFFSET TO BLOK AREA Y02014*/ 01375000
         L     REG2,ADDRSAVE                                       0489 01376000
         AL    REG2,DISP14                                         0489 01377000
*   EIOREC=REG2;                    /* ADDR IN DUMP OF BLKAREA Y02014*/ 01378000
         ST    REG2,EIOREC                                         0490 01379000
*   GEN(BRREAD (R2),DATA,ASID=AID); /* READ FOR BIG LL         Y02014*/ 01380000
         BRREAD (R2),DATA,ASID=AID                                      01381000
*   IF(LL<=4)|(LL>4096) THEN        /* VALID BIG LL            Y02014*/ 01382000
         LA    @10,4                                               0492 01383000
         LH    @08,LL(,REG1)                                       0492 01384000
         CR    @08,@10                                             0492 01385000
         BNH   @RT00492                                            0492 01386000
         C     @08,@CF01192                                        0492 01387000
         BH    @RT00492                                            0492 01388000
*     GO TO BADLL;                  /* NO GET NEXT BLOK        Y02014*/ 01389000
*   EIOLL=LL-4;                     /* BYPASS BIG LL FIELD     Y02014*/ 01390000
         SLR   @08,@10                                             0494 01391000
         STH   @08,EIOLL                                           0494 01392000
*   EIOREC=EIOREC+4;                /* INCREMENT TO LITTLE LL  Y02014*/ 01393000
         AL    @10,EIOREC                                          0495 01394000
         ST    @10,EIOREC                                          0495 01395000
*DEBLKSA:                                                          0496 01396000
*   IF EIOLL<=4 THEN                /* ARE LOGICAL RECORDS REMAINING    01397000
*                                      IN THIS BLOK                  */ 01398000
DEBLKSA  LH    @10,EIOLL                                           0496 01399000
         C     @10,@CF00065                                        0496 01400000
         BNH   @RT00496                                            0496 01401000
*     GO TO NEXTSABF;               /* IF NOT, GO TO NEXT BLOK Y02014*/ 01402000
*                                                                  0497 01403000
*   /*****************************************************************/ 01404000
*   /*                                                               */ 01405000
*   /* READ LITTLE-LL FIELD. TWO BRREAD-S ARE REQUIRED BECAUSE FIELD */ 01406000
*   /* MAY HAVE BYTE BOUNDARY ALLIGNMENT AND SPAN 2K STORAGE BLOCK   */ 01407000
*   /*                                                               */ 01408000
*   /*****************************************************************/ 01409000
*                                                                  0498 01410000
*   REG2=EIOREC;                    /* POINT TO LOGICAL RECORD LL  0498 01411000
*                                      FIELD                         */ 01412000
         L     REG2,EIOREC                                         0498 01413000
*   GEN(BRREAD (R2),DATA,ASID=AID); /* READ FOR FIRST HALF     Y02014*/ 01414000
         BRREAD (R2),DATA,ASID=AID                                      01415000
*   EIORECLL(1)=HALFLL;             /* MOVE FIRST HALF TO EIOCT    0500 01416000
*                                      HALFLL BASED ON REG 1         */ 01417000
         MVC   EIORECLL(1),HALFLL(REG1)                            0500 01418000
*   REG2=REG2+1;                    /* POINT TO SECOND BYTE          */ 01419000
         AL    REG2,@CF00076                                       0501 01420000
*   GEN(BRREAD  (R2),DATA,ASID=AID);/* READ FOR SECOND HALF OF RECORD   01421000
*                                      LL FIELD                Y02014*/ 01422000
         BRREAD  (R2),DATA,ASID=AID                                     01423000
*   EIORECLL(2)=HALFLL;             /* MOVE SECOND BYTE TO EIOCT     */ 01424000
         MVC   EIORECLL+1(1),HALFLL(REG1)                          0503 01425000
*   RECDLL=EIORECLL;                /* RECORD LNG IN PRTAB     Y02014*/ 01426000
*                                                                  0504 01427000
         LH    @10,EIORECLL                                        0504 01428000
         N     @10,@CF01570                                        0504 01429000
         STCM  @10,7,RECDLL(AEDITCBR)                              0504 01430000
*   /*****************************************************************/ 01431000
*   /*                                                               */ 01432000
*   /* VALIDITY CHECK LITTLE-LL, MUST LIE IN RANGE 4-284       Y02014*/ 01433000
*   /*                                                               */ 01434000
*   /*****************************************************************/ 01435000
*                                                                  0505 01436000
*   IF EIORECLL<4|EIORECLL>TWO84 THEN                              0505 01437000
*                                                                  0505 01438000
         C     @10,@CF00065                                        0505 01439000
         BL    @RT00505                                            0505 01440000
         CH    @10,TWO84                                           0505 01441000
         BNH   @RF00505                                            0505 01442000
@RT00505 DS    0H                                                  0506 01443000
*     /***************************************************************/ 01444000
*     /*                                                             */ 01445000
*     /* IF RECORD LL IS BAD, PRINT COMMENT AND GO ON TO NEXT BUF    */ 01446000
*     /*                                                             */ 01447000
*     /***************************************************************/ 01448000
*                                                                  0506 01449000
*BADLL:                                                            0506 01450000
*     DO;                                                          0506 01451000
BADLL    DS    0H                                                  0507 01452000
*       GEN(BRWRITE  SKIP,IMM);     /* SKIP TO NEW PAGE              */ 01453000
*                                                                  0507 01454000
         BRWRITE  SKIP,IMM                                              01455000
*       /*************************************************************/ 01456000
*       /*                                                           */ 01457000
*       /* MOVE DUMP ERROR - CONTINUING MESSAGE TO OUTPUT BUFFER     */ 01458000
*       /*                                                           */ 01459000
*       /*************************************************************/ 01460000
*                                                                  0508 01461000
*       OUTBUF(1:49)=DUMPERCN;                                     0508 01462000
         L     @10,CURBUF                                          0508 01463000
         MVC   OUTBUF(49,@10),DUMPERCN                             0508 01464000
*       GEN(BRWRITE  2);            /* WRITE MESSAGE TO PRINTER DATA    01465000
*                                      SET                           */ 01466000
         BRWRITE  2                                                     01467000
*       IF BLOKPROC='1'B THEN       /* PROCESSING GTF BLOKS    Y02014*/ 01468000
         TM    BLOKPROC,B'10000000'                                0510 01469000
         BO    @RT00510                                            0510 01470000
*         GO TO NEXTSABF;           /* YES GO GET NEXT ONE     Y02014*/ 01471000
*       GO TO NEXTBUF;              /* BRANCH TO FIND NEXT BUFFER    */ 01472000
         B     NEXTBUF                                             0512 01473000
*     END BADLL;                                                   0513 01474000
*                                                                  0513 01475000
*   /*****************************************************************/ 01476000
*   /*                                                               */ 01477000
*   /* LITTLE-LL IN PROPER RANGE                                     */ 01478000
*   /*                                                               */ 01479000
*   /*****************************************************************/ 01480000
*                                                                  0514 01481000
*   EIOLL=EIOLL-EIORECLL;           /* SUBTRACT CURRENT RECORD LENGTH   01482000
*                                      FROM REMAINNING LENGTH IN   0514 01483000
*                                      BLOCK                         */ 01484000
@RF00505 LH    @10,EIORECLL                                        0514 01485000
         N     @10,@CF01570                                        0514 01486000
         LH    @08,EIOLL                                           0514 01487000
         SLR   @08,@10                                             0514 01488000
         STH   @08,EIOLL                                           0514 01489000
*   IF EIOLL<0 THEN                 /* REMAINDER SHOULD NEVER GO   0515 01490000
*                                      NEGATIVE                      */ 01491000
         SLR   @04,@04                                             0515 01492000
         CR    @08,@04                                             0515 01493000
         BL    @RT00515                                            0515 01494000
*     GO TO BADLL;                  /* IF THIS HAPPENS, SOME LL IS IN   01495000
*                                      ERROR SO GO ON TO NEXT BUFFER */ 01496000
*                                                                  0516 01497000
*   /*****************************************************************/ 01498000
*   /*                                                               */ 01499000
*   /* EIOBRCT IS TOTAL NUMBER OF WORDS BEGINNING ON A WORD BOUNDARY */ 01500000
*   /* WHICH ARE REQUIRED TO SPAN THE TRACE ENTRY BEING DEBLOCKED.   */ 01501000
*   /*                                                               */ 01502000
*   /*****************************************************************/ 01503000
*                                                                  0517 01504000
*   EIOBRCT=(EIORECLL+3)/4+1;                                      0517 01505000
         LA    @06,3                                               0517 01506000
         ALR   @06,@10                                             0517 01507000
         SRDA  @06,32                                              0517 01508000
         D     @06,@CF00065                                        0517 01509000
         LA    @07,1(,@07)                                         0517 01510000
         STH   @07,EIOBRCT                                         0517 01511000
*   REG2=EIOREC&'FFFFFFFC'X;        /* ROUND DATA POINTER DOWN TO  0518 01512000
*                                      WORD BOUNDARY                 */ 01513000
         L     @08,EIOREC                                          0518 01514000
         LR    REG2,@08                                            0518 01515000
         N     REG2,@CF01537                                       0518 01516000
*   EIOBR=EIOREC&'00000003'X;       /* SAVE REMAINDER OF ROUND DOWN  */ 01517000
         LR    @03,@08                                             0519 01518000
         N     @03,@CF01538                                        0519 01519000
         STH   @03,EIOBR                                           0519 01520000
*   EIOREC=EIOREC+EIORECLL;         /* UPDATE DATA POINTER           */ 01521000
*                                                                  0520 01522000
         ALR   @08,@10                                             0520 01523000
         ST    @08,EIOREC                                          0520 01524000
*   /*****************************************************************/ 01525000
*   /*                                                               */ 01526000
*   /* LOOP TO READ EACH WORD OF TRACE RECORD                        */ 01527000
*   /*                                                               */ 01528000
*   /*****************************************************************/ 01529000
*                                                                  0521 01530000
*   DO I=0 TO EIOBRCT-1;                                           0521 01531000
         LR    I,@04                                               0521 01532000
         B     @DE00521                                            0521 01533000
@DL00521 DS    0H                                                  0522 01534000
*     GEN(BRREAD  (R2),DATA,ASID=AID);                             0522 01535000
*                                                                  0522 01536000
         BRREAD  (R2),DATA,ASID=AID                                     01537000
*     /***************************************************************/ 01538000
*     /*                                                             */ 01539000
*     /* READ WORD FROM DUMP - FULL WORD WILL BE READ BECAUSE DATA   */ 01540000
*     /* ADDR (REG 2) HAS BEEN ROUNDED TO WORD BOUNDARY              */ 01541000
*     /*                                                             */ 01542000
*     /***************************************************************/ 01543000
*                                                                  0523 01544000
*     K=(I*4)+1;                    /* COMPUTE OFFSET INTO BUILD AREA*/ 01545000
         LR    @10,I                                               0523 01546000
         SLA   @10,2                                               0523 01547000
         AL    @10,@CF00076                                        0523 01548000
         STH   @10,K                                               0523 01549000
*     BULDAREA(K:K+3)=TWORD;        /* MOVE WORD TO BUILD AREA       */ 01550000
         L     @08,CURREC(,AEDITCBR)                               0524 01551000
         ALR   @08,@10                                             0524 01552000
         MVC   BULDAREA-1(4,@08),TWORD(REG1)                       0524 01553000
*     REG2=REG2+4;                  /* POINT TO NEXT WORD            */ 01554000
         AL    REG2,@CF00065                                       0525 01555000
*   END;                                                           0526 01556000
*                                                                  0526 01557000
         AL    I,@CF00076                                          0526 01558000
@DE00521 LH    @10,EIOBRCT                                         0526 01559000
         BCTR  @10,0                                               0526 01560000
         CR    I,@10                                               0526 01561000
         BNH   @DL00521                                            0526 01562000
*/*   TRACE ENTRY NOW IN CORE                                        */ 01563000
*                                                                  0527 01564000
*   REG2=EIORECLL/256;              /* COMPUTE NUMBER OF MOVES     0527 01565000
*                                      REQUIRED TO MOVE ENTIRE RECORD   01566000
*                                      TO TRACE RECORD AREA          */ 01567000
         LH    REG2,EIORECLL                                       0527 01568000
         N     REG2,@CF01570                                       0527 01569000
         SRL   REG2,8                                              0527 01570000
*   DO I=0 TO REG2-1;               /* LOOP PERFORM MOVES            */ 01571000
         SLR   I,I                                                 0528 01572000
         B     @DE00528                                            0528 01573000
@DL00528 DS    0H                                                  0529 01574000
*     K=(I*256)+1;                  /* COMPUTE OFFSET INTO TRACE   0529 01575000
*                                      RECORD AREA AT WHICH THIS MOVE   01576000
*                                      IS TO GO                      */ 01577000
         LR    @10,I                                               0529 01578000
         SLA   @10,8                                               0529 01579000
         AL    @10,@CF00076                                        0529 01580000
         STH   @10,K                                               0529 01581000
*     J=K+EIOBR;                    /* COMPUTE OFFSET INTO BUILD AREA   01582000
*                                      OF SOURCE OF MOVE             */ 01583000
*                                                                  0530 01584000
         LH    J,EIOBR                                             0530 01585000
         ALR   J,@10                                               0530 01586000
*     /***************************************************************/ 01587000
*     /*                                                             */ 01588000
*     /* MOVE 256 BYTE SEGMENT                                       */ 01589000
*     /*                                                             */ 01590000
*     /***************************************************************/ 01591000
*                                                                  0531 01592000
*     TRECFINL(K:K+255)=BULDAREA(J:J+255);                         0531 01593000
         L     @08,CURREC(,AEDITCBR)                               0531 01594000
         ALR   @10,@08                                             0531 01595000
         BCTR  @10,0                                               0531 01596000
         ALR   @08,J                                               0531 01597000
         MVC   TRECFINL(256,@10),BULDAREA-1(@08)                   0531 01598000
*   END;                                                           0532 01599000
         AL    I,@CF00076                                          0532 01600000
@DE00528 LR    @10,REG2                                            0532 01601000
         BCTR  @10,0                                               0532 01602000
         CR    I,@10                                               0532 01603000
         BNH   @DL00528                                            0532 01604000
*   REG2=EIORECLL//256;             /* COMPUTE REMAINDER, IF ANY, YET   01605000
*                                      TO BE MOVED                   */ 01606000
         LH    REG2,EIORECLL                                       0533 01607000
         N     REG2,@CF01570                                       0533 01608000
         N     REG2,@CF01539                                       0533 01609000
*   IF REG2^=0 THEN                                                0534 01610000
         LTR   REG2,REG2                                           0534 01611000
         BZ    @RF00534                                            0534 01612000
*     DO;                           /* TEST FOR NOT ALL OF RECORD  0535 01613000
*                                      HAVING BEEN MOVED             */ 01614000
*                                                                  0535 01615000
*       /*************************************************************/ 01616000
*       /*                                                           */ 01617000
*       /* IF THERE IS A REMAINING PART TO BE MOVED, COMPUTE OFFSET  */ 01618000
*       /* OF WHERE REMAINDER SHOULD GO I VALID FROM EXIT FROM       */ 01619000
*       /* DO-LOOP ABOVE                                             */ 01620000
*       /*                                                           */ 01621000
*       /*************************************************************/ 01622000
*                                                                  0536 01623000
*       K=(I*256)+1;                /* GET OFFSET INTO TARGET AREA   */ 01624000
         LR    @10,I                                               0536 01625000
         SLA   @10,8                                               0536 01626000
         AL    @10,@CF00076                                        0536 01627000
         STH   @10,K                                               0536 01628000
*       J=K+EIOBR;                  /* OFFSET OF REMAINDER           */ 01629000
         LH    J,EIOBR                                             0537 01630000
         ALR   J,@10                                               0537 01631000
*       REG2=REG2-1;                /* ACCOUNT FOR INCLUSIVE NATURE     01632000
*                                      OF SUB-STRING NOTATION        */ 01633000
*                                                                  0538 01634000
         BCTR  REG2,0                                              0538 01635000
*       /*************************************************************/ 01636000
*       /*                                                           */ 01637000
*       /* MOVE REMAINDER                                            */ 01638000
*       /*                                                           */ 01639000
*       /*************************************************************/ 01640000
*                                                                  0539 01641000
*       TRECFINL(K:K+REG2)=BULDAREA(J:J+REG2);                     0539 01642000
         L     @08,CURREC(,AEDITCBR)                               0539 01643000
         ALR   @10,@08                                             0539 01644000
         BCTR  @10,0                                               0539 01645000
         ALR   @08,J                                               0539 01646000
         EX    REG2,@SM01571                                       0539 01647000
*     END;                                                         0540 01648000
*                                                                  0540 01649000
*   /*****************************************************************/ 01650000
*   /*                                                               */ 01651000
*   /* TRACE RECORD IS NOW COMPLETELY ASSEMBLED                      */ 01652000
*   /*                                                               */ 01653000
*   /*****************************************************************/ 01654000
*                                                                  0541 01655000
*   TRCCOUNT=TRCCOUNT+1;            /* UPDATE TRACE RECORD READ COUNT*/ 01656000
@RF00534 LA    @10,1                                               0541 01657000
         AL    @10,TRCCOUNT                                        0541 01658000
         ST    @10,TRCCOUNT                                        0541 01659000
*   GO TO GETDONE;                  /* GO EXIT TO AMDPRFRM           */ 01660000
         B     GETDONE                                             0542 01661000
*SLQREQ:                                                           0543 01662000
*   REG2=ADDRSAVE+DISP15;           /* ADD OFFSET FOR SLQHEAD  Y02014*/ 01663000
SLQREQ   L     REG2,ADDRSAVE                                       0543 01664000
         AL    REG2,DISP15                                         0543 01665000
*   GEN(BRREAD (R2),DATA,ASID=AID); /* READ FOR POINTER        Y02014*/ 01666000
         BRREAD (R2),DATA,ASID=AID                                      01667000
*   ADDRSAVE=P;                     /* SAVE SLE ADDRESS        Y02014*/ 01668000
         L     @10,P(,REG1)                                        0545 01669000
         ST    @10,ADDRSAVE                                        0545 01670000
*   IDVALID='SLE';                  /* SAVE COMPARE ELEMENT    Y02014*/ 01671000
         MVI   IDVALID+3,C' '                                      0546 01672000
         MVC   IDVALID+4(4),IDVALID+3                              0546 01673000
         MVC   IDVALID(3),@CC01541                                 0546 01674000
*   AID=GTFASID;                    /* READ SLE FROM GTF MEMORY    0547 01675000
*                                                              Y02014*/ 01676000
         STH   GTFASID,AID                                         0547 01677000
*INVALSLE:                          /*                         Y02014*/ 01678000
*   IF ADDRSAVE=0 THEN              /* CHAIN CONTINUES         Y02014*/ 01679000
INVALSLE L     @10,ADDRSAVE                                        0548 01680000
         LTR   @10,@10                                             0548 01681000
         BZ    @RT00548                                            0548 01682000
*     GO TO CHAINERR;               /* GO ISSUE ERR MESSAGE    Y02014*/ 01683000
*   CALL IDCHECK;                   /* CHECK FOR VALID ID      Y02014*/ 01684000
         BAL   @14,IDCHECK                                         0550 01685000
*   REG2=ADDRSAVE+DISP16;           /* ADD OFFSET TO ASID      Y02014*/ 01686000
         L     REG2,ADDRSAVE                                       0551 01687000
         AL    REG2,DISP16                                         0551 01688000
*   GEN(BRREAD (R2),DATA,ASID=AID); /* READ ASID               Y02014*/ 01689000
         BRREAD (R2),DATA,ASID=AID                                      01690000
*   ASIDHOLD=ASIDCOMP;              /* SAVE ASID               Y02014*/ 01691000
         LH    ASIDHOLD,ASIDCOMP(,REG1)                            0553 01692000
*   REG2=ADDRSAVE+DISP17;           /* ADD OFFSET FOR TCB      Y02014*/ 01693000
         L     REG2,ADDRSAVE                                       0554 01694000
         AL    REG2,DISP17                                         0554 01695000
*   GEN(BRREAD (R2),DATA,ASID=AID); /* READ TCB                Y02014*/ 01696000
         BRREAD (R2),DATA,ASID=AID                                      01697000
*   IF(ASIDHOLD^=QASID)|            /* SLE WE'RE LOOKING FOR   Y02014*/ 01698000
*       (TCBHOLD^=ZERO) THEN        /*                         Y02014*/ 01699000
         CH    ASIDHOLD,QASID                                      0556 01700000
         BNE   @RT00556                                            0556 01701000
         CLC   TCBHOLD(4,REG1),ZERO                                0556 01702000
         BE    @RF00556                                            0556 01703000
@RT00556 DS    0H                                                  0557 01704000
*     DO;                           /*                         Y02014*/ 01705000
*       REG2=ADDRSAVE+DISP18;       /* OFFSET FOR CHAIN        Y02014*/ 01706000
         L     REG2,ADDRSAVE                                       0558 01707000
         AL    REG2,DISP18                                         0558 01708000
*       GEN(BRREAD (R2),DATA,ASID=AID);/* READ CHAIN PTR       Y02014*/ 01709000
         BRREAD (R2),DATA,ASID=AID                                      01710000
*       ADDRSAVE=P;                 /* SAVE ADDR OF SLE        Y02014*/ 01711000
         L     @10,P(,REG1)                                        0560 01712000
         ST    @10,ADDRSAVE                                        0560 01713000
*       GO TO INVALSLE;             /* CHECK OUT SLE           Y02014*/ 01714000
         B     INVALSLE                                            0561 01715000
*     END;                          /*                         Y02014*/ 01716000
*   REG2=ADDRSAVE+DISP19;           /* ADD OFFSET TO BCB ADDR  Y02014*/ 01717000
@RF00556 L     REG2,ADDRSAVE                                       0563 01718000
         AL    REG2,DISP19                                         0563 01719000
*   GEN(BRREAD (R2),DATA,ASID=AID); /* READ FOR BCB PTR        Y02014*/ 01720000
         BRREAD (R2),DATA,ASID=AID                                      01721000
*   ADDRSAVE=P;                     /* SAVE BCB ADDRESS        Y02014*/ 01722000
         L     @10,P(,REG1)                                        0565 01723000
         ST    @10,ADDRSAVE                                        0565 01724000
*   GO TO BCBVAL;                   /* GO CHECK OUT BCB        Y02014*/ 01725000
         B     BCBVAL                                              0566 01726000
*NEXTSABF:                          /*                         Y02014*/ 01727000
*   IF THATSALL='1'B THEN           /* ALL AREAS FORMATTED     Y02014*/ 01728000
NEXTSABF TM    THATSALL,B'01000000'                                0567 01729000
         BO    @RT00567                                            0567 01730000
*     GO TO GETFINAL;               /* GO CLEAN UP             Y02014*/ 01731000
*   REG2=ADDRSAVE+DISP20;           /* GET CHAIN PTR           Y02014*/ 01732000
         L     REG2,ADDRSAVE                                       0569 01733000
         AL    REG2,DISP20                                         0569 01734000
*   GEN(BRREAD (R2),DATA,ASID=AID); /* READ FOR GTFBLOK ADDR   Y02014*/ 01735000
         BRREAD (R2),DATA,ASID=AID                                      01736000
*   ADDRSAVE=P;                     /* SAVE GTFBLOK ADDR       Y02014*/ 01737000
         L     @10,P(,REG1)                                        0571 01738000
         ST    @10,ADDRSAVE                                        0571 01739000
*   EIOCUR=ADDRSAVE;                /* SAVE ADDR FOR COMPARISON    0572 01740000
*                                                              Y02014*/ 01741000
         ST    @10,EIOCUR                                          0572 01742000
*   CALL IDCHECK;                   /* CHECK FOR VALID ID      Y02014*/ 01743000
         BAL   @14,IDCHECK                                         0573 01744000
*   COUNT=COUNT+1;                  /* COUNT OF BLOKS FORMATTED    0574 01745000
*                                                              Y02014*/ 01746000
         LA    @10,1                                               0574 01747000
         AL    @10,COUNT                                           0574 01748000
         ST    @10,COUNT                                           0574 01749000
*   GO TO NEWSABUF;                 /* PROCESS NEW GTFBLOK     Y02014*/ 01750000
         B     NEWSABUF                                            0575 01751000
*                                                                  0576 01752000
*/************************************************************ Y02014*/ 01753000
*/*      BUFFER DUMPING ROUTINE                                Y02014*/ 01754000
*/************************************************************ Y02014*/ 01755000
*                                                                  0576 01756000
*HEXBUFDP:                          /*                         Y02014*/ 01757000
*   RFY                                                            0576 01758000
*    (REG2) RSTD;                   /*                         Y02014*/ 01759000
HEXBUFDP DS    0H                                                  0577 01760000
*   FIRSTHSW='0'B;                  /* FIRST TIME SWITCH       Y02014*/ 01761000
         NI    FIRSTHSW(AEDITCBR),B'11101111'                      0577 01762000
*   REG2=ADDRSAVE+DISP14;           /* ADD OFFSET TO AREA      Y02014*/ 01763000
         L     REG2,ADDRSAVE                                       0578 01764000
         AL    REG2,DISP14                                         0578 01765000
*   GEN(BRREAD (R2),DATA,ASID=AID); /* READ IN BIG LL FIELD    Y02014*/ 01766000
         BRREAD (R2),DATA,ASID=AID                                      01767000
*   EIOLL=LL;                       /* SAVE BIG LL VALUE       Y02014*/ 01768000
         LH    @10,LL(,REG1)                                       0580 01769000
         STH   @10,EIOLL                                           0580 01770000
*READAGAN:                          /*                         Y02014*/ 01771000
*   LLSTORE=EIOLL;                  /* SAVE LL VALUE           Y02014*/ 01772000
READAGAN LH    @10,EIOLL                                           0581 01773000
         LR    LLSTORE,@10                                         0581 01774000
*   EIOLL=EIOLL-32;                 /* PRINT 32 BYTES A TIME   Y02014*/ 01775000
         SL    @10,@CF00122                                        0582 01776000
         STH   @10,EIOLL                                           0582 01777000
*   IF EIOLL>=0 THEN                /* A FULL LINE TO PRINT    Y02014*/ 01778000
         SLR   @08,@08                                             0583 01779000
         CR    @10,@08                                             0583 01780000
         BL    @RF00583                                            0583 01781000
*     DO;                           /*                         Y02014*/ 01782000
*       DO I=0 TO 7;                /* 8 READS FOR 32 BYTES    Y02014*/ 01783000
         LR    I,@08                                               0585 01784000
@DL00585 DS    0H                                                  0586 01785000
*         GEN(BRREAD (R2),DATA,ASID=AID);/* READ IN 4 BYTES    Y02014*/ 01786000
         BRREAD (R2),DATA,ASID=AID                                      01787000
*         K=(I*4)+1;                /* COMPUTE OFFSET          Y02014*/ 01788000
         LR    @10,I                                               0587 01789000
         SLA   @10,2                                               0587 01790000
         AL    @10,@CF00076                                        0587 01791000
         STH   @10,K                                               0587 01792000
*         HEXLINE(K:K+3)=TWORD;     /* MOVE BYTES INTO BUFFER  Y02014*/ 01793000
         L     @08,CURREC(,AEDITCBR)                               0588 01794000
         ALR   @08,@10                                             0588 01795000
         BCTR  @08,0                                               0588 01796000
         MVC   HEXLINE(4,@08),TWORD(REG1)                          0588 01797000
*         REG2=REG2+4;              /* POINT TO NEXT WORD      Y02014*/ 01798000
         AL    REG2,@CF00065                                       0589 01799000
*       END;                        /*                         Y02014*/ 01800000
         AL    I,@CF00076                                          0590 01801000
         C     I,@CF00087                                          0590 01802000
         BNH   @DL00585                                            0590 01803000
*     END;                          /*                         Y02014*/ 01804000
*   ELSE                                                           0592 01805000
*     DO;                           /* PARTIAL LINE TO HANDLE  Y02014*/ 01806000
         B     @RC00583                                            0592 01807000
@RF00583 DS    0H                                                  0593 01808000
*       EIOLL=LLSTORE;              /* RESTORE LL VALUE        Y02014*/ 01809000
         STH   LLSTORE,EIOLL                                       0593 01810000
*       IF(EIOLL//4)^=0 THEN        /* LENGTH DIVISABLE BY WD  Y02014*/ 01811000
         LH    @10,EIOLL                                           0594 01812000
         LR    @06,@10                                             0594 01813000
         SRDA  @06,32                                              0594 01814000
         D     @06,@CF00065                                        0594 01815000
         LTR   @06,@06                                             0594 01816000
         BZ    @RF00594                                            0594 01817000
*         EIOBRCT=(EIOLL/4)+1;      /* CALC # READS NECESSARY  Y02014*/ 01818000
         LR    @06,@10                                             0595 01819000
         SRDA  @06,32                                              0595 01820000
         D     @06,@CF00065                                        0595 01821000
         LA    @07,1(,@07)                                         0595 01822000
         STH   @07,EIOBRCT                                         0595 01823000
*       ELSE                                                       0596 01824000
*         EIOBRCT=EIOLL/4;          /* CALC # READS NECESSARY  Y02014*/ 01825000
         B     @RC00594                                            0596 01826000
@RF00594 LH    @06,EIOLL                                           0596 01827000
         SRDA  @06,32                                              0596 01828000
         D     @06,@CF00065                                        0596 01829000
         STH   @07,EIOBRCT                                         0596 01830000
*       DO I=0 TO EIOBRCT-1;        /* SET UP LOOP FOR READS   Y02014*/ 01831000
@RC00594 SLR   I,I                                                 0597 01832000
         B     @DE00597                                            0597 01833000
@DL00597 DS    0H                                                  0598 01834000
*         GEN(BRREAD (R2),DATA,ASID=AID);/* DO READ FOR A WORD Y02014*/ 01835000
         BRREAD (R2),DATA,ASID=AID                                      01836000
*         K=(I*4)+1;                /* CALC OFFSET IN BUFFER   Y02014*/ 01837000
         LR    @10,I                                               0599 01838000
         SLA   @10,2                                               0599 01839000
         AL    @10,@CF00076                                        0599 01840000
         STH   @10,K                                               0599 01841000
*         HEXLINE(K:K+3)=TWORD;     /* MOVE WD TO BUFFER       Y02014*/ 01842000
         L     @08,CURREC(,AEDITCBR)                               0600 01843000
         ALR   @08,@10                                             0600 01844000
         BCTR  @08,0                                               0600 01845000
         MVC   HEXLINE(4,@08),TWORD(REG1)                          0600 01846000
*         REG2=REG2+4;              /* POINT TO NEXT WORD      Y02014*/ 01847000
         AL    REG2,@CF00065                                       0601 01848000
*       END;                        /*                         Y02014*/ 01849000
         AL    I,@CF00076                                          0602 01850000
@DE00597 LH    @10,EIOBRCT                                         0602 01851000
         BCTR  @10,0                                               0602 01852000
         CR    I,@10                                               0602 01853000
         BNH   @DL00597                                            0602 01854000
*       I=EIOLL//4;                 /* CALC # OF EXTRA BYTES   Y02014*/ 01855000
         LH    @06,EIOLL                                           0603 01856000
         SRDA  @06,32                                              0603 01857000
         D     @06,@CF00065                                        0603 01858000
         LR    I,@06                                               0603 01859000
*       IF I^=0 THEN                /* BLANK OUT # OF EXTRA    Y02014*/ 01860000
         LTR   I,I                                                 0604 01861000
         BZ    @RF00604                                            0604 01862000
*         HEXLINE((K+I):(K+3))=BLANKS;/* BYTES READ            Y02014*/ 01863000
         LH    @10,K                                               0605 01864000
         LR    @08,I                                               0605 01865000
         ALR   @08,@10                                             0605 01866000
         L     @04,CURREC(,AEDITCBR)                               0605 01867000
         ALR   @04,@08                                             0605 01868000
         BCTR  @04,0                                               0605 01869000
         SLR   @10,@08                                             0605 01870000
         AL    @10,@CF00198                                        0605 01871000
         EX    @10,@SM01574                                        0605 01872000
*       EIOLL=0;                    /* NO MORE TO FORMAT       Y02014*/ 01873000
@RF00604 SLR   @10,@10                                             0606 01874000
         STH   @10,EIOLL                                           0606 01875000
*     END;                          /*                         Y02014*/ 01876000
*   CALL PRHEX;                     /* GO DUMP BYTES IN HEX    Y02014*/ 01877000
@RC00583 L     @10,AFRMAD(,AEDITCBR)                               0608 01878000
         L     @15,AHEX(,@10)                                      0608 01879000
         BALR  @14,@15                                             0608 01880000
*   IF EIOLL>0 THEN                 /* MORE BUFFER TO DUMP     Y02014*/ 01881000
         LH    @10,EIOLL                                           0609 01882000
         LTR   @10,@10                                             0609 01883000
         BP    @RT00609                                            0609 01884000
*     GO TO READAGAN;               /* GO DUMP NEXT LINE       Y02014*/ 01885000
*   GO TO NEXTSABF;                 /* GO GET NEXT GTFBLOK     Y02014*/ 01886000
         B     NEXTSABF                                            0611 01887000
*                                                                  0612 01888000
*/********************************************************************  01889000
*                                                                    */ 01890000
*/*                                                                  */ 01891000
*/*  ERROR DURING BUFFER LOCATING PROCEDURE                          */ 01892000
*/*                                                                  */ 01893000
*/********************************************************************  01894000
*                                                                    */ 01895000
*                                                                  0612 01896000
*DUMPER:                                                           0612 01897000
*   GEN;                                                           0612 01898000
DUMPER   DS    0H                                                  0612 01899000
         USING *,R15            /* TEMPORARYILY BASE ON REG 15 - EP  */ 01900000
*                               /* ADDRESS                           */ 01901000
         LA    R13,@SA00001     /* POINT TO SAVE AREA          Y02014*/ 01902000
*                               /* *** DEPENDENT ON BSL NAMING ***   */ 01903000
         LM    R14,R12,12(R13)     RELOAD REGISTERS                     01904000
         DROP  R15                 GO BACK TO BSL-S BASE                01905000
*CHAINERR:                          /*                         Y02014*/ 01906000
*   I=39;                           /* LENGTH OF MESSAGE       Y02014*/ 01907000
CHAINERR LA    I,39                                                0613 01908000
*   REG2=ADDR(DUMPERTM);            /* POINT TO DUMP ERROR MESSAGE   */ 01909000
         LA    REG2,DUMPERTM                                       0614 01910000
*/* BRANCH HERE TO PRINT TERMINAL ERROR MESSAGE AND TERMINATE EDIT   */ 01911000
*                                                                  0615 01912000
*WRITERR:                                                          0615 01913000
*   GEN(BRWRITE  SKIP);             /* SKIP TO NEW PAGE              */ 01914000
*                                                                  0615 01915000
WRITERR  BRWRITE  SKIP                                                  01916000
*   /*****************************************************************/ 01917000
*   /*                                                               */ 01918000
*   /* MOVE MESSAGE TO OUTPUT AREA                                   */ 01919000
*   /*                                                               */ 01920000
*   /*****************************************************************/ 01921000
*                                                                  0616 01922000
*   OUTBUF(1:I)=COMNTTXT(1:I);                                     0616 01923000
         L     @10,CURBUF                                          0616 01924000
         LR    @08,I                                               0616 01925000
         BCTR  @08,0                                               0616 01926000
         EX    @08,@SM01576                                        0616 01927000
*   GEN(BRWRITE  1);                /* WRITE MESSAGE ON PRINTER DATA    01928000
*                                      SET                           */ 01929000
         BRWRITE  1                                                     01930000
*   GO TO GETFREE;                  /* GO TO EOF HANDLER TO CLOSE  0618 01931000
*                                      GOWN GET OPERATION            */ 01932000
         B     GETFREE                                             0618 01933000
*                                                                  0619 01934000
*/********************************************************************/ 01935000
*/*      ROUTINE TO VALIDITY CHECK                                   */ 01936000
*/*          CONTROL BLOCK IDS                                 Y02014*/ 01937000
*/********************************************************************/ 01938000
*                                                                  0619 01939000
*IDCHECK:                                                          0619 01940000
*   PROC;                                                          0619 01941000
IDCHECK  STM   @14,@12,@SA00002                                    0619 01942000
*   REG2=ADDRSAVE;                  /* PICK UP PTR TO TABLE    Y02014*/ 01943000
         L     REG2,ADDRSAVE                                       0620 01944000
*   GEN(BRREAD (R2),DATA,ASID=AID); /* READ FOR 1ST 4 BYTES    Y02014*/ 01945000
         BRREAD (R2),DATA,ASID=AID                                      01946000
*   IDHOLD1=TABLEID;                /* SAVE 1ST 4 BYTES        Y02014*/ 01947000
         MVC   IDHOLD1(4),TABLEID(REG1)                            0622 01948000
*   REG2=ADDRSAVE+4;                /* PT TO 2ND 4 BYTES       Y02014*/ 01949000
         LA    REG2,4                                              0623 01950000
         AL    REG2,ADDRSAVE                                       0623 01951000
*   GEN(BRREAD (R2),DATA,ASID=AID); /* READ FOR 2ND 4 BYTES    Y02014*/ 01952000
         BRREAD (R2),DATA,ASID=AID                                      01953000
*   IDHOLD2=TABLEID;                /* SAVE 2ND 4 BYTES        Y02014*/ 01954000
         MVC   IDHOLD2(4),TABLEID(REG1)                            0625 01955000
*   IF ID^=IDVALID THEN             /* IS THIS VALID ID        Y02014*/ 01956000
         CLC   ID(8),IDVALID                                       0626 01957000
         BNE   @RT00626                                            0626 01958000
*     GO TO CHAINERR;               /* NO WRITE ERR MSG        Y02014*/ 01959000
*   END;                            /* END OF PROC             Y02014*/ 01960000
@EL00002 DS    0H                                                  0628 01961000
@EF00002 DS    0H                                                  0628 01962000
@ER00002 LM    @14,@12,@SA00002                                    0628 01963000
         BR    @14                                                 0628 01964000
*   END AMDPRGET                                                   0629 01965000
*                                                                  0629 01966000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 01967000
*/*%INCLUDE SYSLIB  (AMDPRTAB)                                       */ 01968000
*/*%INCLUDE SYSLIB  (IHAASCB )                                       */ 01969000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 01970000
*/*%INCLUDE SYSLIB  (MCHEAD  )                                       */ 01971000
*/*%INCLUDE SYSLIB  (MCCE    )                                       */ 01972000
*/*%INCLUDE SYSLIB  (MCQE    )                                       */ 01973000
*/*%INCLUDE SYSLIB  (GTFPCT  )                                       */ 01974000
*/*%INCLUDE SYSLIB  (SLE     )                                       */ 01975000
*/*%INCLUDE SYSLIB  (GTFBLOK )                                       */ 01976000
*/*%INCLUDE SYSLIB  (GTFBCB  )                                       */ 01977000
*                                                                  0629 01978000
*       ;                                                          0629 01979000
@DATA    DS    0H                                                       01980000
@CH01482 DC    H'4000'                                                  01981000
@SM01571 MVC   TRECFINL(0,@10),BULDAREA-1(@08)                          01982000
@SM01574 MVC   HEXLINE(0,@04),BLANKS                                    01983000
@SM01576 MVC   OUTBUF(0,@10),COMNTTXT(REG2)                             01984000
         DS    0F                                                       01985000
@SA00001 DS    18F                                                      01986000
@SA00002 DS    15F                                                      01987000
         DS    0F                                                       01988000
@CF00076 DC    F'1'                                                     01989000
@CF00109 DC    F'2'                                                     01990000
@CF00198 DC    F'3'                                                     01991000
@CH00198 EQU   @CF00198+2                                               01992000
@CF00065 DC    F'4'                                                     01993000
@CF00087 DC    F'7'                                                     01994000
@CF00039 DC    F'8'                                                     01995000
@CH00039 EQU   @CF00039+2                                               01996000
@CF00122 DC    F'32'                                                    01997000
@CF01251 DC    F'53'                                                    01998000
@CF01539 DC    F'255'                                                   01999000
@CF01337 DC    F'284'                                                   02000000
@CF01192 DC    F'4096'                                                  02001000
@CF01483 DC    XL4'01000000'                                            02002000
@CF01537 DC    XL4'FFFFFFFC'                                            02003000
@CF01538 DC    XL4'00000003'                                            02004000
@CF01570 DC    XL4'0000FFFF'                                            02005000
         DS    0D                                                       02006000
ASCBPTR  DS    A                                                        02007000
CVTPTR   DS    A                                                        02008000
PCTPTR   DS    A                                                        02009000
DISP1    DC    AL4(CVTGTF-CVT)                                          02010000
DISP2    DC    AL4(MCHCUR-MCHEAD)                                       02011000
DISP3    DC    AL4(MCCEQEA-MCCE)                                        02012000
DISP4    DC    AL4(MCQENAME-MCQE)                                       02013000
DISP5    DC    AL4(MCQEMCQE-MCQE)                                       02014000
DISP6    DC    AL4(MCQEAT-MCQE)                                         02015000
DISP7    DC    AL4(HQLENGTH-GTFPCT)                                     02016000
DISP8    DC    AL4(HQHEAD-GTFPCT)                                       02017000
DISP9    DC    AL4(GBUFRPTR-GTFBCB)                                     02018000
DISP10   DC    AL4(BCBCHAIN-GTFBCB)                                     02019000
DISP11   DC    AL4(CURRBLOK-GTFPCT)                                     02020000
DISP12   DC    AL4(NEXTBLOK-GTFPCT)                                     02021000
DISP13   DC    AL4(BLOKUSE-GTFBLOK)                                     02022000
DISP14   DC    AL4(BLOKAREA-GTFBLOK)                                    02023000
DISP15   DC    AL4(SLQHEAD-GTFPCT)                                      02024000
DISP16   DC    AL4(SLEASID-SLE)                                         02025000
DISP17   DC    AL4(SLETCBA-SLE)                                         02026000
DISP18   DC    AL4(SLQCHAIN-SLE)                                        02027000
DISP19   DC    AL4(SLEBCBQ-SLE)                                         02028000
DISP20   DC    AL4(BLKCHAIN-GTFBLOK)                                    02029000
DISP21   DC    AL4(GTFASCB-GTFPCT)                                      02030000
DISP22   DC    AL4(ASCBASID-ASCB)                                       02031000
ADDRSAVE DS    A                                                        02032000
BUFFCNT  DS    F                                                        02033000
BUFPTR   DS    A                                                        02034000
RECPTR   DS    A                                                        02035000
PCTSAVE  DS    A                                                        02036000
ZERO     DC    XL4'00'                                                  02037000
ADDRMASK DC    XL4'00FFFFFF'                                            02038000
COUNT    DC    F'0'                                                     02039000
K        DS    H                                                        02040000
TWO84    DC    H'284'                                                   02041000
AID      DC    AL2(0)                                                   02042000
@CC01502 DC    C'        '                                              02043000
@CC01530 DC    C'GTFBLOK'                                               02044000
@CC01507 DC    C'MCHEAD'                                                02045000
@CC01515 DC    C'GTFPCT'                                                02046000
@CC01518 DC    C'GTFBCB'                                                02047000
@CC01509 DC    C'MCCE'                                                  02048000
@CC01510 DC    C'MCQE'                                                  02049000
@CC01514 DC    C'GTF '                                                  02050000
@CC01541 DC    C'SLE'                                                   02051000
@CB01261 DC    X'00000000'                                              02052000
SRB      DS    CL4                                                      02053000
         DS    CL2                                                      02054000
EIOCTL   DS    CL48                                                     02055000
         ORG   EIOCTL                                                   02056000
EIOFLGS  DC    X'00000000'                                              02057000
         ORG   EIOFLGS                                                  02058000
FIRSTGET DS    BL1                                                      02059000
OPENFAIL EQU   EIOFLGS+0                                                02060000
DAWRAP   EQU   EIOFLGS+0                                                02061000
PSITWRAP EQU   EIOFLGS+0                                                02062000
FRSTWRAP EQU   EIOFLGS+0                                                02063000
CLOSE    EQU   EIOFLGS+0                                                02064000
SYNADSW  EQU   EIOFLGS+0                                                02065000
         ORG   EIOCTL+4                                                 02066000
EIOSTOR  DS    FL4                                                      02067000
EIOVARIB DS    CL40                                                     02068000
         ORG   EIOCTL+48                                                02069000
BUFADDR  DS    CL8                                                      02070000
         ORG   BUFADDR                                                  02071000
BUFFER   DS    AL4                                                      02072000
BUFL     DS    AL4                                                      02073000
         ORG   BUFADDR+8                                                02074000
LNGTH    DS    CL8                                                      02075000
         ORG   LNGTH                                                    02076000
LNGTH1   DS    AL4                                                      02077000
LNGTH2   DS    AL4                                                      02078000
         ORG   LNGTH+8                                                  02079000
ERMSG    DC    CL12'I/O ERROR ON'                                       02080000
LLERR    DC    CL53'TRACE RECORD LL INVALID, DD XXXXXXXX  BLOCK NO XXXXC02081000
               XX'                                                      02082000
TERMSG   DC    CL38'- EDIT PROCESSING TERMINATED'                       02083000
CONMSG   DC    CL12'- CONTINUING'                                       02084000
NOTACMSG DC    CL30'GTF NOT ACTIVE AT TIME OF DUMP'                     02085000
DUMPERCN DC    CL49'ERROR IN GTF BUFFER - CONTINUING WITH NEXT BUFFER'  02086000
DUMPERTM DC    CL39'ERROR IN GTF BUFFER CONTROL BLOCK CHAIN'            02087000
GETPTCH  DC    CL200'GETPTCH'                                           02088000
IDVALID  DS    CL8                                                      02089000
ID       DS    CL8                                                      02090000
         ORG   ID                                                       02091000
IDHOLD1  DS    CL4                                                      02092000
IDHOLD2  DS    CL4                                                      02093000
         ORG   ID+8                                                     02094000
GETSWITS DC    B'00000000'                                              02095000
         ORG   GETSWITS                                                 02096000
BLOKPROC DS    BL1                                                      02097000
THATSALL EQU   GETSWITS+0                                               02098000
@NM00024 EQU   GETSWITS+0                                               02099000
         ORG   GETSWITS+1                                               02100000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02101000
@01      EQU   01                                                       02102000
@02      EQU   02                                                       02103000
@03      EQU   03                                                       02104000
@04      EQU   04                                                       02105000
@05      EQU   05                                                       02106000
@06      EQU   06                                                       02107000
@07      EQU   07                                                       02108000
@08      EQU   08                                                       02109000
@09      EQU   09                                                       02110000
@10      EQU   10                                                       02111000
@11      EQU   11                                                       02112000
@12      EQU   12                                                       02113000
@13      EQU   13                                                       02114000
@14      EQU   14                                                       02115000
@15      EQU   15                                                       02116000
LLSTORE  EQU   @03                                                      02117000
GTFASID  EQU   @03                                                      02118000
ASCBGTF  EQU   @03                                                      02119000
ASIDHOLD EQU   @03                                                      02120000
J        EQU   @06                                                      02121000
I        EQU   @03                                                      02122000
AEDITCBR EQU   @09                                                      02123000
REG0     EQU   @00                                                      02124000
REG1     EQU   @01                                                      02125000
REG2     EQU   @02                                                      02126000
REG8     EQU   @08                                                      02127000
REG14    EQU   @14                                                      02128000
REG15    EQU   @15                                                      02129000
COMMONRG EQU   @12                                                      02130000
PRTABREG EQU   @09                                                      02131000
         ENTRY GETPTCH                                                  02132000
AMDPRTAB EQU   0                                                        02133000
AFMG     EQU   AMDPRTAB                                                 02134000
CURREC   EQU   AMDPRTAB+4                                               02135000
DEBGFLGS EQU   AMDPRTAB+8                                               02136000
PTHFLGS1 EQU   DEBGFLGS                                                 02137000
GET      EQU   PTHFLGS1                                                 02138000
PTHFLGS2 EQU   DEBGFLGS+1                                               02139000
INRFCFGS EQU   DEBGFLGS+2                                               02140000
TERM     EQU   INRFCFGS                                                 02141000
EXTTRC   EQU   INRFCFGS                                                 02142000
IOFLGS   EQU   DEBGFLGS+3                                               02143000
GETEOF   EQU   IOFLGS                                                   02144000
USEREXIT EQU   AMDPRTAB+24                                              02145000
DDNAME   EQU   AMDPRTAB+32                                              02146000
STARTIME EQU   AMDPRTAB+40                                              02147000
STOPTIME EQU   AMDPRTAB+52                                              02148000
NAMES    EQU   AMDPRTAB+64                                              02149000
ADS      EQU   AMDPRTAB+104                                             02150000
AADS     EQU   ADS                                                      02151000
SIF      EQU   AMDPRTAB+124                                             02152000
SIOFLGS  EQU   SIF                                                      02153000
DVADS1   EQU   AMDPRTAB+128                                             02154000
IO       EQU   AMDPRTAB+228                                             02155000
IOFLGS2  EQU   IO                                                       02156000
DVADS2   EQU   AMDPRTAB+232                                             02157000
VCF      EQU   AMDPRTAB+332                                             02158000
SVCFLGS  EQU   VCF                                                      02159000
USR      EQU   AMDPRTAB+368                                             02160000
USRFLGS  EQU   USR                                                      02161000
USRTAB   EQU   AMDPRTAB+372                                             02162000
PI       EQU   AMDPRTAB+452                                             02163000
PIFLGS   EQU   PI                                                       02164000
PGMNGEN  EQU   AMDPRTAB+456                                             02165000
GENFLAGS EQU   PGMNGEN+3                                                02166000
EOF      EQU   GENFLAGS                                                 02167000
GENFLGS1 EQU   AMDPRTAB+460                                             02168000
EOFINPRO EQU   GENFLGS1                                                 02169000
TSFOUND  EQU   GENFLGS1                                                 02170000
FIRSTHSW EQU   GENFLGS1                                                 02171000
RECDLL   EQU   AMDPRTAB+461                                             02172000
AEIOCT   EQU   AMDPRTAB+476                                             02173000
AFRMAD   EQU   AMDPRTAB+488                                             02174000
ESTARTME EQU   AMDPRTAB+500                                             02175000
ESTOPTME EQU   AMDPRTAB+509                                             02176000
ASCB     EQU   0                                                        02177000
ASCBASID EQU   ASCB+36                                                  02178000
ASCBFW1  EQU   ASCB+100                                                 02179000
ASCBRCTF EQU   ASCBFW1+2                                                02180000
ASCBFLG1 EQU   ASCBFW1+3                                                02181000
ASCBDSP1 EQU   ASCB+114                                                 02182000
ASCBFLG2 EQU   ASCB+115                                                 02183000
CVTMAP   EQU   0                                                        02184000
CVT      EQU   CVTMAP                                                   02185000
CVTDAR   EQU   CVTMAP+72                                                02186000
CVTFLGS1 EQU   CVTDAR                                                   02187000
CVTDCB   EQU   CVTMAP+116                                               02188000
CVTIOQET EQU   CVTMAP+120                                               02189000
CVTIERLC EQU   CVTMAP+144                                               02190000
CVTHEAD  EQU   CVTMAP+160                                               02191000
CVTSV76C EQU   CVTHEAD                                                  02192000
CVTOPTA  EQU   CVTMAP+182                                               02193000
CVTOPTB  EQU   CVTMAP+183                                               02194000
CVTGTF   EQU   CVTMAP+236                                               02195000
CVTGTFST EQU   CVTGTF                                                   02196000
CVTGTFS  EQU   CVTGTFST                                                 02197000
CVTSTATE EQU   CVTGTFST                                                 02198000
CVTTMODE EQU   CVTGTFST                                                 02199000
CVTFORM  EQU   CVTGTFST                                                 02200000
CVTGTFA  EQU   CVTGTF+1                                                 02201000
CVTAQAVT EQU   CVTMAP+240                                               02202000
CVTTCMFG EQU   CVTAQAVT                                                 02203000
CVTVOLM2 EQU   CVTMAP+244                                               02204000
CVTTATA  EQU   CVTVOLM2                                                 02205000
CVTTSKS  EQU   CVTTATA                                                  02206000
CVTVOLF2 EQU   CVTTSKS                                                  02207000
CVTTAT   EQU   CVTTATA+1                                                02208000
CVTATER  EQU   CVTMAP+248                                               02209000
CVTEXT1  EQU   CVTMAP+252                                               02210000
CVTPURG  EQU   CVTMAP+260                                               02211000
CVTQMSG  EQU   CVTMAP+268                                               02212000
CVTDMSR  EQU   CVTMAP+272                                               02213000
CVTRSV37 EQU   CVTDMSR                                                  02214000
CVTDMSRF EQU   CVTRSV37                                                 02215000
CVTERPV  EQU   CVTMAP+316                                               02216000
CVTINTLA EQU   CVTMAP+320                                               02217000
CVTAPF   EQU   CVTMAP+324                                               02218000
CVTEXT2  EQU   CVTMAP+328                                               02219000
CVTHJES  EQU   CVTMAP+332                                               02220000
CVTPGSIA EQU   CVTMAP+348                                               02221000
CVTA1F1  EQU   CVTMAP+356                                               02222000
CVTSYSK  EQU   CVTMAP+357                                               02223000
CVTVOLM1 EQU   CVTMAP+380                                               02224000
CVTVOLF1 EQU   CVTVOLM1                                                 02225000
CVTATMCT EQU   CVTMAP+388                                               02226000
CVTXTNT1 EQU   0                                                        02227000
CVTXTNT2 EQU   0                                                        02228000
CVTDSSV  EQU   CVTXTNT2                                                 02229000
CVTFLGBT EQU   CVTXTNT2+5                                               02230000
CVTQID   EQU   CVTXTNT2+24                                              02231000
CVTRV400 EQU   CVTXTNT2+52                                              02232000
CVTRV409 EQU   CVTXTNT2+53                                              02233000
CVTATCVT EQU   CVTXTNT2+64                                              02234000
CVTRV429 EQU   CVTXTNT2+84                                              02235000
CVTRV438 EQU   CVTXTNT2+85                                              02236000
CVTRV457 EQU   CVTXTNT2+112                                             02237000
CVTRV466 EQU   CVTXTNT2+113                                             02238000
CVTFIX   EQU   0                                                        02239000
CVTRELNO EQU   CVTFIX+252                                               02240000
MCHEAD   EQU   0                                                        02241000
MCHCUR   EQU   MCHEAD+8                                                 02242000
MCHFLGS  EQU   MCHEAD+24                                                02243000
MCHFLG1  EQU   MCHFLGS                                                  02244000
MCCE     EQU   0                                                        02245000
MCCEQEA  EQU   MCCE+16                                                  02246000
MCQE     EQU   0                                                        02247000
MCQENAME EQU   MCQE+8                                                   02248000
MCQEMCQE EQU   MCQE+20                                                  02249000
MCQEAT   EQU   MCQE+32                                                  02250000
MCQEFLGS EQU   MCQE+41                                                  02251000
GTFPCT   EQU   0                                                        02252000
GTFSTAT  EQU   GTFPCT+8                                                 02253000
GTFOPTS  EQU   GTFPCT+12                                                02254000
GTFOPTS1 EQU   GTFOPTS                                                  02255000
GTFOPTS2 EQU   GTFOPTS+1                                                02256000
GTFOPTS3 EQU   GTFOPTS+2                                                02257000
GTFOPTS4 EQU   GTFOPTS+3                                                02258000
PCTCATF  EQU   GTFPCT+16                                                02259000
HQHEAD   EQU   GTFPCT+132                                               02260000
HQLENGTH EQU   GTFPCT+140                                               02261000
SLQHEAD  EQU   GTFPCT+144                                               02262000
NEXTBLOK EQU   GTFPCT+180                                               02263000
CURRBLOK EQU   GTFPCT+184                                               02264000
WRTRCOM  EQU   GTFPCT+204                                               02265000
TRMWRIT  EQU   GTFPCT+212                                               02266000
WRTRERR  EQU   GTFPCT+216                                               02267000
GTFSSRB  EQU   GTFPCT+220                                               02268000
QLOCKWRD EQU   GTFPCT+236                                               02269000
QLOCKECB EQU   GTFPCT+240                                               02270000
AUDITFLG EQU   GTFPCT+296                                               02271000
GTFASCB  EQU   GTFPCT+300                                               02272000
SLE      EQU   0                                                        02273000
SLQCHAIN EQU   SLE+8                                                    02274000
SLEHOOK  EQU   SLE+12                                                   02275000
SLEDUMP  EQU   SLEHOOK+2                                                02276000
SLEASID  EQU   SLEDUMP                                                  02277000
SLETCBA  EQU   SLEDUMP+2                                                02278000
SLEPGLST EQU   SLE+20                                                   02279000
SLEBCBQ  EQU   SLE+24                                                   02280000
SLEFLAGS EQU   SLE+32                                                   02281000
SVCPLIST EQU   0                                                        02282000
PAGELIST EQU   SVCPLIST+4                                               02283000
GTFBLOK  EQU   0                                                        02284000
BLKCHAIN EQU   GTFBLOK+8                                                02285000
BLOKAREA EQU   GTFBLOK+12                                               02286000
BLOKUSE  EQU   BLOKAREA+2                                               02287000
GTFBCB   EQU   0                                                        02288000
BCBSWAP  EQU   GTFBCB+8                                                 02289000
BCBQFLAG EQU   BCBSWAP                                                  02290000
BCBCHAIN EQU   GTFBCB+12                                                02291000
HQCHAIN  EQU   BCBCHAIN                                                 02292000
WQCHAIN  EQU   HQCHAIN                                                  02293000
EQCHAIN  EQU   WQCHAIN                                                  02294000
RQCHAIN  EQU   EQCHAIN                                                  02295000
GBUFRPTR EQU   GTFBCB+16                                                02296000
GTFBUFR  EQU   0                                                        02297000
CMPWKA   EQU   0                                                        02298000
SWAPBCB  EQU   CMPWKA+4                                                 02299000
@NM00017 EQU   SWAPBCB                                                  02300000
FRMATAB  EQU   0                                                        02301000
AGET     EQU   FRMATAB                                                  02302000
AHEX     EQU   FRMATAB+4                                                02303000
ACON     EQU   FRMATAB+8                                                02304000
AFLT     EQU   FRMATAB+12                                               02305000
AAPP     EQU   FRMATAB+16                                               02306000
AEXT     EQU   FRMATAB+20                                               02307000
ASPI     EQU   FRMATAB+28                                               02308000
ATME     EQU   FRMATAB+32                                               02309000
PRHEX    EQU   0                                                        02310000
PREXT    EQU   0                                                        02311000
AMDPRE11 EQU   52                                                       02312000
RECMAP   EQU   0                                                        02313000
RECLL    EQU   RECMAP                                                   02314000
RECAID   EQU   RECMAP+4                                                 02315000
RECFID   EQU   RECMAP+5                                                 02316000
RECTIME  EQU   RECMAP+6                                                 02317000
RECTOD   EQU   RECTIME                                                  02318000
TRECBULD EQU   0                                                        02319000
TRECFINL EQU   TRECBULD                                                 02320000
BULDAREA EQU   TRECBULD+284                                             02321000
TWORD    EQU   0                                                        02322000
CVTGTFM  EQU   0                                                        02323000
CVTGTFFG EQU   CVTGTFM                                                  02324000
CVTGTFAT EQU   CVTGTFFG                                                 02325000
AMDPRE01 EQU   0                                                        02326000
MSGAD    EQU   0                                                        02327000
MSGTEXT  EQU   4                                                        02328000
COMNTTXT EQU   0                                                        02329000
SYNADBUF EQU   50                                                       02330000
OUTBUF   EQU   1                                                        02331000
P        EQU   0                                                        02332000
P2       EQU   P                                                        02333000
LL       EQU   0                                                        02334000
HALFLL   EQU   0                                                        02335000
TABLEID  EQU   0                                                        02336000
GTFBUF   EQU   0                                                        02337000
BLL      EQU   GTFBUF                                                   02338000
RECORD   EQU   0                                                        02339000
LLL      EQU   RECORD                                                   02340000
USECNT   EQU   0                                                        02341000
ASIDCOMP EQU   0                                                        02342000
TCBHOLD  EQU   0                                                        02343000
HEXLINE  EQU   0                                                        02344000
PRAPP    EQU   0                                                        02345000
PRCON    EQU   0                                                        02346000
PRFLT    EQU   0                                                        02347000
PRGET    EQU   0                                                        02348000
PRSPI    EQU   0                                                        02349000
PRTME    EQU   0                                                        02350000
CVTS01   EQU   CVTPGSIA                                                 02351000
CVTLPDIA EQU   CVTS01+12                                                02352000
CVTDIRST EQU   CVTLPDIA                                                 02353000
CVTSLIDA EQU   CVTS01+24                                                02354000
CVTCTLFG EQU   CVTS01+50                                                02355000
CVTRV210 EQU   CVTS01+424                                               02356000
CVTRV219 EQU   CVTS01+425                                               02357000
CVTRV228 EQU   CVTS01+426                                               02358000
CVTRV237 EQU   CVTS01+427                                               02359000
CVTMFRTR EQU   CVTS01+452                                               02360000
CVTRV262 EQU   CVTS01+468                                               02361000
CVTRV271 EQU   CVTS01+469                                               02362000
CVTRV280 EQU   CVTS01+470                                               02363000
CVTRV289 EQU   CVTS01+471                                               02364000
CVTGSDA  EQU   CVTS01+600                                               02365000
EIOEXT   EQU   EIOVARIB                                                 02366000
EIOTIME  EQU   EIOEXT                                                   02367000
EIOTOD   EQU   EIOTIME                                                  02368000
EIOERCT  EQU   EIOEXT+8                                                 02369000
EIODEV   EQU   EIOEXT+12                                                02370000
EIODCB   EQU   EIOEXT+20                                                02371000
EIODCBEX EQU   EIOEXT+24                                                02372000
EIOX1    EQU   EIODCBEX                                                 02373000
EIOR14SV EQU   EIOEXT+32                                                02374000
EIODUMP  EQU   EIOVARIB                                                 02375000
EIOSTOP  EQU   EIODUMP                                                  02376000
EIOCUR   EQU   EIODUMP+4                                                02377000
EIOREC   EQU   EIODUMP+8                                                02378000
EIOLL    EQU   EIODUMP+12                                               02379000
EIOBRCT  EQU   EIODUMP+14                                               02380000
EIOBR    EQU   EIODUMP+16                                               02381000
EIORECLL EQU   EIODUMP+18                                               02382000
EIOERR   EQU   EIODUMP+32                                               02383000
LLVAL    EQU   RECLL                                                    02384000
SWS      EQU   SWF                                                      02385000
SADMP    EQU   SWS                                                      02386000
BLDAREA  EQU   BUFFER                                                   02387000
BLOKSWAP EQU   BLKCHAIN                                                 02388000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02389000
@NM00021 EQU   SWS                                                      02390000
@NM00020 EQU   SWS                                                      02391000
EIORES4  EQU   EIODUMP+36                                               02392000
EIORES3  EQU   EIODUMP+20                                               02393000
EIOPICA  EQU   EIOEXT+28                                                02394000
EIOX2    EQU   EIODCBEX+1                                               02395000
EIORES2  EQU   EIOEXT+10                                                02396000
CVTRV628 EQU   CVTS01+728                                               02397000
CVTRV627 EQU   CVTS01+724                                               02398000
CVTRV626 EQU   CVTS01+720                                               02399000
CVTRV625 EQU   CVTS01+716                                               02400000
CVTRV624 EQU   CVTS01+712                                               02401000
CVTRV623 EQU   CVTS01+708                                               02402000
CVTRV622 EQU   CVTS01+704                                               02403000
CVTRV621 EQU   CVTS01+700                                               02404000
CVTIHASU EQU   CVTS01+696                                               02405000
CVTRV619 EQU   CVTS01+692                                               02406000
CVTRV618 EQU   CVTS01+688                                               02407000
CVTRV617 EQU   CVTS01+684                                               02408000
CVTRV616 EQU   CVTS01+680                                               02409000
CVTRV615 EQU   CVTS01+676                                               02410000
CVTRV614 EQU   CVTS01+672                                               02411000
CVTRV613 EQU   CVTS01+668                                               02412000
CVTTCASP EQU   CVTS01+664                                               02413000
CVT0PT03 EQU   CVTS01+660                                               02414000
CVT0PT0E EQU   CVTS01+656                                               02415000
CVTRV609 EQU   CVTS01+652                                               02416000
CVTCGK   EQU   CVTS01+648                                               02417000
CVTRAC   EQU   CVTS01+644                                               02418000
CVTHSM   EQU   CVTS01+640                                               02419000
CVTRV605 EQU   CVTS01+636                                               02420000
CVTRV604 EQU   CVTS01+632                                               02421000
CVTEFF02 EQU   CVTS01+628                                               02422000
CVTCBBR  EQU   CVTS01+624                                               02423000
CVTSSCR  EQU   CVTS01+620                                               02424000
CVTEVENT EQU   CVTS01+616                                               02425000
CVTCRCA  EQU   CVTS01+612                                               02426000
CVTTPIO  EQU   CVTS01+608                                               02427000
CVTADV   EQU   CVTS01+604                                               02428000
CVTGSDAB EQU   CVTGSDA                                                  02429000
CVTQV3   EQU   CVTS01+596                                               02430000
CVTQV2   EQU   CVTS01+592                                               02431000
CVTQV1   EQU   CVTS01+588                                               02432000
CVTRPT   EQU   CVTS01+584                                               02433000
CVTSSRB  EQU   CVTS01+580                                               02434000
CVTCSDRL EQU   CVTS01+576                                               02435000
CVTEXP1  EQU   CVTS01+572                                               02436000
CVTRMPMT EQU   CVTS01+568                                               02437000
CVTRMPTT EQU   CVTS01+564                                               02438000
CVTVPSA  EQU   CVTS01+560                                               02439000
CVTVSTOP EQU   CVTS01+556                                               02440000
CVTGTFR8 EQU   CVTS01+552                                               02441000
CVTQUIT  EQU   CVTS01+548                                               02442000
CVTVACR  EQU   CVTS01+544                                               02443000
CVTWTCB  EQU   CVTS01+540                                               02444000
CVTSTPRS EQU   CVTS01+536                                               02445000
CVT0PT02 EQU   CVTS01+532                                               02446000
CVTDARCM EQU   CVTS01+528                                               02447000
CVTIRECM EQU   CVTS01+524                                               02448000
CVTJRECM EQU   CVTS01+520                                               02449000
CVTVEMS0 EQU   CVTS01+516                                               02450000
CVTSPFRR EQU   CVTS01+512                                               02451000
CVTRLSTG EQU   CVTS01+508                                               02452000
CVT0TC0A EQU   CVTS01+504                                               02453000
CVTGMBR  EQU   CVTS01+500                                               02454000
CVTLFRM  EQU   CVTS01+496                                               02455000
CVTRMBR  EQU   CVTS01+492                                               02456000
CVTVIOP  EQU   CVTS01+488                                               02457000
CVTRV307 EQU   CVTS01+486                                               02458000
CVTRV306 EQU   CVTS01+484                                               02459000
CVTRV305 EQU   CVTS01+482                                               02460000
CVTRV304 EQU   CVTS01+480                                               02461000
CVTRV303 EQU   CVTS01+478                                               02462000
CVTRV302 EQU   CVTS01+476                                               02463000
CVTTRCA  EQU   CVTS01+472                                               02464000
CVTRV297 EQU   CVTRV289                                                 02465000
CVTRV296 EQU   CVTRV289                                                 02466000
CVTRV295 EQU   CVTRV289                                                 02467000
CVTRV294 EQU   CVTRV289                                                 02468000
CVTRV293 EQU   CVTRV289                                                 02469000
CVTRV292 EQU   CVTRV289                                                 02470000
CVTRV291 EQU   CVTRV289                                                 02471000
CVTRV290 EQU   CVTRV289                                                 02472000
CVTRV288 EQU   CVTRV280                                                 02473000
CVTRV287 EQU   CVTRV280                                                 02474000
CVTRV286 EQU   CVTRV280                                                 02475000
CVTRV285 EQU   CVTRV280                                                 02476000
CVTRV284 EQU   CVTRV280                                                 02477000
CVTRV283 EQU   CVTRV280                                                 02478000
CVTRV282 EQU   CVTRV280                                                 02479000
CVTRV281 EQU   CVTRV280                                                 02480000
CVTRV279 EQU   CVTRV271                                                 02481000
CVTRV278 EQU   CVTRV271                                                 02482000
CVTRV277 EQU   CVTRV271                                                 02483000
CVTRV276 EQU   CVTRV271                                                 02484000
CVTRV275 EQU   CVTRV271                                                 02485000
CVTRV274 EQU   CVTRV271                                                 02486000
CVTRV273 EQU   CVTRV271                                                 02487000
CVTRV272 EQU   CVTRV271                                                 02488000
CVTRV270 EQU   CVTRV262                                                 02489000
CVTRV269 EQU   CVTRV262                                                 02490000
CVTRV268 EQU   CVTRV262                                                 02491000
CVTRV267 EQU   CVTRV262                                                 02492000
CVTRV266 EQU   CVTRV262                                                 02493000
CVTRV265 EQU   CVTRV262                                                 02494000
CVTRV264 EQU   CVTRV262                                                 02495000
CVTRV263 EQU   CVTRV262                                                 02496000
CVTVFP   EQU   CVTS01+464                                               02497000
CVTVSI   EQU   CVTS01+460                                               02498000
CVTVPSIB EQU   CVTS01+456                                               02499000
CVTMFACT EQU   CVTMFRTR                                                 02500000
CVTMFCTL EQU   CVTS01+448                                               02501000
CVTPVBP  EQU   CVTS01+444                                               02502000
CVTPWI   EQU   CVTS01+440                                               02503000
CVTRV254 EQU   CVTS01+438                                               02504000
CVTRV253 EQU   CVTS01+436                                               02505000
CVTRV252 EQU   CVTS01+434                                               02506000
CVTRV251 EQU   CVTS01+433                                               02507000
CVTRV250 EQU   CVTS01+432                                               02508000
CVTRV249 EQU   CVTS01+431                                               02509000
CVTRV248 EQU   CVTS01+430                                               02510000
CVTRV247 EQU   CVTS01+429                                               02511000
CVTRV246 EQU   CVTS01+428                                               02512000
CVTRV245 EQU   CVTRV237                                                 02513000
CVTRV244 EQU   CVTRV237                                                 02514000
CVTRV243 EQU   CVTRV237                                                 02515000
CVTRV242 EQU   CVTRV237                                                 02516000
CVTRV241 EQU   CVTRV237                                                 02517000
CVTRV240 EQU   CVTRV237                                                 02518000
CVTRV239 EQU   CVTRV237                                                 02519000
CVTRV238 EQU   CVTRV237                                                 02520000
CVTRV236 EQU   CVTRV228                                                 02521000
CVTRV235 EQU   CVTRV228                                                 02522000
CVTRV234 EQU   CVTRV228                                                 02523000
CVTRV233 EQU   CVTRV228                                                 02524000
CVTRV232 EQU   CVTRV228                                                 02525000
CVTRV231 EQU   CVTRV228                                                 02526000
CVTRV230 EQU   CVTRV228                                                 02527000
CVTRV229 EQU   CVTRV228                                                 02528000
CVTRV227 EQU   CVTRV219                                                 02529000
CVTRV226 EQU   CVTRV219                                                 02530000
CVTRV225 EQU   CVTRV219                                                 02531000
CVTRV224 EQU   CVTRV219                                                 02532000
CVTRV223 EQU   CVTRV219                                                 02533000
CVTRV222 EQU   CVTRV219                                                 02534000
CVTRV221 EQU   CVTRV219                                                 02535000
CVTRV220 EQU   CVTRV219                                                 02536000
CVTRV218 EQU   CVTRV210                                                 02537000
CVTRV217 EQU   CVTRV210                                                 02538000
CVTRV216 EQU   CVTRV210                                                 02539000
CVTRV215 EQU   CVTRV210                                                 02540000
CVTRV214 EQU   CVTRV210                                                 02541000
CVTRV213 EQU   CVTRV210                                                 02542000
CVTRV212 EQU   CVTRV210                                                 02543000
CVTRV211 EQU   CVTRV210                                                 02544000
CVTLCCAT EQU   CVTS01+420                                               02545000
CVTPCCAT EQU   CVTS01+416                                               02546000
CVTIPCRP EQU   CVTS01+412                                               02547000
CVTIPCRI EQU   CVTS01+408                                               02548000
CVTIPCDS EQU   CVTS01+404                                               02549000
CVTAIDVT EQU   CVTS01+400                                               02550000
CVTSSAP  EQU   CVTS01+396                                               02551000
CVTEHCIR EQU   CVTS01+392                                               02552000
CVTEHDEF EQU   CVTS01+388                                               02553000
CVTDAIR  EQU   CVTS01+384                                               02554000
CVTPERFM EQU   CVTS01+380                                               02555000
CVT044R2 EQU   CVTS01+376                                               02556000
CVTFETCH EQU   CVTS01+372                                               02557000
CVTRSTWD EQU   CVTS01+368                                               02558000
CVTSPOST EQU   CVTS01+364                                               02559000
CVTIOBP  EQU   CVTS01+360                                               02560000
CVTASMVT EQU   CVTS01+356                                               02561000
CVTRECRQ EQU   CVTS01+352                                               02562000
CVTWSAC  EQU   CVTS01+348                                               02563000
CVTRV149 EQU   CVTS01+344                                               02564000
CVTWSAL  EQU   CVTS01+340                                               02565000
CVTSPSA  EQU   CVTS01+336                                               02566000
CVTGLMN  EQU   CVTS01+332                                               02567000
CVTVEAC0 EQU   CVTS01+328                                               02568000
CVT062R1 EQU   CVTS01+324                                               02569000
CVTRPOST EQU   CVTS01+320                                               02570000
CVTDQIQE EQU   CVTS01+316                                               02571000
CVTCSD   EQU   CVTS01+312                                               02572000
CVTLKRMA EQU   CVTS01+308                                               02573000
CVTRSPIE EQU   CVTS01+304                                               02574000
CVTRENQ  EQU   CVTS01+300                                               02575000
CVTLQCB  EQU   CVTS01+296                                               02576000
CVTFQCB  EQU   CVTS01+292                                               02577000
CVTQCS01 EQU   CVTS01+288                                               02578000
CVTAPFT  EQU   CVTS01+284                                               02579000
CVTPARRL EQU   CVTS01+280                                               02580000
CVTVWAIT EQU   CVTS01+276                                               02581000
CVTGSPL  EQU   CVTS01+272                                               02582000
CVTLSMQ  EQU   CVTS01+268                                               02583000
CVTGSMQ  EQU   CVTS01+264                                               02584000
CVTEXPRO EQU   CVTS01+260                                               02585000
CVTOPCTP EQU   CVTS01+256                                               02586000
CVTSIC   EQU   CVTS01+252                                               02587000
CVTTPIOS EQU   CVTS01+248                                               02588000
CVTRTMS  EQU   CVTS01+244                                               02589000
CVTSDBF  EQU   CVTS01+240                                               02590000
CVTSCBP  EQU   CVTS01+236                                               02591000
CVTSDMP  EQU   CVTS01+232                                               02592000
CVTSV60  EQU   CVTS01+228                                               02593000
CVTRTMCT EQU   CVTS01+224                                               02594000
CVTASCBL EQU   CVTS01+220                                               02595000
CVTASCBH EQU   CVTS01+216                                               02596000
CVTGDA   EQU   CVTS01+212                                               02597000
CVTASVT  EQU   CVTS01+208                                               02598000
CVTVVMDI EQU   CVTS01+204                                               02599000
CVTAQTOP EQU   CVTS01+200                                               02600000
CVTIOSCS EQU   CVTS01+196                                               02601000
CVTSDRM  EQU   CVTS01+192                                               02602000
CVTOPTE  EQU   CVTS01+188                                               02603000
CVTSTXU  EQU   CVTS01+184                                               02604000
CVTQUIS  EQU   CVTS01+180                                               02605000
CVTPARS  EQU   CVTS01+176                                               02606000
CVTS1EE  EQU   CVTS01+172                                               02607000
CVTFRAS  EQU   CVTS01+168                                               02608000
CVTQSAS  EQU   CVTS01+164                                               02609000
CVTCRAS  EQU   CVTS01+160                                               02610000
CVTCRMN  EQU   CVTS01+156                                               02611000
CVTDELCP EQU   CVTS01+152                                               02612000
CVTFRECL EQU   CVTS01+148                                               02613000
CVTGETCL EQU   CVTS01+144                                               02614000
CVTBLDCP EQU   CVTS01+140                                               02615000
CVTAUTHL EQU   CVTS01+136                                               02616000
CVTSCAN  EQU   CVTS01+132                                               02617000
CVTRV144 EQU   CVTS01+130                                               02618000
CVTMAXMP EQU   CVTS01+128                                               02619000
CVTSTCK  EQU   CVTS01+124                                               02620000
CVTRV139 EQU   CVTS01+123                                               02621000
CVTDSSAC EQU   CVTS01+122                                               02622000
CVTRV513 EQU   CVTS01+121                                               02623000
CVTIOSPL EQU   CVTS01+120                                               02624000
CVTPTGT  EQU   CVTS01+116                                               02625000
CVTCSPIE EQU   CVTS01+112                                               02626000
CVTSMFEX EQU   CVTS01+108                                               02627000
CVTOLT0A EQU   CVTS01+104                                               02628000
CVTSRBRT EQU   CVTS01+100                                               02629000
CVTPUTL  EQU   CVTS01+96                                                02630000
CVTASCRL EQU   CVTS01+92                                                02631000
CVTASCRF EQU   CVTS01+88                                                02632000
CVTRV326 EQU   CVTS01+84                                                02633000
CVTRV325 EQU   CVTS01+80                                                02634000
CVTRV324 EQU   CVTS01+76                                                02635000
CVT0VL01 EQU   CVTS01+72                                                02636000
CVTSHRVM EQU   CVTS01+68                                                02637000
CVTRV332 EQU   CVTS01+64                                                02638000
CVTTAS   EQU   CVTS01+60                                                02639000
CVTRSCN  EQU   CVTS01+56                                                02640000
CVTTRAC2 EQU   CVTS01+54                                                02641000
CVTTRACE EQU   CVTS01+52                                                02642000
CVTAPG   EQU   CVTS01+51                                                02643000
CVTSDTRC EQU   CVTCTLFG                                                 02644000
CVTGTRCE EQU   CVTCTLFG                                                 02645000
CVTNOMP  EQU   CVTCTLFG                                                 02646000
CVTRSV79 EQU   CVTCTLFG                                                 02647000
CVTDSTAT EQU   CVTCTLFG                                                 02648000
CVTRSV78 EQU   CVTCTLFG                                                 02649000
CVTRV333 EQU   CVTCTLFG                                                 02650000
CVTRV323 EQU   CVTCTLFG                                                 02651000
CVTSPVLK EQU   CVTS01+49                                                02652000
CVTRSV77 EQU   CVTS01+48                                                02653000
CVTRV331 EQU   CVTS01+44                                                02654000
CVTRV330 EQU   CVTS01+40                                                02655000
CVTRV329 EQU   CVTS01+36                                                02656000
CVTRV328 EQU   CVTS01+32                                                02657000
CVTRV322 EQU   CVTS01+28                                                02658000
CVTSLID  EQU   CVTSLIDA+1                                               02659000
CVTSYLK  EQU   CVTSLIDA                                                 02660000
CVTRV321 EQU   CVTS01+20                                                02661000
CVTRV320 EQU   CVTS01+16                                                02662000
CVTLPDIR EQU   CVTLPDIA+1                                               02663000
CVTRSV69 EQU   CVTDIRST                                                 02664000
CVTRSV68 EQU   CVTDIRST                                                 02665000
CVTRSV67 EQU   CVTDIRST                                                 02666000
CVTRSV66 EQU   CVTDIRST                                                 02667000
CVTRSV65 EQU   CVTDIRST                                                 02668000
CVTRSV64 EQU   CVTDIRST                                                 02669000
CVTRSV63 EQU   CVTDIRST                                                 02670000
CVTDICOM EQU   CVTDIRST                                                 02671000
CVTPVTP  EQU   CVTS01+8                                                 02672000
CVTLPDSR EQU   CVTS01+4                                                 02673000
CVTGETL  EQU   CVTS01                                                   02674000
RECDATA  EQU   RECORD+4                                                 02675000
@NM00023 EQU   RECORD+2                                                 02676000
@NM00022 EQU   GTFBUF+2                                                 02677000
CVTMCHD  EQU   CVTGTFM+1                                                02678000
@NM00019 EQU   CVTGTFFG                                                 02679000
RECRES1  EQU   RECMAP+2                                                 02680000
FRMRES1  EQU   FRMATAB+36                                               02681000
APRFMG   EQU   FRMATAB+24                                               02682000
SWAPUSE  EQU   SWAPBCB+2                                                02683000
@NM00018 EQU   @NM00017                                                 02684000
DECBFSWA EQU   @NM00017                                                 02685000
RQFSWAP  EQU   @NM00017                                                 02686000
HQFSWAP  EQU   @NM00017                                                 02687000
SQFSWAP  EQU   @NM00017                                                 02688000
CQFSWAP  EQU   @NM00017                                                 02689000
WQFSWAP  EQU   @NM00017                                                 02690000
EQFSWAP  EQU   @NM00017                                                 02691000
COMPBCB  EQU   CMPWKA                                                   02692000
BIGLL    EQU   GTFBUFR                                                  02693000
BCBFREQ  EQU   GTFBCB+20                                                02694000
SQCHAIN  EQU   RQCHAIN                                                  02695000
BCBUSE   EQU   BCBSWAP+2                                                02696000
DECBFLAG EQU   BCBQFLAG                                                 02697000
RQFLAG   EQU   BCBQFLAG                                                 02698000
HQFLAG   EQU   BCBQFLAG                                                 02699000
SQFLAG   EQU   BCBQFLAG                                                 02700000
CQFLAG   EQU   BCBQFLAG                                                 02701000
WQFLAG   EQU   BCBQFLAG                                                 02702000
EQFLAG   EQU   BCBQFLAG                                                 02703000
GTFBCBID EQU   GTFBCB                                                   02704000
BLOKLEN  EQU   BLOKAREA                                                 02705000
BLKINUSE EQU   BLKCHAIN                                                 02706000
BLOKID   EQU   GTFBLOK                                                  02707000
COMMONPG EQU   PAGELIST                                                 02708000
PLINDEX  EQU   SVCPLIST                                                 02709000
@NM00016 EQU   SLEFLAGS                                                 02710000
SLEINUSE EQU   SLEFLAGS                                                 02711000
SLEQCNT  EQU   SLE+28                                                   02712000
SLEEID   EQU   SLEHOOK                                                  02713000
SLEID    EQU   SLE                                                      02714000
PCTWTOMD EQU   GTFPCT+312                                               02715000
PCTDMPMD EQU   GTFPCT+308                                               02716000
TRANSMAX EQU   GTFPCT+304                                               02717000
@NM00015 EQU   AUDITFLG+3                                               02718000
AFSLEBLD EQU   AUDITFLG+3                                               02719000
WSERFG06 EQU   AUDITFLG+3                                               02720000
WSERFG05 EQU   AUDITFLG+3                                               02721000
WSERFG04 EQU   AUDITFLG+3                                               02722000
WSERFG03 EQU   AUDITFLG+3                                               02723000
WSERFG02 EQU   AUDITFLG+2                                               02724000
WSERFLAG EQU   AUDITFLG+2                                               02725000
TERMFLAG EQU   AUDITFLG+2                                               02726000
AFXWRIT  EQU   AUDITFLG+2                                               02727000
AFQLWAIT EQU   AUDITFLG+2                                               02728000
AFSLEGET EQU   AUDITFLG+2                                               02729000
AFBUFGET EQU   AUDITFLG+2                                               02730000
AFFEOB   EQU   AUDITFLG+2                                               02731000
AFBLKFIX EQU   AUDITFLG+1                                               02732000
AFEQFIX  EQU   AUDITFLG+1                                               02733000
AFPGRLSE EQU   AUDITFLG+1                                               02734000
AFWRAP   EQU   AUDITFLG+1                                               02735000
AFBUFOFF EQU   AUDITFLG+1                                               02736000
AFLDFX   EQU   AUDITFLG+1                                               02737000
AFCLOSE  EQU   AUDITFLG+1                                               02738000
AFOPEN   EQU   AUDITFLG+1                                               02739000
AFGMBLOK EQU   AUDITFLG                                                 02740000
AFGMSRB  EQU   AUDITFLG                                                 02741000
AFWAIT   EQU   AUDITFLG                                                 02742000
AFTERM   EQU   AUDITFLG                                                 02743000
AFINIT   EQU   AUDITFLG                                                 02744000
AFWWRIT  EQU   AUDITFLG                                                 02745000
AFCWRIT  EQU   AUDITFLG                                                 02746000
AFIWRIT  EQU   AUDITFLG                                                 02747000
EQSHORT  EQU   GTFPCT+292                                               02748000
SLEMAX   EQU   GTFPCT+288                                               02749000
SLECNT   EQU   GTFPCT+284                                               02750000
RQPURGE  EQU   GTFPCT+280                                               02751000
RQTOTAL  EQU   GTFPCT+276                                               02752000
WRTDLST  EQU   GTFPCT+272                                               02753000
NUMOFBUF EQU   GTFPCT+268                                               02754000
SBUFDISA EQU   GTFPCT+264                                               02755000
SLESUSED EQU   GTFPCT+260                                               02756000
EQMIN    EQU   GTFPCT+256                                               02757000
EQLENGTH EQU   GTFPCT+252                                               02758000
WQMAX    EQU   GTFPCT+248                                               02759000
WQLENGTH EQU   GTFPCT+244                                               02760000
QLECBP   EQU   QLOCKECB                                                 02761000
@NM00014 EQU   QLOCKECB                                                 02762000
@NM00013 EQU   QLOCKWRD+3                                               02763000
SCHEDBUF EQU   QLOCKWRD+2                                               02764000
POSTWRIT EQU   QLOCKWRD+1                                               02765000
QLOCK    EQU   QLOCKWRD                                                 02766000
WRITERDD EQU   GTFPCT+228                                               02767000
GTFLOSTR EQU   GTFPCT+224                                               02768000
SRBAVAIL EQU   GTFSSRB                                                  02769000
WRTRERRP EQU   WRTRERR                                                  02770000
@NM00012 EQU   WRTRERR                                                  02771000
TRMWRITP EQU   TRMWRIT                                                  02772000
@NM00011 EQU   TRMWRIT                                                  02773000
GTFCMECB EQU   GTFPCT+208                                               02774000
WRTRCOMP EQU   WRTRCOM                                                  02775000
@NM00010 EQU   WRTRCOM                                                  02776000
TRANSCNT EQU   GTFPCT+200                                               02777000
AHLRDPLQ EQU   GTFPCT+196                                               02778000
SFEOBRTN EQU   GTFPCT+192                                               02779000
SBLOKRTN EQU   GTFPCT+188                                               02780000
GBCDS    EQU   NEXTBLOK                                                 02781000
WSMODEND EQU   GTFPCT+176                                               02782000
WSMODBEG EQU   GTFPCT+172                                               02783000
BCBPAGE  EQU   GTFPCT+156                                               02784000
SLEPAGE  EQU   GTFPCT+152                                               02785000
SAVECNT  EQU   GTFPCT+148                                               02786000
QTAIL    EQU   GTFPCT+136                                               02787000
WQHEAD   EQU   GTFPCT+128                                               02788000
RQHEAD   EQU   GTFPCT+124                                               02789000
EQHEAD   EQU   GTFPCT+120                                               02790000
WPOSTSRB EQU   GTFPCT+116                                               02791000
WTSKTCBA EQU   GTFPCT+112                                               02792000
WRTRTCBA EQU   GTFPCT+108                                               02793000
TRMWTASK EQU   GTFPCT+104                                               02794000
WTSKATTH EQU   GTFPCT+100                                               02795000
WTSKINIT EQU   GTFPCT+96                                                02796000
WTASKECB EQU   GTFPCT+92                                                02797000
WMTABPTR EQU   GTFPCT+88                                                02798000
ATTCHECB EQU   GTFPCT+84                                                02799000
AHLECB   EQU   GTFPCT+80                                                02800000
STOPECBA EQU   GTFPCT+76                                                02801000
ECBADRLT EQU   GTFPCT+72                                                02802000
FIXLEN   EQU   GTFPCT+68                                                02803000
FIXPTR   EQU   GTFPCT+64                                                02804000
INITPTR  EQU   GTFPCT+60                                                02805000
MCQEPTR  EQU   GTFPCT+56                                                02806000
GTFEIDL  EQU   GTFPCT+52                                                02807000
GTFPIBL  EQU   GTFPCT+48                                                02808000
GTFPIFT  EQU   GTFPCT+44                                                02809000
GTFSVCBL EQU   GTFPCT+40                                                02810000
GTFSVCFT EQU   GTFPCT+36                                                02811000
GTFIOBL  EQU   GTFPCT+32                                                02812000
GTFIOFT  EQU   GTFPCT+28                                                02813000
GTFSIOBL EQU   GTFPCT+24                                                02814000
GTFSIOFT EQU   GTFPCT+20                                                02815000
@NM00009 EQU   PCTCATF+1                                                02816000
PCTPIF   EQU   PCTCATF+1                                                02817000
PCTSIOF  EQU   PCTCATF+1                                                02818000
PCTIOF   EQU   PCTCATF+1                                                02819000
PCTSVCF  EQU   PCTCATF+1                                                02820000
PCTRR    EQU   PCTCATF+1                                                02821000
PCTSRM   EQU   PCTCATF+1                                                02822000
PCTRNIO  EQU   PCTCATF+1                                                02823000
PCTUSR   EQU   PCTCATF                                                  02824000
PCTPI    EQU   PCTCATF                                                  02825000
@NM00008 EQU   PCTCATF                                                  02826000
PCTDSP   EQU   PCTCATF                                                  02827000
PCTSIO   EQU   PCTCATF                                                  02828000
PCTIO    EQU   PCTCATF                                                  02829000
PCTEXT   EQU   PCTCATF                                                  02830000
PCTSVC   EQU   PCTCATF                                                  02831000
OPTTIME  EQU   GTFOPTS4                                                 02832000
OPTRES3  EQU   GTFOPTS4                                                 02833000
OPTIOSIO EQU   GTFOPTS3                                                 02834000
OPTRES2  EQU   GTFOPTS3                                                 02835000
OPTRR    EQU   GTFOPTS3                                                 02836000
OPTSRM   EQU   GTFOPTS3                                                 02837000
OPTRNIO  EQU   GTFOPTS3                                                 02838000
OPTEXT   EQU   GTFOPTS3                                                 02839000
OPTIOP   EQU   GTFOPTS2                                                 02840000
OPTIO    EQU   GTFOPTS2                                                 02841000
OPTPIP   EQU   GTFOPTS2                                                 02842000
OPTPI    EQU   GTFOPTS2                                                 02843000
OPTSIOP  EQU   GTFOPTS2                                                 02844000
OPTSIO   EQU   GTFOPTS2                                                 02845000
OPTSVCP  EQU   GTFOPTS2                                                 02846000
OPTSVC   EQU   GTFOPTS2                                                 02847000
OPTPCI   EQU   GTFOPTS1                                                 02848000
OPTRES1  EQU   GTFOPTS1                                                 02849000
OPTDSP   EQU   GTFOPTS1                                                 02850000
OPTTRC   EQU   GTFOPTS1                                                 02851000
OPTUSR   EQU   GTFOPTS1                                                 02852000
OPTSYS   EQU   GTFOPTS1                                                 02853000
OPTSYSP  EQU   GTFOPTS1                                                 02854000
OPTSYSM  EQU   GTFOPTS1                                                 02855000
GTFRESV  EQU   GTFSTAT                                                  02856000
GTFDEBUG EQU   GTFSTAT                                                  02857000
GTFMODE  EQU   GTFSTAT                                                  02858000
GTFPCTID EQU   GTFPCT                                                   02859000
MCQESRB  EQU   MCQE+44                                                  02860000
@NM00007 EQU   MCQE+42                                                  02861000
@NM00006 EQU   MCQEFLGS                                                 02862000
MCQEACT  EQU   MCQEFLGS                                                 02863000
MCQESCHE EQU   MCQE+40                                                  02864000
MCQETECB EQU   MCQE+36                                                  02865000
MCQEMCCL EQU   MCQE+28                                                  02866000
MCQEMCEE EQU   MCQE+24                                                  02867000
MCQEASCB EQU   MCQE+16                                                  02868000
MCQEIDEN EQU   MCQE                                                     02869000
MCCESRB  EQU   MCCE+44                                                  02870000
MCCEECB  EQU   MCCE+40                                                  02871000
MCCEMCCE EQU   MCCE+36                                                  02872000
MCCECNT  EQU   MCCE+32                                                  02873000
MCCEOMCQ EQU   MCCE+28                                                  02874000
MCCEOCDA EQU   MCCE+24                                                  02875000
MCCEOEDA EQU   MCCE+20                                                  02876000
MCCECDA  EQU   MCCE+12                                                  02877000
MCCEEDA  EQU   MCCE+8                                                   02878000
MCCEIDEN EQU   MCCE                                                     02879000
MCHEADTR EQU   MCHEAD+48                                                02880000
MCHEADRD EQU   MCHEAD+44                                                02881000
MCHFRRAD EQU   MCHEAD+40                                                02882000
MCHMCER  EQU   MCHEAD+36                                                02883000
MCHSETD  EQU   MCHEAD+32                                                02884000
MCHSETE  EQU   MCHEAD+28                                                02885000
@NM00005 EQU   MCHFLGS+1                                                02886000
@NM00004 EQU   MCHFLG1                                                  02887000
MCHTERM  EQU   MCHFLG1                                                  02888000
MCHACT   EQU   MCHFLG1                                                  02889000
MCHDIS   EQU   MCHEAD+20                                                02890000
MCHCTL   EQU   MCHEAD+16                                                02891000
MCHCNT   EQU   MCHEAD+12                                                02892000
MCHIDEN  EQU   MCHEAD                                                   02893000
CVTLEVL  EQU   CVTRELNO+2                                               02894000
CVTNUMB  EQU   CVTRELNO                                                 02895000
CVTMDL   EQU   CVTFIX+250                                               02896000
@NM00003 EQU   CVTFIX+248                                               02897000
@NM00002 EQU   CVTFIX                                                   02898000
CVTRV482 EQU   CVTXTNT2+128                                             02899000
CVTRV481 EQU   CVTXTNT2+124                                             02900000
CVTRV480 EQU   CVTXTNT2+120                                             02901000
CVTRV479 EQU   CVTXTNT2+118                                             02902000
CVTRV478 EQU   CVTXTNT2+117                                             02903000
CVTRV477 EQU   CVTXTNT2+116                                             02904000
CVTRV476 EQU   CVTXTNT2+115                                             02905000
CVTRV475 EQU   CVTXTNT2+114                                             02906000
CVTRV474 EQU   CVTRV466                                                 02907000
CVTRV473 EQU   CVTRV466                                                 02908000
CVTRV472 EQU   CVTRV466                                                 02909000
CVTRV471 EQU   CVTRV466                                                 02910000
CVTRV470 EQU   CVTRV466                                                 02911000
CVTRV469 EQU   CVTRV466                                                 02912000
CVTRV468 EQU   CVTRV466                                                 02913000
CVTRV467 EQU   CVTRV466                                                 02914000
CVTRV465 EQU   CVTRV457                                                 02915000
CVTRV464 EQU   CVTRV457                                                 02916000
CVTRV463 EQU   CVTRV457                                                 02917000
CVTRV462 EQU   CVTRV457                                                 02918000
CVTRV461 EQU   CVTRV457                                                 02919000
CVTRV460 EQU   CVTRV457                                                 02920000
CVTRV459 EQU   CVTRV457                                                 02921000
CVTRV458 EQU   CVTRV457                                                 02922000
CVTRV456 EQU   CVTXTNT2+108                                             02923000
CVTRV455 EQU   CVTXTNT2+104                                             02924000
CVTRV454 EQU   CVTXTNT2+100                                             02925000
CVTRV453 EQU   CVTXTNT2+96                                              02926000
CVTRV452 EQU   CVTXTNT2+94                                              02927000
CVTRV451 EQU   CVTXTNT2+92                                              02928000
CVTRV450 EQU   CVTXTNT2+90                                              02929000
CVTRV449 EQU   CVTXTNT2+88                                              02930000
CVTRV448 EQU   CVTXTNT2+87                                              02931000
CVTRV447 EQU   CVTXTNT2+86                                              02932000
CVTRV446 EQU   CVTRV438                                                 02933000
CVTRV445 EQU   CVTRV438                                                 02934000
CVTRV444 EQU   CVTRV438                                                 02935000
CVTRV443 EQU   CVTRV438                                                 02936000
CVTRV442 EQU   CVTRV438                                                 02937000
CVTRV441 EQU   CVTRV438                                                 02938000
CVTRV440 EQU   CVTRV438                                                 02939000
CVTRV439 EQU   CVTRV438                                                 02940000
CVTRV437 EQU   CVTRV429                                                 02941000
CVTRV436 EQU   CVTRV429                                                 02942000
CVTRV435 EQU   CVTRV429                                                 02943000
CVTRV434 EQU   CVTRV429                                                 02944000
CVTRV433 EQU   CVTRV429                                                 02945000
CVTRV432 EQU   CVTRV429                                                 02946000
CVTRV431 EQU   CVTRV429                                                 02947000
CVTRV430 EQU   CVTRV429                                                 02948000
CVTRV428 EQU   CVTXTNT2+80                                              02949000
CVTRV427 EQU   CVTXTNT2+76                                              02950000
CVTRV426 EQU   CVTXTNT2+72                                              02951000
CVTRV425 EQU   CVTXTNT2+68                                              02952000
CVTATACT EQU   CVTATCVT                                                 02953000
CVTRV423 EQU   CVTXTNT2+62                                              02954000
CVTRV422 EQU   CVTXTNT2+60                                              02955000
CVTRV421 EQU   CVTXTNT2+58                                              02956000
CVTRV420 EQU   CVTXTNT2+56                                              02957000
CVTRV419 EQU   CVTXTNT2+55                                              02958000
CVTRV418 EQU   CVTXTNT2+54                                              02959000
CVTRV417 EQU   CVTRV409                                                 02960000
CVTRV416 EQU   CVTRV409                                                 02961000
CVTRV415 EQU   CVTRV409                                                 02962000
CVTRV414 EQU   CVTRV409                                                 02963000
CVTRV413 EQU   CVTRV409                                                 02964000
CVTRV412 EQU   CVTRV409                                                 02965000
CVTRV411 EQU   CVTRV409                                                 02966000
CVTRV410 EQU   CVTRV409                                                 02967000
CVTRV408 EQU   CVTRV400                                                 02968000
CVTRV407 EQU   CVTRV400                                                 02969000
CVTRV406 EQU   CVTRV400                                                 02970000
CVTRV405 EQU   CVTRV400                                                 02971000
CVTRV404 EQU   CVTRV400                                                 02972000
CVTRV403 EQU   CVTRV400                                                 02973000
CVTRV402 EQU   CVTRV400                                                 02974000
CVTRV401 EQU   CVTRV400                                                 02975000
CVTICB   EQU   CVTXTNT2+48                                              02976000
CVTSKTA  EQU   CVTXTNT2+44                                              02977000
CVTCCVT  EQU   CVTXTNT2+40                                              02978000
CVTRSV98 EQU   CVTXTNT2+36                                              02979000
CVTRSV97 EQU   CVTXTNT2+34                                              02980000
CVTRSV96 EQU   CVTXTNT2+32                                              02981000
CVTOLTEP EQU   CVTXTNT2+28                                              02982000
CVTQIDA  EQU   CVTQID+1                                                 02983000
CVTRSV95 EQU   CVTQID                                                   02984000
CVTRSV94 EQU   CVTXTNT2+20                                              02985000
CVTRSV93 EQU   CVTXTNT2+16                                              02986000
CVTRSV92 EQU   CVTXTNT2+12                                              02987000
CVTDEBVR EQU   CVTXTNT2+8                                               02988000
CVTRSV91 EQU   CVTXTNT2+6                                               02989000
CVTRSV9H EQU   CVTFLGBT                                                 02990000
CVTRSV9G EQU   CVTFLGBT                                                 02991000
CVTRSV9F EQU   CVTFLGBT                                                 02992000
CVTRSV9E EQU   CVTFLGBT                                                 02993000
CVTRSV9D EQU   CVTFLGBT                                                 02994000
CVTRSV9C EQU   CVTFLGBT                                                 02995000
CVTVME   EQU   CVTFLGBT                                                 02996000
CVTNPE   EQU   CVTFLGBT                                                 02997000
CVTNUCLS EQU   CVTXTNT2+4                                               02998000
CVTDSSVA EQU   CVTDSSV+1                                                02999000
CVTRSV89 EQU   CVTDSSV                                                  03000000
CVTRSV88 EQU   CVTXTNT1+8                                               03001000
CVTRSV87 EQU   CVTXTNT1+4                                               03002000
CVTFACHN EQU   CVTXTNT1                                                 03003000
CVTRV488 EQU   CVTMAP+412                                               03004000
CVTRV487 EQU   CVTMAP+408                                               03005000
CVTRV486 EQU   CVTMAP+404                                               03006000
CVTRV485 EQU   CVTMAP+400                                               03007000
CVTACTAP EQU   CVTMAP+396                                               03008000
CVTAUTH  EQU   CVTMAP+392                                               03009000
CVTATMCA EQU   CVTATMCT+1                                               03010000
CVTATMST EQU   CVTATMCT                                                 03011000
CVTRSV61 EQU   CVTMAP+384                                               03012000
CVTVOLT1 EQU   CVTVOLM1+1                                               03013000
CVTVOLI1 EQU   CVTVOLF1                                                 03014000
CVTSTOA  EQU   CVTMAP+376                                               03015000
CVTRSV58 EQU   CVTMAP+374                                               03016000
CVTRSV57 EQU   CVTMAP+372                                               03017000
CVTDDCE  EQU   CVTMAP+368                                               03018000
CVTPNWFR EQU   CVTMAP+364                                               03019000
CVTSMF   EQU   CVTMAP+360                                               03020000
CVTSULK  EQU   CVTMAP+358                                               03021000
CVTSLKO  EQU   CVTSYSK                                                  03022000
CVTSLKP  EQU   CVTSYSK                                                  03023000
CVTSLKQ  EQU   CVTSYSK                                                  03024000
CVTSLKR  EQU   CVTSYSK                                                  03025000
CVTRSV56 EQU   CVTSYSK                                                  03026000
CVTRSV55 EQU   CVTSYSK                                                  03027000
CVTRSV54 EQU   CVTSYSK                                                  03028000
CVTRSV53 EQU   CVTSYSK                                                  03029000
CVTRSV52 EQU   CVTA1F1                                                  03030000
CVTRSV51 EQU   CVTA1F1                                                  03031000
CVTRSV50 EQU   CVTA1F1                                                  03032000
CVTRSV49 EQU   CVTA1F1                                                  03033000
CVTRSV48 EQU   CVTA1F1                                                  03034000
CVTRSV47 EQU   CVTA1F1                                                  03035000
CVTSRSW  EQU   CVTA1F1                                                  03036000
CVTPFSW  EQU   CVTA1F1                                                  03037000
CVTPCVT  EQU   CVTMAP+352                                               03038000
CVTRSV46 EQU   CVTMAP+344                                               03039000
CVTRSV45 EQU   CVTMAP+340                                               03040000
CVTRSV44 EQU   CVTMAP+338                                               03041000
CVTRSV43 EQU   CVTMAP+336                                               03042000
CVTHJESA EQU   CVTHJES+1                                                03043000
CVTRSV42 EQU   CVTHJES                                                  03044000
CVTEXT2A EQU   CVTEXT2+1                                                03045000
CVTRSV41 EQU   CVTEXT2                                                  03046000
CVTAPFA  EQU   CVTAPF+1                                                 03047000
CVTRSV40 EQU   CVTAPF                                                   03048000
CVTRV518 EQU   CVTINTLA                                                 03049000
CVTRV517 EQU   CVTERPV                                                  03050000
CVTEORM  EQU   CVTMAP+312                                               03051000
CVTMCHPR EQU   CVTMAP+308                                               03052000
CVTTZ    EQU   CVTMAP+304                                               03053000
CVTJEPS  EQU   CVTMAP+300                                               03054000
CVTJESCT EQU   CVTMAP+296                                               03055000
CVTMODE  EQU   CVTMAP+292                                               03056000
CVTPTRV  EQU   CVTMAP+288                                               03057000
CVTREAL  EQU   CVTMAP+284                                               03058000
CVTRSV39 EQU   CVTMAP+280                                               03059000
CVTRSV38 EQU   CVTMAP+276                                               03060000
CVTDMSRA EQU   CVTDMSR+1                                                03061000
CVTRV634 EQU   CVTDMSRF                                                 03062000
CVTRV633 EQU   CVTDMSRF                                                 03063000
CVTRV632 EQU   CVTDMSRF                                                 03064000
CVTRV631 EQU   CVTDMSRF                                                 03065000
CVTRV630 EQU   CVTDMSRF                                                 03066000
CVTRV629 EQU   CVTDMSRF                                                 03067000
CVTUDUMP EQU   CVTDMSRF                                                 03068000
CVTSDUMP EQU   CVTDMSRF                                                 03069000
CVTQMSGA EQU   CVTQMSG+1                                                03070000
CVTRSV36 EQU   CVTQMSG                                                  03071000
CVTAMFF  EQU   CVTMAP+264                                               03072000
CVTPURGA EQU   CVTPURG+1                                                03073000
CVTRSV35 EQU   CVTPURG                                                  03074000
CVTCBSP  EQU   CVTMAP+256                                               03075000
CVTATERA EQU   CVTATER+1                                                03076000
CVTSYST  EQU   CVTATER                                                  03077000
CVTVOLT2 EQU   CVTTAT                                                   03078000
CVTVOLI2 EQU   CVTVOLF2                                                 03079000
CVTAQAVB EQU   CVTAQAVT+1                                               03080000
CVTRSV34 EQU   CVTTCMFG                                                 03081000
CVTRSV33 EQU   CVTTCMFG                                                 03082000
CVTRSV32 EQU   CVTTCMFG                                                 03083000
CVTRSV31 EQU   CVTTCMFG                                                 03084000
CVTRSV30 EQU   CVTTCMFG                                                 03085000
CVTRSV29 EQU   CVTTCMFG                                                 03086000
CVTRSV28 EQU   CVTTCMFG                                                 03087000
CVTTCRDY EQU   CVTTCMFG                                                 03088000
CVTRSV27 EQU   CVTGTFST                                                 03089000
CVTRNIO  EQU   CVTGTFST                                                 03090000
CVTUSR   EQU   CVTGTFST                                                 03091000
CVTRV318 EQU   CVTFORM                                                  03092000
CVTRV317 EQU   CVTTMODE                                                 03093000
CVTRV316 EQU   CVTSTATE                                                 03094000
CVTRV315 EQU   CVTGTFS                                                  03095000
CVTGTFAV EQU   CVTGTFS                                                  03096000
CVT0SCR1 EQU   CVTMAP+232                                               03097000
CVTRV515 EQU   CVTMAP+228                                               03098000
CVTRMS   EQU   CVTMAP+224                                               03099000
CVTPATCH EQU   CVTMAP+220                                               03100000
CVTTSCE  EQU   CVTMAP+216                                               03101000
CVTLNKSC EQU   CVTMAP+214                                               03102000
CVTQABST EQU   CVTMAP+212                                               03103000
CVTMDLDS EQU   CVTMAP+208                                               03104000
CVTUSER  EQU   CVTMAP+204                                               03105000
CVTABEND EQU   CVTMAP+200                                               03106000
CVTSMCA  EQU   CVTMAP+196                                               03107000
CVTRSV18 EQU   CVTMAP+192                                               03108000
CVTQLPAQ EQU   CVTMAP+188                                               03109000
CVTQCDSR EQU   CVTMAP+184                                               03110000
CVTRSV17 EQU   CVTOPTB                                                  03111000
CVTRSV16 EQU   CVTOPTB                                                  03112000
CVTFP    EQU   CVTOPTB                                                  03113000
CVTAPTHR EQU   CVTOPTB                                                  03114000
CVTNLOG  EQU   CVTOPTB                                                  03115000
CVTTOD   EQU   CVTOPTB                                                  03116000
CVTCTIMS EQU   CVTOPTB                                                  03117000
CVTPROT  EQU   CVTOPTB                                                  03118000
CVTXPFP  EQU   CVTOPTA                                                  03119000
CVTASCII EQU   CVTOPTA                                                  03120000
CVTRSV13 EQU   CVTOPTA                                                  03121000
CVTRSV12 EQU   CVTOPTA                                                  03122000
CVTNIP   EQU   CVTOPTA                                                  03123000
CVTDDR   EQU   CVTOPTA                                                  03124000
CVTAPR   EQU   CVTOPTA                                                  03125000
CVTCCH   EQU   CVTOPTA                                                  03126000
CVTSNCTR EQU   CVTMAP+180                                               03127000
CVTQMWR  EQU   CVTMAP+176                                               03128000
CVTQOCR  EQU   CVTMAP+172                                               03129000
CVT1EF00 EQU   CVTMAP+168                                               03130000
CVTMZ00  EQU   CVTMAP+164                                               03131000
CVTSV76Q EQU   CVTSV76C                                                 03132000
CVTRSV11 EQU   CVTMAP+156                                               03133000
CVT0PT01 EQU   CVTMAP+152                                               03134000
CVTMSER  EQU   CVTMAP+148                                               03135000
CVTRV516 EQU   CVTIERLC                                                 03136000
CVTILCH  EQU   CVTMAP+140                                               03137000
CVT0DS   EQU   CVTMAP+136                                               03138000
CVTFBOSV EQU   CVTMAP+132                                               03139000
CVTNUCB  EQU   CVTMAP+128                                               03140000
CVTIXAVL EQU   CVTMAP+124                                               03141000
CVTSV76M EQU   CVTIOQET                                                 03142000
CVTDCBA  EQU   CVTMAP+117                                               03143000
CVTMVS2  EQU   CVTDCB                                                   03144000
CVT6DAT  EQU   CVTDCB                                                   03145000
CVT4MPS  EQU   CVTDCB                                                   03146000
CVTRSV09 EQU   CVTDCB                                                   03147000
CVT4MS1  EQU   CVTDCB                                                   03148000
CVT2SPS  EQU   CVTDCB                                                   03149000
CVT1SSS  EQU   CVTDCB                                                   03150000
CVTRSV08 EQU   CVTDCB                                                   03151000
CVTSTB   EQU   CVTMAP+112                                               03152000
CVTQTD00 EQU   CVTMAP+108                                               03153000
CVTQTE00 EQU   CVTMAP+104                                               03154000
CVTCUCB  EQU   CVTMAP+100                                               03155000
CVTSJQ   EQU   CVTMAP+96                                                03156000
CVTPBLDL EQU   CVTMAP+92                                                03157000
CVTTPC   EQU   CVTMAP+88                                                03158000
CVTSVDCB EQU   CVTMAP+84                                                03159000
CVTBRET  EQU   CVTMAP+82                                                03160000
CVTEXIT  EQU   CVTMAP+80                                                03161000
CVT0FN00 EQU   CVTMAP+76                                                03162000
CVTDARA  EQU   CVTDAR+1                                                 03163000
CVTRSV07 EQU   CVTFLGS1                                                 03164000
CVTRSV06 EQU   CVTFLGS1                                                 03165000
CVTRSV05 EQU   CVTFLGS1                                                 03166000
CVTRSV04 EQU   CVTFLGS1                                                 03167000
CVTRSV03 EQU   CVTFLGS1                                                 03168000
CVTRSV02 EQU   CVTFLGS1                                                 03169000
CVTRSV01 EQU   CVTFLGS1                                                 03170000
CVTDMPLK EQU   CVTFLGS1                                                 03171000
CVTXITP  EQU   CVTMAP+68                                                03172000
CVTZDTAB EQU   CVTMAP+64                                                03173000
CVTMSLT  EQU   CVTMAP+60                                                03174000
CVTDATE  EQU   CVTMAP+56                                                03175000
CVTBTERM EQU   CVTMAP+52                                                03176000
CVTSYSAD EQU   CVTMAP+48                                                03177000
CVTXTLER EQU   CVTMAP+44                                                03178000
CVTILK2  EQU   CVTMAP+40                                                03179000
CVTILK1  EQU   CVTMAP+36                                                03180000
CVTPRLTV EQU   CVTMAP+32                                                03181000
CVTPCNVT EQU   CVTMAP+28                                                03182000
CVT0VL00 EQU   CVTMAP+24                                                03183000
CVTXAPG  EQU   CVTMAP+20                                                03184000
CVTBUF   EQU   CVTMAP+16                                                03185000
CVTJOB   EQU   CVTMAP+12                                                03186000
CVTLINK  EQU   CVTMAP+8                                                 03187000
CVT0EF00 EQU   CVTMAP+4                                                 03188000
CVTTCBP  EQU   CVTMAP                                                   03189000
ASCBEND  EQU   ASCB+208                                                 03190000
ASCBSRBT EQU   ASCB+200                                                 03191000
ASCBSWTL EQU   ASCB+196                                                 03192000
ASCBRS14 EQU   ASCB+195                                                 03193000
ASCBSMCT EQU   ASCB+194                                                 03194000
ASCBRS12 EQU   ASCB+192                                                 03195000
ASCBPCTT EQU   ASCB+188                                                 03196000
ASCBVGTT EQU   ASCB+184                                                 03197000
ASCBLGCB EQU   ASCB+180                                                 03198000
ASCBJBNS EQU   ASCB+176                                                 03199000
ASCBJBNI EQU   ASCB+172                                                 03200000
ASCBMCC  EQU   ASCB+168                                                 03201000
ASCBRTWA EQU   ASCB+164                                                 03202000
ASCBIQEA EQU   ASCB+160                                                 03203000
ASCBXMPQ EQU   ASCB+156                                                 03204000
ASCBRS01 EQU   ASCB+154                                                 03205000
ASCBFMCT EQU   ASCB+152                                                 03206000
ASCBOUXB EQU   ASCB+148                                                 03207000
ASCBOUCB EQU   ASCB+144                                                 03208000
ASCBMECB EQU   ASCB+140                                                 03209000
ASCBQECB EQU   ASCB+136                                                 03210000
ASCBCMSB EQU   ASCB+132                                                 03211000
ASCBCMSF EQU   ASCB+128                                                 03212000
ASCBTCBS EQU   ASCB+124                                                 03213000
ASCBNVSC EQU   ASCB+122                                                 03214000
ASCBVSC  EQU   ASCB+120                                                 03215000
ASCBSRBS EQU   ASCB+118                                                 03216000
ASCBSSRB EQU   ASCB+116                                                 03217000
ASCBRV06 EQU   ASCBFLG2                                                 03218000
ASCBRV05 EQU   ASCBFLG2                                                 03219000
ASCBRV04 EQU   ASCBFLG2                                                 03220000
ASCBSNQS EQU   ASCBFLG2                                                 03221000
ASCBS2S  EQU   ASCBFLG2                                                 03222000
ASCBCEXT EQU   ASCBFLG2                                                 03223000
ASCBPXMT EQU   ASCBFLG2                                                 03224000
ASCBXMPT EQU   ASCBFLG2                                                 03225000
ASCBRF07 EQU   ASCBDSP1                                                 03226000
ASCBRF06 EQU   ASCBDSP1                                                 03227000
ASCBRF05 EQU   ASCBDSP1                                                 03228000
ASCBRF04 EQU   ASCBDSP1                                                 03229000
ASCBRF03 EQU   ASCBDSP1                                                 03230000
ASCBRF02 EQU   ASCBDSP1                                                 03231000
ASCBFAIL EQU   ASCBDSP1                                                 03232000
ASCBNOQ  EQU   ASCBDSP1                                                 03233000
ASCBSWCT EQU   ASCB+112                                                 03234000
ASCBASXB EQU   ASCB+108                                                 03235000
ASCBTMCH EQU   ASCB+104                                                 03236000
ASCBNSWP EQU   ASCBFLG1                                                 03237000
ASCBTYP1 EQU   ASCBFLG1                                                 03238000
ASCBSTND EQU   ASCBFLG1                                                 03239000
ASCBABNT EQU   ASCBFLG1                                                 03240000
ASCBTERM EQU   ASCBFLG1                                                 03241000
ASCBS3S  EQU   ASCBFLG1                                                 03242000
ASCBCMSH EQU   ASCBFLG1                                                 03243000
ASCBTOFF EQU   ASCBFLG1                                                 03244000
ASCBRF01 EQU   ASCBRCTF                                                 03245000
ASCBTMLW EQU   ASCBRCTF                                                 03246000
ASCBOUT  EQU   ASCBRCTF                                                 03247000
ASCBWAIT EQU   ASCBRCTF                                                 03248000
ASCBRV08 EQU   ASCBRCTF                                                 03249000
ASCBFQU  EQU   ASCBRCTF                                                 03250000
ASCBFRS  EQU   ASCBRCTF                                                 03251000
ASCBTMNO EQU   ASCBRCTF                                                 03252000
ASCBAFFN EQU   ASCBFW1                                                  03253000
ASCBDUMP EQU   ASCB+96                                                  03254000
ASCBQSVC EQU   ASCB+92                                                  03255000
ASCBUBET EQU   ASCB+88                                                  03256000
ASCBECB  EQU   ASCB+84                                                  03257000
ASCBJSTL EQU   ASCB+80                                                  03258000
ASCBEWST EQU   ASCB+72                                                  03259000
ASCBEJST EQU   ASCB+64                                                  03260000
ASCBTSB  EQU   ASCB+60                                                  03261000
ASCBCSCB EQU   ASCB+56                                                  03262000
ASCBRSM  EQU   ASCB+52                                                  03263000
ASCBLDA  EQU   ASCB+48                                                  03264000
ASCBSTOR EQU   ASCB+44                                                  03265000
ASCBDP   EQU   ASCB+43                                                  03266000
ASCBRV07 EQU   ASCB+42                                                  03267000
ASCBIOSM EQU   ASCB+40                                                  03268000
ASCBSEQN EQU   ASCB+38                                                  03269000
ASCBCPUS EQU   ASCB+32                                                  03270000
ASCBSPL  EQU   ASCB+28                                                  03271000
ASCBLSLQ EQU   ASCB+24                                                  03272000
ASCBFSLQ EQU   ASCB+20                                                  03273000
ASCBIOSP EQU   ASCB+16                                                  03274000
ASCBLOCK EQU   ASCB+12                                                  03275000
ASCBBWDP EQU   ASCB+8                                                   03276000
ASCBFWDP EQU   ASCB+4                                                   03277000
ASCBASCB EQU   ASCB                                                     03278000
ASCBEGIN EQU   ASCB                                                     03279000
RESERVED EQU   AMDPRTAB+522                                             03280000
CVTTZONE EQU   AMDPRTAB+518                                             03281000
ESPSEC   EQU   ESTOPTME+7                                               03282000
ESPMIN   EQU   ESTOPTME+5                                               03283000
ESPHR    EQU   ESTOPTME+3                                               03284000
ESPDAY   EQU   ESTOPTME                                                 03285000
ESSEC    EQU   ESTARTME+7                                               03286000
ESMIN    EQU   ESTARTME+5                                               03287000
ESHR     EQU   ESTARTME+3                                               03288000
ESDAY    EQU   ESTARTME                                                 03289000
ADTSBUF  EQU   AMDPRTAB+496                                             03290000
OFSTDATA EQU   AMDPRTAB+494                                             03291000
OFSTEID  EQU   AMDPRTAB+492                                             03292000
REENTWKA EQU   AMDPRTAB+484                                             03293000
PRFMTADD EQU   AMDPRTAB+480                                             03294000
EXITADDR EQU   AMDPRTAB+472                                             03295000
EXITNM   EQU   AMDPRTAB+464                                             03296000
@NM00001 EQU   GENFLGS1                                                 03297000
TS       EQU   GENFLGS1                                                 03298000
RR       EQU   GENFLAGS                                                 03299000
SRM      EQU   GENFLAGS                                                 03300000
RNIO     EQU   GENFLAGS                                                 03301000
SYSM     EQU   GENFLAGS                                                 03302000
SYS      EQU   GENFLAGS                                                 03303000
DSP      EQU   GENFLAGS                                                 03304000
EXT      EQU   GENFLAGS                                                 03305000
PICODEA  EQU   PGMNGEN+2                                                03306000
PICODES  EQU   PGMNGEN                                                  03307000
Q        EQU   PI+1                                                     03308000
P01R     EQU   PIFLGS                                                   03309000
SELP     EQU   PIFLGS                                                   03310000
ALLP     EQU   PIFLGS                                                   03311000
USRNGTAB EQU   USRTAB                                                   03312000
O        EQU   USR+1                                                    03313000
N01R     EQU   USRFLGS                                                  03314000
SELU     EQU   USRFLGS                                                  03315000
ALLU     EQU   USRFLGS                                                  03316000
SVCNUMS  EQU   AMDPRTAB+336                                             03317000
M        EQU   VCF+1                                                    03318000
L        EQU   SVCFLGS                                                  03319000
SELV     EQU   SVCFLGS                                                  03320000
ALLV     EQU   SVCFLGS                                                  03321000
IODVADS  EQU   DVADS2                                                   03322000
K01RES   EQU   IO+1                                                     03323000
JJ       EQU   IOFLGS2                                                  03324000
SELI     EQU   IOFLGS2                                                  03325000
ALLI     EQU   IOFLGS2                                                  03326000
SIODVADS EQU   DVADS1                                                   03327000
II       EQU   SIF+1                                                    03328000
H        EQU   SIOFLGS                                                  03329000
NOEQU    EQU   SIOFLGS                                                  03330000
EQUIV    EQU   SIOFLGS                                                  03331000
SELS     EQU   SIOFLGS                                                  03332000
ALLS     EQU   SIOFLGS                                                  03333000
ASCBADDR EQU   AADS                                                     03334000
JOBNAMES EQU   NAMES                                                    03335000
DAY2     EQU   STOPTIME+10                                              03336000
F        EQU   STOPTIME+8                                               03337000
TIME2    EQU   STOPTIME                                                 03338000
DAY      EQU   STARTIME+10                                              03339000
D        EQU   STARTIME+8                                               03340000
TIME     EQU   STARTIME                                                 03341000
GTFWDPTR EQU   AMDPRTAB+20                                              03342000
C        EQU   DEBGFLGS+4                                               03343000
B        EQU   IOFLGS                                                   03344000
DMDFMT   EQU   INRFCFGS                                                 03345000
EDITSTOP EQU   INRFCFGS                                                 03346000
RET      EQU   INRFCFGS                                                 03347000
FMT      EQU   INRFCFGS                                                 03348000
SPIE     EQU   INRFCFGS                                                 03349000
FLMODE   EQU   INRFCFGS                                                 03350000
REMAIN   EQU   PTHFLGS2                                                 03351000
APP      EQU   PTHFLGS2                                                 03352000
REXT     EQU   PTHFLGS1                                                 03353000
FRM      EQU   PTHFLGS1                                                 03354000
FLT      EQU   PTHFLGS1                                                 03355000
HEX      EQU   PTHFLGS1                                                 03356000
CON      EQU   PTHFLGS1                                                 03357000
SCN      EQU   PTHFLGS1                                                 03358000
ROOT     EQU   PTHFLGS1                                                 03359000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      03360000
@RT00152 EQU   GETDONE                                                  03361000
@RT00154 EQU   GETFREE                                                  03362000
@RT00161 EQU   DUMPTRC                                                  03363000
@RT00164 EQU   GETREC                                                   03364000
@RT00213 EQU   BADLLMSG                                                 03365000
@RT00228 EQU   GETDONE                                                  03366000
@RT00230 EQU   POSIT                                                    03367000
@RF00232 EQU   GETDONE                                                  03368000
@RF00245 EQU   GETREC                                                   03369000
@RT00343 EQU   GETFINAL                                                 03370000
@RF00361 EQU   GETTERM                                                  03371000
@RT00369 EQU   DEBLKSA                                                  03372000
@RT00371 EQU   DEBLOCK                                                  03373000
@RT00403 EQU   CHAINERR                                                 03374000
@RT00431 EQU   SLQREQ                                                   03375000
@RT00445 EQU   BADLL                                                    03376000
@RT00449 EQU   NEXTBUF                                                  03377000
@RT00452 EQU   BADLL                                                    03378000
@RT00455 EQU   BADLL                                                    03379000
@RT00462 EQU   TESTSADP                                                 03380000
@RT00468 EQU   GETFINAL                                                 03381000
@RT00487 EQU   HEXBUFDP                                                 03382000
@RT00492 EQU   BADLL                                                    03383000
@RT00496 EQU   NEXTSABF                                                 03384000
@RT00510 EQU   NEXTSABF                                                 03385000
@RT00515 EQU   BADLL                                                    03386000
@RT00548 EQU   CHAINERR                                                 03387000
@RT00567 EQU   GETFINAL                                                 03388000
@RT00609 EQU   READAGAN                                                 03389000
@RT00626 EQU   CHAINERR                                                 03390000
@ENDDATA EQU   *                                                        03391000
         END   AMDPRGET,(C'PLS1959',0701,78074)                         03392000
