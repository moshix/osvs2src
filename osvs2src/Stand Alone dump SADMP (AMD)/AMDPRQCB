         TITLE 'AMDPRQCB - QUEUE CONTROL BLOCK FORMATTING ROUTINE      *00001000
                        '                                               00002000
AMDPRQCB CSECT ,                                                01S0001 00003000
@MAINENT DS    0H                                               01S0001 00004000
         USING *,@15                                            01S0001 00005000
         B     @PROLOG                                          01S0001 00006000
         DC    AL1(16)                                          01S0001 00007000
         DC    C'AMDPRQCB  78.235'                              01S0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                  01S0001 00010000
         BALR  @12,0                                            01S0001 00011000
@PSTART  DS    0H                                               01S0001 00012000
         USING @PSTART,@12                                      01S0001 00013000
*/*------------------------------------------------------------------*/ 00014000
*/* AMDPRQCB MAIN SEGMENT CONTAINS THE OVERALL LOGIC                 */ 00015000
*/*------------------------------------------------------------------*/ 00016000
*/*------------------------------------------------------------------*/ 00017000
*/* GET CORE FOR AUTOMATIC DATA AND SAVE AREA FROM THE SUBPOOL THAT  */ 00018000
*/*  WAS SPECIFIED IN THE INPUT PARAMETER LIST                       */ 00019000
*/*------------------------------------------------------------------*/ 00020000
*DO;                                                            02S0037 00021000
*  RESPECIFY (R2,R3,R5) RESTRICTED;                             02S0038 00022000
*  RESPECIFY ABDPL BASED(R5);                                   02S0039 00023000
*  R5 = R1;                       /* SAVE INPUT ADDR ACROSS GETMAIN  */ 00024000
         LR    R5,R1                                            02S0040 00025000
*  R3 = ADPLSBPL;                 /* SUBPOOL NUMBER                  */ 00026000
         SLR   R3,R3                                            02S0041 00027000
         IC    R3,ADPLSBPL(,R5)                                 02S0041 00028000
*  GEN REFS(R2,R3,DATAREG);                                     02S0042 00029000
         L    R2,@SIZDATD          SIZE OF DATA AND SAVE AREA           00030000
         GETMAIN RC,LV=(R2),SP=(R3)                                     00031000
         USING @DATD,DATAREG                                            00032000
*END;                                                           02S0043 00033000
*IF R15=0 THEN                    /* GETMAIN WAS SUCCESSFUL          */ 00034000
         LTR   R15,R15                                          01S0044 00035000
         BNZ   @RF00044                                         01S0044 00036000
*  DO;                                                          01S0045 00037000
*/*------------------------------------------------------------------*/ 00038000
*/* SET UP SAVE AREA CHAINING AND INITIALIZE                         */ 00039000
*/*------------------------------------------------------------------*/ 00040000
*DO;                                                            02S0046 00041000
*  DATAREG = R1;                  /* ADDRESS OF GOTTEN CORE          */ 00042000
         LR    DATAREG,R1                                       02S0047 00043000
*  GENERATE;                                                    02S0048 00044000
         ST    13,@SA00001+4                                            00045000
         LA    15,@SA00001                                              00046000
         ST    15,8(,13)                                                00047000
         LR    13,15                                                    00048000
*  EBCPTR = ADDR(EBCDIC) - 240;   /* INIT POINTER TO TR TABLE        */ 00049000
         LA    @14,EBCDIC                                       02S0049 00050000
         SH    @14,@CH01121                                     02S0049 00051000
         ST    @14,EBCPTR                                       02S0049 00052000
*  RETCODE = 0;                                                 02S0050 00053000
         SLR   RETCODE,RETCODE                                  02S0050 00054000
*  ABDPLPTR = R5;                 /* SAVE ADDRESS OF PARAMETER LIST  */ 00055000
         ST    R5,ABDPLPTR                                      02S0051 00056000
*  INMAJPTR = ADDR(INMAJ);                                      02S0052 00057000
         LA    @14,INMAJ                                        02S0052 00058000
         ST    @14,INMAJPTR                                     02S0052 00059000
*  INMINPTR = ADDR(INMIN);                                      02S0053 00060000
         LA    INMINPTR,INMIN                                   02S0053 00061000
*  INQELPTR = ADDR(INQEL);                                      02S0054 00062000
         LA    @14,INQEL                                        02S0054 00063000
         ST    @14,INQELPTR                                     02S0054 00064000
*  RESPECIFY ABDPL BASED(ABDPLPTR);                             02S0055 00065000
*  RESPECIFY (R2,R3,R5) UNRESTRICTED;                           02S0056 00066000
*  BUFFRPTR = ADPLBUF;            /* SUPPLIED OUTPUT BUFFER          */ 00067000
         L     @14,ABDPLPTR                                     02S0057 00068000
         L     BUFFRPTR,ADPLBUF(,@14)                           02S0057 00069000
*END;                                                           02S0058 00070000
*    MESSAGE(27:94) = TITLE;      /* TITLE LINE                      */ 00071000
         MVC   MESSAGE+26(68,BUFFRPTR),TITLE                    01S0059 00072000
*    CALL PRINTRTN;               /* PRINT TITLE                     */ 00073000
         BAL   @14,PRINTRTN                                     01S0060 00074000
*    IF ADPLCVT^=0 THEN           /* THERE IS A CVT                  */ 00075000
         L     @14,ABDPLPTR                                     01S0061 00076000
         ICM   @08,15,ADPLCVT(@14)                              01S0061 00077000
         BZ    @RF00061                                         01S0061 00078000
*     DO;                                                       01S0062 00079000
*      R0 = ADDR(CVTFQCB);        /* SETUP TO READ QCB POINTER       */ 00080000
         L     @08,CVTPTR(,@14)                                 01S0063 00081000
         LA    R0,CVTFQCB(,@08)                                 01S0063 00082000
*      R1 = ABDPLPTR;             /* ADDR OF PARM LIST               */ 00083000
         LR    R1,@14                                           01S0064 00084000
*      CALL MEMACRTN;             /* READ ONE WORD                   */ 00085000
         L     @15,ADPLMEMA(,@14)                               01S0065 00086000
         BALR  @14,@15                                          01S0065 00087000
*      IF R15=0 THEN                                            01S0066 00088000
         SLR   @14,@14                                          01S0066 00089000
         CR    R15,@14                                          01S0066 00090000
         BNE   @RF00066                                         01S0066 00091000
*       DO;                                                     01S0067 00092000
*        QCBHEAD = DATAWORD;      /* SAVE POINTER TO FIRST QCB       */ 00093000
         LR    @08,R0                                           01S0068 00094000
         L     @08,DATAWORD(,@08)                               01S0068 00095000
         ST    @08,QCBHEAD                                      01S0068 00096000
*        IF QCBHEAD=0 THEN        /* THERE IS NO QCB CHAIN           */ 00097000
         CR    @08,@14                                          01S0069 00098000
         BNE   @RF00069                                         01S0069 00099000
*/*------------------------------------------------------------------*/ 00100000
*/* ISSUE NO QCBS MESSAGE                                            */ 00101000
*/*------------------------------------------------------------------*/ 00102000
*DO;                                                            02S0070 00103000
*  CALL PRINTRTN;                                               02S0071 00104000
         BAL   @14,PRINTRTN                                     02S0071 00105000
*  MESSAGE(1:LENGTH(NOQCBMSG)) = NOQCBMSG;                      02S0072 00106000
         MVC   MESSAGE(13,BUFFRPTR),NOQCBMSG                    02S0072 00107000
*  CALL PRINTRTN;                                               02S0073 00108000
         BAL   @14,PRINTRTN                                     02S0073 00109000
*END;                                                           02S0074 00110000
*        ELSE                                                   01S0075 00111000
*          DO;                                                  01S0075 00112000
         B     @RC00069                                         01S0075 00113000
@RF00069 DS    0H                                               01S0076 00114000
*            R0 = ADDR(CVTLQCB);                                01S0076 00115000
         L     @14,ABDPLPTR                                     01S0076 00116000
         L     @08,CVTPTR(,@14)                                 01S0076 00117000
         LA    R0,CVTLQCB(,@08)                                 01S0076 00118000
*            R1 = ABDPLPTR;       /* ADDR OF PARM LIST               */ 00119000
         LR    R1,@14                                           01S0077 00120000
*            CALL MEMACRTN;       /* READ PTR TO LAST QCB            */ 00121000
         L     @15,ADPLMEMA(,@14)                               01S0078 00122000
         BALR  @14,@15                                          01S0078 00123000
*            IF R15=0 THEN                                      01S0079 00124000
         LTR   R15,R15                                          01S0079 00125000
         BNZ   @RF00079                                         01S0079 00126000
*              QCBTAIL = DATAWORD;                              01S0080 00127000
         LR    @14,R0                                           01S0080 00128000
         MVC   QCBTAIL(4),DATAWORD(@14)                         01S0080 00129000
*            ELSE                                               01S0081 00130000
*              QCBTAIL = 0;       /* INDICATE NO POINTER TO LAST     */ 00131000
         B     @RC00079                                         01S0081 00132000
@RF00079 SLR   @14,@14                                          01S0081 00133000
         ST    @14,QCBTAIL                                      01S0081 00134000
*            CALL MAJFAMLY;                                     01S0082 00135000
@RC00079 BAL   @14,MAJFAMLY                                     01S0082 00136000
*          END;                                                 01S0083 00137000
*        END;                                                   01S0084 00138000
*      ELSE                       /* READ FOR CVTFQCB WAS UNSUCCESSFL*/ 00139000
*/*------------------------------------------------------------------*/ 00140000
*/* INDICATE THAT THE POINTER TO THE HEAD MAJOR QCB COULD NOT BE READ*/ 00141000
*/*------------------------------------------------------------------*/ 00142000
*DO;                                                            02S0085 00143000
         B     @RC00066                                         02S0085 00144000
@RF00066 DS    0H                                               02S0086 00145000
*  CALL PRINTRTN;                                               02S0086 00146000
         BAL   @14,PRINTRTN                                     02S0086 00147000
*  MESSAGE(1:LENGTH(CVTQCBMG)) = CVTQCBMG;                      02S0087 00148000
         MVC   MESSAGE(37,BUFFRPTR),CVTQCBMG                    02S0087 00149000
*  CALL PRINTRTN;                                               02S0088 00150000
         BAL   @14,PRINTRTN                                     02S0088 00151000
*END;                                                           02S0089 00152000
*     END;                                                      01S0090 00153000
*    ELSE                         /* NO CVT IN DUMP                  */ 00154000
*/*------------------------------------------------------------------*/ 00155000
*/* INDICATE THAT THE CVTPTR WAS ZERO                                */ 00156000
*/*------------------------------------------------------------------*/ 00157000
*DO;                                                            02S0091 00158000
         B     @RC00061                                         02S0091 00159000
@RF00061 DS    0H                                               02S0092 00160000
*  CALL PRINTRTN;                                               02S0092 00161000
         BAL   @14,PRINTRTN                                     02S0092 00162000
*  NOCVT = NOCVTMSG;                                            02S0093 00163000
         MVC   NOCVT(20,BUFFRPTR),NOCVTMSG                      02S0093 00164000
*  CALL PRINTRTN;                                               02S0094 00165000
         BAL   @14,PRINTRTN                                     02S0094 00166000
*END;                                                           02S0095 00167000
*  END;                                                         01S0096 00168000
*ELSE                             /* GETMAIN FAILED                  */ 00169000
*  DO;                                                          01S0097 00170000
         B     @RC00044                                         01S0097 00171000
@RF00044 DS    0H                                               01S0098 00172000
*    R15 = NOCORE;                /* INDICATE GETMAIN FAILURE        */ 00173000
         LA    R15,4                                            01S0098 00174000
*    GO TO EXIT;                  /* RETURN TO CALLER                */ 00175000
         B     EXIT                                             01S0099 00176000
*  END;                                                         01S0100 00177000
*/*------------------------------------------------------------------*/ 00178000
*/* FREE CORE AND RETURN                                             */ 00179000
*/*------------------------------------------------------------------*/ 00180000
*DO;                                                            02S0101 00181000
@RC00044 DS    0H                                               02S0102 00182000
*  RESPECIFY (R2,R13) RESTRICTED;                               02S0102 00183000
*  R15 = RETCODE;                                               02S0103 00184000
         LR    R15,RETCODE                                      02S0103 00185000
*  GEN REFS(R13) (L    R13,@SA00001+4);                         02S0104 00186000
         L    R13,@SA00001+4                                            00187000
*  GEN REFS(R3) (L    R3,@SIZDATD);                             02S0105 00188000
         L    R3,@SIZDATD                                               00189000
*  R2 = ADPLSBPL;                                               02S0106 00190000
         L     @14,ABDPLPTR                                     02S0106 00191000
         SLR   R2,R2                                            02S0106 00192000
         IC    R2,ADPLSBPL(,@14)                                02S0106 00193000
*  R1 = DATAREG;                                                02S0107 00194000
         LR    R1,DATAREG                                       02S0107 00195000
*  GENERATE(FREEMAIN R,LV=(R3),A=(1),SP=(R2));                  02S0108 00196000
         FREEMAIN R,LV=(R3),A=(1),SP=(R2)                               00197000
*  EXIT: GENERATE;                                              02S0109 00198000
EXIT     DS    0H                                               02S0109 00199000
         L     14,12(13)                                                00200000
         LM    0,12,20(13)                                              00201000
         BR    14                                                       00202000
*  RESPECIFY (R2,R13) UNRESTRICTED;                             02S0110 00203000
*END;                                                           02S0111 00204000
*PRINTRTN: PROCEDURE;                                           02S0112 00205000
PRINTRTN STM   @14,@08,@SA00002                                 02S0112 00206000
         STM   @10,@12,@SA00002+44                              02S0112 00207000
*/*------------------------------------------------------------------*/ 00208000
*/* THIS ROUTINE CALLS THE SUPPLIED PRINT ROUTINE AND GETS THE       */ 00209000
*/* ADDRESS OF THE NEW OUTPUT BUFFER                                 */ 00210000
*/*------------------------------------------------------------------*/ 00211000
*  R1 = ABDPLPTR;                 /* ADDR OF PARM LIST               */ 00212000
         L     @14,ABDPLPTR                                     02S0113 00213000
         LR    R1,@14                                           02S0113 00214000
*  CALL PRINTR;                                                 02S0114 00215000
         L     @15,ADPLPRNT(,@14)                               02S0114 00216000
         BALR  @14,@15                                          02S0114 00217000
*  BUFFRPTR = ADPLBUF;            /* NEW BUFFER ADDRESS              */ 00218000
         L     @14,ABDPLPTR                                     02S0115 00219000
         L     BUFFRPTR,ADPLBUF(,@14)                           02S0115 00220000
*END PRINTRTN;                                                  02S0116 00221000
@EL00002 DS    0H                                               02S0116 00222000
@EF00002 DS    0H                                               02S0116 00223000
@ER00002 LM    @14,@08,@SA00002                                 02S0116 00224000
         LM    @10,@12,@SA00002+44                              02S0116 00225000
         BR    @14                                              02S0116 00226000
*MAJFAMLY: PROCEDURE;                                           02S0117 00227000
MAJFAMLY STM   @14,@12,@SA00003                                 02S0117 00228000
*/*------------------------------------------------------------------*/ 00229000
*/* EACH MAJOR QCB IS FORMATTED. EVERY MINOR QCB UNDER EACH MAJOR    */ 00230000
*/* QCB IS FORMATTED, AND EVERY QEL UNDER EACH MINOR QCB IS          */ 00231000
*/* FORMATTED.                                                       */ 00232000
*/*------------------------------------------------------------------*/ 00233000
*  READAD = QCBHEAD;              /* ADDRESS OF START OF QCB CHAIN   */ 00234000
         MVC   READAD(4),QCBHEAD                                02S0118 00235000
*  STOPMAJ = QCBTAIL;              /* SET LAST IN CHAIN     @OZ15488 */ 00236000
         MVC   STOPMAJ(4),QCBTAIL                               02S0119 00237000
*  MAJBREAK = NO;                 /* INIT QCB CHAIN STATUS           */ 00238000
*  MAJCHAIN = NOTDONE;            /* INIT LOOP CONTROL               */ 00239000
         NI    MAJBREAK,B'00111111'                             02S0121 00240000
*  DO MAJCOUNT=1 TO MAJMAX WHILE MAJCHAIN=NOTDONE;              02S0122 00241000
         LA    MAJCOUNT,1                                       02S0122 00242000
         B     @DE00122                                         02S0122 00243000
@DL00122 TM    MAJCHAIN,B'10000000'                             02S0122 00244000
         BNZ   @DC00122                                         02S0122 00245000
*    THISMAJ = READAD;                                          02S0123 00246000
         MVC   THISMAJ(4),READAD                                02S0123 00247000
*    TOPTR = ADDR(INMAJ);         /* COPY MAJOR QCB HERE             */ 00248000
         LA    TOPTR,INMAJ                                      02S0124 00249000
*    COPYLGT = LENGTH(MAJ);                                     02S0125 00250000
         LA    COPYLGT,24                                       02S0125 00251000
*    INMAJ = INMAJ&&INMAJ;        /* ZERO OUT ALL FIELDS             */ 00252000
         XC    INMAJ(24),INMAJ                                  02S0126 00253000
*    CALL COPY;                                                 02S0127 00254000
         BAL   @14,COPY                                         02S0127 00255000
*    IF COPYSTAT<BCKPTR & MAJBREAK=YES THEN                     02S0128 00256000
         CH    COPYSTAT,@CH00082                                02S0128 00257000
         BNL   @RF00128                                         02S0128 00258000
         TM    MAJBREAK,B'01000000'                             02S0128 00259000
         BNO   @RF00128                                         02S0128 00260000
*/*------------------------------------------------------------------*/ 00261000
*/* A READ FAILURE HAS OCCURRED FOR THE SECOND TIME IN THE MAJOR QCB */ 00262000
*/* CHAIN. A MESSAGE IS ISSUED AND PROCESSING IS TERMINATED.         */ 00263000
*/*------------------------------------------------------------------*/ 00264000
*DO;                                                            03S0129 00265000
*  CALL PRINTRTN;                                               03S0130 00266000
         BAL   @14,PRINTRTN                                     03S0130 00267000
*  MAJBREAK = NO;                                               03S0131 00268000
*  MAJCHAIN = DONE;               /* STOP MAJOR FORMATTING LOOP      */ 00269000
         OI    MAJCHAIN,B'10000000'                             03S0132 00270000
         NI    MAJBREAK,B'10111111'                             03S0132 00271000
*  QCBCHN1 = ERRFND;              /* SET UP MESSAGE TEXT             */ 00272000
         MVC   QCBCHN1(13,BUFFRPTR),ERRFND                      03S0133 00273000
*  QCBCHN2 = MAJORQCB;                                          03S0134 00274000
*                                                               03S0134 00275000
         MVC   QCBCHN2(9,BUFFRPTR),MAJORQCB                     03S0134 00276000
*   DO;                                                         03S0135 00277000
*     UNPK(QCBCHN3,THISMAJH);                                   03S0136 00278000
         UNPK  QCBCHN3(7,BUFFRPTR),THISMAJH(4)                  03S0136 00279000
*     TR(QCBCHN3,EBCTABL);                                      03S0137 00280000
         L     @14,EBCPTR                                       03S0137 00281000
         TR    QCBCHN3(7,BUFFRPTR),EBCTABL(@14)                 03S0137 00282000
*     QCBCHN3(LENGTH(QCBCHN3)) = ' ';                           03S0138 00283000
         MVI   QCBCHN3+6(BUFFRPTR),C' '                         03S0138 00284000
*   END;                                                        03S0139 00285000
*  QCBCHND = DASH;                                              03S0140 00286000
         MVC   QCBCHND(2,BUFFRPTR),DASH                         03S0140 00287000
*  QCBCHN4 = TERMTEXT;                                          03S0141 00288000
         MVC   QCBCHN4(19,BUFFRPTR),TERMTEXT                    03S0141 00289000
*  CALL PRINTRTN;                                               03S0142 00290000
         BAL   @14,PRINTRTN                                     03S0142 00291000
*END;                                                           03S0143 00292000
*    ELSE                                                       02S0144 00293000
*      IF COPYSTAT=NONE THEN                                    02S0144 00294000
         B     @RC00128                                         02S0144 00295000
@RF00128 LTR   COPYSTAT,COPYSTAT                                02S0144 00296000
         BNZ   @RF00144                                         02S0144 00297000
*/*------------------------------------------------------------------*/ 00298000
*/* A READ FAILURE HAS OCCURRED IN THE MAJOR QCB CHAIN. AN OUTPUT    */ 00299000
*/* COMMENT IS PRINTED AND, IF POSSIBLE BACKWARD TRACING IS          */ 00300000
*/* INITIATED. IF BACKWARD TRACING IS NOT POSSIBLE THEN THE          */ 00301000
*/* PROCESSING IS TERMINATED.                                        */ 00302000
*/*------------------------------------------------------------------*/ 00303000
*DO;                                                            03S0145 00304000
*  CALL PRINTRTN;                                               03S0146 00305000
         BAL   @14,PRINTRTN                                     03S0146 00306000
*  MAJBREAK = YES;                /* INDICATE BACK CHAINING IS NEEDED*/ 00307000
         OI    MAJBREAK,B'01000000'                             03S0147 00308000
*  QCBCHN1 = ERRFND;              /* SET UP COMMON MESSAGE TEXT      */ 00309000
         MVC   QCBCHN1(13,BUFFRPTR),ERRFND                      03S0148 00310000
*  QCBCHN2 = MAJORQCB;                                          03S0149 00311000
*                                                               03S0149 00312000
         MVC   QCBCHN2(9,BUFFRPTR),MAJORQCB                     03S0149 00313000
*   DO;                                                         03S0150 00314000
*     UNPK(QCBCHN3,THISMAJH);                                   03S0151 00315000
         UNPK  QCBCHN3(7,BUFFRPTR),THISMAJH(4)                  03S0151 00316000
*     TR(QCBCHN3,EBCTABL);                                      03S0152 00317000
         L     @14,EBCPTR                                       03S0152 00318000
         TR    QCBCHN3(7,BUFFRPTR),EBCTABL(@14)                 03S0152 00319000
*     QCBCHN3(LENGTH(QCBCHN3)) = ' ';                           03S0153 00320000
         MVI   QCBCHN3+6(BUFFRPTR),C' '                         03S0153 00321000
*   END;                                                        03S0154 00322000
*  QCBCHND = DASH;                                              03S0155 00323000
         MVC   QCBCHND(2,BUFFRPTR),DASH                         03S0155 00324000
*  IF QCBTAIL=0 THEN              /* POINTER TO LAST QCB NOT AVAIL   */ 00325000
         ICM   @14,15,QCBTAIL                                   03S0156 00326000
         BNZ   @RF00156                                         03S0156 00327000
*    DO;                                                        03S0157 00328000
*      MAJCHAIN = DONE;           /* TERMINATE PROCESSING            */ 00329000
         OI    MAJCHAIN,B'10000000'                             03S0158 00330000
*      QCBCHN4 = TERMTEXT;                                      03S0159 00331000
         MVC   QCBCHN4(19,BUFFRPTR),TERMTEXT                    03S0159 00332000
*    END;                                                       03S0160 00333000
*  ELSE                           /* POINTER TO LAST QCB IS AVAILABLE*/ 00334000
*    DO;                                                        03S0161 00335000
         B     @RC00156                                         03S0161 00336000
@RF00156 DS    0H                                               03S0162 00337000
*      QCBCHN5 = FRSTBRK2;                                      03S0162 00338000
         MVC   QCBCHN5(24,BUFFRPTR),FRSTBRK2                    03S0162 00339000
*      MAJPMAJ = QCBTAIL;         /* SET UP TO READ FROM END        */  00340000
         L     @14,INMAJPTR                                     03S0163 00341000
         MVC   MAJPMAJ(4,@14),QCBTAIL                           03S0163 00342000
*      STOPMAJ = THISMAJ;         /* SET LAST FOR BKWRDS    @OZ15488 */ 00343000
         MVC   STOPMAJ(4),THISMAJ                               03S0164 00344000
*    END;                                                       03S0165 00345000
*  CALL PRINTRTN;         /* PRINT BROKEN CHAIN COMMENT      */ 03S0166 00346000
@RC00156 BAL   @14,PRINTRTN                                     03S0166 00347000
*END;                                                           03S0167 00348000
*    IF COPYSTAT>NONE & MAJCHAIN=NOTDONE THEN                   02S0168 00349000
@RF00144 DS    0H                                               02S0168 00350000
@RC00128 LTR   COPYSTAT,COPYSTAT                                02S0168 00351000
         BNP   @RF00168                                         02S0168 00352000
         TM    MAJCHAIN,B'10000000'                             02S0168 00353000
         BNZ   @RF00168                                         02S0168 00354000
*/*------------------------------------------------------------------*/ 00355000
*/* FORMAT THE MAJOR QCB -- PRINT ADDRESS AND MAJOR NAME             */ 00356000
*/*------------------------------------------------------------------*/ 00357000
*DO;                                                            03S0169 00358000
*  CALL PRINTRTN;                 /* SKIP A LINE                     */ 00359000
         BAL   @14,PRINTRTN                                     03S0170 00360000
*  CALL PRINTRTN;                 /* SKIP A LINE                     */ 00361000
         BAL   @14,PRINTRTN                                     03S0171 00362000
*  HDRMAJ = MAJOR;                /* MAJOR TITLE                     */ 00363000
         MVC   HDRMAJ(5,BUFFRPTR),MAJOR                         03S0172 00364000
*  INCOMPLT = ON;                 /* TURNED OFF LATER IF WHOLE QCB      00365000
*                                    IS FORMATTED                    */ 00366000
*                                                               03S0173 00367000
         OI    INCOMPLT,B'00000010'                             03S0173 00368000
*   DO;                                                         03S0174 00369000
*     UNPK(ADDRMAJ,THISMAJH);                                   03S0175 00370000
         UNPK  ADDRMAJ(7,BUFFRPTR),THISMAJH(4)                  03S0175 00371000
*     TR(ADDRMAJ,EBCTABL);                                      03S0176 00372000
         L     @14,EBCPTR                                       03S0176 00373000
         TR    ADDRMAJ(7,BUFFRPTR),EBCTABL(@14)                 03S0176 00374000
*     ADDRMAJ(LENGTH(ADDRMAJ)) = ' ';                           03S0177 00375000
         MVI   ADDRMAJ+6(BUFFRPTR),C' '                         03S0177 00376000
*   END;                                                        03S0178 00377000
*  IF COPYSTAT = COPYLGT THEN     /* FORMAT ENTIRE QCB               */ 00378000
         CR    COPYSTAT,COPYLGT                                 03S0179 00379000
         BNE   @RF00179                                         03S0179 00380000
*    DO;                                                        03S0180 00381000
*      INCOMPLT = OFF;                                          03S0181 00382000
         NI    INCOMPLT,B'11111101'                             03S0181 00383000
*      NAMMAJLB = NAME;           /* COPY NAME TO OUTPUT BUFFER      */ 00384000
         MVC   NAMMAJLB(4,BUFFRPTR),NAME                        03S0182 00385000
*      RESPECIFY R2 RESTRICTED;                                 03S0183 00386000
*      R2 = 0;                                                  03S0184 00387000
         SLR   R2,R2                                            03S0184 00388000
*      TRT(MAJNAME,NONPRNT);      /* TEST NAME FOR NONPRINTABLE CHARS*/ 00389000
         L     @03,INMAJPTR                                     03S0185 00390000
         TRT   MAJNAME(8,@03),NONPRNT                           03S0185 00391000
*      IF R2=0 THEN               /* MAJOR NAME IS PRINTABLE         */ 00392000
         LTR   R2,R2                                            03S0186 00393000
         BNZ   @RF00186                                         03S0186 00394000
*        NAMEMAJ = MAJNAME;       /* MOVE NAME TO OUTPUT LINE        */ 00395000
         L     @14,INMAJPTR                                     03S0187 00396000
         MVC   NAMEMAJ(8,BUFFRPTR),MAJNAME(@14)                 03S0187 00397000
*      ELSE                       /* NAME IS UNPRINTABLE             */ 00398000
*        DO;                      /* CONVERT NAME TO PRINTABLE HEX   */ 00399000
         B     @RC00186                                         03S0188 00400000
@RF00186 DS    0H                                               03S0189 00401000
*          RESPECIFY R2 UNRESTRICTED;                           03S0189 00402000
*                                                               03S0189 00403000
*          DO;                                                  03S0190 00404000
*            UNPK(NAMEMAJ1,MAJORNM1);                           03S0191 00405000
         L     @14,INMAJPTR                                     03S0191 00406000
         UNPK  NAMEMAJ1(9,BUFFRPTR),MAJORNM1(5,@14)             03S0191 00407000
*            TR(NAMEMAJ1,EBCTABL);                              03S0192 00408000
         L     @08,EBCPTR                                       03S0192 00409000
         TR    NAMEMAJ1(9,BUFFRPTR),EBCTABL(@08)                03S0192 00410000
*            NAMEMAJ1(LENGTH(NAMEMAJ1)) = ' ';                  03S0193 00411000
         MVI   NAMEMAJ1+8(BUFFRPTR),C' '                        03S0193 00412000
*          END;                                                 03S0194 00413000
*                                                               03S0194 00414000
*          DO;                                                  03S0195 00415000
*            UNPK(NAMEMAJ2,MAJORNM2);                           03S0196 00416000
         UNPK  NAMEMAJ2(9,BUFFRPTR),MAJORNM2(5,@14)             03S0196 00417000
*            TR(NAMEMAJ2,EBCTABL);                              03S0197 00418000
         TR    NAMEMAJ2(9,BUFFRPTR),EBCTABL(@08)                03S0197 00419000
*            NAMEMAJ2(LENGTH(NAMEMAJ2)) = ' ';                  03S0198 00420000
         MVI   NAMEMAJ2+8(BUFFRPTR),C' '                        03S0198 00421000
*          END;                                                 03S0199 00422000
*          MASTAR1 = STAR;                                      03S0200 00423000
         MVI   MASTAR1(BUFFRPTR),C'*'                           03S0200 00424000
*          EBCFLD1 = MAJNAME;     /* ALSO PRINT AS IS                */ 00425000
         MVC   EBCFLD1(8,BUFFRPTR),MAJNAME(@14)                 03S0201 00426000
*          TR(EBCFLD1,PRNTTBL);   /* MASK OUT NONPRINTABLES          */ 00427000
         TR    EBCFLD1(8,BUFFRPTR),PRNTTBL                      03S0202 00428000
*          MASTAR2 = STAR;                                      03S0203 00429000
         MVI   MASTAR2(BUFFRPTR),C'*'                           03S0203 00430000
*        END;                                                   03S0204 00431000
*    END;                                                       03S0205 00432000
@RC00186 DS    0H                                               03S0206 00433000
*  CALL PRINTRTN;                 /* PRINT MAJOR QCB LINE            */ 00434000
@RF00179 BAL   @14,PRINTRTN                                     03S0206 00435000
*  IF INCOMPLT=ON THEN            /* ONLY A PORTION WAS FORMATTED    */ 00436000
         TM    INCOMPLT,B'00000010'                             03S0207 00437000
         BNO   @RF00207                                         03S0207 00438000
*    DO;                                                        03S0208 00439000
*      STARTMSG = 2;                                            03S0209 00440000
         LA    STARTMSG,2                                       03S0209 00441000
*      CALL PARTPRNT;             /* PRINT ERROR COMMENT             */ 00442000
         BAL   @14,PARTPRNT                                     03S0210 00443000
*    END;                                                       03S0211 00444000
*END;                                                           03S0212 00445000
@RF00207 DS    0H                                               03S0213 00446000
*    IF MAJFMIN^=0 THEN           /* GET MINOR QCBS                  */ 00447000
@RF00168 L     @14,INMAJPTR                                     02S0213 00448000
         ICM   @08,15,MAJFMIN(@14)                              02S0213 00449000
         BZ    @RF00213                                         02S0213 00450000
*      CALL MINFAMLY;                                           02S0214 00451000
         BAL   @14,MINFAMLY                                     02S0214 00452000
*   IF THISMAJ = STOPMAJ THEN      /* STOP NOW IF AT END    @OZ15488 */ 00453000
@RF00213 CLC   THISMAJ(4),STOPMAJ                               02S0215 00454000
         BNE   @RF00215                                         02S0215 00455000
*      MAJCHAIN = DONE;            /* END LOOP              @OZ15488 */ 00456000
         OI    MAJCHAIN,B'10000000'                             02S0216 00457000
*   ELSE                                                /*  @OZ15488 */ 00458000
*   DO;                                                 /*  @OZ15488 */ 00459000
         B     @RC00215                                         02S0217 00460000
@RF00215 DS    0H                                               02S0218 00461000
*    IF MAJBREAK=YES THEN                                       02S0218 00462000
         TM    MAJBREAK,B'01000000'                             02S0218 00463000
         BNO   @RF00218                                         02S0218 00464000
*      IF MAJPMAJ^=0 THEN         /* BACKWARD POINTER OK             */ 00465000
         L     @14,INMAJPTR                                     02S0219 00466000
         L     @14,MAJPMAJ(,@14)                                02S0219 00467000
         LTR   @14,@14                                          02S0219 00468000
         BZ    @RF00219                                         02S0219 00469000
*        READAD = MAJPMAJ;                                      02S0220 00470000
         ST    @14,READAD                                       02S0220 00471000
*      ELSE                                                     02S0221 00472000
*        MAJCHAIN = DONE;         /* TERMINATE                       */ 00473000
         B     @RC00219                                         02S0221 00474000
@RF00219 OI    MAJCHAIN,B'10000000'                             02S0221 00475000
*    ELSE                         /* STILL GOING FORWARD             */ 00476000
*      IF MAJNMAJ^=0 THEN                                       02S0222 00477000
         B     @RC00218                                         02S0222 00478000
@RF00218 L     @14,INMAJPTR                                     02S0222 00479000
         L     @14,MAJNMAJ(,@14)                                02S0222 00480000
         LTR   @14,@14                                          02S0222 00481000
         BZ    @RF00222                                         02S0222 00482000
*        READAD = MAJNMAJ;                                      02S0223 00483000
         ST    @14,READAD                                       02S0223 00484000
*      ELSE                                                     02S0224 00485000
*        MAJCHAIN = DONE;         /* TERMINATE                       */ 00486000
         B     @RC00222                                         02S0224 00487000
@RF00222 OI    MAJCHAIN,B'10000000'                             02S0224 00488000
*   END;                                                /*  @OZ15488 */ 00489000
@RC00222 DS    0H                                               02S0225 00490000
@RC00218 DS    0H                                               02S0226 00491000
*  END;                                                         02S0226 00492000
@RC00215 AH    MAJCOUNT,@CH00039                                02S0226 00493000
@DE00122 C     MAJCOUNT,MAJMAX                                  02S0226 00494000
         BNH   @DL00122                                         02S0226 00495000
@DC00122 DS    0H                                               02S0227 00496000
*  IF MAJCOUNT>MAJMAX & MAJCHAIN=NOTDONE THEN                   02S0227 00497000
         C     MAJCOUNT,MAJMAX                                  02S0227 00498000
         BNH   @RF00227                                         02S0227 00499000
         TM    MAJCHAIN,B'10000000'                             02S0227 00500000
         BNZ   @RF00227                                         02S0227 00501000
*/*------------------------------------------------------------------*/ 00502000
*/* INDICATE THAT A LOOP CONDITION WAS ASSUMED IN THE MAJOR          */ 00503000
*/* QCB CHAIN                                                        */ 00504000
*/*------------------------------------------------------------------*/ 00505000
*DO;                                                            03S0228 00506000
*  CALL PRINTRTN;                                               03S0229 00507000
         BAL   @14,PRINTRTN                                     03S0229 00508000
*  INVALID = INVALMSG;                                          03S0230 00509000
         MVC   INVALID(7,BUFFRPTR),INVALMSG                     03S0230 00510000
*  INVALQCB = MAJORQCB;                                         03S0231 00511000
         MVC   INVALQCB(9,BUFFRPTR),MAJORQCB                    03S0231 00512000
*  ASSUME = ASSUMED;                                            03S0232 00513000
         MVC   ASSUME(13,BUFFRPTR),ASSUMED                      03S0232 00514000
*  CALL PRINTRTN;                                               03S0233 00515000
         BAL   @14,PRINTRTN                                     03S0233 00516000
*END;                                                           03S0234 00517000
*END MAJFAMLY;                                                  02S0235 00518000
@EL00003 DS    0H                                               02S0235 00519000
@EF00003 DS    0H                                               02S0235 00520000
@ER00003 LM    @14,@12,@SA00003                                 02S0235 00521000
         BR    @14                                              02S0235 00522000
*/*------------------------------------------------------------------*/ 00523000
*/* OBTAIN ALL THE MINOR QCBS THAT ARE CHAINED TO THE CURRENT        */ 00524000
*/*  MAJOR QCB.  IF THE CHAIN IS BROKEN THEN AN ATTEMPT IS MADE      */ 00525000
*/*  TO START AT THE END AND GO BACK THROUGH THE CHAIN               */ 00526000
*/*------------------------------------------------------------------*/ 00527000
*MINFAMLY: PROCEDURE;                                           02S0236 00528000
MINFAMLY STM   @14,@08,@SA00004                                 02S0236 00529000
         STM   @10,@12,@SA00004+44                              02S0236 00530000
*  READAD = MAJFMIN;                                            02S0237 00531000
         L     @14,INMAJPTR                                     02S0237 00532000
         MVC   READAD(4),MAJFMIN(@14)                           02S0237 00533000
*  STOPMIN = MAJLMIN;              /* SET LAST IN CHAIN     @OZ15488 */ 00534000
         MVC   STOPMIN(4),MAJLMIN(@14)                          02S0238 00535000
*  MINBREAK = NO;                 /* INIT QCB CHAIN STATUS           */ 00536000
*  MINCHAIN = NOTDONE;            /* INIT LOOP CONTROL               */ 00537000
         NI    MINBREAK,B'11001111'                             02S0240 00538000
*  DO MINCOUNT=1 TO MINMAX WHILE MINCHAIN=NOTDONE;              02S0241 00539000
         LA    @14,1                                            02S0241 00540000
         B     @DE00241                                         02S0241 00541000
@DL00241 TM    MINCHAIN,B'00100000'                             02S0241 00542000
         BNZ   @DC00241                                         02S0241 00543000
*    THISMIN = READAD;                                          02S0242 00544000
         MVC   THISMIN(4),READAD                                02S0242 00545000
*    TOPTR = ADDR(INMIN);         /* COPY MINOR QCB HERE             */ 00546000
         LA    TOPTR,INMIN                                      02S0243 00547000
*    COPYLGT = LENGTH(MIN)-1;                                   02S0244 00548000
         LA    COPYLGT,20                                       02S0244 00549000
*    INMIN = INMIN&&INMIN;        /* ZERO OUT ALL FIELDS             */ 00550000
         XC    INMIN(246),INMIN                                 02S0245 00551000
*    CALL COPY;                   /* COPY NEXT MINOR QCB             */ 00552000
         BAL   @14,COPY                                         02S0246 00553000
*    IF COPYSTAT<BCKPTR & MINBREAK=YES THEN /* SECOND BREAK,ALL DONE */ 00554000
         CH    COPYSTAT,@CH00082                                02S0247 00555000
         BNL   @RF00247                                         02S0247 00556000
         TM    MINBREAK,B'00010000'                             02S0247 00557000
         BNO   @RF00247                                         02S0247 00558000
*/*------------------------------------------------------------------*/ 00559000
*/* THIS IS THE SECOND BREAK IN THE MINOR QCB CHAIN.                 */ 00560000
*/* AN OUTPUT COMMENT IS PRINTED AND THE MINOR QCB LOOP              */ 00561000
*/* IS TERMINATED FOR THIS MAJOR QCB                                 */ 00562000
*/*------------------------------------------------------------------*/ 00563000
*DO;                                                            03S0248 00564000
*  CALL PRINTRTN;                 /* PRINT OUTPUT COMMENT            */ 00565000
         BAL   @14,PRINTRTN                                     03S0249 00566000
*  MINBREAK = NO;                                               03S0250 00567000
*  MINCHAIN = DONE;               /* STOP MINOR FORMATTING LOOP      */ 00568000
         OI    MINCHAIN,B'00100000'                             03S0251 00569000
         NI    MINBREAK,B'11101111'                             03S0251 00570000
*  QCBCHN1 = ERRFND;              /* SET UP ERROR MESSAGE TEXT       */ 00571000
         MVC   QCBCHN1(13,BUFFRPTR),ERRFND                      03S0252 00572000
*  QCBCHN2 = MINORQCB;                                          03S0253 00573000
*                                                               03S0253 00574000
         MVC   QCBCHN2(9,BUFFRPTR),MINORQCB                     03S0253 00575000
*   DO;                                                         03S0254 00576000
*     UNPK(QCBCHN3,THISMINH);                                   03S0255 00577000
         UNPK  QCBCHN3(7,BUFFRPTR),THISMINH(4)                  03S0255 00578000
*     TR(QCBCHN3,EBCTABL);                                      03S0256 00579000
         L     @14,EBCPTR                                       03S0256 00580000
         TR    QCBCHN3(7,BUFFRPTR),EBCTABL(@14)                 03S0256 00581000
*     QCBCHN3(LENGTH(QCBCHN3)) = ' ';                           03S0257 00582000
         MVI   QCBCHN3+6(BUFFRPTR),C' '                         03S0257 00583000
*   END;                                                        03S0258 00584000
*  CALL PRINTRTN;                 /* PRINT OUTPUT COMMENT            */ 00585000
         BAL   @14,PRINTRTN                                     03S0259 00586000
*END;                                                           03S0260 00587000
*    ELSE                         /* KEEP GOING                      */ 00588000
*      IF COPYSTAT=NONE THEN      /* FIRST BREAK - TRY TO RECOVER    */ 00589000
         B     @RC00247                                         02S0261 00590000
@RF00247 LTR   COPYSTAT,COPYSTAT                                02S0261 00591000
         BNZ   @RF00261                                         02S0261 00592000
*/*------------------------------------------------------------------*/ 00593000
*/* A READ FAILURE HAS OCCURRED IN THE MINOR QCB CHAIN. AN OUTPUT    */ 00594000
*/* COMMENT IS PRINTED AND, IF POSSIBLE, BACKWARD TRACING IS         */ 00595000
*/* INITIATED. IF BACKWARD TRACING IS NOT POSSIBLE THEN THE          */ 00596000
*/* MINOR QCB LOOP IS TERMINATED FOR THIS MAJOR QCB.                 */ 00597000
*/*------------------------------------------------------------------*/ 00598000
*DO;                                                            03S0262 00599000
*  CALL PRINTRTN;                                               03S0263 00600000
         BAL   @14,PRINTRTN                                     03S0263 00601000
*  MINBREAK = YES;                /* INDICATE BACK CHAINING IS NEEDED*/ 00602000
         OI    MINBREAK,B'00010000'                             03S0264 00603000
*  QCBCHN1 = ERRFND;              /* SET UP COMMON MESSAGE TEXT      */ 00604000
         MVC   QCBCHN1(13,BUFFRPTR),ERRFND                      03S0265 00605000
*  QCBCHN2 = MINORQCB;                                          03S0266 00606000
*                                                               03S0266 00607000
         MVC   QCBCHN2(9,BUFFRPTR),MINORQCB                     03S0266 00608000
*   DO;                                                         03S0267 00609000
*     UNPK(QCBCHN3,THISMINH);                                   03S0268 00610000
         UNPK  QCBCHN3(7,BUFFRPTR),THISMINH(4)                  03S0268 00611000
*     TR(QCBCHN3,EBCTABL);                                      03S0269 00612000
         L     @14,EBCPTR                                       03S0269 00613000
         TR    QCBCHN3(7,BUFFRPTR),EBCTABL(@14)                 03S0269 00614000
*     QCBCHN3(LENGTH(QCBCHN3)) = ' ';                           03S0270 00615000
         MVI   QCBCHN3+6(BUFFRPTR),C' '                         03S0270 00616000
*   END;                                                        03S0271 00617000
*  IF MAJLMIN=0 THEN              /* ADDRESS OF LAST MINOR QCB IS NOT   00618000
*                                    AVAILABLE                       */ 00619000
         L     @14,INMAJPTR                                     03S0272 00620000
         ICM   @08,15,MAJLMIN(@14)                              03S0272 00621000
         BNZ   @RF00272                                         03S0272 00622000
*    DO;                                                        03S0273 00623000
*      MINCHAIN = DONE;           /* ALL DONE                        */ 00624000
         OI    MINCHAIN,B'00100000'                             03S0274 00625000
*    END;                                                       03S0275 00626000
*  ELSE                           /* ADDRESS OF LAST MINOR QCB IS       00627000
*                                    AVAILABLE                       */ 00628000
*    DO;                                                        03S0276 00629000
         B     @RC00272                                         03S0276 00630000
@RF00272 DS    0H                                               03S0277 00631000
*      QCBCHND = DASH;                                          03S0277 00632000
         MVC   QCBCHND(2,BUFFRPTR),DASH                         03S0277 00633000
*      QCBCHN5 = FRSTBRK2;                                      03S0278 00634000
         MVC   QCBCHN5(24,BUFFRPTR),FRSTBRK2                    03S0278 00635000
*      MINPMIN = MAJLMIN;         /* SET UP TO READ FROM END         */ 00636000
         L     @14,INMAJPTR                                     03S0279 00637000
         MVC   MINPMIN(4,INMINPTR),MAJLMIN(@14)                 03S0279 00638000
*      STOPMIN = THISMIN;         /* SET LAST FOR BKWRDS    @OZ15488 */ 00639000
         MVC   STOPMIN(4),THISMIN                               03S0280 00640000
*    END;                                                       03S0281 00641000
*  CALL PRINTRTN;                 /* PRINT BROKEN CHAIN COMMENT      */ 00642000
@RC00272 BAL   @14,PRINTRTN                                     03S0282 00643000
*END;                                                           03S0283 00644000
*    IF COPYSTAT>NONE & MINCHAIN=NOTDONE THEN /*COPIED ENUF TO FORMAT*/ 00645000
@RF00261 DS    0H                                               02S0284 00646000
@RC00247 LTR   COPYSTAT,COPYSTAT                                02S0284 00647000
         BNP   @RF00284                                         02S0284 00648000
         TM    MINCHAIN,B'00100000'                             02S0284 00649000
         BNZ   @RF00284                                         02S0284 00650000
*/*------------------------------------------------------------------*/ 00651000
*/* FORMAT THE MINOR QCB. IF THE MINOR NAME IS UNPRINTABLE THEN      */ 00652000
*/* IT IS CONVERTED TO PRINTABLE HEX                                 */ 00653000
*/*------------------------------------------------------------------*/ 00654000
*DO;                                                            03S0285 00655000
*  CALL PRINTRTN;                 /* SKIP A LINE                     */ 00656000
         BAL   @14,PRINTRTN                                     03S0286 00657000
*  HDRMIN = MINOR;                /* MINOR LABLE                     */ 00658000
         MVC   HDRMIN(5,BUFFRPTR),MINOR                         03S0287 00659000
*  INCOMPLT = ON;                 /* TURNED OFF LATER IF WHOLE QCB      00660000
*                                    IS FORMATTED                    */ 00661000
*                                                               03S0288 00662000
         OI    INCOMPLT,B'00000010'                             03S0288 00663000
*  DO;                                                          03S0289 00664000
*    UNPK(ADDRMIN,THISMINH);                                    03S0290 00665000
         UNPK  ADDRMIN(7,BUFFRPTR),THISMINH(4)                  03S0290 00666000
*    TR(ADDRMIN,EBCTABL);                                       03S0291 00667000
         L     @14,EBCPTR                                       03S0291 00668000
         TR    ADDRMIN(7,BUFFRPTR),EBCTABL(@14)                 03S0291 00669000
*    ADDRMIN(LENGTH(ADDRMIN)) = ' ';                            03S0292 00670000
         MVI   ADDRMIN+6(BUFFRPTR),C' '                         03S0292 00671000
*  END;    /* CONVERT MINOR ADDRESS           */                03S0293 00672000
*  IF COPYSTAT=COPYLGT THEN       /* FORMAT MINOR QCB                */ 00673000
         CR    COPYSTAT,COPYLGT                                 03S0294 00674000
         BNE   @RF00294                                         03S0294 00675000
*    DO;                                                        03S0295 00676000
*      INCOMPLT = OFF;                                          03S0296 00677000
         NI    INCOMPLT,B'11111101'                             03S0296 00678000
*      IF MINSYS=ON & MINSYSS=OFF & MINSTEP=OFF THEN            03S0297 00679000
         TM    MINSYS(INMINPTR),B'10000000'                     03S0297 00680000
         BNO   @RF00297                                         03S0297 00681000
         TM    MINSYSS(INMINPTR),B'01100000'                    03S0297 00682000
         BNZ   @RF00297                                         03S0297 00683000
*        SCOPE = SYSTEM;                                        03S0298 00684000
         MVI   SCOPE+6(BUFFRPTR),C' '                           03S0298 00685000
         MVC   SCOPE(6,BUFFRPTR),SYSTEM                         03S0298 00686000
*      ELSE                                                     03S0299 00687000
*        IF MINSYSS=ON & MINSYS=OFF & MINSTEP=OFF THEN          03S0299 00688000
         B     @RC00297                                         03S0299 00689000
@RF00297 TM    MINSYSS(INMINPTR),B'01000000'                    03S0299 00690000
         BNO   @RF00299                                         03S0299 00691000
         TM    MINSYS(INMINPTR),B'10100000'                     03S0299 00692000
         BNZ   @RF00299                                         03S0299 00693000
*          SCOPE = SYSTEMS;                                     03S0300 00694000
         MVC   SCOPE(7,BUFFRPTR),SYSTEMS                        03S0300 00695000
*        ELSE                                                   03S0301 00696000
*          IF MINSTEP=ON & MINSYS=OFF & MINSYSS=OFF THEN        03S0301 00697000
         B     @RC00299                                         03S0301 00698000
@RF00299 TM    MINSTEP(INMINPTR),B'00100000'                    03S0301 00699000
         BNO   @RF00301                                         03S0301 00700000
         TM    MINSYS(INMINPTR),B'11000000'                     03S0301 00701000
         BNZ   @RF00301                                         03S0301 00702000
*            SCOPE = STEP;                                      03S0302 00703000
         MVI   SCOPE+4(BUFFRPTR),C' '                           03S0302 00704000
         MVC   SCOPE+5(2,BUFFRPTR),SCOPE+4(BUFFRPTR)            03S0302 00705000
         MVC   SCOPE(4,BUFFRPTR),STEP                           03S0302 00706000
*          ELSE                                                 03S0303 00707000
*            SCOPE = ERROR;                                     03S0303 00708000
         B     @RC00301                                         03S0303 00709000
@RF00301 MVI   SCOPE+5(BUFFRPTR),C' '                           03S0303 00710000
         MVI   SCOPE+6(BUFFRPTR),C' '                           03S0303 00711000
         MVC   SCOPE(5,BUFFRPTR),ERROR                          03S0303 00712000
*      ASIDLBL = ASID;                                          03S0304 00713000
*                                                               03S0304 00714000
@RC00301 DS    0H                                               03S0304 00715000
@RC00299 DS    0H                                               03S0304 00716000
@RC00297 MVC   ASIDLBL(4,BUFFRPTR),ASID                         03S0304 00717000
*      DO;                                                      03S0305 00718000
*        UNPK(ASIDFLD,MASID);                                   03S0306 00719000
         UNPK  ASIDFLD(5,BUFFRPTR),MASID(3,INMINPTR)            03S0306 00720000
*        TR(ASIDFLD,EBCTABL);                                   03S0307 00721000
         L     @14,EBCPTR                                       03S0307 00722000
         TR    ASIDFLD(5,BUFFRPTR),EBCTABL(@14)                 03S0307 00723000
*        ASIDFLD(LENGTH(ASIDFLD)) = ' ';                        03S0308 00724000
         MVI   ASIDFLD+4(BUFFRPTR),C' '                         03S0308 00725000
*      END;                                                     03S0309 00726000
*/*------------------------------------------------------------------*/ 00727000
*/* COPY THE MINOR NAME                                              */ 00728000
*/*------------------------------------------------------------------*/ 00729000
*DO;                                                            04S0310 00730000
*  READAD = ADDR(THISMIN->MINNAME);                             04S0311 00731000
         L     @14,THISMIN                                      04S0311 00732000
         LA    @14,MINNAME(,@14)                                04S0311 00733000
         ST    @14,READAD                                       04S0311 00734000
*  TOPTR = ADDR(MINNAME);                                       04S0312 00735000
         LA    TOPTR,MINNAME(,INMINPTR)                         04S0312 00736000
*  COPYLGT = MINNAMEL;            /* INITIALIZE LOOP CONTROL         */ 00737000
         SLR   COPYLGT,COPYLGT                                  04S0313 00738000
         IC    COPYLGT,MINNAMEL(,INMINPTR)                      04S0313 00739000
*  CALL COPY;                                                   04S0314 00740000
         BAL   @14,COPY                                         04S0314 00741000
*END;                                                           04S0315 00742000
*      IF MINNAMEL>0 & COPYSTAT=COPYLGT THEN /* THERE IS NAME        */ 00743000
         CLI   MINNAMEL(INMINPTR),0                             03S0316 00744000
         BNH   @RF00316                                         03S0316 00745000
         CR    COPYSTAT,COPYLGT                                 03S0316 00746000
         BNE   @RF00316                                         03S0316 00747000
*/*------------------------------------------------------------------*/ 00748000
*/* FORMAT THE VARIABLE LENGTH MINOR NAME                            */ 00749000
*/*------------------------------------------------------------------*/ 00750000
*DO;                                                            04S0317 00751000
*  NAMMINLB = NAME;                                             04S0318 00752000
         MVC   NAMMINLB(4,BUFFRPTR),NAME                        04S0318 00753000
*  RESPECIFY (R2,R5,R6) RESTRICTED;                             04S0319 00754000
*  R2 = 0;                        /* SET UP FOR TRT                  */ 00755000
         SLR   R2,R2                                            04S0320 00756000
*  R5 = MINNAMEL-1;               /* LENGTH FOR EX INSTUCTION        */ 00757000
         SLR   R5,R5                                            04S0321 00758000
         IC    R5,MINNAMEL(,INMINPTR)                           04S0321 00759000
         BCTR  R5,0                                             04S0321 00760000
*  R6 = ADDR(MINNAME);            /* FIELD THAT WILL BE TESTED       */ 00761000
         LA    R6,MINNAME(,INMINPTR)                            04S0322 00762000
*  GEN(EX   R5,MINNMTRT);                                       04S0323 00763000
         EX   R5,MINNMTRT                                               00764000
*  IF R2^=0 THEN                  /* NAME IS NOT PRINTABLE           */ 00765000
         LTR   R2,R2                                            04S0324 00766000
         BZ    @RF00324                                         04S0324 00767000
*   DO;                                                         04S0325 00768000
*    RESPECIFY (R2,R5,R6) UNRESTRICTED;                         04S0326 00769000
*    DO Y=1 TO MINNAMEL BY 20;    /* CONVERT NAME TO PRINTABLE HEX   */ 00770000
         LA    Y,1                                              04S0327 00771000
         B     @DE00327                                         04S0327 00772000
@DL00327 DS    0H                                               04S0328 00773000
*      IF MINNAMEL-Y<20 THEN      /* CONVERT REMAINING PORTION       */ 00774000
         SLR   @14,@14                                          04S0328 00775000
         IC    @14,MINNAMEL(,INMINPTR)                          04S0328 00776000
         SLR   @14,Y                                            04S0328 00777000
         CH    @14,@CH00856                                     04S0328 00778000
         BNL   @RF00328                                         04S0328 00779000
*        LINEEND = MINNAMEL-Y+1;                                04S0329 00780000
         AH    @14,@CH00039                                     04S0329 00781000
         LR    LINEEND,@14                                      04S0329 00782000
*      ELSE                       /* CONVERT NEXT 20 BYTES           */ 00783000
*        LINEEND = 20;                                          04S0330 00784000
         B     @RC00328                                         04S0330 00785000
@RF00328 LA    LINEEND,20                                       04S0330 00786000
*      TOPTR = ADDR(NAMEMIN);                                   04S0331 00787000
@RC00328 LA    TOPTR,NAMEMIN(,BUFFRPTR)                         04S0331 00788000
*      FROMPTR = ADDR(MINORNM(Y));                              04S0332 00789000
         LA    FROMPTR,MINORNM-1(Y,INMINPTR)                    04S0332 00790000
*      DO Z=1 TO LINEEND;         /* TRANLATE ONE BYTE AT A TIME     */ 00791000
*                                                               04S0333 00792000
         LA    @14,1                                            04S0333 00793000
         B     @DE00333                                         04S0333 00794000
@DL00333 DS    0H                                               04S0334 00795000
*        DO;                                                    04S0334 00796000
*          UNPK(TO,FROM);                                       04S0335 00797000
         UNPK  TO(3,TOPTR),FROM(2,FROMPTR)                      04S0335 00798000
*          TR(TO,EBCTABL);                                      04S0336 00799000
         L     @08,EBCPTR                                       04S0336 00800000
         TR    TO(3,TOPTR),EBCTABL(@08)                         04S0336 00801000
*          TO(LENGTH(TO)) = ' ';                                04S0337 00802000
         MVI   TO+2(TOPTR),C' '                                 04S0337 00803000
*        END;                                                   04S0338 00804000
*        TOPTR = TOPTR+2;                                       04S0339 00805000
         AH    TOPTR,@CH00095                                   04S0339 00806000
*        FROMPTR = FROMPTR+1;                                   04S0340 00807000
         AH    FROMPTR,@CH00039                                 04S0340 00808000
*      END;                                                     04S0341 00809000
         AH    @14,@CH00039                                     04S0341 00810000
@DE00333 ST    @14,Z                                            04S0341 00811000
         CR    @14,LINEEND                                      04S0341 00812000
         BNH   @DL00333                                         04S0341 00813000
*      MISTAR1 = STAR;            /* ALSO PRINT NAME AS IS           */ 00814000
         MVI   MISTAR1(BUFFRPTR),C'*'                           04S0342 00815000
*      EBCFLD2(1:LINEEND) = MINORNM(Y:(Y+LINEEND-1));           04S0343 00816000
         LR    @14,LINEEND                                      04S0343 00817000
         BCTR  @14,0                                            04S0343 00818000
         LR    @08,INMINPTR                                     04S0343 00819000
         ALR   @08,Y                                            04S0343 00820000
         EX    @14,@SM01179                                     04S0343 00821000
*      MISTAR2 = STAR;                                          04S0344 00822000
         MVI   MISTAR2(BUFFRPTR),C'*'                           04S0344 00823000
*      TR (EBCFLD2,PRNTTBL);      /* MASK OUT UNPRINTABLES           */ 00824000
         TR    EBCFLD2(20,BUFFRPTR),PRNTTBL                     04S0345 00825000
*      CALL PRINTRTN;             /* PRINT MINOR QCB LINE            */ 00826000
         BAL   @14,PRINTRTN                                     04S0346 00827000
*    END;                                                       04S0347 00828000
         AH    Y,@CH00856                                       04S0347 00829000
@DE00327 SLR   @14,@14                                          04S0347 00830000
         IC    @14,MINNAMEL(,INMINPTR)                          04S0347 00831000
         CR    Y,@14                                            04S0347 00832000
         BNH   @DL00327                                         04S0347 00833000
*   END;                                                        04S0348 00834000
*  ELSE                           /* NAME IS PRINTABLE               */ 00835000
*    DO Y=1 TO MINNAMEL BY 40;                                  04S0349 00836000
         B     @RC00324                                         04S0349 00837000
@RF00324 LA    Y,1                                              04S0349 00838000
         B     @DE00349                                         04S0349 00839000
@DL00349 DS    0H                                               04S0350 00840000
*      IF MINNAMEL-Y<40 THEN      /* COPY OVER REST OF NAME          */ 00841000
         SLR   @14,@14                                          04S0350 00842000
         IC    @14,MINNAMEL(,INMINPTR)                          04S0350 00843000
         SLR   @14,Y                                            04S0350 00844000
         CH    @14,@CH01067                                     04S0350 00845000
         BNL   @RF00350                                         04S0350 00846000
*        LINEEND = MINNAMEL-Y+1;                                04S0351 00847000
         AH    @14,@CH00039                                     04S0351 00848000
         LR    LINEEND,@14                                      04S0351 00849000
*      ELSE                       /* COPY OVER NEXT 40 BYTES         */ 00850000
*        LINEEND = 40;                                          04S0352 00851000
         B     @RC00350                                         04S0352 00852000
@RF00350 LA    LINEEND,40                                       04S0352 00853000
*      NAMEMIN(1:LINEEND) = MINORNM(Y:(Y+LINEEND-1));           04S0353 00854000
@RC00350 LR    @14,LINEEND                                      04S0353 00855000
         BCTR  @14,0                                            04S0353 00856000
         LR    @08,INMINPTR                                     04S0353 00857000
         ALR   @08,Y                                            04S0353 00858000
         EX    @14,@SM01181                                     04S0353 00859000
*      CALL PRINTRTN;             /* PRINT MINOR QCB LINE            */ 00860000
         BAL   @14,PRINTRTN                                     04S0354 00861000
*    END;                                                       04S0355 00862000
         AH    Y,@CH01067                                       04S0355 00863000
@DE00349 SLR   @14,@14                                          04S0355 00864000
         IC    @14,MINNAMEL(,INMINPTR)                          04S0355 00865000
         CR    Y,@14                                            04S0355 00866000
         BNH   @DL00349                                         04S0355 00867000
*END;                                                           04S0356 00868000
*      ELSE                       /* NAME LENGTH INVALID             */ 00869000
*        IF MINNAMEL=0 THEN       /* INDICATE AN ERROR               */ 00870000
         B     @RC00316                                         03S0357 00871000
@RF00316 CLI   MINNAMEL(INMINPTR),0                             03S0357 00872000
         BNE   @RF00357                                         03S0357 00873000
*          DO;                                                  03S0358 00874000
*            MESSAGE(50:74) = ZEROLGTM;                         03S0359 00875000
         MVC   MESSAGE+49(25,BUFFRPTR),ZEROLGTM                 03S0359 00876000
*            CALL PRINTRTN;                                     03S0360 00877000
         BAL   @14,PRINTRTN                                     03S0360 00878000
*          END;                                                 03S0361 00879000
*        ELSE                     /* ENTIRE NAME WAS NOT READ        */ 00880000
*          INCOMPLT = ON;                                       03S0362 00881000
         B     @RC00357                                         03S0362 00882000
@RF00357 OI    INCOMPLT,B'00000010'                             03S0362 00883000
*    END;                                                       03S0363 00884000
*  ELSE                           /* JUST PRINT LABEL AND ADDRESS    */ 00885000
*    CALL PRINTRTN;                                             03S0364 00886000
         B     @RC00294                                         03S0364 00887000
@RF00294 BAL   @14,PRINTRTN                                     03S0364 00888000
*  IF INCOMPLT=ON THEN            /* ONLY A PORTION WAS FORMATTED    */ 00889000
@RC00294 TM    INCOMPLT,B'00000010'                             03S0365 00890000
         BNO   @RF00365                                         03S0365 00891000
*    DO;                                                        03S0366 00892000
*      STARTMSG = 8;                                            03S0367 00893000
         LA    STARTMSG,8                                       03S0367 00894000
*      CALL PARTPRNT;             /* PRINT A COMMENT                 */ 00895000
         BAL   @14,PARTPRNT                                     03S0368 00896000
*    END;                                                       03S0369 00897000
*END;                                                           03S0370 00898000
@RF00365 DS    0H                                               03S0371 00899000
*    IF MINFQEL^=0 THEN           /* GET QELS                        */ 00900000
@RF00284 ICM   @14,15,MINFQEL(INMINPTR)                         02S0371 00901000
         BZ    @RF00371                                         02S0371 00902000
*      CALL QELFAMLY;                                           02S0372 00903000
         BAL   @14,QELFAMLY                                     02S0372 00904000
*   IF THISMIN = STOPMIN THEN      /* STOP NOW IF AT END    @OZ15488 */ 00905000
@RF00371 CLC   THISMIN(4),STOPMIN                               02S0373 00906000
         BNE   @RF00373                                         02S0373 00907000
*      MINCHAIN = DONE;            /* END LOOP              @OZ15488 */ 00908000
         OI    MINCHAIN,B'00100000'                             02S0374 00909000
*   ELSE                                                /*  @OZ15488 */ 00910000
*   DO;                                                 /*  @OZ15488 */ 00911000
         B     @RC00373                                         02S0375 00912000
@RF00373 DS    0H                                               02S0376 00913000
*    IF MINBREAK=YES THEN                                       02S0376 00914000
         TM    MINBREAK,B'00010000'                             02S0376 00915000
         BNO   @RF00376                                         02S0376 00916000
*      IF MINPMIN^=0 THEN         /* BACKWARD POINTER OK             */ 00917000
         L     @14,MINPMIN(,INMINPTR)                           02S0377 00918000
         LTR   @14,@14                                          02S0377 00919000
         BZ    @RF00377                                         02S0377 00920000
*        READAD = MINPMIN;        /* USE BACKWARD POINTER            */ 00921000
         ST    @14,READAD                                       02S0378 00922000
*      ELSE                                                     02S0379 00923000
*        MINCHAIN = DONE;         /* TERMINATE                       */ 00924000
         B     @RC00377                                         02S0379 00925000
@RF00377 OI    MINCHAIN,B'00100000'                             02S0379 00926000
*    ELSE                         /* STILL GOING FORWARD             */ 00927000
*      IF MINNMIN^=0 THEN         /* NOT AT END OF CHAIN             */ 00928000
         B     @RC00376                                         02S0380 00929000
@RF00376 L     @14,MINNMIN(,INMINPTR)                           02S0380 00930000
         LTR   @14,@14                                          02S0380 00931000
         BZ    @RF00380                                         02S0380 00932000
*        READAD = MINNMIN;        /* USE FORWARD POINTER             */ 00933000
         ST    @14,READAD                                       02S0381 00934000
*      ELSE                       /* END OF CHAIN                    */ 00935000
*        MINCHAIN = DONE;         /* TERMINATE                       */ 00936000
         B     @RC00380                                         02S0382 00937000
@RF00380 OI    MINCHAIN,B'00100000'                             02S0382 00938000
*   END;                                                /*  @OZ15488 */ 00939000
@RC00380 DS    0H                                               02S0383 00940000
@RC00376 DS    0H                                               02S0384 00941000
*  END;                                                         02S0384 00942000
@RC00373 LA    @14,1                                            02S0384 00943000
         AL    @14,MINCOUNT                                     02S0384 00944000
@DE00241 ST    @14,MINCOUNT                                     02S0384 00945000
         C     @14,MINMAX                                       02S0384 00946000
         BNH   @DL00241                                         02S0384 00947000
@DC00241 DS    0H                                               02S0385 00948000
*  IF MINCOUNT>MINMAX & MINCHAIN=NOTDONE THEN /* NUMBER OF MINORS       00949000
*                                    EXCEEDED ASSUMED MAXIMUM        */ 00950000
         L     @14,MINCOUNT                                     02S0385 00951000
         C     @14,MINMAX                                       02S0385 00952000
         BNH   @RF00385                                         02S0385 00953000
         TM    MINCHAIN,B'00100000'                             02S0385 00954000
         BNZ   @RF00385                                         02S0385 00955000
*/*------------------------------------------------------------------*/ 00956000
*/* INDICATE THAT A LOOP CONDITION WAS ASSUMED IN THE MINOR          */ 00957000
*/* QCB CHAIN                                                        */ 00958000
*/*------------------------------------------------------------------*/ 00959000
*DO;                                                            03S0386 00960000
*  CALL PRINTRTN;                                               03S0387 00961000
         BAL   @14,PRINTRTN                                     03S0387 00962000
*  INVALID = INVALMSG;                                          03S0388 00963000
         MVC   INVALID(7,BUFFRPTR),INVALMSG                     03S0388 00964000
*  INVALQCB = MINORQCB;                                         03S0389 00965000
         MVC   INVALQCB(9,BUFFRPTR),MINORQCB                    03S0389 00966000
*  ASSUME = ASSUMED;                                            03S0390 00967000
         MVC   ASSUME(13,BUFFRPTR),ASSUMED                      03S0390 00968000
*  CALL PRINTRTN;                                               03S0391 00969000
         BAL   @14,PRINTRTN                                     03S0391 00970000
*END;                                                           03S0392 00971000
*END MINFAMLY;                                                  02S0393 00972000
@EL00004 DS    0H                                               02S0393 00973000
@EF00004 DS    0H                                               02S0393 00974000
@ER00004 LM    @14,@08,@SA00004                                 02S0393 00975000
         LM    @10,@12,@SA00004+44                              02S0393 00976000
         BR    @14                                              02S0393 00977000
*/*------------------------------------------------------------------*/ 00978000
*/* OBTAIN ALL THE QELS THAT ARE CHAINED TO THE CURRENT              */ 00979000
*/*  MINOR QCB.  IF THE CHAIN IS BROKEN THEN AN ATTEMPT IS MADE      */ 00980000
*/*  TO START AT THE END AND GO BACK THROUGH THE CHAIN               */ 00981000
*/*------------------------------------------------------------------*/ 00982000
*QELFAMLY: PROCEDURE;                                           02S0394 00983000
QELFAMLY STM   @14,@08,@SA00005                                 02S0394 00984000
         STM   @10,@12,@SA00005+44                              02S0394 00985000
*  READAD = MINFQEL;                                            02S0395 00986000
         MVC   READAD(4),MINFQEL(INMINPTR)                      02S0395 00987000
*  STOPQEL = MINLQEL;              /* SET LAST IN CHAIN     @OZ15488 */ 00988000
         MVC   STOPQEL(4),MINLQEL(INMINPTR)                     02S0396 00989000
*  QELBREAK = NO;                 /* INIT QCB CHAIN STATUS           */ 00990000
*  QELCHAIN = NOTDONE;            /* INIT LOOP CONTROL               */ 00991000
         NI    QELBREAK,B'11110011'                             02S0398 00992000
*  DO QELCOUNT=1 TO QELMAX WHILE QELCHAIN=NOTDONE;              02S0399 00993000
         LA    QELCOUNT,1                                       02S0399 00994000
         B     @DE00399                                         02S0399 00995000
@DL00399 TM    QELCHAIN,B'00001000'                             02S0399 00996000
         BNZ   @DC00399                                         02S0399 00997000
*    THISQEL = READAD;                                          02S0400 00998000
         MVC   THISQEL(4),READAD                                02S0400 00999000
*    TOPTR = ADDR(INQEL);         /* COPY MAJOR QCB HERE             */ 01000000
         LA    TOPTR,INQEL                                      02S0401 01001000
*    COPYLGT = QPRIMLGT;                                        02S0402 01002000
         LA    COPYLGT,16                                       02S0402 01003000
*    INQEL = INQEL&&INQEL;        /* ZERO OUT ALL FIELDS             */ 01004000
         XC    INQEL(28),INQEL                                  02S0403 01005000
*    CALL COPY;                   /* COPY NEXT QEL                   */ 01006000
         BAL   @14,COPY                                         02S0404 01007000
*    IF COPYSTAT<BCKPTR & QELBREAK=YES THEN /* SECOND BREAK,ALL DONE */ 01008000
         CH    COPYSTAT,@CH00082                                02S0405 01009000
         BNL   @RF00405                                         02S0405 01010000
         TM    QELBREAK,B'00000100'                             02S0405 01011000
         BNO   @RF00405                                         02S0405 01012000
*/*------------------------------------------------------------------*/ 01013000
*/* THIS IS THE SECOND BREAK IN THE QEL CHAIN. AN OUTPUT             */ 01014000
*/* COMMENT IS PRINTED AND THE QEL LOOP FOR THIS MINOR QCB IS        */ 01015000
*/* TERMINATED.                                                      */ 01016000
*/*------------------------------------------------------------------*/ 01017000
*DO;                                                            03S0406 01018000
*  CALL PRINTRTN;                 /* PRINT OUTPUT COMMENT            */ 01019000
         BAL   @14,PRINTRTN                                     03S0407 01020000
*  QELBREAK = NO;                                               03S0408 01021000
*  QELCHAIN = DONE;               /* STOP QEL FORMATTING LOOP        */ 01022000
         OI    QELCHAIN,B'00001000'                             03S0409 01023000
         NI    QELBREAK,B'11111011'                             03S0409 01024000
*  QELCHN1 = ERRFND;              /* SET UP ERROR MESSAGE TEXT       */ 01025000
         MVC   QELCHN1(13,BUFFRPTR),ERRFND                      03S0410 01026000
*  QELCHN2 = QELMSG;                                            03S0411 01027000
*                                                               03S0411 01028000
         MVC   QELCHN2(3,BUFFRPTR),QELMSG                       03S0411 01029000
*   DO;                                                         03S0412 01030000
*     UNPK(QELCHN3,THISQELH);                                   03S0413 01031000
         UNPK  QELCHN3(7,BUFFRPTR),THISQELH(4)                  03S0413 01032000
*     TR(QELCHN3,EBCTABL);                                      03S0414 01033000
         L     @14,EBCPTR                                       03S0414 01034000
         TR    QELCHN3(7,BUFFRPTR),EBCTABL(@14)                 03S0414 01035000
*     QELCHN3(LENGTH(QELCHN3)) = ' ';                           03S0415 01036000
         MVI   QELCHN3+6(BUFFRPTR),C' '                         03S0415 01037000
*   END;                                                        03S0416 01038000
*  CALL PRINTRTN;                 /* PRINT OUTPUT COMMENT            */ 01039000
         BAL   @14,PRINTRTN                                     03S0417 01040000
*END;                                                           03S0418 01041000
*    ELSE                                                       02S0419 01042000
*      IF COPYSTAT=NONE THEN      /* FIRST BREAK - TRY TO RECOVER    */ 01043000
         B     @RC00405                                         02S0419 01044000
@RF00405 LTR   COPYSTAT,COPYSTAT                                02S0419 01045000
         BNZ   @RF00419                                         02S0419 01046000
*/*------------------------------------------------------------------*/ 01047000
*/* A READ FAILURE HAS OCCURRED IN THE QEL CHAIN. AN OUTPUT          */ 01048000
*/* COMMENT IS PRINTED AND, IF POSSIBLE, BACKWARD TRACING IS         */ 01049000
*/* INITIATED. IF BACKWARD TRACING IS NOT POSSIBLE THEN THE QEL      */ 01050000
*/* LOOP FOR THIS MINOR QCB IS TERMINATED                            */ 01051000
*/*------------------------------------------------------------------*/ 01052000
*DO;                                                            03S0420 01053000
*  CALL PRINTRTN;                                               03S0421 01054000
         BAL   @14,PRINTRTN                                     03S0421 01055000
*  QELBREAK = YES;                /* INDICATE BACK CHAINING IS NEEDED*/ 01056000
         OI    QELBREAK,B'00000100'                             03S0422 01057000
*  QELCHN1 = ERRFND;              /* SET UP COMMON MESSAGE TEXT      */ 01058000
         MVC   QELCHN1(13,BUFFRPTR),ERRFND                      03S0423 01059000
*  QELCHN2 = QELMSG;                                            03S0424 01060000
*                                                               03S0424 01061000
         MVC   QELCHN2(3,BUFFRPTR),QELMSG                       03S0424 01062000
*   DO;                                                         03S0425 01063000
*     UNPK(QELCHN3,THISQELH);                                   03S0426 01064000
         UNPK  QELCHN3(7,BUFFRPTR),THISQELH(4)                  03S0426 01065000
*     TR(QELCHN3,EBCTABL);                                      03S0427 01066000
         L     @14,EBCPTR                                       03S0427 01067000
         TR    QELCHN3(7,BUFFRPTR),EBCTABL(@14)                 03S0427 01068000
*     QELCHN3(LENGTH(QELCHN3)) = ' ';                           03S0428 01069000
         MVI   QELCHN3+6(BUFFRPTR),C' '                         03S0428 01070000
*   END;                                                        03S0429 01071000
*  IF MINLQEL=0 THEN              /* ADDRESS OF LAST QEL UNAVAILABLE */ 01072000
         ICM   @14,15,MINLQEL(INMINPTR)                         03S0430 01073000
         BNZ   @RF00430                                         03S0430 01074000
*    DO;                                                        03S0431 01075000
*      QELCHAIN = DONE;           /* ALL DONE                        */ 01076000
         OI    QELCHAIN,B'00001000'                             03S0432 01077000
*    END;                                                       03S0433 01078000
*  ELSE                           /* ADDRESS OF LAST QEL AVAILABLE   */ 01079000
*    DO;                                                        03S0434 01080000
         B     @RC00430                                         03S0434 01081000
@RF00430 DS    0H                                               03S0435 01082000
*      QELCHND = DASH;                                          03S0435 01083000
         MVC   QELCHND(2,BUFFRPTR),DASH                         03S0435 01084000
*      QELCHN5 = FRSTBRK2;                                      03S0436 01085000
         MVC   QELCHN5(24,BUFFRPTR),FRSTBRK2                    03S0436 01086000
*      QELPQEL = MINLQEL;         /* SET UP TO READ FROM END         */ 01087000
         L     @14,INQELPTR                                     03S0437 01088000
         MVC   QELPQEL(4,@14),MINLQEL(INMINPTR)                 03S0437 01089000
*      STOPQEL = THISQEL;         /* SET LAST FOR BKWRDS    @OZ15488 */ 01090000
         MVC   STOPQEL(4),THISQEL                               03S0438 01091000
*    END;                                                       03S0439 01092000
*  CALL PRINTRTN;                 /* PRINT BROKEN CHAIN COMMENT      */ 01093000
@RC00430 BAL   @14,PRINTRTN                                     03S0440 01094000
*END;                                                           03S0441 01095000
*    IF COPYSTAT>NONE & QELCHAIN=NOTDONE THEN /*COPIED ENUF TO FORMAT*/ 01096000
@RF00419 DS    0H                                               02S0442 01097000
@RC00405 LTR   COPYSTAT,COPYSTAT                                02S0442 01098000
         BNP   @RF00442                                         02S0442 01099000
         TM    QELCHAIN,B'00001000'                             02S0442 01100000
         BNZ   @RF00442                                         02S0442 01101000
*/*------------------------------------------------------------------*/ 01102000
*/* FORMAT THE QEL. FLAGS ARE ANALYZED AND APPROPRIATE DIAGNOSTICS   */ 01103000
*/* ARE ISSUED                                                       */ 01104000
*/*------------------------------------------------------------------*/ 01105000
*DO;                                                            03S0443 01106000
*  INCOMPLT = OFF;                /* INIT TO FULL QEL FORMAT         */ 01107000
         NI    INCOMPLT,B'11111101'                             03S0444 01108000
*  HDRQEL = QELMSG;               /* QEL LABEL                       */ 01109000
*                                                               03S0445 01110000
         MVC   HDRQEL(3,BUFFRPTR),QELMSG                        03S0445 01111000
*   DO;                                                         03S0446 01112000
*     UNPK(ADDRQEL,THISQELH);                                   03S0447 01113000
         UNPK  ADDRQEL(7,BUFFRPTR),THISQELH(4)                  03S0447 01114000
*     TR(ADDRQEL,EBCTABL);                                      03S0448 01115000
         L     @14,EBCPTR                                       03S0448 01116000
         TR    ADDRQEL(7,BUFFRPTR),EBCTABL(@14)                 03S0448 01117000
*     ADDRQEL(LENGTH(ADDRQEL)) = ' ';                           03S0449 01118000
         MVI   ADDRQEL+6(BUFFRPTR),C' '                         03S0449 01119000
*   END;                                                        03S0450 01120000
*  IF COPYSTAT=COPYLGT THEN                                     03S0451 01121000
         CR    COPYSTAT,COPYLGT                                 03S0451 01122000
         BNE   @RF00451                                         03S0451 01123000
*    DO;                                                        03S0452 01124000
*      QELASIDL = ASID;           /* ASID LABEL                      */ 01125000
*                                                               03S0453 01126000
         MVC   QELASIDL(4,BUFFRPTR),ASID                        03S0453 01127000
*      DO;                                                      03S0454 01128000
*        UNPK(QASIDFLD,QASID);                                  03S0455 01129000
         L     @08,INQELPTR                                     03S0455 01130000
         UNPK  QASIDFLD(5,BUFFRPTR),QASID(3,@08)                03S0455 01131000
*        TR(QASIDFLD,EBCTABL);                                  03S0456 01132000
         TR    QASIDFLD(5,BUFFRPTR),EBCTABL(@14)                03S0456 01133000
*        QASIDFLD(LENGTH(QASIDFLD)) = ' ';                      03S0457 01134000
         MVI   QASIDFLD+4(BUFFRPTR),C' '                        03S0457 01135000
*      END;                                                     03S0458 01136000
*      IF QELXLIST=ON THEN                                      03S0459 01137000
         TM    QELXLIST(@08),B'10000000'                        03S0459 01138000
         BNO   @RF00459                                         03S0459 01139000
*        LISTLBL = LIST;          /* FIELD CONTAINS ADDR OF LIST QEL */ 01140000
         MVC   LISTLBL(4,BUFFRPTR),LIST                         03S0460 01141000
*      ELSE                                                     03S0461 01142000
*        TCBLBL = TCB;            /* FIELD CONTAINS ADDR OF TCB      */ 01143000
*                                                               03S0461 01144000
         B     @RC00459                                         03S0461 01145000
@RF00459 MVC   TCBLBL(3,BUFFRPTR),TCB                           03S0461 01146000
*      DO;                                                      03S0462 01147000
@RC00459 DS    0H                                               03S0463 01148000
*        UNPK(LISTTCBA,QTCB);                                   03S0463 01149000
         L     @14,INQELPTR                                     03S0463 01150000
         UNPK  LISTTCBA(7,BUFFRPTR),QTCB(5,@14)                 03S0463 01151000
*        TR(LISTTCBA,EBCTABL);                                  03S0464 01152000
         L     @08,EBCPTR                                       03S0464 01153000
         TR    LISTTCBA(7,BUFFRPTR),EBCTABL(@08)                03S0464 01154000
*        LISTTCBA(LENGTH(LISTTCBA)) = ' ';                      03S0465 01155000
         MVI   LISTTCBA+6(BUFFRPTR),C' '                        03S0465 01156000
*      END;                                                     03S0466 01157000
*      IF QELMC = ON THEN         /* STEP MUST COMPLETE WAS SPECIFIED*/ 01158000
         TM    QELMC(@14),B'01000000'                           03S0467 01159000
         BNO   @RF00467                                         03S0467 01160000
*        MUSTCOMP = MUSTMSG;                                    03S0468 01161000
         MVC   MUSTCOMP(18,BUFFRPTR),MUSTMSG                    03S0468 01162000
*      IF QELLIST=OFF THEN        /* THIS IS A SHORT QEL             */ 01163000
@RF00467 L     @14,INQELPTR                                     03S0469 01164000
         TM    QELLIST(@14),B'00100000'                         03S0469 01165000
         BNZ   @RF00469                                         03S0469 01166000
*        IF QELRESV=ON THEN       /* THIS IS A RESERVE REQUEST       */ 01167000
         TM    QELRESV(@14),B'00010000'                         03S0470 01168000
         BNO   @RF00470                                         03S0470 01169000
*          DO;                                                  03S0471 01170000
*            COPYLGT = WORDLGT;                                 03S0472 01171000
         LA    COPYLGT,4                                        03S0472 01172000
*            CALL COPY;           /* GET ONE MORE WORD -- ADDRESSES ARE 01173000
*                                    ALREADY SET UP                  */ 01174000
         BAL   @14,COPY                                         03S0473 01175000
*            IF COPYSTAT=COPYLGT THEN /* UCB ADDR WAS READ           */ 01176000
         CR    COPYSTAT,COPYLGT                                 03S0474 01177000
         BNE   @RF00474                                         03S0474 01178000
*              DO;                                              03S0475 01179000
*                UCBLBL = UCB;    /* UCB ADDR FOR SHARED DEV         */ 01180000
*                                                               03S0476 01181000
         MVC   UCBLBL(3,BUFFRPTR),UCB                           03S0476 01182000
*                DO;                                            03S0477 01183000
*                  UNPK(UCBADDR,QUCB1);                         03S0478 01184000
         L     @14,INQELPTR                                     03S0478 01185000
         UNPK  UCBADDR(7,BUFFRPTR),QUCB1(5,@14)                 03S0478 01186000
*                  TR(UCBADDR,EBCTABL);                         03S0479 01187000
         L     @14,EBCPTR                                       03S0479 01188000
         TR    UCBADDR(7,BUFFRPTR),EBCTABL(@14)                 03S0479 01189000
*                  UCBADDR(LENGTH(UCBADDR)) = ' ';              03S0480 01190000
         MVI   UCBADDR+6(BUFFRPTR),C' '                         03S0480 01191000
*                END;                                           03S0481 01192000
*              END;                                             03S0482 01193000
*            ELSE                 /* NO UCB ADDRESS                  */ 01194000
*              INCOMPLT = ON;                                   03S0483 01195000
         B     @RC00474                                         03S0483 01196000
@RF00474 OI    INCOMPLT,B'00000010'                             03S0483 01197000
*          END;                                                 03S0484 01198000
*        ELSE ;                                                 03S0485 01199000
@RF00470 DS    0H                                               03S0486 01200000
*      ELSE                       /* LONG QEL                        */ 01201000
*          DO;                                                  03S0486 01202000
         B     @RC00469                                         03S0486 01203000
@RF00469 DS    0H                                               03S0487 01204000
*            IF QELRESV=ON THEN                                 03S0487 01205000
         L     @14,INQELPTR                                     03S0487 01206000
         TM    QELRESV(@14),B'00010000'                         03S0487 01207000
         BNO   @RF00487                                         03S0487 01208000
*              DO;                                              03S0488 01209000
*                COPYLGT = 3*WORDLGT;                           03S0489 01210000
         LA    COPYLGT,12                                       03S0489 01211000
*                CALL COPY;       /* GET THREE MORE WORDS            */ 01212000
         BAL   @14,COPY                                         03S0490 01213000
*                IF COPYSTAT=COPYLGT THEN /* SUCCESSFUL READ         */ 01214000
         CR    COPYSTAT,COPYLGT                                 03S0491 01215000
         BNE   @RF00491                                         03S0491 01216000
*                  DO;                                          03S0492 01217000
*                    UCBLBL = UCB; /* UCB ADDR FOR SHARED DEV        */ 01218000
*                                                               03S0493 01219000
         MVC   UCBLBL(3,BUFFRPTR),UCB                           03S0493 01220000
*                    DO;                                        03S0494 01221000
*                      UNPK(UCBADDR,QUCB2);                     03S0495 01222000
         UNPK  UCBADDR(7,BUFFRPTR),QUCB2(5)                     03S0495 01223000
*                      TR(UCBADDR,EBCTABL);                     03S0496 01224000
         L     @14,EBCPTR                                       03S0496 01225000
         TR    UCBADDR(7,BUFFRPTR),EBCTABL(@14)                 03S0496 01226000
*                      UCBADDR(LENGTH(UCBADDR)) = ' ';          03S0497 01227000
         MVI   UCBADDR+6(BUFFRPTR),C' '                         03S0497 01228000
*                    END;                                       03S0498 01229000
*                    IF QELXECB=ON THEN /* FIELD CONTAINS ECB        */ 01230000
         L     @14,INQELPTR                                     03S0499 01231000
         TM    QELXECB(@14),B'10000000'                         03S0499 01232000
         BNO   @RF00499                                         03S0499 01233000
*                      ECBLBL = ECB;                            03S0500 01234000
         MVC   ECBLBL(3,BUFFRPTR),ECB                           03S0500 01235000
*                    ELSE         /* FIELD CONTAINS SVRB             */ 01236000
*                      SVRBLBL = SVRB;                          03S0501 01237000
*                                                               03S0501 01238000
         B     @RC00499                                         03S0501 01239000
@RF00499 MVC   SVRBLBL(4,BUFFRPTR),SVRB                         03S0501 01240000
*                    DO;                                        03S0502 01241000
@RC00499 DS    0H                                               03S0503 01242000
*                      UNPK(SVRBECBA,QSVRB);                    03S0503 01243000
         L     @14,INQELPTR                                     03S0503 01244000
         UNPK  SVRBECBA(7,BUFFRPTR),QSVRB(5,@14)                03S0503 01245000
*                      TR(SVRBECBA,EBCTABL);                    03S0504 01246000
         L     @14,EBCPTR                                       03S0504 01247000
         TR    SVRBECBA(7,BUFFRPTR),EBCTABL(@14)                03S0504 01248000
*                      SVRBECBA(LENGTH(SVRBECBA)) = ' ';        03S0505 01249000
         MVI   SVRBECBA+6(BUFFRPTR),C' '                        03S0505 01250000
*                    END;                                       03S0506 01251000
*                  END;                                         03S0507 01252000
*                ELSE             /* NO UCB ADDRESS                  */ 01253000
*                  INCOMPLT = ON;                               03S0508 01254000
         B     @RC00491                                         03S0508 01255000
@RF00491 OI    INCOMPLT,B'00000010'                             03S0508 01256000
*              END;                                             03S0509 01257000
*            ELSE                 /* LIST QEL - NOT RESERVE          */ 01258000
*              DO;                                              03S0510 01259000
         B     @RC00487                                         03S0510 01260000
@RF00487 DS    0H                                               03S0511 01261000
*                COPYLGT = 8;                                   03S0511 01262000
         LA    COPYLGT,8                                        03S0511 01263000
*                CALL COPY;       /* COPY TWO MORE WORDS             */ 01264000
         BAL   @14,COPY                                         03S0512 01265000
*                IF COPYSTAT=COPYLGT THEN /* GOT BOTH WORDS          */ 01266000
         CR    COPYSTAT,COPYLGT                                 03S0513 01267000
         BNE   @RF00513                                         03S0513 01268000
*                  DO;                                          03S0514 01269000
*                    IF QELXECB=ON THEN /* FIELD CONTAINS ECB        */ 01270000
         L     @14,INQELPTR                                     03S0515 01271000
         TM    QELXECB(@14),B'10000000'                         03S0515 01272000
         BNO   @RF00515                                         03S0515 01273000
*                      ECBLBL = ECB;                            03S0516 01274000
         MVC   ECBLBL(3,BUFFRPTR),ECB                           03S0516 01275000
*                    ELSE         /* FIELD CONTAINS SVRB             */ 01276000
*                      SVRBLBL = SVRB;                          03S0517 01277000
*                                                               03S0517 01278000
         B     @RC00515                                         03S0517 01279000
@RF00515 MVC   SVRBLBL(4,BUFFRPTR),SVRB                         03S0517 01280000
*                    DO;                                        03S0518 01281000
@RC00515 DS    0H                                               03S0519 01282000
*                      UNPK(SVRBECBA,QSVRB);                    03S0519 01283000
         L     @14,INQELPTR                                     03S0519 01284000
         UNPK  SVRBECBA(7,BUFFRPTR),QSVRB(5,@14)                03S0519 01285000
*                      TR(SVRBECBA,EBCTABL);                    03S0520 01286000
         L     @14,EBCPTR                                       03S0520 01287000
         TR    SVRBECBA(7,BUFFRPTR),EBCTABL(@14)                03S0520 01288000
*                      SVRBECBA(LENGTH(SVRBECBA)) = ' ';        03S0521 01289000
         MVI   SVRBECBA+6(BUFFRPTR),C' '                        03S0521 01290000
*                    END;                                       03S0522 01291000
*                  END;                                         03S0523 01292000
*                ELSE             /* DID NOT GET BOTH WORDS          */ 01293000
*                  INCOMPLT = ON;                               03S0524 01294000
         B     @RC00513                                         03S0524 01295000
@RF00513 OI    INCOMPLT,B'00000010'                             03S0524 01296000
*              END;                                             03S0525 01297000
@RC00513 DS    0H                                               03S0526 01298000
*          END;                                                 03S0526 01299000
@RC00487 DS    0H                                               03S0527 01300000
*      IF QELRESV=YES THEN        /* RESERVE REQUEST                 */ 01301000
@RC00469 L     @14,INQELPTR                                     03S0527 01302000
         TM    QELRESV(@14),B'00010000'                         03S0527 01303000
         BNO   @RF00527                                         03S0527 01304000
*        TYPEQEL = RESERVE;                                     03S0528 01305000
         MVI   TYPEQEL+7(BUFFRPTR),C' '                         03S0528 01306000
         MVI   TYPEQEL+8(BUFFRPTR),C' '                         03S0528 01307000
         MVC   TYPEQEL(7,BUFFRPTR),RESERVE                      03S0528 01308000
*      ELSE                                                     03S0529 01309000
*        IF QELSHARE=ON THEN      /* SHARED ENQUEUE                  */ 01310000
         B     @RC00527                                         03S0529 01311000
@RF00527 L     @14,INQELPTR                                     03S0529 01312000
         TM    QELSHARE(@14),B'10000000'                        03S0529 01313000
         BNO   @RF00529                                         03S0529 01314000
*          TYPEQEL = SHARED;                                    03S0530 01315000
         MVI   TYPEQEL+6(BUFFRPTR),C' '                         03S0530 01316000
         MVC   TYPEQEL+7(2,BUFFRPTR),TYPEQEL+6(BUFFRPTR)        03S0530 01317000
         MVC   TYPEQEL(6,BUFFRPTR),SHARED                       03S0530 01318000
*        ELSE                                                   03S0531 01319000
*          TYPEQEL = EXCLUSIV;    /* EXCLUSIVE ENQUEUE               */ 01320000
         B     @RC00529                                         03S0531 01321000
@RF00529 MVC   TYPEQEL(9,BUFFRPTR),EXCLUSIV                     03S0531 01322000
*    END;                                                       03S0532 01323000
*  ELSE                           /* ONLY PART OF QEL WAS READ       */ 01324000
*    INCOMPLT = ON;                                             03S0533 01325000
         B     @RC00451                                         03S0533 01326000
@RF00451 OI    INCOMPLT,B'00000010'                             03S0533 01327000
*  CALL PRINTRTN;                 /* PRINT A QEL LINE                */ 01328000
@RC00451 BAL   @14,PRINTRTN                                     03S0534 01329000
*  IF INCOMPLT=ON THEN            /* QEL WAS PARTIALLY FORMATTED     */ 01330000
         TM    INCOMPLT,B'00000010'                             03S0535 01331000
         BNO   @RF00535                                         03S0535 01332000
*    DO;                                                        03S0536 01333000
*      STARTMSG = 14;                                           03S0537 01334000
         LA    STARTMSG,14                                      03S0537 01335000
*      CALL PARTPRNT;                                           03S0538 01336000
         BAL   @14,PARTPRNT                                     03S0538 01337000
*    END;                                                       03S0539 01338000
*END;                                                           03S0540 01339000
@RF00535 DS    0H                                               03S0541 01340000
*   IF THISQEL = STOPQEL THEN      /* STOP NOW IF AT END    @OZ15488 */ 01341000
@RF00442 CLC   THISQEL(4),STOPQEL                               02S0541 01342000
         BNE   @RF00541                                         02S0541 01343000
*      QELCHAIN = DONE;            /* END LOOP              @OZ15488 */ 01344000
         OI    QELCHAIN,B'00001000'                             02S0542 01345000
*   ELSE                                                /*  @OZ15488 */ 01346000
*   DO;                                                 /*  @OZ15488 */ 01347000
         B     @RC00541                                         02S0543 01348000
@RF00541 DS    0H                                               02S0544 01349000
*    IF QELBREAK=YES THEN         /* GOING UP THE CHAIN              */ 01350000
         TM    QELBREAK,B'00000100'                             02S0544 01351000
         BNO   @RF00544                                         02S0544 01352000
*      IF QELPQEL^=0 THEN         /* BACKWARD POINTER OK             */ 01353000
         L     @14,INQELPTR                                     02S0545 01354000
         L     @14,QELPQEL(,@14)                                02S0545 01355000
         LTR   @14,@14                                          02S0545 01356000
         BZ    @RF00545                                         02S0545 01357000
*        READAD = QELPQEL;        /* USE BACKWARD POINTER            */ 01358000
         ST    @14,READAD                                       02S0546 01359000
*      ELSE                                                     02S0547 01360000
*        QELCHAIN = DONE;         /* TERMINATE                       */ 01361000
         B     @RC00545                                         02S0547 01362000
@RF00545 OI    QELCHAIN,B'00001000'                             02S0547 01363000
*    ELSE                         /* STILL GOING FORWARD             */ 01364000
*      IF QELNQEL^=0 THEN         /* NOT AT END OF CHAIN             */ 01365000
         B     @RC00544                                         02S0548 01366000
@RF00544 L     @14,INQELPTR                                     02S0548 01367000
         L     @14,QELNQEL(,@14)                                02S0548 01368000
         LTR   @14,@14                                          02S0548 01369000
         BZ    @RF00548                                         02S0548 01370000
*        READAD = QELNQEL;        /* USE FORWARD POINTER             */ 01371000
         ST    @14,READAD                                       02S0549 01372000
*      ELSE                       /* AT END OF CHAIN                 */ 01373000
*        QELCHAIN = DONE;         /* TERMINATE                       */ 01374000
         B     @RC00548                                         02S0550 01375000
@RF00548 OI    QELCHAIN,B'00001000'                             02S0550 01376000
*   END;                                                /*  @OZ15488 */ 01377000
@RC00548 DS    0H                                               02S0551 01378000
@RC00544 DS    0H                                               02S0552 01379000
*  END;                                                         02S0552 01380000
@RC00541 AH    QELCOUNT,@CH00039                                02S0552 01381000
@DE00399 C     QELCOUNT,QELMAX                                  02S0552 01382000
         BNH   @DL00399                                         02S0552 01383000
@DC00399 DS    0H                                               02S0553 01384000
*  IF QELCOUNT>QELMAX & QELCHAIN=NOTDONE THEN                   02S0553 01385000
         C     QELCOUNT,QELMAX                                  02S0553 01386000
         BNH   @RF00553                                         02S0553 01387000
         TM    QELCHAIN,B'00001000'                             02S0553 01388000
         BNZ   @RF00553                                         02S0553 01389000
*/*------------------------------------------------------------------*/ 01390000
*/* INDICATE THAT A LOOP CONDITION WAS ASSUMED IN THE QEL CHAIN      */ 01391000
*/*------------------------------------------------------------------*/ 01392000
*DO;                                                            03S0554 01393000
*  CALL PRINTRTN;                                               03S0555 01394000
         BAL   @14,PRINTRTN                                     03S0555 01395000
*  INVALID = INVALMSG;                                          03S0556 01396000
         MVC   INVALID(7,BUFFRPTR),INVALMSG                     03S0556 01397000
*  INVALQEL = QELMSG;                                           03S0557 01398000
         MVC   INVALQEL(3,BUFFRPTR),QELMSG                      03S0557 01399000
*  ASSUMEQL = ASSUMED;                                          03S0558 01400000
         MVC   ASSUMEQL(13,BUFFRPTR),ASSUMED                    03S0558 01401000
*  CALL PRINTRTN;                                               03S0559 01402000
         BAL   @14,PRINTRTN                                     03S0559 01403000
*END;                                                           03S0560 01404000
*END QELFAMLY;                                                  02S0561 01405000
@EL00005 DS    0H                                               02S0561 01406000
@EF00005 DS    0H                                               02S0561 01407000
@ER00005 LM    @14,@08,@SA00005                                 02S0561 01408000
         LM    @10,@12,@SA00005+44                              02S0561 01409000
         BR    @14                                              02S0561 01410000
*/*------------------------------------------------------------------*/ 01411000
*/* MAKE AN INCORE COPY OF A DUMP DATA                               */ 01412000
*/*------------------------------------------------------------------*/ 01413000
*COPY: PROC;                                                    02S0562 01414000
COPY     STM   @14,@01,@SA00006                                 02S0562 01415000
         STM   @03,@04,@SA00006+16                              02S0562 01416000
         STM   @06,@12,@SA00006+24                              02S0562 01417000
*  COPYSTAT = COPYLGT;            /* INIT STATUS TO FULL COPY        */ 01418000
         LR    COPYSTAT,COPYLGT                                 02S0563 01419000
*  DO COPYIT=1 TO COPYLGT BY WORDLGT WHILE COPYSTAT=COPYLGT;    02S0564 01420000
         LA    COPYIT,1                                         02S0564 01421000
         B     @DE00564                                         02S0564 01422000
@DL00564 CR    COPYSTAT,COPYLGT                                 02S0564 01423000
         BNE   @DC00564                                         02S0564 01424000
*    R0READ = READAD;             /* ADDRESS OF WORD TO BE READ      */ 01425000
         L     R0READ,READAD                                    02S0565 01426000
*    R1 = ABDPLPTR;               /* ADDR OF PARM LIST               */ 01427000
         L     @14,ABDPLPTR                                     02S0566 01428000
         LR    R1,@14                                           02S0566 01429000
*    CALL MEMACRTN;               /* GET ONE WORD OF DATA            */ 01430000
         L     @15,ADPLMEMA(,@14)                               02S0567 01431000
         BALR  @14,@15                                          02S0567 01432000
*    IF R15=0 THEN                /* READ WAS GOOD                   */ 01433000
         LTR   R15,R15                                          02S0568 01434000
         BNZ   @RF00568                                         02S0568 01435000
*      DO;                                                      02S0569 01436000
*        COPYWORD = DATAWORD;     /* COPY DATA                       */ 01437000
         LR    @14,R0                                           02S0570 01438000
         MVC   COPYWORD(4,TOPTR),DATAWORD(@14)                  02S0570 01439000
*        READAD = READAD + WORDLGT; /* POINT TO NEXT WORD            */ 01440000
         LA    @14,4                                            02S0571 01441000
         L     @10,READAD                                       02S0571 01442000
         ALR   @10,@14                                          02S0571 01443000
         ST    @10,READAD                                       02S0571 01444000
*        TOPTR = TOPTR + WORDLGT; /* POINT TO NEXT AVAILABLE SLOT    */ 01445000
         ALR   TOPTR,@14                                        02S0572 01446000
*      END;                                                     02S0573 01447000
*    ELSE                         /* READ FAILED                     */ 01448000
*      COPYSTAT = COPYIT-1;       /* NUMBER OF BYTES COPIED          */ 01449000
         B     @RC00568                                         02S0574 01450000
@RF00568 LR    COPYSTAT,COPYIT                                  02S0574 01451000
         BCTR  COPYSTAT,0                                       02S0574 01452000
*  END;                                                         02S0575 01453000
@RC00568 AH    COPYIT,@CH00076                                  02S0575 01454000
@DE00564 CR    COPYIT,COPYLGT                                   02S0575 01455000
         BNH   @DL00564                                         02S0575 01456000
@DC00564 DS    0H                                               02S0576 01457000
*END COPY;                                                      02S0576 01458000
@EL00006 DS    0H                                               02S0576 01459000
@EF00006 DS    0H                                               02S0576 01460000
@ER00006 LM    @14,@01,@SA00006                                 02S0576 01461000
         LM    @03,@04,@SA00006+16                              02S0576 01462000
         LM    @06,@12,@SA00006+24                              02S0576 01463000
         BR    @14                                              02S0576 01464000
*/*------------------------------------------------------------------*/ 01465000
*/* PRINT AN OUTPUT COMMENT STATING THAT ONLY PART OF THE BLOCK      */ 01466000
*/* WAS FORMATTED.                                                   */ 01467000
*/*------------------------------------------------------------------*/ 01468000
*PARTPRNT: PROCEDURE;                                           02S0577 01469000
PARTPRNT STM   @14,@08,@SA00007                                 02S0577 01470000
         STM   @10,@12,@SA00007+44                              02S0577 01471000
*  MESSAGE(STARTMSG:STARTMSG+LENGTH(PARTMSG)-1) = PARTMSG;      02S0578 01472000
         LR    @14,BUFFRPTR                                     02S0578 01473000
         ALR   @14,STARTMSG                                     02S0578 01474000
         BCTR  @14,0                                            02S0578 01475000
         MVC   MESSAGE(55,@14),PARTMSG                          02S0578 01476000
*  CALL PRINTRTN;                                               02S0579 01477000
         BAL   @14,PRINTRTN                                     02S0579 01478000
*END PARTPRNT;                                                  02S0580 01479000
@EL00007 DS    0H                                               02S0580 01480000
@EF00007 DS    0H                                               02S0580 01481000
@ER00007 LM    @14,@08,@SA00007                                 02S0580 01482000
         LM    @10,@12,@SA00007+44                              02S0580 01483000
         BR    @14                                              02S0580 01484000
@PB00007 DS    0H                                               02S0580 01485000
*END AMDPRQCB                                                   01S0581 01486000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 01487000
*/*%INCLUDE SYSUT5  (PROLOG  )                                        * 01488000
*/*%INCLUDE SYSUT5  (QCBFL1  )                                        * 01489000
*/*%INCLUDE SYSUT5  (DECLARES)                                        * 01490000
*/*%INCLUDE SYSLIB  (IHAABDPL)                                        * 01491000
*/*%INCLUDE SYSLIB  (CVT     )                                        * 01492000
*/*%INCLUDE SYSLIB  (IHAQCB  )                                        * 01493000
*/*%INCLUDE SYSLIB  (IHAQEL  )                                        * 01494000
*/*%INCLUDE SYSUT5  (INITL   )                                        * 01495000
*/*%INCLUDE SYSUT5  (SAVECHAN)                                        * 01496000
*/*%INCLUDE SYSUT5  (NOCHAIN )                                        * 01497000
*/*%INCLUDE SYSUT5  (NOCVTQCB)                                        * 01498000
*/*%INCLUDE SYSUT5  (NOCVT   )                                        * 01499000
*/*%INCLUDE SYSUT5  (CLEANUP )                                        * 01500000
*/*%INCLUDE SYSUT5  (PRINTRTN)                                        * 01501000
*/*%INCLUDE SYSUT5  (MAJFAMLY)                                        * 01502000
*/*%INCLUDE SYSUT5  (MAJTERM )                                        * 01503000
*/*%INCLUDE SYSUT5  (MAJRECVR)                                        * 01504000
*/*%INCLUDE SYSUT5  (MAJFORM )                                        * 01505000
*/*%INCLUDE SYSUT5  (MAJLOOP )                                        * 01506000
*/*%INCLUDE SYSUT5  (MINFAMLY)                                        * 01507000
*/*%INCLUDE SYSUT5  (MINTERM )                                        * 01508000
*/*%INCLUDE SYSUT5  (MINRECVR)                                        * 01509000
*/*%INCLUDE SYSUT5  (MINFORM )                                        * 01510000
*/*%INCLUDE SYSUT5  (COPYNAME)                                        * 01511000
*/*%INCLUDE SYSUT5  (MINNMFRM)                                        * 01512000
*/*%INCLUDE SYSUT5  (MINLOOP )                                        * 01513000
*/*%INCLUDE SYSUT5  (QELFAMLY)                                        * 01514000
*/*%INCLUDE SYSUT5  (QELTERM )                                        * 01515000
*/*%INCLUDE SYSUT5  (QELRECVR)                                        * 01516000
*/*%INCLUDE SYSUT5  (QELFORM )                                        * 01517000
*/*%INCLUDE SYSUT5  (QELLOOP )                                        * 01518000
*/*%INCLUDE SYSUT5  (COPY    )                                        * 01519000
*/*%INCLUDE SYSUT5  (PARTPRNT)                                        * 01520000
*;                                                              01S0581 01521000
@DATA    DS    0H                                                       01522000
@CH00039 DC    H'1'                                                     01523000
@CH00095 DC    H'2'                                                     01524000
@CH00076 DC    H'4'                                                     01525000
@CH00082 DC    H'8'                                                     01526000
@CH00856 DC    H'20'                                                    01527000
@CH01067 DC    H'40'                                                    01528000
@CH01121 DC    H'240'                                                   01529000
@SM01179 MVC   EBCFLD2(0,BUFFRPTR),MINORNM-1(@08)                       01530000
@SM01181 MVC   NAMEMIN(0,BUFFRPTR),MINORNM-1(@08)                       01531000
@DATD    DSECT                                                          01532000
         DS    0F                                                       01533000
@SA00001 DS    18F                                                      01534000
@SA00002 DS    14F                                                      01535000
@SA00003 DS    15F                                                      01536000
@SA00006 DS    13F                                                      01537000
@SA00007 DS    14F                                                      01538000
@SA00004 DS    14F                                                      01539000
@SA00005 DS    14F                                                      01540000
AMDPRQCB CSECT                                                          01541000
         DS    0F                                                       01542000
@DATD    DSECT                                                          01543000
         DS    0D                                                       01544000
ABDPLPTR DS    A                                                        01545000
INMAJPTR DS    A                                                        01546000
INQELPTR DS    A                                                        01547000
READAD   DS    A                                                        01548000
MINCOUNT DS    F                                                        01549000
Z        DS    F                                                        01550000
EBCPTR   DS    A                                                        01551000
THISMAJ  DS    AL4                                                      01552000
         ORG   THISMAJ                                                  01553000
@NM00065 DS    CL1                                                      01554000
THISMAJH DS    CL4                                                      01555000
         ORG   THISMAJ+5                                                01556000
         DS    CL3                                                      01557000
THISMIN  DS    AL4                                                      01558000
         ORG   THISMIN                                                  01559000
@NM00066 DS    CL1                                                      01560000
THISMINH DS    CL4                                                      01561000
         ORG   THISMIN+5                                                01562000
         DS    CL3                                                      01563000
THISQEL  DS    AL4                                                      01564000
         ORG   THISQEL                                                  01565000
@NM00067 DS    CL1                                                      01566000
THISQELH DS    CL4                                                      01567000
         ORG   THISQEL+5                                                01568000
         DS    CL3                                                      01569000
FREESAVE DS    F                                                        01570000
WORKWORD DS    F                                                        01571000
SWITCHES DS    CL1                                                      01572000
         ORG   SWITCHES                                                 01573000
MAJCHAIN DS    BL1                                                      01574000
MAJBREAK EQU   SWITCHES+0                                               01575000
MINCHAIN EQU   SWITCHES+0                                               01576000
MINBREAK EQU   SWITCHES+0                                               01577000
QELCHAIN EQU   SWITCHES+0                                               01578000
QELBREAK EQU   SWITCHES+0                                               01579000
INCOMPLT EQU   SWITCHES+0                                               01580000
@NM00033 EQU   SWITCHES+0                                               01581000
         ORG   SWITCHES+1                                               01582000
         DS    CL3                                                      01583000
@NM00034 DS    CL20                                                     01584000
         ORG   @NM00034                                                 01585000
QCBHEAD  DS    AL4                                                      01586000
QCBTAIL  DS    AL4                                                      01587000
STOPMIN  DS    AL4                                                      01588000
STOPMAJ  DS    AL4                                                      01589000
STOPQEL  DS    AL4                                                      01590000
         ORG   @NM00034+20                                              01591000
INMAJ    DS    CL24                                                     01592000
INMIN    DS    CL246                                                    01593000
         ORG   INMIN                                                    01594000
@NM00035 DS    CL21                                                     01595000
@NM00036 DS    CL225                                                    01596000
         ORG   INMIN+246                                                01597000
INQEL    DS    CL28                                                     01598000
         ORG   INQEL                                                    01599000
@NM00037 DS    CL24                                                     01600000
INQEL1   DS    CL4                                                      01601000
         ORG   INQEL+28                                                 01602000
AMDPRQCB CSECT                                                          01603000
         DS    0F                                                       01604000
@SIZDATD DC    AL1(0)                                                   01605000
         DC    AL3(@ENDDATD-@DATD)                                      01606000
         DS    0D                                                       01607000
MAJMAX   DC    F'200'                                                   01608000
MINMAX   DC    F'200'                                                   01609000
QELMAX   DC    F'200'                                                   01610000
NOCVTMSG DC    CL20'UNABLE TO ACCESS CVT'                               01611000
TERMTEXT DC    CL19'QCBTRACE TERMINATED'                                01612000
INVALMSG DC    CL7'INVALID'                                             01613000
MAJORQCB DC    CL9'MAJOR QCB'                                           01614000
ASSUMED  DC    CL13'CHAIN ASSUMED'                                      01615000
QELMSG   DC    CL3'QEL'                                                 01616000
ERRFND   DC    CL13'ERROR FINDING'                                      01617000
FRSTBRK2 DC    CL24'BACKWARD TRACING FOLLOWS'                           01618000
DASH     DC    CL2'--'                                                  01619000
NOQCBMSG DC    CL13'NO MAJOR QCBS'                                      01620000
CVTQCBMG DC    CL37'UNABLE TO OBTAIN POINTER TO FIRST QCB'              01621000
ZEROLGTM DC    CL25'MINOR NAME LENGTH IS ZERO'                          01622000
MINORQCB DC    CL9'MINOR QCB'                                           01623000
TITLE    DC    CL68'* * * *    Q U E U E  C O N T R O L  B L O C K  P RC01624000
                I N T    * * * *'                                       01625000
PARTMSG  DC    CL55'ONLY A PORTION OF PRECEEDING CONTROL BLOCK WAS OBTAC01626000
               INED'                                                    01627000
NONPRNT  DS    CL256                                                    01628000
         ORG   NONPRNT                                                  01629000
@NM00038 DC    X'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                      01630000
         DC    X'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                      01631000
         DC    X'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                      01632000
         DC    X'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                      01633000
         DC    X'00FFFFFFFFFFFFFFFFFFFF00FF00FFFF'                      01634000
         DC    X'FFFFFFFFFFFFFFFFFFFFFF000000FFFF'                      01635000
         DC    X'0000FFFFFFFFFFFFFFFFFF00FFFFFFFF'                      01636000
         DC    X'FFFFFFFFFFFFFFFFFFFFFF00000000FF'                      01637000
         DC    X'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                      01638000
         DC    X'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                      01639000
         DC    X'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                      01640000
         DC    X'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF'                      01641000
         DC    X'FF000000000000000000FFFFFFFFFFFF'                      01642000
         DC    X'FF000000000000000000FFFFFFFFFFFF'                      01643000
         DC    X'FFFF0000000000000000FFFFFFFFFFFF'                      01644000
         DC    X'00000000000000000000FFFFFFFFFFFF'                      01645000
         ORG   NONPRNT+256                                              01646000
EBCDIC   DC    CL16'0123456789ABCDEF'                                   01647000
PRNTTBL  DS    CL256                                                    01648000
         ORG   PRNTTBL                                                  01649000
@NM00039 DC    CL16'................'                                   01650000
         DC    CL16'................'                                   01651000
         DC    CL16'................'                                   01652000
         DC    CL16'................'                                   01653000
         DC    CL16' ...............'                                   01654000
         DC    CL16'................'                                   01655000
         DC    CL16'................'                                   01656000
         DC    CL16'................'                                   01657000
         DC    CL16'................'                                   01658000
         DC    CL16'................'                                   01659000
         DC    CL16'................'                                   01660000
         DC    CL16'................'                                   01661000
         DC    CL16'.ABCDEFGHI......'                                   01662000
         DC    CL16'.JKLMNOPQR......'                                   01663000
         DC    CL16'..STUVWXYZ......'                                   01664000
         DC    CL16'0123456789......'                                   01665000
         ORG   PRNTTBL+256                                              01666000
MAJOR    DC    CL5'MAJOR'                                               01667000
NAME     DC    CL4'NAME'                                                01668000
MINOR    DC    CL5'MINOR'                                               01669000
STEP     DC    CL4'STEP'                                                01670000
SYSTEM   DC    CL6'SYSTEM'                                              01671000
SYSTEMS  DC    CL7'SYSTEMS'                                             01672000
ASID     DC    CL4'ASID'                                                01673000
TCB      DC    CL3'TCB'                                                 01674000
LIST     DC    CL4'LIST'                                                01675000
EXCLUSIV DC    CL9'EXCLUSIVE'                                           01676000
SHARED   DC    CL6'SHARED'                                              01677000
RESERVE  DC    CL7'RESERVE'                                             01678000
ECB      DC    CL3'ECB'                                                 01679000
SVRB     DC    CL4'SVRB'                                                01680000
UCB      DC    CL3'UCB'                                                 01681000
MUSTMSG  DC    CL18'STEP MUST COMPLETE'                                 01682000
ERROR    DC    CL5'ERROR'                                               01683000
AMDPRQCB CSECT                                                          01684000
MINNMTRT       TRT  0(,R6),NONPRNT                                      01685000
@DATD    DSECT                                                          01686000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                01687000
@ENDDATD EQU   *                                                        01688000
AMDPRQCB CSECT                                                          01689000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01690000
@01      EQU   01                                                       01691000
@02      EQU   02                                                       01692000
@03      EQU   03                                                       01693000
@04      EQU   04                                                       01694000
@05      EQU   05                                                       01695000
@06      EQU   06                                                       01696000
@07      EQU   07                                                       01697000
@08      EQU   08                                                       01698000
@09      EQU   09                                                       01699000
@10      EQU   10                                                       01700000
@11      EQU   11                                                       01701000
@12      EQU   12                                                       01702000
@13      EQU   13                                                       01703000
@14      EQU   14                                                       01704000
@15      EQU   15                                                       01705000
Y        EQU   @02                                                      01706000
COPYIT   EQU   @06                                                      01707000
QELCOUNT EQU   @06                                                      01708000
MAJCOUNT EQU   @06                                                      01709000
LINEEND  EQU   @03                                                      01710000
COPYLGT  EQU   @03                                                      01711000
FROMPTR  EQU   @06                                                      01712000
TOPTR    EQU   @05                                                      01713000
STARTMSG EQU   @02                                                      01714000
RETCODE  EQU   @06                                                      01715000
COPYSTAT EQU   @02                                                      01716000
BUFFRPTR EQU   @09                                                      01717000
INMINPTR EQU   @10                                                      01718000
R13      EQU   @13                                                      01719000
DATAREG  EQU   @11                                                      01720000
R0READ   EQU   @00                                                      01721000
R0       EQU   @00                                                      01722000
R1       EQU   @01                                                      01723000
R2       EQU   @02                                                      01724000
R3       EQU   @03                                                      01725000
R5       EQU   @05                                                      01726000
R6       EQU   @06                                                      01727000
R15      EQU   @15                                                      01728000
ABDPL    EQU   0                                                        01729000
ADPLSBPL EQU   ABDPL+6                                                  01730000
ADPLFLAG EQU   ABDPL+7                                                  01731000
ADPLBUF  EQU   ABDPL+8                                                  01732000
ADPLPRNT EQU   ABDPL+12                                                 01733000
ADPLCVT  EQU   ABDPL+16                                                 01734000
ADPLMEMA EQU   ABDPL+20                                                 01735000
CVTMAP   EQU   0                                                        01736000
CVTDAR   EQU   CVTMAP+72                                                01737000
CVTFLGS1 EQU   CVTDAR                                                   01738000
CVTDCB   EQU   CVTMAP+116                                               01739000
CVTIOQET EQU   CVTMAP+120                                               01740000
CVTIERLC EQU   CVTMAP+144                                               01741000
CVTHEAD  EQU   CVTMAP+160                                               01742000
CVTSV76C EQU   CVTHEAD                                                  01743000
CVTOPTA  EQU   CVTMAP+182                                               01744000
CVTOPTB  EQU   CVTMAP+183                                               01745000
CVTGTF   EQU   CVTMAP+236                                               01746000
CVTGTFST EQU   CVTGTF                                                   01747000
CVTGTFS  EQU   CVTGTFST                                                 01748000
CVTSTATE EQU   CVTGTFST                                                 01749000
CVTTMODE EQU   CVTGTFST                                                 01750000
CVTFORM  EQU   CVTGTFST                                                 01751000
CVTAQAVT EQU   CVTMAP+240                                               01752000
CVTTCMFG EQU   CVTAQAVT                                                 01753000
CVTVOLM2 EQU   CVTMAP+244                                               01754000
CVTTATA  EQU   CVTVOLM2                                                 01755000
CVTTSKS  EQU   CVTTATA                                                  01756000
CVTVOLF2 EQU   CVTTSKS                                                  01757000
CVTTAT   EQU   CVTTATA+1                                                01758000
CVTATER  EQU   CVTMAP+248                                               01759000
CVTEXT1  EQU   CVTMAP+252                                               01760000
CVTPURG  EQU   CVTMAP+260                                               01761000
CVTQMSG  EQU   CVTMAP+268                                               01762000
CVTDMSR  EQU   CVTMAP+272                                               01763000
CVTRSV37 EQU   CVTDMSR                                                  01764000
CVTDMSRF EQU   CVTRSV37                                                 01765000
CVTERPV  EQU   CVTMAP+316                                               01766000
CVTINTLA EQU   CVTMAP+320                                               01767000
CVTAPF   EQU   CVTMAP+324                                               01768000
CVTEXT2  EQU   CVTMAP+328                                               01769000
CVTHJES  EQU   CVTMAP+332                                               01770000
CVTPGSIA EQU   CVTMAP+348                                               01771000
CVTA1F1  EQU   CVTMAP+356                                               01772000
CVTSYSK  EQU   CVTMAP+357                                               01773000
CVTVOLM1 EQU   CVTMAP+380                                               01774000
CVTVOLF1 EQU   CVTVOLM1                                                 01775000
CVTATMCT EQU   CVTMAP+388                                               01776000
CVTXTNT1 EQU   0                                                        01777000
CVTXTNT2 EQU   0                                                        01778000
CVTDSSV  EQU   CVTXTNT2                                                 01779000
CVTFLGBT EQU   CVTXTNT2+5                                               01780000
CVTQID   EQU   CVTXTNT2+24                                              01781000
CVTRV400 EQU   CVTXTNT2+52                                              01782000
CVTRV409 EQU   CVTXTNT2+53                                              01783000
CVTATCVT EQU   CVTXTNT2+64                                              01784000
CVTRV429 EQU   CVTXTNT2+84                                              01785000
CVTRV438 EQU   CVTXTNT2+85                                              01786000
CVTRV457 EQU   CVTXTNT2+112                                             01787000
CVTRV466 EQU   CVTXTNT2+113                                             01788000
CVTFIX   EQU   0                                                        01789000
CVTRELNO EQU   CVTFIX+252                                               01790000
MAJ      EQU   0                                                        01791000
MAJNMAJ  EQU   MAJ                                                      01792000
MAJPMAJ  EQU   MAJ+4                                                    01793000
MAJFMIN  EQU   MAJ+8                                                    01794000
MAJLMIN  EQU   MAJ+12                                                   01795000
MAJNAME  EQU   MAJ+16                                                   01796000
MIN      EQU   0                                                        01797000
MINNMIN  EQU   MIN                                                      01798000
MINPMIN  EQU   MIN+4                                                    01799000
MINFQEL  EQU   MIN+8                                                    01800000
MINLQEL  EQU   MIN+12                                                   01801000
MINNAMEL EQU   MIN+16                                                   01802000
MINFLGS  EQU   MIN+17                                                   01803000
MINSYS   EQU   MINFLGS                                                  01804000
MINSYSS  EQU   MINFLGS                                                  01805000
MINSTEP  EQU   MINFLGS                                                  01806000
MINASID  EQU   MIN+18                                                   01807000
MINNAME  EQU   MIN+20                                                   01808000
QEL      EQU   0                                                        01809000
QELNQEL  EQU   QEL                                                      01810000
QELPQEL  EQU   QEL+4                                                    01811000
QELTCB   EQU   QEL+8                                                    01812000
QELLQEL  EQU   QELTCB                                                   01813000
QELXLIST EQU   QELLQEL                                                  01814000
QELQFLGS EQU   QEL+12                                                   01815000
QELSHARE EQU   QELQFLGS                                                 01816000
QELMC    EQU   QELQFLGS                                                 01817000
QELLIST  EQU   QELQFLGS                                                 01818000
QELRESV  EQU   QELQFLGS                                                 01819000
QELLFLGS EQU   QEL+13                                                   01820000
QELASID  EQU   QEL+14                                                   01821000
QELSVRB  EQU   QEL+16                                                   01822000
QELECB   EQU   QELSVRB                                                  01823000
QELXECB  EQU   QELECB                                                   01824000
MESSAGE  EQU   0                                                        01825000
PRINTR   EQU   0                                                        01826000
MEMACRTN EQU   0                                                        01827000
COPYWORD EQU   0                                                        01828000
DATAWORD EQU   0                                                        01829000
TO       EQU   0                                                        01830000
FROM     EQU   0                                                        01831000
EBCTABL  EQU   0                                                        01832000
MAJOROUT EQU   0                                                        01833000
HDRMAJ   EQU   MAJOROUT                                                 01834000
ADDRMAJ  EQU   MAJOROUT+6                                               01835000
NAMMAJLB EQU   MAJOROUT+16                                              01836000
@NM00043 EQU   MAJOROUT+21                                              01837000
NAMEMAJ  EQU   @NM00043                                                 01838000
NAMEMAJ1 EQU   NAMEMAJ                                                  01839000
NAMEMAJ2 EQU   @NM00043+8                                               01840000
MASTAR1  EQU   MAJOROUT+39                                              01841000
EBCFLD1  EQU   MAJOROUT+40                                              01842000
MASTAR2  EQU   MAJOROUT+48                                              01843000
MINOROUT EQU   0                                                        01844000
HDRMIN   EQU   MINOROUT+6                                               01845000
ADDRMIN  EQU   MINOROUT+12                                              01846000
SCOPE    EQU   MINOROUT+20                                              01847000
ASIDLBL  EQU   MINOROUT+29                                              01848000
ASIDFLD  EQU   MINOROUT+34                                              01849000
NAMMINLB EQU   MINOROUT+40                                              01850000
NAMEMIN  EQU   MINOROUT+45                                              01851000
MISTAR1  EQU   MINOROUT+87                                              01852000
EBCFLD2  EQU   MINOROUT+88                                              01853000
MISTAR2  EQU   MINOROUT+108                                             01854000
QELOUT   EQU   0                                                        01855000
HDRQEL   EQU   QELOUT+12                                                01856000
ADDRQEL  EQU   QELOUT+16                                                01857000
LISTLBL  EQU   QELOUT+24                                                01858000
TCBLBL   EQU   LISTLBL                                                  01859000
LISTTCBA EQU   QELOUT+29                                                01860000
TYPEQEL  EQU   QELOUT+37                                                01861000
QELASIDL EQU   QELOUT+48                                                01862000
QASIDFLD EQU   QELOUT+53                                                01863000
SVRBLBL  EQU   QELOUT+59                                                01864000
ECBLBL   EQU   SVRBLBL                                                  01865000
SVRBECBA EQU   QELOUT+64                                                01866000
UCBLBL   EQU   QELOUT+72                                                01867000
UCBADDR  EQU   QELOUT+76                                                01868000
MUSTCOMP EQU   QELOUT+84                                                01869000
HISSAVE  EQU   0                                                        01870000
CVTPTR   EQU   ADPLCVT                                                  01871000
CVTS01   EQU   CVTPGSIA                                                 01872000
CVTLPDIA EQU   CVTS01+12                                                01873000
CVTDIRST EQU   CVTLPDIA                                                 01874000
CVTSLIDA EQU   CVTS01+24                                                01875000
CVTCTLFG EQU   CVTS01+50                                                01876000
CVTFQCB  EQU   CVTS01+292                                               01877000
CVTLQCB  EQU   CVTS01+296                                               01878000
CVTRV210 EQU   CVTS01+424                                               01879000
CVTRV219 EQU   CVTS01+425                                               01880000
CVTRV228 EQU   CVTS01+426                                               01881000
CVTRV237 EQU   CVTS01+427                                               01882000
CVTMFRTR EQU   CVTS01+452                                               01883000
CVTRV262 EQU   CVTS01+468                                               01884000
CVTRV271 EQU   CVTS01+469                                               01885000
CVTRV280 EQU   CVTS01+470                                               01886000
CVTRV289 EQU   CVTS01+471                                               01887000
CVTGSDA  EQU   CVTS01+600                                               01888000
@NM00017 EQU   MESSAGE                                                  01889000
NOCVT    EQU   @NM00017                                                 01890000
@NM00020 EQU   MESSAGE                                                  01891000
INVALID  EQU   @NM00020                                                 01892000
INVALQCB EQU   @NM00020+8                                               01893000
ASSUME   EQU   @NM00020+18                                              01894000
@NM00023 EQU   INVALQCB                                                 01895000
INVALQEL EQU   @NM00023                                                 01896000
ASSUMEQL EQU   @NM00023+4                                               01897000
@NM00025 EQU   MESSAGE                                                  01898000
QCBCHN1  EQU   @NM00025                                                 01899000
QCBCHN2  EQU   @NM00025+14                                              01900000
QCBCHN3  EQU   @NM00025+24                                              01901000
QCBCHND  EQU   @NM00025+31                                              01902000
QCBCHN4  EQU   @NM00025+34                                              01903000
QCBCHN5  EQU   QCBCHN4                                                  01904000
@NM00029 EQU   MESSAGE                                                  01905000
QELCHN1  EQU   @NM00029                                                 01906000
QELCHN2  EQU   @NM00029+14                                              01907000
QELCHN3  EQU   @NM00029+18                                              01908000
QELCHND  EQU   @NM00029+25                                              01909000
QELCHN5  EQU   @NM00029+28                                              01910000
MASID    EQU   MINASID                                                  01911000
QSVRB    EQU   QELSVRB                                                  01912000
QUCB1    EQU   QELSVRB                                                  01913000
QUCB2    EQU   INQEL1                                                   01914000
QTCB     EQU   QELTCB                                                   01915000
QASID    EQU   QELASID                                                  01916000
MINORNM  EQU   MINNAME                                                  01917000
MAJORNM  EQU   MAJNAME                                                  01918000
@NM00068 EQU   MAJORNM                                                  01919000
MAJORNM1 EQU   @NM00068                                                 01920000
MAJORNM2 EQU   MAJORNM+4                                                01921000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01922000
@NM00032 EQU   @NM00029+27                                              01923000
@NM00031 EQU   @NM00029+17                                              01924000
@NM00030 EQU   @NM00029+13                                              01925000
@NM00028 EQU   @NM00025+33                                              01926000
@NM00027 EQU   @NM00025+23                                              01927000
@NM00026 EQU   @NM00025+13                                              01928000
@NM00024 EQU   @NM00023+3                                               01929000
@NM00022 EQU   @NM00020+17                                              01930000
@NM00021 EQU   @NM00020+7                                               01931000
CVTTERM  EQU   @NM00017+24                                              01932000
@NM00019 EQU   @NM00017+23                                              01933000
NOCVTD   EQU   @NM00017+21                                              01934000
@NM00018 EQU   @NM00017+20                                              01935000
CVTRV628 EQU   CVTS01+728                                               01936000
CVTRV627 EQU   CVTS01+724                                               01937000
CVTRV626 EQU   CVTS01+720                                               01938000
CVTRV625 EQU   CVTS01+716                                               01939000
CVTRV624 EQU   CVTS01+712                                               01940000
CVTRV623 EQU   CVTS01+708                                               01941000
CVTRV622 EQU   CVTS01+704                                               01942000
CVTRV621 EQU   CVTS01+700                                               01943000
CVTIHASU EQU   CVTS01+696                                               01944000
CVTRV619 EQU   CVTS01+692                                               01945000
CVTRV618 EQU   CVTS01+688                                               01946000
CVTRV617 EQU   CVTS01+684                                               01947000
CVTRV616 EQU   CVTS01+680                                               01948000
CVTRV615 EQU   CVTS01+676                                               01949000
CVTRV614 EQU   CVTS01+672                                               01950000
CVTRV613 EQU   CVTS01+668                                               01951000
CVTTCASP EQU   CVTS01+664                                               01952000
CVT0PT03 EQU   CVTS01+660                                               01953000
CVT0PT0E EQU   CVTS01+656                                               01954000
CVTRV609 EQU   CVTS01+652                                               01955000
CVTCGK   EQU   CVTS01+648                                               01956000
CVTRAC   EQU   CVTS01+644                                               01957000
CVTHSM   EQU   CVTS01+640                                               01958000
CVTRV605 EQU   CVTS01+636                                               01959000
CVTRV604 EQU   CVTS01+632                                               01960000
CVTEFF02 EQU   CVTS01+628                                               01961000
CVTCBBR  EQU   CVTS01+624                                               01962000
CVTSSCR  EQU   CVTS01+620                                               01963000
CVTEVENT EQU   CVTS01+616                                               01964000
CVTCRCA  EQU   CVTS01+612                                               01965000
CVTTPIO  EQU   CVTS01+608                                               01966000
CVTADV   EQU   CVTS01+604                                               01967000
CVTGSDAB EQU   CVTGSDA                                                  01968000
CVTQV3   EQU   CVTS01+596                                               01969000
CVTQV2   EQU   CVTS01+592                                               01970000
CVTQV1   EQU   CVTS01+588                                               01971000
CVTRPT   EQU   CVTS01+584                                               01972000
CVTSSRB  EQU   CVTS01+580                                               01973000
CVTCSDRL EQU   CVTS01+576                                               01974000
CVTEXP1  EQU   CVTS01+572                                               01975000
CVTRMPMT EQU   CVTS01+568                                               01976000
CVTRMPTT EQU   CVTS01+564                                               01977000
CVTVPSA  EQU   CVTS01+560                                               01978000
CVTVSTOP EQU   CVTS01+556                                               01979000
CVTGTFR8 EQU   CVTS01+552                                               01980000
CVTQUIT  EQU   CVTS01+548                                               01981000
CVTVACR  EQU   CVTS01+544                                               01982000
CVTWTCB  EQU   CVTS01+540                                               01983000
CVTSTPRS EQU   CVTS01+536                                               01984000
CVT0PT02 EQU   CVTS01+532                                               01985000
CVTDARCM EQU   CVTS01+528                                               01986000
CVTIRECM EQU   CVTS01+524                                               01987000
CVTJRECM EQU   CVTS01+520                                               01988000
CVTVEMS0 EQU   CVTS01+516                                               01989000
CVTSPFRR EQU   CVTS01+512                                               01990000
CVTRLSTG EQU   CVTS01+508                                               01991000
CVT0TC0A EQU   CVTS01+504                                               01992000
CVTGMBR  EQU   CVTS01+500                                               01993000
CVTLFRM  EQU   CVTS01+496                                               01994000
CVTRMBR  EQU   CVTS01+492                                               01995000
CVTVIOP  EQU   CVTS01+488                                               01996000
CVTRV307 EQU   CVTS01+486                                               01997000
CVTRV306 EQU   CVTS01+484                                               01998000
CVTRV305 EQU   CVTS01+482                                               01999000
CVTRV304 EQU   CVTS01+480                                               02000000
CVTRV303 EQU   CVTS01+478                                               02001000
CVTRV302 EQU   CVTS01+476                                               02002000
CVTTRCA  EQU   CVTS01+472                                               02003000
CVTRV297 EQU   CVTRV289                                                 02004000
CVTRV296 EQU   CVTRV289                                                 02005000
CVTRV295 EQU   CVTRV289                                                 02006000
CVTRV294 EQU   CVTRV289                                                 02007000
CVTRV293 EQU   CVTRV289                                                 02008000
CVTRV292 EQU   CVTRV289                                                 02009000
CVTRV291 EQU   CVTRV289                                                 02010000
CVTRV290 EQU   CVTRV289                                                 02011000
CVTRV288 EQU   CVTRV280                                                 02012000
CVTRV287 EQU   CVTRV280                                                 02013000
CVTRV286 EQU   CVTRV280                                                 02014000
CVTRV285 EQU   CVTRV280                                                 02015000
CVTRV284 EQU   CVTRV280                                                 02016000
CVTRV283 EQU   CVTRV280                                                 02017000
CVTRV282 EQU   CVTRV280                                                 02018000
CVTRV281 EQU   CVTRV280                                                 02019000
CVTRV279 EQU   CVTRV271                                                 02020000
CVTRV278 EQU   CVTRV271                                                 02021000
CVTRV277 EQU   CVTRV271                                                 02022000
CVTRV276 EQU   CVTRV271                                                 02023000
CVTRV275 EQU   CVTRV271                                                 02024000
CVTRV274 EQU   CVTRV271                                                 02025000
CVTRV273 EQU   CVTRV271                                                 02026000
CVTRV272 EQU   CVTRV271                                                 02027000
CVTRV270 EQU   CVTRV262                                                 02028000
CVTRV269 EQU   CVTRV262                                                 02029000
CVTRV268 EQU   CVTRV262                                                 02030000
CVTRV267 EQU   CVTRV262                                                 02031000
CVTRV266 EQU   CVTRV262                                                 02032000
CVTRV265 EQU   CVTRV262                                                 02033000
CVTRV264 EQU   CVTRV262                                                 02034000
CVTRV263 EQU   CVTRV262                                                 02035000
CVTVFP   EQU   CVTS01+464                                               02036000
CVTVSI   EQU   CVTS01+460                                               02037000
CVTVPSIB EQU   CVTS01+456                                               02038000
CVTMFACT EQU   CVTMFRTR                                                 02039000
CVTMFCTL EQU   CVTS01+448                                               02040000
CVTPVBP  EQU   CVTS01+444                                               02041000
CVTPWI   EQU   CVTS01+440                                               02042000
CVTRV254 EQU   CVTS01+438                                               02043000
CVTRV253 EQU   CVTS01+436                                               02044000
CVTRV252 EQU   CVTS01+434                                               02045000
CVTRV251 EQU   CVTS01+433                                               02046000
CVTRV250 EQU   CVTS01+432                                               02047000
CVTRV249 EQU   CVTS01+431                                               02048000
CVTRV248 EQU   CVTS01+430                                               02049000
CVTRV247 EQU   CVTS01+429                                               02050000
CVTRV246 EQU   CVTS01+428                                               02051000
CVTRV245 EQU   CVTRV237                                                 02052000
CVTRV244 EQU   CVTRV237                                                 02053000
CVTRV243 EQU   CVTRV237                                                 02054000
CVTRV242 EQU   CVTRV237                                                 02055000
CVTRV241 EQU   CVTRV237                                                 02056000
CVTRV240 EQU   CVTRV237                                                 02057000
CVTRV239 EQU   CVTRV237                                                 02058000
CVTRV238 EQU   CVTRV237                                                 02059000
CVTRV236 EQU   CVTRV228                                                 02060000
CVTRV235 EQU   CVTRV228                                                 02061000
CVTRV234 EQU   CVTRV228                                                 02062000
CVTRV233 EQU   CVTRV228                                                 02063000
CVTRV232 EQU   CVTRV228                                                 02064000
CVTRV231 EQU   CVTRV228                                                 02065000
CVTRV230 EQU   CVTRV228                                                 02066000
CVTRV229 EQU   CVTRV228                                                 02067000
CVTRV227 EQU   CVTRV219                                                 02068000
CVTRV226 EQU   CVTRV219                                                 02069000
CVTRV225 EQU   CVTRV219                                                 02070000
CVTRV224 EQU   CVTRV219                                                 02071000
CVTRV223 EQU   CVTRV219                                                 02072000
CVTRV222 EQU   CVTRV219                                                 02073000
CVTRV221 EQU   CVTRV219                                                 02074000
CVTRV220 EQU   CVTRV219                                                 02075000
CVTRV218 EQU   CVTRV210                                                 02076000
CVTRV217 EQU   CVTRV210                                                 02077000
CVTRV216 EQU   CVTRV210                                                 02078000
CVTRV215 EQU   CVTRV210                                                 02079000
CVTRV214 EQU   CVTRV210                                                 02080000
CVTRV213 EQU   CVTRV210                                                 02081000
CVTRV212 EQU   CVTRV210                                                 02082000
CVTRV211 EQU   CVTRV210                                                 02083000
CVTLCCAT EQU   CVTS01+420                                               02084000
CVTPCCAT EQU   CVTS01+416                                               02085000
CVTIPCRP EQU   CVTS01+412                                               02086000
CVTIPCRI EQU   CVTS01+408                                               02087000
CVTIPCDS EQU   CVTS01+404                                               02088000
CVTAIDVT EQU   CVTS01+400                                               02089000
CVTSSAP  EQU   CVTS01+396                                               02090000
CVTEHCIR EQU   CVTS01+392                                               02091000
CVTEHDEF EQU   CVTS01+388                                               02092000
CVTDAIR  EQU   CVTS01+384                                               02093000
CVTPERFM EQU   CVTS01+380                                               02094000
CVT044R2 EQU   CVTS01+376                                               02095000
CVTFETCH EQU   CVTS01+372                                               02096000
CVTRSTWD EQU   CVTS01+368                                               02097000
CVTSPOST EQU   CVTS01+364                                               02098000
CVTIOBP  EQU   CVTS01+360                                               02099000
CVTASMVT EQU   CVTS01+356                                               02100000
CVTRECRQ EQU   CVTS01+352                                               02101000
CVTWSAC  EQU   CVTS01+348                                               02102000
CVTRV149 EQU   CVTS01+344                                               02103000
CVTWSAL  EQU   CVTS01+340                                               02104000
CVTSPSA  EQU   CVTS01+336                                               02105000
CVTGLMN  EQU   CVTS01+332                                               02106000
CVTVEAC0 EQU   CVTS01+328                                               02107000
CVT062R1 EQU   CVTS01+324                                               02108000
CVTRPOST EQU   CVTS01+320                                               02109000
CVTDQIQE EQU   CVTS01+316                                               02110000
CVTCSD   EQU   CVTS01+312                                               02111000
CVTLKRMA EQU   CVTS01+308                                               02112000
CVTRSPIE EQU   CVTS01+304                                               02113000
CVTRENQ  EQU   CVTS01+300                                               02114000
CVTQCS01 EQU   CVTS01+288                                               02115000
CVTAPFT  EQU   CVTS01+284                                               02116000
CVTPARRL EQU   CVTS01+280                                               02117000
CVTVWAIT EQU   CVTS01+276                                               02118000
CVTGSPL  EQU   CVTS01+272                                               02119000
CVTLSMQ  EQU   CVTS01+268                                               02120000
CVTGSMQ  EQU   CVTS01+264                                               02121000
CVTEXPRO EQU   CVTS01+260                                               02122000
CVTOPCTP EQU   CVTS01+256                                               02123000
CVTSIC   EQU   CVTS01+252                                               02124000
CVTTPIOS EQU   CVTS01+248                                               02125000
CVTRTMS  EQU   CVTS01+244                                               02126000
CVTSDBF  EQU   CVTS01+240                                               02127000
CVTSCBP  EQU   CVTS01+236                                               02128000
CVTSDMP  EQU   CVTS01+232                                               02129000
CVTSV60  EQU   CVTS01+228                                               02130000
CVTRTMCT EQU   CVTS01+224                                               02131000
CVTASCBL EQU   CVTS01+220                                               02132000
CVTASCBH EQU   CVTS01+216                                               02133000
CVTGDA   EQU   CVTS01+212                                               02134000
CVTASVT  EQU   CVTS01+208                                               02135000
CVTVVMDI EQU   CVTS01+204                                               02136000
CVTAQTOP EQU   CVTS01+200                                               02137000
CVTIOSCS EQU   CVTS01+196                                               02138000
CVTSDRM  EQU   CVTS01+192                                               02139000
CVTOPTE  EQU   CVTS01+188                                               02140000
CVTSTXU  EQU   CVTS01+184                                               02141000
CVTQUIS  EQU   CVTS01+180                                               02142000
CVTPARS  EQU   CVTS01+176                                               02143000
CVTS1EE  EQU   CVTS01+172                                               02144000
CVTFRAS  EQU   CVTS01+168                                               02145000
CVTQSAS  EQU   CVTS01+164                                               02146000
CVTCRAS  EQU   CVTS01+160                                               02147000
CVTCRMN  EQU   CVTS01+156                                               02148000
CVTDELCP EQU   CVTS01+152                                               02149000
CVTFRECL EQU   CVTS01+148                                               02150000
CVTGETCL EQU   CVTS01+144                                               02151000
CVTBLDCP EQU   CVTS01+140                                               02152000
CVTAUTHL EQU   CVTS01+136                                               02153000
CVTSCAN  EQU   CVTS01+132                                               02154000
CVTRV144 EQU   CVTS01+130                                               02155000
CVTMAXMP EQU   CVTS01+128                                               02156000
CVTSTCK  EQU   CVTS01+124                                               02157000
CVTRV139 EQU   CVTS01+123                                               02158000
CVTDSSAC EQU   CVTS01+122                                               02159000
CVTRV513 EQU   CVTS01+121                                               02160000
CVTIOSPL EQU   CVTS01+120                                               02161000
CVTPTGT  EQU   CVTS01+116                                               02162000
CVTCSPIE EQU   CVTS01+112                                               02163000
CVTSMFEX EQU   CVTS01+108                                               02164000
CVTOLT0A EQU   CVTS01+104                                               02165000
CVTSRBRT EQU   CVTS01+100                                               02166000
CVTPUTL  EQU   CVTS01+96                                                02167000
CVTASCRL EQU   CVTS01+92                                                02168000
CVTASCRF EQU   CVTS01+88                                                02169000
CVTRV326 EQU   CVTS01+84                                                02170000
CVTRV325 EQU   CVTS01+80                                                02171000
CVTRV324 EQU   CVTS01+76                                                02172000
CVT0VL01 EQU   CVTS01+72                                                02173000
CVTSHRVM EQU   CVTS01+68                                                02174000
CVTRV332 EQU   CVTS01+64                                                02175000
CVTTAS   EQU   CVTS01+60                                                02176000
CVTRSCN  EQU   CVTS01+56                                                02177000
CVTTRAC2 EQU   CVTS01+54                                                02178000
CVTTRACE EQU   CVTS01+52                                                02179000
CVTAPG   EQU   CVTS01+51                                                02180000
CVTSDTRC EQU   CVTCTLFG                                                 02181000
CVTGTRCE EQU   CVTCTLFG                                                 02182000
CVTNOMP  EQU   CVTCTLFG                                                 02183000
CVTRSV79 EQU   CVTCTLFG                                                 02184000
CVTDSTAT EQU   CVTCTLFG                                                 02185000
CVTRSV78 EQU   CVTCTLFG                                                 02186000
CVTRV333 EQU   CVTCTLFG                                                 02187000
CVTRV323 EQU   CVTCTLFG                                                 02188000
CVTSPVLK EQU   CVTS01+49                                                02189000
CVTRSV77 EQU   CVTS01+48                                                02190000
CVTRV331 EQU   CVTS01+44                                                02191000
CVTRV330 EQU   CVTS01+40                                                02192000
CVTRV329 EQU   CVTS01+36                                                02193000
CVTRV328 EQU   CVTS01+32                                                02194000
CVTRV322 EQU   CVTS01+28                                                02195000
CVTSLID  EQU   CVTSLIDA+1                                               02196000
CVTSYLK  EQU   CVTSLIDA                                                 02197000
CVTRV321 EQU   CVTS01+20                                                02198000
CVTRV320 EQU   CVTS01+16                                                02199000
CVTLPDIR EQU   CVTLPDIA+1                                               02200000
CVTRSV69 EQU   CVTDIRST                                                 02201000
CVTRSV68 EQU   CVTDIRST                                                 02202000
CVTRSV67 EQU   CVTDIRST                                                 02203000
CVTRSV66 EQU   CVTDIRST                                                 02204000
CVTRSV65 EQU   CVTDIRST                                                 02205000
CVTRSV64 EQU   CVTDIRST                                                 02206000
CVTRSV63 EQU   CVTDIRST                                                 02207000
CVTDICOM EQU   CVTDIRST                                                 02208000
CVTPVTP  EQU   CVTS01+8                                                 02209000
CVTLPDSR EQU   CVTS01+4                                                 02210000
CVTGETL  EQU   CVTS01                                                   02211000
@NM00064 EQU   QELOUT+83                                                02212000
@NM00063 EQU   QELOUT+75                                                02213000
@NM00062 EQU   QELOUT+71                                                02214000
@NM00061 EQU   QELOUT+63                                                02215000
@NM00060 EQU   QELOUT+58                                                02216000
@NM00059 EQU   QELOUT+52                                                02217000
@NM00058 EQU   QELOUT+46                                                02218000
@NM00057 EQU   QELOUT+36                                                02219000
@NM00056 EQU   QELOUT+28                                                02220000
@NM00055 EQU   QELOUT+23                                                02221000
@NM00054 EQU   QELOUT+15                                                02222000
@NM00053 EQU   QELOUT                                                   02223000
@NM00052 EQU   MINOROUT+85                                              02224000
@NM00051 EQU   MINOROUT+44                                              02225000
@NM00050 EQU   MINOROUT+39                                              02226000
@NM00049 EQU   MINOROUT+33                                              02227000
@NM00048 EQU   MINOROUT+27                                              02228000
@NM00047 EQU   MINOROUT+19                                              02229000
@NM00046 EQU   MINOROUT+11                                              02230000
@NM00045 EQU   MINOROUT                                                 02231000
@NM00044 EQU   MAJOROUT+38                                              02232000
@NM00042 EQU   MAJOROUT+20                                              02233000
@NM00041 EQU   MAJOROUT+13                                              02234000
@NM00040 EQU   MAJOROUT+5                                               02235000
QELWCNT  EQU   QEL+22                                                   02236000
QELLCNT  EQU   QEL+20                                                   02237000
@NM00016 EQU   QELLFLGS                                                 02238000
@NM00015 EQU   QELLFLGS                                                 02239000
@NM00014 EQU   QELLFLGS                                                 02240000
@NM00013 EQU   QELLFLGS                                                 02241000
@NM00012 EQU   QELLFLGS                                                 02242000
@NM00011 EQU   QELLFLGS                                                 02243000
QELECBF  EQU   QELLFLGS                                                 02244000
QELPOST  EQU   QELLFLGS                                                 02245000
@NM00010 EQU   QELQFLGS                                                 02246000
@NM00009 EQU   QELQFLGS                                                 02247000
@NM00008 EQU   QELQFLGS                                                 02248000
QELAUTH  EQU   QELQFLGS                                                 02249000
@NM00007 EQU   MINFLGS                                                  02250000
@NM00006 EQU   MINFLGS                                                  02251000
@NM00005 EQU   MINFLGS                                                  02252000
@NM00004 EQU   MINFLGS                                                  02253000
MINNOENQ EQU   MINFLGS                                                  02254000
CVTLEVL  EQU   CVTRELNO+2                                               02255000
CVTNUMB  EQU   CVTRELNO                                                 02256000
CVTMDL   EQU   CVTFIX+250                                               02257000
@NM00003 EQU   CVTFIX+248                                               02258000
@NM00002 EQU   CVTFIX                                                   02259000
CVTRV482 EQU   CVTXTNT2+128                                             02260000
CVTRV481 EQU   CVTXTNT2+124                                             02261000
CVTRV480 EQU   CVTXTNT2+120                                             02262000
CVTRV479 EQU   CVTXTNT2+118                                             02263000
CVTRV478 EQU   CVTXTNT2+117                                             02264000
CVTRV477 EQU   CVTXTNT2+116                                             02265000
CVTRV476 EQU   CVTXTNT2+115                                             02266000
CVTRV475 EQU   CVTXTNT2+114                                             02267000
CVTRV474 EQU   CVTRV466                                                 02268000
CVTRV473 EQU   CVTRV466                                                 02269000
CVTRV472 EQU   CVTRV466                                                 02270000
CVTRV471 EQU   CVTRV466                                                 02271000
CVTRV470 EQU   CVTRV466                                                 02272000
CVTRV469 EQU   CVTRV466                                                 02273000
CVTRV468 EQU   CVTRV466                                                 02274000
CVTRV467 EQU   CVTRV466                                                 02275000
CVTRV465 EQU   CVTRV457                                                 02276000
CVTRV464 EQU   CVTRV457                                                 02277000
CVTRV463 EQU   CVTRV457                                                 02278000
CVTRV462 EQU   CVTRV457                                                 02279000
CVTRV461 EQU   CVTRV457                                                 02280000
CVTRV460 EQU   CVTRV457                                                 02281000
CVTRV459 EQU   CVTRV457                                                 02282000
CVTRV458 EQU   CVTRV457                                                 02283000
CVTRV456 EQU   CVTXTNT2+108                                             02284000
CVTRV455 EQU   CVTXTNT2+104                                             02285000
CVTRV454 EQU   CVTXTNT2+100                                             02286000
CVTRV453 EQU   CVTXTNT2+96                                              02287000
CVTRV452 EQU   CVTXTNT2+94                                              02288000
CVTRV451 EQU   CVTXTNT2+92                                              02289000
CVTRV450 EQU   CVTXTNT2+90                                              02290000
CVTRV449 EQU   CVTXTNT2+88                                              02291000
CVTRV448 EQU   CVTXTNT2+87                                              02292000
CVTRV447 EQU   CVTXTNT2+86                                              02293000
CVTRV446 EQU   CVTRV438                                                 02294000
CVTRV445 EQU   CVTRV438                                                 02295000
CVTRV444 EQU   CVTRV438                                                 02296000
CVTRV443 EQU   CVTRV438                                                 02297000
CVTRV442 EQU   CVTRV438                                                 02298000
CVTRV441 EQU   CVTRV438                                                 02299000
CVTRV440 EQU   CVTRV438                                                 02300000
CVTRV439 EQU   CVTRV438                                                 02301000
CVTRV437 EQU   CVTRV429                                                 02302000
CVTRV436 EQU   CVTRV429                                                 02303000
CVTRV435 EQU   CVTRV429                                                 02304000
CVTRV434 EQU   CVTRV429                                                 02305000
CVTRV433 EQU   CVTRV429                                                 02306000
CVTRV432 EQU   CVTRV429                                                 02307000
CVTRV431 EQU   CVTRV429                                                 02308000
CVTRV430 EQU   CVTRV429                                                 02309000
CVTRV428 EQU   CVTXTNT2+80                                              02310000
CVTRV427 EQU   CVTXTNT2+76                                              02311000
CVTRV426 EQU   CVTXTNT2+72                                              02312000
CVTRV425 EQU   CVTXTNT2+68                                              02313000
CVTATACT EQU   CVTATCVT                                                 02314000
CVTRV423 EQU   CVTXTNT2+62                                              02315000
CVTRV422 EQU   CVTXTNT2+60                                              02316000
CVTRV421 EQU   CVTXTNT2+58                                              02317000
CVTRV420 EQU   CVTXTNT2+56                                              02318000
CVTRV419 EQU   CVTXTNT2+55                                              02319000
CVTRV418 EQU   CVTXTNT2+54                                              02320000
CVTRV417 EQU   CVTRV409                                                 02321000
CVTRV416 EQU   CVTRV409                                                 02322000
CVTRV415 EQU   CVTRV409                                                 02323000
CVTRV414 EQU   CVTRV409                                                 02324000
CVTRV413 EQU   CVTRV409                                                 02325000
CVTRV412 EQU   CVTRV409                                                 02326000
CVTRV411 EQU   CVTRV409                                                 02327000
CVTRV410 EQU   CVTRV409                                                 02328000
CVTRV408 EQU   CVTRV400                                                 02329000
CVTRV407 EQU   CVTRV400                                                 02330000
CVTRV406 EQU   CVTRV400                                                 02331000
CVTRV405 EQU   CVTRV400                                                 02332000
CVTRV404 EQU   CVTRV400                                                 02333000
CVTRV403 EQU   CVTRV400                                                 02334000
CVTRV402 EQU   CVTRV400                                                 02335000
CVTRV401 EQU   CVTRV400                                                 02336000
CVTICB   EQU   CVTXTNT2+48                                              02337000
CVTSKTA  EQU   CVTXTNT2+44                                              02338000
CVTCCVT  EQU   CVTXTNT2+40                                              02339000
CVTRSV98 EQU   CVTXTNT2+36                                              02340000
CVTRSV97 EQU   CVTXTNT2+34                                              02341000
CVTRSV96 EQU   CVTXTNT2+32                                              02342000
CVTOLTEP EQU   CVTXTNT2+28                                              02343000
CVTQIDA  EQU   CVTQID+1                                                 02344000
CVTRSV95 EQU   CVTQID                                                   02345000
CVTRSV94 EQU   CVTXTNT2+20                                              02346000
CVTRSV93 EQU   CVTXTNT2+16                                              02347000
CVTRSV92 EQU   CVTXTNT2+12                                              02348000
CVTDEBVR EQU   CVTXTNT2+8                                               02349000
CVTRSV91 EQU   CVTXTNT2+6                                               02350000
CVTRSV9H EQU   CVTFLGBT                                                 02351000
CVTRSV9G EQU   CVTFLGBT                                                 02352000
CVTRSV9F EQU   CVTFLGBT                                                 02353000
CVTRSV9E EQU   CVTFLGBT                                                 02354000
CVTRSV9D EQU   CVTFLGBT                                                 02355000
CVTRSV9C EQU   CVTFLGBT                                                 02356000
CVTVME   EQU   CVTFLGBT                                                 02357000
CVTNPE   EQU   CVTFLGBT                                                 02358000
CVTNUCLS EQU   CVTXTNT2+4                                               02359000
CVTDSSVA EQU   CVTDSSV+1                                                02360000
CVTRSV89 EQU   CVTDSSV                                                  02361000
CVTRSV88 EQU   CVTXTNT1+8                                               02362000
CVTRSV87 EQU   CVTXTNT1+4                                               02363000
CVTFACHN EQU   CVTXTNT1                                                 02364000
CVTRV488 EQU   CVTMAP+412                                               02365000
CVTRV487 EQU   CVTMAP+408                                               02366000
CVTRV486 EQU   CVTMAP+404                                               02367000
CVTRV485 EQU   CVTMAP+400                                               02368000
CVTACTAP EQU   CVTMAP+396                                               02369000
CVTAUTH  EQU   CVTMAP+392                                               02370000
CVTATMCA EQU   CVTATMCT+1                                               02371000
CVTATMST EQU   CVTATMCT                                                 02372000
CVTRSV61 EQU   CVTMAP+384                                               02373000
CVTVOLT1 EQU   CVTVOLM1+1                                               02374000
CVTVOLI1 EQU   CVTVOLF1                                                 02375000
CVTSTOA  EQU   CVTMAP+376                                               02376000
CVTRSV58 EQU   CVTMAP+374                                               02377000
CVTRSV57 EQU   CVTMAP+372                                               02378000
CVTDDCE  EQU   CVTMAP+368                                               02379000
CVTPNWFR EQU   CVTMAP+364                                               02380000
CVTSMF   EQU   CVTMAP+360                                               02381000
CVTSULK  EQU   CVTMAP+358                                               02382000
CVTSLKO  EQU   CVTSYSK                                                  02383000
CVTSLKP  EQU   CVTSYSK                                                  02384000
CVTSLKQ  EQU   CVTSYSK                                                  02385000
CVTSLKR  EQU   CVTSYSK                                                  02386000
CVTRSV56 EQU   CVTSYSK                                                  02387000
CVTRSV55 EQU   CVTSYSK                                                  02388000
CVTRSV54 EQU   CVTSYSK                                                  02389000
CVTRSV53 EQU   CVTSYSK                                                  02390000
CVTRSV52 EQU   CVTA1F1                                                  02391000
CVTRSV51 EQU   CVTA1F1                                                  02392000
CVTRSV50 EQU   CVTA1F1                                                  02393000
CVTRSV49 EQU   CVTA1F1                                                  02394000
CVTRSV48 EQU   CVTA1F1                                                  02395000
CVTRSV47 EQU   CVTA1F1                                                  02396000
CVTSRSW  EQU   CVTA1F1                                                  02397000
CVTPFSW  EQU   CVTA1F1                                                  02398000
CVTPCVT  EQU   CVTMAP+352                                               02399000
CVTRSV46 EQU   CVTMAP+344                                               02400000
CVTRSV45 EQU   CVTMAP+340                                               02401000
CVTRSV44 EQU   CVTMAP+338                                               02402000
CVTRSV43 EQU   CVTMAP+336                                               02403000
CVTHJESA EQU   CVTHJES+1                                                02404000
CVTRSV42 EQU   CVTHJES                                                  02405000
CVTEXT2A EQU   CVTEXT2+1                                                02406000
CVTRSV41 EQU   CVTEXT2                                                  02407000
CVTAPFA  EQU   CVTAPF+1                                                 02408000
CVTRSV40 EQU   CVTAPF                                                   02409000
CVTRV518 EQU   CVTINTLA                                                 02410000
CVTRV517 EQU   CVTERPV                                                  02411000
CVTEORM  EQU   CVTMAP+312                                               02412000
CVTMCHPR EQU   CVTMAP+308                                               02413000
CVTTZ    EQU   CVTMAP+304                                               02414000
CVTJEPS  EQU   CVTMAP+300                                               02415000
CVTJESCT EQU   CVTMAP+296                                               02416000
CVTMODE  EQU   CVTMAP+292                                               02417000
CVTPTRV  EQU   CVTMAP+288                                               02418000
CVTREAL  EQU   CVTMAP+284                                               02419000
CVTRSV39 EQU   CVTMAP+280                                               02420000
CVTRSV38 EQU   CVTMAP+276                                               02421000
CVTDMSRA EQU   CVTDMSR+1                                                02422000
CVTRV634 EQU   CVTDMSRF                                                 02423000
CVTRV633 EQU   CVTDMSRF                                                 02424000
CVTRV632 EQU   CVTDMSRF                                                 02425000
CVTRV631 EQU   CVTDMSRF                                                 02426000
CVTRV630 EQU   CVTDMSRF                                                 02427000
CVTRV629 EQU   CVTDMSRF                                                 02428000
CVTUDUMP EQU   CVTDMSRF                                                 02429000
CVTSDUMP EQU   CVTDMSRF                                                 02430000
CVTQMSGA EQU   CVTQMSG+1                                                02431000
CVTRSV36 EQU   CVTQMSG                                                  02432000
CVTAMFF  EQU   CVTMAP+264                                               02433000
CVTPURGA EQU   CVTPURG+1                                                02434000
CVTRSV35 EQU   CVTPURG                                                  02435000
CVTCBSP  EQU   CVTMAP+256                                               02436000
CVTATERA EQU   CVTATER+1                                                02437000
CVTSYST  EQU   CVTATER                                                  02438000
CVTVOLT2 EQU   CVTTAT                                                   02439000
CVTVOLI2 EQU   CVTVOLF2                                                 02440000
CVTAQAVB EQU   CVTAQAVT+1                                               02441000
CVTRSV34 EQU   CVTTCMFG                                                 02442000
CVTRSV33 EQU   CVTTCMFG                                                 02443000
CVTRSV32 EQU   CVTTCMFG                                                 02444000
CVTRSV31 EQU   CVTTCMFG                                                 02445000
CVTRSV30 EQU   CVTTCMFG                                                 02446000
CVTRSV29 EQU   CVTTCMFG                                                 02447000
CVTRSV28 EQU   CVTTCMFG                                                 02448000
CVTTCRDY EQU   CVTTCMFG                                                 02449000
CVTGTFA  EQU   CVTGTF+1                                                 02450000
CVTRSV27 EQU   CVTGTFST                                                 02451000
CVTRNIO  EQU   CVTGTFST                                                 02452000
CVTUSR   EQU   CVTGTFST                                                 02453000
CVTRV318 EQU   CVTFORM                                                  02454000
CVTRV317 EQU   CVTTMODE                                                 02455000
CVTRV316 EQU   CVTSTATE                                                 02456000
CVTRV315 EQU   CVTGTFS                                                  02457000
CVTGTFAV EQU   CVTGTFS                                                  02458000
CVT0SCR1 EQU   CVTMAP+232                                               02459000
CVTRV515 EQU   CVTMAP+228                                               02460000
CVTRMS   EQU   CVTMAP+224                                               02461000
CVTPATCH EQU   CVTMAP+220                                               02462000
CVTTSCE  EQU   CVTMAP+216                                               02463000
CVTLNKSC EQU   CVTMAP+214                                               02464000
CVTQABST EQU   CVTMAP+212                                               02465000
CVTMDLDS EQU   CVTMAP+208                                               02466000
CVTUSER  EQU   CVTMAP+204                                               02467000
CVTABEND EQU   CVTMAP+200                                               02468000
CVTSMCA  EQU   CVTMAP+196                                               02469000
CVTRSV18 EQU   CVTMAP+192                                               02470000
CVTQLPAQ EQU   CVTMAP+188                                               02471000
CVTQCDSR EQU   CVTMAP+184                                               02472000
CVTRSV17 EQU   CVTOPTB                                                  02473000
CVTRSV16 EQU   CVTOPTB                                                  02474000
CVTFP    EQU   CVTOPTB                                                  02475000
CVTAPTHR EQU   CVTOPTB                                                  02476000
CVTNLOG  EQU   CVTOPTB                                                  02477000
CVTTOD   EQU   CVTOPTB                                                  02478000
CVTCTIMS EQU   CVTOPTB                                                  02479000
CVTPROT  EQU   CVTOPTB                                                  02480000
CVTXPFP  EQU   CVTOPTA                                                  02481000
CVTASCII EQU   CVTOPTA                                                  02482000
CVTRSV13 EQU   CVTOPTA                                                  02483000
CVTRSV12 EQU   CVTOPTA                                                  02484000
CVTNIP   EQU   CVTOPTA                                                  02485000
CVTDDR   EQU   CVTOPTA                                                  02486000
CVTAPR   EQU   CVTOPTA                                                  02487000
CVTCCH   EQU   CVTOPTA                                                  02488000
CVTSNCTR EQU   CVTMAP+180                                               02489000
CVTQMWR  EQU   CVTMAP+176                                               02490000
CVTQOCR  EQU   CVTMAP+172                                               02491000
CVT1EF00 EQU   CVTMAP+168                                               02492000
CVTMZ00  EQU   CVTMAP+164                                               02493000
CVTSV76Q EQU   CVTSV76C                                                 02494000
CVTRSV11 EQU   CVTMAP+156                                               02495000
CVT0PT01 EQU   CVTMAP+152                                               02496000
CVTMSER  EQU   CVTMAP+148                                               02497000
CVTRV516 EQU   CVTIERLC                                                 02498000
CVTILCH  EQU   CVTMAP+140                                               02499000
CVT0DS   EQU   CVTMAP+136                                               02500000
CVTFBOSV EQU   CVTMAP+132                                               02501000
CVTNUCB  EQU   CVTMAP+128                                               02502000
CVTIXAVL EQU   CVTMAP+124                                               02503000
CVTSV76M EQU   CVTIOQET                                                 02504000
CVTDCBA  EQU   CVTMAP+117                                               02505000
CVTMVS2  EQU   CVTDCB                                                   02506000
CVT6DAT  EQU   CVTDCB                                                   02507000
CVT4MPS  EQU   CVTDCB                                                   02508000
CVTRSV09 EQU   CVTDCB                                                   02509000
CVT4MS1  EQU   CVTDCB                                                   02510000
CVT2SPS  EQU   CVTDCB                                                   02511000
CVT1SSS  EQU   CVTDCB                                                   02512000
CVTRSV08 EQU   CVTDCB                                                   02513000
CVTSTB   EQU   CVTMAP+112                                               02514000
CVTQTD00 EQU   CVTMAP+108                                               02515000
CVTQTE00 EQU   CVTMAP+104                                               02516000
CVTCUCB  EQU   CVTMAP+100                                               02517000
CVTSJQ   EQU   CVTMAP+96                                                02518000
CVTPBLDL EQU   CVTMAP+92                                                02519000
CVTTPC   EQU   CVTMAP+88                                                02520000
CVTSVDCB EQU   CVTMAP+84                                                02521000
CVTBRET  EQU   CVTMAP+82                                                02522000
CVTEXIT  EQU   CVTMAP+80                                                02523000
CVT0FN00 EQU   CVTMAP+76                                                02524000
CVTDARA  EQU   CVTDAR+1                                                 02525000
CVTRSV07 EQU   CVTFLGS1                                                 02526000
CVTRSV06 EQU   CVTFLGS1                                                 02527000
CVTRSV05 EQU   CVTFLGS1                                                 02528000
CVTRSV04 EQU   CVTFLGS1                                                 02529000
CVTRSV03 EQU   CVTFLGS1                                                 02530000
CVTRSV02 EQU   CVTFLGS1                                                 02531000
CVTRSV01 EQU   CVTFLGS1                                                 02532000
CVTDMPLK EQU   CVTFLGS1                                                 02533000
CVTXITP  EQU   CVTMAP+68                                                02534000
CVTZDTAB EQU   CVTMAP+64                                                02535000
CVTMSLT  EQU   CVTMAP+60                                                02536000
CVTDATE  EQU   CVTMAP+56                                                02537000
CVTBTERM EQU   CVTMAP+52                                                02538000
CVTSYSAD EQU   CVTMAP+48                                                02539000
CVTXTLER EQU   CVTMAP+44                                                02540000
CVTILK2  EQU   CVTMAP+40                                                02541000
CVTILK1  EQU   CVTMAP+36                                                02542000
CVTPRLTV EQU   CVTMAP+32                                                02543000
CVTPCNVT EQU   CVTMAP+28                                                02544000
CVT0VL00 EQU   CVTMAP+24                                                02545000
CVTXAPG  EQU   CVTMAP+20                                                02546000
CVTBUF   EQU   CVTMAP+16                                                02547000
CVTJOB   EQU   CVTMAP+12                                                02548000
CVTLINK  EQU   CVTMAP+8                                                 02549000
CVT0EF00 EQU   CVTMAP+4                                                 02550000
CVTTCBP  EQU   CVTMAP                                                   02551000
CVT      EQU   CVTMAP                                                   02552000
ADPLEXT  EQU   ABDPL+52                                                 02553000
ADPLFMT2 EQU   ABDPL+48                                                 02554000
ADPLFMT1 EQU   ABDPL+44                                                 02555000
ADPLCOM4 EQU   ABDPL+40                                                 02556000
ADPLCOM3 EQU   ABDPL+36                                                 02557000
ADPLCOM2 EQU   ABDPL+32                                                 02558000
ADPLCOM1 EQU   ABDPL+28                                                 02559000
ADPLFRMT EQU   ABDPL+24                                                 02560000
@NM00001 EQU   ADPLFLAG                                                 02561000
ADPLSYTM EQU   ADPLFLAG                                                 02562000
ADPLSNPR EQU   ADPLFLAG                                                 02563000
ADPLASID EQU   ABDPL+4                                                  02564000
ADPLTCB  EQU   ABDPL                                                    02565000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      02566000
@RC00061 EQU   @RC00044                                                 02567000
@RC00219 EQU   @RC00218                                                 02568000
@RF00227 EQU   @EL00003                                                 02569000
@RC00357 EQU   @RC00294                                                 02570000
@RC00316 EQU   @RC00294                                                 02571000
@RC00377 EQU   @RC00376                                                 02572000
@RF00385 EQU   @EL00004                                                 02573000
@RC00470 EQU   @RC00469                                                 02574000
@RC00491 EQU   @RC00487                                                 02575000
@RC00529 EQU   @RC00451                                                 02576000
@RC00527 EQU   @RC00451                                                 02577000
@RC00545 EQU   @RC00544                                                 02578000
@RF00553 EQU   @EL00005                                                 02579000
@PB00006 EQU   @PB00007                                                 02580000
@RC00066 EQU   @RC00061                                                 02581000
@RC00324 EQU   @RC00316                                                 02582000
@RC00474 EQU   @RC00470                                                 02583000
@PB00005 EQU   @PB00006                                                 02584000
@RC00069 EQU   @RC00066                                                 02585000
@PB00004 EQU   @PB00005                                                 02586000
@PB00003 EQU   @PB00004                                                 02587000
@PB00002 EQU   @PB00003                                                 02588000
@ENDDATA EQU   *                                                        02589000
         END   AMDPRQCB,(C'PLS2008',0701,78235)                         02590000
