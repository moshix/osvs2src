         TITLE 'AMDPRSEG - SEGMENT LOAD ROUTINE                        *00001000
                        '                                               00002000
AMDPRSEG CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(19)                                             0001 00007000
         DC    C'AMDPRSEGR0300076209'                              0001 00008000
         DROP  @15                                                      00009000
@PROLOG  ST    @14,12(,@13)                                        0001 00010000
         ST    @00,20(,@13)                                        0001 00011000
         STM   @02,@12,28(@13)                                     0001 00012000
         BALR  @10,0                                               0001 00013000
@PSTART  DS    0H                                                  0001 00014000
         USING @PSTART,@10                                         0001 00015000
         ST    @13,@SA00001+4                                      0001 00016000
         LA    @14,@SA00001                                        0001 00017000
         ST    @14,8(,@13)                                         0001 00018000
         LR    @13,@14                                             0001 00019000
    SYNEPS                                                              00020000
    USING  SYNTAX,R15              BASE EP-S OF AMDPRSYN         S21014 00021000
AMDPRSEG CSECT                                                          00022000
*   LISTBASE=REG1;                  /* SAVE P-LIST POINTER           */ 00023000
         ST    REG1,LISTBASE                                       0081 00024000
*   SYNMSGA=ADDR(AMDPRP01);         /* POINT TO MESSAGE ARRAY S21014 */ 00025000
         L     @11,@CA00090                                        0082 00026000
         ST    @11,SYNMSGA(,COMBASE)                               0082 00027000
*   LOADSEC='0'B;                   /* TURN OFF SW. THAT INDICATES 0083 00028000
*                                      SECONDARY LOAD FUNCT          */ 00029000
*   LOADEXIT='0'B;                  /* TURN OFF SW. THAT INDICATES 0084 00030000
*                                      EXIT LOAD FUNCT.              */ 00031000
*   ALLMODIN='0'B;                  /* TURN OFF SW THAT INDICATES  0085 00032000
*                                      THAT NO MODULES NEED LOADING     00033000
*                                                              X01980*/ 00034000
         NI    LOADSEC,B'01001111'                                 0085 00035000
*INIT:                                                             0086 00036000
*   IF INITSW='1'B THEN                                            0086 00037000
INIT     TM    INITSW,B'01000000'                                  0086 00038000
         BO    @RT00086                                            0086 00039000
*     GO TO TYPELOAD;                                              0087 00040000
*   STORSIZE=(STORSIZE+65535)&(-65536);/* ROUND TO NEXT 64K          */ 00041000
         L     @11,@CF01123                                        0088 00042000
         AL    @11,STORSIZE(,COMBASE)                              0088 00043000
         N     @11,@CF01124                                        0088 00044000
         ST    @11,STORSIZE(,COMBASE)                              0088 00045000
*   IF STORSIZE>262144 THEN         /* ASSURE STORSIZE NOT TOO Y02006*/ 00046000
         L     @03,@CF01125                                        0089 00047000
         CR    @11,@03                                             0089 00048000
         BNH   @RF00089                                            0089 00049000
*     STORSIZE=262144;              /* LARGE                   Y02006*/ 00050000
         ST    @03,STORSIZE(,COMBASE)                              0090 00051000
*   MODCT=0;                        /* INIT IN-CORE MODULE COUNT TO 0*/ 00052000
@RF00089 SLR   @11,@11                                             0091 00053000
         ST    @11,MODCT                                           0091 00054000
*   LPACT=0;                        /* INIT # OF MODULES IN LPA TABLE   00055000
*                                      TO ZERO                       */ 00056000
         ST    @11,LPACT                                           0092 00057000
*   INITSW='1'B;                    /* FLAG INIT AS COMPLETE       0093 00058000
*                                      INITIALIZATION COMPLETE       */ 00059000
         OI    INITSW,B'01000000'                                  0093 00060000
*TYPELOAD:                                                         0094 00061000
*   IF LISTPTR<0 THEN                                              0094 00062000
TYPELOAD L     @11,LISTPTR                                         0094 00063000
         LTR   @11,@11                                             0094 00064000
         BNM   @RF00094                                            0094 00065000
*SECNLOAD:                                                         0095 00066000
*     DO;                                                          0095 00067000
SECNLOAD DS    0H                                                  0096 00068000
*       LOADCT=1;                   /* SET UP TO LOAD ONE MODULE     */ 00069000
         MVC   LOADCT(4),@CF00034                                  0096 00070000
*       LOADSEC='1'B;               /* INDICATE SECONDARY LOAD     0097 00071000
*                                      OPERATION                     */ 00072000
         OI    LOADSEC,B'10000000'                                 0097 00073000
*       IF HIBYTE='80'X THEN        /* IS THIS AN EXIT LOAD          */ 00074000
         CLI   HIBYTE,X'80'                                        0098 00075000
         BNE   @RF00098                                            0098 00076000
*XITLOD:                                                           0099 00077000
*         DO;                                                      0099 00078000
XITLOD   DS    0H                                                  0100 00079000
*           LOADEXIT='1'B;          /* INDICATE EXIT LOAD FUNCT.     */ 00080000
         OI    LOADEXIT,B'00100000'                                0100 00081000
*           HIBYTE='00'X;                                          0101 00082000
         MVI   HIBYTE,X'00'                                        0101 00083000
*           REG1=LISTBASE;          /* SET UP BASE FOR REQMODNM      */ 00084000
         L     @11,LISTBASE                                        0102 00085000
         LR    REG1,@11                                            0102 00086000
*           IF REQMODNM=XNAME THEN  /* IF MODULE IS IN               */ 00087000
         CLC   REQMODNM(8,REG1),XNAME                              0103 00088000
         BE    @RT00103                                            0103 00089000
*             GOTO XITENPT;         /* GO GET ENTRY PT. AND RETURN TO   00090000
*                                      CALLER                        */ 00091000
*           LISTBASE=-LISTBASE;     /* SET UP SO SOME COMMON CODE CAN   00092000
*                                      BE US ED                      */ 00093000
         LCR   @11,@11                                             0105 00094000
         ST    @11,LISTBASE                                        0105 00095000
*           GOTO BLDL;                                             0106 00096000
         B     BLDL                                                0106 00097000
*         END;                                                     0107 00098000
*       REG1=-LISTBASE;             /* GET POINTER TO REQUESTED NAME */ 00099000
@RF00098 L     REG1,LISTBASE                                       0108 00100000
         LCR   REG1,REG1                                           0108 00101000
*       FORMNUM2=49152;             /* SET LIMIT FOR EXTERNAL EDIT   */ 00102000
         MVC   FORMNUM2(4),@CF01133                                0109 00103000
*       IF EDITSW='1'B THEN         /* IF EDIT IN PROCESS USE  Y02006*/ 00104000
         TM    EDITSW(COMBASE),B'00001000'                         0110 00105000
         BO    @RT00110                                            0110 00106000
*         GOTO SETLIMIT;            /* LIMITNO1                Y02006*/ 00107000
*       FORMNUM2=16384;             /* SET LIMIT FOR INTERNAL EDIT   */ 00108000
         MVC   FORMNUM2(4),@CF01135                                0112 00109000
*SETLIMIT:                          /* CALCULATE SECONDARY MOD LIMIT */ 00110000
*       LIMIT=30720+(STORSIZE/65536-2)*FORMNUM2-EXITSIZE;/* COMPARE     00111000
*                                      TO SEE IF REQUESTED MODULE IS    00112000
*                                      ALREADY IN CORE               */ 00113000
SETLIMIT L     @04,STORSIZE(,COMBASE)                              0113 00114000
         SRDA  @04,32                                              0113 00115000
         D     @04,@CF01137                                        0113 00116000
         BCTR  @05,0                                               0113 00117000
         BCTR  @05,0                                               0113 00118000
         M     @04,FORMNUM2                                        0113 00119000
         AH    @05,@CH01136                                        0113 00120000
         SL    @05,EXITSIZE                                        0113 00121000
         ST    @05,LIMIT                                           0113 00122000
*       DO LISTAD=SECLOAD TO MODCT; /* S21014                        */ 00123000
         L     @11,SECLOAD                                         0114 00124000
         B     @DE00114                                            0114 00125000
@DL00114 DS    0H                                                  0115 00126000
*         CALL INQ;                 /* GET A LIST ENTRY S21014       */ 00127000
         BAL   @14,INQ                                             0115 00128000
*         IF LOADNAME=REQMODNM THEN /* S21014                        */ 00129000
         CLC   LOADNAME(8,REG2),REQMODNM(REG1)                     0116 00130000
         BE    @RT00116                                            0116 00131000
*           GO TO INCORE;           /* RETURN CLEAN IF MODULE S21014    00132000
*                                      IS IN ALREADY S21014          */ 00133000
*       END;                                                       0118 00134000
         LA    @11,1                                               0118 00135000
         AL    @11,LISTAD                                          0118 00136000
@DE00114 ST    @11,LISTAD                                          0118 00137000
         C     @11,MODCT                                           0118 00138000
         BNH   @DL00114                                            0118 00139000
*CHKLPA:                                                           0119 00140000
*                                                                  0119 00141000
*       /*************************************************************/ 00142000
*       /*                                                           */ 00143000
*       /* SEARCH LPA TO SEE IF MODULE IS IN THE LINK PACK AREA      */ 00144000
*       /*                                                           */ 00145000
*       /*************************************************************/ 00146000
*                                                                  0119 00147000
*       SECMODNM=REQMODNM;          /* SAVE MODULE NAME       @Y02014*/ 00148000
CHKLPA   MVC   SECMODNM(8),REQMODNM(REG1)                          0119 00149000
*       SAVER1=REG1;                /* SAVE REGISTER 1        @Y02014*/ 00150000
         ST    REG1,SAVER1                                         0120 00151000
*       LPAPTR=ADDR(LPATBL);        /* INITIALIZE TABLE PTR   @Y02014*/ 00152000
         LA    @11,LPATBL                                          0121 00153000
         ST    @11,LPAPTR                                          0121 00154000
*       IF LPACT^=0 THEN            /* CHECK IF ANY NAMES IN TABLE 0122 00155000
*                                                             @Y02014*/ 00156000
         L     @11,LPACT                                           0122 00157000
         LTR   @11,@11                                             0122 00158000
         BZ    @RF00122                                            0122 00159000
*         DO I=1 TO LPACT;          /* YES - SEARCH TABLE FOR MOD  0123 00160000
*                                                             @Y02014*/ 00161000
         LA    @11,1                                               0123 00162000
         B     @DE00123                                            0123 00163000
@DL00123 DS    0H                                                  0124 00164000
*           IF REQMODNM=LPAMODNM THEN/* MODULE FOUND IN TAB   @Y02014*/ 00165000
         L     @11,LPAPTR                                          0124 00166000
         CLC   REQMODNM(8,REG1),LPAMODNM(@11)                      0124 00167000
         BNE   @RF00124                                            0124 00168000
*             DO;                   /*                        @Y02014*/ 00169000
*               REG1=LPAEP;         /* GET ENTRY POINT ADDRESS     0126 00170000
*                                                             @Y02014*/ 00171000
         L     REG1,LPAEP(,@11)                                    0126 00172000
*               RFY                                                0127 00173000
*                 REG15 RSTD;       /*                        @Y02014*/ 00174000
*               REG15=0;            /* SET RETURN CODE        @Y02014*/ 00175000
         SLR   REG15,REG15                                         0128 00176000
*               GOTO SEGRET;        /* RETURN TO CALLER OZ12026      */ 00177000
         B     SEGRET                                              0129 00178000
*               RFY                                                0130 00179000
*                 REG15 UNRSTD;     /*                        @Y02014*/ 00180000
*             END;                  /*                        @Y02104*/ 00181000
*           ELSE                                                   0132 00182000
*             LPAPTR=LPAPTR+LENGTH(LPAMOD);/* UPDATE POINTER TO TABLE   00183000
*                                      ENTRY                  @Y02014*/ 00184000
@RF00124 LA    @11,12                                              0132 00185000
         AL    @11,LPAPTR                                          0132 00186000
         ST    @11,LPAPTR                                          0132 00187000
*         END;                      /*                        @Y02014*/ 00188000
         LA    @11,1                                               0133 00189000
         AL    @11,I                                               0133 00190000
@DE00123 ST    @11,I                                               0133 00191000
         C     @11,LPACT                                           0133 00192000
         BNH   @DL00123                                            0133 00193000
*       LPAPTR=ADDR(LPATBL)+LPACT*LENGTH(LPAMOD);/* GET NEXT       0134 00194000
*                                      AVAILABLE SLOT IN TABLE     0134 00195000
*                                                             @Y02014*/ 00196000
@RF00122 LA    @11,LPATBL                                          0134 00197000
         L     @03,LPACT                                           0134 00198000
         MH    @03,@CH00100                                        0134 00199000
         ALR   @11,@03                                             0134 00200000
         ST    @11,LPAPTR                                          0134 00201000
*       RFY                                                        0135 00202000
*         REG3 RSTD;                /*                        @Y02014*/ 00203000
*       REG3=CVTPTR;                /* SET UP POINTER TO CVT  @Y02014*/ 00204000
*                                                                  0136 00205000
         L     @11,CVTPTR                                          0136 00206000
         LR    REG3,@11                                            0136 00207000
*       /*************************************************************/ 00208000
*       /*                                                           */ 00209000
*       /* SEARCH LINK PACK AREA CDE CHAIN FOR SECONDARY MODULE      */ 00210000
*       /*                                                           */ 00211000
*       /*************************************************************/ 00212000
*                                                                  0137 00213000
*       CDEQUEUE=CVTQLPAQ;          /* GET ADDRESS OF LINK PACK AREA    00214000
*                                      CDE QUEUE              @Y02014*/ 00215000
         L     CDEQUEUE,CVTQLPAQ(,@11)                             0137 00216000
*       NAMEPTR=REG1;               /* SET REG 9 TO ADDRESS OF MODULE   00217000
*                                      NAME FOR INPUT TO IEAQCDSR  0138 00218000
*                                                             @Y02014*/ 00219000
         LR    NAMEPTR,REG1                                        0138 00220000
*       RFY                                                        0139 00221000
*         CDENTPTR RSTD;            /*                        @Y02014*/ 00222000
*       CALL IEAQCDSR;              /* SEARCH CDE CHAIN FOR MODULE 0140 00223000
*                                      RETURN TO R14 IF FOUND RETURN    00224000
*                                      TO R14+4 IF NOT FOUND  @Y02014*/ 00225000
         L     @14,CVTPTR                                          0140 00226000
         L     @15,CVTQCDSR(,@14)                                  0140 00227000
         BALR  @14,@15                                             0140 00228000
*       GEN FLOWS(READLPDE) NOSETS NOREFS SEQFLOW(SPACE);/* DIRECT-     00229000
*                                      IONS FOR COMPILER      @Y02014*/ 00230000
         SPACE                                                          00231000
*       GO TO MODFND1;              /* NAME FOUND, GO RECORD  @Y02014*/ 00232000
*                                                                  0142 00233000
         B     MODFND1                                             0142 00234000
*       /*************************************************************/ 00235000
*       /*                                                           */ 00236000
*       /* SEARCH LPDE CHAIN FOR SECONDARY MODULE             @Y02014*/ 00237000
*       /*                                                           */ 00238000
*       /*************************************************************/ 00239000
*                                                                  0143 00240000
*READLPDE:                                                         0143 00241000
*       CALL IEAVVMSR;              /* SEARCH LPDE CHAIN FOR MODULE     00242000
*                                      RETURN TO R14 IF FOUND, R14+4    00243000
*                                      IF NOT FOUND           @Y02014*/ 00244000
READLPDE L     @14,CVTPTR                                          0143 00245000
         L     @15,CVTLPDSR(,@14)                                  0143 00246000
         BALR  @14,@15                                             0143 00247000
*       GEN FLOWS(READERR) NOSETS NOREFS SEQFLOW(SPACE);/* DIRECT- 0144 00248000
*                                      IONS FOR COMPILER      @Y02014*/ 00249000
         SPACE                                                          00250000
*       GOTO MODFND2;               /* NAME FOUND, GO RECORD  @Y02014*/ 00251000
         B     MODFND2                                             0145 00252000
*READERR:                                                          0146 00253000
*       REG1=SAVER1;                /* RESTORE REGISTER 1     @Y02014*/ 00254000
READERR  L     REG1,SAVER1                                         0146 00255000
*       GO TO BLDL;                 /* MODULE NOT IN LINK PACK AREA     00256000
*                                      GO SEE IF IT CAN BE LOADED  0147 00257000
*                                                             @Y02014*/ 00258000
         B     BLDL                                                0147 00259000
*MODFND1:                                                          0148 00260000
*       LPAEP=CDENTPT;              /* NAME FOUND IN CDE CHAIN - GET    00261000
*                                      ADDRESS OF BEGINNING OF MODULE   00262000
*                                      FROM CDE               @Y02014*/ 00263000
MODFND1  L     @15,LPAPTR                                          0148 00264000
         MVC   LPAEP(4,@15),CDENTPT(CDENTPTR)                      0148 00265000
*       RFY                                                        0149 00266000
*         CDENTPTR UNRSTD;          /*                        @Y02014*/ 00267000
*       GOTO MODSAVE;               /* GO STORE ADDRESS       @Y02014*/ 00268000
         B     MODSAVE                                             0150 00269000
*MODFND2:                           /* NAME FOUND IN LPDE CHAIN    0151 00270000
*                                                             @Y02014*/ 00271000
*       LPDEPTR=NAMEREG0;           /* SET UP PTR TO LPDE FOR MODULE    00272000
*                                                             @Y02014*/ 00273000
MODFND2  ST    NAMEREG0,LPDEPTR                                    0151 00274000
*       LPAEP=LPDENTP;              /* REG0 POINTS TO LPDE THAT    0152 00275000
*                                      CONTAINS MODULE ENTRY POINT 0152 00276000
*                                                             @Y02014*/ 00277000
         L     @11,LPDEPTR                                         0152 00278000
         L     @15,LPAPTR                                          0152 00279000
         MVC   LPAEP(4,@15),LPDENTP(@11)                           0152 00280000
*MODSAVE:                                                          0153 00281000
*       LPAMODNM=SECMODNM;          /* PUT NAME OF MODULE IN TABLE 0153 00282000
*                                                             @Y02014*/ 00283000
MODSAVE  L     @11,LPAPTR                                          0153 00284000
         MVC   LPAMODNM(8,@11),SECMODNM                            0153 00285000
*       IF LPACT<9 THEN             /* MAKE SURE DONT GO BEYOND TABLE   00286000
*                                      END                    @Y02014*/ 00287000
         L     @11,LPACT                                           0154 00288000
         CH    @11,@CH00978                                        0154 00289000
         BNL   @RF00154                                            0154 00290000
*         LPACT=LPACT+1;            /* INCREMENT COUNT OF ENTRIES IN    00291000
*                                      TABLE                  @Y02014*/ 00292000
         AL    @11,@CF00034                                        0155 00293000
         ST    @11,LPACT                                           0155 00294000
*       REG1=ADDR(SECMODNM);        /* GET PTR TO MOD NAME    @Y02014*/ 00295000
@RF00154 LA    REG1,SECMODNM                                       0156 00296000
*       GEN;                                                       0157 00297000
*                                                          /* @Y02014*/ 00298000
         LOAD EPLOC=(REG1)                                              00299000
*       REG1=LPAEP;                 /* GET MODULE ENTRY POINT @Y02014*/ 00300000
         L     @11,LPAPTR                                          0158 00301000
         L     REG1,LPAEP(,@11)                                    0158 00302000
*       RFY                                                        0159 00303000
*         REG15 RSTD;               /*                        @Y02014*/ 00304000
*       REG15=0;                    /* SET RETURN CODE        @Y02014*/ 00305000
         SLR   REG15,REG15                                         0160 00306000
*       GOTO SEGRET;                /* RETURN TO CALLER OZ12026      */ 00307000
         B     SEGRET                                              0161 00308000
*       RFY                                                        0162 00309000
*         REG15 UNRSTD;             /*                        @Y02014*/ 00310000
*       RFY                                                        0163 00311000
*         REG3 UNRSTD;              /*                        @Y02014*/ 00312000
*     END SECNLOAD;                 /*                        @Y02014*/ 00313000
*   LOADSEC='0'B;                   /* INDICATE SEGEMENT LOAD        */ 00314000
@RF00094 NI    LOADSEC,B'01111111'                                 0165 00315000
*   DO LOADCT=1 TO 5;               /* COUNT NODES IN REQUESTED    0166 00316000
*                                      S21014 PATH S21014            */ 00317000
         LA    @11,1                                               0166 00318000
         ST    @11,LOADCT                                          0166 00319000
@DL00166 DS    0H                                                  0167 00320000
*     IF REQFLGS(LOADCT,1)='1'B THEN                               0167 00321000
         LR    @03,@11                                             0167 00322000
         SLA   @03,2                                               0167 00323000
         L     @15,LISTBASE                                        0167 00324000
         ALR   @15,@03                                             0167 00325000
         AL    @15,@CF01273                                        0167 00326000
         TM    REQFLGS(@15),B'10000000'                            0167 00327000
         BO    @RT00167                                            0167 00328000
*       GO TO WHATSIN;              /* S21014                        */ 00329000
*   END;                                                           0169 00330000
*                                                                  0169 00331000
         AL    @11,@CF00034                                        0169 00332000
         ST    @11,LOADCT                                          0169 00333000
         CH    @11,@CH00123                                        0169 00334000
         BNH   @DL00166                                            0169 00335000
*/*  COMPARE SEGMENT TO INCORE LIST TO SEE WHAT MODULES ARE    S21014   00336000
*    ALREADY IN CORE                                           S21014*/ 00337000
*                                                                  0170 00338000
*WHATSIN:                                                          0170 00339000
*   IF MODCT=0 THEN                                                0170 00340000
WHATSIN  L     @11,MODCT                                           0170 00341000
         LTR   @11,@11                                             0170 00342000
         BNZ   @RF00170                                            0170 00343000
*     DO;                           /* BYPASS COMPARE S21014 IF THIS    00344000
*                                      IS FIRST LOAD S21014          */ 00345000
*       LOADPT=1;                   /* INIT AVAILABLE SLOT S21014 IN    00346000
*                                      LIST TO 1 S21014              */ 00347000
         MVC   LOADPT(4),@CF00034                                  0172 00348000
*       GO TO BLDL;                 /* GO FIND MODULES S21014        */ 00349000
         B     BLDL                                                0173 00350000
*     END;                          /* S21014                        */ 00351000
*   IF MODCT>LOADCT THEN            /* GET MIN OF LOADCT AND S21014  */ 00352000
@RF00170 L     @11,LOADCT                                          0175 00353000
         C     @11,MODCT                                           0175 00354000
         BNL   @RF00175                                            0175 00355000
*     J=LOADCT;                     /* MODCT FOR LIMIT OF S21014     */ 00356000
         ST    @11,J                                               0176 00357000
*   ELSE                                                           0177 00358000
*     J=MODCT;                      /* COMPARE S21014                */ 00359000
         B     @RC00175                                            0177 00360000
@RF00175 MVC   J(4),MODCT                                          0177 00361000
*   DO LISTAD=1 TO J;               /* S21014                        */ 00362000
@RC00175 LA    @11,1                                               0178 00363000
         B     @DE00178                                            0178 00364000
@DL00178 DS    0H                                                  0179 00365000
*     CALL INQ;                     /* GET A LIST ENTRY S21014       */ 00366000
         BAL   @14,INQ                                             0179 00367000
*     IF LOADNAME(6:8)^=REQNAME(LISTAD) THEN                       0180 00368000
         L     @11,LISTAD                                          0180 00369000
         LR    @03,@11                                             0180 00370000
         SLA   @03,2                                               0180 00371000
         L     @15,LISTBASE                                        0180 00372000
         ALR   @15,@03                                             0180 00373000
         AL    @15,@CF01274                                        0180 00374000
         CLC   LOADNAME+5(3,REG2),REQNAME-1(@15)                   0180 00375000
         BE    @RF00180                                            0180 00376000
*       DO;                         /* S21014                        */ 00377000
*         LOADPT=LISTAD;            /* POINT TO NOW AVAILABLE S21014    00378000
*                                      UPDATE NUMBER OF MODULES TO BE   00379000
*                                      LOADES BY S21014 NUMBER     0182 00380000
*                                      ALREADY IN S21014             */ 00381000
         ST    @11,LOADPT                                          0182 00382000
*         LOADCT=LOADCT-(LISTAD-1); /* S21014                        */ 00383000
         LCR   @11,@11                                             0183 00384000
         AL    @11,@CF00034                                        0183 00385000
         AL    @11,LOADCT                                          0183 00386000
         ST    @11,LOADCT                                          0183 00387000
*         GO TO BLDL;                                              0184 00388000
         B     BLDL                                                0184 00389000
*       END;                                                       0185 00390000
*   END;                                                           0186 00391000
*                                                                  0186 00392000
@RF00180 LA    @11,1                                               0186 00393000
         AL    @11,LISTAD                                          0186 00394000
@DE00178 ST    @11,LISTAD                                          0186 00395000
         C     @11,J                                               0186 00396000
         BNH   @DL00178                                            0186 00397000
*   /*****************************************************************/ 00398000
*   /*                                                               */ 00399000
*   /* FALL OUT MEANS IN-CORE PATH IS OK                             */ 00400000
*   /*                                                               */ 00401000
*   /*****************************************************************/ 00402000
*                                                                  0187 00403000
*   ALLMODIN='1'B;                  /* SHOW NO MODULES NEED LOADING  */ 00404000
         OI    ALLMODIN,B'00010000'                                0187 00405000
*   GO TO CKEDITIN;                 /* DO ADJUST OR INIT       X01980*/ 00406000
         B     CKEDITIN                                            0188 00407000
*BLDL:                                                             0189 00408000
*   REG2=(LOADCT*64)+8;             /* COMPUTE LENGTH OF BLDL LIST 0189 00409000
*                                      FOR GETMAIN                   */ 00410000
BLDL     L     REG2,LOADCT                                         0189 00411000
         SLA   REG2,6                                              0189 00412000
         AH    REG2,@CH00037                                       0189 00413000
*   GEN(GETMAIN R,LV=(R2));         /* GET STORAGE FOR BLDL LIST     */ 00414000
         GETMAIN R,LV=(R2)                                              00415000
*   BLDLBASE=REG1;                  /* BASE THE GOTTEN CORE          */ 00416000
*                                                                  0191 00417000
         ST    REG1,BLDLBASE                                       0191 00418000
*   /*****************************************************************/ 00419000
*   /*                                                               */ 00420000
*   /* THE FOLLOWING CODE FORMATS TO BLDL LIST                       */ 00421000
*   /*                                                               */ 00422000
*   /*****************************************************************/ 00423000
*                                                                  0192 00424000
*   BLDLCT=LOADCT;                  /* STORE NUMBER OF ENTRIES       */ 00425000
         L     @11,BLDLBASE                                        0192 00426000
         MVC   BLDLCT(2,@11),LOADCT+2                              0192 00427000
*   BENTRLN=64;                     /* LENGTH IS ALWAYS 64 FOR LOAD     00428000
*                                      MODULES                       */ 00429000
         MVC   BENTRLN(2,@11),@CH00970                             0193 00430000
*   Q=BLDLBASE+4;                   /* POINT TO FIRST ENTRY IN BLDL     00431000
*                                      LIST                          */ 00432000
         AH    @11,@CH00051                                        0194 00433000
         ST    @11,Q                                               0194 00434000
*   DO J=1 TO LOADCT;                                              0195 00435000
         LA    @11,1                                               0195 00436000
         B     @DE00195                                            0195 00437000
@DL00195 DS    0H                                                  0196 00438000
*     IF LOADSEC='1'B THEN                                         0196 00439000
         TM    LOADSEC,B'10000000'                                 0196 00440000
         BNO   @RF00196                                            0196 00441000
*       DO;                                                        0197 00442000
*         REG1=-LISTBASE;           /* POINT TO MODULE NAME          */ 00443000
         L     REG1,LISTBASE                                       0198 00444000
         LCR   REG1,REG1                                           0198 00445000
*         MODNAME=REQMODNM;                                        0199 00446000
         L     @11,Q                                               0199 00447000
         MVC   MODNAME(8,@11),REQMODNM(REG1)                       0199 00448000
*       END;                                                       0200 00449000
*     ELSE                                                         0201 00450000
*       DO;                         /* FORM MODULE NAME FROM LAST 3     00451000
*                                      CHARACTERS S21014 IN        0201 00452000
*                                      DESCRIPTOR S21014             */ 00453000
         B     @RC00196                                            0201 00454000
@RF00196 DS    0H                                                  0202 00455000
*         NAMEAREA(6:8)=REQNAME(J+LOADPT-1);/* S21014                */ 00456000
         L     @11,J                                               0202 00457000
         AL    @11,LOADPT                                          0202 00458000
         SLA   @11,2                                               0202 00459000
         L     @03,LISTBASE                                        0202 00460000
         ALR   @03,@11                                             0202 00461000
         AL    @03,@CF01276                                        0202 00462000
         MVC   NAMEAREA+5(3),REQNAME-1(@03)                        0202 00463000
*         MODNAME=NAMEAREA;         /* STORE MODULE NAME IN BLDL LIST*/ 00464000
         L     @11,Q                                               0203 00465000
         MVC   MODNAME(8,@11),NAMEAREA                             0203 00466000
*       END;                                                       0204 00467000
*     Q=Q+BENTRLN;                  /* STEP TO NEXT ENTRY            */ 00468000
@RC00196 L     @11,BLDLBASE                                        0205 00469000
         LH    @11,BENTRLN(,@11)                                   0205 00470000
         AL    @11,Q                                               0205 00471000
         ST    @11,Q                                               0205 00472000
*   END;                                                           0206 00473000
         LA    @11,1                                               0206 00474000
         AL    @11,J                                               0206 00475000
@DE00195 ST    @11,J                                               0206 00476000
         C     @11,LOADCT                                          0206 00477000
         BNH   @DL00195                                            0206 00478000
*   REG2=BLDLBASE;                  /* POINT TO LIST FOR BLDL S21014 */ 00479000
         L     REG2,BLDLBASE                                       0207 00480000
*   GEN;                                                           0208 00481000
         BLDL  0,(REG2)                                                 00482000
         B     *+4(15)             BRANCH '1'B RETURN CODE FROM BLDL    00483000
         B     BLDLOK              0 - ALL ENTRIES IN LIST WERE FOUND   00484000
         B     NOTFOUND            4 - SOME MODULE NOT FOUND            00485000
         B     BLDLIOER            8 - I/O ERROR '1'B BLDL              00486000
*BLDLOK:                                                           0209 00487000
*   IF LOADSEC='0'B THEN            /* IF THIS IS A SEGMENT LOAD     */ 00488000
BLDLOK   TM    LOADSEC,B'10000000'                                 0209 00489000
         BNZ   @RF00209                                            0209 00490000
*     DO;                                                          0210 00491000
*       IF XNAME(1)^=' ' THEN       /* AND AN EXIT MOD. IS IN        */ 00492000
         CLI   XNAME,C' '                                          0211 00493000
         BE    @RF00211                                            0211 00494000
*         DO;                       /* DELETE THE EXIT MODULE        */ 00495000
*           GEN;                                                   0213 00496000
          DELETE  EPLOC=XNAME                                           00497000
*           XNAME=' ';              /* BLANK OUT EXIT MODULE NAME    */ 00498000
         MVI   XNAME+1,C' '                                        0214 00499000
         MVC   XNAME+2(6),XNAME+1                                  0214 00500000
         MVI   XNAME,C' '                                          0214 00501000
*           EXITSIZE=0;             /* SET EXIT MOD SIZE = ZERO      */ 00502000
         SLR   @11,@11                                             0215 00503000
         ST    @11,EXITSIZE                                        0215 00504000
*         END;                                                     0216 00505000
*       GOTO OK2LOAD;                                              0217 00506000
         B     OK2LOAD                                             0217 00507000
*     END;                                                         0218 00508000
*   Q=BLDLBASE+4;                   /* SET UP BASE FOR BLDL LIST     */ 00509000
@RF00209 LA    @11,4                                               0219 00510000
         L     @03,BLDLBASE                                        0219 00511000
         ALR   @03,@11                                             0219 00512000
         ST    @03,Q                                               0219 00513000
*   IF MODLEN>10240 THEN            /* DOES MOD. EXCEED ITS LIMIT    */ 00514000
         CLC   MODLEN(3,@03),@CF01160+1                            0220 00515000
         BNH   @RF00220                                            0220 00516000
*     DO;                           /* YES                           */ 00517000
*       RESPECIFY                                                  0222 00518000
*         REG15 RESTRICTED;         /*                         Y02006*/ 00519000
*       REG15=4;                    /* SET MODULE TOO LARGE CODE     */ 00520000
         LR    REG15,@11                                           0223 00521000
*       GOTO SETBR14;               /* SET DUMMY INTERFACE           */ 00522000
         B     SETBR14                                             0224 00523000
*       RESPECIFY                                                  0225 00524000
*         REG15 UNRSTD;             /*                         Y02006*/ 00525000
*     END;                                                         0226 00526000
*                                                                  0226 00527000
*   /*****************************************************************/ 00528000
*   /*                                                               */ 00529000
*   /* IF THIS IS A (NON EXIT) SECONDARY LOAD SEE IF LIMIT IS REACHED*/ 00530000
*   /*                                                               */ 00531000
*   /*****************************************************************/ 00532000
*                                                                  0227 00533000
*   IF LOADEXIT='0'B THEN                                          0227 00534000
@RF00220 TM    LOADEXIT,B'00100000'                                0227 00535000
         BNZ   @RF00227                                            0227 00536000
*     DO;                                                          0228 00537000
*       SMODSIZE=SMODSIZE+MODLEN;   /* ADD SIZE OF MOD. TO TOTAL   0229 00538000
*                                      SECONDARY MOD. SIZE           */ 00539000
         L     @11,Q                                               0229 00540000
         MVC   @ZT00001+1(3),MODLEN(@11)                           0229 00541000
         L     @11,@ZT00001                                        0229 00542000
         AL    @11,SMODSIZE                                        0229 00543000
         ST    @11,SMODSIZE                                        0229 00544000
*       IF SMODSIZE>LIMIT THEN                                     0230 00545000
         C     @11,LIMIT                                           0230 00546000
         BNH   @RF00230                                            0230 00547000
*         DO;                                                      0231 00548000
*           CALL NOSPACE;           /* DELETE ALL SEC. MODULES       */ 00549000
         BAL   @14,NOSPACE                                         0232 00550000
*           SMODSIZE=MODLEN;        /* GET LENGTH OF MOD. TO LOAD    */ 00551000
         L     @11,Q                                               0233 00552000
         MVC   @ZT00001+1(3),MODLEN(@11)                           0233 00553000
         L     @11,@ZT00001                                        0233 00554000
         ST    @11,SMODSIZE                                        0233 00555000
*         END;                                                     0234 00556000
*     END;                                                         0235 00557000
*                                                                  0235 00558000
@RF00230 DS    0H                                                  0236 00559000
*   /*****************************************************************/ 00560000
*   /*                                                               */ 00561000
*   /* BRANCH AROUND DELETE LOOP IF FIRST LOAD                 S21014*/ 00562000
*   /*                                                               */ 00563000
*   /*****************************************************************/ 00564000
*                                                                  0236 00565000
*OK2LOAD:                                                          0236 00566000
*   IF MODCT=0 THEN                                                0236 00567000
@RF00227 DS    0H                                                  0236 00568000
OK2LOAD  L     @11,MODCT                                           0236 00569000
         LTR   @11,@11                                             0236 00570000
         BZ    @RT00236                                            0236 00571000
*     GO TO LOADIN;                 /* S21014                        */ 00572000
*                                                                  0237 00573000
*   /*****************************************************************/ 00574000
*   /*                                                               */ 00575000
*   /* IN CASE OF 2-ARY LOAD, SET NEXT AVAILABLE LIST POONTER  S21014*/ 00576000
*   /*                                                               */ 00577000
*   /*****************************************************************/ 00578000
*                                                                  0238 00579000
*   IF LOADSEC='1'B THEN                                           0238 00580000
         TM    LOADSEC,B'10000000'                                 0238 00581000
         BNO   @RF00238                                            0238 00582000
*     DO;                           /* S21014                        */ 00583000
*       LOADPT=MODCT+1;             /* NEXT AVAILABLE LIST S21014    */ 00584000
         AL    @11,@CF00034                                        0240 00585000
         ST    @11,LOADPT                                          0240 00586000
*       GO TO LOADIN;               /* BRANCH AROUND DELETE S21014 0241 00587000
*                                      LOOP S21014                   */ 00588000
         B     LOADIN                                              0241 00589000
*     END;                          /* S21014                        */ 00590000
*/*  READY TO LOAD MODULES -                                   S21014   00591000
*    FIRST DELETE THOSE WHICH ARE NOT NEEDED.                  S21014   00592000
*    LOADPT TO BE LESS THAN OR EQUAL TO MODCT IF MODULES ARE   S21014   00593000
*    TO BE DELETED, OTHERWISE DO LOOP WILL NOT EXECUTE.        S21014*/ 00594000
*                                                                  0243 00595000
*LOADIN:                                                           0243 00596000
*   IF LOADEXIT='1'B THEN           /* PROCESS EXIT LOADING        0243 00597000
*                                      DIFFERENTLY                   */ 00598000
@RF00238 DS    0H                                                  0243 00599000
LOADIN   TM    LOADEXIT,B'00100000'                                0243 00600000
         BO    @RT00243                                            0243 00601000
*     GOTO XLODONLY;                                               0244 00602000
*   DO LISTAD=MODCT TO LOADPT BY-1; /* X01980                        */ 00603000
         L     @11,MODCT                                           0245 00604000
         ST    @11,LISTAD                                          0245 00605000
         B     @DE00245                                            0245 00606000
@DL00245 DS    0H                                                  0246 00607000
*     CALL INQ;                     /* SET UP REG 2 FOR CALL TO    0246 00608000
*                                      S21104 INQ POINTS TO LISTAD 0246 00609000
*                                      S21104 ENTRY OF IN-CORE TABLE    00610000
*                                      S21104                        */ 00611000
         BAL   @14,INQ                                             0246 00612000
*     CALL DELETE;                  /* DELETE MOD AT LISTAD S21014   */ 00613000
         BAL   @14,DELETE                                          0247 00614000
*   END;                            /* S21014                        */ 00615000
         SLR   @11,@11                                             0248 00616000
         BCTR  @11,0                                               0248 00617000
         AL    @11,LISTAD                                          0248 00618000
         ST    @11,LISTAD                                          0248 00619000
@DE00245 C     @11,LOADPT                                          0248 00620000
         BNL   @DL00245                                            0248 00621000
*   IF LOADSEC='0'B THEN            /* IF SEGMENT LOAD               */ 00622000
         TM    LOADSEC,B'10000000'                                 0249 00623000
         BNZ   @RF00249                                            0249 00624000
*     DO;                                                          0250 00625000
*       SMODSIZE=0;                 /* RESET TOTAL SIZE OF SECONDARY    00626000
*                                      MOD. IN CORE TO ZERO          */ 00627000
         SLR   @11,@11                                             0251 00628000
         ST    @11,SMODSIZE                                        0251 00629000
*CKEDITIN:                          /*                         X01980*/ 00630000
*       IF SEGRD='1'B THEN          /* IF INIT READ FOR EDIT OZ12026 */ 00631000
CKEDITIN TM    SEGRD(COMBASE),B'00000100'                          0252 00632000
         BNO   @RF00252                                            0252 00633000
*         DO;                       /* OZ12026                       */ 00634000
*           SEGSAVE=ERRADDR;        /* SAVE PREVIOUS ADDRESS OZ12026 */ 00635000
         MVC   SEGSAVE(4),ERRADDR(COMBASE)                         0254 00636000
*           ERRADDR=ADDR(SEGERAD);  /* HAVE ERROR RETURN HEREOZ12026 */ 00637000
         LA    @11,SEGERAD                                         0255 00638000
         ST    @11,ERRADDR(,COMBASE)                               0255 00639000
*         END;                      /* OZ12026                       */ 00640000
*       IF EDITSW='1'B THEN         /* IF EDIT IS NOT IN       Y02006*/ 00641000
@RF00252 TM    EDITSW(COMBASE),B'00001000'                         0257 00642000
         BO    @RT00257                                            0257 00643000
*         GOTO LOAD;                /* PROCESS,ISSUE BRREAD INIT   0258 00644000
*                                                              Y02006*/ 00645000
*       GEN REFS(BRRDINIT);                                        0259 00646000
NOEDIT    BRREAD INIT              GET BUFFERS AND INITIALIZE           00647000
*     END;                                                         0260 00648000
*   IF SEGRD='1'B THEN              /* IF INIT READ FOR EDIT OZ12026 */ 00649000
@RF00249 TM    SEGRD(COMBASE),B'00000100'                          0261 00650000
         BNO   @RF00261                                            0261 00651000
*     DO;                           /* READ WAS GOOD OZ12026         */ 00652000
*       ERRADDR=SEGSAVE;            /* RESTORE ERRADDR OZ12026       */ 00653000
         MVC   ERRADDR(4,COMBASE),SEGSAVE                          0263 00654000
*       SEGRD='0'B;                 /* TURN OFF ERROR FLAG OZ12026   */ 00655000
         NI    SEGRD(COMBASE),B'11111011'                          0264 00656000
*     END;                          /* OZ12026                       */ 00657000
*LOAD:                                                             0266 00658000
*   IF ALLMODIN='1'B THEN           /* IF NO LOADING RETURN TO CALLER*/ 00659000
@RF00261 DS    0H                                                  0266 00660000
LOAD     TM    ALLMODIN,B'00010000'                                0266 00661000
         BO    @RT00266                                            0266 00662000
*     GO TO INCORE;                 /*                         X01980*/ 00663000
*   Q=BLDLBASE+4;                   /* POINT TO BLDL LIST S21014     */ 00664000
         LA    @11,4                                               0268 00665000
         AL    @11,BLDLBASE                                        0268 00666000
         ST    @11,Q                                               0268 00667000
*   RESPECIFY                                                      0269 00668000
*     REG3 RESTRICTED;              /* Y02006                        */ 00669000
*   DO J=1 TO LOADCT;               /* LOOP TO LOAD MODULES S21014   */ 00670000
         LA    @11,1                                               0270 00671000
         B     @DE00270                                            0270 00672000
@DL00270 DS    0H                                                  0271 00673000
*     LISTAD=LOADPT+(J-1);          /* POINT TO AVAILABLE ENTRY    0271 00674000
*                                      S21014                        */ 00675000
         BCTR  @11,0                                               0271 00676000
         AL    @11,LOADPT                                          0271 00677000
         ST    @11,LISTAD                                          0271 00678000
*     CALL INQ;                     /* LOCATE THE ENTRY S21014       */ 00679000
         BAL   @14,INQ                                             0272 00680000
*     LOADNAME=MODNAME;             /* STORE MODULE NAME S21014 IN 0273 00681000
*                                      IN-CORE LIST S21014           */ 00682000
         L     @11,Q                                               0273 00683000
         MVC   LOADNAME(8,REG2),MODNAME(@11)                       0273 00684000
*     REG3=ADDR(LOADNAME);          /* S21014                        */ 00685000
         LR    REG3,REG2                                           0274 00686000
*     GEN;                                                         0275 00687000
*                                                                  0275 00688000
              LOAD  EPLOC=(R3)                                          00689000
              LR    R3,R0          SAVE EP ADDRESS IN REG 3             00690000
*     /***************************************************************/ 00691000
*     /*                                                             */ 00692000
*     /* TEST FOR LAST IN PATH OR 2-ARY LOAD, IF SO S21014 BYPASS    */ 00693000
*     /* LINKING TO MODULE - DONE ONLY FOR SERVICE S21014 ROUTINES   */ 00694000
*     /* S21014                                                      */ 00695000
*     /*                                                             */ 00696000
*     /***************************************************************/ 00697000
*                                                                  0276 00698000
*     IF J^=LOADCT THEN                                            0276 00699000
         CLC   J(4),LOADCT                                         0276 00700000
         BE    @RF00276                                            0276 00701000
*       GEN;                                                       0277 00702000
*                                   /* S21014                        */ 00703000
              LR    R15,R3         EP ADDRESS TO TARGET REG    S21014   00704000
              BALR  R14,R15        LINK TO ALLOW ROUTINE         Y02006 00705000
*                                  TO SET-UP                   S21014   00706000
*       LOADEP=REG3;                /* SET EP ADDRESS IN LIST S21014 */ 00707000
@RF00276 ST    REG3,LOADEP(,REG2)                                  0278 00708000
*     Q=Q+BENTRLN;                  /* UPDATE BLDL LIST ENTRY S21014    00709000
*                                      POINTER S21014                */ 00710000
         L     @11,BLDLBASE                                        0279 00711000
         LH    @11,BENTRLN(,@11)                                   0279 00712000
         AL    @11,Q                                               0279 00713000
         ST    @11,Q                                               0279 00714000
*     MODCT=MODCT+1;                /* UPDATE IN-CORE COUNT S21014   */ 00715000
         LA    @11,1                                               0280 00716000
         AL    @11,MODCT                                           0280 00717000
         ST    @11,MODCT                                           0280 00718000
*   END;                            /* S21014                        */ 00719000
         LA    @11,1                                               0281 00720000
         AL    @11,J                                               0281 00721000
@DE00270 ST    @11,J                                               0281 00722000
         C     @11,LOADCT                                          0281 00723000
         BNH   @DL00270                                            0281 00724000
*/*  LOADING COMPLETE                                          S21014*/ 00725000
*                                                                  0282 00726000
*LOADDONE:                                                         0282 00727000
*   IF LOADSEC='0'B THEN            /* S21014                        */ 00728000
LOADDONE TM    LOADSEC,B'10000000'                                 0282 00729000
         BNZ   @RF00282                                            0282 00730000
*     SECLOAD=MODCT+1;              /* IN CASE OF SEGMENT LOAD S21014   00731000
*                                      UPDATE POSITION OF 2-ARY    0283 00732000
*                                      S21014 MODULES S21014         */ 00733000
         LA    @11,1                                               0283 00734000
         AL    @11,MODCT                                           0283 00735000
         ST    @11,SECLOAD                                         0283 00736000
*   INQCODE=4;                      /* SET INQ FUNCTION CODE TO    0284 00737000
*                                      S21014 DEQUEUE UNUSED LIST  0284 00738000
*                                      S21014 BLOCKS S21014          */ 00739000
@RF00282 MVI   INQCODE,X'04'                                       0284 00740000
*   CALL INQ;                       /* GO CLEAN UP LIST S21014       */ 00741000
         BAL   @14,INQ                                             0285 00742000
*   INQCODE=0;                      /* RESTORE INQ FUNCTION S21014 0286 00743000
*                                      CODE TO REFERENCE S21014      */ 00744000
         MVI   INQCODE,X'00'                                       0286 00745000
*   RESPECIFY                                                      0287 00746000
*     REG3 UNRESTRICTED;            /*                         Y02006*/ 00747000
*   CALL FREEBLDL;                  /* GO FREE BLDL LIST             */ 00748000
*                                                                  0288 00749000
         BAL   @14,FREEBLDL                                        0288 00750000
*   /*****************************************************************/ 00751000
*   /*                                                               */ 00752000
*   /* REG 2 STILL CONTAINS POINTER TO LAST ENTRY IN LIST      S21014*/ 00753000
*   /*                                                               */ 00754000
*   /*****************************************************************/ 00755000
*                                                                  0289 00756000
*INCORE:                                                           0289 00757000
*   REG1=LOADEP;                    /* RETURN EP ADDRESS S21014      */ 00758000
INCORE   L     REG1,LOADEP(,REG2)                                  0289 00759000
*   RESPECIFY                                                      0290 00760000
*     REG15 RESTRICTED;             /*                         Y02006*/ 00761000
*   REG15=0;                        /* GIVE CLEAN RETURN CODE        */ 00762000
         SLR   REG15,REG15                                         0291 00763000
*   RESPECIFY                                                      0292 00764000
*     REG15 UNRSTD;                 /*                         Y02006*/ 00765000
*   GOTO SEGRET;                    /* RETURN TO CALLER OZ12026      */ 00766000
         B     SEGRET                                              0293 00767000
*/********************************************************************/ 00768000
*/* LOAD THE EXIT MODULE AND BUILD ITS 'LIST'                        */ 00769000
*/********************************************************************/ 00770000
*                                                                  0294 00771000
*XLODONLY:                                                         0294 00772000
*   REG1=-LISTBASE;                 /* POINT TO MODULE NAME          */ 00773000
XLODONLY L     REG1,LISTBASE                                       0294 00774000
         LCR   REG1,REG1                                           0294 00775000
*   XNAME=REQMODNM;                 /* MOVE NAME TO LIST             */ 00776000
         MVC   XNAME(8),REQMODNM(REG1)                             0295 00777000
*   GEN;                                                           0296 00778000
          LOAD  EPLOC=(REG1)  LOAD THE MODULE                           00779000
          ST   R0,XENTPT  PUT ENTRY POINT IN LIST                       00780000
*   CALL FREEBLDL;                  /* FREE BLDL LIST STORAGE        */ 00781000
         BAL   @14,FREEBLDL                                        0297 00782000
*   EXITSIZE=10240;                 /* SET UP EDIT EXIT MOD. SIZE    */ 00783000
         MVC   EXITSIZE(4),@CF01160                                0298 00784000
*XITENPT:                                                          0299 00785000
*   REG1=XENTPT;                    /* GET MODULE ENTRY POINT        */ 00786000
XITENPT  L     REG1,XENTPT                                         0299 00787000
*   RESPECIFY                                                      0300 00788000
*     REG15 RESTRICTED;             /*                         Y02006*/ 00789000
*   REG15=0;                        /* SHOW GOOD COMPLETION          */ 00790000
         SLR   REG15,REG15                                         0301 00791000
*   GOTO SEGRET;                    /* RETURN TO CALLER OZ12026      */ 00792000
         B     SEGRET                                              0302 00793000
*                                                                  0303 00794000
*/********************************************************************/ 00795000
*/*                                                                  */ 00796000
*/*   THE FOLLOWING ROUTINES ARE ERROR HANDLERS.  EACH ROUTINE       */ 00797000
*/*   PRINTS AN APPROPRIATE ERROR MESSAGE AND SETS UP A BR 14        */ 00798000
*/*   INSTRUCTION AS THE CURRENT EXECUTOR.  RETURN TO CALLER   S21014*/ 00799000
*/*   CAUSES NOP OF FUNCTION.                                  S21014*/ 00800000
*/*                                                                  */ 00801000
*/********************************************************************/ 00802000
*/*  MODULE NOT FOUND BY BLDL                                        */ 00803000
*                                                                  0303 00804000
*   GEN(USING SYNTAX,R15);          /* S21014                        */ 00805000
         USING SYNTAX,R15                                               00806000
*NOTFOUND:                                                         0304 00807000
*   NOSTDMG='1'B;                   /* INDICATE AMD165I NOT Y02006 0304 00808000
*                                      REQUIRED S21014               */ 00809000
NOTFOUND OI    NOSTDMG(COMBASE),B'00010000'                        0304 00810000
*   REG15=ASYNTAX;                  /* POINT TO MESSAGE WRITER S21014*/ 00811000
         L     REG15,ASYNTAX(,COMBASE)                             0305 00812000
*   CALL SYNTAXB;                   /* ISSUE MESSAGE AMD177I S21014  */ 00813000
         BAL   @14,SYNTAXB                                         0306 00814000
*   Q=BLDLBASE+4;                   /* POINT TO BLDL LIST            */ 00815000
         LA    @14,4                                               0307 00816000
         AL    @14,BLDLBASE                                        0307 00817000
         ST    @14,Q                                               0307 00818000
*   DO J=1 TO BLDLCT;               /* PICK UP MODULE NAMES OF     0308 00819000
*                                      MODULES NOT FOUND             */ 00820000
         LA    @14,1                                               0308 00821000
         B     @DE00308                                            0308 00822000
@DL00308 DS    0H                                                  0309 00823000
*     IF R=0 THEN                                                  0309 00824000
         L     @14,Q                                               0309 00825000
         CLI   R(@14),0                                            0309 00826000
         BNE   @RF00309                                            0309 00827000
*       DO;                         /* RECORD POINTER 0 MEANS NOT  0310 00828000
*                                      FOUND                         */ 00829000
*         TEXT=MODNAME;             /* INDICATE MESSAGE AMD165I NOT     00830000
*                                      REQUIRED S21014               */ 00831000
         L     @11,SYNMSGA(,COMBASE)                               0311 00832000
         L     @11,AMDPRP02+8(,@11)                                0311 00833000
         MVC   TEXT+12(8,@11),MODNAME(@14)                         0311 00834000
*         NOSTDMG='1'B;             /*                         Y02006*/ 00835000
         OI    NOSTDMG(COMBASE),B'00010000'                        0312 00836000
*         REG15=ASYNTAX;            /* GET EP ADDR MSG WRITER S21014 */ 00837000
         L     REG15,ASYNTAX(,COMBASE)                             0313 00838000
*         CALL SYNTAXC;             /* ISSUE NOT-FOUND MESSAGE S21014*/ 00839000
         BAL   @14,SYNTAXC                                         0314 00840000
*       END;                                                       0315 00841000
*     Q=Q+BENTRLN;                  /* STEP TO NEXT ENTRY            */ 00842000
@RF00309 L     @14,BLDLBASE                                        0316 00843000
         LH    @14,BENTRLN(,@14)                                   0316 00844000
         AL    @14,Q                                               0316 00845000
         ST    @14,Q                                               0316 00846000
*   END;                                                           0317 00847000
         LA    @14,1                                               0317 00848000
         AL    @14,J                                               0317 00849000
@DE00308 ST    @14,J                                               0317 00850000
         L     @11,BLDLBASE                                        0317 00851000
         CH    @14,BLDLCT(,@11)                                    0317 00852000
         BNH   @DL00308                                            0317 00853000
*   CALL PRNTMSG;                   /* PRINT MESSAGE AMD180I S21014  */ 00854000
         BAL   @14,PRNTMSG                                         0318 00855000
*   REG15=8;                        /* SET NOT-FOUND RETURN C. S21014*/ 00856000
         LA    REG15,8                                             0319 00857000
*   GO TO SETBR14;                  /* S21014                        */ 00858000
         B     SETBR14                                             0320 00859000
*/*  I/O ERROR ON BLDL                                               */ 00860000
*                                                                  0321 00861000
*SEGERAD:                           /* EDIT READ ERROR RETURNOZ12026 */ 00862000
*   GEN;                                                           0321 00863000
SEGERAD  DS    0H                                                  0321 00864000
*                                  /* MUST RESTORE REGISTERS OZ12026    00865000
         BALR  R1,0                ESTABLISH BASE TO USE     OZ12026    00866000
         USING *,R1                ESTABLISH BASE TO USE     OZ12026    00867000
         LA    R13,@SA00001        GET SAVE AREA ADDRESS     OZ12026    00868000
         LM    R0,R12,@SA00001+20  LOAD REGS FROM SAVE AREA  OZ12026    00869000
         DROP  R1                  RELEASE REG 01 AS BASE    OZ12026*/  00870000
*   GOTO LOAD;                      /* CONTINUE HOUSEKEEPING OZ12026 */ 00871000
         B     LOAD                                                0322 00872000
*BLDLIOER:                                                         0323 00873000
*   NOSTDMG='1'B;                   /* INDICATE AMD165I NOT Y02006 0323 00874000
*                                      REQUIRED S21014               */ 00875000
BLDLIOER OI    NOSTDMG(COMBASE),B'00010000'                        0323 00876000
*   REG15=ASYNTAX;                  /* POINT TO MESSAGE WRITER S21014*/ 00877000
         L     REG15,ASYNTAX(,COMBASE)                             0324 00878000
*   CALL SYNTAXD;                   /* ISSUE MESSAGE AMD178I S21014  */ 00879000
         BAL   @14,SYNTAXD                                         0325 00880000
*   CALL PRNTMSG;                   /* PRINT MESSAGE AMD180I S21014  */ 00881000
         BAL   @14,PRNTMSG                                         0326 00882000
*   REG15=12;                       /* SET BLDL I/O ERROR CODE S21014*/ 00883000
         LA    REG15,12                                            0327 00884000
*   GO TO SETBR14;                                                 0328 00885000
         B     SETBR14                                             0328 00886000
*   RESPECIFY                                                      0329 00887000
*     REG15 UNRSTD;                 /*                         Y02006*/ 00888000
*SETBR14:                                                          0330 00889000
*   REG1=ADDR(BR14);                /* POINT TO BR 14 INST. S21014   */ 00890000
SETBR14  LA    REG1,BR14                                           0330 00891000
*   GOTO SEGRET;                    /* RETURN TO CALLER NOP OZ12026     00892000
*                                      EXECUTOR                      */ 00893000
         B     SEGRET                                              0331 00894000
*   GEN;                                                           0332 00895000
*** NO-OP FUNCTION OF EXECUTOR  ***                             S21014  00896000
BR14     LA   R15,4                   SET ERROR RETURN CODE    S21014   00897000
         BR   R14                     RETURN TO CALLER          Y02006  00898000
*SEGRET:                            /* RETURN TO CALLER CODE OZ12026 */ 00899000
*   IF SEGRD='1'B THEN              /* EDIT READ ERROR ON OZ12026    */ 00900000
SEGRET   TM    SEGRD(COMBASE),B'00000100'                          0333 00901000
         BNO   @RF00333                                            0333 00902000
*     DO;                           /* OZ12026                       */ 00903000
*       SEGRD='0'B;                 /* TURN OFF READ ERROR OZ12026   */ 00904000
         NI    SEGRD(COMBASE),B'11111011'                          0335 00905000
*       ERRADDR=SEGSAVE;            /* RESTORE ERRADDR OZ12026       */ 00906000
         MVC   ERRADDR(4,COMBASE),SEGSAVE                          0336 00907000
*       GEN;                                                       0337 00908000
*                                 /* BRANCH TO ERROR ADDR   OZ12026     00909000
         L     R15,ERRADDR(R12)   LOAD THE ERROR ROUTINE ADR OZ12026    00910000
         BR    R15                BRANCH TO IT              OZ12026 */  00911000
*     END;                          /* OZ12026                       */ 00912000
*   RETURN;                         /* RETURN BACK TO CALLER OZ12026 */ 00913000
@EL00001 L     @13,4(,@13)                                         0339 00914000
@EF00001 DS    0H                                                  0339 00915000
@ER00001 L     @14,12(,@13)                                        0339 00916000
         L     @00,20(,@13)                                        0339 00917000
         LM    @02,@12,28(@13)                                     0339 00918000
         BR    @14                                                 0339 00919000
*/********************************************************************/ 00920000
*/*                                                                  */ 00921000
*/*  NO ROOM IN REGION TO LOAD SECONDARY MODULE,                     */ 00922000
*/*  DELETE ALL SECONDARY MODULES                                    */ 00923000
*/*                                                                  */ 00924000
*/********************************************************************/ 00925000
*                                                                  0340 00926000
*NOSPACE:                                                          0340 00927000
*   PROC;                                                          0340 00928000
         B     @EL00001                                            0340 00929000
NOSPACE  STM   @14,@12,@SA00002                                    0340 00930000
*   DO LISTAD=MODCT TO SECLOAD BY-1;/* S21014 LOOP TO DELETE - END OF   00931000
*                                      LIST FIRST S21014             */ 00932000
         L     @11,MODCT                                           0341 00933000
         ST    @11,LISTAD                                          0341 00934000
         B     @DE00341                                            0341 00935000
@DL00341 DS    0H                                                  0342 00936000
*     CALL INQ;                     /* POINT TO MODULE ENTRY S21014  */ 00937000
         BAL   @14,INQ                                             0342 00938000
*     CALL DELETE;                  /* S21014                        */ 00939000
         BAL   @14,DELETE                                          0343 00940000
*   END;                            /* S21014                        */ 00941000
         SLR   @11,@11                                             0344 00942000
         BCTR  @11,0                                               0344 00943000
         AL    @11,LISTAD                                          0344 00944000
         ST    @11,LISTAD                                          0344 00945000
@DE00341 C     @11,SECLOAD                                         0344 00946000
         BNL   @DL00341                                            0344 00947000
*   RETURN;                                                        0345 00948000
@EL00002 DS    0H                                                  0345 00949000
@EF00002 DS    0H                                                  0345 00950000
@ER00002 LM    @14,@12,@SA00002                                    0345 00951000
         BR    @14                                                 0345 00952000
*   END NOSPACE;                                                   0346 00953000
*PRNTMSG:                                                          0347 00954000
*   PROC;                           /* S21014                        */ 00955000
PRNTMSG  STM   @14,@12,@SA00003                                    0347 00956000
*   RESPECIFY                                                      0348 00957000
*    (REG1,                                                        0348 00958000
*     REG2,                                                        0348 00959000
*     COMBASE) RESTRICTED;          /*                         Y02006*/ 00960000
*   REG2=Q-BENTRLN;                 /* POINT TO MODULE CAUSING S21014*/ 00961000
         L     REG2,Q                                              0349 00962000
         L     @11,BLDLBASE                                        0349 00963000
         SH    REG2,BENTRLN(,@11)                                  0349 00964000
*   INOP=LOADNAME;                  /* STORE NAME IN MSG TEXT S21014 */ 00965000
         L     @11,SYNMSGA(,COMBASE)                               0350 00966000
         L     @11,AMDPRP03+16(,@11)                               0350 00967000
         MVC   INOP+12(8,@11),LOADNAME(REG2)                       0350 00968000
*   RESPECIFY                                                      0351 00969000
*     REG15 RESTRICTED;             /*                         Y02006*/ 00970000
*   REG15=ASYNTAX;                  /* POINT TO MESSAGE WRITER S21014*/ 00971000
         L     REG15,ASYNTAX(,COMBASE)                             0352 00972000
*   NOSTDMG='1'B;                   /* INDICATE MESSAGE AMD165I    0353 00973000
*                                      Y02006 NOT REQUIRED S21014    */ 00974000
         OI    NOSTDMG(COMBASE),B'00010000'                        0353 00975000
*   CALL SYNTAXE;                   /* GO WRITE MESSAGE AMD180I    0354 00976000
*                                      S21014                        */ 00977000
         BAL   @14,SYNTAXE                                         0354 00978000
*   RESPECIFY                                                      0355 00979000
*     REG15 UNRSTD;                 /*                         Y02006*/ 00980000
*FREEBLDL:                                                         0356 00981000
*   ENTRY;                          /* S21014                        */ 00982000
         B     @EC00356                                            0356 00983000
FREEBLDL STM   @14,@12,@SA00003                                    0356 00984000
@EC00356 DS    0H                                                  0357 00985000
*   RESPECIFY                                                      0357 00986000
*     REG3 RESTRICTED;              /*                         Y02006*/ 00987000
*   REG2=(BLDLCT*BENTRLN)+8;        /* COMPUTE LENGTH OF BLDL LIST   */ 00988000
         L     @11,BLDLBASE                                        0358 00989000
         LH    REG2,BLDLCT(,@11)                                   0358 00990000
         MH    REG2,BENTRLN(,@11)                                  0358 00991000
         AH    REG2,@CH00037                                       0358 00992000
*   REG3=BLDLBASE;                  /* POINT TO LIST                 */ 00993000
         LR    REG3,@11                                            0359 00994000
*   GEN(FREEMAIN R,LV=(R2),A=(R3)); /* FREE IT                       */ 00995000
         FREEMAIN R,LV=(R2),A=(R3)                                      00996000
*   RESPECIFY                                                      0361 00997000
*     REG3 UNRSTD;                  /*                         Y02006*/ 00998000
*   END PRNTMSG;                    /* S21014                        */ 00999000
@EL00003 DS    0H                                                  0362 01000000
@EF00003 DS    0H                                                  0362 01001000
@ER00003 LM    @14,@12,@SA00003                                    0362 01002000
         BR    @14                                                 0362 01003000
*DELETE:                                                           0363 01004000
*   PROC OPTIONS(DONTSAVE(15));     /* S21014                        */ 01005000
DELETE   ST    @14,@SA00004                                        0363 01006000
         STM   @00,@12,@SA00004+4                                  0363 01007000
*   RESPECIFY                                                      0364 01008000
*    (REG1,                                                        0364 01009000
*     REG2,                                                        0364 01010000
*     COMBASE) RESTRICTED;          /*                         Y02006*/ 01011000
*   MODCT=MODCT-1;                                                 0365 01012000
         L     @11,MODCT                                           0365 01013000
         BCTR  @11,0                                               0365 01014000
         ST    @11,MODCT                                           0365 01015000
*   RESPECIFY                                                      0366 01016000
*     REG3 RESTRICTED;              /*                         Y02006*/ 01017000
*   REG3=ADDR(LOADNAME);            /* S21014                        */ 01018000
         LR    REG3,REG2                                           0367 01019000
*   GEN;                                                           0368 01020000
*                                   /* S21014                        */ 01021000
         DELETE  EPLOC=(R3)                                             01022000
         B     *+4(R15)                                                 01023000
         B     DELETOK                                                  01024000
         B     DELFAIL                                                  01025000
*   RESPECIFY                                                      0369 01026000
*     REG3 UNRSTD;                  /*                         Y02006*/ 01027000
*DELETOK:                                                          0370 01028000
*   RETURN;                         /* DELETE SUCCESSFUL RETURN    0370 01029000
*                                      S21014 TO CALLER S21014       */ 01030000
@EL00004 DS    0H                                                  0370 01031000
@EF00004 DS    0H                                                  0370 01032000
@ER00004 L     @14,@SA00004                                        0370 01033000
         LM    @00,@12,@SA00004+4                                  0370 01034000
         BR    @14                                                 0370 01035000
*DELFAIL:                           /* BRANCH HERE FOR DELETE S21014    01036000
*                                      FAIL S21014                   */ 01037000
*   SYNMSGA=ADDR(AMDPRP04);         /* SET UP TO ISSUE DELETE S21014    01038000
*                                      ERROR MESSAGE S21014          */ 01039000
DELFAIL  LA    @11,20                                              0371 01040000
         AL    @11,SYNMSGA(,COMBASE)                               0371 01041000
         ST    @11,SYNMSGA(,COMBASE)                               0371 01042000
*   DELNAME=LOADNAME;               /* SET MODULE NAME IN S21014   0372 01043000
*                                      MESSAGE AMD181I S21014        */ 01044000
         L     @11,DELFLMSG(,@11)                                  0372 01045000
         MVC   DELNAME+27(8,@11),LOADNAME(REG2)                    0372 01046000
*   RESPECIFY                                                      0373 01047000
*     REG15 RESTRICTED;             /*                         Y02006*/ 01048000
*   REG15=ASYNTAX;                  /* POINT TO MESSAGE WRITER S21014*/ 01049000
         L     REG15,ASYNTAX(,COMBASE)                             0374 01050000
*   NOSTDMG='1'B;                   /* INDICATE MESSAGE AMD165I    0375 01051000
*                                      Y02006 NOT REQUIRED S21014    */ 01052000
         OI    NOSTDMG(COMBASE),B'00010000'                        0375 01053000
*   CALL SYNTAXA;                   /* GO WRITE MESSAGE S21014       */ 01054000
         BAL   @14,SYNTAXA                                         0376 01055000
*   IF SECLOAD>MODCT THEN           /* IF IN-CORE COUNT DROPS S21014    01056000
*                                      BELOW 2-ARY LOAD POINT, S21014*/ 01057000
         L     @14,MODCT                                           0377 01058000
         C     @14,SECLOAD                                         0377 01059000
         BNL   @RF00377                                            0377 01060000
*     SECLOAD=MODCT+1;              /* RESET 2-ARY POINT S21014      */ 01061000
         AL    @14,@CF00034                                        0378 01062000
         ST    @14,SECLOAD                                         0378 01063000
*   REG15=16;                       /* SET DELETE FAIL RETURN S21014    01064000
*                                      CODE S21014                   */ 01065000
@RF00377 LA    REG15,16                                            0379 01066000
*   RETURN TO SETBR14;              /* RETURN TO EXIT S21014         */ 01067000
         LA    @14,SETBR14                                         0380 01068000
         LM    @00,@12,@SA00004+4                                  0380 01069000
         BR    @14                                                 0380 01070000
*   RESPECIFY                                                      0381 01071000
*     REG15 UNRSTD;                 /*                         Y02006*/ 01072000
*   END DELETE;                     /* S21014                        */ 01073000
         B     @EL00004                                            0382 01074000
*INQ:                                                              0383 01075000
*   PROC OPTIONS(DONTSAVE(2),NOSAVEAREA);                          0383 01076000
INQ      STM   @14,@01,12(@13)                                     0383 01077000
         STM   @03,@12,32(@13)                                     0383 01078000
*   RESPECIFY                                                      0384 01079000
*    (REG1,                                                        0384 01080000
*     REG2,                                                        0384 01081000
*     REG3,                                                        0384 01082000
*     COMBASE) RESTRICTED;          /*                         Y02006*/ 01083000
*   P=INBASE;                       /* POINT TO FIRST BLOCK IN S21014   01084000
*                                      IN-CORE LIST S21014           */ 01085000
*                                                                  0385 01086000
         MVC   P(4),INBASE                                         0385 01087000
*   /*****************************************************************/ 01088000
*   /*                                                               */ 01089000
*   /* LOOP TO LOCATE ITEM IDENTIFIED BY LISTAD                S21014*/ 01090000
*   /*                                                               */ 01091000
*   /*****************************************************************/ 01092000
*                                                                  0386 01093000
*   DO K=1 TO(LISTAD-1)/5;          /* S21014                        */ 01094000
         LA    @11,1                                               0386 01095000
         B     @DE00386                                            0386 01096000
@DL00386 DS    0H                                                  0387 01097000
*     REG3=LINK;                    /* GET ADDR NEXT BLOCK S21014    */ 01098000
         L     @11,P                                               0387 01099000
         L     REG3,LINK(,@11)                                     0387 01100000
*     IF REG3^=0 THEN               /* IS THERE ONE, S21014          */ 01101000
         LTR   REG3,REG3                                           0388 01102000
         BZ    @RF00388                                            0388 01103000
*       P=REG3;                     /* IF SO, POINT TO IT S21014     */ 01104000
         ST    REG3,P                                              0389 01105000
*     ELSE                                                         0390 01106000
*GETBLK:                                                           0390 01107000
*       DO;                         /* IF NOT, GET NEW BLOCK S21014  */ 01108000
         B     @RC00388                                            0390 01109000
@RF00388 DS    0H                                                  0390 01110000
GETBLK   DS    0H                                                  0391 01111000
*         GEN(GETMAIN R,LV=64);     /* S21014                        */ 01112000
         GETMAIN R,LV=64                                                01113000
*         LINK=REG1;                /* SET LINK IN PREVIOUS S21014 0392 01114000
*                                      BLOCK TO ADDR NEW BLOCK S21014*/ 01115000
         L     @11,P                                               0392 01116000
         ST    REG1,LINK(,@11)                                     0392 01117000
*         P=REG1;                   /* POINT TO NEW BLOCK S21014     */ 01118000
         ST    REG1,P                                              0393 01119000
*         LINK=0;                   /* SET LINK IN LAST BLOCK S21014    01120000
*                                      TO INDICATE LAST BLOCK S21014 */ 01121000
         L     @11,P                                               0394 01122000
         SLR   @15,@15                                             0394 01123000
         ST    @15,LINK(,@11)                                      0394 01124000
*       END GETBLK;                 /* S21014                        */ 01125000
*   END;                            /* S21014                        */ 01126000
@RC00388 LA    @11,1                                               0396 01127000
         AL    @11,K                                               0396 01128000
@DE00386 ST    @11,K                                               0396 01129000
         L     @04,LISTAD                                          0396 01130000
         BCTR  @04,0                                               0396 01131000
         SRDA  @04,32                                              0396 01132000
         D     @04,@CF00123                                        0396 01133000
         CR    @11,@05                                             0396 01134000
         BNH   @DL00386                                            0396 01135000
*   IF INQCODE=0 THEN                                              0397 01136000
         CLI   INQCODE,0                                           0397 01137000
         BNE   @RF00397                                            0397 01138000
*     DO;                           /* TEST FUNCTION. IF JUST S21014    01139000
*                                      REFERENCING ENTRY, S21014   0398 01140000
*                                      RETURN ADDR IN REG 2 S21014   */ 01141000
*       REG2=P+12*((LISTAD-1)//5);  /* S01980                        */ 01142000
         L     @04,LISTAD                                          0399 01143000
         BCTR  @04,0                                               0399 01144000
         SRDA  @04,32                                              0399 01145000
         D     @04,@CF00123                                        0399 01146000
         MH    @04,@CH00100                                        0399 01147000
         AL    @04,P                                               0399 01148000
         LR    REG2,@04                                            0399 01149000
*       RETURN;                     /* S21014                        */ 01150000
@EL00005 DS    0H                                                  0400 01151000
@EF00005 DS    0H                                                  0400 01152000
@ER00005 LM    @14,@01,12(@13)                                     0400 01153000
         LM    @03,@12,32(@13)                                     0400 01154000
         BR    @14                                                 0400 01155000
*     END;                          /* S21014                        */ 01156000
*   ELSE                                                           0402 01157000
*DEQBLK:                                                           0402 01158000
*     DO;                           /* IF DEQ FUNCTION, FREE S21014     01159000
*                                      ALL REMAINNING BLOCKS S21014  */ 01160000
@RF00397 DS    0H                                                  0402 01161000
DEQBLK   DS    0H                                                  0403 01162000
*       REG3=LINK;                  /* GET ADDRESS OF FIRST S21014 0403 01163000
*                                      BLOCK TO BE FREED S21014      */ 01164000
         L     @11,P                                               0403 01165000
         L     REG3,LINK(,@11)                                     0403 01166000
*       LINK=0;                     /* SET LINK IN CURRENT BLOCK TO     01167000
*                                      IND. LAST S21014              */ 01168000
         SLR   @15,@15                                             0404 01169000
         ST    @15,LINK(,@11)                                      0404 01170000
*TEST4END:                                                         0405 01171000
*       IF REG3=0 THEN              /* AT END OF QUEUE, S21014       */ 01172000
TEST4END LTR   REG3,REG3                                           0405 01173000
         BZ    @RT00405                                            0405 01174000
*         RETURN;                   /* IF SO, RETURN S21014          */ 01175000
*       P=REG3;                     /* IF NOT AT END, POINT TO S21014   01176000
*                                      NEXT BLOCK S21014             */ 01177000
         ST    REG3,P                                              0407 01178000
*       REG3=LINK;                  /* SAVE LINK FROM THIS BLK S21014*/ 01179000
         L     @11,P                                               0408 01180000
         L     REG3,LINK(,@11)                                     0408 01181000
*       REG1=P;                     /* ADDR OF BLK TO BE FREED S21014   01182000
*                                      FOR FREEMAIN S21014           */ 01183000
         LR    REG1,@11                                            0409 01184000
*       GEN(FREEMAIN R,LV=64,A=(1));/* S21014                        */ 01185000
         FREEMAIN R,LV=64,A=(1)                                         01186000
*       GO TO TEST4END;             /* GO FREE NEXT VLOCK S21014     */ 01187000
         B     TEST4END                                            0411 01188000
*     END DEQBLK;                   /* S21014                        */ 01189000
*   END INQ;                        /* S21014                        */ 01190000
         B     @EL00005                                            0413 01191000
*TODCNVRT:                                                         0414 01192000
*   PROC OPTIONS(SAVE,NOSAVEAREA);                                 0414 01193000
*                                                                  0414 01194000
TODCNVRT STM   @14,@12,12(@13)                                     0414 01195000
*   /*****************************************************************/ 01196000
*   /*                                                               */ 01197000
*   /* POINTERS AND WORK REGISTERS USED BY TODCNVRT                  */ 01198000
*   /*                                                               */ 01199000
*   /*****************************************************************/ 01200000
*                                                                  0415 01201000
*   DCL                                                            0415 01202000
*     PARMREG1 PTR(31) REG(1);      /* INPUT PARM REG POINTS TO    0415 01203000
*                                      PARMLIST. Y01980              */ 01204000
*   DCL                                                            0416 01205000
*     PARMREG2 PTR(31) REG(2);      /* INPUT PARM REG CONTAINING   0416 01206000
*                                      REQUEST CODE. ALSO USED AS A     01207000
*                                      WORK REG WHEN UNPACKING.Y01980*/ 01208000
*   DCL                                                            0417 01209000
*     L PTR(31) REG(4);             /* REGISTER USED FOR DIVIDES.  0417 01210000
*                                      WILL NORMALLY CONTAIN THE   0417 01211000
*                                      REMAINDER Y01980              */ 01212000
*   DCL                                                            0418 01213000
*     W PTR(31) REG(5);             /* REGISTER USED FOR DIVIDES.  0418 01214000
*                                      WILL NORMALLY CONTAIN THE   0418 01215000
*                                      QUOTIENT.               Y01980*/ 01216000
*   DCL                                                            0419 01217000
*     DAYREG PTR(31) REG(3);        /* USED TO CALCULATE CURRENT DAY    01218000
*                                                              Y01980*/ 01219000
*   DCL                                                            0420 01220000
*     YEARREG PTR(31) REG(6);       /* USED TO CALCULATE CURRENT YR     01221000
*                                                              Y01980*/ 01222000
*                                                                  0420 01223000
*   /*****************************************************************/ 01224000
*   /*                                                               */ 01225000
*   /* THE FOLLOWING STRUCTURE DESCRIBES THE PARAMETER LIST FORMAT   */ 01226000
*   /* AND IS USED TO REFERENCE THE PARAMETER LIST                   */ 01227000
*   /*                                                               */ 01228000
*   /*****************************************************************/ 01229000
*                                                                  0421 01230000
*   DCL                                                            0421 01231000
*     1 INPUTLST BASED(PARMREG1),   /* INPUT PARMLIST          Y01980*/ 01232000
*       3 CVTTZPTR PTR(31),         /* ADDR OF CVTTZ VALUE     Y01980*/ 01233000
*       3 TODPTR PTR(31),           /* ADDR OF TOD CLOCK VALUE Y01980*/ 01234000
*       3 OUTAREA PTR(31);          /* ADDR OF OUTPUT AREA     Y01980*/ 01235000
*                                                                  0421 01236000
*   /*****************************************************************/ 01237000
*   /*                                                               */ 01238000
*   /* CVRTAREA IS A DOUBLE WORD AREA INTO WHICH THE TOD VALUE IS    */ 01239000
*   /* INITIALLY MOVED SO IT IS ALIGNED ON A WORD BOUNDARY FOR       */ 01240000
*   /* CONVERSION TO LOCAL TIME. CVRTAREA IS ALSO USED AS A WORKAREA */ 01241000
*   /* WHEN CONVERTING TO DECIMAL                                    */ 01242000
*   /*                                                               */ 01243000
*   /*****************************************************************/ 01244000
*                                                                  0422 01245000
*   DCL                                                            0422 01246000
*     1 CVRTAREA CHAR(8) BDY(DWORD),/* WORK AREA               Y01980*/ 01247000
*       3 TODWORD1 FIXED(31),       /* BITS 0-31 OF TOD VALUE  Y01980*/ 01248000
*       3 TODWORD2 FIXED(31);       /* BITS 32-63 OF TOD VALUE Y01980*/ 01249000
*                                                                  0422 01250000
*   /*****************************************************************/ 01251000
*   /*                                                               */ 01252000
*   /* CVTTZVAL AND TODVALUE ARE BASED VARIABLES USED WHEN           */ 01253000
*   /* RERERENCING THE CVTTZ AND TOD CLOCK VALUES POINTED TO BY THE  */ 01254000
*   /* INPUT PARM LIST. TIMEAREA IS USED TO REFERENCE THE OUTPUT AREA*/ 01255000
*   /* IN WHICH THE CONVERTED TIME IS PLACED.                        */ 01256000
*   /*                                                               */ 01257000
*   /*****************************************************************/ 01258000
*                                                                  0423 01259000
*   DCL                                                            0423 01260000
*     CVTTZVAL FIXED(31) BDY(WORD,2) BASED(CVTTZPTR);/* CVTTZ VALUE     01261000
*                                      PARAMETER               Y01980*/ 01262000
*   DCL                                                            0424 01263000
*     TODVALUE CHAR(8) BASED(TODPTR);/* TOD CLOCK VALUE PARAMETER  0424 01264000
*                                                              Y01980*/ 01265000
*   DCL                                                            0425 01266000
*     TIMEAREA(24) CHAR(1) BASED(OUTAREA);/* TIME OUTPUT AREA  Y01980*/ 01267000
*   DCL                                                            0426 01268000
*     TIMEERIA CHAR(24) BASED(OUTAREA);/* USED TO REFERENCE OUTPUT 0426 01269000
*                                      AREA WHEN MOVING IN A ZERO  0426 01270000
*                                      TIME DUE TO A ZERO INPUT TOD     01271000
*                                      VALUE                   Y01980*/ 01272000
*                                                                  0426 01273000
*   /*****************************************************************/ 01274000
*   /*                                                               */ 01275000
*   /* TODBRTAB IS USED TO PASS CONTROL TO THE PROPER TOD CONVERSION */ 01276000
*   /* ROUTINE. THE REQUEST CODE PASSED IN PARMREG2 IS USED TO INDEX */ 01277000
*   /* THE TABLE. THE POSSIBLE CODES AND ASSOCIATED ROUTINE ENTRY    */ 01278000
*   /* POINTS ARE AS FOLLOWS: CODE ENTRY TYPE OF CONVERSION 1        */ 01279000
*   /* FULLDATE CONVERT TO A FULL DATE AND TIME 2 RELTVTME CONVERT TO*/ 01280000
*   /* RELATIVE TIME                                                 */ 01281000
*   /*                                                               */ 01282000
*   /*****************************************************************/ 01283000
*                                                                  0427 01284000
*   DCL                                                            0427 01285000
*    (FULLDATE,                                                    0427 01286000
*     RELTVTME) LABEL;              /* ENTRY LABELS FOR BRNCH TABLE     01287000
*                                                              Y01980*/ 01288000
*   DCL                                                            0428 01289000
*     TODBRTAB(2) PTR(31)           /* TOD BRANCH TABLE        Y01980*/ 01290000
*         INIT(ADDR(FULLDATE),      /* FULLDATE CONVERSION ROUTINE 0428 01291000
*                                                              Y01980*/ 01292000
*         ADDR(RELTVTME));          /* RELATIVE TIME CONVERSION RTN     01293000
*                                                              Y01980*/ 01294000
*                                                                  0428 01295000
*   /*****************************************************************/ 01296000
*   /*                                                               */ 01297000
*   /* CONSTANTS AND WORK VARIABLES                                  */ 01298000
*   /*                                                               */ 01299000
*   /*****************************************************************/ 01300000
*                                                                  0429 01301000
*   DCL                                                            0429 01302000
*     SIXTYMIL FIXED(31) INIT(60000000);/* NUMBER OF MICRO SECONDS IN   01303000
*                                      A MINUTE                Y01980*/ 01304000
*   DCL                                                            0430 01305000
*     ZEROTOD CHAR(8) INIT('0000000000000000'X);/* USED TO CHK FOR 0430 01306000
*                                      ZERO TOD VALUE IN INPUT Y01980*/ 01307000
*   DCL                                                            0431 01308000
*     ZEROTIME CHAR(12) INIT('00000.000000');/* RELATIVE TIME      0431 01309000
*                                      RETURNED WHEN WHEN TOD VALUE     01310000
*                                      IS ZERO FOR A RELATIVE TIME 0431 01311000
*                                      CONVERSION REQUEST      Y01980*/ 01312000
*   DCL                                                            0432 01313000
*     NULLTIME CHAR(22) INIT('000000000.00.00.000000');/* FULL DATE     01314000
*                                      AND TIME RETURNED WHEN TOD  0432 01315000
*                                      VALUE IS ZERO FOR A FULL DATE    01316000
*                                      CON- VERSION REQUEST.   Y01980*/ 01317000
*   DCL                                                            0433 01318000
*     TIMELEFT FIXED(31);           /* USED TO SAVE TIME REMAINING TO   01319000
*                                      BE CONVERTED            Y01980*/ 01320000
*   DCL                                                            0434 01321000
*     SECONDS FIXED(31) BASED(ADDR(TIMELEFT));/* USED BY RELATIVE  0434 01322000
*                                      TIME CONVERSION ROUTINE TO  0434 01323000
*                                      SAVE SECONDS            Y01980*/ 01324000
*                                                                  0434 01325000
*   /*****************************************************************/ 01326000
*   /*                                                               */ 01327000
*   /* RESTRICTED REGISTERS                                          */ 01328000
*   /*                                                               */ 01329000
*   /*****************************************************************/ 01330000
*                                                                  0435 01331000
*   RESPECIFY                                                      0435 01332000
*    (PARMREG1,                                                    0435 01333000
*     PARMREG2) RESTRICTED;         /*                         Y02006   01334000
*                                      RESTRICT PARM REGISTERS Y01980*/ 01335000
*   RESPECIFY                                                      0436 01336000
*    (W,                                                           0436 01337000
*     L,                                                           0436 01338000
*     DAYREG,                                                      0436 01339000
*     YEARREG) RESTRICTED;          /*                         Y02006   01340000
*                                      RESTRICT WORK REGISTERS Y01980*/ 01341000
*   RESPECIFY                                                      0437 01342000
*    (BASE1,                                                       0437 01343000
*     COMBASE) RESTRICTED;          /*                         Y02006*/ 01344000
*                                                                  0437 01345000
*   /*****************************************************************/ 01346000
*   /*                                                               */ 01347000
*   /* RESTRICT COMMON AND BASE                                Y01980*/ 01348000
*   /* BEGIN TIME OF DAY CONVERSION. MOVE THE TOD VALUE TO A DOUBLE  */ 01349000
*   /* IF INPUT IS FROM SVC DUMP, TOD VALUE IS NOT CONVERTED WORD    */ 01350000
*   /* AREA AND ADD THE CVTTZ VALUE TO TOD BIT POSITIONS 0-31.       */ 01351000
*   /*                                                               */ 01352000
*   /*****************************************************************/ 01353000
*                                                                  0438 01354000
*   GEN(BALR BASE1,0);              /* ESTABLISH Y01980              */ 01355000
         BALR BASE1,0                                                   01356000
*   GEN(USING *,BASE1);             /* ADDRESSABILITY Y01980         */ 01357000
         USING *,BASE1                                                  01358000
*   CVRTAREA=TODVALUE;              /* MOVE TOD VALUE TO A DOUBLEWORD   01359000
*                                      WORKAREA                Y01980*/ 01360000
         L     @07,TODPTR(,PARMREG1)                               0440 01361000
         MVC   CVRTAREA(8),TODVALUE(@07)                           0440 01362000
*   IF QSADMP='1'B THEN             /* IF INPUT IS SADMP,    @ZA00410*/ 01363000
         TM    QSADMP(COMBASE),B'00100000'                         0441 01364000
         BNO   @RF00441                                            0441 01365000
*     TODWORD1=TODWORD1+CVTTZVAL;   /* CHANGE TOD TO LOCAL TIMEY01980*/ 01366000
*                                                                  0442 01367000
         L     @07,CVTTZPTR(,PARMREG1)                             0442 01368000
         MVC   @TF00001(4),CVTTZVAL(@07)                           0442 01369000
         L     @07,@TF00001                                        0442 01370000
         AL    @07,TODWORD1                                        0442 01371000
         ST    @07,TODWORD1                                        0442 01372000
*   /*****************************************************************/ 01373000
*   /*                                                               */ 01374000
*   /* CALCULATE TOTAL NUMBER OF MINUTES SINCE THE EPOCH TIME THE    */ 01375000
*   /* NUMBER OF MICROSECONDS THAT HAVE PASSED IN THE CURRENT MINUTE.*/ 01376000
*   /*                                                               */ 01377000
*   /*****************************************************************/ 01378000
*                                                                  0443 01379000
*   GEN(LM L,W,CVRTAREA);           /* PUT TOD VALUE IN EVEN-ODD   0443 01380000
*                                      REGISTER PAIR           Y01980*/ 01381000
@RF00441 DS    0H                                                  0443 01382000
         LM L,W,CVRTAREA                                                01383000
*   GEN(SRDL L,12);                 /* SHIFT TOD VALUE TO REMOVE THE    01384000
*                                      INSIGNIFICANT BITS      Y01980*/ 01385000
         SRDL L,12                                                      01386000
*   GEN(D L,SIXTYMIL);              /* DIVID TOD VALUE BY NUMBER OF     01387000
*                                      MICROSECONDS IN A MINUTE. W -    01388000
*                                      CONTAINS TOTAL MINUTES SINCE     01389000
*                                      THE EPOCH TIME          Y01980   01390000
*                                      L - CONTAINS TOTAL NUMBER OF     01391000
*                                      MICROSECONDS INTO CURRENT   0445 01392000
*                                      MINUTE                  Y01980*/ 01393000
*                                                                  0445 01394000
         D L,SIXTYMIL                                                   01395000
*   /*****************************************************************/ 01396000
*   /*                                                               */ 01397000
*   /* GO TO PROPER CONVERSION ROUTINE FOR PROCESSING THIS TOD       */ 01398000
*   /* CONVERT REQUEST. USE THE REQUEST CODE IN PARMREG2 TO INDEX THE*/ 01399000
*   /* TODBRTAB. THE CODES AND ASSOCIATED ROUTINE ENTRY LABELS ARE AS*/ 01400000
*   /* FOLLOWS: CODE ENTRY TYPE OF CONVERSION 1 FULLDATE CONVERT TO A*/ 01401000
*   /* FULL DATE AND TIME 2 RELTVTME CONVERT TO RELATIVE TIME        */ 01402000
*   /*                                                               */ 01403000
*   /*****************************************************************/ 01404000
*                                                                  0446 01405000
*   GOTO TODBRTAB(PARMREG2);        /* BRANCH ON REQUEST CODE  Y01980*/ 01406000
         LR    @07,PARMREG2                                        0446 01407000
         SLA   @07,2                                               0446 01408000
         L     @07,TODBRTAB-4(@07)                                 0446 01409000
         BR    @07                                                 0446 01410000
*                                                                  0447 01411000
*   /*****************************************************************/ 01412000
*   /*                                                               */ 01413000
*   /* RELATIVE TIME CONVERSION -- THIS ROUTINE RECEIVES CONTROL AT  */ 01414000
*   /* ENTRY 'RELTVTME'. IT CONVERTS THE TOD VALUE TO RELATIVE       */ 01415000
*   /* SECONDS.MICROSECONDS FROM 0 A.M. OF THE CURRENT DAY REFLECTED */ 01416000
*   /* BY THE TOD VALUE. THE CONVERTED TIME IS PLACED LEFT JUSTIFIED */ 01417000
*   /* IN THE OUTPUT AREA PASSED BY THE TODCVRT CALLER AND IS IN THE */ 01418000
*   /* FORM SSSSS.MMMMMM (EBCDIC). UPON ENTRY TO THIS ROUTINE THE TOD*/ 01419000
*   /* VALUE HAS ALREADY BEEN CHANGED TO TOTAL MINUTES (IN W) AND    */ 01420000
*   /* NUMBER OF MICROSECONDS INTO CURRENT MINUTE (IN L). WHEN       */ 01421000
*   /* PROCESSING IS COMPLETED CONTROL IS RETURNED TO THE TODCNVRT   */ 01422000
*   /* CALLER                                                        */ 01423000
*   /*                                                               */ 01424000
*   /*****************************************************************/ 01425000
*                                                                  0447 01426000
*RELTVTME:                                                         0447 01427000
*   IF TODVALUE=ZEROTOD THEN        /* IS TOD VALUE ZERO ?     Y01980*/ 01428000
RELTVTME L     @07,TODPTR(,PARMREG1)                               0447 01429000
         CLC   TODVALUE(8,@07),ZEROTOD                             0447 01430000
         BNE   @RF00447                                            0447 01431000
*     DO;                           /* YES, PASS BACK A TIME OF ZERO */ 01432000
*       TIMEERIA=ZEROTIME;          /* MOVE ZERO TIME INTO OUT AREA     01433000
*                                                              Y01980*/ 01434000
         L     @07,OUTAREA(,PARMREG1)                              0449 01435000
         MVI   TIMEERIA+12(@07),C' '                               0449 01436000
         MVC   TIMEERIA+13(11,@07),TIMEERIA+12(@07)                0449 01437000
         MVC   TIMEERIA(12,@07),ZEROTIME                           0449 01438000
*       RETURN CODE(4);             /* INDICATE ZERO TOD TO CALLER 0450 01439000
*                                                              Y01980*/ 01440000
         LA    @15,4                                               0450 01441000
         L     @14,12(,@13)                                        0450 01442000
         LM    @00,@12,20(@13)                                     0450 01443000
         BR    @14                                                 0450 01444000
*     END;                                                         0451 01445000
*   SECONDS=L/1000000;              /* CALCULATE NUMBER OF SECONDS 0452 01446000
*                                      INTO CURRENT MINUTE.    Y01980*/ 01447000
@RF00447 LA    @07,TIMELEFT                                        0452 01448000
         L     @15,@CF01247                                        0452 01449000
         ST    @15,@TF00001                                        0452 01450000
         LR    @15,L                                               0452 01451000
         SLR   @14,@14                                             0452 01452000
         D     @14,@TF00001                                        0452 01453000
         ST    @15,SECONDS(,@07)                                   0452 01454000
*   L=L//1000000;                   /* CALCULATE NUMBER OF MICROSECS    01455000
*                                      INTO CURRENT SECOND     Y01980*/ 01456000
         LR    @14,L                                               0453 01457000
         SRDA  @14,32                                              0453 01458000
         D     @14,@TF00001                                        0453 01459000
         LR    L,@14                                               0453 01460000
*   PARMREG2=ADDR(TIMEAREA(7));     /* GET ADDROF OUTPUT LOCATION IN    01461000
*                                      WHICH CONVERTED MICROSECS ARE    01462000
*                                      TO BE PLACED            Y01980*/ 01463000
*                                                                  0454 01464000
         L     PARMREG2,OUTAREA(,PARMREG1)                         0454 01465000
         LA    PARMREG2,TIMEAREA+6(,PARMREG2)                      0454 01466000
*   /*****************************************************************/ 01467000
*   /*                                                               */ 01468000
*   /* CONVERT MICROSECONDS TO EBCDIC                                */ 01469000
*   /*                                                               */ 01470000
*   /*****************************************************************/ 01471000
*                                                                  0455 01472000
*   GEN(CVD L,CVRTAREA);            /* CNVRT MICROSECONDS TO DECIMAL    01473000
*                                                              Y02006*/ 01474000
         CVD L,CVRTAREA                                                 01475000
*   GEN(UNPK 0(6,PARMREG2),CVRTAREA+4(4));/* UNPACK MICROSECONDS   0456 01476000
*                                                              Y01980*/ 01477000
         UNPK 0(6,PARMREG2),CVRTAREA+4(4)                               01478000
*   GEN(OI 5(PARMREG2),X'F0');      /* CHANGE SIGN TO A NUMERIC ZONE    01479000
*                                                              Y01980*/ 01480000
         OI 5(PARMREG2),X'F0'                                           01481000
*   TIMEAREA(6)='.';                /* INSERT SEPARATER        Y01980*/ 01482000
*                                                                  0458 01483000
         L     @07,OUTAREA(,PARMREG1)                              0458 01484000
         MVI   TIMEAREA+5(@07),C'.'                                0458 01485000
*   /*****************************************************************/ 01486000
*   /*                                                               */ 01487000
*   /* CALCULATE NUMBER OF SECONDS INTO CURRENT DAY AND CONVERT TO   */ 01488000
*   /* EBCDIC                                                        */ 01489000
*   /*                                                               */ 01490000
*   /*****************************************************************/ 01491000
*                                                                  0459 01492000
*   L=((W//1440)*60)+SECONDS;       /* CALC SECONDS INTO CUR DAY   0459 01493000
*                                                              Y01980*/ 01494000
         LR    @14,W                                               0459 01495000
         SRDA  @14,32                                              0459 01496000
         D     @14,@CF01250                                        0459 01497000
         MH    @14,@CH00119                                        0459 01498000
         LA    @15,TIMELEFT                                        0459 01499000
         AL    @14,SECONDS(,@15)                                   0459 01500000
         LR    L,@14                                               0459 01501000
*   PARMREG2=ADDR(TIMEAREA(1));     /* GET ADDR OF OUTPUT LOCATION IN   01502000
*                                      WHICH CONVERTED SECONDS ARE TO   01503000
*                                      BE PLACED               Y01980*/ 01504000
         LR    PARMREG2,@07                                        0460 01505000
*   GEN(CVD L,CVRTAREA);            /* CONVRT SECONDS TO DECIMAL   0461 01506000
*                                                              Y01980*/ 01507000
         CVD L,CVRTAREA                                                 01508000
*   GEN(UNPK 0(5,PARMREG2),CVRTAREA+5(3));/* UNPACK SECONDS    Y01980*/ 01509000
         UNPK 0(5,PARMREG2),CVRTAREA+5(3)                               01510000
*   GEN(OI 4(PARMREG2),X'F0');      /* CHANGE SIGN TO A NUMERIC ZONE    01511000
*                                                              Y01980*/ 01512000
         OI 4(PARMREG2),X'F0'                                           01513000
*   RETURN CODE(0);                 /* INDICATE TOD VALUE WAS CNVRTED   01514000
*                                                              Y01980   01515000
*                                      EXIT TO THE TODCNVRT CALLER 0464 01516000
*                                                              Y01980*/ 01517000
         SLR   @15,@15                                             0464 01518000
         L     @14,12(,@13)                                        0464 01519000
         LM    @00,@12,20(@13)                                     0464 01520000
         BR    @14                                                 0464 01521000
*                                                                  0465 01522000
*   /*****************************************************************/ 01523000
*   /*                                                               */ 01524000
*   /* FULL DATA AND TIME CONVERSION -- THIS ROUTINE RECEIVES CONTROL*/ 01525000
*   /* AT ENTRY LABEL 'FULLDATE'. IT CONVERTS THE TOD VALUE TO YEAR, */ 01526000
*   /* JULIAN DAY, HOURS, MINUTES, SECONDS, AND MICROSECONDS. THE    */ 01527000
*   /* CONVERTED TIME IS PLACED LEFT JUSTIFIED IN THE OUTPUT AREA    */ 01528000
*   /* PASSED BY THE TODCNVRT CALLER AND IS IN THE FORM              */ 01529000
*   /* YYYYDDDHH.MM.SS.MMMMMM (EBCDIC). UPON ENTRY TO THIS ROUTINE   */ 01530000
*   /* THE TOD VALUE HAS ALREADY BEEN CHANGED TO TOTAL MINUTES SINCE */ 01531000
*   /* EPOCH (IN W) AND NUMBER OF MICROSECONDS INTO CURRENT MINUTE   */ 01532000
*   /* (IN L). WHEN PROCESSING IS COMPLETED CONTROL IS RETURNED TO   */ 01533000
*   /* THE TODCNVRT CALLER.                                          */ 01534000
*   /*                                                               */ 01535000
*   /*****************************************************************/ 01536000
*                                                                  0465 01537000
*FULLDATE:                                                         0465 01538000
*   IF TODVALUE=ZEROTOD THEN        /* IS TOD VALUE ZERO ?     Y01980*/ 01539000
FULLDATE L     @07,TODPTR(,PARMREG1)                               0465 01540000
         CLC   TODVALUE(8,@07),ZEROTOD                             0465 01541000
         BNE   @RF00465                                            0465 01542000
*     DO;                           /* YES, PASS BACK A TIME OF ZERO    01543000
*                                                              Y01980*/ 01544000
*       TIMEERIA=NULLTIME;          /* MOVE ZERO TIME INTO OUT AREA     01545000
*                                                              Y01980*/ 01546000
         L     @07,OUTAREA(,PARMREG1)                              0467 01547000
         MVI   TIMEERIA+22(@07),C' '                               0467 01548000
         MVI   TIMEERIA+23(@07),C' '                               0467 01549000
         MVC   TIMEERIA(22,@07),NULLTIME                           0467 01550000
*       RETURN CODE(4);             /* INDICATE ZERO TOD TO CALLER 0468 01551000
*                                                              Y01980*/ 01552000
         LA    @15,4                                               0468 01553000
         L     @14,12(,@13)                                        0468 01554000
         LM    @00,@12,20(@13)                                     0468 01555000
         BR    @14                                                 0468 01556000
*     END;                                                         0469 01557000
*   SECONDS=L/1000000;              /* CALCULATE NUMBER OF SECONDS 0470 01558000
*                                                              Y01980*/ 01559000
@RF00465 LA    @07,TIMELEFT                                        0470 01560000
         L     @15,@CF01247                                        0470 01561000
         ST    @15,@TF00001                                        0470 01562000
         LR    @15,L                                               0470 01563000
         SLR   @14,@14                                             0470 01564000
         D     @14,@TF00001                                        0470 01565000
         ST    @15,SECONDS(,@07)                                   0470 01566000
*   L=L//1000000;                   /* CALCULATE NO. OF MICROSECONDS    01567000
*                                                              Y01980*/ 01568000
*                                                                  0471 01569000
         LR    @14,L                                               0471 01570000
         SRDA  @14,32                                              0471 01571000
         D     @14,@TF00001                                        0471 01572000
         LR    L,@14                                               0471 01573000
*   /*****************************************************************/ 01574000
*   /*                                                               */ 01575000
*   /* CONVERT MICROSECONDS TO EBCDIC IN THE OUTPUT AREA             */ 01576000
*   /*                                                               */ 01577000
*   /*****************************************************************/ 01578000
*                                                                  0472 01579000
*   PARMREG2=ADDR(TIMEAREA(17));    /* GET ADDR OF OUTPUT LOCATION IN   01580000
*                                      WHICH CONVERTED MICROSECS ARE    01581000
*                                      TO BE PLACED            Y01980*/ 01582000
         L     PARMREG2,OUTAREA(,PARMREG1)                         0472 01583000
         LA    PARMREG2,TIMEAREA+16(,PARMREG2)                     0472 01584000
*   GEN(CVD L,CVRTAREA);            /* CNVRT MICROSECONDS TO DECIMAL    01585000
*                                                              Y01980*/ 01586000
         CVD L,CVRTAREA                                                 01587000
*   GEN(UNPK 0(6,PARMREG2),CVRTAREA+4(4));/* UNPACK MICROSECONDS   0474 01588000
*                                                              Y01980*/ 01589000
         UNPK 0(6,PARMREG2),CVRTAREA+4(4)                               01590000
*   GEN(OI 5(PARMREG2),X'F0');      /* CHANGE SIGN TO A NUMERIC ZONE    01591000
*                                                              Y01980*/ 01592000
         OI 5(PARMREG2),X'F0'                                           01593000
*   TIMEAREA(16)='.';               /* INSERT SEPARATER        Y01980*/ 01594000
*                                                                  0476 01595000
         L     @07,OUTAREA(,PARMREG1)                              0476 01596000
         MVI   TIMEAREA+15(@07),C'.'                               0476 01597000
*   /*****************************************************************/ 01598000
*   /*                                                               */ 01599000
*   /* CONVERT SECONDS TO EBCDIC IN THE OUTPUT AREA                  */ 01600000
*   /*                                                               */ 01601000
*   /*****************************************************************/ 01602000
*                                                                  0477 01603000
*   L=SECONDS;                      /* GET NUMBER OF SECONDS   Y01980*/ 01604000
         LA    @15,TIMELEFT                                        0477 01605000
         L     L,SECONDS(,@15)                                     0477 01606000
*   PARMREG2=ADDR(TIMEAREA(14));    /* GET ADDR OF OUTPUT LOCATION IN   01607000
*                                      WHICH CONVERTED SECONDS ARE TO   01608000
*                                      BE PLACED               Y01980*/ 01609000
         LA    PARMREG2,TIMEAREA+13(,@07)                          0478 01610000
*   GEN(CVD L,CVRTAREA);            /* CNVRT SECONDS TO DECIMALY01980*/ 01611000
         CVD L,CVRTAREA                                                 01612000
*   GEN(UNPK 0(2,PARMREG2),CVRTAREA+6(2));/* UNPACK SECONDS    Y01980*/ 01613000
         UNPK 0(2,PARMREG2),CVRTAREA+6(2)                               01614000
*   GEN(OI 1(PARMREG2),X'F0');      /* CHANGE SIGN TO A NUMERIC ZONE    01615000
*                                                              Y01980*/ 01616000
         OI 1(PARMREG2),X'F0'                                           01617000
*   TIMEAREA(13)='.';               /* INSERT SEPARATER        Y01980*/ 01618000
*                                                                  0482 01619000
         L     @07,OUTAREA(,PARMREG1)                              0482 01620000
         MVI   TIMEAREA+12(@07),C'.'                               0482 01621000
*   /*****************************************************************/ 01622000
*   /*                                                               */ 01623000
*   /* CALCULATE NUMBER OF MINUTES INTO CURRENT HOUR AND CONVERT THE */ 01624000
*   /* RESULT TO EBCDIC IN THE OUTPUT AREA. W CONTAINS TOTAL NUMBER  */ 01625000
*   /* OF MINUTES FROM THE EPOCH                                     */ 01626000
*   /*                                                               */ 01627000
*   /*****************************************************************/ 01628000
*                                                                  0483 01629000
*   TIMELEFT=W/60;                  /* CALC TOTAL HOURS SINCE EPOCH     01630000
*                                                              Y01980*/ 01631000
         LA    @15,60                                              0483 01632000
         ST    @15,@TF00001                                        0483 01633000
         LR    @15,W                                               0483 01634000
         SLR   @14,@14                                             0483 01635000
         D     @14,@TF00001                                        0483 01636000
         ST    @15,TIMELEFT                                        0483 01637000
*   L=W//60;                        /* CALC MINUTES INTO CURRENT HR     01638000
*                                                              Y01980*/ 01639000
         LR    @14,W                                               0484 01640000
         SRDA  @14,32                                              0484 01641000
         D     @14,@TF00001                                        0484 01642000
         LR    L,@14                                               0484 01643000
*   PARMREG2=ADDR(TIMEAREA(11));    /* GET ADDR OF OUTPUT LOCATION IN   01644000
*                                      WHICH CONVERTED MINUTES ARE TO   01645000
*                                      BE PLACED               Y01980*/ 01646000
         LA    PARMREG2,TIMEAREA+10(,@07)                          0485 01647000
*   GEN(CVD L,CVRTAREA);            /* CONVERT MINUTES TO DECIMAL  0486 01648000
*                                                              Y01980*/ 01649000
         CVD L,CVRTAREA                                                 01650000
*   GEN(UNPK 0(2,PARMREG2),CVRTAREA+6(2));/* UNPACK MINUTES    Y01980*/ 01651000
         UNPK 0(2,PARMREG2),CVRTAREA+6(2)                               01652000
*   GEN(OI 1(PARMREG2),X'F0');      /* CHANGE SIGN TO A NUMERIC ZONE    01653000
*                                                              Y01980*/ 01654000
         OI 1(PARMREG2),X'F0'                                           01655000
*   TIMEAREA(10)='.';               /* INSERT SEPARATER        Y01980*/ 01656000
*                                                                  0489 01657000
         L     @07,OUTAREA(,PARMREG1)                              0489 01658000
         MVI   TIMEAREA+9(@07),C'.'                                0489 01659000
*   /*****************************************************************/ 01660000
*   /*                                                               */ 01661000
*   /* CALCULATE NUMBER OF HOURS INTO CURRENT DAY AND CONVERT THE    */ 01662000
*   /* RESULT TO EBCDIC IN THE OUTPUT AREA. TIMELEFT CONTAINS TOTAL  */ 01663000
*   /* NUMBER OF HOURS SINCE THE EPOCH.                              */ 01664000
*   /*                                                               */ 01665000
*   /*****************************************************************/ 01666000
*                                                                  0490 01667000
*   W=TIMELEFT;                     /* GET TOTAL HOURS SINCE EPOCH 0490 01668000
*                                                              Y01980*/ 01669000
         L     W,TIMELEFT                                          0490 01670000
*   TIMELEFT=W/24;                  /* CALC TOTAL DAYS SINCE EPOCH 0491 01671000
*                                                              Y01980*/ 01672000
         LA    @15,24                                              0491 01673000
         ST    @15,@TF00001                                        0491 01674000
         LR    @15,W                                               0491 01675000
         SLR   @14,@14                                             0491 01676000
         D     @14,@TF00001                                        0491 01677000
         ST    @15,TIMELEFT                                        0491 01678000
*   L=W//24;                        /* CALC HOURS INTO CURRENT DAY 0492 01679000
*                                                              Y01980*/ 01680000
         LR    @14,W                                               0492 01681000
         SRDA  @14,32                                              0492 01682000
         D     @14,@TF00001                                        0492 01683000
         LR    L,@14                                               0492 01684000
*   PARMREG2=ADDR(TIMEAREA(8));     /* GET ADDR OF OUTPUT LOCATION IN   01685000
*                                      WHICH CONVERTED HOURS ARE TO     01686000
*                                      BE PLACED               Y01980*/ 01687000
         LA    PARMREG2,TIMEAREA+7(,@07)                           0493 01688000
*   GEN(CVD L,CVRTAREA);            /* CONVERT HOURS TO DECIMALY01980*/ 01689000
         CVD L,CVRTAREA                                                 01690000
*   GEN(UNPK 0(2,PARMREG2),CVRTAREA+6(2));/* UNPACK HOURS      Y01980*/ 01691000
         UNPK 0(2,PARMREG2),CVRTAREA+6(2)                               01692000
*   GEN(OI 1(PARMREG2),X'F0');      /* CHANGE SIGN TO A NUMERIC ZONE    01693000
*                                                              Y01980*/ 01694000
*                                                                  0496 01695000
         OI 1(PARMREG2),X'F0'                                           01696000
*   /*****************************************************************/ 01697000
*   /*                                                               */ 01698000
*   /* CALCULATE THE CURRENT YEAR AND JULIAN DAY USING 'TIMELEFT'    */ 01699000
*   /* WHICH CONTAINS THE TOTAL NUMBER OF ELAPSED DAYS SINCE 1900.   */ 01700000
*   /* FIRST CHECK WHETHER THE TIME IS IN THE 1900 THROUGH 1903 ERA  */ 01701000
*   /* (I.E., LESS THAN 1460 ELAPSED DAYS). IF SO, THE TIME MUST BE  */ 01702000
*   /* HANDLED IN A SPECIAL WAY SINCE 1900 IS NOT A LEAP YEAR AND    */ 01703000
*   /* EACH YEAR IN THAT FOUR YEAR SPAN THUS CONTAINS EXACTLY 365    */ 01704000
*   /* DAYS. IF THE ELAPSED TIME HOWEVER IS GREATER THAN 1459 DAYS   */ 01705000
*   /* THEN EVERY FOUR YEARS CONTAINS 1461 DAYS RATHER THAN 1460 AND */ 01706000
*   /* THE FIRST YEAR OF EACH GROUP IS A LEAP YEAR. THESE FOUR YEAR  */ 01707000
*   /* GROUPS ARE REFERRED TO AS LEAP YEAR GROUPS (E.G., 1904-1907,  */ 01708000
*   /* 1908-1911, ETC.). THE YEAR AND THE DAY WHEN THE ELAPSED TIME  */ 01709000
*   /* FALLS INTO ONE OF THESE GROUPS MUST BE CALCULATED USING       */ 01710000
*   /* STANDARD FORMULAS DIFFERENT FROM THE FORMULAS USED WHEN THE   */ 01711000
*   /* TIME IS BETWEEN 1900 AND JANUARY 1, 1904.                     */ 01712000
*   /*                                                               */ 01713000
*   /*****************************************************************/ 01714000
*                                                                  0497 01715000
*   IF TIMELEFT<1460 THEN           /* IS TIME ELAPSED WITHIN THE  0497 01716000
*                                      1900 THRU 1903 ERA?     Y01980*/ 01717000
         L     @07,TIMELEFT                                        0497 01718000
         CH    @07,@CH01255                                        0497 01719000
         BNL   @RF00497                                            0497 01720000
*NOLEAPYR:                                                         0498 01721000
*     DO;                           /* YES CALCULATE YEAR AND DAY  0498 01722000
*                                      WITHIN THE 1900 THRU 1903 ERA    01723000
*                                                              Y01980*/ 01724000
NOLEAPYR DS    0H                                                  0499 01725000
*       DAYREG=(TIMELEFT//365)+1;   /* CALCULATE CURRENT DAY   Y01980*/ 01726000
         L     @07,TIMELEFT                                        0499 01727000
         LA    @15,365                                             0499 01728000
         LR    @14,@07                                             0499 01729000
         ST    @15,@TF00001                                        0499 01730000
         SRDA  @14,32                                              0499 01731000
         D     @14,@TF00001                                        0499 01732000
         AL    @14,@CF00034                                        0499 01733000
         LR    DAYREG,@14                                          0499 01734000
*       YEARREG=1900+(TIMELEFT/365);/* CALCULATE CURRENT YR.   Y01980*/ 01735000
         LR    @14,@07                                             0500 01736000
         SRDA  @14,32                                              0500 01737000
         D     @14,@TF00001                                        0500 01738000
         AH    @15,@CH01259                                        0500 01739000
         LR    YEARREG,@15                                         0500 01740000
*     END NOLEAPYR;                                                0501 01741000
*                                                                  0501 01742000
*   /*****************************************************************/ 01743000
*   /*                                                               */ 01744000
*   /* THE TIME ELAPSED IS 1460 OR MORE DAYS (I.E., THE CURRENT YEAR */ 01745000
*   /* AND DAY MUST BE WITHIN A LEAP YEAR GROUP). THUS ADJUST THE    */ 01746000
*   /* ELAPSED TIME CONTAINED IN 'TIMELEFT' SO THAT 1904 CAN BE USED */ 01747000
*   /* AS THE STARTING POINT FOR CALCULATING THE CURRENT YEAR AND    */ 01748000
*   /* DAY. NEXT CALCULATE W, THE RELATIVE LEAP YEAR GROUP SINCE     */ 01749000
*   /* 1904, AND L, THE NUMBER OF DAYS THAT HAVE ELAPSED IN THE      */ 01750000
*   /* CURRENT LEAP YEAR GROUP. FINALLY, USE THESE VALUES IN THE     */ 01751000
*   /* FORMULAS FOR CALCULATING THE CURRENT DAY AND YEAR WHEN ELAPSED*/ 01752000
*   /* TIME IS GREATER THAN 1459. IN THE FORMULA USED TO CALCULATE   */ 01753000
*   /* THE CURRENT JULIAN DAY, THE EXPRESSION IN PARENTHESES IS THE  */ 01754000
*   /* NUMBER OF WHOLE DAYS THAT HAVE PAST IN THE CURRENT YEAR.      */ 01755000
*   /* BECAUSE THE CURRENT DAY HAS NOT YET ELAPSED, IT IS NOT        */ 01756000
*   /* INCLUDED IN THE RESULT PRODUCED BY THE EXPRESSION AND         */ 01757000
*   /* THEREFORE 1 MUST BE ADDED TO GET THE ACTUAL JULIAN DAY. WITHIN*/ 01758000
*   /* THE EXPRESSION THE FIRST TERM, R, MUST BE ADJUSTED BY 1 (I.E.,*/ 01759000
*   /* L/731) IF THE TOTAL DAYS INTO THE LEAP YEAR GROUP IS GREATER  */ 01760000
*   /* OR EQUAL TO 2 YEARS AND AGAIN BY 1 (I.E. L/1096) IF THE TOTAL */ 01761000
*   /* DAYS IS EQUAL TO OR GREATER THAN 3                      YEARS.*/ 01762000
*   /* THE AFFECT OF THIS IS THAT THE SECOND YEAR AND THIRD YEAR ARE */ 01763000
*   /* FORCED TO 366 DAYS ONCE THE TOTAL DAYS INTO THE LEAP YEAR     */ 01764000
*   /* GROUP EXCEEDS EACH OF THESE YEARS. THIS IS NECESSARY BECAUSE A*/ 01765000
*   /* DIVISOR OF 366 IS USED. IN THE FORMULA FOR CALCULATING THE    */ 01766000
*   /* YEAR, 1904 IS THE BASE YEAR. THE SECOND TERM (W * 4) YIELDS   */ 01767000
*   /* THE RELATIVE NUMBER OF YEARS SINCE 1904 UP TO AND INCLUDING   */ 01768000
*   /* THE LEAP YEAR IN THE CURRENT LEAP YEAR GROUP. THE THIRD TERM (*/ 01769000
*   /* (L-1)/365 ) YIELDS THE RELATIVE YEAR WITHIN THE CURRENT LEAP  */ 01770000
*   /* YEAR GROUP. THUS IF THE CURRENT YEAR IS A LEAP YEAR THE       */ 01771000
*   /* RELATIVE YEAR WITHIN THE CURRENT LEAP YEAR GROUP IS 0 AND THE */ 01772000
*   /* THIRD TERM WILL YIELD A RESULT OF ZERO.                       */ 01773000
*   /*                                                               */ 01774000
*   /*****************************************************************/ 01775000
*                                                                  0502 01776000
*   ELSE                                                           0502 01777000
*LEAPYR:                                                           0502 01778000
*     DO;                           /* DATE IS GREATER THAN 1903   0502 01779000
*                                                              Y01980*/ 01780000
         B     @RC00497                                            0502 01781000
@RF00497 DS    0H                                                  0502 01782000
LEAPYR   DS    0H                                                  0503 01783000
*       TIMELEFT=TIMELEFT-1460;     /* ADJUST ELAPSED TIME SO 1904 0503 01784000
*                                      BASE CAN BE USED IN FORMULA 0503 01785000
*                                                              Y01980*/ 01786000
         L     @07,TIMELEFT                                        0503 01787000
         SH    @07,@CH01255                                        0503 01788000
         ST    @07,TIMELEFT                                        0503 01789000
*       W=TIMELEFT/1461;            /* DIVIDE TOTAL DAYS SINCE EPOCH    01790000
*                                      BY NUMBER OF DAYS IN A LEAP 0504 01791000
*                                      YEAR GROUP. THE RESULT, W,  0504 01792000
*                                      WILL BE THE RELATIVE LEAP YEAR   01793000
*                                      GROUP SINCE THE EPOCH.  Y01980*/ 01794000
         LA    @15,1461                                            0504 01795000
         LR    @14,@07                                             0504 01796000
         ST    @15,@TF00001                                        0504 01797000
         SRDA  @14,32                                              0504 01798000
         D     @14,@TF00001                                        0504 01799000
         LR    W,@15                                               0504 01800000
*       L=TIMELEFT//1461;           /* CALCULATE TOTAL DAYS ELAPSED     01801000
*                                      IN CURRENT LEAP YEAR GROUP  0505 01802000
*                                                              Y01980*/ 01803000
         LR    @14,@07                                             0505 01804000
         SRDA  @14,32                                              0505 01805000
         D     @14,@TF00001                                        0505 01806000
         LR    L,@14                                               0505 01807000
*       DAYREG=((L+L/731+L/1096)//366)+1;/* CALC JULIAN DAY    Y01980*/ 01808000
         LR    @15,L                                               0506 01809000
         SLR   @14,@14                                             0506 01810000
         D     @14,@CF01263                                        0506 01811000
         LR    @14,@15                                             0506 01812000
         ALR   @14,L                                               0506 01813000
         LR    @15,L                                               0506 01814000
         ST    @14,@TF00001                                        0506 01815000
         SLR   @14,@14                                             0506 01816000
         D     @14,@CF01264                                        0506 01817000
         LR    @14,@15                                             0506 01818000
         AL    @14,@TF00001                                        0506 01819000
         SRDA  @14,32                                              0506 01820000
         D     @14,@CF01265                                        0506 01821000
         AL    @14,@CF00034                                        0506 01822000
         LR    DAYREG,@14                                          0506 01823000
*       YEARREG=1904+(W*4)+(L-1)/365;/* CALCULATE CURRENT YEAR Y01980*/ 01824000
         LR    YEARREG,W                                           0507 01825000
         SLA   YEARREG,2                                           0507 01826000
         AH    YEARREG,@CH01266                                    0507 01827000
         LR    @14,L                                               0507 01828000
         BCTR  @14,0                                               0507 01829000
         SRDA  @14,32                                              0507 01830000
         D     @14,@CF01258                                        0507 01831000
         ALR   YEARREG,@15                                         0507 01832000
*     END LEAPYR;                                                  0508 01833000
*                                                                  0508 01834000
*   /*****************************************************************/ 01835000
*   /*                                                               */ 01836000
*   /* CONVERT THE DAY TO EBCDIC IN THE OUTPUT AREA                  */ 01837000
*   /*                                                               */ 01838000
*   /*****************************************************************/ 01839000
*                                                                  0509 01840000
*   PARMREG2=ADDR(TIMEAREA(5));     /* GET ADDR OF OUTPUT LOCATION IN   01841000
*                                      WHICH CONVERTED DAY IS TO BE     01842000
*                                      PLACED                  Y01980*/ 01843000
@RC00497 L     PARMREG2,OUTAREA(,PARMREG1)                         0509 01844000
         LA    PARMREG2,TIMEAREA+4(,PARMREG2)                      0509 01845000
*   GEN(CVD DAYREG,CVRTAREA);       /* CONVERT DAY TO DECIMAL  Y01980*/ 01846000
         CVD DAYREG,CVRTAREA                                            01847000
*   GEN(UNPK 0(3,PARMREG2),CVRTAREA+6(2));/* UNPACK DAY        Y01980*/ 01848000
         UNPK 0(3,PARMREG2),CVRTAREA+6(2)                               01849000
*   GEN(OI 2(PARMREG2),X'F0');      /* CHANG SIGN TO A NUMERIC ZONE     01850000
*                                                              Y01980*/ 01851000
*                                                                  0512 01852000
         OI 2(PARMREG2),X'F0'                                           01853000
*   /*****************************************************************/ 01854000
*   /*                                                               */ 01855000
*   /* CONVERT THE YEAR TO EBCDIC IN THE OUTPUT AREA                 */ 01856000
*   /*                                                               */ 01857000
*   /*****************************************************************/ 01858000
*                                                                  0513 01859000
*   PARMREG2=ADDR(TIMEAREA(1));     /* GET ADDR OF OUTPUT LOCATION IN   01860000
*                                      WHICH CONVERTED YEAR IS TO BE    01861000
*                                      PLACED                  Y01980*/ 01862000
         L     PARMREG2,OUTAREA(,PARMREG1)                         0513 01863000
*   GEN(CVD YEARREG,CVRTAREA);      /* CONVERT YEAR TO DECIMAL Y01980*/ 01864000
         CVD YEARREG,CVRTAREA                                           01865000
*   GEN(UNPK 0(4,PARMREG2),CVRTAREA+5(3));/* UNPACK YEAR       Y01980*/ 01866000
         UNPK 0(4,PARMREG2),CVRTAREA+5(3)                               01867000
*   GEN(OI 3(PARMREG2),X'F0');      /* CHANGE SIGN TO A NUMERIC ZONE */ 01868000
*                                                                  0516 01869000
         OI 3(PARMREG2),X'F0'                                           01870000
*   /*****************************************************************/ 01871000
*   /*                                                               */ 01872000
*   /* RETURN TO TODCNVRT CALLER                                     */ 01873000
*   /*                                                               */ 01874000
*   /*****************************************************************/ 01875000
*                                                                  0517 01876000
*   RETURN CODE(0);                 /* INDICATE TOD VALUE WAS CNVRTED   01877000
*                                                              Y01980*/ 01878000
         SLR   @15,@15                                             0517 01879000
         L     @14,12(,@13)                                        0517 01880000
         LM    @00,@12,20(@13)                                     0517 01881000
         BR    @14                                                 0517 01882000
*   END TODCNVRT;                                                  0518 01883000
*   END AMDPRSEG                                                   0519 01884000
*                                                                  0519 01885000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 01886000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 01887000
*/*%INCLUDE SYSLIB  (IHACDE  )                                       */ 01888000
*/*%INCLUDE SYSLIB  (IHALPDE )                                       */ 01889000
*/*%INCLUDE SYSLIB  (COMMON  )                                       */ 01890000
*                                                                  0519 01891000
*       ;                                                          0519 01892000
@DATA    DS    0H                                                       01893000
@CH00051 DC    H'4'                                                     01894000
@CH00037 DC    H'8'                                                     01895000
@CH00978 DC    H'9'                                                     01896000
@CH00100 DC    H'12'                                                    01897000
@CH00119 DC    H'60'                                                    01898000
@CH00970 DC    H'64'                                                    01899000
@CH01255 DC    H'1460'                                                  01900000
@CH01259 DC    H'1900'                                                  01901000
@CH01266 DC    H'1904'                                                  01902000
@CH01136 DC    H'30720'                                                 01903000
         DS    0F                                                       01904000
@SA00001 DS    18F                                                      01905000
@SA00003 DS    15F                                                      01906000
@SA00004 DS    14F                                                      01907000
@SA00002 DS    15F                                                      01908000
@TF00001 DS    F                                                        01909000
@ZTEMPS  DS    0F                                                       01910000
@ZT00001 DC    F'0'                                                     01911000
@ZTEMPND EQU   *                                                        01912000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         01913000
         DS    0F                                                       01914000
@CF00034 DC    F'1'                                                     01915000
@CF00123 DC    F'5'                                                     01916000
@CH00123 EQU   @CF00123+2                                               01917000
@CF01258 DC    F'365'                                                   01918000
@CF01265 DC    F'366'                                                   01919000
@CF01263 DC    F'731'                                                   01920000
@CF01264 DC    F'1096'                                                  01921000
@CF01250 DC    F'1440'                                                  01922000
@CF01160 DC    F'10240'                                                 01923000
@CF01135 DC    F'16384'                                                 01924000
@CF01133 DC    F'49152'                                                 01925000
@CF01123 DC    F'65535'                                                 01926000
@CF01137 DC    F'65536'                                                 01927000
@CF01125 DC    F'262144'                                                01928000
@CF01247 DC    F'1000000'                                               01929000
@CF01124 DC    F'-65536'                                                01930000
@CF01276 DC    F'-7'                                                    01931000
@CF01273 DC    F'-4'                                                    01932000
@CF01274 DC    F'-3'                                                    01933000
@CA00090 DC    A(AMDPRP01)                                              01934000
         DS    0D                                                       01935000
BLDLBASE DC    A(0)                                                     01936000
Q        DS    A                                                        01937000
P        DS    A                                                        01938000
SEGSAVE  DS    A                                                        01939000
SMODSIZE DC    F'0'                                                     01940000
LIMIT    DS    F                                                        01941000
EXITSIZE DC    F'0'                                                     01942000
FORMNUM2 DS    F                                                        01943000
LPDEPTR  DS    A                                                        01944000
LPAPTR   DS    A                                                        01945000
LPACT    DS    F                                                        01946000
I        DS    F                                                        01947000
SAVER1   DS    A                                                        01948000
SIXTYMIL DC    F'60000000'                                              01949000
TIMELEFT DS    F                                                        01950000
SWITCHES DC    X'00'                                                    01951000
         ORG   SWITCHES                                                 01952000
LOADSEC  DS    BL1                                                      01953000
INITSW   EQU   SWITCHES+0                                               01954000
LOADEXIT EQU   SWITCHES+0                                               01955000
ALLMODIN EQU   SWITCHES+0                                               01956000
         ORG   SWITCHES+1                                               01957000
NAMEAREA DC    CL8'AMDPR'                                               01958000
         DS    CL3                                                      01959000
PLIST    DS    CL4                                                      01960000
         ORG   PLIST                                                    01961000
LISTBASE DS    AL4                                                      01962000
         ORG   LISTBASE                                                 01963000
HIBYTE   DS    CL1                                                      01964000
         ORG   PLIST+4                                                  01965000
SEGDATA  DS    CL33                                                     01966000
         ORG   SEGDATA                                                  01967000
INBASE   DC    AL4(BLK1)                                                01968000
MODCT    DS    FL4                                                      01969000
LOADCT   DS    FL4                                                      01970000
LOADPT   DS    FL4                                                      01971000
SECLOAD  DS    FL4                                                      01972000
J        DS    FL4                                                      01973000
K        DS    FL4                                                      01974000
LISTAD   DS    FL4                                                      01975000
INQCODE  DC    AL1(0)                                                   01976000
         ORG   SEGDATA+33                                               01977000
         DS    CL3                                                      01978000
BLK1     DS    CL64                                                     01979000
         ORG   BLK1                                                     01980000
B1       DS    CL60                                                     01981000
L1       DC    A(0)                                                     01982000
         ORG   BLK1+64                                                  01983000
XITMOD   DS    CL12                                                     01984000
         ORG   XITMOD                                                   01985000
XNAME    DC    CL8' '                                                   01986000
XENTPT   DC    A(0)                                                     01987000
         ORG   XITMOD+12                                                01988000
LPATBL   DS    CL120                                                    01989000
SECMODNM DS    CL8                                                      01990000
         DS    CL4                                                      01991000
CVRTAREA DS    CL8                                                      01992000
         ORG   CVRTAREA                                                 01993000
TODWORD1 DS    FL4                                                      01994000
TODWORD2 DS    FL4                                                      01995000
         ORG   CVRTAREA+8                                               01996000
ZEROTOD  DC    X'0000000000000000'                                      01997000
ZEROTIME DC    CL12'00000.000000'                                       01998000
NULLTIME DC    CL22'000000000.00.00.000000'                             01999000
         DS    CL2                                                      02000000
PATCH    DC    50F'0'                                                   02001000
TODBRTAB DC    AL4(FULLDATE)                                            02002000
         DC    AL4(RELTVTME)                                            02003000
AMDPRSEG CSECT                                                          02004000
*                                   /*                         Y01980*/ 02005000
         ENTRY TODCNVRT                                        Y01980   02006000
AMDPRSEG CSECT                                                          02007000
*                                                                       02008000
DTAE     EQU   32                  DATA EBCDIC BIT                      02009000
DTAC     EQU   16                  DATA IN CORE BIT                     02010000
DTAP     EQU   8                   DATA PTR BIT                         02011000
DTA      EQU   4                   DATA INCLUDED BIT                    02012000
LBLP     EQU   2                   LABEL PTR BIT                        02013000
LBL      EQU   1                   LABEL INCLUDED BIT                   02014000
AMDPRSEG CSECT                                                          02015000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02016000
@01      EQU   01                                                       02017000
@02      EQU   02                                                       02018000
@03      EQU   03                                                       02019000
@04      EQU   04                                                       02020000
@05      EQU   05                                                       02021000
@06      EQU   06                                                       02022000
@07      EQU   07                                                       02023000
@08      EQU   08                                                       02024000
@09      EQU   09                                                       02025000
@10      EQU   10                                                       02026000
@11      EQU   11                                                       02027000
@12      EQU   12                                                       02028000
@13      EQU   13                                                       02029000
@14      EQU   14                                                       02030000
@15      EQU   15                                                       02031000
REG1     EQU   @01                                                      02032000
REG2     EQU   @02                                                      02033000
REG3     EQU   @03                                                      02034000
REG15    EQU   @15                                                      02035000
CDENTPTR EQU   @11                                                      02036000
NAMEPTR  EQU   @09                                                      02037000
NAMEREG0 EQU   @00                                                      02038000
NAMEREG1 EQU   @01                                                      02039000
CDEQUEUE EQU   @08                                                      02040000
COMBASE  EQU   @12                                                      02041000
BASE1    EQU   @11                                                      02042000
PARMREG1 EQU   @01                                                      02043000
PARMREG2 EQU   @02                                                      02044000
L        EQU   @04                                                      02045000
W        EQU   @05                                                      02046000
DAYREG   EQU   @03                                                      02047000
YEARREG  EQU   @06                                                      02048000
BASE2    EQU   @10                                                      02049000
BASE3    EQU   @09                                                      02050000
BUFREG   EQU   @06                                                      02051000
CNTREG   EQU   @03                                                      02052000
LINEREG  EQU   @08                                                      02053000
PREG     EQU   @01                                                      02054000
R0       EQU   @00                                                      02055000
R1       EQU   @01                                                      02056000
R10      EQU   @10                                                      02057000
R11      EQU   @11                                                      02058000
R12      EQU   @12                                                      02059000
R13      EQU   @13                                                      02060000
R14      EQU   @14                                                      02061000
R15      EQU   @15                                                      02062000
R2       EQU   @02                                                      02063000
R3       EQU   @03                                                      02064000
R4       EQU   @04                                                      02065000
R5       EQU   @05                                                      02066000
R6       EQU   @06                                                      02067000
R7       EQU   @07                                                      02068000
R8       EQU   @08                                                      02069000
R9       EQU   @09                                                      02070000
STOPBASE EQU   @05                                                      02071000
         EXTRN AMDPRP01                                                 02072000
CVTPTR   EQU   16                                                       02073000
REQLIST  EQU   0                                                        02074000
REQFLGS  EQU   REQLIST                                                  02075000
REQNAME  EQU   REQLIST+1                                                02076000
BLDLLIST EQU   0                                                        02077000
BLDLCT   EQU   BLDLLIST                                                 02078000
BENTRLN  EQU   BLDLLIST+2                                               02079000
BLDLENTR EQU   0                                                        02080000
MODNAME  EQU   BLDLENTR                                                 02081000
R        EQU   BLDLENTR+10                                              02082000
MODLEN   EQU   BLDLENTR+24                                              02083000
REQMODNM EQU   0                                                        02084000
AMDPRP02 EQU   0                                                        02085000
AMDPRP03 EQU   0                                                        02086000
AMDPRP04 EQU   0                                                        02087000
TEXT     EQU   0                                                        02088000
INOP     EQU   0                                                        02089000
DELFLMSG EQU   0                                                        02090000
DELNAME  EQU   0                                                        02091000
LISTBLK  EQU   0                                                        02092000
LINK     EQU   LISTBLK+60                                               02093000
LISTITEM EQU   0                                                        02094000
LOADNAME EQU   LISTITEM                                                 02095000
LOADEP   EQU   LISTITEM+8                                               02096000
CVTMAP   EQU   0                                                        02097000
CVTDAR   EQU   CVTMAP+72                                                02098000
CVTFLGS1 EQU   CVTDAR                                                   02099000
CVTDCB   EQU   CVTMAP+116                                               02100000
CVTIERLC EQU   CVTMAP+144                                               02101000
CVTOPTA  EQU   CVTMAP+182                                               02102000
CVTOPTB  EQU   CVTMAP+183                                               02103000
CVTQCDSR EQU   CVTMAP+184                                               02104000
CVTQLPAQ EQU   CVTMAP+188                                               02105000
CVTGTF   EQU   CVTMAP+236                                               02106000
CVTGTFST EQU   CVTGTF                                                   02107000
CVTGTFS  EQU   CVTGTFST                                                 02108000
CVTSTATE EQU   CVTGTFST                                                 02109000
CVTTMODE EQU   CVTGTFST                                                 02110000
CVTFORM  EQU   CVTGTFST                                                 02111000
CVTAQAVT EQU   CVTMAP+240                                               02112000
CVTTCMFG EQU   CVTAQAVT                                                 02113000
CVTVOLM2 EQU   CVTMAP+244                                               02114000
CVTTATA  EQU   CVTVOLM2                                                 02115000
CVTTSKS  EQU   CVTTATA                                                  02116000
CVTVOLF2 EQU   CVTTSKS                                                  02117000
CVTTAT   EQU   CVTTATA+1                                                02118000
CVTATER  EQU   CVTMAP+248                                               02119000
CVTEXT1  EQU   CVTMAP+252                                               02120000
CVTPURG  EQU   CVTMAP+260                                               02121000
CVTQMSG  EQU   CVTMAP+268                                               02122000
CVTDMSR  EQU   CVTMAP+272                                               02123000
CVTERPV  EQU   CVTMAP+316                                               02124000
CVTINTLA EQU   CVTMAP+320                                               02125000
CVTAPF   EQU   CVTMAP+324                                               02126000
CVTEXT2  EQU   CVTMAP+328                                               02127000
CVTHJES  EQU   CVTMAP+332                                               02128000
CVTPGSIA EQU   CVTMAP+348                                               02129000
CVTA1F1  EQU   CVTMAP+356                                               02130000
CVTSYSK  EQU   CVTMAP+357                                               02131000
CVTVOLM1 EQU   CVTMAP+380                                               02132000
CVTVOLF1 EQU   CVTVOLM1                                                 02133000
CVTATMCT EQU   CVTMAP+388                                               02134000
CVTXTNT1 EQU   0                                                        02135000
CVTXTNT2 EQU   0                                                        02136000
CVTDSSV  EQU   CVTXTNT2                                                 02137000
CVTFLGBT EQU   CVTXTNT2+5                                               02138000
CVTQID   EQU   CVTXTNT2+24                                              02139000
CVTRV400 EQU   CVTXTNT2+52                                              02140000
CVTRV409 EQU   CVTXTNT2+53                                              02141000
CVTATCVT EQU   CVTXTNT2+64                                              02142000
CVTRV429 EQU   CVTXTNT2+84                                              02143000
CVTRV438 EQU   CVTXTNT2+85                                              02144000
CVTRV457 EQU   CVTXTNT2+112                                             02145000
CVTRV466 EQU   CVTXTNT2+113                                             02146000
CVTFIX   EQU   0                                                        02147000
CVTRELNO EQU   CVTFIX+252                                               02148000
CDENTRY  EQU   0                                                        02149000
CDENTPT  EQU   CDENTRY+16                                               02150000
CDATTR   EQU   CDENTRY+28                                               02151000
CDATTR2  EQU   CDENTRY+29                                               02152000
LPDE     EQU   0                                                        02153000
LPDENTP  EQU   LPDE+16                                                  02154000
LPDEATTR EQU   LPDE+28                                                  02155000
LPDEATT2 EQU   LPDE+29                                                  02156000
LPDEMJNM EQU   LPDE+32                                                  02157000
LPAMOD   EQU   0                                                        02158000
LPAMODNM EQU   LPAMOD                                                   02159000
LPAEP    EQU   LPAMOD+8                                                 02160000
IEAVVMSR EQU   0                                                        02161000
IEAQCDSR EQU   0                                                        02162000
COMMON   EQU   0                                                        02163000
ERRADDR  EQU   COMMON                                                   02164000
STORSIZE EQU   COMMON+64                                                02165000
SWA      EQU   COMMON+122                                               02166000
SWB      EQU   COMMON+123                                               02167000
SWC      EQU   COMMON+124                                               02168000
EDITSW   EQU   SWC                                                      02169000
SEGRD    EQU   SWC                                                      02170000
SWD      EQU   COMMON+125                                               02171000
NOSTDMG  EQU   SWD                                                      02172000
SWE      EQU   COMMON+126                                               02173000
SWF      EQU   COMMON+127                                               02174000
QSADMP   EQU   SWF                                                      02175000
BUFSW    EQU   COMMON+128                                               02176000
PRSW     EQU   COMMON+129                                               02177000
TABLE    EQU   COMMON+659                                               02178000
HEXTABL  EQU   TABLE+63                                                 02179000
ASYNTAX  EQU   COMMON+1508                                              02180000
SYNMSGA  EQU   COMMON+1532                                              02181000
AEREXIT  EQU   COMMON+1536                                              02182000
DCBADDRS EQU   COMMON+1608                                              02183000
@NM00054 EQU   DCBADDRS+16                                              02184000
@NM00055 EQU   @NM00054                                                 02185000
BRRDINIT EQU   COMMON+1988                                              02186000
INPUTLST EQU   0                                                        02187000
CVTTZPTR EQU   INPUTLST                                                 02188000
TODPTR   EQU   INPUTLST+4                                               02189000
OUTAREA  EQU   INPUTLST+8                                               02190000
CVTTZVAL EQU   0                                                        02191000
TODVALUE EQU   0                                                        02192000
TIMEAREA EQU   0                                                        02193000
TIMEERIA EQU   0                                                        02194000
SECONDS  EQU   0                                                        02195000
AMDPRXIT EQU   0                                                        02196000
INCQUANT EQU   0                                                        02197000
LISTPTR  EQU   LISTBASE                                                 02198000
CVTS01   EQU   CVTPGSIA                                                 02199000
CVTLPDSR EQU   CVTS01+4                                                 02200000
CVTLPDIA EQU   CVTS01+12                                                02201000
CVTDIRST EQU   CVTLPDIA                                                 02202000
CVTSLIDA EQU   CVTS01+24                                                02203000
CVTCTLFG EQU   CVTS01+50                                                02204000
CVTRV210 EQU   CVTS01+424                                               02205000
CVTRV219 EQU   CVTS01+425                                               02206000
CVTRV228 EQU   CVTS01+426                                               02207000
CVTRV237 EQU   CVTS01+427                                               02208000
CVTMFRTR EQU   CVTS01+452                                               02209000
CVTRV262 EQU   CVTS01+468                                               02210000
CVTRV271 EQU   CVTS01+469                                               02211000
CVTRV280 EQU   CVTS01+470                                               02212000
CVTRV289 EQU   CVTS01+471                                               02213000
CVTGSDA  EQU   CVTS01+600                                               02214000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02215000
CVTRV628 EQU   CVTS01+728                                               02216000
CVTRV627 EQU   CVTS01+724                                               02217000
CVTRV626 EQU   CVTS01+720                                               02218000
CVTRV625 EQU   CVTS01+716                                               02219000
CVTRV624 EQU   CVTS01+712                                               02220000
CVTRV623 EQU   CVTS01+708                                               02221000
CVTRV622 EQU   CVTS01+704                                               02222000
CVTRV621 EQU   CVTS01+700                                               02223000
CVTRV620 EQU   CVTS01+696                                               02224000
CVTRV619 EQU   CVTS01+692                                               02225000
CVTRV618 EQU   CVTS01+688                                               02226000
CVTRV617 EQU   CVTS01+684                                               02227000
CVTRV616 EQU   CVTS01+680                                               02228000
CVTRV615 EQU   CVTS01+676                                               02229000
CVTRV614 EQU   CVTS01+672                                               02230000
CVTRV613 EQU   CVTS01+668                                               02231000
CVTRV612 EQU   CVTS01+664                                               02232000
CVTRV611 EQU   CVTS01+660                                               02233000
CVTRV610 EQU   CVTS01+656                                               02234000
CVTRV609 EQU   CVTS01+652                                               02235000
CVTRV608 EQU   CVTS01+648                                               02236000
CVTRV607 EQU   CVTS01+644                                               02237000
CVTRV606 EQU   CVTS01+640                                               02238000
CVTRV605 EQU   CVTS01+636                                               02239000
CVTRV604 EQU   CVTS01+632                                               02240000
CVTEFF02 EQU   CVTS01+628                                               02241000
CVTCBBR  EQU   CVTS01+624                                               02242000
CVTSSCR  EQU   CVTS01+620                                               02243000
CVTEVENT EQU   CVTS01+616                                               02244000
CVTCRCA  EQU   CVTS01+612                                               02245000
CVTTPIO  EQU   CVTS01+608                                               02246000
CVTADV   EQU   CVTS01+604                                               02247000
CVTGSDAB EQU   CVTGSDA                                                  02248000
CVTQV3   EQU   CVTS01+596                                               02249000
CVTQV2   EQU   CVTS01+592                                               02250000
CVTQV1   EQU   CVTS01+588                                               02251000
CVTRPT   EQU   CVTS01+584                                               02252000
CVTSSRB  EQU   CVTS01+580                                               02253000
CVTCSDRL EQU   CVTS01+576                                               02254000
CVTEXP1  EQU   CVTS01+572                                               02255000
CVTRMPMT EQU   CVTS01+568                                               02256000
CVTRMPTT EQU   CVTS01+564                                               02257000
CVTVPSA  EQU   CVTS01+560                                               02258000
CVTVSTOP EQU   CVTS01+556                                               02259000
CVTGTFR8 EQU   CVTS01+552                                               02260000
CVTQUIT  EQU   CVTS01+548                                               02261000
CVTVACR  EQU   CVTS01+544                                               02262000
CVTWTCB  EQU   CVTS01+540                                               02263000
CVTSTPRS EQU   CVTS01+536                                               02264000
CVT0PT02 EQU   CVTS01+532                                               02265000
CVTDARCM EQU   CVTS01+528                                               02266000
CVTIRECM EQU   CVTS01+524                                               02267000
CVTJRECM EQU   CVTS01+520                                               02268000
CVTVEMS0 EQU   CVTS01+516                                               02269000
CVTSPFRR EQU   CVTS01+512                                               02270000
CVTRLSTG EQU   CVTS01+508                                               02271000
CVT0TC0A EQU   CVTS01+504                                               02272000
CVTGMBR  EQU   CVTS01+500                                               02273000
CVTLFRM  EQU   CVTS01+496                                               02274000
CVTRMBR  EQU   CVTS01+492                                               02275000
CVTVIOP  EQU   CVTS01+488                                               02276000
CVTRV307 EQU   CVTS01+486                                               02277000
CVTRV306 EQU   CVTS01+484                                               02278000
CVTRV305 EQU   CVTS01+482                                               02279000
CVTRV304 EQU   CVTS01+480                                               02280000
CVTRV303 EQU   CVTS01+478                                               02281000
CVTRV302 EQU   CVTS01+476                                               02282000
CVTTRCA  EQU   CVTS01+472                                               02283000
CVTRV297 EQU   CVTRV289                                                 02284000
CVTRV296 EQU   CVTRV289                                                 02285000
CVTRV295 EQU   CVTRV289                                                 02286000
CVTRV294 EQU   CVTRV289                                                 02287000
CVTRV293 EQU   CVTRV289                                                 02288000
CVTRV292 EQU   CVTRV289                                                 02289000
CVTRV291 EQU   CVTRV289                                                 02290000
CVTRV290 EQU   CVTRV289                                                 02291000
CVTRV288 EQU   CVTRV280                                                 02292000
CVTRV287 EQU   CVTRV280                                                 02293000
CVTRV286 EQU   CVTRV280                                                 02294000
CVTRV285 EQU   CVTRV280                                                 02295000
CVTRV284 EQU   CVTRV280                                                 02296000
CVTRV283 EQU   CVTRV280                                                 02297000
CVTRV282 EQU   CVTRV280                                                 02298000
CVTRV281 EQU   CVTRV280                                                 02299000
CVTRV279 EQU   CVTRV271                                                 02300000
CVTRV278 EQU   CVTRV271                                                 02301000
CVTRV277 EQU   CVTRV271                                                 02302000
CVTRV276 EQU   CVTRV271                                                 02303000
CVTRV275 EQU   CVTRV271                                                 02304000
CVTRV274 EQU   CVTRV271                                                 02305000
CVTRV273 EQU   CVTRV271                                                 02306000
CVTRV272 EQU   CVTRV271                                                 02307000
CVTRV270 EQU   CVTRV262                                                 02308000
CVTRV269 EQU   CVTRV262                                                 02309000
CVTRV268 EQU   CVTRV262                                                 02310000
CVTRV267 EQU   CVTRV262                                                 02311000
CVTRV266 EQU   CVTRV262                                                 02312000
CVTRV265 EQU   CVTRV262                                                 02313000
CVTRV264 EQU   CVTRV262                                                 02314000
CVTRV263 EQU   CVTRV262                                                 02315000
CVTVFP   EQU   CVTS01+464                                               02316000
CVTVSI   EQU   CVTS01+460                                               02317000
CVTVPSIB EQU   CVTS01+456                                               02318000
CVTMFACT EQU   CVTMFRTR                                                 02319000
CVTMFCTL EQU   CVTS01+448                                               02320000
CVTPVBP  EQU   CVTS01+444                                               02321000
CVTPWI   EQU   CVTS01+440                                               02322000
CVTRV254 EQU   CVTS01+438                                               02323000
CVTRV253 EQU   CVTS01+436                                               02324000
CVTRV252 EQU   CVTS01+434                                               02325000
CVTRV251 EQU   CVTS01+433                                               02326000
CVTRV250 EQU   CVTS01+432                                               02327000
CVTRV249 EQU   CVTS01+431                                               02328000
CVTRV248 EQU   CVTS01+430                                               02329000
CVTRV247 EQU   CVTS01+429                                               02330000
CVTRV246 EQU   CVTS01+428                                               02331000
CVTRV245 EQU   CVTRV237                                                 02332000
CVTRV244 EQU   CVTRV237                                                 02333000
CVTRV243 EQU   CVTRV237                                                 02334000
CVTRV242 EQU   CVTRV237                                                 02335000
CVTRV241 EQU   CVTRV237                                                 02336000
CVTRV240 EQU   CVTRV237                                                 02337000
CVTRV239 EQU   CVTRV237                                                 02338000
CVTRV238 EQU   CVTRV237                                                 02339000
CVTRV236 EQU   CVTRV228                                                 02340000
CVTRV235 EQU   CVTRV228                                                 02341000
CVTRV234 EQU   CVTRV228                                                 02342000
CVTRV233 EQU   CVTRV228                                                 02343000
CVTRV232 EQU   CVTRV228                                                 02344000
CVTRV231 EQU   CVTRV228                                                 02345000
CVTRV230 EQU   CVTRV228                                                 02346000
CVTRV229 EQU   CVTRV228                                                 02347000
CVTRV227 EQU   CVTRV219                                                 02348000
CVTRV226 EQU   CVTRV219                                                 02349000
CVTRV225 EQU   CVTRV219                                                 02350000
CVTRV224 EQU   CVTRV219                                                 02351000
CVTRV223 EQU   CVTRV219                                                 02352000
CVTRV222 EQU   CVTRV219                                                 02353000
CVTRV221 EQU   CVTRV219                                                 02354000
CVTRV220 EQU   CVTRV219                                                 02355000
CVTRV218 EQU   CVTRV210                                                 02356000
CVTRV217 EQU   CVTRV210                                                 02357000
CVTRV216 EQU   CVTRV210                                                 02358000
CVTRV215 EQU   CVTRV210                                                 02359000
CVTRV214 EQU   CVTRV210                                                 02360000
CVTRV213 EQU   CVTRV210                                                 02361000
CVTRV212 EQU   CVTRV210                                                 02362000
CVTRV211 EQU   CVTRV210                                                 02363000
CVTLCCAT EQU   CVTS01+420                                               02364000
CVTPCCAT EQU   CVTS01+416                                               02365000
CVTIPCRP EQU   CVTS01+412                                               02366000
CVTIPCRI EQU   CVTS01+408                                               02367000
CVTIPCDS EQU   CVTS01+404                                               02368000
CVTAIDVT EQU   CVTS01+400                                               02369000
CVTSSAP  EQU   CVTS01+396                                               02370000
CVTEHCIR EQU   CVTS01+392                                               02371000
CVTEHDEF EQU   CVTS01+388                                               02372000
CVTDAIR  EQU   CVTS01+384                                               02373000
CVTPERFM EQU   CVTS01+380                                               02374000
CVT044R2 EQU   CVTS01+376                                               02375000
CVTFETCH EQU   CVTS01+372                                               02376000
CVTRSTWD EQU   CVTS01+368                                               02377000
CVTSPOST EQU   CVTS01+364                                               02378000
CVTIOBP  EQU   CVTS01+360                                               02379000
CVTASMVT EQU   CVTS01+356                                               02380000
CVTRECRQ EQU   CVTS01+352                                               02381000
CVTWSAC  EQU   CVTS01+348                                               02382000
CVTRV149 EQU   CVTS01+344                                               02383000
CVTWSAL  EQU   CVTS01+340                                               02384000
CVTSPSA  EQU   CVTS01+336                                               02385000
CVTGLMN  EQU   CVTS01+332                                               02386000
CVTVEAC0 EQU   CVTS01+328                                               02387000
CVT062R1 EQU   CVTS01+324                                               02388000
CVTRPOST EQU   CVTS01+320                                               02389000
CVTDQIQE EQU   CVTS01+316                                               02390000
CVTCSD   EQU   CVTS01+312                                               02391000
CVTLKRMA EQU   CVTS01+308                                               02392000
CVTRSPIE EQU   CVTS01+304                                               02393000
CVTRENQ  EQU   CVTS01+300                                               02394000
CVTLQCB  EQU   CVTS01+296                                               02395000
CVTFQCB  EQU   CVTS01+292                                               02396000
CVTQCS01 EQU   CVTS01+288                                               02397000
CVTAPFT  EQU   CVTS01+284                                               02398000
CVTPARRL EQU   CVTS01+280                                               02399000
CVTVWAIT EQU   CVTS01+276                                               02400000
CVTGSPL  EQU   CVTS01+272                                               02401000
CVTLSMQ  EQU   CVTS01+268                                               02402000
CVTGSMQ  EQU   CVTS01+264                                               02403000
CVTEXPRO EQU   CVTS01+260                                               02404000
CVTOPCTP EQU   CVTS01+256                                               02405000
CVTSIC   EQU   CVTS01+252                                               02406000
CVTTPIOS EQU   CVTS01+248                                               02407000
CVTRTMS  EQU   CVTS01+244                                               02408000
CVTSDBF  EQU   CVTS01+240                                               02409000
CVTSCBP  EQU   CVTS01+236                                               02410000
CVTSDMP  EQU   CVTS01+232                                               02411000
CVTSV60  EQU   CVTS01+228                                               02412000
CVTRTMCT EQU   CVTS01+224                                               02413000
CVTASCBL EQU   CVTS01+220                                               02414000
CVTASCBH EQU   CVTS01+216                                               02415000
CVTGDA   EQU   CVTS01+212                                               02416000
CVTASVT  EQU   CVTS01+208                                               02417000
CVTVVMDI EQU   CVTS01+204                                               02418000
CVTAQTOP EQU   CVTS01+200                                               02419000
CVTIOSCS EQU   CVTS01+196                                               02420000
CVTSDRM  EQU   CVTS01+192                                               02421000
CVTOPTE  EQU   CVTS01+188                                               02422000
CVTSTXU  EQU   CVTS01+184                                               02423000
CVTQUIS  EQU   CVTS01+180                                               02424000
CVTPARS  EQU   CVTS01+176                                               02425000
CVTS1EE  EQU   CVTS01+172                                               02426000
CVTFRAS  EQU   CVTS01+168                                               02427000
CVTQSAS  EQU   CVTS01+164                                               02428000
CVTCRAS  EQU   CVTS01+160                                               02429000
CVTCRMN  EQU   CVTS01+156                                               02430000
CVTDELCP EQU   CVTS01+152                                               02431000
CVTFRECL EQU   CVTS01+148                                               02432000
CVTGETCL EQU   CVTS01+144                                               02433000
CVTBLDCP EQU   CVTS01+140                                               02434000
CVTAUTHL EQU   CVTS01+136                                               02435000
CVTSCAN  EQU   CVTS01+132                                               02436000
CVTRV144 EQU   CVTS01+130                                               02437000
CVTMAXMP EQU   CVTS01+128                                               02438000
CVTSTCK  EQU   CVTS01+124                                               02439000
CVTRV139 EQU   CVTS01+123                                               02440000
CVTDSSAC EQU   CVTS01+122                                               02441000
CVTRV513 EQU   CVTS01+121                                               02442000
CVTIOSPL EQU   CVTS01+120                                               02443000
CVTPTGT  EQU   CVTS01+116                                               02444000
CVTCSPIE EQU   CVTS01+112                                               02445000
CVTSMFEX EQU   CVTS01+108                                               02446000
CVTOLT0A EQU   CVTS01+104                                               02447000
CVTSRBRT EQU   CVTS01+100                                               02448000
CVTPUTL  EQU   CVTS01+96                                                02449000
CVTRV519 EQU   CVTS01+92                                                02450000
CVTRV327 EQU   CVTS01+88                                                02451000
CVTRV326 EQU   CVTS01+84                                                02452000
CVTRV325 EQU   CVTS01+80                                                02453000
CVTRV324 EQU   CVTS01+76                                                02454000
CVT0VL01 EQU   CVTS01+72                                                02455000
CVTSHRVM EQU   CVTS01+68                                                02456000
CVTRV332 EQU   CVTS01+64                                                02457000
CVTTAS   EQU   CVTS01+60                                                02458000
CVTRSCN  EQU   CVTS01+56                                                02459000
CVTTRAC2 EQU   CVTS01+54                                                02460000
CVTTRACE EQU   CVTS01+52                                                02461000
CVTAPG   EQU   CVTS01+51                                                02462000
CVTSDTRC EQU   CVTCTLFG                                                 02463000
CVTGTRCE EQU   CVTCTLFG                                                 02464000
CVTNOMP  EQU   CVTCTLFG                                                 02465000
CVTRSV79 EQU   CVTCTLFG                                                 02466000
CVTDSTAT EQU   CVTCTLFG                                                 02467000
CVTRSV78 EQU   CVTCTLFG                                                 02468000
CVTRV333 EQU   CVTCTLFG                                                 02469000
CVTRV323 EQU   CVTCTLFG                                                 02470000
CVTSPVLK EQU   CVTS01+49                                                02471000
CVTRSV77 EQU   CVTS01+48                                                02472000
CVTRV331 EQU   CVTS01+44                                                02473000
CVTRV330 EQU   CVTS01+40                                                02474000
CVTRV329 EQU   CVTS01+36                                                02475000
CVTRV328 EQU   CVTS01+32                                                02476000
CVTRV322 EQU   CVTS01+28                                                02477000
CVTSLID  EQU   CVTSLIDA+1                                               02478000
CVTSYLK  EQU   CVTSLIDA                                                 02479000
CVTRV321 EQU   CVTS01+20                                                02480000
CVTRV320 EQU   CVTS01+16                                                02481000
CVTLPDIR EQU   CVTLPDIA+1                                               02482000
CVTRSV69 EQU   CVTDIRST                                                 02483000
CVTRSV68 EQU   CVTDIRST                                                 02484000
CVTRSV67 EQU   CVTDIRST                                                 02485000
CVTRSV66 EQU   CVTDIRST                                                 02486000
CVTRSV65 EQU   CVTDIRST                                                 02487000
CVTRSV64 EQU   CVTDIRST                                                 02488000
CVTRSV63 EQU   CVTDIRST                                                 02489000
CVTDICOM EQU   CVTDIRST                                                 02490000
CVTPVTP  EQU   CVTS01+8                                                 02491000
CVTGETL  EQU   CVTS01                                                   02492000
CSADDR   EQU   COMMON+2072                                              02493000
@NM00060 EQU   COMMON+2070                                              02494000
TOPICHDR EQU   COMMON+2060                                              02495000
DFLTCSA  EQU   COMMON+2056                                              02496000
LPAMAX   EQU   COMMON+2052                                              02497000
DNUCTOP  EQU   COMMON+2048                                              02498000
XLMAX    EQU   COMMON+2044                                              02499000
DQEMAX   EQU   COMMON+2042                                              02500000
ASCBMAX  EQU   COMMON+2040                                              02501000
TCBMAX   EQU   COMMON+2038                                              02502000
SRBMAX   EQU   COMMON+2036                                              02503000
DDMAX    EQU   COMMON+2034                                              02504000
DEBMAX   EQU   COMMON+2032                                              02505000
JPQMAX   EQU   COMMON+2030                                              02506000
LLEMAX   EQU   COMMON+2028                                              02507000
PQEMAX   EQU   COMMON+2026                                              02508000
RBMAX    EQU   COMMON+2024                                              02509000
@NM00059 EQU   COMMON+2023                                              02510000
EXITFLAG EQU   COMMON+2022                                              02511000
AUSRASID EQU   COMMON+2020                                              02512000
AUSRTCBA EQU   COMMON+2016                                              02513000
AUSRDEL  EQU   COMMON+2012                                              02514000
AUSREXIT EQU   COMMON+2008                                              02515000
AUSRINIT EQU   COMMON+2004                                              02516000
ASRBFMT  EQU   COMMON+2000                                              02517000
AASCBFMT EQU   COMMON+1996                                              02518000
BRRDADJ  EQU   COMMON+1992                                              02519000
BRRDDATA EQU   COMMON+1984                                              02520000
BUFERMAP EQU   COMMON+1980                                              02521000
ASCBMAP  EQU   COMMON+1976                                              02522000
CPUMAP   EQU   COMMON+1972                                              02523000
ASIDNDX  EQU   COMMON+1968                                              02524000
@NM00058 EQU   COMMON+1964                                              02525000
HDRTITLE EQU   COMMON+1864                                              02526000
HDRREGS  EQU   COMMON+1696                                              02527000
SACSWCAW EQU   COMMON+1684                                              02528000
ASVTADDR EQU   COMMON+1680                                              02529000
PREFXRGV EQU   COMMON+1676                                              02530000
PREFXRGR EQU   COMMON+1672                                              02531000
CURASCB  EQU   COMMON+1668                                              02532000
IPLCPU   EQU   COMMON+1666                                              02533000
QASID    EQU   COMMON+1664                                              02534000
QAPFT    EQU   COMMON+1660                                              02535000
@NM00057 EQU   COMMON+1656                                              02536000
REALMAX  EQU   COMMON+1652                                              02537000
SEGTABOR EQU   COMMON+1648                                              02538000
REALMAP  EQU   COMMON+1644                                              02539000
@NM00056 EQU   COMMON+1641                                              02540000
EDITER   EQU   COMMON+1640                                              02541000
AROOT    EQU   COMMON+1636                                              02542000
AEDITCB  EQU   COMMON+1632                                              02543000
TRCCOUNT EQU   COMMON+1628                                              02544000
ASYSUDCB EQU   @NM00054+1                                               02545000
ENDLIST  EQU   @NM00055                                                 02546000
AINDCB   EQU   DCBADDRS+12                                              02547000
ARDRDCB  EQU   DCBADDRS+8                                               02548000
APTRDCB  EQU   DCBADDRS+4                                               02549000
AOUTDCB  EQU   DCBADDRS                                                 02550000
ATCBSMRY EQU   COMMON+1604                                              02551000
ATCBSMFR EQU   COMMON+1600                                              02552000
ONGOPTR  EQU   COMMON+1596                                              02553000
AEND     EQU   COMMON+1592                                              02554000
AERRMSGA EQU   COMMON+1584                                              02555000
BUFREINT EQU   COMMON+1580                                              02556000
BUFSUM   EQU   COMMON+1576                                              02557000
APRTSTG  EQU   COMMON+1572                                              02558000
AFORMAT  EQU   COMMON+1568                                              02559000
ASTPROUT EQU   COMMON+1564                                              02560000
APCBENQ  EQU   COMMON+1560                                              02561000
ATCBRTRV EQU   COMMON+1556                                              02562000
ATCBREMV EQU   COMMON+1552                                              02563000
ATCBSAVE EQU   COMMON+1548                                              02564000
QATMERTN EQU   COMMON+1544                                              02565000
ALOADER  EQU   COMMON+1540                                              02566000
STOPEXIT EQU   COMMON+1528                                              02567000
ARGNBND  EQU   COMMON+1524                                              02568000
AWRDCNVT EQU   COMMON+1520                                              02569000
AADRCNVT EQU   COMMON+1516                                              02570000
AFMTLINE EQU   COMMON+1512                                              02571000
APRTMSG  EQU   COMMON+1504                                              02572000
AWRITE   EQU   COMMON+1500                                              02573000
NONBLNK  EQU   COMMON+1244                                              02574000
BLNK     EQU   COMMON+988                                               02575000
@NM00053 EQU   COMMON+972                                               02576000
@NM00052 EQU   COMMON+915                                               02577000
EBCTABL  EQU   HEXTABL+10                                               02578000
@NM00051 EQU   HEXTABL                                                  02579000
@NM00050 EQU   TABLE                                                    02580000
CAPTABL  EQU   COMMON+403                                               02581000
TITLEPGE EQU   COMMON+394                                               02582000
@NM00049 EQU   COMMON+392                                               02583000
TITLETME EQU   COMMON+379                                               02584000
@NM00048 EQU   COMMON+377                                               02585000
TITLEDTE EQU   COMMON+364                                               02586000
@NM00047 EQU   COMMON+362                                               02587000
TITLEMOD EQU   COMMON+347                                               02588000
TITLEMSG EQU   COMMON+283                                               02589000
MSG2     EQU   COMMON+257                                               02590000
MSG1     EQU   COMMON+231                                               02591000
STOP     EQU   COMMON+227                                               02592000
TITLE    EQU   COMMON+222                                               02593000
BLANKS   EQU   COMMON+214                                               02594000
WTORMSG  EQU   COMMON+133                                               02595000
@NM00046 EQU   COMMON+130                                               02596000
@NM00045 EQU   PRSW                                                     02597000
@NM00044 EQU   PRSW                                                     02598000
PRNTREAL EQU   PRSW                                                     02599000
PRNTRL   EQU   PRSW                                                     02600000
TTLSW    EQU   PRSW                                                     02601000
@NM00043 EQU   PRSW                                                     02602000
QSEGTBSW EQU   PRSW                                                     02603000
@NM00042 EQU   PRSW                                                     02604000
@NM00041 EQU   BUFSW                                                    02605000
PREFM    EQU   BUFSW                                                    02606000
@NM00040 EQU   BUFSW                                                    02607000
@NM00039 EQU   BUFSW                                                    02608000
@NM00038 EQU   BUFSW                                                    02609000
@NM00037 EQU   BUFSW                                                    02610000
@NM00036 EQU   BUFSW                                                    02611000
@NM00035 EQU   BUFSW                                                    02612000
@NM00034 EQU   SWF                                                      02613000
QUT1LOD  EQU   SWF                                                      02614000
@NM00033 EQU   SWF                                                      02615000
PAGEOK   EQU   SWF                                                      02616000
DMPIC    EQU   SWF                                                      02617000
NUCTFRMC EQU   SWF                                                      02618000
QPRDINIT EQU   SWF                                                      02619000
@NM00032 EQU   SWE                                                      02620000
@NM00031 EQU   SWE                                                      02621000
@NM00030 EQU   SWE                                                      02622000
BUILDMAP EQU   SWE                                                      02623000
TITLESW  EQU   SWE                                                      02624000
RESPC    EQU   SWE                                                      02625000
@NM00029 EQU   SWE                                                      02626000
STOPSW   EQU   SWE                                                      02627000
@NM00028 EQU   SWD                                                      02628000
GPRSFND  EQU   SWD                                                      02629000
CONTSW   EQU   SWD                                                      02630000
NOLOADSW EQU   SWD                                                      02631000
@NM00027 EQU   SWD                                                      02632000
@NM00026 EQU   SWD                                                      02633000
FLSHMODE EQU   SWD                                                      02634000
@NM00025 EQU   SWC                                                      02635000
@NM00024 EQU   SWC                                                      02636000
TREADIN  EQU   SWC                                                      02637000
POSITSW  EQU   SWC                                                      02638000
SETFLSH  EQU   SWC                                                      02639000
MSTRSW   EQU   SWC                                                      02640000
@NM00023 EQU   SWB                                                      02641000
@NM00022 EQU   SWB                                                      02642000
QSYSUT2  EQU   SWB                                                      02643000
ENDSW    EQU   SWB                                                      02644000
@NM00021 EQU   SWB                                                      02645000
@NM00020 EQU   SWB                                                      02646000
FMTERR   EQU   SWB                                                      02647000
IOERR    EQU   SWB                                                      02648000
RDRSW    EQU   SWA                                                      02649000
SETCVTSW EQU   SWA                                                      02650000
@NM00019 EQU   SWA                                                      02651000
GOSW     EQU   SWA                                                      02652000
@NM00018 EQU   SWA                                                      02653000
@NM00017 EQU   SWA                                                      02654000
@NM00016 EQU   SWA                                                      02655000
@NM00015 EQU   SWA                                                      02656000
LINENUM  EQU   COMMON+120                                               02657000
LINENUMB EQU   COMMON+118                                               02658000
SIXTEEN  EQU   COMMON+116                                               02659000
TWELVE   EQU   COMMON+114                                               02660000
ELEVEN   EQU   COMMON+112                                               02661000
HTEN     EQU   COMMON+110                                               02662000
EIGHT    EQU   COMMON+108                                               02663000
SEVEN    EQU   COMMON+106                                               02664000
FIVE     EQU   COMMON+104                                               02665000
FOUR     EQU   COMMON+102                                               02666000
THREE    EQU   COMMON+100                                               02667000
TWO      EQU   COMMON+98                                                02668000
ONEA     EQU   COMMON+96                                                02669000
READTM   EQU   COMMON+92                                                02670000
RDERCNT  EQU   COMMON+88                                                02671000
READNO   EQU   COMMON+84                                                02672000
RDENTRY  EQU   COMMON+80                                                02673000
@NM00014 EQU   COMMON+79                                                02674000
RETCODE  EQU   COMMON+78                                                02675000
FILESEQ  EQU   COMMON+76                                                02676000
INDD     EQU   COMMON+68                                                02677000
PCBPTR   EQU   COMMON+60                                                02678000
CVTADDR  EQU   COMMON+56                                                02679000
TCBLIST  EQU   COMMON+52                                                02680000
CURBUF   EQU   COMMON+48                                                02681000
PAGENUMB EQU   COMMON+44                                                02682000
LINECNT  EQU   COMMON+40                                                02683000
SIX      EQU   COMMON+36                                                02684000
NUCTOP   EQU   COMMON+32                                                02685000
WORK1    EQU   COMMON+24                                                02686000
DELIMCD  EQU   COMMON+20                                                02687000
KYWDEND  EQU   COMMON+16                                                02688000
KYWDBGN  EQU   COMMON+12                                                02689000
VERBEND  EQU   COMMON+8                                                 02690000
VERBGN   EQU   COMMON+4                                                 02691000
LPDEXTAD EQU   LPDEMJNM+4                                               02692000
LPDEXTLN EQU   LPDEMJNM                                                 02693000
LPDEATT3 EQU   LPDE+30                                                  02694000
LPDEAUTH EQU   LPDEATT2                                                 02695000
LPDESYSL EQU   LPDEATT2                                                 02696000
@NM00013 EQU   LPDEATT2                                                 02697000
@NM00012 EQU   LPDEATT2                                                 02698000
LPDERLC  EQU   LPDEATT2                                                 02699000
LPDEXLE  EQU   LPDEATT2                                                 02700000
@NM00011 EQU   LPDEATT2                                                 02701000
LPDENLR  EQU   LPDEATTR                                                 02702000
@NM00010 EQU   LPDEATTR                                                 02703000
LPDEMIN  EQU   LPDEATTR                                                 02704000
@NM00009 EQU   LPDEATTR                                                 02705000
LPDESER  EQU   LPDEATTR                                                 02706000
LPDEREN  EQU   LPDEATTR                                                 02707000
@NM00008 EQU   LPDEATTR                                                 02708000
LPDENIP  EQU   LPDEATTR                                                 02709000
@NM00007 EQU   LPDE+26                                                  02710000
LPDEUSE  EQU   LPDE+24                                                  02711000
LPDEXLP  EQU   LPDE+20                                                  02712000
LPDENAME EQU   LPDE+8                                                   02713000
LPDERBP  EQU   LPDE+4                                                   02714000
LPDECHN  EQU   LPDE                                                     02715000
CDATTR3  EQU   CDENTRY+30                                               02716000
CDAUTH   EQU   CDATTR2                                                  02717000
CDSYSLIB EQU   CDATTR2                                                  02718000
CDOLY    EQU   CDATTR2                                                  02719000
@NM00006 EQU   CDATTR2                                                  02720000
CDRLC    EQU   CDATTR2                                                  02721000
CDXLE    EQU   CDATTR2                                                  02722000
CDREL    EQU   CDATTR2                                                  02723000
CDSPZ    EQU   CDATTR2                                                  02724000
CDNLR    EQU   CDATTR                                                   02725000
CDJPA    EQU   CDATTR                                                   02726000
CDMIN    EQU   CDATTR                                                   02727000
CDNFN    EQU   CDATTR                                                   02728000
CDSER    EQU   CDATTR                                                   02729000
CDREN    EQU   CDATTR                                                   02730000
CDNIC    EQU   CDATTR                                                   02731000
CDNIP    EQU   CDATTR                                                   02732000
@NM00005 EQU   CDENTRY+26                                               02733000
CDUSE    EQU   CDENTRY+24                                               02734000
CDXLMJP  EQU   CDENTRY+20                                               02735000
CDNAME   EQU   CDENTRY+8                                                02736000
CDRRBP   EQU   CDENTRY+4                                                02737000
CDCHAIN  EQU   CDENTRY                                                  02738000
CVTLEVL  EQU   CVTRELNO+2                                               02739000
CVTNUMB  EQU   CVTRELNO                                                 02740000
CVTMDL   EQU   CVTFIX+250                                               02741000
@NM00004 EQU   CVTFIX+248                                               02742000
@NM00003 EQU   CVTFIX                                                   02743000
CVTRV482 EQU   CVTXTNT2+128                                             02744000
CVTRV481 EQU   CVTXTNT2+124                                             02745000
CVTRV480 EQU   CVTXTNT2+120                                             02746000
CVTRV479 EQU   CVTXTNT2+118                                             02747000
CVTRV478 EQU   CVTXTNT2+117                                             02748000
CVTRV477 EQU   CVTXTNT2+116                                             02749000
CVTRV476 EQU   CVTXTNT2+115                                             02750000
CVTRV475 EQU   CVTXTNT2+114                                             02751000
CVTRV474 EQU   CVTRV466                                                 02752000
CVTRV473 EQU   CVTRV466                                                 02753000
CVTRV472 EQU   CVTRV466                                                 02754000
CVTRV471 EQU   CVTRV466                                                 02755000
CVTRV470 EQU   CVTRV466                                                 02756000
CVTRV469 EQU   CVTRV466                                                 02757000
CVTRV468 EQU   CVTRV466                                                 02758000
CVTRV467 EQU   CVTRV466                                                 02759000
CVTRV465 EQU   CVTRV457                                                 02760000
CVTRV464 EQU   CVTRV457                                                 02761000
CVTRV463 EQU   CVTRV457                                                 02762000
CVTRV462 EQU   CVTRV457                                                 02763000
CVTRV461 EQU   CVTRV457                                                 02764000
CVTRV460 EQU   CVTRV457                                                 02765000
CVTRV459 EQU   CVTRV457                                                 02766000
CVTRV458 EQU   CVTRV457                                                 02767000
CVTRV456 EQU   CVTXTNT2+108                                             02768000
CVTRV455 EQU   CVTXTNT2+104                                             02769000
CVTRV454 EQU   CVTXTNT2+100                                             02770000
CVTRV453 EQU   CVTXTNT2+96                                              02771000
CVTRV452 EQU   CVTXTNT2+94                                              02772000
CVTRV451 EQU   CVTXTNT2+92                                              02773000
CVTRV450 EQU   CVTXTNT2+90                                              02774000
CVTRV449 EQU   CVTXTNT2+88                                              02775000
CVTRV448 EQU   CVTXTNT2+87                                              02776000
CVTRV447 EQU   CVTXTNT2+86                                              02777000
CVTRV446 EQU   CVTRV438                                                 02778000
CVTRV445 EQU   CVTRV438                                                 02779000
CVTRV444 EQU   CVTRV438                                                 02780000
CVTRV443 EQU   CVTRV438                                                 02781000
CVTRV442 EQU   CVTRV438                                                 02782000
CVTRV441 EQU   CVTRV438                                                 02783000
CVTRV440 EQU   CVTRV438                                                 02784000
CVTRV439 EQU   CVTRV438                                                 02785000
CVTRV437 EQU   CVTRV429                                                 02786000
CVTRV436 EQU   CVTRV429                                                 02787000
CVTRV435 EQU   CVTRV429                                                 02788000
CVTRV434 EQU   CVTRV429                                                 02789000
CVTRV433 EQU   CVTRV429                                                 02790000
CVTRV432 EQU   CVTRV429                                                 02791000
CVTRV431 EQU   CVTRV429                                                 02792000
CVTRV430 EQU   CVTRV429                                                 02793000
CVTRV428 EQU   CVTXTNT2+80                                              02794000
CVTRV427 EQU   CVTXTNT2+76                                              02795000
CVTRV426 EQU   CVTXTNT2+72                                              02796000
CVTRV425 EQU   CVTXTNT2+68                                              02797000
CVTATACT EQU   CVTATCVT                                                 02798000
CVTRV423 EQU   CVTXTNT2+62                                              02799000
CVTRV422 EQU   CVTXTNT2+60                                              02800000
CVTRV421 EQU   CVTXTNT2+58                                              02801000
CVTRV420 EQU   CVTXTNT2+56                                              02802000
CVTRV419 EQU   CVTXTNT2+55                                              02803000
CVTRV418 EQU   CVTXTNT2+54                                              02804000
CVTRV417 EQU   CVTRV409                                                 02805000
CVTRV416 EQU   CVTRV409                                                 02806000
CVTRV415 EQU   CVTRV409                                                 02807000
CVTRV414 EQU   CVTRV409                                                 02808000
CVTRV413 EQU   CVTRV409                                                 02809000
CVTRV412 EQU   CVTRV409                                                 02810000
CVTRV411 EQU   CVTRV409                                                 02811000
CVTRV410 EQU   CVTRV409                                                 02812000
CVTRV408 EQU   CVTRV400                                                 02813000
CVTRV407 EQU   CVTRV400                                                 02814000
CVTRV406 EQU   CVTRV400                                                 02815000
CVTRV405 EQU   CVTRV400                                                 02816000
CVTRV404 EQU   CVTRV400                                                 02817000
CVTRV403 EQU   CVTRV400                                                 02818000
CVTRV402 EQU   CVTRV400                                                 02819000
CVTRV401 EQU   CVTRV400                                                 02820000
CVTICB   EQU   CVTXTNT2+48                                              02821000
CVTSKTA  EQU   CVTXTNT2+44                                              02822000
CVTRSV99 EQU   CVTXTNT2+40                                              02823000
CVTRSV98 EQU   CVTXTNT2+36                                              02824000
CVTRSV97 EQU   CVTXTNT2+34                                              02825000
CVTRSV96 EQU   CVTXTNT2+32                                              02826000
CVTOLTEP EQU   CVTXTNT2+28                                              02827000
CVTQIDA  EQU   CVTQID+1                                                 02828000
CVTRSV95 EQU   CVTQID                                                   02829000
CVTRSV94 EQU   CVTXTNT2+20                                              02830000
CVTRSV93 EQU   CVTXTNT2+16                                              02831000
CVTRSV92 EQU   CVTXTNT2+12                                              02832000
CVTDEBVR EQU   CVTXTNT2+8                                               02833000
CVTRSV91 EQU   CVTXTNT2+6                                               02834000
CVTRSV9H EQU   CVTFLGBT                                                 02835000
CVTRSV9G EQU   CVTFLGBT                                                 02836000
CVTRSV9F EQU   CVTFLGBT                                                 02837000
CVTRSV9E EQU   CVTFLGBT                                                 02838000
CVTRSV9D EQU   CVTFLGBT                                                 02839000
CVTRSV9C EQU   CVTFLGBT                                                 02840000
CVTVME   EQU   CVTFLGBT                                                 02841000
CVTNPE   EQU   CVTFLGBT                                                 02842000
CVTNUCLS EQU   CVTXTNT2+4                                               02843000
CVTDSSVA EQU   CVTDSSV+1                                                02844000
CVTRSV89 EQU   CVTDSSV                                                  02845000
CVTRSV88 EQU   CVTXTNT1+8                                               02846000
CVTRSV87 EQU   CVTXTNT1+4                                               02847000
CVTFACHN EQU   CVTXTNT1                                                 02848000
CVTRV488 EQU   CVTMAP+412                                               02849000
CVTRV487 EQU   CVTMAP+408                                               02850000
CVTRV486 EQU   CVTMAP+404                                               02851000
CVTRV485 EQU   CVTMAP+400                                               02852000
CVTACTAP EQU   CVTMAP+396                                               02853000
CVTAUTH  EQU   CVTMAP+392                                               02854000
CVTATMCA EQU   CVTATMCT+1                                               02855000
CVTATMST EQU   CVTATMCT                                                 02856000
CVTRSV61 EQU   CVTMAP+384                                               02857000
CVTVOLT1 EQU   CVTVOLM1+1                                               02858000
CVTVOLI1 EQU   CVTVOLF1                                                 02859000
CVTSTOA  EQU   CVTMAP+376                                               02860000
CVTRSV58 EQU   CVTMAP+374                                               02861000
CVTRSV57 EQU   CVTMAP+372                                               02862000
CVTDDCE  EQU   CVTMAP+368                                               02863000
CVTPNWFR EQU   CVTMAP+364                                               02864000
CVTSMF   EQU   CVTMAP+360                                               02865000
CVTSULK  EQU   CVTMAP+358                                               02866000
CVTSLKO  EQU   CVTSYSK                                                  02867000
CVTSLKP  EQU   CVTSYSK                                                  02868000
CVTSLKQ  EQU   CVTSYSK                                                  02869000
CVTSLKR  EQU   CVTSYSK                                                  02870000
CVTRSV56 EQU   CVTSYSK                                                  02871000
CVTRSV55 EQU   CVTSYSK                                                  02872000
CVTRSV54 EQU   CVTSYSK                                                  02873000
CVTRSV53 EQU   CVTSYSK                                                  02874000
CVTRSV52 EQU   CVTA1F1                                                  02875000
CVTRSV51 EQU   CVTA1F1                                                  02876000
CVTRSV50 EQU   CVTA1F1                                                  02877000
CVTRSV49 EQU   CVTA1F1                                                  02878000
CVTRSV48 EQU   CVTA1F1                                                  02879000
CVTRSV47 EQU   CVTA1F1                                                  02880000
CVTSRSW  EQU   CVTA1F1                                                  02881000
CVTPFSW  EQU   CVTA1F1                                                  02882000
CVTPCVT  EQU   CVTMAP+352                                               02883000
CVTRSV46 EQU   CVTMAP+344                                               02884000
CVTRSV45 EQU   CVTMAP+340                                               02885000
CVTRSV44 EQU   CVTMAP+338                                               02886000
CVTRSV43 EQU   CVTMAP+336                                               02887000
CVTHJESA EQU   CVTHJES+1                                                02888000
CVTRSV42 EQU   CVTHJES                                                  02889000
CVTEXT2A EQU   CVTEXT2+1                                                02890000
CVTRSV41 EQU   CVTEXT2                                                  02891000
CVTAPFA  EQU   CVTAPF+1                                                 02892000
CVTRSV40 EQU   CVTAPF                                                   02893000
CVTRV518 EQU   CVTINTLA                                                 02894000
CVTRV517 EQU   CVTERPV                                                  02895000
CVTEORM  EQU   CVTMAP+312                                               02896000
CVTMCHPR EQU   CVTMAP+308                                               02897000
CVTTZ    EQU   CVTMAP+304                                               02898000
CVTJEPS  EQU   CVTMAP+300                                               02899000
CVTJESCT EQU   CVTMAP+296                                               02900000
CVTMODE  EQU   CVTMAP+292                                               02901000
CVTPTRV  EQU   CVTMAP+288                                               02902000
CVTREAL  EQU   CVTMAP+284                                               02903000
CVTRSV39 EQU   CVTMAP+280                                               02904000
CVTRSV38 EQU   CVTMAP+276                                               02905000
CVTDMSRA EQU   CVTDMSR+1                                                02906000
CVTRSV37 EQU   CVTDMSR                                                  02907000
CVTQMSGA EQU   CVTQMSG+1                                                02908000
CVTRSV36 EQU   CVTQMSG                                                  02909000
CVTAMFF  EQU   CVTMAP+264                                               02910000
CVTPURGA EQU   CVTPURG+1                                                02911000
CVTRSV35 EQU   CVTPURG                                                  02912000
CVTCBSP  EQU   CVTMAP+256                                               02913000
CVTATERA EQU   CVTATER+1                                                02914000
CVTSYST  EQU   CVTATER                                                  02915000
CVTVOLT2 EQU   CVTTAT                                                   02916000
CVTVOLI2 EQU   CVTVOLF2                                                 02917000
CVTAQAVB EQU   CVTAQAVT+1                                               02918000
CVTRSV34 EQU   CVTTCMFG                                                 02919000
CVTRSV33 EQU   CVTTCMFG                                                 02920000
CVTRSV32 EQU   CVTTCMFG                                                 02921000
CVTRSV31 EQU   CVTTCMFG                                                 02922000
CVTRSV30 EQU   CVTTCMFG                                                 02923000
CVTRSV29 EQU   CVTTCMFG                                                 02924000
CVTRSV28 EQU   CVTTCMFG                                                 02925000
CVTTCRDY EQU   CVTTCMFG                                                 02926000
CVTGTFA  EQU   CVTGTF+1                                                 02927000
CVTRSV27 EQU   CVTGTFST                                                 02928000
CVTRNIO  EQU   CVTGTFST                                                 02929000
CVTUSR   EQU   CVTGTFST                                                 02930000
CVTRV318 EQU   CVTFORM                                                  02931000
CVTRV317 EQU   CVTTMODE                                                 02932000
CVTRV316 EQU   CVTSTATE                                                 02933000
CVTRV315 EQU   CVTGTFS                                                  02934000
CVTGTFAV EQU   CVTGTFS                                                  02935000
CVT0SCR1 EQU   CVTMAP+232                                               02936000
CVTRV515 EQU   CVTMAP+228                                               02937000
CVTRMS   EQU   CVTMAP+224                                               02938000
CVTPATCH EQU   CVTMAP+220                                               02939000
CVTTSCE  EQU   CVTMAP+216                                               02940000
CVTLNKSC EQU   CVTMAP+214                                               02941000
CVTQABST EQU   CVTMAP+212                                               02942000
CVTMDLDS EQU   CVTMAP+208                                               02943000
CVTUSER  EQU   CVTMAP+204                                               02944000
CVTABEND EQU   CVTMAP+200                                               02945000
CVTSMCA  EQU   CVTMAP+196                                               02946000
CVTRSV18 EQU   CVTMAP+192                                               02947000
CVTRSV17 EQU   CVTOPTB                                                  02948000
CVTRSV16 EQU   CVTOPTB                                                  02949000
CVTFP    EQU   CVTOPTB                                                  02950000
CVTAPTHR EQU   CVTOPTB                                                  02951000
CVTNLOG  EQU   CVTOPTB                                                  02952000
CVTTOD   EQU   CVTOPTB                                                  02953000
CVTCTIMS EQU   CVTOPTB                                                  02954000
CVTPROT  EQU   CVTOPTB                                                  02955000
CVTXPFP  EQU   CVTOPTA                                                  02956000
CVTASCII EQU   CVTOPTA                                                  02957000
CVTRSV13 EQU   CVTOPTA                                                  02958000
CVTRSV12 EQU   CVTOPTA                                                  02959000
CVTNIP   EQU   CVTOPTA                                                  02960000
CVTDDR   EQU   CVTOPTA                                                  02961000
CVTAPR   EQU   CVTOPTA                                                  02962000
CVTCCH   EQU   CVTOPTA                                                  02963000
CVTSNCTR EQU   CVTMAP+180                                               02964000
CVTQMWR  EQU   CVTMAP+176                                               02965000
CVTQOCR  EQU   CVTMAP+172                                               02966000
CVT1EF00 EQU   CVTMAP+168                                               02967000
CVTMZ00  EQU   CVTMAP+164                                               02968000
CVTHEAD  EQU   CVTMAP+160                                               02969000
CVTRSV11 EQU   CVTMAP+156                                               02970000
CVT0PT01 EQU   CVTMAP+152                                               02971000
CVTMSER  EQU   CVTMAP+148                                               02972000
CVTRV516 EQU   CVTIERLC                                                 02973000
CVTILCH  EQU   CVTMAP+140                                               02974000
CVT0DS   EQU   CVTMAP+136                                               02975000
CVTFBOSV EQU   CVTMAP+132                                               02976000
CVTNUCB  EQU   CVTMAP+128                                               02977000
CVTIXAVL EQU   CVTMAP+124                                               02978000
CVTIOQET EQU   CVTMAP+120                                               02979000
CVTDCBA  EQU   CVTMAP+117                                               02980000
CVTMVS2  EQU   CVTDCB                                                   02981000
CVT6DAT  EQU   CVTDCB                                                   02982000
CVT4MPS  EQU   CVTDCB                                                   02983000
CVTRSV09 EQU   CVTDCB                                                   02984000
CVT4MS1  EQU   CVTDCB                                                   02985000
CVT2SPS  EQU   CVTDCB                                                   02986000
CVT1SSS  EQU   CVTDCB                                                   02987000
CVTRSV08 EQU   CVTDCB                                                   02988000
CVTSTB   EQU   CVTMAP+112                                               02989000
CVTQTD00 EQU   CVTMAP+108                                               02990000
CVTQTE00 EQU   CVTMAP+104                                               02991000
CVTCUCB  EQU   CVTMAP+100                                               02992000
CVTSJQ   EQU   CVTMAP+96                                                02993000
CVTPBLDL EQU   CVTMAP+92                                                02994000
CVTTPC   EQU   CVTMAP+88                                                02995000
CVTSVDCB EQU   CVTMAP+84                                                02996000
CVTBRET  EQU   CVTMAP+82                                                02997000
CVTEXIT  EQU   CVTMAP+80                                                02998000
CVT0FN00 EQU   CVTMAP+76                                                02999000
CVTDARA  EQU   CVTDAR+1                                                 03000000
CVTRSV07 EQU   CVTFLGS1                                                 03001000
CVTRSV06 EQU   CVTFLGS1                                                 03002000
CVTRSV05 EQU   CVTFLGS1                                                 03003000
CVTRSV04 EQU   CVTFLGS1                                                 03004000
CVTRSV03 EQU   CVTFLGS1                                                 03005000
CVTRSV02 EQU   CVTFLGS1                                                 03006000
CVTRSV01 EQU   CVTFLGS1                                                 03007000
CVTDMPLK EQU   CVTFLGS1                                                 03008000
CVTXITP  EQU   CVTMAP+68                                                03009000
CVTZDTAB EQU   CVTMAP+64                                                03010000
CVTMSLT  EQU   CVTMAP+60                                                03011000
CVTDATE  EQU   CVTMAP+56                                                03012000
CVTBTERM EQU   CVTMAP+52                                                03013000
CVTSYSAD EQU   CVTMAP+48                                                03014000
CVTXTLER EQU   CVTMAP+44                                                03015000
CVTILK2  EQU   CVTMAP+40                                                03016000
CVTILK1  EQU   CVTMAP+36                                                03017000
CVTPRLTV EQU   CVTMAP+32                                                03018000
CVTPCNVT EQU   CVTMAP+28                                                03019000
CVT0VL00 EQU   CVTMAP+24                                                03020000
CVTXAPG  EQU   CVTMAP+20                                                03021000
CVTBUF   EQU   CVTMAP+16                                                03022000
CVTJOB   EQU   CVTMAP+12                                                03023000
CVTLINK  EQU   CVTMAP+8                                                 03024000
CVT0EF00 EQU   CVTMAP+4                                                 03025000
CVTTCBP  EQU   CVTMAP                                                   03026000
CVT      EQU   CVTMAP                                                   03027000
ITEMS    EQU   LISTBLK                                                  03028000
@NM00002 EQU   BLDLENTR+11                                              03029000
@NM00001 EQU   BLDLENTR+8                                               03030000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      03031000
@RT00086 EQU   TYPELOAD                                                 03032000
@RT00103 EQU   XITENPT                                                  03033000
@RT00110 EQU   SETLIMIT                                                 03034000
@RT00116 EQU   INCORE                                                   03035000
@RT00167 EQU   WHATSIN                                                  03036000
@RF00211 EQU   OK2LOAD                                                  03037000
@RT00236 EQU   LOADIN                                                   03038000
@RT00243 EQU   XLODONLY                                                 03039000
@RT00257 EQU   LOAD                                                     03040000
@RT00266 EQU   INCORE                                                   03041000
@RF00333 EQU   @EL00001                                                 03042000
DELETOK  EQU   @EL00004                                                 03043000
@RT00405 EQU   @EL00005                                                 03044000
@ENDDATA EQU   *                                                        03045000
         END   AMDPRSEG,(C'PLS2155',0701,76209)                         03046000
