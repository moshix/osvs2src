         TITLE 'AMDPRUIM - EXIT INTERFACE MODULE                       *00001000
                        '                                               00002000
AMDPRUIM CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL2(@EP00001-@MAINENT)                                   00007000
         DC    AL1(16)                                             0001 00008000
         DC    C'AMDPRUIM  76.189'                                 0001 00009000
AMDUSRXT DS    0H                                                  0001 00010000
         USING *,@15                                               0001 00011000
         B     @PROLOG                                             0001 00012000
         DC    AL2(@EP00112-AMDUSRXT)                                   00013000
         ENTRY AMDUSRXT                                                 00014000
AMDUSRDL DS    0H                                                  0001 00015000
         USING *,@15                                               0001 00016000
         B     @PROLOG                                             0001 00017000
         DC    AL2(@EP00350-AMDUSRDL)                                   00018000
         ENTRY AMDUSRDL                                                 00019000
         DROP  @15                                                      00020000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00021000
         BALR  @11,0                                               0001 00022000
@PSTART  DS    0H                                                  0001 00023000
         USING @PSTART,@11                                         0001 00024000
         ST    @13,@SA00001+4                                      0001 00025000
         LA    @14,@SA00001                                        0001 00026000
         ST    @14,8(,@13)                                         0001 00027000
         LR    @13,@14                                             0001 00028000
         AH    @15,4(,@15)                                         0001 00029000
         BR    @15                                                 0001 00030000
@EP00001 DS    0H                                                  0002 00031000
         LOAD EP=AMDPRECT,ERRET=ECTBADLD    ATTEMPT LOAD AMDPRECT       00032000
*   ECTADDR=R0;                     /* SAVE ADDRESS OF AMDPRECT      */ 00033000
         ST    R0,ECTADDR                                          0082 00034000
*   GEN(N     R1,=X'00FFFFFF');     /* MASK OFF AUTH CODE OZ09692    */ 00035000
         N     R1,=X'00FFFFFF'                                          00036000
*   ECTNUM=R1*8/NTRYSIZE;           /* GET LENGTH OF ECT IN BYTES &     00037000
*                                      COMPUTE NO. OF ECT ENTRIES    */ 00038000
         LR    @05,R1                                              0084 00039000
         M     @04,@CF00042                                        0084 00040000
         D     @04,@CF00212                                        0084 00041000
         STH   @05,ECTNUM                                          0084 00042000
*   GENERATE FLOWS(FMTBADLD);                                      0085 00043000
         LOAD EP=AMDPRFMT,ERRET=FMTBADLD    ATTEMPT LOAD AMDPRFMT       00044000
*   EIPLFRMT=R0;                    /* STORE ADDRESS OF AMDPRFMT IN     00045000
*                                      PARM LIST COPY                */ 00046000
         ST    R0,EIPLFRMT                                         0086 00047000
*   FAILSW=OFF;                     /* INDICATE EXIT INTERFACE INIT     00048000
*                                      PROPERLY AND IS ACTIVE        */ 00049000
         NI    FAILSW,B'01111111'                                  0087 00050000
*   RETURN;                         /* RETURN TO AMDPRCTL            */ 00051000
*                                                                  0088 00052000
@EL00001 L     @13,4(,@13)                                         0088 00053000
@EF00001 DS    0H                                                  0088 00054000
@ER00001 LM    @14,@12,12(@13)                                     0088 00055000
         BR    @14                                                 0088 00056000
*   /*****************************************************************/ 00057000
*   /*                                                               */ 00058000
*   /* UNABLE TO LOAD EXIT CONTROL TABLE- AMDPRECT. THE FOLLOWING    */ 00059000
*   /* ROUTINE IS ENTERED ASYNCHRONOUSLY FORM LOAD. ISSUE ERROR      */ 00060000
*   /* MESSAGE AMD281I AND DEACTIVATE EXIT INTERFACE.                */ 00061000
*   /*                                                               */ 00062000
*   /*****************************************************************/ 00063000
*                                                                  0089 00064000
*ECTBADLD:                                                         0089 00065000
*   LOADCSAV=R1;                    /* SAVE COMP & RETURN CODE FROM  */ 00066000
ECTBADLD STH   R1,LOADCSAV                                         0089 00067000
*   LOADRSAV=R15;                   /* LOAD                          */ 00068000
         STC   R15,LOADRSAV                                        0090 00069000
*   MGTBINDX=MGTABPTR+INDX281I;     /* ADDRESS MSG AMD281I           */ 00070000
         LA    MGTBINDX,40                                         0091 00071000
         AL    MGTBINDX,MGTABPTR                                   0091 00072000
*   RFY                                                            0092 00073000
*     MSGMODNM BASED(MSGADDR+D281MODN);/* ADDRESS MODULE NAME FIELD     00074000
*                                      OF AMD281I                    */ 00075000
*   MSGMODNM=F281ECT;               /* SET MODULE NAME FIELD IN MSG     00076000
*                                      TO AMDPRECT                   */ 00077000
*                                                                  0093 00078000
         L     @14,MSGADDR(,MGTBINDX)                              0093 00079000
         MVC   MSGMODNM+45(8,@14),@CC00472                         0093 00080000
*   /*****************************************************************/ 00081000
*   /*                                                               */ 00082000
*   /* THE FOLLOWING SECTION IS COMMON TO ECTBADLD (LOAD FAIL ON ECT)*/ 00083000
*   /* AND FMTBADLD (LOAD FAIL ON FMT). THE COMPLETION & RETURN CODES*/ 00084000
*   /* ARE CONVERTED TO PRINTABLE HEX & INSERTED IN THE MSG BUFFER.  */ 00085000
*   /*                                                               */ 00086000
*   /*****************************************************************/ 00087000
*                                                                  0094 00088000
*LOADCDCV:                                                         0094 00089000
*   RFY                                                            0094 00090000
*     MSGCOMPC BASED(MSGADDR+D281COMP);/* ADDRESS COMPL CODE FIELD   */ 00091000
LOADCDCV DS    0H                                                  0095 00092000
*   R2=ADDR(MSGCOMPC);              /* SET UP PARAMETERS TO          */ 00093000
         LA    R2,54                                               0095 00094000
         AL    R2,MSGADDR(,MGTBINDX)                               0095 00095000
*   R3=ADDR(LOADCSAV);              /* HEX CONVERT INLINE MACRO      */ 00096000
         LA    R3,LOADCSAV                                         0096 00097000
*   GEN(HEXCNVT (2),(3),2);         /* CONVERT COMPL CODE TO PRINT-     00098000
*                                      ABLE HEX                      */ 00099000
         HEXCNVT (2),(3),2                                              00100000
*   RFY                                                            0098 00101000
*     MSGRETCD BASED(MSGADDR+D281RETC);/* ADDRESS RET CODE FIELD     */ 00102000
*   R2=ADDR(MSGRETCD);              /* SET UP PARAMETERS TO          */ 00103000
         LA    R2,59                                               0099 00104000
         AL    R2,MSGADDR(,MGTBINDX)                               0099 00105000
*   R3=ADDR(LOADRSAV);              /* HEX CONVERT INLINE MACRO      */ 00106000
         LA    R3,LOADRSAV                                         0100 00107000
*   GEN(HEXCNVT (2),(3),1);         /* CONVERT RET CODE TO PRINTABLE    00108000
*                                      HEX                           */ 00109000
         HEXCNVT (2),(3),1                                              00110000
*   CALL MSGWRITR;                  /* CALL MESSAGE WRITER SUBROUTIN */ 00111000
         BAL   @14,MSGWRITR                                        0102 00112000
*   FAILSW=ON;                      /* INDICATE EXIT INTERFACE INIT     00113000
*                                      FAILED AND IS INACTIVE        */ 00114000
         OI    FAILSW,B'10000000'                                  0103 00115000
*   RETURN;                         /* RETURN TO AMDPRCTL            */ 00116000
*                                                                  0104 00117000
         B     @EL00001                                            0104 00118000
*   /*****************************************************************/ 00119000
*   /*                                                               */ 00120000
*   /* UNABLE TO LOAD LINE FORMAT ROUTINE- AMDPRFMT. THE FOLLOWING   */ 00121000
*   /* ROUTINE IS ENTERED ASYNCHRONOUSLY FROM LOAD. DELETE EXIT      */ 00122000
*   /* CONTROL TABLE, ISSUE MSG AMD281I, AND DEACTIVATE EXIT         */ 00123000
*   /* INTERFACE                                                     */ 00124000
*   /*                                                               */ 00125000
*   /*****************************************************************/ 00126000
*                                                                  0105 00127000
*FMTBADLD:                                                         0105 00128000
*   LOADCSAV=R1;                    /* SAVE COMP & RETURN CODES      */ 00129000
FMTBADLD STH   R1,LOADCSAV                                         0105 00130000
*   LOADRSAV=R15;                   /* FROM LOAD                     */ 00131000
         STC   R15,LOADRSAV                                        0106 00132000
*   GEN(DELETE EP=AMDPRECT);        /* DELETE EXIT CONTROL TABLE   0107 00133000
*                                      SINCE CANT LOAD AMDPRFMT      */ 00134000
         DELETE EP=AMDPRECT                                             00135000
*   MGTBINDX=MGTABPTR+INDX281I;     /* ADDRESS MSG AMD281I           */ 00136000
         LA    MGTBINDX,40                                         0108 00137000
         AL    MGTBINDX,MGTABPTR                                   0108 00138000
*   RFY                                                            0109 00139000
*     MSGMODNM BASED(MSGADDR+D281MODN);/* ADDRESS MODULE NAME FIELD     00140000
*                                      OF AMD281I                    */ 00141000
*   MSGMODNM=F281FMT;               /* SET MODULE NAME FIELD IN MSG     00142000
*                                      TO AMDPRFMT                   */ 00143000
         L     @14,MSGADDR(,MGTBINDX)                              0110 00144000
         MVC   MSGMODNM+45(8,@14),@CC00474                         0110 00145000
*   GOTO LOADCDCV;                  /* GO CONVERT RETURN CODES AND 0111 00146000
*                                      ISSUE MSG 281I                */ 00147000
         B     LOADCDCV                                            0111 00148000
*                                                                  0112 00149000
*   /*****************************************************************/ 00150000
*   /*                                                               */ 00151000
*   /* MAIN ENTRY POINT FOR AMDPRDMP EXIT INTERFACE. CALLED BY       */ 00152000
*   /* AMDPRDMP FORMATTING ROUTINES DURING THE PROCESSING OF THE     */ 00153000
*   /* FOLLOWING: EACH TCB AND ITS ASSOCIATED CONTROL BLOCKS EACH    */ 00154000
*   /* ASID AND ITS ASSOCIATED CONTROL BLOCKS EACH FORMAT STATEMENT  */ 00155000
*   /* EACH PRINT CURRENT OR PRINT JOBNAME STATEMENT EACH PRINT      */ 00156000
*   /* NUCLEUS STATEMENT CALLED BY THE MAIN SCAN ROUTINE AMDPRMSC    */ 00157000
*   /* WHEN AN UNRECOGNIZABL CONTROL STATEMENT IS ENCOUNTERED.       */ 00158000
*   /* FUNCTION IS TO SCAN THE EXIT CONTROL TABLE SEARCHING FOR NAMES*/ 00159000
*   /* OF MODULES TO BE GIVEN CONTROL ON THE AMDPRDMP EXIT CURRENTLY */ 00160000
*   /* BEING PROCESSED. CONTROL IS GIVEN TO THOSE EXIT MODULES FOUND.*/ 00161000
*   /* DUMP READING AND OUTPUT WRITING SERVICES ARE PROVIDED.        */ 00162000
*   /*                                                               */ 00163000
*   /*****************************************************************/ 00164000
*                                                                  0112 00165000
*AMDUSRXT:                                                         0112 00166000
*   ENTRY;                                                         0112 00167000
@EP00112 DS    0H                                                  0113 00168000
*   CURENSAV=R13;                   /* SET UP FOR ERROR & STOP RTNS  */ 00169000
         ST    R13,CURENSAV                                        0113 00170000
*   EIPROCSW=EIPROCSW&EIPSWRST;     /* RESET EXIT INTERFACE PROCESS     00171000
*                                      SWITCHES EXCEPT FAILSW        */ 00172000
         NI    EIPROCSW,X'80'                                      0114 00173000
*   IF FAILSW=ON THEN               /* EXIT INTERFACE ACTIVE?        */ 00174000
         TM    FAILSW,B'10000000'                                  0115 00175000
         BNO   @RF00115                                            0115 00176000
*     DO;                           /* NO- NORMALLY JUST RETURN TO   */ 00177000
*       IF EXITFLAG=ZVERB THEN      /* CALLER AS NOP EXCEPT IF THIS  */ 00178000
         CLI   EXITFLAG(COMPTR),X'00'                              0117 00179000
         BNE   @RF00117                                            0117 00180000
*         DO;                       /* CALL IS FOR A VERB EXIT, ISSUE   00181000
*                                      MESSAGE AMD289I INDICATING  0118 00182000
*                                      THAT THIS VERB IS BEING     0118 00183000
*                                      IGNORED                       */ 00184000
*           MGTBINDX=MGTABPTR+INDX289I;/* ADDRESS MSG AMD289I        */ 00185000
         LA    MGTBINDX,64                                         0119 00186000
         AL    MGTBINDX,MGTABPTR                                   0119 00187000
*           RFY                                                    0120 00188000
*             MSGVRBNM BASED(MSGADDR+D289VRBN);/* ADDRESS VERB       */ 00189000
*           VERBLEN=VERBEND-VERBGN; /* FIELD & COMPUTE LENGTH        */ 00190000
         L     @14,VERBGN(,COMPTR)                                 0121 00191000
         L     VERBLEN,VERBEND(,COMPTR)                            0121 00192000
         SLR   VERBLEN,@14                                         0121 00193000
*           MSGVRBNM=BLANKS;        /* INIT VERB FIELD TO BLANKS     */ 00194000
         LA    @10,22                                              0122 00195000
         AL    @10,MSGADDR(,MGTBINDX)                              0122 00196000
         MVC   MSGVRBNM(8,@10),BLANKS(COMPTR)                      0122 00197000
*           MSGVRBNM(1:VERBLEN)=VERBMAP;/* MOVE REQD EXIT VERB TO    */ 00198000
         LR    @07,VERBLEN                                         0123 00199000
         BCTR  @07,0                                               0123 00200000
         EX    @07,@SM00570                                        0123 00201000
*           CALL MSGWRITR;          /* MSG BUFFER AND ISSUE AMD289I  */ 00202000
         BAL   @14,MSGWRITR                                        0124 00203000
*         END;                                                     0125 00204000
*       RETURN;                     /* RETURN TO CALLER- EXIT INTER- */ 00205000
         B     @EL00001                                            0126 00206000
*     END;                          /* FACE INACTIVE                 */ 00207000
*                                                                  0127 00208000
*   /*****************************************************************/ 00209000
*   /*                                                               */ 00210000
*   /* EXIT INTERFACE IS ACTIVE- PERFORM INITIALIZATION- THEN        */ 00211000
*   /* DETERMINE WHETEHR THIS CALL IS FOR AN EXIT VERB OR AN AMDPRDMP*/ 00212000
*   /* FORMAT EXIT.                                                  */ 00213000
*   /*                                                               */ 00214000
*   /*****************************************************************/ 00215000
*                                                                  0128 00216000
*   ECTABPTR=ECTADDR;               /* SET INDEX PTR TO 1ST TAB NTRY */ 00217000
@RF00115 L     ECTABPTR,ECTADDR                                    0128 00218000
*   ERRHANSV=ERRADDR;               /* SAVE CURRENT ERROR & STOP     */ 00219000
         MVC   ERRHANSV(4),ERRADDR(COMPTR)                         0129 00220000
*   STPHANSV=STOPEXIT;              /* HANDLERS FROM COMMON          */ 00221000
         MVC   STPHANSV(4),STOPEXIT(COMPTR)                        0130 00222000
*   ERRADDR=ADDR(UIMBRDER);         /* STORE EXIT INTERFACES ERROR & */ 00223000
         LA    @14,UIMBRDER                                        0131 00224000
         ST    @14,ERRADDR(,COMPTR)                                0131 00225000
*   STOPEXIT=ADDR(UIMSTOP);         /* STOP HANDLER ADDRESSES IN COM */ 00226000
         LA    @14,UIMSTOP                                         0132 00227000
         ST    @14,STOPEXIT(,COMPTR)                               0132 00228000
*   IF EXITFLAG=ZVERB THEN          /* IS THIS CALL FOR A VERB EXIT? */ 00229000
         CLI   EXITFLAG(COMPTR),X'00'                              0133 00230000
         BE    @RT00133                                            0133 00231000
*     GOTO VRBEXIT;                 /* YES- PROCESS                  */ 00232000
*                                                                  0134 00233000
*   /*****************************************************************/ 00234000
*   /*                                                               */ 00235000
*   /* AMDPRDMP FORMAT ROUTINE EXIT HANDLER                          */ 00236000
*   /*                                                               */ 00237000
*   /*****************************************************************/ 00238000
*                                                                  0135 00239000
*FMTABSRH:                                                         0135 00240000
*   DO NTRYCT=1 TO ECTNUM WHILE     /* INDEX THROUGH ECT UNITL       */ 00241000
*         (USTOPSW=OFF);            /* MATCH IS FOUND                */ 00242000
FMTABSRH LA    NTRYCT,1                                            0135 00243000
         B     @DE00135                                            0135 00244000
@DL00135 TM    USTOPSW,B'01000000'                                 0135 00245000
         BNZ   @DC00135                                            0135 00246000
*     IF EXITFLAG=(ECTFLAG&EXITFLAG) THEN                          0136 00247000
         MVC   @TS00001(1),ECTFLAG(ECTABPTR)                       0136 00248000
         NC    @TS00001(1),EXITFLAG(COMPTR)                        0136 00249000
         CLC   EXITFLAG(1,COMPTR),@TS00001                         0136 00250000
         BNE   @RF00136                                            0136 00251000
*       DO;                                                        0137 00252000
*                                                                  0137 00253000
*         /***********************************************************/ 00254000
*         /*                                                         */ 00255000
*         /* MATCH FOUND FOR THIS ECT ENTRY, PREPARE TO GIVE EXIT    */ 00256000
*         /* MODULE CONTROL                                          */ 00257000
*         /*                                                         */ 00258000
*         /***********************************************************/ 00259000
*                                                                  0138 00260000
*         ELOADMOD=ECTMOD;          /* FOR LOAD MACRO                */ 00261000
         MVC   ELOADMOD(8),ECTMOD(ECTABPTR)                        0138 00262000
*         GENERATE REFS(ELOADMOD) FLOWS(EXTBADLD);                 0139 00263000
         LOAD EPLOC=ELOADMOD,ERRET=EXTBADLD    BRING IN EXIT MODULE     00264000
*         AEXITMOD=R0;              /* SAVE ADDRESS OF EXIT MODULE   */ 00265000
*                                                                  0140 00266000
         LR    AEXITMOD,R0                                         0140 00267000
*         /***********************************************************/ 00268000
*         /*                                                         */ 00269000
*         /* RESTORE FIXED PART OF EXIT PARM LIST IN CASE MODIFIED BY*/ 00270000
*         /* PREVIOUS EXIT MOD                                       */ 00271000
*         /*                                                         */ 00272000
*         /***********************************************************/ 00273000
*                                                                  0141 00274000
*         EXITPLST=PLSTCOPY;                                       0141 00275000
*                                                                  0141 00276000
         MVC   EXITPLST(56),PLSTCOPY                               0141 00277000
*         /***********************************************************/ 00278000
*         /*                                                         */ 00279000
*         /* ALSO, SET UP VARIABLE PART OF PLIST AND INITIALIZE      */ 00280000
*         /* OUTPUT BUFFER AND PRDMP PLIST EXTENSION                 */ 00281000
*         /*                                                         */ 00282000
*         /***********************************************************/ 00283000
*                                                                  0142 00284000
*         ADPLCVT=CVTADDR;          /* SET CVT ADDR IN PLIST IN CASE    00285000
*                                      A CVT= HAD BEEN ENTERED PRIOR    00286000
*                                      TO THIS CALL OF UIM           */ 00287000
         L     @14,ABDPLPTR                                        0142 00288000
         MVC   ADPLCVT(4,@14),CVTADDR(COMPTR)                      0142 00289000
*         EIBUFFER='';              /* BLANK OUTPUT BUFFER           */ 00290000
         MVI   EIBUFFER,C' '                                       0143 00291000
         MVC   EIBUFFER+1(121),EIBUFFER                            0143 00292000
*         PRDMPEXT=0;               /* ZERO PRDMP PLIST EXTENSION FOR   00293000
*                                      NON=VERB EXIT                 */ 00294000
         SLR   @10,@10                                             0144 00295000
         ST    @10,PRDMPEXT                                        0144 00296000
*         IF EXITFLAG=ATCB THEN     /* IF THIS IS A TCB EXIT         */ 00297000
         CLI   EXITFLAG(COMPTR),X'80'                              0145 00298000
         BNE   @RF00145                                            0145 00299000
*           DO;                     /* THEN-                         */ 00300000
*             ADPLTCB=AUSRTCBA;     /* SET BOTH THE TCB AND          */ 00301000
         MVC   ADPLTCB(4,@14),AUSRTCBA(COMPTR)                     0147 00302000
*             ADPLASID=AUSRASID;    /* ASID FIELDS IN THE PLIST = TO */ 00303000
         MVC   ADPLASID(2,@14),AUSRASID(COMPTR)                    0148 00304000
*           END;                    /* THE ONES CURRENTLY BEING PROC */ 00305000
*         ELSE                      /* IF NOT-                       */ 00306000
*           DO;                     /* THEN                          */ 00307000
         B     @RC00145                                            0150 00308000
@RF00145 DS    0H                                                  0151 00309000
*             ADPLTCB=0;            /* SET TCB FIELD TO 0 AND        */ 00310000
         L     @14,ABDPLPTR                                        0151 00311000
         SLR   @10,@10                                             0151 00312000
         ST    @10,ADPLTCB(,@14)                                   0151 00313000
*             IF EXITFLAG=BASID THEN/* CHECK IF THIS IS ASID EXIT    */ 00314000
         CLI   EXITFLAG(COMPTR),X'40'                              0152 00315000
         BNE   @RF00152                                            0152 00316000
*               ADPLASID=AUSRASID;  /* IF SO SET JUST ASID CURRENTLY */ 00317000
         MVC   ADPLASID(2,@14),AUSRASID(COMPTR)                    0153 00318000
*             ELSE                  /* BEING PROCESSED, OTHERWISE    */ 00319000
*               ADPLASID=QASID;     /* SET ASID FIELD TO CURRENT ASID*/ 00320000
         B     @RC00152                                            0154 00321000
@RF00152 L     @14,ABDPLPTR                                        0154 00322000
         MVC   ADPLASID(2,@14),QASID(COMPTR)                       0154 00323000
*           END;                    /* PRDMP NOT PROCESSING ANY PART-   00324000
*                                      ICULAR TCB OR ASID            */ 00325000
*                                                                  0155 00326000
@RC00152 DS    0H                                                  0156 00327000
*         /***********************************************************/ 00328000
*         /*                                                         */ 00329000
*         /* PREPARE TO CALL EXIT MODULE                             */ 00330000
*         /*                                                         */ 00331000
*         /***********************************************************/ 00332000
*                                                                  0156 00333000
*         R1=ADDR(EXITPLST);        /* ADDRESS PLIST FOR EXIT RTN    */ 00334000
@RC00145 LA    R1,EXITPLST                                         0156 00335000
*         COMPTRSV=COMPTR;          /* SAVE PTR TO COMMON (R12)      */ 00336000
         ST    COMPTR,COMPTRSV                                     0157 00337000
*         COMPTR=0;                 /* ZERO PTR TO COMMON SO EXIT  0158 00338000
*                                      CAN'T TAMPER                  */ 00339000
         SLR   COMPTR,COMPTR                                       0158 00340000
*         CNTRLSW=ON;               /* INDICATE EXIT IN CONTROL      */ 00341000
         OI    CNTRLSW,B'00010000'                                 0159 00342000
*         CALL EXITMOD;             /* INVOKE EXIT MODULE            */ 00343000
         LR    @15,AEXITMOD                                        0160 00344000
         BALR  @14,@15                                             0160 00345000
*         CNTRLSW=OFF;              /* RESET EXIT IN CONTROL SWITCH  */ 00346000
         NI    CNTRLSW,B'11101111'                                 0161 00347000
*         COMPTR=COMPTRSV;          /* RESTORE PTR TO COMMON         */ 00348000
         L     COMPTR,COMPTRSV                                     0162 00349000
*         EXITRC=R15;               /* SAVE EXITS RETURN CODE        */ 00350000
         LR    EXITRC,R15                                          0163 00351000
*         GEN(DELETE EPLOC=ELOADMOD);                              0164 00352000
         DELETE EPLOC=ELOADMOD                                          00353000
*         CURENSAV=R13;             /* SET UP FOR ERROR & STOP RTNS  */ 00354000
*                                                                  0165 00355000
         ST    R13,CURENSAV                                        0165 00356000
*         /***********************************************************/ 00357000
*         /*                                                         */ 00358000
*         /* CHECK EXIT MODULES RETURN CODE IF RC = 4, HE WAS UNABLE */ 00359000
*         /* TO OBTAIN STORAGE (GETMAIN) FOR NORMAL PROCESSING       */ 00360000
*         /*                                                         */ 00361000
*         /***********************************************************/ 00362000
*                                                                  0166 00363000
*         IF EXITRC=4 THEN          /* BAD RETURN CODE?              */ 00364000
         CH    EXITRC,@CH00155                                     0166 00365000
         BNE   @RF00166                                            0166 00366000
*           DO;                     /* YES-                          */ 00367000
*             COMMODNM=ECTMOD;      /* MOVE THIS ECT ENTRYS MODULE 0168 00368000
*                                      NAME TO OUTPUT COMMENT TEXT   */ 00369000
         MVC   COMMODNM(8),ECTMOD(ECTABPTR)                        0168 00370000
*             CURBUFER(1:LENGTH(EXSTORCM))=EXSTORCM;/* MOVE TO       */ 00371000
         L     @14,CURBUF(,COMPTR)                                 0169 00372000
         MVC   CURBUFER+1(58,@14),EXSTORCM                         0169 00373000
*             GENERATE REFS(AWRITE);                               0170 00374000
*                                    /* CURRENT OUTPUT BUFFER        */ 00375000
         BRWRITE 1                    WRITE OUTPUT COMMENT              00376000
*           END;                                                   0171 00377000
*         IF PRNTSW=ON THEN         /* DID EXIT MODULE PRINT ANYTHING*/ 00378000
@RF00166 TM    PRNTSW,B'00001000'                                  0172 00379000
         BNO   @RF00172                                            0172 00380000
*           GEN(BRWRITE 2);         /* YES- SPACE 2 LINES            */ 00381000
         BRWRITE 2                                                      00382000
*       END;                                                       0174 00383000
*                                                                  0174 00384000
@RF00172 DS    0H                                                  0175 00385000
*     /***************************************************************/ 00386000
*     /*                                                             */ 00387000
*     /* CONTINUE SEARCH OF ECT FOR MORE MODULES TO GET CONTROL ON   */ 00388000
*     /* THIS EXIT                                                   */ 00389000
*     /*                                                             */ 00390000
*     /***************************************************************/ 00391000
*                                                                  0175 00392000
*FMTSRCHC:                                                         0175 00393000
*     PRNTSW=OFF;                   /* RESET PRINT SW BEFORE LOOKING    00394000
*                                      FOR NEXT EXIT MODULE          */ 00395000
@RF00136 DS    0H                                                  0175 00396000
FMTSRCHC NI    PRNTSW,B'11110111'                                  0175 00397000
*     ECTABPTR=ECTADDR+NTRYCT*NTRYSIZE;/* INCR TABLE PTR TO NEXT ECT    00398000
*                                      ENTRY                         */ 00399000
         LR    ECTABPTR,NTRYCT                                     0176 00400000
         MH    ECTABPTR,@CH00212                                   0176 00401000
         AL    ECTABPTR,ECTADDR                                    0176 00402000
*   END FMTABSRH;                                                  0177 00403000
*                                                                  0177 00404000
         AH    NTRYCT,@CH00075                                     0177 00405000
@DE00135 CH    NTRYCT,ECTNUM                                       0177 00406000
         BNH   @DL00135                                            0177 00407000
@DC00135 DS    0H                                                  0178 00408000
*   /*****************************************************************/ 00409000
*   /*                                                               */ 00410000
*   /* EXIT INTERFACE TERMINAL PROCESSING FOR THIS CALL OF AMDPRUIM  */ 00411000
*   /* RESTORE ERROR AND STOP HANDLER ADDRESSES IN COMMON AND RETURN */ 00412000
*   /* CALLER UNLESS IN STOP MODE FROM CONSOLE. IN THAT CASE, EXIT TO*/ 00413000
*   /* CURRENT STOP HANDLER WHOSE ADDRESS WAS JUST RESTORED IN COMMON*/ 00414000
*   /*                                                               */ 00415000
*   /*****************************************************************/ 00416000
*                                                                  0178 00417000
*LOADRETS:                                                         0178 00418000
*   ERRADDR=ERRHANSV;               /* RESTORE ERROR & STOP HANDLER  */ 00419000
LOADRETS MVC   ERRADDR(4,COMPTR),ERRHANSV                          0178 00420000
*   STOPEXIT=STPHANSV;              /* ADDRESSES IN COMMON           */ 00421000
         L     @14,STPHANSV                                        0179 00422000
         ST    @14,STOPEXIT(,COMPTR)                               0179 00423000
*   IF CONSTOP=ON THEN              /* IF STOP ENTERED FROM CONSOLE  */ 00424000
         TM    CONSTOP,B'00100000'                                 0180 00425000
         BNO   @RF00180                                            0180 00426000
*     DO;                           /* THEN-                         */ 00427000
*       R15=STOPEXIT;               /* GIVE CONTROL TO               */ 00428000
         LR    R15,@14                                             0182 00429000
*       GOTO STOPHAND;              /* THE CURRENT PRDMP STOP        */ 00430000
         BR    R15                                                 0183 00431000
*     END;                          /* HANDLER                       */ 00432000
*   RETURN;                         /* OTHERWISE- RETURN TO CALLER   */ 00433000
         B     @EL00001                                            0185 00434000
*                                                                  0186 00435000
*   /*****************************************************************/ 00436000
*   /*                                                               */ 00437000
*   /* EXIT VERB HANDLER                                             */ 00438000
*   /*                                                               */ 00439000
*   /*****************************************************************/ 00440000
*                                                                  0186 00441000
*VRBEXIT:                                                          0186 00442000
*   EXITVERB=BLANKS;                /* BLANK VERB SAVE AREA          */ 00443000
VRBEXIT  MVC   EXITVERB(8),BLANKS(COMPTR)                          0186 00444000
*   VERBLEN=VERBEND-VERBGN;         /* DETERMINE LENGTH OF VERB      */ 00445000
         L     @14,VERBGN(,COMPTR)                                 0187 00446000
         L     VERBLEN,VERBEND(,COMPTR)                            0187 00447000
         SLR   VERBLEN,@14                                         0187 00448000
*   EXITVERB(1:VERBLEN)=VERBMAP;    /* MOVE COPY OF VERB TO SAVE AREA*/ 00449000
*                                                                  0188 00450000
         LR    @10,VERBLEN                                         0188 00451000
         BCTR  @10,0                                               0188 00452000
         EX    @10,@SM00575                                        0188 00453000
*   /*****************************************************************/ 00454000
*   /*                                                               */ 00455000
*   /* SCAN ECT FOR A MATCH ON VERB SPECIFIED. ONLY FIRST MATCH IS   */ 00456000
*   /* USED. DUPLICATE ECT ENTRIES FOR SAME VERB ARE IGNORED. IF NO  */ 00457000
*   /* MATCH IS FOUND, VERB SPECIFIED IS INVALID AND MSG 165I ISSUED.*/ 00458000
*   /*                                                               */ 00459000
*   /*****************************************************************/ 00460000
*                                                                  0189 00461000
*FMTVBSRH:                                                         0189 00462000
*   DO NTRYCT=1 TO ECTNUM WHILE     /* INDEX THROUGH ECT UNTIL MATCH */ 00463000
*         (ECTVERB^=EXITVERB);      /* IS FOUND                      */ 00464000
FMTVBSRH LA    NTRYCT,1                                            0189 00465000
         B     @DE00189                                            0189 00466000
@DL00189 CLC   ECTVERB(8,ECTABPTR),EXITVERB                        0189 00467000
         BE    @DC00189                                            0189 00468000
*     ECTABPTR=ECTADDR+NTRYCT*NTRYSIZE;/* INCR TABLE PTR TO NEXT ECT    00469000
*                                      ENTRY                         */ 00470000
         LR    ECTABPTR,NTRYCT                                     0190 00471000
         MH    ECTABPTR,@CH00212                                   0190 00472000
         AL    ECTABPTR,ECTADDR                                    0190 00473000
*   END FMTVBSRH;                                                  0191 00474000
         AH    NTRYCT,@CH00075                                     0191 00475000
@DE00189 CH    NTRYCT,ECTNUM                                       0191 00476000
         BNH   @DL00189                                            0191 00477000
@DC00189 DS    0H                                                  0192 00478000
*   IF NTRYCT>ECTNUM THEN           /* IF COUNTER EXCEEDS NO. OF ECT */ 00479000
         CH    NTRYCT,ECTNUM                                       0192 00480000
         BNH   @RF00192                                            0192 00481000
*     DO;                           /* ENTRIES THEN MATCH NOT FOUND  */ 00482000
*       MGTBINDX=MGTABPTR+INDX165I; /* ADDRESS 165I PREFIX           */ 00483000
         L     MGTBINDX,MGTABPTR                                   0194 00484000
*       CALL MSGWRITR;              /* ISSUE IT                      */ 00485000
         BAL   @14,MSGWRITR                                        0195 00486000
*       MGTBINDX=MGTABPTR+IND165SA; /* ADDRESS INVLAID VERB          */ 00487000
         LA    MGTBINDX,8                                          0196 00488000
         AL    MGTBINDX,MGTABPTR                                   0196 00489000
*       CALL MSGWRITR;              /* SUFFIX AND ISSUE IT           */ 00490000
         BAL   @14,MSGWRITR                                        0197 00491000
*       GOTO LOADRETS;                                             0198 00492000
         B     LOADRETS                                            0198 00493000
*     END;                                                         0199 00494000
*                                                                  0199 00495000
*   /*****************************************************************/ 00496000
*   /*                                                               */ 00497000
*   /* VERB MATCH FOUND. PREPARE TO INVOKE EXIT MODULE.              */ 00498000
*   /*                                                               */ 00499000
*   /*****************************************************************/ 00500000
*                                                                  0200 00501000
*   ELOADMOD=ECTMOD;                /* FOR LOAD MACRO                */ 00502000
@RF00192 MVC   ELOADMOD(8),ECTMOD(ECTABPTR)                        0200 00503000
*   GENERATE REFS(BRRDINIT) FLOWS(EXTBADLD);                       0201 00504000
         BRREAD INIT                   INITIALIZE FOR THIS DUMP IF      00505000
*                                      THIS VERB IS FIRST CONTRL STMT   00506000
*                                      IN JOBSTEP                       00507000
         LOAD EPLOC=ELOADMOD,ERRET=EXTBADLD    BRING IN EXIT MODULE     00508000
*   AEXITMOD=R0;                    /* SAVE ADDRESS OF EXIT MODULE   */ 00509000
         LR    AEXITMOD,R0                                         0202 00510000
*   IF EXITDLIM=EDLIMCOM THEN       /* IF DELIM FOLLIWING VERB IS A     00511000
*                                      COMMA, THEN NO OPERANDS ARE   */ 00512000
         L     @14,VERBEND(,COMPTR)                                0203 00513000
         CLI   EXITDLIM(@14),C','                                  0203 00514000
         BNE   @RF00203                                            0203 00515000
*     PRDMPEXT=0;                   /* PRESENT- INDICATE SUCH        */ 00516000
         SLR   @14,@14                                             0204 00517000
         ST    @14,PRDMPEXT                                        0204 00518000
*   ELSE                                                           0205 00519000
*     DO;                           /* OPERANDS MAY BE PRESENT       */ 00520000
         B     @RC00203                                            0205 00521000
@RF00203 DS    0H                                                  0206 00522000
*       OPRNDLEN=ADDR(WTORMSG)+70-VERBEND;/* COMPUTE LEN-1 FOR     0206 00523000
*                                      TRANSLATE AND TEST WITH EX    */ 00524000
         LA    OPRNDLEN,WTORMSG(,COMPTR)                           0206 00525000
         AH    OPRNDLEN,@CH00525                                   0206 00526000
         L     @14,VERBEND(,COMPTR)                                0206 00527000
         SLR   OPRNDLEN,@14                                        0206 00528000
*       IF OPRNDLEN>=0 THEN         /* INSURE THAT VERB DOES NOT END    00529000
*                                      IN COLUMN 71                  */ 00530000
         LTR   OPRNDLEN,OPRNDLEN                                   0207 00531000
         BM    @RF00207                                            0207 00532000
*         DO;                       /* IT DOESNT- CHECK FOR OPERANDS */ 00533000
*           R1=OPRNDLEN;            /* SET UP FOR EXECUTE: LENGTH    */ 00534000
         LR    R1,OPRNDLEN                                         0209 00535000
*           R3=VERBEND;             /* TARGET ADDRESS                */ 00536000
         LR    R3,@14                                              0210 00537000
*           GENERATE REFS(TRANSLT);                                0211 00538000
         EX    R1,TRANSLT              ARE THERE ANY OPERANDS           00539000
*           BC(8,NOPERAND);         /* WAS AN OPERAND FOUND?         */ 00540000
*                                                                  0212 00541000
         BC    8,NOPERAND                                          0212 00542000
*           /*********************************************************/ 00543000
*           /*                                                       */ 00544000
*           /* OPERAND FOUND, PLACE ADDRESS OF OPERAND IN PRDMP PLIST*/ 00545000
*           /* EXTENS                                                */ 00546000
*           /*                                                       */ 00547000
*           /*********************************************************/ 00548000
*                                                                  0213 00549000
*           PRDMPEXT=R1;            /* PLIST EXTENSION FOR EXIT      */ 00550000
         ST    R1,PRDMPEXT                                         0213 00551000
*         END;                                                     0214 00552000
*       ELSE                                                       0215 00553000
*NOPERAND:                                                         0215 00554000
*         PRDMPEXT=0;               /* INDICATE NO OPERANDS          */ 00555000
         B     @RC00207                                            0215 00556000
@RF00207 DS    0H                                                  0215 00557000
NOPERAND SLR   @14,@14                                             0215 00558000
         ST    @14,PRDMPEXT                                        0215 00559000
*     END;                                                         0216 00560000
*                                                                  0216 00561000
@RC00207 DS    0H                                                  0217 00562000
*   /*****************************************************************/ 00563000
*   /*                                                               */ 00564000
*   /* THE FOLLOWING GENERATED DATA IS THE TARGET OF THE ABOVE EX INS*/ 00565000
*   /*                                                               */ 00566000
*   /*****************************************************************/ 00567000
*                                                                  0217 00568000
*   GENERATE DATA REFS(NONBLNK,R3) DEFS(TRANSLT);                  0217 00569000
*                                                                  0217 00570000
@RC00203 DS    0H                                                  0217 00571000
*   /*****************************************************************/ 00572000
*   /*                                                               */ 00573000
*   /* RESTORE FIXED PART OF EXIT PARM LIST IN CASE MODIFIED BY      */ 00574000
*   /* PREVIOUS EXIT MOD                                             */ 00575000
*   /*                                                               */ 00576000
*   /*****************************************************************/ 00577000
*                                                                  0218 00578000
*   EXITPLST=PLSTCOPY;                                             0218 00579000
*                                                                  0218 00580000
         MVC   EXITPLST(56),PLSTCOPY                               0218 00581000
*   /*****************************************************************/ 00582000
*   /*                                                               */ 00583000
*   /* ALSO, SET UP VARIABLE PART OF PLIST AND INITIALIZE OUTPUT     */ 00584000
*   /* BUFFER                                                        */ 00585000
*   /*                                                               */ 00586000
*   /*****************************************************************/ 00587000
*                                                                  0219 00588000
*   ADPLCVT=CVTADDR;                /* SET CVT ADDR IN PLIST IN CASE    00589000
*                                      CVT= WAS ENTERED SINCE LAST 0219 00590000
*                                      CALL OF UIM                   */ 00591000
         L     @14,ABDPLPTR                                        0219 00592000
         MVC   ADPLCVT(4,@14),CVTADDR(COMPTR)                      0219 00593000
*   EIBUFFER='';                    /* BLANK OUTPUT BUFFER           */ 00594000
         MVI   EIBUFFER,C' '                                       0220 00595000
         MVC   EIBUFFER+1(121),EIBUFFER                            0220 00596000
*   ADPLTCB=0;                      /* ZERO TCB FIELD OF PLIST FOR 0221 00597000
*                                      VERB EXIT                     */ 00598000
         SLR   @10,@10                                             0221 00599000
         ST    @10,ADPLTCB(,@14)                                   0221 00600000
*   ADPLASID=QASID;                 /* SET CURRENT ASID IN ASID FIELD*/ 00601000
*                                                                  0222 00602000
         MVC   ADPLASID(2,@14),QASID(COMPTR)                       0222 00603000
*   /*****************************************************************/ 00604000
*   /*                                                               */ 00605000
*   /* IF PRDMP IS IN FLUSHMODE PROCESSING, ONLY GIVE EXIT MODULE    */ 00606000
*   /* CONTROL IF HIS VERB HAS OPERNADS, AND THEN, ALLOW HIM ONLY TO */ 00607000
*   /* SYNTAX CHECK OPERANDS BY TURNING ON USTOPSW. THIS WILL PREVENT*/ 00608000
*   /* HIM FROM READING THE DUMP AND WRITING OUTPUT.                 */ 00609000
*   /*                                                               */ 00610000
*   /*****************************************************************/ 00611000
*                                                                  0223 00612000
*   IF FLSHMODE=ON THEN             /* SYNTAX CHECKING ONLY?         */ 00613000
         TM    FLSHMODE(COMPTR),B'10000000'                        0223 00614000
         BNO   @RF00223                                            0223 00615000
*     DO;                           /* YES-                          */ 00616000
*       IF PRDMPEXT=0 THEN          /* ARE THERE ANY OPERANDS?       */ 00617000
         C     @10,PRDMPEXT                                        0225 00618000
         BNE   @RF00225                                            0225 00619000
*         DO;                       /* NO-                           */ 00620000
*           GEN(DELETE EPLOC=ELOADMOD);/* NOTHING TO SYNTAX CHECK    */ 00621000
         DELETE EPLOC=ELOADMOD                                          00622000
*           GOTO LOADRETS;          /* TERMINATE THIS PASS OF UIM    */ 00623000
         B     LOADRETS                                            0228 00624000
*         END;                                                     0229 00625000
*       ELSE                        /* OPERANDS ARE PRESENT- LET EXIT   00626000
*                                      MODULE SYNTAX                 */ 00627000
*         USTOPSW=ON;               /* CHECK ONLY                    */ 00628000
@RF00225 OI    USTOPSW,B'01000000'                                 0230 00629000
*     END;                                                         0231 00630000
*   ELSE                            /* PRDMP IS NOT IN FLUSHMODE     */ 00631000
*     GEN(BRWRITE SKIP);            /* EXIT MODULE GETS FULL FUNCTION   00632000
*                                      START HIS OUTPUT ON NEW PAGE  */ 00633000
         B     @RC00223                                            0232 00634000
@RF00223 DS    0H                                                  0232 00635000
         BRWRITE SKIP                                                   00636000
*   R1=ADDR(EXITPLST);              /* ADDRESS PARM LIST             */ 00637000
@RC00223 LA    R1,EXITPLST                                         0233 00638000
*   COMPTRSV=COMPTR;                /* SAVE PTR TO COMMON (R12)      */ 00639000
         ST    COMPTR,COMPTRSV                                     0234 00640000
*   IF EXITVERB(1:6)^='CVTMAP' THEN /* OZ09006                       */ 00641000
         CLC   EXITVERB(6),@CC00531                                0235 00642000
         BE    @RF00235                                            0235 00643000
*     COMPTR=0;                     /* ZERO PTR TO COMMON SO EXIT  0236 00644000
*                                      CAN'T TAMPER                  */ 00645000
         SLR   COMPTR,COMPTR                                       0236 00646000
*   CNTRLSW=ON;                     /* INDICATE EXIT IN CONTROL      */ 00647000
@RF00235 OI    CNTRLSW,B'00010000'                                 0237 00648000
*   CALL EXITMOD;                   /* INVOKE EXIT MODULE            */ 00649000
         LR    @15,AEXITMOD                                        0238 00650000
         BALR  @14,@15                                             0238 00651000
*   CNTRLSW=OFF;                    /* RESET- EXIT NOT IN CONTROL    */ 00652000
         NI    CNTRLSW,B'11101111'                                 0239 00653000
*   COMPTR=COMPTRSV;                /* RESTORE PTR TO COMMON         */ 00654000
         L     COMPTR,COMPTRSV                                     0240 00655000
*   EXITRC=R15;                     /* SAVE EXITS RETURN CODE        */ 00656000
         LR    EXITRC,R15                                          0241 00657000
*   GEN(DELETE EPLOC=ELOADMOD);     /* DELETE EXIT MODULE            */ 00658000
         DELETE EPLOC=ELOADMOD                                          00659000
*   CURENSAV=R13;                   /* SET UP FOR ERROR & STOP RTNS  */ 00660000
*                                                                  0243 00661000
         ST    R13,CURENSAV                                        0243 00662000
*   /*****************************************************************/ 00663000
*   /*                                                               */ 00664000
*   /* CHECK EXIT MODULES RETURN CODE IF RC = 4, HE WAS UNABLE TO    */ 00665000
*   /* OBTAIN STORAGE (GETMAIN) FOR NORMAL PROCESSING                */ 00666000
*   /*                                                               */ 00667000
*   /*****************************************************************/ 00668000
*                                                                  0244 00669000
*   IF EXITRC=4 THEN                /* BAD RETURN CODE?              */ 00670000
         CH    EXITRC,@CH00155                                     0244 00671000
         BNE   @RF00244                                            0244 00672000
*     DO;                           /* YES-                          */ 00673000
*       COMMODNM=ECTMOD;            /* MOVE THIS ECT ENTRYS MODULE 0246 00674000
*                                      NAME TO OUTPUT COMMENT TEXT   */ 00675000
         MVC   COMMODNM(8),ECTMOD(ECTABPTR)                        0246 00676000
*       CURBUFER(1:LENGTH(EXSTORCM))=EXSTORCM;/* MOVE TO CURRENT     */ 00677000
         L     @14,CURBUF(,COMPTR)                                 0247 00678000
         MVC   CURBUFER+1(58,@14),EXSTORCM                         0247 00679000
*       GEN(BRWRITE 1);             /* OUTPUT BUFFER & WRITE OUTPUT  */ 00680000
         BRWRITE 1                                                      00681000
*     END;                          /* COMMENT                       */ 00682000
*                                                                  0249 00683000
*   /*****************************************************************/ 00684000
*   /*                                                               */ 00685000
*   /* CHECK WHETHER VERB EXIT MODULE HAS DETECTED A SYNTAX ERROR IN */ 00686000
*   /* ITS OPERAND LIST. A CODE WILL BE PLACED IN THE PRDMP PLIST    */ 00687000
*   /* EXTENSION BY THE EXIT MODULE INDICATING THE APPROPRIATE SYNTAX*/ 00688000
*   /* MSG, IF ANY, TO BE ISSUED BY UIM. THE FOLLOWING TABLE         */ 00689000
*   /* DESCRIBES THE PROCESSING: RETURN CODE SUFFIX TO MSG AMD165I   */ 00690000
*   /* THAT IS TO BE ISSUED 4 'DELIMETER ERROR IN OPERAND FIELD OF   */ 00691000
*   /* 'VERB'' 8 'INVALID KEYWORD IN OPERAND FIELD OF 'VERB'' 12     */ 00692000
*   /* 'SYNTAX ERROR IN OPERAND FIELD OF 'VERB'' OTHER MESSAGE NOT   */ 00693000
*   /* ISSUED                                                        */ 00694000
*   /*                                                               */ 00695000
*   /*****************************************************************/ 00696000
*                                                                  0250 00697000
*   IF PRDMPEXT=4 THEN              /* IF SYNTAX RETURN CODE IS 4    */ 00698000
@RF00244 CLC   PRDMPEXT(4),@CF00155                                0250 00699000
         BNE   @RF00250                                            0250 00700000
*     DO;                           /* ISSUE AMD165I WITH DELIMETER  */ 00701000
*       MGTBINDX=MGTABPTR+INDX165I; /* ERROR SUFFIX- ALSO WTO        */ 00702000
         L     MGTBINDX,MGTABPTR                                   0252 00703000
*       CALL MSGWRITR;              /* IF INPUT FROM CONSOLE         */ 00704000
         BAL   @14,MSGWRITR                                        0253 00705000
*       MGTBINDX=MGTABPTR+IND165SB;                                0254 00706000
         LA    MGTBINDX,16                                         0254 00707000
         AL    MGTBINDX,MGTABPTR                                   0254 00708000
*       RFY                                                        0255 00709000
*         MSGVRBNM BASED(MSGADDR+D65BVRBN);                        0255 00710000
*       MSGVRBNM=ECTVERB;                                          0256 00711000
         L     @14,MSGADDR(,MGTBINDX)                              0256 00712000
         MVC   MSGVRBNM+44(8,@14),ECTVERB(ECTABPTR)                0256 00713000
*       CALL MSGWRITR;                                             0257 00714000
         BAL   @14,MSGWRITR                                        0257 00715000
*     END;                                                         0258 00716000
*   IF PRDMPEXT=8 THEN              /* IF SYNTAX RETURN CODE IS 8    */ 00717000
@RF00250 CLC   PRDMPEXT(4),@CF00042                                0259 00718000
         BNE   @RF00259                                            0259 00719000
*     DO;                           /* ISSUE AMD165I WITH INVALID    */ 00720000
*       MGTBINDX=MGTABPTR+INDX165I; /* KEYWORD SUFFIX- ALSO WTO      */ 00721000
         L     MGTBINDX,MGTABPTR                                   0261 00722000
*       CALL MSGWRITR;              /* IF INPUT IS FROM CONSOLE      */ 00723000
         BAL   @14,MSGWRITR                                        0262 00724000
*       MGTBINDX=MGTABPTR+IND165SC;                                0263 00725000
         LA    MGTBINDX,24                                         0263 00726000
         AL    MGTBINDX,MGTABPTR                                   0263 00727000
*       RFY                                                        0264 00728000
*         MSGVRBNM BASED(MSGADDR+D65CVRBN);                        0264 00729000
*       MSGVRBNM=ECTVERB;                                          0265 00730000
         L     @14,MSGADDR(,MGTBINDX)                              0265 00731000
         MVC   MSGVRBNM+44(8,@14),ECTVERB(ECTABPTR)                0265 00732000
*       CALL MSGWRITR;                                             0266 00733000
         BAL   @14,MSGWRITR                                        0266 00734000
*     END;                                                         0267 00735000
*   IF PRDMPEXT=12 THEN             /* IF SYNTAX RETURN CODE IS 12   */ 00736000
@RF00259 CLC   PRDMPEXT(4),@CF00239                                0268 00737000
         BNE   @RF00268                                            0268 00738000
*     DO;                           /* ISSUE AMD165I WITH SYNTAX     */ 00739000
*       MGTBINDX=MGTABPTR+INDX165I; /* ERROR SUFFIX- ALSO WTO        */ 00740000
         L     MGTBINDX,MGTABPTR                                   0270 00741000
*       CALL MSGWRITR;              /* IF INPUT IS FROM CONSOLE      */ 00742000
         BAL   @14,MSGWRITR                                        0271 00743000
*       MGTBINDX=MGTABPTR+IND165SD;                                0272 00744000
         LA    MGTBINDX,32                                         0272 00745000
         AL    MGTBINDX,MGTABPTR                                   0272 00746000
*       RFY                                                        0273 00747000
*         MSGVRBNM BASED(MSGADDR+D65DVRBN);                        0273 00748000
*       MSGVRBNM=ECTVERB;                                          0274 00749000
         L     @14,MSGADDR(,MGTBINDX)                              0274 00750000
         MVC   MSGVRBNM+41(8,@14),ECTVERB(ECTABPTR)                0274 00751000
*       CALL MSGWRITR;                                             0275 00752000
         BAL   @14,MSGWRITR                                        0275 00753000
*     END;                                                         0276 00754000
*                                                                  0276 00755000
*   /*****************************************************************/ 00756000
*   /*                                                               */ 00757000
*   /* DETERMINE WHETHER THIS VERB EXIT MODULE PRINTED ANY OUTPUT IN */ 00758000
*   /* THE CASE WHERE HE WAS NOT RESTRICTED BY UIM FROM DOING SO-    */ 00759000
*   /* I.E. USTOPSW WAS OFF. IF WE ALLOWED HIM TO PRINT AND HE       */ 00760000
*   /* PRODUCED NO OUTPUT, TELL HIM ABOUT IT.                        */ 00761000
*   /*                                                               */ 00762000
*   /*****************************************************************/ 00763000
*                                                                  0277 00764000
*   IF USTOPSW=OFF&PRNTSW=OFF THEN  /* ANY OUTPUT WHEN ALLOWED       */ 00765000
@RF00268 TM    USTOPSW,B'01001000'                                 0277 00766000
         BNZ   @RF00277                                            0277 00767000
*     DO;                           /* NO- HE MAY HAVE A PROBLEM     */ 00768000
*       MGTBINDX=MGTABPTR+INDX288I; /* MOVE VERB NAME TO TEXT OF     */ 00769000
         LA    MGTBINDX,56                                         0279 00770000
         AL    MGTBINDX,MGTABPTR                                   0279 00771000
*       RFY                                                        0280 00772000
*         MSGVRBNM BASED(MSGADDR+D288VRBN);/* AMD288I AND ISSUE      */ 00773000
*       MSGVRBNM=ECTVERB;                                          0281 00774000
         L     @14,MSGADDR(,MGTBINDX)                              0281 00775000
         MVC   MSGVRBNM+30(8,@14),ECTVERB(ECTABPTR)                0281 00776000
*       CALL MSGWRITR;                                             0282 00777000
         BAL   @14,MSGWRITR                                        0282 00778000
*     END;                                                         0283 00779000
*   GOTO LOADRETS;                  /* PROCESSING COMPLETE FOR THIS     00780000
*                                      PASS OF UIM.                  */ 00781000
         B     LOADRETS                                            0284 00782000
*                                                                  0285 00783000
*   /*****************************************************************/ 00784000
*   /*                                                               */ 00785000
*   /* AMDUSRXTS LOAD FAIL HANDLER THIS ROUTINE GETS CONTROL WHENEVER*/ 00786000
*   /* AN EXIT MODULE FROM THE EXIT CONTROL TABLE CANNOT BE LOADED.  */ 00787000
*   /* THIS ROUTINE IS USED IN LOAD FAILS FOR BOTH FORMAT AND VERB   */ 00788000
*   /* EXITS. MESSAGE AMD287I IS ISSUED. FOR VERB EXITS, PROCESSING  */ 00789000
*   /* TERMINATES FOR THIS PASS OF AMDPRUIM. FOR NON-VERB EXITS, THE */ 00790000
*   /* EXIT FLAG FIELD IN THE ECT IN-CORE COPY IS SET TO ZERO SUCH   */ 00791000
*   /* THAT FURTHER ATTEMPTS TO LOAD THIS MODULE WILL NOT BE MADE    */ 00792000
*   /* DURING THIS EXEC- UTION OF AMDPRDMP. THIS IS DONE TO ELIMINATE*/ 00793000
*   /* ISSUANCE OF AMD287I MANY TIMES- IE FOR EACH TCB THAT IS       */ 00794000
*   /* PROCESSED BY AMDPRDMP.                                        */ 00795000
*   /*                                                               */ 00796000
*   /*****************************************************************/ 00797000
*                                                                  0285 00798000
*EXTBADLD:                                                         0285 00799000
*   LOADCSAV=R1;                    /* SAVE COMPLETION AND RETURN    */ 00800000
EXTBADLD STH   R1,LOADCSAV                                         0285 00801000
*   LOADRSAV=R15;                   /* CODE FROM LOAD                */ 00802000
         STC   R15,LOADRSAV                                        0286 00803000
*   MGTBINDX=MGTABPTR+INDX287I;     /* ADDRESS MSG AMD287I AND       */ 00804000
         LA    MGTBINDX,48                                         0287 00805000
         AL    MGTBINDX,MGTABPTR                                   0287 00806000
*   RFY                                                            0288 00807000
*     MSGMODNM BASED(MSGADDR+D287MODN);/* ITS MODULE NAME FIELD      */ 00808000
*   MSGMODNM=ECTMOD;                /* MOVE MODULE NAME TO MSG TEXT  */ 00809000
         L     @14,MSGADDR(,MGTBINDX)                              0289 00810000
         MVC   MSGMODNM+36(8,@14),ECTMOD(ECTABPTR)                 0289 00811000
*   RFY                                                            0290 00812000
*     MSGCOMPC BASED(MSGADDR+D287COMP);/* ADDRESS COMPL CODE FIELD   */ 00813000
*   R2=ADDR(MSGCOMPC);              /* SET UP PARAMETERS TO          */ 00814000
         AH    @14,@CH00435                                        0291 00815000
         LR    R2,@14                                              0291 00816000
*   R3=ADDR(LOADCSAV);              /* HEX CONVERT INLINE MACRO      */ 00817000
         LA    R3,LOADCSAV                                         0292 00818000
*   GEN(HEXCNVT (2),(3),2);         /* CONVERT COMPL CODE TO PRINT-     00819000
*                                      ABLE HEX                      */ 00820000
         HEXCNVT (2),(3),2                                              00821000
*   RFY                                                            0294 00822000
*     MSGRETCD BASED(MSGADDR+D287RETC);/* ADDRESS RET CODE FIELD     */ 00823000
*   R2=ADDR(MSGRETCD);              /* SET UP PARAMETERS TO          */ 00824000
         LA    R2,50                                               0295 00825000
         AL    R2,MSGADDR(,MGTBINDX)                               0295 00826000
*   R3=ADDR(LOADRSAV);              /* HEX CONVERT INLINE MACRO      */ 00827000
         LA    R3,LOADRSAV                                         0296 00828000
*   GEN(HEXCNVT (2),(3),1);         /* CONVERT RET CODE TO PRINTABLE    00829000
*                                      HEX                           */ 00830000
         HEXCNVT (2),(3),1                                              00831000
*   CALL MSGWRITR;                  /* WRITE IT                      */ 00832000
*                                                                  0298 00833000
         BAL   @14,MSGWRITR                                        0298 00834000
*   /*****************************************************************/ 00835000
*   /*                                                               */ 00836000
*   /* IF PROCESSING A VERB, TERMINATE THIS PASS OF UIM. IF FORMAT   */ 00837000
*   /* EXIT, ZERO ECT ENTRY FLAGS FIELD SO WONT TRY TO LOAD IT AGAIN */ 00838000
*   /*                                                               */ 00839000
*   /*****************************************************************/ 00840000
*                                                                  0299 00841000
*   IF EXITFLAG=ZVERB THEN          /* IF VERB EXIT,                 */ 00842000
         CLI   EXITFLAG(COMPTR),X'00'                              0299 00843000
         BE    @RT00299                                            0299 00844000
*     GOTO LOADRETS;                /* TERMINATE THIS PASS           */ 00845000
*   ECTFLAG=0;                      /* DONT ALLOW THIS MOD TO BE   0301 00846000
*                                      LOADED AGAIN THIS JOBSTEP     */ 00847000
         MVI   ECTFLAG(ECTABPTR),X'00'                             0301 00848000
*   GOTO FMTSRCHC;                  /* CONTINUE SEARCH OF ECT        */ 00849000
         B     FMTSRCHC                                            0302 00850000
*                                                                  0303 00851000
*   /*****************************************************************/ 00852000
*   /*                                                               */ 00853000
*   /* AMDMEMAR- MEMORY ACCESS ROUTINE INTERFACES WITH AMDPRDMP TO   */ 00854000
*   /* RETRIEVE DUMP DATA FOR EXIT MODULES                           */ 00855000
*   /*                                                               */ 00856000
*   /*****************************************************************/ 00857000
*                                                                  0303 00858000
*AMDMEMAR:                                                         0303 00859000
*   GENERATE REFS(MARSAVE);                                        0303 00860000
*                                                                  0303 00861000
AMDMEMAR DS    0H                                                  0303 00862000
         USING *,R15                                                    00863000
         STM   R14,R12,12(R13)                                          00864000
         L     BASE1,MARBASRG                                           00865000
         DROP  R15                                                      00866000
         ST    R13,MARSAVE+4                                            00867000
         LA    R14,MARSAVE                                              00868000
         ST    R14,8(R13)                                               00869000
         LR    R13,R14                                                  00870000
         B     MAR                                                      00871000
MARBASRG DC    A(@PSTART)                                               00872000
*   /*****************************************************************/ 00873000
*   /*                                                               */ 00874000
*   /* ***NOTE*** CARE MUST BE TAKEN TO INSURE THAT NO VARIABLE      */ 00875000
*   /* REFERENCED HERE AND IN UIM MAINLINE BOTH, ARE EVER ASSIGNED TO*/ 00876000
*   /* REGISTERS DUE TO THE INTERVENING EXIT MODULE AND SAVE AREA    */ 00877000
*   /* LINKAGES BETWEEN UIM MAINLINE AND THIS ROUTINE.               */ 00878000
*   /*                                                               */ 00879000
*   /*****************************************************************/ 00880000
*                                                                  0304 00881000
*MAR:                                                              0304 00882000
*   CURENSAV=R13;                   /* SET UP FOR BRREAD ERROR RTN   */ 00883000
MAR      ST    R13,CURENSAV                                        0304 00884000
*   COMPTR=COMPTRSV;                /* RESTORE PTR TO COMMON         */ 00885000
         L     COMPTR,COMPTRSV                                     0305 00886000
*   IF USTOPSW=ON THEN              /* IF IN STOP PROCESSING         */ 00887000
         TM    USTOPSW,B'01000000'                                 0306 00888000
         BNO   @RF00306                                            0306 00889000
*RDERRET:                           /* THEN DO NOT SATISFY           */ 00890000
*     R15=4;                        /* READ REQUEST                  */ 00891000
RDERRET  LA    R15,4                                               0307 00892000
*   ELSE                            /* OTHERWISE-                    */ 00893000
*     DO;                                                          0308 00894000
         B     @RC00306                                            0308 00895000
@RF00306 DS    0H                                                  0309 00896000
*       R2=R1->ADPLASID;            /* GET REQUESTED ASID            */ 00897000
         LH    R2,ADPLASID(,R1)                                    0309 00898000
*       GENERATE REFS(BRRDDATA) FLOWS(UIMBRDER);                   0310 00899000
      BRREAD (R0),DATA,ASID=(R2)       READ FOR REQUESTED DATA          00900000
*       R0=R1;                      /* MOVE DATA ADDRESS TO REG 0    */ 00901000
         LR    R0,R1                                               0311 00902000
*       R15=0;                      /* FOR RETURN TO CALLER INDICATE    00903000
*                                      READ WAS SUCCESSFUL           */ 00904000
         SLR   R15,R15                                             0312 00905000
*     END;                                                         0313 00906000
*   GENERATE FLOWS(EXITMOD) NOSEQFLOW;                             0314 00907000
@RC00306 DS    0H                                                  0314 00908000
         L     R13,4(R13)                                               00909000
         L     R14,12(R13)                                              00910000
         LM    R1,R12,24(R13)                                           00911000
         BR    R14                                                      00912000
*                                                                  0315 00913000
*   /*****************************************************************/ 00914000
*   /*                                                               */ 00915000
*   /* UIMBRDER- EXIT INTERFACE BRREAD ERROR HANDLER ENTERED WHEN    */ 00916000
*   /* BRREAD DATA FOR AN EXIT MODULE FAILS OR WHEN AMDPRUIM ITSELF  */ 00917000
*   /* ISSUES BRREAD INIT THAT FAILS                                 */ 00918000
*   /*                                                               */ 00919000
*   /*****************************************************************/ 00920000
*                                                                  0315 00921000
*UIMBRDER:                                                         0315 00922000
*   GENERATE REFS(CURENSAV);                                       0315 00923000
UIMBRDER DS    0H                                                  0315 00924000
         USING *,R15                                                    00925000
         L     R13,CURENSAV                                             00926000
         LM    R14,R12,12(R13)                                          00927000
         DROP  R15                                                      00928000
*   IF CNTRLSW=ON THEN              /* IF EXIT MODULE WAS IN CONTROL */ 00929000
         TM    CNTRLSW,B'00010000'                                 0316 00930000
         BO    @RT00316                                            0316 00931000
*     GOTO RDERRET;                 /* THEN BRREAD DATA FAILED.    0317 00932000
*                                      RETURN HIM A CODE OF 4        */ 00933000
*                                                                  0317 00934000
*   /*****************************************************************/ 00935000
*   /*                                                               */ 00936000
*   /* BRREAD INIT ISSUED BY UIM FAILED- RESTORE ERROR & STOP HANDLER*/ 00937000
*   /* ADDRESSES IN COMMON THEN PASS CONTROL TO MAIN ERROR HANDLER IN*/ 00938000
*   /* CTL TO HANDLE INIT ERROR.                                     */ 00939000
*   /*                                                               */ 00940000
*   /*****************************************************************/ 00941000
*                                                                  0318 00942000
*   ERRADDR=ERRHANSV;               /* RESTORE COMMON- ERROR HANDLER */ 00943000
         L     @14,ERRHANSV                                        0318 00944000
         ST    @14,ERRADDR(,COMPTR)                                0318 00945000
*   STOPEXIT=STPHANSV;              /* AND STOP HANDLER ADDRESSES    */ 00946000
         MVC   STOPEXIT(4,COMPTR),STPHANSV                         0319 00947000
*   R15=ERRADDR;                    /* AND GO TO PRDMP               */ 00948000
         LR    R15,@14                                             0320 00949000
*   GOTO ERRHAND;                   /* MAIN ERROR HANDLER            */ 00950000
         BR    R15                                                 0321 00951000
*                                                                  0322 00952000
*   /*****************************************************************/ 00953000
*   /*                                                               */ 00954000
*   /* AMDWRITR- EXIT WRITE INTERFACE ROUTINE INTERFACES WITH        */ 00955000
*   /* AMDPRDMP TO WRITE OUTPUT FOR EXIT MODULES                     */ 00956000
*   /*                                                               */ 00957000
*   /*****************************************************************/ 00958000
*                                                                  0322 00959000
*AMDWRITR:                                                         0322 00960000
*   GENERATE REFS(WIRSAVE);                                        0322 00961000
*                                                                  0322 00962000
AMDWRITR DS    0H                                                  0322 00963000
         USING *,R15                                                    00964000
         STM   R14,R12,12(R13)                                          00965000
         L     BASE1,WIRBASRG                                           00966000
         DROP  R15                                                      00967000
         ST    R13,WIRSAVE+4                                            00968000
         LA    R14,WIRSAVE                                              00969000
         ST    R14,8(R13)                                               00970000
         LR    R13,R14                                                  00971000
         B     WIR                                                      00972000
WIRBASRG DC    A(@PSTART)                                               00973000
*   /*****************************************************************/ 00974000
*   /*                                                               */ 00975000
*   /* ***NOTE*** CARE MUST BE TAKEN TO INSURE THAT NO VARIABLE      */ 00976000
*   /* REFERENCED HERE AND IN UIM MAINLINE BOTH, ARE EVER ASSIGNED TO*/ 00977000
*   /* REGISTERS DUE TO THE INTERVENING EXIT MODULE AND SAVE AREA    */ 00978000
*   /* LINKAGES BETWEEN UIM MAINLINE AND THIS ROUTINE.               */ 00979000
*   /*                                                               */ 00980000
*   /*****************************************************************/ 00981000
*                                                                  0323 00982000
*WIR:                                                              0323 00983000
*   CURENSAV=R13;                   /* SET UP FOR BRWRITE STOP RTN.  */ 00984000
WIR      ST    R13,CURENSAV                                        0323 00985000
*   COMPTR=COMPTRSV;                /* RESTORE PTR TO COMMON         */ 00986000
         L     COMPTR,COMPTRSV                                     0324 00987000
*   IF USTOPSW=OFF THEN             /* IF NOT IN STOP PROCESSING,    */ 00988000
         TM    USTOPSW,B'01000000'                                 0325 00989000
         BNZ   @RF00325                                            0325 00990000
*     DO;                           /* THEN WRITE EXITS OUTPUT.      */ 00991000
*       CURBUFER(1:120)=EIOUTBUF;   /* MOVE EXITS OUTPUT BUFFER    0327 00992000
*                                      CONTENTS TO CURBUF + 1        */ 00993000
         L     @14,CURBUF(,COMPTR)                                 0327 00994000
         MVC   CURBUFER+1(120,@14),EIOUTBUF                        0327 00995000
*       GEN(BRWRITE 1)              /* WRITE IT                      */ 00996000
*       FLOWS(UIMSTOP);                                            0328 00997000
         BRWRITE 1                                                      00998000
*       PRNTSW=ON;                  /* INDICATE THAT EXIT WROTE AT 0329 00999000
*                                      LEASt 1 LINE OF OUTPUT        */ 01000000
         OI    PRNTSW,B'00001000'                                  0329 01001000
*     END;                                                         0330 01002000
*WIRTERM:                                                          0331 01003000
*   EIBUFFER='';                    /* BLANK OUTPUT BUFFER           */ 01004000
@RF00325 DS    0H                                                  0331 01005000
WIRTERM  MVI   EIBUFFER,C' '                                       0331 01006000
         MVC   EIBUFFER+1(121),EIBUFFER                            0331 01007000
*   GENERATE FLOWS(EXITMOD) NOSEQFLOW;                             0332 01008000
         L     R13,4(R13)                                               01009000
         LM    R14,R12,12(R13)                                          01010000
         BR    R14                                                      01011000
*                                                                  0333 01012000
*   /*****************************************************************/ 01013000
*   /*                                                               */ 01014000
*   /* UIMSTOP- EXIT INTERFACE STOP HANDLER GETS CONTROL WHEN BRWRITE*/ 01015000
*   /* ISSUED BY UIM FOR ITSELF, OR FOR AN EXIT MODULE THROUGH       */ 01016000
*   /* AMDWRITR, DETECTS STOP ENTERED AT SYSTEM CONSOLE.             */ 01017000
*   /*                                                               */ 01018000
*   /*****************************************************************/ 01019000
*                                                                  0333 01020000
*UIMSTOP:                                                          0333 01021000
*   GENERATE REFS(CURENSAV);                                       0333 01022000
UIMSTOP  DS    0H                                                  0333 01023000
         USING *,R15                                                    01024000
         L     R13,CURENSAV                                             01025000
         LM    R14,R12,12(R13)                                          01026000
         DROP  R15                                                      01027000
*   CONSTOP=ON;                     /* INDICATE STOP ENTERED FROM  0334 01028000
*                                      CONSOLE                       */ 01029000
*   USTOPSW=ON;                     /* PUT UIM IN STOP MODE          */ 01030000
         OI    CONSTOP,B'01100000'                                 0335 01031000
*   IF CNTRLSW=ON THEN              /* IF WE ISSUED THE BRWRITE ON 0336 01032000
*                                      BEHALF OF AN EXIT MODULE THAT    01033000
*                                      IS IN CONTROL, THEN           */ 01034000
         TM    CNTRLSW,B'00010000'                                 0336 01035000
         BO    @RT00336                                            0336 01036000
*     GOTO WIRTERM;                 /* CONTINUE IN AMDWRITR OTHERWISE   01037000
*                                      UIM ISSUED IT ON              */ 01038000
*   ELSE                            /* ITS OWN BEHALF, THEREFORE-    */ 01039000
*     GEN(DELETE EPLOC=ELOADMOD);   /* INSURE THAT EXIT MODULE IS  0338 01040000
*                                      DELETED BEFORE                */ 01041000
         DELETE EPLOC=ELOADMOD                                          01042000
*   GOTO LOADRETS;                  /* TERMINATE THIS PASS OF UIM    */ 01043000
         B     LOADRETS                                            0339 01044000
*                                                                  0340 01045000
*   /*****************************************************************/ 01046000
*   /*                                                               */ 01047000
*   /* THE FOLLOWING SUBROUTINE WRITES AMDPRUIMS MESSAGES TO THE     */ 01048000
*   /* SYSPRINT DATA SET VIA THE BRPRTMSG AMDPRDMP MACRO CALL. IF    */ 01049000
*   /* INPUT IS FROM THE OPERATORS CONSOLE, THE MESSAGE IS ALSO      */ 01050000
*   /* WRITTEN TO THE OPERATOR. THE ADDRESS AND LENGTH OF THE MSG TO */ 01051000
*   /* BE PRINTED ARE PASSED TO THIS SUBROUTINE IN MSGADDR AND MSGLEN*/ 01052000
*   /* RESPECTIVELY.                                                 */ 01053000
*   /*                                                               */ 01054000
*   /*****************************************************************/ 01055000
*                                                                  0340 01056000
*MSGWRITR:                                                         0340 01057000
*   PROC;                                                          0340 01058000
MSGWRITR STM   @14,@12,@SA00002                                    0340 01059000
*   R1=MSGADDR;                     /* SET UP PARAMETERS FOR         */ 01060000
         L     R1,MSGADDR(,MGTBINDX)                               0341 01061000
*   R2=MSGLEN;                      /* BRPRTMSG CALL                 */ 01062000
         L     R2,MSGLEN(,MGTBINDX)                                0342 01063000
*   GENERATE REFS(APRTMSG);                                        0343 01064000
    BRPRTMSG (R1),(R2)                 WRITE MSG TO SYSPRINT            01065000
*   IF RDRSW=OFF THEN               /* INPUT FROM CONSOLE?           */ 01066000
         TM    RDRSW(COMPTR),B'00000001'                           0344 01067000
         BNZ   @RF00344                                            0344 01068000
*     DO;                           /* YES-                          */ 01069000
*       R1=R1-4;                    /* INCLUDE ROUTER & DESCRIPTORS  */ 01070000
         SL    R1,@CF00155                                         0346 01071000
*       GEN(WTO MF=(E,(1)));        /* ISSUE WTO                     */ 01072000
         WTO MF=(E,(1))                                                 01073000
*     END;                                                         0348 01074000
*   END MSGWRITR;                   /* RETURN TO CALLER              */ 01075000
@EL00002 DS    0H                                                  0349 01076000
@EF00002 DS    0H                                                  0349 01077000
@ER00002 LM    @14,@12,@SA00002                                    0349 01078000
         BR    @14                                                 0349 01079000
*                                                                  0350 01080000
*   /*****************************************************************/ 01081000
*   /*                                                               */ 01082000
*   /* TERMINATION ENTRY POINT FOR AMDPRDMP EXIT INTERFACE. CALLED   */ 01083000
*   /* ONCE BY AMDPRXIT DURING AMDPRDMP TERMINAL PROCESSING. FUNCTION*/ 01084000
*   /* IS TO DELETE EXIT INTERFACE SECONDARY LOADS- AMDPRECT AND     */ 01085000
*   /* AMDPRFMT IF THE EXIT INTERFACE WAS ACTIVE.                    */ 01086000
*   /*                                                               */ 01087000
*   /*****************************************************************/ 01088000
*                                                                  0350 01089000
*AMDUSRDL:                                                         0350 01090000
*   ENTRY;                                                         0350 01091000
@EP00350 DS    0H                                                  0351 01092000
*   IF FAILSW=OFF THEN              /* WAS EXIT INTERFACE ACTIVE?    */ 01093000
         TM    FAILSW,B'10000000'                                  0351 01094000
         BNZ   @RF00351                                            0351 01095000
*     DO;                           /* YES- PERFORM TERMINAL PROC    */ 01096000
*       GENERATE;                                                  0353 01097000
         DELETE EP=AMDPRECT            DELETE EXIT INTERFACE SECOND-    01098000
         DELETE EP=AMDPRFMT            ARY LOADS                        01099000
*       FAILSW=ON;                  /* RESET INIT FAILED SW- INTER-  */ 01100000
         OI    FAILSW,B'10000000'                                  0354 01101000
*     END;                          /* FACE NO LONGER ACTIVE         */ 01102000
*   END AMDPRUIM                    /* RETURN TO AMDPRXIT            */ 01103000
*                                                                  0356 01104000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 01105000
*/*%INCLUDE SYSLIB  (COMMON  )                                       */ 01106000
*/*%INCLUDE SYSLIB  (IHAABDPL)                                       */ 01107000
*                                                                  0356 01108000
*       ;                                                          0356 01109000
         B     @EL00001                                            0356 01110000
@DATA    DS    0H                                                       01111000
@CH00075 DC    H'1'                                                     01112000
@CH00435 DC    H'45'                                                    01113000
@CH00525 DC    H'70'                                                    01114000
@SM00570 MVC   MSGVRBNM(0,@10),VERBMAP(@14)                             01115000
@SM00575 MVC   EXITVERB(0),VERBMAP(@14)                                 01116000
         DS    0F                                                       01117000
@SA00001 DS    18F                                                      01118000
@SA00002 DS    15F                                                      01119000
         DS    0F                                                       01120000
@CF00155 DC    F'4'                                                     01121000
@CH00155 EQU   @CF00155+2                                               01122000
@CF00042 DC    F'8'                                                     01123000
@CF00239 DC    F'12'                                                    01124000
@CF00212 DC    F'20'                                                    01125000
@CH00212 EQU   @CF00212+2                                               01126000
         DS    0D                                                       01127000
ABDPLPTR DC    AL4(EXITPLST)                                            01128000
ECTADDR  DC    A(0)                                                     01129000
PRDMPEXT DC    A(0)                                                     01130000
MGTABPTR DC    AL4(AMDUIMMG)                                            01131000
ERRHANSV DC    A(0)                                                     01132000
STPHANSV DC    A(0)                                                     01133000
CURENSAV DC    A(0)                                                     01134000
COMPTRSV DC    A(0)                                                     01135000
LOADCSAV DS    H                                                        01136000
ECTNUM   DC    H'0'                                                     01137000
LOADRSAV DS    FL1                                                      01138000
@TS00001 DS    CL1                                                      01139000
@CC00472 DC    C'AMDPRECT'                                              01140000
@CC00474 DC    C'AMDPRFMT'                                              01141000
@CC00531 DC    C'CVTMAP'                                                01142000
         DS    CL4                                                      01143000
EXITPLST DS    CL56                                                     01144000
PLSTCOPY DS    CL56                                                     01145000
         ORG   PLSTCOPY                                                 01146000
EIPLTCB  DC    A(0)                                                     01147000
EIPLASID DC    H'0'                                                     01148000
EIPLSBPL DC    AL1(0)                                                   01149000
EIPLFLAG DC    X'80'                                                    01150000
EIPLBUF  DC    AL4(EIOUTBUF)                                            01151000
EIPLPRNT DC    AL4(AMDWRITR)                                            01152000
EIPLCVT  DC    A(0)                                                     01153000
EIPLMEMA DC    AL4(AMDMEMAR)                                            01154000
EIPLFRMT DC    A(0)                                                     01155000
EIPLCOMX DC    16X'00'                                                  01156000
EIPLFMTX DC    8X'00'                                                   01157000
EIPLEXT  DC    AL4(PRDMPEXT)                                            01158000
         ORG   PLSTCOPY+56                                              01159000
EIBUFFER DS    CL122                                                    01160000
         ORG   EIBUFFER                                                 01161000
@NM00055 DS    CL1                                                      01162000
EIOUTBUF DS    CL120                                                    01163000
@NM00056 DS    CL1                                                      01164000
         ORG   EIBUFFER+122                                             01165000
EIPROCSW DC    X'80'                                                    01166000
         ORG   EIPROCSW                                                 01167000
FAILSW   DS    BL1                                                      01168000
USTOPSW  EQU   EIPROCSW+0                                               01169000
CONSTOP  EQU   EIPROCSW+0                                               01170000
CNTRLSW  EQU   EIPROCSW+0                                               01171000
PRNTSW   EQU   EIPROCSW+0                                               01172000
EIPROCRV EQU   EIPROCSW+0                                               01173000
         ORG   EIPROCSW+1                                               01174000
EXITVERB DS    CL8                                                      01175000
         ORG   EXITVERB                                                 01176000
@NM00058 DC    8CL1' '                                                  01177000
         ORG   EXITVERB+8                                               01178000
ELOADMOD DS    CL8                                                      01179000
         DS    CL1                                                      01180000
MARSAVE  DS    CL72                                                     01181000
         ORG   MARSAVE                                                  01182000
@NM00060 DC    72X'00'                                                  01183000
         ORG   MARSAVE+72                                               01184000
WIRSAVE  DS    CL72                                                     01185000
         ORG   WIRSAVE                                                  01186000
@NM00061 DC    72X'00'                                                  01187000
         ORG   WIRSAVE+72                                               01188000
EXSTORCM DC    CL58'UNABLE TO SATISFY STORAGE REQUEST FOR EXIT MODULE xC01189000
               xxxxxxx'                                                 01190000
         ORG   EXSTORCM                                                 01191000
@NM00062 DS    CL50                                                     01192000
COMMODNM DS    CL8                                                      01193000
         ORG   EXSTORCM+58                                              01194000
         DS    CL2                                                      01195000
PATCH    DC    45F'0'                                                   01196000
AMDPRUIM CSECT                                                          01197000
*                                                                       01198000
DTAE     EQU   32                  DATA EBCDIC BIT                      01199000
DTAC     EQU   16                  DATA IN CORE BIT                     01200000
DTAP     EQU   8                   DATA PTR BIT                         01201000
DTA      EQU   4                   DATA INCLUDED BIT                    01202000
LBLP     EQU   2                   LABEL PTR BIT                        01203000
LBL      EQU   1                   LABEL INCLUDED BIT                   01204000
AMDPRUIM CSECT                                                          01205000
AMDUIMMG CSECT                                                          01206000
         DC    AL4(WTO165I+4)                                           01207000
         DC    AL4(44)                                                  01208000
         DC    AL4(W165SUFA+4)                                          01209000
         DC    AL4(20)                                                  01210000
         DC    AL4(W165SUFB+4)                                          01211000
         DC    AL4(52)                                                  01212000
         DC    AL4(W165SUFC+4)                                          01213000
         DC    AL4(52)                                                  01214000
         DC    AL4(W165SUFD+4)                                          01215000
         DC    AL4(49)                                                  01216000
         DC    AL4(WTO281I+4)                                           01217000
         DC    AL4(61)                                                  01218000
         DC    AL4(WTO287I+4)                                           01219000
         DC    AL4(52)                                                  01220000
         DC    AL4(WTO288I+4)                                           01221000
         DC    AL4(38)                                                  01222000
         DC    AL4(WTO289I+4)                                           01223000
         DC    AL4(30)                                                  01224000
WTO165I  WTO   'AMD165I ERROR IN PRECEDING CONTROL STATEMENT',         *01225000
               ROUTCDE=2,DESC=7,MF=L                                    01226000
W165SUFA WTO   'AMD165I INVALID VERB',                                 *01227000
               ROUTCDE=2,DESC=7,MF=L                                    01228000
W165SUFB WTO   'AMD165I DELIMETER ERROR IN OPERAND FIELD OF XXXXXXXX', *01229000
               ROUTCDE=2,DESC=7,MF=L                                    01230000
W165SUFC WTO   'AMD165I INVALID KEYWORD IN OPERAND FIELD OF XXXXXXXX', *01231000
               ROUTCDE=2,DESC=7,MF=L                                    01232000
W165SUFD WTO   'AMD165I SYNTAX ERROR IN OPERAND FIELD OF XXXXXXXX',    *01233000
               ROUTCDE=2,DESC=7,MF=L                                    01234000
WTO281I  WTO   'AMD281I AMDPRDMP EXIT INTERFACE INOPERATIVE- XXXXXXXX,Y*01235000
               YYY ZZ',                                                *01236000
               ROUTCDE=2,DESC=7,MF=L                                    01237000
WTO287I  WTO   'AMD287I UNABLE TO LOAD EXIT MODULE- XXXXXXXX,YYYY ZZ', *01238000
               ROUTCDE=2,DESC=7,MF=L                                    01239000
WTO288I  WTO   'AMD288I NO OUTPUT PRODUCED BY XXXXXXXX',               *01240000
               ROUTCDE=2,DESC=7,MF=L                                    01241000
WTO289I  WTO   'AMD289I VERB IGNORED- XXXXXXXX',                       *01242000
               ROUTCDE=2,DESC=7,MF=L                                    01243000
AMDPRUIM CSECT                                                          01244000
TRANSLT  TRT   0(0,R3),NONBLNK(COMPTR)   FIND 1ST NON BLANK             01245000
AMDPRUIM CSECT                                                          01246000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01247000
@01      EQU   01                                                       01248000
@02      EQU   02                                                       01249000
@03      EQU   03                                                       01250000
@04      EQU   04                                                       01251000
@05      EQU   05                                                       01252000
@06      EQU   06                                                       01253000
@07      EQU   07                                                       01254000
@08      EQU   08                                                       01255000
@09      EQU   09                                                       01256000
@10      EQU   10                                                       01257000
@11      EQU   11                                                       01258000
@12      EQU   12                                                       01259000
@13      EQU   13                                                       01260000
@14      EQU   14                                                       01261000
@15      EQU   15                                                       01262000
EXITRC   EQU   @04                                                      01263000
AEXITMOD EQU   @04                                                      01264000
NTRYCT   EQU   @06                                                      01265000
ECTABPTR EQU   @05                                                      01266000
OPRNDLEN EQU   @06                                                      01267000
VERBLEN  EQU   @06                                                      01268000
MGTBINDX EQU   @04                                                      01269000
R0       EQU   @00                                                      01270000
R1       EQU   @01                                                      01271000
R2       EQU   @02                                                      01272000
R3       EQU   @03                                                      01273000
R13      EQU   @13                                                      01274000
R15      EQU   @15                                                      01275000
COMPTR   EQU   @12                                                      01276000
BASE1    EQU   @11                                                      01277000
BASE2    EQU   @10                                                      01278000
BASE3    EQU   @09                                                      01279000
BUFREG   EQU   @06                                                      01280000
CNTREG   EQU   @03                                                      01281000
COMBASE  EQU   @12                                                      01282000
LINEREG  EQU   @08                                                      01283000
PREG     EQU   @01                                                      01284000
R10      EQU   @10                                                      01285000
R11      EQU   @11                                                      01286000
R12      EQU   @12                                                      01287000
R14      EQU   @14                                                      01288000
R4       EQU   @04                                                      01289000
R5       EQU   @05                                                      01290000
R6       EQU   @06                                                      01291000
R7       EQU   @07                                                      01292000
R8       EQU   @08                                                      01293000
R9       EQU   @09                                                      01294000
STOPBASE EQU   @05                                                      01295000
COMMON   EQU   0                                                        01296000
ERRADDR  EQU   COMMON                                                   01297000
VERBGN   EQU   COMMON+4                                                 01298000
VERBEND  EQU   COMMON+8                                                 01299000
CURBUF   EQU   COMMON+48                                                01300000
CVTADDR  EQU   COMMON+56                                                01301000
SWA      EQU   COMMON+122                                               01302000
RDRSW    EQU   SWA                                                      01303000
SWB      EQU   COMMON+123                                               01304000
SWC      EQU   COMMON+124                                               01305000
SWD      EQU   COMMON+125                                               01306000
FLSHMODE EQU   SWD                                                      01307000
SWE      EQU   COMMON+126                                               01308000
SWF      EQU   COMMON+127                                               01309000
BUFSW    EQU   COMMON+128                                               01310000
PRSW     EQU   COMMON+129                                               01311000
WTORMSG  EQU   COMMON+133                                               01312000
BLANKS   EQU   COMMON+214                                               01313000
TABLE    EQU   COMMON+659                                               01314000
HEXTABL  EQU   TABLE+63                                                 01315000
NONBLNK  EQU   COMMON+1244                                              01316000
AWRITE   EQU   COMMON+1500                                              01317000
APRTMSG  EQU   COMMON+1504                                              01318000
STOPEXIT EQU   COMMON+1528                                              01319000
DCBADDRS EQU   COMMON+1608                                              01320000
@NM00042 EQU   DCBADDRS+16                                              01321000
@NM00043 EQU   @NM00042                                                 01322000
QASID    EQU   COMMON+1664                                              01323000
BRRDDATA EQU   COMMON+1984                                              01324000
BRRDINIT EQU   COMMON+1988                                              01325000
AUSRTCBA EQU   COMMON+2016                                              01326000
AUSRASID EQU   COMMON+2020                                              01327000
EXITFLAG EQU   COMMON+2022                                              01328000
I3800SW  EQU   COMMON+2076                                              01329000
TITLEKEY EQU   COMMON+2077                                              01330000
ABDPL    EQU   0                                                        01331000
ADPLTCB  EQU   ABDPL                                                    01332000
ADPLASID EQU   ABDPL+4                                                  01333000
ADPLFLAG EQU   ABDPL+7                                                  01334000
ADPLCVT  EQU   ABDPL+16                                                 01335000
@NM00057 EQU   0                                                        01336000
MSGADDR  EQU   @NM00057                                                 01337000
MSGLEN   EQU   @NM00057+4                                               01338000
MSGMODNM EQU   0                                                        01339000
MSGVRBNM EQU   0                                                        01340000
MSGCOMPC EQU   0                                                        01341000
MSGRETCD EQU   0                                                        01342000
VERBMAP  EQU   0                                                        01343000
ECTENTRY EQU   0                                                        01344000
ECTMOD   EQU   ECTENTRY                                                 01345000
ECTFLAG  EQU   ECTENTRY+8                                               01346000
ECTVERB  EQU   ECTENTRY+12                                              01347000
EXITMOD  EQU   0                                                        01348000
CURBUFER EQU   0                                                        01349000
STOPHAND EQU   0                                                        01350000
ERRHAND  EQU   0                                                        01351000
EXITDLIM EQU   0                                                        01352000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01353000
@NM00059 EQU   ECTENTRY+9                                               01354000
ADPLEXT  EQU   ABDPL+52                                                 01355000
ADPLFMT2 EQU   ABDPL+48                                                 01356000
ADPLFMT1 EQU   ABDPL+44                                                 01357000
ADPLCOM4 EQU   ABDPL+40                                                 01358000
ADPLCOM3 EQU   ABDPL+36                                                 01359000
ADPLCOM2 EQU   ABDPL+32                                                 01360000
ADPLCOM1 EQU   ABDPL+28                                                 01361000
ADPLFRMT EQU   ABDPL+24                                                 01362000
ADPLMEMA EQU   ABDPL+20                                                 01363000
ADPLPRNT EQU   ABDPL+12                                                 01364000
ADPLBUF  EQU   ABDPL+8                                                  01365000
@NM00054 EQU   ADPLFLAG                                                 01366000
ADPLSYTM EQU   ADPLFLAG                                                 01367000
ADPLSNPR EQU   ADPLFLAG                                                 01368000
ADPLSBPL EQU   ABDPL+6                                                  01369000
Z9ERRID  EQU   COMMON+2116                                              01370000
Z9SUFLG  EQU   COMMON+2115                                              01371000
Z9SUBITS EQU   COMMON+2100                                              01372000
Z9SVCBUF EQU   COMMON+2096                                              01373000
TITLESTK EQU   TITLEKEY+12                                              01374000
@NM00053 EQU   TITLEKEY                                                 01375000
I3800204 EQU   I3800SW                                                  01376000
I380080  EQU   I3800SW                                                  01377000
I3800ULN EQU   I3800SW                                                  01378000
I3800KEY EQU   I3800SW                                                  01379000
@NM00052 EQU   I3800SW                                                  01380000
@NM00051 EQU   I3800SW                                                  01381000
@NM00050 EQU   I3800SW                                                  01382000
@NM00049 EQU   I3800SW                                                  01383000
CSADDR   EQU   COMMON+2072                                              01384000
@NM00048 EQU   COMMON+2070                                              01385000
TOPICHDR EQU   COMMON+2060                                              01386000
DFLTCSA  EQU   COMMON+2056                                              01387000
LPAMAX   EQU   COMMON+2052                                              01388000
DNUCTOP  EQU   COMMON+2048                                              01389000
XLMAX    EQU   COMMON+2044                                              01390000
DQEMAX   EQU   COMMON+2042                                              01391000
ASCBMAX  EQU   COMMON+2040                                              01392000
TCBMAX   EQU   COMMON+2038                                              01393000
SRBMAX   EQU   COMMON+2036                                              01394000
DDMAX    EQU   COMMON+2034                                              01395000
DEBMAX   EQU   COMMON+2032                                              01396000
JPQMAX   EQU   COMMON+2030                                              01397000
LLEMAX   EQU   COMMON+2028                                              01398000
PQEMAX   EQU   COMMON+2026                                              01399000
RBMAX    EQU   COMMON+2024                                              01400000
@NM00047 EQU   COMMON+2023                                              01401000
AUSRDEL  EQU   COMMON+2012                                              01402000
AUSREXIT EQU   COMMON+2008                                              01403000
AUSRINIT EQU   COMMON+2004                                              01404000
ASRBFMT  EQU   COMMON+2000                                              01405000
AASCBFMT EQU   COMMON+1996                                              01406000
BRRDADJ  EQU   COMMON+1992                                              01407000
BUFERMAP EQU   COMMON+1980                                              01408000
ASCBMAP  EQU   COMMON+1976                                              01409000
CPUMAP   EQU   COMMON+1972                                              01410000
ASIDNDX  EQU   COMMON+1968                                              01411000
@NM00046 EQU   COMMON+1964                                              01412000
HDRTITLE EQU   COMMON+1864                                              01413000
HDRREGS  EQU   COMMON+1696                                              01414000
SACSWCAW EQU   COMMON+1684                                              01415000
ASVTADDR EQU   COMMON+1680                                              01416000
PREFXRGV EQU   COMMON+1676                                              01417000
PREFXRGR EQU   COMMON+1672                                              01418000
CURASCB  EQU   COMMON+1668                                              01419000
IPLCPU   EQU   COMMON+1666                                              01420000
QAPFT    EQU   COMMON+1660                                              01421000
@NM00045 EQU   COMMON+1656                                              01422000
REALMAX  EQU   COMMON+1652                                              01423000
SEGTABOR EQU   COMMON+1648                                              01424000
REALMAP  EQU   COMMON+1644                                              01425000
@NM00044 EQU   COMMON+1641                                              01426000
EDITER   EQU   COMMON+1640                                              01427000
AROOT    EQU   COMMON+1636                                              01428000
AEDITCB  EQU   COMMON+1632                                              01429000
TRCCOUNT EQU   COMMON+1628                                              01430000
ASYSUDCB EQU   @NM00042+1                                               01431000
ENDLIST  EQU   @NM00043                                                 01432000
AINDCB   EQU   DCBADDRS+12                                              01433000
ARDRDCB  EQU   DCBADDRS+8                                               01434000
APTRDCB  EQU   DCBADDRS+4                                               01435000
AOUTDCB  EQU   DCBADDRS                                                 01436000
ATCBSMRY EQU   COMMON+1604                                              01437000
ATCBSMFR EQU   COMMON+1600                                              01438000
ONGOPTR  EQU   COMMON+1596                                              01439000
AEND     EQU   COMMON+1592                                              01440000
AERRMSGA EQU   COMMON+1584                                              01441000
BUFREINT EQU   COMMON+1580                                              01442000
BUFSUM   EQU   COMMON+1576                                              01443000
APRTSTG  EQU   COMMON+1572                                              01444000
AFORMAT  EQU   COMMON+1568                                              01445000
ASTPROUT EQU   COMMON+1564                                              01446000
APCBENQ  EQU   COMMON+1560                                              01447000
ATCBRTRV EQU   COMMON+1556                                              01448000
ATCBREMV EQU   COMMON+1552                                              01449000
ATCBSAVE EQU   COMMON+1548                                              01450000
QATMERTN EQU   COMMON+1544                                              01451000
ALOADER  EQU   COMMON+1540                                              01452000
AEREXIT  EQU   COMMON+1536                                              01453000
SYNMSGA  EQU   COMMON+1532                                              01454000
ARGNBND  EQU   COMMON+1524                                              01455000
AWRDCNVT EQU   COMMON+1520                                              01456000
AADRCNVT EQU   COMMON+1516                                              01457000
AFMTLINE EQU   COMMON+1512                                              01458000
ASYNTAX  EQU   COMMON+1508                                              01459000
BLNK     EQU   COMMON+988                                               01460000
@NM00041 EQU   COMMON+972                                               01461000
@NM00040 EQU   COMMON+915                                               01462000
EBCTABL  EQU   HEXTABL+10                                               01463000
@NM00039 EQU   HEXTABL                                                  01464000
@NM00038 EQU   TABLE                                                    01465000
CAPTABL  EQU   COMMON+403                                               01466000
TITLEPGE EQU   COMMON+394                                               01467000
@NM00037 EQU   COMMON+392                                               01468000
TITLETME EQU   COMMON+379                                               01469000
@NM00036 EQU   COMMON+377                                               01470000
TITLEDTE EQU   COMMON+364                                               01471000
@NM00035 EQU   COMMON+362                                               01472000
TITLEMOD EQU   COMMON+347                                               01473000
TITLEMSG EQU   COMMON+283                                               01474000
MSG2     EQU   COMMON+257                                               01475000
MSG1     EQU   COMMON+231                                               01476000
STOP     EQU   COMMON+227                                               01477000
TITLE    EQU   COMMON+222                                               01478000
@NM00034 EQU   COMMON+130                                               01479000
@NM00033 EQU   PRSW                                                     01480000
@NM00032 EQU   PRSW                                                     01481000
PRNTREAL EQU   PRSW                                                     01482000
PRNTRL   EQU   PRSW                                                     01483000
TTLSW    EQU   PRSW                                                     01484000
@NM00031 EQU   PRSW                                                     01485000
QSEGTBSW EQU   PRSW                                                     01486000
@NM00030 EQU   PRSW                                                     01487000
@NM00029 EQU   BUFSW                                                    01488000
PREFM    EQU   BUFSW                                                    01489000
@NM00028 EQU   BUFSW                                                    01490000
@NM00027 EQU   BUFSW                                                    01491000
@NM00026 EQU   BUFSW                                                    01492000
@NM00025 EQU   BUFSW                                                    01493000
@NM00024 EQU   BUFSW                                                    01494000
@NM00023 EQU   BUFSW                                                    01495000
@NM00022 EQU   SWF                                                      01496000
QUT1LOD  EQU   SWF                                                      01497000
@NM00021 EQU   SWF                                                      01498000
PAGEOK   EQU   SWF                                                      01499000
DMPIC    EQU   SWF                                                      01500000
QSADMP   EQU   SWF                                                      01501000
NUCTFRMC EQU   SWF                                                      01502000
QPRDINIT EQU   SWF                                                      01503000
@NM00020 EQU   SWE                                                      01504000
@NM00019 EQU   SWE                                                      01505000
@NM00018 EQU   SWE                                                      01506000
BUILDMAP EQU   SWE                                                      01507000
TITLESW  EQU   SWE                                                      01508000
RESPC    EQU   SWE                                                      01509000
@NM00017 EQU   SWE                                                      01510000
STOPSW   EQU   SWE                                                      01511000
@NM00016 EQU   SWD                                                      01512000
GPRSFND  EQU   SWD                                                      01513000
CONTSW   EQU   SWD                                                      01514000
NOLOADSW EQU   SWD                                                      01515000
NOSTDMG  EQU   SWD                                                      01516000
@NM00015 EQU   SWD                                                      01517000
@NM00014 EQU   SWD                                                      01518000
@NM00013 EQU   SWC                                                      01519000
@NM00012 EQU   SWC                                                      01520000
@NM00011 EQU   SWC                                                      01521000
EDITSW   EQU   SWC                                                      01522000
TREADIN  EQU   SWC                                                      01523000
POSITSW  EQU   SWC                                                      01524000
SETFLSH  EQU   SWC                                                      01525000
MSTRSW   EQU   SWC                                                      01526000
@NM00010 EQU   SWB                                                      01527000
@NM00009 EQU   SWB                                                      01528000
QSYSUT2  EQU   SWB                                                      01529000
ENDSW    EQU   SWB                                                      01530000
@NM00008 EQU   SWB                                                      01531000
@NM00007 EQU   SWB                                                      01532000
FMTERR   EQU   SWB                                                      01533000
IOERR    EQU   SWB                                                      01534000
SETCVTSW EQU   SWA                                                      01535000
@NM00006 EQU   SWA                                                      01536000
GOSW     EQU   SWA                                                      01537000
@NM00005 EQU   SWA                                                      01538000
@NM00004 EQU   SWA                                                      01539000
@NM00003 EQU   SWA                                                      01540000
@NM00002 EQU   SWA                                                      01541000
LINENUM  EQU   COMMON+120                                               01542000
LINENUMB EQU   COMMON+118                                               01543000
SIXTEEN  EQU   COMMON+116                                               01544000
TWELVE   EQU   COMMON+114                                               01545000
ELEVEN   EQU   COMMON+112                                               01546000
HTEN     EQU   COMMON+110                                               01547000
EIGHT    EQU   COMMON+108                                               01548000
SEVEN    EQU   COMMON+106                                               01549000
FIVE     EQU   COMMON+104                                               01550000
FOUR     EQU   COMMON+102                                               01551000
THREE    EQU   COMMON+100                                               01552000
TWO      EQU   COMMON+98                                                01553000
ONEA     EQU   COMMON+96                                                01554000
READTM   EQU   COMMON+92                                                01555000
RDERCNT  EQU   COMMON+88                                                01556000
READNO   EQU   COMMON+84                                                01557000
RDENTRY  EQU   COMMON+80                                                01558000
@NM00001 EQU   COMMON+78                                                01559000
FILESEQ  EQU   COMMON+76                                                01560000
INDD     EQU   COMMON+68                                                01561000
STORSIZE EQU   COMMON+64                                                01562000
PCBPTR   EQU   COMMON+60                                                01563000
TCBLIST  EQU   COMMON+52                                                01564000
PAGENUMB EQU   COMMON+44                                                01565000
LINECNT  EQU   COMMON+40                                                01566000
SIX      EQU   COMMON+36                                                01567000
NUCTOP   EQU   COMMON+32                                                01568000
WORK1    EQU   COMMON+24                                                01569000
DELIMCD  EQU   COMMON+20                                                01570000
KYWDEND  EQU   COMMON+16                                                01571000
KYWDBGN  EQU   COMMON+12                                                01572000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01573000
@RF00117 EQU   @EL00001                                                 01574000
@RT00133 EQU   VRBEXIT                                                  01575000
@RF00180 EQU   @EL00001                                                 01576000
@RF00277 EQU   LOADRETS                                                 01577000
@RT00299 EQU   LOADRETS                                                 01578000
@RT00316 EQU   RDERRET                                                  01579000
@RT00336 EQU   WIRTERM                                                  01580000
@RF00344 EQU   @EL00002                                                 01581000
@RF00351 EQU   @EL00001                                                 01582000
@ENDDATA EQU   *                                                        01583000
         END   AMDPRUIM,(C'PLS2203',0701,76189)                         01584000
