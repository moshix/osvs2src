         TITLE 'AMDSADER DIRECT ACCESS ERROR RECOVERY ROUTINE          *00001000
                        '                                               00002000
AMDSADER CSECT ,                                                01S0001 00003000
@MAINENT DS    0H                                               01S0001 00004000
         USING *,@15                                            01S0001 00005000
         B     @PROLOG                                          01S0001 00006000
         DC    AL1(16)                                          01S0001 00007000
         DC    C'AMDSADER  75.280'                              01S0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                  01S0001 00010000
         BALR  @09,0                                            01S0001 00011000
@PSTART  DS    0H                                               01S0001 00012000
         USING @PSTART,@09                                      01S0001 00013000
         ST    @13,@SA00001+4                                   01S0001 00014000
         LA    @14,@SA00001                                     01S0001 00015000
         ST    @14,8(,@13)                                      01S0001 00016000
         LR    @13,@14                                          01S0001 00017000
*   SAVEFORM(1:4) = 'LDER';         /* SET SAVEAREA ID               */ 00018000
         MVC   SAVEFORM(4,R13),@CC00797                         01S0202 00019000
*   CCTREG = CCTADDR;               /* SET REGISTER TO POINT TO CCT  */ 00020000
         L     CCTREG,@CF00442                                  01S0203 00021000
*   ERBADDR = ADDR(CTERBDA);        /* SET ADDR OF ERB TO BE USED    */ 00022000
         LA    @10,CTERBDA(,CCTREG)                             01S0204 00023000
         ST    @10,ERBADDR                                      01S0204 00024000
*   RESRHAA = ADDR(IODBSEEK);       /* INIT ADDR IN CCW              */ 00025000
         LA    @10,IODBSEEK(,IODBREG)                           01S0205 00026000
         STCM  @10,7,RESRHAA                                    01S0205 00027000
*   RESERCHA = ADDR(IODBSRCH);      /* INIT ADDR IN CCW              */ 00028000
         LA    @10,IODBSRCH(,IODBREG)                           01S0206 00029000
         STCM  @10,7,RESERCHA                                   01S0206 00030000
*   CTERBDA = ZERO;                 /* RESET ERB                     */ 00031000
         SLR   @10,@10                                          01S0207 00032000
         ST    @10,CTERBDA(,CCTREG)                             01S0207 00033000
*   IF CSWCADDR = ZERO | CSWCADDR = IODBCAW THEN /* IS THERE A CCW      00034000
*                                      ADDRESS                       */ 00035000
         L     @10,CSWCADDR+23(,IODBREG)                        01S0208 00036000
         LA    @10,0(,@10)                                      01S0208 00037000
         LTR   @10,@10                                          01S0208 00038000
         BZ    @RT00208                                         01S0208 00039000
         C     @10,IODBCAW(,IODBREG)                            01S0208 00040000
         BNE   @RF00208                                         01S0208 00041000
@RT00208 DS    0H                                               01S0209 00042000
*     CCWREG = IODBCAW;             /* NO--THEN USE CCW FROM IODB    */ 00043000
         L     CCWREG,IODBCAW(,IODBREG)                         01S0209 00044000
*   ELSE                                                        01S0210 00045000
*     CCWREG = CSWCADDR - LENGTH(CCW); /* SET REGISTER TO POINT TO      00046000
*                                      ERROR CCW                     */ 00047000
*                                                               01S0210 00048000
         B     @RC00208                                         01S0210 00049000
@RF00208 L     CCWREG,CSWCADDR+23(,IODBREG)                     01S0210 00050000
         LA    CCWREG,0(,CCWREG)                                01S0210 00051000
         SL    CCWREG,@CF00047                                  01S0210 00052000
*CCC:                                                           01S0211 00053000
*   IODBSENS = IODBSENS && IODBSENS; /* CLEAR THE SENSE BYTES        */ 00054000
@RC00208 DS    0H                                               01S0211 00055000
CCC      XC    IODBSENS(24,IODBREG),IODBSENS(IODBREG)           01S0211 00056000
*   IF CSWCCC = ON THEN                                         01S0212 00057000
         TM    CSWCCC+24(IODBREG),B'00000100'                   01S0212 00058000
         BNO   @RF00212                                         01S0212 00059000
*     DO;                           /* IF CCC - AN UNRECOVERABLE        00060000
*                                      ERROR                         */ 00061000
*       ERBID = MSGCCC;             /* SET UP CCC MSG ID             */ 00062000
         MVI   ERBID(CCTREG),X'1A'                              01S0214 00063000
*       GO TO TERMEXIT;             /* TERMINATE REQUEST             */ 00064000
         B     TERMEXIT                                         01S0215 00065000
*     END;                                                      01S0216 00066000
*                                                               01S0217 00067000
*   /*****************************************************************/ 00068000
*   /*                                                               */ 00069000
*   /* NEXT WE PROCESS INTERFACE CONTROL CHECKS. THIS IS ISOLATED BY */ 00070000
*   /* SENSE 0002                                                    */ 00071000
*   /*                                                               */ 00072000
*   /*****************************************************************/ 00073000
*                                                               01S0217 00074000
*/*ICC: D (NO,CDC,YES,MSG27) INTERFACE CONTROL CK ?                  */ 00075000
*/*MSG27: P (,TERMEXIT) MSG ID = 27                                  */ 00076000
*   IF CSWICC = ON THEN                                         01S0217 00077000
@RF00212 TM    CSWICC+24(IODBREG),B'00000010'                   01S0217 00078000
         BNO   @RF00217                                         01S0217 00079000
*     DO;                           /* INTERFACE CONTROL CHECK       */ 00080000
*       ERBID = MSGICC;                                         01S0219 00081000
         MVI   ERBID(CCTREG),X'1B'                              01S0219 00082000
*       GO TO TERMEXIT;                                         01S0220 00083000
         B     TERMEXIT                                         01S0220 00084000
*     END;                                                      01S0221 00085000
*                                                               01S0221 00086000
*   /*****************************************************************/ 00087000
*   /*                                                               */ 00088000
*   /* PROCESSING FOR CHANNEL DATA CHECKS STATUS 0008 IS NEXT        */ 00089000
*   /*                                                               */ 00090000
*   /*****************************************************************/ 00091000
*                                                               01S0222 00092000
*/*CDC: D (NO,UC,YES,MSG25) IODBCSW = CHANNEL DATA CK ?              */ 00093000
*/*MSG25: P (,TERMEXIT) MSG ID = 25                                  */ 00094000
*   IF CSWCDC = ON THEN                                         01S0222 00095000
@RF00217 TM    CSWCDC+24(IODBREG),B'00001000'                   01S0222 00096000
         BNO   @RF00222                                         01S0222 00097000
*     DO;                           /* IF CHAN DATA CHECK            */ 00098000
*       ERBID = MSGCDC;                                         01S0224 00099000
         MVI   ERBID(CCTREG),X'19'                              01S0224 00100000
*       GO TO TERMEXIT;                                         01S0225 00101000
         B     TERMEXIT                                         01S0225 00102000
*     END;                                                      01S0226 00103000
*                                                               01S0226 00104000
*   /*****************************************************************/ 00105000
*   /*                                                               */ 00106000
*   /* UNIT CHECK CODE IS NEXT. THIS PROCESSING REQUIRES SOME UNIQUE */ 00107000
*   /* PROCESSING FOR DIFFERENT DEVICES. STATUS IS 0200              */ 00108000
*   /*                                                               */ 00109000
*   /*****************************************************************/ 00110000
*                                                               01S0227 00111000
*/*UC: D (YES,UNITCK,NO,CHAINCK) IODBCSW = UNIT CHECK ?              */ 00112000
*/*UNITCK: N UNIT CHECK ENTRY.                                       */ 00113000
*/* N THIS IS TOTALLY DEVICE DEPENDENT CODE                          */ 00114000
*/* P SET UP R11 = ADDR OF SENSE COMMAND TO READ INTO IODBSENS       */ 00115000
*/* S AMDSAERI:SVC 23 ISSUE SENSE COMMAND                            */ 00116000
*/* D (YES,SENS30,NO,TYPECK) ERROR ON SENSE CMD ?                    */ 00117000
*/*SENS30: P (,TERMEXIT) MSG ID = 30                                 */ 00118000
*/*TYPECK: D (YES,D2314,NO,) IODBTYPE = 2314 ?                       */ 00119000
*/* D (YES,D3330,NO,) IODBTYPE = 3330 ?                              */ 00120000
*/* D (YES,D3330,NO,) IODBTYPE = 3330-1 ?                            */ 00121000
*/* D (YES,D2305,NO,) IODBTYPE = 2305-1 ?                            */ 00122000
*/* D (YES,D2305,NO,) IODBTYPE = 2305-2 ?                            */ 00123000
*/* D (YES,D3340,NO,) IODBTYPE = 3340 ?                              */ 00124000
*/* D (YES,D3330,NO,) IODBTYPE = 3350 ? */                 /*@Z30RSTA*/ 00125000
*/* P (,TERMEXIT) MSG ID = 31                                        */ 00126000
*   IF CSWUC = ON THEN              /* IS CONDITION A UNIT CHECK     */ 00127000
@RF00222 TM    CSWUC+24(IODBREG),B'00000010'                    01S0227 00128000
         BNO   @RF00227                                         01S0227 00129000
*     DO;                                                       01S0228 00130000
*       SENSEADR = ADDR(IODBSENS);  /* SET ADDRESS INTO SENSE COMMAND*/ 00131000
         LA    @10,IODBSENS(,IODBREG)                           01S0229 00132000
         STCM  @10,7,SENSEADR                                   01S0229 00133000
*       RESPECIFY (R11,RETCODE) RESTRICTED; /* RESTRICT REGISTERS    */ 00134000
*       R11 = ADDR(SENSE);          /* SET ADDRESS OF SENSE COMMAND  */ 00135000
         LA    R11,SENSE                                        01S0231 00136000
*       SVC (ERISVC);               /* ISSUE SENSE                   */ 00137000
         SVC   23                                               01S0232 00138000
*       IF RETCODE ^= ZERO THEN     /* WAS SENSE ISSUED CORRECTLY    */ 00139000
         LTR   RETCODE,RETCODE                                  01S0233 00140000
         BZ    @RF00233                                         01S0233 00141000
*         DO;                                                   01S0234 00142000
*           ERBID = MSGERS;         /* NO--SET MESSAGE ID            */ 00143000
         MVI   ERBID(CCTREG),X'1E'                              01S0235 00144000
*           GO TO TERMEXIT;         /* AND EXIT                      */ 00145000
         B     TERMEXIT                                         01S0236 00146000
*           RESPECIFY (R11,RETCODE) UNRESTRICTED; /* RELEASE    01S0237 00147000
*                                      REGISTERS                     */ 00148000
*         END;                                                  01S0238 00149000
*       IF IODBTYPE = DT2314 THEN   /* IS ERROR DEVICE A 2314        */ 00150000
@RF00233 CLI   IODBTYPE(IODBREG),8                              01S0239 00151000
         BE    @RT00239                                         01S0239 00152000
*         GO TO D2314;              /* YES--HANDLE IN DEVICE DEPENANT   00153000
*                                      CODE                          */ 00154000
*       IF IODBTYPE = DT3330 | IODBTYPE = DT33301 THEN /* IS ERROR      00155000
*                                      DEVICE A 3330 OR 3330-1       */ 00156000
         CLI   IODBTYPE(IODBREG),9                              01S0241 00157000
         BE    @RT00241                                         01S0241 00158000
         CLI   IODBTYPE(IODBREG),13                             01S0241 00159000
         BE    @RT00241                                         01S0241 00160000
*         GO TO D3330;              /* YES--HANDLE IN DEVICE DEPENANT   00161000
*                                      CODE                          */ 00162000
*       IF IODBTYPE = DT23051 | IODBTYPE = DT23052 THEN /* IS ERROR     00163000
*                                      DEVICE A 2305-1 OR 2305-2     */ 00164000
         CLI   IODBTYPE(IODBREG),6                              01S0243 00165000
         BE    @RT00243                                         01S0243 00166000
         CLI   IODBTYPE(IODBREG),7                              01S0243 00167000
         BE    @RT00243                                         01S0243 00168000
*         GO TO D2305;              /* YES--HANDLE IN DEVICE DEPENANT   00169000
*                                      CODE                          */ 00170000
*       IF IODBTYPE = DT3340 THEN   /* IS ERROR DEVICE A 3340        */ 00171000
         CLI   IODBTYPE(IODBREG),10                             01S0245 00172000
         BE    @RT00245                                         01S0245 00173000
*         GO TO D3340;              /* YES--HANDLE IN DEVICE DEPENANT   00174000
*                                      CODE                          */ 00175000
*       IF IODBTYPE = DT3350 THEN   /* IS ERROR DEVICE A 3350        */ 00176000
         CLI   IODBTYPE(IODBREG),11                             01S0247 00177000
         BE    @RT00247                                         01S0247 00178000
*         GO TO D3350;              /* YES--HANDLE IN DEVICE DEPENANT   00179000
*                                      CODE                  @Z30RSTA*/ 00180000
*       ERBID = MSGERR;             /* UNSUPPORTED DEVICE--SET  01S0249 00181000
*                                      MESSAGE ID                    */ 00182000
         MVI   ERBID(CCTREG),X'1F'                              01S0249 00183000
*       GO TO TERMEXIT;             /* AND EXIT                      */ 00184000
         B     TERMEXIT                                         01S0250 00185000
*     END;                                                      01S0251 00186000
*                                                               01S0252 00187000
*   /*****************************************************************/ 00188000
*   /*                                                               */ 00189000
*   /* NEXT PROCESSING IS DONE FOR CHAINING CHECK. STATUS IS 0001    */ 00190000
*   /*                                                               */ 00191000
*   /*****************************************************************/ 00192000
*                                                               01S0252 00193000
*/*CHAINCK: D (YES,CHAINREC,NO,UE) CHAINING CHECK ?                  */ 00194000
*                                                               01S0252 00195000
*   /*****************************************************************/ 00196000
*   /*                                                               */ 00197000
*   /* THIS ROUTINE RETRIES THE ORIGINAL FAILING DA I/O OPERATION    */ 00198000
*   /* ONCE                                                          */ 00199000
*   /*                                                               */ 00200000
*   /*****************************************************************/ 00201000
*                                                               01S0252 00202000
*/*CHAINREC: P R11 = RECALIBRATE CMD                                 */ 00203000
*/* S AMDSAERI:SVC 23 ISSUE RECALIBRATE                              */ 00204000
*/* D (YES,,NO,CHAINR) ERROR ON RECALIBRATE ?                        */ 00205000
*/* P (,TERMEXIT) MESSAGE ID = 31                                    */ 00206000
*/*CHAINR: S AMDSAERB:SVC 20 DAERB, CC=28, PCT=10, SCT=0             */ 00207000
*/* N (,REPEATOP) RETRY I/O OPERATION                                */ 00208000
*   IF CSWCHC = ON THEN                                         01S0252 00209000
@RF00227 TM    CSWCHC+24(IODBREG),B'00000001'                   01S0252 00210000
         BNO   @RF00252                                         01S0252 00211000
*     DO;                           /* IF CHAINING CHECK CONDITION   */ 00212000
*       RESPECIFY R11 RESTRICTED;                               01S0254 00213000
*       R11 = ADDR(RECALBTE);       /* SET UP FOR RECALIBRATE CMD    */ 00214000
         LA    R11,RECALBTE                                     01S0255 00215000
*       SVC (ERISVC);               /* ISSUE RECALIBRATE COMMAND     */ 00216000
         SVC   23                                               01S0256 00217000
*       RESPECIFY RETCODE RESTRICTED;                           01S0257 00218000
*       IF RETCODE ^= ZERO THEN                                 01S0258 00219000
         LTR   RETCODE,RETCODE                                  01S0258 00220000
         BZ    @RF00258                                         01S0258 00221000
*         DO;                       /* ERROR DURING RECALIBRATE      */ 00222000
*           ERBID = MSGERR;         /* SET UP MSG ID                 */ 00223000
         MVI   ERBID(CCTREG),X'1F'                              01S0260 00224000
*           GO TO TERMEXIT;         /* NO RETRIES                    */ 00225000
         B     TERMEXIT                                         01S0261 00226000
*         END;                                                  01S0262 00227000
*       RESPECIFY (R11,RETCODE) UNRESTRICTED;                   01S0263 00228000
@RF00258 DS    0H                                               01S0264 00229000
*       ERBPID = MSGCC;             /* SET UP MSG ID                 */ 00230000
         MVI   ERBPID,X'1C'                                     01S0264 00231000
*       ERBSCT = ZERO;              /* NO SECONDARY COUNT            */ 00232000
         MVI   ERBSCT,X'00'                                     01S0265 00233000
*       ERBPCT = TEN;               /* 10 RETRIES                    */ 00234000
         MVI   ERBPCT,X'0A'                                     01S0266 00235000
*       R1 = ADDR(ERBPARM);         /* SET INPUT REG                 */ 00236000
         LA    R1,ERBPARM                                       01S0267 00237000
*       SVC (ERBSVC);               /* SET ERB                       */ 00238000
         SVC   20                                               01S0268 00239000
*       GO TO REPEATOP;             /* RETRY I/O OPERATION           */ 00240000
         B     REPEATOP                                         01S0269 00241000
*     END;                                                      01S0270 00242000
*                                                               01S0270 00243000
*   /*****************************************************************/ 00244000
*   /*                                                               */ 00245000
*   /* UNIT EXCEPTION CONDITION. STATUS DATA IS 0100                 */ 00246000
*   /*                                                               */ 00247000
*   /*****************************************************************/ 00248000
*                                                               01S0271 00249000
*/*UE: D (YES,MSG20,NO,PGMCK) IODBCSW = UNIT EXCEPTION ?             */ 00250000
*/*MSG20: P (,TERMEXIT) MSG ID = 20                                  */ 00251000
*   IF CSWUE = ON THEN                                          01S0271 00252000
@RF00252 TM    CSWUE+24(IODBREG),B'00000001'                    01S0271 00253000
         BNO   @RF00271                                         01S0271 00254000
*     DO;                           /* IF UNIT EXCEPTION CONDITION   */ 00255000
*       ERBID = MSGUE;              /* SET UP MESSAGE ID             */ 00256000
         MVI   ERBID(CCTREG),X'14'                              01S0273 00257000
*       GO TO TERMEXIT;             /* NO RETRIES POSSIBLE           */ 00258000
         B     TERMEXIT                                         01S0274 00259000
*     END;                                                      01S0275 00260000
*                                                               01S0275 00261000
*   /*****************************************************************/ 00262000
*   /*                                                               */ 00263000
*   /* CHANNEL PROGRAM CHECK IS NEXT STATUS 0020                     */ 00264000
*   /*                                                               */ 00265000
*   /*****************************************************************/ 00266000
*                                                               01S0276 00267000
*/*PGMCK: D (YES,MSG23,NO,PROTCK) IODBCSW = PGM CK ?                 */ 00268000
*/*MSG23: P (,TERMEXIT) MSG ID = 23                                  */ 00269000
*   IF CSWPGC = ON THEN                                         01S0276 00270000
@RF00271 TM    CSWPGC+24(IODBREG),B'00100000'                   01S0276 00271000
         BNO   @RF00276                                         01S0276 00272000
*     DO;                           /* IF CHANNEL PROGRAM CHECK      */ 00273000
*       ERBID = MSGPCK;             /* SET MESSAGE ID                */ 00274000
         MVI   ERBID(CCTREG),X'17'                              01S0278 00275000
*       GO TO TERMEXIT;             /* TERMINATE I/O                 */ 00276000
         B     TERMEXIT                                         01S0279 00277000
*     END;                                                      01S0280 00278000
*                                                               01S0280 00279000
*   /*****************************************************************/ 00280000
*   /*                                                               */ 00281000
*   /* CHANNEL PROTECTION CHECK FOLLOWS. STATUS IS 0010              */ 00282000
*   /*                                                               */ 00283000
*   /*****************************************************************/ 00284000
*                                                               01S0281 00285000
*/*PROTCK: D (YES,MSG24,NO,INLNGTH) IODBCSW = PROTECTION CK ?        */ 00286000
*/*MSG24: P (,TERMEXIT) MSG ID = 24                                  */ 00287000
*   IF CSWPTC = ON THEN                                         01S0281 00288000
@RF00276 TM    CSWPTC+24(IODBREG),B'00010000'                   01S0281 00289000
         BNO   @RF00281                                         01S0281 00290000
*     DO;                           /* IF CHANNEL PROTECTION CHECK   */ 00291000
*       ERBID = MSGPTK;             /* SET MESSAGE ID                */ 00292000
         MVI   ERBID(CCTREG),X'18'                              01S0283 00293000
*       GO TO TERMEXIT;             /* TERMINATE I/O                 */ 00294000
         B     TERMEXIT                                         01S0284 00295000
*     END;                                                      01S0285 00296000
*                                                               01S0285 00297000
*   /*****************************************************************/ 00298000
*   /*                                                               */ 00299000
*   /* INCORRECT LENGTH IS KNOWN BY STATUS 0040                      */ 00300000
*   /*                                                               */ 00301000
*   /*****************************************************************/ 00302000
*                                                               01S0286 00303000
*/*INLNGTH: D (YES,MSG22,NO,PCI) INCORRECT LENGTH ?                  */ 00304000
*/*MSG22: P (,TERMEXIT) MSG ID = 22                                  */ 00305000
*   IF CSWIL = ON THEN                                          01S0286 00306000
@RF00281 TM    CSWIL+24(IODBREG),B'01000000'                    01S0286 00307000
         BNO   @RF00286                                         01S0286 00308000
*     DO;                           /* INCORRECT LENGTH CONDITION    */ 00309000
*       ERBID = MSGIL;              /* SET MESSAGE ID                */ 00310000
         MVI   ERBID(CCTREG),X'16'                              01S0288 00311000
*       GO TO TERMEXIT;             /* TERMINATE I/O                 */ 00312000
         B     TERMEXIT                                         01S0289 00313000
*     END;                                                      01S0290 00314000
*                                                               01S0290 00315000
*   /*****************************************************************/ 00316000
*   /*                                                               */ 00317000
*   /* PCI IS NEXT WITH STATUS 0080                                  */ 00318000
*   /*                                                               */ 00319000
*   /*****************************************************************/ 00320000
*                                                               01S0291 00321000
*/*PCI: D (YES,MSG21,NO,ATTN) PCI ?                                  */ 00322000
*/*MSG21: P (,TERMEXIT) MSG ID = 21                                  */ 00323000
*   IF CSWPCI = ON THEN                                         01S0291 00324000
@RF00286 TM    CSWPCI+24(IODBREG),B'10000000'                   01S0291 00325000
         BNO   @RF00291                                         01S0291 00326000
*     DO;                           /* PCI CONDITION                 */ 00327000
*       ERBID = MSGPCI;             /* SET UP MESSAGE ID             */ 00328000
         MVI   ERBID(CCTREG),X'15'                              01S0293 00329000
*       GO TO TERMEXIT;             /* TERMINATE I/O                 */ 00330000
         B     TERMEXIT                                         01S0294 00331000
*     END;                                                      01S0295 00332000
*                                                               01S0295 00333000
*   /*****************************************************************/ 00334000
*   /*                                                               */ 00335000
*   /* ATTENTION IS STATUS 8000.                                     */ 00336000
*   /*                                                               */ 00337000
*   /*****************************************************************/ 00338000
*                                                               01S0296 00339000
*/*ATTN: D (YES,MSG16,NO,SHARED) ATTN ?                              */ 00340000
*/*MSG16: P (,TERMEXIT) MSG ID = 16                                  */ 00341000
*   IF CSWATTN = ON THEN                                        01S0296 00342000
@RF00291 TM    CSWATTN+24(IODBREG),B'10000000'                  01S0296 00343000
         BNO   @RF00296                                         01S0296 00344000
*     DO;                           /* ATTENTION CONDITION           */ 00345000
*       ERBID = MSGATTN;            /* SET UP ATTENTION MSG ID       */ 00346000
         MVI   ERBID(CCTREG),X'10'                              01S0298 00347000
*       GO TO TERMEXIT;             /* TERMINATE I/O                 */ 00348000
         B     TERMEXIT                                         01S0299 00349000
*     END;                                                      01S0300 00350000
*                                                               01S0301 00351000
*   /*****************************************************************/ 00352000
*   /*                                                               */ 00353000
*   /* THE ONLY REMAINING CONDITIONS ARE STATUS MODIFIER AND BUSY.   */ 00354000
*   /* STATUS 5000 INDICATES CONTROL UNIT BUSY.THIS IS NORMAL FOR    */ 00355000
*   /* SHARED D.A. CONTROL UNIT END STATUS 2000 IS ALSO NORMAL ON    */ 00356000
*   /* SHARED D.A. THIS IS THE NORMAL - ALL SYSTEMS ARE GO - ERRORS  */ 00357000
*   /* CORRECTED - PATH                                              */ 00358000
*   /*                                                               */ 00359000
*   /*****************************************************************/ 00360000
*                                                               01S0301 00361000
*/*SHARED: N ONLY POSSIBLE REMAINING CONDITIONS ARE STAT MOD         */ 00362000
*/* N BUSY AND CONTROL UNIT END - THIS IS SIO ENTRY FOR SHARED DA    */ 00363000
*/*DRC0: R RETURN CODE = 0                                           */ 00364000
*                                                               01S0301 00365000
*DRC0:                                                          01S0301 00366000
*   RETURN CODE(0);                 /* ZERO RETURN CODE-PROCESSING      00367000
*                                      COMPLETED                     */ 00368000
@RF00296 DS    0H                                               01S0301 00369000
DRC0     SLR   @15,@15                                          01S0301 00370000
         L     @13,4(,@13)                                      01S0301 00371000
         L     @14,12(,@13)                                     01S0301 00372000
         LM    @00,@12,20(@13)                                  01S0301 00373000
         BR    @14                                              01S0301 00374000
*                                                               01S0302 00375000
*   /*****************************************************************/ 00376000
*   /*                                                               */ 00377000
*   /* THIS IS THE PRIMARY RETRY ROUTINE FOR DER                     */ 00378000
*   /*                                                               */ 00379000
*   /*****************************************************************/ 00380000
*                                                               01S0302 00381000
*/*REPEATOP: S AMDSAERP:SVC 21 RETRY I/O OPERATION                   */ 00382000
*/* D (YES,CCC,NO,DRC0) ERROR ON RETRY OPERATION ?                   */ 00383000
*                                                               01S0302 00384000
*REPEATOP:                                                      01S0302 00385000
*   SVC (ERPSVC);                   /* RETRY FAILING CCW             */ 00386000
REPEATOP SVC   21                                               01S0302 00387000
*   RESPECIFY RETCODE RESTRICTED;                               01S0303 00388000
*   IF RETCODE ^= ZERO THEN                                     01S0304 00389000
         SLR   @14,@14                                          01S0304 00390000
         CR    RETCODE,@14                                      01S0304 00391000
         BNE   @RT00304                                         01S0304 00392000
*     GO TO CCC;                    /* IF I/O ERROR TRY TO CORRECT      00393000
*                                      THE ERROR CONDITION           */ 00394000
*   IF IODBBCT ^= ZERO THEN         /* IS THERE A BCT                */ 00395000
         L     @10,IODBBCT(,IODBREG)                            01S0306 00396000
         CR    @10,@14                                          01S0306 00397000
         BE    @RF00306                                         01S0306 00398000
*     BCTCOMP = ON;                 /* YES--THEN MARK I/O COMPLETED     00399000
*                                      FOR BUFFER                    */ 00400000
         OI    BCTCOMP(@10),B'10000000'                         01S0307 00401000
*   GO TO DRC0;                     /* NORMAL RETURN                 */ 00402000
         B     DRC0                                             01S0308 00403000
*   RESPECIFY RETCODE UNRESTRICTED;                             01S0309 00404000
*                                                               01S0309 00405000
*   /*****************************************************************/ 00406000
*   /*                                                               */ 00407000
*   /* THIS IS THE ERROR EXIT LOCATION. MESSAGES AMD033I AND AMD034I */ 00408000
*   /* ARE ISSUED AS APPROPRIATE, THE TERMINATION FLAGS SET TO       */ 00409000
*   /* INDICATE AN UNCORRECTABLE I/O ERROR AND THE RETURN PATH TAKEN */ 00410000
*   /*                                                               */ 00411000
*   /*****************************************************************/ 00412000
*                                                               01S0310 00413000
*/*TERMEXIT: S AMDSAERM:SVC 7 TO OUTPUT ERROR MSG                    */ 00414000
*/* P IODBTERM = 1                                                   */ 00415000
*/* P IODBIOC = 1                                                    */ 00416000
*/* R RETURN TO CALLER CODE = 4                                      */ 00417000
*                                                               01S0310 00418000
*TERMEXIT:                                                      01S0310 00419000
*   R1 = ERBID;                     /* PICK UP ERROR ERB IDENTIFIER  */ 00420000
TERMEXIT SLR   R1,R1                                            01S0310 00421000
         IC    R1,ERBID(,CCTREG)                                01S0310 00422000
*   SVC (ERMSVC);                   /* ISSUE MESSAGE(S)              */ 00423000
         SVC   7                                                01S0311 00424000
*   IF CSWATTN = ON | CSWCDC = ON | CSWCCC = ON | CSWICC = ON | 01S0312 00425000
*         CSWCHC = ON | SENIR = ON THEN /* IS THIS ERROR PERMANMENT     00426000
*                                      FOR THE DEVICE                */ 00427000
         LA    @10,24                                           01S0312 00428000
         ALR   @10,IODBREG                                      01S0312 00429000
         TM    CSWATTN(@10),B'10000000'                         01S0312 00430000
         BO    @RT00312                                         01S0312 00431000
         TM    CSWCDC(@10),B'00001111'                          01S0312 00432000
         BNZ   @RT00312                                         01S0312 00433000
         TM    SENIR(IODBREG),B'01000000'                       01S0312 00434000
         BNO   @RF00312                                         01S0312 00435000
@RT00312 DS    0H                                               01S0313 00436000
*     IODBTERM = ON;                /* PERMANENT ERROR ON DEVICE     */ 00437000
         OI    IODBTERM(IODBREG),B'10000000'                    01S0313 00438000
*   IODBIOC = ON;                   /* I/O ERROR PROCESSING A RECORD */ 00439000
@RF00312 OI    IODBIOC(IODBREG),B'00010000'                     01S0314 00440000
*   IF IODBBCT ^= ZERO THEN         /* IS THERE A BCT                */ 00441000
         L     @10,IODBBCT(,IODBREG)                            01S0315 00442000
         LTR   @10,@10                                          01S0315 00443000
         BZ    @RF00315                                         01S0315 00444000
*     DO;                                                       01S0316 00445000
*       BCTCOMP = ON;               /* INDICATE BUFFER PROCESSING       00446000
*                                      COMPLETED                     */ 00447000
*       BCTIOERR = ON;              /* RECORD IN ERROR               */ 00448000
         OI    BCTCOMP(@10),B'10100000'                         01S0318 00449000
*     END;                                                      01S0319 00450000
*   RETURN CODE(4);                 /* ERROR RETURN CODE             */ 00451000
@RF00315 LA    @15,4                                            01S0320 00452000
         L     @13,4(,@13)                                      01S0320 00453000
         L     @14,12(,@13)                                     01S0320 00454000
         LM    @00,@12,20(@13)                                  01S0320 00455000
         BR    @14                                              01S0320 00456000
*                                                               02S0321 00457000
*   /*****************************************************************/ 00458000
*   /*                                                               */ 00459000
*   /* COMMAND REJECT ROUTINE - COMMON FOR ALL DEVICES               */ 00460000
*   /*                                                               */ 00461000
*   /*****************************************************************/ 00462000
*                                                               02S0321 00463000
*/*CCMDRJT: P (,TERMEXIT) MSG ID = 00                                */ 00464000
*                                                               02S0321 00465000
*CCMDRJT:                                                       02S0321 00466000
*   ERBID = MSGCR;                  /* SET MESSAGE ID                */ 00467000
CCMDRJT  MVI   ERBID(CCTREG),X'00'                              02S0321 00468000
*   GO TO TERMEXIT;                 /* AND EXIT                      */ 00469000
*                                                               02S0322 00470000
         B     TERMEXIT                                         02S0322 00471000
*   /*****************************************************************/ 00472000
*   /*                                                               */ 00473000
*   /* BUS OUT CHECK - COMMON FOR ALL DEVICES                        */ 00474000
*   /*                                                               */ 00475000
*   /*****************************************************************/ 00476000
*                                                               02S0323 00477000
*/*CBUSOUT: S AMDSAERB: SVC 20 DAERB, CC=02, PCT=1, SCT=0            */ 00478000
*/* N (,REPEATOP) REPEAT OPERATION                                   */ 00479000
*                                                               02S0323 00480000
*CBUSOUT:                                                       02S0323 00481000
*   ERBPID = MSGBOC;                /* SET MESSAGE ID                */ 00482000
CBUSOUT  MVI   ERBPID,X'02'                                     02S0323 00483000
*   ERBSCT = ZERO;                  /* SET SECONDARY RETRY COUNT     */ 00484000
         MVI   ERBSCT,X'00'                                     02S0324 00485000
*   ERBPCT = ONE;                   /* SET PRIMARY RETRY COUNT       */ 00486000
         MVI   ERBPCT,X'01'                                     02S0325 00487000
*   R1 = ADDR(ERBPARM);             /* SET INPUT REG                 */ 00488000
         LA    R1,ERBPARM                                       02S0326 00489000
*   SVC (ERBSVC);                   /* UPDATE ERB                    */ 00490000
         SVC   20                                               02S0327 00491000
*   GO TO REPEATOP;                 /* RETRY OPERATION               */ 00492000
*                                                               02S0328 00493000
         B     REPEATOP                                         02S0328 00494000
*   /*****************************************************************/ 00495000
*   /*                                                               */ 00496000
*   /* INTERVENTION REQUIRED ROUTINE - COMMON FOR ALL DEVICES        */ 00497000
*   /*                                                               */ 00498000
*   /*****************************************************************/ 00499000
*                                                               02S0329 00500000
*/*CINTVREQ: S AMDSABIN:SVC 28 CONVERT DDD IN IODBDEV TO EBCDIC      */ 00501000
*/* P PLACE DEVICE ADDR IN DEV14A                                    */ 00502000
*/* P PLACE DEVICE ADDR IN DEV12D                                    */ 00503000
*/* L AMDSAINR: ISSUE MESSAGE AMD014A AND WAIT                       */ 00504000
*/* D (YES,,NO,MSG01) WAS INTRPT REQUESTED OKAY                      */ 00505000
*/* S AMDSAERB:SVC 20 DAERB, CC=01, PCT =1, SCT = 0                  */ 00506000
*/* N (,REPEATOP) RETRY I/O OPERATION                                */ 00507000
*/*MSG01: P (,TERMEXIT) MSG ID = 01                                  */ 00508000
*                                                               02S0329 00509000
*CINTVREQ:                                                      02S0329 00510000
*   BININ = ADDR(IODBDEV);          /* SET ADDRESS OF DATA TO BE        00511000
*                                      CONVERTED                     */ 00512000
CINTVREQ LA    @10,IODBDEV(,IODBREG)                            02S0329 00513000
         ST    @10,BININ                                        02S0329 00514000
*   RESPECIFY RETCODE RESTRICTED;   /* RESTRICT REGISTERS            */ 00515000
*   R1 = ADDR(BINPLIST);            /* SET POINTER TO PLIST FOR BIN  */ 00516000
         LA    R1,BINPLIST                                      02S0331 00517000
*   SVC (BINSVC);                   /* CONVERT DEVICE ADDRESS TO        00518000
*                                      EBCDIC                        */ 00519000
         SVC   28                                               02S0332 00520000
*   DEV14A = BINDEV;                /* PUT CONVERTED ADDRESS INTO       00521000
*                                      MESSAGE                       */ 00522000
         L     @14,@CA00781                                     02S0333 00523000
         MVC   DEV14A-DEV14A(3,@14),BINDEV                      02S0333 00524000
*   DEV12D = BINDEV;                /* AND INTO OTHER MESSAGE        */ 00525000
         L     @14,@CA00782                                     02S0334 00526000
         MVC   DEV12D-DEV12D(3,@14),BINDEV                      02S0334 00527000
*   R1 = AMD014A;                   /* SET POINTER TO MESSAGE TO        00528000
*                                      PRINT                         */ 00529000
         LA    R1,14                                            02S0335 00530000
*   SVC (INRSVC);                   /* WAIT FOR INTERVENTION         */ 00531000
         SVC   29                                               02S0336 00532000
*   IF RETCODE ^= ZERO THEN         /* ANY PROBLEM IN INR            */ 00533000
         LTR   RETCODE,RETCODE                                  02S0337 00534000
         BZ    @RF00337                                         02S0337 00535000
*     DO;                                                       02S0338 00536000
*       ERBID = MSGIR;              /* SET MESSAGE ID                */ 00537000
         MVI   ERBID(CCTREG),X'01'                              02S0339 00538000
*       GO TO TERMEXIT;             /* AND EXIT                      */ 00539000
         B     TERMEXIT                                         02S0340 00540000
*     END;                                                      02S0341 00541000
*   RESPECIFY RETCODE UNRESTRICTED; /* RELEASE REGISTERS             */ 00542000
@RF00337 DS    0H                                               02S0343 00543000
*   ERBPID = MSGIR;                 /* SET MESSAGE ID                */ 00544000
         MVI   ERBPID,X'01'                                     02S0343 00545000
*   ERBSCT = ZERO;                  /* SET SECONDARY RETRY COUNT     */ 00546000
         MVI   ERBSCT,X'00'                                     02S0344 00547000
*   ERBPCT = ONE;                   /* SET PRIMARY RETRY COUNT       */ 00548000
         MVI   ERBPCT,X'01'                                     02S0345 00549000
*   R1 = ADDR(ERBPARM);             /* SET INPUT REG                 */ 00550000
         LA    R1,ERBPARM                                       02S0346 00551000
*   SVC (ERBSVC);                   /* UPDATE ERB                    */ 00552000
         SVC   20                                               02S0347 00553000
*   GO TO REPEATOP;                 /* RETRY OPERATION               */ 00554000
*                                                               02S0348 00555000
         B     REPEATOP                                         02S0348 00556000
*   /*****************************************************************/ 00557000
*   /*                                                               */ 00558000
*   /* PERMENANT ERROR ROUTINE FOR 2305, 3330 AND 3350       @Z30RSTA*/ 00559000
*   /*                                                               */ 00560000
*   /*****************************************************************/ 00561000
*                                                               02S0349 00562000
*/*CPERMERR: D (YES,,NO,CPERMDC) EQUIPMENT CK ?                      */ 00563000
*/* P (,TERMEXIT) MESSAGE ID = 03                                    */ 00564000
*/*CPERMDC: D (YES,,NO,CPERMO) DATA CHECK ?                          */ 00565000
*/* P (,TERMEXIT) MESSAGE ID = 04                                    */ 00566000
*/*CPERMO: D (YES,,NO,CPERM08) OVERRUN ?                             */ 00567000
*/* P (,TERMEXIT) MESSAGE ID = 05                                    */ 00568000
*/*CPERM08: P (,TERMEXIT) MESSAGE ID = 08                            */ 00569000
*                                                               02S0349 00570000
*CPERMERR:                                                      02S0349 00571000
*   IF SENEC = ON THEN              /* IF EQUIPMENT CHECK AND   02S0349 00572000
*                                      PERMANENT ERROR               */ 00573000
CPERMERR TM    SENEC(IODBREG),B'00010000'                       02S0349 00574000
         BNO   @RF00349                                         02S0349 00575000
*     DO;                                                       02S0350 00576000
*       ERBID = MSGEC;              /* SET MESSAGE ID                */ 00577000
         MVI   ERBID(CCTREG),X'03'                              02S0351 00578000
*       GO TO TERMEXIT;             /* AND EXIT                      */ 00579000
         B     TERMEXIT                                         02S0352 00580000
*     END;                                                      02S0353 00581000
*   IF SENDC = ON THEN              /* IF DATA CHECK AND PERMANENT      00582000
*                                      ERROR                         */ 00583000
@RF00349 TM    SENDC(IODBREG),B'00001000'                       02S0354 00584000
         BNO   @RF00354                                         02S0354 00585000
*     DO;                                                       02S0355 00586000
*       ERBID = MSGDC;              /* SET MESSAGE ID                */ 00587000
         MVI   ERBID(CCTREG),X'04'                              02S0356 00588000
*       GO TO TERMEXIT;             /* AND EXIT                      */ 00589000
         B     TERMEXIT                                         02S0357 00590000
*     END;                                                      02S0358 00591000
*   IF SENOR = ON THEN              /* IF OVERRUN AND PERMANENT ERROR*/ 00592000
@RF00354 TM    SENOR(IODBREG),B'00000100'                       02S0359 00593000
         BNO   @RF00359                                         02S0359 00594000
*     DO;                                                       02S0360 00595000
*       ERBID = MSGOR;              /* SET MESSAGE ID                */ 00596000
         MVI   ERBID(CCTREG),X'05'                              02S0361 00597000
*       GO TO TERMEXIT;             /* AND EXIT                      */ 00598000
         B     TERMEXIT                                         02S0362 00599000
*     END;                                                      02S0363 00600000
*   ERBID = MSGPE;                  /* SET PERMANENT ERROR MESSAGE ID*/ 00601000
@RF00359 MVI   ERBID(CCTREG),X'08'                              02S0364 00602000
*   GO TO TERMEXIT;                 /* AND EXIT                      */ 00603000
*                                                               02S0365 00604000
         B     TERMEXIT                                         02S0365 00605000
*   /*****************************************************************/ 00606000
*   /*                                                               */ 00607000
*   /* EQUIPMENT CHECK ROUTINE FOR ALL DEVICES                       */ 00608000
*   /*                                                               */ 00609000
*   /*****************************************************************/ 00610000
*                                                               02S0366 00611000
*/*CEQUCK: S AMDSAERB:SVC 20 DAERB, CC=03, PCT=10, SCT=0             */ 00612000
*/* N (,REPEATOP) RETRY OPERATION                                    */ 00613000
*                                                               02S0366 00614000
*CEQUCK:                                                        02S0366 00615000
*   ERBPID = MSGEC;                 /* SET MESSAGE ID                */ 00616000
CEQUCK   MVI   ERBPID,X'03'                                     02S0366 00617000
*   ERBSCT = ZERO;                  /* SET SECONDARY RETRY COUNT     */ 00618000
         MVI   ERBSCT,X'00'                                     02S0367 00619000
*   ERBPCT = TEN;                   /* SET PRIMARY RETRY COUNT       */ 00620000
         MVI   ERBPCT,X'0A'                                     02S0368 00621000
*   R1 = ADDR(ERBPARM);             /* SET INPUT REG                 */ 00622000
         LA    R1,ERBPARM                                       02S0369 00623000
*   SVC (ERBSVC);                   /* UPDATE ERB                    */ 00624000
         SVC   20                                               02S0370 00625000
*   GO TO REPEATOP;                 /* NOW REPEAT LAST OPERATION     */ 00626000
         B     REPEATOP                                         02S0371 00627000
*/*** 2314 ERROR RECOVERY ROUTINE                                    */ 00628000
*                                                               02S0372 00629000
*   /*****************************************************************/ 00630000
*   /*                                                               */ 00631000
*   /* EQUIPMENT CHECK--SENSE BYTE 0 BIT 3 IS HANDLED FIRST IN COMMON*/ 00632000
*   /* CODE . THEN NO RECORD FOUND--SENSE BYTE 1 BIT 4 IS HANDLED    */ 00633000
*   /*                                                               */ 00634000
*   /*****************************************************************/ 00635000
*                                                               02S0372 00636000
*/*D2314: N THIS SECTION HANDLES 2314 ERROR RECOVERY                 */ 00637000
*/* D (YES,CEQUCK,NO,D2314NRF) EQU CK ?                              */ 00638000
*/*D2314NRF: D (YES,,NO,D2314SC) NO RECORD FOUND ?                   */ 00639000
*/* D (YES,MAMREC,NO,MAMRHA) MISSING ADDRESS MARKERS ?               */ 00640000
*/*MAMRHA: P R11 = READ HOME ADDRESS                                 */ 00641000
*/* N SET UP FOR SEEK AND READ HOME ADDRESS                          */ 00642000
*/* S AMDSAERI:SVC 23 ISSUE READ HOME ADDRESS                        */ 00643000
*/* D (YES,ERRID,NO,) ERROR ON RHA ?                                 */ 00644000
*/* D (YES,,NO,MAMREC) CCHH OF ORIGINAL ?                            */ 00645000
*/* P (,TERMEXIT) MESSAGE ID = 12                                    */ 00646000
*/*MAMREC: P SET UP FOR RECALIBRATE CMD IN R11                       */ 00647000
*/* N RECALIBRATE CCW                                                */ 00648000
*/* S AMDSAERI:SVC 23 ISSUE RECALIBRATE COMMAND                      */ 00649000
*/* D (YES,ERRID,NO,MAMREP) ERROR ON CMD ?                           */ 00650000
*/*ERRID: P (,TERMEXIT) MESSAGE ID = 31                              */ 00651000
*/*MAMREP: S AMDSAERB:SVC 20 DAERB, CC=12, PCT=10, SCT = 0           */ 00652000
*/* N (,REPEATOP) REPEAT I/O OPERATION                               */ 00653000
*                                                               02S0372 00654000
*D2314:                                                         02S0372 00655000
*   IF SENEC = ON THEN              /* IF EQUIPMENT CHECK            */ 00656000
D2314    TM    SENEC(IODBREG),B'00010000'                       02S0372 00657000
         BO    @RT00372                                         02S0372 00658000
*     GO TO CEQUCK;                 /* HANDLE IN COMMON CODE         */ 00659000
*   IF SENNRF = ON THEN             /* IF NO RECORD FOUND            */ 00660000
         TM    SENNRF(IODBREG),B'00001000'                      02S0374 00661000
         BNO   @RF00374                                         02S0374 00662000
*     DO;                                                       02S0375 00663000
*       IF SENMAM = OFF THEN        /* BUT NO MISSING ADDRESS MARKER */ 00664000
         TM    SENMAM(IODBREG),B'00000010'                      02S0376 00665000
         BNZ   @RF00376                                         02S0376 00666000
*         DO;                                                   02S0377 00667000
*           RESPECIFY (R11,RETCODE) RESTRICTED; /* RESTRICT REGISTERS*/ 00668000
*           R11 = ADDR(RESRHA);     /* SET ADDRESS OF READ HOME 02S0379 00669000
*                                      ADDRESS CCW                   */ 00670000
         LA    R11,RESRHA                                       02S0379 00671000
*           SVC (ERISVC);           /* ISSUE SIO FOR RHA             */ 00672000
         SVC   23                                               02S0380 00673000
*           IF RETCODE ^= ZERO THEN /* WAS SIO SUCCESSFUL            */ 00674000
         LTR   RETCODE,RETCODE                                  02S0381 00675000
         BNZ   @RT00381                                         02S0381 00676000
*             GO TO ERRID;          /* NO--ISSUE MESSAGE             */ 00677000
*           RESPECIFY (R11,RETCODE) UNRESTRICTED; /* RELEASE    02S0383 00678000
*                                      REGISTERS                     */ 00679000
*           IF RESCCHH = IODBSRCH THEN /* IS THIS THE TRACK WANTED   */ 00680000
         CLC   RESCCHH(4),IODBSRCH(IODBREG)                     02S0384 00681000
         BNE   @RF00384                                         02S0384 00682000
*             DO;                                               02S0385 00683000
*               ERBID = MSGNRF;     /* YES--SOMETHING IS WRONG--SET     00684000
*                                      MESSAGE ID                    */ 00685000
         MVI   ERBID(CCTREG),X'0C'                              02S0386 00686000
*               GO TO TERMEXIT;     /* AND EXIT                      */ 00687000
         B     TERMEXIT                                         02S0387 00688000
*             END;                                              02S0388 00689000
*         END;                                                  02S0389 00690000
@RF00384 DS    0H                                               02S0390 00691000
*       RESPECIFY (R11,RETCODE) RESTRICTED; /* RESTICT REGISTERS     */ 00692000
@RF00376 DS    0H                                               02S0391 00693000
*       R11 = ADDR(RECALBTE);       /* EITHER MISSING ADDRESS MARKER    00694000
*                                      OR READ HOME ADDRESS READ        00695000
*                                      RECORD DIFFERENT FROM SEARCH  */ 00696000
         LA    R11,RECALBTE                                     02S0391 00697000
*       SVC (ERISVC);               /* SO ISSUE RECALIBRATE CCW      */ 00698000
         SVC   23                                               02S0392 00699000
*       IF RETCODE ^= ZERO THEN     /* WAS RECALIBRATE SUCCESSFUL    */ 00700000
         LTR   RETCODE,RETCODE                                  02S0393 00701000
         BZ    @RF00393                                         02S0393 00702000
*         DO;                                                   02S0394 00703000
*                                                               02S0394 00704000
*ERRID:                                                         02S0395 00705000
*           ERBID = MSGERR;         /* NO--ISSUE GENERAL ERROR  02S0395 00706000
*                                      MESSAGE                       */ 00707000
ERRID    MVI   ERBID(CCTREG),X'1F'                              02S0395 00708000
*           GO TO TERMEXIT;         /* AND EXIT                      */ 00709000
         B     TERMEXIT                                         02S0396 00710000
*         END;                                                  02S0397 00711000
*       RESPECIFY (R11,RETCODE) UNRESTRICTED; /* RELEASE REGISTERS   */ 00712000
@RF00393 DS    0H                                               02S0399 00713000
*       ERBPID = MSGNRF;            /* SET MESSAGE ID                */ 00714000
         MVI   ERBPID,X'0C'                                     02S0399 00715000
*       ERBSCT = ZERO;              /* SET SECONDARY RETRY COUNT     */ 00716000
         MVI   ERBSCT,X'00'                                     02S0400 00717000
*       ERBPCT = TEN;               /* SET PRIMARY RETRY COUNT       */ 00718000
         MVI   ERBPCT,X'0A'                                     02S0401 00719000
*       R1 = ADDR(ERBPARM);         /* SET INPUT REG                 */ 00720000
         LA    R1,ERBPARM                                       02S0402 00721000
*       SVC (ERBSVC);               /* UPDATE ERB                    */ 00722000
         SVC   20                                               02S0403 00723000
*       GO TO REPEATOP;             /* RETRY OPERATION               */ 00724000
         B     REPEATOP                                         02S0404 00725000
*     END;                                                      02S0405 00726000
*                                                               02S0405 00727000
*   /*****************************************************************/ 00728000
*   /*                                                               */ 00729000
*   /* THE FOLLOWING CODE HANDLES SEEK CHECK--SENSE BYTE 0 BIT 7.    */ 00730000
*   /* INTERVENTION REQUIRED--SENSE BYTE 0 BIT 1 AND BUS OUT         */ 00731000
*   /* CHECK--SENSE BYTE 0 BIT 2 ARE HANDLED IN COMMON CODE.         */ 00732000
*   /*                                                               */ 00733000
*   /*****************************************************************/ 00734000
*                                                               02S0406 00735000
*/*D2314SC: D (YES,,NO,D2314IR) SEEK CK ?                            */ 00736000
*/* D (YES,MSG07,NO,D2314CR) COMMAND REJECT ?                        */ 00737000
*/*MSG07: P (,TERMEXIT) MSG ID = 07                                  */ 00738000
*/*D2314CR: P SET UP TO RECALIBRATE IN R11                           */ 00739000
*/* N THIS IS THE RECALIBRATE CCW                                    */ 00740000
*/* S AMDSAERI:SVC 23 ISSUE RECALIBRATE COMMAND                      */ 00741000
*/* D (YES,ERRID,NO,) ERROR ON CMD ?                                 */ 00742000
*/* S (,REPEATOP) AMDSAERB:SVC 20 DAERB, CC=7, PCT=10, SCT=0         */ 00743000
*/*D2314IR: D (YES,CINTVREQ,NO,D2314BO) INTV REQUIRED ?              */ 00744000
*/*D2314BO: D (YES,CBUSOUT,NO,D2314DC) BUSOUT CHECK ?                */ 00745000
*   IF SENSC = ON THEN              /* IF SEEK CHECK                 */ 00746000
@RF00374 TM    SENSC(IODBREG),B'00000001'                       02S0406 00747000
         BNO   @RF00406                                         02S0406 00748000
*     DO;                                                       02S0407 00749000
*       IF SENCR = ON THEN          /* AND IF COMMAND REJECT         */ 00750000
         TM    SENCR(IODBREG),B'10000000'                       02S0408 00751000
         BNO   @RF00408                                         02S0408 00752000
*         DO;                                                   02S0409 00753000
*           ERBID = MSGSCK;         /* SET MESSAGE ID                */ 00754000
         MVI   ERBID(CCTREG),X'07'                              02S0410 00755000
*           GO TO TERMEXIT;         /* AND EXIT                      */ 00756000
         B     TERMEXIT                                         02S0411 00757000
*         END;                                                  02S0412 00758000
*       RESPECIFY (R11,RETCODE) RESTRICTED; /* RESTRICT REGISTERS    */ 00759000
@RF00408 DS    0H                                               02S0414 00760000
*       R11 = ADDR(RECALBTE);       /* SET ADDRESS OF RECALIBRATE CCW*/ 00761000
         LA    R11,RECALBTE                                     02S0414 00762000
*       SVC (ERISVC);               /* SIO FOR RECALIBRATE CCW       */ 00763000
         SVC   23                                               02S0415 00764000
*       IF RETCODE ^= ZERO THEN     /* WAS SIO OKAY                  */ 00765000
         LTR   RETCODE,RETCODE                                  02S0416 00766000
         BNZ   @RT00416                                         02S0416 00767000
*         GO TO ERRID;              /* NO--GO ISSUE MESSAGE          */ 00768000
*       RESPECIFY (R11,RETCODE) UNRESTRICTED; /* RELEASE REGISTERS   */ 00769000
*       ERBPID = MSGSCK;            /* YES--SET UP MESSAGE ID        */ 00770000
         MVI   ERBPID,X'07'                                     02S0419 00771000
*       ERBSCT = ZERO;              /* SET SECONDARY RETRY COUNT     */ 00772000
         MVI   ERBSCT,X'00'                                     02S0420 00773000
*       ERBPCT = TEN;               /* SET PRIMARY RETRY COUNT       */ 00774000
         MVI   ERBPCT,X'0A'                                     02S0421 00775000
*       R1 = ADDR(ERBPARM);         /* SET INPUT REG                 */ 00776000
         LA    R1,ERBPARM                                       02S0422 00777000
*       SVC (ERBSVC);               /* UPDATE ERB                    */ 00778000
         SVC   20                                               02S0423 00779000
*       GO TO REPEATOP;             /* RETRY OPERATION               */ 00780000
         B     REPEATOP                                         02S0424 00781000
*     END;                                                      02S0425 00782000
*   IF SENIR = ON THEN              /* IF INTERVENTION REQUIRED      */ 00783000
@RF00406 TM    SENIR(IODBREG),B'01000000'                       02S0426 00784000
         BO    @RT00426                                         02S0426 00785000
*     GO TO CINTVREQ;               /* HANDLE IN COMMON CODE         */ 00786000
*   IF SENBO = ON THEN              /* IF BUS OUT CHECK              */ 00787000
         TM    SENBO(IODBREG),B'00100000'                       02S0428 00788000
         BO    @RT00428                                         02S0428 00789000
*     GO TO CBUSOUT;                /* HANDLE IN COMMON CODE         */ 00790000
*                                                               02S0429 00791000
*   /*****************************************************************/ 00792000
*   /*                                                               */ 00793000
*   /* THIS CODE HANDLES DATA CHECKS--SENSE BYTE 0 BIT 4.            */ 00794000
*   /*                                                               */ 00795000
*   /*****************************************************************/ 00796000
*                                                               02S0430 00797000
*/*D2314DC: D (YES,CDATACK,NO,D2314O) DATA CHECK ?                   */ 00798000
*/*CDATACK: S AMDSAERB:SVC 20 DAERB, CC=4, PCT=16, SCT=16            */ 00799000
*/* D (YES,,NO,REPEATOP) PCTR - 1 = 0 ?                              */ 00800000
*/* P R11 = ADDRESS OF RECALIBRATE CCW                               */ 00801000
*/* N ISSUE RECALIBRATE CCW                                          */ 00802000
*/* S AMDSAERI:SVC 23 ISSUE RECALIBRATE                              */ 00803000
*/* D (YES,ERRID,NO,REPEATOP) ERROR ON RECALIBRATE ?                 */ 00804000
*   IF SENDC = ON THEN              /* IF DATA CHECK                 */ 00805000
         TM    SENDC(IODBREG),B'00001000'                       02S0430 00806000
         BNO   @RF00430                                         02S0430 00807000
*     DO;                                                       02S0431 00808000
*       ERBPID = MSGDC;             /* SET MESSAGE ID                */ 00809000
         MVI   ERBPID,X'04'                                     02S0432 00810000
*       ERBSCT = SIXTEEN;           /* SET SECONDARY RETRY COUNT     */ 00811000
         MVI   ERBSCT,X'10'                                     02S0433 00812000
*       ERBPCT = SIXTEEN;           /* SET PRIMARY RETRY COUNT       */ 00813000
         MVI   ERBPCT,X'10'                                     02S0434 00814000
*       R1 = ADDR(ERBPARM);         /* SET INPUT REG                 */ 00815000
         LA    R1,ERBPARM                                       02S0435 00816000
*       SVC (ERBSVC);               /* UPDATE ERB (NOTE--THIS WILL      00817000
*                                      REDUCE PCT COUNT)             */ 00818000
         SVC   20                                               02S0436 00819000
*       IF ERBPCTR ^= ONE THEN      /* HAVE SIXTEEN PRIMARY RETRIES     00820000
*                                      BEEN DONE                     */ 00821000
         CLI   ERBPCTR(CCTREG),1                                02S0437 00822000
         BNE   @RT00437                                         02S0437 00823000
*         GO TO REPEATOP;           /* NO--RETRY OPERATION           */ 00824000
*       RESPECIFY (R11,RETCODE) RESTRICTED; /* RESTRICT REGISTERS    */ 00825000
*       R11 = ADDR(RECALBTE);       /* YES--ISSUE RECALIBRATE FOR       00826000
*                                      SECONDARY RETRY               */ 00827000
         LA    R11,RECALBTE                                     02S0440 00828000
*       SVC (ERISVC);               /* SIO FOR RECALIBRATE           */ 00829000
         SVC   23                                               02S0441 00830000
*       IF RETCODE ^= ZERO THEN     /* WAS SIO OKAY                  */ 00831000
         LTR   RETCODE,RETCODE                                  02S0442 00832000
         BNZ   @RT00442                                         02S0442 00833000
*         GO TO ERRID;              /* NO--GO ISSUE MESSAGE          */ 00834000
*       RESPECIFY (R11,RETCODE) UNRESTRICTED; /* RELEASE REGISTERS   */ 00835000
*       GO TO REPEATOP;             /* RETRY OPERATION               */ 00836000
         B     REPEATOP                                         02S0445 00837000
*     END;                                                      02S0446 00838000
*                                                               02S0446 00839000
*   /*****************************************************************/ 00840000
*   /*                                                               */ 00841000
*   /* THIS CODE HANDLES OVERRUN--SENSE BYTE 0 BIT 5 AND MISSING     */ 00842000
*   /* ADDRESS MARKER--SENSE BYTE 1 BIT 6. COMMAND REJECT--SENSE BYTE*/ 00843000
*   /* 0 BIT 0 IS HANDLED IN COMMON CODE.                            */ 00844000
*   /*                                                               */ 00845000
*   /*****************************************************************/ 00846000
*                                                               02S0447 00847000
*/*D2314O: D (YES,COVERRUN,NO,D2314MAD) OVERRUN ?                    */ 00848000
*/*COVERRUN: S AMDSAERB:SVC 20 DAERB, CC=5, PCT=10, SCT=0            */ 00849000
*/* N (,REPEATOP) REPEAT I/O OPERATION                               */ 00850000
*/*D2314MAD: D (YES,CMISADR,NO,D2314CMD) MISSING ADDR MARKERS ?      */ 00851000
*/*CMISADR: S AMDSAERB:SVC 20 DAERB, CC=15, PCT=10, SCT=0            */ 00852000
*/* N (,REPEATOP) REPEAT I/O OPERATION                               */ 00853000
*/*D2314CMD: D (YES,CCMDRJT,NO,TCC) CMD REJECT ?                     */ 00854000
*   IF SENOR = ON THEN              /* IF OVERRUN                    */ 00855000
@RF00430 TM    SENOR(IODBREG),B'00000100'                       02S0447 00856000
         BNO   @RF00447                                         02S0447 00857000
*     DO;                                                       02S0448 00858000
*       ERBPID = MSGOR;             /* SET MESSAGE ID                */ 00859000
         MVI   ERBPID,X'05'                                     02S0449 00860000
*       ERBSCT = ZERO;              /* SET SECONDARY RETRY COUNT     */ 00861000
         MVI   ERBSCT,X'00'                                     02S0450 00862000
*       ERBPCT = TEN;               /* SET PRIMARY RETRY COUNT       */ 00863000
         MVI   ERBPCT,X'0A'                                     02S0451 00864000
*       R1 = ADDR(ERBPARM);         /* SET INPUT REG                 */ 00865000
         LA    R1,ERBPARM                                       02S0452 00866000
*       SVC (ERBSVC);               /* UPDATE ERB                    */ 00867000
         SVC   20                                               02S0453 00868000
*       GO TO REPEATOP;             /* RETRY OPERATION               */ 00869000
         B     REPEATOP                                         02S0454 00870000
*     END;                                                      02S0455 00871000
*   IF SENMAM = ON THEN             /* IF MISSING ADDRESS MARKER     */ 00872000
@RF00447 TM    SENMAM(IODBREG),B'00000010'                      02S0456 00873000
         BNO   @RF00456                                         02S0456 00874000
*     DO;                                                       02S0457 00875000
*       ERBPID = MSGMAM;            /* SET MESSAGE ID                */ 00876000
         MVI   ERBPID,X'0F'                                     02S0458 00877000
*       ERBSCT = ZERO;              /* SET SECONDARY RETRY COUNT     */ 00878000
         MVI   ERBSCT,X'00'                                     02S0459 00879000
*       ERBPCT = TEN;               /* PRIMARY RETRY COUNT           */ 00880000
         MVI   ERBPCT,X'0A'                                     02S0460 00881000
*       R1 = ADDR(ERBPARM);         /* SET INPUT REG                 */ 00882000
         LA    R1,ERBPARM                                       02S0461 00883000
*       SVC (ERBSVC);               /* UPDATE ERB                    */ 00884000
         SVC   20                                               02S0462 00885000
*       GO TO REPEATOP;             /* RETRY OPERATION               */ 00886000
         B     REPEATOP                                         02S0463 00887000
*     END;                                                      02S0464 00888000
*   IF SENCR = ON THEN              /* IF COMMAND REJECT             */ 00889000
@RF00456 TM    SENCR(IODBREG),B'10000000'                       02S0465 00890000
         BO    @RT00465                                         02S0465 00891000
*     GO TO CCMDRJT;                /* HANDLE IN COMMON CODE         */ 00892000
*                                                               02S0466 00893000
*   /*****************************************************************/ 00894000
*   /*                                                               */ 00895000
*   /* THIS CODE HANDLES TRACK CONDITION CHECK--SENSE BYTE 0 BIT 6   */ 00896000
*   /* END OF CYLINDER--SENSE BYTE 1 BIT 2 AND FILE PROTECT--SENSE   */ 00897000
*   /* BYTE 1 BIT 5.                                                 */ 00898000
*   /*                                                               */ 00899000
*   /*****************************************************************/ 00900000
*                                                               02S0467 00901000
*/*TCC: D (YES,ALTRK,NO,EOC) TRK COND CHK ?                          */ 00902000
*/*EOC: D (YES,MSG10,NO,FP) END OF CYLINDER ?                        */ 00903000
*/*MSG10: P (,TERMEXIT) MSG ID = 10                                  */ 00904000
*/*FP: D (YES,MSG13,NO,MSG31) FILE PROTECT ?                         */ 00905000
*/*MSG13: P (,TERMEXIT) MSG ID = 13                                  */ 00906000
*/*MSG31: P (,TERMEXIT) MSG ID = 29                                  */ 00907000
*   IF SENTCC = ON THEN             /* IF TRACK CONDITION CHECK      */ 00908000
         TM    SENTCC(IODBREG),B'00000010'                      02S0467 00909000
         BO    @RT00467                                         02S0467 00910000
*     GO TO ALTRK;                  /* HANDLE AS ALTERNATE TRACK     */ 00911000
*   IF SENEOC = ON THEN             /* IF END OF CYLINDER            */ 00912000
         TM    SENEOC(IODBREG),B'00100000'                      02S0469 00913000
         BNO   @RF00469                                         02S0469 00914000
*     DO;                                                       02S0470 00915000
*       ERBID = MSGEOC;             /* SET MESSAGE ID                */ 00916000
         MVI   ERBID(CCTREG),X'0A'                              02S0471 00917000
*       GO TO TERMEXIT;             /* AND EXIT                      */ 00918000
         B     TERMEXIT                                         02S0472 00919000
*     END;                                                      02S0473 00920000
*   IF SENFP = ON THEN              /* IF FILE PROTECT               */ 00921000
@RF00469 TM    SENFP(IODBREG),B'00000100'                       02S0474 00922000
         BNO   @RF00474                                         02S0474 00923000
*     DO;                                                       02S0475 00924000
*       ERBID = MSGFP;              /* SET MESSAGE ID                */ 00925000
         MVI   ERBID(CCTREG),X'0D'                              02S0476 00926000
*       GO TO TERMEXIT;             /* AND EXIT                      */ 00927000
         B     TERMEXIT                                         02S0477 00928000
*     END;                                                      02S0478 00929000
*   ERBID = MSGUNK;                 /* SET GENERAL MESSAGE ID        */ 00930000
@RF00474 MVI   ERBID(CCTREG),X'1D'                              02S0479 00931000
*   GO TO TERMEXIT;                 /* AND EXIT                      */ 00932000
*                                                               02S0480 00933000
         B     TERMEXIT                                         02S0480 00934000
*   /*****************************************************************/ 00935000
*   /*                                                               */ 00936000
*   /* NO OTHER CONDITIONS ARE EXPECTED FROM A 2314. IF OTHER        */ 00937000
*   /* CONDITIONS OCCUR THEY ARE DO TO HARDWARE OR PROGRAMMING       */ 00938000
*   /* ERRORS.                                                       */ 00939000
*   /*                                                               */ 00940000
*   /*****************************************************************/ 00941000
*                                                               02S0481 00942000
*                                                               02S0481 00943000
*   /*****************************************************************/ 00944000
*   /*                                                               */ 00945000
*   /* 2314 AND 3340 ALTERNATE TRACK RECOVERY ROUTINE                */ 00946000
*   /*                                                               */ 00947000
*   /*****************************************************************/ 00948000
*                                                               02S0481 00949000
*/*ALTRK: N SET UP TO DETERMINE CAUSE OF TRK COND CK                 */ 00950000
*/* P R11 = ADDRESS OF SEEK, RHA, READ R0 TO EXAMINE TCC             */ 00951000
*/* N SEEK TO ORIGINAL RHA AND READ R0                               */ 00952000
*/* S AMDSAERI:SVC 23 PERFORM I/O                                    */ 00953000
*/* D (YES,,NO,TRKCK) ERROR ON SEEK, RHA, READ R0 ?                  */ 00954000
*/* P (,TERMEXIT) MESSAGE ID = 31                                    */ 00955000
*                                                               02S0481 00956000
*ALTRK:                                                         02S0481 00957000
*   RES0CCHH = IODBCCHH(2:7);       /* OBTAIN FAILING CCHH           */ 00958000
ALTRK    MVC   RES0CCHH(6),IODBCCHH+1(IODBREG)                  02S0481 00959000
*   RESPECIFY (R11,RETCODE) RESTRICTED; /* RESTRICT REGISTERS        */ 00960000
*   R11 = ADDR(RESALT);             /* SET ADDRESS OF RHA, RR0 CCW S */ 00961000
         LA    R11,RESALT                                       02S0483 00962000
*   SVC (ERISVC);                   /* ISSUE CCW S                   */ 00963000
         SVC   23                                               02S0484 00964000
*   IF RETCODE ^= ZERO THEN         /* WAS OPERATION SUCCESSFUL      */ 00965000
         LTR   RETCODE,RETCODE                                  02S0485 00966000
         BZ    @RF00485                                         02S0485 00967000
*     DO;                                                       02S0486 00968000
*       ERBID = MSGERR;             /* NO--SET MESSAGE ID            */ 00969000
         MVI   ERBID(CCTREG),X'1F'                              02S0487 00970000
*       GO TO TERMEXIT;             /* AND EXIT                      */ 00971000
         B     TERMEXIT                                         02S0488 00972000
*     END;                                                      02S0489 00973000
*   RESPECIFY (R11,RETCODE) UNRESTRICTED; /* RELEASE REGISTERS       */ 00974000
@RF00485 DS    0H                                               02S0491 00975000
*/*TRKCK: D (YES,OP,NO,) ALTERNATE TRK ?                             */ 00976000
*/* D (YES,OP,NO,) DEFECTIVE TRK ?                                   */ 00977000
*/* P (,TERMEXIT) MESSAGE ID = 06                                    */ 00978000
*/*OP: D (YES,CCHH,NO,) OPERATION INCOMPLETE ?                       */ 00979000
*/* D (YES,NOCHANGE,NO,TCCERR) DEFECTIVE TRACK ?                     */ 00980000
*/*NOCHANGE: N (,TCCRETRY) SEEK CCHH OF ALT                          */ 00981000
*/*CCHH: D (YES,SOMEDATA,NO,) DEFECTIVE TRK ?                        */ 00982000
*/* S (,%TICTEST) AMDSAEOC:USE CCHH + 1 TO GET TO NEXT TRK           */ 00983000
*/*SOMEDATA: N USE ALT CCHH                                          */ 00984000
*/*%TICTEST: N SEEK, SFM (NO SEEK) SRCH TIC TIC CSW                  */ 00985000
*/* D (YES,TCCERR,NO,CONSCCW) TICCCW = NOP OR TIC CMD CODE ?         */ 00986000
*/*TCCERR: P (,TERMEXIT) MESSAGE ID = 06                             */ 00987000
*/*CONSCCW: P DATA AREA = ERR CCW DATA ADDR + 4K - RESIDUAL CNT      */ 00988000
*/* P SET DATA LENGTH TO RESIDUAL COUNT IN CSW                       */ 00989000
*/* D (YES,DRC0,NO,) RESIDUAL COUNT = 0 ?                            */ 00990000
*/* N (,TCCRETRY) SET UP FOR RETRY OPERATION                         */ 00991000
*/*TCCRETRY: S AMDSAERB:SVC 20 DAERB, CC=06, PCT=3, SCT=0            */ 00992000
*/* N (,REPEATOP) RETRY I/O                                          */ 00993000
*   IF RESFGALT = OFF & RESFGDFT = OFF THEN /* IF THIS IS A PRIMARY     00994000
*                                      AND OPERATIVE TRACK THEN THE     00995000
*                                      TCC IS INVALID                */ 00996000
         TM    RESFGALT,B'00000011'                             02S0491 00997000
         BNZ   @RF00491                                         02S0491 00998000
*     DO;                                                       02S0492 00999000
*       ERBID = MSGTCC;             /* SET MESSAGE ID                */ 01000000
         MVI   ERBID(CCTREG),X'06'                              02S0493 01001000
*       GO TO TERMEXIT;             /* AND EXIT                      */ 01002000
         B     TERMEXIT                                         02S0494 01003000
*     END;                                                      02S0495 01004000
*   IF SENOI = OFF THEN             /* IS OPERATION COMPLETE         */ 01005000
@RF00491 TM    SENOI(IODBREG),B'00000001'                       02S0496 01006000
         BNZ   @RF00496                                         02S0496 01007000
*     DO;                                                       02S0497 01008000
*       IF RESFGDFT = OFF THEN      /* IF ALTERNATE                  */ 01009000
         TM    RESFGDFT,B'00000010'                             02S0498 01010000
         BZ    @RT00498                                         02S0498 01011000
*         GO TO TCCERR;             /* ISSUE MESSAGE                 */ 01012000
*       IF ADDR(CCW) ^= ADDR(RESERCH) THEN /* WILL WE TIC TO    02S0500 01013000
*                                      OURSELVES                     */ 01014000
         LA    @10,RESERCH                                      02S0500 01015000
         CR    CCWREG,@10                                       02S0500 01016000
         BE    @RF00500                                         02S0500 01017000
*         DO;                                                   02S0501 01018000
*           RESCMD1 = TIC;          /* SET TIC TO FAILING SEARCH        01019000
*                                      (NOTE THAT THE FAILING CCW       01020000
*                                      MUST BE A SEARCH BECAUSE OF      01021000
*                                      THE CCW CHAINS SADMP USES AND    01022000
*                                      OPERATION COMPLETE)           */ 01023000
         MVI   RESCMD1,X'08'                                    02S0502 01024000
*           RESDADD1 = ADDR(CCW) + 2*LENGTH(CCW); /* SET ADDRESS IN     01025000
*                                      TIC TO CCW AFTER SEARCH AND      01026000
*                                      TIC IN ORIGINAL CHAIN         */ 01027000
         LA    @10,16                                           02S0503 01028000
         ALR   @10,CCWREG                                       02S0503 01029000
         STCM  @10,7,RESDADD1                                   02S0503 01030000
*         END;                                                  02S0504 01031000
*     END;                                                      02S0505 01032000
*   ELSE                                                        02S0506 01033000
*     DO;                           /* BUT IF OPERATION IS INCOMPLETE*/ 01034000
         B     @RC00496                                         02S0506 01035000
@RF00496 DS    0H                                               02S0507 01036000
*       IF RESFGDFT = OFF THEN      /* IF ALTERNATE NOT DEFECTIVE    */ 01037000
         TM    RESFGDFT,B'00000010'                             02S0507 01038000
         BNZ   @RF00507                                         02S0507 01039000
*         CALL AMDSAEOC;            /* ADD 1 TO CCHH OF TRACK THIS      01040000
*                                      TRACK REPLACES (THIS IS A CASE   01041000
*                                      OF TRACK OVERFLOW FROM   02S0508 01042000
*                                      ALTERNATE)                    */ 01043000
         BAL   @14,AMDSAEOC                                     02S0508 01044000
*       IODBSRCH = RESCCHH;         /* SET NEW CCHH FOR SEARCH       */ 01045000
@RF00507 MVC   IODBSRCH(4,IODBREG),RESCCHH                      02S0509 01046000
*       IODBR = ONE;                /* SET SEARCH RECORD TO ONE      */ 01047000
         MVI   IODBR(IODBREG),X'01'                             02S0510 01048000
*       IF CCWCMD = TIC | CCWCMD = NOOP THEN /* IF TIC TO TIC OR        01049000
*                                      NO-OP                         */ 01050000
         CLI   CCWCMD(CCWREG),8                                 02S0511 01051000
         BE    @RT00511                                         02S0511 01052000
         CLI   CCWCMD(CCWREG),3                                 02S0511 01053000
         BNE   @RF00511                                         02S0511 01054000
@RT00511 DS    0H                                               02S0512 01055000
*         DO;                                                   02S0512 01056000
*                                                               02S0512 01057000
*TCCERR:                                                        02S0513 01058000
*           ERBID = MSGTCC;         /* SET MESSAGE ID                */ 01059000
TCCERR   MVI   ERBID(CCTREG),X'06'                              02S0513 01060000
*           GO TO TERMEXIT;         /* AND EXIT                      */ 01061000
         B     TERMEXIT                                         02S0514 01062000
*         END;                                                  02S0515 01063000
*       RESTART1 = CCW;             /* FAILING CCW MUST BE A READ       01064000
*                                      BECAUSE OF SADMP CCW CHAINS      01065000
*                                      AND OPERATION INCOMPLETE      */ 01066000
@RF00511 MVC   RESTART1(8),CCW(CCWREG)                          02S0516 01067000
*       RESDADD1 = RESDADD1 + RESCNT1 - CSWCNT; /* CALCULATE NEW DATA   01068000
*                                      ADDRESS                       */ 01069000
         L     @10,RESDADD1-1                                   02S0517 01070000
         LA    @10,0(,@10)                                      02S0517 01071000
         AH    @10,RESCNT1                                      02S0517 01072000
         LH    @07,CSWCNT+24(,IODBREG)                          02S0517 01073000
         N     @07,@CF00857                                     02S0517 01074000
         SLR   @10,@07                                          02S0517 01075000
         STCM  @10,7,RESDADD1                                   02S0517 01076000
*       RESFGDC = OFF;              /* BE SURE DATA CHAINING IS OFF  */ 01077000
*       RESFGCC = OFF;              /* AND COMMAND CHAINING          */ 01078000
         NI    RESFGDC,B'00111111'                              02S0519 01079000
*       RESCNT1 = CSWCNT;           /* SET NEW COUNT                 */ 01080000
         STH   @07,RESCNT1                                      02S0520 01081000
*       IF RESCNT1 = ZERO THEN      /* IS NEW COUNT ZERO             */ 01082000
         LTR   @07,@07                                          02S0521 01083000
         BZ    @RT00521                                         02S0521 01084000
*         GO TO DRC0;               /* YES--RETURN GOOD              */ 01085000
*     END;                                                      02S0523 01086000
*   RESF = ZERO;                    /* ZERO FLAG FIELD               */ 01087000
@RC00496 MVI   RESF,X'00'                                       02S0524 01088000
*   IODBCAW = ADDR(RESTARTA);       /* SET ADDRESS OF CCW CHAIN TO      01089000
*                                      RESTART                       */ 01090000
         LA    @10,RESTARTA                                     02S0525 01091000
         ST    @10,IODBCAW(,IODBREG)                            02S0525 01092000
*   ERBPID = MSGTCC;                /* SET MESSAGE ID                */ 01093000
         MVI   ERBPID,X'06'                                     02S0526 01094000
*   ERBSCT = ZERO;                  /* SET SECONDARY RETRY COUNT     */ 01095000
         MVI   ERBSCT,X'00'                                     02S0527 01096000
*   ERBPCT = THREE;                 /* SET PRIMARY RETRY COUNT       */ 01097000
         MVI   ERBPCT,X'03'                                     02S0528 01098000
*   R1 = ADDR(ERBPARM);             /* SET INPUT REG                 */ 01099000
         LA    R1,ERBPARM                                       02S0529 01100000
*   SVC (ERBSVC);                   /* UPDATE ERB                    */ 01101000
         SVC   20                                               02S0530 01102000
*   GO TO REPEATOP;                 /* RETRY OPERATION               */ 01103000
         B     REPEATOP                                         02S0531 01104000
*                                                               02S0532 01105000
*   /*****************************************************************/ 01106000
*   /*                                                               */ 01107000
*   /* 3330 ERROR RECOVERY ROUTINE                                   */ 01108000
*   /*                                                               */ 01109000
*   /*****************************************************************/ 01110000
*                                                               02S0532 01111000
*                                                               02S0532 01112000
*   /*****************************************************************/ 01113000
*   /*                                                               */ 01114000
*   /* THE FOLLOWING CONDITIONS ARE ALL HANDLED IN COMMON CODE,      */ 01115000
*   /* COMMAND REJECT--SENSE BYTE 0 BIT 0, INTERVENTION              */ 01116000
*   /* REQUIRED--SENSE BYTE 0 BIT 1, BUS OUT CHECK--SENSE BYTE 0 BIT */ 01117000
*   /* 2, AND PERNAMENT ERROR--SNESE BYTE 1 BIT 0, AND EQUIPMENT     */ 01118000
*   /* CHECK--SENSE BYTE 0 BIT 3.                                    */ 01119000
*   /*                                                               */ 01120000
*   /*****************************************************************/ 01121000
*                                                               02S0532 01122000
*/*D3330: N THIS IS THE 3330 ERROR RECOVERY ROUTINE                  */ 01123000
*/* D (YES,CCMDRJT,NO,) COMMAND REJECT ?                             */ 01124000
*/* D (YES,CINTVREQ,NO,) INTV REQUIRED ?                             */ 01125000
*/* D (YES,CBUSOUT,NO,) BUSOUT CHECK ?                               */ 01126000
*/* D (YES,CPERMERR,NO,D3330EQ) PERMANENT ERROR ?                    */ 01127000
*/*D3330EQ: D (YES,,NO,D3330OR) EQUIMENT CK ?                        */ 01128000
*                                                               02S0532 01129000
*D3330:                                                         02S0532 01130000
*D3350:                                                    /*@Z30RSTA*/ 01131000
*   IF SENCR = ON THEN              /* IF COMMAND REJECT             */ 01132000
D3330    DS    0H                                               02S0532 01133000
D3350    TM    SENCR(IODBREG),B'10000000'                       02S0532 01134000
         BO    @RT00532                                         02S0532 01135000
*     GO TO CCMDRJT;                /* HANDLE IN COMMON CODE         */ 01136000
*   IF SENIR = ON THEN              /* IF INTERVENTION REQUIRED      */ 01137000
         TM    SENIR(IODBREG),B'01000000'                       02S0534 01138000
         BO    @RT00534                                         02S0534 01139000
*     GO TO CINTVREQ;               /* HANDLE IN COMMON CODE         */ 01140000
*   IF SENBO = ON THEN              /* IF BUS OUT                    */ 01141000
         TM    SENBO(IODBREG),B'00100000'                       02S0536 01142000
         BO    @RT00536                                         02S0536 01143000
*     GO TO CBUSOUT;                /* HANDLE IN COMMON CODE         */ 01144000
*   IF SENPE = ON THEN              /* PERMANENT ERROR               */ 01145000
         TM    SENPE(IODBREG),B'10000000'                       02S0538 01146000
         BO    @RT00538                                         02S0538 01147000
*     GO TO CPERMERR;               /* HANDLE IN COMMON CODE         */ 01148000
*   IF SENEC = ON THEN              /* IF EQUIPMENT CHECK WITHOUT       01149000
*                                      PERMANENT ERROR               */ 01150000
         TM    SENEC(IODBREG),B'00010000'                       02S0540 01151000
         BO    @RT00540                                         02S0540 01152000
*     GO TO CEQUCK;                 /* HANDLE IN COMMON CODE         */ 01153000
*                                                               02S0541 01154000
*   /*****************************************************************/ 01155000
*   /*                                                               */ 01156000
*   /* THIS CODE HANDLES DATA CHECK--SENSE BYTE 0 BIT 4.             */ 01157000
*   /*                                                               */ 01158000
*   /*****************************************************************/ 01159000
*                                                               02S0542 01160000
*/*D3330DTA: D (YES,,NO,D3330OI) DATA CK ?                           */ 01161000
*/* D (YES,D3330COR,NO,OPRINCOM) CORRECTABLE ?                       */ 01162000
*/*D3330COR: P OBTAIN IODBCSW - 8                                    */ 01163000
*/* D (YES,OPRINCOM,NO,) SKIP BIT ON ?                               */ 01164000
*/* P OBTAIN ERROR BYTES 18 AND 19                                   */ 01165000
*/* P ERROR OFFSET = CCW DATA ADDR + (SENSE 15-17 - SENSE 18 & 19)   */ 01166000
*/* P X-OR PATTERN OFFSET WITH SENSE 20, 21, AND 22                  */ 01167000
*/*OPRINCOM: D (YES,,NO,DRC0) OPERATION INCOMPLETE ?                 */ 01168000
*/* P USE USER CCHH + LOW ORDER HEAD BYTE WITH BITS 3-7 FROM SENSE 6 */ 01169000
*/* N CONSTRUCT RESTART 2 CCW                                        */ 01170000
*/* P CMD CODE = SENSE 3                                             */ 01171000
*/* P DATA ADDR = ERR CCW DATA ADDR + SENSE 15-17                    */ 01172000
*/* P FLAGS = ERROR CCW FLAGS WITHOUT PCI                            */ 01173000
*/* P COUNT = CCW COUNT - SENSE 15-17                                */ 01174000
*/*D (YES,CTOK,NO,DRC0) COUNT > 0 ?                                  */ 01175000
*/*CTOK: P SEEK (ARGUMENT ABOVE) SET FILE MASK (ORIGINAL)            */ 01176000
*/* P SET SECTOR (0) SEARCH ID EQUAL                                 */ 01177000
*/* P RESTART CCW 2 ABOVE, TIC TO CSW                                */ 01178000
*/* D (YES,,NO,DCKCTR) CSW CCW A TIC OR NOP ?                        */ 01179000
*/* P MAKE LAST TIC A NOP                                            */ 01180000
*/*DCKCTR: S AMDSAERB:SVC 20 DAERB, CC=04, PCT=2, SCT=0              */ 01181000
*/* N (,REPEATOP) RETRY OPERATION                                    */ 01182000
*   IF SENDC = ON THEN              /* IF DATA CHECK WITHOUT    02S0542 01183000
*                                      PERMANENT ERROR               */ 01184000
         TM    SENDC(IODBREG),B'00001000'                       02S0542 01185000
         BNO   @RF00542                                         02S0542 01186000
*     DO;                                                       02S0543 01187000
*       IF SENCO = ON THEN          /* AND THE ERROR IS CORRECTABLE  */ 01188000
         TM    SENCO(IODBREG),B'01000000'                       02S0544 01189000
         BNO   @RF00544                                         02S0544 01190000
*         DO;                                                   02S0545 01191000
*           IF CCWSKIP = OFF THEN   /* AND IF SKIP BIT OF ERROR CCW     01192000
*                                      IS OFF                        */ 01193000
         TM    CCWSKIP(CCWREG),B'00010000'                      02S0546 01194000
         BNZ   @RF00546                                         02S0546 01195000
*             DO;                                               02S0547 01196000
*               EROFFSET = CCWDADDR + (SENS1517 - SENS1819); /* 02S0548 01197000
*                                      CALCULATE OFFSET IN BUFFER OF    01198000
*                                      ERROR                         */ 01199000
         SLR   EROFFSET,EROFFSET                                02S0548 01200000
         ICM   EROFFSET,7,SENS1517(IODBREG)                     02S0548 01201000
         LH    @10,SENS1819(,IODBREG)                           02S0548 01202000
         N     @10,@CF00857                                     02S0548 01203000
         SLR   EROFFSET,@10                                     02S0548 01204000
         L     @10,CCWDADDR-1(,CCWREG)                          02S0548 01205000
         LA    @10,0(,@10)                                      02S0548 01206000
         ALR   EROFFSET,@10                                     02S0548 01207000
*               BUFFER = BUFFER && SENS2022; /* CORRECT BAD DATA AT     01208000
*                                      ERROR OFFSET WITH DATA FROM      01209000
*                                      SENSE BYTES                   */ 01210000
         XC    BUFFER(3,EROFFSET),SENS2022(IODBREG)             02S0549 01211000
*             END;                                              02S0550 01212000
*         END;                                                  02S0551 01213000
@RF00546 DS    0H                                               02S0552 01214000
*       IF SENOI = OFF THEN         /* IF OPERATION IS NOT INCOMPLETE*/ 01215000
@RF00544 TM    SENOI(IODBREG),B'00000001'                       02S0552 01216000
         BZ    @RT00552                                         02S0552 01217000
*         GO TO DRC0;               /* THEN RETURN SINCE THE ERROR      01218000
*                                      HAS BEEN CORRECTED            */ 01219000
*       ELSE                                                    02S0554 01220000
*         DO;                       /* BUT IF THE OPERATION IS  02S0554 01221000
*                                      INCOMPLETE                    */ 01222000
*           RES0CCHH = IODBCCHH(2:7) & 'FFFFFFFFFFE0'X; /* SET SEEK     01223000
*                                      CCHH TO LAST CCHH             */ 01224000
         MVC   RES0CCHH(6),IODBCCHH+1(IODBREG)                  02S0555 01225000
         NC    RES0CCHH(6),@CB00831                             02S0555 01226000
*           RESH2 = RESH2 | (SENSE06 & '1F'X); /* AND IN UPDATED HEAD   01227000
*                                      FROM SENSE                    */ 01228000
         LA    @10,31                                           02S0556 01229000
         SLR   @07,@07                                          02S0556 01230000
         IC    @07,SENSE06(,IODBREG)                            02S0556 01231000
         NR    @10,@07                                          02S0556 01232000
         SLR   @07,@07                                          02S0556 01233000
         IC    @07,RESH2                                        02S0556 01234000
         OR    @10,@07                                          02S0556 01235000
         STC   @10,RESH2                                        02S0556 01236000
*           IF SENCO = ON THEN      /* WAS DATA CORRECTABLE          */ 01237000
         TM    SENCO(IODBREG),B'01000000'                       02S0557 01238000
         BNO   @RF00557                                         02S0557 01239000
*             RESH2 = RESH2 + ONE;  /* YES--THEN SEARCH FOR FIRST       01240000
*                                      RECORD ON NEXT TRACK          */ 01241000
         AL    @10,@CF00062                                     02S0558 01242000
         STC   @10,RESH2                                        02S0558 01243000
*           RESR = ONE;             /* SET RECORD TO ONE             */ 01244000
@RF00557 MVI   RESR,X'01'                                       02S0559 01245000
*           RESCMD = SENSE03;       /* USED COMMAND FROM SENSE       */ 01246000
         MVC   RESCMD(1),SENSE03(IODBREG)                       02S0560 01247000
*           RESDADDR = CCWDADDR + SENS1517; /* CALCULATE NEW DATA       01248000
*                                      ADDRESS                       */ 01249000
         SLR   @10,@10                                          02S0561 01250000
         ICM   @10,7,SENS1517(IODBREG)                          02S0561 01251000
         L     @07,CCWDADDR-1(,CCWREG)                          02S0561 01252000
         LA    @07,0(,@07)                                      02S0561 01253000
         ALR   @07,@10                                          02S0561 01254000
         STCM  @07,7,RESDADDR                                   02S0561 01255000
*           RESFLAGS = CCWFLAGS;    /* USE OLD FLAGS BUT             */ 01256000
         MVC   RESFLAGS(1),CCWFLAGS(CCWREG)                     02S0562 01257000
*           RESFGPCI = OFF;         /* TURN OFF PCI FLAG             */ 01258000
*           RESFGDC = OFF;          /* BE SURE DATA CHAINING IS OFF  */ 01259000
*           RESFGCC = OFF;          /* AND COMMAND CHAINING          */ 01260000
         NI    RESFGPCI,B'00110111'                             02S0565 01261000
*           RESCNT = CCWCNT - SENS1517; /* CALCULATE NEW COUNT       */ 01262000
         LCR   @10,@10                                          02S0566 01263000
         LH    @07,CCWCNT(,CCWREG)                              02S0566 01264000
         N     @07,@CF00857                                     02S0566 01265000
         ALR   @10,@07                                          02S0566 01266000
         STH   @10,RESCNT                                       02S0566 01267000
*           IF RESCNT <= ZERO THEN  /* IS NEW COUNT ZERO OR LESS     */ 01268000
         LTR   @10,@10                                          02S0567 01269000
         BNP   @RT00567                                         02S0567 01270000
*             GO TO DRC0;           /* RESTART NOT NECESSARY         */ 01271000
*           IODBCAW = ADDR(RESTART); /* SET RESTART CCW ADDRESS      */ 01272000
         LA    @10,RESTART                                      02S0569 01273000
         ST    @10,IODBCAW(,IODBREG)                            02S0569 01274000
*           ERBPID = MSGDC;         /* SET MESSAGE ID                */ 01275000
         MVI   ERBPID,X'04'                                     02S0570 01276000
*           ERBSCT = ZERO;          /* SET SECONDARY RETRY COUNT     */ 01277000
         MVI   ERBSCT,X'00'                                     02S0571 01278000
*           ERBPCT = TWO;           /* SET PRIMARY RETRY COUNT       */ 01279000
         MVI   ERBPCT,X'02'                                     02S0572 01280000
*           R1 = ADDR(ERBPARM);     /* SET INPUT REG                 */ 01281000
         LA    R1,ERBPARM                                       02S0573 01282000
*           SVC (ERBSVC);           /* UPDATE ERB                    */ 01283000
         SVC   20                                               02S0574 01284000
*           GO TO REPEATOP;         /* RETRY OPERATION               */ 01285000
         B     REPEATOP                                         02S0575 01286000
*         END;                                                  02S0576 01287000
*     END;                                                      02S0577 01288000
*                                                               02S0577 01289000
*   /*****************************************************************/ 01290000
*   /*                                                               */ 01291000
*   /* THIS CODE HANDLES THE FOLLOWING CONDITIONS, OVERRUN(WITHOUT   */ 01292000
*   /* PERMANENT ERROR)--SENSE BYTE 0 BIT 5, ENVIRONMENTAL           */ 01293000
*   /* DATA--SENSE BYTE 2 BIT 3, NO RECORD FOUND--SENSE BYTE 1 BIT 4,*/ 01294000
*   /* END OF CYLINDER--SENSE BYTE 1 BIT 2, AND FILE PROTECTED--SENSE*/ 01295000
*   /* BYTE 1 BIT 5.                                                 */ 01296000
*   /*                                                               */ 01297000
*   /*****************************************************************/ 01298000
*                                                               02S0578 01299000
*/*D3330OR: D (YES,,NO,D3330DTA) OVERRUN ?                           */ 01300000
*/* S AMDSAERB:SVC 20 DAERB, CC=5, PCT=10, SCT=0                     */ 01301000
*/* N (,REPEATOP) RETRY OPERATION                                    */ 01302000
*/*ENVDATA: D (YES,,NO,D3330NRF) ENVIRONMENTAL DATA ?                */ 01303000
*/* S AMDSAERB:SVC 20 DAERB, CC=11, PCT=1, SCT=0                     */ 01304000
*/* N (,REPEATOP) RETRY I/O OPERATION                                */ 01305000
*/*D3330NRF: D (YES,,NO,D3330EOC) NO RECORD FOUND ?                  */ 01306000
*/* P (,TERMEXIT) MESSAGE ID = 12                                    */ 01307000
*/*D3330EOC: D (YES,,NO,D3330FP) END OF CYLINDER ?                   */ 01308000
*/* P (,TERMEXIT) MESSAGE ID = 10                                    */ 01309000
*/*D3330FP: D (YES,,NO,D3330MSC) FILE PROTECTED ?                    */ 01310000
*/* P (,TERMEXIT) MESSAGE ID =13                                     */ 01311000
*/*D3330MSC: P (,TERMEXIT) MESSAGE ID = 29                           */ 01312000
*   IF SENOR = ON THEN              /* IF OVERRUN WITHOUT PERMANENT     01313000
*                                      ERROR                         */ 01314000
@RF00542 TM    SENOR(IODBREG),B'00000100'                       02S0578 01315000
         BNO   @RF00578                                         02S0578 01316000
*     DO;                                                       02S0579 01317000
*       ERBPID = MSGOR;             /* SET MESSAGE ID                */ 01318000
         MVI   ERBPID,X'05'                                     02S0580 01319000
*       ERBSCT = ZERO;              /* SET SECONDARY RETRY COUNT     */ 01320000
         MVI   ERBSCT,X'00'                                     02S0581 01321000
*       ERBPCT = TEN;               /* SET PRIMARY RETRY COUNT       */ 01322000
         MVI   ERBPCT,X'0A'                                     02S0582 01323000
*       R1 = ADDR(ERBPARM);         /* SET INPUT REG                 */ 01324000
         LA    R1,ERBPARM                                       02S0583 01325000
*       SVC (ERBSVC);               /* UPDATE ERB                    */ 01326000
         SVC   20                                               02S0584 01327000
*       GO TO REPEATOP;             /* NOW REPEAT LAST OPERATION     */ 01328000
         B     REPEATOP                                         02S0585 01329000
*     END;                                                      02S0586 01330000
*   IF SENEDP = ON THEN             /* IF ENVIRONMENTAL DATA         */ 01331000
@RF00578 TM    SENEDP(IODBREG),B'00010000'                      02S0587 01332000
         BNO   @RF00587                                         02S0587 01333000
*     DO;                                                       02S0588 01334000
*       ERBPID = MSGEDP;            /* SET MESSAGE ID                */ 01335000
         MVI   ERBPID,X'0B'                                     02S0589 01336000
*       ERBSCT = ZERO;              /* SET SECONDARY RETRY COUNT     */ 01337000
         MVI   ERBSCT,X'00'                                     02S0590 01338000
*       ERBPCT = ONE;               /* SET PRIMARY RETRY COUNT       */ 01339000
         MVI   ERBPCT,X'01'                                     02S0591 01340000
*       R1 = ADDR(ERBPARM);         /* SET INPUT REG                 */ 01341000
         LA    R1,ERBPARM                                       02S0592 01342000
*       SVC (ERBSVC);               /* UPDATE ERB                    */ 01343000
         SVC   20                                               02S0593 01344000
*       GO TO REPEATOP;             /* REPEAT OPERATION              */ 01345000
         B     REPEATOP                                         02S0594 01346000
*     END;                                                      02S0595 01347000
*   IF SENNRF = ON THEN             /* IF NO RECORD FOUND            */ 01348000
@RF00587 TM    SENNRF(IODBREG),B'00001000'                      02S0596 01349000
         BNO   @RF00596                                         02S0596 01350000
*     DO;                                                       02S0597 01351000
*       ERBID = MSGNRF;             /* SET MESSAGE ID                */ 01352000
         MVI   ERBID(CCTREG),X'0C'                              02S0598 01353000
*       GO TO TERMEXIT;             /* AND EXIT                      */ 01354000
         B     TERMEXIT                                         02S0599 01355000
*     END;                                                      02S0600 01356000
*   IF SENEOC = ON THEN             /* IF END OF CYLINDER            */ 01357000
@RF00596 TM    SENEOC(IODBREG),B'00100000'                      02S0601 01358000
         BNO   @RF00601                                         02S0601 01359000
*     DO;                                                       02S0602 01360000
*       ERBID = MSGEOC;             /* SET MESSAGE ID                */ 01361000
         MVI   ERBID(CCTREG),X'0A'                              02S0603 01362000
*       GO TO TERMEXIT;             /* AND EXIT                      */ 01363000
         B     TERMEXIT                                         02S0604 01364000
*     END;                                                      02S0605 01365000
*   IF SENFP = ON THEN              /* IF FILE PROTECTED             */ 01366000
@RF00601 TM    SENFP(IODBREG),B'00000100'                       02S0606 01367000
         BNO   @RF00606                                         02S0606 01368000
*     DO;                                                       02S0607 01369000
*       ERBID = MSGFP;              /* SET MESSAGE ID                */ 01370000
         MVI   ERBID(CCTREG),X'0D'                              02S0608 01371000
*       GO TO TERMEXIT;             /* AND EXIT                      */ 01372000
         B     TERMEXIT                                         02S0609 01373000
*     END;                                                      02S0610 01374000
*                                                               02S0610 01375000
*   /*****************************************************************/ 01376000
*   /*                                                               */ 01377000
*   /* THIS CODE HANDLES OPERATION INCOMPLETE--SENSE BYTE 1 BIT 7.   */ 01378000
*   /*                                                               */ 01379000
*   /*****************************************************************/ 01380000
*                                                               02S0611 01381000
*/*D3330OI: D (YES,,NO,ENVDATA) OPERATION INCOMPLETE ?               */ 01382000
*/* P USE CCHH OF USER + LOW ORDER HEAD BYTE OF BITS 3-7 FROM SENSE 6*/ 01383000
*/* N CONSTRUCT RESTART 1 CCW                                        */ 01384000
*/* P MOVE IN COMMAND FROM SENSE BYTE 3                              */ 01385000
*/* P DATA ADDR = CCW ERROR DATA ADDR + 4K - CSW RESIDUAL CT         */ 01386000
*/* P FLAGS = ORIGINAL FLAGS                                         */ 01387000
*/* P TURN OFF PCI                                                   */ 01388000
*/* P COUNT = CSW RESIDUAL COUNT                                     */ 01389000
*/* D (YES,DRC0,NO,ADDSENSE) CT IN CSW = 0 ?                         */ 01390000
*/*ADDSENSE: P TIC TO THE FAILING CCW - 8                            */ 01391000
*/* D (YES,,NO,IO) CSW CCW A TIC OR NOP ?                            */ 01392000
*/* P MAKE LAST CCW A TIC OR NOP                                     */ 01393000
*/*IO: S AMDSAERB:SVC 20 DAERB, CC=14, PCT=2, SCT=0                  */ 01394000
*/* N (,REPEATOP) RETRY OPERATION                                    */ 01395000
*   IF SENOI = ON THEN              /* IF OPERATION INCOMPLETE  02S0611 01396000
*                                      WITHOUT PERMANENT ERROR       */ 01397000
@RF00606 TM    SENOI(IODBREG),B'00000001'                       02S0611 01398000
         BNO   @RF00611                                         02S0611 01399000
*     DO;                                                       02S0612 01400000
*       RES0CCHH = IODBCCHH(2:7) & 'FFFFFFFFFFE0'X; /* SET SEEK CCHH    01401000
*                                      TO LAST CCHH                  */ 01402000
         MVC   RES0CCHH(6),IODBCCHH+1(IODBREG)                  02S0613 01403000
         NC    RES0CCHH(6),@CB00831                             02S0613 01404000
*       RESH2 = RESH2 | (SENSE06 & '1F'X); /* AND IN UPDATED HEAD       01405000
*                                      FROM SENSE                    */ 01406000
         LA    @10,31                                           02S0614 01407000
         SLR   @07,@07                                          02S0614 01408000
         IC    @07,SENSE06(,IODBREG)                            02S0614 01409000
         NR    @10,@07                                          02S0614 01410000
         SLR   @07,@07                                          02S0614 01411000
         IC    @07,RESH2                                        02S0614 01412000
         OR    @10,@07                                          02S0614 01413000
         STC   @10,RESH2                                        02S0614 01414000
*       RESCMD = SENSE03;           /* USED COMMAND FROM SENSE       */ 01415000
         MVC   RESCMD(1),SENSE03(IODBREG)                       02S0615 01416000
*       RESDADDR = CCWDADDR + CCWCNT - CSWCNT; /* CALCULATE NEW DATA    01417000
*                                      ADDRESS                       */ 01418000
         L     @10,CCWDADDR-1(,CCWREG)                          02S0616 01419000
         LA    @10,0(,@10)                                      02S0616 01420000
         LH    @07,CCWCNT(,CCWREG)                              02S0616 01421000
         N     @07,@CF00857                                     02S0616 01422000
         ALR   @10,@07                                          02S0616 01423000
         LH    @07,CSWCNT+24(,IODBREG)                          02S0616 01424000
         N     @07,@CF00857                                     02S0616 01425000
         SLR   @10,@07                                          02S0616 01426000
         STCM  @10,7,RESDADDR                                   02S0616 01427000
*       RESFLAGS = CCWFLAGS;        /* USE OLD FLAGS BUT             */ 01428000
         MVC   RESFLAGS(1),CCWFLAGS(CCWREG)                     02S0617 01429000
*       RESFGPCI = OFF;             /* TURN OFF PCI FLAG             */ 01430000
*       RESFGDC = OFF;              /* BE SURE DATA CHAINING IS OFF  */ 01431000
*       RESFGCC = OFF;              /* AND COMMAND CHAINING          */ 01432000
         NI    RESFGPCI,B'00110111'                             02S0620 01433000
*       RESCNT = CSWCNT;            /* NEW COUNT IS RESIDUAL COUNT   */ 01434000
         STH   @07,RESCNT                                       02S0621 01435000
*       IF CSWCNT = ZERO THEN       /* IS RESIDUAL COUNT ZERO        */ 01436000
         LTR   @07,@07                                          02S0622 01437000
         BZ    @RT00622                                         02S0622 01438000
*         GO TO DRC0;               /* YES--RETURN GOOD              */ 01439000
*       IODBCAW = ADDR(RESTART);    /* SET RESTART CCW ADDRESS       */ 01440000
         LA    @10,RESTART                                      02S0624 01441000
         ST    @10,IODBCAW(,IODBREG)                            02S0624 01442000
*       ERBPID = MSGOI;             /* SET MESSAGE ID                */ 01443000
         MVI   ERBPID,X'0E'                                     02S0625 01444000
*       ERBSCT = ZERO;              /* SET SECONDARY RETRY COUNT     */ 01445000
         MVI   ERBSCT,X'00'                                     02S0626 01446000
*       ERBPCT = TWO;               /* SET PRIMARY RETRY COUNT       */ 01447000
         MVI   ERBPCT,X'02'                                     02S0627 01448000
*       R1 = ADDR(ERBPARM);         /* SET INPUT REG                 */ 01449000
         LA    R1,ERBPARM                                       02S0628 01450000
*       SVC (ERBSVC);               /* UPDATE ERB                    */ 01451000
         SVC   20                                               02S0629 01452000
*       GO TO REPEATOP;             /* RETRY OPERATION               */ 01453000
         B     REPEATOP                                         02S0630 01454000
*     END;                                                      02S0631 01455000
*   ERBID = MSGUNK;                 /* CONDITION NOT FOUND--SET 02S0632 01456000
*                                      GENERAL MESSAGE ID            */ 01457000
@RF00611 MVI   ERBID(CCTREG),X'1D'                              02S0632 01458000
*   GO TO TERMEXIT;                 /* AND EXIT                      */ 01459000
*                                                               02S0633 01460000
         B     TERMEXIT                                         02S0633 01461000
*   /*****************************************************************/ 01462000
*   /*                                                               */ 01463000
*   /* NO OTHER CONDITIONS ARE EXPECTED FROM A 3330 OR 3330-1. IF    */ 01464000
*   /* OTHER CONDITIONS OCCUR THEY ARE DO TO HARDWARE OR PROGRAMMING */ 01465000
*   /* ERRORS.                                                       */ 01466000
*   /*                                                               */ 01467000
*   /*****************************************************************/ 01468000
*                                                               02S0634 01469000
*                                                               02S0634 01470000
*   /*****************************************************************/ 01471000
*   /*                                                               */ 01472000
*   /* 2305-1 AND 2305-2 ERROR RECOVERY ROUTINE                      */ 01473000
*   /*                                                               */ 01474000
*   /*****************************************************************/ 01475000
*                                                               02S0634 01476000
*                                                               02S0634 01477000
*   /*****************************************************************/ 01478000
*   /*                                                               */ 01479000
*   /* THE FOLLOWING CONDITIONS ARE HANDLED IN COMMON CODE, COMMAND  */ 01480000
*   /* REJECT--SENSE BYTE 0 BIT 0, INTERVENTION REQUIRED--SENSE BYTE */ 01481000
*   /* 0 BIT 1, BUS OUT CHECK--SENSE BYTE 0 BIT 2, PERMANENT         */ 01482000
*   /* ERROR--SENSE BYTE 1 BIT 0, AND EQUIPMENT CHECK--SENSE BYTE 0  */ 01483000
*   /* BIT3.                                                         */ 01484000
*   /*                                                               */ 01485000
*   /*****************************************************************/ 01486000
*                                                               02S0634 01487000
*/*D2305: N THIS HANDLES 2305-1 AND 2305-2 ERRORS                    */ 01488000
*/* D (YES,CCMDRJT,NO,) COMMAND REJECT ?                             */ 01489000
*/* D (YES,CINTVREQ,NO,) INTV REQUIRED ?                             */ 01490000
*/* D (YES,CBUSOUT,NO,) BUSOUT CK ?                                  */ 01491000
*/* D (YES,CPERMERR,NO,) PERMANENT ERROR ?                           */ 01492000
*/* D (YES,CEQUCK,NO,) EQU CK ?                                      */ 01493000
*                                                               02S0634 01494000
*D2305:                                                         02S0634 01495000
*   IF SENCR = ON THEN              /* IF COMMAND REJECT             */ 01496000
D2305    TM    SENCR(IODBREG),B'10000000'                       02S0634 01497000
         BO    @RT00634                                         02S0634 01498000
*     GO TO CCMDRJT;                /* HANDLE IN COMMON CODE         */ 01499000
*   IF SENIR = ON THEN              /* IF INTERVENTION REQUIRED      */ 01500000
         TM    SENIR(IODBREG),B'01000000'                       02S0636 01501000
         BO    @RT00636                                         02S0636 01502000
*     GO TO CINTVREQ;               /* HANDLE IN COMMON CODE         */ 01503000
*   IF SENBO = ON THEN              /* IF BUS OUT                    */ 01504000
         TM    SENBO(IODBREG),B'00100000'                       02S0638 01505000
         BO    @RT00638                                         02S0638 01506000
*     GO TO CBUSOUT;                /* HANDLE IN COMMON CODE         */ 01507000
*   IF SENPE = ON THEN              /* IF PERMANENT ERROR            */ 01508000
         TM    SENPE(IODBREG),B'10000000'                       02S0640 01509000
         BO    @RT00640                                         02S0640 01510000
*     GO TO CPERMERR;               /* HANDLE IN COMMON CODE         */ 01511000
*   IF SENEC = ON THEN              /* IF EQUIPMENT CHECK            */ 01512000
         TM    SENEC(IODBREG),B'00010000'                       02S0642 01513000
         BO    @RT00642                                         02S0642 01514000
*     GO TO CEQUCK;                 /* HANDLE IN COMMON CODE         */ 01515000
*                                                               02S0643 01516000
*   /*****************************************************************/ 01517000
*   /*                                                               */ 01518000
*   /* THE FOLLOWING CODE HANDLES DATA CHECK--SENSE BYTE 0 BIT 4.    */ 01519000
*   /*                                                               */ 01520000
*   /*****************************************************************/ 01521000
*                                                               02S0644 01522000
*/* D (NO,D2305NRF,YES,) DATA CK ?                                   */ 01523000
*/* D (YES,DCRET,NO,) SENSE 2 1 ON ?                                 */ 01524000
*/* S AMDSAERB:SVC 20 DAERB, CC=04, PCT=10, SCT=0                    */ 01525000
*/* N (,REPEATOP) RETRY I/O OPERATION                                */ 01526000
*/*DCRET: P OBTAIN CSW CCW - 8                                       */ 01527000
*/* D (YES,DCOI,NO,) SKIP BIT ON ?                                   */ 01528000
*/* P OBTAIN ERROR BYTES 18 AND 19                                   */ 01529000
*/* P A = LAST CCW DATA ADDRESS + CCW COUNT                          */ 01530000
*/* P B = RESIDUAL CSW COUNT + SENSE BYTES 18 AND 19                 */ 01531000
*/* P ERROR OFFSET = A - B                                           */ 01532000
*/* P X-OR PATTERN OFFSET WITH SENSE 20, 21, AND 22                  */ 01533000
*/*DCOI: D (YES,,NO,DRC0) OPERATION INCOMPLETE ?                     */ 01534000
*/* P USE CH IN SENSE BYTES 5 & 6                                    */ 01535000
*/* P INCREMENT CH ABOVE BY 1                                        */ 01536000
*/* N CONSTRUCT RESTART CCW                                          */ 01537000
*/* P CMD CODE = SENSE 3                                             */ 01538000
*/* P DATA ADDR = DATA ADDR OF INTERRUPTED CCW + 4K - RESIDUAL CSW CT*/ 01539000
*/* P FLAGS = ORIGINAL FLAGS - PCI                                   */ 01540000
*/* P COUNT = RESIDUAL CSW COUNT                                     */ 01541000
*/* D (YES,DRC0,NO,CTDCOK) CT = 0 ?                                  */ 01542000
*/*CTDCOK: P SEEK SFM ORIGINAL SEARCH ID R1 TIC TO SEARCH            */ 01543000
*/* P  RESTART CCW CONSTRUCTED ABOVE TIC TO CSW                      */ 01544000
*/* D (YES,,NO,DCNOI) CSW CCW A TIC OR NOP ?                         */ 01545000
*/* P MAKE LAST CCW A TIC OR NOP                                     */ 01546000
*/*DCNOI: S AMDSAERB:SVC 20 DAERB, CC=04, PCT=2, SCT=0               */ 01547000
*/* N (,REPEATOP) RETRY I/O OPERATION                                */ 01548000
*   IF SENDC = ON THEN              /* IF DATA CHECK                 */ 01549000
         TM    SENDC(IODBREG),B'00001000'                       02S0644 01550000
         BNO   @RF00644                                         02S0644 01551000
*     IF SENCO = OFF THEN           /* BUT DATA IS NOT CORRECTABLE   */ 01552000
         TM    SENCO(IODBREG),B'01000000'                       02S0645 01553000
         BNZ   @RF00645                                         02S0645 01554000
*       DO;                                                     02S0646 01555000
*         ERBPID = MSGDC;           /* SET MESSAGE ID                */ 01556000
         MVI   ERBPID,X'04'                                     02S0647 01557000
*         ERBSCT = ZERO;            /* SET SECONDARY ERROR COUNT     */ 01558000
         MVI   ERBSCT,X'00'                                     02S0648 01559000
*         ERBPCT = TEN;             /* SET PRIMARY ERROR COUNT       */ 01560000
         MVI   ERBPCT,X'0A'                                     02S0649 01561000
*         R1 = ADDR(ERBPARM);       /* SET INPUT REG                 */ 01562000
         LA    R1,ERBPARM                                       02S0650 01563000
*         SVC (ERBSVC);             /* UPDATE ERB                    */ 01564000
         SVC   20                                               02S0651 01565000
*         GO TO REPEATOP;           /* RETRY OPERATION               */ 01566000
         B     REPEATOP                                         02S0652 01567000
*       END;                                                    02S0653 01568000
*     ELSE                                                      02S0654 01569000
*       DO;                         /* BUT IF THE DATA IS       02S0654 01570000
*                                      CORRECTABLE--CORRECT IT       */ 01571000
@RF00645 DS    0H                                               02S0655 01572000
*         IF CCWSKIP = OFF THEN     /* IF DATA WAS READ CORRECT IT   */ 01573000
         TM    CCWSKIP(CCWREG),B'00010000'                      02S0655 01574000
         BNZ   @RF00655                                         02S0655 01575000
*           DO;                                                 02S0656 01576000
*             EROFFSET = CCWDADDR + CCWCNT - (CSWCNT + SENS1819); /*    01577000
*                                      CALCUALTE ERROR OFFSET        */ 01578000
         L     EROFFSET,CCWDADDR-1(,CCWREG)                     02S0657 01579000
         LA    EROFFSET,0(,EROFFSET)                            02S0657 01580000
         LH    @10,CCWCNT(,CCWREG)                              02S0657 01581000
         N     @10,@CF00857                                     02S0657 01582000
         ALR   EROFFSET,@10                                     02S0657 01583000
         LH    @10,CSWCNT+24(,IODBREG)                          02S0657 01584000
         N     @10,@CF00857                                     02S0657 01585000
         LH    @07,SENS1819(,IODBREG)                           02S0657 01586000
         N     @07,@CF00857                                     02S0657 01587000
         ALR   @10,@07                                          02S0657 01588000
         SLR   EROFFSET,@10                                     02S0657 01589000
*             BUFFER = BUFFER && SENS2022; /* CORRECT DATA IN BUFFER    01590000
*                                      WITH SENSE BYTES              */ 01591000
         XC    BUFFER(3,EROFFSET),SENS2022(IODBREG)             02S0658 01592000
*           END;                                                02S0659 01593000
*         IF SENOI = OFF THEN       /* IF OPERATION IN COMPLETE      */ 01594000
@RF00655 TM    SENOI(IODBREG),B'00000001'                       02S0660 01595000
         BZ    @RT00660                                         02S0660 01596000
*           GO TO DRC0;             /* THEN RETURN                   */ 01597000
*         ELSE                                                  02S0662 01598000
*           DO;                     /* OTHERWISE COMPLETE THE   02S0662 01599000
*                                      OPERATION                     */ 01600000
*             RES0CCHH = RES0CCHH && RES0CCHH; /* CLEAR SEEK ADDRESS */ 01601000
         XC    RES0CCHH(6),RES0CCHH                             02S0663 01602000
*             RESC2 = SENSE05;      /* SET SEEK CYLINDER FROM SENSE  */ 01603000
         MVC   RESC2(1),SENSE05(IODBREG)                        02S0664 01604000
*             RESH2 = SENSE06 + 1;  /* SET SEEK HEAD FROM SENSE      */ 01605000
         LA    @10,1                                            02S0665 01606000
         SLR   @07,@07                                          02S0665 01607000
         IC    @07,SENSE06(,IODBREG)                            02S0665 01608000
         ALR   @10,@07                                          02S0665 01609000
         STC   @10,RESH2                                        02S0665 01610000
*             RESR = ONE;           /* SET RECORD TO ONE             */ 01611000
         MVI   RESR,X'01'                                       02S0666 01612000
*             RESCMD = SENSE03;     /* USE COMMAND IN SENSE          */ 01613000
         MVC   RESCMD(1),SENSE03(IODBREG)                       02S0667 01614000
*             RESDADDR = CCWDADDR + CCWCNT - CSWCNT; /* SET DATA        01615000
*                                      ADDRESS IN RESTART CCW        */ 01616000
         L     @10,CCWDADDR-1(,CCWREG)                          02S0668 01617000
         LA    @10,0(,@10)                                      02S0668 01618000
         LH    @07,CCWCNT(,CCWREG)                              02S0668 01619000
         N     @07,@CF00857                                     02S0668 01620000
         ALR   @10,@07                                          02S0668 01621000
         LH    @07,CSWCNT+24(,IODBREG)                          02S0668 01622000
         N     @07,@CF00857                                     02S0668 01623000
         SLR   @10,@07                                          02S0668 01624000
         STCM  @10,7,RESDADDR                                   02S0668 01625000
*             RESFLAGS = CCWFLAGS;  /* USE FLAGS OF ERROR CCW        */ 01626000
         MVC   RESFLAGS(1),CCWFLAGS(CCWREG)                     02S0669 01627000
*             RESFGPCI = OFF;       /* AND PCI IS OFF                */ 01628000
*             RESFGDC = OFF;        /* BE SUR DATA CHAINING IS OFF   */ 01629000
*             RESFGCC = OFF;        /* AND COMMAND CHAINING          */ 01630000
         NI    RESFGPCI,B'00110111'                             02S0672 01631000
*             RESCNT = CSWCNT;      /* USE RESIDUAL COUNT            */ 01632000
         STH   @07,RESCNT                                       02S0673 01633000
*             IF CSWCNT = ZERO THEN /* BUT RESET IF COUNT IS ZERO    */ 01634000
         LTR   @07,@07                                          02S0674 01635000
         BZ    @RT00674                                         02S0674 01636000
*               GO TO DRC0;         /* YES--RETURN GOOD              */ 01637000
*             IODBCAW = ADDR(RESTART); /* SET RESTART CCW ADDRESS    */ 01638000
         LA    @10,RESTART                                      02S0676 01639000
         ST    @10,IODBCAW(,IODBREG)                            02S0676 01640000
*             ERBPID = MSGDC;       /* SET MESSAGE ID                */ 01641000
         MVI   ERBPID,X'04'                                     02S0677 01642000
*             ERBSCT = ZERO;        /* SET SECONDARY RETRY COUNT     */ 01643000
         MVI   ERBSCT,X'00'                                     02S0678 01644000
*             ERBPCT = TWO;         /* SET PRIMARY RETRY COUNT       */ 01645000
         MVI   ERBPCT,X'02'                                     02S0679 01646000
*             R1 = ADDR(ERBPARM);   /* SET INPUT REG                 */ 01647000
         LA    R1,ERBPARM                                       02S0680 01648000
*             SVC (ERBSVC);         /* UPDATE ERB                    */ 01649000
         SVC   20                                               02S0681 01650000
*             GO TO REPEATOP;       /* RETRY OPERATION               */ 01651000
         B     REPEATOP                                         02S0682 01652000
*           END;                                                02S0683 01653000
*       END;                                                    02S0684 01654000
*                                                               02S0684 01655000
*   /*****************************************************************/ 01656000
*   /*                                                               */ 01657000
*   /* THIS CODE HANDLES THE FOLLOWING CONDITIONS, NO RECORD         */ 01658000
*   /* FOUND--SENSE BYTE 1 BIT 4, OVERRUN--SENSE BYTE 0 BIT 5,       */ 01659000
*   /* BUFFERED LOG FULL--SENSE BYTE 2 BIT 0, END OF CYLINDER--SENSE */ 01660000
*   /* BYTE 1 BIT 2, AND FILE PROTECTED--SENSE BYTE 1 BIT 5.         */ 01661000
*   /*                                                               */ 01662000
*   /*****************************************************************/ 01663000
*                                                               02S0685 01664000
*/*D2305NRF: D (YES,,NO,D2305OR) NO RECORD FOUND ?                   */ 01665000
*/* P (,TERMEXIT) MESSAGE ID = 12                                    */ 01666000
*/*D2305OR: D (YES,,NO,D2305BLF) OVERRUN                             */ 01667000
*/* S AMDSAERB: DAERB CC=05, PCT=10, SCT=0                           */ 01668000
*/* N (,REPEATOP) RETRY I/O OPERATION                                */ 01669000
*/*D2305BLF: D (YES,,NO,D2305EOC) BUFFER LOG FULL ?                  */ 01670000
*/* S AMDSAERI: ISSUE READ BUFFERED LOG CCW                          */ 01671000
*/* D (YES,%OKRBL,NO,) RETURN CODE = 0                               */ 01672000
*/* P (,TERMEXIT) MESSAGE ID = 31                                    */ 01673000
*/*%OKRBL: S AMDSAERB: DAERB CC=32, PCT=2, SCT=0                     */ 01674000
*/* N (,REPEATOP) RETRY I/O OPERATION                                */ 01675000
*/*D2305EOC: D (YES,,NO,D2305FP) END OF CYLINDER ?                   */ 01676000
*/* P (,TERMEXIT) MESSAGE ID = 10                                    */ 01677000
*/*D2305FP: D (YES,,NO,D2305MIS) FILE PROTECTED ?                    */ 01678000
*/* P (,TERMEXIT) MESSAGE ID = 13                                    */ 01679000
*/*D2305MIS: P (,TERMEXIT) MESSAGE ID = 29                           */ 01680000
*   IF SENNRF = ON THEN             /* IF NO RECORD FOUND            */ 01681000
@RF00644 TM    SENNRF(IODBREG),B'00001000'                      02S0685 01682000
         BNO   @RF00685                                         02S0685 01683000
*     DO;                                                       02S0686 01684000
*       ERBID = MSGNRF;             /* SET MESSAGE ID                */ 01685000
         MVI   ERBID(CCTREG),X'0C'                              02S0687 01686000
*       GO TO TERMEXIT;             /* AND EXIT                      */ 01687000
         B     TERMEXIT                                         02S0688 01688000
*     END;                                                      02S0689 01689000
*   IF SENOR = ON THEN              /* IF OVERRUN                    */ 01690000
@RF00685 TM    SENOR(IODBREG),B'00000100'                       02S0690 01691000
         BNO   @RF00690                                         02S0690 01692000
*     DO;                                                       02S0691 01693000
*       ERBPID = MSGOR;             /* SET MESSAGE ID                */ 01694000
         MVI   ERBPID,X'05'                                     02S0692 01695000
*       ERBSCT = ZERO;              /* SET SECONDARY RETRY COUNT     */ 01696000
         MVI   ERBSCT,X'00'                                     02S0693 01697000
*       ERBPCT = TEN;               /* SET PRIMARY RETRY COUNT       */ 01698000
         MVI   ERBPCT,X'0A'                                     02S0694 01699000
*       R1 = ADDR(ERBPARM);         /* SET INPUT REG                 */ 01700000
         LA    R1,ERBPARM                                       02S0695 01701000
*       SVC (ERBSVC);               /* UPDATE ERB                    */ 01702000
         SVC   20                                               02S0696 01703000
*       GO TO REPEATOP;             /* RETRY OPERATION               */ 01704000
         B     REPEATOP                                         02S0697 01705000
*     END;                                                      02S0698 01706000
*   IF SENBLF = ON THEN             /* IF BUFFERED LOG FULL          */ 01707000
@RF00690 TM    SENBLF(IODBREG),B'10000000'                      02S0699 01708000
         BNO   @RF00699                                         02S0699 01709000
*     DO;                                                       02S0700 01710000
*       RESPECIFY (R11,RETCODE) RESTRICTED; /* RESTRICT REGISTERS    */ 01711000
*       R11 = ADDR(RDBUFLOG);       /* SET ADDRESS OF READ BUFFERED     01712000
*                                      LOG CCW                       */ 01713000
         LA    R11,RDBUFLOG                                     02S0702 01714000
*       SVC (ERISVC);               /* ISSUE SIO FOR CCW             */ 01715000
         SVC   23                                               02S0703 01716000
*       IF RETCODE ^= ZERO THEN     /* WAS SIO SUCCESSFULL           */ 01717000
         LTR   RETCODE,RETCODE                                  02S0704 01718000
         BZ    @RF00704                                         02S0704 01719000
*         DO;                                                   02S0705 01720000
*           ERBID = MSGERR;         /* NO--SET MESSAGE ID            */ 01721000
         MVI   ERBID(CCTREG),X'1F'                              02S0706 01722000
*           GO TO TERMEXIT;         /* AND EXIT                      */ 01723000
         B     TERMEXIT                                         02S0707 01724000
*         END;                                                  02S0708 01725000
*       RESPECIFY (R11,RETCODE) UNRESTRICTED; /* RELEASE REGISTERS   */ 01726000
@RF00704 DS    0H                                               02S0710 01727000
*       ERBPID = MSGBLF;            /* SET MESSAGE ID                */ 01728000
         MVI   ERBPID,X'20'                                     02S0710 01729000
*       ERBSCT = ZERO;              /* SET SECONDARY RETRY COUNT     */ 01730000
         MVI   ERBSCT,X'00'                                     02S0711 01731000
*       ERBPCT = TWO;               /* SET PRIMARY RETRY COUNT       */ 01732000
         MVI   ERBPCT,X'02'                                     02S0712 01733000
*       R1 = ADDR(ERBPARM);         /* SET INPUT REG                 */ 01734000
         LA    R1,ERBPARM                                       02S0713 01735000
*       SVC (ERBSVC);               /* UPDATE ERB                    */ 01736000
         SVC   20                                               02S0714 01737000
*       GO TO REPEATOP;             /* RETRY OPERATION               */ 01738000
         B     REPEATOP                                         02S0715 01739000
*     END;                                                      02S0716 01740000
*   IF SENEOC = ON THEN             /* IF END OF CYLINDER            */ 01741000
@RF00699 TM    SENEOC(IODBREG),B'00100000'                      02S0717 01742000
         BNO   @RF00717                                         02S0717 01743000
*     DO;                                                       02S0718 01744000
*       ERBID = MSGEOC;             /* SET MESSAGE ID                */ 01745000
         MVI   ERBID(CCTREG),X'0A'                              02S0719 01746000
*       GO TO TERMEXIT;             /* AND EXIT                      */ 01747000
         B     TERMEXIT                                         02S0720 01748000
*     END;                                                      02S0721 01749000
*   IF SENFP = ON THEN              /* IF FILE PROTECTED             */ 01750000
@RF00717 TM    SENFP(IODBREG),B'00000100'                       02S0722 01751000
         BNO   @RF00722                                         02S0722 01752000
*     DO;                                                       02S0723 01753000
*       ERBID = MSGFP;              /* SET MESSAGE ID                */ 01754000
         MVI   ERBID(CCTREG),X'0D'                              02S0724 01755000
*       GO TO TERMEXIT;             /* AND EXIT                      */ 01756000
         B     TERMEXIT                                         02S0725 01757000
*     END;                                                      02S0726 01758000
*   ERBID = MSGUNK;                 /* CONDITION NOT FOUND--SET 02S0727 01759000
*                                      GENERAL MESSAGE ID            */ 01760000
@RF00722 MVI   ERBID(CCTREG),X'1D'                              02S0727 01761000
*   GO TO TERMEXIT;                 /* AND EXIT                      */ 01762000
*                                                               02S0728 01763000
         B     TERMEXIT                                         02S0728 01764000
*   /*****************************************************************/ 01765000
*   /*                                                               */ 01766000
*   /* NO OTHER CONDITIONS ARE EXPECTED FROM A 2305-1 OR 2305-2. IF  */ 01767000
*   /* OTHER CONDITIONS OCCUR THEY ARE DO TO HARDWARE OR PROGRAMMIN  */ 01768000
*   /* ERRORS .                                                      */ 01769000
*   /*                                                               */ 01770000
*   /*****************************************************************/ 01771000
*                                                               02S0729 01772000
*                                                               02S0729 01773000
*   /*****************************************************************/ 01774000
*   /*                                                               */ 01775000
*   /* 3340 ERROR RECOVERY ROUTINE                                   */ 01776000
*   /*                                                               */ 01777000
*   /*****************************************************************/ 01778000
*                                                               02S0729 01779000
*                                                               02S0729 01780000
*   /*****************************************************************/ 01781000
*   /*                                                               */ 01782000
*   /* THE FOLLOWING CONDITIONS ARE HANDLED IN COMMON CODE, COMMAND  */ 01783000
*   /* REJECT--SENSE BYTE 0 BIT 0, INTERVENTION REQUIRED--SENSE BYTE */ 01784000
*   /* 0 BIT 1, BUS OUT CHECK--SENSE BYTE 0 BIT 2, AND EQUIPMENT     */ 01785000
*   /* CHECK--SENSE BYTE O BIT 3.                                    */ 01786000
*   /*                                                               */ 01787000
*   /*****************************************************************/ 01788000
*                                                               02S0729 01789000
*/*D3340: N THIS HANDLES 3340 ERROR RECOVERY                         */ 01790000
*/* D (YES,CCMDRJT,NO,) CMD REJECT ?                                 */ 01791000
*/* D (YES,CINTVREQ,NO,) INTV REQUIRED ?                             */ 01792000
*/* D (YES,CBUSOUT,NO,) BUS OUT CK ?                                 */ 01793000
*/* D (YES,CEQUCK,NO,D3340DC) EQUIPMENT CK ?                         */ 01794000
*                                                               02S0729 01795000
*D3340:                                                         02S0729 01796000
*   IF SENCR = ON THEN              /* IF COMMAND REJECT Y02130      */ 01797000
D3340    TM    SENCR(IODBREG),B'10000000'                       02S0729 01798000
         BO    @RT00729                                         02S0729 01799000
*     GO TO CCMDRJT;                /* HANDLE IN COMMON CODE Y02130  */ 01800000
*   IF SENIR = ON THEN              /* IF INTERVENTION REQUIRED 02S0731 01801000
*                                      Y02130                        */ 01802000
         TM    SENIR(IODBREG),B'01000000'                       02S0731 01803000
         BO    @RT00731                                         02S0731 01804000
*     GO TO CINTVREQ;               /* HANDLE IN COMMON CODE Y02130  */ 01805000
*   IF SENBO = ON THEN              /* IF BUS OUT CHECK Y02130       */ 01806000
         TM    SENBO(IODBREG),B'00100000'                       02S0733 01807000
         BO    @RT00733                                         02S0733 01808000
*     GO TO CBUSOUT;                /* HANDLE IN COMMON CODE Y02130  */ 01809000
*   IF SENEC = ON THEN              /* IF EQUIPMENT CHECK Y02130     */ 01810000
         TM    SENEC(IODBREG),B'00010000'                       02S0735 01811000
         BO    @RT00735                                         02S0735 01812000
*     GO TO CEQUCK;                 /* HANDLE IN COMMON CODE         */ 01813000
*                                                               02S0736 01814000
*   /*****************************************************************/ 01815000
*   /*                                                               */ 01816000
*   /* THE FOLLOWING CODE HANDLES DATA CHECK--SENSE BYTE 0 BIT 4.    */ 01817000
*   /*                                                               */ 01818000
*   /*****************************************************************/ 01819000
*                                                               02S0737 01820000
*/*D3340DC: D (YES,,NO,D3340O) DATA CK ?                             */ 01821000
*/* D (YES,,NO,D3340DCR) CORRECTABLE ?                               */ 01822000
*/* P OBTAIN ERROR DISPLACEMENT FROM SENSE BYTES 18 & 19             */ 01823000
*/* P OBTAIN RESTART DISPLACEMENT FROM SENSE 15, 16, 17              */ 01824000
*/* P ERROR OFFSET = RESTART DISPLACEMENT - ERROR DISPLACEMENT       */ 01825000
*/* P X-OR PATTERN FROM SENSE BYTES 20, 21, AND 22                   */ 01826000
*/*OPRIN: D (YES,,NO,DRC0) OPERATION INCOMPLETE ?                    */ 01827000
*/* P OBTAIN SEEK CCHH--CCH FROM USER, LOW H FROM BITS 3-7 OF SENSE 6*/ 01828000
*/* S AMDSAEOC:INCREMENT SEEK ADDRESS BY 1                           */ 01829000
*/* N CONSTRUCT RESTART 2 CCW                                        */ 01830000
*/* P CMD CCW FROM SENSE 3                                           */ 01831000
*/* P DATA ADDRESS = CCW DATA ADDR + SENSE 15-17                     */ 01832000
*/* P FLAGS = ORIGINAL FLAGS - PCI                                   */ 01833000
*/* P COUNT = CCW COUNT - SENSE 15-17                                */ 01834000
*/* D (YES,DRC0,NO,COUNTOK) COUNT = 0 ?                              */ 01835000
*/*COUNTOK: P RETRY OPERATION SEEK TO CALCULATED CCHHR               */ 01836000
*/* P SFM (ORIGINAL) SET SECTOR (0)                                  */ 01837000
*/* P SEARCH ID R1 TIC *-8 RESTART 2 CCW                             */ 01838000
*/*D3340DCR: S AMDSAERB:SVC 20 DAERB, CC=04, PCT=2, SCT=0            */ 01839000
*/* N (,REPEATOP) REPEAT OPERATION                                   */ 01840000
*   IF SENDC = ON THEN              /* IF DATA CHECK Y02130          */ 01841000
         TM    SENDC(IODBREG),B'00001000'                       02S0737 01842000
         BNO   @RF00737                                         02S0737 01843000
*     DO;                           /* Y02130                        */ 01844000
*       IF SENCO = OFF THEN         /* AND IF IT IS NOT CORRECTABLE     01845000
*                                      Y02130                        */ 01846000
         TM    SENCO(IODBREG),B'01000000'                       02S0739 01847000
         BNZ   @RF00739                                         02S0739 01848000
*         DO;                       /* Y02130                        */ 01849000
*           ERBPID = MSGDC;         /* SET MESSAGE ID Y02130         */ 01850000
         MVI   ERBPID,X'04'                                     02S0741 01851000
*           ERBSCT = ZERO;          /* SET SECONDARY RETRY COUNT        01852000
*                                      Y02130                        */ 01853000
         MVI   ERBSCT,X'00'                                     02S0742 01854000
*           ERBPCT = TEN;           /* SET PRIMARY RETRY COUNT Y02130*/ 01855000
         MVI   ERBPCT,X'0A'                                     02S0743 01856000
*           R1 = ADDR(ERBPARM);     /* SET INPUT REG Y02130          */ 01857000
         LA    R1,ERBPARM                                       02S0744 01858000
*           SVC (ERBSVC);           /* UPDATE ERB Y02130             */ 01859000
         SVC   20                                               02S0745 01860000
*           GO TO REPEATOP;         /* RETRY OPERATION Y02130        */ 01861000
         B     REPEATOP                                         02S0746 01862000
*         END;                      /* Y02130                        */ 01863000
*       ELSE                                                    02S0748 01864000
*         IF CCWSKIP = OFF THEN     /* IF SKIP BIT IS OFF            */ 01865000
@RF00739 TM    CCWSKIP(CCWREG),B'00010000'                      02S0748 01866000
         BNZ   @RF00748                                         02S0748 01867000
*           DO;                     /* Y02130                        */ 01868000
*             EROFFSET = CCWDADDR + SENS1517 - SENS1819; /* CALCULATE   01869000
*                                      ERROR OFFSET Y02130           */ 01870000
         L     EROFFSET,CCWDADDR-1(,CCWREG)                     02S0750 01871000
         LA    EROFFSET,0(,EROFFSET)                            02S0750 01872000
         SLR   @10,@10                                          02S0750 01873000
         ICM   @10,7,SENS1517(IODBREG)                          02S0750 01874000
         ALR   EROFFSET,@10                                     02S0750 01875000
         LH    @10,SENS1819(,IODBREG)                           02S0750 01876000
         N     @10,@CF00857                                     02S0750 01877000
         SLR   EROFFSET,@10                                     02S0750 01878000
*             BUFFER = BUFFER && SENS2022; /* CORRECT DATA IN ERROR     01879000
*                                      Y02130                        */ 01880000
         XC    BUFFER(3,EROFFSET),SENS2022(IODBREG)             02S0751 01881000
*           END;                    /* Y02130                        */ 01882000
*       IF SENOI = OFF THEN         /* IF OPERATION IS COMPLETE 02S0753 01883000
*                                      Y02130                        */ 01884000
@RF00748 TM    SENOI(IODBREG),B'00000001'                       02S0753 01885000
         BZ    @RT00753                                         02S0753 01886000
*         GO TO DRC0;               /* RETURN WITH DATA CORRECTED       01887000
*                                      Y02130                        */ 01888000
*       ELSE                                                    02S0755 01889000
*         DO;                       /* Y02130                        */ 01890000
*           RES0CCHH = IODBCCHH(2:7) & 'FFFFFFFFFFE0'X; /* SET SEEK     01891000
*                                      CCHH TO LAST CCHH Y02130      */ 01892000
         MVC   RES0CCHH(6),IODBCCHH+1(IODBREG)                  02S0756 01893000
         NC    RES0CCHH(6),@CB00831                             02S0756 01894000
*           RESH2 = RESH2 | (SENSE06 & '1F'X) + ONE; /* AND IN  02S0757 01895000
*                                      UPDATED HEAD FROM SENSE Y02130*/ 01896000
         LA    @10,31                                           02S0757 01897000
         SLR   @07,@07                                          02S0757 01898000
         IC    @07,SENSE06(,IODBREG)                            02S0757 01899000
         NR    @10,@07                                          02S0757 01900000
         AL    @10,@CF00062                                     02S0757 01901000
         SLR   @07,@07                                          02S0757 01902000
         IC    @07,RESH2                                        02S0757 01903000
         OR    @10,@07                                          02S0757 01904000
         STC   @10,RESH2                                        02S0757 01905000
*           RESR = ONE;             /* SET RECORD TO ONE Y02130      */ 01906000
         MVI   RESR,X'01'                                       02S0758 01907000
*           RESCMD = SENSE03;       /* USED COMMAND FROM SENSE Y02130*/ 01908000
         MVC   RESCMD(1),SENSE03(IODBREG)                       02S0759 01909000
*           RESDADDR = CCWDADDR + SENS1517; /* CALCULATE NEW DATA       01910000
*                                      ADDRESS Y02130                */ 01911000
         SLR   @10,@10                                          02S0760 01912000
         ICM   @10,7,SENS1517(IODBREG)                          02S0760 01913000
         L     @07,CCWDADDR-1(,CCWREG)                          02S0760 01914000
         LA    @07,0(,@07)                                      02S0760 01915000
         ALR   @07,@10                                          02S0760 01916000
         STCM  @07,7,RESDADDR                                   02S0760 01917000
*           RESFLAGS = CCWFLAGS;    /* USE OLD FLAGS BUT Y02130      */ 01918000
         MVC   RESFLAGS(1),CCWFLAGS(CCWREG)                     02S0761 01919000
*           RESFGPCI = OFF;         /* TURN OFF PCI FLAG Y02130      */ 01920000
*           RESFGDC = OFF;          /* BE SURE DATA CHAINING IS OFF     01921000
*                                      Y02130                        */ 01922000
*           RESFGCC = OFF;          /* AND COMMAND CHAING Y02130     */ 01923000
         NI    RESFGPCI,B'00110111'                             02S0764 01924000
*           RESCNT = CCWCNT - SENS1517; /* CALCULATE NEW COUNT Y02130*/ 01925000
         LCR   @10,@10                                          02S0765 01926000
         LH    @07,CCWCNT(,CCWREG)                              02S0765 01927000
         N     @07,@CF00857                                     02S0765 01928000
         ALR   @10,@07                                          02S0765 01929000
         STH   @10,RESCNT                                       02S0765 01930000
*           IF RESCNT = ZERO THEN   /* IS NEW CONUT ZERO Y02130      */ 01931000
         LTR   @10,@10                                          02S0766 01932000
         BZ    @RT00766                                         02S0766 01933000
*             GO TO DRC0;           /* YES--RETURN GOOD Y02130       */ 01934000
*           IODBCAW = ADDR(RESTART); /* SET RESTART CCW ADDRESS 02S0768 01935000
*                                      Y02130                        */ 01936000
         LA    @10,RESTART                                      02S0768 01937000
         ST    @10,IODBCAW(,IODBREG)                            02S0768 01938000
*           ERBPID =MSGDC;          /* SET MESSAGE ID Y02130         */ 01939000
         MVI   ERBPID,X'04'                                     02S0769 01940000
*           ERBSCT = ZERO;          /* SET SECONDARY RETRY COUNT        01941000
*                                      Y02130                        */ 01942000
         MVI   ERBSCT,X'00'                                     02S0770 01943000
*           ERBPCT = TWO;           /* SET PRIMARY RETRY COUNT Y02130*/ 01944000
         MVI   ERBPCT,X'02'                                     02S0771 01945000
*           R1 = ADDR(ERBPARM);     /* SET INPUT REG Y02130          */ 01946000
         LA    R1,ERBPARM                                       02S0772 01947000
*           SVC (ERBSVC);           /* UPDATE ERB Y02130             */ 01948000
         SVC   20                                               02S0773 01949000
*           GO TO REPEATOP;         /* RETRY OPERATION Y02130        */ 01950000
         B     REPEATOP                                         02S0774 01951000
*         END;                      /* Y02130                        */ 01952000
*     END;                          /* Y02130                        */ 01953000
*                                                               02S0776 01954000
*   /*****************************************************************/ 01955000
*   /*                                                               */ 01956000
*   /* THE FOLLOWING CODE HANDLES OVERRUN--SENSE BYTE 0 BIT 5, TRACK */ 01957000
*   /* CONDITION CHECK--SENSE BYTE 0 BIT 6, AND SEEK CHECK--SENSE    */ 01958000
*   /* BYTE 0 BIT 7.                                                 */ 01959000
*   /*                                                               */ 01960000
*   /*****************************************************************/ 01961000
*                                                               02S0777 01962000
*/*D3340O: D (YES,,NO,D3340TCC) OVERRUN ?                            */ 01963000
*/* S AMDSAERB:SVC 20 DAERB, CC=05, PCT=10, SCT=0                    */ 01964000
*/* N (,REPEATOP) RETRY I/O OPERATION                                */ 01965000
*/*D3340TCC: D (YES,ALTRK,NO,D3340SCK) TRACK COND CHK ?              */ 01966000
*/*D3340SCK: D (YES,,NO,D3340EOC) SEEK CK ?                          */ 01967000
*/* P R11= ADDR OF RECALIBRATE CCW                                   */ 01968000
*/* S AMDSAERI:SVC 23 ISSUE RECALIBRATE                              */ 01969000
*/* D (YES,SCKERR,NO,) ERROR ?                                       */ 01970000
*/* S AMDSAERB:SVC 23 DAERB, CC=07, PCT=10, SCT=0                    */ 01971000
*/* N (,REPEATOP) RETRY I/O OPERATION                                */ 01972000
*/*SCKERR: P (,TERMEXIT) MESSAGE ID = 29                             */ 01973000
*   IF SENOR = ON THEN              /* IF OVERRUN Y02130             */ 01974000
@RF00737 TM    SENOR(IODBREG),B'00000100'                       02S0777 01975000
         BNO   @RF00777                                         02S0777 01976000
*     DO;                           /* Y02130                        */ 01977000
*       ERBPID = MSGOR;             /* SET MESSAGE ID Y02130         */ 01978000
         MVI   ERBPID,X'05'                                     02S0779 01979000
*       ERBSCT = ZERO;              /* SET SECONDARY RETRY COUNT        01980000
*                                      Y02130                        */ 01981000
         MVI   ERBSCT,X'00'                                     02S0780 01982000
*       ERBPCT = TEN;               /* SET PRIMARY RETRY COUNT Y02130*/ 01983000
         MVI   ERBPCT,X'0A'                                     02S0781 01984000
*       R1 = ADDR(ERBPARM);         /* SET INPUT REG Y02130          */ 01985000
         LA    R1,ERBPARM                                       02S0782 01986000
*       SVC (ERBSVC);               /* UPDATE ERB Y02130             */ 01987000
         SVC   20                                               02S0783 01988000
*       GO TO REPEATOP;             /* RETRY OPERATION Y02130        */ 01989000
         B     REPEATOP                                         02S0784 01990000
*     END;                          /* Y02130                        */ 01991000
*   IF SENTCC = ON THEN             /* IF TRACK CONDITION CHECK 02S0786 01992000
*                                      Y02130                        */ 01993000
@RF00777 TM    SENTCC(IODBREG),B'00000010'                      02S0786 01994000
         BO    @RT00786                                         02S0786 01995000
*     GO TO ALTRK;                  /* HANDLE AS A ALTERNATE TRACK      01996000
*                                      Y02130                        */ 01997000
*   IF SENSC = ON THEN              /* IF SEEK CHECK Y02130          */ 01998000
         TM    SENSC(IODBREG),B'00000001'                       02S0788 01999000
         BNO   @RF00788                                         02S0788 02000000
*     DO;                           /* Y02130                        */ 02001000
*       RESPECIFY (R11,RETCODE) RESTRICTED; /* RESTRICT REGISTERS       02002000
*                                      Y02130                        */ 02003000
*       R11 = ADDR(RECALBTE);       /* SET RECALIBRATE CCW Y02130    */ 02004000
         LA    R11,RECALBTE                                     02S0791 02005000
*       SVC (ERISVC);               /* ISSUE CCW Y02130              */ 02006000
         SVC   23                                               02S0792 02007000
*       IF RETCODE ^= ZERO THEN     /* WAS RECALIBRATE SUCCESSFUL       02008000
*                                      Y02130                        */ 02009000
         LTR   RETCODE,RETCODE                                  02S0793 02010000
         BZ    @RF00793                                         02S0793 02011000
*         DO;                       /* Y02130                        */ 02012000
*           ERBID = MSGERR;         /* NO--SET MESSAGE ID Y02130     */ 02013000
         MVI   ERBID(CCTREG),X'1F'                              02S0795 02014000
*           GO TO TERMEXIT;         /* AND EXIT Y02130               */ 02015000
         B     TERMEXIT                                         02S0796 02016000
*           RESPECIFY (R11,RETCODE) UNRESTRICTED; /* RELEASE    02S0797 02017000
*                                      REGISTERS Y02130              */ 02018000
*         END;                      /* Y02130                        */ 02019000
*       ERBPID = MSGSCK;            /* SET MESSAGE ID Y02130         */ 02020000
@RF00793 MVI   ERBPID,X'07'                                     02S0799 02021000
*       ERBSCT = ZERO;              /* SET SECONDARY RETRY COUNT        02022000
*                                      Y02130                        */ 02023000
         MVI   ERBSCT,X'00'                                     02S0800 02024000
*       ERBPCT = TEN;               /* SET PRIMARY RETRY COUNT Y02130*/ 02025000
         MVI   ERBPCT,X'0A'                                     02S0801 02026000
*       R1 = ADDR(ERBPARM);         /* SET INPUT REG Y02130          */ 02027000
         LA    R1,ERBPARM                                       02S0802 02028000
*       SVC (ERBSVC);               /* UPDATE ERB Y02130             */ 02029000
         SVC   20                                               02S0803 02030000
*       GO TO REPEATOP;             /* RETRY OPERATION Y02130        */ 02031000
         B     REPEATOP                                         02S0804 02032000
*     END;                          /* Y02130                        */ 02033000
*                                                               02S0805 02034000
*   /*****************************************************************/ 02035000
*   /*                                                               */ 02036000
*   /* THE FOLLOWING CODE HANDLES END OF CYLINDER--SENSE BYTE 1 BIT  */ 02037000
*   /* 2, NO RECORD FOUND--SENSE BYTE 1 BIT 4, FILE PROTECTED--SENSE */ 02038000
*   /* BYTE 1 BIT 5, AND ENVIRONMENTAL DATA--SENSE BYTE 2 BIT 3.     */ 02039000
*   /*                                                               */ 02040000
*   /*****************************************************************/ 02041000
*                                                               02S0806 02042000
*/*D3340EOC: D (YES,,NO,D3340NRF) END OF CYLINDER ?                  */ 02043000
*/* P (,TERMEXIT) MESSAGE ID = 10                                    */ 02044000
*/*D3340NRF: D (YES,,NO,D3340ITF) NO RECORD FOUND ?                  */ 02045000
*/* P (,TERMEXIT) MESSAGE ID = 12                                    */ 02046000
*/*D3340ITF: D (YES,,NO,D3340FP) INVALID TRACK FORMAT                */ 02047000
*/* P (,TERMEXIT) MESSAGE ID = 33                                    */ 02048000
*/*D3340FP: D (YES,,NO,D3340ERD) FILE PROTECTED ?                    */ 02049000
*/* P (,TERMEXIT) MESSAGE ID = 13                                    */ 02050000
*/*D3340ERD: D (YES,,NO,D3340MSC) ENVIRONMENTAL DATA ?               */ 02051000
*/* S AMDSAERB: SVC 20 DAERB, CC=32, PCT=1, SCT=0                    */ 02052000
*/* N (,REPEATOP) RETRY I/O OPERATION                                */ 02053000
*/*D3340MSC: P (,TERMEXIT) MESSAGE ID = 31                           */ 02054000
*   IF SENEOC = ON THEN             /* IF END OF CYLINDER Y02130     */ 02055000
@RF00788 TM    SENEOC(IODBREG),B'00100000'                      02S0806 02056000
         BNO   @RF00806                                         02S0806 02057000
*     DO;                           /* Y02130                        */ 02058000
*       ERBID = MSGEOC;             /* SET MESSAGE ID Y02130         */ 02059000
         MVI   ERBID(CCTREG),X'0A'                              02S0808 02060000
*       GO TO TERMEXIT;             /* AND EXIT Y02130               */ 02061000
         B     TERMEXIT                                         02S0809 02062000
*     END;                          /* Y02130                        */ 02063000
*   IF SENNRF = ON THEN             /* IF NO RECORD FOUND Y02130     */ 02064000
@RF00806 TM    SENNRF(IODBREG),B'00001000'                      02S0811 02065000
         BNO   @RF00811                                         02S0811 02066000
*     DO;                           /* Y02130                        */ 02067000
*       ERBID = MSGNRF;             /* SET MESSAGE ID Y02130         */ 02068000
         MVI   ERBID(CCTREG),X'0C'                              02S0813 02069000
*       GO TO TERMEXIT;             /* AND EXIT Y02130               */ 02070000
         B     TERMEXIT                                         02S0814 02071000
*     END;                          /* Y02130                        */ 02072000
*   IF SENITF = ON THEN             /* IF INVALID TRACK FORMAT Y02130*/ 02073000
@RF00811 TM    SENITF(IODBREG),B'01000000'                      02S0816 02074000
         BNO   @RF00816                                         02S0816 02075000
*     DO;                           /* Y02130                        */ 02076000
*       ERBID = MSGITF;             /* SET MESSAGE ID Y02130         */ 02077000
         MVI   ERBID(CCTREG),X'21'                              02S0818 02078000
*       GO TO TERMEXIT;             /* AND EXIT Y02130               */ 02079000
         B     TERMEXIT                                         02S0819 02080000
*     END;                          /* Y02130                        */ 02081000
*   IF SENFP = ON THEN              /* IF FILE PROTECTED Y02130      */ 02082000
@RF00816 TM    SENFP(IODBREG),B'00000100'                       02S0821 02083000
         BNO   @RF00821                                         02S0821 02084000
*     DO;                           /* Y02130                        */ 02085000
*       ERBID = MSGFP;              /* SET MESSAGE ID Y02130         */ 02086000
         MVI   ERBID(CCTREG),X'0D'                              02S0823 02087000
*       GO TO TERMEXIT;             /* AND EXIT Y02130               */ 02088000
         B     TERMEXIT                                         02S0824 02089000
*     END;                          /* Y02130                        */ 02090000
*   IF SENEDP = ON THEN             /* IF ENVIRONMENTAL DATA PRESENT    02091000
*                                      Y02130                        */ 02092000
@RF00821 TM    SENEDP(IODBREG),B'00010000'                      02S0826 02093000
         BNO   @RF00826                                         02S0826 02094000
*     DO;                           /* Y02130                        */ 02095000
*       ERBPID = MSGEDP;            /* SET MESSAGE ID Y02130         */ 02096000
         MVI   ERBPID,X'0B'                                     02S0828 02097000
*       ERBSCT = ZERO;              /* SET SECONDARY RETRY COUNT        02098000
*                                      Y02130                        */ 02099000
         MVI   ERBSCT,X'00'                                     02S0829 02100000
*       ERBPCT = ONE;               /* SET PRIMARY RETRY COUNT Y02130*/ 02101000
         MVI   ERBPCT,X'01'                                     02S0830 02102000
*       R1 = ADDR(ERBPARM);         /* SET INPUT REG Y02130          */ 02103000
         LA    R1,ERBPARM                                       02S0831 02104000
*       SVC (ERBSVC);               /* UPDATE ERB Y02130             */ 02105000
         SVC   20                                               02S0832 02106000
*       GO TO REPEATOP;             /* RETRY OPERATION Y02130        */ 02107000
         B     REPEATOP                                         02S0833 02108000
*     END;                          /* Y02130                        */ 02109000
*   ERBID = MSGUNK;                 /* CONDITION UNKNOWN--SET GENERAL   02110000
*                                      MESSAGE ID Y02130             */ 02111000
@RF00826 MVI   ERBID(CCTREG),X'1D'                              02S0835 02112000
*   GO TO TERMEXIT;                 /* AND EXIT Y02130               */ 02113000
*                                                               02S0836 02114000
         B     TERMEXIT                                         02S0836 02115000
*   /*****************************************************************/ 02116000
*   /*                                                               */ 02117000
*   /* NO OTHER CONDITIONS ARE EXPECTED FROM A 3340. IF OTHER        */ 02118000
*   /* CONDITIONS OCCUR THEY ARE HARDWARE OR PROGRAMMING ERRORS.     */ 02119000
*   /*                                                               */ 02120000
*   /*****************************************************************/ 02121000
*                                                               02S0837 02122000
*                                                               01S0837 02123000
*   /*****************************************************************/ 02124000
*   /*                                                               */ 02125000
*   /* ROUTINE TO INCREMENT CCHH BY ONE FOR ANY DA DEVICE            */ 02126000
*   /*                                                               */ 02127000
*   /*****************************************************************/ 02128000
*                                                               01S0837 02129000
*                                                               01S0837 02130000
*AMDSAEOC:                                                      01S0837 02131000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                            01S0837 02132000
@EL00001 L     @13,4(,@13)                                      01S0837 02133000
@EF00001 DS    0H                                               01S0837 02134000
@ER00001 LM    @14,@12,12(@13)                                  01S0837 02135000
         BR    @14                                              01S0837 02136000
AMDSAEOC DS    0H                                               01S0838 02137000
*   DCL                                                         01S0838 02138000
*         1 XCCHH DEF(RESCCHH),     /* WORK AREA TO INCREMENT CCHH   */ 02139000
*             3 XCC FIXED(15),      /* CYLINDER                      */ 02140000
*             3 XHH FIXED(15);      /* TRACK                         */ 02141000
*   DCL                                                         01S0839 02142000
*         1 WKDCTYPE BASED(WKDCTPTR), /* MAP OF DEVICE TABLE ENTRY   */ 02143000
*             3 WKDCTID BIT(8),     /* DEVICE TYPE                   */ 02144000
*             3 * BIT(8),           /* TRACK SIZE - UNUSED IN THIS      02145000
*                                      ROUTINE                       */ 02146000
*             3 WKDCTTM BIT(8);     /* TRACKS PER CYLINDER VALUE     */ 02147000
*   DCL                                                         01S0840 02148000
*         WKDCTPTR PTR(31);         /* POINTER TO DEVICE TABLE ENTRY */ 02149000
*   DCL                                                         01S0841 02150000
*         WKDCT EXTERNAL NONLOCAL;  /* DEVIC TABLE                   */ 02151000
*/*AMDSAEOC: E ENTRY TO EOC PROC                                     */ 02152000
*/* P OBTAIN CCHH                                                    */ 02153000
*/* P BUMP THE HH BY 1                                               */ 02154000
*/* P INDEX TO PROPER DEVICE TABLE ENTRY FROM IODBTYPE               */ 02155000
*/* D (YES,,NO,EOCOK) OVER CYLINDER BOUNDRY ?                        */ 02156000
*/* P HH = 00                                                        */ 02157000
*/* P CC = CC + 1                                                    */ 02158000
*/*EOCOK: P SAVE INCREMENTED CCHH                                    */ 02159000
*/* R RETURN TO CALLER                                               */ 02160000
*   XHH = XHH + ONE;                /* ADD ONE TO HH                 */ 02161000
         LA    @10,1                                            01S0842 02162000
         AH    @10,XHH                                          01S0842 02163000
         STH   @10,XHH                                          01S0842 02164000
*   WKDCTPTR = ADDR(WKDCT);         /* SET POINTER TO DEVICE TYPE       02165000
*                                      TABLE                         */ 02166000
         L     WKDCTPTR,@CA00846                                01S0843 02167000
*   DO WHILE WKDCTID ^= IODBTYPE;   /* LOOP UNTIL DEVICE IS FOUND    */ 02168000
         B     @DE00844                                         01S0844 02169000
@DL00844 DS    0H                                               01S0845 02170000
*     WKDCTPTR = WKDCTPTR + LENGTH(WKDCTYPE); /* INCREMENT POINTER   */ 02171000
         AL    WKDCTPTR,@CF00114                                01S0845 02172000
*   END;                                                        01S0846 02173000
@DE00844 CLC   WKDCTID(1,WKDCTPTR),IODBTYPE(IODBREG)            01S0846 02174000
         BNE   @DL00844                                         01S0846 02175000
*   IF XHH >= WKDCTTM THEN          /* IS IT OVER THE NUMBER OF 01S0847 02176000
*                                      TRACKS PER CYLINDER           */ 02177000
         LH    @10,XHH                                          01S0847 02178000
         SLR   @07,@07                                          01S0847 02179000
         IC    @07,WKDCTTM(,WKDCTPTR)                           01S0847 02180000
         CR    @10,@07                                          01S0847 02181000
         BL    @RF00847                                         01S0847 02182000
*     DO;                                                       01S0848 02183000
*       XHH = ZERO;                 /* YES--SET HH TO ZERO           */ 02184000
         SLR   @10,@10                                          01S0849 02185000
         STH   @10,XHH                                          01S0849 02186000
*       XCC = XCC + ONE;            /* AND INCREMENT CC              */ 02187000
         LA    @10,1                                            01S0850 02188000
         AH    @10,XCC                                          01S0850 02189000
         STH   @10,XCC                                          01S0850 02190000
*     END;                                                      01S0851 02191000
*   END AMDSAEOC;                   /* RETURN                        */ 02192000
@EL00002 DS    0H                                               01S0852 02193000
@EF00002 DS    0H                                               01S0852 02194000
@ER00002 BR    @14                                              01S0852 02195000
*/*AMDSADER: END                                                     */ 02196000
*   END AMDSADER                                                01S0853 02197000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 02198000
*/*%INCLUDE SYSLIB  (AMDSARMK)                                        * 02199000
*/*%INCLUDE SYSUT5  (DACOMMON)                                        * 02200000
*/*%INCLUDE SYSUT5  (D2314   )                                        * 02201000
*/*%INCLUDE SYSUT5  (D3330   )                                        * 02202000
*/*%INCLUDE SYSUT5  (D2305   )                                        * 02203000
*/*%INCLUDE SYSUT5  (D3340   )                                        * 02204000
*;                                                              01S0853 02205000
@DATA    DS    0H                                                       02206000
         DS    0F                                                       02207000
@SA00001 DS    18F                                                      02208000
         DS    0F                                                       02209000
@CF00062 DC    F'1'                                                     02210000
@CF00114 DC    F'3'                                                     02211000
@CF00047 DC    F'8'                                                     02212000
@CF00442 DC    F'28672'                                                 02213000
@CF00857 DC    XL4'0000FFFF'                                            02214000
@CA00781 DC    A(DEV14A)                                                02215000
@CA00782 DC    A(DEV12D)                                                02216000
@CA00846 DC    A(WKDCT)                                                 02217000
         DS    0D                                                       02218000
@CC00797 DC    C'LDER'                                                  02219000
@CB00831 DC    X'FFFFFFFFFFE0'                                          02220000
         DS    CL6                                                      02221000
SENSE    DS    CL8                                                      02222000
         ORG   SENSE                                                    02223000
@NM00031 DC    X'04'                                                    02224000
SENSEADR DS    AL3                                                      02225000
@NM00032 DC    X'20000018'                                              02226000
         ORG   SENSE+8                                                  02227000
RECALBTE DC    X'1300000020000001'                                      02228000
RDBUFLOG DC    X'2400000030000080'                                      02229000
RESRHA   DS    CL16                                                     02230000
         ORG   RESRHA                                                   02231000
@NM00033 DS    CL8                                                      02232000
         ORG   @NM00033                                                 02233000
@NM00034 DC    X'07'                                                    02234000
RESRHAA  DS    AL3                                                      02235000
@NM00035 DC    X'60000006'                                              02236000
         ORG   RESRHA+8                                                 02237000
@NM00036 DS    CL8                                                      02238000
         ORG   @NM00036                                                 02239000
@NM00037 DC    X'1A'                                                    02240000
@NM00038 DC    AL3(RESFCCHH)                                            02241000
@NM00039 DC    X'20000005'                                              02242000
         ORG   RESRHA+16                                                02243000
RESALT   DS    CL24                                                     02244000
         ORG   RESALT                                                   02245000
@NM00040 DS    CL8                                                      02246000
         ORG   @NM00040                                                 02247000
@NM00041 DC    X'07'                                                    02248000
@NM00042 DC    AL3(RES0CCHH)                                            02249000
@NM00043 DC    X'60000006'                                              02250000
         ORG   RESALT+8                                                 02251000
@NM00044 DS    CL8                                                      02252000
         ORG   @NM00044                                                 02253000
@NM00045 DC    X'1A'                                                    02254000
@NM00046 DC    AL3(RESFCCHH)                                            02255000
@NM00047 DC    X'60000005'                                              02256000
         ORG   RESALT+16                                                02257000
@NM00048 DS    CL8                                                      02258000
         ORG   @NM00048                                                 02259000
@NM00049 DC    X'16'                                                    02260000
@NM00050 DC    AL3(RESCCHH)                                             02261000
@NM00051 DC    X'20000004'                                              02262000
         ORG   RESALT+24                                                02263000
RESTART  DS    CL32                                                     02264000
         ORG   RESTART                                                  02265000
@NM00052 DS    CL8                                                      02266000
         ORG   @NM00052                                                 02267000
@NM00053 DC    X'07'                                                    02268000
@NM00054 DC    AL3(RES0CCHH)                                            02269000
@NM00055 DC    X'60000006'                                              02270000
         ORG   RESTART+8                                                02271000
RESEARCH DS    CL8                                                      02272000
         ORG   RESEARCH                                                 02273000
@NM00056 DC    X'31'                                                    02274000
@NM00057 DC    AL3(RESCCHHR)                                            02275000
@NM00058 DC    X'60000005'                                              02276000
         ORG   RESTART+16                                               02277000
@NM00059 DS    CL8                                                      02278000
         ORG   @NM00059                                                 02279000
@NM00060 DC    X'08'                                                    02280000
@NM00061 DC    AL3(RESEARCH)                                            02281000
@NM00062 DC    F'1'                                                     02282000
         ORG   RESTART+24                                               02283000
@NM00063 DS    CL8                                                      02284000
         ORG   @NM00063                                                 02285000
RESCMD   DS    BL1                                                      02286000
RESDADDR DS    AL3                                                      02287000
RESFLAGS DS    BL1                                                      02288000
         ORG   RESFLAGS                                                 02289000
RESFGDC  DS    BL1                                                      02290000
RESFGCC  EQU   RESFLAGS+0                                               02291000
@NM00064 EQU   RESFLAGS+0                                               02292000
RESFGSKP EQU   RESFLAGS+0                                               02293000
RESFGPCI EQU   RESFLAGS+0                                               02294000
@NM00065 EQU   RESFLAGS+0                                               02295000
         ORG   @NM00063+5                                               02296000
@NM00066 DC    X'00'                                                    02297000
RESCNT   DS    FL2                                                      02298000
         ORG   RESTART+32                                               02299000
RESTARTA DS    CL32                                                     02300000
         ORG   RESTARTA                                                 02301000
@NM00067 DS    CL8                                                      02302000
         ORG   @NM00067                                                 02303000
@NM00068 DC    X'07'                                                    02304000
@NM00069 DC    AL3(RES0CCHH)                                            02305000
@NM00070 DC    X'60000006'                                              02306000
         ORG   RESTARTA+8                                               02307000
RESERCH  DS    CL8                                                      02308000
         ORG   RESERCH                                                  02309000
@NM00071 DC    X'31'                                                    02310000
RESERCHA DS    AL3                                                      02311000
@NM00072 DC    X'60000005'                                              02312000
         ORG   RESTARTA+16                                              02313000
@NM00073 DS    CL8                                                      02314000
         ORG   @NM00073                                                 02315000
@NM00074 DC    X'08'                                                    02316000
@NM00075 DC    AL3(RESERCH)                                             02317000
@NM00076 DC    F'1'                                                     02318000
         ORG   RESTARTA+24                                              02319000
RESTART1 DS    CL8                                                      02320000
         ORG   RESTART1                                                 02321000
RESCMD1  DS    BL1                                                      02322000
RESDADD1 DS    AL3                                                      02323000
RESFLAG1 DS    BL1                                                      02324000
         ORG   RESFLAG1                                                 02325000
@NM00077 DS    BL1                                                      02326000
RESFGCC1 EQU   RESFLAG1+0                                               02327000
@NM00078 EQU   RESFLAG1+0                                               02328000
         ORG   RESTART1+5                                               02329000
@NM00079 DC    X'00'                                                    02330000
RESCNT1  DS    FL2                                                      02331000
         ORG   RESTARTA+32                                              02332000
@NM00080 DS    CL7                                                      02333000
         ORG   @NM00080                                                 02334000
RES0CCHH DS    CL6                                                      02335000
         ORG   RES0CCHH                                                 02336000
@NM00081 DS    CL1                                                      02337000
RESFCCHH DS    CL5                                                      02338000
         ORG   RESFCCHH                                                 02339000
RESF     DS    CL1                                                      02340000
         ORG   RESF                                                     02341000
@NM00082 DS    BL1                                                      02342000
RESFGDFT EQU   RESF+0                                                   02343000
RESFGALT EQU   RESF+0                                                   02344000
         ORG   RESFCCHH+1                                               02345000
RESCCHH  DS    CL4                                                      02346000
         ORG   RESCCHH                                                  02347000
@NM00083 DS    CL1                                                      02348000
RESC2    DS    CL1                                                      02349000
@NM00084 DS    CL1                                                      02350000
RESH2    DS    CL1                                                      02351000
         ORG   @NM00080+6                                               02352000
RESR     DS    BL1                                                      02353000
         ORG   @NM00080+7                                               02354000
         DS    CL1                                                      02355000
ERBPARM  DS    CL12                                                     02356000
         ORG   ERBPARM                                                  02357000
ERBADDR  DS    AL4                                                      02358000
ERBPID   DC    X'00'                                                    02359000
ERBSCT   DC    X'00'                                                    02360000
ERBPCT   DC    X'00'                                                    02361000
@NM00085 DS    CL1                                                      02362000
@NM00086 DC    AL4(TERMEXIT)                                            02363000
         ORG   ERBPARM+12                                               02364000
BINPLIST DS    CL10                                                     02365000
         ORG   BINPLIST                                                 02366000
BININ    DS    AL4                                                      02367000
@NM00099 DC    AL4(BINOUT)                                              02368000
@NM00100 DC    H'2'                                                     02369000
         ORG   BINPLIST+10                                              02370000
BINOUT   DS    CL4                                                      02371000
         ORG   BINOUT                                                   02372000
@NM00101 DS    CL1                                                      02373000
BINDEV   DS    CL3                                                      02374000
         ORG   BINOUT+4                                                 02375000
         DS    CL2                                                      02376000
DERPATCH DC    25F'0'                                                   02377000
         DS    5XL4                                                     02378000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02379000
@01      EQU   01                                                       02380000
@02      EQU   02                                                       02381000
@03      EQU   03                                                       02382000
@04      EQU   04                                                       02383000
@05      EQU   05                                                       02384000
@06      EQU   06                                                       02385000
@07      EQU   07                                                       02386000
@08      EQU   08                                                       02387000
@09      EQU   09                                                       02388000
@10      EQU   10                                                       02389000
@11      EQU   11                                                       02390000
@12      EQU   12                                                       02391000
@13      EQU   13                                                       02392000
@14      EQU   14                                                       02393000
@15      EQU   15                                                       02394000
WKDCTPTR EQU   @02                                                      02395000
EROFFSET EQU   @02                                                      02396000
CCWREG   EQU   @06                                                      02397000
CCTREG   EQU   @05                                                      02398000
VCCTREG  EQU   @12                                                      02399000
RETCODE  EQU   @15                                                      02400000
BASEREG  EQU   @11                                                      02401000
R1       EQU   @01                                                      02402000
R11      EQU   @11                                                      02403000
R13      EQU   @13                                                      02404000
IODBREG  EQU   @08                                                      02405000
RETREG   EQU   @14                                                      02406000
R0       EQU   @00                                                      02407000
R10      EQU   @10                                                      02408000
R12      EQU   @12                                                      02409000
R14      EQU   @14                                                      02410000
R15      EQU   @15                                                      02411000
R2       EQU   @02                                                      02412000
R3       EQU   @03                                                      02413000
R4       EQU   @04                                                      02414000
R5       EQU   @05                                                      02415000
R6       EQU   @06                                                      02416000
R7       EQU   @07                                                      02417000
R8       EQU   @08                                                      02418000
R9       EQU   @09                                                      02419000
         EXTRN DEV14A                                                   02420000
         EXTRN DEV12D                                                   02421000
         EXTRN WKDCT                                                    02422000
SADMPLSD EQU   3312                                                     02423000
ARB      EQU   0                                                        02424000
BCTH     EQU   0                                                        02425000
BCT      EQU   0                                                        02426000
BCTLPID  EQU   BCT+28                                                   02427000
BCTFLGT  EQU   BCT+44                                                   02428000
BCTFLGI  EQU   BCT+45                                                   02429000
BCTCOMP  EQU   BCTFLGI                                                  02430000
BCTIOERR EQU   BCTFLGI                                                  02431000
CCT      EQU   0                                                        02432000
CTFLG1   EQU   CCT+1                                                    02433000
CTFLG2   EQU   CCT+2                                                    02434000
CTERBDA  EQU   CCT+28                                                   02435000
CTLOWFLG EQU   CCT+48                                                   02436000
CTDMPTYP EQU   CCT+52                                                   02437000
CTIOTYPE EQU   CTDMPTYP                                                 02438000
CTCONFLG EQU   CTDMPTYP+2                                               02439000
CTBUFTYP EQU   CTDMPTYP+3                                               02440000
CTPRMT1  EQU   CTDMPTYP+24                                              02441000
CTPRMT2  EQU   CTDMPTYP+26                                              02442000
CCW      EQU   0                                                        02443000
CCWCMD   EQU   CCW                                                      02444000
CCWDADDR EQU   CCW+1                                                    02445000
CCWFLAGS EQU   CCW+4                                                    02446000
CCWSKIP  EQU   CCWFLAGS                                                 02447000
CCWCNT   EQU   CCW+6                                                    02448000
CSW      EQU   0                                                        02449000
CSWKEY00 EQU   CSW                                                      02450000
CSWCADDR EQU   CSW+1                                                    02451000
CSWUSTAT EQU   CSW+4                                                    02452000
CSWATTN  EQU   CSWUSTAT                                                 02453000
CSWUC    EQU   CSWUSTAT                                                 02454000
CSWUE    EQU   CSWUSTAT                                                 02455000
CSWCSTAT EQU   CSW+5                                                    02456000
CSWPCI   EQU   CSWCSTAT                                                 02457000
CSWIL    EQU   CSWCSTAT                                                 02458000
CSWPGC   EQU   CSWCSTAT                                                 02459000
CSWPTC   EQU   CSWCSTAT                                                 02460000
CSWCDC   EQU   CSWCSTAT                                                 02461000
CSWCCC   EQU   CSWCSTAT                                                 02462000
CSWICC   EQU   CSWCSTAT                                                 02463000
CSWCHC   EQU   CSWCSTAT                                                 02464000
CSWCNT   EQU   CSW+6                                                    02465000
DSCE     EQU   0                                                        02466000
IODB     EQU   0                                                        02467000
IODBFLAG EQU   IODB+8                                                   02468000
IODBTERM EQU   IODBFLAG                                                 02469000
IODBIOC  EQU   IODBFLAG                                                 02470000
IODBDEV  EQU   IODB+10                                                  02471000
IODBTYPE EQU   IODB+13                                                  02472000
IODBBCT  EQU   IODB+16                                                  02473000
IODBCAW  EQU   IODB+20                                                  02474000
IODBCSW  EQU   IODB+24                                                  02475000
IODBCCHH EQU   IODB+32                                                  02476000
IODBSEEK EQU   IODBCCHH+1                                               02477000
IODBSRCH EQU   IODBCCHH+3                                               02478000
IODBR    EQU   IODBCCHH+7                                               02479000
IODBSENS EQU   IODB+40                                                  02480000
MDCE     EQU   0                                                        02481000
MDCB     EQU   0                                                        02482000
MDCBGRS  EQU   MDCB+16                                                  02483000
MDCBFLGS EQU   MDCB+86                                                  02484000
PSW      EQU   0                                                        02485000
PSWSM    EQU   PSW                                                      02486000
@NM00023 EQU   PSW+1                                                    02487000
PSWCCPM  EQU   PSW+2                                                    02488000
@NM00026 EQU   PSW+3                                                    02489000
PTRT     EQU   0                                                        02490000
PTRTRSA  EQU   0                                                        02491000
RCB      EQU   0                                                        02492000
VCCT     EQU   0                                                        02493000
VCTRECSN EQU   VCCT+8                                                   02494000
VCTFLGS  EQU   VCCT+9                                                   02495000
VCTMDCE  EQU   VCCT+12                                                  02496000
VCTDSCE  EQU   VCCT+20                                                  02497000
VCTBCTH  EQU   VCCT+24                                                  02498000
VCTCBID  EQU   VCCT+64                                                  02499000
SDL      EQU   0                                                        02500000
REGLOCAL EQU   0                                                        02501000
SAVEFORM EQU   0                                                        02502000
BUFFER   EQU   0                                                        02503000
WKDCTYPE EQU   0                                                        02504000
WKDCTID  EQU   WKDCTYPE                                                 02505000
WKDCTTM  EQU   WKDCTYPE+2                                               02506000
PTRTVSA  EQU   0                                                        02507000
CTLOWDMP EQU   CTDMPTYP                                                 02508000
RESCCHHR EQU   RESCCHH                                                  02509000
ERBLOCK  EQU   CTERBDA                                                  02510000
ERBID    EQU   ERBLOCK                                                  02511000
ERBPCTR  EQU   ERBLOCK+2                                                02512000
@NM00089 EQU   IODBSENS                                                 02513000
@NM00090 EQU   @NM00089                                                 02514000
SENCR    EQU   @NM00090                                                 02515000
SENIR    EQU   @NM00090                                                 02516000
SENBO    EQU   @NM00090                                                 02517000
SENEC    EQU   @NM00090                                                 02518000
SENDC    EQU   @NM00090                                                 02519000
SENOR    EQU   @NM00090                                                 02520000
SENTCC   EQU   @NM00090                                                 02521000
SENSC    EQU   @NM00090                                                 02522000
@NM00091 EQU   @NM00089+1                                               02523000
SENPE    EQU   @NM00091                                                 02524000
SENITF   EQU   @NM00091                                                 02525000
SENEOC   EQU   @NM00091                                                 02526000
SENNRF   EQU   @NM00091                                                 02527000
SENFP    EQU   @NM00091                                                 02528000
SENMAM   EQU   @NM00091                                                 02529000
SENOI    EQU   @NM00091                                                 02530000
@NM00093 EQU   @NM00089+2                                               02531000
SENBLF   EQU   @NM00093                                                 02532000
SENCO    EQU   @NM00093                                                 02533000
SENEDP   EQU   @NM00093                                                 02534000
SENSE03  EQU   @NM00089+3                                               02535000
SENSE05  EQU   @NM00089+5                                               02536000
SENSE06  EQU   @NM00089+6                                               02537000
SENS1517 EQU   @NM00089+15                                              02538000
SENS1819 EQU   @NM00089+18                                              02539000
SENS2022 EQU   @NM00089+20                                              02540000
XCCHH    EQU   RESCCHH                                                  02541000
XCC      EQU   XCCHH                                                    02542000
XHH      EQU   XCCHH+2                                                  02543000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02544000
@NM00098 EQU   @NM00089+23                                              02545000
@NM00097 EQU   @NM00089+7                                               02546000
@NM00096 EQU   @NM00089+4                                               02547000
@NM00095 EQU   @NM00093                                                 02548000
@NM00094 EQU   @NM00093                                                 02549000
@NM00092 EQU   @NM00091                                                 02550000
@NM00088 EQU   ERBLOCK+3                                                02551000
@NM00087 EQU   ERBLOCK+1                                                02552000
CTADDRE  EQU   CTLOWDMP+4                                               02553000
CTADDRS  EQU   CTLOWDMP                                                 02554000
@NM00102 EQU   WKDCTYPE+1                                               02555000
SAVER12  EQU   SAVEFORM+68                                              02556000
SAVER11  EQU   SAVEFORM+64                                              02557000
SAVER10  EQU   SAVEFORM+60                                              02558000
SAVER9   EQU   SAVEFORM+56                                              02559000
SAVER8   EQU   SAVEFORM+52                                              02560000
SAVER7   EQU   SAVEFORM+48                                              02561000
SAVER6   EQU   SAVEFORM+44                                              02562000
SAVER5   EQU   SAVEFORM+40                                              02563000
SAVER4   EQU   SAVEFORM+36                                              02564000
SAVER3   EQU   SAVEFORM+32                                              02565000
SAVER2   EQU   SAVEFORM+28                                              02566000
SAVER1   EQU   SAVEFORM+24                                              02567000
SAVER0   EQU   SAVEFORM+20                                              02568000
SAVER15  EQU   SAVEFORM+16                                              02569000
SAVER14  EQU   SAVEFORM+12                                              02570000
SAVENEXT EQU   SAVEFORM+8                                               02571000
SAVEBACK EQU   SAVEFORM+4                                               02572000
SAVENAME EQU   SAVEFORM+1                                               02573000
SAVEID   EQU   SAVEFORM                                                 02574000
REGL15   EQU   REGLOCAL+60                                              02575000
REGL14   EQU   REGLOCAL+56                                              02576000
REGL13   EQU   REGLOCAL+52                                              02577000
REGL12   EQU   REGLOCAL+48                                              02578000
REGL11   EQU   REGLOCAL+44                                              02579000
REGL10   EQU   REGLOCAL+40                                              02580000
REGL9    EQU   REGLOCAL+36                                              02581000
REGL8    EQU   REGLOCAL+32                                              02582000
REGL7    EQU   REGLOCAL+28                                              02583000
REGL6    EQU   REGLOCAL+24                                              02584000
REGL5    EQU   REGLOCAL+20                                              02585000
REGL4    EQU   REGLOCAL+16                                              02586000
REGL3    EQU   REGLOCAL+12                                              02587000
REGL2    EQU   REGLOCAL+8                                               02588000
REGL1    EQU   REGLOCAL+4                                               02589000
REGL0    EQU   REGLOCAL                                                 02590000
SDLSPN   EQU   SDL+1                                                    02591000
SDLNUM   EQU   SDL                                                      02592000
VCTVCCTV EQU   VCCT+108                                                 02593000
VCTCCTV  EQU   VCCT+104                                                 02594000
@NM00030 EQU   VCCT+102                                                 02595000
VCTEXTRA EQU   VCCT+100                                                 02596000
VCTCPOUT EQU   VCCT+96                                                  02597000
VCTSVCTB EQU   VCCT+92                                                  02598000
VCTPGT   EQU   VCCT+88                                                  02599000
VCTLPA   EQU   VCCT+84                                                  02600000
VCTCBADR EQU   VCCT+80                                                  02601000
VCTJBNME EQU   VCCT+72                                                  02602000
VCTCBIDN EQU   VCTCBID+7                                                02603000
@NM00029 EQU   VCTCBID                                                  02604000
VCTAUDIT EQU   VCCT+62                                                  02605000
VCTASID  EQU   VCCT+60                                                  02606000
VCTPTRT  EQU   VCCT+56                                                  02607000
VCTMASCB EQU   VCCT+52                                                  02608000
VCTASCB  EQU   VCCT+48                                                  02609000
VCTCPUC  EQU   VCCT+46                                                  02610000
VCTWKC   EQU   VCCT+45                                                  02611000
VCTWKHI  EQU   VCCT+44                                                  02612000
VCTSUBPL EQU   VCCT+40                                                  02613000
VCTARB   EQU   VCCT+36                                                  02614000
VCTIODB  EQU   VCCT+32                                                  02615000
VCTBCTC  EQU   VCCT+28                                                  02616000
VCTSTOR  EQU   VCCT+16                                                  02617000
VCTRECVA EQU   VCCT+10                                                  02618000
@NM00028 EQU   VCTFLGS                                                  02619000
VCTNOI22 EQU   VCTFLGS                                                  02620000
VCTLRCLM EQU   VCTFLGS                                                  02621000
VCTARCLM EQU   VCTFLGS                                                  02622000
VCTASMIC EQU   VCTFLGS                                                  02623000
VCTMEMIN EQU   VCTFLGS                                                  02624000
VCTSADMP EQU   VCTFLGS                                                  02625000
@NM00027 EQU   VCTRECSN                                                 02626000
VCTRSMR  EQU   VCTRECSN                                                 02627000
VCTEXIR  EQU   VCTRECSN                                                 02628000
VCTUPDR  EQU   VCTRECSN                                                 02629000
VCTPGIR  EQU   VCTRECSN                                                 02630000
VCTRCB   EQU   VCCT+4                                                   02631000
VCTVCT   EQU   VCCT                                                     02632000
RCBBASE  EQU   RCB+16                                                   02633000
RCBEXIT  EQU   RCB+12                                                   02634000
RCBSAVE  EQU   RCB+8                                                    02635000
RCBSTOR  EQU   RCB+4                                                    02636000
RCBNEXT  EQU   RCB                                                      02637000
PTRTVS   EQU   PTRT+1032                                                02638000
PTRTRS   EQU   PTRT+8                                                   02639000
PTRTLGID EQU   PTRT+4                                                   02640000
PTRTPTRT EQU   PTRT                                                     02641000
PSWEND   EQU   PSW+8                                                    02642000
PSWIA    EQU   PSW+4                                                    02643000
PSWSP    EQU   @NM00026                                                 02644000
PSWSIG   EQU   PSWCCPM                                                  02645000
PSWEU    EQU   PSWCCPM                                                  02646000
PSWDO    EQU   PSWCCPM                                                  02647000
PSWFPO   EQU   PSWCCPM                                                  02648000
@NM00025 EQU   PSWCCPM                                                  02649000
@NM00024 EQU   PSWCCPM                                                  02650000
PSWPRBLM EQU   @NM00023                                                 02651000
PSWAIT   EQU   @NM00023                                                 02652000
PSWMCH   EQU   @NM00023                                                 02653000
PSWMODE  EQU   @NM00023                                                 02654000
PSWKEY   EQU   @NM00023                                                 02655000
PSWXTRNL EQU   PSWSM                                                    02656000
PSWIO    EQU   PSWSM                                                    02657000
PSWDAT   EQU   PSWSM                                                    02658000
@NM00022 EQU   PSWSM                                                    02659000
@NM00021 EQU   PSWSM                                                    02660000
@NM00020 EQU   PSWSM                                                    02661000
PSWPER   EQU   PSWSM                                                    02662000
@NM00019 EQU   PSWSM                                                    02663000
@NM00018 EQU   MDCB+87                                                  02664000
@NM00017 EQU   MDCBFLGS                                                 02665000
MDCBDUMP EQU   MDCBFLGS                                                 02666000
MDCBASMI EQU   MDCBFLGS                                                 02667000
MDCBPI   EQU   MDCB+84                                                  02668000
MDCBSTOR EQU   MDCB+80                                                  02669000
MDCBGR15 EQU   MDCBGRS+60                                               02670000
MDCBGR14 EQU   MDCBGRS+56                                               02671000
MDCBGR13 EQU   MDCBGRS+52                                               02672000
MDCBGR12 EQU   MDCBGRS+48                                               02673000
MDCBGR11 EQU   MDCBGRS+44                                               02674000
MDCBGR10 EQU   MDCBGRS+40                                               02675000
MDCBGR9  EQU   MDCBGRS+36                                               02676000
MDCBGR8  EQU   MDCBGRS+32                                               02677000
MDCBGR7  EQU   MDCBGRS+28                                               02678000
MDCBGR6  EQU   MDCBGRS+24                                               02679000
MDCBGR5  EQU   MDCBGRS+20                                               02680000
MDCBGR4  EQU   MDCBGRS+16                                               02681000
MDCBGR3  EQU   MDCBGRS+12                                               02682000
MDCBGR2  EQU   MDCBGRS+8                                                02683000
MDCBGR1  EQU   MDCBGRS+4                                                02684000
MDCBGR0  EQU   MDCBGRS                                                  02685000
MDCBPSW  EQU   MDCB+8                                                   02686000
MDCBNEXT EQU   MDCB+4                                                   02687000
MDCBMDCB EQU   MDCB                                                     02688000
MDCEAVIL EQU   MDCE+8                                                   02689000
MDCEACTV EQU   MDCE+4                                                   02690000
MDCEMDCE EQU   MDCE                                                     02691000
IODBHH   EQU   IODBSRCH+2                                               02692000
IODBCC   EQU   IODBSRCH                                                 02693000
IODBM    EQU   IODBCCHH                                                 02694000
IODBCPU  EQU   IODB+14                                                  02695000
IODBCLAS EQU   IODB+12                                                  02696000
@NM00016 EQU   IODBFLAG+1                                               02697000
IODBSTRT EQU   IODBFLAG                                                 02698000
IODBCONW EQU   IODBFLAG                                                 02699000
IODBACTV EQU   IODBFLAG                                                 02700000
IODBHALT EQU   IODBFLAG                                                 02701000
IODBINT  EQU   IODBFLAG                                                 02702000
IODBPTRM EQU   IODBFLAG                                                 02703000
IODBIDEN EQU   IODB+4                                                   02704000
IODBIODB EQU   IODB                                                     02705000
DSCETEND EQU   DSCE+20                                                  02706000
DSCETCUR EQU   DSCE+16                                                  02707000
DSCETBEG EQU   DSCE+12                                                  02708000
DSCENEXT EQU   DSCE+8                                                   02709000
DSCEBEGN EQU   DSCE+4                                                   02710000
DSCEDSCE EQU   DSCE                                                     02711000
CSWDE    EQU   CSWUSTAT                                                 02712000
CSWCE    EQU   CSWUSTAT                                                 02713000
CSWBUSY  EQU   CSWUSTAT                                                 02714000
CSWCUE   EQU   CSWUSTAT                                                 02715000
CSWSTMOD EQU   CSWUSTAT                                                 02716000
@NM00015 EQU   CSWKEY00                                                 02717000
CSWKEY   EQU   CSWKEY00                                                 02718000
@NM00014 EQU   CCW+5                                                    02719000
@NM00013 EQU   CCWFLAGS                                                 02720000
CCWIDA   EQU   CCWFLAGS                                                 02721000
CCWPCI   EQU   CCWFLAGS                                                 02722000
CCWSLI   EQU   CCWFLAGS                                                 02723000
CCWCC    EQU   CCWFLAGS                                                 02724000
CCWDC    EQU   CCWFLAGS                                                 02725000
CTHWMAX  EQU   CTDMPTYP+29                                              02726000
CTHWM    EQU   CTDMPTYP+28                                              02727000
CTPRMT2X EQU   CTPRMT2+1                                                02728000
CTPRMT2Y EQU   CTPRMT2                                                  02729000
CTPRMT1X EQU   CTPRMT1+1                                                02730000
CTPRMT1Y EQU   CTPRMT1                                                  02731000
CTVCCT   EQU   CTDMPTYP+20                                              02732000
CTEOR    EQU   CTDMPTYP+16                                              02733000
CTCOMMIO EQU   CTDMPTYP+12                                              02734000
CTLWKAD  EQU   CTDMPTYP+8                                               02735000
CTCONSOL EQU   CTDMPTYP+4                                               02736000
@NM00012 EQU   CTBUFTYP                                                 02737000
CTDUMP   EQU   CTBUFTYP                                                 02738000
CTLSQA   EQU   CTBUFTYP                                                 02739000
CTASM    EQU   CTBUFTYP                                                 02740000
CTPGT    EQU   CTBUFTYP                                                 02741000
CTWKFLE  EQU   CTBUFTYP                                                 02742000
@NM00011 EQU   CTBUFTYP                                                 02743000
@NM00010 EQU   CTCONFLG                                                 02744000
CTREAD   EQU   CTCONFLG                                                 02745000
CTMSGOUT EQU   CTCONFLG                                                 02746000
@NM00009 EQU   CTDMPTYP+1                                               02747000
@NM00008 EQU   CTIOTYPE                                                 02748000
CTIORSET EQU   CTIOTYPE                                                 02749000
CTIOINT  EQU   CTIOTYPE                                                 02750000
CTIOCON  EQU   CTIOTYPE                                                 02751000
CTIOWK   EQU   CTIOTYPE                                                 02752000
CTIODA   EQU   CTIOTYPE                                                 02753000
CTIOOUT  EQU   CTIOTYPE                                                 02754000
CTIOTERM EQU   CTIOTYPE                                                 02755000
CTEBCOPR EQU   CCT+49                                                   02756000
@NM00007 EQU   CTLOWFLG                                                 02757000
CTWKSTUS EQU   CTLOWFLG                                                 02758000
CTINIT   EQU   CTLOWFLG                                                 02759000
CTFP     EQU   CTLOWFLG                                                 02760000
CTVIRTD  EQU   CTLOWFLG                                                 02761000
CTEBCOPD EQU   CCT+45                                                   02762000
CTCONTYP EQU   CCT+44                                                   02763000
CTOUTAD  EQU   CCT+42                                                   02764000
CTCPUI   EQU   CCT+40                                                   02765000
CTERBCON EQU   CCT+36                                                   02766000
CTERBTPE EQU   CCT+32                                                   02767000
CTCCHHW  EQU   CCT+24                                                   02768000
CTCCHHE  EQU   CCT+20                                                   02769000
CTCCHHS  EQU   CCT+16                                                   02770000
CTPGECNT EQU   CCT+15                                                   02771000
CTCCHHR  EQU   CCT+8                                                    02772000
CTINADDR EQU   CCT+6                                                    02773000
CTSENSE  EQU   CCT+4                                                    02774000
CTDEVTYP EQU   CCT+3                                                    02775000
@NM00006 EQU   CTFLG2                                                   02776000
CTALTCON EQU   CTFLG2                                                   02777000
CTWKDONE EQU   CTFLG2                                                   02778000
CTVIRTR  EQU   CTFLG2                                                   02779000
CTNOSTAT EQU   CTFLG2                                                   02780000
CTPGEFLT EQU   CTFLG2                                                   02781000
CTSTOR   EQU   CTFLG2                                                   02782000
CTDUPSW  EQU   CTFLG2                                                   02783000
CTERREC  EQU   CTFLG1                                                   02784000
CTMP     EQU   CTFLG1                                                   02785000
@NM00005 EQU   CTFLG1                                                   02786000
CTDEFO   EQU   CTFLG1                                                   02787000
CTWORK   EQU   CTFLG1                                                   02788000
CTMORTPE EQU   CTFLG1                                                   02789000
CTDEVICE EQU   CTFLG1                                                   02790000
CTERROR  EQU   CTFLG1                                                   02791000
CTWAIT   EQU   CCT                                                      02792000
@NM00004 EQU   BCT+46                                                   02793000
BCTRECLM EQU   BCTFLGI                                                  02794000
BCTALLOC EQU   BCTFLGI                                                  02795000
@NM00003 EQU   BCTFLGT                                                  02796000
BCTPGTF  EQU   BCTFLGT                                                  02797000
BCTDUMP  EQU   BCTFLGT                                                  02798000
BCTLSQA  EQU   BCTFLGT                                                  02799000
BCTASM   EQU   BCTFLGT                                                  02800000
BCTPGT   EQU   BCTFLGT                                                  02801000
BCTWKFLE EQU   BCTFLGT                                                  02802000
@NM00002 EQU   BCTFLGT                                                  02803000
BCTRBA   EQU   BCT+40                                                   02804000
BCTAMB   EQU   BCT+36                                                   02805000
@NM00001 EQU   BCTLPID+4                                                02806000
BCTLGN   EQU   BCTLPID                                                  02807000
BCTMDCB  EQU   BCT+24                                                   02808000
BCTPGTE  EQU   BCT+20                                                   02809000
BCTRADDR EQU   BCT+16                                                   02810000
BCTVADDR EQU   BCT+12                                                   02811000
BCTASID  EQU   BCT+10                                                   02812000
BCTKEY2  EQU   BCT+9                                                    02813000
BCTKEY1  EQU   BCT+8                                                    02814000
BCTNEXT  EQU   BCT+4                                                    02815000
BCTBCT   EQU   BCT                                                      02816000
BCTHLAST EQU   BCTH+8                                                   02817000
BCTHFRST EQU   BCTH+4                                                   02818000
BCTHBCTH EQU   BCTH                                                     02819000
ARBADDRE EQU   ARB+4                                                    02820000
ARBADDRB EQU   ARB                                                      02821000
GTMSAVE  EQU   SADMPLSD+684                                             02822000
GTMNAME  EQU   SADMPLSD+680                                             02823000
FRMSAVE  EQU   SADMPLSD+580                                             02824000
FRMNAME  EQU   SADMPLSD+576                                             02825000
AUDSAVE  EQU   SADMPLSD+476                                             02826000
AUDNAME  EQU   SADMPLSD+472                                             02827000
IOISAVE  EQU   SADMPLSD+372                                             02828000
IOINAME  EQU   SADMPLSD+368                                             02829000
PGISAVE  EQU   SADMPLSD+268                                             02830000
PGINAME  EQU   SADMPLSD+264                                             02831000
SVISAVE  EQU   SADMPLSD+164                                             02832000
SVINAME  EQU   SADMPLSD+160                                             02833000
LOWCRS   EQU   SADMPLSD+96                                              02834000
LOWGRS   EQU   SADMPLSD+32                                              02835000
SAVEDUMP EQU   SADMPLSD+24                                              02836000
AUDPSW   EQU   SADMPLSD+16                                              02837000
SVIRPSW  EQU   SADMPLSD+8                                               02838000
PSWSADMP EQU   SADMPLSD                                                 02839000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      02840000
@RT00239 EQU   D2314                                                    02841000
@RT00241 EQU   D3330                                                    02842000
@RT00243 EQU   D2305                                                    02843000
@RT00245 EQU   D3340                                                    02844000
@RT00247 EQU   D3350                                                    02845000
@RT00304 EQU   CCC                                                      02846000
@RF00306 EQU   DRC0                                                     02847000
@RT00372 EQU   CEQUCK                                                   02848000
@RT00381 EQU   ERRID                                                    02849000
@RT00416 EQU   ERRID                                                    02850000
@RT00426 EQU   CINTVREQ                                                 02851000
@RT00428 EQU   CBUSOUT                                                  02852000
@RT00437 EQU   REPEATOP                                                 02853000
@RT00442 EQU   ERRID                                                    02854000
@RT00465 EQU   CCMDRJT                                                  02855000
@RT00467 EQU   ALTRK                                                    02856000
@RT00498 EQU   TCCERR                                                   02857000
@RF00500 EQU   @RC00496                                                 02858000
@RT00521 EQU   DRC0                                                     02859000
@RT00532 EQU   CCMDRJT                                                  02860000
@RT00534 EQU   CINTVREQ                                                 02861000
@RT00536 EQU   CBUSOUT                                                  02862000
@RT00538 EQU   CPERMERR                                                 02863000
@RT00540 EQU   CEQUCK                                                   02864000
@RT00552 EQU   DRC0                                                     02865000
@RT00567 EQU   DRC0                                                     02866000
@RT00622 EQU   DRC0                                                     02867000
@RT00634 EQU   CCMDRJT                                                  02868000
@RT00636 EQU   CINTVREQ                                                 02869000
@RT00638 EQU   CBUSOUT                                                  02870000
@RT00640 EQU   CPERMERR                                                 02871000
@RT00642 EQU   CEQUCK                                                   02872000
@RT00660 EQU   DRC0                                                     02873000
@RT00674 EQU   DRC0                                                     02874000
@RT00729 EQU   CCMDRJT                                                  02875000
@RT00731 EQU   CINTVREQ                                                 02876000
@RT00733 EQU   CBUSOUT                                                  02877000
@RT00735 EQU   CEQUCK                                                   02878000
@RT00753 EQU   DRC0                                                     02879000
@RT00766 EQU   DRC0                                                     02880000
@RT00786 EQU   ALTRK                                                    02881000
@RF00847 EQU   @EL00002                                                 02882000
@ENDDATA EQU   *                                                        02883000
         END   AMDSADER,(C'PLS2003',0603,75280)                         02884000
