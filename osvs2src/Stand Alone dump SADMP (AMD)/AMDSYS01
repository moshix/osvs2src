         TITLE 'AMDSYS01 - EDIT SYS SVC FORMAT APPENDAGE               *00001000
                        '                                               00002000
AMDSYS01 CSECT ,                                                01S0001 00003000
@MAINENT DS    0H                                               01S0001 00004000
         USING *,@15                                            01S0001 00005000
         B     @PROLOG                                          01S0001 00006000
         DC    AL1(16)                                          01S0001 00007000
         DC    C'AMDSYS01  76.069'                              01S0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                  01S0001 00010000
         BALR  @11,0                                            01S0001 00011000
@PSTART  LA    @12,4095(,@11)                                   01S0001 00012000
         LA    @08,4095(,@12)                                   01S0001 00013000
         USING @PSTART,@11                                      01S0001 00014000
         USING @PSTART+4095,@12                                 01S0001 00015000
         USING @PSTART+8190,@08                                 01S0001 00016000
*   PLISTPTR=R1;                    /* ADDR OF PLIST PASSED BY CALLER*/ 00017000
         LR    PLISTPTR,R1                                      01S0154 00018000
*   R10=DYNAMSTG;                   /* ADDR OF GETMAINED AREA        */ 00019000
         L     R10,DYNAMSTG(,PLISTPTR)                          01S0155 00020000
*   GEN SETS(R13,R15);                                          01S0156 00021000
         USING @DATD,R10             ADDRESSABILITY FOR DYNAM VARIABLES 00022000
         ST    R13,@SA00001+4                                           00023000
         LA    R15,@SA00001                                             00024000
         ST    R15,8(R13)                                               00025000
         LR    R13,R15                                                  00026000
*   ABDPLPTR=SNAPPARM;              /* ADDR OF PARMLIST              */ 00027000
         L     @14,SNAPPARM(,PLISTPTR)                          01S0157 00028000
         ST    @14,ABDPLPTR(,PLISTPTR)                          01S0157 00029000
*   IF TIMESW=0 THEN                /* IS THIS THE FIRST PASS        */ 00030000
         ICM   @14,3,TIMESW                                     01S0158 00031000
         BNZ   @RF00158                                         01S0158 00032000
*     DO;                           /* YES - CHECK TO SEE IF THIS SVC   00033000
*                                      IS TO BE PROCESSED            */ 00034000
*                                                               02S0160 00035000
*       /*************************************************************/ 00036000
*       /*                                                           */ 00037000
*       /* DETERMINE IF THIS SVC RECORD SHOULD BE PROCESSED          */ 00038000
*       /*                                                           */ 00039000
*       /*************************************************************/ 00040000
*                                                               02S0160 00041000
*       IF ERRECORD='EEEE'X THEN    /* IS ENTIRE RECORD IN ERROR     */ 00042000
         L     @14,DATAPTR(,PLISTPTR)                           02S0160 00043000
         CLC   ERRECORD(2,@14),@CB01365                         02S0160 00044000
         BNE   @RF00160                                         02S0160 00045000
*         RETCODE=12;               /* YES - INDICATES TO PRINT 02S0161 00046000
*                                      RECORD IN HEX                 */ 00047000
         LA    RETCODE,12                                       02S0161 00048000
*       ELSE                        /* NO - RECORD IS OK             */ 00049000
*         DO;                                                   02S0162 00050000
         B     @RC00160                                         02S0162 00051000
@RF00160 DS    0H                                               02S0163 00052000
*           IF ALLV=ON THEN         /* ARE ALL SVCS BEING TRACED     */ 00053000
         TM    ALLV(AEDITCBR),B'10000000'                       02S0163 00054000
         BNO   @RF00163                                         02S0163 00055000
*             RETCODE=0;            /* YES - INDICATES TO FORMAT THIS   00056000
*                                      RECORD                        */ 00057000
         SLR   RETCODE,RETCODE                                  02S0164 00058000
*           ELSE                    /* NO - CHECK TABLE OF SVCS      */ 00059000
*             DO;                                               02S0165 00060000
         B     @RC00163                                         02S0165 00061000
@RF00163 DS    0H                                               02S0166 00062000
*               I=SYSSVC/8;         /* CALCULATE BYTE                */ 00063000
         L     @14,DATAPTR(,PLISTPTR)                           02S0166 00064000
         SLR   @05,@05                                          02S0166 00065000
         IC    @05,SYSSVC(,@14)                                 02S0166 00066000
         LR    I,@05                                            02S0166 00067000
         SRL   I,3                                              02S0166 00068000
*               J=SYSSVC//8;        /* CALCULATE BIT IN BYTE         */ 00069000
         LR    @02,@05                                          02S0167 00070000
         SRDA  @02,32                                           02S0167 00071000
         D     @02,@CF00034                                     02S0167 00072000
         LR    J,@02                                            02S0167 00073000
*               IF(SVCLIST(I+1)&HEXTEST(J+1))^=0 THEN/* IS THIS SVC     00074000
*                                      BEING TRACED                  */ 00075000
         SLR   @14,@14                                          02S0168 00076000
         LR    @05,J                                            02S0168 00077000
         ALR   @05,@05                                          02S0168 00078000
         LH    @05,HEXTEST(@05)                                 02S0168 00079000
         SLR   @03,@03                                          02S0168 00080000
         IC    @03,SVCLIST(I,AEDITCBR)                          02S0168 00081000
         NR    @05,@03                                          02S0168 00082000
         CR    @05,@14                                          02S0168 00083000
         BE    @RF00168                                         02S0168 00084000
*                 RETCODE=0;        /* YES - INDICATES TO FORMAT THIS   00085000
*                                      SVC                           */ 00086000
         LR    RETCODE,@14                                      02S0169 00087000
*               ELSE                /* NO - THIS SVC ISN'T BEING        00088000
*                                      TRACED                        */ 00089000
*                 RETCODE=8;        /* INDICATES TO SKIP THIS AND GET   00090000
*                                      NEXT SVC RECORD               */ 00091000
         B     @RC00168                                         02S0170 00092000
@RF00168 LA    RETCODE,8                                        02S0170 00093000
*             END;                                              02S0171 00094000
@RC00168 DS    0H                                               02S0172 00095000
*         END;                                                  02S0172 00096000
@RC00163 DS    0H                                               02S0173 00097000
*       IF RETCODE=0 THEN           /* IS THIS SVC TO BE FORMATTED   */ 00098000
@RC00160 LTR   RETCODE,RETCODE                                  01S0173 00099000
         BNZ   @RF00173                                         01S0173 00100000
*         DO;                       /* YES - FORMAT THE FIRST LINE   */ 00101000
*                                                               02S0175 00102000
*           /*********************************************************/ 00103000
*           /*                                                       */ 00104000
*           /* FORMAT THE FIRST LINE OF THE BASIC RECORD             */ 00105000
*           /*                                                       */ 00106000
*           /*********************************************************/ 00107000
*                                                               02S0175 00108000
*           CNVTSVC=SYSSVC;         /* MOVE SVC NUMB FOR CONVERT     */ 00109000
         L     @14,DATAPTR(,PLISTPTR)                           02S0175 00110000
         SLR   CNVTSVC,CNVTSVC                                  02S0175 00111000
         IC    CNVTSVC,SYSSVC(,@14)                             02S0175 00112000
*           CVD(CNVTSVC,PAKEDSVC);  /* CONVERT TO DECIMAL            */ 00113000
         CVD   CNVTSVC,@TS00001                                 02S0176 00114000
         MVC   PAKEDSVC(2),@TS00001+6                           02S0176 00115000
*           UNPK(UNPAKTO,UNPAKFRM); /* UNPACK SVC NUMBER             */ 00116000
         UNPK  UNPAKTO(5),UNPAKFRM(3)                           02S0177 00117000
*           ADPLFMT2=ADDR(UNPAKTO); /* ADDR OF DECIMAL SVC NUMBER    */ 00118000
         L     @14,ABDPLPTR(,PLISTPTR)                          02S0178 00119000
         LA    @07,UNPAKTO                                      02S0178 00120000
         ST    @07,ADPLFMT2(,@14)                               02S0178 00121000
*           R0=ADDR(SVCTITLE);      /* ADDR OF FORMAT PATTERN        */ 00122000
         LA    R0,SVCTITLE                                      02S0179 00123000
*           R1=ABDPLPTR;            /* ADDR OF ABDUMP PLIST FOR 02S0180 00124000
*                                      AMDPRFMT                      */ 00125000
         LR    R1,@14                                           02S0180 00126000
*           CALL AMDPRFMT;          /* FORMAT SVC TITLE              */ 00127000
         L     @15,FMTADDR(,PLISTPTR)                           02S0181 00128000
         BALR  @14,@15                                          02S0181 00129000
*           ADPLFMT2=DATAPTR;       /* ADDR OF DATA IN BUFFER        */ 00130000
         L     @14,ABDPLPTR(,PLISTPTR)                          02S0182 00131000
         MVC   ADPLFMT2(4,@14),DATAPTR(PLISTPTR)                02S0182 00132000
*           R0=ADDR(FIRSTLN);       /* ADDR OF PATTERNS FOR FIRST       00133000
*                                      LINE                          */ 00134000
         LA    R0,FIRSTLN                                       02S0183 00135000
*           CALL AMDPRFMT;          /* FORMAT FIRST LINE             */ 00136000
         L     @15,FMTADDR(,PLISTPTR)                           02S0184 00137000
         BALR  @14,@15                                          02S0184 00138000
*           CALL SVCFORMX;          /* CHECK FOR ADDITIONAL DATA TO     00139000
*                                      BE FORMATTED                  */ 00140000
         BAL   @14,SVCFORMX                                     01S0185 00141000
*         END;                                                  01S0186 00142000
*     END;                                                      01S0187 00143000
*   ELSE                                                        01S0188 00144000
*     DO;                           /* NO - THIS IS NOT THE FIRST       00145000
*                                      PASS                          */ 00146000
         B     @RC00158                                         01S0188 00147000
@RF00158 DS    0H                                               01S0189 00148000
*       IF TIMESW=1 THEN            /* IS THIS THE SECOND PASS       */ 00149000
         CLC   TIMESW(2),@CH00046                               01S0189 00150000
         BNE   @RF00189                                         01S0189 00151000
*         DO;                       /* YES - FORMAT THE REGS         */ 00152000
*                                                               02S0191 00153000
*           /*********************************************************/ 00154000
*           /*                                                       */ 00155000
*           /* FORMAT THE SECOND LINE OF THE BASIC RECORD            */ 00156000
*           /*                                                       */ 00157000
*           /*********************************************************/ 00158000
*                                                               02S0191 00159000
*           ADPLFMT1=ADDR(LBASICL2);/* ADDR OF LABELS FOR THIS LINE  */ 00160000
         L     @14,ABDPLPTR(,PLISTPTR)                          02S0191 00161000
         LA    @07,LBASICL2                                     02S0191 00162000
         ST    @07,ADPLFMT1(,@14)                               02S0191 00163000
*           ADPLFMT2=ADDR(R15FLD);  /* ADDR OF DATA IN BUFFER        */ 00164000
         L     @07,DATAPTR(,PLISTPTR)                           02S0192 00165000
         LA    @07,R15FLD(,@07)                                 02S0192 00166000
         ST    @07,ADPLFMT2(,@14)                               02S0192 00167000
*           R0=ADDR(SECONDLN);      /* ADDR OF PATTERNS FOR SECOND      00168000
*                                      LINE                          */ 00169000
         LA    R0,SECONDLN                                      02S0193 00170000
*           R1=ABDPLPTR;            /* ADDR OF ABDUMP PLIST FOR 02S0194 00171000
*                                      AMDPRFMT                      */ 00172000
         LR    R1,@14                                           02S0194 00173000
*           CALL AMDPRFMT;          /* FORMAT REGISTERS              */ 00174000
         L     @15,FMTADDR(,PLISTPTR)                           02S0195 00175000
         BALR  @14,@15                                          02S0195 00176000
*         END;                                                  01S0196 00177000
*       CALL SVCFORMX;              /* CHECK FOR ADDITIONAL DATA TO     00178000
*                                      BE FORMATTED                  */ 00179000
@RF00189 BAL   @14,SVCFORMX                                     01S0197 00180000
*     END;                                                      01S0198 00181000
*   IF RETCODE=0 THEN               /* IS ANOTHER PASS NECESSARY     */ 00182000
@RC00158 LTR   RETCODE,RETCODE                                  01S0199 00183000
         BNZ   @RF00199                                         01S0199 00184000
*     TIMESW=TIMESW+1;              /* YES - INDICATES TO PROCESS       00185000
*                                      SUBSEQUENT PASSES             */ 00186000
         LA    @14,1                                            01S0200 00187000
         AH    @14,TIMESW                                       01S0200 00188000
         STH   @14,TIMESW                                       01S0200 00189000
*   RETURN CODE(RETCODE);           /* RETURN TO CALLER WITH RETURN     00190000
*                                      CODE                          */ 00191000
@RF00199 L     @13,4(,@13)                                      01S0201 00192000
         L     @14,12(,@13)                                     01S0201 00193000
         LM    @00,@12,20(@13)                                  01S0201 00194000
         BR    @14                                              01S0201 00195000
*                                                               02S0202 00196000
*   /*****************************************************************/ 00197000
*   /*                                                               */ 00198000
*   /* USING THE SVC NUMBER IN THE BASIC RECORD BRANCH TO THE        */ 00199000
*   /* SPECIFIC ROUTINE AND DETERMINE WHAT ADDITIONAL DATA IS TO BE  */ 00200000
*   /* FORMATTED                                                     */ 00201000
*   /*                                                               */ 00202000
*   /*****************************************************************/ 00203000
*                                                               02S0202 00204000
*SVCFORMX:                                                      02S0202 00205000
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                            02S0202 00206000
SVCFORMX DS    0H                                               02S0203 00207000
*   RESPECIFY                                                   02S0203 00208000
*     R14 RESTRICTED;                                           02S0203 00209000
*   SAVER14=R14;                    /* SAVE RETURN POINT ADDR        */ 00210000
         ST    R14,SAVER14                                      02S0204 00211000
*   RESPECIFY                                                   02S0205 00212000
*     R14 UNRESTRICTED;                                         02S0205 00213000
*   R1=ABDPLPTR;                    /* ADDR OF ABDUMP PLIST FOR 02S0206 00214000
*                                      AMDPRFMT                      */ 00215000
         L     R1,ABDPLPTR(,PLISTPTR)                           02S0206 00216000
*   SVCNUMBR=SYSSVC;                /* SVC NUMBER FOR BRANCH TABLE   */ 00217000
         L     @14,DATAPTR(,PLISTPTR)                           02S0207 00218000
         SLR   SVCNUMBR,SVCNUMBR                                02S0207 00219000
         IC    SVCNUMBR,SYSSVC(,@14)                            02S0207 00220000
*   IF SVCNUMBR^='FF'X THEN         /* IS THIS SVC 255               */ 00221000
         CH    SVCNUMBR,@CH01372                                02S0208 00222000
         BE    @RF00208                                         02S0208 00223000
*     SVCNUMBR=SVCNUMBR+1;          /* NO - INCREMENT SVC NUMBER FOR    00224000
*                                      BRANCH TABLE                  */ 00225000
         AH    SVCNUMBR,@CH00046                                02S0209 00226000
*   DO;                             /* CASE(SVCNUMBR)NAMES(S00,GP2,GP   00227000
*                                      2,G1,GP2,GP2,S06,S06,S08,S08,G   00228000
*                                      1,G1,G1,S13,S14,S15,S16,GP2,GP   00229000
*                                      2,GP2,GP2,S21,GP2,GP2,GP3,S25,   00230000
*                                      S26,S27,S13,S29,S30,GP3,S32,S3   00231000
*                                      2,G1,GP2,G1,GP2,G1,GP2,GP2,S08   00232000
*                                      ,S42,G1,S44,GP2,G1,GP2,S48,G1,   00233000
*                                      G1,GP2,S52,GP3,S00,GP3,S48,GP3   00234000
*                                      ,GP3,G1,GP2,G1,S44,GP2,GP2,G1,   00235000
*                                      S66,G1,S13,GP3,GP2,S71,G1,GP2,   00236000
*                                      GP2,S75,G1,G1,S32,G1,GP2,S71,S   00237000
*                                      82,G1,G1,G1,S86,GP2,S88,G1,G1,   00238000
*                                      G1,S00,G1,G1,G1,GP2,G1,S98,G1,   00239000
*                                      G1,G1,GP2,G1,G1,G1,G1,G1,G1,G1   00240000
*                                      ,G1,G1,G1,G1,S00,G1,G1,G1,G1,G   00241000
*                                      1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G   00242000
*                                      1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G   00243000
*                                      1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G   00244000
*                                      1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G   00245000
*                                      1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G   00246000
*                                      1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G   00247000
*                                      1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G   00248000
*                                      1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G   00249000
*                                      1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G   00250000
*                                      1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G   00251000
*                                      1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G   00252000
*                                      1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G   00253000
*                                      1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G   00254000
*                                      1,G1,G1,G1,G1,G1)             */ 00255000
@RF00208 DS    0H                                               02S0211 00256000
*     DCL                                                       02S0211 00257000
*       CL0001@ LABEL BASED(CP0001@(SVCNUMBR)) VALUERANGE(S00,GP2,GP2,  00258000
*           G1,GP2,GP2,S06,S06,S08,S08,G1,G1,G1,S13,S14,S15,S16,GP2,GP2 00259000
*           ,GP2,GP2,S21,GP2,GP2,GP3,S25,S26,S27,S13,S29,S30,GP3,S32,   00260000
*           S32,G1,GP2,G1,GP2,G1,GP2,GP2,S08,S42,G1,S44,GP2,G1,GP2,S48, 00261000
*           G1,G1,GP2,S52,GP3,S00,GP3,S48,GP3,GP3,G1,GP2,G1,S44,GP2,GP2 00262000
*           ,G1,S66,G1,S13,GP3,GP2,S71,G1,GP2,GP2,S75,G1,G1,S32,G1,GP2, 00263000
*           S71,S82,G1,G1,G1,S86,GP2,S88,G1,G1,G1,S00,G1,G1,G1,GP2,G1,  00264000
*           S98,G1,G1,G1,GP2,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,S00,G1,G1 00265000
*           ,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,  00266000
*           G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1 00267000
*           ,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,  00268000
*           G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1 00269000
*           ,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,  00270000
*           G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1 00271000
*           ,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,G1,  00272000
*           G1,G1);                 /* BRANCH TARGET                 */ 00273000
*     DCL                                                       02S0212 00274000
*       CP0001@(255) PTR(31) INIT(ADDR(S00),ADDR(GP2),ADDR(GP2),ADDR(G1 00275000
*           ),ADDR(GP2),ADDR(GP2),ADDR(S06),ADDR(S06),ADDR(S08),ADDR(   00276000
*           S08),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(S13),ADDR(S14),ADDR(   00277000
*           S15),ADDR(S16),ADDR(GP2),ADDR(GP2),ADDR(GP2),ADDR(GP2),ADDR 00278000
*           (S21),ADDR(GP2),ADDR(GP2),ADDR(GP3),ADDR(S25),ADDR(S26),    00279000
*           ADDR(S27),ADDR(S13),ADDR(S29),ADDR(S30),ADDR(GP3),ADDR(S32) 00280000
*           ,ADDR(S32),ADDR(G1),ADDR(GP2),ADDR(G1),ADDR(GP2),ADDR(G1),  00281000
*           ADDR(GP2),ADDR(GP2),ADDR(S08),ADDR(S42),ADDR(G1),ADDR(S44), 00282000
*           ADDR(GP2),ADDR(G1),ADDR(GP2),ADDR(S48),ADDR(G1),ADDR(G1),   00283000
*           ADDR(GP2),ADDR(S52),ADDR(GP3),ADDR(S00),ADDR(GP3),ADDR(S48) 00284000
*           ,ADDR(GP3),ADDR(GP3),ADDR(G1),ADDR(GP2),ADDR(G1),ADDR(S44), 00285000
*           ADDR(GP2),ADDR(GP2),ADDR(G1),ADDR(S66),ADDR(G1),ADDR(S13),  00286000
*           ADDR(GP3),ADDR(GP2),ADDR(S71),ADDR(G1),ADDR(GP2),ADDR(GP2), 00287000
*           ADDR(S75),ADDR(G1),ADDR(G1),ADDR(S32),ADDR(G1),ADDR(GP2),   00288000
*           ADDR(S71),ADDR(S82),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(S86),   00289000
*           ADDR(GP2),ADDR(S88),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(S00),   00290000
*           ADDR(G1),ADDR(G1),ADDR(G1),ADDR(GP2),ADDR(G1),ADDR(S98),    00291000
*           ADDR(G1),ADDR(G1),ADDR(G1),ADDR(GP2),ADDR(G1),ADDR(G1),ADDR 00292000
*           (G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1), 00293000
*           ADDR(G1),ADDR(G1),ADDR(S00),ADDR(G1),ADDR(G1),ADDR(G1),ADDR 00294000
*           (G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1), 00295000
*           ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR( 00296000
*           G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),  00297000
*           ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR( 00298000
*           G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),  00299000
*           ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR( 00300000
*           G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),  00301000
*           ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR( 00302000
*           G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),  00303000
*           ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR( 00304000
*           G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),  00305000
*           ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR( 00306000
*           G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),  00307000
*           ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR( 00308000
*           G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),  00309000
*           ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR( 00310000
*           G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),  00311000
*           ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR( 00312000
*           G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),  00313000
*           ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR( 00314000
*           G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1),ADDR(G1)); 00315000
*     GOTO CL0001@;                 /* BRANCH TO SELECTED CASE       */ 00316000
         LR    @14,SVCNUMBR                                     02S0213 00317000
         SLA   @14,2                                            02S0213 00318000
         L     @14,CP0001@-4(@14)                               02S0213 00319000
         BR    @14                                              02S0213 00320000
*                                                               02S0214 00321000
*     /***************************************************************/ 00322000
*     /*                                                             */ 00323000
*     /* THIS ROUTINE WILL PROCESS THE FOLLOWING SVCS:               */ 00324000
*     /* 3,10,11,12,34,36,38,43,46,49,50,59,61,65,72,76,77,79,83, 84,*/ 00325000
*     /* 85,89,90,91,93,94,95,97,99,100,101,103,104,105,106,107,108, */ 00326000
*     /* 109,110,111,112,113,115,116,117,118,119,120,121,122,123,124.*/ 00327000
*     /* IT WILL ALSO PROCESS ALL USER SVCS - 128 - 255. THE         */ 00328000
*     /* FORMATTING CONSISTS OF ONLY THE BASIC RECORD.               */ 00329000
*     /*                                                             */ 00330000
*     /***************************************************************/ 00331000
*                                                               02S0214 00332000
*G1:                                                            02S0214 00333000
*     DO;                           /* SUBCASE                       */ 00334000
G1       DS    0H                                               02S0215 00335000
*       IF TIMESW=0 THEN            /* IS THIS THE FIRST PASS        */ 00336000
         SLR   @14,@14                                          02S0215 00337000
         CH    @14,TIMESW                                       02S0215 00338000
         BNE   @RF00215                                         02S0215 00339000
*         RETCODE=0;                /* YES - INDICATES TO PRINT 02S0216 00340000
*                                      BUFFER AND RETURN FOR SECOND     00341000
*                                      PASS                          */ 00342000
         LR    RETCODE,@14                                      02S0216 00343000
*       ELSE                                                    02S0217 00344000
*         RETCODE=4;                /* NO - INDICATES TO PRINT BUFFER   00345000
*                                      AND GET NEXT RECORD           */ 00346000
         B     @RC00215                                         02S0217 00347000
@RF00215 LA    RETCODE,4                                        02S0217 00348000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 00349000
         B     CE0001@                                          02S0218 00350000
*     END G1;                       /* END OF SUBCASE                */ 00351000
*                                                               02S0220 00352000
*     /***************************************************************/ 00353000
*     /*                                                             */ 00354000
*     /* THIS ROUTINE WILL PROCESS THE FOLLOWING SVCS:               */ 00355000
*     /* 1,2,4,5,17,18,19,20,22,23,35,37,39,40,45,47,51,60,63,64,    */ 00356000
*     /* 70,73,74,80,87,96,102. THE FORMATTING CONSISTS OFTHE BASIC  */ 00357000
*     /* RECORD + A VARIABLE LENGTH PARAMETER LIST.                  */ 00358000
*     /*                                                             */ 00359000
*     /***************************************************************/ 00360000
*                                                               02S0220 00361000
*GP2:                                                           02S0220 00362000
*     DO;                           /* SUBCASE                       */ 00363000
GP2      DS    0H                                               02S0221 00364000
*       IF TIMESW=0|TIMESW=1 THEN   /* HAS BASIC RECORD BEEN    02S0221 00365000
*                                      FORMATTED                     */ 00366000
         LH    @14,TIMESW                                       02S0221 00367000
         LTR   @14,@14                                          02S0221 00368000
         BZ    @RT00221                                         02S0221 00369000
         CH    @14,@CH00046                                     02S0221 00370000
         BNE   @RF00221                                         02S0221 00371000
@RT00221 DS    0H                                               02S0222 00372000
*         RETCODE=0;                /* NO - INDICATES TO PRINT BUFFER   00373000
*                                      AND RETURN FOR SECOND PASS    */ 00374000
         SLR   RETCODE,RETCODE                                  02S0222 00375000
*       ELSE                                                    02S0223 00376000
*         DO;                       /* YES - CHECK LENGTH AND MODIFY    00377000
*                                      PATTERN ACCORDINGLY           */ 00378000
         B     @RC00221                                         02S0223 00379000
@RF00221 DS    0H                                               02S0224 00380000
*           IF GRP2LNTH=0 THEN      /* IS THERE A PLIST              */ 00381000
         L     @14,DATAPTR(,PLISTPTR)                           02S0224 00382000
         CLI   GRP2LNTH+46(@14),0                               02S0224 00383000
         BNE   @RF00224                                         02S0224 00384000
*             R0=ADDR(GP2NA);       /* NO - ADDR OF PATTERN FOR THIS    00385000
*                                      LINE                          */ 00386000
         LA    R0,GP2NA                                         02S0225 00387000
*           ELSE                                                02S0226 00388000
*             DO;                   /* YES - THERE IS A PLIST        */ 00389000
         B     @RC00224                                         02S0226 00390000
@RF00224 DS    0H                                               02S0227 00391000
*               DYNAMPTN(1:LENGTH(GRP2LN3))=GRP2LN3;/* MOVE PATTERN     00392000
*                                      TO GETMAIN AREA               */ 00393000
         MVC   DYNAMPTN(41),GRP2LN3                             02S0227 00394000
*               ADPLFMT2=ADDR(GRP2LNTH)+1;/* ADDR OF DATA IN BUFFER  */ 00395000
         L     @14,ABDPLPTR(,PLISTPTR)                          02S0228 00396000
         L     @07,DATAPTR(,PLISTPTR)                           02S0228 00397000
         LA    @05,47                                           02S0228 00398000
         ALR   @05,@07                                          02S0228 00399000
         ST    @05,ADPLFMT2(,@14)                               02S0228 00400000
*               R0=ADDR(DYNAMPTN);  /* ADDR OF PATTERNS FOR THIS LINE*/ 00401000
         LA    R0,DYNAMPTN                                      02S0229 00402000
*               IF GRP2LNTH=ERROR THEN/* IS FIELD IN ERROR           */ 00403000
         CLI   GRP2LNTH+46(@07),255                             02S0230 00404000
         BNE   @RF00230                                         02S0230 00405000
*                 DO;               /* YES - ONLY FORMAT 4 BYTES     */ 00406000
*                   OLDFLG(1)=OLDFLG(1)|CHARFLAG;/* INDICATE DATA IN    00407000
*                                      EBCDIC                        */ 00408000
         SLR   @14,@14                                          02S0232 00409000
         IC    @14,OLDFLG                                       02S0232 00410000
         O     @14,@CF00092                                     02S0232 00411000
         STC   @14,OLDFLG                                       02S0232 00412000
*                   OLDFLG(2)=0;    /* INDICATE END OF PATTERNS      */ 00413000
         MVI   OLDFLG+4,X'00'                                   02S0233 00414000
*                 END;                                          02S0234 00415000
*               ELSE                                            02S0235 00416000
*                 DO;               /* NO - DETERMINE HOW MANY BYTES    00417000
*                                      IN PLIST                      */ 00418000
         B     @RC00230                                         02S0235 00419000
@RF00230 DS    0H                                               02S0236 00420000
*                   IF GRP2LNTH<4 THEN/* IS PLIST LESS THAN ONE WORD */ 00421000
         LA    @14,46                                           02S0236 00422000
         AL    @14,DATAPTR(,PLISTPTR)                           02S0236 00423000
         CLI   GRP2LNTH(@14),4                                  02S0236 00424000
         BNL   @RF00236                                         02S0236 00425000
*                     DO;           /* YES                           */ 00426000
*                       OLDLN(1)=OLDLN(1)&DATAOFF;/* SET DATA LENGTH    00427000
*                                      TO 0                          */ 00428000
         SLR   @07,@07                                          02S0238 00429000
         IC    @07,OLDLN                                        02S0238 00430000
         N     @07,@CF00297                                     02S0238 00431000
         STC   @07,OLDLN                                        02S0238 00432000
*                       OLDLN(1)=OLDLN(1)|(GRP2LNTH-1);/* NEW DATA      00433000
*                                      LENGTH                        */ 00434000
         SLR   @05,@05                                          02S0239 00435000
         IC    @05,GRP2LNTH(,@14)                               02S0239 00436000
         BCTR  @05,0                                            02S0239 00437000
         OR    @07,@05                                          02S0239 00438000
         STC   @07,OLDLN                                        02S0239 00439000
*                       OLDFLG(2)=0;/* INDICATE END OF PATTERNS      */ 00440000
         MVI   OLDFLG+4,X'00'                                   02S0240 00441000
*                     END;                                      02S0241 00442000
*                   ELSE                                        02S0242 00443000
*                     DO;           /* NO - MODIFY PATTERNS          */ 00444000
         B     @RC00236                                         02S0242 00445000
@RF00236 DS    0H                                               02S0243 00446000
*                       K=GRP2LNTH/4;/* NUMBER OF FULL WORDS         */ 00447000
         L     @14,DATAPTR(,PLISTPTR)                           02S0243 00448000
         SLR   @05,@05                                          02S0243 00449000
         IC    @05,GRP2LNTH+46(,@14)                            02S0243 00450000
         LR    K,@05                                            02S0243 00451000
         SRL   K,2                                              02S0243 00452000
*                       MOD=GRP2LNTH//4;/* REMAINDER OF PARTIAL WORD */ 00453000
         LR    @02,@05                                          02S0244 00454000
         SRDA  @02,32                                           02S0244 00455000
         D     @02,@CF00099                                     02S0244 00456000
         LR    MOD,@02                                          02S0244 00457000
*                       IF MOD=0 THEN/* ARE ALL FULL WORDS           */ 00458000
         SLR   @14,@14                                          02S0245 00459000
         CR    MOD,@14                                          02S0245 00460000
         BNE   @RF00245                                         02S0245 00461000
*                         OLDFLG(K+1)=0;/* YES - INDICATE END OF        00462000
*                                      PATTERNS                      */ 00463000
         LR    @07,K                                            02S0246 00464000
         SLA   @07,2                                            02S0246 00465000
         STC   @14,OLDFLG(@07)                                  02S0246 00466000
*                       ELSE                                    02S0247 00467000
*                         DO;       /* NO - MODIFY PATTERNS     02S0247 00468000
*                                      ACCORDINGLY                   */ 00469000
         B     @RC00245                                         02S0247 00470000
@RF00245 DS    0H                                               02S0248 00471000
*                           OLDLN(K+1)=OLDLN(K+1)&DATAOFF;/* SET DATA   00472000
*                                      LENGTH TO ZERO                */ 00473000
         LR    @14,K                                            02S0248 00474000
         SLA   @14,2                                            02S0248 00475000
         SLR   @05,@05                                          02S0248 00476000
         IC    @05,OLDLN(@14)                                   02S0248 00477000
         N     @05,@CF00297                                     02S0248 00478000
         STC   @05,OLDLN(@14)                                   02S0248 00479000
*                           OLDLN(K+1)=OLDLN(K+1)|(MOD-1);/* NEW DATA   00480000
*                                      LENGTH                        */ 00481000
         LR    @03,MOD                                          02S0249 00482000
         BCTR  @03,0                                            02S0249 00483000
         OR    @05,@03                                          02S0249 00484000
         STC   @05,OLDLN(@14)                                   02S0249 00485000
*                           OLDFLG(K+2)=0;/* INDICATE END OF PATTERNS*/ 00486000
         SLR   @07,@07                                          02S0250 00487000
         STC   @07,OLDFLG+4(@14)                                02S0250 00488000
*                         END;                                  02S0251 00489000
*                     END;                                      02S0252 00490000
@RC00245 DS    0H                                               02S0253 00491000
*                 END;                                          02S0253 00492000
@RC00236 DS    0H                                               02S0254 00493000
*             END;                                              02S0254 00494000
@RC00230 DS    0H                                               02S0255 00495000
*           ADPLFMT1=ADDR(GROUP2);  /* LABEL FOR THIS LINE           */ 00496000
@RC00224 L     @14,ABDPLPTR(,PLISTPTR)                          02S0255 00497000
         LA    @07,GROUP2                                       02S0255 00498000
         ST    @07,ADPLFMT1(,@14)                               02S0255 00499000
*           CALL AMDPRFMT;          /* FORMAT THE LINE               */ 00500000
         L     @15,FMTADDR(,PLISTPTR)                           02S0256 00501000
         BALR  @14,@15                                          02S0256 00502000
*           RETCODE=4;              /* INDICATES TO PRINT BUFFER AND    00503000
*                                      GET NEXT RECORD               */ 00504000
         LA    RETCODE,4                                        02S0257 00505000
*         END;                                                  02S0258 00506000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 00507000
         B     CE0001@                                          02S0259 00508000
*     END GP2;                      /* END OF SUBCASE                */ 00509000
*                                                               02S0261 00510000
*     /***************************************************************/ 00511000
*     /*                                                             */ 00512000
*     /* THIS ROUTINE WILL PROCESS THE FOLLOWING SVCS:               */ 00513000
*     /* 24,31,53,55,57, 58,69. THE FORMATTING CONSISTS OF THE BASIC */ 00514000
*     /* RECORD + A DDNAME                                           */ 00515000
*     /*                                                             */ 00516000
*     /***************************************************************/ 00517000
*                                                               02S0261 00518000
*GP3:                                                           02S0261 00519000
*     DO;                           /* SUBCASE                       */ 00520000
GP3      DS    0H                                               02S0262 00521000
*       IF TIMESW=0 THEN            /* IS THIS THE FIRST PASS        */ 00522000
         ICM   @14,3,TIMESW                                     02S0262 00523000
         BNZ   @RF00262                                         02S0262 00524000
*         DO;                       /* YES - FORMAT DDNAME           */ 00525000
*           ADPLFMT1=ADDR(LDDNL1);  /* ADDR OF LABEL FOR THIS FIELD  */ 00526000
         L     @14,ABDPLPTR(,PLISTPTR)                          02S0264 00527000
         LA    @07,LDDNL1                                       02S0264 00528000
         ST    @07,ADPLFMT1(,@14)                               02S0264 00529000
*           ADPLFMT2=ADDR(GRP3DDN); /* ADDR OF DDNAME IN RECORD      */ 00530000
         LA    @07,46                                           02S0265 00531000
         AL    @07,DATAPTR(,PLISTPTR)                           02S0265 00532000
         ST    @07,ADPLFMT2(,@14)                               02S0265 00533000
*           R0=ADDR(DDNLN1);        /* ADDR OF PATTERN FOR DDNAME    */ 00534000
         LA    R0,DDNLN1                                        02S0266 00535000
*           CALL AMDPRFMT;          /* FORMAT DDNAME ON FIRST LINE   */ 00536000
         L     @15,FMTADDR(,PLISTPTR)                           02S0267 00537000
         BALR  @14,@15                                          02S0267 00538000
*           RETCODE=0;              /* INDICATES TO PRINT BUFFER AND    00539000
*                                      RETURN FOR SECOND PASS        */ 00540000
         SLR   RETCODE,RETCODE                                  02S0268 00541000
*         END;                                                  02S0269 00542000
*       ELSE                                                    02S0270 00543000
*         RETCODE=4;                /* NO - INDICATES TO PRINT BUFFER   00544000
*                                      AND GET NEXT RECORD           */ 00545000
         B     @RC00262                                         02S0270 00546000
@RF00262 LA    RETCODE,4                                        02S0270 00547000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 00548000
         B     CE0001@                                          02S0271 00549000
*     END GP3;                      /* END OF SUBCASE                */ 00550000
*                                                               02S0273 00551000
*     /***************************************************************/ 00552000
*     /*                                                             */ 00553000
*     /* THIS ROUTINE WILL PROCESS THE FOLLOWING SVCS: 0,54,92,114.  */ 00554000
*     /* THE FORMATTING CONSISTS OF THE BASIC RECORD + A DDNAME + A  */ 00555000
*     /* DCB AND DEB ADDRESS.                                        */ 00556000
*     /*                                                             */ 00557000
*     /***************************************************************/ 00558000
*                                                               02S0273 00559000
*S00:                                                           02S0273 00560000
*     DO;                           /* SUBCASE                       */ 00561000
S00      DS    0H                                               02S0274 00562000
*       IF TIMESW=0 THEN            /* IS THIS THE FIRST PASS        */ 00563000
         ICM   @14,3,TIMESW                                     02S0274 00564000
         BNZ   @RF00274                                         02S0274 00565000
*         DO;                       /* YES - FORMAT DDNAME           */ 00566000
*           ADPLFMT1=ADDR(LDDNL1);  /* ADDR OF LABEL FOR THIS FIELD  */ 00567000
         L     @14,ABDPLPTR(,PLISTPTR)                          02S0276 00568000
         LA    @07,LDDNL1                                       02S0276 00569000
         ST    @07,ADPLFMT1(,@14)                               02S0276 00570000
*           ADPLFMT2=ADDR(RCD0DDN); /* ADDR OF DDNAME IN RECORD      */ 00571000
         LA    @07,46                                           02S0277 00572000
         AL    @07,DATAPTR(,PLISTPTR)                           02S0277 00573000
         ST    @07,ADPLFMT2(,@14)                               02S0277 00574000
*           R0=ADDR(DDNLN1);        /* ADDR OF PATTERN FOR DDNAME    */ 00575000
         LA    R0,DDNLN1                                        02S0278 00576000
*           CALL AMDPRFMT;          /* FORMAT DDNAME ON FIRST LINE   */ 00577000
         L     @15,FMTADDR(,PLISTPTR)                           02S0279 00578000
         BALR  @14,@15                                          02S0279 00579000
*           RETCODE=0;              /* INDICATES TO PRINT BUFFER AND    00580000
*                                      RETURN FOR SECOND PASS        */ 00581000
         SLR   RETCODE,RETCODE                                  02S0280 00582000
*         END;                                                  02S0281 00583000
*       ELSE                                                    02S0282 00584000
*         DO;                       /* NO - FORMAT REGS AND REMAINING   00585000
*                                      FIELDS                        */ 00586000
         B     @RC00274                                         02S0282 00587000
@RF00274 DS    0H                                               02S0283 00588000
*           DYNAMPTN(1:LENGTH(GP4S00))=GP4S00;/* MOVE PATTERNS TO       00589000
*                                      GETMAINED AREA                */ 00590000
         MVC   DYNAMPTN(9),GP4S00                               02S0283 00591000
*           IF RCD0DCB=ASTER4|RCD0DCB=PEES4|RCD0DCB=ESSES4 THEN/* IS    00592000
*                                      FIELD IN ERROR                */ 00593000
         LA    @14,46                                           02S0284 00594000
         AL    @14,DATAPTR(,PLISTPTR)                           02S0284 00595000
         CLC   RCD0DCB(4,@14),ASTER4                            02S0284 00596000
         BE    @RT00284                                         02S0284 00597000
         CLC   RCD0DCB(4,@14),PEES4                             02S0284 00598000
         BE    @RT00284                                         02S0284 00599000
         CLC   RCD0DCB(4,@14),ESSES4                            02S0284 00600000
         BNE   @RF00284                                         02S0284 00601000
@RT00284 DS    0H                                               02S0285 00602000
*             OLDFLG(1)=OLDFLG(1)|CHARFLAG;/* YES - INDICATE DATA IN    00603000
*                                      EBCDIC                        */ 00604000
         SLR   @14,@14                                          02S0285 00605000
         IC    @14,OLDFLG                                       02S0285 00606000
         O     @14,@CF00092                                     02S0285 00607000
         STC   @14,OLDFLG                                       02S0285 00608000
*           IF RCD0DEB=ASTER4|RCD0DEB=PEES4|RCD0DEB=ESSES4 THEN/* IS    00609000
*                                      FIELD IN ERROR                */ 00610000
@RF00284 LA    @14,46                                           02S0286 00611000
         AL    @14,DATAPTR(,PLISTPTR)                           02S0286 00612000
         CLC   RCD0DEB(4,@14),ASTER4                            02S0286 00613000
         BE    @RT00286                                         02S0286 00614000
         CLC   RCD0DEB(4,@14),PEES4                             02S0286 00615000
         BE    @RT00286                                         02S0286 00616000
         CLC   RCD0DEB(4,@14),ESSES4                            02S0286 00617000
         BNE   @RF00286                                         02S0286 00618000
@RT00286 DS    0H                                               02S0287 00619000
*             OLDFLG(2)=OLDFLG(2)|CHARFLAG;/* YES - INDICATE DATA IN    00620000
*                                      EBCDIC                        */ 00621000
         SLR   @14,@14                                          02S0287 00622000
         IC    @14,OLDFLG+4                                     02S0287 00623000
         O     @14,@CF00092                                     02S0287 00624000
         STC   @14,OLDFLG+4                                     02S0287 00625000
*           ADPLFMT1=ADDR(GP4TYP1); /* ADDR OF LABELS FOR THIS LINE  */ 00626000
@RF00286 L     @14,ABDPLPTR(,PLISTPTR)                          02S0288 00627000
         LA    @07,GP4TYP1                                      02S0288 00628000
         ST    @07,ADPLFMT1(,@14)                               02S0288 00629000
*           ADPLFMT2=ADDR(RCD0DCB); /* ADDR OF DATA IN BUFFER        */ 00630000
         L     @07,DATAPTR(,PLISTPTR)                           02S0289 00631000
         LA    @07,RCD0DCB+46(,@07)                             02S0289 00632000
         ST    @07,ADPLFMT2(,@14)                               02S0289 00633000
*           R0=ADDR(DYNAMPTN);      /* ADDR OF PATTERNS FOR THIS LINE*/ 00634000
         LA    R0,DYNAMPTN                                      02S0290 00635000
*           CALL AMDPRFMT;          /* FORMAT LINE                   */ 00636000
         L     @15,FMTADDR(,PLISTPTR)                           02S0291 00637000
         BALR  @14,@15                                          02S0291 00638000
*           RETCODE=4;              /* INDICATES TO PRINT BUFFER AND    00639000
*                                      GET NEXT RECORD               */ 00640000
         LA    RETCODE,4                                        02S0292 00641000
*         END;                                                  02S0293 00642000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 00643000
         B     CE0001@                                          02S0294 00644000
*     END S00;                      /* END OF SUBCASE                */ 00645000
*                                                               02S0296 00646000
*     /***************************************************************/ 00647000
*     /*                                                             */ 00648000
*     /* THIS ROUTINE WILL PROCESS THE FOLLOWING SVCS: 6,7. THE      */ 00649000
*     /* FORMATTING CONSISTS OF THE BASIC RECORD + AN EP/CE NAME + A */ 00650000
*     /* 12 BYTE/8 BYTE PLIST                                        */ 00651000
*     /*                                                             */ 00652000
*     /***************************************************************/ 00653000
*                                                               02S0296 00654000
*S06:                                                           02S0296 00655000
*     DO;                           /* SUBCASE                       */ 00656000
S06      DS    0H                                               02S0297 00657000
*       IF TIMESW=0 THEN            /* HAS SECOND LINE BEEN FORMATTED*/ 00658000
         SLR   @14,@14                                          02S0297 00659000
         CH    @14,TIMESW                                       02S0297 00660000
         BNE   @RF00297                                         02S0297 00661000
*         RETCODE=0;                /* NO - INDICATES TO PRINT BUFFER   00662000
*                                      AND RETURN FOR SECOND PASS    */ 00663000
         LR    RETCODE,@14                                      02S0298 00664000
*       ELSE                                                    02S0299 00665000
*         DO;                       /* YES - CHECK FIELDS FOR ERRORS    00666000
*                                      & FORMAT THEM                 */ 00667000
         B     @RC00297                                         02S0299 00668000
@RF00297 DS    0H                                               02S0300 00669000
*           DYNAMPTN(1:LENGTH(GP4S06))=GP4S06;/* MOVE PATTERNS TO       00670000
*                                      GETMAINED AREA                */ 00671000
         MVC   DYNAMPTN(17),GP4S06                              02S0300 00672000
*           IF RCD6LST=ASTER8|RCD6LST=PEES8|RCD6LST=ESSES8 THEN/* IS    00673000
*                                      FIELD IN ERROR                */ 00674000
         LA    @14,46                                           02S0301 00675000
         AL    @14,DATAPTR(,PLISTPTR)                           02S0301 00676000
         CLC   RCD6LST(8,@14),ASTER8                            02S0301 00677000
         BE    @RT00301                                         02S0301 00678000
         CLC   RCD6LST(8,@14),PEES8                             02S0301 00679000
         BE    @RT00301                                         02S0301 00680000
         CLC   RCD6LST(8,@14),ESSES8                            02S0301 00681000
         BNE   @RF00301                                         02S0301 00682000
@RT00301 DS    0H                                               02S0302 00683000
*             DO;                   /* YES                           */ 00684000
*               OLDFLG(2)=OLDFLG(2)|CHARFLAG;/* INDICATE DATA IN        00685000
*                                      EBCDIC                        */ 00686000
         LA    @14,32                                           02S0303 00687000
         SLR   @05,@05                                          02S0303 00688000
         IC    @05,OLDFLG+4                                     02S0303 00689000
         OR    @05,@14                                          02S0303 00690000
         STC   @05,OLDFLG+4                                     02S0303 00691000
*               OLDFLG(3)=OLDFLG(3)|CHARFLAG;                   02S0304 00692000
         SLR   @05,@05                                          02S0304 00693000
         IC    @05,OLDFLG+8                                     02S0304 00694000
         OR    @05,@14                                          02S0304 00695000
         STC   @05,OLDFLG+8                                     02S0304 00696000
*               OLDFLG(4)=OLDFLG(4)|CHARFLAG;                   02S0305 00697000
         SLR   @05,@05                                          02S0305 00698000
         IC    @05,OLDFLG+12                                    02S0305 00699000
         OR    @14,@05                                          02S0305 00700000
         STC   @14,OLDFLG+12                                    02S0305 00701000
*             END;                                              02S0306 00702000
*           IF SVCNUMBR=8 THEN      /* IS THIS SVC 7                 */ 00703000
@RF00301 CH    SVCNUMBR,@CH00034                                02S0307 00704000
         BNE   @RF00307                                         02S0307 00705000
*             OLDFLG(4)=0;          /* YES - INDICATE END OF PATTERNS*/ 00706000
         MVI   OLDFLG+12,X'00'                                  02S0308 00707000
*           ADPLFMT1=ADDR(GP4TYP3); /* ADDR OF LABELS FOR THIS LINE  */ 00708000
@RF00307 L     @14,ABDPLPTR(,PLISTPTR)                          02S0309 00709000
         LA    @07,GP4TYP3                                      02S0309 00710000
         ST    @07,ADPLFMT1(,@14)                               02S0309 00711000
*           ADPLFMT2=ADDR(EPDENM1); /* ADDR OF DATA IN BUFFER        */ 00712000
         LA    @07,46                                           02S0310 00713000
         AL    @07,DATAPTR(,PLISTPTR)                           02S0310 00714000
         ST    @07,ADPLFMT2(,@14)                               02S0310 00715000
*           R0=ADDR(DYNAMPTN);      /* ADDR OF PATTERNS              */ 00716000
         LA    R0,DYNAMPTN                                      02S0311 00717000
*           CALL AMDPRFMT;          /* FORMAT THE LINE               */ 00718000
         L     @15,FMTADDR(,PLISTPTR)                           02S0312 00719000
         BALR  @14,@15                                          02S0312 00720000
*           RETCODE=4;              /* INDICATES TO PRINT BUFFER AND    00721000
*                                      GET NEXT RECORD               */ 00722000
         LA    RETCODE,4                                        02S0313 00723000
*         END;                                                  02S0314 00724000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 00725000
         B     CE0001@                                          02S0315 00726000
*     END S06;                      /* END OF SUBCASE                */ 00727000
*                                                               02S0317 00728000
*     /***************************************************************/ 00729000
*     /*                                                             */ 00730000
*     /* THIS ROUTINE WILL PROCESS THE FOLLOWING SVCS: 8,9,41. THE   */ 00731000
*     /* FORMATTING CONSISTS OF THE BASIC RECORD + AN EP/CE          */ 00732000
*     /* NAME/NAME.                                                  */ 00733000
*     /*                                                             */ 00734000
*     /***************************************************************/ 00735000
*                                                               02S0317 00736000
*S08:                                                           02S0317 00737000
*     DO;                           /* SUBCASE                       */ 00738000
S08      DS    0H                                               02S0318 00739000
*       IF TIMESW=0 THEN            /* HAS SECOND LINE BEEN FORMATTED*/ 00740000
         SLR   @14,@14                                          02S0318 00741000
         CH    @14,TIMESW                                       02S0318 00742000
         BNE   @RF00318                                         02S0318 00743000
*         RETCODE=0;                /* NO - INDICATES TO PRINT BUFFER   00744000
*                                      AND RETURN FOR SECOND PASS    */ 00745000
         LR    RETCODE,@14                                      02S0319 00746000
*       ELSE                                                    02S0320 00747000
*         DO;                       /* YES - FORMAT REMAINING FIELD  */ 00748000
         B     @RC00318                                         02S0320 00749000
@RF00318 DS    0H                                               02S0321 00750000
*           IF SVCNUMBR=42 THEN     /* IS THIS SVC 41                */ 00751000
         CH    SVCNUMBR,@CH00563                                02S0321 00752000
         BNE   @RF00321                                         02S0321 00753000
*             DO;                   /* YES                           */ 00754000
*               DYNAMPTN(1:LENGTH(GP4S41))=GP4S41;/* MOVE PATTERNS TO   00755000
*                                      GETMAINED AREA                */ 00756000
         MVC   DYNAMPTN(5),GP4S41                               02S0323 00757000
*               ADPLFMT1=ADDR(GP4TYP15);/* ADDR OF LABELS FOR THIS      00758000
*                                      LINE                          */ 00759000
         L     @14,ABDPLPTR(,PLISTPTR)                          02S0324 00760000
         LA    @07,GP4TYP15                                     02S0324 00761000
         ST    @07,ADPLFMT1(,@14)                               02S0324 00762000
*             END;                                              02S0325 00763000
*           ELSE                                                02S0326 00764000
*             DO;                   /* NO - ITS SVC 8 OR 9           */ 00765000
         B     @RC00321                                         02S0326 00766000
@RF00321 DS    0H                                               02S0327 00767000
*               DYNAMPTN(1:LENGTH(GP4S08))=GP4S08;/* MOVE PATTERNS TO   00768000
*                                      GETMAINED AREA                */ 00769000
         MVC   DYNAMPTN(5),GP4S08                               02S0327 00770000
*               ADPLFMT1=ADDR(GP4TYP3);/* ADDR OF LABELS FOR THIS       00771000
*                                      LINE                          */ 00772000
         L     @14,ABDPLPTR(,PLISTPTR)                          02S0328 00773000
         LA    @07,GP4TYP3                                      02S0328 00774000
         ST    @07,ADPLFMT1(,@14)                               02S0328 00775000
*             END;                                              02S0329 00776000
*           ADPLFMT2=ADDR(EPDENM2); /* ADDR OF DATA IN BUFFER        */ 00777000
@RC00321 L     @14,ABDPLPTR(,PLISTPTR)                          02S0330 00778000
         LA    @07,46                                           02S0330 00779000
         AL    @07,DATAPTR(,PLISTPTR)                           02S0330 00780000
         ST    @07,ADPLFMT2(,@14)                               02S0330 00781000
*           R0=ADDR(DYNAMPTN);      /* ADDR OF PATTERNS              */ 00782000
         LA    R0,DYNAMPTN                                      02S0331 00783000
*           CALL AMDPRFMT;          /* FORMAT THE LINE               */ 00784000
         L     @15,FMTADDR(,PLISTPTR)                           02S0332 00785000
         BALR  @14,@15                                          02S0332 00786000
*           RETCODE=4;              /* INDICATES TO PRINT BUFFER AND    00787000
*                                      GET NEXT RECORD               */ 00788000
         LA    RETCODE,4                                        02S0333 00789000
*         END;                                                  02S0334 00790000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 00791000
         B     CE0001@                                          02S0335 00792000
*     END S08;                      /* END OF SUBCASE                */ 00793000
*                                                               02S0337 00794000
*     /***************************************************************/ 00795000
*     /*                                                             */ 00796000
*     /* THIS ROUTINE WILL PROCESS THE FOLLOWING SVCS: 13,28,68. THE */ 00797000
*     /* FORMATTING CONSISTS OF THE BASIC RECORD + A COMP            */ 00798000
*     /* CODE/REGISTER 13.                                           */ 00799000
*     /*                                                             */ 00800000
*     /***************************************************************/ 00801000
*                                                               02S0337 00802000
*S13:                                                           02S0337 00803000
*     DO;                           /* SUBCASE                       */ 00804000
S13      DS    0H                                               02S0338 00805000
*       IF TIMESW=0 THEN            /* HAS SECOND LINE BEEN FORMATTED*/ 00806000
         SLR   @14,@14                                          02S0338 00807000
         CH    @14,TIMESW                                       02S0338 00808000
         BNE   @RF00338                                         02S0338 00809000
*         RETCODE=0;                /* NO - INDICATES TO PRINT BUFFER   00810000
*                                      AND RETURN FOR SECOND PASS    */ 00811000
         LR    RETCODE,@14                                      02S0339 00812000
*       ELSE                                                    02S0340 00813000
*         DO;                       /* YES - CHECK FIELDS FOR ERRORS    00814000
*                                      & FORMAT THEM                 */ 00815000
         B     @RC00338                                         02S0340 00816000
@RF00338 DS    0H                                               02S0341 00817000
*           IF SVCNUMBR=14 THEN     /* IS THIS SVC 13                */ 00818000
         CH    SVCNUMBR,@CH00434                                02S0341 00819000
         BNE   @RF00341                                         02S0341 00820000
*             DO;                   /* YES                           */ 00821000
*               DYNAMPTN(1:LENGTH(GP4S13))=GP4S13;/* MOVE PATTERNS TO   00822000
*                                      GETMAINED AREA                */ 00823000
         MVC   DYNAMPTN(5),GP4S13                               02S0343 00824000
*               ADPLFMT1=ADDR(GP4TYP4);/* ADDR OF LABELS FOR THIS       00825000
*                                      LINE                          */ 00826000
         L     @14,ABDPLPTR(,PLISTPTR)                          02S0344 00827000
         LA    @07,GP4TYP4                                      02S0344 00828000
         ST    @07,ADPLFMT1(,@14)                               02S0344 00829000
*             END;                                              02S0345 00830000
*           ELSE                                                02S0346 00831000
*             DO;                   /* NO - ITS SVC 28 OR 68         */ 00832000
         B     @RC00341                                         02S0346 00833000
@RF00341 DS    0H                                               02S0347 00834000
*               DYNAMPTN(1:LENGTH(GP4S28))=GP4S28;/* MOVE PATTERNS TO   00835000
*                                      GETMAINED AREA                */ 00836000
         MVC   DYNAMPTN(5),GP4S28                               02S0347 00837000
*               ADPLFMT1=ADDR(GP4TYP11);/* ADDR OF LABELS FOR THIS      00838000
*                                      LINE                          */ 00839000
         L     @14,ABDPLPTR(,PLISTPTR)                          02S0348 00840000
         LA    @07,GP4TYP11                                     02S0348 00841000
         ST    @07,ADPLFMT1(,@14)                               02S0348 00842000
*             END;                                              02S0349 00843000
*           IF COMPCODE=ASTER4|COMPCODE=PEES4|COMPCODE=ESSES4 THEN/*    00844000
*                                      IS FIELD IN ERROR             */ 00845000
@RC00341 LA    @14,46                                           02S0350 00846000
         AL    @14,DATAPTR(,PLISTPTR)                           02S0350 00847000
         CLC   COMPCODE(4,@14),ASTER4                           02S0350 00848000
         BE    @RT00350                                         02S0350 00849000
         CLC   COMPCODE(4,@14),PEES4                            02S0350 00850000
         BE    @RT00350                                         02S0350 00851000
         CLC   COMPCODE(4,@14),ESSES4                           02S0350 00852000
         BNE   @RF00350                                         02S0350 00853000
@RT00350 DS    0H                                               02S0351 00854000
*             OLDFLG(1)=OLDFLG(1)|CHARFLAG;/* INDICATE DATA IN EBCDIC*/ 00855000
         SLR   @14,@14                                          02S0351 00856000
         IC    @14,OLDFLG                                       02S0351 00857000
         O     @14,@CF00092                                     02S0351 00858000
         STC   @14,OLDFLG                                       02S0351 00859000
*           ADPLFMT2=ADDR(COMPCODE);/* ADDR OF DATA IN BUFFER        */ 00860000
@RF00350 L     @14,ABDPLPTR(,PLISTPTR)                          02S0352 00861000
         LA    @07,46                                           02S0352 00862000
         AL    @07,DATAPTR(,PLISTPTR)                           02S0352 00863000
         ST    @07,ADPLFMT2(,@14)                               02S0352 00864000
*           R0=ADDR(DYNAMPTN);      /* ADDR OF PATTERNS              */ 00865000
         LA    R0,DYNAMPTN                                      02S0353 00866000
*           CALL AMDPRFMT;          /* FORMAT THE LINE               */ 00867000
         L     @15,FMTADDR(,PLISTPTR)                           02S0354 00868000
         BALR  @14,@15                                          02S0354 00869000
*           RETCODE=4;              /* INDICATES TO PRINT BUFFER AND    00870000
*                                      GET NEXT RECORD               */ 00871000
         LA    RETCODE,4                                        02S0355 00872000
*         END;                                                  02S0356 00873000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 00874000
         B     CE0001@                                          02S0357 00875000
*     END S13;                      /* END OF SUBCASE                */ 00876000
*                                                               02S0359 00877000
*     /***************************************************************/ 00878000
*     /*                                                             */ 00879000
*     /* THIS ROUTINE WILL PROCESS SVC 14. THE FORMATTING CONSISTS OF*/ 00880000
*     /* THE BASIC RECORD + A PICA.                                  */ 00881000
*     /*                                                             */ 00882000
*     /***************************************************************/ 00883000
*                                                               02S0359 00884000
*S14:                                                           02S0359 00885000
*     DO;                           /* SUBCASE                       */ 00886000
S14      DS    0H                                               02S0360 00887000
*       IF TIMESW=0 THEN            /* HAS SECOND LINE BEEN FORMATTED*/ 00888000
         SLR   @14,@14                                          02S0360 00889000
         CH    @14,TIMESW                                       02S0360 00890000
         BNE   @RF00360                                         02S0360 00891000
*         RETCODE=0;                /* NO - INDICATES TO PRINT BUFFER   00892000
*                                      AND RETURN FOR SECOND PASS    */ 00893000
         LR    RETCODE,@14                                      02S0361 00894000
*       ELSE                                                    02S0362 00895000
*         DO;                       /* YES - CHECK FIELDS FOR ERRORS    00896000
*                                      & FORMAT THEM                 */ 00897000
         B     @RC00360                                         02S0362 00898000
@RF00360 DS    0H                                               02S0363 00899000
*           DYNAMPTN(1:LENGTH(GP4S14))=GP4S14;/* MOVE PATTERNS TO       00900000
*                                      GETMAINED AREA                */ 00901000
         MVC   DYNAMPTN(5),GP4S14                               02S0363 00902000
*           IF PICA=ASTER6|PICA=PEES6|PICA=ESSES6 THEN/* IS FIELD IN    00903000
*                                      ERROR                         */ 00904000
         LA    @14,46                                           02S0364 00905000
         AL    @14,DATAPTR(,PLISTPTR)                           02S0364 00906000
         CLC   PICA(6,@14),ASTER6                               02S0364 00907000
         BE    @RT00364                                         02S0364 00908000
         CLC   PICA(6,@14),PEES6                                02S0364 00909000
         BE    @RT00364                                         02S0364 00910000
         CLC   PICA(6,@14),ESSES6                               02S0364 00911000
         BNE   @RF00364                                         02S0364 00912000
@RT00364 DS    0H                                               02S0365 00913000
*             OLDFLG(1)=OLDFLG(1)|CHARFLAG;/* YES - INDICATE DATA IN    00914000
*                                      EBCDIC                        */ 00915000
         SLR   @14,@14                                          02S0365 00916000
         IC    @14,OLDFLG                                       02S0365 00917000
         O     @14,@CF00092                                     02S0365 00918000
         STC   @14,OLDFLG                                       02S0365 00919000
*           ADPLFMT1=ADDR(GP4TYP5); /* ADDR OF LABELS FOR THIS LINE  */ 00920000
@RF00364 L     @14,ABDPLPTR(,PLISTPTR)                          02S0366 00921000
         LA    @07,GP4TYP5                                      02S0366 00922000
         ST    @07,ADPLFMT1(,@14)                               02S0366 00923000
*           ADPLFMT2=ADDR(PICA);    /* ADDR OF DATA IN BUFFER        */ 00924000
         LA    @07,46                                           02S0367 00925000
         AL    @07,DATAPTR(,PLISTPTR)                           02S0367 00926000
         ST    @07,ADPLFMT2(,@14)                               02S0367 00927000
*           R0=ADDR(DYNAMPTN);      /* ADDR OF PATTERNS              */ 00928000
         LA    R0,DYNAMPTN                                      02S0368 00929000
*           CALL AMDPRFMT;          /* FORMAT THE LINE               */ 00930000
         L     @15,FMTADDR(,PLISTPTR)                           02S0369 00931000
         BALR  @14,@15                                          02S0369 00932000
*           RETCODE=4;              /* INDICATES TO PRINT BUFFER AND    00933000
*                                      GET NEXT RECORD               */ 00934000
         LA    RETCODE,4                                        02S0370 00935000
*         END;                                                  02S0371 00936000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 00937000
         B     CE0001@                                          02S0372 00938000
*     END S14;                      /* END OF SUBCASE                */ 00939000
*                                                               02S0374 00940000
*     /***************************************************************/ 00941000
*     /*                                                             */ 00942000
*     /* THIS ROUTINE WILL PROCESS SVC 15. THE FORMATTING CONSISTS OF*/ 00943000
*     /* THE BASIC RECORD + A DDNAME + ERROR FLAGS + A TCB ADDR + A  */ 00944000
*     /* CUU.                                                        */ 00945000
*     /*                                                             */ 00946000
*     /***************************************************************/ 00947000
*                                                               02S0374 00948000
*S15:                                                           02S0374 00949000
*     DO;                           /* SUBCASE                       */ 00950000
S15      DS    0H                                               02S0375 00951000
*       IF TIMESW=0 THEN            /* IS THIS THE FIRST PASS        */ 00952000
         ICM   @14,3,TIMESW                                     02S0375 00953000
         BNZ   @RF00375                                         02S0375 00954000
*         DO;                       /* YES - FORMAT DDNAME           */ 00955000
*           ADPLFMT1=ADDR(LDDNL1);  /* ADDR OF LABEL FOR THIS FIELD  */ 00956000
         L     @14,ABDPLPTR(,PLISTPTR)                          02S0377 00957000
         LA    @07,LDDNL1                                       02S0377 00958000
         ST    @07,ADPLFMT1(,@14)                               02S0377 00959000
*           ADPLFMT2=ADDR(RCD15DDN);/* ADDR OF DDNAME IN RECORD      */ 00960000
         LA    @07,46                                           02S0378 00961000
         AL    @07,DATAPTR(,PLISTPTR)                           02S0378 00962000
         ST    @07,ADPLFMT2(,@14)                               02S0378 00963000
*           R0=ADDR(DDNLN1);        /* ADDR OF PATTERN FOR DDNAME    */ 00964000
         LA    R0,DDNLN1                                        02S0379 00965000
*           CALL AMDPRFMT;          /* FORMAT DDNAME ON FIRST LINE   */ 00966000
         L     @15,FMTADDR(,PLISTPTR)                           02S0380 00967000
         BALR  @14,@15                                          02S0380 00968000
*           RETCODE=0;              /* INDICATES TO PRINT BUFFER AND    00969000
*                                      RETURN FOR SECOND PASS        */ 00970000
         SLR   RETCODE,RETCODE                                  02S0381 00971000
*         END;                                                  02S0382 00972000
*       ELSE                                                    02S0383 00973000
*         DO;                       /* NO - FORMAT REGS AND REMAINING   00974000
*                                      FIELDS                        */ 00975000
         B     @RC00375                                         02S0383 00976000
@RF00375 DS    0H                                               02S0384 00977000
*           DYNAMPTN(1:LENGTH(GP4S15))=GP4S15;/* MOVE PATTERNS TO       00978000
*                                      GETMAINED AREA                */ 00979000
         MVC   DYNAMPTN(13),GP4S15                              02S0384 00980000
*           IF ERRFLGS=ASTER1|ERRFLGS=PEES1|ERRFLGS=ESSES1 THEN/* IS    00981000
*                                      FIELD IN ERROR                */ 00982000
         LA    @14,46                                           02S0385 00983000
         AL    @14,DATAPTR(,PLISTPTR)                           02S0385 00984000
         CLC   ERRFLGS(1,@14),ASTER1                            02S0385 00985000
         BE    @RT00385                                         02S0385 00986000
         CLC   ERRFLGS(1,@14),PEES1                             02S0385 00987000
         BE    @RT00385                                         02S0385 00988000
         CLC   ERRFLGS(1,@14),ESSES1                            02S0385 00989000
         BNE   @RF00385                                         02S0385 00990000
@RT00385 DS    0H                                               02S0386 00991000
*             OLDFLG(1)=OLDFLG(1)|CHARFLAG;/* YES - INDICATE DATA IN    00992000
*                                      EBCDIC                        */ 00993000
         SLR   @14,@14                                          02S0386 00994000
         IC    @14,OLDFLG                                       02S0386 00995000
         O     @14,@CF00092                                     02S0386 00996000
         STC   @14,OLDFLG                                       02S0386 00997000
*           IF RCD15TCB=ASTER4|RCD15TCB=PEES4|RCD15TCB=ESSES4 THEN/*    00998000
*                                      IS FIELD IN ERROR             */ 00999000
@RF00385 LA    @14,46                                           02S0387 01000000
         AL    @14,DATAPTR(,PLISTPTR)                           02S0387 01001000
         CLC   RCD15TCB(4,@14),ASTER4                           02S0387 01002000
         BE    @RT00387                                         02S0387 01003000
         CLC   RCD15TCB(4,@14),PEES4                            02S0387 01004000
         BE    @RT00387                                         02S0387 01005000
         CLC   RCD15TCB(4,@14),ESSES4                           02S0387 01006000
         BNE   @RF00387                                         02S0387 01007000
@RT00387 DS    0H                                               02S0388 01008000
*             OLDFLG(2)=OLDFLG(2)|CHARFLAG;/* YES - INDICATE DATA IN    01009000
*                                      EBCDIC                        */ 01010000
         SLR   @14,@14                                          02S0388 01011000
         IC    @14,OLDFLG+4                                     02S0388 01012000
         O     @14,@CF00092                                     02S0388 01013000
         STC   @14,OLDFLG+4                                     02S0388 01014000
*           IF RCD15CUU=ASTER2|RCD15CUU=PEES2|RCD15CUU=ESSES2 THEN/*    01015000
*                                      IS FIELD IN ERROR             */ 01016000
@RF00387 LA    @14,46                                           02S0389 01017000
         AL    @14,DATAPTR(,PLISTPTR)                           02S0389 01018000
         CLC   RCD15CUU(2,@14),ASTER2                           02S0389 01019000
         BE    @RT00389                                         02S0389 01020000
         CLC   RCD15CUU(2,@14),PEES2                            02S0389 01021000
         BE    @RT00389                                         02S0389 01022000
         CLC   RCD15CUU(2,@14),ESSES2                           02S0389 01023000
         BNE   @RF00389                                         02S0389 01024000
@RT00389 DS    0H                                               02S0390 01025000
*             OLDFLG(3)=OLDFLG(3)|CHARFLAG;/* YES - INDICATE DATA IN    01026000
*                                      EBCDIC                        */ 01027000
         SLR   @14,@14                                          02S0390 01028000
         IC    @14,OLDFLG+8                                     02S0390 01029000
         O     @14,@CF00092                                     02S0390 01030000
         STC   @14,OLDFLG+8                                     02S0390 01031000
*           ADPLFMT1=ADDR(GP4TYP6); /* ADDR OF LABELS FOR THIS LINE  */ 01032000
@RF00389 L     @14,ABDPLPTR(,PLISTPTR)                          02S0391 01033000
         LA    @07,GP4TYP6                                      02S0391 01034000
         ST    @07,ADPLFMT1(,@14)                               02S0391 01035000
*           ADPLFMT2=ADDR(ERRFLGS); /* ADDR OF DATA IN BUFFER        */ 01036000
         L     @07,DATAPTR(,PLISTPTR)                           02S0392 01037000
         LA    @07,ERRFLGS+46(,@07)                             02S0392 01038000
         ST    @07,ADPLFMT2(,@14)                               02S0392 01039000
*           R0=ADDR(DYNAMPTN);      /* ADDR OF PATTERNS FOR THIS LINE*/ 01040000
         LA    R0,DYNAMPTN                                      02S0393 01041000
*           CALL AMDPRFMT;          /* FORMAT LINE                   */ 01042000
         L     @15,FMTADDR(,PLISTPTR)                           02S0394 01043000
         BALR  @14,@15                                          02S0394 01044000
*           RETCODE=4;              /* INDICATES TO PRINT BUFFER AND    01045000
*                                      GET NEXT RECORD               */ 01046000
         LA    RETCODE,4                                        02S0395 01047000
*         END;                                                  02S0396 01048000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 01049000
         B     CE0001@                                          02S0397 01050000
*     END S15;                      /* END OF SUBCASE                */ 01051000
*                                                               02S0399 01052000
*     /***************************************************************/ 01053000
*     /*                                                             */ 01054000
*     /* THIS ROUTINE WILL PROCESS SVC 16. THE FORMATTING CONSISTS OF*/ 01055000
*     /* THE BASIC RECORD + A DDANME + A DCB ADDR + A 12 BYTE PLIST. */ 01056000
*     /*                                                             */ 01057000
*     /***************************************************************/ 01058000
*                                                               02S0399 01059000
*S16:                                                           02S0399 01060000
*     DO;                           /* SUBCASE                       */ 01061000
S16      DS    0H                                               02S0400 01062000
*       IF TIMESW=0 THEN            /* IS THIS THE FIRST PASS        */ 01063000
         ICM   @14,3,TIMESW                                     02S0400 01064000
         BNZ   @RF00400                                         02S0400 01065000
*         DO;                       /* YES - FORMAT DDNAME           */ 01066000
*           ADPLFMT1=ADDR(LDDNL1);  /* ADDR OF LABEL FOR THIS FIELD  */ 01067000
         L     @14,ABDPLPTR(,PLISTPTR)                          02S0402 01068000
         LA    @07,LDDNL1                                       02S0402 01069000
         ST    @07,ADPLFMT1(,@14)                               02S0402 01070000
*           ADPLFMT2=ADDR(RCD16DDN);/* ADDR OF DDNAME IN RECORD      */ 01071000
         LA    @07,46                                           02S0403 01072000
         AL    @07,DATAPTR(,PLISTPTR)                           02S0403 01073000
         ST    @07,ADPLFMT2(,@14)                               02S0403 01074000
*           R0=ADDR(DDNLN1);        /* ADDR OF PATTERN FOR DDNAME    */ 01075000
         LA    R0,DDNLN1                                        02S0404 01076000
*           CALL AMDPRFMT;          /* FORMAT DDNAME ON FIRST LINE   */ 01077000
         L     @15,FMTADDR(,PLISTPTR)                           02S0405 01078000
         BALR  @14,@15                                          02S0405 01079000
*           RETCODE=0;              /* INDICATES TO PRINT BUFFER AND    01080000
*                                      RETURN FOR SECOND PASS        */ 01081000
         SLR   RETCODE,RETCODE                                  02S0406 01082000
*         END;                                                  02S0407 01083000
*       ELSE                                                    02S0408 01084000
*         DO;                       /* NO - FORMAT REGS AND REMAINING   01085000
*                                      FIELDS                        */ 01086000
         B     @RC00400                                         02S0408 01087000
@RF00400 DS    0H                                               02S0409 01088000
*           DYNAMPTN(1:LENGTH(GP4S16))=GP4S16;/* MOVE PATTERNS TO       01089000
*                                      GETMAINED AREA                */ 01090000
         MVC   DYNAMPTN(17),GP4S16                              02S0409 01091000
*           IF RCD16DCB=ASTER4|RCD16DCB=PEES4|/*             @YM04524*/ 01092000
*               RCD16DCB=ESSES4|RCD16DCB=UA THEN/*           @YM04524   01093000
*                                      IS FIELD IN ERROR     @YM04524*/ 01094000
         LA    @14,46                                           02S0410 01095000
         AL    @14,DATAPTR(,PLISTPTR)                           02S0410 01096000
         CLC   RCD16DCB(4,@14),ASTER4                           02S0410 01097000
         BE    @RT00410                                         02S0410 01098000
         CLC   RCD16DCB(4,@14),PEES4                            02S0410 01099000
         BE    @RT00410                                         02S0410 01100000
         CLC   RCD16DCB(4,@14),ESSES4                           02S0410 01101000
         BE    @RT00410                                         02S0410 01102000
         CLC   RCD16DCB(4,@14),UA                               02S0410 01103000
         BNE   @RF00410                                         02S0410 01104000
@RT00410 DS    0H                                               02S0411 01105000
*             OLDFLG(1)=OLDFLG(1)|CHARFLAG;/* YES - INDICATE DATA IN    01106000
*                                      EBCDIC                        */ 01107000
         SLR   @14,@14                                          02S0411 01108000
         IC    @14,OLDFLG                                       02S0411 01109000
         O     @14,@CF00092                                     02S0411 01110000
         STC   @14,OLDFLG                                       02S0411 01111000
*           IF PPL=ASTER12|PPL=PEES12|PPL=ESSES12 THEN/* IS FIELD IN    01112000
*                                      ERROR                         */ 01113000
@RF00410 LA    @14,46                                           02S0412 01114000
         AL    @14,DATAPTR(,PLISTPTR)                           02S0412 01115000
         CLC   PPL(12,@14),ASTER12                              02S0412 01116000
         BE    @RT00412                                         02S0412 01117000
         CLC   PPL(12,@14),PEES12                               02S0412 01118000
         BE    @RT00412                                         02S0412 01119000
         CLC   PPL(12,@14),ESSES12                              02S0412 01120000
         BNE   @RF00412                                         02S0412 01121000
@RT00412 DS    0H                                               02S0413 01122000
*             DO;                   /* YES                           */ 01123000
*               OLDFLG(2)=OLDFLG(2)|CHARFLAG;/* INDICATE DATA IN        01124000
*                                      EBCDIC                        */ 01125000
         LA    @14,32                                           02S0414 01126000
         SLR   @07,@07                                          02S0414 01127000
         IC    @07,OLDFLG+4                                     02S0414 01128000
         OR    @07,@14                                          02S0414 01129000
         STC   @07,OLDFLG+4                                     02S0414 01130000
*               OLDFLG(3)=OLDFLG(3)|CHARFLAG;                   02S0415 01131000
         SLR   @07,@07                                          02S0415 01132000
         IC    @07,OLDFLG+8                                     02S0415 01133000
         OR    @07,@14                                          02S0415 01134000
         STC   @07,OLDFLG+8                                     02S0415 01135000
*               OLDFLG(4)=OLDFLG(4)|CHARFLAG;                   02S0416 01136000
         SLR   @07,@07                                          02S0416 01137000
         IC    @07,OLDFLG+12                                    02S0416 01138000
         OR    @14,@07                                          02S0416 01139000
         STC   @14,OLDFLG+12                                    02S0416 01140000
*             END;                                              02S0417 01141000
*           ADPLFMT1=ADDR(GP4TYP7); /* ADDR OF LABELS FOR THIS LINE  */ 01142000
@RF00412 L     @14,ABDPLPTR(,PLISTPTR)                          02S0418 01143000
         LA    @07,GP4TYP7                                      02S0418 01144000
         ST    @07,ADPLFMT1(,@14)                               02S0418 01145000
*           ADPLFMT2=ADDR(RCD16DCB);/* ADDR OF DATA IN BUFFER        */ 01146000
         L     @07,DATAPTR(,PLISTPTR)                           02S0419 01147000
         LA    @07,RCD16DCB+46(,@07)                            02S0419 01148000
         ST    @07,ADPLFMT2(,@14)                               02S0419 01149000
*           R0=ADDR(DYNAMPTN);      /* ADDR OF PATTERNS FOR THIS LINE*/ 01150000
         LA    R0,DYNAMPTN                                      02S0420 01151000
*           CALL AMDPRFMT;          /* FORMAT LINE                   */ 01152000
         L     @15,FMTADDR(,PLISTPTR)                           02S0421 01153000
         BALR  @14,@15                                          02S0421 01154000
*           RETCODE=4;              /* INDICATES TO PRINT BUFFER AND    01155000
*                                      GET NEXT RECORD               */ 01156000
         LA    RETCODE,4                                        02S0422 01157000
*         END;                                                  02S0423 01158000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 01159000
         B     CE0001@                                          02S0424 01160000
*     END S16;                      /* END OF SUBCASE                */ 01161000
*                                                               02S0426 01162000
*     /***************************************************************/ 01163000
*     /*                                                             */ 01164000
*     /* THIS ROUTINE WILL PROCESS SVC 21. THE FORMATTING CONSISTS OF*/ 01165000
*     /* THE BASIC RECORD + A DDNAME + A VARIABLE LENGTH PLIST.      */ 01166000
*     /*                                                             */ 01167000
*     /***************************************************************/ 01168000
*                                                               02S0426 01169000
*S21:                                                           02S0426 01170000
*     DO;                           /* SUBCASE                       */ 01171000
S21      DS    0H                                               02S0427 01172000
*       IF TIMESW=0 THEN            /* IS THIS THE FIRST PASS        */ 01173000
         ICM   @14,3,TIMESW                                     02S0427 01174000
         BNZ   @RF00427                                         02S0427 01175000
*         DO;                       /* YES - FORMAT DDNAME           */ 01176000
*           ADPLFMT1=ADDR(LDDNL1);  /* ADDR OF LABEL FOR THIS FIELD  */ 01177000
         L     @14,ABDPLPTR(,PLISTPTR)                          02S0429 01178000
         LA    @07,LDDNL1                                       02S0429 01179000
         ST    @07,ADPLFMT1(,@14)                               02S0429 01180000
*           ADPLFMT2=ADDR(RCD21DDN);/* ADDR OF DDNAME IN RECORD      */ 01181000
         LA    @07,46                                           02S0430 01182000
         AL    @07,DATAPTR(,PLISTPTR)                           02S0430 01183000
         ST    @07,ADPLFMT2(,@14)                               02S0430 01184000
*           R0=ADDR(DDNLN1);        /* ADDR OF PATTERN FOR DDNAME    */ 01185000
         LA    R0,DDNLN1                                        02S0431 01186000
*           CALL AMDPRFMT;          /* FORMAT DDNAME ON FIRST LINE   */ 01187000
         L     @15,FMTADDR(,PLISTPTR)                           02S0432 01188000
         BALR  @14,@15                                          02S0432 01189000
*           RETCODE=0;              /* INDICATES TO PRINT BUFFER AND    01190000
*                                      RETURN FOR SECOND PASS        */ 01191000
         SLR   RETCODE,RETCODE                                  02S0433 01192000
*         END;                                                  02S0434 01193000
*       ELSE                                                    02S0435 01194000
*         DO;                       /* NO - FORMAT REGS AND REMAINING   01195000
*                                      FIELDS                        */ 01196000
         B     @RC00427                                         02S0435 01197000
@RF00427 DS    0H                                               02S0436 01198000
*           DYNAMPTN(1:LENGTH(GP4S21))=GP4S21;/* MOVE PATTERNS TO       01199000
*                                      GETMAINED AREA                */ 01200000
         MVC   DYNAMPTN(17),GP4S21                              02S0436 01201000
*           IF RCD21LN=ERROR THEN   /* IS FIELD IN ERROR             */ 01202000
         L     @14,DATAPTR(,PLISTPTR)                           02S0437 01203000
         CLI   RCD21LN+46(@14),255                              02S0437 01204000
         BNE   @RF00437                                         02S0437 01205000
*             DO;                   /* YES                           */ 01206000
*               OLDFLG(1)=OLDFLG(1)|CHARFLAG;/* INDICATE DATA IN        01207000
*                                      EBCDIC                        */ 01208000
         SLR   @14,@14                                          02S0439 01209000
         IC    @14,OLDFLG                                       02S0439 01210000
         O     @14,@CF00092                                     02S0439 01211000
         STC   @14,OLDFLG                                       02S0439 01212000
*               OLDFLG(2)=0;        /* INDICATE END OF PATTERNS      */ 01213000
         MVI   OLDFLG+4,X'00'                                   02S0440 01214000
*             END;                                              02S0441 01215000
*           ELSE                                                02S0442 01216000
*             DO;                   /* NO - FORMAT 3 OR 4 WORDS      */ 01217000
         B     @RC00437                                         02S0442 01218000
@RF00437 DS    0H                                               02S0443 01219000
*               IF RCD21LN=12 THEN  /* ARE THERE ONLY THREE WORDS    */ 01220000
         L     @14,DATAPTR(,PLISTPTR)                           02S0443 01221000
         CLI   RCD21LN+46(@14),12                               02S0443 01222000
         BNE   @RF00443                                         02S0443 01223000
*                 OLDFLG(4)=0;      /* YES - INDICATE END OF PATTERNS*/ 01224000
         MVI   OLDFLG+12,X'00'                                  02S0444 01225000
*             END;                                              02S0445 01226000
@RF00443 DS    0H                                               02S0446 01227000
*           ADPLFMT1=ADDR(GROUP2);  /* ADDR OF LABEL FOR THIS LINE   */ 01228000
@RC00437 L     @14,ABDPLPTR(,PLISTPTR)                          02S0446 01229000
         LA    @07,GROUP2                                       02S0446 01230000
         ST    @07,ADPLFMT1(,@14)                               02S0446 01231000
*           ADPLFMT2=ADDR(RCD21LN)+1;/* ADDR OF DATA IN BUFFER       */ 01232000
         L     @07,DATAPTR(,PLISTPTR)                           02S0447 01233000
         LA    @07,RCD21LN+46(,@07)                             02S0447 01234000
         AH    @07,@CH00046                                     02S0447 01235000
         ST    @07,ADPLFMT2(,@14)                               02S0447 01236000
*           R0=ADDR(DYNAMPTN);      /* ADDR OF PATTERNS FOR THIS LINE*/ 01237000
         LA    R0,DYNAMPTN                                      02S0448 01238000
*           CALL AMDPRFMT;          /* FORMAT LINE                   */ 01239000
         L     @15,FMTADDR(,PLISTPTR)                           02S0449 01240000
         BALR  @14,@15                                          02S0449 01241000
*           RETCODE=4;              /* INDICATES TO PRINT BUFFER AND    01242000
*                                      GET NEXT RECORD               */ 01243000
         LA    RETCODE,4                                        02S0450 01244000
*         END;                                                  02S0451 01245000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 01246000
         B     CE0001@                                          02S0452 01247000
*     END S21;                      /* END OF SUBCASE                */ 01248000
*                                                               02S0454 01249000
*     /***************************************************************/ 01250000
*     /*                                                             */ 01251000
*     /* THIS ROUTINE WILL PROCESS SVC 25. THE FORMATTING CONSISTS OF*/ 01252000
*     /* THE BAISC RECORD + A DDNAME + A DCBFDAD + A DCBTRKBAK.      */ 01253000
*     /*                                                             */ 01254000
*     /***************************************************************/ 01255000
*                                                               02S0454 01256000
*S25:                                                           02S0454 01257000
*     DO;                           /* SUBCASE                       */ 01258000
S25      DS    0H                                               02S0455 01259000
*       IF TIMESW=0 THEN            /* IS THIS THE FIRST PASS        */ 01260000
         ICM   @14,3,TIMESW                                     02S0455 01261000
         BNZ   @RF00455                                         02S0455 01262000
*         DO;                       /* YES - FORMAT DDNAME           */ 01263000
*           ADPLFMT1=ADDR(LDDNL1);  /* ADDR OF LABEL FOR THIS FIELD  */ 01264000
         L     @14,ABDPLPTR(,PLISTPTR)                          02S0457 01265000
         LA    @07,LDDNL1                                       02S0457 01266000
         ST    @07,ADPLFMT1(,@14)                               02S0457 01267000
*           ADPLFMT2=ADDR(RCD25DDN);/* ADDR OF DDNAME IN RECORD      */ 01268000
         LA    @07,46                                           02S0458 01269000
         AL    @07,DATAPTR(,PLISTPTR)                           02S0458 01270000
         ST    @07,ADPLFMT2(,@14)                               02S0458 01271000
*           R0=ADDR(DDNLN1);        /* ADDR OF PATTERN FOR DDNAME    */ 01272000
         LA    R0,DDNLN1                                        02S0459 01273000
*           CALL AMDPRFMT;          /* FORMAT DDNAME ON FIRST LINE   */ 01274000
         L     @15,FMTADDR(,PLISTPTR)                           02S0460 01275000
         BALR  @14,@15                                          02S0460 01276000
*           RETCODE=0;              /* INDICATES TO PRINT BUFFER AND    01277000
*                                      RETURN FOR SECOND PASS        */ 01278000
         SLR   RETCODE,RETCODE                                  02S0461 01279000
*         END;                                                  02S0462 01280000
*       ELSE                                                    02S0463 01281000
*         DO;                       /* NO - FORMAT REGS AND REMAINING   01282000
*                                      FIELDS                        */ 01283000
         B     @RC00455                                         02S0463 01284000
@RF00455 DS    0H                                               02S0464 01285000
*           DYNAMPTN(1:LENGTH(GP4S25))=GP4S25;/* MOVE PATTERNS TO       01286000
*                                      GETMAINED AREA                */ 01287000
         MVC   DYNAMPTN(13),GP4S25                              02S0464 01288000
*           IF DCBFDAD=ASTER8|DCBFDAD=PEES8|DCBFDAD=ESSES8 THEN/* IS    01289000
*                                      FIELD IN ERROR                */ 01290000
         LA    @14,46                                           02S0465 01291000
         AL    @14,DATAPTR(,PLISTPTR)                           02S0465 01292000
         CLC   DCBFDAD(8,@14),ASTER8                            02S0465 01293000
         BE    @RT00465                                         02S0465 01294000
         CLC   DCBFDAD(8,@14),PEES8                             02S0465 01295000
         BE    @RT00465                                         02S0465 01296000
         CLC   DCBFDAD(8,@14),ESSES8                            02S0465 01297000
         BNE   @RF00465                                         02S0465 01298000
@RT00465 DS    0H                                               02S0466 01299000
*             DO;                   /* YES                           */ 01300000
*               OLDFLG(1)=OLDFLG(1)|CHARFLAG;/* INDICATE DATA IN        01301000
*                                      EBCDIC                        */ 01302000
         LA    @14,32                                           02S0467 01303000
         SLR   @07,@07                                          02S0467 01304000
         IC    @07,OLDFLG                                       02S0467 01305000
         OR    @07,@14                                          02S0467 01306000
         STC   @07,OLDFLG                                       02S0467 01307000
*               OLDFLG(2)=OLDFLG(2)|CHARFLAG;                   02S0468 01308000
         SLR   @07,@07                                          02S0468 01309000
         IC    @07,OLDFLG+4                                     02S0468 01310000
         OR    @07,@14                                          02S0468 01311000
         STC   @07,OLDFLG+4                                     02S0468 01312000
*               OLDFLG(3)=OLDFLG(3)|CHARFLAG;                   02S0469 01313000
         SLR   @07,@07                                          02S0469 01314000
         IC    @07,OLDFLG+8                                     02S0469 01315000
         OR    @14,@07                                          02S0469 01316000
         STC   @14,OLDFLG+8                                     02S0469 01317000
*             END;                                              02S0470 01318000
*           ADPLFMT1=ADDR(GP4TYP8); /* ADDR OF LABELS FOR THIS LINE  */ 01319000
@RF00465 L     @14,ABDPLPTR(,PLISTPTR)                          02S0471 01320000
         LA    @07,GP4TYP8                                      02S0471 01321000
         ST    @07,ADPLFMT1(,@14)                               02S0471 01322000
*           ADPLFMT2=ADDR(DCBFDAD); /* ADDR OF DATA IN BUFFER        */ 01323000
         L     @07,DATAPTR(,PLISTPTR)                           02S0472 01324000
         LA    @07,DCBFDAD+46(,@07)                             02S0472 01325000
         ST    @07,ADPLFMT2(,@14)                               02S0472 01326000
*           R0=ADDR(DYNAMPTN);      /* ADDR OF PATTERNS FOR THIS LINE*/ 01327000
         LA    R0,DYNAMPTN                                      02S0473 01328000
*           CALL AMDPRFMT;          /* FORMAT LINE                   */ 01329000
         L     @15,FMTADDR(,PLISTPTR)                           02S0474 01330000
         BALR  @14,@15                                          02S0474 01331000
*           RETCODE=4;              /* INDICATES TO PRINT BUFFER AND    01332000
*                                      GET NEXT RECORD               */ 01333000
         LA    RETCODE,4                                        02S0475 01334000
*         END;                                                  02S0476 01335000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 01336000
         B     CE0001@                                          02S0477 01337000
*     END S25;                      /* END OF SUBCASE                */ 01338000
*                                                               02S0479 01339000
*     /***************************************************************/ 01340000
*     /*                                                             */ 01341000
*     /* THIS ROUTINE WILL PROCESS SVC26. THE FORMATTING CONSISTS OF */ 01342000
*     /* THE BASIC RECORD + A VARIABLE LENGTH PLIST + A VARIABLE     */ 01343000
*     /* LENGTH DSNAME + A VARIABLE LENGTH VOLIST.                   */ 01344000
*     /*                                                             */ 01345000
*     /***************************************************************/ 01346000
*                                                               02S0479 01347000
*S26:                                                           02S0479 01348000
*     DO;                           /* SUBCASE                       */ 01349000
S26      DS    0H                                               02S0480 01350000
*       IF TIMESW=0 THEN            /* HAS SECOND LINE BEEN FORMATTED*/ 01351000
         SLR   @14,@14                                          02S0480 01352000
         CH    @14,TIMESW                                       02S0480 01353000
         BNE   @RF00480                                         02S0480 01354000
*         RETCODE=0;                /* NO - INDICATES TO PRINT BUFFER   01355000
*                                      AND RETURN FOR SECOND PASS    */ 01356000
         LR    RETCODE,@14                                      02S0481 01357000
*       ELSE                                                    02S0482 01358000
*         DO;                       /* YES - REGISTERS HAVE BEEN        01359000
*                                      FORMATTED                     */ 01360000
         B     @RC00480                                         02S0482 01361000
@RF00480 DS    0H                                               02S0483 01362000
*           IF TIMESW=1 THEN        /* HAS REMAINDER OF SECOND LINE     01363000
*                                      BEEN FORMATTED                */ 01364000
         CLC   TIMESW(2),@CH00046                               02S0483 01365000
         BNE   @RF00483                                         02S0483 01366000
*             DO;                   /* NO                            */ 01367000
*               DYNAMPTN(1:LENGTH(GP4S26A))=GP4S26A;/* MOVE PATTERNS    01368000
*                                      TO GETMAIN AREA               */ 01369000
         MVC   DYNAMPTN(21),GP4S26A                             02S0485 01370000
*               IF RCD26LN=ERROR THEN/* IS FIELD IN ERROR            */ 01371000
         LA    @14,46                                           02S0486 01372000
         AL    @14,DATAPTR(,PLISTPTR)                           02S0486 01373000
         CLI   RCD26LN(@14),255                                 02S0486 01374000
         BNE   @RF00486                                         02S0486 01375000
*                 DO;               /* YES                           */ 01376000
*                   OLDFLG(1)=OLDFLG(1)|CHARFLAG;/* INDICATE DATA IN    01377000
*                                      EBCDIC                        */ 01378000
         SLR   @07,@07                                          02S0488 01379000
         IC    @07,OLDFLG                                       02S0488 01380000
         O     @07,@CF00092                                     02S0488 01381000
         STC   @07,OLDFLG                                       02S0488 01382000
*                   OLDFLG(2)=0;    /* INDICATE END OF PATTERNS      */ 01383000
         MVI   OLDFLG+4,X'00'                                   02S0489 01384000
*                   RCD26LN=4;      /* MODIFY LENGTH IN ORDER TO        01385000
*                                      ACCESS NEXT FIELD             */ 01386000
         MVI   RCD26LN(@14),X'04'                               02S0490 01387000
*                 END;                                          02S0491 01388000
*               ELSE                                            02S0492 01389000
*                 DO;               /* FORMAT 4 OR 5 WORDS           */ 01390000
         B     @RC00486                                         02S0492 01391000
@RF00486 DS    0H                                               02S0493 01392000
*                   IF RCD26LN=16 THEN/* IS PLIST 4 WORDS            */ 01393000
         L     @14,DATAPTR(,PLISTPTR)                           02S0493 01394000
         CLI   RCD26LN+46(@14),16                               02S0493 01395000
         BNE   @RF00493                                         02S0493 01396000
*                     OLDFLG(5)=0;  /* YES - INDICATE END OF PATTERNS*/ 01397000
         MVI   OLDFLG+16,X'00'                                  02S0494 01398000
*                 END;                                          02S0495 01399000
@RF00493 DS    0H                                               02S0496 01400000
*               ADPLFMT1=ADDR(GROUP2);/* ADDR OF LABELS FOR THIS LINE*/ 01401000
@RC00486 L     @14,ABDPLPTR(,PLISTPTR)                          02S0496 01402000
         LA    @07,GROUP2                                       02S0496 01403000
         ST    @07,ADPLFMT1(,@14)                               02S0496 01404000
*               ADPLFMT2=ADDR(RCD26LN)+1;/* ADDR OF DATA IN BUFFER   */ 01405000
         LA    @07,47                                           02S0497 01406000
         AL    @07,DATAPTR(,PLISTPTR)                           02S0497 01407000
         ST    @07,ADPLFMT2(,@14)                               02S0497 01408000
*               R0=ADDR(DYNAMPTN);  /* ADDR OF PATTERNS              */ 01409000
         LA    R0,DYNAMPTN                                      02S0498 01410000
*               CALL AMDPRFMT;      /* FORMAT THE LINE               */ 01411000
         L     @15,FMTADDR(,PLISTPTR)                           02S0499 01412000
         BALR  @14,@15                                          02S0499 01413000
*               RETCODE=0;          /* INDICATES TO PRINT BUFFER AND    01414000
*                                      RETURN FOR THIRD PASS         */ 01415000
         SLR   RETCODE,RETCODE                                  02S0500 01416000
*             END;                                              02S0501 01417000
*           ELSE                                                02S0502 01418000
*             DO;                   /* YES                           */ 01419000
         B     @RC00483                                         02S0502 01420000
@RF00483 DS    0H                                               02S0503 01421000
*               IF TIMESW=2 THEN    /* HAS THIRD LINE BEEN FORMATTED */ 01422000
         CLC   TIMESW(2),@CH00078                               02S0503 01423000
         BNE   @RF00503                                         02S0503 01424000
*                 DO;               /* NO                            */ 01425000
*                   DYNAMPTN(1:LENGTH(GP4S26B))=GP4S26B;/* MOVE 02S0505 01426000
*                                      PATTERNS TO GETMAIN AREA      */ 01427000
         MVC   DYNAMPTN(13),GP4S26B                             02S0505 01428000
*                   FIELDADR=ADDR(RCD26LN)+RCD26LN+1;/* ADDR OF 02S0506 01429000
*                                      DSNAME IN BUFFER              */ 01430000
         LA    @14,46                                           02S0506 01431000
         AL    @14,DATAPTR(,PLISTPTR)                           02S0506 01432000
         SLR   @07,@07                                          02S0506 01433000
         IC    @07,RCD26LN(,@14)                                02S0506 01434000
         ALR   @07,@14                                          02S0506 01435000
         AH    @07,@CH00046                                     02S0506 01436000
         ST    @07,FIELDADR                                     02S0506 01437000
*                   IF NXTFIELD^=ERROR THEN/* IS FIELD IN ERROR      */ 01438000
         CLI   NXTFIELD(@07),255                                02S0507 01439000
         BE    @RF00507                                         02S0507 01440000
*                     DO;           /* NO                            */ 01441000
*                       IF NXTFIELD^=44 THEN/* IS DSN MAX LENGTH     */ 01442000
         CLI   NXTFIELD(@07),44                                 02S0509 01443000
         BE    @RF00509                                         02S0509 01444000
*                         DO;       /* NO                            */ 01445000
*                           K=NXTFIELD/16;/* NUMBER OF FULL WORDS    */ 01446000
         L     @14,FIELDADR                                     02S0511 01447000
         SLR   @05,@05                                          02S0511 01448000
         IC    @05,NXTFIELD(,@14)                               02S0511 01449000
         LR    K,@05                                            02S0511 01450000
         SRL   K,4                                              02S0511 01451000
*                           MOD=NXTFIELD//16;/* REMAINDER OF PARTIAL    01452000
*                                      WORD                          */ 01453000
         LR    @02,@05                                          02S0512 01454000
         SRDA  @02,32                                           02S0512 01455000
         D     @02,@CF00139                                     02S0512 01456000
         LR    MOD,@02                                          02S0512 01457000
*                           IF MOD=0 THEN/* ARE ALL FULL WORDS       */ 01458000
         SLR   @14,@14                                          02S0513 01459000
         CR    MOD,@14                                          02S0513 01460000
         BNE   @RF00513                                         02S0513 01461000
*                             OLDFLG(K+1)=0;/* YES - INDICATE END OF    01462000
*                                      PATTERNS                      */ 01463000
         LR    @07,K                                            02S0514 01464000
         SLA   @07,2                                            02S0514 01465000
         STC   @14,OLDFLG(@07)                                  02S0514 01466000
*                           ELSE                                02S0515 01467000
*                             DO;   /* NO - MODIFY PATTERNS     02S0515 01468000
*                                      ACCORDINGLY                   */ 01469000
         B     @RC00513                                         02S0515 01470000
@RF00513 DS    0H                                               02S0516 01471000
*                               OLDLN(K+1)=OLDLN(K+1)&DATAOFF;/* SET    01472000
*                                      DATA LENGTH TO ZERO           */ 01473000
         LR    @14,K                                            02S0516 01474000
         SLA   @14,2                                            02S0516 01475000
         SLR   @05,@05                                          02S0516 01476000
         IC    @05,OLDLN(@14)                                   02S0516 01477000
         N     @05,@CF00297                                     02S0516 01478000
         STC   @05,OLDLN(@14)                                   02S0516 01479000
*                               OLDLN(K+1)=OLDLN(K+1)|(MOD-1);/* NEW    01480000
*                                      DATA LENGTH                   */ 01481000
         LR    @03,MOD                                          02S0517 01482000
         BCTR  @03,0                                            02S0517 01483000
         OR    @05,@03                                          02S0517 01484000
         STC   @05,OLDLN(@14)                                   02S0517 01485000
*                               OLDFLG(K+2)=0;/* INDICATE END OF        01486000
*                                      PATTERNS                      */ 01487000
         SLR   @07,@07                                          02S0518 01488000
         STC   @07,OLDFLG+4(@14)                                02S0518 01489000
*                             END;                              02S0519 01490000
*                         END;                                  02S0520 01491000
*                     END;                                      02S0521 01492000
*                   ELSE                                        02S0522 01493000
*                     DO;           /* YES - FIELD IS IN ERROR       */ 01494000
         B     @RC00507                                         02S0522 01495000
@RF00507 DS    0H                                               02S0523 01496000
*                       OLDLN(1)=OLDLN(1)&DATAOFF;/* ZERO DATA LENGTH*/ 01497000
         SLR   @14,@14                                          02S0523 01498000
         IC    @14,OLDLN                                        02S0523 01499000
         N     @14,@CF00297                                     02S0523 01500000
         STC   @14,OLDLN                                        02S0523 01501000
*                       OLDLN(1)=OLDLN(1)|DATALN4;/* SET DATA LENGTH    01502000
*                                      TO FORMAT 4 BYTES             */ 01503000
         O     @14,@CF00170                                     02S0524 01504000
         STC   @14,OLDLN                                        02S0524 01505000
*                       OLDFLG(2)=0;/* INDICATE END OF PATTERNS      */ 01506000
         MVI   OLDFLG+4,X'00'                                   02S0525 01507000
*                       NXTFIELD=4; /* MODIFY LENGTH IN ORDER TO        01508000
*                                      ACCESS VOLIST                 */ 01509000
         L     @14,FIELDADR                                     02S0526 01510000
         MVI   NXTFIELD(@14),X'04'                              02S0526 01511000
*                     END;                                      02S0527 01512000
*                   ADPLFMT1=ADDR(GP4TYP9);/* ADDR OF LABELS FOR THIS   01513000
*                                      LINE                          */ 01514000
@RC00507 L     @14,ABDPLPTR(,PLISTPTR)                          02S0528 01515000
         LA    @07,GP4TYP9                                      02S0528 01516000
         ST    @07,ADPLFMT1(,@14)                               02S0528 01517000
*                   ADPLFMT2=FIELDADR+1;/* ADDR OF DATA IN BUFFER    */ 01518000
         LA    @07,1                                            02S0529 01519000
         AL    @07,FIELDADR                                     02S0529 01520000
         ST    @07,ADPLFMT2(,@14)                               02S0529 01521000
*                   R0=ADDR(DYNAMPTN);/* ADDR OF PATTERNS            */ 01522000
         LA    R0,DYNAMPTN                                      02S0530 01523000
*                   CALL AMDPRFMT;  /* FORMAT THE LINE               */ 01524000
         L     @15,FMTADDR(,PLISTPTR)                           02S0531 01525000
         BALR  @14,@15                                          02S0531 01526000
*                   RETCODE=0;      /* INDICATES TO PRINT BUFFER AND    01527000
*                                      RETURN FOR FOURTH PASS        */ 01528000
         SLR   RETCODE,RETCODE                                  02S0532 01529000
*                 END;                                          02S0533 01530000
*               ELSE                                            02S0534 01531000
*                 DO;               /* YES - FORMAT THE FOURTH LINE  */ 01532000
         B     @RC00503                                         02S0534 01533000
@RF00503 DS    0H                                               02S0535 01534000
*                   DYNAMPTN(1:LENGTH(GP4S26C))=GP4S26C;/* MOVE 02S0535 01535000
*                                      PATTERNS TO GETMAIN AREA      */ 01536000
         MVC   DYNAMPTN(41),GP4S26C                             02S0535 01537000
*                   FIELDADR=FIELDADR+NXTFIELD+1;/* ADDR OF VOLIST IN   01538000
*                                      BUFFER                        */ 01539000
         L     @14,FIELDADR                                     02S0536 01540000
         SLR   @07,@07                                          02S0536 01541000
         IC    @07,NXTFIELD(,@14)                               02S0536 01542000
         ALR   @07,@14                                          02S0536 01543000
         AH    @07,@CH00046                                     02S0536 01544000
         ST    @07,FIELDADR                                     02S0536 01545000
*                   R0=ADDR(DYNAMPTN);/* ADDR OF PATTERNS FOR THIS      01546000
*                                      LINE                          */ 01547000
         LA    R0,DYNAMPTN                                      02S0537 01548000
*                   IF NXTFIELD=ERROR THEN/* IS FIELD IN ERROR       */ 01549000
         CLI   NXTFIELD(@07),255                                02S0538 01550000
         BNE   @RF00538                                         02S0538 01551000
*                     DO;           /* YES - ONLY FORMAT 4 BYTES     */ 01552000
*                       OLDFLG(1)=OLDFLG(1)|CHARFLAG;/* INDICATE DATA   01553000
*                                      IN EBCDIC                     */ 01554000
         SLR   @14,@14                                          02S0540 01555000
         IC    @14,OLDFLG                                       02S0540 01556000
         O     @14,@CF00092                                     02S0540 01557000
         STC   @14,OLDFLG                                       02S0540 01558000
*                       OLDFLG(2)=0;/* INDICATE END OF PATTERNS      */ 01559000
         MVI   OLDFLG+4,X'00'                                   02S0541 01560000
*                     END;                                      02S0542 01561000
*                   ELSE                                        02S0543 01562000
*                     DO;           /* NO - DETERMINE HOW MANY BYTES    01563000
*                                      IN VOLIST                     */ 01564000
         B     @RC00538                                         02S0543 01565000
@RF00538 DS    0H                                               02S0544 01566000
*                       IF NXTFIELD=0 THEN/* IS THERE ANY DATA       */ 01567000
         L     @14,FIELDADR                                     02S0544 01568000
         CLI   NXTFIELD(@14),0                                  02S0544 01569000
         BNE   @RF00544                                         02S0544 01570000
*                         R0=ADDR(GP4S26D);/* NO - ADDR OF PATTERNS     01571000
*                                      FOR THIS LINE                 */ 01572000
         LA    R0,GP4S26D                                       02S0545 01573000
*                       ELSE                                    02S0546 01574000
*                         DO;       /* YES - THERE IS DATA IN VOLIST */ 01575000
         B     @RC00544                                         02S0546 01576000
@RF00544 DS    0H                                               02S0547 01577000
*                           IF NXTFIELD<4 THEN/* IS VOLIST LESS THAN    01578000
*                                      ONE WORD                      */ 01579000
         L     @14,FIELDADR                                     02S0547 01580000
         CLI   NXTFIELD(@14),4                                  02S0547 01581000
         BNL   @RF00547                                         02S0547 01582000
*                             DO;   /* YES                           */ 01583000
*                               OLDLN(1)=OLDLN(1)&DATAOFF;/* SET DATA   01584000
*                                      LENGTH TO 0                   */ 01585000
         SLR   @07,@07                                          02S0549 01586000
         IC    @07,OLDLN                                        02S0549 01587000
         N     @07,@CF00297                                     02S0549 01588000
         STC   @07,OLDLN                                        02S0549 01589000
*                               OLDLN(1)=OLDLN(1)|(NXTFIELD-1);/* NEW   01590000
*                                      DATA LENGTH                   */ 01591000
         SLR   @05,@05                                          02S0550 01592000
         IC    @05,NXTFIELD(,@14)                               02S0550 01593000
         BCTR  @05,0                                            02S0550 01594000
         OR    @07,@05                                          02S0550 01595000
         STC   @07,OLDLN                                        02S0550 01596000
*                               OLDFLG(2)=0;/* INDICATE END OF  02S0551 01597000
*                                      PATTERNS                      */ 01598000
         MVI   OLDFLG+4,X'00'                                   02S0551 01599000
*                             END;                              02S0552 01600000
*                           ELSE                                02S0553 01601000
*                             DO;   /* NO - MODIFY PATTERNS          */ 01602000
         B     @RC00547                                         02S0553 01603000
@RF00547 DS    0H                                               02S0554 01604000
*                               K=NXTFIELD/4;/* NUMBER OF FULL WORDS */ 01605000
         L     @14,FIELDADR                                     02S0554 01606000
         SLR   @05,@05                                          02S0554 01607000
         IC    @05,NXTFIELD(,@14)                               02S0554 01608000
         LR    K,@05                                            02S0554 01609000
         SRL   K,2                                              02S0554 01610000
*                               MOD=NXTFIELD//4;/* REMAINDER OF 02S0555 01611000
*                                      PARTIAL WORD                  */ 01612000
         LR    @02,@05                                          02S0555 01613000
         SRDA  @02,32                                           02S0555 01614000
         D     @02,@CF00099                                     02S0555 01615000
         LR    MOD,@02                                          02S0555 01616000
*                               IF MOD=0 THEN/* ARE ALL FULL WORDS   */ 01617000
         SLR   @14,@14                                          02S0556 01618000
         CR    MOD,@14                                          02S0556 01619000
         BNE   @RF00556                                         02S0556 01620000
*                                 OLDFLG(K+1)=0;/* YES - INDICATE END   01621000
*                                      OF PATTERNS                   */ 01622000
         LR    @07,K                                            02S0557 01623000
         SLA   @07,2                                            02S0557 01624000
         STC   @14,OLDFLG(@07)                                  02S0557 01625000
*                               ELSE                            02S0558 01626000
*                                 DO;/* NO - MODIFY PATTERNS    02S0558 01627000
*                                      ACCORDINGLY                   */ 01628000
         B     @RC00556                                         02S0558 01629000
@RF00556 DS    0H                                               02S0559 01630000
*                                   OLDLN(K+1)=OLDLN(K+1)&DATAOFF;/*    01631000
*                                      SET DATA LENGTH TO ZERO       */ 01632000
         LR    @14,K                                            02S0559 01633000
         SLA   @14,2                                            02S0559 01634000
         SLR   @05,@05                                          02S0559 01635000
         IC    @05,OLDLN(@14)                                   02S0559 01636000
         N     @05,@CF00297                                     02S0559 01637000
         STC   @05,OLDLN(@14)                                   02S0559 01638000
*                                   OLDLN(K+1)=OLDLN(K+1)|(MOD-1);/*    01639000
*                                      NEW DATA LENGTH               */ 01640000
         LR    @03,MOD                                          02S0560 01641000
         BCTR  @03,0                                            02S0560 01642000
         OR    @05,@03                                          02S0560 01643000
         STC   @05,OLDLN(@14)                                   02S0560 01644000
*                                   OLDFLG(K+2)=0;/* INDICATE END OF    01645000
*                                      PATTERNS                      */ 01646000
         SLR   @07,@07                                          02S0561 01647000
         STC   @07,OLDFLG+4(@14)                                02S0561 01648000
*                                 END;                          02S0562 01649000
*                             END;                              02S0563 01650000
@RC00556 DS    0H                                               02S0564 01651000
*                         END;                                  02S0564 01652000
@RC00547 DS    0H                                               02S0565 01653000
*                     END;                                      02S0565 01654000
@RC00544 DS    0H                                               02S0566 01655000
*                   ADPLFMT1=ADDR(GP4TYP2);/* ADDR OF LABEL FOR THIS    01656000
*                                      LINE                          */ 01657000
@RC00538 L     @14,ABDPLPTR(,PLISTPTR)                          02S0566 01658000
         LA    @07,GP4TYP2                                      02S0566 01659000
         ST    @07,ADPLFMT1(,@14)                               02S0566 01660000
*                   ADPLFMT2=FIELDADR+1;/* ADDR OF DATA IN BUFFER    */ 01661000
         LA    @07,1                                            02S0567 01662000
         AL    @07,FIELDADR                                     02S0567 01663000
         ST    @07,ADPLFMT2(,@14)                               02S0567 01664000
*                   CALL AMDPRFMT;  /* FORMAT THE LINE               */ 01665000
         L     @15,FMTADDR(,PLISTPTR)                           02S0568 01666000
         BALR  @14,@15                                          02S0568 01667000
*                   RETCODE=4;      /* INDICATES TO PRINT BUFFER AND    01668000
*                                      GET NEXT RECORD               */ 01669000
         LA    RETCODE,4                                        02S0569 01670000
*                 END;                                          02S0570 01671000
*             END;                                              02S0571 01672000
*         END;                                                  02S0572 01673000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 01674000
         B     CE0001@                                          02S0573 01675000
*     END S26;                      /* END OF SUBCASE                */ 01676000
*                                                               02S0575 01677000
*     /***************************************************************/ 01678000
*     /*                                                             */ 01679000
*     /* THIS ROUTINE WILL PROCESS SVC 27. THE FORMATTING CONSISTS OF*/ 01680000
*     /* THE BASIC RECORD + A 16 BYTE PLIST + A VOL-SER + A VARIABLE */ 01681000
*     /* DSNAME/TTR.                                                 */ 01682000
*     /*                                                             */ 01683000
*     /***************************************************************/ 01684000
*                                                               02S0575 01685000
*S27:                                                           02S0575 01686000
*     DO;                           /* SUBCASE                       */ 01687000
S27      DS    0H                                               02S0576 01688000
*       IF TIMESW=0 THEN            /* HAS SECOND LINE BEEN FORMATTED*/ 01689000
         SLR   @14,@14                                          02S0576 01690000
         CH    @14,TIMESW                                       02S0576 01691000
         BNE   @RF00576                                         02S0576 01692000
*         RETCODE=0;                /* NO - INDICATES TO PRINT BUFFER   01693000
*                                      AND RETURN FOR SECOND PASS    */ 01694000
         LR    RETCODE,@14                                      02S0577 01695000
*       ELSE                                                    02S0578 01696000
*         DO;                       /* YES - REGISTERS HAVE BEEN        01697000
*                                      FORMATTED                     */ 01698000
         B     @RC00576                                         02S0578 01699000
@RF00576 DS    0H                                               02S0579 01700000
*           IF TIMESW=1 THEN        /* HAS REMAINDER OF SECOND LINE     01701000
*                                      BEEN FORMATTED                */ 01702000
         CLC   TIMESW(2),@CH00046                               02S0579 01703000
         BNE   @RF00579                                         02S0579 01704000
*             DO;                   /* NO                            */ 01705000
*               DYNAMPTN(1:LENGTH(GP4S27A))=GP4S27A;/* MOVE PATTERNS    01706000
*                                      TO GETMAIN AREA               */ 01707000
         MVC   DYNAMPTN(21),GP4S27A                             02S0581 01708000
*               IF RCD27LST=ASTER16|RCD27LST=PEES16|RCD27LST=ESSES16    01709000
*                 THEN              /* IS FIELD IN ERROR             */ 01710000
         LA    @14,46                                           02S0582 01711000
         AL    @14,DATAPTR(,PLISTPTR)                           02S0582 01712000
         CLC   RCD27LST(16,@14),ASTER16                         02S0582 01713000
         BE    @RT00582                                         02S0582 01714000
         CLC   RCD27LST(16,@14),PEES16                          02S0582 01715000
         BE    @RT00582                                         02S0582 01716000
         CLC   RCD27LST(16,@14),ESSES16                         02S0582 01717000
         BNE   @RF00582                                         02S0582 01718000
@RT00582 DS    0H                                               02S0583 01719000
*                 DO;               /* YES                           */ 01720000
*                   OLDFLG(1)=OLDFLG(1)|CHARFLAG;/* INDICATE DATA IN    01721000
*                                      EBCDIC                        */ 01722000
         LA    @14,32                                           02S0584 01723000
         SLR   @07,@07                                          02S0584 01724000
         IC    @07,OLDFLG                                       02S0584 01725000
         OR    @07,@14                                          02S0584 01726000
         STC   @07,OLDFLG                                       02S0584 01727000
*                   OLDFLG(2)=OLDFLG(2)|CHARFLAG;               02S0585 01728000
         SLR   @07,@07                                          02S0585 01729000
         IC    @07,OLDFLG+4                                     02S0585 01730000
         OR    @07,@14                                          02S0585 01731000
         STC   @07,OLDFLG+4                                     02S0585 01732000
*                   OLDFLG(3)=OLDFLG(3)|CHARFLAG;               02S0586 01733000
         SLR   @07,@07                                          02S0586 01734000
         IC    @07,OLDFLG+8                                     02S0586 01735000
         OR    @07,@14                                          02S0586 01736000
         STC   @07,OLDFLG+8                                     02S0586 01737000
*                   OLDFLG(4)=OLDFLG(4)|CHARFLAG;               02S0587 01738000
         SLR   @07,@07                                          02S0587 01739000
         IC    @07,OLDFLG+12                                    02S0587 01740000
         OR    @14,@07                                          02S0587 01741000
         STC   @14,OLDFLG+12                                    02S0587 01742000
*                 END;                                          02S0588 01743000
*               ADPLFMT1=ADDR(GP4TYP10);/* ADDR OF LABELS FOR THIS      01744000
*                                      LINE                          */ 01745000
@RF00582 L     @14,ABDPLPTR(,PLISTPTR)                          02S0589 01746000
         LA    @07,GP4TYP10                                     02S0589 01747000
         ST    @07,ADPLFMT1(,@14)                               02S0589 01748000
*               ADPLFMT2=ADDR(RCD27LST);/* ADDR OF DATA IN BUFFER    */ 01749000
         LA    @07,46                                           02S0590 01750000
         AL    @07,DATAPTR(,PLISTPTR)                           02S0590 01751000
         ST    @07,ADPLFMT2(,@14)                               02S0590 01752000
*               R0=ADDR(DYNAMPTN);  /* ADDR OF PATTERNS              */ 01753000
         LA    R0,DYNAMPTN                                      02S0591 01754000
*               CALL AMDPRFMT;      /* FORMAT THE LINE               */ 01755000
         L     @15,FMTADDR(,PLISTPTR)                           02S0592 01756000
         BALR  @14,@15                                          02S0592 01757000
*               RETCODE=0;          /* INDICATES TO PRINT BUFFER AND    01758000
*                                      RETURN FOR THIRD PASS         */ 01759000
         SLR   RETCODE,RETCODE                                  02S0593 01760000
*             END;                                              02S0594 01761000
*           ELSE                                                02S0595 01762000
*             DO;                   /* YES - FORMAT THE THIRD LINE   */ 01763000
         B     @RC00579                                         02S0595 01764000
@RF00579 DS    0H                                               02S0596 01765000
*               DYNAMPTN(1:LENGTH(GP4S27B))=GP4S27B;/* MOVE PATTERNS    01766000
*                                      TO GETMAIN AREA               */ 01767000
         MVC   DYNAMPTN(13),GP4S27B                             02S0596 01768000
*               IF RCD27LN^=ERROR THEN/* IS FIELD IN ERROR           */ 01769000
         LA    @14,46                                           02S0597 01770000
         AL    @14,DATAPTR(,PLISTPTR)                           02S0597 01771000
         CLI   RCD27LN(@14),255                                 02S0597 01772000
         BE    @RF00597                                         02S0597 01773000
*                 DO;               /* NO                            */ 01774000
*                   IF RCD27LN^=44 THEN/* IS DSN MAX LENGTH          */ 01775000
         CLI   RCD27LN(@14),44                                  02S0599 01776000
         BE    @RF00599                                         02S0599 01777000
*                     DO;           /* NO                            */ 01778000
*                       K=RCD27LN/16;/* NUMBER OF FULL WORDS         */ 01779000
         SLR   @05,@05                                          02S0601 01780000
         IC    @05,RCD27LN(,@14)                                02S0601 01781000
         LR    K,@05                                            02S0601 01782000
         SRL   K,4                                              02S0601 01783000
*                       MOD=RCD27LN//16;/* REMAINDER OF PARTIAL WORD */ 01784000
         LR    @02,@05                                          02S0602 01785000
         SRDA  @02,32                                           02S0602 01786000
         D     @02,@CF00139                                     02S0602 01787000
         LR    MOD,@02                                          02S0602 01788000
*                       IF MOD=0 THEN/* ARE ALL FULL WORDS           */ 01789000
         SLR   @14,@14                                          02S0603 01790000
         CR    MOD,@14                                          02S0603 01791000
         BNE   @RF00603                                         02S0603 01792000
*                         OLDFLG(K+1)=0;/* YES - INDICATE END OF        01793000
*                                      PATTERNS                      */ 01794000
         LR    @07,K                                            02S0604 01795000
         SLA   @07,2                                            02S0604 01796000
         STC   @14,OLDFLG(@07)                                  02S0604 01797000
*                       ELSE                                    02S0605 01798000
*                         DO;       /* NO - MODIFY PATTERNS     02S0605 01799000
*                                      ACCORDINGLY                   */ 01800000
         B     @RC00603                                         02S0605 01801000
@RF00603 DS    0H                                               02S0606 01802000
*                           OLDLN(K+1)=OLDLN(K+1)&DATAOFF;/* SET DATA   01803000
*                                      LENGTH TO ZERO                */ 01804000
         LR    @14,K                                            02S0606 01805000
         SLA   @14,2                                            02S0606 01806000
         SLR   @05,@05                                          02S0606 01807000
         IC    @05,OLDLN(@14)                                   02S0606 01808000
         N     @05,@CF00297                                     02S0606 01809000
         STC   @05,OLDLN(@14)                                   02S0606 01810000
*                           OLDLN(K+1)=OLDLN(K+1)|(MOD-1);/* NEW DATA   01811000
*                                      LENGTH                        */ 01812000
         LR    @03,MOD                                          02S0607 01813000
         BCTR  @03,0                                            02S0607 01814000
         OR    @05,@03                                          02S0607 01815000
         STC   @05,OLDLN(@14)                                   02S0607 01816000
*                           OLDFLG(K+2)=0;/* INDICATE END OF PATTERNS*/ 01817000
         SLR   @07,@07                                          02S0608 01818000
         STC   @07,OLDFLG+4(@14)                                02S0608 01819000
*                         END;                                  02S0609 01820000
*                     END;                                      02S0610 01821000
*                 END;                                          02S0611 01822000
*               ELSE                                            02S0612 01823000
*                 DO;               /* YES - FIELD IS IN ERROR       */ 01824000
         B     @RC00597                                         02S0612 01825000
@RF00597 DS    0H                                               02S0613 01826000
*                   OLDLN(1)=OLDLN(1)&DATAOFF;/* ZERO DATA LENGTH    */ 01827000
         SLR   @14,@14                                          02S0613 01828000
         IC    @14,OLDLN                                        02S0613 01829000
         N     @14,@CF00297                                     02S0613 01830000
         STC   @14,OLDLN                                        02S0613 01831000
*                   OLDLN(1)=OLDLN(1)|DATALN4;/* SET DATA LENGTH TO     01832000
*                                      FORMAT 4 BYTES                */ 01833000
         O     @14,@CF00170                                     02S0614 01834000
         STC   @14,OLDLN                                        02S0614 01835000
*                   OLDFLG(2)=0;    /* INDICATE END OF PATTERNS      */ 01836000
         MVI   OLDFLG+4,X'00'                                   02S0615 01837000
*                 END;                                          02S0616 01838000
*               ADPLFMT1=ADDR(GP4TP10A);/* ADDR OF LABELS FOR THIS      01839000
*                                      LINE                          */ 01840000
@RC00597 L     @14,ABDPLPTR(,PLISTPTR)                          02S0617 01841000
         LA    @07,GP4TP10A                                     02S0617 01842000
         ST    @07,ADPLFMT1(,@14)                               02S0617 01843000
*               ADPLFMT2=ADDR(RCD27LN)+1;/* ADDR OF DATA IN BUFFER   */ 01844000
         L     @07,DATAPTR(,PLISTPTR)                           02S0618 01845000
         LA    @07,RCD27LN+46(,@07)                             02S0618 01846000
         AH    @07,@CH00046                                     02S0618 01847000
         ST    @07,ADPLFMT2(,@14)                               02S0618 01848000
*               R0=ADDR(DYNAMPTN);  /* ADDR OF PATTERNS              */ 01849000
         LA    R0,DYNAMPTN                                      02S0619 01850000
*               CALL AMDPRFMT;      /* FORMAT THE LINE               */ 01851000
         L     @15,FMTADDR(,PLISTPTR)                           02S0620 01852000
         BALR  @14,@15                                          02S0620 01853000
*               RETCODE=4;          /* INDICATES TO PRINT BUFFER AND    01854000
*                                      GET NEXT RECORD               */ 01855000
         LA    RETCODE,4                                        02S0621 01856000
*             END;                                              02S0622 01857000
*         END;                                                  02S0623 01858000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 01859000
         B     CE0001@                                          02S0624 01860000
*     END S27;                      /* END OF SUBCASE                */ 01861000
*                                                               02S0626 01862000
*     /***************************************************************/ 01863000
*     /*                                                             */ 01864000
*     /* THIS ROUTINE WILL PROCESS SVC 29. THE FORMATTING CONSISTS OF*/ 01865000
*     /* THE BASIC RECORD + A 16 BYTE PLIST + A VARIABLE LENGTH      */ 01866000
*     /* DSNAME + A VARIABLE LENGTH VOLIST.                          */ 01867000
*     /*                                                             */ 01868000
*     /***************************************************************/ 01869000
*                                                               02S0626 01870000
*S29:                                                           02S0626 01871000
*     DO;                           /* SUBCASE                       */ 01872000
S29      DS    0H                                               02S0627 01873000
*       IF TIMESW=0 THEN            /* HAS SECOND LINE BEEN FORMATTED*/ 01874000
         SLR   @14,@14                                          02S0627 01875000
         CH    @14,TIMESW                                       02S0627 01876000
         BNE   @RF00627                                         02S0627 01877000
*         RETCODE=0;                /* NO - INDICATES TO PRINT BUFFER   01878000
*                                      AND RETURN FOR SECOND PASS    */ 01879000
         LR    RETCODE,@14                                      02S0628 01880000
*       ELSE                                                    02S0629 01881000
*         DO;                       /* YES - REGISTERS HAVE BEEN        01882000
*                                      FORMATTED                     */ 01883000
         B     @RC00627                                         02S0629 01884000
@RF00627 DS    0H                                               02S0630 01885000
*           IF TIMESW=1 THEN        /* HAS REMAINDER OF SECOND LINE     01886000
*                                      BEEN FORMATTED                */ 01887000
         CLC   TIMESW(2),@CH00046                               02S0630 01888000
         BNE   @RF00630                                         02S0630 01889000
*             DO;                   /* NO                            */ 01890000
*               DYNAMPTN(1:LENGTH(GP4S26A))=GP4S26A;/* MOVE PATTERNS    01891000
*                                      TO GETMAIN AREA               */ 01892000
         MVC   DYNAMPTN(21),GP4S26A                             02S0632 01893000
*               IF RCD29LST=ASTER16|RCD29LST=PEES16|RCD29LST=ESSES16    01894000
*                 THEN              /* IS FIELD IN ERROR             */ 01895000
         LA    @14,46                                           02S0633 01896000
         AL    @14,DATAPTR(,PLISTPTR)                           02S0633 01897000
         CLC   RCD29LST(16,@14),ASTER16                         02S0633 01898000
         BE    @RT00633                                         02S0633 01899000
         CLC   RCD29LST(16,@14),PEES16                          02S0633 01900000
         BE    @RT00633                                         02S0633 01901000
         CLC   RCD29LST(16,@14),ESSES16                         02S0633 01902000
         BNE   @RF00633                                         02S0633 01903000
@RT00633 DS    0H                                               02S0634 01904000
*                 DO;               /* YES                           */ 01905000
*                   OLDFLG(1)=OLDFLG(1)|CHARFLAG;/* INDICATE DATA IN    01906000
*                                      EBCDIC                        */ 01907000
         LA    @14,32                                           02S0635 01908000
         SLR   @07,@07                                          02S0635 01909000
         IC    @07,OLDFLG                                       02S0635 01910000
         OR    @07,@14                                          02S0635 01911000
         STC   @07,OLDFLG                                       02S0635 01912000
*                   OLDFLG(2)=OLDFLG(2)|CHARFLAG;               02S0636 01913000
         SLR   @07,@07                                          02S0636 01914000
         IC    @07,OLDFLG+4                                     02S0636 01915000
         OR    @07,@14                                          02S0636 01916000
         STC   @07,OLDFLG+4                                     02S0636 01917000
*                   OLDFLG(3)=OLDFLG(3)|CHARFLAG;               02S0637 01918000
         SLR   @07,@07                                          02S0637 01919000
         IC    @07,OLDFLG+8                                     02S0637 01920000
         OR    @07,@14                                          02S0637 01921000
         STC   @07,OLDFLG+8                                     02S0637 01922000
*                   OLDFLG(4)=OLDFLG(4)|CHARFLAG;               02S0638 01923000
         SLR   @07,@07                                          02S0638 01924000
         IC    @07,OLDFLG+12                                    02S0638 01925000
         OR    @14,@07                                          02S0638 01926000
         STC   @14,OLDFLG+12                                    02S0638 01927000
*                 END;                                          02S0639 01928000
*               OLDFLG(5)=0;        /* INDICATE END OF PATTERNS      */ 01929000
@RF00633 MVI   OLDFLG+16,X'00'                                  02S0640 01930000
*               ADPLFMT1=ADDR(GROUP2);/* ADDR OF LABELS FOR THIS LINE*/ 01931000
         L     @14,ABDPLPTR(,PLISTPTR)                          02S0641 01932000
         LA    @07,GROUP2                                       02S0641 01933000
         ST    @07,ADPLFMT1(,@14)                               02S0641 01934000
*               ADPLFMT2=ADDR(RCD29LST);/* ADDR OF DATA IN BUFFER    */ 01935000
         LA    @07,46                                           02S0642 01936000
         AL    @07,DATAPTR(,PLISTPTR)                           02S0642 01937000
         ST    @07,ADPLFMT2(,@14)                               02S0642 01938000
*               R0=ADDR(DYNAMPTN);  /* ADDR OF PATTERNS              */ 01939000
         LA    R0,DYNAMPTN                                      02S0643 01940000
*               CALL AMDPRFMT;      /* FORMAT THE LINE               */ 01941000
         L     @15,FMTADDR(,PLISTPTR)                           02S0644 01942000
         BALR  @14,@15                                          02S0644 01943000
*               RETCODE=0;          /* INDICATES TO PRINT BUFFER AND    01944000
*                                      RETURN FOR THIRD PASS         */ 01945000
         SLR   RETCODE,RETCODE                                  02S0645 01946000
*             END;                                              02S0646 01947000
*           ELSE                                                02S0647 01948000
*             DO;                   /* YES                           */ 01949000
         B     @RC00630                                         02S0647 01950000
@RF00630 DS    0H                                               02S0648 01951000
*               IF TIMESW=2 THEN    /* HAS THIRD LINE BEEN FORMATTED */ 01952000
         CLC   TIMESW(2),@CH00078                               02S0648 01953000
         BNE   @RF00648                                         02S0648 01954000
*                 DO;               /* NO                            */ 01955000
*                   DYNAMPTN(1:LENGTH(GP4S26B))=GP4S26B;/* MOVE 02S0650 01956000
*                                      PATTERNS TO GETMAIN AREA      */ 01957000
         MVC   DYNAMPTN(13),GP4S26B                             02S0650 01958000
*                   IF RCD29LN^=ERROR THEN/* IS FIELD IN ERROR       */ 01959000
         LA    @14,46                                           02S0651 01960000
         AL    @14,DATAPTR(,PLISTPTR)                           02S0651 01961000
         CLI   RCD29LN(@14),255                                 02S0651 01962000
         BE    @RF00651                                         02S0651 01963000
*                     DO;           /* NO                            */ 01964000
*                       IF RCD29LN^=44 THEN/* IS DSN MAX LENGTH      */ 01965000
         CLI   RCD29LN(@14),44                                  02S0653 01966000
         BE    @RF00653                                         02S0653 01967000
*                         DO;       /* NO                            */ 01968000
*                           K=RCD29LN/16;/* NUMBER OF FULL WORDS     */ 01969000
         SLR   @05,@05                                          02S0655 01970000
         IC    @05,RCD29LN(,@14)                                02S0655 01971000
         LR    K,@05                                            02S0655 01972000
         SRL   K,4                                              02S0655 01973000
*                           MOD=RCD29LN//16;/* REMAINDER OF PARTIAL     01974000
*                                      WORD                          */ 01975000
         LR    @02,@05                                          02S0656 01976000
         SRDA  @02,32                                           02S0656 01977000
         D     @02,@CF00139                                     02S0656 01978000
         LR    MOD,@02                                          02S0656 01979000
*                           IF MOD=0 THEN/* ARE ALL FULL WORDS       */ 01980000
         SLR   @14,@14                                          02S0657 01981000
         CR    MOD,@14                                          02S0657 01982000
         BNE   @RF00657                                         02S0657 01983000
*                             OLDFLG(K+1)=0;/* YES - INDICATE END OF    01984000
*                                      PATTERNS                      */ 01985000
         LR    @07,K                                            02S0658 01986000
         SLA   @07,2                                            02S0658 01987000
         STC   @14,OLDFLG(@07)                                  02S0658 01988000
*                           ELSE                                02S0659 01989000
*                             DO;   /* NO - MODIFY PATTERNS     02S0659 01990000
*                                      ACCORDINGLY                   */ 01991000
         B     @RC00657                                         02S0659 01992000
@RF00657 DS    0H                                               02S0660 01993000
*                               OLDLN(K+1)=OLDLN(K+1)&DATAOFF;/* SET    01994000
*                                      DATA LENGTH TO ZERO           */ 01995000
         LR    @14,K                                            02S0660 01996000
         SLA   @14,2                                            02S0660 01997000
         SLR   @05,@05                                          02S0660 01998000
         IC    @05,OLDLN(@14)                                   02S0660 01999000
         N     @05,@CF00297                                     02S0660 02000000
         STC   @05,OLDLN(@14)                                   02S0660 02001000
*                               OLDLN(K+1)=OLDLN(K+1)|(MOD-1);/* NEW    02002000
*                                      DATA LENGTH                   */ 02003000
         LR    @03,MOD                                          02S0661 02004000
         BCTR  @03,0                                            02S0661 02005000
         OR    @05,@03                                          02S0661 02006000
         STC   @05,OLDLN(@14)                                   02S0661 02007000
*                               OLDFLG(K+2)=0;/* INDICATE END OF        02008000
*                                      PATTERNS                      */ 02009000
         SLR   @07,@07                                          02S0662 02010000
         STC   @07,OLDFLG+4(@14)                                02S0662 02011000
*                             END;                              02S0663 02012000
*                         END;                                  02S0664 02013000
*                     END;                                      02S0665 02014000
*                   ELSE                                        02S0666 02015000
*                     DO;           /* YES - FIELD IS IN ERROR       */ 02016000
         B     @RC00651                                         02S0666 02017000
@RF00651 DS    0H                                               02S0667 02018000
*                       OLDLN(1)=OLDLN(1)&DATAOFF;/* ZERO DATA LENGTH*/ 02019000
         SLR   @14,@14                                          02S0667 02020000
         IC    @14,OLDLN                                        02S0667 02021000
         N     @14,@CF00297                                     02S0667 02022000
         STC   @14,OLDLN                                        02S0667 02023000
*                       OLDLN(1)=OLDLN(1)|DATALN4;/* SET DATA LENGTH    02024000
*                                      TO FORMAT 4 BYTES             */ 02025000
         O     @14,@CF00170                                     02S0668 02026000
         STC   @14,OLDLN                                        02S0668 02027000
*                       OLDFLG(2)=0;/* INDICATE END OF PATTERNS      */ 02028000
         MVI   OLDFLG+4,X'00'                                   02S0669 02029000
*                       RCD29LN=4;  /* MODIFY LENGTH IN ORDER TO        02030000
*                                      ACCESS NEXT FIELD             */ 02031000
         L     @14,DATAPTR(,PLISTPTR)                           02S0670 02032000
         MVI   RCD29LN+46(@14),X'04'                            02S0670 02033000
*                     END;                                      02S0671 02034000
*                   ADPLFMT1=ADDR(GP4TYP9A);/* ADDR OF LABELS FOR       02035000
*                                      THIS LINE                     */ 02036000
@RC00651 L     @14,ABDPLPTR(,PLISTPTR)                          02S0672 02037000
         LA    @07,GP4TYP9A                                     02S0672 02038000
         ST    @07,ADPLFMT1(,@14)                               02S0672 02039000
*                   ADPLFMT2=ADDR(RCD29LN)+1;/* ADDR OF DATA IN 02S0673 02040000
*                                      BUFFER                        */ 02041000
         L     @07,DATAPTR(,PLISTPTR)                           02S0673 02042000
         LA    @07,RCD29LN+46(,@07)                             02S0673 02043000
         AH    @07,@CH00046                                     02S0673 02044000
         ST    @07,ADPLFMT2(,@14)                               02S0673 02045000
*                   R0=ADDR(DYNAMPTN);/* ADDR OF PATTERNS            */ 02046000
         LA    R0,DYNAMPTN                                      02S0674 02047000
*                   CALL AMDPRFMT;  /* FORMAT THE LINE               */ 02048000
         L     @15,FMTADDR(,PLISTPTR)                           02S0675 02049000
         BALR  @14,@15                                          02S0675 02050000
*                   RETCODE=0;      /* INDICATES TO PRINT BUFFER AND    02051000
*                                      RETURN FOR 4TH PASS   @YM03666*/ 02052000
         SLR   RETCODE,RETCODE                                  02S0676 02053000
*                 END;                                          02S0677 02054000
*               ELSE                                            02S0678 02055000
*                 DO;               /* YES - FORMAT THE FOURTH LINE  */ 02056000
         B     @RC00648                                         02S0678 02057000
@RF00648 DS    0H                                               02S0679 02058000
*                   DYNAMPTN(1:LENGTH(GP4S26C))=GP4S26C;/* MOVE 02S0679 02059000
*                                      PATTERNS TO GETMAIN AREA      */ 02060000
         MVC   DYNAMPTN(41),GP4S26C                             02S0679 02061000
*                   FIELDADR=ADDR(RCD29LN)+RCD29LN+1;/* ADDR OF 02S0680 02062000
*                                      VOLIST IN BUFFER              */ 02063000
         LA    @14,46                                           02S0680 02064000
         AL    @14,DATAPTR(,PLISTPTR)                           02S0680 02065000
         LA    @07,RCD29LN(,@14)                                02S0680 02066000
         SLR   @05,@05                                          02S0680 02067000
         IC    @05,RCD29LN(,@14)                                02S0680 02068000
         ALR   @07,@05                                          02S0680 02069000
         AH    @07,@CH00046                                     02S0680 02070000
         ST    @07,FIELDADR                                     02S0680 02071000
*                   IF NXTFIELD=ERROR THEN/* IS FIELD IN ERROR       */ 02072000
         CLI   NXTFIELD(@07),255                                02S0681 02073000
         BNE   @RF00681                                         02S0681 02074000
*                     DO;           /* YES - ONLY FORMAT 4 BYTES     */ 02075000
*                       OLDFLG(1)=OLDFLG(1)|CHARFLAG;/* INDICATE DATA   02076000
*                                      IN EBCDIC                     */ 02077000
         SLR   @14,@14                                          02S0683 02078000
         IC    @14,OLDFLG                                       02S0683 02079000
         O     @14,@CF00092                                     02S0683 02080000
         STC   @14,OLDFLG                                       02S0683 02081000
*                       OLDFLG(2)=0;/* INDICATE END OF PATTERNS      */ 02082000
         MVI   OLDFLG+4,X'00'                                   02S0684 02083000
*                     END;                                      02S0685 02084000
*                   ELSE                                        02S0686 02085000
*                     DO;           /* NO - DETERMINE HOW MANY BYTES    02086000
*                                      IN VOLIST                     */ 02087000
         B     @RC00681                                         02S0686 02088000
@RF00681 DS    0H                                               02S0687 02089000
*                       IF NXTFIELD<4 THEN/* IS VOLIST LESS THAN ONE    02090000
*                                      WORD                          */ 02091000
         L     @14,FIELDADR                                     02S0687 02092000
         CLI   NXTFIELD(@14),4                                  02S0687 02093000
         BNL   @RF00687                                         02S0687 02094000
*                         DO;       /* YES                           */ 02095000
*                           OLDLN(1)=OLDLN(1)&DATAOFF;/* SET DATA       02096000
*                                      LENGTH TO 0                   */ 02097000
         SLR   @07,@07                                          02S0689 02098000
         IC    @07,OLDLN                                        02S0689 02099000
         N     @07,@CF00297                                     02S0689 02100000
         STC   @07,OLDLN                                        02S0689 02101000
*                           OLDLN(1)=OLDLN(1)|(NXTFIELD-1);/* NEW       02102000
*                                      DATA LENGTH                   */ 02103000
         SLR   @05,@05                                          02S0690 02104000
         IC    @05,NXTFIELD(,@14)                               02S0690 02105000
         BCTR  @05,0                                            02S0690 02106000
         OR    @07,@05                                          02S0690 02107000
         STC   @07,OLDLN                                        02S0690 02108000
*                           OLDFLG(2)=0;/* INDICATE END OF PATTERNS  */ 02109000
         MVI   OLDFLG+4,X'00'                                   02S0691 02110000
*                         END;                                  02S0692 02111000
*                       ELSE                                    02S0693 02112000
*                         DO;       /* NO - MODIFY PATTERNS          */ 02113000
         B     @RC00687                                         02S0693 02114000
@RF00687 DS    0H                                               02S0694 02115000
*                           K=NXTFIELD/4;/* NUMBER OF FULL WORDS     */ 02116000
         L     @14,FIELDADR                                     02S0694 02117000
         SLR   @05,@05                                          02S0694 02118000
         IC    @05,NXTFIELD(,@14)                               02S0694 02119000
         LR    K,@05                                            02S0694 02120000
         SRL   K,2                                              02S0694 02121000
*                           MOD=NXTFIELD//4;/* REMAINDER OF PARTIAL     02122000
*                                      WORD                          */ 02123000
         LR    @02,@05                                          02S0695 02124000
         SRDA  @02,32                                           02S0695 02125000
         D     @02,@CF00099                                     02S0695 02126000
         LR    MOD,@02                                          02S0695 02127000
*                           IF MOD=0 THEN/* ARE ALL FULL WORDS       */ 02128000
         SLR   @14,@14                                          02S0696 02129000
         CR    MOD,@14                                          02S0696 02130000
         BNE   @RF00696                                         02S0696 02131000
*                             OLDFLG(K+1)=0;/* YES - INDICATE END OF    02132000
*                                      PATTERNS                      */ 02133000
         LR    @07,K                                            02S0697 02134000
         SLA   @07,2                                            02S0697 02135000
         STC   @14,OLDFLG(@07)                                  02S0697 02136000
*                           ELSE                                02S0698 02137000
*                             DO;   /* NO - MODIFY PATTERNS     02S0698 02138000
*                                      ACCORDINGLY                   */ 02139000
         B     @RC00696                                         02S0698 02140000
@RF00696 DS    0H                                               02S0699 02141000
*                               OLDLN(K+1)=OLDLN(K+1)&DATAOFF;/* SET    02142000
*                                      DATA LENGTH TO ZERO           */ 02143000
         LR    @14,K                                            02S0699 02144000
         SLA   @14,2                                            02S0699 02145000
         SLR   @05,@05                                          02S0699 02146000
         IC    @05,OLDLN(@14)                                   02S0699 02147000
         N     @05,@CF00297                                     02S0699 02148000
         STC   @05,OLDLN(@14)                                   02S0699 02149000
*                               OLDLN(K+1)=OLDLN(K+1)|(MOD-1);/* NEW    02150000
*                                      DATA LENGTH                   */ 02151000
         LR    @03,MOD                                          02S0700 02152000
         BCTR  @03,0                                            02S0700 02153000
         OR    @05,@03                                          02S0700 02154000
         STC   @05,OLDLN(@14)                                   02S0700 02155000
*                               OLDFLG(K+2)=0;/* INDICATE END OF        02156000
*                                      PATTERNS                      */ 02157000
         SLR   @07,@07                                          02S0701 02158000
         STC   @07,OLDFLG+4(@14)                                02S0701 02159000
*                             END;                              02S0702 02160000
*                         END;                                  02S0703 02161000
@RC00696 DS    0H                                               02S0704 02162000
*                     END;                                      02S0704 02163000
@RC00687 DS    0H                                               02S0705 02164000
*                   ADPLFMT1=ADDR(GP4TYP2);/* ADDR OF LABEL FOR THIS    02165000
*                                      LINE                          */ 02166000
@RC00681 L     @14,ABDPLPTR(,PLISTPTR)                          02S0705 02167000
         LA    @07,GP4TYP2                                      02S0705 02168000
         ST    @07,ADPLFMT1(,@14)                               02S0705 02169000
*                   ADPLFMT2=FIELDADR+1;/* ADDR OF DATA IN BUFFER    */ 02170000
         LA    @07,1                                            02S0706 02171000
         AL    @07,FIELDADR                                     02S0706 02172000
         ST    @07,ADPLFMT2(,@14)                               02S0706 02173000
*                   R0=ADDR(DYNAMPTN);/* ADDR OF PATTERNS            */ 02174000
         LA    R0,DYNAMPTN                                      02S0707 02175000
*                   CALL AMDPRFMT;  /* FORMAT THE LINE               */ 02176000
         L     @15,FMTADDR(,PLISTPTR)                           02S0708 02177000
         BALR  @14,@15                                          02S0708 02178000
*                   RETCODE=4;      /* INDICATES TO PRINT BUFFER AND    02179000
*                                      GET NEXT RECORD               */ 02180000
         LA    RETCODE,4                                        02S0709 02181000
*                 END;                                          02S0710 02182000
*             END;                                              02S0711 02183000
*         END;                                                  02S0712 02184000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 02185000
         B     CE0001@                                          02S0713 02186000
*     END S29;                      /* END OF SUBCASE                */ 02187000
*                                                               02S0715 02188000
*     /***************************************************************/ 02189000
*     /*                                                             */ 02190000
*     /* THIS ROUTINE WILL PROCESS SVC 30. THE FORMATTING CONSISTS OF*/ 02191000
*     /* THE BASIC RECORD + A 16 BYTE PLIST + VARIABLE LENGTH OLD AND*/ 02192000
*     /* NEW DSNAMES + A VARIABLE LENGTH VOLIST.                     */ 02193000
*     /*                                                             */ 02194000
*     /***************************************************************/ 02195000
*                                                               02S0715 02196000
*S30:                                                           02S0715 02197000
*     DO;                           /* SUBCASE                       */ 02198000
S30      DS    0H                                               02S0716 02199000
*       IF TIMESW=0 THEN            /* HAS SECOND LINE BEEN FORMATTED*/ 02200000
         SLR   @14,@14                                          02S0716 02201000
         CH    @14,TIMESW                                       02S0716 02202000
         BNE   @RF00716                                         02S0716 02203000
*         RETCODE=0;                /* NO - INDICATES TO PRINT BUFFER   02204000
*                                      AND RETURN FOR SECOND PASS    */ 02205000
         LR    RETCODE,@14                                      02S0717 02206000
*       ELSE                                                    02S0718 02207000
*         DO;                       /* YES - REGISTERS HAVE BEEN        02208000
*                                      FORMATTED                     */ 02209000
         B     @RC00716                                         02S0718 02210000
@RF00716 DS    0H                                               02S0719 02211000
*           IF TIMESW=1 THEN        /* HAS REMAINDER OF SECOND LINE     02212000
*                                      BEEN FORMATTED                */ 02213000
         CLC   TIMESW(2),@CH00046                               02S0719 02214000
         BNE   @RF00719                                         02S0719 02215000
*             DO;                   /* NO                            */ 02216000
*               DYNAMPTN(1:LENGTH(GP4S30A))=GP4S30A;/* MOVE PATTERNS    02217000
*                                      TO GETMAIN AREA               */ 02218000
         MVC   DYNAMPTN(17),GP4S30A                             02S0721 02219000
*               IF RCD30LST=ASTER16|RCD30LST=PEES16|RCD30LST=ESSES16    02220000
*                 THEN              /* IS FIELD IN ERROR             */ 02221000
         LA    @14,46                                           02S0722 02222000
         AL    @14,DATAPTR(,PLISTPTR)                           02S0722 02223000
         CLC   RCD30LST(16,@14),ASTER16                         02S0722 02224000
         BE    @RT00722                                         02S0722 02225000
         CLC   RCD30LST(16,@14),PEES16                          02S0722 02226000
         BE    @RT00722                                         02S0722 02227000
         CLC   RCD30LST(16,@14),ESSES16                         02S0722 02228000
         BNE   @RF00722                                         02S0722 02229000
@RT00722 DS    0H                                               02S0723 02230000
*                 DO;               /* YES                           */ 02231000
*                   OLDFLG(1)=OLDFLG(1)|CHARFLAG;/* INDICATE DATA IN    02232000
*                                      EBCDIC                        */ 02233000
         LA    @14,32                                           02S0724 02234000
         SLR   @07,@07                                          02S0724 02235000
         IC    @07,OLDFLG                                       02S0724 02236000
         OR    @07,@14                                          02S0724 02237000
         STC   @07,OLDFLG                                       02S0724 02238000
*                   OLDFLG(2)=OLDFLG(2)|CHARFLAG;               02S0725 02239000
         SLR   @07,@07                                          02S0725 02240000
         IC    @07,OLDFLG+4                                     02S0725 02241000
         OR    @07,@14                                          02S0725 02242000
         STC   @07,OLDFLG+4                                     02S0725 02243000
*                   OLDFLG(3)=OLDFLG(3)|CHARFLAG;               02S0726 02244000
         SLR   @07,@07                                          02S0726 02245000
         IC    @07,OLDFLG+8                                     02S0726 02246000
         OR    @07,@14                                          02S0726 02247000
         STC   @07,OLDFLG+8                                     02S0726 02248000
*                   OLDFLG(4)=OLDFLG(4)|CHARFLAG;               02S0727 02249000
         SLR   @07,@07                                          02S0727 02250000
         IC    @07,OLDFLG+12                                    02S0727 02251000
         OR    @14,@07                                          02S0727 02252000
         STC   @14,OLDFLG+12                                    02S0727 02253000
*                 END;                                          02S0728 02254000
*               ADPLFMT1=ADDR(GROUP2);/* ADDR OF LABELS FOR THIS LINE*/ 02255000
@RF00722 L     @14,ABDPLPTR(,PLISTPTR)                          02S0729 02256000
         LA    @07,GROUP2                                       02S0729 02257000
         ST    @07,ADPLFMT1(,@14)                               02S0729 02258000
*               ADPLFMT2=ADDR(RCD30LST);/* ADDR OF DATA IN BUFFER    */ 02259000
         LA    @07,46                                           02S0730 02260000
         AL    @07,DATAPTR(,PLISTPTR)                           02S0730 02261000
         ST    @07,ADPLFMT2(,@14)                               02S0730 02262000
*               R0=ADDR(DYNAMPTN);  /* ADDR OF PATTERNS              */ 02263000
         LA    R0,DYNAMPTN                                      02S0731 02264000
*               CALL AMDPRFMT;      /* FORMAT THE LINE               */ 02265000
         L     @15,FMTADDR(,PLISTPTR)                           02S0732 02266000
         BALR  @14,@15                                          02S0732 02267000
*               RETCODE=0;          /* INDICATES TO PRINT BUFFER AND    02268000
*                                      RETURN FOR THIRD PASS         */ 02269000
         SLR   RETCODE,RETCODE                                  02S0733 02270000
*             END;                                              02S0734 02271000
*           ELSE                                                02S0735 02272000
*             DO;                   /* YES                           */ 02273000
         B     @RC00719                                         02S0735 02274000
@RF00719 DS    0H                                               02S0736 02275000
*               IF TIMESW=2 THEN    /* HAS THIRD LINE BEEN FORMATTED */ 02276000
         CLC   TIMESW(2),@CH00078                               02S0736 02277000
         BNE   @RF00736                                         02S0736 02278000
*                 DO;               /* NO                            */ 02279000
*                   DYNAMPTN(1:LENGTH(GP4S30B))=GP4S30B;/* MOVE 02S0738 02280000
*                                      PATTERNS TO GETMAIN AREA      */ 02281000
         MVC   DYNAMPTN(13),GP4S30B                             02S0738 02282000
*                   IF RCD30LN^=ERROR THEN/* IS FIELD IN ERROR       */ 02283000
         LA    @14,46                                           02S0739 02284000
         AL    @14,DATAPTR(,PLISTPTR)                           02S0739 02285000
         CLI   RCD30LN(@14),255                                 02S0739 02286000
         BE    @RF00739                                         02S0739 02287000
*                     DO;           /* NO                            */ 02288000
*                       IF RCD30LN^=44 THEN/* IS DSN MAX LENGTH      */ 02289000
         CLI   RCD30LN(@14),44                                  02S0741 02290000
         BE    @RF00741                                         02S0741 02291000
*                         DO;       /* NO                            */ 02292000
*                           K=RCD30LN/16;/* NUMBER OF FULL WORDS     */ 02293000
         SLR   @05,@05                                          02S0743 02294000
         IC    @05,RCD30LN(,@14)                                02S0743 02295000
         LR    K,@05                                            02S0743 02296000
         SRL   K,4                                              02S0743 02297000
*                           MOD=RCD30LN//16;/* REMAINDER OF PARTIAL     02298000
*                                      WORD                          */ 02299000
         LR    @02,@05                                          02S0744 02300000
         SRDA  @02,32                                           02S0744 02301000
         D     @02,@CF00139                                     02S0744 02302000
         LR    MOD,@02                                          02S0744 02303000
*                           IF MOD=0 THEN/* ARE ALL FULL WORDS       */ 02304000
         SLR   @14,@14                                          02S0745 02305000
         CR    MOD,@14                                          02S0745 02306000
         BNE   @RF00745                                         02S0745 02307000
*                             OLDFLG(K+1)=0;/* YES - INDICATE END OF    02308000
*                                      PATTERNS                      */ 02309000
         LR    @07,K                                            02S0746 02310000
         SLA   @07,2                                            02S0746 02311000
         STC   @14,OLDFLG(@07)                                  02S0746 02312000
*                           ELSE                                02S0747 02313000
*                             DO;   /* NO - MODIFY PATTERNS     02S0747 02314000
*                                      ACCORDINGLY                   */ 02315000
         B     @RC00745                                         02S0747 02316000
@RF00745 DS    0H                                               02S0748 02317000
*                               OLDLN(K+1)=OLDLN(K+1)&DATAOFF;/* SET    02318000
*                                      DATA LENGTH TO ZERO           */ 02319000
         LR    @14,K                                            02S0748 02320000
         SLA   @14,2                                            02S0748 02321000
         SLR   @05,@05                                          02S0748 02322000
         IC    @05,OLDLN(@14)                                   02S0748 02323000
         N     @05,@CF00297                                     02S0748 02324000
         STC   @05,OLDLN(@14)                                   02S0748 02325000
*                               OLDLN(K+1)=OLDLN(K+1)|(MOD-1);/* NEW    02326000
*                                      DATA LENGTH                   */ 02327000
         LR    @03,MOD                                          02S0749 02328000
         BCTR  @03,0                                            02S0749 02329000
         OR    @05,@03                                          02S0749 02330000
         STC   @05,OLDLN(@14)                                   02S0749 02331000
*                               OLDFLG(K+2)=0;/* INDICATE END OF        02332000
*                                      PATTERNS                      */ 02333000
         SLR   @07,@07                                          02S0750 02334000
         STC   @07,OLDFLG+4(@14)                                02S0750 02335000
*                             END;                              02S0751 02336000
*                         END;                                  02S0752 02337000
*                     END;                                      02S0753 02338000
*                   ELSE                                        02S0754 02339000
*                     DO;           /* YES - FIELD IS IN ERROR       */ 02340000
         B     @RC00739                                         02S0754 02341000
@RF00739 DS    0H                                               02S0755 02342000
*                       OLDLN(1)=OLDLN(1)&DATAOFF;/* ZERO DATA LENGTH*/ 02343000
         SLR   @14,@14                                          02S0755 02344000
         IC    @14,OLDLN                                        02S0755 02345000
         N     @14,@CF00297                                     02S0755 02346000
         STC   @14,OLDLN                                        02S0755 02347000
*                       OLDLN(1)=OLDLN(1)|DATALN4;/* SET DATA LENGTH    02348000
*                                      TO FORMAT 4 BYTES             */ 02349000
         O     @14,@CF00170                                     02S0756 02350000
         STC   @14,OLDLN                                        02S0756 02351000
*                       OLDFLG(2)=0;/* INDICATE END OF PATTERNS      */ 02352000
         MVI   OLDFLG+4,X'00'                                   02S0757 02353000
*                       RCD30LN=4;  /* MODIFY LENGTH IN ORDER TO        02354000
*                                      ACCESS NEXT FIELD             */ 02355000
         L     @14,DATAPTR(,PLISTPTR)                           02S0758 02356000
         MVI   RCD30LN+46(@14),X'04'                            02S0758 02357000
*                     END;                                      02S0759 02358000
*                   ADPLFMT1=ADDR(GP4TYP12);/* ADDR OF LABELS FOR       02359000
*                                      THIS LINE                     */ 02360000
@RC00739 L     @14,ABDPLPTR(,PLISTPTR)                          02S0760 02361000
         LA    @07,GP4TYP12                                     02S0760 02362000
         ST    @07,ADPLFMT1(,@14)                               02S0760 02363000
*                   ADPLFMT2=ADDR(RCD30LN)+1;/* ADDR OF DATA IN 02S0761 02364000
*                                      BUFFER                        */ 02365000
         L     @07,DATAPTR(,PLISTPTR)                           02S0761 02366000
         LA    @07,RCD30LN+46(,@07)                             02S0761 02367000
         AH    @07,@CH00046                                     02S0761 02368000
         ST    @07,ADPLFMT2(,@14)                               02S0761 02369000
*                   R0=ADDR(DYNAMPTN);/* ADDR OF PATTERNS            */ 02370000
         LA    R0,DYNAMPTN                                      02S0762 02371000
*                   CALL AMDPRFMT;  /* FORMAT THE OLD DSN            */ 02372000
         L     @15,FMTADDR(,PLISTPTR)                           02S0763 02373000
         BALR  @14,@15                                          02S0763 02374000
*                   DYNAMPTN(1:LENGTH(GP4S30C))=GP4S30C;/* MOVE 02S0764 02375000
*                                      PATTERNS TO GETMAIN AREA      */ 02376000
         MVC   DYNAMPTN(13),GP4S30C                             02S0764 02377000
*                   FIELDADR=ADDR(RCD30LN)+RCD30LN+1;/* ADDRESS OF      02378000
*                                      NEW DSN FIELD IN BUFFER       */ 02379000
         LA    @14,46                                           02S0765 02380000
         AL    @14,DATAPTR(,PLISTPTR)                           02S0765 02381000
         LA    @07,RCD30LN(,@14)                                02S0765 02382000
         SLR   @05,@05                                          02S0765 02383000
         IC    @05,RCD30LN(,@14)                                02S0765 02384000
         ALR   @07,@05                                          02S0765 02385000
         AH    @07,@CH00046                                     02S0765 02386000
         ST    @07,FIELDADR                                     02S0765 02387000
*                   IF NXTFIELD^=ERROR THEN/* IS FIELD IN ERROR      */ 02388000
         CLI   NXTFIELD(@07),255                                02S0766 02389000
         BE    @RF00766                                         02S0766 02390000
*                     DO;           /* NO                            */ 02391000
*                       IF NXTFIELD^=44 THEN/* IS DSN MAX LENGTH     */ 02392000
         CLI   NXTFIELD(@07),44                                 02S0768 02393000
         BE    @RF00768                                         02S0768 02394000
*                         DO;       /* NO                            */ 02395000
*                           K=NXTFIELD/16;/* NUMBER OF FULL WORDS    */ 02396000
         L     @14,FIELDADR                                     02S0770 02397000
         SLR   @05,@05                                          02S0770 02398000
         IC    @05,NXTFIELD(,@14)                               02S0770 02399000
         LR    K,@05                                            02S0770 02400000
         SRL   K,4                                              02S0770 02401000
*                           MOD=NXTFIELD//16;/* REMAINDER OF PARTIAL    02402000
*                                      WORD                          */ 02403000
         LR    @02,@05                                          02S0771 02404000
         SRDA  @02,32                                           02S0771 02405000
         D     @02,@CF00139                                     02S0771 02406000
         LR    MOD,@02                                          02S0771 02407000
*                           IF MOD=0 THEN/* ARE ALL FULL WORDS       */ 02408000
         SLR   @14,@14                                          02S0772 02409000
         CR    MOD,@14                                          02S0772 02410000
         BNE   @RF00772                                         02S0772 02411000
*                             OLDFLG(K+1)=0;/* YES - INDICATE END OF    02412000
*                                      PATTERNS                      */ 02413000
         LR    @07,K                                            02S0773 02414000
         SLA   @07,2                                            02S0773 02415000
         STC   @14,OLDFLG(@07)                                  02S0773 02416000
*                           ELSE                                02S0774 02417000
*                             DO;   /* NO - MODIFY PATTERNS     02S0774 02418000
*                                      ACCORDINGLY                   */ 02419000
         B     @RC00772                                         02S0774 02420000
@RF00772 DS    0H                                               02S0775 02421000
*                               OLDLN(K+1)=OLDLN(K+1)&DATAOFF;/* SET    02422000
*                                      DATA LENGTH TO ZERO           */ 02423000
         LR    @14,K                                            02S0775 02424000
         SLA   @14,2                                            02S0775 02425000
         SLR   @05,@05                                          02S0775 02426000
         IC    @05,OLDLN(@14)                                   02S0775 02427000
         N     @05,@CF00297                                     02S0775 02428000
         STC   @05,OLDLN(@14)                                   02S0775 02429000
*                               OLDLN(K+1)=OLDLN(K+1)|(MOD-1);/* NEW    02430000
*                                      DATA LENGTH                   */ 02431000
         LR    @03,MOD                                          02S0776 02432000
         BCTR  @03,0                                            02S0776 02433000
         OR    @05,@03                                          02S0776 02434000
         STC   @05,OLDLN(@14)                                   02S0776 02435000
*                               OLDFLG(K+2)=0;/* INDICATE END OF        02436000
*                                      PATTERNS                      */ 02437000
         SLR   @07,@07                                          02S0777 02438000
         STC   @07,OLDFLG+4(@14)                                02S0777 02439000
*                             END;                              02S0778 02440000
*                         END;                                  02S0779 02441000
*                     END;                                      02S0780 02442000
*                   ELSE                                        02S0781 02443000
*                     DO;           /* YES - FIELD IS IN ERROR       */ 02444000
         B     @RC00766                                         02S0781 02445000
@RF00766 DS    0H                                               02S0782 02446000
*                       OLDLN(1)=OLDLN(1)&DATAOFF;/* ZERO DATA LENGTH*/ 02447000
         SLR   @14,@14                                          02S0782 02448000
         IC    @14,OLDLN                                        02S0782 02449000
         N     @14,@CF00297                                     02S0782 02450000
         STC   @14,OLDLN                                        02S0782 02451000
*                       OLDLN(1)=OLDLN(1)|DATALN4;/* SET DATA LENGTH    02452000
*                                      TO FORMAT 4 BYTES             */ 02453000
         O     @14,@CF00170                                     02S0783 02454000
         STC   @14,OLDLN                                        02S0783 02455000
*                       OLDFLG(2)=0;/* INDICATE END OF PATTERNS      */ 02456000
         MVI   OLDFLG+4,X'00'                                   02S0784 02457000
*                       NXTFIELD=4; /* MODIFY LENGTH IN ORDER TO        02458000
*                                      ACCESS NEXT FIELD             */ 02459000
         L     @14,FIELDADR                                     02S0785 02460000
         MVI   NXTFIELD(@14),X'04'                              02S0785 02461000
*                     END;                                      02S0786 02462000
*                   ADPLFMT1=ADDR(GP4TP12A);/* ADDR OF LABELS FOR       02463000
*                                      THIS LINE                     */ 02464000
@RC00766 L     @14,ABDPLPTR(,PLISTPTR)                          02S0787 02465000
         LA    @07,GP4TP12A                                     02S0787 02466000
         ST    @07,ADPLFMT1(,@14)                               02S0787 02467000
*                   ADPLFMT2=FIELDADR+1;/* ADDR OF DATA IN BUFFER    */ 02468000
         LA    @07,1                                            02S0788 02469000
         AL    @07,FIELDADR                                     02S0788 02470000
         ST    @07,ADPLFMT2(,@14)                               02S0788 02471000
*                   R0=ADDR(DYNAMPTN);/* ADDR OF PATTERNS            */ 02472000
         LA    R0,DYNAMPTN                                      02S0789 02473000
*                   CALL AMDPRFMT;  /* FORMAT THE LINE               */ 02474000
         L     @15,FMTADDR(,PLISTPTR)                           02S0790 02475000
         BALR  @14,@15                                          02S0790 02476000
*                   RETCODE=0;      /* INDICATES TO PRINT BUFFER AND    02477000
*                                      RETURN FOR FOURTH PASS        */ 02478000
         SLR   RETCODE,RETCODE                                  02S0791 02479000
*                 END;                                          02S0792 02480000
*               ELSE                                            02S0793 02481000
*                 DO;               /* YES - FORMAT THE FOURTH LINE  */ 02482000
         B     @RC00736                                         02S0793 02483000
@RF00736 DS    0H                                               02S0794 02484000
*                   DYNAMPTN(1:LENGTH(GP4S26C))=GP4S26C;/* MOVE 02S0794 02485000
*                                      PATTERNS TO GETMAIN AREA      */ 02486000
         MVC   DYNAMPTN(41),GP4S26C                             02S0794 02487000
*                   FIELDADR=FIELDADR+NXTFIELD+1;/* ADDR OF VOLIST IN   02488000
*                                      BUFFER                        */ 02489000
         L     @14,FIELDADR                                     02S0795 02490000
         SLR   @07,@07                                          02S0795 02491000
         IC    @07,NXTFIELD(,@14)                               02S0795 02492000
         ALR   @07,@14                                          02S0795 02493000
         AH    @07,@CH00046                                     02S0795 02494000
         ST    @07,FIELDADR                                     02S0795 02495000
*                   IF NXTFIELD=ERROR THEN/* IS FIELD IN ERROR       */ 02496000
         CLI   NXTFIELD(@07),255                                02S0796 02497000
         BNE   @RF00796                                         02S0796 02498000
*                     DO;           /* YES - ONLY FORMAT 4 BYTES     */ 02499000
*                       OLDFLG(1)=OLDFLG(1)|CHARFLAG;/* INDICATE DATA   02500000
*                                      IN EBCDIC                     */ 02501000
         SLR   @14,@14                                          02S0798 02502000
         IC    @14,OLDFLG                                       02S0798 02503000
         O     @14,@CF00092                                     02S0798 02504000
         STC   @14,OLDFLG                                       02S0798 02505000
*                       OLDFLG(2)=0;/* INDICATE END OF PATTERNS      */ 02506000
         MVI   OLDFLG+4,X'00'                                   02S0799 02507000
*                     END;                                      02S0800 02508000
*                   ELSE                                        02S0801 02509000
*                     DO;           /* NO - DETERMINE HOW MANY BYTES    02510000
*                                      IN VOLIST                     */ 02511000
         B     @RC00796                                         02S0801 02512000
@RF00796 DS    0H                                               02S0802 02513000
*                       IF NXTFIELD<4 THEN/* IS VOLIST LESS THAN ONE    02514000
*                                      WORD                          */ 02515000
         L     @14,FIELDADR                                     02S0802 02516000
         CLI   NXTFIELD(@14),4                                  02S0802 02517000
         BNL   @RF00802                                         02S0802 02518000
*                         DO;       /* YES                           */ 02519000
*                           OLDLN(1)=OLDLN(1)&DATAOFF;/* SET DATA       02520000
*                                      LENGTH TO 0                   */ 02521000
         SLR   @07,@07                                          02S0804 02522000
         IC    @07,OLDLN                                        02S0804 02523000
         N     @07,@CF00297                                     02S0804 02524000
         STC   @07,OLDLN                                        02S0804 02525000
*                           OLDLN(1)=OLDLN(1)|(NXTFIELD-1);/* NEW       02526000
*                                      DATA LENGTH                   */ 02527000
         SLR   @05,@05                                          02S0805 02528000
         IC    @05,NXTFIELD(,@14)                               02S0805 02529000
         BCTR  @05,0                                            02S0805 02530000
         OR    @07,@05                                          02S0805 02531000
         STC   @07,OLDLN                                        02S0805 02532000
*                           OLDFLG(2)=0;/* INDICATE END OF PATTERNS  */ 02533000
         MVI   OLDFLG+4,X'00'                                   02S0806 02534000
*                         END;                                  02S0807 02535000
*                       ELSE                                    02S0808 02536000
*                         DO;       /* NO - MODIFY PATTERNS          */ 02537000
         B     @RC00802                                         02S0808 02538000
@RF00802 DS    0H                                               02S0809 02539000
*                           K=NXTFIELD/4;/* NUMBER OF FULL WORDS     */ 02540000
         L     @14,FIELDADR                                     02S0809 02541000
         SLR   @05,@05                                          02S0809 02542000
         IC    @05,NXTFIELD(,@14)                               02S0809 02543000
         LR    K,@05                                            02S0809 02544000
         SRL   K,2                                              02S0809 02545000
*                           MOD=NXTFIELD//4;/* REMAINDER OF PARTIAL     02546000
*                                      WORD                          */ 02547000
         LR    @02,@05                                          02S0810 02548000
         SRDA  @02,32                                           02S0810 02549000
         D     @02,@CF00099                                     02S0810 02550000
         LR    MOD,@02                                          02S0810 02551000
*                           IF MOD=0 THEN/* ARE ALL FULL WORDS       */ 02552000
         SLR   @14,@14                                          02S0811 02553000
         CR    MOD,@14                                          02S0811 02554000
         BNE   @RF00811                                         02S0811 02555000
*                             OLDFLG(K+1)=0;/* YES - INDICATE END OF    02556000
*                                      PATTERNS                      */ 02557000
         LR    @07,K                                            02S0812 02558000
         SLA   @07,2                                            02S0812 02559000
         STC   @14,OLDFLG(@07)                                  02S0812 02560000
*                           ELSE                                02S0813 02561000
*                             DO;   /* NO - MODIFY PATTERNS     02S0813 02562000
*                                      ACCORDINGLY                   */ 02563000
         B     @RC00811                                         02S0813 02564000
@RF00811 DS    0H                                               02S0814 02565000
*                               OLDLN(K+1)=OLDLN(K+1)&DATAOFF;/* SET    02566000
*                                      DATA LENGTH TO ZERO           */ 02567000
         LR    @14,K                                            02S0814 02568000
         SLA   @14,2                                            02S0814 02569000
         SLR   @05,@05                                          02S0814 02570000
         IC    @05,OLDLN(@14)                                   02S0814 02571000
         N     @05,@CF00297                                     02S0814 02572000
         STC   @05,OLDLN(@14)                                   02S0814 02573000
*                               OLDLN(K+1)=OLDLN(K+1)|(MOD-1);/* NEW    02574000
*                                      DATA LENGTH                   */ 02575000
         LR    @03,MOD                                          02S0815 02576000
         BCTR  @03,0                                            02S0815 02577000
         OR    @05,@03                                          02S0815 02578000
         STC   @05,OLDLN(@14)                                   02S0815 02579000
*                               OLDFLG(K+2)=0;/* INDICATE END OF        02580000
*                                      PATTERNS                      */ 02581000
         SLR   @07,@07                                          02S0816 02582000
         STC   @07,OLDFLG+4(@14)                                02S0816 02583000
*                             END;                              02S0817 02584000
*                         END;                                  02S0818 02585000
@RC00811 DS    0H                                               02S0819 02586000
*                     END;                                      02S0819 02587000
@RC00802 DS    0H                                               02S0820 02588000
*                   ADPLFMT1=ADDR(GP4TYP2);/* ADDR OF LABEL FOR THIS    02589000
*                                      LINE                          */ 02590000
@RC00796 L     @14,ABDPLPTR(,PLISTPTR)                          02S0820 02591000
         LA    @07,GP4TYP2                                      02S0820 02592000
         ST    @07,ADPLFMT1(,@14)                               02S0820 02593000
*                   ADPLFMT2=FIELDADR+1;/* ADDR OF DATA IN BUFFER    */ 02594000
         LA    @07,1                                            02S0821 02595000
         AL    @07,FIELDADR                                     02S0821 02596000
         ST    @07,ADPLFMT2(,@14)                               02S0821 02597000
*                   R0=ADDR(DYNAMPTN);/* ADDR OF PATTERNS            */ 02598000
         LA    R0,DYNAMPTN                                      02S0822 02599000
*                   CALL AMDPRFMT;  /* FORMAT THE LINE               */ 02600000
         L     @15,FMTADDR(,PLISTPTR)                           02S0823 02601000
         BALR  @14,@15                                          02S0823 02602000
*                   RETCODE=4;      /* INDICATES TO PRINT BUFFER AND    02603000
*                                      GET NEXT RECORD               */ 02604000
         LA    RETCODE,4                                        02S0824 02605000
*                 END;                                          02S0825 02606000
*             END;                                              02S0826 02607000
*         END;                                                  02S0827 02608000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 02609000
         B     CE0001@                                          02S0828 02610000
*     END S30;                      /* END OF SUBCASE                */ 02611000
*                                                               02S0830 02612000
*     /***************************************************************/ 02613000
*     /*                                                             */ 02614000
*     /* THIS ROUTINE WILL PROCESS THE FOLLOWING SVCS: 32,33,78. THE */ 02615000
*     /* FORMATTING CONSISTS OF THE BASIC RECORD + A CUU + A VARIABLE*/ 02616000
*     /* LENGTH DSNAME/A CUU ALONE.                                  */ 02617000
*     /*                                                             */ 02618000
*     /***************************************************************/ 02619000
*                                                               02S0830 02620000
*S32:                                                           02S0830 02621000
*     DO;                           /* SUBCASE                       */ 02622000
S32      DS    0H                                               02S0831 02623000
*       IF TIMESW=0 THEN            /* HAS SECOND LINE BEEN FORMATTED*/ 02624000
         SLR   @14,@14                                          02S0831 02625000
         CH    @14,TIMESW                                       02S0831 02626000
         BNE   @RF00831                                         02S0831 02627000
*         RETCODE=0;                /* NO - INDICATES TO PRINT BUFFER   02628000
*                                      AND RETURN FOR SECOND PASS    */ 02629000
         LR    RETCODE,@14                                      02S0832 02630000
*       ELSE                                                    02S0833 02631000
*         DO;                       /* YES - CHECK FIELDS FOR ERRORS    02632000
*                                      & FORMAT THEM                 */ 02633000
         B     @RC00831                                         02S0833 02634000
@RF00831 DS    0H                                               02S0834 02635000
*           DYNAMPTN(1:LENGTH(GP4S32))=GP4S32;/* MOVE PATTERNS TO       02636000
*                                      GETMAINED AREA                */ 02637000
         MVC   DYNAMPTN(21),GP4S32                              02S0834 02638000
*           IF RCD32CUU=ASTER2|RCD32CUU=PEES2|RCD32CUU=ESSES2 THEN/*    02639000
*                                      IS FIELD IN ERROR             */ 02640000
         LA    @14,46                                           02S0835 02641000
         AL    @14,DATAPTR(,PLISTPTR)                           02S0835 02642000
         CLC   RCD32CUU(2,@14),ASTER2                           02S0835 02643000
         BE    @RT00835                                         02S0835 02644000
         CLC   RCD32CUU(2,@14),PEES2                            02S0835 02645000
         BE    @RT00835                                         02S0835 02646000
         CLC   RCD32CUU(2,@14),ESSES2                           02S0835 02647000
         BNE   @RF00835                                         02S0835 02648000
@RT00835 DS    0H                                               02S0836 02649000
*             OLDFLG(1)=OLDFLG(1)|CHARFLAG;/* INDICATE DATA IN EBCDIC*/ 02650000
         SLR   @14,@14                                          02S0836 02651000
         IC    @14,OLDFLG                                       02S0836 02652000
         O     @14,@CF00092                                     02S0836 02653000
         STC   @14,OLDFLG                                       02S0836 02654000
*           IF SVCNUMBR^=33 THEN    /* IS THIS SVC 33 OR 78          */ 02655000
@RF00835 CH    SVCNUMBR,@CH00514                                02S0837 02656000
         BE    @RF00837                                         02S0837 02657000
*             OLDFLG(2)=0;          /* YES - INDICATE END OF PATTERNS*/ 02658000
         MVI   OLDFLG+4,X'00'                                   02S0838 02659000
*           ELSE                                                02S0839 02660000
*             DO;                   /* NO - ITS SVC 32 - FORMAT THE     02661000
*                                      DDNAME ALSO                   */ 02662000
         B     @RC00837                                         02S0839 02663000
@RF00837 DS    0H                                               02S0840 02664000
*               IF RCD32LN^=ERROR THEN/* IS FIELD IN ERROR           */ 02665000
         LA    @14,46                                           02S0840 02666000
         AL    @14,DATAPTR(,PLISTPTR)                           02S0840 02667000
         CLI   RCD32LN(@14),255                                 02S0840 02668000
         BE    @RF00840                                         02S0840 02669000
*                 DO;               /* NO                            */ 02670000
*                   IF RCD32LN^=44 THEN/* IS DSN MAX LENGTH          */ 02671000
         CLI   RCD32LN(@14),44                                  02S0842 02672000
         BE    @RF00842                                         02S0842 02673000
*                     DO;           /* NO                            */ 02674000
*                       K=RCD32LN/16;/* NUMBER OF FULL WORDS         */ 02675000
         SLR   @05,@05                                          02S0844 02676000
         IC    @05,RCD32LN(,@14)                                02S0844 02677000
         LR    K,@05                                            02S0844 02678000
         SRL   K,4                                              02S0844 02679000
*                       MOD=RCD32LN//16;/* REMAINDER OF PARTIAL WORD */ 02680000
         LR    @02,@05                                          02S0845 02681000
         SRDA  @02,32                                           02S0845 02682000
         D     @02,@CF00139                                     02S0845 02683000
         LR    MOD,@02                                          02S0845 02684000
*                       IF MOD=0 THEN/* ARE ALL FULL WORDS           */ 02685000
         SLR   @14,@14                                          02S0846 02686000
         CR    MOD,@14                                          02S0846 02687000
         BNE   @RF00846                                         02S0846 02688000
*                         OLDFLG(K+3)=0;/* YES - INDICATE END OF        02689000
*                                      PATTERNS                      */ 02690000
         LR    @07,K                                            02S0847 02691000
         SLA   @07,2                                            02S0847 02692000
         STC   @14,OLDFLG+8(@07)                                02S0847 02693000
*                       ELSE                                    02S0848 02694000
*                         DO;       /* NO - MODIFY PATTERNS     02S0848 02695000
*                                      ACCORDINGLY                   */ 02696000
         B     @RC00846                                         02S0848 02697000
@RF00846 DS    0H                                               02S0849 02698000
*                           OLDLN(K+3)=OLDLN(K+3)&DATAOFF;/* SET DATA   02699000
*                                      LENGTH TO ZERO                */ 02700000
         LR    @14,K                                            02S0849 02701000
         SLA   @14,2                                            02S0849 02702000
         SLR   @05,@05                                          02S0849 02703000
         IC    @05,OLDLN+8(@14)                                 02S0849 02704000
         N     @05,@CF00297                                     02S0849 02705000
         STC   @05,OLDLN+8(@14)                                 02S0849 02706000
*                           OLDLN(K+3)=OLDLN(K+3)|(MOD-1);/* NEW DATA   02707000
*                                      LENGTH                        */ 02708000
         LR    @03,MOD                                          02S0850 02709000
         BCTR  @03,0                                            02S0850 02710000
         OR    @05,@03                                          02S0850 02711000
         STC   @05,OLDLN+8(@14)                                 02S0850 02712000
*                           OLDFLG(K+4)=0;/* INDICATE END OF PATTERNS*/ 02713000
         SLR   @07,@07                                          02S0851 02714000
         STC   @07,OLDFLG+12(@14)                               02S0851 02715000
*                         END;                                  02S0852 02716000
*                     END;                                      02S0853 02717000
*                 END;                                          02S0854 02718000
*               ELSE                                            02S0855 02719000
*                 DO;               /* YES - FIELD IS IN ERROR       */ 02720000
         B     @RC00840                                         02S0855 02721000
@RF00840 DS    0H                                               02S0856 02722000
*                   OLDLN(3)=OLDLN(3)&DATAOFF;/* ZERO DATA LENGTH    */ 02723000
         SLR   @14,@14                                          02S0856 02724000
         IC    @14,OLDLN+8                                      02S0856 02725000
         N     @14,@CF00297                                     02S0856 02726000
         STC   @14,OLDLN+8                                      02S0856 02727000
*                   OLDLN(3)=OLDLN(3)|DATALN4;/* SET DATA LENGTH TO     02728000
*                                      FORMAT 4 BYTES                */ 02729000
         O     @14,@CF00170                                     02S0857 02730000
         STC   @14,OLDLN+8                                      02S0857 02731000
*                   OLDFLG(4)=0;    /* INDICATE END OF PATTERNS      */ 02732000
         MVI   OLDFLG+12,X'00'                                  02S0858 02733000
*                 END;                                          02S0859 02734000
*             END;                                              02S0860 02735000
@RC00840 DS    0H                                               02S0861 02736000
*           ADPLFMT1=ADDR(GP4TYP13);/* ADDR OF LABELS FOR THIS LINE  */ 02737000
@RC00837 L     @14,ABDPLPTR(,PLISTPTR)                          02S0861 02738000
         LA    @07,GP4TYP13                                     02S0861 02739000
         ST    @07,ADPLFMT1(,@14)                               02S0861 02740000
*           ADPLFMT2=ADDR(RCD32CUU);/* ADDR OF DATA IN BUFFER        */ 02741000
         LA    @07,46                                           02S0862 02742000
         AL    @07,DATAPTR(,PLISTPTR)                           02S0862 02743000
         ST    @07,ADPLFMT2(,@14)                               02S0862 02744000
*           R0=ADDR(DYNAMPTN);      /* ADDR OF PATTERNS              */ 02745000
         LA    R0,DYNAMPTN                                      02S0863 02746000
*           CALL AMDPRFMT;          /* FORMAT THE LINE               */ 02747000
         L     @15,FMTADDR(,PLISTPTR)                           02S0864 02748000
         BALR  @14,@15                                          02S0864 02749000
*           RETCODE=4;              /* INDICATES TO PRINT BUFFER AND    02750000
*                                      GET NEXT RECORD               */ 02751000
         LA    RETCODE,4                                        02S0865 02752000
*         END;                                                  02S0866 02753000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 02754000
         B     CE0001@                                          02S0867 02755000
*     END S32;                      /* END OF SUBCASE                */ 02756000
*                                                               02S0869 02757000
*     /***************************************************************/ 02758000
*     /*                                                             */ 02759000
*     /* THIS ROUTINE WILL PROCESS SVC 42. THE FORMATTING CONSISTS OF*/ 02760000
*     /* THE BASIC RECORD + A VARIABLE LENGTH SUPREVISOR LIST + A    */ 02761000
*     /* VARIABLE LENGTH PROBLEM PROGRAM LIST.                       */ 02762000
*     /*                                                             */ 02763000
*     /***************************************************************/ 02764000
*                                                               02S0869 02765000
*S42:                                                           02S0869 02766000
*     DO;                           /* SUBCASE                       */ 02767000
S42      DS    0H                                               02S0870 02768000
*       IF TIMESW=0|TIMESW=1 THEN   /* HAS BASIC RECORD BEEN    02S0870 02769000
*                                      FORMATTED                     */ 02770000
         LH    @14,TIMESW                                       02S0870 02771000
         LTR   @14,@14                                          02S0870 02772000
         BZ    @RT00870                                         02S0870 02773000
         CH    @14,@CH00046                                     02S0870 02774000
         BNE   @RF00870                                         02S0870 02775000
@RT00870 DS    0H                                               02S0871 02776000
*         RETCODE=0;                /* NO - INDICATES TO PRINT BUFFER   02777000
*                                      AND RETURN FOR THIRD PASS     */ 02778000
         SLR   RETCODE,RETCODE                                  02S0871 02779000
*       ELSE                                                    02S0872 02780000
*         DO;                       /* YES                           */ 02781000
         B     @RC00870                                         02S0872 02782000
@RF00870 DS    0H                                               02S0873 02783000
*           IF TIMESW=2 THEN        /* HAS THIRD LINE BEEN FORMATTED */ 02784000
         CLC   TIMESW(2),@CH00078                               02S0873 02785000
         BNE   @RF00873                                         02S0873 02786000
*             DO;                   /* NO                            */ 02787000
*               DYNAMPTN(1:LENGTH(GP4S42A))=GP4S42A;/* MOVE PATTERNS    02788000
*                                      TO GETMAIN AREA               */ 02789000
         MVC   DYNAMPTN(37),GP4S42A                             02S0875 02790000
*               IF RCD42LN=ERROR THEN/* IS FIELD IN ERROR            */ 02791000
         L     @14,DATAPTR(,PLISTPTR)                           02S0876 02792000
         CLI   RCD42LN+46(@14),255                              02S0876 02793000
         BNE   @RF00876                                         02S0876 02794000
*                 DO;               /* YES - FORMAT ONLY 4 BYTES     */ 02795000
*                   OLDFLG(1)=OLDFLG(1)|CHARFLAG;/* INDICATE DATA IN    02796000
*                                      EBCDIC                        */ 02797000
         SLR   @14,@14                                          02S0878 02798000
         IC    @14,OLDFLG                                       02S0878 02799000
         O     @14,@CF00092                                     02S0878 02800000
         STC   @14,OLDFLG                                       02S0878 02801000
*                   OLDFLG(2)=0;    /* INDICATE END OF PATTERNS      */ 02802000
         MVI   OLDFLG+4,X'00'                                   02S0879 02803000
*                 END;                                          02S0880 02804000
*               ELSE                                            02S0881 02805000
*                 DO;               /* NO - DETERMINE HOW MANY BYTES    02806000
*                                      IN SPVSR LIST                 */ 02807000
         B     @RC00876                                         02S0881 02808000
@RF00876 DS    0H                                               02S0882 02809000
*                   IF RCD42LN>36 THEN/* DOES DATA NEED TWO LINES    */ 02810000
         LA    @14,46                                           02S0882 02811000
         AL    @14,DATAPTR(,PLISTPTR)                           02S0882 02812000
         CLI   RCD42LN(@14),36                                  02S0882 02813000
         BNH   @RF00882                                         02S0882 02814000
*                     DATALNTH=RCD42LN-36;/* YES - LENGTH OF DATA FOR   02815000
*                                      2ND LINE OF LIST              */ 02816000
         SLR   @07,@07                                          02S0883 02817000
         IC    @07,RCD42LN(,@14)                                02S0883 02818000
         SH    @07,@CH01324                                     02S0883 02819000
         STC   @07,DATALNTH                                     02S0883 02820000
*                   IF RCD42LN<4 THEN/* IS LIST LESS THAN ONE WORD   */ 02821000
@RF00882 LA    @14,46                                           02S0884 02822000
         AL    @14,DATAPTR(,PLISTPTR)                           02S0884 02823000
         CLI   RCD42LN(@14),4                                   02S0884 02824000
         BNL   @RF00884                                         02S0884 02825000
*                     DO;           /* YES                           */ 02826000
*                       OLDLN(1)=OLDLN(1)&DATAOFF;/* SET DATA LENGTH    02827000
*                                      TO 0                          */ 02828000
         SLR   @07,@07                                          02S0886 02829000
         IC    @07,OLDLN                                        02S0886 02830000
         N     @07,@CF00297                                     02S0886 02831000
         STC   @07,OLDLN                                        02S0886 02832000
*                       OLDLN(1)=OLDLN(1)|(RCD42LN-1);/* NEW DATA       02833000
*                                      LENGTH                        */ 02834000
         SLR   @05,@05                                          02S0887 02835000
         IC    @05,RCD42LN(,@14)                                02S0887 02836000
         BCTR  @05,0                                            02S0887 02837000
         OR    @07,@05                                          02S0887 02838000
         STC   @07,OLDLN                                        02S0887 02839000
*                       OLDFLG(2)=0;/* INDICATE END OF PATTERNS      */ 02840000
         MVI   OLDFLG+4,X'00'                                   02S0888 02841000
*                     END;                                      02S0889 02842000
*                   ELSE                                        02S0890 02843000
*                     DO;           /* NO - MODIFY PATTERNS     02S0890 02844000
*                                      ACCORDINGLY                   */ 02845000
         B     @RC00884                                         02S0890 02846000
@RF00884 DS    0H                                               02S0891 02847000
*                       K=RCD42LN/4;/* NUMBER OF FULL WORDS          */ 02848000
         L     @14,DATAPTR(,PLISTPTR)                           02S0891 02849000
         SLR   @05,@05                                          02S0891 02850000
         IC    @05,RCD42LN+46(,@14)                             02S0891 02851000
         LR    K,@05                                            02S0891 02852000
         SRL   K,2                                              02S0891 02853000
*                       MOD=RCD42LN//4;/* REMAINDER OF PARTIAL WORD  */ 02854000
         LR    @02,@05                                          02S0892 02855000
         SRDA  @02,32                                           02S0892 02856000
         D     @02,@CF00099                                     02S0892 02857000
         LR    MOD,@02                                          02S0892 02858000
*                       IF MOD=0 THEN/* ARE ALL FULL WORDS           */ 02859000
         SLR   @14,@14                                          02S0893 02860000
         CR    MOD,@14                                          02S0893 02861000
         BNE   @RF00893                                         02S0893 02862000
*                         OLDFLG(K+1)=0;/* YES - INDICATE END OF        02863000
*                                      PATTERNS                      */ 02864000
         LR    @07,K                                            02S0894 02865000
         SLA   @07,2                                            02S0894 02866000
         STC   @14,OLDFLG(@07)                                  02S0894 02867000
*                       ELSE                                    02S0895 02868000
*                         DO;       /* NO - MODIFY PATTERNS     02S0895 02869000
*                                      ACCORDINGLY                   */ 02870000
         B     @RC00893                                         02S0895 02871000
@RF00893 DS    0H                                               02S0896 02872000
*                           OLDLN(K+1)=OLDLN(K+1)&DATAOFF;/* SET DATA   02873000
*                                      LENGTH TO ZERO                */ 02874000
         LR    @14,K                                            02S0896 02875000
         SLA   @14,2                                            02S0896 02876000
         SLR   @05,@05                                          02S0896 02877000
         IC    @05,OLDLN(@14)                                   02S0896 02878000
         N     @05,@CF00297                                     02S0896 02879000
         STC   @05,OLDLN(@14)                                   02S0896 02880000
*                           OLDLN(K+1)=OLDLN(K+1)|(MOD-1);/* NEW DATA   02881000
*                                      LENGTH                        */ 02882000
         LR    @03,MOD                                          02S0897 02883000
         BCTR  @03,0                                            02S0897 02884000
         OR    @05,@03                                          02S0897 02885000
         STC   @05,OLDLN(@14)                                   02S0897 02886000
*                           OLDFLG(K+2)=0;/* INDICATE END OF PATTERNS*/ 02887000
         SLR   @07,@07                                          02S0898 02888000
         STC   @07,OLDFLG+4(@14)                                02S0898 02889000
*                         END;                                  02S0899 02890000
*                     END;                                      02S0900 02891000
@RC00893 DS    0H                                               02S0901 02892000
*                 END;                                          02S0901 02893000
@RC00884 DS    0H                                               02S0902 02894000
*               ADPLFMT1=ADDR(GP4TYP16);/* ADDR OF LABEL FOR THIS       02895000
*                                      LINE                          */ 02896000
@RC00876 L     @14,ABDPLPTR(,PLISTPTR)                          02S0902 02897000
         LA    @07,GP4TYP16                                     02S0902 02898000
         ST    @07,ADPLFMT1(,@14)                               02S0902 02899000
*               ADPLFMT2=ADDR(RCD42LN)+1;/* ADDR OF DATA IN BUFFER   */ 02900000
         LA    @07,47                                           02S0903 02901000
         AL    @07,DATAPTR(,PLISTPTR)                           02S0903 02902000
         ST    @07,ADPLFMT2(,@14)                               02S0903 02903000
*               R0=ADDR(DYNAMPTN);  /* ADDR OF PATTERNS              */ 02904000
         LA    R0,DYNAMPTN                                      02S0904 02905000
*               CALL AMDPRFMT;      /* FORMAT THE LINE               */ 02906000
         L     @15,FMTADDR(,PLISTPTR)                           02S0905 02907000
         BALR  @14,@15                                          02S0905 02908000
*               RETCODE=0;          /* INDICATES TO PRINT BUFFER AND    02909000
*                                      RETURN FOR FOURTH PASS        */ 02910000
         SLR   RETCODE,RETCODE                                  02S0906 02911000
*             END;                                              02S0907 02912000
*           ELSE                                                02S0908 02913000
*             DO;                   /* YES                           */ 02914000
         B     @RC00873                                         02S0908 02915000
@RF00873 DS    0H                                               02S0909 02916000
*               IF TIMESW=3 THEN    /* HAS LINE 4 BEEN FORMATTED     */ 02917000
         CLC   TIMESW(2),@CH00170                               02S0909 02918000
         BNE   @RF00909                                         02S0909 02919000
*                 DO;               /* NO                            */ 02920000
*                   IF RCD42LN=ERROR THEN/* WAS FIELD IN ERROR       */ 02921000
         LA    @14,46                                           02S0911 02922000
         AL    @14,DATAPTR(,PLISTPTR)                           02S0911 02923000
         CLI   RCD42LN(@14),255                                 02S0911 02924000
         BNE   @RF00911                                         02S0911 02925000
*                     DO;           /* YES                           */ 02926000
*                       RCD42LN=4;  /* MODIFY LENGTH IN ORDER TO        02927000
*                                      ACCESS NEXT FIELD             */ 02928000
         MVI   RCD42LN(@14),X'04'                               02S0913 02929000
*                       GO TO FMTPLIST;/* FORMAT PLIST ON FOURTH LINE*/ 02930000
         B     FMTPLIST                                         02S0914 02931000
*                     END;                                      02S0915 02932000
*                   ELSE                                        02S0916 02933000
*                     DO;           /* CHECK SPVR LIST SIZE          */ 02934000
@RF00911 DS    0H                                               02S0917 02935000
*                       IF RCD42LN<=36 THEN/* DOES SPVR LIST NEED 2     02936000
*                                      LINES                         */ 02937000
         L     @14,DATAPTR(,PLISTPTR)                           02S0917 02938000
         CLI   RCD42LN+46(@14),36                               02S0917 02939000
         BNH   @RT00917                                         02S0917 02940000
*                         GO TO FMTPLIST;/* NO - FORMAT PLIST ON        02941000
*                                      FOURTH LINE                   */ 02942000
*                       ELSE                                    02S0919 02943000
*                         DO;       /* YES - FORMAT REMAINDER OF LIST*/ 02944000
*                           DYNAMPTN(1:LENGTH(GP4S42B))=GP4S42B;/*      02945000
*                                      MOVE PATTERNS TO GETMAIN AREA */ 02946000
         MVC   DYNAMPTN(25),GP4S42B                             02S0920 02947000
*                           IF DATALNTH<4 THEN/* IS PLIST LESS THAN     02948000
*                                      ONE WORD                      */ 02949000
         CLI   DATALNTH,4                                       02S0921 02950000
         BNL   @RF00921                                         02S0921 02951000
*                             DO;   /* YES                           */ 02952000
*                               OLDLN(1)=OLDLN(1)&DATAOFF;/* SET DATA   02953000
*                                      LENGTH TO 0                   */ 02954000
         SLR   @14,@14                                          02S0923 02955000
         IC    @14,OLDLN                                        02S0923 02956000
         N     @14,@CF00297                                     02S0923 02957000
         STC   @14,OLDLN                                        02S0923 02958000
*                               OLDLN(1)=OLDLN(1)|(DATALNTH-1);/* NEW   02959000
*                                      DATA LENGTH                   */ 02960000
         SLR   @07,@07                                          02S0924 02961000
         IC    @07,DATALNTH                                     02S0924 02962000
         BCTR  @07,0                                            02S0924 02963000
         OR    @14,@07                                          02S0924 02964000
         STC   @14,OLDLN                                        02S0924 02965000
*                               OLDFLG(2)=0;/* INDICATE END OF  02S0925 02966000
*                                      PATTERNS                      */ 02967000
         MVI   OLDFLG+4,X'00'                                   02S0925 02968000
*                             END;                              02S0926 02969000
*                           ELSE                                02S0927 02970000
*                             DO;   /* NO - MODIFY PATTERNS          */ 02971000
         B     @RC00921                                         02S0927 02972000
@RF00921 DS    0H                                               02S0928 02973000
*                               K=DATALNTH/4;/* NUMBER OF FULL WORDS */ 02974000
         SLR   @14,@14                                          02S0928 02975000
         IC    @14,DATALNTH                                     02S0928 02976000
         LR    K,@14                                            02S0928 02977000
         SRL   K,2                                              02S0928 02978000
*                               MOD=DATALNTH//4;/* REMAINDER OF 02S0929 02979000
*                                      PARTIAL WORD                  */ 02980000
         LR    @02,@14                                          02S0929 02981000
         SRDA  @02,32                                           02S0929 02982000
         D     @02,@CF00099                                     02S0929 02983000
         LR    MOD,@02                                          02S0929 02984000
*                               IF MOD=0 THEN/* ARE ALL FULL WORDS   */ 02985000
         SLR   @14,@14                                          02S0930 02986000
         CR    MOD,@14                                          02S0930 02987000
         BNE   @RF00930                                         02S0930 02988000
*                                 OLDFLG(K+1)=0;/* YES - INDICATE END   02989000
*                                      OF PATTERNS                   */ 02990000
         LR    @07,K                                            02S0931 02991000
         SLA   @07,2                                            02S0931 02992000
         STC   @14,OLDFLG(@07)                                  02S0931 02993000
*                               ELSE                            02S0932 02994000
*                                 DO;/* NO - MODIFY PATTERNS    02S0932 02995000
*                                      ACCORDINGLY                   */ 02996000
         B     @RC00930                                         02S0932 02997000
@RF00930 DS    0H                                               02S0933 02998000
*                                   OLDLN(K+1)=OLDLN(K+1)&DATAOFF;/*    02999000
*                                      SET DATA LENGTH TO ZERO       */ 03000000
         LR    @14,K                                            02S0933 03001000
         SLA   @14,2                                            02S0933 03002000
         SLR   @05,@05                                          02S0933 03003000
         IC    @05,OLDLN(@14)                                   02S0933 03004000
         N     @05,@CF00297                                     02S0933 03005000
         STC   @05,OLDLN(@14)                                   02S0933 03006000
*                                   OLDLN(K+1)=OLDLN(K+1)|(MOD-1);/*    03007000
*                                      NEW DATA LENGTH               */ 03008000
         LR    @03,MOD                                          02S0934 03009000
         BCTR  @03,0                                            02S0934 03010000
         OR    @05,@03                                          02S0934 03011000
         STC   @05,OLDLN(@14)                                   02S0934 03012000
*                                   OLDFLG(K+2)=0;/* INDICATE END OF    03013000
*                                      PATTERNS                      */ 03014000
         SLR   @07,@07                                          02S0935 03015000
         STC   @07,OLDFLG+4(@14)                                02S0935 03016000
*                                 END;                          02S0936 03017000
*                             END;                              02S0937 03018000
@RC00930 DS    0H                                               02S0938 03019000
*                         END;                                  02S0938 03020000
@RC00921 DS    0H                                               02S0939 03021000
*                       R0=ADDR(DYNAMPTN);/* ADDR OF PATTERNS        */ 03022000
         LA    R0,DYNAMPTN                                      02S0939 03023000
*                       CALL AMDPRFMT;/* FORMAT THE LINE             */ 03024000
         L     @15,FMTADDR(,PLISTPTR)                           02S0940 03025000
         BALR  @14,@15                                          02S0940 03026000
*                       RETCODE=0;  /* INDICATES TO PRINT BUFFER AND    03027000
*                                      RETURN FOR FIFTH PASS         */ 03028000
         SLR   RETCODE,RETCODE                                  02S0941 03029000
*                     END;                                      02S0942 03030000
*                 END;                                          02S0943 03031000
*               ELSE                                            02S0944 03032000
*                 DO;               /* YES - FORMAT FIFTH LINE       */ 03033000
         B     @RC00909                                         02S0944 03034000
@RF00909 DS    0H                                               02S0945 03035000
*FMTPLIST:                                                      02S0945 03036000
*                   DYNAMPTN(1:LENGTH(GP4S42C))=GP4S42C;/* MOVE 02S0945 03037000
*                                      PATTERNS TO GETMAIN AREA      */ 03038000
FMTPLIST MVC   DYNAMPTN(41),GP4S42C                             02S0945 03039000
*                   R0=ADDR(DYNAMPTN);/* ADDR OF PATTERNS    @YM03669*/ 03040000
         LA    R0,DYNAMPTN                                      02S0946 03041000
*                   FIELDADR=ADDR(RCD42LN)+RCD42LN+1;/* ADDR OF PROB    03042000
*                                      PLIST IN BUFFER               */ 03043000
         LA    @14,46                                           02S0947 03044000
         AL    @14,DATAPTR(,PLISTPTR)                           02S0947 03045000
         SLR   @07,@07                                          02S0947 03046000
         IC    @07,RCD42LN(,@14)                                02S0947 03047000
         ALR   @07,@14                                          02S0947 03048000
         AH    @07,@CH00046                                     02S0947 03049000
         ST    @07,FIELDADR                                     02S0947 03050000
*                   IF NXTFIELD^=ERROR THEN/* IS FIELD IN ERROR      */ 03051000
         CLI   NXTFIELD(@07),255                                02S0948 03052000
         BE    @RF00948                                         02S0948 03053000
*                     DO;           /* NO-CHECK DATA LENGTH FOR ZERO */ 03054000
*                       IF NXTFIELD=0 THEN/* IS THERE ANY DATA  02S0950 03055000
*                                                            @YM03669*/ 03056000
         CLI   NXTFIELD(@07),0                                  02S0950 03057000
         BNE   @RF00950                                         02S0950 03058000
*                         R0=ADDR(GP4S42D);/* NO - ADDR OF FORMAT       03059000
*                                      PATTERNS FOR THIS LINE   02S0951 03060000
*                                                            @YM03669*/ 03061000
         LA    R0,GP4S42D                                       02S0951 03062000
*                       ELSE                                    02S0952 03063000
*                         DO;       /* YES - THERE IS DATA           */ 03064000
         B     @RC00950                                         02S0952 03065000
@RF00950 DS    0H                                               02S0953 03066000
*                           K=NXTFIELD/4;/* NUMBER OF FULL WORDS     */ 03067000
         L     @14,FIELDADR                                     02S0953 03068000
         SLR   @05,@05                                          02S0953 03069000
         IC    @05,NXTFIELD(,@14)                               02S0953 03070000
         LR    K,@05                                            02S0953 03071000
         SRL   K,2                                              02S0953 03072000
*                           MOD=NXTFIELD//4;/* REMAINDER OF PARTIAL     03073000
*                                      WORD                          */ 03074000
         LR    @02,@05                                          02S0954 03075000
         SRDA  @02,32                                           02S0954 03076000
         D     @02,@CF00099                                     02S0954 03077000
         LR    MOD,@02                                          02S0954 03078000
*                           IF MOD=0 THEN/* ARE ALL FULL WORDS       */ 03079000
         SLR   @14,@14                                          02S0955 03080000
         CR    MOD,@14                                          02S0955 03081000
         BNE   @RF00955                                         02S0955 03082000
*                             OLDFLG(K+1)=0;/* YES - INDICATE END OF    03083000
*                                      PATTERNS                      */ 03084000
         LR    @07,K                                            02S0956 03085000
         SLA   @07,2                                            02S0956 03086000
         STC   @14,OLDFLG(@07)                                  02S0956 03087000
*                           ELSE    /*                       @YM03669*/ 03088000
*                             DO;   /* NO - MODIFY PATTERNS     02S0957 03089000
*                                      ACCORDINGLY                   */ 03090000
         B     @RC00955                                         02S0957 03091000
@RF00955 DS    0H                                               02S0958 03092000
*                               OLDLN(K+1)=OLDLN(K+1)&DATAOFF;/* SET    03093000
*                                      DATA LENGTH TO ZERO           */ 03094000
         LR    @14,K                                            02S0958 03095000
         SLA   @14,2                                            02S0958 03096000
         SLR   @05,@05                                          02S0958 03097000
         IC    @05,OLDLN(@14)                                   02S0958 03098000
         N     @05,@CF00297                                     02S0958 03099000
         STC   @05,OLDLN(@14)                                   02S0958 03100000
*                               OLDLN(K+1)=OLDLN(K+1)|(MOD-1);/* NEW    03101000
*                                      DATA LENGTH                   */ 03102000
         LR    @03,MOD                                          02S0959 03103000
         BCTR  @03,0                                            02S0959 03104000
         OR    @05,@03                                          02S0959 03105000
         STC   @05,OLDLN(@14)                                   02S0959 03106000
*                               OLDFLG(K+2)=0;/* INDICATE END OF        03107000
*                                      PATTERNS                      */ 03108000
         SLR   @07,@07                                          02S0960 03109000
         STC   @07,OLDFLG+4(@14)                                02S0960 03110000
*                             END;                              02S0961 03111000
*                         END;      /*                       @YM03669*/ 03112000
*                     END;                                      02S0963 03113000
*                   ELSE                                        02S0964 03114000
*                     DO;           /* YES - FIELD IS IN ERROR       */ 03115000
         B     @RC00948                                         02S0964 03116000
@RF00948 DS    0H                                               02S0965 03117000
*                       OLDFLG(1)=OLDFLG(1)|CHARFLAG;/* INDICATE DATA   03118000
*                                      IN EBCDIC             @YM03669*/ 03119000
         SLR   @14,@14                                          02S0965 03120000
         IC    @14,OLDFLG                                       02S0965 03121000
         O     @14,@CF00092                                     02S0965 03122000
         STC   @14,OLDFLG                                       02S0965 03123000
*                       OLDFLG(2)=0;/* INDICATE END OF PATTERNS      */ 03124000
         MVI   OLDFLG+4,X'00'                                   02S0966 03125000
*                     END;                                      02S0967 03126000
*                   ADPLFMT1=ADDR(GP4TP16A);/* ADDR OF LABELS FOR       03127000
*                                      THIS LINE                     */ 03128000
@RC00948 L     @14,ABDPLPTR(,PLISTPTR)                          02S0968 03129000
         LA    @07,GP4TP16A                                     02S0968 03130000
         ST    @07,ADPLFMT1(,@14)                               02S0968 03131000
*                   ADPLFMT2=FIELDADR+1;/* ADDR OF DATA IN BUFFER    */ 03132000
         LA    @07,1                                            02S0969 03133000
         AL    @07,FIELDADR                                     02S0969 03134000
         ST    @07,ADPLFMT2(,@14)                               02S0969 03135000
*                   CALL AMDPRFMT;  /* FORMAT THE LINE               */ 03136000
         L     @15,FMTADDR(,PLISTPTR)                           02S0970 03137000
         BALR  @14,@15                                          02S0970 03138000
*                   RETCODE=4;      /* INDICATES TO PRINT BUFFER AND    03139000
*                                      GET NEXT RECORD               */ 03140000
         LA    RETCODE,4                                        02S0971 03141000
*                 END;                                          02S0972 03142000
*             END;                                              02S0973 03143000
*         END;                                                  02S0974 03144000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 03145000
         B     CE0001@                                          02S0975 03146000
*     END S42;                      /* END OF SUBCASE                */ 03147000
*                                                               02S0977 03148000
*     /***************************************************************/ 03149000
*     /*                                                             */ 03150000
*     /* THIS ROUTINE WILL PROCESS THE FOLLOWING SVCS: 44,62. THE    */ 03151000
*     /* FORMATTING CONSISTS OF THE BASIC RECORD + A CHAPPED TCB     */ 03152000
*     /* ADDRESS/A DETACHED TCB ADDRESS.                             */ 03153000
*     /*                                                             */ 03154000
*     /***************************************************************/ 03155000
*                                                               02S0977 03156000
*S44:                                                           02S0977 03157000
*     DO;                           /* SUBCASE                       */ 03158000
S44      DS    0H                                               02S0978 03159000
*       IF TIMESW=0 THEN            /* HAS SECOND LINE BEEN FORMATTED*/ 03160000
         SLR   @14,@14                                          02S0978 03161000
         CH    @14,TIMESW                                       02S0978 03162000
         BNE   @RF00978                                         02S0978 03163000
*         RETCODE=0;                /* NO - INDICATES TO PRINT BUFFER   03164000
*                                      AND RETURN FOR SECOND PASS    */ 03165000
         LR    RETCODE,@14                                      02S0979 03166000
*       ELSE                                                    02S0980 03167000
*         DO;                       /* YES - CHECK FIELDS FOR ERRORS    03168000
*                                      & FORMAT THEM                 */ 03169000
         B     @RC00978                                         02S0980 03170000
@RF00978 DS    0H                                               02S0981 03171000
*           DYNAMPTN(1:LENGTH(GP4S44))=GP4S44;/* MOVE PATTERNS TO       03172000
*                                      GETMAINED AREA                */ 03173000
         MVC   DYNAMPTN(5),GP4S44                               02S0981 03174000
*           IF TCBADDR=ASTER4|TCBADDR=PEES4|TCBADDR=ESSES4 THEN/* IS    03175000
*                                      FIELD IN ERROR                */ 03176000
         LA    @14,46                                           02S0982 03177000
         AL    @14,DATAPTR(,PLISTPTR)                           02S0982 03178000
         CLC   TCBADDR(4,@14),ASTER4                            02S0982 03179000
         BE    @RT00982                                         02S0982 03180000
         CLC   TCBADDR(4,@14),PEES4                             02S0982 03181000
         BE    @RT00982                                         02S0982 03182000
         CLC   TCBADDR(4,@14),ESSES4                            02S0982 03183000
         BNE   @RF00982                                         02S0982 03184000
@RT00982 DS    0H                                               02S0983 03185000
*             OLDFLG(1)=OLDFLG(1)|CHARFLAG;/* INDICATE DATA IN EBCDIC*/ 03186000
         SLR   @14,@14                                          02S0983 03187000
         IC    @14,OLDFLG                                       02S0983 03188000
         O     @14,@CF00092                                     02S0983 03189000
         STC   @14,OLDFLG                                       02S0983 03190000
*           IF SVCNUMBR=45 THEN     /* IS THIS SVC 44                */ 03191000
@RF00982 CH    SVCNUMBR,@CH01425                                02S0984 03192000
         BNE   @RF00984                                         02S0984 03193000
*             ADPLFMT1=ADDR(GP4TYP17);/* YES - ADDR OF LABELS FOR       03194000
*                                      THIS LINE                     */ 03195000
         L     @14,ABDPLPTR(,PLISTPTR)                          02S0985 03196000
         LA    @07,GP4TYP17                                     02S0985 03197000
         ST    @07,ADPLFMT1(,@14)                               02S0985 03198000
*           ELSE                    /* NO - ITS SVC 62               */ 03199000
*             ADPLFMT1=ADDR(GP4TYP20);/* ADDR OF LABELS FOR THIS LINE*/ 03200000
         B     @RC00984                                         02S0986 03201000
@RF00984 L     @14,ABDPLPTR(,PLISTPTR)                          02S0986 03202000
         LA    @07,GP4TYP20                                     02S0986 03203000
         ST    @07,ADPLFMT1(,@14)                               02S0986 03204000
*           ADPLFMT2=ADDR(TCBADDR); /* ADDR OF DATA IN BUFFER        */ 03205000
@RC00984 L     @14,ABDPLPTR(,PLISTPTR)                          02S0987 03206000
         LA    @07,46                                           02S0987 03207000
         AL    @07,DATAPTR(,PLISTPTR)                           02S0987 03208000
         ST    @07,ADPLFMT2(,@14)                               02S0987 03209000
*           R0=ADDR(DYNAMPTN);      /* ADDR OF PATTERNS              */ 03210000
         LA    R0,DYNAMPTN                                      02S0988 03211000
*           CALL AMDPRFMT;          /* FORMAT THE LINE               */ 03212000
         L     @15,FMTADDR(,PLISTPTR)                           02S0989 03213000
         BALR  @14,@15                                          02S0989 03214000
*           RETCODE=4;              /* INDICATES TO PRINT BUFFER AND    03215000
*                                      GET NEXT RECORD               */ 03216000
         LA    RETCODE,4                                        02S0990 03217000
*         END;                                                  02S0991 03218000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 03219000
         B     CE0001@                                          02S0992 03220000
*     END S44;                      /* END OF SUBCASE                */ 03221000
*                                                               02S0994 03222000
*     /***************************************************************/ 03223000
*     /*                                                             */ 03224000
*     /* THIS ROUTINE WILL PROCESS THE FOLLOWING SVCS: 48,56. THE    */ 03225000
*     /* FORMATTING CONSISTS OF THE BASIC RECORD + A 20 BYTE PLIST + */ 03226000
*     /* A MAJOR NAME AND A VARIABLE LENGTH MINOR NAME.              */ 03227000
*     /*                                                             */ 03228000
*     /***************************************************************/ 03229000
*                                                               02S0994 03230000
*S48:                                                           02S0994 03231000
*     DO;                           /* SUBCASE                       */ 03232000
S48      DS    0H                                               02S0995 03233000
*       IF TIMESW=0 THEN            /* HAS SECOND LINE BEEN FORMATTED*/ 03234000
         SLR   @14,@14                                          02S0995 03235000
         CH    @14,TIMESW                                       02S0995 03236000
         BNE   @RF00995                                         02S0995 03237000
*         RETCODE=0;                /* NO - INDICATES TO PRINT BUFFER   03238000
*                                      AND RETURN FOR SECOND PASS    */ 03239000
         LR    RETCODE,@14                                      02S0996 03240000
*       ELSE                                                    02S0997 03241000
*         DO;                       /* YES - REGISTERS HAVE BEEN        03242000
*                                      FORMATTED                     */ 03243000
         B     @RC00995                                         02S0997 03244000
@RF00995 DS    0H                                               02S0998 03245000
*           IF TIMESW=1 THEN        /* HAS REMAINDER OF SECOND LINE     03246000
*                                      BEEN FORMATTED                */ 03247000
         CLC   TIMESW(2),@CH00046                               02S0998 03248000
         BNE   @RF00998                                         02S0998 03249000
*             DO;                   /* NO                            */ 03250000
*               DYNAMPTN(1:LENGTH(GP4S48A))=GP4S48A;/* MOVE PATTERNS    03251000
*                                      TO GETMAINED AREA             */ 03252000
         MVC   DYNAMPTN(21),GP4S48A                             02S1000 03253000
*               IF RCD48LN^=ERROR THEN/* IS FIELD IN ERROR           */ 03254000
         LA    @14,46                                           02S1001 03255000
         AL    @14,DATAPTR(,PLISTPTR)                           02S1001 03256000
         CLI   RCD48LN(@14),255                                 02S1001 03257000
         BE    @RF01001                                         02S1001 03258000
*                 DO;               /* NO                            */ 03259000
*                   IF RCD48LN^=44 THEN/* IS DSN MAX LENGTH          */ 03260000
         CLI   RCD48LN(@14),44                                  02S1003 03261000
         BE    @RF01003                                         02S1003 03262000
*                     DO;           /* NO                            */ 03263000
*                       K=RCD48LN/16;/* NUMBER OF FULL WORDS         */ 03264000
         SLR   @05,@05                                          02S1005 03265000
         IC    @05,RCD48LN(,@14)                                02S1005 03266000
         LR    K,@05                                            02S1005 03267000
         SRL   K,4                                              02S1005 03268000
*                       MOD=RCD48LN//16;/* REMAINDER OF PARTIAL WORD */ 03269000
         LR    @02,@05                                          02S1006 03270000
         SRDA  @02,32                                           02S1006 03271000
         D     @02,@CF00139                                     02S1006 03272000
         LR    MOD,@02                                          02S1006 03273000
*                       IF MOD=0 THEN/* ARE ALL FULL WORDS           */ 03274000
         SLR   @14,@14                                          02S1007 03275000
         CR    MOD,@14                                          02S1007 03276000
         BNE   @RF01007                                         02S1007 03277000
*                         OLDFLG(K+3)=0;/* YES - INDICATE END OF        03278000
*                                      PATTERNS                      */ 03279000
         LR    @07,K                                            02S1008 03280000
         SLA   @07,2                                            02S1008 03281000
         STC   @14,OLDFLG+8(@07)                                02S1008 03282000
*                       ELSE                                    02S1009 03283000
*                         DO;       /* NO - MODIFY PATTERNS     02S1009 03284000
*                                      ACCORDINGLY                   */ 03285000
         B     @RC01007                                         02S1009 03286000
@RF01007 DS    0H                                               02S1010 03287000
*                           OLDLN(K+3)=OLDLN(K+3)&DATAOFF;/* SET DATA   03288000
*                                      LENGTH TO ZERO                */ 03289000
         LR    @14,K                                            02S1010 03290000
         SLA   @14,2                                            02S1010 03291000
         SLR   @05,@05                                          02S1010 03292000
         IC    @05,OLDLN+8(@14)                                 02S1010 03293000
         N     @05,@CF00297                                     02S1010 03294000
         STC   @05,OLDLN+8(@14)                                 02S1010 03295000
*                           OLDLN(K+3)=OLDLN(K+3)|(MOD-1);/* NEW DATA   03296000
*                                      LENGTH                        */ 03297000
         LR    @03,MOD                                          02S1011 03298000
         BCTR  @03,0                                            02S1011 03299000
         OR    @05,@03                                          02S1011 03300000
         STC   @05,OLDLN+8(@14)                                 02S1011 03301000
*                           OLDFLG(K+4)=0;/* INDICATE END OF PATTERNS*/ 03302000
         SLR   @07,@07                                          02S1012 03303000
         STC   @07,OLDFLG+12(@14)                               02S1012 03304000
*                         END;                                  02S1013 03305000
*                     END;                                      02S1014 03306000
*                 END;                                          02S1015 03307000
*               ELSE                                            02S1016 03308000
*                 DO;               /* YES - FIELD IS IN ERROR       */ 03309000
         B     @RC01001                                         02S1016 03310000
@RF01001 DS    0H                                               02S1017 03311000
*                   OLDLN(3)=OLDLN(3)&DATAOFF;/* ZERO DATA LENGTH    */ 03312000
         SLR   @14,@14                                          02S1017 03313000
         IC    @14,OLDLN+8                                      02S1017 03314000
         N     @14,@CF00297                                     02S1017 03315000
         STC   @14,OLDLN+8                                      02S1017 03316000
*                   OLDLN(3)=OLDLN(3)|DATALN4;/* SET DATA LENGTH TO     03317000
*                                      FORMAT 4 BYTES                */ 03318000
         O     @14,@CF00170                                     02S1018 03319000
         STC   @14,OLDLN+8                                      02S1018 03320000
*                   OLDFLG(4)=0;    /* INDICATE END OF PATTERNS      */ 03321000
         MVI   OLDFLG+12,X'00'                                  02S1019 03322000
*                 END;                                          02S1020 03323000
*               ADPLFMT1=ADDR(GP4TYP18);/* ADDR OF LABELS FOR THIS      03324000
*                                      LINE                          */ 03325000
@RC01001 L     @14,ABDPLPTR(,PLISTPTR)                          02S1021 03326000
         LA    @07,GP4TYP18                                     02S1021 03327000
         ST    @07,ADPLFMT1(,@14)                               02S1021 03328000
*               ADPLFMT2=ADDR(MAJORNM);/* ADDR OF DATA IN BUFFER     */ 03329000
         L     @07,DATAPTR(,PLISTPTR)                           02S1022 03330000
         LA    @07,MAJORNM+46(,@07)                             02S1022 03331000
         ST    @07,ADPLFMT2(,@14)                               02S1022 03332000
*               R0=ADDR(DYNAMPTN);  /* ADDR OF PATTERNS              */ 03333000
         LA    R0,DYNAMPTN                                      02S1023 03334000
*               CALL AMDPRFMT;      /* FORMAT THE LINE               */ 03335000
         L     @15,FMTADDR(,PLISTPTR)                           02S1024 03336000
         BALR  @14,@15                                          02S1024 03337000
*               RETCODE=0;          /* INDICATES TO PRINT BUFFER AND    03338000
*                                      RETURN FOR THIRD PASS         */ 03339000
         SLR   RETCODE,RETCODE                                  02S1025 03340000
*             END;                                              02S1026 03341000
*           ELSE                                                02S1027 03342000
*             DO;                   /* YES - FORMAT THE THIRD LINE   */ 03343000
         B     @RC00998                                         02S1027 03344000
@RF00998 DS    0H                                               02S1028 03345000
*               DYNAMPTN(1:LENGTH(GP4S48B))=GP4S48B;/* MOVE PATTERNS    03346000
*                                      TO GETMAINED AREA             */ 03347000
         MVC   DYNAMPTN(21),GP4S48B                             02S1028 03348000
*               IF RCD48LST=ASTER20|RCD48LST=PEES20|RCD48LST=ESSES20    03349000
*                 THEN              /* IS FIELD IN ERROR             */ 03350000
         LA    @14,46                                           02S1029 03351000
         AL    @14,DATAPTR(,PLISTPTR)                           02S1029 03352000
         CLC   RCD48LST(20,@14),ASTER20                         02S1029 03353000
         BE    @RT01029                                         02S1029 03354000
         CLC   RCD48LST(20,@14),PEES20                          02S1029 03355000
         BE    @RT01029                                         02S1029 03356000
         CLC   RCD48LST(20,@14),ESSES20                         02S1029 03357000
         BNE   @RF01029                                         02S1029 03358000
@RT01029 DS    0H                                               02S1030 03359000
*                 DO;               /* YES                           */ 03360000
*                   OLDFLG(1)=OLDFLG(1)|CHARFLAG;/* INDICATE DATA IN    03361000
*                                      EBCDIC                        */ 03362000
         LA    @14,32                                           02S1031 03363000
         SLR   @07,@07                                          02S1031 03364000
         IC    @07,OLDFLG                                       02S1031 03365000
         OR    @07,@14                                          02S1031 03366000
         STC   @07,OLDFLG                                       02S1031 03367000
*                   OLDFLG(2)=OLDFLG(2)|CHARFLAG;               02S1032 03368000
         SLR   @07,@07                                          02S1032 03369000
         IC    @07,OLDFLG+4                                     02S1032 03370000
         OR    @07,@14                                          02S1032 03371000
         STC   @07,OLDFLG+4                                     02S1032 03372000
*                   OLDFLG(3)=OLDFLG(3)|CHARFLAG;               02S1033 03373000
         SLR   @07,@07                                          02S1033 03374000
         IC    @07,OLDFLG+8                                     02S1033 03375000
         OR    @07,@14                                          02S1033 03376000
         STC   @07,OLDFLG+8                                     02S1033 03377000
*                   OLDFLG(4)=OLDFLG(4)|CHARFLAG;               02S1034 03378000
         SLR   @07,@07                                          02S1034 03379000
         IC    @07,OLDFLG+12                                    02S1034 03380000
         OR    @07,@14                                          02S1034 03381000
         STC   @07,OLDFLG+12                                    02S1034 03382000
*                   OLDFLG(5)=OLDFLG(5)|CHARFLAG;               02S1035 03383000
         SLR   @07,@07                                          02S1035 03384000
         IC    @07,OLDFLG+16                                    02S1035 03385000
         OR    @14,@07                                          02S1035 03386000
         STC   @14,OLDFLG+16                                    02S1035 03387000
*                 END;                                          02S1036 03388000
*               ADPLFMT1=ADDR(GROUP2);/* ADDR OF LABEL FOR THIS LINE */ 03389000
@RF01029 L     @14,ABDPLPTR(,PLISTPTR)                          02S1037 03390000
         LA    @07,GROUP2                                       02S1037 03391000
         ST    @07,ADPLFMT1(,@14)                               02S1037 03392000
*               ADPLFMT2=ADDR(RCD48LST);/* ADDR OF DATA FOR THIS LINE*/ 03393000
         LA    @07,46                                           02S1038 03394000
         AL    @07,DATAPTR(,PLISTPTR)                           02S1038 03395000
         ST    @07,ADPLFMT2(,@14)                               02S1038 03396000
*               R0=ADDR(DYNAMPTN);  /* ADDR OF PATTERNS FOR THIRD       03397000
*                                      LINE                          */ 03398000
         LA    R0,DYNAMPTN                                      02S1039 03399000
*               CALL AMDPRFMT;      /* FORMAT THE LINE               */ 03400000
         L     @15,FMTADDR(,PLISTPTR)                           02S1040 03401000
         BALR  @14,@15                                          02S1040 03402000
*               RETCODE=4;          /* INDICATES TO PRINT BUFFER AND    03403000
*                                      GET NEXT RECORD               */ 03404000
         LA    RETCODE,4                                        02S1041 03405000
*             END;                                              02S1042 03406000
*         END;                                                  02S1043 03407000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 03408000
         B     CE0001@                                          02S1044 03409000
*     END S48;                      /* END OF SUBCASE                */ 03410000
*                                                               02S1046 03411000
*     /***************************************************************/ 03412000
*     /*                                                             */ 03413000
*     /* THIS ROUTINE WILL PROCESS SVC 52. THE FORMATTING CONSISTS OF*/ 03414000
*     /* THE BASIC RECORD + A 52 BYTE PARAMETER LIST.                */ 03415000
*     /*                                                             */ 03416000
*     /***************************************************************/ 03417000
*                                                               02S1046 03418000
*S52:                                                           02S1046 03419000
*     DO;                           /* SUBCASE                       */ 03420000
S52      DS    0H                                               02S1047 03421000
*       IF TIMESW=0|TIMESW=1 THEN   /* HAS BASIC RECORD BEEN    02S1047 03422000
*                                      FORMATTED                     */ 03423000
         LH    @14,TIMESW                                       02S1047 03424000
         LTR   @14,@14                                          02S1047 03425000
         BZ    @RT01047                                         02S1047 03426000
         CH    @14,@CH00046                                     02S1047 03427000
         BNE   @RF01047                                         02S1047 03428000
@RT01047 DS    0H                                               02S1048 03429000
*         RETCODE=0;                /* NO - INDICATES TO PRINT BUFFER   03430000
*                                      AND RETURN FOR THIRD PASS     */ 03431000
         SLR   RETCODE,RETCODE                                  02S1048 03432000
*       ELSE                                                    02S1049 03433000
*         DO;                       /* YES                           */ 03434000
         B     @RC01047                                         02S1049 03435000
@RF01047 DS    0H                                               02S1050 03436000
*           IF TIMESW=2 THEN        /* HAS THIRD LINE BEEN FORMATTED */ 03437000
         CLC   TIMESW(2),@CH00078                               02S1050 03438000
         BNE   @RF01050                                         02S1050 03439000
*             DO;                   /* NO                            */ 03440000
*               DYNAMPTN(1:LENGTH(GP4S52A))=GP4S52A;/* MOVE PATTERNS    03441000
*                                      TO GETMAIN AREA               */ 03442000
         MVC   DYNAMPTN(45),GP4S52A                             02S1052 03443000
*               IF ERRCHECK=ASTER20|ERRCHECK=PEES20|ERRCHECK=ESSES20    03444000
*                 THEN              /* IS FIELD IN ERROR             */ 03445000
         LA    @14,46                                           02S1053 03446000
         AL    @14,DATAPTR(,PLISTPTR)                           02S1053 03447000
         CLC   ERRCHECK(20,@14),ASTER20                         02S1053 03448000
         BE    @RT01053                                         02S1053 03449000
         CLC   ERRCHECK(20,@14),PEES20                          02S1053 03450000
         BE    @RT01053                                         02S1053 03451000
         CLC   ERRCHECK(20,@14),ESSES20                         02S1053 03452000
         BNE   @RF01053                                         02S1053 03453000
@RT01053 DS    0H                                               02S1054 03454000
*                 DO;               /* YES                           */ 03455000
*                   ADPLFMT1=ADDR(GROUP2);/* ADDR OF LABEL FOR THIS     03456000
*                                      LINE                          */ 03457000
         L     @14,ABDPLPTR(,PLISTPTR)                          02S1055 03458000
         LA    @07,GROUP2                                       02S1055 03459000
         ST    @07,ADPLFMT1(,@14)                               02S1055 03460000
*                   ADPLFMT2=ADDR(RCD52LST);/* ADDR OF DATA IN BUFFER*/ 03461000
         LA    @07,46                                           02S1056 03462000
         AL    @07,DATAPTR(,PLISTPTR)                           02S1056 03463000
         ST    @07,ADPLFMT2(,@14)                               02S1056 03464000
*                   R0=ADDR(GP4S52C);/* ADDR OF PATTERNS FOR THIS       03465000
*                                      LINE                          */ 03466000
         LA    R0,GP4S52C                                       02S1057 03467000
*                   CALL AMDPRFMT;  /* FORMAT THE LINE               */ 03468000
         L     @15,FMTADDR(,PLISTPTR)                           02S1058 03469000
         BALR  @14,@15                                          02S1058 03470000
*                   RETCODE=4;      /* INDICATES TO PRINT BUFFER AND    03471000
*                                      GET NEXT RECORD               */ 03472000
         LA    RETCODE,4                                        02S1059 03473000
*                 END;                                          02S1060 03474000
*               ELSE                                            02S1061 03475000
*                 DO;               /* NO - FIELD IS IN HEX          */ 03476000
         B     @RC01053                                         02S1061 03477000
@RF01053 DS    0H                                               02S1062 03478000
*                   ADPLFMT1=ADDR(GROUP2);/* ADDR OF LABEL FOR THIS     03479000
*                                      LINE                          */ 03480000
         L     @14,ABDPLPTR(,PLISTPTR)                          02S1062 03481000
         LA    @07,GROUP2                                       02S1062 03482000
         ST    @07,ADPLFMT1(,@14)                               02S1062 03483000
*                   ADPLFMT2=ADDR(RCD52LST);/* ADDR OF DATA IN BUFFER*/ 03484000
         LA    @07,46                                           02S1063 03485000
         AL    @07,DATAPTR(,PLISTPTR)                           02S1063 03486000
         ST    @07,ADPLFMT2(,@14)                               02S1063 03487000
*                   R0=ADDR(DYNAMPTN);/* ADDR OF PATTERNS            */ 03488000
         LA    R0,DYNAMPTN                                      02S1064 03489000
*                   CALL AMDPRFMT;  /* FORMAT THE LINE               */ 03490000
         L     @15,FMTADDR(,PLISTPTR)                           02S1065 03491000
         BALR  @14,@15                                          02S1065 03492000
*                   RETCODE=0;      /* INDICATES TO PRINT BUFFER AND    03493000
*                                      RETURN FOR FOURTH PASS        */ 03494000
         SLR   RETCODE,RETCODE                                  02S1066 03495000
*                 END;                                          02S1067 03496000
*             END;                                              02S1068 03497000
*           ELSE                                                02S1069 03498000
*             DO;                   /* YES - FORMAT THE FOURTH LINE  */ 03499000
         B     @RC01050                                         02S1069 03500000
@RF01050 DS    0H                                               02S1070 03501000
*               ADPLFMT2=ADDR(RCD52LST)+44;/* ADDR OF REMAINDER OF      03502000
*                                      PLIST IN BUFFER               */ 03503000
         L     @14,ABDPLPTR(,PLISTPTR)                          02S1070 03504000
         LA    @07,90                                           02S1070 03505000
         AL    @07,DATAPTR(,PLISTPTR)                           02S1070 03506000
         ST    @07,ADPLFMT2(,@14)                               02S1070 03507000
*               R0=ADDR(GP4S52B);   /* ADDR OF PATTERNS              */ 03508000
         LA    R0,GP4S52B                                       02S1071 03509000
*               CALL AMDPRFMT;      /* FORMAT THE LINE               */ 03510000
         L     @15,FMTADDR(,PLISTPTR)                           02S1072 03511000
         BALR  @14,@15                                          02S1072 03512000
*               RETCODE=4;          /* INDICATES TO PRINT BUFFER AND    03513000
*                                      GET NEXT RECORD               */ 03514000
         LA    RETCODE,4                                        02S1073 03515000
*             END;                                              02S1074 03516000
*         END;                                                  02S1075 03517000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 03518000
         B     CE0001@                                          02S1076 03519000
*     END S52;                      /* END OF SUBCASE                */ 03520000
*                                                               02S1078 03521000
*     /***************************************************************/ 03522000
*     /*                                                             */ 03523000
*     /* THIS ROUTINE WILL PROCESS SVC 66. THE FORMATTING CONSISTS OF*/ 03524000
*     /* THE BASIC RECORD + AN IOBERINF.                             */ 03525000
*     /*                                                             */ 03526000
*     /***************************************************************/ 03527000
*                                                               02S1078 03528000
*S66:                                                           02S1078 03529000
*     DO;                           /* SUBCASE                       */ 03530000
S66      DS    0H                                               02S1079 03531000
*       IF TIMESW=0 THEN            /* HAS SECOND LINE BEEN FORMATTED*/ 03532000
         SLR   @14,@14                                          02S1079 03533000
         CH    @14,TIMESW                                       02S1079 03534000
         BNE   @RF01079                                         02S1079 03535000
*         RETCODE=0;                /* NO - INDICATES TO PRINT BUFFER   03536000
*                                      AND RETURN FOR SECOND PASS    */ 03537000
         LR    RETCODE,@14                                      02S1080 03538000
*       ELSE                                                    02S1081 03539000
*         DO;                       /* YES - REGISTERS HAVE BEEN        03540000
*                                      FORMATTED                     */ 03541000
         B     @RC01079                                         02S1081 03542000
@RF01079 DS    0H                                               02S1082 03543000
*           IF TIMESW=1 THEN        /* HAS REMAINDER OF SECOND LINE     03544000
*                                      BEEN FORMATTED                */ 03545000
         CLC   TIMESW(2),@CH00046                               02S1082 03546000
         BNE   @RF01082                                         02S1082 03547000
*             DO;                   /* NO                            */ 03548000
*               DYNAMPTN(1:LENGTH(GP4S66))=GP4S66;/* MOVE PATTERNS TO   03549000
*                                      GETMAINED AREA                */ 03550000
         MVC   DYNAMPTN(17),GP4S66                              02S1084 03551000
*               IF IOBERR=ASTER16|IOBERR=PEES16|IOBERR=ESSES16 THEN/*   03552000
*                                      IS FIELD IN ERROR             */ 03553000
         LA    @14,46                                           02S1085 03554000
         AL    @14,DATAPTR(,PLISTPTR)                           02S1085 03555000
         CLC   IOBERR(16,@14),ASTER16                           02S1085 03556000
         BE    @RT01085                                         02S1085 03557000
         CLC   IOBERR(16,@14),PEES16                            02S1085 03558000
         BE    @RT01085                                         02S1085 03559000
         CLC   IOBERR(16,@14),ESSES16                           02S1085 03560000
         BNE   @RF01085                                         02S1085 03561000
@RT01085 DS    0H                                               02S1086 03562000
*                 DO;               /* YES                           */ 03563000
*                   OLDFLG(1)=OLDFLG(1)|CHARFLAG;/* INDICATE DATA IN    03564000
*                                      EBCDIC                        */ 03565000
         LA    @14,32                                           02S1087 03566000
         SLR   @07,@07                                          02S1087 03567000
         IC    @07,OLDFLG                                       02S1087 03568000
         OR    @07,@14                                          02S1087 03569000
         STC   @07,OLDFLG                                       02S1087 03570000
*                   OLDFLG(2)=OLDFLG(2)|CHARFLAG;               02S1088 03571000
         SLR   @07,@07                                          02S1088 03572000
         IC    @07,OLDFLG+4                                     02S1088 03573000
         OR    @07,@14                                          02S1088 03574000
         STC   @07,OLDFLG+4                                     02S1088 03575000
*                   OLDFLG(3)=OLDFLG(3)|CHARFLAG;               02S1089 03576000
         SLR   @07,@07                                          02S1089 03577000
         IC    @07,OLDFLG+8                                     02S1089 03578000
         OR    @07,@14                                          02S1089 03579000
         STC   @07,OLDFLG+8                                     02S1089 03580000
*                   OLDFLG(4)=OLDFLG(4)|CHARFLAG;               02S1090 03581000
         SLR   @07,@07                                          02S1090 03582000
         IC    @07,OLDFLG+12                                    02S1090 03583000
         OR    @14,@07                                          02S1090 03584000
         STC   @14,OLDFLG+12                                    02S1090 03585000
*                 END;                                          02S1091 03586000
*               ADPLFMT1=ADDR(GP4TYP21);/* ADDR OF LABELS FOR THIS      03587000
*                                      LINE                          */ 03588000
@RF01085 L     @14,ABDPLPTR(,PLISTPTR)                          02S1092 03589000
         LA    @07,GP4TYP21                                     02S1092 03590000
         ST    @07,ADPLFMT1(,@14)                               02S1092 03591000
*               ADPLFMT2=ADDR(IOBERR);/* ADDR OF DATA IN BUFFER      */ 03592000
         LA    @07,46                                           02S1093 03593000
         AL    @07,DATAPTR(,PLISTPTR)                           02S1093 03594000
         ST    @07,ADPLFMT2(,@14)                               02S1093 03595000
*               R0=ADDR(DYNAMPTN);  /* ADDR OF PATTERNS              */ 03596000
         LA    R0,DYNAMPTN                                      02S1094 03597000
*               CALL AMDPRFMT;      /* FORMAT THE LINE               */ 03598000
         L     @15,FMTADDR(,PLISTPTR)                           02S1095 03599000
         BALR  @14,@15                                          02S1095 03600000
*               RETCODE=4;          /* INDICATES TO PRINT BUFFER AND    03601000
*                                      GET NEXT RECORD               */ 03602000
         LA    RETCODE,4                                        02S1096 03603000
*             END;                                              02S1097 03604000
*         END;                                                  02S1098 03605000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 03606000
         B     CE0001@                                          02S1099 03607000
*     END S66;                      /* END OF SUBCASE                */ 03608000
*                                                               02S1101 03609000
*     /***************************************************************/ 03610000
*     /*                                                             */ 03611000
*     /* THIS ROUTINE WILL PROCESS SVC 71. THE FORMATTING CONSISTS OF*/ 03612000
*     /* THE BASIC RECORD + A DDNAME + A 16 BYTE PLIST.              */ 03613000
*     /*                                                             */ 03614000
*     /***************************************************************/ 03615000
*                                                               02S1101 03616000
*S71:                                                           02S1101 03617000
*     DO;                           /* SUBCASE                       */ 03618000
S71      DS    0H                                               02S1102 03619000
*       IF TIMESW=0 THEN            /* IS THIS THE FIRST PASS        */ 03620000
         ICM   @14,3,TIMESW                                     02S1102 03621000
         BNZ   @RF01102                                         02S1102 03622000
*         DO;                       /* YES - FORMAT DDNAME           */ 03623000
*           ADPLFMT1=ADDR(LDDNL1);  /* ADDR OF LABEL FOR THIS FIELD  */ 03624000
         L     @14,ABDPLPTR(,PLISTPTR)                          02S1104 03625000
         LA    @07,LDDNL1                                       02S1104 03626000
         ST    @07,ADPLFMT1(,@14)                               02S1104 03627000
*           ADPLFMT2=ADDR(RCD71DDN);/* ADDR OF DDNAME IN RECORD      */ 03628000
         LA    @07,46                                           02S1105 03629000
         AL    @07,DATAPTR(,PLISTPTR)                           02S1105 03630000
         ST    @07,ADPLFMT2(,@14)                               02S1105 03631000
*           R0=ADDR(DDNLN1);        /* ADDR OF PATTERN FOR DDNAME    */ 03632000
         LA    R0,DDNLN1                                        02S1106 03633000
*           CALL AMDPRFMT;          /* FORMAT DDNAME ON FIRST LINE   */ 03634000
         L     @15,FMTADDR(,PLISTPTR)                           02S1107 03635000
         BALR  @14,@15                                          02S1107 03636000
*           RETCODE=0;              /* INDICATES TO PRINT BUFFER AND    03637000
*                                      RETURN FOR SECOND PASS        */ 03638000
         SLR   RETCODE,RETCODE                                  02S1108 03639000
*         END;                                                  02S1109 03640000
*       ELSE                                                    02S1110 03641000
*         DO;                       /* Z40KI3N                       */ 03642000
         B     @RC01102                                         02S1110 03643000
@RF01102 DS    0H                                               02S1111 03644000
*           IF TIMESW=1 THEN        /* IF SECOND PASS        @Z40KI3N*/ 03645000
         CLC   TIMESW(2),@CH00046                               02S1111 03646000
         BNE   @RF01111                                         02S1111 03647000
*             DO;                   /* NO - FORMAT REGS AND REMAINING   03648000
*                                      FIELDS                        */ 03649000
*               DYNAMPTN(1:LENGTH(GP4S21))=GP4S21;/* MOVE PATTERNS TO   03650000
*                                      GETMAINED AREA                */ 03651000
         MVC   DYNAMPTN(17),GP4S21                              02S1113 03652000
*               IF RCD71LST=ASTER12|RCD71LST=PEES12|RCD71LST=ESSES12    03653000
*                 THEN              /* IS FIELD IN ERROR             */ 03654000
         LA    @14,46                                           02S1114 03655000
         AL    @14,DATAPTR(,PLISTPTR)                           02S1114 03656000
         CLC   RCD71LST(12,@14),ASTER12                         02S1114 03657000
         BE    @RT01114                                         02S1114 03658000
         CLC   RCD71LST(12,@14),PEES12                          02S1114 03659000
         BE    @RT01114                                         02S1114 03660000
         CLC   RCD71LST(12,@14),ESSES12                         02S1114 03661000
         BNE   @RF01114                                         02S1114 03662000
@RT01114 DS    0H                                               02S1115 03663000
*                 DO;               /* YES                           */ 03664000
*                   OLDFLG(1)=OLDFLG(1)|CHARFLAG;/* INDICATE DATA IN    03665000
*                                      EBCDIC                        */ 03666000
         LA    @14,32                                           02S1116 03667000
         SLR   @05,@05                                          02S1116 03668000
         IC    @05,OLDFLG                                       02S1116 03669000
         OR    @05,@14                                          02S1116 03670000
         STC   @05,OLDFLG                                       02S1116 03671000
*                   OLDFLG(2)=OLDFLG(2)|CHARFLAG;               02S1117 03672000
         SLR   @05,@05                                          02S1117 03673000
         IC    @05,OLDFLG+4                                     02S1117 03674000
         OR    @05,@14                                          02S1117 03675000
         STC   @05,OLDFLG+4                                     02S1117 03676000
*                   OLDFLG(3)=OLDFLG(3)|CHARFLAG;               02S1118 03677000
         SLR   @05,@05                                          02S1118 03678000
         IC    @05,OLDFLG+8                                     02S1118 03679000
         OR    @05,@14                                          02S1118 03680000
         STC   @05,OLDFLG+8                                     02S1118 03681000
*                   OLDFLG(4)=OLDFLG(4)|CHARFLAG;               02S1119 03682000
         SLR   @05,@05                                          02S1119 03683000
         IC    @05,OLDFLG+12                                    02S1119 03684000
         OR    @14,@05                                          02S1119 03685000
         STC   @14,OLDFLG+12                                    02S1119 03686000
*                 END;                                          02S1120 03687000
*               ADPLFMT1=ADDR(GROUP2);/* ADDR OF LABEL FOR THIS LINE */ 03688000
@RF01114 L     @14,ABDPLPTR(,PLISTPTR)                          02S1121 03689000
         LA    @05,GROUP2                                       02S1121 03690000
         ST    @05,ADPLFMT1(,@14)                               02S1121 03691000
*               ADPLFMT2=ADDR(RCD71LST);/* ADDR OF DATA FOR THIS LINE*/ 03692000
         L     @05,DATAPTR(,PLISTPTR)                           02S1122 03693000
         LA    @05,RCD71LST+46(,@05)                            02S1122 03694000
         ST    @05,ADPLFMT2(,@14)                               02S1122 03695000
*               R0=ADDR(DYNAMPTN);  /* ADDR OF PATTERNS FOR THIS LINE*/ 03696000
         LA    R0,DYNAMPTN                                      02S1123 03697000
*               CALL AMDPRFMT;      /* FORMAT LINE                   */ 03698000
         L     @15,FMTADDR(,PLISTPTR)                           02S1124 03699000
         BALR  @14,@15                                          02S1124 03700000
*               IF SVCNUMBR=82&(LSVC81R='006E'X|LSVC81R='0076'X) THEN   03701000
         CH    SVCNUMBR,@CH01327                                02S1125 03702000
         BNE   @RF01125                                         02S1125 03703000
         L     @14,RECPTR(,PLISTPTR)                            02S1125 03704000
         CLC   LSVC81R(2,@14),@CB01430                          02S1125 03705000
         BE    @RT01125                                         02S1125 03706000
         CLC   LSVC81R(2,@14),@CB01431                          02S1125 03707000
         BNE   @RF01125                                         02S1125 03708000
@RT01125 DS    0H                                               02S1126 03709000
*                                   /*                       @Z40KI3N*/ 03710000
*                                                               02S1126 03711000
*                 /***************************************************/ 03712000
*                 /*                                                 */ 03713000
*                 /* IF SVC 81 AND LONG PLIST                @Z40KI3N*/ 03714000
*                 /*                                                 */ 03715000
*                 /***************************************************/ 03716000
*                                                               02S1126 03717000
*                 RETCODE=0;        /* RETURN FOR ANOTHER PASS  02S1126 03718000
*                                                            @Z40KI3N*/ 03719000
         SLR   RETCODE,RETCODE                                  02S1126 03720000
*               ELSE                /* IF SVC71 OR 81 WITH SHORT        03721000
*                                      PLIST                 @Z40KI3N*/ 03722000
*                 RETCODE=4;        /* THIS IS LAST PASS     @Z40KI3N*/ 03723000
         B     @RC01125                                         02S1127 03724000
@RF01125 LA    RETCODE,4                                        02S1127 03725000
*             END;                  /*                       @Z40KI3N*/ 03726000
*           ELSE                    /* THIRD PASS FOR SVC81 WITH LG     03727000
*                                      PLIST ONLY            @Z40KI3N*/ 03728000
*             DO;                   /* FORMAT REMAINING 32 BYTES OF     03729000
*                                      PLIST                 @Z40KI3N*/ 03730000
         B     @RC01111                                         02S1129 03731000
@RF01111 DS    0H                                               02S1130 03732000
*               DYNAMPTN=GP4S21A;   /* MOVE FORMAT PATT TO GETMAIN      03733000
*                                      AREA                  @Z40KI3N*/ 03734000
         MVI   DYNAMPTN+33,C' '                                 02S1130 03735000
         MVC   DYNAMPTN+34(14),DYNAMPTN+33                      02S1130 03736000
         MVC   DYNAMPTN(33),GP4S21A                             02S1130 03737000
*               ADPLFMT2=ADDR(RCD81LNG);/* ADDR OF REMAINING PLIST      03738000
*                                      BYTES                 @Z40KI3N*/ 03739000
         L     @14,ABDPLPTR(,PLISTPTR)                          02S1131 03740000
         L     @07,DATAPTR(,PLISTPTR)                           02S1131 03741000
         LA    @07,RCD81LNG+46(,@07)                            02S1131 03742000
         ST    @07,ADPLFMT2(,@14)                               02S1131 03743000
*               R0=ADDR(DYNAMPTN);  /*                       @Z40KI3N*/ 03744000
         LA    R0,DYNAMPTN                                      02S1132 03745000
*               CALL AMDPRFMT;      /* FORMAT LINE           @Z40KI3N*/ 03746000
         L     @15,FMTADDR(,PLISTPTR)                           02S1133 03747000
         BALR  @14,@15                                          02S1133 03748000
*               RETCODE=4;          /* PRINT FINAL BUFFER AND GET       03749000
*                                      NEXT GTF RECORD       @Z40KI3N*/ 03750000
         LA    RETCODE,4                                        02S1134 03751000
*             END;                  /*                       @Z40KI3N*/ 03752000
*         END;                                                  02S1136 03753000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 03754000
         B     CE0001@                                          02S1137 03755000
*     END S71;                      /* END OF SUBCASE                */ 03756000
*                                                               02S1139 03757000
*     /***************************************************************/ 03758000
*     /*                                                             */ 03759000
*     /* THIS ROUTINE WILL PROCESS SVC 75. THE FORMATTING CONSISTS OF*/ 03760000
*     /* THE BASIC RECORD + A VARIABLE LENGTH IQE.                   */ 03761000
*     /*                                                             */ 03762000
*     /***************************************************************/ 03763000
*                                                               02S1139 03764000
*S75:                                                           02S1139 03765000
*     DO;                           /* SUBCASE                       */ 03766000
S75      DS    0H                                               02S1140 03767000
*       IF TIMESW=0 THEN            /* HAS SECOND LINE BEEN FORMATTED*/ 03768000
         SLR   @14,@14                                          02S1140 03769000
         CH    @14,TIMESW                                       02S1140 03770000
         BNE   @RF01140                                         02S1140 03771000
*         RETCODE=0;                /* NO - INDICATES TO PRINT BUFFER   03772000
*                                      AND RETURN FOR SECOND PASS    */ 03773000
         LR    RETCODE,@14                                      02S1141 03774000
*       ELSE                                                    02S1142 03775000
*         DO;                       /* YES - CHECK FIELDS FOR ERRORS    03776000
*                                      & FORMAT THEM                 */ 03777000
         B     @RC01140                                         02S1142 03778000
@RF01140 DS    0H                                               02S1143 03779000
*           DYNAMPTN(1:LENGTH(GP4S75A))=GP4S75A;/* MOVE PATTERNS TO     03780000
*                                      GETMAIN AREA                  */ 03781000
         MVC   DYNAMPTN(13),GP4S75A                             02S1143 03782000
*           R0=ADDR(DYNAMPTN);      /* ADDR OF PATTERNS FOR THIS LINE*/ 03783000
         LA    R0,DYNAMPTN                                      02S1144 03784000
*           IF RCD75LN=ERROR THEN   /* IS FIELD IN ERROR             */ 03785000
         L     @14,DATAPTR(,PLISTPTR)                           02S1145 03786000
         CLI   RCD75LN+46(@14),255                              02S1145 03787000
         BNE   @RF01145                                         02S1145 03788000
*             DO;                   /* YES                           */ 03789000
*               OLDFLG(1)=OLDFLG(1)|CHARFLAG;/* INDICATE DATA IN        03790000
*                                      EBCDIC                @YM03669*/ 03791000
         SLR   @14,@14                                          02S1147 03792000
         IC    @14,OLDFLG                                       02S1147 03793000
         O     @14,@CF00092                                     02S1147 03794000
         STC   @14,OLDFLG                                       02S1147 03795000
*               OLDFLG(2)=0;        /* INDICATE END OF PATTERNS      */ 03796000
         MVI   OLDFLG+4,X'00'                                   02S1148 03797000
*             END;                                              02S1149 03798000
*           ELSE                                                02S1150 03799000
*             DO;                   /* NO - CHECK DATA LENGTH FOR       03800000
*                                      ZERO                          */ 03801000
         B     @RC01145                                         02S1150 03802000
@RF01145 DS    0H                                               02S1151 03803000
*               IF RCD75LN=0 THEN   /* IS THERE ANY DATA             */ 03804000
         L     @14,DATAPTR(,PLISTPTR)                           02S1151 03805000
         CLI   RCD75LN+46(@14),0                                02S1151 03806000
         BNE   @RF01151                                         02S1151 03807000
*                 R0=ADDR(GP4S75B); /* NO - ADDR OF FORMAT PATTERNS     03808000
*                                      FOR THIS LINE                 */ 03809000
         LA    R0,GP4S75B                                       02S1152 03810000
*             END;                                              02S1153 03811000
@RF01151 DS    0H                                               02S1154 03812000
*           ADPLFMT1=ADDR(GP4TYP22);/* ADDR OF LABEL FOR THIS LINE   */ 03813000
@RC01145 L     @14,ABDPLPTR(,PLISTPTR)                          02S1154 03814000
         LA    @07,GP4TYP22                                     02S1154 03815000
         ST    @07,ADPLFMT1(,@14)                               02S1154 03816000
*           ADPLFMT2=ADDR(RCD75LN)+1;/* ADDR OF DATA IN BUFFER       */ 03817000
         LA    @07,47                                           02S1155 03818000
         AL    @07,DATAPTR(,PLISTPTR)                           02S1155 03819000
         ST    @07,ADPLFMT2(,@14)                               02S1155 03820000
*           CALL AMDPRFMT;          /* FORMAT LINE                   */ 03821000
         L     @15,FMTADDR(,PLISTPTR)                           02S1156 03822000
         BALR  @14,@15                                          02S1156 03823000
*           RETCODE=4;              /* INDICATES TO PRINT BUFFER AND    03824000
*                                      GET NEXT RECORD               */ 03825000
         LA    RETCODE,4                                        02S1157 03826000
*         END;                                                  02S1158 03827000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 03828000
         B     CE0001@                                          02S1159 03829000
*     END S75;                      /* END OF SUBCASE                */ 03830000
*                                                               02S1161 03831000
*     /***************************************************************/ 03832000
*     /*                                                             */ 03833000
*     /* THIS ROUTINE WILL PROCESS SVC 82. THE FORMATTING CONSISTS OF*/ 03834000
*     /* THE BASIC RECORD + A VOL-SER + A VARIABLE LENGTH TTR + A    */ 03835000
*     /* VARIABLE LENGTH PLIST.                                      */ 03836000
*     /*                                                             */ 03837000
*     /***************************************************************/ 03838000
*                                                               02S1161 03839000
*S82:                                                           02S1161 03840000
*     DO;                           /* SUBCASE                       */ 03841000
S82      DS    0H                                               02S1162 03842000
*       IF TIMESW=0 THEN            /* HAS SECOND LINE BEEN FORMATTED*/ 03843000
         SLR   @14,@14                                          02S1162 03844000
         CH    @14,TIMESW                                       02S1162 03845000
         BNE   @RF01162                                         02S1162 03846000
*         RETCODE=0;                /* NO - INDICATES TO PRINT BUFFER   03847000
*                                      AND RETURN FOR SECOND PASS    */ 03848000
         LR    RETCODE,@14                                      02S1163 03849000
*       ELSE                                                    02S1164 03850000
*         DO;                       /* YES - REGISTERS HAVE BEEN        03851000
*                                      FORMATTED                     */ 03852000
         B     @RC01162                                         02S1164 03853000
@RF01162 DS    0H                                               02S1165 03854000
*           IF TIMESW=1 THEN        /* HAS REMAINDER OF SECOND LINE     03855000
*                                      BEEN FORMATTED                */ 03856000
         CLC   TIMESW(2),@CH00046                               02S1165 03857000
         BNE   @RF01165                                         02S1165 03858000
*             DO;                   /* NO                            */ 03859000
*               ADPLFMT1=ADDR(GP4TYP23);/* ADDR OF LABEL FOR THIS       03860000
*                                      FIELD                         */ 03861000
         L     @14,ABDPLPTR(,PLISTPTR)                          02S1167 03862000
         LA    @07,GP4TYP23                                     02S1167 03863000
         ST    @07,ADPLFMT1(,@14)                               02S1167 03864000
*               ADPLFMT2=ADDR(VOLSER1);/* ADDR OF DATA IN BUFFER     */ 03865000
         LA    @07,46                                           02S1168 03866000
         AL    @07,DATAPTR(,PLISTPTR)                           02S1168 03867000
         ST    @07,ADPLFMT2(,@14)                               02S1168 03868000
*               R0=ADDR(GP4S82A);   /* ADDR OF PATTERNS              */ 03869000
         LA    R0,GP4S82A                                       02S1169 03870000
*               CALL AMDPRFMT;      /* FORMAT THE LINE               */ 03871000
         L     @15,FMTADDR(,PLISTPTR)                           02S1170 03872000
         BALR  @14,@15                                          02S1170 03873000
*               RETCODE=0;          /* INDICATES TO PRINT BUFFER AND    03874000
*                                      RETURN FOR THIRD PASS         */ 03875000
         SLR   RETCODE,RETCODE                                  02S1171 03876000
*             END;                                              02S1172 03877000
*           ELSE                                                02S1173 03878000
*             DO;                   /* YES - FORMAT THE THIRD LINE   */ 03879000
         B     @RC01165                                         02S1173 03880000
@RF01165 DS    0H                                               02S1174 03881000
*               DYNAMPTN(1:LENGTH(GP4S48B))=GP4S48B;/* MOVE PATTERNS    03882000
*                                      TO GETMAINED AREA             */ 03883000
         MVC   DYNAMPTN(21),GP4S48B                             02S1174 03884000
*               IF RCD82LN=ERROR THEN/* IS FIELD IN ERROR            */ 03885000
         LA    @14,46                                           02S1175 03886000
         AL    @14,DATAPTR(,PLISTPTR)                           02S1175 03887000
         CLI   RCD82LN(@14),255                                 02S1175 03888000
         BNE   @RF01175                                         02S1175 03889000
*                 DO;               /* YES                           */ 03890000
*                   OLDFLG(1)=OLDFLG(1)|CHARFLAG;/* INDICATE DATA IN    03891000
*                                      EBCDIC                        */ 03892000
         SLR   @07,@07                                          02S1177 03893000
         IC    @07,OLDFLG                                       02S1177 03894000
         O     @07,@CF00092                                     02S1177 03895000
         STC   @07,OLDFLG                                       02S1177 03896000
*                   OLDFLG(2)=0;    /* INDICATE END OF PATTERNS      */ 03897000
         MVI   OLDFLG+4,X'00'                                   02S1178 03898000
*                   RCD82LN=4;      /* MODIFY LENGTH IN ORDER TO        03899000
*                                      ACCESS NEXT FIELD             */ 03900000
         MVI   RCD82LN(@14),X'04'                               02S1179 03901000
*                 END;                                          02S1180 03902000
*               ELSE                                            02S1181 03903000
*                 DO;               /* NO - FORMAT 2, 3 OR 4 WORDS   */ 03904000
         B     @RC01175                                         02S1181 03905000
@RF01175 DS    0H                                               02S1182 03906000
*                   K=RCD82LN/4;    /* NUMBER OF WORDS               */ 03907000
         L     @14,DATAPTR(,PLISTPTR)                           02S1182 03908000
         SLR   K,K                                              02S1182 03909000
         IC    K,RCD82LN+46(,@14)                               02S1182 03910000
         SRL   K,2                                              02S1182 03911000
*                   OLDFLG(K+1)=0;  /* INDICATE END OF PATTERNS      */ 03912000
         LR    @14,K                                            02S1183 03913000
         SLA   @14,2                                            02S1183 03914000
         SLR   @07,@07                                          02S1183 03915000
         STC   @07,OLDFLG(@14)                                  02S1183 03916000
*                 END;                                          02S1184 03917000
*               R0=ADDR(DYNAMPTN);  /* ADDR OF PATTERNS FOR THIS LINE*/ 03918000
@RC01175 LA    R0,DYNAMPTN                                      02S1185 03919000
*               ADPLFMT1=ADDR(GROUP2);/* ADDR OF LABEL FOR THIS LINE */ 03920000
         L     @14,ABDPLPTR(,PLISTPTR)                          02S1186 03921000
         LA    @07,GROUP2                                       02S1186 03922000
         ST    @07,ADPLFMT1(,@14)                               02S1186 03923000
*               ADPLFMT2=ADDR(RCD82LN)+1;/* ADDR OF DATA IN BUFFER   */ 03924000
         L     @07,DATAPTR(,PLISTPTR)                           02S1187 03925000
         LA    @07,RCD82LN+46(,@07)                             02S1187 03926000
         AH    @07,@CH00046                                     02S1187 03927000
         ST    @07,ADPLFMT2(,@14)                               02S1187 03928000
*               CALL AMDPRFMT;      /* FORMAT THE LINE               */ 03929000
         L     @15,FMTADDR(,PLISTPTR)                           02S1188 03930000
         BALR  @14,@15                                          02S1188 03931000
*               DYNAMPTN(1:LENGTH(GP4S82B))=GP4S82B;/* MOVE PATTERNS    03932000
*                                      TO GETMAIN AREA               */ 03933000
         MVC   DYNAMPTN(9),GP4S82B                              02S1189 03934000
*               FIELDADR=ADDR(RCD82LN)+RCD82LN+1;/* ADDR OF TTR IN      03935000
*                                      BUFFER                        */ 03936000
         LA    @14,46                                           02S1190 03937000
         AL    @14,DATAPTR(,PLISTPTR)                           02S1190 03938000
         LA    @07,RCD82LN(,@14)                                02S1190 03939000
         SLR   @05,@05                                          02S1190 03940000
         IC    @05,RCD82LN(,@14)                                02S1190 03941000
         ALR   @07,@05                                          02S1190 03942000
         AH    @07,@CH00046                                     02S1190 03943000
         ST    @07,FIELDADR                                     02S1190 03944000
*               R0=ADDR(DYNAMPTN);  /* ADDR OF PATTERNS FOR THIS LINE*/ 03945000
         LA    R0,DYNAMPTN                                      02S1191 03946000
*               IF NXTFIELD=0 THEN  /* IS THERE ANY DATA             */ 03947000
         CLI   NXTFIELD(@07),0                                  02S1192 03948000
         BNE   @RF01192                                         02S1192 03949000
*                 R0=ADDR(GP4S82C); /* NO - ADDR OF PATTERNS FOR THIS   03950000
*                                      LINE                          */ 03951000
         LA    R0,GP4S82C                                       02S1193 03952000
*               ELSE                                            02S1194 03953000
*                 DO;               /* YES - CHECK FOR ERROR         */ 03954000
         B     @RC01192                                         02S1194 03955000
@RF01192 DS    0H                                               02S1195 03956000
*                   IF NXTFIELD=ERROR THEN/* IS FIELD IN ERROR       */ 03957000
         L     @14,FIELDADR                                     02S1195 03958000
         CLI   NXTFIELD(@14),255                                02S1195 03959000
         BNE   @RF01195                                         02S1195 03960000
*                     DO;           /* YES                           */ 03961000
*                       OLDLN(1)=OLDLN(1)&DATAOFF;/* SET DATA LENGTH    03962000
*                                      TO 0                          */ 03963000
         SLR   @14,@14                                          02S1197 03964000
         IC    @14,OLDLN                                        02S1197 03965000
         N     @14,@CF00297                                     02S1197 03966000
         STC   @14,OLDLN                                        02S1197 03967000
*                       OLDLN(1)=OLDLN(1)|(4-1);/* LENGTH OF 4 TO       03968000
*                                      FORMAT ERROR INDICATOR        */ 03969000
         O     @14,@CF00170                                     02S1198 03970000
         STC   @14,OLDLN                                        02S1198 03971000
*                       OLDFLG(1)=OLDFLG(1)|CHARFLAG;/* INDICATE DATA   03972000
*                                      IN EBCDIC                     */ 03973000
         SLR   @14,@14                                          02S1199 03974000
         IC    @14,OLDFLG                                       02S1199 03975000
         O     @14,@CF00092                                     02S1199 03976000
         STC   @14,OLDFLG                                       02S1199 03977000
*                       OLDFLG(2)=0;/* INDICATE END OF PATTERNS      */ 03978000
         MVI   OLDFLG+4,X'00'                                   02S1200 03979000
*                     END;                                      02S1201 03980000
*                   ELSE                                        02S1202 03981000
*                     DO;           /* NO - FIELD IS OK              */ 03982000
         B     @RC01195                                         02S1202 03983000
@RF01195 DS    0H                                               02S1203 03984000
*                       IF NXTFIELD^=8 THEN/* IS ENTIRE TTR THERE    */ 03985000
         L     @14,FIELDADR                                     02S1203 03986000
         CLI   NXTFIELD(@14),8                                  02S1203 03987000
         BE    @RF01203                                         02S1203 03988000
*                         OLDFLG(2)=0;/* INDICATE END OF PATTERNS    */ 03989000
         MVI   OLDFLG+4,X'00'                                   02S1204 03990000
*                     END;                                      02S1205 03991000
@RF01203 DS    0H                                               02S1206 03992000
*                 END;                                          02S1206 03993000
@RC01195 DS    0H                                               02S1207 03994000
*               ADPLFMT1=ADDR(GP4TP23A);/* ADDR OF LABEL FOR THIS       03995000
*                                      LINE                          */ 03996000
@RC01192 L     @14,ABDPLPTR(,PLISTPTR)                          02S1207 03997000
         LA    @07,GP4TP23A                                     02S1207 03998000
         ST    @07,ADPLFMT1(,@14)                               02S1207 03999000
*               ADPLFMT2=FIELDADR+1;/* ADDR OF DATA IN BUFFER        */ 04000000
         LA    @07,1                                            02S1208 04001000
         AL    @07,FIELDADR                                     02S1208 04002000
         ST    @07,ADPLFMT2(,@14)                               02S1208 04003000
*               CALL AMDPRFMT;      /* FORMAT THE LINE               */ 04004000
         L     @15,FMTADDR(,PLISTPTR)                           02S1209 04005000
         BALR  @14,@15                                          02S1209 04006000
*               RETCODE=4;          /* INDICATES TO PRINT BUFFER AND    04007000
*                                      GET NEXT RECORD               */ 04008000
         LA    RETCODE,4                                        02S1210 04009000
*             END;                                              02S1211 04010000
*         END;                                                  02S1212 04011000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 04012000
         B     CE0001@                                          02S1213 04013000
*     END S82;                      /* END OF SUBCASE                */ 04014000
*                                                               02S1215 04015000
*     /***************************************************************/ 04016000
*     /*                                                             */ 04017000
*     /* THIS ROUTINE WILL PROCESS SVC 86. THE FORMATTING CONSISTS OF*/ 04018000
*     /* THE BASIC RECORD + AN 8 BYTE PLIST + A TTR.                 */ 04019000
*     /*                                                             */ 04020000
*     /***************************************************************/ 04021000
*                                                               02S1215 04022000
*S86:                                                           02S1215 04023000
*     DO;                           /* SUBCASE                       */ 04024000
S86      DS    0H                                               02S1216 04025000
*       IF TIMESW=0 THEN            /* HAS SECOND LINE BEEN FORMATTED*/ 04026000
         SLR   @14,@14                                          02S1216 04027000
         CH    @14,TIMESW                                       02S1216 04028000
         BNE   @RF01216                                         02S1216 04029000
*         RETCODE=0;                /* NO - INDICATES TO PRINT BUFFER   04030000
*                                      AND RETURN FOR SECOND PASS    */ 04031000
         LR    RETCODE,@14                                      02S1217 04032000
*       ELSE                                                    02S1218 04033000
*         DO;                       /* YES - FORMAT REMAINING FIELDS */ 04034000
         B     @RC01216                                         02S1218 04035000
@RF01216 DS    0H                                               02S1219 04036000
*           DYNAMPTN(1:LENGTH(GP4S86))=GP4S86;/* MOVE PATTERNS TO       04037000
*                                      GETMAINED AREA                */ 04038000
         MVC   DYNAMPTN(13),GP4S86                              02S1219 04039000
*           IF RCD86LST=ASTER8|RCD86LST=PEES8|RCD86LST=ESSES8 THEN/*    04040000
*                                      IS FIELD IN ERROR             */ 04041000
         LA    @14,46                                           02S1220 04042000
         AL    @14,DATAPTR(,PLISTPTR)                           02S1220 04043000
         CLC   RCD86LST(8,@14),ASTER8                           02S1220 04044000
         BE    @RT01220                                         02S1220 04045000
         CLC   RCD86LST(8,@14),PEES8                            02S1220 04046000
         BE    @RT01220                                         02S1220 04047000
         CLC   RCD86LST(8,@14),ESSES8                           02S1220 04048000
         BNE   @RF01220                                         02S1220 04049000
@RT01220 DS    0H                                               02S1221 04050000
*             DO;                   /* YES                           */ 04051000
*               OLDFLG(1)=OLDFLG(1)|CHARFLAG;/* INDICATE DATA IN        04052000
*                                      EBCDIC                        */ 04053000
         LA    @14,32                                           02S1222 04054000
         SLR   @07,@07                                          02S1222 04055000
         IC    @07,OLDFLG                                       02S1222 04056000
         OR    @07,@14                                          02S1222 04057000
         STC   @07,OLDFLG                                       02S1222 04058000
*               OLDFLG(2)=OLDFLG(2)|CHARFLAG;                   02S1223 04059000
         SLR   @07,@07                                          02S1223 04060000
         IC    @07,OLDFLG+4                                     02S1223 04061000
         OR    @14,@07                                          02S1223 04062000
         STC   @14,OLDFLG+4                                     02S1223 04063000
*             END;                                              02S1224 04064000
*           IF TTR=ASTER5|TTR=PEES5|TTR=ESSES5 THEN/* IS FIELD IN       04065000
*                                      ERROR                         */ 04066000
@RF01220 LA    @14,46                                           02S1225 04067000
         AL    @14,DATAPTR(,PLISTPTR)                           02S1225 04068000
         CLC   TTR(5,@14),ASTER5                                02S1225 04069000
         BE    @RT01225                                         02S1225 04070000
         CLC   TTR(5,@14),PEES5                                 02S1225 04071000
         BE    @RT01225                                         02S1225 04072000
         CLC   TTR(5,@14),ESSES5                                02S1225 04073000
         BNE   @RF01225                                         02S1225 04074000
@RT01225 DS    0H                                               02S1226 04075000
*             OLDFLG(3)=OLDFLG(3)|CHARFLAG;/* INDICATE DATA IN EBCDIC*/ 04076000
         SLR   @14,@14                                          02S1226 04077000
         IC    @14,OLDFLG+8                                     02S1226 04078000
         O     @14,@CF00092                                     02S1226 04079000
         STC   @14,OLDFLG+8                                     02S1226 04080000
*           ADPLFMT1=ADDR(GP4TYP24);/* ADDR OF LABELS FOR THIS LINE  */ 04081000
@RF01225 L     @14,ABDPLPTR(,PLISTPTR)                          02S1227 04082000
         LA    @07,GP4TYP24                                     02S1227 04083000
         ST    @07,ADPLFMT1(,@14)                               02S1227 04084000
*           ADPLFMT2=ADDR(RCD86LST);/* ADDR OF DATA IN BUFFER        */ 04085000
         LA    @07,46                                           02S1228 04086000
         AL    @07,DATAPTR(,PLISTPTR)                           02S1228 04087000
         ST    @07,ADPLFMT2(,@14)                               02S1228 04088000
*           R0=ADDR(DYNAMPTN);      /* ADDR OF PATTERNS FOR THIS LINE*/ 04089000
         LA    R0,DYNAMPTN                                      02S1229 04090000
*           CALL AMDPRFMT;          /* FORMAT LINE                   */ 04091000
         L     @15,FMTADDR(,PLISTPTR)                           02S1230 04092000
         BALR  @14,@15                                          02S1230 04093000
*           RETCODE=4;              /* INDICATES TO PRINT BUFFER AND    04094000
*                                      GET NEXT RECORD               */ 04095000
         LA    RETCODE,4                                        02S1231 04096000
*         END;                                                  02S1232 04097000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 04098000
         B     CE0001@                                          02S1233 04099000
*     END S86;                      /* END OF SUBCASE                */ 04100000
*                                                               02S1235 04101000
*     /***************************************************************/ 04102000
*     /*                                                             */ 04103000
*     /* THIS ROUTINE WILL PROCESS SVC 88. THE FORMATTING CONSISTS OF*/ 04104000
*     /* THE BASIC RECORD + A DEB ADDR + A DSSTAT + A DEVMOD.        */ 04105000
*     /*                                                             */ 04106000
*     /***************************************************************/ 04107000
*                                                               02S1235 04108000
*S88:                                                           02S1235 04109000
*     DO;                           /* SUBCASE                       */ 04110000
S88      DS    0H                                               02S1236 04111000
*       IF TIMESW=0 THEN            /* HAS SECOND LINE BEEN FORMATTED*/ 04112000
         SLR   @14,@14                                          02S1236 04113000
         CH    @14,TIMESW                                       02S1236 04114000
         BNE   @RF01236                                         02S1236 04115000
*         RETCODE=0;                /* NO - INDICATES TO PRINT BUFFER   04116000
*                                      AND RETURN FOR SECOND PASS    */ 04117000
         LR    RETCODE,@14                                      02S1237 04118000
*       ELSE                                                    02S1238 04119000
*         DO;                       /* YES - CHECK FIELDS FOR ERRORS    04120000
*                                      & FORMAT THEM                 */ 04121000
         B     @RC01236                                         02S1238 04122000
@RF01236 DS    0H                                               02S1239 04123000
*           DYNAMPTN(1:LENGTH(GP4S88))=GP4S88;/* MOVE PATTERNS TO       04124000
*                                      GETMAINED AREA                */ 04125000
         MVC   DYNAMPTN(13),GP4S88                              02S1239 04126000
*           IF RCD88DEB=ASTER4|RCD88DEB=PEES4|RCD88DEB=ESSES4 THEN/*    04127000
*                                      IS FIELD IN ERROR             */ 04128000
         LA    @14,46                                           02S1240 04129000
         AL    @14,DATAPTR(,PLISTPTR)                           02S1240 04130000
         CLC   RCD88DEB(4,@14),ASTER4                           02S1240 04131000
         BE    @RT01240                                         02S1240 04132000
         CLC   RCD88DEB(4,@14),PEES4                            02S1240 04133000
         BE    @RT01240                                         02S1240 04134000
         CLC   RCD88DEB(4,@14),ESSES4                           02S1240 04135000
         BNE   @RF01240                                         02S1240 04136000
@RT01240 DS    0H                                               02S1241 04137000
*             OLDFLG(1)=OLDFLG(1)|CHARFLAG;/* YES - INDICATE DATA IN    04138000
*                                      EBCDIC                        */ 04139000
         SLR   @14,@14                                          02S1241 04140000
         IC    @14,OLDFLG                                       02S1241 04141000
         O     @14,@CF00092                                     02S1241 04142000
         STC   @14,OLDFLG                                       02S1241 04143000
*           IF DSSTAT=ASTER1|DSSTAT=PEES1|DSSTAT=ESSES1 THEN/* IS       04144000
*                                      FIELD IN ERROR                */ 04145000
@RF01240 LA    @14,46                                           02S1242 04146000
         AL    @14,DATAPTR(,PLISTPTR)                           02S1242 04147000
         CLC   DSSTAT(1,@14),ASTER1                             02S1242 04148000
         BE    @RT01242                                         02S1242 04149000
         CLC   DSSTAT(1,@14),PEES1                              02S1242 04150000
         BE    @RT01242                                         02S1242 04151000
         CLC   DSSTAT(1,@14),ESSES1                             02S1242 04152000
         BNE   @RF01242                                         02S1242 04153000
@RT01242 DS    0H                                               02S1243 04154000
*             OLDFLG(2)=OLDFLG(2)|CHARFLAG;/* YES - INDICATE DATA IN    04155000
*                                      EBCDIC                        */ 04156000
         SLR   @14,@14                                          02S1243 04157000
         IC    @14,OLDFLG+4                                     02S1243 04158000
         O     @14,@CF00092                                     02S1243 04159000
         STC   @14,OLDFLG+4                                     02S1243 04160000
*           IF DEVMOD=ASTER1|DEVMOD=PEES1|DEVMOD=ESSES1 THEN/* IS       04161000
*                                      FIELD IN ERROR                */ 04162000
@RF01242 LA    @14,46                                           02S1244 04163000
         AL    @14,DATAPTR(,PLISTPTR)                           02S1244 04164000
         CLC   DEVMOD(1,@14),ASTER1                             02S1244 04165000
         BE    @RT01244                                         02S1244 04166000
         CLC   DEVMOD(1,@14),PEES1                              02S1244 04167000
         BE    @RT01244                                         02S1244 04168000
         CLC   DEVMOD(1,@14),ESSES1                             02S1244 04169000
         BNE   @RF01244                                         02S1244 04170000
@RT01244 DS    0H                                               02S1245 04171000
*             OLDFLG(3)=OLDFLG(3)|CHARFLAG;/* YES - INDICATE DATA IN    04172000
*                                      EBCDIC                        */ 04173000
         SLR   @14,@14                                          02S1245 04174000
         IC    @14,OLDFLG+8                                     02S1245 04175000
         O     @14,@CF00092                                     02S1245 04176000
         STC   @14,OLDFLG+8                                     02S1245 04177000
*           ADPLFMT1=ADDR(GP4TYP14);/* ADDR OF LABELS FOR THIS LINE  */ 04178000
@RF01244 L     @14,ABDPLPTR(,PLISTPTR)                          02S1246 04179000
         LA    @07,GP4TYP14                                     02S1246 04180000
         ST    @07,ADPLFMT1(,@14)                               02S1246 04181000
*           ADPLFMT2=ADDR(RCD88DEB);/* ADDR OF DATA IN BUFFER        */ 04182000
         LA    @07,46                                           02S1247 04183000
         AL    @07,DATAPTR(,PLISTPTR)                           02S1247 04184000
         ST    @07,ADPLFMT2(,@14)                               02S1247 04185000
*           R0=ADDR(DYNAMPTN);      /* ADDR OF PATTERNS              */ 04186000
         LA    R0,DYNAMPTN                                      02S1248 04187000
*           CALL AMDPRFMT;          /* FORMAT THE LINE               */ 04188000
         L     @15,FMTADDR(,PLISTPTR)                           02S1249 04189000
         BALR  @14,@15                                          02S1249 04190000
*           RETCODE=4;              /* INDICATES TO PRINT BUFFER AND    04191000
*                                      GET NEXT RECORD               */ 04192000
         LA    RETCODE,4                                        02S1250 04193000
*         END;                                                  02S1251 04194000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 04195000
         B     CE0001@                                          02S1252 04196000
*     END S88;                      /* END OF SUBCASE                */ 04197000
*                                                               02S1254 04198000
*     /***************************************************************/ 04199000
*     /*                                                             */ 04200000
*     /* THIS ROUTINE WILL PROCESS SVC 98. THE FORMATTING CONSISTS OF*/ 04201000
*     /* THE BASIC RECORD + A 4 BYTE PLIST + A VARIABLE LENGTH       */ 04202000
*     /* DSNAME.                                                     */ 04203000
*     /*                                                             */ 04204000
*     /***************************************************************/ 04205000
*                                                               02S1254 04206000
*S98:                                                           02S1254 04207000
*     DO;                           /* SUBCASE                       */ 04208000
S98      DS    0H                                               02S1255 04209000
*       IF TIMESW=0 THEN            /* HAS SECOND LINE BEEN FORMATTED*/ 04210000
         SLR   @14,@14                                          02S1255 04211000
         CH    @14,TIMESW                                       02S1255 04212000
         BNE   @RF01255                                         02S1255 04213000
*         RETCODE=0;                /* NO - INDICATES TO PRINT BUFFER   04214000
*                                      AND RETURN FOR SECOND PASS    */ 04215000
         LR    RETCODE,@14                                      02S1256 04216000
*       ELSE                                                    02S1257 04217000
*         DO;                       /* YES - REGISTERS HAVE BEEN        04218000
*                                      FORMATTED                     */ 04219000
         B     @RC01255                                         02S1257 04220000
@RF01255 DS    0H                                               02S1258 04221000
*           DYNAMPTN(1:LENGTH(GP4S98))=GP4S98;/* MOVE PATTERNS TO       04222000
*                                      GETMAINED AREA                */ 04223000
         MVC   DYNAMPTN(21),GP4S98                              02S1258 04224000
*           IF RCD98LST=ASTER4|RCD98LST=PEES4|RCD98LST=ESSES4 THEN/*    04225000
*                                      IS FIELD IN ERROR             */ 04226000
         LA    @14,46                                           02S1259 04227000
         AL    @14,DATAPTR(,PLISTPTR)                           02S1259 04228000
         CLC   RCD98LST(4,@14),ASTER4                           02S1259 04229000
         BE    @RT01259                                         02S1259 04230000
         CLC   RCD98LST(4,@14),PEES4                            02S1259 04231000
         BE    @RT01259                                         02S1259 04232000
         CLC   RCD98LST(4,@14),ESSES4                           02S1259 04233000
         BNE   @RF01259                                         02S1259 04234000
@RT01259 DS    0H                                               02S1260 04235000
*             DO;                   /* YES                           */ 04236000
*               OLDFLG(1)=OLDFLG(1)|CHARFLAG;/* INDICATE DATA IN        04237000
*                                      EBCDIC                        */ 04238000
         SLR   @14,@14                                          02S1261 04239000
         IC    @14,OLDFLG                                       02S1261 04240000
         O     @14,@CF00092                                     02S1261 04241000
         STC   @14,OLDFLG                                       02S1261 04242000
*             END;                                              02S1262 04243000
*           IF RCD98LN^=ERROR THEN  /* IS FIELD IN ERROR             */ 04244000
@RF01259 LA    @14,46                                           02S1263 04245000
         AL    @14,DATAPTR(,PLISTPTR)                           02S1263 04246000
         CLI   RCD98LN(@14),255                                 02S1263 04247000
         BE    @RF01263                                         02S1263 04248000
*             DO;                   /* NO-CHECK DATA LENGTH FOR ZERO */ 04249000
*               IF RCD98LN=0 THEN   /* IS THERE ANY DATA     @YM03669*/ 04250000
         CLI   RCD98LN(@14),0                                   02S1265 04251000
         BNE   @RF01265                                         02S1265 04252000
*                 DO;               /* NO                    @YM03669*/ 04253000
*                   OLDFLG(3)=OLDFLG(3)&DATAFLAG;/* INDICATE NO DATA    04254000
*                                                            @YM03669*/ 04255000
         SLR   @14,@14                                          02S1267 04256000
         IC    @14,OLDFLG+8                                     02S1267 04257000
         N     @14,@CF00295                                     02S1267 04258000
         STC   @14,OLDFLG+8                                     02S1267 04259000
*                   OLDLN(3)=96;    /* NEW LABEL LENGTH ((7-1)*16)      04260000
*                                      AND ZERO DATA LENGTH  @YM03669*/ 04261000
         MVI   OLDLN+8,X'60'                                    02S1268 04262000
*                   OLDFLG(4)=0;    /* INDICATE END OF PATTERNS 02S1269 04263000
*                                                            @YM03669*/ 04264000
         MVI   OLDFLG+12,X'00'                                  02S1269 04265000
*                 END;              /*                       @YM03669*/ 04266000
*               ELSE                /*                       @YM03669*/ 04267000
*                 DO;               /* YES - THERE IS DATA   @YM03669*/ 04268000
         B     @RC01265                                         02S1271 04269000
@RF01265 DS    0H                                               02S1272 04270000
*                   IF RCD98LN^=44 THEN/* IS DSN MAX LENGTH          */ 04271000
         LA    @14,46                                           02S1272 04272000
         AL    @14,DATAPTR(,PLISTPTR)                           02S1272 04273000
         CLI   RCD98LN(@14),44                                  02S1272 04274000
         BE    @RF01272                                         02S1272 04275000
*                     DO;           /* NO                            */ 04276000
*                       K=RCD98LN/16;/* NUMBER OF FULL WORDS         */ 04277000
         SLR   @05,@05                                          02S1274 04278000
         IC    @05,RCD98LN(,@14)                                02S1274 04279000
         LR    K,@05                                            02S1274 04280000
         SRL   K,4                                              02S1274 04281000
*                       MOD=RCD98LN//16;/* REMAINDER OF PARTIAL WORD */ 04282000
         LR    @02,@05                                          02S1275 04283000
         SRDA  @02,32                                           02S1275 04284000
         D     @02,@CF00139                                     02S1275 04285000
         LR    MOD,@02                                          02S1275 04286000
*                       IF MOD=0 THEN/* ARE ALL FULL WORDS           */ 04287000
         SLR   @14,@14                                          02S1276 04288000
         CR    MOD,@14                                          02S1276 04289000
         BNE   @RF01276                                         02S1276 04290000
*                         OLDFLG(K+3)=0;/* YES - INDICATE END OF        04291000
*                                      PATTERNS                      */ 04292000
         LR    @07,K                                            02S1277 04293000
         SLA   @07,2                                            02S1277 04294000
         STC   @14,OLDFLG+8(@07)                                02S1277 04295000
*                       ELSE                                    02S1278 04296000
*                         DO;       /* NO - MODIFY PATTERNS     02S1278 04297000
*                                      ACCORDINGLY                   */ 04298000
         B     @RC01276                                         02S1278 04299000
@RF01276 DS    0H                                               02S1279 04300000
*                           OLDLN(K+3)=OLDLN(K+3)&DATAOFF;/* SET DATA   04301000
*                                      LENGTH TO ZERO                */ 04302000
         LR    @14,K                                            02S1279 04303000
         SLA   @14,2                                            02S1279 04304000
         SLR   @05,@05                                          02S1279 04305000
         IC    @05,OLDLN+8(@14)                                 02S1279 04306000
         N     @05,@CF00297                                     02S1279 04307000
         STC   @05,OLDLN+8(@14)                                 02S1279 04308000
*                           OLDLN(K+3)=OLDLN(K+3)|(MOD-1);/* NEW DATA   04309000
*                                      LENGTH                        */ 04310000
         LR    @03,MOD                                          02S1280 04311000
         BCTR  @03,0                                            02S1280 04312000
         OR    @05,@03                                          02S1280 04313000
         STC   @05,OLDLN+8(@14)                                 02S1280 04314000
*                           OLDFLG(K+4)=0;/* INDICATE END OF PATTERNS*/ 04315000
         SLR   @07,@07                                          02S1281 04316000
         STC   @07,OLDFLG+12(@14)                               02S1281 04317000
*                         END;                                  02S1282 04318000
*                     END;                                      02S1283 04319000
*                 END;              /*                       @YM03669*/ 04320000
*             END;                                              02S1285 04321000
*           ELSE                                                02S1286 04322000
*             DO;                   /* YES - FIELD IS IN ERROR       */ 04323000
         B     @RC01263                                         02S1286 04324000
@RF01263 DS    0H                                               02S1287 04325000
*               OLDLN(3)=OLDLN(3)&DATAOFF;/* ZERO DATA LENGTH        */ 04326000
         SLR   @14,@14                                          02S1287 04327000
         IC    @14,OLDLN+8                                      02S1287 04328000
         N     @14,@CF00297                                     02S1287 04329000
         STC   @14,OLDLN+8                                      02S1287 04330000
*               OLDLN(3)=OLDLN(3)|DATALN4;/* SET DATA LENGTH TO 02S1288 04331000
*                                      FORMAT 4 BYTES                */ 04332000
         O     @14,@CF00170                                     02S1288 04333000
         STC   @14,OLDLN+8                                      02S1288 04334000
*               OLDFLG(4)=0;        /* INDICATE END OF PATTERNS      */ 04335000
         MVI   OLDFLG+12,X'00'                                  02S1289 04336000
*             END;                                              02S1290 04337000
*           ADPLFMT1=ADDR(GP4TYP19);/* ADDR OF LABELS FOR THIS LINE  */ 04338000
@RC01263 L     @14,ABDPLPTR(,PLISTPTR)                          02S1291 04339000
         LA    @07,GP4TYP19                                     02S1291 04340000
         ST    @07,ADPLFMT1(,@14)                               02S1291 04341000
*           ADPLFMT2=ADDR(RCD98LST);/* ADDR OF DATA IN BUFFER        */ 04342000
         LA    @07,46                                           02S1292 04343000
         AL    @07,DATAPTR(,PLISTPTR)                           02S1292 04344000
         ST    @07,ADPLFMT2(,@14)                               02S1292 04345000
*           R0=ADDR(DYNAMPTN);      /* ADDR OF PATTERNS              */ 04346000
         LA    R0,DYNAMPTN                                      02S1293 04347000
*           CALL AMDPRFMT;          /* FORMAT THE LINE               */ 04348000
         L     @15,FMTADDR(,PLISTPTR)                           02S1294 04349000
         BALR  @14,@15                                          02S1294 04350000
*           RETCODE=4;              /* INDICATES TO PRINT BUFFER AND    04351000
*                                      GET NEXT RECORD               */ 04352000
         LA    RETCODE,4                                        02S1295 04353000
*         END;                                                  02S1296 04354000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 04355000
         B     CE0001@                                          02S1297 04356000
*     END S98;                      /* END OF SUBCASE                */ 04357000
*CE0001@:                                                       02S1299 04358000
*   END;                            /* END OF CASE                   */ 04359000
*                                                               02S1299 04360000
CE0001@  DS    0H                                               02S1300 04361000
*   /*****************************************************************/ 04362000
*   /*                                                               */ 04363000
*   /* RETURN TO CALLER WITH RETURN CODE IN REGISTER 15.             */ 04364000
*   /*                                                               */ 04365000
*   /*****************************************************************/ 04366000
*                                                               02S1300 04367000
*   RESPECIFY                                                   02S1300 04368000
*     R14 RESTRICTED;                                           02S1300 04369000
*   R14=SAVER14;                    /* ADDR OF RETURN POINT          */ 04370000
         L     R14,SAVER14                                      02S1301 04371000
*   RESPECIFY                                                   02S1302 04372000
*     R14 UNRESTRICTED;                                         02S1302 04373000
*   RETURN CODE(RETCODE);           /* RETURN TO CALLER WITH RETURN     04374000
*                                      CODE                          */ 04375000
@EL00002 DS    0H                                               02S1303 04376000
@EF00002 DS    0H                                               02S1303 04377000
@ER00002 BR    @14                                              02S1303 04378000
*   END SVCFORMX;                                               02S1304 04379000
*   END AMDSYS01                                                01S1305 04380000
*                                                               01S1305 04381000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 04382000
*/*%INCLUDE SYSUT5  (SYS01LOG)                                       */ 04383000
*/*%INCLUDE SYSUT5  (MACROS  )                                       */ 04384000
*/*%INCLUDE SYSLIB  (AMDPRTAB)                                       */ 04385000
*/*%INCLUDE SYSLIB  (IHAABDPL)                                       */ 04386000
*/*%INCLUDE SYSUT5  (SYS01DCL)                                       */ 04387000
*/*%INCLUDE SYSUT5  (FORMTPTN)                                       */ 04388000
*/*%INCLUDE SYSUT5  (CHECKSVC)                                       */ 04389000
*/*%INCLUDE SYSUT5  (BASICLN1)                                       */ 04390000
*/*%INCLUDE SYSUT5  (BASICLN2)                                       */ 04391000
*/*%INCLUDE SYSUT5  (SVCFORMX)                                       */ 04392000
*                                                               01S1305 04393000
*       ;                                                       01S1305 04394000
@DATA    DS    0H                                                       04395000
@CH00046 DC    H'1'                                                     04396000
@CH00078 DC    H'2'                                                     04397000
@CH00434 DC    H'14'                                                    04398000
@CH00514 DC    H'33'                                                    04399000
@CH01324 DC    H'36'                                                    04400000
@CH00563 DC    H'42'                                                    04401000
@CH01425 DC    H'45'                                                    04402000
@CH01327 DC    H'82'                                                    04403000
@CH01372 DC    XL2'FF'                                                  04404000
@DATD    DSECT                                                          04405000
         DS    0F                                                       04406000
@SA00001 DS    18F                                                      04407000
AMDSYS01 CSECT                                                          04408000
         DS    0F                                                       04409000
@CF00170 DC    F'3'                                                     04410000
@CH00170 EQU   @CF00170+2                                               04411000
@CF00099 DC    F'4'                                                     04412000
@CF00034 DC    F'8'                                                     04413000
@CH00034 EQU   @CF00034+2                                               04414000
@CF00139 DC    F'16'                                                    04415000
@CF00092 DC    F'32'                                                    04416000
@CF00297 DC    F'240'                                                   04417000
@CF00295 DC    F'251'                                                   04418000
@DATD    DSECT                                                          04419000
         DS    0D                                                       04420000
FIELDADR DS    A                                                        04421000
SAVER14  DS    A                                                        04422000
PTRNADDR DS    A                                                        04423000
TIMESW   DS    H                                                        04424000
         DS    0D                                                       04425000
@TS00001 DS    CL8                                                      04426000
DYNAMPTN DS    CL48                                                     04427000
PAKEDSVC DS    CL2                                                      04428000
UNPAKTO  DS    CL5                                                      04429000
DATALNTH DS    CL1                                                      04430000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                04431000
@ENDDATD EQU   *                                                        04432000
AMDSYS01 CSECT                                                          04433000
         NOPR  ((@ENDDATD-@DATD)/201*16)                                04434000
         DS    0F                                                       04435000
@SIZDATD DC    AL1(0)                                                   04436000
         DC    AL3(@ENDDATD-@DATD)                                      04437000
         DS    0D                                                       04438000
@CB01365 DC    X'EEEE'                                                  04439000
@CB01430 DC    X'006E'                                                  04440000
@CB01431 DC    X'0076'                                                  04441000
ASTER20  DC    CL20'********************'                               04442000
         ORG   ASTER20                                                  04443000
ASTER16  DS    CL16                                                     04444000
         ORG   ASTER16                                                  04445000
ASTER12  DS    CL12                                                     04446000
         ORG   ASTER12                                                  04447000
ASTER8   DS    CL8                                                      04448000
         ORG   ASTER8                                                   04449000
ASTER6   DS    CL6                                                      04450000
         ORG   ASTER6                                                   04451000
ASTER5   DS    CL5                                                      04452000
         ORG   ASTER8+6                                                 04453000
ASTER2   DS    CL2                                                      04454000
         ORG   ASTER12+8                                                04455000
ASTER4   DS    CL4                                                      04456000
         ORG   ASTER16+12                                               04457000
ASTER1   DS    CL1                                                      04458000
         ORG   ASTER20+20                                               04459000
PEES20   DC    CL20'PPPPPPPPPPPPPPPPPPPP'                               04460000
         ORG   PEES20                                                   04461000
PEES16   DS    CL16                                                     04462000
         ORG   PEES16                                                   04463000
PEES12   DS    CL12                                                     04464000
         ORG   PEES12                                                   04465000
PEES8    DS    CL8                                                      04466000
         ORG   PEES8                                                    04467000
PEES6    DS    CL6                                                      04468000
         ORG   PEES6                                                    04469000
PEES5    DS    CL5                                                      04470000
         ORG   PEES8+6                                                  04471000
PEES2    DS    CL2                                                      04472000
         ORG   PEES12+8                                                 04473000
PEES4    DS    CL4                                                      04474000
         ORG   PEES16+12                                                04475000
PEES1    DS    CL1                                                      04476000
         ORG   PEES20+20                                                04477000
ESSES20  DC    CL20'SSSSSSSSSSSSSSSSSSSS'                               04478000
         ORG   ESSES20                                                  04479000
ESSES16  DS    CL16                                                     04480000
         ORG   ESSES16                                                  04481000
ESSES12  DS    CL12                                                     04482000
         ORG   ESSES12                                                  04483000
ESSES8   DS    CL8                                                      04484000
         ORG   ESSES8                                                   04485000
ESSES6   DS    CL6                                                      04486000
         ORG   ESSES6                                                   04487000
ESSES5   DS    CL5                                                      04488000
         ORG   ESSES8+6                                                 04489000
ESSES2   DS    CL2                                                      04490000
         ORG   ESSES12+8                                                04491000
ESSES4   DS    CL4                                                      04492000
         ORG   ESSES16+12                                               04493000
ESSES1   DS    CL1                                                      04494000
         ORG   ESSES20+20                                               04495000
UA       DC    CL4'U/A '                                                04496000
LBASICL0 DC    CL3'SVC'                                                 04497000
LBASICL1 DC    CL25'ASCBCPUJOBNOLD PSWTCBMODN'                          04498000
LBASICL2 DC    CL7'R15R0R1'                                             04499000
LDDNL1   DC    CL3'DDN'                                                 04500000
GROUP2   DC    CL9'PLIST N/A'                                           04501000
GP4TYP1  DC    CL6'DCBDEB'                                              04502000
GP4TYP2  DC    CL10'VOLIST N/A'                                         04503000
GP4TYP3  DC    CL15'EP/DE NAMEPLIST'                                    04504000
GP4TYP4  DC    CL9'COMP CODE'                                           04505000
GP4TYP5  DC    CL4'PICA'                                                04506000
GP4TYP6  DC    CL14'ERR FLGSTCBCUU'                                     04507000
GP4TYP7  DC    CL12'DCBPRG PLIST'                                       04508000
GP4TYP8  DC    CL16'DCBFDADDCBTRKBAL'                                   04509000
GP4TYP9  DC    CL6'DSN/CI'                                              04510000
GP4TYP9A DC    CL6'DSN   '                                              04511000
GP4TYP10 DC    CL12'PLISTVOL-SER'                                       04512000
GP4TP10A DC    CL7'DSN/TTR'                                             04513000
GP4TYP11 DC    CL3'R13'                                                 04514000
GP4TYP12 DC    CL7'OLD DSN'                                             04515000
GP4TP12A DC    CL7'NEW DSN'                                             04516000
GP4TYP13 DC    CL6'CUUDSN'                                              04517000
GP4TYP14 DC    CL15'DEBDSSTATDEVMOD'                                    04518000
GP4TYP15 DC    CL4'NAME'                                                04519000
GP4TYP16 DC    CL9'SPVR LIST'                                           04520000
GP4TP16A DC    CL14'PROB PLIST N/A'                                     04521000
GP4TYP17 DC    CL9'CHAP TCB '                                           04522000
GP4TYP18 DC    CL10'MAJORMINOR'                                         04523000
GP4TYP19 DC    CL12'PLISTDSN N/A'                                       04524000
GP4TYP20 DC    CL9'DETCH TCB'                                           04525000
GP4TYP21 DC    CL8'IOBERINF'                                            04526000
GP4TYP22 DC    CL7'IQE N/A'                                             04527000
GP4TYP23 DC    CL7'VOL-SER'                                             04528000
GP4TP23A DC    CL7'TTR N/A'                                             04529000
GP4TYP24 DC    CL8'PLISTTTR'                                            04530000
SVCTITLE DS    CL9                                                      04531000
         ORG   SVCTITLE                                                 04532000
@NM00009 DC    AL1(55)                                                  04533000
@NM00010 DC    AL1(34)                                                  04534000
@NM00011 DC    AL1(0)                                                   04535000
@NM00012 DC    AL1(6)                                                   04536000
@NM00013 DC    AL4(LBASICL0)                                            04537000
@NM00014 DC    AL1(0)                                                   04538000
         ORG   SVCTITLE+9                                               04539000
         DS    CL3                                                      04540000
FIRSTLN  DS    CL33                                                     04541000
         ORG   FIRSTLN                                                  04542000
@NM00015 DC    AL1(23)                                                  04543000
@NM00016 DC    AL1(51)                                                  04544000
@NM00017 DC    AL1(10)                                                  04545000
@NM00018 DC    AL1(15)                                                  04546000
@NM00019 DC    AL4(LBASICL1)                                            04547000
@NM00020 DC    AL1(21)                                                  04548000
@NM00021 DC    AL1(33)                                                  04549000
@NM00022 DC    AL1(25)                                                  04550000
@NM00023 DC    AL1(29)                                                  04551000
@NM00024 DC    AL1(53)                                                  04552000
@NM00025 DC    AL1(55)                                                  04553000
@NM00026 DC    AL1(35)                                                  04554000
@NM00027 DC    AL1(40)                                                  04555000
@NM00028 DC    AL1(21)                                                  04556000
@NM00029 DC    AL1(99)                                                  04557000
@NM00030 DC    AL1(50)                                                  04558000
@NM00031 DC    AL1(58)                                                  04559000
@NM00032 DC    AL1(20)                                                  04560000
@NM00033 DC    AL1(3)                                                   04561000
@NM00034 DC    AL1(0)                                                   04562000
@NM00035 DC    AL1(67)                                                  04563000
@NM00036 DC    AL1(21)                                                  04564000
@NM00037 DC    AL1(35)                                                  04565000
@NM00038 DC    AL1(77)                                                  04566000
@NM00039 DC    AL1(81)                                                  04567000
@NM00040 DC    AL1(53)                                                  04568000
@NM00041 DC    AL1(55)                                                  04569000
@NM00042 DC    AL1(91)                                                  04570000
@NM00043 DC    AL1(96)                                                  04571000
@NM00044 DC    AL1(0)                                                   04572000
         ORG   FIRSTLN+33                                               04573000
         DS    CL3                                                      04574000
SECONDLN DS    CL13                                                     04575000
         ORG   SECONDLN                                                 04576000
@NM00045 DC    AL1(21)                                                  04577000
@NM00046 DC    AL1(35)                                                  04578000
@NM00047 DC    AL1(10)                                                  04579000
@NM00048 DC    AL1(15)                                                  04580000
@NM00049 DC    AL1(21)                                                  04581000
@NM00050 DC    AL1(19)                                                  04582000
@NM00051 DC    AL1(25)                                                  04583000
@NM00052 DC    AL1(29)                                                  04584000
@NM00053 DC    AL1(21)                                                  04585000
@NM00054 DC    AL1(19)                                                  04586000
@NM00055 DC    AL1(39)                                                  04587000
@NM00056 DC    AL1(42)                                                  04588000
@NM00057 DC    AL1(0)                                                   04589000
         ORG   SECONDLN+13                                              04590000
         DS    CL3                                                      04591000
DDNLN1   DS    CL5                                                      04592000
         ORG   DDNLN1                                                   04593000
@NM00058 DC    AL1(53)                                                  04594000
@NM00059 DC    AL1(39)                                                  04595000
@NM00060 DC    AL1(106)                                                 04596000
@NM00061 DC    AL1(110)                                                 04597000
@NM00062 DC    AL1(0)                                                   04598000
         ORG   DDNLN1+5                                                 04599000
         DS    CL3                                                      04600000
GRP2LN3  DS    CL41                                                     04601000
         ORG   GRP2LN3                                                  04602000
@NM00063 DC    AL1(21)                                                  04603000
@NM00064 DC    AL1(67)                                                  04604000
@NM00065 DC    AL1(10)                                                  04605000
@NM00066 DC    AL1(16)                                                  04606000
@NM00067 DC    AL1(20)                                                  04607000
@NM00068 DC    AL1(3)                                                   04608000
@NM00069 DC    AL1(0)                                                   04609000
@NM00070 DC    AL1(25)                                                  04610000
@NM00071 DC    AL1(20)                                                  04611000
@NM00072 DC    AL1(3)                                                   04612000
@NM00073 DC    AL1(0)                                                   04613000
@NM00074 DC    AL1(34)                                                  04614000
@NM00075 DC    AL1(20)                                                  04615000
@NM00076 DC    AL1(3)                                                   04616000
@NM00077 DC    AL1(0)                                                   04617000
@NM00078 DC    AL1(43)                                                  04618000
@NM00079 DC    AL1(20)                                                  04619000
@NM00080 DC    AL1(3)                                                   04620000
@NM00081 DC    AL1(0)                                                   04621000
@NM00082 DC    AL1(52)                                                  04622000
@NM00083 DC    AL1(20)                                                  04623000
@NM00084 DC    AL1(3)                                                   04624000
@NM00085 DC    AL1(0)                                                   04625000
@NM00086 DC    AL1(61)                                                  04626000
@NM00087 DC    AL1(20)                                                  04627000
@NM00088 DC    AL1(3)                                                   04628000
@NM00089 DC    AL1(0)                                                   04629000
@NM00090 DC    AL1(70)                                                  04630000
@NM00091 DC    AL1(20)                                                  04631000
@NM00092 DC    AL1(3)                                                   04632000
@NM00093 DC    AL1(0)                                                   04633000
@NM00094 DC    AL1(79)                                                  04634000
@NM00095 DC    AL1(20)                                                  04635000
@NM00096 DC    AL1(3)                                                   04636000
@NM00097 DC    AL1(0)                                                   04637000
@NM00098 DC    AL1(88)                                                  04638000
@NM00099 DC    AL1(20)                                                  04639000
@NM00100 DC    AL1(3)                                                   04640000
@NM00101 DC    AL1(0)                                                   04641000
@NM00102 DC    AL1(97)                                                  04642000
@NM00103 DC    AL1(0)                                                   04643000
         ORG   GRP2LN3+41                                               04644000
         DS    CL3                                                      04645000
GP2NA    DS    CL5                                                      04646000
         ORG   GP2NA                                                    04647000
@NM00104 DC    AL1(17)                                                  04648000
@NM00105 DC    AL1(128)                                                 04649000
@NM00106 DC    AL1(10)                                                  04650000
@NM00107 DC    AL1(0)                                                   04651000
@NM00108 DC    AL1(0)                                                   04652000
         ORG   GP2NA+5                                                  04653000
         DS    CL3                                                      04654000
GP4S00   DS    CL9                                                      04655000
         ORG   GP4S00                                                   04656000
@NM00109 DC    AL1(21)                                                  04657000
@NM00110 DC    AL1(35)                                                  04658000
@NM00111 DC    AL1(52)                                                  04659000
@NM00112 DC    AL1(56)                                                  04660000
@NM00113 DC    AL1(21)                                                  04661000
@NM00114 DC    AL1(35)                                                  04662000
@NM00115 DC    AL1(66)                                                  04663000
@NM00116 DC    AL1(70)                                                  04664000
@NM00117 DC    AL1(0)                                                   04665000
         ORG   GP4S00+9                                                 04666000
         DS    CL3                                                      04667000
GP4S06   DS    CL17                                                     04668000
         ORG   GP4S06                                                   04669000
@NM00118 DC    AL1(53)                                                  04670000
@NM00119 DC    AL1(151)                                                 04671000
@NM00120 DC    AL1(52)                                                  04672000
@NM00121 DC    AL1(63)                                                  04673000
@NM00122 DC    AL1(21)                                                  04674000
@NM00123 DC    AL1(67)                                                  04675000
@NM00124 DC    AL1(73)                                                  04676000
@NM00125 DC    AL1(79)                                                  04677000
@NM00126 DC    AL1(20)                                                  04678000
@NM00127 DC    AL1(3)                                                   04679000
@NM00128 DC    AL1(0)                                                   04680000
@NM00129 DC    AL1(88)                                                  04681000
@NM00130 DC    AL1(20)                                                  04682000
@NM00131 DC    AL1(3)                                                   04683000
@NM00132 DC    AL1(0)                                                   04684000
@NM00133 DC    AL1(97)                                                  04685000
@NM00134 DC    AL1(0)                                                   04686000
         ORG   GP4S06+17                                                04687000
         DS    CL3                                                      04688000
GP4S08   DS    CL5                                                      04689000
         ORG   GP4S08                                                   04690000
@NM00135 DC    AL1(53)                                                  04691000
@NM00136 DC    AL1(151)                                                 04692000
@NM00137 DC    AL1(52)                                                  04693000
@NM00138 DC    AL1(63)                                                  04694000
@NM00139 DC    AL1(0)                                                   04695000
         ORG   GP4S08+5                                                 04696000
         DS    CL3                                                      04697000
GP4S13   DS    CL5                                                      04698000
         ORG   GP4S13                                                   04699000
@NM00140 DC    AL1(21)                                                  04700000
@NM00141 DC    AL1(131)                                                 04701000
@NM00142 DC    AL1(52)                                                  04702000
@NM00143 DC    AL1(63)                                                  04703000
@NM00144 DC    AL1(0)                                                   04704000
         ORG   GP4S13+5                                                 04705000
         DS    CL3                                                      04706000
GP4S14   DS    CL5                                                      04707000
         ORG   GP4S14                                                   04708000
@NM00145 DC    AL1(21)                                                  04709000
@NM00146 DC    AL1(53)                                                  04710000
@NM00147 DC    AL1(52)                                                  04711000
@NM00148 DC    AL1(58)                                                  04712000
@NM00149 DC    AL1(0)                                                   04713000
         ORG   GP4S14+5                                                 04714000
         DS    CL3                                                      04715000
GP4S15   DS    CL13                                                     04716000
         ORG   GP4S15                                                   04717000
@NM00150 DC    AL1(21)                                                  04718000
@NM00151 DC    AL1(112)                                                 04719000
@NM00152 DC    AL1(52)                                                  04720000
@NM00153 DC    AL1(61)                                                  04721000
@NM00154 DC    AL1(21)                                                  04722000
@NM00155 DC    AL1(35)                                                  04723000
@NM00156 DC    AL1(66)                                                  04724000
@NM00157 DC    AL1(70)                                                  04725000
@NM00158 DC    AL1(21)                                                  04726000
@NM00159 DC    AL1(33)                                                  04727000
@NM00160 DC    AL1(80)                                                  04728000
@NM00161 DC    AL1(84)                                                  04729000
@NM00162 DC    AL1(0)                                                   04730000
         ORG   GP4S15+13                                                04731000
         DS    CL3                                                      04732000
GP4S16   DS    CL17                                                     04733000
         ORG   GP4S16                                                   04734000
@NM00163 DC    AL1(21)                                                  04735000
@NM00164 DC    AL1(35)                                                  04736000
@NM00165 DC    AL1(52)                                                  04737000
@NM00166 DC    AL1(56)                                                  04738000
@NM00167 DC    AL1(21)                                                  04739000
@NM00168 DC    AL1(131)                                                 04740000
@NM00169 DC    AL1(66)                                                  04741000
@NM00170 DC    AL1(76)                                                  04742000
@NM00171 DC    AL1(20)                                                  04743000
@NM00172 DC    AL1(3)                                                   04744000
@NM00173 DC    AL1(0)                                                   04745000
@NM00174 DC    AL1(85)                                                  04746000
@NM00175 DC    AL1(20)                                                  04747000
@NM00176 DC    AL1(3)                                                   04748000
@NM00177 DC    AL1(0)                                                   04749000
@NM00178 DC    AL1(94)                                                  04750000
@NM00179 DC    AL1(0)                                                   04751000
         ORG   GP4S16+17                                                04752000
         DS    CL3                                                      04753000
GP4S21   DS    CL17                                                     04754000
         ORG   GP4S21                                                   04755000
@NM00180 DC    AL1(21)                                                  04756000
@NM00181 DC    AL1(67)                                                  04757000
@NM00182 DC    AL1(52)                                                  04758000
@NM00183 DC    AL1(58)                                                  04759000
@NM00184 DC    AL1(20)                                                  04760000
@NM00185 DC    AL1(3)                                                   04761000
@NM00186 DC    AL1(0)                                                   04762000
@NM00187 DC    AL1(67)                                                  04763000
@NM00188 DC    AL1(20)                                                  04764000
@NM00189 DC    AL1(3)                                                   04765000
@NM00190 DC    AL1(0)                                                   04766000
@NM00191 DC    AL1(76)                                                  04767000
@NM00192 DC    AL1(20)                                                  04768000
@NM00193 DC    AL1(3)                                                   04769000
@NM00194 DC    AL1(0)                                                   04770000
@NM00195 DC    AL1(85)                                                  04771000
@NM00196 DC    AL1(0)                                                   04772000
         ORG   GP4S21+17                                                04773000
         DS    CL3                                                      04774000
GP4S21A  DS    CL33                                                     04775000
         ORG   GP4S21A                                                  04776000
@NM00197 DC    AL1(20)                                                  04777000
@NM00198 DC    AL1(3)                                                   04778000
@NM00199 DC    AL1(0)                                                   04779000
@NM00200 DC    AL1(15)                                                  04780000
@NM00201 DC    AL1(20)                                                  04781000
@NM00202 DC    AL1(3)                                                   04782000
@NM00203 DC    AL1(0)                                                   04783000
@NM00204 DC    AL1(24)                                                  04784000
@NM00205 DC    AL1(20)                                                  04785000
@NM00206 DC    AL1(3)                                                   04786000
@NM00207 DC    AL1(0)                                                   04787000
@NM00208 DC    AL1(33)                                                  04788000
@NM00209 DC    AL1(20)                                                  04789000
@NM00210 DC    AL1(3)                                                   04790000
@NM00211 DC    AL1(0)                                                   04791000
@NM00212 DC    AL1(42)                                                  04792000
@NM00213 DC    AL1(20)                                                  04793000
@NM00214 DC    AL1(3)                                                   04794000
@NM00215 DC    AL1(0)                                                   04795000
@NM00216 DC    AL1(51)                                                  04796000
@NM00217 DC    AL1(20)                                                  04797000
@NM00218 DC    AL1(3)                                                   04798000
@NM00219 DC    AL1(0)                                                   04799000
@NM00220 DC    AL1(60)                                                  04800000
@NM00221 DC    AL1(20)                                                  04801000
@NM00222 DC    AL1(3)                                                   04802000
@NM00223 DC    AL1(0)                                                   04803000
@NM00224 DC    AL1(69)                                                  04804000
@NM00225 DC    AL1(20)                                                  04805000
@NM00226 DC    AL1(3)                                                   04806000
@NM00227 DC    AL1(0)                                                   04807000
@NM00228 DC    AL1(78)                                                  04808000
@NM00229 DC    AL1(0)                                                   04809000
         ORG   GP4S21A+33                                               04810000
         DS    CL3                                                      04811000
GP4S25   DS    CL13                                                     04812000
         ORG   GP4S25                                                   04813000
@NM00230 DC    AL1(21)                                                  04814000
@NM00231 DC    AL1(99)                                                  04815000
@NM00232 DC    AL1(52)                                                  04816000
@NM00233 DC    AL1(61)                                                  04817000
@NM00234 DC    AL1(20)                                                  04818000
@NM00235 DC    AL1(3)                                                   04819000
@NM00236 DC    AL1(0)                                                   04820000
@NM00237 DC    AL1(70)                                                  04821000
@NM00238 DC    AL1(21)                                                  04822000
@NM00239 DC    AL1(129)                                                 04823000
@NM00240 DC    AL1(80)                                                  04824000
@NM00241 DC    AL1(90)                                                  04825000
@NM00242 DC    AL1(0)                                                   04826000
         ORG   GP4S25+13                                                04827000
         DS    CL3                                                      04828000
GP4S26A  DS    CL21                                                     04829000
         ORG   GP4S26A                                                  04830000
@NM00243 DC    AL1(21)                                                  04831000
@NM00244 DC    AL1(67)                                                  04832000
@NM00245 DC    AL1(52)                                                  04833000
@NM00246 DC    AL1(58)                                                  04834000
@NM00247 DC    AL1(20)                                                  04835000
@NM00248 DC    AL1(3)                                                   04836000
@NM00249 DC    AL1(0)                                                   04837000
@NM00250 DC    AL1(67)                                                  04838000
@NM00251 DC    AL1(20)                                                  04839000
@NM00252 DC    AL1(3)                                                   04840000
@NM00253 DC    AL1(0)                                                   04841000
@NM00254 DC    AL1(76)                                                  04842000
@NM00255 DC    AL1(20)                                                  04843000
@NM00256 DC    AL1(3)                                                   04844000
@NM00257 DC    AL1(0)                                                   04845000
@NM00258 DC    AL1(85)                                                  04846000
@NM00259 DC    AL1(20)                                                  04847000
@NM00260 DC    AL1(3)                                                   04848000
@NM00261 DC    AL1(0)                                                   04849000
@NM00262 DC    AL1(94)                                                  04850000
@NM00263 DC    AL1(0)                                                   04851000
         ORG   GP4S26A+21                                               04852000
         DS    CL3                                                      04853000
GP4S26B  DS    CL13                                                     04854000
         ORG   GP4S26B                                                  04855000
@NM00264 DC    AL1(53)                                                  04856000
@NM00265 DC    AL1(95)                                                  04857000
@NM00266 DC    AL1(10)                                                  04858000
@NM00267 DC    AL1(18)                                                  04859000
@NM00268 DC    AL1(52)                                                  04860000
@NM00269 DC    AL1(15)                                                  04861000
@NM00270 DC    AL1(0)                                                   04862000
@NM00271 DC    AL1(34)                                                  04863000
@NM00272 DC    AL1(52)                                                  04864000
@NM00273 DC    AL1(11)                                                  04865000
@NM00274 DC    AL1(0)                                                   04866000
@NM00275 DC    AL1(50)                                                  04867000
@NM00276 DC    AL1(0)                                                   04868000
         ORG   GP4S26B+13                                               04869000
         DS    CL3                                                      04870000
GP4S26C  DS    CL41                                                     04871000
         ORG   GP4S26C                                                  04872000
@NM00277 DC    AL1(21)                                                  04873000
@NM00278 DC    AL1(83)                                                  04874000
@NM00279 DC    AL1(10)                                                  04875000
@NM00280 DC    AL1(17)                                                  04876000
@NM00281 DC    AL1(20)                                                  04877000
@NM00282 DC    AL1(3)                                                   04878000
@NM00283 DC    AL1(0)                                                   04879000
@NM00284 DC    AL1(26)                                                  04880000
@NM00285 DC    AL1(20)                                                  04881000
@NM00286 DC    AL1(3)                                                   04882000
@NM00287 DC    AL1(0)                                                   04883000
@NM00288 DC    AL1(35)                                                  04884000
@NM00289 DC    AL1(20)                                                  04885000
@NM00290 DC    AL1(3)                                                   04886000
@NM00291 DC    AL1(0)                                                   04887000
@NM00292 DC    AL1(44)                                                  04888000
@NM00293 DC    AL1(20)                                                  04889000
@NM00294 DC    AL1(3)                                                   04890000
@NM00295 DC    AL1(0)                                                   04891000
@NM00296 DC    AL1(53)                                                  04892000
@NM00297 DC    AL1(20)                                                  04893000
@NM00298 DC    AL1(3)                                                   04894000
@NM00299 DC    AL1(0)                                                   04895000
@NM00300 DC    AL1(62)                                                  04896000
@NM00301 DC    AL1(20)                                                  04897000
@NM00302 DC    AL1(3)                                                   04898000
@NM00303 DC    AL1(0)                                                   04899000
@NM00304 DC    AL1(71)                                                  04900000
@NM00305 DC    AL1(20)                                                  04901000
@NM00306 DC    AL1(3)                                                   04902000
@NM00307 DC    AL1(0)                                                   04903000
@NM00308 DC    AL1(80)                                                  04904000
@NM00309 DC    AL1(20)                                                  04905000
@NM00310 DC    AL1(3)                                                   04906000
@NM00311 DC    AL1(0)                                                   04907000
@NM00312 DC    AL1(89)                                                  04908000
@NM00313 DC    AL1(20)                                                  04909000
@NM00314 DC    AL1(3)                                                   04910000
@NM00315 DC    AL1(0)                                                   04911000
@NM00316 DC    AL1(98)                                                  04912000
@NM00317 DC    AL1(0)                                                   04913000
         ORG   GP4S26C+41                                               04914000
         DS    CL3                                                      04915000
GP4S26D  DS    CL5                                                      04916000
         ORG   GP4S26D                                                  04917000
@NM00318 DC    AL1(17)                                                  04918000
@NM00319 DC    AL1(144)                                                 04919000
@NM00320 DC    AL1(10)                                                  04920000
@NM00321 DC    AL1(0)                                                   04921000
@NM00322 DC    AL1(0)                                                   04922000
         ORG   GP4S26D+5                                                04923000
         DS    CL3                                                      04924000
GP4S27A  DS    CL21                                                     04925000
         ORG   GP4S27A                                                  04926000
@NM00323 DC    AL1(21)                                                  04927000
@NM00324 DC    AL1(67)                                                  04928000
@NM00325 DC    AL1(52)                                                  04929000
@NM00326 DC    AL1(58)                                                  04930000
@NM00327 DC    AL1(20)                                                  04931000
@NM00328 DC    AL1(3)                                                   04932000
@NM00329 DC    AL1(0)                                                   04933000
@NM00330 DC    AL1(67)                                                  04934000
@NM00331 DC    AL1(20)                                                  04935000
@NM00332 DC    AL1(3)                                                   04936000
@NM00333 DC    AL1(0)                                                   04937000
@NM00334 DC    AL1(76)                                                  04938000
@NM00335 DC    AL1(20)                                                  04939000
@NM00336 DC    AL1(3)                                                   04940000
@NM00337 DC    AL1(0)                                                   04941000
@NM00338 DC    AL1(85)                                                  04942000
@NM00339 DC    AL1(53)                                                  04943000
@NM00340 DC    AL1(101)                                                 04944000
@NM00341 DC    AL1(95)                                                  04945000
@NM00342 DC    AL1(103)                                                 04946000
@NM00343 DC    AL1(0)                                                   04947000
         ORG   GP4S27A+21                                               04948000
         DS    CL3                                                      04949000
GP4S27B  DS    CL13                                                     04950000
         ORG   GP4S27B                                                  04951000
@NM00344 DC    AL1(53)                                                  04952000
@NM00345 DC    AL1(111)                                                 04953000
@NM00346 DC    AL1(10)                                                  04954000
@NM00347 DC    AL1(18)                                                  04955000
@NM00348 DC    AL1(52)                                                  04956000
@NM00349 DC    AL1(15)                                                  04957000
@NM00350 DC    AL1(0)                                                   04958000
@NM00351 DC    AL1(34)                                                  04959000
@NM00352 DC    AL1(52)                                                  04960000
@NM00353 DC    AL1(11)                                                  04961000
@NM00354 DC    AL1(0)                                                   04962000
@NM00355 DC    AL1(50)                                                  04963000
@NM00356 DC    AL1(0)                                                   04964000
         ORG   GP4S27B+13                                               04965000
         DS    CL3                                                      04966000
GP4S28   DS    CL5                                                      04967000
         ORG   GP4S28                                                   04968000
@NM00357 DC    AL1(21)                                                  04969000
@NM00358 DC    AL1(35)                                                  04970000
@NM00359 DC    AL1(52)                                                  04971000
@NM00360 DC    AL1(56)                                                  04972000
@NM00361 DC    AL1(0)                                                   04973000
         ORG   GP4S28+5                                                 04974000
         DS    CL3                                                      04975000
GP4S30A  DS    CL17                                                     04976000
         ORG   GP4S30A                                                  04977000
@NM00362 DC    AL1(21)                                                  04978000
@NM00363 DC    AL1(67)                                                  04979000
@NM00364 DC    AL1(52)                                                  04980000
@NM00365 DC    AL1(58)                                                  04981000
@NM00366 DC    AL1(20)                                                  04982000
@NM00367 DC    AL1(3)                                                   04983000
@NM00368 DC    AL1(0)                                                   04984000
@NM00369 DC    AL1(67)                                                  04985000
@NM00370 DC    AL1(20)                                                  04986000
@NM00371 DC    AL1(3)                                                   04987000
@NM00372 DC    AL1(0)                                                   04988000
@NM00373 DC    AL1(76)                                                  04989000
@NM00374 DC    AL1(20)                                                  04990000
@NM00375 DC    AL1(3)                                                   04991000
@NM00376 DC    AL1(0)                                                   04992000
@NM00377 DC    AL1(85)                                                  04993000
@NM00378 DC    AL1(0)                                                   04994000
         ORG   GP4S30A+17                                               04995000
         DS    CL3                                                      04996000
GP4S30B  DS    CL13                                                     04997000
         ORG   GP4S30B                                                  04998000
@NM00379 DC    AL1(53)                                                  04999000
@NM00380 DC    AL1(111)                                                 05000000
@NM00381 DC    AL1(10)                                                  05001000
@NM00382 DC    AL1(18)                                                  05002000
@NM00383 DC    AL1(52)                                                  05003000
@NM00384 DC    AL1(15)                                                  05004000
@NM00385 DC    AL1(0)                                                   05005000
@NM00386 DC    AL1(34)                                                  05006000
@NM00387 DC    AL1(52)                                                  05007000
@NM00388 DC    AL1(11)                                                  05008000
@NM00389 DC    AL1(0)                                                   05009000
@NM00390 DC    AL1(50)                                                  05010000
@NM00391 DC    AL1(0)                                                   05011000
         ORG   GP4S30B+13                                               05012000
         DS    CL3                                                      05013000
GP4S30C  DS    CL13                                                     05014000
         ORG   GP4S30C                                                  05015000
@NM00392 DC    AL1(53)                                                  05016000
@NM00393 DC    AL1(111)                                                 05017000
@NM00394 DC    AL1(64)                                                  05018000
@NM00395 DC    AL1(72)                                                  05019000
@NM00396 DC    AL1(52)                                                  05020000
@NM00397 DC    AL1(15)                                                  05021000
@NM00398 DC    AL1(0)                                                   05022000
@NM00399 DC    AL1(88)                                                  05023000
@NM00400 DC    AL1(52)                                                  05024000
@NM00401 DC    AL1(11)                                                  05025000
@NM00402 DC    AL1(0)                                                   05026000
@NM00403 DC    AL1(104)                                                 05027000
@NM00404 DC    AL1(0)                                                   05028000
         ORG   GP4S30C+13                                               05029000
         DS    CL3                                                      05030000
GP4S32   DS    CL21                                                     05031000
         ORG   GP4S32                                                   05032000
@NM00405 DC    AL1(21)                                                  05033000
@NM00406 DC    AL1(33)                                                  05034000
@NM00407 DC    AL1(52)                                                  05035000
@NM00408 DC    AL1(58)                                                  05036000
@NM00409 DC    AL1(20)                                                  05037000
@NM00410 DC    AL1(0)                                                   05038000
@NM00411 DC    AL1(0)                                                   05039000
@NM00412 DC    AL1(64)                                                  05040000
@NM00413 DC    AL1(53)                                                  05041000
@NM00414 DC    AL1(47)                                                  05042000
@NM00415 DC    AL1(64)                                                  05043000
@NM00416 DC    AL1(68)                                                  05044000
@NM00417 DC    AL1(52)                                                  05045000
@NM00418 DC    AL1(15)                                                  05046000
@NM00419 DC    AL1(0)                                                   05047000
@NM00420 DC    AL1(84)                                                  05048000
@NM00421 DC    AL1(52)                                                  05049000
@NM00422 DC    AL1(11)                                                  05050000
@NM00423 DC    AL1(0)                                                   05051000
@NM00424 DC    AL1(100)                                                 05052000
@NM00425 DC    AL1(0)                                                   05053000
         ORG   GP4S32+21                                                05054000
         DS    CL3                                                      05055000
GP4S41   DS    CL5                                                      05056000
         ORG   GP4S41                                                   05057000
@NM00426 DC    AL1(53)                                                  05058000
@NM00427 DC    AL1(55)                                                  05059000
@NM00428 DC    AL1(52)                                                  05060000
@NM00429 DC    AL1(57)                                                  05061000
@NM00430 DC    AL1(0)                                                   05062000
         ORG   GP4S41+5                                                 05063000
         DS    CL3                                                      05064000
GP4S42A  DS    CL37                                                     05065000
         ORG   GP4S42A                                                  05066000
@NM00431 DC    AL1(21)                                                  05067000
@NM00432 DC    AL1(131)                                                 05068000
@NM00433 DC    AL1(10)                                                  05069000
@NM00434 DC    AL1(21)                                                  05070000
@NM00435 DC    AL1(20)                                                  05071000
@NM00436 DC    AL1(3)                                                   05072000
@NM00437 DC    AL1(0)                                                   05073000
@NM00438 DC    AL1(30)                                                  05074000
@NM00439 DC    AL1(20)                                                  05075000
@NM00440 DC    AL1(3)                                                   05076000
@NM00441 DC    AL1(0)                                                   05077000
@NM00442 DC    AL1(39)                                                  05078000
@NM00443 DC    AL1(20)                                                  05079000
@NM00444 DC    AL1(3)                                                   05080000
@NM00445 DC    AL1(0)                                                   05081000
@NM00446 DC    AL1(48)                                                  05082000
@NM00447 DC    AL1(20)                                                  05083000
@NM00448 DC    AL1(3)                                                   05084000
@NM00449 DC    AL1(0)                                                   05085000
@NM00450 DC    AL1(57)                                                  05086000
@NM00451 DC    AL1(20)                                                  05087000
@NM00452 DC    AL1(3)                                                   05088000
@NM00453 DC    AL1(0)                                                   05089000
@NM00454 DC    AL1(66)                                                  05090000
@NM00455 DC    AL1(20)                                                  05091000
@NM00456 DC    AL1(3)                                                   05092000
@NM00457 DC    AL1(0)                                                   05093000
@NM00458 DC    AL1(75)                                                  05094000
@NM00459 DC    AL1(20)                                                  05095000
@NM00460 DC    AL1(3)                                                   05096000
@NM00461 DC    AL1(0)                                                   05097000
@NM00462 DC    AL1(84)                                                  05098000
@NM00463 DC    AL1(20)                                                  05099000
@NM00464 DC    AL1(3)                                                   05100000
@NM00465 DC    AL1(0)                                                   05101000
@NM00466 DC    AL1(93)                                                  05102000
@NM00467 DC    AL1(0)                                                   05103000
         ORG   GP4S42A+37                                               05104000
         DS    CL3                                                      05105000
GP4S42B  DS    CL25                                                     05106000
         ORG   GP4S42B                                                  05107000
@NM00468 DC    AL1(20)                                                  05108000
@NM00469 DC    AL1(3)                                                   05109000
@NM00470 DC    AL1(0)                                                   05110000
@NM00471 DC    AL1(21)                                                  05111000
@NM00472 DC    AL1(20)                                                  05112000
@NM00473 DC    AL1(3)                                                   05113000
@NM00474 DC    AL1(0)                                                   05114000
@NM00475 DC    AL1(30)                                                  05115000
@NM00476 DC    AL1(20)                                                  05116000
@NM00477 DC    AL1(3)                                                   05117000
@NM00478 DC    AL1(0)                                                   05118000
@NM00479 DC    AL1(39)                                                  05119000
@NM00480 DC    AL1(20)                                                  05120000
@NM00481 DC    AL1(3)                                                   05121000
@NM00482 DC    AL1(0)                                                   05122000
@NM00483 DC    AL1(48)                                                  05123000
@NM00484 DC    AL1(20)                                                  05124000
@NM00485 DC    AL1(3)                                                   05125000
@NM00486 DC    AL1(0)                                                   05126000
@NM00487 DC    AL1(57)                                                  05127000
@NM00488 DC    AL1(20)                                                  05128000
@NM00489 DC    AL1(3)                                                   05129000
@NM00490 DC    AL1(0)                                                   05130000
@NM00491 DC    AL1(66)                                                  05131000
@NM00492 DC    AL1(0)                                                   05132000
         ORG   GP4S42B+25                                               05133000
         DS    CL3                                                      05134000
GP4S42C  DS    CL41                                                     05135000
         ORG   GP4S42C                                                  05136000
@NM00493 DC    AL1(21)                                                  05137000
@NM00494 DC    AL1(147)                                                 05138000
@NM00495 DC    AL1(10)                                                  05139000
@NM00496 DC    AL1(21)                                                  05140000
@NM00497 DC    AL1(20)                                                  05141000
@NM00498 DC    AL1(3)                                                   05142000
@NM00499 DC    AL1(0)                                                   05143000
@NM00500 DC    AL1(30)                                                  05144000
@NM00501 DC    AL1(20)                                                  05145000
@NM00502 DC    AL1(3)                                                   05146000
@NM00503 DC    AL1(0)                                                   05147000
@NM00504 DC    AL1(39)                                                  05148000
@NM00505 DC    AL1(20)                                                  05149000
@NM00506 DC    AL1(3)                                                   05150000
@NM00507 DC    AL1(0)                                                   05151000
@NM00508 DC    AL1(48)                                                  05152000
@NM00509 DC    AL1(20)                                                  05153000
@NM00510 DC    AL1(3)                                                   05154000
@NM00511 DC    AL1(0)                                                   05155000
@NM00512 DC    AL1(57)                                                  05156000
@NM00513 DC    AL1(20)                                                  05157000
@NM00514 DC    AL1(3)                                                   05158000
@NM00515 DC    AL1(0)                                                   05159000
@NM00516 DC    AL1(66)                                                  05160000
@NM00517 DC    AL1(20)                                                  05161000
@NM00518 DC    AL1(3)                                                   05162000
@NM00519 DC    AL1(0)                                                   05163000
@NM00520 DC    AL1(75)                                                  05164000
@NM00521 DC    AL1(20)                                                  05165000
@NM00522 DC    AL1(3)                                                   05166000
@NM00523 DC    AL1(0)                                                   05167000
@NM00524 DC    AL1(84)                                                  05168000
@NM00525 DC    AL1(20)                                                  05169000
@NM00526 DC    AL1(3)                                                   05170000
@NM00527 DC    AL1(0)                                                   05171000
@NM00528 DC    AL1(93)                                                  05172000
@NM00529 DC    AL1(20)                                                  05173000
@NM00530 DC    AL1(3)                                                   05174000
@NM00531 DC    AL1(0)                                                   05175000
@NM00532 DC    AL1(102)                                                 05176000
@NM00533 DC    AL1(0)                                                   05177000
         ORG   GP4S42C+41                                               05178000
         DS    CL3                                                      05179000
GP4S42D  DS    CL5                                                      05180000
         ORG   GP4S42D                                                  05181000
@NM00534 DC    AL1(17)                                                  05182000
@NM00535 DC    AL1(208)                                                 05183000
@NM00536 DC    AL1(10)                                                  05184000
@NM00537 DC    AL1(0)                                                   05185000
@NM00538 DC    AL1(0)                                                   05186000
         ORG   GP4S42D+5                                                05187000
         DS    CL3                                                      05188000
GP4S44   DS    CL5                                                      05189000
         ORG   GP4S44                                                   05190000
@NM00539 DC    AL1(21)                                                  05191000
@NM00540 DC    AL1(131)                                                 05192000
@NM00541 DC    AL1(52)                                                  05193000
@NM00542 DC    AL1(62)                                                  05194000
@NM00543 DC    AL1(0)                                                   05195000
         ORG   GP4S44+5                                                 05196000
         DS    CL3                                                      05197000
GP4S48A  DS    CL21                                                     05198000
         ORG   GP4S48A                                                  05199000
@NM00544 DC    AL1(53)                                                  05200000
@NM00545 DC    AL1(71)                                                  05201000
@NM00546 DC    AL1(52)                                                  05202000
@NM00547 DC    AL1(58)                                                  05203000
@NM00548 DC    AL1(20)                                                  05204000
@NM00549 DC    AL1(0)                                                   05205000
@NM00550 DC    AL1(0)                                                   05206000
@NM00551 DC    AL1(68)                                                  05207000
@NM00552 DC    AL1(53)                                                  05208000
@NM00553 DC    AL1(79)                                                  05209000
@NM00554 DC    AL1(68)                                                  05210000
@NM00555 DC    AL1(74)                                                  05211000
@NM00556 DC    AL1(52)                                                  05212000
@NM00557 DC    AL1(15)                                                  05213000
@NM00558 DC    AL1(0)                                                   05214000
@NM00559 DC    AL1(90)                                                  05215000
@NM00560 DC    AL1(52)                                                  05216000
@NM00561 DC    AL1(11)                                                  05217000
@NM00562 DC    AL1(0)                                                   05218000
@NM00563 DC    AL1(106)                                                 05219000
@NM00564 DC    AL1(0)                                                   05220000
         ORG   GP4S48A+21                                               05221000
         DS    CL3                                                      05222000
GP4S48B  DS    CL21                                                     05223000
         ORG   GP4S48B                                                  05224000
@NM00565 DC    AL1(21)                                                  05225000
@NM00566 DC    AL1(67)                                                  05226000
@NM00567 DC    AL1(10)                                                  05227000
@NM00568 DC    AL1(16)                                                  05228000
@NM00569 DC    AL1(20)                                                  05229000
@NM00570 DC    AL1(3)                                                   05230000
@NM00571 DC    AL1(0)                                                   05231000
@NM00572 DC    AL1(25)                                                  05232000
@NM00573 DC    AL1(20)                                                  05233000
@NM00574 DC    AL1(3)                                                   05234000
@NM00575 DC    AL1(0)                                                   05235000
@NM00576 DC    AL1(34)                                                  05236000
@NM00577 DC    AL1(20)                                                  05237000
@NM00578 DC    AL1(3)                                                   05238000
@NM00579 DC    AL1(0)                                                   05239000
@NM00580 DC    AL1(43)                                                  05240000
@NM00581 DC    AL1(20)                                                  05241000
@NM00582 DC    AL1(3)                                                   05242000
@NM00583 DC    AL1(0)                                                   05243000
@NM00584 DC    AL1(52)                                                  05244000
@NM00585 DC    AL1(0)                                                   05245000
         ORG   GP4S48B+21                                               05246000
         DS    CL3                                                      05247000
GP4S52A  DS    CL45                                                     05248000
         ORG   GP4S52A                                                  05249000
@NM00586 DC    AL1(21)                                                  05250000
@NM00587 DC    AL1(67)                                                  05251000
@NM00588 DC    AL1(10)                                                  05252000
@NM00589 DC    AL1(16)                                                  05253000
@NM00590 DC    AL1(20)                                                  05254000
@NM00591 DC    AL1(3)                                                   05255000
@NM00592 DC    AL1(0)                                                   05256000
@NM00593 DC    AL1(25)                                                  05257000
@NM00594 DC    AL1(20)                                                  05258000
@NM00595 DC    AL1(3)                                                   05259000
@NM00596 DC    AL1(0)                                                   05260000
@NM00597 DC    AL1(34)                                                  05261000
@NM00598 DC    AL1(20)                                                  05262000
@NM00599 DC    AL1(3)                                                   05263000
@NM00600 DC    AL1(0)                                                   05264000
@NM00601 DC    AL1(43)                                                  05265000
@NM00602 DC    AL1(20)                                                  05266000
@NM00603 DC    AL1(3)                                                   05267000
@NM00604 DC    AL1(0)                                                   05268000
@NM00605 DC    AL1(52)                                                  05269000
@NM00606 DC    AL1(20)                                                  05270000
@NM00607 DC    AL1(3)                                                   05271000
@NM00608 DC    AL1(0)                                                   05272000
@NM00609 DC    AL1(61)                                                  05273000
@NM00610 DC    AL1(20)                                                  05274000
@NM00611 DC    AL1(3)                                                   05275000
@NM00612 DC    AL1(0)                                                   05276000
@NM00613 DC    AL1(70)                                                  05277000
@NM00614 DC    AL1(20)                                                  05278000
@NM00615 DC    AL1(3)                                                   05279000
@NM00616 DC    AL1(0)                                                   05280000
@NM00617 DC    AL1(79)                                                  05281000
@NM00618 DC    AL1(20)                                                  05282000
@NM00619 DC    AL1(3)                                                   05283000
@NM00620 DC    AL1(0)                                                   05284000
@NM00621 DC    AL1(88)                                                  05285000
@NM00622 DC    AL1(20)                                                  05286000
@NM00623 DC    AL1(3)                                                   05287000
@NM00624 DC    AL1(0)                                                   05288000
@NM00625 DC    AL1(97)                                                  05289000
@NM00626 DC    AL1(20)                                                  05290000
@NM00627 DC    AL1(3)                                                   05291000
@NM00628 DC    AL1(0)                                                   05292000
@NM00629 DC    AL1(106)                                                 05293000
@NM00630 DC    AL1(0)                                                   05294000
         ORG   GP4S52A+45                                               05295000
         DS    CL3                                                      05296000
GP4S52B  DS    CL9                                                      05297000
         ORG   GP4S52B                                                  05298000
@NM00631 DC    AL1(20)                                                  05299000
@NM00632 DC    AL1(3)                                                   05300000
@NM00633 DC    AL1(0)                                                   05301000
@NM00634 DC    AL1(16)                                                  05302000
@NM00635 DC    AL1(20)                                                  05303000
@NM00636 DC    AL1(3)                                                   05304000
@NM00637 DC    AL1(0)                                                   05305000
@NM00638 DC    AL1(25)                                                  05306000
@NM00639 DC    AL1(0)                                                   05307000
         ORG   GP4S52B+9                                                05308000
         DS    CL3                                                      05309000
GP4S52C  DS    CL17                                                     05310000
         ORG   GP4S52C                                                  05311000
@NM00640 DC    AL1(53)                                                  05312000
@NM00641 DC    AL1(79)                                                  05313000
@NM00642 DC    AL1(10)                                                  05314000
@NM00643 DC    AL1(16)                                                  05315000
@NM00644 DC    AL1(52)                                                  05316000
@NM00645 DC    AL1(15)                                                  05317000
@NM00646 DC    AL1(0)                                                   05318000
@NM00647 DC    AL1(33)                                                  05319000
@NM00648 DC    AL1(52)                                                  05320000
@NM00649 DC    AL1(15)                                                  05321000
@NM00650 DC    AL1(0)                                                   05322000
@NM00651 DC    AL1(50)                                                  05323000
@NM00652 DC    AL1(52)                                                  05324000
@NM00653 DC    AL1(3)                                                   05325000
@NM00654 DC    AL1(0)                                                   05326000
@NM00655 DC    AL1(67)                                                  05327000
@NM00656 DC    AL1(0)                                                   05328000
         ORG   GP4S52C+17                                               05329000
         DS    CL3                                                      05330000
GP4S66   DS    CL17                                                     05331000
         ORG   GP4S66                                                   05332000
@NM00657 DC    AL1(21)                                                  05333000
@NM00658 DC    AL1(115)                                                 05334000
@NM00659 DC    AL1(52)                                                  05335000
@NM00660 DC    AL1(61)                                                  05336000
@NM00661 DC    AL1(20)                                                  05337000
@NM00662 DC    AL1(3)                                                   05338000
@NM00663 DC    AL1(0)                                                   05339000
@NM00664 DC    AL1(70)                                                  05340000
@NM00665 DC    AL1(20)                                                  05341000
@NM00666 DC    AL1(3)                                                   05342000
@NM00667 DC    AL1(0)                                                   05343000
@NM00668 DC    AL1(79)                                                  05344000
@NM00669 DC    AL1(20)                                                  05345000
@NM00670 DC    AL1(3)                                                   05346000
@NM00671 DC    AL1(0)                                                   05347000
@NM00672 DC    AL1(88)                                                  05348000
@NM00673 DC    AL1(0)                                                   05349000
         ORG   GP4S66+17                                                05350000
         DS    CL3                                                      05351000
GP4S75A  DS    CL13                                                     05352000
         ORG   GP4S75A                                                  05353000
@NM00674 DC    AL1(21)                                                  05354000
@NM00675 DC    AL1(35)                                                  05355000
@NM00676 DC    AL1(52)                                                  05356000
@NM00677 DC    AL1(57)                                                  05357000
@NM00678 DC    AL1(20)                                                  05358000
@NM00679 DC    AL1(3)                                                   05359000
@NM00680 DC    AL1(0)                                                   05360000
@NM00681 DC    AL1(66)                                                  05361000
@NM00682 DC    AL1(20)                                                  05362000
@NM00683 DC    AL1(3)                                                   05363000
@NM00684 DC    AL1(0)                                                   05364000
@NM00685 DC    AL1(75)                                                  05365000
@NM00686 DC    AL1(0)                                                   05366000
         ORG   GP4S75A+13                                               05367000
         DS    CL3                                                      05368000
GP4S75B  DS    CL5                                                      05369000
         ORG   GP4S75B                                                  05370000
@NM00687 DC    AL1(17)                                                  05371000
@NM00688 DC    AL1(96)                                                  05372000
@NM00689 DC    AL1(52)                                                  05373000
@NM00690 DC    AL1(0)                                                   05374000
@NM00691 DC    AL1(0)                                                   05375000
         ORG   GP4S75B+5                                                05376000
         DS    CL3                                                      05377000
GP4S82A  DS    CL5                                                      05378000
         ORG   GP4S82A                                                  05379000
@NM00692 DC    AL1(53)                                                  05380000
@NM00693 DC    AL1(101)                                                 05381000
@NM00694 DC    AL1(52)                                                  05382000
@NM00695 DC    AL1(61)                                                  05383000
@NM00696 DC    AL1(0)                                                   05384000
         ORG   GP4S82A+5                                                05385000
         DS    CL3                                                      05386000
GP4S82B  DS    CL9                                                      05387000
         ORG   GP4S82B                                                  05388000
@NM00697 DC    AL1(21)                                                  05389000
@NM00698 DC    AL1(37)                                                  05390000
@NM00699 DC    AL1(54)                                                  05391000
@NM00700 DC    AL1(58)                                                  05392000
@NM00701 DC    AL1(20)                                                  05393000
@NM00702 DC    AL1(1)                                                   05394000
@NM00703 DC    AL1(0)                                                   05395000
@NM00704 DC    AL1(70)                                                  05396000
@NM00705 DC    AL1(0)                                                   05397000
         ORG   GP4S82B+9                                                05398000
         DS    CL3                                                      05399000
GP4S82C  DS    CL5                                                      05400000
         ORG   GP4S82C                                                  05401000
@NM00706 DC    AL1(17)                                                  05402000
@NM00707 DC    AL1(96)                                                  05403000
@NM00708 DC    AL1(54)                                                  05404000
@NM00709 DC    AL1(0)                                                   05405000
@NM00710 DC    AL1(0)                                                   05406000
         ORG   GP4S82C+5                                                05407000
         DS    CL3                                                      05408000
GP4S86   DS    CL13                                                     05409000
         ORG   GP4S86                                                   05410000
@NM00711 DC    AL1(21)                                                  05411000
@NM00712 DC    AL1(67)                                                  05412000
@NM00713 DC    AL1(52)                                                  05413000
@NM00714 DC    AL1(58)                                                  05414000
@NM00715 DC    AL1(20)                                                  05415000
@NM00716 DC    AL1(3)                                                   05416000
@NM00717 DC    AL1(0)                                                   05417000
@NM00718 DC    AL1(67)                                                  05418000
@NM00719 DC    AL1(21)                                                  05419000
@NM00720 DC    AL1(36)                                                  05420000
@NM00721 DC    AL1(77)                                                  05421000
@NM00722 DC    AL1(82)                                                  05422000
@NM00723 DC    AL1(0)                                                   05423000
         ORG   GP4S86+13                                                05424000
         DS    CL3                                                      05425000
GP4S88   DS    CL13                                                     05426000
         ORG   GP4S88                                                   05427000
@NM00724 DC    AL1(21)                                                  05428000
@NM00725 DC    AL1(35)                                                  05429000
@NM00726 DC    AL1(52)                                                  05430000
@NM00727 DC    AL1(57)                                                  05431000
@NM00728 DC    AL1(21)                                                  05432000
@NM00729 DC    AL1(80)                                                  05433000
@NM00730 DC    AL1(67)                                                  05434000
@NM00731 DC    AL1(74)                                                  05435000
@NM00732 DC    AL1(21)                                                  05436000
@NM00733 DC    AL1(80)                                                  05437000
@NM00734 DC    AL1(78)                                                  05438000
@NM00735 DC    AL1(85)                                                  05439000
@NM00736 DC    AL1(0)                                                   05440000
         ORG   GP4S88+13                                                05441000
         DS    CL3                                                      05442000
GP4S98   DS    CL21                                                     05443000
         ORG   GP4S98                                                   05444000
@NM00737 DC    AL1(21)                                                  05445000
@NM00738 DC    AL1(67)                                                  05446000
@NM00739 DC    AL1(52)                                                  05447000
@NM00740 DC    AL1(58)                                                  05448000
@NM00741 DC    AL1(20)                                                  05449000
@NM00742 DC    AL1(0)                                                   05450000
@NM00743 DC    AL1(0)                                                   05451000
@NM00744 DC    AL1(68)                                                  05452000
@NM00745 DC    AL1(53)                                                  05453000
@NM00746 DC    AL1(47)                                                  05454000
@NM00747 DC    AL1(68)                                                  05455000
@NM00748 DC    AL1(72)                                                  05456000
@NM00749 DC    AL1(52)                                                  05457000
@NM00750 DC    AL1(15)                                                  05458000
@NM00751 DC    AL1(0)                                                   05459000
@NM00752 DC    AL1(88)                                                  05460000
@NM00753 DC    AL1(52)                                                  05461000
@NM00754 DC    AL1(11)                                                  05462000
@NM00755 DC    AL1(0)                                                   05463000
@NM00756 DC    AL1(104)                                                 05464000
@NM00757 DC    AL1(0)                                                   05465000
         ORG   GP4S98+21                                                05466000
         DS    CL1                                                      05467000
HEXTEST  DC    H'128'                                                   05468000
         DC    H'64'                                                    05469000
         DC    H'32'                                                    05470000
         DC    H'16'                                                    05471000
         DC    H'8'                                                     05472000
         DC    H'4'                                                     05473000
         DC    H'2'                                                     05474000
         DC    H'1'                                                     05475000
         DS    CL2                                                      05476000
PATCH    DC    30F'0'                                                   05477000
CP0001@  DC    AL4(S00)                                                 05478000
         DC    AL4(GP2)                                                 05479000
         DC    AL4(GP2)                                                 05480000
         DC    AL4(G1)                                                  05481000
         DC    AL4(GP2)                                                 05482000
         DC    AL4(GP2)                                                 05483000
         DC    AL4(S06)                                                 05484000
         DC    AL4(S06)                                                 05485000
         DC    AL4(S08)                                                 05486000
         DC    AL4(S08)                                                 05487000
         DC    AL4(G1)                                                  05488000
         DC    AL4(G1)                                                  05489000
         DC    AL4(G1)                                                  05490000
         DC    AL4(S13)                                                 05491000
         DC    AL4(S14)                                                 05492000
         DC    AL4(S15)                                                 05493000
         DC    AL4(S16)                                                 05494000
         DC    AL4(GP2)                                                 05495000
         DC    AL4(GP2)                                                 05496000
         DC    AL4(GP2)                                                 05497000
         DC    AL4(GP2)                                                 05498000
         DC    AL4(S21)                                                 05499000
         DC    AL4(GP2)                                                 05500000
         DC    AL4(GP2)                                                 05501000
         DC    AL4(GP3)                                                 05502000
         DC    AL4(S25)                                                 05503000
         DC    AL4(S26)                                                 05504000
         DC    AL4(S27)                                                 05505000
         DC    AL4(S13)                                                 05506000
         DC    AL4(S29)                                                 05507000
         DC    AL4(S30)                                                 05508000
         DC    AL4(GP3)                                                 05509000
         DC    AL4(S32)                                                 05510000
         DC    AL4(S32)                                                 05511000
         DC    AL4(G1)                                                  05512000
         DC    AL4(GP2)                                                 05513000
         DC    AL4(G1)                                                  05514000
         DC    AL4(GP2)                                                 05515000
         DC    AL4(G1)                                                  05516000
         DC    AL4(GP2)                                                 05517000
         DC    AL4(GP2)                                                 05518000
         DC    AL4(S08)                                                 05519000
         DC    AL4(S42)                                                 05520000
         DC    AL4(G1)                                                  05521000
         DC    AL4(S44)                                                 05522000
         DC    AL4(GP2)                                                 05523000
         DC    AL4(G1)                                                  05524000
         DC    AL4(GP2)                                                 05525000
         DC    AL4(S48)                                                 05526000
         DC    AL4(G1)                                                  05527000
         DC    AL4(G1)                                                  05528000
         DC    AL4(GP2)                                                 05529000
         DC    AL4(S52)                                                 05530000
         DC    AL4(GP3)                                                 05531000
         DC    AL4(S00)                                                 05532000
         DC    AL4(GP3)                                                 05533000
         DC    AL4(S48)                                                 05534000
         DC    AL4(GP3)                                                 05535000
         DC    AL4(GP3)                                                 05536000
         DC    AL4(G1)                                                  05537000
         DC    AL4(GP2)                                                 05538000
         DC    AL4(G1)                                                  05539000
         DC    AL4(S44)                                                 05540000
         DC    AL4(GP2)                                                 05541000
         DC    AL4(GP2)                                                 05542000
         DC    AL4(G1)                                                  05543000
         DC    AL4(S66)                                                 05544000
         DC    AL4(G1)                                                  05545000
         DC    AL4(S13)                                                 05546000
         DC    AL4(GP3)                                                 05547000
         DC    AL4(GP2)                                                 05548000
         DC    AL4(S71)                                                 05549000
         DC    AL4(G1)                                                  05550000
         DC    AL4(GP2)                                                 05551000
         DC    AL4(GP2)                                                 05552000
         DC    AL4(S75)                                                 05553000
         DC    AL4(G1)                                                  05554000
         DC    AL4(G1)                                                  05555000
         DC    AL4(S32)                                                 05556000
         DC    AL4(G1)                                                  05557000
         DC    AL4(GP2)                                                 05558000
         DC    AL4(S71)                                                 05559000
         DC    AL4(S82)                                                 05560000
         DC    AL4(G1)                                                  05561000
         DC    AL4(G1)                                                  05562000
         DC    AL4(G1)                                                  05563000
         DC    AL4(S86)                                                 05564000
         DC    AL4(GP2)                                                 05565000
         DC    AL4(S88)                                                 05566000
         DC    AL4(G1)                                                  05567000
         DC    AL4(G1)                                                  05568000
         DC    AL4(G1)                                                  05569000
         DC    AL4(S00)                                                 05570000
         DC    AL4(G1)                                                  05571000
         DC    AL4(G1)                                                  05572000
         DC    AL4(G1)                                                  05573000
         DC    AL4(GP2)                                                 05574000
         DC    AL4(G1)                                                  05575000
         DC    AL4(S98)                                                 05576000
         DC    AL4(G1)                                                  05577000
         DC    AL4(G1)                                                  05578000
         DC    AL4(G1)                                                  05579000
         DC    AL4(GP2)                                                 05580000
         DC    AL4(G1)                                                  05581000
         DC    AL4(G1)                                                  05582000
         DC    AL4(G1)                                                  05583000
         DC    AL4(G1)                                                  05584000
         DC    AL4(G1)                                                  05585000
         DC    AL4(G1)                                                  05586000
         DC    AL4(G1)                                                  05587000
         DC    AL4(G1)                                                  05588000
         DC    AL4(G1)                                                  05589000
         DC    AL4(G1)                                                  05590000
         DC    AL4(G1)                                                  05591000
         DC    AL4(S00)                                                 05592000
         DC    AL4(G1)                                                  05593000
         DC    AL4(G1)                                                  05594000
         DC    AL4(G1)                                                  05595000
         DC    AL4(G1)                                                  05596000
         DC    AL4(G1)                                                  05597000
         DC    AL4(G1)                                                  05598000
         DC    AL4(G1)                                                  05599000
         DC    AL4(G1)                                                  05600000
         DC    AL4(G1)                                                  05601000
         DC    AL4(G1)                                                  05602000
         DC    AL4(G1)                                                  05603000
         DC    AL4(G1)                                                  05604000
         DC    AL4(G1)                                                  05605000
         DC    AL4(G1)                                                  05606000
         DC    AL4(G1)                                                  05607000
         DC    AL4(G1)                                                  05608000
         DC    AL4(G1)                                                  05609000
         DC    AL4(G1)                                                  05610000
         DC    AL4(G1)                                                  05611000
         DC    AL4(G1)                                                  05612000
         DC    AL4(G1)                                                  05613000
         DC    AL4(G1)                                                  05614000
         DC    AL4(G1)                                                  05615000
         DC    AL4(G1)                                                  05616000
         DC    AL4(G1)                                                  05617000
         DC    AL4(G1)                                                  05618000
         DC    AL4(G1)                                                  05619000
         DC    AL4(G1)                                                  05620000
         DC    AL4(G1)                                                  05621000
         DC    AL4(G1)                                                  05622000
         DC    AL4(G1)                                                  05623000
         DC    AL4(G1)                                                  05624000
         DC    AL4(G1)                                                  05625000
         DC    AL4(G1)                                                  05626000
         DC    AL4(G1)                                                  05627000
         DC    AL4(G1)                                                  05628000
         DC    AL4(G1)                                                  05629000
         DC    AL4(G1)                                                  05630000
         DC    AL4(G1)                                                  05631000
         DC    AL4(G1)                                                  05632000
         DC    AL4(G1)                                                  05633000
         DC    AL4(G1)                                                  05634000
         DC    AL4(G1)                                                  05635000
         DC    AL4(G1)                                                  05636000
         DC    AL4(G1)                                                  05637000
         DC    AL4(G1)                                                  05638000
         DC    AL4(G1)                                                  05639000
         DC    AL4(G1)                                                  05640000
         DC    AL4(G1)                                                  05641000
         DC    AL4(G1)                                                  05642000
         DC    AL4(G1)                                                  05643000
         DC    AL4(G1)                                                  05644000
         DC    AL4(G1)                                                  05645000
         DC    AL4(G1)                                                  05646000
         DC    AL4(G1)                                                  05647000
         DC    AL4(G1)                                                  05648000
         DC    AL4(G1)                                                  05649000
         DC    AL4(G1)                                                  05650000
         DC    AL4(G1)                                                  05651000
         DC    AL4(G1)                                                  05652000
         DC    AL4(G1)                                                  05653000
         DC    AL4(G1)                                                  05654000
         DC    AL4(G1)                                                  05655000
         DC    AL4(G1)                                                  05656000
         DC    AL4(G1)                                                  05657000
         DC    AL4(G1)                                                  05658000
         DC    AL4(G1)                                                  05659000
         DC    AL4(G1)                                                  05660000
         DC    AL4(G1)                                                  05661000
         DC    AL4(G1)                                                  05662000
         DC    AL4(G1)                                                  05663000
         DC    AL4(G1)                                                  05664000
         DC    AL4(G1)                                                  05665000
         DC    AL4(G1)                                                  05666000
         DC    AL4(G1)                                                  05667000
         DC    AL4(G1)                                                  05668000
         DC    AL4(G1)                                                  05669000
         DC    AL4(G1)                                                  05670000
         DC    AL4(G1)                                                  05671000
         DC    AL4(G1)                                                  05672000
         DC    AL4(G1)                                                  05673000
         DC    AL4(G1)                                                  05674000
         DC    AL4(G1)                                                  05675000
         DC    AL4(G1)                                                  05676000
         DC    AL4(G1)                                                  05677000
         DC    AL4(G1)                                                  05678000
         DC    AL4(G1)                                                  05679000
         DC    AL4(G1)                                                  05680000
         DC    AL4(G1)                                                  05681000
         DC    AL4(G1)                                                  05682000
         DC    AL4(G1)                                                  05683000
         DC    AL4(G1)                                                  05684000
         DC    AL4(G1)                                                  05685000
         DC    AL4(G1)                                                  05686000
         DC    AL4(G1)                                                  05687000
         DC    AL4(G1)                                                  05688000
         DC    AL4(G1)                                                  05689000
         DC    AL4(G1)                                                  05690000
         DC    AL4(G1)                                                  05691000
         DC    AL4(G1)                                                  05692000
         DC    AL4(G1)                                                  05693000
         DC    AL4(G1)                                                  05694000
         DC    AL4(G1)                                                  05695000
         DC    AL4(G1)                                                  05696000
         DC    AL4(G1)                                                  05697000
         DC    AL4(G1)                                                  05698000
         DC    AL4(G1)                                                  05699000
         DC    AL4(G1)                                                  05700000
         DC    AL4(G1)                                                  05701000
         DC    AL4(G1)                                                  05702000
         DC    AL4(G1)                                                  05703000
         DC    AL4(G1)                                                  05704000
         DC    AL4(G1)                                                  05705000
         DC    AL4(G1)                                                  05706000
         DC    AL4(G1)                                                  05707000
         DC    AL4(G1)                                                  05708000
         DC    AL4(G1)                                                  05709000
         DC    AL4(G1)                                                  05710000
         DC    AL4(G1)                                                  05711000
         DC    AL4(G1)                                                  05712000
         DC    AL4(G1)                                                  05713000
         DC    AL4(G1)                                                  05714000
         DC    AL4(G1)                                                  05715000
         DC    AL4(G1)                                                  05716000
         DC    AL4(G1)                                                  05717000
         DC    AL4(G1)                                                  05718000
         DC    AL4(G1)                                                  05719000
         DC    AL4(G1)                                                  05720000
         DC    AL4(G1)                                                  05721000
         DC    AL4(G1)                                                  05722000
         DC    AL4(G1)                                                  05723000
         DC    AL4(G1)                                                  05724000
         DC    AL4(G1)                                                  05725000
         DC    AL4(G1)                                                  05726000
         DC    AL4(G1)                                                  05727000
         DC    AL4(G1)                                                  05728000
         DC    AL4(G1)                                                  05729000
         DC    AL4(G1)                                                  05730000
         DC    AL4(G1)                                                  05731000
         DC    AL4(G1)                                                  05732000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       05733000
@01      EQU   01                                                       05734000
@02      EQU   02                                                       05735000
@03      EQU   03                                                       05736000
@04      EQU   04                                                       05737000
@05      EQU   05                                                       05738000
@06      EQU   06                                                       05739000
@07      EQU   07                                                       05740000
@08      EQU   08                                                       05741000
@09      EQU   09                                                       05742000
@10      EQU   10                                                       05743000
@11      EQU   11                                                       05744000
@12      EQU   12                                                       05745000
@13      EQU   13                                                       05746000
@14      EQU   14                                                       05747000
@15      EQU   15                                                       05748000
MOD      EQU   @07                                                      05749000
K        EQU   @04                                                      05750000
J        EQU   @07                                                      05751000
I        EQU   @04                                                      05752000
CNVTSVC  EQU   @04                                                      05753000
SVCNUMBR EQU   @07                                                      05754000
PLISTPTR EQU   @06                                                      05755000
AEDITCBR EQU   @09                                                      05756000
R0       EQU   @00                                                      05757000
R1       EQU   @01                                                      05758000
R9       EQU   @09                                                      05759000
R10      EQU   @10                                                      05760000
R13      EQU   @13                                                      05761000
R14      EQU   @14                                                      05762000
R15      EQU   @15                                                      05763000
RETCODE  EQU   @15                                                      05764000
R11      EQU   @11                                                      05765000
R12      EQU   @12                                                      05766000
R2       EQU   @02                                                      05767000
R3       EQU   @03                                                      05768000
R4       EQU   @04                                                      05769000
R5       EQU   @05                                                      05770000
R6       EQU   @06                                                      05771000
R7       EQU   @07                                                      05772000
R8       EQU   @08                                                      05773000
AMDPRTAB EQU   0                                                        05774000
DEBGFLGS EQU   AMDPRTAB+8                                               05775000
PTHFLGS1 EQU   DEBGFLGS                                                 05776000
PTHFLGS2 EQU   DEBGFLGS+1                                               05777000
INRFCFGS EQU   DEBGFLGS+2                                               05778000
IOFLGS   EQU   DEBGFLGS+3                                               05779000
STARTIME EQU   AMDPRTAB+40                                              05780000
STOPTIME EQU   AMDPRTAB+52                                              05781000
NAMES    EQU   AMDPRTAB+64                                              05782000
ADS      EQU   AMDPRTAB+104                                             05783000
AADS     EQU   ADS                                                      05784000
SIF      EQU   AMDPRTAB+124                                             05785000
SIOFLGS  EQU   SIF                                                      05786000
DVADS1   EQU   AMDPRTAB+128                                             05787000
IO       EQU   AMDPRTAB+228                                             05788000
IOFLGS2  EQU   IO                                                       05789000
DVADS2   EQU   AMDPRTAB+232                                             05790000
VCF      EQU   AMDPRTAB+332                                             05791000
SVCFLGS  EQU   VCF                                                      05792000
ALLV     EQU   SVCFLGS                                                  05793000
SVCNUMS  EQU   AMDPRTAB+336                                             05794000
USR      EQU   AMDPRTAB+368                                             05795000
USRFLGS  EQU   USR                                                      05796000
USRTAB   EQU   AMDPRTAB+372                                             05797000
PI       EQU   AMDPRTAB+452                                             05798000
PIFLGS   EQU   PI                                                       05799000
PGMNGEN  EQU   AMDPRTAB+456                                             05800000
GENFLAGS EQU   PGMNGEN+3                                                05801000
GENFLGS1 EQU   AMDPRTAB+460                                             05802000
ESTARTME EQU   AMDPRTAB+500                                             05803000
ESTOPTME EQU   AMDPRTAB+509                                             05804000
ABDPL    EQU   0                                                        05805000
ADPLFLAG EQU   ABDPL+7                                                  05806000
ADPLFMT1 EQU   ABDPL+44                                                 05807000
ADPLFMT2 EQU   ABDPL+48                                                 05808000
PLIST    EQU   0                                                        05809000
RECPTR   EQU   PLIST                                                    05810000
DATAPTR  EQU   PLIST+16                                                 05811000
FMTADDR  EQU   PLIST+20                                                 05812000
DYNAMSTG EQU   PLIST+24                                                 05813000
SNAPPARM EQU   PLIST+28                                                 05814000
NXTFIELD EQU   0                                                        05815000
AMDPRFMT EQU   0                                                        05816000
BASICRCD EQU   0                                                        05817000
ASCBFLD  EQU   BASICRCD                                                 05818000
ERRECORD EQU   ASCBFLD                                                  05819000
PSWFLD   EQU   BASICRCD+14                                              05820000
SYSSVC   EQU   PSWFLD+3                                                 05821000
R15FLD   EQU   BASICRCD+34                                              05822000
LSVC81R  EQU   0                                                        05823000
GRP2RCD  EQU   0                                                        05824000
GRP2LNTH EQU   GRP2RCD                                                  05825000
GRP3RCD  EQU   0                                                        05826000
GRP3DDN  EQU   GRP3RCD                                                  05827000
GP4RCD0  EQU   0                                                        05828000
RCD0DDN  EQU   GP4RCD0                                                  05829000
RCD0DCB  EQU   GP4RCD0+8                                                05830000
RCD0DEB  EQU   GP4RCD0+12                                               05831000
GP4RCD6  EQU   0                                                        05832000
EPDENM1  EQU   GP4RCD6                                                  05833000
RCD6LST  EQU   GP4RCD6+8                                                05834000
GP4RCD8  EQU   0                                                        05835000
EPDENM2  EQU   GP4RCD8                                                  05836000
GP4RCD13 EQU   0                                                        05837000
COMPCODE EQU   GP4RCD13                                                 05838000
GP4RCD14 EQU   0                                                        05839000
PICA     EQU   GP4RCD14                                                 05840000
GP4RCD15 EQU   0                                                        05841000
RCD15DDN EQU   GP4RCD15                                                 05842000
ERRFLGS  EQU   GP4RCD15+8                                               05843000
RCD15TCB EQU   GP4RCD15+9                                               05844000
RCD15CUU EQU   GP4RCD15+13                                              05845000
GP4RCD16 EQU   0                                                        05846000
RCD16DDN EQU   GP4RCD16                                                 05847000
RCD16DCB EQU   GP4RCD16+8                                               05848000
PPL      EQU   GP4RCD16+12                                              05849000
GP4RCD21 EQU   0                                                        05850000
RCD21DDN EQU   GP4RCD21                                                 05851000
RCD21LN  EQU   GP4RCD21+8                                               05852000
GP4RCD25 EQU   0                                                        05853000
RCD25DDN EQU   GP4RCD25                                                 05854000
DCBFDAD  EQU   GP4RCD25+8                                               05855000
GP4RCD26 EQU   0                                                        05856000
RCD26LN  EQU   GP4RCD26                                                 05857000
GP4RCD27 EQU   0                                                        05858000
RCD27LST EQU   GP4RCD27                                                 05859000
RCD27LN  EQU   GP4RCD27+22                                              05860000
GP4RCD29 EQU   0                                                        05861000
RCD29LST EQU   GP4RCD29                                                 05862000
RCD29LN  EQU   GP4RCD29+16                                              05863000
GP4RCD30 EQU   0                                                        05864000
RCD30LST EQU   GP4RCD30                                                 05865000
RCD30LN  EQU   GP4RCD30+16                                              05866000
GP4RCD32 EQU   0                                                        05867000
RCD32CUU EQU   GP4RCD32                                                 05868000
RCD32LN  EQU   GP4RCD32+2                                               05869000
GP4RCD42 EQU   0                                                        05870000
RCD42LN  EQU   GP4RCD42                                                 05871000
GP4RCD44 EQU   0                                                        05872000
TCBADDR  EQU   GP4RCD44                                                 05873000
GP4RCD48 EQU   0                                                        05874000
RCD48LST EQU   GP4RCD48                                                 05875000
MAJORNM  EQU   GP4RCD48+20                                              05876000
RCD48LN  EQU   GP4RCD48+28                                              05877000
GP4RCD52 EQU   0                                                        05878000
RCD52LST EQU   GP4RCD52                                                 05879000
ERRCHECK EQU   RCD52LST                                                 05880000
GP4RCD66 EQU   0                                                        05881000
IOBERR   EQU   GP4RCD66                                                 05882000
GP4RCD71 EQU   0                                                        05883000
RCD71DDN EQU   GP4RCD71                                                 05884000
RCD71LST EQU   GP4RCD71+8                                               05885000
RCD81LNG EQU   GP4RCD71+24                                              05886000
GP4RCD75 EQU   0                                                        05887000
RCD75LN  EQU   GP4RCD75                                                 05888000
GP4RCD82 EQU   0                                                        05889000
VOLSER1  EQU   GP4RCD82                                                 05890000
RCD82LN  EQU   GP4RCD82+6                                               05891000
GP4RCD86 EQU   0                                                        05892000
RCD86LST EQU   GP4RCD86                                                 05893000
TTR      EQU   GP4RCD86+8                                               05894000
GP4RCD88 EQU   0                                                        05895000
RCD88DEB EQU   GP4RCD88                                                 05896000
DSSTAT   EQU   GP4RCD88+4                                               05897000
DEVMOD   EQU   GP4RCD88+5                                               05898000
GP4RCD98 EQU   0                                                        05899000
RCD98LST EQU   GP4RCD98                                                 05900000
RCD98LN  EQU   GP4RCD98+4                                               05901000
CL0001@  EQU   0                                                        05902000
ABDPLPTR EQU   SNAPPARM                                                 05903000
SVCLIST  EQU   SVCNUMS                                                  05904000
PTRNMAPS EQU   DYNAMPTN                                                 05905000
OLDFLG   EQU   PTRNMAPS                                                 05906000
OLDLN    EQU   PTRNMAPS+1                                               05907000
UNPAKFRM EQU   PAKEDSVC                                                 05908000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    05909000
@NM00004 EQU   PTRNMAPS+3                                               05910000
@NM00003 EQU   PTRNMAPS+2                                               05911000
@NM00008 EQU   GP4RCD71+20                                              05912000
VOLSER   EQU   GP4RCD27+16                                              05913000
DCBTRKBC EQU   GP4RCD25+16                                              05914000
R1FLD    EQU   BASICRCD+42                                              05915000
R0FLD    EQU   BASICRCD+38                                              05916000
CDENMFLD EQU   BASICRCD+26                                              05917000
TCBFLD   EQU   BASICRCD+22                                              05918000
@NM00007 EQU   PSWFLD+4                                                 05919000
@NM00006 EQU   PSWFLD                                                   05920000
JOBNMFLD EQU   BASICRCD+6                                               05921000
CPUIDFLD EQU   BASICRCD+4                                               05922000
@NM00005 EQU   ASCBFLD+2                                                05923000
EIDPTR   EQU   PLIST+12                                                 05924000
GTFOPTR  EQU   PLIST+8                                                  05925000
BUFFER   EQU   PLIST+4                                                  05926000
ADPLEXT  EQU   ABDPL+52                                                 05927000
ADPLCOM4 EQU   ABDPL+40                                                 05928000
ADPLCOM3 EQU   ABDPL+36                                                 05929000
ADPLCOM2 EQU   ABDPL+32                                                 05930000
ADPLCOM1 EQU   ABDPL+28                                                 05931000
ADPLFRMT EQU   ABDPL+24                                                 05932000
ADPLMEMA EQU   ABDPL+20                                                 05933000
ADPLCVT  EQU   ABDPL+16                                                 05934000
ADPLPRNT EQU   ABDPL+12                                                 05935000
ADPLBUF  EQU   ABDPL+8                                                  05936000
@NM00002 EQU   ADPLFLAG                                                 05937000
ADPLSYTM EQU   ADPLFLAG                                                 05938000
ADPLSNPR EQU   ADPLFLAG                                                 05939000
ADPLSBPL EQU   ABDPL+6                                                  05940000
ADPLASID EQU   ABDPL+4                                                  05941000
ADPLTCB  EQU   ABDPL                                                    05942000
RESERVED EQU   AMDPRTAB+522                                             05943000
CVTTZONE EQU   AMDPRTAB+518                                             05944000
ESPSEC   EQU   ESTOPTME+7                                               05945000
ESPMIN   EQU   ESTOPTME+5                                               05946000
ESPHR    EQU   ESTOPTME+3                                               05947000
ESPDAY   EQU   ESTOPTME                                                 05948000
ESSEC    EQU   ESTARTME+7                                               05949000
ESMIN    EQU   ESTARTME+5                                               05950000
ESHR     EQU   ESTARTME+3                                               05951000
ESDAY    EQU   ESTARTME                                                 05952000
ADTSBUF  EQU   AMDPRTAB+496                                             05953000
OFSTDATA EQU   AMDPRTAB+494                                             05954000
OFSTEID  EQU   AMDPRTAB+492                                             05955000
AFRMAD   EQU   AMDPRTAB+488                                             05956000
REENTWKA EQU   AMDPRTAB+484                                             05957000
PRFMTADD EQU   AMDPRTAB+480                                             05958000
AEIOCT   EQU   AMDPRTAB+476                                             05959000
EXITADDR EQU   AMDPRTAB+472                                             05960000
EXITNM   EQU   AMDPRTAB+464                                             05961000
RECDLL   EQU   AMDPRTAB+461                                             05962000
@NM00001 EQU   GENFLGS1                                                 05963000
FIRSTHSW EQU   GENFLGS1                                                 05964000
TSFOUND  EQU   GENFLGS1                                                 05965000
EOFINPRO EQU   GENFLGS1                                                 05966000
TS       EQU   GENFLGS1                                                 05967000
EOF      EQU   GENFLAGS                                                 05968000
RR       EQU   GENFLAGS                                                 05969000
SRM      EQU   GENFLAGS                                                 05970000
RNIO     EQU   GENFLAGS                                                 05971000
SYSM     EQU   GENFLAGS                                                 05972000
SYS      EQU   GENFLAGS                                                 05973000
DSP      EQU   GENFLAGS                                                 05974000
EXT      EQU   GENFLAGS                                                 05975000
PICODEA  EQU   PGMNGEN+2                                                05976000
PICODES  EQU   PGMNGEN                                                  05977000
Q        EQU   PI+1                                                     05978000
P01R     EQU   PIFLGS                                                   05979000
SELP     EQU   PIFLGS                                                   05980000
ALLP     EQU   PIFLGS                                                   05981000
USRNGTAB EQU   USRTAB                                                   05982000
O        EQU   USR+1                                                    05983000
N01R     EQU   USRFLGS                                                  05984000
SELU     EQU   USRFLGS                                                  05985000
ALLU     EQU   USRFLGS                                                  05986000
M        EQU   VCF+1                                                    05987000
L        EQU   SVCFLGS                                                  05988000
SELV     EQU   SVCFLGS                                                  05989000
IODVADS  EQU   DVADS2                                                   05990000
K01RES   EQU   IO+1                                                     05991000
JJ       EQU   IOFLGS2                                                  05992000
SELI     EQU   IOFLGS2                                                  05993000
ALLI     EQU   IOFLGS2                                                  05994000
SIODVADS EQU   DVADS1                                                   05995000
II       EQU   SIF+1                                                    05996000
H        EQU   SIOFLGS                                                  05997000
NOEQU    EQU   SIOFLGS                                                  05998000
EQUIV    EQU   SIOFLGS                                                  05999000
SELS     EQU   SIOFLGS                                                  06000000
ALLS     EQU   SIOFLGS                                                  06001000
ASCBADDR EQU   AADS                                                     06002000
JOBNAMES EQU   NAMES                                                    06003000
DAY2     EQU   STOPTIME+10                                              06004000
F        EQU   STOPTIME+8                                               06005000
TIME2    EQU   STOPTIME                                                 06006000
DAY      EQU   STARTIME+10                                              06007000
D        EQU   STARTIME+8                                               06008000
TIME     EQU   STARTIME                                                 06009000
DDNAME   EQU   AMDPRTAB+32                                              06010000
USEREXIT EQU   AMDPRTAB+24                                              06011000
GTFWDPTR EQU   AMDPRTAB+20                                              06012000
C        EQU   DEBGFLGS+4                                               06013000
B        EQU   IOFLGS                                                   06014000
GETEOF   EQU   IOFLGS                                                   06015000
DMDFMT   EQU   INRFCFGS                                                 06016000
EDITSTOP EQU   INRFCFGS                                                 06017000
EXTTRC   EQU   INRFCFGS                                                 06018000
RET      EQU   INRFCFGS                                                 06019000
FMT      EQU   INRFCFGS                                                 06020000
SPIE     EQU   INRFCFGS                                                 06021000
TERM     EQU   INRFCFGS                                                 06022000
FLMODE   EQU   INRFCFGS                                                 06023000
REMAIN   EQU   PTHFLGS2                                                 06024000
APP      EQU   PTHFLGS2                                                 06025000
REXT     EQU   PTHFLGS1                                                 06026000
FRM      EQU   PTHFLGS1                                                 06027000
FLT      EQU   PTHFLGS1                                                 06028000
HEX      EQU   PTHFLGS1                                                 06029000
CON      EQU   PTHFLGS1                                                 06030000
GET      EQU   PTHFLGS1                                                 06031000
SCN      EQU   PTHFLGS1                                                 06032000
ROOT     EQU   PTHFLGS1                                                 06033000
CURREC   EQU   AMDPRTAB+4                                               06034000
AFMG     EQU   AMDPRTAB                                                 06035000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      06036000
@RF00173 EQU   @RC00158                                                 06037000
@RC00215 EQU   CE0001@                                                  06038000
@RC00221 EQU   CE0001@                                                  06039000
@RC00262 EQU   CE0001@                                                  06040000
@RC00274 EQU   CE0001@                                                  06041000
@RC00297 EQU   CE0001@                                                  06042000
@RC00318 EQU   CE0001@                                                  06043000
@RC00338 EQU   CE0001@                                                  06044000
@RC00360 EQU   CE0001@                                                  06045000
@RC00375 EQU   CE0001@                                                  06046000
@RC00400 EQU   CE0001@                                                  06047000
@RC00427 EQU   CE0001@                                                  06048000
@RC00455 EQU   CE0001@                                                  06049000
@RF00509 EQU   @RC00507                                                 06050000
@RC00513 EQU   @RC00507                                                 06051000
@RC00480 EQU   CE0001@                                                  06052000
@RC00483 EQU   CE0001@                                                  06053000
@RC00503 EQU   CE0001@                                                  06054000
@RF00599 EQU   @RC00597                                                 06055000
@RC00603 EQU   @RC00597                                                 06056000
@RC00576 EQU   CE0001@                                                  06057000
@RC00579 EQU   CE0001@                                                  06058000
@RF00653 EQU   @RC00651                                                 06059000
@RC00657 EQU   @RC00651                                                 06060000
@RC00627 EQU   CE0001@                                                  06061000
@RC00630 EQU   CE0001@                                                  06062000
@RC00648 EQU   CE0001@                                                  06063000
@RF00741 EQU   @RC00739                                                 06064000
@RC00745 EQU   @RC00739                                                 06065000
@RF00768 EQU   @RC00766                                                 06066000
@RC00772 EQU   @RC00766                                                 06067000
@RC00716 EQU   CE0001@                                                  06068000
@RC00719 EQU   CE0001@                                                  06069000
@RC00736 EQU   CE0001@                                                  06070000
@RF00842 EQU   @RC00840                                                 06071000
@RC00846 EQU   @RC00840                                                 06072000
@RC00831 EQU   CE0001@                                                  06073000
@RT00917 EQU   FMTPLIST                                                 06074000
@RC00950 EQU   @RC00948                                                 06075000
@RC00955 EQU   @RC00948                                                 06076000
@RC00870 EQU   CE0001@                                                  06077000
@RC00873 EQU   CE0001@                                                  06078000
@RC00909 EQU   CE0001@                                                  06079000
@RC00978 EQU   CE0001@                                                  06080000
@RF01003 EQU   @RC01001                                                 06081000
@RC01007 EQU   @RC01001                                                 06082000
@RC00995 EQU   CE0001@                                                  06083000
@RC00998 EQU   CE0001@                                                  06084000
@RC01047 EQU   CE0001@                                                  06085000
@RC01050 EQU   CE0001@                                                  06086000
@RC01079 EQU   CE0001@                                                  06087000
@RF01082 EQU   CE0001@                                                  06088000
@RC01102 EQU   CE0001@                                                  06089000
@RC01111 EQU   CE0001@                                                  06090000
@RC01140 EQU   CE0001@                                                  06091000
@RC01162 EQU   CE0001@                                                  06092000
@RC01165 EQU   CE0001@                                                  06093000
@RC01216 EQU   CE0001@                                                  06094000
@RC01236 EQU   CE0001@                                                  06095000
@RC01265 EQU   @RC01263                                                 06096000
@RF01272 EQU   @RC01263                                                 06097000
@RC01276 EQU   @RC01263                                                 06098000
@RC01255 EQU   CE0001@                                                  06099000
@RC01053 EQU   @RC01050                                                 06100000
@RC01125 EQU   @RC01111                                                 06101000
@ENDDATA EQU   *                                                        06102000
         END   AMDSYS01,(C'PLS1655',0603,76069)                         06103000
