         TITLE 'AMDUSRFD - VTAM TRACE FORMATTER                        *00001000
                        '                                               00002000
AMDUSRFD CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'AMDUSRFD  77.035'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
         L     @00,@SIZDATD                                        0001 00014000
         GETMAIN  R,LV=(0)                                              00015000
         LR    @11,@01                                             0001 00016000
         USING @DATD,@11                                           0001 00017000
         ST    @13,@SA00001+4                                      0001 00018000
         LM    @00,@01,20(@13)                                     0001 00019000
         ST    @11,8(,@13)                                         0001 00020000
         LR    @13,@11                                             0001 00021000
*                                                                  0364 00022000
*   /*****************************************************************/ 00023000
*   /*                                                               */ 00024000
*   /* AMDUSRFD IS ENTERED FROM EDIT/ABDUMP THROUGH THIS ONE AND ONLY*/ 00025000
*   /* ENTRY POINT. IT MAY BE ENTERED DUE TO A NEW INPUT GTF RECORD  */ 00026000
*   /* (CONTAINING A VTAM GTRACE RECORD) OR TO CONTINUE PROCESSING A */ 00027000
*   /* PRIOR VTAM GTRACE RECORD. FIRST, SOME COMMON INITIALIZATION IS*/ 00028000
*   /* PERFORMED, REGARDLESS OF WHETHER THIS IS A NEW OR CONTINUATION*/ 00029000
*   /* RECORD.                                                       */ 00030000
*   /*                                                               */ 00031000
*   /*****************************************************************/ 00032000
*                                                                  0364 00033000
*   PARMSAVE=EDITPARM;              /* SAVE ADDRESS OF MAIN PARAMETER   00034000
*                                      LIST IN A NON-VOLATILE      0364 00035000
*                                      REGISTER                      */ 00036000
         LR    PARMSAVE,EDITPARM                                   0364 00037000
*   BUFFPTR=OUTBUF;                 /* SET POINTER TO OUTPUT BUFFER     00038000
*                                      TO BE USED ON THIS ENTRY. THIS   00039000
*                                      POINTER MUST BE REINITIALIZED    00040000
*                                      ON EACH ENTRY SINCE EDIT MAY     00041000
*                                      HAVE CHANGED IT.              */ 00042000
*                                                                  0365 00043000
         L     BUFFPTR,OUTBUF(,PARMSAVE)                           0365 00044000
*   /*****************************************************************/ 00045000
*   /*                                                               */ 00046000
*   /* VARIABLE NEXTLINE IS NOW USED TO DETERMINE HOW TO PROCESS THIS*/ 00047000
*   /* ENTRY TO AMDUSRFD. IF IT CONTAINS A ZERO, THIS IS A NEW INPUT */ 00048000
*   /* RECORD.                                                       */ 00049000
*   /*                                                               */ 00050000
*   /*****************************************************************/ 00051000
*                                                                  0366 00052000
*   IF NEXTLINE=0 THEN                                             0366 00053000
         SLR   @10,@10                                             0366 00054000
         L     @15,WORKAREA(,PARMSAVE)                             0366 00055000
         C     @10,NEXTLINE(,@15)                                  0366 00056000
         BNE   @RF00366                                            0366 00057000
*     DO;                                                          0367 00058000
*                                                                  0367 00059000
*       /*************************************************************/ 00060000
*       /*                                                           */ 00061000
*       /* A NEW INPUT RECORD HAS BEEN RECEIVED. BEFORE PROCESSING   */ 00062000
*       /* THE CONTENTS, MORE INITIALIZATION IS PERFORMED. CALCULATE */ 00063000
*       /* LENGTH OF VTAM PORTION OF INPUT RECORD BY SUBTRACTING GTF */ 00064000
*       /* PREFIX FROM TOTAL LENGTH OF INPUT RECORD                  */ 00065000
*       /*                                                           */ 00066000
*       /*************************************************************/ 00067000
*                                                                  0368 00068000
*       DATALNG=RECLEN-(DATAADDR-RECORDAD);                        0368 00069000
*                                                                  0368 00070000
         L     @14,RECORDAD(,PARMSAVE)                             0368 00071000
         L     @09,DATAADDR(,PARMSAVE)                             0368 00072000
         SLR   @09,@14                                             0368 00073000
         LCR   @09,@09                                             0368 00074000
         ICM   @08,12,RECLEN(@14)                                  0368 00075000
         SRA   @08,16                                              0368 00076000
         ALR   @09,@08                                             0368 00077000
         ST    @09,DATALNG(,@15)                                   0368 00078000
*       /*************************************************************/ 00079000
*       /*                                                           */ 00080000
*       /* INVESTIGATE THE EVENT IDENTIFIER (EID) VALUE IN THE INPUT */ 00081000
*       /* RECORD TO DETERMINE HOW TO PROCESS THIS FIRST LINE        */ 00082000
*       /*                                                           */ 00083000
*       /*************************************************************/ 00084000
*                                                                  0369 00085000
*       IF INPUTEID=ISTRPEID THEN                                  0369 00086000
         L     @14,EIDADDR(,PARMSAVE)                              0369 00087000
         CLC   INPUTEID(2,@14),@CH00594                            0369 00088000
         BNE   @RF00369                                            0369 00089000
*         DO;                       /* SMS BUFFER                    */ 00090000
*                                                                  0370 00091000
*           /*********************************************************/ 00092000
*           /*                                                       */ 00093000
*           /* MOVE IN LABELS INTO HEADER LINE                       */ 00094000
*           /*                                                       */ 00095000
*           /*********************************************************/ 00096000
*                                                                  0371 00097000
*           NM1=SMSVTAM;            /* VTAM CHARACTER STRING         */ 00098000
         MVC   NM1(4,BUFFPTR),SMSVTAM                              0371 00099000
*           NM2=SMSBUF;             /* BUFFER CHARACTER STRING       */ 00100000
         MVC   NM2(7,BUFFPTR),SMSBUF                               0372 00101000
*           NM3=SMSHD;              /* HEADER COLUMN ONE             */ 00102000
         MVC   NM3(14,BUFFPTR),SMSHD                               0373 00103000
*           NM4=SMSHD;              /* HEADER COLUMN TWO             */ 00104000
         MVC   NM4(14,BUFFPTR),SMSHD                               0374 00105000
*           NM5=SMSHD;              /* HEADER COLUMN THREE           */ 00106000
         MVC   NM5(14,BUFFPTR),SMSHD                               0375 00107000
*           NM6=SMSHD;              /* HEADER COLUMN FOUR            */ 00108000
         MVC   NM6(14,BUFFPTR),SMSHD                               0376 00109000
*           RETCODE=CONTINUE;       /* INDICATE MORE LINES TO FORMAT */ 00110000
         ST    @10,RETCODE(,@15)                                   0377 00111000
*           NEXTLINE=ADDR(AMDSMS01);/* CONTINUE ADDRESS FOR LINE TWO */ 00112000
         LA    @10,AMDSMS01                                        0378 00113000
         ST    @10,NEXTLINE(,@15)                                  0378 00114000
*         END;                                                     0379 00115000
*       ELSE                                                       0380 00116000
*         IF INPUTEID=ISTCLEID THEN                                0380 00117000
         B     @RC00369                                            0380 00118000
@RF00369 L     @10,EIDADDR(,PARMSAVE)                              0380 00119000
         CLC   INPUTEID(2,@10),@CH00592                            0380 00120000
         BNE   @RF00380                                            0380 00121000
*           DO;                                                    0381 00122000
*                                                                  0381 00123000
*             /*******************************************************/ 00124000
*             /*                                                     */ 00125000
*             /* PROCESS FIRST CONTROL LAYER LINE BY FIRST MOVING IN */ 00126000
*             /* ALL REQUIRED LABELS TO OUTPUT BUFFER.               */ 00127000
*             /*                                                     */ 00128000
*             /*******************************************************/ 00129000
*                                                                  0382 00130000
*             CLLABL=CTLAYER;       /* MOVE CONTROL LAYER INDICATOR     00131000
*                                      TO BUFFER                     */ 00132000
         MVC   CLLABL(3,BUFFPTR),CTLAYER                           0382 00133000
*             CLANODLB=ANODELAB;    /* MOVE ANODE LABEL TO BUFFER    */ 00134000
         MVC   CLANODLB(5,BUFFPTR),ANODELAB                        0383 00135000
*             CLTEXTLB=TEXTLAB;     /* MOVE TEXT LABEL TO BUFFER     */ 00136000
*                                                                  0384 00137000
         MVC   CLTEXTLB(4,BUFFPTR),TEXTLAB                         0384 00138000
*             /*******************************************************/ 00139000
*             /*                                                     */ 00140000
*             /* MOVE IN APPLICATION NODE NAME FROM INPUT RECORD,    */ 00141000
*             /* THEN INDICATE THE DIRECTION OF THE CONTROL LAYER    */ 00142000
*             /* BUFFER                                              */ 00143000
*             /*                                                     */ 00144000
*             /*******************************************************/ 00145000
*                                                                  0385 00146000
*             RFY                                                  0385 00147000
*               ISTTRAC BASED(DATAADDR);                           0385 00148000
*             CLANODAT=TRAANODE;    /* MOVE APPLICATION NODE NAME TO    00149000
*                                      BUFFER                        */ 00150000
         L     @10,DATAADDR(,PARMSAVE)                             0386 00151000
         MVC   CLANODAT(8,BUFFPTR),TRAANODE(@10)                   0386 00152000
*             IF TRADIO='1'B THEN                                  0387 00153000
         TM    TRADIO(@10),B'00001000'                             0387 00154000
         BNO   @RF00387                                            0387 00155000
*               CLINOUT=INBOUND;    /* IF RECORD INDICATES INBOUND,     00156000
*                                      MARK IT AS SUCH IN OUTPUT   0388 00157000
*                                      BUFFER                        */ 00158000
         MVI   CLINOUT+2(BUFFPTR),C' '                             0388 00159000
         MVC   CLINOUT(2,BUFFPTR),INBOUND                          0388 00160000
*             ELSE                                                 0389 00161000
*               CLINOUT=OUTBOUND;   /* OTHERWISE, SHOW AS OUTBOUND   */ 00162000
*                                                                  0389 00163000
         B     @RC00387                                            0389 00164000
@RF00387 MVC   CLINOUT(3,BUFFPTR),OUTBOUND                         0389 00165000
*             /*******************************************************/ 00166000
*             /*                                                     */ 00167000
*             /* HAVE THE TEXT PORTION OF THE LINE FORMATTED BY      */ 00168000
*             /* SUBROUTINE FRMTEXT.                                 */ 00169000
*             /*                                                     */ 00170000
*             /*******************************************************/ 00171000
*                                                                  0390 00172000
*             TEXTADDR=ADDR(TRABFFER);/* TEXT BEGINS AFTER ISTTRAC 0390 00173000
*                                      HEADER                        */ 00174000
@RC00387 L     @10,WORKAREA(,PARMSAVE)                             0390 00175000
         L     @15,DATAADDR(,PARMSAVE)                             0390 00176000
         LA    @14,TRABFFER(,@15)                                  0390 00177000
         ST    @14,TEXTADDR(,@10)                                  0390 00178000
*             TEXTLN=TRADATCT-LENGTH(TRAANODE);/* LENGTH IS IN TRACE    00179000
*                                      HEADER AND INCLUDES ANODE INFO*/ 00180000
         LH    @15,TRADATCT(,@15)                                  0391 00181000
         SL    @15,@CF00060                                        0391 00182000
         ST    @15,TEXTLN(,@10)                                    0391 00183000
*             CALL FRMTEXT;         /* CALL SUBROUTINE TO DO TEXT  0392 00184000
*                                      FORMATTING                    */ 00185000
*                                                                  0392 00186000
         BAL   @14,FRMTEXT                                         0392 00187000
*             /*******************************************************/ 00188000
*             /*                                                     */ 00189000
*             /* FIRST LINE IS NOW COMPLETE. SET UP TO PROCESS SECOND*/ 00190000
*             /* LINE.                                               */ 00191000
*             /*                                                     */ 00192000
*             /*******************************************************/ 00193000
*                                                                  0393 00194000
*             NEXTLINE=ADDR(AMDCLTR2);/* THIS IS THE ROUTINE WHICH 0393 00195000
*                                      WILL PROCESS SECOND LINE UPON    00196000
*                                      REENTRY FROM EDIT             */ 00197000
         L     @10,WORKAREA(,PARMSAVE)                             0393 00198000
         LA    @15,AMDCLTR2                                        0393 00199000
         ST    @15,NEXTLINE(,@10)                                  0393 00200000
*             RETCODE=CONTINUE;     /* RETURN CODE IS SET TO PRINT 0394 00201000
*                                      THIS BUFFER, AND RETURN TO  0394 00202000
*                                      AMDUSRFD TO PROCESS NEXT LINE */ 00203000
         SLR   @15,@15                                             0394 00204000
         ST    @15,RETCODE(,@10)                                   0394 00205000
*           END;                                                   0395 00206000
*         ELSE                                                     0396 00207000
*           IF INPUTEID=ISTTPEID THEN                              0396 00208000
         B     @RC00380                                            0396 00209000
@RF00380 L     @10,EIDADDR(,PARMSAVE)                              0396 00210000
         CLC   INPUTEID(2,@10),@CH00596                            0396 00211000
         BNE   @RF00396                                            0396 00212000
*             DO;                                                  0397 00213000
*                                                                  0397 00214000
*               /*****************************************************/ 00215000
*               /*                                                   */ 00216000
*               /* AMDTPTR1 -- THIS ROUTINE PROCESSES THE FIRST LINE */ 00217000
*               /* OF TPIOS OUTPUT FOR ALL TPIOS RECORDS. FIRST,     */ 00218000
*               /* APPLICABLE LABELS ARE MOVED TO THE OUTPUT BUFFER. */ 00219000
*               /*                                                   */ 00220000
*               /*****************************************************/ 00221000
*                                                                  0398 00222000
*               TPLABL=TPLAB;       /* MOVE TPIOS INDICATOR TO     0398 00223000
*                                      BUFFER.                       */ 00224000
         MVC   TPLABL(5,BUFFPTR),TPLAB                             0398 00225000
*               TPANODLB=ANODELAB;  /* MOVE ANODE LABEL              */ 00226000
         MVC   TPANODLB(5,BUFFPTR),ANODELAB                        0399 00227000
*               TPFDBLB=FDBLAB;     /* MOVE FDB LABEL                */ 00228000
         MVC   TPFDBLB(3,BUFFPTR),FDBLAB                           0400 00229000
*               TPRSVDLB=RSVDLAB;   /* RSVD LABEL                    */ 00230000
         MVC   TPRSVDLB(4,BUFFPTR),RSVDLAB                         0401 00231000
*               TPLNG2LB=LNG2LAB;   /* LNG2 LABEL                    */ 00232000
*                                                                  0402 00233000
         MVC   TPLNG2LB(4,BUFFPTR),LNG2LAB                         0402 00234000
*               /*****************************************************/ 00235000
*               /*                                                   */ 00236000
*               /* MOVE THE APPLICATION NODE NAME FROM ISTTRF,       */ 00237000
*               /* LOCATED AT THE END OF THE TEXT                    */ 00238000
*               /*                                                   */ 00239000
*               /*****************************************************/ 00240000
*                                                                  0403 00241000
*               TRFPTR=DATAADDR+(DATALNG-LENGTH(ISTTRF));/* FIND   0403 00242000
*                                      BEGINNING OF ISTTRF DATA      */ 00243000
         L     @10,WORKAREA(,PARMSAVE)                             0403 00244000
         L     @15,DATAADDR(,PARMSAVE)                             0403 00245000
         L     @14,DATALNG(,@10)                                   0403 00246000
         SL    @14,@CF02414                                        0403 00247000
         ALR   @14,@15                                             0403 00248000
         ST    @14,TRFPTR(,@10)                                    0403 00249000
*               RFY                                                0404 00250000
*                 ISTTRF BASED(TRFPTR);                            0404 00251000
*               TPANODAT=TRFANODE;  /* MOVE IN ANODE INFO            */ 00252000
*                                                                  0405 00253000
         MVC   TPANODAT(8,BUFFPTR),TRFANODE(@14)                   0405 00254000
*               /*****************************************************/ 00255000
*               /*                                                   */ 00256000
*               /* SET UP FOR AND CALL SUBROUTINE HEXFRMT TO FORMAT  */ 00257000
*               /* THE FIRST LINE OF HEX DATA                        */ 00258000
*               /*                                                   */ 00259000
*               /*****************************************************/ 00260000
*                                                                  0406 00261000
*               DATASTRT=DATAADDR;  /* DATA TO BE FORMATTED BEGINS AT   00262000
*                                      THE FIRST BYTE OF THE VTAM  0406 00263000
*                                      GTRACE RECORD                 */ 00264000
         LR    DATASTRT,@15                                        0406 00265000
*               HEXPARM=ADDR(TPHEX1);/* POINT TO PLIST FOR FIRST   0407 00266000
*                                      TPIOS LINE                    */ 00267000
         LA    HEXPARM,TPHEX1                                      0407 00268000
*               CALL HEXFRMT;                                      0408 00269000
*                                                                  0408 00270000
         BAL   @14,HEXFRMT                                         0408 00271000
*               /*****************************************************/ 00272000
*               /*                                                   */ 00273000
*               /* CHECK DIRECTION OF TPIOS BUFFER AND INDICATE IN   */ 00274000
*               /* OUTPUT                                            */ 00275000
*               /*                                                   */ 00276000
*               /*****************************************************/ 00277000
*                                                                  0409 00278000
*               IF TRFINB='1'B THEN                                0409 00279000
         L     @10,WORKAREA(,PARMSAVE)                             0409 00280000
         L     @10,TRFPTR(,@10)                                    0409 00281000
         TM    TRFINB(@10),B'10000000'                             0409 00282000
         BNO   @RF00409                                            0409 00283000
*                 TPINOUT=INBOUND;                                 0410 00284000
         MVI   TPINOUT+2(BUFFPTR),C' '                             0410 00285000
         MVC   TPINOUT(2,BUFFPTR),INBOUND                          0410 00286000
*               ELSE                                               0411 00287000
*                 TPINOUT=OUTBOUND;                                0411 00288000
*                                                                  0411 00289000
         B     @RC00409                                            0411 00290000
@RF00409 MVC   TPINOUT(3,BUFFPTR),OUTBOUND                         0411 00291000
*               /*****************************************************/ 00292000
*               /*                                                   */ 00293000
*               /* COMMON PORTION OF TPIOS RECORD IS COMPLETE. CHECK */ 00294000
*               /* THE FLAGS TO DETERMINE HOW TO PROCESS THE         */ 00295000
*               /* REMAINDER OF THE RECORD                           */ 00296000
*               /*                                                   */ 00297000
*               /*****************************************************/ 00298000
*                                                                  0412 00299000
*               IF TRFLOCAL='1'B THEN                              0412 00300000
@RC00409 L     @10,WORKAREA(,PARMSAVE)                             0412 00301000
         L     @15,TRFPTR(,@10)                                    0412 00302000
         TM    TRFLOCAL(@15),B'01000000'                           0412 00303000
         BNO   @RF00412                                            0412 00304000
*                 DO;               /* IF THIS IS A LOCAL RECORD,  0413 00305000
*                                      PROCESSING DEPENDS ON       0413 00306000
*                                      DIRECTION                     */ 00307000
*                   IF TRFINB='1'B THEN                            0414 00308000
         TM    TRFINB(@15),B'10000000'                             0414 00309000
         BNO   @RF00414                                            0414 00310000
*                     DO;                                          0415 00311000
*                       TPRSVLNG='';/* BLANK OUT RSVD AND LENGTH   0416 00312000
*                                      FIELDS                        */ 00313000
         MVI   TPRSVLNG(BUFFPTR),C' '                              0416 00314000
         MVC   TPRSVLNG+1(27,BUFFPTR),TPRSVLNG(BUFFPTR)            0416 00315000
*                       NEXTLINE=ADDR(AMDTPLI1);/* NEXT LINE TO BE 0417 00316000
*                                      FORMATTED BY TPLI1            */ 00317000
         LA    @15,AMDTPLI1                                        0417 00318000
         ST    @15,NEXTLINE(,@10)                                  0417 00319000
*                     END;          /* END OF INBOUND                */ 00320000
*                   ELSE                                           0419 00321000
*                     NEXTLINE=ADDR(AMDTPLOC);/* IF OUTBOUND, TPLOC  */ 00322000
         B     @RC00414                                            0419 00323000
@RF00414 L     @10,WORKAREA(,PARMSAVE)                             0419 00324000
         LA    @15,AMDTPLOC                                        0419 00325000
         ST    @15,NEXTLINE(,@10)                                  0419 00326000
*                 END;              /* END OF LOCAL                  */ 00327000
*               ELSE                                               0421 00328000
*                 IF TRFINB='1'B THEN                              0421 00329000
         B     @RC00412                                            0421 00330000
@RF00412 L     @10,WORKAREA(,PARMSAVE)                             0421 00331000
         L     @15,TRFPTR(,@10)                                    0421 00332000
         TM    TRFINB(@15),B'10000000'                             0421 00333000
         BNO   @RF00421                                            0421 00334000
*                   NEXTLINE=ADDR(AMDTPRI1);/* THE BUFFER IS A REMOTE   00335000
*                                      TPIOS RECORD-- IF INBOUND,  0422 00336000
*                                      FIRST LINE IS COMPLETE AND  0422 00337000
*                                      NEXT LINE IS PROCESSED BY   0422 00338000
*                                      AMDTPRI1                      */ 00339000
         LA    @15,AMDTPRI1                                        0422 00340000
         ST    @15,NEXTLINE(,@10)                                  0422 00341000
*                 ELSE                                             0423 00342000
*                   DO;             /* FOR REMOTE OUTBOUND, THE RSVD2   00343000
*                                      FIELD IS FORMATTED. SET UP FOR   00344000
*                                      AND CALL SUBROUTINE HEXFRMT TO   00345000
*                                      DO IT                         */ 00346000
         B     @RC00421                                            0423 00347000
@RF00421 DS    0H                                                  0424 00348000
*                     TPRSV2LB=RSVD2LAB;/* MOVE IN LABEL             */ 00349000
         MVC   TPRSV2LB(4,BUFFPTR),RSVD2LAB                        0424 00350000
*                     RFY                                          0425 00351000
*                       ISTZOBUF BASED(DATAADDR);                  0425 00352000
*                     DATASTRT=ADDR(ZOBRSV04);/* POINT TO THE RSVD2     00353000
*                                      FIELD IN THE INPUT RECORD     */ 00354000
         L     @10,DATAADDR(,PARMSAVE)                             0426 00355000
         LA    DATASTRT,ZOBRSV04(,@10)                             0426 00356000
*                     HEXPARM=ADDR(TPHEX2);/* POINT TO APPROPRIATE 0427 00357000
*                                      PLIST                         */ 00358000
         LA    HEXPARM,TPHEX2                                      0427 00359000
*                     CALL HEXFRMT;                                0428 00360000
         BAL   @14,HEXFRMT                                         0428 00361000
*                     NEXTLINE=ADDR(AMDTPRO1);/* SECOND LINE IS    0429 00362000
*                                      PROCESSED BY ROUTINE AMDTPRO1 */ 00363000
         L     @10,WORKAREA(,PARMSAVE)                             0429 00364000
         LA    @15,AMDTPRO1                                        0429 00365000
         ST    @15,NEXTLINE(,@10)                                  0429 00366000
*                   END;            /* END OF TPIOS REMOTE OUTBOUND     00367000
*                                      PATH                          */ 00368000
*               RETCODE=CONTINUE;   /* INDICATE MORE OUTPUT LINES ARE   00369000
*                                      REQUIRED                      */ 00370000
@RC00421 DS    0H                                                  0431 00371000
@RC00412 L     @10,WORKAREA(,PARMSAVE)                             0431 00372000
         SLR   @15,@15                                             0431 00373000
         ST    @15,RETCODE(,@10)                                   0431 00374000
*               GO TO AMDEXIT;      /* QUIT VIA THE EXIT ROUTINE     */ 00375000
         B     AMDEXIT                                             0432 00376000
*             END;                                                 0433 00377000
*           ELSE                                                   0434 00378000
*             IF INPUTEID=ISTLNEID THEN                            0434 00379000
@RF00396 L     @10,EIDADDR(,PARMSAVE)                              0434 00380000
         CLC   INPUTEID(2,@10),@CH00590                            0434 00381000
         BNE   @RF00434                                            0434 00382000
*               DO;                 /*                       @ZM41491*/ 00383000
*                                                                  0435 00384000
*                 /***************************************************/ 00385000
*                 /*                                                 */ 00386000
*                 /* AMDLNTR1 - THIS ROUTINE PROCESSES THE FIRST LINE*/ 00387000
*                 /* OF LINE TRACE DATA. FIRST, THE APPROPRIATE      */ 00388000
*                 /* INDICATORS ARE MOVED ITO THE OUTPUT LINE        */ 00389000
*                 /*                                                 */ 00390000
*                 /***************************************************/ 00391000
*                                                                  0436 00392000
*                 LNLABEL=LINELAB;  /* INDICATE LINE TRACE EVENT     */ 00393000
         MVC   LNLABEL(4,BUFFPTR),LINELAB                          0436 00394000
*                 LNDNODL=DNODELAB; /* MOVE IN DNODE LABEL           */ 00395000
         MVC   LNDNODL(5,BUFFPTR),DNODELAB                         0437 00396000
*                 LNEPLB=EPLAB;     /* MOVE IN EP LABEL              */ 00397000
         MVC   LNEPLB(2,BUFFPTR),EPLAB                             0438 00398000
*                 LNTMLB=TIMELAB;   /* MOVE IN TIME LABEL            */ 00399000
*                                                                  0439 00400000
         MVC   LNTMLB(4,BUFFPTR),TIMELAB                           0439 00401000
*                 /***************************************************/ 00402000
*                 /*                                                 */ 00403000
*                 /* FIND ISTTRF AT THE END OF THE INPUT RECORD AND  */ 00404000
*                 /* MOVE DESTINATION NODE FROM IT INTO THE OUTPUT   */ 00405000
*                 /* BUFFER                                          */ 00406000
*                 /*                                                 */ 00407000
*                 /***************************************************/ 00408000
*                                                                  0440 00409000
*                 TRFPTR=DATAADDR+(DATALNG-LENGTH(ISTTRF));        0440 00410000
         L     @10,WORKAREA(,PARMSAVE)                             0440 00411000
         L     @15,DATAADDR(,PARMSAVE)                             0440 00412000
         L     @14,DATALNG(,@10)                                   0440 00413000
         SL    @14,@CF02414                                        0440 00414000
         ALR   @14,@15                                             0440 00415000
         ST    @14,TRFPTR(,@10)                                    0440 00416000
*                 RFY                                              0441 00417000
*                   ISTTRF BASED(TRFPTR);                          0441 00418000
*                 LNDNODAT=TRFDNODE;/* MOVE DNODE DATA INTO BUFFER   */ 00419000
*                                                                  0442 00420000
         MVC   LNDNODAT(8,BUFFPTR),TRFDNODE(@14)                   0442 00421000
*                 /***************************************************/ 00422000
*                 /*                                                 */ 00423000
*                 /* SET UP FOR AND CALL HEXFRMT SUBROUTINE TO FORMAT*/ 00424000
*                 /* THE EP AND TIME DATA                            */ 00425000
*                 /*                                                 */ 00426000
*                 /***************************************************/ 00427000
*                                                                  0443 00428000
*                 TRRPTR=ADDR(LNSRU);/* FIND THE LINE DATA HEADER    */ 00429000
         LA    @15,LNSRU(,@15)                                     0443 00430000
         ST    @15,TRRPTR(,@10)                                    0443 00431000
*                 RFY                                              0444 00432000
*                   ISTRUB BASED(TRRPTR);                          0444 00433000
*                 DATASTRT=ADDR(TRRTIME);/* POINT TO TIME DATA       */ 00434000
         LA    DATASTRT,TRRTIME(,@15)                              0445 00435000
*                 HEXPARM=ADDR(LNHEX1);/* POINT TO HEXFRMT PLIST     */ 00436000
         LA    HEXPARM,LNHEX1                                      0446 00437000
*                 CALL HEXFRMT;                                    0447 00438000
*                                                                  0447 00439000
         BAL   @14,HEXFRMT                                         0447 00440000
*                 /***************************************************/ 00441000
*                 /*                                                 */ 00442000
*                 /* IF LINE TRACE IS BEING TERMINATED DUE TO        */ 00443000
*                 /* SLOWDOWN PROCESSING, INDICATE THIS IN THE OUTPUT*/ 00444000
*                 /* BUFFER                                          */ 00445000
*                 /*                                                 */ 00446000
*                 /***************************************************/ 00447000
*                                                                  0448 00448000
*                 IF TRRSTAT=SLOWDOWN THEN                         0448 00449000
         L     @10,WORKAREA(,PARMSAVE)                             0448 00450000
         L     @10,TRRPTR(,@10)                                    0448 00451000
         CLC   TRRSTAT(1,@10),SLOWDOWN                             0448 00452000
         BNE   @RF00448                                            0448 00453000
*                   LNSLOWDN=SLOWIND;                              0449 00454000
*                                                                  0449 00455000
         MVC   LNSLOWDN(8,BUFFPTR),SLOWIND                         0449 00456000
*                 /***************************************************/ 00457000
*                 /*                                                 */ 00458000
*                 /* FIRST LINE OUTPUT IS NOW COMPLETE. SETUP FOR THE*/ 00459000
*                 /* NEXT LINE IS ACCOMPLISHED AS FOLLOWS: FOR FORMAT*/ 00460000
*                 /* 2, JUST                                 @Z40GKTQ*/ 00461000
*                 /* INDICATE NEXT LINE TO BE PROCESSED BY AMDLNE01  */ 00462000
*                 /* AND SET                                 @Z40GKTQ*/ 00463000
*                 /* RETURN CODE TO ZERO. OTHERWISE, FIND THE START  */ 00464000
*                 /* OF THE LINE TRACE DATA, AND CALCULATING THE     */ 00465000
*                 /* NUMBER OF 4-BYTE ENTRIES CONTAINED THERIN.      */ 00466000
*                 /* CONTROL IS THEN PASSED TO THE EXIT ROUTINE      */ 00467000
*                 /*                                                 */ 00468000
*                 /***************************************************/ 00469000
*                                                                  0450 00470000
*                 LINEADDR=ADDR(TRRDATA);/* POINT TO LINE TRACE    0450 00471000
*                                      DATA@Z40GKTQ                  */ 00472000
@RF00448 L     @10,WORKAREA(,PARMSAVE)                             0450 00473000
         L     @15,TRRPTR(,@10)                                    0450 00474000
         LA    @14,TRRDATA(,@15)                                   0450 00475000
         ST    @14,LINEADDR(,@10)                                  0450 00476000
*                 IF TRRFMT2=ON     /* CHECK FORMAT 2 FLAG   @Z40GKTQ*/ 00477000
*                   THEN                                           0451 00478000
         TM    TRRFMT2(@15),B'00000010'                            0451 00479000
         BNO   @RF00451                                            0451 00480000
*                   DO;             /* IF IT'S ON, SET UP CALL     0452 00481000
*                                                            @Z40GKTQ*/ 00482000
*                     NEXTLINE=ADDR(AMDLNE01);/* TO AMDLNE01 FOR NEXT   00483000
*                                                            @Z40GKTQ*/ 00484000
         LA    @15,AMDLNE01                                        0453 00485000
         ST    @15,NEXTLINE(,@10)                                  0453 00486000
*                     RETCODE=CONTINUE;/* TIME AROUND        @Z40GKTQ*/ 00487000
         SLR   @15,@15                                             0454 00488000
         ST    @15,RETCODE(,@10)                                   0454 00489000
*                   END;            /*                       @Z40GKTQ*/ 00490000
*                 ELSE                                             0456 00491000
*                   DO;             /* OTHERWISE PROCESS FMT1      0456 00492000
*                                                            @Z40GKTQ*/ 00493000
         B     @RC00451                                            0456 00494000
@RF00451 DS    0H                                                  0457 00495000
*                     LINECNT=(TRFPTR-LINEADDR)/4;/* LINE DATA LENGTH   00496000
*                                      IS DISTANCE BETWEEN ITS START    00497000
*                                      AND THE START OF ISTTRF. THE     00498000
*                                      NUMBER OF ENTRIES IS THEN   0457 00499000
*                                      FOUND BY DIVIDING BY THE    0457 00500000
*                                      LENGTH OF ONE ENTRY(4)        */ 00501000
         L     @10,WORKAREA(,PARMSAVE)                             0457 00502000
         LA    @15,4                                               0457 00503000
         L     @04,TRFPTR(,@10)                                    0457 00504000
         SL    @04,LINEADDR(,@10)                                  0457 00505000
         SRDA  @04,32                                              0457 00506000
         DR    @04,@15                                             0457 00507000
         ST    @05,LINECNT(,@10)                                   0457 00508000
*                     IF LINECNT<=0 THEN                           0458 00509000
         LTR   @05,@05                                             0458 00510000
         BP    @RF00458                                            0458 00511000
*                       RETCODE=GETNEXT;/* IF NO DATA, RECORD IS   0459 00512000
*                                      COMPLETE                      */ 00513000
         ST    @15,RETCODE(,@10)                                   0459 00514000
*                     ELSE                                         0460 00515000
*                       DO;                                        0460 00516000
         B     @RC00458                                            0460 00517000
@RF00458 DS    0H                                                  0461 00518000
*                         NEXTLINE=ADDR(AMDLNTR2);/* ALL SUBSEQUENT     00519000
*                                      LINES WILL BE PROCESSED BY  0461 00520000
*                                      AMDLNTR2                      */ 00521000
         L     @10,WORKAREA(,PARMSAVE)                             0461 00522000
         LA    @15,AMDLNTR2                                        0461 00523000
         ST    @15,NEXTLINE(,@10)                                  0461 00524000
*                         RETCODE=CONTINUE;/* INDICATE MORE OUTPUT 0462 00525000
*                                      LINES ARE NEEDED              */ 00526000
         SLR   @15,@15                                             0462 00527000
         ST    @15,RETCODE(,@10)                                   0462 00528000
*                       END;        /*                       @Z40GKTQ*/ 00529000
*                   END;                                           0464 00530000
*                 GO TO AMDEXIT;    /* RETURN VIA THE EXIT ROUTINE   */ 00531000
         B     AMDEXIT                                             0465 00532000
*               END;                /*                       @ZM41491*/ 00533000
*                                                                  0466 00534000
*       /*************************************************************/ 00535000
*       /*                                                           */ 00536000
*       /* IF THE EID DOES NOT MATCH ANY OF THE ABOVE, THE INPUT     */ 00537000
*       /* RECORD IS NOT A VTAM RECORD. IT IS IGNORED BY SETTING THE */ 00538000
*       /* PROPER RETURN CODE                                        */ 00539000
*       /*                                                           */ 00540000
*       /*************************************************************/ 00541000
*                                                                  0467 00542000
*             ELSE                                                 0467 00543000
*               RETCODE=IGNORE;                                    0467 00544000
*                                                                  0467 00545000
@RF00434 L     @10,WORKAREA(,PARMSAVE)                             0467 00546000
         MVC   RETCODE(4,@10),@CF00060                             0467 00547000
*       /*************************************************************/ 00548000
*       /*                                                           */ 00549000
*       /* PROCESSING FOR THE NEW INPUT RECORD IS COMPLETE. THE      */ 00550000
*       /* FOLLOWING ROUTINE RETURNS TO EDIT/ABDUMP AFTER PERFORMING */ 00551000
*       /* NECESSARY CLEANUP AMDEXIT - THIS IS THE EXIT ROUTINE      */ 00552000
*       /* THROUGH WHICH ALL OF THE PROCESSING ROUTINES RETURN TO    */ 00553000
*       /* EDIT/ABDUMP. IT LOADS THE RETURN CODE INTO REGISTER 15    */ 00554000
*       /* FROM VARIABLE RETCODE AND PERFORMS STANDARD EXIT LINKAGE  */ 00555000
*       /* TO RETURN TO EDIT/ABDUMP                                  */ 00556000
*       /*                                                           */ 00557000
*       /*************************************************************/ 00558000
*                                                                  0468 00559000
*AMDEXIT:                                                          0468 00560000
*       RTRNREG=RETCODE;            /* SET R15 TO VALUE SET BY     0468 00561000
*                                      PROCESSING ROUTINE            */ 00562000
@RC00380 DS    0H                                                  0468 00563000
@RC00369 DS    0H                                                  0468 00564000
AMDEXIT  L     @10,HISPTR(,SAVEPTR)                                0468 00565000
         L     @15,WORKAREA(,PARMSAVE)                             0468 00566000
         L     @15,RETCODE(,@15)                                   0468 00567000
         ST    @15,RTRNREG(,@10)                                   0468 00568000
*       RETURN;                     /* RETURN TO EDIT/ABDUMP         */ 00569000
@EL00001 L     @13,4(,@13)                                         0469 00570000
@EF00001 L     @00,@SIZDATD                                        0469 00571000
         LR    @01,@11                                             0469 00572000
         FREEMAIN R,LV=(0),A=(1)                                        00573000
@ER00001 LM    @14,@12,12(@13)                                     0469 00574000
         BR    @14                                                 0469 00575000
*     END;                          /* END OF NEW INPUT RECORD PATH  */ 00576000
*                                                                  0471 00577000
*   /*****************************************************************/ 00578000
*   /*                                                               */ 00579000
*   /* OTHERWISE, IF NEXTLINE IS NOT ZERO, IT CONTAINS THE ADDRESS OF*/ 00580000
*   /* THE ROUTINE WHICH IS TO PROCESS THIS LINE OF OUTPUT. A BRANCH */ 00581000
*   /* IS NOW TAKEN TO THE INDICATED ADDRESS. SEE THE PROLOGUE FOR   */ 00582000
*   /* THE ROUTINE NAMES WHICH ARE GIVEN CONTROL UNDER WHICH         */ 00583000
*   /* CIRCUMSTANCES.                                                */ 00584000
*   /*                                                               */ 00585000
*   /*****************************************************************/ 00586000
*                                                                  0471 00587000
*   ELSE                                                           0471 00588000
*     GO TO NEXTLINE;                                              0471 00589000
@RF00366 L     @10,WORKAREA(,PARMSAVE)                             0471 00590000
         L     @10,NEXTLINE(,@10)                                  0471 00591000
         BR    @10                                                 0471 00592000
*                                                                  0472 00593000
*   /*****************************************************************/ 00594000
*   /*                                                               */ 00595000
*   /* PROCESSING ROUTINES FOR SUBSEQUENT OUTPUT LINES               */ 00596000
*   /*                                                               */ 00597000
*   /*****************************************************************/ 00598000
*                                                                  0472 00599000
*AMDCLTR2:                                                         0472 00600000
*                                                                  0472 00601000
*   /*****************************************************************/ 00602000
*   /*                                                               */ 00603000
*   /* AMDCLTR2 -- THIS ROUTINE RECEIVES CONTROL TO FORMAT THE SECOND*/ 00604000
*   /* LINE OF OUTPUT FOR CONTROL LAYER RECORDS. ON ENTRY, TEXTLN AND*/ 00605000
*   /* TEXTADDR ARE ALREADY SET TO THE CORRECT VALUES TO CALL        */ 00606000
*   /* SUBROUTINE FRMTEXT. FIRST, THE DNODE LABEL AND DATA IS MOVED  */ 00607000
*   /* TO THE BUFFER.                                                */ 00608000
*   /*                                                               */ 00609000
*   /*****************************************************************/ 00610000
*                                                                  0472 00611000
*   CLDNODLB=DNODELAB;              /* MOVE DNODE LABEL TO OUTPUT  0472 00612000
*                                      BUFFER                        */ 00613000
AMDCLTR2 MVC   CLDNODLB(5,BUFFPTR),DNODELAB                        0472 00614000
*   RFY                                                            0473 00615000
*     ISTTRAC BASED(DATAADDR);                                     0473 00616000
*   CLDNODAT=TRADNODE;              /* MOVE DESTINATION NODE NAME TO    00617000
*                                      BUFFER.                       */ 00618000
*                                                                  0474 00619000
         L     @10,DATAADDR(,PARMSAVE)                             0474 00620000
         MVC   CLDNODAT(8,BUFFPTR),TRADNODE(@10)                   0474 00621000
*   /*****************************************************************/ 00622000
*   /*                                                               */ 00623000
*   /* CALL SUBROUTINE FRMTEXT TO FORMAT THE TEXT PORTION            */ 00624000
*   /*                                                               */ 00625000
*   /*****************************************************************/ 00626000
*                                                                  0475 00627000
*   CALL FRMTEXT;                                                  0475 00628000
*                                                                  0475 00629000
         BAL   @14,FRMTEXT                                         0475 00630000
*   /*****************************************************************/ 00631000
*   /*                                                               */ 00632000
*   /* ON RETURN, ALL DATA WITH THE POSSIBLE EXCEPTION OF SOME       */ 00633000
*   /* REMAINING TEXT INFORMATION HAS BEEN FORMATTED FOR THIS CONTROL*/ 00634000
*   /* LAYER RECORD. TEXTLN INDICATES IF MORE TEXT IS TO BE          */ 00635000
*   /* FORMATTED. IF TEXTLN IS ZERO, NO MORE TEXT REMAINS.           */ 00636000
*   /*                                                               */ 00637000
*   /*****************************************************************/ 00638000
*                                                                  0476 00639000
*   IF TEXTLN=0 THEN                                               0476 00640000
         L     @10,WORKAREA(,PARMSAVE)                             0476 00641000
         L     @15,TEXTLN(,@10)                                    0476 00642000
         LTR   @15,@15                                             0476 00643000
         BNZ   @RF00476                                            0476 00644000
*     RETCODE=GETNEXT;              /* IF NO MORE TEXT, SET RETURN 0477 00645000
*                                      CODE TO GET THE NEXT RECORD   */ 00646000
         MVC   RETCODE(4,@10),@CF00036                             0477 00647000
*   ELSE                                                           0478 00648000
*     DO;                                                          0478 00649000
*                                                                  0478 00650000
         B     @RC00476                                            0478 00651000
@RF00476 DS    0H                                                  0479 00652000
*       /*************************************************************/ 00653000
*       /*                                                           */ 00654000
*       /* OTHERWISE, MORE TEXT REMAINS. THIS SITUATION IS PROCESSED */ 00655000
*       /* BY AMDTXTLN                                               */ 00656000
*       /*                                                           */ 00657000
*       /*************************************************************/ 00658000
*                                                                  0479 00659000
*       NEXTLINE=ADDR(AMDTXTLN);    /* INDICATE THAT AMDTXTLN IS TO     00660000
*                                      RECEIVE CONTROL ON NEXT ENTRY    00661000
*                                      TO PROCESS NEXT LINE          */ 00662000
         L     @10,WORKAREA(,PARMSAVE)                             0479 00663000
         LA    @15,AMDTXTLN                                        0479 00664000
         ST    @15,NEXTLINE(,@10)                                  0479 00665000
*       RETCODE=CONTINUE;           /* INDICATE MORE OUTPUT LINES  0480 00666000
*                                      NEEDED FOR SAME INPUT RECORD  */ 00667000
         SLR   @15,@15                                             0480 00668000
         ST    @15,RETCODE(,@10)                                   0480 00669000
*     END;                          /* END OF NON-ZERO TEXTLN PATH   */ 00670000
*   GO TO AMDEXIT;                  /* FINISH VIA THE EXIT ROUTINE   */ 00671000
         B     AMDEXIT                                             0482 00672000
*AMDTPLOC:                                                         0483 00673000
*                                                                  0483 00674000
*   /*****************************************************************/ 00675000
*   /*                                                               */ 00676000
*   /* AMDTPLOC - THIS ROUTINE PROCESSES THE SECOND LINE OF OUTPUT   */ 00677000
*   /* FOR TPIOS LOCAL OUTBOUND. FIRST, THE LOCAL INDICATOR, DNODE   */ 00678000
*   /* LABEL, AND TEXT LABEL ARE MOVED INTO OUTPUT BUFFER            */ 00679000
*   /*                                                               */ 00680000
*   /*****************************************************************/ 00681000
*                                                                  0483 00682000
*   TPLOCLB=LOCALIND;                                              0483 00683000
AMDTPLOC MVC   TPLOCLB(5,BUFFPTR),LOCALIND                         0483 00684000
*   TPLOCDNL=DNODELAB;                                             0484 00685000
         MVC   TPLOCDNL(5,BUFFPTR),DNODELAB                        0484 00686000
*   TPLOCTXL=TEXTLAB;                                              0485 00687000
*                                                                  0485 00688000
         MVC   TPLOCTXL(4,BUFFPTR),TEXTLAB                         0485 00689000
*   /*****************************************************************/ 00690000
*   /*                                                               */ 00691000
*   /* LOCATE THE ISTTRF INFO AT THE END OF THE INPUT DATA AND MOVE  */ 00692000
*   /* THE DESTINATION NODE FROM IT INTO THE OUTPUT BUFFER           */ 00693000
*   /*                                                               */ 00694000
*   /*****************************************************************/ 00695000
*                                                                  0486 00696000
*   TRFPTR=DATAADDR+(DATALNG-LENGTH(ISTTRF));/* SET BASE FOR ISTTRF     00697000
*                                      MAPPING                       */ 00698000
         L     @10,WORKAREA(,PARMSAVE)                             0486 00699000
         L     @15,DATAADDR(,PARMSAVE)                             0486 00700000
         L     @14,DATALNG(,@10)                                   0486 00701000
         SL    @14,@CF02414                                        0486 00702000
         ALR   @14,@15                                             0486 00703000
         ST    @14,TRFPTR(,@10)                                    0486 00704000
*   TPLOCDND=TRFDNODE;              /* MOVE 8-CHARACTER DNODE INTO 0487 00705000
*                                      BUFFER                        */ 00706000
*                                                                  0487 00707000
         MVC   TPLOCDND(8,BUFFPTR),TRFDNODE(@14)                   0487 00708000
*   /*****************************************************************/ 00709000
*   /*                                                               */ 00710000
*   /* SET UP TO FORMAT THE TEXT INFO BY LOCATING THE TEXT AND       */ 00711000
*   /* CALCULATING ITS LENGTH                                        */ 00712000
*   /*                                                               */ 00713000
*   /*****************************************************************/ 00714000
*                                                                  0488 00715000
*   RFY                                                            0488 00716000
*     ISTZLBUF BASED(DATAADDR);                                    0488 00717000
*   TEXTADDR=ADDR(ZLBTEXT1);        /* POINT TO THE START OF THE TEXT*/ 00718000
         LA    @15,ZLBTEXT1(,@15)                                  0489 00719000
         ST    @15,TEXTADDR(,@10)                                  0489 00720000
*   TEXTLN=TRFPTR-TEXTADDR;         /* CALCULATE LENGTH OF THE TEXT..   00721000
*                                      ITS ENDED BY THE ISTTRF BLOCK */ 00722000
         SLR   @14,@15                                             0490 00723000
         ST    @14,TEXTLN(,@10)                                    0490 00724000
*   CALL FRMTEXT;                   /* CALL SUBROUTINE TO FORMAT THE    00725000
*                                      TEXT                          */ 00726000
*                                                                  0491 00727000
         BAL   @14,FRMTEXT                                         0491 00728000
*   /*****************************************************************/ 00729000
*   /*                                                               */ 00730000
*   /* ON RETURN, THIS LINE IS COMPLETE. IF MORE TEXT REMAINS, IT    */ 00731000
*   /* WILL APPEAR AS SUBSEQUENT LINES HANDLED BY ROUTINE AMDTXTLN.  */ 00732000
*   /* IF NO MORE TEXT REMAINS, RECORD IS COMPLETE                   */ 00733000
*   /*                                                               */ 00734000
*   /*****************************************************************/ 00735000
*                                                                  0492 00736000
*   IF TEXTLN=0 THEN                                               0492 00737000
         L     @10,WORKAREA(,PARMSAVE)                             0492 00738000
         L     @15,TEXTLN(,@10)                                    0492 00739000
         LTR   @15,@15                                             0492 00740000
         BNZ   @RF00492                                            0492 00741000
*     RETCODE=GETNEXT;              /* SET PROPER RETURN CODE IF   0493 00742000
*                                      RECORD IS COMPLETE            */ 00743000
         MVC   RETCODE(4,@10),@CF00036                             0493 00744000
*   ELSE                                                           0494 00745000
*     DO;                                                          0494 00746000
         B     @RC00492                                            0494 00747000
@RF00492 DS    0H                                                  0495 00748000
*       NEXTLINE=ADDR(AMDTXTLN);    /* OTHERWISE, REMAINDER WILL BE     00749000
*                                      PROCESSED BY AMDTXTLN         */ 00750000
         L     @10,WORKAREA(,PARMSAVE)                             0495 00751000
         LA    @15,AMDTXTLN                                        0495 00752000
         ST    @15,NEXTLINE(,@10)                                  0495 00753000
*       RETCODE=CONTINUE;           /* SET PROPER RC TO INDICATE MORE   00754000
*                                      TO DO                         */ 00755000
         SLR   @15,@15                                             0496 00756000
         ST    @15,RETCODE(,@10)                                   0496 00757000
*     END;                          /* END OF MORE-TEXT PATH         */ 00758000
*   GO TO AMDEXIT;                  /* RETURN VIA THE EXIT ROUTINE   */ 00759000
         B     AMDEXIT                                             0498 00760000
*AMDTPLI1:                                                         0499 00761000
*                                                                  0499 00762000
*   /*****************************************************************/ 00763000
*   /*                                                               */ 00764000
*   /* AMDTPLI1 - THIS ROUTINE RECEIVES CONTROL TO FORMAT THE SECOND */ 00765000
*   /* LINE OF OUTPUT FOR TPIOS LOCAL INBOUND RECORDS. FIRST, THE    */ 00766000
*   /* LOCAL INDICATOR, DNODE LABEL, AND FSB LABELS ARE MOVED INTO   */ 00767000
*   /* THE OUTPUT BUFFER                                             */ 00768000
*   /*                                                               */ 00769000
*   /*****************************************************************/ 00770000
*                                                                  0499 00771000
*   TPLOCLB=LOCALIND;                                              0499 00772000
AMDTPLI1 MVC   TPLOCLB(5,BUFFPTR),LOCALIND                         0499 00773000
*   TPLOCDNL=DNODELAB;                                             0500 00774000
         MVC   TPLOCDNL(5,BUFFPTR),DNODELAB                        0500 00775000
*   TPLOCFSL=FSBLAB;                                               0501 00776000
*                                                                  0501 00777000
         MVC   TPLOCFSL(3,BUFFPTR),FSBLAB                          0501 00778000
*   /*****************************************************************/ 00779000
*   /*                                                               */ 00780000
*   /* LOCATE THE ISTTRF INFO AT THE END OF THE INPUT DATA AND MOVE  */ 00781000
*   /* THE DESTINATION NODE FROM IT INTO THE OUTPUT BUFFER           */ 00782000
*   /*                                                               */ 00783000
*   /*****************************************************************/ 00784000
*                                                                  0502 00785000
*   TRFPTR=DATAADDR+(DATALNG-LENGTH(ISTTRF));                      0502 00786000
         L     @10,WORKAREA(,PARMSAVE)                             0502 00787000
         L     @15,DATAADDR(,PARMSAVE)                             0502 00788000
         L     @14,DATALNG(,@10)                                   0502 00789000
         SL    @14,@CF02414                                        0502 00790000
         ALR   @14,@15                                             0502 00791000
         ST    @14,TRFPTR(,@10)                                    0502 00792000
*   TPLOCDND=TRFDNODE;              /* MOVE IN DESTINATION NODE      */ 00793000
*                                                                  0503 00794000
         MVC   TPLOCDND(8,BUFFPTR),TRFDNODE(@14)                   0503 00795000
*   /*****************************************************************/ 00796000
*   /*                                                               */ 00797000
*   /* SET UP FOR AND CALL HEXFRMT ROUTINE TO FORMAT FSB             */ 00798000
*   /*                                                               */ 00799000
*   /*****************************************************************/ 00800000
*                                                                  0504 00801000
*   RFY                                                            0504 00802000
*     ISTZLBUF BASED(DATAADDR);                                    0504 00803000
*   DATASTRT=ADDR(ZLBFSB);          /* POINT TO FSB IN RECORD        */ 00804000
         LA    DATASTRT,ZLBFSB(,@15)                               0505 00805000
*   HEXPARM=ADDR(TPHEX3);           /* POINT TO CORRECT PLIST        */ 00806000
         LA    HEXPARM,TPHEX3                                      0506 00807000
*   CALL HEXFRMT;                                                  0507 00808000
*                                                                  0507 00809000
         BAL   @14,HEXFRMT                                         0507 00810000
*   /*****************************************************************/ 00811000
*   /*                                                               */ 00812000
*   /* THIS LINE IS COMPLETE. SET UP TO PROCESS NEXT LINE AND RETURN */ 00813000
*   /* TO EDIT/ABDUMP TO PRINT THIS LINE                             */ 00814000
*   /*                                                               */ 00815000
*   /*****************************************************************/ 00816000
*                                                                  0508 00817000
*   NEXTLINE=ADDR(AMDTPLI2);        /* NEXT LINE FORMATTED BY TPLI2  */ 00818000
         L     @10,WORKAREA(,PARMSAVE)                             0508 00819000
         LA    @15,AMDTPLI2                                        0508 00820000
         ST    @15,NEXTLINE(,@10)                                  0508 00821000
*   RETCODE=CONTINUE;               /* INCICATE MORE LINES TO BE   0509 00822000
*                                      FORMATTED                     */ 00823000
         SLR   @15,@15                                             0509 00824000
         ST    @15,RETCODE(,@10)                                   0509 00825000
*   GO TO AMDEXIT;                  /* QUIT VIA THE EXIT ROUTINE     */ 00826000
         B     AMDEXIT                                             0510 00827000
*AMDTPLI2:                                                         0511 00828000
*                                                                  0511 00829000
*   /*****************************************************************/ 00830000
*   /*                                                               */ 00831000
*   /* AMDTPLI2 - THIS ROUTINE RECEIVES CONTROL TO FORMAT THE THIRD  */ 00832000
*   /* LINE FOR TPIOS LOCAL INBOUND RECORDS. FIRST, THE FDB LABEL IS */ 00833000
*   /* MOVED INTO THE OUTPUT BUFFER                                  */ 00834000
*   /*                                                               */ 00835000
*   /*****************************************************************/ 00836000
*                                                                  0511 00837000
*   TPLOCFDL=FDBLAB;                                               0511 00838000
*                                                                  0511 00839000
AMDTPLI2 MVC   TPLOCFDL(3,BUFFPTR),FDBLAB                          0511 00840000
*   /*****************************************************************/ 00841000
*   /*                                                               */ 00842000
*   /* SET UP FOR AND CALL HEXFRMT TO FORMAT THE FDB                 */ 00843000
*   /*                                                               */ 00844000
*   /*****************************************************************/ 00845000
*                                                                  0512 00846000
*   RFY                                                            0512 00847000
*     ISTZLBUF BASED(DATAADDR);                                    0512 00848000
*   DATASTRT=ADDR(ZLBFDBS);         /* POINT AT START OF DATA        */ 00849000
         L     @10,DATAADDR(,PARMSAVE)                             0513 00850000
         LA    DATASTRT,ZLBFDBS(,@10)                              0513 00851000
*   HEXPARM=ADDR(TPHEX5);           /* POINT TO CORRECT PLIST        */ 00852000
         LA    HEXPARM,TPHEX5                                      0514 00853000
*   CALL HEXFRMT;                                                  0515 00854000
*                                                                  0515 00855000
         BAL   @14,HEXFRMT                                         0515 00856000
*   /*****************************************************************/ 00857000
*   /*                                                               */ 00858000
*   /* THIS LINE IS COMPLETE. SET UP FOR THE NEXT LINE BY FINDING AND*/ 00859000
*   /* CALCULATING THE LENGTH OF THE TEXT INFO                       */ 00860000
*   /*                                                               */ 00861000
*   /*****************************************************************/ 00862000
*                                                                  0516 00863000
*   TEXTADDR=ADDR(ZLBTEXT1);                                       0516 00864000
         L     @10,WORKAREA(,PARMSAVE)                             0516 00865000
         L     @15,DATAADDR(,PARMSAVE)                             0516 00866000
         LA    @14,ZLBTEXT1(,@15)                                  0516 00867000
         ST    @14,TEXTADDR(,@10)                                  0516 00868000
*   TRFPTR=DATAADDR+(DATALNG-LENGTH(ISTTRF));                      0517 00869000
         L     @09,DATALNG(,@10)                                   0517 00870000
         SL    @09,@CF02414                                        0517 00871000
         ALR   @15,@09                                             0517 00872000
         ST    @15,TRFPTR(,@10)                                    0517 00873000
*   TEXTLN=TRFPTR-TEXTADDR;                                        0518 00874000
*                                                                  0518 00875000
         SLR   @15,@14                                             0518 00876000
         ST    @15,TEXTLN(,@10)                                    0518 00877000
*   /*****************************************************************/ 00878000
*   /*                                                               */ 00879000
*   /* INDICATE NEXT ROUTINE TO PROCESS AND EXIT VIA THE EXIT ROUTINE*/ 00880000
*   /*                                                               */ 00881000
*   /*****************************************************************/ 00882000
*                                                                  0519 00883000
*   NEXTLINE=ADDR(AMDTPRTX);        /* ONLY TEXT REMAINS TO BE     0519 00884000
*                                      FORMATTED                     */ 00885000
         LA    @15,AMDTPRTX                                        0519 00886000
         ST    @15,NEXTLINE(,@10)                                  0519 00887000
*   RETCODE=CONTINUE;                                              0520 00888000
         SLR   @15,@15                                             0520 00889000
         ST    @15,RETCODE(,@10)                                   0520 00890000
*   GO TO AMDEXIT;                                                 0521 00891000
         B     AMDEXIT                                             0521 00892000
*AMDTPRI1:                                                         0522 00893000
*                                                                  0522 00894000
*   /*****************************************************************/ 00895000
*   /*                                                               */ 00896000
*   /* AMDTPRI1 - THIS ROUTINE PROCESSES THE SECOND LINE OF OUPTUT   */ 00897000
*   /* FOR TPIOS REMOTE INBOUND TRACE RECORDS. FIRST, THE REMOTE     */ 00898000
*   /* INDICATOR, DNODE LABEL, AND FSB LABEL ARE MOVED TO THE BUFFER */ 00899000
*   /*                                                               */ 00900000
*   /*****************************************************************/ 00901000
*                                                                  0522 00902000
*   RFY                                                            0522 00903000
*     ISTTRF BASED(TRFPTR);                                        0522 00904000
AMDTPRI1 DS    0H                                                  0523 00905000
*   TRFPTR=DATAADDR+(DATALNG-LENGTH(ISTTRF));/* ISTTRF IS AT END OF     00906000
*                                      INPUT RECORD                  */ 00907000
         L     @10,WORKAREA(,PARMSAVE)                             0523 00908000
         L     @15,DATALNG(,@10)                                   0523 00909000
         SL    @15,@CF02414                                        0523 00910000
         AL    @15,DATAADDR(,PARMSAVE)                             0523 00911000
         ST    @15,TRFPTR(,@10)                                    0523 00912000
*   IF TRFLSNA='1'B THEN            /* IF LOCAL SNA DEVICE   @XM08361*/ 00913000
         TM    TRFLSNA(@15),B'00010000'                            0524 00914000
         BNO   @RF00524                                            0524 00915000
*     TPRILBL=LOCALIND;             /* MOVE LOCAL INDICATOR  @XM08361*/ 00916000
         MVI   TPRILBL+5(BUFFPTR),C' '                             0525 00917000
         MVC   TPRILBL(5,BUFFPTR),LOCALIND                         0525 00918000
*   ELSE                            /* NO MUST BE REMOTE     @XM08361*/ 00919000
*     TPRILBL=REMOTIND;                                            0526 00920000
         B     @RC00524                                            0526 00921000
@RF00524 MVC   TPRILBL(6,BUFFPTR),REMOTIND                         0526 00922000
*   TPRIDNL=DNODELAB;                                              0527 00923000
@RC00524 MVC   TPRIDNL(5,BUFFPTR),DNODELAB                         0527 00924000
*   TPRIFSBL=FSBLAB;                                               0528 00925000
*                                                                  0528 00926000
         MVC   TPRIFSBL(3,BUFFPTR),FSBLAB                          0528 00927000
*   /*****************************************************************/ 00928000
*   /*                                                               */ 00929000
*   /* MOVE THE DESTINATION NODE FROM TRF INTO THE OUTPUT BUFFER     */ 00930000
*   /*                                                       @XM08361*/ 00931000
*   /*                                                               */ 00932000
*   /*****************************************************************/ 00933000
*                                                                  0529 00934000
*   TPRIDND=TRFDNODE;               /* MOVE IN DNODE                 */ 00935000
*                                                                  0529 00936000
         L     @10,WORKAREA(,PARMSAVE)                             0529 00937000
         L     @10,TRFPTR(,@10)                                    0529 00938000
         MVC   TPRIDND(8,BUFFPTR),TRFDNODE(@10)                    0529 00939000
*   /*****************************************************************/ 00940000
*   /*                                                               */ 00941000
*   /* SET UP FOR AND CALL HEXFRMT ROUTINE TO FORMAT FSB DATA        */ 00942000
*   /*                                                               */ 00943000
*   /*****************************************************************/ 00944000
*                                                                  0530 00945000
*   RFY                                                            0530 00946000
*     ISTZIBUF BASED(DATAADDR);                                    0530 00947000
*   DATASTRT=ADDR(ZIBFSB);          /* POINT TO FSB IN RECORD        */ 00948000
         L     @10,DATAADDR(,PARMSAVE)                             0531 00949000
         LA    DATASTRT,ZIBFSB(,@10)                               0531 00950000
*   HEXPARM=ADDR(TPHEX3);           /* POINT TO CORRECT PLIST        */ 00951000
         LA    HEXPARM,TPHEX3                                      0532 00952000
*   CALL HEXFRMT;                                                  0533 00953000
*                                                                  0533 00954000
         BAL   @14,HEXFRMT                                         0533 00955000
*   /*****************************************************************/ 00956000
*   /*                                                               */ 00957000
*   /* ALL DATA FOR THIS LINE HAS BEEN FORMATTED. SET UP TO PROCESS  */ 00958000
*   /* NEXT LINE AND RETURN TO EDIT TO PRINT THIS LINE               */ 00959000
*   /*                                                               */ 00960000
*   /*****************************************************************/ 00961000
*                                                                  0534 00962000
*   NEXTLINE=ADDR(AMDTPRI2);        /* NEXT LINE IS FORMATTED BY   0534 00963000
*                                      AMDTPRI2                      */ 00964000
         L     @10,WORKAREA(,PARMSAVE)                             0534 00965000
         LA    @15,AMDTPRI2                                        0534 00966000
         ST    @15,NEXTLINE(,@10)                                  0534 00967000
*   RETCODE=CONTINUE;               /* INDICATE THAT MORE LINES NEED    00968000
*                                      TO BE FORMATTED               */ 00969000
         SLR   @15,@15                                             0535 00970000
         ST    @15,RETCODE(,@10)                                   0535 00971000
*   GO TO AMDEXIT;                  /* RETURN VIA THE EXIT ROUTINE   */ 00972000
         B     AMDEXIT                                             0536 00973000
*AMDTPRI2:                                                         0537 00974000
*                                                                  0537 00975000
*   /*****************************************************************/ 00976000
*   /*                                                               */ 00977000
*   /* AMDTPRI2 - THIS ROUTINE FORMATS THE THIRD OUTPUT LINE FOR     */ 00978000
*   /* TPIOS REMOTE INBOUND RECORDS. FIRST, THE THRH LABEL IS MOVED  */ 00979000
*   /* TO THE BUFFER                                                 */ 00980000
*   /*                                                               */ 00981000
*   /*****************************************************************/ 00982000
*                                                                  0537 00983000
*   TPRITHL=THRHLAB;                                               0537 00984000
*                                                                  0537 00985000
AMDTPRI2 MVC   TPRITHL(4,BUFFPTR),THRHLAB                          0537 00986000
*   /*****************************************************************/ 00987000
*   /*                                                               */ 00988000
*   /* SET UP FOR AND CALL SUBROUTINE HEXFRMT TO FORMAT THE TH-RH    */ 00989000
*   /* DATA                                                          */ 00990000
*   /*                                                               */ 00991000
*   /*****************************************************************/ 00992000
*                                                                  0538 00993000
*   RFY                                                            0538 00994000
*     ISTZIBUF BASED(DATAADDR);                                    0538 00995000
*   DATASTRT=ADDR(ZIBBTU);          /* POINT TO THRH FIELD IN INPUT     00996000
*                                      RECORD                        */ 00997000
         L     @10,DATAADDR(,PARMSAVE)                             0539 00998000
         LA    DATASTRT,ZIBBTU(,@10)                               0539 00999000
*   HEXPARM=ADDR(TPHEX4);           /* POINT TO CORRECT PARAMETER  0540 01000000
*                                      LIST                          */ 01001000
         LA    HEXPARM,TPHEX4                                      0540 01002000
*   CALL HEXFRMT;                                                  0541 01003000
*                                                                  0541 01004000
         BAL   @14,HEXFRMT                                         0541 01005000
*   /*****************************************************************/ 01006000
*   /*                                                               */ 01007000
*   /* CHECK FOR FID1 THRH - IF IT IS, IT IS ONLY 13 BYTES LONG AND  */ 01008000
*   /* THE LAST 7 FORMATTED BYTES MUST BE BLANKED IN OUTPUT BUFFER   */ 01009000
*   /*                                                               */ 01010000
*   /*****************************************************************/ 01011000
*                                                                  0542 01012000
*   RFY                                                            0542 01013000
*     ISTBTU BASED(DATASTRT);                                      0542 01014000
*   IF BTUFIDNO='0001'B THEN                                       0543 01015000
         LR    @10,DATASTRT                                        0543 01016000
         TM    BTUFIDNO(@10),B'00010000'                           0543 01017000
         BNO   @RF00543                                            0543 01018000
         TM    BTUFIDNO(@10),B'11100000'                           0543 01019000
         BNZ   @RF00543                                            0543 01020000
*     DO;                                                          0544 01021000
*       TPRIFID0='';                /* BLANK OUT THE LAST 9 BYTES    */ 01022000
*                                                                  0545 01023000
         MVI   TPRIFID0(BUFFPTR),C' '                              0545 01024000
         MVC   TPRIFID0+1(14,BUFFPTR),TPRIFID0(BUFFPTR)            0545 01025000
*       /*************************************************************/ 01026000
*       /*                                                           */ 01027000
*       /* THIS LINE IS COMPLETE. SET UP FOR NEXT LINE BY FINDING AND*/ 01028000
*       /* CALCULATING THE LENGTH OF THE TEXT IN THE INPUT BUFFER    */ 01029000
*       /*                                                           */ 01030000
*       /*************************************************************/ 01031000
*                                                                  0546 01032000
*       TEXTADDR=ADDR(BTUPAD);      /* FOR FID1, IT BEGINS AT BTUPAD */ 01033000
         L     @10,WORKAREA(,PARMSAVE)                             0546 01034000
         LR    @15,DATASTRT                                        0546 01035000
         LA    @15,BTUPAD(,@15)                                    0546 01036000
         ST    @15,TEXTADDR(,@10)                                  0546 01037000
*     END;                          /* END OF FID1 PATH              */ 01038000
*   ELSE                                                           0548 01039000
*     TEXTADDR=ADDR(BTUTEXT);       /* FOR FID0, IT BEGINS AT BTUTEXT*/ 01040000
         B     @RC00543                                            0548 01041000
@RF00543 L     @10,WORKAREA(,PARMSAVE)                             0548 01042000
         LR    @15,DATASTRT                                        0548 01043000
         LA    @15,BTUTEXT(,@15)                                   0548 01044000
         ST    @15,TEXTADDR(,@10)                                  0548 01045000
*   TEXTLN=DATALNG-((TEXTADDR-DATAADDR)+LENGTH(ISTTRF));/* THE TEXT     01046000
*                                      IS WHATS LEFT AFTER PREFIX AND   01047000
*                                      TRAILER IS REMOVED            */ 01048000
*                                                                  0549 01049000
@RC00543 L     @10,WORKAREA(,PARMSAVE)                             0549 01050000
         L     @15,TEXTADDR(,@10)                                  0549 01051000
         SL    @15,DATAADDR(,PARMSAVE)                             0549 01052000
         AL    @15,@CF02414                                        0549 01053000
         LCR   @15,@15                                             0549 01054000
         AL    @15,DATALNG(,@10)                                   0549 01055000
         ST    @15,TEXTLN(,@10)                                    0549 01056000
*   /*****************************************************************/ 01057000
*   /*                                                               */ 01058000
*   /* INDICATE NEXT ROUTINE TO PROCESS AND RETURN VIA EXIT ROUTINE  */ 01059000
*   /*                                                               */ 01060000
*   /*****************************************************************/ 01061000
*                                                                  0550 01062000
*   NEXTLINE=ADDR(AMDTPRTX);        /* NEXT LINE IS PROCESSED BY   0550 01063000
*                                      AMDTPRTX                      */ 01064000
         LA    @15,AMDTPRTX                                        0550 01065000
         ST    @15,NEXTLINE(,@10)                                  0550 01066000
*   RETCODE=CONTINUE;               /* INDICATE MORE DATA HAS TO BE     01067000
*                                      FORMATTED                     */ 01068000
         SLR   @15,@15                                             0551 01069000
         ST    @15,RETCODE(,@10)                                   0551 01070000
*   GO TO AMDEXIT;                  /* RETURN TO CALLER VIA THE EXIT    01071000
*                                      ROUTINE                       */ 01072000
         B     AMDEXIT                                             0552 01073000
*AMDTPRO1:                                                         0553 01074000
*                                                                  0553 01075000
*   /*****************************************************************/ 01076000
*   /*                                                               */ 01077000
*   /* AMDTPRO1 - THIS ROUTINE FORMATS THE SECOND OUTPUT LINE FOR    */ 01078000
*   /* TPIOS REMOTE OUTBOUND DATA. FIRST, THE REMOTE INDICATOR, DNODE*/ 01079000
*   /* LABEL, AND THRH LABEL ARE MOVED TO THE OUTPUT BUFFER          */ 01080000
*   /*                                                               */ 01081000
*   /*****************************************************************/ 01082000
*                                                                  0553 01083000
*   TRFPTR=DATAADDR+(DATALNG-LENGTH(ISTTRF));                      0553 01084000
AMDTPRO1 L     @10,WORKAREA(,PARMSAVE)                             0553 01085000
         L     @15,DATALNG(,@10)                                   0553 01086000
         SL    @15,@CF02414                                        0553 01087000
         AL    @15,DATAADDR(,PARMSAVE)                             0553 01088000
         ST    @15,TRFPTR(,@10)                                    0553 01089000
*   RFY                                                            0554 01090000
*     ISTTRF BASED(TRFPTR);                                        0554 01091000
*   IF TRFLSNA='1'B                 /* IS THIS A LOCAL SNA DEVICE  0555 01092000
*                                                            @XM08361*/ 01093000
*     THEN                          /* YES MOVE LOCAL INDICATOR    0555 01094000
*                                                            @XM08361*/ 01095000
         TM    TRFLSNA(@15),B'00010000'                            0555 01096000
         BNO   @RF00555                                            0555 01097000
*     TPROLBL=LOCALIND;             /*                       @XM08361*/ 01098000
         MVI   TPROLBL+5(BUFFPTR),C' '                             0556 01099000
         MVC   TPROLBL(5,BUFFPTR),LOCALIND                         0556 01100000
*   ELSE                            /* NO - MUST BE REMOTE   @XM08361*/ 01101000
*     TPROLBL=REMOTIND;             /*                       @XM08361*/ 01102000
         B     @RC00555                                            0557 01103000
@RF00555 MVC   TPROLBL(6,BUFFPTR),REMOTIND                         0557 01104000
*   TPRODNL=DNODELAB;                                              0558 01105000
@RC00555 MVC   TPRODNL(5,BUFFPTR),DNODELAB                         0558 01106000
*   TPROTHL=THRHLAB;                                               0559 01107000
*                                                                  0559 01108000
         MVC   TPROTHL(4,BUFFPTR),THRHLAB                          0559 01109000
*   /*****************************************************************/ 01110000
*   /*                                                               */ 01111000
*   /* MOVE THE DESTINATION NODE FROM TRF TO THE OUTPUT BUFFER       */ 01112000
*   /*                                                               */ 01113000
*   /*****************************************************************/ 01114000
*                                                                  0560 01115000
*   TPRODND=TRFDNODE;               /* MOVE DNODE INTO OUTPUT BUFFER */ 01116000
*                                                                  0560 01117000
         L     @10,WORKAREA(,PARMSAVE)                             0560 01118000
         L     @10,TRFPTR(,@10)                                    0560 01119000
         MVC   TPRODND(8,BUFFPTR),TRFDNODE(@10)                    0560 01120000
*   /*****************************************************************/ 01121000
*   /*                                                               */ 01122000
*   /* SET UP FOR AND CALL SUBROUTINE HEXFRMT TO FORMAT THE TH-RH    */ 01123000
*   /* DATA                                                          */ 01124000
*   /*                                                               */ 01125000
*   /*****************************************************************/ 01126000
*                                                                  0561 01127000
*   RFY                                                            0561 01128000
*     ISTZOBUF BASED(DATAADDR);                                    0561 01129000
*   DATASTRT=ADDR(ZOBBTU);          /* POINT TO THRH FIELD IN INPUT     01130000
*                                      RECORD                        */ 01131000
         L     @10,DATAADDR(,PARMSAVE)                             0562 01132000
         LA    DATASTRT,ZOBBTU(,@10)                               0562 01133000
*   HEXPARM=ADDR(TPHEX4);           /* POINT TO CORRECT PARAMETER  0563 01134000
*                                      LIST                          */ 01135000
         LA    HEXPARM,TPHEX4                                      0563 01136000
*   CALL HEXFRMT;                                                  0564 01137000
*                                                                  0564 01138000
         BAL   @14,HEXFRMT                                         0564 01139000
*   /*****************************************************************/ 01140000
*   /*                                                               */ 01141000
*   /* CHECK FOR FID1 THRH - IF IT IS, IT IS ONLY 13 BYTES LONG AND  */ 01142000
*   /* THE LAST 7 FORMATTED BYTES MUST BE BLANKED IN OUTPUT BUFFER   */ 01143000
*   /*                                                               */ 01144000
*   /*****************************************************************/ 01145000
*                                                                  0565 01146000
*   RFY                                                            0565 01147000
*     ISTBTU BASED(DATASTRT);                                      0565 01148000
*   IF BTUFIDNO='0001'B THEN                                       0566 01149000
         LR    @10,DATASTRT                                        0566 01150000
         TM    BTUFIDNO(@10),B'00010000'                           0566 01151000
         BNO   @RF00566                                            0566 01152000
         TM    BTUFIDNO(@10),B'11100000'                           0566 01153000
         BNZ   @RF00566                                            0566 01154000
*     DO;                                                          0567 01155000
*       TPRIFID0='';                /* BLANK OUT THE LAST 9 BYTES    */ 01156000
*                                                                  0568 01157000
         MVI   TPRIFID0(BUFFPTR),C' '                              0568 01158000
         MVC   TPRIFID0+1(14,BUFFPTR),TPRIFID0(BUFFPTR)            0568 01159000
*       /*************************************************************/ 01160000
*       /*                                                           */ 01161000
*       /* THIS LINE IS COMPLETE. SET UP FOR NEXT LINE BY FINDING AND*/ 01162000
*       /* CALCULATING THE LENGTH OF THE TEXT IN THE INPUT BUFFER    */ 01163000
*       /*                                                           */ 01164000
*       /*************************************************************/ 01165000
*                                                                  0569 01166000
*       TEXTADDR=ADDR(BTUPAD);      /* FOR FID1, IT BEGINS AT BTUPAD */ 01167000
         L     @10,WORKAREA(,PARMSAVE)                             0569 01168000
         LR    @15,DATASTRT                                        0569 01169000
         LA    @15,BTUPAD(,@15)                                    0569 01170000
         ST    @15,TEXTADDR(,@10)                                  0569 01171000
*     END;                          /* END OF FID1 PATH              */ 01172000
*   ELSE                                                           0571 01173000
*     TEXTADDR=ADDR(BTUTEXT);       /* FOR FID0, IT BEGINS AT BTUTEXT*/ 01174000
         B     @RC00566                                            0571 01175000
@RF00566 L     @10,WORKAREA(,PARMSAVE)                             0571 01176000
         LR    @15,DATASTRT                                        0571 01177000
         LA    @15,BTUTEXT(,@15)                                   0571 01178000
         ST    @15,TEXTADDR(,@10)                                  0571 01179000
*   TEXTLN=DATALNG-((TEXTADDR-DATAADDR)+LENGTH(ISTTRF));/* THE TEXT     01180000
*                                      IS WHATS LEFT AFTER PREFIX AND   01181000
*                                      TRAILER IS REMOVED            */ 01182000
*                                                                  0572 01183000
@RC00566 L     @10,WORKAREA(,PARMSAVE)                             0572 01184000
         L     @15,TEXTADDR(,@10)                                  0572 01185000
         SL    @15,DATAADDR(,PARMSAVE)                             0572 01186000
         AL    @15,@CF02414                                        0572 01187000
         LCR   @15,@15                                             0572 01188000
         AL    @15,DATALNG(,@10)                                   0572 01189000
         ST    @15,TEXTLN(,@10)                                    0572 01190000
*   /*****************************************************************/ 01191000
*   /*                                                               */ 01192000
*   /* INDICATE NEXT ROUTINE TO PROCESS AND RETURN                   */ 01193000
*   /*                                                               */ 01194000
*   /*****************************************************************/ 01195000
*                                                                  0573 01196000
*   NEXTLINE=ADDR(AMDTPRTX);        /* NEXT LINE IS PROCESSED BY   0573 01197000
*                                      AMDTPRTX                      */ 01198000
         LA    @15,AMDTPRTX                                        0573 01199000
         ST    @15,NEXTLINE(,@10)                                  0573 01200000
*   RETCODE=CONTINUE;               /* INDICATE MORE DATA HAS TO BE     01201000
*                                      FORMATTED                     */ 01202000
         SLR   @15,@15                                             0574 01203000
         ST    @15,RETCODE(,@10)                                   0574 01204000
*   GO TO AMDEXIT;                  /* RETURN TO CALLER VIA THE EXIT    01205000
*                                      ROUTINE                       */ 01206000
         B     AMDEXIT                                             0575 01207000
*AMDTPRTX:                                                         0576 01208000
*                                                                  0576 01209000
*   /*****************************************************************/ 01210000
*   /*                                                               */ 01211000
*   /* AMDTPRTX - THIS ROUTINE PROCESSES THOSE OUTPUT LINES FOR TPIOS*/ 01212000
*   /* AND FORMAT2 LINE TRACE RECORDS. THE LINES CONTAIN     @Z40GKTQ*/ 01213000
*   /* ONLY A TEXT LABEL AND DATA(AS OPPOSED TO STATUS)      @Z40GKTQ*/ 01214000
*   /* INFORMATION. FIRST, THE LABEL IS MOVED IN AND THEN SUBROUTINE */ 01215000
*   /* FRMTEXT IS CALLED TO FORMAT THE TEXT.                         */ 01216000
*   /*                                                               */ 01217000
*   /*****************************************************************/ 01218000
*                                                                  0576 01219000
*   TPTXTLBL=TEXTLAB;               /* MOVE LABEL TO OUTPUT BUFFER   */ 01220000
AMDTPRTX MVC   TPTXTLBL(4,BUFFPTR),TEXTLAB                         0576 01221000
*   CALL FRMTEXT;                   /* SETUP FOR SUBROUTINE HAS    0577 01222000
*                                      ALREADY BEEN DONE BY ROUTINE     01223000
*                                      WHICH SCHEDULED AMDTPRTX      */ 01224000
*                                                                  0577 01225000
         BAL   @14,FRMTEXT                                         0577 01226000
*   /*****************************************************************/ 01227000
*   /*                                                               */ 01228000
*   /* OUTPUT LINE IS COMPLETE. IF MORE TEXT REMAINS, THE NEXT LINE  */ 01229000
*   /* WILL BE HANDLED BY AMDTXTLN. IF NO MORE TEXT, THIS RECORD HAS */ 01230000
*   /* BEEN COMPLETELY FORMATTED, AND ITS TIME TO GET A NEW ONE,     */ 01231000
*   /* UNLESS A FORMAT 2 LINE TRACE RECORD IS BEING PROCESSED, IN    */ 01232000
*   /* WHICH CASE AMDLNE01 IS SELECTED TO BE INVOKED NEXT-HE WILL    */ 01233000
*   /* THEN MAKE THAT DETERMINATION.                         @Z40GKTQ*/ 01234000
*   /*                                                               */ 01235000
*   /*****************************************************************/ 01236000
*                                                                  0578 01237000
*   IF TEXTLN=0                     /* IF THERE IS NO MORE TEXT    0578 01238000
*                                                            @Z40GKTQ*/ 01239000
*     THEN                          /* IN THIS RECORD        @Z40GKTQ*/ 01240000
         SLR   @10,@10                                             0578 01241000
         L     @15,WORKAREA(,PARMSAVE)                             0578 01242000
         C     @10,TEXTLN(,@15)                                    0578 01243000
         BNE   @RF00578                                            0578 01244000
*     IF INPUTEID=ISTLNEID          /* AND IT'S A LINE TRACE @Z40GKTQ*/ 01245000
*       THEN                                                       0579 01246000
         L     @14,EIDADDR(,PARMSAVE)                              0579 01247000
         CLC   INPUTEID(2,@14),@CH00590                            0579 01248000
         BNE   @RF00579                                            0579 01249000
*       DO;                         /* RECORD, THEN LET      @Z40GKTQ*/ 01250000
*         NEXTLINE=ADDR(AMDLNE01);  /* AMDLNE01 DECIDE WHAT  @Z40GKTQ*/ 01251000
         LA    @14,AMDLNE01                                        0581 01252000
         ST    @14,NEXTLINE(,@15)                                  0581 01253000
*         RETCODE=CONTINUE;         /* TO DO NEXT            @Z40GKTQ*/ 01254000
         ST    @10,RETCODE(,@15)                                   0582 01255000
*       END;                        /*                       @Z40GKTQ*/ 01256000
*     ELSE                          /* IF IT'S TPIOS         @Z40GKTQ*/ 01257000
*       RETCODE=GETNEXT;            /* INDICATE VIA RETURN CODE THAT    01258000
*                                      ANOTHER INPUT RECORD IS TO BE    01259000
*                                      GOTTEN                @Z40GKTQ*/ 01260000
         B     @RC00579                                            0584 01261000
@RF00579 L     @10,WORKAREA(,PARMSAVE)                             0584 01262000
         MVC   RETCODE(4,@10),@CF00036                             0584 01263000
*   ELSE                                                           0585 01264000
*     DO;                                                          0585 01265000
         B     @RC00578                                            0585 01266000
@RF00578 DS    0H                                                  0586 01267000
*       NEXTLINE=ADDR(AMDTXTLN);    /* OTHERWISE, REMAINING LINES  0586 01268000
*                                      WILL BE PROCESSED BY AMDTXTLN */ 01269000
         L     @10,WORKAREA(,PARMSAVE)                             0586 01270000
         LA    @15,AMDTXTLN                                        0586 01271000
         ST    @15,NEXTLINE(,@10)                                  0586 01272000
*       RETCODE=CONTINUE;           /* INDICATE MORE TO DO           */ 01273000
         SLR   @15,@15                                             0587 01274000
         ST    @15,RETCODE(,@10)                                   0587 01275000
*     END;                                                         0588 01276000
*   GO TO AMDEXIT;                  /* RETURN VIA EXIT ROUTINE       */ 01277000
         B     AMDEXIT                                             0589 01278000
*AMDTXTLN:                                                         0590 01279000
*                                                                  0590 01280000
*   /*****************************************************************/ 01281000
*   /*                                                               */ 01282000
*   /* AMDTXTLN - THIS ROUTINE PROCESSES THOS OUTPUT LINES(TPIOS,    */ 01283000
*   /* CONTROL LAYER AND FORMAT2 LINE TRACE) WHICH CONTAIN ONLY TEXT */ 01284000
*   /* INFO. ON ENTRY, VARIABLES TEXTLN AND TEXTADDR CONTAIN THE TEXT*/ 01285000
*   /* LENGTH AND ADDRESS, RESPECTIVELY                              */ 01286000
*   /*                                                               */ 01287000
*   /*****************************************************************/ 01288000
*                                                                  0590 01289000
*   CALL FRMTEXT;                   /* CALL SUBROUTINE TO DO THE   0590 01290000
*                                      WORK, SETUP ALREADY HAS BEEN     01291000
*                                      DONE                          */ 01292000
*                                                                  0590 01293000
AMDTXTLN BAL   @14,FRMTEXT                                         0590 01294000
*   /*****************************************************************/ 01295000
*   /*                                                               */ 01296000
*   /* IF MORE TEXT REMAINS TO BE FORMATTED, INDICATE TO EDIT TO     */ 01297000
*   /* CONTINUE PROCESSING THIS SAME INPUT RECORD. NOTE THAT NEXTLINE*/ 01298000
*   /* IS STILL SET TO THE ADDRESS OF THIS ROUTINE. IF NO MORE TEXT  */ 01299000
*   /* REMAINS, INDICATE TO EDIT THAT THE RECORD IS COMPLETE (EXCEPT */ 01300000
*   /* FOR FORMAT 2 LINE TRACE RECORDS, IN WHICH CASE AMDLNE01 IS SET*/ 01301000
*   /* UP TO MAKE THAT DETERMINATION).                       @Z40GHTQ*/ 01302000
*   /*                                                               */ 01303000
*   /*****************************************************************/ 01304000
*                                                                  0591 01305000
*   IF TEXTLN=0                     /* ANY TEXT LEFT?        @Z40GKTQ*/ 01306000
*     THEN                          /* NO TXT LEFT IN THIS REC     0591 01307000
*                                                            @Z40GKTQ*/ 01308000
         SLR   @10,@10                                             0591 01309000
         L     @15,WORKAREA(,PARMSAVE)                             0591 01310000
         C     @10,TEXTLN(,@15)                                    0591 01311000
         BNE   @RF00591                                            0591 01312000
*     IF INPUTEID=ISTLNEID          /* IS IT LINE TRACE?     @Z40GKTQ*/ 01313000
*       THEN                                                       0592 01314000
         L     @14,EIDADDR(,PARMSAVE)                              0592 01315000
         CLC   INPUTEID(2,@14),@CH00590                            0592 01316000
         BNE   @RF00592                                            0592 01317000
*       DO;                         /* SET UP AMDLNE01 TO BE @Z40GKTQ*/ 01318000
*         NEXTLINE=ADDR(AMDLNE01);  /* INVOKED NEXT TIME     @Z40GKTQ*/ 01319000
         LA    @14,AMDLNE01                                        0594 01320000
         ST    @14,NEXTLINE(,@15)                                  0594 01321000
*         RETCODE=CONTINUE;         /* AROUND                @Z40GKTQ*/ 01322000
         ST    @10,RETCODE(,@15)                                   0595 01323000
*       END;                        /*                       @Z40GKTQ*/ 01324000
*     ELSE                          /* IF NOT LINE TRACE,JUST      0597 01325000
*                                                            @Z40GKTQ*/ 01326000
*       RETCODE=GETNEXT;            /* PRINT AND GET NEXT REC      0597 01327000
*                                                            @Z40GKTQ*/ 01328000
         B     @RC00592                                            0597 01329000
@RF00592 L     @10,WORKAREA(,PARMSAVE)                             0597 01330000
         MVC   RETCODE(4,@10),@CF00036                             0597 01331000
*   ELSE                                                           0598 01332000
*     RETCODE=CONTINUE;                                            0598 01333000
         B     @RC00591                                            0598 01334000
@RF00591 L     @10,WORKAREA(,PARMSAVE)                             0598 01335000
         SLR   @15,@15                                             0598 01336000
         ST    @15,RETCODE(,@10)                                   0598 01337000
*   GO TO AMDEXIT;                  /* RETURN VIA THE EXIT ROUTINE   */ 01338000
         B     AMDEXIT                                             0599 01339000
*AMDLNTR2:                          /*                       @ZM41491*/ 01340000
*                                                                  0600 01341000
*   /*****************************************************************/ 01342000
*   /*                                                               */ 01343000
*   /* AMDLNTR2 - THIS ROUTINE FORMATS LINE TRACE DA         @ZM41491*/ 01344000
*   /* 2 ENTRIES PER LINE. ON ENTRY, LINECNT CONTAINS THE NUMBER     */ 01345000
*   /*                                                       @ZM41491*/ 01346000
*   /* OF 4-BYTE ENTRIES TO BE FORMATTED, AND LINEADDR CONTAINS      */ 01347000
*   /*                                                       @ZM41491*/ 01348000
*   /* ADDRESS OF THE BEGINNING OF THIS DATA. FIRST, THE     @ZM41491*/ 01349000
*   /* APPROPRIATE LABELS ARE MOVED INTO THE OUTPUT BUFFER   @ZM41491*/ 01350000
*   /*                                                               */ 01351000
*   /*****************************************************************/ 01352000
*                                                                  0600 01353000
*   LN2FIRST=LINELABS;              /* MOVE LABELS INTO FIRST ENTRY     01354000
*                                                            @ZM41491*/ 01355000
AMDLNTR2 MVC   LN2FIRST(37,BUFFPTR),LINELABS                       0600 01356000
*   LN2SECND=LINELABS;              /* MOVE LABELS INTO SECOND ENTRY    01357000
*                                                            @ZM41491*/ 01358000
*                                                                  0601 01359000
         MVC   LN2SECND(37,BUFFPTR),LINELABS                       0601 01360000
*   /*****************************************************************/ 01361000
*   /*                                                               */ 01362000
*   /* SET UP FOR AND CALL SUBROUTINE HEXFRMT TO FORM        @ZM41491*/ 01363000
*   /* THE LINE TRACE DATA INTO THE BUFFER                   @ZM41491*/ 01364000
*   /*                                                               */ 01365000
*   /*****************************************************************/ 01366000
*                                                                  0602 01367000
*   DATASTRT=LINEADDR;              /* POINT AT THE DATA     @ZM41491*/ 01368000
         L     @10,WORKAREA(,PARMSAVE)                             0602 01369000
         L     DATASTRT,LINEADDR(,@10)                             0602 01370000
*   HEXPARM=ADDR(LNHEX2);           /* GET ADDR OF CORRECT PLIST   0603 01371000
*                                                            @ZM41491*/ 01372000
         LA    HEXPARM,LNHEX2                                      0603 01373000
*   CALL HEXFRMT;                   /*                       @ZM41491*/ 01374000
*                                                                  0604 01375000
         BAL   @14,HEXFRMT                                         0604 01376000
*   /*****************************************************************/ 01377000
*   /*                                                               */ 01378000
*   /* A FULL BYTE OF DATA HAS BEEN FORMATTED FOR THE        @ZM41491*/ 01379000
*   /* LCD FIELDS, WHICH ARE ONLY HALF-BYTE IN LENGTH. THE EXTR      */ 01380000
*   /*                                                       @ZM41491*/ 01381000
*   /* HALF-BYTE WHICH WAS FORMATTED IS THE PCF DATA. EACH OF TH     */ 01382000
*   /*                                                       @ZM41491*/ 01383000
*   /* HALF-BYTES OF DATA HAVE BEEN CONVERTED IN THE OUTPUT BUFF     */ 01384000
*   /*                                                       @ZM41491*/ 01385000
*   /* BYTES OF PRINTABLE HEX DATA. THE SECOND BYTE OF PRINTABL      */ 01386000
*   /*                                                       @ZM41491*/ 01387000
*   /* (REPRESENTING THE SECOND HALF-BYTE OF HEX DATA) IS NOW MO     */ 01388000
*   /*                                                       @ZM41491*/ 01389000
*   /* INTO THE PCF FIELDS FOR BOTH ENTRIES IN THE OUTPUT BUFFER     */ 01390000
*   /*                                                       @ZM41491*/ 01391000
*   /*                                                               */ 01392000
*   /*****************************************************************/ 01393000
*                                                                  0605 01394000
*   LN2PCFD1=LN2LCDE1;              /* MOVE PCF DATA         @ZM41491*/ 01395000
         MVC   LN2PCFD1(1,BUFFPTR),LN2LCDE1(BUFFPTR)               0605 01396000
*   LN2LCDE1=' ';                   /* BLANK OUT THE BYTE JUST MOVED    01397000
*                                                            @ZM41491*/ 01398000
         MVI   LN2LCDE1(BUFFPTR),C' '                              0606 01399000
*   LN2PCFD2=LN2LCDE2;              /* MOVE PCF DATA IN SECOND ENTRY    01400000
*                                                            @ZM41491*/ 01401000
         MVC   LN2PCFD2(1,BUFFPTR),LN2LCDE2(BUFFPTR)               0607 01402000
*   LN2LCDE2=' ';                   /* BLANK OUT EXTRA BYTE  @ZM41491*/ 01403000
*                                                                  0608 01404000
         MVI   LN2LCDE2(BUFFPTR),C' '                              0608 01405000
*   /*****************************************************************/ 01406000
*   /*                                                               */ 01407000
*   /* THIS LINE IS COMPLETE. CALCULATE THE REMAININ         @ZM41491*/ 01408000
*   /* OF 4-BYTE ENTRIES REMAINING, AND SET THE PROPER RETURN        */ 01409000
*   /* CODE@ZM41491                                                  */ 01410000
*   /*                                                               */ 01411000
*   /*****************************************************************/ 01412000
*                                                                  0609 01413000
*   LINECNT=LINECNT-2;              /* DECREMENT BY THE 2 JUST     0609 01414000
*                                      FORMATED@ZM41491              */ 01415000
         L     @10,WORKAREA(,PARMSAVE)                             0609 01416000
         L     @15,LINECNT(,@10)                                   0609 01417000
         BCTR  @15,0                                               0609 01418000
         BCTR  @15,0                                               0609 01419000
         ST    @15,LINECNT(,@10)                                   0609 01420000
*   IF LINECNT>0 THEN                                              0610 01421000
         SLR   @14,@14                                             0610 01422000
         CR    @15,@14                                             0610 01423000
         BNH   @RF00610                                            0610 01424000
*     DO;                           /* IF MORE ENTRIES REMAIN, SET UP   01425000
*                                                            @ZM41491   01426000
*                                      FOR THE NEXT LINE     @ZM41491*/ 01427000
*       LINEADDR=LINEADDR+8;        /* INCREMENT DATA ADDRESS      0612 01428000
*                                                            @ZM41491   01429000
*                                      8 BYTES JUST FORMATTED      0612 01430000
*                                                            @ZM41491*/ 01431000
         LA    @15,8                                               0612 01432000
         AL    @15,LINEADDR(,@10)                                  0612 01433000
         ST    @15,LINEADDR(,@10)                                  0612 01434000
*       RETCODE=CONTINUE;           /* SET RC TO INDICATE MORE TO DO    01435000
*                                                            @ZM41491*/ 01436000
         ST    @14,RETCODE(,@10)                                   0613 01437000
*     END;                          /* END OF MORE-TO-FORMAT PATH  0614 01438000
*                                                            @ZM41491*/ 01439000
*   ELSE                                                           0615 01440000
*     DO;                           /* OTHERWISE, ALL DATA HAS BEEN     01441000
*                                      FORMATTED             @ZM41491*/ 01442000
         B     @RC00610                                            0615 01443000
@RF00610 DS    0H                                                  0616 01444000
*       IF LINECNT<0 THEN                                          0616 01445000
         L     @10,WORKAREA(,PARMSAVE)                             0616 01446000
         L     @10,LINECNT(,@10)                                   0616 01447000
         LTR   @10,@10                                             0616 01448000
         BNM   @RF00616                                            0616 01449000
*         LN2SECND='';              /* IF COUNT HAS GONE     @ZM41491   01450000
*                                      NEGATIVE, ONE TOO MANY ENTRIES   01451000
*                                      HAVE BEEN FORMATTED   @ZM41491   01452000
*                                      SECOND ONE IS BLANKED OUT   0617 01453000
*                                                            @ZM41491*/ 01454000
         MVI   LN2SECND(BUFFPTR),C' '                              0617 01455000
         MVC   LN2SECND+1(36,BUFFPTR),LN2SECND(BUFFPTR)            0617 01456000
*       RETCODE=GETNEXT;            /* SET RC TO SHOW COMPLETION   0618 01457000
*                                                            @ZM41491*/ 01458000
@RF00616 L     @10,WORKAREA(,PARMSAVE)                             0618 01459000
         MVC   RETCODE(4,@10),@CF00036                             0618 01460000
*     END;                          /* END OF NEGATIVE-OR-ZERO PATH     01461000
*                                                            @ZM41491*/ 01462000
*   GO TO AMDEXIT;                  /* RETURN VIA THE EXIT ROUTINE 0620 01463000
*                                                            @ZM41491*/ 01464000
*                                                                  0620 01465000
         B     AMDEXIT                                             0620 01466000
*   /*****************************************************************/ 01467000
*   /*                                                               */ 01468000
*   /* FORMAT FIRST LINE OF SMS BUFFER TRACE                         */ 01469000
*   /*                                                               */ 01470000
*   /*****************************************************************/ 01471000
*                                                                  0621 01472000
*AMDSMS01:                                                         0621 01473000
*   ;                                                              0621 01474000
AMDSMS01 DS    0H                                                  0622 01475000
*   IOLABEL=IOCHAR;                 /* IO POOL LABEL         @ZA10433*/ 01476000
         MVC   IOLABEL(2,BUFFPTR),IOCHAR                           0622 01477000
*   PPLABEL=PPCHAR;                 /* PP POOL LABEL         @ZA10433*/ 01478000
         MVC   PPLABEL(2,BUFFPTR),PPCHAR                           0623 01479000
*   LPLABEL=LPCHAR;                 /* LP POOL LABEL         @ZA10433*/ 01480000
         MVC   LPLABEL(2,BUFFPTR),LPCHAR                           0624 01481000
*   WPLABEL=WPCHAR;                 /* WP POOL LABEL         @ZA10433*/ 01482000
         MVC   WPLABEL(2,BUFFPTR),WPCHAR                           0625 01483000
*   DATASTRT=DATAADDR;              /* ADDRESS OF DATA TO FORMAT     */ 01484000
         L     DATASTRT,DATAADDR(,PARMSAVE)                        0626 01485000
*   HEXPARM=ADDR(SFHEX);            /* PATTERN OF FORMAT     @ZA13637*/ 01486000
         LA    HEXPARM,SFHEX                                       0627 01487000
*   CALL HEXFRMT;                   /* FORMAT POOL DATA              */ 01488000
         BAL   @14,HEXFRMT                                         0628 01489000
*   DATASTRT=DATASTRT+POOLSZ;       /* BUMP TO NEXT POOL             */ 01490000
         AL    DATASTRT,@CF00060                                   0629 01491000
*   HEXPARM=ADDR(SPHEX);            /* PATTERN OF FORMAT     @ZA13637*/ 01492000
         LA    HEXPARM,SPHEX                                       0630 01493000
*   CALL HEXFRMT;                   /* FORMAT POOL DATA              */ 01494000
         BAL   @14,HEXFRMT                                         0631 01495000
*   DATASTRT=DATASTRT+POOLSZ;       /* BUMP TO NEXT POOL             */ 01496000
         AL    DATASTRT,@CF00060                                   0632 01497000
*   HEXPARM=ADDR(LFHEX);            /* PATTERN OF FORMAT     @ZA13637*/ 01498000
         LA    HEXPARM,LFHEX                                       0633 01499000
*   CALL HEXFRMT;                   /* FORMAT POOL DATA              */ 01500000
         BAL   @14,HEXFRMT                                         0634 01501000
*   DATASTRT=DATASTRT+POOLSZ;       /* BUMP TO NEXT POOL             */ 01502000
         AL    DATASTRT,@CF00060                                   0635 01503000
*   HEXPARM=ADDR(LPHEX);            /* PATTERN OF FORMAT     @ZA13637*/ 01504000
         LA    HEXPARM,LPHEX                                       0636 01505000
*   CALL HEXFRMT;                   /* FORMAT POOL DATA              */ 01506000
         BAL   @14,HEXFRMT                                         0637 01507000
*   RETCODE=CONTINUE;               /* INDICATE MORE LINES           */ 01508000
         L     @10,WORKAREA(,PARMSAVE)                             0638 01509000
         SLR   @15,@15                                             0638 01510000
         ST    @15,RETCODE(,@10)                                   0638 01511000
*   NEXTLINE=ADDR(AMDSMS02);        /* SECOND LINE PROCESSOR         */ 01512000
         LA    @15,AMDSMS02                                        0639 01513000
         ST    @15,NEXTLINE(,@10)                                  0639 01514000
*   GOTO AMDEXIT;                   /* RETURN TO EDIT TO PRINT       */ 01515000
*                                                                  0640 01516000
         B     AMDEXIT                                             0640 01517000
*   /*****************************************************************/ 01518000
*   /*                                                               */ 01519000
*   /* FORMAT SECOND LINE OF SMS BUFFER TRACE                        */ 01520000
*   /*                                                               */ 01521000
*   /*****************************************************************/ 01522000
*                                                                  0641 01523000
*AMDSMS02:                                                         0641 01524000
*   ;                                                              0641 01525000
AMDSMS02 DS    0H                                                  0642 01526000
*   NPLABEL=NPCHAR;                 /* NP POOL LABEL         @ZA10433*/ 01527000
         MVC   NPLABEL(2,BUFFPTR),NPCHAR                           0642 01528000
*   LFLABEL=LFCHAR;                 /* LF POOL LABEL         @ZA10433*/ 01529000
         MVC   LFLABEL(2,BUFFPTR),LFCHAR                           0643 01530000
*   CRLABEL=CRCHAR;                 /* CR POOL LABEL         @ZA10433*/ 01531000
         MVC   CRLABEL(2,BUFFPTR),CRCHAR                           0644 01532000
*   UELABEL=UECHAR;                 /* UE POOL LABEL         @ZA10433*/ 01533000
         MVC   UELABEL(2,BUFFPTR),UECHAR                           0645 01534000
*   DATASTRT=DATAADDR+LINESZ;       /* ADDRESS OF SECOND LINE DATA   */ 01535000
         LA    DATASTRT,32                                         0646 01536000
         AL    DATASTRT,DATAADDR(,PARMSAVE)                        0646 01537000
*   HEXPARM=ADDR(UEHEX);            /* PATTERN OF FORMAT     @ZA13637*/ 01538000
         LA    HEXPARM,UEHEX                                       0647 01539000
*   CALL HEXFRMT;                   /* FORMAT POOL DATA              */ 01540000
         BAL   @14,HEXFRMT                                         0648 01541000
*   DATASTRT=DATASTRT+POOLSZ;       /* BUMP TO NEXT POOL             */ 01542000
         AL    DATASTRT,@CF00060                                   0649 01543000
*   HEXPARM=ADDR(IOHEX);            /* PATTERN OF FORMAT     @ZA13637*/ 01544000
         LA    HEXPARM,IOHEX                                       0650 01545000
*   CALL HEXFRMT;                   /* FORMAT POOL DATA              */ 01546000
         BAL   @14,HEXFRMT                                         0651 01547000
*   DATASTRT=DATASTRT+POOLSZ;       /* BUMP TO NEXT POOL             */ 01548000
         AL    DATASTRT,@CF00060                                   0652 01549000
*   HEXPARM=ADDR(WPHEX);            /* PATTERN OF FORMAT     @ZA13637*/ 01550000
         LA    HEXPARM,WPHEX                                       0653 01551000
*   CALL HEXFRMT;                   /* FORMAT POOL DATA              */ 01552000
         BAL   @14,HEXFRMT                                         0654 01553000
*   DATASTRT=DATASTRT+POOLSZ;       /* BUMP TO NEXT POOL             */ 01554000
         AL    DATASTRT,@CF00060                                   0655 01555000
*   HEXPARM=ADDR(APHEX);            /* PATTERN OF FORMAT     @ZA13637*/ 01556000
         LA    HEXPARM,APHEX                                       0656 01557000
*   CALL HEXFRMT;                   /* FORMAT POOL DATA              */ 01558000
         BAL   @14,HEXFRMT                                         0657 01559000
*   RETCODE=CONTINUE;               /* INDICATE MORE LINES           */ 01560000
         L     @10,WORKAREA(,PARMSAVE)                             0658 01561000
         SLR   @15,@15                                             0658 01562000
         ST    @15,RETCODE(,@10)                                   0658 01563000
*   NEXTLINE=ADDR(AMDSMS03);        /* THIRD LINE PROCESSOR          */ 01564000
         LA    @15,AMDSMS03                                        0659 01565000
         ST    @15,NEXTLINE(,@10)                                  0659 01566000
*   GOTO AMDEXIT;                   /* RETURN TO EDIT TO PRINT       */ 01567000
*                                                                  0660 01568000
         B     AMDEXIT                                             0660 01569000
*   /*****************************************************************/ 01570000
*   /*                                                               */ 01571000
*   /* FORMAT THIRD LINE OF SMS BUFFER TRACE                         */ 01572000
*   /*                                                               */ 01573000
*   /*****************************************************************/ 01574000
*                                                                  0661 01575000
*AMDSMS03:                                                         0661 01576000
*   ;                                                              0661 01577000
AMDSMS03 DS    0H                                                  0662 01578000
*   SFLABEL=SFCHAR;                 /* SF POOL LABEL         @ZA10433*/ 01579000
         MVC   SFLABEL(2,BUFFPTR),SFCHAR                           0662 01580000
*   SPLABEL=SPCHAR;                 /* SP POOL LABEL         @ZA10433*/ 01581000
         MVC   SPLABEL(2,BUFFPTR),SPCHAR                           0663 01582000
*   APLABEL=APCHAR;                 /* AP POOL LABEL         @ZA10433*/ 01583000
         MVC   APLABEL(2,BUFFPTR),APCHAR                           0664 01584000
*   DATASTRT=DATAADDR+(LINESZ*2);   /* THIRD LINE START              */ 01585000
         LA    DATASTRT,64                                         0665 01586000
         AL    DATASTRT,DATAADDR(,PARMSAVE)                        0665 01587000
*   HEXPARM=ADDR(PPHEX);            /* PATTERN OF FORMAT     @ZA13637*/ 01588000
         LA    HEXPARM,PPHEX                                       0666 01589000
*   CALL HEXFRMT;                   /* FORMAT POOL DATA              */ 01590000
         BAL   @14,HEXFRMT                                         0667 01591000
*   DATASTRT=DATASTRT+POOLSZ;       /* BUMP TO NEXT POOL             */ 01592000
         AL    DATASTRT,@CF00060                                   0668 01593000
*   HEXPARM=ADDR(NPHEX);            /* PATTERN OF FORMAT     @ZA13637*/ 01594000
         LA    HEXPARM,NPHEX                                       0669 01595000
*   CALL HEXFRMT;                   /* FORMAT POOL DATA              */ 01596000
         BAL   @14,HEXFRMT                                         0670 01597000
*   DATASTRT=DATASTRT+POOLSZ;       /* BUMP TO NEXT POOL             */ 01598000
         AL    DATASTRT,@CF00060                                   0671 01599000
*   HEXPARM=ADDR(CRHEX);            /* PATTERN OF FORMAT     @ZA13637*/ 01600000
         LA    HEXPARM,CRHEX                                       0672 01601000
*   CALL HEXFRMT;                   /* FORMAT POOL DATA              */ 01602000
         BAL   @14,HEXFRMT                                         0673 01603000
*   RETCODE=GETNEXT;                /* INDICATE NO MORE LINES        */ 01604000
         L     @10,WORKAREA(,PARMSAVE)                             0674 01605000
         MVC   RETCODE(4,@10),@CF00036                             0674 01606000
*   GOTO AMDEXIT;                   /* RETURN TO EDIT TO PRINT       */ 01607000
         B     AMDEXIT                                             0675 01608000
*AMDLNE01:                          /*                       @Z40GKTQ*/ 01609000
*                                                                  0676 01610000
*   /*****************************************************************/ 01611000
*   /*                                                               */ 01612000
*   /* THIS SUBROUTINE IS INVOKED DURING FORMAT 2 LINE       @Z40GKTQ*/ 01613000
*   /* TRACE PROCESSING. IT HANDLES THE FIRST OUTPUT LINE FOR A      */ 01614000
*   /*                                                       @Z40GKTQ*/ 01615000
*   /* SERIES OF THE SAME TYPE OF LINE (THAT IS, DATA OR STATUS).    */ 01616000
*   /*                                                       @Z40GKTQ*/ 01617000
*   /* FOR STATUS, IT MOVES IN THE LABELS; FOR DATA IT MERELY        */ 01618000
*   /*                                                       @Z40GKTQ*/ 01619000
*   /* SETS UP A BRANCH TO AMDTPRTX.                         @Z40GKTQ*/ 01620000
*   /*                                                               */ 01621000
*   /*****************************************************************/ 01622000
*                                                                  0676 01623000
*   RETCODE=CONTINUE;               /* INITIALIZE RETURN CODE      0676 01624000
*                                                            @Z40GKTQ*/ 01625000
*                                                                  0676 01626000
AMDLNE01 L     @10,WORKAREA(,PARMSAVE)                             0676 01627000
         SLR   @15,@15                                             0676 01628000
         ST    @15,RETCODE(,@10)                                   0676 01629000
*   /*****************************************************************/ 01630000
*   /*                                                               */ 01631000
*   /* LINEADDR, AS MAINTAINED IN PASSAREA, WILL BE          @Z40GKTQ*/ 01632000
*   /* UPDATED TO POINT TO THE INFORMATION BLOCK CURRENTLY BEING     */ 01633000
*   /*                                                       @Z40GKTQ*/ 01634000
*   /* WORKED ON.                                            @Z40GKTQ*/ 01635000
*   /*                                                               */ 01636000
*   /*****************************************************************/ 01637000
*                                                                  0677 01638000
*   IF LINEADDR>=TRFPTR             /* WHEN LINEADDR CONTAINS THE  0677 01639000
*                                      TRAILER ADDRESS, ALL INFO HAS    01640000
*                                      BEEN PROCESSED.       @Z40GKTQ*/ 01641000
*     THEN                                                         0677 01642000
         CLC   LINEADDR(4,@10),TRFPTR(@10)                         0677 01643000
         BL    @RF00677                                            0677 01644000
*     RETCODE=IGNORE;               /* RC=8 MEANS GET THE NEXT RECORD   01645000
*                                      WITHOUT PRINTING A LINE     0678 01646000
*                                                            @Z40GKTQ*/ 01647000
         MVC   RETCODE(4,@10),@CF00060                             0678 01648000
*   ELSE                                                           0679 01649000
*     DO;                           /* WE HAVE MORE INFORMATION TO 0679 01650000
*                                      PRINT ON THIS LINE    @Z40GKTQ*/ 01651000
         B     @RC00677                                            0679 01652000
@RF00677 DS    0H                                                  0680 01653000
*       IF BLKTYPE=OFF              /* FIRST BIT ON MEANS DATA     0680 01654000
*                                                            @Z40GKTQ*/ 01655000
*         THEN                                                     0680 01656000
         L     @10,WORKAREA(,PARMSAVE)                             0680 01657000
         L     @15,LINEADDR(,@10)                                  0680 01658000
         TM    BLKTYPE(@15),B'10000000'                            0680 01659000
         BNZ   @RF00680                                            0680 01660000
*         DO;                       /* MOVE IN LABELS:       @Z40GKTQ*/ 01661000
*           LLABEL=LINELABE;        /*                       @Z40GKTQ*/ 01662000
         MVC   LLABEL(79,BUFFPTR),LINELABE                         0682 01663000
*           TEMPCNT=BLKCNT;         /* SAVE THAT COUNT IN A TEMPORARY   01664000
*                                      AREA SO THAT YOU CAN BUMP THE    01665000
*                                      POINTER PAST THE COUNT IN THE    01666000
*                                      GTF RECORD.           @Z40GKTQ*/ 01667000
         IC    @14,BLKCNT(,@15)                                    0683 01668000
         STC   @14,TEMPCNT(,@10)                                   0683 01669000
*           LINEADDR=LINEADDR+2;    /* BUMP THAT PTR         @Z40GKTQ*/ 01670000
         AL    @15,@CF00042                                        0684 01671000
         ST    @15,LINEADDR(,@10)                                  0684 01672000
*           NEXTLINE=ADDR(AMDLNE02);/* AMDLNE02 WILL FORMAT THE    0685 01673000
*                                      STATUS INTO A PRINTABLE LINE     01674000
*                                                            @Z40GKTQ*/ 01675000
         LA    @15,AMDLNE02                                        0685 01676000
         ST    @15,NEXTLINE(,@10)                                  0685 01677000
*         END;                      /*                       @Z40GKTQ*/ 01678000
*       ELSE                                                       0687 01679000
*         DO;                       /* IT'S A BLOCK OF DATA  @Z40GKTQ*/ 01680000
         B     @RC00680                                            0687 01681000
@RF00680 DS    0H                                                  0688 01682000
*           TEXTADDR=LINEADDR+2;    /* POINT INPUT PARAMETER TO START   01683000
*                                      OF TEXT               @Z40GKTQ*/ 01684000
         L     @10,WORKAREA(,PARMSAVE)                             0688 01685000
         L     @15,LINEADDR(,@10)                                  0688 01686000
         LA    @14,2                                               0688 01687000
         ALR   @14,@15                                             0688 01688000
         ST    @14,TEXTADDR(,@10)                                  0688 01689000
*           TEXTLN=BLKCNT;          /* SIZE PARAMETER        @Z40GKTQ*/ 01690000
         SLR   @09,@09                                             0689 01691000
         IC    @09,BLKCNT(,@15)                                    0689 01692000
         ST    @09,TEXTLN(,@10)                                    0689 01693000
*           LINEADDR=LINEADDR+2+BLKCNT;/* UPDATE LINEADDR HERE,    0690 01694000
*                                      BECAUSE AMDTPRTX DOESN'T DO 0690 01695000
*                                      IT.                   @Z40GKTQ*/ 01696000
         ALR   @14,@09                                             0690 01697000
         ST    @14,LINEADDR(,@10)                                  0690 01698000
*         END;                      /*                       @Z40GKTQ*/ 01699000
*     END;                          /* END OF 'INFO LEFT IN RECORD'     01700000
*                                      GRP                           */ 01701000
@RC00680 DS    0H                                                  0693 01702000
*   IF NEXTLINE=ADDR(AMDLNE02)      /* IF IT IS A STATUS BLOCK     0693 01703000
*                                                            @Z40GKTQ*/ 01704000
*       |RETCODE=IGNORE             /* OR END OF RECORD      @Z40GKTQ*/ 01705000
*     THEN                                                         0693 01706000
@RC00677 L     @10,WORKAREA(,PARMSAVE)                             0693 01707000
         LA    @15,AMDLNE02                                        0693 01708000
         C     @15,NEXTLINE(,@10)                                  0693 01709000
         BE    @RT00693                                            0693 01710000
         CLC   RETCODE(4,@10),@CF00060                             0693 01711000
         BE    @RT00693                                            0693 01712000
*     GOTO AMDEXIT;                 /* THEN EXIT IT CALLER   @Z40GKTQ*/ 01713000
*   ELSE                                                           0695 01714000
*     GOTO AMDTPRTX;                /* OTHERWISE FORMAT DATA @Z40GKTQ*/ 01715000
         B     AMDTPRTX                                            0695 01716000
*AMDLNE02:                          /*                       @Z40GKTQ*/ 01717000
*                                                                  0696 01718000
*   /*****************************************************************/ 01719000
*   /*                                                               */ 01720000
*   /* THIS SUBROUTINE IS INVOKED TO EDIT FORMAT 2 STATUS BLOCKS. THE*/ 01721000
*   /* SUBROUTINE HEXFRMT DOES THE ACTUAL FORMATTING-AMDLNE02 SETS UP*/ 01722000
*   /* THE CALL, MOVES ONE BYTE OF INFORMATION NOT MOVED BY HEXFRMT, */ 01723000
*   /* AND THEN SETS UP THE NEXT CALL TO AMDUSRFD.           @Z40GKTQ*/ 01724000
*   /*                                                               */ 01725000
*   /*****************************************************************/ 01726000
*                                                                  0696 01727000
*/* SET UP AND CALL HEXFRMT SUBROUTINE TO DO THE FORMATTING  @Z40GKTQ*/ 01728000
*                                                                  0696 01729000
*   DATASTRT=LINEADDR;              /* HEXFRMT USES THIS AS THE PTR     01730000
*                                      TO STATUS BYTES TO BE HANDLED.   01731000
*                                                            @Z40GKTQ*/ 01732000
AMDLNE02 L     @10,WORKAREA(,PARMSAVE)                             0696 01733000
         L     DATASTRT,LINEADDR(,@10)                             0696 01734000
*   HEXPARM=ADDR(LNHEX2E);          /* POINT TO HEXFRMT PLIST      0697 01735000
*                                                            @Z40GKTQ*/ 01736000
         LA    HEXPARM,LNHEX2E                                     0697 01737000
*   CALL HEXFRMT;                   /* DO IT                 @Z40GKTQ*/ 01738000
         BAL   @14,HEXFRMT                                         0698 01739000
*   TEMPCNT=TEMPCNT-8;              /* WE PROCESSED 8 BYTES, SO DECR    01740000
*                                      THE COUNT             @Z40GKTQ*/ 01741000
         L     @10,WORKAREA(,PARMSAVE)                             0699 01742000
         LA    @15,8                                               0699 01743000
         SLR   @14,@14                                             0699 01744000
         IC    @14,TEMPCNT(,@10)                                   0699 01745000
         SLR   @14,@15                                             0699 01746000
         STC   @14,TEMPCNT(,@10)                                   0699 01747000
*   LINEADDR=LINEADDR+8;            /* AND INCREMENT THE PTR @Z40GKTQ*/ 01748000
         AL    @15,LINEADDR(,@10)                                  0700 01749000
         ST    @15,LINEADDR(,@10)                                  0700 01750000
*   LNSPCF=LNSLCD(2);               /* HEXFMT LEFT THE PCF BYTE    0701 01751000
*                                      APPENDED TO THE LCD BYTE    0701 01752000
*                                                            @Z40GKTQ*/ 01753000
         MVC   LNSPCF(1,BUFFPTR),LNSLCD+1(BUFFPTR)                 0701 01754000
*   LNSLCD(2)=' ';                  /* BLANK OUT THE 2ND BYTE      0702 01755000
*                                                            @Z40GKTQ*/ 01756000
         MVI   LNSLCD+1(BUFFPTR),C' '                              0702 01757000
*   IF TEMPCNT>0                    /* TEMPCNT IS THE RUNNING COUNT     01758000
*                                      OF STATUS BYTES WITHIN THE  0703 01759000
*                                      CURRENT INFORMATION BLOCK   0703 01760000
*                                                            @Z40GKTQ*/ 01761000
*     THEN                                                         0703 01762000
         CLI   TEMPCNT(@10),0                                      0703 01763000
         BNH   @RF00703                                            0703 01764000
*     DO;                           /* IF THERE ARE ANY LEFT @Z40GKTQ*/ 01765000
*       RETCODE=CONTINUE;           /* THEN SET UP NEXT LINE @Z40GKTQ*/ 01766000
         SLR   @15,@15                                             0705 01767000
         ST    @15,RETCODE(,@10)                                   0705 01768000
*       NEXTLINE=ADDR(AMDLNE02);    /* TO BE DONE BY AMDLNE02@Z40GKTQ*/ 01769000
         LA    @15,AMDLNE02                                        0706 01770000
         ST    @15,NEXTLINE(,@10)                                  0706 01771000
*     END;                          /*                       @Z40GKTQ*/ 01772000
*   ELSE                                                           0708 01773000
*     DO;                           /* NO MORE STATUS BYTES IN THIS     01774000
*                                      PARTICULAR BLOCK      @Z40GKTQ*/ 01775000
         B     @RC00703                                            0708 01776000
@RF00703 DS    0H                                                  0709 01777000
*       IF LINEADDR>=TRFPTR         /* IS THERE ANOTHER BLOCK WITHIN    01778000
*                                      THIS GTF RECORD?      @Z40GKTQ*/ 01779000
*         THEN                      /* NO-                   @Z40GKTQ*/ 01780000
         L     @10,WORKAREA(,PARMSAVE)                             0709 01781000
         CLC   LINEADDR(4,@10),TRFPTR(@10)                         0709 01782000
         BL    @RF00709                                            0709 01783000
*         RETCODE=GETNEXT;          /* PRINT LINE, GET NEXT RECORD 0710 01784000
*                                                            @Z40GKTQ*/ 01785000
         MVC   RETCODE(4,@10),@CF00036                             0710 01786000
*       ELSE                        /* YES-                  @Z40GKTQ*/ 01787000
*         IF BLKTYPE=ON             /* IS IT DATA?           @Z40GKTQ*/ 01788000
*           THEN                                                   0711 01789000
         B     @RC00709                                            0711 01790000
@RF00709 L     @10,WORKAREA(,PARMSAVE)                             0711 01791000
         L     @15,LINEADDR(,@10)                                  0711 01792000
         TM    BLKTYPE(@15),B'10000000'                            0711 01793000
         BNO   @RF00711                                            0711 01794000
*           DO;                     /* YES-                  @Z40GKTQ*/ 01795000
*             NEXTLINE=ADDR(AMDLNE01);/* SET UP INVOCATION   @Z40GKTQ*/ 01796000
         LA    @15,AMDLNE01                                        0713 01797000
         ST    @15,NEXTLINE(,@10)                                  0713 01798000
*             RETCODE=CONTINUE;     /* TO PROCESS IT AFTER PRINTING     01799000
*                                      THIS LINE.            @Z40GKTQ*/ 01800000
         SLR   @15,@15                                             0714 01801000
         ST    @15,RETCODE(,@10)                                   0714 01802000
*           END;                    /*                       @Z40GKTQ*/ 01803000
*         ELSE                                                     0716 01804000
*           DO;                     /* NEXT BLK HAS STATUS   @Z40GKTQ*/ 01805000
         B     @RC00711                                            0716 01806000
@RF00711 DS    0H                                                  0717 01807000
*             TEMPCNT=BLKCNT;       /* GET BYTE COUNT FROM THAT BLOCK   01808000
*                                                            @Z40GKTQ*/ 01809000
         L     @10,WORKAREA(,PARMSAVE)                             0717 01810000
         L     @15,LINEADDR(,@10)                                  0717 01811000
         IC    @14,BLKCNT(,@15)                                    0717 01812000
         STC   @14,TEMPCNT(,@10)                                   0717 01813000
*             LINEADDR=LINEADDR+2;  /* POINT PAST 2-BYTE HDR @Z40GKTQ*/ 01814000
         AL    @15,@CF00042                                        0718 01815000
         ST    @15,LINEADDR(,@10)                                  0718 01816000
*             NEXTLINE=ADDR(AMDLNE02);/* SET NEXT PROCESSOR  @Z40GKTQ*/ 01817000
         LA    @15,AMDLNE02                                        0719 01818000
         ST    @15,NEXTLINE(,@10)                                  0719 01819000
*             RETCODE=CONTINUE;     /* PRINT LINE, CONTINUE        0720 01820000
*                                      PROCESSING THIS RECORD      0720 01821000
*                                                            @Z40GKTQ*/ 01822000
         SLR   @15,@15                                             0720 01823000
         ST    @15,RETCODE(,@10)                                   0720 01824000
*           END;                    /* END STATUS PROCESSING @Z40GKTQ*/ 01825000
*     END;                          /* END 'NO MORE STATUS BYTES IN     01826000
*                                      THIS BLOCK' LEG       @Z40GKTQ*/ 01827000
*   GO TO AMDEXIT;                  /* RETURN TO CALLING EDIT ROUTINE   01828000
*                                                            @Z40GKTQ*/ 01829000
*                                                                  0723 01830000
         B     AMDEXIT                                             0723 01831000
*   /*****************************************************************/ 01832000
*   /*                                                               */ 01833000
*   /* SUBROUTINES                                                   */ 01834000
*   /*                                                               */ 01835000
*   /*****************************************************************/ 01836000
*                                                                  0724 01837000
*FRMTEXT:                                                          0724 01838000
*   PROC;                                                          0724 01839000
*                                                                  0724 01840000
FRMTEXT  STM   @14,@12,@SA00002                                    0724 01841000
*   /*****************************************************************/ 01842000
*   /*                                                               */ 01843000
*   /* THIS SUBROUTINE IS CALLED TO FORMAT THE TEXT PORTION OF       */ 01844000
*   /* CONTROL LAYER AND TPIOS RECORDS. ITS OUTPUT INCLUDES THE      */ 01845000
*   /* PRINTABLE HEX PORTION(FOR WHICH SUBROUTINE HEXFRMT IS CALLED) */ 01846000
*   /* AND THE EBCDIC TRANSLATION PORTION. ON ENTRY, TEXTLN CONTAINS */ 01847000
*   /* THE LENGTH OF THE TEXT WHICH NEEDS TO BE FORMATTED, AND       */ 01848000
*   /* TEXTADDR CONTAINS THE BEGINNING ADDRESS OF THIS TEXT. BOTH OF */ 01849000
*   /* THESE VARIABLES ARE UPDATED BY THIS SUBROUTINE AND REFLECT    */ 01850000
*   /* UPDATED VALUES UPON RETURN FROM THIS ROUTINE. FIRST, IT MUST  */ 01851000
*   /* BE DETERMINED WHETHER TEXT IS AVAILABLE TO BE FORMATTED       */ 01852000
*   /*                                                               */ 01853000
*   /*****************************************************************/ 01854000
*                                                                  0725 01855000
*   IF CONFTEXT='1'B THEN                                          0725 01856000
         L     @10,WORKAREA(,PARMSAVE)                             0725 01857000
         TM    CONFTEXT(@10),B'10000000'                           0725 01858000
         BO    @RT00725                                            0725 01859000
*     RETURN;                       /* IF THIS FLAG IS SET, IT HAS 0726 01860000
*                                      ALREADY BEEN DETERMINED THAT     01861000
*                                      THE TEXT IS CONFIDENTIAL AND     01862000
*                                      NOTHING NEEDS TO BE DONE ON 0726 01863000
*                                      THIS CALL                     */ 01864000
*                                                                  0726 01865000
*   /*****************************************************************/ 01866000
*   /*                                                               */ 01867000
*   /* DETERMINATION OF CONFIDENTIALITY MUST BE MADE. THE INDICATING */ 01868000
*   /* FLAG IS IN THE INPUT RECORD BUT IS IN DIFFERENT LOCATIONS FOR */ 01869000
*   /* TPIOS AND CONTROL LAYER RECORDS                               */ 01870000
*   /*                                                               */ 01871000
*   /*****************************************************************/ 01872000
*                                                                  0727 01873000
*   IF INPUTEID=ISTCLEID THEN                                      0727 01874000
         L     @15,EIDADDR(,PARMSAVE)                              0727 01875000
         CLC   INPUTEID(2,@15),@CH00592                            0727 01876000
         BNE   @RF00727                                            0727 01877000
*     DO;                           /* FOR CONTROL LAYER, IT IS IN 0728 01878000
*                                      ISTTRAC, AT THE FRONT OF THE     01879000
*                                      INPUT                         */ 01880000
*       RFY                                                        0729 01881000
*         ISTTRAC BASED(DATAADDR);                                 0729 01882000
*       IF TRACXTF='1'B THEN                                       0730 01883000
         L     @15,DATAADDR(,PARMSAVE)                             0730 01884000
         TM    TRACXTF(@15),B'00100000'                            0730 01885000
         BNO   @RF00730                                            0730 01886000
*         CONFTEXT='1'B;            /* SET THE INTERNAL FLAG IF    0731 01887000
*                                      INDICATED                     */ 01888000
         OI    CONFTEXT(@10),B'10000000'                           0731 01889000
*     END;                          /* END OF C/L PATH               */ 01890000
*   ELSE                                                           0733 01891000
*     DO;                           /* FOR TPIOS, BIT TO CHECK IS IN    01892000
*                                      ISTTRF, AT THE END            */ 01893000
         B     @RC00727                                            0733 01894000
@RF00727 DS    0H                                                  0734 01895000
*       TRFPTR=DATAADDR+(DATALNG-LENGTH(ISTTRF));/* FIND ISTTRF      */ 01896000
         L     @10,WORKAREA(,PARMSAVE)                             0734 01897000
         L     @15,DATALNG(,@10)                                   0734 01898000
         SL    @15,@CF02414                                        0734 01899000
         AL    @15,DATAADDR(,PARMSAVE)                             0734 01900000
         ST    @15,TRFPTR(,@10)                                    0734 01901000
*       RFY                                                        0735 01902000
*         ISTTRF BASED(TRFPTR);                                    0735 01903000
*       IF TRFCXTF='1'B THEN                                       0736 01904000
         TM    TRFCXTF(@15),B'00100000'                            0736 01905000
         BNO   @RF00736                                            0736 01906000
*         CONFTEXT='1'B;            /* INDICATE INTERNALLY IF      0737 01907000
*                                      INDICATED EXTERNALLY          */ 01908000
         OI    CONFTEXT(@10),B'10000000'                           0737 01909000
*     END;                          /* END OF TPIOS PATH             */ 01910000
*                                                                  0738 01911000
@RF00736 DS    0H                                                  0739 01912000
*   /*****************************************************************/ 01913000
*   /*                                                               */ 01914000
*   /* NOW IF CONFTEXT IS ON, IT WAS JUST SET AND IT MUST BE         */ 01915000
*   /* INDICATED IN THE OUTPUT BUFFER THAT CONFIDENTIAL TEXT WAS     */ 01916000
*   /* FOUND                                                         */ 01917000
*   /*                                                               */ 01918000
*   /*****************************************************************/ 01919000
*                                                                  0739 01920000
*   IF CONFTEXT='1'B THEN                                          0739 01921000
@RC00727 L     @10,WORKAREA(,PARMSAVE)                             0739 01922000
         TM    CONFTEXT(@10),B'10000000'                           0739 01923000
         BNO   @RF00739                                            0739 01924000
*     DO;                                                          0740 01925000
*       TEXTHEX=CONFMSG;            /* MOVE CONFIDENTIAL MESSAGE TO     01926000
*                                      BUFFER                        */ 01927000
         MVI   TEXTHEX+27(BUFFPTR),C' '                            0741 01928000
         MVC   TEXTHEX+28(16,BUFFPTR),TEXTHEX+27(BUFFPTR)          0741 01929000
         MVC   TEXTHEX(27,BUFFPTR),CONFMSG                         0741 01930000
*       TEXTLN=0;                   /* INDICATE NO MORE TEXT TO BE 0742 01931000
*                                      FORMATTED                     */ 01932000
         SLR   @15,@15                                             0742 01933000
         ST    @15,TEXTLN(,@10)                                    0742 01934000
*       RETURN;                     /* RETURN - SUBROUTINES FUNCTION    01935000
*                                      IS COMPLETE                   */ 01936000
@EL00002 DS    0H                                                  0743 01937000
@EF00002 DS    0H                                                  0743 01938000
@ER00002 LM    @14,@12,@SA00002                                    0743 01939000
         BR    @14                                                 0743 01940000
*     END;                          /* END OF CONFIDENTIAL TEXT PATH */ 01941000
*   IF TEXTLN=0 THEN                                               0745 01942000
@RF00739 L     @10,WORKAREA(,PARMSAVE)                             0745 01943000
         L     @15,TEXTLN(,@10)                                    0745 01944000
         LTR   @15,@15                                             0745 01945000
         BZ    @RT00745                                            0745 01946000
*     RETURN;                       /* IF TEXT IS NOT CONFIDENTIAL,     01947000
*                                      FIND OUT IF ALL PROCESSING OF    01948000
*                                      IT WAS ALREADY COMPLETED. IF     01949000
*                                      IT WAS, RETURN FROM SUBROUTINE*/ 01950000
*                                                                  0746 01951000
*   /*****************************************************************/ 01952000
*   /*                                                               */ 01953000
*   /* THERE IS TEXT TO BE FORMATTED. SET UP FOR AND CALL SUBROUTINE */ 01954000
*   /* HEXFRMT TO CONVERT 20 BYTES OF TEXT TO PRINTABLE HEX          */ 01955000
*   /*                                                               */ 01956000
*   /*****************************************************************/ 01957000
*                                                                  0747 01958000
*   DATASTRT=TEXTADDR;              /* POINT TO NEXT TEXT BYTE TO BE    01959000
*                                      FORMATTED                     */ 01960000
         L     DATASTRT,TEXTADDR(,@10)                             0747 01961000
*   HEXPARM=ADDR(TXTHEX1);          /* POINT TO PLIST                */ 01962000
         LA    HEXPARM,TXTHEX1                                     0748 01963000
*   CALL HEXFRMT;                                                  0749 01964000
*                                                                  0749 01965000
         BAL   @14,HEXFRMT                                         0749 01966000
*   /*****************************************************************/ 01967000
*   /*                                                               */ 01968000
*   /* CONVERT THE SAME 20 BYTES TO TRANSLATED EBCDIC. UNPRINTABLE   */ 01969000
*   /* CHARACTERS WILL APPEAR AS PERIODS(.)                          */ 01970000
*   /*                                                               */ 01971000
*   /*****************************************************************/ 01972000
*                                                                  0750 01973000
*   TEXTAST1='*';                   /* MOVE IN FIRST DELIMETER       */ 01974000
         MVI   TEXTAST1(BUFFPTR),C'*'                              0750 01975000
*   TEXTAST2='*';                   /* DELIMIT THE END               */ 01976000
         MVI   TEXTAST2(BUFFPTR),C'*'                              0751 01977000
*   TEXTEBCD=TEXTDATA;              /* MOVE TEXT TO THE OUTPUT BUFFER*/ 01978000
         L     @10,WORKAREA(,PARMSAVE)                             0752 01979000
         L     @15,TEXTADDR(,@10)                                  0752 01980000
         MVC   TEXTEBCD(20,BUFFPTR),TEXTDATA(@15)                  0752 01981000
*   TR(TEXTEBCD,EBCDCTAB);          /* TRANSLATE THE DATA            */ 01982000
*                                                                  0753 01983000
         TR    TEXTEBCD(20,BUFFPTR),EBCDCTAB                       0753 01984000
*   /*****************************************************************/ 01985000
*   /*                                                               */ 01986000
*   /* CALCULATE THE AMOUNT OF TEXT YET TO BE FORMATTED. IF TEXTLN   */ 01987000
*   /* BECOMES NEGATIVE, MORE TEXT THAN WAS NECESSARY WAS FORMATTED  */ 01988000
*   /* AND MUST BE BLANKED OUT.                                      */ 01989000
*   /*                                                               */ 01990000
*   /*****************************************************************/ 01991000
*                                                                  0754 01992000
*   TEXTLN=TEXTLN-LENGTH(TEXTEBCD); /* SUBTRACT OFF TEXT JUST      0754 01993000
*                                      FORMATTED                     */ 01994000
         LA    @15,20                                              0754 01995000
         L     @14,TEXTLN(,@10)                                    0754 01996000
         SLR   @14,@15                                             0754 01997000
         ST    @14,TEXTLN(,@10)                                    0754 01998000
*   IF TEXTLN<0 THEN                                               0755 01999000
         SLR   @09,@09                                             0755 02000000
         CR    @14,@09                                             0755 02001000
         BNL   @RF00755                                            0755 02002000
*     DO;                                                          0756 02003000
*       EXCESS=ABS(TEXTLN);         /* CALCULATE NUMBER OF EXCESS  0757 02004000
*                                      BYTES TO BLANK                */ 02005000
         LPR   @14,@14                                             0757 02006000
         LR    EXCESS,@14                                          0757 02007000
*       XTRAHEXL=(EXCESS*2)+(EXCESS/4);/* AMOUNT TO BLANK IN BUFFER     02008000
*                                      IS NUMBER OF PRINTABLE HEX  0758 02009000
*                                      BYTES PLUS NUMBER OF        0758 02010000
*                                      INTERVENING BLANKS            */ 02011000
         LR    XTRAHEXL,EXCESS                                     0758 02012000
         ALR   XTRAHEXL,XTRAHEXL                                   0758 02013000
         LR    @07,EXCESS                                          0758 02014000
         SRL   @07,2                                               0758 02015000
         ALR   XTRAHEXL,@07                                        0758 02016000
*       HEXADDR=ADDR(TEXTHEX)+(LENGTH(TEXTHEX)-XTRAHEXL);/* FIND   0759 02017000
*                                      FIRST BYTE THAT NEEDS BLANKING*/ 02018000
         LA    HEXADDR,TEXTHEX(,BUFFPTR)                           0759 02019000
         LA    @07,44                                              0759 02020000
         SLR   @07,XTRAHEXL                                        0759 02021000
         ALR   HEXADDR,@07                                         0759 02022000
*       XTRAHEX(1:XTRAHEXL)=BLANKS; /* BLANK OUT EXCESS PRINTABLE HEX*/ 02023000
         LR    @07,XTRAHEXL                                        0760 02024000
         BCTR  @07,0                                               0760 02025000
         EX    @07,@SM02416                                        0760 02026000
*       EBCDADDR=ADDR(TEXTEBCD)+(LENGTH(TEXTEBCD)-EXCESS);/* FIND  0761 02027000
*                                      BEGINNING OF EBCDIC NEEDED TO    02028000
*                                      BE BLANKED                    */ 02029000
         LA    EBCDADDR,TEXTEBCD(,BUFFPTR)                         0761 02030000
         SLR   @15,EXCESS                                          0761 02031000
         ALR   EBCDADDR,@15                                        0761 02032000
*       XTRAEBCD(1:EXCESS)=BLANKS;  /* BLANK OUT THE EBCDIC PORTION  */ 02033000
         LR    @08,EXCESS                                          0762 02034000
         BCTR  @08,0                                               0762 02035000
         EX    @08,@SM02418                                        0762 02036000
*       TEXTLN=0;                   /* INDICATE NO MORE TEXT         */ 02037000
         ST    @09,TEXTLN(,@10)                                    0763 02038000
*       RETURN;                     /* RETURN TO CALLER              */ 02039000
         B     @EL00002                                            0764 02040000
*     END;                          /* END OF EXCESS TEXT PATH       */ 02041000
*   TEXTADDR=TEXTADDR+LENGTH(TEXTEBCD);/* BUMP TO NEXT TEXT BYTE TO     02042000
*                                      BE FORMATTED                  */ 02043000
@RF00755 L     @10,WORKAREA(,PARMSAVE)                             0766 02044000
         LA    @15,20                                              0766 02045000
         AL    @15,TEXTADDR(,@10)                                  0766 02046000
         ST    @15,TEXTADDR(,@10)                                  0766 02047000
*   RETURN;                                                        0767 02048000
         B     @EL00002                                            0767 02049000
*   END FRMTEXT;                                                   0768 02050000
         B     @EL00002                                            0768 02051000
*HEXFRMT:                                                          0769 02052000
*   PROC;                                                          0769 02053000
*                                                                  0769 02054000
HEXFRMT  STM   @14,@12,12(@13)                                     0769 02055000
*   /*****************************************************************/ 02056000
*   /*                                                               */ 02057000
*   /* THIS SUBROUTINE IS CALLED TO CONVERT HEX DATA INTO PRINTABLE  */ 02058000
*   /* HEX, INTO SPECIFIED COLUMNS IN THE OUTPUT BUFFER. ON ENTRY,   */ 02059000
*   /* REGISTER ZERO POINTS TO THE START OF A HEX DATA STRING TO BE  */ 02060000
*   /* CONVERTED. REGISTER ONE ON ENTRY CONTAINS THE ADDRESS OF A    */ 02061000
*   /* PARAMETER LIST. THE PARAMETER LIST CONSISTS OF 4-BYTE ENTRIES,*/ 02062000
*   /* AS FOLLOWS: BYTE 0 CONTAINS A FLAG BYTE; THE HI BIT, IF ON,   */ 02063000
*   /* INDICATES THAT THIS ENTRY IS THE LAST ONE. IF OFF, ANOTHER    */ 02064000
*   /* ENTRY IS CONTIGUOUS TO THIS 4-BYTE ENTRY. BYTE 1 CONTAINS THE */ 02065000
*   /* COLUMN INTO WHICH THE DATA IS TO BE CONVERTED. (THIS IS THE   */ 02066000
*   /* OFFSET + 1 FROM THE BEGINNING OF THE BUFFER.) BYTES 2-3       */ 02067000
*   /* CONTAIN THE LENGTH OF THE DATA STRING TO BE CONVERTED. IF     */ 02068000
*   /* LONGER THAN 4 BYTES, AN INTERVENING BLANK WILL BE INSERTED    */ 02069000
*   /* EVERY 4 BYTES IN THE OUTPUT                                   */ 02070000
*   /*                                                               */ 02071000
*   /*****************************************************************/ 02072000
*                                                                  0770 02073000
*   RFY                                                            0770 02074000
*    (HEXDPTR,                                                     0770 02075000
*     HEXBUFFR,                                                    0770 02076000
*     HEXLNG,                                                      0770 02077000
*     ENTRYPTR) RSTD;                                              0770 02078000
*   HEXDPTR=DATASTRT;               /* MOVE BEGINNING DATA ADDRESS TO   02079000
*                                      WORKING REGISTER              */ 02080000
         LR    HEXDPTR,DATASTRT                                    0771 02081000
*   ENTRYPTR=HEXPARM;               /* ESTABLISH PTR TO FIRST PLIST     02082000
*                                      ENTRY                         */ 02083000
         LR    ENTRYPTR,HEXPARM                                    0772 02084000
*AMDHEX01:                                                         0773 02085000
*   HEXBUFFR=BUFFPTR+(HEXCOLUM-1);  /* CALCULATE ADDRESS IN BUFFER 0773 02086000
*                                      INTO WHICH DATA IS TO BE    0773 02087000
*                                      FORMATTED                     */ 02088000
AMDHEX01 SLR   HEXBUFFR,HEXBUFFR                                   0773 02089000
         IC    HEXBUFFR,HEXCOLUM(,ENTRYPTR)                        0773 02090000
         BCTR  HEXBUFFR,0                                          0773 02091000
         ALR   HEXBUFFR,BUFFPTR                                    0773 02092000
*   HEXLNG=HEXLNGTH;                /* PICK UP AMOUNT TO BE CONVERTED*/ 02093000
         ICM   HEXLNG,12,HEXLNGTH(ENTRYPTR)                        0774 02094000
         SRA   HEXLNG,16                                           0774 02095000
*AMDHEX02:                                                         0775 02096000
*   UNPK(HEXWORK,HEXDATA);          /* CONVERT FOUR BYTES INTO WORK     02097000
*                                      AREA                          */ 02098000
AMDHEX02 L     @10,WORKAREA(,PARMSAVE)                             0775 02099000
         UNPK  HEXWORK(9,@10),HEXDATA(5,HEXDPTR)                   0775 02100000
*   TR(HEXWORK(1:8),HEXTABL);       /* TRANSLATE THE 8 BYTE UNPKED 0776 02101000
*                                      RESULT                @Z40GKTQ*/ 02102000
         LA    @15,HEXTAB                                          0776 02103000
         AL    @15,@CF02420                                        0776 02104000
         TR    HEXWORK(8,@10),HEXTABL(@15)                         0776 02105000
*   IF HEXLNG<=4 THEN                                              0777 02106000
         LA    @15,4                                               0777 02107000
         CR    HEXLNG,@15                                          0777 02108000
         BH    @RF00777                                            0777 02109000
*     DO;                           /* FOR SHORT DATA, MOVE ONLY   0778 02110000
*                                      WHATS NEEDED                  */ 02111000
*       PRINTHEX(1:HEXLNG*2)=HEXWORK;/* MOVE BYTES TO BUFFER         */ 02112000
         LR    @14,HEXLNG                                          0779 02113000
         ALR   @14,@14                                             0779 02114000
         BCTR  @14,0                                               0779 02115000
         EX    @14,@SM02421                                        0779 02116000
*       IF LASTENTY='1'B THEN                                      0780 02117000
         TM    LASTENTY(ENTRYPTR),B'10000000'                      0780 02118000
         BO    @RT00780                                            0780 02119000
*         RETURN;                   /* IF THIS IS THE LAST PLIST   0781 02120000
*                                      ENTRY THEN ALL IS DONE        */ 02121000
*       HEXDPTR=HEXDPTR+HEXLNG;     /* OTHERWISE, SET UP FOR NEXT  0782 02122000
*                                      PLIST ENTRY BY BUMPING DATA 0782 02123000
*                                      PTR PAST DATA JUST FORMATTED  */ 02124000
         ALR   HEXDPTR,HEXLNG                                      0782 02125000
*       ENTRYPTR=ENTRYPTR+LENGTH(HEXPLIST);/* POINT TO NEXT ENTRY IN    02126000
*                                      PLIST                         */ 02127000
         ALR   ENTRYPTR,@15                                        0783 02128000
*       GO TO AMDHEX01;             /* LOOP BAK TO PROCESS THIS ENTRY*/ 02129000
         B     AMDHEX01                                            0784 02130000
*     END;                          /* END OF SHORT DATA PATH        */ 02131000
*   PRINTHEX=HEXWORK;               /* FOR DATA GREATER THAN 4 BYTES,   02132000
*                                      MOVE IN THE 8 BYTES JUST    0786 02133000
*                                      CONVERTED                     */ 02134000
@RF00777 L     @10,WORKAREA(,PARMSAVE)                             0786 02135000
         MVC   PRINTHEX(8,HEXBUFFR),HEXWORK(@10)                   0786 02136000
*   HEXLNG=HEXLNG-4;                /* SUBTRACT OFF LENGTH JUST    0787 02137000
*                                      CONVERTED                     */ 02138000
         LA    @10,4                                               0787 02139000
         SLR   HEXLNG,@10                                          0787 02140000
*   HEXDPTR=HEXDPTR+4;              /* BUMP DATA PTR PAST DATA     0788 02141000
*                                      FORMATTED                     */ 02142000
         ALR   HEXDPTR,@10                                         0788 02143000
*   HEXBUFFR=HEXBUFFR+9;            /* BUMP BUFFER PTR PAST 8 DATA 0789 02144000
*                                      BYTES, AND ONE BLANK          */ 02145000
         AL    HEXBUFFR,@CF01420                                   0789 02146000
*   GO TO AMDHEX02;                 /* LOOP TO GET REST              */ 02147000
         B     AMDHEX02                                            0790 02148000
*   RFY                                                            0791 02149000
*    (HEXDPTR,                                                     0791 02150000
*     HEXBUFFR,                                                    0791 02151000
*     HEXLNG,                                                      0791 02152000
*     ENTRYPTR) UNRSTD;                                            0791 02153000
*   END HEXFRMT;                                                   0792 02154000
@EL00003 DS    0H                                                  0792 02155000
@EF00003 DS    0H                                                  0792 02156000
@ER00003 LM    @14,@12,12(@13)                                     0792 02157000
         BR    @14                                                 0792 02158000
*   END AMDUSRFD                                                   0793 02159000
*                                                                  0793 02160000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 02161000
*/*%INCLUDE SYSUT5  (PLOG    )                                       */ 02162000
*/*%INCLUDE SYSUT5  (DCLS    )                                       */ 02163000
*/*%INCLUDE SYSLIB  (IHASRB  )                                       */ 02164000
*/*%INCLUDE SYSLIB  (ISTTRF  )                                       */ 02165000
*/*%INCLUDE SYSLIB  (IMDMEDIT)                                       */ 02166000
*/*%INCLUDE SYSLIB  (ISTZLBUF)                                       */ 02167000
*/*%INCLUDE SYSLIB  (ISTTRAC )                                       */ 02168000
*/*%INCLUDE SYSUT5  (SMSDCLS )                                       */ 02169000
*/*%INCLUDE SYSUT5  (COMMINIT)                                       */ 02170000
*/*%INCLUDE SYSUT5  (NEWINIT )                                       */ 02171000
*/*%INCLUDE SYSUT5  (AMDSMS00)                                       */ 02172000
*/*%INCLUDE SYSUT5  (AMDCLTR1)                                       */ 02173000
*/*%INCLUDE SYSUT5  (AMDTPTR1)                                       */ 02174000
*/*%INCLUDE SYSUT5  (AMDLNTR1)                                       */ 02175000
*/*%INCLUDE SYSUT5  (AMDEXIT )                                       */ 02176000
*/*%INCLUDE SYSUT5  (AMDCLTR2)                                       */ 02177000
*/*%INCLUDE SYSUT5  (AMDTPLOC)                                       */ 02178000
*/*%INCLUDE SYSUT5  (AMDTPLI1)                                       */ 02179000
*/*%INCLUDE SYSUT5  (AMDTPLI2)                                       */ 02180000
*/*%INCLUDE SYSUT5  (AMDTPRI1)                                       */ 02181000
*/*%INCLUDE SYSUT5  (AMDTPRI2)                                       */ 02182000
*/*%INCLUDE SYSUT5  (AMDTPRO1)                                       */ 02183000
*/*%INCLUDE SYSUT5  (AMDTPRTX)                                       */ 02184000
*/*%INCLUDE SYSUT5  (AMDTXTLN)                                       */ 02185000
*/*%INCLUDE SYSUT5  (AMDLNTR2)                                       */ 02186000
*/*%INCLUDE SYSUT5  (AMDSMS01)                                       */ 02187000
*/*%INCLUDE SYSUT5  (AMDSMS02)                                       */ 02188000
*/*%INCLUDE SYSUT5  (AMDSMS03)                                       */ 02189000
*/*%INCLUDE SYSUT5  (AMDLNE01)                                       */ 02190000
*/*%INCLUDE SYSUT5  (AMDLNE02)                                       */ 02191000
*/*%INCLUDE SYSUT5  (FRMTEXT )                                       */ 02192000
*/*%INCLUDE SYSUT5  (HEXFRMT )                                       */ 02193000
*                                                                  0793 02194000
*       ;                                                          0793 02195000
@DATA    DS    0H                                                       02196000
@CH00590 DC    XL2'EFF2'                                                02197000
@CH00592 DC    XL2'EFF1'                                                02198000
@CH00594 DC    XL2'EFF0'                                                02199000
@CH00596 DC    XL2'EFEF'                                                02200000
@SM02416 MVC   XTRAHEX(0,HEXADDR),BLANKS                                02201000
@SM02418 MVC   XTRAEBCD(0,EBCDADDR),BLANKS                              02202000
@SM02421 MVC   PRINTHEX(0,HEXBUFFR),HEXWORK(@10)                        02203000
@DATD    DSECT                                                          02204000
         DS    0F                                                       02205000
@SA00001 DS    18F                                                      02206000
@SA00002 DS    15F                                                      02207000
AMDUSRFD CSECT                                                          02208000
         DS    0F                                                       02209000
@CF00042 DC    F'2'                                                     02210000
@CF00036 DC    F'4'                                                     02211000
@CF00060 DC    F'8'                                                     02212000
@CF01420 DC    F'9'                                                     02213000
@CF02414 DC    F'17'                                                    02214000
@CF02420 DC    F'-240'                                                  02215000
@DATD    DSECT                                                          02216000
         DS    0D                                                       02217000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                02218000
@ENDDATD EQU   *                                                        02219000
AMDUSRFD CSECT                                                          02220000
         DS    0F                                                       02221000
@SIZDATD DC    AL1(0)                                                   02222000
         DC    AL3(@ENDDATD-@DATD)                                      02223000
         DS    0D                                                       02224000
SLOWDOWN DC    XL1'03'                                                  02225000
ANODELAB DC    CL5'ANODE'                                               02226000
TEXTLAB  DC    CL4'TEXT'                                                02227000
DNODELAB DC    CL5'DNODE'                                               02228000
INBOUND  DC    CL2'IN'                                                  02229000
OUTBOUND DC    CL3'OUT'                                                 02230000
CONFMSG  DC    CL27'CONFIDENTIAL AND SUPPRESSED'                        02231000
BLANKS   DC    CL43' '                                                  02232000
CTLAYER  DC    CL3'C/L'                                                 02233000
TPLAB    DC    CL5'TPIOS'                                               02234000
FDBLAB   DC    CL3'FDB'                                                 02235000
RSVDLAB  DC    CL4'RSVD'                                                02236000
FSBLAB   DC    CL4'FSB'                                                 02237000
THRHLAB  DC    CL4'THRH'                                                02238000
LNG2LAB  DC    CL4'LNG2'                                                02239000
RSVD2LAB DC    CL5'RSVD2'                                               02240000
LOCALIND DC    CL5'LOCAL'                                               02241000
REMOTIND DC    CL6'REMOTE'                                              02242000
LINELAB  DC    CL4'LINE'                                                02243000
TIMELAB  DC    CL4'TIME'                                                02244000
EPLAB    DC    CL2'EP'                                                  02245000
SLOWIND  DC    CL8'SLOWDOWN'                                            02246000
LINELABS DC    CL37'LCD    PCF    TIME     SCF     PDF   '              02247000
LINELABE DC    CL79'STATUS      SCF    LCD    PCF    EPCF    STAT1    SC02248000
               TAT2    TIME    ADDR    CNTL'                            02249000
         DS    CL1                                                      02250000
TXTHEX1  DS    CL4                                                      02251000
         ORG   TXTHEX1                                                  02252000
TXT1FLG1 DC    X'80'                                                    02253000
TXT1COL1 DC    AL1(34)                                                  02254000
TXT1LNG1 DC    H'20'                                                    02255000
         ORG   TXTHEX1+4                                                02256000
HEXTAB   DC    CL16'0123456789ABCDEF'                                   02257000
TPHEX1   DS    CL12                                                     02258000
         ORG   TPHEX1                                                   02259000
TP1FLG1  DC    X'00'                                                    02260000
TP1COL1  DC    AL1(34)                                                  02261000
TP1LNG1  DC    H'12'                                                    02262000
TP1FLG2  DC    X'00'                                                    02263000
TP1COL2  DC    AL1(68)                                                  02264000
TP1LNG2  DC    H'2'                                                     02265000
TP1FLG3  DC    X'80'                                                    02266000
TP1COL3  DC    AL1(80)                                                  02267000
TP1LNG3  DC    H'2'                                                     02268000
         ORG   TPHEX1+12                                                02269000
TPHEX2   DS    CL4                                                      02270000
         ORG   TPHEX2                                                   02271000
TP2FLG1  DC    X'80'                                                    02272000
TP2COL1  DC    AL1(93)                                                  02273000
TP2LNG1  DC    H'8'                                                     02274000
         ORG   TPHEX2+4                                                 02275000
TPHEX3   DS    CL4                                                      02276000
         ORG   TPHEX3                                                   02277000
TP3FLG1  DC    X'80'                                                    02278000
TP3COL1  DC    AL1(34)                                                  02279000
TP3LNG1  DC    H'32'                                                    02280000
         ORG   TPHEX3+4                                                 02281000
TPHEX4   DS    CL4                                                      02282000
         ORG   TPHEX4                                                   02283000
TP4FLG1  DC    X'80'                                                    02284000
TP4COL1  DC    AL1(34)                                                  02285000
TP4LNG1  DC    H'20'                                                    02286000
         ORG   TPHEX4+4                                                 02287000
TPHEX5   DS    CL4                                                      02288000
         ORG   TPHEX5                                                   02289000
TP5FLG1  DC    X'80'                                                    02290000
TP5COL1  DC    AL1(34)                                                  02291000
TP5LNG1  DC    H'12'                                                    02292000
         ORG   TPHEX5+4                                                 02293000
LNHEX1   DS    CL8                                                      02294000
         ORG   LNHEX1                                                   02295000
LN1FLG1  DC    X'00'                                                    02296000
LN1COL1  DC    AL1(49)                                                  02297000
LN1LNG1  DC    H'1'                                                     02298000
LN1FLG2  DC    X'80'                                                    02299000
LN1COL2  DC    AL1(35)                                                  02300000
LN1LNG2  DC    H'1'                                                     02301000
         ORG   LNHEX1+8                                                 02302000
LNHEX2   DS    CL32                                                     02303000
         ORG   LNHEX2                                                   02304000
LN2FLG1  DC    X'00'                                                    02305000
LN2COL1  DC    AL1(25)                                                  02306000
LN2LNG1  DC    H'1'                                                     02307000
LN2FLG2  DC    X'00'                                                    02308000
LN2COL2  DC    AL1(40)                                                  02309000
LN2LNG2  DC    H'1'                                                     02310000
LN2FLG3  DC    X'00'                                                    02311000
LN2COL3  DC    AL1(48)                                                  02312000
LN2LNG3  DC    H'1'                                                     02313000
LN2FLG4  DC    X'00'                                                    02314000
LN2COL4  DC    AL1(56)                                                  02315000
LN2LNG4  DC    H'1'                                                     02316000
LN2FLG5  DC    X'00'                                                    02317000
LN2COL5  DC    AL1(68)                                                  02318000
LN2LNG5  DC    H'1'                                                     02319000
LN2FLG6  DC    X'00'                                                    02320000
LN2COL6  DC    AL1(83)                                                  02321000
LN2LNG6  DC    H'1'                                                     02322000
LN2FLG7  DC    X'00'                                                    02323000
LN2COL7  DC    AL1(91)                                                  02324000
LN2LNG7  DC    H'1'                                                     02325000
LN2FLG8  DC    X'80'                                                    02326000
LN2COL8  DC    AL1(99)                                                  02327000
LN2LNG8  DC    H'1'                                                     02328000
         ORG   LNHEX2+32                                                02329000
LNHEX2E  DS    CL32                                                     02330000
         ORG   LNHEX2E                                                  02331000
LN2EFL1  DC    X'00'                                                    02332000
LN2ECL1  DC    AL1(25)                                                  02333000
LN2ELN1  DC    H'1'                                                     02334000
LN2EFL2  DC    X'00'                                                    02335000
LN2ECL2  DC    AL1(32)                                                  02336000
LN2ELN2  DC    H'1'                                                     02337000
LN2EFL4  DC    X'00'                                                    02338000
LN2ECL4  DC    AL1(46)                                                  02339000
LN2ELN4  DC    H'1'                                                     02340000
LN2EFL5  DC    X'00'                                                    02341000
LN2ECL5  DC    AL1(55)                                                  02342000
LN2ELN5  DC    H'1'                                                     02343000
LN2EFL6  DC    X'00'                                                    02344000
LN2ECL6  DC    AL1(64)                                                  02345000
LN2ELN6  DC    H'1'                                                     02346000
LN2EFL7  DC    X'00'                                                    02347000
LN2ECL7  DC    AL1(72)                                                  02348000
LN2ELN7  DC    H'1'                                                     02349000
LN2EFL8  DC    X'00'                                                    02350000
LN2ECL8  DC    AL1(80)                                                  02351000
LN2ELN8  DC    H'1'                                                     02352000
LN2EFL9  DC    X'80'                                                    02353000
LN2ECL9  DC    AL1(88)                                                  02354000
LN2ELN9  DC    H'1'                                                     02355000
         ORG   LNHEX2E+32                                               02356000
SFHEX    DS    CL12                                                     02357000
         ORG   SFHEX                                                    02358000
SFFLG1   DC    X'00'                                                    02359000
SFCOL1   DC    AL1(23)                                                  02360000
SFLEN1   DC    H'2'                                                     02361000
SFFLG2   DC    X'00'                                                    02362000
SFCOL2   DC    AL1(28)                                                  02363000
SFLEN2   DC    H'2'                                                     02364000
SFFLG3   DC    X'80'                                                    02365000
SFCOL3   DC    AL1(33)                                                  02366000
SFLEN3   DC    H'2'                                                     02367000
         ORG   SFHEX+12                                                 02368000
SPHEX    DS    CL12                                                     02369000
         ORG   SPHEX                                                    02370000
SPFLG1   DC    X'00'                                                    02371000
SPCOL1   DC    AL1(41)                                                  02372000
SPLEN1   DC    H'2'                                                     02373000
SPFLG2   DC    X'00'                                                    02374000
SPCOL2   DC    AL1(46)                                                  02375000
SPLEN2   DC    H'2'                                                     02376000
SPFLG3   DC    X'80'                                                    02377000
SPCOL3   DC    AL1(51)                                                  02378000
SPLEN3   DC    H'2'                                                     02379000
         ORG   SPHEX+12                                                 02380000
LFHEX    DS    CL12                                                     02381000
         ORG   LFHEX                                                    02382000
LFFLG1   DC    X'00'                                                    02383000
LFCOL1   DC    AL1(59)                                                  02384000
LFLEN1   DC    H'2'                                                     02385000
LFFLG2   DC    X'00'                                                    02386000
LFCOL2   DC    AL1(64)                                                  02387000
LFLEN2   DC    H'2'                                                     02388000
LFFLG3   DC    X'80'                                                    02389000
LFCOL3   DC    AL1(69)                                                  02390000
LFLEN3   DC    H'2'                                                     02391000
         ORG   LFHEX+12                                                 02392000
LPHEX    DS    CL12                                                     02393000
         ORG   LPHEX                                                    02394000
LPFLG1   DC    X'00'                                                    02395000
LPCOL1   DC    AL1(77)                                                  02396000
LPLEN1   DC    H'2'                                                     02397000
LPFLG2   DC    X'00'                                                    02398000
LPCOL2   DC    AL1(82)                                                  02399000
LPLEN2   DC    H'2'                                                     02400000
LPFLG3   DC    X'80'                                                    02401000
LPCOL3   DC    AL1(87)                                                  02402000
LPLEN3   DC    H'2'                                                     02403000
         ORG   LPHEX+12                                                 02404000
UEHEX    DS    CL12                                                     02405000
         ORG   UEHEX                                                    02406000
UEFLG1   DC    X'00'                                                    02407000
UECOL1   DC    AL1(23)                                                  02408000
UELEN1   DC    H'2'                                                     02409000
UEFLG2   DC    X'00'                                                    02410000
UECOL2   DC    AL1(28)                                                  02411000
UELEN2   DC    H'2'                                                     02412000
UEFLG3   DC    X'80'                                                    02413000
UECOL3   DC    AL1(33)                                                  02414000
UELEN3   DC    H'2'                                                     02415000
         ORG   UEHEX+12                                                 02416000
IOHEX    DS    CL12                                                     02417000
         ORG   IOHEX                                                    02418000
IOFLG1   DC    X'00'                                                    02419000
IOCOL1   DC    AL1(23)                                                  02420000
IOLEN1   DC    H'2'                                                     02421000
IOFLG2   DC    X'00'                                                    02422000
IOCOL2   DC    AL1(28)                                                  02423000
IOLEN2   DC    H'2'                                                     02424000
IOFLG3   DC    X'80'                                                    02425000
IOCOL3   DC    AL1(33)                                                  02426000
IOLEN3   DC    H'2'                                                     02427000
         ORG   IOHEX+12                                                 02428000
WPHEX    DS    CL12                                                     02429000
         ORG   WPHEX                                                    02430000
WPFLG1   DC    X'00'                                                    02431000
WPCOL1   DC    AL1(59)                                                  02432000
WPLEN1   DC    H'2'                                                     02433000
WPFLG2   DC    X'00'                                                    02434000
WPCOL2   DC    AL1(64)                                                  02435000
WPLEN2   DC    H'2'                                                     02436000
WPFLG3   DC    X'80'                                                    02437000
WPCOL3   DC    AL1(69)                                                  02438000
WPLEN3   DC    H'2'                                                     02439000
         ORG   WPHEX+12                                                 02440000
APHEX    DS    CL12                                                     02441000
         ORG   APHEX                                                    02442000
APFLG1   DC    X'00'                                                    02443000
APCOL1   DC    AL1(77)                                                  02444000
APLEN1   DC    H'2'                                                     02445000
APFLG2   DC    X'00'                                                    02446000
APCOL2   DC    AL1(82)                                                  02447000
APLEN2   DC    H'2'                                                     02448000
APFLG3   DC    X'80'                                                    02449000
APCOL3   DC    AL1(87)                                                  02450000
APLEN3   DC    H'2'                                                     02451000
         ORG   APHEX+12                                                 02452000
PPHEX    DS    CL12                                                     02453000
         ORG   PPHEX                                                    02454000
PPFLG1   DC    X'00'                                                    02455000
PPCOL1   DC    AL1(41)                                                  02456000
PPLEN1   DC    H'2'                                                     02457000
PPFLG2   DC    X'00'                                                    02458000
PPCOL2   DC    AL1(46)                                                  02459000
PPLEN2   DC    H'2'                                                     02460000
PPFLG3   DC    X'80'                                                    02461000
PPCOL3   DC    AL1(51)                                                  02462000
PPLEN3   DC    H'2'                                                     02463000
         ORG   PPHEX+12                                                 02464000
NPHEX    DS    CL12                                                     02465000
         ORG   NPHEX                                                    02466000
NPFLG1   DC    X'00'                                                    02467000
NPCOL1   DC    AL1(41)                                                  02468000
NPLEN1   DC    H'2'                                                     02469000
NPFLG2   DC    X'00'                                                    02470000
NPCOL2   DC    AL1(46)                                                  02471000
NPLEN2   DC    H'2'                                                     02472000
NPFLG3   DC    X'80'                                                    02473000
NPCOL3   DC    AL1(51)                                                  02474000
NPLEN3   DC    H'2'                                                     02475000
         ORG   NPHEX+12                                                 02476000
CRHEX    DS    CL12                                                     02477000
         ORG   CRHEX                                                    02478000
CRFLG1   DC    X'00'                                                    02479000
CRCOL1   DC    AL1(59)                                                  02480000
CRLEN1   DC    H'2'                                                     02481000
CRFLG2   DC    X'00'                                                    02482000
CRCOL2   DC    AL1(64)                                                  02483000
CRLEN2   DC    H'2'                                                     02484000
CRFLG3   DC    X'80'                                                    02485000
CRCOL3   DC    AL1(69)                                                  02486000
CRLEN3   DC    H'2'                                                     02487000
         ORG   CRHEX+12                                                 02488000
SMSVTAM  DC    CL4'VTAM'                                                02489000
SMSBUF   DC    CL7'BUFFERS'                                             02490000
SMSHD    DC    CL14'MAXU MAXQ AVNO'                                     02491000
SFCHAR   DC    CL2'SF'                                                  02492000
SPCHAR   DC    CL2'SP'                                                  02493000
LFCHAR   DC    CL2'LF'                                                  02494000
LPCHAR   DC    CL2'LP'                                                  02495000
UECHAR   DC    CL2'UE'                                                  02496000
IOCHAR   DC    CL2'IO'                                                  02497000
WPCHAR   DC    CL2'WP'                                                  02498000
APCHAR   DC    CL2'AP'                                                  02499000
PPCHAR   DC    CL2'PP'                                                  02500000
NPCHAR   DC    CL2'NP'                                                  02501000
CRCHAR   DC    CL2'CR'                                                  02502000
EBCDTAB  DC    64X'4B'                                                  02503000
         DC    X'40'                                                    02504000
         DC    9X'4B'                                                   02505000
         DC    X'4A'                                                    02506000
         DC    X'4B'                                                    02507000
         DC    X'4C'                                                    02508000
         DC    X'4D'                                                    02509000
         DC    X'4E'                                                    02510000
         DC    X'4F'                                                    02511000
         DC    X'50'                                                    02512000
         DC    9X'4B'                                                   02513000
         DC    X'5A'                                                    02514000
         DC    X'5B'                                                    02515000
         DC    X'5C'                                                    02516000
         DC    X'5D'                                                    02517000
         DC    X'5E'                                                    02518000
         DC    X'5F'                                                    02519000
         DC    X'60'                                                    02520000
         DC    X'61'                                                    02521000
         DC    9X'4B'                                                   02522000
         DC    X'6B'                                                    02523000
         DC    X'6C'                                                    02524000
         DC    X'6D'                                                    02525000
         DC    X'6E'                                                    02526000
         DC    X'6F'                                                    02527000
         DC    10X'4B'                                                  02528000
         DC    X'7A'                                                    02529000
         DC    X'7B'                                                    02530000
         DC    X'7C'                                                    02531000
         DC    X'7D'                                                    02532000
         DC    X'7E'                                                    02533000
         DC    X'7F'                                                    02534000
         DC    X'4B'                                                    02535000
         DC    X'81'                                                    02536000
         DC    X'82'                                                    02537000
         DC    X'83'                                                    02538000
         DC    X'84'                                                    02539000
         DC    X'85'                                                    02540000
         DC    X'86'                                                    02541000
         DC    X'87'                                                    02542000
         DC    X'88'                                                    02543000
         DC    X'89'                                                    02544000
         DC    7X'4B'                                                   02545000
         DC    X'91'                                                    02546000
         DC    X'92'                                                    02547000
         DC    X'93'                                                    02548000
         DC    X'94'                                                    02549000
         DC    X'95'                                                    02550000
         DC    X'96'                                                    02551000
         DC    X'97'                                                    02552000
         DC    X'98'                                                    02553000
         DC    X'99'                                                    02554000
         DC    8X'4B'                                                   02555000
         DC    X'A2'                                                    02556000
         DC    X'A3'                                                    02557000
         DC    X'A4'                                                    02558000
         DC    X'A5'                                                    02559000
         DC    X'A6'                                                    02560000
         DC    X'A7'                                                    02561000
         DC    X'A8'                                                    02562000
         DC    X'A9'                                                    02563000
         DC    23X'4B'                                                  02564000
         DC    X'C1'                                                    02565000
         DC    X'C2'                                                    02566000
         DC    X'C3'                                                    02567000
         DC    X'C4'                                                    02568000
         DC    X'C5'                                                    02569000
         DC    X'C6'                                                    02570000
         DC    X'C7'                                                    02571000
         DC    X'C8'                                                    02572000
         DC    X'C9'                                                    02573000
         DC    7X'4B'                                                   02574000
         DC    X'D1'                                                    02575000
         DC    X'D2'                                                    02576000
         DC    X'D3'                                                    02577000
         DC    X'D4'                                                    02578000
         DC    X'D5'                                                    02579000
         DC    X'D6'                                                    02580000
         DC    X'D7'                                                    02581000
         DC    X'D8'                                                    02582000
         DC    X'D9'                                                    02583000
         DC    8X'4B'                                                   02584000
         DC    X'E2'                                                    02585000
         DC    X'E3'                                                    02586000
         DC    X'E4'                                                    02587000
         DC    X'E5'                                                    02588000
         DC    X'E6'                                                    02589000
         DC    X'E7'                                                    02590000
         DC    X'E8'                                                    02591000
         DC    X'E9'                                                    02592000
         DC    6X'4B'                                                   02593000
         DC    X'F0'                                                    02594000
         DC    X'F1'                                                    02595000
         DC    X'F2'                                                    02596000
         DC    X'F3'                                                    02597000
         DC    X'F4'                                                    02598000
         DC    X'F5'                                                    02599000
         DC    X'F6'                                                    02600000
         DC    X'F7'                                                    02601000
         DC    X'F8'                                                    02602000
         DC    X'F9'                                                    02603000
         DC    6X'4B'                                                   02604000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02605000
@01      EQU   01                                                       02606000
@02      EQU   02                                                       02607000
@03      EQU   03                                                       02608000
@04      EQU   04                                                       02609000
@05      EQU   05                                                       02610000
@06      EQU   06                                                       02611000
@07      EQU   07                                                       02612000
@08      EQU   08                                                       02613000
@09      EQU   09                                                       02614000
@10      EQU   10                                                       02615000
@11      EQU   11                                                       02616000
@12      EQU   12                                                       02617000
@13      EQU   13                                                       02618000
@14      EQU   14                                                       02619000
@15      EQU   15                                                       02620000
EBCDADDR EQU   @05                                                      02621000
HEXADDR  EQU   @06                                                      02622000
XTRAHEXL EQU   @05                                                      02623000
EXCESS   EQU   @04                                                      02624000
DATASTRT EQU   @00                                                      02625000
EDITPARM EQU   @01                                                      02626000
HEXPARM  EQU   @01                                                      02627000
PARMSAVE EQU   @02                                                      02628000
BUFFPTR  EQU   @03                                                      02629000
SAVEPTR  EQU   @13                                                      02630000
HEXDPTR  EQU   @04                                                      02631000
ENTRYPTR EQU   @05                                                      02632000
HEXBUFFR EQU   @06                                                      02633000
HEXLNG   EQU   @07                                                      02634000
SRBSECT  EQU   0                                                        02635000
SRBFLC   EQU   SRBSECT+12                                               02636000
ISTRH    EQU   0                                                        02637000
RHFLAGS  EQU   ISTRH                                                    02638000
RH1      EQU   RHFLAGS                                                  02639000
RH2      EQU   RHFLAGS+1                                                02640000
RHRETRY  EQU   RH2                                                      02641000
RHRSVD1  EQU   RH2                                                      02642000
RH3      EQU   RHFLAGS+2                                                02643000
ISTRU    EQU   0                                                        02644000
RUDATA   EQU   ISTRU                                                    02645000
ISTRUB   EQU   0                                                        02646000
NSRUNA5  EQU   0                                                        02647000
ISTTRF   EQU   0                                                        02648000
TRFANODE EQU   ISTTRF                                                   02649000
TRFDNODE EQU   ISTTRF+8                                                 02650000
TRFFLG   EQU   ISTTRF+16                                                02651000
TRFINB   EQU   TRFFLG                                                   02652000
TRFLOCAL EQU   TRFFLG                                                   02653000
TRFCXTF  EQU   TRFFLG                                                   02654000
TRFLSNA  EQU   TRFFLG                                                   02655000
ISTBDU   EQU   0                                                        02656000
BDUMODIF EQU   ISTBDU+1                                                 02657000
BDUMOD1  EQU   BDUMODIF                                                 02658000
BDUDAF   EQU   ISTBDU+2                                                 02659000
BDUFUNC  EQU   BDUDAF                                                   02660000
BDUCHECK EQU   BDUFUNC                                                  02661000
BDUFLAGS EQU   BDUDAF+1                                                 02662000
BDUPTR   EQU   0                                                        02663000
ISTFDB   EQU   0                                                        02664000
ISTLH    EQU   0                                                        02665000
ISTTH    EQU   0                                                        02666000
THFLAG1  EQU   ISTTH                                                    02667000
THFLGA   EQU   THFLAG1                                                  02668000
THMPF    EQU   THFLGA                                                   02669000
THFLGB   EQU   THFLAG1+1                                                02670000
ISTTH2   EQU   0                                                        02671000
TH2FLAG1 EQU   ISTTH2                                                   02672000
TH2MPF   EQU   TH2FLAG1                                                 02673000
ISTBTU   EQU   0                                                        02674000
BTUBTH   EQU   ISTBTU                                                   02675000
BTUFID   EQU   BTUBTH                                                   02676000
BTUFIDNO EQU   BTUFID                                                   02677000
BTUREQ   EQU   BTUBTH+6                                                 02678000
BTURQFLG EQU   BTUREQ                                                   02679000
BTURH    EQU   BTUBTH+10                                                02680000
BTUPAD   EQU   BTURH+3                                                  02681000
BTUSYSTR EQU   ISTBTU+18                                                02682000
BTUTEXT  EQU   ISTBTU+20                                                02683000
BTUPTR   EQU   0                                                        02684000
ISTFSB   EQU   0                                                        02685000
FSBFSB   EQU   ISTFSB                                                   02686000
FSBMNRCD EQU   FSBFSB+2                                                 02687000
FSBSFLGS EQU   FSBFSB+3                                                 02688000
FSBFSBA  EQU   FSBFSB+4                                                 02689000
FSBBTH   EQU   FSBFSB+8                                                 02690000
FSBCID   EQU   FSBBTH                                                   02691000
FSBRQTAG EQU   FSBBTH+4                                                 02692000
FSBSEQID EQU   FSBRQTAG                                                 02693000
FSBFLAGS EQU   FSBSEQID                                                 02694000
FSBSEQ   EQU   FSBSEQID+1                                               02695000
FSBCSWST EQU   FSBBTH+6                                                 02696000
FSBTHFLD EQU   FSBCSWST                                                 02697000
FSBTH1   EQU   FSBTHFLD                                                 02698000
FSBSYSRS EQU   FSBTH1                                                   02699000
FSBTH2   EQU   FSBTHFLD+1                                               02700000
FSBEXTRS EQU   FSBTH2                                                   02701000
FSBXFSTS EQU   FSBEXTRS                                                 02702000
FSBXCODE EQU   FSBEXTRS                                                 02703000
FSBNETRS EQU   FSBFSB+16                                                02704000
FSBSRCAT EQU   FSBNETRS                                                 02705000
FSBERC   EQU   FSBNETRS+1                                               02706000
FSBFBMI  EQU   FSBERC                                                   02707000
FSBDMGRS EQU   FSBFSB+18                                                02708000
FSBSS1   EQU   FSBDMGRS                                                 02709000
FSBSS2   EQU   FSBDMGRS+1                                               02710000
FSBLCPB  EQU   FSBFSB+20                                                02711000
FSBMSGID EQU   FSBLCPB                                                  02712000
FSBLCCWA EQU   FSBFSB+24                                                02713000
FSBRLSTS EQU   FSBLCCWA                                                 02714000
FSBPTR   EQU   0                                                        02715000
ISTZIBUF EQU   0                                                        02716000
ZIBFSM   EQU   ISTZIBUF+4                                               02717000
ISTZOBUF EQU   0                                                        02718000
ZOBFSM   EQU   ISTZOBUF+4                                               02719000
ISTZLBUF EQU   0                                                        02720000
ZLBFSM   EQU   ISTZLBUF+4                                               02721000
ISTTRAC  EQU   0                                                        02722000
TRA1WORD EQU   ISTTRAC                                                  02723000
TRATRCB  EQU   ISTTRAC+8                                                02724000
TRABDW   EQU   TRATRCB                                                  02725000
TRAFLG   EQU   ISTTRAC+12                                               02726000
TRAFLG2  EQU   ISTTRAC+13                                               02727000
TRACXTF  EQU   TRAFLG2                                                  02728000
TRADIO   EQU   TRAFLG2                                                  02729000
TRADATCT EQU   ISTTRAC+14                                               02730000
TRADNODE EQU   ISTTRAC+16                                               02731000
TRACID   EQU   TRADNODE                                                 02732000
TRADATA  EQU   ISTTRAC+32                                               02733000
PASSAREA EQU   0                                                        02734000
NEXTLINE EQU   PASSAREA                                                 02735000
DATALNG  EQU   PASSAREA+4                                               02736000
TEXTLN   EQU   PASSAREA+8                                               02737000
TEXTADDR EQU   PASSAREA+12                                              02738000
LINECNT  EQU   PASSAREA+16                                              02739000
LINEADDR EQU   PASSAREA+20                                              02740000
SRBPTR   EQU   PASSAREA+24                                              02741000
RETCODE  EQU   PASSAREA+28                                              02742000
TRFPTR   EQU   PASSAREA+32                                              02743000
TRRPTR   EQU   PASSAREA+36                                              02744000
SWITCHES EQU   PASSAREA+40                                              02745000
CONFTEXT EQU   SWITCHES                                                 02746000
HEXWORK  EQU   PASSAREA+41                                              02747000
TEMPCNT  EQU   PASSAREA+50                                              02748000
BLKHDR   EQU   0                                                        02749000
BLKTYPE  EQU   BLKHDR                                                   02750000
BLKCNT   EQU   BLKHDR+1                                                 02751000
INPUTEID EQU   0                                                        02752000
RECLEN   EQU   0                                                        02753000
MYSAVE   EQU   0                                                        02754000
HISPTR   EQU   MYSAVE+4                                                 02755000
HISSAVE  EQU   0                                                        02756000
RTRNREG  EQU   HISSAVE+16                                               02757000
FMTAPPLS EQU   0                                                        02758000
RECORDAD EQU   FMTAPPLS                                                 02759000
OUTBUF   EQU   FMTAPPLS+4                                               02760000
EIDADDR  EQU   FMTAPPLS+12                                              02761000
DATAADDR EQU   FMTAPPLS+16                                              02762000
WORKAREA EQU   FMTAPPLS+24                                              02763000
CLFIRST  EQU   0                                                        02764000
CLLABL   EQU   CLFIRST+1                                                02765000
CLINOUT  EQU   CLFIRST+6                                                02766000
CLANODLB EQU   CLFIRST+11                                               02767000
CLANODAT EQU   CLFIRST+17                                               02768000
CLTEXTLB EQU   CLFIRST+28                                               02769000
CLSECOND EQU   0                                                        02770000
CLDNODLB EQU   CLSECOND+11                                              02771000
CLDNODAT EQU   CLSECOND+17                                              02772000
TPFIRST  EQU   0                                                        02773000
TPLABL   EQU   TPFIRST+1                                                02774000
TPINOUT  EQU   TPFIRST+7                                                02775000
TPANODLB EQU   TPFIRST+11                                               02776000
TPANODAT EQU   TPFIRST+17                                               02777000
TPFDBLB  EQU   TPFIRST+28                                               02778000
TPRSVLNG EQU   TPFIRST+62                                               02779000
TPRSVDLB EQU   TPRSVLNG                                                 02780000
TPLNG2LB EQU   TPRSVLNG+12                                              02781000
TPRSV2LB EQU   TPRSVLNG+24                                              02782000
TPLOC2   EQU   0                                                        02783000
TPLOCLB  EQU   TPLOC2+3                                                 02784000
TPLOCDNL EQU   TPLOC2+11                                                02785000
TPLOCDND EQU   TPLOC2+17                                                02786000
TPLOCTXL EQU   TPLOC2+28                                                02787000
TPLOCFSL EQU   TPLOCTXL                                                 02788000
TPLOC3   EQU   0                                                        02789000
TPLOCFDL EQU   TPLOC3+28                                                02790000
TPRI2    EQU   0                                                        02791000
TPRILBL  EQU   TPRI2+3                                                  02792000
TPRIDNL  EQU   TPRI2+11                                                 02793000
TPRIDND  EQU   TPRI2+17                                                 02794000
TPRIFSBL EQU   TPRI2+28                                                 02795000
TPRI3    EQU   0                                                        02796000
TPRITHL  EQU   TPRI3+28                                                 02797000
TPRITHD  EQU   TPRI3+33                                                 02798000
TPRIFID0 EQU   TPRITHD+29                                               02799000
TPRO2    EQU   0                                                        02800000
TPROLBL  EQU   TPRO2+3                                                  02801000
TPRODNL  EQU   TPRO2+11                                                 02802000
TPRODND  EQU   TPRO2+17                                                 02803000
TPROTHL  EQU   TPRO2+28                                                 02804000
TPROTHD  EQU   TPRO2+33                                                 02805000
TPTXT    EQU   0                                                        02806000
TPTXTLBL EQU   TPTXT+28                                                 02807000
LNFRST   EQU   0                                                        02808000
LNLABEL  EQU   LNFRST+1                                                 02809000
LNDNODL  EQU   LNFRST+11                                                02810000
LNDNODAT EQU   LNFRST+17                                                02811000
LNEPLB   EQU   LNFRST+31                                                02812000
LNTMLB   EQU   LNFRST+43                                                02813000
LNSLOWDN EQU   LNFRST+54                                                02814000
LNBUF2   EQU   0                                                        02815000
LN2FIRST EQU   LNBUF2+20                                                02816000
LN2LCDE1 EQU   LN2FIRST+5                                               02817000
LN2PCFD1 EQU   LN2FIRST+11                                              02818000
LN2SECND EQU   LNBUF2+63                                                02819000
LN2LCDE2 EQU   LN2SECND+5                                               02820000
LN2PCFD2 EQU   LN2SECND+11                                              02821000
LNBUF2S  EQU   0                                                        02822000
LNSLCD   EQU   LNBUF2S+31                                               02823000
LNSPCF   EQU   LNBUF2S+38                                               02824000
LNINPUT  EQU   0                                                        02825000
LNSRU    EQU   LNINPUT+61                                               02826000
LLABEL1  EQU   0                                                        02827000
LLABEL   EQU   LLABEL1+11                                               02828000
TEXTDATA EQU   0                                                        02829000
XTRAHEX  EQU   0                                                        02830000
XTRAEBCD EQU   0                                                        02831000
TEXTBUF  EQU   0                                                        02832000
TEXTHEX  EQU   TEXTBUF+33                                               02833000
TEXTAST1 EQU   TEXTBUF+79                                               02834000
TEXTEBCD EQU   TEXTBUF+80                                               02835000
TEXTAST2 EQU   TEXTBUF+100                                              02836000
HEXTABL  EQU   0                                                        02837000
HEXPLIST EQU   0                                                        02838000
HEXFLGS  EQU   HEXPLIST                                                 02839000
LASTENTY EQU   HEXFLGS                                                  02840000
HEXCOLUM EQU   HEXPLIST+1                                               02841000
HEXLNGTH EQU   HEXPLIST+2                                               02842000
HEXDATA  EQU   0                                                        02843000
PRINTHEX EQU   0                                                        02844000
SMSHDRER EQU   0                                                        02845000
NM1      EQU   SMSHDRER+4                                               02846000
NM2      EQU   SMSHDRER+9                                               02847000
NM3      EQU   SMSHDRER+22                                              02848000
NM4      EQU   SMSHDRER+40                                              02849000
NM5      EQU   SMSHDRER+58                                              02850000
NM6      EQU   SMSHDRER+76                                              02851000
SMSFIRST EQU   0                                                        02852000
IOLABEL  EQU   SMSFIRST+19                                              02853000
PPLABEL  EQU   SMSFIRST+37                                              02854000
LPLABEL  EQU   SMSFIRST+55                                              02855000
WPLABEL  EQU   SMSFIRST+73                                              02856000
SMSSECND EQU   0                                                        02857000
NPLABEL  EQU   SMSSECND+19                                              02858000
LFLABEL  EQU   SMSSECND+37                                              02859000
CRLABEL  EQU   SMSSECND+55                                              02860000
UELABEL  EQU   SMSSECND+73                                              02861000
SMSLAST  EQU   0                                                        02862000
SFLABEL  EQU   SMSLAST+19                                               02863000
SPLABEL  EQU   SMSLAST+37                                               02864000
APLABEL  EQU   SMSLAST+55                                               02865000
ZIBSRB   EQU   0                                                        02866000
ISTSENRU EQU   RUDATA                                                   02867000
SRUSENSE EQU   ISTSENRU                                                 02868000
SRUSENS1 EQU   SRUSENSE                                                 02869000
SRUSENS2 EQU   SRUSENSE+2                                               02870000
ISTSRU   EQU   ISTRUB                                                   02871000
SRUDATA  EQU   ISTSRU+1                                                 02872000
SRUTYPE  EQU   SRUDATA                                                  02873000
SRULDID  EQU   SRUDATA+1                                                02874000
SRUSPSN  EQU   SRULDID                                                  02875000
ISTNSRU  EQU   ISTRUB                                                   02876000
NSRUNETS EQU   ISTNSRU                                                  02877000
NSRUDATA EQU   ISTNSRU+3                                                02878000
NSRUHOOK EQU   NSRUDATA                                                 02879000
NSSSVRU  EQU   NSRUDATA                                                 02880000
NSSSVNOD EQU   NSSSVRU+3                                                02881000
NSSSVT3  EQU   NSSSVNOD                                                 02882000
NSSSVT3C EQU   NSSSVT3+2                                                02883000
NSSSVT3G EQU   NSSSVT3+5                                                02884000
NSSSVT4  EQU   NSSSVNOD                                                 02885000
NSSSVT5  EQU   NSSSVNOD                                                 02886000
NSRUDAT1 EQU   NSRUDATA                                                 02887000
NSRUDAT2 EQU   NSRUDAT1+2                                               02888000
ISTTRRU  EQU   NSRUDAT2                                                 02889000
TRRTYPE  EQU   ISTTRRU                                                  02890000
TRRFMT2  EQU   TRRTYPE                                                  02891000
TRRTIME  EQU   ISTTRRU+1                                                02892000
TRRSTAT  EQU   ISTTRRU+3                                                02893000
TRRDATA  EQU   ISTTRRU+4                                                02894000
ISTCTDRU EQU   NSRUDAT2                                                 02895000
ISTINORU EQU   NSRUDAT2                                                 02896000
SRUDAT1  EQU   SRUDATA                                                  02897000
SRUDAT1L EQU   SRUDAT1+1                                                02898000
SRUDAT2  EQU   SRUDATA                                                  02899000
ISTMRU   EQU   ISTRUB                                                   02900000
SRUDATA3 EQU   SRUDATA                                                  02901000
SRUDATA4 EQU   SRUDATA                                                  02902000
NSRUDAT3 EQU   NSRUDAT2                                                 02903000
NSRUDAT4 EQU   NSRUDAT2                                                 02904000
NSRUDAT5 EQU   NSRUDAT2                                                 02905000
NSRUDAT6 EQU   NSRUDAT2                                                 02906000
NSRUDAT7 EQU   NSRUDAT2                                                 02907000
NSRUDIL  EQU   NSRUDAT2                                                 02908000
NSRUDILB EQU   NSRUDIL+1                                                02909000
NSRUNA   EQU   NSRUDAT2                                                 02910000
NSRUNA2  EQU   NSRUNA+1                                                 02911000
NSRUCLSP EQU   NSRUDAT2                                                 02912000
NSRUOH1  EQU   NSRUDAT2                                                 02913000
NSRUDAT8 EQU   NSRUDATA                                                 02914000
ISTUNBRU EQU   SRUTYPE                                                  02915000
FSBCOMBN EQU   FSBNETRS                                                 02916000
FSBRHFLD EQU   FSBCOMBN+1                                               02917000
FSBRH3   EQU   FSBRHFLD+2                                               02918000
FSBLDFLG EQU   FSBRH3                                                   02919000
@NM00013 EQU   FSBRQTAG                                                 02920000
ZIBDIO   EQU   ZIBFSM                                                   02921000
ZIBCCW2  EQU   ZIBDIO+8                                                 02922000
ZIBCPTCC EQU   ZIBCCW2                                                  02923000
ZIBAIO   EQU   ISTZIBUF                                                 02924000
ZIBAIOCM EQU   ZIBAIO                                                   02925000
ZIBFIB   EQU   ZIBAIO+16                                                02926000
ZIBFSB   EQU   ZIBFIB                                                   02927000
ZIBMDREC EQU   ZIBFSB+4                                                 02928000
ZIBMDRIN EQU   ZIBFSB+28                                                02929000
ZIBBTU   EQU   ZIBFIB+32                                                02930000
@NM00016 EQU   ZIBBTU+12                                                02931000
ZIBFID1  EQU   @NM00016+1                                               02932000
ZIBFITXT EQU   ZIBFID1                                                  02933000
ZIBSIB   EQU   ZIBFIB                                                   02934000
ZIBREC   EQU   ZIBMDRIN                                                 02935000
ZIBRECPL EQU   ZIBREC                                                   02936000
ZIBRECHD EQU   ZIBRECPL                                                 02937000
ZIBRECRS EQU   ZIBREC+8                                                 02938000
ZIBRECDT EQU   ZIBREC+10                                                02939000
ZIBMDRRC EQU   ZIBMDREC                                                 02940000
ZIBRCPL  EQU   ZIBMDRRC                                                 02941000
ZIBRCDT  EQU   ZIBMDRRC+24                                              02942000
@NM00018 EQU   ZIBBTU                                                   02943000
ZOBDLBT  EQU   ISTZOBUF                                                 02944000
ZOBDLBCM EQU   ZOBDLBT                                                  02945000
ZOBRSV04 EQU   ZOBDLBCM+16                                              02946000
@NM00019 EQU   ZOBDLBCM+25                                              02947000
ZOBBTU   EQU   ZOBDLBT+28                                               02948000
ZOBWCC   EQU   ZOBDLBT+48                                               02949000
ZOBECCC  EQU   ZOBDLBT+50                                               02950000
ZOBDIO   EQU   ZOBFSM                                                   02951000
ZOBCCW2  EQU   ZOBDIO+8                                                 02952000
ZOBCPTCC EQU   ZOBCCW2                                                  02953000
ZOBFLAGS EQU   ZOBCCW2+5                                                02954000
ZOBCCW3  EQU   ZOBDIO+16                                                02955000
ZOBCPTRC EQU   ZOBCCW3                                                  02956000
ZOBCPN2C EQU   ZOBCPTRC                                                 02957000
ZOBCPTRA EQU   ZOBCCW3+1                                                02958000
@NM00023 EQU   ZOBBTU                                                   02959000
ZLBBTRAN EQU   ISTZLBUF                                                 02960000
ZLBAIO   EQU   ZLBBTRAN+16                                              02961000
ZLBDTIO  EQU   ZLBFSM                                                   02962000
ZLBCCW1  EQU   ZLBDTIO                                                  02963000
ZLBCCW2  EQU   ZLBDTIO+8                                                02964000
ZLBCCW3  EQU   ZLBDTIO+16                                               02965000
ZLBSNS   EQU   ZLBDTIO+28                                               02966000
ZLBERC   EQU   ZLBDTIO+29                                               02967000
ZLBSAF   EQU   ZLBDTIO+48                                               02968000
ZLBSTAT  EQU   ZLBSAF                                                   02969000
ZLBDEVST EQU   ZLBSTAT                                                  02970000
ZLBRQTG  EQU   ZLBDTIO+50                                               02971000
ZLBRQFLG EQU   ZLBRQTG                                                  02972000
ZLBFLAGS EQU   ZLBDTIO+56                                               02973000
ZLBTEXTA EQU   ZLBCCW3                                                  02974000
ZLBTEXTB EQU   ZLBFLAGS                                                 02975000
ZLBTEXT1 EQU   ZLBTEXTB                                                 02976000
ZLBTEXTC EQU   ZLBFLAGS                                                 02977000
ZLBPPL   EQU   ZLBTEXTC                                                 02978000
ZLBFAIO  EQU   ZLBAIO                                                   02979000
ZLBFSB   EQU   ZLBFAIO                                                  02980000
ZLBFDBS  EQU   ZLBFAIO+32                                               02981000
TRAIODT  EQU   TRADATA                                                  02982000
TRATH    EQU   TRAIODT+22                                               02983000
TRABDUD  EQU   TRAIODT+35                                               02984000
TRABUFFR EQU   TRADATA                                                  02985000
TRAANODE EQU   TRABUFFR                                                 02986000
TRABFFER EQU   TRABUFFR+8                                               02987000
EBCDCTAB EQU   EBCDTAB                                                  02988000
SRB      EQU   SRBSECT                                                  02989000
ZOBTEXT  EQU   ZOBBTU                                                   02990000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02991000
@NM00024 EQU   TRABDUD+4                                                02992000
TRASEND  EQU   TRABDUD                                                  02993000
TRARH    EQU   TRAIODT+32                                               02994000
TRATHDCF EQU   TRATH+8                                                  02995000
TRATHSNF EQU   TRATH+6                                                  02996000
TRATHOAF EQU   TRATH+4                                                  02997000
TRATHDAF EQU   TRATH+2                                                  02998000
TRATHHD  EQU   TRATH                                                    02999000
TRARSV06 EQU   TRAIODT+21                                               03000000
TRAISEN  EQU   TRAIODT+20                                               03001000
TRAICPA  EQU   TRAIODT+16                                               03002000
TRAIPSW  EQU   TRAIODT+8                                                03003000
TRAICSW  EQU   TRAIODT                                                  03004000
ZLBPPCSC EQU   ZLBPPL+14                                                03005000
ZLBPPRS1 EQU   ZLBPPL+13                                                03006000
ZLBPPRSV EQU   ZLBPPL+12                                                03007000
ZLBPPCLG EQU   ZLBPPL+12                                                03008000
ZLBPPCC  EQU   ZLBPPL+12                                                03009000
ZLBPPINT EQU   ZLBPPL+12                                                03010000
ZLBPPHIO EQU   ZLBPPL+12                                                03011000
ZLBPP    EQU   ZLBPPL+4                                                 03012000
ZLBPPLDB EQU   ZLBPPL+1                                                 03013000
ZLBPPLF  EQU   ZLBPPL                                                   03014000
ZLBTEXT  EQU   ZLBTEXTA+8                                               03015000
ZLBRSV0A EQU   ZLBTEXTA                                                 03016000
ZLBTCP   EQU   ZLBFLAGS+8                                               03017000
ZLBTCSW  EQU   ZLBFLAGS+1                                               03018000
ZLBRSV09 EQU   ZLBFLAGS                                                 03019000
ZLBWCCSP EQU   ZLBFLAGS                                                 03020000
ZLBRSV07 EQU   ZLBFLAGS                                                 03021000
ZLBLSTST EQU   ZLBDTIO+52                                               03022000
ZLBRQSEQ EQU   ZLBRQTG+1                                                03023000
ZLBRT0B  EQU   ZLBRQFLG+1                                               03024000
ZLBRT0A  EQU   ZLBRQFLG+1                                               03025000
ZLBRT09  EQU   ZLBRQFLG+1                                               03026000
ZLBRT08  EQU   ZLBRQFLG+1                                               03027000
ZLBRT07  EQU   ZLBRQFLG                                                 03028000
ZLBRT06  EQU   ZLBRQFLG                                                 03029000
ZLBRT05  EQU   ZLBRQFLG                                                 03030000
ZLBRT04  EQU   ZLBRQFLG                                                 03031000
ZLBRT03  EQU   ZLBRQFLG                                                 03032000
ZLBRT02  EQU   ZLBRQFLG                                                 03033000
ZLBRT01  EQU   ZLBRQFLG                                                 03034000
ZLBRT00  EQU   ZLBRQFLG                                                 03035000
ZLBCHNST EQU   ZLBSTAT+1                                                03036000
ZLBUCST  EQU   ZLBDEVST                                                 03037000
ZLBDEST  EQU   ZLBDEVST                                                 03038000
ZLBRSV10 EQU   ZLBDEVST                                                 03039000
ZLBLSTBF EQU   ZLBDTIO+44                                               03040000
ZLBRSV11 EQU   ZLBDTIO+40                                               03041000
ZLBLCCWA EQU   ZLBDTIO+36                                               03042000
ZLBLCPBA EQU   ZLBDTIO+32                                               03043000
ZLBCOMP  EQU   ZLBDTIO+31                                               03044000
ZLBRSV08 EQU   ZLBDTIO+30                                               03045000
ZLBRSV05 EQU   ZLBERC                                                   03046000
ZLBFBMI  EQU   ZLBERC                                                   03047000
ZLBETI   EQU   ZLBERC                                                   03048000
ZLBEMI   EQU   ZLBERC                                                   03049000
ZLBEBI   EQU   ZLBERC                                                   03050000
ZLBECI   EQU   ZLBERC                                                   03051000
ZLBELI   EQU   ZLBERC                                                   03052000
ZLBSOC   EQU   ZLBSNS                                                   03053000
ZLBSCC   EQU   ZLBSNS                                                   03054000
ZLBSUS   EQU   ZLBSNS                                                   03055000
ZLBSDC   EQU   ZLBSNS                                                   03056000
ZLBSEQCK EQU   ZLBSNS                                                   03057000
ZLBSBOL  EQU   ZLBSNS                                                   03058000
ZLBSIR   EQU   ZLBSNS                                                   03059000
ZLBSCR   EQU   ZLBSNS                                                   03060000
ZLBRSV12 EQU   ZLBDTIO+24                                               03061000
ZLBCPTC3 EQU   ZLBCCW3+6                                                03062000
ZLBRSV04 EQU   ZLBCCW3+5                                                03063000
ZLBCPFL3 EQU   ZLBCCW3+4                                                03064000
ZLBCPAD3 EQU   ZLBCCW3+1                                                03065000
ZLBCPCF3 EQU   ZLBCCW3                                                  03066000
ZLBCPTC2 EQU   ZLBCCW2+6                                                03067000
ZLBRSV03 EQU   ZLBCCW2+5                                                03068000
ZLBCPFL2 EQU   ZLBCCW2+4                                                03069000
ZLBCPAD2 EQU   ZLBCCW2+1                                                03070000
ZLBCPCF2 EQU   ZLBCCW2                                                  03071000
ZLBCPTC1 EQU   ZLBCCW1+6                                                03072000
ZLBCMOD  EQU   ZLBCCW1+5                                                03073000
ZLBCPFL1 EQU   ZLBCCW1+4                                                03074000
ZLBCPAD1 EQU   ZLBCCW1+1                                                03075000
ZLBCPCF1 EQU   ZLBCCW1                                                  03076000
ZLBLNG2  EQU   ZLBBTRAN+14                                              03077000
ZLBRSV01 EQU   ZLBBTRAN+12                                              03078000
ZLBFDBZ  EQU   ZLBBTRAN                                                 03079000
ZOBTH2   EQU   @NM00023+4                                               03080000
ZOBLH    EQU   @NM00023                                                 03081000
ZOBCPN2K EQU   ZOBCCW3+6                                                03082000
ZOBRSV99 EQU   ZOBCCW3+5                                                03083000
ZOBCPN2F EQU   ZOBCCW3+4                                                03084000
ZOBCPTC2 EQU   ZOBCPTRA                                                 03085000
ZOBCPTC1 EQU   ZOBCPN2C                                                 03086000
ZOBCPNPK EQU   ZOBCCW2+6                                                03087000
ZOBRSV03 EQU   ZOBFLAGS                                                 03088000
ZOBRT08  EQU   ZOBFLAGS                                                 03089000
ZOBRT06  EQU   ZOBFLAGS                                                 03090000
ZOBCPNPF EQU   ZOBCCW2+4                                                03091000
ZOBCPTCA EQU   ZOBCCW2+1                                                03092000
ZOBCPNPC EQU   ZOBCPTCC                                                 03093000
ZOBCPWTK EQU   ZOBDIO+6                                                 03094000
ZOBRSV02 EQU   ZOBDIO+5                                                 03095000
ZOBCPWTF EQU   ZOBDIO+4                                                 03096000
ZOBCPTXA EQU   ZOBDIO+1                                                 03097000
ZOBCPWTC EQU   ZOBDIO                                                   03098000
ZOBRSV09 EQU   ZOBECCC                                                  03099000
ZOBECSP  EQU   ZOBECCC                                                  03100000
ZOBRSV08 EQU   ZOBECCC                                                  03101000
ZOBRSV07 EQU   ZOBDLBT+49                                               03102000
ZOBRSV06 EQU   ZOBWCC                                                   03103000
ZOBWCSP  EQU   ZOBWCC                                                   03104000
ZOBRSV05 EQU   ZOBWCC                                                   03105000
ZOBRSV10 EQU   ZOBDLBCM+26                                              03106000
@NM00022 EQU   @NM00019                                                 03107000
@NM00021 EQU   @NM00019                                                 03108000
@NM00020 EQU   @NM00019                                                 03109000
ZOBLNG2  EQU   ZOBDLBCM+14                                              03110000
ZOBRSV01 EQU   ZOBDLBCM+12                                              03111000
ZOBFDB   EQU   ZOBDLBCM                                                 03112000
ZIBTH2   EQU   @NM00018+4                                               03113000
ZIBLH    EQU   @NM00018                                                 03114000
ZIBRCTXT EQU   ZIBMDRRC+36                                              03115000
ZIBRCRID EQU   ZIBRCDT+10                                               03116000
ZIBRCNAM EQU   ZIBRCDT+2                                                03117000
ZIBRCUA  EQU   ZIBRCDT                                                  03118000
ZIBRCPUI EQU   ZIBRCPL+20                                               03119000
ZIBRCPUN EQU   ZIBRCPL+16                                               03120000
ZIBRCTIM EQU   ZIBRCPL+12                                               03121000
ZIBRCDAT EQU   ZIBRCPL+8                                                03122000
ZIBRCRS1 EQU   ZIBRCPL+6                                                03123000
ZIBRCSID EQU   ZIBRCPL+5                                                03124000
ZIBRCID  EQU   ZIBRCPL+4                                                03125000
ZIBRCSW  EQU   ZIBRCPL+2                                                03126000
ZIBRCSYR EQU   ZIBRCPL+1                                                03127000
ZIBRCL   EQU   ZIBRCPL                                                  03128000
ZIBRECTX EQU   ZIBREC+22                                                03129000
ZIBRECID EQU   ZIBRECDT+10                                              03130000
ZIBRECNA EQU   ZIBRECDT+2                                               03131000
ZIBRECUA EQU   ZIBRECDT                                                 03132000
ZIBRECSV EQU   ZIBRECRS                                                 03133000
ZIBRECDA EQU   ZIBRECPL+4                                               03134000
ZIBRECSI EQU   ZIBRECHD+3                                               03135000
ZIBRECDV EQU   ZIBRECHD+2                                               03136000
ZIBRECFL EQU   ZIBRECHD+1                                               03137000
ZIBRECTY EQU   ZIBRECHD                                                 03138000
ZIBTEXT  EQU   ZIBSIB+4                                                 03139000
ZIBRSV04 EQU   ZIBSIB                                                   03140000
ZIBTEXT2 EQU   ZIBFITXT                                                 03141000
ZIBTEXT1 EQU   ZIBFIB+52                                                03142000
@NM00017 EQU   @NM00016                                                 03143000
ZIBFDBS  EQU   ZIBBTU                                                   03144000
@NM00015 EQU   ZIBMDREC                                                 03145000
@NM00014 EQU   ZIBFSB                                                   03146000
ZIBLNG2  EQU   ZIBAIOCM+14                                              03147000
ZIBRSV03 EQU   ZIBAIOCM+13                                              03148000
ZIBWKBYT EQU   ZIBAIOCM+12                                              03149000
ZIBFDBZ  EQU   ZIBAIOCM                                                 03150000
ZIBCPNPK EQU   ZIBCCW2+6                                                03151000
ZIBRSV02 EQU   ZIBCCW2+5                                                03152000
ZIBCPTPF EQU   ZIBCCW2+4                                                03153000
ZIBCPTCA EQU   ZIBCCW2+1                                                03154000
ZIBCPNPC EQU   ZIBCPTCC                                                 03155000
ZIBCPRDK EQU   ZIBDIO+6                                                 03156000
ZIBRSV01 EQU   ZIBDIO+5                                                 03157000
ZIBCPRDF EQU   ZIBDIO+4                                                 03158000
ZIBCPTXA EQU   ZIBDIO+1                                                 03159000
ZIBCPRDC EQU   ZIBDIO                                                   03160000
FSBRT0B  EQU   @NM00013+1                                               03161000
FSBRT0A  EQU   @NM00013+1                                               03162000
FSBRT09  EQU   @NM00013+1                                               03163000
FSBRT08  EQU   @NM00013+1                                               03164000
FSBRT07  EQU   @NM00013                                                 03165000
FSBRT06  EQU   @NM00013                                                 03166000
FSBRT05  EQU   @NM00013                                                 03167000
FSBRT04  EQU   @NM00013                                                 03168000
FSBRT03  EQU   @NM00013                                                 03169000
FSBRT02  EQU   @NM00013                                                 03170000
FSBRT01  EQU   @NM00013                                                 03171000
FSBRT00  EQU   @NM00013                                                 03172000
FSBLDCUF EQU   FSBLDFLG                                                 03173000
FSBLDSIF EQU   FSBLDFLG                                                 03174000
FSBLDSOF EQU   FSBLDFLG                                                 03175000
FSBLDEBF EQU   FSBLDFLG                                                 03176000
FSBLDBBF EQU   FSBLDFLG                                                 03177000
FSBLDFME EQU   FSBLDFLG                                                 03178000
FSBLDSCF EQU   FSBLDFLG                                                 03179000
FSBLDRMF EQU   FSBLDFLG                                                 03180000
FSBRH2   EQU   FSBRHFLD+1                                               03181000
FSBRH1   EQU   FSBRHFLD                                                 03182000
FSBALIGN EQU   FSBCOMBN                                                 03183000
UNBTYPE  EQU   ISTUNBRU                                                 03184000
NSRUDA8T EQU   NSRUDAT8                                                 03185000
NSRUOHID EQU   NSRUOH1                                                  03186000
NSRULSV  EQU   NSRUCLSP                                                 03187000
NSRUNA4  EQU   NSRUNA+2                                                 03188000
NSRUNA3  EQU   NSRUNA2                                                  03189000
NSRUNA1  EQU   NSRUNA                                                   03190000
NSRUDILF EQU   NSRUDIL+4                                                03191000
NSRUDILE EQU   NSRUDIL+3                                                03192000
NSRUDILD EQU   NSRUDIL+2                                                03193000
NSRUDILC EQU   NSRUDILB                                                 03194000
@NM00008 EQU   NSRUDILB                                                 03195000
NSRUDILA EQU   NSRUDIL                                                  03196000
NSRUDA7T EQU   NSRUDAT7                                                 03197000
NSRUDA6L EQU   NSRUDAT6+4                                               03198000
NSRUDA6S EQU   NSRUDAT6                                                 03199000
NSRUDA5E EQU   NSRUDAT5                                                 03200000
NSRUDA4T EQU   NSRUDAT4                                                 03201000
NSRUDA3S EQU   NSRUDAT3                                                 03202000
SRUDAT4D EQU   SRUDATA4                                                 03203000
SRUDAT3I EQU   SRUDATA3                                                 03204000
MRUDATA  EQU   ISTMRU+9                                                 03205000
MRURESP  EQU   ISTMRU+7                                                 03206000
MRUMODIF EQU   ISTMRU+6                                                 03207000
MRUCMND  EQU   ISTMRU+5                                                 03208000
MRUDAF   EQU   ISTMRU+3                                                 03209000
MRUREQ   EQU   ISTMRU+2                                                 03210000
MRUPREF  EQU   ISTMRU                                                   03211000
SRUDAT2N EQU   SRUDAT2+1                                                03212000
SRUDAT2T EQU   SRUDAT2                                                  03213000
SRUDAT1I EQU   SRUDAT1+2                                                03214000
SRUTSPRO EQU   SRUDAT1L                                                 03215000
SRUFMPRO EQU   SRUDAT1L                                                 03216000
SRUDAT1T EQU   SRUDAT1                                                  03217000
INORUET  EQU   ISTINORU                                                 03218000
CTDRUSTA EQU   ISTCTDRU                                                 03219000
TRRPEP   EQU   ISTTRRU+2                                                03220000
@NM00007 EQU   TRRTYPE                                                  03221000
@NM00006 EQU   TRRTYPE                                                  03222000
NSRUDAF  EQU   NSRUDAT1                                                 03223000
NSSSVT5A EQU   NSSSVT5                                                  03224000
NSSSVT4D EQU   NSSSVT4+3                                                03225000
NSSSVT4C EQU   NSSSVT4+2                                                03226000
NSSSVT4B EQU   NSSSVT4+1                                                03227000
NSSSVT4A EQU   NSSSVT4                                                  03228000
NSSSVT3K EQU   NSSSVT3+8                                                03229000
NSSSVT3J EQU   NSSSVT3+7                                                03230000
NSSSVT3I EQU   NSSSVT3+6                                                03231000
@NM00005 EQU   NSSSVT3G                                                 03232000
NSSSVT3H EQU   NSSSVT3G                                                 03233000
NSSSVT3F EQU   NSSSVT3+4                                                03234000
NSSSVT3E EQU   NSSSVT3+3                                                03235000
@NM00004 EQU   NSSSVT3C                                                 03236000
NSSSVT3D EQU   NSSSVT3C                                                 03237000
NSSSVT3B EQU   NSSSVT3+1                                                03238000
NSSSVT3A EQU   NSSSVT3                                                  03239000
NSSSVT   EQU   NSSSVRU+2                                                03240000
NSSSVDAF EQU   NSSSVRU                                                  03241000
NSRUHKTY EQU   NSRUHOOK                                                 03242000
NSRURCD  EQU   NSRUNETS+2                                               03243000
NSRUSUB  EQU   NSRUNETS+1                                               03244000
NSRUID   EQU   NSRUNETS                                                 03245000
SRURSV01 EQU   SRULDID+4                                                03246000
SRUPSSN  EQU   SRULDID+2                                                03247000
SRUDFCLV EQU   SRUSPSN                                                  03248000
@NM00003 EQU   SRUTYPE                                                  03249000
SRUPSAC  EQU   SRUTYPE                                                  03250000
SRUSPAC  EQU   SRUTYPE                                                  03251000
SRUQSREQ EQU   ISTSRU                                                   03252000
SENRU    EQU   ISTSENRU+4                                               03253000
SRUSNS4  EQU   SRUSENS2+1                                               03254000
SRUSNS3  EQU   SRUSENS2                                                 03255000
SRUSNST  EQU   SRUSENS1+1                                               03256000
SRUSNS1  EQU   SRUSENS1                                                 03257000
@NM00114 EQU   SMSLAST+57                                               03258000
@NM00113 EQU   SMSLAST+39                                               03259000
@NM00112 EQU   SMSLAST+21                                               03260000
@NM00111 EQU   SMSLAST                                                  03261000
@NM00110 EQU   SMSSECND+75                                              03262000
@NM00109 EQU   SMSSECND+57                                              03263000
@NM00108 EQU   SMSSECND+39                                              03264000
@NM00107 EQU   SMSSECND+21                                              03265000
@NM00106 EQU   SMSSECND                                                 03266000
@NM00105 EQU   SMSFIRST+75                                              03267000
@NM00104 EQU   SMSFIRST+57                                              03268000
@NM00103 EQU   SMSFIRST+39                                              03269000
@NM00102 EQU   SMSFIRST+21                                              03270000
@NM00101 EQU   SMSFIRST                                                 03271000
@NM00100 EQU   SMSHDRER+72                                              03272000
@NM00099 EQU   SMSHDRER+54                                              03273000
@NM00098 EQU   SMSHDRER+36                                              03274000
@NM00097 EQU   SMSHDRER+16                                              03275000
@NM00096 EQU   SMSHDRER+8                                               03276000
@NM00095 EQU   SMSHDRER                                                 03277000
@NM00094 EQU   HEXFLGS                                                  03278000
@NM00093 EQU   TEXTBUF+77                                               03279000
@NM00092 EQU   TEXTBUF                                                  03280000
@NM00091 EQU   LLABEL1                                                  03281000
LNTHRH   EQU   LNINPUT+48                                               03282000
LNFSB    EQU   LNINPUT+16                                               03283000
LNLNG    EQU   LNINPUT+14                                               03284000
LNRSVD   EQU   LNINPUT+12                                               03285000
LNFDB    EQU   LNINPUT                                                  03286000
LNSCNTL  EQU   LNBUF2S+87                                               03287000
@NM00090 EQU   LNBUF2S+81                                               03288000
LNSADDR  EQU   LNBUF2S+79                                               03289000
@NM00089 EQU   LNBUF2S+73                                               03290000
LNSTIME  EQU   LNBUF2S+71                                               03291000
@NM00088 EQU   LNBUF2S+65                                               03292000
LNSSTAT2 EQU   LNBUF2S+63                                               03293000
@NM00087 EQU   LNBUF2S+56                                               03294000
LNSSTAT1 EQU   LNBUF2S+54                                               03295000
@NM00086 EQU   LNBUF2S+47                                               03296000
LNSEPCF  EQU   LNBUF2S+45                                               03297000
@NM00085 EQU   LNBUF2S+39                                               03298000
@NM00084 EQU   LNBUF2S+33                                               03299000
@NM00083 EQU   LNBUF2S+26                                               03300000
LNSSCF   EQU   LNBUF2S+24                                               03301000
@NM00082 EQU   LNBUF2S                                                  03302000
@NM00081 EQU   LN2SECND+10                                              03303000
LN2PCFL2 EQU   LN2SECND+7                                               03304000
@NM00080 EQU   LN2SECND+6                                               03305000
LN2LCDD2 EQU   LN2SECND+4                                               03306000
@NM00079 EQU   LN2SECND+3                                               03307000
LN2LCDL2 EQU   LN2SECND                                                 03308000
@NM00078 EQU   LNBUF2+57                                                03309000
@NM00077 EQU   LN2FIRST+10                                              03310000
LN2PCFL1 EQU   LN2FIRST+7                                               03311000
@NM00076 EQU   LN2FIRST+6                                               03312000
LN2LCDD1 EQU   LN2FIRST+4                                               03313000
@NM00075 EQU   LN2FIRST+3                                               03314000
LN2LCDL1 EQU   LN2FIRST                                                 03315000
@NM00074 EQU   LNBUF2                                                   03316000
@NM00073 EQU   LNFRST+50                                                03317000
LNTMDAT  EQU   LNFRST+48                                                03318000
@NM00072 EQU   LNFRST+47                                                03319000
@NM00071 EQU   LNFRST+36                                                03320000
LNEPDAT  EQU   LNFRST+34                                                03321000
@NM00070 EQU   LNFRST+33                                                03322000
@NM00069 EQU   LNFRST+25                                                03323000
@NM00068 EQU   LNFRST+16                                                03324000
@NM00067 EQU   LNFRST+5                                                 03325000
@NM00066 EQU   LNFRST                                                   03326000
TPTXTDAT EQU   TPTXT+33                                                 03327000
@NM00065 EQU   TPTXT+32                                                 03328000
@NM00064 EQU   TPTXT                                                    03329000
TPROFID0 EQU   TPROTHD+29                                               03330000
TPROFID1 EQU   TPROTHD                                                  03331000
@NM00063 EQU   TPRO2+32                                                 03332000
@NM00062 EQU   TPRO2+25                                                 03333000
@NM00061 EQU   TPRO2+16                                                 03334000
@NM00060 EQU   TPRO2+9                                                  03335000
@NM00059 EQU   TPRO2                                                    03336000
TPRIFID1 EQU   TPRITHD                                                  03337000
@NM00058 EQU   TPRI3+32                                                 03338000
@NM00057 EQU   TPRI3                                                    03339000
TPRIFSBD EQU   TPRI2+33                                                 03340000
@NM00056 EQU   TPRI2+31                                                 03341000
@NM00055 EQU   TPRI2+25                                                 03342000
@NM00054 EQU   TPRI2+16                                                 03343000
@NM00053 EQU   TPRI2+9                                                  03344000
@NM00052 EQU   TPRI2                                                    03345000
@NM00051 EQU   TPLOC3                                                   03346000
@NM00050 EQU   TPLOC2+25                                                03347000
@NM00049 EQU   TPLOC2+16                                                03348000
@NM00048 EQU   TPLOC2+8                                                 03349000
@NM00047 EQU   TPLOC2                                                   03350000
@NM00046 EQU   TPRSVLNG+21                                              03351000
TPLNG2DT EQU   TPRSVLNG+17                                              03352000
@NM00045 EQU   TPRSVLNG+16                                              03353000
@NM00044 EQU   TPRSVLNG+9                                               03354000
RSVDAT   EQU   TPRSVLNG+5                                               03355000
@NM00043 EQU   TPRSVLNG+4                                               03356000
@NM00042 EQU   TPFIRST+59                                               03357000
TPFDBDAT EQU   TPFIRST+33                                               03358000
@NM00041 EQU   TPFIRST+31                                               03359000
@NM00040 EQU   TPFIRST+25                                               03360000
@NM00039 EQU   TPFIRST+16                                               03361000
@NM00038 EQU   TPFIRST+10                                               03362000
@NM00037 EQU   TPFIRST+6                                                03363000
@NM00036 EQU   TPFIRST                                                  03364000
@NM00035 EQU   CLSECOND+16                                              03365000
@NM00034 EQU   CLSECOND                                                 03366000
@NM00033 EQU   CLFIRST+25                                               03367000
@NM00032 EQU   CLFIRST+16                                               03368000
@NM00031 EQU   CLFIRST+9                                                03369000
@NM00030 EQU   CLFIRST+4                                                03370000
@NM00029 EQU   CLFIRST                                                  03371000
FMTPLST  EQU   FMTAPPLS+28                                              03372000
FMTRTNAD EQU   FMTAPPLS+20                                              03373000
GTFOPTS  EQU   FMTAPPLS+8                                               03374000
@NM00028 EQU   HISSAVE                                                  03375000
@NM00027 EQU   MYSAVE                                                   03376000
@NM00026 EQU   BLKHDR                                                   03377000
@NM00025 EQU   SWITCHES                                                 03378000
TRARSV05 EQU   ISTTRAC+30                                               03379000
TRALRC   EQU   ISTTRAC+28                                               03380000
TRATIME  EQU   ISTTRAC+24                                               03381000
TRARSV04 EQU   TRADNODE+4                                               03382000
TRADAF   EQU   TRACID+2                                                 03383000
TRASAF   EQU   TRACID                                                   03384000
TRASEN   EQU   TRAFLG2                                                  03385000
TRAMPX   EQU   TRAFLG2                                                  03386000
TRADEV   EQU   TRAFLG2                                                  03387000
TRABDU   EQU   TRAFLG2                                                  03388000
TRAESTAT EQU   TRAFLG2                                                  03389000
TRAPIU   EQU   TRAFLG2                                                  03390000
TRARSV02 EQU   TRAFLG                                                   03391000
TRAANODF EQU   TRAFLG                                                   03392000
TRADNODF EQU   TRAFLG                                                   03393000
TRABF    EQU   TRAFLG                                                   03394000
TRAIO    EQU   TRAFLG                                                   03395000
TRAPRTU  EQU   TRAFLG                                                   03396000
TRAFRST  EQU   TRAFLG                                                   03397000
TRACONT  EQU   TRAFLG                                                   03398000
TRABDWR  EQU   TRABDW+2                                                 03399000
TRABDWL  EQU   TRABDW                                                   03400000
TRACHAIN EQU   ISTTRAC+4                                                03401000
TRARSV01 EQU   TRA1WORD+2                                               03402000
TRALNG   EQU   TRA1WORD+1                                               03403000
TRATYPE  EQU   TRA1WORD                                                 03404000
ZLBLNG1  EQU   ZLBFSM                                                   03405000
ZLBCHAIN EQU   ISTZLBUF                                                 03406000
ZOBLNG1  EQU   ZOBFSM                                                   03407000
ZOBCHAIN EQU   ISTZOBUF                                                 03408000
ZIBLNG1  EQU   ZIBFSM                                                   03409000
ZIBCHAIN EQU   ISTZIBUF                                                 03410000
FSBFDB   EQU   ISTFSB+32                                                03411000
FSBRSV01 EQU   FSBFSB+30                                                03412000
FSBTHCNT EQU   FSBFSB+28                                                03413000
FSBRLRSV EQU   FSBRLSTS                                                 03414000
FSBCFTX  EQU   FSBRLSTS                                                 03415000
FSBICNCB EQU   FSBMSGID                                                 03416000
FSBSSOC  EQU   FSBSS2                                                   03417000
FSBSSCC  EQU   FSBSS2                                                   03418000
FSBSSDC  EQU   FSBSS2                                                   03419000
FSBSSEC  EQU   FSBSS2                                                   03420000
FSBSSIR  EQU   FSBSS2                                                   03421000
FSBSSCR  EQU   FSBSS2                                                   03422000
@NM00012 EQU   FSBSS2                                                   03423000
@NM00011 EQU   FSBSS1                                                   03424000
FSBSSDE  EQU   FSBSS1                                                   03425000
FSBSSUS  EQU   FSBSS1                                                   03426000
@NM00010 EQU   FSBSS1                                                   03427000
FSBSOHI  EQU   FSBERC                                                   03428000
FSBLGI   EQU   FSBERC                                                   03429000
FSBLMRI  EQU   FSBFBMI                                                  03430000
FSBETI   EQU   FSBERC                                                   03431000
FSBEMI   EQU   FSBERC                                                   03432000
FSBEBI   EQU   FSBERC                                                   03433000
FSBECI   EQU   FSBERC                                                   03434000
FSBELI   EQU   FSBERC                                                   03435000
FSBMJRCD EQU   FSBSRCAT                                                 03436000
FSBXLCI  EQU   FSBXCODE                                                 03437000
FSBXFINS EQU   FSBXCODE                                                 03438000
FSBXNORM EQU   FSBXFSTS                                                 03439000
FSBSCODE EQU   FSBSYSRS                                                 03440000
FSBSPHSE EQU   FSBSYSRS                                                 03441000
FSBSERR  EQU   FSBSYSRS                                                 03442000
FSBCMD   EQU   FSBSEQ                                                   03443000
FSBDTRCE EQU   FSBFLAGS                                                 03444000
FSBASBTU EQU   FSBFLAGS                                                 03445000
FSBINPET EQU   FSBFLAGS                                                 03446000
FSBNONCB EQU   FSBFLAGS                                                 03447000
FSBLBIND EQU   FSBFLAGS                                                 03448000
FSBFFIND EQU   FSBFLAGS                                                 03449000
FSBACIND EQU   FSBFLAGS                                                 03450000
FSBRFIND EQU   FSBFLAGS                                                 03451000
FSBDAF   EQU   FSBCID+2                                                 03452000
FSBSAF   EQU   FSBCID                                                   03453000
FSBGATE  EQU   FSBFSBA                                                  03454000
FSBRSV02 EQU   FSBSFLGS                                                 03455000
FSBPGBUF EQU   FSBSFLGS                                                 03456000
FSBMNSDA EQU   FSBMNRCD                                                 03457000
FSBMNOA  EQU   FSBMNRCD                                                 03458000
FSBMNDIF EQU   FSBMNRCD                                                 03459000
FSBMNEOP EQU   FSBMNRCD                                                 03460000
FSBMNDNU EQU   FSBMNRCD                                                 03461000
FSBMNATN EQU   FSBMNRCD                                                 03462000
FSBMNRVI EQU   FSBMNRCD                                                 03463000
FSBMNELI EQU   FSBMNRCD                                                 03464000
FSBLNGTH EQU   FSBFSB+1                                                 03465000
FSBTYPE  EQU   FSBFSB                                                   03466000
BTUEXTR  EQU   ISTBTU+19                                                03467000
BTURSV02 EQU   BTUSYSTR                                                 03468000
BTUPHASE EQU   BTUSYSTR                                                 03469000
BTURSV01 EQU   BTUSYSTR                                                 03470000
BTUBDU   EQU   ISTBTU+14                                                03471000
BTURH3   EQU   BTURH+2                                                  03472000
BTURH2   EQU   BTURH+1                                                  03473000
BTURH1   EQU   BTURH                                                    03474000
BTUDCF   EQU   BTUBTH+8                                                 03475000
BTUZRTSC EQU   BTURQFLG+1                                               03476000
BTUZRT0B EQU   BTURQFLG+1                                               03477000
BTUZRT0A EQU   BTURQFLG+1                                               03478000
BTUZRT09 EQU   BTURQFLG+1                                               03479000
BTUZRT08 EQU   BTURQFLG+1                                               03480000
BTUZRT07 EQU   BTURQFLG                                                 03481000
BTUZRT06 EQU   BTURQFLG                                                 03482000
BTUZRT05 EQU   BTURQFLG                                                 03483000
BTUZRT04 EQU   BTURQFLG                                                 03484000
BTUZRT03 EQU   BTURQFLG                                                 03485000
BTUZRT02 EQU   BTURQFLG                                                 03486000
BTUZRT01 EQU   BTURQFLG                                                 03487000
BTUZRT00 EQU   BTURQFLG                                                 03488000
BTUSORCE EQU   BTUBTH+4                                                 03489000
BTUDEST  EQU   BTUBTH+2                                                 03490000
BTUCDF   EQU   BTUFID+1                                                 03491000
BTUSCF   EQU   BTUFID+1                                                 03492000
BTUPRY   EQU   BTUFID+1                                                 03493000
BTUASFL  EQU   BTUFID                                                   03494000
BTUPSFL  EQU   BTUFID                                                   03495000
BTUMPF   EQU   BTUFID                                                   03496000
TH2SNF   EQU   ISTTH2+4                                                 03497000
TH2OAF   EQU   ISTTH2+3                                                 03498000
TH2DAF   EQU   ISTTH2+2                                                 03499000
TH2CDF   EQU   TH2FLAG1+1                                               03500000
TH2SEF   EQU   TH2FLAG1+1                                               03501000
TH2PYF   EQU   TH2FLAG1+1                                               03502000
TH2AFI   EQU   TH2FLAG1                                                 03503000
TH2PSI   EQU   TH2FLAG1                                                 03504000
TH2CMPLI EQU   TH2MPF                                                   03505000
TH2RHI   EQU   TH2MPF                                                   03506000
TH2FID   EQU   TH2FLAG1                                                 03507000
THDCF    EQU   ISTTH+8                                                  03508000
THSNF    EQU   ISTTH+6                                                  03509000
THOAF    EQU   ISTTH+4                                                  03510000
THDAF    EQU   ISTTH+2                                                  03511000
THCDF    EQU   THFLGB                                                   03512000
THSEF    EQU   THFLGB                                                   03513000
THPYF    EQU   THFLGB                                                   03514000
THAFI    EQU   THFLGA                                                   03515000
THPSI    EQU   THFLGA                                                   03516000
THCMPLI  EQU   THMPF                                                    03517000
THRHI    EQU   THMPF                                                    03518000
THFID    EQU   THFLAG1                                                  03519000
LHVDATA  EQU   ISTLH+4                                                  03520000
LHFUNCT  EQU   ISTLH+3                                                  03521000
@NM00009 EQU   ISTLH+2                                                  03522000
LHLEN    EQU   ISTLH                                                    03523000
FDBOFSET EQU   ISTFDB+10                                                03524000
FDBDATCT EQU   ISTFDB+8                                                 03525000
FDBDATAA EQU   ISTFDB+4                                                 03526000
FDBFDBA  EQU   ISTFDB                                                   03527000
BDURSV04 EQU   BDUFLAGS                                                 03528000
BDURTOE  EQU   BDUFLAGS                                                 03529000
BDUSTPR  EQU   BDUFLAGS                                                 03530000
BDURSV03 EQU   BDUFLAGS                                                 03531000
BDUALT   EQU   BDUFUNC                                                  03532000
BDUNACK  EQU   BDUFUNC                                                  03533000
BDUACK   EQU   BDUFUNC                                                  03534000
BDUTRPM  EQU   BDUFUNC                                                  03535000
BDUFBMI  EQU   BDUFUNC                                                  03536000
BDULDGPH EQU   BDUFUNC                                                  03537000
BDUHEADP EQU   BDUFUNC                                                  03538000
BDUSOH   EQU   BDUCHECK                                                 03539000
BDURSV01 EQU   BDUMODIF                                                 03540000
BDUMOD0  EQU   BDUMOD1                                                  03541000
BDUCOMND EQU   ISTBDU                                                   03542000
TRFRSV01 EQU   TRFFLG                                                   03543000
NSRUNA6  EQU   NSRUNA5                                                  03544000
RUBDATA  EQU   ISTRUB                                                   03545000
RHRSVD5  EQU   RH3                                                      03546000
RHRSVD4  EQU   RH3                                                      03547000
RHLOG    EQU   RH3                                                      03548000
RHRSVD3  EQU   RH3                                                      03549000
RHRCDIR  EQU   RH3                                                      03550000
RHCDIR   EQU   RH3                                                      03551000
RHEB     EQU   RH3                                                      03552000
RHBB     EQU   RH3                                                      03553000
RHPACE   EQU   RH2                                                      03554000
RHRSVD2  EQU   RH2                                                      03555000
RHINOP   EQU   RHRSVD1                                                  03556000
RHBUSY   EQU   RHRETRY                                                  03557000
RHEXCEPT EQU   RH2                                                      03558000
RHRRN    EQU   RH2                                                      03559000
RHPE     EQU   RH2                                                      03560000
RHFME    EQU   RH2                                                      03561000
RHCHAIN  EQU   RH1                                                      03562000
RHSENSE  EQU   RH1                                                      03563000
RHFORMAT EQU   RH1                                                      03564000
RHDIRI   EQU   RH1                                                      03565000
RHSCI    EQU   RH1                                                      03566000
RHTYPE   EQU   RH1                                                      03567000
RHQS     EQU   RH1                                                      03568000
@NM00002 EQU   SRBSECT+40                                               03569000
@NM00001 EQU   SRBSECT+38                                               03570000
SRBPRIOR EQU   SRBSECT+37                                               03571000
SRBPKF   EQU   SRBSECT+36                                               03572000
SRBSAVE  EQU   SRBSECT+32                                               03573000
SRBPARM  EQU   SRBSECT+28                                               03574000
SRBRMTR  EQU   SRBSECT+24                                               03575000
SRBEP    EQU   SRBSECT+20                                               03576000
SRBPTCB  EQU   SRBFLC+4                                                 03577000
SRBPASID EQU   SRBFLC+2                                                 03578000
SRBCPAFF EQU   SRBFLC                                                   03579000
SRBASCB  EQU   SRBSECT+8                                                03580000
SRBFLNK  EQU   SRBSECT+4                                                03581000
SRBID    EQU   SRBSECT                                                  03582000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      03583000
@RC00414 EQU   @RC00412                                                 03584000
@RC00451 EQU   AMDEXIT                                                  03585000
@RC00458 EQU   AMDEXIT                                                  03586000
@RC00476 EQU   AMDEXIT                                                  03587000
@RC00492 EQU   AMDEXIT                                                  03588000
@RC00578 EQU   AMDEXIT                                                  03589000
@RC00591 EQU   AMDEXIT                                                  03590000
@RC00610 EQU   AMDEXIT                                                  03591000
@RT00693 EQU   AMDEXIT                                                  03592000
@RF00693 EQU   AMDTPRTX                                                 03593000
@RC00703 EQU   AMDEXIT                                                  03594000
@RC00711 EQU   AMDEXIT                                                  03595000
@RC00709 EQU   AMDEXIT                                                  03596000
@RT00725 EQU   @EL00002                                                 03597000
@RF00730 EQU   @RC00727                                                 03598000
@RT00745 EQU   @EL00002                                                 03599000
@RT00780 EQU   @EL00003                                                 03600000
@RC00579 EQU   @RC00578                                                 03601000
@RC00592 EQU   @RC00591                                                 03602000
@ENDDATA EQU   *                                                        03603000
         END   AMDUSRFD,(C'PLS1717',0701,77035)                         03604000
