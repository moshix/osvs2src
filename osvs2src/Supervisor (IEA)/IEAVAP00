         TITLE 'IEAVAP00 - VOLUME ATTRIBUTE PROCESSING                 *00001000
                        '                                               00002000
IEAVAP00 CSECT ,                                                01S0001 00003000
@MAINENT DS    0H                                               01S0001 00004000
         USING *,@15                                            01S0001 00005000
         B     @PROLOG                                          01S0001 00006000
         DC    AL1(24)                                          01S0001 00007000
         DC    C'IEAVAP00 77046  UZ08471 '                      01S0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                  01S0001 00010000
         BALR  @12,0                                            01S0001 00011000
@PSTART  LA    @11,4095(,@12)                                   01S0001 00012000
         LA    @09,4095(,@11)                                   01S0001 00013000
         LA    @08,4095(,@09)                                   01S0001 00014000
         LA    @04,4095(,@08)                                   01S0001 00015000
         USING @PSTART,@12                                      01S0001 00016000
         USING @PSTART+4095,@11                                 01S0001 00017000
         USING @PSTART+8190,@09                                 01S0001 00018000
         USING @PSTART+12285,@08                                01S0001 00019000
         USING @PSTART+16380,@04                                01S0001 00020000
         ST    @13,@SA00001+4                                   01S0001 00021000
         LA    @14,@SA00001                                     01S0001 00022000
         ST    @14,8(,@13)                                      01S0001 00023000
         LR    @13,@14                                          01S0001 00024000
** REFS ARE GENERATED FOR NVT FIELDS THAT CONTAIN ADDRESSES OF          00025000
** NIP SERVICE ROUTINES, SO IEAPMNIP MACRO CALLS TO THESE ROUTINES      00026000
** WILL ASSEMBLE PROPERLY.                                              00027000
*CVTPTR = RCVT;                                                 01S0249 00028000
         ST    RCVT,CVTPTR                                      01S0249 00029000
*SWITCHES = ZERO;                      /* INITIALIZE SWITCHES TO OFF */ 00030000
         SLR   @10,@10                                          01S0250 00031000
         ST    @10,SWITCHES                                     01S0250 00032000
*BADADDR = ZEROADDR;                   /* INIT INVALID DEVICE PTR    */ 00033000
         MVC   BADADDR(3),ZEROADDR                              01S0251 00034000
*MTLSTCT = ZERO;                       /* INIT MNTLIST ENTRY COUNTER */ 00035000
         STH   @10,MTLSTCT                                      01S0252 00036000
*FINDADDR = ZERO;                      /* INIT PTR TO UCB (EBCDIC)   */ 00037000
         ST    @10,FINDADDR                                     01S0253 00038000
*DO;                                   /* INITIALIZE DA UCB'S        */ 00039000
*/********************************************************************/ 00040000
*/*                                                                  */ 00041000
*/* SEGMENT NAME - INITUCBS                                          */ 00042000
*/*                                                                  */ 00043000
*/* DESCRIPTIVE NAME - INITIALIZE P/R AND NOT-READY DIRECT           */ 00044000
*/*                    ACCESS UCB'S                                  */ 00045000
*/*                                                                  */ 00046000
*/* FUNCTION -                                                       */ 00047000
*/*                                                                  */ 00048000
*/*     SAVE LUT ADDR IN AREA NAMED 'LUTSAVE'. SET REGISTER 1 TO     */ 00049000
*/*     POINT TO THE LUT.  CALL 'IEFSCAN' TO OBTAIN UCB ADDRESS. IF  */ 00050000
*/*     UCB ADDRESS IS ZERO, ALL UCB'S HAVE BEEN SCANNED.  IF UCB    */ 00051000
*/*     ADDRESS IS NOT ZERO, SEE IF THE UCB IS FOR DA.  IF UCB IS    */ 00052000
*/*     FOR DA AND IS PERMANENTLY RESIDENT, SET USE STATUS TO PUBLIC.*/ 00053000
*/*     IF UCB IS FOR DA AND THERE IS NO VOLUME SERIAL NUMBER, TURN  */ 00054000
*/*     ON THE NOT-READY BIT.                                        */ 00055000
*/*                                                                  */ 00056000
*/*     OBTAIN NEXT UCB ADDRESS BY CALLING 'UCBCONT' WITH VALUE OF   */ 00057000
*/*     REGISTER 1 OBTAINED FROM 'LUTSAVE'.  PROCESS EACH UCB AS     */ 00058000
*/*     ABOVE.                                                       */ 00059000
*/*                                                                  */ 00060000
*/* ENTRY - IN-LINE SEGMENT                                          */ 00061000
*/*                                                                  */ 00062000
*/*     PURPOSE -                                                    */ 00063000
*/*                                                                  */ 00064000
*/*         SET UCB USE STATUS OF ALL VOLUMES THAT HAVE BEEN MARKED  */ 00065000
*/*         PERMANENTLY RESIDENT BY PREVIOUS NIP PROCESSING TO       */ 00066000
*/*         PUBLIC; SET A NOT-READY DEVICE STATUS IN ALL DIRECT      */ 00067000
*/*         ACCESS UCB'S THAT DO NOT CONTAIN VOLUME SERIAL NUMBERS.  */ 00068000
*/*                                                                  */ 00069000
*/*     INPUT DATA -                                                 */ 00070000
*/*                                                                  */ 00071000
*/*         CVTILK2 TO OBTAIN ADDRESS OF LUT                         */ 00072000
*/*                                                                  */ 00073000
*/* EXITS -                                                          */ 00074000
*/*                                                                  */ 00075000
*/*     CONDITION - ALL UCB'S SCANNED                                */ 00076000
*/*                                                                  */ 00077000
*/*     OUTPUT DATA -                                                */ 00078000
*/*                                                                  */ 00079000
*/*         UCB'S - MODIFIED                                         */ 00080000
*/*                                                                  */ 00081000
*/*     RETURN CODE - NONE                                           */ 00082000
*/*                                                                  */ 00083000
*/********************************************************************/ 00084000
*                                                               02S0255 00085000
*LUTSAVE = CVTILK2;                    /*OBTAIN ADDR OF LOOK UP TABLE*/ 00086000
         L     @10,CVTPTR                                       02S0255 00087000
         L     @10,CVTILK2(,@10)                                02S0255 00088000
         ST    @10,LUTSAVE                                      02S0255 00089000
*RFY RPARM RSTD;                                                02S0256 00090000
*RPARM = LUTSAVE;                      /*MOVE LUT ADDR INTO PARM REG */ 00091000
         LR    RPARM,@10                                        02S0257 00092000
*CALL IEFSCAN;                         /*OBTAIN UCB ADDRESS          */ 00093000
         L     @15,@CV00229                                     02S0258 00094000
         BALR  @14,@15                                          02S0258 00095000
*UCBPTR = RPARM;                       /*SAVE ADDRESS OF UCB         */ 00096000
         ST    RPARM,UCBPTR                                     02S0259 00097000
*RFY RPARM UNRSTD;                                              02S0260 00098000
*                                                               02S0260 00099000
*DO WHILE (UCBPTR ^= ZERO);            /*PROCESS UCBS - ZERO UCB ADDR   00100000
*                                        INDICATES END OF UCBS       */ 00101000
         B     @DE00261                                         02S0261 00102000
@DL00261 DS    0H                                               02S0262 00103000
*IF UCB3DACC = YES                     /*IS UCB DIRECT ACCESS?       */ 00104000
*  THEN DO;                                                     02S0262 00105000
         L     @10,UCBPTR                                       02S0262 00106000
         TM    UCB3DACC(@10),B'00100000'                        02S0262 00107000
         BNO   @RF00262                                         02S0262 00108000
*    IF UCBPRES = YES                  /*IS IT PERMANENTLY RESIDENT? */ 00109000
*      THEN DO;                                                 02S0264 00110000
         TM    UCBPRES(@10),B'00000100'                         02S0264 00111000
         BNO   @RF00264                                         02S0264 00112000
*        UCBBPUB = YES;                /*TURN ON PUBLIC BIT          */ 00113000
         OI    UCBBPUB(@10),B'00001000'                         02S0266 00114000
*      END;                                                     02S0267 00115000
*    IF UCBVOLI = ZEROVOLI             /*IF NO VOL SER IN THIS UCB,  */ 00116000
*      THEN DO;                        /*AND IT IS MULTIPLE  @YM02792*/ 00117000
@RF00264 L     @10,UCBPTR                                       02S0268 00118000
         CLC   UCBVOLI(6,@10),ZEROVOLI                          02S0268 00119000
         BNE   @RF00268                                         02S0268 00120000
*        IF UCBMTPXP = YES             /*EXPOSURE DEVICE,    @YM02792*/ 00121000
*          THEN DO;                    /*SET NOT-READY IN    @YM02792*/ 00122000
         TM    UCBMTPXP(@10),B'00001000'                        02S0270 00123000
         BNO   @RF00270                                         02S0270 00124000
*            IF (UCBBASE + ADJBASE) = UCBPTR               /*@YM02792*/ 00125000
*              THEN UCBNOTRD = YES;    /*BASE EXPOSURE;      @YM02792*/ 00126000
         LA    @05,512                                          02S0272 00127000
         AL    @05,UCBBASE(,@10)                                02S0272 00128000
         CR    @05,@10                                          02S0272 00129000
         BNE   @RF00272                                         02S0272 00130000
         OI    UCBNOTRD(@10),B'01000000'                        02S0273 00131000
*          END;                                            /*@YM02792*/ 00132000
*          ELSE DO;                                        /*@YM02792*/ 00133000
         B     @RC00270                                         02S0275 00134000
@RF00270 DS    0H                                               02S0276 00135000
*            UCBNOTRD = YES;           /*TURN ON NOT RDY BIT @YM02792*/ 00136000
         L     @10,UCBPTR                                       02S0276 00137000
         OI    UCBNOTRD(@10),B'01000000'                        02S0276 00138000
*          END;                        /*FOR OTHER DA DEVICES@YM02792*/ 00139000
*      END;                                                /*@YM02792*/ 00140000
@RC00270 DS    0H                                               02S0279 00141000
*  END;                                                         02S0279 00142000
*                                                               02S0279 00143000
@RF00268 DS    0H                                               02S0280 00144000
*RFY RPARM RSTD;                                                02S0280 00145000
@RF00262 DS    0H                                               02S0281 00146000
*RPARM = LUTSAVE;                      /*MOVE LUT ADDR INTO PARM REG */ 00147000
         L     RPARM,LUTSAVE                                    02S0281 00148000
*CALL UCBCONT;                         /*OBTAIN NEXT UCB ADDRESS     */ 00149000
         L     @15,@CV00230                                     02S0282 00150000
         BALR  @14,@15                                          02S0282 00151000
*UCBPTR = RPARM;                       /*SAVE ADDR OF UCB            */ 00152000
         ST    RPARM,UCBPTR                                     02S0283 00153000
*RFY RPARM UNRSTD;                                              02S0284 00154000
*END;                                  /*RETURN TO TOP SEGMENT       */ 00155000
@DE00261 L     @10,UCBPTR                                       02S0285 00156000
         LTR   @10,@10                                          02S0285 00157000
         BNZ   @DL00261                                         02S0285 00158000
*END;                                                           01S0286 00159000
*DO;                                   /* PROCESS SYSTEM PARAMETERS  */ 00160000
*/********************************************************************/ 00161000
*/*                                                                  */ 00162000
*/* SEGMENT NAME - CKPARMS                                           */ 00163000
*/*                                                                  */ 00164000
*/* DESCRIPTIVE NAME - VALIDITY CHECK VAL PARAMETER LIST             */ 00165000
*/*                                                                  */ 00166000
*/* FUNCTION -                                                       */ 00167000
*/*                                                                  */ 00168000
*/*     SET 'PEND' SWITCH EQUAL TO NO, TO INDICATE PARAMETERS EXIST. */ 00169000
*/*     IF 'PARMPTR' IS ZERO, THEN SET 'DEFAULT' SWITCH TO YES.      */ 00170000
*/*     OTHERWISE, REMOVE PARENTHESIS IF NECESSARY AND CHECK PARA-   */ 00171000
*/*     METER LIST FOR TWO DIGITS SEPARATED BY COMMAS.  IF NOT VALID,*/ 00172000
*/*     ISSUE NIP PROMPT MACRO FOR VAL.  VALIDITY CHECK REPLY.       */ 00173000
*/*                                                                  */ 00174000
*/* ENTRY - IN-LINE SEGMENT                                          */ 00175000
*/*                                                                  */ 00176000
*/*     PURPOSE -                                                    */ 00177000
*/*                                                                  */ 00178000
*/*         VALIDITY CHECK VAL PARAMETER LIST FOR TWO DIGITS SEPARAT-*/ 00179000
*/*         ED BY COMMAS.  IF NO PARAMETERS, SET 'DEFAULT' SWITCH.   */ 00180000
*/*                                                                  */ 00181000
*/*     INPUT DATA -                                                 */ 00182000
*/*                                                                  */ 00183000
*/*         VAL - ADDRESS OF VAL PARAMETERS                          */ 00184000
*/*                                                                  */ 00185000
*/* EXITS -                                                          */ 00186000
*/*                                                                  */ 00187000
*/*     CONDITION - VALID PARAMETER LIST                             */ 00188000
*/*                                                                  */ 00189000
*/*     OUTPUT DATA -                                                */ 00190000
*/*                                                                  */ 00191000
*/*         PEND - SET TO NO                                         */ 00192000
*/*                                                                  */ 00193000
*/*     CONDITION - NO PARAMETER LIST SPECIFIED                      */ 00194000
*/*                                                                  */ 00195000
*/*     OUTPUT DATA -                                                */ 00196000
*/*                                                                  */ 00197000
*/*         DEFAULT - SET TO YES                                     */ 00198000
*/*         PEND - SET TO NO                                         */ 00199000
*/*                                                                  */ 00200000
*/*     RETURN CODE - NONE                                           */ 00201000
*/*                                                                  */ 00202000
*/********************************************************************/ 00203000
*                                                               02S0288 00204000
*PLIBMEM = READVAT;                    /*MOVE 'VATLST' INTO READ AREA*/ 00205000
         L     @10,NVTPAREA(,RNVT)                              02S0288 00206000
         MVC   PLIBMEM(6,@10),@CC00142                          02S0288 00207000
*PEND = NO;                            /*INDICATE PARAMETERS EXIST   */ 00208000
*RFY PARMTAB BASED(NVTPTAB);           /*SET ADDR OF VAL PARAMETERS  */ 00209000
*BADVAL = YES;                         /*INCORRECT VAL FORMAT FOR    */ 00210000
         OI    BADVAL,B'00000001'                               02S0291 00211000
         NI    PEND,B'10111111'                                 02S0291 00212000
*                                      /*LOOP ENTRY.                 */ 00213000
*DO WHILE (BADVAL = YES);              /*VALIDITY CHECK VAL PARAMETERS  00214000
*                                        IF FORMAT IS WRONG, OBTAIN     00215000
*                                        NEW VAL FROM OPERATOR AND      00216000
*                                        CHECK FORMAT OF THESE       */ 00217000
         B     @DE00292                                         02S0292 00218000
@DL00292 DS    0H                                               02S0293 00219000
*BADVAL = NO;                          /*RESET SWITCH -CORRECT FORMAT*/ 00220000
         NI    BADVAL,B'11111110'                               02S0293 00221000
*PARMPTR = VAL;                        /*OBTAIN VAL PARAMETER ADDRESS*/ 00222000
*                                                               02S0294 00223000
         L     @10,NVTPTAB(,RNVT)                               02S0294 00224000
         L     @10,VAL(,@10)                                    02S0294 00225000
         ST    @10,PARMPTR                                      02S0294 00226000
*IF PARMPTR = ZERO                     /*IF NO, CHECK VAL PARM ADDR  */ 00227000
*  THEN DEFAULT = YES;                 /*SET SWITCH FOR DEFAULT 02S0295 00228000
*                                        VATLST                      */ 00229000
         LTR   @10,@10                                          02S0295 00230000
         BNZ   @RF00295                                         02S0295 00231000
         OI    DEFAULT,B'10000000'                              02S0296 00232000
*  ELSE DO;                            /*VAL PARAMETER EXISTS        */ 00233000
         B     @RC00295                                         02S0297 00234000
@RF00295 DS    0H                                               02S0298 00235000
*    J = 0;                                                     02S0298 00236000
         SLR   @10,@10                                          02S0298 00237000
         STH   @10,J                                            02S0298 00238000
*    LOOPSW = NO;                                               02S0299 00239000
         NI    LOOPSW,B'11101111'                               02S0299 00240000
*    DO WHILE LOOPSW = NO;            /*LOCATE END OF PARAMETERS -      00241000
*                                        INDICATED BY A QUOTE        */ 00242000
         B     @DE00300                                         02S0300 00243000
@DL00300 DS    0H                                               02S0301 00244000
*      J = J + 1;                                               02S0301 00245000
         LA    @10,1                                            02S0301 00246000
         AH    @10,J                                            02S0301 00247000
         STH   @10,J                                            02S0301 00248000
*      IF VATPARMS(J) = QUOTE                                   02S0302 00249000
*        THEN LOOPSW = YES;                                     02S0302 00250000
         L     @05,PARMPTR                                      02S0302 00251000
         ALR   @05,@10                                          02S0302 00252000
         BCTR  @05,0                                            02S0302 00253000
         CLI   VATPARMS(@05),C''''                              02S0302 00254000
         BNE   @RF00302                                         02S0302 00255000
         OI    LOOPSW,B'00010000'                               02S0303 00256000
*    END;                                                       02S0304 00257000
@RF00302 DS    0H                                               02S0304 00258000
@DE00300 TM    LOOPSW,B'00010000'                               02S0304 00259000
         BZ    @DL00300                                         02S0304 00260000
*    IF VATPARMS(ONE) = LFTPAREN       /*REMOVE PARENTHESIS          */ 00261000
*      THEN DO;                                                 02S0305 00262000
         L     @10,PARMPTR                                      02S0305 00263000
         CLI   VATPARMS(@10),C'('                               02S0305 00264000
         BNE   @RF00305                                         02S0305 00265000
*        VATPARMS(J-1) = QUOTE;                                 02S0307 00266000
         LH    @05,J                                            02S0307 00267000
         ALR   @05,@10                                          02S0307 00268000
         BCTR  @05,0                                            02S0307 00269000
         BCTR  @05,0                                            02S0307 00270000
         MVI   VATPARMS(@05),C''''                              02S0307 00271000
*        J = J - TWO;                                           02S0308 00272000
         LH    @05,J                                            02S0308 00273000
         BCTR  @05,0                                            02S0308 00274000
         BCTR  @05,0                                            02S0308 00275000
         STH   @05,J                                            02S0308 00276000
*        PARMPTR = PARMPTR + ONE;                               02S0309 00277000
         AH    @10,@CH00042                                     02S0309 00278000
         ST    @10,PARMPTR                                      02S0309 00279000
*      END;                                                     02S0310 00280000
*    IF J // 3 ^= ZERO                 /*QUOTE IN WRONG POSITION     */ 00281000
*      THEN BADVAL=YES;                                         02S0311 00282000
@RF00305 LH    @00,J                                            02S0311 00283000
         SRDA  @00,32                                           02S0311 00284000
         D     @00,@CF00064                                     02S0311 00285000
         LTR   @00,@00                                          02S0311 00286000
         BZ    @RF00311                                         02S0311 00287000
         OI    BADVAL,B'00000001'                               02S0312 00288000
*    DO K = THREE TO J BY THREE        /*SCAN REPLY                  */ 00289000
*       WHILE (BADVAL=NO);                                      02S0313 00290000
@RF00311 LA    @10,3                                            02S0313 00291000
         STH   @10,K                                            02S0313 00292000
         B     @DE00313                                         02S0313 00293000
@DL00313 TM    BADVAL,B'00000001'                               02S0313 00294000
         BNZ   @DC00313                                         02S0313 00295000
*      IF VATPARMS(K) ^= COMMA         /*CHECK FOR ,                 */ 00296000
*        & VATPARMS(K) ^= QUOTE        /*  OR '                      */ 00297000
*        THEN BADVAL=YES;              /*INDICATE ERROR              */ 00298000
         L     @05,PARMPTR                                      02S0314 00299000
         ALR   @10,@05                                          02S0314 00300000
         BCTR  @10,0                                            02S0314 00301000
         CLI   VATPARMS(@10),C','                               02S0314 00302000
         BE    @RF00314                                         02S0314 00303000
         LH    @10,K                                            02S0314 00304000
         ALR   @05,@10                                          02S0314 00305000
         BCTR  @05,0                                            02S0314 00306000
         CLI   VATPARMS(@05),C''''                              02S0314 00307000
         BE    @RF00314                                         02S0314 00308000
         OI    BADVAL,B'00000001'                               02S0315 00309000
*    END;                                                       02S0316 00310000
@RF00314 LA    @10,3                                            02S0316 00311000
         AH    @10,K                                            02S0316 00312000
         STH   @10,K                                            02S0316 00313000
@DE00313 CH    @10,J                                            02S0316 00314000
         BNH   @DL00313                                         02S0316 00315000
@DC00313 DS    0H                                               02S0317 00316000
*    IF BADVAL = YES                   /*INCORRECT PARAMETER FORMAT  */ 00317000
*      THEN DO;                                                 02S0317 00318000
         TM    BADVAL,B'00000001'                               02S0317 00319000
         BNO   @RF00317                                         02S0317 00320000
*        GEN REFS(NVTPRMPT,PROMPT);   /*PROMPT OP FOR CORRECT PARAMS */ 00321000
         IEAPMNIP TYPE=PRMPT,PARAM=PROMPT,OPT=ERROR                     00322000
*        PROMPT OPERATOR FOR NEW VAL PARAMETERS                         00323000
*      END;                                                     02S0320 00324000
*  END;                                                         02S0321 00325000
@RF00317 DS    0H                                               02S0322 00326000
*END;                                 /*RETURN TO TOP SEGMENT.       */ 00327000
@RC00295 DS    0H                                               02S0322 00328000
@DE00292 TM    BADVAL,B'00000001'                               02S0322 00329000
         BO    @DL00292                                         02S0322 00330000
*END;                                                           01S0323 00331000
*NIPPAFL1 = YES;                       /* SUPPRESS 'MEMBER NOT FOUND'*/ 00332000
         L     @10,NVTPTAB(,RNVT)                               01S0324 00333000
         OI    NIPPAFL1(@10),B'10000000'                        01S0324 00334000
*                                      /* MESSAGE FROM READ          */ 00335000
*DO WHILE PEND = NO;                   /* PROCESS VATLST ENTRIES.    */ 00336000
         B     @DE00325                                         01S0325 00337000
@DL00325 DS    0H                                               01S0326 00338000
*/********************************************************************/ 00339000
*/*                                                                  */ 00340000
*/* SEGMENT NAME - SYSPARMS                                          */ 00341000
*/*                                                                  */ 00342000
*/* DESCRIPTIVE NAME - OBTAIN VATLST MEMBER NUMBER                   */ 00343000
*/*                                                                  */ 00344000
*/* FUNCTION -                                                       */ 00345000
*/*                                                                  */ 00346000
*/*     SET 'READ' SWITCH EQUAL TO YES, TO INDICATE THIS VATLST      */ 00347000
*/*     MEMBER HAS NOT BEEN READ YET.                                */ 00348000
*/*                                                                  */ 00349000
*/*     IF 'DEFAULT' SWITCH EQUALS YES, THEN SET 'PEND' SWITCH TO    */ 00350000
*/*     YES, AND MOVE '00' INTO NIPPANAM+6.  OTHERWISE, 'PARMPTR'    */ 00351000
*/*     CONTAINS ADDRESS OF FIRST VATLST MEMBER NUMBER IN            */ 00352000
*/*     SYSTEM PARAMETER AREA.  MOVE TWO DIGITS INTO NIPPANAM+6.     */ 00353000
*/*                                                                  */ 00354000
*/*     SEE IF CHARACTER FOLLOWING MEMBER NUMBER IS A COMMA.         */ 00355000
*/*     IF IT IS, THEN THERE  IS MORE THAN ONE VATLST; UPDATE        */ 00356000
*/*     'PARMPTR' TO POINT TO NEXT PARAMETER. IF CHARACTER IS NOT    */ 00357000
*/*     A COMMA, THEN THE END OF THE PARAMETER LIST HAS BEEN         */ 00358000
*/*     REACHED; SET 'PEND' EQUAL TO YES.                            */ 00359000
*/*                                                                  */ 00360000
*/* ENTRY - IN-LINE SEGMENT                                          */ 00361000
*/*                                                                  */ 00362000
*/*     PURPOSE -                                                    */ 00363000
*/*                                                                  */ 00364000
*/*         PREPARE READ PARAMETER                                   */ 00365000
*/*                                                                  */ 00366000
*/*     INPUT DATA -                                                 */ 00367000
*/*                                                                  */ 00368000
*/*         PARMPTR - ADDRESS OF VAL SYSTEM PARAMETERS               */ 00369000
*/*         DEFAULT - SWITCH TO INDICATE DEFAULT LIST                */ 00370000
*/*                                                                  */ 00371000
*/* EXITS -                                                          */ 00372000
*/*                                                                  */ 00373000
*/*     CONDITION - NOT ALL VATLSTS HAVE BEEN READ                   */ 00374000
*/*                                                                  */ 00375000
*/*     OUTPUT DATA -                                                */ 00376000
*/*                                                                  */ 00377000
*/*         NAME OF VATLST TO BE READ                                */ 00378000
*/*                                                                  */ 00379000
*/*     CONDITION - END OF PARAMETER LISTS                           */ 00380000
*/*                                                                  */ 00381000
*/*     OUTPUT DATA -                                                */ 00382000
*/*                                                                  */ 00383000
*/*         NAME OF VATLST TO BE READ                                */ 00384000
*/*         PEND - SET TO YES                                        */ 00385000
*/*                                                                  */ 00386000
*/*     RETURN CODE - NONE                                           */ 00387000
*/*                                                                  */ 00388000
*/********************************************************************/ 00389000
*                                                               02S0326 00390000
*READ = YES;                           /*INDICATE THERE IS A VATLST     00391000
*                                        TO BE READ                  */ 00392000
         OI    READ,B'00100000'                                 02S0326 00393000
*IF DEFAULT = YES                      /*USE PARMS OR DEFAULT?       */ 00394000
*  THEN DO;                                                     02S0327 00395000
         TM    DEFAULT,B'10000000'                              02S0327 00396000
         BNO   @RF00327                                         02S0327 00397000
*    PEND = YES;                       /*NO MORE PARMS AFTER THIS ONE*/ 00398000
         OI    PEND,B'01000000'                                 02S0329 00399000
*    SUFFIX = DEFLTVAT;                /*MOVE '00' INTO READ AREA    */ 00400000
         L     @10,NVTPAREA(,RNVT)                              02S0330 00401000
         MVC   SUFFIX(2,@10),@CC00144                           02S0330 00402000
*  END;                                                         02S0331 00403000
*  ELSE DO;                                                     02S0332 00404000
         B     @RC00327                                         02S0332 00405000
@RF00327 DS    0H                                               02S0333 00406000
*    SUFFIX = VATPARMS(ONE:TWO);       /*MOVE VATLST NUMBER INTO        00407000
*                                        READ AREA                   */ 00408000
         L     @10,NVTPAREA(,RNVT)                              02S0333 00409000
         L     @05,PARMPTR                                      02S0333 00410000
         MVC   SUFFIX(2,@10),VATPARMS(@05)                      02S0333 00411000
*    IF VATPARMS(THREE) = COMMA        /*CHECK FOR MORE PARAMTERS    */ 00412000
*      THEN DO;                                                 02S0334 00413000
         CLI   VATPARMS+2(@05),C','                             02S0334 00414000
         BNE   @RF00334                                         02S0334 00415000
*        PARMPTR = PARMPTR+THREE;      /*POINT TO NEXT PARAMETER     */ 00416000
         AL    @05,@CF00064                                     02S0336 00417000
         ST    @05,PARMPTR                                      02S0336 00418000
*      END;                                                     02S0337 00419000
*      ELSE PEND = YES;                /*END OF PARAMETERS           */ 00420000
*                                                               02S0338 00421000
*                                                               02S0338 00422000
         B     @RC00334                                         02S0338 00423000
@RF00334 OI    PEND,B'01000000'                                 02S0338 00424000
*  END;                                                         02S0339 00425000
@RC00334 DS    0H                                               02S0340 00426000
*DO WHILE (READ = YES);                /*READ VATLST                 */ 00427000
@RC00327 B     @DE00340                                         02S0340 00428000
@DL00340 DS    0H                                               02S0341 00429000
*/********************************************************************/ 00430000
*/*                                                                  */ 00431000
*/* SEGMENT NAME - RDENTRY                                           */ 00432000
*/*                                                                  */ 00433000
*/* DESCRIPTIVE NAME - READ AN ENTRY FROM VATLST                     */ 00434000
*/*                                                                  */ 00435000
*/* FUNCTION -                                                       */ 00436000
*/*                                                                  */ 00437000
*/*     READ AN ENTRY FROM VATLSTXX.  CHECK READ RETURN.  IF READ    */ 00438000
*/*     WAS GOOD, EXECUTE SEGMENT 'CKENTRY'.  IF EOF, SET 'READ'     */ 00439000
*/*     SWITCH TO OFF.  IF A LIST WAS NOT FOUND, EXECUTE SEGMENT     */ 00440000
*/*     'NOLIST'.  IF AN  I/O ERROR OCCURRED, EXECUTE SEGMENT        */ 00441000
*/*     'RDERR'.                                                     */ 00442000
*/*                                                                  */ 00443000
*/* ENTRY - IN-LINE SEGMENT                                          */ 00444000
*/*                                                                  */ 00445000
*/*     PURPOSE - SEE FUNCTION                                       */ 00446000
*/*                                                                  */ 00447000
*/*     INPUT DATA -                                                 */ 00448000
*/*                                                                  */ 00449000
*/*         NIPPANAM - PARMLIB MEMBER NAME                           */ 00450000
*/*                                                                  */ 00451000
*/* EXITS -                                                          */ 00452000
*/*                                                                  */ 00453000
*/*     CONDITION - NORMAL                                           */ 00454000
*/*                                                                  */ 00455000
*/*     OUTPUT DATA -                                                */ 00456000
*/*                                                                  */ 00457000
*/*         A VATLST ENTRY                                           */ 00458000
*/*                                                                  */ 00459000
*/*     CONDITION - EOF OR ERROR                                     */ 00460000
*/*                                                                  */ 00461000
*/*     OUTPUT DATA -                                                */ 00462000
*/*                                                                  */ 00463000
*/*         READ - SET TO OFF                                        */ 00464000
*/*                                                                  */ 00465000
*/*     CONDITION - NOT FOUND                                        */ 00466000
*/*                                                                  */ 00467000
*/*     OUTPUT DATA -                                                */ 00468000
*/*                                                                  */ 00469000
*/*         READ - SET TO OFF IF OPERATOR DID NOT SUPPLY AN          */ 00470000
*/*                ALTERNATE LIST                                    */ 00471000
*/*                                                                  */ 00472000
*/*     RETURN CODE - NONE                                           */ 00473000
*/*                                                                  */ 00474000
*/********************************************************************/ 00475000
*                                                               03S0341 00476000
*RFY (RPARM) RSTD;                                              03S0341 00477000
*CALL NIPPMMEM;                        /* READ RECORD FROM VATLST    */ 00478000
         BAL   @14,NIPPMMEM                                     03S0342 00479000
*IF REG1FIX ^< ZERO                    /* IF NOT NEGATIVE, READ WAS  */ 00480000
*  THEN DO;                            /* GOOD.                      */ 00481000
         SLR   @10,@10                                          03S0343 00482000
         CR    REG1FIX,@10                                      03S0343 00483000
         BL    @RF00343                                         03S0343 00484000
*    MAPAD = RPARM;                    /* MAP VATLST ENTRY           */ 00485000
         ST    RPARM,MAPAD                                      03S0345 00486000
*    RFY (RPARM) UNRSTD;               /* CHECK FORMAT OF ENTRY.     */ 00487000
*/********************************************************************/ 00488000
*/*                                                                  */ 00489000
*/* SEGMENT NAME - CKENTRY                                           */ 00490000
*/*                                                                  */ 00491000
*/* DESCRIPTIVE NAME - CHECK FORMAT OF VATLST ENTRY                  */ 00492000
*/*                                                                  */ 00493000
*/* FUNCTION -                                                       */ 00494000
*/*                                                                  */ 00495000
*/*     THE 'WTO' MESSAGE SWITCH IS SET ON IN CASE OF ERROR.  THE    */ 00496000
*/*     FORMAT OF THE VATLST ENTRY IS CHECKED FOR:                   */ 00497000
*/*         1. AN ABSENCE OF COMMAS IN THE VOLUME SERIAL AND DEVICE  */ 00498000
*/*            TYPE FIELDS.                                          */ 00499000
*/*         2. DELIMITERS (COMMAS) IN COLUMNS 7, 9, AND 11.          */ 00500000
*/*         3. A COMMA OR BLANK IN COLUMN 20.                        */ 00501000
*/*                                                                  */ 00502000
*/*     IF NONE OF THE ABOVE TESTS FAIL, THE SWITCH 'WTO' IS SET     */ 00503000
*/*     OFF.                                                         */ 00504000
*/*                                                                  */ 00505000
*/*     IF THE FORMAT IS VALID, CONTROL GOES TO THE SEGMENT THAT     */ 00506000
*/*     DETERMINES IF THE ENTRY WILL BE PLACED IN THE MOUNT LIST.    */ 00507000
*/*                                                                  */ 00508000
*/*     IF THE 'WTO' SWITCH IS ON, MESSAGE 'IEA855I-INVALID VATLSTXX */ 00509000
*/*     ENTRY' IS ISSUED.                                            */ 00510000
*/*                                                                  */ 00511000
*/*         NOTE: THE 'WTO' SWITCH IS ALSO SET BY SEGMENT 'MNTLSTCK' */ 00512000
*/*               IF THE DEVICE TYPE IS INVALID.                     */ 00513000
*/*                                                                  */ 00514000
*/* ENTRY - IN-LINE SEGMENT                                          */ 00515000
*/*                                                                  */ 00516000
*/*     PURPOSE - SEE FUNCTION                                       */ 00517000
*/*                                                                  */ 00518000
*/*     INPUT DATA -                                                 */ 00519000
*/*                                                                  */ 00520000
*/*         AN 80-BYTE VATLSTXX ENTRY FROM SYS1.PARMLIB:             */ 00521000
*/*           COL 1-6   VOLUME SERIAL                                */ 00522000
*/*           COL 7     COMMA                                        */ 00523000
*/*           COL 8     MOUNT CHARACTERISTIC                         */ 00524000
*/*           COL 9     COMMA                                        */ 00525000
*/*           COL 10    ALLOCATION CHARACTERISTIC                    */ 00526000
*/*           COL 11    COMMA                                        */ 00527000
*/*           COL 12-19 DEVICE TYPE                                  */ 00528000
*/*           COL 20    COMMA OR BLANK                               */ 00529000
*/*           COL 21    MOUNT PRIORITY                               */ 00530000
*/*           COL 22    BLANK                                        */ 00531000
*/*           COL 23-80 OPTIONAL INFORMATION                         */ 00532000
*/*                                                                  */ 00533000
*/* EXITS -                                                          */ 00534000
*/*                                                                  */ 00535000
*/*     CONDITION - VATLST ENTRY VALIDATED                           */ 00536000
*/*                                                                  */ 00537000
*/*     OUTPUT DATA -                                                */ 00538000
*/*                                                                  */ 00539000
*/*         WTO - SET TO OFF                                         */ 00540000
*/*                                                                  */ 00541000
*/*     CONDITION - ERROR IN ENTRY                                   */ 00542000
*/*                                                                  */ 00543000
*/*     OUTPUT DATA -                                                */ 00544000
*/*                                                                  */ 00545000
*/*         WTO - SET ON                                             */ 00546000
*/*         MESSAGE(S) IEA855I                                       */ 00547000
*/*                                                                  */ 00548000
*/*     RETURN CODE - NONE                                           */ 00549000
*/*                                                                  */ 00550000
*/********************************************************************/ 00551000
*                                                               04S0347 00552000
*UCBPTR = ZERO;                        /* INITIALIZE UCB POINTER     */ 00553000
         ST    @10,UCBPTR                                       04S0347 00554000
*ERROR = NO;                           /* INITIALIZE ERROR SWITCH.   */ 00555000
         NI    ERROR,B'11011111'                                04S0348 00556000
*WTO = YES;                            /* SET MSG SW IN CASE ERROR.  */ 00557000
         OI    WTO,B'00001000'                                  04S0349 00558000
*LOOPSW = NO;                          /* INIT LOOP SWITCH           */ 00559000
         NI    LOOPSW,B'11101111'                               04S0350 00560000
*  DO I = SEVENTY2 TO ONE BY - ONE WHILE LOOPSW = NO;           04S0351 00561000
         LA    @10,72                                           04S0351 00562000
         STH   @10,I                                            04S0351 00563000
@DL00351 TM    LOOPSW,B'00010000'                               04S0351 00564000
         BNZ   @DC00351                                         04S0351 00565000
*    IF ENTRIE(I) = RDEND THEN         /* IF ENTRY DOES NOT BEGIN    */ 00566000
         L     @05,MAPAD                                        04S0352 00567000
         ALR   @05,@10                                          04S0352 00568000
         BCTR  @05,0                                            04S0352 00569000
         CLC   ENTRIE(1,@05),RDEND                              04S0352 00570000
         BNE   @RF00352                                         04S0352 00571000
*      ERROR = YES;                    /* IN COL 1 THEN FORMAT IS IN */ 00572000
         OI    ERROR,B'00100000'                                04S0353 00573000
*      LOOPSW = YES;                   /* ERROR. TERM. CHECK.        */ 00574000
@RF00352 OI    LOOPSW,B'00010000'                               04S0354 00575000
*  END;                                                         04S0355 00576000
         SLR   @10,@10                                          04S0355 00577000
         BCTR  @10,0                                            04S0355 00578000
         AH    @10,I                                            04S0355 00579000
         STH   @10,I                                            04S0355 00580000
         LTR   @10,@10                                          04S0355 00581000
         BP    @DL00351                                         04S0355 00582000
@DC00351 DS    0H                                               04S0356 00583000
*IF ERROR = NO THEN                    /* IF NO ERROR SO FAR,        */ 00584000
         TM    ERROR,B'00100000'                                04S0356 00585000
         BNZ   @RF00356                                         04S0356 00586000
*  DO;                                 /* CONTINUE CHECKING.         */ 00587000
*    LOOPSW = NO;                      /* INIT LOOP SWITCH.          */ 00588000
         NI    LOOPSW,B'11101111'                               04S0358 00589000
*    DO I = SIX TO ONE BY - ONE WHILE LOOPSW = NO;              04S0359 00590000
         LA    @10,6                                            04S0359 00591000
         STH   @10,I                                            04S0359 00592000
@DL00359 TM    LOOPSW,B'00010000'                               04S0359 00593000
         BNZ   @DC00359                                         04S0359 00594000
*      IF EVOLSER(I) = COMMA           /* IF THERE IS A COMMA IN THE */ 00595000
*        THEN DO;                      /* VOLUME SERIAL FIELD, SET   */ 00596000
         L     @05,MAPAD                                        04S0360 00597000
         ALR   @05,@10                                          04S0360 00598000
         BCTR  @05,0                                            04S0360 00599000
         CLI   EVOLSER(@05),C','                                04S0360 00600000
         BNE   @RF00360                                         04S0360 00601000
*          ERROR = YES;                /* ERROR SWITCH ON AND TERM.  */ 00602000
         OI    ERROR,B'00100000'                                04S0362 00603000
*          LOOPSW = YES;               /* CHECKING.                  */ 00604000
         OI    LOOPSW,B'00010000'                               04S0363 00605000
*        END;                                                   04S0364 00606000
*    END;                                                       04S0365 00607000
@RF00360 SLR   @10,@10                                          04S0365 00608000
         BCTR  @10,0                                            04S0365 00609000
         AH    @10,I                                            04S0365 00610000
         STH   @10,I                                            04S0365 00611000
         LTR   @10,@10                                          04S0365 00612000
         BP    @DL00359                                         04S0365 00613000
@DC00359 DS    0H                                               04S0366 00614000
*  END;                                                         04S0366 00615000
*LOOPSW = NO;                          /* INIT LOOP SWITCH           */ 00616000
@RF00356 NI    LOOPSW,B'11101111'                               04S0367 00617000
*IF ERROR = NO                         /* IF NO ERROR SO FAR,        */ 00618000
*  THEN IF DELIM1 = COMMA              /* CHECK FOR DELIMITERS IN    */ 00619000
         TM    ERROR,B'00100000'                                04S0368 00620000
         BNZ   @RF00368                                         04S0368 00621000
*    THEN IF DELIM2 = COMMA            /* COLS 7, 9, AND 11.         */ 00622000
         L     @10,MAPAD                                        04S0369 00623000
         CLI   DELIM1(@10),C','                                 04S0369 00624000
         BNE   @RF00369                                         04S0369 00625000
*      THEN IF DELIM3 = COMMA                                   04S0370 00626000
         CLI   DELIM2(@10),C','                                 04S0370 00627000
         BNE   @RF00370                                         04S0370 00628000
*        THEN DO I = EIGHT TO ONE BY - ONE WHILE LOOPSW = NO;   04S0371 00629000
         CLI   DELIM3(@10),C','                                 04S0371 00630000
         BNE   @RF00371                                         04S0371 00631000
         LA    @10,8                                            04S0372 00632000
         STH   @10,I                                            04S0372 00633000
@DL00372 TM    LOOPSW,B'00010000'                               04S0372 00634000
         BNZ   @DC00372                                         04S0372 00635000
*          IF EDEVTYPE(I) = COMMA      /* IF THERE IS A COMMA IN THE */ 00636000
*            THEN DO;                  /* DEVICE TYPE FIELD, SET     */ 00637000
         L     @05,MAPAD                                        04S0373 00638000
         ALR   @05,@10                                          04S0373 00639000
         CLI   EDEVTYPE-1(@05),C','                             04S0373 00640000
         BNE   @RF00373                                         04S0373 00641000
*              ERROR = YES;            /* ERROR SWITCH ON AND TERM.  */ 00642000
         OI    ERROR,B'00100000'                                04S0375 00643000
*              LOOPSW = YES;           /* CHECKING.                  */ 00644000
         OI    LOOPSW,B'00010000'                               04S0376 00645000
*            END;                                               04S0377 00646000
*        END;                                                   04S0378 00647000
@RF00373 SLR   @10,@10                                          04S0378 00648000
         BCTR  @10,0                                            04S0378 00649000
         AH    @10,I                                            04S0378 00650000
         STH   @10,I                                            04S0378 00651000
         LTR   @10,@10                                          04S0378 00652000
         BP    @DL00372                                         04S0378 00653000
@DC00372 DS    0H                                               04S0379 00654000
*      ELSE ERROR = YES;               /* FORMAT ERROR               */ 00655000
         B     @RC00371                                         04S0379 00656000
@RF00371 OI    ERROR,B'00100000'                                04S0379 00657000
*    ELSE ERROR = YES;                                          04S0380 00658000
         B     @RC00370                                         04S0380 00659000
@RF00370 OI    ERROR,B'00100000'                                04S0380 00660000
*  ELSE ERROR = YES;                                            04S0381 00661000
         B     @RC00369                                         04S0381 00662000
@RF00369 OI    ERROR,B'00100000'                                04S0381 00663000
*IF ERROR = NO                         /* IF NO ERROR SO FAR, AND    */ 00664000
*  THEN IF DELIM4 = BLANK | DELIM4 = COMMA  /* IF BLANK OR COMMA IN  */ 00665000
@RC00369 DS    0H                                               04S0382 00666000
@RF00368 TM    ERROR,B'00100000'                                04S0382 00667000
         BNZ   @RF00382                                         04S0382 00668000
*    THEN DO;                          /* COL 20 THEN FORMAT IS      */ 00669000
         L     @10,MAPAD                                        04S0383 00670000
         CLI   DELIM4(@10),C' '                                 04S0383 00671000
         BE    @RT00383                                         04S0383 00672000
         CLI   DELIM4(@10),C','                                 04S0383 00673000
         BNE   @RF00383                                         04S0383 00674000
@RT00383 DS    0H                                               04S0384 00675000
*      WTO = NO;                       /* CORRECT. TURN OFF ERROR    */ 00676000
         NI    WTO,B'11110111'                                  04S0385 00677000
*      DO;                             /* MESSAGE SWITCH.            */ 00678000
*                                      /* PUT ENTRY IN LIST.         */ 00679000
*/********************************************************************/ 00680000
*/*                                                                  */ 00681000
*/* SEGMENT NAME - MNTLSTCK                                          */ 00682000
*/*                                                                  */ 00683000
*/* DESCRIPTIVE NAME - DETERMINE IF ENTRY SHOULD BE ADDED TO MOUNT   */ 00684000
*/*                    LIST                                          */ 00685000
*/*                                                                  */ 00686000
*/* FUNCTION -                                                       */ 00687000
*/*                                                                  */ 00688000
*/*     THE DEVICE TYPE IN THE VATLST ENTRY IS COMPARED      @Y30LPPD*/ 00689000
*/*     AGAINST A TABLE OF VALID REAL DEVICE TYPES. IF THE   @Y30LPPD*/ 00690000
*/*     ENTRY DEVICE TYPE MATCHES ONE IN THE TABLE, THE      @Y30LPPD*/ 00691000
*/*     'FOUND' SWITCH IS SET ON TO TERMINATE THE SEARCH.    @Y30LPPD*/ 00692000
*/*     IF THE DEVICE TYPE WASN'T FOUND IN THE TABLE, AND IF @Y30LPPD*/ 00693000
*/*     THE FIRST CHARACTER IS 'V' THEN SERVICE ROUTINE UCBFN@Y30LPPD*/ 00694000
*/*     IS CALLED FOR CHARACTERS 2  THRU 4. IF THE RETURN IS @Y30LPPD*/ 00695000
*/*     SUCCESSFUL AND IF THE UCB RETURNED IS VIRTUAL THEN   @Y30LPPD*/ 00696000
*/*     'FOUND' IS SET ON TO INDICATE A VALID DEVICE TYPE.   @Y30LPPD*/ 00697000
*/*     FOR REAL VOLUMES, I IS THE INDEX INTO THE TABLE OF   @Y30LPPD*/ 00698000
*/*     VALID REAL DEVICE TYPES. FOR MSS VOLUMES, I IS SET   @Y30LPPD*/ 00699000
*/*     TO ONE GREATER THAN THE NUMBER OF VALID REAL DEVICE  @Y30LPPD*/ 00700000
*/*     TYPES.                                               @Y30LPPD*/ 00701000
*/*     MSS ENTRIES ARE SUPPRESSED IF MSS IS NOT             @G24LPSJ*/ 00702000
*/*     INITIALIZED.                                         @G24LPSJ*/ 00703000
*/*                                                                  */ 00704000
*/*     IF THE DEVICE TYPE IS VALID AND THE MOUNT LIST IS FULL       */ 00705000
*/*     (300 ENTRIES EXIST), NO MORE PROCESSING IS DONE FOR THE      */ 00706000
*/*     ENTRY. IF THE MOUNT LIST IS NOT FULL, THE SEGMENT THAT       */ 00707000
*/*     BUILDS THE MOUNT LIST IS EXECUTED.                           */ 00708000
*/*                                                                  */ 00709000
*/*     IF THE DEVICE TYPE IS INVALID (THE FOUND SWITCH IS NOT ON),  */ 00710000
*/*     THE 'WTO' SWITCH IS SET ON SO THAT THE MESSAGE 'IEA855I-     */ 00711000
*/*     INVALID VATLSTXX ENTRY' WILL BE ISSUED.                      */ 00712000
*/*                                                                  */ 00713000
*/* ENTRY - IN-LINE SEGMENT                                          */ 00714000
*/*                                                                  */ 00715000
*/*     PURPOSE - SEE FUNCTION                                       */ 00716000
*/*                                                                  */ 00717000
*/*     INPUT DATA -                                                 */ 00718000
*/*                                                                  */ 00719000
*/*         A VATLST ENTRY                                           */ 00720000
*/*         MTLSTCT - THE NUMBER OF ENTRIES IN THE MOUNT LIST        */ 00721000
*/*         DUPSER - SET ON IF MULTIPLE ENTRIES FOR VOLUME           */ 00722000
*/*                  ARE ENCOUNTERED                                 */ 00723000
*/*                                                                  */ 00724000
*/* EXITS -                                                          */ 00725000
*/*                                                                  */ 00726000
*/*     CONDITION - DEVICE TYPE IN ENTRY IS VALID                    */ 00727000
*/*                                                                  */ 00728000
*/*     OUTPUT DATA -                                                */ 00729000
*/*                                                                  */ 00730000
*/*         DEVCT - DEVICE TYPE COUNTER UPDATED IF FIRST VOLUME      */ 00731000
*/*                 ENTRY                                            */ 00732000
*/*         FOUND - SET ON                                           */ 00733000
*/*                                                                  */ 00734000
*/*     CONDITION - INVALID DEVICE TYPE ENTRY                        */ 00735000
*/*                                                                  */ 00736000
*/*     OUTPUT DATA -                                                */ 00737000
*/*                                                                  */ 00738000
*/*         WTO - SET ON                                             */ 00739000
*/*         FOUND - SET OFF                                          */ 00740000
*/*                                                                  */ 00741000
*/*     RETURN CODE - NONE                                           */ 00742000
*/*                                                                  */ 00743000
*/********************************************************************/ 00744000
*                                                               05S0387 00745000
*FOUND = NO;                           /* INITIALIZE FOUND SWITCH.   */ 00746000
         NI    FOUND,B'11111101'                                05S0387 00747000
*SUPPRESS = OFF;                       /* INITIALIZE SUPPRESS SWITCH    00748000
*                                         OFF                @G24LPSJ*/ 00749000
         NI    SUPPRESS,B'11110111'                             05S0388 00750000
*DO IND = NUMSUPTD TO ONE BY - ONE     /* IS ENTRY DEVICE            */ 00751000
*  WHILE FOUND = NO;                   /* TYPE SUPPORTED?            */ 00752000
         LA    @10,7                                            05S0389 00753000
         STH   @10,IND                                          05S0389 00754000
@DL00389 TM    FOUND,B'00000010'                                05S0389 00755000
         BNZ   @DC00389                                         05S0389 00756000
*  IF ETYPE(IND) = EDEVTYPE                                     05S0390 00757000
*    THEN DO;                          /* IF TYPE IS VALID, SET      */ 00758000
         LR    @05,@10                                          05S0390 00759000
         MH    @05,@CH01793                                     05S0390 00760000
         LA    @01,ETYPE-14(@05)                                05S0390 00761000
         L     @05,MAPAD                                        05S0390 00762000
         CLC   0(8,@01),EDEVTYPE(@05)                           05S0390 00763000
         BNE   @RF00390                                         05S0390 00764000
*      FOUND = YES;                    /* FOUND SWITCH ON.           */ 00765000
         OI    FOUND,B'00000010'                                05S0392 00766000
*      I = IND;                        /* SAVE INDEX         @Y30LPPD*/ 00767000
         STH   @10,I                                            05S0393 00768000
*    END;                                                       05S0394 00769000
*END;                                                           05S0395 00770000
@RF00390 SLR   @10,@10                                          05S0395 00771000
         BCTR  @10,0                                            05S0395 00772000
         AH    @10,IND                                          05S0395 00773000
         STH   @10,IND                                          05S0395 00774000
         LTR   @10,@10                                          05S0395 00775000
         BP    @DL00389                                         05S0395 00776000
@DC00389 DS    0H                                               05S0396 00777000
*IF FOUND = NO                         /* IF DEVICE TYPE NOT    05S0396 00778000
*                                         FOUND IN TABLE     @Y30LPPD*/ 00779000
*  THEN IF EDEVTYPE(ONE) = VIRT        /* CHECK FOR VXXX.    @Y30LPPD*/ 00780000
         TM    FOUND,B'00000010'                                05S0396 00781000
         BNZ   @RF00396                                         05S0396 00782000
*    THEN DO;                          /* VIRTUAL SPECIFIED. @Y30LPPD*/ 00783000
         L     @10,MAPAD                                        05S0397 00784000
         CLI   EDEVTYPE(@10),C'V'                               05S0397 00785000
         BNE   @RF00397                                         05S0397 00786000
*      FINDDEV = EDEVTYPE(2:4);        /* MOVE VUA TO PARM   @Y30LPPD*/ 00787000
         MVC   FINDDEV(3),EDEVTYPE+1(@10)                       05S0399 00788000
*      RFY RPARM RSTD;                 /*                    @Y30LPPD*/ 00789000
*      RPARM = FINDADDR;               /* SET UP PARAMETER   @Y30LPPD*/ 00790000
         L     RPARM,FINDADDR                                   05S0401 00791000
*      GEN REFS(NVTUCBFN,RPARM)                                 05S0402 00792000
*      (IEAPMNIP TYPE=UCBFN,PARAM=RPARM); /*  LOCATE UCB     @Y30LPPD*/ 00793000
         IEAPMNIP TYPE=UCBFN,PARAM=RPARM                                00794000
*      IF RPARM ^= ZERO                /* UCB FOUND?         @Y30LPPD*/ 00795000
*        THEN DO;                      /* YES                @Y30LPPD*/ 00796000
         SLR   @10,@10                                          05S0403 00797000
         CR    RPARM,@10                                        05S0403 00798000
         BE    @RF00403                                         05S0403 00799000
*          UCBPTR = RPARM;             /* ADDRESS UCB        @Y30LPPD*/ 00800000
         ST    RPARM,UCBPTR                                     05S0405 00801000
*          RFY RPARM UNRSTD;           /*                    @Y30LPPD*/ 00802000
*          IF UCBRVDEV = YES &         /* IS UCB VIRTUAL?    @Y30LPPD*/ 00803000
*             UCBTYP(3:4) = COMP3330   /* IS UCB 3330?       @Y30LPPD*/ 00804000
*            THEN DO;                  /* YES                @Y30LPPD*/ 00805000
         L     @05,UCBPTR                                       05S0407 00806000
         TM    UCBRVDEV(@05),B'00001000'                        05S0407 00807000
         BNO   @RF00407                                         05S0407 00808000
         CLC   UCBTYP+2(2,@05),@CB00140                         05S0407 00809000
         BNE   @RF00407                                         05S0407 00810000
*              FOUND = YES;            /* VALID DEVICE TYPE  @Y30LPPD*/ 00811000
         OI    FOUND,B'00000010'                                05S0409 00812000
*              I = NUMSUPTD + ONE;     /* INDICATE 3330V     @Y30LPPD*/ 00813000
         MVC   I(2),@CH00035                                    05S0410 00814000
*              IF CVTICB ^= ZERO&      /* IF ICB EXISTS AND  @G24LPSJ*/ 00815000
*                 ICBI = OFF THEN      /* MSS NOT INIT. THEN @G24LPSJ*/ 00816000
         L     @05,CVTPTR                                       05S0411 00817000
         L     @05,CVTEXT2(,@05)                                05S0411 00818000
         L     @05,CVTICB(,@05)                                 05S0411 00819000
         CR    @05,@10                                          05S0411 00820000
         BE    @RF00411                                         05S0411 00821000
         TM    ICBI(@05),B'10000000'                            05S0411 00822000
         BNZ   @RF00411                                         05S0411 00823000
*                SUPPRESS = ON;        /* SUPPRESS MSS          05S0412 00824000
*                                         REQUESTS           @G24LPSJ*/ 00825000
         OI    SUPPRESS,B'00001000'                             05S0412 00826000
*            END;                      /*                    @Y30LPPD*/ 00827000
*            ELSE;                     /*                    @Y30LPPD*/ 00828000
@RF00407 DS    0H                                               05S0415 00829000
*        END;                          /*                    @Y30LPPD*/ 00830000
*        ELSE;                         /*                    @Y30LPPD*/ 00831000
@RF00403 DS    0H                                               05S0417 00832000
*    END;                              /*                    @Y30LPPD*/ 00833000
*    ELSE;                             /*                    @Y30LPPD*/ 00834000
@RF00397 DS    0H                                               05S0419 00835000
*  ELSE;                                                        05S0419 00836000
@RF00396 DS    0H                                               05S0420 00837000
*IF FOUND = NO                         /* IF THE DEV TYPE IS INVALID,*/ 00838000
*  THEN WTO = YES;                     /* SET ERR MSG SWITCH ON.     */ 00839000
@RC00396 TM    FOUND,B'00000010'                                05S0420 00840000
         BNZ   @RF00420                                         05S0420 00841000
         OI    WTO,B'00001000'                                  05S0421 00842000
*  ELSE IF MTLSTCT ^= MNTMAX&          /* IF MOUNT LIST IS   @Y30LPPD*/ 00843000
*                                      /* NOT FULL AND       @G24LPSJ*/ 00844000
*          SUPPRESS = OFF THEN         /* SUPPRESS IS NOT ON @G24LPSJ*/ 00845000
         B     @RC00420                                         05S0422 00846000
@RF00420 LH    @10,MTLSTCT                                      05S0422 00847000
         CH    @10,@CH00086                                     05S0422 00848000
         BE    @RF00422                                         05S0422 00849000
         TM    SUPPRESS,B'00001000'                             05S0422 00850000
         BNZ   @RF00422                                         05S0422 00851000
*    DO;                               /* THEN ADD           @G24LPSJ*/ 00852000
*/********************************************************************/ 00853000
*/*                                                                  */ 00854000
*/* SEGMENT NAME - MOUNTLST                                          */ 00855000
*/*                                                                  */ 00856000
*/* DESCRIPTIVE NAME - BUILD MOUNT LIST                              */ 00857000
*/*                                                                  */ 00858000
*/* FUNCTION -                                                       */ 00859000
*/*                                                                  */ 00860000
*/*     THE VOLUME SERIAL IN THE VATLST ENTRY IS COMPARED WITH ANY   */ 00861000
*/*     VOLUME SERIALS THAT ARE ALREADY IN THE MOUNT LIST.  IF A     */ 00862000
*/*     DUPLICATE IS FOUND, THE EXISTING MOUNT LIST ENTRY IS OVER-   */ 00863000
*/*     LAID WITH THE CURRENT ENTRY. IF A DUPLICATE VOLSER IS@Y30LPPD*/ 00864000
*/*     NOT FOUND AND I INDICATES THAT THE DEVICE TYPE IS    @Y30LPPD*/ 00865000
*/*     VIRTUAL, THEN THE DEVICE TYPE OF THE VATLST ENTRY IS @Y30LPPD*/ 00866000
*/*     COMPARED AGAINST THOSE IN THE MOUNT LIST. THIS IS    @Y30LPPD*/ 00867000
*/*     BECAUSE, FOR MSS VOLUMES, THE ACTUAL DEVICE ADDRESS  @Y30LPPD*/ 00868000
*/*     IS SPECIFIED IN THE ENTRY; TWO ENTRIES WITH          @Y30LPPD*/ 00869000
*/*     VOLUME SERIALS CAN NOT BE ENTERED IN THE MOUNT LIST  @Y30LPPD*/ 00870000
*/*     FOR THE SAME DEVICE ADDRESS. IF A DUPLICATE          @Y30LPPD*/ 00871000
*/*     IS FOUND, THE EXISTING MOUNT LIST ENTRY IS OVER-     @Y30LPPD*/ 00872000
*/*     LAID WITH THE CURRENT VATLST ENTRY, SO THAT THE MOUNT AND    */ 00873000
*/*     USE STATUS SET IN THE UCB WILL BE THAT OF THE LAST VATLST    */ 00874000
*/*     ENTRY SPECIFIED BY THE USER.  IF NO DUPLICATE IS FOUND, THE  */ 00875000
*/*     VATLST ENTRY IS ADDED TO THE END OF THE MOUNT LIST (MNTLIST).*/ 00876000
*/*     THE INDEX OF THE UCB UNIT TYPE IN THE DEVTYPES TABLE IS      */ 00877000
*/*     ADDED TO THE MNTLIST ALSO.                                   */ 00878000
*/*                                                                  */ 00879000
*/* ENTRY - IN-LINE SEGMENT                                          */ 00880000
*/*                                                                  */ 00881000
*/*     PURPOSE - SEE FUNCTION                                       */ 00882000
*/*                                                                  */ 00883000
*/*     INPUT DATA -                                                 */ 00884000
*/*                                                                  */ 00885000
*/*         A VATLST ENTRY                                           */ 00886000
*/*         MTLSTCT - NUMBER OF ENTRIES IN THE MOUNT LIST            */ 00887000
*/*                                                                  */ 00888000
*/* EXITS -                                                          */ 00889000
*/*                                                                  */ 00890000
*/*     CONDITION - NORMAL                                           */ 00891000
*/*                                                                  */ 00892000
*/*     OUTPUT DATA -                                                */ 00893000
*/*                                                                  */ 00894000
*/*         MNTLIST - UPDATED                                        */ 00895000
*/*         MTLSTCT - UPDATED                                        */ 00896000
*/*                                                                  */ 00897000
*/*     RETURN CODE - NONE                                           */ 00898000
*/*                                                                  */ 00899000
*/********************************************************************/ 00900000
*                                                               06S0424 00901000
*/********************************************************************/ 00902000
*/*                                                                  */ 00903000
*/* NOTE: IN THE FOLLOWING CODE, INSTRUCTION DEVENT(J) =I MUST       */ 00904000
*/*       FOLLOW MNTLIST(J) = MNTENTRY, AND INSTRUCTION              */ 00905000
*/*       DEVENT(MTLSTCT) = I MUST FOLLOW MNTLIST(MTLSTCT) =         */ 00906000
*/*       MNTENTRY.                                                  */ 00907000
*/********************************************************************/ 00908000
*DUPSER = NO;                          /* INITIALIZE DUPSER SWITCH   */ 00909000
*DUPADDR = NO;                         /*INIT DUPADDR SWITCH @Y30LPPD*/ 00910000
         NI    DUPSER,B'11111100'                               06S0425 00911000
*IF MTLSTCT ^= ZERO                    /* FIRST ENTRY?               */ 00912000
*  THEN DO;                            /* NO                         */ 00913000
         LTR   @10,@10                                          06S0426 00914000
         BZ    @RF00426                                         06S0426 00915000
*    DO J = ONE TO MTLSTCT             /* SCAN FOR DUPLICATE         */ 00916000
*      WHILE DUPSER = NO;              /* VOLUME SERIALS             */ 00917000
         LA    @10,1                                            06S0428 00918000
         B     @DE00428                                         06S0428 00919000
@DL00428 TM    DUPSER,B'00000010'                               06S0428 00920000
         BNZ   @DC00428                                         06S0428 00921000
*      IF EVOLSER = MVOLSER(J)         /* COMPARE VOLSERS            */ 00922000
*        THEN DO;                                               06S0429 00923000
         L     @05,MAPAD                                        06S0429 00924000
         MH    @10,@CH00190                                     06S0429 00925000
         LA    @01,MVOLSER-22(@10)                              06S0429 00926000
         CLC   EVOLSER(6,@05),0(@01)                            06S0429 00927000
         BNE   @RF00429                                         06S0429 00928000
*          MNTLIST(J) = MNTENTRY;      /* IF DUPLICATE IS FOUND,     */ 00929000
         LA    @01,MNTLIST-22(@10)                              06S0431 00930000
         MVI   21(@01),C' '                                     06S0431 00931000
         MVC   0(21,@01),MNTENTRY(@05)                          06S0431 00932000
*          DEVENT(J) = I;              /* COVER THE OLD ENTRY,       */ 00933000
         LH    @05,I                                            06S0432 00934000
         STC   @05,DEVENT-22(@10)                               06S0432 00935000
*          DUPSER = YES;               /* SET UNIT TYPE INDEX AND    */ 00936000
         OI    DUPSER,B'00000010'                               06S0433 00937000
*        END;                          /* SET DUPSER SWITCH ON.      */ 00938000
*    END;                              /* END SCAN           @Y30LPPD*/ 00939000
@RF00429 LA    @10,1                                            06S0435 00940000
         AH    @10,J                                            06S0435 00941000
@DE00428 STH   @10,J                                            06S0435 00942000
         CH    @10,MTLSTCT                                      06S0435 00943000
         BNH   @DL00428                                         06S0435 00944000
@DC00428 DS    0H                                               06S0436 00945000
*    IF DUPSER = NO &                  /* IF NO DUP VOLSERS  @Y30LPPD*/ 00946000
*       I > NUMSUPTD                   /* AND ENTRY IS VIRT, @Y30LPPD*/ 00947000
*      THEN DO J = ONE TO MTLSTCT      /* SCAN FOR DUPLICATE @Y30LPPD*/ 00948000
         TM    DUPSER,B'00000010'                               06S0436 00949000
         BNZ   @RF00436                                         06S0436 00950000
         LH    @10,I                                            06S0436 00951000
         CH    @10,@CH00084                                     06S0436 00952000
         BNH   @RF00436                                         06S0436 00953000
*        WHILE DUPADDR = NO;           /* DEVICE ADDRESSES   @Y30LPPD*/ 00954000
         LA    @10,1                                            06S0437 00955000
         B     @DE00437                                         06S0437 00956000
@DL00437 TM    DUPADDR,B'00000001'                              06S0437 00957000
         BNZ   @DC00437                                         06S0437 00958000
*        IF EDEVTYPE = MDEVTYPE(J)     /* COMPARE DEV ADDRS  @Y30LPPD*/ 00959000
*          THEN DO;                    /* MATCH -            @Y30LPPD*/ 00960000
         L     @05,MAPAD                                        06S0438 00961000
         MH    @10,@CH00190                                     06S0438 00962000
         LA    @01,MDEVTYPE-22(@10)                             06S0438 00963000
         CLC   EDEVTYPE(8,@05),0(@01)                           06S0438 00964000
         BNE   @RF00438                                         06S0438 00965000
*            MNTLIST(J) = MNTENTRY;    /* COVER OLD ENTRY    @Y30LPPD*/ 00966000
         LA    @01,MNTLIST-22(@10)                              06S0440 00967000
         MVI   21(@01),C' '                                     06S0440 00968000
         MVC   0(21,@01),MNTENTRY(@05)                          06S0440 00969000
*            DEVENT(J) = I;            /* SET UNIT TYPE INDEX@Y30LPPD*/ 00970000
         LH    @05,I                                            06S0441 00971000
         STC   @05,DEVENT-22(@10)                               06S0441 00972000
*            DUPADDR = YES;            /* IND DUPLICATE ADDR @Y30LPPD*/ 00973000
         OI    DUPADDR,B'00000001'                              06S0442 00974000
*          END;                                                 06S0443 00975000
*      END;                                                     06S0444 00976000
@RF00438 LA    @10,1                                            06S0444 00977000
         AH    @10,J                                            06S0444 00978000
@DE00437 STH   @10,J                                            06S0444 00979000
         CH    @10,MTLSTCT                                      06S0444 00980000
         BNH   @DL00437                                         06S0444 00981000
@DC00437 DS    0H                                               06S0445 00982000
*  END;                                                         06S0445 00983000
@RF00436 DS    0H                                               06S0446 00984000
*IF (DUPSER = NO) &                    /* DUPLICATE VOLSER?  @Y30LPPD*/ 00985000
*   (DUPADDR = NO)                     /* DUPLICATE DEV ADDR?@Y30LPPD*/ 00986000
*  THEN DO;                            /* NO -               @Y30LPPD*/ 00987000
@RF00426 TM    DUPSER,B'00000011'                               06S0446 00988000
         BNZ   @RF00446                                         06S0446 00989000
*    MTLSTCT = (MTLSTCT + ONE);        /* INCREMENT THE NUMBER OF    */ 00990000
         LA    @10,1                                            06S0448 00991000
         AH    @10,MTLSTCT                                      06S0448 00992000
         STH   @10,MTLSTCT                                      06S0448 00993000
*    MNTLIST(MTLSTCT) = MNTENTRY;      /* ENTRIES IN THE LIST AND    */ 00994000
         MH    @10,@CH00190                                     06S0449 00995000
         LA    @05,MNTLIST-22(@10)                              06S0449 00996000
         MVI   21(@05),C' '                                     06S0449 00997000
         L     @01,MAPAD                                        06S0449 00998000
         MVC   0(21,@05),MNTENTRY(@01)                          06S0449 00999000
*    DEVENT(MTLSTCT) = I;              /* SET UNIT TYPE INDEX        */ 01000000
         LH    @05,I                                            06S0450 01001000
         STC   @05,DEVENT-22(@10)                               06S0450 01002000
*  END;                                /* ADD THIS ENTRY TO THE END. */ 01003000
*                                      /* RETURN TO MNTLSTCK.        */ 01004000
*    END;                              /*                    @Y30LPPD*/ 01005000
@RF00446 DS    0H                                               05S0453 01006000
*                                      /* RETURN TO CKENTRY.         */ 01007000
*      END;                                                     04S0453 01008000
@RF00422 DS    0H                                               04S0453 01009000
@RC00420 DS    0H                                               04S0454 01010000
*    END;                                                       04S0454 01011000
*IF WTO = YES                          /* IF FORMAT WAS INVALID, OR  */ 01012000
*  THEN DO;                            /* DEVICE TYPE WAS INVALID,   */ 01013000
@RF00383 DS    0H                                               04S0455 01014000
@RF00382 TM    WTO,B'00001000'                                  04S0455 01015000
         BNO   @RF00455                                         04S0455 01016000
*    NN855 = SUFFIX;                   /* SET UP AND ISSUE ERROR     */ 01017000
         L     @10,NVTPAREA(,RNVT)                              04S0457 01018000
         MVC   NN855(2),SUFFIX(@10)                             04S0457 01019000
*    GEN REFS(NVTWTO);                 /* MESSAGE.                   */ 01020000
     IEAPMNIP TYPE=WTO,PARAM=IEA855I                                    01021000
*  END;                                                         04S0459 01022000
*                                      /* RETURN TO RDENTRY.         */ 01023000
*  END;                                                         03S0460 01024000
*  ELSE IF NIPPARC = SIXTEEN           /* IF EOF WAS RETURNED, THEN  */ 01025000
*    THEN READ = NO;                   /* SET READ SWITCH TO OFF.    */ 01026000
         B     @RC00343                                         03S0461 01027000
@RF00343 L     @10,NVTPAREA(,RNVT)                              03S0461 01028000
         CLC   NIPPARC(4,@10),@CF00080                          03S0461 01029000
         BNE   @RF00461                                         03S0461 01030000
         NI    READ,B'11011111'                                 03S0462 01031000
*    ELSE IF NIPPARC = FOUR            /* IF MEMBER WAS NOT FOUND,   */ 01032000
*      THEN DO;                        /* THEN ASK OPERATOR TO RE-   */ 01033000
         B     @RC00461                                         03S0463 01034000
@RF00461 L     @10,NVTPAREA(,RNVT)                              03S0463 01035000
         CLC   NIPPARC(4,@10),@CF00036                          03S0463 01036000
         BNE   @RF00463                                         03S0463 01037000
*                                      /* SPECIFY.                   */ 01038000
*/********************************************************************/ 01039000
*/*                                                                  */ 01040000
*/* SEGMENT NAME - NOLIST                                            */ 01041000
*/*                                                                  */ 01042000
*/* DESCRIPTIVE NAME - NO VATLST WITH SPECIFIED SUFFIX FOUND IN      */ 01043000
*/*                    SYS1.PARMLIB                                  */ 01044000
*/*                                                                  */ 01045000
*/* FUNCTION -                                                       */ 01046000
*/*                                                                  */ 01047000
*/*     IF 'DEFAULT' SWITCH IS ON, THEN NO MESSAGE SHOULD BE ISSUED; */ 01048000
*/*     SET 'READ' SWITCH TO NO IN ORDER TO FALL THROUGH AND EXIT.   */ 01049000
*/*                                                                  */ 01050000
*/*     IF 'DEFAULT' SWITCH IS NOT ON, THEN MOVE VATLST SUFFIX INTO  */ 01051000
*/*     MESSAGE 'IEA861A-VAL=NN NOT FOUND.  REPLY U OR CORRECT       */ 01052000
*/*     VALUE'.  ISSUE WTOR.  WAIT FOR REPLY.  IF REPLY IS EOB OR    */ 01053000
*/*     'U', THEN SET 'READ' EQUAL TO NO IN ORDER TO IGNORE THIS     */ 01054000
*/*     VATLST.  IF REPLY IS A VALUE AA, MOVE AA INTO NIPPANAM+6     */ 01055000
*/*     AND SET 'READ' EQUAL TO YES SO THAT THIS VATLST WILL BE      */ 01056000
*/*     READ.  IF REPLY IS INVALID, REISSUE WTOR.                    */ 01057000
*/*                                                                  */ 01058000
*/* ENTRY - IN-LINE SEGMENT                                          */ 01059000
*/*                                                                  */ 01060000
*/*     PURPOSE -                                                    */ 01061000
*/*                                                                  */ 01062000
*/*         ISSUE WTOR TO NOTIFY OPERATOR OF NOT-FOUND CONDITION     */ 01063000
*/*         AND OBTAIN REPLY FOR FURTHER ACTION.                     */ 01064000
*/*                                                                  */ 01065000
*/*     INPUT DATA -                                                 */ 01066000
*/*                                                                  */ 01067000
*/*         NIPPANAM+6 - CONTAINS VATLST SUFFIX                      */ 01068000
*/*                                                                  */ 01069000
*/* EXITS -                                                          */ 01070000
*/*                                                                  */ 01071000
*/*     CONDITION - LIST NOT FOUND IS THE DEFAULT LIST               */ 01072000
*/*                                                                  */ 01073000
*/*     OUTPUT DATA -                                                */ 01074000
*/*                                                                  */ 01075000
*/*         READ - SET TO OFF                                        */ 01076000
*/*                                                                  */ 01077000
*/*     CONDITION - LIST NOT FOUND WAS SPECIFIED                     */ 01078000
*/*                                                                  */ 01079000
*/*     OUTPUT DATA -                                                */ 01080000
*/*                                                                  */ 01081000
*/*         MESSAGE IEA861A IS ISSUED                                */ 01082000
*/*                                                                  */ 01083000
*/*     CONDITION - REPLY TO IEA861A IS EOB OR 'U'                   */ 01084000
*/*                                                                  */ 01085000
*/*     OUTPUT DATA -                                                */ 01086000
*/*                                                                  */ 01087000
*/*         READ - SET TO OFF                                        */ 01088000
*/*                                                                  */ 01089000
*/*     CONDITION - REPLY TO IEA861A IS VALUE                        */ 01090000
*/*                                                                  */ 01091000
*/*     OUTPUT DATA -                                                */ 01092000
*/*                                                                  */ 01093000
*/*         NIPPANAM+6 - UPDATED TO A NEW VALUE                      */ 01094000
*/*         READ - SET TO ON                                         */ 01095000
*/*                                                                  */ 01096000
*/*     RETURN CODE - NONE                                           */ 01097000
*/*                                                                  */ 01098000
*/********************************************************************/ 01099000
*                                                               04S0465 01100000
*IF DEFAULT = YES                      /*IF LIST NOT FOUND IS DEFAULT   01101000
*                                        VATLST, THEN VOLUME ATTRIBUTE  01102000
*                                        PROCESSOR NOT DESIRED.      */ 01103000
*  THEN READ = NO;                                              04S0465 01104000
         TM    DEFAULT,B'10000000'                              04S0465 01105000
         BNO   @RF00465                                         04S0465 01106000
         NI    READ,B'11011111'                                 04S0466 01107000
*  ELSE DO;                                                     04S0467 01108000
         B     @RC00465                                         04S0467 01109000
@RF00465 DS    0H                                               04S0468 01110000
*    NN861 = SUFFIX;                   /*OBTAIN VATLST NUMBER FOR MSG*/ 01111000
         L     @10,NVTPAREA(,RNVT)                              04S0468 01112000
         MVC   NN861(2),SUFFIX(@10)                             04S0468 01113000
*    BADREPLY = YES;                                            04S0469 01114000
         OI    BADREPLY,B'10000000'                             04S0469 01115000
*    DO WHILE BADREPLY = YES;                                   04S0470 01116000
         B     @DE00470                                         04S0470 01117000
@DL00470 DS    0H                                               04S0471 01118000
*      BADREPLY = NO;                                           04S0471 01119000
         NI    BADREPLY,B'01111111'                             04S0471 01120000
*      WTORBUF = BLANK;                /*BLANK OUT REPLY AREA        */ 01121000
         MVI   WTORBUF+1,C' '                                   04S0472 01122000
         MVC   WTORBUF+2(78),WTORBUF+1                          04S0472 01123000
         MVI   WTORBUF,C' '                                     04S0472 01124000
*      GEN REFS(NVTWTOR);              /*ISSUE WTOR FOR MSG IEA861A  */ 01125000
*      IEA861A VAL=NN NOT FOUND. REPLY U OR CORRECT VALUE.              01126000
           IEAPMNIP TYPE=WTOR,PARAM=IEA861A                             01127000
*      IF SCAN2 = REPLYU               /*CHECK FOR REPLY OF U OR EOB */ 01128000
*        | SCAN2 = REPLYEOB                                     04S0474 01129000
*        THEN READ = NO;               /*NOTHING TO READ             */ 01130000
         CLC   SCAN2(2),@CC00168                                04S0474 01131000
         BE    @RT00474                                         04S0474 01132000
         CLC   SCAN2(2),@CC00170                                04S0474 01133000
         BNE   @RF00474                                         04S0474 01134000
@RT00474 DS    0H                                               04S0475 01135000
         NI    READ,B'11011111'                                 04S0475 01136000
*        ELSE IF SCAN2A = QUOTE        /*REPLY IS TWO CHARACTERS     */ 01137000
*          THEN DO;                                             04S0476 01138000
         B     @RC00474                                         04S0476 01139000
@RF00474 CLI   SCAN2A,C''''                                     04S0476 01140000
         BNE   @RF00476                                         04S0476 01141000
*            SUFFIX = SCAN2;           /*MOVE VATLST NUMBER INTO        01142000
*                                        READ AREA.                  */ 01143000
         L     @10,NVTPAREA(,RNVT)                              04S0478 01144000
         MVC   SUFFIX(2,@10),SCAN2                              04S0478 01145000
*            READ = YES;               /*READ THIS VATLST            */ 01146000
         OI    READ,B'00100000'                                 04S0479 01147000
*          END;                                                 04S0480 01148000
*          ELSE BADREPLY = YES;        /*REISSUE WTOR                */ 01149000
         B     @RC00476                                         04S0481 01150000
@RF00476 OI    BADREPLY,B'10000000'                             04S0481 01151000
*    END;                                                       04S0482 01152000
@RC00476 DS    0H                                               04S0482 01153000
@RC00474 DS    0H                                               04S0482 01154000
@DE00470 TM    BADREPLY,B'10000000'                             04S0482 01155000
         BO    @DL00470                                         04S0482 01156000
*  END;                                                         04S0483 01157000
*                                      /* RETURN TO RDENTRY.         */ 01158000
*      END;                                                     03S0484 01159000
*      ELSE DO;                        /* IF I/O ERROR, GET INSTRUCT-*/ 01160000
         B     @RC00463                                         03S0485 01161000
@RF00463 DS    0H                                               03S0486 01162000
*                                      /* IONS FROM OPERATOR.        */ 01163000
*/********************************************************************/ 01164000
*/*                                                                  */ 01165000
*/* SEGMENT NAME - RDERR                                             */ 01166000
*/*                                                                  */ 01167000
*/* DESCRIPTIVE NAME - I/O ERROR READING VATLST ENTRY                */ 01168000
*/*                                                                  */ 01169000
*/* FUNCTION -                                                       */ 01170000
*/*                                                                  */ 01171000
*/*     MOVE VATLST SUFFIX INTO MESSAGE 'IEA949A-I/O ERROR READING   */ 01172000
*/*     VATLSTNN.  REPLY YES FOR LIST OF ENTRIES THAT WILL BE        */ 01173000
*/*     PROCESSED, OR U FOR NO LIST.  IF REPLY IS 'YES', THEN        */ 01174000
*/*     EXECUTE SEGMENT THAT PUTS OUT INFORMATIONAL MESSAGE.  IF     */ 01175000
*/*     REPLY IS NOT 'YES' OR 'U', REISSUE MESSAGE IEA949A.          */ 01176000
*/*                                                                  */ 01177000
*/*     ISSUE MESSAGE 'IEA853A-REPLY CONT, END, OR RESPECIFY'.       */ 01178000
*/*     WAIT FOR REPLY.  IF REPLY IS CONT OR END, SET 'READ' EQUAL   */ 01179000
*/*     TO NO, TO INDICATE NO MORE ENTRIES SHOULD BE READ FROM THE   */ 01180000
*/*     CURRENT VATLST.                                              */ 01181000
*/*                                                                  */ 01182000
*/*     IF REPLY IS END, THEN SET 'PEND' EQUAL TO YES TO TERMINATE   */ 01183000
*/*     VATLST PROCESSING.  IF REPLY IS CONT, THEN GO ON TO PROCESS  */ 01184000
*/*     ANY OTHER VATLSTS.  IF REPLY IS A NEW LIST, MOVE NUMBER      */ 01185000
*/*     INTO NIPPANAM+6 AND SET 'READ' EQUAL TO YES.  IF REPLY IS    */ 01186000
*/*     INVALID, REISSUE MESSAGE IEA853A AND PROCESS AS ABOVE.       */ 01187000
*/*                                                                  */ 01188000
*/* ENTRY - IN-LINE SEGMENT                                          */ 01189000
*/*                                                                  */ 01190000
*/*     PURPOSE -                                                    */ 01191000
*/*                                                                  */ 01192000
*/*         ISSUE MESSAGE TO INFORM OPERATOR OF I/O ERROR AND        */ 01193000
*/*         PROCESS REPLY.                                           */ 01194000
*/*                                                                  */ 01195000
*/*     INPUT DATA -                                                 */ 01196000
*/*                                                                  */ 01197000
*/*         NIPPANAM+6 - CONTAINS VATLST SUFFIX                      */ 01198000
*/*                                                                  */ 01199000
*/* EXITS -                                                          */ 01200000
*/*                                                                  */ 01201000
*/*     CONDITION - NORMAL                                           */ 01202000
*/*                                                                  */ 01203000
*/*     OUTPUT DATA -                                                */ 01204000
*/*                                                                  */ 01205000
*/*         MESSAGE IEA949A IS ISSUED                                */ 01206000
*/*         MESSAGE IEA853A IS ISSUED                                */ 01207000
*/*         READ - SET TO OFF IF REPLY TO IEA853A IS CONT OR END     */ 01208000
*/*                SET TO ON IF REPLY IS A NEW LIST                  */ 01209000
*/*         PEND - SET TO ON IF REPLY TO IEA853A IS END              */ 01210000
*/*         NIPPANAM+6 - CONTAINS NEW LIST NUMBER FOR EXCP IF        */ 01211000
*/*                      REPLY TO IEA853A IS A NEW LIST              */ 01212000
*/*                                                                  */ 01213000
*/*     RETURN CODE - NONE                                           */ 01214000
*/*                                                                  */ 01215000
*/********************************************************************/ 01216000
*                                                               04S0486 01217000
*NN949 = SUFFIX;                       /*MOVE VATLST NUMBER  @YM00442*/ 01218000
         L     @10,NVTPAREA(,RNVT)                              04S0486 01219000
         MVC   NN949(2),SUFFIX(@10)                             04S0486 01220000
*                                      /*INTO MSG            @YM00442*/ 01221000
*GEN REFS(NVTWTO);                     /*ISSUE MSG IEA949I   @YM00442*/ 01222000
*                                                               04S0487 01223000
* IEA949I I/O ERROR READING VATLSTXX.                        @YM00442*/ 01224000
         IEAPMNIP TYPE=WTO,PARAM=IEA949I                     @YM00442*/ 01225000
*IF MTLSTCT > 0                        /*MOUNT LIST CONTAINS @YM00442*/ 01226000
*  THEN DO;                            /*SOME ENTRIES        @YM00442*/ 01227000
         LH    @10,MTLSTCT                                      04S0488 01228000
         LTR   @10,@10                                          04S0488 01229000
         BNP   @RF00488                                         04S0488 01230000
*    BADREPLY = YES;                   /*INCORRECT FORMAT    @YM00442*/ 01231000
         OI    BADREPLY,B'10000000'                             04S0490 01232000
*    DO WHILE (BADREPLY = YES);        /*                    @YM00442*/ 01233000
         B     @DE00491                                         04S0491 01234000
@DL00491 DS    0H                                               04S0492 01235000
*      BADREPLY = NO;                  /*                    @YM00442*/ 01236000
         NI    BADREPLY,B'01111111'                             04S0492 01237000
*      GEN REFS(NVTWTOR);              /*ISSUE MSG IEA949A   @YM00442*/ 01238000
*                                                               04S0493 01239000
* IEA949A REPLY YES FOR LIST OF ENTRIES THAT WILL BE         @YM00442   01240000
* PROCESSED, OR U FOR NO LIST.                               @YM00442   01241000
         IEAPMNIP TYPE=WTOR,PARAM=IEA949A                    @YM00442   01242000
*      IF SCAN3 = COMPYES              /*CHECK FOR  'YES'    @YM00442*/ 01243000
*        THEN DO;                      /*ISSUE INFO LIST     @YM00442*/ 01244000
         CLC   SCAN3(3),@CC00136                                04S0494 01245000
         BNE   @RF00494                                         04S0494 01246000
*/********************************************************************/ 01247000
*/*                                                                  */ 01248000
*/* SEGMENT NAME - INFOLIST                                          */ 01249000
*/*                                                                  */ 01250000
*/* DESCRIPTIVE NAME - INFORMATIONAL LISTING OF VOLUMES TO BE        */ 01251000
*/*                    PROCESSED                                     */ 01252000
*/*                                                                  */ 01253000
*/* FUNCTION -                                                       */ 01254000
*/*                                                                  */ 01255000
*/*     ISSUE WTO FOR HEADER MESSAGE 'IEA850I-FOLLOWING WILL @YM00442*/ 01256000
*/*     BE PROCESSED.                                        @YM00442*/ 01257000
*/*                                                                  */ 01258000
*/*     FOR EACH ENTRY IN LIST, FILL IN MESSAGE TEXT WITH    @YM00442*/ 01259000
*/*     VOLUME SERIAL, DEVICE TYPE AND ATTRIBUTES.  ISSUE    @YM00442*/ 01260000
*/*     WTO 'SER ON UUUUUUUU CCC-CCC'.                       @YM00442*/ 01261000
*/*                                                                  */ 01262000
*/* ENTRY - IN-LINE SEGMENT                                          */ 01263000
*/*                                                                  */ 01264000
*/*     PURPOSE -                                                    */ 01265000
*/*                                                                  */ 01266000
*/*         LIST VOLUME ENTRIES IN MOUNT LIST BEFORE ERROR   @YM00442*/ 01267000
*/*         OCCURRED.                                        @YM00442*/ 01268000
*/*                                                                  */ 01269000
*/*     INPUT DATA -                                                 */ 01270000
*/*                                                                  */ 01271000
*/*         MNTLIST - MOUNT LIST                             @YM00442*/ 01272000
*/*         MTLSTCT - NUMBER OF ENTRIES IN MOUNT LIST        @YM00442*/ 01273000
*/*                                                                  */ 01274000
*/* EXITS -                                                          */ 01275000
*/*                                                                  */ 01276000
*/*     CONDITION - NORMAL                                           */ 01277000
*/*                                                                  */ 01278000
*/*     OUTPUT DATA -                                                */ 01279000
*/*                                                                  */ 01280000
*/*         MESSAGE IEA850I AND SECONDARY MESSAGES ISSUED            */ 01281000
*/*                                                                  */ 01282000
*/*     RETURN CODE - NONE                                           */ 01283000
*/*                                                                  */ 01284000
*/********************************************************************/ 01285000
*                                                               05S0496 01286000
*GEN REFS(NVTWTO);                     /*ISSUE HEADER MESSAGE IEA850I*/ 01287000
*                                                               05S0496 01288000
* IEA850I FOLLOWING WILL BE PROCESSED.                       @YM00442   01289000
         IEAPMNIP TYPE=WTO,PARAM=IEA850I                                01290000
*DO I = ONE TO MTLSTCT;                /*LOOP THROUGH LIST   @YM00442*/ 01291000
         LA    @10,1                                            05S0497 01292000
         B     @DE00497                                         05S0497 01293000
@DL00497 DS    0H                                               05S0498 01294000
*  MAPAD = ADDR(MNTLIST(I));           /*                    @YM00442*/ 01295000
         MH    @10,@CH00190                                     05S0498 01296000
         LA    @10,MNTLIST-22(@10)                              05S0498 01297000
         ST    @10,MAPAD                                        05S0498 01298000
*  SER850 = EVOLSER;                   /*MOVE VOLSER INTO MSG@YM00442*/ 01299000
         MVC   SER850(6),EVOLSER(@10)                           05S0499 01300000
*  DEV850 = EDEVTYPE;                  /*MOVE DEVICE TYPE    @YM00442*/ 01301000
         MVC   DEV850(8),EDEVTYPE(@10)                          05S0500 01302000
*  IF EMNTCHAR = RSV                   /*DETERMINE MOUNT ATTR@YM00442*/ 01303000
*    THEN MT850 = MSGRSV;              /*MOVE 'RSV' INTO MSG @YM00442*/ 01304000
         CLI   EMNTCHAR(@10),C'1'                               05S0501 01305000
         BNE   @RF00501                                         05S0501 01306000
         MVC   MT850(3),@CC02472                                05S0502 01307000
*    ELSE MT850 = MSGPR;               /*OTHERWISE MOVE 'P/R'@YM00442*/ 01308000
         B     @RC00501                                         05S0503 01309000
@RF00501 MVC   MT850(3),@CC02470                                05S0503 01310000
*  IF EUSEATTR = STR                   /*DETERMINE USE ATTR  @YM00442*/ 01311000
*    THEN USE850 = MSGSTR;             /*MOVE 'STR' INTO MSG @YM00442*/ 01312000
@RC00501 L     @10,MAPAD                                        05S0504 01313000
         CLI   EUSEATTR(@10),C'0'                               05S0504 01314000
         BNE   @RF00504                                         05S0504 01315000
         MVC   USE850(3),@CC02474                               05S0505 01316000
*    ELSE IF EUSEATTR = PRIV           /*                    @YM00442*/ 01317000
*      THEN USE850 = MSGPRV;           /*MOVE 'PRV' INTO MSG @YM00442*/ 01318000
         B     @RC00504                                         05S0506 01319000
@RF00504 L     @10,MAPAD                                        05S0506 01320000
         CLI   EUSEATTR(@10),C'2'                               05S0506 01321000
         BNE   @RF00506                                         05S0506 01322000
         MVC   USE850(3),@CC02476                               05S0507 01323000
*      ELSE USE850 = MSGPUB;           /*MOVE 'PUB' INTO MSG @YM00442*/ 01324000
         B     @RC00506                                         05S0508 01325000
@RF00506 MVC   USE850(3),@CC02478                               05S0508 01326000
*      GEN REFS(NVTWTO);               /*WRITE A LINE OF MSG         */ 01327000
@RC00506 DS    0H                                               05S0509 01328000
@RC00504 DS    0H                                               05S0509 01329000
*       SER ON UUUUUUUU CCC-CCC                              @YM00442   01330000
         IEAPMNIP TYPE=WTO,PARAM=IEA850I2                               01331000
*END;                                  /*                    @YM00442*/ 01332000
         LA    @10,1                                            05S0510 01333000
         AH    @10,I                                            05S0510 01334000
@DE00497 STH   @10,I                                            05S0510 01335000
         CH    @10,MTLSTCT                                      05S0510 01336000
         BNH   @DL00497                                         05S0510 01337000
*        END;                          /*                    @YM00442*/ 01338000
*        ELSE IF SCAN2 ^= REPLYU       /*BAD REPLY           @YM00442*/ 01339000
*          & SCAN2 ^= REPLYEOB                                  04S0512 01340000
*          THEN BADREPLY = YES;        /*NOT 'YES', 'U', EOB @YM00442*/ 01341000
         B     @RC00494                                         04S0512 01342000
@RF00494 CLC   SCAN2(2),@CC00168                                04S0512 01343000
         BE    @RF00512                                         04S0512 01344000
         CLC   SCAN2(2),@CC00170                                04S0512 01345000
         BE    @RF00512                                         04S0512 01346000
         OI    BADREPLY,B'10000000'                             04S0513 01347000
*    END;                              /*                    @YM00442*/ 01348000
@RF00512 DS    0H                                               04S0514 01349000
@RC00494 DS    0H                                               04S0514 01350000
@DE00491 TM    BADREPLY,B'10000000'                             04S0514 01351000
         BO    @DL00491                                         04S0514 01352000
*  END;                                /*                    @YM00442*/ 01353000
*                                                               04S0515 01354000
*BADREPLY = YES;                       /*INCORRECT FORMAT IN REPLY   */ 01355000
@RF00488 OI    BADREPLY,B'10000000'                             04S0516 01356000
*DO WHILE (BADREPLY = YES);                                     04S0517 01357000
         B     @DE00517                                         04S0517 01358000
@DL00517 DS    0H                                               04S0518 01359000
*BADREPLY = NO;                                                 04S0518 01360000
         NI    BADREPLY,B'01111111'                             04S0518 01361000
*WTORBUF = BLANK;                      /*BLANK OUT REPLY AREA        */ 01362000
         MVI   WTORBUF+1,C' '                                   04S0519 01363000
         MVC   WTORBUF+2(78),WTORBUF+1                          04S0519 01364000
         MVI   WTORBUF,C' '                                     04S0519 01365000
*GEN REFS(NVTWTOR);                    /*ISSUE MESSSAGE IEA853A      */ 01366000
*                                                               04S0520 01367000
* IEA853A REPLY CONT, END, OR RESPECIFY.                                01368000
         IEAPMNIP TYPE=WTOR,PARAM=IEA853A /*                 @YM00442*/ 01369000
*IF SCAN4 = COMPCONT                   /*CHECK FOR REPLY OF 'CONT'   */ 01370000
*  THEN READ = NO;                     /*DON'T READ ANY MORE ENTRIES    01371000
*                                        FROM THIS VATLST            */ 01372000
         CLC   SCAN4(4),@CC00134                                04S0521 01373000
         BNE   @RF00521                                         04S0521 01374000
         NI    READ,B'11011111'                                 04S0522 01375000
*  ELSE IF SCAN3 = COMPEND             /*CHECK FOR REPLY OF 'END'    */ 01376000
*    THEN DO;                                                   04S0523 01377000
         B     @RC00521                                         04S0523 01378000
@RF00521 CLC   SCAN3(3),@CC00132                                04S0523 01379000
         BNE   @RF00523                                         04S0523 01380000
*      READ = NO;                      /*DON'T READ ANY MORE ENTRIES */ 01381000
*      PEND = YES;                     /*DON'T READ ANY MORE VATLSTS */ 01382000
         OI    PEND,B'01000000'                                 04S0526 01383000
         NI    READ,B'11011111'                                 04S0526 01384000
*    END;                                                       04S0527 01385000
*    ELSE IF SCAN2A = QUOTE            /*CHECK VALIDITY OF REPLY     */ 01386000
*      THEN DO;                        /*GOOD REPLY                  */ 01387000
         B     @RC00523                                         04S0528 01388000
@RF00523 CLI   SCAN2A,C''''                                     04S0528 01389000
         BNE   @RF00528                                         04S0528 01390000
*        SUFFIX = SCAN2;               /*MOVE REPLY TO READ AREA     */ 01391000
         L     @10,NVTPAREA(,RNVT)                              04S0530 01392000
         MVC   SUFFIX(2,@10),SCAN2                              04S0530 01393000
*        READ = YES;                   /*READ THIS VATLST            */ 01394000
         OI    READ,B'00100000'                                 04S0531 01395000
*      END;                                                     04S0532 01396000
*      ELSE DO;                        /*INCORRECT REPLY             */ 01397000
         B     @RC00528                                         04S0533 01398000
@RF00528 DS    0H                                               04S0534 01399000
*        BADREPLY = YES;               /*REPEAT MESSAGE              */ 01400000
         OI    BADREPLY,B'10000000'                             04S0534 01401000
*      END;                                                     04S0535 01402000
*END;                                  /*RETURN TO RDENTRY.          */ 01403000
@RC00528 DS    0H                                               04S0536 01404000
@RC00523 DS    0H                                               04S0536 01405000
@RC00521 DS    0H                                               04S0536 01406000
@DE00517 TM    BADREPLY,B'10000000'                             04S0536 01407000
         BO    @DL00517                                         04S0536 01408000
*      END;                                                     03S0537 01409000
*                                      /* RETURN TO SYSPARMS.        */ 01410000
*END;                                  /*RETURN TO TOP SEGMENT.      */ 01411000
*                                                               02S0538 01412000
@RC00463 DS    0H                                               02S0538 01413000
@RC00461 DS    0H                                               02S0538 01414000
@RC00343 DS    0H                                               02S0538 01415000
@DE00340 TM    READ,B'00100000'                                 02S0538 01416000
         BO    @DL00340                                         02S0538 01417000
*END;                                                           01S0539 01418000
@DE00325 TM    PEND,B'01000000'                                 01S0539 01419000
         BZ    @DL00325                                         01S0539 01420000
*DPLOADED = YES;                       /* INIT DP SWITCH     @ZA14221*/ 01421000
         OI    DPLOADED,B'01000000'                             01S0540 01422000
*DATAPATH = ZERO;                      /* POINTER TO DP RTN. @ZA14221*/ 01423000
         SLR   @10,@10                                          01S0541 01424000
         ST    @10,DATAPATH                                     01S0541 01425000
*RFY (FINDPATH) RSTD;                  /*                    @ZA14221*/ 01426000
*  DO;        /*LOAD EP(NIEEVDEV) ERRET(ERR) */                 01S0543 01427000
*  RESPECIFY (GPR00P,GPR01P,GPR15F) RESTRICTED;                 01S0544 01428000
*  GPR00P=ADDR(NIEEVDEV);   /*LOAD ENTRY POINT NAME ADDRESS*/   01S0545 01429000
         LA    GPR00P,NIEEVDEV                                  01S0545 01430000
*  GPR01P=0;     /*JOBLIB OR LINKLIB DCB*/                      01S0546 01431000
         SLR   GPR01P,GPR01P                                    01S0546 01432000
*  GPR01P=GPR01P|'80000000'X; /*ERROR RETURN LABEL SPECIFIED*/  01S0547 01433000
         O     GPR01P,@CF02508                                  01S0547 01434000
*  SVC   (8);  /*ISSUE LOAD SVC*/                               01S0548 01435000
         SVC   8                                                01S0548 01436000
*  IF GPR15F ^= 0 THEN   /*LOAD WAS UNSUCCESSFUL*/              01S0549 01437000
         LTR   GPR15F,GPR15F                                    01S0549 01438000
         BNZ   @RT00549                                         01S0549 01439000
*    GOTO ERR;   /*BRANCH TO ERROR LOCATION*/                   01S0550 01440000
*  RESPECIFY (GPR00P,GPR01P,GPR15F) UNRESTRICTED;               01S0551 01441000
*  END;       /*LOAD EP(NIEEVDEV) ERRET(ERR) */       /* LOAD DATA PATH 01442000
*RTN.@ZA14221*/                                                 01S0552 01443000
*DATAPATH = FINDPATH;                  /* SAVE IN CORE ADDR. @ZA14221*/ 01444000
         ST    FINDPATH,DATAPATH                                01S0553 01445000
*RFY (FINDPATH) UNRSTD;                /*                    @ZA14221*/ 01446000
*ERR:IF DATAPATH = ZERO                /* WAS VDEV LOADED?   @ZA14221*/ 01447000
*      THEN DPLOADED = NO;             /* NO SET SWITCH OFF  @ZA14221*/ 01448000
ERR      L     @10,DATAPATH                                     01S0555 01449000
         LTR   @10,@10                                          01S0555 01450000
         BNZ   @RF00555                                         01S0555 01451000
         NI    DPLOADED,B'10111111'                             01S0556 01452000
*DO;                                   /* PROC. VALID ENT.   @ZA14221*/ 01453000
@RF00555 DS    0H                                               01S0558 01454000
*/********************************************************************/ 01455000
*/*                                                                  */ 01456000
*/* SEGMENT NAME - LISTPROC                                          */ 01457000
*/*                                                                  */ 01458000
*/* DESCRIPTIVE NAME - PROCESS COMPILED VATLST ENTRIES               */ 01459000
*/*                                                                  */ 01460000
*/* FUNCTION -                                                       */ 01461000
*/*     FOR EACH ENTRY IN THE LIST, EXECUTE THE SEGMENT 'FINDVOL' TO */ 01462000
*/*     DETERMINE IF A VOLUME IS MOUNTED WITH THAT VOLSER. IF IT IS, */ 01463000
*/*     AND IF THE ENTRY IS REAL AND THE DEVICE TYPES MATCH, @Y30LPPD*/ 01464000
*/*     OR THE ENTRY IS VIRTUAL AND THE VUA'S MATCH, THEN    @Y30LPPD*/ 01465000
*/*     CALL ROUTINE 'SETSTAT' AND REMOVE THE ENTRY FROM     @Y30LPPD*/ 01466000
*/*     THE LIST. IF THE DEVTYPES OR VUA'S DON'T MATCH, GO TO@Y30LPPD*/ 01467000
*/*     SEGMENT 'WRONGVOL' TO PUT OUT ERROR MESSAGES.        @Y30LPPD*/ 01468000
*/*                                                                  */ 01469000
*/*     IF THE VOLUME IS NOT MOUNTED AND THE ENTRY SPECIFIES @Y30LPPD*/ 01470000
*/*     AN MSS VOLUME, EXECUTE THE SEGMENT VIRTMONT TO MOUNT @Y30LPPD*/ 01471000
*/*     IT. IF THE ENTRY IS NOT FOR AN MSS VOLUME AND IF     @Y30LPPD*/ 01472000
*/*     THE MOUNT PRIORITY INDICATES THAT THE MOUNT MESSAGE IS TO BE */ 01473000
*/*     SUPPRESSED, REMOVE THE ENTRY FROM THE LIST. OTHERWISE,       */ 01474000
*/*     INCREASE THE DEVICE TYPE COUNT FOR THIS ENTRY'S DEVICE TYPE. */ 01475000
*/*                                                                  */ 01476000
*/* OPERATION -                                              @Y30LPPD*/ 01477000
*/*                                                          @Y30LPPD*/ 01478000
*/*     ENTRIES ARE REMOVED FROM THE MOUNTLIST BY COVERING   @Y30LPPD*/ 01479000
*/*     THE CURRENT ENTRY WITH THE LAST ENTRY. THEN THE      @Y30LPPD*/ 01480000
*/*     NUMBER OF ENTRIES IS DECREASED.                      @Y30LPPD*/ 01481000
*/*                                                          @Y30LPPD*/ 01482000
*/* ENTRY - IN-LINE SEGMENT                                          */ 01483000
*/*                                                                  */ 01484000
*/*     PURPOSE - SEE FUNCTION                                       */ 01485000
*/*                                                                  */ 01486000
*/*     INPUT DATA -                                                 */ 01487000
*/*                                                                  */ 01488000
*/*         MNTLIST - COMPOSITE LIST OF VATLST ENTRIES               */ 01489000
*/*         MTLSTCT - NUMBER OF ENTRIES IN MNTLIST                   */ 01490000
*/*                                                                  */ 01491000
*/* EXITS -                                                          */ 01492000
*/*                                                                  */ 01493000
*/*     CONDITION - NORMAL                                           */ 01494000
*/*                                                                  */ 01495000
*/*     OUTPUT DATA -                                                */ 01496000
*/*                                                                  */ 01497000
*/*         MNTLIST - CONTAINS ONLY NON-MOUNTED VOLUME ENTRIES       */ 01498000
*/*                                                                  */ 01499000
*/*     CONDITION - INCONSISTENT DEVICE TYPE ON P/R VOLUME           */ 01500000
*/*                                                                  */ 01501000
*/*     OUTPUT DATA -                                                */ 01502000
*/*         MESSAGE IEA866I                                          */ 01503000
*/*         MESSAGE IEA947A                                          */ 01504000
*/*         MNTLIST - MODIFIED                                       */ 01505000
*/*         MTLSTCT - MODIFIED                                       */ 01506000
*/*                                                                  */ 01507000
*/*     CONDITION - INCONSISTENT DEVICE TYPE ON NON-P/R VOLUME       */ 01508000
*/*                                                                  */ 01509000
*/*     OUTPUT DATA -                                                */ 01510000
*/*                                                                  */ 01511000
*/*         MESSAGE IEA866I                                          */ 01512000
*/*         MESSAGE IEA948I                                          */ 01513000
*/*                                                                  */ 01514000
*/*     CONDITION - INCONSISTENT VUA FOR VIRTUAL VOLUME,     @Y30LPPD*/ 01515000
*/*                 DEMOUNT FAILS.                           @Y30LPPD*/ 01516000
*/*                                                                  */ 01517000
*/*     OUTPUT DATA -                                        @Y30LPPD*/ 01518000
*/*         MESSAGE IEA985I                                  @Y30LPPD*/ 01519000
*/*         MESSAGE IEA866I                                  @Y30LPPD*/ 01520000
*/*                                                                  */ 01521000
*/*     RETURN CODE - NONE                                           */ 01522000
*/*                                                                  */ 01523000
*/********************************************************************/ 01524000
*                                                               02S0558 01525000
*I = ONE;                                                       02S0558 01526000
*                                                               02S0558 01527000
         MVC   I(2),@CH00042                                    02S0558 01528000
*DO WHILE (I <= MTLSTCT);              /*SCAN LIST & PROCESS ENTRIES */ 01529000
*                                                               02S0559 01530000
         B     @DE00559                                         02S0559 01531000
@DL00559 DS    0H                                               02S0560 01532000
*  MAPAD = ADDR(MNTLIST(I));           /*ADDRESS ENTRY MAPPING       */ 01533000
         LH    @10,I                                            02S0560 01534000
         MH    @10,@CH00190                                     02S0560 01535000
         LA    @10,MNTLIST-22(@10)                              02S0560 01536000
         ST    @10,MAPAD                                        02S0560 01537000
*  DO;                                 /*LOCATE UCB WITH THIS VOLSER */ 01538000
*/********************************************************************/ 01539000
*/*                                                                  */ 01540000
*/* SEGMENT NAME - FINDVOL                                           */ 01541000
*/*                                                                  */ 01542000
*/* DESCRIPTIVE NAME - FIND THE UCB CONTAINING THE VOLUME SERIAL     */ 01543000
*/*                    NUMBER                                        */ 01544000
*/*                                                                  */ 01545000
*/* FUNCTION -                                                       */ 01546000
*/*                                                                  */ 01547000
*/*     FILL IN 'NMNTVS' (IN NIP MOUNT PARAMETER AREA) WITH THE      */ 01548000
*/*     VOLUME SERIAL NUMBER OBTAINED FROM THE CURRENT VATLST ENTRY. */ 01549000
*/*     ISSUE MACRO (IEAPMNIP TYPE=MOUNT, PARAM=LABEL,OPT=(,,,US))   */ 01550000
*/*     TO OBTAIN UCB ADDRESS.  UCBPTR WILL CONTAIN THE UCB ADDRESS. */ 01551000
*/*     (IF NOT FOUND, UCBPTR WILL BE ZERO.)                         */ 01552000
*/*                                                                  */ 01553000
*/* ENTRY - IN-LINE SEGMENT                                          */ 01554000
*/*                                                                  */ 01555000
*/*     PURPOSE -                                                    */ 01556000
*/*                                                                  */ 01557000
*/*         TO OBTAIN THE ADDRESS OF THE UCB CONTAINING THE VOLUME   */ 01558000
*/*         SERIAL NUMBER IN THE CURRENT VATLST ENTRY.               */ 01559000
*/*                                                                  */ 01560000
*/*     INPUT DATA -                                                 */ 01561000
*/*                                                                  */ 01562000
*/*         CURRENT VATLST ENTRY                                     */ 01563000
*/*                                                                  */ 01564000
*/* EXITS -                                                          */ 01565000
*/*                                                                  */ 01566000
*/*     CONDITION - NORMAL                                           */ 01567000
*/*                                                                  */ 01568000
*/*     OUTPUT DATA -                                                */ 01569000
*/*                                                                  */ 01570000
*/*         UCBPTR - CONTAINS UCB ADDRESS OR ZERO                    */ 01571000
*/*                                                                  */ 01572000
*/*     RETURN CODE - NONE                                           */ 01573000
*/*                                                                  */ 01574000
*/********************************************************************/ 01575000
*                                                               03S0562 01576000
*GEN DATA DEFS(NIPMNT);                                         03S0562 01577000
*RFY NIPMNTPL BASED(ADDR(NIPMNT));                              03S0563 01578000
*NMNTVS = EVOLSER;                     /*MOVE VOL SER INTO PARAMETER    01579000
*                                        LIST FOR UCB FIND           */ 01580000
         LA    @10,NIPMNT                                       03S0564 01581000
         L     @05,MAPAD                                        03S0564 01582000
         MVC   NMNTVS(6,@10),EVOLSER(@05)                       03S0564 01583000
*RFY RPARM RSTD;                                                03S0565 01584000
*GEN REFS(NVTMOUNT);                   /*FIND UCB W/GIVEN VOL SERIAL */ 01585000
         IEAPMNIP TYPE=MOUNT,PARAM=NIPMNT,OPT=(,,,US)                   01586000
*UCBPTR = RPARM;                       /*SAVE UCB ADDRESS            */ 01587000
         ST    RPARM,UCBPTR                                     03S0567 01588000
*RFY RPARM UNRSTD;                                              03S0568 01589000
*                                      /* RETURN TO LISTPROC.        */ 01590000
*  END;                                                         02S0569 01591000
*  J = DEVENT(I);                      /*OBTAIN UNIT TYPE INDEX      */ 01592000
         LH    @10,I                                            02S0570 01593000
         MH    @10,@CH00190                                     02S0570 01594000
         SLR   @05,@05                                          02S0570 01595000
         IC    @05,DEVENT-22(@10)                               02S0570 01596000
         STH   @05,J                                            02S0570 01597000
*  IF UCBPTR ^= ZERO                   /*VOLUME IS MOUNTED           */ 01598000
*    THEN IF ((J <= NUMSUPTD) &        /*IS ENTRY FOR REAL & @Y30LPPD*/ 01599000
         L     @10,UCBPTR                                       02S0571 01600000
         LTR   @10,@10                                          02S0571 01601000
         BZ    @RF00571                                         02S0571 01602000
*            (UCBRVDEV = OFF) &        /*UCB FOR REAL &      @Y30LPPD*/ 01603000
*            (UCBTYPE(J) = UCBTBYT4)) | /*DEVICE TYPES MATCH?@Y30LPPD*/ 01604000
*            ((J > NUMSUPTD) &         /*OR IS DEVICE VIRTUAL@Y30LPPD*/ 01605000
*            (EDEVTYPE(2:4) = UCBNAME)) /*AND VUA'S MATCH?   @Y30LPPD*/ 01606000
*      THEN DO;                        /*YES-                @Y30LPPD*/ 01607000
         CH    @05,@CH00084                                     02S0572 01608000
         BH    @GL00009                                         02S0572 01609000
         TM    UCBRVDEV(@10),B'00001000'                        02S0572 01610000
         BNZ   @GL00009                                         02S0572 01611000
         MH    @05,@CH01793                                     02S0572 01612000
         SLR   @15,@15                                          02S0572 01613000
         IC    @15,UCBTYPE-14(@05)                              02S0572 01614000
         MVC   @ZT00003+3(1),UCBTBYT4(@10)                      02S0572 01615000
         C     @15,@ZT00003                                     02S0572 01616000
         BE    @RT00572                                         02S0572 01617000
@GL00009 LH    @10,J                                            02S0572 01618000
         CH    @10,@CH00084                                     02S0572 01619000
         BNH   @RF00572                                         02S0572 01620000
         L     @10,MAPAD                                        02S0572 01621000
         L     @05,UCBPTR                                       02S0572 01622000
         CLC   EDEVTYPE+1(3,@10),UCBNAME(@05)                   02S0572 01623000
         BNE   @RF00572                                         02S0572 01624000
@RT00572 DS    0H                                               02S0573 01625000
*        CALL SETSTAT;                 /*SET VOL ATTRIBUTES  @Y30LPPD*/ 01626000
         BAL   @14,SETSTAT                                      02S0574 01627000
*        MNTLIST(I) =MNTLIST(MTLSTCT); /*REMOVE ENTRY FROM LIST      */ 01628000
         LA    @10,22                                           02S0575 01629000
         LR    @05,@10                                          02S0575 01630000
         MH    @05,I                                            02S0575 01631000
         LA    @01,MNTLIST-22(@05)                              02S0575 01632000
         LH    @05,MTLSTCT                                      02S0575 01633000
         LR    @07,@10                                          02S0575 01634000
         MR    @06,@05                                          02S0575 01635000
         LA    @10,MNTLIST-22(@07)                              02S0575 01636000
         MVC   @TS00001(22),0(@10)                              02S0575 01637000
         MVC   0(22,@01),@TS00001                               02S0575 01638000
*        MTLSTCT = MTLSTCT - ONE;      /*DECREMENT LIST COUNT        */ 01639000
         BCTR  @05,0                                            02S0576 01640000
         STH   @05,MTLSTCT                                      02S0576 01641000
*      END;                                                     02S0577 01642000
*      ELSE DO;                        /*DEVTYPES DON'T MATCH@Y30LPPD*/ 01643000
         B     @RC00572                                         02S0578 01644000
@RF00572 DS    0H                                               02S0579 01645000
*/***********************************************************@Y30LPPD*/ 01646000
*/*                                                          @Y30LPPD*/ 01647000
*/* SEGMENT NAME - WRONGVOL                                  @Y30LPPD*/ 01648000
*/*                                                          @Y30LPPD*/ 01649000
*/* DESCRIPTIVE NAME - HANDLE ERROR OF VOLUME MOUNTED        @Y30LPPD*/ 01650000
*/*                    ON WRONG DEVICE TYPE                  @Y30LPPD*/ 01651000
*/*                                                          @Y30LPPD*/ 01652000
*/* FUNCTION -                                               @Y30LPPD*/ 01653000
*/*     ISSUE MESSAGE 'IEA866I VOLUME AAAAAA ON DDD REQUIRED @Y30LPPD*/ 01654000
*/*     ON A UUUUUUUU.'                                      @Y30LPPD*/ 01655000
*/*                                                          @Y30LPPD*/ 01656000
*/*     IF THE MOUNT LIST ENTRY IS FOR A VIRTUAL VOLUME,     @Y30LPPD*/ 01657000
*/*     ISSUE A DEMOUNT FOR THE VOLUME. IF THE DEMOUNT FAILS,@Y30LPPD*/ 01658000
*/*     ISSUE MESSAGE 'IEA985I UNABLE TO UNLOAD MSS VOLUME   @Y30LPPD*/ 01659000
*/*     AAAAAA FROM DDD - RC=RET.'                           @Y30LPPD*/ 01660000
*/*                                                          @Y30LPPD*/ 01661000
*/*     IF THE VOLUME IS P/R, REMOVE THE ENTRY FROM THE      @Y30LPPD*/ 01662000
*/*     LIST AND ISSUE MESSAGE 'IEA947A REPLY U TO           @Y30LPPD*/ 01663000
*/*     CONTINUE OR RE-IPL.' IF THE OPERATOR REPLIES 'U'     @Y30LPPD*/ 01664000
*/*     VAP WILL CONTINUE PROCESSING WITHOUT THE ENTRY. IF   @Y30LPPD*/ 01665000
*/*     THE VOLUME IS NOT P/R AND THE DEMOUNT, IF DONE, WAS  @Y30LPPD*/ 01666000
*/*     SUCCESSFUL, UNLOAD THE VOLUME AND ISSUE MESSAGE      @Y30LPPD*/ 01667000
*/*     'IEA948I DDD NOW UNLOADED.'. IF DEMOUNT NOT SUCCESS- @Y30LPPD*/ 01668000
*/*     FUL, THE VOLUME IS NOT UNLOADED.                     @Y30LPPD*/ 01669000
*/*                                                          @Y30LPPD*/ 01670000
*/* ENTRY - IN-LINE SEGMENT                                  @Y30LPPD*/ 01671000
*/*     PURPOSE - SEE FUNCTION                               @Y30LPPD*/ 01672000
*/*                                                          @Y30LPPD*/ 01673000
*/*     INPUT DATA -                                         @Y30LPPD*/ 01674000
*/*         MOUNT LIST ENTRY                                 @Y30LPPD*/ 01675000
*/*         UCB ADDRESS                                      @Y30LPPD*/ 01676000
*/*                                                          @Y30LPPD*/ 01677000
*/* EXITS -                                                  @Y30LPPD*/ 01678000
*/*                                                          @Y30LPPD*/ 01679000
*/*    CONDITION - NORMAL, VOLUME IS NOT P/R                 @Y30LPPD*/ 01680000
*/*                                                          @Y30LPPD*/ 01681000
*/*    OUTPUT DATA -                                         @Y30LPPD*/ 01682000
*/*                                                          @Y30LPPD*/ 01683000
*/*        MESSAGE IEA866I                                   @Y30LPPD*/ 01684000
*/*        MESSAGE IEA948I                                   @Y30LPPD*/ 01685000
*/*                                                          @Y30LPPD*/ 01686000
*/*    CONDITION - DEMOUNT FAILS FOR VIRTUAL VOLUME          @Y30LPPD*/ 01687000
*/*                                                          @Y30LPPD*/ 01688000
*/*    OUTPUT DATA -                                         @Y30LPPD*/ 01689000
*/*        MESSAGE IEA866I                                   @Y30LPPD*/ 01690000
*/*        MESSAGE IEA985I                                   @Y30LPPD*/ 01691000
*/*                                                          @Y30LPPD*/ 01692000
*/*    CONDITION - VOLUME IS P/R                             @Y30LPPD*/ 01693000
*/*                                                          @Y30LPPD*/ 01694000
*/*    OUTPUT DATA -                                         @Y30LPPD*/ 01695000
*/*                                                          @Y30LPPD*/ 01696000
*/*        MESSAGE IEA866I                                   @Y30LPPD*/ 01697000
*/*        MESSAGE IEA947A                                   @Y30LPPD*/ 01698000
*/*                                                          @Y30LPPD*/ 01699000
*/*    RETURN CODE - NONE                                    @Y30LPPD*/ 01700000
*/*                                                          @Y30LPPD*/ 01701000
*/********************************************************** @Y30LPPD*/ 01702000
*MSGSW = OFF;                          /*INIT FAILURE SWITCH @Y30LPPD*/ 01703000
         NI    MSGSW,B'01111111'                                03S0579 01704000
*SER866 = MVOLSER(I);                  /*MOVE VOLSER INTO MSG        */ 01705000
         LH    @10,I                                            03S0580 01706000
         MH    @10,@CH00190                                     03S0580 01707000
         LA    @05,MVOLSER-22(@10)                              03S0580 01708000
         MVC   SER866(6),0(@05)                                 03S0580 01709000
*DEV866 = UCBNAME;                     /*MOVE UNIT ADDR TO MSG       */ 01710000
         L     @05,UCBPTR                                       03S0581 01711000
         MVC   DEV866(3),UCBNAME(@05)                           03S0581 01712000
*DT866 = MDEVTYPE(I);                  /*MOVE DEVTYPE TO MSG @Y30LPPD*/ 01713000
         LA    @01,MDEVTYPE-22(@10)                             03S0582 01714000
         MVC   DT866(8),0(@01)                                  03S0582 01715000
*IF UCBRVDEV = ON &                    /*3330V DEVICE?       @Y30LPPD*/ 01716000
*   UCBTYP(3:4) = COMP3330                                      03S0583 01717000
*  THEN V866 = VIRT;                   /*YES - MOVE IN V     @Y30LPPD*/ 01718000
         TM    UCBRVDEV(@05),B'00001000'                        03S0583 01719000
         BNO   @RF00583                                         03S0583 01720000
         CLC   UCBTYP+2(2,@05),@CB00140                         03S0583 01721000
         BNE   @RF00583                                         03S0583 01722000
         MVI   V866,C'V'                                        03S0584 01723000
*  ELSE V866 = BLANK;                  /*NO - MOVE IN BLANK  @Y30LPPD*/ 01724000
         B     @RC00583                                         03S0585 01725000
@RF00583 MVI   V866,C' '                                        03S0585 01726000
*GEN REFS(NVTWTO)                                               03S0586 01727000
*(IEAPMNIP TYPE=WTO,PARAM=IEA866I);    /*ISSUE MESSAGE               */ 01728000
@RC00583 DS    0H                                               03S0586 01729000
         IEAPMNIP TYPE=WTO,PARAM=IEA866I                                01730000
*/* IEA866I VOLUME AAAAAA  ON DDD REQUIRED ON A UUUUUUU.             */ 01731000
*IF UCBRVDEV = ON &                    /*3330V DEVICE?       @Y30LPPD*/ 01732000
*  UCBTYP(3:4) = COMP3330              /*                    @Y30LPPD*/ 01733000
*  THEN DO;                            /*YES -               @Y30LPPD*/ 01734000
*                                                               03S0587 01735000
         L     @10,UCBPTR                                       03S0587 01736000
         TM    UCBRVDEV(@10),B'00001000'                        03S0587 01737000
         BNO   @RF00587                                         03S0587 01738000
         CLC   UCBTYP+2(2,@10),@CB00140                         03S0587 01739000
         BNE   @RF00587                                         03S0587 01740000
*     DCL MDREG1 REG(1) PTR; /*ADDRESS OF REQUEST BLOCK @Y30LB02*/      01741000
*     /********************************************************* @Y30LB 01742000
*2*/                                                            03S0590 01743000
*     /*MACMEAN  MSSC DEMOUNT MACRO                              @Y30LB 01744000
*2*/                                                            03S0590 01745000
*     /*VS1-4/VS2-3 VERSION--01/19/76 LEVEL 00                   @ZDR20 01746000
*8*/                                                            03S0590 01747000
*     /*THIS IS THE STANDARD FORM - DEMOUNT MACRO                @Y30LB 01748000
*2*/                                                            03S0590 01749000
*     /********************************************************* @Y30LB 01750000
*2*/                                                            03S0590 01751000
*     RFY  MDREG1 RSTD;/*RESTRICT REG 1 @Y30LB02*/              03S0590 01752000
*     MDREG1=ADDR(DMLEN);/*R1 PTR TO LIST @Y30LB02*/            03S0591 01753000
         LA    MDREG1,DMLEN                                     03S0591 01754000
*     DCL 1 ICBDMLST  STATIC LOCAL, /*DEMOUNT REQUEST BLOCK @Y30LB02*/  01755000
*         2 DMLEN  FIXED(31)INIT('1C'X),/*LENGTH OF DEMOUNT BLOCK @Y30L 01756000
*02*/                                                           03S0592 01757000
*         2 DMOPCD FIXED(8)INIT('06'X),/*DEMOUNT OPCODE @Y30LB02*/      01758000
*         2  DMNTRES1  CHAR(1)INIT('00'X),/*INIT RESERVED AREA TO ZERO  01759000
*YM02186*/                                                      03S0592 01760000
*         2  DMNTFLAG BIT(16)INIT('0000000000000000'B), /*FLAGS AREA @Y 01761000
*02186*/                                                        03S0592 01762000
*         3  DMBITRE1 BIT(1), /*ONE RESERVED BIT @YM02186*/     03S0592 01763000
*         3  DMDELRSP BIT(1), /*DEMOUNT DELAYED RESPONSE ATTRIBUTE @Y30 01764000
*B02*/                                                          03S0592 01765000
*         3  DMVUAVAL BIT(1), /*DEMOUNT VUA VALID ATTRIBUTE @ZDR2048*/  01766000
*         3  DMBITRES BIT(13), /*THIRTEEN RESERVED BITS @ZDR2048*/      01767000
*         2  DMVOL CHAR(6) INIT(''B), /*INIT VOLID TO ZERO @Y30LB02*/   01768000
*         2  DMNTASID  CHAR(2)INIT(''B),/*INIT ASID AREA TO ZERO @Y30LB 01769000
*2*/                                                            03S0592 01770000
*         2  DMNTECB  FIXED(31)INIT(0), /*DEMOUNT EVENT CONTROL BLOCK @ 01771000
*30LB02*/                                                       03S0592 01772000
*         2  DMHOST CHAR(5) INIT(''B),/*INIT HOSTID AREA  @Y30LB02*/    01773000
*         2  DMNTRES2  CHAR(1)INIT(''B),/*INIT RESERVED AREA TO ZERO @Z 01774000
*R2048*/                                                        03S0592 01775000
*         2  DMNTVUA   FIXED(15)INIT(0); /*VIRTUAL UNIT ADDRESS @ZDR204 01776000
**/                                                             03S0592 01777000
*     DMVOL=(UCBVOLI); /*VALUE OF VOLID @Y30LB02*/              03S0593 01778000
         MVC   DMVOL(6),UCBVOLI(@10)                            03S0593 01779000
*     DMNTVUA=(UCBCHAN); /*FILL VALUE OF VUA @ZDR2048*/         03S0594 01780000
         MVC   DMNTVUA(2),UCBCHAN(@10)                          03S0594 01781000
*     DMVUAVAL='1'B;/* OR ON THE VUA VALID ATTRIBUTE FLAG @ZDR2048*/    01782000
         OI    DMVUAVAL,B'00100000'                             03S0595 01783000
*     SVC  (126);/*INVOKE THE SSC SVC  @Y30LB02*/               03S0596 01784000
         SVC   126                                              03S0596 01785000
*     RFY  MDREG1 UNRSTD;/*UNREST REG 1 @Y30LB02*/ /* VUA FOR DEMOUNT   01786000
* @G24LPSJ*/                                                    03S0597 01787000
*    RFY (RCODE,REG0) RSTD;;           /*                    @Y30LPPD*/ 01788000
*    IF RCODE ^= ZERO                  /*WAS DEMOUNT SUCCESS @Y30LPPD*/ 01789000
*      THEN DO;                        /*NO- ISSUE MESSAGE   @Y30LPPD*/ 01790000
         LTR   RCODE,RCODE                                      03S0600 01791000
         BZ    @RF00600                                         03S0600 01792000
*        MSGSW = ON;                   /*INDICATE FAILURE    @Y30LPPD*/ 01793000
         OI    MSGSW,B'10000000'                                03S0602 01794000
*        RSNCDE = REG0;                /*MOVE REASON CODE    @Y30LPPD*/ 01795000
         ST    REG0,RSNCDE                                      03S0603 01796000
*        RFY (RCODE,REG0) UNRSTD;      /*                    @Y30LPPD*/ 01797000
*        UNPK (UNPKAR,RSNAREA(3:5));   /*UNPK REASON CODE    @Y30LPPD*/ 01798000
         UNPK  UNPKAR(5),RSNAREA+2(3)                           03S0605 01799000
*        TR (UNPKAR(1:4),TRANSTAB);    /*TRANSLATE CODE      @Y30LPPD*/ 01800000
         LA    @10,TRPATN                                       03S0606 01801000
         AL    @10,@CF02677                                     03S0606 01802000
         TR    UNPKAR(4),TRANSTAB(@10)                          03S0606 01803000
*        VOL985 = UCBVOLI;             /*PUT VOLSER IN MSG   @Y30LPPD*/ 01804000
         L     @10,UCBPTR                                       03S0607 01805000
         MVC   VOL985(6),UCBVOLI(@10)                           03S0607 01806000
*        DEV985 = UCBNAME;             /*PUT VUA IN MSG      @Y30LPPD*/ 01807000
         MVC   DEV985(3),UCBNAME(@10)                           03S0608 01808000
*        RET985 = UNPKAR(2:4);         /*INSERT REASON CODE  @Y30LPPD*/ 01809000
         MVC   RET985(3),UNPKAR+1                               03S0609 01810000
*        GEN REFS(NVTWTO)                                       03S0610 01811000
*        (IEAPMNIP TYPE=WTO,PARAM=IEA985I); /*ISSUE IEA985I  @Y30LPPD*/ 01812000
         IEAPMNIP TYPE=WTO,PARAM=IEA985I                                01813000
*        /*IEA985I UNABLE TO UNLOAD VIRTUAL VOLUME AAAAAA    @Y30LPPD*/ 01814000
*        /*FROM VXXX - RC=RET                                @Y30LPPD*/ 01815000
*        MNTLIST(I) = MNTLIST(MTLSTCT);/*REMOVE MNTLIST ENTRY@Y30LPPD*/ 01816000
         LA    @10,22                                           03S0611 01817000
         LR    @05,@10                                          03S0611 01818000
         MH    @05,I                                            03S0611 01819000
         LA    @01,MNTLIST-22(@05)                              03S0611 01820000
         LH    @05,MTLSTCT                                      03S0611 01821000
         LR    @07,@10                                          03S0611 01822000
         MR    @06,@05                                          03S0611 01823000
         LA    @10,MNTLIST-22(@07)                              03S0611 01824000
         MVC   @TS00001(22),0(@10)                              03S0611 01825000
         MVC   0(22,@01),@TS00001                               03S0611 01826000
*        MTLSTCT = MTLSTCT - ONE;      /*DECREASE LIST COUNT @Y30LPPD*/ 01827000
         BCTR  @05,0                                            03S0612 01828000
         STH   @05,MTLSTCT                                      03S0612 01829000
*      END;                            /*                    @Y30LPPD*/ 01830000
*  END;                                /*                    @Y30LPPD*/ 01831000
@RF00600 DS    0H                                               03S0615 01832000
*IF UCBPRES = YES                      /*IF  P/R VOLUME              */ 01833000
*  THEN DO;                            /*                            */ 01834000
@RF00587 L     @10,UCBPTR                                       03S0615 01835000
         TM    UCBPRES(@10),B'00000100'                         03S0615 01836000
         BNO   @RF00615                                         03S0615 01837000
*    LOOPSW = NO;                      /*INIT LOOP CONTROL           */ 01838000
         NI    LOOPSW,B'11101111'                               03S0617 01839000
*    MNTLIST(I) =MNTLIST(MTLSTCT);     /*REMOVE ENT FROM LIST        */ 01840000
         LA    @10,22                                           03S0618 01841000
         LR    @05,@10                                          03S0618 01842000
         MH    @05,I                                            03S0618 01843000
         LA    @01,MNTLIST-22(@05)                              03S0618 01844000
         LH    @05,MTLSTCT                                      03S0618 01845000
         LR    @07,@10                                          03S0618 01846000
         MR    @06,@05                                          03S0618 01847000
         LA    @10,MNTLIST-22(@07)                              03S0618 01848000
         MVC   @TS00001(22),0(@10)                              03S0618 01849000
         MVC   0(22,@01),@TS00001                               03S0618 01850000
*    MTLSTCT = MTLSTCT - ONE;          /*DECREMENT LIST COUNT        */ 01851000
         BCTR  @05,0                                            03S0619 01852000
         STH   @05,MTLSTCT                                      03S0619 01853000
*    DO WHILE (LOOPSW = NO);                                    03S0620 01854000
         B     @DE00620                                         03S0620 01855000
@DL00620 DS    0H                                               03S0621 01856000
*      GEN REFS(NVTWTOR)               /*ISSUE MESSAGE               */ 01857000
*      (IEAPMNIP TYPE=WTOR,PARAM=IEA947A);                      03S0621 01858000
         IEAPMNIP TYPE=WTOR,PARAM=IEA947A                               01859000
*      /* IEA947A REPLY U TO CONTINUE OR RE-IPL.                     */ 01860000
*      IF SCAN2 = REPLYU               /*CHK FOR VALID REPLY         */ 01861000
*         | SCAN2 = REPLYEOB           /*OF U OR EOB                 */ 01862000
*        THEN LOOPSW = YES;            /*VALID REPLY RECEIVED        */ 01863000
         CLC   SCAN2(2),@CC00168                                03S0622 01864000
         BE    @RT00622                                         03S0622 01865000
         CLC   SCAN2(2),@CC00170                                03S0622 01866000
         BNE   @RF00622                                         03S0622 01867000
@RT00622 DS    0H                                               03S0623 01868000
         OI    LOOPSW,B'00010000'                               03S0623 01869000
*    END;                                                       03S0624 01870000
@RF00622 DS    0H                                               03S0624 01871000
@DE00620 TM    LOOPSW,B'00010000'                               03S0624 01872000
         BZ    @DL00620                                         03S0624 01873000
*  END;                                                         03S0625 01874000
*  ELSE IF MSGSW = OFF                 /*IF NOT SYSTEM P/R VOLUME, AND  01875000
*                                      DEMOUNT OK OR NOT DONE@Y30LPPD*/ 01876000
*    THEN DO;                          /*                    @Y30LPPD*/ 01877000
         B     @RC00615                                         03S0626 01878000
@RF00615 TM    MSGSW,B'10000000'                                03S0626 01879000
         BNZ   @RF00626                                         03S0626 01880000
*      UCBVOLI = ZEROVOLI;             /*ZERO THE VOLSER             */ 01881000
         L     @10,UCBPTR                                       03S0628 01882000
         MVC   UCBVOLI(6,@10),ZEROVOLI                          03S0628 01883000
*      UCBVTOC = ZEROVTOC;             /*ZERO VTOC TTR               */ 01884000
         MVC   UCBVTOC(4,@10),ZEROVTOC                          03S0629 01885000
*      UCBNOTRD = YES;                 /*UNLOAD THE VOLUME           */ 01886000
         OI    UCBNOTRD(@10),B'01000000'                        03S0630 01887000
*      IF UCBRVDEV = ON &              /*3330V DEVICE?       @Y30LPPD*/ 01888000
*         UCBTYP(3:4) = COMP3330       /*                    @Y30LPPD*/ 01889000
*        THEN V948 = VIRT;             /*YES - MOVE IN V     @Y30LPPD*/ 01890000
         TM    UCBRVDEV(@10),B'00001000'                        03S0631 01891000
         BNO   @RF00631                                         03S0631 01892000
         CLC   UCBTYP+2(2,@10),@CB00140                         03S0631 01893000
         BNE   @RF00631                                         03S0631 01894000
         MVI   V948,C'V'                                        03S0632 01895000
*        ELSE V948 = BLANK;            /*NO - MOVE IN BLANK  @Y30LPPD*/ 01896000
         B     @RC00631                                         03S0633 01897000
@RF00631 MVI   V948,C' '                                        03S0633 01898000
*      DEV948 = UCBNAME;               /*MOVE DEVICE ADDR            */ 01899000
@RC00631 L     @10,UCBPTR                                       03S0634 01900000
         MVC   DEV948(3),UCBNAME(@10)                           03S0634 01901000
*      GEN REFS(NVTWTO)                /*ISSUE MESSAGE               */ 01902000
*      (IEAPMNIP TYPE=WTO,PARAM=IEA948I);                       03S0635 01903000
         IEAPMNIP TYPE=WTO,PARAM=IEA948I                                01904000
*      /* IEA948I VXXX NOW UNLOADED.                         @Y30LPPD*/ 01905000
*    END;                                                       03S0636 01906000
*    ELSE;                             /*VOL NOT UNLOADED    @Y30LPPD*/ 01907000
@RF00626 DS    0H                                               03S0638 01908000
*      END;                            /*                    @Y30LPPD*/ 01909000
*    ELSE IF J > NUMSUPTD              /*UNMOUNTED MSS VOL?  @Y30LPPD*/ 01910000
*      THEN DO;                        /*YES -               @Y30LPPD*/ 01911000
         B     @RC00571                                         02S0639 01912000
@RF00571 LH    @10,J                                            02S0639 01913000
         CH    @10,@CH00084                                     02S0639 01914000
         BNH   @RF00639                                         02S0639 01915000
*/***********************************************************@Y30LPPD*/ 01916000
*/*                                                          @Y30LPPD*/ 01917000
*/* SEGMENT NAME - VIRTMONT                                  @Y30LPPD*/ 01918000
*/*                                                          @Y30LPPD*/ 01919000
*/* DESCRIPTIVE NAME - MOUNT MSS VOLUMES                     @Y30LPPD*/ 01920000
*/*                                                          @Y30LPPD*/ 01921000
*/* FUNCTION -                                               @Y30LPPD*/ 01922000
*/*     LOCATE THE UCB SPECIFIED IN THE MOUNT LIST ENTRY. IF @Y30LPPD*/ 01923000
*/*     THERE IS A VOLUME ALREADY MOUNTED ON THE DEVICE,     @Y30LPPD*/ 01924000
*/*     ISSUE THE DEMOUNT MACRO FOR THE DEVICE.  IF THE DE-  @Y30LPPD*/ 01925000
*/*     MOUNT FAILS, ISSUE MESSAGE 'IEA986I MSS VOLUME AAAAAA@Y30LPPD*/ 01926000
*/*     REQUIRED ON VXXX. IEA985I UNABLE TO UNLOAD MSS       @Y30LPPD*/ 01927000
*/*     VOLUME BBBBBB FROM VXXX - RC=RET.'                   @Y30LPPD*/ 01928000
*/*                                                          @Y30LPPD*/ 01929000
*/*     IF THERE IS NO VOLUME ALREADY MOUNTED ON THE DEVICE, @Y30LPPD*/ 01930000
*/*     OR IF THE DEMOUNT WAS SUCCESSFUL, THEN ISSUE THE     @Y30LPPD*/ 01931000
*/*     MOUNT MACRO FOR THE VOLUME AND VUA SPECIFIED IN THE  @Y30LPPD*/ 01932000
*/*     ENTRY. IF THE MOUNT FAILS, THEN ISSUE MESSAGE        @Y30LPPD*/ 01933000
*/*     'IEA987I UNABLE TO MOUNT MSS VOLUME AAAAAA ON VXXX - @Y30LPPD*/ 01934000
*/*     RC=RET.'  IF NO PATHS ARE AVAILABLE TO THE DEVICE    @ZA14221*/ 01935000
*/*     OR IF THE DEVICE IS NOT OPERATIONAL THEN ISSUE       @ZA14221*/ 01936000
*/*     MESSAGE 'IEA409I UNABLE TO MOUNT MSS VOLUME          @ZA14221*/ 01937000
*/*     AAAAAA ON VXXX, DEVICE NOT ACCESSIBLE'. IF THE MOUNT @ZA14221*/ 01938000
*/*     WAS SUCCESSFUL, THEN GO TO SEGMENT VIRTREAD TO       @ZA14221*/ 01939000
*/*     READ THE VOLUME LABEL TO VERIFY THE VOLSER AND       @ZA14221*/ 01940000
*/*     OBTAIN THE VTOC TTR.                                 @ZA14221*/ 01941000
*/*                                                          @Y30LPPD*/ 01942000
*/*     REMOVE THE PROCESSED ENTRY FROM THE MOUNT LIST.      @Y30LPPD*/ 01943000
*/*                                                          @Y30LPPD*/ 01944000
*/* ENTRY - IN-LINE SEGMENT                                  @Y30LPPD*/ 01945000
*/*                                                          @Y30LPPD*/ 01946000
*/*     PURPOSE - SEE FUNCTION                               @Y30LPPD*/ 01947000
*/*                                                          @Y30LPPD*/ 01948000
*/*     INPUT DATA -                                         @Y30LPPD*/ 01949000
*/*                                                          @Y30LPPD*/ 01950000
*/*         MOUNT LIST ENTRY                                 @Y30LPPD*/ 01951000
*/*                                                          @Y30LPPD*/ 01952000
*/* EXITS -                                                  @Y30LPPD*/ 01953000
*/*     CONDITION - NORMAL - NO ERRORS MOUNTING VOLUME       @Y30LPPD*/ 01954000
*/*                                                          @Y30LPPD*/ 01955000
*/*     OUTPUT DATA -                                        @Y30LPPD*/ 01956000
*/*         MNTLIST - MSS VOLUME ENTRY REMOVED               @Y30LPPD*/ 01957000
*/*         UCB - MODIFIED                                   @Y30LPPD*/ 01958000
*/*                                                          @Y30LPPD*/ 01959000
*/*     CONDITION - UNABLE TO DEMOUNT ALREADY MOUNTED        @Y30LPPD*/ 01960000
*/*                 MSS VOLUME.                              @Y30LPPD*/ 01961000
*/*                                                          @Y30LPPD*/ 01962000
*/*     OUTPUT DATA -                                        @Y30LPPD*/ 01963000
*/*                                                          @Y30LPPD*/ 01964000
*/*         MNTLIST - MSS VOLUME ENTRY REMOVED               @Y30LPPD*/ 01965000
*/*         MESSAGE IEA986I                                  @Y30LPPD*/ 01966000
*/*         MESSAGE IEA985I                                  @Y30LPPD*/ 01967000
*/*                                                          @Y30LPPD*/ 01968000
*/*     CONDITION - UNABLE TO MOUNT MSS VOLUME               @Y30LPPD*/ 01969000
*/*                                                          @Y30LPPD*/ 01970000
*/*     OUTPUT DATA -                                        @Y30LPPD*/ 01971000
*/*                                                          @Y30LPPD*/ 01972000
*/*         MNTLIST - MSS VOLUME ENTRY REMOVED               @Y30LPPD*/ 01973000
*/*         MESSAGE IEA987I                                  @Y30LPPD*/ 01974000
*/*         MESSAGE IEA409I                                  @ZA14221*/ 01975000
*/*                                                          @Y30LPPD*/ 01976000
*/*     RETURN CODE - NONE                                   @Y30LPPD*/ 01977000
*/*                                                          @Y30LPPD*/ 01978000
*/***********************************************************@Y30LPPD*/ 01979000
*FAILSW = OFF;                         /*INIT DEMOUNT FAIL SW@Y30LPPD*/ 01980000
         NI    FAILSW,B'10111111'                               03S0641 01981000
*MSSVOL = MVOLSER(I);                  /*SAVE VOLSER         @Y30LPPD*/ 01982000
         LH    @10,I                                            03S0642 01983000
         MH    @10,@CH00190                                     03S0642 01984000
         LA    @05,MVOLSER-22(@10)                              03S0642 01985000
         MVC   MSSVOL(6),0(@05)                                 03S0642 01986000
*FINDDEV = MDEVTYPE(I,2:4);            /*MOVE VUA TO PARM    @Y30LPPD*/ 01987000
         LA    @05,MDEVTYPE-21(@10)                             03S0643 01988000
         MVC   FINDDEV(3),0(@05)                                03S0643 01989000
*RFY RPARM RSTD;                       /*                    @Y30LPPD*/ 01990000
*RPARM = FINDADDR;                     /*SET UP PARM         @Y30LPPD*/ 01991000
         L     RPARM,FINDADDR                                   03S0645 01992000
*GEN REFS(NVTUCBFN)                    /*                    @Y30LPPD*/ 01993000
* (IEAPMNIP TYPE=UCBFN,PARAM=RPARM);   /*                    @Y30LPPD*/ 01994000
         IEAPMNIP TYPE=UCBFN,PARAM=RPARM                                01995000
*UCBPTR = RPARM;                       /*POINT TO UCB        @Y30LPPD*/ 01996000
         ST    RPARM,UCBPTR                                     03S0647 01997000
*RFY RPARM UNRSTD;                     /*                    @Y30LPPD*/ 01998000
*                                                               03S0648 01999000
*IF UCBVOLI ^= ZEROVOLI                /*IS THERE A VOLUME ALREADY      02000000
*                                        MOUNTED ON THAT DEV?@Y30LPPD*/ 02001000
*  THEN DO;                            /*YES -               @Y30LPPD*/ 02002000
*                                                               03S0649 02003000
         L     @10,UCBPTR                                       03S0649 02004000
         CLC   UCBVOLI(6,@10),ZEROVOLI                          03S0649 02005000
         BE    @RF00649                                         03S0649 02006000
*     /********************************************************* @Y30LB 02007000
*2*/                                                            03S0651 02008000
*     /*MACMEAN  MSSC DEMOUNT MACRO                              @Y30LB 02009000
*2*/                                                            03S0651 02010000
*     /*VS1-4/VS2-3 VERSION--01/19/76 LEVEL 00                   @ZDR20 02011000
*8*/                                                            03S0651 02012000
*     /*THIS IS THE OUTPUT FOR A SECONDARY                       @Y30LB 02013000
*2*/                                                            03S0651 02014000
*     /*INVOCATION OF THE STANDARD FORM MACRO                    @Y30LB 02015000
*2*/                                                            03S0651 02016000
*     /********************************************************* @Y30LB 02017000
*2*/                                                            03S0651 02018000
*     RFY  MDREG1 RSTD;/*RESTRICT REG 1 @Y30LB02*/              03S0651 02019000
*     MDREG1=ADDR(DMLEN);/*PTR TO REQ BLK @Y30LB02*/            03S0652 02020000
         LA    MDREG1,DMLEN                                     03S0652 02021000
*     DMVOL=(UCBVOLI); /*VALUE OF VOLID @Y30LB02*/              03S0653 02022000
         MVC   DMVOL(6),UCBVOLI(@10)                            03S0653 02023000
*     DMNTVUA=(UCBCHAN); /*FILL VALUE OF VUA @ZDR2048*/         03S0654 02024000
         MVC   DMNTVUA(2),UCBCHAN(@10)                          03S0654 02025000
*     DMVUAVAL='1'B;/* OR ON THE VUA VALID ATTRIBUTE FLAG @ZDR2048*/    02026000
         OI    DMVUAVAL,B'00100000'                             03S0655 02027000
*     SVC  (126);/*INVOKE THE SSC SVC  @Y30LB02*/               03S0656 02028000
         SVC   126                                              03S0656 02029000
*     RFY  MDREG1 UNRSTD;/*UNREST REG 1 @Y30LB02*/ /* VUA FOR DEMOUNT   02030000
* @G24LPSJ*/                                                    03S0657 02031000
*    RFY (RCODE,REG0) RSTD;            /*                    @Y30LPPD*/ 02032000
*    IF RCODE ^= ZERO                  /*RETURN CODE OK?     @Y30LPPD*/ 02033000
*      THEN DO;                        /*NO -                @Y30LPPD*/ 02034000
         LTR   RCODE,RCODE                                      03S0659 02035000
         BZ    @RF00659                                         03S0659 02036000
*        FAILSW = ON;                  /*INDICATE FAILURE    @Y30LPPD*/ 02037000
         OI    FAILSW,B'01000000'                               03S0661 02038000
*        RSNCDE = REG0;                /*MOVE REASON CODE    @Y30LPPD*/ 02039000
         ST    REG0,RSNCDE                                      03S0662 02040000
*        RFY (RCODE,REG0) UNRSTD;      /*                    @Y30LPPD*/ 02041000
*        UNPK (UNPKAR,RSNAREA(3:5));   /*CONVERT REASON CODE @Y30LPPD*/ 02042000
         UNPK  UNPKAR(5),RSNAREA+2(3)                           03S0664 02043000
*        TR (UNPKAR(1:4),TRANSTAB);    /*                    @Y30LPPD*/ 02044000
         LA    @10,TRPATN                                       03S0665 02045000
         AL    @10,@CF02677                                     03S0665 02046000
         TR    UNPKAR(4),TRANSTAB(@10)                          03S0665 02047000
*        VOL986 = MSSVOL;              /*MOVE REQUESTED VOLSER  03S0666 02048000
*                                        INTO IEA986I        @Y30LPPD*/ 02049000
         MVC   VOL986(6),MSSVOL                                 03S0666 02050000
*        VOL985 = UCBVOLI;             /*MOVE VOLSER FOUND ON DEVICE    02051000
*                                        INTO IEA985I        @Y30LPPD*/ 02052000
         L     @10,UCBPTR                                       03S0667 02053000
         MVC   VOL985(6),UCBVOLI(@10)                           03S0667 02054000
*        DEV986 = UCBNAME;             /*MOVE VUA TO MSGS    @Y30LPPD*/ 02055000
         MVC   DEV986(3),UCBNAME(@10)                           03S0668 02056000
*        DEV985 = UCBNAME;             /*                    @Y30LPPD*/ 02057000
         MVC   DEV985(3),UCBNAME(@10)                           03S0669 02058000
*        RET985 = UNPKAR(2:4);         /*MOVE RETURN CODE    @Y30LPPD*/ 02059000
         MVC   RET985(3),UNPKAR+1                               03S0670 02060000
*        GEN REFS(NVTWTOR);            /*ISSUE IEA986I +985I @Y30LPPD*/ 02061000
         IEAPMNIP TYPE=WTO,PARAM=IEA986I                       @Y30LPPD 02062000
         IEAPMNIP TYPE=WTO,PARAM=IEA985I                       @Y30LPPD 02063000
*        /*IEA986I MSS VOLUME AAAAAA REQUIRED ON VXXX.       @Y30LPPD*/ 02064000
*        /*IEA985I UNABLE TO UNLOAD VIRTUAL VOLUME BBBBBB    @Y30LPPD*/ 02065000
*        /*FROM VXXX - RC=RET.                               @Y30LPPD*/ 02066000
*      END;                            /*                    @Y30LPPD*/ 02067000
*      ELSE DO;                        /*DEMOUNT SUCCESSFUL- @Y30LPPD*/ 02068000
         B     @RC00659                                         03S0673 02069000
@RF00659 DS    0H                                               03S0674 02070000
*        UCBVOLI = ZEROVOLI;           /*UNLOAD THE VOLUME-  @Y30LPPD*/ 02071000
         L     @10,UCBPTR                                       03S0674 02072000
         MVC   UCBVOLI(6,@10),ZEROVOLI                          03S0674 02073000
*        UCBVTOC = ZEROVTOC;           /*ZERO VOLSER & VTOC  @Y30LPPD*/ 02074000
         MVC   UCBVTOC(4,@10),ZEROVTOC                          03S0675 02075000
*        UCBNOTRD = YES;               /*MAKE NOT READY      @Y30LPPD*/ 02076000
         OI    UCBNOTRD(@10),B'01000000'                        03S0676 02077000
*      END;                            /*                    @Y30LPPD*/ 02078000
*  END;                                /*                    @Y30LPPD*/ 02079000
@RC00659 DS    0H                                               03S0679 02080000
*IF FAILSW = OFF                       /*NO ERRORS ON DEMNT? @Y30LPPD*/ 02081000
*  THEN DO;                            /*RIGHT -             @Y30LPPD*/ 02082000
@RF00649 TM    FAILSW,B'01000000'                               03S0679 02083000
         BNZ   @RF00679                                         03S0679 02084000
*/***********************************************************@ZA14221*/ 02085000
*/*                                                          @ZA14221*/ 02086000
*/* SEGMENT NAME - CKPATH                                    @ZA14221*/ 02087000
*/*                                                          @ZA14221*/ 02088000
*/* DESCRIPTIVE NAME - CHECK MSS DATA PATHS                  @ZA14221*/ 02089000
*/*                                                          @ZA14221*/ 02090000
*/* FUNCTION                                                 @ZA14221*/ 02091000
*/*                                                          @ZA14221*/ 02092000
*/*     MSS VATLST ENTRIES ARE CHECKED TO DETERMINE WHETHER  @ZA14221*/ 02093000
*/*     A PATH EXISTS TO THE DEVICE OR NOT. THIS IS DONE TO  @ZA14221*/ 02094000
*/*     DETERMINE WHETHER THE MSS MOUNT SVC SHOULD BE ISSUED @ZA14221*/ 02095000
*/*     OR NOT. A MOUNT CAN BE ISSUED UNDER THE FOLLOWING    @ZA14221*/ 02096000
*/*     CONDITIONS:                                          @ZA14221*/ 02097000
*/*       . THE UCB IS ONLINE                                @ZA14221*/ 02098000
*/*       . THE UCB IS OFFLINE, BUT THE DATA PATH ROUTINE    @ZA14221*/ 02099000
*/*         COULD BE LOADED AND DETERMINED THAT A PATH IS    @ZA14221*/ 02100000
*/*         AVAILABLE.                                       @ZA14221*/ 02101000
*/*                                                          @ZA14221*/ 02102000
*/* ENTRY - IN-LINE SEGMENT                                  @ZA14221*/ 02103000
*/*                                                          @ZA14221*/ 02104000
*/*     PURPOSE - SEE FUNCTION                               @ZA14221*/ 02105000
*/*                                                          @ZA14221*/ 02106000
*/*     INPUT DATA                                           @ZA14221*/ 02107000
*/*                                                          @ZA14221*/ 02108000
*/*         THE UCB ADDRESS FOR THE VATLST ENTRY             @ZA14221*/ 02109000
*/*                                                          @ZA14221*/ 02110000
*/* EXITS                                                    @ZA14221*/ 02111000
*/*                                                          @ZA14221*/ 02112000
*/*       CONDITION - IT IS DETERMINED WHETHER A PATH IS     @ZA14221*/ 02113000
*/*          IS AVAILABLE TO THE DEVICE.                     @ZA14221*/ 02114000
*/*                                                          @ZA14221*/ 02115000
*/*       OUTPUT DATA                                        @ZA14221*/ 02116000
*/*                                                          @ZA14221*/ 02117000
*/*          MSSMNT - IF 1, IT IS OK TO ISSUE THE MOUNT      @ZA14221*/ 02118000
*/*                   IF 0, DO NOT ISSUE THE MOUNT           @ZA14221*/ 02119000
*/*                                                          @ZA14221*/ 02120000
*/*       RETURN CODE - NONE                                 @ZA14221*/ 02121000
*/*                                                          @ZA14221*/ 02122000
*/***********************************************************@ZA14221*/ 02123000
*IF UCBONLI = ON                       /*PATH OK IF ONLINE   @ZA14221*/ 02124000
*  THEN MSSMNT = ON;                   /*OK TO MOUNT UNIT    @ZA14221*/ 02125000
         L     @10,UCBPTR                                       04S0681 02126000
         TM    UCBONLI(@10),B'10000000'                         04S0681 02127000
         BNO   @RF00681                                         04S0681 02128000
         OI    MSSMNT,B'00000100'                               04S0682 02129000
*ELSE                                  /*VERIFY PATH         @ZA14221*/ 02130000
*  IF DPLOADED = YES                   /*VDEV LOADED         @ZA14221*/ 02131000
*    THEN DO;                          /*YES, CHECK PATHS    @ZA14221*/ 02132000
         B     @RC00681                                         04S0683 02133000
@RF00681 TM    DPLOADED,B'01000000'                             04S0683 02134000
         BNO   @RF00683                                         04S0683 02135000
*       RFY (RPARM) RSTD;              /*                    @ZA14221*/ 02136000
*       DPPLIST = ADDR(DPPARM);        /*SET PLIST           @ZA14221*/ 02137000
         LA    @10,DPPARM                                       04S0686 02138000
         ST    @10,DPPLIST                                      04S0686 02139000
*       RPARM = ADDR(DPPLIST);         /*SET R1 TO PLIST ADDR@ZA14221*/ 02140000
         LA    RPARM,DPPLIST                                    04S0687 02141000
*       DPUCB = UCBPTR;                /*SET UCB PTR IN PLIST@ZA14221*/ 02142000
         MVC   DPUCB(4),UCBPTR                                  04S0688 02143000
*       RFY (RCODE) RSTD;              /*                    @ZA14221*/ 02144000
*       RCODE = DATAPATH;              /*SET ADDR OF VDEV    @ZA14221*/ 02145000
         L     RCODE,DATAPATH                                   04S0690 02146000
*       GEN SETS(RCODE,REXIT);         /*CALL VDEV           @ZA14221*/ 02147000
          BALR REXIT,RCODE                                     @ZA14221 02148000
*       IF RCODE = ZERO |              /*PATH OK OR          @ZA14221*/ 02149000
*          RCODE = TWENTY              /*ALREADY VALIDATED   @ZA14221*/ 02150000
*         THEN MSSMNT = ON;            /*OK TO MOUNT         @ZA14221*/ 02151000
         LTR   RCODE,RCODE                                      04S0692 02152000
         BZ    @RT00692                                         04S0692 02153000
         CH    RCODE,@CH00078                                   04S0692 02154000
         BNE   @RF00692                                         04S0692 02155000
@RT00692 DS    0H                                               04S0693 02156000
         OI    MSSMNT,B'00000100'                               04S0693 02157000
*       ELSE MSSMNT = OFF;             /*NO PATH AVAILABLE   @ZA14221*/ 02158000
         B     @RC00692                                         04S0694 02159000
@RF00692 NI    MSSMNT,B'11111011'                               04S0694 02160000
*    END;                              /*END CHECKING PATHS  @ZA14221*/ 02161000
*  ELSE MSSMNT = OFF;                  /*VDEV NOT LOADED, CANNOT TELL   02162000
*                                        WHETHER PATH AVAILABLE, DO     02163000
*                                        NOT MOUNT           @ZA14221*/ 02164000
         B     @RC00683                                         04S0696 02165000
@RF00683 NI    MSSMNT,B'11111011'                               04S0696 02166000
*    IF MSSMNT = ON THEN DO;           /*OK TO ISSUE MOUNT?  @ZA14221*/ 02167000
*                                                               03S0697 02168000
@RC00683 DS    0H                                               03S0697 02169000
@RC00681 TM    MSSMNT,B'00000100'                               03S0697 02170000
         BNO   @RF00697                                         03S0697 02171000
*       /********************************************************* @Y30 02172000
*B02*/                                                          03S0699 02173000
*       /*MACMEAN  MSSC MOUNT MACRO                                @Y30 02174000
*B02*/                                                          03S0699 02175000
*       /*VS2-3 VERSION--02/06/76                                  @G18 02176000
*B04*/                                                          03S0699 02177000
*       /*THIS IS THE STANDARD FORM - MOUNT MACRO                  @Y30 02178000
*B02*/                                                          03S0699 02179000
*       /********************************************************* @Y30 02180000
*B02*/                                                          03S0699 02181000
*       RFY  MDREG1 RSTD;/*RESTRICT REG 1 @Y30LB02*/            03S0699 02182000
*       MDREG1=ADDR(MDLEN);/*R1 PTR TO REQBLK @Y30LB02*/        03S0700 02183000
         LA    MDREG1,MDLEN                                     03S0700 02184000
*       DCL 1  ICBMLST  STATIC LOCAL, /*MOUNT REQUEST BLOCK @Y30LB02*/  02185000
*           2  MDLEN  FIXED(31)INIT('1C'X),/*LENGTH OF MOUNT REQ BLK @Y 02186000
*0LB02*/                                                        03S0701 02187000
*           2  MDOPCD FIXED(8)INIT('08'X),/*MOUNT OPCODE @Y30LB02*/     02188000
*           2  *    CHAR(1) INIT('00'X) ,/*RESERVED @Y30LB02*/  03S0701 02189000
*           2  MDFLG BIT(16)INIT('0000000000000000'B),/*FLAGS AREA @Y30 02190000
*B02*/                                                          03S0701 02191000
*           3  * BIT(1), /* RESERVED  @YD00125*/                03S0701 02192000
*           3  MDVISMNT BIT(1), /*MSVC ISSUING THE MOUNT @Y30LB02*/     02193000
*           3  MDVSVRQ BIT(1), /*MSVC SECONDARY VOLUME REQUEST @Y30LB02 02194000
*/                                                              03S0701 02195000
*           3  MDSRTCH BIT(1), /*SCRATCH  @Y30LB02*/            03S0701 02196000
*           3  MDMEXT  BIT(1), /*MOUNT EXTENSION  @G18MB04*/    03S0701 02197000
*           3  *      BIT(11), /*RESERVE BITS OF ZERO @Y30LB02*/        02198000
*           2  MDVOL CHAR(6),/*VOLUME ID @Y30LB02*/             03S0701 02199000
*            3  *(6) CHAR(1) INIT((6)'00'X),/*INIT VOLID AREA TO ZERO @ 02200000
*30LB02*/                                                       03S0701 02201000
*           2  MDVUA  FIXED(15) INIT(0),/*VIRTUAL UNIT ADDRESS @Y30LB02 02202000
*/                                                              03S0701 02203000
*           2  MDHOST CHAR(5),/*5-BYTE HOSTID AREA @Y30LB02*/   03S0701 02204000
*            3  *(5) CHAR(1) INIT((5)'00'X),/*INIT HOSTID AREA  @Y30LB0 02205000
**/                                                             03S0701 02206000
*           2  * CHAR(3),/*2-BYTE RESERVED AREA @Y30LB02*/      03S0701 02207000
*            3  *(3) CHAR(1) INIT((3)'00'X),/*INIT RESERVED AREA  @Y30L 02208000
*02*/                                                           03S0701 02209000
*           2  MNTEXTP PTR(31) INIT(0),/*ADDRESS OF MOUNT LIST EXTENSIO 02210000
* @G18MB04*/                                                    03S0701 02211000
*            3  MDJFCB FIXED(31); /* ADDRESS OF JFCB @G18MB04*/ 03S0701 02212000
*       MDVOL=(MSSVOL);/*VALUE OF VOLID @Y30LB02*/              03S0702 02213000
         MVC   MDVOL(6),MSSVOL                                  03S0702 02214000
*       MDVUA=(UCBCHAN); /*VALUE OF VUA    @Y30LB02*/           03S0703 02215000
         L     @14,UCBPTR                                       03S0703 02216000
         MVC   MDVUA(2),UCBCHAN(@14)                            03S0703 02217000
*       SVC  (126);/*INVOKE THE SSC SVC  @Y30LB02*/             03S0704 02218000
         SVC   126                                              03S0704 02219000
*       RFY  MDREG1 UNRSTD;/*UNREST REG 1 @Y30LB02*/ /*MOUNT    03S0705 02220000
*                                      REQUESTED MSS VOLUME@Y30LPPD*/   02221000
*      RFY (RCODE,REG0) RSTD;          /*                    @Y30LPPD*/ 02222000
*      IF RCODE ^= ZERO                /*CHECK RETURN CODE   @Y30LPPD*/ 02223000
*        THEN DO;                      /*FAILURE -           @Y30LPPD*/ 02224000
         LTR   RCODE,RCODE                                      03S0707 02225000
         BZ    @RF00707                                         03S0707 02226000
*          RSNCDE = REG0;              /*MOVE REASON CODE    @Y30LPPD*/ 02227000
         ST    REG0,RSNCDE                                      03S0709 02228000
*          RFY (RCODE,REG0) UNRSTD;    /*                    @Y30LPPD*/ 02229000
*          UNPK (UNPKAR,RSNAREA(3:5)); /*CONVERT REASON CODE @Y30LPPD*/ 02230000
         UNPK  UNPKAR(5),RSNAREA+2(3)                           03S0711 02231000
*          TR (UNPKAR(1:4),TRANSTAB);  /*                    @Y30LPPD*/ 02232000
         LA    @10,TRPATN                                       03S0712 02233000
         AL    @10,@CF02677                                     03S0712 02234000
         TR    UNPKAR(4),TRANSTAB(@10)                          03S0712 02235000
*          VOL987 = MSSVOL;            /*MOVE VOLSER TO MSG  @Y30LPPD*/ 02236000
         MVC   VOL987(6),MSSVOL                                 03S0713 02237000
*          DEV987 = FINDDEV;           /*MOVE VUA TO MSG     @Y30LPPD*/ 02238000
         MVC   DEV987(3),FINDDEV                                03S0714 02239000
*          RET987 = UNPKAR(2:4);       /*MOVE RETURN CODE    @Y30LPPD*/ 02240000
         MVC   RET987(3),UNPKAR+1                               03S0715 02241000
*          GEN REFS(NVTWTO)                                     03S0716 02242000
*          (IEAPMNIP TYPE=WTO,PARAM=IEA987I);/*ISSUE IEA987I @Y30LPPD*/ 02243000
         IEAPMNIP TYPE=WTO,PARAM=IEA987I                                02244000
*          /*IEA987I UNABLE TO MOUNT MSS VOLUME AAAAAA ON    @Y30LPPD*/ 02245000
*          /*DDD - RC=RET                                    @Y30LPPD*/ 02246000
*        END;                          /*                    @Y30LPPD*/ 02247000
*        ELSE DO;                      /*MOUNT SUCCESSFUL    @Y30LPPD*/ 02248000
         B     @RC00707                                         03S0718 02249000
@RF00707 DS    0H                                               03S0719 02250000
*/***********************************************************@Y30LPPD*/ 02251000
*/*                                                          @Y30LPPD*/ 02252000
*/* SEGMENT NAME - VIRTREAD                                  @Y30LPPD*/ 02253000
*/*                                                          @Y30LPPD*/ 02254000
*/* DESCRIPTIVE NAME - READ LABEL OF MSS VOLUME MOUNTED      @Y30LPPD*/ 02255000
*/*                                                          @Y30LPPD*/ 02256000
*/* FUNCTION -                                               @Y30LPPD*/ 02257000
*/*                                                          @Y30LPPD*/ 02258000
*/*     USE SUBROUTINE EXCPSETP TO INITIALIZE CONTROL BLOCKS @Y30LPPD*/ 02259000
*/*     FOR EXCP. ISSUE EXCP TO READ LABEL. IF THERE WAS AN  @Y30LPPD*/ 02260000
*/*     ERROR IN THE EXCP OR THE LABEL IS NOT STANDARD OR    @Y30LPPD*/ 02261000
*/*     THE LABEL DOES NOT CONTAIN THE SAME VOLSER AS IN THE @Y30LPPD*/ 02262000
*/*     MOUNT LIST ENTRY, THEN ISSUE MESSAGE 'IEA854I ERROR  @Y30LPPD*/ 02263000
*/*     READING VOLUME LABEL.' IF THE ERROR WAS DUE TO       @Y30LPPD*/ 02264000
*/*     DEVICE FAILURE, ISSUE NIP SENSE TO PUT SENSE BYTES   @Y30LPPD*/ 02265000
*/*     OUT TO CONSOLE. DEMOUNT THE VOLUME. IF THE DEMOUNT   @Y30LPPD*/ 02266000
*/*     FAILS, ISSUE MESSAGE 'IEA985I UNABLE TO UNLOAD       @Y30LPPD*/ 02267000
*/*     VOLUME AAAAAA FROM VXXX - RC=RET.' IF THE DEMOUNT    @Y30LPPD*/ 02268000
*/*     WAS SUCCESSFUL, UNLOAD THE VOLUME AND ISSUE MESSAGE  @Y30LPPD*/ 02269000
*/*     'IEA948I VXXX NOW UNLOADED.'                         @Y30LPPD*/ 02270000
*/*                                                          @Y30LPPD*/ 02271000
*/*     IF THERE WAS NO ERROR VERIFYING THE LABEL THEN CON-  @Y30LPPD*/ 02272000
*/*     VERT THE VTOC TTR, MOVE THE TTR AND THE VOLSER       @Y30LPPD*/ 02273000
*/*     INTO THE UCB, AND BRING THE DEVICE ONLINE. CALL      @Y30LPPD*/ 02274000
*/*     SETSTAT TO SET THE VOLUME ATTRIBUTES.                @Y30LPPD*/ 02275000
*/*                                                          @Y30LPPD*/ 02276000
*/* ENTRY - IN-LINE SEGMENT                                  @Y30LPPD*/ 02277000
*/*                                                          @Y30LPPD*/ 02278000
*/*     PURPOSE - SEE FUNCTION                               @Y30LPPD*/ 02279000
*/*                                                          @Y30LPPD*/ 02280000
*/*     INPUT DATA -                                         @Y30LPPD*/ 02281000
*/*                                                          @Y30LPPD*/ 02282000
*/*         UCB                                              @Y30LPPD*/ 02283000
*/*         MOUNT LIST ENTRY                                 @Y30LPPD*/ 02284000
*/*                                                          @Y30LPPD*/ 02285000
*/* EXITS -                                                  @Y30LPPD*/ 02286000
*/*                                                          @Y30LPPD*/ 02287000
*/*     CONDITION - NORMAL - VOLUME LABEL READ + VERIFIED    @Y30LPPD*/ 02288000
*/*                                                          @Y30LPPD*/ 02289000
*/*     OUTPUT DATA -                                        @Y30LPPD*/ 02290000
*/*                                                          @Y30LPPD*/ 02291000
*/*         UCB - MODIFIED, VOLUME MOUNTED, ATTRIBUTES SET   @Y30LPPD*/ 02292000
*/*                                                          @Y30LPPD*/ 02293000
*/*     CONDITION - VERIFY LABEL FAILS, VOLUME SUCCESSFULLY  @Y30LPPD*/ 02294000
*/*                 DEMOUNTED                                @Y30LPPD*/ 02295000
*/*                                                          @Y30LPPD*/ 02296000
*/*     OUTPUT DATA -                                        @Y30LPPD*/ 02297000
*/*                                                          @Y30LPPD*/ 02298000
*/*         MESSAGE IEA854I                                  @Y30LPPD*/ 02299000
*/*         MESSAGE IEA948I                                  @Y30LPPD*/ 02300000
*/*                                                          @Y30LPPD*/ 02301000
*/*     CONDITION - VERIFY LABEL FAILS, DEMOUNT FAILS        @Y30LPPD*/ 02302000
*/*                                                          @Y30LPPD*/ 02303000
*/*     OUTPUT DATA -                                        @Y30LPPD*/ 02304000
*/*                                                          @Y30LPPD*/ 02305000
*/*         MESSAGE IEA854I                                  @Y30LPPD*/ 02306000
*/*         MESSAGE IEA985I                                  @Y30LPPD*/ 02307000
*/*                                                          @Y30LPPD*/ 02308000
*/*     RETURN CODE - NONE                                   @Y30LPPD*/ 02309000
*/*                                                          @Y30LPPD*/ 02310000
*/***********************************************************@Y30LPPD*/ 02311000
*                                                               04S0719 02312000
*CALL EXCPSETP;                        /*SETUP TO READ LABEL @Y30LPPD*/ 02313000
         BAL   @14,EXCPSETP                                     04S0719 02314000
*EXCPSW = ON;                          /*INDICATE SETUP DONE @Y30LPPD*/ 02315000
         OI    EXCPSW,B'00100000'                               04S0720 02316000
*DEBUCBA = UCBPTR;                     /*UCB ADDRESS INTO DEB@Y30LPPD*/ 02317000
         L     @10,DEBDAPTR                                     04S0721 02318000
         MVC   DEBUCBA(3,@10),UCBPTR+1                          04S0721 02319000
*ECB = ZERO;                           /*CLEAR ECB           @Y30LPPD*/ 02320000
         L     @10,ECBPTR                                       04S0722 02321000
         SLR   @05,@05                                          04S0722 02322000
         ST    @05,ECB(,@10)                                    04S0722 02323000
*LABELBUF = BLANK;                     /*CLEAR LABEL AREA    @Y30LPPD*/ 02324000
         MVI   LABELBUF+1,C' '                                  04S0723 02325000
         MVC   LABELBUF+2(78),LABELBUF+1                        04S0723 02326000
         MVI   LABELBUF,C' '                                    04S0723 02327000
*RFY RPARM RSTD;                       /*                    @Y30LPPD*/ 02328000
*RPARM = IOBSTPTR;                     /*ADDRESS OF IOB      @Y30LPPD*/ 02329000
         L     RPARM,IOBSTPTR                                   04S0725 02330000
*GEN REFS(RPARM) SETS(RPARM)                                    04S0726 02331000
*(EXCP (RPARM));                       /*READ VOLUME LABEL   @Y30LPPD*/ 02332000
         EXCP (RPARM)                                                   02333000
*RPARM = ECBPTR;                       /*ADDRESS OF ECB      @Y30LPPD*/ 02334000
         L     RPARM,ECBPTR                                     04S0727 02335000
*GEN REFS(RPARM) SETS(REG0,RPARM)                               04S0728 02336000
*(WAIT ECB=(RPARM));                   /*AWAIT I/O COMPLETION@Y30LPPD*/ 02337000
         WAIT ECB=(RPARM)                                               02338000
*RFY RPARM UNRSTD;                     /*                    @Y30LPPD*/ 02339000
*IF ECBCC ^= GOODPOST |                /*ERROR ON EXCP?      @Y30LPPD*/ 02340000
*   VOL1 ^= COMPVOL1 |                 /*NOT STANDARD LABEL? @Y30LPPD*/ 02341000
*   VOLSER ^= MSSVOL                   /*NOT RIGHT VOLSER?   @Y30LPPD*/ 02342000
*  THEN DO;                            /*ERROR -             @Y30LPPD*/ 02343000
         L     @10,ECBPTR                                       04S0730 02344000
         CLI   ECBCC(@10),X'7F'                                 04S0730 02345000
         BNE   @RT00730                                         04S0730 02346000
         CLC   VOL1(4),@CC00130                                 04S0730 02347000
         BNE   @RT00730                                         04S0730 02348000
         CLC   VOLSER(6),MSSVOL                                 04S0730 02349000
         BE    @RF00730                                         04S0730 02350000
@RT00730 DS    0H                                               04S0731 02351000
*    IOBFLAG1 = IOBFLAGS;              /*RE-INIT FLAGS       @Y30LPPD*/ 02352000
         L     @10,IOBSTPTR                                     04S0732 02353000
         MVI   IOBFLAG1(@10),X'42'                              04S0732 02354000
*    IF ECBCC ^= GOODPOST              /*IF I/O ERROR        @Y30LPPD*/ 02355000
*      THEN DO;                        /*                    @Y30LPPD*/ 02356000
         L     @05,ECBPTR                                       04S0733 02357000
         CLI   ECBCC(@05),X'7F'                                 04S0733 02358000
         BE    @RF00733                                         04S0733 02359000
*        RFY RPARM RSTD;               /*                    @Y30LPPD*/ 02360000
*        RPARM = IOBSTPTR;             /*ISSUE NIP SENSE TO  @Y30LPPD*/ 02361000
         LR    RPARM,@10                                        04S0736 02362000
*        GEN REFS(NVTSENSE)            /*INFORM OP OF ERROR  @Y30LPPD*/ 02363000
*        (IEAPMNIP TYPE=SENSE,PARAM=RPARM);                     04S0737 02364000
         IEAPMNIP TYPE=SENSE,PARAM=RPARM                                02365000
*        RFY RPARM UNRSTD;             /*                    @Y30LPPD*/ 02366000
*      END;                            /*                    @Y30LPPD*/ 02367000
*    GEN REFS(NVTWTO)                                           04S0740 02368000
*    (IEAPMNIP TYPE=WTO,PARAM=IEA854I);/*ISSUE IEA854I       @Y30LPPD*/ 02369000
@RF00733 DS    0H                                               04S0740 02370000
         IEAPMNIP TYPE=WTO,PARAM=IEA854I                                02371000
*    /*IEA854I ERROR READING VOLUME LABEL.                   @Y30LPPD*/ 02372000
*                                                               04S0741 02373000
*     /********************************************************* @Y30LB 02374000
*2*/                                                            04S0741 02375000
*     /*MACMEAN  MSSC DEMOUNT MACRO                              @Y30LB 02376000
*2*/                                                            04S0741 02377000
*     /*VS1-4/VS2-3 VERSION--01/19/76 LEVEL 00                   @ZDR20 02378000
*8*/                                                            04S0741 02379000
*     /*THIS IS THE OUTPUT FOR A SECONDARY                       @Y30LB 02380000
*2*/                                                            04S0741 02381000
*     /*INVOCATION OF THE STANDARD FORM MACRO                    @Y30LB 02382000
*2*/                                                            04S0741 02383000
*     /********************************************************* @Y30LB 02384000
*2*/                                                            04S0741 02385000
*     RFY  MDREG1 RSTD;/*RESTRICT REG 1 @Y30LB02*/              04S0741 02386000
*     MDREG1=ADDR(DMLEN);/*PTR TO REQ BLK @Y30LB02*/            04S0742 02387000
         LA    MDREG1,DMLEN                                     04S0742 02388000
*     DMVOL=(MSSVOL); /*VALUE OF VOLID @Y30LB02*/               04S0743 02389000
         MVC   DMVOL(6),MSSVOL                                  04S0743 02390000
*     DMNTVUA=(UCBCHAN); /*FILL VALUE OF VUA @ZDR2048*/         04S0744 02391000
         L     @10,UCBPTR                                       04S0744 02392000
         MVC   DMNTVUA(2),UCBCHAN(@10)                          04S0744 02393000
*     DMVUAVAL='1'B;/* OR ON THE VUA VALID ATTRIBUTE FLAG @ZDR2048*/    02394000
         OI    DMVUAVAL,B'00100000'                             04S0745 02395000
*     SVC  (126);/*INVOKE THE SSC SVC  @Y30LB02*/               04S0746 02396000
         SVC   126                                              04S0746 02397000
*     RFY  MDREG1 UNRSTD;/*UNREST REG 1 @Y30LB02*/ /*           04S0747 02398000
*                                    DEMOUNT MSS VOLUME  @Y30LPPD*/     02399000
*    RFY (RCODE,REG0) RSTD;            /*                    @Y30LPPD*/ 02400000
*    IF RCODE ^=ZERO                   /*RETURN CODE OK?     @Y30LPPD*/ 02401000
*      THEN DO;                        /*NO -                @Y30LPPD*/ 02402000
         LTR   RCODE,RCODE                                      04S0749 02403000
         BZ    @RF00749                                         04S0749 02404000
*        RSNCDE = REG0;                /*MOVE REASON CODE    @Y30LPPD*/ 02405000
         ST    REG0,RSNCDE                                      04S0751 02406000
*        RFY (RCODE,REG0) UNRSTD;      /*                    @Y30LPPD*/ 02407000
*        UNPK (UNPKAR,RSNAREA(3:5));   /*CONVERT REASON CODE @Y30LPPD*/ 02408000
         UNPK  UNPKAR(5),RSNAREA+2(3)                           04S0753 02409000
*        TR (UNPKAR(1:4),TRANSTAB);    /*                    @Y30LPPD*/ 02410000
         LA    @10,TRPATN                                       04S0754 02411000
         AL    @10,@CF02677                                     04S0754 02412000
         TR    UNPKAR(4),TRANSTAB(@10)                          04S0754 02413000
*        VOL985 = MSSVOL;              /*MOVE VOLSER TO MSG  @Y30LPPD*/ 02414000
         MVC   VOL985(6),MSSVOL                                 04S0755 02415000
*        DEV985 = UCBNAME;             /*MOVE VUA TO MSG     @Y30LPPD*/ 02416000
         L     @10,UCBPTR                                       04S0756 02417000
         MVC   DEV985(3),UCBNAME(@10)                           04S0756 02418000
*        RET985 = UNPKAR(2:4);         /*MOVE RETURN CODE    @Y30LPPD*/ 02419000
         MVC   RET985(3),UNPKAR+1                               04S0757 02420000
*        GEN REFS(NVTWTO)                                       04S0758 02421000
*        (IEAPMNIP TYPE=WTO,PARAM=IEA985I); /*ISSUE IEA985I  @Y30LPPD*/ 02422000
         IEAPMNIP TYPE=WTO,PARAM=IEA985I                                02423000
*        /*IEA985I UNABLE TO UNLOAD MSS VOLUME AAAAAA FROM   @Y30LPPD*/ 02424000
*        /*VXXX - RC=RET.                                    @Y30LPPD*/ 02425000
*      END;                            /*                    @Y30LPPD*/ 02426000
*      ELSE DO;                        /*DEMOUNT SUCCESSFUL  @Y30LPPD*/ 02427000
         B     @RC00749                                         04S0760 02428000
@RF00749 DS    0H                                               04S0761 02429000
*        UCBNOTRD = YES;               /*UNLOAD VOLUME       @Y30LPPD*/ 02430000
         L     @10,UCBPTR                                       04S0761 02431000
         OI    UCBNOTRD(@10),B'01000000'                        04S0761 02432000
*        V948 = VIRT;                  /*MOVE V TO MESSAGE   @Y30LPPD*/ 02433000
         MVI   V948,C'V'                                        04S0762 02434000
*        DEV948 = UCBNAME;             /*MOVE VUA TO MSG     @Y30LPPD*/ 02435000
         MVC   DEV948(3),UCBNAME(@10)                           04S0763 02436000
*        GEN REFS(NVTWTO)                                       04S0764 02437000
*        (IEAPMNIP TYPE=WTO,PARAM=IEA948I); /*ISSUE IEA948I  @Y30LPPD*/ 02438000
         IEAPMNIP TYPE=WTO,PARAM=IEA948I                                02439000
*        /*IEA948I VXXX NON UNLOADED.                        @Y30LPPD*/ 02440000
*      END;                            /*                    @Y30LPPD*/ 02441000
*  END;                                /*                    @Y30LPPD*/ 02442000
*  ELSE DO;                            /*READ SUCCESSFUL     @Y30LPPD*/ 02443000
         B     @RC00730                                         04S0767 02444000
@RF00730 DS    0H                                               04S0768 02445000
*    RFY (RTTR,RPARM,RCCHHR,REG4,RENTRY) RSTD; /*            @Y30LPPD*/ 02446000
*    RPARM = DEBPTR;                   /*ADDRESS OF DEB      @Y30LPPD*/ 02447000
         L     RPARM,DEBPTR                                     04S0769 02448000
*    MBB = ZERO;                       /*CLEAR BIN ADDRESS   @Y30LPPD*/ 02449000
         SLR   @14,@14                                          04S0770 02450000
         ST    @14,@TF00001                                     04S0770 02451000
         MVC   MBB(3),@TF00001+1                                04S0770 02452000
*    CCHHR = VOLVTOC;                  /*VTOC CCHHR          @Y30LPPD*/ 02453000
         MVC   CCHHR(5),VOLVTOC                                 04S0771 02454000
*    RENTRY = CVTPRLTV;                /*ADDR OF CONVERT RTN @Y30LPPD*/ 02455000
         L     @10,CVTPTR                                       04S0772 02456000
         L     RENTRY,CVTPRLTV(,@10)                            04S0772 02457000
*    GEN REFS(RCCHHR,RENTRY,RPARM,MBBCCHHR) /*CONVERT THE TTR@Y30LPPD*/ 02458000
*        SETS(REXIT,RTTR,RCCHHR,REGSAVE,REG4);                  04S0773 02459000
     STM   RPARM,RENTRY,REGSAVE          SAVE REGISTERS        @Y30LPPD 02460000
     LA    REG4,REGSAVE                                        @Y30LPPD 02461000
     LA    RCCHHR,MBBCCHHR                                     @Y30LPPD 02462000
     BALR  REXIT,RENTRY                  CONVERT ROUTINE       @Y30LPPD 02463000
     LM    RPARM,RENTRY,0(4)             RESTORE REGS          @Y30LPPD 02464000
*    UCBVTOC = RTTR;                   /*VTOC TTR INTO UCB   @Y30LPPD*/ 02465000
         L     @14,UCBPTR                                       04S0774 02466000
         ST    RTTR,UCBVTOC(,@14)                               04S0774 02467000
*    RFY (RCCHHR,RTTR,RPARM,REG4,RENTRY) UNRSTD;/*           @Y30LPPD*/ 02468000
*    UCBVOLI = VOLSER;                 /*MOVE VOLSER INTO UCB@Y30LPPD*/ 02469000
         MVC   UCBVOLI(6,@14),VOLSER                            04S0776 02470000
*    UCBONLI = YES;                    /*MAKE UCB ONLINE     @Y30LPPD*/ 02471000
         OI    UCBONLI(@14),B'10000000'                         04S0777 02472000
*    CALL SETSTAT;                     /*SET ATTRIBUTES      @Y30LPPD*/ 02473000
         BAL   @14,SETSTAT                                      04S0778 02474000
*  END;                                /*                    @Y30LPPD*/ 02475000
*        END;                          /*                    @Y30LPPD*/ 02476000
*    END;                              /*                    @Y30LPPD*/ 02477000
*    ELSE DO;                          /*DEVICE NOT ACCESSIBL@ZA14221*/ 02478000
         B     @RC00697                                         03S0782 02479000
@RF00697 DS    0H                                               03S0783 02480000
*      VOL409 = MSSVOL;                /*VOLSER              @ZA14221*/ 02481000
         MVC   VOL409(6),MSSVOL                                 03S0783 02482000
*      DEV409 = FINDDEV;               /*UNIT NAME           @ZA14221*/ 02483000
         MVC   DEV409(3),FINDDEV                                03S0784 02484000
*      GEN REFS(NVTWTOR);              /*                    @ZA14221*/ 02485000
       IEAPMNIP TYPE=WTO,PARAM=IEA409I   ISSUE MESSAGE          ZA14221 02486000
*      /*IEA409I UNABLE TO MOUNT MSS VOLUME AAAAAA ON DDD, DEVICE NOT   02487000
*        ACCESSIBLE.                                         @ZA14221*/ 02488000
*    END;                              /*END DEVICE NOT ACCESSIBLE      02489000
*                                                            @ZA14221*/ 02490000
*  END;                                /*                    @Y30LPPD*/ 02491000
@RC00697 DS    0H                                               03S0788 02492000
*MNTLIST(I) = MNTLIST(MTLSTCT);        /*REMOVE MNTLIST ENTRY@Y30LPPD*/ 02493000
@RF00679 LA    @10,22                                           03S0788 02494000
         LR    @05,@10                                          03S0788 02495000
         MH    @05,I                                            03S0788 02496000
         LA    @01,MNTLIST-22(@05)                              03S0788 02497000
         LH    @05,MTLSTCT                                      03S0788 02498000
         LR    @07,@10                                          03S0788 02499000
         MR    @06,@05                                          03S0788 02500000
         LA    @10,MNTLIST-22(@07)                              03S0788 02501000
         MVC   @TS00001(22),0(@10)                              03S0788 02502000
         MVC   0(22,@01),@TS00001                               03S0788 02503000
*MTLSTCT = MTLSTCT - ONE;              /*DECREASE COUNT      @Y30LPPD*/ 02504000
         BCTR  @05,0                                            03S0789 02505000
         STH   @05,MTLSTCT                                      03S0789 02506000
*      END;                            /*                    @Y30LPPD*/ 02507000
*      ELSE IF EMNTPRIO = SUPMNT       /*REAL VOLUME IS NOT MOUNTED.    02508000
*                                        IS MESSAGE SUPPRESSION 02S0791 02509000
*                                        INDICATED?          @Y30LPPD*/ 02510000
*        THEN DO;                      /*YES-                @Y30LPPD*/ 02511000
         B     @RC00639                                         02S0791 02512000
@RF00639 L     @10,MAPAD                                        02S0791 02513000
         CLI   EMNTPRIO(@10),C'N'                               02S0791 02514000
         BNE   @RF00791                                         02S0791 02515000
*          MNTLIST(I) = MNTLIST(MTLSTCT); /*REMOVE MNTLIST ENTRY     */ 02516000
         LA    @10,22                                           02S0793 02517000
         LR    @05,@10                                          02S0793 02518000
         MH    @05,I                                            02S0793 02519000
         LA    @01,MNTLIST-22(@05)                              02S0793 02520000
         LH    @05,MTLSTCT                                      02S0793 02521000
         LR    @07,@10                                          02S0793 02522000
         MR    @06,@05                                          02S0793 02523000
         LA    @10,MNTLIST-22(@07)                              02S0793 02524000
         MVC   @TS00001(22),0(@10)                              02S0793 02525000
         MVC   0(22,@01),@TS00001                               02S0793 02526000
*          MTLSTCT = MTLSTCT - ONE;    /*DECREMENT LIST COUNT        */ 02527000
         BCTR  @05,0                                            02S0794 02528000
         STH   @05,MTLSTCT                                      02S0794 02529000
*        END;                                                   02S0795 02530000
*        ELSE DO;                      /*LEAVE ENTRY IN LIST         */ 02531000
         B     @RC00791                                         02S0796 02532000
@RF00791 DS    0H                                               02S0797 02533000
*          I = I + ONE;                /*INDICATE NEXT ENTRY         */ 02534000
         LA    @10,1                                            02S0797 02535000
         LH    @05,I                                            02S0797 02536000
         ALR   @05,@10                                          02S0797 02537000
         STH   @05,I                                            02S0797 02538000
*          DEVCT(J) = DEVCT(J) + ONE;  /*INCR. DEVICE TYPE COUNTER   */ 02539000
         LH    @05,J                                            02S0798 02540000
         MH    @05,@CH01793                                     02S0798 02541000
         AH    @10,DEVCT-14(@05)                                02S0798 02542000
         STH   @10,DEVCT-14(@05)                                02S0798 02543000
*        END;                                                   02S0799 02544000
*END;                                                           02S0800 02545000
@RC00791 DS    0H                                               02S0800 02546000
@RC00639 DS    0H                                               02S0800 02547000
@RC00571 DS    0H                                               02S0800 02548000
@DE00559 LH    @10,MTLSTCT                                      02S0800 02549000
         CH    @10,I                                            02S0800 02550000
         BNL   @DL00559                                         02S0800 02551000
*END;                                  /*                    @ZA14221*/ 02552000
*IF MTLSTCT ^= ZERO                    /* IF THERE IS A MOUNT LIST,  */ 02553000
*  THEN DO;                                                     01S0802 02554000
         LTR   @10,@10                                          01S0802 02555000
         BZ    @RF00802                                         01S0802 02556000
*    DO I = ONE TO NUMSUPTD;           /* SET ALL AUXILIARY COUNTERS */ 02557000
         LA    @10,1                                            01S0804 02558000
         STH   @10,I                                            01S0804 02559000
@DL00804 DS    0H                                               01S0805 02560000
*      AUXCT(I) = DEVCT(I);            /* EQUAL TO THE DEVICE TYPE   */ 02561000
         LR    @05,@10                                          01S0805 02562000
         MH    @05,@CH01793                                     01S0805 02563000
         LH    @15,DEVCT-14(@05)                                01S0805 02564000
         STH   @15,AUXCT-14(@05)                                01S0805 02565000
*    END;                              /* COUNTERS.                  */ 02566000
         AH    @10,@CH00042                                     01S0806 02567000
         STH   @10,I                                            01S0806 02568000
         CH    @10,@CH00084                                     01S0806 02569000
         BNH   @DL00804                                         01S0806 02570000
*    DO;                               /* PUT OUT MOUNT MESSAGES.    */ 02571000
*/********************************************************************/ 02572000
*/*                                                                  */ 02573000
*/* SEGMENT NAME - MOUNTMSG                                          */ 02574000
*/*                                                                  */ 02575000
*/* DESCRIPTIVE NAME - ISSUE MOUNT MESSAGES                          */ 02576000
*/*                                                                  */ 02577000
*/* FUNCTION -                                                       */ 02578000
*/*                                                                  */ 02579000
*/*     ISSUE WTO FOR MESSAGE 'IEA851I-FOLLOWING MAY BE MOUNTED'.    */ 02580000
*/*     FOR EACH ENTRY IN THE MOUNT LIST, MOVE VOLUME SERIAL NUMBER  */ 02581000
*/*     AND DEVICE TYPE INTO MESSAGE AREA AND ISSUE WTO.  WHEN ALL   */ 02582000
*/*     MOUNT LIST ENTRIES HAVE BEEN PROCESSED, ISSUE WTOR FOR       */ 02583000
*/*     MESSAGE 'IEA851A-REPLY DEVICE ADDRESSES OR U'.               */ 02584000
*/*                                                                  */ 02585000
*/* ENTRY - IN-LINE SEGMENT                                          */ 02586000
*/*                                                                  */ 02587000
*/*     PURPOSE -                                                    */ 02588000
*/*                                                                  */ 02589000
*/*         LIST ON THE OPERATOR'S CONSOLE ANY VOLUMES IN VATLST     */ 02590000
*/*         THAT WERE NOT MOUNTED AT SYSTEM START, AND DEVICE TYPES  */ 02591000
*/*         FOR THESE VOLUMES.                                       */ 02592000
*/*                                                                  */ 02593000
*/*     INPUT DATA -                                                 */ 02594000
*/*                                                                  */ 02595000
*/*         MNTLIST - MOUNT LIST                                     */ 02596000
*/*         MTLSTCT - NUMBER OF ENTRIES IN MNTLIST                   */ 02597000
*/*                                                                  */ 02598000
*/* EXITS -                                                          */ 02599000
*/*                                                                  */ 02600000
*/*     CONDITION - NORMAL                                           */ 02601000
*/*                                                                  */ 02602000
*/*     OUTPUT DATA -                                                */ 02603000
*/*                                                                  */ 02604000
*/*         MESSAGES IEA851I, IEA851A, LIST OF VOLUMES               */ 02605000
*/*                                                                  */ 02606000
*/*     RETURN CODE - NONE                                           */ 02607000
*/*                                                                  */ 02608000
*/********************************************************************/ 02609000
*                                                               02S0808 02610000
*GEN REFS(NVTWTO);                    /*ISSUE HEADER MESSAGE IEA851I */ 02611000
* IEA851I FOLLOWING MAY BE MOUNTED.                                     02612000
         IEAPMNIP TYPE=WTO,PARAM=IEA851I                                02613000
*DO NEXTPTR = ONE TO MTLSTCT;          /*LOOP THROUGH MOUNT LIST     */ 02614000
         LA    @10,1                                            02S0809 02615000
         B     @DE00809                                         02S0809 02616000
@DL00809 DS    0H                                               02S0810 02617000
*  SER851 = MVOLSER(NEXTPTR);          /*MOVE VOL SER INTO MESSAGE   */ 02618000
         MH    @10,@CH00190                                     02S0810 02619000
         LA    @05,MVOLSER-22(@10)                              02S0810 02620000
         MVC   SER851(6),0(@05)                                 02S0810 02621000
*  DEV851 = MDEVTYPE(NEXTPTR);         /*MOVE DEVICE TYPE INTO MSG   */ 02622000
         LA    @05,MDEVTYPE-22(@10)                             02S0811 02623000
         MVC   DEV851(8),0(@05)                                 02S0811 02624000
*  GEN REFS(NVTWTO);                   /*PRINT ONE LINE              */ 02625000
*    SER ON DDDTYP                                                      02626000
         IEAPMNIP TYPE=WTO,PARAM=IEA851I2                               02627000
*END;                                                           02S0813 02628000
         LA    @10,1                                            02S0813 02629000
         AH    @10,NEXTPTR                                      02S0813 02630000
@DE00809 STH   @10,NEXTPTR                                      02S0813 02631000
         CH    @10,MTLSTCT                                      02S0813 02632000
         BNH   @DL00809                                         02S0813 02633000
*GEN REFS(NVTWTOR);                    /*ISSUE MESSAGE IEA851A       */ 02634000
* IEA851A REPLY DEVICE ADDRESSES OR U.                                  02635000
         IEAPMNIP TYPE=WTOR,PARAM=IEA851A                               02636000
*                                      /* RETURN TO TOP SEGMENT.     */ 02637000
*    END;                                                       01S0815 02638000
*    DO WHILE NODEV = NO;              /* VALIDATE OPERATOR REPLY    */ 02639000
         B     @DE00816                                         01S0816 02640000
@DL00816 DS    0H                                               01S0817 02641000
*/********************************************************************/ 02642000
*/*                                                                  */ 02643000
*/* SEGMENT NAME - CKREPLY                                           */ 02644000
*/*                                                                  */ 02645000
*/* DESCRIPTIVE NAME - CHECK REPLY TO MOUNT MESSAGES                 */ 02646000
*/*                                                                  */ 02647000
*/* FUNCTION -                                                       */ 02648000
*/*                                                                  */ 02649000
*/*     WAIT FOR REPLY TO MESSAGE IEA851A.  IF REPLY IS 'U' OR EOB,  */ 02650000
*/*     THEN SET 'NODEV' EQUAL TO YES (NO DEVICES REPLIED IN ANSWER  */ 02651000
*/*     TO MESSAGE).  OTHERWISE, EXECUTE 'DEVREPLY' SEGMENT.         */ 02652000
*/*                                                                  */ 02653000
*/* ENTRY - IN-LINE SEGMENT                                          */ 02654000
*/*                                                                  */ 02655000
*/*     PURPOSE -                                                    */ 02656000
*/*                                                                  */ 02657000
*/*         EXAMINE REPLY FROM MESSAGE IEA851A.                      */ 02658000
*/*                                                                  */ 02659000
*/*     INPUT DATA -                                                 */ 02660000
*/*                                                                  */ 02661000
*/*         WTORBUF - CONTAINS REPLY TO IEA851A                      */ 02662000
*/*                                                                  */ 02663000
*/* EXITS -                                                          */ 02664000
*/*                                                                  */ 02665000
*/*     CONDITION - REPLY IS U OR EOB                                */ 02666000
*/*                                                                  */ 02667000
*/*     OUTPUT DATA -                                                */ 02668000
*/*                                                                  */ 02669000
*/*         NODEV - SET TO ON                                        */ 02670000
*/*                                                                  */ 02671000
*/*     CONDITION - REPLY IS DEVICE ADDRESS(ES)                      */ 02672000
*/*                                                                  */ 02673000
*/*     OUTPUT DATA - NONE                                           */ 02674000
*/*                                                                  */ 02675000
*/*     RETURN CODE - NONE                                           */ 02676000
*/*                                                                  */ 02677000
*/********************************************************************/ 02678000
*                                                               02S0817 02679000
*IF SCAN2=REPLYU | SCAN2=REPLYEOB      /*CHECK FOR REPLY OF U OR EOB */ 02680000
*  THEN NODEV = YES;                   /*NO DEVICES REPLIED          */ 02681000
         CLC   SCAN2(2),@CC00168                                02S0817 02682000
         BE    @RT00817                                         02S0817 02683000
         CLC   SCAN2(2),@CC00170                                02S0817 02684000
         BNE   @RF00817                                         02S0817 02685000
@RT00817 DS    0H                                               02S0818 02686000
         OI    NODEV,B'00010000'                                02S0818 02687000
*  ELSE DO;                            /* VALIDITY CHECK REPLY.      */ 02688000
         B     @RC00817                                         02S0819 02689000
@RF00817 DS    0H                                               02S0820 02690000
*/********************************************************************/ 02691000
*/*                                                                  */ 02692000
*/* SEGMENT NAME - DEVREPLY                                          */ 02693000
*/*                                                                  */ 02694000
*/* DESCRIPTIVE NAME - CONTROL VALIDITY CHECK OF THE DEVICE REPLY    */ 02695000
*/*                    AND ISSUE FORMAT ERROR MESSAGE                */ 02696000
*/*                                                                  */ 02697000
*/* FUNCTION -                                                       */ 02698000
*/*                                                                  */ 02699000
*/*     INITIALIZE 'BADADDR', WHICH WILL CONTAIN THE INVALID DEVICE  */ 02700000
*/*     ADDRESS IF ONE IS FOUND, TO ZERO.  SET SWITCHES 'MSG1',      */ 02701000
*/*     'MSG2', AND 'GOODLIST' OFF.                                  */ 02702000
*/*                                                                  */ 02703000
*/*     AFTER THE REPLY HAS BEEN VALIDITY CHECKED, THE SWITCH 'MSG1' */ 02704000
*/*     IS TESTED.  IF IT IS ON, A FORMAT ERROR HAS BEEN FOUND AND   */ 02705000
*/*     MESSAGE IEA895A IS ISSUED.                                   */ 02706000
*/*                                                                  */ 02707000
*/*     IF NO FORMAT ERROR HAS BEEN FOUND, THE SEGMENT WHICH CHECKS  */ 02708000
*/*     THE VALIDITY OF THE DEVICE IS EXECUTED.                      */ 02709000
*/*                                                                  */ 02710000
*/* ENTRY - IN-LINE SEGMENT                                          */ 02711000
*/*                                                                  */ 02712000
*/*     PURPOSE - SEE FUNCTION                                       */ 02713000
*/*                                                                  */ 02714000
*/*     INPUT DATA -                                                 */ 02715000
*/*                                                                  */ 02716000
*/*         DEVICE REPLY (TO MESSAGE IEA851A)                        */ 02717000
*/*                                                                  */ 02718000
*/* EXITS -                                                          */ 02719000
*/*                                                                  */ 02720000
*/*     CONDITION - NORMAL                                           */ 02721000
*/*                                                                  */ 02722000
*/*     OUTPUT DATA - NONE                                           */ 02723000
*/*                                                                  */ 02724000
*/*     CONDITION - FORMAT ERROR                                     */ 02725000
*/*                                                                  */ 02726000
*/*     OUTPUT DATA -                                                */ 02727000
*/*                                                                  */ 02728000
*/*         MESSAGE IEA895A ISSUED                                   */ 02729000
*/*                                                                  */ 02730000
*/*     RETURN CODE - NONE                                           */ 02731000
*/*                                                                  */ 02732000
*/********************************************************************/ 02733000
*                                                               03S0820 02734000
*BADADDR = ZEROADDR;                   /* INIT INVALID DEVICE PTR.   */ 02735000
         MVC   BADADDR(3),ZEROADDR                              03S0820 02736000
*MSG1 = NO;                            /* INIT MESSAGE SWITCHES.     */ 02737000
*MSG2 = NO;                                                     03S0822 02738000
         NI    MSG1,B'11100111'                                 03S0822 02739000
*GOODLIST = NO;                        /* INIT VALID REPLY INDIC.    */ 02740000
         NI    GOODLIST,B'11111011'                             03S0823 02741000
*DO;                                   /* CHECK FORMAT OF REPLY.     */ 02742000
*/********************************************************************/ 02743000
*/*                                                                  */ 02744000
*/* SEGMENT NAME - DELIMCK                                           */ 02745000
*/*                                                                  */ 02746000
*/* DESCRIPTIVE NAME - CHECK DELIMITERS IN THE DEVICE REPLY          */ 02747000
*/*                                                                  */ 02748000
*/* FUNCTION -                                                       */ 02749000
*/*                                                                  */ 02750000
*/*     WHEN THE END OF THE REPLY HAS BEEN ENCOUNTERED, THE COUNTER  */ 02751000
*/*     'TOMOUNT' IS SET TO THE NUMBER OF VOLUMES THE OPERATOR       */ 02752000
*/*     WISHES TO MOUNT.                                             */ 02753000
*/*                                                                  */ 02754000
*/*     IF THE END INDICATOR OR A COMMA IS FOUND IN THE DEVICE ADD-  */ 02755000
*/*     RESS FIELD, OR THE DELIMITER IS NOT A COMMA OR END INDICATOR,*/ 02756000
*/*     'MSG1' SWITCH IS SET ON TO INDICATE THAT A FORMAT ERROR WAS  */ 02757000
*/*     FOUND.                                                       */ 02758000
*/*                                                                  */ 02759000
*/* ENTRY - IN-LINE SEGMENT                                          */ 02760000
*/*                                                                  */ 02761000
*/*     PURPOSE - SEE FUNCTION                                       */ 02762000
*/*                                                                  */ 02763000
*/*     INPUT DATA -                                                 */ 02764000
*/*                                                                  */ 02765000
*/*         REPLAREA - CONTAINS THE DEVICE REPLY                     */ 02766000
*/*         MSG1 - SET OFF                                           */ 02767000
*/*                                                                  */ 02768000
*/* EXITS -                                                          */ 02769000
*/*                                                                  */ 02770000
*/*     CONDITION - NORMAL                                           */ 02771000
*/*                                                                  */ 02772000
*/*     OUTPUT DATA -                                                */ 02773000
*/*                                                                  */ 02774000
*/*         TOMOUNT - SET TO THE NUMBER OF VOLUMES TO BE MOUNTED     */ 02775000
*/*                                                                  */ 02776000
*/*     CONDITION - THE END INDICATOR OR A COMMA IS FOUND IN THE     */ 02777000
*/*                 DEVICE FIELD                                     */ 02778000
*/*                                                                  */ 02779000
*/*     OUTPUT DATA -                                                */ 02780000
*/*                                                                  */ 02781000
*/*         MSG1 - SET ON                                            */ 02782000
*/*                                                                  */ 02783000
*/*     CONDITION - DELIMITER IS NOT COMMA OR END INDICATOR          */ 02784000
*/*                                                                  */ 02785000
*/*     OUTPUT DATA -                                                */ 02786000
*/*                                                                  */ 02787000
*/*         MSG1 - SET ON                                            */ 02788000
*/*                                                                  */ 02789000
*/*     RETURN CODE - NONE                                           */ 02790000
*/*                                                                  */ 02791000
*/********************************************************************/ 02792000
*                                                               04S0825 02793000
*LOOPSW = NO;                          /* INIT LOOP SWITCH.  SET UP  */ 02794000
         NI    LOOPSW,B'11101111'                               04S0825 02795000
*DO I = ONE TO REPLYMAX WHILE LOOPSW = NO;    /* TO CHECK MAX REPLY. */ 02796000
         LA    @10,1                                            04S0826 02797000
         STH   @10,I                                            04S0826 02798000
@DL00826 TM    LOOPSW,B'00010000'                               04S0826 02799000
         BNZ   @DC00826                                         04S0826 02800000
*  DO N = THREE TO ONE BY - ONE WHILE MSG1 = NO; /* CK DEV ADDR  FOR */ 02801000
         LA    @10,3                                            04S0827 02802000
         STH   @10,N                                            04S0827 02803000
@DL00827 TM    MSG1,B'00010000'                                 04S0827 02804000
         BNZ   @DC00827                                         04S0827 02805000
*    IF UNIT(I,N) = QUOTE | UNIT(I,N) = COMMA     /* END INDIC. OR   */ 02806000
*      THEN DO;                        /* DELIM. IF FOUND, SET SW TO */ 02807000
         LH    @05,I                                            04S0828 02808000
         SLA   @05,2                                            04S0828 02809000
         ALR   @05,@10                                          04S0828 02810000
         LA    @10,UNIT-5(@05)                                  04S0828 02811000
         CLI   0(@10),C''''                                     04S0828 02812000
         BE    @RT00828                                         04S0828 02813000
         LA    @10,UNIT-5(@05)                                  04S0828 02814000
         CLI   0(@10),C','                                      04S0828 02815000
         BNE   @RF00828                                         04S0828 02816000
@RT00828 DS    0H                                               04S0829 02817000
*        MSG1 = YES;                   /* PUT OUT FORMAT ERROR MSG.  */ 02818000
         OI    MSG1,B'00010000'                                 04S0830 02819000
*        LOOPSW = YES;                 /* AND TERM VALIDITY CHECK.   */ 02820000
         OI    LOOPSW,B'00010000'                               04S0831 02821000
*      END;                                                     04S0832 02822000
*  END;                                                         04S0833 02823000
@RF00828 SLR   @10,@10                                          04S0833 02824000
         BCTR  @10,0                                            04S0833 02825000
         AH    @10,N                                            04S0833 02826000
         STH   @10,N                                            04S0833 02827000
         LTR   @10,@10                                          04S0833 02828000
         BP    @DL00827                                         04S0833 02829000
@DC00827 DS    0H                                               04S0834 02830000
*  IF MSG1 = NO                        /* IF NO ERROR DETECTED YET,  */ 02831000
*    THEN DO;                          /* AND THIS IS THE END OF THE */ 02832000
         TM    MSG1,B'00010000'                                 04S0834 02833000
         BNZ   @RF00834                                         04S0834 02834000
*      IF DELIM(I) = QUOTE             /* OPERATOR'S REPLY, THEN SET */ 02835000
*        THEN DO;                      /* THE NUMBER OF VOLUMES TO   */ 02836000
         LH    @10,I                                            04S0836 02837000
         LR    @05,@10                                          04S0836 02838000
         SLA   @05,2                                            04S0836 02839000
         LA    @01,DELIM-4(@05)                                 04S0836 02840000
         CLI   0(@01),C''''                                     04S0836 02841000
         BNE   @RF00836                                         04S0836 02842000
*          TOMOUNT = I;                /* BE MOUNTED.                */ 02843000
         STH   @10,TOMOUNT                                      04S0838 02844000
*          LOOPSW = YES;               /* TERMINATE REPLY CHECKING.  */ 02845000
         OI    LOOPSW,B'00010000'                               04S0839 02846000
*        END;                                                   04S0840 02847000
*        ELSE IF DELIM(I) ^= COMMA     /* IF IT IS NOT THE END AND   */ 02848000
*          THEN DO;                    /* NOT A VALID DELIMITER,     */ 02849000
         B     @RC00836                                         04S0841 02850000
@RF00836 LH    @10,I                                            04S0841 02851000
         SLA   @10,2                                            04S0841 02852000
         LA    @05,DELIM-4(@10)                                 04S0841 02853000
         CLI   0(@05),C','                                      04S0841 02854000
         BE    @RF00841                                         04S0841 02855000
*            MSG1 = YES;               /* SET ERROR MSG SWITCH AND   */ 02856000
         OI    MSG1,B'00010000'                                 04S0843 02857000
*            LOOPSW = YES;             /* TERMINATE REPLY CHECKING.  */ 02858000
         OI    LOOPSW,B'00010000'                               04S0844 02859000
*          END;                                                 04S0845 02860000
*    END;                                                       04S0846 02861000
@RF00841 DS    0H                                               04S0846 02862000
@RC00836 DS    0H                                               04S0847 02863000
*END;                                  /* RETURN TO DEVREPLY.        */ 02864000
@RF00834 LA    @10,1                                            04S0847 02865000
         AH    @10,I                                            04S0847 02866000
         STH   @10,I                                            04S0847 02867000
         CH    @10,@CH00088                                     04S0847 02868000
         BNH   @DL00826                                         04S0847 02869000
@DC00826 DS    0H                                               04S0848 02870000
*END;                                                           03S0848 02871000
*IF MSG1 = YES                         /* IF MSG SWITCH IS ON        */ 02872000
*  THEN DO;                                                     03S0849 02873000
         TM    MSG1,B'00010000'                                 03S0849 02874000
         BNO   @RF00849                                         03S0849 02875000
*    GEN REFS(NVTWTOR);                /* ISSUE REPEAT REPLY MSG.    */ 02876000
     IEAPMNIP TYPE=WTOR,PARAM=IEA895A  /* FOR FORMAT ERROR.          */ 02877000
*  END;                                                         03S0852 02878000
*  ELSE DO;                            /* IF NO FORMAT ERROR, THEN   */ 02879000
         B     @RC00849                                         03S0853 02880000
@RF00849 DS    0H                                               03S0854 02881000
*                                      /* VALIDATE UCB.              */ 02882000
*/********************************************************************/ 02883000
*/*                                                                  */ 02884000
*/* SEGMENT NAME - CHECKUCB                                          */ 02885000
*/*                                                                  */ 02886000
*/* DESCRIPTIVE NAME - CONTROL VALIDITY CHECK OF DEVICE ADDRESSES    */ 02887000
*/*                    IN THE REPLY AND ISSUE REPEAT REPLY MESSAGE.  */ 02888000
*/*                                                                  */ 02889000
*/* FUNCTION -                                                       */ 02890000
*/*                                                                  */ 02891000
*/*     CONTROL IS GIVEN TO THE SEGMENT THAT CHECKS THE VALIDITY OF  */ 02892000
*/*     THE ADDRESSES.                                               */ 02893000
*/*                                                                  */ 02894000
*/*     WHEN THE VALIDITY HAS BEEN CHECKED, 'BADADDR' IS TESTED.     */ 02895000
*/*     IF AN ERROR HAS BEEN DETECTED, IT WILL CONTAIN THE INVALID   */ 02896000
*/*     ADDRESS.  IF IT IS ZERO, THE SEGMENT THAT CHECKS FOR DUPLI-  */ 02897000
*/*     CATE DEVICES IN THE REPLY IS EXECUTED.                       */ 02898000
*/*                                                                  */ 02899000
*/*     THE SWITCH 'MSG2' IS TESTED.  IF IT IS NOT ON, THE SWITCHES  */ 02900000
*/*     'GOODLIST' AND 'NODEV' ARE SET ON.  THESE SWITCHES INDICATE  */ 02901000
*/*     THAT VOLUMES WILL BE MOUNTED AND THE DEVICE REPLY HAS BEEN   */ 02902000
*/*     COMPLETELY VALIDATED.  IF 'MSG2' IS ON, THE DEVICE COUNTS    */ 02903000
*/*     ARE RESET AND MESSAGE 'IEA852A-REPEAT REPLY' IS ISSUED.      */ 02904000
*/*                                                                  */ 02905000
*/* ENTRY - IN-LINE SEGMENT                                          */ 02906000
*/*                                                                  */ 02907000
*/*     PURPOSE - SEE FUNCTION                                       */ 02908000
*/*                                                                  */ 02909000
*/*     INPUT DATA -                                                 */ 02910000
*/*                                                                  */ 02911000
*/*         GOODLIST - SWITCH IS SET ON                              */ 02912000
*/*         REPLAREA - CONTAINS THE DEVICE ADDRESSES REPLY           */ 02913000
*/*                                                                  */ 02914000
*/* EXITS -                                                          */ 02915000
*/*                                                                  */ 02916000
*/*     CONDITION - NORMAL                                           */ 02917000
*/*                                                                  */ 02918000
*/*     OUTPUT DATA -                                                */ 02919000
*/*                                                                  */ 02920000
*/*         GOODLIST - SWITCH IS ON                                  */ 02921000
*/*         NODEV - SWITCH IS ON                                     */ 02922000
*/*                                                                  */ 02923000
*/*     CONDITION - ERROR                                            */ 02924000
*/*                                                                  */ 02925000
*/*     OUTPUT DATA -                                                */ 02926000
*/*                                                                  */ 02927000
*/*         GOODLIST - SWITCH IS LEFT OFF                            */ 02928000
*/*         MESSAGE IEA852A IS ISSUED                                */ 02929000
*/*         DEVCT(X) - SET EQUAL TO AUXCT(X)                         */ 02930000
*/*                                                                  */ 02931000
*/*     RETURN CODE - NONE                                           */ 02932000
*/*                                                                  */ 02933000
*/********************************************************************/ 02934000
*                                                               04S0854 02935000
*DO;                                   /* CHECK EACH DEVICE IN THE   */ 02936000
*                                      /* REPLY FOR A VALID UCB.     */ 02937000
*/********************************************************************/ 02938000
*/*                                                                  */ 02939000
*/* SEGMENT NAME - UCBFIND                                           */ 02940000
*/*                                                                  */ 02941000
*/* DESCRIPTIVE NAME - VALIDITY CHECK THE UCB'S CORRESPONDING TO     */ 02942000
*/*                    THE DEVICE ADDRESSES IN THE REPLY             */ 02943000
*/*                                                                  */ 02944000
*/* FUNCTION -                                                       */ 02945000
*/*                                                                  */ 02946000
*/*     FOR EACH DEVICE ON THE REPLY, UCBFN IS ISSUED.  THE          */ 02947000
*/*     DEVICE ADDRESS IS PLACED IN 'BADADDR' IN CASE ANY OF THESE   */ 02948000
*/*     ERRORS OCCURS:                                               */ 02949000
*/*                                                                  */ 02950000
*/*         1. UCBFN DOES NOT RETURN A UCB ADDRESS.                  */ 02951000
*/*         2. UCB IS FOR A DEMOUNTABLE DEVICE THAT CONTAINS @YM02792*/ 02952000
*/*            A PERMANENTLY RESIDENT OR RESERVED VOLUME.            */ 02953000
*/*         3. THE UCB DEVICE TYPE IS NOT A DEVICE TYPE ON WHICH     */ 02954000
*/*            A VOLUME IS TO BE MOUNTED.                            */ 02955000
*/*         4. THE UCB IS FOR A NON-DEMOUNTABLE DEVICE THAT  @YM02792*/ 02956000
*/*            WAS ONLINE AT IPL.                            @YM02792*/ 02957000
*/*         5. THE UCB IS AN EXPOSURE IN A MULTIPLE EXPOSURE @YM02792*/ 02958000
*/*            DEVICE, BUT IS NOT FOR THE BASE EXPOSURE.             */ 02959000
*/*         6. THE UCB IS FOR AN MSS DEVICE.                 @Y30LPPD*/ 02960000
*/*                                                                  */ 02961000
*/*     IF NONE OF THE ABOVE CONDITIONS ARE FOUND, THE SEGMENT WHICH */ 02962000
*/*     CHECKS FOR ONLINE STATUS IS EXECUTED.                        */ 02963000
*/*                                                                  */ 02964000
*/*     IF THE UCB IS VALID (BADADDR IS ZERO), THE DEVICE TYPE COUNT-*/ 02965000
*/*     ER IS DECREMENTED.  OTHERWISE, THE SEGMENT THAT ISSUES THE   */ 02966000
*/*     ERROR MESSAGE IS EXECUTED.                                   */ 02967000
*/*                                                                  */ 02968000
*/* ENTRY - IN-LINE SEGMENT                                          */ 02969000
*/*                                                                  */ 02970000
*/*     PURPOSE - SEE FUNCTION                                       */ 02971000
*/*                                                                  */ 02972000
*/*     INPUT DATA -                                                 */ 02973000
*/*                                                                  */ 02974000
*/*         REPLAREA - CONTAINS THE DEVICE ADDRESS REPLY             */ 02975000
*/*         TOMOUNT - CONTAINS THE NUMBER OF DEVICE ADDRESSES        */ 02976000
*/*                   TO CHECK                                       */ 02977000
*/*                                                                  */ 02978000
*/* EXITS -                                                          */ 02979000
*/*                                                                  */ 02980000
*/*     CONDITION - NORMAL                                           */ 02981000
*/*                                                                  */ 02982000
*/*     OUTPUT DATA -                                                */ 02983000
*/*                                                                  */ 02984000
*/*         DEVCT(X) - DEVICE TYPE COUNTERS ARE DECREMENTED          */ 02985000
*/*                                                                  */ 02986000
*/*     CONDITION - THE UCB IS INVALID                               */ 02987000
*/*                                                                  */ 02988000
*/*     OUTPUT DATA -                                                */ 02989000
*/*                                                                  */ 02990000
*/*         BADADDR - CONTAINS THE DEVICE ADDRESS CORRESPONDING      */ 02991000
*/*                   TO THE INVALID UCB                             */ 02992000
*/*         R852 - REASON CODE FIELD IN MESSAGE IEA852I SET TO:      */ 02993000
*/*                2 - IF NO UCB IS FOUND                            */ 02994000
*/*                3 - IF UCB IS FOR DEMOUNTABLE DEVICE THAT @YM02792*/ 02995000
*/*                    CONTAINS A P/R OR RESV VOLUME         @YM02792*/ 02996000
*/*                4 - IF DEVICE IS NOT DA                           */ 02997000
*/*                5 - IF THERE ARE NO MORE OF THIS TYPE TO BE       */ 02998000
*/*                    MOUNTED                                       */ 02999000
*/*                9 - ADDR SPECIFIED IS FOR AN EXPOSURE     @YM02792*/ 03000000
*/*                    WITHIN A MULTIPLE EXPOSURE DEVICE     @YM02792*/ 03001000
*/*               10 - UCB IS FOR A NON-DEMOUNTABLE DEVICE   @YM02792*/ 03002000
*/*                    THAT WAS ONLINE AT IPL.               @YM02792*/ 03003000
*/*               11 - UCB IS FOR AN MSS DEVICE              @Y30LPPD*/ 03004000
*/*                                                                  */ 03005000
*/*     RETURN CODE - NONE                                           */ 03006000
*/*                                                                  */ 03007000
*/********************************************************************/ 03008000
*                                                               05S0855 03009000
*DO I = ONE TO TOMOUNT;                /* FOR EACH DEVICE ADDRESS    */ 03010000
         LA    @10,1                                            05S0855 03011000
         B     @DE00855                                         05S0855 03012000
@DL00855 DS    0H                                               05S0856 03013000
*  FINDDEV = UNIT(I);                  /* SPECIFIED IN THE REPLY,    */ 03014000
         SLA   @10,2                                            05S0856 03015000
         LA    @05,UNIT-4(@10)                                  05S0856 03016000
         MVC   FINDDEV(3),0(@05)                                05S0856 03017000
*  RESPECIFY (RPARM) RSTD;                                      05S0857 03018000
*  RPARM = FINDADDR;                   /* FIND THE CORRESPONDING     */ 03019000
         L     RPARM,FINDADDR                                   05S0858 03020000
*  GEN REFS (NVTUCBFN) (IEAPMNIP TYPE=UCBFN,PARAM=RPARM); /* UCB ADDR*/ 03021000
         IEAPMNIP TYPE=UCBFN,PARAM=RPARM                                03022000
*  BADADDR = UNIT(I);                  /* SAVE DEV IN CASE OF ERROR. */ 03023000
         LH    @10,I                                            05S0860 03024000
         SLA   @10,2                                            05S0860 03025000
         LA    @05,UNIT-4(@10)                                  05S0860 03026000
         MVC   BADADDR(3),0(@05)                                05S0860 03027000
*  IF RPARM ^= ZERO                                             05S0861 03028000
*    THEN DO;                          /* IF THERE IS A CORRESPOND-  */ 03029000
         LTR   RPARM,RPARM                                      05S0861 03030000
         BZ    @RF00861                                         05S0861 03031000
*      UCBPTR = RPARM;                 /* ING UCB, THEN TEST IT.     */ 03032000
         ST    RPARM,UCBPTR                                     05S0863 03033000
*      RESPECIFY (RPARM) UNRSTD;                                05S0864 03034000
*      FOUND = NO;                     /* INIT SWITCH.               */ 03035000
         NI    FOUND,B'11111101'                                05S0865 03036000
*      ERROR = NO;                     /* INIT SWITCH        @YM02792*/ 03037000
         NI    ERROR,B'11011111'                                05S0866 03038000
*      IF UCB3DACC = YES               /* IF UCB IS FOR DIRECT ACCESS*/ 03039000
*        THEN IF UCBRVDEV = NO         /* NOT VIRTUAL,       @Y30LPPD*/ 03040000
         L     @10,UCBPTR                                       05S0867 03041000
         TM    UCB3DACC(@10),B'00100000'                        05S0867 03042000
         BNO   @RF00867                                         05S0867 03043000
*          THEN IF UCBRESV = NO        /* NOT RESERVED, AND  @YM02792*/ 03044000
         TM    UCBRVDEV(@10),B'00001000'                        05S0868 03045000
         BNZ   @RF00868                                         05S0868 03046000
*            THEN DO;                                       /*YM02792*/ 03047000
         TM    UCBRESV(@10),B'00100000'                         05S0869 03048000
         BNZ   @RF00869                                         05S0869 03049000
*              IF UCBPRES = NO         /* NOT PERMANENTLY     YM02792*/ 03050000
*                THEN IF UCBMTPXP = YES/* RESIDENT,BUT IS     YM02792*/ 03051000
         TM    UCBPRES(@10),B'00000100'                         05S0871 03052000
         BNZ   @RF00871                                         05S0871 03053000
*                  THEN DO;            /*MULTIPLE EXPOSURE,   YM02792*/ 03054000
         TM    UCBMTPXP(@10),B'00001000'                        05S0872 03055000
         BNO   @RF00872                                         05S0872 03056000
*                    R852 = REASON9;   /*THEN THIS IS A       YM02792*/ 03057000
         MVC   R852(2),@CC02496                                 05S0874 03058000
*                                      /*NON-BASE EXPOSURE.   YM02792*/ 03059000
*                    ERROR = YES;                               05S0875 03060000
         OI    ERROR,B'00100000'                                05S0875 03061000
*                  END;                                         05S0876 03062000
*                  ELSE;                                    /*YM02792*/ 03063000
@RF00872 DS    0H                                               05S0878 03064000
*                ELSE DO;              /*IF DA, P/R,MULTI-   @YM02792*/ 03065000
         B     @RC00871                                         05S0878 03066000
@RF00871 DS    0H                                               05S0879 03067000
*                  IF UCBMTPXP = YES   /*EXPOSURE DEVICE UCB @YM02792*/ 03068000
*                    THEN IF UCBVOLI ^= ZEROVOLI/*WITH VOLSER@YM02792*/ 03069000
         L     @10,UCBPTR                                       05S0879 03070000
         TM    UCBMTPXP(@10),B'00001000'                        05S0879 03071000
         BNO   @RF00879                                         05S0879 03072000
*                      THEN DO;        /*DEVICE WAS ONLINE AT@YM02792*/ 03073000
         CLC   UCBVOLI(6,@10),ZEROVOLI                          05S0880 03074000
         BE    @RF00880                                         05S0880 03075000
*                        R852 = REASON10;/*IPL AND NOT       @YM02792*/ 03076000
         MVC   R852(2),@CC02498                                 05S0882 03077000
*                                      /*ELIGIBLE FOR MOUNT. @YM02792*/ 03078000
*                        ERROR = YES;                           05S0883 03079000
         OI    ERROR,B'00100000'                                05S0883 03080000
*                      END;                                     05S0884 03081000
*                      ELSE;                               /*@YM02792*/ 03082000
@RF00880 DS    0H                                               05S0886 03083000
*                    ELSE DO;          /* DA, P/R,DEMOUNTABLE@YM02792*/ 03084000
         B     @RC00879                                         05S0886 03085000
@RF00879 DS    0H                                               05S0887 03086000
*                      R852 = REASON3; /* DEVICE IS NOT      @YM02792*/ 03087000
         MVC   R852(2),@CC02484                                 05S0887 03088000
*                      ERROR = YES;    /* ELIGIBLE.FOR MOUNT.@YM02792*/ 03089000
         OI    ERROR,B'00100000'                                05S0888 03090000
*                    END;                                  /*@YM02792*/ 03091000
*                END;                                      /*@YM02792*/ 03092000
@RC00879 DS    0H                                               05S0891 03093000
*              IF ERROR = NO                               /*@YM02792*/ 03094000
*                THEN DO;                                  /*@YM02792*/ 03095000
@RC00871 TM    ERROR,B'00100000'                                05S0891 03096000
         BNZ   @RF00891                                         05S0891 03097000
*                  DO J = ONE TO SIX WHILE FOUND = NO;          05S0893 03098000
         LA    @10,1                                            05S0893 03099000
         STH   @10,J                                            05S0893 03100000
@DL00893 TM    FOUND,B'00000010'                                05S0893 03101000
         BNZ   @DC00893                                         05S0893 03102000
*                    IF UCBTBYT4 = UCBTYPE(J)                   05S0894 03103000
*                      THEN DO;        /* IF DEV TYPE IS SUPPORTED   */ 03104000
         L     @05,UCBPTR                                       05S0894 03105000
         LR    @15,@10                                          05S0894 03106000
         MH    @15,@CH01793                                     05S0894 03107000
         SLR   @14,@14                                          05S0894 03108000
         IC    @14,UCBTBYT4(,@05)                               05S0894 03109000
         LA    @01,UCBTYPE-14(@15)                              05S0894 03110000
         MVC   @ZT00003+3(1),0(@01)                             05S0894 03111000
         C     @14,@ZT00003                                     05S0894 03112000
         BNE   @RF00894                                         05S0894 03113000
*                        FOUND = YES;  /* SET SWITCH.                */ 03114000
         OI    FOUND,B'00000010'                                05S0896 03115000
*                        IF DEVCT(J) ^= ZERO                    05S0897 03116000
*                          THEN DO;    /* IF MORE OF THIS TYPE TO BE */ 03117000
         LH    @15,DEVCT-14(@15)                                05S0897 03118000
         LTR   @15,@15                                          05S0897 03119000
         BZ    @RF00897                                         05S0897 03120000
*                                      /* MOUNTED,                   */ 03121000
*                            K = J;    /* SAVE INDEX AND     @YM01529*/ 03122000
         STH   @10,K                                            05S0899 03123000
*                                      /* SEE IF THE UCB IS ONLINE.  */ 03124000
*/********************************************************************/ 03125000
*/*                                                                  */ 03126000
*/* SEGMENT NAME - CKONLINE                                          */ 03127000
*/*                                                                  */ 03128000
*/* DESCRIPTIVE NAME - CHECK UCB ONLINE STATUS                       */ 03129000
*/*                                                                  */ 03130000
*/* FUNCTION -                                                       */ 03131000
*/*                                                                  */ 03132000
*/*     THE UCB FOR EACH DEVICE ADDR IN THE REPLY IS CHECKED FOR     */ 03133000
*/*     ONLINE STATUS.  IF IT IS ONLINE, 'BADADDR' IS SET TO ZERO    */ 03134000
*/*     TO INDICATE THAT THE DEVICE IS VALID.  IF IT IS NOT ONLINE,  */ 03135000
*/*     THE ROUTINE THAT CHECKS FOR AN AVAILABLE DATA PATH TO THE    */ 03136000
*/*     DEVICE IS CALLED (IF IT IS LOADED).  IF THE RETURN CODE IS   */ 03137000
*/*     ZERO, 'BADADDR' IS SET TO ZERO TO INDICATE THAT THE DEVICE   */ 03138000
*/*     IS VALID.                                                    */ 03139000
*/*                                                                  */ 03140000
*/*     THE REASON CODE IN MESSAGE IEA852I IS SET WHEN:              */ 03141000
*/*         1. THE DATA PATH FIND ROUTINE IS NOT LOADED.             */ 03142000
*/*         2. THERE IS NO AVAILABLE DATA PATH TO THE DEVICE.        */ 03143000
*/*         3. THERE IS NO OPERATIONAL PATH TO THE DEVICE.           */ 03144000
*/*                                                                  */ 03145000
*/* ENTRY - IN-LINE SEGMENT                                          */ 03146000
*/*                                                                  */ 03147000
*/*     PURPOSE - SEE FUNCTION                                       */ 03148000
*/*                                                                  */ 03149000
*/*     INPUT DATA -                                                 */ 03150000
*/*                                                                  */ 03151000
*/*         THE UCB FOR THE DEVICE ADDRESS IN THE REPLY              */ 03152000
*/*                                                                  */ 03153000
*/* EXITS -                                                          */ 03154000
*/*                                                                  */ 03155000
*/*     CONDITION - THE UCB IS ONLINE OR A DATA PATH IS AVAILABLE    */ 03156000
*/*                 TO THE DEVICE                                    */ 03157000
*/*                                                                  */ 03158000
*/*     OUTPUT DATA -                                                */ 03159000
*/*                                                                  */ 03160000
*/*         BADADDR - SET TO ZERO                                    */ 03161000
*/*                                                                  */ 03162000
*/*     CONDITION - NO DATA PATH IS AVAILABLE                        */ 03163000
*/*                                                                  */ 03164000
*/*     OUTPUT DATA -                                                */ 03165000
*/*                                                                  */ 03166000
*/*         R852 - IS SET TO 7                                       */ 03167000
*/*                                                                  */ 03168000
*/*     CONDITION - THERE IS NO OPERATIONAL PATH TO THE DEVICE       */ 03169000
*/*                                                                  */ 03170000
*/*     OUTPUT DATA -                                                */ 03171000
*/*                                                                  */ 03172000
*/*         R852 - IS SET TO 8                                       */ 03173000
*/*                                                                  */ 03174000
*/*     CONDITION - THE ROUTINE THAT CHECKS FOR A DATA PATH IS NOT   */ 03175000
*/*                 LOADED                                           */ 03176000
*/*                                                                  */ 03177000
*/*     OUTPUT DATA -                                                */ 03178000
*/*                                                                  */ 03179000
*/*         R852 - IS SET TO 6                                       */ 03180000
*/*                                                                  */ 03181000
*/*     RETURN CODE - NONE                                           */ 03182000
*/*                                                                  */ 03183000
*/********************************************************************/ 03184000
*                                                               06S0900 03185000
*IF UCBONLI ^= YES                                              06S0900 03186000
*  THEN DO;                            /* IF THE UCB IS OFFLINE, AND */ 03187000
         TM    UCBONLI(@05),B'10000000'                         06S0900 03188000
         BO    @RF00900                                         06S0900 03189000
*    IF DPLOADED = YES                 /* THE DATA PATH ROUTINE IS   */ 03190000
*      THEN DO;                        /* LOADED, THEN EXECUTE RTN.  */ 03191000
         TM    DPLOADED,B'01000000'                             06S0902 03192000
         BNO   @RF00902                                         06S0902 03193000
*        RFY (RPARM) RSTD;                                      06S0904 03194000
*        DPPLIST = ADDR(DPPARM);       /* SET PARAMETER LIST         */ 03195000
         LA    @10,DPPARM                                       06S0905 03196000
         ST    @10,DPPLIST                                      06S0905 03197000
*        RPARM = ADDR(DPPLIST);        /* PASS PARM LIST ADDR IN R1. */ 03198000
         LA    RPARM,DPPLIST                                    06S0906 03199000
*        DPUCB = UCBPTR;               /* PUT UCB ADDR IN PARM LIST. */ 03200000
         ST    @05,DPUCB                                        06S0907 03201000
*        RFY (RCODE) RSTD;                                      06S0908 03202000
*        RCODE = DATAPATH;             /* IS DATA PATH AVAIL TO DEV? */ 03203000
         L     RCODE,DATAPATH                                   06S0909 03204000
*        GEN SETS(RCODE,REXIT) (BALR REXIT,RCODE);              06S0910 03205000
         BALR REXIT,RCODE                                               03206000
*        RFY (RPARM) UNRSTD;                                    06S0911 03207000
*        IF RCODE = ZERO               /* IF RETURN CODE IS ZERO,    */ 03208000
*          THEN BADADDR = ZEROADDR;    /* PATH IS AVAIL, RESET ERROR */ 03209000
         LTR   RCODE,RCODE                                      06S0912 03210000
         BNZ   @RF00912                                         06S0912 03211000
         MVC   BADADDR(3),ZEROADDR                              06S0913 03212000
*          ELSE IF RCODE > FOUR        /* INDIC.; IF > 4 NO OPERA-   */ 03213000
*            THEN R852 = REASON8;      /* TIONAL PATH; IF 4 NO DATA  */ 03214000
         B     @RC00912                                         06S0914 03215000
@RF00912 CH    RCODE,@CH00036                                   06S0914 03216000
         BNH   @RF00914                                         06S0914 03217000
         MVC   R852(2),@CC02494                                 06S0915 03218000
*            ELSE R852 = REASON7;      /* PATH AVAIL.                */ 03219000
         B     @RC00914                                         06S0916 03220000
@RF00914 MVC   R852(2),@CC02492                                 06S0916 03221000
*        RFY RCODE UNRSTD;                                      06S0917 03222000
@RC00914 DS    0H                                               06S0917 03223000
@RC00912 DS    0H                                               06S0918 03224000
*      END;                                                     06S0918 03225000
*      ELSE R852 = REASON6;            /* DATA PATH RTN. NOT LOADED. */ 03226000
         B     @RC00902                                         06S0919 03227000
@RF00902 MVC   R852(2),@CC02490                                 06S0919 03228000
*  END;                                                         06S0920 03229000
*  ELSE BADADDR = ZEROADDR;            /* IF ONLINE, DEV IS VALID.   */ 03230000
         B     @RC00900                                         06S0921 03231000
@RF00900 MVC   BADADDR(3),ZEROADDR                              06S0921 03232000
*                                      /* RETURN TO UCBFIND.         */ 03233000
*                          END;        /* ELSE TOO MANY OF THIS TYPE */ 03234000
*                          ELSE R852 = REASON5; /* REPLIED.          */ 03235000
         B     @RC00897                                         05S0923 03236000
@RF00897 MVC   R852(2),@CC02488                                 05S0923 03237000
*                      END;                                     05S0924 03238000
@RC00897 DS    0H                                               05S0925 03239000
*                  END;                                         05S0925 03240000
@RF00894 LA    @10,1                                            05S0925 03241000
         AH    @10,J                                            05S0925 03242000
         STH   @10,J                                            05S0925 03243000
         CH    @10,@CH00075                                     05S0925 03244000
         BNH   @DL00893                                         05S0925 03245000
@DC00893 DS    0H                                               05S0926 03246000
*                  IF FOUND = NO       /* TYPE NOT NEEDED FOR MOUNT. */ 03247000
*                    THEN R852 = REASON5;                       05S0926 03248000
         TM    FOUND,B'00000010'                                05S0926 03249000
         BNZ   @RF00926                                         05S0926 03250000
         MVC   R852(2),@CC02488                                 05S0927 03251000
*                END;                                      /*@YM02792*/ 03252000
*            END;                                               05S0929 03253000
*            ELSE R852 = REASON3;      /* DEVICE IS RESERVED         */ 03254000
         B     @RC00869                                         05S0930 03255000
@RF00869 MVC   R852(2),@CC02484                                 05S0930 03256000
*          ELSE R852 = REASON11;       /* DEVICE IS VIRTUAL   Y30LPPD*/ 03257000
         B     @RC00868                                         05S0931 03258000
@RF00868 MVC   R852(2),@CC02500                                 05S0931 03259000
*        ELSE R852 = REASON4;          /* DEVICE NOT DIRECT ACCESS   */ 03260000
         B     @RC00867                                         05S0932 03261000
@RF00867 MVC   R852(2),@CC02486                                 05S0932 03262000
*    END;                                                       05S0933 03263000
*    ELSE R852 = REASON2;              /* REASON CODE - NO UCB       */ 03264000
         B     @RC00861                                         05S0934 03265000
@RF00861 MVC   R852(2),@CC02482                                 05S0934 03266000
*  IF BADADDR = ZEROADDR               /* IF UCB IS VALID, THEN      */ 03267000
*    THEN DEVCT(K) = (DEVCT(K) - ONE); /* DECRE. DEVS TO CK. @YM01529*/ 03268000
@RC00861 CLC   BADADDR(3),ZEROADDR                              05S0935 03269000
         BNE   @RF00935                                         05S0935 03270000
         LH    @10,K                                            05S0936 03271000
         MH    @10,@CH01793                                     05S0936 03272000
         LH    @05,DEVCT-14(@10)                                05S0936 03273000
         BCTR  @05,0                                            05S0936 03274000
         STH   @05,DEVCT-14(@10)                                05S0936 03275000
*    ELSE DO;                          /* ELSE SEND ERROR MSG TO     */ 03276000
         B     @RC00935                                         05S0937 03277000
@RF00935 DS    0H                                               05S0938 03278000
*                                      /* OPERATOR.                  */ 03279000
*/********************************************************************/ 03280000
*/*                                                                  */ 03281000
*/* SEGMENT NAME - REASON                                            */ 03282000
*/*                                                                  */ 03283000
*/* DESCRIPTIVE NAME - ISSUE INVALID DEVICE MESSAGE TO OPERATOR      */ 03284000
*/*                                                                  */ 03285000
*/* FUNCTION -                                                       */ 03286000
*/*                                                                  */ 03287000
*/*     'MSG2' SWITCH IS SET ON TO INDICATE THAT THE REPEAT REPLY    */ 03288000
*/*     MESSAGE IS TO BE ISSUED.  THE INVALID DEVICE ADDRESS IS      */ 03289000
*/*     MOVED INTO THE MESSAGE TEXT AND IEA852I IS ISSUED.           */ 03290000
*/*                                                                  */ 03291000
*/* ENTRY - IN-LINE SEGMENT                                          */ 03292000
*/*                                                                  */ 03293000
*/*     PURPOSE - SEE FUNCTION                                       */ 03294000
*/*                                                                  */ 03295000
*/*     INPUT DATA -                                                 */ 03296000
*/*                                                                  */ 03297000
*/*         BADADDR - CONTAINS THE INVALID DEVICE ADDRESS            */ 03298000
*/*                                                                  */ 03299000
*/* EXITS -                                                          */ 03300000
*/*                                                                  */ 03301000
*/*     CONDITION - NORMAL                                           */ 03302000
*/*                                                                  */ 03303000
*/*     OUTPUT DATA -                                                */ 03304000
*/*                                                                  */ 03305000
*/*         MESSAGE IEA852I IS ISSUED                                */ 03306000
*/*                                                                  */ 03307000
*/*     RETURN CODE - NONE                                           */ 03308000
*/*                                                                  */ 03309000
*/********************************************************************/ 03310000
*                                                               06S0938 03311000
*MSG2 = YES;                           /* INDIC. REPEAT REPLY MSG.   */ 03312000
         OI    MSG2,B'00001000'                                 06S0938 03313000
*DEV852 = BADADDR;                     /* PUT DEV ADDR IN MSG.       */ 03314000
         MVC   DEV852(3),BADADDR                                06S0939 03315000
*GEN REFS (NVTWTO);                    /* ISSUE ERROR MESSAGE.       */ 03316000
 IEAPMNIP TYPE=WTO,PARAM=IEA852I                                        03317000
*                                      /* RET TO UCBFIND OR CHECKDUP */ 03318000
*    END;                                                       05S0941 03319000
*END;                                  /* RETURN TO CHECKUCB.        */ 03320000
@RC00935 LA    @10,1                                            05S0942 03321000
         AH    @10,I                                            05S0942 03322000
@DE00855 STH   @10,I                                            05S0942 03323000
         CH    @10,TOMOUNT                                      05S0942 03324000
         BNH   @DL00855                                         05S0942 03325000
*END;                                                           04S0943 03326000
*IF TOMOUNT > ONE THEN                 /* IF MORE THAN ONE DEVICE;   */ 03327000
         LA    @10,1                                            04S0944 03328000
         CH    @10,TOMOUNT                                      04S0944 03329000
         BNL   @RF00944                                         04S0944 03330000
*  DO;                                                          04S0945 03331000
*    BADADDR = ZEROADDR;               /* RESET VALID DEVICE INDIC.  */ 03332000
         MVC   BADADDR(3),ZEROADDR                              04S0946 03333000
*    DO;                               /* CHECK FOR DUPLICATE DEVICE */ 03334000
*                                      /* IN REPLY.                  */ 03335000
*/********************************************************************/ 03336000
*/*                                                                  */ 03337000
*/* SEGMENT NAME - CHECKDUP                                          */ 03338000
*/*                                                                  */ 03339000
*/* DESCRIPTIVE NAME - CHECK FOR DUPLICATE DEVICE ADDRESS WITHIN     */ 03340000
*/*                    THE REPLY                                     */ 03341000
*/*                                                                  */ 03342000
*/* FUNCTION -                                                       */ 03343000
*/*                                                                  */ 03344000
*/*     ALL OF THE DEVICE ADDRESSES REPLIED ARE CHECKED FOR DUPLICA- */ 03345000
*/*     TION.  IF A DUPLICATE IS FOUND, IT IS PLACED IN 'BADADDR',   */ 03346000
*/*     AND THE REASON CODE IN MESSAGE TEXT IEA852I IS SET TO 1.     */ 03347000
*/*                                                                  */ 03348000
*/* ENTRY - IN-LINE SEGMENT                                          */ 03349000
*/*                                                                  */ 03350000
*/*     PURPOSE - SEE FUNCTION                                       */ 03351000
*/*                                                                  */ 03352000
*/*     INPUT DATA -                                                 */ 03353000
*/*                                                                  */ 03354000
*/*         REPLAREA - CONTAINS THE DEVICE REPLY                     */ 03355000
*/*         BADADDR - SET TO ZERO                                    */ 03356000
*/*         TOMOUNT - CONTAINS NUMBER OF DEVICES IN REPLY            */ 03357000
*/*                                                                  */ 03358000
*/* EXITS -                                                          */ 03359000
*/*                                                                  */ 03360000
*/*     CONDITION - NORMAL                                           */ 03361000
*/*                                                                  */ 03362000
*/*     OUTPUT DATA - NONE                                           */ 03363000
*/*                                                                  */ 03364000
*/*     CONDITION - DUPLICATE FOUND IN REPLY                         */ 03365000
*/*                                                                  */ 03366000
*/*     OUTPUT DATA -                                                */ 03367000
*/*                                                                  */ 03368000
*/*         BADADDR - CONTAINS THE INVALID ADDRESS                   */ 03369000
*/*         R852I - SET TO 1                                         */ 03370000
*/*                                                                  */ 03371000
*/*     RETURN CODE - NONE                                           */ 03372000
*/*                                                                  */ 03373000
*/********************************************************************/ 03374000
*                                                               05S0948 03375000
*DO CHECK = ONE TO (TOMOUNT - ONE);    /* CHECK EACH DEV WITH REMAIN-*/ 03376000
         B     @DE00948                                         05S0948 03377000
@DL00948 DS    0H                                               05S0949 03378000
*  DO SCAN = (CHECK + ONE) TO TOMOUNT; /* ING DEVS IN REPLY, TO SEE  */ 03379000
         AH    @10,@CH00042                                     05S0949 03380000
         B     @DE00949                                         05S0949 03381000
@DL00949 DS    0H                                               05S0950 03382000
*    IF UNIT(CHECK) = UNIT(SCAN)       /* IF A DUPLICATE IS FOUND.   */ 03383000
*      THEN DO;                        /* IF IT IS THEN              */ 03384000
         LH    @05,CHECK                                        05S0950 03385000
         SLA   @05,2                                            05S0950 03386000
         SLA   @10,2                                            05S0950 03387000
         LA    @01,UNIT-4(@05)                                  05S0950 03388000
         LA    @05,UNIT-4(@10)                                  05S0950 03389000
         CLC   0(3,@01),0(@05)                                  05S0950 03390000
         BNE   @RF00950                                         05S0950 03391000
*        BADADDR = UNIT(SCAN);         /* SAVE THE INVALID DEV ADDR  */ 03392000
         LA    @05,UNIT-4(@10)                                  05S0952 03393000
         MVC   BADADDR(3),0(@05)                                05S0952 03394000
*        R852 = REASON1;               /* AND SET REASON CODE.       */ 03395000
         MVC   R852(2),@CC02480                                 05S0953 03396000
*        DO;                           /* SEND MSG TO OPERATOR.      */ 03397000
*/********************************************************************/ 03398000
*/*                                                                  */ 03399000
*/* SEGMENT NAME - REASON                                            */ 03400000
*/*                                                                  */ 03401000
*/* DESCRIPTIVE NAME - ISSUE INVALID DEVICE MESSAGE TO OPERATOR      */ 03402000
*/*                                                                  */ 03403000
*/* FUNCTION -                                                       */ 03404000
*/*                                                                  */ 03405000
*/*     'MSG2' SWITCH IS SET ON TO INDICATE THAT THE REPEAT REPLY    */ 03406000
*/*     MESSAGE IS TO BE ISSUED.  THE INVALID DEVICE ADDRESS IS      */ 03407000
*/*     MOVED INTO THE MESSAGE TEXT AND IEA852I IS ISSUED.           */ 03408000
*/*                                                                  */ 03409000
*/* ENTRY - IN-LINE SEGMENT                                          */ 03410000
*/*                                                                  */ 03411000
*/*     PURPOSE - SEE FUNCTION                                       */ 03412000
*/*                                                                  */ 03413000
*/*     INPUT DATA -                                                 */ 03414000
*/*                                                                  */ 03415000
*/*         BADADDR - CONTAINS THE INVALID DEVICE ADDRESS            */ 03416000
*/*                                                                  */ 03417000
*/* EXITS -                                                          */ 03418000
*/*                                                                  */ 03419000
*/*     CONDITION - NORMAL                                           */ 03420000
*/*                                                                  */ 03421000
*/*     OUTPUT DATA -                                                */ 03422000
*/*                                                                  */ 03423000
*/*         MESSAGE IEA852I IS ISSUED                                */ 03424000
*/*                                                                  */ 03425000
*/*     RETURN CODE - NONE                                           */ 03426000
*/*                                                                  */ 03427000
*/********************************************************************/ 03428000
*                                                               06S0955 03429000
*MSG2 = YES;                           /* INDIC. REPEAT REPLY MSG.   */ 03430000
         OI    MSG2,B'00001000'                                 06S0955 03431000
*DEV852 = BADADDR;                     /* PUT DEV ADDR IN MSG.       */ 03432000
         MVC   DEV852(3),BADADDR                                06S0956 03433000
*GEN REFS (NVTWTO);                    /* ISSUE ERROR MESSAGE.       */ 03434000
 IEAPMNIP TYPE=WTO,PARAM=IEA852I                                        03435000
*                                      /* RET TO UCBFIND OR CHECKDUP */ 03436000
*        END;                                                   05S0958 03437000
*      END;                                                     05S0959 03438000
*  END;                                                         05S0960 03439000
@RF00950 LA    @10,1                                            05S0960 03440000
         AH    @10,SCAN                                         05S0960 03441000
@DE00949 STH   @10,SCAN                                         05S0960 03442000
         CH    @10,TOMOUNT                                      05S0960 03443000
         BNH   @DL00949                                         05S0960 03444000
*END;                                                           05S0961 03445000
         LA    @10,1                                            05S0961 03446000
         AH    @10,CHECK                                        05S0961 03447000
@DE00948 STH   @10,CHECK                                        05S0961 03448000
         LH    @05,TOMOUNT                                      05S0961 03449000
         BCTR  @05,0                                            05S0961 03450000
         CR    @10,@05                                          05S0961 03451000
         BNH   @DL00948                                         05S0961 03452000
*                                      /* RETURN TO CHECKUCB.        */ 03453000
*    END;                                                       04S0962 03454000
*  END;                                                         04S0963 03455000
*IF MSG2 = NO                          /* IF UCBS ARE VALID AND      */ 03456000
*  THEN DO;                            /* THERE ARE NO DUPS IN REPLY */ 03457000
@RF00944 TM    MSG2,B'00001000'                                 04S0964 03458000
         BNZ   @RF00964                                         04S0964 03459000
*    GOODLIST = YES;                   /* THEN SET VALID REPLY INDIC */ 03460000
*    NODEV = YES;                      /* AND TERM. REPLY PROCESSING.*/ 03461000
         OI    GOODLIST,B'00010100'                             04S0967 03462000
*  END;                                                         04S0968 03463000
*  ELSE DO;                            /* IF ERROR WAS FOUND,        */ 03464000
         B     @RC00964                                         04S0969 03465000
@RF00964 DS    0H                                               04S0970 03466000
*    DO I = SIX TO ONE BY - ONE;                                04S0970 03467000
         LA    @10,6                                            04S0970 03468000
         STH   @10,I                                            04S0970 03469000
@DL00970 DS    0H                                               04S0971 03470000
*      DEVCT(I) = AUXCT(I);            /* RESET DEV TYPE COUNTERS.   */ 03471000
         LR    @05,@10                                          04S0971 03472000
         MH    @05,@CH01793                                     04S0971 03473000
         LH    @15,AUXCT-14(@05)                                04S0971 03474000
         STH   @15,DEVCT-14(@05)                                04S0971 03475000
*    END;                                                       04S0972 03476000
         BCTR  @10,0                                            04S0972 03477000
         STH   @10,I                                            04S0972 03478000
         LTR   @10,@10                                          04S0972 03479000
         BP    @DL00970                                         04S0972 03480000
*    GEN REFS (NVTWTOR);               /* ISSUE REPEAT REPLY MSG.    */ 03481000
     IEAPMNIP TYPE=WTOR,PARAM=IEA852A                                   03482000
*  END;                                                         04S0974 03483000
*                                      /* RETURN TO DEVREPLY.        */ 03484000
*  END;                                                         03S0975 03485000
@RC00964 DS    0H                                               03S0976 03486000
*                                      /* RETURN TO CKREPLY.         */ 03487000
*  END;                                                         02S0976 03488000
@RC00849 DS    0H                                               02S0977 03489000
*                                      /* RETURN TO TOP SEGMENT.     */ 03490000
*    END;                                                       01S0977 03491000
@RC00817 DS    0H                                               01S0977 03492000
@DE00816 TM    NODEV,B'00010000'                                01S0977 03493000
         BZ    @DL00816                                         01S0977 03494000
*    IF GOODLIST = YES                 /* IF THE OPERATOR REPLY IS   */ 03495000
*      THEN DO;                        /* VALID,                     */ 03496000
         TM    GOODLIST,B'00000100'                             01S0978 03497000
         BNO   @RF00978                                         01S0978 03498000
*        DO;                           /* PREPARE FOR VOL MOUNTING   */ 03499000
*/********************************************************************/ 03500000
*/*                                                                  */ 03501000
*/* SEGMENT NAME - RDYUCB                                            */ 03502000
*/*                                                                  */ 03503000
*/* DESCRIPTIVE NAME - PREPARE THE UCB'S TO RECEIVE VOLUMES          */ 03504000
*/*                                                                  */ 03505000
*/* FUNCTION -                                                       */ 03506000
*/*                                                                  */ 03507000
*/*     THE UCBFN MACRO IS ISSUED FOR EACH DEVICE IN THE REPLY TO    */ 03508000
*/*     FIND THE CORRESPONDING UCB ADDRESS.  THE DEVICE ADDRESS AND  */ 03509000
*/*     UCB ADDRESS ARE PLACED IN 'DEVTABLE'.  THE VOLUME SERIAL IS  */ 03510000
*/*     CLEARED IN THE UCB, THE TAG AND NOT-READY BITS ARE TURNED    */ 03511000
*/*     ON, AND THE NUMBER OF ENTRIES IN 'DEVTABLE' IS SAVED IN      */ 03512000
*/*     'TABLECT'.                                                   */ 03513000
*/*                                                                  */ 03514000
*/* ENTRY - IN-LINE SEGMENT                                          */ 03515000
*/*                                                                  */ 03516000
*/*     PURPOSE - SEE FUNCTION                                       */ 03517000
*/*                                                                  */ 03518000
*/*     INPUT DATA -                                                 */ 03519000
*/*                                                                  */ 03520000
*/*         REPLAREA - CONTAINS THE DEVICE ADDRESS REPLY             */ 03521000
*/*         TOMOUNT - CONTAINS THE NUMBER OF DEVICES ON WHICH        */ 03522000
*/*                   VOLUMES ARE TO BE MOUNTED                      */ 03523000
*/*                                                                  */ 03524000
*/* EXITS -                                                          */ 03525000
*/*                                                                  */ 03526000
*/*     CONDITION - NORMAL                                           */ 03527000
*/*                                                                  */ 03528000
*/*     OUTPUT DATA -                                                */ 03529000
*/*                                                                  */ 03530000
*/*         UCB FIELDS ARE SET FOR VOLUME MOUNTING                   */ 03531000
*/*         DEVTABLE IS BUILT                                        */ 03532000
*/*         TABLECT - NUMBER OF ENTRIES IN DEVTABLE                  */ 03533000
*/*                                                                  */ 03534000
*/*     RETURN CODE - NONE                                           */ 03535000
*/*                                                                  */ 03536000
*/********************************************************************/ 03537000
*                                                               02S0981 03538000
*RFY NWTORLST BASED(ADDR(IEA8602));                             02S0981 03539000
*DO I = ONE TO TOMOUNT;                /* FOR EACH DEVICE IN THE     */ 03540000
         LA    @10,1                                            02S0982 03541000
         B     @DE00982                                         02S0982 03542000
@DL00982 DS    0H                                               02S0983 03543000
*  FINDDEV = UNIT(I);                  /* REPLY, FIND THE CORRESPOND-*/ 03544000
         SLA   @10,2                                            02S0983 03545000
         LA    @05,UNIT-4(@10)                                  02S0983 03546000
         MVC   FINDDEV(3),0(@05)                                02S0983 03547000
*  RFY (RPARM) RSTD;                   /* ING UCB ADDRESS.           */ 03548000
*  RPARM = FINDADDR;                                            02S0985 03549000
         L     RPARM,FINDADDR                                   02S0985 03550000
*  GEN REFS(NVTUCBFN) (IEAPMNIP TYPE=UCBFN,PARAM=RPARM);        02S0986 03551000
         IEAPMNIP TYPE=UCBFN,PARAM=RPARM                                03552000
*  UCBPTR = RPARM;                                              02S0987 03553000
         ST    RPARM,UCBPTR                                     02S0987 03554000
*  RFY (RPARM) UNRSTD;                                          02S0988 03555000
*  UCBVOLI = ZEROVOLI;                 /* CLEAR THE VOL SER IN UCB.  */ 03556000
         L     @10,UCBPTR                                       02S0989 03557000
         MVC   UCBVOLI(6,@10),ZEROVOLI                          02S0989 03558000
*  UCBVTOC = ZEROVTOC;                 /* CLEAR VTOC TTR             */ 03559000
         MVC   UCBVTOC(4,@10),ZEROVTOC                          02S0990 03560000
*  UCBPRSRS = YES;                     /* TURN ON TAG BIT.           */ 03561000
         OI    UCBPRSRS(@10),B'00100000'                        02S0991 03562000
*  UCBNOTRD = YES;                     /* TURN ON NOT-READY BIT.     */ 03563000
         OI    UCBNOTRD(@10),B'01000000'                        02S0992 03564000
*  DEVICE(I) = UNIT(I);                /* BUILD THE DEVTABLE: DEVICE */ 03565000
         LH    @05,I                                            02S0993 03566000
         LR    @15,@05                                          02S0993 03567000
         SLA   @15,3                                            02S0993 03568000
         LA    @14,DEVICE-8(@15)                                02S0993 03569000
         LR    @07,@05                                          02S0993 03570000
         SLA   @07,2                                            02S0993 03571000
         LA    @06,UNIT-4(@07)                                  02S0993 03572000
         MVC   0(3,@14),0(@06)                                  02S0993 03573000
*  UCBADDR(I) = UCBPTR;                /* PLUS UCB ADDRESS.          */ 03574000
         ST    @10,UCBADDR-8(@15)                               02S0994 03575000
*END;                                                           02S0995 03576000
         AH    @05,@CH00042                                     02S0995 03577000
         LR    @10,@05                                          02S0995 03578000
@DE00982 STH   @10,I                                            02S0995 03579000
         CH    @10,TOMOUNT                                      02S0995 03580000
         BNH   @DL00982                                         02S0995 03581000
*TABLECT = TOMOUNT;                    /* SAVE NBR. TABLE ENTRIES.   */ 03582000
*                                                               02S0996 03583000
         MVC   TABLECT(2),TOMOUNT                               02S0996 03584000
*IF EXCPSW = OFF                       /*SET UP EXCP IF NOT  @Y30LPPD*/ 03585000
*  THEN CALL EXCPSETP;                 /*DONE ALREADY        @Y30LPPD*/ 03586000
         TM    EXCPSW,B'00100000'                               02S0997 03587000
         BNZ   @RF00997                                         02S0997 03588000
         BAL   @14,EXCPSETP                                     02S0998 03589000
*        END;                                                   01S0999 03590000
@RF00997 DS    0H                                               01S1000 03591000
*        DO;                           /* ISSUE READY DEV MESSAGES.  */ 03592000
*/********************************************************************/ 03593000
*/*                                                                  */ 03594000
*/* SEGMENT NAME - WTORMT                                            */ 03595000
*/*                                                                  */ 03596000
*/* DESCRIPTIVE NAME - ISSUE MESSAGE FOR DEVICES TO BE READIED       */ 03597000
*/*                                                                  */ 03598000
*/* FUNCTION -                                                       */ 03599000
*/*                                                                  */ 03600000
*/*     SET 'DEVMTCT' EQUAL TO 'TOMOUNT'.  MOVE DEVICE ADDRESSES     */ 03601000
*/*     FROM 'DEVTABLE' TO  MESSAGE TEXT.  ISSUE MESSAGE 'DDD,DDD,...*/ 03602000
*/*     IEA860A REPLY U WHEN ALL DEVICES ARE READY.',        @YM02783*/ 03603000
*/*     IF REPLY IS NOT U OR EOB, REPEAT MESSAGE.                    */ 03604000
*/*                                                                  */ 03605000
*/* ENTRY - IN-LINE SEGMENT                                          */ 03606000
*/*                                                                  */ 03607000
*/*     PURPOSE - SEE FUNCTION                                       */ 03608000
*/*                                                                  */ 03609000
*/*     INPUT DATA -                                                 */ 03610000
*/*                                                                  */ 03611000
*/*         DEVTABLE - CONTAINS DEVICE ADDRESSES FROM REPLY          */ 03612000
*/*         TOMOUNT - NUMBER OF VOLS TO BE MOUNTED                   */ 03613000
*/*                                                                  */ 03614000
*/* EXITS -                                                          */ 03615000
*/*                                                                  */ 03616000
*/*     CONDITION - NORMAL                                           */ 03617000
*/*                                                                  */ 03618000
*/*     OUTPUT DATA -                                                */ 03619000
*/*                                                                  */ 03620000
*/*         MESSAGE IEA860A                                          */ 03621000
*/*         DEVMTCT - SET TO VALUE OF TOMOUNT                        */ 03622000
*/*                                                                  */ 03623000
*/*     RETURN CODE - NONE                                           */ 03624000
*/*                                                                  */ 03625000
*/********************************************************************/ 03626000
*                                                               02S1001 03627000
*DEVMTCT = TOMOUNT;                    /*INIT LOOP CONTROL COUNTER   */ 03628000
*                                                               02S1001 03629000
         MVC   DEVMTCT(2),TOMOUNT                               02S1001 03630000
*DEV860 = BLANK;                       /*BLANK OUT MESSAGE AREA      */ 03631000
*                                                               02S1002 03632000
         MVI   DEV860+1,C' '                                    02S1002 03633000
         MVC   DEV860+2(78),DEV860+1                            02S1002 03634000
         MVI   DEV860,C' '                                      02S1002 03635000
*I = ZERO;                             /*INDEX THROUGH MESSAGE AREA  */ 03636000
         SLR   @10,@10                                          02S1003 03637000
         STH   @10,I                                            02S1003 03638000
*DO DEVIND = ONE TO TABLECT;           /*LOOP THROUGH DEVTABLE       */ 03639000
         LA    @10,1                                            02S1004 03640000
         B     @DE01004                                         02S1004 03641000
@DL01004 DS    0H                                               02S1005 03642000
*      I = I + ONE;                                             02S1005 03643000
         LA    @05,1                                            02S1005 03644000
         AH    @05,I                                            02S1005 03645000
         STH   @05,I                                            02S1005 03646000
*      UNITAD(I) = DEVICE(DEVIND);     /*MOVE ENTRY INTO MESSAGE AREA*/ 03647000
         SLA   @05,2                                            02S1006 03648000
         LA    @15,DEV860                                       02S1006 03649000
         ALR   @15,@05                                          02S1006 03650000
         AL    @15,@CF02680                                     02S1006 03651000
         LR    @05,@10                                          02S1006 03652000
         SLA   @05,3                                            02S1006 03653000
         LA    @14,DEVICE-8(@05)                                02S1006 03654000
         MVC   UNITAD(3,@15),0(@14)                             02S1006 03655000
*END;                                                           02S1007 03656000
         AH    @10,@CH00042                                     02S1007 03657000
@DE01004 STH   @10,DEVIND                                       02S1007 03658000
         CH    @10,TABLECT                                      02S1007 03659000
         BNH   @DL01004                                         02S1007 03660000
*IF I > ONE THEN                       /*IF THERE IS MORE THAN ONE      03661000
*                                        DEVICE IN MESSAGE AREA THEN */ 03662000
         LA    @10,1                                            02S1008 03663000
         CH    @10,I                                            02S1008 03664000
         BNL   @RF01008                                         02S1008 03665000
*  DO J= ONE TO (I-ONE);                                        02S1009 03666000
         B     @DE01009                                         02S1009 03667000
@DL01009 DS    0H                                               02S1010 03668000
*    COM(J) = COMMA;                   /*INSERT COMMAS               */ 03669000
         LR    @05,@10                                          02S1010 03670000
         SLA   @05,2                                            02S1010 03671000
         LA    @15,DEV860                                       02S1010 03672000
         ALR   @15,@05                                          02S1010 03673000
         BCTR  @15,0                                            02S1010 03674000
         MVI   COM-3(@15),C','                                  02S1010 03675000
*  END;                                                         02S1011 03676000
*                                                               02S1011 03677000
         AH    @10,@CH00042                                     02S1011 03678000
@DE01009 STH   @10,J                                            02S1011 03679000
         LH    @05,I                                            02S1011 03680000
         BCTR  @05,0                                            02S1011 03681000
         CR    @10,@05                                          02S1011 03682000
         BNH   @DL01009                                         02S1011 03683000
*BADREPLY=YES;                                             /*@YM02783*/ 03684000
@RF01008 OI    BADREPLY,B'10000000'                             02S1012 03685000
*DO WHILE BADREPLY = YES;              /*REPLY LOOP FOR      @YM02783*/ 03686000
         B     @DE01013                                         02S1013 03687000
@DL01013 DS    0H                                               02S1014 03688000
*  BADREPLY = NO;                      /*IEA860A             @YM02783*/ 03689000
         NI    BADREPLY,B'01111111'                             02S1014 03690000
*  GEN REFS(NVTWTO,NVTWTOR);           /*ISSUE MESSAGE               */ 03691000
*        DDD,DDD,...                                                    03692000
         IEAPMNIP TYPE=WTO,PARAM=IEA860A                                03693000
*        IEA860A REPLY U WHEN ALL DEVICES ARE READY.           @YM02783 03694000
         IEAPMNIP TYPE=WTOR,PARAM=IEA8602                               03695000
*  IF SCAN2^=REPLYU & SCAN2^=REPLYEOB  /*CHECK FOR REPLY     @YM02783*/ 03696000
*    THEN BADREPLY=YES;                /*OF U OR EOB         @YM02783*/ 03697000
         CLC   SCAN2(2),@CC00168                                02S1016 03698000
         BE    @RF01016                                         02S1016 03699000
         CLC   SCAN2(2),@CC00170                                02S1016 03700000
         BE    @RF01016                                         02S1016 03701000
         OI    BADREPLY,B'10000000'                             02S1017 03702000
*END;                                                      /*@YM02783*/ 03703000
@RF01016 DS    0H                                               02S1018 03704000
@DE01013 TM    BADREPLY,B'10000000'                             02S1018 03705000
         BO    @DL01013                                         02S1018 03706000
*        END;                                                   01S1019 03707000
*        DO WHILE DEVMTCT > ZERO;      /* PROCESS READIED VOLUMES.   */ 03708000
         B     @DE01020                                         01S1020 03709000
@DL01020 DS    0H                                               01S1021 03710000
*/********************************************************************/ 03711000
*/*                                                                  */ 03712000
*/* SEGMENT NAME - TESTRDY                                           */ 03713000
*/*                                                                  */ 03714000
*/* DESCRIPTIVE NAME - SCAN FOR READY UCB'S                          */ 03715000
*/*                                                                  */ 03716000
*/* FUNCTION -                                                       */ 03717000
*/*                                                                  */ 03718000
*/*     IF THE UCB RETURNED BY IEFSCAN IS READY, AND THE VOLUME      */ 03719000
*/*     SERIAL FIELD IS ZERO,  THE EXCP TO READ THE VOLUME SERIAL    */ 03720000
*/*     IS SET UP AND THE SEGMENT THAT ISSUES THE EXCP IS EXECUTED.  */ 03721000
*/*                                                                  */ 03722000
*/*     WHEN A COMPLETE SCAN OF THE UCB'S HAS BEEN MADE, 'DEVMTCT'   */ 03723000
*/*     IS UPDATED TO THE VALUE IN 'TOMOUNT'.MESSAGE IEA893A @YM02783*/ 03724000
*/*     IS ISSUED AND THE REPLY IS EXAMINED. IF THE REPLY IS @YM02783*/ 03725000
*/*     NO,THEN SCANNING OF UCB'S TERMINATES AND VAP         @YM02783*/ 03726000
*/*     PREPARES TO EXIT.IF THE REPLY IS U OR EOB,           @YM02783*/ 03727000
*/*     THEN THE VOLUMES LISTED IN THE MESSAGE ARE READY AND @YM02783*/ 03728000
*/*     VAP SCANS THE UCB'S AGAIN.IF THE REPLY IS INVALID,   @YM02783*/ 03729000
*/*     MESSAGE IEA893A IS REISSUED.                         @YM02783*/ 03730000
*/*                                                                  */ 03731000
*/* ENTRY - IN-LINE SEGMENT                                          */ 03732000
*/*                                                                  */ 03733000
*/*     PURPOSE - SEE FUNCTION                                       */ 03734000
*/*                                                                  */ 03735000
*/*     INPUT DATA - NONE                                            */ 03736000
*/*                                                                  */ 03737000
*/* EXITS -                                                          */ 03738000
*/*                                                                  */ 03739000
*/*     CONDITION - NORMAL                                           */ 03740000
*/*                                                                  */ 03741000
*/*     OUTPUT DATA -                                                */ 03742000
*/*                                                                  */ 03743000
*/*         EXCP - SET UP TO READ IF UCB IS READY AND VOLUME         */ 03744000
*/*                SERIAL FIELD IS ZERO                              */ 03745000
*/*         DEVMTCT - UPDATED                                        */ 03746000
*/*         MESSAGE IEA893A                                          */ 03747000
*/*                                                                  */ 03748000
*/*     RETURN CODE - NONE                                           */ 03749000
*/*                                                                  */ 03750000
*/********************************************************************/ 03751000
*RFY RPARM RSTD;                                                02S1021 03752000
*RPARM = LUTSAVE;                      /*MOVE LUT ADDR INTO PARM REG */ 03753000
         L     RPARM,LUTSAVE                                    02S1022 03754000
*CALL IEFSCAN;                         /*OBTAIN UCB ADDRESS          */ 03755000
         L     @15,@CV00229                                     02S1023 03756000
         BALR  @14,@15                                          02S1023 03757000
*UCBPTR= RPARM;                        /*SAVE ADDRESS OF UCB         */ 03758000
         ST    RPARM,UCBPTR                                     02S1024 03759000
*RFY RPARM UNRSTD;                                              02S1025 03760000
*                                                               02S1025 03761000
*DO WHILE (UCBPTR^= ZERO);             /*PROCESS UCBS - ZERO UCB ADDR   03762000
*                                        INDICATES END OF UCBS       */ 03763000
         B     @DE01026                                         02S1026 03764000
@DL01026 DS    0H                                               02S1027 03765000
*  IF UCB3DACC = YES &                 /*IF UCB IS DIRECT ACCESS,    */ 03766000
*    UCBNOTRD = NO &                   /*AND IS READY, AND HAS       */ 03767000
*    UCBVOLI = ZEROVOLI                /*ZERO VOL SER NUMBER,        */ 03768000
*    THEN DO;                          /*AND IS NOT A MULTIPLE       */ 03769000
         L     @10,UCBPTR                                       02S1027 03770000
         TM    UCB3DACC(@10),B'00100000'                        02S1027 03771000
         BNO   @RF01027                                         02S1027 03772000
         TM    UCBNOTRD(@10),B'01000000'                        02S1027 03773000
         BNZ   @RF01027                                         02S1027 03774000
         CLC   UCBVOLI(6,@10),ZEROVOLI                          02S1027 03775000
         BNE   @RF01027                                         02S1027 03776000
*      IF UCBMTPXP = NO | (UCBBASE + ADJBASE) = UCBPTR     /*@YM02792*/ 03777000
*        THEN DO;                      /*EXPOSURE DEVICE, OR @YM02792*/ 03778000
         TM    UCBMTPXP(@10),B'00001000'                        02S1029 03779000
         BZ    @RT01029                                         02S1029 03780000
         LA    @05,512                                          02S1029 03781000
         AL    @05,UCBBASE(,@10)                                02S1029 03782000
         CR    @05,@10                                          02S1029 03783000
         BNE   @RF01029                                         02S1029 03784000
@RT01029 DS    0H                                               02S1030 03785000
*                                      /*IS THE              @YM02792*/ 03786000
*                                      /*BASE EXPOSURE, THEN @YM02792*/ 03787000
*                                      /*SET UP FOR EXCP:            */ 03788000
*          DEBUCBA = UCBPTR;           /*UCB ADDRESS                 */ 03789000
         L     @10,DEBDAPTR                                     02S1031 03790000
         MVC   DEBUCBA(3,@10),UCBPTR+1                          02S1031 03791000
*          ECB = ZERO;                 /*CLEAR ECB                   */ 03792000
         SLR   @10,@10                                          02S1032 03793000
         L     @05,ECBPTR                                       02S1032 03794000
         ST    @10,ECB(,@05)                                    02S1032 03795000
*          LABELBUF = BLANK;           /*CLEAR LABEL READ AREA.      */ 03796000
         MVI   LABELBUF+1,C' '                                  02S1033 03797000
         MVC   LABELBUF+2(78),LABELBUF+1                        02S1033 03798000
         MVI   LABELBUF,C' '                                    02S1033 03799000
*                                      /*READ VOLUME LABEL           */ 03800000
*/********************************************************************/ 03801000
*/*                                                                  */ 03802000
*/* SEGMENT NAME - READSER                                           */ 03803000
*/*                                                                  */ 03804000
*/* DESCRIPTIVE NAME - READ SERIAL OF THE VOLUME MOUNTED             */ 03805000
*/*                                                                  */ 03806000
*/* FUNCTION -                                                       */ 03807000
*/*                                                                  */ 03808000
*/*     THE MESSAGE INDICATOR 'ERRMSG' IS INITIALIZED TO ZERO, AND   */ 03809000
*/*     AN EXCP IS ISSUED TO READ THE SERIAL OF THE VOLUME MOUNTED.  */ 03810000
*/*     IF AN I/O ERROR OCCURS, THE NOT-READY BIT IN THE UCB IS      */ 03811000
*/*     TURNED ON AND 'ERRMSG' IS SET TO 1.  IF THE READ IS SUCCESS- */ 03812000
*/*     FUL, THE VOLUME SERIAL IS CHECKED FOR DUPLICATION.  IF THE   */ 03813000
*/*     VOLUME SERIAL IS FOUND TO BE ALREADY MOUNTED, THE NOT-READY  */ 03814000
*/*     BIT IS TURNED ON IN THE UCB AND 'ERRMSG' IS SET TO 2.  IF    */ 03815000
*/*     THE VOLUME SERIAL IS NOT A DUPLICATE, THE SEGMENT WHICH      */ 03816000
*/*     CHECKS FOR THE VOLUME SERIAL IN THE MOUNT LIST IS EXECUTED.  */ 03817000
*/*                                                                  */ 03818000
*/*     IF THE NOT-READY BIT HAS NOT BEEN TURNED ON IN THE UCB, THE  */ 03819000
*/*     VOLUME SERIAL AND THE TTR ARE MOVED IN.                      */ 03820000
*/*                                                                  */ 03821000
*/*     IF 'ERRMSG' HAS BEEN SET, THE SEGMENT THAT HANDLES THE ERROR */ 03822000
*/*     PROCESSING IS EXECUTED.                                      */ 03823000
*/*                                                                  */ 03824000
*/* ENTRY - IN-LINE SEGMENT                                          */ 03825000
*/*                                                                  */ 03826000
*/*     PURPOSE - SEE FUNCTION                                       */ 03827000
*/*                                                                  */ 03828000
*/*     INPUT DATA -                                                 */ 03829000
*/*                                                                  */ 03830000
*/*         EXCP - SET UP TO READ                                    */ 03831000
*/*                                                                  */ 03832000
*/* EXITS -                                                          */ 03833000
*/*                                                                  */ 03834000
*/*     CONDITION - NORMAL                                           */ 03835000
*/*                                                                  */ 03836000
*/*     OUTPUT DATA -                                                */ 03837000
*/*                                                                  */ 03838000
*/*         UCB - UPDATED                                            */ 03839000
*/*                                                                  */ 03840000
*/*     CONDITION - I/O ERROR READING VOLUME SERIAL                  */ 03841000
*/*                                                                  */ 03842000
*/*     OUTPUT DATA -                                                */ 03843000
*/*                                                                  */ 03844000
*/*         UCB - UPDATED                                            */ 03845000
*/*         ERRMSG - SET TO 1                                        */ 03846000
*/*                                                                  */ 03847000
*/*     CONDITION - DUPLICATE VOLUME                                 */ 03848000
*/*                                                                  */ 03849000
*/*     OUTPUT DATA -                                                */ 03850000
*/*                                                                  */ 03851000
*/*         UCB - UPDATED                                            */ 03852000
*/*         ERRMSG - SET TO 2                                        */ 03853000
*/*                                                                  */ 03854000
*/*     RETURN CODE - NONE                                           */ 03855000
*/*                                                                  */ 03856000
*/********************************************************************/ 03857000
*                                                               03S1034 03858000
*ERRMSG = ZERO;                        /*INITIALIZE ERROR INDICATOR  */ 03859000
         ST    @10,ERRMSG                                       03S1034 03860000
*RFY RPARM RSTD;                                                03S1035 03861000
*RPARM = IOBSTPTR;                     /*ADDRESS OF IOB              */ 03862000
         L     RPARM,IOBSTPTR                                   03S1036 03863000
*GEN REFS(RPARM) SETS(RPARM)                                    03S1037 03864000
*(EXCP (RPARM));                       /*ISSUE EXCP                  */ 03865000
*                                                               03S1037 03866000
         EXCP (RPARM)                                                   03867000
*RPARM = ECBPTR;                       /*ADDRESS OF ECB              */ 03868000
         L     RPARM,ECBPTR                                     03S1038 03869000
*GEN REFS(RPARM) SETS(REG0,RPARM)                               03S1039 03870000
*(WAIT ECB=(RPARM));                   /*AWAIT I/O COMPLETION        */ 03871000
*                                                               03S1039 03872000
         WAIT ECB=(RPARM)                                               03873000
*IF ECBCC ^= GOODPOST |                /*IF ERROR IN EXCP OR         */ 03874000
*  VOL1 ^= COMPVOL1                    /*NO STANDARD LABEL,          */ 03875000
*  THEN DO;                                                     03S1040 03876000
         L     @10,ECBPTR                                       03S1040 03877000
         CLI   ECBCC(@10),X'7F'                                 03S1040 03878000
         BNE   @RT01040                                         03S1040 03879000
         CLC   VOL1(4),@CC00130                                 03S1040 03880000
         BE    @RF01040                                         03S1040 03881000
@RT01040 DS    0H                                               03S1041 03882000
*    IOBFLAG1 = IOBFLAGS;              /*RE-INIT CHAINING AND   03S1042 03883000
*                                        UNRELATED REQUEST FLAGS,    */ 03884000
         L     @10,IOBSTPTR                                     03S1042 03885000
         MVI   IOBFLAG1(@10),X'42'                              03S1042 03886000
*    UCBNOTRD = YES;                   /*UNLOAD DEVICE, AND          */ 03887000
         L     @10,UCBPTR                                       03S1043 03888000
         OI    UCBNOTRD(@10),B'01000000'                        03S1043 03889000
*    ERRMSG = ONE;                     /*INDICATE ERROR.             */ 03890000
         MVC   ERRMSG(4),@CF00042                               03S1044 03891000
*  END;                                                         03S1045 03892000
*  ELSE DO;                                                     03S1046 03893000
         B     @RC01040                                         03S1046 03894000
@RF01040 DS    0H                                               03S1047 03895000
*    NMNTVS = VOLSER;                  /*MOVE VOLSER INTO PARM LIST     03896000
*                                        FOR NIPMOUNT ROUTINE        */ 03897000
         LA    @10,NIPMNT                                       03S1047 03898000
         MVC   NMNTVS(6,@10),VOLSER                             03S1047 03899000
*    GEN REFS(NVTMOUNT,NIPMNT) SETS(RPARM)/*CHECK FOR DUP VOLUME     */ 03900000
*    (IEAPMNIP TYPE=MOUNT,PARAM=NIPMNT,OPT=(,,,US));            03S1048 03901000
         IEAPMNIP TYPE=MOUNT,PARAM=NIPMNT,OPT=(,,,US)                   03902000
*    IF RPARM ^= ZERO                  /*ANOTHER VOLUME WITH SAME    */ 03903000
*      THEN DO;                        /*SERIAL IS MOUNTED           */ 03904000
         LTR   RPARM,RPARM                                      03S1049 03905000
         BZ    @RF01049                                         03S1049 03906000
*        RFY RPARM UNRSTD;                                      03S1051 03907000
*        UCBNOTRD = YES;               /*UNLOAD VOLUME               */ 03908000
         L     @10,UCBPTR                                       03S1052 03909000
         OI    UCBNOTRD(@10),B'01000000'                        03S1052 03910000
*        ERRMSG = TWO;                 /*SET ERROR INDICATOR         */ 03911000
         MVC   ERRMSG(4),@CF00069                               03S1053 03912000
*      END;                                                     03S1054 03913000
*      ELSE DO;                        /*SEE IF VOL IS IN MOUNT LIST */ 03914000
         B     @RC01049                                         03S1055 03915000
@RF01049 DS    0H                                               03S1056 03916000
*/********************************************************************/ 03917000
*/*                                                                  */ 03918000
*/* SEGMENT NAME - CKVOLIST                                          */ 03919000
*/*                                                                  */ 03920000
*/* DESCRIPTIVE NAME - CHECK THE MOUNT LIST FOR THE MOUNTED VOLUME   */ 03921000
*/*                                                                  */ 03922000
*/* FUNCTION -                                                       */ 03923000
*/*                                                                  */ 03924000
*/*                                                                  */ 03925000
*/*     IF THE READIED VOLUME IS IN THE MOUNTLIST, THEN THE DEVICE   */ 03926000
*/*     TYPE IS CHECKED.  IF THE DEVICE TYPE OF THE MOUNT LIST ENTRY */ 03927000
*/*     DOESN'T MATCH THAT OF THE DEVICE, THEN THE VOLUME IS UNLOADED*/ 03928000
*/*     AND 'ERRMSG' IS SET TO 5.                                    */ 03929000
*/*                                                                  */ 03930000
*/*     IF THE DEVICE TYPES MATCH, THEN IF THE READIED VOLUME IS IN  */ 03931000
*/*     THE MOUNT LIST, AND THE TAG BIT IS ON IN THE UCB (INDICATOR  */ 03932000
*/*     FOR REQUESTED DEVICE), THEN THE TAG BIT IS TURNED OFF, THE   */ 03933000
*/*     SUBROUTINE THAT SETS THE ATTRIBUTES IS EXECUTED, THE DEVICE  */ 03934000
*/*     ENTRY IN 'DEVTABLE' IS ZEROED, THE DEVICE IS SET ONLINE AND  */ 03935000
*/*     'TOMOUNT' IS DECREMENTED.                                    */ 03936000
*/*                                                                  */ 03937000
*/*     IF THE VOLUME IS IN THE MOUNT LIST, BUT MOUNTED ON AN UNRE-  */ 03938000
*/*     QUESTED DEVICE, THE NOT-READY BIT IS TURNED ON IN THE UCB    */ 03939000
*/*     AND 'ERRMSG' IS SET TO 4.                                    */ 03940000
*/*                                                                  */ 03941000
*/*     IF THE VOLUME IS NOT IN THE MOUNT LIST, BUT IS MOUNTED ON A  */ 03942000
*/*     REQUESTED DEVICE, THE NOT-READY BIT IS TURNED ON IN THE UCB  */ 03943000
*/*     AND 'ERRMSG' IS SET TO 3.                                    */ 03944000
*/*                                                                  */ 03945000
*/* ENTRY - IN-LINE SEGMENT                                          */ 03946000
*/*                                                                  */ 03947000
*/*     PURPOSE - SEE FUNCTION                                       */ 03948000
*/*                                                                  */ 03949000
*/*     INPUT DATA -                                                 */ 03950000
*/*                                                                  */ 03951000
*/*         MNTLIST - MOUNT LIST                                     */ 03952000
*/*         THE VOLUME SERIAL OF THE MOUNTED VOLUME                  */ 03953000
*/*         DEVTABLE - THE DEVICE ADDRESSES AND CORRESPONDING        */ 03954000
*/*                    UCB ADDRESSES                                 */ 03955000
*/*                                                                  */ 03956000
*/* EXITS -                                                          */ 03957000
*/*                                                                  */ 03958000
*/*     CONDITION - VOLUME AND ENTRY DEVICE TYPES ARE NOT THE SAME   */ 03959000
*/*                                                                  */ 03960000
*/*     OUTPUT DATA -                                                */ 03961000
*/*                                                                  */ 03962000
*/*         UCB - UPDATED                                            */ 03963000
*/*         ERRMSG - SET TO 5                                        */ 03964000
*/*                                                                  */ 03965000
*/*     CONDITION - VOLUME IS IN MOUNT LIST AND ON A REQUESTED       */ 03966000
*/*                 DEVICE                                           */ 03967000
*/*                                                                  */ 03968000
*/*     OUTPUT DATA -                                                */ 03969000
*/*                                                                  */ 03970000
*/*         UCB - UPDATED                                            */ 03971000
*/*         DEVTABLE - ENTRY IS ZEROED                               */ 03972000
*/*         TOMOUNT - UPDATED                                        */ 03973000
*/*                                                                  */ 03974000
*/*     CONDITION - VOLUME IS IN THE MOUNT LIST AND ON AN            */ 03975000
*/*                 UNREQUESTED DEVICE                               */ 03976000
*/*                                                                  */ 03977000
*/*     OUTPUT DATA -                                                */ 03978000
*/*                                                                  */ 03979000
*/*         UCB - UPDATED                                            */ 03980000
*/*         ERRMSG - SET TO 4                                        */ 03981000
*/*                                                                  */ 03982000
*/*     CONDITION - VOLUME IS NOT IN THE MOUNT LIST BUT IS ON        */ 03983000
*/*                 A REQUESTED DEVICE                               */ 03984000
*/*                                                                  */ 03985000
*/*     OUTPUT DATA -                                                */ 03986000
*/*                                                                  */ 03987000
*/*         UCB - UPDATED                                            */ 03988000
*/*         ERRMSG - SET TO 3                                        */ 03989000
*/*                                                                  */ 03990000
*/*                                                                  */ 03991000
*/*     RETURN CODE - NONE                                           */ 03992000
*/*                                                                  */ 03993000
*/********************************************************************/ 03994000
*                                                               04S1056 03995000
*FOUND = NO;                                                    04S1056 03996000
         NI    FOUND,B'11111101'                                04S1056 03997000
*DO I = ONE TO MTLSTCT WHILE (FOUND = NO);                      04S1057 03998000
         LA    @10,1                                            04S1057 03999000
         B     @DE01057                                         04S1057 04000000
@DL01057 TM    FOUND,B'00000010'                                04S1057 04001000
         BNZ   @DC01057                                         04S1057 04002000
*  IF MVOLSER(I) = VOLSER              /*DETERMINE IF VOLUME IS IN   */ 04003000
*    THEN DO;                          /*THE MOUNTLIST               */ 04004000
         LR    @05,@10                                          04S1058 04005000
         MH    @05,@CH00190                                     04S1058 04006000
         LA    @01,MVOLSER-22(@05)                              04S1058 04007000
         CLC   0(6,@01),VOLSER                                  04S1058 04008000
         BNE   @RF01058                                         04S1058 04009000
*      FOUND = YES;                                             04S1060 04010000
         OI    FOUND,B'00000010'                                04S1060 04011000
*      J = DEVENT(I);                  /*OBTAIN UNIT TYPE INDEX      */ 04012000
         SLR   @15,@15                                          04S1061 04013000
         IC    @15,DEVENT-22(@05)                               04S1061 04014000
         STH   @15,J                                            04S1061 04015000
*      MNTIND = I;                                              04S1062 04016000
         STH   @10,MNTIND                                       04S1062 04017000
*      IF UCBTYPE(J) ^= UCBTBYT4       /*IF UCB IS NOT SAME UNIT TYPE*/ 04018000
*        THEN DO;                      /*AS MNTLIST ENTRY            */ 04019000
         MH    @15,@CH01793                                     04S1063 04020000
         L     @10,UCBPTR                                       04S1063 04021000
         SLR   @05,@05                                          04S1063 04022000
         IC    @05,UCBTYPE-14(@15)                              04S1063 04023000
         MVC   @ZT00003+3(1),UCBTBYT4(@10)                      04S1063 04024000
         C     @05,@ZT00003                                     04S1063 04025000
         BE    @RF01063                                         04S1063 04026000
*          UCBNOTRD = YES;             /*UNLOAD THE DEVICE           */ 04027000
         OI    UCBNOTRD(@10),B'01000000'                        04S1065 04028000
*          ERRMSG = FIVE;              /*SET ERROR MESSAGE INDICATOR */ 04029000
         MVC   ERRMSG(4),@CF00073                               04S1066 04030000
*        END;                                                   04S1067 04031000
*    END;                                                       04S1068 04032000
@RF01063 DS    0H                                               04S1069 04033000
*END;                                                           04S1069 04034000
*                                                               04S1069 04035000
@RF01058 LA    @10,1                                            04S1069 04036000
         AH    @10,I                                            04S1069 04037000
@DE01057 STH   @10,I                                            04S1069 04038000
         CH    @10,MTLSTCT                                      04S1069 04039000
         BNH   @DL01057                                         04S1069 04040000
@DC01057 DS    0H                                               04S1070 04041000
*IF ERRMSG = ZERO                                               04S1070 04042000
*  THEN IF FOUND = YES                 /*IF VOL IN MOUNT LIST AND    */ 04043000
         L     @10,ERRMSG                                       04S1070 04044000
         LTR   @10,@10                                          04S1070 04045000
         BNZ   @RF01070                                         04S1070 04046000
*    THEN IF UCBPRSRS = YES            /*DEVICE IS REQUESTED, THEN   */ 04047000
         TM    FOUND,B'00000010'                                04S1071 04048000
         BNO   @RF01071                                         04S1071 04049000
*      THEN DO;                        /*REQUESTED VOL ON REQ. DEV.  */ 04050000
         L     @10,UCBPTR                                       04S1072 04051000
         TM    UCBPRSRS(@10),B'00100000'                        04S1072 04052000
         BNO   @RF01072                                         04S1072 04053000
*        UCBONLI = YES;                /*MAKE UCB ONLINE AND         */ 04054000
         OI    UCBONLI(@10),B'10000000'                         04S1074 04055000
*        UCBPRSRS = NO;                /*TURN OFF REQ. DEV. BIT.     */ 04056000
         NI    UCBPRSRS(@10),B'11011111'                        04S1075 04057000
*        MAPAD = ADDR(MNTLIST(MNTIND));  /*MAPPING FOR MOUNT LIST    */ 04058000
         LH    @10,MNTIND                                       04S1076 04059000
         MH    @10,@CH00190                                     04S1076 04060000
         LA    @10,MNTLIST-22(@10)                              04S1076 04061000
         ST    @10,MAPAD                                        04S1076 04062000
*        CALL SETSTAT;                 /*SET VOL ATTRIBUTES  @Y30LPPD*/ 04063000
         BAL   @14,SETSTAT                                      04S1077 04064000
*        LOOPSW = NO;                                           04S1078 04065000
         NI    LOOPSW,B'11101111'                               04S1078 04066000
*        DO J = ONE TO TABLECT         /*LOOP THROUGH THE DEVTABLE   */ 04067000
*          WHILE (LOOPSW = NO);                                 04S1079 04068000
         LA    @10,1                                            04S1079 04069000
         B     @DE01079                                         04S1079 04070000
@DL01079 TM    LOOPSW,B'00010000'                               04S1079 04071000
         BNZ   @DC01079                                         04S1079 04072000
*          IF UCBADDR(J) = UCBPTR      /*WHEN ENTRY IS FOUND         */ 04073000
*            THEN DO;                                           04S1080 04074000
         SLA   @10,3                                            04S1080 04075000
         L     @05,UCBADDR-8(@10)                               04S1080 04076000
         C     @05,UCBPTR                                       04S1080 04077000
         BNE   @RF01080                                         04S1080 04078000
*              DEVICE(J) = ZEROADDR;   /*ZERO THE ENTRY              */ 04079000
         LA    @05,DEVICE-8(@10)                                04S1082 04080000
         MVC   0(3,@05),ZEROADDR                                04S1082 04081000
*              LOOPSW = YES;                                    04S1083 04082000
         OI    LOOPSW,B'00010000'                               04S1083 04083000
*            END;                                               04S1084 04084000
*        END;                                                   04S1085 04085000
@RF01080 LA    @10,1                                            04S1085 04086000
         AH    @10,J                                            04S1085 04087000
@DE01079 STH   @10,J                                            04S1085 04088000
         CH    @10,TABLECT                                      04S1085 04089000
         BNH   @DL01079                                         04S1085 04090000
@DC01079 DS    0H                                               04S1086 04091000
*        TOMOUNT = TOMOUNT - ONE;      /*DECR CT OF VOLS TO BE MTD   */ 04092000
         LH    @10,TOMOUNT                                      04S1086 04093000
         BCTR  @10,0                                            04S1086 04094000
         STH   @10,TOMOUNT                                      04S1086 04095000
*      END;                                                     04S1087 04096000
*      ELSE DO;                        /*REQ. VOL. ON UNREQ. DEVICE  */ 04097000
         B     @RC01072                                         04S1088 04098000
@RF01072 DS    0H                                               04S1089 04099000
*        UCBNOTRD = YES;               /*UNLOAD VOLUME               */ 04100000
         L     @10,UCBPTR                                       04S1089 04101000
         OI    UCBNOTRD(@10),B'01000000'                        04S1089 04102000
*        ERRMSG = FOUR;                /*SET ERROR CODE              */ 04103000
         MVC   ERRMSG(4),@CF00036                               04S1090 04104000
*      END;                                                     04S1091 04105000
*    ELSE IF UCBPRSRS = YES            /*UNREQUESTED VOLUME ON       */ 04106000
*      THEN DO;                        /*REQUESTED DEVICE            */ 04107000
         B     @RC01071                                         04S1092 04108000
@RF01071 L     @10,UCBPTR                                       04S1092 04109000
         TM    UCBPRSRS(@10),B'00100000'                        04S1092 04110000
         BNO   @RF01092                                         04S1092 04111000
*        UCBNOTRD = YES;               /*UNLOAD VOLUME               */ 04112000
         OI    UCBNOTRD(@10),B'01000000'                        04S1094 04113000
*        ERRMSG = THREE;               /*SET ERROR CODE              */ 04114000
         MVC   ERRMSG(4),@CF00064                               04S1095 04115000
*      END;                                                     04S1096 04116000
*      END;                                                     03S1097 04117000
@RF01092 DS    0H                                               03S1097 04118000
@RC01071 DS    0H                                               03S1097 04119000
@RF01070 DS    0H                                               03S1098 04120000
*    IF UCBNOTRD = NO                  /*NO ERRORS WITH THIS VOLUME  */ 04121000
*      THEN DO;                        /*SET UP FOR TTR CONVERT      */ 04122000
@RC01049 L     @10,UCBPTR                                       03S1098 04123000
         TM    UCBNOTRD(@10),B'01000000'                        03S1098 04124000
         BNZ   @RF01098                                         03S1098 04125000
*        RFY (RTTR,RPARM,RCCHHR,REG4,RENTRY) RSTD;              03S1100 04126000
*        RPARM = DEBPTR;               /*ADDRESS OF DEB              */ 04127000
         L     RPARM,DEBPTR                                     03S1101 04128000
*        MBB = ZERO;                   /*CLEAR BIN ADDRESS           */ 04129000
         SLR   @14,@14                                          03S1102 04130000
         ST    @14,@TF00001                                     03S1102 04131000
         MVC   MBB(3),@TF00001+1                                03S1102 04132000
*        CCHHR = VOLVTOC;              /*VTOC CCHHR                  */ 04133000
         MVC   CCHHR(5),VOLVTOC                                 03S1103 04134000
*        RENTRY = CVTPRLTV;            /*ADDR OF CONVERT ROUTINE     */ 04135000
         L     @10,CVTPTR                                       03S1104 04136000
         L     RENTRY,CVTPRLTV(,@10)                            03S1104 04137000
*        GEN REFS(RCCHHR,RENTRY,RPARM,MBBCCHHR) /*CONVERT THE TTR    */ 04138000
*            SETS(REXIT,RTTR,RCCHHR,REGSAVE,REG4);              03S1105 04139000
         STM   RPARM,RENTRY,REGSAVE      SAVE REGISTERS                 04140000
         LA    REG4,REGSAVE                                             04141000
         LA    RCCHHR,MBBCCHHR                                          04142000
         BALR  REXIT,RENTRY              CONVERT ROUTINE                04143000
         LM    RPARM,RENTRY,0(4)         RESTORE REGS                   04144000
*        UCBVTOC = RTTR;               /*PUT VTOC TTR INTO UCB       */ 04145000
         L     @14,UCBPTR                                       03S1106 04146000
         ST    RTTR,UCBVTOC(,@14)                               03S1106 04147000
*        RFY (RCCHHR,RTTR,RPARM,REG4,RENTRY) UNRSTD;            03S1107 04148000
*        UCBVOLI = VOLSER;             /*MOVE VOLSER INTO UCB        */ 04149000
         MVC   UCBVOLI(6,@14),VOLSER                            03S1108 04150000
*      END;                                                     03S1109 04151000
*  END;                                                         03S1110 04152000
@RF01098 DS    0H                                               03S1111 04153000
*IF ERRMSG > ZERO                      /*PROCESS ERRORS FOR THIS VOL */ 04154000
*  THEN DO;                                                     03S1111 04155000
@RC01040 L     @10,ERRMSG                                       03S1111 04156000
         LTR   @10,@10                                          03S1111 04157000
         BNP   @RF01111                                         03S1111 04158000
*/********************************************************************/ 04159000
*/*                                                                  */ 04160000
*/* SEGMENT NAME - ERRPROC                                           */ 04161000
*/*                                                                  */ 04162000
*/* DESCRIPTIVE NAME - HANDLE VOLUME ERRORS                          */ 04163000
*/*                                                                  */ 04164000
*/* FUNCTION -                                                       */ 04165000
*/*                                                                  */ 04166000
*/*     IF 'ERRMSG' IS 1, AND IT WAS AN I/O ERROR, ISSUE NIPSENSE    */ 04167000
*/*     TO INFORM THE OPERATOR OF THE DEVICE ERROR.  MESSAGES        */ 04168000
*/*     'IEA854I-ERROR READING VOLUME LABEL. IEA948I         @Y30LPPD*/ 04169000
*/*     XXX NOW UNLOADED.' ARE ISSUED.                       @Y30LPPD*/ 04170000
*/*                                                                  */ 04171000
*/*     IF 'ERRMSG' IS 2, MESSAGE 'IEA867I-DUPLICATE VOLUME AAAAAA.  */ 04172000
*/*     UNIT XXX NOW UNLOADED.' IS ISSUED.                           */ 04173000
*/*                                                                  */ 04174000
*/*     IF 'ERRMSG' IS 3, AND MESSAGE 'IEA859I-UNREQUESTED VOLUME.   */ 04175000
*/*     UNIT XXX NOW UNLOADED.' IS ISSUED.                           */ 04176000
*/*                                                                  */ 04177000
*/*     IF 'ERRMSG' IS 4, MESSAGE 'IEA894I-REQUESTED VOLUME ON UNRE- */ 04178000
*/*     QUESTED UNIT.  DDD NOW UNLOADED.' IS ISSUED.                 */ 04179000
*/*                                                                  */ 04180000
*/*     IF 'ERRMSG' IS 5, MESSAGES 'IEA866I VOLUME AAAAAA ON DDD     */ 04181000
*/*     REQUIRED ON A UUUUUUUU.' AND 'IEA948I DDD NOW UNLOADED.'     */ 04182000
*/*     ARE ISSUED.                                                  */ 04183000
*/*                                                                  */ 04184000
*/*                                                                  */ 04185000
*/* ENTRY - IN-LINE SEGMENT                                          */ 04186000
*/*                                                                  */ 04187000
*/*     PURPOSE - SEE FUNCTION                                       */ 04188000
*/*                                                                  */ 04189000
*/*     INPUT DATA -                                                 */ 04190000
*/*                                                                  */ 04191000
*/*         UCB ADDRESS                                              */ 04192000
*/*         ERRMSG - SET TO INDICATE ERROR ENCOUNTERED               */ 04193000
*/*                                                                  */ 04194000
*/* EXITS -                                                          */ 04195000
*/*                                                                  */ 04196000
*/*     CONDITION - ERRMSG IS SET TO 1                               */ 04197000
*/*                                                                  */ 04198000
*/*     OUTPUT DATA -                                                */ 04199000
*/*                                                                  */ 04200000
*/*         SENSE MESSAGE ISSUED IF DEVICE ERROR                     */ 04201000
*/*         MESSAGE IEA854I ISSUED                                   */ 04202000
*/*                                                                  */ 04203000
*/*     CONDITION - ERRMSG IS SET TO 2                               */ 04204000
*/*                                                                  */ 04205000
*/*     OUTPUT DATA -                                                */ 04206000
*/*                                                                  */ 04207000
*/*         MESSAGE IEA867I ISSUED                                   */ 04208000
*/*                                                                  */ 04209000
*/*     CONDITION - ERRMSG IS SET TO 3                               */ 04210000
*/*                                                                  */ 04211000
*/*     OUTPUT DATA -                                                */ 04212000
*/*                                                                  */ 04213000
*/*         MESSAGE IEA859I IS ISSUED                                */ 04214000
*/*                                                                  */ 04215000
*/*     CONDITION - ERRMSG IS SET TO 4                               */ 04216000
*/*                                                                  */ 04217000
*/*     OUTPUT DATA -                                                */ 04218000
*/*                                                                  */ 04219000
*/*         MESSAGE IEA894I IS ISSUED                                */ 04220000
*/*                                                                  */ 04221000
*/*     CONDITION - ERRMSG IS SET TO 5                               */ 04222000
*/*                                                                  */ 04223000
*/*     OUTPUT DATA -                                                */ 04224000
*/*                                                                  */ 04225000
*/*         MESSAGE IEA866I                                          */ 04226000
*/*         MESSAGE IEA948I                                          */ 04227000
*/*                                                                  */ 04228000
*/*     RETURN CODE - NONE                                           */ 04229000
*/*                                                                  */ 04230000
*/********************************************************************/ 04231000
*                                                               04S1113 04232000
*IF ERRMSG = ONE                       /*ERROR READING VOL SER NUMBER*/ 04233000
*  THEN DO;                                                     04S1113 04234000
         CH    @10,@CH00042                                     04S1113 04235000
         BNE   @RF01113                                         04S1113 04236000
*    IF ECBCC ^= GOODPOST              /*IF I/O ERROR FROM EXCP      */ 04237000
*      THEN DO;                                                 04S1115 04238000
         L     @10,ECBPTR                                       04S1115 04239000
         CLI   ECBCC(@10),X'7F'                                 04S1115 04240000
         BE    @RF01115                                         04S1115 04241000
*        RFY RPARM RSTD;                                        04S1117 04242000
*        RPARM = IOBSTPTR;             /*ISSUE NIP SENSE TO          */ 04243000
         L     RPARM,IOBSTPTR                                   04S1118 04244000
*        GEN REFS(NVTSENSE)            /*INFORM OP OF DEVICE ERROR   */ 04245000
*        (IEAPMNIP TYPE=SENSE,PARAM=RPARM);                     04S1119 04246000
         IEAPMNIP TYPE=SENSE,PARAM=RPARM                                04247000
*        RFY RPARM UNRSTD;                                      04S1120 04248000
*      END;                                                     04S1121 04249000
*    V948 = BLANK;                     /*REMOVE V FROM MSG   @Y30LPPD*/ 04250000
@RF01115 MVI   V948,C' '                                        04S1122 04251000
*    DEV948 = UCBNAME;                                          04S1123 04252000
         L     @10,UCBPTR                                       04S1123 04253000
         MVC   DEV948(3),UCBNAME(@10)                           04S1123 04254000
*    GEN REFS(NVTWTO);                 /*ISSUE IEA854I + 948I@Y30LPPD*/ 04255000
     IEAPMNIP TYPE=WTO,PARAM=IEA854I                           @Y30LPPD 04256000
     IEAPMNIP TYPE=WTO,PARAM=IEA948I                           @Y30LPPD 04257000
*    /*IEA854I ERROR READING VOLUME LABEL.                   @Y30LPPD*/ 04258000
*    /*IEA948I DDD NOW UNLOADED.                             @Y30LPPD*/ 04259000
*  END;                                                         04S1125 04260000
*IF ERRMSG = TWO                       /*DUPLICATE VOLUME SER NUMBER */ 04261000
*  THEN DO;                                                     04S1126 04262000
@RF01113 CLC   ERRMSG(4),@CF00069                               04S1126 04263000
         BNE   @RF01126                                         04S1126 04264000
*    SER867 = VOLSER;                  /*MOVE VOLSER INTO MESSAGE    */ 04265000
         MVC   SER867(6),VOLSER                                 04S1128 04266000
*    DEV867 = UCBNAME;                 /*MOVE DEVICE ADDR INTO MSG   */ 04267000
         L     @10,UCBPTR                                       04S1129 04268000
         MVC   DEV867(3),UCBNAME(@10)                           04S1129 04269000
*    GEN REFS(NVTWTO) (IEAPMNIP TYPE=WTO,PARAM=IEA867I);        04S1130 04270000
         IEAPMNIP TYPE=WTO,PARAM=IEA867I                                04271000
*    /*IEA867I DUPLICATE VOLUME AAAAAA.UNIT XXX NOW UNLOADED.        */ 04272000
*  END;                                                         04S1131 04273000
*IF ERRMSG = THREE                     /*UNREQUESTED VOLUME ON       */ 04274000
*  THEN DO;                            /*REQUESTED DEVICE.           */ 04275000
@RF01126 CLC   ERRMSG(4),@CF00064                               04S1132 04276000
         BNE   @RF01132                                         04S1132 04277000
*    DEV859 = UCBNAME;                 /*MOVE DEVICE ADDR INTO MSG   */ 04278000
         L     @10,UCBPTR                                       04S1134 04279000
         MVC   DEV859(3),UCBNAME(@10)                           04S1134 04280000
*    GEN REFS(NVTWTO) (IEAPMNIP TYPE=WTO,PARAM=IEA859I);        04S1135 04281000
         IEAPMNIP TYPE=WTO,PARAM=IEA859I                                04282000
*    /*IEA859I UNREQUESTED VOLUME. UNIT XXX NOW UNLOADED.            */ 04283000
*  END;                                                         04S1136 04284000
*IF ERRMSG = FOUR                      /*REQUESTED VOLUME ON         */ 04285000
*  THEN DO;                            /*UNREQUESTED DEVICE.         */ 04286000
@RF01132 CLC   ERRMSG(4),@CF00036                               04S1137 04287000
         BNE   @RF01137                                         04S1137 04288000
*    DEV894 = UCBNAME;                 /*MOVE DEVICE ADDR INTO MSG   */ 04289000
         L     @10,UCBPTR                                       04S1139 04290000
         MVC   DEV894(3),UCBNAME(@10)                           04S1139 04291000
*    GEN REFS(NVTWTO) (IEAPMNIP TYPE=WTO,PARAM=IEA894I);        04S1140 04292000
         IEAPMNIP TYPE=WTO,PARAM=IEA894I                                04293000
*   /*IEA894I REQUESTED VOLUME ON UNREQUESTED DEVICE.XXX NOW UNLOADED*/ 04294000
*  END;                                                         04S1141 04295000
*IF ERRMSG = FIVE                      /*UCB DEVICE TYPE DOES NOT    */ 04296000
*  THEN DO;                            /*MATCH MNTLIST ENTRY         */ 04297000
@RF01137 CLC   ERRMSG(4),@CF00073                               04S1142 04298000
         BNE   @RF01142                                         04S1142 04299000
*    SER866 = VOLSER;                  /*MOVE VOLSER INTO MESSAGE    */ 04300000
         MVC   SER866(6),VOLSER                                 04S1144 04301000
*    DEV866 = UCBNAME;                 /*MOVE DEVICE ADDR INTO MSG   */ 04302000
         L     @10,UCBPTR                                       04S1145 04303000
         MVC   DEV866(3),UCBNAME(@10)                           04S1145 04304000
*    DT866 = ETYPE(J);                                          04S1146 04305000
         LH    @10,J                                            04S1146 04306000
         MH    @10,@CH01793                                     04S1146 04307000
         LA    @05,ETYPE-14(@10)                                04S1146 04308000
         MVC   DT866(8),0(@05)                                  04S1146 04309000
*    GEN REFS(NVTWTO) (IEAPMNIP TYPE=WTO,PARAM=IEA866I);        04S1147 04310000
         IEAPMNIP TYPE=WTO,PARAM=IEA866I                                04311000
*    /*IEA866I VOLUME AAAAAA ON DDD REQUIRED ON A UUUUUUUU.          */ 04312000
*    DEV948 = UCBNAME;                                          04S1148 04313000
         L     @10,UCBPTR                                       04S1148 04314000
         MVC   DEV948(3),UCBNAME(@10)                           04S1148 04315000
*    GEN REFS(NVTWTO) (IEAPMNIP TYPE=WTO,PARAM=IEA948I);        04S1149 04316000
         IEAPMNIP TYPE=WTO,PARAM=IEA948I                                04317000
*    /*IEA948I XXX NOW UNLOADED.                                     */ 04318000
*  END;                                                         04S1150 04319000
*  END;                                                         03S1151 04320000
@RF01142 DS    0H                                               03S1152 04321000
*        END;                                                   02S1152 04322000
@RF01111 DS    0H                                               02S1153 04323000
*    END;                                                       02S1153 04324000
@RF01029 DS    0H                                               02S1154 04325000
*  RFY RPARM RSTD;                                              02S1154 04326000
@RF01027 DS    0H                                               02S1155 04327000
*  RPARM = LUTSAVE;                    /*MOVE LUT ADDR INTO PARM REG */ 04328000
         L     RPARM,LUTSAVE                                    02S1155 04329000
*  CALL UCBCONT;                       /*OBTAIN NEXT UCB ADDRESS     */ 04330000
         L     @15,@CV00230                                     02S1156 04331000
         BALR  @14,@15                                          02S1156 04332000
*  UCBPTR = RPARM;                     /*SAVE ADDRESS OF UCB         */ 04333000
         ST    RPARM,UCBPTR                                     02S1157 04334000
*  RFY RPARM UNRSTD;                                            02S1158 04335000
*END;                                                           02S1159 04336000
*                                                               02S1159 04337000
@DE01026 SLR   @10,@10                                          02S1159 04338000
         C     @10,UCBPTR                                       02S1159 04339000
         BNE   @DL01026                                         02S1159 04340000
*DEVMTCT = TOMOUNT;                    /*UPDATE LOOP CONTROL COUNTER */ 04341000
         LH    @05,TOMOUNT                                      02S1160 04342000
         STH   @05,DEVMTCT                                      02S1160 04343000
*IF TOMOUNT > 0                        /*IF ALL VOLS HAVE    @YM02783*/ 04344000
*  THEN DO;                            /*NOT COME READY,     @YM02783*/ 04345000
         CR    @05,@10                                          02S1161 04346000
         BNH   @RF01161                                         02S1161 04347000
*    DEV860 = BLANK;                   /*PREPARE MSG         @YM02783*/ 04348000
         MVI   DEV860+1,C' '                                    02S1163 04349000
         MVC   DEV860+2(78),DEV860+1                            02S1163 04350000
         MVI   DEV860,C' '                                      02S1163 04351000
*    I = ZERO;                                             /*@YM02783*/ 04352000
         STH   @10,I                                            02S1164 04353000
*    DO DEVIND = ONE TO TABLECT;       /*LOOP THROUGH DEVTABL@YM02783*/ 04354000
         LA    @10,1                                            02S1165 04355000
         B     @DE01165                                         02S1165 04356000
@DL01165 DS    0H                                               02S1166 04357000
*      IF DEVICE(DEVIND) ^= ZEROADDR   /*IF ENTRY HAS NOT    @YM02783*/ 04358000
*        THEN DO;                      /*BEEN MOUNTED, THEN  @YM02783*/ 04359000
         SLA   @10,3                                            02S1166 04360000
         LA    @05,DEVICE-8(@10)                                02S1166 04361000
         CLC   0(3,@05),ZEROADDR                                02S1166 04362000
         BE    @RF01166                                         02S1166 04363000
*          I = I + ONE;                /*MOVE ENTRY INTO     @YM02783*/ 04364000
         LA    @05,1                                            02S1168 04365000
         AH    @05,I                                            02S1168 04366000
         STH   @05,I                                            02S1168 04367000
*          UNITAD(I) = DEVICE(DEVIND); /*MESSAGE AREA        @YM02783*/ 04368000
         SLA   @05,2                                            02S1169 04369000
         LA    @15,DEV860                                       02S1169 04370000
         ALR   @15,@05                                          02S1169 04371000
         AL    @15,@CF02680                                     02S1169 04372000
         LA    @05,DEVICE-8(@10)                                02S1169 04373000
         MVC   UNITAD(3,@15),0(@05)                             02S1169 04374000
*        END;                                              /*@YM02783*/ 04375000
*    END;                                                  /*@YM02783*/ 04376000
@RF01166 LA    @10,1                                            02S1171 04377000
         AH    @10,DEVIND                                       02S1171 04378000
@DE01165 STH   @10,DEVIND                                       02S1171 04379000
         CH    @10,TABLECT                                      02S1171 04380000
         BNH   @DL01165                                         02S1171 04381000
*IF I > ONE THEN                       /*IF MORE THAN ONE    @YM02783*/ 04382000
         LA    @10,1                                            02S1172 04383000
         CH    @10,I                                            02S1172 04384000
         BNL   @RF01172                                         02S1172 04385000
*  DO J = ONE TO (I-ONE);              /*DEVICE IN MESSAGE,  @YM02783*/ 04386000
         B     @DE01173                                         02S1173 04387000
@DL01173 DS    0H                                               02S1174 04388000
*    COM(J) = COMMA;                   /*INSERT COMMAS       @YM02783*/ 04389000
         LR    @05,@10                                          02S1174 04390000
         SLA   @05,2                                            02S1174 04391000
         LA    @15,DEV860                                       02S1174 04392000
         ALR   @15,@05                                          02S1174 04393000
         BCTR  @15,0                                            02S1174 04394000
         MVI   COM-3(@15),C','                                  02S1174 04395000
*  END;                                                    /*@YM02783*/ 04396000
         AL    @10,@CF00042                                     02S1175 04397000
@DE01173 STH   @10,J                                            02S1175 04398000
         LH    @05,I                                            02S1175 04399000
         BCTR  @05,0                                            02S1175 04400000
         CR    @10,@05                                          02S1175 04401000
         BNH   @DL01173                                         02S1175 04402000
*                                                          /*@YM02783*/ 04403000
*BADREPLY = YES;                                           /*@YM02783*/ 04404000
@RF01172 OI    BADREPLY,B'10000000'                             02S1176 04405000
*DO WHILE BADREPLY = YES;              /*ISSUE MESSAGE       @YM02783*/ 04406000
         B     @DE01177                                         02S1177 04407000
@DL01177 DS    0H                                               02S1178 04408000
*  BADREPLY = NO;                      /*AND CHECK REPLY     @YM02783*/ 04409000
         NI    BADREPLY,B'01111111'                             02S1178 04410000
*  GEN REFS(NVTWTO,NVTWTOR);                               /*@YM02783*/ 04411000
*          DDD,DDD,...                                       @YM02783   04412000
           IEAPMNIP TYPE=WTO,PARAM=IEA860A                   @YM02783   04413000
*          IEA893A DEVICES NOT READY. REPLY U WHEN DEVICES   @YM02783   04414000
*          ARE READY OR NO TO CONTINUE.                      @YM02783   04415000
         IEAPMNIP TYPE=WTOR,PARAM=IEA893A                    @YM02783   04416000
*                                      /*                    @YM02783*/ 04417000
*  IF SCAN2 = COMPNO                   /*IF REPLY IS NO,     @YM02783*/ 04418000
*    THEN DEVMTCT = ZERO;              /*THEN STOP LOOPING   @YM02783*/ 04419000
         CLC   SCAN2(2),@CC00138                                02S1180 04420000
         BNE   @RF01180                                         02S1180 04421000
         SLR   @10,@10                                          02S1181 04422000
         STH   @10,DEVMTCT                                      02S1181 04423000
*    ELSE IF SCAN2 ^= REPLYU &         /*FOR VOLS TO COME    @YM02783*/ 04424000
*                                      /*RDY INVALID REPLY   @YM02783*/ 04425000
*      SCAN2 ^= REPLYEOB                                        02S1182 04426000
*      THEN BADREPLY = YES;            /*SET SWITCH          @YM02783*/ 04427000
         B     @RC01180                                         02S1182 04428000
@RF01180 CLC   SCAN2(2),@CC00168                                02S1182 04429000
         BE    @RF01182                                         02S1182 04430000
         CLC   SCAN2(2),@CC00170                                02S1182 04431000
         BE    @RF01182                                         02S1182 04432000
         OI    BADREPLY,B'10000000'                             02S1183 04433000
*END;                                                      /*@YM02783*/ 04434000
@RF01182 DS    0H                                               02S1184 04435000
@RC01180 DS    0H                                               02S1184 04436000
@DE01177 TM    BADREPLY,B'10000000'                             02S1184 04437000
         BO    @DL01177                                         02S1184 04438000
*END;                                                           02S1185 04439000
*        END;                                                   01S1186 04440000
@RF01161 DS    0H                                               01S1186 04441000
@DE01020 SLR   @10,@10                                          01S1186 04442000
         CH    @10,DEVMTCT                                      01S1186 04443000
         BL    @DL01020                                         01S1186 04444000
*        DO;                           /* CLEANUP TAG BITS IN UCBS.  */ 04445000
*/********************************************************************/ 04446000
*/*                                                                  */ 04447000
*/* SEGMENT NAME - CLEANUP                                           */ 04448000
*/*                                                                  */ 04449000
*/* DESCRIPTIVE NAME - TURN OFF TAG BITS IN UCB                      */ 04450000
*/*                                                                  */ 04451000
*/* FUNCTION -                                                       */ 04452000
*/*                                                                  */ 04453000
*/*     IF ALL VOLUMES WERE NOT MOUNTED, THE TAG BIT IS TURNED OFF   */ 04454000
*/*     IN ALL UCB'S CORRESPONDING TO NON-ZEROED 'DEVTABLE' ENTRIES. */ 04455000
*/*                                                                  */ 04456000
*/* ENTRY - IN-LINE SEGMENT                                          */ 04457000
*/*                                                                  */ 04458000
*/*     INPUT DATA -                                                 */ 04459000
*/*                                                                  */ 04460000
*/*         DEVTABLE - THE DEVICE ADDRESSES AND CORRESPONDING        */ 04461000
*/*                    UCB ADDRESSES                                 */ 04462000
*/*                                                                  */ 04463000
*/* EXITS -                                                          */ 04464000
*/*                                                                  */ 04465000
*/*     CONDITION - ALL VOLUMES WERE NOT MOUNTED                     */ 04466000
*/*                                                                  */ 04467000
*/*     OUTPUT DATA -                                                */ 04468000
*/*                                                                  */ 04469000
*/*         UCB - UPDATED                                            */ 04470000
*/*                                                                  */ 04471000
*/*     RETURN CODE - NONE                                           */ 04472000
*/*                                                                  */ 04473000
*/********************************************************************/ 04474000
*                                                               02S1188 04475000
*IF TOMOUNT > ZERO                     /*IF ALL VOLS WERE NOT MOUNTED*/ 04476000
*  THEN DO;                            /*THEN TURN OFF UCBPRSRS BIT  */ 04477000
         CH    @10,TOMOUNT                                      02S1188 04478000
         BNL   @RF01188                                         02S1188 04479000
*    DO I = ONE TO TABLECT;            /*SCAN DEVTABLE               */ 04480000
         LA    @10,1                                            02S1190 04481000
         B     @DE01190                                         02S1190 04482000
@DL01190 DS    0H                                               02S1191 04483000
*      IF DEVICE(I) ^= ZEROADDR        /*FOR ANY UNMOUNTED DEVICE    */ 04484000
*        THEN DO;                                               02S1191 04485000
         SLA   @10,3                                            02S1191 04486000
         LA    @05,DEVICE-8(@10)                                02S1191 04487000
         CLC   0(3,@05),ZEROADDR                                02S1191 04488000
         BE    @RF01191                                         02S1191 04489000
*          UCBPTR = UCBADDR(I);                                 02S1193 04490000
         L     @10,UCBADDR-8(@10)                               02S1193 04491000
         ST    @10,UCBPTR                                       02S1193 04492000
*          UCBPRSRS = NO;              /*TURN OFF REQUESTED DEV BIT  */ 04493000
         NI    UCBPRSRS(@10),B'11011111'                        02S1194 04494000
*        END;                                                   02S1195 04495000
*    END;                                                       02S1196 04496000
@RF01191 LA    @10,1                                            02S1196 04497000
         AH    @10,I                                            02S1196 04498000
@DE01190 STH   @10,I                                            02S1196 04499000
         CH    @10,TABLECT                                      02S1196 04500000
         BNH   @DL01190                                         02S1196 04501000
*  END;                                                         02S1197 04502000
*        END;                                                   01S1198 04503000
@RF01188 DS    0H                                               01S1199 04504000
*      END;                                                     01S1199 04505000
*    IF DPLOADED = YES THEN                                     01S1200 04506000
@RF00978 TM    DPLOADED,B'01000000'                             01S1200 04507000
         BNO   @RF01200                                         01S1200 04508000
*      DO;                                                      01S1201 04509000
*          DO;/* DELETE EP(NIEEVDEV)*/                          01S1202 04510000
*          RESPECIFY (GPR00P)RESTRICTED;                        01S1203 04511000
*          GPR00P = ADDR(NIEEVDEV);/* ->ENTRY NAME*/            01S1204 04512000
         LA    GPR00P,NIEEVDEV                                  01S1204 04513000
*          SVC    (9);/* DELETE SVC*/                           01S1205 04514000
         SVC   9                                                01S1205 04515000
*          RESPECIFY (GPR00P)UNRESTRICTED;                      01S1206 04516000
*          END;/* DELETE EP(NIEEVDEV)*/                         01S1207 04517000
*      END;                                                     01S1208 04518000
*  END;                                                         01S1209 04519000
*                                                               01S1209 04520000
*                                                               01S1209 04521000
*    DECLARE /*GENERAL PURPOSE REGISTERS */                     01S1210 04522000
*      GPR15F FIXED(31) REG(15),                                01S1210 04523000
*      GPR00P PTR(31) REG(0),                                   01S1210 04524000
*      GPR01P PTR(31) REG(1);                                   01S1210 04525000
*                                                               01S1210 04526000
*    DECLARE /* COMMON VARIABLES */                             01S1211 04527000
*      I256C CHAR(256) BASED,                                   01S1211 04528000
*      I031F FIXED(31) BASED,                                   01S1211 04529000
*      I031P PTR(31)   BASED,                                   01S1211 04530000
*      I015F FIXED(15) BASED,                                   01S1211 04531000
*      I015P PTR(15)   BASED,                                   01S1211 04532000
*      I008P PTR(8)    BASED,                                   01S1211 04533000
*      I001C CHAR(1)   BASED;                                   01S1211 04534000
*RETURN;                               /* RETURN TO NIP CALLER.      */ 04535000
@EL00001 L     @13,4(,@13)                                      01S1212 04536000
@EF00001 DS    0H                                               01S1212 04537000
@ER00001 LM    @14,@12,12(@13)                                  01S1212 04538000
         BR    @14                                              01S1212 04539000
*/********************************************************************/ 04540000
*/*                                                                  */ 04541000
*/* MACRO-      IEAPSPIO                                             */ 04542000
*/*                                                                  */ 04543000
*/* STATUS-     VERSION DATE=10/24/73, VS/2 RELEASE 2                */ 04544000
*/*                                                                  */ 04545000
*/* FUNCTION-   IEAPSPIO IS PART OF THE  SUPERVISOR                  */ 04546000
*/*             INITIALIZATION PROCESS FOR VS2.                      */ 04547000
*/*                                                                  */ 04548000
*/*             THIS MACRO GENERATES INLINE PL/S STATEMENTS          */ 04549000
*/*             WHICH FORM A SUBROUTINE TO FIND AND READ TEXT        */ 04550000
*/*             RECORDS FROM SYS1.PARMLIB.                           */ 04551000
*/*                                                                  */ 04552000
*/*  REGISTER DEPENDENCIES-                                          */ 04553000
*/*                                                                  */ 04554000
*/*                 1. IEAPSPIO DEPENDS ON THE INCLUDING ROUTINES    */ 04555000
*/*                    BASE REGISTERS FOR ADDRESSABILITY             */ 04556000
*/*                                                                  */ 04557000
*/*                 2. REGISTER 3 MUST CONTAIN THE ADDRESS OF        */ 04558000
*/*                    THE CVT ON ENTRY                              */ 04559000
*/*                                                                  */ 04560000
*/*                 3. REGISTER 2 MUST CONTAIN THE ADDRESS OF        */ 04561000
*/*                    THE NVT ON ENTRY                              */ 04562000
*/*                                                                  */ 04563000
*/*                 4. REGISTER 14 MUST CONTAIN THE ADDRESS OF       */ 04564000
*/*                    THE CALLERS RETURN POINT ON ENTRY             */ 04565000
*/*                                                                  */ 04566000
*/* ENTRY POINTS-                                                    */ 04567000
*/*                                                                  */ 04568000
*/*    TWO CALLING SEQUENCRS ARE AVAILABLE.  ONE PROVIDES            */ 04569000
*/*    COMPATIBILITY WITH THE VS2-1 VERSION OF THIS MACRO,           */ 04570000
*/*    THE OTHER CALLING SEQUENCE WAS DEVELOPED EXPRESSLY            */ 04571000
*/*    FOR VS2-2.                                                    */ 04572000
*/*                                                                  */ 04573000
*/*        VS2-1 COMPATIBLE VERSION-                                 */ 04574000
*/*                                                                  */ 04575000
*/*            1. CALL NIPPMPDS TO LOCATE (VIA BLDL) THE MEMBER      */ 04576000
*/*               OF SYS1.PARMLIB                                    */ 04577000
*/*                                                                  */ 04578000
*/*            2. CALL NIPPMTXT TO READ A TEXT RECORD FROM           */ 04579000
*/*               SYS1.PARMLIB                                       */ 04580000
*/*                                                                  */ 04581000
*/*        VS2-2 VERSION-                                            */ 04582000
*/*                                                                  */ 04583000
*/*            1. CALL NIPPMMEM TO LOCATE THE MEMBER AND RETURN      */ 04584000
*/*               A TEXT RECORD                                      */ 04585000
*/*                                                                  */ 04586000
*/*            2. REPEAT CALL TO NIPPMMEM TO READ ADDITIONAL         */ 04587000
*/*               TEXT RECORDS                                       */ 04588000
*/*                                                                  */ 04589000
*/* OUTPUT (NORMAL) -                                                */ 04590000
*/*                                                                  */ 04591000
*/*     THE ROUTINE WILL SAVE AND RESTORE ALL GENERAL REGISTERS      */ 04592000
*/*     WITH THE EXCEPTION OF RPARM.  ON A SUCCESSFUL READ,          */ 04593000
*/*     RPARM (REGISTER 1) WILL BE SET TO POINT TO THE FIRST NON-    */ 04594000
*/*     BLANK CHARACTER IN THE TEXT RECORD.  IF THE RECORD           */ 04595000
*/*     COLUMNS 1 THRU 72 ALL CONTAIN BLANKS, RPARM WILL             */ 04596000
*/*     POINT TO A BLANK IN COLUMN 72.  IF COLUMNS 1 THRU 71         */ 04597000
*/*     ARE BLANK BUT COLUMN 72 IS NON-BLANK, THE ROUTINE            */ 04598000
*/*     WILL AUTOMATICALLY ATTEMPT TO READ THE NEXT RECORD.  IN      */ 04599000
*/*     ALL CASES, COLUMN 72 WILL BE SET TO BLANK AND COLUMN 73 WILL */ 04600000
*/*     BE SET TO X'FF'.                                             */ 04601000
*/*                                                                  */ 04602000
*/* EXIT (NORMAL)-                                                   */ 04603000
*/*                                                                  */ 04604000
*/*     VS2-1 AND VS2-2 VERSIONS RETURN TO THE ADDRESS FOUND         */ 04605000
*/*     IN REGISTER 14 ON ENTRY.                                     */ 04606000
*/*                                                                  */ 04607000
*/* EXIT (ERROR)-                                                    */ 04608000
*/*                                                                  */ 04609000
*/*     VS2-1 COMPATIBLE VERSION-                                    */ 04610000
*/*                                                                  */ 04611000
*/*         RETURN TO THE ADDRESS IN REGISTER 14 +4                  */ 04612000
*/*                                                                  */ 04613000
*/*         NOTE- WHEN AN ERROR OCCURS ON AN ATTEMP TO READ A RECORD */ 04614000
*/*               THAT DOES NOT EXIST (E-O-F),                       */ 04615000
*/*               IT IS CONSIDERED A PERMANENT I/O ERROR             */ 04616000
*/*                                                                  */ 04617000
*/*     VS2-2 VERSION-                                               */ 04618000
*/*                                                                  */ 04619000
*/*        RETURN TO THE ADDRESS FOUND IN REGISTER 14 ON ENTRY       */ 04620000
*/*        WITH REGISTER 1 (RPARM) SET TO A NEGATIVE VALUE.  IN THE  */ 04621000
*/*        CASE WHERE RPARM IS NEGATIVE ON RETURN, THE NIPPARC FIELD */ 04622000
*/*        OF THE NIP PATAMETER AREA WILL INDICATE THE REASON FOR    */ 04623000
*/*        FAILURE AS FOLLOWS-                                       */ 04624000
*/*                            4 - MEMBER NOT FOUND                  */ 04625000
*/*                            8 - I/O ERROR DURING BLDL             */ 04626000
*/*                            12- I/O ERROR DURING READ             */ 04627000
*/*                            16- END-OF-FILE                       */ 04628000
*/*                                                                  */ 04629000
*/*     COMMON TO BOTH VERSIONS-                                     */ 04630000
*/*                                                                  */ 04631000
*/*        AN INTERPRETIVE MESSAGE WILL BE WRITTEN TO THE OPERATOR   */ 04632000
*/*        FOR EACH OF THE FIRST THREE ERROR CONDITIONS LISTED       */ 04633000
*/*        ABOVE.  THE CALLER MAY SUPPRESS THE 'MEMBER NOT FOUND'    */ 04634000
*/*        MESSAGE BY SETTING THE NIPPAFL1 FLAG FIELD TO BINARY      */ 04635000
*/*        ONE IN THE NIP PARAMETER AREA BEFORE CALLING THIS         */ 04636000
*/*        ROUTINE.  NO MESSAGE WILL BE WRITTEN FOR THE E-O-F        */ 04637000
*/*        CONDITION IF THE VS2-2 VERSION IS USED.                   */ 04638000
*/*                                                                  */ 04639000
*/* MACROS-                                                          */ 04640000
*/*     THE FOLLOWING MAPPING MACROS MUST BE                         */ 04641000
*/*     INCLUDED IN THE MODULE WHICH INCLUDES                        */ 04642000
*/*     IEAPSPIO-                                                    */ 04643000
*/*                                       IEZIOB                     */ 04644000
*/*                                       IHANVT                     */ 04645000
*/*                                       IHAECB                     */ 04646000
*/*                                       IEAPPNIP                   */ 04647000
*/*                                       IEFUCBOB                   */ 04648000
*/*                                       CVT                        */ 04649000
*/*                                                                  */ 04650000
*/* NOTES-                                                           */ 04651000
*/*        THE FIRST FOUR LETTERS OF ALL IEAPSPIO SYMBOLES ARE:      */ 04652000
*/*        NIPP OR IPPM.                                             */ 04653000
*/*                                                                  */ 04654000
*/*        REGISTERS 0, 1, 14, AND 15 WILL BE UNRESTRICTED AT THE    */ 04655000
*/*        END OF THE SEGMENT GENERATED BY IEAPSPIO.                 */ 04656000
*/*                                                                  */ 04657000
*/*        NIPPAREA WILL BE BASED ON NVTPAREA AND IOBSTDRD WILL BE   */ 04658000
*/*        BASED ON THE ADDR OF NIPPAIOB AT THE END OF THE SEGMENT   */ 04659000
*/*        GENERATED BY IEAPSPIO                                     */ 04660000
*/*                                                                  */ 04661000
*/*        IEAPSPIO MUST BE INCLUDED IN A CODE SEGMENT,              */ 04662000
*/*        NOT AT THE TOP OF THE PROCEDURE WITH THE                  */ 04663000
*/*        MAPPING MACROS LISTED ABOVE.                              */ 04664000
*/*                                                            Y02752*/ 04665000
*/********************************************************************/ 04666000
*                                                               02S1213 04667000
*                                                               02S1213 04668000
*                                                               02S1213 04669000
*          /* REGISTERS                                              */ 04670000
*          DCL NIPPMR00 REG(0) PTR(24);                         02S1213 04671000
*          DCL NIPPMR01 REG(1) PTR(24);                         02S1214 04672000
*          DCL NIPPMR02 REG(2) PTR(24);                         02S1215 04673000
*          DCL NIPPMR06 REG(6) PTR(24);                         02S1216 04674000
*          DCL NIPPMR09 REG(9) PTR(24);                         02S1217 04675000
*          DCL NIPPMR12 REG(12) PTR(24);                        02S1218 04676000
*          DCL NIPPMR13 REG(13) PTR(24);                        02S1219 04677000
*          DCL NIPPMR14 REG(14) PTR(24);                        02S1220 04678000
*          DCL NIPPMR15 REG(15) PTR(24);                        02S1221 04679000
*                                                               02S1221 04680000
*          /* SAVE AREA FOR CALLER'S REGISTERS                       */ 04681000
*          DCL NIPPMREG (16) FIXED(31);                         02S1222 04682000
*                                                               02S1222 04683000
*                                                               02S1222 04684000
*          /* SAVE AREA FOR CALLER'S RETURN ADDRESS                  */ 04685000
*          DCL NIPPMADR PTR(31);                                02S1223 04686000
*                                                               02S1223 04687000
*          /* POINTER TO DCB FOR BLDL                                */ 04688000
*          DCL NIPPMDCB PTR(31);                                02S1224 04689000
*                                                               02S1224 04690000
*          /* POINTER TO BLDL HEADER FOR BLDL                        */ 04691000
*          DCL NIPPMBDL PTR(31);                                02S1225 04692000
*                                                               02S1225 04693000
*          /* NORMAL RETURN TO CALLER                                */ 04694000
*          DCL NIPPMAD0 LABEL BASED(NIPPMADR);                  02S1226 04695000
*                                                               02S1226 04696000
*          /* ERROR RETURN TO CALLER                                 */ 04697000
*          DCL NIPPMAD4 LABEL BASED(NIPPMADR+4);                02S1227 04698000
*                                                               02S1227 04699000
*          /* ESTABLISH BASE FOR NIP COMMUNICATION AREA        Y02752*/ 04700000
*          RESPECIFY NIPPAREA BASED(NVTPAREA);              /* Y02752*/ 04701000
*                                                               02S1228 04702000
*          /* ONE BYTE SCANNING FIELD                                */ 04703000
*          DCL NIPPMBYT CHAR(1) BASED;                          02S1229 04704000
*                                                               02S1229 04705000
*          /* TEMPORARY POINTER                                Y02752*/ 04706000
*          DCL NIPPMKPR PTR(31);                            /* Y02752*/ 04707000
*                                                               02S1230 04708000
*                                                               02S1230 04709000
*          /* INPUT RECORD READ FROM PARMLIB                   Y02752*/ 04710000
*          DCL NIPPMBUF CHAR(80) BASED(NIPPMR01);           /* Y02752*/ 04711000
*                                                               02S1231 04712000
*          /* MBBCCHHR OF PARMLIB MEMBERS                            */ 04713000
*          DCL 1 NIPPMMBC CHAR(8),                              02S1232 04714000
*                2 NIPPMMBB CHAR(3),                            02S1232 04715000
*                2 NIPPMCCH CHAR (5);                           02S1232 04716000
*                                                               02S1232 04717000
*           /*  CCHHR OF PARMLIB MEMBERS  @ZA07472  */          02S1233 04718000
*     DCL 1 NIPPMSID BDY(WORD) CHAR(5) BASED(ADDR(NIPPASID)), /*        04719000
*                               @ZA07472  */                    02S1233 04720000
*       2   NIPPMCC FIXED(15),  /* CYLINDER # OF SEARCH ID @ZA07472  */ 04721000
*      2  NIPPMHH CHAR(2),  /* HEAD # OF SEARCH ID @ZA07472 */  02S1233 04722000
*     2  NIPPMR CHAR(1); /* RECORD # OF SEARCH ID @ZA07472 */   02S1233 04723000
*                                                               02S1233 04724000
*          /* LOW ORDER 7 BYTES OF THE CSW STORED IN THE PARMLIB        04725000
*             IOB BY EXCP                                      Y02752*/ 04726000
*          DCL 1 NIPPMCSW BASED(ADDR(IOBCSW)) BDY(BYTE),    /* Y02752*/ 04727000
*                2 * CHAR(3),                               /* Y02752*/ 04728000
*                2 NIPPMCS2 BIT(8),   /* I/O OPERATION STATUS FLAGS     04729000
*                                                           /* Y02752*/ 04730000
*                2 * CHAR(3);                               /* Y02752*/ 04731000
*                                                               02S1234 04732000
*          /* MASKS TO TEST THE STATUS FLAGS OF THE PARMLIB CSW Y02752* 04733000
*          DCL  NIPPMMK1 BIT(8) BDY(BYTE) INIT('11110010'B);/* Y02752*/ 04734000
*           DCL NIPPMMK2 BIT(8) BDY(BYTE) INIT('11110001'B); /*@ZA07472 04735000
*                              */                               02S1236 04736000
*                                                               02S1236 04737000
*             /* MASK TO TEST THE IOBSENSE FLAGS     @ZA07472 */        04738000
*      DCL NIPPMMK3 BIT(8) BDY(BYTE) INIT('00100000'B); /*      02S1237 04739000
*                         @ZA07472 */                           02S1237 04740000
*                                                               02S1237 04741000
*          /* INTERNALLY GENERATED LABELS                            */ 04742000
*          DCL NIPPMMB1 LABEL GENERATED INTERNAL;               02S1238 04743000
*          DCL NIPPMMB2 LABEL GENERATED INTERNAL;               02S1239 04744000
*          DCL NIPPMTND LABEL GENERATED INTERNAL;               02S1240 04745000
*                                                               02S1240 04746000
*          /* MAPPING AREAS INTO ERROR MESSAGES                      */ 04747000
*          DCL NIPPMME1 CHAR(8) BASED(ADDR(NIPPMMB1));          02S1241 04748000
*          DCL NIPPMME2 CHAR(8) BASED(ADDR(NIPPMMB2));          02S1242 04749000
*          DCL NIPPMNAM CHAR(8) INIT(' '); /*MEMBER NAME SAVE AREA      04750000
*                                                              Y02752*/ 04751000
*          DCL NIPPMNEG FIXED(31) INIT('FFFFFFFF'X); /*NEGATIVE VALUE   04752000
*                                                              Y02752*/ 04753000
*         RESPECIFY IOBSTDRD BASED(ADDR(NIPPAIOB));/* IOB BASE Y02752*/ 04754000
*                                                               02S1245 04755000
*         RESPECIFY (NIPPMR14,NIPPMR15,NIPPMR00,NIPPMR01) RESTRICTED;/* 04756000
*                                                              Y02752*/ 04757000
*NIPPMMEM: NIPPMADR=NIPPMR14;  /* SAVE CALLER'S RETURN REGISTER 02S1247 04758000
*                                                              Y02752*/ 04759000
NIPPMMEM ST    NIPPMR14,NIPPMADR                                02S1247 04760000
*         GENERATE REFS(NIPPMR01,NIPPMR02) SETS(NIPPMREG);      02S1248 04761000
          STM   NIPPMR02,NIPPMR01,NIPPMREG   SAVE REGISTERS     Y02752  04762000
*          NIPPARC=NIPPARC && NIPPARC; /*SET RETURN CODE TO ZERO        04763000
*                                                              Y02752*/ 04764000
         L     @10,NVTPAREA(,RNVT)                              02S1249 04765000
         L     @05,NIPPARC(,@10)                                02S1249 04766000
         LR    @07,@05                                          02S1249 04767000
         XR    @07,@05                                          02S1249 04768000
         ST    @07,NIPPARC(,@10)                                02S1249 04769000
*          IF NIPPMNAM = NIPPANAM      /*IS THIS NEW MEMBER NAME        04770000
*                                                              Y02752*/ 04771000
*              THEN GO TO NIPPMPRD;    /*NO- GO READ RECORD    Y02752*/ 04772000
         CLC   NIPPMNAM(8),NIPPANAM(@10)                        02S1250 04773000
         BE    @RT01250                                         02S1250 04774000
*          NIPPMNAM = NIPPANAM;        /*YES- SAVE MEMBER NAME Y02752*/ 04775000
         MVC   NIPPMNAM(8),NIPPANAM(@10)                        02S1252 04776000
*          GO TO NIPPMENT;             /*GO FIND MEMBER        Y02752*/ 04777000
*                                                               02S1253 04778000
         B     NIPPMENT                                         02S1253 04779000
*NIPPMPDS: NIPPMADR = NIPPMR14;          /* SAVE CALLER'S RETURN ADDR*/ 04780000
NIPPMPDS ST    NIPPMR14,NIPPMADR                                02S1254 04781000
*          GENERATE REFS(NIPPMR01,NIPPMR02) SETS(NIPPMREG);     02S1255 04782000
         STM   NIPPMR02,NIPPMR01,NIPPMREG       SAVE REGS       Y02752  04783000
*          NIPPMNAM = NIPPMNAM && NIPPMNAM;  /*CLEAR MEMBER NAME        04784000
*                                                              Y02752*/ 04785000
         XC    NIPPMNAM(8),NIPPMNAM                             02S1256 04786000
*NIPPMENT: NIPPMR01 = ADDR(NIPPADCB) - 44;      /* R1= ADDR OF DCB   */ 04787000
NIPPMENT L     @10,NVTPAREA(,RNVT)                              02S1257 04788000
         LA    NIPPMR01,NIPPADCB(,@10)                          02S1257 04789000
         SH    NIPPMR01,@CH00325                                02S1257 04790000
*          NIPPMR00 = ADDR(NIPPABDL);    /* R0= ADDR OF BLDL LIST    */ 04791000
*                                                               02S1258 04792000
         LA    NIPPMR00,NIPPABDL(,@10)                          02S1258 04793000
*          /* READ PDS ENTRY FOR MEMBER                              */ 04794000
*          GENERATE;                                            02S1259 04795000
          BLDL (1),(0)                                                  04796000
*          NIPPARC = NIPPMR15;   /* SET RETURN CODE            Y02752*/ 04797000
*                                                               02S1260 04798000
         L     @10,NVTPAREA(,RNVT)                              02S1260 04799000
         ST    NIPPMR15,NIPPARC(,@10)                           02S1260 04800000
*          IF NIPPMR15 = 4               /* WAS MEMBER NAME FOUND       04801000
*                                                              Y02752*/ 04802000
*             THEN GO TO NIPPMPFN;       /* NO - TELL OPERATOR NOT      04803000
*                                           FOUND                    */ 04804000
         CH    NIPPMR15,@CH00036                                02S1261 04805000
         BE    @RT01261                                         02S1261 04806000
*          IF NIPPMR15 = 8               /* WAS THERE AN I/O ERROR   */ 04807000
*             THEN GO TO NIPPMPER;       /* YES - TELL OPERATOR 02S1263 04808000
*                                           I/O ERROR                */ 04809000
*                                                               02S1263 04810000
         CH    NIPPMR15,@CH00035                                02S1263 04811000
         BE    @RT01263                                         02S1263 04812000
*          /* SET UP PARAMETERS FOR CONVERSION ROUTINE               */ 04813000
*                                                               02S1265 04814000
*          NIPPMR00 = NIPPATTR;          /* R0 = ACTUAL TTR          */ 04815000
         MVC   @ZT00001+1(3),NIPPATTR(@10)                      02S1265 04816000
         L     NIPPMR00,@ZT00001                                02S1265 04817000
*          GENERATE;                                            02S1266 04818000
         SLL   0,8(0)                    ZERO LOW BYTE IN REG 0         04819000
*          NIPPMR01 = ADDR(NIPPADEB);    /* R1 = ADDR OF DEB         */ 04820000
         L     NIPPMR01,NVTPAREA(,RNVT)                         02S1267 04821000
         LA    NIPPMR01,NIPPADEB(,NIPPMR01)                     02S1267 04822000
*          NIPPMR15 = CVTPCNVT;          /* R15 = ADDR OF CONVERSION    04823000
*                                           ROUTINE            Y02752*/ 04824000
         L     @10,CVTPTR                                       02S1268 04825000
         L     NIPPMR15,CVTPCNVT(,@10)                          02S1268 04826000
*          /* CONVERT TTR TO CCHHR FORMAT                      Y02752*/ 04827000
*          GENERATE REFS(NIPPMR02,NIPPMR13)                     02S1269 04828000
*                    SETS(NIPPMR14,NIPPMR15,NIPPMMBC);     /*   02S1269 04829000
*                                                               02S1269 04830000
         STM   NIPPMR02,NIPPMR13,NIPPMSAV SAVE REGISTERS        Y02752  04831000
         LA    NIPPMR02,NIPPMMBC          CONVERSION AREA       Y02752  04832000
         BALR  NIPPMR14,NIPPMR15          CALL CONVERT RTN      Y02752  04833000
**         RESTORE CSECT AND DSECT BASE REGISTERS               Y02752  04834000
*NIPPMRST  DS  0H                                               Y02752  04835000
NIPPMRST LM    NIPPMR02,NIPPMR13,NIPPMSAV-NIPPMRST(NIPPMR14)    Y02752  04836000
         BC    15,NIPPMSKP                SKIP SAVE AREA        Y02752  04837000
*NIPPMSAV  DS  0F                                               Y02752  04838000
NIPPMSAV DC    12F'0'                     DECLARE REG SAVE AREA Y02752  04839000
*NIPPMSKP DS  0H                                                Y02752  04840000
NIPPMSKP DS    0H                         RESUME EXECUTION      Y02752  04841000
*          IOBSEEK = NIPPMMBC;           /* RESET PARMLIB IOBSEEK TO    04842000
*                                           THIS MBBCCHHR            */ 04843000
         L     @10,NVTPAREA(,RNVT)                              02S1270 04844000
         MVC   IOBSEEK+72(8,@10),NIPPMMBC                       02S1270 04845000
*          NIPPASID = NIPPMCCH;          /* RESET PARMLIB SEARCH ID     04846000
*                                           TO THIS CCHHR            */ 04847000
         MVC   NIPPASID(5,@10),NIPPMCCH                         02S1271 04848000
*          IF NIPPMNAM = NIPPANAM   /*SEE IF MEM NAMES MATCH   Y02752*/ 04849000
*              THEN GO TO NIPPMPRD; /*YES- NEW VERSION- GO READ 02S1272 04850000
*                                                              Y02752*/ 04851000
         CLC   NIPPMNAM(8),NIPPANAM(@10)                        02S1272 04852000
         BE    @RT01272                                         02S1272 04853000
*         GENERATE REFS(NIPPMR01,NIPPMR02) SETS(NIPPMREG);      02S1274 04854000
          LM    NIPPMR02,NIPPMR01,NIPPMREG    RESTORE REGS      Y02752  04855000
*          GO TO NIPPMAD0;               /* NORMAL RETURN TO CALLER     04856000
*                                                              Y02752*/ 04857000
*                                                               02S1275 04858000
         L     @10,NIPPMADR                                     02S1275 04859000
         BR    @10                                              02S1275 04860000
*NIPPMPER: NIPPMME1 = NIPPANAM;          /* MOVE MEMBER NAME TO I/O     04861000
*                                           ERROR MESSAGE            */ 04862000
*                                                               02S1276 04863000
NIPPMPER LA    @10,NIPPMMB1                                     02S1276 04864000
         L     @05,NVTPAREA(,RNVT)                              02S1276 04865000
         MVC   NIPPMME1(8,@10),NIPPANAM(@05)                    02S1276 04866000
*          /* WTO I/O ERROR DURING BLDL MESSAGE                      */ 04867000
*          GENERATE REFS(NVTWTO) SETS(RPARM,REXIT,RENTRY);      02S1277 04868000
*                                                               02S1277 04869000
          IEAPMNIP TYPE=WTO,PARAM=NIPPMMS1 CALL WTO SERVICE ROUTINE     04870000
*          GO TO NIPPMPXT;               /* ERROR RETURN TO CALLER   */ 04871000
*                                                               02S1278 04872000
         B     NIPPMPXT                                         02S1278 04873000
*NIPPMPFN: IF NIPPMNAM = NIPPANAM  /*SEE IF MEMBER NAMES MATCH Y02752*/ 04874000
*              THEN IF NIPPAFL1 = '1'B  /*YES- SUPPRESS MESSAGE?        04875000
*                                                              Y02752*/ 04876000
NIPPMPFN L     @10,NVTPAREA(,RNVT)                              02S1279 04877000
         CLC   NIPPMNAM(8),NIPPANAM(@10)                        02S1279 04878000
         BNE   @RF01279                                         02S1279 04879000
*                 THEN GO TO NIPPMPXT;  /*YES- GO EXIT TO CALLER        04880000
*                                                              Y02752*/ 04881000
         L     @10,NVTPTAB(,RNVT)                               02S1280 04882000
         TM    NIPPAFL1(@10),B'10000000'                        02S1280 04883000
         BO    @RT01280                                         02S1280 04884000
*                 ELSE;                                     /* Y02752*/ 04885000
*          NIPPMME2 = NIPPANAM;          /* MOVE MEMBER NAME TO NOT     04886000
*                                           FOUND MESSAGE      Y02752*/ 04887000
*                                                               02S1283 04888000
@RF01279 LA    @10,NIPPMMB2                                     02S1283 04889000
         L     @05,NVTPAREA(,RNVT)                              02S1283 04890000
         MVC   NIPPMME2(8,@10),NIPPANAM(@05)                    02S1283 04891000
*          /* WTO MEMBER NOT FOUND IN DATA SET MESSAGE               */ 04892000
*          GENERATE REFS(NVTWTO) SETS(RPARM,REXIT,RENTRY);      02S1284 04893000
          IEAPMNIP TYPE=WTO,PARAM=NIPPMMS2 CALL WTO SERVICE ROUTINE     04894000
*NIPPMPXT: IF NIPPMNAM = NIPPANAM   /*SEE IF NAMES MATCH       Y02752*/ 04895000
*             THEN DO;                                          02S1285 04896000
NIPPMPXT L     @10,NVTPAREA(,RNVT)                              02S1285 04897000
         CLC   NIPPMNAM(8),NIPPANAM(@10)                        02S1285 04898000
         BNE   @RF01285                                         02S1285 04899000
*                     NIPPMNAM = NIPPMNAM && NIPPMNAM; /* FORCE NEW     04900000
*                                            NAME PATH ON NEXT ENTRY    04901000
*                                                              Y02752*/ 04902000
         XC    NIPPMNAM(8),NIPPMNAM                             02S1287 04903000
*                     NIPPMR01 = NIPPMNEG;  /* SET NEGATIVE VALUE RC    04904000
*                                                              Y02752*/ 04905000
         L     NIPPMR01,NIPPMNEG                                02S1288 04906000
*                     GENERATE SETS(NIPPMR02,NIPPMR00) REFS(NIPPMREG);  04907000
          LM    NIPPMR02,NIPPMR00,NIPPMREG    RESTORE REGS      Y02752  04908000
*                     GO TO NIPPMAD0;   /*EXIT TO CALLER       Y02752*/ 04909000
         L     @10,NIPPMADR                                     02S1290 04910000
         BR    @10                                              02S1290 04911000
*                  END;                                     /* Y02752*/ 04912000
*          GENERATE SETS(NIPPMR02,NIPPMR01) REFS(NIPPMREG); /* Y02752*/ 04913000
@RF01285 DS    0H                                               02S1292 04914000
         LM    NIPPMR02,NIPPMR01,NIPPMREG     RESTORE REGS      Y02752  04915000
*          GO TO NIPPMAD4;               /* READ ERROR - RETURN TO      04916000
*                                           CALLER                   */ 04917000
         L     @10,NIPPMADR                                     02S1293 04918000
         LA    @10,NIPPMAD4+4(,@10)                             02S1293 04919000
         BR    @10                                              02S1293 04920000
*                                                               02S1294 04921000
*          /**********************************************************/ 04922000
*          /*             ROUTINE TO READ PARMLIB TEXT               */ 04923000
*          /**********************************************************/ 04924000
*                                                               02S1294 04925000
*NIPPMTXT: NIPPMADR = NIPPMR14;          /* SAVE CALLER'S RETURN        04926000
*                                           ADDRESS                  */ 04927000
NIPPMTXT ST    NIPPMR14,NIPPMADR                                02S1294 04928000
*          GENERATE REFS(NIPPMR02,NIPPMR01) SETS(NIPPMREG);     02S1295 04929000
         STM   NIPPMR02,NIPPMR01,NIPPMREG   SAVE CALLERS REGS           04930000
*NIPPMPRD: NIPPAECB = NIPPAECB && NIPPAECB;   /* ZERO WAIT ECB       */ 04931000
NIPPMPRD L     @10,NVTPAREA(,RNVT)                              02S1296 04932000
         XC    NIPPAECB(4,@10),NIPPAECB(@10)                    02S1296 04933000
*          IOBSEEK(4:7) = NIPPASID;         /* FILL IN CCHH IN IOB   */ 04934000
*                                                               02S1297 04935000
         LA    @05,72                                           02S1297 04936000
         ALR   @05,@10                                          02S1297 04937000
         MVC   IOBSEEK+3(4,@05),NIPPASID(@10)                   02S1297 04938000
*          /* REINITIALIZE IOB FLAGS                                 */ 04939000
*                                                               02S1298 04940000
*          IOBFLAG1 = '42'X;                                    02S1298 04941000
         MVI   IOBFLAG1(@05),X'42'                              02S1298 04942000
*          IOBFLAG2 = '00'X;                                    02S1299 04943000
         MVI   IOBFLAG2(@05),X'00'                              02S1299 04944000
*          IOBFLAG3 = '00'X;                                    02S1300 04945000
         MVI   IOBFLAG3(@05),X'00'                              02S1300 04946000
*          IOBERRCT = '0000'X;                                  02S1301 04947000
         SLR   @07,@07                                          02S1301 04948000
         STH   @07,IOBERRCT(,@05)                               02S1301 04949000
*          IOBCSW = '00000000000000'X;                          02S1302 04950000
         MVC   IOBCSW(7,@05),@CB02631                           02S1302 04951000
*          IOBSENS0 = '00'X;                                    02S1303 04952000
         MVI   IOBSENS0(@05),X'00'                              02S1303 04953000
*          IOBSENS1 = '00'X;                                    02S1304 04954000
*                                                               02S1304 04955000
         MVI   IOBSENS1(@05),X'00'                              02S1304 04956000
*          /* READ PARMLIB TEXT RECORD                               */ 04957000
*          NIPPMR01 = ADDR(NIPPAIOB);                           02S1305 04958000
         LA    NIPPMR01,NIPPAIOB(,@10)                          02S1305 04959000
*          GENERATE;                                            02S1306 04960000
          EXCP  (1)                 READ TEXT                           04961000
*          NIPPMR01 = ADDR(NIPPAECB);                           02S1307 04962000
         L     NIPPMR01,NVTPAREA(,RNVT)                         02S1307 04963000
         LA    NIPPMR01,NIPPAECB(,NIPPMR01)                     02S1307 04964000
*          GENERATE;                                            02S1308 04965000
          WAIT  ECB=(1)                  AWAIT I/O COMPLETION           04966000
*          /* TEST FOR I/O ERROR AFTER PARMLIB READ            Y02752*/ 04967000
*          IF NIPPAECC ^= '7F'X          /* SKIP IF READ SUCCESSFUL     04968000
*                                                              Y02752*/ 04969000
*             THEN                                              02S1309 04970000
         L     @10,NVTPAREA(,RNVT)                              02S1309 04971000
         CLI   NIPPAECC(@10),X'7F'                              02S1309 04972000
         BE    @RF01309                                         02S1309 04973000
*             DO;                                               02S1310 04974000
*               IF NIPPMNAM = NIPPANAM   /* SEE IF MEMBER NAMES MATCH   04975000
*                                                              Y02752*/ 04976000
*               THEN                                            02S1311 04977000
         CLC   NIPPMNAM(8),NIPPANAM(@10)                        02S1311 04978000
         BNE   @RF01311                                         02S1311 04979000
*               DO;                                             02S1312 04980000
*                 /* DOES THE I/O ERROR REPRESENT EOF          Y02752*/ 04981000
*                 IF NIPPAECC = '41'X &   /* IOBCSW FIELD VALID?     */ 04982000
*                    /* FALL THROUGH IF UNIT EXCEPTION, CHANNEL END     04983000
*                       AND DEVICE END FLAGS ARE ON IN THE IOBCSW    */ 04984000
*                    (NIPPMCS2 | NIPPMMK1) = 'FF'X              02S1313 04985000
*                    THEN                                       02S1313 04986000
         CLI   NIPPAECC(@10),X'41'                              02S1313 04987000
         BNE   @RF01313                                         02S1313 04988000
         MVC   @TS00001(1),NIPPMCS2+81(@10)                     02S1313 04989000
         OC    @TS00001(1),NIPPMMK1                             02S1313 04990000
         CLI   @TS00001,X'FF'                                   02S1313 04991000
         BNE   @RF01313                                         02S1313 04992000
*                      DO;                                      02S1314 04993000
*                        NIPPARC = 16;   /* INDICATE EOF CONDITION      04994000
*                                                              Y02752*/ 04995000
         MVC   NIPPARC(4,@10),@CF00080                          02S1315 04996000
*                        GOTO NIPPMPXT;  /* RETURN TO CALLER   Y02752*/ 04997000
         B     NIPPMPXT                                         02S1316 04998000
*                      END;                                 /* Y02752*/ 04999000
*              /* DOES THE I/O ERROR REPRESENT END OF CYL? @ZA07472 */  05000000
*              IF NIPPAECC='41'X&                /* @ZA07472 */ 02S1318 05001000
*              (NIPPMCS2|NIPPMMK2)='FF'X&        /* @ZA07472 */ 02S1318 05002000
*              (IOBSENS1&NIPPMMK3)= '20'X THEN         /* @ZA07472 */   05003000
@RF01313 L     @10,NVTPAREA(,RNVT)                              02S1318 05004000
         CLI   NIPPAECC(@10),X'41'                              02S1318 05005000
         BNE   @RF01318                                         02S1318 05006000
         MVC   @TS00001(1),NIPPMCS2+81(@10)                     02S1318 05007000
         OC    @TS00001(1),NIPPMMK2                             02S1318 05008000
         CLI   @TS00001,X'FF'                                   02S1318 05009000
         BNE   @RF01318                                         02S1318 05010000
         MVC   @TS00001(1),IOBSENS1+72(@10)                     02S1318 05011000
         NC    @TS00001(1),NIPPMMK3                             02S1318 05012000
         CLI   @TS00001,X'20'                                   02S1318 05013000
         BNE   @RF01318                                         02S1318 05014000
*               /* IF YES, MAKE SEEK ADDRESS POINT TO START OF NEXT     05015000
*                              CYLINDER @ZA07472 */             02S1319 05016000
*               DO;      /* @ZA07472 */                         02S1319 05017000
*               NIPPMCC=NIPPMCC+1;          /* INCREMENT SEEK@ TO NEXT  05018000
*                CYL, @ZA07472 */                               02S1320 05019000
         AH    @10,@CH02653                                     02S1320 05020000
         LA    @05,1                                            02S1320 05021000
         AH    @05,NIPPMCC(,@10)                                02S1320 05022000
         STH   @05,NIPPMCC(,@10)                                02S1320 05023000
*            NIPPMHH=NIPPMHH&&NIPPMHH;  /* HEAD 0, @ZA07472 */  02S1321 05024000
         XC    NIPPMHH(2,@10),NIPPMHH(@10)                      02S1321 05025000
*                   NIPPMR='01'X;        /*  AND RECORD 1   @ZA07472 */ 05026000
         MVI   NIPPMR(@10),X'01'                                02S1322 05027000
*                   GOTO NIPPMRCR;   /* CONTINUE TO PROCESS TEXT        05028000
*                                   @ZA07472 */                 02S1323 05029000
         B     NIPPMRCR                                         02S1323 05030000
*                    END;  /* @ZA07472 */                       02S1324 05031000
*                  END;                                     /* Y02752*/ 05032000
*                 GOTO NIPPMTER;         /* INDICATE I/O ERROR Y02752*/ 05033000
         B     NIPPMTER                                         02S1326 05034000
*               END;                                        /* Y02752*/ 05035000
*          RESPECIFY NIPPMBYT BASED(NIPPMR01);                  02S1328 05036000
@RF01309 DS    0H                                               02S1329 05037000
*           NIPPMRCR:      /* @ZA07472 */                       02S1329 05038000
*                                                               02S1329 05039000
*          NIPPMR01 = ADDR(NIPPARCD);    /* R1 = ADDR OF TEXT RECORD    05040000
*                                           READ IN                  */ 05041000
*                                                               02S1329 05042000
NIPPMRCR L     NIPPMR01,NVTPAREA(,RNVT)                         02S1329 05043000
         LA    NIPPMR01,NIPPARCD(,NIPPMR01)                     02S1329 05044000
*          /* SCAN THROUGH LEADING BLANK CHARACTERS                  */ 05045000
*          NIPPMBUF(73:73) = 'FF'X;      /* PLACE 'FF'X IN COL 73    */ 05046000
*                                                               02S1330 05047000
         MVI   NIPPMBUF+72(NIPPMR01),X'FF'                      02S1330 05048000
*          NIPPMKPR = 1;                 /* COUNT STARTS AT ONE      */ 05049000
         MVC   NIPPMKPR(4),@CF00042                             02S1331 05050000
*NIPPMPBK: IF NIPPMBYT = ' '             /* IS THIS CHAR BLANK       */ 05051000
*             THEN                       /* YES - CHECK NEXT CHAR    */ 05052000
NIPPMPBK CLI   NIPPMBYT(NIPPMR01),C' '                          02S1332 05053000
         BNE   @RF01332                                         02S1332 05054000
*               DO;                                             02S1333 05055000
*                 NIPPMR01 = NIPPMR01 + 1;      /* POINT TO NEXT CHAR   05056000
*                                                              Y02752*/ 05057000
         LA    @10,1                                            02S1334 05058000
         ALR   NIPPMR01,@10                                     02S1334 05059000
*                NIPPMKPR = NIPPMKPR + 1;      /* INCREMENT COUNTER     05060000
*                                                              Y02752*/ 05061000
         AL    @10,NIPPMKPR                                     02S1335 05062000
         ST    @10,NIPPMKPR                                     02S1335 05063000
*                 IF NIPPMKPR = 72       /* ARE FIRST 71 CHARS BLANK    05064000
*                                                              Y02752*/ 05065000
*                    THEN                /*YES-CHECK FOR CONTINUATION*/ 05066000
         CH    @10,@CH00082                                     02S1336 05067000
         BNE   @RF01336                                         02S1336 05068000
*                      DO;                                      02S1337 05069000
*                        IF NIPPMBYT ^= ' '      /* IS 72'ND CHAR BLK*/ 05070000
*                           THEN                /* NO - INDICATES       05071000
*                                                  CONTINUATION      */ 05072000
         CLI   NIPPMBYT(NIPPMR01),C' '                          02S1338 05073000
         BNE   @RT01338                                         02S1338 05074000
*                                GO TO NIPPMPRD;/* READ NEXT RECORD  */ 05075000
*                           ELSE                /* 72ND IS BLANK - NO   05076000
*                                                  CONTINUATION      */ 05077000
*                               GO TO NIPPMTND; /* REG 1 POINTS TO 72ND 05078000
*                                                  BLANK. NORMAL RETURN 05079000
*                                                  TO CALLER         */ 05080000
         B     NIPPMTND                                         02S1340 05081000
*                      END;                                     02S1341 05082000
*                    ELSE GO TO NIPPMPBK; /* COUNT IS NOT 72 YET-       05083000
*                                            GO CHECK NEXT CHAR      */ 05084000
*               END;                                            02S1343 05085000
*             ELSE                       /* FIRST 71 CHARS ARE NOT   */ 05086000
*               DO;                      /* BLANK                    */ 05087000
@RF01332 DS    0H                                               02S1345 05088000
*                 NIPPMKPR = NIPPMR01 - NIPPMKPR + 72;      /* POINT TO 05089000
*                                                 72'ND BYTE   Y02752*/ 05090000
*                                                               02S1345 05091000
         LR    @10,NIPPMR01                                     02S1345 05092000
         SL    @10,NIPPMKPR                                     02S1345 05093000
         AH    @10,@CH00082                                     02S1345 05094000
         ST    @10,NIPPMKPR                                     02S1345 05095000
*                 RESPECIFY NIPPMBYT BASED(NIPPMKPR);       /* Y02752*/ 05096000
*                                                               02S1346 05097000
*                 NIPPMBYT = ' ';        /* INSURE BLANK AT END BY      05098000
*                                           SETTING 72'ND BYTE TO BLK*/ 05099000
         MVI   NIPPMBYT(@10),C' '                               02S1347 05100000
*               END;                                            02S1348 05101000
*           GENERATE REFS(NIPPMREG) SETS(NIPPMR02,NIPPMR00);     /*     05102000
*NIPPMTND  DS  0H                                               Y02752  05103000
NIPPMTND LM    NIPPMR02,NIPPMR00,NIPPMREG     RESTORE CALLERS REGS      05104000
*          GO TO NIPPMAD0;               /* NORMAL RETURN TO CALLER  */ 05105000
*                                                               02S1350 05106000
         L     @10,NIPPMADR                                     02S1350 05107000
         BR    @10                                              02S1350 05108000
*NIPPMTER: NIPPMR01 = ADDR(NIPPAIOB);    /* R1 = ADDR OF PARMLIB IOB */ 05109000
*                                                               02S1351 05110000
NIPPMTER L     NIPPMR01,NVTPAREA(,RNVT)                         02S1351 05111000
         LA    NIPPMR01,NIPPAIOB(,NIPPMR01)                     02S1351 05112000
*          /* NIPSENSE - FORMAT AND WRITE I/O ERROR MESSAGE          */ 05113000
*          GENERATE REFS(NVTSENSE,NIPPMR01) SETS(RPARM,REXIT,RENTRY);   05114000
         IEAPMNIP TYPE=SENSE,PARAM=NIPPMR01                             05115000
*          NIPPARC = 12;    /*SET RETURN CODE TO 12            Y02752*/ 05116000
         L     @10,NVTPAREA(,RNVT)                              02S1353 05117000
         MVC   NIPPARC(4,@10),@CF00032                          02S1353 05118000
*          IF NIPPMNAM = NIPPANAM  /*SEE IF MEMBER NAMES MATCH Y02752*/ 05119000
*             THEN GO TO NIPPMPXT; /*YES-TAKE NEW VERSION EXIT Y02752*/ 05120000
         CLC   NIPPMNAM(8),NIPPANAM(@10)                        02S1354 05121000
         BE    @RT01354                                         02S1354 05122000
*          GENERATE REFS(NIPPMREG) SETS(NIPPMR01,NIPPMR02);     02S1356 05123000
*                                                               02S1356 05124000
         LM    NIPPMR02,NIPPMR01,NIPPMREG     RESTORE CALLERS REGS      05125000
*          GO TO NIPPMAD4;               /* READ ERROR - RETURN TO      05126000
*                                           CALLER + 4               */ 05127000
*                                                               02S1357 05128000
         L     @10,NIPPMADR                                     02S1357 05129000
         LA    @10,NIPPMAD4+4(,@10)                             02S1357 05130000
         BR    @10                                              02S1357 05131000
*          RESPECIFY (NIPPMR01,NIPPMR00,NIPPMR14,NIPPMR15)  /* Y02752*/ 05132000
*                                                 UNRESTRICTED; 02S1358 05133000
*          /**********************************************************/ 05134000
*          /* GENERATED MACRO PARAMETER LISTS FOR MESSAGES           */ 05135000
*          /**********************************************************/ 05136000
*                                                               02S1359 05137000
*           GENERATE DATA;     /*                               02S1359 05138000
*SETSTAT: PROC;                        /*SET VOLUME ATTRIBS  @Y30LPPD*/ 05139000
         B     @EL00001                                         02S1360 05140000
SETSTAT  STM   @14,@12,12(@13)                                  02S1360 05141000
*/********************************************************************/ 05142000
*/*                                                                  */ 05143000
*/* SEGMENT NAME - SETSTAT                                           */ 05144000
*/*                                                                  */ 05145000
*/* DESCRIPTIVE NAME - SET MOUNT AND USE STATUS IN UCB               */ 05146000
*/*                                                                  */ 05147000
*/* FUNCTION -                                                       */ 05148000
*/*                                                                  */ 05149000
*/*     IF THE VOLUME IS NOT ON A NON-DEMOUNTABLE DEVICE, OR IS      */ 05150000
*/*     NOT ONE THAT THE SYSTEM REQUIRES TO BE PERMANENTLY RESI-     */ 05151000
*/*     DENT, THEN SET THE MOUNT STATUS.  IF THE  MOUNT CHARACTER-   */ 05152000
*/*     ISTIC IN VATLST ENTRY IS 1, THEN SET UCB MOUNT STATUS TO     */ 05153000
*/*     RESERVED. OTHERWISE, SET UCB MOUNT STATUS TO PERMANENTLY     */ 05154000
*/*     RESIDENT.                                                    */ 05155000
*/*                                                                  */ 05156000
*/*     IF USE ATTRIBUTE IN VATLST ENTRY IS 0, THEN UCB USE STATUS   */ 05157000
*/*     IS STORAGE.  IF USE ATTRIBUTE IS 2, THEN UCB USE STATUS IS   */ 05158000
*/*     PRIVATE. OTHERWISE, UCB USE STATUS IS PUBLIC.                */ 05159000
*/*                                                                  */ 05160000
*/* ENTRY - SUBROUTINE                                       @Y30LPPD*/ 05161000
*/*                                                                  */ 05162000
*/*     PURPOSE -                                                    */ 05163000
*/*                                                                  */ 05164000
*/*         SET MOUNT AND USE STATUS, AS INDICATED IN VATLST ENTRY,  */ 05165000
*/*         IN ASSOCIATED UCB.                                       */ 05166000
*/*                                                                  */ 05167000
*/*     INPUT DATA -                                                 */ 05168000
*/*                                                                  */ 05169000
*/*         VATLST ENTRY                                             */ 05170000
*/*         UCBPTR - CONTAINS UCB ADDRESS                            */ 05171000
*/*         UCBPRES - SET ON FOR VOLUMES THE SYSTEM REQUIRES TO BE   */ 05172000
*/*                   PERMANENTLY RESIDENT AND NON-DEMOUNTABLE       */ 05173000
*/*                   DEVICES.                                       */ 05174000
*/*                                                                  */ 05175000
*/* EXITS -                                                          */ 05176000
*/*                                                                  */ 05177000
*/*     CONDITION - NORMAL                                           */ 05178000
*/*                                                                  */ 05179000
*/*     OUTPUT DATA -                                                */ 05180000
*/*                                                                  */ 05181000
*/*         UCB - MODIFIED                                           */ 05182000
*/*                                                                  */ 05183000
*/*     RETURN CODE - NONE                                           */ 05184000
*/*                                                                  */ 05185000
*/********************************************************************/ 05186000
*                                                               02S1361 05187000
*IF UCBPRES = NO                       /*IF VOL IS NOT P/R,          */ 05188000
*  THEN IF EMNTCHAR = RSV              /*SET MOUNT ATTRIBUTE         */ 05189000
         L     @10,UCBPTR                                       02S1361 05190000
         TM    UCBPRES(@10),B'00000100'                         02S1361 05191000
         BNZ   @RF01361                                         02S1361 05192000
*    THEN DO;                          /*TO RESERVED IF COL 8 OF     */ 05193000
         L     @05,MAPAD                                        02S1362 05194000
         CLI   EMNTCHAR(@05),C'1'                               02S1362 05195000
         BNE   @RF01362                                         02S1362 05196000
*      UCBRESV = YES;                  /*ENTRY IS EQUAL TO ONE, AND  */ 05197000
*      UCBPRES = NO;                   /*TURN OFF PERMANENTLY   02S1365 05198000
*                                        RESIDENT ATTRIBUTE.         */ 05199000
         OI    UCBRESV(@10),B'00100000'                         02S1365 05200000
         NI    UCBPRES(@10),B'11111011'                         02S1365 05201000
*    END;                                                       02S1366 05202000
*    ELSE DO;                          /*IF COL 8 ^= 1 THEN          */ 05203000
         B     @RC01362                                         02S1367 05204000
@RF01362 DS    0H                                               02S1368 05205000
*      UCBPRES = YES;                  /*SET DEFAULT ATTRIBUTE -        05206000
*                                        PERMANENTLY RESIDENT AND    */ 05207000
*      UCBRESV = NO;                   /*TURN OFF RESERVED ATTRIBUTE */ 05208000
         L     @10,UCBPTR                                       02S1369 05209000
         OI    UCBPRES(@10),B'00000100'                         02S1369 05210000
         NI    UCBRESV(@10),B'11011111'                         02S1369 05211000
*    END;                                                       02S1370 05212000
*                                                               02S1370 05213000
*UCBBSTR = NO;                         /*TURN OFF USE ATTRIBUTES     */ 05214000
@RC01362 DS    0H                                               02S1371 05215000
@RF01361 DS    0H                                               02S1372 05216000
*UCBBPRV = NO;                                                  02S1372 05217000
*UCBBPUB = NO;                                                  02S1373 05218000
*                                                               02S1373 05219000
         L     @10,UCBPTR                                       02S1373 05220000
         NI    UCBBSTR(@10),B'11100011'                         02S1373 05221000
*IF EUSEATTR = STR                     /*SET USE ATTRIBUTES          */ 05222000
*  THEN                                /*IF COL 10 OF ENTRY = 0      */ 05223000
         L     @05,MAPAD                                        02S1374 05224000
         CLI   EUSEATTR(@05),C'0'                               02S1374 05225000
         BNE   @RF01374                                         02S1374 05226000
*    UCBBSTR = YES;                    /*SET USE ATTRI TO STORAGE,   */ 05227000
         OI    UCBBSTR(@10),B'00000100'                         02S1375 05228000
*  ELSE IF EUSEATTR = PRIV             /*IF COL 10 = 2               */ 05229000
*    THEN                                                       02S1376 05230000
         B     @RC01374                                         02S1376 05231000
@RF01374 L     @10,MAPAD                                        02S1376 05232000
         CLI   EUSEATTR(@10),C'2'                               02S1376 05233000
         BNE   @RF01376                                         02S1376 05234000
*      UCBBPRV = YES;                  /*SET USE ATTRI TO PRIVATE,   */ 05235000
         L     @10,UCBPTR                                       02S1377 05236000
         OI    UCBBPRV(@10),B'00010000'                         02S1377 05237000
*    ELSE                              /*ELSE SET DEFAULT USE ATTRI  */ 05238000
*      UCBBPUB = YES;                  /*OF PUBLIC                   */ 05239000
         B     @RC01376                                         02S1378 05240000
@RF01376 L     @10,UCBPTR                                       02S1378 05241000
         OI    UCBBPUB(@10),B'00001000'                         02S1378 05242000
*END SETSTAT;                          /*RETURN TO CALLER    @Y30LPPD*/ 05243000
@EL00002 DS    0H                                               02S1379 05244000
@EF00002 DS    0H                                               02S1379 05245000
@ER00002 LM    @14,@12,12(@13)                                  02S1379 05246000
         BR    @14                                              02S1379 05247000
*EXCPSETP: PROC;                       /* SET UP FOR EXCP    @Y30LPPD*/ 05248000
EXCPSETP STM   @14,@12,12(@13)                                  02S1380 05249000
*/***********************************************************@Y30LPPD*/ 05250000
*/*                                                          @Y30LPPD*/ 05251000
*/* SEGMENT NAME - EXCPSETP                                  @Y30LPPD*/ 05252000
*/*                                                          @Y30LPPD*/ 05253000
*/* DESCRIPTIVE NAME - SET UP CONTROL BLOCKS FOR EXCP        @Y30LPPD*/ 05254000
*/*                                                          @Y30LPPD*/ 05255000
*/* FUNCTION -                                               @Y30LPPD*/ 05256000
*/*     THE APPENDAGE VECTOR TABLE AND EXCP CONTROL BLOCKS   @Y30LPPD*/ 05257000
*/*     ARE INITIALIZED.                                     @Y30LPPD*/ 05258000
*/*                                                          @Y30LPPD*/ 05259000
*/*  ENTRY - SUBROUTINE                                      @Y30LPPD*/ 05260000
*/*                                                          @Y30LPPD*/ 05261000
*/*      PURPOSE - SEE FUNCTION                              @Y30LPPD*/ 05262000
*/*                                                          @Y30LPPD*/ 05263000
*/*      INPUT DATA - NONE                                   @Y30LPPD*/ 05264000
*/*                                                          @Y30LPPD*/ 05265000
*/*  EXITS -                                                 @Y30LPPD*/ 05266000
*/*                                                          @Y30LPPD*/ 05267000
*/*      CONDITION - VECTOR TABLE AND CONTROL BLOCKS         @Y30LPPD*/ 05268000
*/*              INITIALIZED                                 @Y30LPPD*/ 05269000
*/*                                                          @Y30LPPD*/ 05270000
*/*      OUTPUT DATA -                                       @Y30LPPD*/ 05271000
*/*                                                          @Y30LPPD*/ 05272000
*/*            APPENDAGE VECTOR TABLE                        @Y30LPPD*/ 05273000
*/*            ECB                                           @Y30LPPD*/ 05274000
*/*            IOB                                           @Y30LPPD*/ 05275000
*/*            DEB                                           @Y30LPPD*/ 05276000
*/*            CCW'S                                         @Y30LPPD*/ 05277000
*/*            DCB                                           @Y30LPPD*/ 05278000
*/*                                                          @Y30LPPD*/ 05279000
*/*     RETURN CODE - NONE                                   @Y30LPPD*/ 05280000
*/*                                                          @Y30LPPD*/ 05281000
*/***********************************************************@Y30LPPD*/ 05282000
*RFY IOBSTDRD BASED(IOBSTPTR);         /*                    @Y30LPPD*/ 05283000
*DO VIND = ONE TO FIVE;                /*INITIALIZE APPENDAGE@Y30LPPD*/ 05284000
         LA    @10,1                                            02S1382 05285000
         STH   @10,VIND                                         02S1382 05286000
@DL01382 DS    0H                                               02S1383 05287000
*  VECTAB(VIND) = ADDR(CVTBRET);       /*VECTOR TABLE        @Y30LPPD*/ 05288000
         LR    @05,@10                                          02S1383 05289000
         SLA   @05,2                                            02S1383 05290000
         L     @01,CVTPTR                                       02S1383 05291000
         LA    @15,CVTBRET(,@01)                                02S1383 05292000
         ST    @15,VECTAB-4(@05)                                02S1383 05293000
*END;                                                           02S1384 05294000
*                                                               02S1384 05295000
         AL    @10,@CF00042                                     02S1384 05296000
         STH   @10,VIND                                         02S1384 05297000
         CH    @10,@CH00073                                     02S1384 05298000
         BNH   @DL01382                                         02S1384 05299000
*ECBPTR = ADDR(VAPECB);                /*ADDRESS OF ECB              */ 05300000
         LA    @10,VAPECB                                       02S1385 05301000
         ST    @10,ECBPTR                                       02S1385 05302000
*IOBSTPTR = ADDR(VAPIOB);              /*ADDRESS OF IOB              */ 05303000
         LA    @05,VAPIOB                                       02S1386 05304000
         ST    @05,IOBSTPTR                                     02S1386 05305000
*DEBPTR = ADDR(VAPDEB);                /*ADDRESS OF DEB              */ 05306000
*                                                               02S1387 05307000
         LA    @15,VAPDEB                                       02S1387 05308000
         ST    @15,DEBPTR                                       02S1387 05309000
*SADDR1 = ADDR(VAPSRCH);               /*CYL 0, TRK 0, RCD 3         */ 05310000
         LA    @14,VAPSRCH                                      02S1388 05311000
         ST    @14,@TF00001                                     02S1388 05312000
         MVC   SADDR1(3),@TF00001+1                             02S1388 05313000
*SADDR2 = ADDR(CCW1);                  /*POINT BACK TO FIRST CCW     */ 05314000
         LA    @14,CCW1                                         02S1389 05315000
         ST    @14,@TF00001                                     02S1389 05316000
         MVC   SADDR2(3),@TF00001+1                             02S1389 05317000
*SADDR3 = ADDR(LABELBUF);              /*BUFFER FOR READ             */ 05318000
         LA    @07,LABELBUF                                     02S1390 05319000
         ST    @07,@TF00001                                     02S1390 05320000
         MVC   SADDR3(3),@TF00001+1                             02S1390 05321000
*COUNT3 = LENGTH(LABELBUF);            /*NUMBER OF BYTES TO BE READ  */ 05322000
*                                                               02S1391 05323000
         MVC   COUNT3(2),@CH00177                               02S1391 05324000
*DCBDEBAD = DEBPTR;                    /*DEB ADDRESS IN DCB          */ 05325000
         ST    @15,@TF00001                                     02S1392 05326000
         MVC   DCBDEBAD(3),@TF00001+1                           02S1392 05327000
*DCBMACRF = MACRF;                     /*EXCP                        */ 05328000
         MVC   DCBMACRF(4),MACRF                                02S1393 05329000
*DCBOFLGS = OFLAGS;                    /*DCB IS OPEN                 */ 05330000
         MVC   DCBOFLGS(4),OFLAGS                               02S1394 05331000
*                                      /*SET UP IOB                  */ 05332000
*IOBFLAG1 = IOBFLAGS;                  /*CHAINING & UNRELATED REQUEST*/ 05333000
         MVI   IOBFLAG1(@05),X'42'                              02S1395 05334000
*IOBECBPT = ECBPTR;                    /*ECB ADDRESS                 */ 05335000
         ST    @10,IOBECBPT(,@05)                               02S1396 05336000
*IOBSTART = ADDR(CCW1);                /*CCW ADDRESS                 */ 05337000
         ST    @14,IOBSTART(,@05)                               02S1397 05338000
*IOBDCBPT = ADDR(VAPDCB1) - DCBDISP;   /*DCB ADDRESS                 */ 05339000
         LA    @10,VAPDCB1                                      02S1398 05340000
         SH    @10,@CH00108                                     02S1398 05341000
         ST    @10,IOBDCBPT(,@05)                               02S1398 05342000
*IOBR = THREE;                         /*RECORD 3                    */ 05343000
         MVI   IOBR(@05),X'03'                                  02S1399 05344000
*                                      /*SET UP DEB                  */ 05345000
*DEBDAPTR = ADDR(DEBBASND);            /*ADDRESS OF DEB EXTENSION    */ 05346000
         LA    @05,DEBBASND(,@15)                               02S1400 05347000
         ST    @05,DEBDAPTR                                     02S1400 05348000
*DEBNMEXT = EXTENTS;                   /*NUMBER OF EXTENTS           */ 05349000
         MVI   DEBNMEXT(@15),X'01'                              02S1401 05350000
*DEBDEBID = DEBID;                     /*DEB ID                      */ 05351000
         MVI   DEBDEBID(@15),X'0F'                              02S1402 05352000
*DEBDCBB = IOBDCBPT;                   /*DCB ADDRESS                 */ 05353000
         ST    @10,@TF00001                                     02S1403 05354000
         MVC   DEBDCBB(3,@15),@TF00001+1                        02S1403 05355000
*DEBEXSCL = DASDEX;                    /*EXTENT SCALE                */ 05356000
         MVI   DEBEXSCL(@15),X'04'                              02S1404 05357000
*DEBAPPB = ADDR(VECTAB);               /*APPENDAGE VECTOR TABLE      */ 05358000
         LA    @10,VECTAB                                       02S1405 05359000
         ST    @10,@TF00001                                     02S1405 05360000
         MVC   DEBAPPB(3,@15),@TF00001+1                        02S1405 05361000
*DEBENDCC = ENDEXT;                    /*END CYLINDER                */ 05362000
         LH    @10,ENDEXT                                       02S1406 05363000
         STH   @10,DEBENDCC(,@05)                               02S1406 05364000
*DEBENDHH = ENDEXT;                    /* END TRACK                  */ 05365000
         STH   @10,DEBENDHH(,@05)                               02S1407 05366000
*DEBNMTRK = NUMTRKS;                   /*NUMBER OF TRACKS            */ 05367000
         MVC   DEBNMTRK(2,@05),NUMTRKS                          02S1408 05368000
*END EXCPSETP;                         /*                    @Y30LPPD*/ 05369000
@EL00003 DS    0H                                               02S1409 05370000
@EF00003 DS    0H                                               02S1409 05371000
@ER00003 LM    @14,@12,12(@13)                                  02S1409 05372000
         BR    @14                                              02S1409 05373000
*END IEAVAP00                                                   01S1410 05374000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 05375000
*/*%INCLUDE SYSLIB  (VAPSPEC )                                        * 05376000
*/*%INCLUDE SYSLIB  (DECLARES)                                        * 05377000
*/*%INCLUDE SYSLIB  (CVT     )                                        * 05378000
*/*%INCLUDE SYSLIB  (IEZSSC  )                                        * 05379000
*/*%INCLUDE SYSLIB  (IHANVT  )                                        * 05380000
*/*%INCLUDE SYSLIB  (IEFUCBOB)                                        * 05381000
*/*%INCLUDE SYSLIB  (IEAPPNIP)                                        * 05382000
*/*%INCLUDE SYSLIB  (IEAPMNIP)                                        * 05383000
*/*%INCLUDE SYSLIB  (IHAECB  )                                        * 05384000
*/*%INCLUDE SYSLIB  (IEZIOB  )                                        * 05385000
*/*%INCLUDE SYSLIB  (IEZDEB  )                                        * 05386000
*/*%INCLUDE SYSLIB  (MESSAGES)                                        * 05387000
*/*%INCLUDE SYSLIB  (INITUCBS)                                        * 05388000
*/*%INCLUDE SYSLIB  (INITSPEC)                                        * 05389000
*/*%INCLUDE SYSLIB  (CKPARMS )                                        * 05390000
*/*%INCLUDE SYSLIB  (CKPMSPEC)                                        * 05391000
*/*%INCLUDE SYSLIB  (SYSPARMS)                                        * 05392000
*/*%INCLUDE SYSLIB  (SYSPSPEC)                                        * 05393000
*/*%INCLUDE SYSLIB  (RDENTRY )                                        * 05394000
*/*%INCLUDE SYSLIB  (RDENSPEC)                                        * 05395000
*/*%INCLUDE SYSLIB  (CKENTRY )                                        * 05396000
*/*%INCLUDE SYSLIB  (CKENSPEC)                                        * 05397000
*/*%INCLUDE SYSLIB  (MNTLSTCK)                                        * 05398000
*/*%INCLUDE SYSLIB  (MTCKSPEC)                                        * 05399000
*/*%INCLUDE SYSLIB  (MOUNTLST)                                        * 05400000
*/*%INCLUDE SYSLIB  (MLSTSPEC)                                        * 05401000
*/*%INCLUDE SYSLIB  (NOLIST  )                                        * 05402000
*/*%INCLUDE SYSLIB  (NLSTSPEC)                                        * 05403000
*/*%INCLUDE SYSLIB  (RDERR   )                                        * 05404000
*/*%INCLUDE SYSLIB  (RDERSPEC)                                        * 05405000
*/*%INCLUDE SYSLIB  (INFOLIST)                                        * 05406000
*/*%INCLUDE SYSLIB  (INFOSPEC)                                        * 05407000
*/*%INCLUDE SYSLIB  (LISTPROC)                                        * 05408000
*/*%INCLUDE SYSLIB  (LISTSPEC)                                        * 05409000
*/*%INCLUDE SYSLIB  (FINDVOL )                                        * 05410000
*/*%INCLUDE SYSLIB  (FINDSPEC)                                        * 05411000
*/*%INCLUDE SYSLIB  (WRONGVOL)                                        * 05412000
*/*%INCLUDE SYSLIB  (WRNGSPEC)                                        * 05413000
*/*%INCLUDE SYSLIB  (VIRTMONT)                                        * 05414000
*/*%INCLUDE SYSLIB  (VIRTSPEC)                                        * 05415000
*/*%INCLUDE SYSLIB  (CKPATH  )                                        * 05416000
*/*%INCLUDE SYSLIB  (CKPHSPEC)                                        * 05417000
*/*%INCLUDE SYSLIB  (VIRTREAD)                                        * 05418000
*/*%INCLUDE SYSLIB  (VTRDSPEC)                                        * 05419000
*/*%INCLUDE SYSLIB  (MOUNTMSG)                                        * 05420000
*/*%INCLUDE SYSLIB  (MNTSPEC )                                        * 05421000
*/*%INCLUDE SYSLIB  (CKREPLY )                                        * 05422000
*/*%INCLUDE SYSLIB  (CKRPSPEC)                                        * 05423000
*/*%INCLUDE SYSLIB  (DEVREPLY)                                        * 05424000
*/*%INCLUDE SYSLIB  (DEVRSPEC)                                        * 05425000
*/*%INCLUDE SYSLIB  (DELIMCK )                                        * 05426000
*/*%INCLUDE SYSLIB  (DELISPEC)                                        * 05427000
*/*%INCLUDE SYSLIB  (CHECKUCB)                                        * 05428000
*/*%INCLUDE SYSLIB  (CUCBSPEC)                                        * 05429000
*/*%INCLUDE SYSLIB  (UCBFIND )                                        * 05430000
*/*%INCLUDE SYSLIB  (UCBFSPEC)                                        * 05431000
*/*%INCLUDE SYSLIB  (CKONLINE)                                        * 05432000
*/*%INCLUDE SYSLIB  (CKONSPEC)                                        * 05433000
*/*%INCLUDE SYSLIB  (REASON  )                                        * 05434000
*/*%INCLUDE SYSLIB  (REASON  )                                        * 05435000
*/*%INCLUDE SYSLIB  (RESNSPEC)                                        * 05436000
*/*%INCLUDE SYSLIB  (RESNSPEC)                                        * 05437000
*/*%INCLUDE SYSLIB  (CHECKDUP)                                        * 05438000
*/*%INCLUDE SYSLIB  (CDUPSPEC)                                        * 05439000
*/*%INCLUDE SYSLIB  (RDYUCB  )                                        * 05440000
*/*%INCLUDE SYSLIB  (RUCBSPEC)                                        * 05441000
*/*%INCLUDE SYSLIB  (WTORMT  )                                        * 05442000
*/*%INCLUDE SYSLIB  (WTORSPEC)                                        * 05443000
*/*%INCLUDE SYSLIB  (TESTRDY )                                        * 05444000
*/*%INCLUDE SYSLIB  (TESTSPEC)                                        * 05445000
*/*%INCLUDE SYSLIB  (READSER )                                        * 05446000
*/*%INCLUDE SYSLIB  (READSPEC)                                        * 05447000
*/*%INCLUDE SYSLIB  (CKVOLIST)                                        * 05448000
*/*%INCLUDE SYSLIB  (CKVLSPEC)                                        * 05449000
*/*%INCLUDE SYSLIB  (ERRPROC )                                        * 05450000
*/*%INCLUDE SYSLIB  (ERRSPEC )                                        * 05451000
*/*%INCLUDE SYSLIB  (CLEANUP )                                        * 05452000
*/*%INCLUDE SYSLIB  (CLENSPEC)                                        * 05453000
*/*%INCLUDE SYSLIB  (IEAPSPIO)                                        * 05454000
*/*%INCLUDE SYSLIB  (SETSTAT )                                        * 05455000
*/*%INCLUDE SYSLIB  (SETSSPEC)                                        * 05456000
*/*%INCLUDE SYSLIB  (EXCPSETP)                                        * 05457000
*/*%INCLUDE SYSLIB  (EXCPSPEC)                                        * 05458000
*;                                                              01S1410 05459000
@DATA    DS    0H                                                       05460000
@CH00075 DC    H'6'                                                     05461000
@CH00084 DC    H'7'                                                     05462000
@CH00035 DC    H'8'                                                     05463000
@CH01793 DC    H'14'                                                    05464000
@CH00088 DC    H'19'                                                    05465000
@CH00078 DC    H'20'                                                    05466000
@CH00190 DC    H'22'                                                    05467000
@CH00108 DC    H'40'                                                    05468000
@CH00325 DC    H'44'                                                    05469000
@CH02653 DC    H'64'                                                    05470000
@CH00082 DC    H'72'                                                    05471000
@CH00177 DC    H'80'                                                    05472000
@CH00086 DC    H'300'                                                   05473000
         DS    0F                                                       05474000
@SA00001 DS    18F                                                      05475000
@TF00001 DS    F                                                        05476000
@ZTEMPS  DS    0F                                                       05477000
@ZT00001 DC    F'0'                                                     05478000
@ZT00003 DC    F'0'                                                     05479000
@ZTEMPND EQU   *                                                        05480000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         05481000
         DS    0F                                                       05482000
@CF00042 DC    F'1'                                                     05483000
@CH00042 EQU   @CF00042+2                                               05484000
@CF00069 DC    F'2'                                                     05485000
@CF00064 DC    F'3'                                                     05486000
@CF00036 DC    F'4'                                                     05487000
@CH00036 EQU   @CF00036+2                                               05488000
@CF00073 DC    F'5'                                                     05489000
@CH00073 EQU   @CF00073+2                                               05490000
@CF00032 DC    F'12'                                                    05491000
@CF00080 DC    F'16'                                                    05492000
@CF02677 DC    F'-240'                                                  05493000
@CF02680 DC    F'-4'                                                    05494000
@CF02508 DC    XL4'80000000'                                            05495000
@CV00229 DC    V(IEFSCAN)                                               05496000
@CV00230 DC    V(UCBCONT)                                               05497000
         DS    0D                                                       05498000
SWITCHES DS    FL4                                                      05499000
         ORG   SWITCHES                                                 05500000
DEFAULT  DS    BL1                                                      05501000
PEND     EQU   SWITCHES+0                                               05502000
READ     EQU   SWITCHES+0                                               05503000
NODEV    EQU   SWITCHES+0                                               05504000
WTO      EQU   SWITCHES+0                                               05505000
GOODLIST EQU   SWITCHES+0                                               05506000
FOUND    EQU   SWITCHES+0                                               05507000
BADVAL   EQU   SWITCHES+0                                               05508000
BADREPLY DS    BL1                                                      05509000
DPLOADED EQU   SWITCHES+1                                               05510000
ERROR    EQU   SWITCHES+1                                               05511000
MSG1     EQU   SWITCHES+1                                               05512000
MSG2     EQU   SWITCHES+1                                               05513000
MSSMNT   EQU   SWITCHES+1                                               05514000
DUPSER   EQU   SWITCHES+1                                               05515000
DUPADDR  EQU   SWITCHES+1                                               05516000
MSGSW    DS    BL1                                                      05517000
FAILSW   EQU   SWITCHES+2                                               05518000
EXCPSW   EQU   SWITCHES+2                                               05519000
LOOPSW   EQU   SWITCHES+2                                               05520000
SUPPRESS EQU   SWITCHES+2                                               05521000
         ORG   SWITCHES+4                                               05522000
ERRMSG   DS    F                                                        05523000
MACRF    DC    XL4'00008000'                                            05524000
OFLAGS   DC    XL4'12000000'                                            05525000
MAPAD    DS    A                                                        05526000
PARMPTR  DS    A                                                        05527000
DPPLIST  DS    A                                                        05528000
DATAPATH DS    A                                                        05529000
LUTSAVE  DS    A                                                        05530000
UCBPTR   DS    A                                                        05531000
CVTPTR   DS    A                                                        05532000
ECBPTR   DS    A                                                        05533000
IOBSTPTR DS    A                                                        05534000
DEBPTR   DS    A                                                        05535000
DEBDAPTR DS    A                                                        05536000
DEBEXPTR DS    A                                                        05537000
IOBPRPTR DS    A                                                        05538000
DEBSBPTR DS    A                                                        05539000
FINDADDR DS    FL4                                                      05540000
         ORG   FINDADDR                                                 05541000
FINDDEV  DS    CL3                                                      05542000
@NM00004 DS    CL1                                                      05543000
         ORG   FINDADDR+4                                               05544000
VAPECB   DS    F                                                        05545000
NIPPMADR DS    A                                                        05546000
NIPPMKPR DS    A                                                        05547000
NIPPMNEG DC    XL4'FFFFFFFF'                                            05548000
NIPPMBDL DS    A                                                        05549000
NIPPMDCB DS    A                                                        05550000
ENDEXT   DC    XL2'FFFF'                                                05551000
NUMTRKS  DC    XL2'7FFF'                                                05552000
N        DS    H                                                        05553000
I        DS    H                                                        05554000
J        DS    H                                                        05555000
K        DS    H                                                        05556000
NEXTPTR  DS    H                                                        05557000
DEVIND   DS    H                                                        05558000
MNTIND   DS    H                                                        05559000
IND      DS    H                                                        05560000
VIND     DS    H                                                        05561000
SCAN     DS    H                                                        05562000
CHECK    DS    H                                                        05563000
DEVMTCT  DS    H                                                        05564000
TOMOUNT  DS    H                                                        05565000
TABLECT  DS    H                                                        05566000
MTLSTCT  DS    H                                                        05567000
@TS00001 DS    CL22                                                     05568000
@CC00142 DC    C'VATLST'                                                05569000
@CC00130 DC    C'VOL1'                                                  05570000
@CC00134 DC    C'CONT'                                                  05571000
@CC00132 DC    C'END'                                                   05572000
@CC00136 DC    C'YES'                                                   05573000
@CC02470 DC    C'P/R'                                                   05574000
@CC02472 DC    C'RSV'                                                   05575000
@CC02474 DC    C'STR'                                                   05576000
@CC02476 DC    C'PRV'                                                   05577000
@CC02478 DC    C'PUB'                                                   05578000
@CC00138 DC    C'NO'                                                    05579000
@CC00144 DC    C'00'                                                    05580000
@CC00168 DC    C'U'''                                                   05581000
@CC00170 DC    C' '''                                                   05582000
@CC02480 DC    C' 1'                                                    05583000
@CC02482 DC    C' 2'                                                    05584000
@CC02484 DC    C' 3'                                                    05585000
@CC02486 DC    C' 4'                                                    05586000
@CC02488 DC    C' 5'                                                    05587000
@CC02490 DC    C' 6'                                                    05588000
@CC02492 DC    C' 7'                                                    05589000
@CC02494 DC    C' 8'                                                    05590000
@CC02496 DC    C' 9'                                                    05591000
@CC02498 DC    C'10'                                                    05592000
@CC02500 DC    C'11'                                                    05593000
@CB02631 DC    X'00000000000000'                                        05594000
@CB00140 DC    X'2009'                                                  05595000
BADADDR  DS    CL3                                                      05596000
VAPSRCH  DC    X'0000000003'                                            05597000
ZEROSEEK DC    X'0000000000000000'                                      05598000
         ORG   ZEROSEEK                                                 05599000
ZEROCSW  DS    CL7                                                      05600000
         ORG   ZEROCSW                                                  05601000
ZEROVOLI DS    CL6                                                      05602000
         ORG   ZEROVOLI                                                 05603000
ZEROVTOC DS    CL4                                                      05604000
         ORG   ZEROVTOC                                                 05605000
ZEROADDR DS    CL3                                                      05606000
         ORG   ZEROSEEK+8                                               05607000
PROMPT   DC    CL8'VAL'                                                 05608000
RDEND    DC    X'FF'                                                    05609000
MSSVOL   DS    CL6                                                      05610000
         DS    CL3                                                      05611000
DPPARM   DS    CL8                                                      05612000
         ORG   DPPARM                                                   05613000
DPUCB    DS    AL4                                                      05614000
DPFCETC  DC    F'0'                                                     05615000
         ORG   DPPARM+8                                                 05616000
WTORBUF  DS    CL80                                                     05617000
RSNAREA  DS    CL5                                                      05618000
         ORG   RSNAREA                                                  05619000
RSNCDE   DS    FL4                                                      05620000
         ORG   RSNAREA+5                                                05621000
TRPATN   DC    CL16'0123456789ABCDEF'                                   05622000
UNPKAR   DS    CL5                                                      05623000
         DS    CL2                                                      05624000
REGSAVE  DS    CL60                                                     05625000
NIEEVDEV DC    CL8'IEEVDEV'                                             05626000
LABELBUF DS    CL80                                                     05627000
         ORG   LABELBUF                                                 05628000
VOL1     DS    CL4                                                      05629000
VOLSER   DS    CL6                                                      05630000
@NM00005 DS    CL1                                                      05631000
VOLVTOC  DS    CL5                                                      05632000
         ORG   LABELBUF+80                                              05633000
MBBCCHHR DS    CL8                                                      05634000
         ORG   MBBCCHHR                                                 05635000
MBB      DS    CL3                                                      05636000
CCHHR    DS    CL5                                                      05637000
         ORG   MBBCCHHR+8                                               05638000
@NM00006 DS    CL24                                                     05639000
         ORG   @NM00006                                                 05640000
CCW1     DS    CL8                                                      05641000
         ORG   CCW1                                                     05642000
@NM00007 DC    X'31'                                                    05643000
SADDR1   DS    AL3                                                      05644000
@NM00008 DC    X'4000'                                                  05645000
COUNT1   DC    X'0005'                                                  05646000
         ORG   @NM00006+8                                               05647000
CCW2     DS    CL8                                                      05648000
         ORG   CCW2                                                     05649000
@NM00009 DC    X'08'                                                    05650000
SADDR2   DS    AL3                                                      05651000
@NM00010 DC    X'0000'                                                  05652000
COUNT2   DC    X'0000'                                                  05653000
         ORG   @NM00006+16                                              05654000
CCW3     DS    CL8                                                      05655000
         ORG   CCW3                                                     05656000
@NM00011 DC    X'06'                                                    05657000
SADDR3   DS    AL3                                                      05658000
@NM00012 DC    X'0000'                                                  05659000
COUNT3   DC    X'0000'                                                  05660000
         ORG   @NM00006+24                                              05661000
@NM00014 DS    CL44                                                     05662000
         ORG   @NM00014                                                 05663000
VAPIOBF  DC    F'0'                                                     05664000
VAPIOB   DC    10F'0'                                                   05665000
         ORG   @NM00014+44                                              05666000
@NM00015 DS    CL60                                                     05667000
         ORG   @NM00015                                                 05668000
VAPDEB   DC    12F'0'                                                   05669000
VAPDCB1  DC    3F'0'                                                    05670000
         ORG   @NM00015+60                                              05671000
ICBDMLST DS    CL28                                                     05672000
         ORG   ICBDMLST                                                 05673000
DMLEN    DC    XL4'1C'                                                  05674000
DMOPCD   DC    XL1'06'                                                  05675000
DMNTRES1 DC    X'00'                                                    05676000
DMNTFLAG DC    B'0000000000000000'                                      05677000
         ORG   DMNTFLAG                                                 05678000
DMBITRE1 DS    BL1                                                      05679000
DMDELRSP EQU   DMNTFLAG+0                                               05680000
DMVUAVAL EQU   DMNTFLAG+0                                               05681000
DMBITRES EQU   DMNTFLAG+0                                               05682000
         ORG   ICBDMLST+8                                               05683000
DMVOL    DC    XL6'0'                                                   05684000
DMNTASID DC    XL2'0'                                                   05685000
DMNTECB  DC    F'0'                                                     05686000
DMHOST   DC    XL5'0'                                                   05687000
DMNTRES2 DC    XL1'0'                                                   05688000
DMNTVUA  DC    H'0'                                                     05689000
         ORG   ICBDMLST+28                                              05690000
ICBMLST  DS    CL28                                                     05691000
         ORG   ICBMLST                                                  05692000
MDLEN    DC    XL4'1C'                                                  05693000
MDOPCD   DC    XL1'08'                                                  05694000
@NM00100 DC    X'00'                                                    05695000
MDFLG    DC    B'0000000000000000'                                      05696000
         ORG   MDFLG                                                    05697000
@NM00101 DS    BL1                                                      05698000
MDVISMNT EQU   MDFLG+0                                                  05699000
MDVSVRQ  EQU   MDFLG+0                                                  05700000
MDSRTCH  EQU   MDFLG+0                                                  05701000
MDMEXT   EQU   MDFLG+0                                                  05702000
@NM00102 EQU   MDFLG+0                                                  05703000
         ORG   ICBMLST+8                                                05704000
MDVOL    DS    CL6                                                      05705000
         ORG   MDVOL                                                    05706000
@NM00103 DC    6X'00'                                                   05707000
         ORG   ICBMLST+14                                               05708000
MDVUA    DC    H'0'                                                     05709000
MDHOST   DS    CL5                                                      05710000
         ORG   MDHOST                                                   05711000
@NM00104 DC    5X'00'                                                   05712000
         ORG   ICBMLST+21                                               05713000
@NM00105 DS    CL3                                                      05714000
         ORG   @NM00105                                                 05715000
@NM00106 DC    3X'00'                                                   05716000
         ORG   ICBMLST+24                                               05717000
MNTEXTP  DC    A(0)                                                     05718000
         ORG   MNTEXTP                                                  05719000
MDJFCB   DS    FL4                                                      05720000
         ORG   ICBMLST+28                                               05721000
NIPPMMBC DS    CL8                                                      05722000
         ORG   NIPPMMBC                                                 05723000
NIPPMMBB DS    CL3                                                      05724000
NIPPMCCH DS    CL5                                                      05725000
         ORG   NIPPMMBC+8                                               05726000
NIPPMMK1 DC    B'11110010'                                              05727000
NIPPMMK2 DC    B'11110001'                                              05728000
NIPPMMK3 DC    B'00100000'                                              05729000
NIPPMNAM DC    CL8' '                                                   05730000
MNTLIST  DS    CL22                                                     05731000
         ORG   MNTLIST+0                                                05732000
MVOLSER  DS    CL6                                                      05733000
@NM00001 DS    CL5                                                      05734000
MDEVTYPE DS    CL8                                                      05735000
@NM00002 DS    CL2                                                      05736000
DEVENT   DS    AL1                                                      05737000
         ORG   MNTLIST+6600                                             05738000
         DS    CL1                                                      05739000
DEVTYPES DS    CL14                                                     05740000
         ORG   DEVTYPES+0                                               05741000
ETYPE    DC    CL8'2305-1  '                                            05742000
UCBTYPE  DC    XL1'06'                                                  05743000
         DS    CL1                                                      05744000
DEVCT    DC    H'0'                                                     05745000
AUXCT    DC    H'0'                                                     05746000
         ORG   DEVTYPES+14                                              05747000
         ORG   DEVTYPES+14                                              05748000
         DC    CL8'2305-2  '                                            05749000
         DC    XL1'07'                                                  05750000
         DS    CL1                                                      05751000
         DC    H'0'                                                     05752000
         DC    H'0'                                                     05753000
         ORG   DEVTYPES+28                                              05754000
         ORG   DEVTYPES+28                                              05755000
         DC    CL8'2314    '                                            05756000
         DC    XL1'08'                                                  05757000
         DS    CL1                                                      05758000
         DC    H'0'                                                     05759000
         DC    H'0'                                                     05760000
         ORG   DEVTYPES+42                                              05761000
         ORG   DEVTYPES+42                                              05762000
         DC    CL8'3330    '                                            05763000
         DC    XL1'09'                                                  05764000
         DS    CL1                                                      05765000
         DC    H'0'                                                     05766000
         DC    H'0'                                                     05767000
         ORG   DEVTYPES+56                                              05768000
         ORG   DEVTYPES+56                                              05769000
         DC    CL8'3340    '                                            05770000
         DC    XL1'0A'                                                  05771000
         DS    CL1                                                      05772000
         DC    H'0'                                                     05773000
         DC    H'0'                                                     05774000
         ORG   DEVTYPES+70                                              05775000
         ORG   DEVTYPES+70                                              05776000
         DC    CL8'3330-1  '                                            05777000
         DC    XL1'0D'                                                  05778000
         DS    CL1                                                      05779000
         DC    H'0'                                                     05780000
         DC    H'0'                                                     05781000
         ORG   DEVTYPES+84                                              05782000
         ORG   DEVTYPES+84                                              05783000
         DC    CL8'3350    '                                            05784000
         DC    XL1'0B'                                                  05785000
         DS    CL1                                                      05786000
         DC    H'0'                                                     05787000
         DC    H'0'                                                     05788000
         ORG   DEVTYPES+98                                              05789000
         DS    CL2                                                      05790000
DEVTABLE DS    CL8                                                      05791000
         ORG   DEVTABLE+0                                               05792000
DEVICE   DS    CL3                                                      05793000
         DS    CL1                                                      05794000
UCBADDR  DS    AL4                                                      05795000
         ORG   DEVTABLE+152                                             05796000
VECTAB   DS    5A                                                       05797000
NIPPMREG DS    16F                                                      05798000
IEAVAP00 CSECT                                                          05799000
         DS   0H                                                        05800000
PATCHLOC DC ((@DATA-@PSTART)/20)X'00'                                   05801000
IEAVAP00 CSECT                                                          05802000
IEA409I  DS  0F                                                @ZA14221 05803000
         IEAPMNIP TYPE=HEADER,MSGST=IEA409I,MSGEND=END409I     @ZA14221 05804000
         DC  C'IEA409I UNABLE TO MOUNT MSS VOLUME '            @ZA14221 05805000
VOL409   DC  CL6' '                                            @ZA14221 05806000
         DC  C' ON V'                                          @ZA14221 05807000
DEV409   DC  CL3' '                                            @ZA14221 05808000
         DC  C', DEVICE NOT ACCESSIBLE.'                       @ZA14221 05809000
END409I  EQU *                                                 @ZA14221 05810000
*                                                                       05811000
*                                                                       05812000
IEA850I  DS  0F                                                         05813000
         IEAPMNIP TYPE=HEADER,MSGST=IEA850I,MSGEND=END850I              05814000
         DC  C'IEA850I FOLLOWING WILL BE PROCESSED'            @YM00442 05815000
END850I  EQU *                                                          05816000
*                                                                       05817000
*                                                                       05818000
IEA850I2 DS  0F                                                         05819000
         IEAPMNIP TYPE=HEADER,MSGST=IEA850I2,MSGEND=END850I2,OPT=(,NBC) 05820000
SER850   DC  CL6' '                    FILL IN VOLUME SERIAL NUMBER     05821000
         DC  C' ON '                                                    05822000
DEV850   DC  CL8' '                    FILL IN DEVICE TYPE     @YM00442 05823000
         DC  CL1' '                                                     05824000
MT850    DC  CL3' '                    FILL IN MOUNT ATTRIBUTE          05825000
         DC  CL1'-'                                                     05826000
USE850   DC  CL3' '                    FILL IN USE ATTRIBUTE            05827000
END850I2 EQU *                                                          05828000
*                                                                       05829000
*                                                                       05830000
IEA851I  DS  0F                                                         05831000
         IEAPMNIP TYPE=HEADER,MSGST=IEA851I,MSGEND=END851I              05832000
         DC  C'IEA851I FOLLOWING MAY BE MOUNTED'                        05833000
END851I  EQU *                                                          05834000
*                                                                       05835000
*                                                                       05836000
IEA851I2 DS  0F                                                         05837000
         IEAPMNIP TYPE=HEADER,MSGST=IEA851I2,MSGEND=END851I2,OPT=(,NBC) 05838000
SER851   DC  CL6' '                    FILL IN VOLUME SERIAL NUMBER     05839000
         DC  C' ON '                                                    05840000
DEV851   DC  CL8' '                    FILL IN DEVICE TYPE              05841000
END851I2 EQU *                                                          05842000
*                                                                       05843000
*                                                                       05844000
IEAH851A DS  0F                                                         05845000
         IEAPMNIP TYPE=HEADER,MSGST=IEAH851A,MSGEND=END851A             05846000
         DC  C'IEA851A REPLY DEVICE ADDRESSES OR U.'                    05847000
END851A  EQU *                                                          05848000
*                                                                       05849000
*                                                                       05850000
IEA851A  DS  0F                                                         05851000
         IEAPMNIP TYPE=PLIST,RMSGST=WTORBUF,RMSGL=80,MSGST=IEAH851A,   X05852000
               ASYNCH='NO'                                              05853000
*                                                                       05854000
*                                                                       05855000
IEA852I  DS  0F                                                         05856000
         IEAPMNIP TYPE=HEADER,MSGST=IEA852I,MSGEND=END852I              05857000
         DC  C'IEA852I '                                                05858000
DEV852   DC  CL3' '                                                     05859000
         DC  C' ADDRESS INVALID - '                                     05860000
R852     DC  CL2' '                                            @YM02792 05861000
END852I  EQU  *                                                         05862000
*                                                                       05863000
*                                                                       05864000
IEAH852A DS  0F                                                         05865000
         IEAPMNIP TYPE=HEADER,MSGST=IEAH852A,MSGEND=END852A             05866000
         DC  C'IEA852A REPEAT REPLY.'                                   05867000
END852A  EQU *                                                          05868000
*                                                                       05869000
*                                                                       05870000
IEA852A  DS  0F                                                         05871000
         IEAPMNIP TYPE=PLIST,RMSGST=WTORBUF,RMSGL=80,MSGST=IEAH852A,   X05872000
               ASYNCH='NO'                                              05873000
*                                                                       05874000
*                                                                       05875000
IEAH853A DS  0F                                                         05876000
         IEAPMNIP TYPE=HEADER,MSGST=IEAH853A,MSGEND=END853A             05877000
         DC  C'IEA853A REPLY CONT, END OR RESPECIFY.'          @YM00442 05878000
END853A  EQU *                                                          05879000
*                                                                       05880000
*                                                                       05881000
IEA853A  DS  0F                                                         05882000
         IEAPMNIP TYPE=PLIST,RMSGST=WTORBUF,RMSGL=80,MSGST=IEAH853A,   X05883000
               ASYNCH='NO'                                              05884000
*                                                                       05885000
*                                                                       05886000
IEA854I  DS  0F                                                         05887000
         IEAPMNIP TYPE=HEADER,MSGST=IEA854I,MSGEND=END854I              05888000
         DC  C'IEA854I ERROR READING VOLUME LABEL. '                    05889000
END854I  EQU *                                                          05890000
*                                                                       05891000
*                                                                       05892000
IEA855I  DS  0F                                                         05893000
         IEAPMNIP TYPE=HEADER,MSGST=IEA855I,MSGEND=END855I              05894000
         DC  C'IEA855I INVALID VATLST'                                  05895000
NN855    DC  CL2' '                    FILL IN VATLST NUMBER            05896000
         DC  C' ENTRY.'                                                 05897000
END855I  EQU *                                                          05898000
*                                                                       05899000
*                                                                       05900000
IEA859I  DS  0F                                                         05901000
         IEAPMNIP TYPE=HEADER,MSGST=IEA859I,MSGEND=END859I              05902000
         DC  C'IEA859I UNREQUESTED VOLUME. UNIT '                       05903000
DEV859   DC  CL3' '                    FILL IN UNIT ADDRESS             05904000
         DC  C' NOW UNLOADED.'                                          05905000
END859I  EQU *                                                          05906000
*                                                                       05907000
*                                                                       05908000
IEA860A  DS  0F                                                         05909000
         IEAPMNIP TYPE=HEADER,MSGST=IEA860A,MSGEND=END860A              05910000
DEV860   DS  CL80                      FILL IN UNIT ADDRESSES           05911000
END860A  EQU *                                                          05912000
*                                                                       05913000
*                                                                       05914000
IEAH8602 DS  0F                                                         05915000
         IEAPMNIP TYPE=HEADER,MSGST=IEAH8602,MSGEND=END8602             05916000
         DC  C'IEA860A REPLY U WHEN ALL DEVICES ARE READY.'    @YM02783 05917000
END8602  EQU *                                                          05918000
*                                                                       05919000
*                                                                       05920000
IEA8602  DS  0F                                                         05921000
         IEAPMNIP TYPE=PLIST,RMSGST=WTORBUF,RMSGL=80,MSGST=IEAH8602,   X05922000
               ASYNCH='NO'                                     @YM07218 05923000
*                                                                       05924000
*                                                                       05925000
IEAH861A DS  0F                                                         05926000
         IEAPMNIP TYPE=HEADER,MSGST=IEAH861A,MSGEND=END861A             05927000
         DC  C'IEA861A VAL='                                            05928000
NN861    DC  CL2' '                    FILL IN VATLST NUMBER            05929000
         DC  C' NOT FOUND. REPLY U OR CORRECT VALUE.'                   05930000
END861A  EQU *                                                          05931000
*                                                                       05932000
*                                                                       05933000
IEA861A  DS  0F                                                         05934000
         IEAPMNIP TYPE=PLIST,RMSGST=WTORBUF,RMSGL=80,MSGST=IEAH861A,   X05935000
               ASYNCH='NO'                                              05936000
*                                                                       05937000
*                                                                       05938000
IEA866I  DS  0F                                                         05939000
         IEAPMNIP TYPE=HEADER,MSGST=IEA866I,MSGEND=END866I              05940000
         DC  C'IEA866I VOLUME '                                         05941000
SER866   DC  CL6' '                                                     05942000
         DC  C' ON '                                                    05943000
V866     DC  C' '                                              @Y30LPPD 05944000
DEV866   DC  CL3' '                                                     05945000
         DC  C' REQUIRED ON A '                                         05946000
DT866    DC  CL8' '                                                     05947000
END866I  EQU *                                                          05948000
*                                                                       05949000
*                                                                       05950000
IEA867I  DS  0F                                                         05951000
         IEAPMNIP TYPE=HEADER,MSGST=IEA867I,MSGEND=END867I              05952000
         DC  C'IEA867I DUPLICATE VOLUME '                               05953000
SER867   DC  CL6' '                    FILL IN VOLUME SERIAL NUMBER     05954000
         DC  C'. UNIT '                                                 05955000
DEV867   DC  CL3' '                    FILL IN UNIT ADDRESS             05956000
         DC  C' NOW UNLOADED.'                                          05957000
END867I  EQU *                                                          05958000
*                                                                       05959000
*                                                                       05960000
IEAH893A DS  0F                                                @YM02783 05961000
         IEAPMNIP TYPE=HEADER,MSGST=IEAH893A,MSGEND=END893A    @YM02783 05962000
         DC  C'IEA893A NOT READY. REPLY U WHEN DEVICES ARE '            05963000
         DC  C'READY OR NO IF NOT MOUNTING.'                   @YM02783 05964000
END893A  EQU *                                                 @YM02783 05965000
*                                                                       05966000
*                                                                       05967000
IEA893A  DS  0F                                                @YM02783 05968000
         IEAPMNIP TYPE=PLIST,RMSGST=WTORBUF,RMSGL=80,MSGST=IEAH893A,   X05969000
               ASYNCH='NO'                                     @YM02783 05970000
*                                                                       05971000
*                                                                       05972000
IEA894I  DS  0F                                                         05973000
         IEAPMNIP TYPE=HEADER,MSGST=IEA894I,MSGEND=END894I              05974000
         DC  C'IEA894I REQUESTED VOLUME ON UNREQUESTED UNIT. '          05975000
DEV894   DC  CL3' '                                                     05976000
         DC  C' NOW UNLOADED.'                                          05977000
END894I  EQU  *                                                         05978000
*                                                                       05979000
*                                                                       05980000
IEAH895A DS  0F                                                         05981000
         IEAPMNIP TYPE=HEADER,MSGST=IEAH895A,MSGEND=END895A             05982000
         DC  C'IEA895A FORMAT ERROR. REPEAT REPLY.'                     05983000
END895A  EQU  *                                                         05984000
*                                                                       05985000
*                                                                       05986000
IEA895A  DS  0F                                                         05987000
         IEAPMNIP TYPE=PLIST,RMSGST=WTORBUF,RMSGL=80,MSGST=IEAH895A,   X05988000
               ASYNCH='NO'                                              05989000
*                                                                       05990000
*                                                                       05991000
IEA948I  DS  0F                                                         05992000
         IEAPMNIP TYPE=HEADER,MSGST=IEA948I,MSGEND=END948I              05993000
         DC  C'IEA948I '                                                05994000
V948     DC  C' '                                              @Y30LPPD 05995000
DEV948   DC  CL3' '                                                     05996000
         DC  C' NOW UNLOADED.'                                          05997000
END948I  EQU *                                                          05998000
*                                                                       05999000
*                                                                       06000000
IEAH947A DS  0F                                                         06001000
         IEAPMNIP TYPE=HEADER,MSGST=IEAH947A,MSGEND=END947A             06002000
         DC  C'IEA947A REPLY U TO CONTINUE, OR RE-IPL.'                 06003000
END947A  EQU *                                                          06004000
*                                                                       06005000
*                                                                       06006000
IEA947A  DS  0F                                                         06007000
         IEAPMNIP TYPE=PLIST,RMSGST=WTORBUF,RMSGL=80,MSGST=IEAH947A,   X06008000
               ASYNCH='NO'                                     @YM07218 06009000
*                                                                       06010000
*                                                                       06011000
IEA949I  DS  0F                                                @YM00442 06012000
         IEAPMNIP TYPE=HEADER,MSGST=IEA949I,MSGEND=END949I     @YM00442 06013000
         DC  C'IEA949I I/O ERROR READING VATLST'               @YM00442 06014000
NN949    DC  CL2' '                                            @YM00442 06015000
         DC  C'.'                                              @YM00442 06016000
END949I  EQU *                                                 @YM00442 06017000
*                                                                       06018000
*                                                                       06019000
IEAH949A DS  0F                                                @YM00442 06020000
         IEAPMNIP TYPE=HEADER,MSGST=IEAH949A,MSGEND=END949A    @YM00442 06021000
         DC  C'IEA949A REPLY YES FOR LIST OF ENTRIES '         @YM00442 06022000
         DC  C'THAT WILL BE PROCESSED, OR U FOR NO LIST.'      @YM00442 06023000
END949A  EQU *                                                 @YM00442 06024000
*                                                                       06025000
*                                                                       06026000
IEA949A  DS  0F                                                @YM00442 06027000
         IEAPMNIP TYPE=PLIST,RMSGST=WTORBUF,RMSGL=80,MSGST=IEAH949A,   X06028000
               ASYNCH='NO'                                     @YM07218 06029000
*                                                                       06030000
*                                                                       06031000
IEA985I DS  0F                                                 @Y30LPPD 06032000
        IEAPMNIP TYPE=HEADER,MSGST=IEA985I,MSGEND=END985I      @Y30LPPD 06033000
        DC  C'IEA985I UNABLE TO UNLOAD MSS VOLUME '            @Y30LPPD 06034000
VOL985  DC  CL6' '                                             @Y30LPPD 06035000
        DC  C' FROM V'                                         @Y30LPPD 06036000
DEV985  DC  CL3' '                                             @Y30LPPD 06037000
        DC  C' - RC='                                          @Y30LPPD 06038000
RET985  DC  CL3' '                                             @Y30LPPD 06039000
        DC  C'.'                                               @Y30LPPD 06040000
END985I EQU *                                                  @Y30LPPD 06041000
*                                                              @Y30LPPD 06042000
*                                                              @Y30LPPD 06043000
IEA986I  DS    0F                                              @Y30LPPD 06044000
         IEAPMNIP TYPE=HEADER,MSGST=IEA986I,MSGEND=END986I     @Y30LPPD 06045000
         DC    C'IEA986I MSS VOLUME '                          @Y30LPPD 06046000
VOL986   DC    CL6' '                                          @Y30LPPD 06047000
         DC    C' REQUIRED ON V'                               @Y30LPPD 06048000
DEV986   DC    CL3' '                                          @Y30LPPD 06049000
         DC    C'.'                                            @Y30LPPD 06050000
END986I  EQU   *                                               @Y30LPPD 06051000
*                                                              @Y30LPPD 06052000
*                                                              @Y30LPPD 06053000
IEA987I  DS    0F                                              @Y30LPPD 06054000
         IEAPMNIP TYPE=HEADER,MSGST=IEA987I,MSGEND=END987I     @Y30LPPD 06055000
         DC    C'IEA987I UNABLE TO MOUNT MSS VOLUME '          @Y30LPPD 06056000
VOL987   DC    CL6' '                                          @Y30LPPD 06057000
         DC    C' ON V'                                        @Y30LPPD 06058000
DEV987   DC    CL3' '                                          @Y30LPPD 06059000
         DC    C' - RC='                                       @Y30LPPD 06060000
RET987   DC    CL3' '                                          @Y30LPPD 06061000
         DC    C'.'                                            @Y30LPPD 06062000
END987I  EQU   *                                               @Y30LPPD 06063000
*                                                              @Y30LPPD 06064000
IEAVAP00 CSECT                                                          06065000
NIPMNT   IEAPMNIP TYPE=MOUNTPL,PARAM=DUMMY                              06066000
IEAVAP00 CSECT                                                          06067000
*NIPPMMS1 DS   0F                                               Y02752  06068000
NIPPMMS1 DS    0F                                               Y02752  06069000
         IEAPMNIP TYPE=HEADER,MSGST=NIPPMMS1,MSGEND=NIPPMED1    Y02752  06070000
         DC    CL34'IEA300I I/O ERROR DURING BLDL FOR '                 06071000
*NIPPMMB1  EQU *                                                Y02752  06072000
NIPPMMB1 DC    CL8'        '                                            06073000
         DC    CL16' IN SYS1.PARMLIB'                                   06074000
*NIPPMED1 EQU   *                                               Y02752  06075000
NIPPMED1 EQU   *                                                Y02752  06076000
         SPACE 1                                                        06077000
*NIPPMMS2 DS    0F                                              Y02752  06078000
NIPPMMS2 DS    0F                                               Y02752  06079000
         IEAPMNIP TYPE=HEADER,MSGST=NIPPMMS2,MSGEND=NIPPMED2            06080000
         DC    CL8'IEA301I '                                            06081000
*NIPPMMB2 EQU  *                                                Y02752  06082000
NIPPMMB2 DC    CL8'        '                                    Y02752  06083000
         DC    CL26' NOT FOUND IN SYS1.PARMLIB'                         06084000
*NIPPMED2 EQU   *                                               Y02752  06085000
NIPPMED2 EQU   *                                                Y02752  06086000
IEAVAP00 CSECT                                                          06087000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       06088000
@01      EQU   01                                                       06089000
@02      EQU   02                                                       06090000
@03      EQU   03                                                       06091000
@04      EQU   04                                                       06092000
@05      EQU   05                                                       06093000
@06      EQU   06                                                       06094000
@07      EQU   07                                                       06095000
@08      EQU   08                                                       06096000
@09      EQU   09                                                       06097000
@10      EQU   10                                                       06098000
@11      EQU   11                                                       06099000
@12      EQU   12                                                       06100000
@13      EQU   13                                                       06101000
@14      EQU   14                                                       06102000
@15      EQU   15                                                       06103000
REG1FIX  EQU   @01                                                      06104000
REG0     EQU   @00                                                      06105000
RTTR     EQU   @00                                                      06106000
RPARM    EQU   @01                                                      06107000
RCCHHR   EQU   @02                                                      06108000
REG4     EQU   @04                                                      06109000
RCODE    EQU   @15                                                      06110000
FINDPATH EQU   @00                                                      06111000
RNVT     EQU   @02                                                      06112000
RCVT     EQU   @03                                                      06113000
REXIT    EQU   @14                                                      06114000
RENTRY   EQU   @15                                                      06115000
GPR00P   EQU   @00                                                      06116000
GPR01P   EQU   @01                                                      06117000
GPR15F   EQU   @15                                                      06118000
MDREG1   EQU   @01                                                      06119000
NIPPMR00 EQU   @00                                                      06120000
NIPPMR01 EQU   @01                                                      06121000
NIPPMR02 EQU   @02                                                      06122000
NIPPMR13 EQU   @13                                                      06123000
NIPPMR14 EQU   @14                                                      06124000
NIPPMR15 EQU   @15                                                      06125000
NIPPMR06 EQU   @06                                                      06126000
NIPPMR09 EQU   @09                                                      06127000
NIPPMR12 EQU   @12                                                      06128000
ENTRIE   EQU   0                                                        06129000
MNTENTRY EQU   ENTRIE                                                   06130000
EVOLSER  EQU   MNTENTRY                                                 06131000
DELIM1   EQU   MNTENTRY+6                                               06132000
EMNTCHAR EQU   MNTENTRY+7                                               06133000
DELIM2   EQU   MNTENTRY+8                                               06134000
EUSEATTR EQU   MNTENTRY+9                                               06135000
DELIM3   EQU   MNTENTRY+10                                              06136000
EDEVTYPE EQU   MNTENTRY+11                                              06137000
DELIM4   EQU   MNTENTRY+19                                              06138000
EMNTPRIO EQU   MNTENTRY+20                                              06139000
VATPARMS EQU   0                                                        06140000
TRANSTAB EQU   0                                                        06141000
WTORDCB  EQU   0                                                        06142000
CVTMAP   EQU   0                                                        06143000
CVTPCNVT EQU   CVTMAP+28                                                06144000
CVTPRLTV EQU   CVTMAP+32                                                06145000
CVTILK2  EQU   CVTMAP+40                                                06146000
CVTDAR   EQU   CVTMAP+72                                                06147000
CVTFLGS1 EQU   CVTDAR                                                   06148000
CVTBRET  EQU   CVTMAP+82                                                06149000
CVTDCB   EQU   CVTMAP+116                                               06150000
CVTIERLC EQU   CVTMAP+144                                               06151000
CVTOPTA  EQU   CVTMAP+182                                               06152000
CVTOPTB  EQU   CVTMAP+183                                               06153000
CVTGTF   EQU   CVTMAP+236                                               06154000
CVTGTFST EQU   CVTGTF                                                   06155000
CVTGTFS  EQU   CVTGTFST                                                 06156000
CVTSTATE EQU   CVTGTFST                                                 06157000
CVTTMODE EQU   CVTGTFST                                                 06158000
CVTFORM  EQU   CVTGTFST                                                 06159000
CVTAQAVT EQU   CVTMAP+240                                               06160000
CVTTCMFG EQU   CVTAQAVT                                                 06161000
CVTVOLM2 EQU   CVTMAP+244                                               06162000
CVTTATA  EQU   CVTVOLM2                                                 06163000
CVTTSKS  EQU   CVTTATA                                                  06164000
CVTVOLF2 EQU   CVTTSKS                                                  06165000
CVTTAT   EQU   CVTTATA+1                                                06166000
CVTATER  EQU   CVTMAP+248                                               06167000
CVTEXT1  EQU   CVTMAP+252                                               06168000
CVTPURG  EQU   CVTMAP+260                                               06169000
CVTQMSG  EQU   CVTMAP+268                                               06170000
CVTDMSR  EQU   CVTMAP+272                                               06171000
CVTRSV37 EQU   CVTDMSR                                                  06172000
CVTDMSRF EQU   CVTRSV37                                                 06173000
CVTERPV  EQU   CVTMAP+316                                               06174000
CVTINTLA EQU   CVTMAP+320                                               06175000
CVTAPF   EQU   CVTMAP+324                                               06176000
CVTEXT2  EQU   CVTMAP+328                                               06177000
CVTHJES  EQU   CVTMAP+332                                               06178000
CVTPGSIA EQU   CVTMAP+348                                               06179000
CVTA1F1  EQU   CVTMAP+356                                               06180000
CVTSYSK  EQU   CVTMAP+357                                               06181000
CVTVOLM1 EQU   CVTMAP+380                                               06182000
CVTVOLF1 EQU   CVTVOLM1                                                 06183000
CVTATMCT EQU   CVTMAP+388                                               06184000
CVTXTNT1 EQU   0                                                        06185000
CVTXTNT2 EQU   0                                                        06186000
CVTDSSV  EQU   CVTXTNT2                                                 06187000
CVTFLGBT EQU   CVTXTNT2+5                                               06188000
CVTQID   EQU   CVTXTNT2+24                                              06189000
CVTICB   EQU   CVTXTNT2+48                                              06190000
CVTRV400 EQU   CVTXTNT2+52                                              06191000
CVTRV409 EQU   CVTXTNT2+53                                              06192000
CVTATCVT EQU   CVTXTNT2+64                                              06193000
CVTRV429 EQU   CVTXTNT2+84                                              06194000
CVTRV438 EQU   CVTXTNT2+85                                              06195000
CVTRV457 EQU   CVTXTNT2+112                                             06196000
CVTRV466 EQU   CVTXTNT2+113                                             06197000
CVTFIX   EQU   0                                                        06198000
CVTRELNO EQU   CVTFIX+252                                               06199000
ICB2SSCB EQU   0                                                        06200000
ICBOPT   EQU   ICB2SSCB+48                                              06201000
ICBFLG   EQU   ICB2SSCB+52                                              06202000
ICBFG1   EQU   ICBFLG                                                   06203000
ICBI     EQU   ICBFG1                                                   06204000
ICBTRACE EQU   ICB2SSCB+112                                             06205000
NVT      EQU   0                                                        06206000
NVTNPATR EQU   NVT+54                                                   06207000
NVTNPREN EQU   NVTNPATR                                                 06208000
NVTFLLB  EQU   NVT+55                                                   06209000
NVTABSAV EQU   NVT+140                                                  06210000
NVTFLCN  EQU   NVT+211                                                  06211000
NVTWTPSW EQU   NVT+224                                                  06212000
NVTWPSW2 EQU   NVTWTPSW+4                                               06213000
NVTFLWSC EQU   NVTWPSW2+3                                               06214000
NVTLOAD  EQU   NVT+232                                                  06215000
NVTSENSE EQU   NVT+236                                                  06216000
NVTSWAIT EQU   NVT+240                                                  06217000
NVTTIME  EQU   NVT+244                                                  06218000
NVTUCBFN EQU   NVT+248                                                  06219000
NVTWTO   EQU   NVT+252                                                  06220000
NVTWTOR  EQU   NVT+256                                                  06221000
NVTWTOR2 EQU   NVT+260                                                  06222000
NVTOPEN  EQU   NVT+264                                                  06223000
NVTMOUNT EQU   NVT+268                                                  06224000
NVTPRMPT EQU   NVT+272                                                  06225000
NVTVIRT  EQU   NVT+276                                                  06226000
NVTREAL  EQU   NVT+280                                                  06227000
NVTSCHED EQU   NVT+284                                                  06228000
NVTOPIO  EQU   NVT+288                                                  06229000
NVTDCBIC EQU   NVT+324                                                  06230000
NVTPAREA EQU   NVT+368                                                  06231000
NVTPTAB  EQU   NVT+372                                                  06232000
NVTXCTL  EQU   NVT+428                                                  06233000
NVTLOCAT EQU   NVT+436                                                  06234000
NVTFLPO  EQU   NVT+528                                                  06235000
UCB      EQU   0                                                        06236000
UCBOB    EQU   0                                                        06237000
UCBJBNR  EQU   UCBOB                                                    06238000
UCBFL5   EQU   UCBOB+1                                                  06239000
UCBAF    EQU   UCBFL5                                                   06240000
UCBSTAT  EQU   UCBOB+3                                                  06241000
UCBONLI  EQU   UCBSTAT                                                  06242000
UCBRESV  EQU   UCBSTAT                                                  06243000
UCBPRES  EQU   UCBSTAT                                                  06244000
UCBCHAN  EQU   UCBOB+4                                                  06245000
UCBSFLS  EQU   UCBOB+6                                                  06246000
UCBFLA   EQU   UCBSFLS                                                  06247000
UCBFL1   EQU   UCBFLA                                                   06248000
UCBBSY   EQU   UCBFL1                                                   06249000
UCBNRY   EQU   UCBFL1                                                   06250000
UCBNOTRD EQU   UCBNRY                                                   06251000
UCBPST   EQU   UCBFL1                                                   06252000
UCBCUB   EQU   UCBFL1                                                   06253000
UCBFLB   EQU   UCBSFLS+1                                                06254000
UCBCHM   EQU   UCBOB+8                                                  06255000
UCBCHM1  EQU   UCBCHM                                                   06256000
UCBPTH0  EQU   UCBCHM1                                                  06257000
UCBPTH1  EQU   UCBCHM1                                                  06258000
UCBWGT   EQU   UCBOB+12                                                 06259000
UCBMTPXP EQU   UCBWGT                                                   06260000
UCBNAME  EQU   UCBOB+13                                                 06261000
UCBTYP   EQU   UCBOB+16                                                 06262000
UCBTBYT1 EQU   UCBTYP                                                   06263000
UCB1FEA5 EQU   UCBTBYT1                                                 06264000
UCB1FEA6 EQU   UCBTBYT1                                                 06265000
UCBTBYT2 EQU   UCBTYP+1                                                 06266000
UCB2OPT2 EQU   UCBTBYT2                                                 06267000
UCBDUDN1 EQU   UCB2OPT2                                                 06268000
UCB2OPT3 EQU   UCBTBYT2                                                 06269000
UCBDUDN2 EQU   UCB2OPT3                                                 06270000
UCB2OPT4 EQU   UCBTBYT2                                                 06271000
UCBRWTAU EQU   UCB2OPT4                                                 06272000
UCBRVDEV EQU   UCBRWTAU                                                 06273000
UCB2OPT6 EQU   UCBTBYT2                                                 06274000
UCB2OPT7 EQU   UCBTBYT2                                                 06275000
UCBTBYT3 EQU   UCBTYP+2                                                 06276000
UCBDVCLS EQU   UCBTBYT3                                                 06277000
UCB3DACC EQU   UCBDVCLS                                                 06278000
UCBTBYT4 EQU   UCBTYP+3                                                 06279000
UCBEXTPT EQU   UCBOB+20                                                 06280000
UCBFLC   EQU   UCBEXTPT                                                 06281000
UCBDEV   EQU   UCBOB+24                                                 06282000
UCBCMEXT EQU   0                                                        06283000
UCBATI   EQU   UCBCMEXT+3                                               06284000
@NM00039 EQU   UCBATI                                                   06285000
UCBFLP1  EQU   UCBCMEXT+5                                               06286000
UCBMT    EQU   0                                                        06287000
UCBOCR   EQU   0                                                        06288000
UCB3540X EQU   0                                                        06289000
UCBDKBYT EQU   UCB3540X+6                                               06290000
UCB3800X EQU   0                                                        06291000
UCBOPTNS EQU   UCB3800X                                                 06292000
UCBACTIV EQU   UCB3800X+3                                               06293000
UCBMDRBF EQU   UCB3800X+36                                              06294000
UCBUCS   EQU   0                                                        06295000
UCBUCSOP EQU   UCBUCS+4                                                 06296000
UCBFCBOP EQU   UCBUCS+5                                                 06297000
NIPPAHDR EQU   0                                                        06298000
NIPPAREA EQU   0                                                        06299000
NIPPARC  EQU   NIPPAREA+8                                               06300000
NIPPABDL EQU   NIPPAREA+12                                              06301000
NIPPABDH EQU   NIPPABDL                                                 06302000
NIPPANAM EQU   NIPPABDL+4                                               06303000
NIPPATTR EQU   NIPPABDL+12                                              06304000
NIPPAIOD EQU   NIPPAREA+32                                              06305000
NIPPASID EQU   NIPPAIOD+32                                              06306000
NIPPAIOB EQU   NIPPAIOD+40                                              06307000
NIPPADCB EQU   NIPPAIOD+80                                              06308000
NIPPAECB EQU   NIPPAIOD+84                                              06309000
NIPPAECC EQU   NIPPAECB                                                 06310000
NIPPADEB EQU   NIPPAIOD+88                                              06311000
NIPPARCD EQU   NIPPAIOD+136                                             06312000
PARMTAB  EQU   0                                                        06313000
VAL      EQU   PARMTAB+232                                              06314000
@NM00079 EQU   PARMTAB+272                                              06315000
NIPPAFLG EQU   @NM00079                                                 06316000
NIPPAFL1 EQU   NIPPAFLG                                                 06317000
NIPPTE   EQU   0                                                        06318000
NIPPTOPF EQU   NIPPTE+4                                                 06319000
NIPPTATF EQU   NIPPTE+5                                                 06320000
NWTOHDR  EQU   0                                                        06321000
NWTOFL   EQU   NWTOHDR+2                                                06322000
NWTORLST EQU   0                                                        06323000
NWTORFL  EQU   NWTORLST+10                                              06324000
NIPSPE   EQU   0                                                        06325000
NIPMNTPL EQU   0                                                        06326000
NMNTDS   EQU   NIPMNTPL                                                 06327000
NMNTVS   EQU   NIPMNTPL+12                                              06328000
NMNTFL   EQU   NIPMNTPL+20                                              06329000
NIPOPNPL EQU   0                                                        06330000
NOPNDS   EQU   NIPOPNPL                                                 06331000
NOPNFL   EQU   NIPOPNPL+20                                              06332000
NIPSCHDL EQU   0                                                        06333000
ECB      EQU   0                                                        06334000
ECBRB    EQU   ECB                                                      06335000
ECBEVTB  EQU   ECBRB                                                    06336000
ECBEXTB  EQU   ECBEVTB                                                  06337000
ECBCC    EQU   ECBEXTB                                                  06338000
ECBCCCNT EQU   ECBEXTB+1                                                06339000
ECBRBA   EQU   ECBCCCNT                                                 06340000
ECBEVTBA EQU   ECBRBA                                                   06341000
ECBEXTBA EQU   ECBEVTBA                                                 06342000
ECBBYTE3 EQU   ECBEXTBA+2                                               06343000
ECBEXTND EQU   ECBBYTE3                                                 06344000
IOBPREFX EQU   0                                                        06345000
IOBCFLG1 EQU   IOBPREFX                                                 06346000
IOBSTDRD EQU   0                                                        06347000
IOBFLAG1 EQU   IOBSTDRD                                                 06348000
IOBCYCCK EQU   IOBFLAG1                                                 06349000
IOBRSTRT EQU   IOBFLAG1                                                 06350000
IOBFLAG2 EQU   IOBSTDRD+1                                               06351000
IOBPURGE EQU   IOBFLAG2                                                 06352000
IOBRDHA0 EQU   IOBFLAG2                                                 06353000
IOBSENS0 EQU   IOBSTDRD+2                                               06354000
IOBS0B7  EQU   IOBSENS0                                                 06355000
IOBSENS1 EQU   IOBSTDRD+3                                               06356000
IOBECBPT EQU   IOBSTDRD+4                                               06357000
IOBFLAG3 EQU   IOBSTDRD+8                                               06358000
IOBFL3   EQU   IOBFLAG3                                                 06359000
IOBCNC   EQU   IOBFL3                                                   06360000
IOBICL   EQU   IOBFL3                                                   06361000
IOBCSW   EQU   IOBSTDRD+9                                               06362000
IOBIOCSW EQU   IOBCSW                                                   06363000
IOBSTBYT EQU   IOBIOCSW+3                                               06364000
IOBUSTAT EQU   IOBSTBYT                                                 06365000
IOBCSTAT EQU   IOBSTBYT+1                                               06366000
IOBSTART EQU   IOBSTDRD+16                                              06367000
IOBDCBPT EQU   IOBSTDRD+20                                              06368000
IOBFLAG4 EQU   IOBDCBPT                                                 06369000
IOBRESTR EQU   IOBSTDRD+24                                              06370000
IOBINCAM EQU   IOBSTDRD+28                                              06371000
IOBBTAMF EQU   IOBINCAM                                                 06372000
IOBERRCT EQU   IOBSTDRD+30                                              06373000
DEBBASIC EQU   0                                                        06374000
DEBTCBAD EQU   DEBBASIC                                                 06375000
DEBDEBAD EQU   DEBBASIC+4                                               06376000
DEBIRBAD EQU   DEBBASIC+8                                               06377000
DEBOFLGS EQU   DEBIRBAD                                                 06378000
DEBOPATB EQU   DEBBASIC+12                                              06379000
DEBFLGS1 EQU   DEBBASIC+14                                              06380000
DEBUSRPG EQU   DEBBASIC+16                                              06381000
DEBNMEXT EQU   DEBUSRPG                                                 06382000
DEBRRQ   EQU   DEBBASIC+20                                              06383000
DEBECBAD EQU   DEBRRQ                                                   06384000
DEBDCBAD EQU   DEBBASIC+24                                              06385000
DEBPROTG EQU   DEBDCBAD                                                 06386000
DEBDEBID EQU   DEBPROTG                                                 06387000
DEBDCBB  EQU   DEBDCBAD+1                                               06388000
DEBAPPAD EQU   DEBBASIC+28                                              06389000
DEBEXSCL EQU   DEBAPPAD                                                 06390000
DEBAPPB  EQU   DEBAPPAD+1                                               06391000
DEBBASND EQU   DEBBASIC+32                                              06392000
DEBDASD  EQU   0                                                        06393000
DEBUCBAD EQU   DEBDASD                                                  06394000
DEBUCBA  EQU   DEBUCBAD+1                                               06395000
DEBENDCC EQU   DEBDASD+10                                               06396000
DEBENDHH EQU   DEBDASD+12                                               06397000
DEBNMTRK EQU   DEBDASD+14                                               06398000
DEBACSMD EQU   0                                                        06399000
DEBVOLSQ EQU   DEBACSMD                                                 06400000
DEBVOLBT EQU   DEBVOLSQ                                                 06401000
DEBDSNM  EQU   DEBACSMD+4                                               06402000
DEBUTSAA EQU   DEBDSNM                                                  06403000
DEBACS01 EQU   0                                                        06404000
DEBDSNAM EQU   DEBACS01                                                 06405000
DEBACS02 EQU   0                                                        06406000
DEBDBLK  EQU   DEBACS02                                                 06407000
DEBACS03 EQU   0                                                        06408000
DEBACS04 EQU   0                                                        06409000
DEBTBFRA EQU   DEBACS04                                                 06410000
DEBTCCWA EQU   DEBACS04+4                                               06411000
DEBACS05 EQU   0                                                        06412000
DEBFUCBA EQU   DEBACS05                                                 06413000
DEBLUCBA EQU   DEBACS05+4                                               06414000
DEBACS06 EQU   0                                                        06415000
DEBACS07 EQU   0                                                        06416000
DEBACS08 EQU   0                                                        06417000
DEBSUBNM EQU   0                                                        06418000
DEB      EQU   0                                                        06419000
DEBAVT   EQU   DEB                                                      06420000
DEBEOEA  EQU   DEBAVT                                                   06421000
DEBEOEAB EQU   DEBEOEA                                                  06422000
DEBSIOA  EQU   DEBAVT+4                                                 06423000
DEBSIOAB EQU   DEBSIOA                                                  06424000
DEBPCIA  EQU   DEBAVT+8                                                 06425000
DEBPCIAB EQU   DEBPCIA                                                  06426000
DEBCEA   EQU   DEBAVT+12                                                06427000
DEBCEAB  EQU   DEBCEA                                                   06428000
DEBXCEA  EQU   DEBAVT+16                                                06429000
DEBXCEAB EQU   DEBXCEA                                                  06430000
DEBPREFX EQU   DEB+20                                                   06431000
DEBXTNP  EQU   DEBPREFX+8                                               06432000
DEBXTN   EQU   0                                                        06433000
DEBXFLG1 EQU   DEBXTN+2                                                 06434000
DEVMSG   EQU   0                                                        06435000
UNITAD   EQU   DEVMSG                                                   06436000
COM      EQU   DEVMSG+3                                                 06437000
NIPPMAD0 EQU   0                                                        06438000
NIPPMAD4 EQU   0                                                        06439000
NIPPMBYT EQU   0                                                        06440000
NIPPMBUF EQU   0                                                        06441000
NIPPMSID EQU   0                                                        06442000
NIPPMCC  EQU   NIPPMSID                                                 06443000
NIPPMHH  EQU   NIPPMSID+2                                               06444000
NIPPMR   EQU   NIPPMSID+4                                               06445000
NIPPMCSW EQU   0                                                        06446000
NIPPMCS2 EQU   NIPPMCSW+3                                               06447000
NIPPMME1 EQU   0                                                        06448000
NIPPMME2 EQU   0                                                        06449000
I001C    EQU   0                                                        06450000
I008P    EQU   0                                                        06451000
I015F    EQU   0                                                        06452000
I015P    EQU   0                                                        06453000
I031F    EQU   0                                                        06454000
I031P    EQU   0                                                        06455000
I256C    EQU   0                                                        06456000
UCBBGN   EQU   0                                                        06457000
@NM00003 EQU   NIPPANAM                                                 06458000
PLIBMEM  EQU   @NM00003                                                 06459000
SUFFIX   EQU   @NM00003+6                                               06460000
REPLAREA EQU   WTORBUF                                                  06461000
REPENTRY EQU   REPLAREA                                                 06462000
UNIT     EQU   REPENTRY                                                 06463000
DELIM    EQU   REPENTRY+3                                               06464000
SCAN4    EQU   WTORBUF                                                  06465000
SCAN3    EQU   SCAN4                                                    06466000
SCAN2    EQU   SCAN3                                                    06467000
SCAN2A   EQU   SCAN3+2                                                  06468000
@NM00016 EQU   VAPDCB1                                                  06469000
DCBMACRF EQU   @NM00016                                                 06470000
DCBDEBAD EQU   @NM00016+5                                               06471000
DCBOFLGS EQU   @NM00016+8                                               06472000
CVTS01   EQU   CVTPGSIA                                                 06473000
CVTLPDIA EQU   CVTS01+12                                                06474000
CVTDIRST EQU   CVTLPDIA                                                 06475000
CVTSLIDA EQU   CVTS01+24                                                06476000
CVTCTLFG EQU   CVTS01+50                                                06477000
CVTRV210 EQU   CVTS01+424                                               06478000
CVTRV219 EQU   CVTS01+425                                               06479000
CVTRV228 EQU   CVTS01+426                                               06480000
CVTRV237 EQU   CVTS01+427                                               06481000
CVTMFRTR EQU   CVTS01+452                                               06482000
CVTRV262 EQU   CVTS01+468                                               06483000
CVTRV271 EQU   CVTS01+469                                               06484000
CVTRV280 EQU   CVTS01+470                                               06485000
CVTRV289 EQU   CVTS01+471                                               06486000
CVTGSDA  EQU   CVTS01+600                                               06487000
UCBOBS01 EQU   UCBDEV                                                   06488000
UCBVTOC  EQU   UCBOBS01                                                 06489000
UCBVOLI  EQU   UCBOBS01+4                                               06490000
UCBSTAB  EQU   UCBOBS01+10                                              06491000
UCBBSVL  EQU   UCBSTAB                                                  06492000
UCBPRSRS EQU   UCBSTAB                                                  06493000
UCBBPRV  EQU   UCBSTAB                                                  06494000
UCBBPUB  EQU   UCBSTAB                                                  06495000
UCBBSTR  EQU   UCBSTAB                                                  06496000
UCBDMCT  EQU   UCBOBS01+11                                              06497000
UCBFL4   EQU   UCBOBS01+13                                              06498000
UCBBASE  EQU   UCBOBS01+16                                              06499000
UCBOBS02 EQU   UCBDEV                                                   06500000
UCBTFL1  EQU   UCBOBS02+19                                              06501000
UCBXTN   EQU   UCBOBS02+20                                              06502000
UCBVOPT  EQU   UCBXTN                                                   06503000
UCBOBS03 EQU   UCBDEV                                                   06504000
UCBXTADR EQU   UCBOBS03                                                 06505000
UCBOBS04 EQU   UCBDEV                                                   06506000
UCBBTA   EQU   UCBOBS04+12                                              06507000
UCBOBS06 EQU   UCBDEV                                                   06508000
UCBAOF   EQU   UCBOBS06                                                 06509000
UCBAOF1  EQU   UCBAOF                                                   06510000
UCBAOF2  EQU   UCBAOF+1                                                 06511000
@NM00038 EQU   UCBOBS06+3                                               06512000
UCBIRB   EQU   UCBOBS06+4                                               06513000
UCBGRAF  EQU   UCBIRB                                                   06514000
UCBLDNCA EQU   UCBOBS06+8                                               06515000
UCBRDYQ  EQU   UCBLDNCA                                                 06516000
UCBIRLN  EQU   UCBRDYQ                                                  06517000
UCBLDNCB EQU   UCBRDYQ+1                                                06518000
UCBCTLNK EQU   UCBOBS06+12                                              06519000
UCBOBS07 EQU   UCBDEV                                                   06520000
UCBOBS08 EQU   UCBDEV                                                   06521000
UCBCTCAD EQU   UCBOBS08                                                 06522000
UCBCTCF1 EQU   UCBOBS08+4                                               06523000
UCBOBS09 EQU   UCBDEV                                                   06524000
IOBORG01 EQU   IOBPREFX+8                                               06525000
IOBNIOBA EQU   IOBORG01                                                 06526000
IOBNFLG1 EQU   IOBNIOBA                                                 06527000
IOBPRTOV EQU   IOBNFLG1                                                 06528000
IOBORG02 EQU   IOBPREFX+8                                               06529000
IOBDQADA EQU   IOBORG02                                                 06530000
IOBDEQIN EQU   IOBDQADA                                                 06531000
IOBORG03 EQU   IOBPREFX+12                                              06532000
IOBORG04 EQU   IOBINCAM                                                 06533000
IOBORG12 EQU   IOBINCAM                                                 06534000
IOBFL4   EQU   IOBORG12                                                 06535000
IOBEXTEN EQU   IOBSTDRD+32                                              06536000
IOBSEEK  EQU   IOBEXTEN                                                 06537000
IOBBB    EQU   IOBSEEK+1                                                06538000
IOBCC    EQU   IOBSEEK+3                                                06539000
IOBHH    EQU   IOBSEEK+5                                                06540000
IOBR     EQU   IOBSEEK+7                                                06541000
IOBORG05 EQU   IOBEXTEN                                                 06542000
IOBORG06 EQU   IOBEXTEN                                                 06543000
IOBNXTPT EQU   IOBORG06+4                                               06544000
IOBSTATA EQU   IOBNXTPT                                                 06545000
IOBORG07 EQU   IOBEXTEN+8                                               06546000
W1IEXTEN EQU   IOBORG07                                                 06547000
IOBORG08 EQU   IOBEXTEN+8                                               06548000
IOBINDCT EQU   IOBORG08+4                                               06549000
IOBUNSQR EQU   IOBORG08+5                                               06550000
IOBFCHAD EQU   IOBORG08+8                                               06551000
IOBORG09 EQU   IOBEXTEN+8                                               06552000
IOBDPLAD EQU   IOBORG09+4                                               06553000
IOBDTYPE EQU   IOBORG09+8                                               06554000
IOBDTYP2 EQU   IOBORG09+9                                               06555000
IOBDSTAT EQU   IOBORG09+10                                              06556000
IOBSTAT1 EQU   IOBDSTAT                                                 06557000
IOBORG10 EQU   IOBEXTEN+8                                               06558000
IOBSEEK2 EQU   IOBORG10                                                 06559000
IOBORG11 EQU   IOBEXTEN                                                 06560000
IOBERCT  EQU   IOBORG11                                                 06561000
IOBUCBXV EQU   IOBERCT                                                  06562000
IOBNAME  EQU   IOBORG11+4                                               06563000
IOBORG13 EQU   IOBEXTEN                                                 06564000
IOBSKADR EQU   IOBORG13                                                 06565000
DEBBAS02 EQU   DEBBASND                                                 06566000
DEBDDS1  EQU   DEBBAS02                                                 06567000
DEBSUCBA EQU   DEBDDS1                                                  06568000
DEBDEVED EQU   DEBDDS1+4                                                06569000
DEBRDCB  EQU   DEBDDS1+4                                                06570000
DEBPDCB  EQU   DEBDDS1+8                                                06571000
DEBWDCB  EQU   DEBDDS1+12                                               06572000
DEBACS09 EQU   DEBDEVED                                                 06573000
DEBASC09 EQU   DEBACS09                                                 06574000
DEBEAMFG EQU   DEBASC09+3                                               06575000
DEBDSID  EQU   DEBASC09+4                                               06576000
DEBEOD   EQU   DEBASC09+12                                              06577000
DEBBOE   EQU   DEBEOD                                                   06578000
DEBEODRV EQU   DEBBOE                                                   06579000
DEBEODTT EQU   DEBBOE+1                                                 06580000
DEBEOD0  EQU   DEBBOE+2                                                 06581000
DEBEODSS EQU   DEBBOE+3                                                 06582000
DEBBAS01 EQU   DEBBASND                                                 06583000
DEBISAM  EQU   DEBBAS01                                                 06584000
DEBFIEAD EQU   DEBISAM                                                  06585000
DEBFPEAD EQU   DEBISAM+4                                                06586000
DEBFOEAD EQU   DEBISAM+8                                                06587000
DEBEXPT  EQU   DEBISAM+12                                               06588000
DEBRPSID EQU   DEBEXPT                                                  06589000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    06590000
DEBEXPTA EQU   DEBEXPT+1                                                06591000
DEBRSV12 EQU   DEBRPSID                                                 06592000
DEBRSV11 EQU   DEBRPSID                                                 06593000
DEBRSV10 EQU   DEBRPSID                                                 06594000
DEBRSV09 EQU   DEBRPSID                                                 06595000
DEBRPSAP EQU   DEBRPSID                                                 06596000
DEBRPSO  EQU   DEBRPSID                                                 06597000
DEBRPSI  EQU   DEBRPSID                                                 06598000
DEBRPSP  EQU   DEBRPSID                                                 06599000
DEBFOEB  EQU   DEBFOEAD+1                                               06600000
DEBNOEE  EQU   DEBFOEAD                                                 06601000
DEBFPEB  EQU   DEBFPEAD+1                                               06602000
DEBNPEE  EQU   DEBFPEAD                                                 06603000
DEBFIEB  EQU   DEBFIEAD+1                                               06604000
DEBNIEE  EQU   DEBFIEAD                                                 06605000
DEBBOESS EQU   DEBEODSS                                                 06606000
DEBBOE0  EQU   DEBEOD0                                                  06607000
DEBBOETT EQU   DEBEODTT                                                 06608000
DEBBOERV EQU   DEBEODRV                                                 06609000
DEBRV008 EQU   DEBDSID+7                                                06610000
DEBWTPTI EQU   DEBDSID+6                                                06611000
DEBEXDTE EQU   DEBDSID                                                  06612000
DEBRV007 EQU   DEBEAMFG                                                 06613000
DEBRV006 EQU   DEBEAMFG                                                 06614000
DEBRV005 EQU   DEBEAMFG                                                 06615000
DEBRV004 EQU   DEBEAMFG                                                 06616000
DEBSECVL EQU   DEBEAMFG                                                 06617000
DEBVAMSG EQU   DEBEAMFG                                                 06618000
DEBDSOPN EQU   DEBEAMFG                                                 06619000
DEBMULTI EQU   DEBEAMFG                                                 06620000
DEBVSEQU EQU   DEBASC09+2                                               06621000
DEBDSSQL EQU   DEBASC09+1                                               06622000
DEBVOLAC EQU   DEBASC09                                                 06623000
DEBWDCBA EQU   DEBWDCB+1                                                06624000
DEBRSV08 EQU   DEBWDCB                                                  06625000
DEBPDCBA EQU   DEBPDCB+1                                                06626000
DEBRSV07 EQU   DEBPDCB                                                  06627000
DEBRDCBA EQU   DEBRDCB+1                                                06628000
DEBRSV06 EQU   DEBRDCB                                                  06629000
DEBSUCBB EQU   DEBSUCBA+1                                               06630000
DEBSDVM  EQU   DEBSUCBA                                                 06631000
IOBSKSS  EQU   IOBSKADR+3                                               06632000
IOBSK0   EQU   IOBSKADR+2                                               06633000
IOBSKTT  EQU   IOBSKADR+1                                               06634000
IOBSKRV  EQU   IOBSKADR                                                 06635000
IOBCSWSV EQU   IOBORG11+17                                              06636000
IOBSENSV EQU   IOBORG11+16                                              06637000
IOBRCD   EQU   IOBORG11+12                                              06638000
IOBMDREC EQU   IOBORG11+8                                               06639000
IOBNAMEA EQU   IOBNAME+1                                                06640000
IOBNAMSZ EQU   IOBNAME                                                  06641000
IOBERCTA EQU   IOBERCT+1                                                06642000
IOBRTYPE EQU   IOBUCBXV                                                 06643000
IOBRDCHP EQU   IOBORG10+20                                              06644000
IOBNEXTA EQU   IOBORG10+16                                              06645000
IOBREADA EQU   IOBORG10+12                                              06646000
IOBBUFC  EQU   IOBORG10+8                                               06647000
IOBSK2R  EQU   IOBSEEK2+7                                               06648000
IOBSK2HH EQU   IOBSEEK2+5                                               06649000
IOBSK2CC EQU   IOBSEEK2+3                                               06650000
IOBSK2BB EQU   IOBSEEK2+1                                               06651000
IOBSK2M  EQU   IOBSEEK2                                                 06652000
IOBCHNPR EQU   IOBORG09+40                                              06653000
IOBDNCRF EQU   IOBORG09+32                                              06654000
IOBRSV35 EQU   IOBORG09+24                                              06655000
IOBDQPTR EQU   IOBORG09+20                                              06656000
IOBRSV34 EQU   IOBORG09+18                                              06657000
IOBDBYTN EQU   IOBORG09+16                                              06658000
IOBDCPND EQU   IOBORG09+12                                              06659000
IOBSTAT2 EQU   IOBDSTAT+1                                               06660000
IOBSIORT EQU   IOBSTAT1                                                 06661000
IOBADDVU EQU   IOBSTAT1                                                 06662000
IOBBUFF  EQU   IOBSTAT1                                                 06663000
IOBENQUE EQU   IOBSTAT1                                                 06664000
IOBPASS2 EQU   IOBSTAT1                                                 06665000
IOBSYNCH EQU   IOBSTAT1                                                 06666000
IOBNEWVL EQU   IOBSTAT1                                                 06667000
IOBABNRM EQU   IOBSTAT1                                                 06668000
IOBRELEX EQU   IOBDTYP2                                                 06669000
IOBADDTY EQU   IOBDTYP2                                                 06670000
IOBTYPE  EQU   IOBDTYP2                                                 06671000
IOBRQUST EQU   IOBDTYP2                                                 06672000
IOBSUFFX EQU   IOBDTYP2                                                 06673000
IOBSBLKL EQU   IOBDTYP2                                                 06674000
IOBSKEY  EQU   IOBDTYP2                                                 06675000
IOBRELBL EQU   IOBDTYPE                                                 06676000
IOBRDEXC EQU   IOBDTYPE                                                 06677000
IOBDYNBF EQU   IOBDTYPE                                                 06678000
IOBACTAD EQU   IOBDTYPE                                                 06679000
IOBFDBCK EQU   IOBDTYPE                                                 06680000
IOBEXTSC EQU   IOBDTYPE                                                 06681000
IOBOVFLO EQU   IOBDTYPE                                                 06682000
IOBVERFY EQU   IOBDTYPE                                                 06683000
IOBDPLB  EQU   IOBDPLAD+1                                               06684000
IOBDAYLI EQU   IOBDPLAD                                                 06685000
IOBDIOBS EQU   IOBORG09+2                                               06686000
IOBDBYTR EQU   IOBORG09                                                 06687000
IOBBCHAD EQU   IOBORG08+12                                              06688000
IOBFCHNB EQU   IOBFCHAD+1                                               06689000
IOBCOUNT EQU   IOBFCHAD                                                 06690000
IOBASYN  EQU   IOBORG08+7                                               06691000
IOBAPP   EQU   IOBORG08+6                                               06692000
IOBRSV32 EQU   IOBUNSQR                                                 06693000
IOBRSV31 EQU   IOBUNSQR                                                 06694000
IOBRSV30 EQU   IOBUNSQR                                                 06695000
IOBKNRWR EQU   IOBUNSQR                                                 06696000
IOBKNWR  EQU   IOBUNSQR                                                 06697000
IOBNTAV2 EQU   IOBUNSQR                                                 06698000
IOBNTAV1 EQU   IOBUNSQR                                                 06699000
IOBCPBSY EQU   IOBUNSQR                                                 06700000
IOBCHNNL EQU   IOBINDCT                                                 06701000
IOBRSV29 EQU   IOBINDCT                                                 06702000
IOBRSV28 EQU   IOBINDCT                                                 06703000
IOBRSV27 EQU   IOBINDCT                                                 06704000
IOBKEYAD EQU   IOBINDCT                                                 06705000
IOBOVPTR EQU   IOBINDCT                                                 06706000
IOBUNSCH EQU   IOBINDCT                                                 06707000
IOBDEQCP EQU   IOBINDCT                                                 06708000
IOBCCWAD EQU   IOBORG08                                                 06709000
W1OEXTEN EQU   W1IEXTEN                                                 06710000
IOBCCW   EQU   IOBORG06+8                                               06711000
IOBNXTPB EQU   IOBNXTPT+1                                               06712000
IOBRSV26 EQU   IOBSTATA                                                 06713000
IOBRSV25 EQU   IOBSTATA                                                 06714000
IOBRSV24 EQU   IOBSTATA                                                 06715000
IOBRSV23 EQU   IOBSTATA                                                 06716000
IOBRSV22 EQU   IOBSTATA                                                 06717000
IOBRSV21 EQU   IOBSTATA                                                 06718000
IOBRSV20 EQU   IOBSTATA                                                 06719000
IOBAVLFL EQU   IOBSTATA                                                 06720000
IOBRSV37 EQU   IOBORG06+1                                               06721000
IOBUCBXG EQU   IOBORG06                                                 06722000
IOBCPA   EQU   IOBORG05+32                                              06723000
IOBERINF EQU   IOBORG05+16                                              06724000
IOBERCCW EQU   IOBORG05+8                                               06725000
IOBSNDPT EQU   IOBORG05+7                                               06726000
IOBRCVPT EQU   IOBORG05+6                                               06727000
IOBWORK  EQU   IOBORG05+1                                               06728000
IOBUCBX  EQU   IOBORG05                                                 06729000
IOBHH2   EQU   IOBHH+1                                                  06730000
IOBHH1   EQU   IOBHH                                                    06731000
IOBCC2   EQU   IOBCC+1                                                  06732000
IOBCC1   EQU   IOBCC                                                    06733000
IOBBB2   EQU   IOBBB+1                                                  06734000
IOBBB1   EQU   IOBBB                                                    06735000
IOBM     EQU   IOBSEEK                                                  06736000
IOBRSV46 EQU   IOBFL4                                                   06737000
IOBRSV47 EQU   IOBFL4                                                   06738000
IOBENT   EQU   IOBFL4                                                   06739000
IOBEQP   EQU   IOBFL4                                                   06740000
IOBBUS   EQU   IOBFL4                                                   06741000
IOBDCK   EQU   IOBFL4                                                   06742000
IOBREJ   EQU   IOBFL4                                                   06743000
IOBOVR   EQU   IOBFL4                                                   06744000
IOBCRILC EQU   IOBORG04+1                                               06745000
IOBCRDCC EQU   IOBORG04                                                 06746000
IOBGQECB EQU   IOBORG03                                                 06747000
IOBSWAP  EQU   IOBORG02+4                                               06748000
IOBDQADB EQU   IOBDQADA+1                                               06749000
IOBRSV13 EQU   IOBDEQIN                                                 06750000
IOBRSV12 EQU   IOBDEQIN                                                 06751000
IOBRSV11 EQU   IOBDEQIN                                                 06752000
IOBRSV10 EQU   IOBDEQIN                                                 06753000
IOBRSV09 EQU   IOBDEQIN                                                 06754000
IOBRSV08 EQU   IOBDEQIN                                                 06755000
IOBRSV07 EQU   IOBDEQIN                                                 06756000
IOBDEQ   EQU   IOBDEQIN                                                 06757000
IOBNECB  EQU   IOBORG01+4                                               06758000
IOBNIOBB EQU   IOBNIOBA+1                                               06759000
IOBFIRST EQU   IOBNFLG1                                                 06760000
IOBUPERR EQU   IOBNFLG1                                                 06761000
IOBSPAN  EQU   IOBNFLG1                                                 06762000
IOBBKSPC EQU   IOBNFLG1                                                 06763000
IOBUPDAT EQU   IOBNFLG1                                                 06764000
IOBREAD  EQU   IOBNFLG1                                                 06765000
IOBWRITE EQU   IOBNFLG1                                                 06766000
IOBSEGMT EQU   IOBPRTOV                                                 06767000
UCBRV066 EQU   UCBOBS09+4                                               06768000
UCBIOSBA EQU   UCBOBS09                                                 06769000
UCBRV042 EQU   UCBOBS08+5                                               06770000
UCBRV082 EQU   UCBCTCF1                                                 06771000
UCBRV081 EQU   UCBCTCF1                                                 06772000
UCBRV080 EQU   UCBCTCF1                                                 06773000
UCBRV079 EQU   UCBCTCF1                                                 06774000
UCBRV078 EQU   UCBCTCF1                                                 06775000
UCBRV077 EQU   UCBCTCF1                                                 06776000
UCBRV076 EQU   UCBCTCF1                                                 06777000
UCBCTC80 EQU   UCBCTCF1                                                 06778000
UCBCTCAL EQU   UCBCTCAD                                                 06779000
UCBICNCB EQU   UCBOBS07+4                                               06780000
UCBRV040 EQU   UCBOBS07                                                 06781000
UCBCTLNA EQU   UCBCTLNK+1                                               06782000
UCBRLN   EQU   UCBCTLNK                                                 06783000
UCBRDYQA EQU   UCBLDNCB                                                 06784000
UCBINRLN EQU   UCBIRLN                                                  06785000
UCBIRBA  EQU   UCBIRB+1                                                 06786000
UCBRV039 EQU   UCBGRAF                                                  06787000
UCBDWNR  EQU   UCBGRAF                                                  06788000
UCBRPND  EQU   UCBGRAF                                                  06789000
UCBUPM   EQU   UCBGRAF                                                  06790000
UCBBTAM  EQU   UCBGRAF                                                  06791000
UCBDRNO  EQU   UCBGRAF                                                  06792000
UCBDRO   EQU   UCBGRAF                                                  06793000
UCBOIP   EQU   UCBGRAF                                                  06794000
UCBATRCD EQU   @NM00038                                                 06795000
UCBSKPFG EQU   @NM00038                                                 06796000
UCBRIPND EQU   @NM00038                                                 06797000
UCBRTIAC EQU   @NM00038                                                 06798000
UCBRSV79 EQU   @NM00038                                                 06799000
UCBRSV78 EQU   @NM00038                                                 06800000
UCBRSV77 EQU   @NM00038                                                 06801000
UCBOLTEP EQU   @NM00038                                                 06802000
UCBATNCT EQU   UCBOBS06+2                                               06803000
UCBRSV76 EQU   UCBAOF2                                                  06804000
UCBRSV75 EQU   UCBAOF2                                                  06805000
UCBRSV74 EQU   UCBAOF2                                                  06806000
UCBRSV73 EQU   UCBAOF2                                                  06807000
UCBRSV72 EQU   UCBAOF2                                                  06808000
UCBRSV71 EQU   UCBAOF2                                                  06809000
UCBRSV70 EQU   UCBAOF2                                                  06810000
UCBRSV69 EQU   UCBAOF2                                                  06811000
UCBRSV68 EQU   UCBAOF1                                                  06812000
UCBRSV67 EQU   UCBAOF1                                                  06813000
UCBRSV66 EQU   UCBAOF1                                                  06814000
UCBRSV65 EQU   UCBAOF1                                                  06815000
UCBRSV64 EQU   UCBAOF1                                                  06816000
UCBOFNL  EQU   UCBAOF1                                                  06817000
UCBOFSP  EQU   UCBAOF1                                                  06818000
UCBOFMCR EQU   UCBAOF1                                                  06819000
UCBBTB   EQU   UCBBTA+1                                                 06820000
UCBDI    EQU   UCBBTA                                                   06821000
UCBSNS   EQU   UCBOBS04+8                                               06822000
UCBTEB   EQU   UCBOBS04+4                                               06823000
UCBGCB   EQU   UCBOBS04+3                                               06824000
UCBOPEN  EQU   UCBOBS04+2                                               06825000
UCBSTART EQU   UCBOBS04                                                 06826000
UCBXTNB  EQU   UCBXTN+1                                                 06827000
UCBRSV22 EQU   UCBVOPT                                                  06828000
UCBRSV21 EQU   UCBVOPT                                                  06829000
UCBRSV20 EQU   UCBVOPT                                                  06830000
UCBESVE  EQU   UCBVOPT                                                  06831000
UCBERPC  EQU   UCBVOPT                                                  06832000
UCBESVC  EQU   UCBVOPT                                                  06833000
UCBEVA   EQU   UCBVOPT                                                  06834000
UCBESV   EQU   UCBVOPT                                                  06835000
UCBRV009 EQU   UCBTFL1                                                  06836000
UCBRV008 EQU   UCBTFL1                                                  06837000
UCBRV007 EQU   UCBTFL1                                                  06838000
UCBRV006 EQU   UCBTFL1                                                  06839000
UCBRV005 EQU   UCBTFL1                                                  06840000
UCBRV038 EQU   UCBTFL1                                                  06841000
UCBNSLTP EQU   UCBTFL1                                                  06842000
UCBNLTP  EQU   UCBTFL1                                                  06843000
UCBRES1B EQU   UCBOBS02+18                                              06844000
UCBFSER  EQU   UCBOBS02+12                                              06845000
@NM00037 EQU   UCBOBS02+4                                               06846000
UCBFSEQ  EQU   UCBOBS02+2                                               06847000
UCBFSCT  EQU   UCBOBS02                                                 06848000
UCBNEXP  EQU   UCBOBS01+20                                              06849000
UCBRES1A EQU   UCBOBS01+15                                              06850000
UCBUSER  EQU   UCBOBS01+14                                              06851000
UCBFL47  EQU   UCBFL4                                                   06852000
UCBMAT   EQU   UCBFL4                                                   06853000
UCBHOLD  EQU   UCBFL4                                                   06854000
UCBATTN  EQU   UCBFL4                                                   06855000
UCBDSS   EQU   UCBFL4                                                   06856000
UCBRESVP EQU   UCBFL4                                                   06857000
UCBWDAV  EQU   UCBFL4                                                   06858000
UCBDAVV  EQU   UCBFL4                                                   06859000
UCBSQC   EQU   UCBOBS01+12                                              06860000
UCBDATP  EQU   UCBOBS01+12                                              06861000
UCBDMC   EQU   UCBDMCT                                                  06862000
UCBMOUNT EQU   UCBDMCT                                                  06863000
UCBBNUL  EQU   UCBSTAB                                                  06864000
UCBSHAR  EQU   UCBSTAB                                                  06865000
UCBBALB  EQU   UCBPRSRS                                                 06866000
UCBPGFL  EQU   UCBSTAB                                                  06867000
UCBDVSHR EQU   UCBBSVL                                                  06868000
CVTRV628 EQU   CVTS01+728                                               06869000
CVTRV627 EQU   CVTS01+724                                               06870000
CVTRV626 EQU   CVTS01+720                                               06871000
CVTRV625 EQU   CVTS01+716                                               06872000
CVTRV624 EQU   CVTS01+712                                               06873000
CVTRV623 EQU   CVTS01+708                                               06874000
CVTRV622 EQU   CVTS01+704                                               06875000
CVTRV621 EQU   CVTS01+700                                               06876000
CVTIHASU EQU   CVTS01+696                                               06877000
CVTRV619 EQU   CVTS01+692                                               06878000
CVTRV618 EQU   CVTS01+688                                               06879000
CVTRV617 EQU   CVTS01+684                                               06880000
CVTRV616 EQU   CVTS01+680                                               06881000
CVTRV615 EQU   CVTS01+676                                               06882000
CVTRV614 EQU   CVTS01+672                                               06883000
CVTRV613 EQU   CVTS01+668                                               06884000
CVTTCASP EQU   CVTS01+664                                               06885000
CVT0PT03 EQU   CVTS01+660                                               06886000
CVT0PT0E EQU   CVTS01+656                                               06887000
CVTRV609 EQU   CVTS01+652                                               06888000
CVTCGK   EQU   CVTS01+648                                               06889000
CVTRAC   EQU   CVTS01+644                                               06890000
CVTRV606 EQU   CVTS01+640                                               06891000
CVTRV605 EQU   CVTS01+636                                               06892000
CVTRV604 EQU   CVTS01+632                                               06893000
CVTEFF02 EQU   CVTS01+628                                               06894000
CVTCBBR  EQU   CVTS01+624                                               06895000
CVTSSCR  EQU   CVTS01+620                                               06896000
CVTEVENT EQU   CVTS01+616                                               06897000
CVTCRCA  EQU   CVTS01+612                                               06898000
CVTTPIO  EQU   CVTS01+608                                               06899000
CVTADV   EQU   CVTS01+604                                               06900000
CVTGSDAB EQU   CVTGSDA                                                  06901000
CVTQV3   EQU   CVTS01+596                                               06902000
CVTQV2   EQU   CVTS01+592                                               06903000
CVTQV1   EQU   CVTS01+588                                               06904000
CVTRPT   EQU   CVTS01+584                                               06905000
CVTSSRB  EQU   CVTS01+580                                               06906000
CVTCSDRL EQU   CVTS01+576                                               06907000
CVTEXP1  EQU   CVTS01+572                                               06908000
CVTRMPMT EQU   CVTS01+568                                               06909000
CVTRMPTT EQU   CVTS01+564                                               06910000
CVTVPSA  EQU   CVTS01+560                                               06911000
CVTVSTOP EQU   CVTS01+556                                               06912000
CVTGTFR8 EQU   CVTS01+552                                               06913000
CVTQUIT  EQU   CVTS01+548                                               06914000
CVTVACR  EQU   CVTS01+544                                               06915000
CVTWTCB  EQU   CVTS01+540                                               06916000
CVTSTPRS EQU   CVTS01+536                                               06917000
CVT0PT02 EQU   CVTS01+532                                               06918000
CVTDARCM EQU   CVTS01+528                                               06919000
CVTIRECM EQU   CVTS01+524                                               06920000
CVTJRECM EQU   CVTS01+520                                               06921000
CVTVEMS0 EQU   CVTS01+516                                               06922000
CVTSPFRR EQU   CVTS01+512                                               06923000
CVTRLSTG EQU   CVTS01+508                                               06924000
CVT0TC0A EQU   CVTS01+504                                               06925000
CVTGMBR  EQU   CVTS01+500                                               06926000
CVTLFRM  EQU   CVTS01+496                                               06927000
CVTRMBR  EQU   CVTS01+492                                               06928000
CVTVIOP  EQU   CVTS01+488                                               06929000
CVTRV307 EQU   CVTS01+486                                               06930000
CVTRV306 EQU   CVTS01+484                                               06931000
CVTRV305 EQU   CVTS01+482                                               06932000
CVTRV304 EQU   CVTS01+480                                               06933000
CVTRV303 EQU   CVTS01+478                                               06934000
CVTRV302 EQU   CVTS01+476                                               06935000
CVTTRCA  EQU   CVTS01+472                                               06936000
CVTRV297 EQU   CVTRV289                                                 06937000
CVTRV296 EQU   CVTRV289                                                 06938000
CVTRV295 EQU   CVTRV289                                                 06939000
CVTRV294 EQU   CVTRV289                                                 06940000
CVTRV293 EQU   CVTRV289                                                 06941000
CVTRV292 EQU   CVTRV289                                                 06942000
CVTRV291 EQU   CVTRV289                                                 06943000
CVTRV290 EQU   CVTRV289                                                 06944000
CVTRV288 EQU   CVTRV280                                                 06945000
CVTRV287 EQU   CVTRV280                                                 06946000
CVTRV286 EQU   CVTRV280                                                 06947000
CVTRV285 EQU   CVTRV280                                                 06948000
CVTRV284 EQU   CVTRV280                                                 06949000
CVTRV283 EQU   CVTRV280                                                 06950000
CVTRV282 EQU   CVTRV280                                                 06951000
CVTRV281 EQU   CVTRV280                                                 06952000
CVTRV279 EQU   CVTRV271                                                 06953000
CVTRV278 EQU   CVTRV271                                                 06954000
CVTRV277 EQU   CVTRV271                                                 06955000
CVTRV276 EQU   CVTRV271                                                 06956000
CVTRV275 EQU   CVTRV271                                                 06957000
CVTRV274 EQU   CVTRV271                                                 06958000
CVTRV273 EQU   CVTRV271                                                 06959000
CVTRV272 EQU   CVTRV271                                                 06960000
CVTRV270 EQU   CVTRV262                                                 06961000
CVTRV269 EQU   CVTRV262                                                 06962000
CVTRV268 EQU   CVTRV262                                                 06963000
CVTRV267 EQU   CVTRV262                                                 06964000
CVTRV266 EQU   CVTRV262                                                 06965000
CVTRV265 EQU   CVTRV262                                                 06966000
CVTRV264 EQU   CVTRV262                                                 06967000
CVTRV263 EQU   CVTRV262                                                 06968000
CVTVFP   EQU   CVTS01+464                                               06969000
CVTVSI   EQU   CVTS01+460                                               06970000
CVTVPSIB EQU   CVTS01+456                                               06971000
CVTMFACT EQU   CVTMFRTR                                                 06972000
CVTMFCTL EQU   CVTS01+448                                               06973000
CVTPVBP  EQU   CVTS01+444                                               06974000
CVTPWI   EQU   CVTS01+440                                               06975000
CVTRV254 EQU   CVTS01+438                                               06976000
CVTRV253 EQU   CVTS01+436                                               06977000
CVTRV252 EQU   CVTS01+434                                               06978000
CVTRV251 EQU   CVTS01+433                                               06979000
CVTRV250 EQU   CVTS01+432                                               06980000
CVTRV249 EQU   CVTS01+431                                               06981000
CVTRV248 EQU   CVTS01+430                                               06982000
CVTRV247 EQU   CVTS01+429                                               06983000
CVTRV246 EQU   CVTS01+428                                               06984000
CVTRV245 EQU   CVTRV237                                                 06985000
CVTRV244 EQU   CVTRV237                                                 06986000
CVTRV243 EQU   CVTRV237                                                 06987000
CVTRV242 EQU   CVTRV237                                                 06988000
CVTRV241 EQU   CVTRV237                                                 06989000
CVTRV240 EQU   CVTRV237                                                 06990000
CVTRV239 EQU   CVTRV237                                                 06991000
CVTRV238 EQU   CVTRV237                                                 06992000
CVTRV236 EQU   CVTRV228                                                 06993000
CVTRV235 EQU   CVTRV228                                                 06994000
CVTRV234 EQU   CVTRV228                                                 06995000
CVTRV233 EQU   CVTRV228                                                 06996000
CVTRV232 EQU   CVTRV228                                                 06997000
CVTRV231 EQU   CVTRV228                                                 06998000
CVTRV230 EQU   CVTRV228                                                 06999000
CVTRV229 EQU   CVTRV228                                                 07000000
CVTRV227 EQU   CVTRV219                                                 07001000
CVTRV226 EQU   CVTRV219                                                 07002000
CVTRV225 EQU   CVTRV219                                                 07003000
CVTRV224 EQU   CVTRV219                                                 07004000
CVTRV223 EQU   CVTRV219                                                 07005000
CVTRV222 EQU   CVTRV219                                                 07006000
CVTRV221 EQU   CVTRV219                                                 07007000
CVTRV220 EQU   CVTRV219                                                 07008000
CVTRV218 EQU   CVTRV210                                                 07009000
CVTRV217 EQU   CVTRV210                                                 07010000
CVTRV216 EQU   CVTRV210                                                 07011000
CVTRV215 EQU   CVTRV210                                                 07012000
CVTRV214 EQU   CVTRV210                                                 07013000
CVTRV213 EQU   CVTRV210                                                 07014000
CVTRV212 EQU   CVTRV210                                                 07015000
CVTRV211 EQU   CVTRV210                                                 07016000
CVTLCCAT EQU   CVTS01+420                                               07017000
CVTPCCAT EQU   CVTS01+416                                               07018000
CVTIPCRP EQU   CVTS01+412                                               07019000
CVTIPCRI EQU   CVTS01+408                                               07020000
CVTIPCDS EQU   CVTS01+404                                               07021000
CVTAIDVT EQU   CVTS01+400                                               07022000
CVTSSAP  EQU   CVTS01+396                                               07023000
CVTEHCIR EQU   CVTS01+392                                               07024000
CVTEHDEF EQU   CVTS01+388                                               07025000
CVTDAIR  EQU   CVTS01+384                                               07026000
CVTPERFM EQU   CVTS01+380                                               07027000
CVT044R2 EQU   CVTS01+376                                               07028000
CVTFETCH EQU   CVTS01+372                                               07029000
CVTRSTWD EQU   CVTS01+368                                               07030000
CVTSPOST EQU   CVTS01+364                                               07031000
CVTIOBP  EQU   CVTS01+360                                               07032000
CVTASMVT EQU   CVTS01+356                                               07033000
CVTRECRQ EQU   CVTS01+352                                               07034000
CVTWSAC  EQU   CVTS01+348                                               07035000
CVTRV149 EQU   CVTS01+344                                               07036000
CVTWSAL  EQU   CVTS01+340                                               07037000
CVTSPSA  EQU   CVTS01+336                                               07038000
CVTGLMN  EQU   CVTS01+332                                               07039000
CVTVEAC0 EQU   CVTS01+328                                               07040000
CVT062R1 EQU   CVTS01+324                                               07041000
CVTRPOST EQU   CVTS01+320                                               07042000
CVTDQIQE EQU   CVTS01+316                                               07043000
CVTCSD   EQU   CVTS01+312                                               07044000
CVTLKRMA EQU   CVTS01+308                                               07045000
CVTRSPIE EQU   CVTS01+304                                               07046000
CVTRENQ  EQU   CVTS01+300                                               07047000
CVTLQCB  EQU   CVTS01+296                                               07048000
CVTFQCB  EQU   CVTS01+292                                               07049000
CVTQCS01 EQU   CVTS01+288                                               07050000
CVTAPFT  EQU   CVTS01+284                                               07051000
CVTPARRL EQU   CVTS01+280                                               07052000
CVTVWAIT EQU   CVTS01+276                                               07053000
CVTGSPL  EQU   CVTS01+272                                               07054000
CVTLSMQ  EQU   CVTS01+268                                               07055000
CVTGSMQ  EQU   CVTS01+264                                               07056000
CVTEXPRO EQU   CVTS01+260                                               07057000
CVTOPCTP EQU   CVTS01+256                                               07058000
CVTSIC   EQU   CVTS01+252                                               07059000
CVTTPIOS EQU   CVTS01+248                                               07060000
CVTRTMS  EQU   CVTS01+244                                               07061000
CVTSDBF  EQU   CVTS01+240                                               07062000
CVTSCBP  EQU   CVTS01+236                                               07063000
CVTSDMP  EQU   CVTS01+232                                               07064000
CVTSV60  EQU   CVTS01+228                                               07065000
CVTRTMCT EQU   CVTS01+224                                               07066000
CVTASCBL EQU   CVTS01+220                                               07067000
CVTASCBH EQU   CVTS01+216                                               07068000
CVTGDA   EQU   CVTS01+212                                               07069000
CVTASVT  EQU   CVTS01+208                                               07070000
CVTVVMDI EQU   CVTS01+204                                               07071000
CVTAQTOP EQU   CVTS01+200                                               07072000
CVTIOSCS EQU   CVTS01+196                                               07073000
CVTSDRM  EQU   CVTS01+192                                               07074000
CVTOPTE  EQU   CVTS01+188                                               07075000
CVTSTXU  EQU   CVTS01+184                                               07076000
CVTQUIS  EQU   CVTS01+180                                               07077000
CVTPARS  EQU   CVTS01+176                                               07078000
CVTS1EE  EQU   CVTS01+172                                               07079000
CVTFRAS  EQU   CVTS01+168                                               07080000
CVTQSAS  EQU   CVTS01+164                                               07081000
CVTCRAS  EQU   CVTS01+160                                               07082000
CVTCRMN  EQU   CVTS01+156                                               07083000
CVTDELCP EQU   CVTS01+152                                               07084000
CVTFRECL EQU   CVTS01+148                                               07085000
CVTGETCL EQU   CVTS01+144                                               07086000
CVTBLDCP EQU   CVTS01+140                                               07087000
CVTAUTHL EQU   CVTS01+136                                               07088000
CVTSCAN  EQU   CVTS01+132                                               07089000
CVTRV144 EQU   CVTS01+130                                               07090000
CVTMAXMP EQU   CVTS01+128                                               07091000
CVTSTCK  EQU   CVTS01+124                                               07092000
CVTRV139 EQU   CVTS01+123                                               07093000
CVTDSSAC EQU   CVTS01+122                                               07094000
CVTRV513 EQU   CVTS01+121                                               07095000
CVTIOSPL EQU   CVTS01+120                                               07096000
CVTPTGT  EQU   CVTS01+116                                               07097000
CVTCSPIE EQU   CVTS01+112                                               07098000
CVTSMFEX EQU   CVTS01+108                                               07099000
CVTOLT0A EQU   CVTS01+104                                               07100000
CVTSRBRT EQU   CVTS01+100                                               07101000
CVTPUTL  EQU   CVTS01+96                                                07102000
CVTASCRL EQU   CVTS01+92                                                07103000
CVTASCRF EQU   CVTS01+88                                                07104000
CVTRV326 EQU   CVTS01+84                                                07105000
CVTRV325 EQU   CVTS01+80                                                07106000
CVTRV324 EQU   CVTS01+76                                                07107000
CVT0VL01 EQU   CVTS01+72                                                07108000
CVTSHRVM EQU   CVTS01+68                                                07109000
CVTRV332 EQU   CVTS01+64                                                07110000
CVTTAS   EQU   CVTS01+60                                                07111000
CVTRSCN  EQU   CVTS01+56                                                07112000
CVTTRAC2 EQU   CVTS01+54                                                07113000
CVTTRACE EQU   CVTS01+52                                                07114000
CVTAPG   EQU   CVTS01+51                                                07115000
CVTSDTRC EQU   CVTCTLFG                                                 07116000
CVTGTRCE EQU   CVTCTLFG                                                 07117000
CVTNOMP  EQU   CVTCTLFG                                                 07118000
CVTRSV79 EQU   CVTCTLFG                                                 07119000
CVTDSTAT EQU   CVTCTLFG                                                 07120000
CVTRSV78 EQU   CVTCTLFG                                                 07121000
CVTRV333 EQU   CVTCTLFG                                                 07122000
CVTRV323 EQU   CVTCTLFG                                                 07123000
CVTSPVLK EQU   CVTS01+49                                                07124000
CVTRSV77 EQU   CVTS01+48                                                07125000
CVTRV331 EQU   CVTS01+44                                                07126000
CVTRV330 EQU   CVTS01+40                                                07127000
CVTRV329 EQU   CVTS01+36                                                07128000
CVTRV328 EQU   CVTS01+32                                                07129000
CVTRV322 EQU   CVTS01+28                                                07130000
CVTSLID  EQU   CVTSLIDA+1                                               07131000
CVTSYLK  EQU   CVTSLIDA                                                 07132000
CVTRV321 EQU   CVTS01+20                                                07133000
CVTRV320 EQU   CVTS01+16                                                07134000
CVTLPDIR EQU   CVTLPDIA+1                                               07135000
CVTRSV69 EQU   CVTDIRST                                                 07136000
CVTRSV68 EQU   CVTDIRST                                                 07137000
CVTRSV67 EQU   CVTDIRST                                                 07138000
CVTRSV66 EQU   CVTDIRST                                                 07139000
CVTRSV65 EQU   CVTDIRST                                                 07140000
CVTRSV64 EQU   CVTDIRST                                                 07141000
CVTRSV63 EQU   CVTDIRST                                                 07142000
CVTDICOM EQU   CVTDIRST                                                 07143000
CVTPVTP  EQU   CVTS01+8                                                 07144000
CVTLPDSR EQU   CVTS01+4                                                 07145000
CVTGETL  EQU   CVTS01                                                   07146000
VAPIFLGS EQU   @NM00016+4                                               07147000
SCAN1    EQU   SCAN2A                                                   07148000
@NM00108 EQU   NIPPMCSW+4                                               07149000
@NM00107 EQU   NIPPMCSW                                                 07150000
DEBXSAMB EQU   DEBXTN+28                                                07151000
DEBXOPNJ EQU   DEBXTN+24                                                07152000
DEBXXARG EQU   DEBXTN+20                                                07153000
DEBXMCF2 EQU   DEBXTN+19                                                07154000
DEBXMCF1 EQU   DEBXTN+18                                                07155000
DEBXDSO2 EQU   DEBXTN+17                                                07156000
DEBXDSO1 EQU   DEBXTN+16                                                07157000
DEBXDBPR EQU   DEBXTN+12                                                07158000
DEBXDCBM EQU   DEBXTN+8                                                 07159000
DEBXDSAB EQU   DEBXTN+4                                                 07160000
DEBXRV48 EQU   DEBXTN+3                                                 07161000
DEBXRV47 EQU   DEBXFLG1                                                 07162000
DEBXRV46 EQU   DEBXFLG1                                                 07163000
DEBXRV45 EQU   DEBXFLG1                                                 07164000
DEBXRV44 EQU   DEBXFLG1                                                 07165000
DEBXRV43 EQU   DEBXFLG1                                                 07166000
DEBXDSSI EQU   DEBXFLG1                                                 07167000
DEBXTSKC EQU   DEBXFLG1                                                 07168000
DEBXCDCB EQU   DEBXFLG1                                                 07169000
DEBXLNGH EQU   DEBXTN                                                   07170000
DEBTBLOF EQU   DEBPREFX+14                                              07171000
DEBAMTYP EQU   DEBPREFX+13                                              07172000
DEBLNGTH EQU   DEBPREFX+12                                              07173000
DEBDCBMK EQU   DEBXTNP                                                  07174000
DEBDSCBA EQU   DEBPREFX+1                                               07175000
DEBWKARA EQU   DEBPREFX                                                 07176000
DEBXCEAD EQU   DEBXCEA+1                                                07177000
DEBXCENP EQU   DEBXCEAB                                                 07178000
DEBRSV35 EQU   DEBXCEAB                                                 07179000
DEBRSV34 EQU   DEBXCEAB                                                 07180000
DEBRSV33 EQU   DEBXCEAB                                                 07181000
DEBRSV32 EQU   DEBXCEAB                                                 07182000
DEBCEAD  EQU   DEBCEA+1                                                 07183000
DEBCENP  EQU   DEBCEAB                                                  07184000
DEBRSV31 EQU   DEBCEAB                                                  07185000
DEBRSV30 EQU   DEBCEAB                                                  07186000
DEBRSV29 EQU   DEBCEAB                                                  07187000
DEBRSV28 EQU   DEBCEAB                                                  07188000
DEBPCIAD EQU   DEBPCIA+1                                                07189000
DEBPCINP EQU   DEBPCIAB                                                 07190000
DEBRSV27 EQU   DEBPCIAB                                                 07191000
DEBRSV26 EQU   DEBPCIAB                                                 07192000
DEBRSV25 EQU   DEBPCIAB                                                 07193000
DEBRSV24 EQU   DEBPCIAB                                                 07194000
DEBSIOAD EQU   DEBSIOA+1                                                07195000
DEBSIONP EQU   DEBSIOAB                                                 07196000
DEBFIX   EQU   DEBSIOAB                                                 07197000
DEBIOVR  EQU   DEBSIOAB                                                 07198000
DEBSIOX  EQU   DEBSIOAB                                                 07199000
DEBPGFX  EQU   DEBSIOAB                                                 07200000
DEBEOEAD EQU   DEBEOEA+1                                                07201000
DEBEOENP EQU   DEBEOEAB                                                 07202000
DEBRSV22 EQU   DEBEOEAB                                                 07203000
DEBRSV21 EQU   DEBEOEAB                                                 07204000
DEBRSV20 EQU   DEBEOEAB                                                 07205000
DEBESMVR EQU   DEBEOEAB                                                 07206000
DEBSUBID EQU   DEBSUBNM                                                 07207000
DEBSIOA2 EQU   DEBACS08+24                                              07208000
DEBRPSIO EQU   DEBACS08+20                                              07209000
DEBFREED EQU   DEBACS08+16                                              07210000
@NM00099 EQU   DEBACS08+12                                              07211000
@NM00098 EQU   DEBACS08+8                                               07212000
DEBDISAD EQU   DEBACS08+4                                               07213000
@NM00097 EQU   DEBACS08                                                 07214000
DEBRPSST EQU   DEBACS07+64                                              07215000
DEBARECK EQU   DEBACS07+60                                              07216000
DEBAREWT EQU   DEBACS07+56                                              07217000
DEBACHK  EQU   DEBACS07+52                                              07218000
DEBAWRIT EQU   DEBACS07+48                                              07219000
DEBASETL EQU   DEBACS07+44                                              07220000
DEBAREAD EQU   DEBACS07+40                                              07221000
DEBCRECK EQU   DEBACS07+36                                              07222000
DEBCREWT EQU   DEBACS07+32                                              07223000
DEBCCHK  EQU   DEBACS07+28                                              07224000
DEBCWRIT EQU   DEBACS07+24                                              07225000
DEBCSETL EQU   DEBACS07+20                                              07226000
DEBCREAD EQU   DEBACS07+16                                              07227000
DEBWKPT5 EQU   DEBACS07+12                                              07228000
DEBWKPT4 EQU   DEBACS07+8                                               07229000
DEBGET   EQU   DEBACS07+4                                               07230000
@NM00096 EQU   DEBACS07                                                 07231000
DEBPUT   EQU   DEBACS06+4                                               07232000
DEBDCBFA EQU   DEBACS06                                                 07233000
DEBLUCBB EQU   DEBLUCBA+1                                               07234000
DEBRSV18 EQU   DEBLUCBA                                                 07235000
DEBFUCBB EQU   DEBFUCBA+1                                               07236000
DEBRSV17 EQU   DEBFUCBA                                                 07237000
DEBTCCWB EQU   DEBTCCWA+1                                               07238000
DEBRSV16 EQU   DEBTCCWA                                                 07239000
DEBTBFRB EQU   DEBTBFRA+1                                               07240000
DEBRSV15 EQU   DEBTBFRA                                                 07241000
DEBDBPEF EQU   DEBACS03+8                                               07242000
DEBDBPP  EQU   DEBACS03+4                                               07243000
DEBDTPP  EQU   DEBACS03                                                 07244000
DEBDBPE  EQU   DEBDBLK+1                                                07245000
DEBDBPT  EQU   DEBDBLK                                                  07246000
DEBEXTNM EQU   DEBDSNAM                                                 07247000
DEBLRECL EQU   DEBACSMD+14                                              07248000
DEBBLKSI EQU   DEBACSMD+12                                              07249000
DEBRSV14 EQU   DEBDSNM+4                                                07250000
DEBUTSAB EQU   DEBUTSAA+1                                               07251000
DEBRSV13 EQU   DEBUTSAA                                                 07252000
DEBVOLNM EQU   DEBACSMD+2                                               07253000
DEBVLSEQ EQU   DEBVOLSQ+1                                               07254000
DEBRSV42 EQU   DEBVOLBT                                                 07255000
DEBRSV41 EQU   DEBVOLBT                                                 07256000
DEBRSV40 EQU   DEBVOLBT                                                 07257000
DEBRSV39 EQU   DEBVOLBT                                                 07258000
DEBRSV38 EQU   DEBVOLBT                                                 07259000
DEBRSV37 EQU   DEBVOLBT                                                 07260000
DEBRSV36 EQU   DEBVOLBT                                                 07261000
DEBEXFUL EQU   DEBVOLBT                                                 07262000
DEBSTRHH EQU   DEBDASD+8                                                07263000
DEBSTRCC EQU   DEBDASD+6                                                07264000
DEBBINUM EQU   DEBDASD+4                                                07265000
DEBDVMOD EQU   DEBUCBAD                                                 07266000
DEBECBB  EQU   DEBECBAD+1                                               07267000
DEBPRIOR EQU   DEBECBAD                                                 07268000
DEBUSRPB EQU   DEBUSRPG+1                                               07269000
DEBRSV05 EQU   DEBBASIC+15                                              07270000
DEBXTNIN EQU   DEBFLGS1                                                 07271000
DEBAPFIN EQU   DEBFLGS1                                                 07272000
DEBF1CEV EQU   DEBFLGS1                                                 07273000
DEBCINDI EQU   DEBFLGS1                                                 07274000
DEBRSV02 EQU   DEBFLGS1                                                 07275000
DEBRSIOA EQU   DEBFLGS1                                                 07276000
DEBEOFDF EQU   DEBFLGS1                                                 07277000
DEBPWCKD EQU   DEBFLGS1                                                 07278000
DEBQSCNT EQU   DEBBASIC+13                                              07279000
DEBACCS  EQU   DEBOPATB                                                 07280000
DEBPOSIT EQU   DEBOPATB                                                 07281000
DEBZERO  EQU   DEBOPATB                                                 07282000
DEBABEND EQU   DEBOPATB                                                 07283000
DEBIRBB  EQU   DEBIRBAD+1                                               07284000
DEBRERR  EQU   DEBOFLGS                                                 07285000
DEBLABEL EQU   DEBOFLGS                                                 07286000
DEBSPLIT EQU   DEBOFLGS                                                 07287000
DEBDCB   EQU   DEBOFLGS                                                 07288000
DEBRLSE  EQU   DEBOFLGS                                                 07289000
DEBEOF   EQU   DEBOFLGS                                                 07290000
DEBDISP  EQU   DEBOFLGS                                                 07291000
DEBDEBB  EQU   DEBDEBAD+1                                               07292000
DEBAMLNG EQU   DEBDEBAD                                                 07293000
DEBTCBB  EQU   DEBTCBAD+1                                               07294000
DEBNMSUB EQU   DEBTCBAD                                                 07295000
IOBRSV19 EQU   IOBINCAM+1                                               07296000
IOBOLTST EQU   IOBBTAMF                                                 07297000
IOBRFTMG EQU   IOBBTAMF                                                 07298000
IOBRSV17 EQU   IOBBTAMF                                                 07299000
IOBRSV16 EQU   IOBBTAMF                                                 07300000
IOBRSV15 EQU   IOBBTAMF                                                 07301000
IOBRSV14 EQU   IOBBTAMF                                                 07302000
IOBINUSE EQU   IOBBTAMF                                                 07303000
IOBPRMER EQU   IOBBTAMF                                                 07304000
IOBRSTRB EQU   IOBRESTR+1                                               07305000
IOBREPOS EQU   IOBRESTR                                                 07306000
IOBDCBPB EQU   IOBDCBPT+1                                               07307000
IOBRSV44 EQU   IOBFLAG4                                                 07308000
IOBJES3I EQU   IOBFLAG4                                                 07309000
IOBRSV42 EQU   IOBFLAG4                                                 07310000
IOBRSV41 EQU   IOBFLAG4                                                 07311000
IOBRSV40 EQU   IOBFLAG4                                                 07312000
IOBPMERR EQU   IOBFLAG4                                                 07313000
IOBCC3WE EQU   IOBFLAG4                                                 07314000
IOBGDPOL EQU   IOBFLAG4                                                 07315000
IOBSTRTB EQU   IOBSTART+1                                               07316000
IOBSIOCC EQU   IOBSTART                                                 07317000
IOBCSB7  EQU   IOBCSTAT                                                 07318000
IOBCSB6  EQU   IOBCSTAT                                                 07319000
IOBCSB5  EQU   IOBCSTAT                                                 07320000
IOBCSB4  EQU   IOBCSTAT                                                 07321000
IOBCSB3  EQU   IOBCSTAT                                                 07322000
IOBCSB2  EQU   IOBCSTAT                                                 07323000
IOBCSB1  EQU   IOBCSTAT                                                 07324000
IOBCSB0  EQU   IOBCSTAT                                                 07325000
IOBUSB7  EQU   IOBUSTAT                                                 07326000
IOBUSB6  EQU   IOBUSTAT                                                 07327000
IOBUSB5  EQU   IOBUSTAT                                                 07328000
IOBUSB4  EQU   IOBUSTAT                                                 07329000
IOBUSB3  EQU   IOBUSTAT                                                 07330000
IOBUSB2  EQU   IOBUSTAT                                                 07331000
IOBUSB1  EQU   IOBUSTAT                                                 07332000
IOBUSB0  EQU   IOBUSTAT                                                 07333000
IOBCMDA  EQU   IOBIOCSW                                                 07334000
IOBLOG   EQU   IOBFL3                                                   07335000
IOBJAM   EQU   IOBICL                                                   07336000
IOBMSG   EQU   IOBFL3                                                   07337000
IOBSDR   EQU   IOBCNC                                                   07338000
IOBACU   EQU   IOBFL3                                                   07339000
IOBCDC   EQU   IOBFL3                                                   07340000
IOBICC   EQU   IOBFL3                                                   07341000
IOBCCC   EQU   IOBFL3                                                   07342000
IOBECBPB EQU   IOBECBPT+1                                               07343000
IOBECBCC EQU   IOBECBPT                                                 07344000
IOBS1B7  EQU   IOBSENS1                                                 07345000
IOBS1B6  EQU   IOBSENS1                                                 07346000
IOBS1B5  EQU   IOBSENS1                                                 07347000
IOBS1B4  EQU   IOBSENS1                                                 07348000
IOBS1B3  EQU   IOBSENS1                                                 07349000
IOBS1B2  EQU   IOBSENS1                                                 07350000
IOBS1B1  EQU   IOBSENS1                                                 07351000
IOBS1B0  EQU   IOBSENS1                                                 07352000
IOBSNSC9 EQU   IOBS0B7                                                  07353000
IOBS0B6  EQU   IOBSENS0                                                 07354000
IOBS0B5  EQU   IOBSENS0                                                 07355000
IOBS0B4  EQU   IOBSENS0                                                 07356000
IOBS0B3  EQU   IOBSENS0                                                 07357000
IOBS0B2  EQU   IOBSENS0                                                 07358000
IOBS0B1  EQU   IOBSENS0                                                 07359000
IOBS0B0  EQU   IOBSENS0                                                 07360000
IOBPNCH  EQU   IOBFLAG2                                                 07361000
IOBSTATO EQU   IOBFLAG2                                                 07362000
IOBSKUPD EQU   IOBFLAG2                                                 07363000
IOBALTTR EQU   IOBFLAG2                                                 07364000
IOBRRT2  EQU   IOBRDHA0                                                 07365000
IOBRRT3  EQU   IOBPURGE                                                 07366000
IOBSENSE EQU   IOBFLAG2                                                 07367000
IOBHALT  EQU   IOBFLAG2                                                 07368000
IOBSPSVC EQU   IOBRSTRT                                                 07369000
IOBUNREL EQU   IOBFLAG1                                                 07370000
IOBIOERR EQU   IOBFLAG1                                                 07371000
IOBFCREX EQU   IOBCYCCK                                                 07372000
IOBRPSTN EQU   IOBFLAG1                                                 07373000
IOBERRTN EQU   IOBFLAG1                                                 07374000
IOBCMDCH EQU   IOBFLAG1                                                 07375000
IOBDATCH EQU   IOBFLAG1                                                 07376000
IOBCNOPA EQU   IOBPREFX+12                                              07377000
IOBCICB  EQU   IOBPREFX+8                                               07378000
IOBCECB  EQU   IOBPREFX+4                                               07379000
IOBCONOP EQU   IOBPREFX+3                                               07380000
IOBCINOP EQU   IOBPREFX+2                                               07381000
IOBRSV05 EQU   IOBPREFX+1                                               07382000
IOBPCI   EQU   IOBCFLG1                                                 07383000
IOBRSTCH EQU   IOBCFLG1                                                 07384000
IOBABAPP EQU   IOBCFLG1                                                 07385000
IOBPTST  EQU   IOBCFLG1                                                 07386000
IOBRSV04 EQU   IOBCFLG1                                                 07387000
IOBRSV03 EQU   IOBCFLG1                                                 07388000
IOBRSV02 EQU   IOBCFLG1                                                 07389000
IOBRSV01 EQU   IOBCFLG1                                                 07390000
ECBEVNT  EQU   ECBEXTND                                                 07391000
@NM00095 EQU   ECBEXTND                                                 07392000
@NM00094 EQU   ECBBYTE3                                                 07393000
@NM00093 EQU   ECBEXTBA                                                 07394000
@NM00092 EQU   ECBCC                                                    07395000
ECBPOSTB EQU   ECBCC                                                    07396000
ECBWAITB EQU   ECBCC                                                    07397000
NSCHDCPU EQU   NIPSCHDL+8                                               07398000
NSCHDPRM EQU   NIPSCHDL+4                                               07399000
NSCHDPTR EQU   NIPSCHDL                                                 07400000
@NM00091 EQU   NIPOPNPL+22                                              07401000
NOPNRC   EQU   NIPOPNPL+21                                              07402000
NOPNFLSX EQU   NOPNFL                                                   07403000
NOPNFLLC EQU   NOPNFL                                                   07404000
NOPNFLLB EQU   NOPNFL                                                   07405000
NOPNFLNB EQU   NOPNFL                                                   07406000
NOPNFLI  EQU   NOPNFL                                                   07407000
NOPNFLM  EQU   NOPNFL                                                   07408000
NOPNFAU  EQU   NOPNFL                                                   07409000
NOPNFRS  EQU   NOPNFL                                                   07410000
NOPNUCB  EQU   NIPOPNPL+16                                              07411000
NOPNDCB  EQU   NIPOPNPL+12                                              07412000
NOPNDSA  EQU   NOPNDS                                                   07413000
@NM00090 EQU   NIPMNTPL+21                                              07414000
NMNTFLB  EQU   NMNTFL                                                   07415000
NMNTFLC  EQU   NMNTFL                                                   07416000
NMNTFLI  EQU   NMNTFL                                                   07417000
NMNTFUS  EQU   NMNTFL                                                   07418000
@NM00089 EQU   NMNTFL                                                   07419000
NMNTDT   EQU   NIPMNTPL+18                                              07420000
NMNTUCB  EQU   NMNTVS                                                   07421000
NMNTDSA  EQU   NMNTDS                                                   07422000
NIPSPEA  EQU   NIPSPE+4                                                 07423000
NIPSPEQ  EQU   NIPSPE                                                   07424000
NWTORMSG EQU   NWTORLST+12                                              07425000
@NM00088 EQU   NWTORLST+11                                              07426000
@NM00087 EQU   NWTORFL                                                  07427000
NWTORFLB EQU   NWTORFL                                                  07428000
@NM00086 EQU   NWTORFL                                                  07429000
NWTORFLA EQU   NWTORFL                                                  07430000
NMTORRDL EQU   NWTORLST+8                                               07431000
NWTORECB EQU   NWTORLST+4                                               07432000
NWTORRPA EQU   NWTORLST                                                 07433000
@NM00085 EQU   NWTOFL                                                   07434000
NWTOFLNC EQU   NWTOFL                                                   07435000
NWTOFLNH EQU   NWTOFL                                                   07436000
NWTOLNG  EQU   NWTOHDR                                                  07437000
NIPPTSID EQU   NIPPTE+6                                                 07438000
@NM00084 EQU   NIPPTATF                                                 07439000
NIPPTMRG EQU   NIPPTATF                                                 07440000
@NM00083 EQU   NIPPTOPF                                                 07441000
NIPPTCAN EQU   NIPPTOPF                                                 07442000
NIPPTLST EQU   NIPPTOPF                                                 07443000
NIPPTOPI EQU   NIPPTOPF                                                 07444000
NIPPTADR EQU   NIPPTE                                                   07445000
PTABEND  EQU   PARMTAB+288                                              07446000
@NM00082 EQU   PARMTAB+284                                              07447000
RSU      EQU   PARMTAB+280                                              07448000
@NM00081 EQU   @NM00079+1                                               07449000
@NM00080 EQU   NIPPAFLG                                                 07450000
@NM00078 EQU   PARMTAB+268                                              07451000
PURGE    EQU   PARMTAB+264                                              07452000
@NM00077 EQU   PARMTAB+260                                              07453000
WTORPLY  EQU   PARMTAB+256                                              07454000
@NM00076 EQU   PARMTAB+252                                              07455000
WTOBFRS  EQU   PARMTAB+248                                              07456000
@NM00075 EQU   PARMTAB+244                                              07457000
VRREGN   EQU   PARMTAB+240                                              07458000
@NM00074 EQU   PARMTAB+236                                              07459000
@NM00073 EQU   PARMTAB+228                                              07460000
SYSP     EQU   PARMTAB+224                                              07461000
@NM00072 EQU   PARMTAB+220                                              07462000
SQA      EQU   PARMTAB+216                                              07463000
@NM00071 EQU   PARMTAB+212                                              07464000
SMF      EQU   PARMTAB+208                                              07465000
@NM00070 EQU   PARMTAB+204                                              07466000
REAL     EQU   PARMTAB+200                                              07467000
@NM00069 EQU   PARMTAB+196                                              07468000
PAGEO    EQU   PARMTAB+192                                              07469000
@NM00068 EQU   PARMTAB+188                                              07470000
PAGEP    EQU   PARMTAB+184                                              07471000
@NM00067 EQU   PARMTAB+180                                              07472000
OPT      EQU   PARMTAB+176                                              07473000
@NM00066 EQU   PARMTAB+172                                              07474000
OPI      EQU   PARMTAB+168                                              07475000
@NM00065 EQU   PARMTAB+164                                              07476000
NUCMAP   EQU   PARMTAB+160                                              07477000
@NM00064 EQU   PARMTAB+156                                              07478000
MLPA     EQU   PARMTAB+152                                              07479000
@NM00063 EQU   PARMTAB+148                                              07480000
MAXUSER  EQU   PARMTAB+144                                              07481000
@NM00062 EQU   PARMTAB+140                                              07482000
LOGLMT   EQU   PARMTAB+136                                              07483000
@NM00061 EQU   PARMTAB+132                                              07484000
LOGCLS   EQU   PARMTAB+128                                              07485000
@NM00060 EQU   PARMTAB+124                                              07486000
LNK      EQU   PARMTAB+120                                              07487000
@NM00059 EQU   PARMTAB+116                                              07488000
IPS      EQU   PARMTAB+112                                              07489000
@NM00058 EQU   PARMTAB+108                                              07490000
HARDCPY  EQU   PARMTAB+104                                              07491000
@NM00057 EQU   PARMTAB+100                                              07492000
FIX      EQU   PARMTAB+96                                               07493000
@NM00056 EQU   PARMTAB+92                                               07494000
DUMP     EQU   PARMTAB+88                                               07495000
@NM00055 EQU   PARMTAB+84                                               07496000
CVIO     EQU   PARMTAB+80                                               07497000
@NM00054 EQU   PARMTAB+76                                               07498000
CSA      EQU   PARMTAB+72                                               07499000
@NM00053 EQU   PARMTAB+68                                               07500000
CPQE     EQU   PARMTAB+64                                               07501000
@NM00052 EQU   PARMTAB+60                                               07502000
CONT     EQU   PARMTAB+56                                               07503000
@NM00051 EQU   PARMTAB+52                                               07504000
CMD      EQU   PARMTAB+48                                               07505000
@NM00050 EQU   PARMTAB+44                                               07506000
CLPA     EQU   PARMTAB+40                                               07507000
@NM00049 EQU   PARMTAB+36                                               07508000
BLDLF    EQU   PARMTAB+32                                               07509000
@NM00048 EQU   PARMTAB+28                                               07510000
BLDL     EQU   PARMTAB+24                                               07511000
@NM00047 EQU   PARMTAB+20                                               07512000
APG      EQU   PARMTAB+16                                               07513000
@NM00046 EQU   PARMTAB+12                                               07514000
APF      EQU   PARMTAB+8                                                07515000
PTABSTRT EQU   PARMTAB                                                  07516000
NIPPABUF EQU   NIPPAREA+548                                             07517000
NIPPAPTB EQU   NIPPAREA+252                                             07518000
@NM00045 EQU   NIPPAREA+248                                             07519000
@NM00044 EQU   NIPPAECB+1                                               07520000
@NM00043 EQU   NIPPAIOD+37                                              07521000
NIPPATXT EQU   NIPPAIOD                                                 07522000
@NM00042 EQU   NIPPAREA+30                                              07523000
@NM00041 EQU   NIPPABDL+15                                              07524000
NIPPA2BF EQU   NIPPABDH                                                 07525000
@NM00040 EQU   NIPPAREA                                                 07526000
NIPPABYT EQU   NIPPAHDR+4                                               07527000
NIPPAQ   EQU   NIPPAHDR                                                 07528000
UCBERADR EQU   UCBUCS+12                                                07529000
UCBFCBID EQU   UCBUCS+8                                                 07530000
UCBERCNT EQU   UCBUCS+7                                                 07531000
UCBRSV51 EQU   UCBUCS+6                                                 07532000
UCBRSV50 EQU   UCBFCBOP                                                 07533000
UCBRSV49 EQU   UCBFCBOP                                                 07534000
UCBRSV48 EQU   UCBFCBOP                                                 07535000
UCBRSV47 EQU   UCBFCBOP                                                 07536000
UCBRSV46 EQU   UCBFCBOP                                                 07537000
UCBRSV45 EQU   UCBFCBOP                                                 07538000
UCBRSV44 EQU   UCBFCBOP                                                 07539000
UCBFCBO1 EQU   UCBFCBOP                                                 07540000
UCBUCSPE EQU   UCBUCSOP                                                 07541000
UCBRSV43 EQU   UCBUCSOP                                                 07542000
UCBRSV42 EQU   UCBUCSOP                                                 07543000
UCBRSV41 EQU   UCBUCSOP                                                 07544000
UCBRSV40 EQU   UCBUCSOP                                                 07545000
UCBRSV39 EQU   UCBUCSOP                                                 07546000
UCBUCSO2 EQU   UCBUCSOP                                                 07547000
UCBUCSO1 EQU   UCBUCSOP                                                 07548000
UCBUCSID EQU   UCBUCS                                                   07549000
UCBMDRBA EQU   UCBMDRBF+1                                               07550000
UCBRV075 EQU   UCBMDRBF                                                 07551000
UCBRV074 EQU   UCB3800X+32                                              07552000
UCBIMAGE EQU   UCB3800X+28                                              07553000
UCBFCBNM EQU   UCB3800X+24                                              07554000
UCBCHAR4 EQU   UCB3800X+20                                              07555000
UCBCHAR3 EQU   UCB3800X+16                                              07556000
UCBCHAR2 EQU   UCB3800X+12                                              07557000
UCBCHAR1 EQU   UCB3800X+8                                               07558000
UCBCGMID EQU   UCB3800X+4                                               07559000
UCBBRSTA EQU   UCBACTIV                                                 07560000
UCBRV063 EQU   UCBACTIV                                                 07561000
UCBRV062 EQU   UCBACTIV                                                 07562000
UCBRV061 EQU   UCBACTIV                                                 07563000
UCBRV060 EQU   UCBACTIV                                                 07564000
UCBRV059 EQU   UCBACTIV                                                 07565000
UCBRV058 EQU   UCBACTIV                                                 07566000
UCBRV057 EQU   UCBACTIV                                                 07567000
UCBRV050 EQU   UCB3800X+2                                               07568000
UCBCGMNO EQU   UCB3800X+1                                               07569000
UCBRV083 EQU   UCBOPTNS                                                 07570000
UCBBRSTR EQU   UCBOPTNS                                                 07571000
UCBRV056 EQU   UCBOPTNS                                                 07572000
UCBRV055 EQU   UCBOPTNS                                                 07573000
UCBRV054 EQU   UCBOPTNS                                                 07574000
UCBRV053 EQU   UCBOPTNS                                                 07575000
UCBRV052 EQU   UCBOPTNS                                                 07576000
UCBRV051 EQU   UCBOPTNS                                                 07577000
UCBRV073 EQU   UCB3540X+7                                               07578000
UCBRV072 EQU   UCBDKBYT                                                 07579000
UCBRV071 EQU   UCBDKBYT                                                 07580000
UCBRV070 EQU   UCBDKBYT                                                 07581000
UCBRV069 EQU   UCBDKBYT                                                 07582000
UCBRV068 EQU   UCBDKBYT                                                 07583000
UCBRV067 EQU   UCBDKBYT                                                 07584000
UCBVLVER EQU   UCBDKBYT                                                 07585000
UCBDKAMX EQU   UCBDKBYT                                                 07586000
UCBVLSER EQU   UCB3540X                                                 07587000
UCBRDATA EQU   UCBOCR+4                                                 07588000
UCBFRID  EQU   UCBOCR                                                   07589000
UCBCLN   EQU   UCBMT+14                                                 07590000
UCBERG   EQU   UCBMT+12                                                 07591000
UCBMS    EQU   UCBMT+11                                                 07592000
UCBNB    EQU   UCBMT+10                                                 07593000
UCBPW    EQU   UCBMT+9                                                  07594000
UCBPR    EQU   UCBMT+8                                                  07595000
UCBSIO   EQU   UCBMT+6                                                  07596000
UCBTW    EQU   UCBMT+5                                                  07597000
UCBTR    EQU   UCBMT+4                                                  07598000
UCBTWT   EQU   UCBMT+3                                                  07599000
UCBTRT   EQU   UCBMT+2                                                  07600000
UCBCTD   EQU   UCBMT                                                    07601000
UCBWTOID EQU   UCBCMEXT+17                                              07602000
UCBMIHTI EQU   UCBCMEXT+16                                              07603000
UCBASID  EQU   UCBCMEXT+14                                              07604000
UCBMFCNT EQU   UCBCMEXT+12                                              07605000
UCBPMSK  EQU   UCBCMEXT+10                                              07606000
UCBCCWOF EQU   UCBCMEXT+8                                               07607000
UCBRV041 EQU   UCBCMEXT+6                                               07608000
UCBRV036 EQU   UCBFLP1                                                  07609000
UCBRV035 EQU   UCBFLP1                                                  07610000
UCBERLOG EQU   UCBFLP1                                                  07611000
UCBRV033 EQU   UCBFLP1                                                  07612000
UCBINHIO EQU   UCBFLP1                                                  07613000
UCBNSWAP EQU   UCBFLP1                                                  07614000
UCBSHRUP EQU   UCBFLP1                                                  07615000
UCBNSRCH EQU   UCBFLP1                                                  07616000
UCBSNSCT EQU   UCBCMEXT+4                                               07617000
UCBHPDV  EQU   @NM00039                                                 07618000
UCBHALI  EQU   @NM00039                                                 07619000
UCBRSV09 EQU   @NM00039                                                 07620000
UCBRSV08 EQU   @NM00039                                                 07621000
UCBRSV07 EQU   @NM00039                                                 07622000
UCBRSV06 EQU   @NM00039                                                 07623000
UCBRSV05 EQU   @NM00039                                                 07624000
UCBRSV04 EQU   @NM00039                                                 07625000
UCBDTI   EQU   UCBCMEXT+2                                               07626000
UCBSTI   EQU   UCBCMEXT+1                                               07627000
UCBETI   EQU   UCBCMEXT                                                 07628000
UCBEXTP  EQU   UCBEXTPT+1                                               07629000
UCBDDRSW EQU   UCBFLC                                                   07630000
UCBTICBT EQU   UCBFLC                                                   07631000
UCBIVRR  EQU   UCBFLC                                                   07632000
UCBIVRS  EQU   UCBFLC                                                   07633000
UCBITF   EQU   UCBFLC                                                   07634000
UCBUDE   EQU   UCBFLC                                                   07635000
UCBWAA   EQU   UCBFLC                                                   07636000
UCBATTP  EQU   UCBFLC                                                   07637000
UCBUNTYP EQU   UCBTBYT4                                                 07638000
UCBRSV11 EQU   UCBDVCLS                                                 07639000
UCBRSV10 EQU   UCBDVCLS                                                 07640000
UCB3CHAR EQU   UCBDVCLS                                                 07641000
UCB3UREC EQU   UCBDVCLS                                                 07642000
UCB3DISP EQU   UCBDVCLS                                                 07643000
UCB3COMM EQU   UCBDVCLS                                                 07644000
UCB3TAPE EQU   UCBDVCLS                                                 07645000
UCBDVPWR EQU   UCB2OPT7                                                 07646000
UCBVLPWR EQU   UCB2OPT6                                                 07647000
UCB2OPT5 EQU   UCBTBYT2                                                 07648000
UCBRPS   EQU   UCBDUDN2                                                 07649000
UCBRR    EQU   UCBDUDN1                                                 07650000
UCB2OPT1 EQU   UCBTBYT2                                                 07651000
UCB2OPT0 EQU   UCBTBYT2                                                 07652000
UCB1FEA7 EQU   UCBTBYT1                                                 07653000
UCBD6250 EQU   UCB1FEA6                                                 07654000
UCBD1600 EQU   UCB1FEA5                                                 07655000
UCB1FEA4 EQU   UCBTBYT1                                                 07656000
UCB1FEA3 EQU   UCBTBYT1                                                 07657000
UCB1FEA2 EQU   UCBTBYT1                                                 07658000
UCB1FEA1 EQU   UCBTBYT1                                                 07659000
UCB1FEA0 EQU   UCBTBYT1                                                 07660000
UCBRV029 EQU   UCBWGT                                                   07661000
UCBVHRSN EQU   UCBWGT                                                   07662000
UCBVORSN EQU   UCBWGT                                                   07663000
UCBREW   EQU   UCBWGT                                                   07664000
UCBPUB   EQU   UCBWGT                                                   07665000
UCBOUT   EQU   UCBWGT                                                   07666000
UCBIN    EQU   UCBWGT                                                   07667000
UCBCPU   EQU   UCBOB+11                                                 07668000
UCBLCI   EQU   UCBOB+10                                                 07669000
UCBCNT   EQU   UCBOB+9                                                  07670000
UCBRV017 EQU   UCBCHM1                                                  07671000
UCBRV016 EQU   UCBCHM1                                                  07672000
UCBRV015 EQU   UCBCHM1                                                  07673000
UCBRV014 EQU   UCBCHM1                                                  07674000
UCBSPB   EQU   UCBPTH1                                                  07675000
UCBPPB   EQU   UCBPTH1                                                  07676000
UCBSPA   EQU   UCBPTH0                                                  07677000
UCBPPA   EQU   UCBPTH0                                                  07678000
UCBSIGP  EQU   UCBFLB                                                   07679000
UCBVALPH EQU   UCBFLB                                                   07680000
UCBCRHSN EQU   UCBFLB                                                   07681000
UCBCRHRV EQU   UCBFLB                                                   07682000
UCBRESVH EQU   UCBFLB                                                   07683000
UCBSPST  EQU   UCBFLB                                                   07684000
UCBASNS  EQU   UCBFLB                                                   07685000
UCBIORST EQU   UCBFLB                                                   07686000
UCBQISCE EQU   UCBFL1                                                   07687000
UCBACTV  EQU   UCBFL1                                                   07688000
UCBSAP   EQU   UCBFL1                                                   07689000
UCBNOTRC EQU   UCBCUB                                                   07690000
UCBPSNS  EQU   UCBFL1                                                   07691000
UCBUSING EQU   UCBPST                                                   07692000
UCBBUSYD EQU   UCBBSY                                                   07693000
UCBUA    EQU   UCBCHAN+1                                                07694000
UCBCHA   EQU   UCBCHAN                                                  07695000
UCBDADI  EQU   UCBSTAT                                                  07696000
UCBSYSR  EQU   UCBSTAT                                                  07697000
UCBALOC  EQU   UCBSTAT                                                  07698000
UCBUNLD  EQU   UCBSTAT                                                  07699000
UCBCHGS  EQU   UCBSTAT                                                  07700000
UCBID    EQU   UCBOB+2                                                  07701000
UCBALTPH EQU   UCBFL5                                                   07702000
UCBALTCU EQU   UCBFL5                                                   07703000
UCBNALOC EQU   UCBFL5                                                   07704000
UCBENVRD EQU   UCBFL5                                                   07705000
UCBVSDR  EQU   UCBFL5                                                   07706000
UCBSASK  EQU   UCBFL5                                                   07707000
UCBAMV   EQU   UCBAF                                                    07708000
UCBDCC   EQU   UCBFL5                                                   07709000
UCBMONT  EQU   UCBJBNR                                                  07710000
UCBRV011 EQU   UCBJBNR                                                  07711000
UCBMMSGP EQU   UCBJBNR                                                  07712000
UCBOLDSM EQU   UCBJBNR                                                  07713000
UCBRV003 EQU   UCBJBNR                                                  07714000
UCBDUC   EQU   UCBJBNR                                                  07715000
UCBJES3  EQU   UCBJBNR                                                  07716000
UCBVRDEV EQU   UCBJBNR                                                  07717000
UCBCMSEG EQU   UCBOB                                                    07718000
UCBPFXND EQU   UCB+512                                                  07719000
UCBIOQ   EQU   UCB+508                                                  07720000
UCBLOCK  EQU   UCB+504                                                  07721000
UCBPXST  EQU   UCB+504                                                  07722000
@NM00036 EQU   UCB                                                      07723000
NVTRMSG  EQU   NVT+540                                                  07724000
NVTRLOCK EQU   NVT+536                                                  07725000
NVTRCODE EQU   NVT+532                                                  07726000
@NM00035 EQU   NVT+529                                                  07727000
@NM00034 EQU   NVTFLPO                                                  07728000
NVTFLWS  EQU   NVTFLPO                                                  07729000
NVTFLQS  EQU   NVTFLPO                                                  07730000
@NM00033 EQU   NVTFLPO                                                  07731000
NVTSYSP  EQU   NVTFLPO                                                  07732000
NVTFLLST EQU   NVTFLPO                                                  07733000
NVTAPQE  EQU   NVT+524                                                  07734000
NVTFBQE2 EQU   NVT+520                                                  07735000
NVTFBQE1 EQU   NVT+516                                                  07736000
@NM00032 EQU   NVT+512                                                  07737000
NVTREALR EQU   NVT+508                                                  07738000
NVTFASVT EQU   NVT+504                                                  07739000
NVTLPALG EQU   NVT+496                                                  07740000
NVTVRLNG EQU   NVT+492                                                  07741000
NVTVRREG EQU   NVT+488                                                  07742000
NVTLVIRT EQU   NVT+484                                                  07743000
NVTDIRA  EQU   NVT+480                                                  07744000
NVTLPAND EQU   NVT+476                                                  07745000
NVTRMSS  EQU   NVT+472                                                  07746000
NVTRPQE  EQU   NVT+468                                                  07747000
NVTRLLE  EQU   NVT+464                                                  07748000
NVTRJPQ  EQU   NVT+460                                                  07749000
NVTVMSS  EQU   NVT+456                                                  07750000
NVTVPQE  EQU   NVT+452                                                  07751000
NVTVLLE  EQU   NVT+448                                                  07752000
NVTVJPQ  EQU   NVT+444                                                  07753000
NVTLSEC  EQU   NVTLOCAT+4                                               07754000
NVTLFST  EQU   NVTLOCAT                                                 07755000
NVTXSEC  EQU   NVTXCTL+4                                                07756000
NVTXFST  EQU   NVTXCTL                                                  07757000
@NM00031 EQU   NVT+425                                                  07758000
NVTLPACT EQU   NVT+424                                                  07759000
NVTCSLPG EQU   NVT+420                                                  07760000
NVTCSIOB EQU   NVT+416                                                  07761000
NVTCSLNM EQU   NVT+412                                                  07762000
NVTCSLIB EQU   NVT+408                                                  07763000
NVTBLDL  EQU   NVT+404                                                  07764000
NVTVRBLD EQU   NVT+400                                                  07765000
@NM00030 EQU   NVT+392                                                  07766000
NVTVRTCB EQU   NVT+388                                                  07767000
NVTVVTCB EQU   NVT+384                                                  07768000
NVTSPUCB EQU   NVT+382                                                  07769000
NVTQSCNT EQU   NVT+380                                                  07770000
NVTQSBUF EQU   NVT+376                                                  07771000
NVTRPAGE EQU   NVT+364                                                  07772000
@NM00029 EQU   NVT+363                                                  07773000
NVTABWS1 EQU   NVT+362                                                  07774000
NVTABCD1 EQU   NVT+360                                                  07775000
@NM00028 EQU   NVT+358                                                  07776000
NVTCPUAD EQU   NVT+356                                                  07777000
NVTTOD   EQU   NVT+352                                                  07778000
NVTSPE   EQU   NVT+344                                                  07779000
NVTMBEND EQU   NVT+340                                                  07780000
NVTMBUF  EQU   NVT+336                                                  07781000
NVTDCBSN EQU   NVT+332                                                  07782000
NVTDCBOC EQU   NVT+328                                                  07783000
@NM00027 EQU   NVT+308                                                  07784000
NVTNMBLD EQU   NVT+304                                                  07785000
NVTNIPM  EQU   NVT+292                                                  07786000
NVTIX    EQU   NVTFLWSC                                                 07787000
NVTFLWS1 EQU   NVTWPSW2+2                                               07788000
NVTIDPSW EQU   NVTWPSW2                                                 07789000
NVTWPSW1 EQU   NVTWTPSW                                                 07790000
NVTMCPSW EQU   NVT+216                                                  07791000
@NM00026 EQU   NVT+212                                                  07792000
NVTCLKER EQU   NVTFLCN                                                  07793000
NVTFLRAC EQU   NVTFLCN                                                  07794000
NVTFLNCK EQU   NVTFLCN                                                  07795000
NVTFLNHC EQU   NVTFLCN                                                  07796000
NVTFLASM EQU   NVTFLCN                                                  07797000
NVTMP    EQU   NVTFLCN                                                  07798000
NVTFLIOC EQU   NVTFLCN                                                  07799000
NVTFLAC  EQU   NVTFLCN                                                  07800000
NVTFLSG  EQU   NVT+210                                                  07801000
NVTTRACE EQU   NVT+208                                                  07802000
NVTNXPTR EQU   NVT+204                                                  07803000
NVTNXSIZ EQU   NVT+202                                                  07804000
@NM00025 EQU   NVT+200                                                  07805000
NVTSGPSA EQU   NVT+196                                                  07806000
NVTN0MSG EQU   NVT+192                                                  07807000
NVTVVPG1 EQU   NVT+188                                                  07808000
NVTNBFND EQU   NVT+184                                                  07809000
NVTNUCND EQU   NVT+180                                                  07810000
NVTSTMAP EQU   NVT+176                                                  07811000
NVTRTMSA EQU   NVT+172                                                  07812000
NVTMFASA EQU   NVT+168                                                  07813000
NVTLSPQE EQU   NVT+164                                                  07814000
NVTALSQA EQU   NVT+160                                                  07815000
NVTPQSAV EQU   NVT+156                                                  07816000
NVTSVC60 EQU   NVT+148                                                  07817000
NVTABSEC EQU   NVTABSAV+4                                               07818000
NVTABFST EQU   NVTABSAV                                                 07819000
NVTNVSQA EQU   NVT+138                                                  07820000
NVTRSVMN EQU   NVT+136                                                  07821000
NVTNBMIN EQU   NVT+134                                                  07822000
NVTRGNAV EQU   NVT+132                                                  07823000
NVTLSQNO EQU   NVT+130                                                  07824000
NVTSQANO EQU   NVT+128                                                  07825000
NVTLSQAS EQU   NVT+124                                                  07826000
NVTLNGFX EQU   NVT+120                                                  07827000
NVTIGXER EQU   NVT+116                                                  07828000
@NM00024 EQU   NVT+112                                                  07829000
NVTASMAD EQU   NVT+108                                                  07830000
NVTNVRSZ EQU   NVT+104                                                  07831000
NVTMFA   EQU   NVT+100                                                  07832000
NVTDSSNG EQU   NVT+96                                                   07833000
NVTMSLNK EQU   NVT+92                                                   07834000
NVTVVMDI EQU   NVT+88                                                   07835000
NVTIGCER EQU   NVT+84                                                   07836000
NVTVBLDL EQU   NVT+80                                                   07837000
NVTSVCTB EQU   NVT+76                                                   07838000
NVTASTCB EQU   NVT+72                                                   07839000
NVTAASCB EQU   NVT+68                                                   07840000
NVTMASCB EQU   NVT+64                                                   07841000
NVTCMTCB EQU   NVT+60                                                   07842000
NVTMSTCB EQU   NVT+56                                                   07843000
@NM00023 EQU   NVTFLLB                                                  07844000
NVTFLSLB EQU   NVTFLLB                                                  07845000
@NM00022 EQU   NVTNPATR                                                 07846000
NVTNPREU EQU   NVTNPREN                                                 07847000
@NM00021 EQU   NVTNPREN                                                 07848000
NVTNPSFX EQU   NVT+53                                                   07849000
@NM00020 EQU   NVT+50                                                   07850000
NVTNPSUF EQU   NVT                                                      07851000
ICBCPUID EQU   ICB2SSCB+496                                             07852000
ICBLORD  EQU   ICBTRACE+256                                             07853000
ICBOTRC  EQU   ICBTRACE                                                 07854000
ICBFAB   EQU   ICB2SSCB+108                                             07855000
ICBMSSC  EQU   ICB2SSCB+104                                             07856000
ICBRSVP  EQU   ICB2SSCB+100                                             07857000
ICBAEAP  EQU   ICB2SSCB+96                                              07858000
ICBSIOBP EQU   ICB2SSCB+92                                              07859000
ICBIATNA EQU   ICB2SSCB+88                                              07860000
ICBIPRGA EQU   ICB2SSCB+84                                              07861000
ICBSRBP  EQU   ICB2SSCB+80                                              07862000
ICBVVICB EQU   ICB2SSCB+76                                              07863000
ICBVVIC  EQU   ICB2SSCB+72                                              07864000
ICBSIOP  EQU   ICB2SSCB+68                                              07865000
ICBMEP   EQU   ICB2SSCB+64                                              07866000
ICBIORCI EQU   ICB2SSCB+60                                              07867000
ICB2ACTP EQU   ICB2SSCB+56                                              07868000
ICBSAMP  EQU   ICBFLG+2                                                 07869000
ICBFG2   EQU   ICBFLG+1                                                 07870000
@NM00019 EQU   ICBFG1                                                   07871000
ICBMSCA  EQU   ICBFG1                                                   07872000
ICBMSCMP EQU   ICBFG1                                                   07873000
ICBS     EQU   ICBFG1                                                   07874000
ICBB     EQU   ICBFG1                                                   07875000
ICBV     EQU   ICBFG1                                                   07876000
ICBR     EQU   ICBFG1                                                   07877000
ICBNVT   EQU   ICBOPT                                                   07878000
ICBVN02P EQU   ICB2SSCB+44                                              07879000
ICBTCB   EQU   ICB2SSCB+40                                              07880000
ICBQHEAD EQU   ICB2SSCB+36                                              07881000
ICBAUCB  EQU   ICB2SSCB+32                                              07882000
ICBPUCB  EQU   ICB2SSCB+28                                              07883000
ICBCOMQ  EQU   ICB2SSCB+24                                              07884000
ICBIOR   EQU   ICB2SSCB+20                                              07885000
ICBCOM   EQU   ICB2SSCB+16                                              07886000
ICBACTV  EQU   ICB2SSCB+12                                              07887000
ICBECB   EQU   ICB2SSCB+8                                               07888000
ICBSSNAM EQU   ICB2SSCB                                                 07889000
CVTLEVL  EQU   CVTRELNO+2                                               07890000
CVTNUMB  EQU   CVTRELNO                                                 07891000
CVTMDL   EQU   CVTFIX+250                                               07892000
@NM00018 EQU   CVTFIX+248                                               07893000
@NM00017 EQU   CVTFIX                                                   07894000
CVTRV482 EQU   CVTXTNT2+128                                             07895000
CVTRV481 EQU   CVTXTNT2+124                                             07896000
CVTRV480 EQU   CVTXTNT2+120                                             07897000
CVTRV479 EQU   CVTXTNT2+118                                             07898000
CVTRV478 EQU   CVTXTNT2+117                                             07899000
CVTRV477 EQU   CVTXTNT2+116                                             07900000
CVTRV476 EQU   CVTXTNT2+115                                             07901000
CVTRV475 EQU   CVTXTNT2+114                                             07902000
CVTRV474 EQU   CVTRV466                                                 07903000
CVTRV473 EQU   CVTRV466                                                 07904000
CVTRV472 EQU   CVTRV466                                                 07905000
CVTRV471 EQU   CVTRV466                                                 07906000
CVTRV470 EQU   CVTRV466                                                 07907000
CVTRV469 EQU   CVTRV466                                                 07908000
CVTRV468 EQU   CVTRV466                                                 07909000
CVTRV467 EQU   CVTRV466                                                 07910000
CVTRV465 EQU   CVTRV457                                                 07911000
CVTRV464 EQU   CVTRV457                                                 07912000
CVTRV463 EQU   CVTRV457                                                 07913000
CVTRV462 EQU   CVTRV457                                                 07914000
CVTRV461 EQU   CVTRV457                                                 07915000
CVTRV460 EQU   CVTRV457                                                 07916000
CVTRV459 EQU   CVTRV457                                                 07917000
CVTRV458 EQU   CVTRV457                                                 07918000
CVTRV456 EQU   CVTXTNT2+108                                             07919000
CVTRV455 EQU   CVTXTNT2+104                                             07920000
CVTRV454 EQU   CVTXTNT2+100                                             07921000
CVTRV453 EQU   CVTXTNT2+96                                              07922000
CVTRV452 EQU   CVTXTNT2+94                                              07923000
CVTRV451 EQU   CVTXTNT2+92                                              07924000
CVTRV450 EQU   CVTXTNT2+90                                              07925000
CVTRV449 EQU   CVTXTNT2+88                                              07926000
CVTRV448 EQU   CVTXTNT2+87                                              07927000
CVTRV447 EQU   CVTXTNT2+86                                              07928000
CVTRV446 EQU   CVTRV438                                                 07929000
CVTRV445 EQU   CVTRV438                                                 07930000
CVTRV444 EQU   CVTRV438                                                 07931000
CVTRV443 EQU   CVTRV438                                                 07932000
CVTRV442 EQU   CVTRV438                                                 07933000
CVTRV441 EQU   CVTRV438                                                 07934000
CVTRV440 EQU   CVTRV438                                                 07935000
CVTRV439 EQU   CVTRV438                                                 07936000
CVTRV437 EQU   CVTRV429                                                 07937000
CVTRV436 EQU   CVTRV429                                                 07938000
CVTRV435 EQU   CVTRV429                                                 07939000
CVTRV434 EQU   CVTRV429                                                 07940000
CVTRV433 EQU   CVTRV429                                                 07941000
CVTRV432 EQU   CVTRV429                                                 07942000
CVTRV431 EQU   CVTRV429                                                 07943000
CVTRV430 EQU   CVTRV429                                                 07944000
CVTRV428 EQU   CVTXTNT2+80                                              07945000
CVTRV427 EQU   CVTXTNT2+76                                              07946000
CVTRV426 EQU   CVTXTNT2+72                                              07947000
CVTRV425 EQU   CVTXTNT2+68                                              07948000
CVTATACT EQU   CVTATCVT                                                 07949000
CVTRV423 EQU   CVTXTNT2+62                                              07950000
CVTRV422 EQU   CVTXTNT2+60                                              07951000
CVTRV421 EQU   CVTXTNT2+58                                              07952000
CVTRV420 EQU   CVTXTNT2+56                                              07953000
CVTRV419 EQU   CVTXTNT2+55                                              07954000
CVTRV418 EQU   CVTXTNT2+54                                              07955000
CVTRV417 EQU   CVTRV409                                                 07956000
CVTRV416 EQU   CVTRV409                                                 07957000
CVTRV415 EQU   CVTRV409                                                 07958000
CVTRV414 EQU   CVTRV409                                                 07959000
CVTRV413 EQU   CVTRV409                                                 07960000
CVTRV412 EQU   CVTRV409                                                 07961000
CVTRV411 EQU   CVTRV409                                                 07962000
CVTRV410 EQU   CVTRV409                                                 07963000
CVTRV408 EQU   CVTRV400                                                 07964000
CVTRV407 EQU   CVTRV400                                                 07965000
CVTRV406 EQU   CVTRV400                                                 07966000
CVTRV405 EQU   CVTRV400                                                 07967000
CVTRV404 EQU   CVTRV400                                                 07968000
CVTRV403 EQU   CVTRV400                                                 07969000
CVTRV402 EQU   CVTRV400                                                 07970000
CVTRV401 EQU   CVTRV400                                                 07971000
CVTSKTA  EQU   CVTXTNT2+44                                              07972000
CVTRSV99 EQU   CVTXTNT2+40                                              07973000
CVTRSV98 EQU   CVTXTNT2+36                                              07974000
CVTRSV97 EQU   CVTXTNT2+34                                              07975000
CVTRSV96 EQU   CVTXTNT2+32                                              07976000
CVTOLTEP EQU   CVTXTNT2+28                                              07977000
CVTQIDA  EQU   CVTQID+1                                                 07978000
CVTRSV95 EQU   CVTQID                                                   07979000
CVTRSV94 EQU   CVTXTNT2+20                                              07980000
CVTRSV93 EQU   CVTXTNT2+16                                              07981000
CVTRSV92 EQU   CVTXTNT2+12                                              07982000
CVTDEBVR EQU   CVTXTNT2+8                                               07983000
CVTRSV91 EQU   CVTXTNT2+6                                               07984000
CVTRSV9H EQU   CVTFLGBT                                                 07985000
CVTRSV9G EQU   CVTFLGBT                                                 07986000
CVTRSV9F EQU   CVTFLGBT                                                 07987000
CVTRSV9E EQU   CVTFLGBT                                                 07988000
CVTRSV9D EQU   CVTFLGBT                                                 07989000
CVTRSV9C EQU   CVTFLGBT                                                 07990000
CVTVME   EQU   CVTFLGBT                                                 07991000
CVTNPE   EQU   CVTFLGBT                                                 07992000
CVTNUCLS EQU   CVTXTNT2+4                                               07993000
CVTDSSVA EQU   CVTDSSV+1                                                07994000
CVTRSV89 EQU   CVTDSSV                                                  07995000
CVTRSV88 EQU   CVTXTNT1+8                                               07996000
CVTRSV87 EQU   CVTXTNT1+4                                               07997000
CVTFACHN EQU   CVTXTNT1                                                 07998000
CVTRV488 EQU   CVTMAP+412                                               07999000
CVTRV487 EQU   CVTMAP+408                                               08000000
CVTRV486 EQU   CVTMAP+404                                               08001000
CVTRV485 EQU   CVTMAP+400                                               08002000
CVTACTAP EQU   CVTMAP+396                                               08003000
CVTAUTH  EQU   CVTMAP+392                                               08004000
CVTATMCA EQU   CVTATMCT+1                                               08005000
CVTATMST EQU   CVTATMCT                                                 08006000
CVTRSV61 EQU   CVTMAP+384                                               08007000
CVTVOLT1 EQU   CVTVOLM1+1                                               08008000
CVTVOLI1 EQU   CVTVOLF1                                                 08009000
CVTSTOA  EQU   CVTMAP+376                                               08010000
CVTRSV58 EQU   CVTMAP+374                                               08011000
CVTRSV57 EQU   CVTMAP+372                                               08012000
CVTDDCE  EQU   CVTMAP+368                                               08013000
CVTPNWFR EQU   CVTMAP+364                                               08014000
CVTSMF   EQU   CVTMAP+360                                               08015000
CVTSULK  EQU   CVTMAP+358                                               08016000
CVTSLKO  EQU   CVTSYSK                                                  08017000
CVTSLKP  EQU   CVTSYSK                                                  08018000
CVTSLKQ  EQU   CVTSYSK                                                  08019000
CVTSLKR  EQU   CVTSYSK                                                  08020000
CVTRSV56 EQU   CVTSYSK                                                  08021000
CVTRSV55 EQU   CVTSYSK                                                  08022000
CVTRSV54 EQU   CVTSYSK                                                  08023000
CVTRSV53 EQU   CVTSYSK                                                  08024000
CVTRSV52 EQU   CVTA1F1                                                  08025000
CVTRSV51 EQU   CVTA1F1                                                  08026000
CVTRSV50 EQU   CVTA1F1                                                  08027000
CVTRSV49 EQU   CVTA1F1                                                  08028000
CVTRSV48 EQU   CVTA1F1                                                  08029000
CVTRSV47 EQU   CVTA1F1                                                  08030000
CVTSRSW  EQU   CVTA1F1                                                  08031000
CVTPFSW  EQU   CVTA1F1                                                  08032000
CVTPCVT  EQU   CVTMAP+352                                               08033000
CVTRSV46 EQU   CVTMAP+344                                               08034000
CVTRSV45 EQU   CVTMAP+340                                               08035000
CVTRSV44 EQU   CVTMAP+338                                               08036000
CVTRSV43 EQU   CVTMAP+336                                               08037000
CVTHJESA EQU   CVTHJES+1                                                08038000
CVTRSV42 EQU   CVTHJES                                                  08039000
CVTEXT2A EQU   CVTEXT2+1                                                08040000
CVTRSV41 EQU   CVTEXT2                                                  08041000
CVTAPFA  EQU   CVTAPF+1                                                 08042000
CVTRSV40 EQU   CVTAPF                                                   08043000
CVTRV518 EQU   CVTINTLA                                                 08044000
CVTRV517 EQU   CVTERPV                                                  08045000
CVTEORM  EQU   CVTMAP+312                                               08046000
CVTMCHPR EQU   CVTMAP+308                                               08047000
CVTTZ    EQU   CVTMAP+304                                               08048000
CVTJEPS  EQU   CVTMAP+300                                               08049000
CVTJESCT EQU   CVTMAP+296                                               08050000
CVTMODE  EQU   CVTMAP+292                                               08051000
CVTPTRV  EQU   CVTMAP+288                                               08052000
CVTREAL  EQU   CVTMAP+284                                               08053000
CVTRSV39 EQU   CVTMAP+280                                               08054000
CVTRSV38 EQU   CVTMAP+276                                               08055000
CVTDMSRA EQU   CVTDMSR+1                                                08056000
CVTRV634 EQU   CVTDMSRF                                                 08057000
CVTRV633 EQU   CVTDMSRF                                                 08058000
CVTRV632 EQU   CVTDMSRF                                                 08059000
CVTRV631 EQU   CVTDMSRF                                                 08060000
CVTRV630 EQU   CVTDMSRF                                                 08061000
CVTRV629 EQU   CVTDMSRF                                                 08062000
CVTUDUMP EQU   CVTDMSRF                                                 08063000
CVTSDUMP EQU   CVTDMSRF                                                 08064000
CVTQMSGA EQU   CVTQMSG+1                                                08065000
CVTRSV36 EQU   CVTQMSG                                                  08066000
CVTAMFF  EQU   CVTMAP+264                                               08067000
CVTPURGA EQU   CVTPURG+1                                                08068000
CVTRSV35 EQU   CVTPURG                                                  08069000
CVTCBSP  EQU   CVTMAP+256                                               08070000
CVTATERA EQU   CVTATER+1                                                08071000
CVTSYST  EQU   CVTATER                                                  08072000
CVTVOLT2 EQU   CVTTAT                                                   08073000
CVTVOLI2 EQU   CVTVOLF2                                                 08074000
CVTAQAVB EQU   CVTAQAVT+1                                               08075000
CVTRSV34 EQU   CVTTCMFG                                                 08076000
CVTRSV33 EQU   CVTTCMFG                                                 08077000
CVTRSV32 EQU   CVTTCMFG                                                 08078000
CVTRSV31 EQU   CVTTCMFG                                                 08079000
CVTRSV30 EQU   CVTTCMFG                                                 08080000
CVTRSV29 EQU   CVTTCMFG                                                 08081000
CVTRSV28 EQU   CVTTCMFG                                                 08082000
CVTTCRDY EQU   CVTTCMFG                                                 08083000
CVTGTFA  EQU   CVTGTF+1                                                 08084000
CVTRSV27 EQU   CVTGTFST                                                 08085000
CVTRNIO  EQU   CVTGTFST                                                 08086000
CVTUSR   EQU   CVTGTFST                                                 08087000
CVTRV318 EQU   CVTFORM                                                  08088000
CVTRV317 EQU   CVTTMODE                                                 08089000
CVTRV316 EQU   CVTSTATE                                                 08090000
CVTRV315 EQU   CVTGTFS                                                  08091000
CVTGTFAV EQU   CVTGTFS                                                  08092000
CVT0SCR1 EQU   CVTMAP+232                                               08093000
CVTRV515 EQU   CVTMAP+228                                               08094000
CVTRMS   EQU   CVTMAP+224                                               08095000
CVTPATCH EQU   CVTMAP+220                                               08096000
CVTTSCE  EQU   CVTMAP+216                                               08097000
CVTLNKSC EQU   CVTMAP+214                                               08098000
CVTQABST EQU   CVTMAP+212                                               08099000
CVTMDLDS EQU   CVTMAP+208                                               08100000
CVTUSER  EQU   CVTMAP+204                                               08101000
CVTABEND EQU   CVTMAP+200                                               08102000
CVTSMCA  EQU   CVTMAP+196                                               08103000
CVTRSV18 EQU   CVTMAP+192                                               08104000
CVTQLPAQ EQU   CVTMAP+188                                               08105000
CVTQCDSR EQU   CVTMAP+184                                               08106000
CVTRSV17 EQU   CVTOPTB                                                  08107000
CVTRSV16 EQU   CVTOPTB                                                  08108000
CVTFP    EQU   CVTOPTB                                                  08109000
CVTAPTHR EQU   CVTOPTB                                                  08110000
CVTNLOG  EQU   CVTOPTB                                                  08111000
CVTTOD   EQU   CVTOPTB                                                  08112000
CVTCTIMS EQU   CVTOPTB                                                  08113000
CVTPROT  EQU   CVTOPTB                                                  08114000
CVTXPFP  EQU   CVTOPTA                                                  08115000
CVTASCII EQU   CVTOPTA                                                  08116000
CVTRSV13 EQU   CVTOPTA                                                  08117000
CVTRSV12 EQU   CVTOPTA                                                  08118000
CVTNIP   EQU   CVTOPTA                                                  08119000
CVTDDR   EQU   CVTOPTA                                                  08120000
CVTAPR   EQU   CVTOPTA                                                  08121000
CVTCCH   EQU   CVTOPTA                                                  08122000
CVTSNCTR EQU   CVTMAP+180                                               08123000
CVTQMWR  EQU   CVTMAP+176                                               08124000
CVTQOCR  EQU   CVTMAP+172                                               08125000
CVT1EF00 EQU   CVTMAP+168                                               08126000
CVTMZ00  EQU   CVTMAP+164                                               08127000
CVTHEAD  EQU   CVTMAP+160                                               08128000
CVTRSV11 EQU   CVTMAP+156                                               08129000
CVT0PT01 EQU   CVTMAP+152                                               08130000
CVTMSER  EQU   CVTMAP+148                                               08131000
CVTRV516 EQU   CVTIERLC                                                 08132000
CVTILCH  EQU   CVTMAP+140                                               08133000
CVT0DS   EQU   CVTMAP+136                                               08134000
CVTFBOSV EQU   CVTMAP+132                                               08135000
CVTNUCB  EQU   CVTMAP+128                                               08136000
CVTIXAVL EQU   CVTMAP+124                                               08137000
CVTIOQET EQU   CVTMAP+120                                               08138000
CVTDCBA  EQU   CVTMAP+117                                               08139000
CVTMVS2  EQU   CVTDCB                                                   08140000
CVT6DAT  EQU   CVTDCB                                                   08141000
CVT4MPS  EQU   CVTDCB                                                   08142000
CVTRSV09 EQU   CVTDCB                                                   08143000
CVT4MS1  EQU   CVTDCB                                                   08144000
CVT2SPS  EQU   CVTDCB                                                   08145000
CVT1SSS  EQU   CVTDCB                                                   08146000
CVTRSV08 EQU   CVTDCB                                                   08147000
CVTSTB   EQU   CVTMAP+112                                               08148000
CVTQTD00 EQU   CVTMAP+108                                               08149000
CVTQTE00 EQU   CVTMAP+104                                               08150000
CVTCUCB  EQU   CVTMAP+100                                               08151000
CVTSJQ   EQU   CVTMAP+96                                                08152000
CVTPBLDL EQU   CVTMAP+92                                                08153000
CVTTPC   EQU   CVTMAP+88                                                08154000
CVTSVDCB EQU   CVTMAP+84                                                08155000
CVTEXIT  EQU   CVTMAP+80                                                08156000
CVT0FN00 EQU   CVTMAP+76                                                08157000
CVTDARA  EQU   CVTDAR+1                                                 08158000
CVTRSV07 EQU   CVTFLGS1                                                 08159000
CVTRSV06 EQU   CVTFLGS1                                                 08160000
CVTRSV05 EQU   CVTFLGS1                                                 08161000
CVTRSV04 EQU   CVTFLGS1                                                 08162000
CVTRSV03 EQU   CVTFLGS1                                                 08163000
CVTRSV02 EQU   CVTFLGS1                                                 08164000
CVTRSV01 EQU   CVTFLGS1                                                 08165000
CVTDMPLK EQU   CVTFLGS1                                                 08166000
CVTXITP  EQU   CVTMAP+68                                                08167000
CVTZDTAB EQU   CVTMAP+64                                                08168000
CVTMSLT  EQU   CVTMAP+60                                                08169000
CVTDATE  EQU   CVTMAP+56                                                08170000
CVTBTERM EQU   CVTMAP+52                                                08171000
CVTSYSAD EQU   CVTMAP+48                                                08172000
CVTXTLER EQU   CVTMAP+44                                                08173000
CVTILK1  EQU   CVTMAP+36                                                08174000
CVT0VL00 EQU   CVTMAP+24                                                08175000
CVTXAPG  EQU   CVTMAP+20                                                08176000
CVTBUF   EQU   CVTMAP+16                                                08177000
CVTJOB   EQU   CVTMAP+12                                                08178000
CVTLINK  EQU   CVTMAP+8                                                 08179000
CVT0EF00 EQU   CVTMAP+4                                                 08180000
CVTTCBP  EQU   CVTMAP                                                   08181000
CVT      EQU   CVTMAP                                                   08182000
WTORDEB  EQU   WTORDCB+44                                               08183000
@NM00013 EQU   WTORDCB                                                  08184000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      08185000
@RF00272 EQU   @RC00270                                                 08186000
@RC00370 EQU   @RC00369                                                 08187000
@RC00397 EQU   @RC00396                                                 08188000
@RF00455 EQU   @RC00343                                                 08189000
@RC00465 EQU   @RC00463                                                 08190000
@RT00549 EQU   ERR                                                      08191000
@RC00572 EQU   @RC00571                                                 08192000
@RC00615 EQU   @RC00571                                                 08193000
@RC00692 EQU   @RC00683                                                 08194000
@RC00707 EQU   @RC00697                                                 08195000
@RC00730 EQU   @RC00697                                                 08196000
@RC00900 EQU   @RC00897                                                 08197000
@RC00867 EQU   @RC00861                                                 08198000
@RC01072 EQU   @RC01071                                                 08199000
@RF00802 EQU   @EL00001                                                 08200000
@RF01200 EQU   @EL00001                                                 08201000
@RT01250 EQU   NIPPMPRD                                                 08202000
@RT01261 EQU   NIPPMPFN                                                 08203000
@RT01263 EQU   NIPPMPER                                                 08204000
@RT01272 EQU   NIPPMPRD                                                 08205000
@RT01280 EQU   NIPPMPXT                                                 08206000
@RF01311 EQU   NIPPMTER                                                 08207000
@RF01318 EQU   NIPPMTER                                                 08208000
@RT01338 EQU   NIPPMPRD                                                 08209000
@RF01338 EQU   NIPPMTND                                                 08210000
@RF01336 EQU   NIPPMPBK                                                 08211000
@RT01354 EQU   NIPPMPXT                                                 08212000
@RC01376 EQU   @EL00002                                                 08213000
@RC01374 EQU   @EL00002                                                 08214000
@PB00003 EQU   @EL00001                                                 08215000
@RC00371 EQU   @RC00370                                                 08216000
@RC00403 EQU   @RC00397                                                 08217000
@RC00749 EQU   @RC00730                                                 08218000
@RC00902 EQU   @RC00900                                                 08219000
@RC00868 EQU   @RC00867                                                 08220000
@PB00002 EQU   @PB00003                                                 08221000
@RC00407 EQU   @RC00403                                                 08222000
@RC00869 EQU   @RC00868                                                 08223000
@RF00411 EQU   @RC00407                                                 08224000
@RF00891 EQU   @RC00869                                                 08225000
@RF00926 EQU   @RC00869                                                 08226000
@ENDDATA EQU   *                                                        08227000
         END   IEAVAP00,(C'PLS1957',0701,77046)                         08228000
