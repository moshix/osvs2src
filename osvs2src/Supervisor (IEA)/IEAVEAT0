         TITLE ' IEAVEAT0 - ATTACH - SVC 42 - IGC0004B                 *00001000
                        '                                               00002000
IGC0004B CSECT ,                                                   0001 00003000
@PROLOG  DS    0H                                                  0002 00004000
RBPRFXLN EQU 64                                                         00005000
RBPRFLNA EQU 32                                                         00006000
PRBLEN   EQU 136                                                        00007000
SIRBLEN  EQU 200                                                        00008000
TIRBLEN  EQU 136                                                        00009000
IRBLEN   EQU 128                                                        00010000
SVRBLEN  EQU 224                                                        00011000
         SPACE 2                                                        00012000
C0       EQU   0                       CONSTANT 0             @ZA25845  00013000
C7       EQU   7                       CONSTANT 7                       00014000
C8       EQU   8                       CONSTANT 8                       00015000
X1       EQU   X'01'                   DISPLACEMENT ONE                 00016000
XFFF     EQU   X'FFF'                  DISPLACEMENT 4095                00017000
SP250EQU EQU   250                     SUBPOOL 250                      00018000
SP253EQU EQU   253                     SUBPOOL 253                      00019000
SP255EQU EQU   255                     SUBPOOL 255                      00020000
SALENGTH EQU   72                      LENGTH OF PROBLEM PGM SAVE AREA  00021000
SVRBDWDS EQU   (SVRBLEN+7)/8           LENGTH OF SVRB IN DWORDS         00022000
IRBDWDS  EQU   (IRBLEN+7)/8            LENGTH OF IRB IN DWORDS          00023000
MASKPDSL EQU   B'00011111'             MASK FOR DIRECTORY ENTRY LENGTH  00024000
         SPACE                                                          00025000
         USING IGC0004B,R6BASE                                          00026000
         MODID BR=YES                                                   00027000
         SPACE                                                          00028000
*                                   /* ESTABLISH ADDRESSABILITY      */ 00029000
         SPACE                                                          00030000
         LA    R9BASE,XFFF(,R6BASE)    INCREMENT ENTRY POINT ADDRESS    00031000
         LA    R9BASE,X1(,R9BASE)        BY 4096 FOR SECOND BASE REG    00032000
         USING IGC0004B,R6BASE,R9BASE  ESTABLISH ADDRESSABILITY         00033000
         SPACE                                                          00034000
*   R12SVRB=ADDR(R5CURRB->RBEXSAVE);/* ADDR OF PERM WORKAREA         */ 00035000
         LA    R12SVRB,RBEXSAVE(,R5CURRB)                          0147 00036000
*   RFY                                                            0148 00037000
*    (R2WORK) RSTD;                 /*                       @Z40FPYB*/ 00038000
*   R2WORK=R5CURRB-LENGTH(RBPRFX);  /* RBPRFX PTR FOR FESTAE @Z40FPYB*/ 00039000
         LR    R2WORK,R5CURRB                                      0149 00040000
         SH    R2WORK,@CH00168                                     0149 00041000
*   R5NEWTCB=ZERO;                  /* INDICATE NO NEW TCB YET       */ 00042000
         SLR   R5NEWTCB,R5NEWTCB                                   0150 00043000
*   RFY                                                            0151 00044000
*     R1AREA RSTD;                                                 0151 00045000
*   R1AREA=R12SVRB;                 /* ADDRESS TO CLEAR              */ 00046000
         LR    R1AREA,R12SVRB                                      0152 00047000
*   AREA(1:LENGTH(RBEXSAVE))=AREA(1:LENGTH(RBEXSAVE))&&AREA(1:LENGTH(   00048000
*       RBEXSAVE));                 /* CLEAR                         */ 00049000
         XC    AREA(48,R1AREA),AREA(R1AREA)                        0153 00050000
*   RFY                                                            0154 00051000
*     R1AREA UNRSTD;                                               0154 00052000
*   WKNOAREA='1'B;                  /* NO WORKAREA STORAGE YET       */ 00053000
         OI    WKNOAREA(R12SVRB),B'00001000'                       0155 00054000
*   WKCURTCB=R4CURTCB;              /* JOURNAL CURRENT TCB ADDR      */ 00055000
         ST    R4CURTCB,WKCURTCB(,R12SVRB)                         0156 00056000
*/* D (NO,%FL01010,YES,)  CALLED BY A STAE EXIT ?                    */ 00057000
*                                                                  0157 00058000
*   IF R4CURTCB->TCBSTABE='1'B THEN                                0157 00059000
         TM    TCBSTABE(R4CURTCB),B'10000000'                      0157 00060000
         BNO   @RF00157                                            0157 00061000
*     DO;                           /* DO000001                      */ 00062000
*/* P  (,AT001000) SET RETURN CODE X'04'                             */ 00063000
*                                                                  0159 00064000
*       R15RETCD=X04STAE;           /* RETURN CODE 4, ATTACH IN STAE */ 00065000
         LA    R15RETCD,4                                          0159 00066000
*       GOTO AT001000;              /* EXIT NOT ALLOWED. RETURN.     */ 00067000
         B     AT001000                                            0160 00068000
*     END;                          /* END00001                      */ 00069000
*   RFY                                                            0162 00070000
*     R10INPRM RSTD;                                               0162 00071000
@RF00157 DS    0H                                                  0163 00072000
*   R10INPRM=R15INPRM;              /* SAVE INPUT PARM ADDRESS       */ 00073000
         LR    R10INPRM,R15INPRM                                   0163 00074000
*   RFY                                                            0164 00075000
*     R15INPRM UNRSTD;                                             0164 00076000
*                                                                  0165 00077000
*   /*****************************************************************/ 00078000
*   /*                                                               */ 00079000
*   /* IGC042ES IS THE ENTRY POINT ADDRESS OF AN ESTAE EXIT WHICH    */ 00080000
*   /* PROVIDES RECOVERY CAPABILITY DURING THOSE PERIODS OF ATTACH   */ 00081000
*   /* PROCESSING WHEN THE LOCAL LOCK IS NOT HELD.                   */ 00082000
*   /*                                                               */ 00083000
*   /*****************************************************************/ 00084000
*                                                                  0165 00085000
*/* %FL01010: L ESTAE: ESTABLISH ESTAE ENVIRONMENT                   */ 00086000
*                                                                  0165 00087000
*   RFY                                                            0165 00088000
*    (R1WORK) RSTD;                 /*                       @Z40FPYB*/ 00089000
*   R1WORK=ADDR(IGC042ES);          /* SET ESTAE EP FOR FESTAE     0166 00090000
*                                                            @Z40FPYB*/ 00091000
         LA    R1WORK,IGC042ES                                     0166 00092000
*   RFY                                                            0167 00093000
*     R15RETCD RSTD;                                               0167 00094000
*   GENERATE;                                                      0168 00095000
*                                                                  0168 00096000
         SPACE                                                          00097000
      FESTAE EXITADR=(R1WORK),RBADDR=(R2WORK),TCBADDR=(R4CURTCB),      C00098000
               TERM=YES,PARAM=(R12SVRB),RECORD=YES,ASYNCH=NO            00099000
         SPACE                                                          00100000
*/* D (NO,%FL01020,YES,) RETURN CODE ^= 0 ?                          */ 00101000
*                                                                  0169 00102000
*   IF R15RETCD^=X00NOERR THEN      /* FOR ERROR INDICATION,         */ 00103000
         LTR   R15RETCD,R15RETCD                                   0169 00104000
         BZ    @RF00169                                            0169 00105000
*     DO;                           /* DO000002                      */ 00106000
*/* P (,AT001000) INDICATE ABEND 92A                                 */ 00107000
*                                                                  0171 00108000
*       R15RETCD=ABEND92A;          /* INDICATE ABEND CODE, LEAVE  0171 00109000
*                                      REASON CODE 0                 */ 00110000
         LA    R15RETCD,2346                                       0171 00111000
*       GOTO AT001000;              /* GO CLEAN UP.                  */ 00112000
         B     AT001000                                            0172 00113000
*     END;                          /* END00002                      */ 00114000
*   RFY                                                            0174 00115000
*    (R1WORK,                                                      0174 00116000
*     R2WORK) UNRSTD;               /*                       @Z40FPYB*/ 00117000
@RF00169 DS    0H                                                  0175 00118000
*   WKESTAEL=WKESTAEL&&WKESTAEL;    /* CLEAR LIST AREA               */ 00119000
         XC    WKESTAEL(16,R12SVRB),WKESTAEL(R12SVRB)              0175 00120000
*   RFY                                                            0176 00121000
*     R15RETCD UNRSTD;                                             0176 00122000
*ATFP10:                                                           0177 00123000
*   WKFCODE=FCODE10;                /* TRACE                         */ 00124000
ATFP10   MVI   WKFCODE(R12SVRB),X'0A'                              0177 00125000
*                                                                  0178 00126000
*/********************************************************************/ 00127000
*/*                                                                  */ 00128000
*/*    OBTAIN LOCAL LOCK FOR PARAMETER PROCESSING AND IRB PROCESSING */ 00129000
*/*    (LOCK ALTERS REGISTERS 0,1,11,13,15)                          */ 00130000
*/*                                                                  */ 00131000
*/********************************************************************/ 00132000
*/* %FL01020: S LOCK: GET LOCAL LOCK                                 */ 00133000
*                                                                  0178 00134000
*   RFY                                                            0178 00135000
*     R15RETCD RSTD;                                               0178 00136000
*   CALL LOCK;                      /* GET LOCAL LOCK                */ 00137000
         BAL   @14,LOCK                                            0179 00138000
*/* D (YES,AT001000,NO,) ANY ERRORS ?                                */ 00139000
*                                                                  0180 00140000
*   IF R15RETCD^=X00NOERR THEN      /* FOR ERROR INDICATION          */ 00141000
         LTR   R15RETCD,R15RETCD                                   0180 00142000
         BNZ   @RT00180                                            0180 00143000
*     GOTO AT001000;                /* GO CLEAN UP                   */ 00144000
*   RFY                                                            0182 00145000
*     R15RETCD UNRSTD;                                             0182 00146000
*ATFP20:                                                           0183 00147000
*   WKFCODE=FCODE20;                /* TRACE                         */ 00148000
ATFP20   MVI   WKFCODE(R12SVRB),X'14'                              0183 00149000
*                                                                  0184 00150000
*   /*****************************************************************/ 00151000
*   /*                                                               */ 00152000
*   /* SUBROUTINE CHKPARM OBTAINS A BLOCK OF STORAGE FROM SUBPOOL    */ 00153000
*   /* 255. THE STORAGE IS USED FOR THE NEW SVRB AND THE DE SAVE (IF */ 00154000
*   /* REQUIRED). THE NEW SVRB STORAGE IS FIRST USED AS A WORKAREA,  */ 00155000
*   /* AND THE ATTACH PARAMETER LIST IS MOVED INTO THIS AREA BY      */ 00156000
*   /* CHKPARM. IF THERE IS A DIRECTORY ENTRY, IT IS MOVED INTO THE  */ 00157000
*   /* DE SAVE AREA. CONTROL FIELDS ARE SET IN THE TEMPORARY SAVE    */ 00158000
*   /* AREA (THAT IS,THE NEW SVRB STORAGE), AND THE PERMANENT SAVE   */ 00159000
*   /* AREA (THE RBEXSAVE FIELD OF THE CURRENT SVRB).                */ 00160000
*   /*                                                               */ 00161000
*   /*****************************************************************/ 00162000
*                                                                  0184 00163000
*/* S CHKPARM: OBTAIN STORAGE, VALIDITY CHECK AND MOVE PARMS         */ 00164000
*                                                                  0184 00165000
*   RFY                                                            0184 00166000
*     R15RETCD RSTD;                                               0184 00167000
*   CALL CHKPARM;                   /* PROCESS PARAMETER LIST        */ 00168000
         BAL   @14,CHKPARM                                         0185 00169000
*/* D (YES,AT001000,NO,)  ANY ERRORS ?                               */ 00170000
*                                                                  0186 00171000
*   IF R15RETCD^=X00NOERR THEN      /* IN CASE OF ERROR,             */ 00172000
         LTR   R15RETCD,R15RETCD                                   0186 00173000
         BNZ   @RT00186                                            0186 00174000
*     GOTO AT001000;                /* GO CLEAN UP                   */ 00175000
*   RFY                                                            0188 00176000
*     R15RETCD UNRSTD;                                             0188 00177000
*   RFY                                                            0189 00178000
*     R10INPRM UNRSTD;                                             0189 00179000
*   RFY                                                            0190 00180000
*     ATTCHLST BASED(R3WORKAD);     /* REG 3 SET BY CHKPARM          */ 00181000
*   RFY                                                            0191 00182000
*     WKAREA BASED(R3WORKAD);                                      0191 00183000
*                                                                  0192 00184000
*   /*****************************************************************/ 00185000
*   /*                                                               */ 00186000
*   /* THIS PROCESSING INSURES THAT JOB STEP TCB'S AND NON-JOB STEP  */ 00187000
*   /* TCB'S ARE NOT MIXED ON ANY LEVEL, AND ALSO THAT A NON-JOB STEP*/ 00188000
*   /* TASK HAS NO JOB STEP SUBTASKS.                                */ 00189000
*   /*                                                               */ 00190000
*   /*****************************************************************/ 00191000
*                                                                  0192 00192000
*/* D (NO,%FL01030,YES,) IS CALLER A JOB STEP TASK ?                 */ 00193000
*                                                                  0192 00194000
*   GENERATE REFS(R4CURTCB) SETS(R4CURTCB) NOFLOWS;                0192 00195000
         SPACE                                                          00196000
         LA    R4CURTCB,0(,R4CURTCB)   INSURE HIGH ORDER BYTE ZERO      00197000
         SPACE                                                          00198000
*   RFY                                                            0193 00199000
*     R0WORK RSTD;                                                 0193 00200000
*   R0WORK=R4CURTCB->TCBJSTCA;      /* ADDR OF THIS TASK'S JSTCB     */ 00201000
         SLR   R0WORK,R0WORK                                       0194 00202000
         ICM   R0WORK,7,TCBJSTCA(R4CURTCB)                         0194 00203000
*   IF R4CURTCB=R0WORK THEN         /* IS CALLER A JOB STEP TASK     */ 00204000
*                                                                  0195 00205000
         CR    R4CURTCB,R0WORK                                     0195 00206000
         BNE   @RF00195                                            0195 00207000
*     /***************************************************************/ 00208000
*     /*                                                             */ 00209000
*     /* FOR JOB STEP TASK CALLER, DETERMINE WHETHER A MIX OF JOB    */ 00210000
*     /* STEP AND NON-JOB STEP SUBTASKS RESULTS FROM THIS REQUEST. IF*/ 00211000
*     /* SO, SET RETURN CODE X'18' AND BRANCH TO CLEAN UP.           */ 00212000
*     /*                                                             */ 00213000
*     /***************************************************************/ 00214000
*                                                                  0196 00215000
*     DO;                           /* DO000003                      */ 00216000
*       RFY                                                        0197 00217000
*         R7WORK RSTD;                                             0197 00218000
*       R7WORK=R4CURTCB->TCBLTC;    /* ADDR OF FIRST SUBTASK, IF ANY */ 00219000
         L     R7WORK,TCBLTC(,R4CURTCB)                            0198 00220000
*/* D (NO,%FL01040,YES,) DOES THE CURRENT TASK HAVE ANY SUBTASKS ?   */ 00221000
*                                                                  0199 00222000
*       IF R7WORK^=ZERO THEN        /* IS THERE A SUBTASK ?          */ 00223000
         LTR   R7WORK,R7WORK                                       0199 00224000
         BZ    @RF00199                                            0199 00225000
*         DO;                       /* DO000004: YES, CHECK ATTACH 0200 00226000
*                                      JSTCB PARM                    */ 00227000
*           R0WORK=R7WORK->TCBJSTCA;/* JSTCB ADDRESS                 */ 00228000
         SLR   R0WORK,R0WORK                                       0201 00229000
         ICM   R0WORK,7,TCBJSTCA(R7WORK)                           0201 00230000
*/* D (NO,%FL01050,YES,) WAS JSTCB=YES SPECIFIED ?                   */ 00231000
*/*                        IF JSTCB=YES WAS SPECIFIED, THEN THE FIRST*/ 00232000
*/*                        SUBTASK MUST BE A JOB STEP SUBTASK. IF    */ 00233000
*/*                        JSTCB=NO WAS SPECIFIED, THEN THE FIRST    */ 00234000
*/*                        SUBTASK MUST BE A NON-JOB STEP SUBTASK.   */ 00235000
*/*                        THIS CHECK INSURES THAT IF THE FIRST SUB- */ 00236000
*/*                        TASK IS A JOB STEP TASK, ALL OTHER SUB-   */ 00237000
*/*                        TASKS ARE ALSO JOB STEP TASKS, AND THAT IF*/ 00238000
*/*                        THE FIRST TASK IS NOT A JOB STEP TASK, ALL*/ 00239000
*/*                        OTHER SUBTASKS ARE NOT JOB STEP TASKS.    */ 00240000
*                                                                  0202 00241000
*           IF ATJSTCB='1'B THEN    /* JSTCB PARM                    */ 00242000
         TM    ATJSTCB(R3WORKAD),B'00000010'                       0202 00243000
         BNO   @RF00202                                            0202 00244000
*             DO;                   /* DO000091                      */ 00245000
*/*                 JSTCB=YES WAS SPECIFIED                          */ 00246000
*/* D (YES,%FL01040,NO,) IS FIRST SUBTASK A JOB STEP TASK ?          */ 00247000
*                                                                  0204 00248000
*               IF R7WORK^=R0WORK THEN/* JOB STEP ?                  */ 00249000
         CR    R7WORK,R0WORK                                       0204 00250000
         BE    @RF00204                                            0204 00251000
*                 DO;               /* DO000005: NO, INVALID         */ 00252000
*/* P (,AT001000) SET RETURN CODE X'18'                              */ 00253000
*                                                                  0206 00254000
*                   RFY                                            0206 00255000
*                     R15RETCD RSTD;                               0206 00256000
*                   R15RETCD=X18JSTCB;/* RETURN CODE                 */ 00257000
         LA    R15RETCD,24                                         0207 00258000
*                   GOTO AT001000;  /* EXIT                          */ 00259000
         B     AT001000                                            0208 00260000
*                   RFY                                            0209 00261000
*                     R15RETCD UNRSTD;                             0209 00262000
*                 END;              /* END00005                      */ 00263000
*             END;                  /* END00091                      */ 00264000
*                                                                  0211 00265000
*           /*********************************************************/ 00266000
*           /*                                                       */ 00267000
*           /* JSTCB=NO WAS SPECIFIED                                */ 00268000
*           /*                                                       */ 00269000
*           /*********************************************************/ 00270000
*                                                                  0212 00271000
*/* %FL01050: D (NO,%FL01040,YES,) IS FIRST SUBTASK A JOB STEP TASK ?*/ 00272000
*                                                                  0212 00273000
*           ELSE                                                   0212 00274000
*             IF R7WORK=R0WORK THEN /* JOB STEP ?                    */ 00275000
         B     @RC00202                                            0212 00276000
@RF00202 CR    R7WORK,R0WORK                                       0212 00277000
         BNE   @RF00212                                            0212 00278000
*               DO;                 /* DO000006: YES, INVALID        */ 00279000
*/* P (,AT001000) SET RETURN CODE X'18'                              */ 00280000
*                                                                  0214 00281000
*                 RFY                                              0214 00282000
*                   R15RETCD RSTD;                                 0214 00283000
*                 R15RETCD=X18JSTCB;                               0215 00284000
         LA    R15RETCD,24                                         0215 00285000
*                 GOTO AT001000;    /* EXIT                          */ 00286000
         B     AT001000                                            0216 00287000
*                 RFY                                              0217 00288000
*                   R15RETCD UNRSTD;                               0217 00289000
*               END;                /* END00006                      */ 00290000
*         END;                      /* END00004                      */ 00291000
*     END;                          /* END00003                      */ 00292000
*                                                                  0220 00293000
*   /*****************************************************************/ 00294000
*   /*                                                               */ 00295000
*   /* FOR NON-JOB STEP CALLER INSURE THAT THE NEW SUBTASK IS NOT    */ 00296000
*   /* MADE A JOB STEP TASK. IF REQUEST IS FOR A JSTCB, SET RETURN   */ 00297000
*   /* CODE X'14' AND BRANCH TO CLEAN UP.                            */ 00298000
*   /*                                                               */ 00299000
*   /*****************************************************************/ 00300000
*                                                                  0221 00301000
*/* %FL01030: D (NO,%FL01040,YES,) WAS JSTCB=YES SPECIFIED ?         */ 00302000
*                                                                  0221 00303000
*   ELSE                                                           0221 00304000
*     IF ATJSTCB='1'B THEN          /* IF JSTCB=YES SPECIFIED,       */ 00305000
         B     @RC00195                                            0221 00306000
@RF00195 TM    ATJSTCB(R3WORKAD),B'00000010'                       0221 00307000
         BNO   @RF00221                                            0221 00308000
*       DO;                         /* DO000007                      */ 00309000
*/* P (,AT001000) SET RETURN CODE X'14'                              */ 00310000
*                                                                  0223 00311000
*         RFY                                                      0223 00312000
*           R15RETCD RSTD;                                         0223 00313000
*         R15RETCD=X14JSTCB;        /* SET RETURN CODE               */ 00314000
         LA    R15RETCD,20                                         0224 00315000
*         GOTO AT001000;            /* GO CLEAN UP                   */ 00316000
         B     AT001000                                            0225 00317000
*         RFY                                                      0226 00318000
*           R15RETCD UNRSTD;                                       0226 00319000
*       END;                        /* END00007                      */ 00320000
*   RFY                                                            0228 00321000
*     R7WORK UNRSTD;                                               0228 00322000
@RF00221 DS    0H                                                  0228 00323000
@RC00195 DS    0H                                                  0229 00324000
*   RFY                                                            0229 00325000
*     R0WORK UNRSTD;                                               0229 00326000
*                                                                  0230 00327000
*   /*****************************************************************/ 00328000
*   /*                                                               */ 00329000
*   /* SUBROUTINE GETCBS OBTAINS STORAGE FOR THE NEW TCB, AND CLEARS */ 00330000
*   /* IT TO ZERO. AN IQE, AND IF NECESSARY AN IRB, ARE OBTAINED AND */ 00331000
*   /* INITIALIZED, AND PROPERLY CHAINED OFF THE NEW TCB, IF ETXR WAS*/ 00332000
*   /* SPECIFIED. THE LOCAL LOCK IS RELEASED BY GETCBS.              */ 00333000
*   /*                                                               */ 00334000
*   /*****************************************************************/ 00335000
*                                                                  0230 00336000
*/* %FL01040: S GETCBS: OBTAIN NEW TCB STORAGE, PROCESS ETXR         */ 00337000
*                                                                  0230 00338000
*   RFY                                                            0230 00339000
*     R15RETCD RSTD;                                               0230 00340000
*                                                                  0230 00341000
*/*    REG R5NEWTCB IS SET IN SUBROUTINE                             */ 00342000
*                                                                  0231 00343000
*   CALL GETCBS;                    /* GET CONTROL BLOCKS            */ 00344000
         BAL   @14,GETCBS                                          0231 00345000
*/* D (YES,AT001000,NO,) ANY ERRORS ?                                */ 00346000
*                                                                  0232 00347000
*   IF R15RETCD^=X00NOERR THEN                                     0232 00348000
         LTR   R15RETCD,R15RETCD                                   0232 00349000
         BNZ   @RT00232                                            0232 00350000
*     GOTO AT001000;                /* GO CLEAN UP                   */ 00351000
*   RFY                                                            0234 00352000
*     R15RETCD UNRSTD;                                             0234 00353000
*                                                                  0235 00354000
*   /*****************************************************************/ 00355000
*   /*                                                               */ 00356000
*   /* SUBROUTINE STAIRTN PROCESSES THE STAI/ESTAI OPERANDS, AND     */ 00357000
*   /* PROPAGATES ANY STAI/ESTAI SCB'S FROM THE CURRENT (ATTACHING   */ 00358000
*   /* TASK'S) TCB TO THE NEW TCB.                                   */ 00359000
*   /*                                                               */ 00360000
*   /*****************************************************************/ 00361000
*                                                                  0235 00362000
*/* P SET TCBTCBID = C'TCB '                                         */ 00363000
*                                                                  0235 00364000
*   R5NEWTCB->TCBTCBID=CHARTCB;     /* EBCDIC 'TCB ', TCB IDENTIFIER */ 00365000
         MVC   TCBTCBID(4,R5NEWTCB),CHARTCB                        0235 00366000
*/* S STAIRTN: STAI/ESTAI PROCESSING                                 */ 00367000
*                                                                  0236 00368000
*   RFY                                                            0236 00369000
*     R15RETCD RSTD;                                               0236 00370000
*   CALL STAIRTN;                   /* STAI/ESTAI PARMS & PROPAGATE  */ 00371000
         BAL   @14,STAIRTN                                         0237 00372000
*/* D (YES,AT001000,NO,) ANY ERRORS ?                                */ 00373000
*                                                                  0238 00374000
*   IF R15RETCD^=X00NOERR THEN                                     0238 00375000
         LTR   R15RETCD,R15RETCD                                   0238 00376000
         BNZ   @RT00238                                            0238 00377000
*     GOTO AT001000;                /* GO CLEAN UP                   */ 00378000
*   RFY                                                            0240 00379000
*     R15RETCD UNRSTD;                                             0240 00380000
*ATFP90:                                                           0241 00381000
*   WKFCODE=FCODE90;                /* TRACE                         */ 00382000
ATFP90   MVI   WKFCODE(R12SVRB),X'5A'                              0241 00383000
*                                                                  0242 00384000
*   /*****************************************************************/ 00385000
*   /*                                                               */ 00386000
*   /* PROPAGATE INVARIANT FIELDS FROM CURRENT TCB TO NEW TCB        */ 00387000
*   /*                                                               */ 00388000
*   /*****************************************************************/ 00389000
*                                                                  0242 00390000
*/* P PROPAGATE TCBTIO, TCBPQE, TCBTCT, AND BIT TCBRV                */ 00391000
*                                                                  0242 00392000
*   R5NEWTCB->TCBTIO=R4CURTCB->TCBTIO;/* TIOT ADDRESS                */ 00393000
         MVC   TCBTIO(4,R5NEWTCB),TCBTIO(R4CURTCB)                 0242 00394000
*   R5NEWTCB->TCBPQE=R4CURTCB->TCBPQE;/* DPQE PTR                    */ 00395000
         MVC   TCBPQE(4,R5NEWTCB),TCBPQE(R4CURTCB)                 0243 00396000
*   R5NEWTCB->TCBTCT=R4CURTCB->TCBTCT;/* TIMING CONTROL TABLE        */ 00397000
         MVC   TCBTCT(4,R5NEWTCB),TCBTCT(R4CURTCB)                 0244 00398000
*   IF R4CURTCB->TCBRV='1'B THEN    /* PROPAGATE                     */ 00399000
         TM    TCBRV(R4CURTCB),B'10000000'                         0245 00400000
         BNO   @RF00245                                            0245 00401000
*     R5NEWTCB->TCBRV='1'B;         /* VIRTUAL = REAL FLAG           */ 00402000
         OI    TCBRV(R5NEWTCB),B'10000000'                         0246 00403000
*/* P PROPAGATE TCBSTPCT AND BIT TCBSTPPR FOR STATUS                 */ 00404000
*                                                                  0247 00405000
*   IF R4CURTCB->TCBSTPPR='1'B THEN                                0247 00406000
@RF00245 TM    TCBSTPPR(R4CURTCB),B'01000000'                      0247 00407000
         BNO   @RF00247                                            0247 00408000
*     DO;                           /* DO000097                      */ 00409000
*       R5NEWTCB->TCBSTPCT=R4CURTCB->TCBSTPCT;/* COUNT OF STATUS   0249 00410000
*                                      STOPS ISSUED AGAINST CURRENT     00411000
*                                      TCB                           */ 00412000
         MVC   TCBSTPCT(1,R5NEWTCB),TCBSTPCT(R4CURTCB)             0249 00413000
*       R5NEWTCB->TCBSTPPR='1'B;    /* STATUS STOP TCB PENDING       */ 00414000
         OI    TCBSTPPR(R5NEWTCB),B'01000000'                      0250 00415000
*     END;                          /* END00097                      */ 00416000
*                                                                  0251 00417000
*   /*****************************************************************/ 00418000
*   /*                                                               */ 00419000
*   /* THE FOLLOWING FIELDS MAY BE RESET IN ACCORDANCE WITH ATTACH   */ 00420000
*   /* PARAMETERS SPECIFIED BY CALLER.                               */ 00421000
*   /*                                                               */ 00422000
*   /*****************************************************************/ 00423000
*                                                                  0252 00424000
*/* P PROPAGATE TCBJLB, TCBJSCB, TCBJSTCB (MAY BE RESET LATER)       */ 00425000
*                                                                  0252 00426000
*   R5NEWTCB->TCBJLB=R4CURTCB->TCBJLB;/* JOBLIB DCB ADDR             */ 00427000
@RF00247 MVC   TCBJLB(4,R5NEWTCB),TCBJLB(R4CURTCB)                 0252 00428000
*   R5NEWTCB->TCBJSCBB=R4CURTCB->TCBJSCBB;/* JOBSTEP CNTL BLOCK      */ 00429000
         MVC   TCBJSCBB(3,R5NEWTCB),TCBJSCBB(R4CURTCB)             0253 00430000
*   R5NEWTCB->TCBJSTCB=R4CURTCB->TCBJSTCB;/* JOBSTEP TCB PTR         */ 00431000
         MVC   TCBJSTCB(4,R5NEWTCB),TCBJSTCB(R4CURTCB)             0254 00432000
*/* P PROPAGATE ASCBAFFN TO NEW TCBAFFN                              */ 00433000
*                                                                  0255 00434000
*   RFY                                                            0255 00435000
*     R7ASCB RSTD;                                                 0255 00436000
*   R7ASCB=PSAAOLD;                 /* ADDRESS OF CURRENT ASCB       */ 00437000
         L     R7ASCB,PSAAOLD                                      0256 00438000
*   R5NEWTCB->TCBAFFN=R7ASCB->ASCBAFFN;/* CPU AFFINITY BITS          */ 00439000
         MVC   TCBAFFN(2,R5NEWTCB),ASCBAFFN(R7ASCB)                0257 00440000
*   RFY                                                            0258 00441000
*     R7ASCB UNRSTD;                                               0258 00442000
*                                                                  0259 00443000
*   /*****************************************************************/ 00444000
*   /*                                                               */ 00445000
*   /* SET INVARIANT FIELDS IN NEW TCB                               */ 00446000
*   /*                                                               */ 00447000
*   /*****************************************************************/ 00448000
*                                                                  0259 00449000
*/* P SET TCBEXT2 IN NEW TCB TO ADDR OF TCBXTNT2 IN NEW TCB          */ 00450000
*                                                                  0259 00451000
*   R5NEWTCB->TCBEXT2=R5NEWTCB+LENGTH(TCB);/* THE COMMON EXTENSION 0259 00452000
*                                      (TCBXTNT2) FOLLOWS THE TCB  0259 00453000
*                                      PROPER                        */ 00454000
         LA    @08,296                                             0259 00455000
         ALR   @08,R5NEWTCB                                        0259 00456000
         ST    @08,TCBEXT2(,R5NEWTCB)                              0259 00457000
*/* P SET TCBATT = 1 IN NEW TCB                                      */ 00458000
*                                                                  0260 00459000
*   R5NEWTCB->TCBATT='1'B;          /* NEW TASK RUNS FIRST UNDER   0260 00460000
*                                      SVRB, NO ATTENTION INTRUPTS.  */ 00461000
         OI    TCBATT(R5NEWTCB),B'00100000'                        0260 00462000
*                                                                  0261 00463000
*   /*****************************************************************/ 00464000
*   /*                                                               */ 00465000
*   /* SET FIELDS IN NEW TCB AS SPECIFIED BY ATTACH PARAMETER LIST   */ 00466000
*   /*                                                               */ 00467000
*   /*****************************************************************/ 00468000
*                                                                  0261 00469000
*/* D (NO,%FL01200,YES,) WAS JSTCB=YES SPECIFIED ?                   */ 00470000
*                                                                  0261 00471000
*   IF ATJSTCB='1'B THEN                                           0261 00472000
*                                                                  0261 00473000
         TM    ATJSTCB(R3WORKAD),B'00000010'                       0261 00474000
         BNO   @RF00261                                            0261 00475000
*/* P RESET TCBJSTCB TO ADDR NEW TCB                                 */ 00476000
*                                                                  0262 00477000
*     DO;                           /* DO000039                      */ 00478000
*       R5NEWTCB->TCBJSTCB=R5NEWTCB;/* JOB STEP TCB POINTS TO ITSELF    00479000
*                                      (ONLY INDICATOR OF A JOB STEP    00480000
*                                      TASK)                         */ 00481000
         ST    R5NEWTCB,TCBJSTCB(,R5NEWTCB)                        0263 00482000
*       R5NEWTCB->TCBECBNV='1'B;    /* IF THERE IS AN END OF TASK  0264 00483000
*                                      ECB, IT NEED NOT BE VALIDITY     00484000
*                                      CHECKED BY DETACH             */ 00485000
         OI    TCBECBNV(R5NEWTCB),B'00000100'                      0264 00486000
*     END;                          /* END00039                      */ 00487000
*/* %FL01200: D (NO,%FL01210,YES,) WAS SM=SUPV SPECIFIED ?           */ 00488000
*                                                                  0266 00489000
*   IF ATMODE='1'B THEN                                            0266 00490000
*                                                                  0266 00491000
@RF00261 TM    ATMODE(R3WORKAD),B'00000001'                        0266 00492000
         BNO   @RF00266                                            0266 00493000
*/* P SET TCBFSM = 1                                                 */ 00494000
*                                                                  0267 00495000
*     R5NEWTCB->TCBFSM='1'B;        /* INDICATE SUPERVISOR MODE TASK */ 00496000
         OI    TCBFSM(R5NEWTCB),B'10000000'                        0267 00497000
*/* %FL01210: D (NO,%FL01220,YES,) WAS KEY=PROP SPECIFIED ?          */ 00498000
*                                                                  0268 00499000
*   IF ATKEY='0'B THEN              /* IF KEY=PROP, THEN             */ 00500000
@RF00266 TM    ATKEY(R3WORKAD),B'00010000'                         0268 00501000
         BNZ   @RF00268                                            0268 00502000
*/* P PROPAGATE PROTECT KEY FIELD TCBPKF                             */ 00503000
*                                                                  0269 00504000
*     R5NEWTCB->TCBPKF=R4CURTCB->TCBPKF;/* PROPAGATE PROTECT KEY TO     00505000
*                                      NEW TCB                       */ 00506000
         MVC   TCBPKF(1,R5NEWTCB),TCBPKF(R4CURTCB)                 0269 00507000
*/* %FL01220: D (NO,%FL01230,YES,) WAS DISP=NO SPECIFIED ?           */ 00508000
*                                                                  0270 00509000
*   IF ATDISP='1'B THEN                                            0270 00510000
*                                                                  0270 00511000
@RF00268 TM    ATDISP(R3WORKAD),B'10000000'                        0270 00512000
         BNO   @RF00270                                            0270 00513000
*/* P SET TCBANDSP = 1                                               */ 00514000
*                                                                  0271 00515000
*     R5NEWTCB->TCBANDSP='1'B;      /* SET SPECIAL PRIMARY NON-DIS-     00516000
*                                      PATCHABILITY FLAG ON          */ 00517000
         OI    TCBANDSP(R5NEWTCB),B'00010000'                      0271 00518000
*/* %FL01230: D (NO,%FL01240,YES,) IS TCBTCP = 0 IN  CURRENT TCB ?   */ 00519000
*                                                                  0272 00520000
*   IF R4CURTCB->TCBTCP='0'B THEN                                  0272 00521000
*                                                                  0272 00522000
@RF00270 TM    TCBTCP(R4CURTCB),B'00000100'                        0272 00523000
         BNZ   @RF00272                                            0272 00524000
*/* P (,%FL01250) PROPAGATE FLAG BYTE TCBABF FROM WORD TCBTRN        */ 00525000
*                                                                  0273 00526000
*     R5NEWTCB->TCBABF=R4CURTCB->TCBABF;/* PROPAGATE 1 BYTE          */ 00527000
*                                                                  0273 00528000
         MVC   TCBABF(1,R5NEWTCB),TCBABF(R4CURTCB)                 0273 00529000
*   /*****************************************************************/ 00530000
*   /*                                                               */ 00531000
*   /* LOW ORDER THREE BYTES OF TCBTRN USED BY TSO TEST COMMAND      */ 00532000
*   /*                                                               */ 00533000
*   /*****************************************************************/ 00534000
*                                                                  0274 00535000
*/* %FL01240: P PROPAGATE WORD TCBTRN                                */ 00536000
*                                                                  0274 00537000
*   ELSE                                                           0274 00538000
*     R5NEWTCB->TCBTRN=R4CURTCB->TCBTRN;/* PROPAGATE 1 WORD          */ 00539000
         B     @RC00272                                            0274 00540000
@RF00272 MVC   TCBTRN(4,R5NEWTCB),TCBTRN(R4CURTCB)                 0274 00541000
*/* %FL01250: P SET TCBECB TO ATTACH PARM ECB=ADDR (MAY BE 0)        */ 00542000
*                                                                  0275 00543000
*   R5NEWTCB->TCBECB=ATECBADB;      /* ECB PARM                      */ 00544000
@RC00272 SLR   @08,@08                                             0275 00545000
         ICM   @08,7,ATECBADB(R3WORKAD)                            0275 00546000
         ST    @08,TCBECB(,R5NEWTCB)                               0275 00547000
*/* P SET TCBTID TO ATTACH PARM VALUE (MAY BE 0)                     */ 00548000
*                                                                  0276 00549000
*   R5NEWTCB->TCBTID=ATTID;         /* SET TASK ID                   */ 00550000
         MVC   TCBTID(1,R5NEWTCB),ATTID(R3WORKAD)                  0276 00551000
*/* D (NO,%FL01260,YES,) WAS TASKLIB SPECIFIED AND NOT ZERO?         */ 00552000
*                                                                  0277 00553000
*   IF ATTSKLB='1'B&ATTASKLB^=0 THEN/*                       @YA01016*/ 00554000
         TM    ATTSKLB(R3WORKAD),B'00000010'                       0277 00555000
         BNO   @RF00277                                            0277 00556000
         L     @08,ATTASKLB(,R3WORKAD)                             0277 00557000
         LTR   @08,@08                                             0277 00558000
         BZ    @RF00277                                            0277 00559000
*/* P RESET TCBJLB TO PARM SPECIFIED                                 */ 00560000
*                                                                  0278 00561000
*     R5NEWTCB->TCBJLB=ATTASKLB;    /* JOBLIB PTR = TASKLIB PARM     */ 00562000
         ST    @08,TCBJLB(,R5NEWTCB)                               0278 00563000
*/* %FL01260: D (NO,%FL01270,YES,) WAS JSCB SPECIFIED ?              */ 00564000
*                                                                  0279 00565000
*   IF ATJSCB='1'B THEN                                            0279 00566000
*                                                                  0279 00567000
@RF00277 TM    ATJSCB(R3WORKAD),B'01000000'                        0279 00568000
         BNO   @RF00279                                            0279 00569000
*/* P RESET TCBJSCB TO PARM SPECIFIED                                */ 00570000
*                                                                  0280 00571000
*     R5NEWTCB->TCBJSCB=ATJSCBA;    /* JSCB PTR = JSCB PARM          */ 00572000
         SLR   @08,@08                                             0280 00573000
         ICM   @08,7,ATJSCBA(R3WORKAD)                             0280 00574000
         ST    @08,TCBJSCB(,R5NEWTCB)                              0280 00575000
*/* %FL01270: S LOCK: OBTAIN LOCAL LOCK                              */ 00576000
*                                                                  0281 00577000
*   RFY                                                            0281 00578000
*     R15RETCD RSTD;                                               0281 00579000
@RF00279 DS    0H                                                  0282 00580000
*   CALL LOCK;                      /* GET LOCAL LOCK (ALTERS REGS 0282 00581000
*                                      0,1,11,13,15)                 */ 00582000
         BAL   @14,LOCK                                            0282 00583000
*/* D (YES,AT001000,NO,) ANY ERRORS ?                                */ 00584000
*                                                                  0283 00585000
*   IF R15RETCD^=X00NOERR THEN                                     0283 00586000
         LTR   R15RETCD,R15RETCD                                   0283 00587000
         BNZ   @RT00283                                            0283 00588000
*     GOTO AT001000;                /* GO CLEAN UP ON ERROR          */ 00589000
*   RFY                                                            0285 00590000
*     R15RETCD UNRSTD;                                             0285 00591000
*ATFP100:                                                          0286 00592000
*   WKFCODE=FCODE100;               /* TRACE                         */ 00593000
ATFP100  MVI   WKFCODE(R12SVRB),X'64'                              0286 00594000
*                                                                  0287 00595000
*   /*****************************************************************/ 00596000
*   /*                                                               */ 00597000
*   /* SUBROUTINE PRIORITY SETS THE NEW TCB'S LIMIT AND DISPATCHING  */ 00598000
*   /* PRIORITIES.                                                   */ 00599000
*   /*                                                               */ 00600000
*   /*****************************************************************/ 00601000
*                                                                  0287 00602000
*/* S PRIORITY: PROCESS NEW TASK PRIORITY                            */ 00603000
*                                                                  0287 00604000
*   CALL PRIORITY;                  /* SET TCBLMP AND TCBDSP         */ 00605000
*                                                                  0287 00606000
         BAL   @14,PRIORITY                                        0287 00607000
*   /*****************************************************************/ 00608000
*   /*                                                               */ 00609000
*   /* GIVE AND SHARE SUBPOOL PROCESSING                             */ 00610000
*   /*                                                               */ 00611000
*   /*****************************************************************/ 00612000
*                                                                  0288 00613000
*ATFP110:                                                          0288 00614000
*   WKFCODE=FCODE110;               /* TRACE                         */ 00615000
ATFP110  MVI   WKFCODE(R12SVRB),X'6E'                              0288 00616000
*/* %FL01310: D (NO,%FL01320,YES,) GIVE SUBPOOL ?                    */ 00617000
*                                                                  0289 00618000
*   IF ATGSFLDB^=ZERO THEN                                         0289 00619000
         ICM   @08,7,ATGSFLDB(R3WORKAD)                            0289 00620000
         BZ    @RF00289                                            0289 00621000
*     DO;                           /* DO000018                      */ 00622000
*/* P SET GIVE SUBPOOL ENTRY CODE                                    */ 00623000
*                                                                  0291 00624000
*       RFY                                                        0291 00625000
*         R1WORK RSTD;                                             0291 00626000
*       RFY                                                        0292 00627000
*         R15RETCD RSTD;                                           0292 00628000
*       R1WORK=ENTCD0;              /* CALL IS FOR GIVE SP           */ 00629000
         SLR   R1WORK,R1WORK                                       0293 00630000
*/* S SPCONTRL: PROCESS GSPV/GSPL REQUEST                            */ 00631000
*                                                                  0294 00632000
*       CALL SPCONTRL;              /* GIVE SP                       */ 00633000
         BAL   @14,SPCONTRL                                        0294 00634000
*/* D (YES,AT001000,NO,) ANY ERRORS ?                                */ 00635000
*                                                                  0295 00636000
*       IF R15RETCD^=X00NOERR THEN                                 0295 00637000
         LTR   R15RETCD,R15RETCD                                   0295 00638000
         BNZ   @RT00295                                            0295 00639000
*         GOTO AT001000;            /* GO CLEAN UP                   */ 00640000
*     END;                          /* END00018                      */ 00641000
*/* %FL01320: D (NO,%FL01330,YES,) WAS SHSPV OR SHSPL SPECIFIED ?    */ 00642000
*                                                                  0298 00643000
*   IF ATSHFLDB^=ZERO THEN                                         0298 00644000
@RF00289 ICM   @14,7,ATSHFLDB(R3WORKAD)                            0298 00645000
         BZ    @RF00298                                            0298 00646000
*     DO;                           /* DO000019                      */ 00647000
*ATFP120:                                                          0300 00648000
*       WKFCODE=FCODE120;           /* TRACE                         */ 00649000
ATFP120  MVI   WKFCODE(R12SVRB),X'78'                              0300 00650000
*/* P SET SHARE SUBPOOL ENTRY CODE                                   */ 00651000
*                                                                  0301 00652000
*       R1WORK=ENTCD1;              /* CALL IS FOR SHARE SP          */ 00653000
         LA    R1WORK,1                                            0301 00654000
*/* S SPCONTRL: PROCESS SHARE REQUEST                                */ 00655000
*                                                                  0302 00656000
*       CALL SPCONTRL;              /* SHARE SP                      */ 00657000
         BAL   @14,SPCONTRL                                        0302 00658000
*/* D (YES,AT001000,NO,) ANY ERRORS ?                                */ 00659000
*                                                                  0303 00660000
*       IF R15RETCD^=X00NOERR THEN                                 0303 00661000
         LTR   R15RETCD,R15RETCD                                   0303 00662000
         BNZ   @RT00303                                            0303 00663000
*         GOTO AT001000;            /* GO CLEAN UP                   */ 00664000
*     END;                          /* END00019                      */ 00665000
*ATFP130:                                                          0306 00666000
*   WKFCODE=FCODE130;               /* TRACE                         */ 00667000
@RF00298 DS    0H                                                  0306 00668000
ATFP130  MVI   WKFCODE(R12SVRB),X'82'                              0306 00669000
*/* %FL01330: D (NO,%FL01340,YES,) WAS SZERO=YES SPECIFIED?          */ 00670000
*                                                                  0307 00671000
*   IF ATSZERO='0'B THEN                                           0307 00672000
         TM    ATSZERO(R3WORKAD),B'00001000'                       0307 00673000
         BNZ   @RF00307                                            0307 00674000
*     DO;                           /* DO000020                      */ 00675000
*/* P SET SHARE ZERO ENTRY CODE                                      */ 00676000
*                                                                  0309 00677000
*       R1WORK=ENTCD2;              /* SHARE 0 (THE DEFAULT)         */ 00678000
         LA    R1WORK,2                                            0309 00679000
*/* S SPCONTRL: SHARE SUBPOOL ZERO                                   */ 00680000
*                                                                  0310 00681000
*       CALL SPCONTRL;              /* SHARE 0                       */ 00682000
         BAL   @14,SPCONTRL                                        0310 00683000
*/* D (YES,AT001000,NO,) ANY ERRORS ?                                */ 00684000
*                                                                  0311 00685000
*       IF R15RETCD^=X00NOERR THEN                                 0311 00686000
         LTR   R15RETCD,R15RETCD                                   0311 00687000
         BNZ   @RT00311                                            0311 00688000
*         GOTO AT001000;            /* GO CLEAN UP                   */ 00689000
*     END;                          /* END00020                      */ 00690000
*   RFY                                                            0314 00691000
*     R1WORK UNRSTD;                                               0314 00692000
@RF00307 DS    0H                                                  0315 00693000
*   RFY                                                            0315 00694000
*     R15RETCD UNRSTD;                                             0315 00695000
*                                                                  0316 00696000
*   /*****************************************************************/ 00697000
*   /*                                                               */ 00698000
*   /* SPECIAL SHARE SUBPOOL PROCESSING FOR SWA : SUBPOOLS 236, 237  */ 00699000
*   /*                                                               */ 00700000
*   /*****************************************************************/ 00701000
*                                                                  0316 00702000
*/* %FL01340: S SWARTN: PROCESS SWA, SP 236 AND 237                  */ 00703000
*                                                                  0316 00704000
*   RFY                                                            0316 00705000
*     R15RETCD RSTD;                                               0316 00706000
*   CALL SWARTN;                    /* SUBRTN HANDLES 236, 237 SHARE */ 00707000
         BAL   @14,SWARTN                                          0317 00708000
*/* D (YES,AT001000,NO,) ANY ERRORS ?                                */ 00709000
*                                                                  0318 00710000
*   IF R15RETCD^=X00NOERR THEN                                     0318 00711000
         LTR   R15RETCD,R15RETCD                                   0318 00712000
         BNZ   @RT00318                                            0318 00713000
*     GOTO AT001000;                /* GO CLEAN UP                   */ 00714000
*   RFY                                                            0320 00715000
*     R15RETCD UNRSTD;                                             0320 00716000
*ATFP140:                                                          0321 00717000
*   WKFCODE=FCODE140;               /* TRACE                         */ 00718000
*                                                                  0321 00719000
ATFP140  MVI   WKFCODE(R12SVRB),X'8C'                              0321 00720000
*   /*****************************************************************/ 00721000
*   /*                                                               */ 00722000
*   /* CHAIN SPQES TO CURRENT TCB                                    */ 00723000
*   /*                                                               */ 00724000
*   /*****************************************************************/ 00725000
*                                                                  0322 00726000
*/* D (NO,%FL01440,YES,) ANY SPQES FOR CURRENT TCB ?                 */ 00727000
*                                                                  0322 00728000
*   IF WKTCBMSS^=ZERO THEN          /*                       @Z30ENVB*/ 00729000
         SLR   @08,@08                                             0322 00730000
         L     @07,WKTCBMSS(,R12SVRB)                              0322 00731000
         CR    @07,@08                                             0322 00732000
         BE    @RF00322                                            0322 00733000
*     DO;                           /* DO000028                      */ 00734000
*/* P CHAIN SPQES TO CURRENT TCB                                     */ 00735000
*                                                                  0324 00736000
*       RFY                                                        0324 00737000
*         R8WORK RSTD;                                             0324 00738000
*       R8WORK=WKTCBMSS;            /* GET DUMMY TCBMSS QUEUE PTR  0325 00739000
*                                                            @Z30ENVB*/ 00740000
         LR    R8WORK,@07                                          0325 00741000
*       WKTCBMSS=ZERO;              /* CLEAR WORKAREA'S DUMMY TCBMSS    00742000
*                                      QUEUE PTR             @Z30ENVB*/ 00743000
         SLR   @07,@07                                             0326 00744000
         ST    @07,WKTCBMSS(,R12SVRB)                              0326 00745000
*       IF R4CURTCB->TCBMSSB=ZERO THEN/* IS CURRENT TCB'S TCBMSS   0327 00746000
*                                      QUEUE EMPTY ?         @Z30ENVB*/ 00747000
         ICM   @07,7,TCBMSSB(R4CURTCB)                             0327 00748000
         BNZ   @RF00327                                            0327 00749000
*         WKSPQE1->LASTSPQE='1'B;   /* YES - SET END OF QUEUE BIT  0328 00750000
*                                                            @Z30ENVB*/ 00751000
         L     @07,WKSPQE1(,R3WORKAD)                              0328 00752000
         OI    LASTSPQE(@07),B'01000000'                           0328 00753000
*       ELSE                        /* NO                    @Z30ENVB*/ 00754000
*         WKSPQE1->SPQEPTR=R4CURTCB->TCBMSSB;/* CHAIN CURRENT TCB'S     00755000
*                                      SPQES TO END OF DUMMY TCBMSS     00756000
*                                      QUEUE                 @Z30ENVB*/ 00757000
         B     @RC00327                                            0329 00758000
@RF00327 L     @07,WKSPQE1(,R3WORKAD)                              0329 00759000
         SLR   @02,@02                                             0329 00760000
         ICM   @02,7,TCBMSSB(R4CURTCB)                             0329 00761000
         ST    @02,SPQEPTR(,@07)                                   0329 00762000
*       R4CURTCB->TCBMSSB=R8WORK;   /* CHAIN SPQES TO CURRENT TCB  0330 00763000
*                                                            @Z30ENVB*/ 00764000
@RC00327 STCM  R8WORK,7,TCBMSSB(R4CURTCB)                          0330 00765000
*       RFY                                                        0331 00766000
*         R8WORK UNRSTD;                                           0331 00767000
*     END;                          /* END00028                      */ 00768000
*/* %FL01440: P SET NEW TCB'S TCBRBP TO ADDR NEW SVRB                */ 00769000
*                                                                  0333 00770000
*   RFY                                                            0333 00771000
*     R1AREA RSTD;                                                 0333 00772000
@RF00322 DS    0H                                                  0334 00773000
*   R1AREA=R3WORKAD;                /* TOP OF SVRB (PREFIX)          */ 00774000
         LR    R1AREA,R3WORKAD                                     0334 00775000
*   GENERATE REFS(RBPRFXND,RBPRFXST) NOFLOWS;                      0335 00776000
         SPACE                                                          00777000
         LA    R3WORKAD,RBPRFXND-RBPRFXST(,R3WORKAD)                    00778000
         SPACE                                                          00779000
*   R5NEWTCB->TCBRBP=R3WORKAD;      /* NEW TCB'S RB PTR              */ 00780000
         ST    R3WORKAD,TCBRBP(,R5NEWTCB)                          0336 00781000
*/* P CLEAR WORKAREA IN SVRB TO ZERO                                 */ 00782000
*                                                                  0337 00783000
*   RFY                                                            0337 00784000
*     R7WORK RSTD;                                                 0337 00785000
*   R7WORK=ADDR(SVRBLEN);           /* LENGTH OF SVRB                */ 00786000
         LA    R7WORK,SVRBLEN                                      0338 00787000
*   AREA(1:R7WORK)=AREA(1:R7WORK)&&AREA(1:R7WORK);/* CLEAR SVRB      */ 00788000
         LR    @08,R7WORK                                          0339 00789000
         BCTR  @08,0                                               0339 00790000
         EX    @08,@SX03144                                        0339 00791000
*   RFY                                                            0340 00792000
*     R1AREA UNRSTD;                                               0340 00793000
*   RFY                                                            0341 00794000
*     R7WORK UNRSTD;                                               0341 00795000
*                                                                  0342 00796000
*   /*****************************************************************/ 00797000
*   /*                                                               */ 00798000
*   /* SVRB STORAGE, USED AS A WORK AREA UP TO THIS POINT, IS        */ 00799000
*   /* INITIALIZED AS AN SVRB BY ATTACH,AND IS USED BY ATTACH REENTRY*/ 00800000
*   /* AND LINK RUNNING UNDER THE NEW TCB. THE PSW IS SET SO THAT    */ 00801000
*   /* ATTACH GAINS CONTROL AT ENTRY POINT IGC042R1 WHEN THE NEW TASK*/ 00802000
*   /* IS DISPATCHED.                                                */ 00803000
*   /*                                                               */ 00804000
*   /*****************************************************************/ 00805000
*                                                                  0342 00806000
*/* P SET RBLINK = ADDR NEW TCB                                      */ 00807000
*                                                                  0342 00808000
*   RFY                                                            0342 00809000
*     RBSECT BASED(R3WORKAD);                                      0342 00810000
*   RFY                                                            0343 00811000
*     RBBASIC BASED(R3WORKAD);                                     0343 00812000
*   RBLINKB=R5NEWTCB;               /* FIRST RB POINTS TO TCB        */ 00813000
         STCM  R5NEWTCB,7,RBLINKB(R3WORKAD)                        0344 00814000
*/* P SET RBSIZE                                                     */ 00815000
*                                                                  0345 00816000
*   GENERATE REFS(RBSIZE) NOFLOWS;                                 0345 00817000
*                                                                  0345 00818000
         SPACE                                                          00819000
         MVI   RBSIZE+X1(R3WORKAD),SVRBDWDS SIZE OF SVRB IN DOUBLEWORDS 00820000
         SPACE                                                          00821000
*/* P SET SVRB INDICATOR BITS IN RBSTAB                              */ 00822000
*                                                                  0346 00823000
*   RBFTP='110'B;                   /* THIS IS AN SVRB               */ 00824000
         NI    RBFTP(R3WORKAD),B'11011111'                         0346 00825000
         OI    RBFTP(R3WORKAD),B'11000000'                         0346 00826000
*/* P SET RBTCBNXT=1, RBATTN=1, RBFDYN=1, RBNOCELL=1                 */ 00827000
*                                                                  0347 00828000
*   RBTCBNXT='1'B;                  /* THIS IS FIRST RB              */ 00829000
         OI    RBTCBNXT(R3WORKAD),B'10000000'                      0347 00830000
*   RBATTN='1'B;                    /* NO ATTENTIONS ALLOWED, SVC    */ 00831000
         OI    RBATTN(R3WORKAD),B'00100000'                        0348 00832000
*   RBFDYN='1'B;                    /* RB SHOULD BE FREED AT EXIT  0349 00833000
*                                                            @YM03499*/ 00834000
         OI    RBFDYN(R3WORKAD),B'00000010'                        0349 00835000
*   RBNOCELL='1'B;                  /* RB SHOULD BE FREEMAINED, NOT     00836000
*                                      FREECELLED            @YM03499*/ 00837000
         OI    RBNOCELL(R3WORKAD),B'10000000'                      0350 00838000
*/* P SET RBOPSW TO REENTER AT IGC042R1 WHEN NEW TASK DISPATCHED     */ 00839000
*                                                                  0351 00840000
*   RBOPSW=NEWPSW;                  /* SET EC MODE, ENABLED PSW      */ 00841000
         MVC   RBOPSW(8,R3WORKAD),NEWPSW                           0351 00842000
*/* P STORE REGISTERS INTO RBGRSAVE                                  */ 00843000
*                                                                  0352 00844000
*   RBGRSAVE=R4CURTCB->TCBRBP->RBGRSAVE;/* REGISTERS FOR ATTACHED  0352 00845000
*                                      PROGRAM               @YM00058*/ 00846000
         L     @08,TCBRBP(,R4CURTCB)                               0352 00847000
         MVC   RBGRSAVE(64,R3WORKAD),RBGRSAVE(@08)                 0352 00848000
*/* P ESTABLISH RBEXSAVE FOR LINK                                    */ 00849000
*                                                                  0353 00850000
*   RBEXSAVE=WKEXSAVE;              /* PASS TO REENTRY RTN           */ 00851000
         MVC   RBEXSAVE(48,R3WORKAD),WKEXSAVE(R12SVRB)             0353 00852000
*/* P ESTABLISH REGISTERS FOR REENTRY ROUTINE                        */ 00853000
*                                                                  0354 00854000
*   R5NEWTCB->TCBGRS3=R3WORKAD;     /* FOR REENTRY ROUTINE           */ 00855000
         ST    R3WORKAD,TCBGRS3(,R5NEWTCB)                         0354 00856000
*   R5NEWTCB->TCBGRS4=R5NEWTCB;     /* NEW TCB WILL BE CURRENT TCB 0355 00857000
*                                      WHEN REENTRY RTN IS DISPATCHED*/ 00858000
         ST    R5NEWTCB,TCBGRS4(,R5NEWTCB)                         0355 00859000
*   R5NEWTCB->TCBGRS5=ADDR(RBSECT); /* SVRB BECOMES CURRENT RB IN  0356 00860000
*                                      REENTRY ROUTINE               */ 00861000
         ST    R3WORKAD,TCBGRS5(,R5NEWTCB)                         0356 00862000
*   R5NEWTCB->TCBGRS6=R6BASE;       /* ADDRESSABILITY FOR REENTRY RTN*/ 00863000
         ST    R6BASE,TCBGRS6(,R5NEWTCB)                           0357 00864000
*   R5NEWTCB->TCBGRS9=R9BASE;       /* ADDRESSABILITY FOR REENTRY RTN*/ 00865000
         ST    R9BASE,TCBGRS9(,R5NEWTCB)                           0358 00866000
*   R5NEWTCB->TCBGRS10=WKGRS10;     /* ADDR OF DE OR ENTRY POINT     */ 00867000
         MVC   TCBGRS10(4,R5NEWTCB),WKGRS10(R12SVRB)               0359 00868000
*   R5NEWTCB->TCBGRS11=WKGRS11;     /* DCB ADDR OR 0                 */ 00869000
         MVC   TCBGRS11(4,R5NEWTCB),WKGRS11(R12SVRB)               0360 00870000
*   R5NEWTCB->TCBGRS12=ADDR(RBEXSAVE);/* ADDRESSABILITY FOR WKEXSAVE    00871000
*                                      (NOW IN NEW SVRB RBEXSAVE)    */ 00872000
*                                                                  0361 00873000
         LA    @08,RBEXSAVE(,R3WORKAD)                             0361 00874000
         ST    @08,TCBGRS12(,R5NEWTCB)                             0361 00875000
*   /*****************************************************************/ 00876000
*   /*                                                               */ 00877000
*   /* SUBROUTINE CHAIN PLACES NEW TCB ONTO READY QUEUE, PLACES NEW  */ 00878000
*   /* TCB ONTO FAMILY QUEUE, AND UPDATES TCB COUNTS IN ASCB, ASXB.  */ 00879000
*   /*                                                               */ 00880000
*   /*****************************************************************/ 00881000
*                                                                  0362 00882000
*ATFP150:                                                          0362 00883000
*   WKFCODE=FCODE150;               /* TRACE                         */ 00884000
ATFP150  MVI   WKFCODE(R12SVRB),X'96'                              0362 00885000
*/* S CHAIN: CHAIN NEW TCB ON DISPATCHING, FAMILY QUEUES             */ 00886000
*                                                                  0363 00887000
*   RFY                                                            0363 00888000
*     R15RETCD RSTD;                                               0363 00889000
*   CALL CHAIN;                     /* CHAIN NEW TCB                 */ 00890000
*                                                                  0364 00891000
         BAL   @14,CHAIN                                           0364 00892000
*   /*****************************************************************/ 00893000
*   /*                                                               */ 00894000
*   /* RETURN TO CALLER                                              */ 00895000
*   /*                                                               */ 00896000
*   /*****************************************************************/ 00897000
*                                                                  0365 00898000
*/* S UNLOCK: RELEASE LOCAL LOCK                                     */ 00899000
*                                                                  0365 00900000
*   CALL UNLOCK;                    /* RELEASE LOCK AND CANCEL FRR 0365 00901000
*                                      (ALTERS REGS 0,1,11,13,15)    */ 00902000
         BAL   @14,UNLOCK                                          0365 00903000
*/* AT001730: L FESTAE: CANCEL ESTAE EXIT                            */ 00904000
*                                                                  0366 00905000
*AT001730:                                                         0366 00906000
*   GEN(FESTAE 0,WRKREG=(R1WORK));  /* CANCEL ESTAE          @Z40FPYB*/ 00907000
AT001730 FESTAE 0,WRKREG=(R1WORK)                                       00908000
*/* P SET RETURN CODE = 0 FOR NORMAL EXIT                            */ 00909000
*                                                                  0367 00910000
*   R15RETCD=X00NOERR;              /* SET RETURN CODE = 0           */ 00911000
         SLR   R15RETCD,R15RETCD                                   0367 00912000
*/* P SET ADDRESS OF NEW TCB INTO REG 1 FOR RETURN TO CALLER         */ 00913000
*                                                                  0368 00914000
*   RFY                                                            0368 00915000
*     R1WORK RSTD;                                                 0368 00916000
*   R1WORK=R5NEWTCB;                /* RETURN NEW TCB ADDR IN REG 1  */ 00917000
         LR    R1WORK,R5NEWTCB                                     0369 00918000
*/* AT001710: P RESTORE REGS 0 AND 14                                */ 00919000
*                                                                  0370 00920000
*   RFY                                                            0370 00921000
*     R0WORK RSTD;                                                 0370 00922000
*   RFY                                                            0371 00923000
*     R14RET RSTD;                                                 0371 00924000
*AT001710:                                                         0372 00925000
*   R5CURRB=R4CURTCB->TCBRBP;       /* CURRENT RB ADDRESS            */ 00926000
AT001710 L     R5CURRB,TCBRBP(,R4CURTCB)                           0372 00927000
*   R0WORK=R5CURRB->RBGRS0;         /* RESTORE REG 0 FOR CALLER      */ 00928000
         L     R0WORK,RBGRS0(,R5CURRB)                             0373 00929000
*   R14RET=CVTEXPRO;                /* RESTORE REG 14 RETURN ADDRESS */ 00930000
*                                                                  0374 00931000
         L     @08,CVTPTR                                          0374 00932000
         L     R14RET,CVTEXPRO(,@08)                               0374 00933000
*   /*****************************************************************/ 00934000
*   /*                                                               */ 00935000
*   /* EXIT PROLOGUE RETURNS REGS 0,1, AND 15, AS RECEIVED FROM      */ 00936000
*   /* ATTACH, TO THE CALLER OF ATTACH                               */ 00937000
*   /*                                                               */ 00938000
*   /*****************************************************************/ 00939000
*                                                                  0375 00940000
*/* R RETURN TO CALLER VIA EXIT PROLOGUE                             */ 00941000
*                                                                  0375 00942000
*   GOTO R14RET;                    /* RETURN TO CALLER              */ 00943000
         BR    R14RET                                              0375 00944000
*   RFY                                                            0376 00945000
*     R0WORK UNRSTD;                                               0376 00946000
*   RFY                                                            0377 00947000
*     R14RET UNRSTD;                                               0377 00948000
*   RFY                                                            0378 00949000
*     R15RETCD UNRSTD;                                             0378 00950000
*                                                                  0379 00951000
*   /*****************************************************************/ 00952000
*   /*                                                               */ 00953000
*   /* ERROR PROCESSING                                              */ 00954000
*   /*                                                               */ 00955000
*   /*****************************************************************/ 00956000
*                                                                  0379 00957000
*/*  AT001000: S RTN1: PERFORM CLEAN UP                              */ 00958000
*                                                                  0379 00959000
*AT001000:                                                         0379 00960000
*   RFY                                                            0379 00961000
*     R7WORK RSTD;                                                 0379 00962000
AT001000 DS    0H                                                  0380 00963000
*   RFY                                                            0380 00964000
*     R15RETCD RSTD;                                               0380 00965000
*   R7WORK=R4CURTCB->TCBRBP;        /* ADDRESS OF CURRENT SVRB       */ 00966000
         L     R7WORK,TCBRBP(,R4CURTCB)                            0381 00967000
*   R7WORK->RBGRS15=R15RETCD;       /* SAVE ERROR CODE               */ 00968000
         ST    R15RETCD,RBGRS15(,R7WORK)                           0382 00969000
*   CALL RTN1;                      /* GO TO CLEAN UP ROUTINE        */ 00970000
         BAL   @14,RTN1                                            0383 00971000
*/* L FESTAE: CANCEL ESTAE EXIT                                      */ 00972000
*                                                                  0384 00973000
*   GEN(FESTAE 0,WRKREG=(R7WORK));  /* CANCEL ESTAE          @Z40FPYB*/ 00974000
         FESTAE 0,WRKREG=(R7WORK)                                       00975000
*   R7WORK=R4CURTCB->TCBRBP;        /* ADDRESS OF CURRENT SVRB       */ 00976000
         L     R7WORK,TCBRBP(,R4CURTCB)                            0385 00977000
*   R15RETCD=R7WORK->RBGRS15;       /* RESTORE ERROR CODE            */ 00978000
         L     R15RETCD,RBGRS15(,R7WORK)                           0386 00979000
*   RFY                                                            0387 00980000
*     R7WORK UNRSTD;                                               0387 00981000
*                                                                  0387 00982000
*/* D (NO,%FL01460,YES,) IS AN ABEND ERROR INDICATED ?               */ 00983000
*                                                                  0388 00984000
*   IF R15RETCD>=ABEND12A THEN                                     0388 00985000
         CH    R15RETCD,@CH02700                                   0388 00986000
         BL    @RF00388                                            0388 00987000
*     DO;                           /* DO000030                      */ 00988000
*/* L () ABEND: TERMINATE CURRENT TASK                               */ 00989000
*                                                                  0390 00990000
*       R1WORK=R15RETCD;            /* ABEND CODE                    */ 00991000
         LR    R1WORK,R15RETCD                                     0390 00992000
*       R15RETCD=WKREASON;          /* REASON CODE OR ZERO           */ 00993000
         SLR   R15RETCD,R15RETCD                                   0391 00994000
         IC    R15RETCD,WKREASON(,R12SVRB)                         0391 00995000
*       GENERATE EXIT NOSEQFLOW;                                   0392 00996000
         SPACE                                                          00997000
         ABEND (1),DUMP,,SYSTEM        ISSUE ABEND                      00998000
         SPACE                                                          00999000
*     END;                          /* END00030: END ABEND PROCESSING*/ 01000000
*/* %FL01460: P (,AT001710) SET REG 1 = 0, NO NEW TCB                */ 01001000
*                                                                  0394 01002000
*   R1WORK=ZERO;                    /* CLEAR REG 1, NO NEW TCB       */ 01003000
@RF00388 SLR   R1WORK,R1WORK                                       0394 01004000
*   GOTO AT001710;                  /* GO EXIT FROM ATTACH, WITH   0395 01005000
*                                      RETURN CODE AS ALREADY SET    */ 01006000
         B     AT001710                                            0395 01007000
*   RFY                                                            0396 01008000
*     R1WORK UNRSTD;                                               0396 01009000
*   RFY                                                            0397 01010000
*     R15RETCD UNRSTD;                                             0397 01011000
*                                                                  0397 01012000
*/* ATTACH: END FLOWCHART FOR IGC0004B - SVC ATTACH - MAINLINE       */ 01013000
*                                                                  0398 01014000
*IGC042R1:                                                         0398 01015000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);                          0398 01016000
*                                                                  0398 01017000
IGC042R1 DS    0H                                                  0399 01018000
*/* IGC042R1: CHART FOR ATTACH REENTRY ROUTINE                       */ 01019000
*/* FOOTING                                                        0399 01020000
*/* REENTRY ROUTINE                                                  */ 01021000
*/********************************************************************/ 01022000
*/*                                                                  */ 01023000
*/*    THIS ROUTINE IS THE FIRST CODE EXECUTED UNDER THE NEW TASK.   */ 01024000
*/*    IF SVAREA=YES WAS SPECIFIED, A PROBLEM PROGRAM SAVE AREA IS   */ 01025000
*/*    OBTAINED, FROM SUBPOOL 250, AND CHAINED OFF TCBFSA. THE SVRB  */ 01026000
*/*    AND REGISTERS ARE SET UP FOR LINK, AND THE LINK SERVICE       */ 01027000
*/*    ROUTINE IS ENTERED AT BRANCH ENTRY POINT IEAQCS01. CONTROL IS */ 01028000
*/*    NOT RETURNED TO ATTACH.                                       */ 01029000
*/*                                                                  */ 01030000
*/*    REGISTER USAGE - REGISTERS UPON ENTRY ARE AS IN THE SVRB'S    */ 01031000
*/*                     RBGRSAVE FIELD, AS SET IN ATTACH MAINLINE:   */ 01032000
*/*                                                                  */ 01033000
*/*    R0WORK   - OUTPUT, ADDRESS OF ENTRY POINT NAME, OR            */ 01034000
*/*               COMPLEMENTED ADDRESS OF DE.                        */ 01035000
*/*    R1AREA   - OUTPUT, ADDRESS OF DCB AS SPECIFIED ON ATTACH      */ 01036000
*/*               MACRO, OR ZERO                                     */ 01037000
*/*    R3WORKAD - INPUT, ADDRESS OF NEW (CURRENT) SVRB               */ 01038000
*/*             - OUTPUT, ADDRESS OF CVT (INPUT CONTENTS SWITCHES)   */ 01039000
*/*    R4CURTCB - ADDRESS OF THE NEW TCB, NOW THE CURRENT TCB        */ 01040000
*/*    R5CURRB  - ADDRESS OF THE NEW SVRB, NOW THE CURRENT RB        */ 01041000
*/*    R6BASE   - ADDRESS OF IGC0004B, ENTRY POINT TO SVC ATTACH     */ 01042000
*/*             - OUTPUT, ADDRESS OF IEAQCS01, LINK BRANCH ENTRY     */ 01043000
*/*    R9BASE   - INPUT, R6BASE + 4096                               */ 01044000
*/*    R10WORK  - INPUT, SAME AS R0WORK OUTPUT                       */ 01045000
*/*    R11WORK  - INPUT, SAME AS R1AREA OUTPUT                       */ 01046000
*/*    R12SVRB  - INPUT, ADDRESS OF RBEXSAVE                         */ 01047000
*/*                                                                  */ 01048000
*/********************************************************************/ 01049000
*/* IGC042R1: E REENTRY FROM DISPATCHER                              */ 01050000
*                                                                  0399 01051000
*   RFY                                                            0399 01052000
*     R10WORK RSTD;                                                0399 01053000
*   RFY                                                            0400 01054000
*     R11WORK RSTD;                                                0400 01055000
*                                                                  0400 01056000
*/* D (NO,%FL01500,YES,) WAS SVAREA=YES SPECIFIED ?                  */ 01057000
*                                                                  0401 01058000
*   IF WKSVAREA='0'B THEN                                          0401 01059000
         TM    WKSVAREA(R12SVRB),B'10000000'                       0401 01060000
         BNZ   @RF00401                                            0401 01061000
*     DO;                           /* DO000040                      */ 01062000
*       RFY                                                        0403 01063000
*         R1AREA RSTD;                                             0403 01064000
*       RFY                                                        0404 01065000
*         R0WORK RSTD;                                             0404 01066000
*       GENERATE SETS(R0WORK,R1AREA) NOFLOWS;                      0405 01067000
         SPACE                                                          01068000
*/* L (,%FL01510) GETMAIN: OBTAIN PROBLEM PGM SAVE AREA, SP 250      */ 01069000
         SPACE                                                          01070000
         GETMAIN R,LV=SALENGTH,SP=SP250EQU OBTAIN SAVE AREA             01071000
         USING TCB,R4CURTCB ADDRESSABILITY FOR TCB KEY         @ZA30792 01072000
         MODESET  EXTKEY=TCB,WORKREG=2 GET IN SAME KEY AS TCB  @ZA30792 01073000
         XC   C0(SALENGTH,R1AREA),C0(R1AREA)    CLEAR AREA     @ZA25845 01074000
         MODESET  EXTKEY=ZERO,WORKREG=2 RETURN TO KEY ZERO     @ZA30792 01075000
         DROP R4CURTCB          DROP ADDRESSIBILITY            @ZA30792 01076000
*     END;                          /* END00040                      */ 01077000
*/* %FL01500: P SET REG 1 = 0, NO PP SAVE AREA                       */ 01078000
*                                                                  0407 01079000
*   ELSE                                                           0407 01080000
*     R1AREA=ZERO;                  /* CLEAR POINTER, NO SAVE AREA   */ 01081000
         B     @RC00401                                            0407 01082000
@RF00401 SLR   R1AREA,R1AREA                                       0407 01083000
*/* %FL01510: P SET TCBFSA = REG 1, RBGRS13 = REG 1                  */ 01084000
*                                                                  0408 01085000
*   R4CURTCB->TCBFSAB=R1AREA;       /* SAVE AREA ADDR OR ZERO        */ 01086000
@RC00401 STCM  R1AREA,7,TCBFSAB(R4CURTCB)                          0408 01087000
*   R5CURRB->RBGRS13=R1AREA;        /* SAVE AREA ADDR, OR ZERO       */ 01088000
         ST    R1AREA,RBGRS13(,R5CURRB)                            0409 01089000
*/* P CLEAR RESERVED PORTION OF SVRB EXTENDED SAVE AREA              */ 01090000
*                                                                  0410 01091000
*   R1AREA=ADDR(RBEXSAVE)+LENGTH(WKNEWXSA);/* ADDR RESERVED          */ 01092000
         LA    R1AREA,RBEXSAVE(,R3WORKAD)                          0410 01093000
         AH    R1AREA,@CH02795                                     0410 01094000
*   RFY                                                            0411 01095000
*     R7WORK RSTD;                                                 0411 01096000
*   R7WORK=LENGTH(RBEXSAVE)-LENGTH(WKNEWXSA);/* LENGTH               */ 01097000
         LA    R7WORK,39                                           0412 01098000
*   AREA(1:R7WORK)=AREA(1:R7WORK)&&AREA(1:R7WORK);/* CLEAR           */ 01099000
         LR    @08,R7WORK                                          0413 01100000
         BCTR  @08,0                                               0413 01101000
         EX    @08,@SX03144                                        0413 01102000
*   RFY                                                            0414 01103000
*     R7WORK UNRSTD;                                               0414 01104000
*                                                                  0414 01105000
*/* P ESTABLISH REGISTERS FOR LINK BRANCH ENTRY                      */ 01106000
*                                                                  0415 01107000
*   R0WORK=R10WORK;                 /* ESTABLISH REG 0, ADDRESS OF EP   01108000
*                                      NAME OR COMPLEMENTED ADDRESS     01109000
*                                      OF DE                         */ 01110000
         LR    R0WORK,R10WORK                                      0415 01111000
*   R1AREA=R11WORK;                 /* ESTABLISH REG 1, 0 OR DCB   0416 01112000
*                                      ADDRESS, FROM DCB PARAMETER   */ 01113000
         LR    R1AREA,R11WORK                                      0416 01114000
*   R3WORK=CVTPTR;                  /* ADDRESS OF CVT                */ 01115000
         L     R3WORK,CVTPTR                                       0417 01116000
*   RFY                                                            0418 01117000
*     R7ASCB RSTD;                                                 0418 01118000
*   R7ASCB=PSAAOLD;                 /* ASCB ADDRESS                  */ 01119000
*                                                                  0419 01120000
         L     R7ASCB,PSAAOLD                                      0419 01121000
*   /*****************************************************************/ 01122000
*   /*                                                               */ 01123000
*   /* REGS 4, AND 5 ALREADY PROPERLY SET                            */ 01124000
*   /*                                                               */ 01125000
*   /*****************************************************************/ 01126000
*                                                                  0420 01127000
*   R6BASE=R3WORK->CVTQCS01;        /* LINK BRANCH ENTRY ADDRESS   0420 01128000
*                                      IEAQCS01                      */ 01129000
         L     R6BASE,CVTQCS01(,R3WORK)                            0420 01130000
*/* R BRANCH TO LINK ENTRY POINT IEAQCS01                            */ 01131000
*                                                                  0421 01132000
*   GOTO R6BASE;                    /* PASS CONTROL TO LINK          */ 01133000
         BR    R6BASE                                              0421 01134000
*/* IGC042R1: END FLOWCHART FOR REENTRY ROUTINE                      */ 01135000
*                                                                  0422 01136000
*   RFY                                                            0422 01137000
*     R0WORK UNRSTD;                                               0422 01138000
*   RFY                                                            0423 01139000
*     R1AREA UNRSTD;                                               0423 01140000
*   RFY                                                            0424 01141000
*     R7ASCB UNRSTD;                                               0424 01142000
*   RFY                                                            0425 01143000
*     R10WORK UNRSTD;                                              0425 01144000
*   RFY                                                            0426 01145000
*     R11WORK UNRSTD;                                              0426 01146000
*   END IGC042R1;                   /* END REENTRY ROUTINE           */ 01147000
*   RFY                                                            0428 01148000
*     RBSECT BASED(RBSECPTR);                                      0428 01149000
*   RFY                                                            0429 01150000
*     RBBASIC BASED(RBSECPTR);                                     0429 01151000
*                                                                  0430 01152000
*   /*****************************************************************/ 01153000
*   /*                                                               */ 01154000
*   /* GETCBS SUBROUTINE                                             */ 01155000
*   /*                                                               */ 01156000
*   /*****************************************************************/ 01157000
*                                                                  0430 01158000
*GETCBS:                                                           0430 01159000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);                          0430 01160000
*                                                                  0430 01161000
GETCBS   DS    0H                                                  0431 01162000
*/* GETCBS: CHART (AREF) FLOWCHART SUBROUTINE GETCBS                 */ 01163000
*/* FOOTING                                                        0431 01164000
*/* SUBROUTINE OBTAINS TCB IQE IRB                                   */ 01165000
*/********************************************************************/ 01166000
*/*                                                                  */ 01167000
*/*    THIS SUBROUTINE OBTAINS STORAGE FOR THE NEW TCB,AND ALSO FOR  */ 01168000
*/*    AN IQE, AND AN IRB, IF NECESSARY. THE STORAGE IS CLEARED TO   */ 01169000
*/*    ZERO BEFORE USE. IF ACQUIRED, THE IRB AND IQE ARE INITIALIZED */ 01170000
*/*    AND CHAINED OFF THE NEW TCB.                                  */ 01171000
*/*                                                                  */ 01172000
*/* SUBROUTINES CALLED: UNLOCK                                       */ 01173000
*/*                                                                  */ 01174000
*/* SYSTEM ROUTINES CALLED / MACROS ISSUED:                          */ 01175000
*/*                                 GETMAIN SVC                      */ 01176000
*/*                                 CIRB SVC                         */ 01177000
*/*                                                                  */ 01178000
*/* RETURN CODES SET: X00NOERR, AND THE ERROR CODE FROM UNLOCK       */ 01179000
*/*                                                                  */ 01180000
*/* REGISTER USAGE: R5NEWTCB - OUTPUT, ADDRESS OF THE NEW TCB        */ 01181000
*/*                                                                  */ 01182000
*/********************************************************************/ 01183000
*/* E ENTER GETCBS                                                   */ 01184000
*                                                                  0431 01185000
*   RFY                                                            0431 01186000
*     R14RET RSTD;                                                 0431 01187000
*   WKRTSAVE=R14RET;                /* SAVE AROUND MACROS, UNLOCK    */ 01188000
         ST    R14RET,WKRTSAVE(,R3WORKAD)                          0432 01189000
*   RFY                                                            0433 01190000
*     R14RET UNRSTD;                                               0433 01191000
*                                                                  0433 01192000
*/* D (NO,%FL01060,YES,) WAS ETXR SPECIFIED ?                        */ 01193000
*                                                                  0434 01194000
*   IF ATETXRB^=ZERO THEN           /* IF ETXR ADDR PARM SPECIFIED,  */ 01195000
         ICM   @08,7,ATETXRB(R3WORKAD)                             0434 01196000
         BZ    @RF00434                                            0434 01197000
*     DO;                           /* DO000008: AN IQE AND POSSIBLY    01198000
*                                      IRB NEEDED                    */ 01199000
*                                                                  0435 01200000
*       /*************************************************************/ 01201000
*       /*                                                           */ 01202000
*       /* CHECK FOR A SUBTASK HAVING AN IQE WHICH POINTS TO AN IRB  */ 01203000
*       /* WHICH CAN ALSO BE USED FOR THIS REQUEST.                  */ 01204000
*       /*                                                           */ 01205000
*       /*************************************************************/ 01206000
*                                                                  0436 01207000
*       RFY                                                        0436 01208000
*         R2WORK RSTD;                                             0436 01209000
*       RFY                                                        0437 01210000
*         R7IQE RSTD;                                              0437 01211000
*       RFY                                                        0438 01212000
*         R8IRB RSTD;                                              0438 01213000
*       R2WORK=R4CURTCB->TCBLTC;    /* ADDR OF FIRST SUBTASK         */ 01214000
         L     R2WORK,TCBLTC(,R4CURTCB)                            0439 01215000
*       DO WHILE(R2WORK^=0);        /* DO000010: CHECK ALL SUBTASKS  */ 01216000
         B     @DE00440                                            0440 01217000
@DL00440 DS    0H                                                  0441 01218000
*/* %FL01080: D (NO,%FL01070,YES,) IS THERE A SUBTASK ?              */ 01219000
*                                                                  0441 01220000
*         R7IQE=R2WORK->TCBIQE;     /* ETXR IQE ADDR                 */ 01221000
         L     R7IQE,TCBIQE(,R2WORK)                               0441 01222000
*/* D (NO,AT001090,YES,) IS THERE AN ETXR IQE ?                      */ 01223000
*                                                                  0442 01224000
*         IF R7IQE=ZERO THEN        /* IS THERE AN IQE ?             */ 01225000
         LTR   R7IQE,R7IQE                                         0442 01226000
         BZ    @RT00442                                            0442 01227000
*           GOTO AT001090;          /* NO, CHECK NEXT SUBTASK        */ 01228000
*         R8IRB=R7IQE->IQEIRB;      /* ETXR IRB ADDR                 */ 01229000
         L     R8IRB,IQEIRB(,R7IQE)                                0444 01230000
*/* D (NO,AT001090,YES,) IS IRB'S ENTRY ADDR = ETXR ADDR ?           */ 01231000
*                                                                  0445 01232000
*         IF ATETXRB=R8IRB->RBEP THEN/* IRB FOR SAME EXIT RTN ?      */ 01233000
         SLR   @15,@15                                             0445 01234000
         ICM   @15,7,ATETXRB(R3WORKAD)                             0445 01235000
         C     @15,RBEP(,R8IRB)                                    0445 01236000
         BNE   @RF00445                                            0445 01237000
*           DO;                     /* DO000009: YES, REUSE THIS IRB */ 01238000
*/* P INCREMENT IRB USE COUNT BY 1                                   */ 01239000
*                                                                  0447 01240000
*             R8IRB->RBUSE=R8IRB->RBUSE+ONE;/* USE COUNT             */ 01241000
         LA    @15,1                                               0447 01242000
         SLR   @14,@14                                             0447 01243000
         IC    @14,RBUSE(,R8IRB)                                   0447 01244000
         ALR   @15,@14                                             0447 01245000
         STC   @15,RBUSE(,R8IRB)                                   0447 01246000
*/* S UNLOCK: RELEASE LOCAL LOCK                                     */ 01247000
*                                                                  0448 01248000
*             RFY                                                  0448 01249000
*               R15RETCD RSTD;                                     0448 01250000
*             CALL UNLOCK;          /* RELEASE LOCAL LOCK (ALTERS  0449 01251000
*                                      REGS 0,1,11,13,15)            */ 01252000
         BAL   @14,UNLOCK                                          0449 01253000
*/* D (YES,AT001390,NO,) ANY ERRORS ?                                */ 01254000
*                                                                  0450 01255000
*             IF R15RETCD^=X00NOERR THEN/* IF ERROR OCCURRED         */ 01256000
         LTR   R15RETCD,R15RETCD                                   0450 01257000
         BNZ   @RT00450                                            0450 01258000
*               GOTO AT001390;      /* GO TO EXIT                    */ 01259000
*             RFY                                                  0452 01260000
*               R15RETCD UNRSTD;                                   0452 01261000
*ATFP50:                                                           0453 01262000
*             WKFCODE=FCODE50;      /* LOCK RELEASED                 */ 01263000
*                                                                  0453 01264000
ATFP50   MVI   WKFCODE(R12SVRB),X'32'                              0453 01265000
*             /*******************************************************/ 01266000
*             /*                                                     */ 01267000
*             /* OBTAIN STORAGE FOR TCB AND IQE                      */ 01268000
*             /*                                                     */ 01269000
*             /*******************************************************/ 01270000
*                                                                  0454 01271000
*/* L (,AT001100) GETMAIN FOR TCB, IQE, FROM SUBPOOL 253             */ 01272000
*                                                                  0454 01273000
*             RFY                                                  0454 01274000
*               R0WORK RSTD;                                       0454 01275000
*             RFY                                                  0455 01276000
*               R1AREA RSTD;                                       0455 01277000
*             R0WORK=LENGTH(TCBFIX)+LENGTH(TCB)+LENGTH(TCBXTNT2)+LENGTH 01278000
*                 (IQESECT);        /* GETMAIN LENGTH                */ 01279000
         LA    R0WORK,384                                          0456 01280000
*             GENERATE SETS(R1AREA) REFS(R0WORK,SPID253) NOFLOWS;  0457 01281000
         SPACE                                                          01282000
         ICM   R0WORK,8,SPID253        SET SP ID INTO HIGH ORDER BYTE   01283000
         GETMAIN R,LV=(0)              GET STORAGE FOR TCB, IQE         01284000
         SPACE                                                          01285000
*             RFY                                                  0458 01286000
*               R0WORK UNRSTD;                                     0458 01287000
*             R7IQE=R1AREA;         /* IQE ADDR                      */ 01288000
         LR    R7IQE,R1AREA                                        0459 01289000
*             RFY                                                  0460 01290000
*               R1AREA UNRSTD;                                     0460 01291000
*             GOTO AT001100;        /* GO PROCESS TCB, IQE           */ 01292000
         B     AT001100                                            0461 01293000
*           END;                    /* END00009                      */ 01294000
*/* AT001090: P (,%FL01080) GET NEXT SUBTASK PTR                     */ 01295000
*                                                                  0463 01296000
*AT001090:                                                         0463 01297000
*         R2WORK=R2WORK->TCBNTC;    /* ADDR NEXT SUBTASK             */ 01298000
@RF00445 DS    0H                                                  0463 01299000
AT001090 L     R2WORK,TCBNTC(,R2WORK)                              0463 01300000
*       END;                        /* END00010                      */ 01301000
@DE00440 LTR   R2WORK,R2WORK                                       0464 01302000
         BNZ   @DL00440                                            0464 01303000
*       RFY                                                        0465 01304000
*         R2WORK UNRSTD;                                           0465 01305000
*       RFY                                                        0466 01306000
*         R7IQE UNRSTD;                                            0466 01307000
*       RFY                                                        0467 01308000
*         R8IRB UNRSTD;                                            0467 01309000
*                                                                  0467 01310000
*       /*************************************************************/ 01311000
*       /*                                                           */ 01312000
*       /* NO REUSABLE IRB EXISTS, NEED STORAGE FOR TCB, IRB, IQE    */ 01313000
*       /*                                                           */ 01314000
*       /*************************************************************/ 01315000
*                                                                  0468 01316000
*/* %FL01070: S UNLOCK: RELEASE LOCAL LOCK                           */ 01317000
*                                                                  0468 01318000
*       RFY                                                        0468 01319000
*         R15RETCD RSTD;                                           0468 01320000
*       CALL UNLOCK;                /* RELEASE LOCAL LOCK            */ 01321000
         BAL   @14,UNLOCK                                          0469 01322000
*/* D (YES,AT001390,NO,) ANY ERRORS ?                                */ 01323000
*                                                                  0470 01324000
*       IF R15RETCD^=X00NOERR THEN  /* CHECK FOR ERROR IN UNLOCK     */ 01325000
         LTR   R15RETCD,R15RETCD                                   0470 01326000
         BNZ   @RT00470                                            0470 01327000
*         GOTO AT001390;            /* ON ERROR, GO EXIT             */ 01328000
*       RFY                                                        0472 01329000
*         R15RETCD UNRSTD;                                         0472 01330000
*ATFP60:                                                           0473 01331000
*       WKFCODE=FCODE60;            /* LOCK RELEASED                 */ 01332000
ATFP60   MVI   WKFCODE(R12SVRB),X'3C'                              0473 01333000
*/* L CIRB: BUILD IRB AND GET STORAGE FOR TCB,IQE FROM SUBPOOL 253   */ 01334000
*/*       CIRB SVC BUILDS AN IRB,WITH PROBLEM PROGRAM SAVE AREA IN   */ 01335000
*/*       SUBPOOL 250. STORAGE FOR A TCB AND AN IQE IS OBTAINED.     */ 01336000
*/*       THE IRB AND THE STORAGE FOR THE TCB AND IQE ARE IN SUB-    */ 01337000
*/*       POOL 253.                                                  */ 01338000
*                                                                  0474 01339000
*       RFY                                                        0474 01340000
*         R0WORK RSTD;                                             0474 01341000
*       RFY                                                        0475 01342000
*         R1AREA RSTD;                                             0475 01343000
*       R0WORK=ATETXRB;             /* ENTRY POINT ADDR              */ 01344000
         SLR   R0WORK,R0WORK                                       0476 01345000
         ICM   R0WORK,7,ATETXRB(R3WORKAD)                          0476 01346000
*       R1WORK=(LENGTH(CIRBAREA)/EIGHT);/* NEW TCB AND IQE IN      0477 01347000
*                                      WORKAREA                      */ 01348000
         LA    R1WORK,48                                           0477 01349000
*       GENERATE REFS(R0WORK,R1AREA) SETS(R1AREA) NOFLOWS;         0478 01350000
         SPACE                                                          01351000
         CIRB  EP=(0),STAB=(DYN),SVAREA=YES,RETIQE=NO,                 *01352000
               WKAREA=(1)                                               01353000
         SPACE                                                          01354000
*       RFY                                                        0479 01355000
*         R0WORK UNRSTD;                                           0479 01356000
*       RFY                                                        0480 01357000
*         R8IRB RSTD;                                              0480 01358000
*       RFY                                                        0481 01359000
*         R7IQE RSTD;                                              0481 01360000
*       R8IRB=R1AREA;               /* ADDRESS OF THE NEW IRB        */ 01361000
         LR    R8IRB,R1AREA                                        0482 01362000
*       R7IQE=R1AREA+ADDR(IRBLEN)-ADDR(RBPRFLNA);/* IQE ADDR         */ 01363000
         LA    R7IQE,IRBLEN                                        0483 01364000
         ALR   R7IQE,R1AREA                                        0483 01365000
         LA    @02,RBPRFLNA                                        0483 01366000
         SLR   R7IQE,@02                                           0483 01367000
*       RFY                                                        0484 01368000
*         R1AREA UNRSTD;                                           0484 01369000
*                                                                  0484 01370000
*/* P SET RBETXR=1 RBIQETP=RBIQENR RBUSE=1 AND RBSIZE                */ 01371000
*                                                                  0485 01372000
*       R8IRB->RBETXR='1'B;         /* INDICATE ETXR IRB             */ 01373000
         OI    RBETXR(R8IRB),B'00010000'                           0485 01374000
*       R8IRB->RBIQETP='10'B;       /* FREE IQE UPON EXIT            */ 01375000
         NI    RBIQETP(R8IRB),B'11111011'                          0486 01376000
         OI    RBIQETP(R8IRB),B'00001000'                          0486 01377000
*       R8IRB->RBUSE=ONE;           /* SET INITIAL USE COUNT = 1     */ 01378000
         MVI   RBUSE(R8IRB),X'01'                                  0487 01379000
*       RFY                                                        0488 01380000
*         R0WORK RSTD;                                             0488 01381000
*       GENERATE REFS(R0WORK,R8IRB,RBSIZE) NOFLOWS;                0489 01382000
         SPACE                                                          01383000
         LA    R0WORK,IRBDWDS          SIZE OF IRB IN DOUBLEWORDS       01384000
         STH   R0WORK,RBSIZE(,R8IRB)     INTO IRB                       01385000
         SPACE                                                          01386000
*       RFY                                                        0490 01387000
*         R0WORK UNRSTD;                                           0490 01388000
*                                                                  0490 01389000
*/* AT001100: P CLEAR TCB AND IQE STORAGE TO ZERO                    */ 01390000
*                                                                  0491 01391000
*AT001100:                          /* PROCESS TCB, IQE              */ 01392000
*       RFY                                                        0491 01393000
*         R1AREA RSTD;                                             0491 01394000
AT001100 DS    0H                                                  0492 01395000
*       R1AREA=R7IQE;               /* ADDRESSING REGISTER           */ 01396000
         LR    R1AREA,R7IQE                                        0492 01397000
*       AREA=AREA&&AREA;            /* CLEAR 256 BYTES CLEAR       0493 01398000
*                                      REMAINING PORTION             */ 01399000
         XC    AREA(256,R1AREA),AREA(R1AREA)                       0493 01400000
*       EVAL(R1AREA+LENGTH(AREA))->AREA(1:LENGTH(TCBFIX)+LENGTH(TCB)+   01401000
*           LENGTH(TCBXTNT2)+LENGTH(IQESECT)-LENGTH(AREA))=EVAL(R1AREA+ 01402000
*           LENGTH(AREA))->AREA(1:LENGTH(TCBFIX)+LENGTH(TCB)+LENGTH(    01403000
*           TCBXTNT2)+LENGTH(IQESECT)-LENGTH(AREA))&&EVAL(R1AREA+LENGTH 01404000
*           (AREA))->AREA(1:LENGTH(TCBFIX)+LENGTH(TCB)+LENGTH(TCBXTNT2) 01405000
*           +LENGTH(IQESECT)-LENGTH(AREA));                        0494 01406000
         LA    @02,256                                             0494 01407000
         ALR   @02,R1AREA                                          0494 01408000
         XC    AREA(128,@02),AREA(@02)                             0494 01409000
*       RFY                                                        0495 01410000
*         R1AREA UNRSTD;                                           0495 01411000
*       R5NEWTCB=R7IQE+LENGTH(IQESECT)+LENGTH(TCBFIX);/* ADDR NEW TCB*/ 01412000
         LA    R5NEWTCB,56                                         0496 01413000
         ALR   R5NEWTCB,R7IQE                                      0496 01414000
*/* P SET TCBIQE = IQE ADDR, TCBETXR = 1                             */ 01415000
*                                                                  0497 01416000
*       R5NEWTCB->TCBIQE=R7IQE;     /* IQE ADDR INTO NEW TCB         */ 01417000
         ST    R7IQE,TCBIQE(,R5NEWTCB)                             0497 01418000
*       R5NEWTCB->TCBFETXR='1'B;    /* ETXR FLAG ON                  */ 01419000
         OI    TCBFETXR(R5NEWTCB),B'00000010'                      0498 01420000
*/* P (,%FL01390) INITIALIZE NEW IQE                                 */ 01421000
*                                                                  0499 01422000
*       R7IQE->IQEIRB=R8IRB;        /* IRB ADDR INTO NEW IQE         */ 01423000
         ST    R8IRB,IQEIRB(,R7IQE)                                0499 01424000
*       RFY                                                        0500 01425000
*         R8IRB UNRSTD;                                            0500 01426000
*       R7IQE->IQETCB=R4CURTCB;     /* CURRENT TCB ADDR INTO NEW IQE */ 01427000
         ST    R4CURTCB,IQETCB(,R7IQE)                             0501 01428000
*       R7IQE->IQEPARAM=R5NEWTCB;   /* NEW TCB ADDR INTO NEW IQE     */ 01429000
         ST    R5NEWTCB,IQEPARAM(,R7IQE)                           0502 01430000
*       RFY                                                        0503 01431000
*         R7IQE UNRSTD;                                            0503 01432000
*     END;                          /* END00008: END ETXR PROCESSING */ 01433000
*                                                                  0504 01434000
*   /*****************************************************************/ 01435000
*   /*                                                               */ 01436000
*   /* ETXR NOT SPECIFIED, ONLY NEED NEW TCB                         */ 01437000
*   /*                                                               */ 01438000
*   /*****************************************************************/ 01439000
*                                                                  0505 01440000
*   ELSE                                                           0505 01441000
*     DO;                           /* DO000011: ONLY NEW TCB      0505 01442000
*                                      REQUIRED                      */ 01443000
         B     @RC00434                                            0505 01444000
@RF00434 DS    0H                                                  0506 01445000
*/* %FL01060: S UNLOCK: RELEASE LOCAL LOCK                           */ 01446000
*                                                                  0506 01447000
*       RFY                                                        0506 01448000
*         R15RETCD RSTD;                                           0506 01449000
*       CALL UNLOCK;                /* RELEASE LOCAL LOCK (ALTERS  0507 01450000
*                                      REGS 0,1,11,13,15)            */ 01451000
         BAL   @14,UNLOCK                                          0507 01452000
*/* D (YES,AT001390,NO,) ANY ERRORS ?                                */ 01453000
*                                                                  0508 01454000
*       IF R15RETCD^=ZERO THEN      /* ANY ERRORS                    */ 01455000
         LTR   R15RETCD,R15RETCD                                   0508 01456000
         BNZ   @RT00508                                            0508 01457000
*         GOTO AT001390;            /* GO CLEAN UP                   */ 01458000
*       RFY                                                        0510 01459000
*         R15RETCD UNRSTD;                                         0510 01460000
*ATFP70:                                                           0511 01461000
*       WKFCODE=FCODE70;            /* LOCK RELEASED                 */ 01462000
ATFP70   MVI   WKFCODE(R12SVRB),X'46'                              0511 01463000
*/* L GETMAIN: OBTAIN TCB STORAGE                                    */ 01464000
*                                                                  0512 01465000
*       RFY                                                        0512 01466000
*         R0WORK RSTD;                                             0512 01467000
*       RFY                                                        0513 01468000
*         R1AREA RSTD;                                             0513 01469000
*       R0WORK=LENGTH(TCBFIX)+LENGTH(TCB)+LENGTH(TCBXTNT2);/* GETMAIN   01470000
*                                      LENGTH                        */ 01471000
         LA    R0WORK,360                                          0514 01472000
*       GENERATE REFS(R0WORK,SPID253) SETS(R1AREA) NOFLOWS;        0515 01473000
*                                                                  0515 01474000
         SPACE                                                          01475000
         ICM   R0WORK,8,SPID253        SET SP ID INTO HIGH ORDER BYTE   01476000
         GETMAIN R,LV=(0)              GET TCB STORAGE                  01477000
         SPACE                                                          01478000
*/* P CLEAR TCB STORAGE TO ZERO                                      */ 01479000
*                                                                  0516 01480000
*       AREA=AREA&&AREA;            /* CLEAR 256 BYTES CLEAR       0516 01481000
*                                      REMAINING PORTION             */ 01482000
         XC    AREA(256,R1AREA),AREA(R1AREA)                       0516 01483000
*       EVAL(R1AREA+LENGTH(AREA))->AREA(1:LENGTH(TCBFIX)+LENGTH(TCB)+   01484000
*           LENGTH(TCBXTNT2)-LENGTH(AREA))=EVAL(R1AREA+LENGTH(AREA))->  01485000
*           AREA(1:LENGTH(TCBFIX)+LENGTH(TCB)+LENGTH(TCBXTNT2)-LENGTH(  01486000
*           AREA))&&EVAL(R1AREA+LENGTH(AREA))->AREA(1:LENGTH(TCBFIX)+   01487000
*           LENGTH(TCB)+LENGTH(TCBXTNT2)-LENGTH(AREA));            0517 01488000
         LA    @08,256                                             0517 01489000
         ALR   @08,R1AREA                                          0517 01490000
         XC    AREA(104,@08),AREA(@08)                             0517 01491000
*       RFY                                                        0518 01492000
*         R0WORK UNRSTD;                                           0518 01493000
*       R5NEWTCB=R1AREA+LENGTH(TCBFIX);/* NEW TCB ADDR               */ 01494000
         LA    R5NEWTCB,32                                         0519 01495000
         ALR   R5NEWTCB,R1AREA                                     0519 01496000
*     END;                          /* END00011: END TCB-ONLY      0520 01497000
*                                      PROCESSING                    */ 01498000
*   RFY                                                            0521 01499000
*     R1AREA UNRSTD;                                               0521 01500000
*                                                                  0521 01501000
@RC00434 DS    0H                                                  0522 01502000
*/* %FL01390: P JOURNAL NEW TCB ADDRESS                              */ 01503000
*                                                                  0522 01504000
*   WKNEWTCB=R5NEWTCB;              /* FOR RECOVERY                  */ 01505000
         ST    R5NEWTCB,WKNEWTCB(,R12SVRB)                         0522 01506000
*ATFP80:                                                           0523 01507000
*   WKFCODE=FCODE80;                /* TRACE                         */ 01508000
ATFP80   MVI   WKFCODE(R12SVRB),X'50'                              0523 01509000
*/* P SET RETURN CODE ZERO                                           */ 01510000
*                                                                  0524 01511000
*   RFY                                                            0524 01512000
*     R15RETCD RSTD;                                               0524 01513000
*   R15RETCD=X00NOERR;              /* RETURN CODE 0                 */ 01514000
         SLR   R15RETCD,R15RETCD                                   0525 01515000
*/* AT001390: R RETURN TO CALLING POINT                              */ 01516000
*                                                                  0526 01517000
*   RFY                                                            0526 01518000
*     R14RET RSTD;                                                 0526 01519000
*AT001390:                                                         0527 01520000
*   R14RET=WKRTSAVE;                /* RETURN ADDRESS                */ 01521000
AT001390 L     R14RET,WKRTSAVE(,R3WORKAD)                          0527 01522000
*/* GETCBS: END  FLOWCHART                                           */ 01523000
*                                                                  0528 01524000
*   END GETCBS;                     /* END OF SUBROUTINE             */ 01525000
@EL00003 DS    0H                                                  0528 01526000
@EF00003 DS    0H                                                  0528 01527000
@ER00003 BR    @14                                                 0528 01528000
*   RFY                                                            0529 01529000
*     R14RET UNRSTD;                                               0529 01530000
*   RFY                                                            0530 01531000
*     R15RETCD UNRSTD;                                             0530 01532000
*                                                                  0531 01533000
*   /*****************************************************************/ 01534000
*   /*                                                               */ 01535000
*   /* CHKPARM SUBROUTINE                                            */ 01536000
*   /*                                                               */ 01537000
*   /*****************************************************************/ 01538000
*                                                                  0531 01539000
*CHKPARM:                                                          0531 01540000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/* ENTRY POINT              */ 01541000
CHKPARM  DS    0H                                                  0532 01542000
*/* CHKPARM: CHART  BEGIN FLOWCHART                                  */ 01543000
*/* FOOTING                                                        0532 01544000
*/* SUBROUTINE OBTAINS STORAGE FOR SVRB AND DE SAVE AREA, AND      0532 01545000
*/* PROCESSES INPUT PARAMETER LIST                                   */ 01546000
*/********************************************************************/ 01547000
*/*                                                                  */ 01548000
*/* SUBROUTINE CHKPARM OBTAINS SUFFICIENT STORAGE FROM SUBPOOL       */ 01549000
*/* 255 FOR A NEW SVRB, AND FOR A DE SAVE AREA, IF THE DE            */ 01550000
*/* PARAMETER WAS SPECIFIED ON THE ATTACH MACRO.                     */ 01551000
*/*                                                                  */ 01552000
*/* THE ATTACH PARAMETER LIST IS MOVED INTO THE AREA TO BE USED FOR  */ 01553000
*/* THE NEW SVRB (THIS AREA IS USED AS A TEMPORARY WORK AREA THROUGH */ 01554000
*/* MOST OF ATTACH PROCESSING), THE DIRECTORY ENTRY, IF DE WAS       */ 01555000
*/* SPECIFIED, IS MOVED INTO THE DE SAVE AREA, AND CONTROL FIELDS    */ 01556000
*/* ARE SET IN THE TEMPORARY WORKAREA AND THE PERMANENT WORKAREA     */ 01557000
*/* (WHICH IS IN THE RBEXSAVE FIELD OF THE CURRENT SVRB).            */ 01558000
*/*                                                                  */ 01559000
*/*    SUBROUTINES CALLED: MOVELIST                                  */ 01560000
*/*                                                                  */ 01561000
*/*    SYSTEM MACROS ISSUED: GETMAIN (RC-FORM BRANCH ENTRY)          */ 01562000
*/*                          TESTAUTH                                */ 01563000
*/*                                                                  */ 01564000
*/*    RETURN CODES SET: X00NOERR, ABEND42A, ABEND92A                */ 01565000
*/*                                                                  */ 01566000
*/*    REGISTER USAGE: R3WORKAD - OUTPUT, ADDRESS OF TEMP WORKAREA   */ 01567000
*/*                               (NEW SVRB STORAGE)                 */ 01568000
*/*                    R10INPRM - ADDRESS OF INPUT ATTACH PARM LIST  */ 01569000
*/*                    R12SVRB - ADDRESS OF ATTACH WORKAREA (CURRENT */ 01570000
*/*                              SVRB RBEXSAVE)                      */ 01571000
*/*                                                                  */ 01572000
*/********************************************************************/ 01573000
*/* E ENTER CHKPARM                                                  */ 01574000
*                                                                  0532 01575000
*   RFY                                                            0532 01576000
*     R7WORK RSTD;                                                 0532 01577000
*   RFY                                                            0533 01578000
*     R10INPRM RSTD;                                               0533 01579000
*   RFY                                                            0534 01580000
*     R14RET RSTD;                                                 0534 01581000
*   R7WORK=R14RET;                  /* SAVE RETURN ADDRESS           */ 01582000
         LR    R7WORK,R14RET                                       0535 01583000
*   RFY                                                            0536 01584000
*     R14RET UNRSTD;                                               0536 01585000
*                                                                  0536 01586000
*/* L TESTAUTH: CHECK CALLER FOR SYS KEY, SUPV STATE                 */ 01587000
*                                                                  0537 01588000
*   GENERATE SETS(R2WORK,R3WORKAD,R15RETCD) REFS(CVT) NOFLOWS;     0537 01589000
         SPACE                                                          01590000
         TESTAUTH STATE=YES,KEY=YES,RBLEVEL=2,BRANCH=YES                01591000
         SPACE                                                          01592000
*   RFY                                                            0538 01593000
*     R2WORK RSTD;                                                 0538 01594000
*   R2WORK=R7WORK;                  /* SAVE RETURN ADDRESS           */ 01595000
         LR    R2WORK,R7WORK                                       0539 01596000
*   RFY                                                            0540 01597000
*     R7WORK UNRSTD;                                               0540 01598000
*                                                                  0540 01599000
*/* D (NO,%FL02020,YES,) AUTHORIZED ?                                */ 01600000
*                                                                  0541 01601000
*   RFY                                                            0541 01602000
*     R15RETCD RSTD;                                               0541 01603000
*   IF R15RETCD=X00NOERR THEN       /* IF RETURN CODE = 0            */ 01604000
         LTR   R15RETCD,R15RETCD                                   0542 01605000
         BNZ   @RF00542                                            0542 01606000
*/* P (,%FL02030) SET SYSTEM TASK INDICATOR                          */ 01607000
*                                                                  0543 01608000
*     WKSYSTSK='1'B;                /* ATTACHING TASK IS SYSTEM TASK */ 01609000
         OI    WKSYSTSK(R12SVRB),B'10000000'                       0543 01610000
*   ELSE                            /* OTHERWISE, NOT                */ 01611000
*/* %FL02020: P STORE CALLER'S PROTECT KEY IN WORKAREA               */ 01612000
*                                                                  0544 01613000
*     WKPKEY=(R4CURTCB->TCBRBP->RBLINK->KEYCMWP)&KEYMASK;          0544 01614000
         B     @RC00542                                            0544 01615000
@RF00542 L     @14,TCBRBP(,R4CURTCB)                               0544 01616000
         L     @14,RBLINK(,@14)                                    0544 01617000
         LA    @11,240                                             0544 01618000
         SLR   @08,@08                                             0544 01619000
         IC    @08,KEYCMWP(,@14)                                   0544 01620000
         NR    @11,@08                                             0544 01621000
         STC   @11,WKPKEY(,R12SVRB)                                0544 01622000
*   RFY                                                            0545 01623000
*     R15RETCD UNRSTD;                                             0545 01624000
@RC00542 DS    0H                                                  0546 01625000
*ATFP30:                                                           0546 01626000
*   WKFCODE=FCODE30;                /* TRACE                         */ 01627000
ATFP30   MVI   WKFCODE(R12SVRB),X'1E'                              0546 01628000
*   RFY                                                            0547 01629000
*     R11LNGTH RSTD;                                               0547 01630000
*                                                                  0547 01631000
*/* %FL02030: P SET GETMAIN LENGTH TO LENGTH OF NEW SVRB             */ 01632000
*                                                                  0548 01633000
*   R11LNGTH=ADDR(SVRBLEN);         /* STORAGE FOR NEW SVRB  @Z30ENVB*/ 01634000
         LA    R11LNGTH,SVRBLEN                                    0548 01635000
*/* D (NO,%FL01680,YES,) WAS DE SPECIFIED ?                          */ 01636000
*                                                                  0549 01637000
*   IF R10INPRM->ATDENTRY='1'B THEN                                0549 01638000
*                                                                  0549 01639000
         TM    ATDENTRY(R10INPRM),B'10000000'                      0549 01640000
         BNO   @RF00549                                            0549 01641000
*/* P ADD MAX DE LENGTH TO GETMAIN LENGTH                            */ 01642000
*                                                                  0550 01643000
*     R11LNGTH=R11LNGTH+DELNG;      /* MAX AREA IS OBTAINED FOR DIR     01644000
*                                      ENTRY, REGARDLESS OF LENGTH,     01645000
*                                      AS PER LINK BR ENTRY INTERFACE*/ 01646000
         AH    R11LNGTH,@CH00168                                   0550 01647000
*/* %FL01680: L GETMAIN: OBTAIN SVRB DE STORAGE                      */ 01648000
*                                                                  0551 01649000
*   RFY                                                            0551 01650000
*     R0WORK RSTD;                                                 0551 01651000
@RF00549 DS    0H                                                  0552 01652000
*   RFY                                                            0552 01653000
*     R1AREA RSTD;                                                 0552 01654000
*   RFY                                                            0553 01655000
*     R7ASCB RSTD;                                                 0553 01656000
*   RFY                                                            0554 01657000
*     R15RETCD RSTD;                                               0554 01658000
*   R0WORK=R11LNGTH;                /* LENGTH FOR GETMAIN            */ 01659000
         LR    R0WORK,R11LNGTH                                     0555 01660000
*   R7ASCB=PSAAOLD;                 /* ASCB ADDR, FOR GETMAIN        */ 01661000
         L     R7ASCB,PSAAOLD                                      0556 01662000
*   GENERATE REFS(R0WORK,R4CURTCB,R7ASCB,CVTCRMN) SETS(R3WORKAD,R14RET, 01663000
*       R15RETCD) NOFLOWS;                                         0557 01664000
         SPACE                                                          01665000
         GETMAIN RC,LV=(0),SP=SP255EQU,KEY=0,BRANCH=YES                 01666000
         SPACE                                                          01667000
*   RFY                                                            0558 01668000
*     R0WORK UNRSTD;                                               0558 01669000
*   RFY                                                            0559 01670000
*     R7ASCB UNRSTD;                                               0559 01671000
*                                                                  0559 01672000
*/* D (YES,%FL01690,NO,) WAS STORAGE OBTAINED ?                      */ 01673000
*                                                                  0560 01674000
*   IF R15RETCD^=X00NOERR THEN                                     0560 01675000
         LTR   R15RETCD,R15RETCD                                   0560 01676000
         BZ    @RF00560                                            0560 01677000
*     DO;                           /* DO000053                      */ 01678000
*/* P (,AT001690) INDICATE ABEND CODE 92A                            */ 01679000
*                                                                  0562 01680000
*       WKREASON=RCODE4;            /* SET REASON CODE               */ 01681000
         MVI   WKREASON(R12SVRB),X'04'                             0562 01682000
*       R15RETCD=ABEND92A;          /* ERROR CODE                    */ 01683000
         LA    R15RETCD,2346                                       0563 01684000
*       GOTO AT001690;              /* GO EXIT SUBROUTINE            */ 01685000
         B     AT001690                                            0564 01686000
*     END;                          /* END00053                      */ 01687000
*   RFY                                                            0566 01688000
*     R15RETCD UNRSTD;                                             0566 01689000
*                                                                  0566 01690000
@RF00560 DS    0H                                                  0567 01691000
*/* %FL01690: P SET AREA SIZE, ADDRESS, IN PERM WORKAREA             */ 01692000
*                                                                  0567 01693000
*   WK255LNG=R11LNGTH;              /* LENGTH                        */ 01694000
         STH   R11LNGTH,WK255LNG(,R12SVRB)                         0567 01695000
*   WK255PTR=R1AREA;                /* ADDRESS                       */ 01696000
*                                                                  0568 01697000
         ST    R1AREA,WK255PTR(,R12SVRB)                           0568 01698000
*   /*****************************************************************/ 01699000
*   /*                                                               */ 01700000
*   /* INITIALIZE WORKAREA                                           */ 01701000
*   /*                                                               */ 01702000
*   /*****************************************************************/ 01703000
*                                                                  0569 01704000
*/* P CLEAR ENTIRE WORKAREA TO ZERO                                  */ 01705000
*                                                                  0569 01706000
*   RFY                                                            0569 01707000
*     R0WORK RSTD;                                                 0569 01708000
*   R3WORKAD=R1AREA;                /* WORKAREA ADDRESS              */ 01709000
         LR    R3WORKAD,R1AREA                                     0570 01710000
*   R0WORK=R11LNGTH;                /* LENGTH OF AREA                */ 01711000
         LR    R0WORK,R11LNGTH                                     0571 01712000
*   DO WHILE(R0WORK>=LENGTH(AREA)); /* DO000031: LOOP TO CLEAR 256 0572 01713000
*                                      BYTES/PASS                    */ 01714000
         B     @DE00572                                            0572 01715000
@DL00572 DS    0H                                                  0573 01716000
*     AREA=AREA&&AREA;              /* ZERO 256 BYTES                */ 01717000
         XC    AREA(256,R1AREA),AREA(R1AREA)                       0573 01718000
*     R0WORK=R0WORK-LENGTH(AREA);   /* DECREMENT COUNT OF BYTES LEFT */ 01719000
         LA    @08,256                                             0574 01720000
         SLR   R0WORK,@08                                          0574 01721000
*     R1AREA=R1AREA+LENGTH(AREA);   /* ADDRESS NEXT BYTE TO CLEAR    */ 01722000
         ALR   R1AREA,@08                                          0575 01723000
*   END;                            /* END00031: END LOOP            */ 01724000
@DE00572 CH    R0WORK,@CH01366                                     0576 01725000
         BNL   @DL00572                                            0576 01726000
*   IF R0WORK^=ZERO THEN            /* ANY BYTES REMAINING TO CLEAR?    01727000
*                                      YES, CLEAR REMAINER TO ZERO   */ 01728000
         LTR   R0WORK,R0WORK                                       0577 01729000
         BZ    @RF00577                                            0577 01730000
*     AREA(1:R0WORK)=AREA(1:R0WORK)&&AREA(1:R0WORK);/* CLEAR         */ 01731000
         LR    @08,R0WORK                                          0578 01732000
         BCTR  @08,0                                               0578 01733000
         EX    @08,@SX03144                                        0578 01734000
*   WKNOAREA='0'B;                  /* INDICATE AREA OBTAINED        */ 01735000
@RF00577 NI    WKNOAREA(R12SVRB),B'11110111'                       0579 01736000
*   RFY                                                            0580 01737000
*     R1AREA UNRSTD;                                               0580 01738000
*                                                                  0580 01739000
*/* DETERMINE LENGTH OF PARAMETER LIST                               */ 01740000
*/* D (YES,%FL01620,NO,) IS PARM LIST OSVS2 R2 LEVEL ?               */ 01741000
*                                                                  0581 01742000
*   IF R10INPRM->ATEXTN2='0'B THEN                                 0581 01743000
*                                                                  0581 01744000
         TM    ATEXTN2(R10INPRM),B'00001000'                       0581 01745000
         BNZ   @RF00581                                            0581 01746000
*/* D (NO,%FL01630,YES,) IS PARM LIST OS/MVT REL 21 LEVEL ?          */ 01747000
*                                                                  0582 01748000
*     IF R10INPRM->ATJSCB='1'B|     /* JSCB ?, OR                    */ 01749000
*         R10INPRM->ATTSKLB='1'B|   /* TASKLIB ?, OR                 */ 01750000
*         R10INPRM->ATTSTAI='1'B|   /* STAI OR ESTAI ?, OR           */ 01751000
*         R10INPRM->ATEXTN='1'B THEN/* OS/VS2 REL 1 ?                */ 01752000
         TM    ATJSCB(R10INPRM),B'01000000'                        0582 01753000
         BO    @RT00582                                            0582 01754000
         TM    ATTSKLB(R10INPRM),B'00000011'                       0582 01755000
         BNZ   @RT00582                                            0582 01756000
         TM    ATEXTN(R10INPRM),B'00100000'                        0582 01757000
         BNO   @RF00582                                            0582 01758000
@RT00582 DS    0H                                                  0583 01759000
*/* P (,%FL01640) SET PARM LIST LENGTH TO 52 BYTES                   */ 01760000
*                                                                  0583 01761000
*       R11LNGTH=EXTLISTL;          /* SET PARM LIST TO EXTENDED, 52 */ 01762000
         LA    R11LNGTH,52                                         0583 01763000
*/* %FL01630: P (,%FL01640) SET LIST LENGTH TO 36 BYTES              */ 01764000
*                                                                  0584 01765000
*     ELSE                                                         0584 01766000
*       R11LNGTH=OLDLISTL;          /* SET PARM LIST TO ORIGINAL, 36 */ 01767000
         B     @RC00582                                            0584 01768000
@RF00582 LA    R11LNGTH,36                                         0584 01769000
*   ELSE                            /* LIST CONTAINS LENGTH          */ 01770000
*     DO;                           /* DO000032                      */ 01771000
         B     @RC00581                                            0585 01772000
@RF00581 DS    0H                                                  0586 01773000
*/* %FL01620: S MOVELIST: MOVE LENGTH FIELD TO WORKAREA              */ 01774000
*                                                                  0586 01775000
*       RFY                                                        0586 01776000
*         R0WORK RSTD;                                             0586 01777000
*       RFY                                                        0587 01778000
*         R7WORK RSTD;                                             0587 01779000
*       RFY                                                        0588 01780000
*         R8WORK RSTD;                                             0588 01781000
*       R0WORK=LENGTH(WKTHWORD);    /* LENGTH                        */ 01782000
         LA    R0WORK,2                                            0589 01783000
*       R7WORK=ADDR(R10INPRM->ATTPLNG);/* ADDRESS OF LENGTH FIELD    */ 01784000
         LA    R7WORK,ATTPLNG(,R10INPRM)                           0590 01785000
*       R8WORK=ADDR(WKTHWORD);      /* MOVE TO ADDRESS               */ 01786000
         LA    R8WORK,WKTHWORD(,R3WORKAD)                          0591 01787000
*       CALL MOVELIST;              /* VALIDITY CHECKING MOVE        */ 01788000
         BAL   @14,MOVELIST                                        0592 01789000
*       RFY                                                        0593 01790000
*         R0WORK UNRSTD;                                           0593 01791000
*       RFY                                                        0594 01792000
*         R7WORK UNRSTD;                                           0594 01793000
*       RFY                                                        0595 01794000
*         R8WORK UNRSTD;                                           0595 01795000
*                                                                  0595 01796000
*/* P SET PARM LIST LENGTH TO LIST LENGTH FIELD (ATTPLNG)            */ 01797000
*                                                                  0596 01798000
*       R11LNGTH=WKTHWORD;          /* LENGTH OF LIST SET BY MACRO   */ 01799000
         LH    R11LNGTH,WKTHWORD(,R3WORKAD)                        0596 01800000
*       IF(R11LNGTH>LENGTH(ATTCHLST))|(R11LNGTH<OSVS2R2L) THEN/*   0597 01801000
*                                      VALID ?                       */ 01802000
         LA    @08,60                                              0597 01803000
         CR    R11LNGTH,@08                                        0597 01804000
         BH    @RT00597                                            0597 01805000
         CR    R11LNGTH,@08                                        0597 01806000
         BNL   @RF00597                                            0597 01807000
@RT00597 DS    0H                                                  0598 01808000
*         DO;                       /* DO000033                      */ 01809000
*           RFY                                                    0599 01810000
*             R15RETCD RSTD;                                       0599 01811000
*           R15RETCD=ABEND72A;      /* INVALID PARM LIST             */ 01812000
         LA    R15RETCD,1834                                       0600 01813000
*           GOTO AT001690;          /* GO EXIT SUBROUTINE            */ 01814000
         B     AT001690                                            0601 01815000
*           RFY                                                    0602 01816000
*             R15RETCD UNRSTD;                                     0602 01817000
*         END;                      /* END00033                      */ 01818000
*     END;                          /* END00032                      */ 01819000
@RF00597 DS    0H                                                  0605 01820000
*ATFP40:                                                           0605 01821000
*   WKFCODE=FCODE40;                /* TRACE                         */ 01822000
@RC00581 DS    0H                                                  0605 01823000
ATFP40   MVI   WKFCODE(R12SVRB),X'28'                              0605 01824000
*/* %FL01640: S MOVELIST: MOVE PARM LIST TO WORKAREA                 */ 01825000
*                                                                  0606 01826000
*   RFY                                                            0606 01827000
*     R0WORK RSTD;                                                 0606 01828000
*   RFY                                                            0607 01829000
*     R7WORK RSTD;                                                 0607 01830000
*   RFY                                                            0608 01831000
*     R8WORK RSTD;                                                 0608 01832000
*   R0WORK=R11LNGTH;                /* LENGTH OF LIST                */ 01833000
         LR    R0WORK,R11LNGTH                                     0609 01834000
*   R7WORK=R10INPRM;                /* MOVE-FROM ADDR = INPUT PARM 0610 01835000
*                                      LIST ADDR                     */ 01836000
         LR    R7WORK,R10INPRM                                     0610 01837000
*   R8WORK=R3WORKAD;                /* MOVE-TO ADDR                  */ 01838000
         LR    R8WORK,R3WORKAD                                     0611 01839000
*   CALL MOVELIST;                  /* PARM LIST TO WORKAREA         */ 01840000
         BAL   @14,MOVELIST                                        0612 01841000
*   RFY                                                            0613 01842000
*     R10INPRM UNRSTD;                                             0613 01843000
*   RFY                                                            0614 01844000
*     R11LNGTH UNRSTD;                                             0614 01845000
*   RFY                                                            0615 01846000
*     R0WORK UNRSTD;                                               0615 01847000
*   RFY                                                            0616 01848000
*     R7WORK UNRSTD;                                               0616 01849000
*   RFY                                                            0617 01850000
*     R8WORK UNRSTD;                                               0617 01851000
*                                                                  0617 01852000
*/* COMMENT SINCE WORKAREA WAS CLEARED TO 0, ALL FIELDS OF EXTENDED  */ 01853000
*/* PARM LIST CAN BE REFERENCED, WITHOUT REGARD TO ACTUAL PARM LIST  */ 01854000
*/* LENGTH                                                           */ 01855000
*/* P MOVE DCB PARM TO WORKAREA                                      */ 01856000
*                                                                  0618 01857000
*   WKGRS11=ATDCBADB;               /* DCB PARM SPECIFIED, OR 0      */ 01858000
         SLR   @08,@08                                             0618 01859000
         ICM   @08,7,ATDCBADB(R3WORKAD)                            0618 01860000
         ST    @08,WKGRS11(,R12SVRB)                               0618 01861000
*/* D (YES,%RSAP,NO,)  IS CALLER A SYSTEM TASK ?                     */ 01862000
*                                                                  0619 01863000
*   IF WKSYSTSK='0'B THEN                                          0619 01864000
         TM    WKSYSTSK(R12SVRB),B'10000000'                       0619 01865000
         BNZ   @RF00619                                            0619 01866000
*     DO;                           /* DO000057                      */ 01867000
*/* P SET 'PRIVILEGED' PARAMETERS TO THEIR DEFAULTS                  */ 01868000
*                                                                  0621 01869000
*       ATDISP='0'B;                /* DISP=YES (SET TCBANDSP=0)     */ 01870000
*       ATJSCB='0'B;                /* NO JSCB ADDR (PROPAGATE     0622 01871000
*                                      TCBJSCB)                      */ 01872000
*       ATKEY='0'B;                 /* KEY=PROP (PROPAGATE TCBPKF)   */ 01873000
*       ATSVAREA='0'B;              /* SVAREA=YES (GET PROBLEM PGM 0624 01874000
*                                      SAVE AREA, PTR IN TCBFSA)     */ 01875000
*       ATJSTCB='0'B;               /* JSTCB=NO (PROPAGATE TCBJSTCB) */ 01876000
*       ATMODE='0'B;                /* SM=PROB (SET TCBFSM=0)        */ 01877000
*                                                                  0626 01878000
         NI    ATDISP(R3WORKAD),B'00101000'                        0626 01879000
*       /*************************************************************/ 01880000
*       /*                                                           */ 01881000
*       /* SZERO=YES/NO IS NOT PRIVILEGED.                           */ 01882000
*       /*                                                           */ 01883000
*       /*************************************************************/ 01884000
*                                                                  0627 01885000
*       ATTID=ZERO;                 /* TID=0 (SET TCBTID=0)          */ 01886000
         MVI   ATTID(R3WORKAD),X'00'                               0627 01887000
*       ATNSHRSP='0'B;              /* NSHSPL NOT SPECIFIED (PROP- 0628 01888000
*                                      AGATE SWA, SUBPOOLS 236, 237) */ 01889000
         NI    ATNSHRSP(R3WORKAD),B'01111111'                      0628 01890000
*       ATTNSHLV=ZERO;              /* NSHSPV NOT SPECIFIED          */ 01891000
         SLR   @08,@08                                             0629 01892000
         ST    @08,ATTNSHLV(,R3WORKAD)                             0629 01893000
*       ATRSAPF='0'B;               /* RSAPF=NO              @Z40RPYB*/ 01894000
*                                                                  0630 01895000
         NI    ATRSAPF(R3WORKAD),B'10111111'                       0630 01896000
*       /*************************************************************/ 01897000
*       /*                                                           */ 01898000
*       /* AS OF OS/VS2 REL 2, THE FOLLOWING ONCE PRIVILEGED         */ 01899000
*       /* PARAMETERS ARE IGNORED: GIVEJPQ=YES/NO TSLOGON=YES/NO     */ 01900000
*       /* LSQA=VALUE                                                */ 01901000
*       /*                                                           */ 01902000
*       /*************************************************************/ 01903000
*                                                                  0631 01904000
*     END;                          /* END00057                      */ 01905000
*/*%RSAP: D (YES,,NO,%FL01760) RSAPF=YES SPECIFIED? (ATRSAPF =1)     */ 01906000
*/* D (YES,%RSAQ,NO,) SM=SUPV SPCIFIED: (ATMODE=1)                   */ 01907000
*/* D (YES,%RSAQ,NO,) KEY =ZERO SPECIFIED? (ATKEY =1)                */ 01908000
*/* D (YES,,NO,%RSAR) TCB PRO TECT KEY (TCBPKF) <8)                  */ 01909000
*/*%RSAQ: P (,%FL01760) FORCE RSAPF=NO (SET ATRSAPF=0)               */ 01910000
*/*%RSAR: L TESTAUTH: CHECK APF AUTHORIZATION MODE                   */ 01911000
*/* D (YES,%RSAS,NO,) CALLER APF AUTHORIZED? (R15 =0)                */ 01912000
*/* P (,%FL01760) INDICATE RSAPF=YES FOR PGM MGR (SET WKRSAPF =1)    */ 01913000
*/* COMMENT (13,2) WKRSAPF WHEN MOVED TO                             */ 01914000
*/* COMMENT (14,2) RBEXSAVE IS USED BY LINK                          */ 01915000
*/*%RSAS: P FORCE RSAPF=NO (SET ATRSAPF=0)                           */ 01916000
*                                                                  0632 01917000
*   ELSE                            /* HERE IF SYSTEM RQST   @Z40RPYB*/ 01918000
*     DO;                           /* CK FOR RESET APF      @Z40RPYB*/ 01919000
         B     @RC00619                                            0632 01920000
@RF00619 DS    0H                                                  0633 01921000
*       IF ATRSAPF='1'B THEN        /* IF RSAPF=YES ENSURE   @Z40RPYB*/ 01922000
         TM    ATRSAPF(R3WORKAD),B'01000000'                       0633 01923000
         BNO   @RF00633                                            0633 01924000
*         DO;                       /* CONDITIONS ARE MET.   @Z40RPYB*/ 01925000
*           IF ATMODE='1'B|         /* IF SM=SUPV OR         @Z40RPYB*/ 01926000
*               ATKEY='1'B|         /* KEY=ZERO OR           @Z40RPYB*/ 01927000
*               R4CURTCB->TCBPKF<'80'X THEN/* TCB KEY <8 THEN      0635 01928000
*                                                            @ZA24297*/ 01929000
         TM    ATMODE(R3WORKAD),B'00010001'                        0635 01930000
         BNZ   @RT00635                                            0635 01931000
         CLI   TCBPKF(R4CURTCB),X'80'                              0635 01932000
         BNL   @RF00635                                            0635 01933000
@RT00635 DS    0H                                                  0636 01934000
*             ATRSAPF='0'B;         /* FORCE RSAPF=NO.       @Z40RPYB*/ 01935000
         NI    ATRSAPF(R3WORKAD),B'10111111'                       0636 01936000
*           ELSE                    /* HERE IF NEW TCB IS    @Z40RPYB*/ 01937000
*             DO;                   /* PP STATE+ KEY > 7.    @Z40RPYB*/ 01938000
         B     @RC00635                                            0637 01939000
@RF00635 DS    0H                                                  0638 01940000
*               RESPECIFY                                          0638 01941000
*                (R7WORK,                                          0638 01942000
*                 R8WORK) RSTD;     /* NOW TEST APF          @Z40RPYB*/ 01943000
*               R7WORK=R2WORK;      /* SAVE ACROSS TESTAUTH  @Z40RPYB*/ 01944000
         LR    R7WORK,R2WORK                                       0639 01945000
*               R8WORK=R3WORK;      /* SAVE ACROSS TESTAUTH  @Z40RPYB*/ 01946000
         LR    R8WORK,R3WORK                                       0640 01947000
*               GENERATE REFS(CVT,CVTAPF);                         0641 01948000
               TESTAUTH FCTN=1,RBLEVEL=2,BRANCH=YES                     01949000
*               RESPECIFY                                          0642 01950000
*                (R15RETCD) RSTD;   /*                       @Z40RPYB*/ 01951000
*               R2WORK=R7WORK;      /* RESTORE R2WORK        @Z40RPYB*/ 01952000
         LR    R2WORK,R7WORK                                       0643 01953000
*               R3WORK=R8WORK;      /* RESTORE R3WORK        @Z40RPYB*/ 01954000
         LR    R3WORK,R8WORK                                       0644 01955000
*               RESPECIFY                                          0645 01956000
*                (R7WORK,                                          0645 01957000
*                 R8WORK) UNRSTD;   /*                       @Z40RPYB*/ 01958000
*               IF R15RETCD=X00NOERR THEN/* IF APF AUTHORIZED      0646 01959000
*                                                            @Z40RPYB*/ 01960000
         LTR   R15RETCD,R15RETCD                                   0646 01961000
         BNZ   @RF00646                                            0646 01962000
*                 ATRSAPF='0'B;     /* FORCE RSAPF=NO        @Z40RPYB*/ 01963000
         NI    ATRSAPF(R3WORKAD),B'10111111'                       0647 01964000
*               ELSE                /* IF NOT APF AUTH.      @Z40RPYB*/ 01965000
*                 WKRSAPF='1'B;     /* INDICATE RSAPF=YES    @Z40RPYB*/ 01966000
         B     @RC00646                                            0648 01967000
@RF00646 OI    WKRSAPF(R12SVRB),B'01000000'                        0648 01968000
*               RESPECIFY                                          0649 01969000
*                (R15RETCD) UNRSTD; /*                       @Z40RPYB*/ 01970000
@RC00646 DS    0H                                                  0650 01971000
*             END;                  /*                       @Z40FPYB*/ 01972000
*         END;                      /*                       @Z40FPYB*/ 01973000
@RC00635 DS    0H                                                  0652 01974000
*     END;                          /*                       @Z40FPYB*/ 01975000
@RF00633 DS    0H                                                  0653 01976000
*/* %FL01760: P SET SVAREA=YES/NO FLAG IN WORKAREA                   */ 01977000
*                                                                  0653 01978000
*   IF ATSVAREA='1'B THEN                                          0653 01979000
@RC00619 TM    ATSVAREA(R3WORKAD),B'00000100'                      0653 01980000
         BNO   @RF00653                                            0653 01981000
*     WKSVAREA='1'B;                                               0654 01982000
*                                                                  0654 01983000
         OI    WKSVAREA(R12SVRB),B'10000000'                       0654 01984000
*/* D (NO,%FL01770,YES,) WAS EP OR EPLOC SPECIFIED ?                 */ 01985000
*                                                                  0655 01986000
*   IF ATDENTRY='0'B THEN                                          0655 01987000
@RF00653 TM    ATDENTRY(R3WORKAD),B'10000000'                      0655 01988000
         BNZ   @RF00655                                            0655 01989000
*     DO;                           /* DO000058                      */ 01990000
*/* P SET ADDRESS OF EP NAME TO RBEXSAVE                             */ 01991000
*                                                                  0657 01992000
*       RFY                                                        0657 01993000
*         R8WORK RSTD;                                             0657 01994000
*                                                                  0657 01995000
*       /*************************************************************/ 01996000
*       /*                                                           */ 01997000
*       /* EP NAME WILL OCCUPY FIRST EIGHT BYTES OF RBEXSAVE         */ 01998000
*       /*                                                           */ 01999000
*       /*************************************************************/ 02000000
*                                                                  0658 02001000
*       GENERATE REFS(RBPRFXND,RBPRFXST,RBEXSAVE,RBBASIC,R8WORK)   0658 02002000
*           NOFLOWS;                                               0658 02003000
         SPACE                                                          02004000
         LA    R8WORK,RBPRFXND-RBPRFXST+RBEXSAVE-RBBASIC(,R3WORKAD)     02005000
         SPACE                                                          02006000
*       WKGRS10=R8WORK;             /* SAVE ADDRESS                  */ 02007000
         ST    R8WORK,WKGRS10(,R12SVRB)                            0659 02008000
*/* S (,%FL01530) MOVELIST: MOVE ENTRY POINT NAME INTO WORKAREA      */ 02009000
*                                                                  0660 02010000
*       RFY                                                        0660 02011000
*         R0WORK RSTD;                                             0660 02012000
*       RFY                                                        0661 02013000
*         R7WORK RSTD;                                             0661 02014000
*       R0WORK=LENGTH(ATPRGNM);     /* NAME REQUIRED TO BE 8 BYTES,     02015000
*                                      PADDED WITH BLANKS IF NECESS  */ 02016000
         LA    R0WORK,8                                            0662 02017000
*       R7WORK=ATPGNADB;            /* ADDR OF EP NAME (MOVE-FROM)   */ 02018000
         SLR   R7WORK,R7WORK                                       0663 02019000
         ICM   R7WORK,7,ATPGNADB(R3WORKAD)                         0663 02020000
*       R8WORK=ADDR(WKEPNAME);      /* MOVE-TO POSITION IN WORKAREA  */ 02021000
         LR    R8WORK,R12SVRB                                      0664 02022000
*       CALL MOVELIST;              /* MOVE EP NAME INTO WORKAREA    */ 02023000
         BAL   @14,MOVELIST                                        0665 02024000
*     END;                          /* END00058                      */ 02025000
*/* %FL01770: P DETERMINE DIRECTORY ENTRY LENGTH                     */ 02026000
*                                                                  0667 02027000
*   ELSE                            /* DE WAS SPECIFIED              */ 02028000
*     DO;                           /* DO000059                      */ 02029000
         B     @RC00655                                            0667 02030000
@RF00655 DS    0H                                                  0668 02031000
*       RFY                                                        0668 02032000
*         R1WORK RSTD;                                             0668 02033000
*       R0WORK=ONE;                 /* TO MOVE ONE BYTE              */ 02034000
         LA    R0WORK,1                                            0669 02035000
*       R1WORK=ATPGNADB;            /* DIRECTORY ENTRY ADDR          */ 02036000
         SLR   R1WORK,R1WORK                                       0670 02037000
         ICM   R1WORK,7,ATPGNADB(R3WORKAD)                         0670 02038000
*       R7WORK=ADDR(R1WORK->PDS2INDC);/* NUMBER HALFWORDS IN 'USER'     02039000
*                                      DATA AREA, SET BY LINK EDIT   */ 02040000
         LA    R7WORK,PDS2INDC(,R1WORK)                            0671 02041000
*       R8WORK=ADDR(WKTEMP1);       /* MOVE-TO ADDRESS               */ 02042000
         LA    R8WORK,WKTEMP1(,R3WORKAD)                           0672 02043000
*       CALL MOVELIST;              /* VALIDITY CHECK AND MOVE BYTE  */ 02044000
         BAL   @14,MOVELIST                                        0673 02045000
*       RFY                                                        0674 02046000
*         R7WORK UNRSTD;                                           0674 02047000
*       GENERATE REFS(PDS2,PDS2USRD) NOFLOWS;                      0675 02048000
         SPACE                                                          02049000
         IC    R8WORK,0(,R8WORK)       USER LENGTH BYTE (SET BY         02050000
*                                      LINKAGE EDITOR)                  02051000
         LA    R0WORK,MASKPDSL         MASK                             02052000
         NR    R8WORK,R0WORK           USER AREA LENGTH IN HALFWORDS    02053000
         LA    R0WORK,PDS2USRD-PDS2(R8WORK,R8WORK) TOTAL LENGTH OF DE   02054000
         SPACE                                                          02055000
*       RFY                                                        0676 02056000
*         R1WORK UNRSTD;                                           0676 02057000
*       RFY                                                        0677 02058000
*         R1AREA RSTD;                                             0677 02059000
*       RFY                                                        0678 02060000
*         R7WORK RSTD;                                             0678 02061000
*                                                                  0678 02062000
*/* P SET ACTUAL DE LENGTH INTO DE SAVE AREA                         */ 02063000
*                                                                  0679 02064000
*       R1AREA=R3WORKAD+ADDR(SVRBLEN);/* ADDR OF DE SAVE AREA      0679 02065000
*                                                            @ZA10793*/ 02066000
         LA    R1AREA,SVRBLEN                                      0679 02067000
         ALR   R1AREA,R3WORKAD                                     0679 02068000
*       R1AREA->ZWORD=R0WORK;       /* MOVE DE LNGTH INTO DE AREA  0680 02069000
*                                                            @ZA10793*/ 02070000
         ST    R0WORK,ZWORD(,R1AREA)                               0680 02071000
*/* S MOVELIST: MOVE DE INTO DE SAVE AREA (60 BYTES ONLY)            */ 02072000
*                                                                  0681 02073000
*       IF R0WORK>DEMAX THEN        /*                       @ZA10793*/ 02074000
         LA    @15,60                                              0681 02075000
         CR    R0WORK,@15                                          0681 02076000
         BNH   @RF00681                                            0681 02077000
*         R0WORK=DEMAX;             /* MOVE 60 BYTES ONLY    @ZA10793*/ 02078000
         LR    R0WORK,@15                                          0682 02079000
*       R7WORK=ATPGNADB;            /* MOVE-FROM ADDR = DE ADDR      */ 02080000
@RF00681 SLR   R7WORK,R7WORK                                       0683 02081000
         ICM   R7WORK,7,ATPGNADB(R3WORKAD)                         0683 02082000
*       R8WORK=R1AREA+LENGTH(ZWORD);/* MOVE-TO ADDR IN GETMAINED AREA*/ 02083000
         LA    R8WORK,4                                            0684 02084000
         ALR   R8WORK,R1AREA                                       0684 02085000
*       CALL MOVELIST;              /* VALIDITY CHECKING MOVE        */ 02086000
         BAL   @14,MOVELIST                                        0685 02087000
*       RFY                                                        0686 02088000
*         R7WORK UNRSTD;                                           0686 02089000
*       RFY                                                        0687 02090000
*         R8WORK UNRSTD;                                           0687 02091000
*                                                                  0687 02092000
*/* P SAVE COMPLEMENTED ADDR OF DE SAVE AREA FOR LINK BR ENTRY       */ 02093000
*                                                                  0688 02094000
*       WKGRS10=-R1AREA;            /* SAVE COMPLEMENT ADDR FOR LINK */ 02095000
         LCR   @08,R1AREA                                          0688 02096000
         ST    @08,WKGRS10(,R12SVRB)                               0688 02097000
*       RFY                                                        0689 02098000
*         R0WORK UNRSTD;                                           0689 02099000
*       RFY                                                        0690 02100000
*         R1AREA UNRSTD;                                           0690 02101000
*     END;                          /* END00059                      */ 02102000
*/* %FL01530: P SET RETURN CODE = 0                                  */ 02103000
*                                                                  0692 02104000
*   RFY                                                            0692 02105000
*     R15RETCD RSTD;                                               0692 02106000
@RC00655 DS    0H                                                  0693 02107000
*   R15RETCD=X00NOERR;              /* SET RETURN CODE               */ 02108000
         SLR   R15RETCD,R15RETCD                                   0693 02109000
*/* D (NO,AT001690,YES,) WAS ECB SPECIFIED ?                         */ 02110000
*                                                                  0694 02111000
*   IF ATECBADB^=ZERO THEN                                         0694 02112000
*                                                                  0694 02113000
         SLR   @14,@14                                             0694 02114000
         ICM   @14,7,ATECBADB(R3WORKAD)                            0694 02115000
         LTR   @14,@14                                             0694 02116000
         BZ    @RF00694                                            0694 02117000
*/* D (YES,AT001690,NO,) IS CALLER A SYSTEM TASK ?                   */ 02118000
*                                                                  0695 02119000
*     IF WKSYSTSK='0'B THEN                                        0695 02120000
         TM    WKSYSTSK(R12SVRB),B'10000000'                       0695 02121000
         BNZ   @RF00695                                            0695 02122000
*       DO;                         /* DO000060                      */ 02123000
*/* D (NO,%FL01700,YES,) IS ECB ADDRESS ON A FULLWORD BOUNDARY ?     */ 02124000
*                                                                  0697 02125000
*         IF ECBTEST(31:32)='00'B THEN                             0697 02126000
         TM    ECBTEST+3(R3WORKAD),B'00000011'                     0697 02127000
         BNZ   @RF00697                                            0697 02128000
*           DO;                     /* DO000088                      */ 02129000
*/* P (,AT001690) VALIDITY CHECK ECB ADDRESS                         */ 02130000
*                                                                  0699 02131000
*             RFY                                                  0699 02132000
*               R1WORK RSTD;                                       0699 02133000
*             WKECBSW='1'B;         /* ALLOWS FRR TO DETECT BAD ECB  */ 02134000
         OI    WKECBSW(R12SVRB),B'00100000'                        0700 02135000
*             WKRTSAVE=R2WORK;      /* SAVE                          */ 02136000
         ST    R2WORK,WKRTSAVE(,R3WORKAD)                          0701 02137000
*             R2WORK=WKPKEY;                                       0702 02138000
         SLR   R2WORK,R2WORK                                       0702 02139000
         IC    R2WORK,WKPKEY(,R12SVRB)                             0702 02140000
*             R1WORK=ATECBADB;      /* ADDRESS OF ECB                */ 02141000
         LR    R1WORK,@14                                          0703 02142000
*             GENERATE REFS(R2WORK) NOFLOWS SETS(R2WORK);          0704 02143000
         SPACE                                                          02144000
         MODESET KEYADDR=(2)           SET USER PROTECT KEY             02145000
         SPACE                                                          02146000
         L     R2WORK,0(,R1WORK)       FETCH ECB (FETCH PROTECT CHECK)  02147000
         ST    R2WORK,0(,R1WORK)       STORE ECB (STORE PROTECT CHECK)  02148000
         SPACE                                                          02149000
         MODESET EXTKEY=SUPR           RESET PROTECT KEY TO 0           02150000
         SPACE                                                          02151000
*             RFY                                                  0705 02152000
*               R1WORK UNRSTD;                                     0705 02153000
*             R2WORK=WKRTSAVE;      /* RESTORE                       */ 02154000
         L     R2WORK,WKRTSAVE(,R3WORKAD)                          0706 02155000
*             WKECBSW='0'B;         /* INVALID ECB SWITCH OFF        */ 02156000
         NI    WKECBSW(R12SVRB),B'11011111'                        0707 02157000
*           END;                    /* END00088                      */ 02158000
*/* %FL01700: P INDICATE ABEND CODE 42A                              */ 02159000
*                                                                  0709 02160000
*         ELSE                                                     0709 02161000
*           R15RETCD=ABEND42A;      /* ERROR, ECB ADDR NOT FULLWORD  */ 02162000
         B     @RC00697                                            0709 02163000
@RF00697 LA    R15RETCD,1066                                       0709 02164000
*       END;                        /* END00060                      */ 02165000
@RC00697 DS    0H                                                  0711 02166000
*/* AT001690: R RETURN TO CALLING POINT                              */ 02167000
*                                                                  0711 02168000
*AT001690:                                                         0711 02169000
*   RFY                                                            0711 02170000
*     R14RET RSTD;                                                 0711 02171000
@RF00695 DS    0H                                                  0711 02172000
@RF00694 DS    0H                                                  0711 02173000
AT001690 DS    0H                                                  0712 02174000
*   R14RET=R2WORK;                  /* RESTORE RETURN ADDRESS        */ 02175000
         LR    R14RET,R2WORK                                       0712 02176000
*/* CHKPARM: END FLOWCHART                                           */ 02177000
*                                                                  0713 02178000
*   END CHKPARM;                    /* END OF SUBROUTINE             */ 02179000
@EL00004 DS    0H                                                  0713 02180000
@EF00004 DS    0H                                                  0713 02181000
@ER00004 BR    @14                                                 0713 02182000
*   RFY                                                            0714 02183000
*     R14RET UNRSTD;                                               0714 02184000
*   RFY                                                            0715 02185000
*     R15RETCD UNRSTD;                                             0715 02186000
*   RFY                                                            0716 02187000
*     R2WORK UNRSTD;                                               0716 02188000
*                                                                  0717 02189000
*   /*****************************************************************/ 02190000
*   /*                                                               */ 02191000
*   /* STAIRTN SUBROUTINE                                            */ 02192000
*   /*                                                               */ 02193000
*   /*****************************************************************/ 02194000
*                                                                  0717 02195000
*STAIRTN:                                                          0717 02196000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);                          0717 02197000
*                                                                  0717 02198000
STAIRTN  DS    0H                                                  0718 02199000
*/* STAIRTN: CHART BEGIN SUBROUTINE FLOWCHART                        */ 02200000
*/* FOOTING                                                        0718 02201000
*/* STAI/ESTAI PROCESSING FOR NEW TCB                                */ 02202000
*/********************************************************************/ 02203000
*/*                                                                  */ 02204000
*/*    PROCESS THE STAI/ESTAI PARAMETERS:                            */ 02205000
*/*                                                                  */ 02206000
*/*      IF THE STAI PARM WAS SPECIFIED, A STAI SCB IS BUILT AND     */ 02207000
*/*      CHAINED OFF THE NEW TCB, AND ANY STAI/ESTAI SCB'S ON THE    */ 02208000
*/*      CURRENT TCB ARE COPIED TO THE NEW TCB.                      */ 02209000
*/*                                                                  */ 02210000
*/*      IF THE ESTAI PARM WAS SPECIFIED, AN ESTAI SCB IS BUILT AND  */ 02211000
*/*      CHAINED OFF THE NEW TCB, AND ANY STAI/ESTAI SCB'S ON THE    */ 02212000
*/*      CURRENT TCB ARE COPIED TO THE NEW TCB.                      */ 02213000
*/*                                                                  */ 02214000
*/*      IF NEITHER STAI NOR ESTAI WAS SPECIFIED, AN ESTAI REQUEST   */ 02215000
*/*      IS ISSUED SPECIFYING THE PROP OPTION, WHICH CAUSES ANY      */ 02216000
*/*      STAI/ESTAI SCB'S ON THE CURRENT TCB TO BE COPIED TO THE NEW */ 02217000
*/*      TCB. IF NO SUCH SCB'S EXIST, THE NEW TCB'S TCBSTAB FIELD    */ 02218000
*/*      WILL BE ZERO UPON RETURN FROM SVC 60.                       */ 02219000
*/*                                                                  */ 02220000
*/* SUBROUTINES CALLED: NONE                                         */ 02221000
*/*                                                                  */ 02222000
*/* SYSTEM ROUTINES CALLED / MACROS ISSUED: SVC 60 (STAI/ESTAI)      */ 02223000
*/*                                                                  */ 02224000
*/* RETURN CODES SET: X08STAI, ABEND52A, ABEND92A (X'00' AND X'0C'   */ 02225000
*/*                   SET BY SVC 60)                                 */ 02226000
*/*                                                                  */ 02227000
*/* REGISTER USAGE: R15RETCD - OUTPUT, RETURN CODE                   */ 02228000
*/*                                                                  */ 02229000
*/* LEVEL - 1                                                        */ 02230000
*/*                                                                  */ 02231000
*/********************************************************************/ 02232000
*/* E ENTER STAIRTN                                                  */ 02233000
*                                                                  0718 02234000
*   RFY                                                            0718 02235000
*     R14RET RSTD;                                                 0718 02236000
*   WKRTSAVE=R14RET;                /* SAVE AROUND SVC               */ 02237000
         ST    R14RET,WKRTSAVE(,R3WORKAD)                          0719 02238000
*   RFY                                                            0720 02239000
*     R14RET UNRSTD;                                               0720 02240000
*                                                                  0720 02241000
*/* P CLEAR THE SVC 60 PARM LIST TO ZERO                             */ 02242000
*                                                                  0721 02243000
*   RFY                                                            0721 02244000
*     R1ESTAE RSTD;                                                0721 02245000
*   R1ESTAE=ADDR(WKTEMP1);          /* ADDR OF SVC 60 PARM LIST      */ 02246000
         LA    R1ESTAE,WKTEMP1(,R3WORKAD)                          0722 02247000
*   AREA(1:LENGTH(ESTA))=AREA(1:LENGTH(ESTA))&&AREA(1:LENGTH(ESTA));    02248000
*                                                                  0723 02249000
         XC    AREA(16,R1AREA),AREA(R1AREA)                        0723 02250000
*/* P INDICATE STAI/ESTAI REQUEST IN PARM LIST                       */ 02251000
*                                                                  0724 02252000
*   ESTASTAI='1'B;                  /* INDICATE STAI/ESTAI           */ 02253000
         OI    ESTASTAI(ESTAPTR),B'10000000'                       0724 02254000
*/* P SET ADDR NEW TCB IN PARM LIST                                  */ 02255000
*                                                                  0725 02256000
*   ESTAOWNR=R5NEWTCB;              /* NEW TCB ADDR USED FOR       0725 02257000
*                                      STAI/ESTAI (I.E., FOR ATTACH     02258000
*                                      PROCESSING).                  */ 02259000
         ST    R5NEWTCB,ESTAOWNR(,ESTAPTR)                         0725 02260000
*/* D (NO,%FL01120,YES,) WAS STAI OR ESTAI SPECIFIED ?               */ 02261000
*                                                                  0726 02262000
*   IF ATTSTAI='1'B THEN                                           0726 02263000
         TM    ATTSTAI(R3WORKAD),B'00000001'                       0726 02264000
         BNO   @RF00726                                            0726 02265000
*     DO;                           /* DO000012: BUILD CREATE-TYPE 0727 02266000
*                                      LIST                          */ 02267000
*/* D (NO,%FL01130,YES,) WAS ESTAI SPECIFIED ?                       */ 02268000
*                                                                  0728 02269000
*       IF ATESTAI='1'B THEN                                       0728 02270000
         TM    ATESTAI(R3WORKAD),B'00001000'                       0728 02271000
         BNO   @RF00728                                            0728 02272000
*         DO;                       /* DO000013: PROCESS ESTAI PARMS    02273000
*                                      SPECIFIED ON ATTACH MACRO     */ 02274000
*/* P INDICATE ESTAI REQUEST IN PARM LIST                            */ 02275000
*                                                                  0730 02276000
*           ESTAESTA='1'B;          /* CREATE ESTAI-SCB PARM         */ 02277000
         OI    ESTAESTA(ESTAPTR),B'00010000'                       0730 02278000
*           WKESTAI='1'B;           /* INDICATE ESTAI SPECIFIED      */ 02279000
         OI    WKESTAI(R12SVRB),B'00010000'                        0731 02280000
*/* D (NO,%FL01130,YES,) WAS TERM=YES SPECIFIED ON ATTACH?           */ 02281000
*                                                                  0732 02282000
*           IF ATTERM='1'B THEN                                    0732 02283000
*                                                                  0732 02284000
         TM    ATTERM(R3WORKAD),B'00010000'                        0732 02285000
         BNO   @RF00732                                            0732 02286000
*/* P INDICATE TERM OPTION IN PARM LIST                              */ 02287000
*                                                                  0733 02288000
*             ESTATERM='1'B;        /* SPECIFY TERM OPTION           */ 02289000
         OI    ESTATERM(ESTAPTR),B'01000000'                       0733 02290000
*         END;                      /* END00013: END ESTAI PARM    0734 02291000
*                                      PROCESSING                    */ 02292000
*                                                                  0734 02293000
@RF00732 DS    0H                                                  0735 02294000
*       /*************************************************************/ 02295000
*       /*                                                           */ 02296000
*       /* PROCESS PARAMETERS COMMON TO STAI AND ESTAI               */ 02297000
*       /*                                                           */ 02298000
*       /*************************************************************/ 02299000
*                                                                  0735 02300000
*/* %FL01130: D (NO,%FL01140,YES,)    ASYNC=YES SPECIFIED ?          */ 02301000
*                                                                  0735 02302000
*       IF ATSYNCH='1'B THEN                                       0735 02303000
*                                                                  0735 02304000
@RF00728 TM    ATSYNCH(R3WORKAD),B'00000100'                       0735 02305000
         BNO   @RF00735                                            0735 02306000
*/* P INDICATE ASYNCHRONOUS INTERRUPTS ALLOWED                       */ 02307000
*                                                                  0736 02308000
*         ESTASYNC='1'B;            /* SPECIFY ALLOW ASYNCHRONOUS  0736 02309000
*                                      INTERRUPTS                    */ 02310000
         OI    ESTASYNC(ESTAPTR),B'00000100'                       0736 02311000
*/* %FL01140: P SET FLAGS IN ACCORDANCE WITH PURGE SUBPARAMETER      */ 02312000
*                                                                  0737 02313000
*       ESTAFLG1=ESTAFLG1|(ATSTAIF&PURGMASK);/* PURGE FLAGS          */ 02314000
@RF00735 LA    @08,3                                               0737 02315000
         SLR   @07,@07                                             0737 02316000
         IC    @07,ATSTAIF(,R3WORKAD)                              0737 02317000
         NR    @08,@07                                             0737 02318000
         SLR   @07,@07                                             0737 02319000
         IC    @07,ESTAFLG1(,ESTAPTR)                              0737 02320000
         OR    @08,@07                                             0737 02321000
         STC   @08,ESTAFLG1(,ESTAPTR)                              0737 02322000
*/* P SET USER PARM LIST ADDR                                        */ 02323000
*                                                                  0738 02324000
*       ESTAPARM=ATSTAIA;           /* PARM LIST ADDR FOR EXIT RTN   */ 02325000
         SLR   @08,@08                                             0738 02326000
         ICM   @08,7,ATSTAIA(R3WORKAD)                             0738 02327000
         ST    @08,ESTAPARM(,ESTAPTR)                              0738 02328000
*/* P SET EXIT ROUTINE ADDRESS                                       */ 02329000
*                                                                  0739 02330000
*       ESTAEXIT=ATSTAIXT;          /* EXIT RTN ADDR                 */ 02331000
         MVC   ESTAEXIT(3,ESTAPTR),ATSTAIXT(R3WORKAD)              0739 02332000
*/* P (,%FL01150) SET REG0=0 FOR CREATE                              */ 02333000
*                                                                  0740 02334000
*       RFY                                                        0740 02335000
*         R0WORK RSTD;                                             0740 02336000
*       R0WORK=CTSTAI;              /* ZERO: CREATE REQUEST          */ 02337000
         SLR   R0WORK,R0WORK                                       0741 02338000
*     END;                          /* END00012: END OF BUILDING   0742 02339000
*                                      CREATE LIST                   */ 02340000
*                                                                  0742 02341000
*   /*****************************************************************/ 02342000
*   /*                                                               */ 02343000
*   /* NEITHER STAI NOR ESTAI SPECIFIED, ISSUE ESTAI PROP REQUEST TO */ 02344000
*   /* PROPAGATE ANY EXISTING STAI/ESTAI SCB'S.                      */ 02345000
*   /*                                                               */ 02346000
*   /*****************************************************************/ 02347000
*                                                                  0743 02348000
*   ELSE                            /* PROPAGATE                     */ 02349000
*     DO;                           /* DO000014: BUILD PROPAGATE-TYPE   02350000
*                                      LIST                          */ 02351000
         B     @RC00726                                            0743 02352000
@RF00726 DS    0H                                                  0744 02353000
*/* %FL01120: P SET ESTAESTA=1, ESTASTAI=1, REG0 =2 FOR PROP         */ 02354000
*                                                                  0744 02355000
*       ESTAESTA='1'B;              /* INDICATE ESTAI REQUEST        */ 02356000
         OI    ESTAESTA(ESTAPTR),B'00010000'                       0744 02357000
*       WKESTAI='1'B;               /* INDICATE ESTAI SPECIFIED      */ 02358000
         OI    WKESTAI(R12SVRB),B'00010000'                        0745 02359000
*       R0WORK=PROPSTAI;            /* CODE 2: PROPAGATE REQUEST     */ 02360000
         LA    R0WORK,2                                            0746 02361000
*     END;                          /* END00014: END OF BUILDING PROP   02362000
*                                      LIST                          */ 02363000
*/* %FL01150: L STAI/ESTAI: PROCESS REQUEST                          */ 02364000
*                                                                  0748 02365000
*   RFY                                                            0748 02366000
*     R15RETCD RSTD;                                               0748 02367000
@RC00726 DS    0H                                                  0749 02368000
*   SVC(SIXTY);                     /* ISSUE STAI/ESTAI SVC          */ 02369000
         SVC   60                                                  0749 02370000
*   RFY                                                            0750 02371000
*     R0WORK UNRSTD;                                               0750 02372000
*                                                                  0750 02373000
*/* D (NO,AT001400,YES,) ANY ERRORS ?                                */ 02374000
*                                                                  0751 02375000
*   IF R15RETCD^=X00NOERR THEN                                     0751 02376000
         LTR   R15RETCD,R15RETCD                                   0751 02377000
         BZ    @RF00751                                            0751 02378000
*     DO;                           /* DO000015: DETERMINE ERROR   0752 02379000
*                                      INDICATION                    */ 02380000
*                                                                  0752 02381000
*       /*************************************************************/ 02382000
*       /*                                                           */ 02383000
*       /* STAI/ESTAI ERROR DETERMINATION: THE APPROPRIATE RETURN    */ 02384000
*       /* CODE OR ABEND CODE IS DETERMINED BEFORE CLEANING UP.      */ 02385000
*       /*                                                           */ 02386000
*       /*************************************************************/ 02387000
*                                                                  0753 02388000
*/* D (STAI,%FL01170,E.,) WAS STAI OR ESTAI PERFORMED ?              */ 02389000
*                                                                  0753 02390000
*       IF WKESTAI='1'B THEN                                       0753 02391000
         TM    WKESTAI(R12SVRB),B'00010000'                        0753 02392000
         BNO   @RF00753                                            0753 02393000
*         DO;                       /* DO000094: ESTAI RETURN CODE   */ 02394000
*/* D (NO,%FL01180,YES,) WAS PROP SPECIFIED ?                        */ 02395000
*                                                                  0755 02396000
*           IF ATTSTAI='0'B THEN                                   0755 02397000
*                                                                  0755 02398000
         TM    ATTSTAI(R3WORKAD),B'00000001'                       0755 02399000
         BNZ   @RF00755                                            0755 02400000
*/* P (,AT001400) INDICATE ABEND CODE 52A                            */ 02401000
*                                                                  0756 02402000
*             DO;                   /* DO000016: SET CODE            */ 02403000
*               R15RETCD=ABEND52A;  /* INDICATE ABEND CODE 52A       */ 02404000
         LA    R15RETCD,1322                                       0757 02405000
*               GOTO AT001400;      /* GO EXIT SUBROUTINE            */ 02406000
         B     AT001400                                            0758 02407000
*             END;                  /* END00016: CODE SET            */ 02408000
*/* %FL01180: D (YES,AT001410,NO,) WAS RETURN CODE X'14' ?           */ 02409000
*                                                                  0760 02410000
*           ELSE                                                   0760 02411000
*             IF R15RETCD=STAICD14 THEN/* ELSE IF X'14'              */ 02412000
@RF00755 CH    R15RETCD,@CH02683                                   0760 02413000
         BE    @RT00760                                            0760 02414000
*               GOTO AT001410;      /* GO SET RETURN CODE X'08'      */ 02415000
*         END;                      /* END00094: END ESTAI CODE CHECK*/ 02416000
*                                                                  0762 02417000
*       /*************************************************************/ 02418000
*       /*                                                           */ 02419000
*       /* STAI ERROR, VERSES ESTAI                                  */ 02420000
*       /*                                                           */ 02421000
*       /*************************************************************/ 02422000
*                                                                  0763 02423000
*       ELSE                                                       0763 02424000
*         DO;                       /* DO000096: STAI RETURN CODE    */ 02425000
         B     @RC00753                                            0763 02426000
@RF00753 DS    0H                                                  0764 02427000
*/* %FL01170: D (NO,%FL01160,YES,) WAS RETURN CODE X'04' ?           */ 02428000
*                                                                  0764 02429000
*           IF R15RETCD=STAICD04 THEN                              0764 02430000
*                                                                  0764 02431000
         CH    R15RETCD,@CH02677                                   0764 02432000
         BNE   @RF00764                                            0764 02433000
*/* AT001410: P (,AT001400) SET RETURN CODE X'08'                    */ 02434000
*                                                                  0765 02435000
*AT001410:                                                         0765 02436000
*             DO;                   /* DO000017: SET CODE,         0765 02437000
*                                      INSUFFICIENT CORE             */ 02438000
AT001410 DS    0H                                                  0766 02439000
*               R15RETCD=X08STAI;   /* SET CODE X'08'                */ 02440000
         LA    R15RETCD,8                                          0766 02441000
*               GOTO AT001400;      /* GO EXIT SUBROUTINE            */ 02442000
         B     AT001400                                            0767 02443000
*             END;                  /* END00017: CODE SET            */ 02444000
*/* %FL01160: D (YES,AT001400,NO,) WAS RETURN CODE X'0C' ?           */ 02445000
*                                                                  0769 02446000
*           IF R15RETCD=STAICD0C THEN                              0769 02447000
@RF00764 CH    R15RETCD,@CH02681                                   0769 02448000
         BE    @RT00769                                            0769 02449000
*             GOTO AT001400;        /* GO CLEAN UP (SAME RET CODE)   */ 02450000
*         END;                      /* END00096: END STAI CODE CHECK */ 02451000
*/* FOR OTHER THAN THE SPECIFIC CODES CHECKED, INDICATE ABEND 92A    */ 02452000
*/* %FL01190: P INDICATE ABEND CODE 92A                              */ 02453000
*                                                                  0772 02454000
*       WKREASON=RCODE8;            /* SET REASON CODE               */ 02455000
@RC00753 MVI   WKREASON(R12SVRB),X'08'                             0772 02456000
*       R15RETCD=ABEND92A;          /* ABEND: INDETERMINANT ERROR    */ 02457000
         LA    R15RETCD,2346                                       0773 02458000
*     END;                          /* END00015: END STAI/ESTAI ERROR   02459000
*                                      CHECK                         */ 02460000
*/* AT001400: R RETURN TO CALLING POINT                              */ 02461000
*                                                                  0775 02462000
*   RFY                                                            0775 02463000
*     R14RET RSTD;                                                 0775 02464000
@RF00751 DS    0H                                                  0776 02465000
*AT001400:                                                         0776 02466000
*   R14RET=WKRTSAVE;                /* RETURN ADDRESS                */ 02467000
AT001400 L     R14RET,WKRTSAVE(,R3WORKAD)                          0776 02468000
*/* STAIRTN: END  FLOWCHART                                          */ 02469000
*                                                                  0777 02470000
*   END STAIRTN;                    /* END OF SUBROUTINE             */ 02471000
@EL00005 DS    0H                                                  0777 02472000
@EF00005 DS    0H                                                  0777 02473000
@ER00005 BR    @14                                                 0777 02474000
*   RFY                                                            0778 02475000
*     R14RET UNRSTD;                                               0778 02476000
*   RFY                                                            0779 02477000
*     R1ESTAE UNRSTD;                                              0779 02478000
*   RFY                                                            0780 02479000
*     R15RETCD UNRSTD;                                             0780 02480000
*                                                                  0781 02481000
*   /*****************************************************************/ 02482000
*   /*                                                               */ 02483000
*   /* PRIORITY SUBROUTINE                                           */ 02484000
*   /*                                                               */ 02485000
*   /*****************************************************************/ 02486000
*                                                                  0781 02487000
*PRIORITY:                                                         0781 02488000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/* ENTRY POINT              */ 02489000
PRIORITY DS    0H                                                  0782 02490000
*/* PRIORITY: CHART BEGIN SUBROUTINE FLOWCHART                       */ 02491000
*/* FOOTING                                                        0782 02492000
*/* SUBROUTINE WHICH SETS NEW TASK PRIORITIES                        */ 02493000
*/********************************************************************/ 02494000
*/*                                                                  */ 02495000
*/*    SUBROUTINE PROCESSES LIMIT AND DISPATCHING PRIORITIES.        */ 02496000
*/* SUBROUTINES CALLED: NONE                                         */ 02497000
*/*                                                                  */ 02498000
*/* SYSTEM ROUTINES CALLED/MACROS ISSUED: NONE                       */ 02499000
*/*                                                                  */ 02500000
*/* RETURN CODES SET: NONE                                           */ 02501000
*/*                                                                  */ 02502000
*/* REGISTER USAGE: NORMAL                                           */ 02503000
*/*                                                                  */ 02504000
*/* LEVEL - 1                                                        */ 02505000
*/*                                                                  */ 02506000
*/********************************************************************/ 02507000
*/* E ENTER PRIORITY                                                 */ 02508000
*/* P CALCULATE NEW LIMIT PRIORITY                                   */ 02509000
*                                                                  0782 02510000
*   RFY                                                            0782 02511000
*     R0WORK RSTD;                                                 0782 02512000
*   R0WORK=R4CURTCB->TCBLMP;        /* CURRENT TASK LIMIT            */ 02513000
         SLR   R0WORK,R0WORK                                       0783 02514000
         IC    R0WORK,TCBLMP(,R4CURTCB)                            0783 02515000
*   R0WORK=R0WORK-ATLPMOD;          /* NEW LIMIT = OLD - PARM VALUE  */ 02516000
         SLR   @08,@08                                             0784 02517000
         IC    @08,ATLPMOD(,R3WORKAD)                              0784 02518000
         SLR   R0WORK,@08                                          0784 02519000
*/* D (NO,%FL01280,YES,) IS NEW LIMIT > 0 ?                          */ 02520000
*                                                                  0785 02521000
*   IF R0WORK>ZERO THEN                                            0785 02522000
*                                                                  0785 02523000
         LTR   R0WORK,R0WORK                                       0785 02524000
         BNP   @RF00785                                            0785 02525000
*/* P SET NEW TCB'S TCBLP = CALC VALUE                               */ 02526000
*                                                                  0786 02527000
*     R5NEWTCB->TCBLMP=R0WORK;      /* STORE NEW LIMIT INTO NEW TCB     02528000
*                                      OR LEAVE FIELD ZERO IF NEG    */ 02529000
         STC   R0WORK,TCBLMP(,R5NEWTCB)                            0786 02530000
*/* %FL01280: P CALCULATE NEW DISPATCHING PRIORITY                   */ 02531000
*                                                                  0787 02532000
*   RFY                                                            0787 02533000
*     R7WORK RSTD;                                                 0787 02534000
@RF00785 DS    0H                                                  0788 02535000
*   R7WORK=R4CURTCB->TCBDSP;        /* CURRENT DISPATCHING           */ 02536000
         SLR   R7WORK,R7WORK                                       0788 02537000
         IC    R7WORK,TCBDSP(,R4CURTCB)                            0788 02538000
*   R7WORK=R7WORK+ATDPMOD;          /* PLUS PARM VALUE = NEW DISP    */ 02539000
         AH    R7WORK,ATDPMOD(,R3WORKAD)                           0789 02540000
*/* D (NO,%FL01290,YES,) IS NEW DISP > 0 ?                           */ 02541000
*                                                                  0790 02542000
*   IF R7WORK>ZERO THEN                                            0790 02543000
*                                                                  0790 02544000
         LTR   R7WORK,R7WORK                                       0790 02545000
         BNP   @RF00790                                            0790 02546000
*/* D (YES,%FL01300,NO,) IS NEW DISP > NEW LIMIT ?                   */ 02547000
*                                                                  0791 02548000
*     DO;                           /* DO000099                      */ 02549000
*       IF R7WORK<R0WORK THEN       /* COMPARE                       */ 02550000
         CR    R7WORK,R0WORK                                       0792 02551000
         BNL   @RF00792                                            0792 02552000
*/* P (,%FL01290) SET NEW TCB'S TCBDSP = DISP VALUE                  */ 02553000
*                                                                  0793 02554000
*         R5NEWTCB->TCBDSP=R7WORK;  /* NEW DISP = CALC VALUE         */ 02555000
         STC   R7WORK,TCBDSP(,R5NEWTCB)                            0793 02556000
*/* %FL01300: P SET NEW TCB'S TCBDSP = NEW TCB'S TCBLMP              */ 02557000
*                                                                  0794 02558000
*       ELSE                                                       0794 02559000
*         R5NEWTCB->TCBDSP=R5NEWTCB->TCBLMP;/* NEW DISP = NEW LIMIT  */ 02560000
         B     @RC00792                                            0794 02561000
@RF00792 MVC   TCBDSP(1,R5NEWTCB),TCBLMP(R5NEWTCB)                 0794 02562000
*     END;                          /* END00099: LEAVE NEW TCB'S   0795 02563000
*                                      TCBLMP = 0 IF CALC VALUE    0795 02564000
*                                      NEGITIVE                      */ 02565000
*/* %FL01290: R RETURN TO CALLING POINT                              */ 02566000
*/* PRIORITY: END  FLOWCHART                                         */ 02567000
*                                                                  0796 02568000
*   END PRIORITY;                   /* END OF SUBROUTINE             */ 02569000
@EL00006 DS    0H                                                  0796 02570000
@EF00006 DS    0H                                                  0796 02571000
@ER00006 BR    @14                                                 0796 02572000
*   RFY                                                            0797 02573000
*     R0WORK UNRSTD;                                               0797 02574000
*   RFY                                                            0798 02575000
*     R7WORK UNRSTD;                                               0798 02576000
*                                                                  0799 02577000
*   /*****************************************************************/ 02578000
*   /*                                                               */ 02579000
*   /* SPCONTRL SUBROUTINE                                           */ 02580000
*   /*                                                               */ 02581000
*   /*****************************************************************/ 02582000
*                                                                  0799 02583000
*SPCONTRL:                                                         0799 02584000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/* ENTRY POINT              */ 02585000
SPCONTRL DS    0H                                                  0800 02586000
*/* SPCONTRL: CHART GIVE-SHARE SUBPOOL CONTROL ROUTINE               */ 02587000
*/* FOOTING                                                        0800 02588000
*/* SUBROUTINE WHICH PROCESSES GIVE AND SHARE REQUESTS               */ 02589000
*/********************************************************************/ 02590000
*/*                                                                  */ 02591000
*/*    SUBROUTINE SPCONTRL HANDLES THE GSPV, GSPL, SHSPV, SHSPL, AND */ 02592000
*/*    SZERO=YES PARAMETERS.                                         */ 02593000
*/*                                                                  */ 02594000
*/* SUBROUTINES CALLED: GIVESP, SHARESP, MOVELIST                    */ 02595000
*/*                                                                  */ 02596000
*/* SYSTEM ROUTINES CALLED / MACROS ISSUED: NONE                     */ 02597000
*/*                                                                  */ 02598000
*/* RETURN CODES SET: NONE (RETURN CODE FROM GIVESP OR SHARESP IS    */ 02599000
*/*                   RETURNED BY THIS SUBROUTINE)                   */ 02600000
*/*                                                                  */ 02601000
*/* REGISTER USAGE: R1WORK - ENTRY CODE:                             */ 02602000
*/*                                 0 - GSPV/GSPL                    */ 02603000
*/*                                 1 - SHSPV/SHSPL                  */ 02604000
*/*                                 2 - SHARE SUBPOOL ZERO           */ 02605000
*/*                                                                  */ 02606000
*/* LEVEL - 1                                                        */ 02607000
*/*                                                                  */ 02608000
*/********************************************************************/ 02609000
*/* E ENTER SPCONTRL                                                 */ 02610000
*                                                                  0800 02611000
*   RFY                                                            0800 02612000
*     R14RET RSTD;                                                 0800 02613000
*   WKRTSAVE=R14RET;                /* SAVE                          */ 02614000
         ST    R14RET,WKRTSAVE(,R3WORKAD)                          0801 02615000
*   RFY                                                            0802 02616000
*     R14RET UNRSTD;                                               0802 02617000
*   RFY                                                            0803 02618000
*     R1WORK RSTD;                                                 0803 02619000
*   RFY                                                            0804 02620000
*     R11PTR RSTD;                                                 0804 02621000
*                                                                  0804 02622000
*/* D (NO,%FL01350,YES,) SHARE ENTRY CODE                            */ 02623000
*                                                                  0805 02624000
*   IF R1WORK^=ENTCD0 THEN                                         0805 02625000
         LTR   R1WORK,R1WORK                                       0805 02626000
         BZ    @RF00805                                            0805 02627000
*     DO;                           /* DO000021                      */ 02628000
*/* P SET BRANCH REGISTER TO ADDR OF SHARESP                         */ 02629000
*                                                                  0807 02630000
*       R11PTR=ADDR(SHARESP);       /* SHARE SUBPOOL ENTRY CODES     */ 02631000
         LA    R11PTR,SHARESP                                      0807 02632000
*/* D (2,AT001350,1,) CHECK ENTRY CODE                               */ 02633000
*                                                                  0808 02634000
*       IF R1WORK=ENTCD1 THEN                                      0808 02635000
*                                                                  0808 02636000
         CH    R1WORK,@CH00061                                     0808 02637000
         BNE   @RF00808                                            0808 02638000
*/* P (,%FL01370) SET LIST ADDRESS TO SHSPV/SHSPL PARM ADDR          */ 02639000
*                                                                  0809 02640000
*         R1WORK=ADDR(ATSHFLDA);    /* ADDR OF SHARE LIST - VALUE    */ 02641000
         LA    R1WORK,ATSHFLDA(,R3WORKAD)                          0809 02642000
*       ELSE                                                       0810 02643000
*         GOTO AT001350;            /* GO SHARE SP 0, ENTRY CODE=2   */ 02644000
*     END;                          /* END00021: ENTRY CODE=0, GIVE     02645000
*                                      SUBPOOL                       */ 02646000
*/* %FL01350: P SET BRANCH REGISTER TO ADDR OF GIVESP                */ 02647000
*                                                                  0812 02648000
*   ELSE                                                           0812 02649000
*     DO;                           /* DO000092                      */ 02650000
         B     @RC00805                                            0812 02651000
@RF00805 DS    0H                                                  0813 02652000
*       R11PTR=ADDR(GIVESP);        /* GIVE SUBPOOL ENTRY CODE       */ 02653000
         LA    R11PTR,GIVESP                                       0813 02654000
*/* P SET LIST ADDRESS TO GSPV/GSPL PARM ADDR                        */ 02655000
*                                                                  0814 02656000
*       R1WORK=ADDR(ATGSFLDA);      /* ADDRESS OF GIVE LIST - VALUE  */ 02657000
         LA    R1WORK,ATGSFLDA(,R3WORKAD)                          0814 02658000
*     END;                          /* END00092                      */ 02659000
*                                                                  0816 02660000
*   /*****************************************************************/ 02661000
*   /*                                                               */ 02662000
*   /* COMMON PROCESSING FOR GIVE/SHARE PARAMETERS.IF GSPV OR SHSPV  */ 02663000
*   /* WAS SPECIFIED, THE APPROPRIATE SUBROUTINE, GIVESP OR SHARESP, */ 02664000
*   /* RESPECTIVELY, IS CALLED TO PROCESS THE SINGLE REQUEST, BY     */ 02665000
*   /* BRANCHING ON THE BRANCH REGISTER SET ABOVE. IF GSPL OR SHSPL  */ 02666000
*   /* WAS SPECIFIED, THE LIST IS VALIDITY CHECKED AND MOVED INTO    */ 02667000
*   /* ATTACH'S WORKAREA, BY SUBROUTINE MOVELIST, AND THE REQUESTS   */ 02668000
*   /* ARE PROCESSED INDIVIDUALLY, IN A LOOP.                        */ 02669000
*   /*                                                               */ 02670000
*   /*****************************************************************/ 02671000
*                                                                  0816 02672000
*/* %FL01370: D (NO,%FL01380,YES,) WAS A VALUE SPECIFIED ?           */ 02673000
*                                                                  0816 02674000
*   IF R1WORK->FLAGBIT7='0'B THEN   /* BIT 7 OF PARM WORD =0,VALUE   */ 02675000
@RC00805 TM    FLAGBIT7(R1WORK),B'00000001'                        0816 02676000
         BNZ   @RF00816                                            0816 02677000
*     DO;                           /* DO000023: PROCESS SINGLE    0817 02678000
*                                      REQUEST                       */ 02679000
*/* P GET VALUE FROM PARM LIST                                       */ 02680000
*                                                                  0818 02681000
*       RFY                                                        0818 02682000
*         R0WORK RSTD;                                             0818 02683000
*       R0WORK=R1WORK->BYTE3;       /* VALUE FROM LOW ORDER PARM BYTE*/ 02684000
         SLR   R0WORK,R0WORK                                       0819 02685000
         IC    R0WORK,BYTE3(,R1WORK)                               0819 02686000
*/* S (,AT001150)  : PROCESS SINGLE REQUEST                          */ 02687000
*                                                                  0820 02688000
*       CALL R11PTR->SUBRTINE;      /* PROCESS REQUEST               */ 02689000
         LR    @15,R11PTR                                          0820 02690000
         BALR  @14,@15                                             0820 02691000
*       GOTO AT001150;              /* GOTO SUBROUTINE EXIT POINT    */ 02692000
         B     AT001150                                            0821 02693000
*     END;                          /* END00023: END VALUE PROCESSING*/ 02694000
*                                                                  0822 02695000
*   /*****************************************************************/ 02696000
*   /*                                                               */ 02697000
*   /* LIST ADRESS WAS SPECIFIED, PROCESS ALL REQUESTS               */ 02698000
*   /*                                                               */ 02699000
*   /*****************************************************************/ 02700000
*                                                                  0823 02701000
*/* %FL01380: S MOVELIST: VALID CHK AND FETCH LIST LENGTH            */ 02702000
*                                                                  0823 02703000
*   RFY                                                            0823 02704000
*     R7WORK RSTD;                                                 0823 02705000
@RF00816 DS    0H                                                  0824 02706000
*   RFY                                                            0824 02707000
*     R8WORK RSTD;                                                 0824 02708000
*   R7WORK=R1WORK->BYTES123;        /* ADDRESS OF LIST               */ 02709000
         SLR   R7WORK,R7WORK                                       0825 02710000
         ICM   R7WORK,7,BYTES123(R1WORK)                           0825 02711000
*   R0WORK=ONE;                     /* FIRST BYTE = LENGTH REMAINING */ 02712000
         LA    R0WORK,1                                            0826 02713000
*   R8WORK=ADDR(WKTEMP1);           /* ADDRESS OF SUBLIST            */ 02714000
         LA    R8WORK,WKTEMP1(,R3WORKAD)                           0827 02715000
*   CALL MOVELIST;                  /* GET FIRST BYTE = LENGTH       */ 02716000
         BAL   @14,MOVELIST                                        0828 02717000
*   R7WORK=R7WORK+ONE;              /* ADDRESS OF FIRST LIST ENTRY,     02718000
*                                      IF ANY                        */ 02719000
         AH    R7WORK,@CH00061                                     0829 02720000
*   RFY                                                            0830 02721000
*     R2WORK RSTD;                                                 0830 02722000
*   RFY                                                            0831 02723000
*     R1WORK UNRSTD;                                               0831 02724000
*                                                                  0831 02725000
*/* P SET LENGTH REG TO NUMBER ENTRIES IN SUBLIST                    */ 02726000
*                                                                  0832 02727000
*   R2WORK=R8WORK->BYTE0;           /* GET LENGTH REMAINDER OF LIST  */ 02728000
         SLR   R2WORK,R2WORK                                       0832 02729000
         IC    R2WORK,BYTE0(,R8WORK)                               0832 02730000
*   RFY                                                            0833 02731000
*     R10LOOPC RSTD;                                               0833 02732000
*   DO WHILE R2WORK^=ZERO;          /* DO000025: PROCESS ENTIRE LIST */ 02733000
         B     @DE00834                                            0834 02734000
@DL00834 DS    0H                                                  0835 02735000
*     R8WORK=ADDR(WKTEMP1);         /* REINITIALIZE SUBLIST ADDR     */ 02736000
         LA    R8WORK,WKTEMP1(,R3WORKAD)                           0835 02737000
*/* %FL01430: D (YES,%FL01390,NO,) LENGTH REMAINING < MAX ?          */ 02738000
*                                                                  0836 02739000
*     IF R2WORK>LENGTH(WKTEMPS) THEN                               0836 02740000
         LA    @01,32                                              0836 02741000
         CR    R2WORK,@01                                          0836 02742000
         BNH   @RF00836                                            0836 02743000
*       DO;                         /* DO000024: MOVE MAX NUMBER   0837 02744000
*                                      ENTRIES                       */ 02745000
*/* S MOVELIST: MOVE MAX LIST ENTRIES TO SUBLIST                     */ 02746000
*                                                                  0838 02747000
*         R0WORK=LENGTH(WKTEMPS);   /* MAXIMUN LENGTH                */ 02748000
         LR    R0WORK,@01                                          0838 02749000
*         CALL MOVELIST;            /* VALID CHK AND MOVE MAX ENTRIES*/ 02750000
         BAL   @14,MOVELIST                                        0839 02751000
*         R7WORK=R7WORK+LENGTH(WKTEMPS);/* UPDATE PTR TO NEXT IN LIST*/ 02752000
         LA    @01,32                                              0840 02753000
         ALR   R7WORK,@01                                          0840 02754000
*/* P LENGTH REG = LENGTH REG - MAX                                  */ 02755000
*                                                                  0841 02756000
*         R2WORK=R2WORK-LENGTH(WKTEMPS);/* NUMBER REMAINING LIST   0841 02757000
*                                      ENTRIES                       */ 02758000
         SLR   R2WORK,@01                                          0841 02759000
*/* P (,%FL01420) LOOP CONTROL REG = MAX                             */ 02760000
*                                                                  0842 02761000
*         R10LOOPC=LENGTH(WKTEMPS); /* NUMBER ENTRIES IN SUBLIST     */ 02762000
         LR    R10LOOPC,@01                                        0842 02763000
*       END;                        /* END00024: END MAX MOVE        */ 02764000
*     ELSE                          /* MOVE REMAINING BYTES          */ 02765000
*       DO;                         /* DO000026: MOVE REMAINDER      */ 02766000
         B     @RC00836                                            0844 02767000
@RF00836 DS    0H                                                  0845 02768000
*/* %FL01390: S MOVELIST: MOVE REMAINDER OF LIST ENTRIES TO SUBLIST  */ 02769000
*                                                                  0845 02770000
*         R0WORK=R2WORK;            /* LENGTH REMAINING IN LIST      */ 02771000
         LR    R0WORK,R2WORK                                       0845 02772000
*         CALL MOVELIST;            /* MOVE LAST OF LIST TO SUBLIST  */ 02773000
         BAL   @14,MOVELIST                                        0846 02774000
*/* P SET LOOP CONTROL TO NUMBER ENTRIES IN SUBLIST                  */ 02775000
*                                                                  0847 02776000
*         R10LOOPC=R2WORK;          /* NUMBER OF ENTRIES IN SUBLIST  */ 02777000
         LR    R10LOOPC,R2WORK                                     0847 02778000
*/* P SET LENGTH REG TO ZERO                                         */ 02779000
*                                                                  0848 02780000
*         R2WORK=ZERO;              /* NO MORE ENTRIES TO PROCESS    */ 02781000
         SLR   R2WORK,R2WORK                                       0848 02782000
*       END;                        /* END00026: END REMAINDER MOVE  */ 02783000
*     DO R10LOOPC=R10LOOPC TO 1 BY-1;/* DO000027: SUBLIST LOOP       */ 02784000
@RC00836 B     @DE00850                                            0850 02785000
@DL00850 DS    0H                                                  0851 02786000
*/* %FL01420: S : PROCESS ONE ENTRY                                  */ 02787000
*                                                                  0851 02788000
*       R0WORK=R8WORK->ZBYTE;       /* GET SUBPOOL ID                */ 02789000
         SLR   R0WORK,R0WORK                                       0851 02790000
         IC    R0WORK,ZBYTE(,R8WORK)                               0851 02791000
*       CALL R11PTR->SUBRTINE;      /* CALL APPROPRIATE SUBROUTINE   */ 02792000
         LR    @15,R11PTR                                          0852 02793000
         BALR  @14,@15                                             0852 02794000
*       RFY                                                        0853 02795000
*         R15RETCD RSTD;                                           0853 02796000
*                                                                  0853 02797000
*/* D (YES,AT001150,NO,) ANY ERRORS ?                                */ 02798000
*                                                                  0854 02799000
*       IF R15RETCD^=X00NOERR THEN                                 0854 02800000
         LTR   R15RETCD,R15RETCD                                   0854 02801000
         BNZ   @RT00854                                            0854 02802000
*         GOTO AT001150;            /* GO TO EXIT FROM SUBROUTINE    */ 02803000
*       RFY                                                        0856 02804000
*         R15RETCD UNRSTD;                                         0856 02805000
*                                                                  0856 02806000
*/* P ENTRY PTR = ENTRY PTR + 1                                      */ 02807000
*                                                                  0857 02808000
*       R8WORK=R8WORK+ONE;          /* ADDRESS NEXT ENTRY IN SUBLIST */ 02809000
         AH    R8WORK,@CH00061                                     0857 02810000
*/* D (YES,%FL01420,NO,) MORE ENTRIES IN SUBLIST TO PROCESS ?        */ 02811000
*                                                                  0858 02812000
*     END;                          /* END00027: END SUBLIST LOOP    */ 02813000
         BCTR  R10LOOPC,0                                          0858 02814000
@DE00850 LTR   R10LOOPC,R10LOOPC                                   0858 02815000
         BP    @DL00850                                            0858 02816000
*/* D (YES,%FL01430,NO,AT001150) MORE ENTRIES IN LIST TO PROCESS ?   */ 02817000
*                                                                  0859 02818000
*   END;                            /* END00025: END LIST LOOP       */ 02819000
@DE00834 LTR   R2WORK,R2WORK                                       0859 02820000
         BNZ   @DL00834                                            0859 02821000
*   GOTO AT001150;                  /* GO EXIT SUBROUTINE            */ 02822000
         B     AT001150                                            0860 02823000
*   RFY                                                            0861 02824000
*     R10LOOPC UNRSTD;                                             0861 02825000
*                                                                  0861 02826000
*   /*****************************************************************/ 02827000
*   /*                                                               */ 02828000
*   /* PROCESS SHARING OF SUBPOOL ZERO, DONE AUTOMATICALLY, EXCEPT IN*/ 02829000
*   /* THE CASE WHERE A SYSTEM PROGRAM SPECIFIED SZERO=NO.           */ 02830000
*   /*                                                               */ 02831000
*   /*****************************************************************/ 02832000
*                                                                  0862 02833000
*/* AT001350: S SHARESP: SHARE SUBPOOL 0                             */ 02834000
*                                                                  0862 02835000
*AT001350:                                                         0862 02836000
*   R0WORK=ZERO;                    /* SUBPOOL ID = 0                */ 02837000
AT001350 SLR   R0WORK,R0WORK                                       0862 02838000
*   CALL R11PTR->SUBRTINE;          /* BRANCH REG CONTAINS ADDRESS OF   02839000
*                                      SHARESP SUBROUTINE            */ 02840000
         LR    @15,R11PTR                                          0863 02841000
         BALR  @14,@15                                             0863 02842000
*/* AT001150: R RETURN TO CALLING POINT                              */ 02843000
*                                                                  0864 02844000
*   RFY                                                            0864 02845000
*     R14RET RSTD;                                                 0864 02846000
*AT001150:                                                         0865 02847000
*   R14RET=WKRTSAVE;                /* RETURN ADDRESS                */ 02848000
AT001150 L     R14RET,WKRTSAVE(,R3WORKAD)                          0865 02849000
*/* SPCONTRL: END SUBROUTINE FLOWCHART                               */ 02850000
*                                                                  0866 02851000
*   END SPCONTRL;                   /* END SUBROUTINE SPCONTRL       */ 02852000
@EL00007 DS    0H                                                  0866 02853000
@EF00007 DS    0H                                                  0866 02854000
@ER00007 BR    @14                                                 0866 02855000
*   RFY                                                            0867 02856000
*     R14RET UNRSTD;                                               0867 02857000
*   RFY                                                            0868 02858000
*     R2WORK UNRSTD;                                               0868 02859000
*   RFY                                                            0869 02860000
*     R7WORK UNRSTD;                                               0869 02861000
*   RFY                                                            0870 02862000
*     R8WORK UNRSTD;                                               0870 02863000
*   RFY                                                            0871 02864000
*     R11PTR UNRSTD;                                               0871 02865000
*   RFY                                                            0872 02866000
*     R0WORK UNRSTD;                                               0872 02867000
*                                                                  0873 02868000
*   /*****************************************************************/ 02869000
*   /*                                                               */ 02870000
*   /* SHARESP SUBROUTINE                                            */ 02871000
*   /*                                                               */ 02872000
*   /*****************************************************************/ 02873000
*                                                                  0873 02874000
*SHARESP:                                                          0873 02875000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/* ENTRY POINT              */ 02876000
SHARESP  DS    0H                                                  0874 02877000
*/* SHARESP: CHART  BEGIN FLOWCHART                                  */ 02878000
*/* FOOTING                                                        0874 02879000
*/* SUBROUTINE SHARES ONE SUBPOOL                                    */ 02880000
*/********************************************************************/ 02881000
*/*                                                                  */ 02882000
*/*    SUBROUTINE SHARES A SINGLE SUBPOOL WITH 0 <= ID <= 127        */ 02883000
*/*                                                                  */ 02884000
*/*    SUBROUTINES CALLED: SPQESRCH, GETSPQE                         */ 02885000
*/*                                                                  */ 02886000
*/*    SYSTEM MACROS ISSUED: NONE                                    */ 02887000
*/*                                                                  */ 02888000
*/*    RETURN CODES: X00NOERR, ABEND22A, ABEND92A (RETURN CODE       */ 02889000
*/*                  FROM SUBROUTINE GETSPQE)                        */ 02890000
*/*                                                                  */ 02891000
*/*    REGISTER USAGE: R0WORK - INPUT SUBPOOL ID                     */ 02892000
*/*                    R1AREA - SPQE ADDR FROM GETSPQE               */ 02893000
*/*                    R15WORK - RETURN ADDR FROM SPQESRCH           */ 02894000
*/*                                                                  */ 02895000
*/*    LEVEL - 2                                                     */ 02896000
*/*                                                                  */ 02897000
*/********************************************************************/ 02898000
*/* E ENTER SHARESP                                                  */ 02899000
*                                                                  0874 02900000
*   RFY                                                            0874 02901000
*     R0WORK RSTD;                                                 0874 02902000
*   RFY                                                            0875 02903000
*     R7WORK RSTD;                                                 0875 02904000
*   RFY                                                            0876 02905000
*     R8WORK RSTD;                                                 0876 02906000
*   RFY                                                            0877 02907000
*     R10LOOPC RSTD;                                               0877 02908000
*   RFY                                                            0878 02909000
*     R2WORK RSTD;                                                 0878 02910000
*   RFY                                                            0879 02911000
*     R11PTR RSTD;                                                 0879 02912000
*   RFY                                                            0880 02913000
*     R14RET RSTD;                                                 0880 02914000
*   WKSAVEA=R7WORK;                 /* SAVE                          */ 02915000
         ST    R7WORK,WKSAVEA(,R3WORKAD)                           0881 02916000
*   WKSAVEB=R8WORK;                 /* SAVE                          */ 02917000
         ST    R8WORK,WKSAVEB(,R3WORKAD)                           0882 02918000
*   WKSAVEC=R10LOOPC;               /* SAVE                          */ 02919000
         ST    R10LOOPC,WKSAVEC(,R3WORKAD)                         0883 02920000
*   WKSAVED=R2WORK;                 /* SAVE                          */ 02921000
         ST    R2WORK,WKSAVED(,R3WORKAD)                           0884 02922000
*   WKSAVEE=R11PTR;                 /* SAVE                          */ 02923000
         ST    R11PTR,WKSAVEE(,R3WORKAD)                           0885 02924000
*   WKRTSAV2=R14RET;                /* SAVE RETURN ADDRESS           */ 02925000
         ST    R14RET,WKRTSAV2(,R3WORKAD)                          0886 02926000
*   RFY                                                            0887 02927000
*     R8WORK UNRSTD;                                               0887 02928000
*   RFY                                                            0888 02929000
*     R7WORK UNRSTD;                                               0888 02930000
*   RFY                                                            0889 02931000
*     R10LOOPC UNRSTD;                                             0889 02932000
*   RFY                                                            0890 02933000
*     R2WORK UNRSTD;                                               0890 02934000
*   RFY                                                            0891 02935000
*     R11PTR UNRSTD;                                               0891 02936000
*   RFY                                                            0892 02937000
*     R14RET UNRSTD;                                               0892 02938000
*                                                                  0892 02939000
*/* D (NO,%FL01850,YES,) IS INPUT SP ID > 127 ?                      */ 02940000
*                                                                  0893 02941000
*   IF R0WORK>SP127 THEN                                           0893 02942000
*                                                                  0893 02943000
         CH    R0WORK,@CH02714                                     0893 02944000
         BNH   @RF00893                                            0893 02945000
*/* P (,AT001600) SET ABEND CODE 22A                                 */ 02946000
*                                                                  0894 02947000
*     DO;                           /* DO000063                      */ 02948000
*       RFY                                                        0895 02949000
*         R15RETCD RSTD;                                           0895 02950000
*       R15RETCD=ABEND22A;          /* INVALID ID                    */ 02951000
         LA    R15RETCD,554                                        0896 02952000
*       GOTO AT001600;              /* GO EXIT SUBROUTINE            */ 02953000
         B     AT001600                                            0897 02954000
*       RFY                                                        0898 02955000
*         R15RETCD UNRSTD;                                         0898 02956000
*     END;                          /* END00063                      */ 02957000
*/* %FL01850: S SPQESRCH: SEARCH NEW TCB FOR SPQE                    */ 02958000
*                                                                  0900 02959000
*   RFY                                                            0900 02960000
*     R1WORK RSTD;                                                 0900 02961000
@RF00893 DS    0H                                                  0901 02962000
*   RFY                                                            0901 02963000
*     R15WORK RSTD;                                                0901 02964000
*   R1WORK=R5NEWTCB;                /* SEARCH NEW TCB                */ 02965000
         LR    R1WORK,R5NEWTCB                                     0902 02966000
*   CALL SPQESRCH;                  /* CHECK NEW TCB FOR THIS SP ID  */ 02967000
         BAL   @14,SPQESRCH                                        0903 02968000
*   RFY                                                            0904 02969000
*     R1WORK UNRSTD;                                               0904 02970000
*                                                                  0904 02971000
*/* D (YES,AT001610,NO,) FOUND ?                                     */ 02972000
*                                                                  0905 02973000
*   IF R15WORK^=ZERO THEN                                          0905 02974000
         LTR   R15WORK,R15WORK                                     0905 02975000
         BNZ   @RT00905                                            0905 02976000
*     GOTO AT001610;                /* SUBPOOL HAS ALREADY BEEN GIVEN   02977000
*                                      OR SHARED, GO EXIT            */ 02978000
*   RFY                                                            0907 02979000
*     R15WORK UNRSTD;                                              0907 02980000
*                                                                  0907 02981000
*/* S GETSPQE: OBTAIN SPQE STORAGE                                   */ 02982000
*                                                                  0908 02983000
*   RFY                                                            0908 02984000
*     R1AREA RSTD;                  /*                       @Z30ENVB*/ 02985000
*   RFY                                                            0909 02986000
*     R15RETCD RSTD;                /*                       @Z30ENVB*/ 02987000
*   CALL GETSPQE;                   /* GET SPQE STORAGE FOR NEW TCB     02988000
*                                                            @Z30ENVB*/ 02989000
         BAL   @14,GETSPQE                                         0910 02990000
*/* D (YES,AT001600,NO,) ANY ERRORS?                                 */ 02991000
*                                                                  0911 02992000
*   IF R15RETCD^=X00NOERR THEN      /*                       @Z30ENVB*/ 02993000
         LTR   R15RETCD,R15RETCD                                   0911 02994000
         BNZ   @RT00911                                            0911 02995000
*     GO TO AT001600;               /* GO EXIT SUBROUTINE    @Z30ENVB*/ 02996000
*   RFY                                                            0913 02997000
*     R15RETCD UNRSTD;              /*                       @Z30ENVB*/ 02998000
*/* P BUILD SHARED SPQE AND CHAIN OFF NEW TCB                        */ 02999000
*                                                                  0914 03000000
*   IF R5NEWTCB->TCBMSSB^=ZERO THEN /* IF QUEUE NOT EMPTY            */ 03001000
         SLR   @08,@08                                             0914 03002000
         ICM   @08,7,TCBMSSB(R5NEWTCB)                             0914 03003000
         LTR   @08,@08                                             0914 03004000
         BZ    @RF00914                                            0914 03005000
*     R1AREA->SPQEPTR=R5NEWTCB->TCBMSSB;/* CHAIN NEW TO NEXT @Z30ENVB*/ 03006000
         ST    @08,SPQEPTR(,R1AREA)                                0915 03007000
*   ELSE                            /* ELSE                          */ 03008000
*     R1AREA->LASTSPQE='1'B;        /* SET END-OF- QUEUE FLAG IN NEW    03009000
*                                                            @Z30ENVB*/ 03010000
         B     @RC00914                                            0916 03011000
@RF00914 OI    LASTSPQE(R1AREA),B'01000000'                        0916 03012000
*   R5NEWTCB->TCBMSSB=R1AREA;       /* CHAIN NEW SPQE OFF NEW TCB  0917 03013000
*                                                            @Z30ENVB*/ 03014000
@RC00914 STCM  R1AREA,7,TCBMSSB(R5NEWTCB)                          0917 03015000
*   R1AREA->SPSHARE='1'B;           /* SP NOT OWNED BY NEW TCB     0918 03016000
*                                                            @Z30ENVB*/ 03017000
         OI    SPSHARE(R1AREA),B'10000000'                         0918 03018000
*   R1AREA->SPQEID=R0WORK;          /* SET ID                @Z30ENVB*/ 03019000
         STC   R0WORK,SPQEID(,R1AREA)                              0919 03020000
*   RFY                                                            0920 03021000
*     R1AREA UNRSTD;                /*                       @Z30ENVB*/ 03022000
*/* S SPQESRCH: SEARCH CURRENT TCB FOR SPQE                          */ 03023000
*                                                                  0921 03024000
*   RFY                                                            0921 03025000
*     R1WORK RSTD;                                                 0921 03026000
*   RFY                                                            0922 03027000
*     R15WORK RSTD;                                                0922 03028000
*   R1WORK=R4CURTCB;                /* SEARCH ATTACHOR'S TCB         */ 03029000
         LR    R1WORK,R4CURTCB                                     0923 03030000
*   CALL SPQESRCH;                  /* CHECK CURRENT TCB FOR SP ID   */ 03031000
         BAL   @14,SPQESRCH                                        0924 03032000
*   RFY                                                            0925 03033000
*     R1WORK UNRSTD;                                               0925 03034000
*                                                                  0925 03035000
*/* D (YES,%FL01860,NO,) FOUND ?                                     */ 03036000
*                                                                  0926 03037000
*   IF R15WORK=ZERO THEN                                           0926 03038000
         LTR   R15WORK,R15WORK                                     0926 03039000
         BNZ   @RF00926                                            0926 03040000
*     DO;                           /* DO000064                      */ 03041000
*       RFY                                                        0928 03042000
*         R15WORK UNRSTD;                                          0928 03043000
*                                                                  0928 03044000
*/* S GETSPQE: OBTAIN SPQE STORAGE                                   */ 03045000
*                                                                  0929 03046000
*       RFY                                                        0929 03047000
*         R1AREA RSTD;              /*                       @Z30ENVB*/ 03048000
*       RFY                                                        0930 03049000
*         R15RETCD RSTD;            /*                       @Z30ENVB*/ 03050000
*       CALL GETSPQE;               /* GET SPQE STORAGE FOR CURRENT     03051000
*                                      TCB                   @Z30ENVB*/ 03052000
         BAL   @14,GETSPQE                                         0931 03053000
*/* D (YES,AT001600,NO,) ANY ERRORS ?                                */ 03054000
*                                                                  0932 03055000
*       IF R15RETCD^=X00NOERR THEN  /*                       @Z30ENVB*/ 03056000
         LTR   R15RETCD,R15RETCD                                   0932 03057000
         BNZ   @RT00932                                            0932 03058000
*         GO TO AT001600;           /* GO EXIT SUBROUTINE    @Z30ENVB*/ 03059000
*       RFY                                                        0934 03060000
*         R15RETCD UNRSTD;          /*                       @Z30ENVB*/ 03061000
*/* P BUILD OWNED-SHARED SPQE AND CHAIN OFF DUMMY TCBMSS QUEUE       */ 03062000
*                                                                  0935 03063000
*       IF WKTCBMSS=ZERO THEN       /* IS QUEUE EMPTY ?      @Z30ENVB*/ 03064000
         ICM   @08,15,WKTCBMSS(R12SVRB)                            0935 03065000
         BNZ   @RF00935                                            0935 03066000
*         WKSPQE1=R1AREA;           /* YES - SAVE PTR TO FIRST     0936 03067000
*                                      (OLDEST) SPQE ON DUMMY TCBMSS    03068000
*                                      QUEUE                 @Z30ENVB*/ 03069000
         ST    R1AREA,WKSPQE1(,R3WORKAD)                           0936 03070000
*       ELSE                        /* NO                    @Z30ENVB*/ 03071000
*         R1AREA->SPQEPTR=WKTCBMSS; /* CHAIN NEW TO OLD      @Z30ENVB*/ 03072000
         B     @RC00935                                            0937 03073000
@RF00935 MVC   SPQEPTR(4,R1AREA),WKTCBMSS(R12SVRB)                 0937 03074000
*       WKTCBMSS=R1AREA;            /* CHAIN NEW SPQE AT TOP OF DUMMY   03075000
*                                      TCBMSS QUEUE          @Z30ENVB*/ 03076000
@RC00935 ST    R1AREA,WKTCBMSS(,R12SVRB)                           0938 03077000
*       R1AREA->SPQEOWN='1'B;       /* SUBPOOL IS OWNED-AND-SHARED BY   03078000
*                                      CURRENT TASK          @Z30ENVB*/ 03079000
         OI    SPQEOWN(R1AREA),B'00100000'                         0939 03080000
*       R1AREA->SPQEID=R0WORK;      /* SET SUBPOOL ID        @Z30ENVB*/ 03081000
         STC   R0WORK,SPQEID(,R1AREA)                              0940 03082000
*       R1AREA->SPQEKEY=R4CURTCB->TCBPKF;/* SET PROTECT KEY  @Z30ENVB*/ 03083000
         MVC   SPQEKEY(1,R1AREA),TCBPKF(R4CURTCB)                  0941 03084000
*/* P PROPAGATE SPQEKEY TO NEW SPQE                                  */ 03085000
*                                                                  0942 03086000
*       R5NEWTCB->TCBMSSB->SPQEKEY=R4CURTCB->TCBPKF;/* KEY           */ 03087000
         SLR   @08,@08                                             0942 03088000
         ICM   @08,7,TCBMSSB(R5NEWTCB)                             0942 03089000
         MVC   SPQEKEY(1,@08),TCBPKF(R4CURTCB)                     0942 03090000
*/* P (,AT001610) SET NEW SPDQEAD TO ADDRESS OF THIS SPQE            */ 03091000
*                                                                  0943 03092000
*       R5NEWTCB->TCBMSSB->SPDQEAD=R1AREA;/* 'DQE' PTR       @Z30ENVB*/ 03093000
         ST    R1AREA,SPDQEAD(,@08)                                0943 03094000
*     END;                          /* END00064                      */ 03095000
*                                                                  0944 03096000
*   /*****************************************************************/ 03097000
*   /*                                                               */ 03098000
*   /* SPQE FOR SUBPOOL BEING SHARED ALREADY EXISTS FOR CURRENT TASK */ 03099000
*   /*                                                               */ 03100000
*   /*****************************************************************/ 03101000
*                                                                  0945 03102000
*   ELSE                                                           0945 03103000
*     DO;                           /* DO000067                      */ 03104000
         B     @RC00926                                            0945 03105000
@RF00926 DS    0H                                                  0946 03106000
*       RFY                                                        0946 03107000
*         R0WORK UNRSTD;                                           0946 03108000
*       RFY                                                        0947 03109000
*         R1AREA UNRSTD;            /*                       @Z30ENVB*/ 03110000
*       RFY                                                        0948 03111000
*         R7WORK UNRSTD;                                           0948 03112000
*       RFY                                                        0949 03113000
*         R15WORK RSTD;                                            0949 03114000
*                                                                  0949 03115000
*/* %FL01860: P PROPAGATE SPQEKEY FROM OLD SPQE TO NEW               */ 03116000
*                                                                  0950 03117000
*       R5NEWTCB->TCBMSSB->SPQEKEY=R15WORK->SPQEKEY;/* KEY           */ 03118000
         SLR   @14,@14                                             0950 03119000
         ICM   @14,7,TCBMSSB(R5NEWTCB)                             0950 03120000
         MVC   SPQEKEY(1,@14),SPQEKEY(R15WORK)                     0950 03121000
*/* D (YES,%FL01870,NO,) DOES CURRENT TASK OWN SUBPOOL ?             */ 03122000
*                                                                  0951 03123000
*       IF R15WORK->SPSHARE='1'B THEN                              0951 03124000
*                                                                  0951 03125000
         TM    SPSHARE(R15WORK),B'10000000'                        0951 03126000
         BNO   @RF00951                                            0951 03127000
*/* P (,AT001610) PROPAGATE SPDQEAD FROM OLD TO NEW                  */ 03128000
*                                                                  0952 03129000
*         R5NEWTCB->TCBMSSB->SPDQEAD=R15WORK->SPDQEAD;/* ADDRESS OF     03130000
*                                      OWNING SPQE                   */ 03131000
         MVC   SPDQEAD(4,@14),SPDQEAD(R15WORK)                     0952 03132000
*       ELSE                        /* SHARED SUBPOOL                */ 03133000
*         DO;                       /* DO000066                      */ 03134000
         B     @RC00951                                            0953 03135000
@RF00951 DS    0H                                                  0954 03136000
*/* %FL01870: P SET CURRENT TCB'S SPQE'S OWNED-SHARED FLAG           */ 03137000
*                                                                  0954 03138000
*           R15WORK->SPQEOWN='1'B;                                 0954 03139000
*                                                                  0954 03140000
         OI    SPQEOWN(R15WORK),B'00100000'                        0954 03141000
*/* P SET NEW SPDQEAD TO ADDRESS OF OLD SPQE                         */ 03142000
*                                                                  0955 03143000
*           R5NEWTCB->TCBMSSB->SPDQEAD=R15WORK;/* 'DQE' PTR          */ 03144000
         ICM   @14,7,TCBMSSB(R5NEWTCB)                             0955 03145000
         ST    R15WORK,SPDQEAD(,@14)                               0955 03146000
*         END;                      /* END00066                      */ 03147000
*     END;                          /* END00067                      */ 03148000
@RC00951 DS    0H                                                  0958 03149000
*   RFY                                                            0958 03150000
*     R15WORK UNRSTD;                                              0958 03151000
*                                                                  0958 03152000
@RC00926 DS    0H                                                  0959 03153000
*/* AT001610: P SET RETURN CODE = 0                                  */ 03154000
*                                                                  0959 03155000
*   RFY                                                            0959 03156000
*     R15RETCD RSTD;                                               0959 03157000
*AT001610:                                                         0960 03158000
*   R15RETCD=X00NOERR;              /* PROCESSING SUCCESSFUL         */ 03159000
AT001610 SLR   R15RETCD,R15RETCD                                   0960 03160000
*/* AT001600: R RETURN TO CALLING POINT                              */ 03161000
*                                                                  0961 03162000
*   RFY                                                            0961 03163000
*     R2WORK RSTD;                                                 0961 03164000
*   RFY                                                            0962 03165000
*     R7WORK RSTD;                                                 0962 03166000
*   RFY                                                            0963 03167000
*     R8WORK RSTD;                                                 0963 03168000
*   RFY                                                            0964 03169000
*     R10LOOPC RSTD;                                               0964 03170000
*   RFY                                                            0965 03171000
*     R11PTR RSTD;                                                 0965 03172000
*   RFY                                                            0966 03173000
*     R14RET RSTD;                                                 0966 03174000
*AT001600:                                                         0967 03175000
*   R7WORK=WKSAVEA;                 /* RESTORE                       */ 03176000
AT001600 L     R7WORK,WKSAVEA(,R3WORKAD)                           0967 03177000
*   R8WORK=WKSAVEB;                 /* RESTORE                       */ 03178000
         L     R8WORK,WKSAVEB(,R3WORKAD)                           0968 03179000
*   R10LOOPC=WKSAVEC;               /* RESTORE                       */ 03180000
         L     R10LOOPC,WKSAVEC(,R3WORKAD)                         0969 03181000
*   R2WORK=WKSAVED;                 /* RESTORE                       */ 03182000
         L     R2WORK,WKSAVED(,R3WORKAD)                           0970 03183000
*   R11PTR=WKSAVEE;                 /* RESTORE                       */ 03184000
         L     R11PTR,WKSAVEE(,R3WORKAD)                           0971 03185000
*   R14RET=WKRTSAV2;                /* RESTORE RETURN ADDRESS        */ 03186000
         L     R14RET,WKRTSAV2(,R3WORKAD)                          0972 03187000
*/* SHARESP: END FLOWCHART                                           */ 03188000
*                                                                  0973 03189000
*   END SHARESP;                    /* END OF SUBROUTINE             */ 03190000
@EL00008 DS    0H                                                  0973 03191000
@EF00008 DS    0H                                                  0973 03192000
@ER00008 BR    @14                                                 0973 03193000
*   RFY                                                            0974 03194000
*     R15RETCD UNRSTD;                                             0974 03195000
*   RFY                                                            0975 03196000
*     R7WORK UNRSTD;                                               0975 03197000
*   RFY                                                            0976 03198000
*     R8WORK UNRSTD;                                               0976 03199000
*   RFY                                                            0977 03200000
*     R10LOOPC UNRSTD;                                             0977 03201000
*   RFY                                                            0978 03202000
*     R2WORK UNRSTD;                                               0978 03203000
*   RFY                                                            0979 03204000
*     R11PTR UNRSTD;                                               0979 03205000
*   RFY                                                            0980 03206000
*     R14RET UNRSTD;                                               0980 03207000
*                                                                  0981 03208000
*   /*****************************************************************/ 03209000
*   /*                                                               */ 03210000
*   /* GETSPQE SUBROUTINE                                            */ 03211000
*   /*                                                               */ 03212000
*   /*****************************************************************/ 03213000
*                                                                  0981 03214000
*GETSPQE:                                                          0981 03215000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/* ENTRY POINT      @Z30ENVB*/ 03216000
GETSPQE  DS    0H                                                  0982 03217000
*/* GETSPQE: CHART BEGIN FLOWCHART                                   */ 03218000
*/* FOOTING                                                        0982 03219000
*/* SUBROUTINE GETS SPQE STORAGE                                     */ 03220000
*/********************************************************************/ 03221000
*/*                                                                  */ 03222000
*/*    SUBROUTINE GETS STORAGE FOR ONE SPQE                          */ 03223000
*/*                                                                  */ 03224000
*/*    SUBROUTINES CALLED: NONE                                      */ 03225000
*/*                                                                  */ 03226000
*/*    CALLED BY: SHARESP, SHARESWA                                  */ 03227000
*/*                                                                  */ 03228000
*/*    SYSTEM MACROS ISSUED: GETMAIN                                 */ 03229000
*/*                                                                  */ 03230000
*/*    RETURN CODES: X00NOERR, ABEND92A                              */ 03231000
*/*                                                                  */ 03232000
*/*    REGISTER USAGE: R1AREA - ADDR OF SPQE OBTAINED                */ 03233000
*/*                    R7ASCB - ASCB ADDR                            */ 03234000
*/*                    R2WORK - SAVE RETURN ADDR                     */ 03235000
*/*                    R8WORK - SAVE REGISTER 0 FOR GETMAIN          */ 03236000
*/*                             INTERFACE                            */ 03237000
*/*                    R11WORK - SAVE REGISTER 7 FOR GETMAIN         */ 03238000
*/*                              INTERFACE                           */ 03239000
*/*                                                                  */ 03240000
*/*    LEVEL - 3                                                     */ 03241000
*/*                                                                  */ 03242000
*/*    NOTES - GETMAIN MACRO DESTROYS REGISTERS 0,1,14,15.           */ 03243000
*/*                                                                  */ 03244000
*/********************************************************************/ 03245000
*/* E ENTER GETSPQE                                                  */ 03246000
*                                                                  0982 03247000
*   RFY                                                            0982 03248000
*     R0WORK RSTD;                  /*                       @Z30ENVB*/ 03249000
*   RFY                                                            0983 03250000
*     R1AREA RSTD;                  /*                       @Z30ENVB*/ 03251000
*   RFY                                                            0984 03252000
*     R2WORK RSTD;                  /*                       @Z30ENVB*/ 03253000
*   RFY                                                            0985 03254000
*     R7ASCB RSTD;                  /*                       @Z30ENVB*/ 03255000
*   RFY                                                            0986 03256000
*     R8WORK RSTD;                  /*                       @Z30ENVB*/ 03257000
*   RFY                                                            0987 03258000
*     R11WORK RSTD;                 /*                       @Z30ENVB*/ 03259000
*   RFY                                                            0988 03260000
*     R14RET RSTD;                  /*                       @Z30ENVB*/ 03261000
*   RFY                                                            0989 03262000
*     R15RETCD RSTD;                /*                       @Z30ENVB*/ 03263000
*   R2WORK=R14RET;                  /* SAVE RETURN ADDR      @Z30ENVB*/ 03264000
         LR    R2WORK,R14RET                                       0990 03265000
*/* L GETMAIN: OBTAIN SPQE STORAGE                                   */ 03266000
*                                                                  0991 03267000
*   R11WORK=R7ASCB;                 /* SAVE REGISTER 7 ACROSS GETMAIN   03268000
*                                                            @Z30ENVB*/ 03269000
         LR    R11WORK,R7ASCB                                      0991 03270000
*   R8WORK=R0WORK;                  /* SAVE REGISTER 0 ACROSS GETMAIN   03271000
*                                                            @Z30ENVB*/ 03272000
         LR    R8WORK,R0WORK                                       0992 03273000
*   R7ASCB=PSAAOLD;                 /* ASCB ADDR, FOR GETMAIN      0993 03274000
*                                                            @Z30ENVB*/ 03275000
         L     R7ASCB,PSAAOLD                                      0993 03276000
*   GENERATE REFS(R4CURTCB,R7ASCB,CVTCBBR);                        0994 03277000
       SPACE                                                            03278000
       GETMAIN P,SP=SP255EQU,BRANCH=YES                      @Z30ENVB   03279000
       SPACE                                                            03280000
*   R0WORK=R8WORK;                  /* RESTORE REGISTER 0    @Z30ENVB*/ 03281000
         LR    R0WORK,R8WORK                                       0995 03282000
*   R7ASCB=R11WORK;                 /* RESTORE REGISTER 7    @Z30ENVB*/ 03283000
         LR    R7ASCB,R11WORK                                      0996 03284000
*   RFY                                                            0997 03285000
*     R11WORK UNRSTD;               /*                       @Z30ENVB*/ 03286000
*   RFY                                                            0998 03287000
*     R8WORK UNRSTD;                /*                       @Z30ENVB*/ 03288000
*/* D (YES,AT001780,NO,) WAS STORAGE OBTAINED ?                      */ 03289000
*                                                                  0999 03290000
*   IF R15RETCD^=X00NOERR THEN      /*                       @Z30ENVB*/ 03291000
         LTR   R15RETCD,R15RETCD                                   0999 03292000
         BZ    @RF00999                                            0999 03293000
*     DO;                           /* DO000120: NO STORAGE  @Z30ENVB*/ 03294000
*/* P (,AT001780) INDICATE ABEND CODE 92A                            */ 03295000
*                                                                  1001 03296000
*       WKREASON=RCODE4;            /* SET REASON CODE       @Z30ENVB*/ 03297000
         MVI   WKREASON(R12SVRB),X'04'                             1001 03298000
*       R15RETCD=ABEND92A;          /* ERROR CODE            @Z30ENVB*/ 03299000
         LA    R15RETCD,2346                                       1002 03300000
*     END;                          /* END00120              @Z30ENVB*/ 03301000
*/* AT001780: R RETURN TO CALLING POINT                              */ 03302000
*                                                                  1004 03303000
*AT001780:                                                         1004 03304000
*   R14RET=R2WORK;                  /* RESTORE RETURN ADDR   @Z30ENVB*/ 03305000
@RF00999 DS    0H                                                  1004 03306000
AT001780 LR    R14RET,R2WORK                                       1004 03307000
*/* GETSPQE: END FLOWCHART                                           */ 03308000
*                                                                  1005 03309000
*   END GETSPQE;                    /* END OF SUBROUTINE     @Z30ENVB*/ 03310000
@EL00009 DS    0H                                                  1005 03311000
@EF00009 DS    0H                                                  1005 03312000
@ER00009 BR    @14                                                 1005 03313000
*   RFY                                                            1006 03314000
*     R0WORK UNRSTD;                /*                       @Z30ENVB*/ 03315000
*   RFY                                                            1007 03316000
*     R1AREA UNRSTD;                /*                       @Z30ENVB*/ 03317000
*   RFY                                                            1008 03318000
*     R2WORK UNRSTD;                /*                       @Z30ENVB*/ 03319000
*   RFY                                                            1009 03320000
*     R7ASCB UNRSTD;                /*                       @Z30ENVB*/ 03321000
*   RFY                                                            1010 03322000
*     R14RET UNRSTD;                /*                       @Z30ENVB*/ 03323000
*   RFY                                                            1011 03324000
*     R15RETCD UNRSTD;              /*                       @Z30ENVB*/ 03325000
*                                                                  1012 03326000
*   /*****************************************************************/ 03327000
*   /*                                                               */ 03328000
*   /* GIVESP SUBROUTINE                                             */ 03329000
*   /*                                                               */ 03330000
*   /*****************************************************************/ 03331000
*                                                                  1012 03332000
*GIVESP:                                                           1012 03333000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/* ENTRY POINT              */ 03334000
GIVESP   DS    0H                                                  1013 03335000
*/* GIVESP: CHART  BEGIN FLOWCHART                                   */ 03336000
*/* FOOTING                                                        1013 03337000
*/* SUBROUTINE PROCESSES ONE GIVE SUBPOOL REQUEST                    */ 03338000
*/********************************************************************/ 03339000
*/*                                                                  */ 03340000
*/*    SUBROUTINE GIVESP PROCESSES A SINGLE GIVE SUBPOOL REQUEST,    */ 03341000
*/*    0 < ID <= 127                                                 */ 03342000
*/*                                                                  */ 03343000
*/*    SUBROUTINES CALLED: SPQESRCH                                  */ 03344000
*/*                                                                  */ 03345000
*/*    RETURN CODES SET: X00NOERR, ABEND12A, ABEND22A                */ 03346000
*/*                                                                  */ 03347000
*/*    REGISTER USAGE: R0WORK - INPUT SUBPOOL ID                     */ 03348000
*/*                                                                  */ 03349000
*/*    NOTES: THIS IS A SECOND LEVEL SUBROUTINE, CALLED BY SPCONTRL. */ 03350000
*/*                                                                  */ 03351000
*/********************************************************************/ 03352000
*/* E ENTER GIVESP                                                   */ 03353000
*                                                                  1013 03354000
*   RFY                                                            1013 03355000
*     R0WORK RSTD;                                                 1013 03356000
*   RFY                                                            1014 03357000
*     R2WORK RSTD;                                                 1014 03358000
*   RFY                                                            1015 03359000
*     R7WORK RSTD;                                                 1015 03360000
*   RFY                                                            1016 03361000
*     R8WORK RSTD;                                                 1016 03362000
*   RFY                                                            1017 03363000
*     R10LOOPC RSTD;                                               1017 03364000
*   RFY                                                            1018 03365000
*     R11PTR RSTD;                                                 1018 03366000
*   RFY                                                            1019 03367000
*     R14RET RSTD;                                                 1019 03368000
*   WKSAVEA=R2WORK;                 /* SAVE                          */ 03369000
         ST    R2WORK,WKSAVEA(,R3WORKAD)                           1020 03370000
*   WKSAVEB=R7WORK;                 /* SAVE                          */ 03371000
         ST    R7WORK,WKSAVEB(,R3WORKAD)                           1021 03372000
*   WKSAVEC=R8WORK;                 /* SAVE                          */ 03373000
         ST    R8WORK,WKSAVEC(,R3WORKAD)                           1022 03374000
*   WKSAVED=R10LOOPC;               /* SAVE                          */ 03375000
         ST    R10LOOPC,WKSAVED(,R3WORKAD)                         1023 03376000
*   WKSAVEE=R11PTR;                 /* SAVE                          */ 03377000
         ST    R11PTR,WKSAVEE(,R3WORKAD)                           1024 03378000
*   WKRTSAV2=R14RET;                /* SAVE RETURN ADDRESS           */ 03379000
         ST    R14RET,WKRTSAV2(,R3WORKAD)                          1025 03380000
*   RFY                                                            1026 03381000
*     R2WORK UNRSTD;                                               1026 03382000
*   RFY                                                            1027 03383000
*     R7WORK UNRSTD;                                               1027 03384000
*   RFY                                                            1028 03385000
*     R8WORK UNRSTD;                                               1028 03386000
*   RFY                                                            1029 03387000
*     R10LOOPC UNRSTD;                                             1029 03388000
*   RFY                                                            1030 03389000
*     R11PTR UNRSTD;                                               1030 03390000
*   RFY                                                            1031 03391000
*     R14RET UNRSTD;                                               1031 03392000
*                                                                  1031 03393000
*/* D (YES,%FL01920,NO,) IS SP ID = 0 ?                              */ 03394000
*                                                                  1032 03395000
*   IF R0WORK^=ZERO THEN                                           1032 03396000
         LTR   R0WORK,R0WORK                                       1032 03397000
         BZ    @RF01032                                            1032 03398000
*     DO;                           /* DO000069                      */ 03399000
*/* D (NO,%FL01900,YES,) IS SP ID > 127 ?                            */ 03400000
*                                                                  1034 03401000
*       IF R0WORK>SP127 THEN                                       1034 03402000
         CH    R0WORK,@CH02714                                     1034 03403000
         BNH   @RF01034                                            1034 03404000
*         DO;                       /* DO000070                      */ 03405000
*/* P (,AT001630) INDICATE ABEND CODE 22A                            */ 03406000
*                                                                  1036 03407000
*           RFY                                                    1036 03408000
*             R15RETCD RSTD;                                       1036 03409000
*           R15RETCD=ABEND22A;      /* INVALID ID                    */ 03410000
         LA    R15RETCD,554                                        1037 03411000
*           GOTO AT001630;          /* GO EXIT SUBROUTINE            */ 03412000
         B     AT001630                                            1038 03413000
*         END;                      /* END00070                      */ 03414000
*/* %FL01900: S SPQESRCH: SEARCH CURRENT TCB FOR SPQE HAVING THIS ID */ 03415000
*                                                                  1040 03416000
*       RFY                                                        1040 03417000
*         R1WORK RSTD;                                             1040 03418000
@RF01034 DS    0H                                                  1041 03419000
*       R1WORK=R4CURTCB;            /* ADDRESS OF CURRENT TCB        */ 03420000
         LR    R1WORK,R4CURTCB                                     1041 03421000
*       CALL SPQESRCH;              /* CHECK FOR EXISTING SPQE       */ 03422000
         BAL   @14,SPQESRCH                                        1042 03423000
*/* D (NO,%FL01920,YES,) FOUND ?                                     */ 03424000
*                                                                  1043 03425000
*       IF R15WORK^=ZERO THEN                                      1043 03426000
         LTR   R15WORK,R15WORK                                     1043 03427000
         BZ    @RF01043                                            1043 03428000
*         DO;                       /* DO000071                      */ 03429000
*/* D (NO,%FL01910,YES,) IS SPQE FLAGED OWNED-AND- SHARED ?          */ 03430000
*                                                                  1045 03431000
*           IF R15WORK->SPQEOWN='1'B THEN                          1045 03432000
         TM    SPQEOWN(R15WORK),B'00100000'                        1045 03433000
         BNO   @RF01045                                            1045 03434000
*             DO;                   /* DO000072                      */ 03435000
*/* P (,AT001630) INDICATE ABEND 12A                                 */ 03436000
*                                                                  1047 03437000
*               R15RETCD=ABEND12A;  /* INVALID GIVE-REQUEST          */ 03438000
         LA    R15RETCD,298                                        1047 03439000
*               GOTO AT001630;      /* GO EXIT SUBROUTINE            */ 03440000
         B     AT001630                                            1048 03441000
*             END;                  /* END00072                      */ 03442000
*/* %FL01910: P RECHAIN SPQE OFF NEW TCB'S TCBMSS QUEUE              */ 03443000
*                                                                  1050 03444000
*           /*********************************************************/ 03445000
*           /*                                                       */ 03446000
*           /* REMOVE SPQE FROM CURRENT TCB'S TCBMSS QUEUE, USING    */ 03447000
*           /* R1WORK AS SET BY SUBROUTINE SPQESRCH                  */ 03448000
*           /*                                                       */ 03449000
*           /*********************************************************/ 03450000
*                                                                  1050 03451000
*           R1WORK->BYTES123=R15WORK->SPQEPTR;/* UNCHAIN             */ 03452000
@RF01045 MVC   BYTES123(3,R1WORK),SPQEPTR+1(R15WORK)               1050 03453000
*           IF R15WORK->LASTSPQE='1'B THEN/* LAST SPQE ?             */ 03454000
         TM    LASTSPQE(R15WORK),B'01000000'                       1051 03455000
         BNO   @RF01051                                            1051 03456000
*             IF R1WORK^=ADDR(R4CURTCB->TCBMSS) THEN/* YES, MOTHER 1052 03457000
*                                      QUEUE EMPTY ?                 */ 03458000
         LA    @14,TCBMSS(,R4CURTCB)                               1052 03459000
         CR    R1WORK,@14                                          1052 03460000
         BE    @RF01052                                            1052 03461000
*               R1WORK->LASTSPQE='1'B;/* INSURE END-OF-QUEUE PROPERLY   03462000
*                                      FLAGGED                       */ 03463000
         OI    LASTSPQE(R1WORK),B'01000000'                        1053 03464000
*           RFY                                                    1054 03465000
*             R1WORK UNRSTD;                                       1054 03466000
*                                                                  1054 03467000
@RF01052 DS    0H                                                  1054 03468000
@RF01051 DS    0H                                                  1055 03469000
*           /*********************************************************/ 03470000
*           /*                                                       */ 03471000
*           /* RESET CHAIN FIELD TO CONTENTS OF NEW TCBMSSB, EITHER  */ 03472000
*           /* ZERO OR ADDRESS OF PRECEEDING SPQE ON QUEUE           */ 03473000
*           /*                                                       */ 03474000
*           /*********************************************************/ 03475000
*                                                                  1055 03476000
*           R15WORK->SPQEPTR=R5NEWTCB->TCBMSSB;/*            @YM05452*/ 03477000
*                                                                  1055 03478000
         SLR   @14,@14                                             1055 03479000
         ICM   @14,7,TCBMSSB(R5NEWTCB)                             1055 03480000
         ST    @14,SPQEPTR(,R15WORK)                               1055 03481000
*           /*********************************************************/ 03482000
*           /*                                                       */ 03483000
*           /* IF NEW TCB HAS AN SPQE ON ITS TCBMSS QUEUE, INSURE    */ 03484000
*           /* THAT THE END-OF-QUEUE BIT IS OFF IN THE SPQE BEING    */ 03485000
*           /* GIVEN.                                                */ 03486000
*           /*                                                       */ 03487000
*           /*********************************************************/ 03488000
*                                                                  1056 03489000
*           IF R5NEWTCB->TCBMSSB^=ZERO THEN                        1056 03490000
         LTR   @14,@14                                             1056 03491000
         BZ    @RF01056                                            1056 03492000
*             DO;                   /* DO000073                      */ 03493000
*               R15WORK->LASTSPQE='0'B;                            1058 03494000
         NI    LASTSPQE(R15WORK),B'10111111'                       1058 03495000
*             END;                  /* END00073                      */ 03496000
*                                                                  1059 03497000
*           /*********************************************************/ 03498000
*           /*                                                       */ 03499000
*           /* OTHERWISE, SET END-OF-QUEUE BIT ON IN SPQE BEING      */ 03500000
*           /* GIVEN.                                                */ 03501000
*           /*                                                       */ 03502000
*           /*********************************************************/ 03503000
*                                                                  1060 03504000
*           ELSE                                                   1060 03505000
*             R15WORK->LASTSPQE='1'B;                              1060 03506000
*                                                                  1060 03507000
         B     @RC01056                                            1060 03508000
@RF01056 OI    LASTSPQE(R15WORK),B'01000000'                       1060 03509000
*           /*********************************************************/ 03510000
*           /*                                                       */ 03511000
*           /* CHAIN SPQE BEING GIVEN OFF NEW TCB'S TCBMSS QUEUE     */ 03512000
*           /*                                                       */ 03513000
*           /*********************************************************/ 03514000
*                                                                  1061 03515000
*           R5NEWTCB->TCBMSSB=R15WORK;                             1061 03516000
*                                                                  1061 03517000
@RC01056 STCM  R15WORK,7,TCBMSSB(R5NEWTCB)                         1061 03518000
*/* THE SHARED-NOT-OWNED FLAG REMAINS ON IN THE GIVEN SPQE IF        */ 03519000
*/* IT WAS ON ORIGINALLY                                             */ 03520000
*                                                                  1062 03521000
*         END;                      /* END00071                      */ 03522000
*     END;                          /* END00069                      */ 03523000
@RF01043 DS    0H                                                  1064 03524000
*/* %FL01920: P SET RETURN CODE = 0                                  */ 03525000
*                                                                  1064 03526000
*   R15RETCD=X00NOERR;                                             1064 03527000
*                                                                  1064 03528000
@RF01032 SLR   R15RETCD,R15RETCD                                   1064 03529000
*/* AT001630: R RETURN TO CALLING POINT                              */ 03530000
*                                                                  1065 03531000
*   RFY                                                            1065 03532000
*     R14RET RSTD;                                                 1065 03533000
*   RFY                                                            1066 03534000
*     R2WORK RSTD;                                                 1066 03535000
*   RFY                                                            1067 03536000
*     R7WORK RSTD;                                                 1067 03537000
*   RFY                                                            1068 03538000
*     R8WORK RSTD;                                                 1068 03539000
*   RFY                                                            1069 03540000
*     R10LOOPC RSTD;                                               1069 03541000
*   RFY                                                            1070 03542000
*     R11PTR RSTD;                                                 1070 03543000
*AT001630:                                                         1071 03544000
*   R14RET=WKRTSAV2;                /* RESTORE RETURN ADDRESS        */ 03545000
AT001630 L     R14RET,WKRTSAV2(,R3WORKAD)                          1071 03546000
*   R2WORK=WKSAVEA;                 /* RESTORE                       */ 03547000
         L     R2WORK,WKSAVEA(,R3WORKAD)                           1072 03548000
*   R7WORK=WKSAVEB;                 /* RESTORE                       */ 03549000
         L     R7WORK,WKSAVEB(,R3WORKAD)                           1073 03550000
*   R8WORK=WKSAVEC;                 /* RESTORE                       */ 03551000
         L     R8WORK,WKSAVEC(,R3WORKAD)                           1074 03552000
*   R10LOOPC=WKSAVED;               /* RESTORE                       */ 03553000
         L     R10LOOPC,WKSAVED(,R3WORKAD)                         1075 03554000
*   R11PTR=WKSAVEE;                 /* RESTORE                       */ 03555000
         L     R11PTR,WKSAVEE(,R3WORKAD)                           1076 03556000
*/* GIVESP: END FLOWCHART                                            */ 03557000
*                                                                  1077 03558000
*   END GIVESP;                     /* END OF SUBROUTINE             */ 03559000
@EL00010 DS    0H                                                  1077 03560000
@EF00010 DS    0H                                                  1077 03561000
@ER00010 BR    @14                                                 1077 03562000
*   RFY                                                            1078 03563000
*     R0WORK UNRSTD;                                               1078 03564000
*   RFY                                                            1079 03565000
*     R2WORK UNRSTD;                                               1079 03566000
*   RFY                                                            1080 03567000
*     R7WORK UNRSTD;                                               1080 03568000
*   RFY                                                            1081 03569000
*     R8WORK UNRSTD;                                               1081 03570000
*   RFY                                                            1082 03571000
*     R10LOOPC UNRSTD;                                             1082 03572000
*   RFY                                                            1083 03573000
*     R11PTR UNRSTD;                                               1083 03574000
*   RFY                                                            1084 03575000
*     R14RET UNRSTD;                                               1084 03576000
*   RFY                                                            1085 03577000
*     R15RETCD UNRSTD;                                             1085 03578000
*                                                                  1086 03579000
*   /*****************************************************************/ 03580000
*   /*                                                               */ 03581000
*   /* SPQESRCH SUBROUTINE                                           */ 03582000
*   /*                                                               */ 03583000
*   /*****************************************************************/ 03584000
*                                                                  1086 03585000
*SPQESRCH:                                                         1086 03586000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/* ENTRY POINT              */ 03587000
SPQESRCH DS    0H                                                  1087 03588000
*/* SPQESRCH: CHART  BEGIN FLOWCHART                                 */ 03589000
*/* FOOTING                                                        1087 03590000
*/* SEARCHES INPUT TCB FOR A PARTICULAR SPQE                         */ 03591000
*/********************************************************************/ 03592000
*/*                                                                  */ 03593000
*/*    SUBROUTINE SPQESRCH SEARCHES A SPECIFIED TCB'S TCBMSS QUEUE   */ 03594000
*/*    FOR AN SPQE HAVING A SPECIFIED SUBPOOL ID.                    */ 03595000
*/*                                                                  */ 03596000
*/*    SUBROUTINES CALLED: NONE                                      */ 03597000
*/*                                                                  */ 03598000
*/*    SYSTEM MACROS ISSUED: NONE                                    */ 03599000
*/*                                                                  */ 03600000
*/*    REGISTER USAGE: R0WORK - INPUT SUBPOOL ID                     */ 03601000
*/*                    R1WORK - INPUT TCB ADDRESS - OUTPUT, THE ADDR */ 03602000
*/*                             OF  THE PRECEEDING CHAINING FIELD,   */ 03603000
*/*                             EITHER TCBMSS OF THE SEARCH TCB, OR  */ 03604000
*/*                             SPQEPTR OF THE PRECEEDING SPQE, USED */ 03605000
*/*                             IN UNCHAINING THE SEARCH SPQE        */ 03606000
*/*                    R15WORK - OUTPUT, ADDRESS OF THE SPQE IF      */ 03607000
*/*                              FOUND, OTHERWISE ZERO               */ 03608000
*/*                                                                  */ 03609000
*/*    LEVEL - 3                                                     */ 03610000
*/*                                                                  */ 03611000
*/********************************************************************/ 03612000
*/* E ENTER SPQESRCH                                                 */ 03613000
*                                                                  1087 03614000
*   RFY                                                            1087 03615000
*     R0WORK RSTD;                                                 1087 03616000
*   RFY                                                            1088 03617000
*     R1WORK RSTD;                                                 1088 03618000
*   RFY                                                            1089 03619000
*     R14RET RSTD;                                                 1089 03620000
*   RFY                                                            1090 03621000
*     R15WORK RSTD;                                                1090 03622000
*                                                                  1090 03623000
*/* P GET QUEUE CHAINING FIELD ADDRESS (ADDRESS OF TCBMSS)           */ 03624000
*                                                                  1091 03625000
*   R1WORK=ADDR(R1WORK->TCBMSS);    /* MAINTAIN PRECEEDING CHAINING     03626000
*                                      FIELD ADDRESS                 */ 03627000
         LA    @08,TCBMSS(,R1WORK)                                 1091 03628000
         LR    R1WORK,@08                                          1091 03629000
*/* P GET SEARCH TCB'S TCBMSS POINTER (FIRST SPQE PTR)               */ 03630000
*                                                                  1092 03631000
*   R15WORK=R1WORK->BYTES123;       /* TOP OF QUEUE PTR              */ 03632000
         SLR   R15WORK,R15WORK                                     1092 03633000
         ICM   R15WORK,7,BYTES123(R1WORK)                          1092 03634000
*   DO WHILE(R15WORK^=ZERO);        /* DO000068: CHECK ALL SPQE'S ON    03635000
*                                      QUEUE                         */ 03636000
         B     @DE01093                                            1093 03637000
@DL01093 DS    0H                                                  1094 03638000
*/* %FL01880:  D (YES,AT001620,NO,) IS SPQE POINTER = 0 ?            */ 03639000
*/* D (YES,AT001620,NO,) DOES ADDRESSED SPQE HAVE CORRECT ID ?       */ 03640000
*                                                                  1094 03641000
*     IF R15WORK->SPQEID=R0WORK THEN                               1094 03642000
         SLR   @08,@08                                             1094 03643000
         IC    @08,SPQEID(,R15WORK)                                1094 03644000
         CR    R0WORK,@08                                          1094 03645000
         BE    @RT01094                                            1094 03646000
*       GOTO AT001620;              /* SPQE FOUND, RETURN ITS ADDR   */ 03647000
*/* P UPDATE QUEUE CHAINING FIELD ADDRESS (ADDRESS OF SPQEPTR)       */ 03648000
*                                                                  1096 03649000
*     R1WORK=ADDR(R15WORK->SPQEPTR);/* PRECEEDING CHAINING FIELD     */ 03650000
         LR    R1WORK,R15WORK                                      1096 03651000
*/* P (,%FL01880) GET NEXT SPQE PTR                                  */ 03652000
*                                                                  1097 03653000
*     R15WORK=R15WORK->SPQEPTR;     /* NEXT SPQE PTR                 */ 03654000
         L     R15WORK,SPQEPTR(,R15WORK)                           1097 03655000
*   END;                            /* END00068                      */ 03656000
*                                                                  1098 03657000
@DE01093 LTR   R15WORK,R15WORK                                     1098 03658000
         BNZ   @DL01093                                            1098 03659000
*   /*****************************************************************/ 03660000
*   /*                                                               */ 03661000
*   /* FALL THROUGH LOOP MEANS SPQE NOT ON QUEUE. R15WORK WILL BE 0. */ 03662000
*   /* RETURN SPQE PTR TO CALLER - ZERO OR ADDR CORRECT SPQE. RETURN */ 03663000
*   /* ADDR OF FIELD FROM WHICH THIS SPQE CHAINED, IF ANY.           */ 03664000
*   /*                                                               */ 03665000
*   /*****************************************************************/ 03666000
*                                                                  1099 03667000
*/* AT001620: R RETURN TO CALLING POINT                              */ 03668000
*                                                                  1099 03669000
*AT001620:                                                         1099 03670000
*   END SPQESRCH;                   /* END OF SUBROUTINE             */ 03671000
@EL00011 DS    0H                                                  1099 03672000
@EF00011 DS    0H                                                  1099 03673000
@ER00011 BR    @14                                                 1099 03674000
*   RFY                                                            1100 03675000
*     R0WORK UNRSTD;                                               1100 03676000
*   RFY                                                            1101 03677000
*     R1WORK UNRSTD;                                               1101 03678000
*   RFY                                                            1102 03679000
*     R14RET UNRSTD;                                               1102 03680000
*   RFY                                                            1103 03681000
*     R15WORK UNRSTD;                                              1103 03682000
*                                                                  1103 03683000
*/* SPQESRCH: END FLOWCHART                                          */ 03684000
*                                                                  1104 03685000
*                                                                  1104 03686000
*   /*****************************************************************/ 03687000
*   /*                                                               */ 03688000
*   /* SWARTN SUBROUTINE                                             */ 03689000
*   /*                                                               */ 03690000
*   /*****************************************************************/ 03691000
*                                                                  1104 03692000
*SWARTN:                                                           1104 03693000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/* ENTRY POINT              */ 03694000
SWARTN   DS    0H                                                  1105 03695000
*/* SWARTN: CHART  BEGIN FLOWCHART                                   */ 03696000
*/* FOOTING                                                        1105 03697000
*/* SUBROUTINE SHARES SP 236, 237                                    */ 03698000
*/********************************************************************/ 03699000
*/*                                                                  */ 03700000
*/*    SUBROUTINE SWARTN HANDLES SHARING OF SWA, SUBPOOLS 236 AND    */ 03701000
*/*    237. THE SPQE'S FOR THESE SUBPOOLS ARE QUEUED OFF TCBSWA,     */ 03702000
*/*    WHEREAS THE OTHER SPQE'S ARE CHAINED OFF TCBMSS.              */ 03703000
*/*                                                                  */ 03704000
*/*    SUBROUTINES CALLED: SHARESWA, MOVELIST                        */ 03705000
*/*                                                                  */ 03706000
*/*    SYSTEM MACROS INVOKED: NONE                                   */ 03707000
*/*                                                                  */ 03708000
*/*    RETURN CODES: X00NOERR, ABEND82A, ABEND92A (RETURN CODE       */ 03709000
*/*                  FROM SUBROUTINE SHARESWA)                       */ 03710000
*/*                                                                  */ 03711000
*/*    REGISTER USAGE: NORMAL                                        */ 03712000
*/*                                                                  */ 03713000
*/*    LEVEL - 1                                                     */ 03714000
*/*                                                                  */ 03715000
*/********************************************************************/ 03716000
*/* E ENTER SWARTN                                                   */ 03717000
*                                                                  1105 03718000
*   RFY                                                            1105 03719000
*     R14RET RSTD;                                                 1105 03720000
*   WKRTSAVE=R14RET;                /* SAVE RETURN ADDRESS AROUND  1106 03721000
*                                      SUBROUTINE CALLS.             */ 03722000
         ST    R14RET,WKRTSAVE(,R3WORKAD)                          1106 03723000
*   RFY                                                            1107 03724000
*     R14RET UNRSTD;                                               1107 03725000
*   RFY                                                            1108 03726000
*     R15RETCD RSTD;                /*                       @Z30ENVB*/ 03727000
*/* D (NO,AT001490,YES,) WAS NSHSPV OR NSHSPL SPECIFIED ?            */ 03728000
*                                                                  1109 03729000
*   IF ATTNSHLV^=ZERO THEN                                         1109 03730000
         L     @14,ATTNSHLV(,R3WORKAD)                             1109 03731000
         LTR   @14,@14                                             1109 03732000
         BZ    @RF01109                                            1109 03733000
*     DO;                           /* DO000043: PROCESS 'DON'T    1110 03734000
*                                      SHARE' REQUEST                */ 03735000
*/* D (NO,%FL01540,YES,) WAS NSHSPV SPECIFIED ?                      */ 03736000
*                                                                  1111 03737000
*       IF ATNSHRSP='0'B THEN                                      1111 03738000
         TM    ATNSHRSP(R3WORKAD),B'10000000'                      1111 03739000
         BNZ   @RF01111                                            1111 03740000
*         DO;                       /* DO000044: PROCESS VALUE     1112 03741000
*                                      PARAMETER                     */ 03742000
*/* D (YES,%FL01550,NO,AT001460) IS SPECIFIED VALUE VALID ?          */ 03743000
*/*    ONLY SUBPOOLS 236 AND 237 MAY BE SPECIFIED FOR 'DON'T SHARE'  */ 03744000
*                                                                  1113 03745000
*           RFY                                                    1113 03746000
*             R1WORK RSTD;                                         1113 03747000
*           R1WORK=SP237;           /* FIRST POSSIBLE SHARE ID       */ 03748000
         LA    @08,237                                             1114 03749000
         LR    R1WORK,@08                                          1114 03750000
*           IF ATTNSHLV^=SP236 THEN /* 236 ?                         */ 03751000
         LA    @07,236                                             1115 03752000
         CR    @14,@07                                             1115 03753000
         BE    @RF01115                                            1115 03754000
*             DO;                   /* DO000046                      */ 03755000
*               R1WORK=SP236;       /* OTHER POSSIBLE SHARE ID       */ 03756000
         LR    R1WORK,@07                                          1117 03757000
*               IF ATTNSHLV^=SP237 THEN/* 237 ?                      */ 03758000
         CR    @14,@08                                             1118 03759000
         BNE   @RT01118                                            1118 03760000
*                 GOTO AT001460;    /* GO SET ABEND CODE             */ 03761000
*             END;                  /* END00046                      */ 03762000
*/* %FL01550: S  SHARESWA: SHARE THE OTHER SUBPOOL                   */ 03763000
*                                                                  1121 03764000
*           CALL SHARESWA;          /* SHARE 236 OR 237, WHICH- EVER    03765000
*                                      NOT SPECIFIED                 */ 03766000
@RF01115 BAL   @14,SHARESWA                                        1121 03767000
*/* D (YES,AT001480,NO,AT001450) ANY ERRORS ?                        */ 03768000
*                                                                  1122 03769000
*           IF R15RETCD^=X00NOERR THEN/*                     @Z30ENVB*/ 03770000
         LTR   R15RETCD,R15RETCD                                   1122 03771000
         BNZ   @RT01122                                            1122 03772000
*             GO TO AT001480;       /* GO EXIT SUBROUTINE    @Z30ENVB*/ 03773000
*         END;                      /* END00044: END VALUE PARM    1124 03774000
*                                      PROCESSING                    */ 03775000
*       ELSE                        /* OTHERWISE, PROCESS LIST       */ 03776000
*         DO;                       /* DO000045: PROCESS LIST      1125 03777000
*                                      PARAMETER                     */ 03778000
         B     @RC01111                                            1125 03779000
@RF01111 DS    0H                                                  1126 03780000
*/* %FL01540: S MOVELIST: GET LENGTH OF LIST                         */ 03781000
*                                                                  1126 03782000
*           RFY                                                    1126 03783000
*             R0WORK RSTD;                                         1126 03784000
*           RFY                                                    1127 03785000
*             R7WORK RSTD;                                         1127 03786000
*           RFY                                                    1128 03787000
*             R8WORK RSTD;                                         1128 03788000
*           R0WORK=ONE;             /* MOVE ONE BYTE                 */ 03789000
         LA    R0WORK,1                                            1129 03790000
*           R8WORK=ADDR(WKTEMP1);   /* SUBLIST (MOVE-TO) ADDRESS     */ 03791000
         LA    R8WORK,WKTEMP1(,R3WORKAD)                           1130 03792000
*           R7WORK=ATTNSHLV;        /* ADDRESS OF LIST (MOVE-FROM)   */ 03793000
         L     R7WORK,ATTNSHLV(,R3WORKAD)                          1131 03794000
*           CALL MOVELIST;          /* FIRST BYTE OF LIST IS LENGTH     03795000
*                                      OF REMAINDER OF LIST          */ 03796000
         BAL   @14,MOVELIST                                        1132 03797000
*/* D (YES,AT001490,NO,) IS LENGTH = 0 ?                             */ 03798000
*                                                                  1133 03799000
*           R0WORK=R8WORK->ZBYTE;   /* LENGTH OF LIST                */ 03800000
         SLR   R0WORK,R0WORK                                       1133 03801000
         IC    R0WORK,ZBYTE(,R8WORK)                               1133 03802000
*           IF R0WORK=ZERO THEN     /* IF NO ENTRIES                 */ 03803000
         LTR   R0WORK,R0WORK                                       1134 03804000
         BZ    @RT01134                                            1134 03805000
*             GOTO AT001490;        /* NO ENTRIES, SHARE BOTH 236,237*/ 03806000
*/* D (NO,%FL01570,YES,) IS LIST LENGTH > MAX SUBLIST LENGTH ?       */ 03807000
*                                                                  1136 03808000
*           IF R0WORK>LENGTH(WKTEMPS) THEN                         1136 03809000
*                                                                  1136 03810000
         LA    @14,32                                              1136 03811000
         CR    R0WORK,@14                                          1136 03812000
         BNH   @RF01136                                            1136 03813000
*/* P MOVE LENGTH = MAX                                              */ 03814000
*                                                                  1137 03815000
*             R0WORK=LENGTH(WKTEMPS);/* RESET TO MAX LENGTH          */ 03816000
         LR    R0WORK,@14                                          1137 03817000
*/* %FL01570: S MOVELIST: MOVE LIST INTO WORKAREA                    */ 03818000
*/* LIST LENGTH SHOULD NEVER EXCEED 2. IN ANY CASE, NO MORE THAN THE */ 03819000
*/* NUMBER OF ENTRIES THAT WILL FIT INTO THE MAX LENGTH SUBLIST ARE  */ 03820000
*/* PROCESSED.                                                       */ 03821000
*                                                                  1138 03822000
*           R7WORK=R7WORK+ONE;      /* ADDR OF FIRST ENTRY           */ 03823000
@RF01136 AH    R7WORK,@CH00061                                     1138 03824000
*           CALL MOVELIST;          /* MOVE ENTRIES TO BE CHECKED    */ 03825000
         BAL   @14,MOVELIST                                        1139 03826000
*/* D (NO,AT001460,YES,) ARE ALL LIST ENTRIES VALID ?                */ 03827000
*                                                                  1140 03828000
*           WKSWASWS=ZERO;          /* CLEAR FLAGS                   */ 03829000
         MVI   WKSWASWS(R3WORKAD),X'00'                            1140 03830000
*           DO R0WORK=R0WORK TO 1 BY-1;/* DO000047: CHECK ENTIRE   1141 03831000
*                                      SUBLIST                       */ 03832000
         B     @DE01141                                            1141 03833000
@DL01141 DS    0H                                                  1142 03834000
*             IF R8WORK->ZBYTE=SP236 THEN/* 236 ?                    */ 03835000
         CLI   ZBYTE(R8WORK),236                                   1142 03836000
         BNE   @RF01142                                            1142 03837000
*               WK236SW='1'B;       /* SET INDICATOR                 */ 03838000
         OI    WK236SW(R3WORKAD),B'10000000'                       1143 03839000
*             ELSE                  /* NOT 236                       */ 03840000
*               IF R8WORK->ZBYTE=SP237 THEN/* 237 ?                  */ 03841000
         B     @RC01142                                            1144 03842000
@RF01142 CLI   ZBYTE(R8WORK),237                                   1144 03843000
         BNE   @RF01144                                            1144 03844000
*                 WK237SW='1'B;     /* SET INDICATOR                 */ 03845000
         OI    WK237SW(R3WORKAD),B'01000000'                       1145 03846000
*               ELSE                /* NEITHER 236 NOR 237           */ 03847000
*                 GOTO AT001460;    /* GO SET ABEND CODE             */ 03848000
*             R8WORK=R8WORK+ONE;    /* NEXT ENTRY ADDR               */ 03849000
@RC01142 AH    R8WORK,@CH00061                                     1147 03850000
*           END;                    /* END00047: END SUBLIST CHECK   */ 03851000
         BCTR  R0WORK,0                                            1148 03852000
@DE01141 LTR   R0WORK,R0WORK                                       1148 03853000
         BP    @DL01141                                            1148 03854000
*/* D (YES,AT001470,NO,) IS ID 236 IN LIST ?                         */ 03855000
*                                                                  1149 03856000
*           IF WK236SW='0'B THEN                                   1149 03857000
*                                                                  1149 03858000
         TM    WK236SW(R3WORKAD),B'10000000'                       1149 03859000
         BNZ   @RF01149                                            1149 03860000
*/* S SHARESWA: SHARE SUBPOOL 236                                    */ 03861000
*                                                                  1150 03862000
*             DO;                   /* DO000048                      */ 03863000
*               R1WORK=SP236;       /* SWA ID                        */ 03864000
         LA    R1WORK,236                                          1151 03865000
*               CALL SHARESWA;      /* SHARE 236                     */ 03866000
         BAL   @14,SHARESWA                                        1152 03867000
*/* D (YES,AT001480,NO,) ANY ERRORS ?                                */ 03868000
*                                                                  1153 03869000
*               IF R15RETCD^=X00NOERR THEN/*                 @Z30ENVB*/ 03870000
         LTR   R15RETCD,R15RETCD                                   1153 03871000
         BNZ   @RT01153                                            1153 03872000
*                 GO TO AT001480;   /* GO EXIT SUBROUTINE    @Z30ENVB*/ 03873000
*             END;                  /* END00048: END 236 CHECK       */ 03874000
*           RFY                                                    1156 03875000
*             R7WORK UNRSTD;                                       1156 03876000
*                                                                  1156 03877000
@RF01149 DS    0H                                                  1157 03878000
*/* AT001470: D (YES,AT001450,NO,) IS SP ID 237 IN LIST ?            */ 03879000
*                                                                  1157 03880000
*AT001470:                                                         1157 03881000
*           IF WK237SW='0'B THEN                                   1157 03882000
*                                                                  1157 03883000
AT001470 TM    WK237SW(R3WORKAD),B'01000000'                       1157 03884000
         BNZ   @RF01157                                            1157 03885000
*/* S SHARESWA: SHARE SUBPOOL 237                                    */ 03886000
*                                                                  1158 03887000
*             DO;                   /* DO000049                      */ 03888000
*               R1WORK=SP237;       /* CALL IS FOR SP 237            */ 03889000
         LA    R1WORK,237                                          1159 03890000
*               CALL SHARESWA;      /* SHARE SUBPOOL                 */ 03891000
         BAL   @14,SHARESWA                                        1160 03892000
*/* D (YES,AT001480,NO,AT001450) ANY ERRORS ?                        */ 03893000
*                                                                  1161 03894000
*               IF R15RETCD^=X00NOERR THEN/*                 @Z30ENVB*/ 03895000
         LTR   R15RETCD,R15RETCD                                   1161 03896000
         BNZ   @RT01161                                            1161 03897000
*                 GO TO AT001480;   /* GO EXIT SUBROUTINE    @Z30ENVB*/ 03898000
*             END;                  /* END00049: END 237 CHECK       */ 03899000
*           RFY                                                    1164 03900000
*             R0WORK UNRSTD;                                       1164 03901000
@RF01157 DS    0H                                                  1165 03902000
*           RFY                                                    1165 03903000
*             R8WORK UNRSTD;                                       1165 03904000
*         END;                      /* END00045: END LIST PROCESSING */ 03905000
*     END;                          /* END00043: END 'DON'T SHARE' 1167 03906000
*                                      SWA PROCESS                   */ 03907000
*                                                                  1167 03908000
*   /*****************************************************************/ 03909000
*   /*                                                               */ 03910000
*   /* NEITHER NSHSPV NOR NSHSPL SPECIFIED, HENCE BOTH SUBPOOLS 236  */ 03911000
*   /* AND 237 ARE TO BE SHARED AUTOMATICALLY.                       */ 03912000
*   /*                                                               */ 03913000
*   /*****************************************************************/ 03914000
*                                                                  1168 03915000
*   ELSE                                                           1168 03916000
*AT001490:                                                         1168 03917000
*     DO;                           /* DO000050: SHARE BOTH 236 AND     03918000
*                                      237                           */ 03919000
         B     @RC01109                                            1168 03920000
@RF01109 DS    0H                                                  1168 03921000
AT001490 DS    0H                                                  1169 03922000
*/* AT001490: S SHARESWA: SHARE SP 236                               */ 03923000
*                                                                  1169 03924000
*       R1WORK=SP236;               /* CALL IS FOR SP 236            */ 03925000
         LA    R1WORK,236                                          1169 03926000
*       CALL SHARESWA;              /* SHARE SUBPOOL                 */ 03927000
         BAL   @14,SHARESWA                                        1170 03928000
*/* D (YES,AT001480,NO,) ANY ERRORS ?                                */ 03929000
*                                                                  1171 03930000
*       IF R15RETCD^=X00NOERR THEN  /*                       @Z30ENVB*/ 03931000
         LTR   R15RETCD,R15RETCD                                   1171 03932000
         BNZ   @RT01171                                            1171 03933000
*         GO TO AT001480;           /* GO EXIT SUBROUTINE    @Z30ENVB*/ 03934000
*/* S SHARESWA: SHARE SP 237                                         */ 03935000
*                                                                  1173 03936000
*       R1WORK=SP237;               /* CALL IS FOR SP 237            */ 03937000
         LA    R1WORK,237                                          1173 03938000
*       CALL SHARESWA;              /* SHARE SUBPOOL                 */ 03939000
         BAL   @14,SHARESWA                                        1174 03940000
*/* D (YES,AT001480,NO,) ANY ERRORS ?                                */ 03941000
*                                                                  1175 03942000
*       IF R15RETCD^=X00NOERR THEN  /*                       @Z30ENVB*/ 03943000
         LTR   R15RETCD,R15RETCD                                   1175 03944000
         BNZ   @RT01175                                            1175 03945000
*         GO TO AT001480;           /* GO EXIT SUBROUTINE    @Z30ENVB*/ 03946000
*     END;                          /* END00050: END 'AUTOMATIC'   1177 03947000
*                                      SHARE OF BOTH                 */ 03948000
*/* AT001450: P SET RETURN CODE 0                                    */ 03949000
*                                                                  1178 03950000
*   RFY                                                            1178 03951000
*     R15RETCD RSTD;                                               1178 03952000
@RC01109 DS    0H                                                  1179 03953000
*AT001450:                                                         1179 03954000
*   R15RETCD=X00NOERR;              /* SET RETURN CODE 0             */ 03955000
AT001450 SLR   R15RETCD,R15RETCD                                   1179 03956000
*/* AT001480: R RETURN TO CALLING POINT                              */ 03957000
*                                                                  1180 03958000
*   RFY                                                            1180 03959000
*     R14RET RSTD;                                                 1180 03960000
*AT001480:                                                         1181 03961000
*   R14RET=WKRTSAVE;                /* RETURN ADDRESS                */ 03962000
AT001480 L     R14RET,WKRTSAVE(,R3WORKAD)                          1181 03963000
*   RETURN;                         /* RETURN TO MAINLINE CALLING PT */ 03964000
@EL00012 DS    0H                                                  1182 03965000
@EF00012 DS    0H                                                  1182 03966000
@ER00012 BR    @14                                                 1182 03967000
*/* AT001460: P (,AT001480) INDICATE ABEND CODE 82A                  */ 03968000
*                                                                  1183 03969000
*AT001460:                                                         1183 03970000
*   R15RETCD=ABEND82A;              /* ABEND CODE, INVALID SWA SP ID */ 03971000
AT001460 LA    R15RETCD,2090                                       1183 03972000
*   GOTO AT001480;                  /* GO TO EXIT SUBROUTINE         */ 03973000
         B     AT001480                                            1184 03974000
*/* SWARTN: END FLOWCHART                                            */ 03975000
*                                                                  1185 03976000
*   END SWARTN;                     /* END SUBROUTINE                */ 03977000
*   RFY                                                            1186 03978000
*     R14RET UNRSTD;                                               1186 03979000
*   RFY                                                            1187 03980000
*     R15RETCD UNRSTD;                                             1187 03981000
*   RFY                                                            1188 03982000
*     R1WORK UNRSTD;                                               1188 03983000
*                                                                  1189 03984000
*   /*****************************************************************/ 03985000
*   /*                                                               */ 03986000
*   /* SHARESWA SUBROUTINE                                           */ 03987000
*   /*                                                               */ 03988000
*   /*****************************************************************/ 03989000
*                                                                  1189 03990000
*SHARESWA:                                                         1189 03991000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/* ENTRY POINT              */ 03992000
SHARESWA DS    0H                                                  1190 03993000
*/* SHARESWA: CHART BEGIN FLOWCHART                                  */ 03994000
*/* FOOTING                                                        1190 03995000
*/* SUBROUTINE SHARES ONE SWA SUBPOOL                                */ 03996000
*/********************************************************************/ 03997000
*/*                                                                  */ 03998000
*/*    SUBROUTINE SHARESWA WILL SHARE SUBPOOL 236 OR 237, WHICHEVER  */ 03999000
*/*    IS SPECIFIED, IF AND ONLY IF THE SPECIFIED SUBPOOL ALREADY    */ 04000000
*/*    EXISTS FOR THE ATTACHING TASK TCB.                            */ 04001000
*/*                                                                  */ 04002000
*/*    SUBROUTINES CALLED: GETSPQE                                   */ 04003000
*/*                                                                  */ 04004000
*/*    SYSTEM MACROS ISSUED: NONE                                    */ 04005000
*/*                                                                  */ 04006000
*/*    RETURN CODES SET: NONE (RETURN CODES RETURNED FROM            */ 04007000
*/*                      SUBROUTINE GETSPQE)                         */ 04008000
*/*                                                                  */ 04009000
*/*    REGISTER USAGE: R1WORK CONTAINS THE SP ID UPON ENTRY          */ 04010000
*/*                                                                  */ 04011000
*/********************************************************************/ 04012000
*/* E ENTER SHARESWA                                                 */ 04013000
*                                                                  1190 04014000
*   RFY                                                            1190 04015000
*     R0WORK RSTD;                                                 1190 04016000
*   RFY                                                            1191 04017000
*     R1WORK RSTD;                                                 1191 04018000
*   RFY                                                            1192 04019000
*     R14RET RSTD;                                                 1192 04020000
*                                                                  1192 04021000
*/* P SAVE REGISTERS                                                 */ 04022000
*                                                                  1193 04023000
*   RFY                                                            1193 04024000
*     R7WORK RSTD;                                                 1193 04025000
*   RFY                                                            1194 04026000
*     R8WORK RSTD;                                                 1194 04027000
*   RFY                                                            1195 04028000
*     R10WORK RSTD;                                                1195 04029000
*   RFY                                                            1196 04030000
*     R11WORK RSTD;                                                1196 04031000
*   RFY                                                            1197 04032000
*     R15RETCD RSTD;                /*                       @Z30ENVB*/ 04033000
*   WKSAVEA=R7WORK;                                                1198 04034000
         ST    R7WORK,WKSAVEA(,R3WORKAD)                           1198 04035000
*   WKSAVEB=R8WORK;                                                1199 04036000
         ST    R8WORK,WKSAVEB(,R3WORKAD)                           1199 04037000
*   WKSAVEC=R10WORK;                                               1200 04038000
         ST    R10WORK,WKSAVEC(,R3WORKAD)                          1200 04039000
*   WKSAVED=R11WORK;                                               1201 04040000
         ST    R11WORK,WKSAVED(,R3WORKAD)                          1201 04041000
*   WKSAVEE=R1WORK;                 /*                       @Z30ENVB*/ 04042000
         ST    R1WORK,WKSAVEE(,R3WORKAD)                           1202 04043000
*   R15RETCD=R15RETCD-R15RETCD;     /* CLEAR RETURN CODE     @Z30ENVB*/ 04044000
         SLR   R15RETCD,R15RETCD                                   1203 04045000
*   RFY                                                            1204 04046000
*     R7WORK UNRSTD;                                               1204 04047000
*   RFY                                                            1205 04048000
*     R8WORK UNRSTD;                                               1205 04049000
*   RFY                                                            1206 04050000
*     R10WORK UNRSTD;                                              1206 04051000
*   RFY                                                            1207 04052000
*     R11WORK UNRSTD;                                              1207 04053000
*                                                                  1207 04054000
*/* M GET QUEUE PTR (TCBSWA)                                         */ 04055000
*                                                                  1208 04056000
*   RFY                                                            1208 04057000
*     R7WORK RSTD;                                                 1208 04058000
*   R7WORK=R4CURTCB->TCBSWA;        /* PTR TO FIRST SWA SPQE         */ 04059000
         L     R7WORK,TCBSWA(,R4CURTCB)                            1209 04060000
*   DO WHILE(R7WORK^=ZERO);         /* DO000051: CHECK ALL SPQE'S ON    04061000
*                                      QUEUE                         */ 04062000
         B     @DE01210                                            1210 04063000
@DL01210 DS    0H                                                  1211 04064000
*/* %FL01580: D (YES,AT001500,NO,) IS THIS SPQE PTR = 0 ?            */ 04065000
*/* D (YES,AT001510,NO,) IS SPQEID = INPUT ID ?                      */ 04066000
*                                                                  1211 04067000
*     IF R7WORK->SPQEID=R1WORK THEN                                1211 04068000
         SLR   @08,@08                                             1211 04069000
         IC    @08,SPQEID(,R7WORK)                                 1211 04070000
         CR    R1WORK,@08                                          1211 04071000
         BE    @RT01211                                            1211 04072000
*       GOTO AT001510;              /* GO SHARE SUBPOOL              */ 04073000
*/* P (,%FL01580) GET NEXT SPQE PTR (SPQEPTR)                        */ 04074000
*                                                                  1213 04075000
*     R7WORK=R7WORK->SPQEPTR;       /* NEXT SWA SPQE PTR             */ 04076000
         L     R7WORK,SPQEPTR(,R7WORK)                             1213 04077000
*   END;                            /* END00051: END CHECK OF QUEUE  */ 04078000
*                                                                  1214 04079000
@DE01210 LTR   R7WORK,R7WORK                                       1214 04080000
         BNZ   @DL01210                                            1214 04081000
*   /*****************************************************************/ 04082000
*   /*                                                               */ 04083000
*   /* FALL THROUGH LOOP MEANS SUBPOOL NOT FOUND, HENCE NOT SHARED   */ 04084000
*   /*                                                               */ 04085000
*   /*****************************************************************/ 04086000
*                                                                  1215 04087000
*/* AT001500: P RESTORE REGISTERS                                    */ 04088000
*                                                                  1215 04089000
*   RFY                                                            1215 04090000
*     R8WORK RSTD;                                                 1215 04091000
*   RFY                                                            1216 04092000
*     R10WORK RSTD;                                                1216 04093000
*   RFY                                                            1217 04094000
*     R11WORK RSTD;                                                1217 04095000
*AT001500:                                                         1218 04096000
*   R7WORK=WKSAVEA;                 /* EXIT CODE                     */ 04097000
AT001500 L     R7WORK,WKSAVEA(,R3WORKAD)                           1218 04098000
*   R8WORK=WKSAVEB;                                                1219 04099000
         L     R8WORK,WKSAVEB(,R3WORKAD)                           1219 04100000
*   R10WORK=WKSAVEC;                                               1220 04101000
         L     R10WORK,WKSAVEC(,R3WORKAD)                          1220 04102000
*   R11WORK=WKSAVED;                                               1221 04103000
         L     R11WORK,WKSAVED(,R3WORKAD)                          1221 04104000
*   RFY                                                            1222 04105000
*     R8WORK UNRSTD;                                               1222 04106000
*   RFY                                                            1223 04107000
*     R10WORK UNRSTD;                                              1223 04108000
*   RFY                                                            1224 04109000
*     R11WORK UNRSTD;                                              1224 04110000
*   RFY                                                            1225 04111000
*     R15RETCD UNRSTD;              /*                       @Z30ENVB*/ 04112000
*/* R RETURN TO CALLING POINT                                        */ 04113000
*                                                                  1226 04114000
*   RETURN;                         /* RETURN TO SUBROUTINE CALLER   */ 04115000
*                                                                  1226 04116000
@EL00013 DS    0H                                                  1226 04117000
@EF00013 DS    0H                                                  1226 04118000
@ER00013 BR    @14                                                 1226 04119000
*   /*****************************************************************/ 04120000
*   /*                                                               */ 04121000
*   /* PROCESS SHARE SWA HERE                                        */ 04122000
*   /*                                                               */ 04123000
*   /*****************************************************************/ 04124000
*                                                                  1227 04125000
*/* AT001510: S GETSPQE: OBTAIN STORAGE FOR SPQE                     */ 04126000
*                                                                  1227 04127000
*AT001510:                                                         1227 04128000
*   RFY                                                            1227 04129000
*     R10WORK RSTD;                 /*                       @Z30ENVB*/ 04130000
AT001510 DS    0H                                                  1228 04131000
*   R10WORK=R14RET;                 /* SAVE RETURN ADDR      @Z30ENVB*/ 04132000
         LR    R10WORK,R14RET                                      1228 04133000
*   CALL GETSPQE;                   /* GET SPQE STORAGE FOR NEW TCB     04134000
*                                                            @Z30ENVB*/ 04135000
         BAL   @14,GETSPQE                                         1229 04136000
*   R14RET=R10WORK;                 /* RESTORE RETURN ADDR   @Z30ENVB*/ 04137000
         LR    R14RET,R10WORK                                      1230 04138000
*   RFY                                                            1231 04139000
*     R10WORK UNRSTD;               /*                       @Z30ENVB*/ 04140000
*/* D (YES,AT001500,NO,) ANY ERRORS ?                                */ 04141000
*                                                                  1232 04142000
*   IF R15RETCD^=X00NOERR THEN      /*                       @Z30ENVB*/ 04143000
         LTR   R15RETCD,R15RETCD                                   1232 04144000
         BNZ   @RT01232                                            1232 04145000
*     GO TO AT001500;               /* GO EXIT SUBROUTINE    @Z30ENVB*/ 04146000
*   RFY                                                            1234 04147000
*     R8WORK RSTD;                  /*                       @Z30ENVB*/ 04148000
*   R8WORK=R1WORK;                  /* ADDRESS SPQE OBTAINED @Z30ENVB*/ 04149000
         LR    R8WORK,R1WORK                                       1235 04150000
*   R1WORK=WKSAVEE;                 /* RESTORE SUBPOOL ID    @Z30ENVB*/ 04151000
         L     R1WORK,WKSAVEE(,R3WORKAD)                           1236 04152000
*/* P PROPAGATE FIELD SPQEKEY                                        */ 04153000
*                                                                  1237 04154000
*   R8WORK->SPQEKEY=R7WORK->SPQEKEY;/* PROPAGATE OWNING KEY          */ 04155000
         MVC   SPQEKEY(1,R8WORK),SPQEKEY(R7WORK)                   1237 04156000
*/* P SET SPQEID TO SPECIFIED ID                                     */ 04157000
*                                                                  1238 04158000
*   R8WORK->SPQEID=R1WORK;          /* SET SUBPOOL ID TO ENTRY VALUE */ 04159000
         STC   R1WORK,SPQEID(,R8WORK)                              1238 04160000
*   RFY                                                            1239 04161000
*     R1WORK UNRSTD;                                               1239 04162000
*                                                                  1239 04163000
*/* D (NO,%FL01590,YES,) DOES CURRENT TASK OWN THIS SUBPOOL ?        */ 04164000
*                                                                  1240 04165000
*   IF R7WORK->SPSHARE='0'B THEN                                   1240 04166000
         TM    SPSHARE(R7WORK),B'10000000'                         1240 04167000
         BNZ   @RF01240                                            1240 04168000
*     DO;                           /* DO000095                      */ 04169000
*/* P SET NEW SPQE DQE PTR TO ADDR CURRENT TCB'S SPQE                */ 04170000
*                                                                  1242 04171000
*       R8WORK->SPDQEPTR=R7WORK;    /* OWNING SPQE ADDR              */ 04172000
         ST    R7WORK,SPDQEPTR(,R8WORK)                            1242 04173000
*/* P (,%FL01620) SET CURRENT TASK SPQE'S OWNED-AND- SHARED FLAG ON  */ 04174000
*                                                                  1243 04175000
*       R7WORK->SPQEOWN='1'B;       /* SET BIT (MAY ALREADY BE ON)   */ 04176000
         OI    SPQEOWN(R7WORK),B'00100000'                         1243 04177000
*     END;                          /* END00095                      */ 04178000
*   ELSE                            /* SHARED SUBPOOL                */ 04179000
*/* %FL01590: P PROPAGATE DQE PTR TO NEW SPQE                        */ 04180000
*                                                                  1245 04181000
*     R8WORK->SPDQEPTR=R7WORK->SPDQEPTR;/* OWNING SPQE ADDR          */ 04182000
         B     @RC01240                                            1245 04183000
@RF01240 MVC   SPDQEPTR(4,R8WORK),SPDQEPTR(R7WORK)                 1245 04184000
*/* %FL01620: P SET NEW SPQE'S SHARED-NOT- OWNED FLAG ON             */ 04185000
*                                                                  1246 04186000
*   R8WORK->SPSHARE='1'B;           /* NEW TASK DOES NOT OWN SUBPOOL */ 04187000
@RC01240 OI    SPSHARE(R8WORK),B'10000000'                         1246 04188000
*/* P GET NEW TCB'S TCBSWA  FIELD (SWA QUEUE PTR)                    */ 04189000
*                                                                  1247 04190000
*   RFY                                                            1247 04191000
*     R10WORK RSTD;                                                1247 04192000
*   R10WORK=R5NEWTCB->TCBSWA;       /* PTR TO FIRST SWA SPQE, IF ANY */ 04193000
         L     R10WORK,TCBSWA(,R5NEWTCB)                           1248 04194000
*/* D (NO,%FL01600,YES,) IS SWA QUEUE PTR ^= 0 ?                     */ 04195000
*                                                                  1249 04196000
*   IF R10WORK^=ZERO THEN                                          1249 04197000
*                                                                  1249 04198000
         LTR   R10WORK,R10WORK                                     1249 04199000
         BZ    @RF01249                                            1249 04200000
*/* P (,%FL01610) SET SPQEPTR (NEXT SWA SPQE) TO TCBSWA              */ 04201000
*                                                                  1250 04202000
*     R8WORK->SPQEPTR=R10WORK;      /* NEW SPQE'S CHAIN PTR          */ 04203000
         ST    R10WORK,SPQEPTR(,R8WORK)                            1250 04204000
*/* %FL01600: P SET NEW SPQE'S LAST-ON-QUEUE FLAG ON                 */ 04205000
*                                                                  1251 04206000
*   ELSE                                                           1251 04207000
*     R8WORK->LASTSPQE='1'B;        /* TCBSWA =0 MEANS THIS IS THE 1251 04208000
*                                      FIRST SPQE ON QUEUE, HENCE  1251 04209000
*                                      WILL ALWAYS BE AT END OF QUEUE*/ 04210000
         B     @RC01249                                            1251 04211000
@RF01249 OI    LASTSPQE(R8WORK),B'01000000'                        1251 04212000
*/* %FL01610: P (,AT001500) SET NEW TCB'S TCBSWA  TO ADDR NEW SPQE   */ 04213000
*                                                                  1252 04214000
*   R5NEWTCB->TCBSWA=R8WORK;        /* RESET TOP-OF-QUEUE PTR        */ 04215000
@RC01249 ST    R8WORK,TCBSWA(,R5NEWTCB)                            1252 04216000
*   GOTO AT001500;                  /* GO EXIT SUBROUTINE            */ 04217000
         B     AT001500                                            1253 04218000
*/* SHARESWA: END FLOWCHART                                          */ 04219000
*                                                                  1254 04220000
*   RFY                                                            1254 04221000
*     R0WORK UNRSTD;                                               1254 04222000
*   RFY                                                            1255 04223000
*     R7WORK UNRSTD;                                               1255 04224000
*   RFY                                                            1256 04225000
*     R8WORK UNRSTD;                                               1256 04226000
*   RFY                                                            1257 04227000
*     R10WORK UNRSTD;                                              1257 04228000
*   RFY                                                            1258 04229000
*     R14RET UNRSTD;                                               1258 04230000
*   END SHARESWA;                   /* END OF SUBROUTINE             */ 04231000
*                                                                  1260 04232000
*   /*****************************************************************/ 04233000
*   /*                                                               */ 04234000
*   /* CHAIN SUBROUTINE                                              */ 04235000
*   /*                                                               */ 04236000
*   /*****************************************************************/ 04237000
*                                                                  1260 04238000
*CHAIN:                                                            1260 04239000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/* ENTRY POINT              */ 04240000
CHAIN    DS    0H                                                  1261 04241000
*/* CHAIN: CHART BEGIN FLOWCHART                                     */ 04242000
*/* FOOTING                                                        1261 04243000
*/* SUBROUTINE QUEUES UP NEW TCB                                     */ 04244000
*/********************************************************************/ 04245000
*/*                                                                  */ 04246000
*/*    SUBROUTINE CHAIN PLACES THE NEW TCB ONTO THE READY QUEUE AND  */ 04247000
*/*    FAMILY QUEUE. THE TCB COUNTS IN THE ASCB AND ASXB ARE         */ 04248000
*/*    UPDATED.                                                      */ 04249000
*/*                                                                  */ 04250000
*/* SUBROUTINES CALLED: NONE                                         */ 04251000
*/*                                                                  */ 04252000
*/* SYSTEM ROUTINES CALLED / MACROS ISSUED: NONE                     */ 04253000
*/*                                                                  */ 04254000
*/* RETURN CODES SET: NONE                                           */ 04255000
*/*                                                                  */ 04256000
*/* REGISTER USAGE: NORMAL                                           */ 04257000
*/*                                                                  */ 04258000
*/* LEVEL - 1                                                        */ 04259000
*/*                                                                  */ 04260000
*/********************************************************************/ 04261000
*/* E ENTER CHAIN                                                    */ 04262000
*                                                                  1261 04263000
*   RFY                                                            1261 04264000
*     R1WORK RSTD;                                                 1261 04265000
*   RFY                                                            1262 04266000
*     R7ASCB RSTD;                                                 1262 04267000
*   RFY                                                            1263 04268000
*     R8WORK RSTD;                                                 1263 04269000
*   RFY                                                            1264 04270000
*     R11PTR RSTD;                                                 1264 04271000
*   RFY                                                            1265 04272000
*     R14RET RSTD;                                                 1265 04273000
*                                                                  1265 04274000
*/* M GET PTR TO TOP OF QUEUE (ASXBFTCB) AS 'PRESENT' TCB 0'PREVIOUS'*/ 04275000
*                                                                  1266 04276000
*   R7ASCB=PSAAOLD;                 /* ASCB ADDRESS                  */ 04277000
         L     R7ASCB,PSAAOLD                                      1266 04278000
*   R11PTR=R7ASCB->ASCBASXB;        /* ASXB ADDRESS                  */ 04279000
         L     R11PTR,ASCBASXB(,R7ASCB)                            1267 04280000
*   R8WORK=R11PTR->ASXBFTCB;        /* TOP TCB ON READY QUEUE        */ 04281000
         L     R8WORK,ASXBFTCB(,R11PTR)                            1268 04282000
*   R1WORK=ZERO;                    /* INITIALIZE 'PREVIOUS' PTR     */ 04283000
*                                                                  1269 04284000
         SLR   R1WORK,R1WORK                                       1269 04285000
*   /*****************************************************************/ 04286000
*   /*                                                               */ 04287000
*   /* THE ASSUMPTION IS MADE THAT THE TOP TCB WILL NOT CHANGE       */ 04288000
*   /*                                                               */ 04289000
*   /*****************************************************************/ 04290000
*                                                                  1270 04291000
*   DO WHILE(R8WORK^=ZERO);         /* DO000042: LOOP THROUGH READY     04292000
*                                      QUEUE                         */ 04293000
         B     @DE01270                                            1270 04294000
@DL01270 DS    0H                                                  1271 04295000
*/* %FL01520: D (YES,%FL01460,NO,) IS 'PRESENT' PTR = 0 ?            */ 04296000
*/* D (YES,AT001430,NO,) IS THIS TCB'S DISP < NEW TCB'S ?            */ 04297000
*                                                                  1271 04298000
*     IF R8WORK->TCBDSP<R5NEWTCB->TCBDSP THEN                      1271 04299000
         CLC   TCBDSP(1,R8WORK),TCBDSP(R5NEWTCB)                   1271 04300000
         BL    @RT01271                                            1271 04301000
*       GOTO AT001430;              /* GO CHAIN NEW ABOVE THIS TCB   */ 04302000
*/* P SET 'PREVIOUS' TCB PTR TO 'PRESENT' TCB PTR                    */ 04303000
*                                                                  1273 04304000
*     R1WORK=R8WORK;                /* SAVE 'PREVIOUS' TCB PTR       */ 04305000
         LR    R1WORK,R8WORK                                       1273 04306000
*/* P (,%FL01520) SET 'PRESENT' TCB PTR TO ADDR OF NEXT TCB ON QUEUE */ 04307000
*                                                                  1274 04308000
*     R8WORK=R8WORK->TCBTCB;        /* GET NEXT TCB ON READY QUEUE   */ 04309000
         L     R8WORK,TCBTCB(,R8WORK)                              1274 04310000
*   END;                            /* END00042: END READY QUEUE LOOP*/ 04311000
*                                                                  1275 04312000
@DE01270 LTR   R8WORK,R8WORK                                       1275 04313000
         BNZ   @DL01270                                            1275 04314000
*   /*****************************************************************/ 04315000
*   /*                                                               */ 04316000
*   /* FALL THROUGH LOOP MEANS TCB GOES AT END OF QUEUE              */ 04317000
*   /*                                                               */ 04318000
*   /*****************************************************************/ 04319000
*                                                                  1276 04320000
*/* %FL01460: P (,AT001440) CHAIN NEW TCB AT END OF READY QUEUE      */ 04321000
*                                                                  1276 04322000
*   R5NEWTCB->TCBBACK=R1WORK;       /* BACK PTR TO PREVIOUSLY LAST   */ 04323000
         ST    R1WORK,TCBBACK(,R5NEWTCB)                           1276 04324000
*   R1WORK->TCBTCB=R5NEWTCB;        /* PREV LAST TCB'S FORWARD PTR TO   04325000
*                                      NEW TCB                       */ 04326000
         ST    R5NEWTCB,TCBTCB(,R1WORK)                            1277 04327000
*   R11PTR->ASXBLTCB=R5NEWTCB;      /* BOTTOM OF QUEUE PTR TO NEW    */ 04328000
         ST    R5NEWTCB,ASXBLTCB(,R11PTR)                          1278 04329000
*   GOTO AT001440;                  /* BYPASS 'POSITION FOUND' CHAIN */ 04330000
*                                                                  1279 04331000
         B     AT001440                                            1279 04332000
*   /*****************************************************************/ 04333000
*   /*                                                               */ 04334000
*   /* CORRECT POSITION FOUND, CHAIN NEW TCB FOLLOWING 'PREVIOUS' TCB*/ 04335000
*   /* ADDRESSED BY REGISTER R1WORK                                  */ 04336000
*   /*                                                               */ 04337000
*   /*****************************************************************/ 04338000
*                                                                  1280 04339000
*/* AT001430: P CHAIN NEW TCB AFTER 'PREVIOUS' TCB, BEFORE 'PRESENT' */ 04340000
*                                                                  1280 04341000
*AT001430:                                                         1280 04342000
*   R5NEWTCB->TCBTCB=R8WORK;        /* NEW TCB'S FORWARD PTR TO    1280 04343000
*                                      'PRESENT' TCB                 */ 04344000
AT001430 ST    R8WORK,TCBTCB(,R5NEWTCB)                            1280 04345000
*   R1WORK->TCBTCB=R5NEWTCB;        /* 'PREVIOUS' TCB'S FORWARD PTR     04346000
*                                      TO NEW TCB                    */ 04347000
         ST    R5NEWTCB,TCBTCB(,R1WORK)                            1281 04348000
*   R8WORK->TCBBACK=R5NEWTCB;       /* 'PRESENT' TCB'S BACKWARD PTR     04349000
*                                      TO NEW TCB                    */ 04350000
         ST    R5NEWTCB,TCBBACK(,R8WORK)                           1282 04351000
*   R5NEWTCB->TCBBACK=R1WORK;       /* NEW TCB'S BACKWARD PTR TO   1283 04352000
*                                      'PREVIOUS' TCB                */ 04353000
         ST    R1WORK,TCBBACK(,R5NEWTCB)                           1283 04354000
*/* AT001440: P SET ON QUEUE INDICATOR                               */ 04355000
*                                                                  1284 04356000
*AT001440:                                                         1284 04357000
*   WKONQUE='1'B;                   /* FLAG AS QUEUED                */ 04358000
AT001440 OI    WKONQUE(R12SVRB),B'00000100'                        1284 04359000
*/* P CHAIN NEW TCB ONTO FAMILY QUEUE                                */ 04360000
*                                                                  1285 04361000
*   R8WORK=R4CURTCB->TCBLTC;        /* ADDR OF MOST RECENT SUBTASK   */ 04362000
         L     R8WORK,TCBLTC(,R4CURTCB)                            1285 04363000
*   R4CURTCB->TCBLTC=R5NEWTCB;      /* NEW TASK BECOMES MOST RECENT  */ 04364000
         ST    R5NEWTCB,TCBLTC(,R4CURTCB)                          1286 04365000
*   R5NEWTCB->TCBNTC=R8WORK;        /* ADDR OF NEXT SISTER TCB, OR 0 */ 04366000
         ST    R8WORK,TCBNTC(,R5NEWTCB)                            1287 04367000
*   R5NEWTCB->TCBOTC=R4CURTCB;      /* ADDR OF MOTHER TCB            */ 04368000
*                                                                  1288 04369000
         ST    R4CURTCB,TCBOTC(,R5NEWTCB)                          1288 04370000
*   /*****************************************************************/ 04371000
*   /*                                                               */ 04372000
*   /* UPDATE TCB COUNTS IN ASCB, ASXB.                              */ 04373000
*   /*                                                               */ 04374000
*   /*****************************************************************/ 04375000
*                                                                  1289 04376000
*/* D (YES,%FL01450,NO,) WAS DISP=NO SPECIFIED ?                     */ 04377000
*                                                                  1289 04378000
*   IF R5NEWTCB->TCBANDSP='0'B THEN /* IF DISP=YES WAS SPECIFIED     */ 04379000
         TM    TCBANDSP(R5NEWTCB),B'00010000'                      1289 04380000
         BNZ   @RF01289                                            1289 04381000
*     DO;                           /* DO000029                      */ 04382000
*/* P INCREMENT TCB READY COUNT (ASCBTCBS) BY 1                      */ 04383000
*                                                                  1291 04384000
*       R8WORK=R7ASCB->ASCBTCBS;    /* CURRENT READY TCB COUNT       */ 04385000
         L     R8WORK,ASCBTCBS(,R7ASCB)                            1291 04386000
*AT001370:                          /* TOP OF COMPARE AND SWAP LOOP  */ 04387000
*       R1WORK=R8WORK+ONE;          /* INCREMENT READY COUNT BY 1    */ 04388000
AT001370 LA    R1WORK,1                                            1292 04389000
         ALR   R1WORK,R8WORK                                       1292 04390000
*       CS(R8WORK,R1WORK,R7ASCB->ASCBTCBS);/* RESET COUNT IF       1293 04391000
*                                      UNCHANGED                     */ 04392000
         CS    R8WORK,@01,ASCBTCBS(R7ASCB)                         1293 04393000
*       BC(7,AT001370);             /* OR GO GET NEW COUNT           */ 04394000
         BC    7,AT001370                                          1294 04395000
*     END;                          /* END00029: END UPDATE OF TCB 1295 04396000
*                                      READY COUNT                   */ 04397000
*/* %FL01450: P INCREMENT TCB COUNT (ASXBTCBS) BY 1                  */ 04398000
*                                                                  1296 04399000
*   R7WORK=R11PTR->ASXBTCBS;        /* COUNT OF TCB'S IN ADDR SPACE,    04400000
*                                      SERIALIZED BY LOCAL LOCK.     */ 04401000
@RF01289 LH    R7WORK,ASXBTCBS(,R11PTR)                            1296 04402000
*   R7WORK=R7WORK+ONE;              /* INCREMENT BY ONE FOR NEW TCB  */ 04403000
         AH    R7WORK,@CH00061                                     1297 04404000
*   R11PTR->ASXBTCBS=R7WORK;        /* SAVE NEW COUNT                */ 04405000
         STH   R7WORK,ASXBTCBS(,R11PTR)                            1298 04406000
*/* R RETURN TO CALLER                                               */ 04407000
*/* CHAIN: END FLOWCHART                                             */ 04408000
*                                                                  1299 04409000
*   RFY                                                            1299 04410000
*     R1WORK UNRSTD;                                               1299 04411000
*   RFY                                                            1300 04412000
*     R7ASCB UNRSTD;                                               1300 04413000
*   RFY                                                            1301 04414000
*     R8WORK UNRSTD;                                               1301 04415000
*   RFY                                                            1302 04416000
*     R11PTR UNRSTD;                                               1302 04417000
*   RFY                                                            1303 04418000
*     R14RET UNRSTD;                                               1303 04419000
*   END CHAIN;                      /* END OF SUBROUTINE             */ 04420000
@EL00014 DS    0H                                                  1304 04421000
@EF00014 DS    0H                                                  1304 04422000
@ER00014 BR    @14                                                 1304 04423000
*                                                                  1305 04424000
*   /*****************************************************************/ 04425000
*   /*                                                               */ 04426000
*   /* MOVELIST SUBROUTINE                                           */ 04427000
*   /*                                                               */ 04428000
*   /*****************************************************************/ 04429000
*                                                                  1305 04430000
*MOVELIST:                                                         1305 04431000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/* ENTRY POINT              */ 04432000
MOVELIST DS    0H                                                  1306 04433000
*/* MOVELIST: CHART  BEGIN FLOWCHART                                 */ 04434000
*/* FOOTING                                                        1306 04435000
*/* SUBROUTINE PERFORMS VALIDITY CHECKING MOVE                       */ 04436000
*/********************************************************************/ 04437000
*/*                                                                  */ 04438000
*/*    SUBROUTINE MOVELIST PERFORMS A VALIDITY CHECKING MOVE. IF A   */ 04439000
*/*    SYSTEM TASK IS ATTACHING, ONLY THE MOVE IS PERFORMED.         */ 04440000
*/*    OTHERWISE, THE BEGINNING AND END ADDRESSES OF THE SOURCE      */ 04441000
*/*    (MOVE-FROM) LOCATION ARE REFERENCED IN THE USER'S KEY, FOR A  */ 04442000
*/*    FETCH PROTECTION TEST. AN INVALID ADDRESS THUS CAUSES THE FRR */ 04443000
*/*    OR ESTAE EXIT TO BE ENTERED, WHERE THE ERROR IS DIAGNOSED.    */ 04444000
*/*                                                                  */ 04445000
*/*    SUBROUTINES CALLED: NONE                                      */ 04446000
*/*                                                                  */ 04447000
*/*    RETURN CODES SET: NONE                                        */ 04448000
*/*                                                                  */ 04449000
*/*    REGISTER USAGE: R0WORK - MOVE LENGTH (ASSUMED <= 256)         */ 04450000
*/*                    R7WORK - MOVE-FROM ADDRESS                    */ 04451000
*/*                    R8WORK - MOVE-TO ADDRESS                      */ 04452000
*/*                   R13WORK - DESTROYED                            */ 04453000
*/*                    R14RET - RETURN ADDRESS                       */ 04454000
*/*                                                                  */ 04455000
*/*    LEVEL - 2                                                     */ 04456000
*/*                                                                  */ 04457000
*/********************************************************************/ 04458000
*/* E ENTER MOVELIST                                                 */ 04459000
*                                                                  1306 04460000
*   RFY                                                            1306 04461000
*     R2WORK RSTD;                                                 1306 04462000
*   RFY                                                            1307 04463000
*     R14RET RSTD;                                                 1307 04464000
*   RFY                                                            1308 04465000
*     R0WORK RSTD;                                                 1308 04466000
*   RFY                                                            1309 04467000
*     R1WORK RSTD;                                                 1309 04468000
*   RFY                                                            1310 04469000
*     R5WORK RSTD;                                                 1310 04470000
*   RFY                                                            1311 04471000
*     R7WORK RSTD;                                                 1311 04472000
*   RFY                                                            1312 04473000
*     R8WORK RSTD;                                                 1312 04474000
*   RFY                                                            1313 04475000
*     R10WORK RSTD;                                                1313 04476000
*   RFY                                                            1314 04477000
*     R11WORK RSTD;                                                1314 04478000
*   RFY                                                            1315 04479000
*     R12WORK RSTD;                                                1315 04480000
*   RFY                                                            1316 04481000
*     R13WORK RSTD;                                                1316 04482000
*   RFY                                                            1317 04483000
*     R15WORK RSTD;                                                1317 04484000
*   R13WORK=R2WORK;                 /* SAVE                          */ 04485000
         LR    R13WORK,R2WORK                                      1318 04486000
*   RFY                                                            1319 04487000
*     R2WORK UNRSTD;                                               1319 04488000
*                                                                  1319 04489000
*/* D (YES,%FL01800,NO,) IS ATTACHOR A SYSTEM TASK ?                 */ 04490000
*                                                                  1320 04491000
*   IF WKSYSTSK='0'B THEN                                          1320 04492000
         TM    WKSYSTSK(R12SVRB),B'10000000'                       1320 04493000
         BNZ   @RF01320                                            1320 04494000
*     DO;                           /* DO000061: FETCH PROTECT CHECK */ 04495000
*/* VALIDITY CHECK ADDRESSES                                         */ 04496000
*                                                                  1322 04497000
*       RFY                                                        1322 04498000
*         R2WORK RSTD;                                             1322 04499000
*       R2WORK=WKPKEY;              /* USER'S PROTECT KEY            */ 04500000
         SLR   R2WORK,R2WORK                                       1323 04501000
         IC    R2WORK,WKPKEY(,R12SVRB)                             1323 04502000
*       GENERATE REFS(R2WORK) NOFLOWS SETS(R2WORK);                1324 04503000
         SPACE                                                          04504000
*/* L MODESET: SET USER'S PROTECT KEY                                */ 04505000
         SPACE                                                          04506000
         MODESET KEYADDR=(2)           SET USER'S PROTECT KEY           04507000
         SPACE                                                          04508000
*/* P FETCH FIRST AND LAST BYTE OF SOURCE AREA                       */ 04509000
         SPACE                                                          04510000
         IC    R2WORK,0(,R7WORK)       CHECK FIRST BYTE                 04511000
         LR    R2WORK,R0WORK           OFFSET TO LAST BYTE = MOVE       04512000
         BCTR  R2WORK,0                  LENGTH - 1                     04513000
         IC    R2WORK,0(R2WORK,R7WORK) CHECK LAST BYTE                  04514000
         SPACE                                                          04515000
*/* L MODESET: RESET PROTECT KEY 0                                   */ 04516000
         SPACE                                                          04517000
         MODESET EXTKEY=SUPR           RESET PROTECT KEY TO 0           04518000
*     END;                          /* END00061: END FETCH PROTECT 1325 04519000
*                                      CHECK                         */ 04520000
*   RFY                                                            1326 04521000
*     R2WORK UNRSTD;                                               1326 04522000
*                                                                  1326 04523000
@RF01320 DS    0H                                                  1327 04524000
*/* %FL01800: P PERFORM MOVE AS REQUESTED                            */ 04525000
*                                                                  1327 04526000
*   R8WORK->AREA(1:R0WORK)=R7WORK->AREA(1:R0WORK);/* MOVE            */ 04527000
         LR    @02,R0WORK                                          1327 04528000
         BCTR  @02,0                                               1327 04529000
         EX    @02,@SM03153                                        1327 04530000
*/* R RETURN TO CALLING POINT                                        */ 04531000
*                                                                  1328 04532000
*   RFY                                                            1328 04533000
*     R2WORK RSTD;                                                 1328 04534000
*   R2WORK=R13WORK;                 /* RESTORE                       */ 04535000
         LR    R2WORK,R13WORK                                      1329 04536000
*/* MOVELIST: END FLOWCHART                                          */ 04537000
*                                                                  1330 04538000
*   END MOVELIST;                   /* END OF SUBROUTINE             */ 04539000
@EL00015 DS    0H                                                  1330 04540000
@EF00015 DS    0H                                                  1330 04541000
@ER00015 BR    @14                                                 1330 04542000
*   RFY                                                            1331 04543000
*     R2WORK UNRSTD;                                               1331 04544000
*   RFY                                                            1332 04545000
*     R14RET UNRSTD;                                               1332 04546000
*   RFY                                                            1333 04547000
*     R0WORK UNRSTD;                                               1333 04548000
*   RFY                                                            1334 04549000
*     R1WORK UNRSTD;                                               1334 04550000
*   RFY                                                            1335 04551000
*     R5WORK UNRSTD;                                               1335 04552000
*   RFY                                                            1336 04553000
*     R7WORK UNRSTD;                                               1336 04554000
*   RFY                                                            1337 04555000
*     R8WORK UNRSTD;                                               1337 04556000
*   RFY                                                            1338 04557000
*     R10WORK UNRSTD;                                              1338 04558000
*   RFY                                                            1339 04559000
*     R11WORK UNRSTD;                                              1339 04560000
*   RFY                                                            1340 04561000
*     R12WORK UNRSTD;                                              1340 04562000
*   RFY                                                            1341 04563000
*     R13WORK UNRSTD;                                              1341 04564000
*   RFY                                                            1342 04565000
*     R15WORK UNRSTD;                                              1342 04566000
*                                                                  1343 04567000
*   /*****************************************************************/ 04568000
*   /*                                                               */ 04569000
*   /* LOCK SUBROUTINE                                               */ 04570000
*   /*                                                               */ 04571000
*   /*****************************************************************/ 04572000
*                                                                  1343 04573000
*LOCK:                                                             1343 04574000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/* ENTRY POINT              */ 04575000
LOCK     DS    0H                                                  1344 04576000
*/* LOCK: CHART  BEGIN FLOWCHART                                     */ 04577000
*/* FOOTING                                                        1344 04578000
*/* OBTAIN LOCK                                                      */ 04579000
*/********************************************************************/ 04580000
*/*                                                                  */ 04581000
*/*    SUBROUTINE LOCK OBTAINS THE LOCAL LOCK AND ESTABLISHES AN FRR */ 04582000
*/*                                                                  */ 04583000
*/*    SUBROUTINES CALLED: NONE                                      */ 04584000
*/*                                                                  */ 04585000
*/*    SYSTEM MACROS ISSUED: SETLOCK, SETFRR                         */ 04586000
*/*                                                                  */ 04587000
*/*    RETURN CODES SET: X00NOERR, ABEND92A                          */ 04588000
*/*                                                                  */ 04589000
*/*    REGISTER USAGE: R0WORK - DESTROYED (SAVE REG FOR R12SVRB)     */ 04590000
*/* R11WORK - DESTROYED (SAVE REG R14RET)                            */ 04591000
*/* R1WORK - DESTROYED (SAVE REG FOR R14RET)                         */ 04592000
*/* R15RETCD - RETURN CODE                                           */ 04593000
*/*                                                                  */ 04594000
*/*    LEVEL - 2                                                     */ 04595000
*/*                                                                  */ 04596000
*/********************************************************************/ 04597000
*/* E ENTER LOCK                                                     */ 04598000
*                                                                  1344 04599000
*   RFY                                                            1344 04600000
*     R0WORK RSTD;                                                 1344 04601000
*   RFY                                                            1345 04602000
*     R1WORK RSTD;                                                 1345 04603000
*   RFY                                                            1346 04604000
*     R7WORK RSTD;                                                 1346 04605000
*   RFY                                                            1347 04606000
*     R8WORK RSTD;                                                 1347 04607000
*   RFY                                                            1348 04608000
*     R2WORK RSTD;                  /* SAVE FOR ERROR ROUTINES       */ 04609000
*   RFY                                                            1349 04610000
*     R10WORK RSTD;                 /* SAVE ATTACH PARM LIST ADDR    */ 04611000
*                                                                  1349 04612000
*   /*****************************************************************/ 04613000
*   /*                                                               */ 04614000
*   /* SAVE REGISTERS 12, 14, DESTROYED                              */ 04615000
*   /*                                                               */ 04616000
*   /*****************************************************************/ 04617000
*                                                                  1350 04618000
*   RFY                                                            1350 04619000
*     R14RET RSTD;                                                 1350 04620000
*   R0WORK=R12SVRB;                 /* SAVE SVRB-WORKAREA ADDR       */ 04621000
         LR    R0WORK,R12SVRB                                      1351 04622000
*   R1WORK=R14RET;                  /* SAVE                          */ 04623000
         LR    R1WORK,R14RET                                       1352 04624000
*   RFY                                                            1353 04625000
*     R14RET UNRSTD;                                               1353 04626000
*   RFY                                                            1354 04627000
*     R13WORK RSTD;                                                1354 04628000
*                                                                  1354 04629000
*/* L SETLOCK: OBTAIN LOCAL LOCK                                     */ 04630000
*                                                                  1355 04631000
*   GENERATE REFS(PSALITA) NOFLOWS;                                1355 04632000
*                                                                  1355 04633000
         SPACE                                                          04634000
         SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                        *04635000
               RELATED=('RELEASED BY SUBROUTINE UNLOCK')                04636000
* REGISTERS 11 - 14 DESTROYED BY SETLOCK                                04637000
         SPACE                                                          04638000
*/* D (YES,%FL01810,NO,) RETURN CODE = 0 ?                           */ 04639000
*                                                                  1356 04640000
*   R12SVRB=R0WORK;                 /* RESTORE                       */ 04641000
         LR    R12SVRB,R0WORK                                      1356 04642000
*   RFY                                                            1357 04643000
*     R0WORK UNRSTD;                                               1357 04644000
*   RFY                                                            1358 04645000
*     R15RETCD RSTD;                                               1358 04646000
*   IF R13WORK^=X00NOERR THEN       /* RETURN CODE IN REG 13         */ 04647000
         LTR   R13WORK,R13WORK                                     1359 04648000
         BZ    @RF01359                                            1359 04649000
*/* P (,%FL01820) SET ABEND CODE 92A                                 */ 04650000
*                                                                  1360 04651000
*     DO;                           /* DO000036                      */ 04652000
*       WKREASON=RCODE12;           /* SET REASON CODE               */ 04653000
         MVI   WKREASON(R12SVRB),X'0C'                             1361 04654000
*       R15RETCD=ABEND92A;          /* ONLY RETURN CODE 0 VALID      */ 04655000
         LA    R15RETCD,2346                                       1362 04656000
*     END;                          /* END00036                      */ 04657000
*   ELSE                            /* SETFRR                 @Y02753*/ 04658000
*     DO;                           /* DO000062               @Y02753*/ 04659000
         B     @RC01359                                            1364 04660000
@RF01359 DS    0H                                                  1365 04661000
*       RFY                                                        1365 04662000
*         R15RETCD UNRSTD;                                         1365 04663000
*       RFY                                                        1366 04664000
*         R14FRRAD RSTD;                                           1366 04665000
*       R14FRRAD=ADDR(IGC042R2);    /* FRR ADDRESS            @Y02753*/ 04666000
         LA    R14FRRAD,IGC042R2                                   1367 04667000
*/* %FL01810: L SETFRR: ESTABLISH FRR                                */ 04668000
*                                                                  1368 04669000
*       GENERATE NOFLOWS REFS(PSACSTK,FRRS,FRRSCURR,FRRSLAST,FRRSELEN,  04670000
*           FRRSENTR,FRRSFRRA,FRRSPARM,PSALSFCC);                  1368 04671000
         SPACE                                                          04672000
         SETFRR A,FRRAD=(R14WORK),PARMAD=(R15WORK),                    *04673000
               WRKREGS=(R11WORK,R13WORK)                        @Y02753 04674000
         SPACE                                                          04675000
*       RFY                                                        1369 04676000
*         R14FRRAD UNRSTD;                                         1369 04677000
*                                                                  1369 04678000
*/* P SAVE FRR WORKAREA PTR IN PERM WORKAREA, AND VICE VERSA         */ 04679000
*                                                                  1370 04680000
*       RFY                                                        1370 04681000
*         R15WORK RSTD;                                            1370 04682000
*       R15WORK->ZWORD=R12SVRB;     /* ATTACH WORKAREA ADDR INTO FRR    04683000
*                                      WORKAREA               @Y02753*/ 04684000
         ST    R12SVRB,ZWORD(,R15WORK)                             1371 04685000
*       WKFRRAD=R15WORK;            /* FRR WORKAREA ADDR INTO ATTACH    04686000
*                                      WORKAREA               @Y02753*/ 04687000
         ST    R15WORK,WKFRRAD(,R12SVRB)                           1372 04688000
*       R15RETCD=X00NOERR;          /* RETURN CODE 0          @Y02753*/ 04689000
         SLR   R15RETCD,R15RETCD                                   1373 04690000
*     END;                          /* END00062               @Y02753*/ 04691000
*/* %FL01820: R RETURN TO CALLING POINT                              */ 04692000
*                                                                  1375 04693000
*   RFY                                                            1375 04694000
*     R14RET RSTD;                                                 1375 04695000
@RC01359 DS    0H                                                  1376 04696000
*   R14RET=R1WORK;                  /* RESTORE RETURN ADDRESS        */ 04697000
         LR    R14RET,R1WORK                                       1376 04698000
*/* LOCK: END FLOWCHART                                              */ 04699000
*                                                                  1377 04700000
*   END LOCK;                       /* END OF SUBROUTINE             */ 04701000
@EL00016 DS    0H                                                  1377 04702000
@EF00016 DS    0H                                                  1377 04703000
@ER00016 BR    @14                                                 1377 04704000
*   RFY                                                            1378 04705000
*     R15WORK UNRSTD;                                              1378 04706000
*   RFY                                                            1379 04707000
*     R2WORK UNRSTD;                                               1379 04708000
*   RFY                                                            1380 04709000
*     R10WORK UNRSTD;                                              1380 04710000
*   RFY                                                            1381 04711000
*     R14RET UNRSTD;                                               1381 04712000
*   RFY                                                            1382 04713000
*     R1WORK UNRSTD;                                               1382 04714000
*   RFY                                                            1383 04715000
*     R7WORK UNRSTD;                                               1383 04716000
*   RFY                                                            1384 04717000
*     R8WORK UNRSTD;                                               1384 04718000
*   RFY                                                            1385 04719000
*     R13WORK UNRSTD;                                              1385 04720000
*                                                                  1386 04721000
*   /*****************************************************************/ 04722000
*   /*                                                               */ 04723000
*   /* UNLOCK SUBROUTINE                                             */ 04724000
*   /*                                                               */ 04725000
*   /*****************************************************************/ 04726000
*                                                                  1386 04727000
*UNLOCK:                                                           1386 04728000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/* ENTRY POINT              */ 04729000
UNLOCK   DS    0H                                                  1387 04730000
*/* UNLOCK: CHART  BEGIN FLOWCHART                                   */ 04731000
*/* FOOTING                                                        1387 04732000
*/* RELEASES LOCK                                                    */ 04733000
*/********************************************************************/ 04734000
*/*                                                                  */ 04735000
*/*    SUBROUTINE UNLOCK RELEASES THE LOCAL LOCK AND CANCELS THE FRR */ 04736000
*/*                                                                  */ 04737000
*/*    SUBROUTINES CALLED: NONE                                      */ 04738000
*/*                                                                  */ 04739000
*/*    SYSTEM MACROS ISSUED: SETLOCK, SETFRR                         */ 04740000
*/*                                                                  */ 04741000
*/*    RETURN CODES: X00NOERR, ABEND92A                              */ 04742000
*/*                                                                  */ 04743000
*/* REGISTER USAGE:                                                  */ 04744000
*/* R0WORK - DESTROYED (SAVE REG FOR R12SVRB)                        */ 04745000
*/* R1WORK - DESTROYED (SAVE REG FOR R14RET)                         */ 04746000
*/* R11WORK - DESTROYED                                              */ 04747000
*/* R15RETCD - DESTROYED                                             */ 04748000
*/*                                                                  */ 04749000
*/*    LEVEL - 2                                                     */ 04750000
*/*                                                                  */ 04751000
*/********************************************************************/ 04752000
*/* E ENTER UNLOCK                                                   */ 04753000
*                                                                  1387 04754000
*   RFY                                                            1387 04755000
*     R0WORK RSTD;                                                 1387 04756000
*   RFY                                                            1388 04757000
*     R1WORK RSTD;                                                 1388 04758000
*   RFY                                                            1389 04759000
*     R7WORK RSTD;                                                 1389 04760000
*   RFY                                                            1390 04761000
*     R8WORK RSTD;                                                 1390 04762000
*   RFY                                                            1391 04763000
*     R10WORK RSTD;                                                1391 04764000
*   RFY                                                            1392 04765000
*     R2WORK RSTD;                  /* SAVE FOR ERROR ROUTINES       */ 04766000
*                                                                  1392 04767000
*   /*****************************************************************/ 04768000
*   /*                                                               */ 04769000
*   /* SAVE REGISTERS DESTROYED                                      */ 04770000
*   /*                                                               */ 04771000
*   /*****************************************************************/ 04772000
*                                                                  1393 04773000
*   RFY                                                            1393 04774000
*     R11WORK RSTD;                                                1393 04775000
*   RFY                                                            1394 04776000
*     R13WORK RSTD;                                                1394 04777000
*   RFY                                                            1395 04778000
*     R14RET RSTD;                                                 1395 04779000
*   R0WORK=R12SVRB;                 /* SAVE SVRB-WORKAREA ADDRESS    */ 04780000
         LR    R0WORK,R12SVRB                                      1396 04781000
*   R1WORK=R14RET;                  /* SAVE                          */ 04782000
         LR    R1WORK,R14RET                                       1397 04783000
*   RFY                                                            1398 04784000
*     R14RET UNRSTD;                                               1398 04785000
*                                                                  1398 04786000
*/* L SETFRR: CANCEL FRR                                             */ 04787000
*                                                                  1399 04788000
*   GENERATE NOFLOWS REFS(PSACSTK,FRRS,FRRSCURR,FRRSEMP,FRRSELEN); 1399 04789000
         SPACE                                                          04790000
         SETFRR D,WRKREGS=(R11WORK,R13WORK)  CANCEL FRR         @Y02753 04791000
         SPACE                                                          04792000
*   WKFRRAD=ZERO;                   /* CLEAR FRR WORKAREA PTR @Y02753*/ 04793000
         SLR   @15,@15                                             1400 04794000
         ST    @15,WKFRRAD(,R12SVRB)                               1400 04795000
*/* L SETLOCK: RELEASE LOCAL LOCK                                    */ 04796000
*                                                                  1401 04797000
*   GENERATE REFS(PSALITA) NOFLOWS;                                1401 04798000
         SPACE                                                          04799000
         SETLOCK RELEASE,TYPE=LOCAL,                                   *04800000
               RELATED=('OBTAINED BY SUBROUTINE LOCK')                  04801000
         SPACE                                                          04802000
*   RFY                                                            1402 04803000
*     R11WORK UNRSTD;                                              1402 04804000
*                                                                  1402 04805000
*/* D (YES,%FL01830,NO,) RETURN CODE = 0 ?                           */ 04806000
*                                                                  1403 04807000
*   RFY                                                            1403 04808000
*     R15RETCD RSTD;                                               1403 04809000
*   IF R13WORK^=X00NOERR THEN       /* 0 ?                           */ 04810000
         LTR   R13WORK,R13WORK                                     1404 04811000
         BZ    @RF01404                                            1404 04812000
*/* P (,%FL01840) SET ABEND CODE 92A                                 */ 04813000
*                                                                  1405 04814000
*     DO;                           /* DO000038                      */ 04815000
*       WKREASON=RCODE16;           /* SET REASON CODE               */ 04816000
         MVI   WKREASON(R12SVRB),X'10'                             1406 04817000
*       R15RETCD=ABEND92A;          /* SETLOCK ERROR                 */ 04818000
         LA    R15RETCD,2346                                       1407 04819000
*     END;                          /* END00038                      */ 04820000
*/* %FL01830: P SET RETURN CODE = 0                                  */ 04821000
*                                                                  1409 04822000
*   ELSE                                                           1409 04823000
*     R15RETCD=X00NOERR;            /* RETURN CODE = 0               */ 04824000
         B     @RC01404                                            1409 04825000
@RF01404 SLR   R15RETCD,R15RETCD                                   1409 04826000
*/* %FL01840: R RETURN TO CALLING POINT                              */ 04827000
*                                                                  1410 04828000
*   RFY                                                            1410 04829000
*     R14RET RSTD;                                                 1410 04830000
@RC01404 DS    0H                                                  1411 04831000
*   R12SVRB=R0WORK;                 /* RESTORE WORKAREA ADDRESS      */ 04832000
         LR    R12SVRB,R0WORK                                      1411 04833000
*   R14RET=R1WORK;                  /* RESTORE RETURN ADDRESS        */ 04834000
         LR    R14RET,R1WORK                                       1412 04835000
*/* UNLOCK: END FLOWCHART                                            */ 04836000
*                                                                  1413 04837000
*   END UNLOCK;                     /* END OF SUBROUTINE             */ 04838000
@EL00017 DS    0H                                                  1413 04839000
@EF00017 DS    0H                                                  1413 04840000
@ER00017 BR    @14                                                 1413 04841000
*   RFY                                                            1414 04842000
*     R0WORK UNRSTD;                                               1414 04843000
*   RFY                                                            1415 04844000
*     R13WORK UNRSTD;                                              1415 04845000
*   RFY                                                            1416 04846000
*     R14RET UNRSTD;                                               1416 04847000
*   RFY                                                            1417 04848000
*     R2WORK UNRSTD;                                               1417 04849000
*   RFY                                                            1418 04850000
*     R15RETCD UNRSTD;                                             1418 04851000
*   RFY                                                            1419 04852000
*     R1WORK UNRSTD;                                               1419 04853000
*   RFY                                                            1420 04854000
*     R7WORK UNRSTD;                                               1420 04855000
*   RFY                                                            1421 04856000
*     R8WORK UNRSTD;                                               1421 04857000
*   RFY                                                            1422 04858000
*     R10WORK UNRSTD;                                              1422 04859000
*                                                                  1423 04860000
*   /*****************************************************************/ 04861000
*   /*                                                               */ 04862000
*   /* RTN1 CLEAN UP ROUTINE                                         */ 04863000
*   /*                                                               */ 04864000
*   /*****************************************************************/ 04865000
*                                                                  1423 04866000
*RTN1:                                                             1423 04867000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/* ENTRY POINT              */ 04868000
RTN1     DS    0H                                                  1424 04869000
*/* RTN1: CHART  BEGIN FLOWCHART                                     */ 04870000
*/* FOOTING                                                        1424 04871000
*/* MAIN CLEAN UP ROUTINE                                            */ 04872000
*/********************************************************************/ 04873000
*/*                                                                  */ 04874000
*/*    SUBROUTINE RTN1 PERFORMS CLEAN-UP PROCESSING COMMON TO NORMAL */ 04875000
*/*    BACKOUT PROCESSING AND THE ESTAE PROCESSING.                  */ 04876000
*/*                                                                  */ 04877000
*/*    SUBROUTINES CALLED: RTN2, RTN3, LOCK, UNLOCK, FREESPQE        */ 04878000
*/*                                                                  */ 04879000
*/*    SYSTEM MACROS ISSUED: FREEMAIN (BRANCH), SETLOCK (TEST)       */ 04880000
*/*                                                                  */ 04881000
*/*    RETURN CODES SET: NONE                                        */ 04882000
*/*                                                                  */ 04883000
*/*    LEVEL - 1                                                     */ 04884000
*/*                                                                  */ 04885000
*/********************************************************************/ 04886000
*/* E ENTER RTN1                                                     */ 04887000
*                                                                  1424 04888000
*   RFY                                                            1424 04889000
*     R2WORK RSTD;                                                 1424 04890000
*   RFY                                                            1425 04891000
*     R14RET RSTD;                                                 1425 04892000
*   R2WORK=R14RET;                  /* SAVE RETURN ADDRESS           */ 04893000
         LR    R2WORK,R14RET                                       1426 04894000
*   RFY                                                            1427 04895000
*     R14RET UNRSTD;                                               1427 04896000
*                                                                  1427 04897000
*/* D (NO,AT001650,YES,) IS THERE A WORKAREA ?                       */ 04898000
*                                                                  1428 04899000
*   IF WKNOAREA='0'B THEN                                          1428 04900000
*                                                                  1428 04901000
         TM    WKNOAREA(R12SVRB),B'00001000'                       1428 04902000
         BNZ   @RF01428                                            1428 04903000
*/* D (NO,AT001650,YES,) IS NEW TCB NOT YET ON DISP QUEUE ?          */ 04904000
*                                                                  1429 04905000
*     IF WKONQUE='0'B THEN                                         1429 04906000
         TM    WKONQUE(R12SVRB),B'00000100'                        1429 04907000
         BNZ   @RF01429                                            1429 04908000
*       DO;                         /* DO000074                      */ 04909000
*         R3WORKAD=WK255PTR;        /* SET WORKAREA ADDRESS          */ 04910000
         L     R3WORKAD,WK255PTR(,R12SVRB)                         1431 04911000
*         R5NEWTCB=WKNEWTCB;        /* SET ADDRESS OF NEW TCB        */ 04912000
         L     R5NEWTCB,WKNEWTCB(,R12SVRB)                         1432 04913000
*/* D (NO,AT001700,YES,) IS LOCAL LOCK NOT HELD ?                    */ 04914000
*                                                                  1433 04915000
*         GENERATE REFS(PSAHLHI) FLOWS(AT001700);                  1433 04916000
*                                                                  1433 04917000
         SPACE                                                          04918000
         SETLOCK TEST,TYPE=LOCAL,BRANCH=(HELD,AT001700) CHECK LOCK      04919000
         SPACE                                                          04920000
*/* S LOCK: OBTAIN LOCAL LOCK                                        */ 04921000
*                                                                  1434 04922000
*         RFY                                                      1434 04923000
*           R15RETCD RSTD;                                         1434 04924000
*         CALL LOCK;                /* GET LOCK AND SET FRR (ALTERS     04925000
*                                      REGS 0,1,11,13,15)            */ 04926000
         BAL   @14,LOCK                                            1435 04927000
*/* D (NO,AT001650,YES,) WAS LOCK OBTAINED ?                         */ 04928000
*                                                                  1436 04929000
*         IF R15RETCD^=X00NOERR THEN                               1436 04930000
         LTR   R15RETCD,R15RETCD                                   1436 04931000
         BNZ   @RT01436                                            1436 04932000
*           GOTO AT001650;          /* EXIT SUBROUTINE               */ 04933000
*         RFY                                                      1438 04934000
*           R15RETCD UNRSTD;                                       1438 04935000
*                                                                  1438 04936000
*/* AT001700: D (NO,%FL00000,YES,) IS NEW TCB PTR ^= 0 ?             */ 04937000
*                                                                  1439 04938000
*AT001700:                                                         1439 04939000
*         IF R5NEWTCB^=ZERO THEN                                   1439 04940000
AT001700 LTR   R5NEWTCB,R5NEWTCB                                   1439 04941000
         BZ    @RF01439                                            1439 04942000
*           DO;                     /* DO000041                      */ 04943000
*/* S RTN2: RECONSTRUCT CURRENT TCB'S TCBMSS QUEUE                   */ 04944000
*                                                                  1441 04945000
*             CALL RTN2;            /* PREPARE FOR FREEMAIN OF SPQE     04946000
*                                      STORAGE, RECONSTRUCT TCBMSS Q */ 04947000
         BAL   @14,RTN2                                            1441 04948000
*/* S RTN3: PROCESS (E)STAI SCB'S AND ETXR IRB                       */ 04949000
*                                                                  1442 04950000
*             CALL RTN3;            /* SCB - IRB CLEAN-UP            */ 04951000
         BAL   @14,RTN3                                            1442 04952000
*             RFY                                                  1443 04953000
*               R8WORK RSTD;        /*                       @Z30ENVB*/ 04954000
*/* D (YES,AT001800,NO,) IS DUMMY TCBMSS QUEUE EMPTY ?               */ 04955000
*                                                                  1444 04956000
*             IF WKTCBMSS^=ZERO THEN/*                       @Z30ENVB*/ 04957000
         L     @07,WKTCBMSS(,R12SVRB)                              1444 04958000
         LTR   @07,@07                                             1444 04959000
         BZ    @RF01444                                            1444 04960000
*               DO;                 /* DO000140: NO          @Z30ENVB*/ 04961000
*/* S FREESPQE: FREE SPQES BUILT FOR CURRENT TCB                     */ 04962000
*                                                                  1446 04963000
*                 R8WORK=WKTCBMSS;  /* GET SPQE PTR FOR SUBROUTINE 1446 04964000
*                                      FREESPQE              @Z30ENVB*/ 04965000
         LR    R8WORK,@07                                          1446 04966000
*                 CALL FREESPQE;    /*                       @Z30ENVB*/ 04967000
         BAL   @14,FREESPQE                                        1447 04968000
*               END;                /* END00140              @Z30ENVB*/ 04969000
*/* AT001800: D (YES,AT001810,NO,) IS NEW TCB TCBMSS QUEUE EMPTY ?   */ 04970000
*                                                                  1449 04971000
*AT001800:                                                         1449 04972000
*             IF R5NEWTCB->TCBMSSB^=ZERO THEN/*              @Z30ENVB*/ 04973000
@RF01444 DS    0H                                                  1449 04974000
AT001800 SLR   @07,@07                                             1449 04975000
         ICM   @07,7,TCBMSSB(R5NEWTCB)                             1449 04976000
         LTR   @07,@07                                             1449 04977000
         BZ    @RF01449                                            1449 04978000
*               DO;                 /* DO000150: NO          @Z30ENVB*/ 04979000
*/* S FREESPQE: FREE SPQES BUILT FOR NEW TCB                         */ 04980000
*                                                                  1451 04981000
*                 R8WORK=R5NEWTCB->TCBMSSB;/* GET SPQE PTR FOR     1451 04982000
*                                      SUBROUTINE FREESPQE   @Z30ENVB*/ 04983000
         LR    R8WORK,@07                                          1451 04984000
*                 CALL FREESPQE;    /*                       @Z30ENVB*/ 04985000
         BAL   @14,FREESPQE                                        1452 04986000
*               END;                /* END00150              @Z30ENVB*/ 04987000
*/* AT001810: D (YES,%FL00000,NO,) IS NEW TCB TCBSWA QUEUE EMPTY ?   */ 04988000
*                                                                  1454 04989000
*AT001810:                                                         1454 04990000
*             IF R5NEWTCB->TCBSWA^=ZERO THEN/*               @Z30ENVB*/ 04991000
@RF01449 DS    0H                                                  1454 04992000
AT001810 L     @07,TCBSWA(,R5NEWTCB)                               1454 04993000
         LTR   @07,@07                                             1454 04994000
         BZ    @RF01454                                            1454 04995000
*               DO;                 /* DO000160: NO          @Z30ENVB*/ 04996000
*/* S FREESPQE: FREE SPQES BUILT FOR NEW TCB                         */ 04997000
*                                                                  1456 04998000
*                 R8WORK=R5NEWTCB->TCBSWA;/* GET SPQE PTR FOR      1456 04999000
*                                      SUBROUTINE FREESPQE   @Z30ENVB*/ 05000000
         LR    R8WORK,@07                                          1456 05001000
*                 CALL FREESPQE;    /*                       @Z30ENVB*/ 05002000
         BAL   @14,FREESPQE                                        1457 05003000
*               END;                /* END00160              @Z30ENVB*/ 05004000
*             RFY                                                  1459 05005000
*               R8WORK UNRSTD;      /*                       @Z30ENVB*/ 05006000
@RF01454 DS    0H                                                  1460 05007000
*           END;                    /* END00041                      */ 05008000
*/* %FL00000: L FREEMAIN: FREE SVRB DE STORAGE                       */ 05009000
*                                                                  1461 05010000
*         RFY                                                      1461 05011000
*           R0WORK RSTD;                                           1461 05012000
@RF01439 DS    0H                                                  1462 05013000
*         RFY                                                      1462 05014000
*           R1AREA RSTD;                                           1462 05015000
*         RFY                                                      1463 05016000
*           R7ASCB RSTD;                                           1463 05017000
*         R7ASCB=PSAAOLD;           /* ADDRESS OF CURRENT ASCB       */ 05018000
         L     R7ASCB,PSAAOLD                                      1464 05019000
*         R0WORK=WK255LNG;          /* LENGTH STORAGE                */ 05020000
         LH    R0WORK,WK255LNG(,R12SVRB)                           1465 05021000
*         R1AREA=R3WORKAD;          /* STORAGE ADDRESS               */ 05022000
         LR    R1AREA,R3WORKAD                                     1466 05023000
*         GENERATE NOFLOWS;                                        1467 05024000
*                                                                  1467 05025000
         SPACE                                                          05026000
         FREEMAIN RC,LV=(0),A=(1),SP=SP255EQU,BRANCH=YES                05027000
         SPACE                                                          05028000
*/* L FREEMAIN: FREE TCB/IQE STORAGE, IF ANY                         */ 05029000
*                                                                  1468 05030000
*         IF R5NEWTCB^=ZERO THEN                                   1468 05031000
         SLR   @08,@08                                             1468 05032000
         CR    R5NEWTCB,@08                                        1468 05033000
         BE    @RF01468                                            1468 05034000
*           DO;                     /* DO000034                      */ 05035000
*             R0WORK=LENGTH(TCBFIX)+LENGTH(TCB)+LENGTH(TCBXTNT2);  1470 05036000
         LA    R0WORK,360                                          1470 05037000
*             IF R5NEWTCB->TCBIQE^=ZERO THEN/* ETXR IQE ?            */ 05038000
         L     @15,TCBIQE(,R5NEWTCB)                               1471 05039000
         CR    @15,@08                                             1471 05040000
         BE    @RF01471                                            1471 05041000
*               DO;                 /* DO000035                      */ 05042000
*                 R1AREA=R5NEWTCB->TCBIQE;/* IQE/TCB STORAGE         */ 05043000
         LR    R1AREA,@15                                          1473 05044000
*                 R0WORK=R0WORK+LENGTH(IQESECT);/* TOTAL LENGTH      */ 05045000
         AH    R0WORK,@CH00066                                     1474 05046000
*               END;                /* END00035                      */ 05047000
*             ELSE                  /* NO IQE                        */ 05048000
*               R1AREA=R5NEWTCB-LENGTH(TCBFIX);/* TCB ONLY           */ 05049000
         B     @RC01471                                            1476 05050000
@RF01471 LR    R1AREA,R5NEWTCB                                     1476 05051000
         SH    R1AREA,@CH00049                                     1476 05052000
*             GENERATE NOFLOWS;                                    1477 05053000
@RC01471 DS    0H                                                  1477 05054000
         SPACE                                                          05055000
         FREEMAIN RC,LV=(0),A=(1),SP=SP253EQU,BRANCH=YES                05056000
         SPACE                                                          05057000
*           END;                    /* END00034                      */ 05058000
*         RFY                                                      1479 05059000
*           R0WORK UNRSTD;                                         1479 05060000
@RF01468 DS    0H                                                  1480 05061000
*         RFY                                                      1480 05062000
*           R1AREA UNRSTD;                                         1480 05063000
*         RFY                                                      1481 05064000
*           R7ASCB UNRSTD;                                         1481 05065000
*       END;                        /* END00074                      */ 05066000
*/* AT001650: P CONDITIONALLY RELEASE LOCAL LOCK                     */ 05067000
*                                                                  1483 05068000
*AT001650:                                                         1483 05069000
*   GENERATE REFS(PSAHLHI) FLOWS(AT001770);                        1483 05070000
@RF01429 DS    0H                                                  1483 05071000
@RF01428 DS    0H                                                  1483 05072000
AT001650 DS    0H                                                  1483 05073000
         SPACE                                                          05074000
         SETLOCK TEST,TYPE=LOCAL,BRANCH=(NOTHELD,AT001770) CHECK LOCK   05075000
         SPACE                                                          05076000
*   CALL UNLOCK;                    /* RELEASE LOCAL LOCK (ALTERS  1484 05077000
*                                      REGS 0,1,11,13,15)            */ 05078000
         BAL   @14,UNLOCK                                          1484 05079000
*/* AT001770: R RETURN TO CALLING POINT                              */ 05080000
*                                                                  1485 05081000
*   RFY                                                            1485 05082000
*     R14RET RSTD;                                                 1485 05083000
*AT001770:                                                         1486 05084000
*   R14RET=R2WORK;                  /* RESTORE RETURN ADDRESS        */ 05085000
AT001770 LR    R14RET,R2WORK                                       1486 05086000
*/* RTN1: END FLOWCHART                                              */ 05087000
*                                                                  1487 05088000
*   END RTN1;                       /* END OF SUBROUTINE             */ 05089000
@EL00018 DS    0H                                                  1487 05090000
@EF00018 DS    0H                                                  1487 05091000
@ER00018 BR    @14                                                 1487 05092000
*   RFY                                                            1488 05093000
*     R14RET UNRSTD;                                               1488 05094000
*   RFY                                                            1489 05095000
*     R2WORK UNRSTD;                                               1489 05096000
*                                                                  1490 05097000
*   /*****************************************************************/ 05098000
*   /*                                                               */ 05099000
*   /* RTN2 CLEAN UP ROUTINE                                         */ 05100000
*   /*                                                               */ 05101000
*   /*****************************************************************/ 05102000
*                                                                  1490 05103000
*RTN2:                                                             1490 05104000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/* ENTRY POINT              */ 05105000
RTN2     DS    0H                                                  1491 05106000
*/* RTN2: CHART  BEGIN FLOWCHART                                     */ 05107000
*/* FOOTING                                                        1491 05108000
*/* RECONSTRUCT CURRENT TASK'S TCBMSS QUEUE                          */ 05109000
*/********************************************************************/ 05110000
*/*                                                                  */ 05111000
*/*    SUBROUTINE RTN2 RECONSTRUCTS THE CURRENT TASK'S (ATTACHOR'S)  */ 05112000
*/*    TCBMSS QUEUE                                                  */ 05113000
*/*                                                                  */ 05114000
*/*    SUBROUTINES CALLED: NONE                                      */ 05115000
*/*                                                                  */ 05116000
*/*    SYSTEM MACROS ISSUED: NONE                                    */ 05117000
*/*                                                                  */ 05118000
*/*    RETURN CODES SET: NONE                                        */ 05119000
*/*                                                                  */ 05120000
*/*    LEVEL - 2                                                     */ 05121000
*/*                                                                  */ 05122000
*/********************************************************************/ 05123000
*/* E ENTER RTN2                                                     */ 05124000
*                                                                  1491 05125000
*   RFY                                                            1491 05126000
*     R2WORK RSTD;                  /* SAVE FOR CALLING ROUTINE      */ 05127000
*   RFY                                                            1492 05128000
*     R14RET RSTD;                                                 1492 05129000
*   RFY                                                            1493 05130000
*     R7WORK RSTD;                                                 1493 05131000
*   RFY                                                            1494 05132000
*     R11WORK RSTD;                 /*                       @Z30ENVB*/ 05133000
*/* P GET QUEUE CHAINING FIELD ADDRESS (ADDRESS OF TCBMSS)           */ 05134000
*                                                                  1495 05135000
*   R11WORK=ADDR(R5NEWTCB->TCBMSSB);/* MAINTAIN PRECEEDING CHAINING     05136000
*                                      FIELD ADDRESS         @ZA10775*/ 05137000
         LA    R11WORK,TCBMSSB(,R5NEWTCB)                          1495 05138000
*/* P GET NEW TCB TCBMSS QUEUE PTR  (FIRST SPQE PTR)                 */ 05139000
*                                                                  1496 05140000
*   R7WORK=R5NEWTCB->TCBMSSB;       /* PTR TO FIRST SPQE             */ 05141000
         SLR   R7WORK,R7WORK                                       1496 05142000
         ICM   R7WORK,7,TCBMSSB(R5NEWTCB)                          1496 05143000
*   DO WHILE(R7WORK^=ZERO);         /* DO000076: PROCESS ALL SPQE'S  */ 05144000
         B     @DE01497                                            1497 05145000
@DL01497 DS    0H                                                  1498 05146000
*/* %FL01970: D (YES,%FL01960,NO,) IS SPQE PTR ZERO ?                */ 05147000
*/* D (NO,AT001680,YES,) IS SPQE NOT OWNED ?                         */ 05148000
*                                                                  1498 05149000
*     IF R7WORK->SPSHARE='1'B THEN                                 1498 05150000
         TM    SPSHARE(R7WORK),B'10000000'                         1498 05151000
         BNO   @RF01498                                            1498 05152000
*       DO;                         /* DO000078                      */ 05153000
*/* CHECK IF SPQE WAS SHARED BY ATTACHOR, GIVEN TO NEW TASK          */ 05154000
*/* P GET CURRENT TCB'S TCBMSS QUEUE PTR                             */ 05155000
*                                                                  1500 05156000
*         RFY                                                      1500 05157000
*           R15WORK RSTD;                                          1500 05158000
*         R15WORK=R4CURTCB->TCBMSSB;/* PTR TO FIRST SPQE             */ 05159000
         SLR   R15WORK,R15WORK                                     1501 05160000
         ICM   R15WORK,7,TCBMSSB(R4CURTCB)                         1501 05161000
*         DO WHILE(R15WORK^=ZERO);  /* DO000079: CHECK ALL SPQES     */ 05162000
         B     @DE01502                                            1502 05163000
@DL01502 DS    0H                                                  1503 05164000
*/* %FL02000: D (YES,AT001685,NO,) IS SPQE PTR = 0 ?                 */ 05165000
*/* D (YES,AT001660,NO,) DOES ATTACHOR'S SPQE ID MATCH NEW TCB'S ?   */ 05166000
*                                                                  1503 05167000
*           IF R15WORK->SPQEID=R7WORK->SPQEID THEN                 1503 05168000
         CLC   SPQEID(1,R15WORK),SPQEID(R7WORK)                    1503 05169000
         BE    @RT01503                                            1503 05170000
*             GOTO AT001660;        /* NO RECHAINING NECESSARY       */ 05171000
*/* P (,%FL02000) GET PTR TO NEXT SPQE ON CURRENT TASK'S QUEUE       */ 05172000
*                                                                  1505 05173000
*           R15WORK=R15WORK->SPQEPTR;/* NEXT SPQE                    */ 05174000
         L     R15WORK,SPQEPTR(,R15WORK)                           1505 05175000
*         END;                      /* END00079                      */ 05176000
@DE01502 LTR   R15WORK,R15WORK                                     1506 05177000
         BNZ   @DL01502                                            1506 05178000
*/* AT001685: P GET CURRENT TCB'S DUMMY TCBMSS QUEUE PTR             */ 05179000
*                                                                  1507 05180000
*AT001685:                                                         1507 05181000
*         R15WORK=WKTCBMSS;         /* PTR TO FIRST SPQE     @Z30ENVB*/ 05182000
AT001685 L     R15WORK,WKTCBMSS(,R12SVRB)                          1507 05183000
*         DO WHILE(R15WORK^=ZERO);  /* DO000077: CHECK ALL SPQES   1508 05184000
*                                                            @Z30ENVB*/ 05185000
         B     @DE01508                                            1508 05186000
@DL01508 DS    0H                                                  1509 05187000
*/* %FL02050: D (YES,AT001680,NO,) IS SPQE PTR = 0 ?                 */ 05188000
*/* D (YES,AT001660,NO,) DOES SPQE ID MATCH NEW TCB'S ?              */ 05189000
*                                                                  1509 05190000
*           IF R15WORK->SPQEID=R7WORK->SPQEID THEN/*         @Z30ENVB*/ 05191000
         CLC   SPQEID(1,R15WORK),SPQEID(R7WORK)                    1509 05192000
         BE    @RT01509                                            1509 05193000
*             GOTO AT001660;        /* NO RECHAINING NECESSARY     1510 05194000
*                                                            @Z30ENVB*/ 05195000
*/* P (,%FL02050) GET PTR TO NEXT SPQE ON DUMMY TCBMSS QUEUE         */ 05196000
*                                                                  1511 05197000
*           R15WORK=R15WORK->SPQEPTR;/* NEXT SPQE            @Z30ENVB*/ 05198000
         L     R15WORK,SPQEPTR(,R15WORK)                           1511 05199000
*         END;                      /* END00077              @Z30ENVB*/ 05200000
@DE01508 LTR   R15WORK,R15WORK                                     1512 05201000
         BNZ   @DL01508                                            1512 05202000
*         RFY                                                      1513 05203000
*           R15WORK UNRSTD;         /*                       @Z30ENVB*/ 05204000
*                                                                  1513 05205000
*         /***********************************************************/ 05206000
*         /*                                                         */ 05207000
*         /* FALL THROUGH LOOP MEANS SPQE ON NEW TASK'S QUEUE WAS    */ 05208000
*         /* RESULT OF GIVE SHARED-NOT-OWNED SUBPOOL REQUEST. THIS   */ 05209000
*         /* SPQE MUST BE RECHAINED OFF CURRENT.                     */ 05210000
*         /*                                                         */ 05211000
*         /***********************************************************/ 05212000
*                                                                  1514 05213000
*       END;                        /* END00078                      */ 05214000
*                                                                  1515 05215000
*     /***************************************************************/ 05216000
*     /*                                                             */ 05217000
*     /* THE NEW TCB'S SPQE WHICH IS BEING PROCESSED WAS GIVEN TO THE*/ 05218000
*     /* NEW TASK. IT MUST BE RECHAINED OFF THE CURRENT TCB'S TCBMSS */ 05219000
*     /* QUEUE. EITHER THE SPQE WAS A RESULT OF GIVING A             */ 05220000
*     /* SHARED-NOT-OWNED SUBPOOL, OR GIVING AN OWNED-NOT-SHARED     */ 05221000
*     /* SUBPOOL.                                                    */ 05222000
*     /*                                                             */ 05223000
*     /***************************************************************/ 05224000
*                                                                  1515 05225000
*/* AT001680: P (,%FL01970) RECHAIN SPQE FROM NEW TCB TO CURRENT TCB,   05226000
*/* GET NEXT OFF NEW TCB                                             */ 05227000
*                                                                  1515 05228000
*     /***************************************************************/ 05229000
*     /*                                                             */ 05230000
*     /* REMOVE SPQE FROM NEW TCB'S TCBMSS QUEUE.                    */ 05231000
*     /*                                                             */ 05232000
*     /***************************************************************/ 05233000
*                                                                  1515 05234000
*AT001680:                          /*                       @Z30ENVB*/ 05235000
*     R11WORK->BYTES123=R7WORK->SPQEPTR;/* UNCHAIN           @Z30ENVB*/ 05236000
@RF01498 DS    0H                                                  1515 05237000
AT001680 MVC   BYTES123(3,R11WORK),SPQEPTR+1(R7WORK)               1515 05238000
*     IF R7WORK->LASTSPQE='1'B THEN /* LAST SPQE ?           @Z30ENVB*/ 05239000
         TM    LASTSPQE(R7WORK),B'01000000'                        1516 05240000
         BNO   @RF01516                                            1516 05241000
*       IF R11WORK^=ADDR(R5NEWTCB->TCBMSS) THEN/* YES, MOTHER QUEUE     05242000
*                                      EMPTY ?               @Z30ENVB*/ 05243000
         LA    @15,TCBMSS(,R5NEWTCB)                               1517 05244000
         CR    R11WORK,@15                                         1517 05245000
         BE    @RF01517                                            1517 05246000
*         R11WORK->LASTSPQE='1'B;   /* INSURE END OF QUEUE PROPERLY     05247000
*                                      FLAGGED               @Z30ENVB*/ 05248000
*                                                                  1518 05249000
         OI    LASTSPQE(R11WORK),B'01000000'                       1518 05250000
*     /***************************************************************/ 05251000
*     /*                                                             */ 05252000
*     /* RECHAIN OFF CURRENT TCB. IF NEW TCB'S QUEUE IS EMPTY, SET   */ 05253000
*     /* END-OF-QUEUE INDICATOR. OTHERWISE, SET INDICATOR OFF, AND   */ 05254000
*     /* CHAIN TO NEXT SPQE.                                         */ 05255000
*     /*                                                             */ 05256000
*     /***************************************************************/ 05257000
*                                                                  1519 05258000
*     RFY                                                          1519 05259000
*       R8WORK RSTD;                                               1519 05260000
@RF01517 DS    0H                                                  1519 05261000
@RF01516 DS    0H                                                  1520 05262000
*     R8WORK=R7WORK;                /* SAVE ADDRESS OF THIS SPQE     */ 05263000
         LR    R8WORK,R7WORK                                       1520 05264000
*     R7WORK=R8WORK->SPQEPTR;       /* GET ADDR NEXT SPQE OFF NEW TCB*/ 05265000
         L     R7WORK,SPQEPTR(,R8WORK)                             1521 05266000
*     IF R4CURTCB->TCBMSSB=ZERO THEN/* IS QUEUE EMPTY ?              */ 05267000
         ICM   @15,7,TCBMSSB(R4CURTCB)                             1522 05268000
         BNZ   @RF01522                                            1522 05269000
*       DO;                         /* DO000080                      */ 05270000
*         R8WORK->LASTSPQE='1'B;    /* END-OF-QUEUE                  */ 05271000
         OI    LASTSPQE(R8WORK),B'01000000'                        1524 05272000
*         R8WORK->SPQEPTR=ZERO;     /* NO NEXT SPQE ON CURRENT       */ 05273000
         SLR   @15,@15                                             1525 05274000
         ST    @15,SPQEPTR(,R8WORK)                                1525 05275000
*       END;                        /* END00080                      */ 05276000
*     ELSE                          /* QUEUE IS NOT EMPTY            */ 05277000
*       DO;                         /* DO000081                      */ 05278000
         B     @RC01522                                            1527 05279000
@RF01522 DS    0H                                                  1528 05280000
*         R8WORK->LASTSPQE='0'B;    /* NOT END                       */ 05281000
         NI    LASTSPQE(R8WORK),B'10111111'                        1528 05282000
*         R8WORK->SPQEPTR=R4CURTCB->TCBMSSB;/* NEXT SPQE             */ 05283000
         SLR   @15,@15                                             1529 05284000
         ICM   @15,7,TCBMSSB(R4CURTCB)                             1529 05285000
         ST    @15,SPQEPTR(,R8WORK)                                1529 05286000
*       END;                        /* END00081                      */ 05287000
*     R4CURTCB->TCBMSSB=R8WORK;     /* RECHAIN SPQE OFF CURRENT TCB  */ 05288000
@RC01522 STCM  R8WORK,7,TCBMSSB(R4CURTCB)                          1531 05289000
*     GOTO AT001670;                /* PTR TO NEXT AND PRECEEDING  1532 05290000
*                                      SPQE OFF NEW TCB ALREADY SET,    05291000
*                                      BYPASS RESET          @Z30ENVB*/ 05292000
         B     AT001670                                            1532 05293000
*     RFY                                                          1533 05294000
*       R8WORK UNRSTD;                                             1533 05295000
*                                                                  1533 05296000
*/* AT001660: P UPDATE QUEUE CHAINING FIELD ADDRESS                  */ 05297000
*                                                                  1534 05298000
*AT001660:                                                         1534 05299000
*     R11WORK=ADDR(R7WORK->SPQEPTR);/* PRECEEDING CHAINING FIELD   1534 05300000
*                                                            @Z30ENVB*/ 05301000
AT001660 LR    R11WORK,R7WORK                                      1534 05302000
*/* P (,%FL01970) GET PTR TO NEXT SPQE OFF NEW TASK                  */ 05303000
*                                                                  1535 05304000
*     R7WORK=R7WORK->SPQEPTR;       /* NEXT SPQE                     */ 05305000
         L     R7WORK,SPQEPTR(,R7WORK)                             1535 05306000
*AT001670:                          /* REPEAT LOOP                   */ 05307000
*   END;                            /* END00076                      */ 05308000
AT001670 DS    0H                                                  1536 05309000
@DE01497 LTR   R7WORK,R7WORK                                       1536 05310000
         BNZ   @DL01497                                            1536 05311000
*   RFY                                                            1537 05312000
*     R7WORK UNRSTD;                                               1537 05313000
*                                                                  1537 05314000
*/* %FL01960: R RETURN TO CALLING POINT                              */ 05315000
*                                                                  1538 05316000
*   END RTN2;                       /* END OF SUBROUTINE             */ 05317000
@EL00019 DS    0H                                                  1538 05318000
@EF00019 DS    0H                                                  1538 05319000
@ER00019 BR    @14                                                 1538 05320000
*/* RTN2: END FLOWCHART                                              */ 05321000
*                                                                  1539 05322000
*   RFY                                                            1539 05323000
*     R2WORK UNRSTD;                                               1539 05324000
*   RFY                                                            1540 05325000
*     R11WORK UNRSTD;               /*                       @Z30ENVB*/ 05326000
*   RFY                                                            1541 05327000
*     R14RET UNRSTD;                                               1541 05328000
*                                                                  1542 05329000
*   /*****************************************************************/ 05330000
*   /*                                                               */ 05331000
*   /* RTN3 CLEAN UP ROUTINE                                         */ 05332000
*   /*                                                               */ 05333000
*   /*****************************************************************/ 05334000
*                                                                  1542 05335000
*RTN3:                                                             1542 05336000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/* ENTRY POINT              */ 05337000
RTN3     DS    0H                                                  1543 05338000
*/* RTN3: CHART  BEGIN FLOWCHART                                     */ 05339000
*/* FOOTING                                                        1543 05340000
*/* SCB / ETXR CLEAN UP                                              */ 05341000
*/********************************************************************/ 05342000
*/*                                                                  */ 05343000
*/*    SUBROUTINE RTN3 CLEANS UP STAI/ESTAI SCB'S BY INVOKING A      */ 05344000
*/*    RESOURCE MANAGER, AND PROCESSES ETXR IRB                      */ 05345000
*/*                                                                  */ 05346000
*/*    SUBROUTINES CALLED: NONE                                      */ 05347000
*/*                                                                  */ 05348000
*/*    SYSTEM MACROS ISSUED / ROUTINES CALLED: FREEMAIN BRANCH ENTRY */ 05349000
*/*                                           TASK RECOVERY RESOURCE */ 05350000
*/*                                           MANAGER                */ 05351000
*/*                                                                  */ 05352000
*/*    REGISTER USAGE: MUST PRESERVE REGISTER 2                      */ 05353000
*/*                                                                  */ 05354000
*/*    LEVEL - 2                                                     */ 05355000
*/*                                                                  */ 05356000
*/********************************************************************/ 05357000
*/* E ENTER RTN3                                                     */ 05358000
*                                                                  1543 05359000
*   RFY                                                            1543 05360000
*     R2WORK RSTD;                                                 1543 05361000
*   RFY                                                            1544 05362000
*     R7ASCB RSTD;                                                 1544 05363000
*   RFY                                                            1545 05364000
*     R11WORK RSTD;                                                1545 05365000
*   RFY                                                            1546 05366000
*     R14RET RSTD;                                                 1546 05367000
*                                                                  1546 05368000
*   /*****************************************************************/ 05369000
*   /*                                                               */ 05370000
*   /* SET REGISTERS FOR BRANCH ENTRY ROUTINES                       */ 05371000
*   /*                                                               */ 05372000
*   /*****************************************************************/ 05373000
*                                                                  1547 05374000
*   R7ASCB=PSAAOLD;                 /* ASCB ADDRESS                  */ 05375000
         L     R7ASCB,PSAAOLD                                      1547 05376000
*   R11WORK=R14RET;                 /* SAVE                          */ 05377000
         LR    R11WORK,R14RET                                      1548 05378000
*   RFY                                                            1549 05379000
*     R14RET UNRSTD;                                               1549 05380000
*                                                                  1549 05381000
*/* D (YES,%FL02000,NO,) IS NEW TCB'S TCBSTABB = 0 ?                 */ 05382000
*                                                                  1550 05383000
*   IF R5NEWTCB->TCBSTABB^=ZERO THEN                               1550 05384000
         ICM   @10,7,TCBSTABB(R5NEWTCB)                            1550 05385000
         BZ    @RF01550                                            1550 05386000
*     DO;                           /* DO000085                      */ 05387000
*       RFY                                                        1552 05388000
*         R10WORK RSTD;                                            1552 05389000
*       R10WORK=R4CURTCB;           /* SAVE                          */ 05390000
         LR    R10WORK,R4CURTCB                                    1553 05391000
*/* P SET ENTRY REGS FOR TRRM                                        */ 05392000
*                                                                  1554 05393000
*       RFY                                                        1554 05394000
*         R0WORK RSTD;                                             1554 05395000
*       RFY                                                        1555 05396000
*         R13WORK RSTD;                                            1555 05397000
*       R0WORK=ZERO;                /* ENTRY FROM ATTACH             */ 05398000
         SLR   R0WORK,R0WORK                                       1556 05399000
*       R4WORK=R5NEWTCB;            /* CALL IS FOR NEW TCB           */ 05400000
         LR    R4WORK,R5NEWTCB                                     1557 05401000
*       R13WORK=R3WORKAD;           /* 72 BYTE SAVE AREA REQUIRED    */ 05402000
         LR    R13WORK,R3WORKAD                                    1558 05403000
*/* L TASK RECOVERY RESOURCE MANAGER: CLEAN-UP (E)STAI SCB'S         */ 05404000
*                                                                  1559 05405000
*       RFY                                                        1559 05406000
*         R15WORK RSTD;                                            1559 05407000
*       R15WORK=CVTPTR;             /* ADDR OF CVTPTR                */ 05408000
         L     R15WORK,CVTPTR                                      1560 05409000
*       R15WORK=R15WORK->CVTSCBP;   /* ADDR OF TRRM (IEAVTSBP)       */ 05410000
         L     R15WORK,CVTSCBP(,R15WORK)                           1561 05411000
*       CALL R15WORK;               /* INVOKE TRRM                   */ 05412000
         BALR  @14,@15                                             1562 05413000
*       R4CURTCB=R10WORK;           /* RESTORE                       */ 05414000
         LR    R4CURTCB,R10WORK                                    1563 05415000
*       RFY                                                        1564 05416000
*         R0WORK UNRSTD;                                           1564 05417000
*       RFY                                                        1565 05418000
*         R13WORK UNRSTD;                                          1565 05419000
*       RFY                                                        1566 05420000
*         R15WORK UNRSTD;                                          1566 05421000
*     END;                          /* END00085                      */ 05422000
*/* %FL02000: D (NO,%FL02010,YES,) IS NEW TCB'S TCBIQE ^= 0 ?        */ 05423000
*                                                                  1568 05424000
*   IF R5NEWTCB->TCBIQE^=ZERO THEN                                 1568 05425000
@RF01550 L     @08,TCBIQE(,R5NEWTCB)                               1568 05426000
         LTR   @08,@08                                             1568 05427000
         BZ    @RF01568                                            1568 05428000
*     DO;                           /* DO000086                      */ 05429000
*       RFY                                                        1570 05430000
*         R8WORK RSTD;                                             1570 05431000
*       R8WORK=R5NEWTCB->TCBIQE->IQEIRB;/* IRB ADDRESS               */ 05432000
         L     @15,TCBIQE(,R5NEWTCB)                               1571 05433000
         L     R8WORK,IQEIRB(,@15)                                 1571 05434000
*/* D (YES,%FL02020,NO,) IS THE RELATED IRB'S USE COUNT = 1 ?        */ 05435000
*                                                                  1572 05436000
*       IF R8WORK->RBUSE^=ONE THEN                                 1572 05437000
*                                                                  1572 05438000
         CLI   RBUSE(R8WORK),1                                     1572 05439000
         BE    @RF01572                                            1572 05440000
*/* P (,%FL02010) DECREMENT IRB USE COUNT BY ONE                     */ 05441000
*                                                                  1573 05442000
*         R8WORK->RBUSE=R8WORK->RBUSE-ONE;/* USE COUNT -1            */ 05443000
         SLR   @15,@15                                             1573 05444000
         IC    @15,RBUSE(,R8WORK)                                  1573 05445000
         BCTR  @15,0                                               1573 05446000
         STC   @15,RBUSE(,R8WORK)                                  1573 05447000
*       ELSE                                                       1574 05448000
*         DO;                       /* DO000087                      */ 05449000
         B     @RC01572                                            1574 05450000
@RF01572 DS    0H                                                  1575 05451000
*/* %FL02020: L FREEMAIN: FREE IRB'S PROBLEM PROGRAM SAVE AREA       */ 05452000
*                                                                  1575 05453000
*           RFY                                                    1575 05454000
*             R0WORK RSTD;                                         1575 05455000
*           RFY                                                    1576 05456000
*             R1AREA RSTD;                                         1576 05457000
*           R10WORK=R3WORKAD;       /* SAVE                          */ 05458000
         LR    R10WORK,R3WORKAD                                    1577 05459000
*           R0WORK=SVAREA72;        /* SAVE AREA LENGTH              */ 05460000
         LA    R0WORK,72                                           1578 05461000
*           R1AREA=R8WORK->RBPPSAV1;/* SAVE AREA ADDRESS             */ 05462000
         SLR   R1AREA,R1AREA                                       1579 05463000
         ICM   R1AREA,7,RBPPSAV1(R8WORK)                           1579 05464000
*           GENERATE SETS(R0WORK,R1WORK,R3WORKAD,R14RET,R15RETCD) REFS( 05465000
*               R4WORK,R7ASCB);                                    1580 05466000
*                                                                  1580 05467000
         SPACE                                                          05468000
         FREEMAIN RC,LV=(0),A=(1),SP=SP250EQU,BRANCH=YES  FREE SAVEAREA 05469000
         SPACE                                                          05470000
*/* L FREEMAIN: FREE IRB                                             */ 05471000
*                                                                  1581 05472000
*           R0WORK=ADDR(IRBLEN);    /* IRB LENGTH                    */ 05473000
         LA    R0WORK,IRBLEN                                       1581 05474000
*           R1AREA=R8WORK;          /* IRB ADDRESS                   */ 05475000
         LR    R1AREA,R8WORK                                       1582 05476000
*           R7ASCB=PSAAOLD;         /* ASCB ADDRESS          @Z30ENVB*/ 05477000
         L     R7ASCB,PSAAOLD                                      1583 05478000
*           GENERATE SETS(R3WORKAD,R14RET,R15RETCD) REFS(R0WORK,R1WORK, 05479000
*               R4WORK,R7ASCB) NOFLOWS;                            1584 05480000
         SPACE                                                          05481000
         FREEMAIN RC,LV=(0),A=(1),SP=SP253EQU,BRANCH=YES  FREE IRB      05482000
         SPACE                                                          05483000
*           R3WORKAD=R10WORK;       /* RESTORE                       */ 05484000
         LR    R3WORKAD,R10WORK                                    1585 05485000
*         END;                      /* END00087                      */ 05486000
*     END;                          /* END00086                      */ 05487000
@RC01572 DS    0H                                                  1588 05488000
*/* %FL02010: R RETURN TO CALLING POINT                              */ 05489000
*                                                                  1588 05490000
*   RFY                                                            1588 05491000
*     R14RET RSTD;                                                 1588 05492000
@RF01568 DS    0H                                                  1589 05493000
*   R14RET=R11WORK;                 /* RESTORE                       */ 05494000
         LR    R14RET,R11WORK                                      1589 05495000
*/* RTN3: END FLOWCHART                                              */ 05496000
*                                                                  1590 05497000
*   END RTN3;                       /* END OF SUBROUTINE             */ 05498000
@EL00020 DS    0H                                                  1590 05499000
@EF00020 DS    0H                                                  1590 05500000
@ER00020 BR    @14                                                 1590 05501000
*   RFY                                                            1591 05502000
*     R0WORK UNRSTD;                                               1591 05503000
*   RFY                                                            1592 05504000
*     R1AREA UNRSTD;                                               1592 05505000
*   RFY                                                            1593 05506000
*     R14RET UNRSTD;                                               1593 05507000
*   RFY                                                            1594 05508000
*     R2WORK UNRSTD;                                               1594 05509000
*   RFY                                                            1595 05510000
*     R7ASCB UNRSTD;                                               1595 05511000
*   RFY                                                            1596 05512000
*     R8WORK UNRSTD;                                               1596 05513000
*   RFY                                                            1597 05514000
*     R10WORK UNRSTD;                                              1597 05515000
*   RFY                                                            1598 05516000
*     R11WORK UNRSTD;                                              1598 05517000
*                                                                  1599 05518000
*   /*****************************************************************/ 05519000
*   /*                                                               */ 05520000
*   /* FREESPQE SUBROUTINE                                           */ 05521000
*   /*                                                               */ 05522000
*   /*****************************************************************/ 05523000
*                                                                  1599 05524000
*FREESPQE:                                                         1599 05525000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/* ENTRY POINT      @Z30ENVB*/ 05526000
FREESPQE DS    0H                                                  1600 05527000
*/* FREESPQE: CHART BEGIN FLOWCHART                                  */ 05528000
*/* FOOTING                                                        1600 05529000
*/* SPQE CLEAN UP                                                    */ 05530000
*/********************************************************************/ 05531000
*/*                                                                  */ 05532000
*/*    SUBROUTINE FREESPQE FREES SPQE STORAGE BUILT FOR THE          */ 05533000
*/*    NEW AND/OR CURRENT TCB                                        */ 05534000
*/*                                                                  */ 05535000
*/*    SUBROUTINES CALLED: NONE                                      */ 05536000
*/*                                                                  */ 05537000
*/*    CALLED BY: RTN1                                               */ 05538000
*/*                                                                  */ 05539000
*/*    SYSTEM MACROS ISSUED: FREEMAIN                                */ 05540000
*/*                                                                  */ 05541000
*/*    RETURN CODES SET: NONE                                        */ 05542000
*/*                                                                  */ 05543000
*/*    REGISTER USAGE: R2WORK - RETURN POINT FOR CALLING ROUTINE     */ 05544000
*/*                    R7ASCB - ASCB ADDR                            */ 05545000
*/*                    R8WORK - SPQE PTR                             */ 05546000
*/*                    R10WORK - SPQE TO BE FREED                    */ 05547000
*/*                    R11WORK - RETURN POINT TO CALLING ROUTINE     */ 05548000
*/*                                                                  */ 05549000
*/*    LEVEL - 2                                                     */ 05550000
*/*                                                                  */ 05551000
*/*    NOTES: FREEMAIN MACRO DESTROYS REGISTERS 0,1,14,15            */ 05552000
*/*                                                                  */ 05553000
*/********************************************************************/ 05554000
*/* E ENTER FREESPQE                                                 */ 05555000
*                                                                  1600 05556000
*   RFY                                                            1600 05557000
*     R2WORK RSTD;                  /* SAVE FOR CALLING ROUTINE    1600 05558000
*                                                            @Z30ENVB*/ 05559000
*   RFY                                                            1601 05560000
*     R7ASCB RSTD;                  /*                       @Z30ENVB*/ 05561000
*   RFY                                                            1602 05562000
*     R8WORK RSTD;                  /*                       @Z30ENVB*/ 05563000
*   RFY                                                            1603 05564000
*     R10WORK RSTD;                 /*                       @Z30ENVB*/ 05565000
*   RFY                                                            1604 05566000
*     R11WORK RSTD;                 /*                       @Z30ENVB*/ 05567000
*   RFY                                                            1605 05568000
*     R14RET RSTD;                  /*                       @Z30ENVB*/ 05569000
*   R11WORK=R14RET;                 /* SAVE RETURN ADDR      @Z30ENVB*/ 05570000
         LR    R11WORK,R14RET                                      1606 05571000
*   DO UNTIL(R8WORK=ZERO);          /* DO000130: PROCESS ALL SPQES 1607 05572000
*                                                            @Z30ENVB*/ 05573000
@DL01607 DS    0H                                                  1608 05574000
*/* %FL02040: P UNCHAIN SPQE TO BE FREED                             */ 05575000
*                                                                  1608 05576000
*     R10WORK=R8WORK;               /* SPQE TO BE FREED      @Z30ENVB*/ 05577000
         LR    R10WORK,R8WORK                                      1608 05578000
*     R8WORK=R8WORK->SPQEPTR;       /* GET NEXT SPQE PTR     @Z30ENVB*/ 05579000
         L     R8WORK,SPQEPTR(,R8WORK)                             1609 05580000
*/* S FREEMAIN: FREE SPQE STORAGE                                    */ 05581000
*                                                                  1610 05582000
*     R7ASCB=PSAAOLD;               /* ADDR OF CURRENT ASCB  @Z30ENVB*/ 05583000
         L     R7ASCB,PSAAOLD                                      1610 05584000
*     GENERATE REFS(R7ASCB,R10WORK,CVTCBBR);                       1611 05585000
*                                                                  1611 05586000
      SPACE                                                             05587000
      FREEMAIN P,A=(R10WORK),BRANCH=YES                      @Z30ENVB   05588000
      SPACE                                                             05589000
*/* D (NO,%FL02040,YES,) SPQE PTR ZERO ?                             */ 05590000
*                                                                  1612 05591000
*   END;                            /* END00130              @Z30ENVB*/ 05592000
@DE01607 LTR   R8WORK,R8WORK                                       1612 05593000
         BNZ   @DL01607                                            1612 05594000
*/* R RETURN TO CALLING POINT                                        */ 05595000
*                                                                  1613 05596000
*   R14RET=R11WORK;                 /* RESORE RETURN ADDR    @Z30ENVB*/ 05597000
         LR    R14RET,R11WORK                                      1613 05598000
*/* FREESPQE: END FLOWCHART                                          */ 05599000
*                                                                  1614 05600000
*   END FREESPQE;                   /* END OF SUBROUTINE     @Z30ENVB*/ 05601000
@EL00021 DS    0H                                                  1614 05602000
@EF00021 DS    0H                                                  1614 05603000
@ER00021 BR    @14                                                 1614 05604000
*   RFY                                                            1615 05605000
*     R2WORK UNRSTD;                /*                       @Z30ENVB*/ 05606000
*   RFY                                                            1616 05607000
*     R7ASCB UNRSTD;                /*                       @Z30ENVB*/ 05608000
*   RFY                                                            1617 05609000
*     R8WORK UNRSTD;                /*                       @Z30ENVB*/ 05610000
*   RFY                                                            1618 05611000
*     R10WORK UNRSTD;               /*                       @Z30ENVB*/ 05612000
*   RFY                                                            1619 05613000
*     R11WORK UNRSTD;               /*                       @Z30ENVB*/ 05614000
*   RFY                                                            1620 05615000
*     R14RET UNRSTD;                /*                       @Z30ENVB*/ 05616000
*                                                                  1621 05617000
*   /*****************************************************************/ 05618000
*   /*                                                               */ 05619000
*   /* FRR                                                           */ 05620000
*   /*                                                               */ 05621000
*   /*****************************************************************/ 05622000
*                                                                  1621 05623000
*IGC042R2:                                                         1621 05624000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                   @Y02753*/ 05625000
IGC042R2 DS    0H                                                  1622 05626000
*/* IGC042R2: CHART                                                  */ 05627000
*/* FOOTING                                                        1622 05628000
*/* FUNCTIONAL RECOVERY ROUTINE                                      */ 05629000
*/********************************************************************/ 05630000
*/*                                                                  */ 05631000
*/* IGC042R2 IS AN FRR FOR ATTACH, IN EFFECT WHEN THE LOCAL LOCK IS  */ 05632000
*/* HELD. THE FRR IS ENTERED UNDER NORMAL PROCESSING THROUGH USER    */ 05633000
*/* PARAMETER VALIDITY CHECKING, FOR WHICH CASE IT RESETS THE        */ 05634000
*/* COMPLETION CODE TO 72A (INVALID PARAMETER LIST) OR 42A (INVALID  */ 05635000
*/* ECB), AS APPROPRIATE, AND PERCOLATES.                            */ 05636000
*/*                                                                  */ 05637000
*/* FOR ERROR ENTRY, THE FRR RECORDS THE PERMANENT WORKAREA IN THE   */ 05638000
*/* OUTPUT DATA AREA, VALIDATES THE TCB QUEUES, AND PERCOLATES.      */ 05639000
*/*                                                                  */ 05640000
*/* IN EITHER CASE, THE ESTAE EXIT IS ENTERED TO PERFORM BACKOUT     */ 05641000
*/* PROCESSING.                                                      */ 05642000
*/*                                                                  */ 05643000
*/* SUBROUTINES CALLED: NONE                                         */ 05644000
*/*                                                                  */ 05645000
*/* SYSTEM ROUTINES CALLED / MACROS ISSUED: IGC044R2, SETRP          */ 05646000
*/*                                                                  */ 05647000
*/* RETURN CODES SET: X00NRTRY                                       */ 05648000
*/*                                                                  */ 05649000
*/* REGISTER USAGE: R0WORK - INPUT, ADDRESS OF A 200 BYTE WORKAREA   */ 05650000
*/* R1AREA - INPUT, ADDRESS OF AN SDWA (FIELD SDWAPARM ADDRESSES     */ 05651000
*/*          THE 6 WORD FRR WORKAREA (SEE STRUCTURE ATTFRRWA), WHICH */ 05652000
*/*          IN TURN ADDRESSES WKEXSAVE).                            */ 05653000
*/*                                                                  */ 05654000
*/* NOTE - THIS ROUTINE LOSES ITS ADDRESSABILITY FOLLOWING           */ 05655000
*/*        CALL TO IGC044R2; MUST BE REESTABLISHED IF NEEDED.        */ 05656000
*/*                                                                  */ 05657000
*/********************************************************************/ 05658000
*/* E ENTER IGC042R2                                                 */ 05659000
*                                                                  1622 05660000
*   RFY                                                            1622 05661000
*     R1AREA RSTD;                                                 1622 05662000
*   RFY                                                            1623 05663000
*     R14RET RSTD;                                                 1623 05664000
*   RFY                                                            1624 05665000
*     R15WORK RSTD;                                                1624 05666000
*   RFY                                                            1625 05667000
*     R10WORK RSTD;                                                1625 05668000
*   R10WORK=R15WORK;                /* ENTRY ADDRESS          @Y02753*/ 05669000
         LR    R10WORK,R15WORK                                     1626 05670000
*   GEN(USING IGC042R2,R10WORK);    /* ADDRESSABILITY         @Y02753*/ 05671000
         USING IGC042R2,R10WORK                                         05672000
*   RFY                                                            1628 05673000
*     R15WORK UNRSTD;                                              1628 05674000
*                                                                  1628 05675000
*/* D (NO,AT001740,YES,) DID ERROR OCCUR IN CURRENT ADDRESS SPACE    */ 05676000
*                                                                  1629 05677000
*   IF R1AREA->SDWAFMID^=ZERO THEN  /*                        @Y02753*/ 05678000
         SLR   @15,@15                                             1629 05679000
         SLR   @11,@11                                             1629 05680000
         ICM   @11,3,SDWAFMID(R1AREA)                              1629 05681000
         CR    @15,@11                                             1629 05682000
         BNE   @RT01629                                            1629 05683000
*     GOTO AT001740;                /* GO EXIT, PERCOLATING   @Y02753*/ 05684000
*/* D (YES,AT001740,NO,) HAS RECURSION OCCURRED ?                    */ 05685000
*                                                                  1631 05686000
*   R12SVRB=R1AREA->SDWAPARM->ATFRRW1;/* RESET PERM WORKADDR  @Y02753*/ 05687000
         L     @11,SDWAPARM(,R1AREA)                               1631 05688000
         L     R12SVRB,ATFRRW1(,@11)                               1631 05689000
*   IF WKFRRSW='1'B THEN            /* RECURSION ?            @Y02753*/ 05690000
         TM    WKFRRSW(R12SVRB),B'01000000'                        1632 05691000
         BO    @RT01632                                            1632 05692000
*     GOTO AT001740;                /* GO EXIT, PERCOLATING   @Y02753*/ 05693000
*/* P INDICATE FRR HAS BEEN ENTERED                                  */ 05694000
*                                                                  1634 05695000
*   WKFRRSW='1'B;                   /* FOR ESTAE EXIT, AND RECURSION    05696000
*                                      CONTROL                @Y02753*/ 05697000
         OI    WKFRRSW(R12SVRB),B'01000000'                        1634 05698000
*/* D (NO,AT001750,YES,) ENTRY DUE TO VALIDITY CHECK ?               */ 05699000
*                                                                  1635 05700000
*   IF(((R1AREA->SDWAMWP1)&KEYMASK)^=ZERO)&(R1AREA->SDWAPCHK='1'B) THEN 05701000
         LA    @11,240                                             1635 05702000
         SLR   @08,@08                                             1635 05703000
         IC    @08,SDWAMWP1(,R1AREA)                               1635 05704000
         NR    @11,@08                                             1635 05705000
         CR    @11,@15                                             1635 05706000
         BE    @RF01635                                            1635 05707000
         TM    SDWAPCHK(R1AREA),B'01000000'                        1635 05708000
         BNO   @RF01635                                            1635 05709000
*     DO;                           /* DO000101               @Y02753*/ 05710000
*/* P INDICATE NO RECORDING                                          */ 05711000
*                                                                  1637 05712000
*       DO;                         /* SETRP RECORD(NO)DUMP(YES)     */ 05713000
*         RESPECIFY                                                1638 05714000
*          (GPR00P,                                                1638 05715000
*           GPR01P,                                                1638 05716000
*           GPR14P,                                                1638 05717000
*           GPR15P) RSTD;                                          1638 05718000
*         GPR01P->SDWARCDE=0;       /* SAVE RC VALUE                 */ 05719000
         MVI   SDWARCDE(GPR01P),X'00'                              1639 05720000
*         GPR01P->SDWARCRD='0'B;    /* TURN OFF RECORD INDICATOR     */ 05721000
         NI    SDWARCRD(GPR01P),B'01111111'                        1640 05722000
*         GPR01P->SDWAREQ='1'B;     /* TURN ON DUMP INDICATOR        */ 05723000
         OI    SDWAREQ(GPR01P),B'10000000'                         1641 05724000
*         RESPECIFY                                                1642 05725000
*          (GPR00P,                                                1642 05726000
*           GPR01P,                                                1642 05727000
*           GPR14P,                                                1642 05728000
*           GPR15P) UNRSTD;                                        1642 05729000
*       END;                        /*                        @Y02753*/ 05730000
*/* D (NO,%FL06000,YES,) IS ECB INVALID ?                            */ 05731000
*                                                                  1644 05732000
*       IF WKECBSW='1'B THEN        /*                        @Y02753*/ 05733000
         TM    WKECBSW(R12SVRB),B'00100000'                        1644 05734000
         BNO   @RF01644                                            1644 05735000
*/* P (,AT001740) RESET COMP CODE TO 42A                             */ 05736000
*                                                                  1645 05737000
*         R1AREA->SDWACMPC=ABEND42A;/* ABEND, INVALID ECB     @Y02753*/ 05738000
         MVI   SDWACMPC+2(R1AREA),X'00'                            1645 05739000
         MVC   SDWACMPC(2,R1AREA),@CB02704                         1645 05740000
*       ELSE                        /*                        @Y02753*/ 05741000
*/* %FL06000: P (,AT001740) RESET COMP CODE TO 72A                   */ 05742000
*                                                                  1646 05743000
*         R1AREA->SDWACMPC=ABEND72A;/* ABEND, INVALID PARMS   @Y02753*/ 05744000
         B     @RC01644                                            1646 05745000
@RF01644 MVI   SDWACMPC+2(R1AREA),X'00'                            1646 05746000
         MVC   SDWACMPC(2,R1AREA),@CB02708                         1646 05747000
*     END;                          /* END00101               @Y02753*/ 05748000
*   ELSE                            /* NOT VALIDITY CHECK     @Y02753*/ 05749000
*     DO;                           /* DO000102               @Y02753*/ 05750000
         B     @RC01635                                            1648 05751000
@RF01635 DS    0H                                                  1649 05752000
*/* AT001750: P SET RECORDING PARMS                                  */ 05753000
*                                                                  1649 05754000
*AT001750:                                                         1649 05755000
*       DO;                         /* SETRP                       1649 05756000
*                                      RECPARM(ATFRRID)RECORD(YES)   */ 05757000
AT001750 DS    0H                                                  1650 05758000
*         RESPECIFY                                                1650 05759000
*          (GPR00P,                                                1650 05760000
*           GPR01P,                                                1650 05761000
*           GPR14P,                                                1650 05762000
*           GPR15P) RSTD;                                          1650 05763000
*         GPR01P->SDWARCDE=0;       /* SAVE RC VALUE                 */ 05764000
         MVI   SDWARCDE(GPR01P),X'00'                              1651 05765000
*         GPR01P->SDWARCRD='1'B;    /* TURN ON RECORD INDICATOR      */ 05766000
         OI    SDWARCRD(GPR01P),B'10000000'                        1652 05767000
*         GPR15P=ADDR(ATFRRID);     /* ACCESS RECORD PARAMETER LIST  */ 05768000
         LA    GPR15P,ATFRRID                                      1653 05769000
*         GPR01P->SDWARECP=GPR15P->I256C(1:24);/* COPY RECORD      1654 05770000
*                                      PARAMETERS                    */ 05771000
         MVC   SDWARECP(24,GPR01P),I256C(GPR15P)                   1654 05772000
*         RESPECIFY                                                1655 05773000
*          (GPR00P,                                                1655 05774000
*           GPR01P,                                                1655 05775000
*           GPR14P,                                                1655 05776000
*           GPR15P) UNRSTD;                                        1655 05777000
*       END;                        /*                        @Y02753*/ 05778000
*/* P MOVE WORKAREA CONTROL FIELDS INTO OUTPUT DATA AREA             */ 05779000
*                                                                  1657 05780000
*       RFY                                                        1657 05781000
*         R7WORK RSTD;                                             1657 05782000
*       RFY                                                        1658 05783000
*         R8WORK RSTD;                                             1658 05784000
*       R7WORK=R1AREA->SDWAVRAL;    /* LENGTH OF OUTPUT AREA  @Y02753*/ 05785000
         SLR   R7WORK,R7WORK                                       1659 05786000
         ICM   R7WORK,3,SDWAVRAL(R1AREA)                           1659 05787000
*       R8WORK=LENGTH(WKCONTRL);    /* LENGTH PERM WORKAREA   @Y02753*/ 05788000
         LA    R8WORK,24                                           1660 05789000
*       IF R7WORK<R8WORK THEN       /* WILL WORKAREA FIT      @Y02753*/ 05790000
         CR    R7WORK,R8WORK                                       1661 05791000
         BNL   @RF01661                                            1661 05792000
*         R8WORK=R7WORK;            /* LENGTH AVAILABLE       @Y02753*/ 05793000
         LR    R8WORK,R7WORK                                       1662 05794000
*       R1AREA->SDWAVRA(1:R8WORK)=WKCONTRL;/* PERM WORKAREA   @Y02753*/ 05795000
@RF01661 LR    @15,R8WORK                                          1663 05796000
         BCTR  @15,0                                               1663 05797000
         EX    @15,@SM03155                                        1663 05798000
*       R1AREA->SDWAURAL=R8WORK;    /* LENGTH RECORDED        @Y02753*/ 05799000
         STC   R8WORK,SDWAURAL(,R1AREA)                            1664 05800000
*/* L IGC044R2: VALIDATE TCB QUEUES                                  */ 05801000
*                                                                  1665 05802000
*       RFY                                                        1665 05803000
*         R2WORK RSTD;                                             1665 05804000
*       R2WORK=ADDR(ATIDLNG);       /* ADDRESS OF HEADER FOR SVC DUMP   05805000
*                                                             @Y02753*/ 05806000
         LA    R2WORK,ATIDLNG                                      1666 05807000
*       R9SAVE=R14RET;              /* SAVE RETURN ADDRESS    @Y02753*/ 05808000
         LR    R9SAVE,R14RET                                       1667 05809000
*       CALL IGC044R2;              /* INVOKE TCB VALIDATING RTN (ALL   05810000
*                                      REGISTERS EXCEPT 0,1,9,14   1668 05811000
*                                      VOLATILE, MUST REESTABLISH  1668 05812000
*                                      ADDRESSABILITY IF NEEDED)   1668 05813000
*                                                             @Y02753*/ 05814000
         L     @11,CVTPTR                                          1668 05815000
         L     @15,CVT044R2(,@11)                                  1668 05816000
         BALR  @14,@15                                             1668 05817000
*       GEN(DROP  R10WORK);         /* REG 10 CONTENTS CHANGED     1669 05818000
*                                                             @Y02753*/ 05819000
         DROP  R10WORK                                                  05820000
*       R14RET=R9SAVE;              /* RESTORE RETURN ADDRESS @Y02753*/ 05821000
         LR    R14RET,R9SAVE                                       1670 05822000
*       RFY                                                        1671 05823000
*         R2WORK UNRSTD;                                           1671 05824000
*     END;                          /* END00102               @Y02753*/ 05825000
*/* AT001740: R RETURN TO RTM (PERCOLATE ERROR)                      */ 05826000
*                                                                  1673 05827000
*AT001740:                                                         1673 05828000
*   DO;                             /* SETRP RC(0)                   */ 05829000
@RC01635 DS    0H                                                  1673 05830000
AT001740 DS    0H                                                  1674 05831000
*     RESPECIFY                                                    1674 05832000
*      (GPR00P,                                                    1674 05833000
*       GPR01P,                                                    1674 05834000
*       GPR14P,                                                    1674 05835000
*       GPR15P) RSTD;                                              1674 05836000
*     GPR01P->SDWARCDE=0;           /* SAVE RC VALUE                 */ 05837000
         MVI   SDWARCDE(GPR01P),X'00'                              1675 05838000
*     RESPECIFY                                                    1676 05839000
*      (GPR00P,                                                    1676 05840000
*       GPR01P,                                                    1676 05841000
*       GPR14P,                                                    1676 05842000
*       GPR15P) UNRSTD;                                            1676 05843000
*   END;                            /*                        @Y02753*/ 05844000
*   END IGC042R2;                   /*                        @Y02753*/ 05845000
@EL00022 DS    0H                                                  1678 05846000
@EF00022 DS    0H                                                  1678 05847000
@ER00022 BR    @14                                                 1678 05848000
*/* IGC042R2: END FLOWCHART                                          */ 05849000
*                                                                  1679 05850000
*   RFY                                                            1679 05851000
*     R1AREA UNRSTD;                                               1679 05852000
*   RFY                                                            1680 05853000
*     R14RET UNRSTD;                                               1680 05854000
*                                                                  1681 05855000
*   /*****************************************************************/ 05856000
*   /*                                                               */ 05857000
*   /* ESTAE EXIT                                                    */ 05858000
*   /*                                                               */ 05859000
*   /*****************************************************************/ 05860000
*                                                                  1681 05861000
*IGC042ES:                                                         1681 05862000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                   @Y02753*/ 05863000
IGC042ES DS    0H                                                  1682 05864000
*/* IGC042ES: CHART                                                  */ 05865000
*/* FOOTING                                                        1682 05866000
*/* ESTAE EXIT ROUTINE                                               */ 05867000
*/********************************************************************/ 05868000
*/*                                                                  */ 05869000
*/* IGC042ES IS AN ESTAE EXIT ROUTINE IN EFFECT OVER THE ENTIRE      */ 05870000
*/* MAINLINE PROCESSING, BUT NOT IN EFFECT FOR THE REENTRY           */ 05871000
*/* PROCESSING. BECAUSE OF THE ORDER IN WHICH RECOVERY ROUTINES ARE  */ 05872000
*/* SCHEDULED BY RTM (RECOVERY TERMINATION MANAGER), THE FRR         */ 05873000
*/* IGC042R2 WILL RECEIVE CONTROL FIRST IN CASE OF ERROR, WHENEVER   */ 05874000
*/* THE FRR IS IN EFFECT, I.E., WHENEVER THE LOCAL LOCK IS HELD.     */ 05875000
*/*                                                                  */ 05876000
*/* THIS ROUTINE MOVES THE PERMANENT WORKAREA (WKEXSAVE, LOCATED IN  */ 05877000
*/* THE CURRENT SVRB'S RBEXSAVE) INTO THE OUTPUT DATA AREA FOR       */ 05878000
*/* RECORDING, CALLS BACKOUT SUBROUTINE RTN1 FOR CLEAN UP PROCESSING,*/ 05879000
*/* AND RETURNS TO RTM SPECIFYING NO RETRY.                          */ 05880000
*/*                                                                  */ 05881000
*/* IF THE FRR HAS BEEN ENTERED, THIS ROUTINE BYPASSES THE ERROR     */ 05882000
*/* RECORDING PROCESSING, SINCE THIS WILL HAVE BEEN DONE BY THE FRR. */ 05883000
*/*                                                                  */ 05884000
*/* SUBROUTINES CALLED: RTN1, UNLOCK                                 */ 05885000
*/*                                                                  */ 05886000
*/* SYSTEM ROUTINES CALLED / MACROS ISSUED: SETRP, SETLOCK           */ 05887000
*/*                                                                  */ 05888000
*/* RETURN CODES SET: X00NRTRY                                       */ 05889000
*/*                                                                  */ 05890000
*/* REGISTER USAGE:                                                  */ 05891000
*/*                                                                  */ 05892000
*/* R0WORK - INPUT CODE: X'0C' - NO SDWA                             */ 05893000
*/*                      OTHER - AN SDWA IS PROVIDED                 */ 05894000
*/* R1AREA - INPUT, ADDRESS OF SDWA IF THERE IS ONE (FIELD SDWAPARM  */ 05895000
*/*          CONTAINS THE ADDRESS OF WKEXSAVE)                       */ 05896000
*/*        - ABEND COMPLETION CODE OTHERWISE                         */ 05897000
*/* R2WORK - ADDRESS OF WKEXSAVE IF THERE IS NO SDWA                 */ 05898000
*/* R13WORK - ADDRESS OF A SAVE AREA IF THERE IS NO SDWA             */ 05899000
*/*                                                                  */ 05900000
*/********************************************************************/ 05901000
*/* E ENTER IGC042ES                                                 */ 05902000
*                                                                  1682 05903000
*   RFY                                                            1682 05904000
*     R0WORK RSTD;                                                 1682 05905000
*   RFY                                                            1683 05906000
*     R1AREA RSTD;                                                 1683 05907000
*   RFY                                                            1684 05908000
*     R2WORK RSTD;                                                 1684 05909000
*   RFY                                                            1685 05910000
*     R13WORK RSTD;                                                1685 05911000
*   RFY                                                            1686 05912000
*     R14RET RSTD;                                                 1686 05913000
*   GEN(USING IGC042ES,R15WORK);    /*                        @Y02753*/ 05914000
         USING IGC042ES,R15WORK                                         05915000
*   R6BASE=BASEPTR1;                /* ADDRESS OF ATTACH SVC ENTRY 1688 05916000
*                                                             @Y02753*/ 05917000
         L     R6BASE,BASEPTR1                                     1688 05918000
*   R9BASE=BASEPTR2;                /* ATTACH SVC ENTRY PT + 4096  1689 05919000
*                                                             @Y02753*/ 05920000
         L     R9BASE,BASEPTR2                                     1689 05921000
*   GEN(DROP  R15WORK);                                            1690 05922000
*                                                                  1690 05923000
         DROP  R15WORK                                                  05924000
*/* D (NO,%FL06000,YES,) IS THERE AN SDWA ?                          */ 05925000
*                                                                  1691 05926000
*   IF R0WORK^=X0CSDWA THEN         /*                        @Y02753*/ 05927000
         CH    R0WORK,@CH02681                                     1691 05928000
         BE    @RF01691                                            1691 05929000
*     DO;                           /* DO000100               @Y02753*/ 05930000
*/* P INDICATE RECORDING, NO RETRY                                   */ 05931000
*                                                                  1693 05932000
*       DO;                         /* SETRP RECORD(YES)RC(0)        */ 05933000
*         RESPECIFY                                                1694 05934000
*          (GPR00P,                                                1694 05935000
*           GPR01P,                                                1694 05936000
*           GPR14P,                                                1694 05937000
*           GPR15P) RSTD;                                          1694 05938000
*         GPR01P->SDWARCDE=0;       /* SAVE RC VALUE                 */ 05939000
         MVI   SDWARCDE(GPR01P),X'00'                              1695 05940000
*         GPR01P->SDWARCRD='1'B;    /* TURN ON RECORD INDICATOR      */ 05941000
         OI    SDWARCRD(GPR01P),B'10000000'                        1696 05942000
*         RESPECIFY                                                1697 05943000
*          (GPR00P,                                                1697 05944000
*           GPR01P,                                                1697 05945000
*           GPR14P,                                                1697 05946000
*           GPR15P) UNRSTD;                                        1697 05947000
*       END;                        /*                        @Y02753*/ 05948000
*       R12SVRB=R1AREA->SDWAPARM;   /* RESET PERM WORK ADDR   @Y02753*/ 05949000
         L     R12SVRB,SDWAPARM(,R1AREA)                           1699 05950000
*/* D (NO,%FL06010,YES,) HAS FRR BEEN ENTERED ?                      */ 05951000
*                                                                  1700 05952000
*       IF WKFRRSW='1'B THEN        /*                        @Y02753*/ 05953000
         TM    WKFRRSW(R12SVRB),B'01000000'                        1700 05954000
         BNO   @RF01700                                            1700 05955000
*         DO;                       /* DO000037               @Y02753*/ 05956000
*/* P (,AT001760) INDICATE NO RECORDING                              */ 05957000
*                                                                  1702 05958000
*           DO;                     /* SETRP RECORD(NO)              */ 05959000
*             RESPECIFY                                            1703 05960000
*              (GPR00P,                                            1703 05961000
*               GPR01P,                                            1703 05962000
*               GPR14P,                                            1703 05963000
*               GPR15P) RSTD;                                      1703 05964000
*             GPR01P->SDWARCDE=0;   /* SAVE RC VALUE                 */ 05965000
         MVI   SDWARCDE(GPR01P),X'00'                              1704 05966000
*             GPR01P->SDWARCRD='0'B;/* TURN OFF RECORD INDICATOR     */ 05967000
         NI    SDWARCRD(GPR01P),B'01111111'                        1705 05968000
*             RESPECIFY                                            1706 05969000
*              (GPR00P,                                            1706 05970000
*               GPR01P,                                            1706 05971000
*               GPR14P,                                            1706 05972000
*               GPR15P) UNRSTD;                                    1706 05973000
*           END;                    /*                        @Y02753*/ 05974000
*         END;                      /* END00037               @Y02753*/ 05975000
*       ELSE                        /* FRR HAS NOT BEEN ENTERED    1709 05976000
*                                                             @Y02753*/ 05977000
*         DO;                       /* DO000103               @Y02753*/ 05978000
         B     @RC01700                                            1709 05979000
@RF01700 DS    0H                                                  1710 05980000
*/* %FL06010: P (,AT001760) MOVE RECORDING PARMS INTO OUTPUT AREA    */ 05981000
*                                                                  1710 05982000
*           RFY                                                    1710 05983000
*             R7WORK RSTD;                                         1710 05984000
*           RFY                                                    1711 05985000
*             R8WORK RSTD;                                         1711 05986000
*           R7WORK=R1AREA->SDWAVRAL;/* LENGTH OF OUTPUT AREA  @Y02753*/ 05987000
         SLR   R7WORK,R7WORK                                       1712 05988000
         ICM   R7WORK,3,SDWAVRAL(R1AREA)                           1712 05989000
*           R8WORK=LENGTH(WKCONTRL);/* LENGTH PERM WORKAREA   @Y02753*/ 05990000
         LA    R8WORK,24                                           1713 05991000
*           IF R7WORK<R8WORK THEN   /* WILL ENTIRE WORKAREA FIT ?  1714 05992000
*                                                             @Y02753*/ 05993000
         CR    R7WORK,R8WORK                                       1714 05994000
         BNL   @RF01714                                            1714 05995000
*             R8WORK=R7WORK;        /* RESET TO AVAILABLE LENGTH   1715 05996000
*                                                             @Y02753*/ 05997000
         LR    R8WORK,R7WORK                                       1715 05998000
*           R1AREA->SDWAVRA(1:R8WORK)=WKCONTRL;/* TO OUTPUT DATA AREA   05999000
*                                                             @Y02753*/ 06000000
@RF01714 LR    @15,R8WORK                                          1716 06001000
         BCTR  @15,0                                               1716 06002000
         EX    @15,@SM03155                                        1716 06003000
*           R1AREA->SDWAURAL=R8WORK;/* LENGTH RECORDED        @Y02753*/ 06004000
         STC   R8WORK,SDWAURAL(,R1AREA)                            1717 06005000
*           R1AREA->SDWARECP(1:LENGTH(ATMODZ))=ATMODZ;/* MODULE AND     06006000
*                                      CSECT NAMES            @Y02753*/ 06007000
         MVC   SDWARECP(16,R1AREA),ATMODZ                          1718 06008000
*           R1AREA->SDWAREXN=ATESTAEZ;/* RECOVERY ROUTINE NAME     1719 06009000
*                                                             @Y02753*/ 06010000
         MVC   SDWAREXN(8,R1AREA),ATESTAEZ                         1719 06011000
*         END;                      /* END00103               @Y02753*/ 06012000
*     END;                          /* END00100               @Y02753*/ 06013000
*   ELSE                            /* NO SDWA                @Y02753*/ 06014000
*/* %FL06000: P GET ADDRESS OF PERMANENT WORKAREA                    */ 06015000
*                                                                  1722 06016000
*     R12SVRB=R2WORK;               /* RESET PERM WORK ADDR   @Y02753*/ 06017000
         B     @RC01691                                            1722 06018000
@RF01691 LR    R12SVRB,R2WORK                                      1722 06019000
*/* AT001760: P STORE RETURN ADDRESS IN WORKAREA                     */ 06020000
*                                                                  1723 06021000
*AT001760:                                                         1723 06022000
*   WKRECR14=R14RET;                /* RETURN ADDRESS         @Y02753*/ 06023000
@RC01691 DS    0H                                                  1723 06024000
AT001760 ST    R14RET,WKRECR14(,R12SVRB)                           1723 06025000
*   RFY                                                            1724 06026000
*     R14RET UNRSTD;                                               1724 06027000
*                                                                  1724 06028000
*/* S RTN1: PERFORM CLEAN UP                                         */ 06029000
*                                                                  1725 06030000
*   R4CURTCB=WKCURTCB;              /* CURRENT TCB ADDRESS    @Y02753*/ 06031000
         L     R4CURTCB,WKCURTCB(,R12SVRB)                         1725 06032000
*   CALL RTN1;                      /* CLEAN UP ROUTINE       @Y02753*/ 06033000
         BAL   @14,RTN1                                            1726 06034000
*/* AT001720: R RETURN                                               */ 06035000
*                                                                  1727 06036000
*   RFY                                                            1727 06037000
*     R14RET RSTD;                                                 1727 06038000
*   RFY                                                            1728 06039000
*     R15WORK RSTD;                                                1728 06040000
*AT001720:                                                         1729 06041000
*   R14RET=WKRECR14;                /* RESTORE RETURN ADDRESS @Y02753*/ 06042000
AT001720 L     R14RET,WKRECR14(,R12SVRB)                           1729 06043000
*   R15WORK=X00NRTRY;               /* SPECIFY NO RETRY       @Y02753*/ 06044000
         SLR   R15WORK,R15WORK                                     1730 06045000
*   RFY                                                            1731 06046000
*     R14RET UNRSTD;                                               1731 06047000
*   RFY                                                            1732 06048000
*     R15WORK UNRSTD;                                              1732 06049000
*   END IGC042ES;                   /*                        @Y02753*/ 06050000
@EL00023 DS    0H                                                  1733 06051000
@EF00023 DS    0H                                                  1733 06052000
@ER00023 BR    @14                                                 1733 06053000
*/* IGC042ES: END FLOWCHART                                          */ 06054000
*                                                                  1734 06055000
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */ 06056000
*     GPR00P PTR(31) REG(0),                                       1734 06057000
*     GPR01P PTR(31) REG(1),                                       1734 06058000
*     GPR14P PTR(31) REG(14),                                      1734 06059000
*     GPR15P PTR(31) REG(15);                                      1734 06060000
*   DECLARE                         /* COMMON VARIABLES              */ 06061000
*     I256C CHAR(256) BASED,                                       1735 06062000
*     I031F FIXED(31) BASED,                                       1735 06063000
*     I031P PTR(31) BASED,                                         1735 06064000
*     I015F FIXED(15) BASED,                                       1735 06065000
*     I015P PTR(15) BASED,                                         1735 06066000
*     I008P PTR(8) BASED,                                          1735 06067000
*     I001C CHAR(1) BASED;          /*                        @Y02753*/ 06068000
*   END IGC0004B                    /* END ATTACH MODULE             */ 06069000
*                                                                  1736 06070000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 06071000
*/*%INCLUDE SYSLIB  (IKJTCB  )                                       */ 06072000
*/*%INCLUDE SYSLIB  (IHAIQE  )                                       */ 06073000
*/*%INCLUDE SYSLIB  (IHASPQE )                                       */ 06074000
*/*%INCLUDE SYSLIB  (IHAASCB )                                       */ 06075000
*/*%INCLUDE SYSLIB  (IHAASXB )                                       */ 06076000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 06077000
*/*%INCLUDE SYSLIB  (IHASCVT )                                       */ 06078000
*/*%INCLUDE SYSLIB  (IHAPDS  )                                       */ 06079000
*/*%INCLUDE SYSLIB  (IHASDWA )                                       */ 06080000
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */ 06081000
*/*%INCLUDE SYSLIB  (IHAFRRS )                                       */ 06082000
*/*%INCLUDE SYSLIB  (IHAESTA )                                       */ 06083000
*/*%INCLUDE SYSLIB  (IHARB   )                                       */ 06084000
*/*%INCLUDE SYSLIB  (IKJRB   )                                       */ 06085000
*/*%INCLUDE SYSLIB  (IHASCB  )                                       */ 06086000
*/*%INCLUDE SYSLIB  (IEZATTCH)                                       */ 06087000
*                                                                  1736 06088000
*       ;                                                          1736 06089000
@DATA    DS    0H                                                       06090000
@CH00061 DC    H'1'                                                     06091000
@CH02795 DC    H'9'                                                     06092000
@CH00066 DC    H'24'                                                    06093000
@CH00049 DC    H'32'                                                    06094000
@CH00168 DC    H'64'                                                    06095000
@CH02714 DC    H'127'                                                   06096000
@CH01366 DC    H'256'                                                   06097000
@CH02700 DC    XL2'12A'                                                 06098000
@CH02677 DC    XL2'04'                                                  06099000
@CH02681 DC    XL2'0C'                                                  06100000
@CH02683 DC    XL2'14'                                                  06101000
@SX03144 XC    AREA(0,R1AREA),AREA(R1AREA)                              06102000
@SM03153 MVC   AREA(0,R8WORK),AREA(R7WORK)                              06103000
@SM03155 MVC   SDWAVRA(0,R1AREA),WKCONTRL(R12SVRB)                      06104000
@DATD    DSECT                                                          06105000
         DS    0F                                                       06106000
IGC0004B CSECT                                                          06107000
         DS    0F                                                       06108000
@DATD    DSECT                                                          06109000
         DS    0D                                                       06110000
IGC0004B CSECT                                                          06111000
         NOPR  ((@ENDDATD-@DATD)*16)                                    06112000
         DS    0F                                                       06113000
@SIZDATD DC    AL1(0)                                                   06114000
         DC    AL3(@ENDDATD-@DATD)                                      06115000
         DS    0D                                                       06116000
BASEPTR1 DC    AL4(IGC0004B)                                            06117000
BASEPTR2 DC    AL4(IGC0004B+4096)                                       06118000
SPID253  DC    AL1(253)                                                 06119000
SPID255  DC    AL1(255)                                                 06120000
@CB02704 DC    X'42A0'                                                  06121000
@CB02708 DC    X'72A0'                                                  06122000
         DS    CL2                                                      06123000
NEWPSW   DS    CL8                                                      06124000
         ORG   NEWPSW                                                   06125000
FLAGS    DC    X'070C0000'                                              06126000
INSTADDR DC    AL4(IGC042R1)                                            06127000
         ORG   NEWPSW+8                                                 06128000
CHARTCB  DC    CL4'TCB '                                                06129000
ATRECID  DS    CL33                                                     06130000
         ORG   ATRECID                                                  06131000
ATIDLNG  DC    AL1(24)                                                  06132000
ATFRRID  DS    CL24                                                     06133000
         ORG   ATFRRID                                                  06134000
ATMODZ   DS    CL16                                                     06135000
         ORG   ATMODZ                                                   06136000
ATMODID  DC    CL8'IEAVEAT0'                                            06137000
ATCSECT  DC    CL8'IGC0004B'                                            06138000
         ORG   ATFRRID+16                                               06139000
ATFRRZ   DC    CL8'IGC042R2'                                            06140000
         ORG   ATRECID+25                                               06141000
ATESTAEZ DC    CL8'IGC042ES'                                            06142000
         ORG   ATRECID+33                                               06143000
IGC0004B CSECT                                                          06144000
*                                 /* PATCH AREA - 200 BYTES */          06145000
AT0PATCH DC    50F'0'                  PATCH AREA                       06146000
@DATD    DSECT                                                          06147000
@ENDDATD EQU   *                                                        06148000
IGC0004B CSECT                                                          06149000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       06150000
@01      EQU   01                                                       06151000
@02      EQU   02                                                       06152000
@03      EQU   03                                                       06153000
@04      EQU   04                                                       06154000
@05      EQU   05                                                       06155000
@06      EQU   06                                                       06156000
@07      EQU   07                                                       06157000
@08      EQU   08                                                       06158000
@09      EQU   09                                                       06159000
@10      EQU   10                                                       06160000
@11      EQU   11                                                       06161000
@12      EQU   12                                                       06162000
@13      EQU   13                                                       06163000
@14      EQU   14                                                       06164000
@15      EQU   15                                                       06165000
ESTAPTR  EQU   @01                                                      06166000
R12SVRB  EQU   @12                                                      06167000
R1AREA   EQU   @01                                                      06168000
R0WORK   EQU   @00                                                      06169000
R1ESTAE  EQU   @01                                                      06170000
R1WORK   EQU   @01                                                      06171000
R2WORK   EQU   @02                                                      06172000
R3WORKAD EQU   @03                                                      06173000
R3WORK   EQU   @03                                                      06174000
R4CURTCB EQU   @04                                                      06175000
R4WORK   EQU   @04                                                      06176000
R5NEWTCB EQU   @05                                                      06177000
R5CURRB  EQU   @05                                                      06178000
R5WORK   EQU   @05                                                      06179000
R6BASE   EQU   @06                                                      06180000
R7ASCB   EQU   @07                                                      06181000
R7IQE    EQU   @07                                                      06182000
R7WORK   EQU   @07                                                      06183000
R8IRB    EQU   @08                                                      06184000
R8WORK   EQU   @08                                                      06185000
R9BASE   EQU   @09                                                      06186000
R9SAVE   EQU   @09                                                      06187000
R10WORK  EQU   @10                                                      06188000
R10LOOPC EQU   @10                                                      06189000
R10INPRM EQU   @10                                                      06190000
R11WORK  EQU   @11                                                      06191000
R11PTR   EQU   @11                                                      06192000
R11LNGTH EQU   @11                                                      06193000
R12WORK  EQU   @12                                                      06194000
R13WORK  EQU   @13                                                      06195000
R14RET   EQU   @14                                                      06196000
R14FRRAD EQU   @14                                                      06197000
R15INPRM EQU   @15                                                      06198000
R15RETCD EQU   @15                                                      06199000
R15WORK  EQU   @15                                                      06200000
GPR00P   EQU   @00                                                      06201000
GPR01P   EQU   @01                                                      06202000
GPR14P   EQU   @14                                                      06203000
GPR15P   EQU   @15                                                      06204000
R14WORK  EQU   @14                                                      06205000
R7BRANCH EQU   @07                                                      06206000
CVTPTR   EQU   16                                                       06207000
PSA      EQU   0                                                        06208000
FLCRNPSW EQU   PSA                                                      06209000
FLCROPSW EQU   PSA+8                                                    06210000
FLCICCW2 EQU   PSA+16                                                   06211000
PSAEEPSW EQU   PSA+132                                                  06212000
PSAESPSW EQU   PSA+136                                                  06213000
FLCSVILC EQU   PSAESPSW+1                                               06214000
PSAEPPSW EQU   PSA+140                                                  06215000
FLCPIILC EQU   PSAEPPSW+1                                               06216000
FLCPICOD EQU   PSAEPPSW+2                                               06217000
PSAPICOD EQU   FLCPICOD+1                                               06218000
FLCTEA   EQU   PSAEPPSW+4                                               06219000
FLCPER   EQU   PSA+152                                                  06220000
FLCMCLA  EQU   PSA+168                                                  06221000
FLCIOEL  EQU   FLCMCLA+4                                                06222000
FLCIOA   EQU   FLCMCLA+16                                               06223000
FLCFSA   EQU   FLCMCLA+80                                               06224000
PSAAOLD  EQU   PSA+548                                                  06225000
PSASUPER EQU   PSA+552                                                  06226000
PSASUP1  EQU   PSASUPER                                                 06227000
PSASUP2  EQU   PSASUPER+1                                               06228000
PSASUP3  EQU   PSASUPER+2                                               06229000
PSASUP4  EQU   PSASUPER+3                                               06230000
PSACLHT  EQU   PSA+640                                                  06231000
PSALKSA  EQU   PSA+696                                                  06232000
PSAHLHI  EQU   PSA+760                                                  06233000
PSALITA  EQU   PSA+764                                                  06234000
PSADSSFL EQU   PSA+836                                                  06235000
PSADSSF1 EQU   PSADSSFL                                                 06236000
PSADSSF3 EQU   PSADSSFL+2                                               06237000
PSADSSF4 EQU   PSADSSFL+3                                               06238000
PSARSVT  EQU   PSA+896                                                  06239000
PSALSFCC EQU   PSA+1012                                                 06240000
SCVTSPTR EQU   0                                                        06241000
TCBPTR   EQU   0                                                        06242000
ASCBPTR  EQU   0                                                        06243000
ASXBPTR  EQU   0                                                        06244000
ATTCHPTR EQU   0                                                        06245000
IQEPTR   EQU   0                                                        06246000
PDS2PTR  EQU   0                                                        06247000
PDSPTRV  EQU   0                                                        06248000
RBSECPTR EQU   0                                                        06249000
SPQESPTR EQU   0                                                        06250000
FRRSPTR  EQU   0                                                        06251000
FRREPTR  EQU   0                                                        06252000
SDWAPTR  EQU   0                                                        06253000
TCBFIX   EQU   0                                                        06254000
TCBFRS   EQU   TCBFIX                                                   06255000
TCB      EQU   0                                                        06256000
TCBRBP   EQU   TCB                                                      06257000
TCBPIE   EQU   TCB+4                                                    06258000
TCBPMASK EQU   TCBPIE                                                   06259000
TCBTIO   EQU   TCB+12                                                   06260000
TCBCMP   EQU   TCB+16                                                   06261000
TCBCMPF  EQU   TCBCMP                                                   06262000
TCBCPP   EQU   TCBCMPF                                                  06263000
TCBSTCC  EQU   TCBCMPF                                                  06264000
TCBCDBL  EQU   TCBCMPF                                                  06265000
TCBCWTO  EQU   TCBCMPF                                                  06266000
TCBCIND  EQU   TCBCMPF                                                  06267000
TCBCMSG  EQU   TCBCMPF                                                  06268000
TCBTRN   EQU   TCB+20                                                   06269000
TCBABF   EQU   TCBTRN                                                   06270000
TCBTCP   EQU   TCBABF                                                   06271000
TCBMSS   EQU   TCB+24                                                   06272000
TCBMSSB  EQU   TCBMSS+1                                                 06273000
TCBPKF   EQU   TCB+28                                                   06274000
TCBFLGS  EQU   TCB+29                                                   06275000
TCBFLGS1 EQU   TCBFLGS                                                  06276000
TCBFLGS2 EQU   TCBFLGS+1                                                06277000
TCBFETXR EQU   TCBFLGS2                                                 06278000
TCBFLGS3 EQU   TCBFLGS+2                                                06279000
TCBFSM   EQU   TCBFLGS3                                                 06280000
TCBFLGS4 EQU   TCBFLGS+3                                                06281000
TCBFLGS5 EQU   TCBFLGS+4                                                06282000
TCBABWF  EQU   TCBFLGS5                                                 06283000
TCBANDSP EQU   TCBFLGS5                                                 06284000
TCBLMP   EQU   TCB+34                                                   06285000
TCBDSP   EQU   TCB+35                                                   06286000
TCBJLB   EQU   TCB+40                                                   06287000
TCBJPQ   EQU   TCB+44                                                   06288000
TCBPURGE EQU   TCBJPQ                                                   06289000
TCBGRS   EQU   TCB+48                                                   06290000
TCBGRS3  EQU   TCBGRS+12                                                06291000
TCBGRS4  EQU   TCBGRS+16                                                06292000
TCBGRS5  EQU   TCBGRS+20                                                06293000
TCBGRS6  EQU   TCBGRS+24                                                06294000
TCBGRS9  EQU   TCBGRS+36                                                06295000
TCBGRS10 EQU   TCBGRS+40                                                06296000
TCBGRS11 EQU   TCBGRS+44                                                06297000
TCBGRS12 EQU   TCBGRS+48                                                06298000
TCBFSA   EQU   TCB+112                                                  06299000
TCBFSAB  EQU   TCBFSA+1                                                 06300000
TCBTCB   EQU   TCB+116                                                  06301000
TCBTME   EQU   TCB+120                                                  06302000
TCBJSTCB EQU   TCB+124                                                  06303000
TCBJSTCA EQU   TCBJSTCB+1                                               06304000
TCBNTC   EQU   TCB+128                                                  06305000
TCBOTC   EQU   TCB+132                                                  06306000
TCBLTC   EQU   TCB+136                                                  06307000
TCBIQE   EQU   TCB+140                                                  06308000
TCBECB   EQU   TCB+144                                                  06309000
TCBTSFLG EQU   TCB+148                                                  06310000
TCBTSTSK EQU   TCBTSFLG                                                 06311000
TCBSTPPR EQU   TCBTSFLG                                                 06312000
TCBATT   EQU   TCBTSFLG                                                 06313000
TCBSTPCT EQU   TCB+149                                                  06314000
TCBPQE   EQU   TCB+152                                                  06315000
TCBSTAB  EQU   TCB+160                                                  06316000
TCBNSTAE EQU   TCBSTAB                                                  06317000
TCBSTABE EQU   TCBNSTAE                                                 06318000
TCBSTABB EQU   TCBSTAB+1                                                06319000
TCBTCT   EQU   TCB+164                                                  06320000
TCBTCTGF EQU   TCBTCT                                                   06321000
TCBSCNDY EQU   TCB+172                                                  06322000
TCBNDSP  EQU   TCBSCNDY                                                 06323000
TCBNDSP1 EQU   TCBNDSP+1                                                06324000
TCBNDSP2 EQU   TCBNDSP+2                                                06325000
TCBNDSP3 EQU   TCBNDSP+3                                                06326000
TCBJSCB  EQU   TCB+180                                                  06327000
TCBRECDE EQU   TCBJSCB                                                  06328000
TCBJSCBB EQU   TCBJSCB+1                                                06329000
TCBEXT1  EQU   TCB+196                                                  06330000
TCBBITS  EQU   TCB+200                                                  06331000
TCBNDSP4 EQU   TCBBITS                                                  06332000
TCBNDSP5 EQU   TCBBITS+1                                                06333000
TCBFLGS6 EQU   TCBBITS+2                                                06334000
TCBRV    EQU   TCBFLGS6                                                 06335000
TCBFLGS7 EQU   TCBBITS+3                                                06336000
TCBDAR   EQU   TCB+204                                                  06337000
TCBDARC  EQU   TCBDAR                                                   06338000
TCBEXT2  EQU   TCB+208                                                  06339000
TCBBACK  EQU   TCB+220                                                  06340000
TCBTID   EQU   TCB+238                                                  06341000
TCBXSCT  EQU   TCB+240                                                  06342000
TCBXSCT1 EQU   TCBXSCT                                                  06343000
TCBFOE   EQU   TCB+244                                                  06344000
TCBSWA   EQU   TCB+248                                                  06345000
TCBTCBID EQU   TCB+256                                                  06346000
TCBESTAE EQU   TCB+264                                                  06347000
TCBESTRM EQU   TCBESTAE+1                                               06348000
TCBAFFN  EQU   TCB+274                                                  06349000
TCBFBYT1 EQU   TCB+276                                                  06350000
TCBFBYT2 EQU   TCB+277                                                  06351000
TCBECBNV EQU   TCBFBYT2                                                 06352000
TCBRV124 EQU   TCB+278                                                  06353000
TCBRV133 EQU   TCB+279                                                  06354000
TCBXTNT2 EQU   0                                                        06355000
TCBGTF   EQU   TCBXTNT2                                                 06356000
TCBTFLG  EQU   TCBGTF                                                   06357000
TCBRV146 EQU   TCBXTNT2+28                                              06358000
TCBRV155 EQU   TCBXTNT2+29                                              06359000
TCBRV164 EQU   TCBXTNT2+30                                              06360000
TCBRV173 EQU   TCBXTNT2+31                                              06361000
IQESECT  EQU   0                                                        06362000
IQELNK   EQU   IQESECT                                                  06363000
IQEPARAM EQU   IQESECT+4                                                06364000
IQEIRB   EQU   IQESECT+8                                                06365000
IQEFLAGS EQU   IQEIRB                                                   06366000
IQETCB   EQU   IQESECT+12                                               06367000
SPQESECT EQU   0                                                        06368000
SPQEAD   EQU   SPQESECT                                                 06369000
SPQEPTR  EQU   SPQEAD                                                   06370000
SPDQEPTR EQU   SPQESECT+4                                               06371000
SPDQEAD  EQU   SPDQEPTR                                                 06372000
SPQEFLGS EQU   SPQESECT+8                                               06373000
SPSHARE  EQU   SPQEFLGS                                                 06374000
LASTSPQE EQU   SPQEFLGS                                                 06375000
SPQEOWN  EQU   SPQEFLGS                                                 06376000
SPQEID   EQU   SPQESECT+10                                              06377000
SPQEKEY  EQU   SPQESECT+11                                              06378000
ASCB     EQU   0                                                        06379000
ASCBSUPC EQU   ASCB+16                                                  06380000
ASCBRSM  EQU   ASCB+52                                                  06381000
ASCBRSMF EQU   ASCBRSM                                                  06382000
ASCBFW1  EQU   ASCB+100                                                 06383000
ASCBAFFN EQU   ASCBFW1                                                  06384000
ASCBRCTF EQU   ASCBFW1+2                                                06385000
ASCBFLG1 EQU   ASCBFW1+3                                                06386000
ASCBASXB EQU   ASCB+108                                                 06387000
ASCBDSP1 EQU   ASCB+114                                                 06388000
ASCBFLG2 EQU   ASCB+115                                                 06389000
ASCBTCBS EQU   ASCB+124                                                 06390000
ASCBLKGP EQU   ASCB+128                                                 06391000
ASCBSRQ  EQU   ASCB+180                                                 06392000
ASCBSRQ1 EQU   ASCBSRQ                                                  06393000
ASCBSRQ2 EQU   ASCBSRQ+1                                                06394000
ASCBSRQ3 EQU   ASCBSRQ+2                                                06395000
ASCBSRQ4 EQU   ASCBSRQ+3                                                06396000
ASXB     EQU   0                                                        06397000
ASXBFTCB EQU   ASXB+4                                                   06398000
ASXBLTCB EQU   ASXB+8                                                   06399000
ASXBTCBS EQU   ASXB+12                                                  06400000
ASXBAEQ  EQU   ASXB+168                                                 06401000
ASXBSECR EQU   ASXB+199                                                 06402000
ASCBSFLG EQU   ASXBSECR                                                 06403000
ASXBCASW EQU   ASXB+216                                                 06404000
ASXBCRB1 EQU   ASXBCASW                                                 06405000
CVTMAP   EQU   0                                                        06406000
CVT      EQU   CVTMAP                                                   06407000
CVTDAR   EQU   CVTMAP+72                                                06408000
CVTFLGS1 EQU   CVTDAR                                                   06409000
CVTDCB   EQU   CVTMAP+116                                               06410000
CVTIOQET EQU   CVTMAP+120                                               06411000
CVTIERLC EQU   CVTMAP+144                                               06412000
CVTHEAD  EQU   CVTMAP+160                                               06413000
CVTSV76C EQU   CVTHEAD                                                  06414000
CVTOPTA  EQU   CVTMAP+182                                               06415000
CVTOPTB  EQU   CVTMAP+183                                               06416000
CVTGTF   EQU   CVTMAP+236                                               06417000
CVTGTFST EQU   CVTGTF                                                   06418000
CVTGTFS  EQU   CVTGTFST                                                 06419000
CVTSTATE EQU   CVTGTFST                                                 06420000
CVTTMODE EQU   CVTGTFST                                                 06421000
CVTFORM  EQU   CVTGTFST                                                 06422000
CVTAQAVT EQU   CVTMAP+240                                               06423000
CVTTCMFG EQU   CVTAQAVT                                                 06424000
CVTVOLM2 EQU   CVTMAP+244                                               06425000
CVTTATA  EQU   CVTVOLM2                                                 06426000
CVTTSKS  EQU   CVTTATA                                                  06427000
CVTVOLF2 EQU   CVTTSKS                                                  06428000
CVTTAT   EQU   CVTTATA+1                                                06429000
CVTATER  EQU   CVTMAP+248                                               06430000
CVTEXT1  EQU   CVTMAP+252                                               06431000
CVTPURG  EQU   CVTMAP+260                                               06432000
CVTQMSG  EQU   CVTMAP+268                                               06433000
CVTDMSR  EQU   CVTMAP+272                                               06434000
CVTRSV37 EQU   CVTDMSR                                                  06435000
CVTDMSRF EQU   CVTRSV37                                                 06436000
CVTERPV  EQU   CVTMAP+316                                               06437000
CVTINTLA EQU   CVTMAP+320                                               06438000
CVTAPF   EQU   CVTMAP+324                                               06439000
CVTEXT2  EQU   CVTMAP+328                                               06440000
CVTHJES  EQU   CVTMAP+332                                               06441000
CVTPGSIA EQU   CVTMAP+348                                               06442000
CVTA1F1  EQU   CVTMAP+356                                               06443000
CVTSYSK  EQU   CVTMAP+357                                               06444000
CVTVOLM1 EQU   CVTMAP+380                                               06445000
CVTVOLF1 EQU   CVTVOLM1                                                 06446000
CVTATMCT EQU   CVTMAP+388                                               06447000
CVTXTNT1 EQU   0                                                        06448000
CVTXTNT2 EQU   0                                                        06449000
CVTDSSV  EQU   CVTXTNT2                                                 06450000
CVTFLGBT EQU   CVTXTNT2+5                                               06451000
CVTQID   EQU   CVTXTNT2+24                                              06452000
CVTRV400 EQU   CVTXTNT2+52                                              06453000
CVTRV409 EQU   CVTXTNT2+53                                              06454000
CVTATCVT EQU   CVTXTNT2+64                                              06455000
CVTRV429 EQU   CVTXTNT2+84                                              06456000
CVTRV438 EQU   CVTXTNT2+85                                              06457000
CVTRV457 EQU   CVTXTNT2+112                                             06458000
CVTRV466 EQU   CVTXTNT2+113                                             06459000
CVTFIX   EQU   0                                                        06460000
CVTRELNO EQU   CVTFIX+252                                               06461000
SCVTSECT EQU   0                                                        06462000
PDS2     EQU   0                                                        06463000
PDS2INDC EQU   PDS2+13                                                  06464000
PDS2TTRT EQU   PDS2+14                                                  06465000
PDS2USRD EQU   PDS2TTRT                                                 06466000
PDS2ATR  EQU   PDS2+22                                                  06467000
PDS2ATR1 EQU   PDS2ATR                                                  06468000
PDS2ATR2 EQU   PDS2ATR+1                                                06469000
@NM00041 EQU   PDS2+32                                                  06470000
PDS2FTBO EQU   @NM00041                                                 06471000
PDS2FTB1 EQU   PDS2FTBO                                                 06472000
PDSS01   EQU   0                                                        06473000
PDSS02   EQU   0                                                        06474000
PDSS03   EQU   0                                                        06475000
PDSSSIWD EQU   PDSS03                                                   06476000
PDSSSIFB EQU   PDSSSIWD+1                                               06477000
PDSS04   EQU   0                                                        06478000
PDSAPF   EQU   PDSS04                                                   06479000
SDWA     EQU   0                                                        06480000
SDWAPARM EQU   SDWA                                                     06481000
SDWAFIOB EQU   SDWA+4                                                   06482000
SDWAABCC EQU   SDWAFIOB                                                 06483000
SDWACMPF EQU   SDWAABCC                                                 06484000
SDWAREQ  EQU   SDWACMPF                                                 06485000
SDWACMPC EQU   SDWAABCC+1                                               06486000
SDWACTL1 EQU   SDWA+8                                                   06487000
SDWACMKA EQU   SDWACTL1                                                 06488000
SDWAMWPA EQU   SDWACTL1+1                                               06489000
SDWAPMKA EQU   SDWACTL1+4                                               06490000
SDWACTL2 EQU   SDWA+16                                                  06491000
SDWACMKP EQU   SDWACTL2                                                 06492000
SDWAMWPP EQU   SDWACTL2+1                                               06493000
SDWAPMKP EQU   SDWACTL2+4                                               06494000
SDWAGRSV EQU   SDWA+24                                                  06495000
SDWANAME EQU   SDWA+88                                                  06496000
SDWAEC1  EQU   SDWA+104                                                 06497000
SDWAEMK1 EQU   SDWAEC1                                                  06498000
SDWAMWP1 EQU   SDWAEC1+1                                                06499000
SDWAINT1 EQU   SDWAEC1+2                                                06500000
SDWANXT1 EQU   SDWAEC1+4                                                06501000
SDWAAEC1 EQU   SDWA+112                                                 06502000
SDWAILC1 EQU   SDWAAEC1+1                                               06503000
SDWAINC1 EQU   SDWAAEC1+2                                               06504000
SDWAICD1 EQU   SDWAINC1+1                                               06505000
SDWAEC2  EQU   SDWA+120                                                 06506000
SDWAEMK2 EQU   SDWAEC2                                                  06507000
SDWAMWP2 EQU   SDWAEC2+1                                                06508000
SDWAINT2 EQU   SDWAEC2+2                                                06509000
SDWANXT2 EQU   SDWAEC2+4                                                06510000
SDWAAEC2 EQU   SDWA+128                                                 06511000
SDWAILC2 EQU   SDWAAEC2+1                                               06512000
SDWAINC2 EQU   SDWAAEC2+2                                               06513000
SDWAICD2 EQU   SDWAINC2+1                                               06514000
SDWASRSV EQU   SDWA+136                                                 06515000
SDWAIDNT EQU   SDWA+200                                                 06516000
SDWAMCH  EQU   SDWA+204                                                 06517000
SDWASTCK EQU   SDWAMCH                                                  06518000
SDWAMCHI EQU   SDWAMCH+8                                                06519000
SDWAMCHS EQU   SDWAMCHI                                                 06520000
SDWAMCHD EQU   SDWAMCHI+1                                               06521000
SDWARSR1 EQU   SDWAMCH+12                                               06522000
SDWARSR2 EQU   SDWAMCH+13                                               06523000
SDWAFLGS EQU   SDWA+232                                                 06524000
SDWAERRA EQU   SDWAFLGS                                                 06525000
SDWAPCHK EQU   SDWAERRA                                                 06526000
SDWAERRB EQU   SDWAFLGS+1                                               06527000
SDWAERRC EQU   SDWAFLGS+2                                               06528000
SDWAERRD EQU   SDWAFLGS+3                                               06529000
SDWAFMID EQU   SDWA+236                                                 06530000
SDWAIOFS EQU   SDWA+238                                                 06531000
SDWACPUA EQU   SDWA+248                                                 06532000
SDWAPARQ EQU   SDWA+252                                                 06533000
SDWARCDE EQU   SDWAPARQ                                                 06534000
SDWAACF2 EQU   SDWAPARQ+1                                               06535000
SDWARCRD EQU   SDWAACF2                                                 06536000
SDWAACF3 EQU   SDWAPARQ+2                                               06537000
SDWAACF4 EQU   SDWAPARQ+3                                               06538000
SDWALKWA EQU   SDWA+256                                                 06539000
SDWALKWS EQU   SDWALKWA                                                 06540000
SDWARECP EQU   SDWA+292                                                 06541000
SDWAREXN EQU   SDWARECP+16                                              06542000
SDWASNPA EQU   SDWA+320                                                 06543000
SDWADUMP EQU   SDWASNPA                                                 06544000
SDWADPFS EQU   SDWADUMP+1                                               06545000
SDWADDAT EQU   SDWASNPA+4                                               06546000
SDWASDAT EQU   SDWADDAT                                                 06547000
SDWAPDAT EQU   SDWADDAT+2                                               06548000
SDWADPSA EQU   SDWA+328                                                 06549000
SDWADPSL EQU   SDWADPSA                                                 06550000
SDWARA   EQU   SDWA+400                                                 06551000
SDWAVRAL EQU   SDWARA                                                   06552000
SDWADPVA EQU   SDWARA+2                                                 06553000
SDWAURAL EQU   SDWARA+3                                                 06554000
SDWAVRA  EQU   SDWARA+4                                                 06555000
FRRS     EQU   0                                                        06556000
FRRSHEAD EQU   FRRS                                                     06557000
FRRSEMP  EQU   FRRSHEAD                                                 06558000
FRRSLAST EQU   FRRSHEAD+4                                               06559000
FRRSELEN EQU   FRRSHEAD+8                                               06560000
FRRSCURR EQU   FRRSHEAD+12                                              06561000
FRRSENTR EQU   0                                                        06562000
FRRSFRRA EQU   FRRSENTR                                                 06563000
FRRSFLGS EQU   FRRSENTR+4                                               06564000
FRRSFLG1 EQU   FRRSFLGS                                                 06565000
FRRSPARM EQU   FRRSENTR+8                                               06566000
ESTA     EQU   0                                                        06567000
ESTAEXT  EQU   ESTA                                                     06568000
ESTAFLG1 EQU   ESTAEXT                                                  06569000
ESTASTAI EQU   ESTAFLG1                                                 06570000
ESTAESTA EQU   ESTAFLG1                                                 06571000
ESTASYNC EQU   ESTAFLG1                                                 06572000
ESTAIO   EQU   ESTAFLG1                                                 06573000
ESTAEXIT EQU   ESTAEXT+1                                                06574000
ESTAPARM EQU   ESTA+4                                                   06575000
ESTAOWNR EQU   ESTA+8                                                   06576000
ESTAFGRS EQU   ESTA+12                                                  06577000
ESTAFLG2 EQU   ESTAFGRS                                                 06578000
ESTATERM EQU   ESTAFLG2                                                 06579000
RBPRFX   EQU   0                                                        06580000
RBBASIC  EQU   0                                                        06581000
RBEXRTNM EQU   RBBASIC                                                  06582000
RBTMFLD  EQU   RBEXRTNM                                                 06583000
RBSTAB   EQU   RBBASIC+10                                               06584000
XSTAB    EQU   RBSTAB                                                   06585000
RBSTAB1  EQU   XSTAB                                                    06586000
XSTAB1   EQU   RBSTAB1                                                  06587000
RBFTCKPT EQU   XSTAB1                                                   06588000
RBSTAB2  EQU   XSTAB+1                                                  06589000
XSTAB2   EQU   RBSTAB2                                                  06590000
RBTCBNXT EQU   XSTAB2                                                   06591000
RBFACTV  EQU   XSTAB2                                                   06592000
RBFDYN   EQU   XSTAB2                                                   06593000
RBECBWT  EQU   XSTAB2                                                   06594000
RBOPSW   EQU   RBBASIC+16                                               06595000
XRBPSW   EQU   RBOPSW                                                   06596000
RBOPSWB2 EQU   XRBPSW+1                                                 06597000
RBLINK   EQU   RBBASIC+28                                               06598000
XRBLNK   EQU   RBLINK                                                   06599000
RBWCF    EQU   XRBLNK                                                   06600000
RBLINKB  EQU   XRBLNK+1                                                 06601000
RBGRSAVE EQU   RBBASIC+32                                               06602000
XRBREG   EQU   RBGRSAVE                                                 06603000
RBGRS0   EQU   XRBREG                                                   06604000
RBGRS1   EQU   XRBREG+4                                                 06605000
RBGRS2   EQU   XRBREG+8                                                 06606000
RBGRS3   EQU   XRBREG+12                                                06607000
RBGRS4   EQU   XRBREG+16                                                06608000
RBGRS5   EQU   XRBREG+20                                                06609000
RBGRS6   EQU   XRBREG+24                                                06610000
RBGRS7   EQU   XRBREG+28                                                06611000
RBGRS8   EQU   XRBREG+32                                                06612000
RBGRS9   EQU   XRBREG+36                                                06613000
RBGRS10  EQU   XRBREG+40                                                06614000
RBGRS11  EQU   XRBREG+44                                                06615000
RBGRS12  EQU   XRBREG+48                                                06616000
RBGRS13  EQU   XRBREG+52                                                06617000
RBGRS14  EQU   XRBREG+56                                                06618000
RBGRS15  EQU   XRBREG+60                                                06619000
XRBESA   EQU   RBBASIC+96                                               06620000
RBEXSAVE EQU   XRBESA                                                   06621000
RBPREFIX EQU   0                                                        06622000
RBRSV019 EQU   RBPREFIX+14                                              06623000
RBRSV028 EQU   RBPREFIX+15                                              06624000
RBRSV041 EQU   RBPREFIX+27                                              06625000
RBPRFXST EQU   RBPREFIX+32                                              06626000
RBRSV054 EQU   RBPREFIX+39                                              06627000
RBRTOPSW EQU   RBPREFIX+40                                              06628000
RBRTPSW2 EQU   RBRTOPSW+8                                               06629000
RBRTICIL EQU   RBRTPSW2                                                 06630000
RBFLAGS1 EQU   RBPREFIX+56                                              06631000
RBINTCDA EQU   RBPREFIX+61                                              06632000
RBPRFXND EQU   RBPREFIX+64                                              06633000
RBSECT   EQU   0                                                        06634000
RBPPSAV  EQU   RBSECT                                                   06635000
RBPPSAV1 EQU   RBPPSAV+1                                                06636000
RBSIZE   EQU   RBSECT+8                                                 06637000
@NM00135 EQU   RBSECT+10                                                06638000
@NM00136 EQU   @NM00135                                                 06639000
RBFTP    EQU   @NM00136                                                 06640000
RBTRSVRB EQU   @NM00136                                                 06641000
@NM00138 EQU   @NM00135+1                                               06642000
RBATTN   EQU   @NM00138                                                 06643000
RBETXR   EQU   @NM00138                                                 06644000
RBIQETP  EQU   @NM00138                                                 06645000
RBEP     EQU   RBSECT+12                                                06646000
RBPGMQ   EQU   RBSECT+24                                                06647000
@NM00145 EQU   RBSECT+28                                                06648000
@NM00146 EQU   @NM00145                                                 06649000
IRBEND   EQU   RBSECT+96                                                06650000
@NM00149 EQU   RBSECT+96                                                06651000
RBRSV138 EQU   @NM00149+7                                               06652000
RBSCBB   EQU   RBSECT+144                                               06653000
RBSPARM  EQU   RBSCBB+8                                                 06654000
RBSFLGS1 EQU   RBSPARM                                                  06655000
RBSIOPRC EQU   RBSFLGS1                                                 06656000
RBSOWNR  EQU   RBSCBB+12                                                06657000
RBSFLGS2 EQU   RBSOWNR                                                  06658000
RBSDATA  EQU   RBSCBB+16                                                06659000
RBSFLG3  EQU   RBSDATA                                                  06660000
RBRSV150 EQU   RBSECT+167                                               06661000
SCB      EQU   0                                                        06662000
SCBPARM  EQU   SCB+8                                                    06663000
SCBFLGS1 EQU   SCBPARM                                                  06664000
SCBIOPRC EQU   SCBFLGS1                                                 06665000
SCBOWNR  EQU   SCB+12                                                   06666000
SCBFLGS2 EQU   SCBOWNR                                                  06667000
SCBDATA  EQU   SCB+16                                                   06668000
SCBFLGS3 EQU   SCBDATA                                                  06669000
ATTCHLST EQU   0                                                        06670000
ATPGNADA EQU   ATTCHLST                                                 06671000
ATDEFLAG EQU   ATPGNADA                                                 06672000
ATDENTRY EQU   ATDEFLAG                                                 06673000
ATPGNADB EQU   ATPGNADA+1                                               06674000
ATDCBADA EQU   ATTCHLST+4                                               06675000
ATDCBADB EQU   ATDCBADA+1                                               06676000
ATECBADR EQU   ATTCHLST+8                                               06677000
ATECBFLG EQU   ATECBADR                                                 06678000
ATEXTN2  EQU   ATECBFLG                                                 06679000
ATTSKLB  EQU   ATECBFLG                                                 06680000
ATTSTAI  EQU   ATECBFLG                                                 06681000
ATECBADB EQU   ATECBADR+1                                               06682000
ATGSFLDA EQU   ATTCHLST+12                                              06683000
ATGSFLAG EQU   ATGSFLDA                                                 06684000
ATGSFLDB EQU   ATGSFLDA+1                                               06685000
ATSHFLDA EQU   ATTCHLST+16                                              06686000
ATSHFLAG EQU   ATSHFLDA                                                 06687000
ATSHFLDB EQU   ATSHFLDA+1                                               06688000
ATETXRA  EQU   ATTCHLST+20                                              06689000
ATROLL   EQU   ATETXRA                                                  06690000
ATINDS2  EQU   ATROLL                                                   06691000
ATEXTN   EQU   ATINDS2                                                  06692000
ATETXRB  EQU   ATETXRA+1                                                06693000
ATDPMOD  EQU   ATTCHLST+24                                              06694000
ATLPMOD  EQU   ATTCHLST+26                                              06695000
ATINDS   EQU   ATTCHLST+27                                              06696000
ATDISP   EQU   ATINDS                                                   06697000
ATJSCB   EQU   ATINDS                                                   06698000
ATKEY    EQU   ATINDS                                                   06699000
ATSZERO  EQU   ATINDS                                                   06700000
ATSVAREA EQU   ATINDS                                                   06701000
ATJSTCB  EQU   ATINDS                                                   06702000
ATMODE   EQU   ATINDS                                                   06703000
ATPRGNM  EQU   ATTCHLST+28                                              06704000
ATJSCBAD EQU   ATTCHLST+36                                              06705000
ATJSCBA  EQU   ATJSCBAD+1                                               06706000
ATSTAIAD EQU   ATTCHLST+40                                              06707000
ATTID    EQU   ATSTAIAD                                                 06708000
ATSTAIA  EQU   ATSTAIAD+1                                               06709000
ATSTAIEX EQU   ATTCHLST+44                                              06710000
ATSTAIF  EQU   ATSTAIEX                                                 06711000
ATTERM   EQU   ATSTAIF                                                  06712000
ATESTAI  EQU   ATSTAIF                                                  06713000
ATSYNCH  EQU   ATSTAIF                                                  06714000
ATSTAIXT EQU   ATSTAIEX+1                                               06715000
ATTASKLB EQU   ATTCHLST+48                                              06716000
ATFLAGS1 EQU   ATTCHLST+52                                              06717000
ATNSHRSP EQU   ATFLAGS1                                                 06718000
ATRSAPF  EQU   ATFLAGS1                                                 06719000
ATTPLNG  EQU   ATTCHLST+54                                              06720000
ATTNSHLV EQU   ATTCHLST+56                                              06721000
IGC044R2 EQU   0                                                        06722000
WKAREA   EQU   0                                                        06723000
WKTEMPS  EQU   WKAREA+60                                                06724000
WKTEMP1  EQU   WKTEMPS                                                  06725000
WKSAVEA  EQU   WKAREA+92                                                06726000
WKSAVEB  EQU   WKAREA+96                                                06727000
WKSAVEC  EQU   WKAREA+100                                               06728000
WKSAVED  EQU   WKAREA+104                                               06729000
WKSAVEE  EQU   WKAREA+108                                               06730000
WKSPQE1  EQU   WKAREA+112                                               06731000
WKTHWORD EQU   WKAREA+118                                               06732000
WKFLAGS1 EQU   WKTHWORD                                                 06733000
WKSWASWS EQU   WKFLAGS1                                                 06734000
WK236SW  EQU   WKSWASWS                                                 06735000
WK237SW  EQU   WKSWASWS                                                 06736000
WKRTSAVE EQU   WKAREA+120                                               06737000
WKRTSAV2 EQU   WKAREA+124                                               06738000
WKEXSAVE EQU   0                                                        06739000
WKNEWXSA EQU   WKEXSAVE                                                 06740000
WKEPNAME EQU   WKNEWXSA                                                 06741000
WKSYSBYT EQU   WKNEWXSA+8                                               06742000
WKSYSTSK EQU   WKSYSBYT                                                 06743000
WKRSAPF  EQU   WKSYSBYT                                                 06744000
WKFLAGS2 EQU   WKEXSAVE+9                                               06745000
WKSVAREA EQU   WKFLAGS2                                                 06746000
WKFRRSW  EQU   WKFLAGS2                                                 06747000
WKECBSW  EQU   WKFLAGS2                                                 06748000
WKESTAI  EQU   WKFLAGS2                                                 06749000
WKNOAREA EQU   WKFLAGS2                                                 06750000
WKONQUE  EQU   WKFLAGS2                                                 06751000
WKGRS10  EQU   WKEXSAVE+12                                              06752000
WKGRS11  EQU   WKEXSAVE+16                                              06753000
WKRECR14 EQU   WKGRS11                                                  06754000
WKFRRAD  EQU   WKEXSAVE+20                                              06755000
WKCONTRL EQU   WKEXSAVE+24                                              06756000
WKFCODE  EQU   WKCONTRL                                                 06757000
WKREASON EQU   WKCONTRL+1                                               06758000
WKPKEY   EQU   WKCONTRL+2                                               06759000
WKCURTCB EQU   WKCONTRL+4                                               06760000
WKESTAEL EQU   WKCONTRL+8                                               06761000
WK255PTR EQU   WKESTAEL                                                 06762000
WK255LNG EQU   WKESTAEL+4                                               06763000
WKTCBMSS EQU   WKESTAEL+8                                               06764000
WKNEWTCB EQU   WKESTAEL+12                                              06765000
AREA     EQU   0                                                        06766000
BYTETEST EQU   0                                                        06767000
FLAGBIT7 EQU   BYTETEST                                                 06768000
ZWORD    EQU   0                                                        06769000
BYTE0    EQU   ZWORD                                                    06770000
BYTES123 EQU   ZWORD+1                                                  06771000
BYTE3    EQU   BYTES123+2                                               06772000
ZBYTE    EQU   0                                                        06773000
ATFRRWA  EQU   0                                                        06774000
ATFRRW1  EQU   ATFRRWA                                                  06775000
SUBRTINE EQU   0                                                        06776000
CIRBAREA EQU   0                                                        06777000
I256C    EQU   0                                                        06778000
IEAQCS01 EQU   0                                                        06779000
IQEEND   EQU   0                                                        06780000
I001C    EQU   0                                                        06781000
I008P    EQU   0                                                        06782000
I015F    EQU   0                                                        06783000
I015P    EQU   0                                                        06784000
I031F    EQU   0                                                        06785000
I031P    EQU   0                                                        06786000
CVTS01   EQU   CVTPGSIA                                                 06787000
CVTLPDIA EQU   CVTS01+12                                                06788000
CVTDIRST EQU   CVTLPDIA                                                 06789000
CVTSLIDA EQU   CVTS01+24                                                06790000
CVTCTLFG EQU   CVTS01+50                                                06791000
CVTCRMN  EQU   CVTS01+156                                               06792000
CVTSCBP  EQU   CVTS01+236                                               06793000
CVTEXPRO EQU   CVTS01+260                                               06794000
CVTQCS01 EQU   CVTS01+288                                               06795000
CVT044R2 EQU   CVTS01+376                                               06796000
CVTRV210 EQU   CVTS01+424                                               06797000
CVTRV219 EQU   CVTS01+425                                               06798000
CVTRV228 EQU   CVTS01+426                                               06799000
CVTRV237 EQU   CVTS01+427                                               06800000
CVTMFRTR EQU   CVTS01+452                                               06801000
CVTRV262 EQU   CVTS01+468                                               06802000
CVTRV271 EQU   CVTS01+469                                               06803000
CVTRV280 EQU   CVTS01+470                                               06804000
CVTRV289 EQU   CVTS01+471                                               06805000
CVTGSDA  EQU   CVTS01+600                                               06806000
CVTCBBR  EQU   CVTS01+624                                               06807000
PSARSVTE EQU   PSARSVT                                                  06808000
PSACSTK  EQU   PSARSVTE                                                 06809000
RBSECS03 EQU   RBEP                                                     06810000
RBCDE    EQU   RBSECS03                                                 06811000
RBCDFLGS EQU   RBCDE                                                    06812000
RBNOCELL EQU   RBCDFLGS                                                 06813000
RBSECS05 EQU   RBPGMQ                                                   06814000
RBSQE    EQU   RBSECS05                                                 06815000
RBSECS06 EQU   RBPGMQ                                                   06816000
RBIQE    EQU   RBSECS06                                                 06817000
RBUSE    EQU   RBIQE                                                    06818000
RBSECS07 EQU   RBPGMQ                                                   06819000
RBIQE2   EQU   RBSECS07                                                 06820000
RBSECS08 EQU   IRBEND                                                   06821000
RBSECS09 EQU   IRBEND                                                   06822000
SCBPTR   EQU   TCBSTAB                                                  06823000
PSW      EQU   RBOPSW                                                   06824000
KEYCMWP  EQU   PSW+1                                                    06825000
ECBTEST  EQU   ATECBADR                                                 06826000
FLC      EQU   PSA                                                      06827000
*                                      START UNREFERENCED COMPONENTS    06828000
@NM00166 EQU   PSW+4                                                    06829000
@NM00165 EQU   PSW+2                                                    06830000
CMWP     EQU   KEYCMWP                                                  06831000
PKEY     EQU   KEYCMWP                                                  06832000
SYSMASK  EQU   PSW                                                      06833000
RBRSV161 EQU   RBSECS09+64                                              06834000
RBSIRBWA EQU   RBSECS09                                                 06835000
RBIQEWRK EQU   RBSECS08+4                                               06836000
RBNEXAV  EQU   RBSECS08                                                 06837000
RBIQEA   EQU   RBIQE2                                                   06838000
RBIQE1   EQU   RBIQE+1                                                  06839000
RBSQEA   EQU   RBSQE+1                                                  06840000
@NM00150 EQU   RBSQE                                                    06841000
RBCDE1   EQU   RBCDE+1                                                  06842000
RBCDLOAD EQU   RBCDFLGS                                                 06843000
RBCDXCTL EQU   RBCDFLGS                                                 06844000
RBCDSYNC EQU   RBCDFLGS                                                 06845000
RBCDNODE EQU   RBCDFLGS                                                 06846000
RBCDSAVE EQU   RBCDFLGS                                                 06847000
RBCDATCH EQU   RBCDFLGS                                                 06848000
RBRSV009 EQU   RBCDFLGS                                                 06849000
PSARSAV  EQU   PSARSVTE+60                                              06850000
PSARSTK  EQU   PSARSVTE+56                                              06851000
PSAESAV3 EQU   PSARSVTE+52                                              06852000
PSAESTK3 EQU   PSARSVTE+48                                              06853000
PSAESAV2 EQU   PSARSVTE+44                                              06854000
PSAESTK2 EQU   PSARSVTE+40                                              06855000
PSAESAV1 EQU   PSARSVTE+36                                              06856000
PSAESTK1 EQU   PSARSVTE+32                                              06857000
PSAPSAV  EQU   PSARSVTE+28                                              06858000
PSAPSTK  EQU   PSARSVTE+24                                              06859000
PSAMSAV  EQU   PSARSVTE+20                                              06860000
PSAMSTK  EQU   PSARSVTE+16                                              06861000
PSASSAV  EQU   PSARSVTE+12                                              06862000
PSASSTK  EQU   PSARSVTE+8                                               06863000
PSANSTK  EQU   PSARSVTE+4                                               06864000
CVTRV628 EQU   CVTS01+728                                               06865000
CVTRV627 EQU   CVTS01+724                                               06866000
CVTRV626 EQU   CVTS01+720                                               06867000
CVTRV625 EQU   CVTS01+716                                               06868000
CVTRV624 EQU   CVTS01+712                                               06869000
CVTRV623 EQU   CVTS01+708                                               06870000
CVTRV622 EQU   CVTS01+704                                               06871000
CVTRV621 EQU   CVTS01+700                                               06872000
CVTIHASU EQU   CVTS01+696                                               06873000
CVTSUSP  EQU   CVTS01+692                                               06874000
CVTT6SVC EQU   CVTS01+688                                               06875000
CVTCDAL  EQU   CVTS01+684                                               06876000
CVTTCTL  EQU   CVTS01+680                                               06877000
CVTRSUME EQU   CVTS01+676                                               06878000
CVTJTERM EQU   CVTS01+672                                               06879000
CVTASMRM EQU   CVTS01+668                                               06880000
CVTTCASP EQU   CVTS01+664                                               06881000
CVT0PT03 EQU   CVTS01+660                                               06882000
CVT0PT0E EQU   CVTS01+656                                               06883000
CVTRV609 EQU   CVTS01+652                                               06884000
CVTCGK   EQU   CVTS01+648                                               06885000
CVTRAC   EQU   CVTS01+644                                               06886000
CVTHSM   EQU   CVTS01+640                                               06887000
CVTRV605 EQU   CVTS01+636                                               06888000
CVTRV604 EQU   CVTS01+632                                               06889000
CVTEFF02 EQU   CVTS01+628                                               06890000
CVTSSCR  EQU   CVTS01+620                                               06891000
CVTEVENT EQU   CVTS01+616                                               06892000
CVTCRCA  EQU   CVTS01+612                                               06893000
CVTTPIO  EQU   CVTS01+608                                               06894000
CVTADV   EQU   CVTS01+604                                               06895000
CVTGSDAB EQU   CVTGSDA                                                  06896000
CVTQV3   EQU   CVTS01+596                                               06897000
CVTQV2   EQU   CVTS01+592                                               06898000
CVTQV1   EQU   CVTS01+588                                               06899000
CVTRPT   EQU   CVTS01+584                                               06900000
CVTSSRB  EQU   CVTS01+580                                               06901000
CVTCSDRL EQU   CVTS01+576                                               06902000
CVTEXP1  EQU   CVTS01+572                                               06903000
CVTRMPMT EQU   CVTS01+568                                               06904000
CVTRMPTT EQU   CVTS01+564                                               06905000
CVTVPSA  EQU   CVTS01+560                                               06906000
CVTVSTOP EQU   CVTS01+556                                               06907000
CVTGTFR8 EQU   CVTS01+552                                               06908000
CVTQUIT  EQU   CVTS01+548                                               06909000
CVTVACR  EQU   CVTS01+544                                               06910000
CVTWTCB  EQU   CVTS01+540                                               06911000
CVTSTPRS EQU   CVTS01+536                                               06912000
CVT0PT02 EQU   CVTS01+532                                               06913000
CVTDARCM EQU   CVTS01+528                                               06914000
CVTIRECM EQU   CVTS01+524                                               06915000
CVTJRECM EQU   CVTS01+520                                               06916000
CVTVEMS0 EQU   CVTS01+516                                               06917000
CVTSPFRR EQU   CVTS01+512                                               06918000
CVTRLSTG EQU   CVTS01+508                                               06919000
CVT0TC0A EQU   CVTS01+504                                               06920000
CVTGMBR  EQU   CVTS01+500                                               06921000
CVTLFRM  EQU   CVTS01+496                                               06922000
CVTRMBR  EQU   CVTS01+492                                               06923000
CVTVIOP  EQU   CVTS01+488                                               06924000
CVTRV307 EQU   CVTS01+486                                               06925000
CVTRV306 EQU   CVTS01+484                                               06926000
CVTRV305 EQU   CVTS01+482                                               06927000
CVTRV304 EQU   CVTS01+480                                               06928000
CVTRV303 EQU   CVTS01+478                                               06929000
CVTRV302 EQU   CVTS01+476                                               06930000
CVTTRCA  EQU   CVTS01+472                                               06931000
CVTRV297 EQU   CVTRV289                                                 06932000
CVTRV296 EQU   CVTRV289                                                 06933000
CVTRV295 EQU   CVTRV289                                                 06934000
CVTRV294 EQU   CVTRV289                                                 06935000
CVTRV293 EQU   CVTRV289                                                 06936000
CVTRV292 EQU   CVTRV289                                                 06937000
CVTRV291 EQU   CVTRV289                                                 06938000
CVTRV290 EQU   CVTRV289                                                 06939000
CVTRV288 EQU   CVTRV280                                                 06940000
CVTRV287 EQU   CVTRV280                                                 06941000
CVTRV286 EQU   CVTRV280                                                 06942000
CVTRV285 EQU   CVTRV280                                                 06943000
CVTRV284 EQU   CVTRV280                                                 06944000
CVTRV283 EQU   CVTRV280                                                 06945000
CVTRV282 EQU   CVTRV280                                                 06946000
CVTRV281 EQU   CVTRV280                                                 06947000
CVTRV279 EQU   CVTRV271                                                 06948000
CVTRV278 EQU   CVTRV271                                                 06949000
CVTRV277 EQU   CVTRV271                                                 06950000
CVTRV276 EQU   CVTRV271                                                 06951000
CVTRV275 EQU   CVTRV271                                                 06952000
CVTRV274 EQU   CVTRV271                                                 06953000
CVTRV273 EQU   CVTRV271                                                 06954000
CVTRV272 EQU   CVTRV271                                                 06955000
CVTRV270 EQU   CVTRV262                                                 06956000
CVTRV269 EQU   CVTRV262                                                 06957000
CVTRV268 EQU   CVTRV262                                                 06958000
CVTRV267 EQU   CVTRV262                                                 06959000
CVTRV266 EQU   CVTRV262                                                 06960000
CVTRV265 EQU   CVTRV262                                                 06961000
CVTRV264 EQU   CVTRV262                                                 06962000
CVTRV263 EQU   CVTRV262                                                 06963000
CVTVFP   EQU   CVTS01+464                                               06964000
CVTVSI   EQU   CVTS01+460                                               06965000
CVTVPSIB EQU   CVTS01+456                                               06966000
CVTMFACT EQU   CVTMFRTR                                                 06967000
CVTMFCTL EQU   CVTS01+448                                               06968000
CVTPVBP  EQU   CVTS01+444                                               06969000
CVTPWI   EQU   CVTS01+440                                               06970000
CVTRV254 EQU   CVTS01+438                                               06971000
CVTRV253 EQU   CVTS01+436                                               06972000
CVTRV252 EQU   CVTS01+434                                               06973000
CVTRV251 EQU   CVTS01+433                                               06974000
CVTRV250 EQU   CVTS01+432                                               06975000
CVTRV249 EQU   CVTS01+431                                               06976000
CVTRV248 EQU   CVTS01+430                                               06977000
CVTRV247 EQU   CVTS01+429                                               06978000
CVTRV246 EQU   CVTS01+428                                               06979000
CVTRV245 EQU   CVTRV237                                                 06980000
CVTRV244 EQU   CVTRV237                                                 06981000
CVTRV243 EQU   CVTRV237                                                 06982000
CVTRV242 EQU   CVTRV237                                                 06983000
CVTRV241 EQU   CVTRV237                                                 06984000
CVTRV240 EQU   CVTRV237                                                 06985000
CVTRV239 EQU   CVTRV237                                                 06986000
CVTRV238 EQU   CVTRV237                                                 06987000
CVTRV236 EQU   CVTRV228                                                 06988000
CVTRV235 EQU   CVTRV228                                                 06989000
CVTRV234 EQU   CVTRV228                                                 06990000
CVTRV233 EQU   CVTRV228                                                 06991000
CVTRV232 EQU   CVTRV228                                                 06992000
CVTRV231 EQU   CVTRV228                                                 06993000
CVTRV230 EQU   CVTRV228                                                 06994000
CVTRV229 EQU   CVTRV228                                                 06995000
CVTRV227 EQU   CVTRV219                                                 06996000
CVTRV226 EQU   CVTRV219                                                 06997000
CVTRV225 EQU   CVTRV219                                                 06998000
CVTRV224 EQU   CVTRV219                                                 06999000
CVTRV223 EQU   CVTRV219                                                 07000000
CVTRV222 EQU   CVTRV219                                                 07001000
CVTRV221 EQU   CVTRV219                                                 07002000
CVTRV220 EQU   CVTRV219                                                 07003000
CVTRV218 EQU   CVTRV210                                                 07004000
CVTRV217 EQU   CVTRV210                                                 07005000
CVTRV216 EQU   CVTRV210                                                 07006000
CVTRV215 EQU   CVTRV210                                                 07007000
CVTRV214 EQU   CVTRV210                                                 07008000
CVTRV213 EQU   CVTRV210                                                 07009000
CVTRV212 EQU   CVTRV210                                                 07010000
CVTRV211 EQU   CVTRV210                                                 07011000
CVTLCCAT EQU   CVTS01+420                                               07012000
CVTPCCAT EQU   CVTS01+416                                               07013000
CVTIPCRP EQU   CVTS01+412                                               07014000
CVTIPCRI EQU   CVTS01+408                                               07015000
CVTIPCDS EQU   CVTS01+404                                               07016000
CVTAIDVT EQU   CVTS01+400                                               07017000
CVTSSAP  EQU   CVTS01+396                                               07018000
CVTEHCIR EQU   CVTS01+392                                               07019000
CVTEHDEF EQU   CVTS01+388                                               07020000
CVTDAIR  EQU   CVTS01+384                                               07021000
CVTPERFM EQU   CVTS01+380                                               07022000
CVTFETCH EQU   CVTS01+372                                               07023000
CVTRSTWD EQU   CVTS01+368                                               07024000
CVTSPOST EQU   CVTS01+364                                               07025000
CVTIOBP  EQU   CVTS01+360                                               07026000
CVTASMVT EQU   CVTS01+356                                               07027000
CVTRECRQ EQU   CVTS01+352                                               07028000
CVTWSAC  EQU   CVTS01+348                                               07029000
CVTRV149 EQU   CVTS01+344                                               07030000
CVTWSAL  EQU   CVTS01+340                                               07031000
CVTSPSA  EQU   CVTS01+336                                               07032000
CVTGLMN  EQU   CVTS01+332                                               07033000
CVTVEAC0 EQU   CVTS01+328                                               07034000
CVT062R1 EQU   CVTS01+324                                               07035000
CVTRPOST EQU   CVTS01+320                                               07036000
CVTDQIQE EQU   CVTS01+316                                               07037000
CVTCSD   EQU   CVTS01+312                                               07038000
CVTLKRMA EQU   CVTS01+308                                               07039000
CVTRSPIE EQU   CVTS01+304                                               07040000
CVTRENQ  EQU   CVTS01+300                                               07041000
CVTLQCB  EQU   CVTS01+296                                               07042000
CVTFQCB  EQU   CVTS01+292                                               07043000
CVTAPFT  EQU   CVTS01+284                                               07044000
CVTPARRL EQU   CVTS01+280                                               07045000
CVTVWAIT EQU   CVTS01+276                                               07046000
CVTGSPL  EQU   CVTS01+272                                               07047000
CVTLSMQ  EQU   CVTS01+268                                               07048000
CVTGSMQ  EQU   CVTS01+264                                               07049000
CVTOPCTP EQU   CVTS01+256                                               07050000
CVTSIC   EQU   CVTS01+252                                               07051000
CVTTPIOS EQU   CVTS01+248                                               07052000
CVTRTMS  EQU   CVTS01+244                                               07053000
CVTSDBF  EQU   CVTS01+240                                               07054000
CVTSDMP  EQU   CVTS01+232                                               07055000
CVTSV60  EQU   CVTS01+228                                               07056000
CVTRTMCT EQU   CVTS01+224                                               07057000
CVTASCBL EQU   CVTS01+220                                               07058000
CVTASCBH EQU   CVTS01+216                                               07059000
CVTGDA   EQU   CVTS01+212                                               07060000
CVTASVT  EQU   CVTS01+208                                               07061000
CVTVVMDI EQU   CVTS01+204                                               07062000
CVTAQTOP EQU   CVTS01+200                                               07063000
CVTIOSCS EQU   CVTS01+196                                               07064000
CVTSDRM  EQU   CVTS01+192                                               07065000
CVTOPTE  EQU   CVTS01+188                                               07066000
CVTSTXU  EQU   CVTS01+184                                               07067000
CVTQUIS  EQU   CVTS01+180                                               07068000
CVTPARS  EQU   CVTS01+176                                               07069000
CVTS1EE  EQU   CVTS01+172                                               07070000
CVTFRAS  EQU   CVTS01+168                                               07071000
CVTQSAS  EQU   CVTS01+164                                               07072000
CVTCRAS  EQU   CVTS01+160                                               07073000
CVTDELCP EQU   CVTS01+152                                               07074000
CVTFRECL EQU   CVTS01+148                                               07075000
CVTGETCL EQU   CVTS01+144                                               07076000
CVTBLDCP EQU   CVTS01+140                                               07077000
CVTAUTHL EQU   CVTS01+136                                               07078000
CVTSCAN  EQU   CVTS01+132                                               07079000
CVTRV144 EQU   CVTS01+130                                               07080000
CVTMAXMP EQU   CVTS01+128                                               07081000
CVTSTCK  EQU   CVTS01+124                                               07082000
CVTRV139 EQU   CVTS01+123                                               07083000
CVTDSSAC EQU   CVTS01+122                                               07084000
CVTRV513 EQU   CVTS01+121                                               07085000
CVTIOSPL EQU   CVTS01+120                                               07086000
CVTPTGT  EQU   CVTS01+116                                               07087000
CVTCSPIE EQU   CVTS01+112                                               07088000
CVTSMFEX EQU   CVTS01+108                                               07089000
CVTOLT0A EQU   CVTS01+104                                               07090000
CVTSRBRT EQU   CVTS01+100                                               07091000
CVTPUTL  EQU   CVTS01+96                                                07092000
CVTASCRL EQU   CVTS01+92                                                07093000
CVTASCRF EQU   CVTS01+88                                                07094000
CVTRV326 EQU   CVTS01+84                                                07095000
CVTRV325 EQU   CVTS01+80                                                07096000
CVTRV324 EQU   CVTS01+76                                                07097000
CVT0VL01 EQU   CVTS01+72                                                07098000
CVTSHRVM EQU   CVTS01+68                                                07099000
CVTRV332 EQU   CVTS01+64                                                07100000
CVTTAS   EQU   CVTS01+60                                                07101000
CVTRSCN  EQU   CVTS01+56                                                07102000
CVTTRAC2 EQU   CVTS01+54                                                07103000
CVTTRACE EQU   CVTS01+52                                                07104000
CVTAPG   EQU   CVTS01+51                                                07105000
CVTSDTRC EQU   CVTCTLFG                                                 07106000
CVTGTRCE EQU   CVTCTLFG                                                 07107000
CVTNOMP  EQU   CVTCTLFG                                                 07108000
CVTRSV79 EQU   CVTCTLFG                                                 07109000
CVTDSTAT EQU   CVTCTLFG                                                 07110000
CVTRSV78 EQU   CVTCTLFG                                                 07111000
CVTRV333 EQU   CVTCTLFG                                                 07112000
CVTRV323 EQU   CVTCTLFG                                                 07113000
CVTSPVLK EQU   CVTS01+49                                                07114000
CVTRSV77 EQU   CVTS01+48                                                07115000
CVTRV331 EQU   CVTS01+44                                                07116000
CVTRV330 EQU   CVTS01+40                                                07117000
CVTRV329 EQU   CVTS01+36                                                07118000
CVTRV328 EQU   CVTS01+32                                                07119000
CVTRV322 EQU   CVTS01+28                                                07120000
CVTSLID  EQU   CVTSLIDA+1                                               07121000
CVTSYLK  EQU   CVTSLIDA                                                 07122000
CVTRV321 EQU   CVTS01+20                                                07123000
CVTRV320 EQU   CVTS01+16                                                07124000
CVTLPDIR EQU   CVTLPDIA+1                                               07125000
CVTRSV69 EQU   CVTDIRST                                                 07126000
CVTRSV68 EQU   CVTDIRST                                                 07127000
CVTRSV67 EQU   CVTDIRST                                                 07128000
CVTRSV66 EQU   CVTDIRST                                                 07129000
CVTRSV65 EQU   CVTDIRST                                                 07130000
CVTRSV64 EQU   CVTDIRST                                                 07131000
CVTRSV63 EQU   CVTDIRST                                                 07132000
CVTDICOM EQU   CVTDIRST                                                 07133000
CVTPVTP  EQU   CVTS01+8                                                 07134000
CVTLPDSR EQU   CVTS01+4                                                 07135000
CVTGETL  EQU   CVTS01                                                   07136000
@NM00171 EQU   CIRBAREA+384                                             07137000
@NM00170 EQU   CIRBAREA+352                                             07138000
@NM00169 EQU   CIRBAREA+56                                              07139000
@NM00168 EQU   CIRBAREA+24                                              07140000
@NM00167 EQU   CIRBAREA                                                 07141000
ATFRRW6  EQU   ATFRRWA+20                                               07142000
ATFRRW5  EQU   ATFRRWA+16                                               07143000
ATFRRW4  EQU   ATFRRWA+12                                               07144000
ATFRRW3  EQU   ATFRRWA+8                                                07145000
ATFRRW2  EQU   ATFRRWA+4                                                07146000
BYTE2    EQU   BYTES123+1                                               07147000
BYTE1    EQU   BYTES123                                                 07148000
FLAGBIT6 EQU   BYTETEST                                                 07149000
FLAGBIT5 EQU   BYTETEST                                                 07150000
FLAGBIT4 EQU   BYTETEST                                                 07151000
FLAGBIT3 EQU   BYTETEST                                                 07152000
FLAGBIT2 EQU   BYTETEST                                                 07153000
FLAGBIT1 EQU   BYTETEST                                                 07154000
FLAGBIT0 EQU   BYTETEST                                                 07155000
@NM00164 EQU   WKESTAEL+6                                               07156000
WKTBYTE  EQU   WKCONTRL+3                                               07157000
@NM00163 EQU   WKEXSAVE+10                                              07158000
@NM00162 EQU   WKFLAGS2                                                 07159000
@NM00161 EQU   WKSYSBYT                                                 07160000
@NM00160 EQU   WKAREA+128                                               07161000
@NM00159 EQU   WKAREA+116                                               07162000
WKTEMP8  EQU   WKTEMPS+28                                               07163000
WKTEMP7  EQU   WKTEMPS+24                                               07164000
WKTEMP6  EQU   WKTEMPS+20                                               07165000
WKTEMP5  EQU   WKTEMPS+16                                               07166000
WKTEMP4  EQU   WKTEMPS+12                                               07167000
WKTEMP3  EQU   WKTEMPS+8                                                07168000
WKTEMP2  EQU   WKTEMPS+4                                                07169000
@NM00158 EQU   WKAREA                                                   07170000
ATRSV038 EQU   ATTCHLST+53                                              07171000
ATRSV037 EQU   ATFLAGS1                                                 07172000
ATRSV036 EQU   ATFLAGS1                                                 07173000
ATRSV035 EQU   ATFLAGS1                                                 07174000
ATRSV034 EQU   ATFLAGS1                                                 07175000
ATRSV033 EQU   ATFLAGS1                                                 07176000
ATRSV032 EQU   ATFLAGS1                                                 07177000
ATPURGE  EQU   ATSTAIF                                                  07178000
ATRSV031 EQU   ATSTAIF                                                  07179000
ATRSV030 EQU   ATSTAIF                                                  07180000
ATRSV029 EQU   ATSTAIF                                                  07181000
ATLSQA   EQU   ATJSCBAD                                                 07182000
ATJPQ    EQU   ATINDS                                                   07183000
ATRLLOUT EQU   ATINDS2                                                  07184000
ATRLABLE EQU   ATINDS2                                                  07185000
ATRSV028 EQU   ATINDS2                                                  07186000
ATRSV027 EQU   ATINDS2                                                  07187000
ATRSV026 EQU   ATINDS2                                                  07188000
ATNFPRSA EQU   ATINDS2                                                  07189000
ATNTQE   EQU   ATINDS2                                                  07190000
ATSHARSP EQU   ATSHFLAG                                                 07191000
ATRSV025 EQU   ATSHFLAG                                                 07192000
ATRSV024 EQU   ATSHFLAG                                                 07193000
ATRSV023 EQU   ATSHFLAG                                                 07194000
ATRSV022 EQU   ATSHFLAG                                                 07195000
ATRSV021 EQU   ATSHFLAG                                                 07196000
ATRSV020 EQU   ATSHFLAG                                                 07197000
ATRSV019 EQU   ATSHFLAG                                                 07198000
ATGIVESP EQU   ATGSFLAG                                                 07199000
ATRSV018 EQU   ATGSFLAG                                                 07200000
ATRSV017 EQU   ATGSFLAG                                                 07201000
ATRSV016 EQU   ATGSFLAG                                                 07202000
ATRSV015 EQU   ATGSFLAG                                                 07203000
ATRSV014 EQU   ATGSFLAG                                                 07204000
ATRSV013 EQU   ATGSFLAG                                                 07205000
ATRSV012 EQU   ATGSFLAG                                                 07206000
ATLOGON  EQU   ATECBFLG                                                 07207000
ATRSV011 EQU   ATECBFLG                                                 07208000
ATRSV010 EQU   ATECBFLG                                                 07209000
ATRSV009 EQU   ATECBFLG                                                 07210000
ATRSV008 EQU   ATECBFLG                                                 07211000
ATHARCHY EQU   ATDCBADA                                                 07212000
ATRSV007 EQU   ATDEFLAG                                                 07213000
ATRSV006 EQU   ATDEFLAG                                                 07214000
ATRSV005 EQU   ATDEFLAG                                                 07215000
ATRSV004 EQU   ATDEFLAG                                                 07216000
ATRSV003 EQU   ATDEFLAG                                                 07217000
ATRSV002 EQU   ATDEFLAG                                                 07218000
ATRSV001 EQU   ATDEFLAG                                                 07219000
SCBRSVRE EQU   SCBDATA+3                                                07220000
SCBID    EQU   SCBDATA+2                                                07221000
SCBPKEY  EQU   SCBDATA+1                                                07222000
@NM00157 EQU   SCBFLGS3                                                 07223000
SCBTERMO EQU   SCBFLGS3                                                 07224000
SCBBRNTR EQU   SCBFLGS3                                                 07225000
SCBPRNTR EQU   SCBFLGS3                                                 07226000
SCBCNCEL EQU   SCBFLGS3                                                 07227000
SCBRECRD EQU   SCBFLGS3                                                 07228000
SCBTERMI EQU   SCBFLGS3                                                 07229000
@NM00156 EQU   SCBFLGS3                                                 07230000
SCBOWNRA EQU   SCBOWNR+1                                                07231000
SCBSUPER EQU   SCBFLGS2                                                 07232000
SCBKEY0  EQU   SCBFLGS2                                                 07233000
@NM00155 EQU   SCBFLGS2                                                 07234000
@NM00154 EQU   SCBFLGS2                                                 07235000
SCBINUSE EQU   SCBFLGS2                                                 07236000
@NM00153 EQU   SCBFLGS2                                                 07237000
SCBXCTL2 EQU   SCBFLGS2                                                 07238000
@NM00152 EQU   SCBFLGS2                                                 07239000
SCBPARMA EQU   SCBPARM+1                                                07240000
SCBHALT  EQU   SCBIOPRC                                                 07241000
SCBNOIOP EQU   SCBIOPRC                                                 07242000
SCBASYNC EQU   SCBFLGS1                                                 07243000
@NM00151 EQU   SCBFLGS1                                                 07244000
SCBESTAE EQU   SCBFLGS1                                                 07245000
SCBDUMMY EQU   SCBFLGS1                                                 07246000
SCBSTAR  EQU   SCBFLGS1                                                 07247000
SCBSTAI  EQU   SCBFLGS1                                                 07248000
SCBEXIT  EQU   SCB+4                                                    07249000
SCBCHAIN EQU   SCB                                                      07250000
SVRBEND  EQU   RBSECT+192                                               07251000
RBFEPARM EQU   RBSECT+168                                               07252000
SIRBEND  EQU   RBSECT+168                                               07253000
RBRSV158 EQU   RBRSV150                                                 07254000
RBRSV157 EQU   RBRSV150                                                 07255000
RBRSV156 EQU   RBRSV150                                                 07256000
RBRSV155 EQU   RBRSV150                                                 07257000
RBRSV154 EQU   RBRSV150                                                 07258000
RBRSV153 EQU   RBRSV150                                                 07259000
RBRSV152 EQU   RBRSV150                                                 07260000
RBRSV151 EQU   RBRSV150                                                 07261000
RBRSV149 EQU   RBSECT+166                                               07262000
RBRSV148 EQU   RBSECT+164                                               07263000
RBRSV169 EQU   RBSDATA+3                                                07264000
RBSID    EQU   RBSDATA+2                                                07265000
RBSPKEY  EQU   RBSDATA+1                                                07266000
RBRSV168 EQU   RBSFLG3                                                  07267000
RBSTERMO EQU   RBSFLG3                                                  07268000
RBSBRNTR EQU   RBSFLG3                                                  07269000
RBSPRNTR EQU   RBSFLG3                                                  07270000
RBSCNCEL EQU   RBSFLG3                                                  07271000
RBSRECRD EQU   RBSFLG3                                                  07272000
RBSTERMI EQU   RBSFLG3                                                  07273000
RBRSV167 EQU   RBSFLG3                                                  07274000
RBSOWNRA EQU   RBSOWNR+1                                                07275000
RBSSUPER EQU   RBSFLGS2                                                 07276000
RBSKEY0  EQU   RBSFLGS2                                                 07277000
RBRSV166 EQU   RBSFLGS2                                                 07278000
RBRSV165 EQU   RBSFLGS2                                                 07279000
RBSINUSE EQU   RBSFLGS2                                                 07280000
RBRSV164 EQU   RBSFLGS2                                                 07281000
RBSXCTL2 EQU   RBSFLGS2                                                 07282000
RBRSV163 EQU   RBSFLGS2                                                 07283000
RBSPARMA EQU   RBSPARM+1                                                07284000
RBSHALT  EQU   RBSIOPRC                                                 07285000
RBSNOIOP EQU   RBSIOPRC                                                 07286000
RBSASYNC EQU   RBSFLGS1                                                 07287000
RBRSV162 EQU   RBSFLGS1                                                 07288000
RBSESTAE EQU   RBSFLGS1                                                 07289000
RBSDUMMY EQU   RBSFLGS1                                                 07290000
RBSSTAR  EQU   RBSFLGS1                                                 07291000
RBSSTAI  EQU   RBSFLGS1                                                 07292000
RBSEXIT  EQU   RBSCBB+4                                                 07293000
RBSCHAIN EQU   RBSCBB                                                   07294000
TIRBEND  EQU   @NM00149+8                                               07295000
PRBEND   EQU   @NM00149+8                                               07296000
RBRSV146 EQU   RBRSV138                                                 07297000
RBRSV145 EQU   RBRSV138                                                 07298000
RBRSV144 EQU   RBRSV138                                                 07299000
RBRSV143 EQU   RBRSV138                                                 07300000
RBRSV142 EQU   RBRSV138                                                 07301000
RBRSV141 EQU   RBRSV138                                                 07302000
RBRSV140 EQU   RBRSV138                                                 07303000
RBRSV139 EQU   RBRSV138                                                 07304000
RBRSV137 EQU   @NM00149+6                                               07305000
RBRSV136 EQU   @NM00149+4                                               07306000
RBRSV135 EQU   @NM00149                                                 07307000
@NM00148 EQU   RBSECT+32                                                07308000
@NM00147 EQU   @NM00145+1                                               07309000
RBSCF    EQU   @NM00146                                                 07310000
RBPGMQ1  EQU   RBPGMQ+1                                                 07311000
@NM00144 EQU   RBPGMQ                                                   07312000
@NM00143 EQU   RBSECT+16                                                07313000
@NM00142 EQU   @NM00138                                                 07314000
@NM00141 EQU   @NM00138                                                 07315000
RBUSIQE  EQU   RBETXR                                                   07316000
@NM00140 EQU   @NM00138                                                 07317000
@NM00139 EQU   @NM00138                                                 07318000
RBPMSVRB EQU   @NM00136                                                 07319000
RBATNXIT EQU   @NM00136                                                 07320000
@NM00137 EQU   @NM00136                                                 07321000
RBWAITP  EQU   @NM00136                                                 07322000
RBFNSVRB EQU   RBTRSVRB                                                 07323000
RBABOPSW EQU   RBSECT+4                                                 07324000
@NM00134 EQU   RBPPSAV                                                  07325000
RBINTCOD EQU   RBINTCDA+1                                               07326000
RBINLNTH EQU   RBINTCDA                                                 07327000
RBWCSA   EQU   RBPREFIX+60                                              07328000
RBRSV004 EQU   RBPREFIX+57                                              07329000
RBSSSYN  EQU   RBFLAGS1                                                 07330000
RBSCB    EQU   RBFLAGS1                                                 07331000
RBLONGWT EQU   RBFLAGS1                                                 07332000
RBASIR   EQU   RBFLAGS1                                                 07333000
RBRSV159 EQU   RBFLAGS1                                                 07334000
RBABEND  EQU   RBFLAGS1                                                 07335000
RBXWAIT  EQU   RBFLAGS1                                                 07336000
RBSLOCK  EQU   RBFLAGS1                                                 07337000
RBRTRAN  EQU   RBRTPSW2+4                                               07338000
RBRTINCD EQU   RBRTICIL+2                                               07339000
RBRTILC  EQU   RBRTICIL+1                                               07340000
RBRSV160 EQU   RBRTICIL                                                 07341000
RBRTPSW1 EQU   RBRTOPSW                                                 07342000
RBRSV062 EQU   RBRSV054                                                 07343000
RBRSV061 EQU   RBRSV054                                                 07344000
RBRSV060 EQU   RBRSV054                                                 07345000
RBRSV059 EQU   RBRSV054                                                 07346000
RBRSV058 EQU   RBRSV054                                                 07347000
RBRSV057 EQU   RBRSV054                                                 07348000
RBRSV056 EQU   RBRSV054                                                 07349000
RBRSV055 EQU   RBRSV054                                                 07350000
RBRSV053 EQU   RBPREFIX+38                                              07351000
RBRSV052 EQU   RBPREFIX+36                                              07352000
RBRSV051 EQU   RBPREFIX+32                                              07353000
RBRSV050 EQU   RBPREFIX+28                                              07354000
RBRSV049 EQU   RBRSV041                                                 07355000
RBRSV048 EQU   RBRSV041                                                 07356000
RBRSV047 EQU   RBRSV041                                                 07357000
RBRSV046 EQU   RBRSV041                                                 07358000
RBRSV045 EQU   RBRSV041                                                 07359000
RBRSV044 EQU   RBRSV041                                                 07360000
RBRSV043 EQU   RBRSV041                                                 07361000
RBRSV042 EQU   RBRSV041                                                 07362000
RBRSV040 EQU   RBPREFIX+26                                              07363000
RBRSV039 EQU   RBPREFIX+24                                              07364000
RBRSV038 EQU   RBPREFIX+20                                              07365000
RBRSV037 EQU   RBPREFIX+16                                              07366000
RBRSV036 EQU   RBRSV028                                                 07367000
RBRSV035 EQU   RBRSV028                                                 07368000
RBRSV034 EQU   RBRSV028                                                 07369000
RBRSV033 EQU   RBRSV028                                                 07370000
RBRSV032 EQU   RBRSV028                                                 07371000
RBRSV031 EQU   RBRSV028                                                 07372000
RBRSV030 EQU   RBRSV028                                                 07373000
RBRSV029 EQU   RBRSV028                                                 07374000
RBRSV027 EQU   RBRSV019                                                 07375000
RBRSV026 EQU   RBRSV019                                                 07376000
RBRSV025 EQU   RBRSV019                                                 07377000
RBRSV024 EQU   RBRSV019                                                 07378000
RBRSV023 EQU   RBRSV019                                                 07379000
RBRSV022 EQU   RBRSV019                                                 07380000
RBRSV021 EQU   RBRSV019                                                 07381000
RBRSV020 EQU   RBRSV019                                                 07382000
RBRSV018 EQU   RBPREFIX+13                                              07383000
RBRSV017 EQU   RBPREFIX+12                                              07384000
RBSRV016 EQU   RBPREFIX+11                                              07385000
RBRSV015 EQU   RBPREFIX+10                                              07386000
RBRSV014 EQU   RBPREFIX+8                                               07387000
RBRSV013 EQU   RBPREFIX+4                                               07388000
RBRSV012 EQU   RBPREFIX                                                 07389000
XRBREG15 EQU   RBGRS15                                                  07390000
XRBREG14 EQU   RBGRS14                                                  07391000
XRBREG13 EQU   RBGRS13                                                  07392000
XRBREG12 EQU   RBGRS12                                                  07393000
XRBREG11 EQU   RBGRS11                                                  07394000
XRBREG10 EQU   RBGRS10                                                  07395000
XRBREG9  EQU   RBGRS9                                                   07396000
XRBREG8  EQU   RBGRS8                                                   07397000
XRBREG7  EQU   RBGRS7                                                   07398000
XRBREG6  EQU   RBGRS6                                                   07399000
XRBREG5  EQU   RBGRS5                                                   07400000
XRBREG4  EQU   RBGRS4                                                   07401000
XRBREG3  EQU   RBGRS3                                                   07402000
XRBREG2  EQU   RBGRS2                                                   07403000
XRBREG1  EQU   RBGRS1                                                   07404000
XRBREG0  EQU   RBGRS0                                                   07405000
XRBLNKA  EQU   RBLINKB                                                  07406000
XRBWT    EQU   RBWCF                                                    07407000
@NM00133 EQU   RBBASIC+24                                               07408000
RBOPSWPS EQU   RBOPSWB2                                                 07409000
@NM00132 EQU   RBOPSWB2                                                 07410000
@NM00131 EQU   XRBPSW                                                   07411000
@NM00130 EQU   RBBASIC+12                                               07412000
XRBWAIT  EQU   RBECBWT                                                  07413000
XRBFRRB  EQU   RBFDYN                                                   07414000
@NM00129 EQU   XSTAB2                                                   07415000
XRBACTV  EQU   RBFACTV                                                  07416000
XRBTCBP  EQU   RBTCBNXT                                                 07417000
@NM00128 EQU   XSTAB1                                                   07418000
XRBCKPT  EQU   RBFTCKPT                                                 07419000
@NM00127 EQU   XSTAB1                                                   07420000
@NM00126 EQU   RBBASIC+8                                                07421000
@NM00125 EQU   RBEXRTNM+1                                               07422000
RBTMIND3 EQU   RBTMFLD                                                  07423000
RBTMIND2 EQU   RBTMFLD                                                  07424000
RBTMCMP  EQU   RBTMFLD                                                  07425000
RBWLIM   EQU   RBTMFLD                                                  07426000
RBRSV005 EQU   RBTMFLD                                                  07427000
RBTMTOD  EQU   RBTMFLD                                                  07428000
RBTMQUE  EQU   RBTMFLD                                                  07429000
@NM00124 EQU   RBPRFX                                                   07430000
ESTARSVI EQU   ESTAFGRS+1                                               07431000
@NM00123 EQU   ESTAFLG2                                                 07432000
ESTABRNT EQU   ESTAFLG2                                                 07433000
@NM00122 EQU   ESTAFLG2                                                 07434000
ESTAEREC EQU   ESTAFLG2                                                 07435000
@NM00121 EQU   ESTAFLG2                                                 07436000
ESTAHALT EQU   ESTAIO                                                   07437000
ESTANOIO EQU   ESTAIO                                                   07438000
@NM00120 EQU   ESTAFLG1                                                 07439000
@NM00119 EQU   ESTAFLG1                                                 07440000
ESTASTAR EQU   ESTAFLG1                                                 07441000
@NM00118 EQU   FRRSFLGS+1                                               07442000
@NM00117 EQU   FRRSFLG1                                                 07443000
FRRSNEST EQU   FRRSFLG1                                                 07444000
FRRSRCUR EQU   FRRSFLG1                                                 07445000
FRRSENTS EQU   FRRS+84                                                  07446000
FRRSRTMW EQU   FRRS+16                                                  07447000
@NM00092 EQU   SDWA+512                                                 07448000
@NM00091 EQU   SDWADPVA                                                 07449000
SDWAEBC  EQU   SDWADPVA                                                 07450000
SDWAHEX  EQU   SDWADPVA                                                 07451000
@NM00090 EQU   SDWA+396                                                 07452000
SDWACOMP EQU   SDWA+392                                                 07453000
SDWARCPL EQU   SDWA+364                                                 07454000
@NM00089 EQU   SDWADPSA+32                                              07455000
SDWATO4  EQU   SDWADPSL+28                                              07456000
SDWAFRM4 EQU   SDWADPSL+24                                              07457000
SDWATO3  EQU   SDWADPSL+20                                              07458000
SDWAFRM3 EQU   SDWADPSL+16                                              07459000
SDWATO2  EQU   SDWADPSL+12                                              07460000
SDWAFRM2 EQU   SDWADPSL+8                                               07461000
SDWATO1  EQU   SDWADPSL+4                                               07462000
SDWAFRM1 EQU   SDWADPSL                                                 07463000
@NM00088 EQU   SDWADDAT+3                                               07464000
@NM00087 EQU   SDWAPDAT                                                 07465000
SDWAUSPL EQU   SDWAPDAT                                                 07466000
SDWADPSW EQU   SDWAPDAT                                                 07467000
SDWATJPA EQU   SDWAPDAT                                                 07468000
SDWATLPA EQU   SDWAPDAT                                                 07469000
SDWADREG EQU   SDWAPDAT                                                 07470000
SDWADSAH EQU   SDWAPDAT                                                 07471000
SDWADSAS EQU   SDWAPDAT                                                 07472000
@NM00086 EQU   SDWADDAT+1                                               07473000
@NM00085 EQU   SDWASDAT                                                 07474000
SDWAQQS  EQU   SDWASDAT                                                 07475000
SDWACBS  EQU   SDWASDAT                                                 07476000
SDWAGTF  EQU   SDWASDAT                                                 07477000
SDWASWA  EQU   SDWASDAT                                                 07478000
SDWALSQA EQU   SDWASDAT                                                 07479000
SDWASQA  EQU   SDWASDAT                                                 07480000
SDWANUC  EQU   SDWASDAT                                                 07481000
@NM00084 EQU   SDWADUMP+2                                               07482000
@NM00083 EQU   SDWADPFS                                                 07483000
SDWASLST EQU   SDWADPFS                                                 07484000
@NM00082 EQU   SDWADPFS                                                 07485000
SDWADLST EQU   SDWADPFS                                                 07486000
SDWADPT  EQU   SDWADPFS                                                 07487000
SDWADPID EQU   SDWADUMP                                                 07488000
SDWADPLA EQU   SDWA+316                                                 07489000
SDWACSCT EQU   SDWARECP+8                                               07490000
SDWAMODN EQU   SDWARECP                                                 07491000
@NM00081 EQU   SDWA+290                                                 07492000
SDWAASID EQU   SDWA+288                                                 07493000
SDWATALW EQU   SDWALKWS+28                                              07494000
SDWATDLW EQU   SDWALKWS+24                                              07495000
SDWATNLW EQU   SDWALKWS+20                                              07496000
SDWAAPLW EQU   SDWALKWS+16                                              07497000
SDWAIPLW EQU   SDWALKWS+12                                              07498000
SDWAILLW EQU   SDWALKWS+8                                               07499000
SDWAIULW EQU   SDWALKWS+4                                               07500000
SDWAICLW EQU   SDWALKWS                                                 07501000
SDWAFLLK EQU   SDWAACF4                                                 07502000
SDWACMS  EQU   SDWAACF4                                                 07503000
SDWAOPTM EQU   SDWAACF4                                                 07504000
SDWATADB EQU   SDWAACF4                                                 07505000
SDWATDNB EQU   SDWAACF4                                                 07506000
SDWATNCB EQU   SDWAACF4                                                 07507000
SDWAILCH EQU   SDWAACF4                                                 07508000
SDWAIUCB EQU   SDWAACF4                                                 07509000
SDWAICAT EQU   SDWAACF3                                                 07510000
SDWAIPRG EQU   SDWAACF3                                                 07511000
SDWASALL EQU   SDWAACF3                                                 07512000
SDWAASMP EQU   SDWAACF3                                                 07513000
SDWADISP EQU   SDWAACF3                                                 07514000
@NM00080 EQU   SDWAACF3                                                 07515000
@NM00079 EQU   SDWAACF2                                                 07516000
SDWAFREE EQU   SDWAACF2                                                 07517000
SDWAUPRG EQU   SDWAACF2                                                 07518000
@NM00078 EQU   SDWAACF2                                                 07519000
SDWASPIN EQU   SDWAACF2                                                 07520000
@NM00077 EQU   SDWAACF2                                                 07521000
SDWALCPU EQU   SDWACPUA+2                                               07522000
@NM00076 EQU   SDWACPUA                                                 07523000
SDWARECA EQU   SDWA+244                                                 07524000
SDWARTYA EQU   SDWA+240                                                 07525000
@NM00075 EQU   SDWA+239                                                 07526000
@NM00074 EQU   SDWAIOFS                                                 07527000
SDWANIOP EQU   SDWAIOFS                                                 07528000
SDWANOIO EQU   SDWAIOFS                                                 07529000
SDWAIOHT EQU   SDWAIOFS                                                 07530000
SDWAIOQR EQU   SDWAIOFS                                                 07531000
@NM00073 EQU   SDWAERRD                                                 07532000
SDWAMCIV EQU   SDWAERRD                                                 07533000
SDWARPIV EQU   SDWAERRD                                                 07534000
SDWAMABD EQU   SDWAERRD                                                 07535000
SDWACTS  EQU   SDWAERRD                                                 07536000
SDWASTAE EQU   SDWAERRD                                                 07537000
SDWANRBE EQU   SDWAERRD                                                 07538000
SDWACLUP EQU   SDWAERRD                                                 07539000
@NM00072 EQU   SDWAERRC                                                 07540000
SDWAEAS  EQU   SDWAERRC                                                 07541000
SDWAPERC EQU   SDWAERRC                                                 07542000
SDWAIRB  EQU   SDWAERRC                                                 07543000
SDWASTAI EQU   SDWAERRC                                                 07544000
SDWASTAF EQU   SDWAERRC                                                 07545000
SDWASRBM EQU   SDWAERRB                                                 07546000
SDWALDIS EQU   SDWAERRB                                                 07547000
SDWAENRB EQU   SDWAERRB                                                 07548000
SDWATYP1 EQU   SDWAERRB                                                 07549000
@NM00071 EQU   SDWAERRB                                                 07550000
SDWAPGIO EQU   SDWAERRA                                                 07551000
SDWATEXC EQU   SDWAERRA                                                 07552000
SDWASVCE EQU   SDWAERRA                                                 07553000
SDWAABTM EQU   SDWAERRA                                                 07554000
SDWASVCD EQU   SDWAERRA                                                 07555000
SDWARKEY EQU   SDWAERRA                                                 07556000
SDWAMCHK EQU   SDWAERRA                                                 07557000
SDWATIME EQU   SDWAMCH+20                                               07558000
SDWARFSA EQU   SDWAMCH+16                                               07559000
@NM00070 EQU   SDWAMCH+14                                               07560000
SDWAVEQR EQU   SDWARSR2                                                 07561000
SDWAPGFX EQU   SDWARSR2                                                 07562000
SDWAFLSQ EQU   SDWARSR2                                                 07563000
SDWAFSQA EQU   SDWARSR2                                                 07564000
SDWANUCL EQU   SDWARSR2                                                 07565000
SDWASPER EQU   SDWARSR2                                                 07566000
SDWAINTC EQU   SDWARSR2                                                 07567000
SDWAOFLN EQU   SDWARSR2                                                 07568000
SDWACHNG EQU   SDWARSR1                                                 07569000
SDWAMSER EQU   SDWARSR1                                                 07570000
@NM00069 EQU   SDWARSR1                                                 07571000
SDWACPID EQU   SDWAMCH+10                                               07572000
SDWATERR EQU   SDWAMCHD                                                 07573000
SDWAFPRX EQU   SDWAMCHD                                                 07574000
SDWAINSF EQU   SDWAMCHD                                                 07575000
SDWAACR  EQU   SDWAMCHD                                                 07576000
SDWASCK  EQU   SDWAMCHD                                                 07577000
SDWAPSWU EQU   SDWAMCHD                                                 07578000
SDWAREGU EQU   SDWAMCHD                                                 07579000
SDWASKYF EQU   SDWAMCHD                                                 07580000
@NM00068 EQU   SDWAMCHS                                                 07581000
SDWARSRF EQU   SDWAMCHS                                                 07582000
SDWARSRC EQU   SDWAMCHS                                                 07583000
SDWAINVP EQU   SDWAMCHS                                                 07584000
SDWATSVL EQU   SDWAMCHS                                                 07585000
SDWARCDF EQU   SDWAMCHS                                                 07586000
SDWASRVL EQU   SDWAMCHS                                                 07587000
SDWASCKE EQU   SDWASTCK+4                                               07588000
SDWASCKB EQU   SDWASTCK                                                 07589000
SDWALNTH EQU   SDWAIDNT+1                                               07590000
SDWASPID EQU   SDWAIDNT                                                 07591000
SDWASR15 EQU   SDWASRSV+60                                              07592000
SDWASR14 EQU   SDWASRSV+56                                              07593000
SDWASR13 EQU   SDWASRSV+52                                              07594000
SDWASR12 EQU   SDWASRSV+48                                              07595000
SDWASR11 EQU   SDWASRSV+44                                              07596000
SDWASR10 EQU   SDWASRSV+40                                              07597000
SDWASR09 EQU   SDWASRSV+36                                              07598000
SDWASR08 EQU   SDWASRSV+32                                              07599000
SDWASR07 EQU   SDWASRSV+28                                              07600000
SDWASR06 EQU   SDWASRSV+24                                              07601000
SDWASR05 EQU   SDWASRSV+20                                              07602000
SDWASR04 EQU   SDWASRSV+16                                              07603000
SDWASR03 EQU   SDWASRSV+12                                              07604000
SDWASR02 EQU   SDWASRSV+8                                               07605000
SDWASR01 EQU   SDWASRSV+4                                               07606000
SDWASR00 EQU   SDWASRSV                                                 07607000
SDWATRN2 EQU   SDWAAEC2+4                                               07608000
SDWAIPC2 EQU   SDWAICD2                                                 07609000
SDWAIMC2 EQU   SDWAICD2                                                 07610000
SDWAIPR2 EQU   SDWAICD2                                                 07611000
@NM00067 EQU   SDWAINC2                                                 07612000
@NM00066 EQU   SDWAILC2                                                 07613000
SDWAIL2  EQU   SDWAILC2                                                 07614000
@NM00065 EQU   SDWAILC2                                                 07615000
@NM00064 EQU   SDWAAEC2                                                 07616000
SDWAADD2 EQU   SDWANXT2+1                                               07617000
@NM00063 EQU   SDWANXT2                                                 07618000
@NM00062 EQU   SDWAEC2+3                                                07619000
SDWASGN2 EQU   SDWAINT2                                                 07620000
SDWAEXP2 EQU   SDWAINT2                                                 07621000
SDWADEC2 EQU   SDWAINT2                                                 07622000
SDWAFPO2 EQU   SDWAINT2                                                 07623000
SDWACC2  EQU   SDWAINT2                                                 07624000
@NM00061 EQU   SDWAINT2                                                 07625000
SDWAPGM2 EQU   SDWAMWP2                                                 07626000
SDWAWAT2 EQU   SDWAMWP2                                                 07627000
SDWAMCK2 EQU   SDWAMWP2                                                 07628000
SDWAECT2 EQU   SDWAMWP2                                                 07629000
SDWAKEY2 EQU   SDWAMWP2                                                 07630000
SDWAEXT2 EQU   SDWAEMK2                                                 07631000
SDWAIO2  EQU   SDWAEMK2                                                 07632000
SDWATRM2 EQU   SDWAEMK2                                                 07633000
@NM00060 EQU   SDWAEMK2                                                 07634000
SDWAPER2 EQU   SDWAEMK2                                                 07635000
@NM00059 EQU   SDWAEMK2                                                 07636000
SDWATRAN EQU   SDWAAEC1+4                                               07637000
SDWAIPC1 EQU   SDWAICD1                                                 07638000
SDWAIMC1 EQU   SDWAICD1                                                 07639000
SDWAIPR1 EQU   SDWAICD1                                                 07640000
@NM00058 EQU   SDWAINC1                                                 07641000
@NM00057 EQU   SDWAILC1                                                 07642000
SDWAIL1  EQU   SDWAILC1                                                 07643000
@NM00056 EQU   SDWAILC1                                                 07644000
@NM00055 EQU   SDWAAEC1                                                 07645000
SDWAADD1 EQU   SDWANXT1+1                                               07646000
@NM00054 EQU   SDWANXT1                                                 07647000
@NM00053 EQU   SDWAEC1+3                                                07648000
SDWASGN1 EQU   SDWAINT1                                                 07649000
SDWAEXP1 EQU   SDWAINT1                                                 07650000
SDWADEC1 EQU   SDWAINT1                                                 07651000
SDWAFPO1 EQU   SDWAINT1                                                 07652000
SDWACC1  EQU   SDWAINT1                                                 07653000
@NM00052 EQU   SDWAINT1                                                 07654000
SDWAPGM1 EQU   SDWAMWP1                                                 07655000
SDWAWAT1 EQU   SDWAMWP1                                                 07656000
SDWAMCK1 EQU   SDWAMWP1                                                 07657000
SDWAECT1 EQU   SDWAMWP1                                                 07658000
SDWAKEY1 EQU   SDWAMWP1                                                 07659000
SDWAEXT1 EQU   SDWAEMK1                                                 07660000
SDWAIO1  EQU   SDWAEMK1                                                 07661000
SDWATRM1 EQU   SDWAEMK1                                                 07662000
@NM00051 EQU   SDWAEMK1                                                 07663000
SDWAPER1 EQU   SDWAEMK1                                                 07664000
@NM00050 EQU   SDWAEMK1                                                 07665000
SDWAIOBR EQU   SDWA+100                                                 07666000
SDWAEPA  EQU   SDWA+96                                                  07667000
@NM00049 EQU   SDWANAME+4                                               07668000
SDWARBAD EQU   SDWANAME                                                 07669000
SDWAGR15 EQU   SDWAGRSV+60                                              07670000
SDWAGR14 EQU   SDWAGRSV+56                                              07671000
SDWAGR13 EQU   SDWAGRSV+52                                              07672000
SDWAGR12 EQU   SDWAGRSV+48                                              07673000
SDWAGR11 EQU   SDWAGRSV+44                                              07674000
SDWAGR10 EQU   SDWAGRSV+40                                              07675000
SDWAGR09 EQU   SDWAGRSV+36                                              07676000
SDWAGR08 EQU   SDWAGRSV+32                                              07677000
SDWAGR07 EQU   SDWAGRSV+28                                              07678000
SDWAGR06 EQU   SDWAGRSV+24                                              07679000
SDWAGR05 EQU   SDWAGRSV+20                                              07680000
SDWAGR04 EQU   SDWAGRSV+16                                              07681000
SDWAGR03 EQU   SDWAGRSV+12                                              07682000
SDWAGR02 EQU   SDWAGRSV+8                                               07683000
SDWAGR01 EQU   SDWAGRSV+4                                               07684000
SDWAGR00 EQU   SDWAGRSV                                                 07685000
SDWANXTP EQU   SDWACTL2+5                                               07686000
SDWASGP  EQU   SDWAPMKP                                                 07687000
SDWAEUP  EQU   SDWAPMKP                                                 07688000
SDWADOP  EQU   SDWAPMKP                                                 07689000
SDWAFPP  EQU   SDWAPMKP                                                 07690000
SDWACCP  EQU   SDWAPMKP                                                 07691000
SDWAILP  EQU   SDWAPMKP                                                 07692000
SDWAINTP EQU   SDWACTL2+2                                               07693000
SDWASPVP EQU   SDWAMWPP                                                 07694000
SDWAWATP EQU   SDWAMWPP                                                 07695000
SDWAMCKP EQU   SDWAMWPP                                                 07696000
@NM00048 EQU   SDWAMWPP                                                 07697000
SDWAKEYP EQU   SDWAMWPP                                                 07698000
SDWAEXTP EQU   SDWACMKP                                                 07699000
SDWAIOP  EQU   SDWACMKP                                                 07700000
SDWANXTA EQU   SDWACTL1+5                                               07701000
SDWASGA  EQU   SDWAPMKA                                                 07702000
SDWAEUA  EQU   SDWAPMKA                                                 07703000
SDWADOA  EQU   SDWAPMKA                                                 07704000
SDWAFPA  EQU   SDWAPMKA                                                 07705000
SDWACCA  EQU   SDWAPMKA                                                 07706000
SDWAILA  EQU   SDWAPMKA                                                 07707000
SDWAINTA EQU   SDWACTL1+2                                               07708000
SDWASPVA EQU   SDWAMWPA                                                 07709000
SDWAWATA EQU   SDWAMWPA                                                 07710000
SDWAMCKA EQU   SDWAMWPA                                                 07711000
@NM00047 EQU   SDWAMWPA                                                 07712000
SDWAKEYA EQU   SDWAMWPA                                                 07713000
SDWAEXTA EQU   SDWACMKA                                                 07714000
SDWAIOA  EQU   SDWACMKA                                                 07715000
@NM00046 EQU   SDWACMPF                                                 07716000
SDWASTCC EQU   SDWACMPF                                                 07717000
@NM00045 EQU   SDWACMPF                                                 07718000
SDWASTEP EQU   SDWACMPF                                                 07719000
PDSS04ND EQU   PDSS04+2                                                 07720000
PDSAPFAC EQU   PDSAPF+1                                                 07721000
PDSAPFCT EQU   PDSAPF                                                   07722000
PDSS03ND EQU   PDSS03+4                                                 07723000
PDSMBRSN EQU   PDSSSIWD+2                                               07724000
PDSIBMMB EQU   PDSSSIFB                                                 07725000
PDSSYSGN EQU   PDSSSIFB                                                 07726000
PDSDEPCH EQU   PDSSSIFB                                                 07727000
PDSEMFIX EQU   PDSSSIFB                                                 07728000
PDSUSRCH EQU   PDSSSIFB                                                 07729000
PDSFORCE EQU   PDSSSIFB                                                 07730000
@NM00044 EQU   PDSSSIFB                                                 07731000
PDSCHLVL EQU   PDSSSIWD                                                 07732000
PDSS02ND EQU   PDSS02+11                                                07733000
PDS2MNM  EQU   PDSS02+3                                                 07734000
PDS2EPM  EQU   PDSS02                                                   07735000
PDSS01ND EQU   PDSS01+8                                                 07736000
PDS2ESDC EQU   PDSS01+6                                                 07737000
PDS2ESDT EQU   PDSS01+4                                                 07738000
PDS2TTSZ EQU   PDSS01+2                                                 07739000
PDS2SLSZ EQU   PDSS01                                                   07740000
PDSBCEND EQU   PDS2+35                                                  07741000
PDS2FTB3 EQU   PDS2FTBO+2                                               07742000
PDS2FTB2 EQU   PDS2FTBO+1                                               07743000
@NM00043 EQU   PDS2FTB1                                                 07744000
PDSAPFLG EQU   PDS2FTB1                                                 07745000
PDS2SSI  EQU   PDS2FTB1                                                 07746000
PDS2PAGA EQU   PDS2FTB1                                                 07747000
@NM00042 EQU   PDS2FTB1                                                 07748000
PDSAOSLE EQU   PDS2FTB1                                                 07749000
PDS2EPA  EQU   PDS2+29                                                  07750000
PDS2FTBL EQU   PDS2+27                                                  07751000
PDS2STOR EQU   PDS2+24                                                  07752000
PDS2REFR EQU   PDS2ATR2                                                 07753000
PDS2LEF  EQU   PDS2ATR2                                                 07754000
PDS2TSTN EQU   PDS2ATR2                                                 07755000
PDS2NREP EQU   PDS2ATR2                                                 07756000
PDS2NRLD EQU   PDS2ATR2                                                 07757000
PDS2EP0  EQU   PDS2ATR2                                                 07758000
PDS2ORG0 EQU   PDS2ATR2                                                 07759000
PDS2FLVL EQU   PDS2ATR2                                                 07760000
PDS21BLK EQU   PDS2ATR1                                                 07761000
PDS2EXEC EQU   PDS2ATR1                                                 07762000
PDS2SCTR EQU   PDS2ATR1                                                 07763000
PDS2LOAD EQU   PDS2ATR1                                                 07764000
PDS2TEST EQU   PDS2ATR1                                                 07765000
PDS2OVLY EQU   PDS2ATR1                                                 07766000
PDS2REUS EQU   PDS2ATR1                                                 07767000
PDS2RENT EQU   PDS2ATR1                                                 07768000
PDS2NL   EQU   PDS2+21                                                  07769000
PDS2TTRN EQU   PDS2+18                                                  07770000
PDS2ZERO EQU   PDS2+17                                                  07771000
PDS2LUSR EQU   PDS2INDC                                                 07772000
PDS2NTTR EQU   PDS2INDC                                                 07773000
PDS2ALIS EQU   PDS2INDC                                                 07774000
PDS2LIBF EQU   PDS2+12                                                  07775000
PDS2CNCT EQU   PDS2+11                                                  07776000
PDS2TTRP EQU   PDS2+8                                                   07777000
PDS2NAME EQU   PDS2                                                     07778000
@NM00040 EQU   SCVTSECT+180                                             07779000
@NM00039 EQU   SCVTSECT+176                                             07780000
SCVTPIQE EQU   SCVTSECT+172                                             07781000
@NM00038 EQU   SCVTSECT+168                                             07782000
SCVTPTRM EQU   SCVTSECT+164                                             07783000
@NM00037 EQU   SCVTSECT+160                                             07784000
@NM00036 EQU   SCVTSECT+156                                             07785000
SCVTQCBR EQU   SCVTSECT+152                                             07786000
SCVTSTAT EQU   SCVTSECT+148                                             07787000
@NM00035 EQU   SCVTSECT+144                                             07788000
SCVTTQE  EQU   SCVTSECT+140                                             07789000
@NM00034 EQU   SCVTSECT+136                                             07790000
SCVTSVCT EQU   SCVTSECT+132                                             07791000
@NM00033 EQU   SCVTSECT+128                                             07792000
@NM00032 EQU   SCVTSECT+124                                             07793000
SCVTRXLQ EQU   SCVTSECT+120                                             07794000
@NM00031 EQU   SCVTSECT+116                                             07795000
SCVTCTCB EQU   SCVTSECT+112                                             07796000
@NM00030 EQU   SCVTSECT+108                                             07797000
@NM00029 EQU   SCVTSECT+104                                             07798000
@NM00028 EQU   SCVTSECT+100                                             07799000
@NM00027 EQU   SCVTSECT+96                                              07800000
SCVTCOMM EQU   SCVTSECT+92                                              07801000
@NM00026 EQU   SCVTSECT+88                                              07802000
@NM00025 EQU   SCVTSECT+84                                              07803000
@NM00024 EQU   SCVTSECT+80                                              07804000
@NM00023 EQU   SCVTSECT+76                                              07805000
@NM00022 EQU   SCVTSECT+72                                              07806000
SCVTGMBR EQU   SCVTSECT+68                                              07807000
SCVTRPTR EQU   SCVTSECT+64                                              07808000
SCVTHSKP EQU   SCVTSECT+60                                              07809000
@NM00021 EQU   SCVTSECT+56                                              07810000
@NM00020 EQU   SCVTSECT+52                                              07811000
SCVTLFRM EQU   SCVTSECT+48                                              07812000
SCVTCDCL EQU   SCVTSECT+44                                              07813000
@NM00019 EQU   SCVTSECT+40                                              07814000
SCVTRACE EQU   SCVTSECT+36                                              07815000
@NM00018 EQU   SCVTSECT+32                                              07816000
SCVTRMBR EQU   SCVTSECT+28                                              07817000
@NM00017 EQU   SCVTSECT+24                                              07818000
@NM00016 EQU   SCVTSECT+20                                              07819000
@NM00015 EQU   SCVTSECT+16                                              07820000
@NM00014 EQU   SCVTSECT+14                                              07821000
SCVTBR14 EQU   SCVTSECT+12                                              07822000
SCVTSPET EQU   SCVTSECT+8                                               07823000
SCVTPGWR EQU   SCVTSECT+4                                               07824000
SCVTPGTM EQU   SCVTSECT                                                 07825000
CVTLEVL  EQU   CVTRELNO+2                                               07826000
CVTNUMB  EQU   CVTRELNO                                                 07827000
CVTMDL   EQU   CVTFIX+250                                               07828000
@NM00013 EQU   CVTFIX+248                                               07829000
@NM00012 EQU   CVTFIX                                                   07830000
CVTRV482 EQU   CVTXTNT2+128                                             07831000
CVTRV481 EQU   CVTXTNT2+124                                             07832000
CVTRV480 EQU   CVTXTNT2+120                                             07833000
CVTRV479 EQU   CVTXTNT2+118                                             07834000
CVTRV478 EQU   CVTXTNT2+117                                             07835000
CVTRV477 EQU   CVTXTNT2+116                                             07836000
CVTRV476 EQU   CVTXTNT2+115                                             07837000
CVTRV475 EQU   CVTXTNT2+114                                             07838000
CVTRV474 EQU   CVTRV466                                                 07839000
CVTRV473 EQU   CVTRV466                                                 07840000
CVTRV472 EQU   CVTRV466                                                 07841000
CVTRV471 EQU   CVTRV466                                                 07842000
CVTRV470 EQU   CVTRV466                                                 07843000
CVTRV469 EQU   CVTRV466                                                 07844000
CVTRV468 EQU   CVTRV466                                                 07845000
CVTRV467 EQU   CVTRV466                                                 07846000
CVTRV465 EQU   CVTRV457                                                 07847000
CVTRV464 EQU   CVTRV457                                                 07848000
CVTRV463 EQU   CVTRV457                                                 07849000
CVTRV462 EQU   CVTRV457                                                 07850000
CVTRV461 EQU   CVTRV457                                                 07851000
CVTRV460 EQU   CVTRV457                                                 07852000
CVTRV459 EQU   CVTRV457                                                 07853000
CVTRV458 EQU   CVTRV457                                                 07854000
CVTRV456 EQU   CVTXTNT2+108                                             07855000
CVTRV455 EQU   CVTXTNT2+104                                             07856000
CVTRV454 EQU   CVTXTNT2+100                                             07857000
CVTRV453 EQU   CVTXTNT2+96                                              07858000
CVTRV452 EQU   CVTXTNT2+94                                              07859000
CVTRV451 EQU   CVTXTNT2+92                                              07860000
CVTRV450 EQU   CVTXTNT2+90                                              07861000
CVTRV449 EQU   CVTXTNT2+88                                              07862000
CVTRV448 EQU   CVTXTNT2+87                                              07863000
CVTRV447 EQU   CVTXTNT2+86                                              07864000
CVTRV446 EQU   CVTRV438                                                 07865000
CVTRV445 EQU   CVTRV438                                                 07866000
CVTRV444 EQU   CVTRV438                                                 07867000
CVTRV443 EQU   CVTRV438                                                 07868000
CVTRV442 EQU   CVTRV438                                                 07869000
CVTRV441 EQU   CVTRV438                                                 07870000
CVTRV440 EQU   CVTRV438                                                 07871000
CVTRV439 EQU   CVTRV438                                                 07872000
CVTRV437 EQU   CVTRV429                                                 07873000
CVTRV436 EQU   CVTRV429                                                 07874000
CVTRV435 EQU   CVTRV429                                                 07875000
CVTRV434 EQU   CVTRV429                                                 07876000
CVTRV433 EQU   CVTRV429                                                 07877000
CVTRV432 EQU   CVTRV429                                                 07878000
CVTRV431 EQU   CVTRV429                                                 07879000
CVTRV430 EQU   CVTRV429                                                 07880000
CVTRV428 EQU   CVTXTNT2+80                                              07881000
CVTRV427 EQU   CVTXTNT2+76                                              07882000
CVTRV426 EQU   CVTXTNT2+72                                              07883000
CVTRV425 EQU   CVTXTNT2+68                                              07884000
CVTATACT EQU   CVTATCVT                                                 07885000
CVTRV423 EQU   CVTXTNT2+62                                              07886000
CVTRV422 EQU   CVTXTNT2+60                                              07887000
CVTRV421 EQU   CVTXTNT2+58                                              07888000
CVTRV420 EQU   CVTXTNT2+56                                              07889000
CVTRV419 EQU   CVTXTNT2+55                                              07890000
CVTRV418 EQU   CVTXTNT2+54                                              07891000
CVTRV417 EQU   CVTRV409                                                 07892000
CVTRV416 EQU   CVTRV409                                                 07893000
CVTRV415 EQU   CVTRV409                                                 07894000
CVTRV414 EQU   CVTRV409                                                 07895000
CVTRV413 EQU   CVTRV409                                                 07896000
CVTRV412 EQU   CVTRV409                                                 07897000
CVTRV411 EQU   CVTRV409                                                 07898000
CVTRV410 EQU   CVTRV409                                                 07899000
CVTRV408 EQU   CVTRV400                                                 07900000
CVTRV407 EQU   CVTRV400                                                 07901000
CVTRV406 EQU   CVTRV400                                                 07902000
CVTRV405 EQU   CVTRV400                                                 07903000
CVTRV404 EQU   CVTRV400                                                 07904000
CVTRV403 EQU   CVTRV400                                                 07905000
CVTRV402 EQU   CVTRV400                                                 07906000
CVTRV401 EQU   CVTRV400                                                 07907000
CVTICB   EQU   CVTXTNT2+48                                              07908000
CVTSKTA  EQU   CVTXTNT2+44                                              07909000
CVTCCVT  EQU   CVTXTNT2+40                                              07910000
CVTRSV98 EQU   CVTXTNT2+36                                              07911000
CVTRSV97 EQU   CVTXTNT2+34                                              07912000
CVTRSV96 EQU   CVTXTNT2+32                                              07913000
CVTOLTEP EQU   CVTXTNT2+28                                              07914000
CVTQIDA  EQU   CVTQID+1                                                 07915000
CVTRSV95 EQU   CVTQID                                                   07916000
CVTRSV94 EQU   CVTXTNT2+20                                              07917000
CVTRSV93 EQU   CVTXTNT2+16                                              07918000
CVTRSV92 EQU   CVTXTNT2+12                                              07919000
CVTDEBVR EQU   CVTXTNT2+8                                               07920000
CVTRSV91 EQU   CVTXTNT2+6                                               07921000
CVTRSV9H EQU   CVTFLGBT                                                 07922000
CVTRSV9G EQU   CVTFLGBT                                                 07923000
CVTRSV9F EQU   CVTFLGBT                                                 07924000
CVTRSV9E EQU   CVTFLGBT                                                 07925000
CVTRSV9D EQU   CVTFLGBT                                                 07926000
CVTRSV9C EQU   CVTFLGBT                                                 07927000
CVTVME   EQU   CVTFLGBT                                                 07928000
CVTNPE   EQU   CVTFLGBT                                                 07929000
CVTNUCLS EQU   CVTXTNT2+4                                               07930000
CVTDSSVA EQU   CVTDSSV+1                                                07931000
CVTRSV89 EQU   CVTDSSV                                                  07932000
CVTRSV88 EQU   CVTXTNT1+8                                               07933000
CVTRSV87 EQU   CVTXTNT1+4                                               07934000
CVTFACHN EQU   CVTXTNT1                                                 07935000
CVTRV488 EQU   CVTMAP+412                                               07936000
CVTRV487 EQU   CVTMAP+408                                               07937000
CVTRV486 EQU   CVTMAP+404                                               07938000
CVTRV485 EQU   CVTMAP+400                                               07939000
CVTACTAP EQU   CVTMAP+396                                               07940000
CVTAUTH  EQU   CVTMAP+392                                               07941000
CVTATMCA EQU   CVTATMCT+1                                               07942000
CVTATMST EQU   CVTATMCT                                                 07943000
CVTRSV61 EQU   CVTMAP+384                                               07944000
CVTVOLT1 EQU   CVTVOLM1+1                                               07945000
CVTVOLI1 EQU   CVTVOLF1                                                 07946000
CVTSTOA  EQU   CVTMAP+376                                               07947000
CVTRSV58 EQU   CVTMAP+374                                               07948000
CVTRSV57 EQU   CVTMAP+372                                               07949000
CVTDDCE  EQU   CVTMAP+368                                               07950000
CVTPNWFR EQU   CVTMAP+364                                               07951000
CVTSMF   EQU   CVTMAP+360                                               07952000
CVTSULK  EQU   CVTMAP+358                                               07953000
CVTSLKO  EQU   CVTSYSK                                                  07954000
CVTSLKP  EQU   CVTSYSK                                                  07955000
CVTSLKQ  EQU   CVTSYSK                                                  07956000
CVTSLKR  EQU   CVTSYSK                                                  07957000
CVTRSV56 EQU   CVTSYSK                                                  07958000
CVTRSV55 EQU   CVTSYSK                                                  07959000
CVTRSV54 EQU   CVTSYSK                                                  07960000
CVTRSV53 EQU   CVTSYSK                                                  07961000
CVTRSV52 EQU   CVTA1F1                                                  07962000
CVTRSV51 EQU   CVTA1F1                                                  07963000
CVTRSV50 EQU   CVTA1F1                                                  07964000
CVTRSV49 EQU   CVTA1F1                                                  07965000
CVTRSV48 EQU   CVTA1F1                                                  07966000
CVTRSV47 EQU   CVTA1F1                                                  07967000
CVTSRSW  EQU   CVTA1F1                                                  07968000
CVTPFSW  EQU   CVTA1F1                                                  07969000
CVTPCVT  EQU   CVTMAP+352                                               07970000
CVTRSV46 EQU   CVTMAP+344                                               07971000
CVTRSV45 EQU   CVTMAP+340                                               07972000
CVTRSV44 EQU   CVTMAP+338                                               07973000
CVTRSV43 EQU   CVTMAP+336                                               07974000
CVTHJESA EQU   CVTHJES+1                                                07975000
CVTRSV42 EQU   CVTHJES                                                  07976000
CVTEXT2A EQU   CVTEXT2+1                                                07977000
CVTRSV41 EQU   CVTEXT2                                                  07978000
CVTAPFA  EQU   CVTAPF+1                                                 07979000
CVTRSV40 EQU   CVTAPF                                                   07980000
CVTRV518 EQU   CVTINTLA                                                 07981000
CVTRV517 EQU   CVTERPV                                                  07982000
CVTEORM  EQU   CVTMAP+312                                               07983000
CVTMCHPR EQU   CVTMAP+308                                               07984000
CVTTZ    EQU   CVTMAP+304                                               07985000
CVTJEPS  EQU   CVTMAP+300                                               07986000
CVTJESCT EQU   CVTMAP+296                                               07987000
CVTMODE  EQU   CVTMAP+292                                               07988000
CVTPTRV  EQU   CVTMAP+288                                               07989000
CVTREAL  EQU   CVTMAP+284                                               07990000
CVTRSV39 EQU   CVTMAP+280                                               07991000
CVTRSV38 EQU   CVTMAP+276                                               07992000
CVTDMSRA EQU   CVTDMSR+1                                                07993000
CVTRV634 EQU   CVTDMSRF                                                 07994000
CVTRV633 EQU   CVTDMSRF                                                 07995000
CVTRV632 EQU   CVTDMSRF                                                 07996000
CVTRV631 EQU   CVTDMSRF                                                 07997000
CVTRV630 EQU   CVTDMSRF                                                 07998000
CVTRV629 EQU   CVTDMSRF                                                 07999000
CVTUDUMP EQU   CVTDMSRF                                                 08000000
CVTSDUMP EQU   CVTDMSRF                                                 08001000
CVTQMSGA EQU   CVTQMSG+1                                                08002000
CVTRSV36 EQU   CVTQMSG                                                  08003000
CVTAMFF  EQU   CVTMAP+264                                               08004000
CVTPURGA EQU   CVTPURG+1                                                08005000
CVTRSV35 EQU   CVTPURG                                                  08006000
CVTCBSP  EQU   CVTMAP+256                                               08007000
CVTATERA EQU   CVTATER+1                                                08008000
CVTSYST  EQU   CVTATER                                                  08009000
CVTVOLT2 EQU   CVTTAT                                                   08010000
CVTVOLI2 EQU   CVTVOLF2                                                 08011000
CVTAQAVB EQU   CVTAQAVT+1                                               08012000
CVTRSV34 EQU   CVTTCMFG                                                 08013000
CVTRSV33 EQU   CVTTCMFG                                                 08014000
CVTRSV32 EQU   CVTTCMFG                                                 08015000
CVTRSV31 EQU   CVTTCMFG                                                 08016000
CVTRSV30 EQU   CVTTCMFG                                                 08017000
CVTRSV29 EQU   CVTTCMFG                                                 08018000
CVTLDEV  EQU   CVTTCMFG                                                 08019000
CVTTCRDY EQU   CVTTCMFG                                                 08020000
CVTGTFA  EQU   CVTGTF+1                                                 08021000
CVTRSV27 EQU   CVTGTFST                                                 08022000
CVTRNIO  EQU   CVTGTFST                                                 08023000
CVTUSR   EQU   CVTGTFST                                                 08024000
CVTRV318 EQU   CVTFORM                                                  08025000
CVTRV317 EQU   CVTTMODE                                                 08026000
CVTRV316 EQU   CVTSTATE                                                 08027000
CVTRV315 EQU   CVTGTFS                                                  08028000
CVTGTFAV EQU   CVTGTFS                                                  08029000
CVT0SCR1 EQU   CVTMAP+232                                               08030000
CVTRV515 EQU   CVTMAP+228                                               08031000
CVTRMS   EQU   CVTMAP+224                                               08032000
CVTPATCH EQU   CVTMAP+220                                               08033000
CVTTSCE  EQU   CVTMAP+216                                               08034000
CVTLNKSC EQU   CVTMAP+214                                               08035000
CVTQABST EQU   CVTMAP+212                                               08036000
CVTMDLDS EQU   CVTMAP+208                                               08037000
CVTUSER  EQU   CVTMAP+204                                               08038000
CVTABEND EQU   CVTMAP+200                                               08039000
CVTSMCA  EQU   CVTMAP+196                                               08040000
CVTRSV18 EQU   CVTMAP+192                                               08041000
CVTQLPAQ EQU   CVTMAP+188                                               08042000
CVTQCDSR EQU   CVTMAP+184                                               08043000
CVTRSV17 EQU   CVTOPTB                                                  08044000
CVTRSV16 EQU   CVTOPTB                                                  08045000
CVTFP    EQU   CVTOPTB                                                  08046000
CVTAPTHR EQU   CVTOPTB                                                  08047000
CVTNLOG  EQU   CVTOPTB                                                  08048000
CVTTOD   EQU   CVTOPTB                                                  08049000
CVTCTIMS EQU   CVTOPTB                                                  08050000
CVTPROT  EQU   CVTOPTB                                                  08051000
CVTXPFP  EQU   CVTOPTA                                                  08052000
CVTASCII EQU   CVTOPTA                                                  08053000
CVTRSV13 EQU   CVTOPTA                                                  08054000
CVTRSV12 EQU   CVTOPTA                                                  08055000
CVTNIP   EQU   CVTOPTA                                                  08056000
CVTDDR   EQU   CVTOPTA                                                  08057000
CVTAPR   EQU   CVTOPTA                                                  08058000
CVTCCH   EQU   CVTOPTA                                                  08059000
CVTSNCTR EQU   CVTMAP+180                                               08060000
CVTQMWR  EQU   CVTMAP+176                                               08061000
CVTQOCR  EQU   CVTMAP+172                                               08062000
CVT1EF00 EQU   CVTMAP+168                                               08063000
CVTMZ00  EQU   CVTMAP+164                                               08064000
CVTSV76Q EQU   CVTSV76C                                                 08065000
CVTRSV11 EQU   CVTMAP+156                                               08066000
CVT0PT01 EQU   CVTMAP+152                                               08067000
CVTMSER  EQU   CVTMAP+148                                               08068000
CVTRV516 EQU   CVTIERLC                                                 08069000
CVTILCH  EQU   CVTMAP+140                                               08070000
CVT0DS   EQU   CVTMAP+136                                               08071000
CVTFBOSV EQU   CVTMAP+132                                               08072000
CVTNUCB  EQU   CVTMAP+128                                               08073000
CVTIXAVL EQU   CVTMAP+124                                               08074000
CVTSV76M EQU   CVTIOQET                                                 08075000
CVTDCBA  EQU   CVTMAP+117                                               08076000
CVTMVS2  EQU   CVTDCB                                                   08077000
CVT6DAT  EQU   CVTDCB                                                   08078000
CVT4MPS  EQU   CVTDCB                                                   08079000
CVTRSV09 EQU   CVTDCB                                                   08080000
CVT4MS1  EQU   CVTDCB                                                   08081000
CVT2SPS  EQU   CVTDCB                                                   08082000
CVT1SSS  EQU   CVTDCB                                                   08083000
CVTRSV08 EQU   CVTDCB                                                   08084000
CVTSTB   EQU   CVTMAP+112                                               08085000
CVTQTD00 EQU   CVTMAP+108                                               08086000
CVTQTE00 EQU   CVTMAP+104                                               08087000
CVTCUCB  EQU   CVTMAP+100                                               08088000
CVTSJQ   EQU   CVTMAP+96                                                08089000
CVTPBLDL EQU   CVTMAP+92                                                08090000
CVTTPC   EQU   CVTMAP+88                                                08091000
CVTSVDCB EQU   CVTMAP+84                                                08092000
CVTBRET  EQU   CVTMAP+82                                                08093000
CVTEXIT  EQU   CVTMAP+80                                                08094000
CVT0FN00 EQU   CVTMAP+76                                                08095000
CVTDARA  EQU   CVTDAR+1                                                 08096000
CVTRSV07 EQU   CVTFLGS1                                                 08097000
CVTRSV06 EQU   CVTFLGS1                                                 08098000
CVTRSV05 EQU   CVTFLGS1                                                 08099000
CVTRSV04 EQU   CVTFLGS1                                                 08100000
CVTRSV03 EQU   CVTFLGS1                                                 08101000
CVTRSV02 EQU   CVTFLGS1                                                 08102000
CVTRSV01 EQU   CVTFLGS1                                                 08103000
CVTDMPLK EQU   CVTFLGS1                                                 08104000
CVTXITP  EQU   CVTMAP+68                                                08105000
CVTZDTAB EQU   CVTMAP+64                                                08106000
CVTMSLT  EQU   CVTMAP+60                                                08107000
CVTDATE  EQU   CVTMAP+56                                                08108000
CVTBTERM EQU   CVTMAP+52                                                08109000
CVTSYSAD EQU   CVTMAP+48                                                08110000
CVTXTLER EQU   CVTMAP+44                                                08111000
CVTILK2  EQU   CVTMAP+40                                                08112000
CVTILK1  EQU   CVTMAP+36                                                08113000
CVTPRLTV EQU   CVTMAP+32                                                08114000
CVTPCNVT EQU   CVTMAP+28                                                08115000
CVT0VL00 EQU   CVTMAP+24                                                08116000
CVTXAPG  EQU   CVTMAP+20                                                08117000
CVTBUF   EQU   CVTMAP+16                                                08118000
CVTJOB   EQU   CVTMAP+12                                                08119000
CVTLINK  EQU   CVTMAP+8                                                 08120000
CVT0EF00 EQU   CVTMAP+4                                                 08121000
CVTTCBP  EQU   CVTMAP                                                   08122000
ASXBEND  EQU   ASXB+232                                                 08123000
ASXBRV25 EQU   ASXB+228                                                 08124000
ASXBRV24 EQU   ASXB+224                                                 08125000
ASXBPT0E EQU   ASXB+220                                                 08126000
ASXBCRB4 EQU   ASXBCASW+3                                               08127000
ASXBCRB3 EQU   ASXBCASW+2                                               08128000
ASXBCRB2 EQU   ASXBCASW+1                                               08129000
ASXBCR06 EQU   ASXBCRB1                                                 08130000
ASXBCR05 EQU   ASXBCRB1                                                 08131000
ASXBCR04 EQU   ASXBCRB1                                                 08132000
ASXBCR03 EQU   ASXBCRB1                                                 08133000
ASXBCR02 EQU   ASXBCRB1                                                 08134000
ASXBCR01 EQU   ASXBCRB1                                                 08135000
ASXBTFD  EQU   ASXBCRB1                                                 08136000
ASXBPIP  EQU   ASXBCRB1                                                 08137000
ASXBCTDC EQU   ASXB+212                                                 08138000
ASXBTDCB EQU   ASXB+208                                                 08139000
ASXBRV19 EQU   ASXB+204                                                 08140000
ASXBSENV EQU   ASXBSECR+1                                               08141000
ASXBRV34 EQU   ASCBSFLG                                                 08142000
ASXBRV33 EQU   ASCBSFLG                                                 08143000
ASXBRV32 EQU   ASCBSFLG                                                 08144000
ASXBRV31 EQU   ASCBSFLG                                                 08145000
ASXBRV30 EQU   ASCBSFLG                                                 08146000
ASXBRV29 EQU   ASCBSFLG                                                 08147000
ASXBRV28 EQU   ASCBSFLG                                                 08148000
ASXBRV27 EQU   ASCBSFLG                                                 08149000
ASXBUSER EQU   ASXB+192                                                 08150000
ASXBLSRB EQU   ASXBAEQ+20                                               08151000
ASXBFSRB EQU   ASXBAEQ+16                                               08152000
ASXBLRQE EQU   ASXBAEQ+12                                               08153000
ASXBFRQE EQU   ASXBAEQ+8                                                08154000
ASXBLIQE EQU   ASXBAEQ+4                                                08155000
ASXBFIQE EQU   ASXBAEQ                                                  08156000
ASXBETSK EQU   ASXB+164                                                 08157000
ASXBSIRB EQU   ASXB+160                                                 08158000
ASXBPSWD EQU   ASXB+152                                                 08159000
ASXBPRG  EQU   ASXB+136                                                 08160000
ASXBRV26 EQU   ASXB+132                                                 08161000
ASXBOUSB EQU   ASXB+128                                                 08162000
ASXBDDR  EQU   ASXB+124                                                 08163000
ASXBRCTD EQU   ASXB+120                                                 08164000
ASXBRSMD EQU   ASXB+116                                                 08165000
ASXBSPSA EQU   ASXB+112                                                 08166000
ASXBFRWA EQU   ASXB+108                                                 08167000
ASXBFLSA EQU   ASXB+36                                                  08168000
ASXBIHSA EQU   ASXB+32                                                  08169000
ASXBRV15 EQU   ASXB+28                                                  08170000
ASXBRV14 EQU   ASXB+24                                                  08171000
ASXBLWA  EQU   ASXB+20                                                  08172000
ASXBMPST EQU   ASXB+16                                                  08173000
ASXBRS00 EQU   ASXB+14                                                  08174000
ASXBASXB EQU   ASXB                                                     08175000
ASXBEGIN EQU   ASXB                                                     08176000
ASCBEND  EQU   ASCB+208                                                 08177000
ASCBSRBT EQU   ASCB+200                                                 08178000
ASCBSWTL EQU   ASCB+196                                                 08179000
ASCBRS14 EQU   ASCB+195                                                 08180000
ASCBSMCT EQU   ASCB+194                                                 08181000
ASCBRS12 EQU   ASCB+192                                                 08182000
ASCBPCTT EQU   ASCB+188                                                 08183000
ASCBVGTT EQU   ASCB+184                                                 08184000
ASCBRV43 EQU   ASCBSRQ4                                                 08185000
ASCBRV42 EQU   ASCBSRQ4                                                 08186000
ASCBRV41 EQU   ASCBSRQ4                                                 08187000
ASCBRV40 EQU   ASCBSRQ4                                                 08188000
ASCBRV39 EQU   ASCBSRQ4                                                 08189000
ASCBRV38 EQU   ASCBSRQ4                                                 08190000
ASCBRV37 EQU   ASCBSRQ4                                                 08191000
ASCBRV36 EQU   ASCBSRQ4                                                 08192000
ASCBRV35 EQU   ASCBSRQ3                                                 08193000
ASCBRV34 EQU   ASCBSRQ3                                                 08194000
ASCBRV33 EQU   ASCBSRQ3                                                 08195000
ASCBRV32 EQU   ASCBSRQ3                                                 08196000
ASCBRV31 EQU   ASCBSRQ3                                                 08197000
ASCBRV30 EQU   ASCBSRQ3                                                 08198000
ASCBRV29 EQU   ASCBSRQ3                                                 08199000
ASCBRV28 EQU   ASCBSRQ3                                                 08200000
ASCBRV27 EQU   ASCBSRQ2                                                 08201000
ASCBRV26 EQU   ASCBSRQ2                                                 08202000
ASCBRV25 EQU   ASCBSRQ2                                                 08203000
ASCBRV24 EQU   ASCBSRQ2                                                 08204000
ASCBRV23 EQU   ASCBSRQ2                                                 08205000
ASCBRV22 EQU   ASCBSRQ2                                                 08206000
ASCBRV21 EQU   ASCBSRQ2                                                 08207000
ASCBRV20 EQU   ASCBSRQ2                                                 08208000
ASCBRV19 EQU   ASCBSRQ1                                                 08209000
ASCBRV18 EQU   ASCBSRQ1                                                 08210000
ASCBRV17 EQU   ASCBSRQ1                                                 08211000
ASCBRV16 EQU   ASCBSRQ1                                                 08212000
ASCBRV15 EQU   ASCBSRQ1                                                 08213000
ASCBRV14 EQU   ASCBSRQ1                                                 08214000
ASCBRV13 EQU   ASCBSRQ1                                                 08215000
ASCBSTA  EQU   ASCBSRQ1                                                 08216000
ASCBJBNS EQU   ASCB+176                                                 08217000
ASCBJBNI EQU   ASCB+172                                                 08218000
ASCBMCC  EQU   ASCB+168                                                 08219000
ASCBRTWA EQU   ASCB+164                                                 08220000
ASCBIQEA EQU   ASCB+160                                                 08221000
ASCBXMPQ EQU   ASCB+156                                                 08222000
ASCBRS01 EQU   ASCB+154                                                 08223000
ASCBFMCT EQU   ASCB+152                                                 08224000
ASCBOUXB EQU   ASCB+148                                                 08225000
ASCBOUCB EQU   ASCB+144                                                 08226000
ASCBMECB EQU   ASCB+140                                                 08227000
ASCBQECB EQU   ASCB+136                                                 08228000
ASCBLSQH EQU   ASCBLKGP+4                                               08229000
ASCBLOCK EQU   ASCBLKGP                                                 08230000
ASCBNVSC EQU   ASCB+122                                                 08231000
ASCBVSC  EQU   ASCB+120                                                 08232000
ASCBSRBS EQU   ASCB+118                                                 08233000
ASCBSSRB EQU   ASCB+116                                                 08234000
ASCBRV06 EQU   ASCBFLG2                                                 08235000
ASCBRV05 EQU   ASCBFLG2                                                 08236000
ASCBRV04 EQU   ASCBFLG2                                                 08237000
ASCBSNQS EQU   ASCBFLG2                                                 08238000
ASCBS2S  EQU   ASCBFLG2                                                 08239000
ASCBCEXT EQU   ASCBFLG2                                                 08240000
ASCBPXMT EQU   ASCBFLG2                                                 08241000
ASCBXMPT EQU   ASCBFLG2                                                 08242000
ASCBRF07 EQU   ASCBDSP1                                                 08243000
ASCBRF06 EQU   ASCBDSP1                                                 08244000
ASCBRF05 EQU   ASCBDSP1                                                 08245000
ASCBRF04 EQU   ASCBDSP1                                                 08246000
ASCBRF03 EQU   ASCBDSP1                                                 08247000
ASCBRF02 EQU   ASCBDSP1                                                 08248000
ASCBFAIL EQU   ASCBDSP1                                                 08249000
ASCBNOQ  EQU   ASCBDSP1                                                 08250000
ASCBSWCT EQU   ASCB+112                                                 08251000
ASCBTMCH EQU   ASCB+104                                                 08252000
ASCBNSWP EQU   ASCBFLG1                                                 08253000
ASCBTYP1 EQU   ASCBFLG1                                                 08254000
ASCBSTND EQU   ASCBFLG1                                                 08255000
ASCBABNT EQU   ASCBFLG1                                                 08256000
ASCBTERM EQU   ASCBFLG1                                                 08257000
ASCBS3S  EQU   ASCBFLG1                                                 08258000
ASCBCMSH EQU   ASCBFLG1                                                 08259000
ASCBTOFF EQU   ASCBFLG1                                                 08260000
ASCBRF01 EQU   ASCBRCTF                                                 08261000
ASCBTMLW EQU   ASCBRCTF                                                 08262000
ASCBOUT  EQU   ASCBRCTF                                                 08263000
ASCBWAIT EQU   ASCBRCTF                                                 08264000
ASCBRV08 EQU   ASCBRCTF                                                 08265000
ASCBFQU  EQU   ASCBRCTF                                                 08266000
ASCBFRS  EQU   ASCBRCTF                                                 08267000
ASCBTMNO EQU   ASCBRCTF                                                 08268000
ASCBDUMP EQU   ASCB+96                                                  08269000
ASCBRV44 EQU   ASCB+92                                                  08270000
ASCBUBET EQU   ASCB+88                                                  08271000
ASCBECB  EQU   ASCB+84                                                  08272000
ASCBJSTL EQU   ASCB+80                                                  08273000
ASCBEWST EQU   ASCB+72                                                  08274000
ASCBEJST EQU   ASCB+64                                                  08275000
ASCBTSB  EQU   ASCB+60                                                  08276000
ASCBCSCB EQU   ASCB+56                                                  08277000
ASCBRSMA EQU   ASCBRSM+1                                                08278000
ASCBRV54 EQU   ASCBRSMF                                                 08279000
ASCBRV53 EQU   ASCBRSMF                                                 08280000
ASCBRV52 EQU   ASCBRSMF                                                 08281000
ASCBRV51 EQU   ASCBRSMF                                                 08282000
ASCBVEQR EQU   ASCBRSMF                                                 08283000
ASCBN2LP EQU   ASCBRSMF                                                 08284000
ASCB1LPU EQU   ASCBRSMF                                                 08285000
ASCB2LPU EQU   ASCBRSMF                                                 08286000
ASCBLDA  EQU   ASCB+48                                                  08287000
ASCBSTOR EQU   ASCB+44                                                  08288000
ASCBDP   EQU   ASCB+43                                                  08289000
ASCBRV07 EQU   ASCB+42                                                  08290000
ASCBIOSM EQU   ASCB+40                                                  08291000
ASCBSEQN EQU   ASCB+38                                                  08292000
ASCBASID EQU   ASCB+36                                                  08293000
ASCBCPUS EQU   ASCB+32                                                  08294000
ASCBSPL  EQU   ASCB+28                                                  08295000
ASCBIOSP EQU   ASCB+24                                                  08296000
ASCBSYNC EQU   ASCBSUPC+4                                               08297000
ASCBSVRB EQU   ASCBSUPC                                                 08298000
ASCBCMSF EQU   ASCB+12                                                  08299000
ASCBBWDP EQU   ASCB+8                                                   08300000
ASCBFWDP EQU   ASCB+4                                                   08301000
ASCBASCB EQU   ASCB                                                     08302000
ASCBEGIN EQU   ASCB                                                     08303000
SPQERES2 EQU   SPQESECT+12                                              08304000
SPQERES1 EQU   SPQESECT+9                                               08305000
IQEOUTLM EQU   IQESECT+20                                               08306000
IQEDCB   EQU   IQESECT+16                                               08307000
IQETCBA  EQU   IQETCB+1                                                 08308000
IQESTAT2 EQU   IQETCB                                                   08309000
IQEIRBA  EQU   IQEIRB+1                                                 08310000
@NM00011 EQU   IQEFLAGS                                                 08311000
@NM00010 EQU   IQEFLAGS                                                 08312000
@NM00009 EQU   IQEFLAGS                                                 08313000
@NM00008 EQU   IQEFLAGS                                                 08314000
@NM00007 EQU   IQEFLAGS                                                 08315000
@NM00006 EQU   IQEFLAGS                                                 08316000
@NM00005 EQU   IQEFLAGS                                                 08317000
IQEPURGE EQU   IQEFLAGS                                                 08318000
IQELNKA  EQU   IQELNK+1                                                 08319000
IQESTAT1 EQU   IQELNK                                                   08320000
@NM00004 EQU   TCBXTNT2+32                                              08321000
TCBRV181 EQU   TCBRV173                                                 08322000
TCBRV180 EQU   TCBRV173                                                 08323000
TCBRV179 EQU   TCBRV173                                                 08324000
TCBRV178 EQU   TCBRV173                                                 08325000
TCBRV177 EQU   TCBRV173                                                 08326000
TCBRV176 EQU   TCBRV173                                                 08327000
TCBRV175 EQU   TCBRV173                                                 08328000
TCBRV174 EQU   TCBRV173                                                 08329000
TCBRV172 EQU   TCBRV164                                                 08330000
TCBRV171 EQU   TCBRV164                                                 08331000
TCBRV170 EQU   TCBRV164                                                 08332000
TCBRV169 EQU   TCBRV164                                                 08333000
TCBRV168 EQU   TCBRV164                                                 08334000
TCBRV167 EQU   TCBRV164                                                 08335000
TCBRV166 EQU   TCBRV164                                                 08336000
TCBRV165 EQU   TCBRV164                                                 08337000
TCBRV163 EQU   TCBRV155                                                 08338000
TCBRV162 EQU   TCBRV155                                                 08339000
TCBRV161 EQU   TCBRV155                                                 08340000
TCBRV160 EQU   TCBRV155                                                 08341000
TCBRV159 EQU   TCBRV155                                                 08342000
TCBRV158 EQU   TCBRV155                                                 08343000
TCBRV157 EQU   TCBRV155                                                 08344000
TCBRV156 EQU   TCBRV155                                                 08345000
TCBRV154 EQU   TCBRV146                                                 08346000
TCBRV153 EQU   TCBRV146                                                 08347000
TCBRV152 EQU   TCBRV146                                                 08348000
TCBRV151 EQU   TCBRV146                                                 08349000
TCBRV150 EQU   TCBRV146                                                 08350000
TCBRV149 EQU   TCBRV146                                                 08351000
TCBRV148 EQU   TCBRV146                                                 08352000
TCBRV147 EQU   TCBRV146                                                 08353000
TCBRV145 EQU   TCBXTNT2+26                                              08354000
TCBRV144 EQU   TCBXTNT2+24                                              08355000
TCBCAUF  EQU   TCBXTNT2+20                                              08356000
TCBRV142 EQU   TCBXTNT2+16                                              08357000
TCBRSV49 EQU   TCBXTNT2+12                                              08358000
TCBEVENT EQU   TCBXTNT2+8                                               08359000
TCBRCMP  EQU   TCBXTNT2+5                                               08360000
TCBRSVAB EQU   TCBXTNT2+4                                               08361000
TCBGTFA  EQU   TCBGTF+1                                                 08362000
TCBRSV47 EQU   TCBTFLG                                                  08363000
TCBRSV46 EQU   TCBTFLG                                                  08364000
TCBRSV45 EQU   TCBTFLG                                                  08365000
TCBRSV44 EQU   TCBTFLG                                                  08366000
TCBRSV43 EQU   TCBTFLG                                                  08367000
TCBDSPIT EQU   TCBTFLG                                                  08368000
TCBERRTN EQU   TCBTFLG                                                  08369000
TCBASYNC EQU   TCBTFLG                                                  08370000
@NM00003 EQU   TCB+296                                                  08371000
TCBSVCA2 EQU   TCB+292                                                  08372000
TCBSWASA EQU   TCB+288                                                  08373000
TCBDBTB  EQU   TCB+284                                                  08374000
TCBRPT   EQU   TCB+280                                                  08375000
TCBRV141 EQU   TCBRV133                                                 08376000
TCBRV140 EQU   TCBRV133                                                 08377000
TCBRV139 EQU   TCBRV133                                                 08378000
TCBRV138 EQU   TCBRV133                                                 08379000
TCBRV137 EQU   TCBRV133                                                 08380000
TCBRV136 EQU   TCBRV133                                                 08381000
TCBRV135 EQU   TCBRV133                                                 08382000
TCBRV134 EQU   TCBRV133                                                 08383000
TCBRV132 EQU   TCBRV124                                                 08384000
TCBRV131 EQU   TCBRV124                                                 08385000
TCBRV130 EQU   TCBRV124                                                 08386000
TCBRV129 EQU   TCBRV124                                                 08387000
TCBRV128 EQU   TCBRV124                                                 08388000
TCBRV127 EQU   TCBRV124                                                 08389000
TCBRV126 EQU   TCBRV124                                                 08390000
TCBRV125 EQU   TCBRV124                                                 08391000
TCBRV123 EQU   TCBFBYT2                                                 08392000
TCBRV122 EQU   TCBFBYT2                                                 08393000
TCBSSSYN EQU   TCBFBYT2                                                 08394000
TCBFPRAP EQU   TCBFBYT2                                                 08395000
TCBFDW   EQU   TCBFBYT2                                                 08396000
TCBFMW   EQU   TCBFBYT2                                                 08397000
TCBCNCB  EQU   TCBFBYT2                                                 08398000
TCBLLH   EQU   TCBFBYT1                                                 08399000
TCBRV113 EQU   TCBFBYT1                                                 08400000
TCBEOT   EQU   TCBFBYT1                                                 08401000
TCBRTM2  EQU   TCBFBYT1                                                 08402000
TCBPGNLY EQU   TCBFBYT1                                                 08403000
TCBNDIOS EQU   TCBFBYT1                                                 08404000
TCBRV327 EQU   TCBFBYT1                                                 08405000
TCBEOTFM EQU   TCBFBYT1                                                 08406000
TCBRV326 EQU   TCB+272                                                  08407000
TCBUKYSP EQU   TCB+268                                                  08408000
TCBMODE  EQU   TCBESTAE+3                                               08409000
TCBERTYP EQU   TCBESTAE+2                                               08410000
TCBRV314 EQU   TCBESTRM                                                 08411000
TCBRV313 EQU   TCBESTRM                                                 08412000
TCBRV312 EQU   TCBESTRM                                                 08413000
TCBRV311 EQU   TCBESTRM                                                 08414000
TCBRV310 EQU   TCBESTRM                                                 08415000
TCBRV309 EQU   TCBESTRM                                                 08416000
TCBSTAFX EQU   TCBESTRM                                                 08417000
TCBETERM EQU   TCBESTRM                                                 08418000
TCBSCBKY EQU   TCBESTAE                                                 08419000
TCBRTM12 EQU   TCB+260                                                  08420000
TCBSTAWA EQU   TCB+252                                                  08421000
TCBFOEA  EQU   TCBFOE+1                                                 08422000
TCBRSV42 EQU   TCBFOE                                                   08423000
TCBCCPVI EQU   TCBXSCT+2                                                08424000
TCBRV325 EQU   TCBXSCT+1                                                08425000
TCBRV324 EQU   TCBXSCT1                                                 08426000
TCBRV323 EQU   TCBXSCT1                                                 08427000
TCBRV322 EQU   TCBXSCT1                                                 08428000
TCBRV321 EQU   TCBXSCT1                                                 08429000
TCBRV320 EQU   TCBXSCT1                                                 08430000
TCBRV319 EQU   TCBXSCT1                                                 08431000
TCBS3A   EQU   TCBXSCT1                                                 08432000
TCBACTIV EQU   TCBXSCT1                                                 08433000
TCBRSV41 EQU   TCB+239                                                  08434000
TCBRSVAA EQU   TCB+237                                                  08435000
TCBABCUR EQU   TCB+236                                                  08436000
TCBTMSAV EQU   TCB+232                                                  08437000
TCBIOTIM EQU   TCB+228                                                  08438000
TCBRTWA  EQU   TCB+224                                                  08439000
TCBTIRB  EQU   TCB+216                                                  08440000
TCBAECB  EQU   TCB+212                                                  08441000
TCBEXT2A EQU   TCBEXT2+1                                                08442000
TCBRSV39 EQU   TCBEXT2                                                  08443000
TCBSTMCT EQU   TCB+207                                                  08444000
TCBSYSCT EQU   TCB+206                                                  08445000
TCBRSV37 EQU   TCB+205                                                  08446000
TCBEXSVC EQU   TCBDAR                                                   08447000
TCBDARMS EQU   TCBDAR                                                   08448000
TCBDARWT EQU   TCBDAR                                                   08449000
TCBDARO  EQU   TCBDAR                                                   08450000
TCBDARMC EQU   TCBDARC                                                  08451000
TCBDARD  EQU   TCBDAR                                                   08452000
TCBDARS  EQU   TCBDAR                                                   08453000
TCBDARP  EQU   TCBDAR                                                   08454000
TCBGTOFM EQU   TCBFLGS7                                                 08455000
TCBADMP  EQU   TCBFLGS7                                                 08456000
TCBRSTSK EQU   TCBFLGS7                                                 08457000
TCBSVCS  EQU   TCBFLGS7                                                 08458000
TCBSTACK EQU   TCBFLGS7                                                 08459000
TCBRSV34 EQU   TCBFLGS7                                                 08460000
TCBRSV33 EQU   TCBFLGS7                                                 08461000
TCBGPECB EQU   TCBFLGS7                                                 08462000
TCBNTJS  EQU   TCBFLGS6                                                 08463000
TCBAPG   EQU   TCBFLGS6                                                 08464000
TCBMIGR  EQU   TCBFLGS6                                                 08465000
TCBRV303 EQU   TCBFLGS6                                                 08466000
TCBSPVLK EQU   TCBFLGS6                                                 08467000
TCBCPU   EQU   TCBFLGS6                                                 08468000
TCBPIE17 EQU   TCBFLGS6                                                 08469000
TCBRSV79 EQU   TCBNDSP5                                                 08470000
TCBRSV78 EQU   TCBNDSP5                                                 08471000
TCBRSV77 EQU   TCBNDSP5                                                 08472000
TCBRSV76 EQU   TCBNDSP5                                                 08473000
TCBRSV75 EQU   TCBNDSP5                                                 08474000
TCBRSV74 EQU   TCBNDSP5                                                 08475000
TCBRSV95 EQU   TCBNDSP5                                                 08476000
TCBRSV94 EQU   TCBNDSP5                                                 08477000
TCBRSV93 EQU   TCBNDSP4                                                 08478000
TCBRSV92 EQU   TCBNDSP4                                                 08479000
TCBRSV91 EQU   TCBNDSP4                                                 08480000
TCBRSV90 EQU   TCBNDSP4                                                 08481000
TCBRSV89 EQU   TCBNDSP4                                                 08482000
TCBRSV88 EQU   TCBNDSP4                                                 08483000
TCBRSV87 EQU   TCBNDSP4                                                 08484000
TCBRSV86 EQU   TCBNDSP4                                                 08485000
TCBEXT1A EQU   TCBEXT1+1                                                08486000
TCBRSV32 EQU   TCBEXT1                                                  08487000
TCBEXCPD EQU   TCB+192                                                  08488000
TCBIOBRC EQU   TCB+188                                                  08489000
TCBDDWTC EQU   TCB+186                                                  08490000
TCBDDEXC EQU   TCB+184                                                  08491000
@NM00002 EQU   TCBRECDE                                                 08492000
TCBREC   EQU   TCBRECDE                                                 08493000
TCBMDIDS EQU   TCB+176                                                  08494000
TCBNDINT EQU   TCBNDSP3                                                 08495000
TCBRSV27 EQU   TCBNDSP3                                                 08496000
TCBRSV26 EQU   TCBNDSP3                                                 08497000
TCBRSV25 EQU   TCBNDSP3                                                 08498000
TCBRSV24 EQU   TCBNDSP3                                                 08499000
TCBSRBND EQU   TCBNDSP3                                                 08500000
TCBRV302 EQU   TCBNDSP3                                                 08501000
TCBLJSND EQU   TCBNDSP3                                                 08502000
TCBABE   EQU   TCBNDSP2                                                 08503000
TCBDSS   EQU   TCBNDSP2                                                 08504000
TCBOWAIT EQU   TCBNDSP2                                                 08505000
TCBIWAIT EQU   TCBNDSP2                                                 08506000
TCBNDTS  EQU   TCBNDSP2                                                 08507000
TCBNDSVC EQU   TCBNDSP2                                                 08508000
TCBSTPP  EQU   TCBNDSP2                                                 08509000
TCBABD   EQU   TCBNDSP2                                                 08510000
TCBRSV22 EQU   TCBNDSP1                                                 08511000
TCBPIEND EQU   TCBNDSP1                                                 08512000
TCBTPSP  EQU   TCBNDSP1                                                 08513000
TCBDDRND EQU   TCBNDSP1                                                 08514000
TCBRSPND EQU   TCBNDSP1                                                 08515000
TCBRSTND EQU   TCBNDSP1                                                 08516000
TCBDARPN EQU   TCBNDSP1                                                 08517000
TCBDARTN EQU   TCBNDSP1                                                 08518000
TCBNDSP0 EQU   TCBNDSP                                                  08519000
TCBUSER  EQU   TCB+168                                                  08520000
TCBTCTB  EQU   TCBTCT+1                                                 08521000
TCBRSV9C EQU   TCBTCTGF                                                 08522000
TCBRSV9B EQU   TCBTCTGF                                                 08523000
TCBRSV9A EQU   TCBTCTGF                                                 08524000
TCBRSV99 EQU   TCBTCTGF                                                 08525000
TCBRSV98 EQU   TCBTCTGF                                                 08526000
TCBRSV97 EQU   TCBTCTGF                                                 08527000
TCBRSV20 EQU   TCBTCTGF                                                 08528000
TCBSMFGF EQU   TCBTCTGF                                                 08529000
TCBSTCUR EQU   TCBNSTAE                                                 08530000
TCBRV301 EQU   TCBNSTAE                                                 08531000
TCBSYNCH EQU   TCBNSTAE                                                 08532000
TCBHALT  EQU   TCBNSTAE                                                 08533000
TCBPPSUP EQU   TCBNSTAE                                                 08534000
TCB33E   EQU   TCBNSTAE                                                 08535000
TCBQUIES EQU   TCBNSTAE                                                 08536000
TCBAQE   EQU   TCB+156                                                  08537000
TCBTSDP  EQU   TCB+151                                                  08538000
TCBTSLP  EQU   TCB+150                                                  08539000
TCBCPUBN EQU   TCBTSFLG                                                 08540000
TCBDYDSP EQU   TCBTSFLG                                                 08541000
TCBRSV18 EQU   TCBTSFLG                                                 08542000
TCBRSV17 EQU   TCBTSFLG                                                 08543000
TCBTIOTG EQU   TCBTSFLG                                                 08544000
TCBRV300 EQU   TCBTSTSK                                                 08545000
TCBRSV16 EQU   TCBJSTCB                                                 08546000
TCBTQET  EQU   TCBTME                                                   08547000
TCBQEL   EQU   TCBFSA                                                   08548000
TCBGRS15 EQU   TCBGRS+60                                                08549000
TCBGRS14 EQU   TCBGRS+56                                                08550000
TCBGRS13 EQU   TCBGRS+52                                                08551000
TCBGRS8  EQU   TCBGRS+32                                                08552000
TCBGRS7  EQU   TCBGRS+28                                                08553000
TCBGRS2  EQU   TCBGRS+8                                                 08554000
TCBGRS1  EQU   TCBGRS+4                                                 08555000
TCBGRS0  EQU   TCBGRS                                                   08556000
TCBJPQB  EQU   TCBJPQ+1                                                 08557000
TCBRSV15 EQU   TCBPURGE                                                 08558000
TCBRSV14 EQU   TCBPURGE                                                 08559000
TCBRSV13 EQU   TCBPURGE                                                 08560000
TCBRSV12 EQU   TCBPURGE                                                 08561000
TCBRSV11 EQU   TCBPURGE                                                 08562000
TCBRSV10 EQU   TCBPURGE                                                 08563000
TCBRSV09 EQU   TCBPURGE                                                 08564000
TCBJPQF  EQU   TCBPURGE                                                 08565000
TCBLLS   EQU   TCB+36                                                   08566000
TCBPNDSP EQU   TCBFLGS5                                                 08567000
TCBFCD1  EQU   TCBFLGS5                                                 08568000
TCBSTP   EQU   TCBFLGS5                                                 08569000
TCBSYS   EQU   TCBFLGS5                                                 08570000
TCBPAGE  EQU   TCBFLGS5                                                 08571000
TCBUXNDF EQU   TCBABWF                                                  08572000
TCBFC    EQU   TCBFLGS5                                                 08573000
TCBONDSP EQU   TCBFLGS4                                                 08574000
TCBMPCND EQU   TCBFLGS4                                                 08575000
TCBMPCVQ EQU   TCBFLGS4                                                 08576000
TCBUXNDV EQU   TCBFLGS4                                                 08577000
TCBHNDSP EQU   TCBFLGS4                                                 08578000
TCBRQENA EQU   TCBFLGS4                                                 08579000
TCBSER   EQU   TCBFLGS4                                                 08580000
TCBNDUMP EQU   TCBFLGS4                                                 08581000
TCBDWSTA EQU   TCBFLGS3                                                 08582000
TCBRSV08 EQU   TCBFLGS3                                                 08583000
TCBRSV07 EQU   TCBFLGS3                                                 08584000
TCBRSV06 EQU   TCBFLGS3                                                 08585000
TCBABGM  EQU   TCBFLGS3                                                 08586000
TCBABTRM EQU   TCBFLGS3                                                 08587000
TCBADINP EQU   TCBFLGS3                                                 08588000
TCBFTS   EQU   TCBFLGS2                                                 08589000
TCBFDSOP EQU   TCBFLGS2                                                 08590000
TCBFJMC  EQU   TCBFLGS2                                                 08591000
TCBFSMC  EQU   TCBFLGS2                                                 08592000
TCBFABOP EQU   TCBFLGS2                                                 08593000
TCBFSTI  EQU   TCBFLGS2                                                 08594000
TCBFOINP EQU   TCBFLGS2                                                 08595000
TCBFX    EQU   TCBFLGS1                                                 08596000
TCBFS    EQU   TCBFLGS1                                                 08597000
TCBFT    EQU   TCBFLGS1                                                 08598000
TCBPDUMP EQU   TCBFLGS1                                                 08599000
TCBNONPR EQU   TCBFLGS1                                                 08600000
TCBFERA  EQU   TCBFLGS1                                                 08601000
TCBFE    EQU   TCBFLGS1                                                 08602000
TCBFA    EQU   TCBFLGS1                                                 08603000
TCBZERO  EQU   TCBPKF                                                   08604000
TCBFLAG  EQU   TCBPKF                                                   08605000
TCBRSV03 EQU   TCBMSS                                                   08606000
TCBTRNB  EQU   TCBTRN+1                                                 08607000
TCBRSV02 EQU   TCBABF                                                   08608000
TCBOLTEP EQU   TCBABF                                                   08609000
TCBTCPP  EQU   TCBABF                                                   08610000
TCBRSV01 EQU   TCBABF                                                   08611000
TCBGRPH  EQU   TCBABF                                                   08612000
TCBNOCHK EQU   TCBABF                                                   08613000
TCBMOD91 EQU   TCBABF                                                   08614000
TCBCMPC  EQU   TCBCMP+1                                                 08615000
TCBRV318 EQU   TCBCMSG                                                  08616000
TCBRV317 EQU   TCBCIND                                                  08617000
TCBRV316 EQU   TCBCWTO                                                  08618000
TCBCASID EQU   TCBCDBL                                                  08619000
TCBNOCC  EQU   TCBSTCC                                                  08620000
TCBDMPO  EQU   TCBCPP                                                   08621000
TCBCSTEP EQU   TCBCMPF                                                  08622000
TCBCREQ  EQU   TCBCMPF                                                  08623000
TCBDEB   EQU   TCB+8                                                    08624000
TCBPIEA  EQU   TCBPIE+1                                                 08625000
TCBPM    EQU   TCBPMASK                                                 08626000
@NM00001 EQU   TCBPMASK                                                 08627000
TCBFRS6  EQU   TCBFRS+24                                                08628000
TCBFRS4  EQU   TCBFRS+16                                                08629000
TCBFRS2  EQU   TCBFRS+8                                                 08630000
TCBFRS0  EQU   TCBFRS                                                   08631000
@NM00116 EQU   PSA+3668                                                 08632000
PSASTAK  EQU   PSA+3072                                                 08633000
@NM00115 EQU   PSA+1048                                                 08634000
PSAUSEND EQU   PSA+1048                                                 08635000
PSARV062 EQU   PSA+1044                                                 08636000
PSACDAL  EQU   PSA+1040                                                 08637000
PSAWTCOD EQU   PSA+1036                                                 08638000
PSAATCVT EQU   PSA+1032                                                 08639000
PSAPCPSW EQU   PSA+1024                                                 08640000
PSAPIR2  EQU   PSA+1020                                                 08641000
PSARV059 EQU   PSA+1018                                                 08642000
PSASVC13 EQU   PSA+1016                                                 08643000
PSASFACC EQU   PSA+1008                                                 08644000
PSASTOP  EQU   PSA+992                                                  08645000
PSASTART EQU   PSA+976                                                  08646000
PSARSPSW EQU   PSA+968                                                  08647000
PSASRPSW EQU   PSA+960                                                  08648000
PSARV045 EQU   PSA+892                                                  08649000
PSARV044 EQU   PSA+888                                                  08650000
PSARV043 EQU   PSA+884                                                  08651000
PSARV042 EQU   PSA+880                                                  08652000
PSARV041 EQU   PSA+876                                                  08653000
PSARV040 EQU   PSA+872                                                  08654000
PSARV025 EQU   PSA+868                                                  08655000
PSADSSED EQU   PSA+868                                                  08656000
PSADSSPR EQU   PSA+864                                                  08657000
PSADSSFW EQU   PSA+860                                                  08658000
PSADSS14 EQU   PSA+856                                                  08659000
PSADSSPP EQU   PSA+848                                                  08660000
PSADSSRP EQU   PSA+840                                                  08661000
PSADSS05 EQU   PSADSSF4                                                 08662000
PSADSS10 EQU   PSADSSF4                                                 08663000
PSADSSVE EQU   PSADSSF4                                                 08664000
PSADSSDE EQU   PSADSSF4                                                 08665000
PSADSSC0 EQU   PSADSSF4                                                 08666000
PSADSSIE EQU   PSADSSF4                                                 08667000
PSADSS12 EQU   PSADSSF4                                                 08668000
PSADSSRC EQU   PSADSSF4                                                 08669000
PSARV057 EQU   PSADSSF3                                                 08670000
PSARV056 EQU   PSADSSF3                                                 08671000
PSARV055 EQU   PSADSSF3                                                 08672000
PSADSSMC EQU   PSADSSF3                                                 08673000
PSADSSRW EQU   PSADSSF3                                                 08674000
PSADSSNM EQU   PSADSSF3                                                 08675000
PSADSSES EQU   PSADSSF3                                                 08676000
PSADSSGP EQU   PSADSSF3                                                 08677000
PSADSSF2 EQU   PSADSSFL+1                                               08678000
PSADSSPI EQU   PSADSSF1                                                 08679000
PSADSSOI EQU   PSADSSF1                                                 08680000
PSADSSSP EQU   PSADSSF1                                                 08681000
PSADSSTP EQU   PSADSSF1                                                 08682000
PSADSSDW EQU   PSADSSF1                                                 08683000
PSADSSDD EQU   PSADSSF1                                                 08684000
PSADSSDM EQU   PSADSSF1                                                 08685000
PSADSSMV EQU   PSADSSF1                                                 08686000
PSADSSTS EQU   PSA+816                                                  08687000
PSADSSWK EQU   PSA+812                                                  08688000
PSADSSR3 EQU   PSA+808                                                  08689000
PSADSSR2 EQU   PSA+804                                                  08690000
PSADSSRS EQU   PSA+800                                                  08691000
PSASTOR  EQU   PSA+796                                                  08692000
PSACPUSA EQU   PSA+794                                                  08693000
PSAVSTAP EQU   PSA+792                                                  08694000
PSAWKVAP EQU   PSA+788                                                  08695000
PSAWKRAP EQU   PSA+784                                                  08696000
PSAMCHIC EQU   PSA+783                                                  08697000
PSARV061 EQU   PSA+782                                                  08698000
PSASYMSK EQU   PSA+781                                                  08699000
PSAMCHFL EQU   PSA+780                                                  08700000
PSACR0   EQU   PSA+776                                                  08701000
PSAPSWSV EQU   PSA+768                                                  08702000
PSACLHS  EQU   PSAHLHI                                                  08703000
PSALKR15 EQU   PSALKSA+60                                               08704000
PSALKR14 EQU   PSALKSA+56                                               08705000
PSALKR13 EQU   PSALKSA+52                                               08706000
PSALKR12 EQU   PSALKSA+48                                               08707000
PSALKR11 EQU   PSALKSA+44                                               08708000
PSALKR10 EQU   PSALKSA+40                                               08709000
PSALKR9  EQU   PSALKSA+36                                               08710000
PSALKR8  EQU   PSALKSA+32                                               08711000
PSALKR7  EQU   PSALKSA+28                                               08712000
PSALKR6  EQU   PSALKSA+24                                               08713000
PSALKR5  EQU   PSALKSA+20                                               08714000
PSALKR4  EQU   PSALKSA+16                                               08715000
PSALKR3  EQU   PSALKSA+12                                               08716000
PSALKR2  EQU   PSALKSA+8                                                08717000
PSALKR1  EQU   PSALKSA+4                                                08718000
PSALKR0  EQU   PSALKSA                                                  08719000
PSARV023 EQU   PSACLHT+52                                               08720000
PSALOCAL EQU   PSACLHT+48                                               08721000
PSACMSL  EQU   PSACLHT+44                                               08722000
PSAOPTL  EQU   PSACLHT+40                                               08723000
PSATPACL EQU   PSACLHT+36                                               08724000
PSATPDNL EQU   PSACLHT+32                                               08725000
PSATPNCL EQU   PSACLHT+28                                               08726000
PSAIOSLL EQU   PSACLHT+24                                               08727000
PSAIOSUL EQU   PSACLHT+20                                               08728000
PSAIOSCL EQU   PSACLHT+16                                               08729000
PSAIOSSL EQU   PSACLHT+12                                               08730000
PSASALCL EQU   PSACLHT+8                                                08731000
PSAASML  EQU   PSACLHT+4                                                08732000
PSADISPL EQU   PSACLHT                                                  08733000
PSASRSA  EQU   PSA+636                                                  08734000
PSARV050 EQU   PSA+634                                                  08735000
PSADSSGO EQU   PSA+633                                                  08736000
PSARECUR EQU   PSA+632                                                  08737000
PSAHLHIS EQU   PSA+628                                                  08738000
PSAIPCSA EQU   PSA+624                                                  08739000
@NM00114 EQU   PSA+621                                                  08740000
PSAIPCDM EQU   PSA+620                                                  08741000
PSAIPCD  EQU   PSA+616                                                  08742000
@NM00113 EQU   PSA+613                                                  08743000
PSAIPCRM EQU   PSA+612                                                  08744000
PSAIPCR  EQU   PSA+608                                                  08745000
PSAMCHEX EQU   PSA+600                                                  08746000
PSAMPSW  EQU   PSA+592                                                  08747000
PSAEXPS2 EQU   PSA+584                                                  08748000
PSAEXPS1 EQU   PSA+576                                                  08749000
PSAPIREG EQU   PSA+572                                                  08750000
PSARSREG EQU   PSA+568                                                  08751000
PSAGPREG EQU   PSA+556                                                  08752000
PSARV022 EQU   PSASUP4                                                  08753000
PSARV021 EQU   PSASUP4                                                  08754000
PSARV020 EQU   PSASUP4                                                  08755000
PSARV019 EQU   PSASUP4                                                  08756000
PSARV018 EQU   PSASUP4                                                  08757000
PSARV017 EQU   PSASUP4                                                  08758000
PSARV016 EQU   PSASUP4                                                  08759000
PSARV015 EQU   PSASUP4                                                  08760000
PSARV014 EQU   PSASUP3                                                  08761000
PSAULCMS EQU   PSASUP3                                                  08762000
PSARV012 EQU   PSASUP3                                                  08763000
PSAESTA  EQU   PSASUP3                                                  08764000
PSASPR   EQU   PSASUP3                                                  08765000
PSAPSREG EQU   PSASUP3                                                  08766000
PSAPI2   EQU   PSASUP3                                                  08767000
PSAIOSUP EQU   PSASUP3                                                  08768000
PSALCR   EQU   PSASUP2                                                  08769000
PSARTM   EQU   PSASUP2                                                  08770000
PSAACR   EQU   PSASUP2                                                  08771000
PSAIPCE2 EQU   PSASUP2                                                  08772000
PSAIPCES EQU   PSASUP2                                                  08773000
PSAIPCEC EQU   PSASUP2                                                  08774000
PSAGTF   EQU   PSASUP2                                                  08775000
PSAIPCRI EQU   PSASUP2                                                  08776000
PSATYPE6 EQU   PSASUP1                                                  08777000
PSATCTL  EQU   PSASUP1                                                  08778000
PSADISP  EQU   PSASUP1                                                  08779000
PSALOCK  EQU   PSASUP1                                                  08780000
PSAPI    EQU   PSASUP1                                                  08781000
PSAEXT   EQU   PSASUP1                                                  08782000
PSASVC   EQU   PSASUP1                                                  08783000
PSAIO    EQU   PSASUP1                                                  08784000
PSAANEW  EQU   PSA+544                                                  08785000
PSATOLD  EQU   PSA+540                                                  08786000
PSATNEW  EQU   PSA+536                                                  08787000
PSALCCAR EQU   PSA+532                                                  08788000
PSALCCAV EQU   PSA+528                                                  08789000
PSAPCCAR EQU   PSA+524                                                  08790000
PSAPCCAV EQU   PSA+520                                                  08791000
PSACPULA EQU   PSA+518                                                  08792000
PSACPUPA EQU   PSA+516                                                  08793000
PSAPSA   EQU   PSA+512                                                  08794000
FLCHDEND EQU   PSA+512                                                  08795000
FLCCRSAV EQU   FLCMCLA+280                                              08796000
FLCGRSAV EQU   FLCMCLA+216                                              08797000
FLCFPSAV EQU   FLCMCLA+184                                              08798000
FLCFLA   EQU   FLCMCLA+88                                               08799000
FLCRGNCD EQU   FLCMCLA+84                                               08800000
FLCFSAA  EQU   FLCFSA+1                                                 08801000
@NM00112 EQU   FLCFSA                                                   08802000
@NM00111 EQU   FLCMCLA+72                                               08803000
FLCMCIC  EQU   FLCMCLA+64                                               08804000
@NM00110 EQU   FLCMCLA+20                                               08805000
FLCIOAA  EQU   FLCIOA+1                                                 08806000
@NM00109 EQU   FLCIOA                                                   08807000
@NM00108 EQU   FLCMCLA+15                                               08808000
@NM00107 EQU   FLCMCLA+14                                               08809000
@NM00106 EQU   FLCMCLA+12                                               08810000
FLCLCL   EQU   FLCMCLA+8                                                08811000
FLCIOELA EQU   FLCIOEL+1                                                08812000
@NM00105 EQU   FLCIOEL                                                  08813000
FLCCHNID EQU   FLCMCLA                                                  08814000
@NM00104 EQU   PSA+160                                                  08815000
FLCMTRCD EQU   PSA+157                                                  08816000
@NM00103 EQU   PSA+156                                                  08817000
FLCPERA  EQU   FLCPER+1                                                 08818000
@NM00102 EQU   FLCPER                                                   08819000
@NM00101 EQU   PSA+151                                                  08820000
FLCPERCD EQU   PSA+150                                                  08821000
FLCMCNUM EQU   PSA+149                                                  08822000
@NM00100 EQU   PSA+148                                                  08823000
FLCTEAA  EQU   FLCTEA+1                                                 08824000
@NM00099 EQU   FLCTEA                                                   08825000
PSAPIPC  EQU   PSAPICOD                                                 08826000
PSAPIMC  EQU   PSAPICOD                                                 08827000
PSAPIPER EQU   PSAPICOD                                                 08828000
PSARV049 EQU   FLCPICOD                                                 08829000
FLCPILCB EQU   FLCPIILC                                                 08830000
@NM00098 EQU   FLCPIILC                                                 08831000
@NM00097 EQU   PSAEPPSW                                                 08832000
FLCSVCN  EQU   PSAESPSW+2                                               08833000
FLCSILCB EQU   FLCSVILC                                                 08834000
@NM00096 EQU   FLCSVILC                                                 08835000
@NM00095 EQU   PSAESPSW                                                 08836000
FLCEICOD EQU   PSAEEPSW+2                                               08837000
PSASPAD  EQU   PSAEEPSW                                                 08838000
@NM00094 EQU   PSA+128                                                  08839000
FLCINPSW EQU   PSA+120                                                  08840000
FLCMNPSW EQU   PSA+112                                                  08841000
FLCPNPSW EQU   PSA+104                                                  08842000
FLCSNPSW EQU   PSA+96                                                   08843000
FLCENPSW EQU   PSA+88                                                   08844000
FLCTRACE EQU   PSA+84                                                   08845000
FLCTIMER EQU   PSA+80                                                   08846000
FLCCVT2  EQU   PSA+76                                                   08847000
FLCCAW   EQU   PSA+72                                                   08848000
FLCCSW   EQU   PSA+64                                                   08849000
FLCIOPSW EQU   PSA+56                                                   08850000
FLCMOPSW EQU   PSA+48                                                   08851000
FLCPOPSW EQU   PSA+40                                                   08852000
FLCSOPSW EQU   PSA+32                                                   08853000
FLCEOPSW EQU   PSA+24                                                   08854000
@NM00093 EQU   FLCICCW2+4                                               08855000
FLCCVT   EQU   FLCICCW2                                                 08856000
FLCICCW1 EQU   FLCROPSW                                                 08857000
FLCIPPSW EQU   FLCRNPSW                                                 08858000
*                                      END UNREFERENCED COMPONENTS      08859000
@RT00180 EQU   AT001000                                                 08860000
@RT00186 EQU   AT001000                                                 08861000
@RF00199 EQU   @RC00195                                                 08862000
@RF00212 EQU   @RC00195                                                 08863000
@RC00202 EQU   @RC00195                                                 08864000
@RT00232 EQU   AT001000                                                 08865000
@RT00238 EQU   AT001000                                                 08866000
@RT00283 EQU   AT001000                                                 08867000
@RT00295 EQU   AT001000                                                 08868000
@RT00303 EQU   AT001000                                                 08869000
@RT00311 EQU   AT001000                                                 08870000
@RT00318 EQU   AT001000                                                 08871000
@RT00442 EQU   AT001090                                                 08872000
@RT00450 EQU   AT001390                                                 08873000
@RT00470 EQU   AT001390                                                 08874000
@RT00508 EQU   AT001390                                                 08875000
@RC00582 EQU   @RC00581                                                 08876000
@RT00760 EQU   AT001410                                                 08877000
@RT00769 EQU   AT001400                                                 08878000
@RF00790 EQU   @EL00006                                                 08879000
@RC00792 EQU   @EL00006                                                 08880000
@RF00808 EQU   AT001350                                                 08881000
@RT00854 EQU   AT001150                                                 08882000
@RT00905 EQU   AT001610                                                 08883000
@RT00911 EQU   AT001600                                                 08884000
@RT00932 EQU   AT001600                                                 08885000
AT001620 EQU   @EL00011                                                 08886000
@RT01118 EQU   AT001460                                                 08887000
@RT01122 EQU   AT001480                                                 08888000
@RT01134 EQU   AT001490                                                 08889000
@RF01144 EQU   AT001460                                                 08890000
@RT01153 EQU   AT001480                                                 08891000
@RT01161 EQU   AT001480                                                 08892000
@RC01111 EQU   @RC01109                                                 08893000
@RT01171 EQU   AT001480                                                 08894000
@RT01175 EQU   AT001480                                                 08895000
@RT01211 EQU   AT001510                                                 08896000
@RT01232 EQU   AT001500                                                 08897000
@RT01271 EQU   AT001430                                                 08898000
@RT01436 EQU   AT001650                                                 08899000
@RT01503 EQU   AT001660                                                 08900000
@RT01509 EQU   AT001660                                                 08901000
@RT01629 EQU   AT001740                                                 08902000
@RT01632 EQU   AT001740                                                 08903000
@RC01644 EQU   @RC01635                                                 08904000
@RC01700 EQU   @RC01691                                                 08905000
@RF00204 EQU   @RC00202                                                 08906000
@RT01094 EQU   AT001620                                                 08907000
@ENDDATA EQU   *                                                        08908000
         END   IGC0004B,(C'PLS2130',0701,78095)                         08909000
