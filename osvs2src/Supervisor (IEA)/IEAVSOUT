         TITLE 'IEAVSOUT: SWAP OUT                                     *00001000
                        '                                               00002000
*                                                        /*@Z40WPYC */  00003000
IEAVSOUT CSECT                                                          00004000
         USING *,R15                                                    00005000
         MODID                                                          00006000
         ENTRY IEAVSOU2                   @Z40WPYC                      00007000
IEAVSOU2 DS    0H                         @Z40WPYC                      00008000
OFFSET16 EQU   16                     OFFSET INTO SAVE AREA             00009000
         STM   R2,R14,OFFSET16(R13)                                     00010000
         DROP  R15                                                      00011000
         BALR  BASEREG,0              ESTABLISH BASE REGISTER           00012000
         USING *,BASEREG                                                00013000
         USING *+4094,BASEREG2                                          00014000
         LA    BASEREG2,4094(BASEREG) ADJUST BASE REGISTER              00015000
*   R5=R13;                         /* SAVE R13 OVER CALL            */ 00016000
*                                                                  0114 00017000
         LR    R5,R13                                              0114 00018000
*   /*****************************************************************/ 00019000
*   /*                                                               */ 00020000
*   /* CALL STATUS STOP NON-QUIESABLE SRBS AND SET THE REAL STORAGE  */ 00021000
*   /* MANAGEMENT FRR                                                */ 00022000
*   /*                                                               */ 00023000
*   /*****************************************************************/ 00024000
*                                                                  0115 00025000
*   R15=ADDR(IEAVSSNQ);             /* GET ENTRY POINT ADDRESS       */ 00026000
         L     R15,@CV02498                                        0115 00027000
*   GEN REFS(R15) SETS(R11,R12,R13,R14,R15) NOFLOWS;               0116 00028000
*                                                                  0116 00029000
         BALR  R15,R15                RETURN IS ON R15                  00030000
*   /*****************************************************************/ 00031000
*   /*                                                               */ 00032000
*   /* IF A MEMORY TERMINATION IS ALREADY IN PROCESS IEAVSOUT WILL   */ 00033000
*   /* RETURN TO RCT AS IF SWAPOUT WAS SUCCESSFUL. THIS WILL FORCE   */ 00034000
*   /* RCT TO WAIT. SINCE THE MEMORY IS TERMINATED IT IS NOT         */ 00035000
*   /* NECESSARY THAT RCT BE POSTED. SRM WILL BE NOTIFIED BY MEMORY  */ 00036000
*   /* DELETE PROCESSING.                                            */ 00037000
*   /*                                                               */ 00038000
*   /*****************************************************************/ 00039000
*                                                                  0117 00040000
*   IF R1->ASCBTERM='1'B THEN       /* IF ALREADY IN PROCESS OF    0117 00041000
*                                      TERMINATION, RETURN   @Z40WPYC*/ 00042000
         TM    ASCBTERM(R1),B'00010000'                            0117 00043000
         BNO   @RF00117                                            0117 00044000
*     DO;                           /* RETURN                @Z40WPYC*/ 00045000
*       GENERATE NODEFS REFS(R2,R5,R14,R15) NOSETS NOFLOWS;        0119 00046000
        SR  R15,R15   INDICATE SUCCESSFUL SWAPOUT           @Z40WPYC    00047000
        LM  R2,R14,OFFSET16(R5) RESTORE CALLERS REGS        @Z40WPYC    00048000
        BR  R14                 RETURN TO RCT               @Z40WPYC    00049000
*     END;                          /* END OF RETURN PROCESSING    0120 00050000
*                                                            @Z40WPYC*/ 00051000
*   ELSE                                                           0121 00052000
*     ;                             /* NOT MEMTERM - CONTINUE      0121 00053000
*                                                            @Z40WPYC*/ 00054000
@RF00117 DS    0H                                                  0122 00055000
*   RFY                                                            0122 00056000
*    (R15) UNRSTD;                                                 0122 00057000
*   RFY                                                            0123 00058000
*    (R11) RSTD;                                                   0123 00059000
*   PVTPTR=CVTPVTP;                 /* GET PVT ADDRESS               */ 00060000
         L     @12,CVTPTR                                          0124 00061000
         L     PVTPTR,CVTPVTP(,@12)                                0124 00062000
*   R1=PVTPRCV;                     /* GET THE ENTRY POINT TO THE RSM   00063000
*                                      RECOVERY ROUTINE              */ 00064000
*                                                                  0125 00065000
         L     R1,PVTPRCV(,PVTPTR)                                 0125 00066000
*   /*****************************************************************/ 00067000
*   /*                                                               */ 00068000
*   /* SET THE FRR                                                   */ 00069000
*   /*                                                               */ 00070000
*   /*****************************************************************/ 00071000
*                                                                  0126 00072000
*GETFRR:                                                           0126 00073000
*   GENERATE CODE REFS(PSA,PSACSTK,FRRSCURR,FRRS,FRRSELEN,FRRSCURR,     00074000
*       FRRSFRRA,FRRSLAST,FRRSENTR,FRRSPARM) SETS(R1,R11,R12);     0126 00075000
GETFRR   DS    0H                                                  0126 00076000
         SETFRR A,FRRAD=(1),PARMAD=(1),WRKREGS=(11,12),               **00077000
               RELATED=(RSM,IEAVSOUT(FREEFRR))                          00078000
*   R1->RCACSECT=RCACSPOT;          /* SET CSECT ID                  */ 00079000
         MVI   RCACSECT(R1),X'1A'                                  0127 00080000
*   R1->RCASOUT='1'B;               /* SET MODULE ENTERED BIT        */ 00081000
         OI    RCASOUT(R1),B'10000000'                             0128 00082000
*   RFY                                                            0129 00083000
*    (R14) RSTD;                                                   0129 00084000
*                                                                  0129 00085000
*   /*****************************************************************/ 00086000
*   /*                                                               */ 00087000
*   /* GET THE SALLOC LOCK, AND TEST FOR A ZERO SPCT ADDRESS. NON    */ 00088000
*   /* SWAPPABLE ADDRESS SPACES DO NOT HAVE SWAP CONTROL TABLES      */ 00089000
*   /*                                                               */ 00090000
*   /*****************************************************************/ 00091000
*                                                                  0130 00092000
*GETSALL:                                                          0130 00093000
*   GENERATE CODE REFS(PSALITA,FLC) SETS(R11,R12,R13,R14);         0130 00094000
GETSALL  DS    0H                                                  0130 00095000
         SETLOCK OBTAIN,TYPE=SALLOC,MODE=UNCOND,                      **00096000
               RELATED=(RSM,IEAVSOUT(FREESALL))                         00097000
*   PVTPRCA=R1;                     /* SAVE THE ADDRESS OF THE RCA   */ 00098000
         ST    R1,PVTPRCA(,PVTPTR)                                 0131 00099000
*   R1->RCASAL='1'B;                /* SET SALLOC LOCK HELD BIT      */ 00100000
         OI    RCASAL(R1),B'10000000'                              0132 00101000
*   WORKAREA=WORKAREA&&WORKAREA;    /* CLEAR WORK SAVE AREA, INCLUDES   00102000
*                                      SETTING ALL INTERNAL FLAGS TO    00103000
*                                      ZERO.                         */ 00104000
         XC    WORKAREA(72,PVTPTR),WORKAREA(PVTPTR)                0133 00105000
*   CALLER13=R5;                    /* SAVE REG 13                   */ 00106000
         ST    R5,CALLER13(,PVTPTR)                                0134 00107000
*   RFY                                                            0135 00108000
*    (R5,                                                          0135 00109000
*     R11,                                                         0135 00110000
*     R14) UNRSTD;                                                 0135 00111000
*   SAVERCA=R1;                     /* SAVE THE RCA ADDRESS TO     0136 00112000
*                                      RESTORE IT AFTER ANY VSM CALL */ 00113000
         L     @12,CALLER13(,PVTPTR)                               0136 00114000
         ST    R1,SAVERCA(,@12)                                    0136 00115000
*   RSMHDPTR=ASCBRSM;               /* GET THE RSM HEADER ADDRESS    */ 00116000
         L     @12,ASCBPTR                                         0137 00117000
         L     RSMHDPTR,ASCBRSM(,@12)                              0137 00118000
*   SPCTPTR=RSMSPCT;                /* GET THE ADDRESS OF THE SPCT   */ 00119000
         L     @12,RSMSPCT(,RSMHDPTR)                              0138 00120000
         LR    SPCTPTR,@12                                         0138 00121000
*   IF RSMSPCT=0 THEN               /* TEST IF SPCT EXISTS           */ 00122000
         LTR   @12,@12                                             0139 00123000
         BNZ   @RF00139                                            0139 00124000
*     DO;                           /* ERROR HAS OCCURRED. RECORD  0140 00125000
*                                      ERROR THEN RETURN TO RCT WITH    00126000
*                                      A BAD RETURN CODE             */ 00127000
*       R0='12'X;                   /* NO SPCT EXISTS                */ 00128000
         LA    R0,18                                               0141 00129000
*       CALL DOABEND;               /* RECORD THE ERROR.             */ 00130000
         BAL   @14,DOABEND                                         0142 00131000
*       RETNCODE=BADCALL;           /* SET RETURN CODE TO SHOW SWAP     00132000
*                                      OUT WAS NOT DONE.             */ 00133000
         MVC   RETNCODE(4,PVTPTR),@CF00039                         0143 00134000
*       GO TO RETN;                 /* GO TO THE EXIT POINT.         */ 00135000
         B     RETN                                                0144 00136000
*     END;                                                         0145 00137000
*   SPCTOUT='1'B;                   /* SET SWAP OUT FLAG             */ 00138000
@RF00139 OI    SPCTOUT(SPCTPTR),B'01000000'                        0146 00139000
*                                                                  0147 00140000
*   /*****************************************************************/ 00141000
*   /*                                                               */ 00142000
*   /* MUST AVOID USING LOCATION ZERO AS A PCB WHEN WE INITIALIZE ALL*/ 00143000
*   /* PCBS. THERE MUST BE AT LEAST A FRAME COUNT OF 1 FOR THE ONE   */ 00144000
*   /* LSQA FRAME WHICH MUST BE THERE                                */ 00145000
*   /*                                                               */ 00146000
*   /*****************************************************************/ 00147000
*                                                                  0147 00148000
*   IF ASCBFMCT=0 THEN                                             0147 00149000
         L     @12,ASCBPTR                                         0147 00150000
         LH    @12,ASCBFMCT(,@12)                                  0147 00151000
         LTR   @12,@12                                             0147 00152000
         BNZ   @RF00147                                            0147 00153000
*     DO;                                                          0148 00154000
*       R0='17'X;                   /* RECORD ERROR IN FRAME COUNT 0149 00155000
*                                      AND DO NOT ATTEMPT ANY FIX UP    00156000
*                                      AS THE LSQA PROCESSOR DEPENDS    00157000
*                                      ON THE EXISTANCE OF ONE LSQA     00158000
*                                      FRAME                         */ 00159000
         LA    R0,23                                               0149 00160000
*       CALL DOABEND;               /* RECORD ERROR IN FRAME COUNT   */ 00161000
         BAL   @14,DOABEND                                         0150 00162000
*       GO TO CLEANUP2;             /* GO ABORT SWAP                 */ 00163000
         B     CLEANUP2                                            0151 00164000
*     END;                                                         0152 00165000
*                                                                  0153 00166000
*   /*****************************************************************/ 00167000
*   /*                                                               */ 00168000
*   /* GET ENOUGH PCBS TO SWAP OUT EVERY PRIVATE AREA FRAME IN USE BY*/ 00169000
*   /* THIS ADDRESS SPACE PLUS 1. THIS EXTRA PCB IS USED AS AN AREA  */ 00170000
*   /* TO CONTAIN A PARAMETER LIST TO BE PASSED TO SRM WHEN THE      */ 00171000
*   /* SWAPOUT SYSEVENT IS ISSUED BY IEAVSWPC. IF THE BUILD FAILS,   */ 00172000
*   /* SET A NONZERO RETURN CODE SO RCT WILL RESTORE THE ADDRESS     */ 00173000
*   /* SPACE.                                                        */ 00174000
*   /*                                                               */ 00175000
*   /*****************************************************************/ 00176000
*                                                                  0153 00177000
*   FMCTASCB=ASCBFMCT;              /* SAVE FRAME COUNT AT BEGINNING    00178000
*                                      OF SWAP OUT                   */ 00179000
@RF00147 L     @12,ASCBPTR                                         0153 00180000
         LH    @12,ASCBFMCT(,@12)                                  0153 00181000
         STH   @12,FMCTASCB(,PVTPTR)                               0153 00182000
*   R0=ASCBFMCT+1;                  /* NUMBER OF PCBS DESIRED        */ 00183000
         AL    @12,@CF00064                                        0154 00184000
         LR    R0,@12                                              0154 00185000
*   R1=0;                           /* MAKE IT A BUILD OPTION        */ 00186000
         SLR   R1,R1                                               0155 00187000
*   CALL IEAVPCB;                   /* GET PCBS                      */ 00188000
         L     @15,PVTPCB(,PVTPTR)                                 0156 00189000
         BALR  @14,@15                                             0156 00190000
*   IF R15^=0 THEN                  /* CHECK RETURN CODE             */ 00191000
         LTR   R15,R15                                             0157 00192000
         BZ    @RF00157                                            0157 00193000
*     DO;                                                          0158 00194000
*       R0='0E'X;                   /* RECORD PCB MANAGER ERROR      */ 00195000
         LA    R0,14                                               0159 00196000
*       CALL DOABEND;               /* RECORD THE ERROR.             */ 00197000
         BAL   @14,DOABEND                                         0160 00198000
*       GO TO CLEANUP2;             /* GO FREE SRB AND THEN EXIT     */ 00199000
         B     CLEANUP2                                            0161 00200000
*     END;                                                         0162 00201000
*   PTRPCBS=R1;                     /* SAVE ADDRESS OF PCBS          */ 00202000
@RF00157 STCM  R1,7,PTRPCBS(PVTPTR)                                0163 00203000
*   RFY                                                            0164 00204000
*    (R15) UNRSTD;                                                 0164 00205000
*                                                                  0165 00206000
*   /*****************************************************************/ 00207000
*   /*                                                               */ 00208000
*   /* INITIALIZE THE SPCT FOR SWAP OUT PROCESSING                   */ 00209000
*   /*                                                               */ 00210000
*   /*****************************************************************/ 00211000
*                                                                  0165 00212000
*   SPCTSWRT=0;                     /* ENSURE PTR TO SRM WORKAREA IS    00213000
*                                      ZEROED                @Z40WPYC*/ 00214000
         SLR   @12,@12                                             0165 00215000
         ST    @12,SPCTSWRT(,SPCTPTR)                              0165 00216000
*   SPCTLSQA=0;                     /* ZERO NUMBER OF LSQA ENTRIES   */ 00217000
         STH   @12,SPCTLSQA(,SPCTPTR)                              0166 00218000
*   SPCTFIX=0;                      /* ZERO NUMBER OF FIX ENTRIES    */ 00219000
         STH   @12,SPCTFIX(,SPCTPTR)                               0167 00220000
*   SPCTPURG='0'B;                  /* CLEAR PURGE FLAG              */ 00221000
*   SPCTSWIN='0'B;                  /* CLEAR SWAP IN FLAG            */ 00222000
*   SPCTPSET='0'B;                  /* ZERO LSQA PAGE DATASET FLAG 0170 00223000
*                                                            @Z40WPYC*/ 00224000
         NI    SPCTPURG(SPCTPTR),B'01010111'                       0170 00225000
*   SPCTWSSZ=0;                     /* INITIALIZE WORKING SET SIZE   */ 00226000
         STH   @12,SPCTWSSZ(,SPCTPTR)                              0171 00227000
*   RFY                                                            0172 00228000
*    (R11,                                                         0172 00229000
*     R12) RSTD;                                                   0172 00230000
*   R12=ADDR(SPCTSWAP);             /* GET ADDRESS OF SWAP ENTRIES 0173 00231000
*                                      AREA                          */ 00232000
         LA    R12,SPCTSWAP(,SPCTPTR)                              0173 00233000
*   R12->SPCTENT=R12->SPCTENT&&R12->SPCTENT;/* ZERO OLD SWAP ENTRIES */ 00234000
*                                                                  0174 00235000
         XC    SPCTENT(48,R12),SPCTENT(R12)                        0174 00236000
*   /*****************************************************************/ 00237000
*   /*                                                               */ 00238000
*   /* CLEAR BIT MASK OF EACH SEGMENT ENTRY IN SPCT                  */ 00239000
*   /*                                                               */ 00240000
*   /*****************************************************************/ 00241000
*                                                                  0175 00242000
*   R0=0;                           /* GET A ZERO                    */ 00243000
         SLR   R0,R0                                               0175 00244000
*   R11=LENGTH(SPCTSEGE);           /* GET LENGTH TO USE AS INCREMENT*/ 00245000
         LA    R11,6                                               0176 00246000
*   R12=ADDR(SPCTSEGS)+R11*(SPCTSSEG-1);/* CALCULATE ENDING ADDRESS  */ 00247000
         LA    R12,SPCTSEGS(,SPCTPTR)                              0177 00248000
         SLR   @05,@05                                             0177 00249000
         IC    @05,SPCTSSEG(,SPCTPTR)                              0177 00250000
         BCTR  @05,0                                               0177 00251000
         MR    @04,R11                                             0177 00252000
         ALR   R12,@05                                             0177 00253000
*STOPHIST:                                                         0178 00254000
*   DO R1=ADDR(SPCTSEGS) BY R11 TO R12;/* THE LABEL IS TO PREVENT PLS   00255000
*                                      FROM GENERATING HISTORY     0178 00256000
*                                      TEMPORARY STORAGE             */ 00257000
STOPHIST LA    R1,SPCTSEGS(,SPCTPTR)                               0178 00258000
         B     @DE00178                                            0178 00259000
@DL00178 DS    0H                                                  0179 00260000
*     R1->SPCTBITM=R0;              /* CLEAR A BIT MASK TO ZERO      */ 00261000
         STH   R0,SPCTBITM(,R1)                                    0179 00262000
*   END;                                                           0180 00263000
         ALR   R1,R11                                              0180 00264000
@DE00178 CR    R1,R12                                              0180 00265000
         BNH   @DL00178                                            0180 00266000
*   RFY                                                            0181 00267000
*    (R11,                                                         0181 00268000
*     R12) UNRSTD;                                                 0181 00269000
*                                                                  0182 00270000
*   /*****************************************************************/ 00271000
*   /*                                                               */ 00272000
*   /* MAINLINE SETUP IS NOW DONE. CALL THE VARIOUS SUBROUTINES TO   */ 00273000
*   /* GET THE WORK DONE.                                            */ 00274000
*   /*                                                               */ 00275000
*   /*****************************************************************/ 00276000
*                                                                  0182 00277000
*   RFY                                                            0182 00278000
*    (ENDPTR,                                                      0182 00279000
*     SWAPPTR) RSTD;                /* SWAPPTR IS PASSED BACK BY   0182 00280000
*                                      LSQANTRY                      */ 00281000
*   CALL LSQANTRY;                  /* CALL SUBROUTINE TO BUILD LSQA    00282000
*                                      ENTRIES                       */ 00283000
*                                                                  0183 00284000
         BAL   @14,LSQANTRY                                        0183 00285000
*   /*****************************************************************/ 00286000
*   /*                                                               */ 00287000
*   /* IF HERE, ALL LSQA FRAMES HAVE BEEN PROCESSED. POINTERS MUST BE*/ 00288000
*   /* SET UP FOR THE FIX PROCESSOR WHICH IS NEXT. THESE ADD AND     */ 00289000
*   /* SHIFT OPER WILL ROUND SWAPPTR TO THE NEXT DOUBLE- WORD        */ 00290000
*   /* BOUNDARY IF ALREADY ON A DOUBLE-WORD BOUNDARY,THE OPER WILL   */ 00291000
*   /* NOT CHANGE IT.                                                */ 00292000
*   /*                                                               */ 00293000
*   /*****************************************************************/ 00294000
*                                                                  0184 00295000
*   GENERATE CODE;                                                 0184 00296000
         LA    SWAPPTR,7(SWAPPTR)    ADD SEVEN TO SWAPPTR @Z40WPYC      00297000
         SRL   SWAPPTR,3             CLEAR LOW 3 BITS     @Z40WPYC      00298000
         SLL   SWAPPTR,3             RESTORE REGISTER     @Z40WPYC      00299000
*   IF SWAPPTR=ENDPTR THEN          /* TEST IF THE EXTENSION HAS NO     00300000
*                                      MORE ROOM.                    */ 00301000
         CR    SWAPPTR,ENDPTR                                      0185 00302000
         BNE   @RF00185                                            0185 00303000
*     DO;                           /* EXTENSION IS FULL. FIX      0186 00304000
*                                      PROCESSOR IS NEVER PASSED A 0186 00305000
*                                      FULL EXTENSION. GET AN      0186 00306000
*                                      ADDITIONAL EXTENSION.         */ 00307000
*       RESPECIFY                                                  0187 00308000
*        (BEGPTR) RESTRICTED;                                      0187 00309000
*       BEGPTR=BEGEXT;              /* GET THE ADDRESS OF THE      0188 00310000
*                                      EXTENSION BEGINNING.          */ 00311000
         L     BEGPTR,BEGEXT(,PVTPTR)                              0188 00312000
*       CALL GETEXT;                /* CALL SUBROUTINE TO GET AN   0189 00313000
*                                      ADDITIONAL EXTENSION.         */ 00314000
         BAL   @14,GETEXT                                          0189 00315000
*       RESPECIFY                                                  0190 00316000
*        (BEGPTR) UNRESTRICTED;                                    0190 00317000
*                                                                  0190 00318000
*       /*************************************************************/ 00319000
*       /*                                                           */ 00320000
*       /* IF CONTROL COMES HERE FROM THE GETEXT SUBROUTINE, AN      */ 00321000
*       /* ADDITIONAL EXTENSION WAS OBTAINED SUCCESSFULLY.           */ 00322000
*       /*                                                           */ 00323000
*       /*************************************************************/ 00324000
*                                                                  0191 00325000
*     END;                          /* ON RETURN, A NEW EXTENSION FOR   00326000
*                                      THE FIX ENTRIES HAS BEEN    0191 00327000
*                                      OBTAINED AND SWAPPTR POINTS TO   00328000
*                                      THE FIRST AVAILABLE FIX ENTRY    00329000
*                                      IN THE NEW EXTENSION.         */ 00330000
*   RFY                                                            0192 00331000
*    (ENDPTR) UNRSTD;                                              0192 00332000
@RF00185 DS    0H                                                  0193 00333000
*   FIXBEG=BEGEXT;                  /* FIRST EXTENSION WITH FIX    0193 00334000
*                                      ENTRIES IS THE LATEST       0193 00335000
*                                      EXTENSION.                    */ 00336000
         L     @11,BEGEXT(,PVTPTR)                                 0193 00337000
         ST    @11,FIXBEG(,PVTPTR)                                 0193 00338000
*   PTRFIRST=SWAPPTR;               /* SWAPPTR WAS SET UP TO POINT TO   00339000
*                                      THE FIRST AVAILABLE FIX ENTRY.   00340000
*                                      PRTLAST IS ALREADY ZERO FROM     00341000
*                                      WORKAREA ZEROING. IT INDICATES   00342000
*                                      THERE ARE NO FIX ENTRIES IN 0194 00343000
*                                      THE SPCT.                     */ 00344000
*                                                                  0194 00345000
         ST    SWAPPTR,PTRFIRST(,PVTPTR)                           0194 00346000
*   /*****************************************************************/ 00347000
*   /*                                                               */ 00348000
*   /* ONCE THE LSQA ENTRIES HAVE BEEN MADE IN THE SPCT NO FOES CAN  */ 00349000
*   /* BE FREEMAINED AS THE FREEMAIN MAY FREE AN LSQA FRAME FOR WHICH*/ 00350000
*   /* THERE IS ALREADY AN ENTRY                                     */ 00351000
*   /*                                                               */ 00352000
*   /*****************************************************************/ 00353000
*                                                                  0195 00354000
*   CALL FIXENTRY;                  /* CALL SUBROUTINE TO BUILD FIXED   00355000
*                                      ENTRIES                       */ 00356000
         BAL   @14,FIXENTRY                                        0195 00357000
*   RFY                                                            0196 00358000
*    (SWAPPTR) UNRSTD;                                             0196 00359000
*   PURGDON='1'B;                   /* FROM NOW ON GETEXT IS TO    0197 00360000
*                                      RETURN TO ITS CALLER IF A   0197 00361000
*                                      GETMAIN FAILS, AND INITPCB IS    00362000
*                                      TO RETURN TO ITS CALLER IF IT    00363000
*                                      RUNS OUT OF PCBS              */ 00364000
         OI    PURGDON(PVTPTR),B'00001000'                         0197 00365000
*                                                                  0198 00366000
*   /*****************************************************************/ 00367000
*   /*                                                               */ 00368000
*   /* CHECK IF THERE WILL BE ENOUGH PCBS FOR STAGE1 TO PAGE OUT ALL */ 00369000
*   /* LSQA AND PRIVATE AREA FIXED FRAMES. IF NOT, RECORD AN ERROR   */ 00370000
*   /* AND ABORT THE SWAP AS THERE IS NO WAY FOR STAGE1 PROCESSOR TO */ 00371000
*   /* BACK OUT IF IT RUNS OUT OF PCBS                               */ 00372000
*   /*                                                               */ 00373000
*   /*****************************************************************/ 00374000
*                                                                  0198 00375000
*   IF PAFIX+SPCTLSQA>FMCTASCB THEN                                0198 00376000
         LH    @12,SPCTLSQA(,SPCTPTR)                              0198 00377000
         AL    @12,PAFIX(,PVTPTR)                                  0198 00378000
         CH    @12,FMCTASCB(,PVTPTR)                               0198 00379000
         BNH   @RF00198                                            0198 00380000
*     DO;                                                          0199 00381000
*       R0='17'X;                   /* FRAME COUNT IS IN ERROR       */ 00382000
         LA    R0,23                                               0200 00383000
*       CALL DOABEND;               /* RECORD ERR IN FRAME COUNT     */ 00384000
         BAL   @14,DOABEND                                         0201 00385000
*       ASCBFMCT=PAFIX+SPCTLSQA;    /* MAKE FRAME COUNT MORE CORRECT    00386000
*                                      THEN IT WAS AT ENTRY TO SWAP     00387000
*                                      OUT                           */ 00388000
         LH    @12,SPCTLSQA(,SPCTPTR)                              0202 00389000
         AL    @12,PAFIX(,PVTPTR)                                  0202 00390000
         L     @11,ASCBPTR                                         0202 00391000
         STH   @12,ASCBFMCT(,@11)                                  0202 00392000
*       GO TO CLEANUP1;             /* GO ABORT SWAP                 */ 00393000
         B     CLEANUP1                                            0203 00394000
*     END;                                                         0204 00395000
*                                                                  0204 00396000
*   /*****************************************************************/ 00397000
*   /*                                                               */ 00398000
*   /* THIS SECTION INITIALIZES ONE PCB AS A SPECIAL PCB TO CONTAIN  */ 00399000
*   /* THE SRM PARMLIST, A WORKAREA, AND AN SRB TO SCHEDULE IEAVPIOI */ 00400000
*   /* AND PARTIALLY INITIALIZES ALL PCBS ON THE CHAIN TO BE SWAP OUT*/ 00401000
*   /* PCBS                                                          */ 00402000
*   /*                                                               */ 00403000
*   /*****************************************************************/ 00404000
*                                                                  0205 00405000
*   SPCTSWRT=PTRPCBS;               /* SET PTR TO PCB CONTAINING THE    00406000
*                                      SWAPOUT PARAMETER LIST      0205 00407000
*                                                            @Z40WPYC*/ 00408000
@RF00198 L     @12,PTRPCBS-1(,PVTPTR)                              0205 00409000
         LA    @12,0(,@12)                                         0205 00410000
         ST    @12,SPCTSWRT(,SPCTPTR)                              0205 00411000
*   RESPECIFY                                                      0206 00412000
*     SOUTPARM BASED(SPCTSWRT);     /*                       @Z40WPYC*/ 00413000
*   PCBPTR=PTRPCBS->PCBFQPA;        /* GET ADDR OF FIRST SWAPOUT PCB    00414000
*                                                            @Z40WPYC*/ 00415000
         L     PCBPTR,PCBFQPA-1(,@12)                              0207 00416000
         LA    PCBPTR,0(,PCBPTR)                                   0207 00417000
*   SOUTWRKA=PTRPCBS->PCBFQP;       /* SAVE PTR TO FIRST PCB AND THE    00418000
*                                      QUEUE ID(FF) IN CASE THE    0208 00419000
*                                      SWAPOUT IS TERMINATED AND ALL    00420000
*                                      PCB'S MUST BE FREED.ALSO THE     00421000
*                                      FIRST PCB IS ASSUMED TO BE FOR   00422000
*                                      LSQA, AND WILL BE PASSED AS 0208 00423000
*                                      INPUT TO IEAVPIOI     @Z40WPYC*/ 00424000
         L     @11,PCBFQP(,@12)                                    0208 00425000
         ST    @11,SOUTWRKA(,@12)                                  0208 00426000
*   PTRPCBS->PCBFQPA=0;             /* BREAK THE CHAIN       @Z40WPYC*/ 00427000
         SLR   @11,@11                                             0209 00428000
         STCM  @11,7,PCBFQPA(@12)                                  0209 00429000
*   PTRPCBS=PCBPTR;                 /* POINT TO FIRST SWAPOUT PCB  0210 00430000
*                                                            @Z40WPYC*/ 00431000
         STCM  PCBPTR,7,PTRPCBS(PVTPTR)                            0210 00432000
*   NEXTPCB=PCBPTR;                 /* ADDRESS OF FIRST PCB TO BE  0211 00433000
*                                      USED AS A SWAP OUT PCB        */ 00434000
         ST    PCBPTR,NEXTPCB(,PVTPTR)                             0211 00435000
*   PCBBQPA=0;                      /* FIRST SWAP OUT PCB HAS NO   0212 00436000
*                                      PREVIOUS PCBS.                */ 00437000
         ST    @11,PCBBQPA(,PCBPTR)                                0212 00438000
*   PCBIOI='1'B;                    /* OUTPUT I/O.                   */ 00439000
         OI    PCBIOI(PCBPTR),B'00000010'                          0213 00440000
*   PCBFREAL='1'B;                  /* FREE THE FRAME AFTER THE SWAP    00441000
*                                      OUT I/O COMPLETES.            */ 00442000
         OI    PCBFREAL(PCBPTR),B'10000000'                        0214 00443000
*   PCBSWPOT='1'B;                  /* SWAP OUT OPERATION.           */ 00444000
         OI    PCBSWPOT(PCBPTR),B'10000000'                        0215 00445000
*   PCBASCB=ASCBPTR;                /* GET THE ASCB ADDRESS          */ 00446000
         L     @12,ASCBPTR                                         0216 00447000
         ST    @12,PCBASCB(,PCBPTR)                                0216 00448000
*   AIAWRITE='1'B;                  /* WRITE OPERATION       @Z40WPYC*/ 00449000
         OI    AIAWRITE(PCBPTR),B'10000000'                        0217 00450000
*   R1=PCBFQPA;                     /* GET THE ADDRESS OF THE NEXT 0218 00451000
*                                      PCB TO BE INITIALIZED.        */ 00452000
         L     R1,PCBFQPA-1(,PCBPTR)                               0218 00453000
         LA    R1,0(,R1)                                           0218 00454000
*   DO WHILE R1^=0;                 /* THIS DO GROUP WILL PARTIALLY     00455000
*                                      INITIALIZE ALL THE REMAINING     00456000
*                                      PCBS BY MOVING THE DATA FROM     00457000
*                                      THE FIRST PARTLY INITIALIZED     00458000
*                                      PCB TO EACH REMAINING PCB ON     00459000
*                                      THE INTERNAL CHAIN.           */ 00460000
         B     @DE00219                                            0219 00461000
@DL00219 DS    0H                                                  0220 00462000
*     R1->AREA=PCBPTR->AREA;        /* INITIALIZE THE PRESENT PCB AND   00463000
*                                      AIA.                          */ 00464000
         MVC   AREA(56,R1),AREA(PCBPTR)                            0220 00465000
*     R1=R1->PCBFQPA;               /* GET THE ADDRESS OF THE NEXT 0221 00466000
*                                      PCB ON THE CHAIN AND LOOP.    */ 00467000
         L     @12,PCBFQPA-1(,R1)                                  0221 00468000
         LA    @12,0(,@12)                                         0221 00469000
         LR    R1,@12                                              0221 00470000
*   END;                                                           0222 00471000
@DE00219 LTR   R1,R1                                               0222 00472000
         BNZ   @DL00219                                            0222 00473000
*                                                                  0223 00474000
*   /*****************************************************************/ 00475000
*   /*                                                               */ 00476000
*   /* FROM THIS POINT ON THE SWAPOUT CAN NOT BE ABORTED             */ 00477000
*   /*                                                               */ 00478000
*   /*****************************************************************/ 00479000
*                                                                  0223 00480000
*   CALL PIOPURGE;                  /* CALL SUBROUTINE TO PURGE    0223 00481000
*                                      PAGING I/O.                   */ 00482000
         BAL   @14,PIOPURGE                                        0223 00483000
*   CALL STAGE1;                    /* GO CREATE PCBS FOR FIX AND  0224 00484000
*                                      LSQA ENTRIES                  */ 00485000
         BAL   @14,STAGE1                                          0224 00486000
*   CALL WORKSET;                   /* CALL SUBROUTINE TO BUILD    0225 00487000
*                                      WORKING SET PCBS              */ 00488000
*                                                                  0225 00489000
         BAL   @14,WORKSET                                         0225 00490000
*   /*****************************************************************/ 00491000
*   /*                                                               */ 00492000
*   /* ADJUST SPCT COUNTS                                            */ 00493000
*   /*                                                               */ 00494000
*   /*****************************************************************/ 00495000
*                                                                  0226 00496000
*   PCBRPTR=SPCTSWRT;               /* GET THE SPECIAL PCB TO CONTAIN   00497000
*                                      THE SRM PARAMETER LIST      0226 00498000
*                                                            @Z40WPYC*/ 00499000
         L     @11,SPCTSWRT(,SPCTPTR)                              0226 00500000
         LR    PCBRPTR,@11                                         0226 00501000
*   OPTSOUT=ROOTCNT;                /* TELL SRM COUNT OF PAGES     0227 00502000
*                                      SWAPPED OUT                   */ 00503000
         LH    @12,ROOTCNT(,PVTPTR)                                0227 00504000
         STH   @12,OPTSOUT(,@11)                                   0227 00505000
*   SPCTWSSZ=SPCTWSSZ+SPCTLSQA+SPCTFIX;/* SWAP IN SIZE IS SUM OF FIX,   00506000
*                                      LSQA, AND INCORE PAGES.       */ 00507000
         LH    @12,SPCTWSSZ(,SPCTPTR)                              0228 00508000
         AH    @12,SPCTLSQA(,SPCTPTR)                              0228 00509000
         AH    @12,SPCTFIX(,SPCTPTR)                               0228 00510000
         STH   @12,SPCTWSSZ(,SPCTPTR)                              0228 00511000
*   OPTSIN=SPCTWSSZ;                /* GET SWAP IN SIZE FOR SRM.     */ 00512000
*                                                                  0229 00513000
         STH   @12,OPTSIN(,@11)                                    0229 00514000
*   /*****************************************************************/ 00515000
*   /*                                                               */ 00516000
*   /* UPDATE COUNT OF NUMBER OF FRAMES FREED BY SWAP OUT BUT NOT    */ 00517000
*   /* PAGED OUT                                                     */ 00518000
*   /*                                                               */ 00519000
*   /*****************************************************************/ 00520000
*                                                                  0230 00521000
*   PVTSPFR=PVTSPFR+FMCTASCB-ASCBFMCT;/* CALCULATE NUMBER OF FRAMES     00522000
*                                      FREED IN SWAP OUT MAINLINE  0230 00523000
*                                      PROCESSING AND ADD NUMBER TO     00524000
*                                      COUNTER FOR SYSTEM RESOURSE 0230 00525000
*                                      MANAGER                       */ 00526000
         LH    @12,FMCTASCB(,PVTPTR)                               0230 00527000
         LH    @06,PVTSPFR(,PVTPTR)                                0230 00528000
         N     @06,@CF02704                                        0230 00529000
         ALR   @06,@12                                             0230 00530000
         L     @15,ASCBPTR                                         0230 00531000
         LH    @15,ASCBFMCT(,@15)                                  0230 00532000
         SLR   @06,@15                                             0230 00533000
         STH   @06,PVTSPFR(,PVTPTR)                                0230 00534000
*   OPTSPFR=FMCTASCB-ASCBFMCT;      /* COUNT OF FRAMES FREED WITHOUT    00535000
*                                      I/O                   @YM05621*/ 00536000
*                                                                  0231 00537000
         SLR   @12,@15                                             0231 00538000
         STH   @12,OPTSPFR(,@11)                                   0231 00539000
*   /*****************************************************************/ 00540000
*   /*                                                               */ 00541000
*   /* FREE UNUSED PCBS AND PUT PAGE OUT PCBS ON LOCAL I/O ACTIVE    */ 00542000
*   /* QUEUE                                                         */ 00543000
*   /*                                                               */ 00544000
*   /*****************************************************************/ 00545000
*                                                                  0232 00546000
*   IF NEXTPCB^=0 THEN                                             0232 00547000
         SLR   @12,@12                                             0232 00548000
         L     @11,NEXTPCB(,PVTPTR)                                0232 00549000
         CR    @11,@12                                             0232 00550000
         BE    @RF00232                                            0232 00551000
*     DO;                                                          0233 00552000
*       R1=NEXTPCB;                 /* FIRST PCB TO BE FREED         */ 00553000
         LR    R1,@11                                              0234 00554000
*       R13=NEXTPCB->PCBBQPA;       /* GET ADDRESS OF LAST PAGE OUT     00555000
*                                      PCB                           */ 00556000
         L     R13,PCBBQPA(,@11)                                   0235 00557000
*       NEXTPCB->PCBBQPA=0;         /* ZERO BACKWARD POINTER OF PCB     00558000
*                                      AT HEAD OF CHAIN WHICH IS TO     00559000
*                                      BE FREED.                     */ 00560000
         ST    @12,PCBBQPA(,@11)                                   0236 00561000
*       R13->PCBFQPA=0;             /* ZERO FORWARD POINTER OF LAST     00562000
*                                      PCB ON CHAIN                  */ 00563000
         STCM  @12,7,PCBFQPA(R13)                                  0237 00564000
*       R13->AIANXAIA=0;            /* ZERO AIA FORWARD PTR OF LAST     00565000
*                                      AIA                           */ 00566000
         ST    @12,AIANXAIA(,R13)                                  0238 00567000
*       R0=PCBFREQN;                /* SEND PCB'S TO FREE Q          */ 00568000
         LA    R0,16                                               0239 00569000
*       CALL IEAVPCB;               /* FREE UNUSED PCBS              */ 00570000
         L     @15,PVTPCB(,PVTPTR)                                 0240 00571000
         BALR  @14,@15                                             0240 00572000
*     END;                                                         0241 00573000
*   R0=PCBLIOQN;                    /* PCBS TO LOCAL Q               */ 00574000
@RF00232 LA    R0,136                                              0242 00575000
*   R1=PTRPCBS;                     /* ADDRESS OF FIRST PCB ON CHAIN    00576000
*                                      WHICH GOES TO LOCAL I/O ACTIVE   00577000
*                                      Q                             */ 00578000
         L     R1,PTRPCBS-1(,PVTPTR)                               0243 00579000
         LA    R1,0(,R1)                                           0243 00580000
*   CALL IEAVPCB;                   /* PCBS TO LOCAL Q               */ 00581000
*                                                                  0244 00582000
         L     @15,PVTPCB(,PVTPTR)                                 0244 00583000
         BALR  @14,@15                                             0244 00584000
*   /*****************************************************************/ 00585000
*   /*                                                               */ 00586000
*   /* CALL ASM TO INITIATE I/O FOR SWAPOUT OF THE NON-LSQA (FIXED)  */ 00587000
*   /* PAGES                                                         */ 00588000
*   /*                                                               */ 00589000
*   /*****************************************************************/ 00590000
*                                                                  0245 00591000
*   IF NLSQAPCB^=0&NEXTPCB^=NLSQAPCB THEN/* IS THERE AT LEAST ONE FIX   00592000
*                                      PCB TO PROCESS        @Z40WPYC*/ 00593000
         L     @12,SPCTSWRT(,SPCTPTR)                              0245 00594000
         L     @12,NLSQAPCB-1(,@12)                                0245 00595000
         LA    @12,0(,@12)                                         0245 00596000
         LTR   @12,@12                                             0245 00597000
         BZ    @RF00245                                            0245 00598000
         C     @12,NEXTPCB(,PVTPTR)                                0245 00599000
         BE    @RF00245                                            0245 00600000
*     DO;                           /* YES - CALL ASM TO START THE 0246 00601000
*                                      OUTPUT I/O FOR THE PRIVATE  0246 00602000
*                                      AREA NON-LSQA PAGES. THE I/O     00603000
*                                      FOR THE LSQA PAGES WILL BE  0246 00604000
*                                      STARTED BY IEAVPIOI IN THE  0246 00605000
*                                      MASTER ADDRESS SPACE (SCHEDULE   00606000
*                                      BY IEAVESOUT)         @Z40WPYC*/ 00607000
*       RESPECIFY                                                  0247 00608000
*        (R15) RESTRICTED;          /*                       @Z40WPYC*/ 00609000
*       RESPECIFY                                                  0248 00610000
*         PCB BASED(R1);            /*                       @Z40WPYC*/ 00611000
*       R1=NLSQAPCB;                /* SET PTR TO FIRST PCB  @Z40WPYC*/ 00612000
         LR    R1,@12                                              0249 00613000
*       R1=ADDR(PCBAIA);            /* SET PTR TO FIRST AIA FOR ASM     00614000
*                                                            @Z40WPYC*/ 00615000
         LA    @14,PCBAIA(,R1)                                     0250 00616000
         LR    R1,@14                                              0250 00617000
*       RESPECIFY                                                  0251 00618000
*         PCB BASED(PCBPTR);        /*                       @Z40WPYC*/ 00619000
*       CALL ILRPAGIO;              /* START I/O FOR SWAPOUT @Z40WPYC*/ 00620000
         L     @15,PVTPAGIO(,PVTPTR)                               0252 00621000
         BALR  @14,@15                                             0252 00622000
*       IF R15^=0 THEN              /* IF ASM FOUND ERROR WHILE    0253 00623000
*                                      PROCESSING INPUT AIA QUEUE  0253 00624000
*                                                            @Z40WPYC*/ 00625000
         LTR   R15,R15                                             0253 00626000
         BZ    @RF00253                                            0253 00627000
*         DO;                       /* PROCESS ERROR         @Z40WPYC*/ 00628000
*           PCBPTR=NLSQAPCB->PCBBQPA;/* OBTAIN PTR TO LAST LSQA    0255 00629000
*                                                            @Z40WPYC*/ 00630000
         L     @14,SPCTSWRT(,SPCTPTR)                              0255 00631000
         L     @12,NLSQAPCB-1(,@14)                                0255 00632000
         L     PCBPTR,PCBBQPA(,@12)                                0255 00633000
*           AIANXAIA=R1;            /* CHAIN FIRST AIA IN ERROR TO 0256 00634000
*                                      LAST LSQA AIA         @ZA16398*/ 00635000
         ST    R1,AIANXAIA(,PCBPTR)                                0256 00636000
*           R1=ADDR(LSQAPCBS->PCBAIA);/* SET PTR TO FIRST LSQA AIA.     00637000
*                                      IEAVSWPC WILL TURN OFF      0257 00638000
*                                      PFTPCBSI FOR EACH AIA, AND  0257 00639000
*                                      FREE THE PCB.         @Z40WPYC*/ 00640000
         L     R1,LSQAPCBS-1(,@14)                                 0257 00641000
         LA    R1,0(,R1)                                           0257 00642000
         LA    R1,PCBAIA(,R1)                                      0257 00643000
*           R0=8;                   /* SET RET CODE FOR SWPC @Z40WPYC*/ 00644000
         LA    R0,8                                                0258 00645000
*           CALL IEAVSWPC;          /* TERM. THE ADDR SPACE  @Z40WPYC*/ 00646000
         L     @15,PVTPSWPC(,PVTPTR)                               0259 00647000
         BALR  @14,@15                                             0259 00648000
*           PVTPRCA=SAVERCA;        /* RESTORE RCA ADDRESS   @Z40WPYC*/ 00649000
*                                                                  0260 00650000
         L     @14,CALLER13(,PVTPTR)                               0260 00651000
         L     @14,SAVERCA(,@14)                                   0260 00652000
         ST    @14,PVTPRCA(,PVTPTR)                                0260 00653000
*           /*********************************************************/ 00654000
*           /*                                                       */ 00655000
*           /* NOTE THAT A SUCCESSFUL RETURN CODE WILL BE RETURNED,  */ 00656000
*           /* TO FORCE RCT TO WAIT. THE ADDRESS SPACE WILL BE       */ 00657000
*           /* TERMINATED BY SWPC                                    */ 00658000
*           /*                                                       */ 00659000
*           /*********************************************************/ 00660000
*                                                                  0261 00661000
*         END;                      /* END ERROR PROCESSING  @Z40WPYC*/ 00662000
*       ELSE                                                       0262 00663000
*         ;                         /* I/O STARTED SUCCESSFULLY    0262 00664000
*                                                            @Z40WPYC*/ 00665000
@RF00253 DS    0H                                                  0263 00666000
*     END;                          /* CALL ASM              @Z40WPYC*/ 00667000
*   ELSE                                                           0264 00668000
*     ;                             /* NO I/O                @Z40WPYC*/ 00669000
@RF00245 DS    0H                                                  0265 00670000
*   RESPECIFY                                                      0265 00671000
*    (R15) UNRESTRICTED;            /*                       @Z40WPYC*/ 00672000
*   IF SPCTSWRT^=0 THEN             /* IS SWAPOUT STILL ON   @Z40WPYC*/ 00673000
         L     @12,SPCTSWRT(,SPCTPTR)                              0266 00674000
         LTR   @12,@12                                             0266 00675000
         BZ    @RF00266                                            0266 00676000
*     DO;                           /* YES - SCHEDULE IEAVPIOI TO  0267 00677000
*                                      INITIATE THE I/O FOR THE LSQA    00678000
*                                      PAGES                 @Z40WPYC*/ 00679000
*                                                                  0267 00680000
*       /*************************************************************/ 00681000
*       /*                                                           */ 00682000
*       /* INITIALIZE AN SRB TO SCHEDULE IEAVPIOI            @Z40WPYC*/ 00683000
*       /*                                                           */ 00684000
*       /*************************************************************/ 00685000
*                                                                  0268 00686000
*       SRBPTR=ADDR(PIOISRB);       /* GET SRB PTR - NOTE THAT THE 0268 00687000
*                                      SRB HAS PREVIOUSLY BEEN     0268 00688000
*                                      CLEARED BY IEAVPCB    @Z40WPYC*/ 00689000
         LA    SRBPTR,PIOISRB(,@12)                                0268 00690000
*       ASVTPTR=CVTASVT;            /* GET ADDR OF ADDRESS SPACE   0269 00691000
*                                      VECTOR TABLE                  */ 00692000
         L     @11,CVTPTR                                          0269 00693000
         L     @06,CVTASVT(,@11)                                   0269 00694000
         ST    @06,ASVTPTR(,@11)                                   0269 00695000
*       SRBASCB=ASVTENTY(1);        /* THE FIRST ENTRY IN THE ASVT 0270 00696000
*                                      CONTAINS THE ADDRESS OF MASTER   00697000
*                                      SCHEDULER ASCB                */ 00698000
         L     @11,ASVTENTY(,@06)                                  0270 00699000
         ST    @11,SRBASCB(,SRBPTR)                                0270 00700000
*       SRBEP=PVTPPIOI;             /* SET TO IEAVPIOI ENTRY POINT 0271 00701000
*                                                            @Z40WPYC*/ 00702000
         L     @11,PVTPPIOI(,PVTPTR)                               0271 00703000
         ST    @11,SRBEP(,SRBPTR)                                  0271 00704000
*       SRBPASID=ASCBASID;          /* ASID OF ADDRESS SPACE BEING 0272 00705000
*                                      SWAPPED OUT                   */ 00706000
         L     @11,ASCBPTR                                         0272 00707000
         LH    @11,ASCBASID(,@11)                                  0272 00708000
         N     @11,@CF02704                                        0272 00709000
         STH   @11,SRBPASID(,SRBPTR)                               0272 00710000
*       SRBID='SRB ';               /* GET ID                        */ 00711000
         MVC   SRBID(4,SRBPTR),@CC02532                            0273 00712000
*       SRBPRIOR=4;                 /* NONQUIESSABLE LEVEL           */ 00713000
         MVI   SRBPRIOR(SRBPTR),X'04'                              0274 00714000
*       SRBPARM=SPCTSWRT;           /* PASS PTR TO THE SWAPOUT     0275 00715000
*                                      PARAMETER LIST        @Z40WPYC*/ 00716000
         ST    @12,SRBPARM(,SRBPTR)                                0275 00717000
*       SRBRMTR=PVTPSRBP;           /* RSM PURGE ROUTINE     @Z40WPYC*/ 00718000
         L     @12,PVTPSRBP(,PVTPTR)                               0276 00719000
         ST    @12,SRBRMTR(,SRBPTR)                                0276 00720000
*       GENERATE REFS(R1,CVTGSMQ,SRBSECT,CVTMAP,SRBFLNK) SETS(R0,R15)   00721000
*           NOFLOWS;                                               0277 00722000
               SCHEDULE   SRB=(1),SCOPE=LOCAL                           00723000
*     END;                          /* END SRB PROCESSING    @Z40WPYC*/ 00724000
*   ELSE                                                           0279 00725000
*     ;                             /* IEAVSWPC WAS CALLED, BYPASS 0279 00726000
*                                      SCHEDULING OF IEAVPIOI      0279 00727000
*                                                            @Z40WPYC*/ 00728000
@RF00266 DS    0H                                                  0280 00729000
*                                                                  0280 00730000
*   /*****************************************************************/ 00731000
*   /*                                                               */ 00732000
*   /* FREE UNUSED EXTENSIONS                                        */ 00733000
*   /*                                                               */ 00734000
*   /*****************************************************************/ 00735000
*                                                                  0280 00736000
*   RESPECIFY                                                      0280 00737000
*    (R4,                                                          0280 00738000
*     R14,                                                         0280 00739000
*     R15) RESTRICTED;                                             0280 00740000
*   R1=BEGEXT->SPCTEXT;             /* GET THE ADDRESS OF THE NEXT 0281 00741000
*                                      EXTENSION FROM THE LAST USED     00742000
*                                      EXTENSION.                    */ 00743000
         L     @12,BEGEXT(,PVTPTR)                                 0281 00744000
         L     R1,SPCTEXT(,@12)                                    0281 00745000
*   BEGEXT->SPCTEXT=0;              /* ZERO THE FOREWARD EXTENSION 0282 00746000
*                                      POINTER.                      */ 00747000
         SLR   @11,@11                                             0282 00748000
         ST    @11,SPCTEXT(,@12)                                   0282 00749000
*NEXTEXT:                                                          0283 00750000
*   IF R1=0 THEN                    /* TEST IF ALL UNUSED EXTENSIONS    00751000
*                                      ARE NOW FREE.                 */ 00752000
NEXTEXT  LTR   R1,R1                                               0283 00753000
         BZ    @RT00283                                            0283 00754000
*     GOTO RETN;                    /* ALL UNUSED EXTENSIONS       0284 00755000
*                                      FREE.EXIT                     */ 00756000
*   RESPECIFY                                                      0285 00757000
*    (SAVEEXT) RESTRICTED;                                         0285 00758000
*   SAVEEXT=R1->SPCTEXT;            /* SAVE THE ADDRESS OF THE NEXT     00759000
*                                      EXTENSION.                    */ 00760000
         L     SAVEEXT,SPCTEXT(,R1)                                0286 00761000
*   R0=LENGTH(SPCTEXTM);            /* GET THE LENGTH OF AN EXTENSION*/ 00762000
         LA    R0,56                                               0287 00763000
*   R4=0;                           /* GLOBAL SQA REQUEST DOES NOT 0288 00764000
*                                      NEED A TCB.                   */ 00765000
         SLR   R4,R4                                               0288 00766000
*   R7=ASCBPTR;                     /* ASCB IS THIS ASCB             */ 00767000
         L     R7,ASCBPTR                                          0289 00768000
*/********************************************************************/ 00769000
*/*                                                                  */ 00770000
*/*                     FREEMAIN AN UNUSED EXTENSION.                */ 00771000
*/*                   INPUT:                                         */ 00772000
*/*              R0: LENGTH OF THE EXTENSION                         */ 00773000
*/*              R1: ADDRESS OF THE EXTENSION                        */ 00774000
*/*              R2: UNUSED                                          */ 00775000
*/*              R3: LOADED BY THE MACRO                             */ 00776000
*/*              R4: ZERO                                            */ 00777000
*/*              R5 - R6: UNUSED                                     */ 00778000
*/*              R7: ADDRESS OF THE ASCB                             */ 00779000
*/*              R8 - R13: UNUSED                                    */ 00780000
*/*              R14: RETURN ADDRESS LOADED BY MACRO                 */ 00781000
*/*              R15: ENTRY POINT ADDRESS LOADED BY MACRO            */ 00782000
*/*                   OUTPUT:                                        */ 00783000
*/*              R0 - R14: RESTORED                                  */ 00784000
*/*              R15: RETURN CODE                                    */ 00785000
*/*                     0 - SUCCESSFUL                               */ 00786000
*/*                     NON-0 - UNSUCCESSFUL                         */ 00787000
*/*                                                                  */ 00788000
*/********************************************************************/ 00789000
*                                                                  0290 00790000
*   GENERATE CODE;                                                 0290 00791000
FREECORE FREEMAIN RC,LV=(0),A=(1),SP=245,BRANCH=YES,                  **00792000
               RELATED=(SPCT-EXT,IEAVSOUT(GETCORE))                     00793000
*   RESPECIFY                                                      0291 00794000
*    (R4,                                                          0291 00795000
*     R14) UNRESTRICTED;                                           0291 00796000
*   PVTPTR=CVTPVTP;                 /* RESTORE THE PVT ADDRESS       */ 00797000
         L     @14,CVTPTR                                          0292 00798000
         L     PVTPTR,CVTPVTP(,@14)                                0292 00799000
*   PVTPRCA=SAVERCA;                /* RESTORE THE RCA POINTER       */ 00800000
         L     @14,CALLER13(,PVTPTR)                               0293 00801000
         L     @14,SAVERCA(,@14)                                   0293 00802000
         ST    @14,PVTPRCA(,PVTPTR)                                0293 00803000
*   IF R15^=0 THEN                  /* TEST FOR A BAD RETURN CODE.   */ 00804000
         LTR   R15,R15                                             0294 00805000
         BZ    @RF00294                                            0294 00806000
*     DO;                           /* RETURN CODE IS BAD. RECORD THE   00807000
*                                      ERROR, BUT CONTINUE THE SWAP. */ 00808000
*       R0='03'X;                   /* RECORD FREEMAIN FAILURE       */ 00809000
         LA    R0,3                                                0296 00810000
*       CALL DOABEND;               /* RECORD THE ERROR              */ 00811000
         BAL   @14,DOABEND                                         0297 00812000
*       GOTO RETN;                  /* EXIT. DO NOT CONTINUE FREEING    00813000
*                                      EXTENSIONS BECAUSE OF ERRORS. */ 00814000
         B     RETN                                                0298 00815000
*     END;                                                         0299 00816000
*   RESPECIFY                                                      0300 00817000
*    (R15) UNRESTRICTED;                                           0300 00818000
@RF00294 DS    0H                                                  0301 00819000
*   R1=SAVEEXT;                     /* GET THE ADDRESS OF THE NEXT 0301 00820000
*                                      UNUSED EXTENSION.             */ 00821000
         LR    R1,SAVEEXT                                          0301 00822000
*   GOTO NEXTEXT;                   /* GO FREE THE NEXT UNUSED     0302 00823000
*                                      EXTENSION.                    */ 00824000
         B     NEXTEXT                                             0302 00825000
*   RESPECIFY                                                      0303 00826000
*    (SAVEEXT) UNRESTRICTED;                                       0303 00827000
*                                                                  0304 00828000
*   /*****************************************************************/ 00829000
*   /*                                                               */ 00830000
*   /* FREE UP ALL THE PCBS ACQUIRED AND THE SRB                     */ 00831000
*   /*                                                               */ 00832000
*   /*****************************************************************/ 00833000
*                                                                  0304 00834000
*CLEANUP1:                                                         0304 00835000
*   RESPECIFY                                                      0304 00836000
*    (R0,                                                          0304 00837000
*     R1) RESTRICTED;               /*                       @Z40WPYC*/ 00838000
CLEANUP1 DS    0H                                                  0305 00839000
*   R0=PCBFREQN;                    /* PCBS TO FREE QUEUE    @Z40WPYC*/ 00840000
         LA    R0,16                                               0305 00841000
*   IF SPCTSWRT^=0 THEN             /* HAS SRM WORK AREA BEEN      0306 00842000
*                                      OBTAINED              @Z40WPYC*/ 00843000
         SLR   @12,@12                                             0306 00844000
         L     @11,SPCTSWRT(,SPCTPTR)                              0306 00845000
         CR    @11,@12                                             0306 00846000
         BE    @RF00306                                            0306 00847000
*     DO;                           /* YES - RECHAIN PCBS    @Z40WPYC*/ 00848000
*       SPCTSWRT->PCBFQP=SOUTWRKA;  /* RELINK SWAPOUT PARAMETER LIST    00849000
*                                      SO IT APPEARS AS FIRST PCB ON    00850000
*                                      CHAIN TO BE FIXED.    @Z40WPYC*/ 00851000
         L     @06,SOUTWRKA(,@11)                                  0308 00852000
         ST    @06,PCBFQP(,@11)                                    0308 00853000
*       PTRPCBS->PCBBQPA=SPCTSWRT;  /* RESTORE BACK PTR OF FIRST   0309 00854000
*                                      SWAPOUT PCB.          @Z40WPYC*/ 00855000
         L     @06,PTRPCBS-1(,PVTPTR)                              0309 00856000
         ST    @11,PCBBQPA(,@06)                                   0309 00857000
*       R1=SPCTSWRT;                /* SEND BACK ALL THE PCBS WE GOT    00858000
*                                                            @Z40WPYC*/ 00859000
         LR    R1,@11                                              0310 00860000
*       SPCTSWRT=0;                 /* CLEAR ADDR OF SWAPOUT W.A   0311 00861000
*                                                            @Z40WPYC*/ 00862000
         ST    @12,SPCTSWRT(,SPCTPTR)                              0311 00863000
*     END;                          /* END PCB RECHAIN PROC  @Z40WPYC*/ 00864000
*   ELSE                            /* PCB CHAIN STILL CMPLETE     0313 00865000
*                                                            @Z40WPYC*/ 00866000
*     R1=PTRPCBS;                   /* SET PTR TO FIRST PCB  @Z40WPYC*/ 00867000
         B     @RC00306                                            0313 00868000
@RF00306 L     R1,PTRPCBS-1(,PVTPTR)                               0313 00869000
         LA    R1,0(,R1)                                           0313 00870000
*   CALL IEAVPCB;                   /* FREE PCBS                     */ 00871000
@RC00306 L     @15,PVTPCB(,PVTPTR)                                 0314 00872000
         BALR  @14,@15                                             0314 00873000
*CLEANUP2:                                                         0315 00874000
*   RETNCODE=TRYLATER;              /* SET RETURN CODE       @Z40WPYC*/ 00875000
CLEANUP2 MVC   RETNCODE(4,PVTPTR),@CF00057                         0315 00876000
*   SPCTOUT='0'B;                   /* TURN OFF SWAPOUT IN PROGRESS     00877000
*                                      FLAG                          */ 00878000
         NI    SPCTOUT(SPCTPTR),B'10111111'                        0316 00879000
*                                                                  0317 00880000
*   /*****************************************************************/ 00881000
*   /*                                                               */ 00882000
*   /* FREE SALLOC LOCK AND FRR, RESTORE REGISTERS AND RETURN TO     */ 00883000
*   /* REGION CONTROL TASK                                           */ 00884000
*   /*                                                               */ 00885000
*   /*****************************************************************/ 00886000
*                                                                  0317 00887000
*RETN:                                                             0317 00888000
*   RFY                                                            0317 00889000
*    (R5,                                                          0317 00890000
*     R14) RSTD;                                                   0317 00891000
RETN     DS    0H                                                  0318 00892000
*   R5=CALLER13;                    /* SAVE R13 OVER SETLOCK         */ 00893000
         L     R5,CALLER13(,PVTPTR)                                0318 00894000
*   R5->SAVER15=RETNCODE;           /* MOVE RETURN CODE TO SAVE AREA */ 00895000
         L     @15,RETNCODE(,PVTPTR)                               0319 00896000
         ST    @15,SAVER15(,R5)                                    0319 00897000
*FREESALL:                                                         0320 00898000
*   GENERATE CODE REFS(PSALITA,FLC) SETS(R11,R12,R13,R14);         0320 00899000
*                                                                  0320 00900000
FREESALL DS    0H                                                  0320 00901000
         SETLOCK RELEASE,TYPE=SALLOC,                                 **00902000
               RELATED=(RSM,IEAVSOUT(GETSALL)),DISABLED                 00903000
*   /*****************************************************************/ 00904000
*   /*                                                               */ 00905000
*   /* IF WE ARE IN A BACKOUT, RESTART SRBS                          */ 00906000
*   /*                                                               */ 00907000
*   /*****************************************************************/ 00908000
*                                                                  0321 00909000
*   IF R5->SAVER15^=0 THEN                                         0321 00910000
         L     @15,SAVER15(,R5)                                    0321 00911000
         LTR   @15,@15                                             0321 00912000
         BZ    @RF00321                                            0321 00913000
*     DO;                                                          0322 00914000
*       R0=ASCBASID;                /* GET ASID FOR STATUS           */ 00915000
         L     @15,ASCBPTR                                         0323 00916000
         LH    R0,ASCBASID(,@15)                                   0323 00917000
         N     R0,@CF02704                                         0323 00918000
*       GEN CODE(SLL R0,16)                                        0324 00919000
*       SETS(R0) REFS(R0);          /* MOVE ASID TO LEFT SIDE OF   0324 00920000
*                                      REGISTER                      */ 00921000
         SLL R0,16                                                      00922000
*       R1=13;                      /* START SRBS                    */ 00923000
         LA    R1,13                                               0325 00924000
*       R0=R0|R1;                   /* COMBINE ASID AND THE 13       */ 00925000
         OR    R0,R1                                               0326 00926000
*       R1=ABIT;                    /* GET A BIT TO INDICATE START   */ 00927000
         LA    R1,128                                              0327 00928000
*       GEN CODE(SLL R1,24)                                        0328 00929000
*       SETS(R1) REFS(R1);          /* MOVE BIT INTO HIGH ORDER BIT     00930000
*                                      POSITION                      */ 00931000
         SLL R1,24                                                      00932000
*       CALL STATUS;                /* START QUIESSABLE AND NON    0329 00933000
*                                      QUIESSABLE SRBS               */ 00934000
         L     @12,CVTPTR                                          0329 00935000
         L     @12,SCVTSPTR(,@12)                                  0329 00936000
         L     @15,SCVTSTAT(,@12)                                  0329 00937000
         BALR  @14,@15                                             0329 00938000
*       IF FRPINCNT=255 THEN        /* IS SWAP OUT BEING ABORTED FOR    00939000
*                                      A BAD LSQA FRAME?     @ZA19960*/ 00940000
         CLI   FRPINCNT(RSMHDPTR),255                              0330 00941000
         BNE   @RF00330                                            0330 00942000
*         DO;                       /* YES THEN LOCK THE MEMORY IN 0331 00943000
*                                      STORAGE               @ZA19960*/ 00944000
*           R13=WSALRSM;            /* ADDRESS OF RSM LOCAL WORK SAVE   00945000
*                                      AREA                  @ZA19960*/ 00946000
         L     @15,ASCBPTR                                         0332 00947000
         L     @15,ASXBPTR(,@15)                                   0332 00948000
         L     @15,ASXBSPSA(,@15)                                  0332 00949000
         L     R13,WSALRSM(,@15)                                   0332 00950000
*           GENERATE NODEFS SETS(R0,R14,R15) REFS(CVTOPTE,CVT,CVTPTR)   00951000
*               NOFLOWS;                                           0333 00952000
        SYSEVENT DONTSWAP,ENTRY=BRANCH                        @ZA19960  00953000
*           FRPINCNT=0;             /* RESET THE PINNED COUNT      0334 00954000
*                                                            @ZA19960*/ 00955000
         MVI   FRPINCNT(RSMHDPTR),X'00'                            0334 00956000
*         END;                      /* END OF LOCK MEMORY IN CORE  0335 00957000
*                                                            @ZA19960*/ 00958000
*     END;                                                         0336 00959000
@RF00330 DS    0H                                                  0337 00960000
*FREEFRR:                                                          0337 00961000
*   GENERATE CODE REFS(PSA,PSACSTK,FRRS,FRRSELEN,FRRSCURR,FRRSEMP) SETS 00962000
*       (R11,R12);                                                 0337 00963000
*                                                                  0337 00964000
@RF00321 DS    0H                                                  0337 00965000
FREEFRR  DS    0H                                                  0337 00966000
         SETFRR D,WRKREGS=(11,12),                                    **00967000
               RELATED=(RSM,IEAVSOUT(GETFRR))                           00968000
*   /*****************************************************************/ 00969000
*   /*                                                               */ 00970000
*   /* RETURN TO THE CALLER OF SWAPOUT                               */ 00971000
*   /*                                                               */ 00972000
*   /*****************************************************************/ 00973000
*                                                                  0338 00974000
*   GENERATE NODEFS REFS(R5,R14) NOSETS NOFLOWS;                   0338 00975000
          LM   R2,R15,OFFSET16(R5)      RESTORE CALLERS REGISTERS       00976000
          BR   R14                      RETURN TO REGION CONTROL TASK   00977000
*   RFY                                                            0339 00978000
*    (R1,                                                          0339 00979000
*     R5) UNRSTD;                                                  0339 00980000
*                                                                  0340 00981000
*   /*****************************************************************/ 00982000
*   /*                                                               */ 00983000
*   /* THIS SECTION SCANS THE LOCAL SQA FRAME QUEUE AND BUILDS SPCT  */ 00984000
*   /* LSQA ENTRIES FOR EACH PAGE IN A FRAME.                        */ 00985000
*   /*                                                               */ 00986000
*   /*****************************************************************/ 00987000
*                                                                  0340 00988000
*LSQANTRY:                                                         0340 00989000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0340 00990000
LSQANTRY DS    0H                                                  0341 00991000
*   RESPECIFY                                                      0341 00992000
*    (SWAPPTR,                                                     0341 00993000
*     R14) RESTRICTED;                                             0341 00994000
*   LEV1RTN=R14;                    /* SAVE THE RETURN ADDRESS.      */ 00995000
         ST    R14,LEV1RTN(,PVTPTR)                                0342 00996000
*   RESPECIFY                                                      0343 00997000
*    (R14) UNRESTRICTED;                                           0343 00998000
*   SWAPPTR=ADDR(SPCTSWAP);         /* GET THE ADDRESS OF THE AREA 0344 00999000
*                                      FOR LSQA AND FIX ENTRIES IN 0344 01000000
*                                      THE SPCT.                     */ 01001000
         LA    SWAPPTR,SPCTSWAP(,SPCTPTR)                          0344 01002000
*   BEGEXT=SWAPPTR;                 /* SAVE THE PTR TO THE FIRST   0345 01003000
*                                      EXTENSION.                    */ 01004000
         ST    SWAPPTR,BEGEXT(,PVTPTR)                             0345 01005000
*   RESPECIFY                                                      0346 01006000
*    (ENDPTR) RESTRICTED;                                          0346 01007000
*   ENDPTR=ADDR(SPCTSEGS);          /* CALC THE END ADDRESS OF THE 0347 01008000
*                                      EXTENSION.                    */ 01009000
         LA    ENDPTR,SPCTSEGS(,SPCTPTR)                           0347 01010000
*   SWAPPTR=SWAPPTR+(LENGTH(SPCTEXTM)-LENGTH(SPCTENT));/* SET UP TO     01011000
*                                      OBTAIN THE FIRST LSQA ENTRY.  */ 01012000
         AL    SWAPPTR,@CF00057                                    0348 01013000
*   RESPECIFY                                                      0349 01014000
*    (PFTEPTR) RESTRICTED;                                         0349 01015000
*   PFTEPTR=PVTPFTP+RSMLSQAF;       /* SET UP POINTER TO FIRST LSQA     01016000
*                                      PFTE. EVERY ADDRESS SPACE MUST   01017000
*                                      HAVE AT LEAST ONE LSQA FRAME. */ 01018000
         LH    PFTEPTR,RSMLSQAF(,RSMHDPTR)                         0350 01019000
         N     PFTEPTR,@CF02704                                    0350 01020000
         AL    PFTEPTR,PVTPFTP(,PVTPTR)                            0350 01021000
*GETPFTE:                                                          0351 01022000
*   IF PFTBADPG='1'B THEN           /* TEST FOR A BAD FRAME (SOME  0351 01023000
*                                      KIND OF HARDWARE ERROR HAS  0351 01024000
*                                      OCCURRED WHEN USING THE     0351 01025000
*                                      FRAME).                       */ 01026000
*                                                                  0351 01027000
GETPFTE  TM    PFTBADPG(PFTEPTR),B'00000100'                       0351 01028000
         BNO   @RF00351                                            0351 01029000
*     /***************************************************************/ 01030000
*     /*                                                             */ 01031000
*     /* FRAME IS BAD. THE SWAP OUT IS TERMINATED SO THAT THE ADDRESS*/ 01032000
*     /* SPACE CAN STILL POSSIBLY RUN RATHER THAN BE ABENDED BECAUSE */ 01033000
*     /* OF I/O ERRORS ON THE BAD FRAME.                             */ 01034000
*     /*                                                             */ 01035000
*     /***************************************************************/ 01036000
*                                                                  0352 01037000
*     DO;                           /* RECORD THE STORAGE ERROR    0352 01038000
*                                      BEFORE ABORTING THE SWAP    0352 01039000
*                                                            @ZA19960*/ 01040000
*       FRPINCNT=255;               /* SRM RETRIES THE RCT         0353 01041000
*                                      QUIESCE/SWAP OUT SEQUENCE SO     01042000
*                                      OFTEN THAT A 078 ABEND LOOP 0353 01043000
*                                      RESULTS - SET A UNIQUE PINNED    01044000
*                                      COUNT SO THAT SOUT WILL ISSUE    01045000
*                                      A SYSEVENT DONTSWAP AFTER   0353 01046000
*                                      CLEANING UP ITS RESOURCES - 0353 01047000
*                                      THIS WILL PIN THE ADDRESS   0353 01048000
*                                      SPACE IN CORE UNTIL THE     0353 01049000
*                                      OUCBNDS FIELD IS RESET TO ZERO   01050000
*                                      BY SYSEVENT INITDET   @ZA19960*/ 01051000
         MVI   FRPINCNT(RSMHDPTR),X'FF'                            0353 01052000
*       IF PFTPREF='0'B THEN        /* FRAME OUTSIDE PREFERRED AREA ?*/ 01053000
         TM    PFTPREF(PFTEPTR),B'00000100'                        0354 01054000
         BNZ   @RF00354                                            0354 01055000
*         DO;                       /* YES, RECORD TO DOCUMENT     0355 01056000
*                                      POSSIBLE INABILITY TO VARY  0355 01057000
*                                      STORAGE OFF                   */ 01058000
*           R0='20'X;               /* SET STORAGE PINNED FOR STORAGE   01059000
*                                      ERROR CODE            @ZA19960*/ 01060000
         LA    R0,32                                               0356 01061000
*           CALL DOABEND;           /* RECORD THE STORAGE PINNING  0357 01062000
*                                                            @ZA19960*/ 01063000
         BAL   @14,DOABEND                                         0357 01064000
*           RETURN TO CLEANUP1;     /* EXIT ROUTINE.                 */ 01065000
         LA    @14,CLEANUP1                                        0358 01066000
@EL00002 DS    0H                                                  0358 01067000
@EF00002 DS    0H                                                  0358 01068000
@ER00002 BR    @14                                                 0358 01069000
*         END;                      /* END ERROR RECORDING           */ 01070000
*     END;                          /* END OF BAD LSQA FRAME       0360 01071000
*                                      PROCESSING            @ZA19960*/ 01072000
@RF00354 DS    0H                                                  0361 01073000
*   SPCTLSQA=SPCTLSQA+1;            /* INCREMENT COUNT OF LSQA     0361 01074000
*                                      ENTRIES IN THE SPCT.          */ 01075000
@RF00351 LA    @01,1                                               0361 01076000
         AH    @01,SPCTLSQA(,SPCTPTR)                              0361 01077000
         STH   @01,SPCTLSQA(,SPCTPTR)                              0361 01078000
*   SPCTVBN=PFTVBN;                 /* SET LSQA VBN IN THE SPCT -  0362 01079000
*                                      NOTE: ASSUME THAT LOW-ORDER 4    01080000
*                                      BITS ARE ALWAYS ZERO. @Z40WPYC*/ 01081000
         MVC   SPCTVBN(2,SWAPPTR),PFTVBN(PFTEPTR)                  0362 01082000
*   SPCTLSQ='1'B;                   /* MARK ENTRY AS LSQA ENTRY.     */ 01083000
         OI    SPCTLSQ(SWAPPTR),B'01000000'                        0363 01084000
*   SWAPPTR=SWAPPTR+LENGTH(SPCTLS); /* GET THE ADDRESS OF THE NEXT 0364 01085000
*                                      LSQA ENTRY IN THIS EXTENSION. */ 01086000
         AL    SWAPPTR,@CF00970                                    0364 01087000
*   IF SWAPPTR=ENDPTR THEN          /* TEST IF THE EXTENSION IS FULL.*/ 01088000
         CR    SWAPPTR,ENDPTR                                      0365 01089000
         BNE   @RF00365                                            0365 01090000
*     DO;                           /* THE EXTENSION IS FULL OF LSQA    01091000
*                                      ENTRIES. AN ADDITIONAL      0366 01092000
*                                      EXTENSION MUST BE OBTAINED.   */ 01093000
*       RESPECIFY                                                  0367 01094000
*        (BEGPTR) RESTRICTED;                                      0367 01095000
*       BEGPTR=BEGEXT;              /* GET THE ADDRESS OF THE      0368 01096000
*                                      EXTENSION BEGINNING.          */ 01097000
         L     BEGPTR,BEGEXT(,PVTPTR)                              0368 01098000
*       CALL GETEXT;                /* CALL SUBROUTINE TO GET AN   0369 01099000
*                                      ADDITIONAL EXTENSION.         */ 01100000
         BAL   @14,GETEXT                                          0369 01101000
*       RESPECIFY                                                  0370 01102000
*        (BEGPTR) UNRESTRICTED;                                    0370 01103000
*                                                                  0370 01104000
*       /*************************************************************/ 01105000
*       /*                                                           */ 01106000
*       /* IF CONTROL COMES TO HERE, AN ADDITIONAL EXTENSION WAS     */ 01107000
*       /* OBTAINED SUCCESSFULLY.                                    */ 01108000
*       /*                                                           */ 01109000
*       /*************************************************************/ 01110000
*                                                                  0371 01111000
*     END;                          /* ON RETURN, SWAPPTR POINTS TO     01112000
*                                      THE FIRST AVAILABLE SPCT LSQA    01113000
*                                      ENTRY                         */ 01114000
*   IF PFTFQPTR^=0 THEN             /* TEST FOR MORE LSQA FRAMES.    */ 01115000
@RF00365 LH    @01,PFTFQPTR(,PFTEPTR)                              0372 01116000
         N     @01,@CF02704                                        0372 01117000
         LTR   @01,@01                                             0372 01118000
         BZ    @RF00372                                            0372 01119000
*     DO;                           /* ARE MORE PFTES. GET THE     0373 01120000
*                                      ADDRESS OF THE NEXT.          */ 01121000
*       PFTEPTR=PVTPFTP+PFTFQPTR;   /* GET THE ADDRESS OF THE NEXT 0374 01122000
*                                      PFTE FROM THE FOREWARD RBN PTR   01123000
*                                      OF THE PRESENT PFTE.          */ 01124000
         AL    @01,PVTPFTP(,PVTPTR)                                0374 01125000
         LR    PFTEPTR,@01                                         0374 01126000
*       GOTO GETPFTE;               /* ARE MORE LSQA FRAMES. GO    0375 01127000
*                                      PROCESS THEM.                 */ 01128000
         B     GETPFTE                                             0375 01129000
*     END;                                                         0376 01130000
*                                                                  0376 01131000
*   /*****************************************************************/ 01132000
*   /*                                                               */ 01133000
*   /* EXIT FROM THE LSQA PROCESSOR                                  */ 01134000
*   /*                                                               */ 01135000
*   /*****************************************************************/ 01136000
*                                                                  0377 01137000
*EXITLSQA:                                                         0377 01138000
*   RESPECIFY                                                      0377 01139000
*    (R14) RESTRICTED;                                             0377 01140000
@RF00372 DS    0H                                                  0377 01141000
EXITLSQA DS    0H                                                  0378 01142000
*   R14=LEV1RTN;                    /* GET THE RETURN ADDRESS.       */ 01143000
         L     R14,LEV1RTN(,PVTPTR)                                0378 01144000
*   RESPECIFY                                                      0379 01145000
*    (R14,                                                         0379 01146000
*     SWAPPTR,                                                     0379 01147000
*     ENDPTR,                                                      0379 01148000
*     PFTEPTR) UNRESTRICTED;                                       0379 01149000
*   END LSQANTRY;                                                  0380 01150000
         B     @EL00002                                            0380 01151000
*                                                                  0381 01152000
*   /*****************************************************************/ 01153000
*   /*                                                               */ 01154000
*   /* THIS SECTION BUILDS FIX ENTRIES IN THE SPCT FOR EACH VBN FIXED*/ 01155000
*   /* BY A TCB. THE ENTRIES ARE MADE FROM ALL FOES CHAINED OUT OF   */ 01156000
*   /* ALL TCBS IN THE ADDRESS SPACE.                                */ 01157000
*   /*                                                               */ 01158000
*   /*****************************************************************/ 01159000
*                                                                  0381 01160000
*FIXENTRY:                                                         0381 01161000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0381 01162000
FIXENTRY DS    0H                                                  0382 01163000
*   RESPECIFY                                                      0382 01164000
*    (TCBPTR,                                                      0382 01165000
*     FOEPTR,                                                      0382 01166000
*     R14) RESTRICTED;                                             0382 01167000
*   LEV1RTN=R14;                    /* SAVE THE RETURN ADDRESS.      */ 01168000
         ST    R14,LEV1RTN(,PVTPTR)                                0383 01169000
*   RESPECIFY                                                      0384 01170000
*    (R14) UNRESTRICTED;                                           0384 01171000
*   TCBPTR=ASXBFTCB;                /* GET THE ADDRESS OF THE FIRST     01172000
*                                      TCB IN THE ADDRESS SPACE.   0385 01173000
*                                      SINCE SWAP OUT IS RUNNING   0385 01174000
*                                      UNDER THE RCT TCB, THERE MUST    01175000
*                                      BE AT LEAST ONE TCB.          */ 01176000
         L     @12,ASCBPTR                                         0385 01177000
         L     @01,ASXBPTR(,@12)                                   0385 01178000
         L     TCBPTR,ASXBFTCB(,@01)                               0385 01179000
*FIRSTFOE:                                                         0386 01180000
*   FOEPTR=TCBFOEA;                 /* GET THE POINTER TO THE FIRST     01181000
*                                      FOE FOR THIS TCB.             */ 01182000
FIRSTFOE L     FOEPTR,TCBFOEA-1(,TCBPTR)                           0386 01183000
         LA    FOEPTR,0(,FOEPTR)                                   0386 01184000
*   IF FOEPTR=0 THEN                /* TEST FOR NO MORE FOES FOR THIS   01185000
*                                      TCB.                          */ 01186000
         LTR   FOEPTR,FOEPTR                                       0387 01187000
         BZ    @RT00387                                            0387 01188000
*     GOTO NEXTTCB;                 /* ARE NO MORE FOES FOR THIS TCB.   01189000
*                                      GO GET THE NEXT TCB AND     0388 01190000
*                                      PROCESS SIMILARLY.            */ 01191000
*                                                                  0388 01192000
*   /*****************************************************************/ 01193000
*   /*                                                               */ 01194000
*   /* IF HERE, THERE IS A FOE FOR THE TCB. NOTE THAT IF THE FOE FIX */ 01195000
*   /* COUNT IS ZERO, THE FOE CANNOT BE FREEMAINED. FREEMAINING THE  */ 01196000
*   /* FOE MAY CAUSE LSQA TO CONTRACT, PERHAPS WITH THE RESULT THAT A*/ 01197000
*   /* LSQA PAGE IS FREED. SINCE THE LSQA ENTRIES ARE ALREADY BUILT, */ 01198000
*   /* THIS WOULD RESULT IN SWAPPING IN A PAGE THAT HAD BEEN FREED.  */ 01199000
*   /*                                                               */ 01200000
*   /*****************************************************************/ 01201000
*                                                                  0389 01202000
*TESTFIX:                                                          0389 01203000
*   IF FOEFXCT^=0 THEN              /* TEST IF THE FOE HAS A FIX   0389 01204000
*                                      COUNT (NON-ZERO).             */ 01205000
TESTFIX  LH    @12,FOEFXCT(,FOEPTR)                                0389 01206000
         LTR   @12,@12                                             0389 01207000
         BZ    @RF00389                                            0389 01208000
*     DO;                                                          0390 01209000
*       RESPECIFY                                                  0391 01210000
*        (R1,                                                      0391 01211000
*         SWAPPTR) RESTRICTED;                                     0391 01212000
*       R1=FOEVINDX;                /* GET THE VBN OF THE FIXED PAGE.*/ 01213000
         LH    R1,FOEVINDX(,FOEPTR)                                0392 01214000
         N     R1,@CF02704                                         0392 01215000
*       CALL GETFIX;                /* CALL SUBROUTINE TO GET THE  0393 01216000
*                                      SPCT ENTRY FOR THIS FIXED VBN    01217000
*                                      OR TO CREATE A NEW SPCT FIX 0393 01218000
*                                      ENTRY FOR THE VBN. ON RETURN     01219000
*                                      FROM GETFIX, SWAPPTR POINTS TO   01220000
*                                      THE FIX ENTRY.                */ 01221000
         BAL   @14,GETFIX                                          0393 01222000
*       SPCTFIXC=SPCTFIXC+FOEFXCT;  /* INCREMENT THE TOTAL FIX COUNT    01223000
*                                      FOR THE PAGE BY THE FIX COUNT    01224000
*                                      FOR THIS TCB.                 */ 01225000
         LH    @11,SPCTFIXC(,SWAPPTR)                              0394 01226000
         AH    @11,FOEFXCT(,FOEPTR)                                0394 01227000
         STH   @11,SPCTFIXC(,SWAPPTR)                              0394 01228000
*       RESPECIFY                                                  0395 01229000
*        (R1,                                                      0395 01230000
*         SWAPPTR) UNRESTRICTED;                                   0395 01231000
*     END;                          /* FINISHED PROC FOR A NORMAL  0396 01232000
*                                      FOE.                          */ 01233000
*   FOEPTR=FOEFLINK;                /* GET THE ADDRESS OF THE NEXT 0397 01234000
*                                      FOE TO BE PROCESSED.          */ 01235000
@RF00389 L     @12,FOEFLINK-1(,FOEPTR)                             0397 01236000
         LA    @12,0(,@12)                                         0397 01237000
         LR    FOEPTR,@12                                          0397 01238000
*   IF FOEPTR^=0 THEN               /* TEST IF THERE ARE MORE FOES 0398 01239000
*                                      FOR THIS TCB TO BE PROCESSED. */ 01240000
         LTR   FOEPTR,FOEPTR                                       0398 01241000
         BNZ   @RT00398                                            0398 01242000
*     GOTO TESTFIX;                 /* ARE MORE FOES. GO PROCESS   0399 01243000
*                                      THEM.                         */ 01244000
*NEXTTCB:                                                          0400 01245000
*   TCBPTR=TCBTCB;                  /* GET THE ADDRESS OF THE NEXT 0400 01246000
*                                      TCB IN THE ADDRESS SPACE.     */ 01247000
NEXTTCB  L     TCBPTR,TCBTCB(,TCBPTR)                              0400 01248000
*   IF TCBPTR^=0 THEN               /* TEST IF THERE IS ANOTHER TCB     01249000
*                                      FOR THE ADDRESS SPACE.        */ 01250000
         LTR   TCBPTR,TCBPTR                                       0401 01251000
         BNZ   @RT00401                                            0401 01252000
*     GOTO FIRSTFOE;                /* THERE IS ANOTHER TCB TO DO. GO   01253000
*                                      GET THE FIRST FOE FOR THE NEW    01254000
*                                      TCB AND PROCESS.              */ 01255000
*                                                                  0402 01256000
*   /*****************************************************************/ 01257000
*   /*                                                               */ 01258000
*   /* EXIT FROM THE FIX ENTRY PROCESSOR                             */ 01259000
*   /*                                                               */ 01260000
*   /*****************************************************************/ 01261000
*                                                                  0403 01262000
*EXITFIX:                                                          0403 01263000
*   RESPECIFY                                                      0403 01264000
*    (R14) RESTRICTED;                                             0403 01265000
EXITFIX  DS    0H                                                  0404 01266000
*   R14=LEV1RTN;                    /* GET THE RETURN ADDRESS.       */ 01267000
         L     R14,LEV1RTN(,PVTPTR)                                0404 01268000
*   RESPECIFY                                                      0405 01269000
*    (TCBPTR,                                                      0405 01270000
*     FOEPTR,                                                      0405 01271000
*     R14) UNRESTRICTED;                                           0405 01272000
*   END FIXENTRY;                                                  0406 01273000
@EL00003 DS    0H                                                  0406 01274000
@EF00003 DS    0H                                                  0406 01275000
@ER00003 BR    @14                                                 0406 01276000
*                                                                  0407 01277000
*   /*****************************************************************/ 01278000
*   /*                                                               */ 01279000
*   /* PAGING PURGE PROCESSOR. PROCESS THE COMMON I/O ACTIVE QUEUE,  */ 01280000
*   /* THE LOCAL I/O ACTIVE QUEUE AND THE GFA DEFER QUEUE IN THAT    */ 01281000
*   /* ORDER.                                                        */ 01282000
*   /*                                                               */ 01283000
*   /*****************************************************************/ 01284000
*                                                                  0407 01285000
*PIOPURGE:                                                         0407 01286000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0407 01287000
PIOPURGE DS    0H                                                  0408 01288000
*   RFY                                                            0408 01289000
*    (R1,                                                          0408 01290000
*     R4,                                                          0408 01291000
*     R11,                                                         0408 01292000
*     R14) RSTD;                                                   0408 01293000
*   RFY                                                            0409 01294000
*     XPTE BASED(PCBXPTA);                                         0409 01295000
*   RFY                                                            0410 01296000
*     PGTPTE BASED(PCBPGTA);                                       0410 01297000
*   RFY                                                            0411 01298000
*     PCBR BASED(PCBRTPA);                                         0411 01299000
*   LEV1RTN=R14;                    /* SAVE RETURN ADDRESS           */ 01300000
         ST    R14,LEV1RTN(,PVTPTR)                                0412 01301000
*   RFY                                                            0413 01302000
*    (R14) UNRSTD;                                                 0413 01303000
*   DOINGCOM='1'B;                  /* DOING COMMON QUEUE, DOING GFA    01304000
*                                      QUEUE FLAG AND NOSPCTE FLAG 0414 01305000
*                                      ARE ALREADY ZERO              */ 01306000
         OI    DOINGCOM(PVTPTR),B'01000000'                        0414 01307000
*   R11=PVTCIOQL;                   /* ADDRESS OF LAST PCB ON COMMON    01308000
*                                      Q                             */ 01309000
*                                                                  0415 01310000
         L     R11,PVTCIOQL(,PVTPTR)                               0415 01311000
*   /*****************************************************************/ 01312000
*   /*                                                               */ 01313000
*   /* DO EVERY PCB ON THE COMMON I/O ACTIVE Q                       */ 01314000
*   /*                                                               */ 01315000
*   /*****************************************************************/ 01316000
*                                                                  0416 01317000
*NEXPCB:                                                           0416 01318000
*   DO WHILE(R11^=0);                                              0416 01319000
NEXPCB   B     @DE00416                                            0416 01320000
@DL00416 DS    0H                                                  0417 01321000
*     R4=R11;                       /* HOLD ADDR OF LAST RELATED   0417 01322000
*                                      PROCESSED                     */ 01323000
         LR    R4,R11                                              0417 01324000
*     PCBPTR=R11->PCBRLPA;          /* GET ADDRESS OF RELATED        */ 01325000
*                                                                  0418 01326000
         L     PCBPTR,PCBRLPA-1(,R11)                              0418 01327000
         LA    PCBPTR,0(,PCBPTR)                                   0418 01328000
*     /***************************************************************/ 01329000
*     /*                                                             */ 01330000
*     /* DO ALL RELATED PCB'S ON THIS Q'D PCB                        */ 01331000
*     /*                                                             */ 01332000
*     /***************************************************************/ 01333000
*                                                                  0419 01334000
*     DO WHILE(PCBPTR^=0);          /* DO ALL RELATEDS FIRST         */ 01335000
         B     @DE00419                                            0419 01336000
@DL00419 DS    0H                                                  0420 01337000
*       IF PCBASCB=PSAAOLD THEN     /* IF THE PCB IS FOR THIS ADDRESS   01338000
*                                      SPACE PROCESS IT              */ 01339000
         CLC   PCBASCB(4,PCBPTR),PSAAOLD                           0420 01340000
         BNE   @RF00420                                            0420 01341000
*         DO;                                                      0421 01342000
*           LASTRLT=R4;             /* SAVE PTR TO LAST RLT          */ 01343000
         ST    R4,LASTRLT(,PVTPTR)                                 0422 01344000
*           CALL PCBPROC;           /* PROCESS RELATED PCB           */ 01345000
         BAL   @14,PCBPROC                                         0423 01346000
*           IF KEEPPCB='1'B THEN    /* IS PCB TO BE KEPT             */ 01347000
         TM    KEEPPCB(PVTPTR),B'00010000'                         0424 01348000
         BO    @RT00424                                            0424 01349000
*             GO TO RLTDEND;        /* DO NOT REMOVE THIS RELATED    */ 01350000
*           R4=LASTRLT;             /* GET PTR TO LAST RLT           */ 01351000
         L     R4,LASTRLT(,PVTPTR)                                 0426 01352000
*           R4->PCBRLPA=PCBPTR->PCBRLPA;/* REMOVE RELATED FROM     0427 01353000
*                                      RELATED CHAIN                 */ 01354000
         MVC   PCBRLPA(3,R4),PCBRLPA(PCBPTR)                       0427 01355000
*           R0=PCBFREQN;            /* PCB TO FREE Q                 */ 01356000
         LA    R0,16                                               0428 01357000
*           R1=PCBPTR;              /* ADDRESS OF PCB                */ 01358000
         LR    R1,PCBPTR                                           0429 01359000
*           CALL IEAVPCB;           /* GO FREE IT                    */ 01360000
         L     @15,PVTPCB(,PVTPTR)                                 0430 01361000
         BALR  @14,@15                                             0430 01362000
*           GO TO RLTDE2;           /* GO SET TO NEXT RELATED        */ 01363000
         B     RLTDE2                                              0431 01364000
*         END;                                                     0432 01365000
*RLTDEND:                                                          0433 01366000
*       R4=PCBPTR;                  /* UPDATE POINTER TO LAST RELATED   01367000
*                                      PCB PROCESSED                 */ 01368000
@RF00420 DS    0H                                                  0433 01369000
RLTDEND  LR    R4,PCBPTR                                           0433 01370000
*RLTDE2:                                                           0434 01371000
*       PCBPTR=R4->PCBRLPA;         /* SET PCBPTR TO CHECK FOR     0434 01372000
*                                      ANOTHER RELATED PCB           */ 01373000
RLTDE2   L     PCBPTR,PCBRLPA-1(,R4)                               0434 01374000
         LA    PCBPTR,0(,PCBPTR)                                   0434 01375000
*     END;                                                         0435 01376000
@DE00419 LTR   PCBPTR,PCBPTR                                       0435 01377000
         BNZ   @DL00419                                            0435 01378000
*                                                                  0436 01379000
*     /***************************************************************/ 01380000
*     /*                                                             */ 01381000
*     /* ALL RELATEDS HAVE BEEN PROCESSED, NOW PROCESS THE Q'D COMMON*/ 01382000
*     /* AREA PCB                                                    */ 01383000
*     /*                                                             */ 01384000
*     /***************************************************************/ 01385000
*                                                                  0436 01386000
*     PCBPTR=R11;                   /* COPY POINTER TO PROCESS Q'D   */ 01387000
         LR    PCBPTR,R11                                          0436 01388000
*     R11=PCBBQPA;                  /* SET TO NEXT PCB ON Q          */ 01389000
         L     R11,PCBBQPA(,PCBPTR)                                0437 01390000
*     IF PCBASCB=PSAAOLD THEN       /* IS THE QUEUED PCB FOR THIS  0438 01391000
*                                      ADDRESS SPACE                 */ 01392000
         CLC   PCBASCB(4,PCBPTR),PSAAOLD                           0438 01393000
         BNE   @RF00438                                            0438 01394000
*       DO;                                                        0439 01395000
*                                                                  0439 01396000
*         /***********************************************************/ 01397000
*         /*                                                         */ 01398000
*         /* IS Q'D PCB A PAGE OUT PCB                               */ 01399000
*         /*                                                         */ 01400000
*         /***********************************************************/ 01401000
*                                                                  0440 01402000
*         IF PCBIOI='1'B THEN                                      0440 01403000
         TM    PCBIOI(PCBPTR),B'00000010'                          0440 01404000
         BNO   @RF00440                                            0440 01405000
*           IF PCBSUPRS='0'B THEN   /* WAS PAGE OUT RECLAIMED BY GFA */ 01406000
         TM    PCBSUPRS(PCBPTR),B'00001000'                        0441 01407000
         BNZ   @RF00441                                            0441 01408000
*             PCBFREAL='1'B;        /* IF RBN CAN BE USED MAKE SURE     01409000
*                                      FRAME IS FREED WHEN I/O     0442 01410000
*                                      COMPLETES                     */ 01411000
         OI    PCBFREAL(PCBPTR),B'10000000'                        0442 01412000
*           ELSE                                                   0443 01413000
*             ;                     /* WAS GFA RECLAIM               */ 01414000
@RF00441 DS    0H                                                  0444 01415000
*         ELSE                      /* PCB IS A PAGE IN PCB          */ 01416000
*           DO;                                                    0444 01417000
         B     @RC00440                                            0444 01418000
@RF00440 DS    0H                                                  0445 01419000
*             CALL PCBPROC;         /* PROCESS Q'D PAGE IN PCB       */ 01420000
*                                                                  0445 01421000
         BAL   @14,PCBPROC                                         0445 01422000
*             /*******************************************************/ 01423000
*             /*                                                     */ 01424000
*             /* ARE THERE ANY RELATEDS LEFT ON RLTD CHAIN           */ 01425000
*             /*                                                     */ 01426000
*             /*******************************************************/ 01427000
*                                                                  0446 01428000
*             IF PCBRLPA^=0 THEN                                   0446 01429000
         L     @12,PCBRLPA-1(,PCBPTR)                              0446 01430000
         LA    @12,0(,@12)                                         0446 01431000
         LTR   @12,@12                                             0446 01432000
         BZ    @RF00446                                            0446 01433000
*               DO;                                                0447 01434000
*                                                                  0447 01435000
*                 /***************************************************/ 01436000
*                 /*                                                 */ 01437000
*                 /* THERE ARE RLTDS LEFT, IS I/O COMP               */ 01438000
*                 /*                                                 */ 01439000
*                 /***************************************************/ 01440000
*                                                                  0448 01441000
*                 IF PCBIOCMP='1'B THEN                            0448 01442000
*                                                                  0448 01443000
         TM    PCBIOCMP(PCBPTR),B'00000001'                        0448 01444000
         BNO   @RF00448                                            0448 01445000
*                   /*************************************************/ 01446000
*                   /*                                               */ 01447000
*                   /* I/O IS COMPLETE, FREE Q'D PCB                 */ 01448000
*                   /*                                               */ 01449000
*                   /*************************************************/ 01450000
*                                                                  0449 01451000
*                   DO;                                            0449 01452000
*                     PCBVBN=0;     /* CLEAR VBN TO PREVENT TWO ON Q    01453000
*                                      WITH SAME VBN AT SAME TIME    */ 01454000
         SLR   @06,@06                                             0450 01455000
         STH   @06,PCBVBN(,PCBPTR)                                 0450 01456000
*                     R1=PCBRLPA;                                  0451 01457000
         LR    R1,@12                                              0451 01458000
*                     R0=PCBCIOQN;  /* RELATED CHAIN TO COMMON Q     */ 01459000
         LA    R0,32                                               0452 01460000
*                     CALL IEAVPCB; /* ENQ                           */ 01461000
         L     @15,PVTPCB(,PVTPTR)                                 0453 01462000
         BALR  @14,@15                                             0453 01463000
*                     CALL IEAVOPBR;/* SCHED IOCP FOR FIRST RLTD     */ 01464000
         L     @15,PVTPOPBR(,PVTPTR)                               0454 01465000
         BALR  @14,@15                                             0454 01466000
*                     R0=PCBFREQN;                                 0455 01467000
         LA    R0,16                                               0455 01468000
*                     R1=PCBPTR;    /* FREE Q'D                      */ 01469000
         LR    R1,PCBPTR                                           0456 01470000
*                     CALL IEAVPCB; /* FREE QUEUED                   */ 01471000
         L     @15,PVTPCB(,PVTPTR)                                 0457 01472000
         BALR  @14,@15                                             0457 01473000
*                   END;                                           0458 01474000
*                 ELSE                                             0459 01475000
*                   ;                                              0459 01476000
@RF00448 DS    0H                                                  0460 01477000
*               END;                                               0460 01478000
*                                                                  0460 01479000
*             /*******************************************************/ 01480000
*             /*                                                     */ 01481000
*             /* NO RELATEDS LEFT, PROCESS Q'D                       */ 01482000
*             /*                                                     */ 01483000
*             /*******************************************************/ 01484000
*                                                                  0461 01485000
*             ELSE                                                 0461 01486000
*               DO;                 /* THERE ARE NO RELATEDS LEFT    */ 01487000
         B     @RC00446                                            0461 01488000
@RF00446 DS    0H                                                  0462 01489000
*                 IF PCBIOERR='1'B THEN/* IS THIS AN I/O COMP AND I/O   01490000
*                                      ERR PCB                       */ 01491000
         TM    PCBIOERR(PCBPTR),B'00100000'                        0462 01492000
         BNO   @RF00462                                            0462 01493000
*                   DO;                                            0463 01494000
*                     RFY                                          0464 01495000
*                      (R5) RSTD;                                  0464 01496000
*                     R5=PVTPFTP+PCBRBN;                           0465 01497000
         LH    R5,PCBRBN(,PCBPTR)                                  0465 01498000
         N     R5,@CF02704                                         0465 01499000
         AL    R5,PVTPFTP(,PVTPTR)                                 0465 01500000
*                     R5->PFTPCBSI='0'B;/* PCB DEFINED OFF           */ 01501000
         NI    PFTPCBSI(R5),B'11110111'                            0466 01502000
*                     IF R5->PFTDFRLS='1'B THEN/* IS IT DEFERED    0467 01503000
*                                      RELEASE                       */ 01504000
         TM    PFTDFRLS(R5),B'10000000'                            0467 01505000
         BNO   @RF00467                                            0467 01506000
*                       DO;                                        0468 01507000
*                         IF R5->PFTFXCT^=0 THEN                   0469 01508000
         LH    @12,PFTFXCT(,R5)                                    0469 01509000
         LTR   @12,@12                                             0469 01510000
         BZ    @RF00469                                            0469 01511000
*                           DO;                                    0470 01512000
*                             IF PCBVBN>=PVTLCSA THEN              0471 01513000
         CLC   PCBVBN(2,PCBPTR),PVTLCSA(PVTPTR)                    0471 01514000
         BL    @RF00471                                            0471 01515000
*                               PVTCOMFX=PVTCOMFX-1;/* DECREMENT   0472 01516000
*                                      GLOBAL COMMON AREA FIX COUNT     01517000
*                                                            @YA01572*/ 01518000
         LH    @12,PVTCOMFX(,PVTPTR)                               0472 01519000
         BCTR  @12,0                                               0472 01520000
         STH   @12,PVTCOMFX(,PVTPTR)                               0472 01521000
*                             ELSE                                 0473 01522000
*                               RSMCNTFX=RSMCNTFX-1;/* DECREMENT   0473 01523000
*                                      COUNT FOR ADDR SPACE  @YA01572*/ 01524000
         B     @RC00471                                            0473 01525000
@RF00471 LH    @12,RSMCNTFX(,RSMHDPTR)                             0473 01526000
         BCTR  @12,0                                               0473 01527000
         STH   @12,RSMCNTFX(,RSMHDPTR)                             0473 01528000
*                             PVTCNTFX=PVTCNTFX-1;/* DECREMENT SYSTEM   01529000
*                                      COUNT                 @YA01572*/ 01530000
@RC00471 LH    @12,PVTCNTFX(,PVTPTR)                               0474 01531000
         BCTR  @12,0                                               0474 01532000
         STH   @12,PVTCNTFX(,PVTPTR)                               0474 01533000
*                           END;                                   0475 01534000
*                         R5->PFTFXCT=0;/* FIX CT MUST BE ZEROED   0476 01535000
*                                      SINCE ALL PCB'S HAVE GONE AWAY*/ 01536000
@RF00469 SLR   @12,@12                                             0476 01537000
         STH   @12,PFTFXCT(,R5)                                    0476 01538000
*                         R1=PCBVBN*256;/* MAKE VBN AN ADDR TO BE  0477 01539000
*                                      RELEASED                      */ 01540000
         LH    R1,PCBVBN(,PCBPTR)                                  0477 01541000
         N     R1,@CF02704                                         0477 01542000
         SLA   R1,8                                                0477 01543000
*                         CALL IEAVRELF;/* CALL DEFERED RELEASE      */ 01544000
         L     @15,PVTPRELF(,PVTPTR)                               0478 01545000
         BALR  @14,@15                                             0478 01546000
*                         RFY                                      0479 01547000
*                          (R15) RSTD;                             0479 01548000
*                         RCACSECT=RCACSPOT;/* RESET CSECT ID        */ 01549000
         L     @14,RCAPTR(,PVTPTR)                                 0480 01550000
         MVI   RCACSECT(@14),X'1A'                                 0480 01551000
*                         IF R15^=0 THEN/* TEST FOR SUCCESSFUL     0481 01552000
*                                      COMPLETION                    */ 01553000
         LTR   R15,R15                                             0481 01554000
         BZ    @RF00481                                            0481 01555000
*                           DO;                                    0482 01556000
*                             R0='0F'X;/* RECORD ERROR IN COMPLETION    01557000
*                                      OF DEFERED RELEASE PROCESSING */ 01558000
         LA    R0,15                                               0483 01559000
*                             CALL DOABEND;/* RECORD THE ERROR.      */ 01560000
         BAL   @14,DOABEND                                         0484 01561000
*                           END;                                   0485 01562000
*                         RESPECIFY                                0486 01563000
*                          (R5,                                    0486 01564000
*                           R15) UNRESTRICTED;                     0486 01565000
@RF00481 DS    0H                                                  0487 01566000
*                       END;                                       0487 01567000
*                     ELSE                                         0488 01568000
*                       ;           /* NOT DEFERED RELEASE           */ 01569000
*                                                                  0488 01570000
@RF00467 DS    0H                                                  0489 01571000
*                     /***********************************************/ 01572000
*                     /*                                             */ 01573000
*                     /* FRAME CAN BE FREED                          */ 01574000
*                     /*                                             */ 01575000
*                     /***********************************************/ 01576000
*                                                                  0489 01577000
*                     R0=PCBRBN;                                   0489 01578000
         LH    R0,PCBRBN(,PCBPTR)                                  0489 01579000
         N     R0,@CF02704                                         0489 01580000
*                     R0=R0|CONSPFTE;/* FRAME TO FRONT OF AFQ        */ 01581000
         O     R0,@CF02502                                         0490 01582000
*                     CALL IEAVPFTE;/* FREE FRAME                    */ 01583000
         L     @15,PVTPFTE(,PVTPTR)                                0491 01584000
         BALR  @14,@15                                             0491 01585000
*                     R0=PCBFREQN;  /* GET THE FREE QUEUE ID.        */ 01586000
         LA    R0,16                                               0492 01587000
*                     R1=PCBPTR;    /* GET THE ADDR OF THE PCB TO BE    01588000
*                                      FREED.                        */ 01589000
         LR    R1,PCBPTR                                           0493 01590000
*                     CALL IEAVPCB; /* FREE THE PCB.                 */ 01591000
         L     @15,PVTPCB(,PVTPTR)                                 0494 01592000
         BALR  @14,@15                                             0494 01593000
*                   END;            /* END OF I/O ERR PROCESS        */ 01594000
*                 ELSE              /* THERE ARE NO RELATEDS AND   0496 01595000
*                                      THERE WAS NO I/O ERROR. IF I/O   01596000
*                                      COMPLETED NORMALLY FREE THE 0496 01597000
*                                      PCB.                          */ 01598000
*                   DO;                                            0496 01599000
         B     @RC00462                                            0496 01600000
@RF00462 DS    0H                                                  0497 01601000
*                     IF PCBIOCMP='1'B THEN/* IS I/O COMPLETE        */ 01602000
         TM    PCBIOCMP(PCBPTR),B'00000001'                        0497 01603000
         BNO   @RF00497                                            0497 01604000
*                       DO;                                        0498 01605000
*                         R0=PCBFREQN;                             0499 01606000
         LA    R0,16                                               0499 01607000
*                         R1=PCBPTR;/* PCB TO BE FREED               */ 01608000
         LR    R1,PCBPTR                                           0500 01609000
*                         CALL IEAVPCB;/* FREE Q'D PCB FRAME WAS   0501 01610000
*                                      VALIDATED                     */ 01611000
         L     @15,PVTPCB(,PVTPTR)                                 0501 01612000
         BALR  @14,@15                                             0501 01613000
*                       END;                                       0502 01614000
*                     ELSE          /* I/O IS NOT COMPLETE, TURN ON     01615000
*                                      FREAL FLAG UNLESS PCB WAS A 0503 01616000
*                                      ZERO TCB FIX AND FIX IS TO  0503 01617000
*                                      COMPLETE NORMALLY.            */ 01618000
*                       IF KEEPPCB='0'B THEN/* DO WE KEEP PCB        */ 01619000
         B     @RC00497                                            0503 01620000
@RF00497 TM    KEEPPCB(PVTPTR),B'00010000'                         0503 01621000
         BNZ   @RF00503                                            0503 01622000
*                         PCBFREAL='1'B;                           0504 01623000
         OI    PCBFREAL(PCBPTR),B'10000000'                        0504 01624000
*                   END;                                           0505 01625000
@RF00503 DS    0H                                                  0505 01626000
@RC00497 DS    0H                                                  0506 01627000
*               END;                                               0506 01628000
@RC00462 DS    0H                                                  0507 01629000
*           END;                    /* END OF Q'D PCB IS PAGE IN PCB */ 01630000
@RC00446 DS    0H                                                  0508 01631000
*       END;                                                       0508 01632000
@RC00440 DS    0H                                                  0509 01633000
*   END;                            /* END OF COMMON Q LOOP          */ 01634000
@RF00438 DS    0H                                                  0509 01635000
@DE00416 LTR   R11,R11                                             0509 01636000
         BNZ   @DL00416                                            0509 01637000
*                                                                  0510 01638000
*   /*****************************************************************/ 01639000
*   /*                                                               */ 01640000
*   /* PROCESS LOCAL I/O ACTIVE QUEUE                                */ 01641000
*   /*                                                               */ 01642000
*   /*****************************************************************/ 01643000
*                                                                  0510 01644000
*   R11=RSMLIOQL;                   /* SET TO LAST PCB ON LOCAL I/O     01645000
*                                      ACTIVE Q                      */ 01646000
         L     R11,RSMLIOQL(,RSMHDPTR)                             0510 01647000
*   DOINGCOM='0'B;                  /* NO LONGER DOING COMMON Q      */ 01648000
         NI    DOINGCOM(PVTPTR),B'10111111'                        0511 01649000
*   RSMCPNU='0'B;                   /* CLEAR FLAG TO SCHEDULE IOCP 0512 01650000
*                                      WITH THE LOCAL LOCK   @Z30GNYD*/ 01651000
*   RSMCPNC='0'B;                   /* CLEAR FLAG TO SCHEDULE IOCP 0513 01652000
*                                      WITHOUT THE LOCAL LOCK      0513 01653000
*                                                            @Z30GNYD*/ 01654000
         NI    RSMCPNU(RSMHDPTR),B'11100111'                       0513 01655000
*   DO WHILE(R11^=0);               /* DO FOR EVERY PCB ON LOCAL Q   */ 01656000
         B     @DE00514                                            0514 01657000
@DL00514 DS    0H                                                  0515 01658000
*     PCBPTR=R11;                   /* SET PCBPTR TO PROCESS THE   0515 01659000
*                                      QUEUED PCB                    */ 01660000
*                                                                  0515 01661000
         LR    PCBPTR,R11                                          0515 01662000
*     /***************************************************************/ 01663000
*     /*                                                             */ 01664000
*     /* IF IT IS A VIO FRAME ON THE WAY IN DO NOT SET BIT MASK AS A */ 01665000
*     /* COPY WILL NOT BE AVAILABLE UNDER MEMORY LPID. ALSO IF THE   */ 01666000
*     /* PAGE WAS ON ITS WAY OUT DO NOT SET A BIT IN THE BIT MASK.   */ 01667000
*     /* THE XPT ADDRESS MAY NOT BE VALID FOR A RELEASED (FREEMAINED)*/ 01668000
*     /* PAGE SO THE ORDER OF TESTS IS IMPORTANT                     */ 01669000
*     /*                                                             */ 01670000
*     /***************************************************************/ 01671000
*                                                                  0516 01672000
*     IF(PCBIOI='1'B&PCBRLPA=0)|(PCBVBN^=0&XPTVIO='1'B&XPTVIOLP='1'B)   01673000
*       THEN                        /*                       @Z40WPYC*/ 01674000
         TM    PCBIOI(PCBPTR),B'00000010'                          0516 01675000
         BNO   @GL00002                                            0516 01676000
         L     @12,PCBRLPA-1(,PCBPTR)                              0516 01677000
         LA    @12,0(,@12)                                         0516 01678000
         LTR   @12,@12                                             0516 01679000
         BZ    @RT00516                                            0516 01680000
@GL00002 LH    @12,PCBVBN(,PCBPTR)                                 0516 01681000
         N     @12,@CF02704                                        0516 01682000
         LTR   @12,@12                                             0516 01683000
         BZ    @RF00516                                            0516 01684000
         L     @12,PCBXPTA-1(,PCBPTR)                              0516 01685000
         TM    XPTVIO(@12),B'10001000'                             0516 01686000
         BNO   @RF00516                                            0516 01687000
@RT00516 DS    0H                                                  0517 01688000
*       MASKFLG='0'B;               /* PREVENTS BIT MASK FROM BEING     01689000
*                                      SET                           */ 01690000
         NI    MASKFLG(PVTPTR),B'11011111'                         0517 01691000
*     ELSE                                                         0518 01692000
*       MASKFLG='1'B;               /* ASSUME BIT MASK SHOULD BE SET,   01693000
*                                      A FIX WILL CAUSE MASKFLG TO BE   01694000
*                                      SET TO ZERO                   */ 01695000
*                                                                  0518 01696000
         B     @RC00516                                            0518 01697000
@RF00516 OI    MASKFLG(PVTPTR),B'00100000'                         0518 01698000
*     /***************************************************************/ 01699000
*     /*                                                             */ 01700000
*     /* PROCESS THE QUEUED PCB, THEN PROCESS EACH RELATED. IS THE   */ 01701000
*     /* PCB A PAGE IN OR A PAGE OUT                                 */ 01702000
*     /*                                                             */ 01703000
*     /***************************************************************/ 01704000
*                                                                  0519 01705000
*     IF PCBIOI='0'B THEN                                          0519 01706000
@RC00516 TM    PCBIOI(PCBPTR),B'00000010'                          0519 01707000
         BNZ   @RF00519                                            0519 01708000
*       DO;                                                        0520 01709000
*         CALL PCBPROC;             /* PROCESS QUEUED PCB            */ 01710000
*                                                                  0521 01711000
         BAL   @14,PCBPROC                                         0521 01712000
*         /***********************************************************/ 01713000
*         /*                                                         */ 01714000
*         /* IF PCB WAS A ZERO TCB FIX AND A FIX ENTRY COULD NOT BE  */ 01715000
*         /* MADE IN THE SPCT, THE PCB SHOULD NOT BE MARKED FREAL.   */ 01716000
*         /* THUS THE ZERO TCB FIX PCB WILL BE ALLOWED TO COMPLETE   */ 01717000
*         /* NORMALLY EVEN THOUGH THE FRAME WILL NOT BE VALIDATED    */ 01718000
*         /* UNTIL THE ADDRESS SPACE IS SWAPPED BACK IN              */ 01719000
*         /*                                                         */ 01720000
*         /***********************************************************/ 01721000
*                                                                  0522 01722000
*         IF KEEPPCB='0'B THEN                                     0522 01723000
         TM    KEEPPCB(PVTPTR),B'00010000'                         0522 01724000
         BNZ   @RF00522                                            0522 01725000
*           DO;                                                    0523 01726000
*             PCBFREAL='1'B;        /* FREAL IS SET ON SO FRAME WILL    01727000
*                                      BE FREED WHEN I/0 DOES      0524 01728000
*                                      COMPLETE. IF I/O DID ALREADY     01729000
*                                      COMPLETE SUCCESSFULLY THE   0524 01730000
*                                      FRAME WAS VALIDATED           */ 01731000
         OI    PCBFREAL(PCBPTR),B'10000000'                        0524 01732000
*             IF PCBIOCMP='0'B THEN /* IF FRAME IN PRIVATE AREA HAS     01733000
*                                      INPUT I/O IN PROGRESS (PAGE 0525 01734000
*                                      FAULT, FIX, OR LOAD), IT WILL    01735000
*                                      NOT BE PAGED OUT BY IEAVSOUT     01736000
*                                      AND WILL STILL BE REFLECTED IN   01737000
*                                      ASCBFMCT AT THE TIME PVTSPFR     01738000
*                                      IS INCREMENTED IN THE IEAVSOUT   01739000
*                                      MAINLINE. THEREFORE, INCREMENT   01740000
*                                      PVTSPFR HERE TO INDICATE FRAME   01741000
*                                      WAS FREED AT SWAP OUT TIME  0525 01742000
*                                                            @VS07609*/ 01743000
         TM    PCBIOCMP(PCBPTR),B'00000001'                        0525 01744000
         BNZ   @RF00525                                            0525 01745000
*               PVTSPFR=PVTSPFR+1;  /* INCR FRAMES FREED COUNT     0526 01746000
*                                                            @VS07609*/ 01747000
         LA    @12,1                                               0526 01748000
         LH    @06,PVTSPFR(,PVTPTR)                                0526 01749000
         N     @06,@CF02704                                        0526 01750000
         ALR   @12,@06                                             0526 01751000
         STH   @12,PVTSPFR(,PVTPTR)                                0526 01752000
*           END;                                                   0527 01753000
*       END;                                                       0528 01754000
*     ELSE                                                         0529 01755000
*       IF PCBSUPRS='0'B THEN       /* IF RBN CAN BE USED MAKE SURE     01756000
*                                      FRAME IS FREED AFTER PAGE OUT    01757000
*                                      COMPLETES                     */ 01758000
         B     @RC00519                                            0529 01759000
@RF00519 TM    PCBSUPRS(PCBPTR),B'00001000'                        0529 01760000
         BNZ   @RF00529                                            0529 01761000
*         PCBFREAL='1'B;            /* SET TO FREE FRAME WHEN I/O  0530 01762000
*                                      COMPLETES                     */ 01763000
         OI    PCBFREAL(PCBPTR),B'10000000'                        0530 01764000
*     R4=R11;                       /* SET ADDRESS OF LAST PROCESSED    01765000
*                                      PCB                           */ 01766000
@RF00529 DS    0H                                                  0531 01767000
@RC00519 LR    R4,R11                                              0531 01768000
*     PCBPTR=R11->PCBRLPA;          /* GET ADDRESS OF FIRST RELATED  */ 01769000
         L     PCBPTR,PCBRLPA-1(,R11)                              0532 01770000
         LA    PCBPTR,0(,PCBPTR)                                   0532 01771000
*     DO WHILE(PCBPTR^=0);                                         0533 01772000
         B     @DE00533                                            0533 01773000
@DL00533 DS    0H                                                  0534 01774000
*       LASTRLT=R4;                 /* SAVE R4 OVER CALL             */ 01775000
         ST    R4,LASTRLT(,PVTPTR)                                 0534 01776000
*       CALL PCBPROC;               /* PROCESS RELATED PCB           */ 01777000
         BAL   @14,PCBPROC                                         0535 01778000
*       IF KEEPPCB='1'B THEN        /* DO WE KEEP PCB                */ 01779000
         TM    KEEPPCB(PVTPTR),B'00010000'                         0536 01780000
         BO    @RT00536                                            0536 01781000
*         GO TO SAVL1;              /* DO NOT FREE RELATED           */ 01782000
*       R4=LASTRLT;                 /* RESTORE R4                    */ 01783000
         L     R4,LASTRLT(,PVTPTR)                                 0538 01784000
*       R4->PCBRLPA=PCBPTR->PCBRLPA;/* REMOVE RELATED FROM CHAIN     */ 01785000
         MVC   PCBRLPA(3,R4),PCBRLPA(PCBPTR)                       0539 01786000
*       R0=PCBFREQN;                /* PCB TO FREE Q                 */ 01787000
         LA    R0,16                                               0540 01788000
*       R1=PCBPTR;                  /* ADDRESS OF PCB TO FREE        */ 01789000
         LR    R1,PCBPTR                                           0541 01790000
*       CALL IEAVPCB;               /* FREE IT                       */ 01791000
         L     @15,PVTPCB(,PVTPTR)                                 0542 01792000
         BALR  @14,@15                                             0542 01793000
*       GO TO SAVL2;                /* SET TO NEXT RELATED           */ 01794000
         B     SAVL2                                               0543 01795000
*SAVL1:                                                            0544 01796000
*       R4=PCBPTR;                  /* UPDATE LAST PROCESSED PTR     */ 01797000
SAVL1    LR    R4,PCBPTR                                           0544 01798000
*SAVL2:                                                            0545 01799000
*       PCBPTR=R4->PCBRLPA;         /* UPDATE PCB TO BE PROCESSED PTR*/ 01800000
SAVL2    L     PCBPTR,PCBRLPA-1(,R4)                               0545 01801000
         LA    PCBPTR,0(,PCBPTR)                                   0545 01802000
*     END;                                                         0546 01803000
@DE00533 LTR   PCBPTR,PCBPTR                                       0546 01804000
         BNZ   @DL00533                                            0546 01805000
*     PCBPTR=R11;                   /* SET PTR TO LOOK AT QUEUED PCB */ 01806000
         LR    PCBPTR,R11                                          0547 01807000
*     R11=PCBBQPA;                  /* UPDATE PTR TO NEXT PCB ON   0548 01808000
*                                      LOCAL Q                       */ 01809000
*                                                                  0548 01810000
         L     R11,PCBBQPA(,PCBPTR)                                0548 01811000
*     /***************************************************************/ 01812000
*     /*                                                             */ 01813000
*     /* IS A BIT MASK ENTRY TO BE MADE                              */ 01814000
*     /*                                                             */ 01815000
*     /***************************************************************/ 01816000
*                                                                  0549 01817000
*     IF MASKFLG='1'B&PCBVBN^=0 THEN                               0549 01818000
         TM    MASKFLG(PVTPTR),B'00100000'                         0549 01819000
         BNO   @RF00549                                            0549 01820000
         LH    @12,PCBVBN(,PCBPTR)                                 0549 01821000
         N     @12,@CF02704                                        0549 01822000
         LTR   @12,@12                                             0549 01823000
         BZ    @RF00549                                            0549 01824000
*       DO;                                                        0550 01825000
*         R1=PCBVBN;                /* VBN FOR SUBROUTINE            */ 01826000
         LR    R1,@12                                              0551 01827000
*         CALL SETMASK;             /* SET BIT MASK                  */ 01828000
         BAL   @14,SETMASK                                         0552 01829000
*         PGTPVM='1'B;              /* INVALIDATE PAGE       @Z40WPYC*/ 01830000
         L     @12,PCBPGTA-1(,PCBPTR)                              0553 01831000
         OI    PGTPVM(@12),B'00001000'                             0553 01832000
*       END;                                                       0554 01833000
*                                                                  0554 01834000
*     /***************************************************************/ 01835000
*     /*                                                             */ 01836000
*     /* IF I/O IS COMPLETE FREE THE QUEUED PCB. ALL RELATED PCBS    */ 01837000
*     /* WILL HAVE BEEN FREED IF I/O IS COMPLETE. I/O WILL NEVER BE  */ 01838000
*     /* COMPLETE FOR A PAGE OUT PCB.                                */ 01839000
*     /*                                                             */ 01840000
*     /***************************************************************/ 01841000
*                                                                  0555 01842000
*     IF PCBIOCMP='1'B THEN                                        0555 01843000
@RF00549 TM    PCBIOCMP(PCBPTR),B'00000001'                        0555 01844000
         BNO   @RF00555                                            0555 01845000
*       DO;                                                        0556 01846000
*                                                                  0556 01847000
*         /***********************************************************/ 01848000
*         /*                                                         */ 01849000
*         /* IF THE VBN IS ZERO THERE IS NO FRAME ASSOCIATED WITH    */ 01850000
*         /* THIS PCB                                                */ 01851000
*         /*                                                         */ 01852000
*         /***********************************************************/ 01853000
*                                                                  0557 01854000
*         IF PCBVBN^=0 THEN                                        0557 01855000
         LH    @12,PCBVBN(,PCBPTR)                                 0557 01856000
         N     @12,@CF02704                                        0557 01857000
         LTR   @12,@12                                             0557 01858000
         BZ    @RF00557                                            0557 01859000
*           DO;                                                    0558 01860000
*             R4=PVTPFTP+PCBRBN;    /* GET ADDRESS OF PFTE           */ 01861000
         LH    R4,PCBRBN(,PCBPTR)                                  0559 01862000
         N     R4,@CF02704                                         0559 01863000
         AL    R4,PVTPFTP(,PVTPTR)                                 0559 01864000
*             R4->PFTPCBSI='0'B;    /* PCB DEFINED OFF               */ 01865000
*                                                                  0560 01866000
         NI    PFTPCBSI(R4),B'11110111'                            0560 01867000
*             /*******************************************************/ 01868000
*             /*                                                     */ 01869000
*             /* IF THE FRAME IS NOT VALID, FREE IT                  */ 01870000
*             /*                                                     */ 01871000
*             /*******************************************************/ 01872000
*                                                                  0561 01873000
*             RFY                                                  0561 01874000
*              (R5) RSTD;                                          0561 01875000
*             R5=PCBVBN*256;        /* CHANGE VBN TO VSA             */ 01876000
         SLA   @12,8                                               0562 01877000
         LR    R5,@12                                              0562 01878000
*             GEN CODE(LRA R1,0(R5))                               0563 01879000
*             SETS(R1) REFS(R1,R5); /* IF FRAME VALID                */ 01880000
         LRA R1,0(R5)                                                   01881000
*             BC(8,FREQD);          /* BRANCH IF VALID               */ 01882000
         BC    8,FREQD                                             0564 01883000
*             RFY                                                  0565 01884000
*              (R5) UNRSTD;                                        0565 01885000
*             R0=PCBRBN;                                           0566 01886000
         LH    R0,PCBRBN(,PCBPTR)                                  0566 01887000
         N     R0,@CF02704                                         0566 01888000
*             IF MASKFLG='0'B THEN  /* IF NO BIT MASK ENTRY WAS MADE    01889000
*                                      THEN MOVE PFTE TO FRONT OF  0567 01890000
*                                      AFQ.                  @Z40WPYC*/ 01891000
         TM    MASKFLG(PVTPTR),B'00100000'                         0567 01892000
         BNZ   @RF00567                                            0567 01893000
*               R0=R0|CONSPFTE;     /* PFTE TO FRONT OF AFQ          */ 01894000
         O     R0,@CF02502                                         0568 01895000
*             ELSE                                                 0569 01896000
*               ;                   /* BIT MASK ENTRY WAS MADE, FRAME   01897000
*                                      TO END OF AFQ.THIS WILL PERMIT   01898000
*                                      A GREATER CHANCE THAT THE   0569 01899000
*                                      FRAME WILL BE RECLAIMED BY GFA   01900000
*                                      DURING SWAPIN.        @Z40WPYC*/ 01901000
@RF00567 DS    0H                                                  0570 01902000
*             CALL IEAVPFTE;        /* FREE FRAME                    */ 01903000
         L     @15,PVTPFTE(,PVTPTR)                                0570 01904000
         BALR  @14,@15                                             0570 01905000
*           END;                                                   0571 01906000
*FREQD:                                                            0572 01907000
*         R0=PCBFREQN;              /* PCB TO FREE Q                 */ 01908000
@RF00557 DS    0H                                                  0572 01909000
FREQD    LA    R0,16                                               0572 01910000
*         R1=PCBPTR;                /* PCB TO BE FREED               */ 01911000
         LR    R1,PCBPTR                                           0573 01912000
*         CALL IEAVPCB;             /* FREE PCB                      */ 01913000
         L     @15,PVTPCB(,PVTPTR)                                 0574 01914000
         BALR  @14,@15                                             0574 01915000
*       END;                                                       0575 01916000
*     ELSE                          /* I/O IS NOT COMPLETE. MUST ZERO   01917000
*                                      THE VBN IN THE PCB SO THAT THE   01918000
*                                      PCB WILL NOT BE PROCESSED BY     01919000
*                                      SOMEONE ELSE. IF OUTPUT PCB OR   01920000
*                                      A FIX PCB (QUEUED OR RELATED)    01921000
*                                      COULD NOT BE PUT IN THE SPCT,    01922000
*                                      DO NOT ZERO THE VBN SO THAT 0576 01923000
*                                      THESE PCBS CAN LATER BE     0576 01924000
*                                      PROCESSED CORRECTLY.  @YM07609*/ 01925000
*       IF PCBIOI='0'B&PCBRLPA=0&PCBFXC=0 THEN/* TEST TO ZERO VBN  0576 01926000
*                                                            @YM07609*/ 01927000
         B     @RC00555                                            0576 01928000
@RF00555 TM    PCBIOI(PCBPTR),B'00000010'                          0576 01929000
         BNZ   @RF00576                                            0576 01930000
         L     @12,PCBRLPA-1(,PCBPTR)                              0576 01931000
         LA    @12,0(,@12)                                         0576 01932000
         LTR   @12,@12                                             0576 01933000
         BNZ   @RF00576                                            0576 01934000
         CLI   PCBFXC(PCBPTR),0                                    0576 01935000
         BNE   @RF00576                                            0576 01936000
*         PCBVBN=0;                 /* ZERO THE VBN          @YM07609*/ 01937000
         SLR   @12,@12                                             0577 01938000
         STH   @12,PCBVBN(,PCBPTR)                                 0577 01939000
*   END;                            /* END OF Q'D PCB LOOP           */ 01940000
@RF00576 DS    0H                                                  0578 01941000
@RC00555 DS    0H                                                  0578 01942000
@DE00514 LTR   R11,R11                                             0578 01943000
         BNZ   @DL00514                                            0578 01944000
*                                                                  0579 01945000
*   /*****************************************************************/ 01946000
*   /*                                                               */ 01947000
*   /* PROCESS GFA DEFER Q                                           */ 01948000
*   /*                                                               */ 01949000
*   /*****************************************************************/ 01950000
*                                                                  0579 01951000
*   DOINGGFA='1'B;                  /* SET FLAG TO INDICATE GFA Q IS    01952000
*                                      BEING PROCESSED               */ 01953000
         OI    DOINGGFA(PVTPTR),B'10000000'                        0579 01954000
*   R11=PVTGFADL;                   /* GET ADDRESS OF LAST PCB ON GFA   01955000
*                                      DEFER Q                       */ 01956000
         L     R11,PVTGFADL(,PVTPTR)                               0580 01957000
*   DO WHILE(R11^=0);               /* DO FOR EACH PCB ON DEFER Q    */ 01958000
         B     @DE00581                                            0581 01959000
@DL00581 DS    0H                                                  0582 01960000
*     NOSPCTE='0'B;                 /* INITALIZE FLAG FOR THIS PCB 0582 01961000
*                                                            @YM02790*/ 01962000
         NI    NOSPCTE(PVTPTR),B'11111011'                         0582 01963000
*     PCBPTR=R11;                   /* INITIALIZE PCBPTR FOR SCAN  0583 01964000
*                                                            @YM02389*/ 01965000
*                                                                  0583 01966000
         LR    PCBPTR,R11                                          0583 01967000
*     /***************************************************************/ 01968000
*     /*                                                             */ 01969000
*     /* DETERMINE IF THERE IS AN ECB OUT OF STORAGE FOR ANY REQUEST */ 01970000
*     /* ON THIS VBN IN THE ADDRESS SPACE TO BE SWAPPED OUT. ALSO    */ 01971000
*     /* DETERMINE IF THERE IS A FIX AS A FIRST REFERENCE TO THIS    */ 01972000
*     /* PAGE                                                        */ 01973000
*     /*                                                             */ 01974000
*     /***************************************************************/ 01975000
*                                                                  0584 01976000
*     DO WHILE(PCBPTR^=0);          /* LOOK AT QUEUED AND RELATEDS 0584 01977000
*                                                            @YM02790*/ 01978000
         B     @DE00584                                            0584 01979000
@DL00584 DS    0H                                                  0585 01980000
*       IF PCBASCB=PSAAOLD&PCBROOT='1'B THEN/* PCB IS FOR THIS     0585 01981000
*                                      ADDRESS SPACE AND HAS A ROOT,    01982000
*                                      IS THE ECB IN STORAGE @YM02790*/ 01983000
         CLC   PCBASCB(4,PCBPTR),PSAAOLD                           0585 01984000
         BNE   @RF00585                                            0585 01985000
         TM    PCBROOT(PCBPTR),B'00000100'                         0585 01986000
         BNO   @RF00585                                            0585 01987000
*         DO;                       /*                       @YM02790*/ 01988000
*           IF XPTXAV='0'B THEN     /* IF THERE IS NO AUX AS YET   0587 01989000
*                                      ASSIGNED TO THE PAGE, THIS IS    01990000
*                                      THE FIRST REFERENCE TO IT   0587 01991000
*                                                            @YM02461*/ 01992000
         L     @12,PCBXPTA-1(,PCBPTR)                              0587 01993000
         TM    XPTXAV(@12),B'01000000'                             0587 01994000
         BZ    @RT00587                                            0587 01995000
*             GO TO NOTINFET;       /* GO REMOVE FIX ENTRY FROM SPCT    01996000
*                                                            @YM02461*/ 01997000
*           R1=PCBRECB;             /* GET ECB ADDRESS       @YM02790*/ 01998000
         L     @12,PCBRTPA-1(,PCBPTR)                              0589 01999000
         L     R1,PCBRECB(,@12)                                    0589 02000000
*           GEN CODE REFS(R1) SETS(R1) NOFLOWS NODEFS;             0590 02001000
         LRA R1,0(R1)                                                   02002000
*           BC(7,NOTINFET);         /* BRANCH IF ECB IS NOT IN     0591 02003000
*                                      STORAGE               @YM02790*/ 02004000
         BC    7,NOTINFET                                          0591 02005000
*         END;                                                     0592 02006000
*       PCBPTR=PCBRLPA;             /* SET TO NEXT PCB ON RELATED  0593 02007000
*                                      CHAIN                 @YM02790*/ 02008000
@RF00585 L     @12,PCBRLPA-1(,PCBPTR)                              0593 02009000
         LA    @12,0(,@12)                                         0593 02010000
         LR    PCBPTR,@12                                          0593 02011000
*     END;                                                         0594 02012000
@DE00584 LTR   PCBPTR,PCBPTR                                       0594 02013000
         BNZ   @DL00584                                            0594 02014000
*     GO TO NORMGFA;                /* NO OUT OF STORAGE ECBS      0595 02015000
*                                                            @YM02790*/ 02016000
*                                                                  0595 02017000
         B     NORMGFA                                             0595 02018000
*     /***************************************************************/ 02019000
*     /*                                                             */ 02020000
*     /* WE FOUND ONE ECB OUT OF STORAGE, OR THIS IS A FIRST         */ 02021000
*     /* REFERENCE CASE. NO ENTRY IS TO BE MADE IN THE SPCT FOR THIS */ 02022000
*     /* VBN. THE PCB IS TO BE LEFT ON THE GFA DEFER QUEUE BECAUSE   */ 02023000
*     /* THE ECB CAN NOT BE POSTED. IF THIS IS A FIRST REFERENCE CASE*/ 02024000
*     /* THE PAGE CAN NOT BE BROUGHT IN AT SWAP IN TIME.             */ 02025000
*     /*                                                             */ 02026000
*     /***************************************************************/ 02027000
*                                                                  0596 02028000
*NOTINFET:                                                         0596 02029000
*     NOSPCTE='1'B;                 /* SET FLAG FOR PCBPROC  @YM02790*/ 02030000
NOTINFET OI    NOSPCTE(PVTPTR),B'00000100'                         0596 02031000
*     PCBPTR=R11;                   /* SET POINTER                   */ 02032000
         LR    PCBPTR,R11                                          0597 02033000
*     DO WHILE(PCBPTR^=0);          /* DO FOR EVERY PCB ON RELATED 0598 02034000
*                                      CHAIN                         */ 02035000
         B     @DE00598                                            0598 02036000
@DL00598 DS    0H                                                  0599 02037000
*       IF PCBASCB=PSAAOLD&PCBROOT='1'B&PCBFXC^=0&PCBRTCBA^=0 THEN 0599 02038000
         CLC   PCBASCB(4,PCBPTR),PSAAOLD                           0599 02039000
         BNE   @RF00599                                            0599 02040000
         TM    PCBROOT(PCBPTR),B'00000100'                         0599 02041000
         BNO   @RF00599                                            0599 02042000
         CLI   PCBFXC(PCBPTR),0                                    0599 02043000
         BE    @RF00599                                            0599 02044000
         L     @12,PCBRTPA-1(,PCBPTR)                              0599 02045000
         L     @12,PCBRTCBA-1(,@12)                                0599 02046000
         LA    @12,0(,@12)                                         0599 02047000
         LTR   @12,@12                                             0599 02048000
         BZ    @RF00599                                            0599 02049000
*         CALL PCBPROC;             /* REMOVE FIX FROM SPCT          */ 02050000
         BAL   @14,PCBPROC                                         0600 02051000
*       PCBPTR=PCBRLPA;             /* UPDATE POINTER                */ 02052000
@RF00599 L     @12,PCBRLPA-1(,PCBPTR)                              0601 02053000
         LA    @12,0(,@12)                                         0601 02054000
         LR    PCBPTR,@12                                          0601 02055000
*     END;                                                         0602 02056000
@DE00598 LTR   PCBPTR,PCBPTR                                       0602 02057000
         BNZ   @DL00598                                            0602 02058000
*     R11=R11->PCBBQPA;             /* ADJUST TO NEXT QUEUED PCB     */ 02059000
         L     R11,PCBBQPA(,R11)                                   0603 02060000
*     GO TO DIDQDD;                 /* SKIP NORMAL GFA DEFER Q     0604 02061000
*                                      PROCESSING                    */ 02062000
         B     DIDQDD                                              0604 02063000
*                                                                  0605 02064000
*     /***************************************************************/ 02065000
*     /*                                                             */ 02066000
*     /* SCAN GFA DEFER QUEUE FOR PCBS FOR THIS ADDRESS SPACE. MAKE  */ 02067000
*     /* ENTRIES IN SPCT FOR PRIVATE AREA ZERO TCB FIXES. REMOVE PAGE*/ 02068000
*     /* FAULTS AFTER THEIR EXISTENCE HAS BEEN NOTED IN THE SPCT.    */ 02069000
*     /* REMOVE NON ZERO TCB FIXES                                   */ 02070000
*     /*                                                             */ 02071000
*     /***************************************************************/ 02072000
*                                                                  0605 02073000
*NORMGFA:                                                          0605 02074000
*     PCBPTR=R11;                   /* SET PTR                       */ 02075000
*                                                                  0605 02076000
NORMGFA  LR    PCBPTR,R11                                          0605 02077000
*     /***************************************************************/ 02078000
*     /*                                                             */ 02079000
*     /* IF PCB IS FOR A VIO PAGE IN, NO BIT MASK ENTRY IS TO BE MADE*/ 02080000
*     /* AS THIS VIO FRAME CANNOT BE BROUGHT IN AT SWAP IN TIME USING*/ 02081000
*     /* A MEMORY LPID. NO BIT MASK ENTRY IS TO BE MADE IF THE FRAME */ 02082000
*     /* IS FIXED AS A FIX TYPE ENTRY WILL ALREADY BE IN THE SPCT NO */ 02083000
*     /* BIT MASK ENTRIES ARE TO BE MADE EXCEPT FOR PRIVATE AREA     */ 02084000
*     /* PAGES                                                       */ 02085000
*     /*                                                             */ 02086000
*     /***************************************************************/ 02087000
*                                                                  0606 02088000
*     IF PCBVBN>=PVTLCSA THEN                                      0606 02089000
         CLC   PCBVBN(2,PCBPTR),PVTLCSA(PVTPTR)                    0606 02090000
         BL    @RF00606                                            0606 02091000
*       MASKFLG='0'B;               /* DO NOT MAKE BIT MASK ENTRY AS    02092000
*                                      THE PAGE IS FOR THE COMMON  0607 02093000
*                                      AREA                          */ 02094000
         NI    MASKFLG(PVTPTR),B'11011111'                         0607 02095000
*     ELSE                                                         0608 02096000
*       MASKFLG='1'B;               /* MAKE BIT MASK ENTRY UNLESS A     02097000
*                                      FIX IS IN PROGRESS OR THE PAGE   02098000
*                                      IS A VIO PAGE                 */ 02099000
         B     @RC00606                                            0608 02100000
@RF00606 OI    MASKFLG(PVTPTR),B'00100000'                         0608 02101000
*     R4=R11;                       /* R4 WILL CONTAIN THE ADDRESS OF   02102000
*                                      THE PREVIOUS PCB              */ 02103000
@RC00606 LR    R4,R11                                              0609 02104000
*     PCBPTR=R11->PCBRLPA;          /* SET TO FIRST ON RELATED CHAIN */ 02105000
*                                                                  0610 02106000
         L     PCBPTR,PCBRLPA-1(,R11)                              0610 02107000
         LA    PCBPTR,0(,PCBPTR)                                   0610 02108000
*     /***************************************************************/ 02109000
*     /*                                                             */ 02110000
*     /* DO FOR EACH RELATED ON THIS QUEUED PCB                      */ 02111000
*     /*                                                             */ 02112000
*     /***************************************************************/ 02113000
*                                                                  0611 02114000
*     DO WHILE(PCBPTR^=0);                                         0611 02115000
         B     @DE00611                                            0611 02116000
@DL00611 DS    0H                                                  0612 02117000
*       IF PCBASCB=PSAAOLD THEN                                    0612 02118000
         CLC   PCBASCB(4,PCBPTR),PSAAOLD                           0612 02119000
         BNE   @RF00612                                            0612 02120000
*         DO;                                                      0613 02121000
*           IF XPTVIOLP='1'B&XPTVIO='1'B|XPTXAV='0'B THEN          0614 02122000
         L     @12,PCBXPTA-1(,PCBPTR)                              0614 02123000
         LA    @12,0(,@12)                                         0614 02124000
         TM    XPTVIOLP(@12),B'10001000'                           0614 02125000
         BO    @RT00614                                            0614 02126000
         TM    XPTXAV(@12),B'01000000'                             0614 02127000
         BNZ   @RF00614                                            0614 02128000
@RT00614 DS    0H                                                  0615 02129000
*             MASKFLG='0'B;         /* IF PAGE IS VIO OR FIRST     0615 02130000
*                                      REFERENCE DO NOT MAKE BIT MASK   02131000
*                                      ENTRY                 @YM02461*/ 02132000
         NI    MASKFLG(PVTPTR),B'11011111'                         0615 02133000
*/*                                                          @Z40WPYC*/ 02134000
*                                                                  0616 02135000
*           LASTRLT=R4;             /* SAVE PTR                      */ 02136000
@RF00614 ST    R4,LASTRLT(,PVTPTR)                                 0616 02137000
*           CALL PCBPROC;           /* PROCESS RELATED PCB           */ 02138000
         BAL   @14,PCBPROC                                         0617 02139000
*           IF KEEPPCB='1'B THEN                                   0618 02140000
         TM    KEEPPCB(PVTPTR),B'00010000'                         0618 02141000
         BO    @RT00618                                            0618 02142000
*             GO TO SAVPCB;                                        0619 02143000
*           R4=LASTRLT;             /* RESTORE POINTER               */ 02144000
         L     R4,LASTRLT(,PVTPTR)                                 0620 02145000
*           R4->PCBRLPA=PCBPTR->PCBRLPA;/* REMOVE RELATED FROM     0621 02146000
*                                      RELATED CHAIN                 */ 02147000
         MVC   PCBRLPA(3,R4),PCBRLPA(PCBPTR)                       0621 02148000
*           R0=PCBFREQN;            /* PCB TO FREE Q                 */ 02149000
         LA    R0,16                                               0622 02150000
*           R1=PCBPTR;              /* PCB TO BE FREED               */ 02151000
         LR    R1,PCBPTR                                           0623 02152000
*           CALL IEAVPCB;           /* FREE IT                       */ 02153000
         L     @15,PVTPCB(,PVTPTR)                                 0624 02154000
         BALR  @14,@15                                             0624 02155000
*           GO TO SAVPCB2;                                         0625 02156000
         B     SAVPCB2                                             0625 02157000
*         END;                                                     0626 02158000
*SAVPCB:                                                           0627 02159000
*       R4=PCBPTR;                  /* UPDATE PREVIOUS PCB PTR       */ 02160000
@RF00612 DS    0H                                                  0627 02161000
SAVPCB   LR    R4,PCBPTR                                           0627 02162000
*SAVPCB2:                                                          0628 02163000
*       PCBPTR=R4->PCBRLPA;         /* SET TO NEXT PCB ON RELATED  0628 02164000
*                                      CHAIN                         */ 02165000
SAVPCB2  L     PCBPTR,PCBRLPA-1(,R4)                               0628 02166000
         LA    PCBPTR,0(,PCBPTR)                                   0628 02167000
*     END;                          /* END OF RELATED LOOP           */ 02168000
@DE00611 LTR   PCBPTR,PCBPTR                                       0629 02169000
         BNZ   @DL00611                                            0629 02170000
*                                                                  0630 02171000
*     /***************************************************************/ 02172000
*     /*                                                             */ 02173000
*     /* NOW PROCESS THE QUEUED GFA DEFER QUEUE PCB                  */ 02174000
*     /*                                                             */ 02175000
*     /***************************************************************/ 02176000
*                                                                  0630 02177000
*     PCBPTR=R11;                   /* NOW WORK ON QUEUED            */ 02178000
         LR    PCBPTR,R11                                          0630 02179000
*     R11=PCBBQPA;                  /* ADJUST TO NEXT Q'D PCB        */ 02180000
         L     R11,PCBBQPA(,PCBPTR)                                0631 02181000
*     IF PCBASCB=PSAAOLD THEN                                      0632 02182000
         CLC   PCBASCB(4,PCBPTR),PSAAOLD                           0632 02183000
         BNE   @RF00632                                            0632 02184000
*       DO;                                                        0633 02185000
*         IF XPTVIOLP='1'B&XPTVIO='1'B|XPTXAV='0'B THEN            0634 02186000
         L     @12,PCBXPTA-1(,PCBPTR)                              0634 02187000
         LA    @12,0(,@12)                                         0634 02188000
         TM    XPTVIOLP(@12),B'10001000'                           0634 02189000
         BO    @RT00634                                            0634 02190000
         TM    XPTXAV(@12),B'01000000'                             0634 02191000
         BNZ   @RF00634                                            0634 02192000
@RT00634 DS    0H                                                  0635 02193000
*           MASKFLG='0'B;           /* IF PAGE IS VIO OR FIRST     0635 02194000
*                                      REFERENCE DO NOT MAKE BIT MASK   02195000
*                                      ENTRY                 @YM02461*/ 02196000
         NI    MASKFLG(PVTPTR),B'11011111'                         0635 02197000
*/*                                                          @Z40WPYC*/ 02198000
*                                                                  0636 02199000
*         CALL PCBPROC;             /* PROCESS Q'D PCB               */ 02200000
@RF00634 BAL   @14,PCBPROC                                         0636 02201000
*         IF KEEPPCB='1'B THEN                                     0637 02202000
         TM    KEEPPCB(PVTPTR),B'00010000'                         0637 02203000
         BO    @RT00637                                            0637 02204000
*           GO TO DIDQDD;                                          0638 02205000
*         ELSE                                                     0639 02206000
*           DO;                                                    0639 02207000
*                                                                  0639 02208000
*             /*******************************************************/ 02209000
*             /*                                                     */ 02210000
*             /* ARE THERE ANY RELATEDS LEFT ON Q'D                  */ 02211000
*             /*                                                     */ 02212000
*             /*******************************************************/ 02213000
*                                                                  0640 02214000
*             IF PCBRLPA^=0 THEN                                   0640 02215000
         L     @12,PCBRLPA-1(,PCBPTR)                              0640 02216000
         LA    @12,0(,@12)                                         0640 02217000
         LTR   @12,@12                                             0640 02218000
         BZ    @RF00640                                            0640 02219000
*               DO;                                                0641 02220000
*                 PCBVBN=0;         /* ZERO VBN TO HAVE UNIQUE VBN'S    02221000
*                                      ON Q                          */ 02222000
         SLR   @06,@06                                             0642 02223000
         STH   @06,PCBVBN(,PCBPTR)                                 0642 02224000
*                 R0=PCBDEFRN;      /* RELATED CHAIN TO GFA Q        */ 02225000
         LA    R0,24                                               0643 02226000
*                 R1=PCBRLPA;       /* ADDR OF FIRST RELATED         */ 02227000
         LR    R1,@12                                              0644 02228000
*                 PCBRLPA=0;        /* CLEAR OLD RLTD ADDR           */ 02229000
         STCM  @06,7,PCBRLPA(PCBPTR)                               0645 02230000
*                 CALL IEAVPCB;     /* ENQ RELATED CHAIN             */ 02231000
         L     @15,PVTPCB(,PVTPTR)                                 0646 02232000
         BALR  @14,@15                                             0646 02233000
*               END;                                               0647 02234000
*             ELSE                                                 0648 02235000
*               DO;                                                0648 02236000
         B     @RC00640                                            0648 02237000
@RF00640 DS    0H                                                  0649 02238000
*                 XPTDEFER='0'B;    /* LAST PCB ON THE DEFER Q FOR 0649 02239000
*                                      THIS VBN IS BEING FREED, SO 0649 02240000
*                                      DEFER FLAG IS ZEROED          */ 02241000
*                                                                  0649 02242000
         L     @12,PCBXPTA-1(,PCBPTR)                              0649 02243000
         NI    XPTDEFER(@12),B'11111101'                           0649 02244000
*                 /***************************************************/ 02245000
*                 /*                                                 */ 02246000
*                 /* IS A BIT MASK ENTRY TO BE MADE                  */ 02247000
*                 /*                                                 */ 02248000
*                 /***************************************************/ 02249000
*                                                                  0650 02250000
*                 IF MASKFLG='1'B THEN                             0650 02251000
         TM    MASKFLG(PVTPTR),B'00100000'                         0650 02252000
         BNO   @RF00650                                            0650 02253000
*                   DO;                                            0651 02254000
*                     R1=PCBVBN;    /* VBN FOR SUBROUTINE            */ 02255000
         LH    R1,PCBVBN(,PCBPTR)                                  0652 02256000
         N     R1,@CF02704                                         0652 02257000
*                     CALL SETMASK; /* MAKE BIT MASK ENTRY FOR THIS     02258000
*                                      PRIVATE AREA VBN              */ 02259000
         BAL   @14,SETMASK                                         0653 02260000
*                     PGTPVM='1'B;  /* INVALIDATE THE PAGE   @Z40WPYC*/ 02261000
         L     @12,PCBPGTA-1(,PCBPTR)                              0654 02262000
         OI    PGTPVM(@12),B'00001000'                             0654 02263000
*                   END;                                           0655 02264000
*                 ELSE                                             0656 02265000
*                   ;                                              0656 02266000
@RF00650 DS    0H                                                  0657 02267000
*               END;                                               0657 02268000
*                                                                  0657 02269000
*             /*******************************************************/ 02270000
*             /*                                                     */ 02271000
*             /* FREE THE QUEUED PCB                                 */ 02272000
*             /*                                                     */ 02273000
*             /*******************************************************/ 02274000
*                                                                  0658 02275000
*             R0=PCBFREQN;                                         0658 02276000
@RC00640 LA    R0,16                                               0658 02277000
*             R1=PCBPTR;                                           0659 02278000
         LR    R1,PCBPTR                                           0659 02279000
*             CALL IEAVPCB;                                        0660 02280000
         L     @15,PVTPCB(,PVTPTR)                                 0660 02281000
         BALR  @14,@15                                             0660 02282000
*           END;                    /* END OF ZERO TCB TEST          */ 02283000
*       END;                        /* END OF ASCB TEST              */ 02284000
*DIDQDD:                                                           0663 02285000
*   END;                            /* END OF Q'D PCB LOOP           */ 02286000
@RF00632 DS    0H                                                  0663 02287000
DIDQDD   DS    0H                                                  0663 02288000
@DE00581 LTR   R11,R11                                             0663 02289000
         BNZ   @DL00581                                            0663 02290000
*   RFY                                                            0664 02291000
*    (R14) RSTD;                                                   0664 02292000
*   R14=LEV1RTN;                    /* GET RETURN ADDRESS            */ 02293000
         L     R14,LEV1RTN(,PVTPTR)                                0665 02294000
*   RFY                                                            0666 02295000
*    (R1,                                                          0666 02296000
*     R4,                                                          0666 02297000
*     R14) UNRSTD;                                                 0666 02298000
*   RFY                                                            0667 02299000
*     PGTPTE BASED(PTEPTR);                                        0667 02300000
*   RFY                                                            0668 02301000
*     XPTE BASED(XPTEPTR);                                         0668 02302000
*   RFY                                                            0669 02303000
*     PCBR BASED(PCBRPTR);                                         0669 02304000
*PRCEND1:                                                          0670 02305000
*   END PIOPURGE;                                                  0670 02306000
@EL00004 DS    0H                                                  0670 02307000
@EF00004 DS    0H                                                  0670 02308000
@ER00004 BR    @14                                                 0670 02309000
*STAGE1:                                                           0671 02310000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0671 02311000
*                                                                  0671 02312000
STAGE1   DS    0H                                                  0672 02313000
*   /*****************************************************************/ 02314000
*   /*                                                               */ 02315000
*   /* THIS SECTION BUILDS SWAP OUT PCBS FOR THE STAGE 1 PAGES.      */ 02316000
*   /*                                                               */ 02317000
*   /*****************************************************************/ 02318000
*                                                                  0672 02319000
*   RESPECIFY                                                      0672 02320000
*    (PCBPTR,                                                      0672 02321000
*     PCBRPTR,                                                     0672 02322000
*     R14) RESTRICTED;                                             0672 02323000
*   LEV1RTN=R14;                    /* SAVE THE RETURN ADDRESS.      */ 02324000
         ST    R14,LEV1RTN(,PVTPTR)                                0673 02325000
*   RESPECIFY                                                      0674 02326000
*    (R14) UNRESTRICTED;                                           0674 02327000
*   RESPECIFY                                                      0675 02328000
*    (PFTEPTR,                                                     0675 02329000
*     SWAPPTR,                                                     0675 02330000
*     ENDPTR) RESTRICTED;           /*                       @Z40WPYC*/ 02331000
*   PFTEPTR=PVTPFTP+RSMLSQAF;       /* SET UP POINTERS TO THE FIRST     02332000
*                                      LSQA FRAME. EVERY ADDRESS   0676 02333000
*                                      SPACE MUST HAVE AT LEAST ONE     02334000
*                                      LSQA FRAME.                   */ 02335000
         LH    PFTEPTR,RSMLSQAF(,RSMHDPTR)                         0676 02336000
         N     PFTEPTR,@CF02704                                    0676 02337000
         AL    PFTEPTR,PVTPFTP(,PVTPTR)                            0676 02338000
*   SWAPPTR=ADDR(SPCTSWAP);         /* GET ADDRESS OF SWAP ENTRIES 0677 02339000
*                                                            @Z40WPYC*/ 02340000
         LA    SWAPPTR,SPCTSWAP(,SPCTPTR)                          0677 02341000
*   LSQAEXT=SWAPPTR;                /* SAVE PTR TO FIRST LSQA      0678 02342000
*                                      EXTENSION.            @Z40WPYC*/ 02343000
         ST    SWAPPTR,LSQAEXT(,PVTPTR)                            0678 02344000
*   ENDPTR=SWAPPTR+LENGTH(SPCTEXTM);/* CALC END ADDR OF EXT  @Z40WPYC*/ 02345000
         LA    ENDPTR,56                                           0679 02346000
         ALR   ENDPTR,SWAPPTR                                      0679 02347000
*   SWAPPTR=SWAPPTR+(LENGTH(SPCTEXTM)-LENGTH(SPCTENT));/* GET PTR TO    02348000
*                                      FIRST LSQA SPCTE      @Z40WPYC*/ 02349000
         AL    SWAPPTR,@CF00057                                    0680 02350000
*NEXTPFT:                                                          0681 02351000
*   R0=0;                           /* SET FLAG: FINDPAGE MUST BE  0681 02352000
*                                      DONE                          */ 02353000
NEXTPFT  SLR   R0,R0                                               0681 02354000
*   CALL INITPCB;                   /* CALL SUBROUTINE TO INITIALIZE    02355000
*                                      THE NEXT AVAILABLE SWAP OUT 0682 02356000
*                                      PCB FOR THIS PAGE. RETURN CODE   02357000
*                                      IS NOT CHECKED HERE AS THE  0682 02358000
*                                      NUMBER OF PCBS WAS CHECKED  0682 02359000
*                                      BEFORE CALLING PIOPURGE       */ 02360000
         BAL   @14,INITPCB                                         0682 02361000
*   AIALSQA='1'B;                   /* INDICATE AN LSQA SWAP PAGE  0683 02362000
*                                                            @Z40WPYC*/ 02363000
         OI    AIALSQA(PCBPTR),B'00001000'                         0683 02364000
*   PCBSPCTE=SWAPPTR;               /* INIT PTR TO LSQA SPCTE FOR ASM   02365000
*                                                            @Z40WPYC*/ 02366000
         ST    SWAPPTR,PCBSPCTE(,PCBPTR)                           0684 02367000
*   IF PFTFQPTR^=0 THEN             /* TEST FOR MORE LSQA FRAMES.    */ 02368000
         LH    @01,PFTFQPTR(,PFTEPTR)                              0685 02369000
         N     @01,@CF02704                                        0685 02370000
         LTR   @01,@01                                             0685 02371000
         BZ    @RF00685                                            0685 02372000
*     DO;                           /* GET THE NEXT PFTE TO PROCESS. */ 02373000
*       PFTEPTR=PVTPFTP+PFTFQPTR;   /* GET THE ADDRESS OF THE NEXT 0687 02374000
*                                      PFTE ON THE LSQA QUEUE.       */ 02375000
         AL    @01,PVTPFTP(,PVTPTR)                                0687 02376000
         LR    PFTEPTR,@01                                         0687 02377000
*       SWAPPTR=SWAPPTR+LENGTH(SPCTLS);/* CALC PTR TO NEXT SPCTE   0688 02378000
*                                                            @Z40WPYC*/ 02379000
         AL    SWAPPTR,@CF00970                                    0688 02380000
*       IF SWAPPTR=ENDPTR THEN      /* TEST IF THE EXTENSION IS FULL    02381000
*                                                            @Z40WPYC*/ 02382000
         CR    SWAPPTR,ENDPTR                                      0689 02383000
         BNE   @RF00689                                            0689 02384000
*         DO;                       /* THE EXTENSION IS FULL OF LSQA    02385000
*                                      ENTRIES. OBTAIN AN ADDITIONAL    02386000
*                                      EXTENSION             @Z40WPYC*/ 02387000
*           SWAPPTR=LSQAEXT->SPCTEXT;/* GET ADDR OF NEXT EXTENSION 0691 02388000
*                                                            @Z40WPYC*/ 02389000
         L     @01,LSQAEXT(,PVTPTR)                                0691 02390000
         L     SWAPPTR,SPCTEXT(,@01)                               0691 02391000
*           LSQAEXT=SWAPPTR;        /* SAVE PTR TO START OF EXT    0692 02392000
*                                                            @Z40WPYC*/ 02393000
         ST    SWAPPTR,LSQAEXT(,PVTPTR)                            0692 02394000
*           ENDPTR=SWAPPTR+LENGTH(SPCTEXTM);/* GET END ADDR OF EXT 0693 02395000
*                                                            @Z40WPYC*/ 02396000
         LA    ENDPTR,56                                           0693 02397000
         ALR   ENDPTR,SWAPPTR                                      0693 02398000
*           SWAPPTR=SWAPPTR+(LENGTH(SPCTEXTM)-LENGTH(SPCTENT));/* GET   02399000
*                                      ADDR OF FIRST ENTRY IN THE  0694 02400000
*                                      EXTENSION             @Z40WPYC*/ 02401000
         AL    SWAPPTR,@CF00057                                    0694 02402000
*         END;                      /* END NEW EXTENSION PROCESSING     02403000
*                                                            @Z40WPYC*/ 02404000
*       ELSE                                                       0696 02405000
*         ;                         /* NOT END OF EXTENSION  @Z40WPYC*/ 02406000
@RF00689 DS    0H                                                  0697 02407000
*       GOTO NEXTPFT;               /* ARE MORE LSQA FRAMES. PREPARE    02408000
*                                      THEM FOR SWAP OUT.            */ 02409000
         B     NEXTPFT                                             0697 02410000
*     END;                                                         0698 02411000
*                                                                  0699 02412000
*/********************************************************************/ 02413000
*/*                                                                  */ 02414000
*/*   IF HERE, ALL LSQA PAGES HAVE BEEN PROCESSED. FIX ENTRIES ARE   */ 02415000
*/* NEXT TO BE SWAPPED OUT.                                          */ 02416000
*/*                                                                  */ 02417000
*/********************************************************************/ 02418000
*                                                                  0699 02419000
*   IF PTRLAST=0 THEN               /* TEST IF NO FIX ENTRIES EXIST. */ 02420000
@RF00685 SLR   @01,@01                                             0699 02421000
         C     @01,PTRLAST(,PVTPTR)                                0699 02422000
         BE    @RT00699                                            0699 02423000
*     GOTO EXITSTG1;                /* ARE NO FIX ENTRIES IN THE   0700 02424000
*                                      SPCT. CAN EXIT AT THIS TIME.  */ 02425000
*                                                                  0700 02426000
*   /*****************************************************************/ 02427000
*   /*                                                               */ 02428000
*   /* IF HERE, THERE ARE FIX ENTRIES IN THE SPCT. A PCB MUST BE     */ 02429000
*   /* BUILT FOR EACH IN-CORE FIX AND PFTE FIX COUNT PROCESSING MUST */ 02430000
*   /* BE DONE.                                                      */ 02431000
*   /*                                                               */ 02432000
*   /*****************************************************************/ 02433000
*                                                                  0701 02434000
*   NLSQAPCB=NEXTPCB;               /* SAVE PTR TO FIRST FIX PCB   0701 02435000
*                                                            @Z40WPYC*/ 02436000
         L     @15,SPCTSWRT(,SPCTPTR)                              0701 02437000
         MVC   NLSQAPCB(3,@15),NEXTPCB+1(PVTPTR)                   0701 02438000
*   AIANXAIA=0;                     /* SEPARATE THE LSQA FROM THE FIX   02439000
*                                      AIAS                  @Z40WPYC*/ 02440000
         ST    @01,AIANXAIA(,PCBPTR)                               0702 02441000
*   RESPECIFY                                                      0703 02442000
*    (LRAREG) RESTRICTED;                                          0703 02443000
*   SWAPPTR=PTRFIRST;               /* GET THE ADDRESS OF THE FIRST     02444000
*                                      SPCT FIX ENTRY.               */ 02445000
         L     SWAPPTR,PTRFIRST(,PVTPTR)                           0704 02446000
*   ENDPTR=FIXBEG+LENGTH(SPCTEXTM); /* GET THE ADDRESS OF THE END OF    02447000
*                                      THE FIRST EXTENSION WITH FIX     02448000
*                                      ENTRIES.                      */ 02449000
         LA    ENDPTR,56                                           0705 02450000
         AL    ENDPTR,FIXBEG(,PVTPTR)                              0705 02451000
*DOENTRY:                                                          0706 02452000
*   LRAREG=(SPCTVBN*256);           /* MAKE THE VSA.         @Z40WPYC*/ 02453000
*                                                                  0706 02454000
DOENTRY  LH    LRAREG,SPCTVBN(,SWAPPTR)                            0706 02455000
         N     LRAREG,@CF02704                                     0706 02456000
         SLA   LRAREG,8                                            0706 02457000
*   /*****************************************************************/ 02458000
*   /*                                                               */ 02459000
*   /* TEST IF FIXED PAGE IS IN CORE.                                */ 02460000
*   /*                                                               */ 02461000
*   /*****************************************************************/ 02462000
*                                                                  0707 02463000
*   GENERATE CODE FLOWS(STG1ERR,NEXTSPCT);                         0707 02464000
         LRA   LRAREG,0(0,LRAREG)    LOAD THE REAL ADDRESS              02465000
         BC    2,NEXTSPCT           IF NOT IN CORE, GET NEXT ENTRY      02466000
         BC    5,STG1ERR            IF SEGMENT INVALID, PROCESS ERROR   02467000
         SRL   LRAREG,8             MAKE RBN FROM RSA                   02468000
*   PFTEPTR=PVTPFTP+LRAREG;         /* GET THE ADDRESS OF THE PFTE 0708 02469000
*                                      FOR THE FIXED IN-CORE PAGE    */ 02470000
         LR    PFTEPTR,LRAREG                                      0708 02471000
         AL    PFTEPTR,PVTPFTP(,PVTPTR)                            0708 02472000
*   RESPECIFY                                                      0709 02473000
*    (LRAREG) UNRESTRICTED;                                        0709 02474000
*   IF PFTDFRLS='1'B THEN           /* TEST FOR A DEFERRED RELEASE 0710 02475000
*                                      PAGE (FREEMAINED BUT STILL  0710 02476000
*                                      FIXED.)                       */ 02477000
         TM    PFTDFRLS(PFTEPTR),B'10000000'                       0710 02478000
         BNO   @RF00710                                            0710 02479000
*     DO;                           /* IS DEFERRED RELEASE.          */ 02480000
*       SPCTDEFR='1'B;              /* FLAG SPCT FIX ENTRY AS      0712 02481000
*                                      DEFERRED RELEASED.            */ 02482000
         OI    SPCTDEFR(SWAPPTR),B'00010000'                       0712 02483000
*       IF PFTVBN^<PVTLCSA THEN     /* TEST IF PAGE IS IN THE COMMON    02484000
*                                      AREA.                         */ 02485000
         CLC   PFTVBN(2,PFTEPTR),PVTLCSA(PVTPTR)                   0713 02486000
         BNL   @RT00713                                            0713 02487000
*         GOTO NEXTSPCT;            /* IS A COMMON AREA DEFERRED   0714 02488000
*                                      RELEASE PAGE. THE PFTE FIX  0714 02489000
*                                      COUNT IS NOT DECREMENTED SO 0714 02490000
*                                      THAT THE FRAME DOES NOT GO  0714 02491000
*                                      AWAY.                         */ 02492000
*     END;                                                         0715 02493000
*                                                                  0716 02494000
*   /*****************************************************************/ 02495000
*   /*                                                               */ 02496000
*   /* THE FOLLOWING CODE PROCESSES ONLY IN STORAGES FIXES BECAUSE OF*/ 02497000
*   /* THE PRECEEDING LRA - A FIXED FRAME WITH PFTPCBSI ON CAN ONLY  */ 02498000
*   /* BE FOR IN BOUND I/O - ASM SHOULD BE ABLE TO HANDLE READ ERRORS*/ 02499000
*   /* TO BAD PAGES, THIS CODE DOES NOT ATTEMPT TO CANCEL ANY I/O    */ 02500000
*   /* THAT IS IN PROGRESS TO BAD PAGES PRIOR TO SWAP OUT.   @ZA19960*/ 02501000
*   /*                                                               */ 02502000
*   /*****************************************************************/ 02503000
*                                                                  0716 02504000
*   IF PFTBADPG='1'B THEN           /* STORAGE ERROR IN THIS PAGE? 0716 02505000
*                                                            @ZA19960*/ 02506000
@RF00710 TM    PFTBADPG(PFTEPTR),B'00000100'                       0716 02507000
         BNO   @RF00716                                            0716 02508000
*     DO;                           /* YES, REMOVE THIS FIX ENTRY  0717 02509000
*                                      FROM THE SPCT. THE FIXED FRAME   02510000
*                                      IS LEFT ON THE LOCAL FRAME  0717 02511000
*                                      QUEUE WHILE THE ADDRESS SPACE    02512000
*                                      IS SWAPPED OUT        @ZA19960*/ 02513000
*                                                                  0717 02514000
*       /*************************************************************/ 02515000
*       /*                                                           */ 02516000
*       /* FIXED FRAMES BACKED OUT OF THE SPCT AT THIS TIME ARE      */ 02517000
*       /* PROCESSED AGAIN IN ROUTINE WORKSET - THUS THE FRAME PINNED*/ 02518000
*       /* COUNT(FRPINCNT) IS NOT INCREMENTED NOR THE LOGGING ABEND  */ 02519000
*       /* ISSUED AT THIS TIME.                              @ZA19960*/ 02520000
*       /*                                                           */ 02521000
*       /*************************************************************/ 02522000
*                                                                  0718 02523000
*       IF SWAPPTR^=PTRLAST THEN    /* PROCESSING THE LAST ENTRY?  0718 02524000
*                                                            @ZA19960*/ 02525000
         L     @01,PTRLAST(,PVTPTR)                                0718 02526000
         CR    SWAPPTR,@01                                         0718 02527000
         BE    @RF00718                                            0718 02528000
*         SPCTSWPE=PTRLAST->SPCTSWPE;/* NO - MOVE LAST ENTRY TO THIS    02529000
*                                      ENTRY                 @ZA19960*/ 02530000
         MVC   SPCTSWPE(8,SWAPPTR),SPCTSWPE(@01)                   0719 02531000
*       PTRLAST->SPCTSWPE=''B;      /* ZERO THE LAST ENTRY   @ZA19960*/ 02532000
@RF00718 L     @01,PTRLAST(,PVTPTR)                                0720 02533000
         XC    SPCTSWPE(8,@01),SPCTSWPE(@01)                       0720 02534000
*       SPCTFIX=SPCTFIX-1;          /* DECREMENT THE NUMBER OF FIX 0721 02535000
*                                      ENTRIES IN THE SPCT   @ZA19960*/ 02536000
         LH    @01,SPCTFIX(,SPCTPTR)                               0721 02537000
         BCTR  @01,0                                               0721 02538000
         STH   @01,SPCTFIX(,SPCTPTR)                               0721 02539000
*       IF SPCTFIX=0 THEN           /* ANY SPCT FIX ENTRIES REMAIN?     02540000
*                                                            @ZA19960*/ 02541000
         SLR   @15,@15                                             0722 02542000
         CR    @01,@15                                             0722 02543000
         BNE   @RF00722                                            0722 02544000
*         DO;                       /* NO SO INDICATE SUCH AND     0723 02545000
*                                      TERMINATE THE LOOP    @ZA19960*/ 02546000
*           PTRLAST=0;              /* ADDRESS OF LAST FIX ENTRY - 0    02547000
*                                      MEANS NO ENTRIES      @ZA19960*/ 02548000
         ST    @15,PTRLAST(,PVTPTR)                                0724 02549000
*           GOTO EXITSTG1;          /* DONE WITH STAGE ONE ENTRIES 0725 02550000
*                                                            @ZA19960*/ 02551000
         B     EXITSTG1                                            0725 02552000
*         END;                      /* END OF NO FIX ENTRIES REMAIN     02553000
*                                                            @ZA19960*/ 02554000
*       ELSE                        /*                       @ZA19960*/ 02555000
*         DO;                       /* YES, SO SET NEW LAST ENTRY  0727 02556000
*                                      ADDRESS AND REPROCESS THIS  0727 02557000
*                                      ENTRY SINCE IT NOW CONTAINS 0727 02558000
*                                      NEW DATA.             @ZA19960*/ 02559000
@RF00722 DS    0H                                                  0728 02560000
*           R0=PTRLAST;             /* SAVE PREVIOUS LAST ADDRESS  0728 02561000
*                                                            @ZA19960*/ 02562000
         L     @15,PTRLAST(,PVTPTR)                                0728 02563000
         LR    R0,@15                                              0728 02564000
*           PTRLAST=PTRLAST-LENGTH(SPCTSWPE);/* ADDRESS OF PREVIOUS     02565000
*                                      SPCT FIX ENTRY        @ZA19960*/ 02566000
         SL    @15,@CF00057                                        0729 02567000
         ST    @15,PTRLAST(,PVTPTR)                                0729 02568000
*           RESPECIFY                                              0730 02569000
*             R4 RESTRICTED;        /*                       @ZA19960*/ 02570000
*           R4=FIXBEG;              /* GET ADDRESS OF FIRST EXTENSION   02571000
*                                      CONTAINING FIX ENTRIES      0731 02572000
*                                                            @ZA19960*/ 02573000
         L     R4,FIXBEG(,PVTPTR)                                  0731 02574000
*           DO WHILE(R4^=0);        /* LOOP THROUGH ALL EXTENSIONS 0732 02575000
*                                                            @ZA19960*/ 02576000
         B     @DE00732                                            0732 02577000
@DL00732 DS    0H                                                  0733 02578000
*             IF R4->SPCTEXT=PTRLAST THEN/* POINT TO FRONT OF AN   0733 02579000
*                                      EXTENSION?            @ZA19960*/ 02580000
         CLC   SPCTEXT(4,R4),PTRLAST(PVTPTR)                       0733 02581000
         BNE   @RF00733                                            0733 02582000
*               DO;                 /* YES, SO BACK UP TO LAST ENTRY    02583000
*                                      IN PREVIOUS EXTENSION @ZA19960*/ 02584000
*                 PTRLAST=R4+LENGTH(SPCTEXTM)-LENGTH(SPCTSWPE);/*  0735 02585000
*                                      ADJUST LAST POINTER TO LAST 0735 02586000
*                                      FIX ENTRY IN THE PREVIOUS   0735 02587000
*                                      EXTENSION             @ZA19960*/ 02588000
         LR    @05,R4                                              0735 02589000
         SL    @05,@CF02696                                        0735 02590000
         ST    @05,PTRLAST(,PVTPTR)                                0735 02591000
*                 GOTO DLENTRY;     /* GO CHECK IF LAST ENTRY WAS  0736 02592000
*                                      DELETED               @ZA19960*/ 02593000
         B     DLENTRY                                             0736 02594000
*               END;                /* FOUND PTRLAST POINTING TO   0737 02595000
*                                      FRONT OF AN EXTENSION @ZA19960*/ 02596000
*             ELSE                  /*                       @ZA19960*/ 02597000
*               R4=R4->SPCTEXT;     /* ONWARD TO NEXT EXTENSION    0738 02598000
*                                                            @ZA19960*/ 02599000
@RF00733 L     R4,SPCTEXT(,R4)                                     0738 02600000
*           END;                    /* END OF EXTENSION SCAN LOOP -     02601000
*                                      PTRLAST DOES NOT POINT TO ANY    02602000
*                                      ENTENSION, THEREFORE IT MUST     02603000
*                                      POINT TO A VALID FIX ENTRY  0739 02604000
*                                      WITHIN AN EXTENSION.  @ZA19960*/ 02605000
@DE00732 LTR   R4,R4                                               0739 02606000
         BNZ   @DL00732                                            0739 02607000
*           RESPECIFY                                              0740 02608000
*             R4 UNRESTRICTED;      /*                       @ZA19960*/ 02609000
*DLENTRY:                                                          0741 02610000
*           IF R0=SWAPPTR THEN      /* WAS LAST ENTRY DELETED?     0741 02611000
*                                                            @ZA19960*/ 02612000
DLENTRY  CR    R0,SWAPPTR                                          0741 02613000
         BE    @RT00741                                            0741 02614000
*             GOTO EXITSTG1;        /* YES, SO STAGE ONE NOW DONE  0742 02615000
*                                                            @ZA19960*/ 02616000
*           ELSE                    /*                       @ZA19960*/ 02617000
*             GOTO DOENTRY;         /* NO, SO GO REPROCESS THE     0743 02618000
*                                      CURRENT ENTRY         @ZA19960*/ 02619000
         B     DOENTRY                                             0743 02620000
*         END;                      /* END OF THERE ARE FIX ENTRIES     02621000
*                                      REMAINING IN THE SPCT @ZA19960*/ 02622000
*     END;                          /* END OF STORAGE ERROR IN PAGE     02623000
*                                      PROCESSING            @ZA19960*/ 02624000
*   PFTFXCT=PFTFXCT-SPCTFIXC;       /* DECREMENT PFTE FIX COUNT BY 0746 02625000
*                                      NUMBER OF FIXES ON THE PAGE BY   02626000
*                                      THIS ADDRESS SPACE. (EXCEPT 0746 02627000
*                                      COMMON AREA DEF.RELS.)        */ 02628000
@RF00716 LH    @01,PFTFXCT(,PFTEPTR)                               0746 02629000
         SH    @01,SPCTFIXC(,SWAPPTR)                              0746 02630000
         STH   @01,PFTFXCT(,PFTEPTR)                               0746 02631000
*   IF PFTVBN^<PVTLCSA THEN         /* TEST FOR COMMON AREA VBN.     */ 02632000
         CLC   PFTVBN(2,PFTEPTR),PVTLCSA(PVTPTR)                   0747 02633000
         BL    @RF00747                                            0747 02634000
*     DO;                           /* SPECIAL PROCESSING FOR COMMON    02635000
*                                      AREA FIXES                    */ 02636000
*       IF PFTFXCT=0 THEN           /* TEST IF FRAME IS NOW FREED    */ 02637000
         LTR   @01,@01                                             0749 02638000
         BNZ   @RF00749                                            0749 02639000
*         DO;                                                      0750 02640000
*           PVTCOMFX=PVTCOMFX-1;    /* DECREMENT GLOBAL COMMON AREA     02641000
*                                      FIX COUNT             @YA01572*/ 02642000
         LH    @01,PVTCOMFX(,PVTPTR)                               0751 02643000
         BCTR  @01,0                                               0751 02644000
         STH   @01,PVTCOMFX(,PVTPTR)                               0751 02645000
*           PVTCNTFX=PVTCNTFX-1;    /* DECREMENT SYSTEM FIX COUNT  0752 02646000
*                                                            @YA01572*/ 02647000
         LH    @01,PVTCNTFX(,PVTPTR)                               0752 02648000
         BCTR  @01,0                                               0752 02649000
         STH   @01,PVTCNTFX(,PVTPTR)                               0752 02650000
*           PFTVRPLT='0'B;          /* FRAME NOT POLLUTING V=R     0753 02651000
*                                                            @ZA31128*/ 02652000
         NI    PFTVRPLT(PFTEPTR),B'11101111'                       0753 02653000
*         END;                                                     0754 02654000
*       GOTO NEXTSPCT;              /* COMMON AREA FIX. DO NOT SWAP. */ 02655000
         B     NEXTSPCT                                            0755 02656000
*     END;                                                         0756 02657000
*   ELSE                            /* A LOCAL FRAME                 */ 02658000
*     IF PFTFXCT=0 THEN                                            0757 02659000
@RF00747 LH    @01,PFTFXCT(,PFTEPTR)                               0757 02660000
         LTR   @01,@01                                             0757 02661000
         BNZ   @RF00757                                            0757 02662000
*       DO;                                                        0758 02663000
*         RSMCNTFX=RSMCNTFX-1;      /* DECREMENT FIX COUNT FOR     0759 02664000
*                                      ADDRESS SPACE         @YA01572*/ 02665000
         LH    @01,RSMCNTFX(,RSMHDPTR)                             0759 02666000
         BCTR  @01,0                                               0759 02667000
         STH   @01,RSMCNTFX(,RSMHDPTR)                             0759 02668000
*         PVTCNTFX=PVTCNTFX-1;      /* DECREMENT SYSTEM FIX        0760 02669000
*                                      COUNT@YA01572                 */ 02670000
         LH    @01,PVTCNTFX(,PVTPTR)                               0760 02671000
         BCTR  @01,0                                               0760 02672000
         STH   @01,PVTCNTFX(,PVTPTR)                               0760 02673000
*       END;                                                       0761 02674000
*     ELSE                                                         0762 02675000
*       ;                                                          0762 02676000
@RF00757 DS    0H                                                  0763 02677000
*   CALL INITPCB;                   /* CALL SUBROUTINE TO INITIALIZE    02678000
*                                      A PCB TO SWAP OUT THE FIXED 0763 02679000
*                                      PAGE.                         */ 02680000
         BAL   @14,INITPCB                                         0763 02681000
*   RESPECIFY                                                      0764 02682000
*    (R1,                                                          0764 02683000
*     R15) RESTRICTED;              /*                       @Z40WPYC*/ 02684000
*   IF RETNCODE^=0 THEN             /* IF FINDPAGE ERROR, GET NEXT 0765 02685000
*                                      ENTRY                 @Z40WPYC*/ 02686000
         SLR   @14,@14                                             0765 02687000
         C     @14,RETNCODE(,PVTPTR)                               0765 02688000
         BE    @RF00765                                            0765 02689000
*     DO;                           /* CLEAR RETURN CODE     @Z40WPYC*/ 02690000
*       RETNCODE=0;                 /* CLEAR RETURN CODE     @Z40WPYC*/ 02691000
         ST    @14,RETNCODE(,PVTPTR)                               0767 02692000
*       GOTO NEXTSPCT;              /* GET NEXT ENTRY        @Z40WPYC*/ 02693000
         B     NEXTSPCT                                            0768 02694000
*     END;                          /* END FINDPAGE ERROR    @Z40WPYC*/ 02695000
*   ELSE                                                           0770 02696000
*     ;                             /* FINDPAGE SUCCESSFUL   @Z40WPYC*/ 02697000
@RF00765 DS    0H                                                  0771 02698000
*   PCBSPCTE=SWAPPTR;               /* INIT PTR TO SPCTE FOR ASM   0771 02699000
*                                                            @Z40WPYC*/ 02700000
         ST    SWAPPTR,PCBSPCTE(,PCBPTR)                           0771 02701000
*   AIASWPFX='1'B;                  /* INDICATE PRIVATE AREA FIX SWAP   02702000
*                                      PAGE                  @Z40WPYC*/ 02703000
         OI    AIASWPFX(PCBPTR),B'00000010'                        0772 02704000
*   R1->XPTXAV='1'B;                /* SET AUX VALID         @Z40WPYC*/ 02705000
         OI    XPTXAV(R1),B'01000000'                              0773 02706000
*   RESPECIFY                                                      0774 02707000
*    (R1,                                                          0774 02708000
*     R15) UNRESTRICTED;            /*                       @Z40WPYC*/ 02709000
*                                                                  0774 02710000
*   /*****************************************************************/ 02711000
*   /*                                                               */ 02712000
*   /* SET TO NEXT FIX ENTRY IN SPCT                                 */ 02713000
*   /*                                                               */ 02714000
*   /*****************************************************************/ 02715000
*                                                                  0775 02716000
*NEXTSPCT:                                                         0775 02717000
*   IF SWAPPTR=PTRLAST THEN         /* TEST IF AT END OF SPCT FIX  0775 02718000
*                                      ENTRIES.                      */ 02719000
NEXTSPCT C     SWAPPTR,PTRLAST(,PVTPTR)                            0775 02720000
         BE    @RT00775                                            0775 02721000
*     GOTO EXITSTG1;                /* ARE DONE WITH ALL FIXED PAGES.   02722000
*                                      EXIT.                         */ 02723000
*   SWAPPTR=SWAPPTR+LENGTH(SPCTSWPE);/* GET THE ADDRESS OF THE NEXT     02724000
*                                      SPCT FIX ENTRY TO BE        0777 02725000
*                                      PROCESSED.                    */ 02726000
         LA    @01,8                                               0777 02727000
         ALR   SWAPPTR,@01                                         0777 02728000
*   IF SWAPPTR=ENDPTR THEN          /* NOT AT END OF FIX ENTRIES.  0778 02729000
*                                      TEST IF AT END OF THE PRESENT    02730000
*                                      EXTENSION.                    */ 02731000
         CR    SWAPPTR,ENDPTR                                      0778 02732000
         BNE   @RF00778                                            0778 02733000
*     DO;                           /* ARE AT THE END OF THE       0779 02734000
*                                      EXTENSION. SET UP TO PROCESS     02735000
*                                      THE NEXT EXTENSION.           */ 02736000
*       ENDPTR=ENDPTR-LENGTH(SPCTEXTM);/* GET THE BEGINNING OF THE 0780 02737000
*                                      EXTENSION.                    */ 02738000
         LA    @15,56                                              0780 02739000
         SLR   ENDPTR,@15                                          0780 02740000
*       ENDPTR=ENDPTR->SPCTEXT;     /* GET THE ADDRESS OF THE NEXT 0781 02741000
*                                      EXTENSION.                    */ 02742000
*                                                                  0781 02743000
         L     ENDPTR,SPCTEXT(,ENDPTR)                             0781 02744000
*       /*************************************************************/ 02745000
*       /*                                                           */ 02746000
*       /* GET THE ADDRESS OF THE FIRST FIX ENTRY IN THE NEW         */ 02747000
*       /* EXTENSION.                                                */ 02748000
*       /*                                                           */ 02749000
*       /*************************************************************/ 02750000
*                                                                  0782 02751000
*       SWAPPTR=ENDPTR+(LENGTH(SPCTEXTM)-LENGTH(SPCTENT));         0782 02752000
         ALR   @01,ENDPTR                                          0782 02753000
         LR    SWAPPTR,@01                                         0782 02754000
*       ENDPTR=ENDPTR+LENGTH(SPCTEXTM);/* GET THE ADDRESS OF THE END    02755000
*                                      OF THE NEW EXTENSION.         */ 02756000
         ALR   ENDPTR,@15                                          0783 02757000
*     END;                          /* ARE READY TO PROCESS THE NEXT    02758000
*                                      EXTENSION.                    */ 02759000
*   GOTO DOENTRY;                   /* GO PROCESS THE NEXT SPCT FIX     02760000
*                                      ENTRY.                        */ 02761000
         B     DOENTRY                                             0785 02762000
*STG1ERR:                                                          0786 02763000
*   R0='01'X;                       /* RECORD LRA FAILURE            */ 02764000
STG1ERR  LA    R0,1                                                0786 02765000
*   CALL DOABEND;                   /* RECORD THE ERROR              */ 02766000
         BAL   @14,DOABEND                                         0787 02767000
*   GO TO NEXTSPCT;                 /* GO PROCESS NEXT ENTRY         */ 02768000
*                                                                  0788 02769000
         B     NEXTSPCT                                            0788 02770000
*   /*****************************************************************/ 02771000
*   /*                                                               */ 02772000
*   /* EXIT STAGE 1 PROCESSOR                                        */ 02773000
*   /*                                                               */ 02774000
*   /*****************************************************************/ 02775000
*                                                                  0789 02776000
*EXITSTG1:                                                         0789 02777000
*   RESPECIFY                                                      0789 02778000
*    (R14) RESTRICTED;                                             0789 02779000
EXITSTG1 DS    0H                                                  0790 02780000
*   R14=LEV1RTN;                    /* GET THE RETURN ADDRESS.       */ 02781000
         L     R14,LEV1RTN(,PVTPTR)                                0790 02782000
*   RESPECIFY                                                      0791 02783000
*    (SWAPPTR,                                                     0791 02784000
*     PFTEPTR,                                                     0791 02785000
*     PCBPTR,                                                      0791 02786000
*     ENDPTR,                                                      0791 02787000
*     R14) UNRESTRICTED;                                           0791 02788000
*   END STAGE1;                                                    0792 02789000
@EL00005 DS    0H                                                  0792 02790000
@EF00005 DS    0H                                                  0792 02791000
@ER00005 BR    @14                                                 0792 02792000
*                                                                  0793 02793000
*   /*****************************************************************/ 02794000
*   /*                                                               */ 02795000
*   /* THIS SECTION BUILDS SWAP OUT PCBS FOR IN CORE, NON FIXED      */ 02796000
*   /* CHANGED PAGES OR IN CORE ZERO TCB FIXED PAGES                 */ 02797000
*   /*                                                               */ 02798000
*   /*****************************************************************/ 02799000
*                                                                  0793 02800000
*WORKSET:                                                          0793 02801000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0793 02802000
WORKSET  DS    0H                                                  0794 02803000
*   RESPECIFY                                                      0794 02804000
*    (PFTEPTR,                                                     0794 02805000
*     PCBPTR,                                                      0794 02806000
*     R14) RESTRICTED;                                             0794 02807000
*   LEV1RTN=R14;                    /* SAVE THE RETURN ADDRESS.      */ 02808000
         ST    R14,LEV1RTN(,PVTPTR)                                0795 02809000
*   RESPECIFY                                                      0796 02810000
*    (R14) UNRESTRICTED;                                           0796 02811000
*                                                                  0796 02812000
*   /*****************************************************************/ 02813000
*   /*                                                               */ 02814000
*   /* PROCESS LOCAL FRAME QUEUE FIRST                               */ 02815000
*   /*                                                               */ 02816000
*   /*****************************************************************/ 02817000
*                                                                  0797 02818000
*   IF RSMLFQF=0 THEN               /* TEST FOR NO LOCAL FRAMES.     */ 02819000
         LH    @12,RSMLFQF(,RSMHDPTR)                              0797 02820000
         N     @12,@CF02704                                        0797 02821000
         LTR   @12,@12                                             0797 02822000
         BZ    @RT00797                                            0797 02823000
*     GOTO EXITWS;                  /* ARE NO FRAMES. GO EXIT        */ 02824000
*   IF NLSQAPCB=0 THEN              /* IF NO FIXED PCBS EXIT, SET  0799 02825000
*                                      NON-LSQA PTR TO NEXT AVAILABLE   02826000
*                                      PCB                   @Z40WPYC*/ 02827000
         L     @12,SPCTSWRT(,SPCTPTR)                              0799 02828000
         L     @06,NLSQAPCB-1(,@12)                                0799 02829000
         LA    @06,0(,@06)                                         0799 02830000
         LTR   @06,@06                                             0799 02831000
         BNZ   @RF00799                                            0799 02832000
*     DO;                           /* NO FIXED PCB          @Z40WPYC*/ 02833000
*       AIANXAIA=0;                 /* SEPARATE LSQA AIAS FROM     0801 02834000
*                                      NON-LSQA AIAS         @Z40WPYC*/ 02835000
         SLR   @06,@06                                             0801 02836000
         ST    @06,AIANXAIA(,PCBPTR)                               0801 02837000
*       NLSQAPCB=NEXTPCB;           /* SET NON-LSQA PTR IN CASE A  0802 02838000
*                                      FIXED OR STAGE2 PCB IS      0802 02839000
*                                      CONSTRUCTED           @Z40WPYC*/ 02840000
         MVC   NLSQAPCB(3,@12),NEXTPCB+1(PVTPTR)                   0802 02841000
*     END;                          /* END OF NO FIXED PCBS  @Z40WPYC*/ 02842000
*   ELSE                                                           0804 02843000
*     ;                             /* NLSQAPCB ALREADY INITIALIZED     02844000
*                                                            @Z40WPYC*/ 02845000
@RF00799 DS    0H                                                  0805 02846000
*   PFTEPTR=PVTPFTP+RSMLFQF;        /* GET THE ADDRESS OF THE FIRST     02847000
*                                      LOCAL FRAME.                  */ 02848000
         LH    PFTEPTR,RSMLFQF(,RSMHDPTR)                          0805 02849000
         N     PFTEPTR,@CF02704                                    0805 02850000
         AL    PFTEPTR,PVTPFTP(,PVTPTR)                            0805 02851000
*   GOTO PROCPFTE;                  /* GO PROCESS THE PFTE.          */ 02852000
         B     PROCPFTE                                            0806 02853000
*NEXTPFTE:                                                         0807 02854000
*   FPCALLED='0'B;                  /* INDICATE THAT FINDPAGE HAS NOT   02855000
*                                      BEEN CALLED FOR THIS FRAME. 0807 02856000
*                                      (REG0 DOES NOT CONTAIN THE  0807 02857000
*                                      PFTE ADDR AND REG 1 DOES NOT     02858000
*                                      HAVE THE XPTE ADDRESS FOR THIS   02859000
*                                      FRAME).               @Z40WPYD*/ 02860000
NEXTPFTE NI    FPCALLED(PVTPTR),B'11111101'                        0807 02861000
*   PFTEPTR=PVTPFTP+PFTFQPTR;       /* GET THE ADDRESS OF THE NEXT 0808 02862000
*                                      LOCAL FRAME.                  */ 02863000
*                                                                  0808 02864000
         LH    @12,PFTFQPTR(,PFTEPTR)                              0808 02865000
         N     @12,@CF02704                                        0808 02866000
         AL    @12,PVTPFTP(,PVTPTR)                                0808 02867000
         LR    PFTEPTR,@12                                         0808 02868000
*   /*****************************************************************/ 02869000
*   /*                                                               */ 02870000
*   /* PROCESS PFTE, IF FRAME IS VIO IRREGULAR AND NO I/O IS GOING ON*/ 02871000
*   /* FOR IT, FREE THE FRAME                                        */ 02872000
*   /*                                                               */ 02873000
*   /*****************************************************************/ 02874000
*                                                                  0809 02875000
*PROCPFTE:                                                         0809 02876000
*   IF PFTIRRG='1'B THEN            /* TEST IF AN IRREGULAR (VIO)  0809 02877000
*                                      PAGE.                         */ 02878000
PROCPFTE TM    PFTIRRG(PFTEPTR),B'00010000'                        0809 02879000
         BNO   @RF00809                                            0809 02880000
*     IF PFTPCBSI='0'B THEN         /* IS AN IRREGULAR PAGE, SO TEST    02881000
*                                      THAT NO I/O IS IN PROGRESS.   */ 02882000
         TM    PFTPCBSI(PFTEPTR),B'00001000'                       0810 02883000
         BNZ   @RF00810                                            0810 02884000
*       DO;                         /* FREE THE FRAME.               */ 02885000
*         R0=PFTEPTR-PVTPFTP;       /* GET THE RBN OF THE PFTE.      */ 02886000
         LR    R0,PFTEPTR                                          0812 02887000
         SL    R0,PVTPFTP(,PVTPTR)                                 0812 02888000
*         R0=CONSPFTE|R0;           /* SET UP PFTE E/D INTERFACE.    */ 02889000
         O     R0,@CF02502                                         0813 02890000
*         PFTEPTR=PFTBQPTR;         /* GET THE RBN OF THE PREVIOUS 0814 02891000
*                                      PFTE, WHICH WILL HAVE RBN OF     02892000
*                                      THE NEXT PFTE TO DO.          */ 02893000
         LH    @12,PFTBQPTR(,PFTEPTR)                              0814 02894000
         N     @12,@CF02704                                        0814 02895000
         LR    PFTEPTR,@12                                         0814 02896000
*         CALL IEAVPFTE;            /* CALL PFTE ENQ/DEQ TO FREE THE    02897000
*                                      IRREGULAR FRAME.              */ 02898000
*                                                                  0815 02899000
         L     @15,PVTPFTE(,PVTPTR)                                0815 02900000
         BALR  @14,@15                                             0815 02901000
*         /***********************************************************/ 02902000
*         /*                                                         */ 02903000
*         /* ADJUST PFTEPTR TO NEXT PFTE                             */ 02904000
*         /*                                                         */ 02905000
*         /***********************************************************/ 02906000
*                                                                  0816 02907000
*         IF PFTEPTR=0 THEN         /* TEST IF THE FREED PFTE WAS THE   02908000
*                                      FIRST ON THE QUEUE.           */ 02909000
         LTR   PFTEPTR,PFTEPTR                                     0816 02910000
         BNZ   @RF00816                                            0816 02911000
*           PFTEPTR=ADDR(RSMLFQF)-LENGTH(PFTPGID);/* FREED THE FIRST    02912000
*                                      ON THE QUEUE SO MUST GET THE     02913000
*                                      NEW FIRST PFTE.               */ 02914000
         LA    PFTEPTR,RSMLFQF(,RSMHDPTR)                          0817 02915000
         SL    PFTEPTR,@CF00039                                    0817 02916000
*         ELSE                      /* THE FREED PFTE IS NOT THE   0818 02917000
*                                      FIRST, SO THE SAVED BACKWARD     02918000
*                                      RBN IS THE NEXT PFTE TO DO.   */ 02919000
*           PFTEPTR=PVTPFTP+PFTEPTR;/* GET THE PREVIOUS PFTE. HAS THE   02920000
*                                      NEXT PFTE TO DO.              */ 02921000
         B     @RC00816                                            0818 02922000
@RF00816 AL    PFTEPTR,PVTPFTP(,PVTPTR)                            0818 02923000
*         GOTO TESTRBN;             /* GO PROCESS THE NEXT LOCAL   0819 02924000
*                                      FRAME.                        */ 02925000
         B     TESTRBN                                             0819 02926000
*       END;                        /* END FREEING IRREG FRAME.      */ 02927000
*     ELSE                          /* I/O IS IN PROGRESS. DO NOT  0821 02928000
*                                      FREE FRAME.                   */ 02929000
*       GOTO TESTRBN;               /* GO PROCESS THE NEXT PFTE.     */ 02930000
*   ELSE                                                           0822 02931000
*     ;                             /* END IRREGULAR PAGE PROCESSING.*/ 02932000
@RF00809 DS    0H                                                  0823 02933000
*                                                                  0823 02934000
*   /*****************************************************************/ 02935000
*   /*                                                               */ 02936000
*   /* FRAME IS NOT VIO IRREGULAR, IS A PCB DEFINED FOR THIS FRAME   */ 02937000
*   /*                                                               */ 02938000
*   /*****************************************************************/ 02939000
*                                                                  0823 02940000
*   IF PFTPCBSI='1'B THEN           /* TEST IF A PCB IS DEFINED FOR     02941000
*                                      THE FRAME.                    */ 02942000
*                                                                  0823 02943000
         TM    PFTPCBSI(PFTEPTR),B'00001000'                       0823 02944000
         BNO   @RF00823                                            0823 02945000
*     /***************************************************************/ 02946000
*     /*                                                             */ 02947000
*     /* A PCB IS DEFINED, SO EITHER I/O WAS PURGED AND NOT YET      */ 02948000
*     /* COMPLETE OR THE PAGE IS FIXED AND THE STAGE1 PROCESSOR BUILT*/ 02949000
*     /* A SWAP OUT PCB. THE PAGE DOES NOT NEED TO BE SWAPPED OUT BY */ 02950000
*     /* THIS PROCESSOR. TEST IF THERE ARE FIXES STILL IN THE FRAME. */ 02951000
*     /*                                                             */ 02952000
*     /***************************************************************/ 02953000
*                                                                  0824 02954000
*     IF PFTFXCT^=0 THEN                                           0824 02955000
         LH    @12,PFTFXCT(,PFTEPTR)                               0824 02956000
         LTR   @12,@12                                             0824 02957000
         BZ    @RF00824                                            0824 02958000
*       DO;                         /* ARE FIXES IN THE FRAME STILL.    02959000
*                                      CAN ONLY BE 0-TCB FIXES WHICH    02960000
*                                      DID NOT HAVE A FOE AND THE PCB   02961000
*                                      EITHER WAS BUILT BY FIXENTRY     02962000
*                                      OR WAS A ZERO TCB FIX FOR   0825 02963000
*                                      WHICH PIOPURGE COULD NOT MAKE    02964000
*                                      A FIX ENTRY.                  */ 02965000
*         RESPECIFY                                                0826 02966000
*          (R1,                                                    0826 02967000
*           SWAPPTR) RESTRICTED;                                   0826 02968000
*                                                                  0826 02969000
*         /***********************************************************/ 02970000
*         /*                                                         */ 02971000
*         /* IF FRAME IS NOT VALID IT IS A ZERO TCB FIX FOR WHICH    */ 02972000
*         /* PIOPURGE WAS UNABLE TO MAKE A FIX ENTRY. FRAME WILL BE  */ 02973000
*         /* VALIDATED WHEN I/O COMPLETES AND IOCP RUNS. ROOT PCB    */ 02974000
*         /* PROCESSING WAS NOT DONE                                 */ 02975000
*         /*                                                         */ 02976000
*         /***********************************************************/ 02977000
*                                                                  0827 02978000
*         LRAREG=PFTVBN*256;        /* GET RSA                       */ 02979000
         LH    LRAREG,PFTVBN(,PFTEPTR)                             0827 02980000
         N     LRAREG,@CF02704                                     0827 02981000
         SLA   LRAREG,8                                            0827 02982000
*         GEN CODE REFS(LRAREG) SETS(LRAREG) FLOWS(TESTRBN);       0828 02983000
         LRA LRAREG,0(LRAREG)       GET REAL ADDRESS                    02984000
         BC  2,TESTRBN              GET NEXT PFTE IF PGTE INVALID       02985000
*         R1=PFTVBN;                /* GET THE VBN OF THE PAGE.      */ 02986000
         LH    R1,PFTVBN(,PFTEPTR)                                 0829 02987000
         N     R1,@CF02704                                         0829 02988000
*         CALL GETFIX;              /* GET THE SPCT FIX ENTRY.       */ 02989000
*                                                                  0830 02990000
         BAL   @14,GETFIX                                          0830 02991000
*         /***********************************************************/ 02992000
*         /*                                                         */ 02993000
*         /* IF RETURN CODE IS NOT ZERO, A SERIOUS ERROR SUCH AS THE */ 02994000
*         /* SPCT OR PVT BEING CLOBBERED HAS OCCURED, THE VBN SHOULD */ 02995000
*         /* HAVE BEEN THERE. ALTHOUGH FIX COUNTS FOR THIS FRAME ARE */ 02996000
*         /* IN 2 PLACES (THE PFTE AND THE MISSING SPCT ENTRY)       */ 02997000
*         /* PROCESSING CONTINUES WITH THE NEXT PFTE.                */ 02998000
*         /*                                                         */ 02999000
*         /***********************************************************/ 03000000
*                                                                  0831 03001000
*         IF RETNCODE=0 THEN                                       0831 03002000
         SLR   @06,@06                                             0831 03003000
         C     @06,RETNCODE(,PVTPTR)                               0831 03004000
         BNE   @RF00831                                            0831 03005000
*           DO;                                                    0832 03006000
*             IF SPCTFIXC=0 THEN    /* WAS A NEW ENTRY CREATED       */ 03007000
         CH    @06,SPCTFIXC(,SWAPPTR)                              0833 03008000
         BNE   @RF00833                                            0833 03009000
*               DO;                                                0834 03010000
*                 R0='15'X;         /* AN ENTRY SHOULD HAVE BEEN   0835 03011000
*                                      THERE. RECORD THE ERROR AND 0835 03012000
*                                      HOPE.                         */ 03013000
         LA    R0,21                                               0835 03014000
*                 CALL DOABEND;     /* RECORD ERROR                  */ 03015000
         BAL   @14,DOABEND                                         0836 03016000
*               END;                                               0837 03017000
*             SPCTFIXC=SPCTFIXC+PFTFXCT;/* ADD THE 0-TCB FIXES TO THE   03018000
*                                      TOTAL FIX COUNT IN THE SPCT.  */ 03019000
@RF00833 LH    @06,SPCTFIXC(,SWAPPTR)                              0838 03020000
         AH    @06,PFTFXCT(,PFTEPTR)                               0838 03021000
         STH   @06,SPCTFIXC(,SWAPPTR)                              0838 03022000
*             RSMCNTFX=RSMCNTFX-1;  /* DECREMENT FIX COUNT FOR THIS     03023000
*                                      ADDRESS SPACE         @YA01572*/ 03024000
         LH    @06,RSMCNTFX(,RSMHDPTR)                             0839 03025000
         BCTR  @06,0                                               0839 03026000
         STH   @06,RSMCNTFX(,RSMHDPTR)                             0839 03027000
*             PVTCNTFX=PVTCNTFX-1;  /* DECREMENT THE SYSTEM FIX COUNT   03028000
*                                                            @YA01572*/ 03029000
         LH    @06,PVTCNTFX(,PVTPTR)                               0840 03030000
         BCTR  @06,0                                               0840 03031000
         STH   @06,PVTCNTFX(,PVTPTR)                               0840 03032000
*             PFTFXCT=0;            /* ZERO THE PFTE FIX COUNT.      */ 03033000
         SLR   @06,@06                                             0841 03034000
         STH   @06,PFTFXCT(,PFTEPTR)                               0841 03035000
*           END;                                                   0842 03036000
*         ELSE                      /* TRIED TO CREATE NEW ENTRY     */ 03037000
*           DO;                                                    0843 03038000
         B     @RC00831                                            0843 03039000
@RF00831 DS    0H                                                  0844 03040000
*             R0='15'X;             /* AN ATTEMPT WAS MADE TO CREATE    03041000
*                                      A NEW ENTRY BUT THE ATTEMPT 0844 03042000
*                                      FAILED AN EXISTING ENTRY    0844 03043000
*                                      SHOULD HAVE BEEN THERE        */ 03044000
         LA    R0,21                                               0844 03045000
*             CALL DOABEND;         /* RECORD ERROR                  */ 03046000
         BAL   @14,DOABEND                                         0845 03047000
*             RETNCODE=0;           /* CLEAR RETURN CODE             */ 03048000
         SLR   @06,@06                                             0846 03049000
         ST    @06,RETNCODE(,PVTPTR)                               0846 03050000
*           END;                                                   0847 03051000
*         RESPECIFY                                                0848 03052000
*          (R1,                                                    0848 03053000
*           SWAPPTR) UNRESTRICTED;                                 0848 03054000
@RC00831 DS    0H                                                  0849 03055000
*       END;                        /* END 0-TCB PROC. GET NEXT PFTE.*/ 03056000
*     ELSE                                                         0850 03057000
*       ;                           /* PAGING I/O WAS PURGED, OR   0850 03058000
*                                      THERE WERE NO ZERO TCB FIXES     03059000
*                                      SO DO NOT SWAP OUT THE PAGE.     03060000
*                                      GET NEXT PFTE.                */ 03061000
@RF00824 DS    0H                                                  0851 03062000
*                                                                  0851 03063000
*   /*****************************************************************/ 03064000
*   /*                                                               */ 03065000
*   /* NO PCB DEFINED, SO THE PAGE IS IN CORE. HAVE WORK TO DO.      */ 03066000
*   /*                                                               */ 03067000
*   /*****************************************************************/ 03068000
*                                                                  0851 03069000
*   ELSE                                                           0851 03070000
*     DO;                                                          0851 03071000
         B     @RC00823                                            0851 03072000
@RF00823 DS    0H                                                  0852 03073000
*       RFY                                                        0852 03074000
*        (R1,                                                      0852 03075000
*         R4,                                                      0852 03076000
*         SWAPPTR) RSTD;                                           0852 03077000
*       IF PFTFXCT=0 THEN           /* TEST FOR AN IN CORE, NON-FIXED   03078000
*                                      PAGE.                         */ 03079000
         LH    @06,PFTFXCT(,PFTEPTR)                               0853 03080000
         LTR   @06,@06                                             0853 03081000
         BNZ   @RF00853                                            0853 03082000
*         DO;                       /* IN CORE, NON-FIXED PAGE. MAY     03083000
*                                      BE PART OF THE WORKING SET.   */ 03084000
*           RESPECIFY                                              0855 03085000
*            (R15) RESTRICTED;                                     0855 03086000
*           R1=PFTVBN*256;          /* GET THE VSA FROM THE VBN.     */ 03087000
         LH    R1,PFTVBN(,PFTEPTR)                                 0856 03088000
         N     R1,@CF02704                                         0856 03089000
         SLA   R1,8                                                0856 03090000
*           CALL IEAVFP2;           /* CALL FINDPAGE TO GET THE PGTE    03091000
*                                      AND XPTE ADDRESSES.           */ 03092000
         L     @15,PVTPFP2(,PVTPTR)                                0857 03093000
         BALR  @14,@15                                             0857 03094000
*           IF R15^=0 THEN          /* TEST FOR A BAD RETURN CODE.   */ 03095000
         LTR   R15,R15                                             0858 03096000
         BZ    @RF00858                                            0858 03097000
*             DO;                   /* INTERNAL ERROR IF BAD RETURN     03098000
*                                      CODE. PAGE AND SEGMENT MUST BE   03099000
*                                      VALID IF THERE IS A FRAME   0859 03100000
*                                      ASSIGNED.                     */ 03101000
*               R0='01'X;           /* RECORD FINDPAGE FAILURE       */ 03102000
         LA    R0,1                                                0860 03103000
*               CALL DOABEND;       /* RECORD THE ERROR              */ 03104000
         BAL   @14,DOABEND                                         0861 03105000
*               GO TO TESTRBN;      /* GO DO NEXT FRAME THIS FRAME 0862 03106000
*                                      REMAINS IN STORAGE            */ 03107000
         B     TESTRBN                                             0862 03108000
*             END;                                                 0863 03109000
*           RESPECIFY                                              0864 03110000
*            (R15) UNRESTRICTED;                                   0864 03111000
*                                                                  0864 03112000
@RF00858 DS    0H                                                  0865 03113000
*           /*********************************************************/ 03114000
*           /*                                                       */ 03115000
*           /* TEST IF AUX STORAGE DOES NOT NEED TO BE SAVED. IF NOT */ 03116000
*           /* TO BE SAVED AND PAGE NOT CHANGED, CAN FREE FRAME      */ 03117000
*           /* WITHOUT HAVING TO SWAP OUT.                           */ 03118000
*           /*                                                       */ 03119000
*           /*********************************************************/ 03120000
*                                                                  0865 03121000
*           IF R1->XPTVIOLP='0'B THEN                              0865 03122000
         TM    XPTVIOLP(R1),B'10000000'                            0865 03123000
         BNZ   @RF00865                                            0865 03124000
*             DO;                   /* DO NOT SAVE AUX. SEE IF PAGE     03125000
*                                      IS CHANGED.           @Z40WPYC*/ 03126000
*               TEMPSAVE=R1;        /* SAVE REG 1.                   */ 03127000
         ST    R1,TEMPSAVE(,PVTPTR)                                0867 03128000
*               R1=R0;              /* GET THE PGTE ADDRESS TO GET 0868 03129000
*                                      RBN.                          */ 03130000
         LR    R1,R0                                               0868 03131000
*               R1=R1->PGTRSA;      /* GET THE RBN.                  */ 03132000
*                                                                  0869 03133000
         SLR   @06,@06                                             0869 03134000
         ICM   @06,3,PGTRSA(R1)                                    0869 03135000
         LR    R1,@06                                              0869 03136000
*               /*****************************************************/ 03137000
*               /*                                                   */ 03138000
*               /* GET RSA AND CHECK CHANGE BITS.                    */ 03139000
*               /*                                                   */ 03140000
*               /*****************************************************/ 03141000
*                                                                  0870 03142000
*               GENERATE CODE FLOWS(DOMASK,DOMASKA,NCHANGE1,REF1S2K);   03143000
*                                                      /* YM04950*/     03144000
         SRL   R1,4            CLEAR FLAG BITS                          03145000
         SLL   R1,12           GET RSA FROM RBN                         03146000
         RRB   0(R1)           CHECK FOR CHANGE IN FIRST 2K             03147000
         BC    1,DOMASKA       1ST 2K REFERENCED AND CHANGED            03148000
         BC    8,NCHANGE1      1ST 2K NOT REFERENCED OR CHANGED         03149000
         BC    2,REF1S2K       1ST 2K REFERENCED BUT NOT CHANGED        03150000
         RRB   2048(R1)        1ST 2K UNREFED BUT CHANGED CK 2ND 2K     03151000
         BC    3,DOMASKA       FRAME IS REFERENCED AND CHANGED          03152000
         B     DOMASK          FRAME IS CHANGED BUT NOT REFERENCED      03153000
*REF1S2K:                                                          0871 03154000
*               PFTUIC='FF'X;       /* 1ST 2K WAS REFERENCED AND NOT    03155000
*                                      CHANGED YM04950               */ 03156000
REF1S2K  MVI   PFTUIC(PFTEPTR),X'FF'                               0871 03157000
*NCHANGE1:                                                         0872 03158000
*               GEN CODE FLOWS(DOMASK,DOMASKA,ZEROZERO);           0872 03159000
NCHANGE1 DS    0H                                                  0872 03160000
*                                                       /*  YM04950*/   03161000
         RRB   2048(R1)        CK 2ND 2K                                03162000
         BC    1,DOMASKA       2ND 2K IS REFERENCED AND CHANGED         03163000
         BC    4,DOMASK        2ND 2K IS NOT REFERENCED BUT IS CHANGED  03164000
         BC    8,ZEROZERO      2ND 2K IS NOT REFERENCED OR CHANGED      03165000
*               PFTUIC='FF'X;       /* FRAME WAS REFERENCED AND NOT     03166000
*                                      CHANGED                YM04950*/ 03167000
         MVI   PFTUIC(PFTEPTR),X'FF'                               0873 03168000
*ZEROZERO:                                                         0874 03169000
*               R1=TEMPSAVE;        /* GET XPT ADDRESS        YM04950*/ 03170000
ZEROZERO L     R1,TEMPSAVE(,PVTPTR)                                0874 03171000
*               R4=R0;              /* GET THE PGTE ADDRESS          */ 03172000
         LR    R4,R0                                               0875 03173000
*               R0=CONSPFTE;        /* PFTE TO FRONT OF AVAILABLE  0876 03174000
*                                      FRAME Q               @Z40WPYC*/ 03175000
         L     R0,@CF02502                                         0876 03176000
*               IF(PFTUIC<OUXBSTC|PFTUIC='FF'X)&R1->XPTXAV='1'B THEN    03177000
         L     @06,ASCBPTR                                         0877 03178000
         L     @06,OUXBPTR(,@06)                                   0877 03179000
         SLR   @05,@05                                             0877 03180000
         IC    @05,PFTUIC(,PFTEPTR)                                0877 03181000
         CH    @05,OUXBSTC(,@06)                                   0877 03182000
         BL    @GL00014                                            0877 03183000
         CLI   PFTUIC(PFTEPTR),255                                 0877 03184000
         BNE   @RF00877                                            0877 03185000
@GL00014 TM    XPTXAV(R1),B'01000000'                              0877 03186000
         BNO   @RF00877                                            0877 03187000
*                                   /* DETERMINE IF THE FRAME SHOULD    03188000
*                                      BE STOLEN. CHECK FOR A FIRST     03189000
*                                      REFERENCE CASE SO SWIN WILL 0878 03190000
*                                      NOT TRY TO PAGE-IN A PAGE   0878 03191000
*                                      WHICH WAS NEVER PAGED OUT   0878 03192000
*                                                             YM04950*/ 03193000
*                 DO;               /*                        YM04950*/ 03194000
*                   R1=PFTVBN;      /* GET VBN FOR SETMASK    YM04950*/ 03195000
         LH    R1,PFTVBN(,PFTEPTR)                                 0879 03196000
         N     R1,@CF02704                                         0879 03197000
*                   CALL SETMASK;   /* GO SET MASK BIT        YM04950*/ 03198000
         BAL   @14,SETMASK                                         0880 03199000
*                   R0=0;           /* PFTE TO BACK OF AFQ   @Z40WPYC*/ 03200000
         SLR   R0,R0                                               0881 03201000
*                 END;              /*                        YM04950*/ 03202000
*               R1=PFTEPTR-PVTPFTP; /* GET RBN AGAIN YM04950         */ 03203000
*                                                                  0883 03204000
@RF00877 LR    R1,PFTEPTR                                          0883 03205000
         SL    R1,PVTPFTP(,PVTPTR)                                 0883 03206000
*               /*****************************************************/ 03207000
*               /*                                                   */ 03208000
*               /* IF HERE, PAGE IS UNCHANGED AND FRAME CAN BE FREED */ 03209000
*               /*                                                   */ 03210000
*               /*****************************************************/ 03211000
*                                                                  0884 03212000
*               R0=R1|R0;           /* SET UP PFTE INTERFACE @Z40WPYC*/ 03213000
         OR    R0,R1                                               0884 03214000
*               PFTEPTR=PFTBQPTR;   /* GET THE RBN OF THE PREVIOUS 0885 03215000
*                                      PFTE, WHICH WILL HAVE RBN OF     03216000
*                                      THE NEXT PFTE TO DO.          */ 03217000
*                                                                  0885 03218000
         LH    @06,PFTBQPTR(,PFTEPTR)                              0885 03219000
         N     @06,@CF02704                                        0885 03220000
         LR    PFTEPTR,@06                                         0885 03221000
*               /*****************************************************/ 03222000
*               /*                                                   */ 03223000
*               /* IF A BIT MARK ENTRY IS MADE, THE PFTE IS MOVED TO */ 03224000
*               /* THE BACK OF THE AFQ IN ORDER THAT RECLAIM WILL    */ 03225000
*               /* HAVE A BETTER CHANCE OF SUCCESS DURING SWAPIN     */ 03226000
*               /*                                                   */ 03227000
*               /*****************************************************/ 03228000
*                                                                  0886 03229000
*               CALL IEAVPFTE;      /* CALL PFTE ENQ/DEQ TO FREE THE    03230000
*                                      FRAME.                        */ 03231000
         L     @15,PVTPFTE(,PVTPTR)                                0886 03232000
         BALR  @14,@15                                             0886 03233000
*               IF PFTEPTR=0 THEN   /* TEST IF THE FREED PFTE WAS THE   03234000
*                                      FIRST ON THE QUEUE.           */ 03235000
         LTR   PFTEPTR,PFTEPTR                                     0887 03236000
         BNZ   @RF00887                                            0887 03237000
*                 PFTEPTR=ADDR(RSMLFQF)-LENGTH(PFTPGID);/* SET UP THE   03238000
*                                      FIRST PFTE.                   */ 03239000
         LA    PFTEPTR,RSMLFQF(,RSMHDPTR)                          0888 03240000
         SL    PFTEPTR,@CF00039                                    0888 03241000
*               ELSE                /* THE FREED PFTE IS NOT THE   0889 03242000
*                                      FIRST, SO THE SAVED BACKWARD     03243000
*                                      RBN IS THE NEXT PFTE TO DO.   */ 03244000
*                 PFTEPTR=PVTPFTP+PFTEPTR;/* GET THE PREVIOUS PFTE.  */ 03245000
         B     @RC00887                                            0889 03246000
@RF00887 AL    PFTEPTR,PVTPFTP(,PVTPTR)                            0889 03247000
*               GOTO INVALPGT;      /* GO INVALIDATE THE PGTE AND  0890 03248000
*                                      PROCESS THE NEXT LOCAL FRAME. */ 03249000
*                                                                  0890 03250000
         B     INVALPGT                                            0890 03251000
*               /*****************************************************/ 03252000
*               /*                                                   */ 03253000
*               /* PAGE WAS CHANGED, INITIALIZE A PCB, SET BIT MASK  */ 03254000
*               /* AND INVALIDATE PGTE                               */ 03255000
*               /*                                                   */ 03256000
*               /*****************************************************/ 03257000
*                                                                  0891 03258000
*DOMASKA:                                                          0891 03259000
*               PFTUIC='FF'X;       /* SET UIC TO ZERO SO FRAME WILL    03260000
*                                      NOT BE STOLEN          YM04950*/ 03261000
DOMASKA  MVI   PFTUIC(PFTEPTR),X'FF'                               0891 03262000
*DOMASK:                                                           0892 03263000
*               R1=TEMPSAVE;        /* RESTORE REG 1.                */ 03264000
DOMASK   L     R1,TEMPSAVE(,PVTPTR)                                0892 03265000
*             END;                                                 0893 03266000
*           ELSE                                                   0894 03267000
*             ;                     /* AUX STORAGE MUST BE SAVED, SO    03268000
*                                      SWAP OUT THE PAGE.    @Z40WPYC*/ 03269000
@RF00865 DS    0H                                                  0895 03270000
*           FPCALLED='1'B;          /* INDICATE FINDPAGE WAS CALLED     03271000
*                                      FOR THIS FRAME. (R0 & R1    0895 03272000
*                                      CONTAIN THE PGTE AND XPTE   0895 03273000
*                                      ADDRESS, RESPECTIVELY.)     0895 03274000
*                                                            @Z40WPYD*/ 03275000
         OI    FPCALLED(PVTPTR),B'00000010'                        0895 03276000
*           CALL INITPCB;           /* INITIALIZE A PCB TO SWAP OUT     03277000
*                                      THE PAGE. WE MAY RUN OUT OF 0896 03278000
*                                      PCBS                          */ 03279000
*                                                                  0896 03280000
         BAL   @14,INITPCB                                         0896 03281000
*           /*********************************************************/ 03282000
*           /*                                                       */ 03283000
*           /* IF NO MORE PCBS WERE AVAILABLE THE FRAME IS LEFT VALID*/ 03284000
*           /* ON THE LOCAL FRAME QUEUE AND WILL STILL BE VALID AND  */ 03285000
*           /* IN STORAGE AT SWAPIN TIME.                            */ 03286000
*           /*                                                       */ 03287000
*           /*********************************************************/ 03288000
*                                                                  0897 03289000
*           IF RETNCODE^=0 THEN                                    0897 03290000
         SLR   @06,@06                                             0897 03291000
         C     @06,RETNCODE(,PVTPTR)                               0897 03292000
         BE    @RF00897                                            0897 03293000
*             DO;                                                  0898 03294000
*               RETNCODE=0;         /* CLEAR RETURN CODE             */ 03295000
         ST    @06,RETNCODE(,PVTPTR)                               0899 03296000
*               GO TO TESTRBN;      /* GO DO NEXT PFTE               */ 03297000
         B     TESTRBN                                             0900 03298000
*             END;                                                 0901 03299000
*           R1->XPTXAV='1'B;        /* SET AUX VALID FLAG            */ 03300000
@RF00897 OI    XPTXAV(R1),B'01000000'                              0902 03301000
*           R4=R0;                  /* SAVE PGTE ADDRESS             */ 03302000
         LR    R4,R0                                               0903 03303000
*           IF PFTUIC<OUXBSTC|PFTUIC='FF'X THEN/* TEST IF PFTE IS NOT   03304000
*                                      TO BE STOLEN. IF NOT, SET BIT    03305000
*                                      MASK IN ORDER TO SWAP IN THE     03306000
*                                      PAGE. YM06031                 */ 03307000
         L     @06,ASCBPTR                                         0904 03308000
         L     @06,OUXBPTR(,@06)                                   0904 03309000
         SLR   @05,@05                                             0904 03310000
         IC    @05,PFTUIC(,PFTEPTR)                                0904 03311000
         CH    @05,OUXBSTC(,@06)                                   0904 03312000
         BL    @RT00904                                            0904 03313000
         CLI   PFTUIC(PFTEPTR),255                                 0904 03314000
         BNE   @RF00904                                            0904 03315000
@RT00904 DS    0H                                                  0905 03316000
*             DO;                                                  0905 03317000
*               R1=PFTVBN;          /* SET UP VBN TO SET BIT MASK.   */ 03318000
         LH    R1,PFTVBN(,PFTEPTR)                                 0906 03319000
         N     R1,@CF02704                                         0906 03320000
*               CALL SETMASK;       /* CALL SUBROUTINE TO SET THE BIT   03321000
*                                      MASK FOR THE WORKING SET PAGE.*/ 03322000
         BAL   @14,SETMASK                                         0907 03323000
*             END;                                                 0908 03324000
*INVALPGT:                                                         0909 03325000
*           R4->PGTPVM='1'B;        /* INVALIDATE PAGE.ITHE PTLB IS     03326000
*                                      DONE BY SWPC.         @Z40WPYC*/ 03327000
@RF00904 DS    0H                                                  0909 03328000
INVALPGT OI    PGTPVM(R4),B'00001000'                              0909 03329000
*         END;                                                     0910 03330000
*                                                                  0911 03331000
*       /*************************************************************/ 03332000
*       /*                                                           */ 03333000
*       /* NO PCB DEFINED AND FIX COUNT IS NOT ZERO. MUST HAVE BEEN  */ 03334000
*       /* AN IN CORE PAGE WITH ONLY 0-TCB FIXES. GET A PCB, CREATE A*/ 03335000
*       /* SPCT FIX ENTRY AND IF BOTH SUCCEED INITIALIZE THE PCB TO  */ 03336000
*       /* PAGE OUT THE FRAME                                        */ 03337000
*       /*                                                           */ 03338000
*       /*************************************************************/ 03339000
*                                                                  0911 03340000
*       ELSE                                                       0911 03341000
*         DO;                                                      0911 03342000
*                                                                  0911 03343000
         B     @RC00853                                            0911 03344000
@RF00853 DS    0H                                                  0912 03345000
*           /*********************************************************/ 03346000
*           /*                                                       */ 03347000
*           /* SINCE THE ADDITION OF STORAGE ERROR PROCESSING IN     */ 03348000
*           /* ROUTINE STAGE1, TCB MODE FIXES FOR BAD FRAMES(PFTBADPG*/ 03349000
*           /* = 1) WILL GET HERE WITH A NONZERO PFTE FIX COUNT - IN */ 03350000
*           /* ANY EVENT THE CODE IN ROUTINE INITPCB DEPENDS UPON    */ 03351000
*           /* THIS CALL TO IT FROM WORKSET BEING AHEAD OF THE       */ 03352000
*           /* CREATION OF A SPCT FIX ENTRY AND THE DECREMENTING OF  */ 03353000
*           /* THE PFTE FIX COUNT SINCE THE FRAME WILL BE SKIPPED    */ 03354000
*           /* WHEN PFTBADPG IS ON.                          @ZA19960*/ 03355000
*           /*                                                       */ 03356000
*           /*********************************************************/ 03357000
*                                                                  0912 03358000
*           CALL INITPCB;           /* CALL SUBROUTINE TO INITIALIZE    03359000
*                                      A SWAP OUT PCB FOR THE IN CORE   03360000
*                                      FIX.                          */ 03361000
         BAL   @14,INITPCB                                         0912 03362000
*           IF RETNCODE^=0 THEN     /* CHECK RETURN CODE             */ 03363000
         SLR   @06,@06                                             0913 03364000
         C     @06,RETNCODE(,PVTPTR)                               0913 03365000
         BE    @RF00913                                            0913 03366000
*             DO;                                                  0914 03367000
*               RETNCODE=0;         /* CLEAR RETURN CODE RAN OUT OF     03368000
*                                      PCBS                          */ 03369000
         ST    @06,RETNCODE(,PVTPTR)                               0915 03370000
*               GO TO TESTRBN;      /* GO DO NEXT FRAME              */ 03371000
         B     TESTRBN                                             0916 03372000
*             END;                                                 0917 03373000
*           R4=R1;                  /* SAVE XPTE ADDR        @Z40WPYC*/ 03374000
@RF00913 LR    R4,R1                                               0918 03375000
*           R1=PFTVBN;              /* GET VBN FOR GETFIX            */ 03376000
         LH    R1,PFTVBN(,PFTEPTR)                                 0919 03377000
         N     R1,@CF02704                                         0919 03378000
*           CALL GETFIX;            /* GET FIX ENTRY                 */ 03379000
*                                                                  0920 03380000
         BAL   @14,GETFIX                                          0920 03381000
*           /*********************************************************/ 03382000
*           /*                                                       */ 03383000
*           /* IF WE COULD NOT MAKE ENTRY IN SPCT FOR THIS ZERO TCB  */ 03384000
*           /* FIXED FRAME, RESET THE WORK DONE BY INITPCB. NOTE THAT*/ 03385000
*           /* IT IS NOT NECESSARY TO ZERO PCBPGTA AND PCBXPTA SINCE */ 03386000
*           /* THESE FIELDS ARE ALWAYS INIT IN PRIVATE AREA PCB'S    */ 03387000
*           /* (LSQA PCB'S HAVE ALREADY BEEN CONSTRUCTED).           */ 03388000
*           /*                                                       */ 03389000
*           /*********************************************************/ 03390000
*                                                                  0921 03391000
*           IF RETNCODE^=0 THEN                                    0921 03392000
         SLR   @06,@06                                             0921 03393000
         C     @06,RETNCODE(,PVTPTR)                               0921 03394000
         BE    @RF00921                                            0921 03395000
*             DO;                                                  0922 03396000
*               PFTPCBSI='0'B;      /* PCB JUST BUILT WILL NOT BE  0923 03397000
*                                      USED FIXED FRAME REMAINS IN 0923 03398000
*                                      STORAGE                       */ 03399000
         NI    PFTPCBSI(PFTEPTR),B'11110111'                       0923 03400000
*               ROOTCNT=ROOTCNT-1;  /* DECREMENT ROOT COUNT          */ 03401000
         LH    @05,ROOTCNT(,PVTPTR)                                0924 03402000
         BCTR  @05,0                                               0924 03403000
         STH   @05,ROOTCNT(,PVTPTR)                                0924 03404000
*               NEXTPCB=PCBPTR;     /* BACK UP POINTER BY 1 PCB      */ 03405000
         ST    PCBPTR,NEXTPCB(,PVTPTR)                             0925 03406000
*               RETNCODE=0;         /* CLEAR RETURN CODE             */ 03407000
         ST    @06,RETNCODE(,PVTPTR)                               0926 03408000
*             END;                                                 0927 03409000
*           ELSE                    /* MADE ENTRY CORRECTLY          */ 03410000
*             DO;                                                  0928 03411000
         B     @RC00921                                            0928 03412000
@RF00921 DS    0H                                                  0929 03413000
*               PCBSPCTE=SWAPPTR;   /* INIT PTR TO SPCTE FOR ASM   0929 03414000
*                                                            @Z40WPYC*/ 03415000
         ST    SWAPPTR,PCBSPCTE(,PCBPTR)                           0929 03416000
*               AIASWPFX='1'B;      /* INDICATE PRIVATE AREA FIX SWAP   03417000
*                                      PAGE                  @Z40WPYC*/ 03418000
         OI    AIASWPFX(PCBPTR),B'00000010'                        0930 03419000
*               R4->XPTXAV='1'B;    /* INDICATE SAVE AUX STORAGE   0931 03420000
*                                                            @Z40WPYC*/ 03421000
         OI    XPTXAV(R4),B'01000000'                              0931 03422000
*               SPCTFIXC=PFTFXCT;   /* MAKE FIX ENTRY                */ 03423000
         LH    @06,PFTFXCT(,PFTEPTR)                               0932 03424000
         STH   @06,SPCTFIXC(,SWAPPTR)                              0932 03425000
*               RSMCNTFX=RSMCNTFX-1;/* DECREMENT FIX COUNT FOR THIS     03426000
*                                      ADDRESS SPACE         @YA01572*/ 03427000
         LH    @06,RSMCNTFX(,RSMHDPTR)                             0933 03428000
         BCTR  @06,0                                               0933 03429000
         STH   @06,RSMCNTFX(,RSMHDPTR)                             0933 03430000
*               PVTCNTFX=PVTCNTFX-1;/* DECREMENT THE SYSTEM FIX    0934 03431000
*                                      COUNT@YA01572                 */ 03432000
         LH    @06,PVTCNTFX(,PVTPTR)                               0934 03433000
         BCTR  @06,0                                               0934 03434000
         STH   @06,PVTCNTFX(,PVTPTR)                               0934 03435000
*               PFTFXCT=0;          /* CLEAR FIX COUNT IN PFTE       */ 03436000
         SLR   @06,@06                                             0935 03437000
         STH   @06,PFTFXCT(,PFTEPTR)                               0935 03438000
*               IF PFTDFRLS='1'B THEN/* IS FRAME DEFERED RELEASE     */ 03439000
         TM    PFTDFRLS(PFTEPTR),B'10000000'                       0936 03440000
         BNO   @RF00936                                            0936 03441000
*                 SPCTDEFR='1'B;    /* SET DEFER RELEASE FLAG IN SPCT*/ 03442000
         OI    SPCTDEFR(SWAPPTR),B'00010000'                       0937 03443000
*             END;                                                 0938 03444000
@RF00936 DS    0H                                                  0939 03445000
*         END;                                                     0939 03446000
@RC00921 DS    0H                                                  0940 03447000
*       RESPECIFY                                                  0940 03448000
*        (R1,                                                      0940 03449000
*         R4,                                                      0940 03450000
*         SWAPPTR) UNRESTRICTED;                                   0940 03451000
@RC00853 DS    0H                                                  0941 03452000
*     END;                                                         0941 03453000
*TESTRBN:                                                          0942 03454000
*   IF PFTFQPTR^=0 THEN             /* TEST IF THERE ARE ANY MORE  0942 03455000
*                                      LOCAL FRAMES TO PROCESS.      */ 03456000
@RC00823 DS    0H                                                  0942 03457000
TESTRBN  LH    @12,PFTFQPTR(,PFTEPTR)                              0942 03458000
         N     @12,@CF02704                                        0942 03459000
         LTR   @12,@12                                             0942 03460000
         BNZ   @RT00942                                            0942 03461000
*     GOTO NEXTPFTE;                /* ARE MORE. GO DO THEM.         */ 03462000
*                                                                  0943 03463000
*   /*****************************************************************/ 03464000
*   /*                                                               */ 03465000
*   /* EXIT WORKING SET PROCESSOR                                    */ 03466000
*   /*                                                               */ 03467000
*   /*****************************************************************/ 03468000
*                                                                  0944 03469000
*EXITWS:                                                           0944 03470000
*   RESPECIFY                                                      0944 03471000
*    (R14) RESTRICTED;                                             0944 03472000
EXITWS   DS    0H                                                  0945 03473000
*   R14=LEV1RTN;                    /* GET THE RETURN ADDRESS.       */ 03474000
         L     R14,LEV1RTN(,PVTPTR)                                0945 03475000
*   RESPECIFY                                                      0946 03476000
*    (R14,                                                         0946 03477000
*     PFTEPTR) UNRESTRICTED;                                       0946 03478000
*   END WORKSET;                                                   0947 03479000
@EL00006 DS    0H                                                  0947 03480000
@EF00006 DS    0H                                                  0947 03481000
@ER00006 BR    @14                                                 0947 03482000
*                                                                  0948 03483000
*   /*****************************************************************/ 03484000
*   /*                                                               */ 03485000
*   /* THIS ROUTINE RECEIVES AS INPUT THE ADDRESS OF A PCB FOR THE   */ 03486000
*   /* ADDRESS SPACE BEING SWAPPED OUT.                              */ 03487000
*   /*                                                               */ 03488000
*   /*****************************************************************/ 03489000
*                                                                  0948 03490000
*PCBPROC:                                                          0948 03491000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0948 03492000
PCBPROC  DS    0H                                                  0949 03493000
*   RFY                                                            0949 03494000
*    (R4,                                                          0949 03495000
*     R5,                                                          0949 03496000
*     R6) RSTD;                                                    0949 03497000
*   RFY                                                            0950 03498000
*     PCBR BASED(PCBRTPA);                                         0950 03499000
*   RFY                                                            0951 03500000
*    (R14) RSTD;                                                   0951 03501000
*   LEV2RTN=R14;                    /* SAVE RETURN ADDRESS           */ 03502000
         ST    R14,LEV2RTN(,PVTPTR)                                0952 03503000
*   RFY                                                            0953 03504000
*    (R14) UNRSTD;                                                 0953 03505000
*   IF NOSPCTE='1'B THEN            /* IS ECB OUT OF STORAGE OR IS IT   03506000
*                                      FIRST REFERENCE CASE  @YM02790*/ 03507000
         TM    NOSPCTE(PVTPTR),B'00000100'                         0954 03508000
         BO    @RT00954                                            0954 03509000
*     GO TO REPAIRFX;               /* GO REMOVE FIX FROM SPCT     0955 03510000
*                                                            @YM02790*/ 03511000
*   KEEPPCB='0'B;                   /* SET FLAG TO INDICATE THE PCB     03512000
*                                      CAN BE FREED BY PIOPURGE. THE    03513000
*                                      FLAG WILL BE ONE IF PCB IS  0956 03514000
*                                      COMMON AREA FOR WHICH I/O IS     03515000
*                                      NOT COMPLETE AND FOR PRIVATE     03516000
*                                      AREA ZERO TCB FIX I/O NOT   0956 03517000
*                                      COMPLETE FOR WHICH GETFIX WAS    03518000
*                                      UNABLE TO MAKE A FIX ENTRY    */ 03519000
*                                                                  0956 03520000
         NI    KEEPPCB(PVTPTR),B'11101111'                         0956 03521000
*   /*****************************************************************/ 03522000
*   /*                                                               */ 03523000
*   /* IS PCB FOR A PAGE FAULT. THERE SHOULD BE NO SRBMD PCBS LEFT ON*/ 03524000
*   /* THE QUEUE AS A RESULT OF (A) THE STATUS STOP OF QUIESSABLE    */ 03525000
*   /* SRBS DONE BY REGION CONTROL TASK PRIOR TO CALLING SWAP OUT AND*/ 03526000
*   /* (B) THE STATUS STOP OF NON QUIESSABLE SRBS DONE BY SWAP OUT.  */ 03527000
*   /* ALSO THERE SHOULD BE NO LOCKED TCBS AS A RESULT OF THE STATUS */ 03528000
*   /* STOP TCB DONE BY REGION CONTROL TASK PRIOR TO CALLING SWAP    */ 03529000
*   /* OUT.                                                          */ 03530000
*   /*                                                               */ 03531000
*   /*****************************************************************/ 03532000
*                                                                  0957 03533000
*   IF PCBRESET='1'B THEN                                          0957 03534000
         TM    PCBRESET(PCBPTR),B'00010000'                        0957 03535000
         BNO   @RF00957                                            0957 03536000
*     DO;                                                          0958 03537000
*       IF PCBSRBMD='1'B THEN       /* IF PCB IS FOR SRB THEN PREPARE   03538000
*                                      R4 AND R5 TO SHOW SRB. IF PCB    03539000
*                                      IS FOR RB THEN PREPARE R4 AND    03540000
*                                      R5 TO SHOW RB                 */ 03541000
         TM    PCBSRBMD(PCBPTR),B'00100000'                        0959 03542000
         BNO   @RF00959                                            0959 03543000
*         DO;                                                      0960 03544000
*           R4=PCBSRB;              /* ADDRESS OF SRB FOR RESET      */ 03545000
         L     R4,PCBSRB(,PCBPTR)                                  0961 03546000
*           R5=0;                   /* ZERO INDICATES SRB            */ 03547000
         SLR   R5,R5                                               0962 03548000
*         END;                                                     0963 03549000
*       ELSE                        /* NOT SRB MODE                  */ 03550000
*         DO;                                                      0964 03551000
         B     @RC00959                                            0964 03552000
@RF00959 DS    0H                                                  0965 03553000
*           R4=PCBRTPA;             /* R4 GETS TCB ADDR FOR NON-SRB     03554000
*                                      PCBS                          */ 03555000
         L     R4,PCBRTPA-1(,PCBPTR)                               0965 03556000
         LA    R4,0(,R4)                                           0965 03557000
*           R5=PCBRB;               /* R5 GETS RB ADDRESS PCBSRB   0966 03558000
*                                      CONTAINS THE RB ADDRESS IF  0966 03559000
*                                      RESET IS ON AND SRBMD IS OFF     03560000
*                                                            @Z40WPYC*/ 03561000
         L     R5,PCBRB(,PCBPTR)                                   0966 03562000
*         END;                                                     0967 03563000
*       IF PCBIOERR='0'B THEN       /* WAS THERE AN I/O ERROR        */ 03564000
@RC00959 TM    PCBIOERR(PCBPTR),B'00100000'                        0968 03565000
         BNZ   @RF00968                                            0968 03566000
*         R6=0;                     /* SIGNAL SUCCESSFUL COMPLETION     03567000
*                                      EVEN THOUGH PAGE IN MAY NOT 0969 03568000
*                                      HAVE COMPLETED                */ 03569000
         SLR   R6,R6                                               0969 03570000
*       ELSE                        /* I/O ERROR OCCURED             */ 03571000
*         DO;                                                      0970 03572000
         B     @RC00968                                            0970 03573000
@RF00968 DS    0H                                                  0971 03574000
*           R6=4;                   /* SIGNAL ERROR COMPLETION       */ 03575000
         LA    R6,4                                                0971 03576000
*           MASKFLG='0'B;           /* PAGE SUFFERED I/O ERROR ON  0972 03577000
*                                      PAGE IN, DO NOT BRING IN AS 0972 03578000
*                                      STAGE 2 PAGE                  */ 03579000
         NI    MASKFLG(PVTPTR),B'11011111'                         0972 03580000
*         END;                                                     0973 03581000
*       R13=ADDR(PVTSAVE);          /* SAVE AREA ADDRESS             */ 03582000
@RC00968 LA    R13,PVTSAVE(,PVTPTR)                                0974 03583000
*       CALL IEAVRSET;              /* RESET PAGE FAULTER            */ 03584000
         L     @15,PVTPRSET(,PVTPTR)                               0975 03585000
         BALR  @14,@15                                             0975 03586000
*       PCBRESET='0'B;              /* TURN RESET FLAG OFF, THIS   0976 03587000
*                                      MAKES PCB LOOK LIKE A LOAD IN    03588000
*                                      CASE I/O IS NOT YET COMPLETE. */ 03589000
         NI    PCBRESET(PCBPTR),B'11101111'                        0976 03590000
*       SPCTPURG='1'B;              /* SOME PAGING WAS PURGED        */ 03591000
         OI    SPCTPURG(SPCTPTR),B'00100000'                       0977 03592000
*       RFY                                                        0978 03593000
*        (R6) UNRSTD;                                              0978 03594000
*       GO TO GOBACK;               /* EXIT FROM SUBROUTINE  @YM07609*/ 03595000
         B     GOBACK                                              0979 03596000
*     END;                                                         0980 03597000
*                                                                  0981 03598000
*   /*****************************************************************/ 03599000
*   /*                                                               */ 03600000
*   /* DOES THE PCB HAVE A ROOT                                      */ 03601000
*   /*                                                               */ 03602000
*   /*****************************************************************/ 03603000
*                                                                  0981 03604000
*   IF PCBROOT='1'B THEN                                           0981 03605000
@RF00957 TM    PCBROOT(PCBPTR),B'00000100'                         0981 03606000
         BNO   @RF00981                                            0981 03607000
*     DO;                                                          0982 03608000
*       IF PCBIOERR='1'B THEN       /* DID THE I/O FAIL              */ 03609000
         TM    PCBIOERR(PCBPTR),B'00100000'                        0983 03610000
         BNO   @RF00983                                            0983 03611000
*         PCBRFAIL='1'B;            /* SET ROOT FAIL BIT IN THE    0984 03612000
*                                      FIX/LOAD ROOT IF I/O IS     0984 03613000
*                                      COMPLETE AND FAILED           */ 03614000
*                                                                  0984 03615000
         L     @01,PCBRTPA-1(,PCBPTR)                              0984 03616000
         OI    PCBRFAIL(@01),B'00001000'                           0984 03617000
*       /*************************************************************/ 03618000
*       /*                                                           */ 03619000
*       /* IS THERE A FIX COUNT                                      */ 03620000
*       /*                                                           */ 03621000
*       /*************************************************************/ 03622000
*                                                                  0985 03623000
*       IF PCBFXC^=0 THEN                                          0985 03624000
@RF00983 CLI   PCBFXC(PCBPTR),0                                    0985 03625000
         BE    @RF00985                                            0985 03626000
*         DO;                                                      0986 03627000
*           MASKFLG='0'B;           /* A BIT MASK ENTRY IS NOT TO BE    03628000
*                                      MADE AS A FIX ENTRY WAS OR  0987 03629000
*                                      WILL BE MADE                  */ 03630000
*                                                                  0987 03631000
         NI    MASKFLG(PVTPTR),B'11011111'                         0987 03632000
*           /*********************************************************/ 03633000
*           /*                                                       */ 03634000
*           /* WAS THERE AN I/O ERROR                                */ 03635000
*           /*                                                       */ 03636000
*           /*********************************************************/ 03637000
*                                                                  0988 03638000
*           IF PCBIOERR='1'B THEN                                  0988 03639000
*                                                                  0988 03640000
         TM    PCBIOERR(PCBPTR),B'00100000'                        0988 03641000
         BNO   @RF00988                                            0988 03642000
*             /*******************************************************/ 03643000
*             /*                                                     */ 03644000
*             /* IS IT A ZERO TCB ADDRESS FIX                        */ 03645000
*             /*                                                     */ 03646000
*             /*******************************************************/ 03647000
*                                                                  0989 03648000
*             IF PCBRTCBA^=0 THEN                                  0989 03649000
         L     @01,PCBRTPA-1(,PCBPTR)                              0989 03650000
         L     @12,PCBRTCBA-1(,@01)                                0989 03651000
         LA    @12,0(,@12)                                         0989 03652000
         LTR   @12,@12                                             0989 03653000
         BNZ   @RT00989                                            0989 03654000
*               GO TO REPAIRFX;     /* REMOVE THE FIX COUNT FOR THIS    03655000
*                                      PCB FROM THE SPCT FIX ENTRY.     03656000
*                                      RETURN IS TO DOROOT BELOW     */ 03657000
*             ELSE                                                 0991 03658000
*               ;                                                  0991 03659000
*           ELSE                                                   0992 03660000
*             DO;                   /* NO I/O ERROR, BUT NON ZERO FIX   03661000
*                                      COUNT                         */ 03662000
*                                                                  0992 03663000
         B     @RC00988                                            0992 03664000
@RF00988 DS    0H                                                  0993 03665000
*               /*****************************************************/ 03666000
*               /*                                                   */ 03667000
*               /* THE PCB HAS A NON ZERO FIX COUNT AND DID NOT      */ 03668000
*               /* SUFFER AN I/O ERROR. IF IT IS A COMMON AREA ZERO  */ 03669000
*               /* TCB FIX FOR WHICH I/O HAS NOT YET COMPLETED, IT IS*/ 03670000
*               /* TO REMAIN ON THE QUEUE.                           */ 03671000
*               /*                                                   */ 03672000
*               /*****************************************************/ 03673000
*                                                                  0993 03674000
*               IF DOINGCOM='1'B|PCBVBN>=PVTLCSA THEN              0993 03675000
         TM    DOINGCOM(PVTPTR),B'01000000'                        0993 03676000
         BO    @RT00993                                            0993 03677000
         CLC   PCBVBN(2,PCBPTR),PVTLCSA(PVTPTR)                    0993 03678000
         BL    @RF00993                                            0993 03679000
@RT00993 DS    0H                                                  0994 03680000
*                 DO;               /* IT IS COMMON AREA             */ 03681000
*                   IF PCBRTCBA=0 THEN/* IT IS ZERO TCB FIX          */ 03682000
         L     @01,PCBRTPA-1(,PCBPTR)                              0995 03683000
         L     @12,PCBRTCBA-1(,@01)                                0995 03684000
         LA    @12,0(,@12)                                         0995 03685000
         LTR   @12,@12                                             0995 03686000
         BNZ   @RF00995                                            0995 03687000
*                     DO;                                          0996 03688000
*                       IF PCBIOCMP='0'B THEN/* I/O NOT YET COMPLETE */ 03689000
         TM    PCBIOCMP(PCBPTR),B'00000001'                        0997 03690000
         BNZ   @RF00997                                            0997 03691000
*                         DO;                                      0998 03692000
*                           RFY                                    0999 03693000
*                            (R14) RSTD;                           0999 03694000
*                           KEEPPCB='1'B;/* SET TO KEEP PCB          */ 03695000
         OI    KEEPPCB(PVTPTR),B'00010000'                         1000 03696000
*                           R14=LEV2RTN;                           1001 03697000
         L     R14,LEV2RTN(,PVTPTR)                                1001 03698000
*                           RFY                                    1002 03699000
*                            (R14) UNRSTD;                         1002 03700000
*                           RETURN; /* RETURN                        */ 03701000
@EL00007 DS    0H                                                  1003 03702000
@EF00007 DS    0H                                                  1003 03703000
@ER00007 BR    @14                                                 1003 03704000
*                         END;                                     1004 03705000
*                       ELSE                                       1005 03706000
*                         ;         /* I/O WAS COMPLETE              */ 03707000
@RF00997 DS    0H                                                  1006 03708000
*                     END;                                         1006 03709000
*                   ELSE            /* NOT ZERO TCB FIX              */ 03710000
*                     GO TO DOFIXCT;/* PCB IS COMMON AREA, NON ZERO     03711000
*                                      TCB FIX                       */ 03712000
*                 END;                                             1008 03713000
*               ELSE                /* PCB IS NOT COMMON AREA        */ 03714000
*                 DO;                                              1009 03715000
*                                                                  1009 03716000
         B     @RC00993                                            1009 03717000
@RF00993 DS    0H                                                  1010 03718000
*                   /*************************************************/ 03719000
*                   /*                                               */ 03720000
*                   /* PCB IS FOR PRIVATE AREA. IF FIX IS ZERO TCB   */ 03721000
*                   /* FIX, A FIX ENTRY FOR THIS VBN MUST BE MADE OR */ 03722000
*                   /* UPDATED. IF THE VBN IS ZERO, THE PCB CANNOT BE*/ 03723000
*                   /* PROCESSED. THE PCBVBN WILL BE ZERO BETWEEN    */ 03724000
*                   /* RUNS OF IEAVIOCP.                     @YM07609*/ 03725000
*                   /*                                               */ 03726000
*                   /*************************************************/ 03727000
*                                                                  1010 03728000
*                   IF PCBRTCBA=0&PCBVBN^=0 THEN                   1010 03729000
         L     @01,PCBRTPA-1(,PCBPTR)                              1010 03730000
         L     @12,PCBRTCBA-1(,@01)                                1010 03731000
         LA    @12,0(,@12)                                         1010 03732000
         LTR   @12,@12                                             1010 03733000
         BNZ   @RF01010                                            1010 03734000
         LH    @12,PCBVBN(,PCBPTR)                                 1010 03735000
         N     @12,@CF02704                                        1010 03736000
         LTR   @12,@12                                             1010 03737000
         BZ    @RF01010                                            1010 03738000
*                     DO;                                          1011 03739000
*                       RFY                                        1012 03740000
*                        (SWAPPTR,                                 1012 03741000
*                         R1) RSTD;                                1012 03742000
*                       R1=PCBVBN;  /* VBN FOR SUBROUTINE            */ 03743000
         LH    @06,PCBVBN(,PCBPTR)                                 1013 03744000
         N     @06,@CF02704                                        1013 03745000
         LR    R1,@06                                              1013 03746000
*                       CALL GETFIX;/* CREATE A NEW ENTRY OR LOCATE     03747000
*                                      THE EXISTING ENTRY            */ 03748000
         BAL   @14,GETFIX                                          1014 03749000
*                       RFY                                        1015 03750000
*                        (R1) UNRSTD;                              1015 03751000
*                                                                  1015 03752000
*                       /*********************************************/ 03753000
*                       /*                                           */ 03754000
*                       /* IF THE GETFIX FAILS THE RETNCODE FIELD    */ 03755000
*                       /* WILL NOT BE ZERO                          */ 03756000
*                       /*                                           */ 03757000
*                       /*********************************************/ 03758000
*                                                                  1016 03759000
*                       IF RETNCODE=0 THEN                         1016 03760000
         L     @06,RETNCODE(,PVTPTR)                               1016 03761000
         LTR   @06,@06                                             1016 03762000
         BNZ   @RF01016                                            1016 03763000
*                         SPCTFIXC=SPCTFIXC+PCBFXC;/* UPDATE FIX   1017 03764000
*                                      ENTRY                         */ 03765000
         SLR   @06,@06                                             1017 03766000
         IC    @06,PCBFXC(,PCBPTR)                                 1017 03767000
         AH    @06,SPCTFIXC(,SWAPPTR)                              1017 03768000
         STH   @06,SPCTFIXC(,SWAPPTR)                              1017 03769000
*                       ELSE                                       1018 03770000
*                         DO;       /* CANNOT PUT THIS FIX IN THE  1018 03771000
*                                      SPCT. IF I/O IS COMPLETE,   1018 03772000
*                                      VALIDATE THE PAGE AND LEAVE IT   03773000
*                                      IN CORE WHILE THE MEMORY IS 1018 03774000
*                                      SWAPPED OUT. IF I/O IS NOT  1018 03775000
*                                      COMPLETE, LEAVE THE PCB TO BE    03776000
*                                      PROCESSED BY IEAVPIOP WHEN THE   03777000
*                                      I/O IS DONE           @YM07609*/ 03778000
         B     @RC01016                                            1018 03779000
@RF01016 DS    0H                                                  1019 03780000
*                           RETNCODE=0;/* CLEAR RETURN CODE          */ 03781000
         SLR   @06,@06                                             1019 03782000
         ST    @06,RETNCODE(,PVTPTR)                               1019 03783000
*                           IF PCBIOCMP='0'B THEN/* WAS I/O COMPLETE */ 03784000
         TM    PCBIOCMP(PCBPTR),B'00000001'                        1020 03785000
         BNZ   @RF01020                                            1020 03786000
*                             DO;   /* I/O NOT COMPLETE. LEAVE THE 1021 03787000
*                                      PCB TO BE PROCESSED BY PIOP 1021 03788000
*                                      AND IOCP WHEN IT IS DONE    1021 03789000
*                                                            @YM07609*/ 03790000
*                               KEEPPCB='1'B;/* SET TO KEEP PCB      */ 03791000
         OI    KEEPPCB(PVTPTR),B'00010000'                         1022 03792000
*                               GO TO GOBACK;/* DO NOT DECREMENT PFTE   03793000
*                                      FIX CT                        */ 03794000
         B     GOBACK                                              1023 03795000
*                             END;  /* END I/O NOT COMPLETE SECTION     03796000
*                                                            @YM07609*/ 03797000
*                           ELSE    /* I/O IS COMPLETE. VALIDATE THE    03798000
*                                      PAGE AND LEAVE IT ON THE LFQ     03799000
*                                      WHILE THE MEMORY IS SWAPPED 1025 03800000
*                                      OUT. IT WILL AUTOMATICALLY BE    03801000
*                                      RECLAIMED AT SWAP IN TIME. THE   03802000
*                                      PCB WILL BE FREED IN PIOPURGE.   03803000
*                                                            @YM07609*/ 03804000
*                             DO;   /* VALIDATE THE PAGE.    @YM07609*/ 03805000
@RF01020 DS    0H                                                  1026 03806000
*                               R5=PCBVBN*256;/* GET VBN AS A ADDRESS   03807000
*                                                            @YM07609*/ 03808000
         LH    R5,PCBVBN(,PCBPTR)                                  1026 03809000
         N     R5,@CF02704                                         1026 03810000
         SLA   R5,8                                                1026 03811000
*                               GEN CODE(LRA R4,0(R5))             1027 03812000
*                               REFS(R4,R5) SETS(R4);              1027 03813000
         LRA R4,0(R5)                                                   03814000
*                               BC(8,DOROOT);/* IF THE PAGE IS VALID,   03815000
*                                      DO NOT VALIDATE IT AGAIN    1028 03816000
*                                                            @YM07609*/ 03817000
         BC    8,DOROOT                                            1028 03818000
*                               R4=PCBXPTA->XPTPROT;/* GET STORAGE 1029 03819000
*                                      KEY                   @YM07609*/ 03820000
         L     @01,PCBXPTA-1(,PCBPTR)                              1029 03821000
         SLR   R4,R4                                               1029 03822000
         IC    R4,XPTPROT(,@01)                                    1029 03823000
*                               R5=PCBRBN*256;/* GET REAL STORAGE  1030 03824000
*                                      ADDRESS               @YM07609*/ 03825000
         LH    R5,PCBRBN(,PCBPTR)                                  1030 03826000
         N     R5,@CF02704                                         1030 03827000
         SLA   R5,8                                                1030 03828000
*                               GEN REFS(R4,R5) SETS(R5);          1031 03829000
           SSK   R4,R5                  SET KEY                         03830000
           LA    R5,2048(R5)            SET TO NEXT 2K                  03831000
           SSK   R4,R5                  SET KEY AGAIN                   03832000
*                               PCBPGTA->PGTPVM='0'B;/* VALIDATE PAGE   03833000
*                                                            @YM07609*/ 03834000
         L     @01,PCBPGTA-1(,PCBPTR)                              1032 03835000
         NI    PGTPVM(@01),B'11110111'                             1032 03836000
*                               PCBVBN=0;/* ZERO THE VBN SO A BITMASK   03837000
*                                      ENTRY IS NOT MADE IN PIOPURGE.   03838000
*                                                            @YM07609*/ 03839000
         SLR   @06,@06                                             1033 03840000
         STH   @06,PCBVBN(,PCBPTR)                                 1033 03841000
*                               PCBFXC=0;/* ZERO THE FIX COUNT     1034 03842000
*                                                            @YM07609*/ 03843000
         MVI   PCBFXC(PCBPTR),X'00'                                1034 03844000
*                               GOTO DOROOT;/* GO PROCESS THE ROOT 1035 03845000
*                                      PCB.                  @YM07609*/ 03846000
         B     DOROOT                                              1035 03847000
*                             END;  /* END VALIDATION OF I/O COMPLETE   03848000
*                                      FIX WHICH COULD NOT BE PUT IN    03849000
*                                      THE SPCT.             @YM07609*/ 03850000
*                         END;      /* END BAD RTN CODE FROM GETFIX  */ 03851000
*                     END;          /* END OF PRIVATE AREA ZERO TCB     03852000
*                                      LOOP                          */ 03853000
*                                                                  1038 03854000
@RC01016 DS    0H                                                  1039 03855000
*                   /*************************************************/ 03856000
*                   /*                                               */ 03857000
*                   /* FIX IS FOR PRIVATE AREA, IF I/O WAS STARTED   */ 03858000
*                   /* BUT HAS NOT COMPLETED, SUBTRACT PCB FIX COUNT */ 03859000
*                   /* FROM PFTE FIX COUNT. PCB WILL BE TURNED INTO A*/ 03860000
*                   /* LOAD AND I/O WILL BE ALLOWED TO COMPLETE COULD*/ 03861000
*                   /* ALSO BE A COMMON AREA FIX BETWEEN IEAVPIP AND */ 03862000
*                   /* IEAVIOCP OR BETWEEN IEAVIOCP AND IEAVIOCP FOR */ 03863000
*                   /* WHICH THE FIX COUNTIS REMOVED FROM THE PFTE.  */ 03864000
*                   /*                                               */ 03865000
*                   /*************************************************/ 03866000
*                                                                  1039 03867000
*                   RFY                                            1039 03868000
*                    (SWAPPTR) UNRSTD;                             1039 03869000
@RF01010 DS    0H                                                  1040 03870000
*                   RFY                                            1040 03871000
*                    (R1) RSTD;                                    1040 03872000
*DOFIXCT:                                                          1041 03873000
*                   IF PCBIOCMP='0'B&DOINGGFA='0'B THEN/* IF I/O IS     03874000
*                                      NOT COMPLETE OR NO FRAME IS 1041 03875000
*                                      ASSIGNED DO NOT PROCESS FIX 1041 03876000
*                                      COUNT                         */ 03877000
DOFIXCT  TM    PCBIOCMP(PCBPTR),B'00000001'                        1041 03878000
         BNZ   @RF01041                                            1041 03879000
         TM    DOINGGFA(PVTPTR),B'10000000'                        1041 03880000
         BNZ   @RF01041                                            1041 03881000
*                     DO;                                          1042 03882000
*                       R1=PVTPFTP+PCBRBN;/* GET PFTE ADDRESS        */ 03883000
         LH    R1,PCBRBN(,PCBPTR)                                  1043 03884000
         N     R1,@CF02704                                         1043 03885000
         AL    R1,PVTPFTP(,PVTPTR)                                 1043 03886000
*                       R1->PFTFXCT=R1->PFTFXCT-PCBFXC;/* SUBTRACT 1044 03887000
*                                      PCB FIX COUNT FROM PFTE       */ 03888000
         LH    @12,PFTFXCT(,R1)                                    1044 03889000
         SLR   @06,@06                                             1044 03890000
         IC    @06,PCBFXC(,PCBPTR)                                 1044 03891000
         SLR   @12,@06                                             1044 03892000
         STH   @12,PFTFXCT(,R1)                                    1044 03893000
*                       PCBFXC=0;   /* PCB NOW LOOKS LIKE A LOAD     */ 03894000
         MVI   PCBFXC(PCBPTR),X'00'                                1045 03895000
*                       IF R1->PFTFXCT=0 THEN/* ARE THERE STILL FIX     03896000
*                                      REQUESTS FOR THIS FRAME       */ 03897000
         LTR   @12,@12                                             1046 03898000
         BNZ   @RF01046                                            1046 03899000
*                         DO;       /* NO, THERE ARE NO FIX REQUESTS    03900000
*                                                            @YA01572*/ 03901000
*                           IF PCBVBN>=PVTLCSA/* IS THIS FRAME IN  1048 03902000
*                                      COMMON AREA                   */ 03903000
*                             THEN                                 1048 03904000
         CLC   PCBVBN(2,PCBPTR),PVTLCSA(PVTPTR)                    1048 03905000
         BL    @RF01048                                            1048 03906000
*                             PVTCOMFX=PVTCOMFX-1;/* YES, DECREMENT     03907000
*                                      COMMON FIX COUNT      @YA01572*/ 03908000
         LH    @12,PVTCOMFX(,PVTPTR)                               1049 03909000
         BCTR  @12,0                                               1049 03910000
         STH   @12,PVTCOMFX(,PVTPTR)                               1049 03911000
*                           ELSE    /*                       @ZA18822*/ 03912000
*                                                                  1050 03913000
*                             /***************************************/ 03914000
*                             /*                                     */ 03915000
*                             /* SINCE THIS PAGE WILL NOT BE PAGED   */ 03916000
*                             /* OUT AS PART OF THE SWAP, THE SLOT ID*/ 03917000
*                             /* OF THE PAGE MUST BE PUT INTO THE    */ 03918000
*                             /* SPCT FIX ENTRY SO THAT ON THE SWAP  */ 03919000
*                             /* IN, A ZERO LSID WILL NOT BE PASSED  */ 03920000
*                             /* TO ASM. THIS NEED ONLY BE DONE FOR  */ 03921000
*                             /* PRIVATE AREA PAGES SINCE COMMON AREA*/ 03922000
*                             /* PAGES ARE NEVER SWAPPED OUT, AND THE*/ 03923000
*                             /* LSID IS GOTTEN FROM THE XPTE ON THE */ 03924000
*                             /* SWAP-IN.                    @ZA18822*/ 03925000
*                             /*                                     */ 03926000
*                             /***************************************/ 03927000
*                                                                  1050 03928000
*                             DO;   /*                       @ZA18822*/ 03929000
         B     @RC01048                                            1050 03930000
@RF01048 DS    0H                                                  1051 03931000
*                               RSMCNTFX=RSMCNTFX-1;/* DECREMENT   1051 03932000
*                                      ADDRESS SPACE FIX COUNT     1051 03933000
*                                                            @YA01572*/ 03934000
         LH    @12,RSMCNTFX(,RSMHDPTR)                             1051 03935000
         BCTR  @12,0                                               1051 03936000
         STH   @12,RSMCNTFX(,RSMHDPTR)                             1051 03937000
*                               RFY                                1052 03938000
*                                (SWAPPTR) RSTD;/*           @ZA18822*/ 03939000
*                               R1=PCBVBN;/* VBN FOR GETFIX INTF   1053 03940000
*                                                            @ZA18822*/ 03941000
         LH    R1,PCBVBN(,PCBPTR)                                  1053 03942000
         N     R1,@CF02704                                         1053 03943000
*                               CALL GETFIX;/* FIND SPCT FIX ENTRY 1054 03944000
*                                                            @ZA18822*/ 03945000
         BAL   @14,GETFIX                                          1054 03946000
*                               IF RETNCODE=0 THEN/*         @ZA18822*/ 03947000
         L     @06,RETNCODE(,PVTPTR)                               1055 03948000
         LTR   @06,@06                                             1055 03949000
         BNZ   @RF01055                                            1055 03950000
*                                 DO;/* ENTRY FOUND          @ZA18822*/ 03951000
*                                   SPCTSSID=AIALSID;/* LSID TO SPCT    03952000
*                                                            @ZA18822*/ 03953000
         MVC   SPCTSSID(3,SWAPPTR),AIALSID+1(PCBPTR)               1057 03954000
*                                   SPCTLVAL='1'B;/* LSID VALID    1058 03955000
*                                                            @ZA18822*/ 03956000
         OI    SPCTLVAL(SWAPPTR),B'10000000'                       1058 03957000
*                                 END;/*                     @ZA18822*/ 03958000
*                               RFY                                1060 03959000
*                                (SWAPPTR) UNRSTD;/*         @ZA18822*/ 03960000
@RF01055 DS    0H                                                  1061 03961000
*                             END;  /*                       @ZA18822*/ 03962000
*                           PVTCNTFX=PVTCNTFX-1;/* DECREMENT SYSTEM     03963000
*                                      FIX COUNT             @YA01572*/ 03964000
@RC01048 LH    @12,PVTCNTFX(,PVTPTR)                               1062 03965000
         BCTR  @12,0                                               1062 03966000
         STH   @12,PVTCNTFX(,PVTPTR)                               1062 03967000
*                         END;                                     1063 03968000
*                                                                  1063 03969000
*/*  PFTFXCT WILL BE INCREMENTED DURING SWAPIN FROM VALUE STORED   1064 03970000
*    IN SPCTE                                                        */ 03971000
*                                                                  1064 03972000
*                     END;                                         1064 03973000
@RF01046 DS    0H                                                  1065 03974000
*                 END;              /* END OF ELSE CLAUSE WHICH IS 1065 03975000
*                                      EXECUTED FOR PRIVATE AREA   1065 03976000
*                                      FIXES                         */ 03977000
@RF01041 DS    0H                                                  1066 03978000
*             END;                  /* END OF ELSE CLAUSE FOR NO I/O    03979000
*                                      ERROR AND NON ZERO FIX COUNT  */ 03980000
@RC00993 DS    0H                                                  1067 03981000
*         END;                      /* END OF NON ZERO FIX CT CLAUSE */ 03982000
@RC00988 DS    0H                                                  1068 03983000
*DOROOT:                                                           1068 03984000
*       PCBROOT='0'B;               /* MAKE PCB BE A LOAD WITHOUT ECB*/ 03985000
@RF00985 DS    0H                                                  1068 03986000
DOROOT   NI    PCBROOT(PCBPTR),B'11111011'                         1068 03987000
*       PCBRCNT=PCBRCNT-1;          /* DECREMENT ROOT COUNT          */ 03988000
         L     @12,PCBRTPA-1(,PCBPTR)                              1069 03989000
         LA    @12,0(,@12)                                         1069 03990000
         LH    @06,PCBRCNT(,@12)                                   1069 03991000
         BCTR  @06,0                                               1069 03992000
         STH   @06,PCBRCNT(,@12)                                   1069 03993000
*       IF PCBRCNT=0 THEN           /* DID ROOT CT GO TO ZERO        */ 03994000
         LTR   @06,@06                                             1070 03995000
         BNZ   @RF01070                                            1070 03996000
*         DO;                                                      1071 03997000
*           R1=PCBRTPA;             /* ROOT ADDRESS FOR ROOT EXIT RTN*/ 03998000
         LR    R1,@12                                              1072 03999000
*           CALL ROOTEXIT;          /* CALL ROOT EXIT ROUTINE        */ 04000000
         L     @15,PCBRGOTO(,@12)                                  1073 04001000
         BALR  @14,@15                                             1073 04002000
*           RCACSECT=RCACSPOT;      /* RESET CSECT ID                */ 04003000
         L     @12,RCAPTR(,PVTPTR)                                 1074 04004000
         MVI   RCACSECT(@12),X'1A'                                 1074 04005000
*           SPCTPURG='1'B;          /* INDICATE PAGING WAS PURGED    */ 04006000
         OI    SPCTPURG(SPCTPTR),B'00100000'                       1075 04007000
*         END;                                                     1076 04008000
*     END;                          /* END OF THERE IS A ROOT CLAUSE */ 04009000
@RF01070 DS    0H                                                  1078 04010000
*   RFY                                                            1078 04011000
*    (R1) UNRSTD;                                                  1078 04012000
@RF00981 DS    0H                                                  1079 04013000
*                                                                  1079 04014000
*   /*****************************************************************/ 04015000
*   /*                                                               */ 04016000
*   /* EXIT FROM PCB PROCESSOR                                       */ 04017000
*   /*                                                               */ 04018000
*   /*****************************************************************/ 04019000
*                                                                  1079 04020000
*GOBACK:                                                           1079 04021000
*   RFY                                                            1079 04022000
*    (R14) RSTD;                                                   1079 04023000
GOBACK   DS    0H                                                  1080 04024000
*   R14=LEV2RTN;                    /* GET RETURN ADDRESS            */ 04025000
         L     R14,LEV2RTN(,PVTPTR)                                1080 04026000
*   RFY                                                            1081 04027000
*    (R14) UNRSTD;                                                 1081 04028000
*   RETURN;                         /* RETURN TO PIOPURGE            */ 04029000
         B     @EL00007                                            1082 04030000
*                                                                  1083 04031000
*   /*****************************************************************/ 04032000
*   /*                                                               */ 04033000
*   /* AN I/O ERROR ON A NON ZERO TCB FIX OR AN ECB IS OUT OF STORAGE*/ 04034000
*   /* FOR A FIX ON A VBN WHOSE PCB IS ON THE GFA DEFER QUEUE HAS    */ 04035000
*   /* BEEN ENCOUNTERED. THE FIX COUNT MUST BE REMOVED FROM THE SPCT */ 04036000
*   /* FOR THE I/O ERROR THE FIX MUST ALSO BE REMOVED FROM THE FOE.  */ 04037000
*   /*                                                               */ 04038000
*   /*****************************************************************/ 04039000
*                                                                  1083 04040000
*   RFY                                                            1083 04041000
*    (R1) RSTD;                                                    1083 04042000
*REPAIRFX:                                                         1084 04043000
*   R1=PCBVBN;                      /* VBN FOR SUBROUTINE            */ 04044000
REPAIRFX LH    R1,PCBVBN(,PCBPTR)                                  1084 04045000
         N     R1,@CF02704                                         1084 04046000
*   CALL GETFIX;                    /* LOCATE FIX ENTRY IN SPCT      */ 04047000
         BAL   @14,GETFIX                                          1085 04048000
*   RFY                                                            1086 04049000
*    (R1) UNRSTD;                                                  1086 04050000
*                                                                  1086 04051000
*   /*****************************************************************/ 04052000
*   /*                                                               */ 04053000
*   /* IF THE ENTRY DID NOT EXIST AND CREATION OF A NEW ENTRY WAS    */ 04054000
*   /* ATTEMPTED, RECORD ERROR, AS THE ENTRY FOR A NON ZERO TCB FIX  */ 04055000
*   /* SHOULD HAVE EXISTED                                           */ 04056000
*   /*                                                               */ 04057000
*   /*****************************************************************/ 04058000
*                                                                  1087 04059000
*   RESPECIFY                                                      1087 04060000
*    (SWAPPTR) RESTRICTED;                                         1087 04061000
*   IF RETNCODE^=0 THEN             /* CHECK RETURN CODE             */ 04062000
         L     @06,RETNCODE(,PVTPTR)                               1088 04063000
         LTR   @06,@06                                             1088 04064000
         BZ    @RF01088                                            1088 04065000
*     DO;                                                          1089 04066000
*       R0='15'X;                   /* RECORD ERROR                  */ 04067000
         LA    R0,21                                               1090 04068000
*       CALL DOABEND;               /* RECORD THE ERROR.             */ 04069000
         BAL   @14,DOABEND                                         1091 04070000
*       RETNCODE=0;                 /* CLEAR RETURN CODE FOR FURTHER    04071000
*                                      PROCESSING                    */ 04072000
         SLR   @06,@06                                             1092 04073000
         ST    @06,RETNCODE(,PVTPTR)                               1092 04074000
*       GO TO DOFOE;                /* NO SPCT PROCESSING NEED BE  1093 04075000
*                                      DONE, GO PROCESS FOE          */ 04076000
         B     DOFOE                                               1093 04077000
*     END;                                                         1094 04078000
*                                                                  1094 04079000
*   /*****************************************************************/ 04080000
*   /*                                                               */ 04081000
*   /* SWAPPTR IS SET BY GETFIX                                      */ 04082000
*   /*                                                               */ 04083000
*   /*****************************************************************/ 04084000
*                                                                  1095 04085000
*   IF SPCTFIXC^=0 THEN                                            1095 04086000
@RF01088 LH    @06,SPCTFIXC(,SWAPPTR)                              1095 04087000
         LTR   @06,@06                                             1095 04088000
         BZ    @RF01095                                            1095 04089000
*     SPCTFIXC=SPCTFIXC-PCBFXC;     /* DECREMENT FIX COUNT IN SPCT   */ 04090000
         SLR   @01,@01                                             1096 04091000
         IC    @01,PCBFXC(,PCBPTR)                                 1096 04092000
         SLR   @06,@01                                             1096 04093000
         STH   @06,SPCTFIXC(,SWAPPTR)                              1096 04094000
*   ELSE                                                           1097 04095000
*                                                                  1097 04096000
*     /***************************************************************/ 04097000
*     /*                                                             */ 04098000
*     /* IF THE FIX COUNT IS ZERO, A NEW ENTRY WAS CREATED. RECORD   */ 04099000
*     /* ERROR AS ENTRY SHOULD HAVE BEEN IN SPCT                     */ 04100000
*     /*                                                             */ 04101000
*     /***************************************************************/ 04102000
*                                                                  1097 04103000
*     DO;                                                          1097 04104000
         B     @RC01095                                            1097 04105000
@RF01095 DS    0H                                                  1098 04106000
*       R0='15'X;                   /* RECORD ERROR                  */ 04107000
         LA    R0,21                                               1098 04108000
*       CALL DOABEND;               /* RECORD THE ERROR.             */ 04109000
         BAL   @14,DOABEND                                         1099 04110000
*       GO TO REMVFIX;              /* GO REMOVE FIX ENTRY FROM SPCT */ 04111000
         B     REMVFIX                                             1100 04112000
*     END;                                                         1101 04113000
*                                                                  1101 04114000
*   /*****************************************************************/ 04115000
*   /*                                                               */ 04116000
*   /* IF REMOVAL OF THIS FIX CAUSES THE FIX CT IN THE ENTRY TO GO TO*/ 04117000
*   /* ZERO, REMOVE THE ENTRY                                        */ 04118000
*   /*                                                               */ 04119000
*   /*****************************************************************/ 04120000
*                                                                  1102 04121000
*   IF SPCTFIXC^=0 THEN                                            1102 04122000
@RC01095 LH    @06,SPCTFIXC(,SWAPPTR)                              1102 04123000
         LTR   @06,@06                                             1102 04124000
         BNZ   @RT01102                                            1102 04125000
*     GO TO DOFOE;                  /* GO PROCESS FOE                */ 04126000
*   SPCTSWPE=PTRLAST->SPCTSWPE;     /* MOVE LAST ENTRY TO THIS ENTRY    04127000
*                                      AND ZERO THE LAST ENTRY       */ 04128000
         L     @06,PTRLAST(,PVTPTR)                                1104 04129000
         MVC   SPCTSWPE(8,SWAPPTR),SPCTSWPE(@06)                   1104 04130000
*   PTRLAST->SPCTSWPE(1:LENGTH(SPCTSWPE))=''B;/* ZERO LAST ENTRY.  1105 04131000
*                                      THIS MUST BE DONE IN CASE   1105 04132000
*                                      ENTRY IS REUSED.      @Z40WPYC*/ 04133000
         XC    SPCTSWPE(8,@06),SPCTSWPE(@06)                       1105 04134000
*   RFY                                                            1106 04135000
*    (SWAPPTR) UNRSTD;                                             1106 04136000
*REMVFIX:                                                          1107 04137000
*   SPCTFIX=SPCTFIX-1;              /* DEC NUMBER OF FIX ENTRIES     */ 04138000
*                                                                  1107 04139000
REMVFIX  LH    @12,SPCTFIX(,SPCTPTR)                               1107 04140000
         BCTR  @12,0                                               1107 04141000
         STH   @12,SPCTFIX(,SPCTPTR)                               1107 04142000
*   /*****************************************************************/ 04143000
*   /*                                                               */ 04144000
*   /* DID WE REMOVE THE ONLY FIX ENTRY                              */ 04145000
*   /*                                                               */ 04146000
*   /*****************************************************************/ 04147000
*                                                                  1108 04148000
*   IF SPCTFIX=0 THEN                                              1108 04149000
         SLR   @06,@06                                             1108 04150000
         CR    @12,@06                                             1108 04151000
         BNE   @RF01108                                            1108 04152000
*     PTRLAST=0;                    /* THERE ARE NO FIX ENTRIES LEFT    04153000
*                                      IN THE SPCT                   */ 04154000
         ST    @06,PTRLAST(,PVTPTR)                                1109 04155000
*   ELSE                                                           1110 04156000
*     DO;                                                          1110 04157000
         B     @RC01108                                            1110 04158000
@RF01108 DS    0H                                                  1111 04159000
*       PTRLAST=PTRLAST-LENGTH(SPCTSWPE);/* WE DID NOT REMOVE THE  1111 04160000
*                                      ONLY FIX ENTRY. UPDATE PTRLAST   04161000
*                                      TO POINT TO WHAT WAS THE NEXT    04162000
*                                      TO LAST FIX ENTRY     @Z40WPYC*/ 04163000
         L     @12,PTRLAST(,PVTPTR)                                1111 04164000
         SL    @12,@CF00057                                        1111 04165000
         ST    @12,PTRLAST(,PVTPTR)                                1111 04166000
*       R4=FIXBEG;                  /* GET ADDRESS OF FIRST EXTENSION   04167000
*                                      CONTAINING FIX ENTRIES        */ 04168000
         L     R4,FIXBEG(,PVTPTR)                                  1112 04169000
*       DO WHILE(R4^=0);                                           1113 04170000
         B     @DE01113                                            1113 04171000
@DL01113 DS    0H                                                  1114 04172000
*         IF R4->SPCTEXT=PTRLAST THEN/* DETERMINE IF PTRLAST IS    1114 04173000
*                                      POINTING AT A FIX ENTRY OR THE   04174000
*                                      BEGINNING OF AN EXT           */ 04175000
         CLC   SPCTEXT(4,R4),PTRLAST(PVTPTR)                       1114 04176000
         BNE   @RF01114                                            1114 04177000
*           DO;                                                    1115 04178000
*             PTRLAST=R4+LENGTH(SPCTEXTM)-LENGTH(SPCTSWPE);/* ADJUST    04179000
*                                      PTR TO LAST FIX ENTRY IN    1116 04180000
*                                      PREVIOUS EXT                  */ 04181000
         LR    @12,R4                                              1116 04182000
         SL    @12,@CF02696                                        1116 04183000
         ST    @12,PTRLAST(,PVTPTR)                                1116 04184000
*             GO TO DOFOE;          /* GO PROCESS FOE                */ 04185000
         B     DOFOE                                               1117 04186000
*           END;                                                   1118 04187000
*         R4=R4->SPCTEXT;           /* ADJUST TO NEXT EXT            */ 04188000
@RF01114 L     R4,SPCTEXT(,R4)                                     1119 04189000
*       END;                        /* WE HAVE LOOKED AT ALL       1120 04190000
*                                      EXTENSIONS AND PTRLAST IS NOT    04191000
*                                      POINTING TO THE BEGINNING OF     04192000
*                                      AN EXTENSION, THEREFORE IT  1120 04193000
*                                      MUST BE POINTING TO A FIX   1120 04194000
*                                      ENTRY                         */ 04195000
@DE01113 LTR   R4,R4                                               1120 04196000
         BNZ   @DL01113                                            1120 04197000
*     END;                                                         1121 04198000
*                                                                  1122 04199000
*   /*****************************************************************/ 04200000
*   /*                                                               */ 04201000
*   /* IF PROCESSING IS FOR THE PURPOSE OF REMOVING A FIX FROM THE   */ 04202000
*   /* SPCT BECAUSE THE ECB IS OUT OF STORAGE THEN RETURN, OTHERWISE */ 04203000
*   /* DECREMENT THE FOE FIX COUNT AND IF THE COUNT GOES TO ZERO FREE*/ 04204000
*   /* THE FOE                                                       */ 04205000
*   /*                                                               */ 04206000
*   /*****************************************************************/ 04207000
*                                                                  1122 04208000
*DOFOE:                                                            1122 04209000
*   IF NOSPCTE='1'B THEN            /* DOES THIS PCB HAVE AN OUT OF     04210000
*                                      STORAGE ECB OR IS IT FIRST  1122 04211000
*                                      REFERENCE CASE        @YM02790*/ 04212000
@RC01108 DS    0H                                                  1122 04213000
DOFOE    TM    NOSPCTE(PVTPTR),B'00000100'                         1122 04214000
         BNO   @RF01122                                            1122 04215000
*     DO;                                                          1123 04216000
*       RFY                                                        1124 04217000
*        (R14) RSTD;                                               1124 04218000
*       R14=LEV2RTN;                /* RESTORE RETURN ADDRESS        */ 04219000
         L     R14,LEV2RTN(,PVTPTR)                                1125 04220000
*       RETURN;                     /* RETURN TO CALLER              */ 04221000
         B     @EL00007                                            1126 04222000
*       RFY                                                        1127 04223000
*        (R14) UNRSTD;                                             1127 04224000
*     END;                                                         1128 04225000
*   R4=PCBRTCBA;                    /* GET TCB ADDRESS               */ 04226000
@RF01122 L     @01,PCBRTPA-1(,PCBPTR)                              1129 04227000
         L     R4,PCBRTCBA-1(,@01)                                 1129 04228000
         LA    R4,0(,R4)                                           1129 04229000
*   R5=ADDR(R4->TCBFOE);            /* SAVE ADDR                     */ 04230000
         LA    R5,TCBFOE(,R4)                                      1130 04231000
*   R4=R4->TCBFOEA;                 /* GET FOE ADDRESS               */ 04232000
*                                                                  1131 04233000
         L     @12,TCBFOEA-1(,R4)                                  1131 04234000
         LA    @12,0(,@12)                                         1131 04235000
         LR    R4,@12                                              1131 04236000
*   /*****************************************************************/ 04237000
*   /*                                                               */ 04238000
*   /* SCAN FOR MATCHING VBN IN FOE                                  */ 04239000
*   /*                                                               */ 04240000
*   /*****************************************************************/ 04241000
*                                                                  1132 04242000
*   DO WHILE(R4^=0);                                               1132 04243000
         B     @DE01132                                            1132 04244000
@DL01132 DS    0H                                                  1133 04245000
*     IF R4->FOEVINDX=PCBVBN THEN   /* DID WE FIND FOE               */ 04246000
         CLC   FOEVINDX(2,R4),PCBVBN(PCBPTR)                       1133 04247000
         BE    @RT01133                                            1133 04248000
*       GO TO DECFOE;               /* GO PROCESS IT                 */ 04249000
*     R5=R4;                        /* SAVE ADDR OF LAST FOE SO YOU     04250000
*                                      CAN DEQUE AN FOE              */ 04251000
         LR    R5,R4                                               1135 04252000
*     R4=R4->FOEFLINK;                                             1136 04253000
         L     @12,FOEFLINK-1(,R4)                                 1136 04254000
         LA    @12,0(,@12)                                         1136 04255000
         LR    R4,@12                                              1136 04256000
*   END;                                                           1137 04257000
@DE01132 LTR   R4,R4                                               1137 04258000
         BNZ   @DL01132                                            1137 04259000
*   R0='10'X;                       /* RECORD ERROR, COULD NOT FIND     04260000
*                                      FOE                           */ 04261000
         LA    R0,16                                               1138 04262000
*   CALL DOABEND;                   /* RECORD THE ERROR.             */ 04263000
         BAL   @14,DOABEND                                         1139 04264000
*   GO TO DECPFTE;                  /* COULD NOT FIND FOE, GO PROCESS   04265000
*                                      PFTE                          */ 04266000
*                                                                  1140 04267000
         B     DECPFTE                                             1140 04268000
*   /*****************************************************************/ 04269000
*   /*                                                               */ 04270000
*   /* FOE WAS FOUND, DECREMENT FIX COUNT IN FOE, IF COUNT GOES TO   */ 04271000
*   /* ZERO, FREE FOE. IF FOE FIX COUNT GOES TO ZERO IT SHOULD BE    */ 04272000
*   /* FREED BUT IT CAN NOT BE FREED AT THIS TIME AS THE FREEMAIN MAY*/ 04273000
*   /* CAUSE AN LSQA FRAME TO BE FREED AND THERE IS ALREADY AN ENTRY */ 04274000
*   /* IN THE SPCT FOR ALL LSQA FRAMES                               */ 04275000
*   /*                                                               */ 04276000
*   /*****************************************************************/ 04277000
*                                                                  1141 04278000
*DECFOE:                                                           1141 04279000
*   R4->FOEFXCT=R4->FOEFXCT-PCBFXC; /* DEC FOE FIX COUNT             */ 04280000
*                                                                  1141 04281000
DECFOE   LH    @12,FOEFXCT(,R4)                                    1141 04282000
         SLR   @06,@06                                             1141 04283000
         IC    @06,PCBFXC(,PCBPTR)                                 1141 04284000
         SLR   @12,@06                                             1141 04285000
         STH   @12,FOEFXCT(,R4)                                    1141 04286000
*   /*****************************************************************/ 04287000
*   /*                                                               */ 04288000
*   /* DECREMENT PFTE FIX COUNT BY PCB FIX COUNT                     */ 04289000
*   /*                                                               */ 04290000
*   /*****************************************************************/ 04291000
*                                                                  1142 04292000
*DECPFTE:                                                          1142 04293000
*   R4=PVTPFTP+PCBRBN;              /* THE RBN CANNOT BE ZERO AS THE    04294000
*                                      IOERR FLAG WAS ON IN THE PCB  */ 04295000
DECPFTE  LH    R4,PCBRBN(,PCBPTR)                                  1142 04296000
         N     R4,@CF02704                                         1142 04297000
         AL    R4,PVTPFTP(,PVTPTR)                                 1142 04298000
*   R4->PFTFXCT=R4->PFTFXCT-PCBFXC; /* DECREMENT PFTE FIX COUNT      */ 04299000
         LH    @12,PFTFXCT(,R4)                                    1143 04300000
         SLR   @06,@06                                             1143 04301000
         IC    @06,PCBFXC(,PCBPTR)                                 1143 04302000
         SLR   @12,@06                                             1143 04303000
         STH   @12,PFTFXCT(,R4)                                    1143 04304000
*   IF R4->PFTFXCT=0 THEN           /* ARE THERE STILL FIX REQUESTS     04305000
*                                      FOR THIS FRAME                */ 04306000
         LTR   @12,@12                                             1144 04307000
         BNZ   @RF01144                                            1144 04308000
*     DO;                           /* NO, THERE ARE NO FIX REQUESTS    04309000
*                                                            @YA01572*/ 04310000
*       IF PCBVBN>=PVTLCSA          /* IS THIS FRAME IN COMMON AREA  */ 04311000
*         THEN                                                     1146 04312000
         CLC   PCBVBN(2,PCBPTR),PVTLCSA(PVTPTR)                    1146 04313000
         BL    @RF01146                                            1146 04314000
*         PVTCOMFX=PVTCOMFX-1;      /* YES, DECREMENT COMMON FIX   1147 04315000
*                                      COUNT                 @YA01572*/ 04316000
         LH    @12,PVTCOMFX(,PVTPTR)                               1147 04317000
         BCTR  @12,0                                               1147 04318000
         STH   @12,PVTCOMFX(,PVTPTR)                               1147 04319000
*       ELSE                                                       1148 04320000
*         RSMCNTFX=RSMCNTFX-1;      /* DECREMENT ADDRESS SPACE FIX 1148 04321000
*                                      COUNT                 @YA01572*/ 04322000
         B     @RC01146                                            1148 04323000
@RF01146 LH    @12,RSMCNTFX(,RSMHDPTR)                             1148 04324000
         BCTR  @12,0                                               1148 04325000
         STH   @12,RSMCNTFX(,RSMHDPTR)                             1148 04326000
*       PVTCNTFX=PVTCNTFX-1;        /* DECREMENT SYSTEM FIX COUNT  1149 04327000
*                                                            @YA01572*/ 04328000
@RC01146 LH    @12,PVTCNTFX(,PVTPTR)                               1149 04329000
         BCTR  @12,0                                               1149 04330000
         STH   @12,PVTCNTFX(,PVTPTR)                               1149 04331000
*     END;                                                         1150 04332000
*   GO TO DOROOT;                   /* RETURN TO NON ERROR PATH      */ 04333000
         B     DOROOT                                              1151 04334000
*   RFY                                                            1152 04335000
*    (R4,                                                          1152 04336000
*     R5) UNRSTD;                                                  1152 04337000
*   RFY                                                            1153 04338000
*     PCBR BASED(PCBRPTR);                                         1153 04339000
*   END PCBPROC;                                                   1154 04340000
*                                                                  1155 04341000
*   /*****************************************************************/ 04342000
*   /*                                                               */ 04343000
*   /* THIS ROUTINE SETS A BIT IN THE SPCT WHICH CAUSES THE PAGE TO  */ 04344000
*   /* BE SWAPPED IN AS A STAGE 2 PAGE. THE LOCATION OF THE BIT IS IN*/ 04345000
*   /* THE SEGMENT ENTRY THAT CORRESPONDS TO THE SEGMENT ID PART OF  */ 04346000
*   /* THE VBN PASSED AS INPUT. THE BIT POSITION IN THE MASK IS      */ 04347000
*   /* DETERMINED BY 2**(15-P) WHERE P IS THE PAGE TABLE INDEX PART  */ 04348000
*   /* OF THE VBN                                                    */ 04349000
*   /*                                                               */ 04350000
*   /*****************************************************************/ 04351000
*                                                                  1155 04352000
*SETMASK:                                                          1155 04353000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               1155 04354000
SETMASK  DS    0H                                                  1156 04355000
*   RFY                                                            1156 04356000
*    (R1,                                                          1156 04357000
*     R11,                                                         1156 04358000
*     R14,                                                         1156 04359000
*     R15) RSTD;                                                   1156 04360000
*   LEV3RTN=R14;                    /* SAVE RETURN ADDRESS           */ 04361000
         ST    R14,LEV3RTN(,PVTPTR)                                1157 04362000
*   GEN CODE(SRL R1,4(0))                                          1158 04363000
*   REFS(R1) SETS(R1);              /* SHIFT OUT 4 LOW ORDER BITS    */ 04364000
         SRL R1,4(0)                                                    04365000
*   R0=R1;                          /* COPY VBN                      */ 04366000
         LR    R0,R1                                               1159 04367000
*   GEN CODE(SRL R0,4(0))                                          1160 04368000
*   REFS(R0) SETS(R0);              /* SHIFT SS PART RT 4 BITS, HIGH    04369000
*                                      ORDER PART OF REGISTER IS   1160 04370000
*                                      ASSUMED ZERO                  */ 04371000
         SRL R0,4(0)                                                    04372000
*   R2=ADDR(SPCTSEGS);              /* INITIALIZE SEGSPTR            */ 04373000
*                                                                  1161 04374000
         LA    R2,SPCTSEGS(,SPCTPTR)                               1161 04375000
*   /*****************************************************************/ 04376000
*   /*                                                               */ 04377000
*   /* SCAN SPCT SEGMENT ENTRIES FOR MATCH BY SEGMENT INDEX          */ 04378000
*   /*                                                               */ 04379000
*   /*****************************************************************/ 04380000
*                                                                  1162 04381000
*   DO R14=SPCTSSEG TO 1 BY-1;                                     1162 04382000
         SLR   R14,R14                                             1162 04383000
         IC    R14,SPCTSSEG(,SPCTPTR)                              1162 04384000
         B     @DE01162                                            1162 04385000
@DL01162 DS    0H                                                  1163 04386000
*     R15=R2->SPCTSEGX;                                            1163 04387000
*                                                                  1163 04388000
         SLR   R15,R15                                             1163 04389000
         IC    R15,SPCTSEGX(,R2)                                   1163 04390000
*     /***************************************************************/ 04391000
*     /*                                                             */ 04392000
*     /* DO THE SEGMENT IDS MATCH                                    */ 04393000
*     /*                                                             */ 04394000
*     /***************************************************************/ 04395000
*                                                                  1164 04396000
*     IF R15=R0 THEN                                               1164 04397000
         CR    R15,R0                                              1164 04398000
         BE    @RT01164                                            1164 04399000
*       GO TO MATCHSEG;                                            1165 04400000
*     R2=R2+LENGTH(SPCTSEGE);       /* INCREMENT PTR BY LENGTH OF  1166 04401000
*                                      ENTRY                         */ 04402000
         AL    R2,@CF00970                                         1166 04403000
*   END;                                                           1167 04404000
*                                                                  1167 04405000
         BCTR  R14,0                                               1167 04406000
@DE01162 LTR   R14,R14                                             1167 04407000
         BP    @DL01162                                            1167 04408000
*   /*****************************************************************/ 04409000
*   /*                                                               */ 04410000
*   /* RECORD ERROR, WE FAILED TO FIND A SEGMENT ENTRY WHICH SHOULD  */ 04411000
*   /* HAVE BEEN THERE                                               */ 04412000
*   /*                                                               */ 04413000
*   /*****************************************************************/ 04414000
*                                                                  1168 04415000
*   R0='18'X;                       /* RECORD LOST ENTRY             */ 04416000
         LA    R0,24                                               1168 04417000
*   CALL DOABEND;                   /* RECORD THE ERROR.             */ 04418000
         BAL   @14,DOABEND                                         1169 04419000
*   GO TO MASKRTN;                                                 1170 04420000
*                                                                  1170 04421000
         B     MASKRTN                                             1170 04422000
*   /*****************************************************************/ 04423000
*   /*                                                               */ 04424000
*   /* WE FOUND THE CORRECT SEGMENT ENTRY                            */ 04425000
*   /*                                                               */ 04426000
*   /*****************************************************************/ 04427000
*                                                                  1171 04428000
*MATCHSEG:                                                         1171 04429000
*   R1=R1&PMASK;                    /* ISOLATE P PART OF VBN         */ 04430000
MATCHSEG N     R1,@CF02506                                         1171 04431000
*   R1=15-R1;                       /* COMPUTE SHIFT AMOUNT          */ 04432000
         LA    @12,15                                              1172 04433000
         SLR   @12,R1                                              1172 04434000
         LR    R1,@12                                              1172 04435000
*   R0=1;                           /* GET A 1 TO SHIFT              */ 04436000
         LA    R0,1                                                1173 04437000
*   GEN CODE(SLL R0,0(R1))                                         1174 04438000
*   SETS(R0) REFS(R0,R1);                                          1174 04439000
         SLL R0,0(R1)                                                   04440000
*   R2->SPCTBITM=R2->SPCTBITM|R0;   /* OR ON NEW BIT                 */ 04441000
         LH    @12,SPCTBITM(,R2)                                   1175 04442000
         N     @12,@CF02704                                        1175 04443000
         OR    @12,R0                                              1175 04444000
         STH   @12,SPCTBITM(,R2)                                   1175 04445000
*   SPCTWSSZ=SPCTWSSZ+1;            /* INCREMENT WORKING SET SIZE    */ 04446000
         LA    @12,1                                               1176 04447000
         AH    @12,SPCTWSSZ(,SPCTPTR)                              1176 04448000
         STH   @12,SPCTWSSZ(,SPCTPTR)                              1176 04449000
*MASKRTN:                                                          1177 04450000
*   R2=ASCBRSM;                     /* RESTORE HEADER ADDRESS        */ 04451000
MASKRTN  L     @12,ASCBPTR                                         1177 04452000
         L     R2,ASCBRSM(,@12)                                    1177 04453000
*   R14=LEV3RTN;                    /* GET RETURN ADDRESS            */ 04454000
         L     R14,LEV3RTN(,PVTPTR)                                1178 04455000
*   RFY                                                            1179 04456000
*    (R1,                                                          1179 04457000
*     R11,                                                         1179 04458000
*     R14,                                                         1179 04459000
*     R15) UNRSTD;                                                 1179 04460000
*PRCEND3:                                                          1180 04461000
*   END SETMASK;                                                   1180 04462000
@EL00008 DS    0H                                                  1180 04463000
@EF00008 DS    0H                                                  1180 04464000
@ER00008 BR    @14                                                 1180 04465000
*GETFIX:                                                           1181 04466000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               1181 04467000
*                                                                  1181 04468000
GETFIX   DS    0H                                                  1182 04469000
*   /*****************************************************************/ 04470000
*   /*                                                               */ 04471000
*   /* THIS SECTION GETS A NEW SPCT EXTENSION. IF THE PRESENT        */ 04472000
*   /* EXTENSION POINTS TO AN UNUSED EXTENSION, THAT EXTENSION WILL  */ 04473000
*   /* BE USED. IF THERE IS NOT AN UNUSED EXTENSION, A NEW EXTENSION */ 04474000
*   /* IS GETMAINED. THE NEW EXTENSION IS INITIALIZED AND CONTROL    */ 04475000
*   /* RETURNS TO THE CALLER. INPUT IS R1 WITH THE FIX VBN. OUTPUT IS*/ 04476000
*   /* SWAPPTR POINTING TO A NEW FIX ENTRY OR AN EXISTING ONE IF ONE */ 04477000
*   /* EXISTS.                                                       */ 04478000
*   /*                                                               */ 04479000
*   /*****************************************************************/ 04480000
*                                                                  1182 04481000
*   RESPECIFY                                                      1182 04482000
*    (SWAPPTR,                                                     1182 04483000
*     R1,                                                          1182 04484000
*     R4,                                                          1182 04485000
*     ENDPTR,                                                      1182 04486000
*     BEGPTR,                                                      1182 04487000
*     R11,                                                         1182 04488000
*     R14) RESTRICTED;                                             1182 04489000
*   LEV3RTN=R14;                    /* SAVE THE RETURN ADDRESS.      */ 04490000
         ST    R14,LEV3RTN(,PVTPTR)                                1183 04491000
*   RESPECIFY                                                      1184 04492000
*    (R14) UNRESTRICTED;                                           1184 04493000
*   SWAPPTR=PTRFIRST;               /* GET THE ADDRESS OF THE FIRST     04494000
*                                      FIX ENTRY IN THE SPCT.        */ 04495000
         L     SWAPPTR,PTRFIRST(,PVTPTR)                           1185 04496000
*   BEGPTR=FIXBEG;                  /* GET THE ADDRESS OF THE START     04497000
*                                      OF THE FIRST EXTENSION WITH 1186 04498000
*                                      FIX ENTRIES.                  */ 04499000
         L     BEGPTR,FIXBEG(,PVTPTR)                              1186 04500000
*   ENDPTR=BEGPTR+LENGTH(SPCTEXTM); /* GET THE ADDRESS OF THE END OF    04501000
*                                      THE FIRST EXTENSION WITH FIX     04502000
*                                      ENTRIES.                      */ 04503000
         LA    ENDPTR,56                                           1187 04504000
         ALR   ENDPTR,BEGPTR                                       1187 04505000
*   IF PTRLAST=0 THEN               /* TEST IF THERE ANY FIX ENTRIES    04506000
*                                      IN THE SPCT.                  */ 04507000
         L     @15,PTRLAST(,PVTPTR)                                1188 04508000
         LTR   @15,@15                                             1188 04509000
         BZ    @RT01188                                            1188 04510000
*     GOTO INITFIX;                 /* ARE NO FIX ENTRIES YET. GO  1189 04511000
*                                      INITIALIZE THE FIRST.         */ 04512000
*TESTVBN:                                                          1190 04513000
*   RESPECIFY                                                      1190 04514000
*    (R15) RESTRICTED;                                             1190 04515000
TESTVBN  DS    0H                                                  1191 04516000
*   R15=SPCTVBN;                    /* GET THE VBN.          @Z40WPYC*/ 04517000
         LH    R15,SPCTVBN(,SWAPPTR)                               1191 04518000
         N     R15,@CF02704                                        1191 04519000
*   IF R15=R1 THEN                  /* TEST IF THE SPCT ENTRY IS FOR    04520000
*                                      THE VBN BEING PROCESSED.      */ 04521000
         CR    R15,R1                                              1192 04522000
         BE    @RT01192                                            1192 04523000
*     GOTO EXITPT;                  /* HAVE FOUND A SPCT FIX ENTRY 1193 04524000
*                                      FOR THE INPUT VBN. PASS IT  1193 04525000
*                                      BACK TO THE CALLER.           */ 04526000
*   RESPECIFY                                                      1194 04527000
*    (R15) UNRESTRICTED;                                           1194 04528000
*   SWAPPTR=SWAPPTR+LENGTH(SPCTSWPE);/* HAVE NOT FOUND THE VBN ENTRY    04529000
*                                      YET. GET THE ADDRESS OF THE 1195 04530000
*                                      NEXT FIX ENTRY AND TRY AGAIN. */ 04531000
         LA    @15,8                                               1195 04532000
         ALR   SWAPPTR,@15                                         1195 04533000
*   IF SWAPPTR^=PTRLAST+LENGTH(SPCTSWPE) THEN/* TEST IF THE END OF 1196 04534000
*                                      THE FIX ENTRIES HAS BEEN    1196 04535000
*                                      REACHED.                      */ 04536000
         L     @14,PTRLAST(,PVTPTR)                                1196 04537000
         ALR   @14,@15                                             1196 04538000
         CR    SWAPPTR,@14                                         1196 04539000
         BE    @RF01196                                            1196 04540000
*     DO;                           /* NOT AT END OF SPCT. ARE MORE     04541000
*                                      FIX ENTRIES TO SEARCH.        */ 04542000
*       IF SWAPPTR=ENDPTR THEN      /* TEST IF AT END OF THE       1198 04543000
*                                      EXTENSION.                    */ 04544000
         CR    SWAPPTR,ENDPTR                                      1198 04545000
         BNE   @RF01198                                            1198 04546000
*         DO;                       /* ARE AT END OF THE EXTENSION.     04547000
*                                      GET THE NEXT EXTENSION TO BE     04548000
*                                      PROCESSED.                    */ 04549000
*           BEGPTR=BEGPTR->SPCTEXT; /* GET THE ADDRESS OF THE NEXT 1200 04550000
*                                      EXTENSION TO BE PROCESSED.    */ 04551000
*                                                                  1200 04552000
         L     BEGPTR,SPCTEXT(,BEGPTR)                             1200 04553000
*           /*********************************************************/ 04554000
*           /*                                                       */ 04555000
*           /* GET THE ADDRESS OF THE FIRST FIX ENTRY IN THE         */ 04556000
*           /* EXTENSION.                                            */ 04557000
*           /*                                                       */ 04558000
*           /*********************************************************/ 04559000
*                                                                  1201 04560000
*           SWAPPTR=BEGPTR+(LENGTH(SPCTEXTM)-LENGTH(SPCTENT));     1201 04561000
         ALR   @15,BEGPTR                                          1201 04562000
         LR    SWAPPTR,@15                                         1201 04563000
*           ENDPTR=BEGPTR+LENGTH(SPCTEXTM);/* GET THE ADDRESS OF THE    04564000
*                                      END OF THE EXTENSION.         */ 04565000
         LA    ENDPTR,56                                           1202 04566000
         ALR   ENDPTR,BEGPTR                                       1202 04567000
*         END;                                                     1203 04568000
*       GOTO TESTVBN;               /* TEST THE NEXT SPCT FIX ENTRY. */ 04569000
         B     TESTVBN                                             1204 04570000
*     END;                                                         1205 04571000
*                                                                  1205 04572000
*   /*****************************************************************/ 04573000
*   /*                                                               */ 04574000
*   /* IF HERE, THERE IS NOT A SPCT FIX ENTRY WITH THE SAME VBN AS   */ 04575000
*   /* THE INPUT VBN. A NEW ENTRY IS CREATED.                        */ 04576000
*   /*                                                               */ 04577000
*   /*****************************************************************/ 04578000
*                                                                  1206 04579000
*   IF SWAPPTR=ENDPTR THEN          /* TEST IF THE PRESENT EXTENSION    04580000
*                                      IS FULL.                      */ 04581000
@RF01196 CR    SWAPPTR,ENDPTR                                      1206 04582000
         BNE   @RF01206                                            1206 04583000
*     DO;                           /* EXTENSION IS FULL, SO GET AN     04584000
*                                      ADDITIONAL EXTENSION.         */ 04585000
*       CALL GETEXT;                /* GET A NEW EXTENSION.          */ 04586000
         BAL   @14,GETEXT                                          1208 04587000
*       IF RETNCODE^=0 THEN         /* TEST IF RETURN CODE IS BAD. WE   04588000
*                                      RETURN HERE ONLY IF CALLED  1209 04589000
*                                      FROM WORKSET OR PIOPURGE      */ 04590000
         L     @15,RETNCODE(,PVTPTR)                               1209 04591000
         LTR   @15,@15                                             1209 04592000
         BNZ   @RT01209                                            1209 04593000
*         GOTO EXITPT;              /* ERROR OCCURRED. RETURN TO THE    04594000
*                                      CALLER.                       */ 04595000
*     END;                                                         1211 04596000
*INITFIX:                                                          1212 04597000
*   SPCTVBN=R1;                     /* STORE THE VBN IN THE FIX    1212 04598000
*                                      ENTRY.                @Z40WPYC*/ 04599000
@RF01206 DS    0H                                                  1212 04600000
INITFIX  STH   R1,SPCTVBN(,SWAPPTR)                                1212 04601000
*   IF R1^<PVTLCSA THEN             /* TEST IF THE VBN IS FOR THE  1213 04602000
*                                      COMMON AREA.                  */ 04603000
         LH    @15,PVTLCSA(,PVTPTR)                                1213 04604000
         N     @15,@CF02704                                        1213 04605000
         CR    R1,@15                                              1213 04606000
         BL    @RF01213                                            1213 04607000
*     SPCTCOMM='1'B;                /* SET COMMON AREA FLAG IN THE 1214 04608000
*                                      FIX ENTRY.                    */ 04609000
         OI    SPCTCOMM(SWAPPTR),B'00100000'                       1214 04610000
*   ELSE                            /* FIX IS IN PRIVATE AREA        */ 04611000
*     DO;                           /* TEST IF FIXED PAGE IS IN CORE    04612000
*                                      FOR COUNTER           @YM07609*/ 04613000
         B     @RC01213                                            1215 04614000
@RF01213 DS    0H                                                  1216 04615000
*       RESPECIFY                                                  1216 04616000
*        (R14) RESTRICTED;                                         1216 04617000
*       GEN CODE REFS(R1) SETS(R14) FLOWS(RSETVBN);                1217 04618000
         SLL   R1,8      MAKE VSA FROM VBN                              04619000
         LRA   R14,0(R1) LOAD REAL ADDRESS                              04620000
         BC    7,RSETVBN IF PAGE NOT IN CORE, DO NOT COUNT IT           04621000
*       PAFIX=PAFIX+1;              /* INCREMENT NUMBER OF PRIVATE 1218 04622000
*                                      AREA FIXES                    */ 04623000
         LA    @15,1                                               1218 04624000
         AL    @15,PAFIX(,PVTPTR)                                  1218 04625000
         ST    @15,PAFIX(,PVTPTR)                                  1218 04626000
*RSETVBN:                                                          1219 04627000
*       GEN(SRL  R1,8)              /* MAKE THE VSA A VBN    @YM07609*/ 04628000
*       REFS(R1) SETS(R1) NOFLOWS;                                 1219 04629000
RSETVBN  SRL  R1,8                                                      04630000
*       RESPECIFY                                                  1220 04631000
*        (R14) UNRESTRICTED;                                       1220 04632000
*     END;                                                         1221 04633000
*   SPCTFIX=SPCTFIX+1;              /* INCREMENT THE COUNT OF FIX  1222 04634000
*                                      ENTRIES IN THE SPCT           */ 04635000
@RC01213 LA    @15,1                                               1222 04636000
         AH    @15,SPCTFIX(,SPCTPTR)                               1222 04637000
         STH   @15,SPCTFIX(,SPCTPTR)                               1222 04638000
*   PTRLAST=SWAPPTR;                /* SAVE THE ADDRESS OF THE NEW 1223 04639000
*                                      LAST FIX ENTRY.               */ 04640000
*                                                                  1223 04641000
         ST    SWAPPTR,PTRLAST(,PVTPTR)                            1223 04642000
*   /*****************************************************************/ 04643000
*   /*                                                               */ 04644000
*   /* EXIT GETFIX ROUTINE                                           */ 04645000
*   /*                                                               */ 04646000
*   /*****************************************************************/ 04647000
*                                                                  1224 04648000
*EXITPT:                                                           1224 04649000
*   RESPECIFY                                                      1224 04650000
*    (R14) RESTRICTED;                                             1224 04651000
EXITPT   DS    0H                                                  1225 04652000
*   R14=LEV3RTN;                    /* GET THE RETURN ADDRESS.       */ 04653000
         L     R14,LEV3RTN(,PVTPTR)                                1225 04654000
*   RESPECIFY                                                      1226 04655000
*    (R1,                                                          1226 04656000
*     R4,                                                          1226 04657000
*     SWAPPTR,                                                     1226 04658000
*     ENDPTR,                                                      1226 04659000
*     BEGPTR,                                                      1226 04660000
*     R11,                                                         1226 04661000
*     R14) UNRESTRICTED;                                           1226 04662000
*   END GETFIX;                                                    1227 04663000
@EL00009 DS    0H                                                  1227 04664000
@EF00009 DS    0H                                                  1227 04665000
@ER00009 BR    @14                                                 1227 04666000
*                                                                  1228 04667000
*   /*****************************************************************/ 04668000
*   /*                                                               */ 04669000
*   /* THIS SECTION GETS A PARTIALLY INITIALIZED PCB AND COMPLETES   */ 04670000
*   /* THE INITIALIZATION NECESSARY TO SWAP OUT THE VIRTUAL PAGE.    */ 04671000
*   /* INPUT IS PFTEPTR POINTING TO THE PFTE TO BE PAGED OUT OUTPUT  */ 04672000
*   /* IS AN INITIALIZED PCB FOR THE PFTE AND PCBPTR POINTING TO THE */ 04673000
*   /* PCB JUST INITIALIZED AND NEXTPCB UPDATED. NOTE THAT PCBSPCTE  */ 04674000
*   /* IS NOT INITIALIZED BY THIS ROUTINE. THE CALLER IS RESPONSIBLE */ 04675000
*   /* FOR INITIALIZING THIS FIELD FOR EACH SWAPOUT LSQA OR FIX'D    */ 04676000
*   /* PAGE (INCLUDING ZERO TCB FIX).                                */ 04677000
*   /*                                                               */ 04678000
*   /*****************************************************************/ 04679000
*                                                                  1228 04680000
*INITPCB:                                                          1228 04681000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               1228 04682000
INITPCB  DS    0H                                                  1229 04683000
*   RESPECIFY                                                      1229 04684000
*    (R0,                                                          1229 04685000
*     R1,                                                          1229 04686000
*     R4,                                                          1229 04687000
*     PFTEPTR,                                                     1229 04688000
*     ENDPTR,                                                      1229 04689000
*     SWAPPTR,                                                     1229 04690000
*     R14) RESTRICTED;                                             1229 04691000
*   LEV3RTN=R14;                    /* SAVE THE RETURN ADDRESS.      */ 04692000
         ST    R14,LEV3RTN(,PVTPTR)                                1230 04693000
*   RESPECIFY                                                      1231 04694000
*    (R14) UNRESTRICTED;                                           1231 04695000
*   IF PFTBADPG='1'B THEN           /* STORAGE ERROR IN THE PAGE?  1232 04696000
*                                                            @ZA19960*/ 04697000
*                                                                  1232 04698000
         TM    PFTBADPG(PFTEPTR),B'00000100'                       1232 04699000
         BNO   @RF01232                                            1232 04700000
*     /***************************************************************/ 04701000
*     /*                                                             */ 04702000
*     /* THIS CODE PROCESSES ONLY NON LSQA PRIVATE AREA FRAMES - LSQA*/ 04703000
*     /* IS DONE IN THE LSQANTRY ROUTINE - FIXED PRIVATE IS DONE IN  */ 04704000
*     /* THE STAGE1 ROUTINE AND HERE WHEN CALLED FROM THE WORKSET    */ 04705000
*     /* ROUTINE - THIS IS THE ONLY PLACE STORAGE ERRORS IN CHANGED  */ 04706000
*     /* PAGEABLE PRIVATE AREA ARE PROCESSED WHEN CALLED FROM WORKSET*/ 04707000
*     /* ROUTINE.                                            @ZA19960*/ 04708000
*     /*                                                             */ 04709000
*     /***************************************************************/ 04710000
*                                                                  1233 04711000
*     DO;                           /* RECORD AND SKIP PCB BUILD   1233 04712000
*                                                            @ZA19960*/ 04713000
*       IF FRPINCNT^>MXPINCNT&PFTPREF='0'B THEN/* LOGGED TOO MANY  1234 04714000
*                                      YET?                  @ZA19960*/ 04715000
         CLI   FRPINCNT(RSMHDPTR),5                                1234 04716000
         BH    @RF01234                                            1234 04717000
         TM    PFTPREF(PFTEPTR),B'00000100'                        1234 04718000
         BNZ   @RF01234                                            1234 04719000
*         DO;                       /* COUNT NOT EXCEEDED SO LOG IT     04720000
*                                                            @ZA19960*/ 04721000
*           FRPINCNT=FRPINCNT+1;    /* INCREMENT THE LOGGED COUNT  1236 04722000
*                                                            @ZA19960*/ 04723000
         LA    @05,1                                               1236 04724000
         SLR   @15,@15                                             1236 04725000
         IC    @15,FRPINCNT(,RSMHDPTR)                             1236 04726000
         ALR   @05,@15                                             1236 04727000
         STC   @05,FRPINCNT(,RSMHDPTR)                             1236 04728000
*           R0='20'X;               /* SET STORAGE PINNED FOR STORAGE   04729000
*                                      ERROR CODE            @ZA19960*/ 04730000
         LA    R0,32                                               1237 04731000
*           CALL DOABEND;           /* RECORD THE STORAGE PINNING  1238 04732000
*                                                            @ZA19960*/ 04733000
         BAL   @14,DOABEND                                         1238 04734000
*         END;                      /* END OF STORAGE ERROR LOGGING     04735000
*                                      DO GROUP              @ZA19960*/ 04736000
*       FPCALLED='0'B;              /* RESET FIND PAGE CALLED      1240 04737000
*                                      INDICATOR             @ZA19960*/ 04738000
@RF01234 NI    FPCALLED(PVTPTR),B'11111101'                        1240 04739000
*       GOTO BADPAGE;               /* DO NOT SWAP OUT A BAD PAGE  1241 04740000
*                                                            @ZA19960*/ 04741000
         B     BADPAGE                                             1241 04742000
*     END;                          /* END OF RECORD - GOING TO THE     04743000
*                                      SKIP BUILD PCB CODE   @ZA19960*/ 04744000
*                                                                  1242 04745000
*   /*****************************************************************/ 04746000
*   /*                                                               */ 04747000
*   /* ARE THERE ANY MORE PCBS                                       */ 04748000
*   /*                                                               */ 04749000
*   /*****************************************************************/ 04750000
*                                                                  1243 04751000
*   PCBPTR=NEXTPCB;                 /* SET TO NEXT PCB TO INIT       */ 04752000
@RF01232 L     PCBPTR,NEXTPCB(,PVTPTR)                             1243 04753000
*   IF PCBPTR=0 THEN                /* ANY PCBS LEFT                 */ 04754000
         LTR   PCBPTR,PCBPTR                                       1244 04755000
         BNZ   @RF01244                                            1244 04756000
*     DO;                                                          1245 04757000
*       R0='17'X;                   /* ERROR WAS ORIGINALLY IN     1246 04758000
*                                      ASCBFMCT                      */ 04759000
         LA    R0,23                                               1246 04760000
*       CALL DOABEND;               /* RECORD ERROR                  */ 04761000
         BAL   @14,DOABEND                                         1247 04762000
*       IF PURGDON='0'B THEN        /* HAS PAGING BEEN PURGED        */ 04763000
         TM    PURGDON(PVTPTR),B'00001000'                         1248 04764000
         BNZ   @RF01248                                            1248 04765000
*         RETURN TO CLEANUP1;       /* RETURN AND ABORT SWAP         */ 04766000
         LA    @14,CLEANUP1                                        1249 04767000
@EL00010 DS    0H                                                  1249 04768000
@EF00010 DS    0H                                                  1249 04769000
@ER00010 BR    @14                                                 1249 04770000
*BADPAGE:                                                          1250 04771000
*       ;                           /* DO NOT BUILD A PCB FOR BAD  1250 04772000
*                                      FRAMES                @ZA19960*/ 04773000
@RF01248 DS    0H                                                  1250 04774000
BADPAGE  DS    0H                                                  1251 04775000
*       RETNCODE=TRYLATER;          /* SET RETURN CODE               */ 04776000
         MVC   RETNCODE(4,PVTPTR),@CF00057                         1251 04777000
*       GO TO INITEXT;              /* RETURN WITHOUT INITING PCB    */ 04778000
         B     INITEXT                                             1252 04779000
*     END;                                                         1253 04780000
*   RESPECIFY                                                      1254 04781000
*    (R15) RESTRICTED;                                             1254 04782000
@RF01244 DS    0H                                                  1255 04783000
*   IF PFTLSQA^='1'B THEN           /* FOR EVERY PRIVATE AREA PAGE,     04784000
*                                      MUST SET THE PGT/XPT ADDR IN     04785000
*                                      PCB                   @Z40WPYC*/ 04786000
         TM    PFTLSQA(PFTEPTR),B'00100000'                        1255 04787000
         BO    @RF01255                                            1255 04788000
*     DO;                           /* PRIVATE AREA          @Z40WPYC*/ 04789000
*       IF FPCALLED^='1'B           /* HAS FIND PAGE BEEN CALLED     */ 04790000
*         THEN                                                     1257 04791000
         TM    FPCALLED(PVTPTR),B'00000010'                        1257 04792000
         BO    @RF01257                                            1257 04793000
*         DO;                       /* NO, CALL FINDPAGE     @Z40WPYD*/ 04794000
*           R1=PFTVBN*256;          /* GET THE VSA FROM THE VBN    1259 04795000
*                                                            @Z40WPYC*/ 04796000
         LH    R1,PFTVBN(,PFTEPTR)                                 1259 04797000
         N     R1,@CF02704                                         1259 04798000
         SLA   R1,8                                                1259 04799000
*           CALL IEAVFP2;           /* CALL FINDPAGE TO GET THE PGTE    04800000
*                                      AND XPTE ADDRESSES    @Z40WPYC*/ 04801000
         L     @15,PVTPFP2(,PVTPTR)                                1260 04802000
         BALR  @14,@15                                             1260 04803000
*           IF R15^=0 THEN          /* INTERNAL ERROR IF BAD RETURN     04804000
*                                      CODE. PAGE AND SEGMENT MUST BE   04805000
*                                      VALID IF FRAME IS ASSIGNED. 1261 04806000
*                                                            @Z40WPYC*/ 04807000
         LTR   R15,R15                                             1261 04808000
         BZ    @RF01261                                            1261 04809000
*             DO;                   /* INTERNAL ERROR        @Z40WPYC*/ 04810000
*               R0='01'X;           /* INDICATE FINDPAGE FAILURE   1263 04811000
*                                                            @Z40WPYC*/ 04812000
         LA    R0,1                                                1263 04813000
*               CALL DOABEND;       /* RECORD THE ERROR      @Z40WPYC*/ 04814000
         BAL   @14,DOABEND                                         1264 04815000
*               RETNCODE=TRYLATER;  /* SET FAILURE RETURN CODE     1265 04816000
*                                                            @Z40WPYC*/ 04817000
         MVC   RETNCODE(4,PVTPTR),@CF00057                         1265 04818000
*               GOTO INITEXT;       /* RETURN WITHOUT INIT PCB     1266 04819000
*                                                            @Z40WPYC*/ 04820000
         B     INITEXT                                             1266 04821000
*             END;                  /* END FAILURE PROCESSING      1267 04822000
*                                                            @Z40WPYC*/ 04823000
*           ELSE                                                   1268 04824000
*             ;                     /* FOUND PGTE            @Z40WPYC*/ 04825000
@RF01261 DS    0H                                                  1269 04826000
*           RESPECIFY                                              1269 04827000
*            (R15) UNRESTRICTED;    /*                       @Z40WPYC*/ 04828000
*         END;                                                     1270 04829000
*       ELSE                                                       1271 04830000
*         FPCALLED='0'B;            /* YES, FINDPAGE WAS CALLED FOR     04831000
*                                      THIS FRAME. SET FLAG OFF    1271 04832000
*                                                            @Z40WPYD*/ 04833000
         B     @RC01257                                            1271 04834000
@RF01257 NI    FPCALLED(PVTPTR),B'11111101'                        1271 04835000
*       PCBPGTA=R0;                 /* SET PGTE ADDRESS      @Z40WPYC*/ 04836000
@RC01257 STCM  R0,7,PCBPGTA(PCBPTR)                                1272 04837000
*       PCBXPTA=R1;                 /* SET XPTE ADDRESS      @Z40WPYC*/ 04838000
         STCM  R1,7,PCBXPTA(PCBPTR)                                1273 04839000
*       AIAPRIV='1'B;               /* INDICATE PRIVATE AREA PAGE  1274 04840000
*                                                            @Z40WPYC*/ 04841000
         OI    AIAPRIV(PCBPTR),B'01000000'                         1274 04842000
*     END;                          /* END PRIVATE AREA ONLY @Z40WPYC*/ 04843000
*   ELSE                                                           1276 04844000
*     ;                             /* LSQA ENTRY - START COMMON   1276 04845000
*                                      PROCESSING            @Z40WPYC*/ 04846000
@RF01255 DS    0H                                                  1277 04847000
*   GEN REFS(R14,PCBPTR,SOUTENTR) SETS(R14,PCB);                   1277 04848000
*                                          /*               @Z40WPYC*/  04849000
TRACEZS1 EQU  *         PCB TRACE - SOUT ENTERED            @Z40WPYC    04850000
         B    *+16      BRANCH AROUND TRACE CODE            @Z40WPYC    04851000
         L    R14,64(PCBPTR) GET CURRENT COUNT              @Z40WPYC    04852000
         AL   R14,SOUTENTR   INCREMENT BY 1                 @Z40WPYC    04853000
         ST   R14,64(PCBPTR) STORE NEW COUNT                @Z40WPYC    04854000
*   PCBVBN=PFTVBN;                  /* STORE THE VBN IN THE PCB.     */ 04855000
         MVC   PCBVBN(2,PCBPTR),PFTVBN(PFTEPTR)                    1278 04856000
*   PFTPCBSI='1'B;                  /* A PCB IS DEFINED FOR THE    1279 04857000
*                                      FRAME.                        */ 04858000
         OI    PFTPCBSI(PFTEPTR),B'00001000'                       1279 04859000
*   PCBRBN=PFTEPTR-PVTPFTP;         /* GET THE RBN FROM THE PFTE   1280 04860000
*                                      ADDRESS.                      */ 04861000
         LR    @05,PFTEPTR                                         1280 04862000
         SL    @05,PVTPFTP(,PVTPTR)                                1280 04863000
         STH   @05,PCBRBN(,PCBPTR)                                 1280 04864000
*   ROOTCNT=ROOTCNT+1;              /* INCREMENT THE ROOT COUNT.     */ 04865000
         LA    @05,1                                               1281 04866000
         AH    @05,ROOTCNT(,PVTPTR)                                1281 04867000
         STH   @05,ROOTCNT(,PVTPTR)                                1281 04868000
*   IF PCBFQPA=0 THEN               /* LAST PCB                      */ 04869000
         L     @05,PCBFQPA-1(,PCBPTR)                              1282 04870000
         LA    @05,0(,@05)                                         1282 04871000
         LTR   @05,@05                                             1282 04872000
         BNZ   @RF01282                                            1282 04873000
*     AIANXAIA=0;                   /* ZERO NEXT AIA ADDRESS         */ 04874000
         SLR   @05,@05                                             1283 04875000
         ST    @05,AIANXAIA(,PCBPTR)                               1283 04876000
*   ELSE                            /* NOT LAST PCB                  */ 04877000
*     AIANXAIA=ADDR(PCBFQPA->PCBAIA);/* GET THE ADDRESS OF THE NEXT     04878000
*                                      AIA.                          */ 04879000
         B     @RC01282                                            1284 04880000
@RF01282 L     @05,PCBFQPA-1(,PCBPTR)                              1284 04881000
         LA    @05,0(,@05)                                         1284 04882000
         LA    @05,PCBAIA(,@05)                                    1284 04883000
         ST    @05,AIANXAIA(,PCBPTR)                               1284 04884000
*   NEXTPCB=PCBFQPA;                /* SET POINTER TO NEXT AVAILABLE    04885000
*                                      PCB.                          */ 04886000
@RC01282 L     @05,PCBFQPA-1(,PCBPTR)                              1285 04887000
         LA    @05,0(,@05)                                         1285 04888000
         ST    @05,NEXTPCB(,PVTPTR)                                1285 04889000
*   RESPECIFY                                                      1286 04890000
*    (R14) RESTRICTED;                                             1286 04891000
*INITEXT:                                                          1287 04892000
*   R14=LEV3RTN;                    /* GET THE RETURN ADDRESS.       */ 04893000
INITEXT  L     R14,LEV3RTN(,PVTPTR)                                1287 04894000
*   RESPECIFY                                                      1288 04895000
*    (R1,                                                          1288 04896000
*     PFTEPTR,                                                     1288 04897000
*     R4,                                                          1288 04898000
*     R5,                                                          1288 04899000
*     ENDPTR,                                                      1288 04900000
*     SWAPPTR,                                                     1288 04901000
*     R14) UNRESTRICTED;                                           1288 04902000
*   END INITPCB;                                                   1289 04903000
         B     @EL00010                                            1289 04904000
*                                                                  1290 04905000
*   /*****************************************************************/ 04906000
*   /*                                                               */ 04907000
*   /* THIS SECTION GETS AN ADDITIONAL EXTENSION TO THE SPCT. IF AN  */ 04908000
*   /* UNUSED EXTENSION EXISTS POINTED TO BY THE PRESENT EXTENSION,  */ 04909000
*   /* THAT EXTENSION IS USED. OTHERWISE A NEW EXTENSION IS          */ 04910000
*   /* GETMAINED.                                                    */ 04911000
*   /*                                                               */ 04912000
*   /*****************************************************************/ 04913000
*                                                                  1290 04914000
*GETEXT:                                                           1290 04915000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               1290 04916000
GETEXT   DS    0H                                                  1291 04917000
*   RESPECIFY                                                      1291 04918000
*    (R1,                                                          1291 04919000
*     R4,                                                          1291 04920000
*     SWAPPTR,                                                     1291 04921000
*     PFTEPTR,                                                     1291 04922000
*     BEGPTR,                                                      1291 04923000
*     ENDPTR,                                                      1291 04924000
*     R14) RESTRICTED;                                             1291 04925000
*   LEV4RTN=R14;                    /* SAVE THE RETURN ADDRESS.      */ 04926000
         ST    R14,LEV4RTN(,PVTPTR)                                1292 04927000
*   RESPECIFY                                                      1293 04928000
*    (R14) UNRESTRICTED;                                           1293 04929000
*   IF BEGPTR->SPCTEXT=0 THEN       /* TEST IF AN EXTENSION ALREADY     04930000
*                                      EXISTS.                       */ 04931000
         L     @15,SPCTEXT(,BEGPTR)                                1294 04932000
         LTR   @15,@15                                             1294 04933000
         BNZ   @RF01294                                            1294 04934000
*     DO;                           /* AN EXTENSION DOES NOT EXIST,     04935000
*                                      SO ONE MUST BE GETMAINED.     */ 04936000
*       TEMPSAVE=R1;                /* SAVE REG 1 ACROSS GETMAIN.    */ 04937000
         ST    R1,TEMPSAVE(,PVTPTR)                                1296 04938000
*       REG7SAVE=R7;                /* SAVE REG 7 OVER GETMAIN.      */ 04939000
         ST    R7,REG7SAVE(,PVTPTR)                                1297 04940000
*       R0=LENGTH(SPCTEXTM);        /* GET THE LENGTH OF AN EXTENSION*/ 04941000
         LA    R0,56                                               1298 04942000
*       R1=0;                       /* ZERO FOR GETMAIN.             */ 04943000
         SLR   R1,R1                                               1299 04944000
*       REG4SAVE=R4;                /* SAVE R4 OVER GETMAIN          */ 04945000
         L     @15,CALLER13(,PVTPTR)                               1300 04946000
         ST    R4,REG4SAVE(,@15)                                   1300 04947000
*       R4=0;                       /* SQA REQUEST DOES NOT NEED A 1301 04948000
*                                      TCB.                          */ 04949000
         SLR   R4,R4                                               1301 04950000
*       R7=ASCBPTR;                 /* ASCB IS THIS ASCB             */ 04951000
         L     R7,ASCBPTR                                          1302 04952000
*/********************************************************************/ 04953000
*/*                                                                  */ 04954000
*/*                     GETMAIN AN NEW EXTENSION.                    */ 04955000
*/*                   INPUT:                                         */ 04956000
*/*              R0: LENGTH OF THE EXTENSION                         */ 04957000
*/*              R1: ZERO                                            */ 04958000
*/*              R2: UNUSED                                          */ 04959000
*/*              R3: LOADED BY THE MACRO                             */ 04960000
*/*              R4: ZERO                                            */ 04961000
*/*              R5 - R6: UNUSED                                     */ 04962000
*/*              R7: ADDRESS OF THE ASCB                             */ 04963000
*/*              R8 - R13: UNUSED                                    */ 04964000
*/*              R14: RETURN ADDRESS LOADED BY MACRO                 */ 04965000
*/*              R15: ENTRY POINT ADDRESS LOADED BY MACRO            */ 04966000
*/*                   OUTPUT:                                        */ 04967000
*/*              R0: RESTORED                                        */ 04968000
*/*              R1: ADDRESS OF THE NEW EXTENSION                    */ 04969000
*/*              R2 - R14: RESTORED                                  */ 04970000
*/*              R15: RETURN CODE                                    */ 04971000
*/*                     0 - SUCCESSFUL                               */ 04972000
*/*                     NON-0 - UNSUCCESSFUL                         */ 04973000
*/*                                                                  */ 04974000
*/********************************************************************/ 04975000
*                                                                  1303 04976000
*       GENERATE REFS(R0,R1,R4,R7,R14,R15) SETS(R0,R1,R4,R7,R14,R15)    04977000
*           CODE;                                                  1303 04978000
GETCORE  GETMAIN RC,LV=(0),SP=245,BRANCH=YES,                         **04979000
               RELATED=(SPCT-EXT,IEAVSOUT(FREECORE))                    04980000
*       RESPECIFY                                                  1304 04981000
*        (R15) RSTD;                                               1304 04982000
*       PVTPTR=CVTPVTP;             /* RESTORE THE PVT POINTER.      */ 04983000
         L     @14,CVTPTR                                          1305 04984000
         L     PVTPTR,CVTPVTP(,@14)                                1305 04985000
*       PVTPRCA=SAVERCA;            /* RESTORE THE RCA ADDRESS.      */ 04986000
         L     @14,CALLER13(,PVTPTR)                               1306 04987000
         MVC   PVTPRCA(4,PVTPTR),SAVERCA(@14)                      1306 04988000
*       R4=REG4SAVE;                /* RESTOR REGISTER 4             */ 04989000
         L     R4,REG4SAVE(,@14)                                   1307 04990000
*       R7=REG7SAVE;                /* RESTORE REG 7.                */ 04991000
         L     R7,REG7SAVE(,PVTPTR)                                1308 04992000
*       IF R15^=0 THEN              /* TEST FOR A BAD RETURN CODE.   */ 04993000
         LTR   R15,R15                                             1309 04994000
         BZ    @RF01309                                            1309 04995000
*         DO;                       /* RETURN CODE IS BAD. STOP THE     04996000
*                                      SWAP OUT, BUT IT CAN BE TRIED    04997000
*                                      AGAIN LATER.                  */ 04998000
*           R0='05'X;               /* RECORD GETMAIN FAILURE        */ 04999000
         LA    R0,5                                                1311 05000000
*           CALL DOABEND;           /* RECORD THE ERROR              */ 05001000
         BAL   @14,DOABEND                                         1312 05002000
*           IF PURGDON='0'B THEN    /* HAS PAGING BEEN PURGED        */ 05003000
         TM    PURGDON(PVTPTR),B'00001000'                         1313 05004000
         BNZ   @RF01313                                            1313 05005000
*             RETURN TO CLEANUP1;   /* ABORT SWAPOUT                 */ 05006000
         LA    @14,CLEANUP1                                        1314 05007000
@EL00011 DS    0H                                                  1314 05008000
@EF00011 DS    0H                                                  1314 05009000
@ER00011 BR    @14                                                 1314 05010000
*           RETNCODE=TRYLATER;      /* SET CALLERS RETURN CODE TO  1315 05011000
*                                      STOP SWAP OUT AND TRY AGAIN 1315 05012000
*                                      LATER.                        */ 05013000
@RF01313 MVC   RETNCODE(4,PVTPTR),@CF00057                         1315 05014000
*           GOTO EXITEXT;           /* GO TO THE EXIT POINT.         */ 05015000
         B     EXITEXT                                             1316 05016000
*         END;                                                     1317 05017000
*       RESPECIFY                                                  1318 05018000
*        (R15) UNRESTRICTED;                                       1318 05019000
@RF01309 DS    0H                                                  1319 05020000
*       SWAPPTR=R1;                 /* GET THE ADDRESS OF THE NEW  1319 05021000
*                                      EXTENSION.                    */ 05022000
         LR    SWAPPTR,R1                                          1319 05023000
*       SWAPPTR->SPCTEXTM=SWAPPTR->SPCTEXTM&&SWAPPTR->SPCTEXTM;/*  1320 05024000
*                                      CLEAR ENTIRE NEW EXTENSION  1320 05025000
*                                                            @YM03600*/ 05026000
         XC    SPCTEXTM(56,SWAPPTR),SPCTEXTM(SWAPPTR)              1320 05027000
*       R1=TEMPSAVE;                /* RESTORE REG 1.                */ 05028000
         L     R1,TEMPSAVE(,PVTPTR)                                1321 05029000
*       BEGPTR->SPCTEXT=SWAPPTR;    /* CHAIN THE PREVIOUS EXTENSION     05030000
*                                      TO POINT TO THE NEW EXTENSION.*/ 05031000
         ST    SWAPPTR,SPCTEXT(,BEGPTR)                            1322 05032000
*     END;                          /* END OF GETMAIN PROCESSING.    */ 05033000
*   ELSE                            /* AN UNUSED EXTENSION ALREADY 1324 05034000
*                                      EXISTS AND CAN BE USED.       */ 05035000
*     DO;                           /*                       @YM03600*/ 05036000
         B     @RC01294                                            1324 05037000
@RF01294 DS    0H                                                  1325 05038000
*       SWAPPTR=BEGPTR->SPCTEXT;    /* GET THE ADDRESS OF THE UNUSED    05039000
*                                      EXTENSION.                    */ 05040000
         L     SWAPPTR,SPCTEXT(,BEGPTR)                            1325 05041000
*       SWAPPTR->SPCTENT=SWAPPTR->SPCTENT&&SWAPPTR->SPCTENT;/* ZERO     05042000
*                                      THE NEW EXTENSION. MAKE SURE     05043000
*                                      THAT ONLY THE ENTRY PART IS 1326 05044000
*                                      ZEROED. AN OLD EXTENSION MAY     05045000
*                                      HAVE THE ADDRESS OF ANOTHER 1326 05046000
*                                      EXTENSION.                    */ 05047000
         XC    SPCTENT(48,SWAPPTR),SPCTENT(SWAPPTR)                1326 05048000
*     END;                          /*                       @YM03600*/ 05049000
*   BEGEXT=SWAPPTR;                 /* SAVE THE BEGINNING ADDRESS OF    05050000
*                                      THE NEW LAST EXTENSION.       */ 05051000
@RC01294 ST    SWAPPTR,BEGEXT(,PVTPTR)                             1328 05052000
*   BEGPTR=SWAPPTR;                 /* LOAD SAME ADDRESS INTO A    1329 05053000
*                                      REGISTER FOR WORK.            */ 05054000
         LR    BEGPTR,SWAPPTR                                      1329 05055000
*   ENDPTR=SWAPPTR+LENGTH(SPCTEXTM);/* GET THE END ADDRESS OF THE NEW   05056000
*                                      LAST EXTENSION IN A REGISTER. */ 05057000
         LA    ENDPTR,56                                           1330 05058000
         ALR   ENDPTR,SWAPPTR                                      1330 05059000
*   SWAPPTR=SWAPPTR+(LENGTH(SPCTEXTM)-LENGTH(SPCTENT));/* GET THE  1331 05060000
*                                      ADDRESS OF THE FIRST AVAILABLE   05061000
*                                      ENTRY IN THE NEW EXTENSION.   */ 05062000
*                                                                  1331 05063000
         AL    SWAPPTR,@CF00057                                    1331 05064000
*   /*****************************************************************/ 05065000
*   /*                                                               */ 05066000
*   /* EXIT GET EXTENSION PROCESSOR                                  */ 05067000
*   /*                                                               */ 05068000
*   /*****************************************************************/ 05069000
*                                                                  1332 05070000
*EXITEXT:                                                          1332 05071000
*   RESPECIFY                                                      1332 05072000
*    (R14) RESTRICTED;                                             1332 05073000
EXITEXT  DS    0H                                                  1333 05074000
*   R14=LEV4RTN;                    /* GET THE RETURN ADDRESS.       */ 05075000
         L     R14,LEV4RTN(,PVTPTR)                                1333 05076000
*   RESPECIFY                                                      1334 05077000
*    (R1,                                                          1334 05078000
*     R4,                                                          1334 05079000
*     SWAPPTR,                                                     1334 05080000
*     PFTEPTR,                                                     1334 05081000
*     BEGPTR,                                                      1334 05082000
*     ENDPTR,                                                      1334 05083000
*     R14) UNRESTRICTED;                                           1334 05084000
*   END GETEXT;                                                    1335 05085000
         B     @EL00011                                            1335 05086000
*                                                                  1336 05087000
*   /*****************************************************************/ 05088000
*   /*                                                               */ 05089000
*   /* THIS SECTION RECORDS AN ERROR DETECTED BY THE SWAP OUT        */ 05090000
*   /* PROCESSOR                                                     */ 05091000
*   /*                                                               */ 05092000
*   /*****************************************************************/ 05093000
*                                                                  1336 05094000
*DOABEND:                                                          1336 05095000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               1336 05096000
DOABEND  DS    0H                                                  1337 05097000
*   RESPECIFY                                                      1337 05098000
*    (R1,                                                          1337 05099000
*     R4,                                                          1337 05100000
*     R5,                                                          1337 05101000
*     R6,                                                          1337 05102000
*     R11,                                                         1337 05103000
*     R12,                                                         1337 05104000
*     R14) RESTRICTED;                                             1337 05105000
*   R1=PVTPRCA;                     /* GET THE RCA ADDRESS.          */ 05106000
         L     R1,PVTPRCA(,PVTPTR)                                 1338 05107000
*   R1->RCARCRD=R0;                 /* SET THE REASON CODE: RECORD 1339 05108000
*                                      ONLY.                         */ 05109000
         STC   R0,RCARCRD(,R1)                                     1339 05110000
*   GENERATE CODE SETS(R1);                                        1340 05111000
         ABEND X'C0D',,,SYSTEM      RECORD THE ERROR                    05112000
*   RESPECIFY                                                      1341 05113000
*    (R1,                                                          1341 05114000
*     R4,                                                          1341 05115000
*     R5,                                                          1341 05116000
*     R6,                                                          1341 05117000
*     R11,                                                         1341 05118000
*     R12,                                                         1341 05119000
*     R14) RESTRICTED;                                             1341 05120000
*   END DOABEND;                                                   1342 05121000
@EL00012 DS    0H                                                  1342 05122000
@EF00012 DS    0H                                                  1342 05123000
@ER00012 BR    @14                                                 1342 05124000
@PB00012 DS    0H                                                  1342 05125000
*   END IEAVSOUT                                                   1343 05126000
*                                                                  1343 05127000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 05128000
*/*%INCLUDE SYSLIB  (IHAASCB )                                       */ 05129000
*/*%INCLUDE SYSLIB  (IHAASVT )                                       */ 05130000
*/*%INCLUDE SYSLIB  (IHAASXB )                                       */ 05131000
*/*%INCLUDE SYSLIB  (IHAWSAVT)                                       */ 05132000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 05133000
*/*%INCLUDE SYSLIB  (IHAFOE  )                                       */ 05134000
*/*%INCLUDE SYSLIB  (IHAFRRS )                                       */ 05135000
*/*%INCLUDE SYSLIB  (IHAOUXB )                                       */ 05136000
*/*%INCLUDE SYSLIB  (IHAPCB  )                                       */ 05137000
*/*%INCLUDE SYSLIB  (IHAPCBR )                                       */ 05138000
*/*%INCLUDE SYSLIB  (IHAPFTE )                                       */ 05139000
*/*%INCLUDE SYSLIB  (IHAPGTE )                                       */ 05140000
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */ 05141000
*/*%INCLUDE SYSLIB  (IHAPVT  )                                       */ 05142000
*/*%INCLUDE SYSLIB  (IHARCA  )                                       */ 05143000
*/*%INCLUDE SYSLIB  (IHARSMHD)                                       */ 05144000
*/*%INCLUDE SYSLIB  (IHASCVT )                                       */ 05145000
*/*%INCLUDE SYSLIB  (IHASPCT )                                       */ 05146000
*/*%INCLUDE SYSLIB  (IHASRB  )                                       */ 05147000
*/*%INCLUDE SYSLIB  (IHAXPTE )                                       */ 05148000
*/*%INCLUDE SYSLIB  (IKJTCB  )                                       */ 05149000
*/*%INCLUDE SYSLIB  (ILRAIA  )                                       */ 05150000
*                                                                  1343 05151000
*       ;                                                          1343 05152000
@DATA    DS    0H                                                       05153000
@DATD    DSECT                                                          05154000
         DS    0F                                                       05155000
IEAVSOUT CSECT                                                          05156000
         DS    0F                                                       05157000
@CF00064 DC    F'1'                                                     05158000
@CF00039 DC    F'4'                                                     05159000
@CF00970 DC    F'6'                                                     05160000
@CF00057 DC    F'8'                                                     05161000
@CF02696 DC    F'-48'                                                   05162000
@CF02502 DC    XL4'80000000'                                            05163000
@CF02506 DC    XL4'0000000F'                                            05164000
@CF02704 DC    XL4'0000FFFF'                                            05165000
@DATD    DSECT                                                          05166000
         DS    0D                                                       05167000
@ENDDATD EQU   *                                                        05168000
IEAVSOUT CSECT                                                          05169000
         NOPR  ((@ENDDATD-@DATD)*16)                                    05170000
         DS    0F                                                       05171000
@SIZDATD DC    AL1(0)                                                   05172000
         DC    AL3(@ENDDATD-@DATD)                                      05173000
@CV02498 DC    V(IEAVSSNQ)                                              05174000
         DS    0D                                                       05175000
SOUTENTR DC    XL4'00001000'                                            05176000
@CC02532 DC    C'SRB '                                                  05177000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       05178000
@01      EQU   01                                                       05179000
@02      EQU   02                                                       05180000
@03      EQU   03                                                       05181000
@04      EQU   04                                                       05182000
@05      EQU   05                                                       05183000
@06      EQU   06                                                       05184000
@07      EQU   07                                                       05185000
@08      EQU   08                                                       05186000
@09      EQU   09                                                       05187000
@10      EQU   10                                                       05188000
@11      EQU   11                                                       05189000
@12      EQU   12                                                       05190000
@13      EQU   13                                                       05191000
@14      EQU   14                                                       05192000
@15      EQU   15                                                       05193000
FOEPTR   EQU   @13                                                      05194000
PCBPTR   EQU   @07                                                      05195000
PCBRPTR  EQU   @13                                                      05196000
PFTEPTR  EQU   @11                                                      05197000
PTEPTR   EQU   @01                                                      05198000
PVTPTR   EQU   @03                                                      05199000
RSMHDPTR EQU   @02                                                      05200000
SPCTPTR  EQU   @08                                                      05201000
SWAPPTR  EQU   @12                                                      05202000
SRBPTR   EQU   @01                                                      05203000
XPTEPTR  EQU   @01                                                      05204000
TCBPTR   EQU   @04                                                      05205000
R0       EQU   @00                                                      05206000
R1       EQU   @01                                                      05207000
LRAREG   EQU   @01                                                      05208000
R2       EQU   @02                                                      05209000
R4       EQU   @04                                                      05210000
R5       EQU   @05                                                      05211000
BEGPTR   EQU   @05                                                      05212000
R6       EQU   @06                                                      05213000
ENDPTR   EQU   @06                                                      05214000
SAVEEXT  EQU   @06                                                      05215000
R7       EQU   @07                                                      05216000
BASEREG2 EQU   @09                                                      05217000
BASEREG  EQU   @10                                                      05218000
R11      EQU   @11                                                      05219000
R12      EQU   @12                                                      05220000
R13      EQU   @13                                                      05221000
R14      EQU   @14                                                      05222000
R15      EQU   @15                                                      05223000
R10      EQU   @10                                                      05224000
R3       EQU   @03                                                      05225000
R8       EQU   @08                                                      05226000
R9       EQU   @09                                                      05227000
PSA      EQU   0                                                        05228000
FLCRNPSW EQU   PSA                                                      05229000
FLCROPSW EQU   PSA+8                                                    05230000
FLCICCW2 EQU   PSA+16                                                   05231000
FLCCVT   EQU   FLCICCW2                                                 05232000
PSAEEPSW EQU   PSA+132                                                  05233000
PSAESPSW EQU   PSA+136                                                  05234000
FLCSVILC EQU   PSAESPSW+1                                               05235000
PSAEPPSW EQU   PSA+140                                                  05236000
FLCPIILC EQU   PSAEPPSW+1                                               05237000
FLCPICOD EQU   PSAEPPSW+2                                               05238000
PSAPICOD EQU   FLCPICOD+1                                               05239000
FLCTEA   EQU   PSAEPPSW+4                                               05240000
FLCPER   EQU   PSA+152                                                  05241000
FLCMCLA  EQU   PSA+168                                                  05242000
FLCIOEL  EQU   FLCMCLA+4                                                05243000
FLCIOA   EQU   FLCMCLA+16                                               05244000
FLCFSA   EQU   FLCMCLA+80                                               05245000
PSAAOLD  EQU   PSA+548                                                  05246000
PSASUPER EQU   PSA+552                                                  05247000
PSASUP1  EQU   PSASUPER                                                 05248000
PSASUP2  EQU   PSASUPER+1                                               05249000
PSASUP3  EQU   PSASUPER+2                                               05250000
PSASUP4  EQU   PSASUPER+3                                               05251000
PSACLHT  EQU   PSA+640                                                  05252000
PSALKSA  EQU   PSA+696                                                  05253000
PSAHLHI  EQU   PSA+760                                                  05254000
PSALITA  EQU   PSA+764                                                  05255000
PSADSSFL EQU   PSA+836                                                  05256000
PSADSSF1 EQU   PSADSSFL                                                 05257000
PSADSSF3 EQU   PSADSSFL+2                                               05258000
PSADSSF4 EQU   PSADSSFL+3                                               05259000
PSARSVT  EQU   PSA+896                                                  05260000
ASCB     EQU   0                                                        05261000
ASCBSUPC EQU   ASCB+16                                                  05262000
ASCBASID EQU   ASCB+36                                                  05263000
ASCBRSM  EQU   ASCB+52                                                  05264000
ASCBRSMF EQU   ASCBRSM                                                  05265000
ASCBFW1  EQU   ASCB+100                                                 05266000
ASCBRCTF EQU   ASCBFW1+2                                                05267000
ASCBFLG1 EQU   ASCBFW1+3                                                05268000
ASCBTERM EQU   ASCBFLG1                                                 05269000
ASCBASXB EQU   ASCB+108                                                 05270000
ASCBDSP1 EQU   ASCB+114                                                 05271000
ASCBFLG2 EQU   ASCB+115                                                 05272000
ASCBLKGP EQU   ASCB+128                                                 05273000
ASCBOUXB EQU   ASCB+148                                                 05274000
ASCBFMCT EQU   ASCB+152                                                 05275000
ASCBSRQ  EQU   ASCB+180                                                 05276000
ASCBSRQ1 EQU   ASCBSRQ                                                  05277000
ASCBSRQ2 EQU   ASCBSRQ+1                                                05278000
ASCBSRQ3 EQU   ASCBSRQ+2                                                05279000
ASCBSRQ4 EQU   ASCBSRQ+3                                                05280000
ASVT     EQU   0                                                        05281000
ASVTFRST EQU   ASVT+524                                                 05282000
ASVTENTY EQU   ASVT+528                                                 05283000
ASXB     EQU   0                                                        05284000
ASXBFTCB EQU   ASXB+4                                                   05285000
ASXBSPSA EQU   ASXB+112                                                 05286000
ASXBAEQ  EQU   ASXB+168                                                 05287000
ASXBSECR EQU   ASXB+199                                                 05288000
ASCBSFLG EQU   ASXBSECR                                                 05289000
ASXBCASW EQU   ASXB+216                                                 05290000
ASXBCRB1 EQU   ASXBCASW                                                 05291000
WSAL     EQU   0                                                        05292000
WSALRSM  EQU   WSAL+52                                                  05293000
CVTMAP   EQU   0                                                        05294000
CVT      EQU   CVTMAP                                                   05295000
CVTDAR   EQU   CVTMAP+72                                                05296000
CVTFLGS1 EQU   CVTDAR                                                   05297000
CVTDCB   EQU   CVTMAP+116                                               05298000
CVTIOQET EQU   CVTMAP+120                                               05299000
CVTIERLC EQU   CVTMAP+144                                               05300000
CVTHEAD  EQU   CVTMAP+160                                               05301000
CVTSV76C EQU   CVTHEAD                                                  05302000
CVTOPTA  EQU   CVTMAP+182                                               05303000
CVTOPTB  EQU   CVTMAP+183                                               05304000
CVTABEND EQU   CVTMAP+200                                               05305000
CVTGTF   EQU   CVTMAP+236                                               05306000
CVTGTFST EQU   CVTGTF                                                   05307000
CVTGTFS  EQU   CVTGTFST                                                 05308000
CVTSTATE EQU   CVTGTFST                                                 05309000
CVTTMODE EQU   CVTGTFST                                                 05310000
CVTFORM  EQU   CVTGTFST                                                 05311000
CVTAQAVT EQU   CVTMAP+240                                               05312000
CVTTCMFG EQU   CVTAQAVT                                                 05313000
CVTVOLM2 EQU   CVTMAP+244                                               05314000
CVTTATA  EQU   CVTVOLM2                                                 05315000
CVTTSKS  EQU   CVTTATA                                                  05316000
CVTVOLF2 EQU   CVTTSKS                                                  05317000
CVTTAT   EQU   CVTTATA+1                                                05318000
CVTATER  EQU   CVTMAP+248                                               05319000
CVTEXT1  EQU   CVTMAP+252                                               05320000
CVTPURG  EQU   CVTMAP+260                                               05321000
CVTQMSG  EQU   CVTMAP+268                                               05322000
CVTDMSR  EQU   CVTMAP+272                                               05323000
CVTRSV37 EQU   CVTDMSR                                                  05324000
CVTDMSRF EQU   CVTRSV37                                                 05325000
CVTERPV  EQU   CVTMAP+316                                               05326000
CVTINTLA EQU   CVTMAP+320                                               05327000
CVTAPF   EQU   CVTMAP+324                                               05328000
CVTEXT2  EQU   CVTMAP+328                                               05329000
CVTHJES  EQU   CVTMAP+332                                               05330000
CVTPGSIA EQU   CVTMAP+348                                               05331000
CVTA1F1  EQU   CVTMAP+356                                               05332000
CVTSYSK  EQU   CVTMAP+357                                               05333000
CVTVOLM1 EQU   CVTMAP+380                                               05334000
CVTVOLF1 EQU   CVTVOLM1                                                 05335000
CVTXTNT1 EQU   0                                                        05336000
CVTXTNT2 EQU   0                                                        05337000
CVTDSSV  EQU   CVTXTNT2                                                 05338000
CVTFLGBT EQU   CVTXTNT2+5                                               05339000
CVTQID   EQU   CVTXTNT2+24                                              05340000
CVTRV400 EQU   CVTXTNT2+52                                              05341000
CVTRV409 EQU   CVTXTNT2+53                                              05342000
CVTATCVT EQU   CVTXTNT2+64                                              05343000
CVTRV429 EQU   CVTXTNT2+84                                              05344000
CVTRV438 EQU   CVTXTNT2+85                                              05345000
CVTRV457 EQU   CVTXTNT2+112                                             05346000
CVTRV466 EQU   CVTXTNT2+113                                             05347000
CVTFIX   EQU   0                                                        05348000
CVTRELNO EQU   CVTFIX+252                                               05349000
FOE      EQU   0                                                        05350000
FOEFLNKF EQU   FOE                                                      05351000
FOEFLAG  EQU   FOEFLNKF                                                 05352000
FOEFLINK EQU   FOEFLNKF+1                                               05353000
FOEVINDX EQU   FOE+4                                                    05354000
FOEFXCT  EQU   FOE+6                                                    05355000
FRRS     EQU   0                                                        05356000
FRRSHEAD EQU   FRRS                                                     05357000
FRRSEMP  EQU   FRRSHEAD                                                 05358000
FRRSLAST EQU   FRRSHEAD+4                                               05359000
FRRSELEN EQU   FRRSHEAD+8                                               05360000
FRRSCURR EQU   FRRSHEAD+12                                              05361000
FRRSENTR EQU   0                                                        05362000
FRRSFRRA EQU   FRRSENTR                                                 05363000
FRRSFLGS EQU   FRRSENTR+4                                               05364000
FRRSFLG1 EQU   FRRSFLGS                                                 05365000
FRRSPARM EQU   FRRSENTR+8                                               05366000
OUXB     EQU   0                                                        05367000
OUXBSTC  EQU   OUXB+54                                                  05368000
PCB      EQU   0                                                        05369000
PCBFQP   EQU   PCB                                                      05370000
PCBFQPA  EQU   PCBFQP+1                                                 05371000
PCBBQP   EQU   PCB+4                                                    05372000
PCBBQPA  EQU   PCBBQP                                                   05373000
PCBRTP   EQU   PCB+8                                                    05374000
PCBFL1   EQU   PCBRTP                                                   05375000
PCBSRBMD EQU   PCBFL1                                                   05376000
PCBROOT  EQU   PCBFL1                                                   05377000
PCBIOI   EQU   PCBFL1                                                   05378000
PCBIOCMP EQU   PCBFL1                                                   05379000
PCBRTPA  EQU   PCBRTP+1                                                 05380000
PCBRLP   EQU   PCB+12                                                   05381000
PCBFXC   EQU   PCBRLP                                                   05382000
PCBRLPA  EQU   PCBRLP+1                                                 05383000
PCBXPT   EQU   PCB+16                                                   05384000
PCBFL2   EQU   PCBXPT                                                   05385000
PCBFREAL EQU   PCBFL2                                                   05386000
PCBIOERR EQU   PCBFL2                                                   05387000
PCBRESET EQU   PCBFL2                                                   05388000
PCBSUPRS EQU   PCBFL2                                                   05389000
PCBXPTA  EQU   PCBXPT+1                                                 05390000
PCBPGT   EQU   PCB+20                                                   05391000
PCBFL3   EQU   PCBPGT                                                   05392000
PCBSWPOT EQU   PCBFL3                                                   05393000
PCBPGTA  EQU   PCBPGT+1                                                 05394000
PCBRBN   EQU   PCB+24                                                   05395000
PCBVBN   EQU   PCB+26                                                   05396000
PCBBLOCK EQU   PCB+28                                                   05397000
PCBSRB   EQU   PCBBLOCK                                                 05398000
PCBRB    EQU   PCBSRB                                                   05399000
PCBSPCTE EQU   PCBRB                                                    05400000
PCBASCB  EQU   PCB+32                                                   05401000
PCBAIA   EQU   PCB+36                                                   05402000
PCBR     EQU   0                                                        05403000
PCBRTCB  EQU   PCBR                                                     05404000
PCBRFLAG EQU   PCBRTCB                                                  05405000
PCBRFAIL EQU   PCBRFLAG                                                 05406000
PCBRTCBA EQU   PCBRTCB+1                                                05407000
PCBRGOTO EQU   PCBR+4                                                   05408000
PCBRECB  EQU   PCBR+8                                                   05409000
PCBRCNT  EQU   PCBR+16                                                  05410000
PFTE     EQU   0                                                        05411000
PFTPGID  EQU   PFTE                                                     05412000
PFTVBN   EQU   PFTPGID+2                                                05413000
PFTQPTRS EQU   PFTE+4                                                   05414000
PFTFQPTR EQU   PFTQPTRS                                                 05415000
PFTBQPTR EQU   PFTQPTRS+2                                               05416000
PFTFXCT  EQU   PFTE+8                                                   05417000
PFTFLAGS EQU   PFTE+12                                                  05418000
PFTFLAG1 EQU   PFTFLAGS                                                 05419000
PFTLSQA  EQU   PFTFLAG1                                                 05420000
PFTVRPLT EQU   PFTFLAG1                                                 05421000
PFTPCBSI EQU   PFTFLAG1                                                 05422000
PFTBADPG EQU   PFTFLAG1                                                 05423000
PFTFLAG2 EQU   PFTFLAGS+1                                               05424000
PFTDFRLS EQU   PFTFLAG2                                                 05425000
PFTIRRG  EQU   PFTFLAG2                                                 05426000
PFTPREF  EQU   PFTFLAG2                                                 05427000
PFTUIC   EQU   PFTE+15                                                  05428000
PGTPTE   EQU   0                                                        05429000
PGTRSA   EQU   PGTPTE                                                   05430000
PGTBITS  EQU   PGTRSA+1                                                 05431000
PGTPVM   EQU   PGTBITS                                                  05432000
PVT      EQU   0                                                        05433000
PVTFLAG1 EQU   PVT                                                      05434000
PVTFLAG2 EQU   PVT+1                                                    05435000
PVTPFTP  EQU   PVT+12                                                   05436000
PVTLCSA  EQU   PVT+26                                                   05437000
PVTPRCA  EQU   PVT+52                                                   05438000
PVTPCB   EQU   PVT+104                                                  05439000
PVTPFTE  EQU   PVT+108                                                  05440000
PVTPFP2  EQU   PVT+116                                                  05441000
PVTPPIOI EQU   PVT+128                                                  05442000
PVTPRCV  EQU   PVT+156                                                  05443000
PVTPSWPC EQU   PVT+168                                                  05444000
PVTPSRBP EQU   PVT+188                                                  05445000
PVTPRELF EQU   PVT+216                                                  05446000
PVTPOPBR EQU   PVT+220                                                  05447000
PVTPAGIO EQU   PVT+236                                                  05448000
PVTPRSET EQU   PVT+244                                                  05449000
PVTSPFR  EQU   PVT+302                                                  05450000
PVTQS    EQU   PVT+304                                                  05451000
PVTWSAX  EQU   PVT+344                                                  05452000
PVTWSA15 EQU   PVTWSAX+1040                                             05453000
PVTSAVE  EQU   PVTWSAX+1328                                             05454000
PVTCNTFX EQU   PVT+1830                                                 05455000
PVTCOMFX EQU   PVT+1834                                                 05456000
PVTPCBQS EQU   PVT+1852                                                 05457000
PVTGFADL EQU   PVTPCBQS+28                                              05458000
PVTCIOQL EQU   PVTPCBQS+36                                              05459000
RCA      EQU   0                                                        05460000
RCANAME7 EQU   RCA+8                                                    05461000
RCACSECT EQU   RCA+9                                                    05462000
RCAFLAGS EQU   RCA+10                                                   05463000
RCASAL   EQU   RCAFLAGS                                                 05464000
RCARCRD  EQU   RCA+11                                                   05465000
RCANAMES EQU   RCA+12                                                   05466000
RCANAME1 EQU   RCANAMES                                                 05467000
RCANAME2 EQU   RCANAMES+1                                               05468000
RCANAME3 EQU   RCANAMES+2                                               05469000
RCANAME4 EQU   RCANAMES+3                                               05470000
RCASOUT  EQU   RCANAME4                                                 05471000
RCANAME5 EQU   RCANAMES+4                                               05472000
RCANAME6 EQU   RCANAMES+5                                               05473000
RSMHD    EQU   0                                                        05474000
RSMSPCT  EQU   RSMHD+4                                                  05475000
RSMFLG1  EQU   RSMHD+12                                                 05476000
RSMCPNU  EQU   RSMFLG1                                                  05477000
RSMCPNC  EQU   RSMFLG1                                                  05478000
RSMRSV1  EQU   RSMHD+13                                                 05479000
RSMCNTFX EQU   RSMHD+14                                                 05480000
RSMQS    EQU   RSMHD+20                                                 05481000
RSMLFQ   EQU   RSMQS                                                    05482000
RSMLFQF  EQU   RSMLFQ                                                   05483000
RSMLSQA  EQU   RSMQS+4                                                  05484000
RSMLSQAF EQU   RSMLSQA                                                  05485000
RSMLIOQ  EQU   RSMQS+8                                                  05486000
RSMLIOQL EQU   RSMLIOQ+4                                                05487000
SCVTSECT EQU   0                                                        05488000
SCVTSTAT EQU   SCVTSECT+148                                             05489000
SPCT     EQU   0                                                        05490000
SPCTSWRT EQU   SPCT                                                     05491000
SPCTFIX  EQU   SPCT+4                                                   05492000
SPCTLSQA EQU   SPCT+6                                                   05493000
SPCTSSEG EQU   SPCT+9                                                   05494000
SPCTFLG1 EQU   SPCT+10                                                  05495000
SPCTSWIN EQU   SPCTFLG1                                                 05496000
SPCTOUT  EQU   SPCTFLG1                                                 05497000
SPCTPURG EQU   SPCTFLG1                                                 05498000
SPCTPSET EQU   SPCTFLG1                                                 05499000
SPCTWSSZ EQU   SPCT+12                                                  05500000
SPCTSWAP EQU   SPCT+16                                                  05501000
SPCTSEGS EQU   SPCT+72                                                  05502000
SPCTSEGE EQU   0                                                        05503000
SPCTSEGX EQU   SPCTSEGE                                                 05504000
SPCTBITM EQU   SPCTSEGE+4                                               05505000
SEGSPTR  EQU   0                                                        05506000
SPCTSWPE EQU   0                                                        05507000
SPCTLS   EQU   SPCTSWPE                                                 05508000
SPCTFLAG EQU   SPCTLS                                                   05509000
SPCTLVAL EQU   SPCTFLAG                                                 05510000
SPCTLSQ  EQU   SPCTFLAG                                                 05511000
SPCTCOMM EQU   SPCTFLAG                                                 05512000
SPCTDEFR EQU   SPCTFLAG                                                 05513000
SPCTSSID EQU   SPCTLS+1                                                 05514000
SPCTVBN  EQU   SPCTLS+4                                                 05515000
SPCTFIXC EQU   SPCTSWPE+6                                               05516000
SPCTEXTM EQU   0                                                        05517000
SPCTEXT  EQU   SPCTEXTM                                                 05518000
SPCTENT  EQU   SPCTEXTM+8                                               05519000
SRBSECT  EQU   0                                                        05520000
SRB      EQU   SRBSECT                                                  05521000
SRBID    EQU   SRB                                                      05522000
SRBFLNK  EQU   SRB+4                                                    05523000
SRBASCB  EQU   SRB+8                                                    05524000
SRBFLC   EQU   SRB+12                                                   05525000
SRBPASID EQU   SRBFLC+2                                                 05526000
SRBEP    EQU   SRB+20                                                   05527000
SRBRMTR  EQU   SRB+24                                                   05528000
SRBPARM  EQU   SRB+28                                                   05529000
SRBPRIOR EQU   SRB+37                                                   05530000
XPTE     EQU   0                                                        05531000
XPTPROT  EQU   XPTE                                                     05532000
XPTFLAGS EQU   XPTE+2                                                   05533000
XPTVIOLP EQU   XPTFLAGS                                                 05534000
XPTXAV   EQU   XPTFLAGS                                                 05535000
XPTVIO   EQU   XPTFLAGS                                                 05536000
XPTDEFER EQU   XPTFLAGS                                                 05537000
XPTFLAG2 EQU   XPTE+3                                                   05538000
XPTLPID  EQU   XPTE+4                                                   05539000
XPTLGN   EQU   XPTLPID                                                  05540000
XPTLPN   EQU   XPTLPID+4                                                05541000
TCBFIX   EQU   0                                                        05542000
TCBFRS   EQU   TCBFIX                                                   05543000
TCB      EQU   0                                                        05544000
TCBPIE   EQU   TCB+4                                                    05545000
TCBPMASK EQU   TCBPIE                                                   05546000
TCBCMP   EQU   TCB+16                                                   05547000
TCBCMPF  EQU   TCBCMP                                                   05548000
TCBCPP   EQU   TCBCMPF                                                  05549000
TCBSTCC  EQU   TCBCMPF                                                  05550000
TCBCDBL  EQU   TCBCMPF                                                  05551000
TCBCWTO  EQU   TCBCMPF                                                  05552000
TCBCIND  EQU   TCBCMPF                                                  05553000
TCBCMSG  EQU   TCBCMPF                                                  05554000
TCBTRN   EQU   TCB+20                                                   05555000
TCBABF   EQU   TCBTRN                                                   05556000
TCBMSS   EQU   TCB+24                                                   05557000
TCBPKF   EQU   TCB+28                                                   05558000
TCBFLGS  EQU   TCB+29                                                   05559000
TCBFLGS1 EQU   TCBFLGS                                                  05560000
TCBFLGS2 EQU   TCBFLGS+1                                                05561000
TCBFLGS3 EQU   TCBFLGS+2                                                05562000
TCBFLGS4 EQU   TCBFLGS+3                                                05563000
TCBFLGS5 EQU   TCBFLGS+4                                                05564000
TCBABWF  EQU   TCBFLGS5                                                 05565000
TCBJPQ   EQU   TCB+44                                                   05566000
TCBPURGE EQU   TCBJPQ                                                   05567000
TCBGRS   EQU   TCB+48                                                   05568000
TCBFSA   EQU   TCB+112                                                  05569000
TCBTCB   EQU   TCB+116                                                  05570000
TCBTME   EQU   TCB+120                                                  05571000
TCBJSTCB EQU   TCB+124                                                  05572000
TCBTSFLG EQU   TCB+148                                                  05573000
TCBTSTSK EQU   TCBTSFLG                                                 05574000
TCBSTAB  EQU   TCB+160                                                  05575000
TCBNSTAE EQU   TCBSTAB                                                  05576000
TCBTCT   EQU   TCB+164                                                  05577000
TCBTCTGF EQU   TCBTCT                                                   05578000
TCBSCNDY EQU   TCB+172                                                  05579000
TCBNDSP  EQU   TCBSCNDY                                                 05580000
TCBNDSP1 EQU   TCBNDSP+1                                                05581000
TCBNDSP2 EQU   TCBNDSP+2                                                05582000
TCBNDSP3 EQU   TCBNDSP+3                                                05583000
TCBJSCB  EQU   TCB+180                                                  05584000
TCBRECDE EQU   TCBJSCB                                                  05585000
TCBEXT1  EQU   TCB+196                                                  05586000
TCBBITS  EQU   TCB+200                                                  05587000
TCBNDSP4 EQU   TCBBITS                                                  05588000
TCBNDSP5 EQU   TCBBITS+1                                                05589000
TCBFLGS6 EQU   TCBBITS+2                                                05590000
TCBFLGS7 EQU   TCBBITS+3                                                05591000
TCBDAR   EQU   TCB+204                                                  05592000
TCBDARC  EQU   TCBDAR                                                   05593000
TCBEXT2  EQU   TCB+208                                                  05594000
TCBXSCT  EQU   TCB+240                                                  05595000
TCBXSCT1 EQU   TCBXSCT                                                  05596000
TCBFOE   EQU   TCB+244                                                  05597000
TCBFOEA  EQU   TCBFOE+1                                                 05598000
TCBESTAE EQU   TCB+264                                                  05599000
TCBESTRM EQU   TCBESTAE+1                                               05600000
TCBFBYT1 EQU   TCB+276                                                  05601000
TCBFBYT2 EQU   TCB+277                                                  05602000
TCBRV124 EQU   TCB+278                                                  05603000
TCBRV133 EQU   TCB+279                                                  05604000
TCBXTNT2 EQU   0                                                        05605000
TCBGTF   EQU   TCBXTNT2                                                 05606000
TCBTFLG  EQU   TCBGTF                                                   05607000
TCBRV146 EQU   TCBXTNT2+28                                              05608000
TCBRV155 EQU   TCBXTNT2+29                                              05609000
TCBRV164 EQU   TCBXTNT2+30                                              05610000
TCBRV173 EQU   TCBXTNT2+31                                              05611000
REGSAVER EQU   0                                                        05612000
SAVERCA  EQU   REGSAVER+8                                               05613000
REG4SAVE EQU   REGSAVER+12                                              05614000
SAVER15  EQU   REGSAVER+68                                              05615000
SOUTPARM EQU   0                                                        05616000
SOUTFLGS EQU   SOUTPARM+4                                               05617000
NLSQAPCB EQU   SOUTPARM+5                                               05618000
SRMPARMS EQU   SOUTPARM+8                                               05619000
SOUTWRKA EQU   SOUTPARM+16                                              05620000
LSQAPCBS EQU   SOUTWRKA+1                                               05621000
PIOISRB  EQU   SOUTPARM+20                                              05622000
ROOTEXIT EQU   0                                                        05623000
IEAVFP2  EQU   0                                                        05624000
IEAVPCB  EQU   0                                                        05625000
IEAVRSET EQU   0                                                        05626000
IEAVPFTE EQU   0                                                        05627000
IEAVOPBR EQU   0                                                        05628000
IEAVRELF EQU   0                                                        05629000
ILRPAGIO EQU   0                                                        05630000
IEAVSWPC EQU   0                                                        05631000
STATUS   EQU   0                                                        05632000
FOEEND   EQU   0                                                        05633000
PGTEND   EQU   0                                                        05634000
ASCBPTR  EQU   PSAAOLD                                                  05635000
CVTS01   EQU   CVTPGSIA                                                 05636000
CVTPVTP  EQU   CVTS01+8                                                 05637000
CVTLPDIA EQU   CVTS01+12                                                05638000
CVTDIRST EQU   CVTLPDIA                                                 05639000
CVTSLIDA EQU   CVTS01+24                                                05640000
CVTCTLFG EQU   CVTS01+50                                                05641000
CVTOPTE  EQU   CVTS01+188                                               05642000
CVTASVT  EQU   CVTS01+208                                               05643000
CVTGSMQ  EQU   CVTS01+264                                               05644000
CVTRV210 EQU   CVTS01+424                                               05645000
CVTRV219 EQU   CVTS01+425                                               05646000
CVTRV228 EQU   CVTS01+426                                               05647000
CVTRV237 EQU   CVTS01+427                                               05648000
CVTMFRTR EQU   CVTS01+452                                               05649000
CVTRV262 EQU   CVTS01+468                                               05650000
CVTRV271 EQU   CVTS01+469                                               05651000
CVTRV280 EQU   CVTS01+470                                               05652000
CVTRV289 EQU   CVTS01+471                                               05653000
CVTGSDA  EQU   CVTS01+600                                               05654000
ASVTPTR  EQU   CVTASVT                                                  05655000
ASXBPTR  EQU   ASCBASXB                                                 05656000
CVTPTR   EQU   FLCCVT                                                   05657000
OUXBPTR  EQU   ASCBOUXB                                                 05658000
FLC      EQU   PSA                                                      05659000
PSARSVTE EQU   PSARSVT                                                  05660000
PSACSTK  EQU   PSARSVTE                                                 05661000
RCAPTR   EQU   PVTPRCA                                                  05662000
FRPINCNT EQU   RSMRSV1                                                  05663000
SCVTSPTR EQU   CVTABEND                                                 05664000
RSMAIA   EQU   PCBAIA                                                   05665000
AIA      EQU   RSMAIA                                                   05666000
AIAFLG1  EQU   AIA+9                                                    05667000
AIAWRITE EQU   AIAFLG1                                                  05668000
AIAPRIV  EQU   AIAFLG1                                                  05669000
AIALSQA  EQU   AIAFLG1                                                  05670000
AIASWPFX EQU   AIAFLG1                                                  05671000
AIAFLG2  EQU   AIA+10                                                   05672000
AIAFLG3  EQU   AIA+11                                                   05673000
AIANXAIA EQU   AIA+12                                                   05674000
AIAID    EQU   AIA+16                                                   05675000
AIALPID  EQU   AIAID                                                    05676000
AIALGID  EQU   AIALPID                                                  05677000
AIALSID  EQU   AIALGID                                                  05678000
AIASSID  EQU   AIALSID+1                                                05679000
AIARPN   EQU   AIALPID+4                                                05680000
AIALSID2 EQU   AIARPN                                                   05681000
AIALPMEP EQU   AIALSID2                                                 05682000
AIAGRPSZ EQU   AIA+24                                                   05683000
AIALGE   EQU   AIAGRPSZ                                                 05684000
WORKAREA EQU   PVTWSA15                                                 05685000
@NM00096 EQU   WORKAREA                                                 05686000
FLAGS    EQU   @NM00096                                                 05687000
DOINGGFA EQU   FLAGS                                                    05688000
DOINGCOM EQU   FLAGS                                                    05689000
MASKFLG  EQU   FLAGS                                                    05690000
KEEPPCB  EQU   FLAGS                                                    05691000
PURGDON  EQU   FLAGS                                                    05692000
NOSPCTE  EQU   FLAGS                                                    05693000
FPCALLED EQU   FLAGS                                                    05694000
PTRPCBS  EQU   @NM00096+1                                               05695000
@NM00098 EQU   WORKAREA+4                                               05696000
ROOTCNT  EQU   @NM00098                                                 05697000
FMCTASCB EQU   @NM00098+2                                               05698000
PTRFIRST EQU   WORKAREA+8                                               05699000
PTRLAST  EQU   WORKAREA+12                                              05700000
FIXBEG   EQU   WORKAREA+16                                              05701000
BEGEXT   EQU   WORKAREA+20                                              05702000
LEV1RTN  EQU   WORKAREA+24                                              05703000
LEV2RTN  EQU   WORKAREA+28                                              05704000
LEV3RTN  EQU   WORKAREA+32                                              05705000
LEV4RTN  EQU   WORKAREA+36                                              05706000
NEXTPCB  EQU   WORKAREA+40                                              05707000
LASTRLT  EQU   WORKAREA+44                                              05708000
LSQAEXT  EQU   WORKAREA+48                                              05709000
REG7SAVE EQU   WORKAREA+52                                              05710000
TEMPSAVE EQU   WORKAREA+56                                              05711000
PAFIX    EQU   WORKAREA+60                                              05712000
RETNCODE EQU   WORKAREA+64                                              05713000
CALLER13 EQU   WORKAREA+68                                              05714000
AREAPCB  EQU   PCB                                                      05715000
AREA     EQU   AREAPCB+8                                                05716000
OPTLIST  EQU   SRMPARMS                                                 05717000
@NM00101 EQU   OPTLIST                                                  05718000
OPTSOUT  EQU   @NM00101                                                 05719000
OPTSIN   EQU   @NM00101+2                                               05720000
@NM00102 EQU   OPTLIST+4                                                05721000
OPTSPFR  EQU   @NM00102                                                 05722000
@NM00104 EQU   @NM00102+3                                               05723000
*                                      START UNREFERENCED COMPONENTS    05724000
OPTWAIT  EQU   @NM00104                                                 05725000
OPTOK    EQU   @NM00104                                                 05726000
@NM00105 EQU   @NM00104                                                 05727000
@NM00103 EQU   @NM00102+2                                               05728000
@NM00099 EQU   AREAPCB                                                  05729000
@NM00097 EQU   FLAGS                                                    05730000
AIADPXCT EQU   AIALGE                                                   05731000
AIACEPTR EQU   AIALPMEP                                                 05732000
AIASLOT  EQU   AIASSID+1                                                05733000
@NM00093 EQU   AIASSID                                                  05734000
@NM00092 EQU   AIALSID                                                  05735000
AIARCSN  EQU   AIANXAIA+2                                               05736000
AIACYL   EQU   AIANXAIA                                                 05737000
AIARSV9  EQU   AIAFLG3                                                  05738000
AIARSV8  EQU   AIAFLG3                                                  05739000
AIARSV7  EQU   AIAFLG3                                                  05740000
AIALPMEC EQU   AIAFLG3                                                  05741000
AIARSV6  EQU   AIAFLG3                                                  05742000
AIATRPSP EQU   AIAFLG3                                                  05743000
AIAPRINO EQU   AIAFLG3                                                  05744000
AIARSV5  EQU   AIAFLG3                                                  05745000
AIABADID EQU   AIAFLG2                                                  05746000
AIAERROR EQU   AIAFLG2                                                  05747000
AIASECER EQU   AIAFLG2                                                  05748000
AIAPRIER EQU   AIAFLG2                                                  05749000
AIARSV4  EQU   AIAFLG2                                                  05750000
AIAIORTY EQU   AIAFLG2                                                  05751000
AIATERMR EQU   AIAFLG2                                                  05752000
AIAFRAUX EQU   AIAFLG2                                                  05753000
AIARSV1  EQU   AIAFLG1                                                  05754000
AIAPAGDS EQU   AIAFLG1                                                  05755000
AIADUPLX EQU   AIAFLG1                                                  05756000
AIAVIO   EQU   AIAFLG1                                                  05757000
AIAOP    EQU   AIA+8                                                    05758000
AIABQPA  EQU   AIA+4                                                    05759000
AIAFQPA  EQU   AIA                                                      05760000
PSARSAV  EQU   PSARSVTE+60                                              05761000
PSARSTK  EQU   PSARSVTE+56                                              05762000
PSAESAV3 EQU   PSARSVTE+52                                              05763000
PSAESTK3 EQU   PSARSVTE+48                                              05764000
PSAESAV2 EQU   PSARSVTE+44                                              05765000
PSAESTK2 EQU   PSARSVTE+40                                              05766000
PSAESAV1 EQU   PSARSVTE+36                                              05767000
PSAESTK1 EQU   PSARSVTE+32                                              05768000
PSAPSAV  EQU   PSARSVTE+28                                              05769000
PSAPSTK  EQU   PSARSVTE+24                                              05770000
PSAMSAV  EQU   PSARSVTE+20                                              05771000
PSAMSTK  EQU   PSARSVTE+16                                              05772000
PSASSAV  EQU   PSARSVTE+12                                              05773000
PSASSTK  EQU   PSARSVTE+8                                               05774000
PSANSTK  EQU   PSARSVTE+4                                               05775000
CVTRV628 EQU   CVTS01+728                                               05776000
CVTRV627 EQU   CVTS01+724                                               05777000
CVTRV626 EQU   CVTS01+720                                               05778000
CVTRV625 EQU   CVTS01+716                                               05779000
CVTRV624 EQU   CVTS01+712                                               05780000
CVTRV623 EQU   CVTS01+708                                               05781000
CVTRV622 EQU   CVTS01+704                                               05782000
CVTRV621 EQU   CVTS01+700                                               05783000
CVTIHASU EQU   CVTS01+696                                               05784000
CVTSUSP  EQU   CVTS01+692                                               05785000
CVTT6SVC EQU   CVTS01+688                                               05786000
CVTCDAL  EQU   CVTS01+684                                               05787000
CVTTCTL  EQU   CVTS01+680                                               05788000
CVTRSUME EQU   CVTS01+676                                               05789000
CVTJTERM EQU   CVTS01+672                                               05790000
CVTASMRM EQU   CVTS01+668                                               05791000
CVTTCASP EQU   CVTS01+664                                               05792000
CVT0PT03 EQU   CVTS01+660                                               05793000
CVT0PT0E EQU   CVTS01+656                                               05794000
CVTRV609 EQU   CVTS01+652                                               05795000
CVTCGK   EQU   CVTS01+648                                               05796000
CVTRAC   EQU   CVTS01+644                                               05797000
CVTHSM   EQU   CVTS01+640                                               05798000
CVTRV605 EQU   CVTS01+636                                               05799000
CVTRV604 EQU   CVTS01+632                                               05800000
CVTEFF02 EQU   CVTS01+628                                               05801000
CVTCBBR  EQU   CVTS01+624                                               05802000
CVTSSCR  EQU   CVTS01+620                                               05803000
CVTEVENT EQU   CVTS01+616                                               05804000
CVTCRCA  EQU   CVTS01+612                                               05805000
CVTTPIO  EQU   CVTS01+608                                               05806000
CVTADV   EQU   CVTS01+604                                               05807000
CVTGSDAB EQU   CVTGSDA                                                  05808000
CVTQV3   EQU   CVTS01+596                                               05809000
CVTQV2   EQU   CVTS01+592                                               05810000
CVTQV1   EQU   CVTS01+588                                               05811000
CVTRPT   EQU   CVTS01+584                                               05812000
CVTSSRB  EQU   CVTS01+580                                               05813000
CVTCSDRL EQU   CVTS01+576                                               05814000
CVTEXP1  EQU   CVTS01+572                                               05815000
CVTRMPMT EQU   CVTS01+568                                               05816000
CVTRMPTT EQU   CVTS01+564                                               05817000
CVTVPSA  EQU   CVTS01+560                                               05818000
CVTVSTOP EQU   CVTS01+556                                               05819000
CVTGTFR8 EQU   CVTS01+552                                               05820000
CVTQUIT  EQU   CVTS01+548                                               05821000
CVTVACR  EQU   CVTS01+544                                               05822000
CVTWTCB  EQU   CVTS01+540                                               05823000
CVTSTPRS EQU   CVTS01+536                                               05824000
CVT0PT02 EQU   CVTS01+532                                               05825000
CVTDARCM EQU   CVTS01+528                                               05826000
CVTIRECM EQU   CVTS01+524                                               05827000
CVTJRECM EQU   CVTS01+520                                               05828000
CVTVEMS0 EQU   CVTS01+516                                               05829000
CVTSPFRR EQU   CVTS01+512                                               05830000
CVTRLSTG EQU   CVTS01+508                                               05831000
CVT0TC0A EQU   CVTS01+504                                               05832000
CVTGMBR  EQU   CVTS01+500                                               05833000
CVTLFRM  EQU   CVTS01+496                                               05834000
CVTRMBR  EQU   CVTS01+492                                               05835000
CVTVIOP  EQU   CVTS01+488                                               05836000
CVTRV307 EQU   CVTS01+486                                               05837000
CVTRV306 EQU   CVTS01+484                                               05838000
CVTRV305 EQU   CVTS01+482                                               05839000
CVTRV304 EQU   CVTS01+480                                               05840000
CVTRV303 EQU   CVTS01+478                                               05841000
CVTRV302 EQU   CVTS01+476                                               05842000
CVTTRCA  EQU   CVTS01+472                                               05843000
CVTRV297 EQU   CVTRV289                                                 05844000
CVTRV296 EQU   CVTRV289                                                 05845000
CVTRV295 EQU   CVTRV289                                                 05846000
CVTRV294 EQU   CVTRV289                                                 05847000
CVTRV293 EQU   CVTRV289                                                 05848000
CVTRV292 EQU   CVTRV289                                                 05849000
CVTRV291 EQU   CVTRV289                                                 05850000
CVTRV290 EQU   CVTRV289                                                 05851000
CVTRV288 EQU   CVTRV280                                                 05852000
CVTRV287 EQU   CVTRV280                                                 05853000
CVTRV286 EQU   CVTRV280                                                 05854000
CVTRV285 EQU   CVTRV280                                                 05855000
CVTRV284 EQU   CVTRV280                                                 05856000
CVTRV283 EQU   CVTRV280                                                 05857000
CVTRV282 EQU   CVTRV280                                                 05858000
CVTRV281 EQU   CVTRV280                                                 05859000
CVTRV279 EQU   CVTRV271                                                 05860000
CVTRV278 EQU   CVTRV271                                                 05861000
CVTRV277 EQU   CVTRV271                                                 05862000
CVTRV276 EQU   CVTRV271                                                 05863000
CVTRV275 EQU   CVTRV271                                                 05864000
CVTRV274 EQU   CVTRV271                                                 05865000
CVTRV273 EQU   CVTRV271                                                 05866000
CVTRV272 EQU   CVTRV271                                                 05867000
CVTRV270 EQU   CVTRV262                                                 05868000
CVTRV269 EQU   CVTRV262                                                 05869000
CVTRV268 EQU   CVTRV262                                                 05870000
CVTRV267 EQU   CVTRV262                                                 05871000
CVTRV266 EQU   CVTRV262                                                 05872000
CVTRV265 EQU   CVTRV262                                                 05873000
CVTRV264 EQU   CVTRV262                                                 05874000
CVTRV263 EQU   CVTRV262                                                 05875000
CVTVFP   EQU   CVTS01+464                                               05876000
CVTVSI   EQU   CVTS01+460                                               05877000
CVTVPSIB EQU   CVTS01+456                                               05878000
CVTMFACT EQU   CVTMFRTR                                                 05879000
CVTMFCTL EQU   CVTS01+448                                               05880000
CVTPVBP  EQU   CVTS01+444                                               05881000
CVTPWI   EQU   CVTS01+440                                               05882000
CVTRV254 EQU   CVTS01+438                                               05883000
CVTRV253 EQU   CVTS01+436                                               05884000
CVTRV252 EQU   CVTS01+434                                               05885000
CVTRV251 EQU   CVTS01+433                                               05886000
CVTRV250 EQU   CVTS01+432                                               05887000
CVTRV249 EQU   CVTS01+431                                               05888000
CVTRV248 EQU   CVTS01+430                                               05889000
CVTRV247 EQU   CVTS01+429                                               05890000
CVTRV246 EQU   CVTS01+428                                               05891000
CVTRV245 EQU   CVTRV237                                                 05892000
CVTRV244 EQU   CVTRV237                                                 05893000
CVTRV243 EQU   CVTRV237                                                 05894000
CVTRV242 EQU   CVTRV237                                                 05895000
CVTRV241 EQU   CVTRV237                                                 05896000
CVTRV240 EQU   CVTRV237                                                 05897000
CVTRV239 EQU   CVTRV237                                                 05898000
CVTRV238 EQU   CVTRV237                                                 05899000
CVTRV236 EQU   CVTRV228                                                 05900000
CVTRV235 EQU   CVTRV228                                                 05901000
CVTRV234 EQU   CVTRV228                                                 05902000
CVTRV233 EQU   CVTRV228                                                 05903000
CVTRV232 EQU   CVTRV228                                                 05904000
CVTRV231 EQU   CVTRV228                                                 05905000
CVTRV230 EQU   CVTRV228                                                 05906000
CVTRV229 EQU   CVTRV228                                                 05907000
CVTRV227 EQU   CVTRV219                                                 05908000
CVTRV226 EQU   CVTRV219                                                 05909000
CVTRV225 EQU   CVTRV219                                                 05910000
CVTRV224 EQU   CVTRV219                                                 05911000
CVTRV223 EQU   CVTRV219                                                 05912000
CVTRV222 EQU   CVTRV219                                                 05913000
CVTRV221 EQU   CVTRV219                                                 05914000
CVTRV220 EQU   CVTRV219                                                 05915000
CVTRV218 EQU   CVTRV210                                                 05916000
CVTRV217 EQU   CVTRV210                                                 05917000
CVTRV216 EQU   CVTRV210                                                 05918000
CVTRV215 EQU   CVTRV210                                                 05919000
CVTRV214 EQU   CVTRV210                                                 05920000
CVTRV213 EQU   CVTRV210                                                 05921000
CVTRV212 EQU   CVTRV210                                                 05922000
CVTRV211 EQU   CVTRV210                                                 05923000
CVTLCCAT EQU   CVTS01+420                                               05924000
CVTPCCAT EQU   CVTS01+416                                               05925000
CVTIPCRP EQU   CVTS01+412                                               05926000
CVTIPCRI EQU   CVTS01+408                                               05927000
CVTIPCDS EQU   CVTS01+404                                               05928000
CVTAIDVT EQU   CVTS01+400                                               05929000
CVTSSAP  EQU   CVTS01+396                                               05930000
CVTEHCIR EQU   CVTS01+392                                               05931000
CVTEHDEF EQU   CVTS01+388                                               05932000
CVTDAIR  EQU   CVTS01+384                                               05933000
CVTPERFM EQU   CVTS01+380                                               05934000
CVT044R2 EQU   CVTS01+376                                               05935000
CVTFETCH EQU   CVTS01+372                                               05936000
CVTRSTWD EQU   CVTS01+368                                               05937000
CVTSPOST EQU   CVTS01+364                                               05938000
CVTIOBP  EQU   CVTS01+360                                               05939000
CVTASMVT EQU   CVTS01+356                                               05940000
CVTRECRQ EQU   CVTS01+352                                               05941000
CVTWSAC  EQU   CVTS01+348                                               05942000
CVTRV149 EQU   CVTS01+344                                               05943000
CVTWSAL  EQU   CVTS01+340                                               05944000
CVTSPSA  EQU   CVTS01+336                                               05945000
CVTGLMN  EQU   CVTS01+332                                               05946000
CVTVEAC0 EQU   CVTS01+328                                               05947000
CVT062R1 EQU   CVTS01+324                                               05948000
CVTRPOST EQU   CVTS01+320                                               05949000
CVTDQIQE EQU   CVTS01+316                                               05950000
CVTCSD   EQU   CVTS01+312                                               05951000
CVTLKRMA EQU   CVTS01+308                                               05952000
CVTRSPIE EQU   CVTS01+304                                               05953000
CVTRENQ  EQU   CVTS01+300                                               05954000
CVTLQCB  EQU   CVTS01+296                                               05955000
CVTFQCB  EQU   CVTS01+292                                               05956000
CVTQCS01 EQU   CVTS01+288                                               05957000
CVTAPFT  EQU   CVTS01+284                                               05958000
CVTPARRL EQU   CVTS01+280                                               05959000
CVTVWAIT EQU   CVTS01+276                                               05960000
CVTGSPL  EQU   CVTS01+272                                               05961000
CVTLSMQ  EQU   CVTS01+268                                               05962000
CVTEXPRO EQU   CVTS01+260                                               05963000
CVTOPCTP EQU   CVTS01+256                                               05964000
CVTSIC   EQU   CVTS01+252                                               05965000
CVTTPIOS EQU   CVTS01+248                                               05966000
CVTRTMS  EQU   CVTS01+244                                               05967000
CVTSDBF  EQU   CVTS01+240                                               05968000
CVTSCBP  EQU   CVTS01+236                                               05969000
CVTSDMP  EQU   CVTS01+232                                               05970000
CVTSV60  EQU   CVTS01+228                                               05971000
CVTRTMCT EQU   CVTS01+224                                               05972000
CVTASCBL EQU   CVTS01+220                                               05973000
CVTASCBH EQU   CVTS01+216                                               05974000
CVTGDA   EQU   CVTS01+212                                               05975000
CVTVVMDI EQU   CVTS01+204                                               05976000
CVTAQTOP EQU   CVTS01+200                                               05977000
CVTIOSCS EQU   CVTS01+196                                               05978000
CVTSDRM  EQU   CVTS01+192                                               05979000
CVTSTXU  EQU   CVTS01+184                                               05980000
CVTQUIS  EQU   CVTS01+180                                               05981000
CVTPARS  EQU   CVTS01+176                                               05982000
CVTS1EE  EQU   CVTS01+172                                               05983000
CVTFRAS  EQU   CVTS01+168                                               05984000
CVTQSAS  EQU   CVTS01+164                                               05985000
CVTCRAS  EQU   CVTS01+160                                               05986000
CVTCRMN  EQU   CVTS01+156                                               05987000
CVTDELCP EQU   CVTS01+152                                               05988000
CVTFRECL EQU   CVTS01+148                                               05989000
CVTGETCL EQU   CVTS01+144                                               05990000
CVTBLDCP EQU   CVTS01+140                                               05991000
CVTAUTHL EQU   CVTS01+136                                               05992000
CVTSCAN  EQU   CVTS01+132                                               05993000
CVTRV144 EQU   CVTS01+130                                               05994000
CVTMAXMP EQU   CVTS01+128                                               05995000
CVTSTCK  EQU   CVTS01+124                                               05996000
CVTRV139 EQU   CVTS01+123                                               05997000
CVTDSSAC EQU   CVTS01+122                                               05998000
CVTRV513 EQU   CVTS01+121                                               05999000
CVTIOSPL EQU   CVTS01+120                                               06000000
CVTPTGT  EQU   CVTS01+116                                               06001000
CVTCSPIE EQU   CVTS01+112                                               06002000
CVTSMFEX EQU   CVTS01+108                                               06003000
CVTOLT0A EQU   CVTS01+104                                               06004000
CVTSRBRT EQU   CVTS01+100                                               06005000
CVTPUTL  EQU   CVTS01+96                                                06006000
CVTASCRL EQU   CVTS01+92                                                06007000
CVTASCRF EQU   CVTS01+88                                                06008000
CVTRV326 EQU   CVTS01+84                                                06009000
CVTRV325 EQU   CVTS01+80                                                06010000
CVTRV324 EQU   CVTS01+76                                                06011000
CVT0VL01 EQU   CVTS01+72                                                06012000
CVTSHRVM EQU   CVTS01+68                                                06013000
CVTRV332 EQU   CVTS01+64                                                06014000
CVTTAS   EQU   CVTS01+60                                                06015000
CVTRSCN  EQU   CVTS01+56                                                06016000
CVTTRAC2 EQU   CVTS01+54                                                06017000
CVTTRACE EQU   CVTS01+52                                                06018000
CVTAPG   EQU   CVTS01+51                                                06019000
CVTSDTRC EQU   CVTCTLFG                                                 06020000
CVTGTRCE EQU   CVTCTLFG                                                 06021000
CVTNOMP  EQU   CVTCTLFG                                                 06022000
CVTRSV79 EQU   CVTCTLFG                                                 06023000
CVTDSTAT EQU   CVTCTLFG                                                 06024000
CVTRSV78 EQU   CVTCTLFG                                                 06025000
CVTRV333 EQU   CVTCTLFG                                                 06026000
CVTRV323 EQU   CVTCTLFG                                                 06027000
CVTSPVLK EQU   CVTS01+49                                                06028000
CVTRSV77 EQU   CVTS01+48                                                06029000
CVTRV331 EQU   CVTS01+44                                                06030000
CVTRV330 EQU   CVTS01+40                                                06031000
CVTRV329 EQU   CVTS01+36                                                06032000
CVTRV328 EQU   CVTS01+32                                                06033000
CVTRV322 EQU   CVTS01+28                                                06034000
CVTSLID  EQU   CVTSLIDA+1                                               06035000
CVTSYLK  EQU   CVTSLIDA                                                 06036000
CVTRV321 EQU   CVTS01+20                                                06037000
CVTRV320 EQU   CVTS01+16                                                06038000
CVTLPDIR EQU   CVTLPDIA+1                                               06039000
CVTRSV69 EQU   CVTDIRST                                                 06040000
CVTRSV68 EQU   CVTDIRST                                                 06041000
CVTRSV67 EQU   CVTDIRST                                                 06042000
CVTRSV66 EQU   CVTDIRST                                                 06043000
CVTRSV65 EQU   CVTDIRST                                                 06044000
CVTRSV64 EQU   CVTDIRST                                                 06045000
CVTRSV63 EQU   CVTDIRST                                                 06046000
CVTDICOM EQU   CVTDIRST                                                 06047000
CVTLPDSR EQU   CVTS01+4                                                 06048000
CVTGETL  EQU   CVTS01                                                   06049000
QINDEX   EQU   SOUTWRKA                                                 06050000
@NM00100 EQU   SOUTFLGS                                                 06051000
SOUTINT  EQU   SOUTFLGS                                                 06052000
FWRDPTR  EQU   SOUTPARM                                                 06053000
SAVER14  EQU   REGSAVER+64                                              06054000
SAVER13  EQU   REGSAVER+60                                              06055000
SAVER12  EQU   REGSAVER+56                                              06056000
SAVER11  EQU   REGSAVER+52                                              06057000
SAVER10  EQU   REGSAVER+48                                              06058000
SAVER9   EQU   REGSAVER+44                                              06059000
SAVER8   EQU   REGSAVER+40                                              06060000
SAVER7   EQU   REGSAVER+36                                              06061000
SAVER6   EQU   REGSAVER+32                                              06062000
SAVER5   EQU   REGSAVER+28                                              06063000
SAVER4   EQU   REGSAVER+24                                              06064000
SAVER3   EQU   REGSAVER+20                                              06065000
SAVER2   EQU   REGSAVER+16                                              06066000
@NM00095 EQU   REGSAVER+4                                               06067000
@NM00094 EQU   REGSAVER                                                 06068000
@NM00091 EQU   TCBXTNT2+32                                              06069000
TCBRV181 EQU   TCBRV173                                                 06070000
TCBRV180 EQU   TCBRV173                                                 06071000
TCBRV179 EQU   TCBRV173                                                 06072000
TCBRV178 EQU   TCBRV173                                                 06073000
TCBRV177 EQU   TCBRV173                                                 06074000
TCBRV176 EQU   TCBRV173                                                 06075000
TCBRV175 EQU   TCBRV173                                                 06076000
TCBRV174 EQU   TCBRV173                                                 06077000
TCBRV172 EQU   TCBRV164                                                 06078000
TCBRV171 EQU   TCBRV164                                                 06079000
TCBRV170 EQU   TCBRV164                                                 06080000
TCBRV169 EQU   TCBRV164                                                 06081000
TCBRV168 EQU   TCBRV164                                                 06082000
TCBRV167 EQU   TCBRV164                                                 06083000
TCBRV166 EQU   TCBRV164                                                 06084000
TCBRV165 EQU   TCBRV164                                                 06085000
TCBRV163 EQU   TCBRV155                                                 06086000
TCBRV162 EQU   TCBRV155                                                 06087000
TCBRV161 EQU   TCBRV155                                                 06088000
TCBRV160 EQU   TCBRV155                                                 06089000
TCBRV159 EQU   TCBRV155                                                 06090000
TCBRV158 EQU   TCBRV155                                                 06091000
TCBRV157 EQU   TCBRV155                                                 06092000
TCBRV156 EQU   TCBRV155                                                 06093000
TCBRV154 EQU   TCBRV146                                                 06094000
TCBRV153 EQU   TCBRV146                                                 06095000
TCBRV152 EQU   TCBRV146                                                 06096000
TCBRV151 EQU   TCBRV146                                                 06097000
TCBRV150 EQU   TCBRV146                                                 06098000
TCBRV149 EQU   TCBRV146                                                 06099000
TCBRV148 EQU   TCBRV146                                                 06100000
TCBRV147 EQU   TCBRV146                                                 06101000
TCBRV145 EQU   TCBXTNT2+26                                              06102000
TCBRV144 EQU   TCBXTNT2+24                                              06103000
TCBRV143 EQU   TCBXTNT2+20                                              06104000
TCBRV142 EQU   TCBXTNT2+16                                              06105000
TCBRSV49 EQU   TCBXTNT2+12                                              06106000
TCBEVENT EQU   TCBXTNT2+8                                               06107000
TCBRCMP  EQU   TCBXTNT2+5                                               06108000
TCBRSVAB EQU   TCBXTNT2+4                                               06109000
TCBGTFA  EQU   TCBGTF+1                                                 06110000
TCBRSV47 EQU   TCBTFLG                                                  06111000
TCBRSV46 EQU   TCBTFLG                                                  06112000
TCBRSV45 EQU   TCBTFLG                                                  06113000
TCBRSV44 EQU   TCBTFLG                                                  06114000
TCBRSV43 EQU   TCBTFLG                                                  06115000
TCBDSPIT EQU   TCBTFLG                                                  06116000
TCBERRTN EQU   TCBTFLG                                                  06117000
TCBASYNC EQU   TCBTFLG                                                  06118000
@NM00090 EQU   TCB+296                                                  06119000
TCBSVCA2 EQU   TCB+292                                                  06120000
TCBSWASA EQU   TCB+288                                                  06121000
TCBDBTB  EQU   TCB+284                                                  06122000
TCBRPT   EQU   TCB+280                                                  06123000
TCBRV141 EQU   TCBRV133                                                 06124000
TCBRV140 EQU   TCBRV133                                                 06125000
TCBRV139 EQU   TCBRV133                                                 06126000
TCBRV138 EQU   TCBRV133                                                 06127000
TCBRV137 EQU   TCBRV133                                                 06128000
TCBRV136 EQU   TCBRV133                                                 06129000
TCBRV135 EQU   TCBRV133                                                 06130000
TCBRV134 EQU   TCBRV133                                                 06131000
TCBRV132 EQU   TCBRV124                                                 06132000
TCBRV131 EQU   TCBRV124                                                 06133000
TCBRV130 EQU   TCBRV124                                                 06134000
TCBRV129 EQU   TCBRV124                                                 06135000
TCBRV128 EQU   TCBRV124                                                 06136000
TCBRV127 EQU   TCBRV124                                                 06137000
TCBRV126 EQU   TCBRV124                                                 06138000
TCBRV125 EQU   TCBRV124                                                 06139000
TCBRV123 EQU   TCBFBYT2                                                 06140000
TCBRV122 EQU   TCBFBYT2                                                 06141000
TCBECBNV EQU   TCBFBYT2                                                 06142000
TCBSSSYN EQU   TCBFBYT2                                                 06143000
TCBFPRAP EQU   TCBFBYT2                                                 06144000
TCBFDW   EQU   TCBFBYT2                                                 06145000
TCBFMW   EQU   TCBFBYT2                                                 06146000
TCBCNCB  EQU   TCBFBYT2                                                 06147000
TCBLLH   EQU   TCBFBYT1                                                 06148000
TCBRV113 EQU   TCBFBYT1                                                 06149000
TCBEOT   EQU   TCBFBYT1                                                 06150000
TCBRTM2  EQU   TCBFBYT1                                                 06151000
TCBPGNLY EQU   TCBFBYT1                                                 06152000
TCBNDIOS EQU   TCBFBYT1                                                 06153000
TCBRV327 EQU   TCBFBYT1                                                 06154000
TCBEOTFM EQU   TCBFBYT1                                                 06155000
TCBAFFN  EQU   TCB+274                                                  06156000
TCBRV326 EQU   TCB+272                                                  06157000
TCBUKYSP EQU   TCB+268                                                  06158000
TCBMODE  EQU   TCBESTAE+3                                               06159000
TCBERTYP EQU   TCBESTAE+2                                               06160000
TCBRV314 EQU   TCBESTRM                                                 06161000
TCBRV313 EQU   TCBESTRM                                                 06162000
TCBRV312 EQU   TCBESTRM                                                 06163000
TCBRV311 EQU   TCBESTRM                                                 06164000
TCBRV310 EQU   TCBESTRM                                                 06165000
TCBRV309 EQU   TCBESTRM                                                 06166000
TCBRV308 EQU   TCBESTRM                                                 06167000
TCBETERM EQU   TCBESTRM                                                 06168000
TCBSCBKY EQU   TCBESTAE                                                 06169000
TCBRTM12 EQU   TCB+260                                                  06170000
TCBTCBID EQU   TCB+256                                                  06171000
TCBSTAWA EQU   TCB+252                                                  06172000
TCBSWA   EQU   TCB+248                                                  06173000
TCBRSV42 EQU   TCBFOE                                                   06174000
TCBCCPVI EQU   TCBXSCT+2                                                06175000
TCBRV325 EQU   TCBXSCT+1                                                06176000
TCBRV324 EQU   TCBXSCT1                                                 06177000
TCBRV323 EQU   TCBXSCT1                                                 06178000
TCBRV322 EQU   TCBXSCT1                                                 06179000
TCBRV321 EQU   TCBXSCT1                                                 06180000
TCBRV320 EQU   TCBXSCT1                                                 06181000
TCBRV319 EQU   TCBXSCT1                                                 06182000
TCBS3A   EQU   TCBXSCT1                                                 06183000
TCBACTIV EQU   TCBXSCT1                                                 06184000
TCBRSV41 EQU   TCB+239                                                  06185000
TCBTID   EQU   TCB+238                                                  06186000
TCBRSVAA EQU   TCB+237                                                  06187000
TCBABCUR EQU   TCB+236                                                  06188000
TCBTMSAV EQU   TCB+232                                                  06189000
TCBIOTIM EQU   TCB+228                                                  06190000
TCBRTWA  EQU   TCB+224                                                  06191000
TCBBACK  EQU   TCB+220                                                  06192000
TCBTIRB  EQU   TCB+216                                                  06193000
TCBAECB  EQU   TCB+212                                                  06194000
TCBEXT2A EQU   TCBEXT2+1                                                06195000
TCBRSV39 EQU   TCBEXT2                                                  06196000
TCBSTMCT EQU   TCB+207                                                  06197000
TCBSYSCT EQU   TCB+206                                                  06198000
TCBRSV37 EQU   TCB+205                                                  06199000
TCBEXSVC EQU   TCBDAR                                                   06200000
TCBDARMS EQU   TCBDAR                                                   06201000
TCBDARWT EQU   TCBDAR                                                   06202000
TCBDARO  EQU   TCBDAR                                                   06203000
TCBDARMC EQU   TCBDARC                                                  06204000
TCBDARD  EQU   TCBDAR                                                   06205000
TCBDARS  EQU   TCBDAR                                                   06206000
TCBDARP  EQU   TCBDAR                                                   06207000
TCBGTOFM EQU   TCBFLGS7                                                 06208000
TCBADMP  EQU   TCBFLGS7                                                 06209000
TCBRSTSK EQU   TCBFLGS7                                                 06210000
TCBSVCS  EQU   TCBFLGS7                                                 06211000
TCBSTACK EQU   TCBFLGS7                                                 06212000
TCBRSV34 EQU   TCBFLGS7                                                 06213000
TCBRSV33 EQU   TCBFLGS7                                                 06214000
TCBGPECB EQU   TCBFLGS7                                                 06215000
TCBNTJS  EQU   TCBFLGS6                                                 06216000
TCBAPG   EQU   TCBFLGS6                                                 06217000
TCBMIGR  EQU   TCBFLGS6                                                 06218000
TCBRV303 EQU   TCBFLGS6                                                 06219000
TCBSPVLK EQU   TCBFLGS6                                                 06220000
TCBCPU   EQU   TCBFLGS6                                                 06221000
TCBPIE17 EQU   TCBFLGS6                                                 06222000
TCBRV    EQU   TCBFLGS6                                                 06223000
TCBRSV79 EQU   TCBNDSP5                                                 06224000
TCBRSV78 EQU   TCBNDSP5                                                 06225000
TCBRSV77 EQU   TCBNDSP5                                                 06226000
TCBRSV76 EQU   TCBNDSP5                                                 06227000
TCBRSV75 EQU   TCBNDSP5                                                 06228000
TCBRSV74 EQU   TCBNDSP5                                                 06229000
TCBRSV95 EQU   TCBNDSP5                                                 06230000
TCBRSV94 EQU   TCBNDSP5                                                 06231000
TCBRSV93 EQU   TCBNDSP4                                                 06232000
TCBRSV92 EQU   TCBNDSP4                                                 06233000
TCBRSV91 EQU   TCBNDSP4                                                 06234000
TCBRSV90 EQU   TCBNDSP4                                                 06235000
TCBRSV89 EQU   TCBNDSP4                                                 06236000
TCBRSV88 EQU   TCBNDSP4                                                 06237000
TCBRSV87 EQU   TCBNDSP4                                                 06238000
TCBRSV86 EQU   TCBNDSP4                                                 06239000
TCBEXT1A EQU   TCBEXT1+1                                                06240000
TCBRSV32 EQU   TCBEXT1                                                  06241000
TCBEXCPD EQU   TCB+192                                                  06242000
TCBIOBRC EQU   TCB+188                                                  06243000
TCBDDWTC EQU   TCB+186                                                  06244000
TCBDDEXC EQU   TCB+184                                                  06245000
TCBJSCBB EQU   TCBJSCB+1                                                06246000
@NM00089 EQU   TCBRECDE                                                 06247000
TCBREC   EQU   TCBRECDE                                                 06248000
TCBMDIDS EQU   TCB+176                                                  06249000
TCBNDINT EQU   TCBNDSP3                                                 06250000
TCBRSV27 EQU   TCBNDSP3                                                 06251000
TCBRSV26 EQU   TCBNDSP3                                                 06252000
TCBRSV25 EQU   TCBNDSP3                                                 06253000
TCBRSV24 EQU   TCBNDSP3                                                 06254000
TCBSRBND EQU   TCBNDSP3                                                 06255000
TCBRV302 EQU   TCBNDSP3                                                 06256000
TCBLJSND EQU   TCBNDSP3                                                 06257000
TCBABE   EQU   TCBNDSP2                                                 06258000
TCBDSS   EQU   TCBNDSP2                                                 06259000
TCBOWAIT EQU   TCBNDSP2                                                 06260000
TCBIWAIT EQU   TCBNDSP2                                                 06261000
TCBNDTS  EQU   TCBNDSP2                                                 06262000
TCBNDSVC EQU   TCBNDSP2                                                 06263000
TCBSTPP  EQU   TCBNDSP2                                                 06264000
TCBABD   EQU   TCBNDSP2                                                 06265000
TCBRSV22 EQU   TCBNDSP1                                                 06266000
TCBPIEND EQU   TCBNDSP1                                                 06267000
TCBTPSP  EQU   TCBNDSP1                                                 06268000
TCBDDRND EQU   TCBNDSP1                                                 06269000
TCBRSPND EQU   TCBNDSP1                                                 06270000
TCBRSTND EQU   TCBNDSP1                                                 06271000
TCBDARPN EQU   TCBNDSP1                                                 06272000
TCBDARTN EQU   TCBNDSP1                                                 06273000
TCBNDSP0 EQU   TCBNDSP                                                  06274000
TCBUSER  EQU   TCB+168                                                  06275000
TCBTCTB  EQU   TCBTCT+1                                                 06276000
TCBRSV9C EQU   TCBTCTGF                                                 06277000
TCBRSV9B EQU   TCBTCTGF                                                 06278000
TCBRSV9A EQU   TCBTCTGF                                                 06279000
TCBRSV99 EQU   TCBTCTGF                                                 06280000
TCBRSV98 EQU   TCBTCTGF                                                 06281000
TCBRSV97 EQU   TCBTCTGF                                                 06282000
TCBRSV20 EQU   TCBTCTGF                                                 06283000
TCBSMFGF EQU   TCBTCTGF                                                 06284000
TCBSTABB EQU   TCBSTAB+1                                                06285000
TCBSTCUR EQU   TCBNSTAE                                                 06286000
TCBRV301 EQU   TCBNSTAE                                                 06287000
TCBSYNCH EQU   TCBNSTAE                                                 06288000
TCBHALT  EQU   TCBNSTAE                                                 06289000
TCBPPSUP EQU   TCBNSTAE                                                 06290000
TCB33E   EQU   TCBNSTAE                                                 06291000
TCBQUIES EQU   TCBNSTAE                                                 06292000
TCBSTABE EQU   TCBNSTAE                                                 06293000
TCBAQE   EQU   TCB+156                                                  06294000
TCBPQE   EQU   TCB+152                                                  06295000
TCBTSDP  EQU   TCB+151                                                  06296000
TCBTSLP  EQU   TCB+150                                                  06297000
TCBSTPCT EQU   TCB+149                                                  06298000
TCBCPUBN EQU   TCBTSFLG                                                 06299000
TCBDYDSP EQU   TCBTSFLG                                                 06300000
TCBRSV18 EQU   TCBTSFLG                                                 06301000
TCBRSV17 EQU   TCBTSFLG                                                 06302000
TCBTIOTG EQU   TCBTSFLG                                                 06303000
TCBATT   EQU   TCBTSFLG                                                 06304000
TCBSTPPR EQU   TCBTSFLG                                                 06305000
TCBRV300 EQU   TCBTSTSK                                                 06306000
TCBECB   EQU   TCB+144                                                  06307000
TCBIQE   EQU   TCB+140                                                  06308000
TCBLTC   EQU   TCB+136                                                  06309000
TCBOTC   EQU   TCB+132                                                  06310000
TCBNTC   EQU   TCB+128                                                  06311000
TCBJSTCA EQU   TCBJSTCB+1                                               06312000
TCBRSV16 EQU   TCBJSTCB                                                 06313000
TCBTQET  EQU   TCBTME                                                   06314000
TCBFSAB  EQU   TCBFSA+1                                                 06315000
TCBQEL   EQU   TCBFSA                                                   06316000
TCBGRS15 EQU   TCBGRS+60                                                06317000
TCBGRS14 EQU   TCBGRS+56                                                06318000
TCBGRS13 EQU   TCBGRS+52                                                06319000
TCBGRS12 EQU   TCBGRS+48                                                06320000
TCBGRS11 EQU   TCBGRS+44                                                06321000
TCBGRS10 EQU   TCBGRS+40                                                06322000
TCBGRS9  EQU   TCBGRS+36                                                06323000
TCBGRS8  EQU   TCBGRS+32                                                06324000
TCBGRS7  EQU   TCBGRS+28                                                06325000
TCBGRS6  EQU   TCBGRS+24                                                06326000
TCBGRS5  EQU   TCBGRS+20                                                06327000
TCBGRS4  EQU   TCBGRS+16                                                06328000
TCBGRS3  EQU   TCBGRS+12                                                06329000
TCBGRS2  EQU   TCBGRS+8                                                 06330000
TCBGRS1  EQU   TCBGRS+4                                                 06331000
TCBGRS0  EQU   TCBGRS                                                   06332000
TCBJPQB  EQU   TCBJPQ+1                                                 06333000
TCBRSV15 EQU   TCBPURGE                                                 06334000
TCBRSV14 EQU   TCBPURGE                                                 06335000
TCBRSV13 EQU   TCBPURGE                                                 06336000
TCBRSV12 EQU   TCBPURGE                                                 06337000
TCBRSV11 EQU   TCBPURGE                                                 06338000
TCBRSV10 EQU   TCBPURGE                                                 06339000
TCBRSV09 EQU   TCBPURGE                                                 06340000
TCBJPQF  EQU   TCBPURGE                                                 06341000
TCBJLB   EQU   TCB+40                                                   06342000
TCBLLS   EQU   TCB+36                                                   06343000
TCBDSP   EQU   TCB+35                                                   06344000
TCBLMP   EQU   TCB+34                                                   06345000
TCBPNDSP EQU   TCBFLGS5                                                 06346000
TCBFCD1  EQU   TCBFLGS5                                                 06347000
TCBSTP   EQU   TCBFLGS5                                                 06348000
TCBSYS   EQU   TCBFLGS5                                                 06349000
TCBANDSP EQU   TCBFLGS5                                                 06350000
TCBPAGE  EQU   TCBFLGS5                                                 06351000
TCBUXNDF EQU   TCBABWF                                                  06352000
TCBFC    EQU   TCBFLGS5                                                 06353000
TCBONDSP EQU   TCBFLGS4                                                 06354000
TCBMPCND EQU   TCBFLGS4                                                 06355000
TCBMPCVQ EQU   TCBFLGS4                                                 06356000
TCBUXNDV EQU   TCBFLGS4                                                 06357000
TCBHNDSP EQU   TCBFLGS4                                                 06358000
TCBRQENA EQU   TCBFLGS4                                                 06359000
TCBSER   EQU   TCBFLGS4                                                 06360000
TCBNDUMP EQU   TCBFLGS4                                                 06361000
TCBDWSTA EQU   TCBFLGS3                                                 06362000
TCBRSV08 EQU   TCBFLGS3                                                 06363000
TCBRSV07 EQU   TCBFLGS3                                                 06364000
TCBRSV06 EQU   TCBFLGS3                                                 06365000
TCBABGM  EQU   TCBFLGS3                                                 06366000
TCBABTRM EQU   TCBFLGS3                                                 06367000
TCBADINP EQU   TCBFLGS3                                                 06368000
TCBFSM   EQU   TCBFLGS3                                                 06369000
TCBFTS   EQU   TCBFLGS2                                                 06370000
TCBFETXR EQU   TCBFLGS2                                                 06371000
TCBFDSOP EQU   TCBFLGS2                                                 06372000
TCBFJMC  EQU   TCBFLGS2                                                 06373000
TCBFSMC  EQU   TCBFLGS2                                                 06374000
TCBFABOP EQU   TCBFLGS2                                                 06375000
TCBFSTI  EQU   TCBFLGS2                                                 06376000
TCBFOINP EQU   TCBFLGS2                                                 06377000
TCBFX    EQU   TCBFLGS1                                                 06378000
TCBFS    EQU   TCBFLGS1                                                 06379000
TCBFT    EQU   TCBFLGS1                                                 06380000
TCBPDUMP EQU   TCBFLGS1                                                 06381000
TCBNONPR EQU   TCBFLGS1                                                 06382000
TCBFERA  EQU   TCBFLGS1                                                 06383000
TCBFE    EQU   TCBFLGS1                                                 06384000
TCBFA    EQU   TCBFLGS1                                                 06385000
TCBZERO  EQU   TCBPKF                                                   06386000
TCBFLAG  EQU   TCBPKF                                                   06387000
TCBMSSB  EQU   TCBMSS+1                                                 06388000
TCBRSV03 EQU   TCBMSS                                                   06389000
TCBTRNB  EQU   TCBTRN+1                                                 06390000
TCBRSV02 EQU   TCBABF                                                   06391000
TCBOLTEP EQU   TCBABF                                                   06392000
TCBTCP   EQU   TCBABF                                                   06393000
TCBTCPP  EQU   TCBABF                                                   06394000
TCBRSV01 EQU   TCBABF                                                   06395000
TCBGRPH  EQU   TCBABF                                                   06396000
TCBNOCHK EQU   TCBABF                                                   06397000
TCBMOD91 EQU   TCBABF                                                   06398000
TCBCMPC  EQU   TCBCMP+1                                                 06399000
TCBRV318 EQU   TCBCMSG                                                  06400000
TCBRV317 EQU   TCBCIND                                                  06401000
TCBRV316 EQU   TCBCWTO                                                  06402000
TCBCASID EQU   TCBCDBL                                                  06403000
TCBNOCC  EQU   TCBSTCC                                                  06404000
TCBDMPO  EQU   TCBCPP                                                   06405000
TCBCSTEP EQU   TCBCMPF                                                  06406000
TCBCREQ  EQU   TCBCMPF                                                  06407000
TCBTIO   EQU   TCB+12                                                   06408000
TCBDEB   EQU   TCB+8                                                    06409000
TCBPIEA  EQU   TCBPIE+1                                                 06410000
TCBPM    EQU   TCBPMASK                                                 06411000
@NM00088 EQU   TCBPMASK                                                 06412000
TCBRBP   EQU   TCB                                                      06413000
TCBFRS6  EQU   TCBFRS+24                                                06414000
TCBFRS4  EQU   TCBFRS+16                                                06415000
TCBFRS2  EQU   TCBFRS+8                                                 06416000
TCBFRS0  EQU   TCBFRS                                                   06417000
XPTLSID2 EQU   XPTLPN                                                   06418000
XPTLSID  EQU   XPTLGN                                                   06419000
@NM00087 EQU   XPTFLAG2                                                 06420000
XPTIOERR EQU   XPTFLAG2                                                 06421000
XPTPOINP EQU   XPTFLAG2                                                 06422000
XPTRES1  EQU   XPTFLAG2                                                 06423000
XPTVALID EQU   XPTFLAG2                                                 06424000
XPTRSV4  EQU   XPTFLAGS                                                 06425000
XPTRES2  EQU   XPTFLAGS                                                 06426000
@NM00086 EQU   XPTFLAGS                                                 06427000
XPTCKF   EQU   XPTFLAGS                                                 06428000
XPTRSV1  EQU   XPTE+1                                                   06429000
@NM00085 EQU   SRB+40                                                   06430000
@NM00084 EQU   SRB+38                                                   06431000
SRBPKF   EQU   SRB+36                                                   06432000
SRBSAVE  EQU   SRB+32                                                   06433000
SRBPTCB  EQU   SRBFLC+4                                                 06434000
SRBCPAFF EQU   SRBFLC                                                   06435000
SPCTXEND EQU   SPCTENT+48                                               06436000
SPCTENTS EQU   SPCTENT                                                  06437000
@NM00083 EQU   SPCTEXTM+4                                               06438000
@NM00082 EQU   SPCTFLAG                                                 06439000
SPCTPGT  EQU   SPCTSEGE+1                                               06440000
SPCTSIZE EQU   SPCT+14                                                  06441000
SPCTIDEN EQU   SPCT+11                                                  06442000
@NM00081 EQU   SPCTFLG1                                                 06443000
SPCTVROT EQU   SPCTFLG1                                                 06444000
SPCTBIG  EQU   SPCTFLG1                                                 06445000
SPCTNSEG EQU   SPCT+8                                                   06446000
@NM00080 EQU   SCVTSECT+180                                             06447000
@NM00079 EQU   SCVTSECT+176                                             06448000
SCVTPIQE EQU   SCVTSECT+172                                             06449000
@NM00078 EQU   SCVTSECT+168                                             06450000
SCVTPTRM EQU   SCVTSECT+164                                             06451000
@NM00077 EQU   SCVTSECT+160                                             06452000
@NM00076 EQU   SCVTSECT+156                                             06453000
SCVTQCBR EQU   SCVTSECT+152                                             06454000
@NM00075 EQU   SCVTSECT+144                                             06455000
SCVTTQE  EQU   SCVTSECT+140                                             06456000
@NM00074 EQU   SCVTSECT+136                                             06457000
SCVTSVCT EQU   SCVTSECT+132                                             06458000
@NM00073 EQU   SCVTSECT+128                                             06459000
@NM00072 EQU   SCVTSECT+124                                             06460000
SCVTRXLQ EQU   SCVTSECT+120                                             06461000
@NM00071 EQU   SCVTSECT+116                                             06462000
SCVTCTCB EQU   SCVTSECT+112                                             06463000
@NM00070 EQU   SCVTSECT+108                                             06464000
@NM00069 EQU   SCVTSECT+104                                             06465000
@NM00068 EQU   SCVTSECT+100                                             06466000
@NM00067 EQU   SCVTSECT+96                                              06467000
SCVTCOMM EQU   SCVTSECT+92                                              06468000
@NM00066 EQU   SCVTSECT+88                                              06469000
@NM00065 EQU   SCVTSECT+84                                              06470000
@NM00064 EQU   SCVTSECT+80                                              06471000
@NM00063 EQU   SCVTSECT+76                                              06472000
@NM00062 EQU   SCVTSECT+72                                              06473000
SCVTGMBR EQU   SCVTSECT+68                                              06474000
SCVTRPTR EQU   SCVTSECT+64                                              06475000
SCVTHSKP EQU   SCVTSECT+60                                              06476000
@NM00061 EQU   SCVTSECT+56                                              06477000
@NM00060 EQU   SCVTSECT+52                                              06478000
SCVTLFRM EQU   SCVTSECT+48                                              06479000
SCVTCDCL EQU   SCVTSECT+44                                              06480000
@NM00059 EQU   SCVTSECT+40                                              06481000
SCVTRACE EQU   SCVTSECT+36                                              06482000
@NM00058 EQU   SCVTSECT+32                                              06483000
SCVTRMBR EQU   SCVTSECT+28                                              06484000
@NM00057 EQU   SCVTSECT+24                                              06485000
@NM00056 EQU   SCVTSECT+20                                              06486000
@NM00055 EQU   SCVTSECT+16                                              06487000
@NM00054 EQU   SCVTSECT+14                                              06488000
SCVTBR14 EQU   SCVTSECT+12                                              06489000
SCVTSPET EQU   SCVTSECT+8                                               06490000
SCVTPGWR EQU   SCVTSECT+4                                               06491000
SCVTPGTM EQU   SCVTSECT                                                 06492000
RSMASMHD EQU   RSMHD+40                                                 06493000
RSMFOEQ  EQU   RSMHD+36                                                 06494000
RSMLIOQF EQU   RSMLIOQ                                                  06495000
RSMLSQAL EQU   RSMLSQA+2                                                06496000
RSMLFQL  EQU   RSMLFQ+2                                                 06497000
RSMRSV2  EQU   RSMHD+16                                                 06498000
@NM00053 EQU   RSMFLG1                                                  06499000
RSMFAIL  EQU   RSMFLG1                                                  06500000
RSMGFADD EQU   RSMFLG1                                                  06501000
RSMGFAD  EQU   RSMFLG1                                                  06502000
RSMIOCPC EQU   RSMFLG1                                                  06503000
RSMIOCPU EQU   RSMFLG1                                                  06504000
RSMASCB  EQU   RSMHD+8                                                  06505000
RSMVSTO  EQU   RSMHD                                                    06506000
RCARETAD EQU   RCA+20                                                   06507000
RCATASID EQU   RCA+18                                                   06508000
RCAREP1  EQU   RCANAME6                                                 06509000
RCAPSIF  EQU   RCANAME6                                                 06510000
RCAPSIX  EQU   RCANAME6                                                 06511000
RCAVEQRP EQU   RCANAME6                                                 06512000
RCARCFC  EQU   RCANAME6                                                 06513000
RCACSGB  EQU   RCANAME6                                                 06514000
RCAFXL   EQU   RCANAME6                                                 06515000
RCAPS113 EQU   RCANAME6                                                 06516000
RCAFREE  EQU   RCANAME5                                                 06517000
RCARFR2  EQU   RCANAME5                                                 06518000
RCACPBR  EQU   RCANAME5                                                 06519000
RCAOPBR  EQU   RCANAME5                                                 06520000
RCASORT  EQU   RCANAME5                                                 06521000
RCASIRT  EQU   RCANAME5                                                 06522000
RCARELV  EQU   RCANAME5                                                 06523000
RCARELF  EQU   RCANAME5                                                 06524000
RCAGFAD  EQU   RCANAME4                                                 06525000
RCAVEQRI EQU   RCANAME4                                                 06526000
RCAVEQRF EQU   RCANAME4                                                 06527000
RCAVEQRC EQU   RCANAME4                                                 06528000
RCATERM  EQU   RCANAME4                                                 06529000
RCASQA   EQU   RCANAME4                                                 06530000
RCASWIN  EQU   RCANAME4                                                 06531000
RCARFR   EQU   RCANAME3                                                 06532000
RCARELS  EQU   RCANAME3                                                 06533000
RCARCFI  EQU   RCANAME3                                                 06534000
RCARCF   EQU   RCANAME3                                                 06535000
RCAPSII  EQU   RCANAME3                                                 06536000
RCAPSIB  EQU   RCANAME3                                                 06537000
RCAPS112 EQU   RCANAME3                                                 06538000
RCAPIX   EQU   RCANAME3                                                 06539000
RCAPIOP  EQU   RCANAME2                                                 06540000
RCASWPC  EQU   RCANAME2                                                 06541000
RCASWPP  EQU   RCANAME2                                                 06542000
RCAPFTE  EQU   RCANAME2                                                 06543000
RCAPCB   EQU   RCANAME2                                                 06544000
RCAOUT   EQU   RCANAME2                                                 06545000
RCAITAS  EQU   RCANAME2                                                 06546000
RCAIOCP  EQU   RCANAME2                                                 06547000
RCAINV   EQU   RCANAME1                                                 06548000
RCAGFA   EQU   RCANAME1                                                 06549000
RCAFXLD  EQU   RCANAME1                                                 06550000
RCAVEQR  EQU   RCANAME1                                                 06551000
RCADSEG  EQU   RCANAME1                                                 06552000
RCADLAS  EQU   RCANAME1                                                 06553000
RCACSEG  EQU   RCANAME1                                                 06554000
RCAVAMSI EQU   RCANAME1                                                 06555000
@NM00052 EQU   RCAFLAGS                                                 06556000
RCADISP  EQU   RCAFLAGS                                                 06557000
@NM00051 EQU   RCAFLAGS                                                 06558000
RCAQS    EQU   RCAFLAGS                                                 06559000
RCAPSIER EQU   RCAFLAGS                                                 06560000
RCAABEND EQU   RCAFLAGS                                                 06561000
RCALL    EQU   RCAFLAGS                                                 06562000
@NM00050 EQU   RCANAME7                                                 06563000
RCAPRSS  EQU   RCANAME7                                                 06564000
RCAPRSR  EQU   RCANAME7                                                 06565000
RCAPRSB  EQU   RCANAME7                                                 06566000
RCAPSIY  EQU   RCANAME7                                                 06567000
RCAPIOI  EQU   RCANAME7                                                 06568000
RCAPARM1 EQU   RCA+4                                                    06569000
RCAPARM0 EQU   RCA                                                      06570000
PVTEND   EQU   PVT+1944                                                 06571000
PVTTASID EQU   PVT+1942                                                 06572000
PVTXXXXX EQU   PVT+1940                                                 06573000
PVTMVCLC EQU   PVT+1936                                                 06574000
PVTVCONS EQU   PVT+1896                                                 06575000
PVTPRSB  EQU   PVT+1892                                                 06576000
PVTCIOQF EQU   PVTPCBQS+32                                              06577000
PVTGFADF EQU   PVTPCBQS+24                                              06578000
PVTFPCBL EQU   PVTPCBQS+20                                              06579000
PVTFPCBF EQU   PVTPCBQS+16                                              06580000
PVTPCBQR EQU   PVTPCBQS                                                 06581000
PVTLPAFX EQU   PVT+1850                                                 06582000
PVTLSQAF EQU   PVT+1848                                                 06583000
PVTLPAR  EQU   PVT+1844                                                 06584000
PVTLPAI  EQU   PVT+1840                                                 06585000
PVTLPAFC EQU   PVT+1838                                                 06586000
PVTCHUIC EQU   PVT+1836                                                 06587000
PVTSQAFX EQU   PVT+1832                                                 06588000
PVTDEFFX EQU   PVT+1828                                                 06589000
PVTFIXOK EQU   PVT+1826                                                 06590000
PVTPEROK EQU   PVT+1824                                                 06591000
PVTMAXFX EQU   PVT+1822                                                 06592000
PVTPERFX EQU   PVT+1820                                                 06593000
PVTRSRB  EQU   PVT+1776                                                 06594000
PVTRESV5 EQU   PVT+1773                                                 06595000
PVTSRBS  EQU   PVT+1772                                                 06596000
PVTSSRB  EQU   PVT+1768                                                 06597000
PVTACA   EQU   PVTWSAX+1400                                             06598000
PVTWSA18 EQU   PVTWSAX+1256                                             06599000
PVTWSA17 EQU   PVTWSAX+1184                                             06600000
PVTWSA16 EQU   PVTWSAX+1112                                             06601000
PVTWSA14 EQU   PVTWSAX+968                                              06602000
PVTWSA13 EQU   PVTWSAX+896                                              06603000
PVTWSA12 EQU   PVTWSAX+824                                              06604000
PVTWSA11 EQU   PVTWSAX+752                                              06605000
PVTWSA10 EQU   PVTWSAX+672                                              06606000
PVTWSA9  EQU   PVTWSAX+592                                              06607000
PVTWSA8  EQU   PVTWSAX+504                                              06608000
PVTWSA7  EQU   PVTWSAX+432                                              06609000
PVTWSA6  EQU   PVTWSAX+360                                              06610000
PVTWSA5  EQU   PVTWSAX+288                                              06611000
PVTWSA4  EQU   PVTWSAX+216                                              06612000
PVTWSA3  EQU   PVTWSAX+144                                              06613000
PVTWSA2  EQU   PVTWSAX+72                                               06614000
PVTWSA1  EQU   PVTWSAX                                                  06615000
PVTPFTQR EQU   PVTQS+20                                                 06616000
PVTRSBQL EQU   PVTQS+18                                                 06617000
PVTRSBQF EQU   PVTQS+16                                                 06618000
PVTSQAQL EQU   PVTQS+14                                                 06619000
PVTSQAQF EQU   PVTQS+12                                                 06620000
PVTCFQL  EQU   PVTQS+10                                                 06621000
PVTCFQF  EQU   PVTQS+8                                                  06622000
PVTRSRVL EQU   PVTQS+6                                                  06623000
PVTRSRVF EQU   PVTQS+4                                                  06624000
PVTAFQL  EQU   PVTQS+2                                                  06625000
PVTAFQF  EQU   PVTQS                                                    06626000
PVTCFMCT EQU   PVT+300                                                  06627000
PVTSPREC EQU   PVT+296                                                  06628000
PVTCAREC EQU   PVT+292                                                  06629000
PVTCAOUT EQU   PVT+288                                                  06630000
PVTCAIN  EQU   PVT+284                                                  06631000
PVTNSWPS EQU   PVT+280                                                  06632000
PVTNPREC EQU   PVT+276                                                  06633000
PVTSPOUT EQU   PVT+272                                                  06634000
PVTSPIN  EQU   PVT+268                                                  06635000
PVTVAMR  EQU   PVT+264                                                  06636000
PVTVAMO  EQU   PVT+260                                                  06637000
PVTVAMI  EQU   PVT+256                                                  06638000
PVTNPOUT EQU   PVT+252                                                  06639000
PVTNPIN  EQU   PVT+248                                                  06640000
PVTFRSLT EQU   PVT+240                                                  06641000
PVTSWPIO EQU   PVT+232                                                  06642000
PVTPSWPP EQU   PVT+228                                                  06643000
PVTPPREF EQU   PVT+224                                                  06644000
PVTPRELV EQU   PVT+212                                                  06645000
PVTPFREE EQU   PVT+208                                                  06646000
PVTPRELS EQU   PVT+204                                                  06647000
PVTPOUT  EQU   PVT+200                                                  06648000
PVTPFXLD EQU   PVT+196                                                  06649000
PVTPITAS EQU   PVT+192                                                  06650000
PVTPDSEG EQU   PVT+184                                                  06651000
PVTPCSGB EQU   PVT+180                                                  06652000
PVTPCSEG EQU   PVT+176                                                  06653000
PVTPINV  EQU   PVT+172                                                  06654000
PVTPSOUT EQU   PVT+164                                                  06655000
PVTPSWIN EQU   PVT+160                                                  06656000
PVTPRCFI EQU   PVT+152                                                  06657000
PVTPRCF  EQU   PVT+148                                                  06658000
PVTPVRC  EQU   PVT+144                                                  06659000
PVTPVRIN EQU   PVT+140                                                  06660000
PVTPVRLS EQU   PVT+136                                                  06661000
PVTPVEQR EQU   PVT+132                                                  06662000
PVTPVRPO EQU   PVT+124                                                  06663000
PVTPRFR  EQU   PVT+120                                                  06664000
PVTPFP   EQU   PVT+112                                                  06665000
PVTREP2  EQU   PVT+100                                                  06666000
PVTPIOCP EQU   PVT+96                                                   06667000
PVTPIOP  EQU   PVT+92                                                   06668000
PVTPGFAD EQU   PVT+88                                                   06669000
PVTPGFA  EQU   PVT+84                                                   06670000
PVTPSQA  EQU   PVT+80                                                   06671000
PVTPSINT EQU   PVT+76                                                   06672000
PVTPSIB  EQU   PVT+72                                                   06673000
PVTSRBID EQU   PVT+68                                                   06674000
PVTPCIWA EQU   PVT+64                                                   06675000
PVTHQSA  EQU   PVT+62                                                   06676000
PVTLQSA  EQU   PVT+60                                                   06677000
PVTOROOT EQU   PVT+56                                                   06678000
PVTREUS  EQU   PVT+48                                                   06679000
PVTSQNPC EQU   PVT+47                                                   06680000
PVTSQVRC EQU   PVT+46                                                   06681000
PVTRSUS  EQU   PVT+44                                                   06682000
PVTVROOT EQU   PVT+40                                                   06683000
PVTPCBLO EQU   PVT+38                                                   06684000
PVTPCBCT EQU   PVT+36                                                   06685000
PVTDFRS  EQU   PVT+34                                                   06686000
PVTRSQA  EQU   PVT+32                                                   06687000
PVTPTLB  EQU   PVT+31                                                   06688000
PVTPCBNO EQU   PVT+30                                                   06689000
PVTSRBNO EQU   PVT+29                                                   06690000
PVTSQDC  EQU   PVT+28                                                   06691000
PVTLPRIV EQU   PVT+24                                                   06692000
PVTLVR   EQU   PVT+22                                                   06693000
PVTFVR   EQU   PVT+20                                                   06694000
PVTLPFN  EQU   PVT+18                                                   06695000
PVTFPFN  EQU   PVT+16                                                   06696000
PVTSSPIN EQU   PVT+11                                                   06697000
PVTPCBS  EQU   PVT+10                                                   06698000
PVTPOOL  EQU   PVT+8                                                    06699000
PVTAFCOK EQU   PVT+6                                                    06700000
PVTAFCLO EQU   PVT+4                                                    06701000
PVTAFC   EQU   PVT+2                                                    06702000
@NM00049 EQU   PVTFLAG2                                                 06703000
PVTRSMGM EQU   PVTFLAG2                                                 06704000
PVTDUMP  EQU   PVTFLAG1                                                 06705000
PVTSIT   EQU   PVTFLAG1                                                 06706000
PVTLSI   EQU   PVTFLAG1                                                 06707000
PVTAPREF EQU   PVTFLAG1                                                 06708000
PVTPCBLT EQU   PVTFLAG1                                                 06709000
PVTSRBIU EQU   PVTFLAG1                                                 06710000
PVTBGMS  EQU   PVTFLAG1                                                 06711000
PVTPMSG  EQU   PVTFLAG1                                                 06712000
PGTPAM   EQU   PGTBITS                                                  06713000
@NM00024 EQU   PGTBITS                                                  06714000
@NM00023 EQU   PGTBITS                                                  06715000
@NM00022 EQU   PGTBITS                                                  06716000
@NM00021 EQU   PGTBITS                                                  06717000
@NM00020 EQU   PGTBITS                                                  06718000
@NM00019 EQU   PGTBITS                                                  06719000
PGTREAL  EQU   PGTRSA                                                   06720000
PFTQNDX  EQU   PFTE+14                                                  06721000
@NM00018 EQU   PFTFLAG2                                                 06722000
@NM00017 EQU   PFTFLAG2                                                 06723000
PFTSTEAL EQU   PFTFLAG2                                                 06724000
PFTVR    EQU   PFTFLAG2                                                 06725000
PFTOFFLN EQU   PFTFLAG2                                                 06726000
PFTOFINT EQU   PFTFLAG1                                                 06727000
PFTVRALC EQU   PFTFLAG1                                                 06728000
PFTVRINT EQU   PFTFLAG1                                                 06729000
PFTONAVQ EQU   PFTFLAG1                                                 06730000
PFTRSV1  EQU   PFTE+10                                                  06731000
PFTASID  EQU   PFTPGID                                                  06732000
PCBRWRKB EQU   PCBR+60                                                  06733000
PCBRWRKA EQU   PCBR+56                                                  06734000
PCBRWRK9 EQU   PCBR+52                                                  06735000
PCBRWRK8 EQU   PCBR+48                                                  06736000
PCBRWRK7 EQU   PCBR+44                                                  06737000
PCBRWRK6 EQU   PCBR+40                                                  06738000
PCBRWRK5 EQU   PCBR+36                                                  06739000
PCBRWRK4 EQU   PCBR+32                                                  06740000
PCBRWRK3 EQU   PCBR+28                                                  06741000
PCBRWRK2 EQU   PCBR+24                                                  06742000
PCBRWRK1 EQU   PCBR+20                                                  06743000
PCBRRSV1 EQU   PCBR+18                                                  06744000
PCBRASCB EQU   PCBR+12                                                  06745000
PCBRPOF  EQU   PCBRFLAG                                                 06746000
PCBRFECB EQU   PCBRFLAG                                                 06747000
PCBRLOAD EQU   PCBRFLAG                                                 06748000
PCBRFPCB EQU   PCBRFLAG                                                 06749000
PCBRPB   EQU   PCBRFLAG                                                 06750000
PCBRETRY EQU   PCBRFLAG                                                 06751000
PCBRINT  EQU   PCBRFLAG                                                 06752000
PCBEND   EQU   PCB+64                                                   06753000
PCBSWPS2 EQU   PCBFL3                                                   06754000
@NM00016 EQU   PCBFL3                                                   06755000
PCBNOREC EQU   PCBFL3                                                   06756000
PCBDFRLS EQU   PCBFL3                                                   06757000
PCBSWPLS EQU   PCBFL3                                                   06758000
PCBSWPS1 EQU   PCBFL3                                                   06759000
PCBSWPIN EQU   PCBFL3                                                   06760000
@NM00015 EQU   PCBFL2                                                   06761000
@NM00014 EQU   PCBFL2                                                   06762000
PCBVIO   EQU   PCBFL2                                                   06763000
PCBGFAD  EQU   PCBFL2                                                   06764000
PCBLFR   EQU   PCBFL1                                                   06765000
PCBLLHLD EQU   PCBFL1                                                   06766000
PCBPEX   EQU   PCBFL1                                                   06767000
@NM00013 EQU   PCBFL1                                                   06768000
PCBCQN   EQU   PCBFQP                                                   06769000
OUXBEND  EQU   OUXB+144                                                 06770000
OUXBTSW  EQU   OUXB+140                                                 06771000
OUXBFIXC EQU   OUXB+138                                                 06772000
OUXBNVC  EQU   OUXB+136                                                 06773000
OUXBUIC  EQU   OUXB+134                                                 06774000
OUXBVSC  EQU   OUXB+132                                                 06775000
OUXBILS  EQU   OUXB+128                                                 06776000
OUXBRSV1 EQU   OUXB+126                                                 06777000
OUXBWCT  EQU   OUXB+124                                                 06778000
OUXBPRS  EQU   OUXB+120                                                 06779000
OUXBSTD  EQU   OUXB+116                                                 06780000
OUXBITD  EQU   OUXB+112                                                 06781000
OUXBMSS  EQU   OUXB+104                                                 06782000
OUXBCPS  EQU   OUXB+96                                                  06783000
OUXBAET  EQU   OUXB+92                                                  06784000
OUXBTRR  EQU   OUXB+88                                                  06785000
OUXBJBR  EQU   OUXB+84                                                  06786000
OUXBTRT  EQU   OUXB+80                                                  06787000
OUXBTRS  EQU   OUXB+76                                                  06788000
OUXBJBT  EQU   OUXB+72                                                  06789000
OUXBJBS  EQU   OUXB+68                                                  06790000
OUXBTRC  EQU   OUXB+64                                                  06791000
OUXBNQT  EQU   OUXB+60                                                  06792000
OUXBIOSM EQU   OUXB+56                                                  06793000
OUXBIOS  EQU   OUXB+52                                                  06794000
OUXBSTCT EQU   OUXB+48                                                  06795000
OUXBCAPR EQU   OUXB+44                                                  06796000
OUXBCAPI EQU   OUXB+40                                                  06797000
OUXBVAMR EQU   OUXB+36                                                  06798000
OUXBVAMO EQU   OUXB+32                                                  06799000
OUXBVAMI EQU   OUXB+28                                                  06800000
OUXBPREC EQU   OUXB+24                                                  06801000
OUXBPOUT EQU   OUXB+20                                                  06802000
OUXBPIN  EQU   OUXB+16                                                  06803000
OUXBRSW  EQU   OUXB+12                                                  06804000
OUXBMET  EQU   OUXB+8                                                   06805000
OUXBPET  EQU   OUXB+4                                                   06806000
OUXBNAME EQU   OUXB                                                     06807000
@NM00012 EQU   FRRSFLGS+1                                               06808000
@NM00011 EQU   FRRSFLG1                                                 06809000
FRRSNEST EQU   FRRSFLG1                                                 06810000
FRRSRCUR EQU   FRRSFLG1                                                 06811000
FRRSENTS EQU   FRRS+84                                                  06812000
FRRSRTMW EQU   FRRS+16                                                  06813000
@NM00010 EQU   FOEFLAG                                                  06814000
@NM00009 EQU   FOEFLAG                                                  06815000
@NM00008 EQU   FOEFLAG                                                  06816000
@NM00007 EQU   FOEFLAG                                                  06817000
@NM00006 EQU   FOEFLAG                                                  06818000
@NM00005 EQU   FOEFLAG                                                  06819000
@NM00004 EQU   FOEFLAG                                                  06820000
FOEINT   EQU   FOEFLAG                                                  06821000
CVTLEVL  EQU   CVTRELNO+2                                               06822000
CVTNUMB  EQU   CVTRELNO                                                 06823000
CVTMDL   EQU   CVTFIX+250                                               06824000
@NM00003 EQU   CVTFIX+248                                               06825000
@NM00002 EQU   CVTFIX                                                   06826000
CVTRV482 EQU   CVTXTNT2+128                                             06827000
CVTRV481 EQU   CVTXTNT2+124                                             06828000
CVTRV480 EQU   CVTXTNT2+120                                             06829000
CVTRV479 EQU   CVTXTNT2+118                                             06830000
CVTRV478 EQU   CVTXTNT2+117                                             06831000
CVTRV477 EQU   CVTXTNT2+116                                             06832000
CVTRV476 EQU   CVTXTNT2+115                                             06833000
CVTRV475 EQU   CVTXTNT2+114                                             06834000
CVTRV474 EQU   CVTRV466                                                 06835000
CVTRV473 EQU   CVTRV466                                                 06836000
CVTRV472 EQU   CVTRV466                                                 06837000
CVTRV471 EQU   CVTRV466                                                 06838000
CVTRV470 EQU   CVTRV466                                                 06839000
CVTRV469 EQU   CVTRV466                                                 06840000
CVTRV468 EQU   CVTRV466                                                 06841000
CVTRV467 EQU   CVTRV466                                                 06842000
CVTRV465 EQU   CVTRV457                                                 06843000
CVTRV464 EQU   CVTRV457                                                 06844000
CVTRV463 EQU   CVTRV457                                                 06845000
CVTRV462 EQU   CVTRV457                                                 06846000
CVTRV461 EQU   CVTRV457                                                 06847000
CVTRV460 EQU   CVTRV457                                                 06848000
CVTRV459 EQU   CVTRV457                                                 06849000
CVTRV458 EQU   CVTRV457                                                 06850000
CVTRV456 EQU   CVTXTNT2+108                                             06851000
CVTRV455 EQU   CVTXTNT2+104                                             06852000
CVTRV454 EQU   CVTXTNT2+100                                             06853000
CVTRV453 EQU   CVTXTNT2+96                                              06854000
CVTRV452 EQU   CVTXTNT2+94                                              06855000
CVTRV451 EQU   CVTXTNT2+92                                              06856000
CVTRV450 EQU   CVTXTNT2+90                                              06857000
CVTRV449 EQU   CVTXTNT2+88                                              06858000
CVTRV448 EQU   CVTXTNT2+87                                              06859000
CVTRV447 EQU   CVTXTNT2+86                                              06860000
CVTRV446 EQU   CVTRV438                                                 06861000
CVTRV445 EQU   CVTRV438                                                 06862000
CVTRV444 EQU   CVTRV438                                                 06863000
CVTRV443 EQU   CVTRV438                                                 06864000
CVTRV442 EQU   CVTRV438                                                 06865000
CVTRV441 EQU   CVTRV438                                                 06866000
CVTRV440 EQU   CVTRV438                                                 06867000
CVTRV439 EQU   CVTRV438                                                 06868000
CVTRV437 EQU   CVTRV429                                                 06869000
CVTRV436 EQU   CVTRV429                                                 06870000
CVTRV435 EQU   CVTRV429                                                 06871000
CVTRV434 EQU   CVTRV429                                                 06872000
CVTRV433 EQU   CVTRV429                                                 06873000
CVTRV432 EQU   CVTRV429                                                 06874000
CVTRV431 EQU   CVTRV429                                                 06875000
CVTRV430 EQU   CVTRV429                                                 06876000
CVTRV428 EQU   CVTXTNT2+80                                              06877000
CVTRV427 EQU   CVTXTNT2+76                                              06878000
CVTRV426 EQU   CVTXTNT2+72                                              06879000
CVTRV425 EQU   CVTXTNT2+68                                              06880000
CVTATACT EQU   CVTATCVT                                                 06881000
CVTRV423 EQU   CVTXTNT2+62                                              06882000
CVTRV422 EQU   CVTXTNT2+60                                              06883000
CVTRV421 EQU   CVTXTNT2+58                                              06884000
CVTRV420 EQU   CVTXTNT2+56                                              06885000
CVTRV419 EQU   CVTXTNT2+55                                              06886000
CVTRV418 EQU   CVTXTNT2+54                                              06887000
CVTRV417 EQU   CVTRV409                                                 06888000
CVTRV416 EQU   CVTRV409                                                 06889000
CVTRV415 EQU   CVTRV409                                                 06890000
CVTRV414 EQU   CVTRV409                                                 06891000
CVTRV413 EQU   CVTRV409                                                 06892000
CVTRV412 EQU   CVTRV409                                                 06893000
CVTRV411 EQU   CVTRV409                                                 06894000
CVTRV410 EQU   CVTRV409                                                 06895000
CVTRV408 EQU   CVTRV400                                                 06896000
CVTRV407 EQU   CVTRV400                                                 06897000
CVTRV406 EQU   CVTRV400                                                 06898000
CVTRV405 EQU   CVTRV400                                                 06899000
CVTRV404 EQU   CVTRV400                                                 06900000
CVTRV403 EQU   CVTRV400                                                 06901000
CVTRV402 EQU   CVTRV400                                                 06902000
CVTRV401 EQU   CVTRV400                                                 06903000
CVTICB   EQU   CVTXTNT2+48                                              06904000
CVTSKTA  EQU   CVTXTNT2+44                                              06905000
CVTCCVT  EQU   CVTXTNT2+40                                              06906000
CVTRSV98 EQU   CVTXTNT2+36                                              06907000
CVTRSV97 EQU   CVTXTNT2+34                                              06908000
CVTRSV96 EQU   CVTXTNT2+32                                              06909000
CVTOLTEP EQU   CVTXTNT2+28                                              06910000
CVTQIDA  EQU   CVTQID+1                                                 06911000
CVTRSV95 EQU   CVTQID                                                   06912000
CVTRSV94 EQU   CVTXTNT2+20                                              06913000
CVTRSV93 EQU   CVTXTNT2+16                                              06914000
CVTRSV92 EQU   CVTXTNT2+12                                              06915000
CVTDEBVR EQU   CVTXTNT2+8                                               06916000
CVTRSV91 EQU   CVTXTNT2+6                                               06917000
CVTRSV9H EQU   CVTFLGBT                                                 06918000
CVTRSV9G EQU   CVTFLGBT                                                 06919000
CVTRSV9F EQU   CVTFLGBT                                                 06920000
CVTRSV9E EQU   CVTFLGBT                                                 06921000
CVTRSV9D EQU   CVTFLGBT                                                 06922000
CVTBAH   EQU   CVTFLGBT                                                 06923000
CVTVME   EQU   CVTFLGBT                                                 06924000
CVTNPE   EQU   CVTFLGBT                                                 06925000
CVTNUCLS EQU   CVTXTNT2+4                                               06926000
CVTDSSVA EQU   CVTDSSV+1                                                06927000
CVTRSV89 EQU   CVTDSSV                                                  06928000
CVTRSV88 EQU   CVTXTNT1+8                                               06929000
CVTRSV87 EQU   CVTXTNT1+4                                               06930000
CVTFACHN EQU   CVTXTNT1                                                 06931000
CVTRV488 EQU   CVTMAP+412                                               06932000
CVTRV487 EQU   CVTMAP+408                                               06933000
CVTRV486 EQU   CVTMAP+404                                               06934000
CVTRV485 EQU   CVTMAP+400                                               06935000
CVTACTAP EQU   CVTMAP+396                                               06936000
CVTAUTH  EQU   CVTMAP+392                                               06937000
CVTRV490 EQU   CVTMAP+388                                               06938000
CVTSU    EQU   CVTMAP+384                                               06939000
CVTVOLT1 EQU   CVTVOLM1+1                                               06940000
CVTVOLI1 EQU   CVTVOLF1                                                 06941000
CVTSTOA  EQU   CVTMAP+376                                               06942000
CVTRSV58 EQU   CVTMAP+374                                               06943000
CVTRSV57 EQU   CVTMAP+372                                               06944000
CVTDDCE  EQU   CVTMAP+368                                               06945000
CVTPNWFR EQU   CVTMAP+364                                               06946000
CVTSMF   EQU   CVTMAP+360                                               06947000
CVTSULK  EQU   CVTMAP+358                                               06948000
CVTSLKO  EQU   CVTSYSK                                                  06949000
CVTSLKP  EQU   CVTSYSK                                                  06950000
CVTSLKQ  EQU   CVTSYSK                                                  06951000
CVTSLKR  EQU   CVTSYSK                                                  06952000
CVTRSV56 EQU   CVTSYSK                                                  06953000
CVTRSV55 EQU   CVTSYSK                                                  06954000
CVTRSV54 EQU   CVTSYSK                                                  06955000
CVTRSV53 EQU   CVTSYSK                                                  06956000
CVTRSV52 EQU   CVTA1F1                                                  06957000
CVTRSV51 EQU   CVTA1F1                                                  06958000
CVTRSV50 EQU   CVTA1F1                                                  06959000
CVTRSV49 EQU   CVTA1F1                                                  06960000
CVTRSV48 EQU   CVTA1F1                                                  06961000
CVTRSV47 EQU   CVTA1F1                                                  06962000
CVTSRSW  EQU   CVTA1F1                                                  06963000
CVTPFSW  EQU   CVTA1F1                                                  06964000
CVTPCVT  EQU   CVTMAP+352                                               06965000
CVTRSV46 EQU   CVTMAP+344                                               06966000
CVTRSV45 EQU   CVTMAP+340                                               06967000
CVTRSV44 EQU   CVTMAP+338                                               06968000
CVTRSV43 EQU   CVTMAP+336                                               06969000
CVTHJESA EQU   CVTHJES+1                                                06970000
CVTRSV42 EQU   CVTHJES                                                  06971000
CVTEXT2A EQU   CVTEXT2+1                                                06972000
CVTRSV41 EQU   CVTEXT2                                                  06973000
CVTAPFA  EQU   CVTAPF+1                                                 06974000
CVTRSV40 EQU   CVTAPF                                                   06975000
CVTRV518 EQU   CVTINTLA                                                 06976000
CVTRV517 EQU   CVTERPV                                                  06977000
CVTEORM  EQU   CVTMAP+312                                               06978000
CVTMCHPR EQU   CVTMAP+308                                               06979000
CVTTZ    EQU   CVTMAP+304                                               06980000
CVTJEPS  EQU   CVTMAP+300                                               06981000
CVTJESCT EQU   CVTMAP+296                                               06982000
CVTMODE  EQU   CVTMAP+292                                               06983000
CVTPTRV  EQU   CVTMAP+288                                               06984000
CVTREAL  EQU   CVTMAP+284                                               06985000
CVTRSV39 EQU   CVTMAP+280                                               06986000
CVTRSV38 EQU   CVTMAP+276                                               06987000
CVTDMSRA EQU   CVTDMSR+1                                                06988000
CVTRV634 EQU   CVTDMSRF                                                 06989000
CVTRV633 EQU   CVTDMSRF                                                 06990000
CVTRV632 EQU   CVTDMSRF                                                 06991000
CVTRV631 EQU   CVTDMSRF                                                 06992000
CVTRV630 EQU   CVTDMSRF                                                 06993000
CVTRV629 EQU   CVTDMSRF                                                 06994000
CVTUDUMP EQU   CVTDMSRF                                                 06995000
CVTSDUMP EQU   CVTDMSRF                                                 06996000
CVTQMSGA EQU   CVTQMSG+1                                                06997000
CVTRSV36 EQU   CVTQMSG                                                  06998000
CVTAMFF  EQU   CVTMAP+264                                               06999000
CVTPURGA EQU   CVTPURG+1                                                07000000
CVTRSV35 EQU   CVTPURG                                                  07001000
CVTCBSP  EQU   CVTMAP+256                                               07002000
CVTATERA EQU   CVTATER+1                                                07003000
CVTSYST  EQU   CVTATER                                                  07004000
CVTVOLT2 EQU   CVTTAT                                                   07005000
CVTVOLI2 EQU   CVTVOLF2                                                 07006000
CVTAQAVB EQU   CVTAQAVT+1                                               07007000
CVTRSV34 EQU   CVTTCMFG                                                 07008000
CVTRSV33 EQU   CVTTCMFG                                                 07009000
CVTRSV32 EQU   CVTTCMFG                                                 07010000
CVTRSV31 EQU   CVTTCMFG                                                 07011000
CVTRSV30 EQU   CVTTCMFG                                                 07012000
CVTRSV29 EQU   CVTTCMFG                                                 07013000
CVTLDEV  EQU   CVTTCMFG                                                 07014000
CVTTCRDY EQU   CVTTCMFG                                                 07015000
CVTGTFA  EQU   CVTGTF+1                                                 07016000
CVTRSV27 EQU   CVTGTFST                                                 07017000
CVTRNIO  EQU   CVTGTFST                                                 07018000
CVTUSR   EQU   CVTGTFST                                                 07019000
CVTRV318 EQU   CVTFORM                                                  07020000
CVTRV317 EQU   CVTTMODE                                                 07021000
CVTRV316 EQU   CVTSTATE                                                 07022000
CVTRV315 EQU   CVTGTFS                                                  07023000
CVTGTFAV EQU   CVTGTFS                                                  07024000
CVT0SCR1 EQU   CVTMAP+232                                               07025000
CVTRV515 EQU   CVTMAP+228                                               07026000
CVTRMS   EQU   CVTMAP+224                                               07027000
CVTPATCH EQU   CVTMAP+220                                               07028000
CVTTSCE  EQU   CVTMAP+216                                               07029000
CVTLNKSC EQU   CVTMAP+214                                               07030000
CVTQABST EQU   CVTMAP+212                                               07031000
CVTMDLDS EQU   CVTMAP+208                                               07032000
CVTUSER  EQU   CVTMAP+204                                               07033000
CVTSMCA  EQU   CVTMAP+196                                               07034000
CVTRSV18 EQU   CVTMAP+192                                               07035000
CVTQLPAQ EQU   CVTMAP+188                                               07036000
CVTQCDSR EQU   CVTMAP+184                                               07037000
CVTVS1B  EQU   CVTOPTB                                                  07038000
CVTVS1A  EQU   CVTOPTB                                                  07039000
CVTFP    EQU   CVTOPTB                                                  07040000
CVTAPTHR EQU   CVTOPTB                                                  07041000
CVTNLOG  EQU   CVTOPTB                                                  07042000
CVTTOD   EQU   CVTOPTB                                                  07043000
CVTCTIMS EQU   CVTOPTB                                                  07044000
CVTPROT  EQU   CVTOPTB                                                  07045000
CVTXPFP  EQU   CVTOPTA                                                  07046000
CVTASCII EQU   CVTOPTA                                                  07047000
CVTRSV13 EQU   CVTOPTA                                                  07048000
CVTRSV12 EQU   CVTOPTA                                                  07049000
CVTNIP   EQU   CVTOPTA                                                  07050000
CVTDDR   EQU   CVTOPTA                                                  07051000
CVTAPR   EQU   CVTOPTA                                                  07052000
CVTCCH   EQU   CVTOPTA                                                  07053000
CVTSNCTR EQU   CVTMAP+180                                               07054000
CVTQMWR  EQU   CVTMAP+176                                               07055000
CVTQOCR  EQU   CVTMAP+172                                               07056000
CVT1EF00 EQU   CVTMAP+168                                               07057000
CVTMZ00  EQU   CVTMAP+164                                               07058000
CVTSV76Q EQU   CVTSV76C                                                 07059000
CVTRSV11 EQU   CVTMAP+156                                               07060000
CVT0PT01 EQU   CVTMAP+152                                               07061000
CVTMSER  EQU   CVTMAP+148                                               07062000
CVTRV516 EQU   CVTIERLC                                                 07063000
CVTILCH  EQU   CVTMAP+140                                               07064000
CVT0DS   EQU   CVTMAP+136                                               07065000
CVTFBOSV EQU   CVTMAP+132                                               07066000
CVTNUCB  EQU   CVTMAP+128                                               07067000
CVTIXAVL EQU   CVTMAP+124                                               07068000
CVTSV76M EQU   CVTIOQET                                                 07069000
CVTDCBA  EQU   CVTMAP+117                                               07070000
CVTMVS2  EQU   CVTDCB                                                   07071000
CVT6DAT  EQU   CVTDCB                                                   07072000
CVT4MPS  EQU   CVTDCB                                                   07073000
CVTRSV09 EQU   CVTDCB                                                   07074000
CVT4MS1  EQU   CVTDCB                                                   07075000
CVT2SPS  EQU   CVTDCB                                                   07076000
CVT1SSS  EQU   CVTDCB                                                   07077000
CVTRSV08 EQU   CVTDCB                                                   07078000
CVTSTB   EQU   CVTMAP+112                                               07079000
CVTQTD00 EQU   CVTMAP+108                                               07080000
CVTQTE00 EQU   CVTMAP+104                                               07081000
CVTCUCB  EQU   CVTMAP+100                                               07082000
CVTSJQ   EQU   CVTMAP+96                                                07083000
CVTPBLDL EQU   CVTMAP+92                                                07084000
CVTTPC   EQU   CVTMAP+88                                                07085000
CVTSVDCB EQU   CVTMAP+84                                                07086000
CVTBRET  EQU   CVTMAP+82                                                07087000
CVTEXIT  EQU   CVTMAP+80                                                07088000
CVT0FN00 EQU   CVTMAP+76                                                07089000
CVTDARA  EQU   CVTDAR+1                                                 07090000
CVTRSV07 EQU   CVTFLGS1                                                 07091000
CVTRSV06 EQU   CVTFLGS1                                                 07092000
CVTRSV05 EQU   CVTFLGS1                                                 07093000
CVTRSV04 EQU   CVTFLGS1                                                 07094000
CVTRSV03 EQU   CVTFLGS1                                                 07095000
CVTRSV02 EQU   CVTFLGS1                                                 07096000
CVTRSV01 EQU   CVTFLGS1                                                 07097000
CVTDMPLK EQU   CVTFLGS1                                                 07098000
CVTXITP  EQU   CVTMAP+68                                                07099000
CVTZDTAB EQU   CVTMAP+64                                                07100000
CVTMSLT  EQU   CVTMAP+60                                                07101000
CVTDATE  EQU   CVTMAP+56                                                07102000
CVTBTERM EQU   CVTMAP+52                                                07103000
CVTSYSAD EQU   CVTMAP+48                                                07104000
CVTXTLER EQU   CVTMAP+44                                                07105000
CVTILK2  EQU   CVTMAP+40                                                07106000
CVTILK1  EQU   CVTMAP+36                                                07107000
CVTPRLTV EQU   CVTMAP+32                                                07108000
CVTPCNVT EQU   CVTMAP+28                                                07109000
CVT0VL00 EQU   CVTMAP+24                                                07110000
CVTXAPG  EQU   CVTMAP+20                                                07111000
CVTBUF   EQU   CVTMAP+16                                                07112000
CVTJOB   EQU   CVTMAP+12                                                07113000
CVTLINK  EQU   CVTMAP+8                                                 07114000
CVT0EF00 EQU   CVTMAP+4                                                 07115000
CVTTCBP  EQU   CVTMAP                                                   07116000
WSALACHP EQU   WSAL+56                                                  07117000
WSALEVNT EQU   WSAL+48                                                  07118000
WSALSTAE EQU   WSAL+44                                                  07119000
WSALSTAT EQU   WSAL+40                                                  07120000
WSALWAIT EQU   WSAL+36                                                  07121000
WSALPOST EQU   WSAL+32                                                  07122000
WSALEXIT EQU   WSAL+28                                                  07123000
WSALS2EE EQU   WSAL+24                                                  07124000
WSALCIRB EQU   WSAL+20                                                  07125000
WSALABTM EQU   WSAL+16                                                  07126000
WSALSDMP EQU   WSAL+12                                                  07127000
WSALRTM2 EQU   WSAL+8                                                   07128000
WSALVALC EQU   WSAL+4                                                   07129000
WSALCWSA EQU   WSAL                                                     07130000
ASXBEND  EQU   ASXB+232                                                 07131000
ASXBRV25 EQU   ASXB+228                                                 07132000
ASXBRV24 EQU   ASXB+224                                                 07133000
ASXBPT0E EQU   ASXB+220                                                 07134000
ASXBCRB4 EQU   ASXBCASW+3                                               07135000
ASXBCRB3 EQU   ASXBCASW+2                                               07136000
ASXBCRB2 EQU   ASXBCASW+1                                               07137000
ASXBCR06 EQU   ASXBCRB1                                                 07138000
ASXBCR05 EQU   ASXBCRB1                                                 07139000
ASXBCR04 EQU   ASXBCRB1                                                 07140000
ASXBCR03 EQU   ASXBCRB1                                                 07141000
ASXBCR02 EQU   ASXBCRB1                                                 07142000
ASXBCR01 EQU   ASXBCRB1                                                 07143000
ASXBTFD  EQU   ASXBCRB1                                                 07144000
ASXBPIP  EQU   ASXBCRB1                                                 07145000
ASXBCTDC EQU   ASXB+212                                                 07146000
ASXBTDCB EQU   ASXB+208                                                 07147000
ASXBRV19 EQU   ASXB+204                                                 07148000
ASXBSENV EQU   ASXBSECR+1                                               07149000
ASXBRV34 EQU   ASCBSFLG                                                 07150000
ASXBRV33 EQU   ASCBSFLG                                                 07151000
ASXBRV32 EQU   ASCBSFLG                                                 07152000
ASXBRV31 EQU   ASCBSFLG                                                 07153000
ASXBRV30 EQU   ASCBSFLG                                                 07154000
ASXBRV29 EQU   ASCBSFLG                                                 07155000
ASXBRV28 EQU   ASCBSFLG                                                 07156000
ASXBRV27 EQU   ASCBSFLG                                                 07157000
ASXBUSER EQU   ASXB+192                                                 07158000
ASXBLSRB EQU   ASXBAEQ+20                                               07159000
ASXBFSRB EQU   ASXBAEQ+16                                               07160000
ASXBLRQE EQU   ASXBAEQ+12                                               07161000
ASXBFRQE EQU   ASXBAEQ+8                                                07162000
ASXBLIQE EQU   ASXBAEQ+4                                                07163000
ASXBFIQE EQU   ASXBAEQ                                                  07164000
ASXBETSK EQU   ASXB+164                                                 07165000
ASXBSIRB EQU   ASXB+160                                                 07166000
ASXBPSWD EQU   ASXB+152                                                 07167000
ASXBPRG  EQU   ASXB+136                                                 07168000
ASXBRV26 EQU   ASXB+132                                                 07169000
ASXBOUSB EQU   ASXB+128                                                 07170000
ASXBDDR  EQU   ASXB+124                                                 07171000
ASXBRCTD EQU   ASXB+120                                                 07172000
ASXBRSMD EQU   ASXB+116                                                 07173000
ASXBFRWA EQU   ASXB+108                                                 07174000
ASXBFLSA EQU   ASXB+36                                                  07175000
ASXBIHSA EQU   ASXB+32                                                  07176000
ASXBRV15 EQU   ASXB+28                                                  07177000
ASXBRV14 EQU   ASXB+24                                                  07178000
ASXBLWA  EQU   ASXB+20                                                  07179000
ASXBMPST EQU   ASXB+16                                                  07180000
ASXBRS00 EQU   ASXB+14                                                  07181000
ASXBTCBS EQU   ASXB+12                                                  07182000
ASXBLTCB EQU   ASXB+8                                                   07183000
ASXBASXB EQU   ASXB                                                     07184000
ASXBEGIN EQU   ASXB                                                     07185000
ASVTEND  EQU   ASVT+528                                                 07186000
ASVTAVAL EQU   ASVTENTY                                                 07187000
ASVTAVAI EQU   ASVTFRST                                                 07188000
ASVTRS00 EQU   ASVT+520                                                 07189000
ASVTMAXU EQU   ASVT+516                                                 07190000
ASVTASVT EQU   ASVT+512                                                 07191000
ASVTBEGN EQU   ASVT+512                                                 07192000
@NM00001 EQU   ASVT                                                     07193000
ASCBEND  EQU   ASCB+208                                                 07194000
ASCBSRBT EQU   ASCB+200                                                 07195000
ASCBSWTL EQU   ASCB+196                                                 07196000
ASCBRS14 EQU   ASCB+195                                                 07197000
ASCBSMCT EQU   ASCB+194                                                 07198000
ASCBRS12 EQU   ASCB+192                                                 07199000
ASCBPCTT EQU   ASCB+188                                                 07200000
ASCBVGTT EQU   ASCB+184                                                 07201000
ASCBRV43 EQU   ASCBSRQ4                                                 07202000
ASCBRV42 EQU   ASCBSRQ4                                                 07203000
ASCBRV41 EQU   ASCBSRQ4                                                 07204000
ASCBRV40 EQU   ASCBSRQ4                                                 07205000
ASCBRV39 EQU   ASCBSRQ4                                                 07206000
ASCBRV38 EQU   ASCBSRQ4                                                 07207000
ASCBRV37 EQU   ASCBSRQ4                                                 07208000
ASCBRV36 EQU   ASCBSRQ4                                                 07209000
ASCBRV35 EQU   ASCBSRQ3                                                 07210000
ASCBRV34 EQU   ASCBSRQ3                                                 07211000
ASCBRV33 EQU   ASCBSRQ3                                                 07212000
ASCBRV32 EQU   ASCBSRQ3                                                 07213000
ASCBRV31 EQU   ASCBSRQ3                                                 07214000
ASCBRV30 EQU   ASCBSRQ3                                                 07215000
ASCBRV29 EQU   ASCBSRQ3                                                 07216000
ASCBRV28 EQU   ASCBSRQ3                                                 07217000
ASCBRV27 EQU   ASCBSRQ2                                                 07218000
ASCBRV26 EQU   ASCBSRQ2                                                 07219000
ASCBRV25 EQU   ASCBSRQ2                                                 07220000
ASCBRV24 EQU   ASCBSRQ2                                                 07221000
ASCBRV23 EQU   ASCBSRQ2                                                 07222000
ASCBRV22 EQU   ASCBSRQ2                                                 07223000
ASCBRV21 EQU   ASCBSRQ2                                                 07224000
ASCBRV20 EQU   ASCBSRQ2                                                 07225000
ASCBRV19 EQU   ASCBSRQ1                                                 07226000
ASCBRV18 EQU   ASCBSRQ1                                                 07227000
ASCBRV17 EQU   ASCBSRQ1                                                 07228000
ASCBRV16 EQU   ASCBSRQ1                                                 07229000
ASCBRV15 EQU   ASCBSRQ1                                                 07230000
ASCBRV14 EQU   ASCBSRQ1                                                 07231000
ASCBRV13 EQU   ASCBSRQ1                                                 07232000
ASCBSTA  EQU   ASCBSRQ1                                                 07233000
ASCBJBNS EQU   ASCB+176                                                 07234000
ASCBJBNI EQU   ASCB+172                                                 07235000
ASCBMCC  EQU   ASCB+168                                                 07236000
ASCBRTWA EQU   ASCB+164                                                 07237000
ASCBIQEA EQU   ASCB+160                                                 07238000
ASCBXMPQ EQU   ASCB+156                                                 07239000
ASCBRS01 EQU   ASCB+154                                                 07240000
ASCBOUCB EQU   ASCB+144                                                 07241000
ASCBMECB EQU   ASCB+140                                                 07242000
ASCBQECB EQU   ASCB+136                                                 07243000
ASCBLSQH EQU   ASCBLKGP+4                                               07244000
ASCBLOCK EQU   ASCBLKGP                                                 07245000
ASCBTCBS EQU   ASCB+124                                                 07246000
ASCBNVSC EQU   ASCB+122                                                 07247000
ASCBVSC  EQU   ASCB+120                                                 07248000
ASCBSRBS EQU   ASCB+118                                                 07249000
ASCBSSRB EQU   ASCB+116                                                 07250000
ASCBRV06 EQU   ASCBFLG2                                                 07251000
ASCBRV05 EQU   ASCBFLG2                                                 07252000
ASCBRV04 EQU   ASCBFLG2                                                 07253000
ASCBSNQS EQU   ASCBFLG2                                                 07254000
ASCBS2S  EQU   ASCBFLG2                                                 07255000
ASCBCEXT EQU   ASCBFLG2                                                 07256000
ASCBPXMT EQU   ASCBFLG2                                                 07257000
ASCBXMPT EQU   ASCBFLG2                                                 07258000
ASCBRF07 EQU   ASCBDSP1                                                 07259000
ASCBRF06 EQU   ASCBDSP1                                                 07260000
ASCBRF05 EQU   ASCBDSP1                                                 07261000
ASCBRF04 EQU   ASCBDSP1                                                 07262000
ASCBRF03 EQU   ASCBDSP1                                                 07263000
ASCBRF02 EQU   ASCBDSP1                                                 07264000
ASCBFAIL EQU   ASCBDSP1                                                 07265000
ASCBNOQ  EQU   ASCBDSP1                                                 07266000
ASCBSWCT EQU   ASCB+112                                                 07267000
ASCBTMCH EQU   ASCB+104                                                 07268000
ASCBNSWP EQU   ASCBFLG1                                                 07269000
ASCBTYP1 EQU   ASCBFLG1                                                 07270000
ASCBSTND EQU   ASCBFLG1                                                 07271000
ASCBABNT EQU   ASCBFLG1                                                 07272000
ASCBS3S  EQU   ASCBFLG1                                                 07273000
ASCBCMSH EQU   ASCBFLG1                                                 07274000
ASCBTOFF EQU   ASCBFLG1                                                 07275000
ASCBRF01 EQU   ASCBRCTF                                                 07276000
ASCBTMLW EQU   ASCBRCTF                                                 07277000
ASCBOUT  EQU   ASCBRCTF                                                 07278000
ASCBWAIT EQU   ASCBRCTF                                                 07279000
ASCBRV08 EQU   ASCBRCTF                                                 07280000
ASCBFQU  EQU   ASCBRCTF                                                 07281000
ASCBFRS  EQU   ASCBRCTF                                                 07282000
ASCBTMNO EQU   ASCBRCTF                                                 07283000
ASCBAFFN EQU   ASCBFW1                                                  07284000
ASCBDUMP EQU   ASCB+96                                                  07285000
ASCBRV44 EQU   ASCB+92                                                  07286000
ASCBUBET EQU   ASCB+88                                                  07287000
ASCBECB  EQU   ASCB+84                                                  07288000
ASCBJSTL EQU   ASCB+80                                                  07289000
ASCBEWST EQU   ASCB+72                                                  07290000
ASCBEJST EQU   ASCB+64                                                  07291000
ASCBTSB  EQU   ASCB+60                                                  07292000
ASCBCSCB EQU   ASCB+56                                                  07293000
ASCBRSMA EQU   ASCBRSM+1                                                07294000
ASCBRV54 EQU   ASCBRSMF                                                 07295000
ASCBRV53 EQU   ASCBRSMF                                                 07296000
ASCBRV52 EQU   ASCBRSMF                                                 07297000
ASCBRV51 EQU   ASCBRSMF                                                 07298000
ASCBVEQR EQU   ASCBRSMF                                                 07299000
ASCBN2LP EQU   ASCBRSMF                                                 07300000
ASCB1LPU EQU   ASCBRSMF                                                 07301000
ASCB2LPU EQU   ASCBRSMF                                                 07302000
ASCBLDA  EQU   ASCB+48                                                  07303000
ASCBSTOR EQU   ASCB+44                                                  07304000
ASCBDP   EQU   ASCB+43                                                  07305000
ASCBRV07 EQU   ASCB+42                                                  07306000
ASCBIOSM EQU   ASCB+40                                                  07307000
ASCBSEQN EQU   ASCB+38                                                  07308000
ASCBCPUS EQU   ASCB+32                                                  07309000
ASCBSPL  EQU   ASCB+28                                                  07310000
ASCBIOSP EQU   ASCB+24                                                  07311000
ASCBSYNC EQU   ASCBSUPC+4                                               07312000
ASCBSVRB EQU   ASCBSUPC                                                 07313000
ASCBCMSF EQU   ASCB+12                                                  07314000
ASCBBWDP EQU   ASCB+8                                                   07315000
ASCBFWDP EQU   ASCB+4                                                   07316000
ASCBASCB EQU   ASCB                                                     07317000
ASCBEGIN EQU   ASCB                                                     07318000
@NM00048 EQU   PSA+3668                                                 07319000
PSASTAK  EQU   PSA+3072                                                 07320000
@NM00047 EQU   PSA+1048                                                 07321000
PSAUSEND EQU   PSA+1048                                                 07322000
PSARV062 EQU   PSA+1044                                                 07323000
PSACDAL  EQU   PSA+1040                                                 07324000
PSAWTCOD EQU   PSA+1036                                                 07325000
PSAATCVT EQU   PSA+1032                                                 07326000
PSAPCPSW EQU   PSA+1024                                                 07327000
PSAPIR2  EQU   PSA+1020                                                 07328000
PSARV059 EQU   PSA+1018                                                 07329000
PSASVC13 EQU   PSA+1016                                                 07330000
PSALSFCC EQU   PSA+1012                                                 07331000
PSASFACC EQU   PSA+1008                                                 07332000
PSASTOP  EQU   PSA+992                                                  07333000
PSASTART EQU   PSA+976                                                  07334000
PSARSPSW EQU   PSA+968                                                  07335000
PSASRPSW EQU   PSA+960                                                  07336000
PSARV045 EQU   PSA+892                                                  07337000
PSARV044 EQU   PSA+888                                                  07338000
PSARV043 EQU   PSA+884                                                  07339000
PSARV042 EQU   PSA+880                                                  07340000
PSARV041 EQU   PSA+876                                                  07341000
PSARV040 EQU   PSA+872                                                  07342000
PSARV025 EQU   PSA+868                                                  07343000
PSADSSED EQU   PSA+868                                                  07344000
PSADSSPR EQU   PSA+864                                                  07345000
PSADSSFW EQU   PSA+860                                                  07346000
PSADSS14 EQU   PSA+856                                                  07347000
PSADSSPP EQU   PSA+848                                                  07348000
PSADSSRP EQU   PSA+840                                                  07349000
PSADSS05 EQU   PSADSSF4                                                 07350000
PSADSS10 EQU   PSADSSF4                                                 07351000
PSADSSVE EQU   PSADSSF4                                                 07352000
PSADSSDE EQU   PSADSSF4                                                 07353000
PSADSSC0 EQU   PSADSSF4                                                 07354000
PSADSSIE EQU   PSADSSF4                                                 07355000
PSADSS12 EQU   PSADSSF4                                                 07356000
PSADSSRC EQU   PSADSSF4                                                 07357000
PSARV057 EQU   PSADSSF3                                                 07358000
PSARV056 EQU   PSADSSF3                                                 07359000
PSARV055 EQU   PSADSSF3                                                 07360000
PSADSSMC EQU   PSADSSF3                                                 07361000
PSADSSRW EQU   PSADSSF3                                                 07362000
PSADSSNM EQU   PSADSSF3                                                 07363000
PSADSSES EQU   PSADSSF3                                                 07364000
PSADSSGP EQU   PSADSSF3                                                 07365000
PSADSSF2 EQU   PSADSSFL+1                                               07366000
PSADSSPI EQU   PSADSSF1                                                 07367000
PSADSSOI EQU   PSADSSF1                                                 07368000
PSADSSSP EQU   PSADSSF1                                                 07369000
PSADSSTP EQU   PSADSSF1                                                 07370000
PSADSSDW EQU   PSADSSF1                                                 07371000
PSADSSDD EQU   PSADSSF1                                                 07372000
PSADSSDM EQU   PSADSSF1                                                 07373000
PSADSSMV EQU   PSADSSF1                                                 07374000
PSADSSTS EQU   PSA+816                                                  07375000
PSADSSWK EQU   PSA+812                                                  07376000
PSADSSR3 EQU   PSA+808                                                  07377000
PSADSSR2 EQU   PSA+804                                                  07378000
PSADSSRS EQU   PSA+800                                                  07379000
PSASTOR  EQU   PSA+796                                                  07380000
PSACPUSA EQU   PSA+794                                                  07381000
PSAVSTAP EQU   PSA+792                                                  07382000
PSAWKVAP EQU   PSA+788                                                  07383000
PSAWKRAP EQU   PSA+784                                                  07384000
PSAMCHIC EQU   PSA+783                                                  07385000
PSARV061 EQU   PSA+782                                                  07386000
PSASYMSK EQU   PSA+781                                                  07387000
PSAMCHFL EQU   PSA+780                                                  07388000
PSACR0   EQU   PSA+776                                                  07389000
PSAPSWSV EQU   PSA+768                                                  07390000
PSACLHS  EQU   PSAHLHI                                                  07391000
PSALKR15 EQU   PSALKSA+60                                               07392000
PSALKR14 EQU   PSALKSA+56                                               07393000
PSALKR13 EQU   PSALKSA+52                                               07394000
PSALKR12 EQU   PSALKSA+48                                               07395000
PSALKR11 EQU   PSALKSA+44                                               07396000
PSALKR10 EQU   PSALKSA+40                                               07397000
PSALKR9  EQU   PSALKSA+36                                               07398000
PSALKR8  EQU   PSALKSA+32                                               07399000
PSALKR7  EQU   PSALKSA+28                                               07400000
PSALKR6  EQU   PSALKSA+24                                               07401000
PSALKR5  EQU   PSALKSA+20                                               07402000
PSALKR4  EQU   PSALKSA+16                                               07403000
PSALKR3  EQU   PSALKSA+12                                               07404000
PSALKR2  EQU   PSALKSA+8                                                07405000
PSALKR1  EQU   PSALKSA+4                                                07406000
PSALKR0  EQU   PSALKSA                                                  07407000
PSARV023 EQU   PSACLHT+52                                               07408000
PSALOCAL EQU   PSACLHT+48                                               07409000
PSACMSL  EQU   PSACLHT+44                                               07410000
PSAOPTL  EQU   PSACLHT+40                                               07411000
PSATPACL EQU   PSACLHT+36                                               07412000
PSATPDNL EQU   PSACLHT+32                                               07413000
PSATPNCL EQU   PSACLHT+28                                               07414000
PSAIOSLL EQU   PSACLHT+24                                               07415000
PSAIOSUL EQU   PSACLHT+20                                               07416000
PSAIOSCL EQU   PSACLHT+16                                               07417000
PSAIOSSL EQU   PSACLHT+12                                               07418000
PSASALCL EQU   PSACLHT+8                                                07419000
PSAASML  EQU   PSACLHT+4                                                07420000
PSADISPL EQU   PSACLHT                                                  07421000
PSASRSA  EQU   PSA+636                                                  07422000
PSARV050 EQU   PSA+634                                                  07423000
PSADSSGO EQU   PSA+633                                                  07424000
PSARECUR EQU   PSA+632                                                  07425000
PSAHLHIS EQU   PSA+628                                                  07426000
PSAIPCSA EQU   PSA+624                                                  07427000
@NM00046 EQU   PSA+621                                                  07428000
PSAIPCDM EQU   PSA+620                                                  07429000
PSAIPCD  EQU   PSA+616                                                  07430000
@NM00045 EQU   PSA+613                                                  07431000
PSAIPCRM EQU   PSA+612                                                  07432000
PSAIPCR  EQU   PSA+608                                                  07433000
PSAMCHEX EQU   PSA+600                                                  07434000
PSAMPSW  EQU   PSA+592                                                  07435000
PSAEXPS2 EQU   PSA+584                                                  07436000
PSAEXPS1 EQU   PSA+576                                                  07437000
PSAPIREG EQU   PSA+572                                                  07438000
PSARSREG EQU   PSA+568                                                  07439000
PSAGPREG EQU   PSA+556                                                  07440000
PSARV022 EQU   PSASUP4                                                  07441000
PSARV021 EQU   PSASUP4                                                  07442000
PSARV020 EQU   PSASUP4                                                  07443000
PSARV019 EQU   PSASUP4                                                  07444000
PSARV018 EQU   PSASUP4                                                  07445000
PSARV017 EQU   PSASUP4                                                  07446000
PSARV016 EQU   PSASUP4                                                  07447000
PSARV015 EQU   PSASUP4                                                  07448000
PSARV014 EQU   PSASUP3                                                  07449000
PSAULCMS EQU   PSASUP3                                                  07450000
PSARV012 EQU   PSASUP3                                                  07451000
PSAESTA  EQU   PSASUP3                                                  07452000
PSASPR   EQU   PSASUP3                                                  07453000
PSAPSREG EQU   PSASUP3                                                  07454000
PSAPI2   EQU   PSASUP3                                                  07455000
PSAIOSUP EQU   PSASUP3                                                  07456000
PSALCR   EQU   PSASUP2                                                  07457000
PSARTM   EQU   PSASUP2                                                  07458000
PSAACR   EQU   PSASUP2                                                  07459000
PSAIPCE2 EQU   PSASUP2                                                  07460000
PSAIPCES EQU   PSASUP2                                                  07461000
PSAIPCEC EQU   PSASUP2                                                  07462000
PSAGTF   EQU   PSASUP2                                                  07463000
PSAIPCRI EQU   PSASUP2                                                  07464000
PSATYPE6 EQU   PSASUP1                                                  07465000
PSATCTL  EQU   PSASUP1                                                  07466000
PSADISP  EQU   PSASUP1                                                  07467000
PSALOCK  EQU   PSASUP1                                                  07468000
PSAPI    EQU   PSASUP1                                                  07469000
PSAEXT   EQU   PSASUP1                                                  07470000
PSASVC   EQU   PSASUP1                                                  07471000
PSAIO    EQU   PSASUP1                                                  07472000
PSAANEW  EQU   PSA+544                                                  07473000
PSATOLD  EQU   PSA+540                                                  07474000
PSATNEW  EQU   PSA+536                                                  07475000
PSALCCAR EQU   PSA+532                                                  07476000
PSALCCAV EQU   PSA+528                                                  07477000
PSAPCCAR EQU   PSA+524                                                  07478000
PSAPCCAV EQU   PSA+520                                                  07479000
PSACPULA EQU   PSA+518                                                  07480000
PSACPUPA EQU   PSA+516                                                  07481000
PSAPSA   EQU   PSA+512                                                  07482000
FLCHDEND EQU   PSA+512                                                  07483000
FLCCRSAV EQU   FLCMCLA+280                                              07484000
FLCGRSAV EQU   FLCMCLA+216                                              07485000
FLCFPSAV EQU   FLCMCLA+184                                              07486000
FLCFLA   EQU   FLCMCLA+88                                               07487000
FLCRGNCD EQU   FLCMCLA+84                                               07488000
FLCFSAA  EQU   FLCFSA+1                                                 07489000
@NM00044 EQU   FLCFSA                                                   07490000
@NM00043 EQU   FLCMCLA+72                                               07491000
FLCMCIC  EQU   FLCMCLA+64                                               07492000
@NM00042 EQU   FLCMCLA+20                                               07493000
FLCIOAA  EQU   FLCIOA+1                                                 07494000
@NM00041 EQU   FLCIOA                                                   07495000
@NM00040 EQU   FLCMCLA+15                                               07496000
@NM00039 EQU   FLCMCLA+14                                               07497000
@NM00038 EQU   FLCMCLA+12                                               07498000
FLCLCL   EQU   FLCMCLA+8                                                07499000
FLCIOELA EQU   FLCIOEL+1                                                07500000
@NM00037 EQU   FLCIOEL                                                  07501000
FLCCHNID EQU   FLCMCLA                                                  07502000
@NM00036 EQU   PSA+160                                                  07503000
FLCMTRCD EQU   PSA+157                                                  07504000
@NM00035 EQU   PSA+156                                                  07505000
FLCPERA  EQU   FLCPER+1                                                 07506000
@NM00034 EQU   FLCPER                                                   07507000
@NM00033 EQU   PSA+151                                                  07508000
FLCPERCD EQU   PSA+150                                                  07509000
FLCMCNUM EQU   PSA+149                                                  07510000
@NM00032 EQU   PSA+148                                                  07511000
FLCTEAA  EQU   FLCTEA+1                                                 07512000
@NM00031 EQU   FLCTEA                                                   07513000
PSAPIPC  EQU   PSAPICOD                                                 07514000
PSAPIMC  EQU   PSAPICOD                                                 07515000
PSAPIPER EQU   PSAPICOD                                                 07516000
PSARV049 EQU   FLCPICOD                                                 07517000
FLCPILCB EQU   FLCPIILC                                                 07518000
@NM00030 EQU   FLCPIILC                                                 07519000
@NM00029 EQU   PSAEPPSW                                                 07520000
FLCSVCN  EQU   PSAESPSW+2                                               07521000
FLCSILCB EQU   FLCSVILC                                                 07522000
@NM00028 EQU   FLCSVILC                                                 07523000
@NM00027 EQU   PSAESPSW                                                 07524000
FLCEICOD EQU   PSAEEPSW+2                                               07525000
PSASPAD  EQU   PSAEEPSW                                                 07526000
@NM00026 EQU   PSA+128                                                  07527000
FLCINPSW EQU   PSA+120                                                  07528000
FLCMNPSW EQU   PSA+112                                                  07529000
FLCPNPSW EQU   PSA+104                                                  07530000
FLCSNPSW EQU   PSA+96                                                   07531000
FLCENPSW EQU   PSA+88                                                   07532000
FLCTRACE EQU   PSA+84                                                   07533000
FLCTIMER EQU   PSA+80                                                   07534000
FLCCVT2  EQU   PSA+76                                                   07535000
FLCCAW   EQU   PSA+72                                                   07536000
FLCCSW   EQU   PSA+64                                                   07537000
FLCIOPSW EQU   PSA+56                                                   07538000
FLCMOPSW EQU   PSA+48                                                   07539000
FLCPOPSW EQU   PSA+40                                                   07540000
FLCSOPSW EQU   PSA+32                                                   07541000
FLCEOPSW EQU   PSA+24                                                   07542000
@NM00025 EQU   FLCICCW2+4                                               07543000
FLCICCW1 EQU   FLCROPSW                                                 07544000
FLCIPPSW EQU   FLCRNPSW                                                 07545000
*                                      END UNREFERENCED COMPONENTS      07546000
@RT00283 EQU   RETN                                                     07547000
@RT00387 EQU   NEXTTCB                                                  07548000
@RT00398 EQU   TESTFIX                                                  07549000
@RT00401 EQU   FIRSTFOE                                                 07550000
@RT00424 EQU   RLTDEND                                                  07551000
@RF00522 EQU   @RC00519                                                 07552000
@RF00525 EQU   @RC00519                                                 07553000
@RT00536 EQU   SAVL1                                                    07554000
@RT00587 EQU   NOTINFET                                                 07555000
@RT00618 EQU   SAVPCB                                                   07556000
@RT00637 EQU   DIDQDD                                                   07557000
PRCEND1  EQU   @EL00004                                                 07558000
@RT00699 EQU   EXITSTG1                                                 07559000
@RT00713 EQU   NEXTSPCT                                                 07560000
@RT00741 EQU   EXITSTG1                                                 07561000
@RF00741 EQU   DOENTRY                                                  07562000
@RF00749 EQU   NEXTSPCT                                                 07563000
@RT00775 EQU   EXITSTG1                                                 07564000
@RF00778 EQU   DOENTRY                                                  07565000
@RT00797 EQU   EXITWS                                                   07566000
@RC00816 EQU   TESTRBN                                                  07567000
@RF00810 EQU   TESTRBN                                                  07568000
@RC00887 EQU   INVALPGT                                                 07569000
@RT00942 EQU   NEXTPFTE                                                 07570000
@RT00954 EQU   REPAIRFX                                                 07571000
@RT00989 EQU   REPAIRFX                                                 07572000
@RF00995 EQU   DOFIXCT                                                  07573000
@RT01102 EQU   DOFOE                                                    07574000
@RT01133 EQU   DECFOE                                                   07575000
@RF01144 EQU   DOROOT                                                   07576000
@RT01164 EQU   MATCHSEG                                                 07577000
PRCEND3  EQU   @EL00008                                                 07578000
@RT01188 EQU   INITFIX                                                  07579000
@RT01192 EQU   EXITPT                                                   07580000
@RF01198 EQU   TESTVBN                                                  07581000
@RT01209 EQU   EXITPT                                                   07582000
@PB00011 EQU   @PB00012                                                 07583000
@PB00010 EQU   @PB00011                                                 07584000
@PB00009 EQU   @PB00010                                                 07585000
@PB00008 EQU   @PB00009                                                 07586000
@PB00007 EQU   @PB00008                                                 07587000
@PB00006 EQU   @PB00007                                                 07588000
@PB00005 EQU   @PB00006                                                 07589000
@PB00004 EQU   @PB00005                                                 07590000
@PB00003 EQU   @PB00004                                                 07591000
@PB00002 EQU   @PB00003                                                 07592000
@ENDDATA EQU   *                                                        07593000
         END   IEAVSOUT,(C'PLS2040',0701,78164)                         07594000
