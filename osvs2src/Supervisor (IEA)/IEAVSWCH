         TITLE 'IEAVSWCH, COMM TASK CONSOLE SWITCH ROUTINE             *00001000
                        '                                               00002000
IEAVSWCH CSECT                                                          00003000
* A 353430                                                     @YA00092 00004000
IGC0407B EQU   *                                                        00005000
         ENTRY IGC0407B                                                 00006000
         USING *,REG15                                                  00007000
         MODID                                                          00008000
         USING CXSA,REG01                                               00009000
         LR    REG12,REG01          SAVE A COPY OF THE PTR TO CXSA      00010000
         ST    REG14,CSAXA          SAVE RETURN ADDR IN EXTENDED SAVE   00011000
         DROP  REG01,REG15                                              00012000
IEAVSWCH CSECT ,                                                01S0002 00013000
@PROLOG  BALR  @06,0                                            01S0002 00014000
@PSTART  LA    @08,4095(,@06)                                   01S0002 00015000
         LA    @05,4095(,@08)                                   01S0002 00016000
         USING @PSTART,@06                                      01S0002 00017000
         USING @PSTART+4095,@08                                 01S0002 00018000
         USING @PSTART+8190,@05                                 01S0002 00019000
         L     @00,@SIZDATD                                     01S0002 00020000
         GETMAIN  R,LV=(0)                                              00021000
         LR    @09,@01                                          01S0002 00022000
         USING @DATD,@09                                        01S0002 00023000
         ST    @13,@SA00001+4                                   01S0002 00024000
         LR    @13,@09                                          01S0002 00025000
RBPRFXLN EQU 64                                                         00026000
RBPRFLNA EQU 32                                                         00027000
PRBLEN   EQU 136                                                        00028000
SIRBLEN  EQU 200                                                        00029000
TIRBLEN  EQU 136                                                        00030000
IRBLEN   EQU 128                                                        00031000
SVRBLEN  EQU 224                                                        00032000
         EJECT                                                          00033000
*                                                               02S0179 00034000
*/*** START OF INITSEG SEGMENT ***************************************/ 00035000
*/*                                                                  */ 00036000
*/*  INITSEG - THIS SEGMENT INITIALIZES GENERAL POINTERS, SETS       */ 00037000
*/*            SWITCHS TO ZERO (OFF OR NO), AND INITIALIZES THE      */ 00038000
*/*            TIME TO BE USED IN MESSAGES                           */ 00039000
*/*                                                                  */ 00040000
*/*  INPUT -   NONE                                                  */ 00041000
*/*                                                                  */ 00042000
*/*  OUTPUT -  THE TIME STAMP, SWCHTS, HAS BEEN INITIALIZED TO THE   */ 00043000
*/*            CURRENT TIME.                                         */ 00044000
*/*                                                                  */ 00045000
*/********************************************************************/ 00046000
*                                                               02S0179 00047000
*   LCVTPTR=CVTPTR;                 /* INITIALIZE WORKING CVT BASE   */ 00048000
         L     @04,CVTPTR                                       02S0179 00049000
         ST    @04,LCVTPTR                                      02S0179 00050000
*   UCMBASPT=CVTCUCB;               /* INITIALIZE BASE FOR UCM BASE  */ 00051000
         L     UCMBASPT,CVTCUCB(,@04)                           02S0180 00052000
*   UCMMCSPT=UCMPRFXP;              /* INITIALIZE BASE FOR UCM PREFIX*/ 00053000
         LR    @04,UCMBASPT                                     02S0181 00054000
         AL    @04,@CF03908                                     02S0181 00055000
         L     UCMMCSPT,UCMPRFXP(,@04)                          02S0181 00056000
*   RFY                                                         02S0182 00057000
*     CVTMAP BASED(LCVTPTR);        /* BASE CVT ON WORKING COPY      */ 00058000
*   CSAXC=PSATOLD;                  /* SET ADDR OF CURRENT TCB  02S0183 00059000
*                                                            @ZA00886*/ 00060000
         MVC   CSAXC(4,CXSAPTR),PSATOLD                         02S0183 00061000
*   CSAXF=PSAAOLD;                  /* SET ADDR OF CURRENT ASCB 02S0184 00062000
*                                                            @ZA00886*/ 00063000
*                                                               02S0184 00064000
         MVC   CSAXF(4,CXSAPTR),PSAAOLD                         02S0184 00065000
*   /*****************************************************************/ 00066000
*   /*                                                               */ 00067000
*   /* ZERO POINTERS AND SWITCHES.                                   */ 00068000
*   /*                                                               */ 00069000
*   /*****************************************************************/ 00070000
*                                                               02S0185 00071000
*   OLDMAST=ZERO;                   /* OLD MASTER CONSOLE PTR        */ 00072000
         SLR   @04,@04                                          02S0185 00073000
         ST    @04,OLDMAST                                      02S0185 00074000
*   FAILI=ZERO;                     /* FAILING INPUT CONSOLE         */ 00075000
         ST    @04,FAILI                                        02S0186 00076000
*   FAILO=ZERO;                     /* FAILING OUTPUT CONSOLE        */ 00077000
         ST    @04,FAILO                                        02S0187 00078000
*   NEWI=ZERO;                      /* NEW INPUT CONSOLE             */ 00079000
         SLR   NEWI,NEWI                                        02S0188 00080000
*   NEWO=ZERO;                      /* NEW OUTPUT CONSOLE            */ 00081000
         ST    @04,NEWO                                         02S0189 00082000
*   BELLCONS=ZERO;                  /* CONSOLE TO RING THE BELL      */ 00083000
         ST    @04,BELLCONS                                     02S0190 00084000
*   PWRCONS=ZERO;                   /* CONSOLE TO SOUND POWER ALARM     00085000
*                                                            @G51APSS*/ 00086000
         ST    @04,PWRCONS                                      02S0191 00087000
*   FAILHC=ZERO;                    /* FAILING HARDCOPY CONSOLE      */ 00088000
         SLR   FAILHC,FAILHC                                    02S0192 00089000
*   NEWHC=ZERO;                     /* NEW HARDCOPY CONSOLE          */ 00090000
         SLR   NEWHC,NEWHC                                      02S0193 00091000
*   RETCODE=ZERO;                   /* RETURN CODE FIELD             */ 00092000
         ST    @04,RETCODE                                      02S0194 00093000
*   SWFLAGS=SWFLAGS&&SWFLAGS;       /* CLEAR FLAGS           @G51APSS*/ 00094000
*                                                               02S0195 00095000
         XC    SWFLAGS(4),SWFLAGS                               02S0195 00096000
*   /*****************************************************************/ 00097000
*   /*                                                               */ 00098000
*   /* TAKE A TIME STAMP, CONVERT IT TO EBCDIC, AND PLACE IT IN FIELD*/ 00099000
*   /* SWCHTS FOR LATER USE IN CONSTRUCTING WQE'S.                   */ 00100000
*   /*                                                               */ 00101000
*   /*****************************************************************/ 00102000
*                                                               02S0196 00103000
*   WORD1=ZERO;                     /* TIME WILL BE ZERO IF ERRET    */ 00104000
         ST    @04,WORD1                                        02S0196 00105000
*   RFY                                                         02S0197 00106000
*     REG00 RSTD;                                               02S0197 00107000
*   DO;                             /* TIMEP (DEC) ERRET(SWCHTIM)    */ 00108000
*     RFY                                                       02S0199 00109000
*      (GPR00P,                                                 02S0199 00110000
*       GPR01F,                                                 02S0199 00111000
*       GPR15F) RSTD;               /* RESTRICT REGISTERS            */ 00112000
*     GPR01F='00000042'X;           /* SET REGISTER ONE              */ 00113000
         LA    GPR01F,66                                        02S0200 00114000
*     GPR00P=0;                     /* SET REGISTER ZERO             */ 00115000
         SLR   GPR00P,GPR00P                                    02S0201 00116000
*     SVC(11);                      /* ISSUE TIME SVC                */ 00117000
         SVC   11                                               02S0202 00118000
*     IF GPR15F>4 THEN              /* WAS SVC SUCCESSFUL            */ 00119000
         CH    GPR15F,@CH00065                                  02S0203 00120000
         BH    @RT00203                                         02S0203 00121000
*       GOTO SWCHTIM;               /* BRANCH TO ERROR RETURN        */ 00122000
*     RFY                                                       02S0205 00123000
*      (GPR00P,                                                 02S0205 00124000
*       GPR01F,                                                 02S0205 00125000
*       GPR15F) UNRSTD;             /* RELEASE REGISTERS             */ 00126000
*   END;                            /* TIMEP (DEC) ERRET(SWCHTIM) GET   00127000
*                                      THE TIME                      */ 00128000
*   WORD1=REG00;                    /* SAVE TIME FOR UNPACK          */ 00129000
         ST    REG00,WORD1                                      02S0207 00130000
*   RFY                                                         02S0208 00131000
*     REG00 UNRSTD;                                             02S0208 00132000
*SWCHTIM:                                                       02S0209 00133000
*   UNPK(DBLWORD1,WORD1S);          /* UNPACK THE TIME               */ 00134000
SWCHTIM  UNPK  DBLWORD1(8),WORD1S(4)                            02S0209 00135000
*   HH=HHP;                         /* FILL IN HOURS                 */ 00136000
         MVC   HH(2),HHP                                        02S0210 00137000
*   PER1=PERIOD;                    /* PLACE PERIOD BETWEEN HOUR/MIN */ 00138000
         MVI   PER1,C'.'                                        02S0211 00139000
*   MM=MMP;                         /* FILL IN MINUTES               */ 00140000
         MVC   MM(2),MMP                                        02S0212 00141000
*   PER2=PERIOD;                    /* PLACE PERIOD BETWEEN MIN/SEC  */ 00142000
         MVI   PER2,C'.'                                        02S0213 00143000
*   SS=SSP;                         /* FILL IN SECONDS               */ 00144000
         MVC   SS(2),SSP                                        02S0214 00145000
*   MPLDEF=MPLDEF&&MPLDEF;          /* CLEAR PARM LIST TO ZEROS      */ 00146000
         XC    MPLDEF(12),MPLDEF                                02S0215 00147000
*/*** END OF INITSEG SEGMENT *****************************************/ 00148000
*                                                               02S0216 00149000
*   CALL GETLOCKS;                  /* GO OBTAIN LOCKS               */ 00150000
*                                                               01S0216 00151000
         BAL   @14,GETLOCKS                                     01S0216 00152000
*   /*****************************************************************/ 00153000
*   /*                                                               */ 00154000
*   /* SET PTR TO CURRENT MASTER CONSOLE AFTER OBTAINING LOCKS TO    */ 00155000
*   /* INSURE THAT THE COPY IS TRUE.                                 */ 00156000
*   /*                                                               */ 00157000
*   /*****************************************************************/ 00158000
*                                                               01S0217 00159000
*   MASTERI=UCMMCENT;               /* INITIALIZE PTR TO MASTER      */ 00160000
         L     @11,UCMMCENT(,UCMMCSPT)                          01S0217 00161000
         ST    @11,MASTERI                                      01S0217 00162000
*   MASTERO=MASTERI->UCMCOMPC;      /* PTR TO OTHER HALF OF MASTER IF   00163000
*                                      COMPOSIT, OTHERWISE, ZERO     */ 00164000
         MVC   MASTERO(4),UCMCOMPC(@11)                         01S0218 00165000
*   IF CSAEXTI='1'B                 /* EXTERNAL INTERRUPT            */ 00166000
*     THEN                                                      01S0219 00167000
         TM    CSAEXTI(CXSAPTR),B'00000100'                     01S0219 00168000
         BNO   @RF00219                                         01S0219 00169000
*     IF UCMSYSE='0'B               /* AND NOT NO CONSOLE CONDITION  */ 00170000
*       THEN                                                    01S0220 00171000
         TM    UCMSYSE(UCMMCSPT),B'00001000'                    01S0220 00172000
         BNZ   @RF00220                                         01S0220 00173000
*       DO;                         /* SET UP TO PROCESS EXTERNAL    */ 00174000
*         EXTSWREQ='1'B;            /* INDICATE SWITCH FOR EXTERNAL  */ 00175000
         OI    EXTSWREQ,B'10000000'                             01S0222 00176000
*         CSAUCMA=MASTERI;          /* MAKE FAILING = MASTER         */ 00177000
         STCM  @11,7,CSAUCMA(CXSAPTR)                           01S0223 00178000
*       END;                                                    01S0224 00179000
*     ELSE                          /* TRYING TO RESOLVE THE    01S0225 00180000
*                                      NO-CONSOLES CONDITION @G51APSS*/ 00181000
*       CALL EXTINNCC;              /* SWCH TO THE CANDIDATE @G51APSS*/ 00182000
         B     @RC00220                                         01S0225 00183000
@RF00220 BAL   @14,EXTINNCC                                     01S0225 00184000
*/********************************************************************/ 00185000
*/*                                                                  */ 00186000
*/*   TEST WHETHER TO RUN THROUGH THE CONSFAIL ROUTINE.              */ 00187000
*/*   THIS IS NEEDED IF CALL IS FOR AN I/O ERROR, THE EXTERNAL       */ 00188000
*/*   INTERRUPT KEY WAS PRESSED AND A NO CONSOLES CONDITION DOESNT   */ 00189000
*/*   EXIST, OR A VARY MSTCONS CMD AFTER MESSAGE IEE141A.            */ 00190000
*/*                                                                  */ 00191000
*/********************************************************************/ 00192000
*                                                               01S0226 00193000
*   IF CSACODE=CSASWTCH|EXTSWREQ='1'B|((UCMAMFA='1'B&CSAVMST='1'B)&     00194000
*       CSAUCMA^=MASTERI)           /*                       @YA00092*/ 00195000
*     THEN                                                      01S0226 00196000
@RC00220 DS    0H                                               01S0226 00197000
@RF00219 CLI   CSACODE(CXSAPTR),0                               01S0226 00198000
         BE    @RT00226                                         01S0226 00199000
         TM    EXTSWREQ,B'10000000'                             01S0226 00200000
         BO    @RT00226                                         01S0226 00201000
         TM    UCMAMFA(UCMBASPT),B'00001000'                    01S0226 00202000
         BNO   @RF00226                                         01S0226 00203000
         TM    CSAVMST(CXSAPTR),B'00001000'                     01S0226 00204000
         BNO   @RF00226                                         01S0226 00205000
         SLR   @11,@11                                          01S0226 00206000
         ICM   @11,7,CSAUCMA(CXSAPTR)                           01S0226 00207000
         C     @11,MASTERI                                      01S0226 00208000
         BE    @RF00226                                         01S0226 00209000
@RT00226 DS    0H                                               01S0227 00210000
*     DO;                           /* IF REQUIRED, SWITCH CONSOLES  */ 00211000
*                                                               02S0228 00212000
*/*** START OF CONSFAIL SEGMENT **************************************/ 00213000
*/*                                                                  */ 00214000
*/* CONSFAIL - PROCESSING FOR AN I/O ERROR ON ANY CONSOLE, VARY      */ 00215000
*/*            MSTCONS WHEN ACCEPTED FROM ANYONE, AND AN EXTERNAL    */ 00216000
*/*            INTERRUPT IN OTHER THAN A NO CONSOLES CONDITION       */ 00217000
*/*                                                                  */ 00218000
*/* FUNCTION - SELECTS AN ALTERNATE CONSOLE, CALLS THE SWCONS        */ 00219000
*/*    TO SWITCH THE CONSOLES FUNCTION, REQUEUE MESSAGES, ETC.       */ 00220000
*/*                                                                  */ 00221000
*/* INPUT - CSAUCMA = UCME ADDR OF FAILING CONSOLE OR NEW MASTER     */ 00222000
*/*                 FROM V MSTCONS COMMAND                           */ 00223000
*/*         MASTERI = UCME ADDR OF MASTER (INPUT HALF IF COMPOSITE)  */ 00224000
*/*                                                                  */ 00225000
*/* OUTPUT - NONE                                                    */ 00226000
*/*                                                                  */ 00227000
*/********************************************************************/ 00228000
*                                                               02S0228 00229000
*       /*************************************************************/ 00230000
*       /*                                                           */ 00231000
*       /* CHECK FOR VARY MSTCONS FROM ANYONE.                       */ 00232000
*       /*                                                           */ 00233000
*       /*************************************************************/ 00234000
*                                                               02S0228 00235000
*       IF CSAVMST='1'B&UCMAMFA='1'B THEN/* VARY MSTCONS FROM ANYONE?*/ 00236000
         TM    CSAVMST(CXSAPTR),B'00001000'                     02S0228 00237000
         BNO   @RF00228                                         02S0228 00238000
         TM    UCMAMFA(UCMBASPT),B'00001000'                    02S0228 00239000
         BNO   @RF00228                                         02S0228 00240000
*         DO;                       /* YES                           */ 00241000
*           MASTERI->UCMUF='1'B;    /* TURN ON ACTIVE FLAG IN CURRENT   00242000
*                                      MASTER SO IT CAN CLOSE        */ 00243000
         L     @11,MASTERI                                      02S0230 00244000
         OI    UCMUF(@11),B'00010000'                           02S0230 00245000
*           IF MASTERO^=ZERO THEN   /* MASTER A COMPOSITE?   @ZA20165*/ 00246000
         L     @11,MASTERO                                      02S0231 00247000
         LTR   @11,@11                                          02S0231 00248000
         BZ    @RF00231                                         02S0231 00249000
*             MASTERO->UCMUF='1'B;  /* YES, THEN MARK OUTPUT HALF       00250000
*                                      ACTIVE                @ZA20165*/ 00251000
         OI    UCMUF(@11),B'00010000'                           02S0232 00252000
*           NEWI=CSAUCMA;           /* PUT ADDR OF NEW MASTER IN NEWI*/ 00253000
@RF00231 SLR   NEWI,NEWI                                        02S0233 00254000
         ICM   NEWI,7,CSAUCMA(CXSAPTR)                          02S0233 00255000
*           NEWO=NEWI->UCMCOMPC;    /* GET ADDR OF OUTPUT HALF OF NEW   00256000
*                                      MASTER (IF ANY)       @ZA18881*/ 00257000
         MVC   NEWO(4),UCMCOMPC(NEWI)                           02S0234 00258000
*           FAILI=MASTERI;          /* PUT ADDR OF OLD MASTER IN        00259000
*                                      FAILI                         */ 00260000
         L     @11,MASTERI                                      02S0235 00261000
         ST    @11,FAILI                                        02S0235 00262000
*           FAILO=MASTERI->UCMCOMPC;/* PUT ADDR OF OUTPUT HALF OF OLD   00263000
*                                      MASTER (IF ANY) IN OUTPUT HALF   00264000
*                                      OF FAILING CONSOLE            */ 00265000
         MVC   FAILO(4),UCMCOMPC(@11)                           02S0236 00266000
*           UCMSYSD='1'B;           /* INDICATE SWITCH IS FOR MASTER */ 00267000
         OI    UCMSYSD(UCMMCSPT),B'00010000'                    02S0237 00268000
*         END;                                                  02S0238 00269000
*       ELSE                        /* NOT VARY MSTCONS FROM ANYONE  */ 00270000
*         DO;                                                   02S0239 00271000
*                                                               02S0239 00272000
         B     @RC00228                                         02S0239 00273000
@RF00228 DS    0H                                               02S0240 00274000
*           /*********************************************************/ 00275000
*           /*                                                       */ 00276000
*           /* SET UP PTRS TO INPUT AND OUTPUT HALVES OF THE FAILING */ 00277000
*           /* CONSOLE. IF THE CONSOLE IS NOT COMPOSITE, FAILI WILL  */ 00278000
*           /* CONTAIN ITS UCME ADDR.                                */ 00279000
*           /*                                                       */ 00280000
*           /*********************************************************/ 00281000
*                                                               02S0240 00282000
*           FAILI=CSAUCMA;          /* GET PTR TO FAILING UCME       */ 00283000
         SLR   @11,@11                                          02S0240 00284000
         ICM   @11,7,CSAUCMA(CXSAPTR)                           02S0240 00285000
         ST    @11,FAILI                                        02S0240 00286000
*           FAILO=CSAUCMA->UCMCOMPC;/* GET OTHER HALF OF FAILING        00287000
*                                      CONSOLE IF ANY                */ 00288000
         L     @04,UCMCOMPC(,@11)                               02S0241 00289000
         ST    @04,FAILO                                        02S0241 00290000
*           IF FAILO^=ZERO THEN     /* IS FAILING CONSOLE A COMPOSITE*/ 00291000
         LTR   @04,@04                                          02S0242 00292000
         BZ    @RF00242                                         02S0242 00293000
*             IF CSAUCMA->UCMOF='1'B THEN/* YES, IS FAILING HALF THE    00294000
*                                      OUTPUT HALF                   */ 00295000
         TM    UCMOF(@11),B'10000000'                           02S0243 00296000
         BNO   @RF00243                                         02S0243 00297000
*               DO;                 /* YES, INTERCHANGE INPUT AND       00298000
*                                      OUTPUT HALF PTRS              */ 00299000
*                 FAILI=FAILO;      /* PUT PTR TO INPUT HALF IN FAILI*/ 00300000
         ST    @04,FAILI                                        02S0245 00301000
*                 FAILO=FAILI->UCMCOMPC;/* PUT PTR TO OUTPUT HALF IN    00302000
*                                      FAILO                         */ 00303000
         MVC   FAILO(4),UCMCOMPC(@04)                           02S0246 00304000
*               END;                                            02S0247 00305000
*                                                               02S0247 00306000
*           /*********************************************************/ 00307000
*           /*                                                       */ 00308000
*           /* SELECT AN ALTERNATE FOR THE FAILING CONSOLE. IF AN    */ 00309000
*           /* ALTERNATE IS FOUND ITS UCME ADDR IS PUT IN NEWI.      */ 00310000
*           /*                                                       */ 00311000
*           /*********************************************************/ 00312000
*                                                               02S0248 00313000
*           CALL FINDALT;           /* GO FIND AN ALTERNATE          */ 00314000
@RF00243 DS    0H                                               02S0248 00315000
@RF00242 BAL   @14,FINDALT                                      02S0248 00316000
*         END;                                                  02S0249 00317000
*       CALL SWCONS;                /* SWITCH FAILING CONSOLE TO ALT */ 00318000
@RC00228 BAL   @14,SWCONS                                       02S0250 00319000
*/** END OF CONSFAIL SEGMENT *****************************************/ 00320000
*                                                               02S0251 00321000
*     END;                                                      01S0251 00322000
*   ELSE                                                        01S0252 00323000
*     DO;                                                       01S0252 00324000
         B     @RC00226                                         01S0252 00325000
@RF00226 DS    0H                                               01S0253 00326000
*       IF CSAVMST='1'B             /* IS THIS A V MSTCONS REQUEST   */ 00327000
*         THEN                                                  01S0253 00328000
         TM    CSAVMST(CXSAPTR),B'00001000'                     01S0253 00329000
         BNO   @RF00253                                         01S0253 00330000
*         DO;                       /* IF IT IS, SWITCH THE MASTER   */ 00331000
*                                                               02S0255 00332000
*/*** START OF VMSCON SEGMENT ****************************************/ 00333000
*/*                                                                  */ 00334000
*/*  VMSCON -  NORMAL PROCESSING FOR A VARY MSTCONS COMMAND.         */ 00335000
*/*            1.  THE OLD MASTERS AUTHORITY AND ROUTE CODES ARE     */ 00336000
*/*                GIVEN TO THE MASTER.  (THE HARDCOPY FUNCTION IS   */ 00337000
*/*                NOT TRANSFERRED).                                 */ 00338000
*/*                                                                  */ 00339000
*/*            2.  A MESSAGE INDICATING THE STATUS OF THE NEW MASTER */ 00340000
*/*                IS WRITTEN.                                       */ 00341000
*/*                                                                  */ 00342000
*/*  INPUT  -  CSAUCMA = UCME ADDRESS FOR THE NEW MASTER.            */ 00343000
*/*                                                                  */ 00344000
*/*  OUTPUT -  NONE                                                  */ 00345000
*/*                                                                  */ 00346000
*/********************************************************************/ 00347000
*                                                               02S0255 00348000
*           IF CSAUCMA^=MASTERI THEN/* IS NEW MASTER SAME AS OLD     */ 00349000
         L     @11,MASTERI                                      02S0255 00350000
         SLR   @04,@04                                          02S0255 00351000
         ICM   @04,7,CSAUCMA(CXSAPTR)                           02S0255 00352000
         CR    @04,@11                                          02S0255 00353000
         BE    @RF00255                                         02S0255 00354000
*             DO;                   /* IF NOT THE SAME, DO THIS      */ 00355000
*               NEWI=CSAUCMA;       /* SET UP NEW MASTER PTR         */ 00356000
         LR    NEWI,@04                                         02S0257 00357000
*               FAILI=MASTERI;      /* SET UP FAILING CONSOLE PTR    */ 00358000
         ST    @11,FAILI                                        02S0258 00359000
*               FAILO=MASTERO;      /* OUTPUT HALF OF OLD MASTER OR 0*/ 00360000
         MVC   FAILO(4),MASTERO                                 02S0259 00361000
*               NEWO=NEWI->UCMCOMPC;/* GET PTR TO OTHER HALF OF NEW     00362000
*                                      MASTER CONSOLE.               */ 00363000
         L     @11,UCMCOMPC(,NEWI)                              02S0260 00364000
         ST    @11,NEWO                                         02S0260 00365000
*               IF NEWO^=0 THEN     /* IS NEW MASTER A COMPOSITE     */ 00366000
         LTR   @11,@11                                          02S0261 00367000
         BZ    @RF00261                                         02S0261 00368000
*                 IF NEWI->UCMOF='1'B THEN/* IS NEW MASTER PTR OUTPUT   00369000
*                                      HALF                          */ 00370000
         TM    UCMOF(NEWI),B'10000000'                          02S0262 00371000
         BNO   @RF00262                                         02S0262 00372000
*                   DO;             /* IF OUTPUT HALF, EXCHANGE INPUT   00373000
*                                      AND OUTPUT HALF PTRS          */ 00374000
*                     NEWI=NEWO;    /* PUT INPUT HALF IN NEWI        */ 00375000
         LR    NEWI,@11                                         02S0264 00376000
*                     NEWO=NEWI->UCMCOMPC;/* PUT OUTPUT HALF IN NEWO */ 00377000
         MVC   NEWO(4),UCMCOMPC(NEWI)                           02S0265 00378000
*                   END;            /* END SWITCH OF COMPOSITE HALVES*/ 00379000
*               UCMSYSD='1'B;       /* INDICATE SWITCH IS FOR MASTER */ 00380000
@RF00262 DS    0H                                               02S0267 00381000
@RF00261 OI    UCMSYSD(UCMMCSPT),B'00010000'                    02S0267 00382000
*               CALL SETOSW;        /* TRANSFER MASTERS FUNCTIONS TO    00383000
*                                      NEW MASTER.                   */ 00384000
         BAL   @14,SETOSW                                       02S0268 00385000
*               CALL STATMSG;       /* ISSUE NEW MASTER STATUS MSG   */ 00386000
         BAL   @14,STATMSG                                      02S0269 00387000
*             END;                  /* END DO FOR NEW ^= OLD MASTER  */ 00388000
*/*** END OF VMSCON SEGMENT ******************************************/ 00389000
*                                                               02S0271 00390000
*         END;                                                  01S0271 00391000
@RF00255 DS    0H                                               01S0272 00392000
*       IF CSAHC='1'B               /* IS HARDCOPY BEING SWITCHED    */ 00393000
*         THEN                                                  01S0272 00394000
@RF00253 TM    CSAHC(CXSAPTR),B'00000010'                       01S0272 00395000
         BNO   @RF00272                                         01S0272 00396000
*         CALL HCSWITCH;            /* IF IT IS, CALL SUBROUTINE     */ 00397000
         BAL   @14,HCSWITCH                                     01S0273 00398000
*       IF CSAVCPU='1'B|CSAVCHAN='1'B/* IS CALL FROM V CPU/CHANNEL   */ 00399000
*         THEN                                                  01S0274 00400000
@RF00272 TM    CSAVCPU(CXSAPTR),B'01100000'                     01S0274 00401000
         BZ    @RF00274                                         01S0274 00402000
*         DO;                       /* IF IT IS, PROCESS REQUEST     */ 00403000
*                                                               02S0276 00404000
*/*** START OF VCPU SEGMENT ******************************************/ 00405000
*/*                                                                  */ 00406000
*/* VCPU  -  PROCESSES VARY CPU AND VARY CHANNEL CMD REQUEST         */ 00407000
*/*                                                                  */ 00408000
*/* FUNCTION - THIS ROUTINE CHECKS WHETHER A VARY CPU OR CHANNEL     */ 00409000
*/*            COMMAND WOULD RESULT IN A NO CONSOLES OR HARDCOPY     */ 00410000
*/*            SUSPENDED SITUATION AND IF SO, NO CONSOLES ARE        */ 00411000
*/*            SWITCHED AND THE VARY COMMAND IS NOTIFIED WITH A      */ 00412000
*/*            RETURN CODE OF 4. IF THE VARY COMMAND WOULD NOT CAUSE */ 00413000
*/*            THESE PROBLEMS, AFFECTED CONSOLES ARE MARKED TO BE    */ 00414000
*/*            CLOSED AND TAKEN OFFLINE WHEN ALL THEIR CURRENT WORK  */ 00415000
*/*            IS COMPLETE.                                          */ 00416000
*/*                                                                  */ 00417000
*/* INPUT  -   UCBVHRSN=1 FOR EACH CONSOLE WHOSE I/O PATH IS AFFECTED*/ 00418000
*/*                                                                  */ 00419000
*/* OUTPUT -   RETCODE=0      IF VARY COMMAND CAN CONTINUE           */ 00420000
*/*             FOLLOWING FIELDS SET IF RETURN CODE IS ZERO          */ 00421000
*/*              UCMCF=1      CLOSE PENDING IN UCME OF AFFECTED CONSO*/ 00422000
*/*              UCBCHGS=1    DEVICE IS TO GO OFFLINE                */ 00423000
*/*              UCBDADI=1    DEVIE IS GOING OUT OF CONSOLE STATUS   */ 00424000
*/*              UCMMCENT=    ADDR OF NEW MASTER IF OLD WAS AFFECTED */ 00425000
*/*              UCMDISPB=0   IN OLD HARDCOPY UCME IF IT WAS AFFECTED*/ 00426000
*/*              UCMDISPB=1   IN NEW HARDCOPY UCME IF HC SWITCHED    */ 00427000
*/*              UCMDISPA     OFF IN OLD MASTER, ON IN NEW           */ 00428000
*/*            RETCODE=4      IF CMD WOULD CAUSE LOSS OF HC OR MASTER*/ 00429000
*/*             NO CONSOLES ARE MODIFIED IF RETURN CODE IS 4         */ 00430000
*/*                                                                  */ 00431000
*/********************************************************************/ 00432000
*                                                               02S0276 00433000
*           DO PATHUCME=UCMVEA TO UCMVEL BY UCMVEZ;/* FIND ALL  02S0276 00434000
*                                      AFFECTED CONS                 */ 00435000
         L     @11,UCMVEA(,UCMBASPT)                            02S0276 00436000
         B     @DE00276                                         02S0276 00437000
@DL00276 DS    0H                                               02S0277 00438000
*             RFY                                               02S0277 00439000
*               UCMLIST BASED(PATHUCME);/* TEMPORARILY REBASE UCME   */ 00440000
*             IF UCMUCB->UCBVHRSN='1'B&UCMUCB->UCBONLI='1'B&UCMUCB->    00441000
*                 UCBSYSR='1'B THEN                             02S0278 00442000
         L     @04,UCMUCB(,@11)                                 02S0278 00443000
         TM    UCBVHRSN(@04),B'00000010'                        02S0278 00444000
         BNO   @RF00278                                         02S0278 00445000
         TM    UCBONLI(@04),B'10000010'                         02S0278 00446000
         BNO   @RF00278                                         02S0278 00447000
*               UCMVHRSN='1'B;      /* TEST CONSOLE FOR I/O PATH LOSS*/ 00448000
         OI    UCMVHRSN(@11),B'00000001'                        02S0279 00449000
*             RFY                                               02S0280 00450000
*               UCMLIST BASED(UCMDVEPT);/* RESTORE NORMAL UCME BASE  */ 00451000
@RF00278 DS    0H                                               02S0281 00452000
*           END;                                                02S0281 00453000
         L     @11,PATHUCME                                     02S0281 00454000
         AL    @11,UCMVEZ(,UCMBASPT)                            02S0281 00455000
@DE00276 ST    @11,PATHUCME                                     02S0281 00456000
         C     @11,UCMVEL(,UCMBASPT)                            02S0281 00457000
         BNH   @DL00276                                         02S0281 00458000
*           IF MASTERO=ZERO         /* IS THE MASTER A COMPOSITE     */ 00459000
*             THEN                                              02S0282 00460000
         ICM   @11,15,MASTERO                                   02S0282 00461000
         BNZ   @RF00282                                         02S0282 00462000
*             MASTERO=MASTERI;      /* IF NOT, OUTPUT SAME AS INPUT  */ 00463000
         MVC   MASTERO(4),MASTERI                               02S0283 00464000
*/********************************************************************/ 00465000
*/*                                                                  */ 00466000
*/*  TEST THE MASTER CONSOLE TO SEE IF ITS PATH WOULD BE LOST BY THE */ 00467000
*/*  VARY COMMAND. IF YES, SEE IF AN ALTERNATE CAN BE FOUND.         */ 00468000
*/*                                                                  */ 00469000
*/********************************************************************/ 00470000
*                                                               02S0284 00471000
*           IF MASTERI->UCMVHRSN='1'B|MASTERO->UCMVHRSN='1'B/* IS       00472000
*                                      MASTER AFFECTD                */ 00473000
*             THEN                  /* YES, THEN DO SEARCH           */ 00474000
@RF00282 L     @11,MASTERI                                      02S0284 00475000
         TM    UCMVHRSN(@11),B'00000001'                        02S0284 00476000
         BO    @RT00284                                         02S0284 00477000
         L     @11,MASTERO                                      02S0284 00478000
         TM    UCMVHRSN(@11),B'00000001'                        02S0284 00479000
         BNO   @RF00284                                         02S0284 00480000
@RT00284 DS    0H                                               02S0285 00481000
*             DO;                                               02S0285 00482000
*                                                               03S0286 00483000
*/*** START OF VCPUMAST SEGMENT **************************************/ 00484000
*/*                                                                  */ 00485000
*/* VCPUMAST - SEARCHS FOR A MASTER CONSOLE FOR THE VCPU SEGMENT     */ 00486000
*/*                                                                  */ 00487000
*/* FUNCTION - IF THE I/O PATH TO THE MASTER CONSOLE WOULD BE        */ 00488000
*/*            AFFECTED BY THE CALLING VARY CPU OR VARY CHANNEL      */ 00489000
*/*            COMMAND, THIS ROUTINE SEARCHS THE MASTERS ALTERNATE   */ 00490000
*/*            CHAIN FOR AN ALTERNATE WHICH WOULD STILL BE ACTIVE    */ 00491000
*/*            IF THE COMMAND WERE PROCESSED.                        */ 00492000
*/*                                                                  */ 00493000
*/* INPUT  -   MASTERI CONTAINS ADDR OF MASTER CONSOLES UCME         */ 00494000
*/*                                                                  */ 00495000
*/* OUTPUT  -  RETCODE=0     IF SEARCH WAS SUCCESSFUL                */ 00496000
*/*              NEWI AND NEWO WILL CONTAIN PTRS TO ALTERNATE        */ 00497000
*/*            RETCODE=4     IF SEARCH WAS UNSUCCESSFUL              */ 00498000
*/*                                                                  */ 00499000
*/********************************************************************/ 00500000
*                                                               03S0286 00501000
*               MASTERI->UCMDEVCC='1'B;/* MARK INPUT HALF AS TESTED  */ 00502000
*               MASTERI->UCMDEVCC='1'B;/* MARK INPUT HALF AS TESTED  */ 00503000
         L     @11,MASTERI                                      03S0287 00504000
         OI    UCMDEVCC(@11),B'00100000'                        03S0287 00505000
*               MASTERO->UCMDEVCC='1'B;/* MARK OUTPUT HALF AS TESTED */ 00506000
         L     @04,MASTERO                                      03S0288 00507000
         OI    UCMDEVCC(@04),B'00100000'                        03S0288 00508000
*               NEWI=MASTERI->UCMALTEN;/* GET PTR TO ALTERNATE       */ 00509000
         L     NEWI,UCMALTEN(,@11)                              03S0289 00510000
*               IF NEWI^=ZERO       /* IS THERE AN ALTERNATE         */ 00511000
*                 THEN              /* YES, PROCEDE                  */ 00512000
         SLR   @11,@11                                          03S0290 00513000
         CR    NEWI,@11                                         03S0290 00514000
         BE    @RF00290                                         03S0290 00515000
*                 DO;                                           03S0291 00516000
*                   IF NEWI->UCMCOMPC=ZERO/* IS ALTERNATE A     03S0292 00517000
*                                      COMPOSITE?                    */ 00518000
*                     THEN                                      03S0292 00519000
         C     @11,UCMCOMPC(,NEWI)                              03S0292 00520000
         BNE   @RF00292                                         03S0292 00521000
*                     NEWO=NEWI;    /* NO, OUTPUT = INPUT            */ 00522000
         ST    NEWI,NEWO                                        03S0293 00523000
*                   ELSE                                        03S0294 00524000
*                     NEWO=NEWI->UCMCOMPC;/* YES, OUTPUT = OUTPUT       00525000
*                                      HALF                          */ 00526000
         B     @RC00292                                         03S0294 00527000
@RF00292 MVC   NEWO(4),UCMCOMPC(NEWI)                           03S0294 00528000
*                 END;                                          03S0295 00529000
@RC00292 DS    0H                                               03S0296 00530000
*               ALTFND='0'B;        /* INITIALIZE LOOP CONTROL SW    */ 00531000
@RF00290 NI    ALTFND,B'11111110'                               03S0296 00532000
*/* LOOP THRU THE MASTERS ALTERNATE CHAIN SEARCHING FOR ALTERNATE    */ 00533000
*                                                               03S0297 00534000
*               DO WHILE NEWI^=ZERO&ALTFND='0'B;                03S0297 00535000
         B     @DE00297                                         03S0297 00536000
@DL00297 DS    0H                                               03S0298 00537000
*                 IF NEWI->UCMDEVCC='0'B&NEWO->UCMDEVCC='0'B/* HAVE     00538000
*                                      THESE BEEN DONE               */ 00539000
*                   THEN                                        03S0298 00540000
         TM    UCMDEVCC(NEWI),B'00100000'                       03S0298 00541000
         BNZ   @RF00298                                         03S0298 00542000
         L     @11,NEWO                                         03S0298 00543000
         TM    UCMDEVCC(@11),B'00100000'                        03S0298 00544000
         BNZ   @RF00298                                         03S0298 00545000
*                   IF NEWI->UCMVHRSN='0'B/* IS CONSOLE I/O PATH        00546000
*                                      UNAFFECTED                    */ 00547000
*                       &(NEWI->UCMUF='1'B|NEWI->UCMTA='1'B)/* ACTIVE   00548000
*                                      OR OPEN PNDG                  */ 00549000
*                       &NEWI->UCMCF='0'B/* CLOSE IS NOT PENDING     */ 00550000
*                       &(NEWI->UCMDISPD='0'B|NEWI->UCMDISPC='1'B)/*    00551000
*                                      AND FULL I/O                  */ 00552000
*                       &NEWO->UCMVHRSN='0'B/* OUTPUT I/O PATH  03S0299 00553000
*                                      UNAFFECTED                    */ 00554000
*                       &(NEWO->UCMUF='1'B|NEWO->UCMTA='1'B)/* ACTIVE   00555000
*                                      OR OPEN PNDG                  */ 00556000
*                       &NEWO->UCMCF='0'B/* AND NOT CLOSE PENDING    */ 00557000
*                     THEN                                      03S0299 00558000
         TM    UCMVHRSN(NEWI),B'00000001'                       03S0299 00559000
         BNZ   @RF00299                                         03S0299 00560000
         TM    UCMUF(NEWI),B'00010000'                          03S0299 00561000
         BO    @GL00013                                         03S0299 00562000
         TM    UCMTA(NEWI),B'00001000'                          03S0299 00563000
         BNO   @RF00299                                         03S0299 00564000
@GL00013 TM    UCMCF(NEWI),B'00010000'                          03S0299 00565000
         BNZ   @RF00299                                         03S0299 00566000
         TM    UCMDISPC(NEWI),B'00100000'                       03S0299 00567000
         BNZ   @GL00011                                         03S0299 00568000
         TM    UCMDISPD(NEWI),B'00010000'                       03S0299 00569000
         BO    @RF00299                                         03S0299 00570000
@GL00011 L     @11,NEWO                                         03S0299 00571000
         TM    UCMVHRSN(@11),B'00000001'                        03S0299 00572000
         BNZ   @RF00299                                         03S0299 00573000
         TM    UCMUF(@11),B'00010000'                           03S0299 00574000
         BO    @GL00009                                         03S0299 00575000
         TM    UCMTA(@11),B'00001000'                           03S0299 00576000
         BNO   @RF00299                                         03S0299 00577000
@GL00009 L     @11,NEWO                                         03S0299 00578000
         TM    UCMCF(@11),B'00010000'                           03S0299 00579000
         BNZ   @RF00299                                         03S0299 00580000
*                     ALTFND=YES;   /* THEN ALTERNATE HAS BEEN FOUND */ 00581000
         OI    ALTFND,B'00000001'                               03S0300 00582000
*                   ELSE            /* IF ALTERNATE IS UNACCEPTABLE  */ 00583000
*                     DO;                                       03S0301 00584000
         B     @RC00299                                         03S0301 00585000
@RF00299 DS    0H                                               03S0302 00586000
*                       NEWI->UCMDEVCC='1'B;/* MARK INPUT HALF AS       00587000
*                                      TESTED                        */ 00588000
         OI    UCMDEVCC(NEWI),B'00100000'                       03S0302 00589000
*                       NEWO->UCMDEVCC='1'B;/* MARK OUTPUT HALF AS      00590000
*                                      TESTED                        */ 00591000
         L     @11,NEWO                                         03S0303 00592000
         OI    UCMDEVCC(@11),B'00100000'                        03S0303 00593000
*                       NEWI=NEWI->UCMALTEN;/* PICK UP PTR TO NEXT      00594000
*                                      ALT                           */ 00595000
         L     NEWI,UCMALTEN(,NEWI)                             03S0304 00596000
*                       IF NEWI->UCMCOMPC=ZERO/* IS NEW ALT A   03S0305 00597000
*                                      COMPOSITE                     */ 00598000
*                         THEN                                  03S0305 00599000
         ICM   @11,15,UCMCOMPC(NEWI)                            03S0305 00600000
         BNZ   @RF00305                                         03S0305 00601000
*                         NEWO=NEWI;/* NO, OUTPUT = INPUT            */ 00602000
         ST    NEWI,NEWO                                        03S0306 00603000
*                       ELSE                                    03S0307 00604000
*                         NEWO=NEWI->UCMCOMPC;/* OUTPUT = OTHER HALF */ 00605000
         B     @RC00305                                         03S0307 00606000
@RF00305 MVC   NEWO(4),UCMCOMPC(NEWI)                           03S0307 00607000
*                     END;                                      03S0308 00608000
*                 ELSE              /* IF NEW ALTERNATE WAS TESTED   */ 00609000
*                   DO;                                         03S0309 00610000
         B     @RC00298                                         03S0309 00611000
@RF00298 DS    0H                                               03S0310 00612000
*                     NEWI=ZERO;    /* NO ALTERNATE FOUND            */ 00613000
         SLR   NEWI,NEWI                                        03S0310 00614000
*                     NEWO=ZERO;    /* CLEAR OUTPUT HALF PTR ALSO    */ 00615000
         SLR   @11,@11                                          03S0311 00616000
         ST    @11,NEWO                                         03S0311 00617000
*                   END;                                        03S0312 00618000
*               END;                /* END SEARCH LOOP               */ 00619000
@RC00298 DS    0H                                               03S0313 00620000
@DE00297 LTR   NEWI,NEWI                                        03S0313 00621000
         BZ    @DC00297                                         03S0313 00622000
         TM    ALTFND,B'00000001'                               03S0313 00623000
         BZ    @DL00297                                         03S0313 00624000
@DC00297 DS    0H                                               03S0314 00625000
*               IF ALTFND=NO        /* WAS SEARCH UNSUCCESSFUL?      */ 00626000
*                 THEN                                          03S0314 00627000
         TM    ALTFND,B'00000001'                               03S0314 00628000
         BNZ   @RF00314                                         03S0314 00629000
*                 RETCODE=FOUR;     /* IF UNSUCCESSFUL, RETURN CODE=4*/ 00630000
         MVC   RETCODE(4),@CF00065                              03S0315 00631000
*/*** END OF VCPUMAST SEGMENT ****************************************/ 00632000
*                                                               03S0316 00633000
*             END;                                              02S0316 00634000
@RF00314 DS    0H                                               02S0317 00635000
*           IF RETCODE=ZERO         /* TEST RETURN CODE BEFOR GOING     00636000
*                                      ON                            */ 00637000
*             THEN                  /* RETURN CODE WAS ZERO, CONTINUE*/ 00638000
@RF00284 SLR   @11,@11                                          02S0317 00639000
         C     @11,RETCODE                                      02S0317 00640000
         BNE   @RF00317                                         02S0317 00641000
*             DO;                                               02S0318 00642000
*               IF UCMHCUCM^=ZERO   /* IS HARDCOPY TO A CONSOLE?     */ 00643000
*                 THEN                                          02S0319 00644000
         L     @04,UCMHCUCM(,UCMMCSPT)                          02S0319 00645000
         CR    @04,@11                                          02S0319 00646000
         BE    @RF00319                                         02S0319 00647000
*                 IF UCMHCUCM->UCMVHRSN='1'B/* AND IS ITS PATH  02S0320 00648000
*                                      AFFECTED                      */ 00649000
*                   THEN            /* YES, SEARCH FOR ALTERNATE     */ 00650000
         TM    UCMVHRSN(@04),B'00000001'                        02S0320 00651000
         BNO   @RF00320                                         02S0320 00652000
*                   DO;                                         02S0321 00653000
*                     FAILI=UCMHCUCM;/* GET PTR TO HARDCOPY UCME     */ 00654000
         ST    @04,FAILI                                        02S0322 00655000
*                     IF FAILI->UCMCOMPC^=ZERO/* IS HARDCOPY TO A       00656000
*                                      COMPOSITE                     */ 00657000
*                       THEN        /* YES, SET UP INPUT AND OUTPUT  */ 00658000
         L     @02,UCMCOMPC(,@04)                               02S0323 00659000
         CR    @02,@11                                          02S0323 00660000
         BE    @RF00323                                         02S0323 00661000
*                       DO;                                     02S0324 00662000
*                         FAILO=FAILI;/* ASSUME HC WAS OUTPUT HALF   */ 00663000
         ST    @04,FAILO                                        02S0325 00664000
*                         IF FAILI->UCMOF='1'B/* TEST ASSUMPTION     */ 00665000
*                           THEN                                02S0326 00666000
         TM    UCMOF(@04),B'10000000'                           02S0326 00667000
         BNO   @RF00326                                         02S0326 00668000
*                           FAILI=FAILI->UCMCOMPC;/* RIGHT, SET INPT */ 00669000
         ST    @02,FAILI                                        02S0327 00670000
*                         ELSE                                  02S0328 00671000
*                           FAILO=FAILI->UCMCOMPC;/* WRONG, SET OUTP */ 00672000
         B     @RC00326                                         02S0328 00673000
@RF00326 L     @11,FAILI                                        02S0328 00674000
         MVC   FAILO(4),UCMCOMPC(@11)                           02S0328 00675000
*                       END;                                    02S0329 00676000
*                     ELSE                                      02S0330 00677000
*                       FAILO=FAILI;/* IF HC NOT COMPOSITE OUTPU=INPT*/ 00678000
         B     @RC00323                                         02S0330 00679000
@RF00323 MVC   FAILO(4),FAILI                                   02S0330 00680000
*                     CALL FNDHCALT;/* GO SEARCH FOR HC ALTERNATE    */ 00681000
@RC00323 BAL   @14,FNDHCALT                                     02S0331 00682000
*                     IF NEWHC=ZERO /* WAS A HARDCOPY CONSOLE FOUND? */ 00683000
*                       THEN                                    02S0332 00684000
         LTR   NEWHC,NEWHC                                      02S0332 00685000
         BNZ   @RF00332                                         02S0332 00686000
*                       RETCODE=FOUR;/* IF NO, STOP VARY WITH CODE=4 */ 00687000
         MVC   RETCODE(4),@CF00065                              02S0333 00688000
*                   END;            /* END HARDCOPY CONSOLE SEARCH   */ 00689000
@RF00332 DS    0H                                               02S0335 00690000
*             END;                  /* END PROCESSING FOR RETCODE=0  */ 00691000
@RF00320 DS    0H                                               02S0335 00692000
@RF00319 DS    0H                                               02S0336 00693000
*/********************************************************************/ 00694000
*/*                                                                  */ 00695000
*/* IF RETURN CODE IS ZERO AT THIS POINT, THE VARY COMMAND IS 'GO'.  */ 00696000
*/* AN ALTERNATE FOR THE MASTER CONSOLE AND HARDCOPY CONSOLE HAVE    */ 00697000
*/* BEEN FOUND IF THEY WERE REQUIRED,. IF A SWITCH OF THE            */ 00698000
*/* MASTER CONSOLE IS NEEDED, IT WILL BE INDICATED BY NEWI BEING     */ 00699000
*/* NON-ZERO, THE SWITCH IS DONE NOW. THEN ALL REMAINING CONSOLES    */ 00700000
*/* WILL BE TESTED AND THOSE WHOSE I/O PATHS ARE AFFECTED WILL BE    */ 00701000
*/* SWITCHED TO AN ALTERNATE OR TO THE MASTER IF NO ALTERNATE EXISTS.*/ 00702000
*/*                                                                  */ 00703000
*/********************************************************************/ 00704000
*                                                               02S0336 00705000
*           IF RETCODE=ZERO         /* TEST RETURN CODE              */ 00706000
*             THEN                  /* RETURN CODE IS ZERO, CONSTINUE*/ 00707000
@RF00317 SLR   @11,@11                                          02S0336 00708000
         C     @11,RETCODE                                      02S0336 00709000
         BNE   @RF00336                                         02S0336 00710000
*             DO;                                               02S0337 00711000
*                                                               02S0337 00712000
*/* VARY COMMAND IS 'GO', SWITCH MASTER CONSOLE FUNCTION IF NEEDED.  */ 00713000
*/********************************************************************/ 00714000
*/*    THE FOLLOWING TWO INSTRUCTIONS PERFORM THE FOLLOWING PURPOSE: */ 00715000
*/*        (1) POST REQUIRED BIT IS TURNED ON TO INSURE THAT COMM    */ 00716000
*/*            TASK GETS CONTROL TO PROCESS THE CONSOLE CLOSE        */ 00717000
*/*            FOR CONSOLES ON THE CPU BEING TAKEN OFFLINE.          */ 00718000
*/*        (2) UCMSYSJ IS TURNED ON TO  INSURE THAT ONCE INTO COMM   */ 00719000
*/*            TASK, THE OUTPUT ROUTINE IN IEAVMDSV WILL BE CALLED   */ 00720000
*/*            FROM IEAVMQWR TO PROCESS THE CLOSE PENDINGS.          */ 00721000
*/*    IF THIS WERE NOT DONE, THEN THE POSSIBILITY EXISTS THAT WHEN  */ 00722000
*/*    THIS MODULE RETURNS TO VCPU, HE WILL SPIN WAITING FOR THE     */ 00723000
*/*    CONSOLES TO CLOSE, AND NO ONE IS AROUND TO WAKE UP COMM TASK  */ 00724000
*/*    TO ACTUALLY DO THE CLOSES.  WITH COMM TASK STILL IN A WAIT    */ 00725000
*/*    STATE, AND VCPU WAITING FOR THE CLOSES, IT WOULD APPEAR TO    */ 00726000
*/*    THE SYSTEM OPERATOR AS IF THE COMMAND GOT LOST IN THE SYSTEM. */ 00727000
*/*    TO FORSTALL THIS, WE INSURE THAT COMM TASK WILL BE POSTED     */ 00728000
*/*    AND WILL GO THROUGH THE NECESSARY CODE TO ACTUALLY CLOSE THE  */ 00729000
*/*    CONSOLES.                                                     */ 00730000
*/********************************************************************/ 00731000
*                                                               02S0338 00732000
*               POSTREQ='1'B;       /* SIGNAL POST COMMTASK   YM03457*/ 00733000
         OI    POSTREQ,B'00000010'                              02S0338 00734000
*               UCMSYSJ='1'B;       /* SIGNAL OUTPUT TO DO    YM03457*/ 00735000
         OI    UCMSYSJ(UCMMCSPT),B'01000000'                    02S0339 00736000
*/********************************************************************/ 00737000
*                                                               02S0340 00738000
*               IF NEWI^=ZERO       /* WAS ALTERNATE FOR THE MASTER     00739000
*                                      SELECTED?                     */ 00740000
*                 THEN              /* YES, MASTER SWITCH NEEDED     */ 00741000
         CR    NEWI,@11                                         02S0340 00742000
         BE    @RF00340                                         02S0340 00743000
*                 DO;                                           02S0341 00744000
*                   IF NEWI->UCMDISPC='1'B&NEWI->UCMDISPD='1'B/*        00745000
*                                      GRAPHICS AND OUTPUT ONLY?     */ 00746000
*                     THEN                                      02S0342 00747000
         TM    UCMDISPC(NEWI),B'00110000'                       02S0342 00748000
         BNO   @RF00342                                         02S0342 00749000
*                     CALL SWFULCAP;/* YES, SWITCH TO FULL CAPACITY  */ 00750000
         BAL   @14,SWFULCAP                                     02S0343 00751000
*                   FAILI=MASTERI;  /* SET UP PTR TO OLD FOR STATMSG */ 00752000
@RF00342 MVC   FAILI(4),MASTERI                                 02S0344 00753000
*                   FAILO=MASTERO;  /* SET UP PTR TO OLD FOR STATMSG */ 00754000
         MVC   FAILO(4),MASTERO                                 02S0345 00755000
*                   CALL SWCONS;    /* SWITCH CONSOLES FUNCTION      */ 00756000
         BAL   @14,SWCONS                                       02S0346 00757000
*                   OLDMAST=MASTERI;/* SAVE PTR TO OLD MASTER CONSOLE*/ 00758000
         MVC   OLDMAST(4),MASTERI                               02S0347 00759000
*                   MASTERI=NEWI;   /* ESTABLISH INPUT PTR TO NEW       00760000
*                                      MAST                          */ 00761000
         ST    NEWI,MASTERI                                     02S0348 00762000
*                   MASTERO=NEWO;   /* AND OUTPUT PTR TO NEW MASTER  */ 00763000
         MVC   MASTERO(4),NEWO                                  02S0349 00764000
*                 END;                                          02S0350 00765000
*                                                               02S0350 00766000
*/********************************************************************/ 00767000
*/*                                                                  */ 00768000
*/* NOW LOOP THRU ALL THE UCMES AND SWITCH THOSE CONSOLES WHOSE I.O  */ 00769000
*/* PATHS ARE AFFECTED. THE MASTER CONSOLE FUNCTION HAS ALREADY      */ 00770000
*/* BEEN SWITCH IF NECESSARY AND SWITCHING WILL BE AVOIDED.          */ 00771000
*/*                                                                  */ 00772000
*/********************************************************************/ 00773000
*                                                               02S0351 00774000
*               DO PATHUCME=UCMVEA TO UCMVEL BY UCMVEZ;         02S0351 00775000
@RF00340 L     @11,UCMVEA(,UCMBASPT)                            02S0351 00776000
         B     @DE00351                                         02S0351 00777000
@DL00351 DS    0H                                               02S0352 00778000
*                 FAILI=PATHUCME;   /* INITIALIZE FOR TESTING        */ 00779000
         ST    @11,FAILI                                        02S0352 00780000
*                 FAILO=FAILI->UCMCOMPC;/* ASSUME COMPOSITE CONSOLE  */ 00781000
         L     @04,UCMCOMPC(,@11)                               02S0353 00782000
         ST    @04,FAILO                                        02S0353 00783000
*                 IF FAILO=ZERO     /* TEST ASSUMPTION OF COMPOSITE  */ 00784000
*                   THEN                                        02S0354 00785000
         LTR   @04,@04                                          02S0354 00786000
         BNZ   @RF00354                                         02S0354 00787000
*                   FAILO=FAILI;    /* ASSUMPTION WRONG, OUTPUT=INPUT*/ 00788000
         ST    @11,FAILO                                        02S0355 00789000
*                 ELSE                                          02S0356 00790000
*                   PATHUCME=PATHUCME+UCMVEZ;/* CONSOLE IS COMPOSITE,   00791000
*                                      ADJUST LOOP CONTROL TO SKIP      00792000
*                                      OVER TWO CONSOLES             */ 00793000
         B     @RC00354                                         02S0356 00794000
@RF00354 L     @11,PATHUCME                                     02S0356 00795000
         AL    @11,UCMVEZ(,UCMBASPT)                            02S0356 00796000
         ST    @11,PATHUCME                                     02S0356 00797000
*                 IF FAILI->UCMVHRSN='1'B|FAILO->UCMVHRSN='1'B/* PATH   00798000
*                                      AFFECTED?                     */ 00799000
*                   THEN            /* YES, PATH WILL BE LOST.       */ 00800000
@RC00354 L     @11,FAILI                                        02S0357 00801000
         TM    UCMVHRSN(@11),B'00000001'                        02S0357 00802000
         BO    @RT00357                                         02S0357 00803000
         L     @11,FAILO                                        02S0357 00804000
         TM    UCMVHRSN(@11),B'00000001'                        02S0357 00805000
         BNO   @RF00357                                         02S0357 00806000
@RT00357 DS    0H                                               02S0358 00807000
*                   DO;                                         02S0358 00808000
*                     IF FAILI^=OLDMAST/* CHECK FOR OLD MASTER  02S0359 00809000
*                                      CONSOLE                       */ 00810000
*                       THEN        /* IF NOT OLD MASTER,PROCEDE     */ 00811000
         CLC   FAILI(4),OLDMAST                                 02S0359 00812000
         BE    @RF00359                                         02S0359 00813000
*                       DO;                                     02S0360 00814000
*                         NEWI=ZERO;/* CLEAR ALTERNATE PTR FOR FNDALT*/ 00815000
         SLR   NEWI,NEWI                                        02S0361 00816000
*                         NEWO=ZERO;/* CLEAR OUTPUT PTR ALSO         */ 00817000
         SLR   @11,@11                                          02S0362 00818000
         ST    @11,NEWO                                         02S0362 00819000
*                         CALL FINDALT;/* GO FIND AN ALTERNATE  02S0363 00820000
*                                      CONSOLE                       */ 00821000
         BAL   @14,FINDALT                                      02S0363 00822000
*                         CALL SWCONS;/* GO SWITCH CONSOLE FUNCTION     00823000
*                                      AND QUEUE STATUS MESSAGE.     */ 00824000
         BAL   @14,SWCONS                                       02S0364 00825000
*                       END;                                    02S0365 00826000
*                                                               02S0365 00827000
*/* MARK UCME AS CLOSE PENDING AND UCB AS GOING OFFLINE AND OUT OF      00828000
*   CONSOLE STATUS.                                                  */ 00829000
*                                                               02S0366 00830000
*                     DO CONTROL=FAILI TO FAILO BY UCMVEZ;/* LOOP IF    00831000
*                                      COMPOSITE                     */ 00832000
@RF00359 L     @11,FAILI                                        02S0366 00833000
         B     @DE00366                                         02S0366 00834000
@DL00366 DS    0H                                               02S0367 00835000
*                       CONTROL->UCMUCB->UCBCHGSX='1'B;/* GOING 02S0367 00836000
*                                      OFFLINE                       */ 00837000
*                       CONTROL->UCMUCB->UCBDADIX='1'B;/* GOING OUT     00838000
*                                      OF CONSOLE                    */ 00839000
         L     @11,UCMUCB(,@11)                                 02S0368 00840000
         L     @04,UCBCHGSX-3(,@11)                             02S0368 00841000
@GL00019 LR    @02,@04                                          02S0368 00842000
         O     @02,@CF03963                                     02S0368 00843000
         CS    @04,@02,UCBCHGSX-3(@11)                          02S0368 00844000
         BNE   @GL00019                                         02S0368 00845000
*                       CONTROL->UCMCF='1'B;/* MARK CONSOLE CLOSE       00846000
*                                      PENDING                       */ 00847000
         L     @11,CONTROL                                      02S0369 00848000
         OI    UCMCF(@11),B'00010000'                           02S0369 00849000
*                     END;                                      02S0370 00850000
         AL    @11,UCMVEZ(,UCMBASPT)                            02S0370 00851000
@DE00366 ST    @11,CONTROL                                      02S0370 00852000
         C     @11,FAILO                                        02S0370 00853000
         BNH   @DL00366                                         02S0370 00854000
*                   END;                                        02S0371 00855000
*               END;                /* END LOOP ON UCMES             */ 00856000
@RF00357 L     @11,PATHUCME                                     02S0372 00857000
         AL    @11,UCMVEZ(,UCMBASPT)                            02S0372 00858000
@DE00351 ST    @11,PATHUCME                                     02S0372 00859000
         C     @11,UCMVEL(,UCMBASPT)                            02S0372 00860000
         BNH   @DL00351                                         02S0372 00861000
*             END;                  /* END DO FOR RETCODE = 0        */ 00862000
*/*** END OF VCPU SEGMENT ********************************************/ 00863000
*                                                               02S0374 00864000
*         END;                                                  01S0374 00865000
@RF00336 DS    0H                                               01S0375 00866000
*       IF CSAACR='1'B              /* HAS A CPU FAILURE OCCURED     */ 00867000
*         THEN                                                  01S0375 00868000
@RF00274 TM    CSAACR(CXSAPTR),B'00010000'                      01S0375 00869000
         BNO   @RF00375                                         01S0375 00870000
*         DO;                       /* IF SO, PROCESS FOR ACR        */ 00871000
*                                                               02S0377 00872000
*/*** START OF ACR SEGMENT *******************************************/ 00873000
*/*                                                                  */ 00874000
*/* ACR - PERFORMS THE CONSOLE SWITCH FUNCTION FOR EVERY CONSOLE     */ 00875000
*/*       ON THE FAILING CPU.  IOS HAS MARKED THE AFFECTED CONSOLES  */ 00876000
*/*       OFFLINE AND HAS TURNED ON THE VARY COMMAND HIERARCHY       */ 00877000
*/*       REASON INDICATOR.  IF THE MASTER IS AFFECTED AND NO        */ 00878000
*/*       UNAFFECTED ALTERNATE CAN BE FOUND FOR IT, A MESSAGE WILL   */ 00879000
*/*       BE ISSUED ASKING THAT A VARY MSTCONS COMMAND BE ISSUED     */ 00880000
*/*       OR THE SYSTEM ALARM WILL BE RUNG.  MESSAGES ARE ALSO       */ 00881000
*/*       ISSUED TO THE ALTERNATE CONSOLES INFORMING THEM OF THEIR   */ 00882000
*/*       NEW FUNCTIONS.                                             */ 00883000
*/*                                                                  */ 00884000
*/* INPUT - UCBONLI=0 AFFECTED CONSOLES ARE MARKED OFFLINE           */ 00885000
*/*         UCBSYSR=1 DEVICE MUST BE IN CONSOLE STATUS               */ 00886000
*/*         UCBVHRSN=1 INDICATES CONSOLE IS AFFECTED BY THE FAILING  */ 00887000
*/*                    CPU                                           */ 00888000
*/*         MASTERI= UCME ADDR OF INPUT HALF OF MASTER CONSOLE       */ 00889000
*/*         MASTERO= UCME ADDR OF OUTPUT HALF OF MASTER OR 0         */ 00890000
*/*                                                                  */ 00891000
*/* OUTPUT - NONE.                                                   */ 00892000
*/*                                                                  */ 00893000
*/********************************************************************/ 00894000
*                                                               02S0377 00895000
*           /*********************************************************/ 00896000
*           /*                                                       */ 00897000
*           /* SCAN ALL THE UCMES AND FLAG THOSE CONSOLES AND THEIR  */ 00898000
*           /* COMPOSITE HALVES IF THEY ARE AFFECTED BY THE FAILING  */ 00899000
*           /* CPU.                                                  */ 00900000
*           /*                                                       */ 00901000
*           /*********************************************************/ 00902000
*                                                               02S0377 00903000
*           DO UCMDVEPT=UCMVEA TO UCMVEL BY UCMVEZ;             02S0377 00904000
         L     UCMDVEPT,UCMVEA(,UCMBASPT)                       02S0377 00905000
         B     @DE00377                                         02S0377 00906000
@DL00377 DS    0H                                               02S0378 00907000
*             IF UCBONLI='0'B       /* IF CONSOLE IS MARKED OFFLINE  */ 00908000
*                 &UCBSYSR='1'B     /* AND DEVICE IS IN CONSOLE 02S0378 00909000
*                                      STATUS                        */ 00910000
*                 &UCBVHRSN='1'B THEN/* AND AFFECTED BY ACR          */ 00911000
         L     @11,UCBPTR(,UCMDVEPT)                            02S0378 00912000
         TM    UCBSYSR(@11),B'00000010'                         02S0378 00913000
         BNO   @RF00378                                         02S0378 00914000
         TM    UCBONLI(@11),B'10000000'                         02S0378 00915000
         BNZ   @RF00378                                         02S0378 00916000
         TM    UCBVHRSN(@11),B'00000010'                        02S0378 00917000
         BNO   @RF00378                                         02S0378 00918000
*               DO;                 /* YES,                          */ 00919000
*                 UCMVHRSN='1'B;    /* SET AFFECTED BY ACR/VCPU FLAG    00920000
*                                      IN UCME                       */ 00921000
         OI    UCMVHRSN(UCMDVEPT),B'00000001'                   02S0380 00922000
*                 IF UCMCOMPC^=ZERO THEN/* COMPOSITE CONSOLE ?       */ 00923000
         L     @11,UCMCOMPC(,UCMDVEPT)                          02S0381 00924000
         LTR   @11,@11                                          02S0381 00925000
         BZ    @RF00381                                         02S0381 00926000
*                   UCMCOMPC->UCMVHRSN='1'B;/* YES, INDICATE OTHER      00927000
*                                      HALF IS ALSO AFFECTED         */ 00928000
         OI    UCMVHRSN(@11),B'00000001'                        02S0382 00929000
*               END;                                            02S0383 00930000
@RF00381 DS    0H                                               02S0384 00931000
*           END;                                                02S0384 00932000
@RF00378 AL    UCMDVEPT,UCMVEZ(,UCMBASPT)                       02S0384 00933000
@DE00377 C     UCMDVEPT,UCMVEL(,UCMBASPT)                       02S0384 00934000
         BNH   @DL00377                                         02S0384 00935000
*           OLDMAST=MASTERI;        /* SAVE PTR TO OLD MASTER        */ 00936000
*                                                               02S0385 00937000
         L     @11,MASTERI                                      02S0385 00938000
         ST    @11,OLDMAST                                      02S0385 00939000
*           /*********************************************************/ 00940000
*           /*                                                       */ 00941000
*           /* IF THE MASTER IS AFFECTED, FIRST SELECT AN ALTERNATE  */ 00942000
*           /* FOR IT                                                */ 00943000
*           /*                                                       */ 00944000
*           /*********************************************************/ 00945000
*                                                               02S0386 00946000
*           IF MASTERI->UCMVHRSN='1'B THEN/* IS THE MASTER AFFECTED? */ 00947000
         TM    UCMVHRSN(@11),B'00000001'                        02S0386 00948000
         BNO   @RF00386                                         02S0386 00949000
*             DO;                   /* YES,                          */ 00950000
*               FAILI=MASTERI;      /* SET PTR TO INPUT HALF OF 02S0388 00951000
*                                      FAILING                       */ 00952000
         ST    @11,FAILI                                        02S0388 00953000
*               FAILO=MASTERO;      /* SET PTR TO OUTPUT HALF OF        00954000
*                                      FAILING                       */ 00955000
         MVC   FAILO(4),MASTERO                                 02S0389 00956000
*               CALL FINDALT;       /* SELECT AN ALTERNATE           */ 00957000
         BAL   @14,FINDALT                                      02S0390 00958000
*               CALL SWCONS;        /* SWITCH FUNCTIONS AND MESSAGES    00959000
*                                      TO THE ALTERNATE IF ONE WAS      00960000
*                                      SELECTED OR PROCESS A NO 02S0391 00961000
*                                      MASTER CONDITION              */ 00962000
         BAL   @14,SWCONS                                       02S0391 00963000
*               UCMSYSD='0'B;       /* TURN OFF MASTER IS FAILING       00964000
*                                      FLAG                          */ 00965000
*                                                               02S0392 00966000
         NI    UCMSYSD(UCMMCSPT),B'11101111'                    02S0392 00967000
*               /*****************************************************/ 00968000
*               /*                                                   */ 00969000
*               /* MARK OLD MASTER SO IT CAN CLOSE. BOTH HALVES WILL */ 00970000
*               /* BE MARKED IF IT IS A COMPOSITE.                   */ 00971000
*               /*                                                   */ 00972000
*               /*****************************************************/ 00973000
*                                                               02S0393 00974000
*               DO CONTROL=MASTERI TO MASTERO BY UCMVEZ;        02S0393 00975000
         L     @11,MASTERI                                      02S0393 00976000
         B     @DE00393                                         02S0393 00977000
@DL00393 DS    0H                                               02S0394 00978000
*                 CONTROL->UCMUCB->UCBONLIX='1'B;/* SET ONLINE SO       00979000
*                                      CONSOLE CAN CLOSE AND GO 02S0394 00980000
*                                      OFFLINE                       */ 00981000
*                 CONTROL->UCMUCB->UCBCHGSX='1'B;/* GOING OFFLINE    */ 00982000
*                 CONTROL->UCMUCB->UCBDADIX='1'B;/* GOING OUT OF        00983000
*                                      CONSOLE STATUS                */ 00984000
         L     @11,UCMUCB(,@11)                                 02S0396 00985000
         L     @04,UCBONLIX-3(,@11)                             02S0396 00986000
@GL00021 LR    @02,@04                                          02S0396 00987000
         O     @02,@CF03967                                     02S0396 00988000
         CS    @04,@02,UCBONLIX-3(@11)                          02S0396 00989000
         BNE   @GL00021                                         02S0396 00990000
*               END;                                            02S0397 00991000
         L     @11,CONTROL                                      02S0397 00992000
         AL    @11,UCMVEZ(,UCMBASPT)                            02S0397 00993000
@DE00393 ST    @11,CONTROL                                      02S0397 00994000
         C     @11,MASTERO                                      02S0397 00995000
         BNH   @DL00393                                         02S0397 00996000
*               IF NEWI^=ZERO THEN  /* WAS AN ALTERNATE SELECTED ?   */ 00997000
         LTR   NEWI,NEWI                                        02S0398 00998000
         BZ    @RF00398                                         02S0398 00999000
*                 DO;               /* YES, SET PTRS TO THE NEW 02S0399 01000000
*                                      MASTER                        */ 01001000
*                   MASTERI=NEWI;   /* SET PTR TO INPUT HALF OF NEW     01002000
*                                      MASTER                        */ 01003000
         ST    NEWI,MASTERI                                     02S0400 01004000
*                   MASTERO=NEWI->UCMCOMPC;/* SET PTR TO OUTPUT HALF    01005000
*                                      OF NEW MASTER IF COMPOSITE OR    01006000
*                                      0                             */ 01007000
         MVC   MASTERO(4),UCMCOMPC(NEWI)                        02S0401 01008000
*                 END;                                          02S0402 01009000
*             END;                                              02S0403 01010000
*                                                               02S0403 01011000
@RF00398 DS    0H                                               02S0404 01012000
*           /*********************************************************/ 01013000
*           /*                                                       */ 01014000
*           /* PROCESS REMAINING CONSOLES AFFECTED BY ACR. IF THE    */ 01015000
*           /* MASTER WAS AFFECTED BUT NO ALTERNATE COULD BE FOUND   */ 01016000
*           /* FOR IT, THE AFFECTED SECONDARY CONSOLES ARE SWITCHED  */ 01017000
*           /* TO THE OLD MASTER IF NECESSARY. WHEN A VARY MSTCONS   */ 01018000
*           /* COMMAND IS SUBSEQUENTLY ISSUED, ALL THE SECONDARY     */ 01019000
*           /* CONSOLES FUNCTIONS AND MESSAGES WILL THEN BE          */ 01020000
*           /* TRANSFERRED FROM THE OLD MASTER TO THE NEW.           */ 01021000
*           /*                                                       */ 01022000
*           /*********************************************************/ 01023000
*                                                               02S0404 01024000
*           RFY                                                 02S0404 01025000
*             UCMLIST BASED(PATHUCME);                          02S0404 01026000
@RF00386 DS    0H                                               02S0405 01027000
*           DO PATHUCME=UCMVEA TO UCMVEL BY UCMVEZ;             02S0405 01028000
         L     @11,UCMVEA(,UCMBASPT)                            02S0405 01029000
         B     @DE00405                                         02S0405 01030000
@DL00405 DS    0H                                               02S0406 01031000
*             IF PATHUCME^=OLDMAST  /* IF THIS IS NOT THE OLD MASTER */ 01032000
*                 &UCMVHRSN='1'B THEN/* AND THE CONSOLE IS AFFECTED     01033000
*                                      BY ACR                        */ 01034000
         C     @11,OLDMAST                                      02S0406 01035000
         BE    @RF00406                                         02S0406 01036000
         TM    UCMVHRSN(@11),B'00000001'                        02S0406 01037000
         BNO   @RF00406                                         02S0406 01038000
*               DO;                 /* THEN PROCESS THE AFFECTED        01039000
*                                      CONSOLE                       */ 01040000
*                 FAILI=PATHUCME;   /* SET PTR TO INPUT HALF OF 02S0408 01041000
*                                      FAILING                       */ 01042000
         ST    @11,FAILI                                        02S0408 01043000
*                 FAILO=UCMCOMPC;   /* SET PTR TO OUTPUT HALF IF        01044000
*                                      COMPOSITE OR 0                */ 01045000
         MVC   FAILO(4),UCMCOMPC(@11)                           02S0409 01046000
*                 CALL FINDALT;     /* SELECT AN UNAFFECTED ALTERNATE   01047000
*                                      OR THE MASTER FOR THE NEW        01048000
*                                      CONSOLE                       */ 01049000
         BAL   @14,FINDALT                                      02S0410 01050000
*                 CALL SWCONS;      /* PERFORM THE CONSOLE SWITCH    */ 01051000
*                                                               02S0411 01052000
         BAL   @14,SWCONS                                       02S0411 01053000
*                 /***************************************************/ 01054000
*                 /*                                                 */ 01055000
*                 /* MARK CONSOLE SO IT CAN CLOSE. BOTH HALVES WILL  */ 01056000
*                 /* BE MARKED IF IT IS A COMPOSITE                  */ 01057000
*                 /*                                                 */ 01058000
*                 /***************************************************/ 01059000
*                                                               02S0412 01060000
*                 DO CONTROL=FAILI TO FAILO BY UCMVEZ;          02S0412 01061000
         L     @11,FAILI                                        02S0412 01062000
         B     @DE00412                                         02S0412 01063000
@DL00412 DS    0H                                               02S0413 01064000
*                   CONTROL->UCMUCB->UCBONLIX='1'B;/* SET ONLINE SO     01065000
*                                      CONSOLE CAN CLOSE             */ 01066000
*                   CONTROL->UCMUCB->UCBCHGSX='1'B;/* GOING OFFLINE  */ 01067000
*                   CONTROL->UCMUCB->UCBDADIX='1'B;/* GOING OUT OF      01068000
*                                      CONSOLE STATUS                */ 01069000
         L     @11,UCMUCB(,@11)                                 02S0415 01070000
         L     @04,UCBONLIX-3(,@11)                             02S0415 01071000
@GL00023 LR    @02,@04                                          02S0415 01072000
         O     @02,@CF03967                                     02S0415 01073000
         CS    @04,@02,UCBONLIX-3(@11)                          02S0415 01074000
         BNE   @GL00023                                         02S0415 01075000
*                 END;                                          02S0416 01076000
         L     @11,CONTROL                                      02S0416 01077000
         AL    @11,UCMVEZ(,UCMBASPT)                            02S0416 01078000
@DE00412 ST    @11,CONTROL                                      02S0416 01079000
         C     @11,FAILO                                        02S0416 01080000
         BNH   @DL00412                                         02S0416 01081000
*               END;                                            02S0417 01082000
*             IF UCMCOMPC^=ZERO THEN/* IS THE CONSOLE A COMPOSITE?   */ 01083000
@RF00406 L     @11,PATHUCME                                     02S0418 01084000
         ICM   @04,15,UCMCOMPC(@11)                             02S0418 01085000
         BZ    @RF00418                                         02S0418 01086000
*               PATHUCME=PATHUCME+UCMVEZ;/* BUMP UCME PTR TO THE        01087000
*                                      OUTPUT HALF SO IT WILL BE        01088000
*                                      SKIPPED                       */ 01089000
         AL    @11,UCMVEZ(,UCMBASPT)                            02S0419 01090000
         ST    @11,PATHUCME                                     02S0419 01091000
*           END;                    /* END OF UCME LOOP              */ 01092000
@RF00418 L     @11,PATHUCME                                     02S0420 01093000
         AL    @11,UCMVEZ(,UCMBASPT)                            02S0420 01094000
@DE00405 ST    @11,PATHUCME                                     02S0420 01095000
         C     @11,UCMVEL(,UCMBASPT)                            02S0420 01096000
         BNH   @DL00405                                         02S0420 01097000
*           RFY                                                 02S0421 01098000
*             UCMLIST BASED(UCMDVEPT);                          02S0421 01099000
*                                                               02S0421 01100000
*/*** END OF ACR SEGMENT *********************************************/ 01101000
*                                                               02S0422 01102000
*         END;                                                  01S0422 01103000
*     END;                                                      01S0423 01104000
*                                                               01S0423 01105000
@RF00375 DS    0H                                               01S0424 01106000
*   /*****************************************************************/ 01107000
*   /*                                                               */ 01108000
*   /* ALL MAINLINE PROCESSING IS COMPLETED, PERFORM WRAPUP.         */ 01109000
*   /*                                                               */ 01110000
*   /*****************************************************************/ 01111000
*                                                               01S0424 01112000
*                                                               02S0424 01113000
*/*** START OF WRAPUP SEGMENT ****************************************/ 01114000
*/*                                                                  */ 01115000
*/* WRAPUP - PERFORMS END FUNCTIONS WHICH REQUIRE THE LOCKS TO       */ 01116000
*/*          BE FREED.                                               */ 01117000
*/*                                                                  */ 01118000
*/* INPUT - NCCNOW  =1 IF A NO-CONSOLES CONDITION WAS        @ZA18879*/ 01119000
*/*                    ENTERED THIS TIME THROUGH IEAVSWCH.   @ZA18879*/ 01120000
*/*         RINGBELL=1 IF CONSOLE ALARM SHOULD BE RUNG               */ 01121000
*/*         RINGPOWR=1 IF THE POWER AND COOLING ALARM SHOULD @G51APSS*/ 01122000
*/*                    BE SOUNDED                            @G51APSS*/ 01123000
*/*         AMFAMSG=1  IF VARY MSTCONS MSG (IEE141A) SHOULD BE       */ 01124000
*/*                    ISSUED                                        */ 01125000
*/*         HCSUSP=1   IF HARDCOPY SUSPENDED MSG (IEA964I) SHOULD BE */ 01126000
*/*                    ISSUED.                                       */ 01127000
*/*         POSTREQ=1  IF XMPOST OF COMMTASK (UCMOECB) SHOULD BE     */ 01128000
*/*                    DONE                                          */ 01129000
*/*                                                                  */ 01130000
*/* OUTPUT - NONE                                                    */ 01131000
*/*                                                                  */ 01132000
*/********************************************************************/ 01133000
*                                                               02S0424 01134000
*   UCMSYSD='0'B;                   /* TURN OFF MASTER-IS-FAILING    */ 01135000
*                                                               02S0424 01136000
@RC00226 NI    UCMSYSD(UCMMCSPT),B'11101111'                    02S0424 01137000
*   /*****************************************************************/ 01138000
*   /*                                                               */ 01139000
*   /* CLEAR UCMVHRSN FLAGS                                          */ 01140000
*   /*                                                               */ 01141000
*   /*****************************************************************/ 01142000
*                                                               02S0425 01143000
*   DO CONTROL=UCMVEA TO UCMVEL BY UCMVEZ;                      02S0425 01144000
         L     @11,UCMVEA(,UCMBASPT)                            02S0425 01145000
         B     @DE00425                                         02S0425 01146000
@DL00425 DS    0H                                               02S0426 01147000
*     CONTROL->UCMVHRSN='0'B;       /* TURN OFF AFFECTED BY ACR/VCPU    01148000
*                                      FLAG                          */ 01149000
         NI    UCMVHRSN(@11),B'11111110'                        02S0426 01150000
*   END;                                                        02S0427 01151000
*                                                               02S0427 01152000
         AL    @11,UCMVEZ(,UCMBASPT)                            02S0427 01153000
@DE00425 ST    @11,CONTROL                                      02S0427 01154000
         C     @11,UCMVEL(,UCMBASPT)                            02S0427 01155000
         BNH   @DL00425                                         02S0427 01156000
*   /*****************************************************************/ 01157000
*   /*                                                               */ 01158000
*   /* SHOULD MESSAGE IEE141A BE DOMED?                      @G51APSS*/ 01159000
*   /*                                                               */ 01160000
*   /*****************************************************************/ 01161000
*                                                               02S0428 01162000
*   IF UCMPNMCC^=ZERO&              /* ISSUE DOM IF A DOMID  @ZA19261*/ 01163000
*       (CSAVMST='1'B|              /* EXISTS AND V MSTCONS  @ZA19261*/ 01164000
*       CSAEXTI='1'B|               /* OR EXTERNAL INTERRUPT @ZA19261*/ 01165000
*       AMFAMSG='1'B) THEN          /* OR MSG IEE141A IS TO BE ISSUED   01166000
*                                                            @ZA19261*/ 01167000
         L     @11,UCMFXPTR(,UCMBASPT)                          02S0428 01168000
         L     @11,UCMPXPTR(,@11)                               02S0428 01169000
         ICM   @04,15,UCMPNMCC(@11)                             02S0428 01170000
         BZ    @RF00428                                         02S0428 01171000
         TM    CSAVMST(CXSAPTR),B'00001100'                     02S0428 01172000
         BNZ   @RT00428                                         02S0428 01173000
         TM    AMFAMSG,B'01000000'                              02S0428 01174000
         BNO   @RF00428                                         02S0428 01175000
@RT00428 DS    0H                                               02S0429 01176000
*     DO;                           /* FOR IEE141A MSG.      @ZA08472*/ 01177000
*       UCMAMFA='0'B;               /* TURN OFF ACCEPT VARY  @ZA08472*/ 01178000
         NI    UCMAMFA(UCMBASPT),B'11110111'                    02S0430 01179000
*       RFY                                                     02S0431 01180000
*        (REG01) RSTD;              /* RESTRICT REG1 FOR DOM @ZA08472*/ 01181000
*       CALL FRLOCKS;               /* RELSE LOCKS FOR SVC87 @ZA08472*/ 01182000
         BAL   @14,FRLOCKS                                      02S0432 01183000
*       REG01=UCMPNMCC;             /* GET DOMID AND DOM IT. @ZA08472*/ 01184000
         L     @11,UCMFXPTR(,UCMBASPT)                          02S0433 01185000
         L     @11,UCMPXPTR(,@11)                               02S0433 01186000
         L     REG01,UCMPNMCC(,@11)                             02S0433 01187000
*       GEN;                                                    02S0434 01188000
*                                  /*                        @ZA08472*/ 01189000
         DOM   MSG=(1)                                         @ZA08472 01190000
*       RFY                                                     02S0435 01191000
*        (REG01) UNRSTD;            /* RELEASE REG1 AFTER DOM   02S0435 01192000
*                                                            @ZA08472*/ 01193000
*       CALL GETLOCKS;              /* REOBTAIN LOCKS        @ZA08472*/ 01194000
         BAL   @14,GETLOCKS                                     02S0436 01195000
*       UCMPNMCC=ZERO;              /* INDICATE NO DOMID TO BE  02S0437 01196000
*                                                            @ZA08472*/ 01197000
         L     @11,UCMFXPTR(,UCMBASPT)                          02S0437 01198000
         L     @11,UCMPXPTR(,@11)                               02S0437 01199000
         SLR   @04,@04                                          02S0437 01200000
         ST    @04,UCMPNMCC(,@11)                               02S0437 01201000
*     END;                          /* DOMED.                @ZA08472*/ 01202000
*                                                               02S0438 01203000
*   /*****************************************************************/ 01204000
*   /*                                                               */ 01205000
*   /* SHOULD MESSAGE IEA420A BE DOMED?                      @G51APSS*/ 01206000
*   /*                                                               */ 01207000
*   /*****************************************************************/ 01208000
*                                                               02S0439 01209000
*   IF UCMPNCC^=ZERO&               /* DOES A DOM ID FOR IEA420A        01210000
*                                      EXIST AND             @G51APSS*/ 01211000
*       UCMSYSE='0'B THEN           /* A NO-CONSOLES CONDITION NO       01212000
*                                      LONGER EXISTS?        @G51APSS*/ 01213000
@RF00428 L     @11,UCMFXPTR(,UCMBASPT)                          02S0439 01214000
         L     @11,UCMPXPTR(,@11)                               02S0439 01215000
         L     @11,UCMPNCC(,@11)                                02S0439 01216000
         LTR   @11,@11                                          02S0439 01217000
         BZ    @RF00439                                         02S0439 01218000
         TM    UCMSYSE(UCMMCSPT),B'00001000'                    02S0439 01219000
         BNZ   @RF00439                                         02S0439 01220000
*     DO;                           /* YES                   @G51APSS*/ 01221000
*       RFY                                                     02S0441 01222000
*         REG01 RSTD;               /*                       @G51APSS*/ 01223000
*       REG01=UCMPNCC;              /* GET DOM ID            @G51APSS*/ 01224000
         LR    REG01,@11                                        02S0442 01225000
*       CALL FRLOCKS;               /* RELEASE THE LOCKS     @G51APSS*/ 01226000
         BAL   @14,FRLOCKS                                      02S0443 01227000
*       DO;                         /* DOM MSG(REG01)                */ 01228000
*         RFY                                                   02S0445 01229000
*          (GPR00F,                                             02S0445 01230000
*           GPR01F) RSTD;           /* RESTRICT REGISTERS            */ 01231000
*         GPR01F=REG01;             /* MOVE IN MESSAGE ID            */ 01232000
*         GPR00F=0;                 /* SHOW MSG SPECIFIED            */ 01233000
         SLR   GPR00F,GPR00F                                    02S0447 01234000
*         SVC(87);                  /* ISSUE DOM SVC                 */ 01235000
         SVC   87                                               02S0448 01236000
*         RFY                                                   02S0449 01237000
*          (GPR00F,                                             02S0449 01238000
*           GPR01F) UNRSTD;         /* RELEASE REGISTERS             */ 01239000
*       END;                        /* DOM MSG(REG01) DOM IEA420A       01240000
*                                                            @G51APSS*/ 01241000
*       RFY                                                     02S0451 01242000
*         REG01 UNRSTD;             /*                       @G51APSS*/ 01243000
*       CALL GETLOCKS;              /* OBTAIN THE LOCKS      @G51APSS*/ 01244000
         BAL   @14,GETLOCKS                                     02S0452 01245000
*       UCMPNCC=ZERO;               /*                       @G51APSS*/ 01246000
         L     @11,UCMFXPTR(,UCMBASPT)                          02S0453 01247000
         L     @11,UCMPXPTR(,@11)                               02S0453 01248000
         SLR   @04,@04                                          02S0453 01249000
         ST    @04,UCMPNCC(,@11)                                02S0453 01250000
*     END;                          /*                       @G51APSS*/ 01251000
*                                                               02S0454 01252000
*   /*****************************************************************/ 01253000
*   /*                                                               */ 01254000
*   /* SHOULD ANY ALARMS BE SOUNDED?                         @G51APSS*/ 01255000
*   /*                                                               */ 01256000
*   /*****************************************************************/ 01257000
*                                                               02S0455 01258000
*   IF RINGBELL=YES THEN            /* SHOULD CONSOLE ALARM BE RUNG     01259000
*                                                            @G51APSS*/ 01260000
@RF00439 TM    RINGBELL,B'01000000'                             02S0455 01261000
         BNO   @RF00455                                         02S0455 01262000
*     CALL SOUNDBEL;                /* YES, RING CONSOLE ALARM  02S0456 01263000
*                                                            @G51APSS*/ 01264000
         BAL   @14,SOUNDBEL                                     02S0456 01265000
*   IF RINGPOWR=YES THEN            /* SHOULD POWER AND COOLING ALARM   01266000
*                                      BE SOUNDED?           @G51APSS*/ 01267000
@RF00455 TM    RINGPOWR,B'00100000'                             02S0457 01268000
         BNO   @RF00457                                         02S0457 01269000
*     CALL SOUNDPWR;                /* YES                           */ 01270000
*                                                               02S0458 01271000
         BAL   @14,SOUNDPWR                                     02S0458 01272000
*   /*****************************************************************/ 01273000
*   /*                                                               */ 01274000
*   /* DOES A NO-CONSOLES CONDITION EXIST? IF SO ISSUE MESSAGE       */ 01275000
*   /* IEA420A                                               @G51APSS*/ 01276000
*   /*                                                               */ 01277000
*   /*****************************************************************/ 01278000
*                                                               02S0459 01279000
*   IF NCCNOW=YES|                  /* DID THE NO-CONSOLES CONDITION    01280000
*                                      OCCUR THIS TIME THRU SWCH?       01281000
*                                                            @ZA18879*/ 01282000
*       UCMSYSL='1'B THEN           /* OR DID DSP ABEND WHILE TRYING    01283000
*                                      TO OPEN/CLOSE A DEVICE IN A NO   01284000
*                                      CONSOLES CONDITION    @G51APSS*/ 01285000
@RF00457 TM    NCCNOW,B'01000000'                               02S0459 01286000
         BO    @RT00459                                         02S0459 01287000
         TM    UCMSYSL(UCMMCSPT),B'00010000'                    02S0459 01288000
         BNO   @RF00459                                         02S0459 01289000
@RT00459 DS    0H                                               02S0460 01290000
*     DO;                           /* YES                   @G51APSS*/ 01291000
*       UCMSYSL='0'B;               /* RESET FOR NEXT NCC    @G51APSS*/ 01292000
*       UCMSYSP='0'B;               /*                       @G51APSS*/ 01293000
         NI    UCMSYSL(UCMMCSPT),B'11101110'                    02S0462 01294000
*       CALL SAVEINDX;              /* SET UP DEVICES SO A NEW MASTER   01295000
*                                      CONSOLE CAN BE CHOSEN @G51APSS*/ 01296000
         BAL   @14,SAVEINDX                                     02S0463 01297000
*       CALL SUBSWTCH;              /* NOTIFY SUBSYSTEM OF      02S0464 01298000
*                                      NO-CONSOLES CONDITION @G51APSS*/ 01299000
         BAL   @14,SUBSWTCH                                     02S0464 01300000
*       CALL FRLOCKS;               /* RELEASE LOCKS         @G51APSS*/ 01301000
         BAL   @14,FRLOCKS                                      02S0465 01302000
*       RFY                                                     02S0466 01303000
*        (REG00,                                                02S0466 01304000
*         REG01) RSTD;              /*                       @G51APSS*/ 01305000
*       REG00=ZERO;                 /* CLEAR FOR MLWTO       @G51APSS*/ 01306000
         SLR   REG00,REG00                                      02S0467 01307000
*       GEN SETS(REG01);                                        02S0468 01308000
*                                   /* ISSUE IEA420A         @G51APSS*/ 01309000
         WTO   ('IEA420A NO FULL CAPABILITY CONSOLES',D),              X01310000
               ('     TO RESTORE MASTER CONSOLE:',D),                  X01311000
               ('     1) PRESS ENTER, REQUEST, OR END ON ANY AVAILABLE X01312000
               CONSOLE',D),                                            X01313000
               ('     2) PRESS THE EXTERNAL INTERRUPT KEY',DE),        X01314000
               DESC=(2),MCSFLAG=(BRDCST)                       @G51APSS 01315000
*       UCMPNCC=REG01;              /* SAVE WTO DOM ID       @G51APSS*/ 01316000
         L     @11,UCMFXPTR(,UCMBASPT)                          02S0469 01317000
         L     @11,UCMPXPTR(,@11)                               02S0469 01318000
         ST    REG01,UCMPNCC(,@11)                              02S0469 01319000
*       RFY                                                     02S0470 01320000
*        (REG00,                                                02S0470 01321000
*         REG01) UNRSTD;            /*                       @G51APSS*/ 01322000
*       CALL GETLOCKS;              /* OBTAIN THE LOCKS      @G51APSS*/ 01323000
         BAL   @14,GETLOCKS                                     02S0471 01324000
*       UCMFATCN=ZERO;              /* ALLOW IEAVVCRA TO ACCEPT A       01325000
*                                      CANDIDATE FOR THE NEW MASTER     01326000
*                                      CONSOLE               @G51APSS*/ 01327000
         L     @11,UCMFXPTR(,UCMBASPT)                          02S0472 01328000
         SLR   @07,@07                                          02S0472 01329000
         ST    @07,UCMFATCN(,@11)                               02S0472 01330000
*     END;                          /*                       @G51APSS*/ 01331000
*   CALL FRLOCKS;                   /* RELEASE LOCKS         @G51APSS*/ 01332000
*                                                               02S0474 01333000
@RF00459 BAL   @14,FRLOCKS                                      02S0474 01334000
*   /*****************************************************************/ 01335000
*   /*                                                               */ 01336000
*   /* SHOULD MESSAGE IEE141A BE ISSUED?                     @G51APSS*/ 01337000
*   /*                                                               */ 01338000
*   /*****************************************************************/ 01339000
*                                                               02S0475 01340000
*   IF AMFAMSG='1'B THEN            /* SHOULD VARY MSTCONS MSG BE       01341000
*                                      ISSUED                        */ 01342000
         TM    AMFAMSG,B'01000000'                              02S0475 01343000
         BNO   @RF00475                                         02S0475 01344000
*     DO;                           /* YES                           */ 01345000
*       UCMAMFA='1'B;               /* INDICATE ACCEPT VARY MSTCONS     01346000
*                                      FROM ANYONE           @ZA19261*/ 01347000
         OI    UCMAMFA(UCMBASPT),B'00001000'                    02S0477 01348000
*       RFY                                                     02S0478 01349000
*         REG01 RSTD;               /*                       @G51APSS*/ 01350000
*       GEN;                                                    02S0479 01351000
*                                                         /* @ZA08472*/ 01352000
         WTO 'IEE141A  MASTER AND ALL ALTERNATES UNAVAILABLE - ISSUE VA*01353000
               RY MSTCONS',DESC=2,MCSFLAG=BRDCST               @ZA08472 01354000
*       UCMPNMCC=REG01;             /* SAVE WTO DOM ID FOR DOM  02S0480 01355000
*                                                            @ZA08472*/ 01356000
         L     @11,UCMFXPTR(,UCMBASPT)                          02S0480 01357000
         L     @11,UCMPXPTR(,@11)                               02S0480 01358000
         ST    REG01,UCMPNMCC(,@11)                             02S0480 01359000
*       RFY                                                     02S0481 01360000
*         REG01 UNRSTD;             /*                       @G51APSS*/ 01361000
*     END;                                                      02S0482 01362000
*                                                               02S0482 01363000
*   /*****************************************************************/ 01364000
*   /*                                                               */ 01365000
*   /* SHOULD MESSAGE IEA964I BE ISSUED?                     @G51APSS*/ 01366000
*   /*                                                               */ 01367000
*   /*****************************************************************/ 01368000
*                                                               02S0483 01369000
*   IF HCSUSP='1'B THEN             /* SHOULD HC SUSPENDED MSG BE       01370000
*                                      ISSUED                        */ 01371000
@RF00475 TM    HCSUSP,B'10000000'                               02S0483 01372000
         BNO   @RF00483                                         02S0483 01373000
*     DO;                           /* YES                           */ 01374000
*       GEN;                                                    02S0485 01375000
         WTO 'IEA964I HARDCOPY SUSPENDED, NO HARDCOPY DEVICE AVAILABLE'*01376000
               ,ROUTCDE=1,DESC=4                                        01377000
*     END;                                                      02S0486 01378000
*                                                               02S0486 01379000
*   /*****************************************************************/ 01380000
*   /*                                                               */ 01381000
*   /* SHOULD OECB BE POSTED?                                @G51APSS*/ 01382000
*   /*                                                               */ 01383000
*   /*****************************************************************/ 01384000
*                                                               02S0487 01385000
*   IF MSGFLAG1=ZERO&POSTREQ='1'B THEN/* IF NO WTOS WERE ISSUED AND A   01386000
*                                      POST IS REQUIRED              */ 01387000
@RF00483 CLI   MSGFLAG1,0                                       02S0487 01388000
         BNE   @RF00487                                         02S0487 01389000
         TM    POSTREQ,B'00000010'                              02S0487 01390000
         BNO   @RF00487                                         02S0487 01391000
*     DO;                           /* THEN DO A XMPOST OF THE WTO      01392000
*                                      ECB                           */ 01393000
*       DO;                         /* POST (UCMOECB) ASCB(ASCB)        01394000
*                                      ERRET(CVTBRET)                */ 01395000
*         I002=I002&&I002;          /* INITIALIZE LIST               */ 01396000
         XC    I002(12),I002                                    02S0490 01397000
*         I00201=ADDR(UCMOECB);     /* ECB ADDRESS                   */ 01398000
         LA    @11,UCMOECB(,UCMBASPT)                           02S0491 01399000
         ST    @11,I00201                                       02S0491 01400000
*         I00202=ADDR(ASCB);        /* ASCB ADDRESS                  */ 01401000
         MVC   I00202(4),ASCBPTR(UCMBASPT)                      02S0492 01402000
*         I00203=ADDR(CVTBRET);     /* ERRET ADDRESS                 */ 01403000
         L     @07,LCVTPTR                                      02S0493 01404000
         LA    @07,CVTBRET(,@07)                                02S0493 01405000
         ST    @07,I00203                                       02S0493 01406000
*         RESPECIFY                                             02S0494 01407000
*          (GPR00F,                                             02S0494 01408000
*           GPR01P) RESTRICTED;                                 02S0494 01409000
*         GPR00F=0;                 /* POST CODE IN R0               */ 01410000
         SLR   GPR00F,GPR00F                                    02S0495 01411000
*         GPR01P=ADDR(I002);        /* PARMLIST ADDR                 */ 01412000
         LA    GPR01P,I002                                      02S0496 01413000
*         GPR01P=GPR01P|'80000000'X;/* SET LIST FORM IND             */ 01414000
         O     GPR01P,@CF03732                                  02S0497 01415000
*         SVC(2);                   /* ISSUE POST SVC                */ 01416000
         SVC   2                                                02S0498 01417000
*         RESPECIFY                                             02S0499 01418000
*          (GPR00F,                                             02S0499 01419000
*           GPR01P) UNRESTRICTED;                               02S0499 01420000
*       END;                        /* POST (UCMOECB) ASCB(ASCB)        01421000
*                                      ERRET(CVTBRET)                */ 01422000
*     END;                                                      02S0501 01423000
*                                                               02S0501 01424000
*/*** END OF WRAPUP SEGMENT ******************************************/ 01425000
*                                                               02S0502 01426000
*   RETURN CODE(RETCODE) TO RETURNPT;/* RETURN TO SVC SLIH           */ 01427000
@RF00487 L     @07,CSAXA(,CXSAPTR)                              01S0502 01428000
         L     @04,RETCODE                                      01S0502 01429000
         L     @13,4(,@13)                                      01S0502 01430000
         L     @00,@SIZDATD                                     01S0502 01431000
         LR    @01,@09                                          01S0502 01432000
         FREEMAIN R,LV=(0),A=(1)                                        01433000
         LR    @14,@07                                          01S0502 01434000
         LR    @15,@04                                          01S0502 01435000
         BR    @14                                              01S0502 01436000
*                                                               01S0503 01437000
*   /*****************************************************************/ 01438000
*   /*                                                               */ 01439000
*   /* NOW INCLUDE THE SUBROUTINES                                   */ 01440000
*   /*                                                               */ 01441000
*   /*****************************************************************/ 01442000
*                                                               01S0503 01443000
         EJECT                                                          01444000
*                                                               02S0503 01445000
*/*** START OF EXTINNCC SUBROUTINE ***********************************/ 01446000
*/*                                                                  */ 01447000
*/* EXTINNCC - THE EXTERNAL INTERRUPT ECB HAS BEEN POSTED    @G51APSS*/ 01448000
*/*            AND A NO-CONSOLES CONDITION EXISTS.           @G51APSS*/ 01449000
*/*                                                                  */ 01450000
*/* FUNCTION - RESTORE THE ATTENTION INDICES WHICH WERE      @G51APSS*/ 01451000
*/*            SAVED WHEN THE NO-CONSOLES CONDITION AROSE.   @G51APSS*/ 01452000
*/*            IF NO CANDIDATE FOR THE NEW MASTER WAS CHOSEN @G51APSS*/ 01453000
*/*            THEN MARK THE OLD MASTER SO IT APPEARS AS IF  @G51APSS*/ 01454000
*/*            A VARY CONSOLE WAS ISSUED FOR IT.             @G51APSS*/ 01455000
*/*            CAUSE THE OLD MASTERS FUNCTION TO SWITCH TO   @G51APSS*/ 01456000
*/*            THE CANDIDATE.                                @G51APSS*/ 01457000
*/*                                                                  */ 01458000
*/* INPUT    - UCMFATCN - ADDR OF CANDIDATES UCME OR ZERO    @G51APSS*/ 01459000
*/*                                                                  */ 01460000
*/* OUTPUT   - OLD MASTERS FUNCTIONS SWITCHED TO NEW MASTER  @G51APSS*/ 01461000
*/*                                                                  */ 01462000
*/********************************************************************/ 01463000
*                                                               02S0503 01464000
*EXTINNCC:                                                      02S0503 01465000
*   PROC OPTIONS(SAVE);             /*                       @G51APSS*/ 01466000
@EL00001 L     @13,4(,@13)                                      02S0503 01467000
@EF00001 L     @00,@SIZDATD                                     02S0503 01468000
         LR    @01,@09                                          02S0503 01469000
         FREEMAIN R,LV=(0),A=(1)                                        01470000
@ER00001 BR    @14                                              02S0503 01471000
EXTINNCC STM   @14,@02,@SA00002                                 02S0503 01472000
         STM   @04,@12,@SA00002+20                              02S0503 01473000
*   POSTREQ='1'B;                   /* MARK THAT POST OF OECB MUST BE   01474000
*                                      DONE                  @G51APSS*/ 01475000
         OI    POSTREQ,B'00000010'                              02S0504 01476000
*   CALL ENQQ4;                     /* TRY TO OBTAIN Q4      @G51APSS*/ 01477000
*                                                               02S0505 01478000
         BAL   @14,ENQQ4                                        02S0505 01479000
*   /*****************************************************************/ 01480000
*   /*                                                               */ 01481000
*   /* LOOP THRU UCMES RESTORING THE ATTN INDICES AND UCBSYSR        */ 01482000
*   /*                                                       @G51APSS*/ 01483000
*   /*                                                               */ 01484000
*   /*****************************************************************/ 01485000
*                                                               02S0506 01486000
*   DO UCMDVEPT=UCMVEA TO UCMVEL BY UCMVEZ;/*                @G51APSS*/ 01487000
         L     UCMDVEPT,UCMVEA(,UCMBASPT)                       02S0506 01488000
         B     @DE00506                                         02S0506 01489000
@DL00506 DS    0H                                               02S0507 01490000
*     IF UCMEFLGA='1'B THEN         /* WAS ATTN INDEX SAVED? @G51APSS*/ 01491000
         L     @11,UCMFEXTP(,UCMDVEPT)                          02S0507 01492000
         TM    UCMEFLGA(@11),B'10000000'                        02S0507 01493000
         BNO   @RF00507                                         02S0507 01494000
*       IF UCBATI=COMTSKAX THEN     /* IS ATTN INDEX FOR DEVICE THE     01495000
*                                      SAME AS WHAT WAS PLACED THERE    01496000
*                                      WHEN THE NO-CONSOLES CONDITION   01497000
*                                      AROSE?                @G51APSS*/ 01498000
         L     @04,UCBPTR(,UCMDVEPT)                            02S0508 01499000
         L     @04,UCBEXTPT(,@04)                               02S0508 01500000
         CLI   UCBATI(@04),4                                    02S0508 01501000
         BNE   @RF00508                                         02S0508 01502000
*         UCBATI=UCMEFATT;          /* YES, RESTORE ATTN INDEX  02S0509 01503000
*                                                            @G51APSS*/ 01504000
         MVC   UCBATI(1,@04),UCMEFATT(@11)                      02S0509 01505000
*     UCMEFLGA='0'B;                /* MARK ATTN INDEX SAVED IS NOT     01506000
*                                      VALID                 @G51APSS*/ 01507000
@RF00508 DS    0H                                               02S0510 01508000
@RF00507 L     @11,UCMFEXTP(,UCMDVEPT)                          02S0510 01509000
         NI    UCMEFLGA(@11),B'01111111'                        02S0510 01510000
*     IF UCMEFLGB='1'B THEN         /* WAS UCBSYSR FORCED ON @G51APSS*/ 01511000
         TM    UCMEFLGB(@11),B'01000000'                        02S0511 01512000
         BNO   @RF00511                                         02S0511 01513000
*       IF UCMDVEPT^=UCMFATCN THEN  /* YES, IS THIS THE CANDIDATE?      01514000
*                                                            @G51APSS*/ 01515000
         L     @11,UCMFXPTR(,UCMBASPT)                          02S0512 01516000
         C     UCMDVEPT,UCMFATCN(,@11)                          02S0512 01517000
         BE    @RF00512                                         02S0512 01518000
*         UCBSYSRX='0'B;            /* NO, RESTORE FLAG      @G51APSS*/ 01519000
         L     @03,UCBPTR(,UCMDVEPT)                            02S0513 01520000
         L     @11,UCBSYSRX-3(,@03)                             02S0513 01521000
@GL00029 LR    @04,@11                                          02S0513 01522000
         N     @04,@CF03973                                     02S0513 01523000
         CS    @11,@04,UCBSYSRX-3(@03)                          02S0513 01524000
         BNE   @GL00029                                         02S0513 01525000
*     UCMEFLGB='0'B;                /* MARK THAT UCBSYSR IS NOT 02S0514 01526000
*                                      FORCED ON ANYMORE     @G51APSS*/ 01527000
@RF00512 DS    0H                                               02S0514 01528000
@RF00511 L     @11,UCMFEXTP(,UCMDVEPT)                          02S0514 01529000
         NI    UCMEFLGB(@11),B'10111111'                        02S0514 01530000
*   END;                            /* OF LOOP TO RESTORE ATTN  02S0515 01531000
*                                      INDICES               @G51APSS*/ 01532000
         AL    UCMDVEPT,UCMVEZ(,UCMBASPT)                       02S0515 01533000
@DE00506 C     UCMDVEPT,UCMVEL(,UCMBASPT)                       02S0515 01534000
         BNH   @DL00506                                         02S0515 01535000
*   IF UCMFATCN=ZERO THEN           /* WAS A CANDIDATE CHOSEN?  02S0516 01536000
*                                                            @G51APSS*/ 01537000
         L     @11,UCMFXPTR(,UCMBASPT)                          02S0516 01538000
         ICM   @04,15,UCMFATCN(@11)                             02S0516 01539000
         BNZ   @RF00516                                         02S0516 01540000
*     DO;                           /* NO, USE OLD MASTER    @G51APSS*/ 01541000
*                                                               02S0517 01542000
*       /*************************************************************/ 01543000
*       /*                                                           */ 01544000
*       /* MARK THE OLD MASTER SO IT APPEARS AS IF A VARY CONSOLE    */ 01545000
*       /* COMMAND WAS ISSUED FOR IT                         @G51APSS*/ 01546000
*       /*                                                           */ 01547000
*       /*************************************************************/ 01548000
*                                                               02S0518 01549000
*       UCMDVEPT=MASTERI;           /* GET MASTERS UCME ADDR @G51APSS*/ 01550000
         L     UCMDVEPT,MASTERI                                 02S0518 01551000
*       DO I=1 TO 2 WHILE UCMDVEPT^=ZERO;/*                  @G51APSS*/ 01552000
         LA    @11,1                                            02S0519 01553000
         ST    @11,I                                            02S0519 01554000
@DL00519 LTR   UCMDVEPT,UCMDVEPT                                02S0519 01555000
         BZ    @DC00519                                         02S0519 01556000
*         UCMAF='0'B;               /* ATTN PENDING OFF      @G51APSS*/ 01557000
*         UCMCF='0'B;               /* CLOSE PENDING OFF     @G51APSS*/ 01558000
*         UCMTA='1'B;               /* OPEN PENDING ON       @G51APSS*/ 01559000
         OI    UCMTA(UCMDVEPT),B'00001000'                      02S0522 01560000
         NI    UCMAF(UCMDVEPT),B'01101111'                      02S0522 01561000
*         UCMUF='1'B;               /* DEVICE ACTIVE ON      @G51APSS*/ 01562000
         OI    UCMUF(UCMDVEPT),B'00010000'                      02S0523 01563000
*         UCBDADIX='0'B;            /* CHANGING FROM CONSOLE STATE      01564000
*                                      OFF                   @G51APSS*/ 01565000
*         UCBCHGSX='0'B;            /* CHANGING TO OFFLINE OFF  02S0525 01566000
*                                                            @G51APSS*/ 01567000
         L     @03,UCBPTR(,UCMDVEPT)                            02S0525 01568000
         L     @11,UCBCHGSX-3(,@03)                             02S0525 01569000
@GL00030 LR    @04,@11                                          02S0525 01570000
         N     @04,@CF03977                                     02S0525 01571000
         CS    @11,@04,UCBCHGSX-3(@03)                          02S0525 01572000
         BNE   @GL00030                                         02S0525 01573000
*         UCBVORSX='0'B;            /* OFFLINE BY VARY OFF   @G51APSS*/ 01574000
         L     @03,UCBPTR(,UCMDVEPT)                            02S0526 01575000
         L     @11,UCBVORSX(,@03)                               02S0526 01576000
@GL00031 LR    @04,@11                                          02S0526 01577000
         N     @04,@CF03980                                     02S0526 01578000
         CS    @11,@04,UCBVORSX(@03)                            02S0526 01579000
         BNE   @GL00031                                         02S0526 01580000
*         UCBONLIX='1'B;            /* DEVICE ONLINE         @G51APSS*/ 01581000
*         UCBSYSRX='1'B;            /* DEVICE IS A CONSOLE   @G51APSS*/ 01582000
         L     @03,UCBPTR(,UCMDVEPT)                            02S0528 01583000
         L     @11,UCBONLIX-3(,@03)                             02S0528 01584000
@GL00032 LR    @04,@11                                          02S0528 01585000
         O     @04,@CF03983                                     02S0528 01586000
         CS    @11,@04,UCBONLIX-3(@03)                          02S0528 01587000
         BNE   @GL00032                                         02S0528 01588000
*         UCMDVEPT=MASTERO;         /* MASTERS OUTPUT HALF   @G51APSS*/ 01589000
         L     UCMDVEPT,MASTERO                                 02S0529 01590000
*       END;                        /*                       @G51APSS*/ 01591000
         LA    @11,1                                            02S0530 01592000
         AL    @11,I                                            02S0530 01593000
         ST    @11,I                                            02S0530 01594000
         CH    @11,@CH00063                                     02S0530 01595000
         BNH   @DL00519                                         02S0530 01596000
@DC00519 DS    0H                                               02S0531 01597000
*       NEWI=MASTERI;               /* NEW MASTER IS OLD MASTER 02S0531 01598000
*                                                            @G51APSS*/ 01599000
         L     NEWI,MASTERI                                     02S0531 01600000
*     END;                          /* OF CANDIDATE NOT CHOSEN  02S0532 01601000
*                                                            @G51APSS*/ 01602000
*   ELSE                            /* A CANDIDATE WAS CHOSEN   02S0533 01603000
*                                                            @G51APSS*/ 01604000
*     DO;                           /*                       @G51APSS*/ 01605000
         B     @RC00516                                         02S0533 01606000
@RF00516 DS    0H                                               02S0534 01607000
*       NEWI=UCMFATCN;              /* NEW MASTER IS THE CANDIDATE      01608000
*                                                            @G51APSS*/ 01609000
         L     @11,UCMFXPTR(,UCMBASPT)                          02S0534 01610000
         L     NEWI,UCMFATCN(,@11)                              02S0534 01611000
*       MASTERI->UCMUF='1'B;        /* MAKE OLD MASTER ACTIVE SO IT     01612000
*                                      WILL CLOSE            @G51APSS*/ 01613000
         L     @11,MASTERI                                      02S0535 01614000
         OI    UCMUF(@11),B'00010000'                           02S0535 01615000
*       IF MASTERO^=ZERO THEN       /* MASTER A COMPOSITE?   @G51APSS*/ 01616000
         L     @11,MASTERO                                      02S0536 01617000
         LTR   @11,@11                                          02S0536 01618000
         BZ    @RF00536                                         02S0536 01619000
*         MASTERO->UCMUF='1'B;      /* YES, MAKE THE OUTPUT HALF        01620000
*                                      ACTIVE SO IT WILL CLOSE  02S0537 01621000
*                                                            @G51APSS*/ 01622000
         OI    UCMUF(@11),B'00010000'                           02S0537 01623000
*     END;                          /*                       @G51APSS*/ 01624000
@RF00536 DS    0H                                               02S0539 01625000
*   UCMFATCN=ZERO;                  /* CLEAR CANDIDATE PTR   @G51APSS*/ 01626000
@RC00516 L     @11,UCMFXPTR(,UCMBASPT)                          02S0539 01627000
         SLR   @04,@04                                          02S0539 01628000
         ST    @04,UCMFATCN(,@11)                               02S0539 01629000
*   UCMSYSE='0'B;                   /* NCC DOES NOT EXIST    @G51APSS*/ 01630000
         NI    UCMSYSE(UCMMCSPT),B'11110111'                    02S0540 01631000
*   CALL DEQQ4;                     /* RELEASE Q4            @G51APSS*/ 01632000
         BAL   @14,DEQQ4                                        02S0541 01633000
*   NEWO=NEWI->UCMCOMPC;            /* GET NEW MASTERS OUTPUT HALF      01634000
*                                                            @G51APSS*/ 01635000
         MVC   NEWO(4),UCMCOMPC(NEWI)                           02S0542 01636000
*   FAILI=MASTERI;                  /* MARK MASTER FAILED    @G51APSS*/ 01637000
         L     @11,MASTERI                                      02S0543 01638000
         ST    @11,FAILI                                        02S0543 01639000
*   FAILO=MASTERO;                  /* MARK MASTER FAILED    @G51APSS*/ 01640000
         L     @04,MASTERO                                      02S0544 01641000
         ST    @04,FAILO                                        02S0544 01642000
*   IF NEWI=FAILI THEN              /* IF NEW MASTER THE OLD MASTER?    01643000
*                                                            @G51APSS*/ 01644000
         CR    NEWI,@11                                         02S0545 01645000
         BNE   @RF00545                                         02S0545 01646000
*     DO;                           /* YES                   @G51APSS*/ 01647000
*       IF MASTERO=ZERO THEN        /* MASTER A COMPOSITE?   @G51APSS*/ 01648000
         LTR   @04,@04                                          02S0547 01649000
         BNZ   @RF00547                                         02S0547 01650000
*         DO;                       /* NO                    @G51APSS*/ 01651000
*           FAILO=FAILI;            /* SET UP FOR STATMSG    @G51APSS*/ 01652000
         ST    @11,FAILO                                        02S0549 01653000
*           NEWO=NEWI;              /* SET UP FOR STATMSG    @G51APSS*/ 01654000
         ST    NEWI,NEWO                                        02S0550 01655000
*         END;                      /*                       @G51APSS*/ 01656000
*       CALL STATMSG;               /* BUILD MSG IEE143I     @G51APSS*/ 01657000
@RF00547 BAL   @14,STATMSG                                      02S0552 01658000
*     END;                          /*                       @G51APSS*/ 01659000
*   ELSE                            /* NEW MASTER IS DIFFERENT DEVICE   01660000
*                                      FROM OLD MASTER       @G51APSS*/ 01661000
*     DO;                           /*                       @G51APSS*/ 01662000
         B     @RC00545                                         02S0554 01663000
@RF00545 DS    0H                                               02S0555 01664000
*       UCMSYSD='1'B;               /* INDICATE MASTER IS FAILING       01665000
*                                                            @G51APSS*/ 01666000
         OI    UCMSYSD(UCMMCSPT),B'00010000'                    02S0555 01667000
*       IF NEWI->UCMDISPC='1'B THEN /* IS NEW MASTER A GRAPHICS 02S0556 01668000
*                                      CONSOLE?              @G51APSS*/ 01669000
         TM    UCMDISPC(NEWI),B'00100000'                       02S0556 01670000
         BNO   @RF00556                                         02S0556 01671000
*         CALL SWFULCAP;            /* YES, FORCE FULL I/O   @G51APSS*/ 01672000
         BAL   @14,SWFULCAP                                     02S0557 01673000
*       CALL SWCONS;                /* SWITCH FUNCTIONS AND ISSUE MSG   01674000
*                                      IEE143I               @G51APSS*/ 01675000
@RF00556 BAL   @14,SWCONS                                       02S0558 01676000
*     END;                          /*                       @G51APSS*/ 01677000
*   END EXTINNCC;                   /*                       @G51APSS*/ 01678000
@EL00002 DS    0H                                               02S0560 01679000
@EF00002 DS    0H                                               02S0560 01680000
@ER00002 LM    @14,@02,@SA00002                                 02S0560 01681000
         LM    @04,@12,@SA00002+20                              02S0560 01682000
         BR    @14                                              02S0560 01683000
*/*** END OF EXTINNCC SUBROUTINE *************************************/ 01684000
*                                                               02S0561 01685000
         EJECT                                                          01686000
*                                                               02S0561 01687000
*/*** START OF FINDALT SUBROUTINE ************************************/ 01688000
*/*                                                                  */ 01689000
*/* FINDALT - FINDS AN ALTERNATE FOR A FAILING CONSOLE               */ 01690000
*/*                                                                  */ 01691000
*/* FUNCTION - SEARCHES THE FAILING CONSOLE'S ALTERNATE CHAIN.       */ 01692000
*/*    IF NO ALTERNATE CAN BE FOUND, THE MASTER IS SELECTED          */ 01693000
*/*    PROVIDED THE MASTER IS NOT THE FAILING CONSOLE.               */ 01694000
*/*    THE ALTERNATE SELECTED IS MADE COMPATIBLE WITH THE FAILING    */ 01695000
*/*    CONSOLE.                                                      */ 01696000
*/*                                                                  */ 01697000
*/* INPUT - FAILI = UCME ADDR OF INPUT HALF OF FAILING CONS.         */ 01698000
*/*         FAILO = UCME ADDR OF OUTPUTHALF OF FAILING CONS. OR 0    */ 01699000
*/*         MASTERI = UCME ADDR OF INPUT HALF OF MASTER              */ 01700000
*/*         MASTERO = UCME ADDR OF OUTPUTHALF OF MASTER OR 0         */ 01701000
*/*                                                                  */ 01702000
*/* OUTPUT - NEWI = UCME ADDR OF INPUT HALF OF ALTERNATE OR 0        */ 01703000
*/*                 IF NO ALTERNATE WAS FOUND                        */ 01704000
*/*          NEWO = UCME ADDR OF OUTPUT HALF OF ALTERNATE OR 0       */ 01705000
*/*          UCMDEVCC = 1 IN UCME OF EACH ALTERNATE TESTED           */ 01706000
*/*          UCMSYSD = 1 IF MASTER IS FAILING                        */ 01707000
*/*                                                                  */ 01708000
*/********************************************************************/ 01709000
*                                                               02S0561 01710000
*FINDALT:                                                       02S0561 01711000
*   PROC OPTIONS(SAVE(REG14));                                  02S0561 01712000
FINDALT  ST    @14,@SA00003                                     02S0561 01713000
*   CALL CLEARDVC;                  /* CLEAR UCME DEVICE TESTED BITS */ 01714000
         BAL   @14,CLEARDVC                                     02S0562 01715000
*   ALTFND=NO;                      /* INITIALIZE ALTERNATE FOUND       01716000
*                                      FLAG                          */ 01717000
         NI    ALTFND,B'11111110'                               02S0563 01718000
*   IF FAILI=MASTERI                /* IS FAILING CONSOLE THE MASTER */ 01719000
*     THEN                                                      02S0564 01720000
         CLC   FAILI(4),MASTERI                                 02S0564 01721000
         BNE   @RF00564                                         02S0564 01722000
*     UCMSYSD='1'B;                 /* YES, INDICATE FAILING CONS IS    01723000
*                                      MASTER                        */ 01724000
*                                                               02S0565 01725000
         OI    UCMSYSD(UCMMCSPT),B'00010000'                    02S0565 01726000
*   /*****************************************************************/ 01727000
*   /*                                                               */ 01728000
*   /* SEARCH THE FAILING CONSOLE'S ALTERNATE CHAIN FOR AN ACTIVE    */ 01729000
*   /* CONSOLE WITHOUT A CLOSE PENDING                               */ 01730000
*   /*                                                               */ 01731000
*   /*****************************************************************/ 01732000
*                                                               02S0566 01733000
*   FAILI->UCMDEVCC='1'B;           /* INDICATE FAILING CONSOLE HAS     01734000
*                                      BEEN TESTED                   */ 01735000
@RF00564 L     @11,FAILI                                        02S0566 01736000
         OI    UCMDEVCC(@11),B'00100000'                        02S0566 01737000
*   IF FAILO^=ZERO THEN             /* COMPOSITE ?                   */ 01738000
         L     @11,FAILO                                        02S0567 01739000
         LTR   @11,@11                                          02S0567 01740000
         BZ    @RF00567                                         02S0567 01741000
*     FAILO->UCMDEVCC='1'B;         /* YES, INDICATE OUTPUT HALF OF     01742000
*                                      FAILING CONSOLE HAS ALSO BEEN    01743000
*                                      TESTED                        */ 01744000
         OI    UCMDEVCC(@11),B'00100000'                        02S0568 01745000
*   NEWI=FAILI->UCMALTEN;           /* SELECT FIRST ALTERNATE        */ 01746000
*                                                               02S0569 01747000
@RF00567 L     @11,FAILI                                        02S0569 01748000
         L     NEWI,UCMALTEN(,@11)                              02S0569 01749000
*   /*****************************************************************/ 01750000
*   /*                                                               */ 01751000
*   /* LOOP TO END OF ALTERNATE CHAIN OR UNTIL ALL ALTERNATES HAVE   */ 01752000
*   /* BEEN TESTED                                                   */ 01753000
*   /*                                                               */ 01754000
*   /*****************************************************************/ 01755000
*                                                               02S0570 01756000
*   DO WHILE(NEWI^=0&NEWI->UCMDEVCC='0'B);                      02S0570 01757000
         B     @DE00570                                         02S0570 01758000
@DL00570 DS    0H                                               02S0571 01759000
*     NEWI->UCMDEVCC='1'B;          /* MARK ALTERNATE AS TESTED      */ 01760000
         OI    UCMDEVCC(NEWI),B'00100000'                       02S0571 01761000
*     IF NEWI->UCMUF='0'B|NEWI->UCMVHRSN='1'B THEN/* INACTIVE OR        01762000
*                                      AFFECTD                       */ 01763000
         TM    UCMUF(NEWI),B'00010000'                          02S0572 01764000
         BZ    @RT00572                                         02S0572 01765000
         TM    UCMVHRSN(NEWI),B'00000001'                       02S0572 01766000
         BNO   @RF00572                                         02S0572 01767000
@RT00572 DS    0H                                               02S0573 01768000
*       NEWI=NEWI->UCMALTEN;        /* YES, GET NEXT ALTERNATE       */ 01769000
         L     NEWI,UCMALTEN(,NEWI)                             02S0573 01770000
*     ELSE                          /* NO, CHECK FOR CLOSE PENDING   */ 01771000
*/* IF THE FAILING CONSOLE IS FULL CAPABILITY, MAKE SURE THE NEW        01772000
*   CONSOLE IS ALSO.                                                 */ 01773000
*                                                               02S0574 01774000
*       IF FAILI->UCMDISPD='0'B&    /* FAILING CONSOLE FULL I/0?        01775000
*                                                            @ZA18883*/ 01776000
*           NEWI->UCMDISPD='1'B&    /* NEW CONSOLE HARDWARE OUTPUT      01777000
*                                                            @ZA18883*/ 01778000
*           NEWI->UCMSDS5G='0'B     /* ONLY DEVICE?          @ZA18883*/ 01779000
*         THEN                      /* YES, NEW CONSOLE IS      02S0574 01780000
*                                      UNACCEPTABLE          @ZA18883*/ 01781000
         B     @RC00572                                         02S0574 01782000
@RF00572 L     @11,FAILI                                        02S0574 01783000
         TM    UCMDISPD(@11),B'00010000'                        02S0574 01784000
         BNZ   @RF00574                                         02S0574 01785000
         TM    UCMDISPD(NEWI),B'00010000'                       02S0574 01786000
         BNO   @RF00574                                         02S0574 01787000
         TM    UCMSDS5G(NEWI),B'00000010'                       02S0574 01788000
         BNZ   @RF00574                                         02S0574 01789000
*         NEWI=NEWI->UCMALTEN;      /* GET NEXT DEVICE       @ZA18883*/ 01790000
         L     NEWI,UCMALTEN(,NEWI)                             02S0575 01791000
*       ELSE                                                    02S0576 01792000
*         IF NEWI->UCMCF='1'B THEN  /* CLOSE PENDING?                */ 01793000
         B     @RC00574                                         02S0576 01794000
@RF00574 TM    UCMCF(NEWI),B'00010000'                          02S0576 01795000
         BNO   @RF00576                                         02S0576 01796000
*           IF CSAACR='1'B THEN     /* YES, IS ACR BEING PROCESSED?  */ 01797000
         TM    CSAACR(CXSAPTR),B'00010000'                      02S0577 01798000
         BNO   @RF00577                                         02S0577 01799000
*             DO;                   /* YES, OK TO USE CLOSE PENDING  */ 01800000
*               NEWI->UCMCF='0'B;   /* TURN OFF CLOSE PENDING        */ 01801000
         NI    UCMCF(NEWI),B'11101111'                          02S0579 01802000
*               NEWI->UCMUCB->UCBCHGSX='0'B;/* STOP CHANGE TO OFFLINE*/ 01803000
*               NEWI->UCMUCB->UCBDADIX='0'B;/* STOP CHANGE FROM 02S0581 01804000
*                                      CONSOLE                       */ 01805000
         L     @02,UCMUCB(,NEWI)                                02S0581 01806000
         L     @11,UCBDADIX-3(,@02)                             02S0581 01807000
@GL00036 LR    @04,@11                                          02S0581 01808000
         N     @04,@CF03977                                     02S0581 01809000
         CS    @11,@04,UCBDADIX-3(@02)                          02S0581 01810000
         BNE   @GL00036                                         02S0581 01811000
*               ALTFND=YES;         /* INDICATE ALTERNATE FOUND      */ 01812000
         OI    ALTFND,B'00000001'                               02S0582 01813000
*             END;                                              02S0583 01814000
*           ELSE                                                02S0584 01815000
*             NEWI=NEWI->UCMALTEN;  /* IF NOT ACR, SELECT NEXT ALTERN*/ 01816000
         B     @RC00577                                         02S0584 01817000
@RF00577 L     NEWI,UCMALTEN(,NEWI)                             02S0584 01818000
*         ELSE                                                  02S0585 01819000
*           ALTFND=YES;             /* IF NOT, CLOSE PENDING,   02S0585 01820000
*                                      INDICATE ALTERNATE WAS FOUND. */ 01821000
         B     @RC00576                                         02S0585 01822000
@RF00576 OI    ALTFND,B'00000001'                               02S0585 01823000
*   END;                                                        02S0586 01824000
*                                                               02S0586 01825000
@RC00576 DS    0H                                               02S0586 01826000
@RC00574 DS    0H                                               02S0586 01827000
@RC00572 DS    0H                                               02S0586 01828000
@DE00570 LTR   NEWI,NEWI                                        02S0586 01829000
         BZ    @DC00570                                         02S0586 01830000
         TM    UCMDEVCC(NEWI),B'00100000'                       02S0586 01831000
         BZ    @DL00570                                         02S0586 01832000
@DC00570 DS    0H                                               02S0587 01833000
*   /*****************************************************************/ 01834000
*   /*                                                               */ 01835000
*   /* IF AN ALTERNATE WAS SELECTED FORCE IT TO BE COMPATIBLE WITH   */ 01836000
*   /* THE FAILING CONSOLE                                           */ 01837000
*   /*                                                               */ 01838000
*   /*****************************************************************/ 01839000
*                                                               02S0587 01840000
*   IF ALTFND=YES THEN                                          02S0587 01841000
         TM    ALTFND,B'00000001'                               02S0587 01842000
         BNO   @RF00587                                         02S0587 01843000
*     DO;                                                       02S0588 01844000
*       IF NEWI->UCMDISPC='1'B&NEWI->UCMDISPD='1'B THEN/* IS THE        01845000
*                                      ALTERNATE AN OUTPUT-ONLY CRT  */ 01846000
         TM    UCMDISPC(NEWI),B'00110000'                       02S0589 01847000
         BNO   @RF00589                                         02S0589 01848000
*         IF FAILI->UCMDISPD='0'B THEN/* YES, BUT IS THE FAILING        01849000
*                                      CONSOLE OUTPUT ONLY           */ 01850000
         L     @11,FAILI                                        02S0590 01851000
         TM    UCMDISPD(@11),B'00010000'                        02S0590 01852000
         BNZ   @RF00590                                         02S0590 01853000
*           CALL SWFULCAP;          /* NO, FORCE THE ALTERNATE TO       01854000
*                                      FULL I/O                      */ 01855000
         BAL   @14,SWFULCAP                                     02S0591 01856000
*         ELSE                      /* YES, FAILING IS ALSO OUTPUT      01857000
*                                      ONLY                          */ 01858000
*           IF FAILI->UCMDISPF='1'B THEN/* IS FAILING MESSAGE STREAM    01859000
*                                      ONLY                          */ 01860000
         B     @RC00590                                         02S0592 01861000
@RF00590 L     @11,FAILI                                        02S0592 01862000
         TM    UCMDISPF(@11),B'00000100'                        02S0592 01863000
         BNO   @RF00592                                         02S0592 01864000
*             DO;                   /* YES                           */ 01865000
*               NEWI->UCMDISPF='1'B;/* MAKE ALT MESSAGE STREAM ONLY  */ 01866000
*               NEWI->UCMDISPG='0'B;/* TURN OFF STATUS DISPLAY ONLY  */ 01867000
         OI    UCMDISPF(NEWI),B'00000100'                       02S0595 01868000
         NI    UCMDISPG(NEWI),B'11111101'                       02S0595 01869000
*               NEWI->UCMXB->DCMSTSWT='1'B;/* INDICATE CHANGING 02S0596 01870000
*                                      STATUS IN THE DCM FOR DIDOCS  */ 01871000
         L     @11,UCMXB(,NEWI)                                 02S0596 01872000
         OI    DCMSTSWT(@11),B'10000000'                        02S0596 01873000
*             END;                                              02S0597 01874000
*       NEWO=NEWI->UCMCOMPC;        /* GET OTHER HALF OF NEW CONSOLE,   01875000
*                                      IF ANY                        */ 01876000
@RF00592 DS    0H                                               02S0598 01877000
@RC00590 DS    0H                                               02S0598 01878000
@RF00589 L     @11,UCMCOMPC(,NEWI)                              02S0598 01879000
         ST    @11,NEWO                                         02S0598 01880000
*       IF NEWO^=ZERO THEN          /* IS NEW CONSOLE A COMPOSITE    */ 01881000
         LTR   @11,@11                                          02S0599 01882000
         BZ    @RF00599                                         02S0599 01883000
*         IF NEWI->UCMOF='1'B THEN  /* YES, IS FIRST HALF THE OUTPUT    01884000
*                                      HALF                          */ 01885000
         TM    UCMOF(NEWI),B'10000000'                          02S0600 01886000
         BNO   @RF00600                                         02S0600 01887000
*           DO;                     /* YES, INTERCHANGE INPUT AND       01888000
*                                      OUTPUT PTRS                   */ 01889000
*             NEWI=NEWO;            /* INPUT HALF                    */ 01890000
         LR    NEWI,@11                                         02S0602 01891000
*             NEWO=NEWI->UCMCOMPC;  /* OUTPUT HALF                   */ 01892000
         MVC   NEWO(4),UCMCOMPC(NEWI)                           02S0603 01893000
*           END;                                                02S0604 01894000
*     END;                                                      02S0605 01895000
*   ELSE                            /* ALTERNATE WAS NOT FOUND IN ALT   01896000
*                                      CHAIN                         */ 01897000
*     IF FAILI=MASTERI THEN         /* IS THE MASTER FAILING         */ 01898000
         B     @RC00587                                         02S0606 01899000
@RF00587 CLC   FAILI(4),MASTERI                                 02S0606 01900000
         BNE   @RF00606                                         02S0606 01901000
*       NEWI=0;                     /* YES, INDICATE NO ALTERNATE       01902000
*                                      FOUND                         */ 01903000
         SLR   NEWI,NEWI                                        02S0607 01904000
*     ELSE                          /* NO,                           */ 01905000
*       DO;                         /* MAKE THE MASTER THE ALTERNATE */ 01906000
         B     @RC00606                                         02S0608 01907000
@RF00606 DS    0H                                               02S0609 01908000
*         NEWI=MASTERI;             /* INPUT HALF OF NEW IS INPUT       01909000
*                                      HALF OF MASTER                */ 01910000
         L     NEWI,MASTERI                                     02S0609 01911000
*         NEWO=MASTERO;             /* OUTPUT HALF OF NEW IS OUTPUT     01912000
*                                      HALF OF MASTER                */ 01913000
         MVC   NEWO(4),MASTERO                                  02S0610 01914000
*       END;                                                    02S0611 01915000
*   END FINDALT;                                                02S0612 01916000
*                                                               02S0612 01917000
@EL00003 DS    0H                                               02S0612 01918000
@EF00003 DS    0H                                               02S0612 01919000
@ER00003 L     @14,@SA00003                                     02S0612 01920000
         BR    @14                                              02S0612 01921000
*/*** END OF FINDALT SUBROUTINE **************************************/ 01922000
*                                                               02S0613 01923000
         EJECT                                                          01924000
*                                                               02S0613 01925000
*/*** START OF SWCONS SUBROUTINE *************************************/ 01926000
*/*                                                                  */ 01927000
*/* SWCONS  -  SUBROUTINE TO PERFORM ACTUAL SWITCH OF CONSOLE        */ 01928000
*/*                                                                  */ 01929000
*/* FUNCTION - TRANSFERS FUNCTION OF OLD CONSOLE TO NEW, REQUEUES    */ 01930000
*/*            MESSAGES IF THIS IS REQUIRED (NOT REQUIRED FOR THE    */ 01931000
*/*            VARY CPU OR CHANNEL COMMAND PROCESSING), ISSUES A NEW */ 01932000
*/*            CONSOLE STATUS MESSAGE, AND MARKS THE FAILING CONSOLE */ 01933000
*/*                                                                  */ 01934000
*/* INPUT  -   NEWI CONTAINS THE ADDRESS OF THE NEW CONSOLE OR ZERO  */ 01935000
*/*            IF NO ALTERNATE COULD BE FOUND AND FAILING WAS THE    */ 01936000
*/*            MASTER CONSOLE.                                       */ 01937000
*/*            FAILI CONTAINS THE ADDRESS OF THE FAILING CONSOLE OR  */ 01938000
*/*            THE INPUT HALF OF THE FAILING CONSOLE IF IT IS A      */ 01939000
*/*            COMPOSITE (IN WHICH CASE FAILO CONTAINS THE ADDRESS   */ 01940000
*/*            OF THE OUTPUT HALF.)                                  */ 01941000
*/*                                                                  */ 01942000
*/* OUTPUT  -  NONE                                                  */ 01943000
*/*                                                                  */ 01944000
*/********************************************************************/ 01945000
*                                                               02S0613 01946000
*SWCONS:                                                        02S0613 01947000
*   PROC OPTIONS(SAVE);             /*                       @G51APSS*/ 01948000
SWCONS   STM   @14,@02,@SA00004                                 02S0613 01949000
         STM   @04,@12,@SA00004+20                              02S0613 01950000
*   IF NEWI=ZERO THEN               /* WAS AN ALTERNATE FOUND?       */ 01951000
         LTR   NEWI,NEWI                                        02S0614 01952000
         BNZ   @RF00614                                         02S0614 01953000
*     CALL NOALTM;                  /* NO, MASTER MUST BE FAILING,      01954000
*                                      PROCESS A                02S0615 01955000
*                                      NO-ALTERNATE-FOR-THE-MASTER      01956000
*                                      CONDITION                     */ 01957000
         BAL   @14,NOALTM                                       02S0615 01958000
*   ELSE                                                        02S0616 01959000
*     DO;                           /* AN ALTERNATE WAS FOUND        */ 01960000
*                                                               02S0616 01961000
         B     @RC00614                                         02S0616 01962000
@RF00614 DS    0H                                               02S0617 01963000
*       /*************************************************************/ 01964000
*       /*                                                           */ 01965000
*       /* TRANSFER THE FAILING CONSOLE'S FUNCTIONS TO THE NEW       */ 01966000
*       /* CONSOLE                                                   */ 01967000
*       /*                                                           */ 01968000
*       /*************************************************************/ 01969000
*                                                               02S0617 01970000
*       CALL SETOSW;                                            02S0617 01971000
         BAL   @14,SETOSW                                       02S0617 01972000
*       IF FAILO->UCMDISPB='1'B THEN/* IS OLD CONSOLE HARDCOPY       */ 01973000
         L     @11,FAILO                                        02S0618 01974000
         TM    UCMDISPB(@11),B'01000000'                        02S0618 01975000
         BNO   @RF00618                                         02S0618 01976000
*         IF NEWO->UCMDISPC='1'B THEN/* YES, IS NEW CONSOLE GRAPHICS */ 01977000
         L     @11,NEWO                                         02S0619 01978000
         TM    UCMDISPC(@11),B'00100000'                        02S0619 01979000
         BNO   @RF00619                                         02S0619 01980000
*           CALL HCSWITCH;          /* YES, SWITCH HARDCOPY TO  02S0620 01981000
*                                      ANOTHER CONSOLE IF POSSIBLE   */ 01982000
         BAL   @14,HCSWITCH                                     02S0620 01983000
*         ELSE                                                  02S0621 01984000
*           DO;                     /* NO, NEW CONSOLE IS SUITABLE      01985000
*                                      FOR HARDCOPY                  */ 01986000
*                                                               02S0621 01987000
         B     @RC00619                                         02S0621 01988000
@RF00619 DS    0H                                               02S0622 01989000
*             /*******************************************************/ 01990000
*             /*                                                     */ 01991000
*             /* TRANSFER HARDCOPY FUNCTION FROM OLD TO NEW CONSOLE  */ 01992000
*             /*                                                     */ 01993000
*             /*******************************************************/ 01994000
*                                                               02S0622 01995000
*             FAILO->UCMDISPB='0'B; /* TURN OFF HC FLAG IN OLD  02S0622 01996000
*                                      CONSOLE                       */ 01997000
         L     @11,FAILO                                        02S0622 01998000
         NI    UCMDISPB(@11),B'10111111'                        02S0622 01999000
*             NEWO->UCMDISPB='1'B;  /* TURN ON HC FLAG IN NEW CONSOLE*/ 02000000
         L     @11,NEWO                                         02S0623 02001000
         OI    UCMDISPB(@11),B'01000000'                        02S0623 02002000
*             UCMHCUCM=NEWO;        /* STORE NEW HARDCOPY UCME ADDR  */ 02003000
         ST    @11,UCMHCUCM(,UCMMCSPT)                          02S0624 02004000
*           END;                                                02S0625 02005000
*                                                               02S0625 02006000
*       /*************************************************************/ 02007000
*       /*                                                           */ 02008000
*       /* WRITE A MESSAGE TO THE NEW CONSOLE INFORMING IT IF ITS NEW*/ 02009000
*       /* STATUS                                                    */ 02010000
*       /*                                                           */ 02011000
*       /*************************************************************/ 02012000
*                                                               02S0626 02013000
*       CALL STATMSG;                                           02S0626 02014000
@RC00619 DS    0H                                               02S0626 02015000
@RF00618 BAL   @14,STATMSG                                      02S0626 02016000
*       IF CSAVCPU='0'B&CSAVCHAN='0'B/* TEST FOR VARY COMMAND        */ 02017000
*         THEN                                                  02S0627 02018000
         TM    CSAVCPU(CXSAPTR),B'01100000'                     02S0627 02019000
         BNZ   @RF00627                                         02S0627 02020000
*         DO;                       /* NOT A VARY COMMAND REQUEST    */ 02021000
*                                                               02S0628 02022000
*           /*********************************************************/ 02023000
*           /*                                                       */ 02024000
*           /* QUEUE ANY UNANSWERED WTORS SENT TO THE FAILING CONSOLE*/ 02025000
*           /* TO THE OUTPUT QUEUE OF THE NEW CONSOLE                */ 02026000
*           /*                                                       */ 02027000
*           /*********************************************************/ 02028000
*                                                               02S0629 02029000
*                                                               03S0629 02030000
*/**  START OF OREREQU SEGMENT ***************************************/ 02031000
*/*                                                                  */ 02032000
*/* OREREQU - QUEUES WQES FOR UNANSWERED WTORS SENT TO THE FAILING   */ 02033000
*/*    CONSOLES TO THE NEW CONSOLE.                                  */ 02034000
*/*                                                                  */ 02035000
*/* FUNCTION - SEARCHES THE ORE QUEUE AND DETERMINES IF THE          */ 02036000
*/*    FAILING CONSOLE RECEIVED THE WTOR MSG.  IF SO, CREATES        */ 02037000
*/*    CQE ENTRY ON THE NEW CONSOLE'S OUTPUT QUEUE FOR THE WTOR.     */ 02038000
*/*                                                                  */ 02039000
*/* INPUT - FAILO - UCME ADDR OF OUTPUT HALF OF FAILING CONSOLE      */ 02040000
*/*         FAILI - UCME ADDR OF INPUT  HALF OF FAILING CONSOLE      */ 02041000
*/* OUTPUT - WQEUCMID - CHANGED TO ID OF NEW CONSOLE WHEN MSG        */ 02042000
*/*                     WAS QUEUED BY ID                             */ 02043000
*/*         WQEUSE - INCREMENTED WHEN MSG IS QUEUED TO NEW CONSOLE   */ 02044000
*/********************************************************************/ 02045000
*                                                               03S0629 02046000
*           GETCQEFL=NO;            /* INIT GETCQE FAILURE FLAG      */ 02047000
         NI    GETCQEFL,B'11011111'                             03S0629 02048000
*           OREPTR=UCMRPYQ;         /* GET PTR TO FIRST ORE ON THE      02049000
*                                      QUEUE                         */ 02050000
         L     OREPTR,UCMRPYQ(,UCMBASPT)                        03S0630 02051000
*           J=ONE;                  /* INITIALIZE CQE COUNTER        */ 02052000
*                                                               03S0631 02053000
         MVC   J(4),@CF00055                                    03S0631 02054000
*           /*********************************************************/ 02055000
*           /*                                                       */ 02056000
*           /* LOOP THROUGH THE ORES. FOR EACH ORE QUEUED TO THE     */ 02057000
*           /* FAILING CONSOLE, CREATE A CQE ENTRY ON THE OUTPUT HALF*/ 02058000
*           /* OF THE NEW CONSOLE.                                   */ 02059000
*           /*                                                       */ 02060000
*           /*********************************************************/ 02061000
*                                                               03S0632 02062000
*           DO WHILE(OREPTR^=ZERO); /* SEARCH UNTIL END OF QUEUE     */ 02063000
         B     @DE00632                                         03S0632 02064000
@DL00632 DS    0H                                               03S0633 02065000
*             IF OREBUFC='0'B&OREWQE->WQEBUFE='1'B THEN/* IS ORE NOT    02066000
*                                      LOGICALLY DELETED AND HAS        02067000
*                                      CORRESPONDING WQE BEEN   03S0633 02068000
*                                      SERVICED                      */ 02069000
         TM    OREBUFC(OREPTR),B'00100000'                      03S0633 02070000
         BNZ   @RF00633                                         03S0633 02071000
         L     @04,OREWQE(,OREPTR)                              03S0633 02072000
         TM    WQEBUFE(@04),B'00001000'                         03S0633 02073000
         BNO   @RF00633                                         03S0633 02074000
*               DO;                 /* YES                           */ 02075000
*                 SW1='0'B;         /* INITIALIZE QUEUE ORE SWITCH   */ 02076000
         NI    SW1,B'01111111'                                  03S0635 02077000
*                 CONTROL=FAILI;    /* DO TEST FOR INPUT HALF FIRST  */ 02078000
         MVC   CONTROL(4),FAILI                                 03S0636 02079000
*                 WQEPTR=OREWQE;    /* SET PTR TO WQE                */ 02080000
*                                                               03S0637 02081000
         LR    WQEPTR,@04                                       03S0637 02082000
*                 /***************************************************/ 02083000
*                 /*                                                 */ 02084000
*                 /* TEST IF WTOR WOULD HAVE BEEN QUEUED TO THE INPUT*/ 02085000
*                 /* OR OUTPUT HALF OF THE FAILING CONSOLE           */ 02086000
*                 /*                                                 */ 02087000
*                 /***************************************************/ 02088000
*                                                               03S0638 02089000
*                 DO I=2 TO 1 BY-1 WHILE(SW1='0'B);             03S0638 02090000
         LA    @04,2                                            03S0638 02091000
         ST    @04,I                                            03S0638 02092000
@DL00638 TM    SW1,B'10000000'                                  03S0638 02093000
         BNZ   @DC00638                                         03S0638 02094000
*                   IF WQEMCSG='1'B&UCMSYSD='1'B THEN/* WTOR TO HC      02095000
*                                      ONLY AND MASTER IS FAILING    */ 02096000
         TM    WQEMCSG(WQEPTR),B'00000010'                      03S0639 02097000
         BNO   @RF00639                                         03S0639 02098000
         TM    UCMSYSD(UCMMCSPT),B'00010000'                    03S0639 02099000
         BNO   @RF00639                                         03S0639 02100000
*                     SW1='1'B;     /* YES, QUEUE WTOR TO NEW CONSOLE*/ 02101000
         OI    SW1,B'10000000'                                  03S0640 02102000
*                   ELSE                                        03S0641 02103000
*                     IF WQEMCSH='1'B&(CONTROL->UCMID=WQEUCMID) THEN    02104000
         B     @RC00639                                         03S0641 02105000
@RF00639 TM    WQEMCSH(WQEPTR),B'00000001'                      03S0641 02106000
         BNO   @RF00641                                         03S0641 02107000
         L     @04,CONTROL                                      03S0641 02108000
         CLC   UCMID(1,@04),WQEUCMID(WQEPTR)                    03S0641 02109000
         BNE   @RF00641                                         03S0641 02110000
*                                   /* QREG0 AND THE FAILING    03S0642 02111000
*                                      CONSOLE'S ID MATCHES THE WQE     02112000
*                                      ID                            */ 02113000
*                       DO;         /* YES                           */ 02114000
*                         WQEUCMID=NEWO->UCMID;/* CHANGE WQE ID TO      02115000
*                                      CONSOLE ID OF NEW CONSOLE     */ 02116000
         L     @04,NEWO                                         03S0643 02117000
         MVC   WQEUCMID(1,WQEPTR),UCMID(@04)                    03S0643 02118000
*                         SW1='1'B; /* QUEUE WTOR TO NEW CONSOLE     */ 02119000
         OI    SW1,B'10000000'                                  03S0644 02120000
*                       END;                                    03S0645 02121000
*                     ELSE                                      03S0646 02122000
*                       IF WQEMCSD='0'B THEN/* QUEUED BY MSGTYPE     */ 02123000
         B     @RC00641                                         03S0646 02124000
@RF00641 TM    WQEMCSD(WQEPTR),B'00010000'                      03S0646 02125000
         BNZ   @RF00646                                         03S0646 02126000
*                         IF(WQEROUT&CONTROL->UCMRTCD)^=0 THEN/* NO,    02127000
*                                      DO ROUTE CODES MATCH          */ 02128000
         L     @04,CONTROL                                      03S0647 02129000
         SLR   @15,@15                                          03S0647 02130000
         ICM   @15,3,UCMRTCD(@04)                               03S0647 02131000
         SLR   @04,@04                                          03S0647 02132000
         ICM   @04,3,WQEROUT(WQEPTR)                            03S0647 02133000
         NR    @15,@04                                          03S0647 02134000
         LTR   @15,@15                                          03S0647 02135000
         BZ    @RF00647                                         03S0647 02136000
*                           SW1='1'B;/* YES, QUEUE WTOR TO NEW  03S0648 02137000
*                                      CONSOLE                       */ 02138000
         OI    SW1,B'10000000'                                  03S0648 02139000
*                         ELSE                                  03S0649 02140000
*                           IF WQEMCSB='1'B&CONTROL->UCMID=WQEUCMID     02141000
*                             THEN  /* REG0 AND THE FAILING CONSOLE'S   02142000
*                                      ID MATCHES THE WQE ID         */ 02143000
         B     @RC00647                                         03S0649 02144000
@RF00647 TM    WQEMCSB(WQEPTR),B'01000000'                      03S0649 02145000
         BNO   @RF00649                                         03S0649 02146000
         L     @04,CONTROL                                      03S0649 02147000
         CLC   UCMID(1,@04),WQEUCMID(WQEPTR)                    03S0649 02148000
         BNE   @RF00649                                         03S0649 02149000
*                             DO;   /* YES                           */ 02150000
*                               WQEUCMID=NEWO->UCMID;/* CHANG WQE ID    02151000
*                                      TO CONSOLE ID OF NEW CONSOLE  */ 02152000
         L     @04,NEWO                                         03S0651 02153000
         MVC   WQEUCMID(1,WQEPTR),UCMID(@04)                    03S0651 02154000
*                               SW1='1'B;/* QUEUE WTOR TO NEW CONSOLE*/ 02155000
         OI    SW1,B'10000000'                                  03S0652 02156000
*                             END;                              03S0653 02157000
*                           ELSE                                03S0654 02158000
*                             ;                                 03S0654 02159000
@RF00649 DS    0H                                               03S0655 02160000
*                       ELSE                                    03S0655 02161000
*                         IF(WQEMSGTP&CONTROL->UCMMSG)^=0 THEN/* DOES   02162000
*                                      MSG TYPE MATCH FAILING CONSOLE*/ 02163000
         B     @RC00646                                         03S0655 02164000
@RF00646 L     @04,CONTROL                                      03S0655 02165000
         SLR   @15,@15                                          03S0655 02166000
         ICM   @15,3,UCMMSG(@04)                                03S0655 02167000
         SLR   @04,@04                                          03S0655 02168000
         ICM   @04,3,WQEMSGTP(WQEPTR)                           03S0655 02169000
         NR    @15,@04                                          03S0655 02170000
         LTR   @15,@15                                          03S0655 02171000
         BZ    @RF00655                                         03S0655 02172000
*                           SW1='1'B;/* YES, QUEUE WTOR TO NEW  03S0656 02173000
*                                      CONSOLE                       */ 02174000
         OI    SW1,B'10000000'                                  03S0656 02175000
*                   CONTROL=FAILO;  /* REPEAT TESTS FOR OUTPUT HALF     02176000
*                                      OF FAILING CONSOLE            */ 02177000
@RF00655 DS    0H                                               03S0657 02178000
@RC00646 DS    0H                                               03S0657 02179000
@RC00641 DS    0H                                               03S0657 02180000
@RC00639 MVC   CONTROL(4),FAILO                                 03S0657 02181000
*                 END;                                          03S0658 02182000
*                                                               03S0658 02183000
         SLR   @04,@04                                          03S0658 02184000
         BCTR  @04,0                                            03S0658 02185000
         AL    @04,I                                            03S0658 02186000
         ST    @04,I                                            03S0658 02187000
         LTR   @04,@04                                          03S0658 02188000
         BP    @DL00638                                         03S0658 02189000
@DC00638 DS    0H                                               03S0659 02190000
*                 /***************************************************/ 02191000
*                 /*                                                 */ 02192000
*                 /* IF THE WTOR WAS QUEUED TO THE FAILING CONSOLE,  */ 02193000
*                 /* BUILD A CQE ENTRY FOR THE WTOR ON THE OUTPUT    */ 02194000
*                 /* QUEUE OF THE NEW CONSOLE AND INCREMENT THE WQE  */ 02195000
*                 /* USE COUNT. THE NEW CONSOLE WILL THEN RECEIVE THE*/ 02196000
*                 /* WTOR MESSAGE.                                   */ 02197000
*                 /*                                                 */ 02198000
*                 /***************************************************/ 02199000
*                                                               03S0659 02200000
*                 IF SW1='1'B THEN  /* SHOULD THE WQE BE QUEUED      */ 02201000
         TM    SW1,B'10000000'                                  03S0659 02202000
         BNO   @RF00659                                         03S0659 02203000
*                   DO;             /* YES                           */ 02204000
*                     IF J=1 THEN   /* IS A NEW CQE BLOCK REQUIRED   */ 02205000
         CLC   J(4),@CF00055                                    03S0661 02206000
         BNE   @RF00661                                         03S0661 02207000
*                       DO;         /* YES                           */ 02208000
*                         OUTQ=NEWO;/* PLACE NEW BLOCK ON NEW   03S0663 02209000
*                                      CONSOLE'S Q                   */ 02210000
         MVC   OUTQ(4),NEWO                                     03S0663 02211000
*                         CALL GETCQE;/* GET AND CHAIN A NEW CQE     */ 02212000
         BAL   @14,GETCQE                                       03S0664 02213000
*                       END;                                    03S0665 02214000
*                     IF GETCQEFL=NO THEN/* IF GETCQE DID NOT FAIL   */ 02215000
@RF00661 TM    GETCQEFL,B'00100000'                             03S0666 02216000
         BNZ   @RF00666                                         03S0666 02217000
*                       DO;                                     03S0667 02218000
*                         CQEWQEA=WQEPTR;/* PTR TO WTOR              */ 02219000
         L     @04,CQEPTR                                       03S0668 02220000
         STCM  WQEPTR,7,CQEWQEA(@04)                            03S0668 02221000
*                         CQEENTR='1'B;/* INDICATE ENTRY EXISTS      */ 02222000
         OI    CQEENTR(@04),B'00000001'                         03S0669 02223000
*                         J=J+ONE;  /* INCREMENT CQE COUNTER         */ 02224000
         LA    @15,1                                            03S0670 02225000
         L     @14,J                                            03S0670 02226000
         ALR   @14,@15                                          03S0670 02227000
         ST    @14,J                                            03S0670 02228000
*                         CQEPTR=CQEPTR+FOUR;/* INCREMENT PTR TO NEXT   02229000
*                                      ENTRY                         */ 02230000
         LA    @01,4                                            03S0671 02231000
         ALR   @04,@01                                          03S0671 02232000
         ST    @04,CQEPTR                                       03S0671 02233000
*                         WQEUSE=WQEUSE+ONE;/* INCREMENT WTOR USE       02234000
*                                      COUNT                         */ 02235000
         SLR   @00,@00                                          03S0672 02236000
         IC    @00,WQEUSE(,WQEPTR)                              03S0672 02237000
         ALR   @00,@15                                          03S0672 02238000
         STC   @00,WQEUSE(,WQEPTR)                              03S0672 02239000
*                         IF J=SIX THEN/* IF NEXT ENTRY IS THE 6TH      02240000
*                                      ENTRY, SET UP TO GET A NEW CQE   02241000
*                                      BLOCK                         */ 02242000
         CH    @14,@CH00033                                     03S0673 02243000
         BNE   @RF00673                                         03S0673 02244000
*                           DO;                                 03S0674 02245000
*                             EVAL(CQEPTR-FOUR)->CQEEOQ='1'B;/* SET     02246000
*                                      END-OF-QUEUE IN 5TH CQE ENTRY */ 02247000
         SLR   @04,@01                                          03S0675 02248000
         OI    CQEEOQ(@04),B'10000000'                          03S0675 02249000
*                             J=ONE;/* A NEW BLOCK IS NEEDED         */ 02250000
         ST    @15,J                                            03S0676 02251000
*                           END;                                03S0677 02252000
*                       END;                                    03S0678 02253000
@RF00673 DS    0H                                               03S0679 02254000
*                   END;                                        03S0679 02255000
@RF00666 DS    0H                                               03S0680 02256000
*               END;                                            03S0680 02257000
@RF00659 DS    0H                                               03S0681 02258000
*             IF GETCQEFL=NO THEN   /* IF GETCQE DID NOT FAIL        */ 02259000
@RF00633 TM    GETCQEFL,B'00100000'                             03S0681 02260000
         BNZ   @RF00681                                         03S0681 02261000
*               OREPTR=ORELKP;      /* GET PTR TO NEXT ORE           */ 02262000
         L     OREPTR,ORELKP(,OREPTR)                           03S0682 02263000
*             ELSE                                              03S0683 02264000
*               OREPTR=ZERO;        /* ELSE IF GETCQE DID FAIL       */ 02265000
         B     @RC00681                                         03S0683 02266000
@RF00681 SLR   OREPTR,OREPTR                                    03S0683 02267000
*           END;                                                03S0684 02268000
*                                                               03S0684 02269000
@RC00681 DS    0H                                               03S0684 02270000
@DE00632 LTR   OREPTR,OREPTR                                    03S0684 02271000
         BNZ   @DL00632                                         03S0684 02272000
*           /*********************************************************/ 02273000
*           /*                                                       */ 02274000
*           /* INDICATE END OF QUEUE IN ANY UNFINISHED CQE BLOCK     */ 02275000
*           /*                                                       */ 02276000
*           /*********************************************************/ 02277000
*                                                               03S0685 02278000
*           IF J^=ONE THEN                                      03S0685 02279000
         CLC   J(4),@CF00055                                    03S0685 02280000
         BE    @RF00685                                         03S0685 02281000
*             EVAL(CQEPTR-FOUR)->CQEEOQ='1'B;/* SET END-OF-QUEUE IN     02282000
*                                      LAST ENTRY USED               */ 02283000
         L     @11,CQEPTR                                       03S0686 02284000
         SL    @11,@CF00065                                     03S0686 02285000
         OI    CQEEOQ(@11),B'10000000'                          03S0686 02286000
*/*** END OF OREREQU SEGMENT *****************************************/ 02287000
*                                                               03S0687 02288000
*                                                               02S0687 02289000
*           /*********************************************************/ 02290000
*           /*                                                       */ 02291000
*           /* TRANSFER THE OUTPUT QUEUE OF THE FAILING CONSOLE TO   */ 02292000
*           /* THE OUTPUT QUEUE OF THE NEW CONSOLE                   */ 02293000
*           /*                                                       */ 02294000
*           /*********************************************************/ 02295000
*                                                               02S0687 02296000
*                                                               03S0687 02297000
*/**** START OF WQEREQU SEGMENT **************************************/ 02298000
*/* WQEREQU - TRANSFERS THE OUTPUT QUEUE OF THE FAILING CONSOLE TO   */ 02299000
*/*          THE NEW CONSOLE.                                        */ 02300000
*/* FUNCTION - SCANS THE FAILING CONSOLE'S OUTPUT QUEUE FOR VALID    */ 02301000
*/*    CQE ENTRIES.  ENTRIES FOR MLWTOS ARE PASSED TO THE ML1        */ 02302000
*/*    SUBROUTINE TO DETERMINE IF THEY CAN BE REQUEUED TO THE NEW    */ 02303000
*/*    CONSOLE.  WTOS QUEUED BY ID TO THE FAILING CONSOLE HAVE THE   */ 02304000
*/*    WQEUCMID CHANGE TO THAT OF THE NEW CONSOLE.  THEN THE ENTIRE  */ 02305000
*/*    OUTPUT QUEUE OF THE FAILING CONSOLE IS CHAINED TO THE NEW     */ 02306000
*/*    CONSOLE'S OUTPUT QUEUE.                                       */ 02307000
*/*  INPUT - FAILO - UCME ADDR OF OUTPUT HALF OF FAILING CONSOLE.    */ 02308000
*/*        NEWO - UCME ADDR OF OUTPUT HALF OF NEW CONSOLE.           */ 02309000
*/* OUTPUT - NONE                                                    */ 02310000
*/*                                                                  */ 02311000
*/********************************************************************/ 02312000
*                                                               03S0687 02313000
*           /*********************************************************/ 02314000
*           /*                                                       */ 02315000
*           /* SEARCH THROUGH THE OUTPUT QUEUE OF THE FAILING CONSOLE*/ 02316000
*           /*                                                       */ 02317000
*           /*********************************************************/ 02318000
*                                                               03S0687 02319000
*           IF FAILO->UCMOUTQ^=0 THEN/* IS THERE AN OUTPUT QUEUE     */ 02320000
@RF00685 L     @11,FAILO                                        03S0687 02321000
         L     @11,UCMOUTQ(,@11)                                03S0687 02322000
         LTR   @11,@11                                          03S0687 02323000
         BZ    @RF00687                                         03S0687 02324000
*             DO;                   /* YES                           */ 02325000
*               CQEPTR=FAILO->UCMOUTQ;/* INITIALIZE PTR TO 1ST CQE      02326000
*                                      BLOCK                         */ 02327000
         ST    @11,CQEPTR                                       03S0689 02328000
*               SW1='0'B;           /* INITIALIZE END-OF-Q SWITCH    */ 02329000
         NI    SW1,B'01111111'                                  03S0690 02330000
*               DO WHILE(SW1='0'B); /* SEARCH STOPS WHEN END-OF-Q IS    02331000
*                                      FOUND                         */ 02332000
         B     @DE00691                                         03S0691 02333000
@DL00691 DS    0H                                               03S0692 02334000
*                 IF CQEENTR='1'B&CQEMAJOR='1'B THEN/* VALID MLWTO      02335000
*                                      ENTRY?                        */ 02336000
         L     @11,CQEPTR                                       03S0692 02337000
         TM    CQEENTR(@11),B'00000101'                         03S0692 02338000
         BNO   @RF00692                                         03S0692 02339000
*                   DO;             /* YES                           */ 02340000
*                     UCMDVEPT=FAILO;/* DETERMINE IF MLWTO SHOULD BE */ 02341000
         L     UCMDVEPT,FAILO                                   03S0694 02342000
*                     CALL ML1;     /* TRANSFERRED TO NEW CONSOLE. IF   02343000
*                                      NOT,                          */ 02344000
         BAL   @14,ML1                                          03S0695 02345000
*                   END;            /* ML1 TURNS OFF CQEENTR         */ 02346000
*                 IF CQEENTR='1'B THEN/* IS CQE ENTRY VALID          */ 02347000
@RF00692 L     @11,CQEPTR                                       03S0697 02348000
         TM    CQEENTR(@11),B'00000001'                         03S0697 02349000
         BNO   @RF00697                                         03S0697 02350000
*                   DO;             /* YES                           */ 02351000
*                     WQEPTR=CQEWQEA;/* GET PTR TO WQE               */ 02352000
         SLR   WQEPTR,WQEPTR                                    03S0699 02353000
         ICM   WQEPTR,7,CQEWQEA(@11)                            03S0699 02354000
*                     IF WQEMCSB='1'B|WQEMCSH='1'B THEN/* QUEUED BY     02355000
*                                      ID?                           */ 02356000
         TM    WQEMCSB(WQEPTR),B'01000001'                      03S0700 02357000
         BZ    @RF00700                                         03S0700 02358000
*                       DO;                                     03S0701 02359000
*                         IF WQEUCMID=FAILI->UCMID THEN/* DOES ID       02360000
*                                      MATCH ID OF INPUT HALF OF OLD */ 02361000
         L     @11,FAILI                                        03S0702 02362000
         CLC   WQEUCMID(1,WQEPTR),UCMID(@11)                    03S0702 02363000
         BNE   @RF00702                                         03S0702 02364000
*                           WQEUCMID=NEWI->UCMID;/* YES, CHANGE ID TO   02365000
*                                      ID OF INPUT HALF OF NEW       */ 02366000
         MVC   WQEUCMID(1,WQEPTR),UCMID(NEWI)                   03S0703 02367000
*                         IF WQEUCMID=FAILO->UCMID THEN/* DOES ID       02368000
*                                      MATCH ID OF OUTPUT HALF OF OLD*/ 02369000
@RF00702 L     @11,FAILO                                        03S0704 02370000
         CLC   WQEUCMID(1,WQEPTR),UCMID(@11)                    03S0704 02371000
         BNE   @RF00704                                         03S0704 02372000
*                           WQEUCMID=NEWO->UCMID;/* YES, CHANGE ID TO   02373000
*                                      ID OF OUTPUT HALF OF NEW      */ 02374000
         L     @11,NEWO                                         03S0705 02375000
         MVC   WQEUCMID(1,WQEPTR),UCMID(@11)                    03S0705 02376000
*                       END;                                    03S0706 02377000
@RF00704 DS    0H                                               03S0707 02378000
*                   END;                                        03S0707 02379000
@RF00700 DS    0H                                               03S0708 02380000
*                 IF CQEEOQ='0'B THEN                           03S0708 02381000
@RF00697 L     @11,CQEPTR                                       03S0708 02382000
         TM    CQEEOQ(@11),B'10000000'                          03S0708 02383000
         BNZ   @RF00708                                         03S0708 02384000
*                   DO;             /* END-OF-Q ? NO -               */ 02385000
*                     CQEPTR=CQEPTR+LENGTH(CQEWQE);/* GET NEXT CQE   */ 02386000
         AL    @11,@CF00065                                     03S0710 02387000
         ST    @11,CQEPTR                                       03S0710 02388000
*                     IF CQEEOB=ONTWO THEN/* END-OF-BLOCK?           */ 02389000
         TM    CQEEOB(@11),B'11000000'                          03S0711 02390000
         BNO   @RF00711                                         03S0711 02391000
*                       CQEPTR=CQEWQEA;/* GET PTR TO NEXT BLOCK      */ 02392000
         SLR   @04,@04                                          03S0712 02393000
         ICM   @04,7,CQEWQEA(@11)                               03S0712 02394000
         ST    @04,CQEPTR                                       03S0712 02395000
*                   END;                                        03S0713 02396000
*                 ELSE                                          03S0714 02397000
*                   SW1='1'B;       /* INDICATE END-OF-Q FOUND       */ 02398000
         B     @RC00708                                         03S0714 02399000
@RF00708 OI    SW1,B'10000000'                                  03S0714 02400000
*               END;                /* END OF DO WHILE CQE LOOP      */ 02401000
@RC00708 DS    0H                                               03S0715 02402000
@DE00691 TM    SW1,B'10000000'                                  03S0715 02403000
         BZ    @DL00691                                         03S0715 02404000
*               IF NEWO->UCMOUTQ=ZERO THEN/* DOES NEW HAVE AN OUTPUT    02405000
*                                      QUEUE                         */ 02406000
         L     @11,NEWO                                         03S0716 02407000
         ICM   @04,15,UCMOUTQ(@11)                              03S0716 02408000
         BNZ   @RF00716                                         03S0716 02409000
*                 NEWO->UCMOUTQ=FAILO->UCMOUTQ;/* NO, ADD FAILING'S     02410000
*                                      OUTPUT Q TO NEW               */ 02411000
         L     @04,FAILO                                        03S0717 02412000
         MVC   UCMOUTQ(4,@11),UCMOUTQ(@04)                      03S0717 02413000
*               ELSE                                            03S0718 02414000
*                 DO;               /* NEW HAS AN OUTPUT Q           */ 02415000
         B     @RC00716                                         03S0718 02416000
@RF00716 DS    0H                                               03S0719 02417000
*                   CQEBLK=NEWO->UCMOUTQ;/* INIT PTR TO 1ST CQE BLOCK*/ 02418000
         L     @11,NEWO                                         03S0719 02419000
         L     @11,UCMOUTQ(,@11)                                03S0719 02420000
         ST    @11,CQEBLK                                       03S0719 02421000
*                   CQEPTR=CQEBLK;  /* INIT PTR TO 1ST CQE ENTRY     */ 02422000
         ST    @11,CQEPTR                                       03S0720 02423000
*                   SW1='0'B;       /* INIT END-OF-Q SWITCH          */ 02424000
*                                                               03S0721 02425000
         NI    SW1,B'01111111'                                  03S0721 02426000
*                   /*************************************************/ 02427000
*                   /*                                               */ 02428000
*                   /* FIND END OF NEW CONSOLE'S OUTPUT QUEUE        */ 02429000
*                   /*                                               */ 02430000
*                   /*************************************************/ 02431000
*                                                               03S0722 02432000
*                   DO WHILE(SW1='0'B);                         03S0722 02433000
         B     @DE00722                                         03S0722 02434000
@DL00722 DS    0H                                               03S0723 02435000
*                     IF CQEEOQ='0'B THEN/* END-OF-Q                 */ 02436000
         L     @11,CQEPTR                                       03S0723 02437000
         TM    CQEEOQ(@11),B'10000000'                          03S0723 02438000
         BNZ   @RF00723                                         03S0723 02439000
*                       DO;         /* NO                            */ 02440000
*                         CQEPTR=CQEPTR+LENGTH(CQEWQE);/* GET NEXT      02441000
*                                      CQE ENTRY                     */ 02442000
         AL    @11,@CF00065                                     03S0725 02443000
         ST    @11,CQEPTR                                       03S0725 02444000
*                         IF CQEEOB=ONTWO THEN/* END-OF-BLOCK ?      */ 02445000
         TM    CQEEOB(@11),B'11000000'                          03S0726 02446000
         BNO   @RF00726                                         03S0726 02447000
*                           DO;     /* YES                           */ 02448000
*                             CQEBLK=CQEWQEA;/* GET PTR TO NEXT CQE     02449000
*                                      BLOCK                         */ 02450000
         SLR   @04,@04                                          03S0728 02451000
         ICM   @04,7,CQEWQEA(@11)                               03S0728 02452000
         ST    @04,CQEBLK                                       03S0728 02453000
*                             CQEPTR=CQEBLK;/* GET PTR TO NEXT CQE      02454000
*                                      ENTRY                         */ 02455000
         ST    @04,CQEPTR                                       03S0729 02456000
*                           END;                                03S0730 02457000
*                       END;                                    03S0731 02458000
*                     ELSE                                      03S0732 02459000
*                       SW1='1'B;   /* INDICATE END-OF-Q FOUND       */ 02460000
         B     @RC00723                                         03S0732 02461000
@RF00723 OI    SW1,B'10000000'                                  03S0732 02462000
*                   END;                                        03S0733 02463000
*                                                               03S0733 02464000
@RC00723 DS    0H                                               03S0733 02465000
@DE00722 TM    SW1,B'10000000'                                  03S0733 02466000
         BZ    @DL00722                                         03S0733 02467000
*                   /*************************************************/ 02468000
*                   /*                                               */ 02469000
*                   /* CQEBLK POINTS TO LAST CQE BLOCK. CQEPTR POINTS*/ 02470000
*                   /* TO LAST CQE ENTRY. ADD OLD QUEUE TO NEW       */ 02471000
*                   /*                                               */ 02472000
*                   /*************************************************/ 02473000
*                                                               03S0734 02474000
*                   CQEEOQ='0'B;    /* TURN OFF END-OF-Q INDICATOR IN   02475000
*                                      LAST ENTRY OF NEW QUEUE       */ 02476000
         L     @11,CQEPTR                                       03S0734 02477000
         NI    CQEEOQ(@11),B'01111111'                          03S0734 02478000
*                   EVAL(CQEBLK+TWENTY)->CQEWQE=FAILO->UCMOUTQ;/*       02479000
*                                      CHAIN FAIL'S OUTPUT QUEUE TO     02480000
*                                      NEW'S OUTPUT Q                */ 02481000
         L     @11,CQEBLK                                       03S0735 02482000
         LA    @04,20                                           03S0735 02483000
         LR    @02,@11                                          03S0735 02484000
         ALR   @02,@04                                          03S0735 02485000
         L     @01,FAILO                                        03S0735 02486000
         MVC   CQEWQE(4,@02),UCMOUTQ(@01)                       03S0735 02487000
*                   EVAL(CQEBLK+TWENTY)->CQEEOB=ONTWO;/* RESET EOB      02488000
*                                      INDICATOR                     */ 02489000
         ALR   @11,@04                                          03S0736 02490000
         OI    CQEEOB(@11),B'11000000'                          03S0736 02491000
*                 END;                                          03S0737 02492000
*             END;                                              03S0738 02493000
*                                                               03S0738 02494000
@RC00716 DS    0H                                               03S0739 02495000
*/*** END OF WQEREQU SEGMENT *****************************************/ 02496000
*                                                               03S0739 02497000
*                                                               02S0739 02498000
*           /*********************************************************/ 02499000
*           /*                                                       */ 02500000
*           /* ELIMINATE DUPLICATES ON THE OUTPUT QUEUE OF THE NEW   */ 02501000
*           /* CONSOLE                                               */ 02502000
*           /*                                                       */ 02503000
*           /*********************************************************/ 02504000
*                                                               02S0739 02505000
*                                                               03S0739 02506000
*/*** START OF DUPSRCH SEGMENT ***************************************/ 02507000
*/*                                                                  */ 02508000
*/* DUPSRCH - SEARCH FOR DUPLICATE CQE ENTRIES.                      */ 02509000
*/*                                                                  */ 02510000
*/* FUNCTION - MARK DUPLICATE ENTRIES ON THE OUTPUT QUEUE OF THE     */ 02511000
*/*    NEW CONSOLE AS 'NO LONGER NEEDED'.                            */ 02512000
*/*                                                                  */ 02513000
*/* INPUT - NEWO = UCME ADDR OF OUTPUT HALF OF NEW CONSOLE           */ 02514000
*/*                                                                  */ 02515000
*/* OUTPUT - NONE                                                    */ 02516000
*/*                                                                  */ 02517000
*/********************************************************************/ 02518000
*                                                               03S0739 02519000
*           SW1='0'B;               /* INIT END-OF-Q SWITCH          */ 02520000
@RF00687 NI    SW1,B'01111111'                                  03S0739 02521000
*           IF NEWO->UCMOUTQ^=0 THEN/* IS THERE AN OUTPUT Q          */ 02522000
         L     @11,NEWO                                         03S0740 02523000
         L     @11,UCMOUTQ(,@11)                                03S0740 02524000
         LTR   @11,@11                                          03S0740 02525000
         BZ    @RF00740                                         03S0740 02526000
*             DO;                   /* YES                           */ 02527000
*               CQEPTR=NEWO->UCMOUTQ;/* INIT CQEPTR TO 1ST ENTRY     */ 02528000
*                                                               03S0742 02529000
         ST    @11,CQEPTR                                       03S0742 02530000
*               /*****************************************************/ 02531000
*               /*                                                   */ 02532000
*               /* OUTER LOOP TO CHECK EACH CQE ENTRY EXCEPT LAST    */ 02533000
*               /*                                                   */ 02534000
*               /*****************************************************/ 02535000
*                                                               03S0743 02536000
*               DO WHILE(SW1='0'B);                             03S0743 02537000
         B     @DE00743                                         03S0743 02538000
@DL00743 DS    0H                                               03S0744 02539000
*                 IF CQEPTR->CQEEOQ='1'B THEN                   03S0744 02540000
         L     @11,CQEPTR                                       03S0744 02541000
         TM    CQEEOQ(@11),B'10000000'                          03S0744 02542000
         BNO   @RF00744                                         03S0744 02543000
*                   SW1='1'B;                                   03S0745 02544000
         OI    SW1,B'10000000'                                  03S0745 02545000
*                 ELSE                                          03S0746 02546000
*                   DO;             /* DONT DO LAST CQE              */ 02547000
         B     @RC00744                                         03S0746 02548000
@RF00744 DS    0H                                               03S0747 02549000
*                     IF CQEPTR->CQEENTR='1'B THEN/* IS THE CQE ENTRY   02550000
*                                      VALID                         */ 02551000
         L     @11,CQEPTR                                       03S0747 02552000
         TM    CQEENTR(@11),B'00000001'                         03S0747 02553000
         BNO   @RF00747                                         03S0747 02554000
*                       DO;         /* YES, SEARCH FOR DUPLICATES OF    02555000
*                                      THIS ENTRY                    */ 02556000
*                         CQEPTR2=CQEPTR+LENGTH(CQEWQE);/* START AT     02557000
*                                      NEXT ENTRY                    */ 02558000
         AL    @11,@CF00065                                     03S0749 02559000
         ST    @11,CQEPTR2                                      03S0749 02560000
*                         IF CQEPTR2->CQEEOB=ONTWO THEN/* IS IT THE     02561000
*                                      END OF A BLOCK                */ 02562000
         TM    CQEEOB(@11),B'11000000'                          03S0750 02563000
         BNO   @RF00750                                         03S0750 02564000
*                           CQEPTR2=CQEPTR2->CQEWQEA;/* YES, GET PTR    02565000
*                                      TO NEXT BLOCK                 */ 02566000
         SLR   @04,@04                                          03S0751 02567000
         ICM   @04,7,CQEWQEA(@11)                               03S0751 02568000
         ST    @04,CQEPTR2                                      03S0751 02569000
*                         SW2='0'B; /* INIT END-OF-Q SWITCH          */ 02570000
*                                                               03S0752 02571000
@RF00750 NI    SW2,B'10111111'                                  03S0752 02572000
*                         /*******************************************/ 02573000
*                         /*                                         */ 02574000
*                         /* SEARCH REMAINING CQE ENTRIES FOR        */ 02575000
*                         /* DUPLICATES OF CQE ENTRY SELECTED IN     */ 02576000
*                         /* OUTER LOOP                              */ 02577000
*                         /*                                         */ 02578000
*                         /*******************************************/ 02579000
*                                                               03S0753 02580000
*                         DO WHILE(SW2='0'B);/* STOP AT END-OF-QUEUE */ 02581000
         B     @DE00753                                         03S0753 02582000
@DL00753 DS    0H                                               03S0754 02583000
*                           IF CQEPTR2->CQEENTR='1'B&CQEPTR2->CQEWQEA=  02584000
*                               CQEPTR->CQEWQEA THEN            03S0754 02585000
         L     @11,CQEPTR2                                      03S0754 02586000
         TM    CQEENTR(@11),B'00000001'                         03S0754 02587000
         BNO   @RF00754                                         03S0754 02588000
         L     @04,CQEPTR                                       03S0754 02589000
         CLC   CQEWQEA(3,@11),CQEWQEA(@04)                      03S0754 02590000
         BNE   @RF00754                                         03S0754 02591000
*                             DO;   /* DUPLICATE - YES               */ 02592000
*                               CQEPTR2->CQEENTR='0'B;/* TURN OFF       02593000
*                                      ENTRY EXISTS INDICATOR        */ 02594000
*                               CQEPTR2->CQEAVAIL='1'B;/* INDICATE      02595000
*                                      ENTRY IS NO LONGER NEEDED     */ 02596000
         OI    CQEAVAIL(@11),B'00000010'                        03S0757 02597000
         NI    CQEENTR(@11),B'11111110'                         03S0757 02598000
*                             END;                              03S0758 02599000
*                           IF CQEPTR2->CQEEOQ='0'B THEN/* END-OF-Q ?*/ 02600000
@RF00754 L     @11,CQEPTR2                                      03S0759 02601000
         TM    CQEEOQ(@11),B'10000000'                          03S0759 02602000
         BNZ   @RF00759                                         03S0759 02603000
*                             DO;   /* NO                            */ 02604000
*                               CQEPTR2=CQEPTR2+LENGTH(CQEWQE);/*       02605000
*                                      INCREMENT PTR TO NEXT ENTRY   */ 02606000
         AL    @11,@CF00065                                     03S0761 02607000
         ST    @11,CQEPTR2                                      03S0761 02608000
*                               IF CQEPTR2->CQEEOB=ONTWO THEN/* 03S0762 02609000
*                                      END-OF-BLOCK ?                */ 02610000
         TM    CQEEOB(@11),B'11000000'                          03S0762 02611000
         BNO   @RF00762                                         03S0762 02612000
*                                 CQEPTR2=CQEPTR2->CQEWQEA;/* GET PTR   02613000
*                                      TO NEXT BLOCK                 */ 02614000
         SLR   @04,@04                                          03S0763 02615000
         ICM   @04,7,CQEWQEA(@11)                               03S0763 02616000
         ST    @04,CQEPTR2                                      03S0763 02617000
*                             END;                              03S0764 02618000
*                           ELSE                                03S0765 02619000
*                             SW2='1'B;/* INDICATE END-OF-Q WAS FOUND*/ 02620000
         B     @RC00759                                         03S0765 02621000
@RF00759 OI    SW2,B'01000000'                                  03S0765 02622000
*                         END;                                  03S0766 02623000
@RC00759 DS    0H                                               03S0766 02624000
@DE00753 TM    SW2,B'01000000'                                  03S0766 02625000
         BZ    @DL00753                                         03S0766 02626000
*                       END;                                    03S0767 02627000
*                     CQEPTR=CQEPTR+LENGTH(CQEWQE);/* INCREMENT PTR     02628000
*                                      TO NEXT ENTRY                 */ 02629000
@RF00747 LA    @11,4                                            03S0768 02630000
         AL    @11,CQEPTR                                       03S0768 02631000
         ST    @11,CQEPTR                                       03S0768 02632000
*                     IF CQEPTR->CQEEOB=ONTWO THEN/* END-OF-BLOCK ?  */ 02633000
         TM    CQEEOB(@11),B'11000000'                          03S0769 02634000
         BNO   @RF00769                                         03S0769 02635000
*                       CQEPTR=CQEPTR->CQEWQEA;/* GET PTR TO NEXT       02636000
*                                      BLOCK                         */ 02637000
         SLR   @04,@04                                          03S0770 02638000
         ICM   @04,7,CQEWQEA(@11)                               03S0770 02639000
         ST    @04,CQEPTR                                       03S0770 02640000
*                   END;                                        03S0771 02641000
@RF00769 DS    0H                                               03S0772 02642000
*               END;                                            03S0772 02643000
@RC00744 DS    0H                                               03S0772 02644000
@DE00743 TM    SW1,B'10000000'                                  03S0772 02645000
         BZ    @DL00743                                         03S0772 02646000
*             END;                                              03S0773 02647000
*                                                               03S0773 02648000
*/*** END-OF-DUPSRCH SEGMENT *****************************************/ 02649000
*                                                               03S0774 02650000
*                                                               02S0774 02651000
*           /*********************************************************/ 02652000
*           /*                                                       */ 02653000
*           /* SET UP TO CLOSE THE FAILING CONSOLE                   */ 02654000
*           /*                                                       */ 02655000
*           /*********************************************************/ 02656000
*                                                               02S0774 02657000
*                                                               03S0774 02658000
*/*** START OF MARKFAIL SEGMENT **************************************/ 02659000
*/*                                                                  */ 02660000
*/*  MARKFAIL -IS A ROUTINE TO ADJUST THE VARIOUS BITS AND FIELDS    */ 02661000
*/*            OF FAILING CONSOLE TO INDICATE ITS STATUS AND TO      */ 02662000
*/*            CAUSE IT TO BE CLOSED. IT IS USED TO PROCESS CONSOLES.*/ 02663000
*/*                                                                  */ 02664000
*/*  INPUT  -  FAILI AND FAILO POINT TO THE INPUT AND OUTPUT HALVES  */ 02665000
*/*            OF THE FAILING CONSOLE (BOTH POINTERS POINT TO THE    */ 02666000
*/*            SAME CONSOLE OF IT WAS NOT A COMPOSITE).              */ 02667000
*/*                                                                  */ 02668000
*/*  OUTPUT -  UCME UPDATED TO SHOW CLOSE PENDING, NOT BUSY, AND     */ 02669000
*/*            NO WORK QUEUED TO THE OUTPUT CONSOLE.                 */ 02670000
*/*                                                                  */ 02671000
*/********************************************************************/ 02672000
*                                                               03S0774 02673000
*           FAILI->UCMCF='1'B;      /* SET 'CLOSE PENDING'           */ 02674000
@RF00740 DS    0H                                               03S0775 02675000
*           FAILI->UCMBF='0'B;      /* TURN OFF 'DEVICE BUSY'        */ 02676000
*           FAILI->UCMAF='0'B;      /* TURN OFF ATTENTION PENDING    */ 02677000
         L     @11,FAILI                                        03S0776 02678000
         OI    UCMCF(@11),B'00010000'                           03S0776 02679000
         NI    UCMBF(@11),B'01011111'                           03S0776 02680000
*           IF FAILI^=FAILO         /* IF FAILING CONSOLE IS COMPOSIT*/ 02681000
*             THEN                                              03S0777 02682000
         L     @04,FAILO                                        03S0777 02683000
         CR    @11,@04                                          03S0777 02684000
         BE    @RF00777                                         03S0777 02685000
*             DO;                   /* THEN PROCESS OUTPUT HALF      */ 02686000
*               FAILO->UCMCF='1'B;  /* SET 'CLOSE PENDING' IN O-HALF */ 02687000
*               FAILO->UCMBF='0'B;  /* TURN OFF 'BUSY' IN O-HALF     */ 02688000
         OI    UCMCF(@04),B'00010000'                           03S0780 02689000
         NI    UCMBF(@04),B'11011111'                           03S0780 02690000
*             END;                                              03S0781 02691000
*                                                               03S0781 02692000
*           /*********************************************************/ 02693000
*           /*                                                       */ 02694000
*           /* SET OUTPUT QUEUE OF FAILING CONSOLE (OUTPUT HALF IN   */ 02695000
*           /* THE CASE OF A COMPOSITE) AND PTR TO LAST WQE PROCESSED*/ 02696000
*           /* TO ZERO.                                              */ 02697000
*           /*                                                       */ 02698000
*           /*********************************************************/ 02699000
*                                                               03S0782 02700000
*           FAILO->UCMOUTQ=ZERO;    /* OUTPUT QUEUE                  */ 02701000
@RF00777 SLR   @11,@11                                          03S0782 02702000
         L     @04,FAILO                                        03S0782 02703000
         ST    @11,UCMOUTQ(,@04)                                03S0782 02704000
*           FAILO->UCMWLAST=ZERO;   /* PTR TO LAST WQE PROCESSED     */ 02705000
*                                                               03S0783 02706000
         ST    @11,UCMWLAST(,@04)                               03S0783 02707000
*           /*********************************************************/ 02708000
*           /*                                                       */ 02709000
*           /* CLEAR MESSAGE FORMAT FLAGS AND OUTPUT PENDING FLAG (IN*/ 02710000
*           /* OUTPUT HALF IF COMPOSITE CONSOLE).                    */ 02711000
*           /*                                                       */ 02712000
*           /*********************************************************/ 02713000
*                                                               03S0784 02714000
*           FAILO->UCMPF='0'B;      /* TURN OFF OUTPUT PENDING       */ 02715000
         NI    UCMPF(@04),B'10111111'                           03S0784 02716000
*           FAILO->UCMDISPI='0'B;   /* TURN OFF TIME STAMP/JOBID     */ 02717000
*           FAILO->UCMDISPJ='0'B;   /* TURN OFF JOBID ONLY           */ 02718000
         NI    UCMDISPI(@04),B'00111111'                        03S0786 02719000
*/*** END OF MARKFAIL SEGMENT ****************************************/ 02720000
*                                                               03S0787 02721000
*         END;                                                  02S0787 02722000
*     END;                                                      02S0788 02723000
*                                                               02S0788 02724000
@RF00627 DS    0H                                               02S0789 02725000
*   /*****************************************************************/ 02726000
*   /*                                                               */ 02727000
*   /* END ANY MONITOR COMMANDS AT THE FAILING CONSOLE CONSTRUCT THE */ 02728000
*   /* MONITOR PARAMETER LIST FOR IEAVMNTR                           */ 02729000
*   /*                                                               */ 02730000
*   /*****************************************************************/ 02731000
*                                                               02S0789 02732000
*   MPLPTR=ADDR(MPLDEF);            /* INITIALIZE PTR TO MONITOR        02733000
*                                      PARAMETER LIST                */ 02734000
@RC00614 LA    MPLPTR,MPLDEF                                    02S0789 02735000
*   MPLCONS='1'B;                   /* PROCESSING IS FOR A CONSOLE   */ 02736000
*   MPLSTOP='1'B;                   /* STOP MONITOR                  */ 02737000
         OI    MPLCONS(MPLPTR),B'10010000'                      02S0791 02738000
*   MPLID(2)=FAILI->UCMID;          /* CONSOLE ID OF INPUT HALF OF      02739000
*                                      FAILING CONSOLE               */ 02740000
         L     @11,FAILI                                        02S0792 02741000
         MVC   MPLID+1(1,MPLPTR),UCMID(@11)                     02S0792 02742000
*   MPLTYPE1='11000100'B;           /* STOP ALL OUTSTANDING MONITOR     02743000
*                                      FUNCTIONS IF ANY              */ 02744000
         MVI   MPLTYPE1(MPLPTR),B'11000100'                     02S0793 02745000
*   CALL IEAVMNTR(MPL);             /* STANDARD LINKAGE TO MONITOR      02746000
*                                      QUEUE MANAGER WITH LOCKS HELD */ 02747000
         ST    MPLPTR,@AL00001                                  02S0794 02748000
         L     @15,UCMMNTR(,UCMBASPT)                           02S0794 02749000
         LA    @01,@AL00001                                     02S0794 02750000
         BALR  @14,@15                                          02S0794 02751000
*   END SWCONS;                                                 02S0795 02752000
*                                                               02S0795 02753000
@EL00004 DS    0H                                               02S0795 02754000
@EF00004 DS    0H                                               02S0795 02755000
@ER00004 LM    @14,@02,@SA00004                                 02S0795 02756000
         LM    @04,@12,@SA00004+20                              02S0795 02757000
         BR    @14                                              02S0795 02758000
*/*** END OF SWCONS SUBROUTINE ***************************************/ 02759000
*                                                               02S0796 02760000
         EJECT                                                          02761000
*                                                               02S0796 02762000
*/* START OF NOALTM SUBROUTINE ***************************************/ 02763000
*/*                                                                  */ 02764000
*/* NOALTM - WHEN THE MASTER IS FAILING AND NO ALTERNATE EXISTS IN   */ 02765000
*/*          ITS ALTERNATE CHAIN, THIS ROUTINE ISSUES VARY   @ZA08472*/ 02766000
*/*          MSTCONS MESSAGE. THEN DETERMINES IF ANY FULL    @ZA08472*/ 02767000
*/*          I/O CONSOLE OR A CRT WITH I/O HARDWARE EXISTS.  @ZA08472*/ 02768000
*/*          IF SO, THE STATUS OF THE DEVICE IS CHANGED SO   @ZA08472*/ 02769000
*/*          THAT IT MAY BE USED AFTER VARY MSTCONS IS       @ZA08472*/ 02770000
*/*          ISSUED. OTHERWISE, A NO CONSOLES CONDITION EXISTS.      */ 02771000
*/*          IF SO, A CONSOLE WITH A BELL IS SELECTED TO SOUND THE   */ 02772000
*/*          ALARM AND A 3036 WITH A POWER AND COOLING ALARM @G51APSS*/ 02773000
*/*          IS SELECTED TO THE SOUND THE ALARM.             @G51APSS*/ 02774000
*/*                                                                  */ 02775000
*/* INPUT - NONE.                                                    */ 02776000
*/*                                                                  */ 02777000
*/* OUTPUT - AMFAMSG=1  VARY MSTCONS MSG SHOULD BE ISSUED            */ 02778000
*/*          UCMUF=0    OLD MASTER IS NOT ACTIVE                     */ 02779000
*/*          UCMSYSD=0  CLEAR MASTER IS FAILING FLAG                 */ 02780000
*/*          UCMSYSE=1  INDICATES A NO CONSOLES CONDITION            */ 02781000
*/*          NCCNOW=1   INDICATES THAT A NO-CONSOLES         @G51APSS*/ 02782000
*/*                     CONDITION WAS ENTERED THIS TIME THRU @G51APSS*/ 02783000
*/*                     IEAVSWCH                             @G51APSS*/ 02784000
*/*          RINGBELL=1 BELL SHOULD BE RUNG                          */ 02785000
*/*          RINGPOWR=1 POWER ALARM SHOULD BE SOUNDED        @G51APSS*/ 02786000
*/*          BELLCONS=  UCME ADDR OF A CONSOLE WITH A BELL           */ 02787000
*/*          PWRCONS=   UCME ADDR OF CONSOLE WITH POWER      @G51APSS*/ 02788000
*/*                     ALARM                                @G51APSS*/ 02789000
*/*                                                                  */ 02790000
*/********************************************************************/ 02791000
*                                                               02S0796 02792000
*NOALTM:                                                        02S0796 02793000
*   PROC OPTIONS(SAVE);             /*                       @G51APSS*/ 02794000
NOALTM   STM   @14,@02,@SA00005                                 02S0796 02795000
         STM   @04,@12,@SA00005+20                              02S0796 02796000
*   AMFAMSG='1'B;                   /* INDICATE MSG IEE141A (VARY       02797000
*                                      MSTCONS) SHOULD BE ISSUED.       02798000
*                                                            @ZA08472*/ 02799000
         OI    AMFAMSG,B'01000000'                              02S0797 02800000
*   FOUND=NO;                       /* INIT FOUND SWITCH             */ 02801000
         NI    FOUND,B'11101111'                                02S0798 02802000
*                                                               02S0799 02803000
*   /*****************************************************************/ 02804000
*   /*                                                               */ 02805000
*   /* SEARCH FOR ANY FULL I/O CONSOLE                               */ 02806000
*   /*                                                               */ 02807000
*   /*****************************************************************/ 02808000
*                                                               02S0799 02809000
*   DO UCMDVEPT=UCMVEA TO UCMVEL BY UCMVEZ WHILE FOUND=NO;      02S0799 02810000
         L     UCMDVEPT,UCMVEA(,UCMBASPT)                       02S0799 02811000
         B     @DE00799                                         02S0799 02812000
@DL00799 TM    FOUND,B'00010000'                                02S0799 02813000
         BNZ   @DC00799                                         02S0799 02814000
*     FOUND=YES;                    /* FOUND UNLESS FLUNKS ONE OF THE   02815000
*                                      FOLLOWING TESTS               */ 02816000
         OI    FOUND,B'00010000'                                02S0800 02817000
*     IF UCMDISPA='1'B|UCMDISPD='1'B THEN/* OUTPUT ONLY OR MASTER    */ 02818000
         TM    UCMDISPA(UCMDVEPT),B'10010000'                   02S0801 02819000
         BZ    @RF00801                                         02S0801 02820000
*       FOUND=NO;                   /* YES, CANNOT BE USED.          */ 02821000
         NI    FOUND,B'11101111'                                02S0802 02822000
*     IF UCMCOMPC^=ZERO THEN        /* COMPOSITE?                    */ 02823000
@RF00801 L     @11,UCMCOMPC(,UCMDVEPT)                          02S0803 02824000
         LTR   @11,@11                                          02S0803 02825000
         BZ    @RF00803                                         02S0803 02826000
*       IF UCMCOMPC->UCMDISPA='1'B THEN/* YES, IS OTHER HALF MASTER? */ 02827000
         TM    UCMDISPA(@11),B'10000000'                        02S0804 02828000
         BNO   @RF00804                                         02S0804 02829000
*         FOUND=NO;                 /* YES, IS OTHER HALF THE MASTER */ 02830000
*                                                               02S0805 02831000
         NI    FOUND,B'11101111'                                02S0805 02832000
*     /***************************************************************/ 02833000
*     /*                                                             */ 02834000
*     /* TEST FOR CLOSE PENDING AND NOT AN ACR REQUEST, OR NOT       */ 02835000
*     /* ACTIVE, OR I/O PATH AFFECTED BY ACR OR VARY                 */ 02836000
*     /*                                                             */ 02837000
*     /***************************************************************/ 02838000
*                                                               02S0806 02839000
*     IF(UCMCF='1'B&CSAACR='0'B)|UCMUF='0'B|UCMVHRSN='1'B THEN  02S0806 02840000
@RF00804 DS    0H                                               02S0806 02841000
@RF00803 TM    UCMCF(UCMDVEPT),B'00010000'                      02S0806 02842000
         BNO   @GL00044                                         02S0806 02843000
         TM    CSAACR(CXSAPTR),B'00010000'                      02S0806 02844000
         BZ    @RT00806                                         02S0806 02845000
@GL00044 TM    UCMUF(UCMDVEPT),B'00010000'                      02S0806 02846000
         BZ    @RT00806                                         02S0806 02847000
         TM    UCMVHRSN(UCMDVEPT),B'00000001'                   02S0806 02848000
         BNO   @RF00806                                         02S0806 02849000
@RT00806 DS    0H                                               02S0807 02850000
*       FOUND=NO;                   /* YES, CANNOT BE USED.          */ 02851000
         NI    FOUND,B'11101111'                                02S0807 02852000
*   END;                            /* END DO LOOP ON CONSOLES       */ 02853000
@RF00806 AL    UCMDVEPT,UCMVEZ(,UCMBASPT)                       02S0808 02854000
@DE00799 C     UCMDVEPT,UCMVEL(,UCMBASPT)                       02S0808 02855000
         BNH   @DL00799                                         02S0808 02856000
@DC00799 DS    0H                                               02S0809 02857000
*                                                               02S0809 02858000
*   /*****************************************************************/ 02859000
*   /*                                                               */ 02860000
*   /* IF A FULL I/O CONSOLE WAS NOT FOUND, SEARCH FOR A OUTPUT ONLY */ 02861000
*   /* CRT WITH I/O HARDWARE AND FORCE IT TO FULL I/O CAPABILITY     */ 02862000
*   /*                                                               */ 02863000
*   /*****************************************************************/ 02864000
*                                                               02S0809 02865000
*   IF FOUND=NO THEN                                            02S0809 02866000
         TM    FOUND,B'00010000'                                02S0809 02867000
         BNZ   @RF00809                                         02S0809 02868000
*     DO UCMDVEPT=UCMVEA TO UCMVEL BY UCMVEZ WHILE FOUND=NO;    02S0810 02869000
         L     UCMDVEPT,UCMVEA(,UCMBASPT)                       02S0810 02870000
         B     @DE00810                                         02S0810 02871000
@DL00810 TM    FOUND,B'00010000'                                02S0810 02872000
         BNZ   @DC00810                                         02S0810 02873000
*       FOUND=YES;                  /* FOUND UNLESS FLUNKS A TEST    */ 02874000
         OI    FOUND,B'00010000'                                02S0811 02875000
*       IF UCMDISPC='0'B|UCMDISPD='0'B THEN/* OUTPUT ONLY CRT?       */ 02876000
         TM    UCMDISPC(UCMDVEPT),B'00110000'                   02S0812 02877000
         BO    @RF00812                                         02S0812 02878000
*         FOUND=NO;                 /* NO, CANNOT BE USED            */ 02879000
         NI    FOUND,B'11101111'                                02S0813 02880000
*       ELSE                        /* YES,                          */ 02881000
*/* IF THE CONSOLE CAN BE MADE FULL CAPABILITY (I.E. INPUT AND OUTPUT   02882000
*   IS ACTIVE, AND NOT CLOSE PENDING OR CLOSE PENDING BUT ACR BEING     02883000
*   PROCESSED AND NOT AFFECTED BY ACR OR VARY CHANNEL/CPU.           */ 02884000
*                                                               02S0814 02885000
*         IF UCMSDS5G='1'B&UCMUF='1'B&(UCMCF='0'B|CSAACR='1'B)&UCMVHRSN 02886000
*             ='0'B THEN                                        02S0814 02887000
         B     @RC00812                                         02S0814 02888000
@RF00812 TM    UCMSDS5G(UCMDVEPT),B'00000010'                   02S0814 02889000
         BNO   @RF00814                                         02S0814 02890000
         TM    UCMUF(UCMDVEPT),B'00010000'                      02S0814 02891000
         BNO   @RF00814                                         02S0814 02892000
         TM    UCMCF(UCMDVEPT),B'00010000'                      02S0814 02893000
         BZ    @GL00046                                         02S0814 02894000
         TM    CSAACR(CXSAPTR),B'00010000'                      02S0814 02895000
         BNO   @RF00814                                         02S0814 02896000
@GL00046 TM    UCMVHRSN(UCMDVEPT),B'00000001'                   02S0814 02897000
         BNZ   @RF00814                                         02S0814 02898000
*           DO;                     /* YES, CONDITIONS HAVE BEEN MET */ 02899000
*             NEWI=UCMDVEPT;        /* SET UP FOR SWFULCAP           */ 02900000
         LR    NEWI,UCMDVEPT                                    02S0816 02901000
*             CALL SWFULCAP;        /* FORCE TO FULL I/O STATUS      */ 02902000
         BAL   @14,SWFULCAP                                     02S0817 02903000
*           END;                                                02S0818 02904000
*         ELSE                                                  02S0819 02905000
*           FOUND=NO;               /* NO, CANNOT BE USED            */ 02906000
         B     @RC00814                                         02S0819 02907000
@RF00814 NI    FOUND,B'11101111'                                02S0819 02908000
*     END;                                                      02S0820 02909000
*                                                               02S0820 02910000
@RC00814 DS    0H                                               02S0820 02911000
@RC00812 AL    UCMDVEPT,UCMVEZ(,UCMBASPT)                       02S0820 02912000
@DE00810 C     UCMDVEPT,UCMVEL(,UCMBASPT)                       02S0820 02913000
         BNH   @DL00810                                         02S0820 02914000
@DC00810 DS    0H                                               02S0821 02915000
*   /*****************************************************************/ 02916000
*   /*                                                               */ 02917000
*   /* IF A FULL I/O CONSOLE WAS FOUND OR AN OUTPUT-ONLY CRT WAS     */ 02918000
*   /* FORCED TO FULL I/O, VARY MSTCONS WILL BE ACCEPTED FROM ANY    */ 02919000
*   /* CONSOLE.                                                      */ 02920000
*   /*                                                               */ 02921000
*   /*****************************************************************/ 02922000
*                                                               02S0821 02923000
*   IF FOUND=YES THEN               /* WAS A CONSOLE SUITABLE FOR A     02924000
*                                      MASTER FOUND?                 */ 02925000
@RF00809 TM    FOUND,B'00010000'                                02S0821 02926000
         BNO   @RF00821                                         02S0821 02927000
*     DO;                           /* YES,                          */ 02928000
*       UCMDVEPT=UCMDVEPT-UCMVEZ;   /* BACK UP UMCE PTR TO SUITABLE     02929000
*                                      CONSOLE.                      */ 02930000
         SL    UCMDVEPT,UCMVEZ(,UCMBASPT)                       02S0823 02931000
*       IF UCMCF='1'B               /* IF CONSOLE HAS CLOSE PENDING  */ 02932000
*         THEN                                                  02S0824 02933000
         TM    UCMCF(UCMDVEPT),B'00010000'                      02S0824 02934000
         BNO   @RF00824                                         02S0824 02935000
*         DO;                                                   02S0825 02936000
*           UCMCF='0'B;             /* TURN OFF CLOSE PENDING        */ 02937000
         NI    UCMCF(UCMDVEPT),B'11101111'                      02S0826 02938000
*           UCBCHGSX='0'B;          /* TURN OFF CHANGING TO OFFLINE  */ 02939000
*           UCBDADIX='0'B;          /* STOP CHANGE FROM CONSOLE      */ 02940000
         L     @01,UCBPTR(,UCMDVEPT)                            02S0828 02941000
         L     @11,UCBDADIX-3(,@01)                             02S0828 02942000
@GL00050 LR    @04,@11                                          02S0828 02943000
         N     @04,@CF03977                                     02S0828 02944000
         CS    @11,@04,UCBDADIX-3(@01)                          02S0828 02945000
         BNE   @GL00050                                         02S0828 02946000
*         END;                                                  02S0829 02947000
*     END;                                                      02S0830 02948000
*   ELSE                            /* NO, NO CONSOLES CONDITION        02949000
*                                      EXIST                         */ 02950000
*     DO;                                                       02S0831 02951000
*                                                               02S0831 02952000
         B     @RC00821                                         02S0831 02953000
@RF00821 DS    0H                                               02S0832 02954000
*       /*************************************************************/ 02955000
*       /*                                                           */ 02956000
*       /* A NO-CONSOLES CONDITION EXISTS                    @G51APSS*/ 02957000
*       /*                                                           */ 02958000
*       /*************************************************************/ 02959000
*                                                               02S0832 02960000
*       UCMAMFA='0'B;               /* TURN OFF ACCEPT VARY MSTCONS     02961000
*                                      FROM ANYWHERE         @G51APSS*/ 02962000
         NI    UCMAMFA(UCMBASPT),B'11110111'                    02S0832 02963000
*       AMFAMSG='0'B;               /* MSG IEE141A SHOULD NOT BE        02964000
*                                      ISSUED                @G51APSS*/ 02965000
         NI    AMFAMSG,B'10111111'                              02S0833 02966000
*       IF UCMSYSE='0'B THEN        /* DID A NO-CONSOLES CONDITION      02967000
*                                      EXIST BEFORE?         @G51APSS*/ 02968000
         TM    UCMSYSE(UCMMCSPT),B'00001000'                    02S0834 02969000
         BNZ   @RF00834                                         02S0834 02970000
*         DO;                       /* NO                    @G51APSS*/ 02971000
*           UCMSYSE='1'B;           /* MARK THAT ONE EXISTS NOW 02S0836 02972000
*                                                            @G51APSS*/ 02973000
         OI    UCMSYSE(UCMMCSPT),B'00001000'                    02S0836 02974000
*           UCMFATCN='80000000'X;   /* SET SO IEAVVCRA WILL NOT ALLOW   02975000
*                                      A CANDIDATE TO BE CHOSEN YET     02976000
*                                                            @G51APSS*/ 02977000
         L     @11,UCMFXPTR(,UCMBASPT)                          02S0837 02978000
         MVC   UCMFATCN(4,@11),@CF03732                         02S0837 02979000
*           NCCNOW=YES;             /* NO-CONSOLES CONDITION OCCURED    02980000
*                                      THIS TIME THRU VSWCH  @ZA18879*/ 02981000
         OI    NCCNOW,B'01000000'                               02S0838 02982000
*           CALL FNDALARM;          /* FIND A CONSOLE WITH AN ALARM     02983000
*                                      TO SOUND              @G51APSS*/ 02984000
         BAL   @14,FNDALARM                                     02S0839 02985000
*           CALL FNDPOWER;          /* FIND A 3036 CONSOLE WITH THE     02986000
*                                      POWER AND COOLING ALARM  02S0840 02987000
*                                                            @G51APSS*/ 02988000
         BAL   @14,FNDPOWER                                     02S0840 02989000
*         END;                      /* OF NO-CONSOLES CONDITION JUST    02990000
*                                      CAME INTO EXISTENCE   @G51APSS*/ 02991000
*     END;                          /* OF NO-CONSOLES CONDITION 02S0842 02992000
*                                                            @G51APSS*/ 02993000
@RF00834 DS    0H                                               02S0843 02994000
*   MASTERI->UCMUF='0'B;            /* INDICATE MASTER IS NOT ACTIVE */ 02995000
@RC00821 L     @11,MASTERI                                      02S0843 02996000
         NI    UCMUF(@11),B'11101111'                           02S0843 02997000
*   IF MASTERO^=ZERO THEN           /* MASTER A COMPOSITE?   @ZA20165*/ 02998000
         L     @11,MASTERO                                      02S0844 02999000
         LTR   @11,@11                                          02S0844 03000000
         BZ    @RF00844                                         02S0844 03001000
*     MASTERO->UCMUF='0'B;          /* YES, INDICATE THE OUTPUT HALF    03002000
*                                      IS NOT ACTIVE         @ZA20165*/ 03003000
         NI    UCMUF(@11),B'11101111'                           02S0845 03004000
*   END NOALTM;                     /*                       @G51APSS*/ 03005000
@EL00005 DS    0H                                               02S0846 03006000
@EF00005 DS    0H                                               02S0846 03007000
@ER00005 LM    @14,@02,@SA00005                                 02S0846 03008000
         LM    @04,@12,@SA00005+20                              02S0846 03009000
         BR    @14                                              02S0846 03010000
*/*** END OF NOALTM SUBROUTINE ***************************************/ 03011000
*                                                               02S0847 03012000
         EJECT                                                          03013000
*                                                               02S0847 03014000
*/*** START OF FNDALARM SUBROUTINE ***********************************/ 03015000
*/*                                                                  */ 03016000
*/* FNDALARM - SEARCH FOR A CONSOLE WHICH HAS AN ALARM WHICH @G51APSS*/ 03017000
*/*            CAN BE SOUNDED.                               @G51APSS*/ 03018000
*/*                                                                  */ 03019000
*/* INPUT    - NONE                                          @G51APSS*/ 03020000
*/*                                                                  */ 03021000
*/* OUTPUT   - RINGBELL = ON IF A CONSOLE WITH AN ALARM WAS  @G51APSS*/ 03022000
*/*                       WAS FOUND                          @G51APSS*/ 03023000
*/*            BELLCONS = UCME ADDR OF CONSOLE WITH ALARM    @G51APSS*/ 03024000
*/*                                                                  */ 03025000
*/********************************************************************/ 03026000
*                                                               02S0847 03027000
*FNDALARM:                                                      02S0847 03028000
*   PROC OPTIONS(SAVE);             /*                       @G51APSS*/ 03029000
*                                                               02S0847 03030000
FNDALARM STM   @14,@12,@SA00006                                 02S0847 03031000
*   /*****************************************************************/ 03032000
*   /*                                                               */ 03033000
*   /* SEARCH FOR AN DEVICE IN CONSOLE STATUS WHICH HAS A BELL       */ 03034000
*   /*                                                       @G51APSS*/ 03035000
*   /*                                                               */ 03036000
*   /*****************************************************************/ 03037000
*                                                               02S0848 03038000
*   FOUND=NO;                       /* NONE FOUND YET        @G51APSS*/ 03039000
         NI    FOUND,B'11101111'                                02S0848 03040000
*   DO UCMDVEPT=UCMVEA TO UCMVEL BY UCMVEZ WHILE FOUND=NO;      02S0849 03041000
         L     UCMDVEPT,UCMVEA(,UCMBASPT)                       02S0849 03042000
         B     @DE00849                                         02S0849 03043000
@DL00849 TM    FOUND,B'00010000'                                02S0849 03044000
         BNZ   @DC00849                                         02S0849 03045000
*     IF UCMNAME(4:5)='00'          /* IS THE CONSOLE'S DEVICE  02S0850 03046000
*                                      PROCESSOR NAME IGC0007B       */ 03047000
*         |(UCMDISPC='1'B&UCBTYP(3:4)^=DEV2260) THEN/* OR IS THE        03048000
*                                      CONSOLE GRAPHICS BUT NOT A       03049000
*                                      2260                          */ 03050000
*                                                               02S0850 03051000
         CLC   UCMNAME+3(2,UCMDVEPT),@CC00120                   02S0850 03052000
         BE    @RT00850                                         02S0850 03053000
         TM    UCMDISPC(UCMDVEPT),B'00100000'                   02S0850 03054000
         BNO   @RF00850                                         02S0850 03055000
         L     @11,UCBPTR(,UCMDVEPT)                            02S0850 03056000
         CLC   UCBTYP+2(2,@11),@CB00337                         02S0850 03057000
         BE    @RF00850                                         02S0850 03058000
@RT00850 DS    0H                                               02S0851 03059000
*       /*************************************************************/ 03060000
*       /*                                                           */ 03061000
*       /* CHECK TO SEE IF DEVICE IS OK TO USE               @ZA18885*/ 03062000
*       /*                                                           */ 03063000
*       /*************************************************************/ 03064000
*                                                               02S0851 03065000
*       IF UCBONLI='1'B&            /* DEVICE ONLINE?        @ZA18885*/ 03066000
*           UCBSYSR='1'B&           /* IS A CONSOLE?         @ZA18885*/ 03067000
*           UCBVHRSN='0'B&          /* HAS AN I/O PATH?      @ZA18885*/ 03068000
*           UCBNRY='0'B THEN        /* DEVICE IS READY?      @ZA18885*/ 03069000
         L     @11,UCBPTR(,UCMDVEPT)                            02S0851 03070000
         TM    UCBONLI(@11),B'10000010'                         02S0851 03071000
         BNO   @RF00851                                         02S0851 03072000
         TM    UCBVHRSN(@11),B'00000010'                        02S0851 03073000
         BNZ   @RF00851                                         02S0851 03074000
         TM    UCBNRY(@11),B'01000000'                          02S0851 03075000
         BNZ   @RF00851                                         02S0851 03076000
*         DO;                       /* YES                   @ZA18885*/ 03077000
*           FOUND=YES;              /* OK, RING ITS BELL     @ZA05340*/ 03078000
         OI    FOUND,B'00010000'                                02S0853 03079000
*           CALL VERGRAF;           /* DETERMINE IF THIS IS A DISPLAY   03080000
*                                      UNIT WITH THE ALARM FEATURE      03081000
*                                                            @G51APSS*/ 03082000
         BAL   @14,VERGRAF                                      02S0854 03083000
*         END;                      /*                       @G51APSS*/ 03084000
*   END;                            /* END CONSOLE SEARCH LOOP       */ 03085000
@RF00851 DS    0H                                               02S0856 03086000
@RF00850 AL    UCMDVEPT,UCMVEZ(,UCMBASPT)                       02S0856 03087000
@DE00849 C     UCMDVEPT,UCMVEL(,UCMBASPT)                       02S0856 03088000
         BNH   @DL00849                                         02S0856 03089000
@DC00849 DS    0H                                               02S0857 03090000
*                                                               02S0857 03091000
*   /*****************************************************************/ 03092000
*   /*                                                               */ 03093000
*   /* IF NONE COULD BE FOUND, SEARCH FOR A DEVICE WITH A ALARM THAT */ 03094000
*   /* IS ONLINE AND NOT ALLOCATED.                                  */ 03095000
*   /*                                                               */ 03096000
*   /*****************************************************************/ 03097000
*                                                               02S0857 03098000
*   IF FOUND=NO THEN                                            02S0857 03099000
         TM    FOUND,B'00010000'                                02S0857 03100000
         BNZ   @RF00857                                         02S0857 03101000
*     DO UCMDVEPT=UCMVEA TO UCMVEL BY UCMVEZ WHILE FOUND=NO;    02S0858 03102000
         L     UCMDVEPT,UCMVEA(,UCMBASPT)                       02S0858 03103000
         B     @DE00858                                         02S0858 03104000
@DL00858 TM    FOUND,B'00010000'                                02S0858 03105000
         BNZ   @DC00858                                         02S0858 03106000
*       IF UCMNAME(4:5)='00'        /* IS THE CONSOLE'S DEVICE  02S0859 03107000
*                                      PROCESSOR NAME IGC0007B       */ 03108000
*           |(UCMDISPC='1'B&UCBTYP(3:4)^=DEV2260)/* OR IS THE CONSOLE   03109000
*                                      GRAPHICS BUT NOT A 2260       */ 03110000
*         THEN                                                  02S0859 03111000
*                                                               02S0859 03112000
         CLC   UCMNAME+3(2,UCMDVEPT),@CC00120                   02S0859 03113000
         BE    @RT00859                                         02S0859 03114000
         TM    UCMDISPC(UCMDVEPT),B'00100000'                   02S0859 03115000
         BNO   @RF00859                                         02S0859 03116000
         L     @11,UCBPTR(,UCMDVEPT)                            02S0859 03117000
         CLC   UCBTYP+2(2,@11),@CB00337                         02S0859 03118000
         BE    @RF00859                                         02S0859 03119000
@RT00859 DS    0H                                               02S0860 03120000
*         /***********************************************************/ 03121000
*         /*                                                         */ 03122000
*         /* CHECK TO SEE IF DEVICE IS OK TO USE             @ZA18885*/ 03123000
*         /*                                                         */ 03124000
*         /***********************************************************/ 03125000
*                                                               02S0860 03126000
*         IF UCBONLI='1'B&          /* DEVICE IS ONLINE      @ZA18885*/ 03127000
*             UCBALOC='0'B&         /* DEVICE IS UNALLOCATED @ZA18885*/ 03128000
*             UCBVHRSN='0'B&        /* HAS AN I/O PATH?      @ZA18885*/ 03129000
*             UCBNRY='0'B&          /* DEVICE IS READY?      @ZA18885*/ 03130000
*             UCMDISPK='0'B THEN    /* NOT A JES3 CONSOLE    @ZA18885*/ 03131000
         L     @11,UCBPTR(,UCMDVEPT)                            02S0860 03132000
         TM    UCBONLI(@11),B'10000000'                         02S0860 03133000
         BNO   @RF00860                                         02S0860 03134000
         TM    UCBALOC(@11),B'00001000'                         02S0860 03135000
         BNZ   @RF00860                                         02S0860 03136000
         TM    UCBVHRSN(@11),B'00000010'                        02S0860 03137000
         BNZ   @RF00860                                         02S0860 03138000
         TM    UCBNRY(@11),B'01000000'                          02S0860 03139000
         BNZ   @RF00860                                         02S0860 03140000
         TM    UCMDISPK(UCMDVEPT),B'00100000'                   02S0860 03141000
         BNZ   @RF00860                                         02S0860 03142000
*           DO;                     /* YES                   @ZA18885*/ 03143000
*             FOUND=YES;            /* OK, RING ITS BELL             */ 03144000
         OI    FOUND,B'00010000'                                02S0862 03145000
*             CALL VERGRAF;         /* DETERMINE IF THIS IS A DISPLAY   03146000
*                                      UNIT WITH THE ALARM FEATURE      03147000
*                                                            @G51APSS*/ 03148000
         BAL   @14,VERGRAF                                      02S0863 03149000
*           END;                    /*                       @G51APSS*/ 03150000
*     END;                                                      02S0865 03151000
@RF00860 DS    0H                                               02S0865 03152000
@RF00859 AL    UCMDVEPT,UCMVEZ(,UCMBASPT)                       02S0865 03153000
@DE00858 C     UCMDVEPT,UCMVEL(,UCMBASPT)                       02S0865 03154000
         BNH   @DL00858                                         02S0865 03155000
@DC00858 DS    0H                                               02S0866 03156000
*                                                               02S0866 03157000
*   /*****************************************************************/ 03158000
*   /*                                                               */ 03159000
*   /* WAS ANY DEVICE WITH A BELL FOUND?                     @G51APSS*/ 03160000
*   /*                                                               */ 03161000
*   /*****************************************************************/ 03162000
*                                                               02S0866 03163000
*   IF FOUND=YES THEN               /* WAS A CONSOLE WITH A BELL        03164000
*                                      FOUND                         */ 03165000
@RF00857 TM    FOUND,B'00010000'                                02S0866 03166000
         BNO   @RF00866                                         02S0866 03167000
*     DO;                           /* YES,                          */ 03168000
*       BELLCONS=UCMDVEPT-UCMVEZ;   /* STORE PTR TO BELL CONSOLE     */ 03169000
         LR    @11,UCMDVEPT                                     02S0868 03170000
         SL    @11,UCMVEZ(,UCMBASPT)                            02S0868 03171000
         ST    @11,BELLCONS                                     02S0868 03172000
*       RINGBELL='1'B;              /* INDICATE BELL SHOULD BE RUNG  */ 03173000
         OI    RINGBELL,B'01000000'                             02S0869 03174000
*     END;                                                      02S0870 03175000
*   ELSE                            /* NO CONSOLE WITH A BELL OTHER     03176000
*                                      THAN POSSIBLY         @ZA10757*/ 03177000
*     DO;                           /* MASTER WAS FOUND. WAS A MASTER   03178000
*                                      WITH ALARM FOUND      @ZA10757*/ 03179000
         B     @RC00866                                         02S0871 03180000
@RF00866 DS    0H                                               02S0872 03181000
*       IF MSTFOUND='1'B|MSTGRFND='1'B THEN/*                @ZA10757*/ 03182000
         TM    MSTFOUND,B'00000011'                             02S0872 03183000
         BZ    @RF00872                                         02S0872 03184000
*         DO;                       /* YES, A MASTER WITH AN ALARM      03185000
*                                      WAS FOUND.            @ZA10757*/ 03186000
*           BELLCONS=UCMMCENT;      /* STORE PTR TO BELL CONS.  02S0874 03187000
*                                                            @ZA10757*/ 03188000
         MVC   BELLCONS(4),UCMMCENT(UCMMCSPT)                   02S0874 03189000
*           RINGBELL='1'B;          /* INDICATE BELL TO BE RUNG.        03190000
*                                                            @ZA10757*/ 03191000
         OI    RINGBELL,B'01000000'                             02S0875 03192000
*           IF MSTGRFND='1'B THEN   /* WAS MASTER GRAPHICS   @ZA10757*/ 03193000
         TM    MSTGRFND,B'00000001'                             02S0876 03194000
         BNO   @RF00876                                         02S0876 03195000
*             GRFSW='1'B;           /* YES, TURN ON INDICATOR   02S0877 03196000
*                                                            @ZA10757*/ 03197000
         OI    GRFSW,B'00000100'                                02S0877 03198000
*         END;                      /*                       @G51APSS*/ 03199000
*     END;                          /*                       @ZA10757*/ 03200000
*   END FNDALARM;                   /*                       @G51APSS*/ 03201000
@EL00006 DS    0H                                               02S0880 03202000
@EF00006 DS    0H                                               02S0880 03203000
@ER00006 LM    @14,@12,@SA00006                                 02S0880 03204000
         BR    @14                                              02S0880 03205000
*/*** END OF FNDALARM SUBROUTINE *************************************/ 03206000
*                                                               02S0881 03207000
         EJECT                                                          03208000
*                                                               02S0881 03209000
*/*** START OF VERGRAF SUBROUTINE ************************************/ 03210000
*/*                                                                  */ 03211000
*/* VERGRAF  - DETERMINE IF THE DEVICE POINTED TO BY         @G51APSS*/ 03212000
*/*            UCMDVEPT IS A GRAPHICS DEVICE WITH THE ALARM  @G51APSS*/ 03213000
*/*            FEATURE INSTALLED.                            @G51APSS*/ 03214000
*/*                                                                  */ 03215000
*/* INPUT    - UCMDVEPT - DEVICES UCME                       @G51APSS*/ 03216000
*/*            FOUND = YES  A DEVICE WAS FOUND TO TEST       @G51APSS*/ 03217000
*/*            MSTGRFND = NO                                 @G51APSS*/ 03218000
*/*            GRFSW = NO                                    @G51APSS*/ 03219000
*/*            MSTFOUND = NO                                 @G51APSS*/ 03220000
*/*                                                                  */ 03221000
*/* OUTPUT   - FOUND = NO IF A DEVICE WITH AN ALARM WAS      @G51APSS*/ 03222000
*/*                  NOT FOUND.                              @G51APSS*/ 03223000
*/*            MSTGRFND = YES IF THE MASTER CONSOLE IS A     @G51APSS*/ 03224000
*/*                  GRAPHICS DEVICE AND HAS AN ALARM        @G51APSS*/ 03225000
*/*            GRFSW = YES IF A GRAPHICS DEVICE WAS FOUND    @G51APSS*/ 03226000
*/*                  WITH AN ALARM AND THE DEVICE WAS NOT    @G51APSS*/ 03227000
*/*                  THE MASTER CONSOLE.                     @G51APSS*/ 03228000
*/*            MSTFOUND = YES IF THE DEVICE WAS A PAPER      @G51APSS*/ 03229000
*/*                  DEVICE AND IT WAS THE MASTER CONSOLE.   @G51APSS*/ 03230000
*/*                                                                  */ 03231000
*/********************************************************************/ 03232000
*                                                               02S0881 03233000
*VERGRAF:                                                       02S0881 03234000
*   PROC OPTIONS(SAVE);             /*                       @G51APSS*/ 03235000
VERGRAF  STM   @14,@12,12(@13)                                  02S0881 03236000
*   IF UCMDISPC='1'B THEN           /* GRAPHICS DEVICE       @ZA08472*/ 03237000
*                                                               02S0882 03238000
         TM    UCMDISPC(UCMDVEPT),B'00100000'                   02S0882 03239000
         BNO   @RF00882                                         02S0882 03240000
*     /***************************************************************/ 03241000
*     /*                                                             */ 03242000
*     /* NOW CHECK FOR GRAPHICS TYPE                         @ZA08472*/ 03243000
*     /* 3270, 3158, 3284, 3286 OR 3036                      @G51APSS*/ 03244000
*     /*                                                             */ 03245000
*     /***************************************************************/ 03246000
*                                                               02S0883 03247000
*     DO;                           /*                       @ZA08472*/ 03248000
*       IF UCBTYP(3:4)=DEV3270|     /*                       @ZA08472*/ 03249000
*           UCBTYP(3:4)=DEV3158|    /*                       @G51APSS*/ 03250000
*           UCBTYP(3:4)=DEV3036 THEN/*                       @G51APSS*/ 03251000
*                                                               02S0884 03252000
         L     @04,UCBPTR(,UCMDVEPT)                            02S0884 03253000
         CLC   UCBTYP+2(2,@04),@CB00343                         02S0884 03254000
         BE    @RT00884                                         02S0884 03255000
         CLC   UCBTYP+2(2,@04),@CB00341                         02S0884 03256000
         BE    @RT00884                                         02S0884 03257000
         CLC   UCBTYP+2(2,@04),@CB00339                         02S0884 03258000
         BNE   @RF00884                                         02S0884 03259000
@RT00884 DS    0H                                               02S0885 03260000
*         /***********************************************************/ 03261000
*         /*                                                         */ 03262000
*         /* NOW CHECK FOR ALARM FEATURE                     @ZA08472*/ 03263000
*         /*                                                         */ 03264000
*         /***********************************************************/ 03265000
*                                                               02S0885 03266000
*         IF UCB2OPT3='1'B THEN     /*                       @ZA08472*/ 03267000
         L     @04,UCBPTR(,UCMDVEPT)                            02S0885 03268000
         TM    UCB2OPT3(@04),B'00010000'                        02S0885 03269000
         BNO   @RF00885                                         02S0885 03270000
*           DO;                     /* IS THIS THE MASTER CONSOLE       03271000
*                                      DEV.                  @ZA10757*/ 03272000
*             IF UCMDVEPT=UCMMCENT THEN/*                    @ZA10757*/ 03273000
         C     UCMDVEPT,UCMMCENT(,UCMMCSPT)                     02S0887 03274000
         BNE   @RF00887                                         02S0887 03275000
*               DO;                 /* YES, BYPASS FOR NOW AND  02S0888 03276000
*                                                            @ZA10757*/ 03277000
*                 MSTGRFND=YES;     /* CONTINUE SCAN         @ZA10757*/ 03278000
*                 FOUND=NO;         /* REMEMBER WE FOUND     @ZA10757*/ 03279000
         OI    MSTGRFND,B'00000001'                             02S0890 03280000
         NI    FOUND,B'11101111'                                02S0890 03281000
*               END;                /* A GRAPHICS MASTER     @ZA10757*/ 03282000
*             ELSE                  /* SET 3270/3158/3036 GRAPHICS      03283000
*                                      CCW SWITCH            @G51APSS*/ 03284000
*               GRFSW=YES;          /*                       @G51PASS*/ 03285000
         B     @RC00887                                         02S0892 03286000
@RF00887 OI    GRFSW,B'00000100'                                02S0892 03287000
*           END;                    /*                       @ZA08472*/ 03288000
*         ELSE                      /* ALARM FEATURE NOT ON  @ZA08472*/ 03289000
*           FOUND=NO;               /* RESUME SCAN           @ZA08472*/ 03290000
         B     @RC00885                                         02S0894 03291000
@RF00885 NI    FOUND,B'11101111'                                02S0894 03292000
*       ELSE                        /*                       @ZA08472*/ 03293000
*         IF UCBTYP(3:4)=DEV3284|   /*                       @ZA08472*/ 03294000
*             UCBTYP(3:4)=DEV3286 THEN/*                     @ZA08472*/ 03295000
         B     @RC00884                                         02S0895 03296000
@RF00884 L     @04,UCBPTR(,UCMDVEPT)                            02S0895 03297000
         CLC   UCBTYP+2(2,@04),@CB00345                         02S0895 03298000
         BE    @RT00895                                         02S0895 03299000
         CLC   UCBTYP+2(2,@04),@CB00347                         02S0895 03300000
         BNE   @RF00895                                         02S0895 03301000
@RT00895 DS    0H                                               02S0896 03302000
*           FOUND=NO;               /* RESUME SCAN           @ZA08472*/ 03303000
         NI    FOUND,B'11101111'                                02S0896 03304000
*     END;                          /* END GRAPHICS CHECK    @ZA08472*/ 03305000
*   ELSE                            /* NOT GRAPHICS DEVICE   @ZA08472*/ 03306000
*     DO;                           /* IS THIS THE MASTER CONSOLE       03307000
*                                      DEVICE                @ZA10757*/ 03308000
         B     @RC00882                                         02S0898 03309000
@RF00882 DS    0H                                               02S0899 03310000
*       IF UCMDVEPT=UCMMCENT THEN   /*                       @ZA10757*/ 03311000
         C     UCMDVEPT,UCMMCENT(,UCMMCSPT)                     02S0899 03312000
         BNE   @RF00899                                         02S0899 03313000
*         DO;                       /* YES, BYPASS FOR NOW AND  02S0900 03314000
*                                      CONTINUE              @ZA10757*/ 03315000
*           MSTFOUND=YES;           /* SCAN REMEMBER WE      @ZA10757*/ 03316000
*           FOUND=NO;               /* FOUND A PAPER         @ZA10757*/ 03317000
         OI    MSTFOUND,B'00000010'                             02S0902 03318000
         NI    FOUND,B'11101111'                                02S0902 03319000
*         END;                      /* MASTER.               @ZA10757*/ 03320000
*     END;                          /*                       @ZA10757*/ 03321000
*   END VERGRAF;                    /*                       @G51APSS*/ 03322000
@EL00007 DS    0H                                               02S0905 03323000
@EF00007 DS    0H                                               02S0905 03324000
@ER00007 LM    @14,@12,12(@13)                                  02S0905 03325000
         BR    @14                                              02S0905 03326000
*/*** END OF VERGRAF SUBROUTINE **************************************/ 03327000
*                                                               02S0906 03328000
         EJECT                                                          03329000
*                                                               02S0906 03330000
*/*** START OF FNDPOWER SUBROUTINE ***********************************/ 03331000
*/*                                                                  */ 03332000
*/* FNDPOWER - SEARCH FOR AN ONLINE 3036. THIS DEVICE HAS    @G51APSS*/ 03333000
*/*            A POWER AND COOLING ALARM AS A STANDARD       @G51APSS*/ 03334000
*/*            FEATURE.                                      @G51APSS*/ 03335000
*/*                                                                  */ 03336000
*/* INPUT    - NONE                                          @G51APSS*/ 03337000
*/*                                                                  */ 03338000
*/* OUTPUT   - RINGPOWR= ON IF A 3036 DEVICE WAS FOUND       @G51APSS*/ 03339000
*/*            PWRCONS = UCME ADDR OF CONSOLE WITH ALARM     @G51APSS*/ 03340000
*/*                                                                  */ 03341000
*/********************************************************************/ 03342000
*                                                               02S0906 03343000
*FNDPOWER:                                                      02S0906 03344000
*   PROC OPTIONS(SAVE);             /*                       @G51APSS*/ 03345000
*                                                               02S0906 03346000
FNDPOWER STM   @14,@12,12(@13)                                  02S0906 03347000
*   /*****************************************************************/ 03348000
*   /*                                                               */ 03349000
*   /* SEARCH THE UCMES FOR A 3036 DEVICE THAT IS ONLINE, READY,     */ 03350000
*   /* UNALLOCATED, HAS AN I/O PATH AND IS NOT A JES3 CONSOLE. IF ONE*/ 03351000
*   /* IS FOUND THEN THE POWER AND COOLING ALARM WILL BE SOUNDED ON  */ 03352000
*   /* THIS DEVICE. IF THE DEVICE WHOS CONSOLE ALARM IS TO BE RUNG IS*/ 03353000
*   /* THE SAME AS THE ONE FOUND IN THIS LOOP THEN CONTINUE          */ 03354000
*   /* SEARCHING. IF ANOTHER DEVICE IS NOT FOUND THEN USE THE        */ 03355000
*   /* PREVIOULY FOUND DEVICE                                @G51APSS*/ 03356000
*   /*                                                               */ 03357000
*   /*****************************************************************/ 03358000
*                                                               02S0907 03359000
*   FOUND=NO;                       /* NONE FOUND YET        @G51APSS*/ 03360000
         NI    FOUND,B'11101111'                                02S0907 03361000
*   DO UCMDVEPT=UCMVEA TO UCMVEL BY UCMVEZ WHILE FOUND=NO;/* @G51APSS*/ 03362000
         L     UCMDVEPT,UCMVEA(,UCMBASPT)                       02S0908 03363000
         B     @DE00908                                         02S0908 03364000
@DL00908 TM    FOUND,B'00010000'                                02S0908 03365000
         BNZ   @DC00908                                         02S0908 03366000
*     IF UCBTYP(3:4)=DEV3036&       /* DEVICE WITH POWER ALARM? 02S0909 03367000
*                                                            @G51APSS*/ 03368000
*         UCBONLI='1'B&             /* DEVICE ONLINE?        @G51APSS*/ 03369000
*         UCBALOC='0'B&             /* DEVICE UNALLOCATED?   @G51APSS*/ 03370000
*         UCBVHRSN='0'B&            /* HAS AN I/O PATH?      @G51APSS*/ 03371000
*         UCBNRY='0'B&              /* DEVICE IS READY?      @ZA18885*/ 03372000
*         UCMDISPK='0'B THEN        /* NOT A JES3 CONSOLE?   @G51APSS*/ 03373000
         L     @11,UCBPTR(,UCMDVEPT)                            02S0909 03374000
         CLC   UCBTYP+2(2,@11),@CB00339                         02S0909 03375000
         BNE   @RF00909                                         02S0909 03376000
         TM    UCBONLI(@11),B'10000000'                         02S0909 03377000
         BNO   @RF00909                                         02S0909 03378000
         TM    UCBALOC(@11),B'00001000'                         02S0909 03379000
         BNZ   @RF00909                                         02S0909 03380000
         TM    UCBVHRSN(@11),B'00000010'                        02S0909 03381000
         BNZ   @RF00909                                         02S0909 03382000
         TM    UCBNRY(@11),B'01000000'                          02S0909 03383000
         BNZ   @RF00909                                         02S0909 03384000
         TM    UCMDISPK(UCMDVEPT),B'00100000'                   02S0909 03385000
         BNZ   @RF00909                                         02S0909 03386000
*       DO;                         /* YES TO ALL OF ABOVE   @G51APSS*/ 03387000
*         PWRCONS=UCMDVEPT;         /* UCME ADDR OF CONSOLE  @G51APSS*/ 03388000
         ST    UCMDVEPT,PWRCONS                                 02S0911 03389000
*         RINGPOWR=YES;             /* SOUND POWER ALARM     @G51APSS*/ 03390000
         OI    RINGPOWR,B'00100000'                             02S0912 03391000
*         IF BELLCONS^=PWRCONS THEN /* SAME DEVICE AS THE ONE WHOSE     03392000
*                                      CONSOLE ALARM IS TO BE RUNG?     03393000
*                                                            @G51APSS*/ 03394000
         L     @11,PWRCONS                                      02S0913 03395000
         C     @11,BELLCONS                                     02S0913 03396000
         BE    @RF00913                                         02S0913 03397000
*           FOUND=YES;              /* NO, OK TO USE THIS DEVICE.       03398000
*                                      STOP SEARCHING.       @G51APSS*/ 03399000
         OI    FOUND,B'00010000'                                02S0914 03400000
*       END;                        /*                       @G51APSS*/ 03401000
@RF00913 DS    0H                                               02S0916 03402000
*   END;                            /* OF LOOP TO FIND CONSOLE WITH A   03403000
*                                      POWER ALARM           @G51APSS*/ 03404000
@RF00909 AL    UCMDVEPT,UCMVEZ(,UCMBASPT)                       02S0916 03405000
@DE00908 C     UCMDVEPT,UCMVEL(,UCMBASPT)                       02S0916 03406000
         BNH   @DL00908                                         02S0916 03407000
@DC00908 DS    0H                                               02S0917 03408000
*   END FNDPOWER;                   /*                       @G51APSS*/ 03409000
@EL00008 DS    0H                                               02S0917 03410000
@EF00008 DS    0H                                               02S0917 03411000
@ER00008 LM    @14,@12,12(@13)                                  02S0917 03412000
         BR    @14                                              02S0917 03413000
*/*** END OF FNDPOWER SUBROUTINE *************************************/ 03414000
*                                                               02S0918 03415000
         EJECT                                                          03416000
*                                                               02S0918 03417000
*/*** START OF SETOSW SUBROUTINE *************************************/ 03418000
*/*                                                                  */ 03419000
*/* SETOSW - TRANSFERS CONSOLE FUNCTIONS FROM THE OLD TO THE NEW     */ 03420000
*/*    CONSOLE.                                                      */ 03421000
*/*                                                                  */ 03422000
*/* FUNCTION - ADDS AUTHORITY & ROUTCODES OF OLD CONSOLE TO NEW,     */ 03423000
*/*    ADJUSTS MASTER INDICATORS WHEN OLD/NEW CONSOLE IS THE MASTER. */ 03424000
*/*                                                                  */ 03425000
*/* INPUT - FAILI = UCME ADDR OF INPUT HALF OF OLD CONSOLE           */ 03426000
*/*         FAILO = UCME ADDR OF OUTPUTHALF OF OLD CONSOLE OR 0      */ 03427000
*/*         NEWI  = UCME ADDR OF INPUT HALF OF NEW CONSOLE           */ 03428000
*/*         NEWO  = UCME ADDR OF OUTPUTHALF OF NEW CONSOLE OR 0      */ 03429000
*/*         MASTERI = UCME ADDR OF INPUT HALF OF MASTER              */ 03430000
*/*                                                                  */ 03431000
*/* OUTPUT - UCMSYSM = 1 IF FAILING CONS IS COMPOSITE                */ 03432000
*/*          UCMSYSK = 1 IF NEW CONS IS COMPOSITE                    */ 03433000
*/*          UCMMCENT = UCME ADDR OF NEW MASTER IF MASTER IS FAILING */ 03434000
*/*          UCMDISPA SET IN NEW/OLD MASTER                          */ 03435000
*/*          FAILO = FAILI IF FAILING IS NOT COMPOSITE               */ 03436000
*/*          NEWO = NEWI IF NEW IS NOT COMPOSITE                     */ 03437000
*/*                                                                  */ 03438000
*/********************************************************************/ 03439000
*                                                               02S0918 03440000
*SETOSW:                                                        02S0918 03441000
*   PROC OPTIONS(SAVE(REG14),NOSAVEAREA);                       02S0918 03442000
SETOSW   ST    @14,12(,@13)                                     02S0918 03443000
*   CALL CLEARDVC;                  /* CLEAR DEVICE TESTED FLAGS     */ 03444000
         BAL   @14,CLEARDVC                                     02S0919 03445000
*   IF FAILO=ZERO THEN              /* IF FAILING CONSOLE IS NOT A      03446000
*                                      COMPOSITE                     */ 03447000
         ICM   @11,15,FAILO                                     02S0920 03448000
         BNZ   @RF00920                                         02S0920 03449000
*     FAILO=FAILI;                  /* MAKE OUTPUT HALF UCME ADDR       03450000
*                                      SAME AS INPUT HALF            */ 03451000
         MVC   FAILO(4),FAILI                                   02S0921 03452000
*   IF NEWO=ZERO THEN               /* IF NEW CONSOLE IS NOT A  02S0922 03453000
*                                      COMPOSITE                     */ 03454000
@RF00920 ICM   @11,15,NEWO                                      02S0922 03455000
         BNZ   @RF00922                                         02S0922 03456000
*     NEWO=NEWI;                    /* MAKE OUTPUT HALF UCME ADDR       03457000
*                                      SAME AS INPUT HALF            */ 03458000
         ST    NEWI,NEWO                                        02S0923 03459000
*   NEWI->UCMAUTH=NEWI->UCMAUTH|FAILI->UCMAUTH;/* ADD AUTHORITY OF      03460000
*                                      FAILING CONSOLE TO NEW CONSOLE*/ 03461000
@RF00922 L     @11,FAILI                                        02S0924 03462000
         OC    UCMAUTH(2,NEWI),UCMAUTH(@11)                     02S0924 03463000
*   IF FAILI=MASTERI THEN           /* IS MASTER FAILING             */ 03464000
         C     @11,MASTERI                                      02S0925 03465000
         BNE   @RF00925                                         02S0925 03466000
*     DO;                           /* YES, ADJUST MASTER INDICATERS */ 03467000
*       MSTSWTCH='1'B;              /* SET MASTER FAILING FLAG FOR      03468000
*                                      SUB-SYSTEM INTERFACE. @ZA03626*/ 03469000
         OI    MSTSWTCH,B'00001000'                             02S0927 03470000
*       FAILI->UCMDISPA='0'B;       /* TURN OFF MASTER FLAG IN  02S0928 03471000
*                                      FAILING CONS                  */ 03472000
         NI    UCMDISPA(@11),B'01111111'                        02S0928 03473000
*       NEWI->UCMDISPA='1'B;        /* TURN ON MASTER FLAG IN NEW       03474000
*                                      CONS                          */ 03475000
         OI    UCMDISPA(NEWI),B'10000000'                       02S0929 03476000
*       UCMMCENT=NEWI;              /* STORE PTR TO NEW MASTER       */ 03477000
         ST    NEWI,UCMMCENT(,UCMMCSPT)                         02S0930 03478000
*     END;                                                      02S0931 03479000
*   NEWO->UCMRTCD=NEWO->UCMRTCD|FAILO->UCMRTCD;/* ADD FAILING CONS      03480000
*                                      ROUTCODES TO NEW CONSOLE      */ 03481000
@RF00925 L     @11,NEWO                                         02S0932 03482000
         L     @04,FAILO                                        02S0932 03483000
         OC    UCMRTCD(2,@11),UCMRTCD(@04)                      02S0932 03484000
*   END;                                                        02S0933 03485000
*                                                               02S0933 03486000
@EL00009 DS    0H                                               02S0933 03487000
@EF00009 DS    0H                                               02S0933 03488000
@ER00009 L     @14,12(,@13)                                     02S0933 03489000
         BR    @14                                              02S0933 03490000
*/*** END OF SETOSW SUBROUTINE ***************************************/ 03491000
*                                                               02S0934 03492000
         EJECT                                                          03493000
*                                                               02S0934 03494000
*/*** START OF STATMSG SUBROUTINE ************************************/ 03495000
*/*                                                                  */ 03496000
*/* STATMSG - ISSUES A MSG INDICATING THE STATUS OF THE NEW CONSOLE  */ 03497000
*/*                                                                  */ 03498000
*/* FUNCTION - GETS TWO WQES.  CONSTRUCTS MSG IEE143I INDICATING THE */ 03499000
*/*    STATUS OF THE NEW CONSOLE.  QUEUES THE WQES TO THE SYSTEM     */ 03500000
*/*    OUTPUT QUEUE.  CALLS IEECMENQ (IN IEAVMWSV) TO QUEUE THE      */ 03501000
*/*    MESSAGES TO THE NEW CONSOLE.                                  */ 03502000
*/*                                                                  */ 03503000
*/* INPUT - FAILI = UCME ADDR OF INPUT HALF OF OLD CONSOLE           */ 03504000
*/*         FAILO = UCME ADDR OF OUTPUTHALF OF OLD CONSOLE OR FAILI  */ 03505000
*/*         NEWI =  UCME ADDR OF INPUT HALF OF NEW CONSOLE           */ 03506000
*/*         NEWO =  UCME ADDR OF OUTPUTHALF OF NEW CONSOLE OR NEWI   */ 03507000
*/*                                                                  */ 03508000
*/* OUTPUT - UCMWTOQ - UPDATED IF NEEDED WHEN WQES ARE QUEUED        */ 03509000
*/*          UCMWQEND - UPDATED WHEN WQES ARE QUEUED                 */ 03510000
*/*                                                                  */ 03511000
*/********************************************************************/ 03512000
*                                                               02S0934 03513000
*STATMSG:                                                       02S0934 03514000
*   PROC OPTIONS(SAVE(REG14));                                  02S0934 03515000
STATMSG  ST    @14,@SA00010                                     02S0934 03516000
*   CALL GETWQE;                    /* GO OBTAIN A WQE               */ 03517000
         BAL   @14,GETWQE                                       02S0935 03518000
*   IF MSGPTR^=ONE                  /* TEST FOR SUSSCESSFUL GETWQE   */ 03519000
*     THEN                          /* IF SUCCESSFUL                 */ 03520000
         L     @11,MSGPTR                                       02S0936 03521000
         CH    @11,@CH00055                                     02S0936 03522000
         BE    @RF00936                                         02S0936 03523000
*     DO;                           /* PROCEDE                       */ 03524000
*       MSG143P1=MSGPTR;            /* SET BASE FOR 1ST HALF 143I    */ 03525000
         LR    MSG143P1,@11                                     02S0938 03526000
*       MSGPTR=ZERO;                /* CLEAR PTR                     */ 03527000
         SLR   @11,@11                                          02S0939 03528000
         ST    @11,MSGPTR                                       02S0939 03529000
*       CALL GETWQE;                /* GET 2ND WQE                   */ 03530000
         BAL   @14,GETWQE                                       02S0940 03531000
*       IF MSGPTR^=ONE              /* TEST FOR SUCCESSFUL GETWQE    */ 03532000
*         THEN                      /* IF SUCCESSFUL                 */ 03533000
         L     @11,MSGPTR                                       02S0941 03534000
         CH    @11,@CH00055                                     02S0941 03535000
         BE    @RF00941                                         02S0941 03536000
*         DO;                       /* PROCEDE                       */ 03537000
*           MSG143P2=MSGPTR;        /* BASE 2ND HALF 143I            */ 03538000
         ST    @11,MSG143P2                                     02S0943 03539000
*           MSGPTR=ZERO;            /* CLEAR PTR                     */ 03540000
         SLR   @11,@11                                          02S0944 03541000
         ST    @11,MSGPTR                                       02S0944 03542000
*           WQEPTR=MSG143P1;        /* BASE WQE FOR 1ST MSG          */ 03543000
         LR    WQEPTR,MSG143P1                                  02S0945 03544000
*           WQETXT=MSG143T1;        /* MOVE TEXT TO MESSAGE          */ 03545000
         MVI   WQETXT+67(WQEPTR),C' '                           02S0946 03546000
         MVC   WQETXT+68(60,WQEPTR),WQETXT+67(WQEPTR)           02S0946 03547000
         MVC   WQETXT(67,WQEPTR),@CC00136                       02S0946 03548000
*           IF FAILI=FAILO          /* TEST FOR COMPOSITE CONS       */ 03549000
*             THEN                  /* IF CONSOLE NON-COMPOSITE      */ 03550000
         L     @11,FAILI                                        02S0947 03551000
         C     @11,FAILO                                        02S0947 03552000
         BNE   @RF00947                                         02S0947 03553000
*             OLDNOCP=FAILI->UCMUCB->UCBNAME;/* OLD ID               */ 03554000
         L     @11,UCMUCB(,@11)                                 02S0948 03555000
         MVC   OLDNOCP(3,WQEPTR),UCBNAME(@11)                   02S0948 03556000
*           ELSE                                                02S0949 03557000
*             DO;                   /* IF CONSOLE WAS A COMPOSIT     */ 03558000
         B     @RC00947                                         02S0949 03559000
@RF00947 DS    0H                                               02S0950 03560000
*               OLDCP=COMPOSIT;     /* MOVE IN COMPOSITE HEADER      */ 03561000
         MVC   OLDCP(11,WQEPTR),@CC00101                        02S0950 03562000
*               OLDINID=FAILI->UCMUCB->UCBNAME;/* INPUT ID           */ 03563000
         L     @11,FAILI                                        02S0951 03564000
         L     @11,UCMUCB(,@11)                                 02S0951 03565000
         MVC   OLDINID(3,WQEPTR),UCBNAME(@11)                   02S0951 03566000
*               OLDOUTID=FAILO->UCMUCB->UCBNAME;/* OUTPT ID          */ 03567000
         L     @11,FAILO                                        02S0952 03568000
         L     @11,UCMUCB(,@11)                                 02S0952 03569000
         MVC   OLDOUTID(3,WQEPTR),UCBNAME(@11)                  02S0952 03570000
*             END;                  /* END COMPOSIT PROCESSING       */ 03571000
*           IF NEWI=NEWO            /* TEST FOR A COMPOSITE CONS     */ 03572000
*             THEN                  /* IF NOT COMPOSITE 1 NAME       */ 03573000
@RC00947 C     NEWI,NEWO                                        02S0954 03574000
         BNE   @RF00954                                         02S0954 03575000
*             NEWNOCP=NEWI->UCMUCB->UCBNAME;/* NEW ID                */ 03576000
         L     @11,UCMUCB(,NEWI)                                02S0955 03577000
         MVC   NEWNOCP(3,WQEPTR),UCBNAME(@11)                   02S0955 03578000
*           ELSE                                                02S0956 03579000
*             DO;                   /* IF COMPOSITE, 2 UCBNAMES      */ 03580000
         B     @RC00954                                         02S0956 03581000
@RF00954 DS    0H                                               02S0957 03582000
*               NEWCP=COMPOSIT;     /* MOVE IN COMPOSITE HDR         */ 03583000
         MVC   NEWCP(11,WQEPTR),@CC00101                        02S0957 03584000
*               NEWINID=NEWI->UCMUCB->UCBNAME;/* INPUT ID            */ 03585000
         L     @11,UCMUCB(,NEWI)                                02S0958 03586000
         MVC   NEWINID(3,WQEPTR),UCBNAME(@11)                   02S0958 03587000
*               NEWOUTID=NEWO->UCMUCB->UCBNAME;/* OUTPT ID           */ 03588000
         L     @11,NEWO                                         02S0959 03589000
         L     @11,UCMUCB(,@11)                                 02S0959 03590000
         MVC   NEWOUTID(3,WQEPTR),UCBNAME(@11)                  02S0959 03591000
*             END;                  /* END COMPOSITE PROCESSING      */ 03592000
*/* OLD AND NEW CONSOLE NAMES (DEVICE ADDRESSES) HAVE BEEN INSERTED  */ 03593000
*                                                               02S0961 03594000
*           /*********************************************************/ 03595000
*           /*                                                       */ 03596000
*           /* ANALYZE COMMAND AUTHORITY.                            */ 03597000
*           /*                                                       */ 03598000
*           /*********************************************************/ 03599000
*                                                               02S0961 03600000
*           IF NEWI->UCMDISPD=YES   /* IS NEW CONSOLE OUTPUT ONLY    */ 03601000
*             THEN                                              02S0961 03602000
@RC00954 TM    UCMDISPD(NEWI),B'00010000'                       02S0961 03603000
         BNO   @RF00961                                         02S0961 03604000
*             CMDS=NONE;            /* IF OUTPUT ONLY, CMDS=NONE     */ 03605000
         MVI   CMDS+4(WQEPTR),C' '                              02S0962 03606000
         MVC   CMDS+5(13,WQEPTR),CMDS+4(WQEPTR)                 02S0962 03607000
         MVC   CMDS(4,WQEPTR),@CC00087                          02S0962 03608000
*           ELSE                                                02S0963 03609000
*             DO;                   /* IF NEW CONSOLE FULL CAP       */ 03610000
         B     @RC00961                                         02S0963 03611000
@RF00961 DS    0H                                               02S0964 03612000
*               IF NEWI->UCMAUTH1='1'B&/* IF AUTHORIZED FOR SYS,     */ 03613000
*                   NEWI->UCMAUTH2='1'B&/* AND I/O,                  */ 03614000
*                   NEWI->UCMAUTH3='1'B/* AND CONS,                  */ 03615000
*                 THEN                                          02S0964 03616000
         TM    UCMAUTH1(NEWI),B'11100000'                       02S0964 03617000
         BNO   @RF00964                                         02S0964 03618000
*                 CMDS=ALL;         /* THEN PUT 'ALL' IN MSG.        */ 03619000
         MVI   CMDS+3(WQEPTR),C' '                              02S0965 03620000
         MVC   CMDS+4(14,WQEPTR),CMDS+3(WQEPTR)                 02S0965 03621000
         MVC   CMDS(3,WQEPTR),@CC00090                          02S0965 03622000
*               ELSE                                            02S0966 03623000
*                 DO;               /* IF NOT ALL, ANALYZE MORE      */ 03624000
         B     @RC00964                                         02S0966 03625000
@RF00964 DS    0H                                               02S0967 03626000
*                   X=ONE;          /* SET SUBSTRING OFFSET TO 1     */ 03627000
         LA    X,1                                              02S0967 03628000
*                   CMDS=C3;        /* MOVE DEFAULT OF 'INFO' IN     */ 03629000
         MVI   CMDS+4(WQEPTR),C' '                              02S0968 03630000
         MVC   CMDS+5(13,WQEPTR),CMDS+4(WQEPTR)                 02S0968 03631000
         MVC   CMDS(4,WQEPTR),@CC00092                          02S0968 03632000
*                   X=X+LENGTH(C3); /* INCREMENT SUBSTRING OFFSET    */ 03633000
         LA    @15,4                                            02S0969 03634000
         ALR   X,@15                                            02S0969 03635000
*                   IF NEWI->UCMAUTH1='1'B/* IF AUTHORIZED FOR SYS   */ 03636000
*                     THEN                                      02S0970 03637000
         TM    UCMAUTH1(NEWI),B'10000000'                       02S0970 03638000
         BNO   @RF00970                                         02S0970 03639000
*                     DO;           /* THE MOVE 'SYS' INTO MSG       */ 03640000
*                       CMDS(X:X+LENGTH(C4)-1)=C4;/* MOVE 'SYS'      */ 03641000
         LR    @01,WQEPTR                                       02S0972 03642000
         ALR   @01,X                                            02S0972 03643000
         MVC   CMDS-1(4,@01),@CC00094                           02S0972 03644000
*                       X=X+LENGTH(C3);/* INCREMENT SUBSTRING OFFSET */ 03645000
         ALR   X,@15                                            02S0973 03646000
*                     END;                                      02S0974 03647000
*                   IF NEWI->UCMAUTH2='1'B/* TEST AUTH FOR I/O       */ 03648000
*                     THEN                                      02S0975 03649000
@RF00970 TM    UCMAUTH2(NEWI),B'01000000'                       02S0975 03650000
         BNO   @RF00975                                         02S0975 03651000
*                     DO;           /* IF AUTHORIZED MOVE I/O IN     */ 03652000
*                       CMDS(X:X+LENGTH(C5)-1)=C5;/* MOVE IN 'I/O'   */ 03653000
         LR    @01,WQEPTR                                       02S0977 03654000
         ALR   @01,X                                            02S0977 03655000
         MVC   CMDS-1(4,@01),@CC00096                           02S0977 03656000
*                       X=X+LENGTH(C5);/* INCREMENT SUBSTRING OFFS   */ 03657000
         AL    X,@CF00065                                       02S0978 03658000
*                     END;                                      02S0979 03659000
*                   IF NEWI->UCMAUTH3='1'B/* TEST AUTH FOR CONS      */ 03660000
*                     THEN                                      02S0980 03661000
@RF00975 TM    UCMAUTH3(NEWI),B'00100000'                       02S0980 03662000
         BNO   @RF00980                                         02S0980 03663000
*                     DO;           /* IF AUTH, MOVE CONS TO MSG     */ 03664000
*                       CMDS(X:X+LENGTH(C6)-1)=C6;/* MOVE IN 'CONS'  */ 03665000
         LR    @01,WQEPTR                                       02S0982 03666000
         ALR   @01,X                                            02S0982 03667000
         MVC   CMDS-1(5,@01),@CC00098                           02S0982 03668000
*                       X=X+LENGTH(C6);/* INCREMENT SUBSTRING OFS    */ 03669000
         AH    X,@CH00035                                       02S0983 03670000
*                     END;                                      02S0984 03671000
*                 END;                                          02S0985 03672000
@RF00980 DS    0H                                               02S0986 03673000
*             END;                                              02S0986 03674000
*                                                               02S0986 03675000
@RC00964 DS    0H                                               02S0987 03676000
*/* THE FIRST MSG OF IEE143I IS COMPLETE, NOW COMPLETE THE WQE       */ 03677000
*                                                               02S0987 03678000
*           WQENBR=LENGTH(MSG143T1);/* SET TEXT LENGTH               */ 03679000
@RC00961 MVC   WQENBR(4,WQEPTR),@CF00135                        02S0987 03680000
*           WQEUCMID=NEWO->UCMID;   /* PLACE CONSOLE ID IN WQE       */ 03681000
         L     @11,NEWO                                         02S0988 03682000
         MVC   WQEUCMID(1,WQEPTR),UCMID(@11)                    02S0988 03683000
*/********************************************************************/ 03684000
*/*                                                                  */ 03685000
*/*  CALL THE WQE BUILD ROUTINE TO INITIALIZE THE REMAINING FIELDS   */ 03686000
*/*  IN THE WQE.                                                     */ 03687000
*/*                                                                  */ 03688000
*/********************************************************************/ 03689000
*                                                               02S0989 03690000
*           CALL BUILDWQE;          /* GO TO SUBROUTINE FOR WQE'S    */ 03691000
         BAL   @14,BUILDWQE                                     02S0989 03692000
*/* NOW SET UP TEXT OF SECOND HALF OF IEE143I                        */ 03693000
*                                                               02S0990 03694000
*           WQEPTR=MSG143P2;        /* RESET MESSAGE PTR             */ 03695000
         L     WQEPTR,MSG143P2                                  02S0990 03696000
*           WQENBR=LENGTH(MSG143T2);/* SET WQE LENGTH FOR 2ND HAF    */ 03697000
         MVC   WQENBR(4,WQEPTR),@CF00142                        02S0991 03698000
*           WQETXT=MSG143T2;        /* MOVE IN MSG TEXT              */ 03699000
         MVI   WQETXT+71(WQEPTR),C' '                           02S0992 03700000
         MVC   WQETXT+72(56,WQEPTR),WQETXT+71(WQEPTR)           02S0992 03701000
         MVC   WQETXT(71,WQEPTR),@CC00143                       02S0992 03702000
*           WQEUCMID=NEWO->UCMID;   /* PLACE CONSOLE ID IN WQE       */ 03703000
         L     @11,NEWO                                         02S0993 03704000
         MVC   WQEUCMID(1,WQEPTR),UCMID(@11)                    02S0993 03705000
*           IF NEWO->UCMRTCD=ALLR   /* IF ALL ROUTE CODES,           */ 03706000
*             THEN                                              02S0994 03707000
         CLC   UCMRTCD(2,@11),@CB00072                          02S0994 03708000
         BNE   @RF00994                                         02S0994 03709000
*             ROUTCDES=ALL;         /* JUST PUT 'ALL' IN MSG         */ 03710000
         MVI   ROUTCDES+3(WQEPTR),C' '                          02S0995 03711000
         MVC   ROUTCDES+4(42,WQEPTR),ROUTCDES+3(WQEPTR)         02S0995 03712000
         MVC   ROUTCDES(3,WQEPTR),@CC00090                      02S0995 03713000
*           ELSE                                                02S0996 03714000
*             IF NEWO->UCMRTCD=ZERO /* IF NOT ALL, IS IT NONE        */ 03715000
*               THEN                                            02S0996 03716000
         B     @RC00994                                         02S0996 03717000
@RF00994 L     @11,NEWO                                         02S0996 03718000
         ICM   @15,3,UCMRTCD(@11)                               02S0996 03719000
         BNZ   @RF00996                                         02S0996 03720000
*               ROUTCDES=NONE;      /* IF NONE, PUT 'NONE' IN MSG    */ 03721000
         MVI   ROUTCDES+4(WQEPTR),C' '                          02S0997 03722000
         MVC   ROUTCDES+5(41,WQEPTR),ROUTCDES+4(WQEPTR)         02S0997 03723000
         MVC   ROUTCDES(4,WQEPTR),@CC00087                      02S0997 03724000
*             ELSE                                              02S0998 03725000
*               DO;                 /* MIXTURE OF ROUTCODES          */ 03726000
*                                                               02S0998 03727000
         B     @RC00996                                         02S0998 03728000
@RF00996 DS    0H                                               02S0999 03729000
*                 /***************************************************/ 03730000
*                 /*                                                 */ 03731000
*                 /* THE ROUTE CODE FIELD OF THE NEW CONSOLE MUST BE */ 03732000
*                 /* ANALYZED AND THE INFORMATION PLACED IN THE      */ 03733000
*                 /* MESSAGE.                                        */ 03734000
*                 /*                                                 */ 03735000
*                 /***************************************************/ 03736000
*                                                               02S0999 03737000
*                 RFY                                           02S0999 03738000
*                  (REG01,                                      02S0999 03739000
*                   REG01F) RSTD;                               02S0999 03740000
*                 REG01F=NEWO->UCMRTCD;/* GET A COPY OF THE RTE CDE  */ 03741000
         L     @15,NEWO                                         02S1000 03742000
         SLR   REG01F,REG01F                                    02S1000 03743000
         ICM   REG01F,3,UCMRTCD(@15)                            02S1000 03744000
*                 SLL(REG01F,16);   /* MOVE TO LEFT OF REGISTER      */ 03745000
         SLL   REG01F,16                                        02S1001 03746000
*                 MSGTXTPT=ADDR(ROUTCDES);/* POINT TO NEXT SPACE IN     03747000
*                                      MSG                           */ 03748000
         LA    MSGTXTPT,ROUTCDES(,WQEPTR)                       02S1002 03749000
*                 DO I=1 TO 15 BY 1;/* LOOP THRU ALL 15 ROUTE CDES   */ 03750000
         LA    @00,1                                            02S1003 03751000
         ST    @00,I                                            02S1003 03752000
@DL01003 DS    0H                                               02S1004 03753000
*                   IF REG01F<0     /* IF NEG, ROUTCDE PRESENT       */ 03754000
*                     THEN          /* PROCESS                       */ 03755000
         LTR   REG01F,REG01F                                    02S1004 03756000
         BNM   @RF01004                                         02S1004 03757000
*                     DO;           /* FOR ROUT FOR ROUTCDE          */ 03758000
*                       RV(1:3)=RCTBL(I);/* MOVE ROUTE CODE TO MSG   */ 03759000
         LA    @15,3                                            02S1006 03760000
         ST    @15,@TF00001                                     02S1006 03761000
         LR    @15,@00                                          02S1006 03762000
         M     @14,@TF00001                                     02S1006 03763000
         LA    @14,RCTBL-3(@15)                                 02S1006 03764000
         MVC   RV(3,MSGTXTPT),0(@14)                            02S1006 03765000
*                       MSGTXTPT=MSGTXTPT+3;/* BUMP PTR TO NEXT SPACE*/ 03766000
         AL    MSGTXTPT,@TF00001                                02S1007 03767000
*                     END;                                      02S1008 03768000
*                   SLL(REG01F,1);  /* SHIFT TO NEXT ROUTE CODE      */ 03769000
@RF01004 SLL   REG01F,1                                         02S1009 03770000
*                 END;                                          02S1010 03771000
         LA    @00,1                                            02S1010 03772000
         AL    @00,I                                            02S1010 03773000
         ST    @00,I                                            02S1010 03774000
         CH    @00,@CH00078                                     02S1010 03775000
         BNH   @DL01003                                         02S1010 03776000
*                 RFY                                           02S1011 03777000
*                  (REG01,                                      02S1011 03778000
*                   REG01F) UNRSTD;                             02S1011 03779000
*               END;                /* END PROCESSING MIXTURE        */ 03780000
*                                                               02S1012 03781000
*           /*********************************************************/ 03782000
*           /*                                                       */ 03783000
*           /* NEXT SET CONSOLE TYPE IN MESSAGE                      */ 03784000
*           /*                                                       */ 03785000
*           /*********************************************************/ 03786000
*                                                               02S1013 03787000
*           IF NEWI->UCMDISPA='1'B  /* TEST WHETHER NEW IS MASTER    */ 03788000
*             THEN                                              02S1013 03789000
@RC00996 DS    0H                                               02S1013 03790000
@RC00994 TM    UCMDISPA(NEWI),B'10000000'                       02S1013 03791000
         BNO   @RF01013                                         02S1013 03792000
*             TYPE=M;               /* IF MASTER, SET TYPE TO 'M'    */ 03793000
         MVI   TYPE(WQEPTR),C'M'                                02S1014 03794000
*           ELSE                                                02S1015 03795000
*             TYPE=S;               /* IF NOT MASTER, 'S' SCNDRY     */ 03796000
*                                                               02S1015 03797000
         B     @RC01013                                         02S1015 03798000
@RF01013 MVI   TYPE(WQEPTR),C'S'                                02S1015 03799000
*           /*********************************************************/ 03800000
*           /*                                                       */ 03801000
*           /* LAST, PLACE CONSOLES HARDCOPY STATUS IN MESSAGE.      */ 03802000
*           /*                                                       */ 03803000
*           /*********************************************************/ 03804000
*                                                               02S1016 03805000
*           IF NEWO->UCMDISPB='1'B  /* TEST HARDCOPY STATUS  @ZA20164*/ 03806000
*             THEN                                              02S1016 03807000
@RC01013 L     @11,NEWO                                         02S1016 03808000
         TM    UCMDISPB(@11),B'01000000'                        02S1016 03809000
         BNO   @RF01016                                         02S1016 03810000
*             HCCHAR=Y;             /* 'Y' IF NEW IS HARDCOPY        */ 03811000
         MVI   HCCHAR(WQEPTR),C'Y'                              02S1017 03812000
*           ELSE                                                02S1018 03813000
*             HCCHAR=N;             /* 'N' IF NEW NOT HARDCOPY       */ 03814000
         B     @RC01016                                         02S1018 03815000
@RF01016 MVI   HCCHAR(WQEPTR),C'N'                              02S1018 03816000
*/********************************************************************/ 03817000
*/*                                                                  */ 03818000
*/*  THE SECOND HALF OF MESSAGE IEE143I IS COMPLETE, NOW             */ 03819000
*/*  CALL THE WQE BUILD ROUTINE TO INITIALIZE THE REMAINING FIELDS   */ 03820000
*/*  IN THE WQE.                                                     */ 03821000
*/*                                                                  */ 03822000
*/********************************************************************/ 03823000
*                                                               02S1019 03824000
*           CALL BUILDWQE;          /* GO TO SUBROUTINE FOR WQE'S    */ 03825000
*                                                               02S1019 03826000
@RC01016 BAL   @14,BUILDWQE                                     02S1019 03827000
*           /*********************************************************/ 03828000
*           /*                                                       */ 03829000
*           /* BOTH PARTS OF MESSAGE IEE143I ARE COMPLETE. INDICATE  */ 03830000
*           /* THIS TO THE SUBSYSTEM AND THEN SET INDICATORS SO COMM */ 03831000
*           /* TASK WILL QUEUE THE MESSAGE TO THE APPROPRIATE        */ 03832000
*           /* CONSOLE. OUTPUT PENDING(UCMSYSJ) IS SET ON AND POSTREQ*/ 03833000
*           /* IS SET ON SO THE WRAPUP SUBROUTINE WILL XMPOST        */ 03834000
*           /* UCMOECB.                                      @ZA18877*/ 03835000
*           /*                                                       */ 03836000
*           /*********************************************************/ 03837000
*                                                               02S1020 03838000
*           WQEPTR=MSG143P1;        /* SET UP TO QUEUE FIRST MSG     */ 03839000
         LR    WQEPTR,MSG143P1                                  02S1020 03840000
*           CALL SUBEXIT;           /* INFORM SUBSYSTEM OF 1ST PART     03841000
*                                      OF MSG IEE143I        @ZA18877*/ 03842000
         BAL   @14,SUBEXIT                                      02S1021 03843000
*           WQEPTR=MSG143P2;        /* SET UP TO QUEUE 2ND MSG       */ 03844000
         L     WQEPTR,MSG143P2                                  02S1022 03845000
*           CALL SUBEXIT;           /* INFORM SUBSYSTEM OF 2ND PART     03846000
*                                      OF MSG IEE143I        @ZA18877*/ 03847000
         BAL   @14,SUBEXIT                                      02S1023 03848000
*           CALL SUBSWTCH;          /* NOTIFY SUBSYSTEM,CONS SWITCH     03849000
*                                                            @ZA03626*/ 03850000
         BAL   @14,SUBSWTCH                                     02S1024 03851000
*           POSTREQ='1'B;           /* XMPOST REQUIRED TO INSURE        03852000
*                                      COMTASK GETS CONTROL  @ZA00530*/ 03853000
         OI    POSTREQ,B'00000010'                              02S1025 03854000
*           UCMSYSJ='1'B;           /* OUTPUT PENDING        @ZA00530*/ 03855000
         OI    UCMSYSJ(UCMMCSPT),B'01000000'                    02S1026 03856000
*         END;                      /* END DO IF WQES GOTTEN         */ 03857000
*       ELSE                        /* ELSE FOR 2ND GETWQE TEST      */ 03858000
*         DO;                       /* IF 2ND GETWQE FAILS, FREE THE    03859000
*                                      FIRST ONE                     */ 03860000
         B     @RC00941                                         02S1028 03861000
@RF00941 DS    0H                                               02S1029 03862000
*/********************************************************************/ 03863000
*/*                                                                  */ 03864000
*/*  IF ONLY ONE WQE WAS OBTAINED, DEQUEUE IT, FREE IT, AND DONT     */ 03865000
*/*  ISSUE THE MESSAGE.                                              */ 03866000
*/*                                                                  */ 03867000
*/********************************************************************/ 03868000
*                                                               02S1029 03869000
*           RFY                                                 02S1029 03870000
*            (REG00,                                            02S1029 03871000
*             REG01,                                            02S1029 03872000
*             REG15) RSTD;                                      02S1029 03873000
*                                                               02S1029 03874000
*           /*********************************************************/ 03875000
*           /*                                                       */ 03876000
*           /* DEQUEUE THE WQE.                                      */ 03877000
*           /*                                                       */ 03878000
*           /*********************************************************/ 03879000
*                                                               02S1030 03880000
*           REG00=ADDR(UCMWTOQ);    /* START OF WQE QUEUE.           */ 03881000
         LA    REG00,UCMWTOQ(,UCMBASPT)                         02S1030 03882000
*           REG01=UCMWTOQ;          /* ADDR OF FIRST WQE ON QUEUE.   */ 03883000
         L     REG01,UCMWTOQ(,UCMBASPT)                         02S1031 03884000
*           DO WHILE REG01^=MSG143P1;/* DO UNTIL WE READ END OF Q    */ 03885000
         B     @DE01032                                         02S1032 03886000
@DL01032 DS    0H                                               02S1033 03887000
*             REG00=REG01;          /* SAVE PTR TO LAST ENTRY        */ 03888000
         LR    REG00,REG01                                      02S1033 03889000
*             REG01=REG01->WQELKPA; /* PICK UP PTR TO NEXT WQE       */ 03890000
         SLR   @14,@14                                          02S1034 03891000
         ICM   @14,7,WQELKPA(REG01)                             02S1034 03892000
         LR    REG01,@14                                        02S1034 03893000
*           END;                    /* LOOP BBACK AND DO AGAIN       */ 03894000
@DE01032 CR    REG01,MSG143P1                                   02S1035 03895000
         BNE   @DL01032                                         02S1035 03896000
*           IF REG01=UCMWTOQ        /* IF THIS WQE IS THE ONLY ONE   */ 03897000
*             THEN                                              02S1036 03898000
         C     REG01,UCMWTOQ(,UCMBASPT)                         02S1036 03899000
         BNE   @RF01036                                         02S1036 03900000
*             DO;                   /* THEN PROCESS SPECIAL          */ 03901000
*               UCMWTOQ=ZERO;       /* ZERO PTR TO FIRST WQE (Q HEAD)*/ 03902000
         SLR   @14,@14                                          02S1038 03903000
         ST    @14,UCMWTOQ(,UCMBASPT)                           02S1038 03904000
*               UCMWQEND=ZERO;      /* ZERO PTR TO LAST WQE          */ 03905000
         ST    @14,UCMWQEND(,UCMBASPT)                          02S1039 03906000
*             END;                  /* END OF SPECIAL PROCESSING     */ 03907000
*           ELSE                                                02S1041 03908000
*             DO;                   /* IF WQE WAS NOT THE ONLY ONE   */ 03909000
         B     @RC01036                                         02S1041 03910000
@RF01036 DS    0H                                               02S1042 03911000
*               REG00->WQELKPA=ZERO;/* ZERO LINK PTR IN 2ND LAST WQE */ 03912000
         LR    @14,REG00                                        02S1042 03913000
         SLR   @11,@11                                          02S1042 03914000
         STCM  @11,7,WQELKPA(@14)                               02S1042 03915000
*               UCMWQEND=REG00;     /* CHANGE UCM PTR TO LAST WQE    */ 03916000
         ST    REG00,UCMWQEND(,UCMBASPT)                        02S1043 03917000
*             END;                  /* END OF NORMAL PROCESSING      */ 03918000
*           REG01=MSG143P1;         /* GET ADDR OF WQE               */ 03919000
@RC01036 LR    REG01,MSG143P1                                   02S1045 03920000
*           REG00=UCMWQECP;         /* GET CELL POOL ID              */ 03921000
*                                                               02S1046 03922000
         L     REG00,UCMWQECP(,UCMBASPT)                        02S1046 03923000
*           /*********************************************************/ 03924000
*           /*                                                       */ 03925000
*           /* FREE THE WQE                                          */ 03926000
*           /*                                                       */ 03927000
*           /*********************************************************/ 03928000
*                                                               02S1047 03929000
*           GEN(FREECELL CPID=(0),CELL=(1),BRANCH=YES)          02S1047 03930000
*           REFS(REG00,REG01,CVTFRECL) SETS(REG00,REG01,REG15); 02S1047 03931000
*                                                               02S1047 03932000
         FREECELL CPID=(0),CELL=(1),BRANCH=YES                          03933000
*           /*********************************************************/ 03934000
*           /*                                                       */ 03935000
*           /* IF THE WQE WAS THE LAST IN A CELL POOL EXTENSION, FREE*/ 03936000
*           /* THE EXTENSION. THIS IS INDICATED BY A RETURN CODE OF  */ 03937000
*           /* 20 IN REGISTER 15. REGISTERS 0 AND 1 WILL BE SET UP   */ 03938000
*           /* FOR A FREEMAIN IF ONE IS NEEDED.                      */ 03939000
*           /*                                                       */ 03940000
*           /*********************************************************/ 03941000
*                                                               02S1048 03942000
*           IF REG15=20             /* TEST RETURN CODE FOR 20       */ 03943000
*             THEN                  /* IF RC=20 FREE CELLPOOL EXTEN  */ 03944000
         CH    REG15,@CH00069                                   02S1048 03945000
         BNE   @RF01048                                         02S1048 03946000
*             GEN(FREEMAIN  R,LV=(0),A=(1),BRANCH=YES)          02S1049 03947000
*             REFS(REG00,REG01,CVTRMBR,CVTMAP,CVTPTR) SETS(REG01,REG14, 03948000
*                 REG15);                                       02S1049 03949000
         FREEMAIN  R,LV=(0),A=(1),BRANCH=YES                            03950000
*           RFY                                                 02S1050 03951000
*            (REG00,                                            02S1050 03952000
*             REG01,                                            02S1050 03953000
*             REG15) UNRSTD;                                    02S1050 03954000
@RF01048 DS    0H                                               02S1051 03955000
*           UCMWQNR=UCMWQNR-1;      /* DECREMENT WQE COUNT           */ 03956000
         LH    @11,UCMWQNR(,UCMBASPT)                           02S1051 03957000
         BCTR  @11,0                                            02S1051 03958000
         STH   @11,UCMWQNR(,UCMBASPT)                           02S1051 03959000
*         END;                      /* END DO FOR 2ND GETWQE FAIL    */ 03960000
*     END;                          /* END PROCESSING FOR WQES       */ 03961000
*                                                               02S1053 03962000
*   /*****************************************************************/ 03963000
*   /*                                                               */ 03964000
*   /* IF THE GETWQE FOR THE FIRST WQE FAILED, GO ON PROCESSING      */ 03965000
*   /* WITHOUT ISSUING MESSAGES.                                     */ 03966000
*   /*                                                               */ 03967000
*   /*****************************************************************/ 03968000
*                                                               02S1054 03969000
*   END STATMSG;                                                02S1054 03970000
*                                                               02S1054 03971000
@EL00010 DS    0H                                               02S1054 03972000
@EF00010 DS    0H                                               02S1054 03973000
@ER00010 L     @14,@SA00010                                     02S1054 03974000
         BR    @14                                              02S1054 03975000
*/*** END OF STATMSG SEGMENT *****************************************/ 03976000
*                                                               02S1055 03977000
         EJECT                                                          03978000
*                                                               02S1055 03979000
*/*** START OF SOUNDBEL SUBROUTINE ***********************************/ 03980000
*/*                                                                  */ 03981000
*/* SOUNDBEL - SOUND A CONSOLE'S ALARM 3 TIMES               @G51APSS*/ 03982000
*/*                                                                  */ 03983000
*/* INPUT    - UCMSYSL = ON IF OPEN-TO-RING IS IN PROGRESS   @G51APSS*/ 03984000
*/*            BELLCONS = UCME ADDRESS OF DEVICE WITH BELL   @G51APSS*/ 03985000
*/*                       TO RING                            @G51APSS*/ 03986000
*/*                                                                  */ 03987000
*/* OUTPUT   - THE CONSOLE'S ALARM SHOULD RING THREE TIMES   @G51APSS*/ 03988000
*/*                                                                  */ 03989000
*/********************************************************************/ 03990000
*                                                               02S1055 03991000
*SOUNDBEL:                                                      02S1055 03992000
*   PROC OPTIONS(SAVE);             /*                       @G51APSS*/ 03993000
SOUNDBEL STM   @14,@12,@SA00011                                 02S1055 03994000
*   DCL                                                         02S1056 03995000
*     DEVOPN1 LABEL GENERATED STATIC LOCAL;/*                @ZA18882*/ 03996000
*   DCL                                                         02S1057 03997000
*     DEVOPN2 LABEL GENERATED STATIC LOCAL;/*                @ZA18882*/ 03998000
*   RFY                                                         02S1058 03999000
*     UCMLIST BASED(BELLCONS);      /* BASE UCME ON DEVICE WITH BELL    04000000
*                                      TO RING               @G51APSS*/ 04001000
*                                                               02S1058 04002000
*   /*****************************************************************/ 04003000
*   /*                                                               */ 04004000
*   /* IF OPEN-TO-RING IS ON THEN DON'T SOUND THE ALARM. THE DSP HAS */ 04005000
*   /* ALREADY RECEIVED CONTROL TO OPEN THE DEVICE TO SOUND THE ALARM*/ 04006000
*   /* AND HAS HAD A PROBLEM SO DON'T TRY TO OPEN THE DEVICE AGAIN.  */ 04007000
*   /*                                                       @G51APSS*/ 04008000
*   /*                                                               */ 04009000
*   /*****************************************************************/ 04010000
*                                                               02S1059 04011000
*   IF UCMSYSL='1'B THEN            /* OPEN-TO-RING IN PROGRESS?        04012000
*                                                            @G51APSS*/ 04013000
         TM    UCMSYSL(UCMMCSPT),B'00010000'                    02S1059 04014000
         BNO   @RF01059                                         02S1059 04015000
*     RINGBELL=NO;                  /* YES, DON'T RING BELL  @G51APSS*/ 04016000
         NI    RINGBELL,B'10111111'                             02S1060 04017000
*   ELSE                            /* TRY TO OPEN DEVICE    @G51APSS*/ 04018000
*     DO;                           /*                       @G51APSS*/ 04019000
         B     @RC01059                                         02S1061 04020000
@RF01059 DS    0H                                               02S1062 04021000
*       IF UCMDCB^=ZERO THEN        /* DOES DEVICE HAVE A DCB?  02S1062 04022000
*                                                            @G51APSS*/ 04023000
         L     @04,BELLCONS                                     02S1062 04024000
         L     @04,UCMDCB(,@04)                                 02S1062 04025000
         LTR   @04,@04                                          02S1062 04026000
         BZ    @RF01062                                         02S1062 04027000
*         DO;                       /* YES, SEE IF DEVICE IS OPEN       04028000
*                                                            @ZA18882*/ 04029000
*           RFY                                                 02S1064 04030000
*             REG10 RSTD;           /*                       @ZA18882*/ 04031000
*           REG10=UCMDCB;           /* ADDR OF DCB           @ZA18882*/ 04032000
         LR    REG10,@04                                        02S1065 04033000
*           GEN REFS(IHADCB,REG10,DCBOFLGS)/* RINGBELL IS    @ZA18882*/ 04034000
*               SETS(RINGBELL)      /* SET OFF IF DEVICE IS NOT 02S1066 04035000
*                                                            @ZA18882*/ 04036000
*               DEFS(DEVOPN1);                                  02S1066 04037000
*                             /* OPEN                        @ZA18882*/ 04038000
         USING IHADCB,REG10       ADDRESSABILITY TO DCB        @ZA18882 04039000
         TM    DCBOFLGS,DCBOFOPN  DEVICE OPEN                  @ZA18882 04040000
         BO    DEVOPN1            YES THEN BRANCH              @ZA18882 04041000
         NI    RINGBELL,B'10111111' DO NOT RING BELL. THIS INSTR MUST  X04042000
                                  BE CHANGED IF RINGBELL IS MOVED      X04043000
                                  (RE-DECLARED).               @ZA18882 04044000
DEVOPN1  EQU   *                                               @ZA18882 04045000
         DROP REG10                                            @ZA18882 04046000
*           RFY                                                 02S1067 04047000
*             REG10 UNRSTD;         /*                       @ZA18882*/ 04048000
*         END;                      /*                       @ZA18882*/ 04049000
*       ELSE                        /* DEVICE IS NOT OPEN SO TRY TO     04050000
*                                      OPEN IT               @G51APSS*/ 04051000
*         DO;                                                   02S1069 04052000
         B     @RC01062                                         02S1069 04053000
@RF01062 DS    0H                                               02S1070 04054000
*           UCMSYSL='1'B;           /* INDICATE OPEN TO RING BELL IN    04055000
*                                      PROGRESS              @G51APSS*/ 04056000
         OI    UCMSYSL(UCMMCSPT),B'00010000'                    02S1070 04057000
*           IF UCBSYSR='0'B THEN    /* IS THE DEVICE ALLOCATED AS A     04058000
*                                      CONSOLE?              @G51APSS*/ 04059000
         L     @04,BELLCONS                                     02S1071 04060000
         L     @04,UCBPTR(,@04)                                 02S1071 04061000
         TM    UCBSYSR(@04),B'00000010'                         02S1071 04062000
         BNZ   @RF01071                                         02S1071 04063000
*             DO;                   /* NO                    @G51APSS*/ 04064000
*               CALL ENQQ4;         /* TRY TO OBTAIN Q4      @G51APSS*/ 04065000
         BAL   @14,ENQQ4                                        02S1073 04066000
*               IF HAVEQ4=YES THEN  /* WAS Q4 OBTAINED?      @G51APSS*/ 04067000
         TM    HAVEQ4,B'00010000'                               02S1074 04068000
         BNO   @RF01074                                         02S1074 04069000
*                 DO;               /* YES                   @G51APSS*/ 04070000
*                   IF UCBALOC='0'B THEN/* DEVICE UNALLOCATED?  02S1076 04071000
*                                                            @G51APSS*/ 04072000
         L     @04,BELLCONS                                     02S1076 04073000
         L     @04,UCBPTR(,@04)                                 02S1076 04074000
         TM    UCBALOC(@04),B'00001000'                         02S1076 04075000
         BNZ   @RF01076                                         02S1076 04076000
*                     DO;                                       02S1077 04077000
*                       UCBSYSRX='1'B;/* MAKE DEVICE A CONSOLE       */ 04078000
         L     @15,UCBSYSRX-3(,@04)                             02S1078 04079000
@GL00067 LR    @14,@15                                          02S1078 04080000
         O     @14,@CF03988                                     02S1078 04081000
         CS    @15,@14,UCBSYSRX-3(@04)                          02S1078 04082000
         BNE   @GL00067                                         02S1078 04083000
*                       IF BELLCONS^=PWRCONS THEN/* SOUND ALARMS ON     04084000
*                                      DIFFERENT DEVICES?    @G51APSS*/ 04085000
         L     @04,BELLCONS                                     02S1079 04086000
         C     @04,PWRCONS                                      02S1079 04087000
         BE    @RF01079                                         02S1079 04088000
*                         DO;       /* YES                   @G51APSS*/ 04089000
*                           UCBCHGSX='1'B;/* DEVICE TO GO OFFLINE       04090000
*                                      AFTER RING                    */ 04091000
*                           UCBDADIX='1'B;/* DEVICE GOING OUT OF CONS   04092000
*                                      STATUS                        */ 04093000
         L     @04,UCBPTR(,@04)                                 02S1082 04094000
         L     @15,UCBCHGSX-3(,@04)                             02S1082 04095000
@GL00068 LR    @14,@15                                          02S1082 04096000
         O     @14,@CF03963                                     02S1082 04097000
         CS    @15,@14,UCBCHGSX-3(@04)                          02S1082 04098000
         BNE   @GL00068                                         02S1082 04099000
*                         END;      /*                       @G51APSS*/ 04100000
*                     END;                                      02S1084 04101000
*                   ELSE            /* IF ALLOCATED, DONT TAKE DEVICE*/ 04102000
*                     RINGBELL=NO;  /* TURN OFF RING-BELL-NEEDED FLAG*/ 04103000
         B     @RC01076                                         02S1085 04104000
@RF01076 NI    RINGBELL,B'10111111'                             02S1085 04105000
*                   CALL DEQQ4;     /* RELEASE Q4            @G51APSS*/ 04106000
@RC01076 BAL   @14,DEQQ4                                        02S1086 04107000
*                 END;                                          02S1087 04108000
*               ELSE                /* ENQ RETURN CODE NON-ZERO      */ 04109000
*                 RINGBELL=NO;      /* TURN OFF RING-BELL-NEEDED FLAG*/ 04110000
         B     @RC01074                                         02S1088 04111000
@RF01074 NI    RINGBELL,B'10111111'                             02S1088 04112000
*             END;                  /* END OF DO FOR UCMSYSR=OFF     */ 04113000
@RC01074 DS    0H                                               02S1090 04114000
*           IF RINGBELL=YES THEN    /* SHOULD BELL BE RUNG?          */ 04115000
@RF01071 TM    RINGBELL,B'01000000'                             02S1090 04116000
         BNO   @RF01090                                         02S1090 04117000
*             DO;                   /* YES                   @G51APSS*/ 04118000
*               UCMTA='1'B;         /* INDICATE OPEN PENDING @G51APSS*/ 04119000
*               UCMCF='0'B;         /* MARK NOT CLOSE PENDING   02S1093 04120000
*                                                            @ZA18886*/ 04121000
         L     @04,BELLCONS                                     02S1093 04122000
         OI    UCMTA(@04),B'00001000'                           02S1093 04123000
         NI    UCMCF(@04),B'11101111'                           02S1093 04124000
*               CALL CALLDSP(BELLCONS,CSAOPEN);/* GO OPEN DEVICE TO     04125000
*                                      SOUND ALARM           @G51APSS*/ 04126000
         LA    @04,BELLCONS                                     02S1094 04127000
         ST    @04,@AL00001                                     02S1094 04128000
         LA    @04,@CH00060+1                                   02S1094 04129000
         ST    @04,@AL00001+4                                   02S1094 04130000
         LA    @01,@AL00001                                     02S1094 04131000
         BAL   @14,CALLDSP                                      02S1094 04132000
*               IF UCMDCB=ZERO THEN /* DCB OBTAINED?         @ZA18882*/ 04133000
         L     @04,BELLCONS                                     02S1095 04134000
         ICM   @15,15,UCMDCB(@04)                               02S1095 04135000
         BNZ   @RF01095                                         02S1095 04136000
*                 RINGBELL=NO;      /* NO, DEVICE NOT OPEN. DON'T       04137000
*                                      RING BELL             @ZA18882*/ 04138000
         NI    RINGBELL,B'10111111'                             02S1096 04139000
*               ELSE                /*                       @ZA18882*/ 04140000
*                 DO;               /* YES, SEE IF DEVICE IS OPEN       04141000
*                                                            @ZA18882*/ 04142000
         B     @RC01095                                         02S1097 04143000
@RF01095 DS    0H                                               02S1098 04144000
*                   RFY                                         02S1098 04145000
*                     REG10 RSTD;   /*                       @ZA18882*/ 04146000
*                   REG10=UCMDCB;   /* ADDR OF DCB           @ZA18882*/ 04147000
         L     @04,BELLCONS                                     02S1099 04148000
         L     REG10,UCMDCB(,@04)                               02S1099 04149000
*                   GEN REFS(IHADCB,REG10,DCBOFLGS)/* SET RINGBELL      04150000
*                                                            @ZA18882*/ 04151000
*                       SETS(RINGBELL)/* OFF IF DEVICE       @ZA18882*/ 04152000
*                       DEFS(DEVOPN2);                          02S1100 04153000
*                                          /* IS NOT OPEN    @ZA18882*/ 04154000
         USING IHADCB,REG10       ADDRESSABILITY TO DCB        @ZA18882 04155000
         TM    DCBOFLGS,DCBOFOPN  DEVICE OPEN                  @ZA18882 04156000
         BO    DEVOPN2            YES THEN BRANCH              @ZA18882 04157000
         NI    RINGBELL,B'10111111' DO NOT RING BELL. THIS INSTR MUST  X04158000
                                  BE CHANGED IF RINGBELL IS MOVED      X04159000
                                  (RE-DECLARED).               @ZA18882 04160000
DEVOPN2  EQU   *                                               @ZA18882 04161000
         DROP REG10                                            @ZA18882 04162000
*                   RFY                                         02S1101 04163000
*                     REG10 UNRSTD; /*                       @ZA18882*/ 04164000
*                 END;              /*                       @ZA18882*/ 04165000
*               IF BELLCONS^=PWRCONS|/* SOUND ALARMS OF DIFFERENT       04166000
*                                      DEVICES? OR           @G51APSS*/ 04167000
*                   RINGBELL=NO THEN/* DEVICE NOT OPEN?      @G51APSS*/ 04168000
@RC01095 CLC   BELLCONS(4),PWRCONS                              02S1103 04169000
         BNE   @RT01103                                         02S1103 04170000
         TM    RINGBELL,B'01000000'                             02S1103 04171000
         BNZ   @RF01103                                         02S1103 04172000
@RT01103 DS    0H                                               02S1104 04173000
*                 DO;               /* YES                   @G51APSS*/ 04174000
*                   UCMTA='0'B;     /* TURN OFF OPEN PENDING @ZA18886*/ 04175000
*                   UCMCF='1'B;     /* TURN ON CLOSE PENDING @G51APSS*/ 04176000
         L     @04,BELLCONS                                     02S1106 04177000
         OI    UCMCF(@04),B'00010000'                           02S1106 04178000
         NI    UCMTA(@04),B'11110111'                           02S1106 04179000
*                 END;              /*                       @G51APSS*/ 04180000
*               IF RINGBELL=NO THEN /* DEVICE OPENED?        @G51APSS*/ 04181000
@RF01103 TM    RINGBELL,B'01000000'                             02S1108 04182000
         BNZ   @RF01108                                         02S1108 04183000
*                 CALL CALLDSP(BELLCONS,CSACLOSE);/* NO, GO TO DSP TO   04184000
*                                      CLOSE DEVICE          @G51APSS*/ 04185000
         LA    @04,BELLCONS                                     02S1109 04186000
         ST    @04,@AL00001                                     02S1109 04187000
         LA    @04,@CH00065+1                                   02S1109 04188000
         ST    @04,@AL00001+4                                   02S1109 04189000
         LA    @01,@AL00001                                     02S1109 04190000
         BAL   @14,CALLDSP                                      02S1109 04191000
*               ELSE                /*                       @G51APSS*/ 04192000
*                 CLOSEBEL=YES;     /* CLOSE DEVICE LATER    @G51APSS*/ 04193000
         B     @RC01108                                         02S1110 04194000
@RF01108 OI    CLOSEBEL,B'00100000'                             02S1110 04195000
*             END;                                              02S1111 04196000
@RC01108 DS    0H                                               02S1112 04197000
*           UCMSYSL='0'B;           /* TURN OFF OPEN TO RING BELL       04198000
*                                      FLAG                          */ 04199000
@RF01090 NI    UCMSYSL(UCMMCSPT),B'11101111'                    02S1112 04200000
*         END;                                                  02S1113 04201000
*     END;                          /* OF TRY TO OPEN DEVICE @G51APSS*/ 04202000
@RC01062 DS    0H                                               02S1115 04203000
*   IF RINGBELL=YES THEN            /* STILL RING BELL?      @G51APSS*/ 04204000
@RC01059 TM    RINGBELL,B'01000000'                             02S1115 04205000
         BNO   @RF01115                                         02S1115 04206000
*     DO;                           /* YES                   @G51APSS*/ 04207000
*       CALL FRLOCKS;               /* FREE THE CMS AND LOCAL LOCKS  */ 04208000
         BAL   @14,FRLOCKS                                      02S1117 04209000
*       CALL BELLEXCP(BELL);        /* RING CONSOLE'S BELL   @G51APSS*/ 04210000
         LA    @01,@AL01118                                     02S1118 04211000
         BAL   @14,BELLEXCP                                     02S1118 04212000
*       CALL GETLOCKS;              /* OBTAIN THE LOCKS      @G51APSS*/ 04213000
         BAL   @14,GETLOCKS                                     02S1119 04214000
*       IF CLOSEBEL=YES&            /* SHOULD DEVICE BE CLOSED? AND     04215000
*                                                            @G51APSS*/ 04216000
*           BELLCONS^=PWRCONS THEN  /* SOUND ALARMS ON DIFFERENT        04217000
*                                      DEVICES?              @G51APSS*/ 04218000
         TM    CLOSEBEL,B'00100000'                             02S1120 04219000
         BNO   @RF01120                                         02S1120 04220000
         CLC   BELLCONS(4),PWRCONS                              02S1120 04221000
         BE    @RF01120                                         02S1120 04222000
*         DO;                       /* YES, CLOSE DEVICE     @G51APSS*/ 04223000
*           UCMSYSL='1'B;           /* MARK GOING TO DSP FOR ALARM      04224000
*                                                            @G51APSS*/ 04225000
         OI    UCMSYSL(UCMMCSPT),B'00010000'                    02S1122 04226000
*           CALL CALLDSP(BELLCONS,CSACLOSE);/* GO TO DSP TO CLOSE       04227000
*                                      DEVICE                @G51APSS*/ 04228000
         LA    @04,BELLCONS                                     02S1123 04229000
         ST    @04,@AL00001                                     02S1123 04230000
         LA    @04,@CH00065+1                                   02S1123 04231000
         ST    @04,@AL00001+4                                   02S1123 04232000
         LA    @01,@AL00001                                     02S1123 04233000
         BAL   @14,CALLDSP                                      02S1123 04234000
*           UCMSYSL='0'B;           /* BACK FROM DSP         @G51APSS*/ 04235000
         NI    UCMSYSL(UCMMCSPT),B'11101111'                    02S1124 04236000
*           CLOSEBEL='0'B;          /* DEVICE CLOSED         @G51APSS*/ 04237000
         NI    CLOSEBEL,B'11011111'                             02S1125 04238000
*         END;                      /*                       @G51APSS*/ 04239000
*     END;                                                      02S1127 04240000
*   RFY                                                         02S1128 04241000
*     UCMLIST BASED(UCMDVEPT);      /* RESET BASE FOR UCME   @G51APSS*/ 04242000
*   END SOUNDBEL;                   /*                       @G51APSS*/ 04243000
@EL00011 DS    0H                                               02S1129 04244000
@EF00011 DS    0H                                               02S1129 04245000
@ER00011 LM    @14,@12,@SA00011                                 02S1129 04246000
         BR    @14                                              02S1129 04247000
*/*** END OF SOUNDBEL SUBROUTINE *************************************/ 04248000
*                                                               02S1130 04249000
         EJECT                                                          04250000
*                                                               02S1130 04251000
*/*** START OF SOUNDPWR SUBROUTINE************************************/ 04252000
*/*                                                                  */ 04253000
*/* SOUNDPWR - SOUND THE POWER AND COOLING ALARM 3 TIMES     @G51APSS*/ 04254000
*/*                                                                  */ 04255000
*/* INPUT    - UCMSYSP = ON IF OPEN-TO-SOUND-POWER-ALARM WAS @G51APSS*/ 04256000
*/*                      ALREADY IN PROCESS                  @G51APSS*/ 04257000
*/*            PWRCONS = UCME ADDRESS OF DEVICE TO SOUND     @G51APSS*/ 04258000
*/*                      POWER ALARM ON                      @G51APSS*/ 04259000
*/* OUTPUT   - THE POWER ALARM WILL BE SOUNDED               @G51APSS*/ 04260000
*/*            3 TIMES                                       @G51APSS*/ 04261000
*/*                                                                  */ 04262000
*/********************************************************************/ 04263000
*                                                               02S1130 04264000
*SOUNDPWR:                                                      02S1130 04265000
*   PROC OPTIONS(SAVE);             /*                       @G51APSS*/ 04266000
SOUNDPWR STM   @14,@12,@SA00012                                 02S1130 04267000
*   DCL                                                         02S1131 04268000
*     DEVOPN3 LABEL GENERATED STATIC LOCAL;/*                @ZA18882*/ 04269000
*   DCL                                                         02S1132 04270000
*     DEVOPN4 LABEL GENERATED STATIC LOCAL;/*                @ZA18882*/ 04271000
*   RFY                                                         02S1133 04272000
*     UCMLIST BASED(PWRCONS);       /* BASE UCME ON DEVICE TO SOUND     04273000
*                                      POWER ALARM           @G51APSS*/ 04274000
*                                                               02S1133 04275000
*   /*****************************************************************/ 04276000
*   /*                                                               */ 04277000
*   /* IF OPEN-TO-SOUND-POWER-ALARM IS ON THEN DON'T SOUND THE ALARM.*/ 04278000
*   /* THE DSP HAS ALREADY RECEIVED CONTROL TO OPEN THE DEVICE TO    */ 04279000
*   /* SOUND THE POWER ALARM AND HAS HAD A PROBLEM SO DON'T TRY TO   */ 04280000
*   /* OPEN THE DEVICE AGAIN.                                @G51APSS*/ 04281000
*   /*                                                               */ 04282000
*   /*****************************************************************/ 04283000
*                                                               02S1134 04284000
*   IF UCMSYSP='1'B THEN            /* OPEN-TO-SOUND-POWER-ALARM IN     04285000
*                                      PROGRESS?             @G51APSS*/ 04286000
         TM    UCMSYSP(UCMMCSPT),B'00000001'                    02S1134 04287000
         BNO   @RF01134                                         02S1134 04288000
*     RINGPOWR=NO;                  /* YES, DON'T SOUND POWER ALARM     04289000
*                                                            @G51APSS*/ 04290000
         NI    RINGPOWR,B'11011111'                             02S1135 04291000
*   ELSE                            /* OK TO TRY AND SOUND POWER        04292000
*                                      ALARM                 @G51APSS*/ 04293000
*     DO;                           /*                       @G51APSS*/ 04294000
         B     @RC01134                                         02S1136 04295000
@RF01134 DS    0H                                               02S1137 04296000
*       IF UCMDCB^=ZERO THEN        /* DOES DEVICE HAVE A DCB?  02S1137 04297000
*                                                            @G51APSS*/ 04298000
         L     @04,PWRCONS                                      02S1137 04299000
         L     @04,UCMDCB(,@04)                                 02S1137 04300000
         LTR   @04,@04                                          02S1137 04301000
         BZ    @RF01137                                         02S1137 04302000
*         DO;                       /* YES, SEE IF DEVICE IS OPEN       04303000
*                                                            @ZA18882*/ 04304000
*           RFY                                                 02S1139 04305000
*             REG10 RSTD;           /*                       @ZA18882*/ 04306000
*           REG10=UCMDCB;           /* ADDR OF DCB           @ZA18882*/ 04307000
         LR    REG10,@04                                        02S1140 04308000
*           GEN REFS(IHADCB,REG10,DCBOFLGS)/* SET RINGPOWR   @ZA18882*/ 04309000
*               SETS(RINGPOWR)      /* OFF IF DEVICE         @ZA18882*/ 04310000
*               DEFS(DEVOPN3);                                  02S1141 04311000
*                                          /* IS NOT OPEN   @ZA18882*/  04312000
         USING IHADCB,REG10        ADDRESSABILITY TO DCB       @ZA18882 04313000
         TM    DCBOFLGS,DCBOFOPN   DEVICE OPEN                 @ZA18882 04314000
         BO    DEVOPN3             YES, THEN BRANCH            @ZA18882 04315000
         NI    RINGPOWR,B'11011111' DO NOT SOUND ALARM. THIS INSTR MUSTX04316000
                                  BE CHANGED IF RINGPOWR IS MOVED      X04317000
                                  (RE-DECLARED).               @ZA18882 04318000
DEVOPN3  EQU   *                                               @ZA18882 04319000
         DROP  REG10                                           @ZA18882 04320000
*           RFY                                                 02S1142 04321000
*             REG10 UNRSTD;         /*                       @ZA18882*/ 04322000
*         END;                      /*                       @ZA18882*/ 04323000
*       ELSE                        /* DEVICE IS NOT OPEN SO TRY TO     04324000
*                                      OPEN IT               @G51APSS*/ 04325000
*         DO;                       /*                               */ 04326000
         B     @RC01137                                         02S1144 04327000
@RF01137 DS    0H                                               02S1145 04328000
*           UCMSYSL='1'B;           /* NOTIFY DSP'S OF OPEN-TO RING     04329000
*                                      IN PROGRESS           @G51APSS*/ 04330000
*           UCMSYSP='1'B;           /* MARK OPEN-TO-SOUND-POWER ALARM   04331000
*                                      IN PROGRESS           @G51APSS*/ 04332000
         OI    UCMSYSL(UCMMCSPT),B'00010001'                    02S1146 04333000
*           IF UCBSYSR='0'B THEN    /* IS DEVICE ALREADY ALLOCATED AS   04334000
*                                      A CONSOLE?            @G51APSS*/ 04335000
         L     @04,PWRCONS                                      02S1147 04336000
         L     @04,UCBPTR(,@04)                                 02S1147 04337000
         TM    UCBSYSR(@04),B'00000010'                         02S1147 04338000
         BNZ   @RF01147                                         02S1147 04339000
*             DO;                   /* NO                    @G51APSS*/ 04340000
*               CALL ENQQ4;         /* TRY TO OBTAIN Q4      @G51APSS*/ 04341000
         BAL   @14,ENQQ4                                        02S1149 04342000
*               IF UCBALOC='0'B THEN/* IS DEVICE UNALLOCATED?   02S1150 04343000
*                                                            @G51APSS*/ 04344000
         L     @04,PWRCONS                                      02S1150 04345000
         L     @04,UCBPTR(,@04)                                 02S1150 04346000
         TM    UCBALOC(@04),B'00001000'                         02S1150 04347000
         BNZ   @RF01150                                         02S1150 04348000
*                 DO;               /* YES                   @G51APSS*/ 04349000
*                   UCBSYSRX='1'B;  /* MARK DEVICE A CONSOLE @G51APSS*/ 04350000
*                   UCBCHGSX='1'B;  /* DEVICE TO GO OFFLINE AFTER       04351000
*                                      ALARM                 @G51APSS*/ 04352000
*                   UCBDADIX='1'B;  /* DEVICE TO GO OUT OF CONSOLE      04353000
*                                      STATUS AFTER ALARM    @G51APSS*/ 04354000
         L     @15,UCBSYSRX-3(,@04)                             02S1154 04355000
@GL00071 LR    @14,@15                                          02S1154 04356000
         O     @14,@CF03991                                     02S1154 04357000
         CS    @15,@14,UCBSYSRX-3(@04)                          02S1154 04358000
         BNE   @GL00071                                         02S1154 04359000
*                 END;              /*                       @G51APSS*/ 04360000
*               ELSE                /* DON'T USE AN ALLOCATED DEVICE    04361000
*                                                            @G51APSS*/ 04362000
*                 RINGPOWR=NO;      /* DON'T SOUND ALARM     @G51APSS*/ 04363000
         B     @RC01150                                         02S1156 04364000
@RF01150 NI    RINGPOWR,B'11011111'                             02S1156 04365000
*               CALL DEQQ4;         /* RELEASE Q4            @G51APSS*/ 04366000
@RC01150 BAL   @14,DEQQ4                                        02S1157 04367000
*             END;                  /*                       @G51APSS*/ 04368000
*           IF RINGPOWR=YES THEN    /* STILL SOUND ALARM?    @G51APSS*/ 04369000
@RF01147 TM    RINGPOWR,B'00100000'                             02S1159 04370000
         BNO   @RF01159                                         02S1159 04371000
*             DO;                   /* YES                   @G51APSS*/ 04372000
*               UCMTA='1'B;         /* MARK OPEN PENDING     @G51APSS*/ 04373000
*               UCMCF='0'B;         /* MARK NOT CLOSE PENDING   02S1162 04374000
*                                                            @ZA18886*/ 04375000
         L     @04,PWRCONS                                      02S1162 04376000
         OI    UCMTA(@04),B'00001000'                           02S1162 04377000
         NI    UCMCF(@04),B'11101111'                           02S1162 04378000
*               CALL CALLDSP(PWRCONS,CSAOPEN);/* GO OPEN DEVICE TO      04379000
*                                      SOUND ALARM           @G51APSS*/ 04380000
         LA    @04,PWRCONS                                      02S1163 04381000
         ST    @04,@AL00001                                     02S1163 04382000
         LA    @04,@CH00060+1                                   02S1163 04383000
         ST    @04,@AL00001+4                                   02S1163 04384000
         LA    @01,@AL00001                                     02S1163 04385000
         BAL   @14,CALLDSP                                      02S1163 04386000
*               UCMTA='0'B;         /* TURN OFF OPEN PENDING @ZA18886*/ 04387000
*               UCMCF='1'B;         /* TURN ON CLOSE PENDING @G51APSS*/ 04388000
         L     @04,PWRCONS                                      02S1165 04389000
         OI    UCMCF(@04),B'00010000'                           02S1165 04390000
         NI    UCMTA(@04),B'11110111'                           02S1165 04391000
*               IF UCMDCB=ZERO THEN /* DCB OBTAINED?         @G51APSS*/ 04392000
         ICM   @15,15,UCMDCB(@04)                               02S1166 04393000
         BNZ   @RF01166                                         02S1166 04394000
*                 RINGPOWR=NO;      /* NO, DEVICE NOT OPEN. DON'T       04395000
*                                      SOUND ALARM           @G51APSS*/ 04396000
         NI    RINGPOWR,B'11011111'                             02S1167 04397000
*               ELSE                /*                               */ 04398000
*                 DO;               /* YES, SEE IF DEVICE IS OPEN       04399000
*                                                            @ZA18882*/ 04400000
         B     @RC01166                                         02S1168 04401000
@RF01166 DS    0H                                               02S1169 04402000
*                   RFY                                         02S1169 04403000
*                     REG10 RSTD;   /*                       @ZA18882*/ 04404000
*                   REG10=UCMDCB;   /* ADDR OF DCB           @ZA18882*/ 04405000
         L     @04,PWRCONS                                      02S1170 04406000
         L     REG10,UCMDCB(,@04)                               02S1170 04407000
*                   GEN REFS(IHADCB,REG10,DCBOFLGS)/* SET RINGPOWR      04408000
*                                                            @ZA18882*/ 04409000
*                       SETS(RINGPOWR)/* OFF IF DEVICE       @ZA18882*/ 04410000
*                       DEFS(DEVOPN4);                          02S1171 04411000
*                                          /* IS NOT OPEN    @ZA18882*/ 04412000
         USING IHADCB,REG10        ADDRESSABILITY TO DCB       @ZA18882 04413000
         TM    DCBOFLGS,DCBOFOPN   DEVICE OPEN                 @ZA18882 04414000
         BO    DEVOPN4             YES, THEN BRANCH            @ZA18882 04415000
         NI    RINGPOWR,B'11011111' DO NOT SOUND ALARM. THIS INSTR MUSTX04416000
                                  BE CHANGED IF RINGPOWR IS MOVED      X04417000
                                  (RE-DECLARED).               @ZA18882 04418000
DEVOPN4  EQU   *                                               @ZA18882 04419000
         DROP  REG10                                           @ZA18882 04420000
*                   RFY                                         02S1172 04421000
*                     REG10 UNRSTD; /*                       @ZA18882*/ 04422000
*                 END;              /*                       @ZA18882*/ 04423000
*               IF RINGPOWR=NO THEN /* DEVICE OPENED?        @G51APSS*/ 04424000
@RC01166 TM    RINGPOWR,B'00100000'                             02S1174 04425000
         BNZ   @RF01174                                         02S1174 04426000
*                 CALL CALLDSP(PWRCONS,CSACLOSE);/* NO, GO TO DSP TO    04427000
*                                      CLOSE DEVICE          @G51APSS*/ 04428000
         LA    @04,PWRCONS                                      02S1175 04429000
         ST    @04,@AL00001                                     02S1175 04430000
         LA    @04,@CH00065+1                                   02S1175 04431000
         ST    @04,@AL00001+4                                   02S1175 04432000
         LA    @01,@AL00001                                     02S1175 04433000
         BAL   @14,CALLDSP                                      02S1175 04434000
*               ELSE                                            02S1176 04435000
*                 CLOSEALR=YES;     /* CLOSE DEVICE LATER    @G51APSS*/ 04436000
         B     @RC01174                                         02S1176 04437000
@RF01174 OI    CLOSEALR,B'00010000'                             02S1176 04438000
*             END;                  /*                       @G51APSS*/ 04439000
@RC01174 DS    0H                                               02S1178 04440000
*           UCMSYSL='0'B;           /* FINISHED OPENING DEVICE  02S1178 04441000
*                                                            @G51APSS*/ 04442000
@RF01159 DS    0H                                               02S1179 04443000
*           UCMSYSP='0'B;           /*                       @G51APSS*/ 04444000
         NI    UCMSYSL(UCMMCSPT),B'11101110'                    02S1179 04445000
*         END;                      /* OF OPENING DEVICE     @G51APSS*/ 04446000
*     END;                          /* OF TRY TO SOUND ALARM @G51APSS*/ 04447000
@RC01137 DS    0H                                               02S1182 04448000
*   IF RINGPOWR=YES THEN            /* STILL SOUND ALARM?    @G51APSS*/ 04449000
@RC01134 TM    RINGPOWR,B'00100000'                             02S1182 04450000
         BNO   @RF01182                                         02S1182 04451000
*     DO;                           /* YES                   @G51APSS*/ 04452000
*       CALL FRLOCKS;               /* RELEASE THE LOCKS     @G51APSS*/ 04453000
         BAL   @14,FRLOCKS                                      02S1184 04454000
*       CALL BELLEXCP(POWER);       /* SOUND POWER ALARM     @G51APSS*/ 04455000
         LA    @01,@AL01185                                     02S1185 04456000
         BAL   @14,BELLEXCP                                     02S1185 04457000
*       CALL GETLOCKS;              /* OBTAIN THE LOCKS      @G51APSS*/ 04458000
         BAL   @14,GETLOCKS                                     02S1186 04459000
*       IF CLOSEBEL=YES|            /* CLOSE BELL DEVICE? OR @G51APSS*/ 04460000
*           CLOSEALR=YES THEN       /* CLOSE POWER ALARM DEVICE 02S1187 04461000
*                                                            @G51APSS*/ 04462000
         TM    CLOSEBEL,B'00110000'                             02S1187 04463000
         BZ    @RF01187                                         02S1187 04464000
*         DO;                       /* YES                   @G51APSS*/ 04465000
*           UCMSYSP='1'B;           /* ACCESS-TO-SOUND POWER ALARM IN   04466000
*                                      PROGRESS              @G51APSS*/ 04467000
*           UCMSYSL='1'B;           /*                       @G51APSS*/ 04468000
         OI    UCMSYSP(UCMMCSPT),B'00010001'                    02S1190 04469000
*           CALL CALLDSP(PWRCONS,CSACLOSE);/* GO TO DSP TO CLOSE        04470000
*                                      DEVICE                @G51APSS*/ 04471000
         LA    @04,PWRCONS                                      02S1191 04472000
         ST    @04,@AL00001                                     02S1191 04473000
         LA    @04,@CH00065+1                                   02S1191 04474000
         ST    @04,@AL00001+4                                   02S1191 04475000
         LA    @01,@AL00001                                     02S1191 04476000
         BAL   @14,CALLDSP                                      02S1191 04477000
*           UCMSYSP='0'B;           /* BACK FROM DSP         @G51APSS*/ 04478000
*           UCMSYSL='0'B;           /*                       @G51APSS*/ 04479000
         NI    UCMSYSP(UCMMCSPT),B'11101110'                    02S1193 04480000
*         END;                      /*                       @G51APSS*/ 04481000
*     END;                          /*                       @G51APSS*/ 04482000
*   RFY                                                         02S1196 04483000
*     UCMLIST BASED(UCMDVEPT);      /* RESET BASE FOR UCME   @G51APSS*/ 04484000
*   END SOUNDPWR;                   /*                       @G51APSS*/ 04485000
@EL00012 DS    0H                                               02S1197 04486000
@EF00012 DS    0H                                               02S1197 04487000
@ER00012 LM    @14,@12,@SA00012                                 02S1197 04488000
         BR    @14                                              02S1197 04489000
*/*** END OF SOUNDPWR SUBROUTINE *************************************/ 04490000
*                                                               02S1198 04491000
         EJECT                                                          04492000
*                                                               02S1198 04493000
*/*** START OF SAVEINDEX SUBROUTINE **********************************/ 04494000
*/*                                                                  */ 04495000
*/* SAVEINDX - FOR EVERY DEVICE WHICH CAN BECOME THE         @G51APSS*/ 04496000
*/*            CANDIDATE FOR THE NEW MASTER CONSOLE, SAVE    @G51APSS*/ 04497000
*/*            ITS ATTENTION INDEX AND REPLACE THE ATTENTION @G51APSS*/ 04498000
*/*            INDEX WITH A X'04' SO COMM TASKS ATTN HANDLER @G51APSS*/ 04499000
*/*            WILL RECEIVE CONTROL WHEN AN ATTN IS          @G51APSS*/ 04500000
*/*            GENERATED ON THE DEVICE. INSURE THAT THE      @G51APSS*/ 04501000
*/*            DEVICE HAS UCBSYSR ON SO ALLOCATION WILL NOT  @G51APSS*/ 04502000
*/*            TOUCH THIS DEVICE.                            @G51APSS*/ 04503000
*/*                                                                  */ 04504000
*/*            SERIALIZATION WITH ALLOCATION IS DONE BY      @G51APSS*/ 04505000
*/*            ENQING ON SYSIEFSD Q4 AND ALSO USING          @G51APSS*/ 04506000
*/*            COMPARE-AND-SWAP TO MANIPULATE BITS IN THE    @G51APSS*/ 04507000
*/*            UCB.                                          @G51APSS*/ 04508000
*/*                                                                  */ 04509000
*/* INPUT    - NONE                                          @G51APSS*/ 04510000
*/*                                                                  */ 04511000
*/* OUTPUT   _ UCMEFATT = SAVED ATTN INDEX                   @G51APSS*/ 04512000
*/*            UCMEFLGA = 1 IF ATTN INDEX WAS SAVED          @G51APSS*/ 04513000
*/*            UCBATI   = X'04' IF ATTN INDEX WAS SAVED      @G51APSS*/ 04514000
*/*            UCBSYSR  = 1 IF IT WAS NOT ALREADY ON         @G51APSS*/ 04515000
*/*            UCMEFLGB = 1 IF UCBSYSR WAS FORCED ON         @G51APSS*/ 04516000
*/*                                                                  */ 04517000
*/********************************************************************/ 04518000
*                                                               02S1198 04519000
*SAVEINDX:                                                      02S1198 04520000
*   PROC OPTIONS(SAVE);             /*                       @G51APSS*/ 04521000
SAVEINDX STM   @14,@12,@SA00013                                 02S1198 04522000
*   CALL ENQQ4;                     /* TRY TO OBTAIN Q4      @G51APSS*/ 04523000
         BAL   @14,ENQQ4                                        02S1199 04524000
*   DO UCMDVEPT=UCMVEA TO UCMVEL BY UCMVEZ;/* LOOP THRU UCMES   02S1200 04525000
*                                                            @G51APSS*/ 04526000
         L     UCMDVEPT,UCMVEA(,UCMBASPT)                       02S1200 04527000
         B     @DE01200                                         02S1200 04528000
@DL01200 DS    0H                                               02S1201 04529000
*     ACCEPT=YES;                   /* ASSUME ACCEPTANCE     @G51APSS*/ 04530000
         OI    ACCEPT,B'10000000'                               02S1201 04531000
*     IF UCMCOMPC^=ZERO&            /* A COMPOSITE AND       @G51APSS*/ 04532000
*         UCMIF='0'B THEN           /* THE OUTPUT HALF?      @G51APSS*/ 04533000
         ICM   @11,15,UCMCOMPC(UCMDVEPT)                        02S1202 04534000
         BZ    @RF01202                                         02S1202 04535000
         TM    UCMIF(UCMDVEPT),B'01000000'                      02S1202 04536000
         BNZ   @RF01202                                         02S1202 04537000
*       ACCEPT=NO;                  /* YES, REJECT DEVICE    @G51APSS*/ 04538000
         NI    ACCEPT,B'01111111'                               02S1203 04539000
*     ELSE                          /* DEVICE IS NOT A COMPOSITE OR     04540000
*                                      IT IS THE INPUT HALF  @G51APSS*/ 04541000
*       DO;                         /*                       @G51APSS*/ 04542000
         B     @RC01202                                         02S1204 04543000
@RF01202 DS    0H                                               02S1205 04544000
*         IF(UCMDISPD='1'B&UCMSDS5G='0'B)|/* HARDWARE OUTPUT ONLY OR    04545000
*                                                            @G51APSS*/ 04546000
*             UCMDISPK='1'B|        /* JES3 DEVICE OR        @G51APSS*/ 04547000
*             UCBALOC='1'B|         /* DEVICE IS ALLOCATED OR   02S1205 04548000
*                                                            @G51APSS*/ 04549000
*             UCB3COMM='1'B|        /* DEVICE IS A 2740 OR   @G51APSS*/ 04550000
*             UCBNALOC='1'B|        /* DEVICE IS NOT ALLOCATABLE OR     04551000
*                                                            @G51APSS*/ 04552000
*             UCMEFLGA='1'B THEN    /* ATTN INDEX HAS ALREADY BEEN      04553000
*                                      SAVED FOR THIS DEVICE @G51APSS*/ 04554000
         TM    UCMDISPD(UCMDVEPT),B'00010000'                   02S1205 04555000
         BNO   @GL00077                                         02S1205 04556000
         TM    UCMSDS5G(UCMDVEPT),B'00000010'                   02S1205 04557000
         BZ    @RT01205                                         02S1205 04558000
@GL00077 TM    UCMDISPK(UCMDVEPT),B'00100000'                   02S1205 04559000
         BO    @RT01205                                         02S1205 04560000
         L     @11,UCBPTR(,UCMDVEPT)                            02S1205 04561000
         TM    UCBALOC(@11),B'00001000'                         02S1205 04562000
         BO    @RT01205                                         02S1205 04563000
         TM    UCB3COMM(@11),B'01000000'                        02S1205 04564000
         BO    @RT01205                                         02S1205 04565000
         TM    UCBNALOC(@11),B'00000100'                        02S1205 04566000
         BO    @RT01205                                         02S1205 04567000
         L     @11,UCMFEXTP(,UCMDVEPT)                          02S1205 04568000
         TM    UCMEFLGA(@11),B'10000000'                        02S1205 04569000
         BNO   @RF01205                                         02S1205 04570000
@RT01205 DS    0H                                               02S1206 04571000
*           ACCEPT=NO;              /* YES TO ANY OF ABOVE THEN 02S1206 04572000
*                                      REJECT THE DEVICE     @G51APSS*/ 04573000
         NI    ACCEPT,B'01111111'                               02S1206 04574000
*         ELSE                      /* DEVICE OF SO FAR      @G51APSS*/ 04575000
*           IF UCMCOMPC^=ZERO&      /* IS IT A COMPOSITE AND @G51APSS*/ 04576000
*               (UCMCOMPC->UCMDISPK='1'B|/* OUTPUT HALF IS A JES3       04577000
*                                      DEVICE OR             @G51APSS*/ 04578000
*               UCMCOMPC->UCMUCB->UCBALOC='1'B|/* OUTPUT HALF IS        04579000
*                                      ALLOCATED OR          @G51APSS*/ 04580000
*               UCMCOMPC->UCMUCB->UCB3COMM='1'B|/* OUTPUT HALF IS A     04581000
*                                      2740 DEVICE OR        @G51APSS*/ 04582000
*               UCMCOMPC->UCMUCB->UCBNALOC='1'B|/* OUTPUT HALF IS NOT   04583000
*                                      ALLOCATABLE OR        @G51APSS*/ 04584000
*               UCMCOMPC->UCMFEXTP->UCMEFLGA='1'B) THEN/* OUTPUT        04585000
*                                      HALFS ATTN INDEX HAS BEEN        04586000
*                                      SAVED?                @G51APSS*/ 04587000
         B     @RC01205                                         02S1207 04588000
@RF01205 L     @11,UCMCOMPC(,UCMDVEPT)                          02S1207 04589000
         LTR   @11,@11                                          02S1207 04590000
         BZ    @RF01207                                         02S1207 04591000
         TM    UCMDISPK(@11),B'00100000'                        02S1207 04592000
         BO    @RT01207                                         02S1207 04593000
         L     @07,UCMUCB(,@11)                                 02S1207 04594000
         TM    UCBALOC(@07),B'00001000'                         02S1207 04595000
         BO    @RT01207                                         02S1207 04596000
         TM    UCB3COMM(@07),B'01000000'                        02S1207 04597000
         BO    @RT01207                                         02S1207 04598000
         TM    UCBNALOC(@07),B'00000100'                        02S1207 04599000
         BO    @RT01207                                         02S1207 04600000
         L     @11,UCMFEXTP(,@11)                               02S1207 04601000
         TM    UCMEFLGA(@11),B'10000000'                        02S1207 04602000
         BNO   @RF01207                                         02S1207 04603000
@RT01207 DS    0H                                               02S1208 04604000
*             ACCEPT=NO;            /* IF ANY OF ABOVE ARE TRUE THEN    04605000
*                                      REJECT THE DEVICE     @G51APSS*/ 04606000
         NI    ACCEPT,B'01111111'                               02S1208 04607000
*       END;                        /*                       @G51APSS*/ 04608000
@RF01207 DS    0H                                               02S1209 04609000
@RC01205 DS    0H                                               02S1210 04610000
*     IF ACCEPT=YES THEN            /* OK TO USE DEVICE?     @G51APSS*/ 04611000
@RC01202 TM    ACCEPT,B'10000000'                               02S1210 04612000
         BNO   @RF01210                                         02S1210 04613000
*       DO;                         /* YES                   @G51APSS*/ 04614000
*         UCMEFATT=UCBATI;          /* SAVE ATT INDEX. IF COMPOSITE     04615000
*                                      THEN ONLY INPUT HALFS IS SAVED   04616000
*                                                            @G51APSS*/ 04617000
         L     @11,UCMFEXTP(,UCMDVEPT)                          02S1212 04618000
         L     @07,UCBPTR(,UCMDVEPT)                            02S1212 04619000
         L     @04,UCBEXTPT(,@07)                               02S1212 04620000
         MVC   UCMEFATT(1,@11),UCBATI(@04)                      02S1212 04621000
*         UCMEFLGA='1'B;            /* MARK THAT ATT INDEX SAVED IS     04622000
*                                      VALID                 @G51APSS*/ 04623000
         OI    UCMEFLGA(@11),B'10000000'                        02S1213 04624000
*         UCBATI=COMTSKAX;          /* CHANGE ATTN INDEX SO COMM        04625000
*                                      TASKS ATTN HANDLER WILL  02S1214 04626000
*                                      RECEIVE CNTL IF AN ATTN IS       04627000
*                                      GENERATED ON THIS DEVICE 02S1214 04628000
*                                                            @G51APSS*/ 04629000
         MVI   UCBATI(@04),X'04'                                02S1214 04630000
*         IF UCBSYSR='0'B THEN      /* DEVICE MARKED AS CONSOLE?        04631000
*                                                            @G51APSS*/ 04632000
         TM    UCBSYSR(@07),B'00000010'                         02S1215 04633000
         BNZ   @RF01215                                         02S1215 04634000
*           DO;                     /* NO                    @G51APSS*/ 04635000
*             UCBSYSRX='1'B;        /* MARK AS A CONSOLE     @G51APSS*/ 04636000
         L     @11,UCBSYSRX-3(,@07)                             02S1217 04637000
@GL00084 LR    @04,@11                                          02S1217 04638000
         O     @04,@CF03988                                     02S1217 04639000
         CS    @11,@04,UCBSYSRX-3(@07)                          02S1217 04640000
         BNE   @GL00084                                         02S1217 04641000
*             UCMEFLGB='1'B;        /* MARK THAT UCBSYSR WAS FORCED     04642000
*                                      ON                    @G51APSS*/ 04643000
         L     @11,UCMFEXTP(,UCMDVEPT)                          02S1218 04644000
         OI    UCMEFLGB(@11),B'01000000'                        02S1218 04645000
*           END;                    /*                       @G51APSS*/ 04646000
*         IF UCMCOMPC^=ZERO&        /* A COMPOSITE?          @G51APSS*/ 04647000
*             UCMCOMPC->UCMUCB->UCBSYSR='0'B THEN/* AND OUTPUT HALF     04648000
*                                      IS NOT MARKED AS A CONSOLE?      04649000
*                                                            @G51APSS*/ 04650000
@RF01215 L     @11,UCMCOMPC(,UCMDVEPT)                          02S1220 04651000
         LTR   @11,@11                                          02S1220 04652000
         BZ    @RF01220                                         02S1220 04653000
         L     @11,UCMUCB(,@11)                                 02S1220 04654000
         TM    UCBSYSR(@11),B'00000010'                         02S1220 04655000
         BNZ   @RF01220                                         02S1220 04656000
*           DO;                     /* YES                   @G51APSS*/ 04657000
*             UCMCOMPC->UCMUCB->UCBSYSRX='1'B;/* MARK AS A CONSOLE      04658000
*                                                            @G51APSS*/ 04659000
         L     @07,UCBSYSRX-3(,@11)                             02S1222 04660000
@GL00086 LR    @04,@07                                          02S1222 04661000
         O     @04,@CF03988                                     02S1222 04662000
         CS    @07,@04,UCBSYSRX-3(@11)                          02S1222 04663000
         BNE   @GL00086                                         02S1222 04664000
*             UCMCOMPC->UCMFEXTP->UCMEFLGB='1'B;/* MARK THAT UCBSYSR    04665000
*                                      WAS FORCED ON         @G51APSS*/ 04666000
         L     @11,UCMCOMPC(,UCMDVEPT)                          02S1223 04667000
         L     @11,UCMFEXTP(,@11)                               02S1223 04668000
         OI    UCMEFLGB(@11),B'01000000'                        02S1223 04669000
*           END;                    /*                       @G51APSS*/ 04670000
*       END;                        /* OF OK TO USE DEVICE   @G51APSS*/ 04671000
@RF01220 DS    0H                                               02S1226 04672000
*   END;                            /* OF DO LOOP THRU UCMES @G51APSS*/ 04673000
@RF01210 AL    UCMDVEPT,UCMVEZ(,UCMBASPT)                       02S1226 04674000
@DE01200 C     UCMDVEPT,UCMVEL(,UCMBASPT)                       02S1226 04675000
         BNH   @DL01200                                         02S1226 04676000
*   CALL DEQQ4;                     /* RELEASE Q4            @G51APSS*/ 04677000
         BAL   @14,DEQQ4                                        02S1227 04678000
*   END SAVEINDX;                   /*                       @G51APSS*/ 04679000
@EL00013 DS    0H                                               02S1228 04680000
@EF00013 DS    0H                                               02S1228 04681000
@ER00013 LM    @14,@12,@SA00013                                 02S1228 04682000
         BR    @14                                              02S1228 04683000
*/*** END OF SAVEINDX SUBROUTINE *************************************/ 04684000
*                                                               02S1229 04685000
         EJECT                                                          04686000
*                                                               02S1229 04687000
*/*** START OF SUBSWTCH SUBROUTINE **************************@ZA03626*/ 04688000
*/*                                                                  */ 04689000
*/* SUBSWTCH - SUBSYSTEM EXIT FOR ALL CONSOLE SWITCH OR NO CONSOLE   */ 04690000
*/*            CONDITIONS.                                           */ 04691000
*/* FUNCTION - TO SET UP AND EXECUTE A SUBSYSTEM EXIT TO MAKE THE    */ 04692000
*/*            SUBSYSTEM AWARE OF CONSOLE CHANGING STATUS, OR A      */ 04693000
*/*            NO CONSOLE CONDITION. THIS ALLOWS THE SUBSYSTEM TO    */ 04694000
*/*            UP-DATE ANY INTERNAL CONSOLE-ORIENTED TABLES IT MAY   */ 04695000
*/*            BE RETAINING.                                         */ 04696000
*/*                                                                  */ 04697000
*/* INPUT - FAILI = UCME ADDR OF INPUT HALF OF OLD CONSOLE.          */ 04698000
*/*         NEWI  = UCME ADDR OF INPUT HALF OF NEW CONSOLE.          */ 04699000
*/*         UCMMCENT = UCME ADDR OF MASTER CONSOLE.                  */ 04700000
*/*                                                                  */ 04701000
*/* OUTPUT - A PARAMETER LIST TO THE SUBSYSTEM IN THE FORMAT -       */ 04702000
*/*          FOR CONSOLE SWITCH -                                    */ 04703000
*/*          . TWO WORDS -                                           */ 04704000
*/*            1- ADDR OF OLD INPUT UCME - HI-BYTE = X'40'           */ 04705000
*/*            2- ADDR OF NEW INPUT UCME - HI-BYTE = X'00'           */ 04706000
*/*          FOR NO CONSOLE CONDITION -                              */ 04707000
*/*          . ONE WORD -                                            */ 04708000
*/*            1- ADDR OF MASTER CONSOLE - HI-BYTE = X'80'           */ 04709000
*/********************************************************************/ 04710000
*                                                               02S1229 04711000
*SUBSWTCH:                                                      02S1229 04712000
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZA03626*/ 04713000
SUBSWTCH ST    @14,@SA00014                                     02S1229 04714000
*   DCL                                                         02S1230 04715000
*     H80MASK PTR(32) INIT('80000000'X);/* HI-BYTE MASK FOR NO  02S1230 04716000
*                                      CONSOLE               @ZA03626*/ 04717000
*   DCL                                                         02S1231 04718000
*     H40MASK PTR(32) INIT('40000000'X);/* HI-BYTE MASK FOR SWITCH      04719000
*                                      CONS                  @ZA03626*/ 04720000
*   DCL                                                         02S1232 04721000
*     H00MASK PTR(32) INIT('00000000'X);/* HI-BYTE ZER MASK  @ZA03626*/ 04722000
*   RFY                                                         02S1233 04723000
*    (REG02,                                                    02S1233 04724000
*     REG04,                                                    02S1233 04725000
*     REG13) RSTD;                  /*                       @G51APSS*/ 04726000
*   SSOB=SSOB&&SSOB;                /* ZERO OUT SSOB         @ZA03626*/ 04727000
         XC    SSOB(20),SSOB                                    02S1234 04728000
*   SSOBID=NAMESSOB;                /* FILL IN ID FIELD      @ZA03626*/ 04729000
         MVC   SSOBID(4),@CC00112                               02S1235 04730000
*   SSOBLEN=LENGTH(SSOB);           /* SSOB LENGTH           @ZA03626*/ 04731000
         MVC   SSOBLEN(2),@CH00069                              02S1236 04732000
*   SSOBINDV=ADDR(SSWT);            /* ADDR OF PARM LIST     @ZA03626*/ 04733000
         LA    @11,SSWT                                         02S1237 04734000
         ST    @11,SSOBINDV                                     02S1237 04735000
*   SSWT=SSWT&&SSWT;                /* ZERO PARM LIST        @ZA03626*/ 04736000
         XC    SSWT(16),SSWT                                    02S1238 04737000
*   SSWTLEN=LENGTH(SSWT);           /* SSWT LENGTH           @ZA03626*/ 04738000
         MVC   SSWTLEN(2),@CH00071                              02S1239 04739000
*   SSOBFUNC=SSOBCONS;              /* INDICATE NO CONSOLE, SWITCH      04740000
*                                                            @ZA03626*/ 04741000
         MVC   SSOBFUNC(2),@CH00434                             02S1240 04742000
*   IF NCCNOW=YES THEN              /* THIS IS NO CONSOLE COND  02S1241 04743000
*                                                            @ZA18879*/ 04744000
         TM    NCCNOW,B'01000000'                               02S1241 04745000
         BNO   @RF01241                                         02S1241 04746000
*     DO;                                                       02S1242 04747000
*       SSWTWQE=UCMMCENT;           /* MASTER CONSOLE UCME ADDR 02S1243 04748000
*                                                            @ZA03626*/ 04749000
         L     @11,UCMMCENT(,UCMMCSPT)                          02S1243 04750000
         ST    @11,SSWTWQE                                      02S1243 04751000
*       SSWTWQE=SSWTWQE|H80MASK;    /* SET HI-BYTE INDICATOR @ZA03626*/ 04752000
         O     @11,H80MASK                                      02S1244 04753000
         ST    @11,SSWTWQE                                      02S1244 04754000
*     END;                                                      02S1245 04755000
*   ELSE                            /* THIS IS CONSOLE SWTCH @ZA03626*/ 04756000
*     DO;                                                       02S1246 04757000
         B     @RC01241                                         02S1246 04758000
@RF01241 DS    0H                                               02S1247 04759000
*       SSWTWQE=FAILI;              /* OLD CONSOLE UCME ADDR @ZA03626*/ 04760000
         L     @11,FAILI                                        02S1247 04761000
         ST    @11,SSWTWQE                                      02S1247 04762000
*       SSWTWQE=SSWTWQE|H40MASK;    /* SET HI-BYTE INDICATOR @ZA03626*/ 04763000
         L     @15,H40MASK                                      02S1248 04764000
         OR    @11,@15                                          02S1248 04765000
         ST    @11,SSWTWQE                                      02S1248 04766000
*       SSWTMIN=NEWI;               /* NEW CONSOLE UCME ADDR @ZA03626*/ 04767000
         ST    NEWI,SSWTMIN                                     02S1249 04768000
*       SSWTMIN=SSWTMIN|H00MASK;    /* ZERO HI-BYTE ADDR.    @ZA03626*/ 04769000
         L     @11,SSWTMIN                                      02S1250 04770000
         O     @11,H00MASK                                      02S1250 04771000
         ST    @11,SSWTMIN                                      02S1250 04772000
*       IF MSTSWTCH='1'B THEN       /* FAILING MASTER CONSOLE   02S1251 04773000
*                                                            @ZA03626*/ 04774000
         TM    MSTSWTCH,B'00001000'                             02S1251 04775000
         BNO   @RF01251                                         02S1251 04776000
*         DO;                                                   02S1252 04777000
*           SSWTORE=SSWTORE|H40MASK;/* TELL SUB-SYSTEM       @ZA03626*/ 04778000
         O     @15,SSWTORE                                      02S1253 04779000
         ST    @15,SSWTORE                                      02S1253 04780000
*           MSTSWTCH='0'B;          /* TURN OFF FLAG         @ZA03626*/ 04781000
         NI    MSTSWTCH,B'11110111'                             02S1254 04782000
*         END;                                                  02S1255 04783000
*     END;                                                      02S1256 04784000
@RF01251 DS    0H                                               02S1257 04785000
*   CALL FRLOCKS;                   /* RELEASE LOCKS ACROSS EXIT        04786000
*                                                            @ZA03626*/ 04787000
@RC01241 BAL   @14,FRLOCKS                                      02S1257 04788000
*   REG04=REG13;                    /* SAVE SAV EAREA ADDR ACROSS       04789000
*                                      EXIT                  @ZA03626*/ 04790000
         LR    REG04,REG13                                      02S1258 04791000
*   REG13=ADDR(SAV0SAVE);           /* SAVEAREA FOR SUBSYSTEM USE       04792000
*                                                            @ZA03626*/ 04793000
         LA    REG13,SAV0SAVE                                   02S1259 04794000
*/*   ? IEFSSREQ  (SSOB);                                            */ 04795000
*/*                                                                  */ 04796000
*/*  PASS CONTROL TO JOB ENTRY SUBSYSTEM TO                          */ 04797000
*/*  PROCESS REQUEST -                                               */ 04798000
*/*                                                                  */ 04799000
*/*    INPUT - REGISTER 1 POINTS TO A ONE-                           */ 04800000
*/*            WORD PARAMETER LIST WHICH                             */ 04801000
*/*            POINTS TO THE SSOB                                    */ 04802000
*/*                                                                  */ 04803000
*                                                               02S1260 04804000
*   CALL SSREQ(SSOB);               /* EXIT TO SUBSYSTEM     @ZA03626*/ 04805000
         LA    @11,SSOB                                         02S1260 04806000
         ST    @11,@AL00001                                     02S1260 04807000
         MVI   @AL00001,X'80'                                   02S1260 04808000
         L     @11,LCVTPTR                                      02S1260 04809000
         L     @11,CVTJESCT(,@11)                               02S1260 04810000
         L     @15,JESSSREQ(,@11)                               02S1260 04811000
         LA    @01,@AL00001                                     02S1260 04812000
         BALR  @14,@15                                          02S1260 04813000
*   REG13=REG04;                    /* RESTORE SAVEAREA PTR  @ZA03626*/ 04814000
         LR    REG13,REG04                                      02S1261 04815000
*   CALL GETLOCKS;                  /* RE-ACQUIRE LOCKS      @ZA03626*/ 04816000
         BAL   @14,GETLOCKS                                     02S1262 04817000
*   RFY                                                         02S1263 04818000
*    (REG02,                                                    02S1263 04819000
*     REG13) UNRSTD;                /*                       @G51APSS*/ 04820000
*   END SUBSWTCH;                                               02S1264 04821000
*                                                               02S1264 04822000
@EL00014 DS    0H                                               02S1264 04823000
@EF00014 DS    0H                                               02S1264 04824000
@ER00014 L     @14,@SA00014                                     02S1264 04825000
         BR    @14                                              02S1264 04826000
*/*** END OF SUBSWTCH SUBROUTINE *************************************/ 04827000
*                                                               02S1265 04828000
         EJECT                                                          04829000
*                                                               02S1265 04830000
*/*** START OF CALLDSP SUBROUTINE ************************************/ 04831000
*/*                                                                  */ 04832000
*/* CALLDSP  _ SUBROUTINE TO CALL A DEVICE PROCESSOR TO      @G51APSS*/ 04833000
*/*            OPEN OR CLOSE A CONSOLE                       @G51APSS*/ 04834000
*/*                                                                  */ 04835000
*/* FUNCTION - SAVES REGISTERS, INITIALIZES REGISTERS AND    @G51APSS*/ 04836000
*/*            THE CSA FOR THE DEVICE PROCESSOR, THEN CALLS  @G51APSS*/ 04837000
*/*            THE DSP. IF THE DEVICE IS A 1052 THEN THE     @G51APSS*/ 04838000
*/*            LOCKS ARE NOT RELEASED                        @G51APSS*/ 04839000
*/*                                                          @G51APSS*/ 04840000
*/*            IF THE DEVICE IS TO CLOSE THEN THE DSP MAY    @G51APSS*/ 04841000
*/*            BE CALLED TWICE. I.E. DIDOCS FIRST BLANKS THE @G51APSS*/ 04842000
*/*            SCREEN AND THEN RETURNS CONTROL. WHEN THE     @G51APSS*/ 04843000
*/*            EXCP HAS COMPLETED DIDOCS IS CALLED AGAIN     @G51APSS*/ 04844000
*/*            TO FINISH THE CLOSE. IF THE I/0 NEVER         @G51APSS*/ 04845000
*/*            COMPLETES THEN THE UCME IS MADE TO APPEAR AS  @G51APSS*/ 04846000
*/*            IF THE I/0 COMPLETED AND DIDOCS IS THEN       @G51APSS*/ 04847000
*/*            CALLED                                        @G51APSS*/ 04848000
*/*                                                                  */ 04849000
*/* INPUT    - TYPECONS - UCME ADDR OF DEVICE TO OPEN/CLOSE  @G51APSS*/ 04850000
*/*            OPNCLOSE - CODE WHICH TELLS DSP TO OPEN OR    @G51APSS*/ 04851000
*/*                       CLOSE                              @G51APSS*/ 04852000
*/*                                                                  */ 04853000
*/* OUTPUT   - DEVICE IS OPEN OR CLOSED                      @G51APSS*/ 04854000
*/*                                                                  */ 04855000
*/********************************************************************/ 04856000
*                                                               02S1265 04857000
*CALLDSP:                                                       02S1265 04858000
*   PROC(TYPECONS,OPNCLOSE) OPTIONS(SAVE);/*                 @G51APSS*/ 04859000
CALLDSP  STM   @14,@12,@SA00015                                 02S1265 04860000
         MVC   @PC00015(8),0(@01)                               02S1265 04861000
*   DCL                                                         02S1266 04862000
*     TYPECONS PTR(31);             /* UCME ADDR OF DEVICE TO   02S1266 04863000
*                                      OPEN/CLOSE            @G51APSS*/ 04864000
*   DCL                                                         02S1267 04865000
*     OPNCLOSE FIXED(8);            /* CODE WHICH TELLS THE DSP TO      04866000
*                                      OPEN OR CLOSE DEVICE  @G51APSS*/ 04867000
*   RFY                                                         02S1268 04868000
*     UCMLIST BASED(TYPECONS);      /* RE-BASE UCME          @G51APSS*/ 04869000
*   RFY                                                         02S1269 04870000
*    (REG01,                                                    02S1269 04871000
*     REG08,                                                    02S1269 04872000
*     REG09,                                                    02S1269 04873000
*     REG13,                                                    02S1269 04874000
*     REG15) RSTD;                  /*                       @G51APSS*/ 04875000
*   UCMSWSA1=REG13;                 /* SAVE REG ACROSS CALL  @G51APSS*/ 04876000
         ST    REG13,UCMSWSA1(,UCMMCSPT)                        02S1270 04877000
*   UCMSWSA2=REG09;                 /* SAVE DATA REG         @G51APSS*/ 04878000
         ST    REG09,UCMSWSA2(,UCMMCSPT)                        02S1271 04879000
*   STM(REG05,REG06,OPENSAVE);      /* SAVE CODE REGS        @ZA10758*/ 04880000
         STM   REG05,REG06,OPENSAVE                             02S1272 04881000
*   OPENSAV8=REG08;                 /* SAVE CODE REG         @ZA10758*/ 04882000
         ST    REG08,OPENSAV8                                   02S1273 04883000
*   SAVCSAXA=CSAXA;                 /* SAVE RETURN ADDR              */ 04884000
         MVC   SAVCSAXA(4),CSAXA(CXSAPTR)                       02S1274 04885000
*   IF UCMEFLGA='0'B THEN           /* HAS ATTN INDEX ALREADY BEEN      04886000
*                                      SAVED?                @G51APSS*/ 04887000
         L     @14,@PC00015                                     02S1275 04888000
         L     @14,TYPECONS(,@14)                               02S1275 04889000
         L     @11,UCMFEXTP(,@14)                               02S1275 04890000
         TM    UCMEFLGA(@11),B'10000000'                        02S1275 04891000
         BNZ   @RF01275                                         02S1275 04892000
*     DO;                           /* NO                    @G51APSS*/ 04893000
*       UCMEFATT=UCBATI;            /* SAVE ATTN INDEX       @G51APSS*/ 04894000
         L     @14,UCBPTR(,@14)                                 02S1277 04895000
         L     @14,UCBEXTPT(,@14)                               02S1277 04896000
         MVC   UCMEFATT(1,@11),UCBATI(@14)                      02S1277 04897000
*       UCMEFLGA='1'B;              /* MARK THAT ATTN INDEX SAVED IS    04898000
*                                      VALID                 @G51APSS*/ 04899000
         OI    UCMEFLGA(@11),B'10000000'                        02S1278 04900000
*       UCBATI=COMTSKAX;            /* CHANGE ATTN INDEX TO COMMTASKS   04901000
*                                                            @G51APSS*/ 04902000
         MVI   UCBATI(@14),X'04'                                02S1279 04903000
*     END;                          /*                       @G51APSS*/ 04904000
*   SW1='0'B;                       /* SET END OF LOOP SWITCH OFF       04905000
*                                                            @G51APSS*/ 04906000
*                                                               02S1281 04907000
@RF01275 NI    SW1,B'01111111'                                  02S1281 04908000
*   /*****************************************************************/ 04909000
*   /*                                                               */ 04910000
*   /* CALL THE DEVICE SERVICE PROCESSOR TO OPEN/CLOSE THE DEVICE.   */ 04911000
*   /*                                                       @G51APSS*/ 04912000
*   /*                                                               */ 04913000
*   /*****************************************************************/ 04914000
*                                                               02S1282 04915000
*   DO I=1 TO 2 WHILE SW1='0'B;     /*                       @G51APSS*/ 04916000
         LA    @14,1                                            02S1282 04917000
         ST    @14,I                                            02S1282 04918000
@DL01282 TM    SW1,B'10000000'                                  02S1282 04919000
         BNZ   @DC01282                                         02S1282 04920000
*     CSAUCM=TYPECONS;              /* PUT UCME ADDR IN PARMLIST        04921000
*                                                            @G51APSS*/ 04922000
         L     @14,@PC00015                                     02S1283 04923000
         L     @14,TYPECONS(,@14)                               02S1283 04924000
         ST    @14,CSAUCM(,CXSAPTR)                             02S1283 04925000
*     CSACODE=OPNCLOSE;             /* SET CODE TO INDICATE     02S1284 04926000
*                                      OPEN/CLOSE            @G51APSS*/ 04927000
         L     @11,@PC00015+4                                   02S1284 04928000
         MVC   CSACODE(1,CXSAPTR),OPNCLOSE(@11)                 02S1284 04929000
*     CSANAME=UCMNAME;              /* SET UP CXSA FOR DSP   @G51APSS*/ 04930000
         MVC   CSANAME(8,CXSAPTR),UCMNAME(@14)                  02S1285 04931000
*     REG01=REG12;                  /* PASS PTR TO CSA IN REG 1      */ 04932000
         LR    REG01,REG12                                      02S1286 04933000
*     IF CSANAME(4:5)=V1052ID THEN  /* IS DSP 1052?          @G51APSS*/ 04934000
         CLC   CSANAME+3(2,CXSAPTR),@CC00120                    02S1287 04935000
         BNE   @RF01287                                         02S1287 04936000
*       REG15=ADDR(IGC0I07B);       /* YES, USE SPECIAL ENTRY POINT  */ 04937000
         L     REG15,@CV00237                                   02S1288 04938000
*     ELSE                          /* NO                    @G51APSS*/ 04939000
*       DO;                         /*                       @G51APSS*/ 04940000
         B     @RC01287                                         02S1289 04941000
@RF01287 DS    0H                                               02S1290 04942000
*         REG15=UCMSBR;             /* USE NORMAL MODULE EP  @G51APSS*/ 04943000
         L     @14,@PC00015                                     02S1290 04944000
         L     @14,TYPECONS(,@14)                               02S1290 04945000
         L     REG15,UCMSBR(,@14)                               02S1290 04946000
*         CALL FRLOCKS;             /* RELEASE LOCKS FOR DSP @G51APSS*/ 04947000
         BAL   @14,FRLOCKS                                      02S1291 04948000
*       END;                        /*                       @G51APSS*/ 04949000
*     GEN REFS(REG12,REG14,REG15,CXSA,CSACTLM) SETS(REG14,UCMDCB);      04950000
@RC01287 DS    0H                                               02S1293 04951000
         BALR  REG14,REG15         CALL DSP TO OPEN/CLOSE      @G51APSS 04952000
         LR    REG12,REG01         RE-INITIALIZE CXSA BASE              04953000
         L     REG15,CSACTLM-CXSA(REG12) GET UCM BASE ADDR              04954000
         BCTR  REG15,0             DECR BY 1                            04955000
         BCTR  REG15,0             DECR BY 2                            04956000
         BCTR  REG15,0             DECR BY 3                            04957000
         BCTR  REG15,0             DECR BY 4 TO FIND PTR TO UCM PREFIX  04958000
         L     REG15,0(REG15)      GET PTR TO UCMPRFX                   04959000
*     REG13=REG15->UCMSWSA1;        /* RESTORE SAVEAREA PTR  @G51APSS*/ 04960000
         L     REG13,UCMSWSA1(,REG15)                           02S1294 04961000
*     REG09=REG15->UCMSWSA2;        /* RESTORE DATA REG      @G51APSS*/ 04962000
         L     REG09,UCMSWSA2(,REG15)                           02S1295 04963000
*     LM(REG05,REG06,OPENSAVE);     /* RESTORE CODE REGS     @G51APSS*/ 04964000
         LM    REG05,REG06,OPENSAVE                             02S1296 04965000
*     REG08=OPENSAV8;               /* RESTORE CODE REG      @G51APSS*/ 04966000
         L     REG08,OPENSAV8                                   02S1297 04967000
*     IF OPNCLOSE=CSAOPEN|          /* CALL DSP TO OPEN OR   @G51APSS*/ 04968000
*         UCMDCB=ZERO THEN          /* DEVICE IS CLOSED?     @G51APSS*/ 04969000
         L     @14,@PC00015+4                                   02S1298 04970000
         CLI   OPNCLOSE(@14),0                                  02S1298 04971000
         BE    @RT01298                                         02S1298 04972000
         L     @14,@PC00015                                     02S1298 04973000
         L     @14,TYPECONS(,@14)                               02S1298 04974000
         ICM   @00,15,UCMDCB(@14)                               02S1298 04975000
         BNZ   @RF01298                                         02S1298 04976000
@RT01298 DS    0H                                               02S1299 04977000
*       DO;                         /* YES                   @G51APSS*/ 04978000
*         SW1='1'B;                 /* STOP LOOP             @G51APSS*/ 04979000
         OI    SW1,B'10000000'                                  02S1300 04980000
*         CALL GETLOCKS;            /* OBTAIN LOCKS          @G51APSS*/ 04981000
         BAL   @14,GETLOCKS                                     02S1301 04982000
*       END;                        /*                       @G51APSS*/ 04983000
*     ELSE                          /* TRYING TO CLOSE A     @G51APSS*/ 04984000
*       DO;                         /* DIDOCS DEVICE         @G51APSS*/ 04985000
         B     @RC01298                                         02S1303 04986000
@RF01298 DS    0H                                               02S1304 04987000
*         CALL FRLOCKS;             /* RELEASE LOCKS         @G51APSS*/ 04988000
         BAL   @14,FRLOCKS                                      02S1304 04989000
*         GEN REFS(THREESEC)(STIMER WAIT,BINTVL=THREESEC);/* WAIT FOR   04990000
*                                      I/O TO COMPLETE       @G51APSS*/ 04991000
         STIMER WAIT,BINTVL=THREESEC                                    04992000
*         CALL GETLOCKS;            /* OBTAIN LOCKS          @G51APSS*/ 04993000
         BAL   @14,GETLOCKS                                     02S1306 04994000
*         IF IOCOMP^=EXCPSUCC THEN  /* IS I/O COMPLETE?      @G51APSS*/ 04995000
         L     @14,@PC00015                                     02S1307 04996000
         L     @14,TYPECONS(,@14)                               02S1307 04997000
         CLI   IOCOMP(@14),X'7F'                                02S1307 04998000
         BE    @RF01307                                         02S1307 04999000
*           DO;                     /* NO, CAUSE TO LOOK COMPLETE       05000000
*                                                            @G51APSS*/ 05001000
*             UCMDEVE='1'B;         /* MARK I/O COMPLETE     @G51APSS*/ 05002000
         OI    UCMDEVE(@14),B'00001000'                         02S1309 05003000
*             IOCOMP=EXCPSUCC;      /* MARK I/O SUCCESSFULL  @G51APSS*/ 05004000
         MVI   IOCOMP(@14),X'7F'                                02S1310 05005000
*           END;                    /*                       @G51APSS*/ 05006000
*       END;                        /*                       @G51APSS*/ 05007000
@RF01307 DS    0H                                               02S1313 05008000
*   END;                            /* OF DO LOOP            @G51APSS*/ 05009000
@RC01298 LA    @14,1                                            02S1313 05010000
         AL    @14,I                                            02S1313 05011000
         ST    @14,I                                            02S1313 05012000
         CH    @14,@CH00063                                     02S1313 05013000
         BNH   @DL01282                                         02S1313 05014000
@DC01282 DS    0H                                               02S1314 05015000
*   CSAXA=SAVCSAXA;                 /* RESTORE RETURN ADDRESS        */ 05016000
         MVC   CSAXA(4,CXSAPTR),SAVCSAXA                        02S1314 05017000
*   RFY                                                         02S1315 05018000
*     UCMLIST BASED(UCMDVEPT);      /*                       @G51APSS*/ 05019000
*   RFY                                                         02S1316 05020000
*    (REG01,                                                    02S1316 05021000
*     REG08,                                                    02S1316 05022000
*     REG09,                                                    02S1316 05023000
*     REG13,                                                    02S1316 05024000
*     REG15) UNRSTD;                /*                       @G51APSS*/ 05025000
*   END CALLDSP;                    /*                       @G51APSS*/ 05026000
@EL00015 DS    0H                                               02S1317 05027000
@EF00015 DS    0H                                               02S1317 05028000
@ER00015 LM    @14,@12,@SA00015                                 02S1317 05029000
         BR    @14                                              02S1317 05030000
*/*** END OF CALLDSP SUBROUTINE **************************************/ 05031000
*                                                               02S1318 05032000
         EJECT                                                          05033000
*                                                               02S1318 05034000
*/*** START OF BELLEXCP SUBROUTINE ***********************************/ 05035000
*/*                                                                  */ 05036000
*/* BELLEXCP - ISSUE EXCP 3 TIMES TO SOUND A CONSOLES ALARM  @G51APSS*/ 05037000
*/*            OR TO SOUND THE POWER AND COOLING ALARM       @G51APSS*/ 05038000
*/*                                                                  */ 05039000
*/* FUNCTION - THIS SUBROUTINE SAVES THE PTR TO THE CURRENT CCW,     */ 05040000
*/*            THEN A CHECK IS MADE TO SEE IF THE DEVICE IS  @ZA18885*/ 05041000
*/*            MARKED NOT READY. IF SO THEN THE ALARM IS NOT @ZA18885*/ 05042000
*/*            SOUNDED. IF THE DEVICE IS READY THEN AN EXCP  @ZA18885*/ 05043000
*/*            IS ISSUED TO SOUND THE ALARM. A 3 SECOND      @ZA18885*/ 05044000
*/*            STIMER WAIT IS THEN ISSUED. IF THE I/O HAS    @ZA18885*/ 05045000
*/*            NOT COMPLETED SUCCESSFULLY THEN NO MORE       @ZA18885*/ 05046000
*/*            ATTEMPTS TO SOUND THE ALARM ARE MADE. IF THE  @ZA18885*/ 05047000
*/*            I/O COMPLETED SUCCESSFULLY THEN AN ATTEMPT IS @ZA18885*/ 05048000
*/*            MADE TO SOUND THE ALARM 2 MORE TIMES.         @ZA18885*/ 05049000
*/*                                                                  */ 05050000
*/* INPUT    - TYPECCW IS TESTED TO DETERMINE IF A           @G51APSS*/ 05051000
*/*            CONSOLES ALARM SHOULD BE SOUNDED OR IF THE    @G51APSS*/ 05052000
*/*            POWER AND COOLING ALARM SHOULD BE SOUNDED.    @G51APSS*/ 05053000
*/*                                                                  */ 05054000
*/* OUTPUT -   DING --- DING --- DING.                               */ 05055000
*/*                                                                  */ 05056000
*/* NOTES    - APARS ZA08472,ZA10759,ZA17295 WERE ONCE       @G51APSS*/ 05057000
*/*            FIXED IN THIS SUBROUTINE BUT HAVE BEEN        @G51APSS*/ 05058000
*/*            REPLACED BY SUPPORT CODE G51APSS              @G51APSS*/ 05059000
*/*                                                                  */ 05060000
*/********************************************************************/ 05061000
*                                                               02S1318 05062000
*BELLEXCP:                                                      02S1318 05063000
*   PROC(TYPECCW) OPTIONS(SAVE);    /*                       @G51APSS*/ 05064000
BELLEXCP STM   @14,@12,@SA00016                                 02S1318 05065000
         MVC   @PC00016(4),0(@01)                               02S1318 05066000
*   DCL                                                         02S1319 05067000
*     TYPECCW FIXED(15);            /* VALUE DETERMINES IF CONSOLE      05068000
*                                      BELL OR POWER ALARM SHOULD BE    05069000
*                                      SOUNDED               @G51APSS*/ 05070000
*   RFY                                                         02S1320 05071000
*    (REG00,                                                    02S1320 05072000
*     REG01,                                                    02S1320 05073000
*     REG10,                                                    02S1320 05074000
*     REG15) RSTD;                  /*                       @G51APSS*/ 05075000
*   RFY                                                         02S1321 05076000
*     UCMLIST BASED(CONUCME);       /* BASE FOR UCME         @G51APSS*/ 05077000
*   IF TYPECCW=BELL THEN            /* RING CONSOLES BELL?   @G51APSS*/ 05078000
         L     @14,@PC00016                                     02S1322 05079000
         ICM   @11,3,TYPECCW(@14)                               02S1322 05080000
         BNZ   @RF01322                                         02S1322 05081000
*     CONUCME=BELLCONS;             /* YES, GET UCME ADDR    @G51APSS*/ 05082000
         L     CONUCME,BELLCONS                                 02S1323 05083000
*   ELSE                            /* NO                    @G51APSS*/ 05084000
*     CONUCME=PWRCONS;              /* GET UCME ADDR OF CONSOLE WITH    05085000
*                                      POWER ALARM           @G51APSS*/ 05086000
         B     @RC01322                                         02S1324 05087000
@RF01322 L     CONUCME,PWRCONS                                  02S1324 05088000
*   UCMBF='0'B;                     /* MARK NOT BUSY         @G51APSS*/ 05089000
@RC01322 NI    UCMBF(CONUCME),B'11011111'                       02S1325 05090000
*   UCMDEVE='0'B;                   /* MARK I/O NOT COMPLETE @G51APSS*/ 05091000
         NI    UCMDEVE(CONUCME),B'11110111'                     02S1326 05092000
*   REG10=UCMDCB;                   /* PICK UP PTR DCB/IOB/CCW'S        05093000
*                                                            @G51APSS*/ 05094000
         L     REG10,UCMDCB(,CONUCME)                           02S1327 05095000
*   GEN REFS(REG10,REG12,IHADCB,DMICPA) SETS(REG15);            02S1328 05096000
*                                   /* SAVE CURRENT CCW      @G51APSS*/ 05097000
         USING IHADCB,REG10        THE I/O WORKAREA IS IN A BAL MACRO   05098000
         L     REG15,DMICPA        GET PTR TO CURRENT CCW               05099000
*   CSAXE=REG15;                    /* SAVE PTR TO CURRENT CCW  02S1329 05100000
*                                                            @G51APSS*/ 05101000
         ST    REG15,CSAXE(,CXSAPTR)                            02S1329 05102000
*   EXCPERR=NO;                     /* NO EXCP ERROR YET     @G51APSS*/ 05103000
         NI    EXCPERR,B'11111011'                              02S1330 05104000
*   DO I=1 TO 3 WHILE(EXCPERR=NO);  /* RING ALARM 3 TIMES    @G51APSS*/ 05105000
         LA    @14,1                                            02S1331 05106000
         ST    @14,I                                            02S1331 05107000
@DL01331 TM    EXCPERR,B'00000100'                              02S1331 05108000
         BNZ   @DC01331                                         02S1331 05109000
*     IF TYPECCW=POWER THEN         /* SOUND POWER ALARM?    @G51APSS*/ 05110000
         L     @14,@PC00016                                     02S1332 05111000
         CLC   TYPECCW(2,@14),@CH00055                          02S1332 05112000
         BNE   @RF01332                                         02S1332 05113000
*       REG15=ADDR(RINGPOWA);       /* YES, GET POWER ALARM CCW ADDR    05114000
*                                                            @G51APSS*/ 05115000
         LA    REG15,RINGPOWA                                   02S1333 05116000
*     ELSE                          /*                       @G51APSS*/ 05117000
*       IF GRFSW='1'B THEN          /* 3270/3158/3036 SWITCH SET?       05118000
*                                                            @G51APSS*/ 05119000
         B     @RC01332                                         02S1334 05120000
@RF01332 TM    GRFSW,B'00000100'                                02S1334 05121000
         BNO   @RF01334                                         02S1334 05122000
*         REG15=ADDR(RING3270);     /* YES, GET CCW ADDR     @G51APSS*/ 05123000
         LA    REG15,RING3270                                   02S1335 05124000
*       ELSE                        /*                       @G51APSS*/ 05125000
*         REG15=ADDR(RING1052);     /* NO, GET X'0B' ALARM CCW ADDR     05126000
*                                                            @G51APSS*/ 05127000
         B     @RC01334                                         02S1336 05128000
@RF01334 LA    REG15,RING1052                                   02S1336 05129000
*     UCMECB=ZERO;                  /* CLEAR I/O ECB         @G51APSS*/ 05130000
@RC01334 DS    0H                                               02S1337 05131000
@RC01332 SLR   @14,@14                                          02S1337 05132000
         ST    @14,UCMECB(,CONUCME)                             02S1337 05133000
*     IF UCBNRY='1'B THEN           /* IS DEVICE NOT READY?  @ZA18885*/ 05134000
         L     @14,UCBPTR(,CONUCME)                             02S1338 05135000
         TM    UCBNRY(@14),B'01000000'                          02S1338 05136000
         BNO   @RF01338                                         02S1338 05137000
*       EXCPERR=YES;                /* YES, DON'T ISSUE EXCP @ZA18885*/ 05138000
         OI    EXCPERR,B'00000100'                              02S1339 05139000
*     ELSE                          /* NO, DEVICE IS READY   @ZA18885*/ 05140000
*       DO;                         /*                       @G51APSS*/ 05141000
         B     @RC01338                                         02S1340 05142000
@RF01338 DS    0H                                               02S1341 05143000
*         GEN REFS(REG10,REG15,DCBIOBAD,DMIOB,THREESEC) SETS(REG00,     05144000
*             REG01,DMICPA);                                    02S1341 05145000
*                                   /* ISSUE EXCP            @G51APSS*/ 05146000
           L     REG01,DCBIOBAD    SET UP PTR TO IOB FOR EXCP  @ZA10759 05147000
           ST    REG15,DMICPA-DMIOB(REG01) STORE PTR TO ALARM CCW IN   X05148000
                                           IOB                 @ZA10759 05149000
           EXCP  (1)                 SOUND ALARM                        05150000
           STIMER WAIT,BINTVL=THREESEC WAIT FOR 3 SECONDS       YM02449 05151000
*         IF IOCOMP^=EXCPSUCC THEN  /* WAS EXCP SUCCESSFUL?  @G51APSS*/ 05152000
         CLI   IOCOMP(CONUCME),X'7F'                            02S1342 05153000
         BE    @RF01342                                         02S1342 05154000
*           EXCPERR=YES;            /* NO, NO MORE EXCPS SHOULD BE      05155000
*                                      ISSUED                @G51APSS*/ 05156000
         OI    EXCPERR,B'00000100'                              02S1343 05157000
*       END;                        /*                       @G51APSS*/ 05158000
@RF01342 DS    0H                                               02S1345 05159000
*   END;                            /* OF DO LOOP TO SOUND ALARM 3      05160000
*                                      TIMES                 @G51APSS*/ 05161000
@RC01338 LA    @14,1                                            02S1345 05162000
         AL    @14,I                                            02S1345 05163000
         ST    @14,I                                            02S1345 05164000
         CH    @14,@CH00089                                     02S1345 05165000
         BNH   @DL01331                                         02S1345 05166000
@DC01331 DS    0H                                               02S1346 05167000
*   UCMECB=ZERO;                    /* CLEAR I/O ECB         @G51APSS*/ 05168000
         SLR   @14,@14                                          02S1346 05169000
         ST    @14,UCMECB(,CONUCME)                             02S1346 05170000
*   REG15=CSAXE;                    /* GET ORRIGINAL CCW PTR @G51APSS*/ 05171000
         L     REG15,CSAXE(,CXSAPTR)                            02S1347 05172000
*   GEN REFS(REG10,REG15) SETS(DMICPA);                         02S1348 05173000
*                                      /*                    @G51APSS*/ 05174000
         ST    REG15,DMICPA        RESTORE ORIGINAL CCW PTR IOB         05175000
         DROP  REG10               FREE BASE TO I/O WORK AREA  @G51APSS 05176000
*   RFY                                                         02S1349 05177000
*     UCMLIST BASED(UCMDVEPT);      /* RESTORE UCME BASE     @G51APSS*/ 05178000
*   RFY                                                         02S1350 05179000
*    (REG00,                                                    02S1350 05180000
*     REG01,                                                    02S1350 05181000
*     REG10,                                                    02S1350 05182000
*     REG15) UNRSTD;                /*                       @G51APSS*/ 05183000
*   END BELLEXCP;                                               02S1351 05184000
*                                                               02S1351 05185000
@EL00016 DS    0H                                               02S1351 05186000
@EF00016 DS    0H                                               02S1351 05187000
@ER00016 LM    @14,@12,@SA00016                                 02S1351 05188000
         BR    @14                                              02S1351 05189000
*/*** END OF BELLEXCP SUBROUTINE *************************************/ 05190000
*                                                               02S1352 05191000
*                                                               02S1352 05192000
*/*** START OF HCSWITCH SEGMENT **************************************/ 05193000
*/*                                                                  */ 05194000
*/* HCSWITCH - SWITCHS THE HARDCOPY FUNCTION                         */ 05195000
*/*                                                                  */ 05196000
*/* FUNCTION - A SEARCH IS MADE FOR AN CONSOLE TO RECEIVE HARDCOPY   */ 05197000
*/*            AND IF ONE IS FOUND, THE HARDCOPY FUNCTION IS SWITCHED*/ 05198000
*/*            TO IT. MESSAGE IEE142I IS BUILT AND QUEUED TO THE     */ 05199000
*/*            NEW HARDCOPY CONSOLE, AND CONTROL IS RETURNED TO THE  */ 05200000
*/*            CALLER.  IF NO CONSOLE WAS FOUND, A SWITCH IS SET TO  */ 05201000
*/*            CAUSE MESSAGE IEA964I (HARDCOPY SUSPENDED) TO BE      */ 05202000
*/*            PRINTED IN WRAPUP.                                    */ 05203000
*/*                                                                  */ 05204000
*/* **NOTE**   HARDCOPY IS NEVER SWITCHED TO A GRAPHICS DEVICE.      */ 05205000
*/*                                                                  */ 05206000
*/* INPUT  -   CSACODE IS SET TO 'CSAHC' IF SWITCH FROM SYSLOG       */ 05207000
*/*            NEWHC IS ZERO                                         */ 05208000
*/*            OLDHC CONSTAINS ADDRESS OF FAILING CONSOLES UCME      */ 05209000
*/*                                                                  */ 05210000
*/* OUTPUT  -  UCMHCUCM CONTAINS UCME ADDR OF SELECTED CONSOLE       */ 05211000
*/*            UCMDISPB IS ON IN UCME OF NEW HARDCOPY CONSOLE        */ 05212000
*/*                                                                  */ 05213000
*/********************************************************************/ 05214000
*                                                               02S1352 05215000
*HCSWITCH:                                                      02S1352 05216000
*   PROC OPTIONS(SAVE(REG14));                                  02S1352 05217000
HCSWITCH ST    @14,@SA00017                                     02S1352 05218000
*   CALL FNDHCALT;                  /* SEARCH FOR A HARDCOPY CONSOLE */ 05219000
         BAL   @14,FNDHCALT                                     02S1353 05220000
*   IF NEWHC^=0                     /* TEST WHETHER CONSOLE WAS FOUND*/ 05221000
*     THEN                          /* IF CONSOLE FOUND, PROCESS     */ 05222000
         LTR   NEWHC,NEWHC                                      02S1354 05223000
         BZ    @RF01354                                         02S1354 05224000
*     DO;                                                       02S1355 05225000
*       UCMHCUCM=NEWHC;             /* SET PTR TO HC CONSOLE IN UCM  */ 05226000
         ST    NEWHC,UCMHCUCM(,UCMMCSPT)                        02S1356 05227000
*       NEWHC->UCMDISPB=YES;        /* MARK NEW CONSOLE AS HARDCOPY  */ 05228000
         OI    UCMDISPB(NEWHC),B'01000000'                      02S1357 05229000
*       CALL HCMSG;                 /* BUILD AND QUEUE MSG IEE142I   */ 05230000
         BAL   @14,HCMSG                                        02S1358 05231000
*       IF FAILO^=ZERO              /* WHAT IS HARDCOPY SWITCH FROM  */ 05232000
*         THEN                      /* IF HARDCOPY SWITCH FOR CONSOLE*/ 05233000
         L     @02,FAILO                                        02S1359 05234000
         SLR   @15,@15                                          02S1359 05235000
         CR    @02,@15                                          02S1359 05236000
         BE    @RF01359                                         02S1359 05237000
*         DO;                                                   02S1360 05238000
*           FAILO->UCMDISPB='0'B;   /* TURN OFF HC FLAG IN FAILING HC   05239000
*                                      CONSOLE'S UCME                */ 05240000
         NI    UCMDISPB(@02),B'10111111'                        02S1361 05241000
*           IF CSAVCPU='0'B&CSAVCHAN='0'B/* VARY CPU OR CHANNEL?     */ 05242000
*             THEN                                              02S1362 05243000
         TM    CSAVCPU(CXSAPTR),B'01100000'                     02S1362 05244000
         BNZ   @RF01362                                         02S1362 05245000
*             DO;                                               02S1363 05246000
*                                                               03S1364 05247000
*/*** START OF REQHCMSG SEGMENT **************************************/ 05248000
*/*                                                                  */ 05249000
*/* REQHCMSG - QUEUES MSGS SENT TO THE FAILING HC DEVICE, TO THE NEW */ 05250000
*/*   HC DEVICE.  THE WQE AND NEW CQE ARE MARKED QUEUED FOR HC.      */ 05251000
*/*                                                                  */ 05252000
*/* INPUT - FAILO - PTR TO FAILING HC CONSOLE (OUTPUT HALF IF        */ 05253000
*/*                 COMPOSITE)                                       */ 05254000
*/*         NEWHC - PTR TO NEW HC CONSOLE (OUTPUT HALF IF COMPOSITE).*/ 05255000
*/*                                                                  */ 05256000
*/* OUTPUT - MESSAGES ARE QUEUED TO THE NEW HC CONSOLE.              */ 05257000
*/*                                                                  */ 05258000
*/********************************************************************/ 05259000
*                                                               03S1364 05260000
*               IF FAILO->UCMOUTQ^=ZERO THEN/* IS THERE AN OUTPUT       05261000
*                                      QUEUE?                        */ 05262000
         L     @02,UCMOUTQ(,@02)                                03S1364 05263000
         CR    @02,@15                                          03S1364 05264000
         BE    @RF01364                                         03S1364 05265000
*                 DO;               /* YES,                          */ 05266000
*                   CQEPTR=FAILO->UCMOUTQ;/* INIT PTR TO 1ST CQE        05267000
*                                      BLOCK                         */ 05268000
         ST    @02,CQEPTR                                       03S1366 05269000
*                   SW1='0'B;       /* INIT END-OF-Q SWITCH          */ 05270000
         NI    SW1,B'01111111'                                  03S1367 05271000
*                   J=ONE;          /* INIT CQE ENTRY COUNTER        */ 05272000
         MVC   J(4),@CF00055                                    03S1368 05273000
*                   GETCQEFL=NO;    /* INIT GET CQE FAILURE FLAG     */ 05274000
*                                                               03S1369 05275000
         NI    GETCQEFL,B'11011111'                             03S1369 05276000
*                   /*************************************************/ 05277000
*                   /*                                               */ 05278000
*                   /* SEARCH THROUGH THE OUTPUT QUEUE OF THE FAILING*/ 05279000
*                   /* CONSOLE FOR VALID CQE ENTRIES                 */ 05280000
*                   /*                                               */ 05281000
*                   /*************************************************/ 05282000
*                                                               03S1370 05283000
*                   DO WHILE(SW1='0'B);                         03S1370 05284000
         B     @DE01370                                         03S1370 05285000
@DL01370 DS    0H                                               03S1371 05286000
*                     IF CQEENTR='1'B&CQEMAJOR='1'B THEN/* VALID        05287000
*                                      MLWTO ENTRY?                  */ 05288000
         L     @02,CQEPTR                                       03S1371 05289000
         TM    CQEENTR(@02),B'00000101'                         03S1371 05290000
         BNO   @RF01371                                         03S1371 05291000
*                       DO;         /* YES,                          */ 05292000
*                         UCMDVEPT=FAILO;/* SET UP UCME PTR. ML1 ALSO   05293000
*                                      USES CQEPTR.                  */ 05294000
         L     UCMDVEPT,FAILO                                   03S1373 05295000
*                         CALL ML1; /* DETERMINE IF MLWTO CAN BE        05296000
*                                      QUEUED TO THE NEW HC CONSOLE.    05297000
*                                      IF NOT, ML1 TURNS OFF CQEENTR.*/ 05298000
         BAL   @14,ML1                                          03S1374 05299000
*                       END;                                    03S1375 05300000
*                     IF CQEENTR='1'B THEN/* IS ENTRY STILL VALID    */ 05301000
@RF01371 L     @02,CQEPTR                                       03S1376 05302000
         TM    CQEENTR(@02),B'00000001'                         03S1376 05303000
         BNO   @RF01376                                         03S1376 05304000
*                       DO;         /* YES                           */ 05305000
*                                                               03S1377 05306000
*                         /*******************************************/ 05307000
*                         /*                                         */ 05308000
*                         /* BUILD A CQE ENTRY ON THE OUTPUT QUEUE OF*/ 05309000
*                         /* THE NEW HARDCOPY CONSOLE.               */ 05310000
*                         /*                                         */ 05311000
*                         /*******************************************/ 05312000
*                                                               03S1378 05313000
*                         IF J=ONE THEN/* IS A NEW CQE BLOCK NEEDED  */ 05314000
         CLC   J(4),@CF00055                                    03S1378 05315000
         BNE   @RF01378                                         03S1378 05316000
*                           DO;     /* YES,                          */ 05317000
*                             OUTQ=NEWHC;/* PLACE NEW BLOCK ON NEW HC   05318000
*                                      CONSOLE'S QUEUE               */ 05319000
         ST    NEWHC,OUTQ                                       03S1380 05320000
*                             CONTROL=CQEPTR;/* SAVE CQE PTR. (GETCQE   05321000
*                                      USES IT)                      */ 05322000
         ST    @02,CONTROL                                      03S1381 05323000
*                             CALL GETCQE;/* GET AND CHAIN A NEW CQE    05324000
*                                      BLOCK                         */ 05325000
         BAL   @14,GETCQE                                       03S1382 05326000
*                             CQEPTR2=CQEPTR;/* MOVE PTR TO NEW CQE     05327000
*                                      BLOCK                         */ 05328000
         MVC   CQEPTR2(4),CQEPTR                                03S1383 05329000
*                             CQEPTR=CONTROL;/* RESET CQEPTR TO OLD     05330000
*                                      CQE                           */ 05331000
         MVC   CQEPTR(4),CONTROL                                03S1384 05332000
*                           END;                                03S1385 05333000
*                         IF GETCQEFL=NO THEN/* IF GETCQE DID NOT       05334000
*                                      FAIL                          */ 05335000
@RF01378 TM    GETCQEFL,B'00100000'                             03S1386 05336000
         BNZ   @RF01386                                         03S1386 05337000
*                           DO;     /* OK - BLOCK WAS OBTAINED       */ 05338000
*                             CQEPTR2->CQEWQE=CQEWQE;/* COPY CQE        05339000
*                                      ENTRY ON FAILING CONSOLE'S Q     05340000
*                                      TO NEW HC CONSOLE'S Q         */ 05341000
         L     @02,CQEPTR2                                      03S1388 05342000
         L     @15,CQEPTR                                       03S1388 05343000
         MVC   CQEWQE(4,@02),CQEWQE(@15)                        03S1388 05344000
*                             CQEPTR2->CQEMLQHC='1'B;/* INDICATES Q'D   05345000
*                                      FOR HC                        */ 05346000
         OI    CQEMLQHC(@02),B'00001000'                        03S1389 05347000
*                             CQEWQEA->WQEQDFHC='1'B;/* INDICATE Q'D    05348000
*                                      FOR HC IN WQE                 */ 05349000
         SLR   @14,@14                                          03S1390 05350000
         ICM   @14,7,CQEWQEA(@15)                               03S1390 05351000
         OI    WQEQDFHC(@14),B'00010000'                        03S1390 05352000
*                             CQEWQEA->WQEUSE=CQEWQEA->WQEUSE+ONE;/*    05353000
*                                      INCREMENT USE COUNT           */ 05354000
         LA    @15,1                                            03S1391 05355000
         SLR   @01,@01                                          03S1391 05356000
         IC    @01,WQEUSE(,@14)                                 03S1391 05357000
         ALR   @15,@01                                          03S1391 05358000
         STC   @15,WQEUSE(,@14)                                 03S1391 05359000
*                             IF(CQEPTR2->CQEMAJOR='1'B)&/* THIS A      05360000
*                                      MLWTO? AND            @ZA26850*/ 05361000
*                                 (CQEWQEA->WMJMLTYD='0'B)&/* HAS NO    05362000
*                                      END LINE? AND         @ZA26850*/ 05363000
*                                 (CQEWQEA->WMJMMIN^=ZERO) THEN/* HAS   05364000
*                                      MINORS?               @ZA26850*/ 05365000
         TM    CQEMAJOR(@02),B'00000100'                        03S1392 05366000
         BNO   @RF01392                                         03S1392 05367000
         TM    WMJMLTYD(@14),B'00010000'                        03S1392 05368000
         BNZ   @RF01392                                         03S1392 05369000
         L     @02,WMJMMIN(,@14)                                03S1392 05370000
         LTR   @02,@02                                          03S1392 05371000
         BZ    @RF01392                                         03S1392 05372000
*                               DO; /* YES TO ALL OF ABOVE   @ZA26850*/ 05373000
         ST    @02,@TF00001                                     03S1393 05374000
*                                 WMNPTR=CQEWQEA->WMJMMIN;/* 1ST        05375000
*                                      MINOR                 @ZA26850*/ 05376000
*                                                               03S1394 05377000
         L     WMNPTR,@TF00001                                  03S1394 05378000
*                                 /***********************************/ 05379000
*                                 /*                                 */ 05380000
*                                 /* PROCESS ALL MINORS FOR THIS     */ 05381000
*                                 /* MLTWO                   @ZA26850*/ 05382000
*                                 /*                                 */ 05383000
*                                 /***********************************/ 05384000
*                                                               03S1395 05385000
*                                 DO WHILE(WMNPTR^=ZERO);/*  @ZA26850*/ 05386000
         B     @DE01395                                         03S1395 05387000
@DL01395 DS    0H                                               03S1396 05388000
*                                   WMNPTR->WMNMUC1=WMNPTR->WMNMUC1+ONE 05389000
*                                       ;/* INCR USE CNT     @ZA26850*/ 05390000
         LA    @15,1                                            03S1396 05391000
         SLR   @14,@14                                          03S1396 05392000
         IC    @14,WMNMUC1(,WMNPTR)                             03S1396 05393000
         ALR   @15,@14                                          03S1396 05394000
         STC   @15,WMNMUC1(,WMNPTR)                             03S1396 05395000
*                                   WMNPTR=WMNPTR->WMNMNX1;/* PTR TO    05396000
*                                      NEXR MINOR            @ZA26850*/ 05397000
         SLR   @15,@15                                          03S1397 05398000
         ICM   @15,7,WMNMNX1(WMNPTR)                            03S1397 05399000
         LR    WMNPTR,@15                                       03S1397 05400000
*                                 END;/*                     @ZA26850*/ 05401000
@DE01395 LTR   WMNPTR,WMNPTR                                    03S1398 05402000
         BNZ   @DL01395                                         03S1398 05403000
*                               END;/*                       @ZA26850*/ 05404000
*                             CQEPTR2=CQEPTR2+LENGTH(CQEWQE);/* 03S1400 05405000
*                                      INCREMENT NEW CQE PTR TO ADDR    05406000
*                                      OF NEXT ENTRY                 */ 05407000
@RF01392 LA    @02,4                                            03S1400 05408000
         L     @15,CQEPTR2                                      03S1400 05409000
         ALR   @15,@02                                          03S1400 05410000
         ST    @15,CQEPTR2                                      03S1400 05411000
*                             J=J+ONE;/* INCREMENT CQE ENTRY COUNTER */ 05412000
         LA    @14,1                                            03S1401 05413000
         L     @01,J                                            03S1401 05414000
         ALR   @01,@14                                          03S1401 05415000
         ST    @01,J                                            03S1401 05416000
*                             IF J=SIX THEN/* IF POINTING AT EOB        05417000
*                                      ENTRY                         */ 05418000
         CH    @01,@CH00033                                     03S1402 05419000
         BNE   @RF01402                                         03S1402 05420000
*                               DO;                             03S1403 05421000
*                                 EVAL(CQEPTR2-LENGTH(CQEWQE))->CQEEOQ= 05422000
*                                     '1'B;/* SET EOQ FLAG IN LAST      05423000
*                                      ENTRY USED                    */ 05424000
         SLR   @15,@02                                          03S1404 05425000
         OI    CQEEOQ(@15),B'10000000'                          03S1404 05426000
*                                 J=ONE;/* NEW CQE BLOCK IS NEEDED   */ 05427000
         ST    @14,J                                            03S1405 05428000
*                               END;                            03S1406 05429000
*                           END;                                03S1407 05430000
@RF01402 DS    0H                                               03S1408 05431000
*                       END;                                    03S1408 05432000
@RF01386 DS    0H                                               03S1409 05433000
*                     IF GETCQEFL=YES|CQEEOQ='1'B THEN/* IF GETCQE      05434000
*                                      FAILED OR THIS IS THE LAST CQE   05435000
*                                      ENTRY                         */ 05436000
@RF01376 TM    GETCQEFL,B'00100000'                             03S1409 05437000
         BO    @RT01409                                         03S1409 05438000
         L     @02,CQEPTR                                       03S1409 05439000
         TM    CQEEOQ(@02),B'10000000'                          03S1409 05440000
         BNO   @RF01409                                         03S1409 05441000
@RT01409 DS    0H                                               03S1410 05442000
*                       SW1='1'B;   /* STOP CQE SEARCH               */ 05443000
         OI    SW1,B'10000000'                                  03S1410 05444000
*                     ELSE                                      03S1411 05445000
*                       DO;         /* ELSE KEEP GOING               */ 05446000
         B     @RC01409                                         03S1411 05447000
@RF01409 DS    0H                                               03S1412 05448000
*                         CQEPTR=CQEPTR+LENGTH(CQEWQE);/* GET ADDR OF   05449000
*                                      NEXT CQE ENTRY                */ 05450000
         LA    @02,4                                            03S1412 05451000
         AL    @02,CQEPTR                                       03S1412 05452000
         ST    @02,CQEPTR                                       03S1412 05453000
*                         IF CQEEOB=ONTWO THEN/* END-OF-BLOCK?       */ 05454000
         TM    CQEEOB(@02),B'11000000'                          03S1413 05455000
         BNO   @RF01413                                         03S1413 05456000
*                           CQEPTR=CQEWQEA;/* GET PTR TO NEXT CQE       05457000
*                                      BLOCK                         */ 05458000
         SLR   @15,@15                                          03S1414 05459000
         ICM   @15,7,CQEWQEA(@02)                               03S1414 05460000
         ST    @15,CQEPTR                                       03S1414 05461000
*                       END;                                    03S1415 05462000
@RF01413 DS    0H                                               03S1416 05463000
*                   END;            /* END OF CQE LOOP               */ 05464000
@RC01409 DS    0H                                               03S1416 05465000
@DE01370 TM    SW1,B'10000000'                                  03S1416 05466000
         BZ    @DL01370                                         03S1416 05467000
*                   IF J^=ONE THEN  /* WAS LAST BLOCK FINISHED?      */ 05468000
         CLC   J(4),@CF00055                                    03S1417 05469000
         BE    @RF01417                                         03S1417 05470000
*                     EVAL(CQEPTR2-LENGTH(CQEWQE))->CQEEOQ='1'B;/*      05471000
*                                      SET EOQ IN LAST ENTRY USED    */ 05472000
         L     @11,CQEPTR2                                      03S1418 05473000
         SL    @11,@CF00065                                     03S1418 05474000
         OI    CQEEOQ(@11),B'10000000'                          03S1418 05475000
*                 END;                                          03S1419 05476000
*                                                               03S1419 05477000
*/*** END OF REQHCMSG SEGMENT ****************************************/ 05478000
*                                                               03S1420 05479000
*             END;                                              02S1420 05480000
*         END;                                                  02S1421 05481000
*       ELSE                                                    02S1422 05482000
*         UCMSYSG='0'B;             /* TURN OFF HC IS SYSLOG FLAG    */ 05483000
         B     @RC01359                                         02S1422 05484000
@RF01359 NI    UCMSYSG(UCMMCSPT),B'11111101'                    02S1422 05485000
*     END;                          /* END CONSOLE FOUND PROCESSING  */ 05486000
*   ELSE                                                        02S1424 05487000
*     IF CSAVCPU='0'B&CSAVCHAN='0'B /* IF CONSOLE NOT FOUND, TEST FOR   05488000
*                                      VARY CPU OR CHANNEL CMD       */ 05489000
*       THEN                        /* REQUEST NOT VARY CPU OR  02S1424 05490000
*                                      CHANNEL                       */ 05491000
         B     @RC01354                                         02S1424 05492000
@RF01354 TM    CSAVCPU(CXSAPTR),B'01100000'                     02S1424 05493000
         BNZ   @RF01424                                         02S1424 05494000
*       DO;                                                     02S1425 05495000
*         UCMSYSG=NO;               /* TURN OFF HARDCOPY IS SYSLOG   */ 05496000
         NI    UCMSYSG(UCMMCSPT),B'11111101'                    02S1426 05497000
*         UCMHCUCM=ZERO;            /* ZERO HARDCOPY CONSOLE ADDR    */ 05498000
         SLR   @11,@11                                          02S1427 05499000
         ST    @11,UCMHCUCM(,UCMMCSPT)                          02S1427 05500000
*         IF FAILO^=ZERO THEN       /* WAS HARDCOPY A DEVICE?   02S1428 05501000
*                                                            @ZA27148*/ 05502000
         L     @02,FAILO                                        02S1428 05503000
         CR    @02,@11                                          02S1428 05504000
         BE    @RF01428                                         02S1428 05505000
*           FAILO->UCMDISPB='0'B;   /* YES, TURN OFF HC FLAG IN 02S1429 05506000
*                                      FAILING HC CONSOLE'S UCME        05507000
*                                                            @ZA27148*/ 05508000
         NI    UCMDISPB(@02),B'10111111'                        02S1429 05509000
*         HCSUSP=YES;               /* SET FLAG TO ISSUE MSG IEA964I */ 05510000
@RF01428 OI    HCSUSP,B'10000000'                               02S1430 05511000
*       END;                                                    02S1431 05512000
*   END HCSWITCH;                                               02S1432 05513000
*                                                               02S1432 05514000
@EL00017 DS    0H                                               02S1432 05515000
@EF00017 DS    0H                                               02S1432 05516000
@ER00017 L     @14,@SA00017                                     02S1432 05517000
         BR    @14                                              02S1432 05518000
*/*** END OF HCSWITCH SUBROUTINE *************************************/ 05519000
*                                                               02S1433 05520000
         EJECT                                                          05521000
*                                                               02S1433 05522000
*/*** START OF FNDHCALT SUBROUTINE ***********************************/ 05523000
*/*                                                                  */ 05524000
*/* FNDHCALT - SEARCHS FOR A CONSOLE SUITABLE TO RECEIVE HARDCOPY    */ 05525000
*/*                                                                  */ 05526000
*/* FUNCTION - A SEARCH OF THE CONSOLES IS MADE TO FIND A CONSOLE    */ 05527000
*/*            WHICH HAS THE FOLLOWING REQUIREMENTS:                 */ 05528000
*/*              1.  PAPER OUTPUT (NON GRAPHICS)                     */ 05529000
*/*              2.  ACTIVE AND NOT CLOSE PENDING                    */ 05530000
*/*            THE SEARCH SEQUENCES ARE AS FOLLOWS:                  */ 05531000
*/*              1.  FOR A HARDCOPY SWITCH FROM SYSLOG               */ 05532000
*/*                 A.  MASTER CONSOLE, THEN MASTERS ALTERNATE       */ 05533000
*/*                     CHAIN, THEN ALL CONSOLES SYSGENED.           */ 05534000
*/*              2.  FOR A SWITCH OF HARDCOPY FROM FAILING MASTER    */ 05535000
*/*                 A.  MASTERS ALTERNATE CHAIN, THEN ALL CONSOLES   */ 05536000
*/*                     SYSGENED.                                    */ 05537000
*/*              3.  FOR A HARDCOPY SWITCH FROM A FAILING SECONDARY  */ 05538000
*/*                 A.  FAILING CONSOLES ALTERNATE CHAIN, THEN       */ 05539000
*/*                     THE MASTER CONSOLE, THEN MASTERS ALTERNATE   */ 05540000
*/*                     CHAIN, THEN ALL CONSOLES SYSGENED.           */ 05541000
*/*                                                                  */ 05542000
*/* CALLERS -  HCSWITCH AND VCPU                                     */ 05543000
*/*                                                                  */ 05544000
*/* INPUT  -   CSACODE  CONTAINS CODE INDICATE TYPE OF SWITCH        */ 05545000
*/*            FAILI/FAILO CONTAIN PTRS TO FAILING CONSOLES UCMES IF */ 05546000
*/*                        HARDCOPY WAS TO A CONSOLE.                */ 05547000
*/*            UCMSYSD  IS 'ON' IF FAILING CONSOLE IS MASTER         */ 05548000
*/*                                                                  */ 05549000
*/* OUTPUT  -  NEWHC - CONTAINS THE UCME ADDRESS OF THE CONSOLE TO   */ 05550000
*/*                    RECEIVE HARDCOPY OR ZERO (0) IF NO SUITABLE   */ 05551000
*/*                    CONSOLE WAS FOUND.                            */ 05552000
*/*                                                                  */ 05553000
*/********************************************************************/ 05554000
*                                                               02S1433 05555000
*FNDHCALT:                                                      02S1433 05556000
*   PROC;                                                       02S1433 05557000
FNDHCALT STM   @14,@10,@SA00018                                 02S1433 05558000
         ST    @12,@SA00018+52                                  02S1433 05559000
*   ALTFND=NO;                      /* INITIALIZE SW TO 'NOT FOUND'  */ 05560000
         NI    ALTFND,B'11111110'                               02S1434 05561000
*   SW1=YES;                        /* SET DO WHILE LOOP CONTROL     */ 05562000
         OI    SW1,B'10000000'                                  02S1435 05563000
*   CALL CLEARDVC;                  /* CLEAR DEVICE TESTED FLAGS     */ 05564000
         BAL   @14,CLEARDVC                                     02S1436 05565000
*   RFY                                                         02S1437 05566000
*     UCMLIST BASED(NEWHC);         /* REBASE THE UCME FOR THIS SEG  */ 05567000
*   IF CSAHC='1'B                   /* IS HARDCOPY SWITCH FROM SYSLOG*/ 05568000
*     THEN                                                      02S1438 05569000
         TM    CSAHC(CXSAPTR),B'00000010'                       02S1438 05570000
         BNO   @RF01438                                         02S1438 05571000
*     NEWHC=UCMMCENT;               /* IF SYSLOG, START AT MASTER    */ 05572000
         L     NEWHC,UCMMCENT(,UCMMCSPT)                        02S1439 05573000
*   ELSE                            /* IF NOT SYSLOG,                */ 05574000
*     DO;                           /* START AT ALTERNATE OF FAILING */ 05575000
         B     @RC01438                                         02S1440 05576000
@RF01438 DS    0H                                               02S1441 05577000
*       NEWHC=FAILI->UCMALTEN;      /* ALTERNATE OF FAILING CONSOLE  */ 05578000
         L     @15,FAILI                                        02S1441 05579000
         L     NEWHC,UCMALTEN(,@15)                             02S1441 05580000
*       FAILI->UCMDEVCC=YES;        /* MARK FAILING AS TESTED        */ 05581000
         OI    UCMDEVCC(@15),B'00100000'                        02S1442 05582000
*       FAILO->UCMDEVCC=YES;        /* OUTPUT HALF TESTED ALSO       */ 05583000
         L     @01,FAILO                                        02S1443 05584000
         OI    UCMDEVCC(@01),B'00100000'                        02S1443 05585000
*     END;                                                      02S1444 05586000
*                                                               02S1444 05587000
*/********************************************************************/ 05588000
*/*                                                                  */ 05589000
*/*  NOW SEARCH FROM EITHER THE MASTER OR THE ALTERNATE OF THE       */ 05590000
*/*  FAILING CONSOLE FOR A CONSOLE TO RECIEVE HARDCOPY. IF SEARCH    */ 05591000
*/*  DID NOT BEGIN WITH MASTER A SECOND PASS IS MADE TO SEARCH THE   */ 05592000
*/*  MASTER AND ITS ALTERNATE CHAIN.  THE SEARCH END WHEN A CONSOLE  */ 05593000
*/*  IS FOUND, OR THE ALTERNATE CHAINS ARE EXAUSTED.                 */ 05594000
*/*                                                                  */ 05595000
*/********************************************************************/ 05596000
*                                                               02S1445 05597000
*   DO I=ONE TO TWO BY ONE WHILE SW1=YES;/* OUTER SEARCH LOOP        */ 05598000
@RC01438 LA    @15,1                                            02S1445 05599000
         ST    @15,I                                            02S1445 05600000
@DL01445 TM    SW1,B'10000000'                                  02S1445 05601000
         BNO   @DC01445                                         02S1445 05602000
*     DO WHILE NEWHC^=ZERO&ALTFND=NO;/* INNER SEARCH LOOP, TO SEARCH    05603000
*                                      ONE COMPLETE ALTERNATE CHAIN  */ 05604000
         B     @DE01446                                         02S1446 05605000
@DL01446 DS    0H                                               02S1447 05606000
*       IF UCMDEVCC=NO              /* WAS THIS DEVICE TESTED        */ 05607000
*         THEN                      /* IF NOT TESTED THEN TEST IT    */ 05608000
         TM    UCMDEVCC(NEWHC),B'00100000'                      02S1447 05609000
         BNZ   @RF01447                                         02S1447 05610000
*         DO;                       /* DO IF CONSOLE NOT TESTED      */ 05611000
*           UCMDEVCC=YES;           /* MARK CONSOLE AS TESTED        */ 05612000
         OI    UCMDEVCC(NEWHC),B'00100000'                      02S1449 05613000
*           IF UCMUF='1'B           /* IS CONSOLE ACTIVE             */ 05614000
*               &(UCMCF='0'B|CSAACR='1'B)/* AND NO CLOSE PENDING, OR    05615000
*                                      CLOSE PENDING AND ACR,        */ 05616000
*               &UCMVHRSN='0'B      /* AND ITS PATH IS NOT AFFECTED. */ 05617000
*             THEN                  /* IF SO, CONSOLE IS OK SO FAR.  */ 05618000
         TM    UCMUF(NEWHC),B'00010000'                         02S1450 05619000
         BNO   @RF01450                                         02S1450 05620000
         TM    UCMCF(NEWHC),B'00010000'                         02S1450 05621000
         BZ    @GL00091                                         02S1450 05622000
         TM    CSAACR(CXSAPTR),B'00010000'                      02S1450 05623000
         BNO   @RF01450                                         02S1450 05624000
@GL00091 TM    UCMVHRSN(NEWHC),B'00000001'                      02S1450 05625000
         BNZ   @RF01450                                         02S1450 05626000
*             IF UCMOF='1'B         /* IS IT AN OUTPUT TYPE DEVICE   */ 05627000
*               THEN                                            02S1451 05628000
         TM    UCMOF(NEWHC),B'10000000'                         02S1451 05629000
         BNO   @RF01451                                         02S1451 05630000
*               IF UCMDISPC='0'B    /* IF OUTPUT, IS IT NON-GRAPHIC  */ 05631000
*                 THEN                                          02S1452 05632000
         TM    UCMDISPC(NEWHC),B'00100000'                      02S1452 05633000
         BNZ   @RF01452                                         02S1452 05634000
*                 ALTFND=YES;       /* IF NON-GRAPHIC, FOUND IT      */ 05635000
         OI    ALTFND,B'00000001'                               02S1453 05636000
*               ELSE                                            02S1454 05637000
*                 NEWHC=UCMALTEN;   /* IF GRAPHIC GET NEXT           */ 05638000
         B     @RC01452                                         02S1454 05639000
@RF01452 L     NEWHC,UCMALTEN(,NEWHC)                           02S1454 05640000
*             ELSE                  /* IF NOT AN OUTPUT CONSOLE      */ 05641000
*               IF UCMCOMPC^=ZERO   /* IS IT INPUT HALF OF COMPOSIT  */ 05642000
*                 THEN              /* IF COMPOSIT,                  */ 05643000
         B     @RC01451                                         02S1455 05644000
@RF01451 L     @15,UCMCOMPC(,NEWHC)                             02S1455 05645000
         LTR   @15,@15                                          02S1455 05646000
         BZ    @RF01455                                         02S1455 05647000
*                 DO;               /* CHECK OUTPUT HALF             */ 05648000
*                   NEWHC=UCMCOMPC; /* GET PTR TO OTHER HALF         */ 05649000
         LR    NEWHC,@15                                        02S1457 05650000
*                   IF UCMDEVCC=NO  /* IS IT TESTED                  */ 05651000
*                     THEN          /* IF OTHER HALF IS NOT TESTED   */ 05652000
         TM    UCMDEVCC(NEWHC),B'00100000'                      02S1458 05653000
         BNZ   @RF01458                                         02S1458 05654000
*                     DO;           /* THEN TEST IT                  */ 05655000
*                       UCMDEVCC=YES;/* MARK IT TESTED               */ 05656000
         OI    UCMDEVCC(NEWHC),B'00100000'                      02S1460 05657000
*                       IF UCMDISPC='0'B/* IS IT NON-GRAPHIC         */ 05658000
*                           &UCMVHRSN='0'B/* AND ITS PATH NOT   02S1461 05659000
*                                      AFFECTED.                     */ 05660000
*                         THEN                                  02S1461 05661000
         TM    UCMDISPC(NEWHC),B'00100000'                      02S1461 05662000
         BNZ   @RF01461                                         02S1461 05663000
         TM    UCMVHRSN(NEWHC),B'00000001'                      02S1461 05664000
         BNZ   @RF01461                                         02S1461 05665000
*                         ALTFND=YES;/* IF SO, FOUND.                */ 05666000
         OI    ALTFND,B'00000001'                               02S1462 05667000
*                       ELSE                                    02S1463 05668000
*                         NEWHC=UCMALTEN;/* PTR TO NEXT              */ 05669000
         B     @RC01461                                         02S1463 05670000
@RF01461 L     NEWHC,UCMALTEN(,NEWHC)                           02S1463 05671000
*                     END;          /* END DO OTHER HALF NOT TESTED  */ 05672000
*                   ELSE                                        02S1465 05673000
*                     NEWHC=ZERO;   /* IF OTHER HALF TESTED END 02S1465 05674000
*                                      SEARCH THIS CHAIN             */ 05675000
         B     @RC01458                                         02S1465 05676000
@RF01458 SLR   NEWHC,NEWHC                                      02S1465 05677000
*                 END;              /* END OF TESTING OTHER HALF     */ 05678000
*               ELSE                                            02S1467 05679000
*                 NEWHC=UCMALTEN;   /* IF CLOSE PENDING OR NOT  02S1467 05680000
*                                      ACTIVE, GET NEXT              */ 05681000
         B     @RC01455                                         02S1467 05682000
@RF01455 L     NEWHC,UCMALTEN(,NEWHC)                           02S1467 05683000
*           ELSE                                                02S1468 05684000
*             NEWHC=UCMALTEN;       /* CLOSE PENDING OR NOT ACTIVE   */ 05685000
         B     @RC01450                                         02S1468 05686000
@RF01450 L     NEWHC,UCMALTEN(,NEWHC)                           02S1468 05687000
*         END;                      /* END DO IF ALTERNATE NOT TESTED*/ 05688000
*       ELSE                                                    02S1470 05689000
*         NEWHC=ZERO;               /* IF NEXT IS TESTED, CHAIN END  */ 05690000
         B     @RC01447                                         02S1470 05691000
@RF01447 SLR   NEWHC,NEWHC                                      02S1470 05692000
*     END;                          /* END OF INNER DO WHILE TO 02S1471 05693000
*                                      SEARCH ONE ALTERNATE CHAIN.   */ 05694000
@RC01447 DS    0H                                               02S1471 05695000
@DE01446 LTR   NEWHC,NEWHC                                      02S1471 05696000
         BZ    @DC01446                                         02S1471 05697000
         TM    ALTFND,B'00000001'                               02S1471 05698000
         BZ    @DL01446                                         02S1471 05699000
@DC01446 DS    0H                                               02S1472 05700000
*/*  DETERMINE IF SWITCH IS FROM FAILING SECONDARY. IF SO, 2ND PASS  */ 05701000
*                                                               02S1472 05702000
*     IF UCMSYSD=NO&ALTFND=NO&CSAHC=NO THEN                     02S1472 05703000
         TM    UCMSYSD(UCMMCSPT),B'00010000'                    02S1472 05704000
         BNZ   @RF01472                                         02S1472 05705000
         TM    ALTFND,B'00000001'                               02S1472 05706000
         BNZ   @RF01472                                         02S1472 05707000
         TM    CSAHC(CXSAPTR),B'00000010'                       02S1472 05708000
         BNZ   @RF01472                                         02S1472 05709000
*       NEWHC=UCMMCENT;             /* SET FOR 2ND PASS USING MASTER */ 05710000
         L     NEWHC,UCMMCENT(,UCMMCSPT)                        02S1473 05711000
*     ELSE                                                      02S1474 05712000
*       SW1=NO;                     /* IF NOT SECONDARY SKIP 2ND PASS*/ 05713000
         B     @RC01472                                         02S1474 05714000
@RF01472 NI    SW1,B'01111111'                                  02S1474 05715000
*   END;                            /* END OUTER DO WHILE SEARCH LOOP*/ 05716000
@RC01472 LA    @15,1                                            02S1475 05717000
         AL    @15,I                                            02S1475 05718000
         ST    @15,I                                            02S1475 05719000
         CH    @15,@CH00063                                     02S1475 05720000
         BNH   @DL01445                                         02S1475 05721000
@DC01445 DS    0H                                               02S1476 05722000
*/********************************************************************/ 05723000
*/*                                                                  */ 05724000
*/*  THE FOLLOWING DO GROUP WILL BE EXECUTED TO SEARCH ALL CONSOLES  */ 05725000
*/*  THAT WERE SYSGENED INTO THE SYSTEM IF NO ALTERNATE WAS FOUND    */ 05726000
*/*  IN THE PREVIOUS SEARCHS.                                        */ 05727000
*/*                                                                  */ 05728000
*/********************************************************************/ 05729000
*                                                               02S1476 05730000
*   DO CONTROL=UCMVEA TO UCMVEL BY UCMVEZ WHILE ALTFND=NO;      02S1476 05731000
         L     @15,UCMVEA(,UCMBASPT)                            02S1476 05732000
         B     @DE01476                                         02S1476 05733000
@DL01476 TM    ALTFND,B'00000001'                               02S1476 05734000
         BNZ   @DC01476                                         02S1476 05735000
*     NEWHC=CONTROL;                /* INITIALIZE NEW UCME PTR       */ 05736000
         LR    NEWHC,@15                                        02S1477 05737000
*     IF UCMDEVCC='0'B              /* IF THIS CONSOLE NOT TESTED    */ 05738000
*         &UCMUF='1'B               /* AND THE CONSOLE IS ACTIVE     */ 05739000
*         &(UCMCF='0'B|CSAACR='1'B) /* AND NOT CLOSE PENDING OR CLOSE   05740000
*                                      PENDING WITH ACR IN PROCESS   */ 05741000
*         &UCMOF='1'B               /* AND IT IS AN OUTPUT CONSOLE   */ 05742000
*         &UCMDISPC='0'B            /* AND IT IS A NON-GRAPHICS      */ 05743000
*         &UCMVHRSN='0'B            /* AND ITS PATH IS NOT AFFECTED  */ 05744000
*       THEN                                                    02S1478 05745000
         TM    UCMDEVCC(NEWHC),B'00100000'                      02S1478 05746000
         BNZ   @RF01478                                         02S1478 05747000
         TM    UCMUF(NEWHC),B'00010000'                         02S1478 05748000
         BNO   @RF01478                                         02S1478 05749000
         TM    UCMCF(NEWHC),B'00010000'                         02S1478 05750000
         BZ    @GL00100                                         02S1478 05751000
         TM    CSAACR(CXSAPTR),B'00010000'                      02S1478 05752000
         BNO   @RF01478                                         02S1478 05753000
@GL00100 TM    UCMOF(NEWHC),B'10000000'                         02S1478 05754000
         BNO   @RF01478                                         02S1478 05755000
         TM    UCMDISPC(NEWHC),B'00100000'                      02S1478 05756000
         BNZ   @RF01478                                         02S1478 05757000
         TM    UCMVHRSN(NEWHC),B'00000001'                      02S1478 05758000
         BNZ   @RF01478                                         02S1478 05759000
*       ALTFND=YES;                 /* ALTERNATE CONSOLE IS FOUND    */ 05760000
         OI    ALTFND,B'00000001'                               02S1479 05761000
*     ELSE                                                      02S1480 05762000
*       NEWHC=ZERO;                 /* OTHERWISE NOT FOUND YET       */ 05763000
         B     @RC01478                                         02S1480 05764000
@RF01478 SLR   NEWHC,NEWHC                                      02S1480 05765000
*   END;                                                        02S1481 05766000
@RC01478 L     @15,CONTROL                                      02S1481 05767000
         AL    @15,UCMVEZ(,UCMBASPT)                            02S1481 05768000
@DE01476 ST    @15,CONTROL                                      02S1481 05769000
         C     @15,UCMVEL(,UCMBASPT)                            02S1481 05770000
         BNH   @DL01476                                         02S1481 05771000
@DC01476 DS    0H                                               02S1482 05772000
*   CALL CLEARDVC;                  /* GO CLEAR DEVICE TESTED FLAGS  */ 05773000
         BAL   @14,CLEARDVC                                     02S1482 05774000
*   IF NEWHC^=ZERO                  /* IF A HARDCOPY CONSOLE WAS        05775000
*                                      FOUND                         */ 05776000
*     THEN                                                      02S1483 05777000
         LTR   NEWHC,NEWHC                                      02S1483 05778000
         BZ    @RF01483                                         02S1483 05779000
*     IF UCMCF='1'B                 /* AND IF IT HAS A CLOSE PENDING */ 05780000
*       THEN                                                    02S1484 05781000
         TM    UCMCF(NEWHC),B'00010000'                         02S1484 05782000
         BNO   @RF01484                                         02S1484 05783000
*       DO;                         /* RECLAIM CONSOLE FOR ACR       */ 05784000
*         UCMCF='0'B;               /* TURN OFF CLOSE PENDING        */ 05785000
         NI    UCMCF(NEWHC),B'11101111'                         02S1486 05786000
*         UCBCHGSX='0'B;            /* STOP CHANGE TO OFFLINE        */ 05787000
*         UCBDADIX='0'B;            /* STOP CHANGE FROM CONSOLE      */ 05788000
         L     @01,UCBPTR(,NEWHC)                               02S1488 05789000
         L     @15,UCBDADIX-3(,@01)                             02S1488 05790000
@GL00104 LR    @14,@15                                          02S1488 05791000
         N     @14,@CF03977                                     02S1488 05792000
         CS    @15,@14,UCBDADIX-3(@01)                          02S1488 05793000
         BNE   @GL00104                                         02S1488 05794000
*       END;                                                    02S1489 05795000
*   RFY                                                         02S1490 05796000
*     UCMLIST BASED(UCMDVEPT);      /* RESTORE UCME BASE             */ 05797000
*   END FNDHCALT;                                               02S1491 05798000
*                                                               02S1491 05799000
@EL00018 DS    0H                                               02S1491 05800000
@EF00018 DS    0H                                               02S1491 05801000
@ER00018 LM    @14,@10,@SA00018                                 02S1491 05802000
         L     @12,@SA00018+52                                  02S1491 05803000
         BR    @14                                              02S1491 05804000
*/*** END OF FNDHCALT SUBROUTINE *************************************/ 05805000
*                                                               02S1492 05806000
         EJECT                                                          05807000
*                                                               02S1492 05808000
*/*** START OF HCMSG SEGMENT *****************************************/ 05809000
*/*                                                                  */ 05810000
*/* HCMSG  -   SUBROUTINE TO BUILD AND QUEUE MSG IEE142I.            */ 05811000
*/*                                                                  */ 05812000
*/* FUNCTION - OBTAIN A WQE, BUILD MESSAGE IEE142I IN THE WQE,       */ 05813000
*/*            COMPLETE INITIALIZATION OF THE WQE, QUEUE THE NEW     */ 05814000
*/*            WQE TO THE NEW HARDCOPY CONSOLE, AND RETURN TO THE    */ 05815000
*/*            CALLER.  COMMON SUBROUTINES ARE USED TO GET THE WQE,  */ 05816000
*/*            COMPLETE THE INITIALIZATION, AND QUEUE THE NEW WQE    */ 05817000
*/*            TO ITS CONSOLE.                                       */ 05818000
*/*                                                                  */ 05819000
*/********************************************************************/ 05820000
*                                                               02S1492 05821000
*HCMSG:                                                         02S1492 05822000
*   PROC OPTIONS(SAVE(REG14));                                  02S1492 05823000
HCMSG    ST    @14,@SA00019                                     02S1492 05824000
*   CALL GETWQE;                    /* OBTAINS A WQE                 */ 05825000
         BAL   @14,GETWQE                                       02S1493 05826000
*   IF MSGPTR^=ONE                  /* WAS A WQE OBTAINED            */ 05827000
*     THEN                          /* IF YES, PROCEED               */ 05828000
         L     @02,MSGPTR                                       02S1494 05829000
         CH    @02,@CH00055                                     02S1494 05830000
         BE    @RF01494                                         02S1494 05831000
*     DO;                                                       02S1495 05832000
*       WQEPTR=MSGPTR;              /* BASE THE NEW WQE              */ 05833000
         L     @15,MSGPTR                                       02S1496 05834000
         LR    WQEPTR,@15                                       02S1496 05835000
*       MSGPTR=ZERO;                /* CLEAR THE ANSWER AREA         */ 05836000
         SLR   @15,@15                                          02S1497 05837000
         ST    @15,MSGPTR                                       02S1497 05838000
*       WQETXT=MSG142T;             /* MOVE MESSAGE TEXT TO WQE      */ 05839000
         MVI   WQETXT+36(WQEPTR),C' '                           02S1498 05840000
         MVC   WQETXT+37(91,WQEPTR),WQETXT+36(WQEPTR)           02S1498 05841000
         MVC   WQETXT(36,WQEPTR),@CC00123                       02S1498 05842000
*       M142DEV=NEWHC->UCMUCB->UCBNAME;/* MOVE DEVICE ADDR TO MSG    */ 05843000
         L     @01,UCMUCB(,NEWHC)                               02S1499 05844000
         MVC   M142DEV(3,WQEPTR),UCBNAME(@01)                   02S1499 05845000
*       WQENBR=LENGTH(MSG142T);     /* TEXT LENGTH FOR MSG IEE142I   */ 05846000
         MVC   WQENBR(4,WQEPTR),@CF00122                        02S1500 05847000
*       WQEUCMID=NEWHC->UCMID;      /* CONSOLE ID FOR QUEUEING MSG   */ 05848000
         MVC   WQEUCMID(1,WQEPTR),UCMID(NEWHC)                  02S1501 05849000
*/********************************************************************/ 05850000
*/*                                                                  */ 05851000
*/*  CALL THE WQE BUILD ROUTINE TO INITIALIZE THE REMAINING FIELDS   */ 05852000
*/*  IN THE WQE.                                                     */ 05853000
*/*                                                                  */ 05854000
*/********************************************************************/ 05855000
*                                                               02S1502 05856000
*       CALL BUILDWQE;              /* GO TO SUBROUTINE FOR WQE'S    */ 05857000
*                                                               02S1502 05858000
         BAL   @14,BUILDWQE                                     02S1502 05859000
*       /*************************************************************/ 05860000
*       /*                                                           */ 05861000
*       /* INFORM SUBSYSTEM OF MESSAGE IEE142I THEN TURN ON OUTPUT   */ 05862000
*       /* PENDING(UCMSYSJ) AND POSTREQ SWITCH SO AN XMPOST WILL BE  */ 05863000
*       /* DONE IN WRAPUP TO UCMOECB. THIS ACTION WILL CAUSE THE WQE */ 05864000
*       /* TO BE QUEUED TO THE APPROPRIATE CONSOLES SINCE THE WQE WAS*/ 05865000
*       /* PUT ON THE WQE QUEUE ANCHORED FROM THE UCM BASE (UCMWQEND)*/ 05866000
*       /* IN ROUTINE GETWQE.                                @ZA18877*/ 05867000
*       /*                                                           */ 05868000
*       /*************************************************************/ 05869000
*                                                               02S1503 05870000
*       CALL SUBEXIT;               /* INFORM SUBSYSTEM OF MSG  02S1503 05871000
*                                      IEE142I               @ZA18877*/ 05872000
         BAL   @14,SUBEXIT                                      02S1503 05873000
*       POSTREQ='1'B;               /* XMPOST REQUIRED TO INSURE WQE    05874000
*                                      QUEUING               @ZA18877*/ 05875000
         OI    POSTREQ,B'00000010'                              02S1504 05876000
*       UCMSYSJ='1'B;               /* SET OUTPUT PENDING    @ZA18877*/ 05877000
         OI    UCMSYSJ(UCMMCSPT),B'01000000'                    02S1505 05878000
*     END;                          /* END OF WQE OBTAINED PROCESSING*/ 05879000
*   END HCMSG;                                                  02S1507 05880000
*                                                               02S1507 05881000
@EL00019 DS    0H                                               02S1507 05882000
@EF00019 DS    0H                                               02S1507 05883000
@ER00019 L     @14,@SA00019                                     02S1507 05884000
         BR    @14                                              02S1507 05885000
*/*** END OF HCMSG SEGMENT *******************************************/ 05886000
*                                                               02S1508 05887000
         EJECT                                                          05888000
*                                                               02S1508 05889000
*/*** START OF SWFULCAP SUBROUTINE ***********************************/ 05890000
*/*                                                                  */ 05891000
*/* SWFULCAP - MAKE A OUTPUT-ONLY CRT A FULL I/O CONSOLE             */ 05892000
*/*                                                                  */ 05893000
*/* INPUT - NEWI = ADDR OF OUTPUT-ONLY CRT                           */ 05894000
*/*                                                                  */ 05895000
*/* OUTPUT - UCMDISPE = ON FULL CAPABILITY                           */ 05896000
*/*          UCMDISPD = OFF  OUTPUT ONLY                             */ 05897000
*/*          UCMDISPF = OFF  MSG STREAM                              */ 05898000
*/*          UCMDISPG = OFF  STATUS DISPLAY ONLY                     */ 05899000
*/*          UCMDISPG = OFF  OUTPUT ONLY                             */ 05900000
*/*          UCMIF = ON      ATTN SUPPORT                            */ 05901000
*/*          DCMSTSWT = ON   CHANGING STATUS                         */ 05902000
*/********************************************************************/ 05903000
*                                                               02S1508 05904000
*SWFULCAP:                                                      02S1508 05905000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                            02S1508 05906000
SWFULCAP DS    0H                                               02S1509 05907000
*   RESPECIFY                                                   02S1509 05908000
*     UCMLIST BASED(NEWI);          /* BASE UCME ON NEW CONSOLE ADDR */ 05909000
*   UCMDISPE='1'B;                  /* FULL I/O CAPABILITY           */ 05910000
*   UCMDISPD='0'B;                  /* NO LONGER OUTPUT ONLY         */ 05911000
*   UCMDISPF='0'B;                  /* NO LONGER MSG STREAM ONLY     */ 05912000
*   UCMDISPG='0'B;                  /* NO LONGER STATUS DISPLAY ONLY */ 05913000
         OI    UCMDISPE(NEWI),B'00001000'                       02S1513 05914000
         NI    UCMDISPD(NEWI),B'11101001'                       02S1513 05915000
*   UCMSDS5G='0'B;                  /* I/O HARDWARE NO LONGER IN        05916000
*                                      OUTPUT                        */ 05917000
         NI    UCMSDS5G(NEWI),B'11111101'                       02S1514 05918000
*   UCMIF='1'B;                     /* HAS ATTENTION SUPPORT         */ 05919000
         OI    UCMIF(NEWI),B'01000000'                          02S1515 05920000
*   UCMXB->DCMSTSWT='1'B;           /* CHANGING STATUS FOR DIDOCS    */ 05921000
         L     @11,UCMXB(,NEWI)                                 02S1516 05922000
         OI    DCMSTSWT(@11),B'10000000'                        02S1516 05923000
*   RESPECIFY                                                   02S1517 05924000
*     UCMLIST BASED(UCMDVEPT);      /* RETURN UCME BASE              */ 05925000
*   END;                                                        02S1518 05926000
*                                                               02S1518 05927000
@EL00020 DS    0H                                               02S1518 05928000
@EF00020 DS    0H                                               02S1518 05929000
@ER00020 BR    @14                                              02S1518 05930000
*/*** END OF SWFULCAP SUBROUTINE *************************************/ 05931000
*                                                               02S1519 05932000
         EJECT                                                          05933000
*                                                               02S1519 05934000
*/*** START OF GETWQE SUBROUTINE *************************************/ 05935000
*/*  GETWQE SEGMENT                                                  */ 05936000
*/*                                                                  */ 05937000
*/*  FUNCTION: THIS ROUTINE WILL GET CORE FOR A WQE.                 */ 05938000
*/*     THE OBTAINED CORE WILL BE ZEROED OUT.                        */ 05939000
*/*                                                                  */ 05940000
*/*  INPUT: NONE                                                     */ 05941000
*/*                                                                  */ 05942000
*/*  OUTPUT: A BLOCK OF THE PROPER SIZE AND ZEROED IS RETURNED TO THE*/ 05943000
*/*     CALLER IN MSGPTR.                                            */ 05944000
*/*     IF THE GETCELL WAS UNSUCCESSFUL THEN THE ADDR PTR IS SET TO  */ 05945000
*/*     ONE INSTEAD OF BEING THE ADDR OF THE NEW CELL.               */ 05946000
*/*                                                                  */ 05947000
*/********************************************************************/ 05948000
*                                                               02S1519 05949000
*GETWQE:                                                        02S1519 05950000
*   PROC;                                                       02S1519 05951000
GETWQE   STM   @14,@12,@SA00021                                 02S1519 05952000
*   RFY                                                         02S1520 05953000
*    (REG00,                                                    02S1520 05954000
*     REG01,                                                    02S1520 05955000
*     REG04,                                                    02S1520 05956000
*     REG07,                                                    02S1520 05957000
*     REG15) RSTD;                                              02S1520 05958000
*   MSGPTR=ZERO;                    /* ZERO OUT ADDR SO IT CAN BE       05959000
*                                      USED TO INDICATE SUCCESS OR      05960000
*                                      FAILURE OF GETCELL.           */ 05961000
         SLR   @14,@14                                          02S1521 05962000
         ST    @14,MSGPTR                                       02S1521 05963000
*   DO WHILE(MSGPTR=ZERO);          /* LOOP UNTILL ADDR GETS FILLED     05964000
*                                      IN.                           */ 05965000
         B     @DE01522                                         02S1522 05966000
@DL01522 DS    0H                                               02S1523 05967000
*     REG00=UCMWQECP;               /* PICK UP WQE CELL POOL ID.     */ 05968000
         L     REG00,UCMWQECP(,UCMBASPT)                        02S1523 05969000
*     GEN(GETCELL CPID=(0),BRANCH=YES)                          02S1524 05970000
*     REFS(REG00,CVTGETCL) SETS(REG01,REG15);                   02S1524 05971000
*                                                               02S1524 05972000
         GETCELL CPID=(0),BRANCH=YES                                    05973000
*/********************************************************************/ 05974000
*/*                                                                  */ 05975000
*/* SEE IF GETCELL WAS SUCCESSFUL                                    */ 05976000
*/*                                                                  */ 05977000
*/********************************************************************/ 05978000
*                                                               02S1525 05979000
*     IF REG15=ZERO THEN            /* DID WE GET A CELL             */ 05980000
         SLR   @14,@14                                          02S1525 05981000
         CR    REG15,@14                                        02S1525 05982000
         BNE   @RF01525                                         02S1525 05983000
*       DO;                                                     02S1526 05984000
*         MSGPTR=REG01;             /* SAVE ADDRESS TO WQE           */ 05985000
*                                                               02S1527 05986000
         ST    REG01,MSGPTR                                     02S1527 05987000
*         /***********************************************************/ 05988000
*         /*                                                         */ 05989000
*         /* ZERO OUT THE CONTROL BLOCK                              */ 05990000
*         /*                                                         */ 05991000
*         /***********************************************************/ 05992000
*                                                               02S1528 05993000
*         REG01->BITZERO(1:LENGTH(WQE)*EIGHT)=''B;              02S1528 05994000
         XC    BITZERO(192,REG01),BITZERO(REG01)                02S1528 05995000
*         UCMWQNR=UCMWQNR+ONE;      /* INCREMENT WQE COUNT           */ 05996000
         LA    @11,1                                            02S1529 05997000
         AH    @11,UCMWQNR(,UCMBASPT)                           02S1529 05998000
         STH   @11,UCMWQNR(,UCMBASPT)                           02S1529 05999000
*/*  QUEUE THE NEW WQE INTO THE SYSTEM WQE QUEUE.                    */ 06000000
*                                                               02S1530 06001000
*         IF UCMWQEND=ZERO          /* IF THE WQE CHAIN IS EMPTY     */ 06002000
*           THEN                                                02S1530 06003000
         C     @14,UCMWQEND(,UCMBASPT)                          02S1530 06004000
         BNE   @RF01530                                         02S1530 06005000
*           UCMWQEND=ADDR(UCMWTOQ); /* PTR TO LAST PTS TO HEAD       */ 06006000
         LA    @14,UCMWTOQ(,UCMBASPT)                           02S1531 06007000
         ST    @14,UCMWQEND(,UCMBASPT)                          02S1531 06008000
*         UCMWQEND->WQELKPA=MSGPTR; /* POINT LAST WQE AT NEW ONE     */ 06009000
@RF01530 L     @14,MSGPTR                                       02S1532 06010000
         L     @11,UCMWQEND(,UCMBASPT)                          02S1532 06011000
         STCM  @14,7,WQELKPA(@11)                               02S1532 06012000
*         UCMWQEND=MSGPTR;          /* POINT END OF CHAIN AT NEW WQE */ 06013000
         ST    @14,UCMWQEND(,UCMBASPT)                          02S1533 06014000
*       END;                                                    02S1534 06015000
*                                                               02S1534 06016000
*/********************************************************************/ 06017000
*/*                                                                  */ 06018000
*/* WE DID NOT GET A CELL. CHECK IF WE ARE OUT OF CELLS. IF SO       */ 06019000
*/* THEN GET AN EXTENSION.                                           */ 06020000
*/*                                                                  */ 06021000
*/********************************************************************/ 06022000
*                                                               02S1535 06023000
*     ELSE                                                      02S1535 06024000
*       IF REG15=FOUR THEN          /* DO WE NEED TO EXTEND THE CELL    06025000
*                                      POOL                          */ 06026000
         B     @RC01525                                         02S1535 06027000
@RF01525 CH    REG15,@CH00065                                   02S1535 06028000
         BNE   @RF01535                                         02S1535 06029000
*         DO;                       /* YES.                          */ 06030000
*           REG04=CSAXC;            /* TCB ADDRESS FOR GETMAIN       */ 06031000
         L     REG04,CSAXC(,CXSAPTR)                            02S1537 06032000
*           REG07=CSAXF;            /* ASCB ADDRESS FOR GETMAIN      */ 06033000
         L     REG07,CSAXF(,CXSAPTR)                            02S1538 06034000
*           DO;                     /* GETMAIN (RC) LV(WQEPLSZ) 02S1539 06035000
*                                      SP(SUBPL231) BRANCH           */ 06036000
*             RESPECIFY                                         02S1540 06037000
*              (GPR01F,                                         02S1540 06038000
*               GPR03F,                                         02S1540 06039000
*               GPR00F) RESTRICTED;                             02S1540 06040000
*             GPR01F=0;             /* REG 1 MUST BE ZERO            */ 06041000
         SLR   GPR01F,GPR01F                                    02S1541 06042000
*             GPR03F=0;             /* RC-TYPE GETMAIN               */ 06043000
         SLR   GPR03F,GPR03F                                    02S1542 06044000
*             GPR00F=WQEPLSZ;       /* LENGTH REQUESTED              */ 06045000
         LH    GPR00F,@CH00085                                  02S1543 06046000
*             GPR03F=GPR03F|((SUBPL231)*256);/* SP IN BYTE 2         */ 06047000
         O     GPR03F,@CF03911                                  02S1544 06048000
*             CALL CVTCRMN;         /* BRANCH ENTRY POINT            */ 06049000
         L     @11,LCVTPTR                                      02S1545 06050000
         L     @15,CVTCRMN(,@11)                                02S1545 06051000
         BALR  @14,@15                                          02S1545 06052000
*             RESPECIFY                                         02S1546 06053000
*              (GPR01F,                                         02S1546 06054000
*               GPR03F,                                         02S1546 06055000
*               GPR00F) UNRESTRICTED;                           02S1546 06056000
*           END;                    /* GETMAIN (RC) LV(WQEPLSZ) 02S1547 06057000
*                                      SP(SUBPL231) BRANCH           */ 06058000
*                                                               02S1547 06059000
*           /*********************************************************/ 06060000
*           /*                                                       */ 06061000
*           /* SEE IF GETMAIN WAS SUCCESSFUL. IF SO BUILD EXTENSION. */ 06062000
*           /*                                                       */ 06063000
*           /*********************************************************/ 06064000
*                                                               02S1548 06065000
*           IF REG15=ZERO THEN      /* DID WE GET SPACE FOR THE 02S1548 06066000
*                                      EXTENSION                     */ 06067000
         LTR   REG15,REG15                                      02S1548 06068000
         BNZ   @RF01548                                         02S1548 06069000
*             DO;                   /* YES, BUILD THE WQE EXTENSION  */ 06070000
*               CPEXTSAV=REG01;     /* SAVE ADDRES OF WQE EXTENSION  */ 06071000
         ST    REG01,CPEXTSAV                                   02S1550 06072000
*               REG00=UCMWQECP;     /* PICK UP THE WQE CELL POOL ID  */ 06073000
         L     REG00,UCMWQECP(,UCMBASPT)                        02S1551 06074000
*               REG15=LENGTH(WQE);  /* GET SIZE OF CELL REQUIRED.    */ 06075000
         LA    REG15,192                                        02S1552 06076000
*               GEN REFS(REG00,REG01,REG02,CVTBLDCP) SETS(REG15);       06077000
*                                                               02S1553 06078000
          BLDCPOOL CPID=(0),SP=231,CSIZE=(15),CPADDR=(1),BRANCH=YES,   *06079000
               AUTODEL=YES,POOLSIZ=4,SERIAL=YES                @ZA20159 06080000
*/********************************************************************/ 06081000
*/*                                                                  */ 06082000
*/* CHECK IF EXTENSION WAS SUCCESSFUL. IF NOT SET ERROR FLAG ON      */ 06083000
*/*                                                                  */ 06084000
*/********************************************************************/ 06085000
*                                                               02S1554 06086000
*               IF REG15^=ZERO THEN /* WAS EXTENSION UNSUCCESSFUL    */ 06087000
         LTR   REG15,REG15                                      02S1554 06088000
         BZ    @RF01554                                         02S1554 06089000
*                 DO;               /* YES. INDICATE SO IN XVWQEAD   */ 06090000
*                                                               02S1555 06091000
*                   /*************************************************/ 06092000
*                   /*                                               */ 06093000
*                   /* FREE THE WQE POOL EXTENSION.                  */ 06094000
*                   /*                                               */ 06095000
*                   /*************************************************/ 06096000
*                                                               02S1556 06097000
*                   DO;             /* FREEMAIN(R) LV(WQEPLSZ)SP(SUBP   06098000
*                                      L231)A(CPEXTSAV) BRANCH       */ 06099000
*                     RESPECIFY                                 02S1557 06100000
*                      (GPR01F,                                 02S1557 06101000
*                       GPR00F) RESTRICTED;                     02S1557 06102000
*                     GPR00F=WQEPLSZ;/* LENGTH REQUESTED             */ 06103000
         LH    GPR00F,@CH00085                                  02S1558 06104000
*                     GPR01F=SUBPL231;/* SP IN REG 1                 */ 06105000
         LA    GPR01F,231                                       02S1559 06106000
*                     GEN(SLL   GPR01F,24)                      02S1560 06107000
*                     NODEFS NOREFS NOSETS NOEXIT NOFLOWS SEQFLOW;      06108000
         SLL   GPR01F,24                                                06109000
*                     GPR00F=GPR00F|GPR01F;/* SP IN HI BYTE          */ 06110000
         OR    GPR00F,GPR01F                                    02S1561 06111000
*                     GPR01F=ADDR(CPEXTSAV);/* SET REGISTER ONE      */ 06112000
         LA    GPR01F,CPEXTSAV                                  02S1562 06113000
*                     CALL CVTRMBR; /* BRANCH ENTRY POINT            */ 06114000
         L     @11,LCVTPTR                                      02S1563 06115000
         L     @15,CVTRMBR(,@11)                                02S1563 06116000
         BALR  @14,@15                                          02S1563 06117000
*                     RESPECIFY                                 02S1564 06118000
*                      (GPR01F,                                 02S1564 06119000
*                       GPR00F) UNRESTRICTED;                   02S1564 06120000
*                   END;            /* FREEMAIN(R) LV(WQEPLSZ)SP(SUBP   06121000
*                                      L231)A(CPEXTSAV) BRANCH       */ 06122000
*                   MSGPTR=ONE;     /* INDICATE NO WQE OBTAINED.     */ 06123000
         MVC   MSGPTR(4),@CF00055                               02S1566 06124000
*                 END;                                          02S1567 06125000
*             END;                                              02S1568 06126000
*                                                               02S1568 06127000
*           /*********************************************************/ 06128000
*           /*                                                       */ 06129000
*           /* THE GETMAIN WAS NOT SUCCESSFUL                        */ 06130000
*           /*                                                       */ 06131000
*           /*********************************************************/ 06132000
*                                                               02S1569 06133000
*           ELSE                                                02S1569 06134000
*             MSGPTR=ONE;           /* INDICATE NO WQE OBTAINED TO      06135000
*                                      CALLER.                       */ 06136000
         B     @RC01548                                         02S1569 06137000
@RF01548 MVC   MSGPTR(4),@CF00055                               02S1569 06138000
*         END;                      /* OF CHECK FOR EXTENSION NEEDED.*/ 06139000
*/********************************************************************/ 06140000
*/*                                                                  */ 06141000
*/* THE ERROR WAS NOT DUE TO END OF EXTENSION. THE ERROR CAN NOT     */ 06142000
*/* BE CORRECTED SO SET ERROR INDICATOR FOR CALLER.                  */ 06143000
*/*                                                                  */ 06144000
*/********************************************************************/ 06145000
*                                                               02S1571 06146000
*       ELSE                                                    02S1571 06147000
*         MSGPTR=ONE;               /* INDICATE GET WQE UNSUCCESSFUL */ 06148000
         B     @RC01535                                         02S1571 06149000
@RF01535 MVC   MSGPTR(4),@CF00055                               02S1571 06150000
*   END;                            /* OF DO WHILE LOOP              */ 06151000
@RC01535 DS    0H                                               02S1572 06152000
@RC01525 DS    0H                                               02S1572 06153000
@DE01522 ICM   @14,15,MSGPTR                                    02S1572 06154000
         BZ    @DL01522                                         02S1572 06155000
*   RFY                                                         02S1573 06156000
*    (REG00,                                                    02S1573 06157000
*     REG01,                                                    02S1573 06158000
*     REG04,                                                    02S1573 06159000
*     REG07,                                                    02S1573 06160000
*     REG15) UNRSTD;                                            02S1573 06161000
*   END GETWQE;                                                 02S1574 06162000
*                                                               02S1574 06163000
@EL00021 DS    0H                                               02S1574 06164000
@EF00021 DS    0H                                               02S1574 06165000
@ER00021 LM    @14,@12,@SA00021                                 02S1574 06166000
         BR    @14                                              02S1574 06167000
*/*** END OF GETWQE SUBROUTINE ***************************************/ 06168000
*                                                               02S1575 06169000
         EJECT                                                          06170000
*                                                               02S1575 06171000
*/*** START OF BUILDWQE SEGMENT **************************************/ 06172000
*/*                                                                  */ 06173000
*/* BUILDWQE - INITIALIZES WQE'S CREATED BY IEAVSWCH                 */ 06174000
*/*                                                                  */ 06175000
*/* FUNCTION - FILLS IN THE MESSAGE HEADER, ISSUER INFO, AND ROUTING */ 06176000
*/*            INFO FOR MESSAGES IEE142I AND IEE143I.                */ 06177000
*/*                                                                  */ 06178000
*/* INPUT  -   WQEPTR CONTAINS THE ADDRESS OF THE WQE TO BE BUILT.   */ 06179000
*/*                                                                  */ 06180000
*/* OUTPUT -   THE FOLLOWING FIELDS IN THE WQE ARE INITIALIZED:      */ 06181000
*/*            WQERR, WQEPAD, WQETS, WQEPAD1, WQEJOBNM, WQEPAD2,     */ 06182000
*/*            WQEAUTH, WQEBUFD, WQEASID, WQETCB, WQEJSTCB,          */ 06183000
*/*            WQESEQN, WQEMCSFL, WQEROUTC, AND WQEDESC.             */ 06184000
*/*                                                                  */ 06185000
*/********************************************************************/ 06186000
*                                                               02S1575 06187000
*BUILDWQE:                                                      02S1575 06188000
*   PROC OPTIONS(NOSAVEAREA,SAVE(REG14));                       02S1575 06189000
BUILDWQE ST    @14,12(,@13)                                     02S1575 06190000
*   WQERR=M142143C;                 /* PUT IN ROUTE CODES FOR HC     */ 06191000
         MVC   WQERR(4,WQEPTR),@CC00106                         02S1576 06192000
*   WQEPAD=BLANK;                   /* MAKE SPACE                    */ 06193000
         MVI   WQEPAD(WQEPTR),C' '                              02S1577 06194000
*   WQETS=FMTDTS;                   /* MOVE TIME STAMP TO MESSAGE    */ 06195000
         MVC   WQETS(8,WQEPTR),FMTDTS                           02S1578 06196000
*   WQEPAD1=BLANK;                  /* MAKE SPACE                    */ 06197000
         MVI   WQEPAD1(WQEPTR),C' '                             02S1579 06198000
*   WQEJOBNM=CTJOBNM;               /* USE JOB ID OF COMM TASK       */ 06199000
         MVC   WQEJOBNM(8,WQEPTR),@CC00104                      02S1580 06200000
*   WQEPAD2=BLANK;                  /* MAKE A SPACE                  */ 06201000
         MVI   WQEPAD2(WQEPTR),C' '                             02S1581 06202000
*   WQEAUTH=YES;                    /* AUTHORIZED USER               */ 06203000
         OI    WQEAUTH(WQEPTR),B'00000001'                      02S1582 06204000
*   WQEBUFD='1'B;                   /* BUFFER OBTAINED DYN           */ 06205000
         OI    WQEBUFD(WQEPTR),B'00010000'                      02S1583 06206000
*   WQEASID=UCMCTID;                /* USE ASID OF COMMTASK          */ 06207000
         MVC   WQEASID(2,WQEPTR),UCMCTID(UCMBASPT)              02S1584 06208000
*   WQETCB=UCMPXA;                  /* CALLERS TCB IS COMM TASK'S    */ 06209000
         L     @15,UCMPXA(,UCMBASPT)                            02S1585 06210000
         ST    @15,WQETCB(,WQEPTR)                              02S1585 06211000
*   WQEJSTCB=UCMPXA;                /* JOB STEP TCB IS COMM TASKS    */ 06212000
         ST    @15,WQEJSTCB(,WQEPTR)                            02S1586 06213000
*   WQESEQN=UCMCMID;                /* MOVE IN NEXT MSG NUMBER       */ 06214000
         L     @15,UCMCMID(,UCMMCSPT)                           02S1587 06215000
         STCM  @15,7,WQESEQN(WQEPTR)                            02S1587 06216000
*   UCMCMID=UCMCMID+ONE;            /* INCREMENT NEXT MSG NUMBER     */ 06217000
         AL    @15,@CF00055                                     02S1588 06218000
         ST    @15,UCMCMID(,UCMMCSPT)                           02S1588 06219000
*   WQEMCSA='1'B;                   /* ROUTE AND DESC CODES EXIST    */ 06220000
*   WQEMCSB='1'B;                   /* QUEUE BY CONSOLE ID           */ 06221000
         OI    WQEMCSA(WQEPTR),B'11000000'                      02S1590 06222000
*   WQEROUTB='1'B;                  /* ROUTING CODE 2                */ 06223000
         OI    WQEROUTB(WQEPTR),B'01000000'                     02S1591 06224000
*   WQEDCD='1'B;                    /* DESCRIPTOR CODE 4             */ 06225000
         OI    WQEDCD(WQEPTR),B'00010000'                       02S1592 06226000
*   END BUILDWQE;                   /* RETURN TO CALLER              */ 06227000
@EL00022 DS    0H                                               02S1593 06228000
@EF00022 DS    0H                                               02S1593 06229000
@ER00022 L     @14,12(,@13)                                     02S1593 06230000
         BR    @14                                              02S1593 06231000
*/*** END OF BUILDWQE SEGMENT ****************************************/ 06232000
*                                                               02S1594 06233000
         EJECT                                                          06234000
*                                                               02S1594 06235000
*/*** START OF SUBEXIT SUBROUTINE****************************@ZA18877*/ 06236000
*/*                                                          @Y02668P*/ 06237000
*/*   SUBEXIT - EXIT TO THE JOB ENTRY SUBSYSTEM              @Y02668P*/ 06238000
*/*                                                                  */ 06239000
*/*  FUNCTION - GETS SPACE FOR THE SSOB AND SSOBWT FROM      @ZA18877*/ 06240000
*/*             SUBPOOL 231 WITH THE AUTOMATIC VARIABLES.    @ZA18877*/ 06241000
*/*             CONTRL IS THEN PASSED TO THE SUBSYSTEM VIA   @ZA18877*/ 06242000
*/*             THE IEFSSREQ MACRO.                          @ZA18877*/ 06243000
*/*                                                          @Y02668P*/ 06244000
*/********************************************************************/ 06245000
*                                                               02S1594 06246000
*SUBEXIT:                                                       02S1594 06247000
*   PROC OPTIONS(SAVE);             /*                       @ZA18877*/ 06248000
SUBEXIT  STM   @14,@12,@SA00023                                 02S1594 06249000
*   WQESUSP=YES;                    /* SUSPEND OPER OF WQE   @Y02668P*/ 06250000
         OI    WQESUSP(WQEPTR),B'00000010'                      02S1595 06251000
*   CALL FRLOCKS;                   /* FREE LOCKS            @Y02668P*/ 06252000
         BAL   @14,FRLOCKS                                      02S1596 06253000
*/********************************************************************/ 06254000
*/*                                                          @Y02668P*/ 06255000
*/*   SET UP THE SSOB                                        @Y02668P*/ 06256000
*/*                                                          @Y02668P*/ 06257000
*/********************************************************************/ 06258000
*                                                               02S1597 06259000
*   SSOBID=NAMESSOB;                /* FILL IN THE ID FIELD  @Y02668P*/ 06260000
         MVC   SSOBID(4),@CC00112                               02S1597 06261000
*   SSOBLEN=LENGTH(SSOB);           /* AND THE LENGTH FIELD  @Y02668P*/ 06262000
         MVC   SSOBLEN(2),@CH00069                              02S1598 06263000
*   SSOBFUNC=SSOBWTO;               /* SPECIFY WTO EXIT TO THE  02S1599 06264000
*                                      SUBSYSTEM             @Y02668P*/ 06265000
         MVC   SSOBFUNC(2),@CH00032                             02S1599 06266000
*   SSOBSSIB=ZERO;                  /* INDICATE SUBSYSTEM WHICH 02S1600 06267000
*                                      INITIATED THE USER.   @Y02668P*/ 06268000
         SLR   @04,@04                                          02S1600 06269000
         ST    @04,SSOBSSIB                                     02S1600 06270000
*   SSOBINDV=ADDR(SSWT);            /* POINT AT WTO INTERFACE BLOCK     06271000
*                                                            @Y02668P*/ 06272000
         LA    @03,SSWT                                         02S1601 06273000
         ST    @03,SSOBINDV                                     02S1601 06274000
*/********************************************************************/ 06275000
*/*                                                          @Y02668P*/ 06276000
*/*   NOW FILL IN THE SSWT BLOCK                             @Y02668P*/ 06277000
*/*                                                          @Y02668P*/ 06278000
*/********************************************************************/ 06279000
*                                                               02S1602 06280000
*   SSWTLEN=LENGTH(SSWT);           /* PUT LENGTH OF SSWT INTO THE      06281000
*                                      SSWT                  @Y02668P*/ 06282000
         MVC   SSWTLEN(2),@CH00071                              02S1602 06283000
*   SSWTWQE=WQEPTR;                 /* PUT IN THE ADDR OF THE WQE       06284000
*                                                            @Y02668P*/ 06285000
         ST    WQEPTR,SSWTWQE                                   02S1603 06286000
*   SSWTORE=ZERO;                   /* NO, SET FIELD TO ZERO @Y02668P*/ 06287000
         ST    @04,SSWTORE                                      02S1604 06288000
*   SSWTMIN=ZERO;                   /* THERE IS NO MINOR FOR A SINGLE   06289000
*                                      WTO                   @Y02668P*/ 06290000
         ST    @04,SSWTMIN                                      02S1605 06291000
*   RFY                                                         02S1606 06292000
*    (REG04,                                                    02S1606 06293000
*     REG13,                                                    02S1606 06294000
*     REG15) RSTD;                  /*                       @G51APSS*/ 06295000
*   REG04=REG13;                    /* SAVE SAVEAREA ADDR ACROSS        06296000
*                                      SUBYSSTEM EXIT        @Y02668P*/ 06297000
         LR    REG04,REG13                                      02S1607 06298000
*   REG13=ADDR(SAV0SAVE);           /* ASSIGN NEW SAVEAREA FOR SUB      06299000
*                                      EXIT                  @Y02668P*/ 06300000
         LA    REG13,SAV0SAVE                                   02S1608 06301000
*/*   ? IEFSSREQ  (SSOB);                                            */ 06302000
*/*                                                                  */ 06303000
*/*  PASS CONTROL TO JOB ENTRY SUBSYSTEM TO                          */ 06304000
*/*  PROCESS REQUEST -                                               */ 06305000
*/*                                                                  */ 06306000
*/*    INPUT - REGISTER 1 POINTS TO A ONE-                           */ 06307000
*/*            WORD PARAMETER LIST WHICH                             */ 06308000
*/*            POINTS TO THE SSOB                                    */ 06309000
*/*                                                                  */ 06310000
*                                                               02S1609 06311000
*   CALL SSREQ(SSOB);               /* CALL ON THE SUBSYSTEM @Y02668P*/ 06312000
         LA    @14,SSOB                                         02S1609 06313000
         ST    @14,@AL00001                                     02S1609 06314000
         MVI   @AL00001,X'80'                                   02S1609 06315000
         L     @03,LCVTPTR                                      02S1609 06316000
         L     @03,CVTJESCT(,@03)                               02S1609 06317000
         L     @15,JESSSREQ(,@03)                               02S1609 06318000
         LA    @01,@AL00001                                     02S1609 06319000
         BALR  @14,@15                                          02S1609 06320000
*   REG13=REG04;                    /* RESTORE SAVEAREA ADDR @Y02668P*/ 06321000
         LR    REG13,REG04                                      02S1610 06322000
*/********************************************************************/ 06323000
*/*                                                          @Y02668P*/ 06324000
*/*   CHECK FOR A REQUEST TO DELETE MESSAGE BY SUBSYSTEM.    @Y02668P*/ 06325000
*/*   CHECK FOR GOOD EXIT AND DELETION REQUEST.              @Y02668P*/ 06326000
*/*                                                          @Y02668P*/ 06327000
*/********************************************************************/ 06328000
*                                                               02S1611 06329000
*   CALL GETLOCKS;                  /* GET ALL LOCKS         @G51APSS*/ 06330000
         BAL   @14,GETLOCKS                                     02S1611 06331000
*   IF REG15=SSRTOK&                /* WAS EXIT SUCCESSFUL   @Y02668P*/ 06332000
*       SSOBRETN=SSWTNDSP           /* AND IS DON'T DISPLAY     02S1612 06333000
*                                      REQUESTED.                    */ 06334000
*     THEN                          /* YES                           */ 06335000
         LTR   REG15,REG15                                      02S1612 06336000
         BNZ   @RF01612                                         02S1612 06337000
         CLC   SSOBRETN(4),@CF00065                             02S1612 06338000
         BNE   @RF01612                                         02S1612 06339000
*     DO;                           /* DELETE MESSAGE        @Y02668P*/ 06340000
*       WQEBUFE=YES;                /* MARK WQE AS SERVICED  @Y02668P*/ 06341000
         OI    WQEBUFE(WQEPTR),B'00001000'                      02S1614 06342000
*       UCMSYSI=YES;                /* IND. CLEAN UP IS NEEDED  02S1615 06343000
*                                                            @Y02668P*/ 06344000
*                                                               02S1615 06345000
         OI    UCMSYSI(UCMMCSPT),B'10000000'                    02S1615 06346000
*       /*************************************************************/ 06347000
*       /*                                                           */ 06348000
*       /* CHECK IF HARDCOPY IS TO BE BYPASSED               @Y02668P*/ 06349000
*       /*                                                           */ 06350000
*       /*************************************************************/ 06351000
*                                                               02S1616 06352000
*       IF WQEMCSN=NO THEN          /* BYPASS HARDCOPY SET?  @Y02668P*/ 06353000
         TM    WQEMCSN(WQEPTR),B'00000100'                      02S1616 06354000
         BNZ   @RF01616                                         02S1616 06355000
*         DO;                       /* NO,SEND MESSAGE TO HARDCOPY      06356000
*                                                            @Y02668P*/ 06357000
*           WQEBUFC=YES;            /* IND. READY FOR HARDCOPY  02S1618 06358000
*                                                            @Y02668P*/ 06359000
         OI    WQEBUFC(WQEPTR),B'00100000'                      02S1618 06360000
*           WQEQFHC=YES;            /* SEND MESSAGE TO HARDCOPY 02S1619 06361000
*                                                            @Y02668P*/ 06362000
         OI    WQEQFHC(WQEPTR),B'01000000'                      02S1619 06363000
*         END;                      /* END IF BYPASS NOT SET @Y02668P*/ 06364000
*       ELSE                        /* IF BYPASS IS SET      @Y02668P*/ 06365000
*         DO;                       /* DO NOT HARDCOPY MESSAGE  02S1621 06366000
*                                                            @Y02668P*/ 06367000
         B     @RC01616                                         02S1621 06368000
@RF01616 DS    0H                                               02S1622 06369000
*           WQEQFHC=NO;             /* TURN OFF HARDCOPY FLAG   02S1622 06370000
*                                                            @Y02668P*/ 06371000
         NI    WQEQFHC(WQEPTR),B'10111111'                      02S1622 06372000
*         END;                      /* END IF BYPASS IS SET  @Y02668P*/ 06373000
*     END;                          /* END IF DON'T DISPLAY SPEC        06374000
*                                                            @Y02668P*/ 06375000
@RC01616 DS    0H                                               02S1625 06376000
*   RFY                                                         02S1625 06377000
*    (REG04,                                                    02S1625 06378000
*     REG13,                                                    02S1625 06379000
*     REG15) UNRSTD;                /*                       @G51APSS*/ 06380000
@RF01612 DS    0H                                               02S1626 06381000
*   WQESUSP=NO;                     /* TURN OFF SUSPEND BIT  @Y02669P*/ 06382000
         NI    WQESUSP(WQEPTR),B'11111101'                      02S1626 06383000
*   END SUBEXIT;                    /*                       @ZA18877*/ 06384000
@EL00023 DS    0H                                               02S1627 06385000
@EF00023 DS    0H                                               02S1627 06386000
@ER00023 LM    @14,@12,@SA00023                                 02S1627 06387000
         BR    @14                                              02S1627 06388000
*/*** END OF SUBEXIT SUBROUTINE******************************@ZA18877*/ 06389000
*                                                               02S1628 06390000
         EJECT                                                          06391000
*                                                               02S1628 06392000
*/*** START OF GETCQE SUBROUTINE *************************************/ 06393000
*/*                                                                  */ 06394000
*/* GETCQE - GETS A NEW CQE BLOCK                                    */ 06395000
*/*                                                                  */ 06396000
*/* FUNCTION - DOES A BRANCH ENTRY TO GETMAIN FOR 24 BYTES OF        */ 06397000
*/*    NON-FETCH-PROTECTED CSA.  ZEROS THE OBTAINED CORE.            */ 06398000
*/*    INDICATES END-OF-BLOCK IN NEW CQE.  CHAINS CQE TO THE END     */ 06399000
*/*    OF THE OUTPUT QUEUE OF THE UCME PASSED AS INPUT.              */ 06400000
*/*                                                                  */ 06401000
*/* INPUT - OUTQ = UCME ADDR OF CONSOLE TO GET NEW CQE BLOCK         */ 06402000
*/*                                                                  */ 06403000
*/* OUTPUT - CQEPTR = ADDR OF 1ST CQE ENTRY IN THE BLOCK             */ 06404000
*/*          GETCQEFL = 0 IF NO CQE WAS OBTAINED, 1 OTHERWISE.       */ 06405000
*/*                                                                  */ 06406000
*/********************************************************************/ 06407000
*                                                               02S1628 06408000
*GETCQE:                                                        02S1628 06409000
*   PROC OPTIONS(SAVE,NOSAVEAREA);                              02S1628 06410000
GETCQE   STM   @14,@12,12(@13)                                  02S1628 06411000
*   GETCQEFL=NO;                    /* INIT CQE OBTAINED FLAG        */ 06412000
         NI    GETCQEFL,B'11011111'                             02S1629 06413000
*/*   GET BRANCH ENTRY TO GET 24 BYTES OF CSA FOR A NEW BLOCK        */ 06414000
*                                                               02S1630 06415000
*   RFY                                                         02S1630 06416000
*    (REG04,                                                    02S1630 06417000
*     REG07,                                                    02S1630 06418000
*     REG15,                                                    02S1630 06419000
*     REG01) RSTD;                                              02S1630 06420000
*   REG04=CSAXC;                    /* TCB ADDR                      */ 06421000
         L     REG04,CSAXC(,CXSAPTR)                            02S1631 06422000
*   REG07=CSAXF;                    /* ASCB ADDR                     */ 06423000
         L     REG07,CSAXF(,CXSAPTR)                            02S1632 06424000
*   DO;                             /* GETMAIN (RC) LV(LENGTH(CQE))     06425000
*                                      SP(CQESP) BRANCH              */ 06426000
*     RESPECIFY                                                 02S1634 06427000
*      (GPR01F,                                                 02S1634 06428000
*       GPR03F,                                                 02S1634 06429000
*       GPR00F) RESTRICTED;                                     02S1634 06430000
*     GPR01F=0;                     /* REG 1 MUST BE ZERO            */ 06431000
         SLR   GPR01F,GPR01F                                    02S1635 06432000
*     GPR03F=0;                     /* RC-TYPE GETMAIN               */ 06433000
         SLR   GPR03F,GPR03F                                    02S1636 06434000
*     GPR00F=LENGTH(CQE);           /* LENGTH REQUESTED              */ 06435000
         LA    GPR00F,24                                        02S1637 06436000
*     GPR03F=GPR03F|((CQESP)*256);  /* SP IN BYTE 2                  */ 06437000
         O     GPR03F,@CF03912                                  02S1638 06438000
*     CALL CVTCRMN;                 /* BRANCH ENTRY POINT            */ 06439000
         L     @02,LCVTPTR                                      02S1639 06440000
         L     @15,CVTCRMN(,@02)                                02S1639 06441000
         BALR  @14,@15                                          02S1639 06442000
*     RESPECIFY                                                 02S1640 06443000
*      (GPR01F,                                                 02S1640 06444000
*       GPR03F,                                                 02S1640 06445000
*       GPR00F) UNRESTRICTED;                                   02S1640 06446000
*   END;                            /* GETMAIN (RC) LV(LENGTH(CQE))     06447000
*                                      SP(CQESP) BRANCH GET A CQE    */ 06448000
*   IF REG15^=0 THEN                /* WAS GETMAIN SUCCESSFUL        */ 06449000
         LTR   REG15,REG15                                      02S1642 06450000
         BZ    @RF01642                                         02S1642 06451000
*     GETCQEFL=YES;                 /* NO, SET FAILURE INDICATOR     */ 06452000
         OI    GETCQEFL,B'00100000'                             02S1643 06453000
*   ELSE                            /* YES                           */ 06454000
*     DO;                                                       02S1644 06455000
         B     @RC01642                                         02S1644 06456000
@RF01642 DS    0H                                               02S1645 06457000
*       CQEPTR=REG01;               /* SAVE PTR TO NEW CQE BLOCK     */ 06458000
         ST    REG01,CQEPTR                                     02S1645 06459000
*       RFY                                                     02S1646 06460000
*        (REG04,                                                02S1646 06461000
*         REG07,                                                02S1646 06462000
*         REG15,                                                02S1646 06463000
*         REG01) UNRSTD;            /*                       @G51APSS*/ 06464000
*       CQE=CQE&&CQE;               /* CLEAR CQE                     */ 06465000
         L     @07,CQEPTR                                       02S1647 06466000
         XC    CQE(24,@07),CQE(@07)                             02S1647 06467000
*       EVAL(CQEPTR+TWENTY)->CQEEOB=ONTWO;/* SET END-OF-BLOCK FLAGS     06468000
*                                      IN LAST ENTRY                 */ 06469000
         LA    @04,20                                           02S1648 06470000
         ALR   @04,@07                                          02S1648 06471000
         OI    CQEEOB(@04),B'11000000'                          02S1648 06472000
*       SW2='0'B;                   /* INIT END-OF-Q SWITCH          */ 06473000
         NI    SW2,B'10111111'                                  02S1649 06474000
*       CQEBLK=OUTQ->UCMOUTQ;       /* GET PTR TO FIRST CQE BLOCK    */ 06475000
         L     @04,OUTQ                                         02S1650 06476000
         L     @15,UCMOUTQ(,@04)                                02S1650 06477000
         ST    @15,CQEBLK                                       02S1650 06478000
*       CQEPTR2=CQEBLK;             /* GET PTR TO FIRST CQE ENTRY    */ 06479000
         ST    @15,CQEPTR2                                      02S1651 06480000
*       IF CQEPTR2=0 THEN           /* IS THERE AN OUTPUT QUEUE      */ 06481000
         LTR   @15,@15                                          02S1652 06482000
         BNZ   @RF01652                                         02S1652 06483000
*         OUTQ->UCMOUTQ=CQEPTR;     /* NO, NEW BLOCK IS 1ST ON QUEUE */ 06484000
         ST    @07,UCMOUTQ(,@04)                                02S1653 06485000
*       ELSE                        /* THERE IS AN OUTPUT QUEUE      */ 06486000
*         DO;                                                   02S1654 06487000
         B     @RC01652                                         02S1654 06488000
@RF01652 DS    0H                                               02S1655 06489000
*           RFY                                                 02S1655 06490000
*             CQE BASED(CQEPTR2);                               02S1655 06491000
*                                                               02S1655 06492000
*           /*********************************************************/ 06493000
*           /*                                                       */ 06494000
*           /* FIND END OF CONSOLE'S OUTPUT QUEUE                    */ 06495000
*           /*                                                       */ 06496000
*           /*********************************************************/ 06497000
*                                                               02S1656 06498000
*           DO WHILE(SW2='0'B);                                 02S1656 06499000
         B     @DE01656                                         02S1656 06500000
@DL01656 DS    0H                                               02S1657 06501000
*             IF CQEEOQ='0'B THEN   /* END-OF-Q                      */ 06502000
         L     @07,CQEPTR2                                      02S1657 06503000
         TM    CQEEOQ(@07),B'10000000'                          02S1657 06504000
         BNZ   @RF01657                                         02S1657 06505000
*               DO;                 /* NO                            */ 06506000
*                 CQEPTR2=CQEPTR2+LENGTH(CQEWQE);/* GET NEXT CQE        06507000
*                                      ENTRY                         */ 06508000
         AL    @07,@CF00065                                     02S1659 06509000
         ST    @07,CQEPTR2                                      02S1659 06510000
*                 IF CQEEOB=ONTWO THEN/* END-OF-BLOCK?               */ 06511000
         TM    CQEEOB(@07),B'11000000'                          02S1660 06512000
         BNO   @RF01660                                         02S1660 06513000
*                   DO;             /* YES                           */ 06514000
*                     CQEBLK=CQEWQEA;/* GET PTR TO NEXT CQE BLOCK    */ 06515000
         SLR   @04,@04                                          02S1662 06516000
         ICM   @04,7,CQEWQEA(@07)                               02S1662 06517000
         ST    @04,CQEBLK                                       02S1662 06518000
*                     CQEPTR2=CQEBLK;/* GET PTR TO NEXT CQE ENTRY    */ 06519000
         ST    @04,CQEPTR2                                      02S1663 06520000
*                   END;                                        02S1664 06521000
*               END;                                            02S1665 06522000
*             ELSE                                              02S1666 06523000
*               SW2='1'B;           /* INDICATE END-OF-Q FOUND       */ 06524000
         B     @RC01657                                         02S1666 06525000
@RF01657 OI    SW2,B'01000000'                                  02S1666 06526000
*           END;                                                02S1667 06527000
*                                                               02S1667 06528000
@RC01657 DS    0H                                               02S1667 06529000
@DE01656 TM    SW2,B'01000000'                                  02S1667 06530000
         BZ    @DL01656                                         02S1667 06531000
*           /*********************************************************/ 06532000
*           /*                                                       */ 06533000
*           /* CQEBLK POINTS TO LAST CQE BLOCK. CQEPTR2 POINTS TO    */ 06534000
*           /* LAST CQE ENTRY. ADD NEW BLOCK TO END OF OUTPUT QUEUE  */ 06535000
*           /*                                                       */ 06536000
*           /*********************************************************/ 06537000
*                                                               02S1668 06538000
*           CQEEOQ='0'B;            /* TURN OFF END-OF-Q INDICATOR IN   06539000
*                                      LAST ENTRY OF NEW QUEUE       */ 06540000
         L     @07,CQEPTR2                                      02S1668 06541000
         NI    CQEEOQ(@07),B'01111111'                          02S1668 06542000
*           EVAL(CQEBLK+TWENTY)->CQEWQE=CQEPTR;/* CHAIN NEW BLOCK TO    06543000
*                                      END OF QUEUE                  */ 06544000
         L     @07,CQEBLK                                       02S1669 06545000
         LA    @04,20                                           02S1669 06546000
         LR    @15,@07                                          02S1669 06547000
         ALR   @15,@04                                          02S1669 06548000
         MVC   CQEWQE(4,@15),CQEPTR                             02S1669 06549000
*           EVAL(CQEBLK+TWENTY)->CQEEOB=ONTWO;/* RESET EOB INDICATOR */ 06550000
         ALR   @07,@04                                          02S1670 06551000
         OI    CQEEOB(@07),B'11000000'                          02S1670 06552000
*           RFY                                                 02S1671 06553000
*             CQE BASED(CQEPTR);                                02S1671 06554000
*         END;                                                  02S1672 06555000
*     END;                                                      02S1673 06556000
*   END GETCQE;                                                 02S1674 06557000
*                                                               02S1674 06558000
@EL00024 DS    0H                                               02S1674 06559000
@EF00024 DS    0H                                               02S1674 06560000
@ER00024 LM    @14,@12,12(@13)                                  02S1674 06561000
         BR    @14                                              02S1674 06562000
*/*** END OF GETCQE SUBROUTINE ***************************************/ 06563000
*                                                               02S1675 06564000
         EJECT                                                          06565000
*                                                               02S1675 06566000
*/*** START OF ML1 SUBROUTINE ****************************************/ 06567000
*/*                                                                  */ 06568000
*/* ML1 - PROCESSING OF AN MLWTO                                     */ 06569000
*/*                                                                  */ 06570000
*/* FUNCTION - CLEARS MLWTO FLAGS IN THE UCME. CHECKS CURRENT        */ 06571000
*/*    ENTRY FOR CURRENT BEING WRITTEN, UNENDED, OR STATUS DISPLAY.  */ 06572000
*/*    IF SO, MARKS CQE ENTRY AS INVALID AND NO LONGER NEEDED.       */ 06573000
*/*                                                                  */ 06574000
*/* INPUT - UCMDVEPT = ADDR OF UCME                                  */ 06575000
*/*         CQEPTR = ADDR OF CQE                                     */ 06576000
*/*                                                                  */ 06577000
*/* OUTPUT - UCMMLAST = 0 PTR TO LAST MINOR PROCESSED                */ 06578000
*/*          UCMTC = 0 NO LONGER PROCESSING AN MLWTO                 */ 06579000
*/*          CQEENTR = 0  IF ENTRY SHOULD NOT BE REQUEUED            */ 06580000
*/*          CQEAVAIL = 1 IF ENTRY SHOULD NOT BE REQUEUED            */ 06581000
*/*                                                                  */ 06582000
*/********************************************************************/ 06583000
*                                                               02S1675 06584000
*ML1:                                                           02S1675 06585000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                            02S1675 06586000
ML1      DS    0H                                               02S1676 06587000
*   SW2='1'B;                       /* INIT PURGE NEEDED FLAG        */ 06588000
         OI    SW2,B'01000000'                                  02S1676 06589000
*   UCMMLAST=ZERO;                  /* CLEAR PTR TO LAST MINOR  02S1677 06590000
*                                      WRITTEN                       */ 06591000
         SLR   @04,@04                                          02S1677 06592000
         ST    @04,UCMMLAST(,UCMDVEPT)                          02S1677 06593000
*   UCMSDS5A='0'B;                  /* TURN OFF MLWTO NEEDED         */ 06594000
*   UCMSDS5B='0'B;                  /* TURN OFF INLINE OUTPUT PENDING*/ 06595000
*   UCMSDS5C='0'B;                  /* TURN OFF OUT-OF-LINE OUTPUT   */ 06596000
*   UCMSDS5F='0'B;                  /* TURN OFF 'UCMMLAST VALID'     */ 06597000
         NI    UCMSDS5A(UCMDVEPT),B'00011011'                   02S1681 06598000
*   UCMTC='0'B;                     /* CLEAR PROCESSING-MLWTO FLAG   */ 06599000
         NI    UCMTC(UCMDVEPT),B'11111110'                      02S1682 06600000
*   CONTROL=CQEWQEA;                /* SET UP FOR COMPARE            */ 06601000
         L     @04,CQEPTR                                       02S1683 06602000
         SLR   @15,@15                                          02S1683 06603000
         ICM   @15,7,CQEWQEA(@04)                               02S1683 06604000
         ST    @15,CONTROL                                      02S1683 06605000
*   IF UCMWLAST^=CONTROL THEN       /* IN PROCESS OF WRITING MLWTO ? */ 06606000
         C     @15,UCMWLAST(,UCMDVEPT)                          02S1684 06607000
         BE    @RF01684                                         02S1684 06608000
*     DO;                           /* NO                            */ 06609000
*       WMJPTR=CQEWQEA;             /* SET PTR TO MAJOR              */ 06610000
         ST    @15,WMJPTR                                       02S1686 06611000
*       IF WMJMLTYD='0'B THEN       /* END IN MAJOR ?                */ 06612000
         TM    WMJMLTYD(@15),B'00010000'                        02S1687 06613000
         BNZ   @RF01687                                         02S1687 06614000
*         IF WMJMMLWH='0'B THEN     /* NO, DUMMY MINOR ?             */ 06615000
         TM    WMJMMLWH(@15),B'00000001'                        02S1688 06616000
         BNZ   @RF01688                                         02S1688 06617000
*           DO;                     /* NO, SEARCH MINOR CHAIN FOR END*/ 06618000
*             WMNPTR=WMJMMIN;       /* GET PTR TO 1ST MAJOR          */ 06619000
*                                                               02S1690 06620000
         L     WMNPTR,WMJMMIN(,@15)                             02S1690 06621000
*             /*******************************************************/ 06622000
*             /*                                                     */ 06623000
*             /* SEARCH FOR AN END INDICATOR IN THE MINOR CHAIN      */ 06624000
*             /*                                                     */ 06625000
*             /*******************************************************/ 06626000
*                                                               02S1691 06627000
*             DO WHILE(WMNPTR^=ZERO);/* PROCESS WHOLE CHAIN          */ 06628000
         B     @DE01691                                         02S1691 06629000
@DL01691 DS    0H                                               02S1692 06630000
*               IF WMNMLT1D='1'B THEN/* END INDICATOR ?              */ 06631000
         TM    WMNMLT1D(WMNPTR),B'00010000'                     02S1692 06632000
         BNO   @RF01692                                         02S1692 06633000
*                 DO;               /* YES                           */ 06634000
*                   SW2='0'B;       /* DON'T PURGE                   */ 06635000
         NI    SW2,B'10111111'                                  02S1694 06636000
*                   WMNPTR=ZERO;    /* GET OUT OF LOOP               */ 06637000
         SLR   WMNPTR,WMNPTR                                    02S1695 06638000
*                 END;                                          02S1696 06639000
*               ELSE                                            02S1697 06640000
*                 WMNPTR=WMNMNX1;   /* GET PTR TO NEXT MINOR         */ 06641000
         B     @RC01692                                         02S1697 06642000
@RF01692 SLR   @04,@04                                          02S1697 06643000
         ICM   @04,7,WMNMNX1(WMNPTR)                            02S1697 06644000
         LR    WMNPTR,@04                                       02S1697 06645000
*             END;                                              02S1698 06646000
@RC01692 DS    0H                                               02S1698 06647000
@DE01691 LTR   WMNPTR,WMNPTR                                    02S1698 06648000
         BNZ   @DL01691                                         02S1698 06649000
*           END;                                                02S1699 06650000
*         ELSE                                                  02S1700 06651000
*           ;                                                   02S1700 06652000
@RF01688 DS    0H                                               02S1701 06653000
*       ELSE                                                    02S1701 06654000
*         SW2='0'B;                 /* DON'T PURGE                   */ 06655000
         B     @RC01687                                         02S1701 06656000
@RF01687 NI    SW2,B'10111111'                                  02S1701 06657000
*     END;                                                      02S1702 06658000
@RC01687 DS    0H                                               02S1703 06659000
*   IF SW2='0'B THEN                /* END LINE FOUND                */ 06660000
@RF01684 TM    SW2,B'01000000'                                  02S1703 06661000
         BNZ   @RF01703                                         02S1703 06662000
*     IF WMJMDECH='1'B&WMJMDECI='1'B THEN/* STATUS DISPLAY           */ 06663000
         L     @04,WMJPTR                                       02S1704 06664000
         TM    WMJMDECH(@04),B'00000001'                        02S1704 06665000
         BNO   @RF01704                                         02S1704 06666000
         TM    WMJMDECI(@04),B'10000000'                        02S1704 06667000
         BNO   @RF01704                                         02S1704 06668000
*       SW2='1'B;                   /* YES, PURGE                    */ 06669000
         OI    SW2,B'01000000'                                  02S1705 06670000
*   IF SW2='1'B THEN                /* PURGE ?                       */ 06671000
@RF01704 DS    0H                                               02S1706 06672000
@RF01703 TM    SW2,B'01000000'                                  02S1706 06673000
         BNO   @RF01706                                         02S1706 06674000
*     DO;                           /* YES                           */ 06675000
*       CQEAVAIL='1'B;              /* MARK ENTRY NO LONGER NEEDED   */ 06676000
*       CQEENTR='0'B;               /* INDICATE ENTRY IS NO LONGER      06677000
*                                      VALID                         */ 06678000
         L     @04,CQEPTR                                       02S1709 06679000
         OI    CQEAVAIL(@04),B'00000010'                        02S1709 06680000
         NI    CQEENTR(@04),B'11111110'                         02S1709 06681000
*     END;                                                      02S1710 06682000
*   END;                                                        02S1711 06683000
*                                                               02S1711 06684000
@EL00025 DS    0H                                               02S1711 06685000
@EF00025 DS    0H                                               02S1711 06686000
@ER00025 BR    @14                                              02S1711 06687000
*/*** END OF ML1 SUBROUTINE ******************************************/ 06688000
*                                                               02S1712 06689000
         EJECT                                                          06690000
*                                                               02S1712 06691000
*/*** START OF CLEARDVC SUBROUTINE ***********************************/ 06692000
*/*                                                                  */ 06693000
*/* CLEARDVC - CLEARS THE DEVICE TESTED BIT IN EVERY UCME            */ 06694000
*/*                                                                  */ 06695000
*/* INPUT - NONE                                                     */ 06696000
*/*                                                                  */ 06697000
*/* OUTPUT - UCMDEVCC=OFF IN EACH UCME                               */ 06698000
*/*                                                                  */ 06699000
*/********************************************************************/ 06700000
*                                                               02S1712 06701000
*CLEARDVC:                                                      02S1712 06702000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                            02S1712 06703000
CLEARDVC DS    0H                                               02S1713 06704000
*   DO UCMDVEPT=UCMVEA TO UCMVEL BY UCMVEZ;/* PROCESS ALL UCMES      */ 06705000
         L     UCMDVEPT,UCMVEA(,UCMBASPT)                       02S1713 06706000
         B     @DE01713                                         02S1713 06707000
@DL01713 DS    0H                                               02S1714 06708000
*     UCMDEVCC='0'B;                /* TURN OFF DEVICE TESTED FLAG   */ 06709000
         NI    UCMDEVCC(UCMDVEPT),B'11011111'                   02S1714 06710000
*   END;                                                        02S1715 06711000
         AL    UCMDVEPT,UCMVEZ(,UCMBASPT)                       02S1715 06712000
@DE01713 C     UCMDVEPT,UCMVEL(,UCMBASPT)                       02S1715 06713000
         BNH   @DL01713                                         02S1715 06714000
*   END;                                                        02S1716 06715000
*                                                               02S1716 06716000
@EL00026 DS    0H                                               02S1716 06717000
@EF00026 DS    0H                                               02S1716 06718000
@ER00026 BR    @14                                              02S1716 06719000
*/*** END OF CLEARDVC SUBROUTINE *************************************/ 06720000
*                                                               02S1717 06721000
         EJECT                                                          06722000
*                                                               02S1717 06723000
*/*** START OF GETLOCKS SEGMENT **************************************/ 06724000
*/*                                                                  */ 06725000
*/* GETLOCKS - IS A SUBROUTINE WHICH IS CALLED TO OBTAIN THE LOCAL   */ 06726000
*/*            AND CMS GLOBAL LOCKS. A SETFRR IS ALSO ISSUED TO      */ 06727000
*/*            PLACE SWITCH'S FRR ON THE STACK.                      */ 06728000
*/*                                                                  */ 06729000
*/* INPUT -    REG12 CONTAINS THE PTR TO CXSA                        */ 06730000
*/*            NO GLOBAL LOCKS HIGHER THAN CMS CAN BE HELD           */ 06731000
*/*                                                                  */ 06732000
*/* OUTPUT -   ENVIRONMENT NOW INCLUDES LOCAL AND CMS LOCKS, FRR     */ 06733000
*/*            FOR IEAVSWCH IS ON THE STACK, AND FIELD CSADCBP       */ 06734000
*/*            CONTAINS A POINTER TO THE FRR WORK AREA (6 WORDS).    */ 06735000
*/*                                                                  */ 06736000
*/********************************************************************/ 06737000
*                                                               02S1717 06738000
*GETLOCKS:                                                      02S1717 06739000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                            02S1717 06740000
GETLOCKS DS    0H                                               02S1718 06741000
*   GENERATE CODE NODEFS REFS(PSA,PSALITA,FLC,UCMFRRAD,PSACSTK,FRRSCURR 06742000
*       ,FRRS,PARMLIST,SVC72ID,PSALSFCC,UCM,CSACTLM,FRRSLAST,FRRSELEN,  06743000
*       FRRSFRRA,FRRSPARM,FRRSENTR,CXSA) SETS(CSADCBP,LOCKSAVE,PARMID); 06744000
*  GENERATED BAL CODE TO ISSUE SETLOCK AND SETFRR                       06745000
         SPACE 1                                                        06746000
         STM   REG10,REG15,LOCKSAVE  SAVE 10 THRU 15 ACROSS MACROS      06747000
         LR    REG10,REG13         SAVE PTR TO REG SAVE AREA IN REG 10  06748000
         LR    REG15,REG12         SAVE BASE FOR CXSA                   06749000
         SPACE 1                                                        06750000
         SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                        *06751000
               RELATED=(UCM,IEAVSWCH(FRLOCKS))                          06752000
         SPACE 1                                                        06753000
         SETLOCK OBTAIN,TYPE=CMS,MODE=UNCOND,                          *06754000
               RELATED=(UCM,IEAVSWCH(FRLOCKS))                          06755000
         SPACE 2                                                        06756000
*  NOW SET FRR IN PLACE                                                 06757000
         SPACE 1                                                        06758000
         L     REG11,CSACTLM-CXSA(REG15)  GET PTR TO UCM BASE           06759000
         L     REG11,UCMFRRAD-UCM(REG11)   GET PTR TO COMMON FRR RTN    06760000
         SPACE 1                                                        06761000
         SETFRR A,FRRAD=(11),PARMAD=(13),WRKREGS=(12,13),              *06762000
               RELATED=(CMS-LOCK,IEAVSWCH(FRLOCKS))                     06763000
         SPACE 1                                                        06764000
         ST    REG13,CSADCBP-CXSA(REG15)  SAVE PTR TO FRR WORK AREA     06765000
         MVC   PARMID-PARMLIST(4,REG13),SVC72ID  MOVE IN RECOVERY ID    06766000
         LM    REG10,REG15,LOCKSAVE  RESTORE MODIFIED REGS              06767000
*   END GETLOCKS;                                               02S1719 06768000
*                                                               02S1719 06769000
@EL00027 DS    0H                                               02S1719 06770000
@EF00027 DS    0H                                               02S1719 06771000
@ER00027 BR    @14                                              02S1719 06772000
*/*** END OF GETLOCKS SEGMENT ****************************************/ 06773000
*                                                               02S1720 06774000
         EJECT                                                          06775000
*                                                               02S1720 06776000
*/*** START OF FRLOCKS SEGMENT ***************************************/ 06777000
*/*                                                                  */ 06778000
*/* FRLOCKS -  IS A SUBROUTINE WHICH IS CALLED TO RELEASE THE LOCAL  */ 06779000
*/*            AND CMS LOCKS AND REMOVE THE FRR FROM THE STACK       */ 06780000
*/*                                                                  */ 06781000
*/* INPUT -    REG 12 POINTS TO CXSA                                 */ 06782000
*/*            THE CMS AND GLOBAL LOCKS ARE HELD AND THE FRR FOR     */ 06783000
*/*            IEAVSWCH IS HIGHEST ON THE STACK                      */ 06784000
*/*                                                                  */ 06785000
*/* OUTPUT -   ENVIRONMENT IS NOW UNLOCKED WITH NO FRR FOR THIS      */ 06786000
*/*            MODULE ON THE STACK. FIELD CSADCBP CONTAINS 0.        */ 06787000
*/*                                                                  */ 06788000
*/********************************************************************/ 06789000
*                                                               02S1720 06790000
*FRLOCKS:                                                       02S1720 06791000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                            02S1720 06792000
FRLOCKS  DS    0H                                               02S1721 06793000
*   GENERATE CODE NODEFS REFS(PSA,PSACSTK,FRRS,FRRSCURR,FRRSEMP,        06794000
*       FRRSELEN,PSALSFCC,PSALITA,FLC,CXSA) SETS(CSADCBP,LOCKSAVE);     06795000
*  GENERATED BAL CODE TO ISSUE SETFRR AND SETLOCK                       06796000
         SPACE 1                                                        06797000
         STM   REG10,REG15,LOCKSAVE  SAVE 10 THRU 15 ACROSS MACROS      06798000
         LR    REG10,REG13         SAVE REG 13                          06799000
         LR    REG15,REG12         SWITCH PTR TO CXSA                   06800000
         SPACE 2                                                        06801000
*  REMOVE FRR FROM THE STACK                                            06802000
         SPACE 1                                                        06803000
         SETFRR D,WRKREGS=(12,13),                                     *06804000
               RELATED=(CMS-LOCK,IEAVSWCH(GETLOCKS))                    06805000
         SR    REG12,REG12         SET TO ZERO                          06806000
         ST    REG12,CSADCBP-CXSA(REG15)  CLEAR FRR WORK AREA POINTER   06807000
         SPACE 2                                                        06808000
*  FREE THE CMS GLOBAL LOCK                                             06809000
         SPACE 1                                                        06810000
         SETLOCK RELEASE,TYPE=CMS,                                     *06811000
               RELATED=(UCM,IEAVSWCH(GETLOCKS))                         06812000
         SPACE 2                                                        06813000
*  FREE THE LOCAL LOCK                                                  06814000
         SPACE 1                                                        06815000
         SETLOCK RELEASE,TYPE=LOCAL,                                   *06816000
               RELATED=(UCM,IEAVSWCH(GETLOCKS))                         06817000
         SPACE 1                                                        06818000
         LM    REG10,REG15,LOCKSAVE  RESTORE MODIFIED REGS              06819000
*   END FRLOCKS;                                                02S1722 06820000
*                                                               02S1722 06821000
@EL00028 DS    0H                                               02S1722 06822000
@EF00028 DS    0H                                               02S1722 06823000
@ER00028 BR    @14                                              02S1722 06824000
*/*** END OF FRLOCKS SEGMENT *****************************************/ 06825000
*                                                               02S1723 06826000
         EJECT                                                          06827000
*                                                               02S1723 06828000
*/*** START OF ENQQ4 SUBROUTINE **************************************/ 06829000
*/*                                                                  */ 06830000
*/* ENQQ4  - ENQ ON SYSIEFSD Q4 EXCLUSIVELY. TRY FIVE TIMES  @G51APSS*/ 06831000
*/*          FIVE SECONDS APART                              @G51APSS*/ 06832000
*/*                                                                  */ 06833000
*/* INPUT  - NONE                                            @G51APSS*/ 06834000
*/*                                                                  */ 06835000
*/* OUTPUT - HAVEQ4 = ON IF ENQ WAS SUCCESSFUL               @G51APSS*/ 06836000
*/*                                                                  */ 06837000
*/********************************************************************/ 06838000
*                                                               02S1723 06839000
*ENQQ4:                                                         02S1723 06840000
*   PROC OPTIONS(SAVE);             /*                       @G51APSS*/ 06841000
ENQQ4    STM   @14,@12,@SA00029                                 02S1723 06842000
*   CALL FRLOCKS;                   /* RELEASE THE LOCKS     @G51APSS*/ 06843000
         BAL   @14,FRLOCKS                                      02S1724 06844000
*   HAVEQ4=NO;                      /* Q4 NOT OBTAINED YET   @G51APSS*/ 06845000
         NI    HAVEQ4,B'11101111'                               02S1725 06846000
*   DO I=1 TO 5 WHILE HAVEQ4=NO;    /* LOOP 5 TIMES OR UNTIL Q4 IS      06847000
*                                      OBTAINED              @G51APSS*/ 06848000
         LA    @07,1                                            02S1726 06849000
         ST    @07,I                                            02S1726 06850000
@DL01726 TM    HAVEQ4,B'00010000'                               02S1726 06851000
         BNZ   @DC01726                                         02S1726 06852000
*     RFY                                                       02S1727 06853000
*       REG15 RSTD;                 /*                       @G51APSS*/ 06854000
*     DO;                           /* ENQ (MAJOR,MINOR,E,TWO,SYSTEM)   06855000
*                                      RET(USE)                      */ 06856000
*       RESPECIFY                                               02S1729 06857000
*        (GPR01P) RESTRICTED;                                   02S1729 06858000
*       I056(1:16)=I056(1:16)&&I056(1:16);/* ZERO OUT THE TABLE      */ 06859000
         XC    I056(16),I056                                    02S1730 06860000
*       I05604(1)=TWO;              /* LENGTH OF MINOR RESOURCE NAME */ 06861000
         MVI   I05604,X'02'                                     02S1731 06862000
*       I05606(1)=ADDR(MAJOR);      /* ADDRESS OF MAJOR RESOURCE NAME*/ 06863000
         LA    @14,@CC00108                                     02S1732 06864000
         ST    @14,I05606                                       02S1732 06865000
*       I05607(1)=ADDR(MINOR);      /* ADDRESS OF MINOR RESOURCE NAME*/ 06866000
         LA    @14,@CC00110                                     02S1733 06867000
         ST    @14,I05607                                       02S1733 06868000
*       I05603(1)='01000000'B;      /* SET BIT STRING 1 FOR RESOURCE    06869000
*                                      ELEMENT                       */ 06870000
         MVI   I05603,B'01000000'                               02S1734 06871000
*       I05605(1)='01000011'B;      /* SET BIT STRING 2 FOR RESOURCE    06872000
*                                      ELEMENT                       */ 06873000
         MVI   I05605,B'01000011'                               02S1735 06874000
*       I05603(1,1)='1'B;           /* SET END OF LIST BIT           */ 06875000
         OI    I05603,B'10000000'                               02S1736 06876000
*       GPR01P=ADDR(I05602);        /* LOAD LIST ADDRESS             */ 06877000
         LA    GPR01P,I05602                                    02S1737 06878000
*       SVC(56);                    /* ISSUE ENQ SVC                 */ 06879000
         SVC   56                                               02S1738 06880000
*       RESPECIFY                                               02S1739 06881000
*        (GPR01P) UNRESTRICTED;                                 02S1739 06882000
*     END;                          /* ENQ (MAJOR,MINOR,E,TWO,SYSTEM)   06883000
*                                      RET(USE) ENQ ON Q4    @G51APSS*/ 06884000
*     IF REG15=ZERO THEN            /* Q4 OBTAINED?          @G51APSS*/ 06885000
         LTR   REG15,REG15                                      02S1741 06886000
         BNZ   @RF01741                                         02S1741 06887000
*       HAVEQ4=YES;                 /* YES                   @G51APSS*/ 06888000
         OI    HAVEQ4,B'00010000'                               02S1742 06889000
*     ELSE                          /* NO                    @G51APSS*/ 06890000
*       IF I<5 THEN                 /* LAST TIME TO TRY ENQ? @G51APSS*/ 06891000
         B     @RC01741                                         02S1743 06892000
@RF01741 L     @14,I                                            02S1743 06893000
         CH    @14,@CH00035                                     02S1743 06894000
         BNL   @RF01743                                         02S1743 06895000
*         DO;                       /* NO, WAIT 5 SEC        @G51APSS*/ 06896000
*           GEN REFS(FIVESEC)(STIMER WAIT,BINTVL=FIVESEC);/* @G51APSS*/ 06897000
         STIMER WAIT,BINTVL=FIVESEC                                     06898000
*         END;                      /*                       @G51APSS*/ 06899000
*     RFY                                                       02S1747 06900000
*       REG15 UNRSTD;               /*                       @G51APSS*/ 06901000
@RF01743 DS    0H                                               02S1747 06902000
@RC01741 DS    0H                                               02S1748 06903000
*   END;                            /* OF ENQ LOOP           @G51APSS*/ 06904000
         LA    @07,1                                            02S1748 06905000
         AL    @07,I                                            02S1748 06906000
         ST    @07,I                                            02S1748 06907000
         CH    @07,@CH00035                                     02S1748 06908000
         BNH   @DL01726                                         02S1748 06909000
@DC01726 DS    0H                                               02S1749 06910000
*   CALL GETLOCKS;                  /* OBTAIN THE LOCKS      @G51APSS*/ 06911000
         BAL   @14,GETLOCKS                                     02S1749 06912000
*   END ENQQ4;                      /*                       @G51APSS*/ 06913000
@EL00029 DS    0H                                               02S1750 06914000
@EF00029 DS    0H                                               02S1750 06915000
@ER00029 LM    @14,@12,@SA00029                                 02S1750 06916000
         BR    @14                                              02S1750 06917000
*/*** END OF ENQQ4 SUBROUTINE ****************************************/ 06918000
*                                                               02S1751 06919000
         EJECT                                                          06920000
*                                                               02S1751 06921000
*/*** START OF DEQQ4 SUBROUTINE **************************************/ 06922000
*/*                                                                  */ 06923000
*/* DEQQ4  - DEQ FROM SYSIEFSD Q4 IF IT IS CURRENTLY HELD    @G51APSS*/ 06924000
*/*                                                                  */ 06925000
*/* INPUT  - HAVEQ4 = ON IF Q4 HAS BEEN OBTAINED             @G51APSS*/ 06926000
*/*                                                                  */ 06927000
*/* OUTPUT - HAVEQ4 = OFF                                    @G51APSS*/ 06928000
*/*                                                                  */ 06929000
*/********************************************************************/ 06930000
*                                                               02S1751 06931000
*DEQQ4:                                                         02S1751 06932000
*   PROC OPTIONS(SAVE);             /*                       @G51APSS*/ 06933000
DEQQ4    STM   @14,@12,@SA00030                                 02S1751 06934000
*   IF HAVEQ4=YES THEN              /* SHOULD Q4 BE DEQ'ED?  @G51APSS*/ 06935000
         TM    HAVEQ4,B'00010000'                               02S1752 06936000
         BNO   @RF01752                                         02S1752 06937000
*     DO;                           /* YES                   @G51APSS*/ 06938000
*       CALL FRLOCKS;               /* RELEASE THE LOCKS     @G51APSS*/ 06939000
         BAL   @14,FRLOCKS                                      02S1754 06940000
*       DO;                         /* DEQ LS(1)                02S1755 06941000
*                                      (MAJOR,MINOR,TWO,SYSTEM)      */ 06942000
*         I048(1:20)=I048(1:20)&&I048(1:20);                    02S1756 06943000
         XC    I048(20),I048                                    02S1756 06944000
*         RFY                                                   02S1757 06945000
*           GPR01F RESTRICTED;                                  02S1757 06946000
*         I04804(1)='11000000'B;    /* LISTEND BYTE                  */ 06947000
         MVI   I04804,B'11000000'                               02S1758 06948000
*         I04805(1)=TWO;            /* SET LENGTH                    */ 06949000
         MVI   I04805,X'02'                                     02S1759 06950000
*         I04806(1)='01000000'B;    /* OPTIONS                       */ 06951000
         MVI   I04806,B'01000000'                               02S1760 06952000
*         I04807(1)=ADDR(MAJOR);    /* QNAME ADDRESS                 */ 06953000
         LA    @07,@CC00108                                     02S1761 06954000
         ST    @07,I04807                                       02S1761 06955000
*         I04808(1)=ADDR(MINOR);    /* RNAME ADDRESS                 */ 06956000
         LA    @07,@CC00110                                     02S1762 06957000
         ST    @07,I04808                                       02S1762 06958000
*         GPR01F=ADDR(I04802);                                  02S1763 06959000
         LA    GPR01F,I04802                                    02S1763 06960000
*         SVC(48);                                              02S1764 06961000
         SVC   48                                               02S1764 06962000
*         RFY                                                   02S1765 06963000
*           GPR01F UNRESTRICTED;                                02S1765 06964000
*       END;                        /* DEQ LS(1)                02S1766 06965000
*                                      (MAJOR,MINOR,TWO,SYSTEM) DEQ     06966000
*                                      Q4                    @G51APSS*/ 06967000
*       HAVEQ4=NO;                  /* NO LONGER HAVE Q4     @G51APSS*/ 06968000
         NI    HAVEQ4,B'11101111'                               02S1767 06969000
*       CALL GETLOCKS;              /* OBTAIN THE LOCKS      @G51APSS*/ 06970000
         BAL   @14,GETLOCKS                                     02S1768 06971000
*     END;                          /*                       @G51APSS*/ 06972000
*   END DEQQ4;                      /*                       @G51APSS*/ 06973000
@EL00030 DS    0H                                               02S1770 06974000
@EF00030 DS    0H                                               02S1770 06975000
@ER00030 LM    @14,@12,@SA00030                                 02S1770 06976000
         BR    @14                                              02S1770 06977000
*/*** END OF DEQQ4 SUBROUTINE ****************************************/ 06978000
*                                                               02S1771 06979000
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */ 06980000
*     GPR00F FIXED(31) REG(0),                                  01S1771 06981000
*     GPR01F FIXED(31) REG(1),                                  01S1771 06982000
*     GPR03F FIXED(31) REG(3),                                  01S1771 06983000
*     GPR15F FIXED(31) REG(15),                                 01S1771 06984000
*     GPR00P PTR(31) REG(0),                                    01S1771 06985000
*     GPR01P PTR(31) REG(1);                                    01S1771 06986000
*   DCL                                                         01S1772 06987000
*     1 I056 DEF(ILIST) BDY(WORD) CHAR(32767),/* LIST FOR ENQ        */ 06988000
*       3 I05601 PTR(31),           /* TCB OR ECB ADDRESS            */ 06989000
*       3 I05602(*) CHAR(12) BDY(WORD),/* ARRAY OF RESOURCE ELEMENTS */ 06990000
*         5 I05603 BIT(8),          /* BIT FLAGS 1                   */ 06991000
*         5 I05604 PTR(8),          /* MINOR RESOURCE NAME LENGTH    */ 06992000
*         5 I05605 BIT(8),          /* BIT FLAGS 2                   */ 06993000
*         5 I05655 CHAR(1),         /* CONTROL PGM USE               */ 06994000
*         5 I05606 PTR(31),         /* MAJOR RESOURCE NAME ADDR      */ 06995000
*         5 I05607 PTR(31);         /* MINOR RESOURCE NAME ADDR      */ 06996000
*   DCL                                                         01S1773 06997000
*     1 I048 DEF(ILIST) CHAR(32767) BDY(WORD),                  01S1773 06998000
*       3 I04801 PTR(31),           /* TCB ADDR                      */ 06999000
*       3 I04802(*) CHAR(12) BDY(WORD),                         01S1773 07000000
*         5 I04803 PTR(31),         /* UCB @ IN LAST ENTRY           */ 07001000
*           7 I04804 BIT(8),        /* FLAGS                         */ 07002000
*           7 I04805 PTR(8),        /* MINOR RESOURCE NAME LENGTH    */ 07003000
*           7 I04806 BIT(8),        /* FLAGS                         */ 07004000
*           7 * CHAR(1),            /* CONTROL PROGRAM USE           */ 07005000
*         5 I04807 PTR(31),         /* MAJOR RESOURCE NAME @         */ 07006000
*         5 I04808 PTR(31);         /* MINOR RESOURCE NAME @         */ 07007000
*   DCL                                                         01S1774 07008000
*     1 I002 DEF(ILIST),            /* DEFINE LIST                   */ 07009000
*      2 I00201 PTR(31),            /* ECB ADDRESS                   */ 07010000
*      2 I00202 PTR(31),            /* ASCB ADDRESS                  */ 07011000
*      2 I00203 PTR(31);            /* ERRET ADDRESS                 */ 07012000
*   DECLARE                                                     01S1775 07013000
*     ILIST CHAR(20) BDY(DWORD);    /* STANDARD LIST                 */ 07014000
*   DECLARE                         /* COMMON VARIABLES              */ 07015000
*     I256C CHAR(256) BASED,                                    01S1776 07016000
*     I031F FIXED(31) BASED,                                    01S1776 07017000
*     I031P PTR(31) BASED,                                      01S1776 07018000
*     I015F FIXED(15) BASED,                                    01S1776 07019000
*     I015P PTR(15) BASED,                                      01S1776 07020000
*     I008P PTR(8) BASED,                                       01S1776 07021000
*     I001C CHAR(1) BASED;                                      01S1776 07022000
*   END IEAVSWCH                                                01S1777 07023000
*                                                               01S1777 07024000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 07025000
*/*%INCLUDE SYSUT5  (PROLOGUE)                                       */ 07026000
*/*%INCLUDE SYSUT5  (DECLARES)                                       */ 07027000
*/*%INCLUDE SYSLIB  (IEFJSSOB)                                       */ 07028000
*/*%INCLUDE SYSLIB  (IEFJESCT)                                       */ 07029000
*/*%INCLUDE SYSLIB  (IHAASCB )                                       */ 07030000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 07031000
*/*%INCLUDE SYSLIB  (IHACTM  )                                       */ 07032000
*/*%INCLUDE SYSLIB  (IEERDCM )                                       */ 07033000
*/*%INCLUDE SYSLIB  (IHAFRRS )                                       */ 07034000
*/*%INCLUDE SYSLIB  (IEZMPL  )                                       */ 07035000
*/*%INCLUDE SYSLIB  (IHAORE  )                                       */ 07036000
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */ 07037000
*/*%INCLUDE SYSLIB  (IHARB   )                                       */ 07038000
*/*%INCLUDE SYSLIB  (IKJRB   )                                       */ 07039000
*/*%INCLUDE SYSLIB  (IHASCVT )                                       */ 07040000
*/*%INCLUDE SYSLIB  (IKJTCB  )                                       */ 07041000
*/*%INCLUDE SYSLIB  (IEFUCBOB)                                       */ 07042000
*/*%INCLUDE SYSLIB  (IEECUCM )                                       */ 07043000
*/*%INCLUDE SYSLIB  (IHAWQE  )                                       */ 07044000
*/*%INCLUDE SYSUT5  (INITSEG )                                       */ 07045000
*/*%INCLUDE SYSUT5  (CONSFAIL)                                       */ 07046000
*/*%INCLUDE SYSUT5  (VMSCON  )                                       */ 07047000
*/*%INCLUDE SYSUT5  (VCPU    )                                       */ 07048000
*/*%INCLUDE SYSUT5  (VCPUMAST)                                       */ 07049000
*/*%INCLUDE SYSUT5  (ACR     )                                       */ 07050000
*/*%INCLUDE SYSUT5  (WRAPUP  )                                       */ 07051000
*/*%INCLUDE SYSUT5  (EXTINNCC)                                       */ 07052000
*/*%INCLUDE SYSUT5  (FINDALT )                                       */ 07053000
*/*%INCLUDE SYSUT5  (SWCONS  )                                       */ 07054000
*/*%INCLUDE SYSUT5  (OREREQU )                                       */ 07055000
*/*%INCLUDE SYSUT5  (WQEREQU )                                       */ 07056000
*/*%INCLUDE SYSUT5  (DUPSRCH )                                       */ 07057000
*/*%INCLUDE SYSUT5  (MARKFAIL)                                       */ 07058000
*/*%INCLUDE SYSUT5  (NOALTM  )                                       */ 07059000
*/*%INCLUDE SYSUT5  (FNDALARM)                                       */ 07060000
*/*%INCLUDE SYSUT5  (VERGRAF )                                       */ 07061000
*/*%INCLUDE SYSUT5  (FNDPOWER)                                       */ 07062000
*/*%INCLUDE SYSUT5  (SETOSW  )                                       */ 07063000
*/*%INCLUDE SYSUT5  (STATMSG )                                       */ 07064000
*/*%INCLUDE SYSUT5  (SOUNDBEL)                                       */ 07065000
*/*%INCLUDE SYSUT5  (SOUNDPWR)                                       */ 07066000
*/*%INCLUDE SYSUT5  (SAVEINDX)                                       */ 07067000
*/*%INCLUDE SYSUT5  (SUBSWTCH)                                       */ 07068000
*/*%INCLUDE SYSUT5  (CALLDSP )                                       */ 07069000
*/*%INCLUDE SYSUT5  (BELLEXCP)                                       */ 07070000
*/*%INCLUDE SYSUT5  (HCSWITCH)                                       */ 07071000
*/*%INCLUDE SYSUT5  (REQHCMSG)                                       */ 07072000
*/*%INCLUDE SYSUT5  (FNDHCALT)                                       */ 07073000
*/*%INCLUDE SYSUT5  (HCMSG   )                                       */ 07074000
*/*%INCLUDE SYSUT5  (SWFULCAP)                                       */ 07075000
*/*%INCLUDE SYSUT5  (GETWQE  )                                       */ 07076000
*/*%INCLUDE SYSUT5  (BUILDWQE)                                       */ 07077000
*/*%INCLUDE SYSUT5  (SUBEXIT )                                       */ 07078000
*/*%INCLUDE SYSUT5  (GETCQE  )                                       */ 07079000
*/*%INCLUDE SYSUT5  (ML1     )                                       */ 07080000
*/*%INCLUDE SYSUT5  (CLEARDVC)                                       */ 07081000
*/*%INCLUDE SYSUT5  (GETLOCKS)                                       */ 07082000
*/*%INCLUDE SYSUT5  (FRLOCKS )                                       */ 07083000
*/*%INCLUDE SYSUT5  (ENQQ4   )                                       */ 07084000
*/*%INCLUDE SYSUT5  (DEQQ4   )                                       */ 07085000
*                                                               01S1777 07086000
*       ;                                                       01S1777 07087000
@DATA    DS    0H                                                       07088000
@CH00060 DC    H'0'                                                     07089000
@CH00063 DC    H'2'                                                     07090000
@CH00089 DC    H'3'                                                     07091000
@CH00035 DC    H'5'                                                     07092000
@CH00033 DC    H'6'                                                     07093000
@CH00032 DC    H'9'                                                     07094000
@CH00078 DC    H'15'                                                    07095000
@CH00071 DC    H'16'                                                    07096000
@CH00069 DC    H'20'                                                    07097000
@CH00434 DC    H'33'                                                    07098000
@CH00085 DC    H'4096'                                                  07099000
         DS    0F                                                       07100000
@AL01118 DC    A(@CH00060)             LIST WITH   1 ARGUMENT(S)        07101000
@AL01185 DC    A(@CF00055+2)           LIST WITH   1 ARGUMENT(S)        07102000
@DATD    DSECT                                                          07103000
         DS    0F                                                       07104000
@SA00001 DS    18F                                                      07105000
@SA00002 DS    14F                                                      07106000
@SA00003 DS    1F                                                       07107000
@SA00004 DS    14F                                                      07108000
@SA00010 DS    1F                                                       07109000
@SA00017 DS    1F                                                       07110000
@SA00018 DS    14F                                                      07111000
@SA00011 DS    15F                                                      07112000
@SA00012 DS    15F                                                      07113000
@SA00013 DS    15F                                                      07114000
@SA00014 DS    1F                                                       07115000
@SA00029 DS    15F                                                      07116000
@SA00030 DS    15F                                                      07117000
@SA00005 DS    14F                                                      07118000
@SA00006 DS    15F                                                      07119000
@SA00021 DS    15F                                                      07120000
@SA00023 DS    15F                                                      07121000
@SA00015 DS    15F                                                      07122000
@PC00015 DS    2F                                                       07123000
@SA00016 DS    15F                                                      07124000
@PC00016 DS    1F                                                       07125000
@SA00019 DS    1F                                                       07126000
@AL00001 DS    2A                                                       07127000
@TF00001 DS    F                                                        07128000
IEAVSWCH CSECT                                                          07129000
         DS    0F                                                       07130000
@CF00055 DC    F'1'                                                     07131000
@CH00055 EQU   @CF00055+2                                               07132000
@CF00065 DC    F'4'                                                     07133000
@CH00065 EQU   @CF00065+2                                               07134000
@CF00122 DC    F'36'                                                    07135000
@CF00135 DC    F'67'                                                    07136000
@CF00142 DC    F'71'                                                    07137000
@CF03911 DC    F'59136'                                                 07138000
@CF03912 DC    F'61696'                                                 07139000
@CF03908 DC    F'-4'                                                    07140000
@CF03732 DC    XL4'80000000'                                            07141000
@CF03963 DC    BL4'00000000000000000000000001000001'                    07142000
@CF03967 DC    BL4'00000000000000000000000011000001'                    07143000
@CF03973 DC    BL4'11111111111111111111111111111101'                    07144000
@CF03977 DC    BL4'11111111111111111111111110111110'                    07145000
@CF03980 DC    BL4'11111011111111111111111111111111'                    07146000
@CF03983 DC    BL4'00000000000000000000000010000010'                    07147000
@CF03988 DC    BL4'00000000000000000000000000000010'                    07148000
@CF03991 DC    BL4'00000000000000000000000001000011'                    07149000
@DATD    DSECT                                                          07150000
         DS    0D                                                       07151000
MSG143P2 DS    A                                                        07152000
FAILI    DS    A                                                        07153000
FAILO    DS    A                                                        07154000
NEWO     DS    A                                                        07155000
MASTERI  DS    A                                                        07156000
MASTERO  DS    A                                                        07157000
BELLCONS DS    A                                                        07158000
PWRCONS  DS    A                                                        07159000
OLDMAST  DS    A                                                        07160000
PATHUCME DS    A                                                        07161000
OUTQ     DS    A                                                        07162000
CQEPTR2  DS    A                                                        07163000
CQEBLK   DS    A                                                        07164000
RETCODE  DS    F                                                        07165000
CONTROL  DS    A                                                        07166000
I        DS    F                                                        07167000
J        DS    F                                                        07168000
MSGPTR   DS    A                                                        07169000
SAVCSAXA DS    A                                                        07170000
LCVTPTR  DS    A                                                        07171000
CQEPTR   DS    A                                                        07172000
FRREPTR  DS    A                                                        07173000
FRRSPTR  DS    A                                                        07174000
WMJPTR   DS    A                                                        07175000
FMTDTS   DS    CL8                                                      07176000
         ORG   FMTDTS                                                   07177000
HH       DS    CL2                                                      07178000
PER1     DS    CL1                                                      07179000
MM       DS    CL2                                                      07180000
PER2     DS    CL1                                                      07181000
SS       DS    CL2                                                      07182000
         ORG   FMTDTS+8                                                 07183000
MPLDEF   DS    CL12                                                     07184000
         ORG   MPLDEF                                                   07185000
WORD1    DS    FL4                                                      07186000
DBLWORD1 DS    CL8                                                      07187000
         ORG   DBLWORD1                                                 07188000
@NM00014 DS    CL1                                                      07189000
HHP      DS    CL2                                                      07190000
MMP      DS    CL2                                                      07191000
SSP      DS    CL2                                                      07192000
@NM00015 DS    CL1                                                      07193000
         ORG   MPLDEF+12                                                07194000
SWFLAGS  DS    CL4                                                      07195000
         ORG   SWFLAGS                                                  07196000
SWFLAG1  DS    BL1                                                      07197000
         ORG   SWFLAG1                                                  07198000
EXTSWREQ DS    BL1                                                      07199000
RINGBELL EQU   SWFLAG1+0                                                07200000
RINGPOWR EQU   SWFLAG1+0                                                07201000
HAVEQ4   EQU   SWFLAG1+0                                                07202000
HCSWREQ  EQU   SWFLAG1+0                                                07203000
EXCPERR  EQU   SWFLAG1+0                                                07204000
POSTREQ  EQU   SWFLAG1+0                                                07205000
ALTFND   EQU   SWFLAG1+0                                                07206000
         ORG   SWFLAGS+1                                                07207000
SWFLAG2  DS    BL1                                                      07208000
         ORG   SWFLAG2                                                  07209000
SW1      DS    BL1                                                      07210000
SW2      EQU   SWFLAG2+0                                                07211000
GETCQEFL EQU   SWFLAG2+0                                                07212000
FOUND    EQU   SWFLAG2+0                                                07213000
MSTSWTCH EQU   SWFLAG2+0                                                07214000
GRFSW    EQU   SWFLAG2+0                                                07215000
MSTFOUND EQU   SWFLAG2+0                                                07216000
MSTGRFND EQU   SWFLAG2+0                                                07217000
         ORG   SWFLAGS+2                                                07218000
SWFLAG3  DS    BL1                                                      07219000
         ORG   SWFLAG3                                                  07220000
ACCEPT   DS    BL1                                                      07221000
NCCNOW   EQU   SWFLAG3+0                                                07222000
CLOSEBEL EQU   SWFLAG3+0                                                07223000
CLOSEALR EQU   SWFLAG3+0                                                07224000
@NM00016 EQU   SWFLAG3+0                                                07225000
@NM00017 EQU   SWFLAG3+0                                                07226000
@NM00018 EQU   SWFLAG3+0                                                07227000
@NM00019 EQU   SWFLAG3+0                                                07228000
         ORG   SWFLAGS+3                                                07229000
MSGFLAG1 DS    BL1                                                      07230000
         ORG   MSGFLAG1                                                 07231000
HCSUSP   DS    BL1                                                      07232000
AMFAMSG  EQU   MSGFLAG1+0                                               07233000
@NM00020 EQU   MSGFLAG1+0                                               07234000
@NM00021 EQU   MSGFLAG1+0                                               07235000
@NM00022 EQU   MSGFLAG1+0                                               07236000
         ORG   SWFLAGS+4                                                07237000
OPENSAVE DS    CL12                                                     07238000
         ORG   OPENSAVE                                                 07239000
OPENSAV5 DS    AL4                                                      07240000
OPENSAV6 DS    AL4                                                      07241000
OPENSAV8 DS    AL4                                                      07242000
         ORG   OPENSAVE+12                                              07243000
SAV0SAVE DS    CL72                                                     07244000
SSOB     DS    CL20                                                     07245000
         ORG   SSOB                                                     07246000
SSOBID   DS    CL4                                                      07247000
SSOBLEN  DS    FL2                                                      07248000
SSOBFUNC DS    FL2                                                      07249000
SSOBSSIB DS    AL4                                                      07250000
SSOBRETN DS    AL4                                                      07251000
SSOBINDV DS    AL4                                                      07252000
         ORG   SSOB+20                                                  07253000
SSWT     DS    CL16                                                     07254000
         ORG   SSWT                                                     07255000
SSWTLEN  DS    FL2                                                      07256000
@NM00032 DS    FL2                                                      07257000
SSWTWQE  DS    AL4                                                      07258000
SSWTMIN  DS    AL4                                                      07259000
SSWTORE  DS    AL4                                                      07260000
         ORG   SSWT+16                                                  07261000
ILIST    DS    CL20                                                     07262000
LOCKSAVE DS    6F                                                       07263000
IEAVSWCH CSECT                                                          07264000
         DS    0F                                                       07265000
@SIZDATD DC    AL1(0)                                                   07266000
         DC    AL3(@ENDDATD-@DATD)                                      07267000
@CV00237 DC    V(IGC0I07B)                                              07268000
         DS    0D                                                       07269000
THREESEC DC    F'300'                                                   07270000
FIVESEC  DC    F'500'                                                   07271000
H80MASK  DC    XL4'80000000'                                            07272000
H40MASK  DC    XL4'40000000'                                            07273000
H00MASK  DC    XL4'00000000'                                            07274000
@CC00143 DC    C' IEE143I ROUTCDE=                                     C07275000
                        T=  H=  '                                       07276000
@CC00136 DC    C' IEE143I OLD=            NEW=            VALDCMD=     C07277000
                            '                                           07278000
@CC00123 DC    C' IEE142I      NOW RECEIVING HARDCOPY'                  07279000
@CC00101 DC    C'I-   ,O-   '                                           07280000
@CC00104 DC    C'CONSOLE '                                              07281000
@CC00108 DC    C'SYSIEFSD'                                              07282000
@CC00098 DC    C',CONS'                                                 07283000
@CC00087 DC    C'NONE'                                                  07284000
@CC00092 DC    C'INFO'                                                  07285000
@CC00094 DC    C',SYS'                                                  07286000
@CC00096 DC    C',I/O'                                                  07287000
@CC00106 DC    C'4000'                                                  07288000
@CC00112 DC    C'SSOB'                                                  07289000
@CC00090 DC    C'ALL'                                                   07290000
@CC00110 DC    C'Q4'                                                    07291000
@CC00120 DC    C'00'                                                    07292000
@CB00072 DC    X'FFFE'                                                  07293000
@CB00337 DC    X'1003'                                                  07294000
@CB00339 DC    X'100D'                                                  07295000
@CB00341 DC    X'100C'                                                  07296000
@CB00343 DC    X'1009'                                                  07297000
@CB00345 DC    X'100A'                                                  07298000
@CB00347 DC    X'100B'                                                  07299000
SVC72ID  DC    CL4'VCTR'                                                07300000
         DS    CL5                                                      07301000
RING1052 DS    CL8                                                      07302000
         ORG   RING1052                                                 07303000
CCODE    DC    X'0B'                                                    07304000
@NM00023 DC    XL3'00'                                                  07305000
SLI      DC    X'20'                                                    07306000
@NM00024 DC    X'00'                                                    07307000
BYTECNT  DC    X'0001'                                                  07308000
         ORG   RING1052+8                                               07309000
RING3270 DS    CL8                                                      07310000
         ORG   RING3270                                                 07311000
GRCCODE  DC    X'01'                                                    07312000
WCCADR   DC    AL3(WCC)                                                 07313000
GRSLI    DC    X'20'                                                    07314000
@NM00025 DC    X'00'                                                    07315000
GRBYTCT  DC    X'0001'                                                  07316000
         ORG   RING3270+8                                               07317000
WCC      DC    X'C4'                                                    07318000
         DS    CL7                                                      07319000
RINGPOWA DS    CL8                                                      07320000
         ORG   RINGPOWA                                                 07321000
PWRCODE  DC    X'E3'                                                    07322000
@NM00026 DC    XL3'00'                                                  07323000
PWRSLI   DC    X'20'                                                    07324000
@NM00027 DC    X'00'                                                    07325000
PWR0YTCT DC    X'0001'                                                  07326000
         ORG   RINGPOWA+8                                               07327000
RCTBL    DC    CL3'  1'                                                 07328000
         DC    CL3', 2'                                                 07329000
         DC    CL3', 3'                                                 07330000
         DC    CL3', 4'                                                 07331000
         DC    CL3', 5'                                                 07332000
         DC    CL3', 6'                                                 07333000
         DC    CL3', 7'                                                 07334000
         DC    CL3', 8'                                                 07335000
         DC    CL3', 9'                                                 07336000
         DC    CL3',10'                                                 07337000
         DC    CL3',11'                                                 07338000
         DC    CL3',12'                                                 07339000
         DC    CL3',13'                                                 07340000
         DC    CL3',14'                                                 07341000
         DC    CL3',15'                                                 07342000
PATCH    DC    21CL25'** IEAVSWCH PATCH AREA **'                        07343000
IEAVSWCH CSECT                                                          07344000
*                                          /*                @G51APSS*/ 07345000
SWCHUCDX DSECT                                                          07346000
         IEEUCDX                                                        07347000
@DATD    DSECT                                                          07348000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                07349000
@ENDDATD EQU   *                                                        07350000
IEAVSWCH CSECT                                                          07351000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       07352000
@01      EQU   01                                                       07353000
@02      EQU   02                                                       07354000
@03      EQU   03                                                       07355000
@04      EQU   04                                                       07356000
@05      EQU   05                                                       07357000
@06      EQU   06                                                       07358000
@07      EQU   07                                                       07359000
@08      EQU   08                                                       07360000
@09      EQU   09                                                       07361000
@10      EQU   10                                                       07362000
@11      EQU   11                                                       07363000
@12      EQU   12                                                       07364000
@13      EQU   13                                                       07365000
@14      EQU   14                                                       07366000
@15      EQU   15                                                       07367000
WMNPTR   EQU   @02                                                      07368000
WQEPTR   EQU   @02                                                      07369000
UCMDVEPT EQU   @02                                                      07370000
UCMBASPT EQU   @10                                                      07371000
UCMMCSPT EQU   @07                                                      07372000
OREPTR   EQU   @11                                                      07373000
MPLPTR   EQU   @02                                                      07374000
NEWHC    EQU   @11                                                      07375000
FAILHC   EQU   @02                                                      07376000
CONUCME  EQU   @03                                                      07377000
NEWI     EQU   @03                                                      07378000
MSG143P1 EQU   @04                                                      07379000
X        EQU   @11                                                      07380000
MSGTXTPT EQU   @11                                                      07381000
REG00    EQU   @00                                                      07382000
REG01    EQU   @01                                                      07383000
REG01F   EQU   @01                                                      07384000
REG02    EQU   @02                                                      07385000
REG04    EQU   @04                                                      07386000
REG05    EQU   @05                                                      07387000
REG06    EQU   @06                                                      07388000
REG07    EQU   @07                                                      07389000
REG08    EQU   @08                                                      07390000
REG09    EQU   @09                                                      07391000
REG10    EQU   @10                                                      07392000
REG12    EQU   @12                                                      07393000
REG13    EQU   @13                                                      07394000
REG14    EQU   @14                                                      07395000
REG15    EQU   @15                                                      07396000
CXSAPTR  EQU   @12                                                      07397000
GPR00P   EQU   @00                                                      07398000
GPR01F   EQU   @01                                                      07399000
GPR15F   EQU   @15                                                      07400000
GPR00F   EQU   @00                                                      07401000
GPR01P   EQU   @01                                                      07402000
GPR03F   EQU   @03                                                      07403000
REG03    EQU   @03                                                      07404000
REG11    EQU   @11                                                      07405000
CVTPTR   EQU   16                                                       07406000
PSA      EQU   0                                                        07407000
FLCRNPSW EQU   PSA                                                      07408000
FLCROPSW EQU   PSA+8                                                    07409000
FLCICCW2 EQU   PSA+16                                                   07410000
PSAEEPSW EQU   PSA+132                                                  07411000
PSAESPSW EQU   PSA+136                                                  07412000
FLCSVILC EQU   PSAESPSW+1                                               07413000
PSAEPPSW EQU   PSA+140                                                  07414000
FLCPIILC EQU   PSAEPPSW+1                                               07415000
FLCPICOD EQU   PSAEPPSW+2                                               07416000
PSAPICOD EQU   FLCPICOD+1                                               07417000
FLCTEA   EQU   PSAEPPSW+4                                               07418000
FLCPER   EQU   PSA+152                                                  07419000
FLCMCLA  EQU   PSA+168                                                  07420000
FLCCHNID EQU   FLCMCLA                                                  07421000
FLCCHTM  EQU   FLCCHNID                                                 07422000
FLCIOEL  EQU   FLCMCLA+4                                                07423000
FLCIOA   EQU   FLCMCLA+16                                               07424000
PSAMEDC  EQU   FLCMCLA+76                                               07425000
FLCFSA   EQU   FLCMCLA+80                                               07426000
PSATOLD  EQU   PSA+540                                                  07427000
PSAAOLD  EQU   PSA+548                                                  07428000
PSASUPER EQU   PSA+552                                                  07429000
PSASUP1  EQU   PSASUPER                                                 07430000
PSASUP2  EQU   PSASUPER+1                                               07431000
PSASUP3  EQU   PSASUPER+2                                               07432000
PSASUP4  EQU   PSASUPER+3                                               07433000
PSACLHT  EQU   PSA+640                                                  07434000
PSALKSA  EQU   PSA+696                                                  07435000
PSAHLHI  EQU   PSA+760                                                  07436000
PSALITA  EQU   PSA+764                                                  07437000
PSADSSFL EQU   PSA+836                                                  07438000
PSADSSF1 EQU   PSADSSFL                                                 07439000
PSADSSF3 EQU   PSADSSFL+2                                               07440000
PSADSSF4 EQU   PSADSSFL+3                                               07441000
PSARSVT  EQU   PSA+896                                                  07442000
PSALSFCC EQU   PSA+1012                                                 07443000
RV       EQU   0                                                        07444000
RETURNPT EQU   0                                                        07445000
IEAVMNTR EQU   0                                                        07446000
BITZERO  EQU   0                                                        07447000
DCMTSPTR EQU   0                                                        07448000
UCM2PTR  EQU   0                                                        07449000
JESCT    EQU   0                                                        07450000
JESWAA   EQU   JESCT+8                                                  07451000
JESSSREQ EQU   JESCT+20                                                 07452000
JESALLOC EQU   JESCT+32                                                 07453000
JESUNALC EQU   JESCT+36                                                 07454000
JESCATL  EQU   JESCT+40                                                 07455000
SSREQ    EQU   0                                                        07456000
ASCB     EQU   0                                                        07457000
ASCBSUPC EQU   ASCB+16                                                  07458000
ASCBRSM  EQU   ASCB+52                                                  07459000
ASCBRSMF EQU   ASCBRSM                                                  07460000
ASCBFW1  EQU   ASCB+100                                                 07461000
ASCBRCTF EQU   ASCBFW1+2                                                07462000
ASCBFLG1 EQU   ASCBFW1+3                                                07463000
ASCBDSP1 EQU   ASCB+114                                                 07464000
ASCBFLG2 EQU   ASCB+115                                                 07465000
ASCBLKGP EQU   ASCB+128                                                 07466000
ASCBSRQ  EQU   ASCB+180                                                 07467000
ASCBSRQ1 EQU   ASCBSRQ                                                  07468000
ASCBSRQ2 EQU   ASCBSRQ+1                                                07469000
ASCBSRQ3 EQU   ASCBSRQ+2                                                07470000
ASCBSRQ4 EQU   ASCBSRQ+3                                                07471000
CVTMAP   EQU   0                                                        07472000
CVTDAR   EQU   CVTMAP+72                                                07473000
CVTFLGS1 EQU   CVTDAR                                                   07474000
CVTBRET  EQU   CVTMAP+82                                                07475000
CVTCUCB  EQU   CVTMAP+100                                               07476000
CVTDCB   EQU   CVTMAP+116                                               07477000
CVTIOQET EQU   CVTMAP+120                                               07478000
CVTIERLC EQU   CVTMAP+144                                               07479000
CVTHEAD  EQU   CVTMAP+160                                               07480000
CVTSV76C EQU   CVTHEAD                                                  07481000
CVTOPTA  EQU   CVTMAP+182                                               07482000
CVTOPTB  EQU   CVTMAP+183                                               07483000
CVTABEND EQU   CVTMAP+200                                               07484000
CVTGTF   EQU   CVTMAP+236                                               07485000
CVTGTFST EQU   CVTGTF                                                   07486000
CVTGTFS  EQU   CVTGTFST                                                 07487000
CVTSTATE EQU   CVTGTFST                                                 07488000
CVTTMODE EQU   CVTGTFST                                                 07489000
CVTFORM  EQU   CVTGTFST                                                 07490000
CVTAQAVT EQU   CVTMAP+240                                               07491000
CVTTCMFG EQU   CVTAQAVT                                                 07492000
CVTVOLM2 EQU   CVTMAP+244                                               07493000
CVTTATA  EQU   CVTVOLM2                                                 07494000
CVTTSKS  EQU   CVTTATA                                                  07495000
CVTVOLF2 EQU   CVTTSKS                                                  07496000
CVTTAT   EQU   CVTTATA+1                                                07497000
CVTATER  EQU   CVTMAP+248                                               07498000
CVTEXT1  EQU   CVTMAP+252                                               07499000
CVTPURG  EQU   CVTMAP+260                                               07500000
CVTQMSG  EQU   CVTMAP+268                                               07501000
CVTDMSR  EQU   CVTMAP+272                                               07502000
CVTRSV37 EQU   CVTDMSR                                                  07503000
CVTDMSRF EQU   CVTRSV37                                                 07504000
CVTJESCT EQU   CVTMAP+296                                               07505000
CVTERPV  EQU   CVTMAP+316                                               07506000
CVTINTLA EQU   CVTMAP+320                                               07507000
CVTAPF   EQU   CVTMAP+324                                               07508000
CVTEXT2  EQU   CVTMAP+328                                               07509000
CVTHJES  EQU   CVTMAP+332                                               07510000
CVTPGSIA EQU   CVTMAP+348                                               07511000
CVTA1F1  EQU   CVTMAP+356                                               07512000
CVTSYSK  EQU   CVTMAP+357                                               07513000
CVTVOLM1 EQU   CVTMAP+380                                               07514000
CVTVOLF1 EQU   CVTVOLM1                                                 07515000
CVTATMCT EQU   CVTMAP+388                                               07516000
CVTXTNT1 EQU   0                                                        07517000
CVTXTNT2 EQU   0                                                        07518000
CVTDSSV  EQU   CVTXTNT2                                                 07519000
CVTFLGBT EQU   CVTXTNT2+5                                               07520000
CVTQID   EQU   CVTXTNT2+24                                              07521000
CVTRV400 EQU   CVTXTNT2+52                                              07522000
CVTRV409 EQU   CVTXTNT2+53                                              07523000
CVTATCVT EQU   CVTXTNT2+64                                              07524000
CVTRV429 EQU   CVTXTNT2+84                                              07525000
CVTRV438 EQU   CVTXTNT2+85                                              07526000
CVTRV457 EQU   CVTXTNT2+112                                             07527000
CVTRV466 EQU   CVTXTNT2+113                                             07528000
CVTFIX   EQU   0                                                        07529000
CVTRELNO EQU   CVTFIX+252                                               07530000
CQE      EQU   0                                                        07531000
CQEWQE   EQU   CQE                                                      07532000
CQEFLAG  EQU   CQEWQE                                                   07533000
CQEEOB   EQU   CQEFLAG                                                  07534000
CQEEOQ   EQU   CQEEOB                                                   07535000
CQEMLQHC EQU   CQEFLAG                                                  07536000
CQEMAJOR EQU   CQEFLAG                                                  07537000
CQEAVAIL EQU   CQEFLAG                                                  07538000
CQEENTR  EQU   CQEFLAG                                                  07539000
CQEWQEA  EQU   CQEWQE+1                                                 07540000
CXSA     EQU   0                                                        07541000
CSADCBP  EQU   CXSA+4                                                   07542000
CSANAME  EQU   CXSA+8                                                   07543000
CSAUCM   EQU   CXSA+16                                                  07544000
CSACODE  EQU   CSAUCM                                                   07545000
CSAVCPU  EQU   CSACODE                                                  07546000
CSAVCHAN EQU   CSACODE                                                  07547000
CSAACR   EQU   CSACODE                                                  07548000
CSAVMST  EQU   CSACODE                                                  07549000
CSAEXTI  EQU   CSACODE                                                  07550000
CSAHC    EQU   CSACODE                                                  07551000
CSAUCMA  EQU   CSAUCM+1                                                 07552000
CSACTLM  EQU   CXSA+20                                                  07553000
CSAXA    EQU   CXSA+24                                                  07554000
CSAXB    EQU   CXSA+28                                                  07555000
CSAXC    EQU   CXSA+32                                                  07556000
CSAXE    EQU   CXSA+40                                                  07557000
CSAXF    EQU   CXSA+44                                                  07558000
PARMLIST EQU   0                                                        07559000
PARMSTAT EQU   PARMLIST                                                 07560000
PARMFLAG EQU   PARMSTAT+1                                               07561000
PARMID   EQU   PARMLIST+20                                              07562000
DCMTSRT  EQU   0                                                        07563000
DCMRFLGS EQU   DCMTSRT+5                                                07564000
@NM00051 EQU   DCMTSRT+14                                               07565000
DCMDEVTY EQU   DCMTSRT+15                                               07566000
DCMADSDS EQU   DCMTSRT+16                                               07567000
DCMR2FLG EQU   DCMTSRT+44                                               07568000
DCMR3FLG EQU   DCMTSRT+45                                               07569000
DCMSTSWT EQU   DCMR3FLG                                                 07570000
DCMPACB  EQU   DCMTSRT+60                                               07571000
DCMACB   EQU   0                                                        07572000
DCMASACB EQU   DCMACB+5                                                 07573000
DCMACLR  EQU   DCMACB+9                                                 07574000
DCMAFLG1 EQU   DCMACLR+17                                               07575000
DCMAFLG2 EQU   DCMACLR+18                                               07576000
DCMATFLG EQU   DCMACLR+19                                               07577000
DCMADFLG EQU   DCMATFLG                                                 07578000
DCMATRCK EQU   DCMATFLG+1                                               07579000
FRRS     EQU   0                                                        07580000
FRRSHEAD EQU   FRRS                                                     07581000
FRRSEMP  EQU   FRRSHEAD                                                 07582000
FRRSLAST EQU   FRRSHEAD+4                                               07583000
FRRSELEN EQU   FRRSHEAD+8                                               07584000
FRRSCURR EQU   FRRSHEAD+12                                              07585000
FRRSENTR EQU   0                                                        07586000
FRRSFRRA EQU   FRRSENTR                                                 07587000
FRRSFLGS EQU   FRRSENTR+4                                               07588000
FRRSFLG1 EQU   FRRSFLGS                                                 07589000
FRRSPARM EQU   FRRSENTR+8                                               07590000
MPL      EQU   0                                                        07591000
MPLPROC  EQU   MPL                                                      07592000
MPLPROC1 EQU   MPLPROC                                                  07593000
MPLCONS  EQU   MPLPROC1                                                 07594000
MPLSTOP  EQU   MPLPROC1                                                 07595000
MPLID    EQU   MPL+2                                                    07596000
MPLTYPE  EQU   MPL+4                                                    07597000
MPLTYPE1 EQU   MPLTYPE                                                  07598000
OREF     EQU   0                                                        07599000
ORELKP   EQU   OREF                                                     07600000
OREXA    EQU   OREF+6                                                   07601000
OREXC    EQU   OREF+7                                                   07602000
OREBUFC  EQU   OREXC                                                    07603000
ORETCB   EQU   OREF+8                                                   07604000
OREWQE   EQU   OREF+12                                                  07605000
ORERPY   EQU   OREF+16                                                  07606000
OREECB   EQU   OREF+20                                                  07607000
RBPRFX   EQU   0                                                        07608000
RBBASIC  EQU   0                                                        07609000
RBEXRTNM EQU   RBBASIC                                                  07610000
RBTMFLD  EQU   RBEXRTNM                                                 07611000
RBSTAB   EQU   RBBASIC+10                                               07612000
XSTAB    EQU   RBSTAB                                                   07613000
RBSTAB1  EQU   XSTAB                                                    07614000
XSTAB1   EQU   RBSTAB1                                                  07615000
RBFTCKPT EQU   XSTAB1                                                   07616000
RBSTAB2  EQU   XSTAB+1                                                  07617000
XSTAB2   EQU   RBSTAB2                                                  07618000
RBTCBNXT EQU   XSTAB2                                                   07619000
RBFACTV  EQU   XSTAB2                                                   07620000
RBFDYN   EQU   XSTAB2                                                   07621000
RBECBWT  EQU   XSTAB2                                                   07622000
RBOPSW   EQU   RBBASIC+16                                               07623000
XRBPSW   EQU   RBOPSW                                                   07624000
RBOPSWB2 EQU   XRBPSW+1                                                 07625000
RBLINK   EQU   RBBASIC+28                                               07626000
XRBLNK   EQU   RBLINK                                                   07627000
RBWCF    EQU   XRBLNK                                                   07628000
RBLINKB  EQU   XRBLNK+1                                                 07629000
RBGRSAVE EQU   RBBASIC+32                                               07630000
XRBREG   EQU   RBGRSAVE                                                 07631000
RBGRS0   EQU   XRBREG                                                   07632000
RBGRS1   EQU   XRBREG+4                                                 07633000
RBGRS2   EQU   XRBREG+8                                                 07634000
RBGRS3   EQU   XRBREG+12                                                07635000
RBGRS4   EQU   XRBREG+16                                                07636000
RBGRS5   EQU   XRBREG+20                                                07637000
RBGRS6   EQU   XRBREG+24                                                07638000
RBGRS7   EQU   XRBREG+28                                                07639000
RBGRS8   EQU   XRBREG+32                                                07640000
RBGRS9   EQU   XRBREG+36                                                07641000
RBGRS10  EQU   XRBREG+40                                                07642000
RBGRS11  EQU   XRBREG+44                                                07643000
RBGRS12  EQU   XRBREG+48                                                07644000
RBGRS13  EQU   XRBREG+52                                                07645000
RBGRS14  EQU   XRBREG+56                                                07646000
RBGRS15  EQU   XRBREG+60                                                07647000
XRBESA   EQU   RBBASIC+96                                               07648000
RBPREFIX EQU   0                                                        07649000
RBRSV019 EQU   RBPREFIX+14                                              07650000
RBRSV028 EQU   RBPREFIX+15                                              07651000
RBRSV041 EQU   RBPREFIX+27                                              07652000
RBRSV054 EQU   RBPREFIX+39                                              07653000
RBRTOPSW EQU   RBPREFIX+40                                              07654000
RBRTPSW2 EQU   RBRTOPSW+8                                               07655000
RBRTICIL EQU   RBRTPSW2                                                 07656000
RBFLAGS1 EQU   RBPREFIX+56                                              07657000
RBINTCDA EQU   RBPREFIX+61                                              07658000
RBSECT   EQU   0                                                        07659000
RBPPSAV  EQU   RBSECT                                                   07660000
@NM00127 EQU   RBSECT+10                                                07661000
@NM00128 EQU   @NM00127                                                 07662000
RBTRSVRB EQU   @NM00128                                                 07663000
@NM00130 EQU   @NM00127+1                                               07664000
RBETXR   EQU   @NM00130                                                 07665000
RBEP     EQU   RBSECT+12                                                07666000
RBPGMQ   EQU   RBSECT+24                                                07667000
@NM00137 EQU   RBSECT+28                                                07668000
@NM00138 EQU   @NM00137                                                 07669000
IRBEND   EQU   RBSECT+96                                                07670000
@NM00141 EQU   RBSECT+96                                                07671000
RBRSV138 EQU   @NM00141+7                                               07672000
RBSCBB   EQU   RBSECT+144                                               07673000
RBSPARM  EQU   RBSCBB+8                                                 07674000
RBSFLGS1 EQU   RBSPARM                                                  07675000
RBSIOPRC EQU   RBSFLGS1                                                 07676000
RBSOWNR  EQU   RBSCBB+12                                                07677000
RBSFLGS2 EQU   RBSOWNR                                                  07678000
RBSDATA  EQU   RBSCBB+16                                                07679000
RBSFLG3  EQU   RBSDATA                                                  07680000
RBRSV150 EQU   RBSECT+167                                               07681000
SCVTSECT EQU   0                                                        07682000
SCVTCTCB EQU   SCVTSECT+112                                             07683000
TCBFIX   EQU   0                                                        07684000
TCBFRS   EQU   TCBFIX                                                   07685000
TCB      EQU   0                                                        07686000
TCBRBP   EQU   TCB                                                      07687000
TCBPIE   EQU   TCB+4                                                    07688000
TCBPMASK EQU   TCBPIE                                                   07689000
TCBCMP   EQU   TCB+16                                                   07690000
TCBCMPF  EQU   TCBCMP                                                   07691000
TCBCPP   EQU   TCBCMPF                                                  07692000
TCBSTCC  EQU   TCBCMPF                                                  07693000
TCBCDBL  EQU   TCBCMPF                                                  07694000
TCBCWTO  EQU   TCBCMPF                                                  07695000
TCBCIND  EQU   TCBCMPF                                                  07696000
TCBCMSG  EQU   TCBCMPF                                                  07697000
TCBTRN   EQU   TCB+20                                                   07698000
TCBABF   EQU   TCBTRN                                                   07699000
TCBMSS   EQU   TCB+24                                                   07700000
TCBPKF   EQU   TCB+28                                                   07701000
TCBFLGS  EQU   TCB+29                                                   07702000
TCBFLGS1 EQU   TCBFLGS                                                  07703000
TCBFLGS2 EQU   TCBFLGS+1                                                07704000
TCBFLGS3 EQU   TCBFLGS+2                                                07705000
TCBFLGS4 EQU   TCBFLGS+3                                                07706000
TCBFLGS5 EQU   TCBFLGS+4                                                07707000
TCBABWF  EQU   TCBFLGS5                                                 07708000
TCBJPQ   EQU   TCB+44                                                   07709000
TCBPURGE EQU   TCBJPQ                                                   07710000
TCBGRS   EQU   TCB+48                                                   07711000
TCBFSA   EQU   TCB+112                                                  07712000
TCBTME   EQU   TCB+120                                                  07713000
TCBJSTCB EQU   TCB+124                                                  07714000
TCBTSFLG EQU   TCB+148                                                  07715000
TCBTSTSK EQU   TCBTSFLG                                                 07716000
TCBSTAB  EQU   TCB+160                                                  07717000
TCBNSTAE EQU   TCBSTAB                                                  07718000
TCBTCT   EQU   TCB+164                                                  07719000
TCBTCTGF EQU   TCBTCT                                                   07720000
TCBSCNDY EQU   TCB+172                                                  07721000
TCBNDSP  EQU   TCBSCNDY                                                 07722000
TCBNDSP1 EQU   TCBNDSP+1                                                07723000
TCBNDSP2 EQU   TCBNDSP+2                                                07724000
TCBNDSP3 EQU   TCBNDSP+3                                                07725000
TCBJSCB  EQU   TCB+180                                                  07726000
TCBRECDE EQU   TCBJSCB                                                  07727000
TCBEXT1  EQU   TCB+196                                                  07728000
TCBBITS  EQU   TCB+200                                                  07729000
TCBNDSP4 EQU   TCBBITS                                                  07730000
TCBNDSP5 EQU   TCBBITS+1                                                07731000
TCBFLGS6 EQU   TCBBITS+2                                                07732000
TCBFLGS7 EQU   TCBBITS+3                                                07733000
TCBDAR   EQU   TCB+204                                                  07734000
TCBDARC  EQU   TCBDAR                                                   07735000
TCBEXT2  EQU   TCB+208                                                  07736000
TCBXSCT  EQU   TCB+240                                                  07737000
TCBXSCT1 EQU   TCBXSCT                                                  07738000
TCBFOE   EQU   TCB+244                                                  07739000
TCBSTAWA EQU   TCB+252                                                  07740000
TCBESTAE EQU   TCB+264                                                  07741000
TCBESTRM EQU   TCBESTAE+1                                               07742000
TCBFBYT1 EQU   TCB+276                                                  07743000
TCBFBYT2 EQU   TCB+277                                                  07744000
TCBRV124 EQU   TCB+278                                                  07745000
TCBRV133 EQU   TCB+279                                                  07746000
TCBXTNT2 EQU   0                                                        07747000
TCBGTF   EQU   TCBXTNT2                                                 07748000
TCBTFLG  EQU   TCBGTF                                                   07749000
TCBRV146 EQU   TCBXTNT2+28                                              07750000
TCBRV155 EQU   TCBXTNT2+29                                              07751000
TCBRV164 EQU   TCBXTNT2+30                                              07752000
TCBRV173 EQU   TCBXTNT2+31                                              07753000
UCB      EQU   0                                                        07754000
UCBOB    EQU   0                                                        07755000
UCBJBNR  EQU   UCBOB                                                    07756000
UCBFL5   EQU   UCBOB+1                                                  07757000
UCBAF    EQU   UCBFL5                                                   07758000
UCBNALOC EQU   UCBFL5                                                   07759000
UCBSTAT  EQU   UCBOB+3                                                  07760000
UCBONLI  EQU   UCBSTAT                                                  07761000
UCBALOC  EQU   UCBSTAT                                                  07762000
UCBSYSR  EQU   UCBSTAT                                                  07763000
UCBCHAN  EQU   UCBOB+4                                                  07764000
UCBSFLS  EQU   UCBOB+6                                                  07765000
UCBFLA   EQU   UCBSFLS                                                  07766000
UCBFL1   EQU   UCBFLA                                                   07767000
UCBBSY   EQU   UCBFL1                                                   07768000
UCBNRY   EQU   UCBFL1                                                   07769000
UCBPST   EQU   UCBFL1                                                   07770000
UCBCUB   EQU   UCBFL1                                                   07771000
UCBFLB   EQU   UCBSFLS+1                                                07772000
UCBCHM   EQU   UCBOB+8                                                  07773000
UCBCHM1  EQU   UCBCHM                                                   07774000
UCBPTH0  EQU   UCBCHM1                                                  07775000
UCBPTH1  EQU   UCBCHM1                                                  07776000
UCBWGT   EQU   UCBOB+12                                                 07777000
UCBVHRSN EQU   UCBWGT                                                   07778000
UCBNAME  EQU   UCBOB+13                                                 07779000
UCBTYP   EQU   UCBOB+16                                                 07780000
UCBTBYT1 EQU   UCBTYP                                                   07781000
UCB1FEA5 EQU   UCBTBYT1                                                 07782000
UCB1FEA6 EQU   UCBTBYT1                                                 07783000
UCBTBYT2 EQU   UCBTYP+1                                                 07784000
UCB2OPT2 EQU   UCBTBYT2                                                 07785000
UCBDUDN1 EQU   UCB2OPT2                                                 07786000
UCB2OPT3 EQU   UCBTBYT2                                                 07787000
UCBDUDN2 EQU   UCB2OPT3                                                 07788000
UCB2OPT4 EQU   UCBTBYT2                                                 07789000
UCBRWTAU EQU   UCB2OPT4                                                 07790000
UCB2OPT6 EQU   UCBTBYT2                                                 07791000
UCB2OPT7 EQU   UCBTBYT2                                                 07792000
UCBTBYT3 EQU   UCBTYP+2                                                 07793000
UCBDVCLS EQU   UCBTBYT3                                                 07794000
UCB3COMM EQU   UCBDVCLS                                                 07795000
UCBTBYT4 EQU   UCBTYP+3                                                 07796000
UCBEXTPT EQU   UCBOB+20                                                 07797000
UCBFLC   EQU   UCBEXTPT                                                 07798000
UCBDEV   EQU   UCBOB+24                                                 07799000
UCBCMEXT EQU   0                                                        07800000
UCBATI   EQU   UCBCMEXT+3                                               07801000
@NM00177 EQU   UCBATI                                                   07802000
UCBFLP1  EQU   UCBCMEXT+5                                               07803000
UCBMT    EQU   0                                                        07804000
UCBOCR   EQU   0                                                        07805000
UCB3540X EQU   0                                                        07806000
UCBDKBYT EQU   UCB3540X+6                                               07807000
UCB3800X EQU   0                                                        07808000
UCBOPTNS EQU   UCB3800X                                                 07809000
UCBACTIV EQU   UCB3800X+3                                               07810000
UCBMDRBF EQU   UCB3800X+36                                              07811000
UCBUCS   EQU   0                                                        07812000
UCBUCSOP EQU   UCBUCS+4                                                 07813000
UCBFCBOP EQU   UCBUCS+5                                                 07814000
UCM2EXT  EQU   0                                                        07815000
UCM2STA  EQU   UCM2EXT+8                                                07816000
UCM2SFLG EQU   UCM2STA                                                  07817000
UCMPRFX  EQU   0                                                        07818000
UCMMCENT EQU   UCMPRFX                                                  07819000
UCMSAVE0 EQU   UCMPRFX+4                                                07820000
UCMSFLGS EQU   UCMPRFX+84                                               07821000
UCMSFLG1 EQU   UCMSFLGS                                                 07822000
UCMSYSD  EQU   UCMSFLG1                                                 07823000
UCMSYSE  EQU   UCMSFLG1                                                 07824000
UCMSYSG  EQU   UCMSFLG1                                                 07825000
UCMSFLG2 EQU   UCMSFLGS+1                                               07826000
UCMSYSI  EQU   UCMSFLG2                                                 07827000
UCMSYSJ  EQU   UCMSFLG2                                                 07828000
UCMSYSL  EQU   UCMSFLG2                                                 07829000
UCMSYSP  EQU   UCMSFLG2                                                 07830000
UCMCMID  EQU   UCMPRFX+88                                               07831000
UCMHCUCM EQU   UCMPRFX+92                                               07832000
UCMUEXIT EQU   UCMPRFX+97                                               07833000
UCMXSA   EQU   UCMPRFX+104                                              07834000
UCMQRTN  EQU   UCMPRFX+128                                              07835000
UCMSWSA1 EQU   UCMPRFX+132                                              07836000
UCMSWSA2 EQU   UCMPRFX+136                                              07837000
UCMSDS1  EQU   UCMPRFX+156                                              07838000
UCMPRFXP EQU   0                                                        07839000
UCM      EQU   0                                                        07840000
UCMOECB  EQU   UCM+8                                                    07841000
UCMDECB  EQU   UCM+12                                                   07842000
UCMLSTP  EQU   UCM+20                                                   07843000
UCMWTOQ  EQU   UCM+24                                                   07844000
UCMRPYQ  EQU   UCM+28                                                   07845000
UCMRPYI  EQU   UCM+32                                                   07846000
UCMWQNR  EQU   UCM+58                                                   07847000
UCMWQEND EQU   UCM+60                                                   07848000
UCMPXA   EQU   UCM+64                                                   07849000
UCMPXB   EQU   UCM+68                                                   07850000
UCMMODE  EQU   UCMPXB                                                   07851000
UCMAMFA  EQU   UCMMODE                                                  07852000
UCMVDATA EQU   UCM+72                                                   07853000
UCMVEA   EQU   UCMVDATA                                                 07854000
UCMVEZ   EQU   UCMVDATA+4                                               07855000
UCMVEL   EQU   UCMVDATA+8                                               07856000
UCMMNTR  EQU   UCM+208                                                  07857000
UCMBFEXT EQU   UCM+240                                                  07858000
UCMCTID  EQU   UCM+250                                                  07859000
UCMWQECP EQU   UCM+276                                                  07860000
UCMASCB  EQU   UCM+280                                                  07861000
UCMFRRAD EQU   UCM+288                                                  07862000
UCMRSV42 EQU   UCM+300                                                  07863000
UCMRSV51 EQU   UCM+301                                                  07864000
UCMEIL   EQU   0                                                        07865000
UCMRECBA EQU   UCMEIL+24                                                07866000
UCMLIST  EQU   0                                                        07867000
UCMECB   EQU   UCMLIST                                                  07868000
UCMSBR   EQU   UCMLIST+4                                                07869000
UCMDCB   EQU   UCMLIST+8                                                07870000
UCMUCB   EQU   UCMLIST+12                                               07871000
UCMNAME  EQU   UCMLIST+16                                               07872000
UCMSTS   EQU   UCMLIST+24                                               07873000
UCMAF    EQU   UCMSTS                                                   07874000
UCMPF    EQU   UCMSTS                                                   07875000
UCMBF    EQU   UCMSTS                                                   07876000
UCMCF    EQU   UCMSTS                                                   07877000
UCMTA    EQU   UCMSTS                                                   07878000
UCMTC    EQU   UCMSTS                                                   07879000
UCMATR   EQU   UCMLIST+25                                               07880000
UCMOF    EQU   UCMATR                                                   07881000
UCMIF    EQU   UCMATR                                                   07882000
UCMUF    EQU   UCMATR                                                   07883000
UCMXA    EQU   UCMLIST+26                                               07884000
UCMID    EQU   UCMXA                                                    07885000
UCMXB    EQU   UCMLIST+28                                               07886000
UCMRTCD  EQU   UCMLIST+32                                               07887000
UCMOUTQ  EQU   UCMLIST+36                                               07888000
UCMAUTH  EQU   UCMLIST+40                                               07889000
UCMAUTHA EQU   UCMAUTH                                                  07890000
UCMAUTH1 EQU   UCMAUTHA                                                 07891000
UCMAUTH2 EQU   UCMAUTHA                                                 07892000
UCMAUTH3 EQU   UCMAUTHA                                                 07893000
UCMDISP  EQU   UCMLIST+42                                               07894000
UCMDISP1 EQU   UCMDISP                                                  07895000
UCMDISPA EQU   UCMDISP1                                                 07896000
UCMDISPB EQU   UCMDISP1                                                 07897000
UCMDISPC EQU   UCMDISP1                                                 07898000
UCMDISPD EQU   UCMDISP1                                                 07899000
UCMDISPE EQU   UCMDISP1                                                 07900000
UCMDISPF EQU   UCMDISP1                                                 07901000
UCMDISPG EQU   UCMDISP1                                                 07902000
UCMDISP2 EQU   UCMDISP+1                                                07903000
UCMDISPI EQU   UCMDISP2                                                 07904000
UCMDISPJ EQU   UCMDISP2                                                 07905000
UCMDISPK EQU   UCMDISP2                                                 07906000
UCMALTEN EQU   UCMLIST+44                                               07907000
UCMWLAST EQU   UCMLIST+52                                               07908000
UCMCOMPC EQU   UCMLIST+56                                               07909000
UCMMSG   EQU   UCMLIST+60                                               07910000
UCMMSG1  EQU   UCMMSG                                                   07911000
UCMDEVC  EQU   UCMLIST+63                                               07912000
UCMDEVCC EQU   UCMDEVC                                                  07913000
UCMDEVE  EQU   UCMDEVC                                                  07914000
UCMVHRSN EQU   UCMDEVC                                                  07915000
UCMMLAST EQU   UCMLIST+64                                               07916000
UCMRCT   EQU   UCMLIST+68                                               07917000
UCMSDS5  EQU   UCMRCT                                                   07918000
UCMSDS5A EQU   UCMSDS5                                                  07919000
UCMSDS5B EQU   UCMSDS5                                                  07920000
UCMSDS5C EQU   UCMSDS5                                                  07921000
UCMSDS5F EQU   UCMSDS5                                                  07922000
UCMSDS5G EQU   UCMSDS5                                                  07923000
UCMFEXTP EQU   UCMLIST+72                                               07924000
UCMEXIT  EQU   0                                                        07925000
UCMFEXTA EQU   0                                                        07926000
UCMFPPTR EQU   UCMFEXTA+4                                               07927000
UCMFMGFS EQU   UCMFEXTA+8                                               07928000
UCMFFLG1 EQU   UCMFMGFS                                                 07929000
UCMFECBL EQU   UCMFEXTA+28                                              07930000
UCMFRECB EQU   UCMFECBL+4                                               07931000
UCMFRBYT EQU   UCMFRECB                                                 07932000
UCMFATCN EQU   UCMFEXTA+36                                              07933000
UCMPEXTA EQU   0                                                        07934000
UCMPDM1  EQU   UCMPEXTA+4                                               07935000
UCMPNMCC EQU   UCMPDM1+4                                                07936000
UCMPNCC  EQU   UCMPDM1+8                                                07937000
UCMEFEXT EQU   0                                                        07938000
UCMEFLG1 EQU   UCMEFEXT                                                 07939000
UCMEFLGA EQU   UCMEFLG1                                                 07940000
UCMEFLGB EQU   UCMEFLG1                                                 07941000
UCMEFATT EQU   UCMEFEXT+2                                               07942000
UCMEFPEX EQU   UCMEFEXT+4                                               07943000
WQE      EQU   0                                                        07944000
WQELKP   EQU   WQE                                                      07945000
WQEUSE   EQU   WQELKP                                                   07946000
WQELKPA  EQU   WQELKP+1                                                 07947000
WQENBR   EQU   WQE+4                                                    07948000
WQERR    EQU   WQE+8                                                    07949000
WQEPAD   EQU   WQE+12                                                   07950000
WQETS    EQU   WQE+13                                                   07951000
WQEPAD1  EQU   WQE+21                                                   07952000
WQEJOBNM EQU   WQE+22                                                   07953000
WQEPAD2  EQU   WQE+30                                                   07954000
WQETXT   EQU   WQE+31                                                   07955000
WQEXA    EQU   WQE+160                                                  07956000
WQEQFHC  EQU   WQEXA                                                    07957000
WQEQDFHC EQU   WQEXA                                                    07958000
WQESUSP  EQU   WQEXA                                                    07959000
WQEAUTH  EQU   WQEXA                                                    07960000
WQEASID  EQU   WQE+161                                                  07961000
WQEAVAIL EQU   WQE+163                                                  07962000
WQEBUFC  EQU   WQEAVAIL                                                 07963000
WQEBUFD  EQU   WQEAVAIL                                                 07964000
WQEBUFE  EQU   WQEAVAIL                                                 07965000
WQETCB   EQU   WQE+164                                                  07966000
WQESEQN  EQU   WQE+169                                                  07967000
WQEMCSF  EQU   WQE+172                                                  07968000
WQEMCSF1 EQU   WQEMCSF                                                  07969000
WQEMCSA  EQU   WQEMCSF1                                                 07970000
WQEMCSB  EQU   WQEMCSF1                                                 07971000
WQEMCSD  EQU   WQEMCSF1                                                 07972000
WQEMCSG  EQU   WQEMCSF1                                                 07973000
WQEMCSH  EQU   WQEMCSF1                                                 07974000
WQEMCSF2 EQU   WQEMCSF+1                                                07975000
WQEMCSN  EQU   WQEMCSF2                                                 07976000
WQEMSGTP EQU   WQE+174                                                  07977000
WQEMSGT1 EQU   WQEMSGTP                                                 07978000
WQEROUT  EQU   WQE+176                                                  07979000
WQEROUT1 EQU   WQEROUT                                                  07980000
WQEROUTB EQU   WQEROUT1                                                 07981000
WQEROUT2 EQU   WQEROUT+1                                                07982000
WQEUCMID EQU   WQE+180                                                  07983000
WQEDESCD EQU   WQE+184                                                  07984000
WQEDC1   EQU   WQEDESCD                                                 07985000
WQEDCD   EQU   WQEDC1                                                   07986000
WQEDC2   EQU   WQEDESCD+1                                               07987000
WQEJSTCB EQU   WQE+188                                                  07988000
WMJM     EQU   0                                                        07989000
WMJMEXT  EQU   WMJM                                                     07990000
WMJMEXTA EQU   WMJMEXT+1                                                07991000
WMJMMLW  EQU   WMJM+4                                                   07992000
WMJMMLWH EQU   WMJMMLW                                                  07993000
WMJMTS   EQU   WMJM+13                                                  07994000
WMJMSER  EQU   WMJM+122                                                 07995000
WMJMSER1 EQU   WMJMSER                                                  07996000
WMJMLTYP EQU   WMJM+134                                                 07997000
WMJMLTY1 EQU   WMJMLTYP                                                 07998000
WMJMLTYD EQU   WMJMLTY1                                                 07999000
WMJMMIN  EQU   WMJM+136                                                 08000000
WMJMECBF EQU   WMJM+148                                                 08001000
WMJMDSP  EQU   WMJM+160                                                 08002000
WMJMBUF  EQU   WMJM+163                                                 08003000
WMJMCS   EQU   WMJM+172                                                 08004000
WMJMCS1  EQU   WMJMCS                                                   08005000
WMJMCS2  EQU   WMJMCS+1                                                 08006000
WMJMMT   EQU   WMJM+174                                                 08007000
WMJMMT1  EQU   WMJMMT                                                   08008000
WMJMRTC  EQU   WMJM+176                                                 08009000
WMJMRCT1 EQU   WMJMRTC                                                  08010000
WMJMRCT2 EQU   WMJMRTC+1                                                08011000
WMJMDEC  EQU   WMJM+184                                                 08012000
WMJMDEC1 EQU   WMJMDEC                                                  08013000
WMJMDECH EQU   WMJMDEC1                                                 08014000
WMJMDEC2 EQU   WMJMDEC+1                                                08015000
WMJMDECI EQU   WMJMDEC2                                                 08016000
WMNM     EQU   0                                                        08017000
WMNMEXT  EQU   WMNM                                                     08018000
WMNMUC1  EQU   WMNMEXT                                                  08019000
WMNMNX1  EQU   WMNMEXT+1                                                08020000
WMNMML1  EQU   WMNM+4                                                   08021000
WMNMLT1  EQU   WMNM+5                                                   08022000
WMNMLT1D EQU   WMNMLT1                                                  08023000
WMNMST1  EQU   WMNM+84                                                  08024000
WMNMML2  EQU   WMNM+100                                                 08025000
WMNMLT2  EQU   WMNM+101                                                 08026000
WMNMST2  EQU   WMNM+180                                                 08027000
DCMREND  EQU   0                                                        08028000
IEECMENQ EQU   0                                                        08029000
IEFAB4F5 EQU   0                                                        08030000
IEFBB410 EQU   0                                                        08031000
IEFW21SD EQU   0                                                        08032000
I001C    EQU   0                                                        08033000
I008P    EQU   0                                                        08034000
I015F    EQU   0                                                        08035000
I015P    EQU   0                                                        08036000
I031F    EQU   0                                                        08037000
I031P    EQU   0                                                        08038000
I256C    EQU   0                                                        08039000
SWAMGR   EQU   0                                                        08040000
UCBBGN   EQU   0                                                        08041000
UCMEPEXT EQU   0                                                        08042000
TYPECONS EQU   0                                                        08043000
OPNCLOSE EQU   0                                                        08044000
TYPECCW  EQU   0                                                        08045000
MSG142M  EQU   WQETXT                                                   08046000
M142DEV  EQU   MSG142M+10                                               08047000
MSG143M1 EQU   WQETXT                                                   08048000
OLD      EQU   MSG143M1+13                                              08049000
OLDNOCP  EQU   OLD                                                      08050000
OLDCP    EQU   OLDNOCP                                                  08051000
OLDINID  EQU   OLDCP+2                                                  08052000
OLDOUTID EQU   OLDCP+8                                                  08053000
NEW      EQU   MSG143M1+29                                              08054000
NEWNOCP  EQU   NEW                                                      08055000
NEWCP    EQU   NEWNOCP                                                  08056000
NEWINID  EQU   NEWCP+2                                                  08057000
NEWOUTID EQU   NEWCP+8                                                  08058000
CMDS     EQU   MSG143M1+49                                              08059000
MSG143M2 EQU   WQETXT                                                   08060000
ROUTCDES EQU   MSG143M2+17                                              08061000
TYPE     EQU   MSG143M2+65                                              08062000
HCCHAR   EQU   MSG143M2+69                                              08063000
@NM00013 EQU   UCMMCENT                                                 08064000
WORD1S   EQU   WORD1                                                    08065000
CPEXTSAV EQU   WORD1                                                    08066000
ASCBPTR  EQU   UCMASCB                                                  08067000
PARMPTR  EQU   CSAXB                                                    08068000
SACBPTR  EQU   DCMADSDS                                                 08069000
RBSECPTR EQU   TCBRBP                                                   08070000
SCVTSPTR EQU   CVTABEND                                                 08071000
TCBPTR   EQU   SCVTCTCB                                                 08072000
UCBPTR   EQU   UCMUCB                                                   08073000
UCMEXTPT EQU   UCM2PTR                                                  08074000
UCMEILPT EQU   UCMLSTP                                                  08075000
UCMUEWPT EQU   UCMUEXIT                                                 08076000
UCMFXPTR EQU   UCMBFEXT                                                 08077000
UCMPXPTR EQU   UCMFPPTR                                                 08078000
IOCOMP   EQU   UCMECB                                                   08079000
UCBSTATX EQU   UCBSTAT                                                  08080000
UCBONLIX EQU   UCBSTATX                                                 08081000
UCBCHGSX EQU   UCBSTATX                                                 08082000
UCBSYSRX EQU   UCBSTATX                                                 08083000
UCBDADIX EQU   UCBSTATX                                                 08084000
UCBWGTX  EQU   UCBWGT                                                   08085000
UCBVORSX EQU   UCBWGTX                                                  08086000
CVTS01   EQU   CVTPGSIA                                                 08087000
CVTLPDIA EQU   CVTS01+12                                                08088000
CVTDIRST EQU   CVTLPDIA                                                 08089000
CVTSLIDA EQU   CVTS01+24                                                08090000
CVTCTLFG EQU   CVTS01+50                                                08091000
CVTBLDCP EQU   CVTS01+140                                               08092000
CVTGETCL EQU   CVTS01+144                                               08093000
CVTFRECL EQU   CVTS01+148                                               08094000
CVTCRMN  EQU   CVTS01+156                                               08095000
CVTRV210 EQU   CVTS01+424                                               08096000
CVTRV219 EQU   CVTS01+425                                               08097000
CVTRV228 EQU   CVTS01+426                                               08098000
CVTRV237 EQU   CVTS01+427                                               08099000
CVTMFRTR EQU   CVTS01+452                                               08100000
CVTRV262 EQU   CVTS01+468                                               08101000
CVTRV271 EQU   CVTS01+469                                               08102000
CVTRV280 EQU   CVTS01+470                                               08103000
CVTRV289 EQU   CVTS01+471                                               08104000
CVTRMBR  EQU   CVTS01+492                                               08105000
CVTGSDA  EQU   CVTS01+600                                               08106000
FLC      EQU   PSA                                                      08107000
PSARSVTE EQU   PSARSVT                                                  08108000
PSACSTK  EQU   PSARSVTE                                                 08109000
RBSECS03 EQU   RBEP                                                     08110000
RBCDE    EQU   RBSECS03                                                 08111000
RBCDFLGS EQU   RBCDE                                                    08112000
RBSECS05 EQU   RBPGMQ                                                   08113000
RBSQE    EQU   RBSECS05                                                 08114000
RBSECS06 EQU   RBPGMQ                                                   08115000
RBIQE    EQU   RBSECS06                                                 08116000
RBSECS07 EQU   RBPGMQ                                                   08117000
RBIQE2   EQU   RBSECS07                                                 08118000
RBSECS08 EQU   IRBEND                                                   08119000
RBSECS09 EQU   IRBEND                                                   08120000
UCBOBS01 EQU   UCBDEV                                                   08121000
UCBSTAB  EQU   UCBOBS01+10                                              08122000
UCBBSVL  EQU   UCBSTAB                                                  08123000
UCBPRSRS EQU   UCBSTAB                                                  08124000
UCBDMCT  EQU   UCBOBS01+11                                              08125000
UCBFL4   EQU   UCBOBS01+13                                              08126000
UCBOBS02 EQU   UCBDEV                                                   08127000
UCBTFL1  EQU   UCBOBS02+19                                              08128000
UCBXTN   EQU   UCBOBS02+20                                              08129000
UCBVOPT  EQU   UCBXTN                                                   08130000
UCBOBS03 EQU   UCBDEV                                                   08131000
UCBXTADR EQU   UCBOBS03                                                 08132000
UCBOBS04 EQU   UCBDEV                                                   08133000
UCBBTA   EQU   UCBOBS04+12                                              08134000
UCBOBS06 EQU   UCBDEV                                                   08135000
UCBAOF   EQU   UCBOBS06                                                 08136000
UCBAOF1  EQU   UCBAOF                                                   08137000
UCBAOF2  EQU   UCBAOF+1                                                 08138000
@NM00176 EQU   UCBOBS06+3                                               08139000
UCBIRB   EQU   UCBOBS06+4                                               08140000
UCBGRAF  EQU   UCBIRB                                                   08141000
UCBLDNCA EQU   UCBOBS06+8                                               08142000
UCBRDYQ  EQU   UCBLDNCA                                                 08143000
UCBIRLN  EQU   UCBRDYQ                                                  08144000
UCBLDNCB EQU   UCBRDYQ+1                                                08145000
UCBCTLNK EQU   UCBOBS06+12                                              08146000
UCBOBS07 EQU   UCBDEV                                                   08147000
UCBOBS08 EQU   UCBDEV                                                   08148000
UCBCTCAD EQU   UCBOBS08                                                 08149000
UCBCTCF1 EQU   UCBOBS08+4                                               08150000
UCBOBS09 EQU   UCBDEV                                                   08151000
UCMIECBA EQU   UCMRECBA+4                                               08152000
I002     EQU   ILIST                                                    08153000
I00201   EQU   I002                                                     08154000
I00202   EQU   I002+4                                                   08155000
I00203   EQU   I002+8                                                   08156000
I056     EQU   ILIST                                                    08157000
I05602   EQU   I056+4                                                   08158000
I05603   EQU   I05602                                                   08159000
I05604   EQU   I05602+1                                                 08160000
I05605   EQU   I05602+2                                                 08161000
I05606   EQU   I05602+4                                                 08162000
I05607   EQU   I05602+8                                                 08163000
I048     EQU   ILIST                                                    08164000
I04802   EQU   I048+4                                                   08165000
I04803   EQU   I04802                                                   08166000
I04804   EQU   I04803                                                   08167000
I04805   EQU   I04803+1                                                 08168000
I04806   EQU   I04803+2                                                 08169000
I04807   EQU   I04802+4                                                 08170000
I04808   EQU   I04802+8                                                 08171000
RING2250 EQU   RING1052                                                 08172000
RING3036 EQU   RING3270                                                 08173000
RING3066 EQU   RING1052                                                 08174000
RING3215 EQU   RING1052                                                 08175000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    08176000
@NM00182 EQU   I04803+3                                                 08177000
I04801   EQU   I048                                                     08178000
I05655   EQU   I05602+3                                                 08179000
I05601   EQU   I056                                                     08180000
UCMIECBP EQU   UCMIECBA+1                                               08181000
UCMIECBF EQU   UCMIECBA                                                 08182000
UCBRV066 EQU   UCBOBS09+4                                               08183000
UCBIOSBA EQU   UCBOBS09                                                 08184000
UCBRV042 EQU   UCBOBS08+5                                               08185000
UCBRV082 EQU   UCBCTCF1                                                 08186000
UCBRV081 EQU   UCBCTCF1                                                 08187000
UCBRV080 EQU   UCBCTCF1                                                 08188000
UCBRV079 EQU   UCBCTCF1                                                 08189000
UCBRV078 EQU   UCBCTCF1                                                 08190000
UCBRV077 EQU   UCBCTCF1                                                 08191000
UCBRV076 EQU   UCBCTCF1                                                 08192000
UCBCTC80 EQU   UCBCTCF1                                                 08193000
UCBCTCAL EQU   UCBCTCAD                                                 08194000
UCBICNCB EQU   UCBOBS07+4                                               08195000
UCBRV040 EQU   UCBOBS07                                                 08196000
UCBCTLNA EQU   UCBCTLNK+1                                               08197000
UCBRLN   EQU   UCBCTLNK                                                 08198000
UCBRDYQA EQU   UCBLDNCB                                                 08199000
UCBINRLN EQU   UCBIRLN                                                  08200000
UCBIRBA  EQU   UCBIRB+1                                                 08201000
UCBRV039 EQU   UCBGRAF                                                  08202000
UCBDWNR  EQU   UCBGRAF                                                  08203000
UCBRPND  EQU   UCBGRAF                                                  08204000
UCBUPM   EQU   UCBGRAF                                                  08205000
UCBBTAM  EQU   UCBGRAF                                                  08206000
UCBDRNO  EQU   UCBGRAF                                                  08207000
UCBDRO   EQU   UCBGRAF                                                  08208000
UCBOIP   EQU   UCBGRAF                                                  08209000
UCBATRCD EQU   @NM00176                                                 08210000
UCBSKPFG EQU   @NM00176                                                 08211000
UCBRIPND EQU   @NM00176                                                 08212000
UCBRTIAC EQU   @NM00176                                                 08213000
UCBRSV79 EQU   @NM00176                                                 08214000
UCBRSV78 EQU   @NM00176                                                 08215000
UCBRSV77 EQU   @NM00176                                                 08216000
UCBOLTEP EQU   @NM00176                                                 08217000
UCBATNCT EQU   UCBOBS06+2                                               08218000
UCBRSV76 EQU   UCBAOF2                                                  08219000
UCBRSV75 EQU   UCBAOF2                                                  08220000
UCBRSV74 EQU   UCBAOF2                                                  08221000
UCBRSV73 EQU   UCBAOF2                                                  08222000
UCBRSV72 EQU   UCBAOF2                                                  08223000
UCBRSV71 EQU   UCBAOF2                                                  08224000
UCBRSV70 EQU   UCBAOF2                                                  08225000
UCBRSV69 EQU   UCBAOF2                                                  08226000
UCBRSV68 EQU   UCBAOF1                                                  08227000
UCBRSV67 EQU   UCBAOF1                                                  08228000
UCBRSV66 EQU   UCBAOF1                                                  08229000
UCBRSV65 EQU   UCBAOF1                                                  08230000
UCBRSV64 EQU   UCBAOF1                                                  08231000
UCBOFNL  EQU   UCBAOF1                                                  08232000
UCBOFSP  EQU   UCBAOF1                                                  08233000
UCBOFMCR EQU   UCBAOF1                                                  08234000
UCBBTB   EQU   UCBBTA+1                                                 08235000
UCBDI    EQU   UCBBTA                                                   08236000
UCBSNS   EQU   UCBOBS04+8                                               08237000
UCBTEB   EQU   UCBOBS04+4                                               08238000
UCBGCB   EQU   UCBOBS04+3                                               08239000
UCBOPEN  EQU   UCBOBS04+2                                               08240000
UCBSTART EQU   UCBOBS04                                                 08241000
UCBXTNB  EQU   UCBXTN+1                                                 08242000
UCBRSV22 EQU   UCBVOPT                                                  08243000
UCBRSV21 EQU   UCBVOPT                                                  08244000
UCBRSV20 EQU   UCBVOPT                                                  08245000
UCBESVE  EQU   UCBVOPT                                                  08246000
UCBERPC  EQU   UCBVOPT                                                  08247000
UCBESVC  EQU   UCBVOPT                                                  08248000
UCBEVA   EQU   UCBVOPT                                                  08249000
UCBESV   EQU   UCBVOPT                                                  08250000
UCBRV009 EQU   UCBTFL1                                                  08251000
UCBRV008 EQU   UCBTFL1                                                  08252000
UCBRV007 EQU   UCBTFL1                                                  08253000
UCBRV006 EQU   UCBTFL1                                                  08254000
UCBRV005 EQU   UCBTFL1                                                  08255000
UCBDQDSP EQU   UCBTFL1                                                  08256000
UCBNSLTP EQU   UCBTFL1                                                  08257000
UCBNLTP  EQU   UCBTFL1                                                  08258000
UCBRES1B EQU   UCBOBS02+18                                              08259000
UCBFSER  EQU   UCBOBS02+12                                              08260000
@NM00175 EQU   UCBOBS02+4                                               08261000
UCBFSEQ  EQU   UCBOBS02+2                                               08262000
UCBFSCT  EQU   UCBOBS02                                                 08263000
UCBNEXP  EQU   UCBOBS01+20                                              08264000
UCBBASE  EQU   UCBOBS01+16                                              08265000
UCBRES1A EQU   UCBOBS01+15                                              08266000
UCBUSER  EQU   UCBOBS01+14                                              08267000
UCBFL47  EQU   UCBFL4                                                   08268000
UCBMAT   EQU   UCBFL4                                                   08269000
UCBHOLD  EQU   UCBFL4                                                   08270000
UCBATTN  EQU   UCBFL4                                                   08271000
UCBDSS   EQU   UCBFL4                                                   08272000
UCBRESVP EQU   UCBFL4                                                   08273000
UCBWDAV  EQU   UCBFL4                                                   08274000
UCBDAVV  EQU   UCBFL4                                                   08275000
UCBSQC   EQU   UCBOBS01+12                                              08276000
UCBDATP  EQU   UCBOBS01+12                                              08277000
UCBDMC   EQU   UCBDMCT                                                  08278000
UCBMOUNT EQU   UCBDMCT                                                  08279000
UCBBNUL  EQU   UCBSTAB                                                  08280000
UCBSHAR  EQU   UCBSTAB                                                  08281000
UCBBSTR  EQU   UCBSTAB                                                  08282000
UCBBPUB  EQU   UCBSTAB                                                  08283000
UCBBPRV  EQU   UCBSTAB                                                  08284000
UCBBALB  EQU   UCBPRSRS                                                 08285000
UCBPGFL  EQU   UCBSTAB                                                  08286000
UCBDVSHR EQU   UCBBSVL                                                  08287000
UCBVOLI  EQU   UCBOBS01+4                                               08288000
UCBVTOC  EQU   UCBOBS01                                                 08289000
RBRSV161 EQU   RBSECS09+64                                              08290000
RBSIRBWA EQU   RBSECS09                                                 08291000
RBIQEWRK EQU   RBSECS08+4                                               08292000
RBNEXAV  EQU   RBSECS08                                                 08293000
RBIQEA   EQU   RBIQE2                                                   08294000
RBIQE1   EQU   RBIQE+1                                                  08295000
RBUSE    EQU   RBIQE                                                    08296000
RBSQEA   EQU   RBSQE+1                                                  08297000
@NM00142 EQU   RBSQE                                                    08298000
RBCDE1   EQU   RBCDE+1                                                  08299000
RBCDLOAD EQU   RBCDFLGS                                                 08300000
RBCDXCTL EQU   RBCDFLGS                                                 08301000
RBCDSYNC EQU   RBCDFLGS                                                 08302000
RBCDNODE EQU   RBCDFLGS                                                 08303000
RBCDSAVE EQU   RBCDFLGS                                                 08304000
RBCDATCH EQU   RBCDFLGS                                                 08305000
RBRSV009 EQU   RBCDFLGS                                                 08306000
RBNOCELL EQU   RBCDFLGS                                                 08307000
PSARSAV  EQU   PSARSVTE+60                                              08308000
PSARSTK  EQU   PSARSVTE+56                                              08309000
PSAESAV3 EQU   PSARSVTE+52                                              08310000
PSAESTK3 EQU   PSARSVTE+48                                              08311000
PSAESAV2 EQU   PSARSVTE+44                                              08312000
PSAESTK2 EQU   PSARSVTE+40                                              08313000
PSAESAV1 EQU   PSARSVTE+36                                              08314000
PSAESTK1 EQU   PSARSVTE+32                                              08315000
PSAPSAV  EQU   PSARSVTE+28                                              08316000
PSAPSTK  EQU   PSARSVTE+24                                              08317000
PSAMSAV  EQU   PSARSVTE+20                                              08318000
PSAMSTK  EQU   PSARSVTE+16                                              08319000
PSASSAV  EQU   PSARSVTE+12                                              08320000
PSASSTK  EQU   PSARSVTE+8                                               08321000
PSANSTK  EQU   PSARSVTE+4                                               08322000
CVTRV628 EQU   CVTS01+728                                               08323000
CVTRV627 EQU   CVTS01+724                                               08324000
CVTRV626 EQU   CVTS01+720                                               08325000
CVTRV625 EQU   CVTS01+716                                               08326000
CVTRV624 EQU   CVTS01+712                                               08327000
CVTRV623 EQU   CVTS01+708                                               08328000
CVTRV622 EQU   CVTS01+704                                               08329000
CVTRV621 EQU   CVTS01+700                                               08330000
CVTIHASU EQU   CVTS01+696                                               08331000
CVTSUSP  EQU   CVTS01+692                                               08332000
CVTT6SVC EQU   CVTS01+688                                               08333000
CVTCDAL  EQU   CVTS01+684                                               08334000
CVTTCTL  EQU   CVTS01+680                                               08335000
CVTRSUME EQU   CVTS01+676                                               08336000
CVTJTERM EQU   CVTS01+672                                               08337000
CVTASMRM EQU   CVTS01+668                                               08338000
CVTTCASP EQU   CVTS01+664                                               08339000
CVT0PT03 EQU   CVTS01+660                                               08340000
CVT0PT0E EQU   CVTS01+656                                               08341000
CVTRV609 EQU   CVTS01+652                                               08342000
CVTCGK   EQU   CVTS01+648                                               08343000
CVTRAC   EQU   CVTS01+644                                               08344000
CVTHSM   EQU   CVTS01+640                                               08345000
CVTRV605 EQU   CVTS01+636                                               08346000
CVTRV604 EQU   CVTS01+632                                               08347000
CVTEFF02 EQU   CVTS01+628                                               08348000
CVTCBBR  EQU   CVTS01+624                                               08349000
CVTSSCR  EQU   CVTS01+620                                               08350000
CVTEVENT EQU   CVTS01+616                                               08351000
CVTCRCA  EQU   CVTS01+612                                               08352000
CVTTPIO  EQU   CVTS01+608                                               08353000
CVTADV   EQU   CVTS01+604                                               08354000
CVTGSDAB EQU   CVTGSDA                                                  08355000
CVTQV3   EQU   CVTS01+596                                               08356000
CVTQV2   EQU   CVTS01+592                                               08357000
CVTQV1   EQU   CVTS01+588                                               08358000
CVTRPT   EQU   CVTS01+584                                               08359000
CVTSSRB  EQU   CVTS01+580                                               08360000
CVTCSDRL EQU   CVTS01+576                                               08361000
CVTEXP1  EQU   CVTS01+572                                               08362000
CVTRMPMT EQU   CVTS01+568                                               08363000
CVTRMPTT EQU   CVTS01+564                                               08364000
CVTVPSA  EQU   CVTS01+560                                               08365000
CVTVSTOP EQU   CVTS01+556                                               08366000
CVTGTFR8 EQU   CVTS01+552                                               08367000
CVTQUIT  EQU   CVTS01+548                                               08368000
CVTVACR  EQU   CVTS01+544                                               08369000
CVTWTCB  EQU   CVTS01+540                                               08370000
CVTSTPRS EQU   CVTS01+536                                               08371000
CVT0PT02 EQU   CVTS01+532                                               08372000
CVTDARCM EQU   CVTS01+528                                               08373000
CVTIRECM EQU   CVTS01+524                                               08374000
CVTJRECM EQU   CVTS01+520                                               08375000
CVTVEMS0 EQU   CVTS01+516                                               08376000
CVTSPFRR EQU   CVTS01+512                                               08377000
CVTRLSTG EQU   CVTS01+508                                               08378000
CVT0TC0A EQU   CVTS01+504                                               08379000
CVTGMBR  EQU   CVTS01+500                                               08380000
CVTLFRM  EQU   CVTS01+496                                               08381000
CVTVIOP  EQU   CVTS01+488                                               08382000
CVTRV307 EQU   CVTS01+486                                               08383000
CVTRV306 EQU   CVTS01+484                                               08384000
CVTRV305 EQU   CVTS01+482                                               08385000
CVTRV304 EQU   CVTS01+480                                               08386000
CVTRV303 EQU   CVTS01+478                                               08387000
CVTRV302 EQU   CVTS01+476                                               08388000
CVTTRCA  EQU   CVTS01+472                                               08389000
CVTRV297 EQU   CVTRV289                                                 08390000
CVTRV296 EQU   CVTRV289                                                 08391000
CVTRV295 EQU   CVTRV289                                                 08392000
CVTRV294 EQU   CVTRV289                                                 08393000
CVTRV293 EQU   CVTRV289                                                 08394000
CVTRV292 EQU   CVTRV289                                                 08395000
CVTRV291 EQU   CVTRV289                                                 08396000
CVTRV290 EQU   CVTRV289                                                 08397000
CVTRV288 EQU   CVTRV280                                                 08398000
CVTRV287 EQU   CVTRV280                                                 08399000
CVTRV286 EQU   CVTRV280                                                 08400000
CVTRV285 EQU   CVTRV280                                                 08401000
CVTRV284 EQU   CVTRV280                                                 08402000
CVTRV283 EQU   CVTRV280                                                 08403000
CVTRV282 EQU   CVTRV280                                                 08404000
CVTRV281 EQU   CVTRV280                                                 08405000
CVTRV279 EQU   CVTRV271                                                 08406000
CVTRV278 EQU   CVTRV271                                                 08407000
CVTRV277 EQU   CVTRV271                                                 08408000
CVTRV276 EQU   CVTRV271                                                 08409000
CVTRV275 EQU   CVTRV271                                                 08410000
CVTRV274 EQU   CVTRV271                                                 08411000
CVTRV273 EQU   CVTRV271                                                 08412000
CVTRV272 EQU   CVTRV271                                                 08413000
CVTRV270 EQU   CVTRV262                                                 08414000
CVTRV269 EQU   CVTRV262                                                 08415000
CVTRV268 EQU   CVTRV262                                                 08416000
CVTRV267 EQU   CVTRV262                                                 08417000
CVTRV266 EQU   CVTRV262                                                 08418000
CVTRV265 EQU   CVTRV262                                                 08419000
CVTRV264 EQU   CVTRV262                                                 08420000
CVTRV263 EQU   CVTRV262                                                 08421000
CVTVFP   EQU   CVTS01+464                                               08422000
CVTVSI   EQU   CVTS01+460                                               08423000
CVTVPSIB EQU   CVTS01+456                                               08424000
CVTMFACT EQU   CVTMFRTR                                                 08425000
CVTMFCTL EQU   CVTS01+448                                               08426000
CVTPVBP  EQU   CVTS01+444                                               08427000
CVTPWI   EQU   CVTS01+440                                               08428000
CVTRV254 EQU   CVTS01+438                                               08429000
CVTRV253 EQU   CVTS01+436                                               08430000
CVTRV252 EQU   CVTS01+434                                               08431000
CVTRV251 EQU   CVTS01+433                                               08432000
CVTRV250 EQU   CVTS01+432                                               08433000
CVTRV249 EQU   CVTS01+431                                               08434000
CVTRV248 EQU   CVTS01+430                                               08435000
CVTRV247 EQU   CVTS01+429                                               08436000
CVTRV246 EQU   CVTS01+428                                               08437000
CVTRV245 EQU   CVTRV237                                                 08438000
CVTRV244 EQU   CVTRV237                                                 08439000
CVTRV243 EQU   CVTRV237                                                 08440000
CVTRV242 EQU   CVTRV237                                                 08441000
CVTRV241 EQU   CVTRV237                                                 08442000
CVTRV240 EQU   CVTRV237                                                 08443000
CVTRV239 EQU   CVTRV237                                                 08444000
CVTRV238 EQU   CVTRV237                                                 08445000
CVTRV236 EQU   CVTRV228                                                 08446000
CVTRV235 EQU   CVTRV228                                                 08447000
CVTRV234 EQU   CVTRV228                                                 08448000
CVTRV233 EQU   CVTRV228                                                 08449000
CVTRV232 EQU   CVTRV228                                                 08450000
CVTRV231 EQU   CVTRV228                                                 08451000
CVTRV230 EQU   CVTRV228                                                 08452000
CVTRV229 EQU   CVTRV228                                                 08453000
CVTRV227 EQU   CVTRV219                                                 08454000
CVTRV226 EQU   CVTRV219                                                 08455000
CVTRV225 EQU   CVTRV219                                                 08456000
CVTRV224 EQU   CVTRV219                                                 08457000
CVTRV223 EQU   CVTRV219                                                 08458000
CVTRV222 EQU   CVTRV219                                                 08459000
CVTRV221 EQU   CVTRV219                                                 08460000
CVTRV220 EQU   CVTRV219                                                 08461000
CVTRV218 EQU   CVTRV210                                                 08462000
CVTRV217 EQU   CVTRV210                                                 08463000
CVTRV216 EQU   CVTRV210                                                 08464000
CVTRV215 EQU   CVTRV210                                                 08465000
CVTRV214 EQU   CVTRV210                                                 08466000
CVTRV213 EQU   CVTRV210                                                 08467000
CVTRV212 EQU   CVTRV210                                                 08468000
CVTRV211 EQU   CVTRV210                                                 08469000
CVTLCCAT EQU   CVTS01+420                                               08470000
CVTPCCAT EQU   CVTS01+416                                               08471000
CVTIPCRP EQU   CVTS01+412                                               08472000
CVTIPCRI EQU   CVTS01+408                                               08473000
CVTIPCDS EQU   CVTS01+404                                               08474000
CVTAIDVT EQU   CVTS01+400                                               08475000
CVTSSAP  EQU   CVTS01+396                                               08476000
CVTEHCIR EQU   CVTS01+392                                               08477000
CVTEHDEF EQU   CVTS01+388                                               08478000
CVTDAIR  EQU   CVTS01+384                                               08479000
CVTPERFM EQU   CVTS01+380                                               08480000
CVT044R2 EQU   CVTS01+376                                               08481000
CVTFETCH EQU   CVTS01+372                                               08482000
CVTRSTWD EQU   CVTS01+368                                               08483000
CVTSPOST EQU   CVTS01+364                                               08484000
CVTIOBP  EQU   CVTS01+360                                               08485000
CVTASMVT EQU   CVTS01+356                                               08486000
CVTRECRQ EQU   CVTS01+352                                               08487000
CVTWSAC  EQU   CVTS01+348                                               08488000
CVTRV149 EQU   CVTS01+344                                               08489000
CVTWSAL  EQU   CVTS01+340                                               08490000
CVTSPSA  EQU   CVTS01+336                                               08491000
CVTGLMN  EQU   CVTS01+332                                               08492000
CVTVEAC0 EQU   CVTS01+328                                               08493000
CVT062R1 EQU   CVTS01+324                                               08494000
CVTRPOST EQU   CVTS01+320                                               08495000
CVTDQIQE EQU   CVTS01+316                                               08496000
CVTCSD   EQU   CVTS01+312                                               08497000
CVTLKRMA EQU   CVTS01+308                                               08498000
CVTRSPIE EQU   CVTS01+304                                               08499000
CVTRENQ  EQU   CVTS01+300                                               08500000
CVTLQCB  EQU   CVTS01+296                                               08501000
CVTFQCB  EQU   CVTS01+292                                               08502000
CVTQCS01 EQU   CVTS01+288                                               08503000
CVTAPFT  EQU   CVTS01+284                                               08504000
CVTPARRL EQU   CVTS01+280                                               08505000
CVTVWAIT EQU   CVTS01+276                                               08506000
CVTGSPL  EQU   CVTS01+272                                               08507000
CVTLSMQ  EQU   CVTS01+268                                               08508000
CVTGSMQ  EQU   CVTS01+264                                               08509000
CVTEXPRO EQU   CVTS01+260                                               08510000
CVTOPCTP EQU   CVTS01+256                                               08511000
CVTSIC   EQU   CVTS01+252                                               08512000
CVTTPIOS EQU   CVTS01+248                                               08513000
CVTRTMS  EQU   CVTS01+244                                               08514000
CVTSDBF  EQU   CVTS01+240                                               08515000
CVTSCBP  EQU   CVTS01+236                                               08516000
CVTSDMP  EQU   CVTS01+232                                               08517000
CVTSV60  EQU   CVTS01+228                                               08518000
CVTRTMCT EQU   CVTS01+224                                               08519000
CVTASCBL EQU   CVTS01+220                                               08520000
CVTASCBH EQU   CVTS01+216                                               08521000
CVTGDA   EQU   CVTS01+212                                               08522000
CVTASVT  EQU   CVTS01+208                                               08523000
CVTVVMDI EQU   CVTS01+204                                               08524000
CVTAQTOP EQU   CVTS01+200                                               08525000
CVTIOSCS EQU   CVTS01+196                                               08526000
CVTSDRM  EQU   CVTS01+192                                               08527000
CVTOPTE  EQU   CVTS01+188                                               08528000
CVTSTXU  EQU   CVTS01+184                                               08529000
CVTQUIS  EQU   CVTS01+180                                               08530000
CVTPARS  EQU   CVTS01+176                                               08531000
CVTS1EE  EQU   CVTS01+172                                               08532000
CVTFRAS  EQU   CVTS01+168                                               08533000
CVTQSAS  EQU   CVTS01+164                                               08534000
CVTCRAS  EQU   CVTS01+160                                               08535000
CVTDELCP EQU   CVTS01+152                                               08536000
CVTAUTHL EQU   CVTS01+136                                               08537000
CVTSCAN  EQU   CVTS01+132                                               08538000
CVTRV144 EQU   CVTS01+130                                               08539000
CVTMAXMP EQU   CVTS01+128                                               08540000
CVTSTCK  EQU   CVTS01+124                                               08541000
CVTRV139 EQU   CVTS01+123                                               08542000
CVTDSSAC EQU   CVTS01+122                                               08543000
CVTRV513 EQU   CVTS01+121                                               08544000
CVTIOSPL EQU   CVTS01+120                                               08545000
CVTPTGT  EQU   CVTS01+116                                               08546000
CVTCSPIE EQU   CVTS01+112                                               08547000
CVTSMFEX EQU   CVTS01+108                                               08548000
CVTOLT0A EQU   CVTS01+104                                               08549000
CVTSRBRT EQU   CVTS01+100                                               08550000
CVTPUTL  EQU   CVTS01+96                                                08551000
CVTASCRL EQU   CVTS01+92                                                08552000
CVTASCRF EQU   CVTS01+88                                                08553000
CVTRV326 EQU   CVTS01+84                                                08554000
CVTRV325 EQU   CVTS01+80                                                08555000
CVTRV324 EQU   CVTS01+76                                                08556000
CVT0VL01 EQU   CVTS01+72                                                08557000
CVTSHRVM EQU   CVTS01+68                                                08558000
CVTRV332 EQU   CVTS01+64                                                08559000
CVTTAS   EQU   CVTS01+60                                                08560000
CVTRSCN  EQU   CVTS01+56                                                08561000
CVTTRAC2 EQU   CVTS01+54                                                08562000
CVTTRACE EQU   CVTS01+52                                                08563000
CVTAPG   EQU   CVTS01+51                                                08564000
CVTSDTRC EQU   CVTCTLFG                                                 08565000
CVTGTRCE EQU   CVTCTLFG                                                 08566000
CVTNOMP  EQU   CVTCTLFG                                                 08567000
CVTRSV79 EQU   CVTCTLFG                                                 08568000
CVTDSTAT EQU   CVTCTLFG                                                 08569000
CVTRSV78 EQU   CVTCTLFG                                                 08570000
CVTRV333 EQU   CVTCTLFG                                                 08571000
CVTRV323 EQU   CVTCTLFG                                                 08572000
CVTSPVLK EQU   CVTS01+49                                                08573000
CVTRSV77 EQU   CVTS01+48                                                08574000
CVTRV331 EQU   CVTS01+44                                                08575000
CVTRV330 EQU   CVTS01+40                                                08576000
CVTRV329 EQU   CVTS01+36                                                08577000
CVTRV328 EQU   CVTS01+32                                                08578000
CVTRV322 EQU   CVTS01+28                                                08579000
CVTSLID  EQU   CVTSLIDA+1                                               08580000
CVTSYLK  EQU   CVTSLIDA                                                 08581000
CVTRV321 EQU   CVTS01+20                                                08582000
CVTRV320 EQU   CVTS01+16                                                08583000
CVTLPDIR EQU   CVTLPDIA+1                                               08584000
CVTRSV69 EQU   CVTDIRST                                                 08585000
CVTRSV68 EQU   CVTDIRST                                                 08586000
CVTRSV67 EQU   CVTDIRST                                                 08587000
CVTRSV66 EQU   CVTDIRST                                                 08588000
CVTRSV65 EQU   CVTDIRST                                                 08589000
CVTRSV64 EQU   CVTDIRST                                                 08590000
CVTRSV63 EQU   CVTDIRST                                                 08591000
CVTDICOM EQU   CVTDIRST                                                 08592000
CVTPVTP  EQU   CVTS01+8                                                 08593000
CVTLPDSR EQU   CVTS01+4                                                 08594000
CVTGETL  EQU   CVTS01                                                   08595000
@NM00031 EQU   UCBWGTX                                                  08596000
@NM00030 EQU   UCBWGTX                                                  08597000
@NM00029 EQU   UCBSTATX                                                 08598000
UCBALOCX EQU   UCBSTATX                                                 08599000
@NM00028 EQU   UCBSTATX                                                 08600000
CONSPTR  EQU   @NM00013+1                                               08601000
CONSFLGS EQU   @NM00013                                                 08602000
@NM00012 EQU   MSG143M2+66                                              08603000
@NM00011 EQU   MSG143M2+63                                              08604000
@NM00010 EQU   MSG143M2                                                 08605000
@NM00009 EQU   MSG143M1+41                                              08606000
@NM00008 EQU   NEWCP+5                                                  08607000
@NM00007 EQU   NEWCP                                                    08608000
@NM00006 EQU   MSG143M1+25                                              08609000
@NM00005 EQU   OLDCP+5                                                  08610000
@NM00004 EQU   OLDCP                                                    08611000
@NM00003 EQU   MSG143M1                                                 08612000
@NM00002 EQU   MSG142M+13                                               08613000
@NM00001 EQU   MSG142M                                                  08614000
WQERSVC7 EQU   WMNM+184                                                 08615000
WQERSVC6 EQU   WMNM+181                                                 08616000
WQERSVC5 EQU   WMNMST2                                                  08617000
WQERSVC4 EQU   WMNMST2                                                  08618000
WQERSVC3 EQU   WMNMST2                                                  08619000
WQERSVC2 EQU   WMNMST2                                                  08620000
WQERSVC1 EQU   WMNMST2                                                  08621000
WQERSVB9 EQU   WMNMST2                                                  08622000
WQERSVB8 EQU   WMNMST2                                                  08623000
WMNMTPD2 EQU   WMNMST2                                                  08624000
WMNMTXT2 EQU   WMNM+108                                                 08625000
WMNMHCT2 EQU   WMNM+104                                                 08626000
WMNMTL2  EQU   WMNM+103                                                 08627000
WQERSV74 EQU   WMNM+102                                                 08628000
WQERSV73 EQU   WMNMLT2                                                  08629000
WQERSV72 EQU   WMNMLT2                                                  08630000
WQERSV71 EQU   WMNMLT2                                                  08631000
WQERSV70 EQU   WMNMLT2                                                  08632000
WMNMLT2D EQU   WMNMLT2                                                  08633000
WMNMLT2C EQU   WMNMLT2                                                  08634000
WMNMLT2B EQU   WMNMLT2                                                  08635000
WMNMLT2A EQU   WMNMLT2                                                  08636000
WMNMML2H EQU   WMNMML2                                                  08637000
WMNMML2G EQU   WMNMML2                                                  08638000
WQERSV69 EQU   WMNMML2                                                  08639000
WMNMML2E EQU   WMNMML2                                                  08640000
WMNMML2D EQU   WMNMML2                                                  08641000
WMNMML2C EQU   WMNMML2                                                  08642000
WMNMML2B EQU   WMNMML2                                                  08643000
WQERSV68 EQU   WMNMML2                                                  08644000
WMNMNX2  EQU   WMNM+97                                                  08645000
WMNMUC2  EQU   WMNM+96                                                  08646000
WQERSVB7 EQU   WMNM+88                                                  08647000
WQERSVB6 EQU   WMNM+85                                                  08648000
WQERSVB5 EQU   WMNMST1                                                  08649000
WQERSVB4 EQU   WMNMST1                                                  08650000
WQERSVB3 EQU   WMNMST1                                                  08651000
WQERSVB2 EQU   WMNMST1                                                  08652000
WQERSVB1 EQU   WMNMST1                                                  08653000
WQERSVA9 EQU   WMNMST1                                                  08654000
WQERSVA8 EQU   WMNMST1                                                  08655000
WMNMTPD1 EQU   WMNMST1                                                  08656000
WMNMTXT1 EQU   WMNM+12                                                  08657000
WMNMHCT1 EQU   WMNM+8                                                   08658000
WMNMTL1  EQU   WMNM+7                                                   08659000
WQERSV67 EQU   WMNM+6                                                   08660000
WQERSV66 EQU   WMNMLT1                                                  08661000
WQERSV65 EQU   WMNMLT1                                                  08662000
WQERSV64 EQU   WMNMLT1                                                  08663000
WQERSV63 EQU   WMNMLT1                                                  08664000
WMNMLT1C EQU   WMNMLT1                                                  08665000
WMNMLT1B EQU   WMNMLT1                                                  08666000
WMNMLT1A EQU   WMNMLT1                                                  08667000
WMNMML1H EQU   WMNMML1                                                  08668000
WMNMML1G EQU   WMNMML1                                                  08669000
WMNMML1F EQU   WMNMML1                                                  08670000
WMNMML1E EQU   WMNMML1                                                  08671000
WMNMML1D EQU   WMNMML1                                                  08672000
WMNMML1C EQU   WMNMML1                                                  08673000
WMNMML1B EQU   WMNMML1                                                  08674000
WQERSV62 EQU   WMNMML1                                                  08675000
WMJMJTCB EQU   WMJM+188                                                 08676000
WMJMDEC4 EQU   WMJMDEC+3                                                08677000
WMJMDEC3 EQU   WMJMDEC+2                                                08678000
WQERSV61 EQU   WMJMDEC2                                                 08679000
WQERSV60 EQU   WMJMDEC2                                                 08680000
WQERSV59 EQU   WMJMDEC2                                                 08681000
WQERSV58 EQU   WMJMDEC2                                                 08682000
WQERSV57 EQU   WMJMDEC2                                                 08683000
WQERSV56 EQU   WMJMDEC2                                                 08684000
WMJMDECJ EQU   WMJMDEC2                                                 08685000
WMJMDECG EQU   WMJMDEC1                                                 08686000
WMJMDECF EQU   WMJMDEC1                                                 08687000
WMJMDECE EQU   WMJMDEC1                                                 08688000
WMJMDECD EQU   WMJMDEC1                                                 08689000
WMJMDECC EQU   WMJMDEC1                                                 08690000
WMJMDECB EQU   WMJMDEC1                                                 08691000
WMJMDECA EQU   WMJMDEC1                                                 08692000
WQERSV54 EQU   WMJM+181                                                 08693000
WMJMUID  EQU   WMJM+180                                                 08694000
WMJMRCT4 EQU   WMJMRTC+3                                                08695000
WMJMRCT3 EQU   WMJMRTC+2                                                08696000
WQERSV53 EQU   WMJMRCT2                                                 08697000
WMJMRCTO EQU   WMJMRCT2                                                 08698000
WMJMRCTN EQU   WMJMRCT2                                                 08699000
WMJMRCTM EQU   WMJMRCT2                                                 08700000
WMJMRCTL EQU   WMJMRCT2                                                 08701000
WMJMRCTK EQU   WMJMRCT2                                                 08702000
WMJMRCTJ EQU   WMJMRCT2                                                 08703000
WMJMRCTI EQU   WMJMRCT2                                                 08704000
WMJMRCTH EQU   WMJMRCT1                                                 08705000
WMJMRCTG EQU   WMJMRCT1                                                 08706000
WMJMRCTF EQU   WMJMRCT1                                                 08707000
WMJMRCTE EQU   WMJMRCT1                                                 08708000
WMJMRCTD EQU   WMJMRCT1                                                 08709000
WMJMRCTC EQU   WMJMRCT1                                                 08710000
WMJMRCTB EQU   WMJMRCT1                                                 08711000
WMJMRCTA EQU   WMJMRCT1                                                 08712000
WMJMMT2  EQU   WMJMMT+1                                                 08713000
WQERSV52 EQU   WMJMMT1                                                  08714000
WQERSV51 EQU   WMJMMT1                                                  08715000
WMJMMT1F EQU   WMJMMT1                                                  08716000
WQERSV50 EQU   WMJMMT1                                                  08717000
WMJMMT1D EQU   WMJMMT1                                                  08718000
WQERSVA6 EQU   WMJMMT1                                                  08719000
WMJMMT1B EQU   WMJMMT1                                                  08720000
WMJMMT1A EQU   WMJMMT1                                                  08721000
WQERSV11 EQU   WMJMCS2                                                  08722000
WQERSV49 EQU   WMJMCS2                                                  08723000
WMJMCS2F EQU   WMJMCS2                                                  08724000
WQERSV48 EQU   WMJMCS2                                                  08725000
WQERSV47 EQU   WMJMCS2                                                  08726000
WMJMCS2C EQU   WMJMCS2                                                  08727000
WMJMCS2B EQU   WMJMCS2                                                  08728000
WMJMCS2A EQU   WMJMCS2                                                  08729000
WMJMCS1H EQU   WMJMCS1                                                  08730000
WMJMCS1G EQU   WMJMCS1                                                  08731000
WMJMCS1F EQU   WMJMCS1                                                  08732000
WMJMCS1E EQU   WMJMCS1                                                  08733000
WMJMCS1D EQU   WMJMCS1                                                  08734000
WMJMCS1C EQU   WMJMCS1                                                  08735000
WMJMCS1B EQU   WMJMCS1                                                  08736000
WMJMCS1A EQU   WMJMCS1                                                  08737000
WMJMSEQ  EQU   WMJM+169                                                 08738000
WMJMRTCT EQU   WMJM+168                                                 08739000
WMJMTCB  EQU   WMJM+164                                                 08740000
WQERSV45 EQU   WMJMBUF                                                  08741000
WMJMBUFG EQU   WMJMBUF                                                  08742000
WMJMBUFF EQU   WMJMBUF                                                  08743000
WMJMBUFE EQU   WMJMBUF                                                  08744000
WMJMBUFD EQU   WMJMBUF                                                  08745000
WMJMBUFC EQU   WMJMBUF                                                  08746000
WMJMBUFB EQU   WMJMBUF                                                  08747000
WMJMBUFA EQU   WMJMBUF                                                  08748000
WMJMASID EQU   WMJM+161                                                 08749000
WMJMDSPH EQU   WMJMDSP                                                  08750000
WMJMDSPG EQU   WMJMDSP                                                  08751000
WMJMDSPF EQU   WMJMDSP                                                  08752000
WMJMDSPE EQU   WMJMDSP                                                  08753000
WMJMDSPD EQU   WMJMDSP                                                  08754000
WMJMDSPC EQU   WMJMDSP                                                  08755000
WMJMDSPB EQU   WMJMDSP                                                  08756000
WMJMDSPA EQU   WMJMDSP                                                  08757000
WQERSVA5 EQU   WMJM+156                                                 08758000
WQERSVA4 EQU   WMJM+152                                                 08759000
WQERSVD8 EQU   WMJM+149                                                 08760000
WQERSVD7 EQU   WMJMECBF                                                 08761000
WQERSVD6 EQU   WMJMECBF                                                 08762000
WQERSVD5 EQU   WMJMECBF                                                 08763000
WQERSVD4 EQU   WMJMECBF                                                 08764000
WQERSVD3 EQU   WMJMECBF                                                 08765000
WQERSVD2 EQU   WMJMECBF                                                 08766000
WMJMMAJD EQU   WMJMECBF                                                 08767000
WMJMWAIT EQU   WMJMECBF                                                 08768000
WMJMMSGN EQU   WMJM+144                                                 08769000
WMJMAECB EQU   WMJM+140                                                 08770000
WMJMLTY2 EQU   WMJMLTYP+1                                               08771000
WQERSV38 EQU   WMJMLTY1                                                 08772000
WQERSV37 EQU   WMJMLTY1                                                 08773000
WQERSV36 EQU   WMJMLTY1                                                 08774000
WQERSV35 EQU   WMJMLTY1                                                 08775000
WMJMLTYC EQU   WMJMLTY1                                                 08776000
WMJMLTYB EQU   WMJMLTY1                                                 08777000
WMJMLTYA EQU   WMJMLTY1                                                 08778000
WQERSV34 EQU   WMJM+132                                                 08779000
WMJMCONS EQU   WMJM+124                                                 08780000
WMJMSER2 EQU   WMJMSER+1                                                08781000
WQERSV33 EQU   WMJMSER1                                                 08782000
WQERSV32 EQU   WMJMSER1                                                 08783000
WQERSV31 EQU   WMJMSER1                                                 08784000
WMJMSERE EQU   WMJMSER1                                                 08785000
WMJMSERD EQU   WMJMSER1                                                 08786000
WMJMSERC EQU   WMJMSER1                                                 08787000
WMJMSERB EQU   WMJMSER1                                                 08788000
WMJMSERA EQU   WMJMSER1                                                 08789000
WQERSV30 EQU   WMJM+120                                                 08790000
WQERSV29 EQU   WMJM+116                                                 08791000
WMJMRESA EQU   WMJM+108                                                 08792000
WNJNPAD3 EQU   WMJM+107                                                 08793000
WMJMHCID EQU   WMJM+103                                                 08794000
WMJMTXT  EQU   WMJM+31                                                  08795000
WMJMPAD2 EQU   WMJM+30                                                  08796000
WMJMJBNM EQU   WMJM+22                                                  08797000
WMJMPAD1 EQU   WMJM+21                                                  08798000
WMJMTSSS EQU   WMJMTS+6                                                 08799000
WMJMTSP2 EQU   WMJMTS+5                                                 08800000
WMJMTSMM EQU   WMJMTS+3                                                 08801000
WMJMTSP1 EQU   WMJMTS+2                                                 08802000
WMJMTSHH EQU   WMJMTS                                                   08803000
WMJMPAD  EQU   WMJM+12                                                  08804000
WMJMRR   EQU   WMJM+8                                                   08805000
WMJMTXTL EQU   WMJM+6                                                   08806000
WMJMAREA EQU   WMJM+5                                                   08807000
WMJMMLWG EQU   WMJMMLW                                                  08808000
WMJMMLWF EQU   WMJMMLW                                                  08809000
WMJMMLWE EQU   WMJMMLW                                                  08810000
WMJMMLWD EQU   WMJMMLW                                                  08811000
WMJMMLWC EQU   WMJMMLW                                                  08812000
WMJMMLWB EQU   WMJMMLW                                                  08813000
WMJMMLWA EQU   WMJMMLW                                                  08814000
WMJMNXT  EQU   WMJMEXTA                                                 08815000
WMJMUC   EQU   WMJMEXT                                                  08816000
WQERSV26 EQU   WQE+186                                                  08817000
WQERSV25 EQU   WQEDC2                                                   08818000
WQERSV24 EQU   WQEDC2                                                   08819000
WQERSV23 EQU   WQEDC2                                                   08820000
WQERSV22 EQU   WQEDC2                                                   08821000
WQERSV21 EQU   WQEDC2                                                   08822000
WQERSV20 EQU   WQEDC2                                                   08823000
WQEDCJ   EQU   WQEDC2                                                   08824000
WQEDCI   EQU   WQEDC2                                                   08825000
WQEDCH   EQU   WQEDC1                                                   08826000
WQEDCG   EQU   WQEDC1                                                   08827000
WQEDCF   EQU   WQEDC1                                                   08828000
WQEDCE   EQU   WQEDC1                                                   08829000
WQEDCC   EQU   WQEDC1                                                   08830000
WQEDCB   EQU   WQEDC1                                                   08831000
WQEDCA   EQU   WQEDC1                                                   08832000
WQERPYID EQU   WQE+182                                                  08833000
WQERSV18 EQU   WQE+181                                                  08834000
WQERSV17 EQU   WQE+178                                                  08835000
WQERSV16 EQU   WQEROUT2                                                 08836000
WQEROUTO EQU   WQEROUT2                                                 08837000
WQEROUTN EQU   WQEROUT2                                                 08838000
WQEROUTM EQU   WQEROUT2                                                 08839000
WQEROUTL EQU   WQEROUT2                                                 08840000
WQEROUTK EQU   WQEROUT2                                                 08841000
WQEROUTJ EQU   WQEROUT2                                                 08842000
WQEROUTI EQU   WQEROUT2                                                 08843000
WQEROUTH EQU   WQEROUT1                                                 08844000
WQEROUTG EQU   WQEROUT1                                                 08845000
WQEROUTF EQU   WQEROUT1                                                 08846000
WQEROUTE EQU   WQEROUT1                                                 08847000
WQEROUTD EQU   WQEROUT1                                                 08848000
WQEROUTC EQU   WQEROUT1                                                 08849000
WQEROUTA EQU   WQEROUT1                                                 08850000
WQERSV15 EQU   WQEMSGT1                                                 08851000
WQERSV14 EQU   WQEMSGT1                                                 08852000
WQEMSGTF EQU   WQEMSGT1                                                 08853000
WQERSV13 EQU   WQEMSGT1                                                 08854000
WQEMSGTD EQU   WQEMSGT1                                                 08855000
WQEMSGTC EQU   WQEMSGT1                                                 08856000
WQEMSGTB EQU   WQEMSGT1                                                 08857000
WQEMSGTA EQU   WQEMSGT1                                                 08858000
WQEMCSP  EQU   WQEMCSF2                                                 08859000
WQEMCSO  EQU   WQEMCSF2                                                 08860000
WQERSV10 EQU   WQEMCSF2                                                 08861000
WQERSV09 EQU   WQEMCSF2                                                 08862000
WQEMCSK  EQU   WQEMCSF2                                                 08863000
WQEMCSJ  EQU   WQEMCSF2                                                 08864000
WQEMCSI  EQU   WQEMCSF2                                                 08865000
WQEMCSFF EQU   WQEMCSF1                                                 08866000
WQEMCSE  EQU   WQEMCSF1                                                 08867000
WQEMCSC  EQU   WQEMCSF1                                                 08868000
WQERTCT  EQU   WQE+168                                                  08869000
WQERSV07 EQU   WQEAVAIL                                                 08870000
WQERSV06 EQU   WQEAVAIL                                                 08871000
WQEBUFF  EQU   WQEAVAIL                                                 08872000
WQEBUFB  EQU   WQEAVAIL                                                 08873000
WQEBUFA  EQU   WQEAVAIL                                                 08874000
WQEDOM   EQU   WQEXA                                                    08875000
WQEWTOR  EQU   WQEXA                                                    08876000
WQEORE   EQU   WQEXA                                                    08877000
WQEPURGE EQU   WQEXA                                                    08878000
WQEPAD3  EQU   WQE+159                                                  08879000
WQETXTL  EQU   WQETXT+127                                               08880000
@NM00181 EQU   WQETXT                                                   08881000
WQETSSS  EQU   WQETS+6                                                  08882000
WQEPER2  EQU   WQETS+5                                                  08883000
WQETSMM  EQU   WQETS+3                                                  08884000
WQEPER1  EQU   WQETS+2                                                  08885000
WQETSHH  EQU   WQETS                                                    08886000
UCMEFRV1 EQU   UCMEFEXT+8                                               08887000
UCMEFSA1 EQU   UCMEFEXT+3                                               08888000
UCMEFLG2 EQU   UCMEFEXT+1                                               08889000
UCMEFLGH EQU   UCMEFLG1                                                 08890000
UCMEFLGG EQU   UCMEFLG1                                                 08891000
UCMEFLGF EQU   UCMEFLG1                                                 08892000
UCMEFLGE EQU   UCMEFLG1                                                 08893000
UCMEFLGD EQU   UCMEFLG1                                                 08894000
UCMEFLGC EQU   UCMEFLG1                                                 08895000
UCMPEDUM EQU   UCMPEXTA+60                                              08896000
UCMPELST EQU   UCMPEXTA+56                                              08897000
UCMPELEN EQU   UCMPEXTA+52                                              08898000
UCMPE1ST EQU   UCMPEXTA+48                                              08899000
UCMPRSV2 EQU   UCMPEXTA+20                                              08900000
UCMPRSV1 EQU   UCMPDM1+12                                               08901000
UCMPWQE  EQU   UCMPDM1                                                  08902000
UCMPUCMP EQU   UCMPEXTA                                                 08903000
UCMFELST EQU   UCMFEXTA+48                                              08904000
UCMFELEN EQU   UCMFEXTA+44                                              08905000
UCMFE1ST EQU   UCMFEXTA+40                                              08906000
UCMFRAD  EQU   UCMFRECB+1                                               08907000
UCMFRB0  EQU   UCMFRBYT                                                 08908000
UCMFXECB EQU   UCMFECBL                                                 08909000
UCMFRSV3 EQU   UCMFEXTA+20                                              08910000
UCMF80WQ EQU   UCMFEXTA+18                                              08911000
UCMF60WQ EQU   UCMFEXTA+16                                              08912000
UCMFRSV2 EQU   UCMFMGFS+4                                               08913000
UCMFRSV1 EQU   UCMFMGFS+2                                               08914000
UCMFFLG2 EQU   UCMFMGFS+1                                               08915000
UCMFBR07 EQU   UCMFFLG1                                                 08916000
UCMFBR06 EQU   UCMFFLG1                                                 08917000
UCMFBR05 EQU   UCMFFLG1                                                 08918000
UCMFBR04 EQU   UCMFFLG1                                                 08919000
UCMFBR03 EQU   UCMFFLG1                                                 08920000
UCMFMSGN EQU   UCMFFLG1                                                 08921000
UCMFMSGA EQU   UCMFFLG1                                                 08922000
UCMFMSGE EQU   UCMFFLG1                                                 08923000
UCMFUCMF EQU   UCMFEXTA                                                 08924000
UCMDESCD EQU   UCMEXIT+132                                              08925000
UCMROUTC EQU   UCMEXIT+128                                              08926000
UCMMSTXT EQU   UCMEXIT                                                  08927000
UCMRSV64 EQU   UCMLIST+76                                               08928000
UCMRCTA  EQU   UCMRCT+1                                                 08929000
UCMRSV31 EQU   UCMSDS5                                                  08930000
UCMRSV30 EQU   UCMSDS5                                                  08931000
UCMRSV29 EQU   UCMSDS5                                                  08932000
UCMDEVG  EQU   UCMDEVC                                                  08933000
UCMDEVF  EQU   UCMDEVC                                                  08934000
UCMDEVD  EQU   UCMDEVC                                                  08935000
UCMDEVB  EQU   UCMDEVC                                                  08936000
UCMDEVA  EQU   UCMDEVC                                                  08937000
UCMXOR   EQU   UCMLIST+62                                               08938000
UCMMSG2  EQU   UCMMSG+1                                                 08939000
UCMRSV27 EQU   UCMMSG1                                                  08940000
UCMRSV26 EQU   UCMMSG1                                                  08941000
UCMMSGF  EQU   UCMMSG1                                                  08942000
UCMRSV71 EQU   UCMMSG1                                                  08943000
UCMMSGD  EQU   UCMMSG1                                                  08944000
UCMRSV70 EQU   UCMMSG1                                                  08945000
UCMMSGB  EQU   UCMMSG1                                                  08946000
UCMMSGA  EQU   UCMMSG1                                                  08947000
UCMOAOEN EQU   UCMLIST+48                                               08948000
UCMRV007 EQU   UCMDISP2                                                 08949000
UCMRV006 EQU   UCMDISP2                                                 08950000
UCMRV005 EQU   UCMDISP2                                                 08951000
UCMRV004 EQU   UCMDISP2                                                 08952000
UCMRV003 EQU   UCMDISP2                                                 08953000
UCMDISPH EQU   UCMDISP1                                                 08954000
UCMAUTHB EQU   UCMAUTH+1                                                08955000
UCMRSV23 EQU   UCMAUTHA                                                 08956000
UCMRSV22 EQU   UCMAUTHA                                                 08957000
UCMRSV21 EQU   UCMAUTHA                                                 08958000
UCMRSV20 EQU   UCMAUTHA                                                 08959000
UCMRSV19 EQU   UCMAUTHA                                                 08960000
UCMRSV18 EQU   UCMLIST+34                                               08961000
@NM00180 EQU   UCMXA+1                                                  08962000
UCMRSV17 EQU   UCMATR                                                   08963000
UCMRSV16 EQU   UCMATR                                                   08964000
UCMAT04  EQU   UCMATR                                                   08965000
UCMLF    EQU   UCMATR                                                   08966000
UCMXF    EQU   UCMATR                                                   08967000
UCMTD    EQU   UCMSTS                                                   08968000
UCMTB    EQU   UCMSTS                                                   08969000
UCMDECBA EQU   UCMEIL+20                                                08970000
UCMOECBA EQU   UCMEIL+16                                                08971000
UCMAECBA EQU   UCMEIL+12                                                08972000
UCMXECBA EQU   UCMEIL+8                                                 08973000
UCMNIPTR EQU   UCMEIL+4                                                 08974000
UCMRSV15 EQU   UCMEIL+3                                                 08975000
UCMRTCT  EQU   UCMEIL+2                                                 08976000
UCMRPYL  EQU   UCMEIL+1                                                 08977000
@NM00179 EQU   UCMEIL                                                   08978000
UCMRSV62 EQU   UCM+304                                                  08979000
UCMRSV60 EQU   UCM+302                                                  08980000
UCMRSV59 EQU   UCMRSV51                                                 08981000
UCMRSV58 EQU   UCMRSV51                                                 08982000
UCMRSV57 EQU   UCMRSV51                                                 08983000
UCMRSV56 EQU   UCMRSV51                                                 08984000
UCMRSV55 EQU   UCMRSV51                                                 08985000
UCMRSV54 EQU   UCMRSV51                                                 08986000
UCMRSV53 EQU   UCMRSV51                                                 08987000
UCMRSV52 EQU   UCMRSV51                                                 08988000
UCMRSV50 EQU   UCMRSV42                                                 08989000
UCMRSV49 EQU   UCMRSV42                                                 08990000
UCMRSV48 EQU   UCMRSV42                                                 08991000
UCMRSV47 EQU   UCMRSV42                                                 08992000
UCMRSV46 EQU   UCMRSV42                                                 08993000
UCMRSV45 EQU   UCMRSV42                                                 08994000
UCMRSV44 EQU   UCMRSV42                                                 08995000
UCMRSV43 EQU   UCMRSV42                                                 08996000
UCMJES3T EQU   UCM+296                                                  08997000
UCMWAKUP EQU   UCM+292                                                  08998000
UCMSWCH  EQU   UCM+284                                                  08999000
UCMORECP EQU   UCM+272                                                  09000000
UCMOECBT EQU   UCM+268                                                  09001000
UCMOECBH EQU   UCM+264                                                  09002000
UCMWECBT EQU   UCM+260                                                  09003000
UCMWECBH EQU   UCM+256                                                  09004000
UCMMBEND EQU   UCM+252                                                  09005000
UCMRSV61 EQU   UCM+248                                                  09006000
UCMRP2AD EQU   UCM+244                                                  09007000
UCMWQLM1 EQU   UCM+238                                                  09008000
UCMRV001 EQU   UCM+237                                                  09009000
UCMRQLM1 EQU   UCM+236                                                  09010000
UCMMBPTR EQU   UCM+232                                                  09011000
UCMMQNXT EQU   UCM+228                                                  09012000
UCMMQEND EQU   UCM+224                                                  09013000
UCMMQPTR EQU   UCM+220                                                  09014000
UCMTRECB EQU   UCM+216                                                  09015000
UCMMNECB EQU   UCM+212                                                  09016000
UCMR9SV  EQU   UCM+204                                                  09017000
UCMSAVE4 EQU   UCM+140                                                  09018000
UCMRSV77 EQU   UCM+84                                                   09019000
UCMRSV76 EQU   UCM+71                                                   09020000
UCMRSV67 EQU   UCM+70                                                   09021000
UCMRSV75 EQU   UCM+69                                                   09022000
UCMFIX   EQU   UCMMODE                                                  09023000
UCMMCS   EQU   UCMMODE                                                  09024000
UCMOGCE  EQU   UCMMODE                                                  09025000
UCMRSV14 EQU   UCMMODE                                                  09026000
UCMTPUTA EQU   UCMMODE                                                  09027000
UCMRSV66 EQU   UCMMODE                                                  09028000
UCMRSV11 EQU   UCMMODE                                                  09029000
UCMRQNR  EQU   UCM+56                                                   09030000
UCMWQECB EQU   UCM+52                                                   09031000
UCMRQECB EQU   UCM+48                                                   09032000
UCMWQLM  EQU   UCM+46                                                   09033000
UCMRQLM  EQU   UCM+45                                                   09034000
@NM00178 EQU   UCMRPYI                                                  09035000
UCMARECB EQU   UCM+16                                                   09036000
UCMLECB  EQU   UCMDECB                                                  09037000
UCMAECB  EQU   UCM+4                                                    09038000
UCMXECB  EQU   UCM                                                      09039000
UCMRSV65 EQU   UCMPRFX+158                                              09040000
UCMSDS2  EQU   UCMPRFX+157                                              09041000
UCMRSV09 EQU   UCMSDS1                                                  09042000
UCMRSV08 EQU   UCMSDS1                                                  09043000
UCMRSV07 EQU   UCMSDS1                                                  09044000
UCMRSV06 EQU   UCMSDS1                                                  09045000
UCMRSV05 EQU   UCMSDS1                                                  09046000
UCMRSV04 EQU   UCMSDS1                                                  09047000
UCMSDS1B EQU   UCMSDS1                                                  09048000
UCMSDS1A EQU   UCMSDS1                                                  09049000
UCMRSV72 EQU   UCMPRFX+152                                              09050000
UCMLOGAD EQU   UCMPRFX+148                                              09051000
UCMNPECB EQU   UCMPRFX+144                                              09052000
UCMRSV69 EQU   UCMPRFX+140                                              09053000
UCM6WD   EQU   UCMXSA+20                                                09054000
UCM5WD   EQU   UCMXSA+16                                                09055000
UCM4WD   EQU   UCMXSA+12                                                09056000
UCM3WD   EQU   UCMXSA+8                                                 09057000
UCM2WD   EQU   UCMXSA+4                                                 09058000
UCM1WD   EQU   UCMXSA                                                   09059000
UCMRSV03 EQU   UCMPRFX+102                                              09060000
UCMHRDRT EQU   UCMPRFX+100                                              09061000
UCMXCT   EQU   UCMPRFX+96                                               09062000
UCMOWTOR EQU   UCMPRFX+86                                               09063000
UCMSYSO  EQU   UCMSFLG2                                                 09064000
UCMSYSN  EQU   UCMSFLG2                                                 09065000
UCMSYSM  EQU   UCMSFLG2                                                 09066000
UCMSYSK  EQU   UCMSFLG2                                                 09067000
UCMRSV35 EQU   UCMSFLG1                                                 09068000
UCMSYSF  EQU   UCMSFLG1                                                 09069000
UCMSYSC  EQU   UCMSFLG1                                                 09070000
UCMSYSB  EQU   UCMSFLG1                                                 09071000
UCMRSV01 EQU   UCMSFLG1                                                 09072000
UCMWTOX  EQU   UCMPRFX+80                                               09073000
UCMDOME  EQU   UCMPRFX+76                                               09074000
UCMSVR0  EQU   UCMSAVE0+68                                              09075000
UCMSVQ0  EQU   UCMSAVE0+64                                              09076000
UCMSVP0  EQU   UCMSAVE0+60                                              09077000
UCMSVO0  EQU   UCMSAVE0+56                                              09078000
UCMSVN0  EQU   UCMSAVE0+52                                              09079000
UCMSVM0  EQU   UCMSAVE0+48                                              09080000
UCMSVL0  EQU   UCMSAVE0+44                                              09081000
UCMSVK0  EQU   UCMSAVE0+40                                              09082000
UCMSVJ0  EQU   UCMSAVE0+36                                              09083000
UCMSVI0  EQU   UCMSAVE0+32                                              09084000
UCMSVH0  EQU   UCMSAVE0+28                                              09085000
UCMSVG0  EQU   UCMSAVE0+24                                              09086000
UCMSVF0  EQU   UCMSAVE0+20                                              09087000
UCMSVE0  EQU   UCMSAVE0+16                                              09088000
UCMSVD0  EQU   UCMSAVE0+12                                              09089000
UCMSVC0  EQU   UCMSAVE0+8                                               09090000
UCMSVB0  EQU   UCMSAVE0+4                                               09091000
UCMSVA0  EQU   UCMSAVE0                                                 09092000
UCMRSV74 EQU   UCM2EXT+20                                               09093000
UCMRSV73 EQU   UCM2EXT+16                                               09094000
UCM2FEXT EQU   UCM2EXT+12                                               09095000
UCM2STAA EQU   UCM2STA+1                                                09096000
UCMRV008 EQU   UCM2SFLG                                                 09097000
UCMRSV34 EQU   UCM2SFLG                                                 09098000
UCMRSV33 EQU   UCM2SFLG                                                 09099000
UCM2WTOI EQU   UCM2SFLG                                                 09100000
UCM2DSTR EQU   UCM2SFLG                                                 09101000
UCM2DTAK EQU   UCM2SFLG                                                 09102000
UCM2SENT EQU   UCM2SFLG                                                 09103000
UCM2SDWA EQU   UCM2SFLG                                                 09104000
UCM2PST  EQU   UCM2EXT+4                                                09105000
UCM2RID  EQU   UCM2EXT+2                                                09106000
UCM2WID  EQU   UCM2EXT                                                  09107000
UCBERADR EQU   UCBUCS+12                                                09108000
UCBFCBID EQU   UCBUCS+8                                                 09109000
UCBERCNT EQU   UCBUCS+7                                                 09110000
UCBRSV51 EQU   UCBUCS+6                                                 09111000
UCBFCBPE EQU   UCBFCBOP                                                 09112000
UCBRSV49 EQU   UCBFCBOP                                                 09113000
UCBRSV48 EQU   UCBFCBOP                                                 09114000
UCBRSV47 EQU   UCBFCBOP                                                 09115000
UCBRSV46 EQU   UCBFCBOP                                                 09116000
UCBRSV45 EQU   UCBFCBOP                                                 09117000
UCBRSV44 EQU   UCBFCBOP                                                 09118000
UCBFCBO1 EQU   UCBFCBOP                                                 09119000
UCBUCSPE EQU   UCBUCSOP                                                 09120000
UCBRSV43 EQU   UCBUCSOP                                                 09121000
UCBRSV42 EQU   UCBUCSOP                                                 09122000
UCBRSV41 EQU   UCBUCSOP                                                 09123000
UCBRSV40 EQU   UCBUCSOP                                                 09124000
UCBRSV39 EQU   UCBUCSOP                                                 09125000
UCBUCSO2 EQU   UCBUCSOP                                                 09126000
UCBUCSO1 EQU   UCBUCSOP                                                 09127000
UCBUCSID EQU   UCBUCS                                                   09128000
UCBMDRBA EQU   UCBMDRBF+1                                               09129000
UCBRV075 EQU   UCBMDRBF                                                 09130000
UCBRV074 EQU   UCB3800X+32                                              09131000
UCBIMAGE EQU   UCB3800X+28                                              09132000
UCBFCBNM EQU   UCB3800X+24                                              09133000
UCBCHAR4 EQU   UCB3800X+20                                              09134000
UCBCHAR3 EQU   UCB3800X+16                                              09135000
UCBCHAR2 EQU   UCB3800X+12                                              09136000
UCBCHAR1 EQU   UCB3800X+8                                               09137000
UCBCGMID EQU   UCB3800X+4                                               09138000
UCBBRSTA EQU   UCBACTIV                                                 09139000
UCBRV063 EQU   UCBACTIV                                                 09140000
UCBRV062 EQU   UCBACTIV                                                 09141000
UCBRV061 EQU   UCBACTIV                                                 09142000
UCBRV060 EQU   UCBACTIV                                                 09143000
UCBRV059 EQU   UCBACTIV                                                 09144000
UCBRV058 EQU   UCBACTIV                                                 09145000
UCBRV057 EQU   UCBACTIV                                                 09146000
UCBRV050 EQU   UCB3800X+2                                               09147000
UCBCGMNO EQU   UCB3800X+1                                               09148000
UCBRV083 EQU   UCBOPTNS                                                 09149000
UCBBRSTR EQU   UCBOPTNS                                                 09150000
UCBRV056 EQU   UCBOPTNS                                                 09151000
UCBRV055 EQU   UCBOPTNS                                                 09152000
UCBRV054 EQU   UCBOPTNS                                                 09153000
UCBRV053 EQU   UCBOPTNS                                                 09154000
UCBRV052 EQU   UCBOPTNS                                                 09155000
UCBRV051 EQU   UCBOPTNS                                                 09156000
UCBRV073 EQU   UCB3540X+7                                               09157000
UCBRV072 EQU   UCBDKBYT                                                 09158000
UCBRV071 EQU   UCBDKBYT                                                 09159000
UCBRV070 EQU   UCBDKBYT                                                 09160000
UCBRV069 EQU   UCBDKBYT                                                 09161000
UCBRV068 EQU   UCBDKBYT                                                 09162000
UCBRV067 EQU   UCBDKBYT                                                 09163000
UCBVLVER EQU   UCBDKBYT                                                 09164000
UCBDKAMX EQU   UCBDKBYT                                                 09165000
UCBVLSER EQU   UCB3540X                                                 09166000
UCBRDATA EQU   UCBOCR+4                                                 09167000
UCBFRID  EQU   UCBOCR                                                   09168000
UCBCLN   EQU   UCBMT+14                                                 09169000
UCBERG   EQU   UCBMT+12                                                 09170000
UCBMS    EQU   UCBMT+11                                                 09171000
UCBNB    EQU   UCBMT+10                                                 09172000
UCBPW    EQU   UCBMT+9                                                  09173000
UCBPR    EQU   UCBMT+8                                                  09174000
UCBSIO   EQU   UCBMT+6                                                  09175000
UCBTW    EQU   UCBMT+5                                                  09176000
UCBTR    EQU   UCBMT+4                                                  09177000
UCBTWT   EQU   UCBMT+3                                                  09178000
UCBTRT   EQU   UCBMT+2                                                  09179000
UCBCTD   EQU   UCBMT                                                    09180000
UCBWTOID EQU   UCBCMEXT+17                                              09181000
UCBMIHTI EQU   UCBCMEXT+16                                              09182000
UCBASID  EQU   UCBCMEXT+14                                              09183000
UCBMFCNT EQU   UCBCMEXT+12                                              09184000
UCBPMSK  EQU   UCBCMEXT+10                                              09185000
UCBCCWOF EQU   UCBCMEXT+8                                               09186000
UCBRV041 EQU   UCBCMEXT+6                                               09187000
UCBRV036 EQU   UCBFLP1                                                  09188000
UCBRV035 EQU   UCBFLP1                                                  09189000
UCBERLOG EQU   UCBFLP1                                                  09190000
UCBRV033 EQU   UCBFLP1                                                  09191000
UCBINHIO EQU   UCBFLP1                                                  09192000
UCBNSWAP EQU   UCBFLP1                                                  09193000
UCBSHRUP EQU   UCBFLP1                                                  09194000
UCBNSRCH EQU   UCBFLP1                                                  09195000
UCBSNSCT EQU   UCBCMEXT+4                                               09196000
UCBHPDV  EQU   @NM00177                                                 09197000
UCBHALI  EQU   @NM00177                                                 09198000
UCBRSV09 EQU   @NM00177                                                 09199000
UCBRSV08 EQU   @NM00177                                                 09200000
UCBRSV07 EQU   @NM00177                                                 09201000
UCBRSV06 EQU   @NM00177                                                 09202000
UCBRSV05 EQU   @NM00177                                                 09203000
UCBRSV04 EQU   @NM00177                                                 09204000
UCBDTI   EQU   UCBCMEXT+2                                               09205000
UCBSTI   EQU   UCBCMEXT+1                                               09206000
UCBETI   EQU   UCBCMEXT                                                 09207000
UCBEXTP  EQU   UCBEXTPT+1                                               09208000
UCBDDRSW EQU   UCBFLC                                                   09209000
UCBTICBT EQU   UCBFLC                                                   09210000
UCBIVRR  EQU   UCBFLC                                                   09211000
UCBIVRS  EQU   UCBFLC                                                   09212000
UCBITF   EQU   UCBFLC                                                   09213000
UCBUDE   EQU   UCBFLC                                                   09214000
UCBWAA   EQU   UCBFLC                                                   09215000
UCBATTP  EQU   UCBFLC                                                   09216000
UCBUNTYP EQU   UCBTBYT4                                                 09217000
UCBRSV11 EQU   UCBDVCLS                                                 09218000
UCBRSV10 EQU   UCBDVCLS                                                 09219000
UCB3CHAR EQU   UCBDVCLS                                                 09220000
UCB3UREC EQU   UCBDVCLS                                                 09221000
UCB3DISP EQU   UCBDVCLS                                                 09222000
UCB3DACC EQU   UCBDVCLS                                                 09223000
UCB3TAPE EQU   UCBDVCLS                                                 09224000
UCBDVPWR EQU   UCB2OPT7                                                 09225000
UCBVLPWR EQU   UCB2OPT6                                                 09226000
UCB2OPT5 EQU   UCBTBYT2                                                 09227000
UCBRVDEV EQU   UCBRWTAU                                                 09228000
UCBRPS   EQU   UCBDUDN2                                                 09229000
UCBRR    EQU   UCBDUDN1                                                 09230000
UCB2OPT1 EQU   UCBTBYT2                                                 09231000
UCB2OPT0 EQU   UCBTBYT2                                                 09232000
UCB1FEA7 EQU   UCBTBYT1                                                 09233000
UCBD6250 EQU   UCB1FEA6                                                 09234000
UCBD1600 EQU   UCB1FEA5                                                 09235000
UCB1FEA4 EQU   UCBTBYT1                                                 09236000
UCB1FEA3 EQU   UCBTBYT1                                                 09237000
UCB1FEA2 EQU   UCBTBYT1                                                 09238000
UCB1FEA1 EQU   UCBTBYT1                                                 09239000
UCB1FEA0 EQU   UCBTBYT1                                                 09240000
UCBRV029 EQU   UCBWGT                                                   09241000
UCBVORSN EQU   UCBWGT                                                   09242000
UCBMTPXP EQU   UCBWGT                                                   09243000
UCBREW   EQU   UCBWGT                                                   09244000
UCBPUB   EQU   UCBWGT                                                   09245000
UCBOUT   EQU   UCBWGT                                                   09246000
UCBIN    EQU   UCBWGT                                                   09247000
UCBCPU   EQU   UCBOB+11                                                 09248000
UCBLCI   EQU   UCBOB+10                                                 09249000
UCBCNT   EQU   UCBOB+9                                                  09250000
UCBRV017 EQU   UCBCHM1                                                  09251000
UCBRV016 EQU   UCBCHM1                                                  09252000
UCBRV015 EQU   UCBCHM1                                                  09253000
UCBRV014 EQU   UCBCHM1                                                  09254000
UCBSPB   EQU   UCBPTH1                                                  09255000
UCBPPB   EQU   UCBPTH1                                                  09256000
UCBSPA   EQU   UCBPTH0                                                  09257000
UCBPPA   EQU   UCBPTH0                                                  09258000
UCBSIGP  EQU   UCBFLB                                                   09259000
UCBVALPH EQU   UCBFLB                                                   09260000
UCBCRHSN EQU   UCBFLB                                                   09261000
UCBCRHRV EQU   UCBFLB                                                   09262000
UCBRESVH EQU   UCBFLB                                                   09263000
UCBSPST  EQU   UCBFLB                                                   09264000
UCBASNS  EQU   UCBFLB                                                   09265000
UCBIORST EQU   UCBFLB                                                   09266000
UCBQISCE EQU   UCBFL1                                                   09267000
UCBACTV  EQU   UCBFL1                                                   09268000
UCBSAP   EQU   UCBFL1                                                   09269000
UCBNOTRC EQU   UCBCUB                                                   09270000
UCBPSNS  EQU   UCBFL1                                                   09271000
UCBUSING EQU   UCBPST                                                   09272000
UCBNOTRD EQU   UCBNRY                                                   09273000
UCBBUSYD EQU   UCBBSY                                                   09274000
UCBUA    EQU   UCBCHAN+1                                                09275000
UCBCHA   EQU   UCBCHAN                                                  09276000
UCBDADI  EQU   UCBSTAT                                                  09277000
UCBPRES  EQU   UCBSTAT                                                  09278000
UCBUNLD  EQU   UCBSTAT                                                  09279000
UCBRESV  EQU   UCBSTAT                                                  09280000
UCBCHGS  EQU   UCBSTAT                                                  09281000
UCBID    EQU   UCBOB+2                                                  09282000
UCBALTPH EQU   UCBFL5                                                   09283000
UCBALTCU EQU   UCBFL5                                                   09284000
UCBENVRD EQU   UCBFL5                                                   09285000
UCBVSDR  EQU   UCBFL5                                                   09286000
UCBSASK  EQU   UCBFL5                                                   09287000
UCBAMV   EQU   UCBAF                                                    09288000
UCBDCC   EQU   UCBFL5                                                   09289000
UCBMONT  EQU   UCBJBNR                                                  09290000
UCBRV011 EQU   UCBJBNR                                                  09291000
UCBMMSGP EQU   UCBJBNR                                                  09292000
UCBOLDSM EQU   UCBJBNR                                                  09293000
UCBRV003 EQU   UCBJBNR                                                  09294000
UCBDUC   EQU   UCBJBNR                                                  09295000
UCBJES3  EQU   UCBJBNR                                                  09296000
UCBVRDEV EQU   UCBJBNR                                                  09297000
UCBCMSEG EQU   UCBOB                                                    09298000
UCBPFXND EQU   UCB+512                                                  09299000
UCBIOQ   EQU   UCB+508                                                  09300000
UCBLOCK  EQU   UCB+504                                                  09301000
UCBPXST  EQU   UCB+504                                                  09302000
@NM00174 EQU   UCB                                                      09303000
@NM00173 EQU   TCBXTNT2+32                                              09304000
TCBRV181 EQU   TCBRV173                                                 09305000
TCBRV180 EQU   TCBRV173                                                 09306000
TCBRV179 EQU   TCBRV173                                                 09307000
TCBRV178 EQU   TCBRV173                                                 09308000
TCBRV177 EQU   TCBRV173                                                 09309000
TCBRV176 EQU   TCBRV173                                                 09310000
TCBRV175 EQU   TCBRV173                                                 09311000
TCBRV174 EQU   TCBRV173                                                 09312000
TCBRV172 EQU   TCBRV164                                                 09313000
TCBRV171 EQU   TCBRV164                                                 09314000
TCBRV170 EQU   TCBRV164                                                 09315000
TCBRV169 EQU   TCBRV164                                                 09316000
TCBRV168 EQU   TCBRV164                                                 09317000
TCBRV167 EQU   TCBRV164                                                 09318000
TCBRV166 EQU   TCBRV164                                                 09319000
TCBRV165 EQU   TCBRV164                                                 09320000
TCBRV163 EQU   TCBRV155                                                 09321000
TCBRV162 EQU   TCBRV155                                                 09322000
TCBRV161 EQU   TCBRV155                                                 09323000
TCBRV160 EQU   TCBRV155                                                 09324000
TCBRV159 EQU   TCBRV155                                                 09325000
TCBRV158 EQU   TCBRV155                                                 09326000
TCBRV157 EQU   TCBRV155                                                 09327000
TCBRV156 EQU   TCBRV155                                                 09328000
TCBRV154 EQU   TCBRV146                                                 09329000
TCBRV153 EQU   TCBRV146                                                 09330000
TCBRV152 EQU   TCBRV146                                                 09331000
TCBRV151 EQU   TCBRV146                                                 09332000
TCBRV150 EQU   TCBRV146                                                 09333000
TCBRV149 EQU   TCBRV146                                                 09334000
TCBRV148 EQU   TCBRV146                                                 09335000
TCBRV147 EQU   TCBRV146                                                 09336000
TCBRV145 EQU   TCBXTNT2+26                                              09337000
TCBRV144 EQU   TCBXTNT2+24                                              09338000
TCBCAUF  EQU   TCBXTNT2+20                                              09339000
TCBRV142 EQU   TCBXTNT2+16                                              09340000
TCBRSV49 EQU   TCBXTNT2+12                                              09341000
TCBEVENT EQU   TCBXTNT2+8                                               09342000
TCBRCMP  EQU   TCBXTNT2+5                                               09343000
TCBRSVAB EQU   TCBXTNT2+4                                               09344000
TCBGTFA  EQU   TCBGTF+1                                                 09345000
TCBRSV47 EQU   TCBTFLG                                                  09346000
TCBRSV46 EQU   TCBTFLG                                                  09347000
TCBRSV45 EQU   TCBTFLG                                                  09348000
TCBRSV44 EQU   TCBTFLG                                                  09349000
TCBRSV43 EQU   TCBTFLG                                                  09350000
TCBDSPIT EQU   TCBTFLG                                                  09351000
TCBERRTN EQU   TCBTFLG                                                  09352000
TCBASYNC EQU   TCBTFLG                                                  09353000
@NM00172 EQU   TCB+296                                                  09354000
TCBSVCA2 EQU   TCB+292                                                  09355000
TCBSWASA EQU   TCB+288                                                  09356000
TCBDBTB  EQU   TCB+284                                                  09357000
TCBRPT   EQU   TCB+280                                                  09358000
TCBRV141 EQU   TCBRV133                                                 09359000
TCBRV140 EQU   TCBRV133                                                 09360000
TCBRV139 EQU   TCBRV133                                                 09361000
TCBRV138 EQU   TCBRV133                                                 09362000
TCBRV137 EQU   TCBRV133                                                 09363000
TCBRV136 EQU   TCBRV133                                                 09364000
TCBRV135 EQU   TCBRV133                                                 09365000
TCBRV134 EQU   TCBRV133                                                 09366000
TCBRV132 EQU   TCBRV124                                                 09367000
TCBRV131 EQU   TCBRV124                                                 09368000
TCBRV130 EQU   TCBRV124                                                 09369000
TCBRV129 EQU   TCBRV124                                                 09370000
TCBRV128 EQU   TCBRV124                                                 09371000
TCBRV127 EQU   TCBRV124                                                 09372000
TCBRV126 EQU   TCBRV124                                                 09373000
TCBRV125 EQU   TCBRV124                                                 09374000
TCBRV123 EQU   TCBFBYT2                                                 09375000
TCBRV122 EQU   TCBFBYT2                                                 09376000
TCBECBNV EQU   TCBFBYT2                                                 09377000
TCBSSSYN EQU   TCBFBYT2                                                 09378000
TCBFPRAP EQU   TCBFBYT2                                                 09379000
TCBFDW   EQU   TCBFBYT2                                                 09380000
TCBFMW   EQU   TCBFBYT2                                                 09381000
TCBCNCB  EQU   TCBFBYT2                                                 09382000
TCBLLH   EQU   TCBFBYT1                                                 09383000
TCBRV113 EQU   TCBFBYT1                                                 09384000
TCBEOT   EQU   TCBFBYT1                                                 09385000
TCBRTM2  EQU   TCBFBYT1                                                 09386000
TCBPGNLY EQU   TCBFBYT1                                                 09387000
TCBNDIOS EQU   TCBFBYT1                                                 09388000
TCBRV327 EQU   TCBFBYT1                                                 09389000
TCBEOTFM EQU   TCBFBYT1                                                 09390000
TCBAFFN  EQU   TCB+274                                                  09391000
TCBRV326 EQU   TCB+272                                                  09392000
TCBUKYSP EQU   TCB+268                                                  09393000
TCBMODE  EQU   TCBESTAE+3                                               09394000
TCBERTYP EQU   TCBESTAE+2                                               09395000
TCBRV314 EQU   TCBESTRM                                                 09396000
TCBRV313 EQU   TCBESTRM                                                 09397000
TCBRV312 EQU   TCBESTRM                                                 09398000
TCBRV311 EQU   TCBESTRM                                                 09399000
TCBRV310 EQU   TCBESTRM                                                 09400000
TCBRV309 EQU   TCBESTRM                                                 09401000
TCBRV308 EQU   TCBESTRM                                                 09402000
TCBETERM EQU   TCBESTRM                                                 09403000
TCBSCBKY EQU   TCBESTAE                                                 09404000
TCBRTM12 EQU   TCB+260                                                  09405000
TCBTCBID EQU   TCB+256                                                  09406000
TCBSTAFX EQU   TCBSTAWA                                                 09407000
TCBSWA   EQU   TCB+248                                                  09408000
TCBFOEA  EQU   TCBFOE+1                                                 09409000
TCBRSV42 EQU   TCBFOE                                                   09410000
TCBCCPVI EQU   TCBXSCT+2                                                09411000
TCBRV325 EQU   TCBXSCT+1                                                09412000
TCBRV324 EQU   TCBXSCT1                                                 09413000
TCBRV323 EQU   TCBXSCT1                                                 09414000
TCBRV322 EQU   TCBXSCT1                                                 09415000
TCBRV321 EQU   TCBXSCT1                                                 09416000
TCBRV320 EQU   TCBXSCT1                                                 09417000
TCBRV319 EQU   TCBXSCT1                                                 09418000
TCBS3A   EQU   TCBXSCT1                                                 09419000
TCBACTIV EQU   TCBXSCT1                                                 09420000
TCBRSV41 EQU   TCB+239                                                  09421000
TCBTID   EQU   TCB+238                                                  09422000
TCBRSVAA EQU   TCB+237                                                  09423000
TCBABCUR EQU   TCB+236                                                  09424000
TCBTMSAV EQU   TCB+232                                                  09425000
TCBIOTIM EQU   TCB+228                                                  09426000
TCBRTWA  EQU   TCB+224                                                  09427000
TCBBACK  EQU   TCB+220                                                  09428000
TCBTIRB  EQU   TCB+216                                                  09429000
TCBAECB  EQU   TCB+212                                                  09430000
TCBEXT2A EQU   TCBEXT2+1                                                09431000
TCBRSV39 EQU   TCBEXT2                                                  09432000
TCBSTMCT EQU   TCB+207                                                  09433000
TCBSYSCT EQU   TCB+206                                                  09434000
TCBRSV37 EQU   TCB+205                                                  09435000
TCBEXSVC EQU   TCBDAR                                                   09436000
TCBDARMS EQU   TCBDAR                                                   09437000
TCBDARWT EQU   TCBDAR                                                   09438000
TCBDARO  EQU   TCBDAR                                                   09439000
TCBDARMC EQU   TCBDARC                                                  09440000
TCBDARD  EQU   TCBDAR                                                   09441000
TCBDARS  EQU   TCBDAR                                                   09442000
TCBDARP  EQU   TCBDAR                                                   09443000
TCBGTOFM EQU   TCBFLGS7                                                 09444000
TCBADMP  EQU   TCBFLGS7                                                 09445000
TCBRSTSK EQU   TCBFLGS7                                                 09446000
TCBSVCS  EQU   TCBFLGS7                                                 09447000
TCBSTACK EQU   TCBFLGS7                                                 09448000
TCBRSV34 EQU   TCBFLGS7                                                 09449000
TCBRSV33 EQU   TCBFLGS7                                                 09450000
TCBGPECB EQU   TCBFLGS7                                                 09451000
TCBNTJS  EQU   TCBFLGS6                                                 09452000
TCBAPG   EQU   TCBFLGS6                                                 09453000
TCBMIGR  EQU   TCBFLGS6                                                 09454000
TCBRV303 EQU   TCBFLGS6                                                 09455000
TCBSPVLK EQU   TCBFLGS6                                                 09456000
TCBCPU   EQU   TCBFLGS6                                                 09457000
TCBPIE17 EQU   TCBFLGS6                                                 09458000
TCBRV    EQU   TCBFLGS6                                                 09459000
TCBRSV79 EQU   TCBNDSP5                                                 09460000
TCBRSV78 EQU   TCBNDSP5                                                 09461000
TCBRSV77 EQU   TCBNDSP5                                                 09462000
TCBRSV76 EQU   TCBNDSP5                                                 09463000
TCBRSV75 EQU   TCBNDSP5                                                 09464000
TCBRSV74 EQU   TCBNDSP5                                                 09465000
TCBRSV95 EQU   TCBNDSP5                                                 09466000
TCBRSV94 EQU   TCBNDSP5                                                 09467000
TCBRSV93 EQU   TCBNDSP4                                                 09468000
TCBRSV92 EQU   TCBNDSP4                                                 09469000
TCBRSV91 EQU   TCBNDSP4                                                 09470000
TCBRSV90 EQU   TCBNDSP4                                                 09471000
TCBRSV89 EQU   TCBNDSP4                                                 09472000
TCBRSV88 EQU   TCBNDSP4                                                 09473000
TCBRSV87 EQU   TCBNDSP4                                                 09474000
TCBRSV86 EQU   TCBNDSP4                                                 09475000
TCBEXT1A EQU   TCBEXT1+1                                                09476000
TCBRSV32 EQU   TCBEXT1                                                  09477000
TCBEXCPD EQU   TCB+192                                                  09478000
TCBIOBRC EQU   TCB+188                                                  09479000
TCBDDWTC EQU   TCB+186                                                  09480000
TCBDDEXC EQU   TCB+184                                                  09481000
TCBJSCBB EQU   TCBJSCB+1                                                09482000
@NM00171 EQU   TCBRECDE                                                 09483000
TCBREC   EQU   TCBRECDE                                                 09484000
TCBMDIDS EQU   TCB+176                                                  09485000
TCBNDINT EQU   TCBNDSP3                                                 09486000
TCBRSV27 EQU   TCBNDSP3                                                 09487000
TCBRSV26 EQU   TCBNDSP3                                                 09488000
TCBRSV25 EQU   TCBNDSP3                                                 09489000
TCBRSV24 EQU   TCBNDSP3                                                 09490000
TCBSRBND EQU   TCBNDSP3                                                 09491000
TCBRV302 EQU   TCBNDSP3                                                 09492000
TCBLJSND EQU   TCBNDSP3                                                 09493000
TCBABE   EQU   TCBNDSP2                                                 09494000
TCBDSS   EQU   TCBNDSP2                                                 09495000
TCBOWAIT EQU   TCBNDSP2                                                 09496000
TCBIWAIT EQU   TCBNDSP2                                                 09497000
TCBNDTS  EQU   TCBNDSP2                                                 09498000
TCBNDSVC EQU   TCBNDSP2                                                 09499000
TCBSTPP  EQU   TCBNDSP2                                                 09500000
TCBABD   EQU   TCBNDSP2                                                 09501000
TCBRSV22 EQU   TCBNDSP1                                                 09502000
TCBPIEND EQU   TCBNDSP1                                                 09503000
TCBTPSP  EQU   TCBNDSP1                                                 09504000
TCBDDRND EQU   TCBNDSP1                                                 09505000
TCBRSPND EQU   TCBNDSP1                                                 09506000
TCBRSTND EQU   TCBNDSP1                                                 09507000
TCBDARPN EQU   TCBNDSP1                                                 09508000
TCBDARTN EQU   TCBNDSP1                                                 09509000
TCBNDSP0 EQU   TCBNDSP                                                  09510000
TCBUSER  EQU   TCB+168                                                  09511000
TCBTCTB  EQU   TCBTCT+1                                                 09512000
TCBRSV9C EQU   TCBTCTGF                                                 09513000
TCBRSV9B EQU   TCBTCTGF                                                 09514000
TCBRSV9A EQU   TCBTCTGF                                                 09515000
TCBRSV99 EQU   TCBTCTGF                                                 09516000
TCBRSV98 EQU   TCBTCTGF                                                 09517000
TCBRSV97 EQU   TCBTCTGF                                                 09518000
TCBRSV20 EQU   TCBTCTGF                                                 09519000
TCBSMFGF EQU   TCBTCTGF                                                 09520000
TCBSTABB EQU   TCBSTAB+1                                                09521000
TCBSTCUR EQU   TCBNSTAE                                                 09522000
TCBRV301 EQU   TCBNSTAE                                                 09523000
TCBSYNCH EQU   TCBNSTAE                                                 09524000
TCBHALT  EQU   TCBNSTAE                                                 09525000
TCBPPSUP EQU   TCBNSTAE                                                 09526000
TCB33E   EQU   TCBNSTAE                                                 09527000
TCBQUIES EQU   TCBNSTAE                                                 09528000
TCBSTABE EQU   TCBNSTAE                                                 09529000
TCBAQE   EQU   TCB+156                                                  09530000
TCBPQE   EQU   TCB+152                                                  09531000
TCBTSDP  EQU   TCB+151                                                  09532000
TCBTSLP  EQU   TCB+150                                                  09533000
TCBSTPCT EQU   TCB+149                                                  09534000
TCBCPUBN EQU   TCBTSFLG                                                 09535000
TCBDYDSP EQU   TCBTSFLG                                                 09536000
TCBRSV18 EQU   TCBTSFLG                                                 09537000
TCBRSV17 EQU   TCBTSFLG                                                 09538000
TCBTIOTG EQU   TCBTSFLG                                                 09539000
TCBATT   EQU   TCBTSFLG                                                 09540000
TCBSTPPR EQU   TCBTSFLG                                                 09541000
TCBRV300 EQU   TCBTSTSK                                                 09542000
TCBECB   EQU   TCB+144                                                  09543000
TCBIQE   EQU   TCB+140                                                  09544000
TCBLTC   EQU   TCB+136                                                  09545000
TCBOTC   EQU   TCB+132                                                  09546000
TCBNTC   EQU   TCB+128                                                  09547000
TCBJSTCA EQU   TCBJSTCB+1                                               09548000
TCBRSV16 EQU   TCBJSTCB                                                 09549000
TCBTQET  EQU   TCBTME                                                   09550000
TCBTCB   EQU   TCB+116                                                  09551000
TCBFSAB  EQU   TCBFSA+1                                                 09552000
TCBQEL   EQU   TCBFSA                                                   09553000
TCBGRS15 EQU   TCBGRS+60                                                09554000
TCBGRS14 EQU   TCBGRS+56                                                09555000
TCBGRS13 EQU   TCBGRS+52                                                09556000
TCBGRS12 EQU   TCBGRS+48                                                09557000
TCBGRS11 EQU   TCBGRS+44                                                09558000
TCBGRS10 EQU   TCBGRS+40                                                09559000
TCBGRS9  EQU   TCBGRS+36                                                09560000
TCBGRS8  EQU   TCBGRS+32                                                09561000
TCBGRS7  EQU   TCBGRS+28                                                09562000
TCBGRS6  EQU   TCBGRS+24                                                09563000
TCBGRS5  EQU   TCBGRS+20                                                09564000
TCBGRS4  EQU   TCBGRS+16                                                09565000
TCBGRS3  EQU   TCBGRS+12                                                09566000
TCBGRS2  EQU   TCBGRS+8                                                 09567000
TCBGRS1  EQU   TCBGRS+4                                                 09568000
TCBGRS0  EQU   TCBGRS                                                   09569000
TCBJPQB  EQU   TCBJPQ+1                                                 09570000
TCBRSV15 EQU   TCBPURGE                                                 09571000
TCBRSV14 EQU   TCBPURGE                                                 09572000
TCBRSV13 EQU   TCBPURGE                                                 09573000
TCBRSV12 EQU   TCBPURGE                                                 09574000
TCBRSV11 EQU   TCBPURGE                                                 09575000
TCBRSV10 EQU   TCBPURGE                                                 09576000
TCBRSV09 EQU   TCBPURGE                                                 09577000
TCBJPQF  EQU   TCBPURGE                                                 09578000
TCBJLB   EQU   TCB+40                                                   09579000
TCBLLS   EQU   TCB+36                                                   09580000
TCBDSP   EQU   TCB+35                                                   09581000
TCBLMP   EQU   TCB+34                                                   09582000
TCBPNDSP EQU   TCBFLGS5                                                 09583000
TCBFCD1  EQU   TCBFLGS5                                                 09584000
TCBSTP   EQU   TCBFLGS5                                                 09585000
TCBSYS   EQU   TCBFLGS5                                                 09586000
TCBANDSP EQU   TCBFLGS5                                                 09587000
TCBPAGE  EQU   TCBFLGS5                                                 09588000
TCBUXNDF EQU   TCBABWF                                                  09589000
TCBFC    EQU   TCBFLGS5                                                 09590000
TCBONDSP EQU   TCBFLGS4                                                 09591000
TCBMPCND EQU   TCBFLGS4                                                 09592000
TCBMPCVQ EQU   TCBFLGS4                                                 09593000
TCBUXNDV EQU   TCBFLGS4                                                 09594000
TCBHNDSP EQU   TCBFLGS4                                                 09595000
TCBRQENA EQU   TCBFLGS4                                                 09596000
TCBSER   EQU   TCBFLGS4                                                 09597000
TCBNDUMP EQU   TCBFLGS4                                                 09598000
TCBDWSTA EQU   TCBFLGS3                                                 09599000
TCBRSV08 EQU   TCBFLGS3                                                 09600000
TCBRSV07 EQU   TCBFLGS3                                                 09601000
TCBRSV06 EQU   TCBFLGS3                                                 09602000
TCBABGM  EQU   TCBFLGS3                                                 09603000
TCBABTRM EQU   TCBFLGS3                                                 09604000
TCBADINP EQU   TCBFLGS3                                                 09605000
TCBFSM   EQU   TCBFLGS3                                                 09606000
TCBFTS   EQU   TCBFLGS2                                                 09607000
TCBFETXR EQU   TCBFLGS2                                                 09608000
TCBFDSOP EQU   TCBFLGS2                                                 09609000
TCBFJMC  EQU   TCBFLGS2                                                 09610000
TCBFSMC  EQU   TCBFLGS2                                                 09611000
TCBFABOP EQU   TCBFLGS2                                                 09612000
TCBFSTI  EQU   TCBFLGS2                                                 09613000
TCBFOINP EQU   TCBFLGS2                                                 09614000
TCBFX    EQU   TCBFLGS1                                                 09615000
TCBFS    EQU   TCBFLGS1                                                 09616000
TCBFT    EQU   TCBFLGS1                                                 09617000
TCBPDUMP EQU   TCBFLGS1                                                 09618000
TCBNONPR EQU   TCBFLGS1                                                 09619000
TCBFERA  EQU   TCBFLGS1                                                 09620000
TCBFE    EQU   TCBFLGS1                                                 09621000
TCBFA    EQU   TCBFLGS1                                                 09622000
TCBZERO  EQU   TCBPKF                                                   09623000
TCBFLAG  EQU   TCBPKF                                                   09624000
TCBMSSB  EQU   TCBMSS+1                                                 09625000
TCBRSV03 EQU   TCBMSS                                                   09626000
TCBTRNB  EQU   TCBTRN+1                                                 09627000
TCBRSV02 EQU   TCBABF                                                   09628000
TCBOLTEP EQU   TCBABF                                                   09629000
TCBTCP   EQU   TCBABF                                                   09630000
TCBTCPP  EQU   TCBABF                                                   09631000
TCBRSV01 EQU   TCBABF                                                   09632000
TCBGRPH  EQU   TCBABF                                                   09633000
TCBNOCHK EQU   TCBABF                                                   09634000
TCBMOD91 EQU   TCBABF                                                   09635000
TCBCMPC  EQU   TCBCMP+1                                                 09636000
TCBRV318 EQU   TCBCMSG                                                  09637000
TCBRV317 EQU   TCBCIND                                                  09638000
TCBRV316 EQU   TCBCWTO                                                  09639000
TCBCASID EQU   TCBCDBL                                                  09640000
TCBNOCC  EQU   TCBSTCC                                                  09641000
TCBDMPO  EQU   TCBCPP                                                   09642000
TCBCSTEP EQU   TCBCMPF                                                  09643000
TCBCREQ  EQU   TCBCMPF                                                  09644000
TCBTIO   EQU   TCB+12                                                   09645000
TCBDEB   EQU   TCB+8                                                    09646000
TCBPIEA  EQU   TCBPIE+1                                                 09647000
TCBPM    EQU   TCBPMASK                                                 09648000
@NM00170 EQU   TCBPMASK                                                 09649000
TCBFRS6  EQU   TCBFRS+24                                                09650000
TCBFRS4  EQU   TCBFRS+16                                                09651000
TCBFRS2  EQU   TCBFRS+8                                                 09652000
TCBFRS0  EQU   TCBFRS                                                   09653000
@NM00169 EQU   SCVTSECT+180                                             09654000
@NM00168 EQU   SCVTSECT+176                                             09655000
SCVTPIQE EQU   SCVTSECT+172                                             09656000
@NM00167 EQU   SCVTSECT+168                                             09657000
SCVTPTRM EQU   SCVTSECT+164                                             09658000
@NM00166 EQU   SCVTSECT+160                                             09659000
@NM00165 EQU   SCVTSECT+156                                             09660000
SCVTQCBR EQU   SCVTSECT+152                                             09661000
SCVTSTAT EQU   SCVTSECT+148                                             09662000
@NM00164 EQU   SCVTSECT+144                                             09663000
SCVTTQE  EQU   SCVTSECT+140                                             09664000
@NM00163 EQU   SCVTSECT+136                                             09665000
SCVTSVCT EQU   SCVTSECT+132                                             09666000
@NM00162 EQU   SCVTSECT+128                                             09667000
@NM00161 EQU   SCVTSECT+124                                             09668000
SCVTRXLQ EQU   SCVTSECT+120                                             09669000
@NM00160 EQU   SCVTSECT+116                                             09670000
@NM00159 EQU   SCVTSECT+108                                             09671000
@NM00158 EQU   SCVTSECT+104                                             09672000
@NM00157 EQU   SCVTSECT+100                                             09673000
@NM00156 EQU   SCVTSECT+96                                              09674000
SCVTCOMM EQU   SCVTSECT+92                                              09675000
@NM00155 EQU   SCVTSECT+88                                              09676000
@NM00154 EQU   SCVTSECT+84                                              09677000
@NM00153 EQU   SCVTSECT+80                                              09678000
@NM00152 EQU   SCVTSECT+76                                              09679000
@NM00151 EQU   SCVTSECT+72                                              09680000
SCVTGMBR EQU   SCVTSECT+68                                              09681000
SCVTRPTR EQU   SCVTSECT+64                                              09682000
SCVTHSKP EQU   SCVTSECT+60                                              09683000
@NM00150 EQU   SCVTSECT+56                                              09684000
@NM00149 EQU   SCVTSECT+52                                              09685000
SCVTLFRM EQU   SCVTSECT+48                                              09686000
SCVTCDCL EQU   SCVTSECT+44                                              09687000
@NM00148 EQU   SCVTSECT+40                                              09688000
SCVTRACE EQU   SCVTSECT+36                                              09689000
@NM00147 EQU   SCVTSECT+32                                              09690000
SCVTRMBR EQU   SCVTSECT+28                                              09691000
@NM00146 EQU   SCVTSECT+24                                              09692000
@NM00145 EQU   SCVTSECT+20                                              09693000
@NM00144 EQU   SCVTSECT+16                                              09694000
@NM00143 EQU   SCVTSECT+14                                              09695000
SCVTBR14 EQU   SCVTSECT+12                                              09696000
SCVTSPET EQU   SCVTSECT+8                                               09697000
SCVTPGWR EQU   SCVTSECT+4                                               09698000
SCVTPGTM EQU   SCVTSECT                                                 09699000
SVRBEND  EQU   RBSECT+192                                               09700000
RBFEPARM EQU   RBSECT+168                                               09701000
SIRBEND  EQU   RBSECT+168                                               09702000
RBRSV158 EQU   RBRSV150                                                 09703000
RBRSV157 EQU   RBRSV150                                                 09704000
RBRSV156 EQU   RBRSV150                                                 09705000
RBRSV155 EQU   RBRSV150                                                 09706000
RBRSV154 EQU   RBRSV150                                                 09707000
RBRSV153 EQU   RBRSV150                                                 09708000
RBRSV152 EQU   RBRSV150                                                 09709000
RBRSV151 EQU   RBRSV150                                                 09710000
RBRSV149 EQU   RBSECT+166                                               09711000
RBRSV148 EQU   RBSECT+164                                               09712000
RBRSV169 EQU   RBSDATA+3                                                09713000
RBSID    EQU   RBSDATA+2                                                09714000
RBSPKEY  EQU   RBSDATA+1                                                09715000
RBRSV168 EQU   RBSFLG3                                                  09716000
RBSTERMO EQU   RBSFLG3                                                  09717000
RBSBRNTR EQU   RBSFLG3                                                  09718000
RBSPRNTR EQU   RBSFLG3                                                  09719000
RBSCNCEL EQU   RBSFLG3                                                  09720000
RBSRECRD EQU   RBSFLG3                                                  09721000
RBSTERMI EQU   RBSFLG3                                                  09722000
RBRSV167 EQU   RBSFLG3                                                  09723000
RBSOWNRA EQU   RBSOWNR+1                                                09724000
RBSSUPER EQU   RBSFLGS2                                                 09725000
RBSKEY0  EQU   RBSFLGS2                                                 09726000
RBRSV166 EQU   RBSFLGS2                                                 09727000
RBRSV165 EQU   RBSFLGS2                                                 09728000
RBSINUSE EQU   RBSFLGS2                                                 09729000
RBRSV164 EQU   RBSFLGS2                                                 09730000
RBSXCTL2 EQU   RBSFLGS2                                                 09731000
RBRSV163 EQU   RBSFLGS2                                                 09732000
RBSPARMA EQU   RBSPARM+1                                                09733000
RBSHALT  EQU   RBSIOPRC                                                 09734000
RBSNOIOP EQU   RBSIOPRC                                                 09735000
RBSASYNC EQU   RBSFLGS1                                                 09736000
RBRSV162 EQU   RBSFLGS1                                                 09737000
RBSESTAE EQU   RBSFLGS1                                                 09738000
RBSDUMMY EQU   RBSFLGS1                                                 09739000
RBSSTAR  EQU   RBSFLGS1                                                 09740000
RBSSTAI  EQU   RBSFLGS1                                                 09741000
RBSEXIT  EQU   RBSCBB+4                                                 09742000
RBSCHAIN EQU   RBSCBB                                                   09743000
TIRBEND  EQU   @NM00141+8                                               09744000
PRBEND   EQU   @NM00141+8                                               09745000
RBRSV146 EQU   RBRSV138                                                 09746000
RBRSV145 EQU   RBRSV138                                                 09747000
RBRSV144 EQU   RBRSV138                                                 09748000
RBRSV143 EQU   RBRSV138                                                 09749000
RBRSV142 EQU   RBRSV138                                                 09750000
RBRSV141 EQU   RBRSV138                                                 09751000
RBRSV140 EQU   RBRSV138                                                 09752000
RBRSV139 EQU   RBRSV138                                                 09753000
RBRSV137 EQU   @NM00141+6                                               09754000
RBRSV136 EQU   @NM00141+4                                               09755000
RBRSV135 EQU   @NM00141                                                 09756000
@NM00140 EQU   RBSECT+32                                                09757000
@NM00139 EQU   @NM00137+1                                               09758000
RBSCF    EQU   @NM00138                                                 09759000
RBPGMQ1  EQU   RBPGMQ+1                                                 09760000
@NM00136 EQU   RBPGMQ                                                   09761000
@NM00135 EQU   RBSECT+16                                                09762000
@NM00134 EQU   @NM00130                                                 09763000
@NM00133 EQU   @NM00130                                                 09764000
RBIQETP  EQU   @NM00130                                                 09765000
RBUSIQE  EQU   RBETXR                                                   09766000
RBATTN   EQU   @NM00130                                                 09767000
@NM00132 EQU   @NM00130                                                 09768000
@NM00131 EQU   @NM00130                                                 09769000
RBPMSVRB EQU   @NM00128                                                 09770000
RBATNXIT EQU   @NM00128                                                 09771000
@NM00129 EQU   @NM00128                                                 09772000
RBWAITP  EQU   @NM00128                                                 09773000
RBFNSVRB EQU   RBTRSVRB                                                 09774000
RBFTP    EQU   @NM00128                                                 09775000
RBSIZE   EQU   RBSECT+8                                                 09776000
RBABOPSW EQU   RBSECT+4                                                 09777000
RBPPSAV1 EQU   RBPPSAV+1                                                09778000
@NM00126 EQU   RBPPSAV                                                  09779000
RBPRFXND EQU   RBPREFIX+64                                              09780000
RBINTCOD EQU   RBINTCDA+1                                               09781000
RBINLNTH EQU   RBINTCDA                                                 09782000
RBWCSA   EQU   RBPREFIX+60                                              09783000
RBRSV004 EQU   RBPREFIX+57                                              09784000
RBSSSYN  EQU   RBFLAGS1                                                 09785000
RBSCB    EQU   RBFLAGS1                                                 09786000
RBLONGWT EQU   RBFLAGS1                                                 09787000
RBASIR   EQU   RBFLAGS1                                                 09788000
RBRSV159 EQU   RBFLAGS1                                                 09789000
RBABEND  EQU   RBFLAGS1                                                 09790000
RBXWAIT  EQU   RBFLAGS1                                                 09791000
RBSLOCK  EQU   RBFLAGS1                                                 09792000
RBRTRAN  EQU   RBRTPSW2+4                                               09793000
RBRTINCD EQU   RBRTICIL+2                                               09794000
RBRTILC  EQU   RBRTICIL+1                                               09795000
RBRSV160 EQU   RBRTICIL                                                 09796000
RBRTPSW1 EQU   RBRTOPSW                                                 09797000
RBRSV062 EQU   RBRSV054                                                 09798000
RBRSV061 EQU   RBRSV054                                                 09799000
RBRSV060 EQU   RBRSV054                                                 09800000
RBRSV059 EQU   RBRSV054                                                 09801000
RBRSV058 EQU   RBRSV054                                                 09802000
RBRSV057 EQU   RBRSV054                                                 09803000
RBRSV056 EQU   RBRSV054                                                 09804000
RBRSV055 EQU   RBRSV054                                                 09805000
RBRSV053 EQU   RBPREFIX+38                                              09806000
RBRSV052 EQU   RBPREFIX+36                                              09807000
RBRSV051 EQU   RBPREFIX+32                                              09808000
RBPRFXST EQU   RBPREFIX+32                                              09809000
RBRSV050 EQU   RBPREFIX+28                                              09810000
RBRSV049 EQU   RBRSV041                                                 09811000
RBRSV048 EQU   RBRSV041                                                 09812000
RBRSV047 EQU   RBRSV041                                                 09813000
RBRSV046 EQU   RBRSV041                                                 09814000
RBRSV045 EQU   RBRSV041                                                 09815000
RBRSV044 EQU   RBRSV041                                                 09816000
RBRSV043 EQU   RBRSV041                                                 09817000
RBRSV042 EQU   RBRSV041                                                 09818000
RBRSV040 EQU   RBPREFIX+26                                              09819000
RBRSV039 EQU   RBPREFIX+24                                              09820000
RBRSV038 EQU   RBPREFIX+20                                              09821000
RBRSV037 EQU   RBPREFIX+16                                              09822000
RBRSV036 EQU   RBRSV028                                                 09823000
RBRSV035 EQU   RBRSV028                                                 09824000
RBRSV034 EQU   RBRSV028                                                 09825000
RBRSV033 EQU   RBRSV028                                                 09826000
RBRSV032 EQU   RBRSV028                                                 09827000
RBRSV031 EQU   RBRSV028                                                 09828000
RBRSV030 EQU   RBRSV028                                                 09829000
RBRSV029 EQU   RBRSV028                                                 09830000
RBRSV027 EQU   RBRSV019                                                 09831000
RBRSV026 EQU   RBRSV019                                                 09832000
RBRSV025 EQU   RBRSV019                                                 09833000
RBRSV024 EQU   RBRSV019                                                 09834000
RBRSV023 EQU   RBRSV019                                                 09835000
RBRSV022 EQU   RBRSV019                                                 09836000
RBRSV021 EQU   RBRSV019                                                 09837000
RBRSV020 EQU   RBRSV019                                                 09838000
RBRSV018 EQU   RBPREFIX+13                                              09839000
RBRSV017 EQU   RBPREFIX+12                                              09840000
RBSRV016 EQU   RBPREFIX+11                                              09841000
RBRSV015 EQU   RBPREFIX+10                                              09842000
RBRSV014 EQU   RBPREFIX+8                                               09843000
RBRSV013 EQU   RBPREFIX+4                                               09844000
RBRSV012 EQU   RBPREFIX                                                 09845000
RBEXSAVE EQU   XRBESA                                                   09846000
XRBREG15 EQU   RBGRS15                                                  09847000
XRBREG14 EQU   RBGRS14                                                  09848000
XRBREG13 EQU   RBGRS13                                                  09849000
XRBREG12 EQU   RBGRS12                                                  09850000
XRBREG11 EQU   RBGRS11                                                  09851000
XRBREG10 EQU   RBGRS10                                                  09852000
XRBREG9  EQU   RBGRS9                                                   09853000
XRBREG8  EQU   RBGRS8                                                   09854000
XRBREG7  EQU   RBGRS7                                                   09855000
XRBREG6  EQU   RBGRS6                                                   09856000
XRBREG5  EQU   RBGRS5                                                   09857000
XRBREG4  EQU   RBGRS4                                                   09858000
XRBREG3  EQU   RBGRS3                                                   09859000
XRBREG2  EQU   RBGRS2                                                   09860000
XRBREG1  EQU   RBGRS1                                                   09861000
XRBREG0  EQU   RBGRS0                                                   09862000
XRBLNKA  EQU   RBLINKB                                                  09863000
XRBWT    EQU   RBWCF                                                    09864000
@NM00125 EQU   RBBASIC+24                                               09865000
RBOPSWPS EQU   RBOPSWB2                                                 09866000
@NM00124 EQU   RBOPSWB2                                                 09867000
@NM00123 EQU   XRBPSW                                                   09868000
@NM00122 EQU   RBBASIC+12                                               09869000
XRBWAIT  EQU   RBECBWT                                                  09870000
XRBFRRB  EQU   RBFDYN                                                   09871000
@NM00121 EQU   XSTAB2                                                   09872000
XRBACTV  EQU   RBFACTV                                                  09873000
XRBTCBP  EQU   RBTCBNXT                                                 09874000
@NM00120 EQU   XSTAB1                                                   09875000
XRBCKPT  EQU   RBFTCKPT                                                 09876000
@NM00119 EQU   XSTAB1                                                   09877000
@NM00118 EQU   RBBASIC+8                                                09878000
@NM00117 EQU   RBEXRTNM+1                                               09879000
RBTMIND3 EQU   RBTMFLD                                                  09880000
RBTMIND2 EQU   RBTMFLD                                                  09881000
RBTMCMP  EQU   RBTMFLD                                                  09882000
RBWLIM   EQU   RBTMFLD                                                  09883000
RBRSV005 EQU   RBTMFLD                                                  09884000
RBTMTOD  EQU   RBTMFLD                                                  09885000
RBTMQUE  EQU   RBTMFLD                                                  09886000
@NM00116 EQU   RBPRFX                                                   09887000
OREOPBUF EQU   OREF+28                                                  09888000
ORERSV11 EQU   OREF+26                                                  09889000
OREASID  EQU   OREF+24                                                  09890000
OREM     EQU   OREF+24                                                  09891000
OREECBA  EQU   OREECB+1                                                 09892000
ORETJID2 EQU   OREECB                                                   09893000
ORERPYA  EQU   ORERPY+1                                                 09894000
ORELNTH  EQU   ORERPY                                                   09895000
ORETCBA  EQU   ORETCB+1                                                 09896000
ORETJID1 EQU   ORETCB                                                   09897000
ORERSV10 EQU   OREXC                                                    09898000
ORERSV09 EQU   OREXC                                                    09899000
ORERSV08 EQU   OREXC                                                    09900000
OREBUFE  EQU   OREXC                                                    09901000
OREBUFD  EQU   OREXC                                                    09902000
OREBUFB  EQU   OREXC                                                    09903000
OREBUFA  EQU   OREXC                                                    09904000
ORERSV06 EQU   OREXA                                                    09905000
ORERSV05 EQU   OREXA                                                    09906000
ORERSV04 EQU   OREXA                                                    09907000
ORERSV03 EQU   OREXA                                                    09908000
ORESUSP  EQU   OREXA                                                    09909000
ORESWAP  EQU   OREXA                                                    09910000
OREKEY0  EQU   OREXA                                                    09911000
ORERSV01 EQU   OREXA                                                    09912000
OREID    EQU   OREF+4                                                   09913000
MPLRSV10 EQU   MPL+6                                                    09914000
MPLTYPE2 EQU   MPLTYPE+1                                                09915000
MPLRSV09 EQU   MPLTYPE1                                                 09916000
MPLRSV08 EQU   MPLTYPE1                                                 09917000
MPLSESS  EQU   MPLTYPE1                                                 09918000
MPLRSV07 EQU   MPLTYPE1                                                 09919000
MPLRSV06 EQU   MPLTYPE1                                                 09920000
MPLRSV05 EQU   MPLTYPE1                                                 09921000
MPLSTAT  EQU   MPLTYPE1                                                 09922000
MPLJBNM  EQU   MPLTYPE1                                                 09923000
MPLPROC2 EQU   MPLPROC+1                                                09924000
MPLRSV04 EQU   MPLPROC1                                                 09925000
MPLRSV03 EQU   MPLPROC1                                                 09926000
MPLRSV02 EQU   MPLPROC1                                                 09927000
MPLRSV01 EQU   MPLPROC1                                                 09928000
MPLSTRT  EQU   MPLPROC1                                                 09929000
MPLTERM  EQU   MPLPROC1                                                 09930000
@NM00089 EQU   FRRSFLGS+1                                               09931000
@NM00088 EQU   FRRSFLG1                                                 09932000
FRRSNEST EQU   FRRSFLG1                                                 09933000
FRRSRCUR EQU   FRRSFLG1                                                 09934000
FRRSENTS EQU   FRRS+84                                                  09935000
FRRSRTMW EQU   FRRS+16                                                  09936000
DCMACBND EQU   DCMACB+40                                                09937000
DCMAPAD  EQU   DCMACLR+27                                               09938000
DCMATECB EQU   DCMACLR+23                                               09939000
DCMAUTME EQU   DCMATFLG+2                                               09940000
@NM00087 EQU   DCMATRCK                                                 09941000
@NM00086 EQU   DCMATRCK                                                 09942000
DCMATTSL EQU   DCMATRCK                                                 09943000
DCMATTS  EQU   DCMATRCK                                                 09944000
@NM00085 EQU   DCMATRCK                                                 09945000
@NM00084 EQU   DCMATRCK                                                 09946000
DCMATJBL EQU   DCMATRCK                                                 09947000
DCMATJOB EQU   DCMATRCK                                                 09948000
@NM00083 EQU   DCMADFLG                                                 09949000
@NM00082 EQU   DCMADFLG                                                 09950000
@NM00081 EQU   DCMADFLG                                                 09951000
@NM00080 EQU   DCMADFLG                                                 09952000
@NM00079 EQU   DCMADFLG                                                 09953000
DCMACSIB EQU   DCMADFLG                                                 09954000
DCMAHOLD EQU   DCMADFLG                                                 09955000
DCMADD   EQU   DCMADFLG                                                 09956000
@NM00078 EQU   DCMAFLG2                                                 09957000
@NM00077 EQU   DCMAFLG2                                                 09958000
@NM00076 EQU   DCMAFLG2                                                 09959000
@NM00075 EQU   DCMAFLG2                                                 09960000
DCMAMJFR EQU   DCMAFLG2                                                 09961000
DCMARCON EQU   DCMAFLG2                                                 09962000
DCMAWCON EQU   DCMAFLG2                                                 09963000
DCMALMIN EQU   DCMAFLG2                                                 09964000
@NM00074 EQU   DCMAFLG1                                                 09965000
@NM00073 EQU   DCMAFLG1                                                 09966000
DCMABL   EQU   DCMAFLG1                                                 09967000
DCMAFULL EQU   DCMAFLG1                                                 09968000
DCMAFRPR EQU   DCMAFLG1                                                 09969000
DCMADEND EQU   DCMAFLG1                                                 09970000
DCMADISP EQU   DCMAFLG1                                                 09971000
@NM00072 EQU   DCMAFLG1                                                 09972000
DCMAMT   EQU   DCMACLR+15                                               09973000
DCMATIME EQU   DCMACLR+11                                               09974000
DCMAMIN  EQU   DCMACLR+7                                                09975000
DCMAMJWQ EQU   DCMACLR+3                                                09976000
DCMAFR   EQU   DCMACLR+1                                                09977000
DCMAROW  EQU   DCMACLR                                                  09978000
DCMATOP  EQU   DCMACB+8                                                 09979000
DCMALN   EQU   DCMACB+6                                                 09980000
DCMAGM   EQU   DCMASACB                                                 09981000
DCMAUSE  EQU   DCMASACB                                                 09982000
DCMAID   EQU   DCMACB+4                                                 09983000
DCMACBNX EQU   DCMACB                                                   09984000
DCMPLNPR EQU   DCMPACB+2                                                09985000
DCMPLN   EQU   DCMPACB                                                  09986000
DCMMSGSV EQU   DCMTSRT+56                                               09987000
@NM00071 EQU   DCMTSRT+52                                               09988000
DCMRQDEL EQU   DCMTSRT+48                                               09989000
@NM00070 EQU   DCMTSRT+46                                               09990000
@NM00069 EQU   DCMR3FLG                                                 09991000
@NM00068 EQU   DCMR3FLG                                                 09992000
DCMRXHMT EQU   DCMR3FLG                                                 09993000
DCMR3PKA EQU   DCMR3FLG                                                 09994000
DCMRXSCN EQU   DCMR3FLG                                                 09995000
DCMCLPR  EQU   DCMR3FLG                                                 09996000
DCMKVIP  EQU   DCMR3FLG                                                 09997000
@NM00067 EQU   DCMR2FLG                                                 09998000
DCMRXTIM EQU   DCMR2FLG                                                 09999000
@NM00066 EQU   DCMR2FLG                                                 10000000
DCMRXDEL EQU   DCMR2FLG                                                 10001000
DCMRXRLL EQU   DCMR2FLG                                                 10002000
DCMRXTMR EQU   DCMR2FLG                                                 10003000
DCMRXUNV EQU   DCMR2FLG                                                 10004000
DCMRXSFL EQU   DCMR2FLG                                                 10005000
DCMTMCTR EQU   DCMTSRT+42                                               10006000
DCMINTVL EQU   DCMTSRT+40                                               10007000
DCMADPFK EQU   DCMTSRT+36                                               10008000
DCMSUBAD EQU   DCMTSRT+32                                               10009000
DCMDOMKY EQU   DCMTSRT+30                                               10010000
DCMRMSAL EQU   DCMTSRT+28                                               10011000
DCMWLAST EQU   DCMTSRT+24                                               10012000
DCMADRMS EQU   DCMTSRT+21                                               10013000
DCMRMS   EQU   DCMTSRT+20                                               10014000
@NM00065 EQU   DCMDEVTY                                                 10015000
@NM00064 EQU   DCMDEVTY                                                 10016000
@NM00063 EQU   DCMDEVTY                                                 10017000
@NM00062 EQU   DCMDEVTY                                                 10018000
@NM00061 EQU   DCMDEVTY                                                 10019000
@NM00060 EQU   DCMDEVTY                                                 10020000
DCMTY50  EQU   DCMDEVTY                                                 10021000
DCMTY60  EQU   DCMDEVTY                                                 10022000
@NM00059 EQU   @NM00051                                                 10023000
@NM00058 EQU   @NM00051                                                 10024000
@NM00057 EQU   @NM00051                                                 10025000
@NM00056 EQU   @NM00051                                                 10026000
@NM00055 EQU   @NM00051                                                 10027000
@NM00054 EQU   @NM00051                                                 10028000
@NM00053 EQU   @NM00051                                                 10029000
@NM00052 EQU   @NM00051                                                 10030000
DCMTOPDS EQU   DCMTSRT+13                                               10031000
DCMTOPAR EQU   DCMTSRT+12                                               10032000
DCMADKP  EQU   DCMTSRT+8                                                10033000
DCMLEN   EQU   DCMTSRT+6                                                10034000
@NM00050 EQU   DCMRFLGS                                                 10035000
@NM00049 EQU   DCMRFLGS                                                 10036000
@NM00048 EQU   DCMRFLGS                                                 10037000
DCMNIPP  EQU   DCMRFLGS                                                 10038000
DCMDOM   EQU   DCMRFLGS                                                 10039000
@NM00047 EQU   DCMRFLGS                                                 10040000
@NM00046 EQU   DCMRFLGS                                                 10041000
@NM00045 EQU   DCMRFLGS                                                 10042000
@NM00044 EQU   DCMTSRT+4                                                10043000
DCMADTRN EQU   DCMTSRT                                                  10044000
PARMRGAD EQU   PARMLIST+16                                              10045000
PARMRTAD EQU   PARMLIST+12                                              10046000
PARMCLAD EQU   PARMLIST+8                                               10047000
PARMSYAD EQU   PARMLIST+4                                               10048000
PARMCTBK EQU   PARMSTAT+3                                               10049000
PARMSYSR EQU   PARMSTAT+2                                               10050000
@NM00043 EQU   PARMFLAG                                                 10051000
@NM00042 EQU   PARMFLAG                                                 10052000
@NM00041 EQU   PARMFLAG                                                 10053000
PARMWARG EQU   PARMFLAG                                                 10054000
PARMFRID EQU   PARMFLAG                                                 10055000
PARMRECU EQU   PARMFLAG                                                 10056000
PARMCWT  EQU   PARMFLAG                                                 10057000
PARMSDWA EQU   PARMFLAG                                                 10058000
PARMFTPT EQU   PARMSTAT                                                 10059000
CSAXD    EQU   CXSA+36                                                  10060000
@NM00040 EQU   CSACODE                                                  10061000
@NM00039 EQU   CSACODE                                                  10062000
CSANPTR  EQU   CXSA                                                     10063000
CQEENDA  EQU   CQE+21                                                   10064000
CQEEND   EQU   CQE+20                                                   10065000
@NM00038 EQU   CQE+4                                                    10066000
CQEATTOP EQU   CQEFLAG                                                  10067000
@NM00037 EQU   CQEFLAG                                                  10068000
@NM00036 EQU   CQEEOB                                                   10069000
CVTLEVL  EQU   CVTRELNO+2                                               10070000
CVTNUMB  EQU   CVTRELNO                                                 10071000
CVTMDL   EQU   CVTFIX+250                                               10072000
@NM00035 EQU   CVTFIX+248                                               10073000
@NM00034 EQU   CVTFIX                                                   10074000
CVTRV482 EQU   CVTXTNT2+128                                             10075000
CVTRV481 EQU   CVTXTNT2+124                                             10076000
CVTRV480 EQU   CVTXTNT2+120                                             10077000
CVTRV479 EQU   CVTXTNT2+118                                             10078000
CVTRV478 EQU   CVTXTNT2+117                                             10079000
CVTRV477 EQU   CVTXTNT2+116                                             10080000
CVTRV476 EQU   CVTXTNT2+115                                             10081000
CVTRV475 EQU   CVTXTNT2+114                                             10082000
CVTRV474 EQU   CVTRV466                                                 10083000
CVTRV473 EQU   CVTRV466                                                 10084000
CVTRV472 EQU   CVTRV466                                                 10085000
CVTRV471 EQU   CVTRV466                                                 10086000
CVTRV470 EQU   CVTRV466                                                 10087000
CVTRV469 EQU   CVTRV466                                                 10088000
CVTRV468 EQU   CVTRV466                                                 10089000
CVTRV467 EQU   CVTRV466                                                 10090000
CVTRV465 EQU   CVTRV457                                                 10091000
CVTRV464 EQU   CVTRV457                                                 10092000
CVTRV463 EQU   CVTRV457                                                 10093000
CVTRV462 EQU   CVTRV457                                                 10094000
CVTRV461 EQU   CVTRV457                                                 10095000
CVTRV460 EQU   CVTRV457                                                 10096000
CVTRV459 EQU   CVTRV457                                                 10097000
CVTRV458 EQU   CVTRV457                                                 10098000
CVTRV456 EQU   CVTXTNT2+108                                             10099000
CVTRV455 EQU   CVTXTNT2+104                                             10100000
CVTRV454 EQU   CVTXTNT2+100                                             10101000
CVTRV453 EQU   CVTXTNT2+96                                              10102000
CVTRV452 EQU   CVTXTNT2+94                                              10103000
CVTRV451 EQU   CVTXTNT2+92                                              10104000
CVTRV450 EQU   CVTXTNT2+90                                              10105000
CVTRV449 EQU   CVTXTNT2+88                                              10106000
CVTRV448 EQU   CVTXTNT2+87                                              10107000
CVTRV447 EQU   CVTXTNT2+86                                              10108000
CVTRV446 EQU   CVTRV438                                                 10109000
CVTRV445 EQU   CVTRV438                                                 10110000
CVTRV444 EQU   CVTRV438                                                 10111000
CVTRV443 EQU   CVTRV438                                                 10112000
CVTRV442 EQU   CVTRV438                                                 10113000
CVTRV441 EQU   CVTRV438                                                 10114000
CVTRV440 EQU   CVTRV438                                                 10115000
CVTRV439 EQU   CVTRV438                                                 10116000
CVTRV437 EQU   CVTRV429                                                 10117000
CVTRV436 EQU   CVTRV429                                                 10118000
CVTRV435 EQU   CVTRV429                                                 10119000
CVTRV434 EQU   CVTRV429                                                 10120000
CVTRV433 EQU   CVTRV429                                                 10121000
CVTRV432 EQU   CVTRV429                                                 10122000
CVTRV431 EQU   CVTRV429                                                 10123000
CVTRV430 EQU   CVTRV429                                                 10124000
CVTRV428 EQU   CVTXTNT2+80                                              10125000
CVTRV427 EQU   CVTXTNT2+76                                              10126000
CVTRV426 EQU   CVTXTNT2+72                                              10127000
CVTRV425 EQU   CVTXTNT2+68                                              10128000
CVTATACT EQU   CVTATCVT                                                 10129000
CVTRV423 EQU   CVTXTNT2+62                                              10130000
CVTRV422 EQU   CVTXTNT2+60                                              10131000
CVTRV421 EQU   CVTXTNT2+58                                              10132000
CVTRV420 EQU   CVTXTNT2+56                                              10133000
CVTRV419 EQU   CVTXTNT2+55                                              10134000
CVTRV418 EQU   CVTXTNT2+54                                              10135000
CVTRV417 EQU   CVTRV409                                                 10136000
CVTRV416 EQU   CVTRV409                                                 10137000
CVTRV415 EQU   CVTRV409                                                 10138000
CVTRV414 EQU   CVTRV409                                                 10139000
CVTRV413 EQU   CVTRV409                                                 10140000
CVTRV412 EQU   CVTRV409                                                 10141000
CVTRV411 EQU   CVTRV409                                                 10142000
CVTRV410 EQU   CVTRV409                                                 10143000
CVTRV408 EQU   CVTRV400                                                 10144000
CVTRV407 EQU   CVTRV400                                                 10145000
CVTRV406 EQU   CVTRV400                                                 10146000
CVTRV405 EQU   CVTRV400                                                 10147000
CVTRV404 EQU   CVTRV400                                                 10148000
CVTRV403 EQU   CVTRV400                                                 10149000
CVTRV402 EQU   CVTRV400                                                 10150000
CVTRV401 EQU   CVTRV400                                                 10151000
CVTICB   EQU   CVTXTNT2+48                                              10152000
CVTSKTA  EQU   CVTXTNT2+44                                              10153000
CVTCCVT  EQU   CVTXTNT2+40                                              10154000
CVTRSV98 EQU   CVTXTNT2+36                                              10155000
CVTRSV97 EQU   CVTXTNT2+34                                              10156000
CVTRSV96 EQU   CVTXTNT2+32                                              10157000
CVTOLTEP EQU   CVTXTNT2+28                                              10158000
CVTQIDA  EQU   CVTQID+1                                                 10159000
CVTRSV95 EQU   CVTQID                                                   10160000
CVTRSV94 EQU   CVTXTNT2+20                                              10161000
CVTRSV93 EQU   CVTXTNT2+16                                              10162000
CVTRSV92 EQU   CVTXTNT2+12                                              10163000
CVTDEBVR EQU   CVTXTNT2+8                                               10164000
CVTRSV91 EQU   CVTXTNT2+6                                               10165000
CVTRSV9H EQU   CVTFLGBT                                                 10166000
CVTRSV9G EQU   CVTFLGBT                                                 10167000
CVTRSV9F EQU   CVTFLGBT                                                 10168000
CVTRSV9E EQU   CVTFLGBT                                                 10169000
CVTRSV9D EQU   CVTFLGBT                                                 10170000
CVTRSV9C EQU   CVTFLGBT                                                 10171000
CVTVME   EQU   CVTFLGBT                                                 10172000
CVTNPE   EQU   CVTFLGBT                                                 10173000
CVTNUCLS EQU   CVTXTNT2+4                                               10174000
CVTDSSVA EQU   CVTDSSV+1                                                10175000
CVTRSV89 EQU   CVTDSSV                                                  10176000
CVTRSV88 EQU   CVTXTNT1+8                                               10177000
CVTRSV87 EQU   CVTXTNT1+4                                               10178000
CVTFACHN EQU   CVTXTNT1                                                 10179000
CVTRV488 EQU   CVTMAP+412                                               10180000
CVTRV487 EQU   CVTMAP+408                                               10181000
CVTRV486 EQU   CVTMAP+404                                               10182000
CVTRV485 EQU   CVTMAP+400                                               10183000
CVTACTAP EQU   CVTMAP+396                                               10184000
CVTAUTH  EQU   CVTMAP+392                                               10185000
CVTATMCA EQU   CVTATMCT+1                                               10186000
CVTATMST EQU   CVTATMCT                                                 10187000
CVTRSV61 EQU   CVTMAP+384                                               10188000
CVTVOLT1 EQU   CVTVOLM1+1                                               10189000
CVTVOLI1 EQU   CVTVOLF1                                                 10190000
CVTSTOA  EQU   CVTMAP+376                                               10191000
CVTRSV58 EQU   CVTMAP+374                                               10192000
CVTRSV57 EQU   CVTMAP+372                                               10193000
CVTDDCE  EQU   CVTMAP+368                                               10194000
CVTPNWFR EQU   CVTMAP+364                                               10195000
CVTSMF   EQU   CVTMAP+360                                               10196000
CVTSULK  EQU   CVTMAP+358                                               10197000
CVTSLKO  EQU   CVTSYSK                                                  10198000
CVTSLKP  EQU   CVTSYSK                                                  10199000
CVTSLKQ  EQU   CVTSYSK                                                  10200000
CVTSLKR  EQU   CVTSYSK                                                  10201000
CVTRSV56 EQU   CVTSYSK                                                  10202000
CVTRSV55 EQU   CVTSYSK                                                  10203000
CVTRSV54 EQU   CVTSYSK                                                  10204000
CVTRSV53 EQU   CVTSYSK                                                  10205000
CVTRSV52 EQU   CVTA1F1                                                  10206000
CVTRSV51 EQU   CVTA1F1                                                  10207000
CVTRSV50 EQU   CVTA1F1                                                  10208000
CVTRSV49 EQU   CVTA1F1                                                  10209000
CVTRSV48 EQU   CVTA1F1                                                  10210000
CVTRSV47 EQU   CVTA1F1                                                  10211000
CVTSRSW  EQU   CVTA1F1                                                  10212000
CVTPFSW  EQU   CVTA1F1                                                  10213000
CVTPCVT  EQU   CVTMAP+352                                               10214000
CVTRSV46 EQU   CVTMAP+344                                               10215000
CVTRSV45 EQU   CVTMAP+340                                               10216000
CVTRSV44 EQU   CVTMAP+338                                               10217000
CVTRSV43 EQU   CVTMAP+336                                               10218000
CVTHJESA EQU   CVTHJES+1                                                10219000
CVTRSV42 EQU   CVTHJES                                                  10220000
CVTEXT2A EQU   CVTEXT2+1                                                10221000
CVTRSV41 EQU   CVTEXT2                                                  10222000
CVTAPFA  EQU   CVTAPF+1                                                 10223000
CVTRSV40 EQU   CVTAPF                                                   10224000
CVTRV518 EQU   CVTINTLA                                                 10225000
CVTRV517 EQU   CVTERPV                                                  10226000
CVTEORM  EQU   CVTMAP+312                                               10227000
CVTMCHPR EQU   CVTMAP+308                                               10228000
CVTTZ    EQU   CVTMAP+304                                               10229000
CVTJEPS  EQU   CVTMAP+300                                               10230000
CVTMODE  EQU   CVTMAP+292                                               10231000
CVTPTRV  EQU   CVTMAP+288                                               10232000
CVTREAL  EQU   CVTMAP+284                                               10233000
CVTRSV39 EQU   CVTMAP+280                                               10234000
CVTRSV38 EQU   CVTMAP+276                                               10235000
CVTDMSRA EQU   CVTDMSR+1                                                10236000
CVTRV634 EQU   CVTDMSRF                                                 10237000
CVTRV633 EQU   CVTDMSRF                                                 10238000
CVTRV632 EQU   CVTDMSRF                                                 10239000
CVTRV631 EQU   CVTDMSRF                                                 10240000
CVTRV630 EQU   CVTDMSRF                                                 10241000
CVTRV629 EQU   CVTDMSRF                                                 10242000
CVTUDUMP EQU   CVTDMSRF                                                 10243000
CVTSDUMP EQU   CVTDMSRF                                                 10244000
CVTQMSGA EQU   CVTQMSG+1                                                10245000
CVTRSV36 EQU   CVTQMSG                                                  10246000
CVTAMFF  EQU   CVTMAP+264                                               10247000
CVTPURGA EQU   CVTPURG+1                                                10248000
CVTRSV35 EQU   CVTPURG                                                  10249000
CVTCBSP  EQU   CVTMAP+256                                               10250000
CVTATERA EQU   CVTATER+1                                                10251000
CVTSYST  EQU   CVTATER                                                  10252000
CVTVOLT2 EQU   CVTTAT                                                   10253000
CVTVOLI2 EQU   CVTVOLF2                                                 10254000
CVTAQAVB EQU   CVTAQAVT+1                                               10255000
CVTRSV34 EQU   CVTTCMFG                                                 10256000
CVTRSV33 EQU   CVTTCMFG                                                 10257000
CVTRSV32 EQU   CVTTCMFG                                                 10258000
CVTRSV31 EQU   CVTTCMFG                                                 10259000
CVTRSV30 EQU   CVTTCMFG                                                 10260000
CVTRSV29 EQU   CVTTCMFG                                                 10261000
CVTLDEV  EQU   CVTTCMFG                                                 10262000
CVTTCRDY EQU   CVTTCMFG                                                 10263000
CVTGTFA  EQU   CVTGTF+1                                                 10264000
CVTRSV27 EQU   CVTGTFST                                                 10265000
CVTRNIO  EQU   CVTGTFST                                                 10266000
CVTUSR   EQU   CVTGTFST                                                 10267000
CVTRV318 EQU   CVTFORM                                                  10268000
CVTRV317 EQU   CVTTMODE                                                 10269000
CVTRV316 EQU   CVTSTATE                                                 10270000
CVTRV315 EQU   CVTGTFS                                                  10271000
CVTGTFAV EQU   CVTGTFS                                                  10272000
CVT0SCR1 EQU   CVTMAP+232                                               10273000
CVTRV515 EQU   CVTMAP+228                                               10274000
CVTRMS   EQU   CVTMAP+224                                               10275000
CVTPATCH EQU   CVTMAP+220                                               10276000
CVTTSCE  EQU   CVTMAP+216                                               10277000
CVTLNKSC EQU   CVTMAP+214                                               10278000
CVTQABST EQU   CVTMAP+212                                               10279000
CVTMDLDS EQU   CVTMAP+208                                               10280000
CVTUSER  EQU   CVTMAP+204                                               10281000
CVTSMCA  EQU   CVTMAP+196                                               10282000
CVTRSV18 EQU   CVTMAP+192                                               10283000
CVTQLPAQ EQU   CVTMAP+188                                               10284000
CVTQCDSR EQU   CVTMAP+184                                               10285000
CVTRSV17 EQU   CVTOPTB                                                  10286000
CVTRSV16 EQU   CVTOPTB                                                  10287000
CVTFP    EQU   CVTOPTB                                                  10288000
CVTAPTHR EQU   CVTOPTB                                                  10289000
CVTNLOG  EQU   CVTOPTB                                                  10290000
CVTTOD   EQU   CVTOPTB                                                  10291000
CVTCTIMS EQU   CVTOPTB                                                  10292000
CVTPROT  EQU   CVTOPTB                                                  10293000
CVTXPFP  EQU   CVTOPTA                                                  10294000
CVTASCII EQU   CVTOPTA                                                  10295000
CVTRSV13 EQU   CVTOPTA                                                  10296000
CVTRSV12 EQU   CVTOPTA                                                  10297000
CVTNIP   EQU   CVTOPTA                                                  10298000
CVTDDR   EQU   CVTOPTA                                                  10299000
CVTAPR   EQU   CVTOPTA                                                  10300000
CVTCCH   EQU   CVTOPTA                                                  10301000
CVTSNCTR EQU   CVTMAP+180                                               10302000
CVTQMWR  EQU   CVTMAP+176                                               10303000
CVTQOCR  EQU   CVTMAP+172                                               10304000
CVT1EF00 EQU   CVTMAP+168                                               10305000
CVTMZ00  EQU   CVTMAP+164                                               10306000
CVTSV76Q EQU   CVTSV76C                                                 10307000
CVTRSV11 EQU   CVTMAP+156                                               10308000
CVT0PT01 EQU   CVTMAP+152                                               10309000
CVTMSER  EQU   CVTMAP+148                                               10310000
CVTRV516 EQU   CVTIERLC                                                 10311000
CVTILCH  EQU   CVTMAP+140                                               10312000
CVT0DS   EQU   CVTMAP+136                                               10313000
CVTFBOSV EQU   CVTMAP+132                                               10314000
CVTNUCB  EQU   CVTMAP+128                                               10315000
CVTIXAVL EQU   CVTMAP+124                                               10316000
CVTSV76M EQU   CVTIOQET                                                 10317000
CVTDCBA  EQU   CVTMAP+117                                               10318000
CVTMVS2  EQU   CVTDCB                                                   10319000
CVT6DAT  EQU   CVTDCB                                                   10320000
CVT4MPS  EQU   CVTDCB                                                   10321000
CVTRSV09 EQU   CVTDCB                                                   10322000
CVT4MS1  EQU   CVTDCB                                                   10323000
CVT2SPS  EQU   CVTDCB                                                   10324000
CVT1SSS  EQU   CVTDCB                                                   10325000
CVTRSV08 EQU   CVTDCB                                                   10326000
CVTSTB   EQU   CVTMAP+112                                               10327000
CVTQTD00 EQU   CVTMAP+108                                               10328000
CVTQTE00 EQU   CVTMAP+104                                               10329000
CVTSJQ   EQU   CVTMAP+96                                                10330000
CVTPBLDL EQU   CVTMAP+92                                                10331000
CVTTPC   EQU   CVTMAP+88                                                10332000
CVTSVDCB EQU   CVTMAP+84                                                10333000
CVTEXIT  EQU   CVTMAP+80                                                10334000
CVT0FN00 EQU   CVTMAP+76                                                10335000
CVTDARA  EQU   CVTDAR+1                                                 10336000
CVTRSV07 EQU   CVTFLGS1                                                 10337000
CVTRSV06 EQU   CVTFLGS1                                                 10338000
CVTRSV05 EQU   CVTFLGS1                                                 10339000
CVTRSV04 EQU   CVTFLGS1                                                 10340000
CVTRSV03 EQU   CVTFLGS1                                                 10341000
CVTRSV02 EQU   CVTFLGS1                                                 10342000
CVTRSV01 EQU   CVTFLGS1                                                 10343000
CVTDMPLK EQU   CVTFLGS1                                                 10344000
CVTXITP  EQU   CVTMAP+68                                                10345000
CVTZDTAB EQU   CVTMAP+64                                                10346000
CVTMSLT  EQU   CVTMAP+60                                                10347000
CVTDATE  EQU   CVTMAP+56                                                10348000
CVTBTERM EQU   CVTMAP+52                                                10349000
CVTSYSAD EQU   CVTMAP+48                                                10350000
CVTXTLER EQU   CVTMAP+44                                                10351000
CVTILK2  EQU   CVTMAP+40                                                10352000
CVTILK1  EQU   CVTMAP+36                                                10353000
CVTPRLTV EQU   CVTMAP+32                                                10354000
CVTPCNVT EQU   CVTMAP+28                                                10355000
CVT0VL00 EQU   CVTMAP+24                                                10356000
CVTXAPG  EQU   CVTMAP+20                                                10357000
CVTBUF   EQU   CVTMAP+16                                                10358000
CVTJOB   EQU   CVTMAP+12                                                10359000
CVTLINK  EQU   CVTMAP+8                                                 10360000
CVT0EF00 EQU   CVTMAP+4                                                 10361000
CVTTCBP  EQU   CVTMAP                                                   10362000
CVT      EQU   CVTMAP                                                   10363000
ASCBEND  EQU   ASCB+208                                                 10364000
ASCBSRBT EQU   ASCB+200                                                 10365000
ASCBSWTL EQU   ASCB+196                                                 10366000
ASCBRS14 EQU   ASCB+195                                                 10367000
ASCBSMCT EQU   ASCB+194                                                 10368000
ASCBRS12 EQU   ASCB+192                                                 10369000
ASCBPCTT EQU   ASCB+188                                                 10370000
ASCBVGTT EQU   ASCB+184                                                 10371000
ASCBRV43 EQU   ASCBSRQ4                                                 10372000
ASCBRV42 EQU   ASCBSRQ4                                                 10373000
ASCBRV41 EQU   ASCBSRQ4                                                 10374000
ASCBRV40 EQU   ASCBSRQ4                                                 10375000
ASCBRV39 EQU   ASCBSRQ4                                                 10376000
ASCBRV38 EQU   ASCBSRQ4                                                 10377000
ASCBRV37 EQU   ASCBSRQ4                                                 10378000
ASCBRV36 EQU   ASCBSRQ4                                                 10379000
ASCBRV35 EQU   ASCBSRQ3                                                 10380000
ASCBRV34 EQU   ASCBSRQ3                                                 10381000
ASCBRV33 EQU   ASCBSRQ3                                                 10382000
ASCBRV32 EQU   ASCBSRQ3                                                 10383000
ASCBRV31 EQU   ASCBSRQ3                                                 10384000
ASCBRV30 EQU   ASCBSRQ3                                                 10385000
ASCBRV29 EQU   ASCBSRQ3                                                 10386000
ASCBRV28 EQU   ASCBSRQ3                                                 10387000
ASCBRV27 EQU   ASCBSRQ2                                                 10388000
ASCBRV26 EQU   ASCBSRQ2                                                 10389000
ASCBRV25 EQU   ASCBSRQ2                                                 10390000
ASCBRV24 EQU   ASCBSRQ2                                                 10391000
ASCBRV23 EQU   ASCBSRQ2                                                 10392000
ASCBRV22 EQU   ASCBSRQ2                                                 10393000
ASCBRV21 EQU   ASCBSRQ2                                                 10394000
ASCBRV20 EQU   ASCBSRQ2                                                 10395000
ASCBRV19 EQU   ASCBSRQ1                                                 10396000
ASCBRV18 EQU   ASCBSRQ1                                                 10397000
ASCBRV17 EQU   ASCBSRQ1                                                 10398000
ASCBRV16 EQU   ASCBSRQ1                                                 10399000
ASCBRV15 EQU   ASCBSRQ1                                                 10400000
ASCBRV14 EQU   ASCBSRQ1                                                 10401000
ASCBRV13 EQU   ASCBSRQ1                                                 10402000
ASCBSTA  EQU   ASCBSRQ1                                                 10403000
ASCBJBNS EQU   ASCB+176                                                 10404000
ASCBJBNI EQU   ASCB+172                                                 10405000
ASCBMCC  EQU   ASCB+168                                                 10406000
ASCBRTWA EQU   ASCB+164                                                 10407000
ASCBIQEA EQU   ASCB+160                                                 10408000
ASCBXMPQ EQU   ASCB+156                                                 10409000
ASCBRS01 EQU   ASCB+154                                                 10410000
ASCBFMCT EQU   ASCB+152                                                 10411000
ASCBOUXB EQU   ASCB+148                                                 10412000
ASCBOUCB EQU   ASCB+144                                                 10413000
ASCBMECB EQU   ASCB+140                                                 10414000
ASCBQECB EQU   ASCB+136                                                 10415000
ASCBLSQH EQU   ASCBLKGP+4                                               10416000
ASCBLOCK EQU   ASCBLKGP                                                 10417000
ASCBTCBS EQU   ASCB+124                                                 10418000
ASCBNVSC EQU   ASCB+122                                                 10419000
ASCBVSC  EQU   ASCB+120                                                 10420000
ASCBSRBS EQU   ASCB+118                                                 10421000
ASCBSSRB EQU   ASCB+116                                                 10422000
ASCBRV06 EQU   ASCBFLG2                                                 10423000
ASCBRV05 EQU   ASCBFLG2                                                 10424000
ASCBRV04 EQU   ASCBFLG2                                                 10425000
ASCBSNQS EQU   ASCBFLG2                                                 10426000
ASCBS2S  EQU   ASCBFLG2                                                 10427000
ASCBCEXT EQU   ASCBFLG2                                                 10428000
ASCBPXMT EQU   ASCBFLG2                                                 10429000
ASCBXMPT EQU   ASCBFLG2                                                 10430000
ASCBRF07 EQU   ASCBDSP1                                                 10431000
ASCBRF06 EQU   ASCBDSP1                                                 10432000
ASCBRF05 EQU   ASCBDSP1                                                 10433000
ASCBRF04 EQU   ASCBDSP1                                                 10434000
ASCBRF03 EQU   ASCBDSP1                                                 10435000
ASCBRF02 EQU   ASCBDSP1                                                 10436000
ASCBFAIL EQU   ASCBDSP1                                                 10437000
ASCBNOQ  EQU   ASCBDSP1                                                 10438000
ASCBSWCT EQU   ASCB+112                                                 10439000
ASCBASXB EQU   ASCB+108                                                 10440000
ASCBTMCH EQU   ASCB+104                                                 10441000
ASCBNSWP EQU   ASCBFLG1                                                 10442000
ASCBTYP1 EQU   ASCBFLG1                                                 10443000
ASCBSTND EQU   ASCBFLG1                                                 10444000
ASCBABNT EQU   ASCBFLG1                                                 10445000
ASCBTERM EQU   ASCBFLG1                                                 10446000
ASCBS3S  EQU   ASCBFLG1                                                 10447000
ASCBCMSH EQU   ASCBFLG1                                                 10448000
ASCBTOFF EQU   ASCBFLG1                                                 10449000
ASCBRF01 EQU   ASCBRCTF                                                 10450000
ASCBTMLW EQU   ASCBRCTF                                                 10451000
ASCBOUT  EQU   ASCBRCTF                                                 10452000
ASCBWAIT EQU   ASCBRCTF                                                 10453000
ASCBRV08 EQU   ASCBRCTF                                                 10454000
ASCBFQU  EQU   ASCBRCTF                                                 10455000
ASCBFRS  EQU   ASCBRCTF                                                 10456000
ASCBTMNO EQU   ASCBRCTF                                                 10457000
ASCBAFFN EQU   ASCBFW1                                                  10458000
ASCBDUMP EQU   ASCB+96                                                  10459000
ASCBRV44 EQU   ASCB+92                                                  10460000
ASCBUBET EQU   ASCB+88                                                  10461000
ASCBECB  EQU   ASCB+84                                                  10462000
ASCBJSTL EQU   ASCB+80                                                  10463000
ASCBEWST EQU   ASCB+72                                                  10464000
ASCBEJST EQU   ASCB+64                                                  10465000
ASCBTSB  EQU   ASCB+60                                                  10466000
ASCBCSCB EQU   ASCB+56                                                  10467000
ASCBRSMA EQU   ASCBRSM+1                                                10468000
ASCBRV54 EQU   ASCBRSMF                                                 10469000
ASCBRV53 EQU   ASCBRSMF                                                 10470000
ASCBRV52 EQU   ASCBRSMF                                                 10471000
ASCBRV51 EQU   ASCBRSMF                                                 10472000
ASCBVEQR EQU   ASCBRSMF                                                 10473000
ASCBN2LP EQU   ASCBRSMF                                                 10474000
ASCB1LPU EQU   ASCBRSMF                                                 10475000
ASCB2LPU EQU   ASCBRSMF                                                 10476000
ASCBLDA  EQU   ASCB+48                                                  10477000
ASCBSTOR EQU   ASCB+44                                                  10478000
ASCBDP   EQU   ASCB+43                                                  10479000
ASCBRV07 EQU   ASCB+42                                                  10480000
ASCBIOSM EQU   ASCB+40                                                  10481000
ASCBSEQN EQU   ASCB+38                                                  10482000
ASCBASID EQU   ASCB+36                                                  10483000
ASCBCPUS EQU   ASCB+32                                                  10484000
ASCBSPL  EQU   ASCB+28                                                  10485000
ASCBIOSP EQU   ASCB+24                                                  10486000
ASCBSYNC EQU   ASCBSUPC+4                                               10487000
ASCBSVRB EQU   ASCBSUPC                                                 10488000
ASCBCMSF EQU   ASCB+12                                                  10489000
ASCBBWDP EQU   ASCB+8                                                   10490000
ASCBFWDP EQU   ASCB+4                                                   10491000
ASCBASCB EQU   ASCB                                                     10492000
ASCBEGIN EQU   ASCB                                                     10493000
JESSASTA EQU   JESCT+48                                                 10494000
JESNUCBS EQU   JESCT+44                                                 10495000
JESPJESN EQU   JESCT+28                                                 10496000
JESSSCT  EQU   JESCT+24                                                 10497000
JESRESQM EQU   JESCT+16                                                 10498000
JESQMGR  EQU   JESCT+12                                                 10499000
JESUNITS EQU   JESCT+4                                                  10500000
@NM00033 EQU   JESCT                                                    10501000
@NM00115 EQU   PSA+3668                                                 10502000
PSASTAK  EQU   PSA+3072                                                 10503000
@NM00114 EQU   PSA+1048                                                 10504000
PSAUSEND EQU   PSA+1048                                                 10505000
PSARV062 EQU   PSA+1044                                                 10506000
PSACDAL  EQU   PSA+1040                                                 10507000
PSAWTCOD EQU   PSA+1036                                                 10508000
PSAATCVT EQU   PSA+1032                                                 10509000
PSAPCPSW EQU   PSA+1024                                                 10510000
PSAPIR2  EQU   PSA+1020                                                 10511000
PSARV059 EQU   PSA+1018                                                 10512000
PSASVC13 EQU   PSA+1016                                                 10513000
PSASFACC EQU   PSA+1008                                                 10514000
PSASTOP  EQU   PSA+992                                                  10515000
PSASTART EQU   PSA+976                                                  10516000
PSARSPSW EQU   PSA+968                                                  10517000
PSASRPSW EQU   PSA+960                                                  10518000
PSARV045 EQU   PSA+892                                                  10519000
PSARV044 EQU   PSA+888                                                  10520000
PSARV043 EQU   PSA+884                                                  10521000
PSARV042 EQU   PSA+880                                                  10522000
PSARV041 EQU   PSA+876                                                  10523000
PSARV040 EQU   PSA+872                                                  10524000
PSARV025 EQU   PSA+868                                                  10525000
PSADSSED EQU   PSA+868                                                  10526000
PSADSSPR EQU   PSA+864                                                  10527000
PSADSSFW EQU   PSA+860                                                  10528000
PSADSS14 EQU   PSA+856                                                  10529000
PSADSSPP EQU   PSA+848                                                  10530000
PSADSSRP EQU   PSA+840                                                  10531000
PSADSS05 EQU   PSADSSF4                                                 10532000
PSADSS10 EQU   PSADSSF4                                                 10533000
PSADSSVE EQU   PSADSSF4                                                 10534000
PSADSSDE EQU   PSADSSF4                                                 10535000
PSADSSC0 EQU   PSADSSF4                                                 10536000
PSADSSIE EQU   PSADSSF4                                                 10537000
PSADSS12 EQU   PSADSSF4                                                 10538000
PSADSSRC EQU   PSADSSF4                                                 10539000
PSARV057 EQU   PSADSSF3                                                 10540000
PSARV056 EQU   PSADSSF3                                                 10541000
PSARV055 EQU   PSADSSF3                                                 10542000
PSADSSMC EQU   PSADSSF3                                                 10543000
PSADSSRW EQU   PSADSSF3                                                 10544000
PSADSSNM EQU   PSADSSF3                                                 10545000
PSADSSES EQU   PSADSSF3                                                 10546000
PSADSSGP EQU   PSADSSF3                                                 10547000
PSADSSF2 EQU   PSADSSFL+1                                               10548000
PSADSSPI EQU   PSADSSF1                                                 10549000
PSADSSOI EQU   PSADSSF1                                                 10550000
PSADSSSP EQU   PSADSSF1                                                 10551000
PSADSSTP EQU   PSADSSF1                                                 10552000
PSADSSDW EQU   PSADSSF1                                                 10553000
PSADSSDD EQU   PSADSSF1                                                 10554000
PSADSSDM EQU   PSADSSF1                                                 10555000
PSADSSMV EQU   PSADSSF1                                                 10556000
PSADSSTS EQU   PSA+816                                                  10557000
PSADSSWK EQU   PSA+812                                                  10558000
PSADSSR3 EQU   PSA+808                                                  10559000
PSADSSR2 EQU   PSA+804                                                  10560000
PSADSSRS EQU   PSA+800                                                  10561000
PSASTOR  EQU   PSA+796                                                  10562000
PSACPUSA EQU   PSA+794                                                  10563000
PSAVSTAP EQU   PSA+792                                                  10564000
PSAWKVAP EQU   PSA+788                                                  10565000
PSAWKRAP EQU   PSA+784                                                  10566000
PSAMCHIC EQU   PSA+783                                                  10567000
PSAACTCD EQU   PSA+782                                                  10568000
PSASYMSK EQU   PSA+781                                                  10569000
PSAMCHFL EQU   PSA+780                                                  10570000
PSACR0   EQU   PSA+776                                                  10571000
PSAPSWSV EQU   PSA+768                                                  10572000
PSACLHS  EQU   PSAHLHI                                                  10573000
PSALKR15 EQU   PSALKSA+60                                               10574000
PSALKR14 EQU   PSALKSA+56                                               10575000
PSALKR13 EQU   PSALKSA+52                                               10576000
PSALKR12 EQU   PSALKSA+48                                               10577000
PSALKR11 EQU   PSALKSA+44                                               10578000
PSALKR10 EQU   PSALKSA+40                                               10579000
PSALKR9  EQU   PSALKSA+36                                               10580000
PSALKR8  EQU   PSALKSA+32                                               10581000
PSALKR7  EQU   PSALKSA+28                                               10582000
PSALKR6  EQU   PSALKSA+24                                               10583000
PSALKR5  EQU   PSALKSA+20                                               10584000
PSALKR4  EQU   PSALKSA+16                                               10585000
PSALKR3  EQU   PSALKSA+12                                               10586000
PSALKR2  EQU   PSALKSA+8                                                10587000
PSALKR1  EQU   PSALKSA+4                                                10588000
PSALKR0  EQU   PSALKSA                                                  10589000
PSARV023 EQU   PSACLHT+52                                               10590000
PSALOCAL EQU   PSACLHT+48                                               10591000
PSACMSL  EQU   PSACLHT+44                                               10592000
PSAOPTL  EQU   PSACLHT+40                                               10593000
PSATPACL EQU   PSACLHT+36                                               10594000
PSATPDNL EQU   PSACLHT+32                                               10595000
PSATPNCL EQU   PSACLHT+28                                               10596000
PSAIOSLL EQU   PSACLHT+24                                               10597000
PSAIOSUL EQU   PSACLHT+20                                               10598000
PSAIOSCL EQU   PSACLHT+16                                               10599000
PSAIOSSL EQU   PSACLHT+12                                               10600000
PSASALCL EQU   PSACLHT+8                                                10601000
PSAASML  EQU   PSACLHT+4                                                10602000
PSADISPL EQU   PSACLHT                                                  10603000
PSASRSA  EQU   PSA+636                                                  10604000
PSARV050 EQU   PSA+634                                                  10605000
PSADSSGO EQU   PSA+633                                                  10606000
PSARECUR EQU   PSA+632                                                  10607000
PSAHLHIS EQU   PSA+628                                                  10608000
PSAIPCSA EQU   PSA+624                                                  10609000
@NM00113 EQU   PSA+621                                                  10610000
PSAIPCDM EQU   PSA+620                                                  10611000
PSAIPCD  EQU   PSA+616                                                  10612000
@NM00112 EQU   PSA+613                                                  10613000
PSAIPCRM EQU   PSA+612                                                  10614000
PSAIPCR  EQU   PSA+608                                                  10615000
PSAMCHEX EQU   PSA+600                                                  10616000
PSAMPSW  EQU   PSA+592                                                  10617000
PSAEXPS2 EQU   PSA+584                                                  10618000
PSAEXPS1 EQU   PSA+576                                                  10619000
PSAPIREG EQU   PSA+572                                                  10620000
PSARSREG EQU   PSA+568                                                  10621000
PSAGPREG EQU   PSA+556                                                  10622000
PSARV022 EQU   PSASUP4                                                  10623000
PSARV021 EQU   PSASUP4                                                  10624000
PSARV020 EQU   PSASUP4                                                  10625000
PSARV019 EQU   PSASUP4                                                  10626000
PSARV018 EQU   PSASUP4                                                  10627000
PSARV017 EQU   PSASUP4                                                  10628000
PSARV016 EQU   PSASUP4                                                  10629000
PSARV015 EQU   PSASUP4                                                  10630000
PSARV014 EQU   PSASUP3                                                  10631000
PSAULCMS EQU   PSASUP3                                                  10632000
PSARV012 EQU   PSASUP3                                                  10633000
PSAESTA  EQU   PSASUP3                                                  10634000
PSASPR   EQU   PSASUP3                                                  10635000
PSAPSREG EQU   PSASUP3                                                  10636000
PSAPI2   EQU   PSASUP3                                                  10637000
PSAIOSUP EQU   PSASUP3                                                  10638000
PSALCR   EQU   PSASUP2                                                  10639000
PSARTM   EQU   PSASUP2                                                  10640000
PSAACR   EQU   PSASUP2                                                  10641000
PSAIPCE2 EQU   PSASUP2                                                  10642000
PSAIPCES EQU   PSASUP2                                                  10643000
PSAIPCEC EQU   PSASUP2                                                  10644000
PSAGTF   EQU   PSASUP2                                                  10645000
PSAIPCRI EQU   PSASUP2                                                  10646000
PSATYPE6 EQU   PSASUP1                                                  10647000
PSATCTL  EQU   PSASUP1                                                  10648000
PSADISP  EQU   PSASUP1                                                  10649000
PSALOCK  EQU   PSASUP1                                                  10650000
PSAPI    EQU   PSASUP1                                                  10651000
PSAEXT   EQU   PSASUP1                                                  10652000
PSASVC   EQU   PSASUP1                                                  10653000
PSAIO    EQU   PSASUP1                                                  10654000
PSAANEW  EQU   PSA+544                                                  10655000
PSATNEW  EQU   PSA+536                                                  10656000
PSALCCAR EQU   PSA+532                                                  10657000
PSALCCAV EQU   PSA+528                                                  10658000
PSAPCCAR EQU   PSA+524                                                  10659000
PSAPCCAV EQU   PSA+520                                                  10660000
PSACPULA EQU   PSA+518                                                  10661000
PSACPUPA EQU   PSA+516                                                  10662000
PSAPSA   EQU   PSA+512                                                  10663000
FLCHDEND EQU   PSA+512                                                  10664000
FLCCRSAV EQU   FLCMCLA+280                                              10665000
FLCGRSAV EQU   FLCMCLA+216                                              10666000
FLCFPSAV EQU   FLCMCLA+184                                              10667000
FLCFLA   EQU   FLCMCLA+88                                               10668000
FLCRGNCD EQU   FLCMCLA+84                                               10669000
FLCFSAA  EQU   FLCFSA+1                                                 10670000
@NM00111 EQU   FLCFSA                                                   10671000
@NM00110 EQU   FLCMCLA+77                                               10672000
PSAMDISC EQU   PSAMEDC                                                  10673000
PSAMINTR EQU   PSAMEDC                                                  10674000
PSAMINST EQU   PSAMEDC                                                  10675000
PSAMCCF  EQU   PSAMEDC                                                  10676000
PSAMCNOP EQU   PSAMEDC                                                  10677000
PSAMEXSR EQU   PSAMEDC                                                  10678000
PSAMCOPR EQU   PSAMEDC                                                  10679000
@NM00109 EQU   PSAMEDC                                                  10680000
@NM00108 EQU   FLCMCLA+72                                               10681000
FLCMCIC  EQU   FLCMCLA+64                                               10682000
@NM00107 EQU   FLCMCLA+20                                               10683000
FLCIOAA  EQU   FLCIOA+1                                                 10684000
@NM00106 EQU   FLCIOA                                                   10685000
@NM00105 EQU   FLCMCLA+15                                               10686000
@NM00104 EQU   FLCMCLA+14                                               10687000
@NM00103 EQU   FLCMCLA+12                                               10688000
FLCLCL   EQU   FLCMCLA+8                                                10689000
FLCIOELA EQU   FLCIOEL+1                                                10690000
@NM00102 EQU   FLCIOEL                                                  10691000
FLCCHIL  EQU   FLCCHNID+2                                               10692000
FLCCHMOD EQU   FLCCHTM                                                  10693000
FLCCHTYP EQU   FLCCHTM                                                  10694000
@NM00101 EQU   PSA+160                                                  10695000
FLCMTRCD EQU   PSA+157                                                  10696000
@NM00100 EQU   PSA+156                                                  10697000
FLCPERA  EQU   FLCPER+1                                                 10698000
@NM00099 EQU   FLCPER                                                   10699000
@NM00098 EQU   PSA+151                                                  10700000
FLCPERCD EQU   PSA+150                                                  10701000
FLCMCNUM EQU   PSA+149                                                  10702000
@NM00097 EQU   PSA+148                                                  10703000
FLCTEAA  EQU   FLCTEA+1                                                 10704000
@NM00096 EQU   FLCTEA                                                   10705000
PSAPIPC  EQU   PSAPICOD                                                 10706000
PSAPIMC  EQU   PSAPICOD                                                 10707000
PSAPIPER EQU   PSAPICOD                                                 10708000
PSARV049 EQU   FLCPICOD                                                 10709000
FLCPILCB EQU   FLCPIILC                                                 10710000
@NM00095 EQU   FLCPIILC                                                 10711000
@NM00094 EQU   PSAEPPSW                                                 10712000
FLCSVCN  EQU   PSAESPSW+2                                               10713000
FLCSILCB EQU   FLCSVILC                                                 10714000
@NM00093 EQU   FLCSVILC                                                 10715000
@NM00092 EQU   PSAESPSW                                                 10716000
FLCEICOD EQU   PSAEEPSW+2                                               10717000
PSASPAD  EQU   PSAEEPSW                                                 10718000
@NM00091 EQU   PSA+128                                                  10719000
FLCINPSW EQU   PSA+120                                                  10720000
FLCMNPSW EQU   PSA+112                                                  10721000
FLCPNPSW EQU   PSA+104                                                  10722000
FLCSNPSW EQU   PSA+96                                                   10723000
FLCENPSW EQU   PSA+88                                                   10724000
FLCTRACE EQU   PSA+84                                                   10725000
FLCTIMER EQU   PSA+80                                                   10726000
FLCCVT2  EQU   PSA+76                                                   10727000
FLCCAW   EQU   PSA+72                                                   10728000
FLCCSW   EQU   PSA+64                                                   10729000
FLCIOPSW EQU   PSA+56                                                   10730000
FLCMOPSW EQU   PSA+48                                                   10731000
FLCPOPSW EQU   PSA+40                                                   10732000
FLCSOPSW EQU   PSA+32                                                   10733000
FLCEOPSW EQU   PSA+24                                                   10734000
@NM00090 EQU   FLCICCW2+4                                               10735000
FLCCVT   EQU   FLCICCW2                                                 10736000
FLCICCW1 EQU   FLCROPSW                                                 10737000
FLCIPPSW EQU   FLCRNPSW                                                 10738000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      10739000
@RT00203 EQU   SWCHTIM                                                  10740000
@RC00299 EQU   @RC00298                                                 10741000
@RC00305 EQU   @RC00298                                                 10742000
@RC00326 EQU   @RC00323                                                 10743000
@RC00545 EQU   @EL00002                                                 10744000
@RC00577 EQU   @RC00576                                                 10745000
@RC00606 EQU   @EL00003                                                 10746000
@RC00587 EQU   @EL00003                                                 10747000
@RC00647 EQU   @RC00646                                                 10748000
@RF00711 EQU   @RC00708                                                 10749000
@RF00726 EQU   @RC00723                                                 10750000
@RF00762 EQU   @RC00759                                                 10751000
@RF00824 EQU   @RC00821                                                 10752000
@RF00844 EQU   @EL00005                                                 10753000
@RC00866 EQU   @EL00006                                                 10754000
@RF00872 EQU   @EL00006                                                 10755000
@RF00876 EQU   @EL00006                                                 10756000
@RC00882 EQU   @EL00007                                                 10757000
@RF00899 EQU   @EL00007                                                 10758000
@RF00936 EQU   @EL00010                                                 10759000
@RC00941 EQU   @EL00010                                                 10760000
@RF01079 EQU   @RC01076                                                 10761000
@RF01115 EQU   @EL00011                                                 10762000
@RF01120 EQU   @EL00011                                                 10763000
@RF01182 EQU   @EL00012                                                 10764000
@RF01187 EQU   @EL00012                                                 10765000
@RF01424 EQU   @EL00017                                                 10766000
@RC01354 EQU   @EL00017                                                 10767000
@RC01450 EQU   @RC01447                                                 10768000
@RF01484 EQU   @EL00018                                                 10769000
@RF01483 EQU   @EL00018                                                 10770000
@RF01494 EQU   @EL00019                                                 10771000
@RC01548 EQU   @RC01535                                                 10772000
@RF01660 EQU   @RC01657                                                 10773000
@RC01642 EQU   @EL00024                                                 10774000
@RC01652 EQU   @EL00024                                                 10775000
@RF01706 EQU   @EL00025                                                 10776000
@RF01752 EQU   @EL00030                                                 10777000
@RF00600 EQU   @RC00587                                                 10778000
@RF00599 EQU   @RC00587                                                 10779000
@RF00895 EQU   @RC00882                                                 10780000
@RC00884 EQU   @RC00882                                                 10781000
@RC01359 EQU   @RC01354                                                 10782000
@RC01455 EQU   @RC01450                                                 10783000
@RC01451 EQU   @RC01450                                                 10784000
@RF01554 EQU   @RC01548                                                 10785000
@RC00885 EQU   @RC00884                                                 10786000
@RF01362 EQU   @RC01359                                                 10787000
@RF01364 EQU   @RC01359                                                 10788000
@RF01417 EQU   @RC01359                                                 10789000
@RC01452 EQU   @RC01451                                                 10790000
@RC01458 EQU   @RC01455                                                 10791000
@RC00887 EQU   @RC00885                                                 10792000
@RC01461 EQU   @RC01458                                                 10793000
@ENDDATA EQU   *                                                        10794000
         END   IEAVSWCH,(C'PLS2311',0701,78058)                         10795000
