         TITLE 'IEAVVWTO - SINGLE LINE WTO AND WTOR PROCESSOR          *00001000
                        '                                               00002000
IEAVVWTO CSECT                                                          00003000
        USING *,REG6                                                    00004000
        MODID BR=YES                                                    00005000
        USING RBBASIC,REG5                                              00006000
* SAVE THE CONTENTS OF REGISTERS 0, 1 AND 14 SO THE PARAMETERS          00007000
* IN THESE REGISTERS ARENT LOST BY THE PL/S SET UP PROCESS.             00008000
        ST    REG0,XVWQEID        SAVE REG0  IN EXTENDED SAVEAREA       00009000
        ST    REG1,XVPARMAD       SAVE REG1  IN EXTENDED SAVEAREA       00010000
        ST    REG14,XVRET         SAVE REG14 IN EXTENDED SAVEAREA       00011000
        DROP  REG5                THIS STMNT MUST BE HERE               00012000
        DROP  REG6                                                      00013000
IEAVVWTO CSECT ,                                                   0002 00014000
@PROLOG  BALR  @11,0                                               0002 00015000
@PSTART  LA    @12,4095(,@11)                                      0002 00016000
         USING @PSTART,@11                                         0002 00017000
         USING @PSTART+4095,@12                                    0002 00018000
         L     @00,@SIZDATD                                        0002 00019000
         GETMAIN  R,LV=(0)                                              00020000
         LR    @09,@01                                             0002 00021000
         USING @DATD,@09                                           0002 00022000
         ST    @13,@SA00001+4                                      0002 00023000
         LR    @13,@09                                             0002 00024000
RBPRFXLN EQU 64                                                         00025000
RBPRFLNA EQU 32                                                         00026000
PRBLEN   EQU 136                                                        00027000
SIRBLEN  EQU 200                                                        00028000
TIRBLEN  EQU 136                                                        00029000
IRBLEN   EQU 128                                                        00030000
SVRBLEN  EQU 200                                                        00031000
*                                      REG3                          */ 00032000
*/********************************************************************/ 00033000
*/*                                                                  */ 00034000
*/*  SET UP THE ESTAE ENVIRONMENT                                    */ 00035000
*/*                                                                  */ 00036000
*/********************************************************************/ 00037000
*/********************************************************************/ 00038000
*/*                                                                  */ 00039000
*/*  FUNCTION THIS SEGMENT WILL SET UP THE ESTAE ENVIRONMENT         */ 00040000
*/*  AND WILL SET THE FIRST FOOTPRINT FOR IEAVVWTO.                  */ 00041000
*/*                                                                  */ 00042000
*/********************************************************************/ 00043000
*                                                                  0137 00044000
*   EPARM=EPARM&&EPARM;             /* CLEAR THE RECOVERY PARM LIST  */ 00045000
         XC    EPARM(24),EPARM                                     0137 00046000
*   RFY                                                            0138 00047000
*    (REG2,                                                        0138 00048000
*     REG8) RSTD;                   /* USE REGS 2 AND 8 FOR ESTAE    */ 00049000
*   REG8=ADDR(EPARM);               /* PUT ADDR OF OUR ESTAE PARM  0139 00050000
*                                      AREA                          */ 00051000
         LA    REG8,EPARM                                          0139 00052000
*   REG2=UCMFRRAD;                  /* ADDR OF IEAVMFRR, OUR RECOVERY   00053000
*                                      MOD                           */ 00054000
         L     @10,UCMBASPT(,REG3)                                 0140 00055000
         L     REG2,UCMFRRAD(,@10)                                 0140 00056000
*   RECREGS=ELIST;                  /* MOVE ESTAE PARM LIST TO AUTO     00057000
*                                      AREA                          */ 00058000
         MVI   RECREGS+16,C' '                                     0141 00059000
         MVC   RECREGS+17(47),RECREGS+16                           0141 00060000
         MVC   RECREGS(16),ELIST                                   0141 00061000
*   REG1=ADDR(RECREGS);             /* GET ADDR OF ESTAE PARM LIST 0142 00062000
*                                      AREA                          */ 00063000
         LA    REG1,RECREGS                                        0142 00064000
*   GEN(ESTAE (REG2),CT,PARAM=(REG8),RECORD=YES,MF=(E,(1)))        0143 00065000
*   REFS(REG2,REG8,REG1);           /* SET UP ESTAE ENVIRONMENT      */ 00066000
         ESTAE (REG2),CT,PARAM=(REG8),RECORD=YES,MF=(E,(1))             00067000
*   PARMPTR=ADDR(EPARM);            /* SET ADDR TO ESTAE PARM AREA   */ 00068000
         LA    @10,EPARM                                           0144 00069000
         ST    @10,PARMPTR                                         0144 00070000
*   PARMRGAD=ADDR(RECSAVE);         /* PT AT REG SAVE AREA           */ 00071000
         LA    @06,RECSAVE                                         0145 00072000
         ST    @06,PARMRGAD(,@10)                                  0145 00073000
*   PARMID=MODULEID;                /* IDENTIFY MODULE TO FRR        */ 00074000
         MVC   PARMID(4,@10),@CC01464                              0146 00075000
*   RECRGMAP=ALLREGS;               /* RESTORE ALL REGS AT RETRY     */ 00076000
         MVC   RECRGMAP(2),@CB01462                                0147 00077000
*   STM(REG0,REG15,RECREGS);        /* SAVE OUR REGS FOR RETRY IF  0148 00078000
*                                      NEEDED.                       */ 00079000
         STM   REG0,REG15,RECREGS                                  0148 00080000
*   PARMFTPT=FTVALCHK;              /* SET FOOT PRINT TO SHOW WE WERE   00081000
*                                      WORKING ON CHECKING THE     0149 00082000
*                                      VALIDITY OF THE USER'S WPL.   */ 00083000
         MVI   PARMFTPT(@10),X'01'                                 0149 00084000
*   PARMRTAD=0;                     /* ZERO RETRY ADDRESS    @ZA05504*/ 00085000
         SLR   @06,@06                                             0150 00086000
         ST    @06,PARMRTAD(,@10)                                  0150 00087000
*   RFY                                                            0151 00088000
*    (REG2,                                                        0151 00089000
*     REG8) UNRSTD;                 /* RELE REG 2 & 8                */ 00090000
*/********************************************************************/ 00091000
*/*                                                                  */ 00092000
*/*  SET UP THE EXTENDED SAVEAREA                                    */ 00093000
*/*                                                                  */ 00094000
*/********************************************************************/ 00095000
*/*** START OF SETUPXSA **********************************************/ 00096000
*/*   SETUPXSA - SET UP THE EXTENDED SAVE AREA                       */ 00097000
*/*                                                                  */ 00098000
*/*   INPUT -                                                        */ 00099000
*/*     REG 5 WILL BE POINTING AT THE SVRB WHICH CONTAINS THE        */ 00100000
*/*           EXTENDED SAVEAREA.                                     */ 00101000
*/*     XVPARMAD WILL PT AT THE USERS PARM LIST                      */ 00102000
*/*     XVWQEID WILL CONTAIN THE CONTENTS OF REGISTER 0.             */ 00103000
*/*     XVRET WILL CONTAIN THE RETURN ADDRESS.                       */ 00104000
*/*     THESE LAST THREE FIELDS ARE SET UP AT THE BEGINNING OF THE   */ 00105000
*/*     PROGRAM SO THAT THE NORMAL REENTRANT PROLOG CAN BE GENERATED */ 00106000
*/*     BY PL/S.                                                     */ 00107000
*/*     REG 4 IS THE ADDRESS OF THE TCB                              */ 00108000
*/*     REG 7 IS THE ADDRESS OF OUR ASCB                             */ 00109000
*/*                                                                  */ 00110000
*/*   OUTPUT - THE EXTENDED SAVE AREA IS INITIALIZED                 */ 00111000
*/*            VARIOUS BITS OR SETTINGS IN THE PARM LIST NOW APPEAR  */ 00112000
*/*            IN XSA.                                               */ 00113000
*/*            REG6 POINTS AT THE MESSAGE PART OF THE WPL            */ 00114000
*/*            XVA8 CONTAINS THE TIME IN DECIMAL FORMAT AS HHMMSSTH. */ 00115000
*/*                                                                  */ 00116000
*/*     THE MESSAGE LENGTH IS SAVED FOR INTEGRITY REASONS.           */ 00117000
*/*     THE LENGTH IS USED TO COMPUTE THE LENGTH OF THE PARM LIST.   */ 00118000
*/*     BY SAVING THE LENGTH, THE USER CAN NOT CHANGE THE LENGTH     */ 00119000
*/*     AFTER WE HAVE CHECKED THE VALIDITY OF THE PARM LIST.         */ 00120000
*/*                                                                  */ 00121000
*/********************************************************************/ 00122000
*                                                                  0152 00123000
*   XVDFLAGS=0;                     /* INSURE THAT ALL FLAGS ARE   0152 00124000
*                                      INITIALLY SET TO ZERO         */ 00125000
*                                                                  0152 00126000
         ST    @06,XVDFLAGS(,RBSECPTR)                             0152 00127000
*   /*****************************************************************/ 00128000
*   /*                                                               */ 00129000
*   /* INSURE THAT THE ROUTE CODES AND DESC CODES FILED IN XVSAV ARE */ 00130000
*   /* ZERO                                                          */ 00131000
*   /*                                                               */ 00132000
*   /*****************************************************************/ 00133000
*                                                                  0153 00134000
*   XVRDMSV=XVRDMSV&&XVRDMSV;       /* INITIALIZE R/D CODES TO ZERO  */ 00135000
         XC    XVRDMSV(6,RBSECPTR),XVRDMSV(RBSECPTR)               0153 00136000
*   RFY                                                            0154 00137000
*    (REG6) RSTD;                   /* USE REG6 TO POINT AT PARTS OF    00138000
*                                      PARM LIST                     */ 00139000
*   RFY                                                            0155 00140000
*    (WPL,                                                         0155 00141000
*     WPLRF) BASED(REG6);           /* REG 6 IS NOW BASE FOR WPL     */ 00142000
*   REG6=XVPARMAD;                  /* PICK UP ADDR OF PARM LIST     */ 00143000
         L     REG6,XVPARMAD(,RBSECPTR)                            0156 00144000
*   XVRETCOD=0;                     /* INSURE RETURN CODE IS       0157 00145000
*                                      INITIALLY ZERO                */ 00146000
         MVI   XVRETCOD(RBSECPTR),X'00'                            0157 00147000
*/********************************************************************/ 00148000
*/*                                                                  */ 00149000
*/*  CHECK TO SEE IF THIS IS A WTOR. THE CHECK IS MADE BY CHECKING   */ 00150000
*/*  WHETHER WPLRLN (THE REPLY LENGTH) IS ZERO. IF THE WPL IS FOR    */ 00151000
*/* A WTOR THEN WPLRLN WILL BE THE FIRST BYTE IN THE PARM LIST.      */ 00152000
*/*   IF THE WPL IS FOR A                                            */ 00153000
*/*  WTO THEN THERE WILL BE NO WTO PREFIX AND WPLLGH WILL BE THE     */ 00154000
*/*  FIRST 2 BYTES. THE TEXT HAS A MAX LENGTH OF 125 BYTES SO THE    */ 00155000
*/*  FIRST BYTE OF WPLLGH WILL BE ZERO. WPLRLN WILL ALWAYS BE NON    */ 00156000
*/*  ZERO IF THE WPL IS FOR A WTOR.                                  */ 00157000
*/*                                                                  */ 00158000
*/********************************************************************/ 00159000
*                                                                  0158 00160000
*   IF WPLRLN^=0 THEN               /* IS THIS A WTOR                */ 00161000
         CLI   WPLRLN(REG6),0                                      0158 00162000
         BE    @RF00158                                            0158 00163000
*     DO;                           /* YES                           */ 00164000
*       XVD2WTOR='1'B;              /* TURN ON WTOR BIT SO WE WILL 0160 00165000
*                                      KNOW TO SKIP PAST WTOR PREFIX */ 00166000
         OI    XVD2WTOR(RBSECPTR),B'00000010'                      0160 00167000
*       REG6=REG6+                  /* INCREMENT WPL POINTER BY    0161 00168000
*                                      LENGTH                        */ 00169000
*           LENGTH(WPLRF);          /* OF WTOR PREFIX                */ 00170000
         AL    REG6,@CF00061                                       0161 00171000
*     END;                                                         0162 00172000
*   RFY                                                            0163 00173000
*     WPLRF BASED(XVPARMAD);        /* RESET POINTER TO WTOR PART OF    00174000
*                                      WPL                           */ 00175000
@RF00158 DS    0H                                                  0164 00176000
*/********************************************************************/ 00177000
*/*                                                                  */ 00178000
*/* REG6 WILL NOW BE USED TO POINT AT THE WTO PART OF THE WPL        */ 00179000
*/*                                                                  */ 00180000
*/********************************************************************/ 00181000
*                                                                  0164 00182000
*   XVMSGLGH=WPLLGH;                /* SAVE LENGTH IN XSA            */ 00183000
         LH    @10,WPLLGH(,REG6)                                   0164 00184000
         STH   @10,XVMSGLGH(,RBSECPTR)                             0164 00185000
*/********************************************************************/ 00186000
*/*                                                                  */ 00187000
*/* CHECK TO SEE IF MSGTYP WAS SPECIFIED IN THE MACRO. IF IT WAS     */ 00188000
*/* TURN ON THE MSGTYP BIT IN THE XSA FLAGS. THIS IS DONE FOR FASTER */ 00189000
*/* CHECKING IF MSGTYP WAS SPECIFIED                                 */ 00190000
*/*                                                                  */ 00191000
*/********************************************************************/ 00192000
*                                                                  0165 00193000
*   IF WPLMCSFD='1'B THEN           /* WAS MSGTYP SPECIFIED          */ 00194000
         TM    WPLMCSFD(REG6),B'00010000'                          0165 00195000
         BNO   @RF00165                                            0165 00196000
*     XVD2MSGT='1'B;                /* YES, SET XSA MSGTYP BIT ON    */ 00197000
         OI    XVD2MSGT(RBSECPTR),B'00100000'                      0166 00198000
*/********************************************************************/ 00199000
*/*                                                                  */ 00200000
*/* CHECK IF ROUTE/DESCRIPTOR CODES (R/D CODES) WERE SPECIFIED.      */ 00201000
*/* THE R/D CODES AND MSGTYPE FIELDS ARE OPTIONAL PARAMETERS AND     */ 00202000
*/* EXTEND THE LENGTH OF THE WPL.                                    */ 00203000
*/*                                                                  */ 00204000
*/********************************************************************/ 00205000
*                                                                  0167 00206000
*   IF WPLMCSFA='1'B THEN           /* WAS R/D CODES SPECIFIED       */ 00207000
@RF00165 TM    WPLMCSFA(REG6),B'10000000'                          0167 00208000
         BNO   @RF00167                                            0167 00209000
*     XVD2RDC='1'B;                 /* YES, SET XSA R/D BIT ON       */ 00210000
         OI    XVD2RDC(RBSECPTR),B'01000000'                       0168 00211000
*/********************************************************************/ 00212000
*/*                                                                  */ 00213000
*/* NOW CHECK TO SEE IF THE USER IS AUTHORIZED OR NOT AND WHETHER    */ 00214000
*/* IT IS A PROBLEM PROGRAM OR NOT. THIS INFO IS USED TO SELECT      */ 00215000
*/* THE PROPER MESSAGE FLAGGING AND ERROR RECOVERY PROCEDURES.       */ 00216000
*/*                                                                  */ 00217000
*/********************************************************************/ 00218000
*                                                                  0169 00219000
*   RFY                                                            0169 00220000
*     REG15 RSTD;                   /* RESTRICT RETURN CODE REGISTER */ 00221000
@RF00167 DS    0H                                                  0170 00222000
*   GEN(TESTAUTH  STATE=YES,KEY=YES)                               0170 00223000
*   SETS(REG15);                    /* CHECK IF USER IS SUPERVISOR 0170 00224000
*                                      STATE OR PROTECT KEY 0-7.     */ 00225000
         TESTAUTH  STATE=YES,KEY=YES                                    00226000
*   IF REG15^=0 THEN                /* IS USER NOT STATE OR KEY    0171 00227000
*                                      AUTHORIZED                    */ 00228000
         LTR   REG15,REG15                                         0171 00229000
         BZ    @RF00171                                            0171 00230000
*     DO;                           /* YES, THE USER IS A PROBLEM  0172 00231000
*                                      PROGRAM                       */ 00232000
*       XVD1PP='1'B;                /* TURN ON PROB. PROGRAM BIT IN     00233000
*                                      XSA                           */ 00234000
         OI    XVD1PP(RBSECPTR),B'00000100'                        0173 00235000
*       GEN(TESTAUTH FCTN=1)        /* CHECK IF APF AUTHOZIZED       */ 00236000
*       SETS(REG15);                                               0174 00237000
         TESTAUTH FCTN=1                                                00238000
*       IF REG15=0 THEN             /* IS USER APF AUTHORIZED        */ 00239000
         LTR   REG15,REG15                                         0175 00240000
         BNZ   @RF00175                                            0175 00241000
*         XVD1AUTH='1'B;            /* YES, TURN ON AUTHORIZED BIT IN   00242000
*                                      XSA                           */ 00243000
         OI    XVD1AUTH(RBSECPTR),B'00000010'                      0176 00244000
*       ELSE                                                       0177 00245000
*         ;                         /* NO, DO NOTHING                */ 00246000
@RF00175 DS    0H                                                  0178 00247000
*     END;                                                         0178 00248000
*   ELSE                            /* NO, USER NOT PP.              */ 00249000
*     XVD1AUTH='1'B;                /* THEN USER IS AUTHORIZED       */ 00250000
         B     @RC00171                                            0179 00251000
@RF00171 OI    XVD1AUTH(RBSECPTR),B'00000010'                      0179 00252000
*   RFY                                                            0180 00253000
*     REG15 UNRSTD;                 /* RELEASE REG 15                */ 00254000
@RC00171 DS    0H                                                  0181 00255000
*/********************************************************************/ 00256000
*/*                                                                  */ 00257000
*/* NOW CHECK IF USER IS A PRIVELEGED TASK. A PRIVILEGED USER IS     */ 00258000
*/*   A. THE COMMUNICATIONS TASK                                     */ 00259000
*/*   B. ANY TASK RUNNING UNDER AN SIRB                              */ 00260000
*/*   C. A DAUGHTER TASK OF THE COMMUNICATIONS TASK          @ZA01858*/ 00261000
*/*   D. AN AUTHORIZED SUBSYSTEM SUCH AS JES3                @ZA19256*/ 00262000
*/* A PRIVILEGED USER MAY PUT OUT A WTO ANY TIME. IT DOES NOT HAVE   */ 00263000
*/* TO WAIT FOR SPACE IF ALL THE WQES ARE TAKEN.                     */ 00264000
*/* FIRST CHECK IF THE USER IS COMMTASK.                             */ 00265000
*/*                                                                  */ 00266000
*/* NOTE: THE SPECIAL CHECK FOR A DAUGHTER TASK IS ADDED     @ZA01858*/ 00267000
*/*       TO PERMIT TASK ATTACHED BY THE COMMUNICATIONS      @ZA01858*/ 00268000
*/*       TASK TO EXCEED THE WQE LIMITS IF NECESSARY.        @ZA01858*/ 00269000
*/*                                                                  */ 00270000
*/********************************************************************/ 00271000
*                                                                  0181 00272000
*   IF ASCBASID=UCMCTID&            /* ARE WE IN THE COMTASK'S MEMORY*/ 00273000
*       REG4=UCMPXA|                /* AND COMTASK'S TCB     @ZA01858*/ 00274000
*       UCMPXA=TCBOTC THEN          /* OR DAUGHTER TASK      @ZA01858*/ 00275000
         L     @10,UCMBASPT(,REG3)                                 0181 00276000
         LH    @08,ASCBASID(,ASCBPTR)                              0181 00277000
         N     @08,@CF03329                                        0181 00278000
         CH    @08,UCMCTID(,@10)                                   0181 00279000
         BNE   @GL00001                                            0181 00280000
         C     REG4,UCMPXA(,@10)                                   0181 00281000
         BE    @RT00181                                            0181 00282000
@GL00001 L     @10,UCMBASPT(,REG3)                                 0181 00283000
         CLC   UCMPXA(4,@10),TCBOTC(TCBPTR)                        0181 00284000
         BNE   @RF00181                                            0181 00285000
@RT00181 DS    0H                                                  0182 00286000
*     XVD1PRIV='1'B;                /* YES, THEN INDICATE A        0182 00287000
*                                      PRIVILEGED TASK               */ 00288000
         OI    XVD1PRIV(RBSECPTR),B'10000000'                      0182 00289000
*   ELSE                            /* NO, CHECK IF THIS RB IS AN  0183 00290000
*                                      SIRB                          */ 00291000
*     DO;                           /* IS THE USER'S RB AN SIRB    0183 00292000
*                                                            @ZA03627*/ 00293000
         B     @RC00181                                            0183 00294000
@RF00181 DS    0H                                                  0184 00295000
*/************************************************************YM06329*/ 00296000
*/* IF THE TASK IS NOT RUNNING IN SIRB MODE, THEN CHECK IF    YM06329*/ 00297000
*/* WE WERE ENTERED TO ISSUE A LOG MESSAGE, OR SUBSYSTEM.     YM06329*/ 00298000
*/************************************************************YM06329*/ 00299000
*                                                                  0184 00300000
*       IF RBLINK->RBFTP='100'B|TCBTID='F8'X THEN                  0184 00301000
         L     @10,RBLINK(,RBSECPTR)                               0184 00302000
         TM    RBFTP(@10),B'10000000'                              0184 00303000
         BNO   @GL00003                                            0184 00304000
         TM    RBFTP(@10),B'01100000'                              0184 00305000
         BZ    @RT00184                                            0184 00306000
@GL00003 CLI   TCBTID(TCBPTR),X'F8'                                0184 00307000
         BNE   @RF00184                                            0184 00308000
@RT00184 DS    0H                                                  0185 00309000
*         XVD1PRIV='1'B;            /* YES, INDICATE A PRIVILEGED  0185 00310000
*                                      TASK                          */ 00311000
         OI    XVD1PRIV(RBSECPTR),B'10000000'                      0185 00312000
*       ELSE                        /*                       @ZA03627*/ 00313000
*         IF UCMJES3T=REG7 THEN     /* IF SUBSYSTEM ISSUED WTO     0186 00314000
*                                                            @ZA19256*/ 00315000
         B     @RC00184                                            0186 00316000
@RF00184 L     @10,UCMBASPT(,REG3)                                 0186 00317000
         C     REG7,UCMJES3T(,@10)                                 0186 00318000
         BNE   @RF00186                                            0186 00319000
*           XVD1PRIV='1'B;          /* SET PRIVILEGED BIT    @ZA03627*/ 00320000
         OI    XVD1PRIV(RBSECPTR),B'10000000'                      0187 00321000
*     END;                          /*                       @ZA03627*/ 00322000
@RF00186 DS    0H                                                  0188 00323000
@RC00184 DS    0H                                                  0189 00324000
*/********************************************************************/ 00325000
*/*                                                                  */ 00326000
*/*  TAKE THE TIME AND SAVE IT IN XVA8 ALSO KNOWN AS TIMEFLD   YM0820*/ 00327000
*/*                                                                  */ 00328000
*/********************************************************************/ 00329000
*                                                                  0189 00330000
*   RFY                                                            0189 00331000
*     REG0 RSTD;                    /*                         YM0820*/ 00332000
@RC00181 DS    0H                                                  0190 00333000
*   TIMEFLD=0;                      /* INITIALIZE THE TIME TO ZERO   */ 00334000
         SLR   @10,@10                                             0190 00335000
         ST    @10,TIMEFLD(,RBSECPTR)                              0190 00336000
*   STM(REG0,REG15,RECREGS);        /* SAVE THE REGS AT THIS POINT IN   00337000
*                                      CASE THERE IS AN ERROR IN TIME   00338000
*                                      SVC                           */ 00339000
         STM   REG0,REG15,RECREGS                                  0191 00340000
*   PARMFTPT=FTTIME;                /* TIME WAS TAKEN                */ 00341000
         L     @10,PARMPTR                                         0192 00342000
         MVI   PARMFTPT(@10),X'02'                                 0192 00343000
*   PARMRTAD=ADDR(TIMERET);                                        0193 00344000
         LA    @08,TIMERET                                         0193 00345000
         ST    @08,PARMRTAD(,@10)                                  0193 00346000
*   GEN(TIME DEC,ERRET=TIMERET)                                    0194 00347000
*   SETS(REG0) FLOWS(TIMERET);      /* TAKE THE TIME.          YM0820*/ 00348000
         TIME DEC,ERRET=TIMERET                                         00349000
*   TIMEFLD=REG0;                   /* SAVE THE TIME IN XVSAV. YM0820*/ 00350000
         ST    REG0,TIMEFLD(,RBSECPTR)                             0195 00351000
*TIMERET:                           /* IF ERROR IN TIME THEN DONT  0196 00352000
*                                      STORE REG0                    */ 00353000
*   PARMFTPT=FTVALCHK;              /* RESUME CHECK OF WPL           */ 00354000
TIMERET  L     @10,PARMPTR                                         0196 00355000
         MVI   PARMFTPT(@10),X'01'                                 0196 00356000
*   PARMRTAD=0;                     /* ZERO RETRY ADDRESS    @ZA05504*/ 00357000
         SLR   @08,@08                                             0197 00358000
         ST    @08,PARMRTAD(,@10)                                  0197 00359000
*   RFY                                                            0198 00360000
*     REG0 UNRSTD;                  /* YM0820                        */ 00361000
*/***** END OF SETUPXSA **********************************************/ 00362000
*/********************************************************************/ 00363000
*/*                                                                  */ 00364000
*/*  CHECK THAT THE PARAMETER LIST IS VALID                          */ 00365000
*/*                                                                  */ 00366000
*/********************************************************************/ 00367000
*/*** START OF VALIDCHK **********************************************/ 00368000
*/*                                                                  */ 00369000
*/*   VALIDCHK - CHECK THE VALIDITY OF THE USER'S PARM LIST          */ 00370000
*/*                                                                  */ 00371000
*/*   INPUT -                                                        */ 00372000
*/*     XVPARMAD SHOULD POINT AT THE USERS PARM LIST                 */ 00373000
*/*     XVMSGLGH SHOULD CONTAIN LENGTH OF MSG + 4                    */ 00374000
*/*     XVD2RDC & XVD2MSGT SHOULD BE SET IF ROUTE/DESRIPTOR          */ 00375000
*/*       CODES OR MSGTYP FIELDS ARE USED. THESE FIELDS WILL         */ 00376000
*/*       DETERMINE END LOCATION OF THE USERS PARM LIST              */ 00377000
*/*     XVD2WTOR SHOULD BE SET ON IF THIS IS A WTOR                  */ 00378000
*/*     REG6 POINTS AT THE BEGINNING OF THE WPL MESSAGE PART         */ 00379000
*/*                                                                  */ 00380000
*/*   OUTPUT -  XVD2VALD IS ON IF PARM LIST IS VALID, OFF IF INVALID */ 00381000
*/*             REG8 POINTS AT THE ROUTE/DESC CODES AND MSGTYPE      */ 00382000
*/*             PART OF THE WPL.                                     */ 00383000
*/*                                                                  */ 00384000
*/********************************************************************/ 00385000
*/********************************************************************/ 00386000
*/*                                                                  */ 00387000
*/*  NOW CHECK THE VALIDITY OF THE USER'S PARM LIST. WE WILL CHECK   */ 00388000
*/*  THAT THE BEGINNING AND ENDING ADDRESS OF THE PARM LIST IS IN    */ 00389000
*/*  USER'S ADDRESSABLE STORAGE. WE WILL ALSO CHECK THAT THE WPL IS  */ 00390000
*/*  ON A WORD BOUNDARY FOR WTORS. IF THE PARM LIST IS VALID THEN    */ 00391000
*/*  XVD2VALD IS LEFT ON.                                            */ 00392000
*/*                                                                  */ 00393000
*/********************************************************************/ 00394000
*                                                                  0199 00395000
*   XVD2VALD='1'B;                  /* ASSUME USER VALID. TURN BIT 0199 00396000
*                                      OFF IF FOUND INVALID. THIS  0199 00397000
*                                      TECHNIQUE IS USED BECAUSE OF     00398000
*                                      USE OF ESTATE TO TURN OFF BIT */ 00399000
         OI    XVD2VALD(RBSECPTR),B'00010000'                      0199 00400000
*/********************************************************************/ 00401000
*/*                                                                  */ 00402000
*/* COMPUTE ENDING ADDRESS OF PARAMETER LIST                         */ 00403000
*/*                                                                  */ 00404000
*/********************************************************************/ 00405000
*                                                                  0200 00406000
*   RFY                                                            0200 00407000
*    (REG2,                                                        0200 00408000
*     REG8) RSTD;                   /* RESTRICT REG2 FOR DEVELOPMENT    00409000
*                                      OF PARM LIST LENGTH, REG8 TO     00410000
*                                      POINT AT FLAGS PART OF WPL    */ 00411000
*   RFY                                                            0201 00412000
*    (WPLLS01,                                                     0201 00413000
*     WPLML) BASED(REG2);           /* USE REG2 AS PTR TO ML PART    */ 00414000
*   RFY                                                            0202 00415000
*     WPLFLGS BASED(REG8);          /* USE REG8 AS PTR TO FLAGS PART    00416000
*                                      OF WPL                        */ 00417000
*   REG2=REG6+                      /* ADDRESS OF BEGINNING OF MSG 0203 00418000
*                                      PART                          */ 00419000
*       XVMSGLGH;                   /* PLUS LENGTH OF TEXT + 4       */ 00420000
         LR    REG2,REG6                                           0203 00421000
         AH    REG2,XVMSGLGH(,RBSECPTR)                            0203 00422000
*   REG8=REG2;                      /* SAVE ADDR OF FLAGS PART OF WPL*/ 00423000
         LR    REG8,REG2                                           0204 00424000
*/********************************************************************/ 00425000
*/*                                                                  */ 00426000
*/*  CHECK FOR MSGTYP. IF SO ADD SIX FOR R/D CODES AND MSGTYP        */ 00427000
*/*                                                                  */ 00428000
*/********************************************************************/ 00429000
*                                                                  0205 00430000
*   IF XVD2MSGT='1'B THEN           /* WAS MSGTYP SPECIFIED (IMPLIES    00431000
*                                      THAT ROUTE/DESC CODES ARE   0205 00432000
*                                      PRESENT IN WPL)               */ 00433000
         TM    XVD2MSGT(RBSECPTR),B'00100000'                      0205 00434000
         BNO   @RF00205                                            0205 00435000
*     DO;                           /* YES, MSGTYP PRESENT. CHECK FOR   00436000
*                                      QID                           */ 00437000
*       IF WPLMSGTD='1'B THEN       /* IS QID INDICATED IN MSGTYP  0207 00438000
*                                      FIELD                         */ 00439000
         TM    WPLMSGTD(REG8),B'00010000'                          0207 00440000
         BNO   @RF00207                                            0207 00441000
*         XVD0QID='1'B;             /* YES, SET BIT IN XSA           */ 00442000
         OI    XVD0QID(RBSECPTR),B'00001000'                       0208 00443000
*       REG2=REG2+                  /* ADD LENGTH OF EXTRA FIELDS    */ 00444000
*           LENGTH(WPLDESC)+LENGTH(WPLROUT)+LENGTH(WPLMSGTY);      0209 00445000
@RF00207 AL    REG2,@CF00187                                       0209 00446000
*     END;                                                         0210 00447000
*   ELSE                                                           0211 00448000
*                                                                  0211 00449000
*/********************************************************************/ 00450000
*/*                                                                  */ 00451000
*/*  CHECK IF JUST ROUT/DESC CODES PRESENT                           */ 00452000
*/*                                                                  */ 00453000
*/********************************************************************/ 00454000
*                                                                  0211 00455000
*     IF XVD2RDC='1'B THEN          /* WERE R/D CODES SPECIFIED      */ 00456000
         B     @RC00205                                            0211 00457000
@RF00205 TM    XVD2RDC(RBSECPTR),B'01000000'                       0211 00458000
         BNO   @RF00211                                            0211 00459000
*       REG2=REG2+                  /* THEN INCREMENT BY LENGTH OF 0212 00460000
*                                      R/D                           */ 00461000
*           LENGTH(WPLDESC)+        /* CODES FIELD                   */ 00462000
*           LENGTH(WPLROUT);                                       0212 00463000
*                                                                  0212 00464000
         AL    REG2,@CF00084                                       0212 00465000
*/********************************************************************/ 00466000
*/*                                                                  */ 00467000
*/*  CHECK IF THIS IS A MLWTO. IF SO COMPUTE LENGTH OF PARM LIST.    */ 00468000
*/*  ALSO CHECK FOR THE INVALID COMBINATION OF MLWTOR. IF THIS WAS   */ 00469000
*/*  SPECIFIED, TURN XVD2VALD OFF AS PARM LIST IS INVALID.           */ 00470000
*/*                                                                  */ 00471000
*/********************************************************************/ 00472000
*                                                                  0213 00473000
*   IF WPLMCSFJ='1'B THEN           /* IS THIS A MLWTO               */ 00474000
@RF00211 DS    0H                                                  0213 00475000
@RC00205 TM    WPLMCSFJ(REG6),B'01000000'                          0213 00476000
         BNO   @RF00213                                            0213 00477000
*     IF XVD2WTOR='1'B THEN         /* YES, IS IT ALSO A WTOR        */ 00478000
         TM    XVD2WTOR(RBSECPTR),B'00000010'                      0214 00479000
         BNO   @RF00214                                            0214 00480000
*       XVD2VALD='0'B;              /* YES, PARM LIST IS INVALID     */ 00481000
         NI    XVD2VALD(RBSECPTR),B'11101111'                      0215 00482000
*     ELSE                          /* NO, COMPUTE LENGTH OF MLWTO 0216 00483000
*                                      PART                          */ 00484000
*       DO;                         /* OF THE PARM LIST.             */ 00485000
*                                                                  0216 00486000
         B     @RC00214                                            0216 00487000
@RF00214 DS    0H                                                  0217 00488000
*         /***********************************************************/ 00489000
*         /*                                                         */ 00490000
*         /* WAS QID SPECIFIED IN MSGTYPE FIELD?                     */ 00491000
*         /*                                                         */ 00492000
*         /***********************************************************/ 00493000
*                                                                  0217 00494000
*         IF XVD0QID='1'B THEN                                     0217 00495000
         TM    XVD0QID(RBSECPTR),B'00001000'                       0217 00496000
         BNO   @RF00217                                            0217 00497000
*           REG2=REG2+              /* YES, UP PTR PAST QID FIELD    */ 00498000
*               LENGTH(WPLQID);                                    0218 00499000
         AL    REG2,@CF00088                                       0218 00500000
*         RFY                                                      0219 00501000
*           REG1 RSTD;              /* REG1 WILL BE USED AS LOOP   0219 00502000
*                                      COUNTER                       */ 00503000
@RF00217 DS    0H                                                  0220 00504000
*         REG1=WPLLINES-            /* WE HAVE ALREADY PROCESSED ONE    00505000
*                                      LINE                          */ 00506000
*             1;                    /* OF THE MLWTO                  */ 00507000
         SLR   REG1,REG1                                           0220 00508000
         IC    REG1,WPLLINES(,REG2)                                0220 00509000
         BCTR  REG1,0                                              0220 00510000
*         REG2=REG2+                /* POINT AT 1ST OF THE EXTRA   0221 00511000
*                                      LINES                         */ 00512000
*             LENGTH(WPLLTF)+LENGTH(WPLAREA)+LENGTH(WPLLINES);     0221 00513000
*                                                                  0221 00514000
         AL    REG2,@CF00084                                       0221 00515000
*         /***********************************************************/ 00516000
*         /*                                                         */ 00517000
*         /* LOOP OVER MULTI LINE TEXT                               */ 00518000
*         /*                                                         */ 00519000
*         /***********************************************************/ 00520000
*                                                                  0222 00521000
*         DO REG1=REG1 TO 1 BY-1;                                  0222 00522000
*                                                                  0222 00523000
         B     @DE00222                                            0222 00524000
@DL00222 DS    0H                                                  0223 00525000
*           /*********************************************************/ 00526000
*           /*                                                       */ 00527000
*           /* POINT TO NEXT LINE OF TEXT                            */ 00528000
*           /*                                                       */ 00529000
*           /*********************************************************/ 00530000
*                                                                  0223 00531000
*           REG2=REG2+WPLMLLEN;                                    0223 00532000
         SLR   @10,@10                                             0223 00533000
         IC    @10,WPLMLLEN(,REG2)                                 0223 00534000
         ALR   REG2,@10                                            0223 00535000
*         END;                                                     0224 00536000
         BCTR  REG1,0                                              0224 00537000
@DE00222 LTR   REG1,REG1                                           0224 00538000
         BP    @DL00222                                            0224 00539000
*         RFY                                                      0225 00540000
*           REG1 UNRSTD;            /* RELEASE REGISTER 1            */ 00541000
*       END;                                                       0226 00542000
*                                                                  0226 00543000
*/********************************************************************/ 00544000
*/*                                                                  */ 00545000
*/* REG2 SHOULD NOW POINT TO FIRST BYTE AFTER THE WPL. POINT AT      */ 00546000
*/* LAST BYTE OF THE WPL.                                            */ 00547000
*/*                                                                  */ 00548000
*/********************************************************************/ 00549000
*                                                                  0227 00550000
*   REG2=REG2-1;                    /* BACK UP ONE BYTE              */ 00551000
@RC00214 DS    0H                                                  0227 00552000
@RF00213 BCTR  REG2,0                                              0227 00553000
*/********************************************************************/ 00554000
*/*                                                                  */ 00555000
*/* CHECK IF LIST IS STILL VALID                                     */ 00556000
*/*                                                                  */ 00557000
*/********************************************************************/ 00558000
*                                                                  0228 00559000
*   IF XVD2VALD='1'B THEN           /* VALID BIT NOT TURNED OFF      */ 00560000
         TM    XVD2VALD(RBSECPTR),B'00010000'                      0228 00561000
         BNO   @RF00228                                            0228 00562000
*     DO;                           /* YES, CHECK FOR VALID ADDRESSES*/ 00563000
*/********************************************************************/ 00564000
*/*                                                                  */ 00565000
*/* NOW REFER TO START AND END OF WPL BY MOVING FIRST AND LAST BYTE  */ 00566000
*/* INTO XVD3. IF USER CAN NOT USE THE WPL THEN WE WILL GET A PROGRAM*/ 00567000
*/* CHECK, IF WE PROGRAM CHECK ESTAE WILL GET CONTROL. IT WILL TURN  */ 00568000
*/* XVD2VALD OFF AND WILL RETURN CONTROL TO VWTOCONT. WE SWITCH TO   */ 00569000
*/* THE USERS KEY AND THEN REFERENCE THE PARM LIST.                  */ 00570000
*/*                                                                  */ 00571000
*/********************************************************************/ 00572000
*                                                                  0230 00573000
*       /*************************************************************/ 00574000
*       /*                                                           */ 00575000
*       /* SWITCH TO THE USERS PROTECT KEY                           */ 00576000
*       /*                                                           */ 00577000
*       /*************************************************************/ 00578000
*                                                                  0230 00579000
*       PARMRTAD=ADDR(VWTOVALR);    /* RETRY AT VALCHK       @ZA05504*/ 00580000
         L     @10,PARMPTR                                         0230 00581000
         LA    @15,VWTOVALR                                        0230 00582000
         ST    @15,PARMRTAD(,@10)                                  0230 00583000
*       PARMNDMP='1'B;              /* IND. NO-DUMP TO RECOVERY RTN     00584000
*                                                            @ZA19994*/ 00585000
         OI    PARMNDMP(@10),B'00000100'                           0231 00586000
*       RFY                                                        0232 00587000
*         REG15 RSTD;                                              0232 00588000
*       GEN REFS(REG4,TCBRBP) SETS(REG15);                         0233 00589000
        USING TCB,REG4                                         YM0820   00590000
        MODESET EXTKEY=RBT234,WORKREG=15                                00591000
        DROP  REG4                                             YM0820   00592000
*       REG15=XVPARMAD->REFCHAR;    /* REFERENCE THE FIRST CHAR IN 0234 00593000
*                                      WPL.                          */ 00594000
         L     @10,XVPARMAD(,RBSECPTR)                             0234 00595000
         SLR   REG15,REG15                                         0234 00596000
         IC    REG15,REFCHAR(,@10)                                 0234 00597000
*       REG15=REG2->REFCHAR;        /* REFERENCE THE LAST CHAR IN THE   00598000
*                                      WPL                           */ 00599000
         SLR   REG15,REG15                                         0235 00600000
         IC    REG15,REFCHAR(,REG2)                                0235 00601000
*       RFY                                                        0236 00602000
*         REG15 UNRSTD;             /* RELEASE 15                    */ 00603000
*VWTOCONT:                                                         0237 00604000
*       ;                                                          0237 00605000
VWTOCONT DS    0H                                                  0238 00606000
*       GENERATE(MODESET  EXTKEY=SUPR)                             0238 00607000
*       REFS(REG4);                 /* SWITCH TO SUPERVISOR KEY      */ 00608000
         MODESET  EXTKEY=SUPR                                           00609000
*       PARMRTAD=0;                 /* ZERO RETRY ADDRESS    @ZA05504*/ 00610000
         SLR   @10,@10                                             0239 00611000
         L     @15,PARMPTR                                         0239 00612000
         ST    @10,PARMRTAD(,@15)                                  0239 00613000
*       PARMNDMP='0'B;              /* RESET DUMP IND.       @ZA19994*/ 00614000
         NI    PARMNDMP(@15),B'11111011'                           0240 00615000
*       IF XVD2WTOR='1'B&           /* IS THIS A WTOR AND IS THE PARM   00616000
*                                      LIST                          */ 00617000
*           XVPARMAD//4^=0          /* NOT ON A WORD BOUNDARY        */ 00618000
*         THEN                                                     0241 00619000
         TM    XVD2WTOR(RBSECPTR),B'00000010'                      0241 00620000
         BNO   @RF00241                                            0241 00621000
         L     @00,XVPARMAD(,RBSECPTR)                             0241 00622000
         SRDA  @00,32                                              0241 00623000
         D     @00,@CF00084                                        0241 00624000
         CR    @00,@10                                             0241 00625000
         BE    @RF00241                                            0241 00626000
*         XVD2VALD='0'B;            /* YES, TURN OFF VALID BIT IN  0242 00627000
*                                      XSA. THE PARM LIST ISN'T    0242 00628000
*                                      VALID.                        */ 00629000
         NI    XVD2VALD(RBSECPTR),B'11101111'                      0242 00630000
*     END;                          /* OF CHECK OF PARM LIST         */ 00631000
@RF00241 DS    0H                                                  0244 00632000
*/******* END OF VALIDITY CHECK **************************************/ 00633000
*/********************************************************************/ 00634000
*/*                                                                  */ 00635000
*/*  CHECK TO SEE IF THE PARAMETER LIST WAS FOUND TO BE INVALID.     */ 00636000
*/*  IF SO TURN ON THE ABEND INDICATOR. IF LIST IS VALID CONTINUE    */ 00637000
*/*  PROCESSING                                                      */ 00638000
*/*                                                                  */ 00639000
*/********************************************************************/ 00640000
*                                                                  0244 00641000
*   IF XVD2VALD='0'B THEN           /* IS VALID INDICATOR OFF MEANING   00642000
*                                      LIST IS NOT VALID             */ 00643000
@RF00228 TM    XVD2VALD(RBSECPTR),B'00010000'                      0244 00644000
         BNZ   @RF00244                                            0244 00645000
*     XVD1PERR='1'B;                /* YES - SET ABEND ERROR       0245 00646000
*                                      INDICATOR                     */ 00647000
         OI    XVD1PERR(RBSECPTR),B'00000001'                      0245 00648000
*   ELSE                            /* PARM LIST WAS VALID. PROCESS     00649000
*                                      IT                            */ 00650000
*     DO;                                                          0246 00651000
*                                                                  0246 00652000
         B     @RC00244                                            0246 00653000
@RF00244 DS    0H                                                  0247 00654000
*/********************************************************************/ 00655000
*/*                                                                  */ 00656000
*/*  TAKE THE INSTALLATION EXIT                                      */ 00657000
*/*                                                                  */ 00658000
*/********************************************************************/ 00659000
*/*** START OF USEREXIT **********************************************/ 00660000
*/********************************************************************/ 00661000
*/*                                                                  */ 00662000
*/*   USEREXIT - SET UP AND TAKE INSTALLATION WTO EXIT               */ 00663000
*/*                                                                  */ 00664000
*/*  INPUT -                                                         */ 00665000
*/*   REG2 POINTS AT THE LAST BYTE IN THE WQE                        */ 00666000
*/*    REG 6 POINTS AT THE BEGINNING OF THE MESSAGE PART OF THE WPL  */ 00667000
*/*    REG 8 POINTS AT THE FLAGS PART OF THE WPL.                    */ 00668000
*/*                                                                  */ 00669000
*/*  OUTPUT -                                                        */ 00670000
*/*    XVRCSAVE AND XVDESCD CONTAIN THE ROUTE AND DESCRIPTOR CODES   */ 00671000
*/*    BE USED IN THE WQE.                                           */ 00672000
*/*    XVMSGTYP IS FILLED FROM WPL IF MSGTYP WAS SPECIFIED.          */ 00673000
*/*    REGS 2 AND 8 ARE NO LONGER NEEDED.                            */ 00674000
*/*    XVD2DELW IS ON IF THE MESSAGE IS NOT TO GO TO THE CONSOLE BUT */ 00675000
*/*    TO HARDCOPY ONLY.                                             */ 00676000
*/*                                                                  */ 00677000
*/********************************************************************/ 00678000
*/********************************************************************/ 00679000
*/*                                                                  */ 00680000
*/* CHECK THAT THIS IS NOT A CONNECTING MLWTO, CONNECTING MLWTOS DO  */ 00681000
*/* NOT GET SENT TO THE INSTALLATION EXIT UNLESS ISSUED      @YM7297P*/ 00682000
*/* FROM A PROBLEM PROGRAM                                   @YM7297P*/ 00683000
*/*                                                          @YM7297P*/ 00684000
*/* THE INSTALLATION USER EXIT WILL BE TAKEN FOR ANY OF      @YM7297P*/ 00685000
*/* THESE THREE SITUATIONS:                                  @YM7297P*/ 00686000
*/*                                                          @YM7297P*/ 00687000
*/*    1. THE WTO IS NOT A MULTI-LINE REQUEST                @YM7297P*/ 00688000
*/*         OR                                               @YM7297P*/ 00689000
*/*    2. THE MLWTO IS NOT A CONNECTING MLWTO REQUEST        @YM7297P*/ 00690000
*/*         OR                                               @YM7297P*/ 00691000
*/*    3. THE CONNECTING MLWTO REQUEST IS ISSUED FROM A      @YM7297P*/ 00692000
*/*           PROBLEM PROGRAM                                @YM7297P*/ 00693000
*/*                                                          @YM7297P*/ 00694000
*/* THE ONLY OTHER SITUATION IS IF A CONNECTING MLWTO IS     @YM7297P*/ 00695000
*/* ISSUED FROM SUPERVISOR STATE                             @YM7297P*/ 00696000
*/*      FOR THIS CASE, DO NOT TAKE THE USER EXIT            @YM7297P*/ 00697000
*/*                                                          @YM7297P*/ 00698000
*/*                                                                  */ 00699000
*/********************************************************************/ 00700000
*                                                                  0247 00701000
*       IF WPLMCSFJ^='1'B|          /* SITUATION 1. ABOVE    @YM3471P*/ 00702000
*           XVWQEIDA=0|             /* SITUATION 2. ABOVE    @YM7297P*/ 00703000
*           XVD1PP='1'B THEN        /* SITUATION 3. ABOVE    @YM7297P*/ 00704000
         TM    WPLMCSFJ(REG6),B'01000000'                          0247 00705000
         BNO   @RT00247                                            0247 00706000
         ICM   @10,7,XVWQEIDA(RBSECPTR)                            0247 00707000
         BZ    @RT00247                                            0247 00708000
         TM    XVD1PP(RBSECPTR),B'00000100'                        0247 00709000
         BNO   @RF00247                                            0247 00710000
@RT00247 DS    0H                                                  0248 00711000
*         DO;                       /* NO, THIS IS NOT A CONNECTING     00712000
*                                      MLWTO UNLESS ISSUED FROM A  0248 00713000
*                                      PROBLEM PROGRAM       @YM7297P*/ 00714000
*/********************************************************************/ 00715000
*/*                                                                  */ 00716000
*/* CHECK IF WE SHOULD USE THE DEFAULTS FOR ROUTE & DESC CODES BY    */ 00717000
*/* CHECKING IF THIS IS AN OLD STYLE MESSAGE WHICH HAS NO MCS FLAGS  */ 00718000
*/*                                                                  */ 00719000
*/********************************************************************/ 00720000
*                                                                  0249 00721000
*           IF WPLMCSF=0 THEN       /* ARE THERE NO MCS FLAGS IN THE    00722000
*                                      WPL                           */ 00723000
         LH    @10,WPLMCSF(,REG6)                                  0249 00724000
         N     @10,@CF03329                                        0249 00725000
         LTR   @10,@10                                             0249 00726000
         BNZ   @RF00249                                            0249 00727000
*             DO;                   /* YES, USE DEFAULTS             */ 00728000
*               XVRCSAVE=UCMOWTOR;  /* GET DEFAULT ROUTE CODES FROM     00729000
*                                      UCM                           */ 00730000
         L     @10,UCMBASPT(,REG3)                                 0251 00731000
         AL    @10,@CF03336                                        0251 00732000
         L     @10,UCMMCSPT(,@10)                                  0251 00733000
         MVC   XVRCSAVE(2,RBSECPTR),UCMOWTOR(@10)                  0251 00734000
*               XVDESCD='2000'X;    /* DESC CODE DEFAULT = EVENTUAL     00735000
*                                      ACTION REQUIRED MESSAGE       */ 00736000
         MVC   XVDESCD(2,RBSECPTR),@CB03252                        0252 00737000
*               XVD2RDC='1'B;       /* R/D CODES ARE PRESENT         */ 00738000
         OI    XVD2RDC(RBSECPTR),B'01000000'                       0253 00739000
*             END;                                                 0254 00740000
*           ELSE                    /* NO, CHECK IF R/D CODES PRESENT*/ 00741000
*             IF XVD2RDC='1'B THEN  /* WERE R/D CODES SUPPLIED IN WPL*/ 00742000
         B     @RC00249                                            0255 00743000
@RF00249 TM    XVD2RDC(RBSECPTR),B'01000000'                       0255 00744000
         BNO   @RF00255                                            0255 00745000
*               DO;                 /* PICK THEM UP                  */ 00746000
*                 XVRCSAVE=WPLROUT;                                0257 00747000
         MVC   XVRCSAVE(2,RBSECPTR),WPLROUT(REG8)                  0257 00748000
*                 XVDESCD=WPLDESC;                                 0258 00749000
         MVC   XVDESCD(2,RBSECPTR),WPLDESC(REG8)                   0258 00750000
*               END;                                               0259 00751000
*                                                                  0259 00752000
*           /*********************************************************/ 00753000
*           /*                                                       */ 00754000
*           /* IF NO R/D CODES SUPPLIED AND DEFULAT CODES WEREN'T    */ 00755000
*           /* USED THEN R/D CODES ARE ZERO FROM INITIALIZATION.     */ 00756000
*           /*                                                       */ 00757000
*           /*********************************************************/ 00758000
*                                                                  0260 00759000
*/********************************************************************/ 00760000
*/*                                                                  */ 00761000
*/* PICK UP THE MSGTYPE FIELD FROM THE WPL. THIS IS DONE SO THAT     */ 00762000
*/* REG 8 CAN BE RELEASED. THE ROUTE CODES, DESC CODES AND MSGTYPE   */ 00763000
*/* WILL THUS BE ALL STORED IN XVRDMSV.                              */ 00764000
*/*                                                                  */ 00765000
*/********************************************************************/ 00766000
*                                                                  0260 00767000
*           IF XVD2MSGT='1'B THEN   /* WAS MSGTYP SPECIFED?          */ 00768000
@RF00255 DS    0H                                                  0260 00769000
@RC00249 TM    XVD2MSGT(RBSECPTR),B'00100000'                      0260 00770000
         BNO   @RF00260                                            0260 00771000
*             XVMSGTYP=WPLMSGTY;    /* YES, MOVE IN MSGTYP FIELD.    */ 00772000
         MVC   XVMSGTYP(2,RBSECPTR),WPLMSGTY(REG8)                 0261 00773000
*           RFY                                                    0262 00774000
*             REG8 UNRSTD;          /* RELEASE REG 8                 */ 00775000
@RF00260 DS    0H                                                  0263 00776000
*/********************************************************************/ 00777000
*/*                                                                  */ 00778000
*/* CHECK FOR AN INTERNAL MESSAGE (ONE THAT IS AUTHORIZED AND HAS ANY*/ 00779000
*/* MCSFLAGS(2-8) ON). IF IT IS AN INTERNAL MESSAGE THEN SKIP THE    */ 00780000
*/* INSTALLATION EXIT. CHECK ALSO THAT THE MSG LENGTH IS GREATER THAN*/ 00781000
*/* ZERO (THAT XVMSGLGH > 4 ).                                       */ 00782000
*/*                                                                  */ 00783000
*/********************************************************************/ 00784000
*                                                                  0263 00785000
*           IF^(XVD1AUTH='1'B&      /* DO WE NOT HAVE THE FOLLOWING:    00786000
*                                      ( IS THE USER AUTHORIZED AND     00787000
*                                      ARE ANY SYSTEM RELATED      0263 00788000
*                                      MCSFLAGS BITS TURNED ON (BITS    00789000
*                                      2 TO 8) ) AND THAT THE TEXT 0263 00790000
*                                      LENGTH IS > FOUR              */ 00791000
*               WPLMCSF1(2:8)^='0000000'B)&XVMSGLGH>4 THEN         0263 00792000
         TM    XVD1AUTH(RBSECPTR),B'00000010'                      0263 00793000
         BNO   @GL00007                                            0263 00794000
         TM    WPLMCSF1(REG6),B'01111111'                          0263 00795000
         BNZ   @RF00263                                            0263 00796000
@GL00007 LH    @10,XVMSGLGH(,RBSECPTR)                             0263 00797000
         C     @10,@CF00084                                        0263 00798000
         BNH   @RF00263                                            0263 00799000
*             DO;                   /* YES, THEN MESSAGE IS NOT A  0264 00800000
*                                      SYSTEM INTERNALLY GENERATED 0264 00801000
*                                      ONE. TAKE EXIT                */ 00802000
*                                                                  0264 00803000
*               /*****************************************************/ 00804000
*               /*                                                   */ 00805000
*               /* FILL IN THS INSTALLATION EXIT'S PARAMETER LIST.   */ 00806000
*               /* MOVE IN THE MESSAGE FROM THE WPL                  */ 00807000
*               /*                                                   */ 00808000
*               /*****************************************************/ 00809000
*                                                                  0265 00810000
*               USERTEXT=WPLTXT(1:XVMSGLGH-4);                     0265 00811000
         MVI   USERTEXT+1,C' '                                     0265 00812000
         MVC   USERTEXT+2(126),USERTEXT+1                          0265 00813000
         SL    @10,@CF01082                                        0265 00814000
         EX    @10,@SM03337                                        0265 00815000
*               USERROUT=0;         /* INIT THE ROUTE AND DESC CODES    00816000
*                                      TO                            */ 00817000
         SLR   @10,@10                                             0266 00818000
         ST    @10,USERROUT                                        0266 00819000
*               USERDESC=0;         /* ZERO.                         */ 00820000
         ST    @10,USERDESC                                        0267 00821000
*               USERRC=XVRCSAVE;    /* PUT THE ROUTE/DESC CODES INTO    00822000
*                                      THE                           */ 00823000
         MVC   USERRC(2),XVRCSAVE(RBSECPTR)                        0268 00824000
*               USERDC=XVDESCD;     /* PARM LIST FOR THE USER EXIT   */ 00825000
*                                                                  0269 00826000
         MVC   USERDC(2),XVDESCD(RBSECPTR)                         0269 00827000
*               /*****************************************************/ 00828000
*               /*                                                   */ 00829000
*               /* SET UP FOOT PRINT AROUND USER EXIT                */ 00830000
*               /*                                                   */ 00831000
*               /*****************************************************/ 00832000
*                                                                  0270 00833000
*               STM(REG0,REG15,RECREGS);/* SAVE CURRENT REGS @ZA13440*/ 00834000
         STM   REG0,REG15,RECREGS                                  0270 00835000
*               PARMFTPT=FTUSERX;   /* INSALLATION'S EXIT WAS CALLED */ 00836000
         L     @08,PARMPTR                                         0271 00837000
         MVI   PARMFTPT(@08),X'03'                                 0271 00838000
*               PARMCLAD=0;         /* NO CLEAN UP ROUTINE   @ZA13440*/ 00839000
         ST    @10,PARMCLAD(,@08)                                  0272 00840000
*               PARMRTAD=0;         /* NO RETRY ADDR         @ZA13440*/ 00841000
*                                                                  0273 00842000
         ST    @10,PARMRTAD(,@08)                                  0273 00843000
*               /*****************************************************/ 00844000
*               /*                                                   */ 00845000
*               /* CALL INSTALLATION EXIT ROUTINE                    */ 00846000
*               /*                                                   */ 00847000
*               /*****************************************************/ 00848000
*                                                                  0274 00849000
*               CALL IEECVXIT(USERPARM);                           0274 00850000
*                                                                  0274 00851000
         LA    @10,USERPARM                                        0274 00852000
         ST    @10,@AL00001                                        0274 00853000
         L     @15,@CV00207                                        0274 00854000
         LA    @01,@AL00001                                        0274 00855000
         BALR  @14,@15                                             0274 00856000
*               /*****************************************************/ 00857000
*               /*                                                   */ 00858000
*               /* RESTORE THE FOOTPRINTS AFTER THE EXIT ROUTINE     */ 00859000
*               /*                                                   */ 00860000
*               /*****************************************************/ 00861000
*                                                                  0275 00862000
*               PARMFTPT=FTAFUX;                                   0275 00863000
         L     @10,PARMPTR                                         0275 00864000
         MVI   PARMFTPT(@10),X'04'                                 0275 00865000
*               XVNEWRC=USERRC;     /* PICK UP CHANGED ROUTE/DESC  0276 00866000
*                                      CODES                         */ 00867000
         MVC   XVNEWRC(2,RBSECPTR),USERRC                          0276 00868000
*               XVNEWDC=USERDC;                                    0277 00869000
*                                                                  0277 00870000
         MVC   XVNEWDC(2,RBSECPTR),USERDC                          0277 00871000
*/********************************************************************/ 00872000
*/*                                                                  */ 00873000
*/* CHECK IF THE ROUTE CODES WERE CHANGED.                           */ 00874000
*/*                                                                  */ 00875000
*/********************************************************************/ 00876000
*                                                                  0278 00877000
*               IF XVRCSAVE^=       /* WERE ROUTE CODES CHANGED?     */ 00878000
*                   XVNEWRC THEN                                   0278 00879000
         CLC   XVRCSAVE(2,RBSECPTR),XVNEWRC(RBSECPTR)              0278 00880000
         BE    @RF00278                                            0278 00881000
*                 DO;               /* YES, PROCESS CHANGED ROUTE  0279 00882000
*                                      CODE                          */ 00883000
*                   XVD2QFHC='1'B;  /* INDICATE MSG IS TO BE QUEUED     00884000
*                                      FOR HC                        */ 00885000
         OI    XVD2QFHC(RBSECPTR),B'00000001'                      0280 00886000
*/********************************************************************/ 00887000
*/*                                                                  */ 00888000
*/* CHECK IF ROUTE CODE WAS CHANGED TO ZERO, INDICATING THAT THIS    */ 00889000
*/*  MESSAGE SHOULDN'T GO TO THE CONSOLE.                            */ 00890000
*/*                                                                  */ 00891000
*/********************************************************************/ 00892000
*                                                                  0281 00893000
*                   IF XVNEWRC=0 THEN                              0281 00894000
*                                                                  0281 00895000
         LH    @10,XVNEWRC(,RBSECPTR)                              0281 00896000
         N     @10,@CF03329                                        0281 00897000
         LTR   @10,@10                                             0281 00898000
         BNZ   @RF00281                                            0281 00899000
*/********************************************************************/ 00900000
*/*                                                                  */ 00901000
*/* CHECK IF THIS IS A WTOR. IF SO THEN IGNORE REQUEST TO DELETE     */ 00902000
*/* MESSAGE (ZERO ROUTE CODE. IF WTO, DELETE MESSAGE. SEND JUST TO   */ 00903000
*/* HARDCOPY.                                                        */ 00904000
*/*                                                                  */ 00905000
*/********************************************************************/ 00906000
*                                                                  0282 00907000
*                     IF XVD2WTOR='1'B THEN                        0282 00908000
         TM    XVD2WTOR(RBSECPTR),B'00000010'                      0282 00909000
         BNO   @RF00282                                            0282 00910000
*                       DO;         /* PUT IN WTOR ROUTE CODES       */ 00911000
*                                                                  0283 00912000
*                         /*******************************************/ 00913000
*                         /*                                         */ 00914000
*                         /* ROUTE WTOR TO MASTER CONSOLE            */ 00915000
*                         /*                                         */ 00916000
*                         /*******************************************/ 00917000
*                                                                  0284 00918000
*                         XVRCSAVE='8000'X;                        0284 00919000
         MVC   XVRCSAVE(2,RBSECPTR),@CB03254                       0284 00920000
*                         XVD2RDC='1'B;/* TURN ON ROUTE CODES PRESENT   00921000
*                                      FLAGS                         */ 00922000
         OI    XVD2RDC(RBSECPTR),B'01000000'                       0285 00923000
*                       END;                                       0286 00924000
*                     ELSE          /* NOT A WTOR. INDICATE SEND MSG    00925000
*                                      TO HARDCOPY ONLY.             */ 00926000
*                       XVD2DELW='1'B;                             0287 00927000
*                                                                  0287 00928000
         B     @RC00282                                            0287 00929000
@RF00282 OI    XVD2DELW(RBSECPTR),B'00001000'                      0287 00930000
*/********************************************************************/ 00931000
*/*                                                                  */ 00932000
*/* NO, THE ROUTE CODE WASNT SET TO ZERO, BUT IT IS CHANGED. PICK    */ 00933000
*/* UP THE NEW ROUTE CODES FOR USE LATER IN BUILDING THE WQE.        */ 00934000
*/* ALSO PASS THE NEW ROUTE CODES TO WTP IF ROUTE CODE 11 IS SET.    */ 00935000
*/*                                                                  */ 00936000
*/********************************************************************/ 00937000
*                                                                  0288 00938000
*                   ELSE                                           0288 00939000
*                     XVRCSAVE=XVNEWRC;/* MOVE NEW ROUTECODES TO SAFE   00940000
*                                      PLACE                         */ 00941000
         B     @RC00281                                            0288 00942000
@RF00281 MVC   XVRCSAVE(2,RBSECPTR),XVNEWRC(RBSECPTR)              0288 00943000
*                 END;              /* OF PROCESSING CHANGED ROUTE 0289 00944000
*                                      CODES                         */ 00945000
@RC00281 DS    0H                                                  0290 00946000
*               IF XVDESCD^=XVNEWDC THEN/* WERE DESC. CODE CHANGED 0290 00947000
*                                                            @ZA05801*/ 00948000
@RF00278 CLC   XVDESCD(2,RBSECPTR),XVNEWDC(RBSECPTR)               0290 00949000
         BE    @RF00290                                            0290 00950000
*                 DO;               /* SAVE DESC CODES       @ZA05801*/ 00951000
*                   XVDESCD=XVNEWDC;/* SAVE USER CHANGES     @ZA05801*/ 00952000
         MVC   XVDESCD(2,RBSECPTR),XVNEWDC(RBSECPTR)               0292 00953000
*                   XVD2QFHC='1'B;  /* INDICATE HARDCOPY MSG @ZA05801*/ 00954000
         OI    XVD2QFHC(RBSECPTR),B'00000001'                      0293 00955000
*                 END;                                             0294 00956000
*             END;                  /* OF PROCESSING NON-INTERNAL  0295 00957000
*                                      MSG-S                         */ 00958000
@RF00290 DS    0H                                                  0296 00959000
*         END;                      /* OF PROCESSING NON-CONNENCTING    00960000
*                                      MSGS                          */ 00961000
@RF00263 DS    0H                                                  0297 00962000
*/********************************************************************/ 00963000
*/*                                                                  */ 00964000
*/* AT THIS POINT XVRCSAVE AND XVDESCD CONTAIN THE ROUTE AND         */ 00965000
*/* DESCRIPTOR CODES AND MSGTYP FIELD TO BE USED BY THIS MESSAGE.    */ 00966000
*/*                                                                  */ 00967000
*/********************************************************************/ 00968000
*                                                                  0297 00969000
*       RFY                                                        0297 00970000
*         REG2 UNRSTD;              /* RELEASE PTR TO LAST BYTE IN 0297 00971000
*                                      WPL                           */ 00972000
@RF00247 DS    0H                                                  0298 00973000
*/********************************************************************/ 00974000
*/*                                                                  */ 00975000
*/***** RE-BASE WPL TO BE THE XSA. FUTURE REFERENCES OF      @ZA14991*/ 00976000
*/***** ROUT AND DESC CODES IN WPL WILL ACTUALLY REFERENCE   @ZA14991*/ 00977000
*/***** THE XSA. THIS WAS DONE BECAUSE THE USER EXIT COULD   @ZA14991*/ 00978000
*/***** HAVE CHANGED THE ROUTE AND DESCRIPTOR CODES. THESE   @ZA14991*/ 00979000
*/***** ARE SAVED IN THE XSA SO AFTER THIS POINT THE CHANGED @ZA14991*/ 00980000
*/***** VALUES WILL BE REFERENCED INSTEAD OF THE VALUES      @ZA14991*/ 00981000
*/***** SPECIFIED IN THE WPL.                                @ZA14991*/ 00982000
*/*                                                                  */ 00983000
*/***** NOTE - IF THE ORDERING OF THE SEGMENTS OF THIS       @ZA14991*/ 00984000
*/*****        MODULE ARE CHANGED, THEN THIS RESPECIFY MAY   @ZA14991*/ 00985000
*/*****        CAUSE THE COMPILER TO REFERENCE THE WRONG     @ZA14991*/ 00986000
*/*****        AREA FOR THE WPL.                             @ZA14991*/ 00987000
*/*                                                                  */ 00988000
*/********************************************************************/ 00989000
*                                                                  0298 00990000
*       RFY                                                        0298 00991000
*         WPLFLGS BASED(ADDR(XVRDMSV));                            0298 00992000
*                                                                  0298 00993000
*/***** END OF USER EXIT SEGMENT *************************************/ 00994000
*/********************************************************************/ 00995000
*/*                                                                  */ 00996000
*/*  SEE IF A MULTI-LINE WTO WAS ISSUED. IF SO CALL IEAVMWTO         */ 00997000
*/*                                                                  */ 00998000
*/********************************************************************/ 00999000
*                                                                  0299 01000000
*       IF WPLMCSFJ='1'B THEN       /* IS MULTI-LINE BIT SET IN WPL  */ 01001000
         TM    WPLMCSFJ(REG6),B'01000000'                          0299 01002000
         BNO   @RF00299                                            0299 01003000
*         DO;                       /* YES, GO TO PROCESS MULTI-LINE */ 01004000
*           RFY                                                    0301 01005000
*             REG10 RSTD;                                          0301 01006000
*           PARMFTPT=FTMLWTO;       /* START OF MLWTO PROCESSING     */ 01007000
         L     @08,PARMPTR                                         0302 01008000
         MVI   PARMFTPT(@08),X'05'                                 0302 01009000
*           PARMRTAD=0;             /* DON'T RETRY. MLWTO DETECTS THE   01010000
*                                      ERROR                         */ 01011000
         SLR   @02,@02                                             0303 01012000
         ST    @02,PARMRTAD(,@08)                                  0303 01013000
*           REG6=XVPARMAD;          /* GET PTR TO USERS PARM LIST    */ 01014000
         L     REG6,XVPARMAD(,RBSECPTR)                            0304 01015000
*           REG10=UCMBASPT;         /* SET REG 10 POINTING AT THE UCM*/ 01016000
         L     REG10,UCMBASPT(,REG3)                               0305 01017000
*           CALL IEAVMWTO;          /* PROCESS MULTI-LINE            */ 01018000
         L     @15,@CV00206                                        0306 01019000
         BALR  @14,@15                                             0306 01020000
*           PARMFTPT=FTSWTO;        /* START OF WTO BLOCK PROCESSING */ 01021000
         L     @08,PARMPTR                                         0307 01022000
         MVI   PARMFTPT(@08),X'06'                                 0307 01023000
*           RFY                                                    0308 01024000
*             REG10 UNRSTD;                                        0308 01025000
*         END;                                                     0309 01026000
*       ELSE                        /* NO, SINGLE LINE SPECIFIED     */ 01027000
*/********************************************************************/ 01028000
*/*                                                                  */ 01029000
*/* CHECK TO SEE IF PARM LIST LENGTH IS LESS THAN OR EQUAL TO FOUR.  */ 01030000
*/* IF SO THEN THE MSGLENGTH IS ZERO. THIS IS AN ABEND               */ 01031000
*/* SITUATION FOR WTORS.                                             */ 01032000
*/*                                                                  */ 01033000
*/********************************************************************/ 01034000
*                                                                  0310 01035000
*         IF XVMSGLGH<=4 THEN       /* DOES LENGTH SHOW ZERO MSG   0310 01036000
*                                      LENGTH                        */ 01037000
         B     @RC00299                                            0310 01038000
@RF00299 LH    @10,XVMSGLGH(,RBSECPTR)                             0310 01039000
         C     @10,@CF00084                                        0310 01040000
         BH    @RF00310                                            0310 01041000
*/********************************************************************/ 01042000
*/*                                                                  */ 01043000
*/* CHECK FOR WTOR. IF WTOR, THEN  SET ABEND BIT. IF WTO, THEN  SET  */ 01044000
*/* THE NO MESSAGE BIT ON (XVD2ZERO).                                */ 01045000
*/*                                                                  */ 01046000
*/********************************************************************/ 01047000
*                                                                  0311 01048000
*           IF XVD2WTOR='1'B THEN   /* IS THIS A WTOR REQUEST        */ 01049000
         TM    XVD2WTOR(RBSECPTR),B'00000010'                      0311 01050000
         BNO   @RF00311                                            0311 01051000
*             XVD1PERR='1'B;        /* YES, SET ABEND ERROR SITUATION   01052000
*                                      BIT                           */ 01053000
         OI    XVD1PERR(RBSECPTR),B'00000001'                      0312 01054000
*           ELSE                    /* NO, INDICATE RETURN ZERO MSG     01055000
*                                      ID TO                         */ 01056000
*             XVD2ZERO='1'B;        /* THE USER                      */ 01057000
         B     @RC00311                                            0313 01058000
@RF00311 OI    XVD2ZERO(RBSECPTR),B'00000100'                      0313 01059000
*/********************************************************************/ 01060000
*/*                                                                  */ 01061000
*/* MESSAGE LENGTH WAS NOT ZERO. PROCESS GOOD MESSAGE                */ 01062000
*/*                                                                  */ 01063000
*/********************************************************************/ 01064000
*                                                                  0314 01065000
*         ELSE                                                     0314 01066000
*           DO;                                                    0314 01067000
*                                                                  0314 01068000
         B     @RC00310                                            0314 01069000
@RF00310 DS    0H                                                  0315 01070000
*/********************************************************************/ 01071000
*/*                                                                  */ 01072000
*/* CHECK FOR WRITE TO PROGRAMMER (ROUTE CODE 11). IF WTP WAS SPECI- */ 01073000
*/* FIED THEN CALL WTP. WTP WILL RETURN CONTROL TO VWTO.             */ 01074000
*/*  ON RETURN FROM WTP THE XVD0USER BIT WILL BE ON IF THE MESSAGE   */ 01075000
*/* WAS A WTP MESSAGE ONLY.  THIS MEANS THAT THERE IS NOTHING FOR    */ 01076000
*/*  VWTO TO DO.                                                     */ 01077000
*/*                                                                  */ 01078000
*/********************************************************************/ 01079000
*                                                                  0315 01080000
*             XVD0USER='0'B;        /* INSURE THAT RETURN BIT FROM 0315 01081000
*                                      WTP IS SET TO INDICATE      0315 01082000
*                                      CONTINUE PROCESSING           */ 01083000
         NI    XVD0USER(RBSECPTR),B'11111101'                      0315 01084000
*             IF XVD2RDC='1'B&      /* WERE ROUTE CODES SPECIFIED    */ 01085000
*                 WPLROUTK='1'B THEN/* AND WTP SPECIFIED             */ 01086000
         TM    XVD2RDC(RBSECPTR),B'01000000'                       0316 01087000
         BNO   @RF00316                                            0316 01088000
         TM    WPLROUTK+108(RBSECPTR),B'00100000'                  0316 01089000
         BNO   @RF00316                                            0316 01090000
*               DO;                 /* GO TO WTP. WTP WILL RETURN TO    01091000
*                                      US                            */ 01092000
*                 RFY                                              0318 01093000
*                   REG10 RSTD;                                    0318 01094000
*                 REG10=UCMBASPT;   /* SET UP PTR TO UCM FOR WTP     */ 01095000
         L     REG10,UCMBASPT(,REG3)                               0319 01096000
*                 CALL IGC0203E;    /* CALL ON WTP                   */ 01097000
         L     @15,@CV00208                                        0320 01098000
         BALR  @14,@15                                             0320 01099000
*                 RFY                                              0321 01100000
*                   REG10 UNRSTD;                                  0321 01101000
*               END;                                               0322 01102000
*                                                                  0322 01103000
*             /*******************************************************/ 01104000
*             /*                                                     */ 01105000
*             /* CHECK IF WTP FOUND THAT THERE WAS NO MORE PROCESSING*/ 01106000
*             /* FOR US TO DO WITH THIS MESSAGE. IF SO SET XVD2ZERO  */ 01107000
*             /* ON SO THAT A ZERO MESSAGE ID GETS PASSED TO THE     */ 01108000
*             /* USER.                                               */ 01109000
*             /*                                                     */ 01110000
*             /*******************************************************/ 01111000
*                                                                  0323 01112000
*             IF XVD0USER='1'B THEN /* DID RETURN TO USER BIT GET SET   01113000
*                                      BY THE WTP ROUTINE.           */ 01114000
@RF00316 TM    XVD0USER(RBSECPTR),B'00000010'                      0323 01115000
         BNO   @RF00323                                            0323 01116000
*               XVD2ZERO='1'B;      /* YES. INDICATE ZERO MSG ID TO     01117000
*                                      BE RETURNED TO CALLER AND SKIP   01118000
*                                      THE REST OF THE PROCESSING.   */ 01119000
         OI    XVD2ZERO(RBSECPTR),B'00000100'                      0324 01120000
*             ELSE                  /* NO. PROCESS THE MESSAGE       */ 01121000
*               DO;                                                0325 01122000
*                                                                  0325 01123000
         B     @RC00323                                            0325 01124000
@RF00323 DS    0H                                                  0326 01125000
*/********************************************************************/ 01126000
*/*                                                                  */ 01127000
*/* SET UP NEEDED LOCKS AND FRR                                      */ 01128000
*/*                                                                  */ 01129000
*/********************************************************************/ 01130000
*                                                                  0326 01131000
*                 CALL SETLOCK;                                    0326 01132000
*                                                                  0326 01133000
         BAL   @14,SETLOCK                                         0326 01134000
*                 /***************************************************/ 01135000
*                 /*                                                 */ 01136000
*                 /* SET UP THE FOOTPRINT TO COVER THE BUILDING OF   */ 01137000
*                 /* THE ORE AND THE WQES. IF THER IS A PROBLEM THEN */ 01138000
*                 /* VWTOCLNP WILL ATTEMPT TO CLEAN UP THE CONTROL   */ 01139000
*                 /* BLOCKS.                                         */ 01140000
*                 /*                                                 */ 01141000
*                 /***************************************************/ 01142000
*                                                                  0327 01143000
*                 PARMFTPT=FTCTLBLK;/* START OF CONTROL BLOCK      0327 01144000
*                                      PROCESSING                    */ 01145000
         L     @10,PARMPTR                                         0327 01146000
         MVI   PARMFTPT(@10),X'07'                                 0327 01147000
*                 PARMCLAD=ADDR(VWTOCLNP);/* ADDRESS OF CLEAN UP   0328 01148000
*                                      ROUTINE                       */ 01149000
         LA    @08,VWTOCLNP                                        0328 01150000
         ST    @08,PARMCLAD(,@10)                                  0328 01151000
*/********************************************************************/ 01152000
*/*                                                                  */ 01153000
*/* GET THE NEEDED CONTROL BLOCKS                                    */ 01154000
*/*                                                                  */ 01155000
*/********************************************************************/ 01156000
*/*** START OF GETBLKS  **********************************************/ 01157000
*/*                                                                  */ 01158000
*/*   GETBLKS - GET AN ORE AND/OR A WQE                              */ 01159000
*/*                                                                  */ 01160000
*/*   INPUT - XVD2WTOR IF ON INDICATES AN ORE AND WQE ARE NEEDED.    */ 01161000
*/*           IF OFF THEN JUST A WQE IS NEEDED.                      */ 01162000
*/*           XVD1PRIV INDICATES WHETHER THIS USER IS A PRIVILEGED   */ 01163000
*/*           TASK                                                   */ 01164000
*/*                                                                  */ 01165000
*/*   OUTPUT - XVOREAD POINTS AT THE ZEROED ORE                      */ 01166000
*/*            XVWQEAD POINTS AT THE ZEROED WQE                      */ 01167000
*/*            XVD1PERR IS ON IF CORE WAS NOT AVAILABLE.             */ 01168000
*/*                                                                  */ 01169000
*/********************************************************************/ 01170000
*/*                                                                  */ 01171000
*/*  TURN OFF DO LOOP AND ECB INDICATORS                             */ 01172000
*/*                                                                  */ 01173000
*/********************************************************************/ 01174000
*                                                                  0329 01175000
*                 XVD1ALDN='0'B;    /* INIT TO NOT ALL DONE          */ 01176000
         NI    XVD1ALDN(RBSECPTR),B'11011111'                      0329 01177000
*                 XVD0WWB='0'B;     /* INDICATE NO WTO WAIT BLOCK  0330 01178000
*                                      OBTAINED                      */ 01179000
         NI    XVD0WWB(RBSECPTR),B'11111011'                       0330 01180000
*/********************************************************************/ 01181000
*/*                                                                  */ 01182000
*/*  CHECK FOR A WTOR. IF SO INDICATE THAT AN ORE IS NEEDED FIRST    */ 01183000
*/*                                                                  */ 01184000
*/********************************************************************/ 01185000
*                                                                  0331 01186000
*                 IF XVD2WTOR='1'B THEN/* IS THIS REQUEST A WTOR     */ 01187000
         TM    XVD2WTOR(RBSECPTR),B'00000010'                      0331 01188000
         BNO   @RF00331                                            0331 01189000
*                   DO;             /* YES                           */ 01190000
*                     XVD0NORE='1'B;/* GET THE ORE FIRST             */ 01191000
*                     XVD0NWQE='0'B;/* THEN GET THE WQE              */ 01192000
         OI    XVD0NORE(RBSECPTR),B'00010000'                      0334 01193000
         NI    XVD0NWQE(RBSECPTR),B'11011111'                      0334 01194000
*                   END;                                           0335 01195000
*                 ELSE              /* NO, THIS IS A WTO             */ 01196000
*                   DO;                                            0336 01197000
         B     @RC00331                                            0336 01198000
@RF00331 DS    0H                                                  0337 01199000
*                     XVD0NORE='0'B;/* WE DONT NEED AN ORE           */ 01200000
*                     XVD0NWQE='1'B;/* BUT WE DO NEED A WQE          */ 01201000
         OI    XVD0NWQE(RBSECPTR),B'00100000'                      0338 01202000
         NI    XVD0NORE(RBSECPTR),B'11101111'                      0338 01203000
*                   END;                                           0339 01204000
*                                                                  0339 01205000
*/********************************************************************/ 01206000
*/*                                                                  */ 01207000
*/*  WE WILL ATTEMPT TO GET A WQE OR AN ORE, A REPLY ID AND A WQE,   */ 01208000
*/*  WE WILL LOOP UNTIL ALL NEEDED BLOCKS HAVE BEEN OBTAINED.        */ 01209000
*/*                                                                  */ 01210000
*/********************************************************************/ 01211000
*                                                                  0340 01212000
*                 DO WHILE(XVD1ALDN='0'B);/* LOOP UNTIL WE ARE DONE  */ 01213000
@RC00331 B     @DE00340                                            0340 01214000
@DL00340 DS    0H                                                  0341 01215000
*/********************************************************************/ 01216000
*/*                                                                  */ 01217000
*/*  CHECK IF WE STILL NEED TO GET AN ORE. IF SO GET ONE             */ 01218000
*/*                                                                  */ 01219000
*/********************************************************************/ 01220000
*                                                                  0341 01221000
*                   IF XVD0NORE='1'B THEN                          0341 01222000
*                                                                  0341 01223000
         TM    XVD0NORE(RBSECPTR),B'00010000'                      0341 01224000
         BNO   @RF00341                                            0341 01225000
*/********************************************************************/ 01226000
*/*                                                                  */ 01227000
*/*  CHECK IF AN ORE IS AVAILABLE                                    */ 01228000
*/*                                                                  */ 01229000
*/********************************************************************/ 01230000
*                                                                  0342 01231000
*                     IF UCMRQNR<UCMRQLM|/* IS THE NUMBER ORES LESS     01232000
*                                      THAN LIMIT                    */ 01233000
*                         XVD1PRIV='1'B THEN/* OR IS THE USER A    0342 01234000
*                                      PRIVILEGED TASK               */ 01235000
         L     @10,UCMBASPT(,REG3)                                 0342 01236000
         LH    @08,UCMRQNR(,@10)                                   0342 01237000
         SLR   @02,@02                                             0342 01238000
         IC    @02,UCMRQLM(,@10)                                   0342 01239000
         CR    @08,@02                                             0342 01240000
         BL    @RT00342                                            0342 01241000
         TM    XVD1PRIV(RBSECPTR),B'10000000'                      0342 01242000
         BNO   @RF00342                                            0342 01243000
@RT00342 DS    0H                                                  0343 01244000
*                       DO;         /* YES, GET AN ORE AND ID        */ 01245000
*                         CALL VWTOGETB(2);/* GET AN ORE AND ZERO IT */ 01246000
         LA    @01,@AL00344                                        0344 01247000
         BAL   @14,VWTOGETB                                        0344 01248000
*/********************************************************************/ 01249000
*/*                                                                  */ 01250000
*/* CHECK TO SEE IF WE SUCCESSFULLY GOT AN ORE. IF NOT THEN SET      */ 01251000
*/* THE ERROR FLAG AND SET OTHER FLAGS SO THAT WE GET OUT OF         */ 01252000
*/* GET CONTROL BLOCKS LOOP.                                         */ 01253000
*/*                                                                  */ 01254000
*/********************************************************************/ 01255000
*                                                                  0345 01256000
*                         IF XVOREAD=1 THEN/* WAS ERROR CONDITION SET   01257000
*                                      BY VWTOGETB                   */ 01258000
         CLC   XVOREAD(4,RBSECPTR),@CF00062                        0345 01259000
         BNE   @RF00345                                            0345 01260000
*                           DO;     /* YES. SET FLAGS TO GET OUT OF     01261000
*                                      LOOP                          */ 01262000
*                             XVD1ALDN='1'B;/* INDICATE THAT LOOP IS    01263000
*                                      OVER                          */ 01264000
*                             XVD1PERR='1'B;/* INDICATE AN ERROR   0348 01265000
*                                      CONDITION FOUND               */ 01266000
         OI    XVD1ALDN(RBSECPTR),B'00100001'                      0348 01267000
*                             XVD0RPFD='1'B;/* SET SO THAT WE SKIP TO   01268000
*                                      THE WQE TEST AND THEN OUT.    */ 01269000
         OI    XVD0RPFD(RBSECPTR),B'01000000'                      0349 01270000
*                           END;                                   0350 01271000
*                         ELSE      /* AN ORE WAS OBTAINED. GET AN ID*/ 01272000
*                           DO;                                    0351 01273000
*                                                                  0351 01274000
         B     @RC00345                                            0351 01275000
@RF00345 DS    0H                                                  0352 01276000
*/********************************************************************/ 01277000
*/*  GETID - GET A REPLY ID SEGMENT                                  */ 01278000
*/*                                                                  */ 01279000
*/*  FUNCTION - TO OBTAIN ONE OF THE 100 REPLY IDS AND INSERT THE    */ 01280000
*/*     ID IN THE ORE.                                               */ 01281000
*/*                                                                  */ 01282000
*/*  INPUT - XVOREAD PTS AT AN ORE.                                  */ 01283000
*/*          UCMRPYL CONTAINS THE NEXT REPLY ID IN UCMRPYI TO TRY.   */ 01284000
*/*          UCMRPYI IS THE BIT MAP OF AVAILABLE IDS                 */ 01285000
*/*                                                                  */ 01286000
*/*  OUTPUT - XVD0RPFD IS ON IF ID WAS STORED IN THE ORE             */ 01287000
*/*           XVD0RPFD IS OFF IF ID WAS NOT AVAILABLE                */ 01288000
*/*                                                                  */ 01289000
*/********************************************************************/ 01290000
*                                                                  0352 01291000
*                             XVD0RPFD='0'B;/* DON'T TURN REPLY FOUND   01292000
*                                      ON UNTIL ID IS AVAILABLE      */ 01293000
         NI    XVD0RPFD(RBSECPTR),B'10111111'                      0352 01294000
*                             STARTID=UCMRPYL;/* INIT THE STARTING ID   01295000
*                                                            @ZA12401*/ 01296000
         L     @10,UCMBASPT(,REG3)                                 0353 01297000
         L     @10,UCMEILPT(,@10)                                  0353 01298000
         MVC   STARTID(1),UCMRPYL(@10)                             0353 01299000
*                             DO UNTIL(XVD0RPFD='1'B|/* DO UNTIL AN     01300000
*                                      ID IS FOUND           @ZA12401*/ 01301000
*                                   UCMRPYL=STARTID);/* OR ALL THE 0354 01302000
*                                      ID'S HAVE BEEN SEARCHED     0354 01303000
*                                                            @ZA12401*/ 01304000
@DL00354 DS    0H                                                  0355 01305000
*                               RFY                                0355 01306000
*                                (REG1,                            0355 01307000
*                                 REG2) RSTD;                      0355 01308000
*                                                                  0355 01309000
*/********************************************************************/ 01310000
*/*                                                                  */ 01311000
*/* WE ADD ONE IN THE FOLLOWING TWO INSTRUCTIONS IN ORDER TO CONVERT */ 01312000
*/* THE UCMRPYL FROM ZERO ORIGIN INDEX TO A ONE ORIGIN INDEX VALUE   */ 01313000
*/* USED BY PL/S II.                                                 */ 01314000
*/*                                                                  */ 01315000
*/********************************************************************/ 01316000
*                                                                  0356 01317000
*                               REG1=UCMRPYL/8+1;/* DEVELOP BYTE   0356 01318000
*                                      OFFSET INTO UCMRPYI           */ 01319000
         LA    @10,1                                               0356 01320000
         L     @08,UCMBASPT(,REG3)                                 0356 01321000
         L     @15,UCMEILPT(,@08)                                  0356 01322000
         SLR   @14,@14                                             0356 01323000
         IC    @14,UCMRPYL(,@15)                                   0356 01324000
         LR    REG1,@14                                            0356 01325000
         SRL   REG1,3                                              0356 01326000
         ALR   REG1,@10                                            0356 01327000
*                               REG2=UCMRPYL//8+1;/* DEVELOP BYTE  0357 01328000
*                                      OFFSET INTO BIT MAP           */ 01329000
         ST    @15,@TF00001                                        0357 01330000
         SRDA  @14,32                                              0357 01331000
         D     @14,@CF00061                                        0357 01332000
         ALR   @14,@10                                             0357 01333000
         LR    REG2,@14                                            0357 01334000
*/********************************************************************/ 01335000
*/*                                                                  */ 01336000
*/* CHECK IF THE UCMRPYL-TH BIT IS OFF. IF SO TURN IT ON AND CONVERT */ 01337000
*/* THE ID.                                                          */ 01338000
*/*                                                                  */ 01339000
*/********************************************************************/ 01340000
*                                                                  0358 01341000
*                               IF(UCMRPYI(REG1)&IDMAP(REG2))^=IDMAP(   01342000
*                                   REG2) THEN                     0358 01343000
         LR    @10,@08                                             0358 01344000
         ALR   @10,REG1                                            0358 01345000
         MVC   @TS00001(1),UCMRPYI-1(@10)                          0358 01346000
         LA    @10,IDMAP-1(REG2)                                   0358 01347000
         NC    @TS00001(1),0(@10)                                  0358 01348000
         LA    @10,IDMAP-1(REG2)                                   0358 01349000
         CLC   @TS00001(1),0(@10)                                  0358 01350000
         BE    @RF00358                                            0358 01351000
*                                 DO;/* YES, ID IS AVAILABLE         */ 01352000
*                                   CVD(CURRID,CVDAREA);/* CONVERT 0360 01353000
*                                      BIT ID INTO DECIMAL IN 8 BYTE    01354000
*                                      AREA -CVDAREA         @ZA12401*/ 01355000
*                                                                  0360 01356000
         L     @10,@TF00001                                        0360 01357000
         SLR   @00,@00                                             0360 01358000
         IC    @00,CURRID(,@10)                                    0360 01359000
         CVD   @00,CVDAREA                                         0360 01360000
*                                   /*********************************/ 01361000
*                                   /*                               */ 01362000
*                                   /* UNPACK ONLY THE LAST TWO BYTES*/ 01363000
*                                   /* OF CONVERTED NUMBER           */ 01364000
*                                   /*                               */ 01365000
*                                   /*********************************/ 01366000
*                                                                  0361 01367000
*                                   UNPK(OREID,CVDAREA(7:8));      0361 01368000
*                                                                  0361 01369000
         L     @10,OREPTR(,RBSECPTR)                               0361 01370000
         UNPK  OREID(2,@10),CVDAREA+6(2)                           0361 01371000
*                                   /*********************************/ 01372000
*                                   /*                               */ 01373000
*                                   /* REPLACE SIGN WITH 'F0' ZONE   */ 01374000
*                                   /* BITS                          */ 01375000
*                                   /*                               */ 01376000
*                                   /*********************************/ 01377000
*                                                                  0362 01378000
*                                   OREID(2)=OREID(2)|'F0'X;       0362 01379000
         OI    OREID+1(@10),X'F0'                                  0362 01380000
*                                   XVD0RPFD='1'B;/* INDICATE AN ID     01381000
*                                      WAS FOUND                     */ 01382000
*                                                                  0363 01383000
         OI    XVD0RPFD(RBSECPTR),B'01000000'                      0363 01384000
*                                   /*********************************/ 01385000
*                                   /*                               */ 01386000
*                                   /* TURN ON ID BIT IN BIT MAP     */ 01387000
*                                   /*                               */ 01388000
*                                   /*********************************/ 01389000
*                                                                  0364 01390000
*                                   UCMRPYI(REG1)=UCMRPYI(REG1)|IDMAP(  01391000
*                                       REG2);                     0364 01392000
         ALR   @08,REG1                                            0364 01393000
         LA    @10,IDMAP-1(REG2)                                   0364 01394000
         OC    UCMRPYI-1(1,@08),0(@10)                             0364 01395000
*                                   XVA0=REG1;/* SAVE CONTENTS OF  0365 01396000
*                                      REG1 IN CASE WE HAVE TO BIVE     01397000
*                                      BACK THE ID.                  */ 01398000
         ST    REG1,XVA0(,RBSECPTR)                                0365 01399000
*                                   XVA4=REG2;/* SAVE CONTENTS OF  0366 01400000
*                                      REG2 FOR SAME REASON.         */ 01401000
         ST    REG2,XVA4(,RBSECPTR)                                0366 01402000
*                                 END;/*                     @ZA12401*/ 01403000
*                               IF UCMRPYL=NINTY9 THEN/* END OF ID'S    01404000
*                                      REACHED?              @ZA12401*/ 01405000
@RF00358 L     @10,UCMBASPT(,REG3)                                 0368 01406000
         L     @10,UCMEILPT(,@10)                                  0368 01407000
         CLI   UCMRPYL(@10),99                                     0368 01408000
         BNE   @RF00368                                            0368 01409000
*                                 UCMRPYL=0;/* YES, GO BACK TO 1ST ID   01410000
*                                                            @ZA12401*/ 01411000
         MVI   UCMRPYL(@10),X'00'                                  0369 01412000
*                               ELSE/* NO, INCREMENT UCMRPYL. THIS IS   01413000
*                                      DONE EVEN THOUGH AN ID MAY BE    01414000
*                                      PICKED, SO THAT UCMRPYL IS  0370 01415000
*                                      INITIALIZED FOR THE NEXT ID 0370 01416000
*                                      SCAN                  @ZA12401*/ 01417000
*                                 UCMRPYL=UCMRPYL+1;/*       @ZA12401*/ 01418000
         B     @RC00368                                            0370 01419000
@RF00368 L     @10,UCMBASPT(,REG3)                                 0370 01420000
         L     @10,UCMEILPT(,@10)                                  0370 01421000
         LA    @08,1                                               0370 01422000
         SLR   @00,@00                                             0370 01423000
         IC    @00,UCMRPYL(,@10)                                   0370 01424000
         ALR   @08,@00                                             0370 01425000
         STC   @08,UCMRPYL(,@10)                                   0370 01426000
*                               RFY                                0371 01427000
*                                (REG1,                            0371 01428000
*                                 REG2) UNRSTD;/*            @ZA12401*/ 01429000
@RC00368 DS    0H                                                  0372 01430000
*                             END;  /* OF DO UNTIL (FINDING A FREE 0372 01431000
*                                      ID)                   @ZA12401*/ 01432000
@DE00354 TM    XVD0RPFD(RBSECPTR),B'01000000'                      0372 01433000
         BO    @DC00354                                            0372 01434000
         L     @10,UCMBASPT(,REG3)                                 0372 01435000
         L     @10,UCMEILPT(,@10)                                  0372 01436000
         CLC   UCMRPYL(1,@10),STARTID                              0372 01437000
         BNE   @DL00354                                            0372 01438000
@DC00354 DS    0H                                                  0373 01439000
*/****** END OF GETID SEGMENT ****************************************/ 01440000
*                                                                  0373 01441000
*                           END;                                   0373 01442000
*                                                                  0373 01443000
*/********************************************************************/ 01444000
*/*                                                                  */ 01445000
*/*  CHECK TO SEE IF AN ID WAS AVAILABLE                             */ 01446000
*/*                                                                  */ 01447000
*/********************************************************************/ 01448000
*                                                                  0374 01449000
*                         IF XVD0RPFD='1'B THEN/* WAS A REPLY ID   0374 01450000
*                                      FOUND                         */ 01451000
@RC00345 TM    XVD0RPFD(RBSECPTR),B'01000000'                      0374 01452000
         BNO   @RF00374                                            0374 01453000
*                           DO;     /* YES, INDICATE WE NOW NEED A 0375 01454000
*                                      WQE                           */ 01455000
*                             XVD0NORE='0'B;/* PROCESSING DONE FOR AN   01456000
*                                      ORE                           */ 01457000
*                             XVD0NWQE='1'B;/* GET A WQE             */ 01458000
         OI    XVD0NWQE(RBSECPTR),B'00100000'                      0377 01459000
         NI    XVD0NORE(RBSECPTR),B'11101111'                      0377 01460000
*                           END;                                   0378 01461000
*                         ELSE      /* NO, A REPLY WASNT AVAILABLE   */ 01462000
*                           DO;     /* FREE THE ORE JUST OBTAINED    */ 01463000
         B     @RC00374                                            0379 01464000
@RF00374 DS    0H                                                  0380 01465000
*                             CALL VWTOFORE;/* FREE THE ORE.         */ 01466000
*                                                                  0380 01467000
         BAL   @14,VWTOFORE                                        0380 01468000
*                             /***************************************/ 01469000
*                             /*                                     */ 01470000
*                             /* WAIT FOR AN ORE TO BE FREED         */ 01471000
*                             /*                                     */ 01472000
*                             /***************************************/ 01473000
*                                                                  0381 01474000
*                             CALL VWTOWAIT(UCMOECBT);             0381 01475000
         L     @10,UCMBASPT(,REG3)                                 0381 01476000
         LA    @10,UCMOECBT(,@10)                                  0381 01477000
         ST    @10,@AL00001                                        0381 01478000
         LA    @01,@AL00001                                        0381 01479000
         BAL   @14,VWTOWAIT                                        0381 01480000
*                           END;                                   0382 01481000
*                       END;        /* OF GET ORE AND ID PART        */ 01482000
*/********************************************************************/ 01483000
*/*                                                                  */ 01484000
*/*  NO, AN ORE WASN'T AVAILABLE. WAIT FOR AN ORE TO BE FREE'D       */ 01485000
*/*                                                                  */ 01486000
*/********************************************************************/ 01487000
*                                                                  0384 01488000
*                     ELSE                                         0384 01489000
*                       CALL VWTOWAIT(UCMOECBT);                   0384 01490000
*                                                                  0384 01491000
         B     @RC00342                                            0384 01492000
@RF00342 L     @10,UCMBASPT(,REG3)                                 0384 01493000
         LA    @10,UCMOECBT(,@10)                                  0384 01494000
         ST    @10,@AL00001                                        0384 01495000
         LA    @01,@AL00001                                        0384 01496000
         BAL   @14,VWTOWAIT                                        0384 01497000
*/********************************************************************/ 01498000
*/*                                                                  */ 01499000
*/*  CHECK IF WE NEED A WQE                                          */ 01500000
*/*                                                                  */ 01501000
*/********************************************************************/ 01502000
*                                                                  0385 01503000
*                   IF XVD0NWQE='1'B&/* IS A WQE NEEDED NOW          */ 01504000
*                       XVD1PERR='0'B THEN/* AND WAS THERE NO ERROR     01505000
*                                      IN GETTING AN ORE             */ 01506000
@RC00342 DS    0H                                                  0385 01507000
@RF00341 TM    XVD0NWQE(RBSECPTR),B'00100000'                      0385 01508000
         BNO   @RF00385                                            0385 01509000
         TM    XVD1PERR(RBSECPTR),B'00000001'                      0385 01510000
         BNZ   @RF00385                                            0385 01511000
*/********************************************************************/ 01512000
*/*                                                                  */ 01513000
*/*  YES, CHECK IF ONE IS AVAILABLE, IF SO, GET IT. IF NOT WAIT      */ 01514000
*/*  UNTIL ONE IS FREE'D,                                            */ 01515000
*/*                                                                  */ 01516000
*/********************************************************************/ 01517000
*                                                                  0386 01518000
*                     IF UCMWQNR<UCMWQLM|/* IS THE NUMBER OF WQES  0386 01519000
*                                      LESS THAN THE LIMIT OR        */ 01520000
*                         XVD1PRIV='1'B THEN/* IS THE USER A       0386 01521000
*                                      PRIVILEGED TASK               */ 01522000
         L     @10,UCMBASPT(,REG3)                                 0386 01523000
         LH    @08,UCMWQNR(,@10)                                   0386 01524000
         CH    @08,UCMWQLM(,@10)                                   0386 01525000
         BL    @RT00386                                            0386 01526000
         TM    XVD1PRIV(RBSECPTR),B'10000000'                      0386 01527000
         BNO   @RF00386                                            0386 01528000
@RT00386 DS    0H                                                  0387 01529000
*                       DO;         /* YES, GET THE WQE              */ 01530000
*                         CALL VWTOGETB(1);/* GET A WQE AND ZERO IT  */ 01531000
         LA    @01,@AL00388                                        0388 01532000
         BAL   @14,VWTOGETB                                        0388 01533000
*/********************************************************************/ 01534000
*/*                                                                  */ 01535000
*/* CHECK IF A WQE WAS OBTAINED BY VWTOGETB.  IF NOT THEN CHECK IF   */ 01536000
*/* THIS IS A WTOR. IF SO THEN FREE THE ORE AND REPLY ID THAT WAS    */ 01537000
*/* OBTAINED.                                                        */ 01538000
*/*                                                                  */ 01539000
*/********************************************************************/ 01540000
*                                                                  0389 01541000
*                         IF XVWQEAD=1 THEN/* WAS THERE AN ERROR IN     01542000
*                                      GETTING THE WQE?              */ 01543000
         CLC   XVWQEAD(4,RBSECPTR),@CF00062                        0389 01544000
         BNE   @RF00389                                            0389 01545000
*                           DO;     /* YES, CHECK IF THIS IS A WTOR     01546000
*                                      REQUEST                       */ 01547000
*                             IF XVD2WTOR='1'B THEN/* IS THIS A WTOR?*/ 01548000
         TM    XVD2WTOR(RBSECPTR),B'00000010'                      0391 01549000
         BNO   @RF00391                                            0391 01550000
*                               DO; /* YES. FREE THE ORE AND REPLY ID*/ 01551000
*                                 CALL VWTOFORE;/* FREE THE ORE.     */ 01552000
*                                                                  0393 01553000
         BAL   @14,VWTOFORE                                        0393 01554000
*                                 /***********************************/ 01555000
*                                 /*                                 */ 01556000
*                                 /* FREE THE REPLY ID JUST PICKED.  */ 01557000
*                                 /* THE INDEXS TO UCMRPYI AND IDMAP */ 01558000
*                                 /* WERE SAVED BY GETID IN XVA0 AND */ 01559000
*                                 /* XVA4                            */ 01560000
*                                 /*                                 */ 01561000
*                                 /***********************************/ 01562000
*                                                                  0394 01563000
*                                 UCMRPYI(XVA0)=UCMRPYI(XVA0)&(-1&&     01564000
*                                     IDMAP(XVA4));                0394 01565000
         L     @10,XVA0(,RBSECPTR)                                 0394 01566000
         L     @08,UCMBASPT(,REG3)                                 0394 01567000
         L     @02,XVA4(,RBSECPTR)                                 0394 01568000
         SLR   @15,@15                                             0394 01569000
         IC    @15,IDMAP-1(@02)                                    0394 01570000
         X     @15,@CF03250                                        0394 01571000
         SLR   @02,@02                                             0394 01572000
         IC    @02,UCMRPYI-1(@10,@08)                              0394 01573000
         NR    @15,@02                                             0394 01574000
         STC   @15,UCMRPYI-1(@10,@08)                              0394 01575000
*                               END;/* OF FREEING ORE                */ 01576000
*                             XVD1PERR='1'B;/* INDICATE AN ERROR   0396 01577000
*                                      CONDITION FOUND.              */ 01578000
@RF00391 OI    XVD1PERR(RBSECPTR),B'00000001'                      0396 01579000
*                           END;    /* OF ERROR IN GETTING WQE.      */ 01580000
*                         XVD1ALDN='1'B;/* INDICATE WE ARE ALL DONE  */ 01581000
@RF00389 OI    XVD1ALDN(RBSECPTR),B'00100000'                      0398 01582000
*                       END;                                       0399 01583000
*                     ELSE          /* NO, A WQE IS NOT AVAILABLE    */ 01584000
*                       DO;                                        0400 01585000
*                                                                  0400 01586000
         B     @RC00386                                            0400 01587000
@RF00386 DS    0H                                                  0401 01588000
*/********************************************************************/ 01589000
*/*                                                                  */ 01590000
*/*  CHECK IF THIS IS A WTOR. IF SO FREE THE ORE AND REPLY ID. THIS  */ 01591000
*/*  IS DONE SO WE DON'T GET IN AN INTERLOCK SITUATION.              */ 01592000
*/*                                                                  */ 01593000
*/********************************************************************/ 01594000
*                                                                  0401 01595000
*                         IF XVD2WTOR='1'B THEN/* IS THIS A WTOR     */ 01596000
         TM    XVD2WTOR(RBSECPTR),B'00000010'                      0401 01597000
         BNO   @RF00401                                            0401 01598000
*                           DO;     /* YES                           */ 01599000
*                             CALL VWTOFORE;/* FREE THE ORE.         */ 01600000
*                                                                  0403 01601000
         BAL   @14,VWTOFORE                                        0403 01602000
*                             /***************************************/ 01603000
*                             /*                                     */ 01604000
*                             /* FREE THE REPLY ID JUST PICKED. THE  */ 01605000
*                             /* INDEXS TO UCMRPYI AND IDMAP WERE    */ 01606000
*                             /* SAVED BY GETID IN XVA0 AND XVA4     */ 01607000
*                             /*                                     */ 01608000
*                             /***************************************/ 01609000
*                                                                  0404 01610000
*                             UCMRPYI(XVA0)=UCMRPYI(XVA0)&(-1&&IDMAP(   01611000
*                                 XVA4));                          0404 01612000
*                                                                  0404 01613000
         L     @10,XVA0(,RBSECPTR)                                 0404 01614000
         L     @08,UCMBASPT(,REG3)                                 0404 01615000
         L     @02,XVA4(,RBSECPTR)                                 0404 01616000
         SLR   @15,@15                                             0404 01617000
         IC    @15,IDMAP-1(@02)                                    0404 01618000
         X     @15,@CF03250                                        0404 01619000
         SLR   @02,@02                                             0404 01620000
         IC    @02,UCMRPYI-1(@10,@08)                              0404 01621000
         NR    @15,@02                                             0404 01622000
         STC   @15,UCMRPYI-1(@10,@08)                              0404 01623000
*                             /***************************************/ 01624000
*                             /*                                     */ 01625000
*                             /* NOW BACK UP UCMRPYL SO WE WILL TRY  */ 01626000
*                             /* TO GET THE SAME REPLY               */ 01627000
*                             /*                                     */ 01628000
*                             /***************************************/ 01629000
*                                                                  0405 01630000
*                             IF UCMRPYL=0 THEN/* ARE WE AT BEGINNING   01631000
*                                      OF IDS                        */ 01632000
         L     @10,UCMEILPT(,@08)                                  0405 01633000
         CLI   UCMRPYL(@10),0                                      0405 01634000
         BNE   @RF00405                                            0405 01635000
*                               UCMRPYL=NINTY9;/* YES. BACK UP TO  0406 01636000
*                                      99TH ID                       */ 01637000
         MVI   UCMRPYL(@10),X'63'                                  0406 01638000
*                             ELSE  /* NO WE ARE NOT AT ID 0.        */ 01639000
*                               UCMRPYL=UCMRPYL-1;/* BACK UP JUST ONE*/ 01640000
         B     @RC00405                                            0407 01641000
@RF00405 L     @10,UCMBASPT(,REG3)                                 0407 01642000
         L     @10,UCMEILPT(,@10)                                  0407 01643000
         SLR   @08,@08                                             0407 01644000
         IC    @08,UCMRPYL(,@10)                                   0407 01645000
         BCTR  @08,0                                               0407 01646000
         STC   @08,UCMRPYL(,@10)                                   0407 01647000
*                             XVD0NORE='1'B;/* INDICATE START OVER IN   01648000
*                                      GETTING ORE                   */ 01649000
@RC00405 DS    0H                                                  0409 01650000
*                             XVD0NWQE='0'B;                       0409 01651000
         OI    XVD0NORE(RBSECPTR),B'00010000'                      0409 01652000
         NI    XVD0NWQE(RBSECPTR),B'11011111'                      0409 01653000
*                           END;                                   0410 01654000
*                                                                  0410 01655000
*/********************************************************************/ 01656000
*/*                                                                  */ 01657000
*/* NOW WAIT FOR A WQE TO BE FREE'D. THEN TRY AGAIN                  */ 01658000
*/*                                                                  */ 01659000
*/********************************************************************/ 01660000
*                                                                  0411 01661000
*                         CALL VWTOWAIT(UCMWECBT);                 0411 01662000
@RF00401 L     @10,UCMBASPT(,REG3)                                 0411 01663000
         LA    @10,UCMWECBT(,@10)                                  0411 01664000
         ST    @10,@AL00001                                        0411 01665000
         LA    @01,@AL00001                                        0411 01666000
         BAL   @14,VWTOWAIT                                        0411 01667000
*                       END;                                       0412 01668000
*                 END;              /* OF DO WHILE LOOP              */ 01669000
@RC00386 DS    0H                                                  0413 01670000
@RF00385 DS    0H                                                  0413 01671000
@DE00340 TM    XVD1ALDN(RBSECPTR),B'00100000'                      0413 01672000
         BZ    @DL00340                                            0413 01673000
*/* **** END GETBLKS SEGMENT *****************************************/ 01674000
*/********************************************************************/ 01675000
*/*                                                                  */ 01676000
*/* NOW CHECK IF THE CONTROL BLOCKS WERE OBTAINED. IF SO THEN GO     */ 01677000
*/* AHEAD AND BUILD THEM. IF NOT THEN ABEND WITH A D23 ABEND CODE.   */ 01678000
*/*                                                                  */ 01679000
*/********************************************************************/ 01680000
*                                                                  0414 01681000
*                 IF XVD1PERR='0'B THEN/* WERE WE SUCCESSFUL IN    0414 01682000
*                                      GETTING THE CONTROL BLOCKS (     01683000
*                                      WERE NO ERRORS FOUND IN     0414 01684000
*                                      GETTING THEM?)                */ 01685000
         TM    XVD1PERR(RBSECPTR),B'00000001'                      0414 01686000
         BNZ   @RF00414                                            0414 01687000
*                   DO;             /* YES. BUILD THEM               */ 01688000
*/********************************************************************/ 01689000
*/*                                                                  */ 01690000
*/* CHECK FOR WTOR. IF THIS REQUEST IS A WTOR THEN BUILD AN ORE      */ 01691000
*/*                                                                  */ 01692000
*/********************************************************************/ 01693000
*                                                                  0416 01694000
*                     IF XVD2WTOR='1'B THEN/* IS THIS REQUEST A WTOR */ 01695000
         TM    XVD2WTOR(RBSECPTR),B'00000010'                      0416 01696000
         BNO   @RF00416                                            0416 01697000
*                       DO;                                        0417 01698000
*                                                                  0417 01699000
*/*** START OF BUILDORE **********************************************/ 01700000
*/********************************************************************/ 01701000
*/*                                                                  */ 01702000
*/*   BUILDORE - CONSTRUCT THE ORE AND PUT IT ON THE ORE CHAIN       */ 01703000
*/*                                                                  */ 01704000
*/*   INPUT - XVPARMAD POINTS AT THE USER'S PARM LIST                */ 01705000
*/*           XVOREAD  POINTS AT A ZEROED ORE                        */ 01706000
*/*                                                                  */ 01707000
*/*   OUTPUT - THE FILLED IN ORE IS ADDED TO THE ORE CHAIN           */ 01708000
*/*            AND IS MARKED SUSPENDED FOR THE DURATION OF THE       */ 01709000
*/*            SUBSYSTEM EXIT.                                       */ 01710000
*/*                                                                  */ 01711000
*/********************************************************************/ 01712000
*/********************************************************************/ 01713000
*/*                                                                  */ 01714000
*/*           THE OREID WILL HAVE ALREADY BEEN FILLED IN BY GETID.   */ 01715000
*/*                                                                  */ 01716000
*/********************************************************************/ 01717000
*                                                                  0418 01718000
*                         ORETCB=REG4;/* INSERT TCB ADDR             */ 01719000
         L     @10,OREPTR(,RBSECPTR)                               0418 01720000
         ST    REG4,ORETCB(,@10)                                   0418 01721000
*                         ORERPY=WPLRPTR;/* MOVE IN REPLY LENGTH AND    01722000
*                                      BUFFER ADDR                   */ 01723000
         L     @08,XVPARMAD(,RBSECPTR)                             0419 01724000
         L     @02,WPLRPTR(,@08)                                   0419 01725000
         ST    @02,ORERPY(,@10)                                    0419 01726000
*                         OREECB=WPLRECB;/* MOVE IN THE REPLY ECB  0420 01727000
*                                      ADDR                          */ 01728000
         L     @08,WPLRECB(,@08)                                   0420 01729000
         ST    @08,OREECB(,@10)                                    0420 01730000
*                         OREASID=ASCBASID;/* MOVE ASID OF THIS    0421 01731000
*                                      MEMORY                        */ 01732000
         LH    @08,ASCBASID(,ASCBPTR)                              0421 01733000
         N     @08,@CF03329                                        0421 01734000
         STH   @08,OREASID(,@10)                                   0421 01735000
*                         OREWQE=XVWQEAD;/* MOVE IN ADDR OF        0422 01736000
*                                      ASSOCIATED WQE                */ 01737000
         L     @08,XVWQEAD(,RBSECPTR)                              0422 01738000
         ST    @08,OREWQE(,@10)                                    0422 01739000
*                         OREBUFB='1'B;/* INDICATE THIS ORE IS IN USE*/ 01740000
*                         OREBUFD='1'B;/* INDICATE ORE OBTAINED VIA A   01741000
*                                      GETMAIN                       */ 01742000
         OI    OREBUFB(@10),B'01010000'                            0424 01743000
*/********************************************************************/ 01744000
*/*                                                                  */ 01745000
*/*  CHECK IF USER IS A PROBLEM PROGRAM. IF NOT THEN INDICATE THAT   */ 01746000
*/*  VALIDITY CHECKING OF REPLY BUFFER AND ECB CAN BE BYPASSED BY    */ 01747000
*/*  REPLY PROCESSING.                                               */ 01748000
*/*                                                                  */ 01749000
*/********************************************************************/ 01750000
*                                                                  0425 01751000
*                         IF XVD1PP='0'B THEN/* IS USER NOT A PROBLEM   01752000
*                                      PROGRAM                       */ 01753000
         TM    XVD1PP(RBSECPTR),B'00000100'                        0425 01754000
         BNZ   @RF00425                                            0425 01755000
*                           OREKEY0='1'B;/* INDICATE BYPASS VALIDITY    01756000
*                                      CHECK                         */ 01757000
         OI    OREKEY0(@10),B'01000000'                            0426 01758000
*                         ORESUSP='1'B;/* INDICATE ORE SUSPENDED FOR    01759000
*                                      SUBSYSTEM EXIT.               */ 01760000
@RF00425 L     @10,OREPTR(,RBSECPTR)                               0427 01761000
         OI    ORESUSP(@10),B'00010000'                            0427 01762000
*/********************************************************************/ 01763000
*/*                                                                  */ 01764000
*/*  NOW PUT THE ORE ON THE FRONT OF THE QUEUE. THE ORDER OF         */ 01765000
*/*  APPEARANCE ON THE QUEUE IS IMMATERIAL. THE OPERATOR MAY RESPOND */ 01766000
*/*  IN ANY ORDER AND REPLY PROCESSING WILL SCAN THE QUEUE FOR MATCH-*/ 01767000
*/*  ING IDS.                                                        */ 01768000
*/*                                                                  */ 01769000
*/********************************************************************/ 01770000
*                                                                  0428 01771000
*                         ORELKP=UCMRPYQ;/* POINT THIS ORE AT NEXT 0428 01772000
*                                      ORE ON QUEUE                  */ 01773000
         L     @08,UCMBASPT(,REG3)                                 0428 01774000
         L     @02,UCMRPYQ(,@08)                                   0428 01775000
         ST    @02,ORELKP(,@10)                                    0428 01776000
*                         UCMRPYQ=XVOREAD;/* POINT HEAD OF QUEUE AT     01777000
*                                      THIS ORE                      */ 01778000
         L     @10,XVOREAD(,RBSECPTR)                              0429 01779000
         ST    @10,UCMRPYQ(,@08)                                   0429 01780000
*/********************************************************************/ 01781000
*/*                                                                  */ 01782000
*/*  WE ASSUME UCMRPYQ IS ZERO IF QUEUE IS EMPTY AT ENTRY TO VWTO    */ 01783000
*/*                                                                  */ 01784000
*/********************************************************************/ 01785000
*/****** END OF BUILD ORE SEGMENT ************************************/ 01786000
*                                                                  0430 01787000
*                       END;                                       0430 01788000
*                                                                  0430 01789000
*/********************************************************************/ 01790000
*/*                                                                  */ 01791000
*/* NOW BUILD THE WQE                                                */ 01792000
*/*                                                                  */ 01793000
*/********************************************************************/ 01794000
*/*** START OF BUILDWQE **********************************************/ 01795000
*/********************************************************************/ 01796000
*/*                                                                  */ 01797000
*/*   BUILDWQE - CONSTRUCT THE WQE AND PUT IT ON THE WQE CHAIN       */ 01798000
*/*                                                                  */ 01799000
*/*   INPUT - XVPARMAD POINTS AT THE USER'S PARM LIST                */ 01800000
*/*           XVWQEAD  POINTS AT A ZEROED WQE                        */ 01801000
*/*           REG6 POINTS AT THE MSG PART OF THE WPL                 */ 01802000
*/*                                                                  */ 01803000
*/*   OUTPUT - THE FILLED IN WQE IS ADDED TO THE WQE CHAIN.          */ 01804000
*/*                                                                  */ 01805000
*/*  START BY MOVING MESSAGE INTO THE WQE. THE FIRST CHARACTER OF    */ 01806000
*/*  TEXT IN THE WQE WILL BE THE AUTHORIZATION FLAG. THE MESSAGE IS  */ 01807000
*/*  SCANNED FOR 'NL' CHARACTER AND TO ELIMINATE TRAILING BLANKS.    */ 01808000
*/*  THE LENGTH OF THE MSG IS IN XVMSGLGH AND IS NON-ZERO            */ 01809000
*/*  THE SECURITY MESSAGE FLAGGING IN THE MESSAGE TEXT IS:           */ 01810000
*/*   MSG TYPE           MSG FORMAT                                  */ 01811000
*/*   WTO,P/P,NONACTION  BLANK,+,TEXT                                */ 01812000
*/*   WTO,P/P,ACTION     @,TEXT                                      */ 01813000
*/*   WTO,SYS,NONACTION  BLANK,TEXT                                  */ 01814000
*/*   WTO,SYS,ACTION     *,TEXT                                      */ 01815000
*/*   WTOR,P/P           @,ID,BLANK,TEXT                             */ 01816000
*/*   WTOR,SYSTEM        *,ID,BLANK,TEXT                             */ 01817000
*/*   AN ACTION MSG IS A WTOR OR A WTO WITH DESCRIPTOR CODE 1 OR 2.  */ 01818000
*/* NOTE: P/P IN THE ABOVE TABLE MEANS THAT THE USER IS NOT          */ 01819000
*/*       AUTHORIZED.                                                */ 01820000
*/*                                                                  */ 01821000
*/********************************************************************/ 01822000
*                                                                  0431 01823000
*                     RFY                                          0431 01824000
*                       REG2 RSTD;  /* REG2 WILL BE USED AS TEXTPTR  */ 01825000
@RF00416 DS    0H                                                  0432 01826000
*                     WQETXT='';    /* BLANK OUT TEXT PART OF THE WQE*/ 01827000
         L     @10,WQEPTR(,RBSECPTR)                               0432 01828000
         MVI   WQETXT(@10),C' '                                    0432 01829000
         MVC   WQETXT+1(127,@10),WQETXT(@10)                       0432 01830000
*/********************************************************************/ 01831000
*/*                                                                  */ 01832000
*/*  CHECK FOR TYPE OF MESSAGE                                       */ 01833000
*/*                                                                  */ 01834000
*/********************************************************************/ 01835000
*                                                                  0433 01836000
*                     IF XVD2WTOR='1'B THEN/* IS THIS A WTOR         */ 01837000
         TM    XVD2WTOR(RBSECPTR),B'00000010'                      0433 01838000
         BNO   @RF00433                                            0433 01839000
*                       DO;         /* YES, IS USER NOT AUTHORIZED?  */ 01840000
*                         IF XVD1AUTH='0'B THEN                    0435 01841000
         TM    XVD1AUTH(RBSECPTR),B'00000010'                      0435 01842000
         BNZ   @RF00435                                            0435 01843000
*                           MSGACTN='@';/* YES, MOVE IN P/P ACTION 0436 01844000
*                                      FLAG                          */ 01845000
         MVI   MSGACTN(@10),C'@'                                   0436 01846000
*                         ELSE      /* NO, MOVE IN SYSTEM ACTION FLAG*/ 01847000
*                           MSGACTN='*';                           0437 01848000
         B     @RC00435                                            0437 01849000
@RF00435 L     @10,WQEPTR(,RBSECPTR)                               0437 01850000
         MVI   MSGACTN(@10),C'*'                                   0437 01851000
*                         MSGID=OREID;/* MOVE IN REPLY ID FROM ORE   */ 01852000
@RC00435 L     @10,WQEPTR(,RBSECPTR)                               0438 01853000
         L     @08,OREPTR(,RBSECPTR)                               0438 01854000
         MVC   MSGID(2,@10),OREID(@08)                             0438 01855000
*                         MSGBLNK=' ';/* MOVE IN A BLANK AFTER REPLY    01856000
*                                      ID                            */ 01857000
*                                                                  0439 01858000
         MVI   MSGBLNK(@10),C' '                                   0439 01859000
*                         /*******************************************/ 01860000
*                         /*                                         */ 01861000
*                         /* POINT AT FIRST LOCATION OF MSG TEXT     */ 01862000
*                         /*                                         */ 01863000
*                         /*******************************************/ 01864000
*                                                                  0440 01865000
*                         TEXTPTR=LENGTH(MSGFLAG)+1;               0440 01866000
         LA    TEXTPTR,5                                           0440 01867000
*                       END;                                       0441 01868000
*                     ELSE          /* NO, NOT A WTOR. CHECK FURTHER */ 01869000
*/********************************************************************/ 01870000
*/*                                                                  */ 01871000
*/* IS IT ACTION MSG BY REASON OF DESCRIPTOR CODES. CHECK THE DESC   */ 01872000
*/* CODES RETURNED BY THE INSTALLATION EXIT. THEY WERE       @ZA14991*/ 01873000
*/* SAVED IN THE XSA AND THE WPL NOW MAPS THE XSA NOT THE    @ZA14991*/ 01874000
*/* WPL.                                                     @ZA14991*/ 01875000
*/*                                                                  */ 01876000
*/********************************************************************/ 01877000
*                                                                  0442 01878000
*                       DO;                                        0442 01879000
         B     @RC00433                                            0442 01880000
@RF00433 DS    0H                                                  0443 01881000
*                         IF WPLDESCA='1'B|/* IS DESC CODE 1 OR 2  0443 01882000
*                                      SPECIFIED                     */ 01883000
*                             WPLDESCB='1'B THEN                   0443 01884000
         LA    @10,108                                             0443 01885000
         ALR   @10,RBSECPTR                                        0443 01886000
         TM    WPLDESCA(@10),B'11000000'                           0443 01887000
         BZ    @RF00443                                            0443 01888000
*                           IF XVD1AUTH='0'B THEN/* YES, CHECK FOR 0444 01889000
*                                      NOT AUTHORIZED.               */ 01890000
         TM    XVD1AUTH(RBSECPTR),B'00000010'                      0444 01891000
         BNZ   @RF00444                                            0444 01892000
*                             DO;   /* YES, USER IS NOT AUTHORIZED.  */ 01893000
*                               MSGACTN='@';/* MOVE IN P/P ACTION  0446 01894000
*                                      FLAG                          */ 01895000
         L     @08,WQEPTR(,RBSECPTR)                               0446 01896000
         MVI   MSGACTN(@08),C'@'                                   0446 01897000
*                               TEXTPTR=LENGTH(MSGACTN)+1;         0447 01898000
         LA    TEXTPTR,2                                           0447 01899000
*                               WPLDESCG='1'B;/* TURN ON DESC 7 SO 0448 01900000
*                                      THE P/P ACTION MSG WILL BE  0448 01901000
*                                      DOMMED AT TASK TERMINATION  0448 01902000
*                                                            @ZA14991*/ 01903000
         OI    WPLDESCG(@10),B'00000010'                           0448 01904000
*                             END;                                 0449 01905000
*                           ELSE    /* NO, THIS IS A SYSTEM ACTION 0450 01906000
*                                      MSG                           */ 01907000
*                             DO;                                  0450 01908000
         B     @RC00444                                            0450 01909000
@RF00444 DS    0H                                                  0451 01910000
*                               MSGACTN='*';/* MOVE IN SYSTEM ACTION    01911000
*                                      FLAG                          */ 01912000
         L     @10,WQEPTR(,RBSECPTR)                               0451 01913000
         MVI   MSGACTN(@10),C'*'                                   0451 01914000
*                               TEXTPTR=LENGTH(MSGACTN)+1;         0452 01915000
         LA    TEXTPTR,2                                           0452 01916000
*                             END;                                 0453 01917000
*                         ELSE      /* NO, THIS IS NOT AN ACTION   0454 01918000
*                                      MESSAGE                       */ 01919000
*                           IF XVD1AUTH='0'B THEN/* IS THIS USER NOT    01920000
*                                      AUTHORIZED?                   */ 01921000
         B     @RC00443                                            0454 01922000
@RF00443 TM    XVD1AUTH(RBSECPTR),B'00000010'                      0454 01923000
         BNZ   @RF00454                                            0454 01924000
*                             DO;   /* YES                           */ 01925000
*                               PPMSGFLG=' +';/* MOVE IN P/P NO    0456 01926000
*                                      ACTION MSG FLAG               */ 01927000
         L     @10,WQEPTR(,RBSECPTR)                               0456 01928000
         MVC   PPMSGFLG(2,@10),@CC03264                            0456 01929000
*                               TEXTPTR=LENGTH(PPMSGFLG)+1;        0457 01930000
         LA    TEXTPTR,3                                           0457 01931000
*                             END;                                 0458 01932000
*                           ELSE    /* NO, THIS IS A SYSTEM NO ACTION   01933000
*                                      MSG                           */ 01934000
*                             DO;                                  0459 01935000
         B     @RC00454                                            0459 01936000
@RF00454 DS    0H                                                  0460 01937000
*                               MSGACTN=' ';/* MOVE IN SYSTEM NO   0460 01938000
*                                      ACTION FLAG                   */ 01939000
         L     @10,WQEPTR(,RBSECPTR)                               0460 01940000
         MVI   MSGACTN(@10),C' '                                   0460 01941000
*                               TEXTPTR=LENGTH(MSGACTN)+1;         0461 01942000
         LA    TEXTPTR,2                                           0461 01943000
*                             END;                                 0462 01944000
*                       END;        /* OF WTO MSG FLAGGING SECTION   */ 01945000
@RC00454 DS    0H                                                  0463 01946000
@RC00443 DS    0H                                                  0464 01947000
*/********************************************************************/ 01948000
*/*                                                                  */ 01949000
*/*  THE VARIABLE TEXTPTR IS NOW SET TO THE FIRST CHAR OF WPLTXT     */ 01950000
*/*  IN WHICH TO PUT THE MSG. COMPUTE THE MSG LENGTH                 */ 01951000
*/*                                                                  */ 01952000
*/********************************************************************/ 01953000
*                                                                  0464 01954000
*                     IF XVD2WTOR='1'B THEN/* IF A WTOR, MAX TEXT  0464 01955000
*                                      LENGTH IS 122                 */ 01956000
@RC00433 TM    XVD2WTOR(RBSECPTR),B'00000010'                      0464 01957000
         BNO   @RF00464                                            0464 01958000
*                       TEXTLNGT=MIN((XVMSGLGH-4),122);            0465 01959000
         LH    @10,XVMSGLGH(,RBSECPTR)                             0465 01960000
         SL    @10,@CF00084                                        0465 01961000
         LA    @08,122                                             0465 01962000
         CR    @10,@08                                             0465 01963000
         BNH   *+6                                                      01964000
         LR    @10,@08                                             0465 01965000
         ST    @10,TEXTLNGT                                        0465 01966000
*                     ELSE          /* IF WTO, MAX TEXT LENGTH IS 125*/ 01967000
*                       TEXTLNGT=MIN((XVMSGLGH-4),125);            0466 01968000
*                                                                  0466 01969000
         B     @RC00464                                            0466 01970000
@RF00464 LH    @10,XVMSGLGH(,RBSECPTR)                             0466 01971000
         SL    @10,@CF00084                                        0466 01972000
         LA    @08,125                                             0466 01973000
         CR    @10,@08                                             0466 01974000
         BNH   *+6                                                      01975000
         LR    @10,@08                                             0466 01976000
         ST    @10,TEXTLNGT                                        0466 01977000
*/********************************************************************/ 01978000
*/*                                                                  */ 01979000
*/* MOVE MESSAGE TEXT INTO WQE.                                      */ 01980000
*/*                                                                  */ 01981000
*/********************************************************************/ 01982000
*                                                                  0467 01983000
*                     WQETXT(TEXTPTR:TEXTLNGT+TEXTPTR-1)=WPLTXT;   0467 01984000
@RC00464 L     @08,WQEPTR(,RBSECPTR)                               0467 01985000
         ALR   @08,TEXTPTR                                         0467 01986000
         L     @15,TEXTLNGT                                        0467 01987000
         LR    @14,TEXTPTR                                         0467 01988000
         ALR   @14,@15                                             0467 01989000
         SLR   @14,TEXTPTR                                         0467 01990000
         BCTR  @14,0                                               0467 01991000
         EX    @14,@SM03342                                        0467 01992000
*                     ISCAN=TEXTPTR+TEXTLNGT;/*              @ZA19274*/ 01993000
         ALR   @15,TEXTPTR                                         0468 01994000
         LR    ISCAN,@15                                           0468 01995000
*/********************************************************************/ 01996000
*/*                                                                  */ 01997000
*/*  NOW SCAN BACKWARDS LOOKING FOR FIRST NON BLANK CHARACTER.       */ 01998000
*/*  THIS TECHNIQUE IS USED, RATHER THAN STORING COUNT OF EACH NON-  */ 01999000
*/*  BLANK CHARACTER AND THUS HAVING THE LOCATION OF LAST NON-BLANK  */ 02000000
*/*  AT THE END OF THE LOOP, AS IT IS FASTER FOR THE TYPICAL CASE.   */ 02001000
*/*  WHICH IS A NON-BLANK CHARACTER AT THE END OF THE LINE           */ 02002000
*/*                                                                  */ 02003000
*/********************************************************************/ 02004000
*                                                                  0469 02005000
*                     DO ISCAN=ISCAN-1 TO TEXTPTR BY-1 WHILE(WQETXT(    02006000
*                           ISCAN)=' ');                           0469 02007000
         LR    @08,ISCAN                                           0469 02008000
         BCTR  @08,0                                               0469 02009000
         LR    ISCAN,@08                                           0469 02010000
         B     @DE00469                                            0469 02011000
@DL00469 L     @08,WQEPTR(,RBSECPTR)                               0469 02012000
         ALR   @08,ISCAN                                           0469 02013000
         CLI   WQETXT-1(@08),C' '                                  0469 02014000
         BNE   @DC00469                                            0469 02015000
*                     END;          /* THE DO WHILE IS ALLTHAT IS  0470 02016000
*                                      NEEDED TO DO THE SCAN.        */ 02017000
         BCTR  ISCAN,0                                             0470 02018000
@DE00469 CR    ISCAN,TEXTPTR                                       0470 02019000
         BNL   @DL00469                                            0470 02020000
@DC00469 DS    0H                                                  0471 02021000
*/********************************************************************/ 02022000
*/*                                                                  */ 02023000
*/*  CHECK IF MESSAGE WAS ALL BLANK                                  */ 02024000
*/*                                                                  */ 02025000
*/********************************************************************/ 02026000
*                                                                  0471 02027000
*                     IF ISCAN<TEXTPTR THEN/* DID WE NOT FIND A NON     02028000
*                                      BLANK CHAR                    */ 02029000
         CR    ISCAN,TEXTPTR                                       0471 02030000
         BNL   @RF00471                                            0471 02031000
*                       TEXTLNGT=TEXTPTR;/* YES, THE MSG LENGTH    0472 02032000
*                                      INCLUDES 1 BLNK               */ 02033000
         ST    TEXTPTR,TEXTLNGT                                    0472 02034000
*                     ELSE          /* NO, WE FOUND A NON-BLANK      */ 02035000
*                       TEXTLNGT=ISCAN;/* SET LENGTH                 */ 02036000
         B     @RC00471                                            0473 02037000
@RF00471 ST    ISCAN,TEXTLNGT                                      0473 02038000
*                     WQENBR=TEXTLNGT;/* STORE LENGTH OF MESSAGE     */ 02039000
@RC00471 L     @10,WQEPTR(,RBSECPTR)                               0474 02040000
         L     @08,TEXTLNGT                                        0474 02041000
         ST    @08,WQENBR(,@10)                                    0474 02042000
*                     WQESEQN=UCMCMID;/* MOVE IN MSG SEQUENCE NUMBER */ 02043000
         L     @08,UCMBASPT(,REG3)                                 0475 02044000
         AL    @08,@CF03336                                        0475 02045000
         L     @08,UCMMCSPT(,@08)                                  0475 02046000
         MVC   WQESEQN(3,@10),UCMCMID+1(@08)                       0475 02047000
*/********************************************************************/ 02048000
*/* CHECK IF THIS IS AN OLD STYLE MESSAGE WHICH HAS NO MCS FLAGS     */ 02049000
*/*                                                          @ZA05154*/ 02050000
*/********************************************************************/ 02051000
*                                                                  0476 02052000
*                     IF WPLMCSF=0 THEN/* ARE THERE NO MCS FLAGS IN     02053000
*                                      THE WPL               @ZA05154*/ 02054000
         LH    @08,WPLMCSF(,REG6)                                  0476 02055000
         N     @08,@CF03329                                        0476 02056000
         LTR   @08,@08                                             0476 02057000
         BNZ   @RF00476                                            0476 02058000
*                       WQEMCSA='1'B;/* IND R/D CODES IN WQ@ZA05154  */ 02059000
*                                                                  0477 02060000
         OI    WQEMCSA(@10),B'10000000'                            0477 02061000
*                     /***********************************************/ 02062000
*                     /*                                             */ 02063000
*                     /* NOTE - THE MCS FIELD IN THE WPL IS SET TO   */ 02064000
*                     /* ALLOW TOTAL MESSAGE PROCESSING BY ALL       */ 02065000
*                     /* CONSOLES RECEIVING THE ORIGINAL MESSAGE.    */ 02066000
*                     /*                                     @ZA05154*/ 02067000
*                     /*                                             */ 02068000
*                     /***********************************************/ 02069000
*                                                                  0478 02070000
*                     ELSE                                         0478 02071000
*                       WQEMCSF=WPLMCSF;/* MOVE IN THE MCS FLAGS     */ 02072000
*                                                                  0478 02073000
         B     @RC00476                                            0478 02074000
@RF00476 L     @10,WQEPTR(,RBSECPTR)                               0478 02075000
         MVC   WQEMCSF(2,@10),WPLMCSF(REG6)                        0478 02076000
*                     /***********************************************/ 02077000
*                     /*                                             */ 02078000
*                     /* CHECK IF THIS IS A WTP THAT IS TO GO TO     */ 02079000
*                     /* HARDCOPY ONLY. IGC0203E WOULD HAVE SET      */ 02080000
*                     /* XVD0HDCY ON IF THIS SITUATION EXISTS.       */ 02081000
*                     /*                                             */ 02082000
*                     /***********************************************/ 02083000
*                                                                  0479 02084000
*                     IF XVD0HDCY='1'B THEN/* DO WE SEND THIS MSG TO    02085000
*                                      HC ONLY                       */ 02086000
@RC00476 TM    XVD0HDCY(RBSECPTR),B'00000001'                      0479 02087000
         BNO   @RF00479                                            0479 02088000
*                       WQEMCSG='1'B;/* YES, TURN ON HC ONLY MCS FLAG*/ 02089000
         L     @10,WQEPTR(,RBSECPTR)                               0480 02090000
         OI    WQEMCSG(@10),B'00000010'                            0480 02091000
*                     IF WQEMCSB='1'B|/* IS REG0 OR QREG0 MCS FLAG ON*/ 02092000
*                         WQEMCSH='1'B THEN                        0481 02093000
@RF00479 L     @10,WQEPTR(,RBSECPTR)                               0481 02094000
         TM    WQEMCSB(@10),B'01000001'                            0481 02095000
         BZ    @RF00481                                            0481 02096000
*                       WQEUCMID=XVCONID;/* YES. MOVE IN CONSOLE ID  */ 02097000
         IC    @08,XVCONID(,RBSECPTR)                              0482 02098000
         STC   @08,WQEUCMID(,@10)                                  0482 02099000
*                     XVWQEID=UCMCMID;/* SAVE ID FOR RETURN TO THE 0483 02100000
*                                      USER.                         */ 02101000
@RF00481 L     @10,UCMBASPT(,REG3)                                 0483 02102000
         AL    @10,@CF03336                                        0483 02103000
         L     @10,UCMMCSPT(,@10)                                  0483 02104000
         L     @08,UCMCMID(,@10)                                   0483 02105000
         ST    @08,XVWQEID(,RBSECPTR)                              0483 02106000
*                     UCMCMID=UCMCMID+1;/* INCREMENT SEQUENCE NUMBER */ 02107000
         AL    @08,@CF00062                                        0484 02108000
         ST    @08,UCMCMID(,@10)                                   0484 02109000
*                     WQEROUT=XVRCSAVE;/* MOVE IN ROUTE CODES FROM 0485 02110000
*                                      EXIT                          */ 02111000
         L     @10,WQEPTR(,RBSECPTR)                               0485 02112000
         MVC   WQEROUT(2,@10),XVRCSAVE(RBSECPTR)                   0485 02113000
*                     WQEDESCD=XVDESCD;/* MOVE IN DESC CODES FROM  0486 02114000
*                                      EXIT                          */ 02115000
         MVC   WQEDESCD(2,@10),XVDESCD(RBSECPTR)                   0486 02116000
*                     IF XVD2MSGT='1'B THEN/* WAS MSGTYP SPECIFIED?  */ 02117000
         TM    XVD2MSGT(RBSECPTR),B'00100000'                      0487 02118000
         BNO   @RF00487                                            0487 02119000
*                       WQEMSGTP=XVMSGTYP;/* MOVE IN SAVED MSG TYPE     02120000
*                                      FLAGS                         */ 02121000
         MVC   WQEMSGTP(2,@10),XVMSGTYP(RBSECPTR)                  0488 02122000
*                     WQEBUFB='1'B; /* INDICATE THE WQE IS IN USE    */ 02123000
@RF00487 DS    0H                                                  0490 02124000
*                     WQEBUFD='1'B; /* INDICATE THE QWE            0490 02125000
*                                      DYNAMICALLYGOTTEN             */ 02126000
         L     @10,WQEPTR(,RBSECPTR)                               0490 02127000
         OI    WQEBUFB(@10),B'01010000'                            0490 02128000
*/********************************************************************/ 02129000
*/*                                                                  */ 02130000
*/* IF WTOR FILL IN REPLY ID AND SET DESC CODES                      */ 02131000
*/*                                                                  */ 02132000
*/********************************************************************/ 02133000
*                                                                  0491 02134000
*                     IF XVD2WTOR='1'B THEN                        0491 02135000
         TM    XVD2WTOR(RBSECPTR),B'00000010'                      0491 02136000
         BNO   @RF00491                                            0491 02137000
*                       DO;                                        0492 02138000
*                         WQERPYID=OREID;/* MOVE IN REPLY ID         */ 02139000
         L     @08,OREPTR(,RBSECPTR)                               0493 02140000
         MVC   WQERPYID(2,@10),OREID(@08)                          0493 02141000
*                         WQEORE='1'B;/* TURN ON ORE EXISTS BIT      */ 02142000
*                         WQEWTOR='1'B;/* INDICATE THAT THIS WQE IS     02143000
*                                      FOR A WTOR                    */ 02144000
         OI    WQEORE(@10),B'00101000'                             0495 02145000
*                         WQEDESCD='0200'X;/* MOVE IN DESC CODE OF 7    02146000
*                                      ONLY FOR WTOR                 */ 02147000
         MVC   WQEDESCD(2,@10),@CB03267                            0496 02148000
*                       END;        /* OF WTOR HANDLING              */ 02149000
*/********************************************************************/ 02150000
*/*                                                                  */ 02151000
*/* CHECK IF USER IS P/P. IF SO DON'T ALLOW BY PASS HC               */ 02152000
*/*                                                                  */ 02153000
*/********************************************************************/ 02154000
*                                                                  0498 02155000
*                     IF XVD1PP='1'B THEN/* IS USER A P/P            */ 02156000
@RF00491 TM    XVD1PP(RBSECPTR),B'00000100'                        0498 02157000
         BNO   @RF00498                                            0498 02158000
*                       WQEMCSN='0'B;/* YES, USER CAN'T BY PASS HC.  */ 02159000
         L     @10,WQEPTR(,RBSECPTR)                               0499 02160000
         NI    WQEMCSN(@10),B'11111011'                            0499 02161000
*                     IF WQEMCSH='1'B&/* DID NOT AUTH USER SPECIFY 0500 02162000
*                                      QREG0                         */ 02163000
*                         XVD1AUTH='0'B THEN                       0500 02164000
@RF00498 L     @10,WQEPTR(,RBSECPTR)                               0500 02165000
         TM    WQEMCSH(@10),B'00000001'                            0500 02166000
         BNO   @RF00500                                            0500 02167000
         TM    XVD1AUTH(RBSECPTR),B'00000010'                      0500 02168000
         BNZ   @RF00500                                            0500 02169000
*                       DO;         /* YES. SWITCH USER TO REG0 -  0501 02170000
*                                      CONDITION- AL QUEUE TO THAT 0501 02171000
*                                      CONSOLE                       */ 02172000
*                         WQEMCSH='0'B;/* TURN OFF QREG0 MCS FLAG    */ 02173000
*                         WQEMCSB='1'B;/* TURN ON REG0 MCS FLAG      */ 02174000
         OI    WQEMCSB(@10),B'01000000'                            0503 02175000
         NI    WQEMCSH(@10),B'11111110'                            0503 02176000
*                       END;                                       0504 02177000
*                     WQEASID=ASCBASID;/* MOVE IN ASID OF THIS MEMORY*/ 02178000
@RF00500 L     @10,WQEPTR(,RBSECPTR)                               0505 02179000
         MVC   WQEASID(2,@10),ASCBASID(ASCBPTR)                    0505 02180000
*                     WQETCB=REG4;  /* MOVE IN ADDR OF CURRENT TCB   */ 02181000
         ST    REG4,WQETCB(,@10)                                   0506 02182000
*                     WQEJSTCB=TCBJSTCB;/* MOVE IN ADDR OF JOB STEPS    02183000
*                                      TCB                           */ 02184000
         L     @08,TCBJSTCB(,TCBPTR)                               0507 02185000
         ST    @08,WQEJSTCB(,@10)                                  0507 02186000
*/********************************************************************/ 02187000
*/*                                                                  */ 02188000
*/* PUT IN USER AUTHORIZATION                                        */ 02189000
*/*                                                                  */ 02190000
*/********************************************************************/ 02191000
*                                                                  0508 02192000
*                     IF XVD1AUTH='1'B THEN/* IS USER AUTHORIZED     */ 02193000
         TM    XVD1AUTH(RBSECPTR),B'00000010'                      0508 02194000
         BNO   @RF00508                                            0508 02195000
*                       WQEAUTH='1'B;/* YES, INDICATE SO             */ 02196000
         OI    WQEAUTH(@10),B'00000001'                            0509 02197000
*                     ELSE                                         0510 02198000
*                       WQEAUTH='0'B;/* NO, MAKE SURE BIT IS OFF     */ 02199000
         B     @RC00508                                            0510 02200000
@RF00508 L     @10,WQEPTR(,RBSECPTR)                               0510 02201000
         NI    WQEAUTH(@10),B'11111110'                            0510 02202000
*/********************************************************************/ 02203000
*/*                                                                  */ 02204000
*/*  NOW SET QUEUE FOR HC IF ALREADY INDICATED                       */ 02205000
*/*                                                                  */ 02206000
*/********************************************************************/ 02207000
*                                                                  0511 02208000
*                     IF XVD2QFHC='1'B THEN/* IS QUEUE FOR HC      0511 02209000
*                                      INDICATED                     */ 02210000
@RC00508 TM    XVD2QFHC(RBSECPTR),B'00000001'                      0511 02211000
         BNO   @RF00511                                            0511 02212000
*                       WQEQFHC='1'B;/* YES, SET SAVE BIT ON IN WQE  */ 02213000
         L     @10,WQEPTR(,RBSECPTR)                               0512 02214000
         OI    WQEQFHC(@10),B'01000000'                            0512 02215000
*                     ELSE                                         0513 02216000
*                       WQEQFHC='0'B;/* NO, INSURE BIT IS OFF        */ 02217000
         B     @RC00511                                            0513 02218000
@RF00511 L     @10,WQEPTR(,RBSECPTR)                               0513 02219000
         NI    WQEQFHC(@10),B'10111111'                            0513 02220000
*/********************************************************************/ 02221000
*/*                                                                  */ 02222000
*/* CHECK IF TIME IS TO BE TAKEN                                     */ 02223000
*/*                                                                  */ 02224000
*/********************************************************************/ 02225000
*                                                                  0514 02226000
*                     IF WPLMCSFI='1'B THEN/* IS DO NOT TIME STAMP ON*/ 02227000
@RC00511 TM    WPLMCSFI(REG6),B'10000000'                          0514 02228000
         BNO   @RF00514                                            0514 02229000
*                       WQETS='';   /* YES, FILL TIME STAMP WITH   0515 02230000
*                                      BLANKS                        */ 02231000
         L     @10,WQEPTR(,RBSECPTR)                               0515 02232000
         MVI   WQETS(@10),C' '                                     0515 02233000
         MVC   WQETS+1(7,@10),WQETS(@10)                           0515 02234000
*                     ELSE          /* NO, UNPACK THE TIME STAMP     */ 02235000
*                       DO;         /* FILL IN THE TIME FIELD.       */ 02236000
         B     @RC00514                                            0516 02237000
@RF00514 DS    0H                                                  0517 02238000
*                         UNPK(TSAREA,TIMEFLD);/* PUT UNPACKED TIME     02239000
*                                      STAMP INTO WQETS              */ 02240000
         UNPK  TSAREA(7),TIMEFLD(4,RBSECPTR)                       0517 02241000
*                         WQETSHH=TSAREAHH;/* MOVE IN THE HOURS PART    02242000
*                                      OF THE TIME                   */ 02243000
         L     @10,WQEPTR(,RBSECPTR)                               0518 02244000
         MVC   WQETSHH(2,@10),TSAREAHH                             0518 02245000
*                         WQEPER1=PERIOD;/* INSERT FIRST SEPERATOR   */ 02246000
         MVI   WQEPER1(@10),C'.'                                   0519 02247000
*                         WQETSMM=TSAREAMM;/* MOVE IN THE MINUTES  0520 02248000
*                                      PART                          */ 02249000
         MVC   WQETSMM(2,@10),TSAREAMM                             0520 02250000
*                         WQEPER2=PERIOD;/* PUT IN THE SECOND      0521 02251000
*                                      SEPERATOR                     */ 02252000
         MVI   WQEPER2(@10),C'.'                                   0521 02253000
*                         WQETSSS=TSAREASS;/* MOVE IN THE SECONDS  0522 02254000
*                                      PART OF THE TIME              */ 02255000
         MVC   WQETSSS(2,@10),TSAREASS                             0522 02256000
*                       END;                                       0523 02257000
*                     WQEPAD1=' ';  /* INSERT BLANK BETWEEN TS AND 0524 02258000
*                                      jobname                       */ 02259000
@RC00514 L     @10,WQEPTR(,RBSECPTR)                               0524 02260000
         MVI   WQEPAD1(@10),C' '                                   0524 02261000
*                     WQEPAD2=' ';  /* INSERT BLANK AFTER THE JOBNAME*/ 02262000
         MVI   WQEPAD2(@10),C' '                                   0525 02263000
*                     WQEJOBNM=' '; /* BLANK OUT THE JOB NAME FIELD  */ 02264000
         MVI   WQEJOBNM+1(@10),C' '                                0526 02265000
         MVC   WQEJOBNM+2(6,@10),WQEJOBNM+1(@10)                   0526 02266000
         MVI   WQEJOBNM(@10),C' '                                  0526 02267000
*/********************************************************************/ 02268000
*/*                                                                  */ 02269000
*/* NOW DECODE THE ROUTE CODES                                       */ 02270000
*/*                                                                  */ 02271000
*/********************************************************************/ 02272000
*                                                                  0527 02273000
*                     RFY                                          0527 02274000
*                       REG2 RSTD;  /* REG2 AND REG3 WILL BE USED AS    02275000
*                                      A PAIR BY SLDL. REG3 IS     0527 02276000
*                                      ALREADY RSTD.                 */ 02277000
*                     REG3=ROUTMAP; /* PICK UP UNDECODED ROUTE CODES */ 02278000
         L     REG3,ROUTMAP(,@10)                                  0528 02279000
*                     DO ISCAN=1 TO 4;/* CONVERT FOUR ROUTE        0529 02280000
*                                      CHARACTERS                    */ 02281000
         LA    ISCAN,1                                             0529 02282000
@DL00529 DS    0H                                                  0530 02283000
*                       REG2=0;     /* PREPARE FOR SHIFT             */ 02284000
         SLR   REG2,REG2                                           0530 02285000
*                       GEN(SLDL  REG2,4)                          0531 02286000
*                       SETS(REG2,REG3);/* MOVE IN FOUR BITS OF ROUTE   02287000
*                                      CODE                          */ 02288000
         SLDL  REG2,4                                                   02289000
*                       REG2=REG2+1;/* MAKE INDEX TO EBCIDIC TABLE A    02290000
*                                      ONE ORIGIN INDEX.             */ 02291000
         AL    REG2,@CF00062                                       0532 02292000
*/********************************************************************/ 02293000
*/*                                                                  */ 02294000
*/* NOW USE THE FOUR BITS IN REG2 TO PICK UP THE PROPER CHARACTER    */ 02295000
*/* FROM THE CHARACTER TABLE                                         */ 02296000
*/*                                                                  */ 02297000
*/********************************************************************/ 02298000
*                                                                  0533 02299000
*                       WQERR(ISCAN)=CHARTAB(REG2);                0533 02300000
         L     @08,WQEPTR(,RBSECPTR)                               0533 02301000
         ALR   @08,ISCAN                                           0533 02302000
         LA    @01,CHARTAB-1(REG2)                                 0533 02303000
         MVC   WQERR-1(1,@08),0(@01)                               0533 02304000
*                     END;                                         0534 02305000
         AL    ISCAN,@CF00062                                      0534 02306000
         C     ISCAN,@CF00084                                      0534 02307000
         BNH   @DL00529                                            0534 02308000
*                     WQEPAD=' ';   /* INSERT BLANK AFTER ROUTE      */ 02309000
         L     @10,WQEPTR(,RBSECPTR)                               0535 02310000
         MVI   WQEPAD(@10),C' '                                    0535 02311000
*                     RFY                                          0536 02312000
*                       REG2 UNRSTD;                               0536 02313000
*                     REG3=CVTPTR;  /* RESET REG3 TO POINT AT CVTMAP */ 02314000
         L     REG3,CVTPTR                                         0537 02315000
*                     WQESUSP='1'B; /* SUSPEND OPERATION OF WQE FOR     02316000
*                                      SUBSYSTEM EXIT                */ 02317000
         OI    WQESUSP(@10),B'00000010'                            0538 02318000
*/********************************************************************/ 02319000
*/*                                                                  */ 02320000
*/*  PUT WQE ON THE QUEUE. CHECK IF QUEUE IS EMPTY                   */ 02321000
*/*                                                                  */ 02322000
*/********************************************************************/ 02323000
*                                                                  0539 02324000
*                     IF UCMWQEND=0 THEN/* IF QUEUE IS EMPTY SET UP     02325000
*                                      FOR INSERT                    */ 02326000
         L     @10,UCMBASPT(,REG3)                                 0539 02327000
         L     @08,UCMWQEND(,@10)                                  0539 02328000
         LTR   @08,@08                                             0539 02329000
         BNZ   @RF00539                                            0539 02330000
*                       UCMWQEND=ADDR(UCMWTOQ);/* PT AT HEAD OF CHAIN*/ 02331000
         LA    @08,UCMWTOQ(,@10)                                   0540 02332000
         ST    @08,UCMWQEND(,@10)                                  0540 02333000
*                     UCMWQEND->WQELKPA=XVWQEAD;/* PT LAST WQE AT NEW   02334000
*                                      WQE                           */ 02335000
@RF00539 L     @10,UCMBASPT(,REG3)                                 0541 02336000
         L     @08,UCMWQEND(,@10)                                  0541 02337000
         L     @02,XVWQEAD(,RBSECPTR)                              0541 02338000
         STCM  @02,7,WQELKPA(@08)                                  0541 02339000
*                     UCMWQEND=XVWQEAD;/* PT END OF CHAIN AT NEW WQE */ 02340000
         ST    @02,UCMWQEND(,@10)                                  0542 02341000
*                     WQELKP=0;     /* INDICATE LAST ON THE CHAIN    */ 02342000
         L     @08,WQEPTR(,RBSECPTR)                               0543 02343000
         SLR   @02,@02                                             0543 02344000
         ST    @02,WQELKP(,@08)                                    0543 02345000
*/*** END OF BUILDWQE ************************************************/ 02346000
*/*   CHECK IF WTO HAS BEEN MARKED FOR DELETION. IF SO MARK  @Y02668P*/ 02347000
*/*   IT AS SERVICED AND SEND IT TO HARDCOPY.                @Y02668P*/ 02348000
*                                                                  0544 02349000
*                     IF XVD2DELW='1'B THEN/* IS WQE TO BE DELETED?     02350000
*                                                            @Y02668P*/ 02351000
         TM    XVD2DELW(RBSECPTR),B'00001000'                      0544 02352000
         BNO   @RF00544                                            0544 02353000
*                       DO;         /* YES, DELETE THIS MESSAGE    0545 02354000
*                                                            @Y02668P*/ 02355000
*                         WQEBUFE='1'B;/* MARK WQE AS SERVICED     0546 02356000
*                                                            @Y02668P*/ 02357000
         OI    WQEBUFE(@08),B'00001000'                            0546 02358000
*                         UCMSYSI='1'B;/* IND. CLEAN UP IS NEEDED  0547 02359000
*                                                            @Y02668P*/ 02360000
         AL    @10,@CF03336                                        0547 02361000
         L     @10,UCMMCSPT(,@10)                                  0547 02362000
         OI    UCMSYSI(@10),B'10000000'                            0547 02363000
*                         WQEQFHC='1'B;/* SEND MESSAGE TO HARDCOPY 0548 02364000
*                                                            @Y02668P*/ 02365000
         OI    WQEQFHC(@08),B'01000000'                            0548 02366000
*                         WQEBUFC='1'B;/* IND. READY FOR HARDCOPY  0549 02367000
*                                                            @Y02668P*/ 02368000
         OI    WQEBUFC(@08),B'00100000'                            0549 02369000
*                       END;        /* END IF DELETE IS SPECIFIED  0550 02370000
*                                                            @Y02668P*/ 02371000
*/********************************************************************/ 02372000
*/*                                                                  */ 02373000
*/* FREE THE HELD LOCKS AND FRR PRIOR TO TAKING THE SUBSYSTEM EXIT   */ 02374000
*/*                                                                  */ 02375000
*/********************************************************************/ 02376000
*                                                                  0551 02377000
*                     CALL FREELOCK;                               0551 02378000
*                                                                  0551 02379000
@RF00544 BAL   @14,FREELOCK                                        0551 02380000
*/********************************************************************/ 02381000
*/*                                                                  */ 02382000
*/* TAKE THE SUBSYSTEM EXIT                                          */ 02383000
*/*                                                                  */ 02384000
*/********************************************************************/ 02385000
*                                                                  0552 02386000
*                     PARMFTPT=FTSSEXIT;/* START OF SUBSYSTEM EXIT 0552 02387000
*                                      CODE                          */ 02388000
         L     @10,PARMPTR                                         0552 02389000
         MVI   PARMFTPT(@10),X'08'                                 0552 02390000
*                     PARMRTAD=ADDR(VWTOSSRT);/* IF ERROR TURN OFF 0553 02391000
*                                      DELETE BIT                    */ 02392000
         LA    @08,VWTOSSRT                                        0553 02393000
         ST    @08,PARMRTAD(,@10)                                  0553 02394000
*/********************************************************************/ 02395000
*/*                                                                  */ 02396000
*/*   HASPEXIT - EXIT TO THE JOB ENTRY SUBSYSTEM                     */ 02397000
*/*                                                                  */ 02398000
*/*  THE SPACE FOR THE SSOB AND SSOBWT IS OBTAINED FROM SUBPOOL 231  */ 02399000
*/*  WITH THE AUTOMATIC VARIABLES.                                   */ 02400000
*/*                                                                  */ 02401000
*/********************************************************************/ 02402000
*                                                                  0554 02403000
*                     RFY                                          0554 02404000
*                       REG15 RSTD;                                0554 02405000
*                                                                  0554 02406000
*/********************************************************************/ 02407000
*/*                                                                  */ 02408000
*/*   SET UP THE SSOB                                                */ 02409000
*/*                                                                  */ 02410000
*/********************************************************************/ 02411000
*                                                                  0555 02412000
*                     SSOBID='SSOB';/* FILL IN THE ID FIELD          */ 02413000
         MVC   SSOBID(4),@CC03269                                  0555 02414000
*                     SSOBLEN=LENGTH(SSOB);/* AND THE LENGTH FIELD   */ 02415000
         MVC   SSOBLEN(2),@CH00333                                 0556 02416000
*                     SSOBFUNC=SSOBWTO;/* SPECIFY WTO EXIT TO THE  0557 02417000
*                                      SUBSYSTEM                     */ 02418000
         MVC   SSOBFUNC(2),@CH00034                                0557 02419000
*                     SSOBSSIB=0;   /* INDICATE SUBSYSTEM WHICH    0558 02420000
*                                      INITIATED THE USER.           */ 02421000
         SLR   @14,@14                                             0558 02422000
         ST    @14,SSOBSSIB                                        0558 02423000
*                     SSOBINDV=ADDR(SSWT);/* POINT AT WTO INTERFACE     02424000
*                                      BLOCK                         */ 02425000
         LA    @14,SSWT                                            0559 02426000
         ST    @14,SSOBINDV                                        0559 02427000
*/********************************************************************/ 02428000
*/*                                                                  */ 02429000
*/*   NOW FILL IN THE SSWT BLOCK                                     */ 02430000
*/*                                                                  */ 02431000
*/********************************************************************/ 02432000
*                                                                  0560 02433000
*                     SSWTLEN=LENGTH(SSWT);/* PUT LENGTH OF SSWT INTO   02434000
*                                      THE SSWT                      */ 02435000
         MVC   SSWTLEN(2),@CH00092                                 0560 02436000
*                     SSWTWQE=XVWQEAD;/* PUT IN THE ADDR OF THE WQE  */ 02437000
         L     @14,XVWQEAD(,RBSECPTR)                              0561 02438000
         ST    @14,SSWTWQE                                         0561 02439000
*/********************************************************************/ 02440000
*/*                                                                  */ 02441000
*/*   CHECK FOR A WTOR. IF SO THEN FILL IN ADDR OF THE ORE. IF NOT   */ 02442000
*/*   THEN SET THE SSWTORE FIELD TO ZERO.                            */ 02443000
*/*                                                                  */ 02444000
*/********************************************************************/ 02445000
*                                                                  0562 02446000
*                     IF XVD2WTOR='1'B THEN/* IS THIS A WTOR REQUEST */ 02447000
         TM    XVD2WTOR(RBSECPTR),B'00000010'                      0562 02448000
         BNO   @RF00562                                            0562 02449000
*                       SSWTORE=XVOREAD;/* YES, PUT IN THE ADDR OF 0563 02450000
*                                      THE ORE                       */ 02451000
         L     @14,XVOREAD(,RBSECPTR)                              0563 02452000
         ST    @14,SSWTORE                                         0563 02453000
*                     ELSE                                         0564 02454000
*                       SSWTORE=0;  /* NO, SET FIELD TO ZERO         */ 02455000
         B     @RC00562                                            0564 02456000
@RF00562 SLR   @14,@14                                             0564 02457000
         ST    @14,SSWTORE                                         0564 02458000
*                     SSWTMIN=0;    /* THERE IS NO MINOR FOR A SINGLE   02459000
*                                      WTO                           */ 02460000
@RC00562 SLR   @14,@14                                             0565 02461000
         ST    @14,SSWTMIN                                         0565 02462000
*/*   ? IEFSSREQ  (SSOB);                                            */ 02463000
*/*                                                                  */ 02464000
*/*  PASS CONTROL TO JOB ENTRY SUBSYSTEM TO                          */ 02465000
*/*  PROCESS REQUEST -                                               */ 02466000
*/*                                                                  */ 02467000
*/*    INPUT - REGISTER 1 POINTS TO A ONE-                           */ 02468000
*/*            WORD PARAMETER LIST WHICH                             */ 02469000
*/*            POINTS TO THE SSOB                                    */ 02470000
*/*                                                                  */ 02471000
*                                                                  0566 02472000
*                     CALL SSREQ(SSOB);/* CALL ON THE SUBSYSTEM      */ 02473000
         LA    @14,SSOB                                            0566 02474000
         ST    @14,@AL00001                                        0566 02475000
         MVI   @AL00001,X'80'                                      0566 02476000
         L     @10,CVTJESCT(,REG3)                                 0566 02477000
         L     @15,JESSSREQ(,@10)                                  0566 02478000
         LA    @01,@AL00001                                        0566 02479000
         BALR  @14,@15                                             0566 02480000
*/********************************************************************/ 02481000
*/*                                                                  */ 02482000
*/*   CHECK FOR A REQUEST TO DELETE MESSAGE BY SUBSYSTEM. CHECK FOR  */ 02483000
*/*   GOOD EXIT AND DELETION REQUEST.                                */ 02484000
*/*                                                                  */ 02485000
*/********************************************************************/ 02486000
*                                                                  0567 02487000
*                     IF REG15=SSRTOK&/* WAS EXIT SUCCESSFUL         */ 02488000
*                         SSOBRETN=SSWTNDSP/* AND IS DON'T DISPLAY 0567 02489000
*                                      REQUESTED.                    */ 02490000
*                       THEN        /* YES                           */ 02491000
         LTR   REG15,REG15                                         0567 02492000
         BNZ   @RF00567                                            0567 02493000
         LA    @14,4                                               0567 02494000
         C     @14,SSOBRETN                                        0567 02495000
         BNE   @RF00567                                            0567 02496000
*                       DO;         /* DELETE MESSAGE        @Y02668P*/ 02497000
*                         WQEBUFE='1'B;/* MARK WQE AS SERVICED     0569 02498000
*                                                            @Y02668P*/ 02499000
         L     @10,WQEPTR(,RBSECPTR)                               0569 02500000
         OI    WQEBUFE(@10),B'00001000'                            0569 02501000
*                         UCMSYSI='1'B;/* IND. CLEAN UP IS NEEDED  0570 02502000
*                                                            @Y02668P*/ 02503000
*                                                                  0570 02504000
         LCR   @14,@14                                             0570 02505000
         AL    @14,UCMBASPT(,REG3)                                 0570 02506000
         L     @14,UCMMCSPT(,@14)                                  0570 02507000
         OI    UCMSYSI(@14),B'10000000'                            0570 02508000
*                         /*******************************************/ 02509000
*                         /*                                         */ 02510000
*                         /* CHECK IF HARDCOPY IS TO BE BYPASSED     */ 02511000
*                         /*                                 @Y02668P*/ 02512000
*                         /*                                         */ 02513000
*                         /*******************************************/ 02514000
*                                                                  0571 02515000
*                         IF WQEMCSN='0'B THEN/* BYPASS HARDCOPY SET?   02516000
*                                                            @Y02668P*/ 02517000
         TM    WQEMCSN(@10),B'00000100'                            0571 02518000
         BNZ   @RF00571                                            0571 02519000
*                           DO;     /* NO,SEND MESSAGE TO HARDCOPY 0572 02520000
*                                                            @Y02668P*/ 02521000
*                             WQEBUFC='1'B;/* IND. READY FOR HARDCOPY   02522000
*                                                            @Y02668P*/ 02523000
         OI    WQEBUFC(@10),B'00100000'                            0573 02524000
*                             WQEQFHC='1'B;/* SEND MESSAGE TO      0574 02525000
*                                      HARDCOPY              @Y02668P*/ 02526000
         OI    WQEQFHC(@10),B'01000000'                            0574 02527000
*                           END;    /* END IF BYPASS NOT SET @Y02668P*/ 02528000
*                         ELSE      /* IF BYPASS IS SET      @Y02668P*/ 02529000
*                           DO;     /* DO NOT HARDCOPY MESSAGE     0576 02530000
*                                                            @Y02668P*/ 02531000
         B     @RC00571                                            0576 02532000
@RF00571 DS    0H                                                  0577 02533000
*                             IF XVD2WTOR='1'B THEN/* THIS A WTOR? 0577 02534000
*                                                            @ZA03628*/ 02535000
         TM    XVD2WTOR(RBSECPTR),B'00000010'                      0577 02536000
         BNO   @RF00577                                            0577 02537000
*                               WQEBUFC='1'B;/* YES, SET READY FOR 0578 02538000
*                                      HDCPY                 @ZA03628*/ 02539000
         L     @14,WQEPTR(,RBSECPTR)                               0578 02540000
         OI    WQEBUFC(@14),B'00100000'                            0578 02541000
*                             WQEQFHC='0'B;/* TURN OFF HARDCOPY FLAG    02542000
*                                                            @Y02668P*/ 02543000
@RF00577 L     @14,WQEPTR(,RBSECPTR)                               0579 02544000
         NI    WQEQFHC(@14),B'10111111'                            0579 02545000
*                           END;    /* END IF BYPASS IS SET  @Y02668P*/ 02546000
*                       END;        /* END IF DON'T DISPLAY SPEC   0581 02547000
*                                                            @Y02668P*/ 02548000
@RC00571 DS    0H                                                  0582 02549000
*/***********************************************************@ZA19274*/ 02550000
*/*                                                          @ZA19274*/ 02551000
*/* NOW GET RID OF UNPRINTABLE AND NONDISPLAY CHARACTERS IN  @ZA19274*/ 02552000
*/* THE WQE IF THE USER IS A PROBLEM PROGRAM.                @ZA19274*/ 02553000
*/*                                                          @ZA19274*/ 02554000
*/***********************************************************@ZA19274*/ 02555000
*                                                                  0582 02556000
*                     IF XVD1PP='1'B THEN/* IF PROBLEM PROGRAM THEN     02557000
*                                                            @ZA19274*/ 02558000
@RF00567 TM    XVD1PP(RBSECPTR),B'00000100'                        0582 02559000
         BNO   @RF00582                                            0582 02560000
*                       DO;         /* TRANSLATE HIS MESSAGE TO    0583 02561000
*                                                            @ZA19274*/ 02562000
*                         RFY                                      0584 02563000
*                           REG1 RSTD;/* PRINTABLE AND DISPLAY ONLY     02564000
*                                                            @ZA19274*/ 02565000
*                         RFY                                      0585 02566000
*                           REG15 RSTD;/*                    @ZA19274*/ 02567000
*                         REG15=WQEPTR;/*                    @ZA19274*/ 02568000
         L     REG15,WQEPTR(,RBSECPTR)                             0586 02569000
*                         REG1=TEXTLNGT;/*                   @ZA19274*/ 02570000
         L     REG1,TEXTLNGT                                       0587 02571000
*                         GEN REFS(REG1,TRTAB)(EX REG1,TRINST);/*  0588 02572000
*                                                            @ZA19274*/ 02573000
         EX REG1,TRINST                                                 02574000
*                         GEN DATA;                                0589 02575000
*                         RFY                                      0590 02576000
*                           REG1 UNRSTD;/*                   @ZA19274*/ 02577000
*                         RFY                                      0591 02578000
*                           REG15 UNRSTD;/*                  @ZA19274*/ 02579000
*                       END;        /*                       @ZA19274*/ 02580000
*                                                                  0592 02581000
*                     /***********************************************/ 02582000
*                     /*                                             */ 02583000
*                     /* WE ARE DONE WITH THE SUBSYSTEM EXIT. REGAIN */ 02584000
*                     /* THE LOCKS AND TAKE THE BLOCKS OUT OF THE    */ 02585000
*                     /* SUSPENDED STATE                             */ 02586000
*                     /*                                             */ 02587000
*                     /***********************************************/ 02588000
*                                                                  0593 02589000
*VWTOSSLB:                                                         0593 02590000
*                     CALL SETLOCK;                                0593 02591000
*                                                                  0593 02592000
@RF00582 DS    0H                                                  0593 02593000
VWTOSSLB BAL   @14,SETLOCK                                         0593 02594000
*/********************************************************************/ 02595000
*/*                                                                  */ 02596000
*/* TAKE THE WQE AND ORE OUT OF THE SUSPENDED STATE                  */ 02597000
*/*                                                                  */ 02598000
*/********************************************************************/ 02599000
*                                                                  0594 02600000
*                     PARMFTPT=FTEND;/* END OF THE MODULE            */ 02601000
         L     @10,PARMPTR                                         0594 02602000
         MVI   PARMFTPT(@10),X'09'                                 0594 02603000
*                     PARMRTAD=0;   /* NO RETRY NEEDED               */ 02604000
         SLR   @08,@08                                             0595 02605000
         ST    @08,PARMRTAD(,@10)                                  0595 02606000
*                     WQESUSP='0'B; /* TURN OFF SUSPENDED BIT.       */ 02607000
         L     @10,WQEPTR(,RBSECPTR)                               0596 02608000
         NI    WQESUSP(@10),B'11111101'                            0596 02609000
*                     IF XVD2WTOR='1'B THEN/* IS THERE AN ORE?       */ 02610000
         TM    XVD2WTOR(RBSECPTR),B'00000010'                      0597 02611000
         BNO   @RF00597                                            0597 02612000
*                       ORESUSP='0'B;/* YES, TURN OFF THE SUSPENDED     02613000
*                                      BIT                           */ 02614000
         L     @10,OREPTR(,RBSECPTR)                               0598 02615000
         NI    ORESUSP(@10),B'11101111'                            0598 02616000
*                     CALL FREELOCK;/* FREE ALL LOCKS        @Y02688P*/ 02617000
@RF00597 BAL   @14,FREELOCK                                        0599 02618000
*/********************************************************************/ 02619000
*/*                                                                  */ 02620000
*/* NOW POST THE COMMUNICATIONS TASK TO INDICATE THAT IT HAS WORK    */ 02621000
*/* TO DO. NAMELY A WQE, AND POSSIBLY AN ORE, TO PROCESS             */ 02622000
*/*                                                                  */ 02623000
*/********************************************************************/ 02624000
*                                                                  0600 02625000
*                     RFY                                          0600 02626000
*                       REG1 RSTD;                                 0600 02627000
*                     CALL POSTOECB;/* XMPOST UCMOECB        @ZA03242*/ 02628000
         BAL   @14,POSTOECB                                        0601 02629000
*                     RFY                                          0602 02630000
*                       REG1 UNRSTD;                               0602 02631000
*                   END;            /* OF TEST FOR VALID CONTROL   0603 02632000
*                                      BLOCKS                        */ 02633000
*                 ELSE              /* NO THE CONTROL BLOCKS WERE NOT   02634000
*                                      OBTAINED. FREE THE LOCKS.     */ 02635000
*                   CALL FREELOCK;                                 0604 02636000
         B     @RC00414                                            0604 02637000
@RF00414 BAL   @14,FREELOCK                                        0604 02638000
*               END;                /* OF RETURN TO USER FROM WTP  0605 02639000
*                                      TEST.                         */ 02640000
@RC00414 DS    0H                                                  0606 02641000
*           END;                    /* END OF ELSE CLAUSE OF ZERO MSG   02642000
*                                      LENGTH TEST                   */ 02643000
@RC00323 DS    0H                                                  0607 02644000
*     END;                          /* END OF VALID PARM LIST ELSE 0607 02645000
*                                      CLAUSE                        */ 02646000
@RC00310 DS    0H                                                  0607 02647000
@RC00299 DS    0H                                                  0608 02648000
*/********************************************************************/ 02649000
*/*                                                                  */ 02650000
*/* NOW FREE THE ESTAE SO THAT ABENDS WILL BE SEEN BY THE USER       */ 02651000
*/*                                                                  */ 02652000
*/********************************************************************/ 02653000
*                                                                  0608 02654000
*VWTOERRT:                                                         0608 02655000
*   ;                               /* ERROR RETURN POINT FOR POST   */ 02656000
@RC00244 DS    0H                                                  0608 02657000
VWTOERRT DS    0H                                                  0609 02658000
*/********************************************************************/ 02659000
*/*                                                                  */ 02660000
*/* FREE ESTAE ROUTINE                                               */ 02661000
*/*                                                                  */ 02662000
*/********************************************************************/ 02663000
*                                                                  0609 02664000
*   GEN( ESTAE 0);                                                 0609 02665000
*                                                                  0609 02666000
          ESTAE 0                                                       02667000
*/********************************************************************/ 02668000
*/*                                                                  */ 02669000
*/* CHECK FOR ABEND ERROR SITUATION BEING FOUND                      */ 02670000
*/*                                                                  */ 02671000
*/********************************************************************/ 02672000
*                                                                  0610 02673000
*   IF XVD1PERR='1'B THEN           /* WAS ERROR BIT TURNED ON FOR 0610 02674000
*                                      ABEND                         */ 02675000
*                                                                  0610 02676000
         TM    XVD1PERR(RBSECPTR),B'00000001'                      0610 02677000
         BNO   @RF00610                                            0610 02678000
*     /***************************************************************/ 02679000
*     /*                                                             */ 02680000
*     /* YES, THEN ABEND THE USER WITH CODE D23                      */ 02681000
*     /*                                                             */ 02682000
*     /***************************************************************/ 02683000
*                                                                  0611 02684000
*     DO;                                                          0611 02685000
*       RFY                                                        0612 02686000
*         REG1 RSTD;                                               0612 02687000
*       REG1=ABNDCODE;              /* LOAD REG 1 WITH D23 CODE      */ 02688000
*                                                                  0613 02689000
         L     REG1,ABNDCODE                                       0613 02690000
*       /*************************************************************/ 02691000
*       /*                                                           */ 02692000
*       /* ISSUE SYSTEM ABEND WITH DUMP                              */ 02693000
*       /*                                                           */ 02694000
*       /*************************************************************/ 02695000
*                                                                  0614 02696000
*       GEN(ABEND (1),DUMP,,SYSTEM);                               0614 02697000
         ABEND (1),DUMP,,SYSTEM                                         02698000
*       RFY                                                        0615 02699000
*         REG1 UNRSTD;                                             0615 02700000
*     END;                                                         0616 02701000
*   ELSE                            /* NO, CHECK FOR VALID MESSAGE ID*/ 02702000
*     IF XVD2ZERO='1'B THEN         /* WAS MESSAGE NOT PROCESSED   0617 02703000
*                                      BECAUSE OF ZERO LENGTH      0617 02704000
*                                      MESSAGE?                      */ 02705000
         B     @RC00610                                            0617 02706000
@RF00610 TM    XVD2ZERO(RBSECPTR),B'00000100'                      0617 02707000
         BNO   @RF00617                                            0617 02708000
*       XVWQEID=0;                  /* YES, PASS BACK A ZERO MSG ID  */ 02709000
         SLR   @10,@10                                             0618 02710000
         ST    @10,XVWQEID(,RBSECPTR)                              0618 02711000
*   RFY                                                            0619 02712000
*    (REG1,                                                        0619 02713000
*     REG14) RSTD;                                                 0619 02714000
@RF00617 DS    0H                                                  0619 02715000
@RC00610 DS    0H                                                  0620 02716000
*   REG14=XVRET;                    /* GET RETURN ADDRESS OF CALLER  */ 02717000
         L     REG14,XVRET(,RBSECPTR)                              0620 02718000
*/********************************************************************/ 02719000
*/*                                                                  */ 02720000
*/* WE NOW GENERATE THE EPILOG CODE. PL/S WILL RETURN VALUES IN      */ 02721000
*/* REG15 BUT WE NEED THE VALUE IN REG 1. THUS THE EPILOG CODE IS    */ 02722000
*/* GENERATED AND NOT CREATED BY PL/S.                               */ 02723000
*/*                                                                  */ 02724000
*/****************************************************************** */ 02725000
*                                                                  0621 02726000
*   GEN;                                                           0621 02727000
         L    REG0,@SIZDATD       GET SIZE OF DYNAMIC AREA              02728000
         LR   REG1,REG9           GET ADDR OF DYNAMIC AREA              02729000
         FREEMAIN R,LV=(0),A=(1)  FREE THE AREA                         02730000
        SR    REG15,REG15    CLEAR REGISTER FOR IC                      02731000
        IC    REG15,XVRETCOD(,RBSECPTR) PICK UP RETURN CODE             02732000
         L    REG1,XVWQEID(,RBSECPTR) GET MSG ID TO RETURN              02733000
         BR   REG14               RETURN TO CALLER                      02734000
*   RFY                                                            0622 02735000
*    (REG1,                                                        0622 02736000
*     REG14) UNRSTD;                                               0622 02737000
         EJECT                                                          02738000
*                                                                  0623 02739000
*/********************************************************************/ 02740000
*/*                                                                  */ 02741000
*/*   VWTOLREC - LOG RECOVERY ROUTINE                                */ 02742000
*/*                                                                  */ 02743000
*/*   FUNCTION - THIS ROUTINE IS ENTERED WHEN WE CAN NOT GET A CELL  */ 02744000
*/*   POOL EXTENSION FROM CSA, SUBPOOL 231. WE CHECK TO SEE IF THE   */ 02745000
*/*   REASON FOR THE GETMAIN FAILURE IS DUE TO THE SYSTEM LOG NOT    */ 02746000
*/*   BEING INITIALIZED YET AND CSA HAS BEEN FILLED WITH MESSAGES    */ 02747000
*/*   WAITING TO GO OUT TO THE LOG.  IF THAT IS THE CASE THEN WE     */ 02748000
*/*   RECOVER FROM THE SITUATION BY SWITCHING HARDCOPY TO A CONSOLE  */ 02749000
*/*   AND COMMTASK WILL FLUSH THE MESSAGES. WE WAIT UNTIL THE WQE    */ 02750000
*/*   LIMIT IS DOWN AND THEN PROCEED.  IF THE CAUSE ISN'T DUE TO     */ 02751000
*/*   LOG PROBLEMS THEN WE CAUSE THE CALLER TO BE ABENDED.           */ 02752000
*/*                                                                  */ 02753000
*/*   INPUT - THE INPUT PARM IS THE PTR IN XVSAV THAT WILL HOLD THE  */ 02754000
*/*            CONTROL BLOCKS ADDR. EITHER XVOREAD OR XVWQEAD. THIS  */ 02755000
*/*            FIELD IS ZERO ON INPUT.                               */ 02756000
*/*            UCMWQLM AND UCMRQLM ARE THE LIMITS ON THE NUMBER OF   */ 02757000
*/*            WQES AND ORES THAT WERE SET BY SYSGEN                 */ 02758000
*/*            UCMWQLM1 AND UCMRQLM1 WERE THE LIMITS SET AT IPL      */ 02759000
*/*            UCMFMSGN IS A FLAG WHICH WHEN ON TELLS        @ZA11392*/ 02760000
*/*            IEAVMQWR NOT TO ISSUE ANY WQE THRESHOLD MSGS. @ZA11392*/ 02761000
*/*                                                                  */ 02762000
*/*   OUTPUT - BLKADDR IS RETURNED AS ZERO OR ONE. ZERO MEANS THAT   */ 02763000
*/*            THE ERROR WAS RECOVERED, TRY TO GET ANOTHER CELL.     */ 02764000
*/*            ONE MEANS THAT THE ERROR COULD NOT BE RECOVERED,      */ 02765000
*/*            SO ABEND THE CALLER.                                  */ 02766000
*/*            FLAG UCMFMSGN WILL BE ON.                     @ZA11392*/ 02767000
*/*                                                                  */ 02768000
*/********************************************************************/ 02769000
*                                                                  0623 02770000
*VWTOLREC:                                                         0623 02771000
*   PROC(BLKADDR);                                                 0623 02772000
         B     @PB00002                                            0623 02773000
VWTOLREC STM   @14,@12,@SA00002                                    0623 02774000
         MVC   @PC00002(4),0(@01)                                  0623 02775000
*   DCL                                                            0624 02776000
*     BLKADDR PTR(31);              /* PTR TO BLOCK BEING OBTAINED BY   02777000
*                                      VWTOGETB WHEN PROBLEM OCCURED */ 02778000
*                                                                  0624 02779000
*   /*****************************************************************/ 02780000
*   /*                                                               */ 02781000
*   /* SET FLAG TO INFORM IEAVMQWR NOT TO ISSUE ANY MESSAGES ABOUT   */ 02782000
*   /* WQE USE.                                              @ZA11392*/ 02783000
*   /*                                                               */ 02784000
*   /*****************************************************************/ 02785000
*                                                                  0625 02786000
*   UCMFMSGN='1'B;                  /* FLAG IS IN UCM FIXED EXTENSION   02787000
*                                                            @ZA11392*/ 02788000
*                                                                  0625 02789000
         L     @10,UCMBASPT(,REG3)                                 0625 02790000
         LR    @08,@10                                             0625 02791000
         AL    @08,@CF03345                                        0625 02792000
         L     @08,UCMEXTPT(,@08)                                  0625 02793000
         L     @08,UCMFXPTR(,@08)                                  0625 02794000
         OI    UCMFMSGN(@08),B'00100000'                           0625 02795000
*   /*****************************************************************/ 02796000
*   /*                                                               */ 02797000
*   /* CHECK IF ERROR DUE TO HC GOING TO UNINITIALIZED SYSLOG        */ 02798000
*   /*                                                               */ 02799000
*   /*****************************************************************/ 02800000
*                                                                  0626 02801000
*   IF UCMSYSG='1'B&                /* IS SYSLOG THE HARDCOPY DEVICE */ 02802000
*       BALOGINT='0'B THEN          /* AND LOG NOT INITIALIZED YET 0626 02803000
*                                                            @ZA11392*/ 02804000
         LR    @08,@10                                             0626 02805000
         AL    @08,@CF03336                                        0626 02806000
         L     @08,UCMMCSPT(,@08)                                  0626 02807000
         TM    UCMSYSG(@08),B'00000010'                            0626 02808000
         BNO   @RF00626                                            0626 02809000
         L     @02,CVTMSER(,REG3)                                  0626 02810000
         TM    BALOGINT(@02),B'10000000'                           0626 02811000
         BNZ   @RF00626                                            0626 02812000
*     DO;                                                          0627 02813000
*                                                                  0627 02814000
*       /*************************************************************/ 02815000
*       /*                                                           */ 02816000
*       /* SWITCH THE LIMITS FOR NUMBER OF ORES AND WQES ALLOWED IN  */ 02817000
*       /* THE SYSTEM AT ONE TIME                                    */ 02818000
*       /*                                                           */ 02819000
*       /*************************************************************/ 02820000
*                                                                  0628 02821000
*       UCMWQLM=UCMWQLM1;           /* SET SYSGENED LIMIT TO IPL   0628 02822000
*                                      LIMIT                         */ 02823000
         LH    @02,UCMWQLM1(,@10)                                  0628 02824000
         STH   @02,UCMWQLM(,@10)                                   0628 02825000
*       UCMRQLM=UCMRQLM1;           /* FOR WQES AND ORES.            */ 02826000
*                                                                  0629 02827000
         IC    @02,UCMRQLM1(,@10)                                  0629 02828000
         STC   @02,UCMRQLM(,@10)                                   0629 02829000
*       /*************************************************************/ 02830000
*       /*                                                           */ 02831000
*       /* NOW POST COMMTASK TO SWITCH HARDCOPY                      */ 02832000
*       /*                                                           */ 02833000
*       /*************************************************************/ 02834000
*                                                                  0630 02835000
*       UCMSYSO='1'B;               /* THIS IS A DUMMY ATTN INTERUPT    02836000
*                                      BY SVC 35                     */ 02837000
         OI    UCMSYSO(@08),B'00000010'                            0630 02838000
*       CALL FREELOCK;              /* FREE THE FRR AND LOCKS        */ 02839000
         BAL   @14,FREELOCK                                        0631 02840000
*       XVA0=ADDR(UCMAECB);         /* POST ATTN ECB                 */ 02841000
         L     @10,UCMBASPT(,REG3)                                 0632 02842000
         LA    @08,UCMAECB(,@10)                                   0632 02843000
         ST    @08,XVA0(,RBSECPTR)                                 0632 02844000
*       XVA4=UCMASCB;               /* COMMTASK'S ASCB ADDR          */ 02845000
         L     @08,UCMASCB(,@10)                                   0633 02846000
         ST    @08,XVA4(,RBSECPTR)                                 0633 02847000
*       XVA8=POSTRECY;              /* ADDR OF IEAVMEST              */ 02848000
         L     @10,UCMWAKUP(,@10)                                  0634 02849000
         L     @10,POSTRECY(,@10)                                  0634 02850000
         ST    @10,XVA8(,RBSECPTR)                                 0634 02851000
*       RFY                                                        0635 02852000
*         REG1 RSTD;                                               0635 02853000
*       REG1=ADDR(XVA0);            /* LOAD PTR TO 3 WORD PARM LIST  */ 02854000
         LA    REG1,XVA0(,RBSECPTR)                                0636 02855000
*       GEN( POST ,35,MF=(E,(1)));  /* POST WITH CODE OF 35 FOR WTO  */ 02856000
          POST ,35,MF=(E,(1))                                           02857000
*       RFY                                                        0638 02858000
*         REG1 UNRSTD;                                             0638 02859000
*       CALL SETLOCK;               /* REGAIN THE LOCKS              */ 02860000
         BAL   @14,SETLOCK                                         0639 02861000
*       IF XVD1PRIV='0'B THEN       /* MSG WASN'T ISSUED BY THE    0640 02862000
*                                      COMMTASK OR AN SIRB. THIS   0640 02863000
*                                      CHECK IS SO WE DON'T CAUSE AN    02864000
*                                      SIRB OR COMMTASK TO WAIT.   0640 02865000
*                                      INSTEAD THEY ARE ABENDED WITH    02866000
*                                      A D23 ABEND CODE      @ZA11392*/ 02867000
         TM    XVD1PRIV(RBSECPTR),B'10000000'                      0640 02868000
         BNZ   @RF00640                                            0640 02869000
*         CALL VWTOWAIT(UCMWECBT);  /* WAIT FOR THE WQE LIMIT TO BE     02870000
*                                      REDUCED BELOW THE NEW LIMITS     02871000
*                                                            @ZA11392*/ 02872000
         L     @10,UCMBASPT(,REG3)                                 0641 02873000
         LA    @10,UCMWECBT(,@10)                                  0641 02874000
         ST    @10,@AL00001                                        0641 02875000
         LA    @01,@AL00001                                        0641 02876000
         BAL   @14,VWTOWAIT                                        0641 02877000
*       ELSE                        /* MSG ISSUER WAS COMMTASK OR  0642 02878000
*                                      SIRB                  @ZA11392*/ 02879000
*         BLKADDR=1;                /* SET PARAMETER ADDR TO ERROR 0642 02880000
*                                      COND SO ISSUER WILL BE ABENDED   02881000
*                                                            @ZA11392*/ 02882000
         B     @RC00640                                            0642 02883000
@RF00640 L     @10,@PC00002                                        0642 02884000
         MVC   BLKADDR(4,@10),@CF00062                             0642 02885000
*     END;                                                         0643 02886000
*   ELSE                            /* ERROR NOT DUE TO SYSLOG. SET     02887000
*                                      ERROR RETURN INDICATOR.       */ 02888000
*     BLKADDR=1;                    /* SET PARMAMETER ADDR TO ERROR     02889000
*                                      COND                          */ 02890000
         B     @RC00626                                            0644 02891000
@RF00626 L     @10,@PC00002                                        0644 02892000
         MVC   BLKADDR(4,@10),@CF00062                             0644 02893000
*   RETURN;                         /* GO BACK TO CALLER             */ 02894000
@EL00002 DS    0H                                                  0645 02895000
@EF00002 DS    0H                                                  0645 02896000
@ER00002 LM    @14,@12,@SA00002                                    0645 02897000
         BR    @14                                                 0645 02898000
*   END;                                                           0646 02899000
         B     @EL00002                                            0646 02900000
@PB00002 DS    0H                                                  0646 02901000
         EJECT                                                          02902000
*                                                                  0647 02903000
*/********************************************************************/ 02904000
*/*                                                                  */ 02905000
*/*  VWTOCLNP - VWTO'S CLEAN UP ROUTINE.                             */ 02906000
*/*                                                                  */ 02907000
*/*   FUNCTION - THIS ROUTINE WILL BE CALLED IF THERE IS AN ERROR    */ 02908000
*/*   IN VWTO WHILE IT WAS LOCKED AND BUILDING THE ORE OR WQE. THIS  */ 02909000
*/*   ROUTINE WILL ATTEMP TO FREE THE ORE AND WQE. IT WILL THEN      */ 02910000
*/*   RETURN TO IEAVMFRR WHICH WILL LET THE ERROR CONTINUE.          */ 02911000
*/*                                                                  */ 02912000
*/*  INPUT - REG 2 WILL POINT TO THE USERS FRR PARMLIST.             */ 02913000
*/*          PARMRGAD WILL POINT TO THIS MODULES REG FRR SAVEAREA    */ 02914000
*/*          REG13 WILL POINT TO IEAVMFRR'S SAVEAREA.                */ 02915000
*/*          REG 14 AND 15 WILL BE THE RETURN AND ENTRY REGS.        */ 02916000
*/*          XVSAV WILL CONTAIN INFORMATION ON LOCATION OF ORE/WQE   */ 02917000
*/*                                                                  */ 02918000
*/*    OUTPUT - IEAVMFRR'S REGS WILL BE RESTORED.                    */ 02919000
*/*             THE ORE/WQE, IF ANY WILL BE FREED.                   */ 02920000
*/*                                                                  */ 02921000
*/********************************************************************/ 02922000
*                                                                  0647 02923000
*VWTOCLNP:                                                         0647 02924000
*   GEN;                                                           0647 02925000
*                                                                  0647 02926000
VWTOCLNP DS    0H                                                  0647 02927000
*                           /* SET UP THIS ENTRY POINT AND ALL REGS */  02928000
        USING *,REG15       TEMPORARY BASE REGISTER                     02929000
        SAVE (14,12),,*  PUT NAME IN MODULE                             02930000
        L     REG1,PARMRGAD(,REG2) PICK UP ADDR OF OUR SAVE AREA        02931000
        LM    REG3,REG12,14(REG1)  RESTORE OUR REGISTERS                02932000
        DROP  REG15         MODULE BASE REGS SHOULD BE SET UP NOW       02933000
*   /*****************************************************************/ 02934000
*   /*                                                               */ 02935000
*   /* NOW SAVE THE CALLER'S SAVE AREA ADDRESS                       */ 02936000
*   /*                                                               */ 02937000
*   /*****************************************************************/ 02938000
*                                                                  0648 02939000
*   XVA8=REG13;                     /* USE THE XVSAV WORK AREA       */ 02940000
         ST    REG13,XVA8(,RBSECPTR)                               0648 02941000
*   REG13=REG9;                     /* LOAD OUR OWN SAVEAREA ADDRESS */ 02942000
         LR    REG13,REG9                                          0649 02943000
*   RFY                                                            0650 02944000
*    (REG0,                                                        0650 02945000
*     REG1) RSTD;                                                  0650 02946000
*                                                                  0650 02947000
*   /*****************************************************************/ 02948000
*   /*                                                               */ 02949000
*   /* NOW CHECK IF ORE WAS OBTAINED. IF SO THEN CHECK IF IS WAS ON  */ 02950000
*   /* THE ORE QUEUE                                                 */ 02951000
*   /*                                                               */ 02952000
*   /*****************************************************************/ 02953000
*                                                                  0651 02954000
*   IF XVD1ALDN='1'B&               /* WERE WE THRU GETTING BLOCKS   */ 02955000
*       XVOREAD>1 THEN              /* AND VALID ADDRESS IN THE    0651 02956000
*                                      OREADDR FLD                   */ 02957000
         TM    XVD1ALDN(RBSECPTR),B'00100000'                      0651 02958000
         BNO   @RF00651                                            0651 02959000
         CLC   XVOREAD(4,RBSECPTR),@CF00062                        0651 02960000
         BNH   @RF00651                                            0651 02961000
*     DO;                           /* YES. CHECK IF ORE WAS ON THE     02962000
*                                      CHAIN                         */ 02963000
*       DO REG1=ADDR(UCMRPYQ) BY 0 WHILE(REG1^=0);                 0653 02964000
         L     REG1,UCMBASPT(,REG3)                                0653 02965000
         LA    REG1,UCMRPYQ(,REG1)                                 0653 02966000
         B     @DE00653                                            0653 02967000
@DL00653 DS    0H                                                  0654 02968000
*         IF REG1->ORELKP=XVOREAD THEN/* DOES THIS LINK POINTER POINT   02969000
*                                      TO OUR ORE                    */ 02970000
         L     @10,XVOREAD(,RBSECPTR)                              0654 02971000
         C     @10,ORELKP(,REG1)                                   0654 02972000
         BNE   @RF00654                                            0654 02973000
*           DO;                     /* YES. DECHAIN OUR ORE          */ 02974000
*             REG1->ORELKP=XVOREAD->ORELKP;/* PUT PTR TO NEXT ORE IN    02975000
*                                      PREVIOUS ORE LINK FIELD       */ 02976000
         L     @10,ORELKP(,@10)                                    0656 02977000
         ST    @10,ORELKP(,REG1)                                   0656 02978000
*             REG1=0;               /* GET OUT OF LOOP               */ 02979000
         SLR   REG1,REG1                                           0657 02980000
*           END;                                                   0658 02981000
*         ELSE                      /* NO, NOT OURS. PT TO NEXT ORE  */ 02982000
*           REG1=REG1->ORELKP;                                     0659 02983000
         B     @RC00654                                            0659 02984000
@RF00654 L     REG1,ORELKP(,REG1)                                  0659 02985000
*       END;                        /* THE ORE IS NOW OFF THE ORE  0660 02986000
*                                      CHAIN                         */ 02987000
*                                                                  0660 02988000
@RC00654 DS    0H                                                  0660 02989000
@DE00653 LTR   REG1,REG1                                           0660 02990000
         BNZ   @DL00653                                            0660 02991000
*       /*************************************************************/ 02992000
*       /*                                                           */ 02993000
*       /* FREE THE ORE                                              */ 02994000
*       /*                                                           */ 02995000
*       /*************************************************************/ 02996000
*                                                                  0661 02997000
*       REG0=UCMORECP;              /* CELL POOL ID FOR IRES         */ 02998000
         L     @10,UCMBASPT(,REG3)                                 0661 02999000
         L     REG0,UCMORECP(,@10)                                 0661 03000000
*       REG1=XVOREAD;               /* ADDR OF THE ORE               */ 03001000
         L     REG1,XVOREAD(,RBSECPTR)                             0662 03002000
*       GEN(FREECELL CPID=(0),CELL=(1),BRANCH=YES);/* FREE ORE CELL  */ 03003000
         FREECELL CPID=(0),CELL=(1),BRANCH=YES                          03004000
*/********************************************************************/ 03005000
*/*                                                                  */ 03006000
*/* THIS ORE CELL MAY HAVE BEEN THE LAST ONE IN AN EXTENSION.@ZA05639*/ 03007000
*/* IF SO THEN REG15 IS SET TO 20 BY FREECELL. IF THIS CONDI-@ZA05639*/ 03008000
*/* TION IS FOUND THEN FREE THE EXTENSION. REG0 AND REG1 ARE @ZA05639*/ 03009000
*/* ARE SET BY FREECELL.                                     @ZA05639*/ 03010000
*/*                                                                  */ 03011000
*/********************************************************************/ 03012000
*                                                                  0664 03013000
*       RFY                                                        0664 03014000
*         REG15 RSTD;               /*                       @ZA14990*/ 03015000
*       IF REG15=20 THEN            /* WAS CELL THE LAST IN AN     0665 03016000
*                                      EXTENSION             @ZA05639*/ 03017000
*                                                                  0665 03018000
         C     REG15,@CF00333                                      0665 03019000
         BNE   @RF00665                                            0665 03020000
*         /***********************************************************/ 03021000
*         /*                                                         */ 03022000
*         /* YES, FREE THE EXTENSION.                                */ 03023000
*         /*                                                         */ 03024000
*         /***********************************************************/ 03025000
*                                                                  0666 03026000
*         GEN(FREEMAIN R,LV=(0),A=(1),BRANCH=YES);/*         @ZA05639*/ 03027000
         FREEMAIN R,LV=(0),A=(1),BRANCH=YES                             03028000
*       RFY                                                        0667 03029000
*         REG15 UNRSTD;             /*                       @ZA14990*/ 03030000
@RF00665 DS    0H                                                  0668 03031000
*     END;                                                         0668 03032000
*                                                                  0668 03033000
*   /*****************************************************************/ 03034000
*   /*                                                               */ 03035000
*   /* NOW CHECK IF WQE WAS OBTAINED                                 */ 03036000
*   /*                                                               */ 03037000
*   /*****************************************************************/ 03038000
*                                                                  0669 03039000
*   IF XVD1ALDN='1'B&               /* WERE WE THRU GETTING BLOCKS   */ 03040000
*       XVWQEAD>1 THEN              /* AND VALID ADDRESS IN THE    0669 03041000
*                                      WQEADDR FLD                   */ 03042000
@RF00651 TM    XVD1ALDN(RBSECPTR),B'00100000'                      0669 03043000
         BNO   @RF00669                                            0669 03044000
         CLC   XVWQEAD(4,RBSECPTR),@CF00062                        0669 03045000
         BNH   @RF00669                                            0669 03046000
*     DO;                           /* YES. CHECK IF WQE WAS ON THE     03047000
*                                      CHAIN                         */ 03048000
*       DO REG1=ADDR(UCMWTOQ) BY 0 WHILE(REG1^=0);                 0671 03049000
         L     REG1,UCMBASPT(,REG3)                                0671 03050000
         LA    REG1,UCMWTOQ(,REG1)                                 0671 03051000
         B     @DE00671                                            0671 03052000
@DL00671 DS    0H                                                  0672 03053000
*         IF REG1->WQELKPA=XVWQEAD THEN/* DOES THIS LINK POINTER   0672 03054000
*                                      POINT TO OUR WQE              */ 03055000
         L     @10,XVWQEAD(,RBSECPTR)                              0672 03056000
         L     @08,WQELKPA-1(,REG1)                                0672 03057000
         LA    @08,0(,@08)                                         0672 03058000
         CR    @10,@08                                             0672 03059000
         BNE   @RF00672                                            0672 03060000
*           DO;                     /* YES. DECHAIN OUR WQE          */ 03061000
*             REG1->WQELKPA=XVWQEAD->WQELKPA;/* PUT PTR TO NEXT WQE     03062000
*                                      IN PREVIOUS WQE LINK FIELD    */ 03063000
         MVC   WQELKPA(3,REG1),WQELKPA(@10)                        0674 03064000
*             IF UCMWQEND=XVWQEAD THEN/* WAS THIS WQE THE LAST ON THE   03065000
*                                      CHAIN?                @ZA14990*/ 03066000
         L     @08,UCMBASPT(,REG3)                                 0675 03067000
         C     @10,UCMWQEND(,@08)                                  0675 03068000
         BNE   @RF00675                                            0675 03069000
*               UCMWQEND=REG1;      /* YES. UPDATE PTR IN UCM TO   0676 03070000
*                                      POINT TO NEW END OF WQE CHAIN.   03071000
*                                                            @ZA14990*/ 03072000
         ST    REG1,UCMWQEND(,@08)                                 0676 03073000
*             REG1=0;               /* GET OUT OF LOOP               */ 03074000
@RF00675 SLR   REG1,REG1                                           0677 03075000
*           END;                                                   0678 03076000
*         ELSE                      /* NO, NOT OURS. PT TO NEXT WQE  */ 03077000
*           REG1=REG1->WQELKPA;                                    0679 03078000
         B     @RC00672                                            0679 03079000
@RF00672 L     @10,WQELKPA-1(,REG1)                                0679 03080000
         LA    @10,0(,@10)                                         0679 03081000
         LR    REG1,@10                                            0679 03082000
*       END;                        /* THE WQE IS NOW OFF THE WQE  0680 03083000
*                                      CHAIN                         */ 03084000
*                                                                  0680 03085000
@RC00672 DS    0H                                                  0680 03086000
@DE00671 LTR   REG1,REG1                                           0680 03087000
         BNZ   @DL00671                                            0680 03088000
*       /*************************************************************/ 03089000
*       /*                                                           */ 03090000
*       /* FREE THE WQE                                              */ 03091000
*       /*                                                           */ 03092000
*       /*************************************************************/ 03093000
*                                                                  0681 03094000
*       REG0=UCMWQECP;              /* CELL POOL ID FOR WQES         */ 03095000
         L     @10,UCMBASPT(,REG3)                                 0681 03096000
         L     REG0,UCMWQECP(,@10)                                 0681 03097000
*       REG1=XVWQEAD;               /* ADDR OF THE WQE               */ 03098000
         L     REG1,XVWQEAD(,RBSECPTR)                             0682 03099000
*       GEN(FREECELL CPID=(0),CELL=(1),BRANCH=YES);/* FREE WQE CELL  */ 03100000
         FREECELL CPID=(0),CELL=(1),BRANCH=YES                          03101000
*/********************************************************************/ 03102000
*/*                                                          @ZA05639*/ 03103000
*/* THIS WQE CELL MAY HAVE BEEN THE LAST ONE IN AN EXTENSION.@ZA05639*/ 03104000
*/* IF SO THEN REG15 IS SET TO 20 BY FREECELL. IF THIS CONDI-@ZA05639*/ 03105000
*/* TION IS FOUND THEN FREE THE EXTENSION. REG0 AND REG1 ARE @ZA05639*/ 03106000
*/* SET BY FREECELL                                          @ZA05639*/ 03107000
*/*                                                          @ZA05639*/ 03108000
*/********************************************************************/ 03109000
*                                                                  0684 03110000
*       RFY                                                        0684 03111000
*         REG15 RSTD;               /*                       @ZA14990*/ 03112000
*       IF REG15=20 THEN            /* WAS CELL THE LAST IN AN     0685 03113000
*                                      EXTENSION             @ZA05639*/ 03114000
*                                                                  0685 03115000
         C     REG15,@CF00333                                      0685 03116000
         BNE   @RF00685                                            0685 03117000
*         /***********************************************************/ 03118000
*         /*                                                         */ 03119000
*         /* YES, FREE THE EXTENSION.                                */ 03120000
*         /*                                                         */ 03121000
*         /***********************************************************/ 03122000
*                                                                  0686 03123000
*         GEN(FREEMAIN R,LV=(0),A=(1),BRANCH=YES);                 0686 03124000
         FREEMAIN R,LV=(0),A=(1),BRANCH=YES                             03125000
*       RFY                                                        0687 03126000
*         REG15 UNRSTD;             /*                       @ZA14990*/ 03127000
@RF00685 DS    0H                                                  0688 03128000
*     END;                                                         0688 03129000
*   REG13=XVA8;                     /* RESTORE CALLER'S SAVE AREA  0689 03130000
*                                      ADDR                          */ 03131000
@RF00669 L     REG13,XVA8(,RBSECPTR)                               0689 03132000
*   GEN EXIT NOSEQFLOW(RETURN (14,12));/* GO BACK TO IEAVMFRR ROUTINE*/ 03133000
         RETURN (14,12)                                                 03134000
*   RFY                                                            0691 03135000
*    (REG0,                                                        0691 03136000
*     REG1) UNRSTD;                                                0691 03137000
         EJECT                                                          03138000
*                                                                  0692 03139000
*/********************************************************************/ 03140000
*/*                                                                  */ 03141000
*/*   VWTOVALR                                                       */ 03142000
*/*                                                                  */ 03143000
*/*      FUNCTION THIS ROUTINE GETS CONTROL IF THERE IS AN ERROR     */ 03144000
*/*      WHILE CHECKING OUT THE WPL. IT WILL TURN OFF THE VALIDITY   */ 03145000
*/*      BIT (XVD1VALD) AND BRANCH TO VWTOCONT. THE USER WILL BE     */ 03146000
*/*      ABENDED WITH A D23 ABEND CODE.                              */ 03147000
*/*                                                                  */ 03148000
*/********************************************************************/ 03149000
*                                                                  0692 03150000
*VWTOVALR:                                                         0692 03151000
*   XVD2VALD='0'B;                  /* WPL IS NOT VALID              */ 03152000
VWTOVALR NI    XVD2VALD(RBSECPTR),B'11101111'                      0692 03153000
*   PARMRTAD=0;                     /* CLEAR RETRY ADDR SO WE DONT 0693 03154000
*                                      LOOP                          */ 03155000
         L     @10,PARMPTR                                         0693 03156000
         SLR   @08,@08                                             0693 03157000
         ST    @08,PARMRTAD(,@10)                                  0693 03158000
*   GO TO VWTOCONT;                 /* CONTINUE PROCESSING AND ABEND    03159000
*                                      USER                          */ 03160000
         B     VWTOCONT                                            0694 03161000
         SPACE 5                                                        03162000
*                                                                  0695 03163000
*/********************************************************************/ 03164000
*/*                                                                  */ 03165000
*/*  VWTOSSRT - RETYR ROUTINE FOR SUBSYTEM EXIT                      */ 03166000
*/*                                                                  */ 03167000
*/*  FUNCTION - THIS ROUTINE WILL GET CONTROL IF THERE WAS AN ERROR  */ 03168000
*/*   IN THE SUBSYSTEM WTO EXIT ROUTINE. WE WILL TURN OFF XVD2DELW   */ 03169000
*/*  SO THAT THE MESSAGE WILL BE SURE TO GO OUT.  THEN WE BRANCH TO  */ 03170000
*/*  VWTOSSLB TO CONTINUE THE PROCESSING                             */ 03171000
*/*                                                                  */ 03172000
*/********************************************************************/ 03173000
*                                                                  0695 03174000
*VWTOSSRT:                                                         0695 03175000
*   XVD2DELW='0'B;                  /* DONT DELETE THE MESSAGE       */ 03176000
VWTOSSRT NI    XVD2DELW(RBSECPTR),B'11110111'                      0695 03177000
*   GO TO VWTOSSLB;                 /* CONTINUE WITH PROCESSING      */ 03178000
         B     VWTOSSLB                                            0696 03179000
         EJECT                                                          03180000
*                                                                  0697 03181000
*/********************************************************************/ 03182000
*/*  GETBLOCK                                                        */ 03183000
*/*                                                                  */ 03184000
*/*  FUNCTION: THIS ROUTINE WILL GET CORE FOR EITHER A WQE OR ORE.   */ 03185000
*/*     THE OBTAINED CORE WILL BE ZEROED OUT.                        */ 03186000
*/*                                                                  */ 03187000
*/*  INPUT: TYPE INDICATES THE TYPE OF BLOCK TO GET. WQE OR ORE      */ 03188000
*/*          XVD0WWB MAY BE ON INDICATING THAT A WWB HAS BEEN        */ 03189000
*/*     OBTAINED.                                                    */ 03190000
*/*         XVWWB POINTS AT THE WWB.                                 */ 03191000
*/*                                                                  */ 03192000
*/*  OUTPUT: A BLOCK OF THE PROPER SIZE AND ZEROED IS RETURNED TO THE*/ 03193000
*/*     CALLER. IF THE USER WAS ON THE WAIT CHAIN, THE WAIT ECB IS   */ 03194000
*/*     REMOVED.                                                     */ 03195000
*/*     IF THE GETCELL WAS UNSUCCESSFUL THEN THE ADDR PTR IS SET TO  */ 03196000
*/*     ONE INSTEAD OF BEING THE ADDR OF THE NEW CELL.               */ 03197000
*/*                                                                  */ 03198000
*/********************************************************************/ 03199000
*                                                                  0697 03200000
*VWTOGETB:                                                         0697 03201000
*   PROC(TYPE) OPTIONS(SAVE(14),NOSAVEAREA);                       0697 03202000
VWTOGETB ST    @14,12(,@13)                                        0697 03203000
         MVC   @PC00003(4),0(@01)                                  0697 03204000
*   DCL                                                            0698 03205000
*     TYPE FIXED(31);               /* INDICATES TYPE OF BLOCK TO GET*/ 03206000
*   DCL                                                            0699 03207000
*     BITZERO BIT(*) BASED;         /* USED TO ZERO OUT THE BLOCK    */ 03208000
*   RFY                                                            0700 03209000
*    (REG0,                                                        0700 03210000
*     REG1,                                                        0700 03211000
*     REG15) RSTD;                                                 0700 03212000
*                                                                  0700 03213000
*/********************************************************************/ 03214000
*/*                                                                  */ 03215000
*/* CHECK IF REQUEST IS FOR AN ORE OR FOR A WQE                      */ 03216000
*/*                                                                  */ 03217000
*/********************************************************************/ 03218000
*                                                                  0701 03219000
*   IF TYPE=2 THEN                  /* IS THIS REQUEST FOR AN ORE?   */ 03220000
         L     @14,@PC00003                                        0701 03221000
         CLC   TYPE(4,@14),@CF00088                                0701 03222000
         BNE   @RF00701                                            0701 03223000
*     DO;                           /* YES. GET AN ORE CELL          */ 03224000
*       XVOREAD=0;                  /* SET ADDR TO ZERO SO IT CAN BE    03225000
*                                      USED TO INDICATE SUCCESS OF 0703 03226000
*                                      GETCELL                       */ 03227000
         SLR   @14,@14                                             0703 03228000
         ST    @14,XVOREAD(,RBSECPTR)                              0703 03229000
*       DO WHILE(XVOREAD=0);        /* LOOP UNTILL XVOREAD GETS    0704 03230000
*                                      FILLED IN                     */ 03231000
         B     @DE00704                                            0704 03232000
@DL00704 DS    0H                                                  0705 03233000
*         REG0=UCMORECP;            /* PICK UP ORE CELL POOL ID      */ 03234000
         L     @14,UCMBASPT(,REG3)                                 0705 03235000
         L     REG0,UCMORECP(,@14)                                 0705 03236000
*         GEN(GETCELL CPID=(0),BRANCH=YES)                         0706 03237000
*         REFS(REG0,CVTGETCL) SETS(REG1,REG15);                    0706 03238000
*                                                                  0706 03239000
         GETCELL CPID=(0),BRANCH=YES                                    03240000
*/********************************************************************/ 03241000
*/*                                                                  */ 03242000
*/* SEE IF GETCELL WAS SUCCESSFUL                                    */ 03243000
*/*                                                                  */ 03244000
*/********************************************************************/ 03245000
*                                                                  0707 03246000
*         IF REG15=0 THEN           /* DID WE GET A CELL             */ 03247000
         LTR   REG15,REG15                                         0707 03248000
         BNZ   @RF00707                                            0707 03249000
*           DO;                                                    0708 03250000
*             XVOREAD=REG1;         /* SAVE ADDRESS TO ORE           */ 03251000
*                                                                  0709 03252000
         ST    REG1,XVOREAD(,RBSECPTR)                             0709 03253000
*             /*******************************************************/ 03254000
*             /*                                                     */ 03255000
*             /* ZERO OUT THE CONTROL BLOCK                          */ 03256000
*             /*                                                     */ 03257000
*             /*******************************************************/ 03258000
*                                                                  0710 03259000
*             REG1->BITZERO(1:LENGTH(OREF)*8)=''B;                 0710 03260000
         XC    BITZERO(32,REG1),BITZERO(REG1)                      0710 03261000
*             UCMRQNR=UCMRQNR+1;    /* INCREMENT ORE COUNT BY ONE    */ 03262000
         L     @14,UCMBASPT(,REG3)                                 0711 03263000
         LA    @10,1                                               0711 03264000
         AH    @10,UCMRQNR(,@14)                                   0711 03265000
         STH   @10,UCMRQNR(,@14)                                   0711 03266000
*           END;                                                   0712 03267000
*         ELSE                      /* NO THE GETCELL WAS NOT      0713 03268000
*                                      SUCCESSFUL                    */ 03269000
*/********************************************************************/ 03270000
*/*                                                                  */ 03271000
*/* WE DID NOT GET A CELL. CHECK IF WE ARE OUT OF CELLS. IF SO       */ 03272000
*/* THEN GET AN EXTENSION.                                           */ 03273000
*/*                                                                  */ 03274000
*/********************************************************************/ 03275000
*                                                                  0713 03276000
*           IF REG15=4 THEN         /* DO WE NEED TO EXTEND THE CELL    03277000
*                                      POOL                          */ 03278000
         B     @RC00707                                            0713 03279000
@RF00707 C     REG15,@CF00084                                      0713 03280000
         BNE   @RF00713                                            0713 03281000
*             DO;                   /* YES.                          */ 03282000
*               REG1=SUBPL231;      /* SET UP FOR GETMAIN FROM     0715 03283000
*                                      SUBPOOL 231                   */ 03284000
         LA    REG1,231                                            0715 03285000
*               REG0=OREPLSZ;       /* PICK UP SIZE OF ORE POOL    0716 03286000
*                                      EXTENSION.                    */ 03287000
         LA    REG0,1024                                           0716 03288000
*               GEN(GETMAIN  RC,LV=(0),SP=(1),BRANCH=YES)          0717 03289000
*               REFS(REG0,REG1,REG4,REG7,CVTCRMN) SETS(REG1,REG3,REG15) 03290000
*                   ;                                              0717 03291000
         GETMAIN  RC,LV=(0),SP=(1),BRANCH=YES                           03292000
*               REG3=CVTPTR;        /* RELOAD REG3 WHICH WAS       0718 03293000
*                                      DESTROYED BY THE GETMAIN    0718 03294000
*                                      CALLING SEQUENCE.             */ 03295000
*                                                                  0718 03296000
         L     REG3,CVTPTR                                         0718 03297000
*               /*****************************************************/ 03298000
*               /*                                                   */ 03299000
*               /* SEE IF GETMAIN WAS SUCCESSFUL. IF SO BUILD EXTEN. */ 03300000
*               /*                                                   */ 03301000
*               /*****************************************************/ 03302000
*                                                                  0719 03303000
*               IF REG15=0 THEN     /* WAS CORE OBTAINED.            */ 03304000
         LTR   REG15,REG15                                         0719 03305000
         BNZ   @RF00719                                            0719 03306000
*                 DO;               /* YES. EXTEND THE ORE POOL      */ 03307000
*                   CPEXTSAV=REG1;  /* SAVE ADDR OF POOL EXTENSION.  */ 03308000
         LR    CPEXTSAV,REG1                                       0721 03309000
*                   REG15=LENGTH(OREF);/* GET SIZE OF CELL REQUIRED     03310000
*                                      FOR BLD                       */ 03311000
         LA    REG15,32                                            0722 03312000
*                   REG0=UCMORECP;  /* PICK UP ORE CELL POOL ID.     */ 03313000
         L     @14,UCMBASPT(,REG3)                                 0723 03314000
         L     REG0,UCMORECP(,@14)                                 0723 03315000
*                   GEN REFS(REG0,REG1,REG2,CVTBLDCP) SETS(REG15); 0724 03316000
*                                                                  0724 03317000
               BLDCPOOL  CPID=(0),CSIZE=(15),SP=231,CPADDR=(1),       **03318000
               BRANCH=YES,POOLSIZ=1,AUTODEL=YES,SERIAL=YES    @ZA20159  03319000
*/********************************************************************/ 03320000
*/*                                                                  */ 03321000
*/* CHECK IF EXTENSION WAS SUCCESSFUL. IF NOT SET ERROR FLAG ON      */ 03322000
*/*                                                                  */ 03323000
*/********************************************************************/ 03324000
*                                                                  0725 03325000
*                   IF REG15^=0 THEN/* WAS EXTENSION UNSUCCESSFUL    */ 03326000
         LTR   REG15,REG15                                         0725 03327000
         BZ    @RF00725                                            0725 03328000
*                     DO;           /* YES. INDICATE SO IN XVOREAD   */ 03329000
*                                                                  0726 03330000
*                       /*********************************************/ 03331000
*                       /*                                           */ 03332000
*                       /* FREE THE CORE FOR THE EXTENSION           */ 03333000
*                       /*                                           */ 03334000
*                       /*********************************************/ 03335000
*                                                                  0727 03336000
*                       REG0=FROREXT;/* GET SUBPOOL AND LENGTH PARM  */ 03337000
         L     REG0,FROREXT                                        0727 03338000
*                       REG1=CPEXTSAV;/* GET ADDR OF EXTENSION.      */ 03339000
         LR    REG1,CPEXTSAV                                       0728 03340000
*                       GEN(FREEMAIN R,LV=(0),A=(1),BRANCH=YES)    0729 03341000
*                       REFS(REG0,REG1);                           0729 03342000
         FREEMAIN R,LV=(0),A=(1),BRANCH=YES                             03343000
*                       XVOREAD=1;  /* INDICATE NO ORE OBTAINED.     */ 03344000
         MVC   XVOREAD(4,RBSECPTR),@CF00062                        0730 03345000
*                     END;                                         0731 03346000
*                 END;                                             0732 03347000
*               ELSE                                               0733 03348000
*                                                                  0733 03349000
*                 /***************************************************/ 03350000
*                 /*                                                 */ 03351000
*                 /* GETMAIN WAS NOT SUCCESSFUL. CALL ROUTINE TO TO  */ 03352000
*                 /* CHECK IF ERROR IS DUE TO SYSLOG NOT YET         */ 03353000
*                 /* INITIALIZED                                     */ 03354000
*                 /*                                                 */ 03355000
*                 /***************************************************/ 03356000
*                                                                  0733 03357000
*                 CALL VWTOLREC(XVOREAD);                          0733 03358000
         B     @RC00719                                            0733 03359000
@RF00719 LA    @14,XVOREAD(,RBSECPTR)                              0733 03360000
         ST    @14,@AL00001                                        0733 03361000
         LA    @01,@AL00001                                        0733 03362000
         BAL   @14,VWTOLREC                                        0733 03363000
*             END;                  /* OF TEST FOR EXTENSION NEEDED. */ 03364000
*           ELSE                                                   0735 03365000
*                                                                  0735 03366000
*/********************************************************************/ 03367000
*/*                                                                  */ 03368000
*/* THE ERROR WAS NOT DUE TO END OF EXTENSION. THE ERROR CAN NOT     */ 03369000
*/* BE CORRECTED SO SET ERROR INDICATOR FOR CALLER.                  */ 03370000
*/*                                                                  */ 03371000
*/********************************************************************/ 03372000
*                                                                  0735 03373000
*             XVOREAD=1;            /* INDICATE GET ORE UNSUCCESSFUL */ 03374000
         B     @RC00713                                            0735 03375000
@RF00713 MVC   XVOREAD(4,RBSECPTR),@CF00062                        0735 03376000
*       END;                        /* OF DO WHILE LOOP              */ 03377000
@RC00713 DS    0H                                                  0736 03378000
@RC00707 DS    0H                                                  0736 03379000
@DE00704 L     @14,XVOREAD(,RBSECPTR)                              0736 03380000
         LTR   @14,@14                                             0736 03381000
         BZ    @DL00704                                            0736 03382000
*     END;                                                         0737 03383000
*                                                                  0737 03384000
*   /*****************************************************************/ 03385000
*   /*                                                               */ 03386000
*   /* WQE GET CELL PART OF THIS SEGMENT                             */ 03387000
*   /*                                                               */ 03388000
*   /*****************************************************************/ 03389000
*                                                                  0738 03390000
*   ELSE                            /* NO THIS REQUEST IS FOR A WQE  */ 03391000
*     DO;                                                          0738 03392000
         B     @RC00701                                            0738 03393000
@RF00701 DS    0H                                                  0739 03394000
*       XVWQEAD=0;                  /* ZERO OUT ADDR SO IT CAN BE  0739 03395000
*                                      USED TO INDICATE SUCCESS OR 0739 03396000
*                                      FAILURE OF GETCELL.           */ 03397000
         SLR   @14,@14                                             0739 03398000
         ST    @14,XVWQEAD(,RBSECPTR)                              0739 03399000
*       DO WHILE(XVWQEAD=0);        /* LOOP UNTILL ADDR GETS FILLED     03400000
*                                      IN.                           */ 03401000
         B     @DE00740                                            0740 03402000
@DL00740 DS    0H                                                  0741 03403000
*         REG0=UCMWQECP;            /* PICK UP WQE CELL POOL ID.     */ 03404000
         L     @14,UCMBASPT(,REG3)                                 0741 03405000
         L     REG0,UCMWQECP(,@14)                                 0741 03406000
*         GEN(GETCELL CPID=(0),BRANCH=YES)                         0742 03407000
*         REFS(REG0) SETS(REG1,REG15);                             0742 03408000
*                                                                  0742 03409000
         GETCELL CPID=(0),BRANCH=YES                                    03410000
*/********************************************************************/ 03411000
*/*                                                                  */ 03412000
*/* SEE IF GETCELL WAS SUCCESSFUL                                    */ 03413000
*/*                                                                  */ 03414000
*/********************************************************************/ 03415000
*                                                                  0743 03416000
*         IF REG15=0 THEN           /* DID WE GET A CELL             */ 03417000
         LTR   REG15,REG15                                         0743 03418000
         BNZ   @RF00743                                            0743 03419000
*           DO;                                                    0744 03420000
*             XVWQEAD=REG1;         /* SAVE ADDRESS TO WQE           */ 03421000
*                                                                  0745 03422000
         ST    REG1,XVWQEAD(,RBSECPTR)                             0745 03423000
*             /*******************************************************/ 03424000
*             /*                                                     */ 03425000
*             /* ZERO OUT THE CONTROL BLOCK                          */ 03426000
*             /*                                                     */ 03427000
*             /*******************************************************/ 03428000
*                                                                  0746 03429000
*             REG1->BITZERO(1:LENGTH(WQE)*8)=''B;                  0746 03430000
         XC    BITZERO(192,REG1),BITZERO(REG1)                     0746 03431000
*             UCMWQNR=UCMWQNR+1;    /* INCREMENT WQE COUNT           */ 03432000
         L     @14,UCMBASPT(,REG3)                                 0747 03433000
         LA    @10,1                                               0747 03434000
         AH    @10,UCMWQNR(,@14)                                   0747 03435000
         STH   @10,UCMWQNR(,@14)                                   0747 03436000
*           END;                                                   0748 03437000
*                                                                  0748 03438000
*/********************************************************************/ 03439000
*/*                                                                  */ 03440000
*/* WE DID NOT GET A CELL. CHECK IF WE ARE OUT OF CELLS. IF SO       */ 03441000
*/* THEN GET AN EXTENSION.                                           */ 03442000
*/*                                                                  */ 03443000
*/********************************************************************/ 03444000
*                                                                  0749 03445000
*         ELSE                                                     0749 03446000
*           IF REG15=4 THEN         /* DO WE NEED TO EXTEND THE CELL    03447000
*                                      POOL                          */ 03448000
         B     @RC00743                                            0749 03449000
@RF00743 C     REG15,@CF00084                                      0749 03450000
         BNE   @RF00749                                            0749 03451000
*             DO;                   /* YES.                          */ 03452000
*               REG1=SUBPL231;      /* SET UP FOR GETMAIN FROM 231   */ 03453000
         LA    REG1,231                                            0751 03454000
*               REG0=WQEPLSZ;       /* PICK UP SIZE OF WQE EXTENSION */ 03455000
         L     REG0,@CF00308                                       0752 03456000
*               GEN(GETMAIN  RC,LV=(0),SP=(1),BRANCH=YES)          0753 03457000
*               REFS(REG0,REG1,REG4,REG7,CVTCRMN) SETS(REG1,REG3,REG15) 03458000
*                   ;                                              0753 03459000
         GETMAIN  RC,LV=(0),SP=(1),BRANCH=YES                           03460000
*               REG3=CVTPTR;        /* RELOAD REG3 WHICH WAS       0754 03461000
*                                      DESTROYED BY THE GETMAIN    0754 03462000
*                                      CALLING SEQUENCE.             */ 03463000
*                                                                  0754 03464000
         L     REG3,CVTPTR                                         0754 03465000
*               /*****************************************************/ 03466000
*               /*                                                   */ 03467000
*               /* SEE IF GETMAIN WAS SUCCESSFUL. IF SO BUILD        */ 03468000
*               /* EXTENSION.                                        */ 03469000
*               /*                                                   */ 03470000
*               /*****************************************************/ 03471000
*                                                                  0755 03472000
*               IF REG15=0 THEN     /* DID WE GET SPACE FOR THE    0755 03473000
*                                      EXTENSION                     */ 03474000
         LTR   REG15,REG15                                         0755 03475000
         BNZ   @RF00755                                            0755 03476000
*                 DO;               /* YES, BUILD THE WQE EXTENSION  */ 03477000
*                   CPEXTSAV=REG1;  /* SAVE ADDRES OF WQE EXTENSION  */ 03478000
         LR    CPEXTSAV,REG1                                       0757 03479000
*                   REG0=UCMWQECP;  /* PICK UP THE WQE CELL POOL ID  */ 03480000
         L     @14,UCMBASPT(,REG3)                                 0758 03481000
         L     REG0,UCMWQECP(,@14)                                 0758 03482000
*                   REG15=LENGTH(WQE);/* GET SIZE OF CELL REQUIRED.  */ 03483000
         LA    REG15,192                                           0759 03484000
*                   GEN REFS(REG0,REG1,REG2,CVTBLDCP) SETS(REG15); 0760 03485000
*                                                                  0760 03486000
         BLDCPOOL CPID=(0),SP=231,CSIZE=(15),CPADDR=(1),BRANCH=YES,   **03487000
               AUTODEL=YES,POOLSIZ=4,SERIAL=YES               @ZA20159  03488000
*/********************************************************************/ 03489000
*/*                                                                  */ 03490000
*/* CHECK IF EXTENSION WAS SUCCESSFUL. IF NOT SET ERROR FLAG ON      */ 03491000
*/*                                                                  */ 03492000
*/********************************************************************/ 03493000
*                                                                  0761 03494000
*                   IF REG15^=0 THEN/* WAS EXTENSION UNSUCCESSFUL    */ 03495000
         LTR   REG15,REG15                                         0761 03496000
         BZ    @RF00761                                            0761 03497000
*                     DO;           /* YES. INDICATE SO IN XVWQEAD   */ 03498000
*                                                                  0762 03499000
*                       /*********************************************/ 03500000
*                       /*                                           */ 03501000
*                       /* FREE THE WQE POOL EXTENSION.              */ 03502000
*                       /*                                           */ 03503000
*                       /*********************************************/ 03504000
*                                                                  0763 03505000
*                       REG0=FRWQEXT;/* GET SUBPOOL AND LENGTH       */ 03506000
         L     REG0,FRWQEXT                                        0763 03507000
*                       REG1=CPEXTSAV;/* GET ADDRESS OF WQE EXTENSION*/ 03508000
         LR    REG1,CPEXTSAV                                       0764 03509000
*                       GEN(FREEMAIN R,LV=(0),A=(1),BRANCH=YES)    0765 03510000
*                       REFS(REG0,REG1);                           0765 03511000
         FREEMAIN R,LV=(0),A=(1),BRANCH=YES                             03512000
*                       XVWQEAD=1;  /* INDICATE NO WQE OBTAINED.     */ 03513000
         MVC   XVWQEAD(4,RBSECPTR),@CF00062                        0766 03514000
*                     END;                                         0767 03515000
*                 END;                                             0768 03516000
*                                                                  0768 03517000
*               /*****************************************************/ 03518000
*               /*                                                   */ 03519000
*               /* THE GETMAIN WAS NOT SUCCESSFUL. CALL THE LOG      */ 03520000
*               /* RECOVERY ROUTINE TO SEE IF ERROR DUE TO SYSLOG    */ 03521000
*               /* INIT                                              */ 03522000
*               /*                                                   */ 03523000
*               /*****************************************************/ 03524000
*                                                                  0769 03525000
*               ELSE                                               0769 03526000
*                 CALL VWTOLREC(XVWQEAD);/* LOG RECOVERY ROUTINE     */ 03527000
         B     @RC00755                                            0769 03528000
@RF00755 LA    @14,XVWQEAD(,RBSECPTR)                              0769 03529000
         ST    @14,@AL00001                                        0769 03530000
         LA    @01,@AL00001                                        0769 03531000
         BAL   @14,VWTOLREC                                        0769 03532000
*             END;                  /* OF CHECK FOR EXTENSION NEEDED.*/ 03533000
*/********************************************************************/ 03534000
*/*                                                                  */ 03535000
*/* THE ERROR WAS NOT DUE TO END OF EXTENSION. THE ERROR CAN NOT     */ 03536000
*/* BE CORRECTED SO SET ERROR INDICATOR FOR CALLER.                  */ 03537000
*/*                                                                  */ 03538000
*/********************************************************************/ 03539000
*                                                                  0771 03540000
*           ELSE                                                   0771 03541000
*             XVWQEAD=1;            /* INDICATE GET WQE UNSUCCESSFUL */ 03542000
         B     @RC00749                                            0771 03543000
@RF00749 MVC   XVWQEAD(4,RBSECPTR),@CF00062                        0771 03544000
*       END;                        /* OF DO WHILE LOOP              */ 03545000
@RC00749 DS    0H                                                  0772 03546000
@RC00743 DS    0H                                                  0772 03547000
@DE00740 L     @14,XVWQEAD(,RBSECPTR)                              0772 03548000
         LTR   @14,@14                                             0772 03549000
         BZ    @DL00740                                            0772 03550000
*     END;                                                         0773 03551000
*                                                                  0773 03552000
*/********************************************************************/ 03553000
*/*                                                                  */ 03554000
*/* CHECK IF WE HAVE TO FREE THE ECB                                 */ 03555000
*/*                                                                  */ 03556000
*/********************************************************************/ 03557000
*                                                                  0774 03558000
*   IF XVD0WWB='1'B THEN            /* IS THERE A WWB ON THE CHAIN   */ 03559000
@RC00701 TM    XVD0WWB(RBSECPTR),B'00000100'                       0774 03560000
         BNO   @RF00774                                            0774 03561000
*     DO;                           /* YES, FREE IT AND TURN OFF   0775 03562000
*                                      XVD0WWB                       */ 03563000
*                                                                  0775 03564000
*       /*************************************************************/ 03565000
*       /*                                                           */ 03566000
*       /* POINT NEXT WWB AT BACK WWB                                */ 03567000
*       /*                                                           */ 03568000
*       /*************************************************************/ 03569000
*                                                                  0776 03570000
*       WWBFWDPT->WWBBCKPT=WWBBCKPT;                               0776 03571000
*                                                                  0776 03572000
         L     @14,XVWWB(,RBSECPTR)                                0776 03573000
         L     @10,WWBFWDPT(,@14)                                  0776 03574000
         L     @08,WWBBCKPT(,@14)                                  0776 03575000
         ST    @08,WWBBCKPT(,@10)                                  0776 03576000
*       /*************************************************************/ 03577000
*       /*                                                           */ 03578000
*       /* POINT BACK WWB AT NEXT WWB                                */ 03579000
*       /*                                                           */ 03580000
*       /*************************************************************/ 03581000
*                                                                  0777 03582000
*       WWBBCKPT->WWBFWDPT=WWBFWDPT;                               0777 03583000
*                                                                  0777 03584000
         ST    @10,WWBFWDPT(,@08)                                  0777 03585000
*/********************************************************************/ 03586000
*/*                                                                  */ 03587000
*/* WWB IS NOW OFF THE QUEUE. FREE IT                                */ 03588000
*/*                                                                  */ 03589000
*/********************************************************************/ 03590000
*                                                                  0778 03591000
*       REG0=GETWWB;                /* PICK PARMS FOR FREEMAIN       */ 03592000
         L     REG0,GETWWB                                         0778 03593000
*       REG1=XVWWB;                 /* GET ADDRESS OF WWB            */ 03594000
         LR    REG1,@14                                            0779 03595000
*       GEN(FREEMAIN R,LV=(0),A=(1),BRANCH=YES)                    0780 03596000
*       REFS(REG0,REG1);                                           0780 03597000
         FREEMAIN R,LV=(0),A=(1),BRANCH=YES                             03598000
*       RFY                                                        0781 03599000
*        (REG0,                                                    0781 03600000
*         REG1,                                                    0781 03601000
*         REG15) UNRSTD;                                           0781 03602000
*       XVWWB=0;                    /* ZERO OUT ADDRESS OF WWB IN XSA*/ 03603000
         SLR   @10,@10                                             0782 03604000
         ST    @10,XVWWB(,RBSECPTR)                                0782 03605000
*       XVD0WWB='0'B;               /* INDICATE NO WWB ON CHAIN      */ 03606000
         NI    XVD0WWB(RBSECPTR),B'11111011'                       0783 03607000
*     END;                                                         0784 03608000
*   RETURN;                                                        0785 03609000
@EL00003 DS    0H                                                  0785 03610000
@EF00003 DS    0H                                                  0785 03611000
@ER00003 L     @14,12(,@13)                                        0785 03612000
         BR    @14                                                 0785 03613000
*   END VWTOGETB;                                                  0786 03614000
         B     @EL00003                                            0786 03615000
         EJECT                                                          03616000
*                                                                  0787 03617000
*/*** START OF WAITCHN  **********************************************/ 03618000
*/********************************************************************/ 03619000
*/*                                                                  */ 03620000
*/*   WAITCHN - WAIT ON THE ECB IN THE WWB                           */ 03621000
*/*                                                                  */ 03622000
*/*   FUNCTION - THIS ROUTINE WILL CREATE A WWB AND PUT IT ON THE    */ 03623000
*/*     CHAIN POINTED AT BY THE INPUT PARAMETER. IF A WWB ALREADY    */ 03624000
*/*     EXISTS THE ECB PART IS ZEROED. THE ROUTINE FREES THE LOCKS   */ 03625000
*/*     AND THEN WAITS FOR THE ECB TO BE POSTED. THE LOCKS ARE       */ 03626000
*/*     THEN OBTAINED.                                               */ 03627000
*/*                                                                  */ 03628000
*/********************************************************************/ 03629000
*                                                                  0787 03630000
*VWTOWAIT:                                                         0787 03631000
*   PROC(CHNTAIL) OPTIONS(SAVE(14));                               0787 03632000
VWTOWAIT ST    @14,@SA00004                                        0787 03633000
         MVC   @PC00004(4),0(@01)                                  0787 03634000
*   DCL                                                            0788 03635000
*     CHNTAIL PTR(31);              /* PTS AT END OF WQE WWB CHAIN OR   03636000
*                                      ORE WWB CHAIN                 */ 03637000
*/********************************************************************/ 03638000
*/*                                                                  */ 03639000
*/*  CHECK IF A WWB ALREADY EXISTS. IF ONE DOES THEN IT IS ON THE    */ 03640000
*/*  PROPER CHAIN.                                                   */ 03641000
*/*                                                                  */ 03642000
*/********************************************************************/ 03643000
*                                                                  0789 03644000
*   IF XVD0WWB='0'B THEN            /* DO WE NEED TO GET A WWB       */ 03645000
         TM    XVD0WWB(RBSECPTR),B'00000100'                       0789 03646000
         BNZ   @RF00789                                            0789 03647000
*     DO;                           /* YES, GET IT AND PUT IT ON THE    03648000
*                                      CHAIN                         */ 03649000
*       RFY                                                        0791 03650000
*        (REG0,                                                    0791 03651000
*         REG1) RSTD;               /* BOTH REG 0 AND 1 WILL BE USED    03652000
*                                      FOR THE GETMAIN.              */ 03653000
*       REG0=GETWWB;                /* PICK UP GETMAIN PARMS FOR WWB */ 03654000
         L     REG0,GETWWB                                         0792 03655000
*       GEN(GETMAIN R,LV=(0),BRANCH=YES)                           0793 03656000
*       REFS(REG0) SETS(REG1);                                     0793 03657000
         GETMAIN R,LV=(0),BRANCH=YES                                    03658000
*       XVWWB=REG1;                 /* SAVE ADDR OF WWB              */ 03659000
         ST    REG1,XVWWB(,RBSECPTR)                               0794 03660000
*       XVD0WWB='1'B;               /* INDICATE WWB AVAILABLE        */ 03661000
         OI    XVD0WWB(RBSECPTR),B'00000100'                       0795 03662000
*       RFY                                                        0796 03663000
*         WWB BASED(REG1);          /* REG1 DOES PT AT WWB. USE REG1 */ 03664000
*       WWBASCB=REG7;               /* STORE ADDR OF ASCB            */ 03665000
         ST    REG7,WWBASCB(,REG1)                                 0797 03666000
*       WWBTCBAD=REG4;              /* STORE ADDR OF TCB             */ 03667000
         ST    REG4,WWBTCBAD(,REG1)                                0798 03668000
*/********************************************************************/ 03669000
*/*                                                                  */ 03670000
*/* PUT WWB ON THE CHAIN                                             */ 03671000
*/*                                                                  */ 03672000
*/********************************************************************/ 03673000
*                                                                  0799 03674000
*       /*************************************************************/ 03675000
*       /*                                                           */ 03676000
*       /* POINT THIS WWB AT WHATEVER OLD LAST WWB WAS POINTING AT   */ 03677000
*       /*                                                           */ 03678000
*       /*************************************************************/ 03679000
*                                                                  0799 03680000
*       WWBFWDPT=CHNTAIL->WWBFWDPT;                                0799 03681000
         L     @10,@PC00004                                        0799 03682000
         L     @08,CHNTAIL(,@10)                                   0799 03683000
         L     @02,WWBFWDPT(,@08)                                  0799 03684000
         ST    @02,WWBFWDPT(,REG1)                                 0799 03685000
*       CHNTAIL->WWBFWDPT=REG1;     /* LINK LAST CHN MEMBER TO THIS     03686000
*                                      WWB                           */ 03687000
         ST    REG1,WWBFWDPT(,@08)                                 0800 03688000
*       WWBBCKPT=CHNTAIL;           /* PT OUR WWB BACK AT OLD LAST 0801 03689000
*                                      WWB                           */ 03690000
         ST    @08,WWBBCKPT(,REG1)                                 0801 03691000
*       CHNTAIL=REG1;               /* PT END OF CHAIN AT OUR WWB    */ 03692000
         ST    REG1,CHNTAIL(,@10)                                  0802 03693000
*     END;                                                         0803 03694000
*                                                                  0803 03695000
*/********************************************************************/ 03696000
*/*                                                                  */ 03697000
*/*  NOW INDICATE ECB IS WAITING                                     */ 03698000
*/*                                                                  */ 03699000
*/********************************************************************/ 03700000
*                                                                  0804 03701000
*   RFY                                                            0804 03702000
*     WWB BASED(XVWWB);                                            0804 03703000
@RF00789 DS    0H                                                  0805 03704000
*   WWBPOSTD='0'B;                  /* INDICATE NOT POSTED           */ 03705000
         L     @10,XVWWB(,RBSECPTR)                                0805 03706000
         NI    WWBPOSTD(@10),B'01111111'                           0805 03707000
*   WWBECB=0;                       /* READY TO BE POSTED            */ 03708000
         SLR   @08,@08                                             0806 03709000
         ST    @08,WWBECB(,@10)                                    0806 03710000
*   CALL FREELOCK;                                                 0807 03711000
         BAL   @14,FREELOCK                                        0807 03712000
*   REG1=ADDR(WWBECB);              /* LOAD ADDRESS OF ECB FOR WAIT  */ 03713000
*                                                                  0808 03714000
         L     REG1,XVWWB(,RBSECPTR)                               0808 03715000
         LA    REG1,WWBECB(,REG1)                                  0808 03716000
*   /*****************************************************************/ 03717000
*   /*                                                               */ 03718000
*   /* NOW CHECK WHICH MEMORY WE ARE IN AND ISSUE APPROPRIATE WAIT,  */ 03719000
*   /* LONG OR SHORT                                                 */ 03720000
*   /*                                                               */ 03721000
*   /*****************************************************************/ 03722000
*                                                                  0809 03723000
*   IF ASCBASID=1 THEN              /* IF IN MEMORY ONE THEN ISSUE 0809 03724000
*                                      SHORT WAIT AS WE ARE IN     0809 03725000
*                                      COMMTASKS MEMORY.             */ 03726000
         CLC   ASCBASID(2,ASCBPTR),@CH00062                        0809 03727000
         BNE   @RF00809                                            0809 03728000
*     GEN(WAIT ,ECB=(REG1))                                        0810 03729000
*     REFS(REG1);                                                  0810 03730000
         WAIT ,ECB=(REG1)                                               03731000
*   ELSE                            /* WE ARE NOT IN MEMORY ONE SO 0811 03732000
*                                      ISSUE A LONG WAIT TO LET    0811 03733000
*                                      COMMTASK PUT OUT SOME MESSAGES   03734000
*                                      AND FREE UP SOME WQES.        */ 03735000
*     GEN(WAIT ,ECB=(REG1),LONG=YES)                               0811 03736000
*     REFS(REG1);                                                  0811 03737000
         B     @RC00809                                            0811 03738000
@RF00809 DS    0H                                                  0811 03739000
         WAIT ,ECB=(REG1),LONG=YES                                      03740000
*   RFY                                                            0812 03741000
*    (REG0,                                                        0812 03742000
*     REG1) UNRSTD;                                                0812 03743000
@RC00809 DS    0H                                                  0813 03744000
*   CALL SETLOCK;                                                  0813 03745000
         BAL   @14,SETLOCK                                         0813 03746000
*   RETURN;                                                        0814 03747000
@EL00004 DS    0H                                                  0814 03748000
@EF00004 DS    0H                                                  0814 03749000
@ER00004 L     @14,@SA00004                                        0814 03750000
         BR    @14                                                 0814 03751000
*   END VWTOWAIT;                                                  0815 03752000
*                                                                  0815 03753000
*/*** END OF WAITCHN *************************************************/ 03754000
*                                                                  0816 03755000
         EJECT                                                          03756000
*                                                                  0816 03757000
*/********************************************************************/ 03758000
*/*                                                                  */ 03759000
*/* THIS ROUTINE WILL FREE THE ORE POINTED AT BY XVOREAD. IT WILL    */ 03760000
*/* ALSO DECREASE THE COUNT OF ORES BY ONE TO ACCOUNT FOR THE ORE    */ 03761000
*/* JUST FREED.                                                      */ 03762000
*/*                                                                  */ 03763000
*/********************************************************************/ 03764000
*                                                                  0816 03765000
*VWTOFORE:                                                         0816 03766000
*   PROC OPTIONS(SAVE(14),NOSAVEAREA);                             0816 03767000
VWTOFORE ST    @14,12(,@13)                                        0816 03768000
*   RFY                                                            0817 03769000
*    (REG0,                                                        0817 03770000
*     REG1,                                                        0817 03771000
*     REG15) RSTD;                                                 0817 03772000
*   REG0=UCMORECP;                  /* GET ORE CELL POOL ID          */ 03773000
         L     @14,UCMBASPT(,REG3)                                 0818 03774000
         L     REG0,UCMORECP(,@14)                                 0818 03775000
*   REG1=XVOREAD;                   /* GET ADDRESS OF ORE            */ 03776000
*                                                                  0819 03777000
         L     REG1,XVOREAD(,RBSECPTR)                             0819 03778000
*   /*****************************************************************/ 03779000
*   /*                                                               */ 03780000
*   /* FREE THE ORE                                                  */ 03781000
*   /*                                                               */ 03782000
*   /*****************************************************************/ 03783000
*                                                                  0820 03784000
*   GEN(FREECELL CPID=(0),CELL=(1),BRANCH=YES)                     0820 03785000
*   REFS(REG0,REG1,CVTFRECL) SETS(REG0,REG1,REG15);                0820 03786000
*                                                                  0820 03787000
         FREECELL CPID=(0),CELL=(1),BRANCH=YES                          03788000
*/********************************************************************/ 03789000
*/*                                                                  */ 03790000
*/* THIS ORE CELL MAY HAVE BEEN THE LAST ONE IN AN EXTENSION.        */ 03791000
*/* IF SO THEN REG15 IS SET TO 20 BY FREECELL. IF THIS CONDITON IS   */ 03792000
*/* FOUND THEN FREE THE EXTENSION. REG0 AND REG1 ARE SET BY FREECELL */ 03793000
*/*                                                                  */ 03794000
*/********************************************************************/ 03795000
*                                                                  0821 03796000
*   IF REG15=20 THEN                /* WAS CELL THE LAST IN AN     0821 03797000
*                                      EXTENSION                     */ 03798000
*                                                                  0821 03799000
         C     REG15,@CF00333                                      0821 03800000
         BNE   @RF00821                                            0821 03801000
*     /***************************************************************/ 03802000
*     /*                                                             */ 03803000
*     /* YES, FREE THE EXTENSION.                                    */ 03804000
*     /*                                                             */ 03805000
*     /***************************************************************/ 03806000
*                                                                  0822 03807000
*     GEN(FREEMAIN R,LV=(0),A=(1),BRANCH=YES)                      0822 03808000
*     REFS(REG0,REG1,CVTABEND,SCVTRMBR,CVTRMBR,SCVTSECT);          0822 03809000
         FREEMAIN R,LV=(0),A=(1),BRANCH=YES                             03810000
*   RFY                                                            0823 03811000
*    (REG0,                                                        0823 03812000
*     REG1,                                                        0823 03813000
*     REG15) UNRSTD;                                               0823 03814000
@RF00821 DS    0H                                                  0824 03815000
*   UCMRQNR=UCMRQNR-1;              /* DECREASE COUNT OF ORES.       */ 03816000
         L     @10,UCMBASPT(,REG3)                                 0824 03817000
         LH    @08,UCMRQNR(,@10)                                   0824 03818000
         BCTR  @08,0                                               0824 03819000
         STH   @08,UCMRQNR(,@10)                                   0824 03820000
*   END VWTOFORE;                                                  0825 03821000
@EL00005 DS    0H                                                  0825 03822000
@EF00005 DS    0H                                                  0825 03823000
@ER00005 L     @14,12(,@13)                                        0825 03824000
         BR    @14                                                 0825 03825000
         EJECT                                                          03826000
*                                                                  0826 03827000
*/*** START OF SETLOCK  **********************************************/ 03828000
*/*                                                                  */ 03829000
*/*   SETLOCK - OBTAIN THE LOCAL AND CMS LOCK AND INSTALL AN FRR     */ 03830000
*/*                                                                  */ 03831000
*/********************************************************************/ 03832000
*/*                                                                  */ 03833000
*/*  SAVE REGISTER 13 ACROSS SETLOCK                                 */ 03834000
*/*                                                                  */ 03835000
*/********************************************************************/ 03836000
*                                                                  0826 03837000
*SETLOCK:                                                          0826 03838000
*   PROC OPTIONS(SAVE(0,1,11,12,13,14),NOSAVEAREA);                0826 03839000
SETLOCK  ST    @14,12(,@13)                                        0826 03840000
         STM   @00,@01,20(@13)                                     0826 03841000
         STM   @11,@12,64(@13)                                     0826 03842000
*   RFY                                                            0827 03843000
*    (REG0,                                                        0827 03844000
*     REG1) RSTD;                                                  0827 03845000
*   XVA4=REG13;                                                    0828 03846000
         ST    REG13,XVA4(,RBSECPTR)                               0828 03847000
*   GENERATE REFS(PSALITA,FLC);                                    0829 03848000
*                                                                  0829 03849000
*                             /*                                        03850000
        LR   REG0,REG11          SAVE FIRST BASE REG                    03851000
        LR   REG1,REG12          SAVE SECOND BASE REG                   03852000
        SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                        XX03853000
               RELATED=(UCM,IEAVVWTO(FREELOCK))                         03854000
        SETLOCK OBTAIN,TYPE=CMS,MODE=UNCOND,                          XX03855000
               RELATED=(UCM,IEAVVWTO(FREELOCK))                         03856000
        LR   REG11,REG0          RESTORE BASE REG                       03857000
        LR   REG12,REG1          RESTORE BASE REG                       03858000
*   /*****************************************************************/ 03859000
*   /*                                                               */ 03860000
*   /* NOW SET UP THE FRR PROTECTION FOR THIS MODULE.                */ 03861000
*   /*                                                               */ 03862000
*   /*****************************************************************/ 03863000
*                                                                  0830 03864000
*   RFY                                                            0830 03865000
*     REG13 RSTD;                   /* WE NEED REG 1                 */ 03866000
*   REG13=UCMFRRAD;                 /* GET ADDR OF IEAVMFRR FROM CUM */ 03867000
         L     @10,UCMBASPT(,REG3)                                 0831 03868000
         L     REG13,UCMFRRAD(,@10)                                0831 03869000
*   GEN REFS(PSACSTK,FRRSCURR,FRRSLAST,PSALSFCC,FRRSENTR,FRRSELEN, 0832 03870000
*       FRRSFRRA,FRRSPARM);                                        0832 03871000
*                                                                  0832 03872000
        SETFRR A,FRRAD=(REG13),PARMAD=PARMPTR,WRKREGS=(REG11,REG12)     03873000
        LR   REG11,REG0          RESTORE BASE REG                       03874000
        LR   REG12,REG1          RESTORE BASE REG                       03875000
*   /*****************************************************************/ 03876000
*   /*                                                               */ 03877000
*   /* FRR USES REGS 11 AND 12 AS WORK REGS. THE PARM LIST PTED AT BY*/ 03878000
*   /* PARMPTR IS ZEROED BY SETFRR                                   */ 03879000
*   /*                                                               */ 03880000
*   /*****************************************************************/ 03881000
*                                                                  0833 03882000
*   PARMRGAD=ADDR(RECSAVE);         /* PUT ADDR OF SAVE AREA INTO  0833 03883000
*                                      PARM LIST                     */ 03884000
         L     @10,PARMPTR                                         0833 03885000
         LA    @08,RECSAVE                                         0833 03886000
         ST    @08,PARMRGAD(,@10)                                  0833 03887000
*   PARMID=MODULEID;                /* INSERT LAST FOUR LETTERS OF 0834 03888000
*                                      NAME                          */ 03889000
         MVC   PARMID(4,@10),@CC01464                              0834 03890000
*   RFY                                                            0835 03891000
*     PARMLIST BASED(ADDR(EPARM));  /* SET BASE BACK TO ESTAE      0835 03892000
*                                      PARMLIST                      */ 03893000
*                                                                  0835 03894000
*   /*****************************************************************/ 03895000
*   /*                                                               */ 03896000
*   /* THE FOLLOWING PARMFRID FIELD IN THE ESTAE PARAMETER    YM04929*/ 03897000
*   /* LIST IS SET TO ZERO TO GUARANTEE THAT RECOVERY WILL BE YM04929*/ 03898000
*   /* DONE ON BOTH THE ESTAE AND FRR LEVEL.                  YM04929*/ 03899000
*   /*                                                               */ 03900000
*   /*****************************************************************/ 03901000
*                                                                  0836 03902000
*   PARMFRID='0'B;                  /* MODULE PROTECTED BY FRR AND 0836 03903000
*                                      ESTAE                  YM04929*/ 03904000
         LA    @10,EPARM                                           0836 03905000
         NI    PARMFRID(@10),B'11101111'                           0836 03906000
*   RFY                                                            0837 03907000
*     PARMLIST BASED(PARMPTR);      /* RESTORE BASE TO FRR PARMLIST  */ 03908000
*   RFY                                                            0838 03909000
*    (REG0,                                                        0838 03910000
*     REG13,                                                       0838 03911000
*     REG1) UNRSTD;                                                0838 03912000
*                                                                  0838 03913000
*   /*****************************************************************/ 03914000
*   /*                                                               */ 03915000
*   /* RESTORE THE REGISTERS FROM THE SETLOCK                        */ 03916000
*   /*                                                               */ 03917000
*   /*****************************************************************/ 03918000
*                                                                  0839 03919000
*   REG13=XVA4;                     /* RESTORE SAVEAREA PTR    Y02751*/ 03920000
         L     REG13,XVA4(,RBSECPTR)                               0839 03921000
*   END SETLOCK;                                                   0840 03922000
@EL00006 DS    0H                                                  0840 03923000
@EF00006 DS    0H                                                  0840 03924000
@ER00006 L     @14,12(,@13)                                        0840 03925000
         LM    @00,@01,20(@13)                                     0840 03926000
         LM    @11,@12,64(@13)                                     0840 03927000
         BR    @14                                                 0840 03928000
         EJECT                                                          03929000
*                                                                  0841 03930000
*/*** START OF FREELOCK **********************************************/ 03931000
*/*                                                                  */ 03932000
*/*   FREELOCK - FREE THE LOCAL AND CMS LOCKS AND REMOVE THE FRR     */ 03933000
*/*                                                                  */ 03934000
*/********************************************************************/ 03935000
*/********************************************************************/ 03936000
*/*                                                                  */ 03937000
*/*  SAVE REGISTER 13 ACROSS FREEING OF LOCKS                        */ 03938000
*/*                                                                  */ 03939000
*/********************************************************************/ 03940000
*                                                                  0841 03941000
*FREELOCK:                                                         0841 03942000
*   PROC OPTIONS(SAVE(1,15,11,12,13,14),NOSAVEAREA);               0841 03943000
FREELOCK STM   @14,@15,12(@13)                                     0841 03944000
         ST    @01,24(,@13)                                        0841 03945000
         STM   @11,@12,64(@13)                                     0841 03946000
*   RFY                                                            0842 03947000
*    (REG1,                                                        0842 03948000
*     REG15) RSTD;                                                 0842 03949000
*   XVA4=REG13;                                                    0843 03950000
         ST    REG13,XVA4(,RBSECPTR)                               0843 03951000
*   GEN(SETFRR  D,WRKREGS=(REG1,REG15))                            0844 03952000
*   REFS(FRRSEMP);                  /* FREE THE FRR. USE 1 & 15 AS 0844 03953000
*                                      WORK REGS.                    */ 03954000
         SETFRR  D,WRKREGS=(REG1,REG15)                                 03955000
*   RFY                                                            0845 03956000
*    (REG1,                                                        0845 03957000
*     REG15) UNRSTD;                                               0845 03958000
*   GENERATE;                                                      0846 03959000
        SETLOCK RELEASE,TYPE=CMS,RELATED=(UCM,IEAVVWTO(SETLOCK))        03960000
        SETLOCK RELEASE,TYPE=LOCAL,RELATED=(UCM,IEAVVWTO(SETLOCK))      03961000
*   PARMPTR=ADDR(EPARM);            /* PT AT ESTAES PARM AREA NOW    */ 03962000
         LA    @10,EPARM                                           0847 03963000
         ST    @10,PARMPTR                                         0847 03964000
*   PARMFRID='0'B;                  /* SIGNAL FRR NO LONGER IN PLACE    03965000
*                                      TO ESTAE                      */ 03966000
         NI    PARMFRID(@10),B'11101111'                           0848 03967000
*   REG13=XVA4;                                                    0849 03968000
         L     REG13,XVA4(,RBSECPTR)                               0849 03969000
*   END FREELOCK;                                                  0850 03970000
@EL00007 DS    0H                                                  0850 03971000
@EF00007 DS    0H                                                  0850 03972000
@ER00007 LM    @14,@15,12(@13)                                     0850 03973000
         L     @01,24(,@13)                                        0850 03974000
         LM    @11,@12,64(@13)                                     0850 03975000
         BR    @14                                                 0850 03976000
         EJECT                                                          03977000
*                                                                  0851 03978000
*/********************************************************************/ 03979000
*/* POSTOECB - THIS ROUTINE SETS UP THE INTERFACE NECESSARY  @ZA03242*/ 03980000
*/*            TO BRANCH ENTER XMPOST WITH AN INDICATOR SET          */ 03981000
*/*            TO RUN THE ERRET ROUTINE IN THE MASTER                */ 03982000
*/*            SCHEDULER ADDRESS SPACE                               */ 03983000
*/********************************************************************/ 03984000
*                                                                  0851 03985000
*POSTOECB:                                                         0851 03986000
*   PROC;                           /* XMPOST PROC           @ZA03242*/ 03987000
POSTOECB STM   @14,@12,@SA00008                                    0851 03988000
*   RFY                                                            0852 03989000
*    (REG10,                                                       0852 03990000
*     REG15) RSTD;                                                 0852 03991000
*   REG15=CVT0PT01;                 /* GET ENTRY POINT ADDRESS FOR 0853 03992000
*                                      BRANCH ENTRY TO XMPOST      0853 03993000
*                                                            @ZA03242*/ 03994000
         L     REG15,CVT0PT01(,REG3)                               0853 03995000
*   REG1=0;                         /* CLEAR R1              @ZA03242*/ 03996000
         SLR   REG1,REG1                                           0854 03997000
*   REG1=REG1|'80000000'X;          /* SET UP REG1 FOR USE AS BIT  0855 03998000
*                                      MASK TO PREVENT THE NEED FOR A   03999000
*                                      REFERENCE TO STORAGE ONCE THE    04000000
*                                      BASEREG HAS BEEN UPDATED.   0855 04001000
*                                                            @ZA03242*/ 04002000
         O     REG1,@CF03313                                       0855 04003000
*   REG10=0;                        /* COMPLETION CODE WITH WHICH TO    04004000
*                                      POST UCMOECB          @ZA03242*/ 04005000
         SLR   REG10,REG10                                         0856 04006000
*   REG13=UCMASCB;                  /* ASCB OF MEMORY CONTAINING ECB    04007000
*                                      TO BE POSTED          @ZA03242*/ 04008000
         L     @14,UCMBASPT(,REG3)                                 0857 04009000
         L     REG13,UCMASCB(,@14)                                 0857 04010000
*   REG11=ADDR(UCMOECB);            /* POST THE WTO ECB IN COMTASK 0858 04011000
*                                                            @ZA03242*/ 04012000
         LA    REG11,UCMOECB(,@14)                                 0858 04013000
*   REG11=REG11|REG1;               /* SET END OF LIST       @ZA03242*/ 04014000
         OR    REG11,REG1                                          0859 04015000
*   REG12=UCMWAKUP;                 /* IF XMPOST ERROR LET IEAVMEST     04016000
*                                      GET CONTROL           @ZA03242*/ 04017000
         L     REG12,UCMWAKUP(,@14)                                0860 04018000
*   REG12=REG12|REG1;               /* SET BIT TO SHOW ERRET IS TO 0861 04019000
*                                      RUN IN MASTER SCHEDULER MEMORY   04020000
*                                                            @ZA03242*/ 04021000
         OR    REG12,REG1                                          0861 04022000
*   GEN(BALR REG14,REG15);          /* POST COMTASK          @ZA03242*/ 04023000
         BALR REG14,REG15                                               04024000
*   RFY                                                            0863 04025000
*    (REG10,                                                       0863 04026000
*     REG15) UNRSTD;                /*                       @ZA03242*/ 04027000
*   RETURN;                         /* RETURN TO MAINLINE    @ZA03242*/ 04028000
@EL00008 DS    0H                                                  0864 04029000
@EF00008 DS    0H                                                  0864 04030000
@ER00008 LM    @14,@12,@SA00008                                    0864 04031000
         BR    @14                                                 0864 04032000
*   END POSTOECB;                   /*                       @ZA03242*/ 04033000
*   END                                                            0866 04034000
*                                                                  0866 04035000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 04036000
*/*%INCLUDE SYSUT5  (PROLOG  )                                       */ 04037000
*/*%INCLUDE SYSUT5  (DECLARES)                                       */ 04038000
*/*%INCLUDE SYSLIB  (IHACTM  )                                       */ 04039000
*/*%INCLUDE SYSLIB  (IEFJSSOB)                                       */ 04040000
*/*%INCLUDE SYSLIB  (IEFJESCT)                                       */ 04041000
*/*%INCLUDE SYSLIB  (IHAORE  )                                       */ 04042000
*/*%INCLUDE SYSLIB  (IHAWQE  )                                       */ 04043000
*/*%INCLUDE SYSLIB  (IEZWPL  )                                       */ 04044000
*/*%INCLUDE SYSLIB  (IEECUCM )                                       */ 04045000
*/*%INCLUDE SYSLIB  (IHAFRRS )                                       */ 04046000
*/*%INCLUDE SYSLIB  (IEEBASEA)                                       */ 04047000
*/*%INCLUDE SYSLIB  (IHAESTA )                                       */ 04048000
*/*%INCLUDE SYSLIB  (IHARB   )                                       */ 04049000
*/*%INCLUDE SYSLIB  (IKJRB   )                                       */ 04050000
*/*%INCLUDE SYSLIB  (IKJTCB  )                                       */ 04051000
*/*%INCLUDE SYSLIB  (IHAASVT )                                       */ 04052000
*/*%INCLUDE SYSLIB  (IHAASCB )                                       */ 04053000
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */ 04054000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 04055000
*/*%INCLUDE SYSLIB  (IHASCVT )                                       */ 04056000
*/*%INCLUDE SYSUT5  (SETESTAE)                                       */ 04057000
*/*%INCLUDE SYSUT5  (SETUPXSA)                                       */ 04058000
*/*%INCLUDE SYSUT5  (VALIDCHK)                                       */ 04059000
*/*%INCLUDE SYSUT5  (USEREXIT)                                       */ 04060000
*/*%INCLUDE SYSUT5  (GETBLKS )                                       */ 04061000
*/*%INCLUDE SYSUT5  (GETID   )                                       */ 04062000
*/*%INCLUDE SYSUT5  (BUILDORE)                                       */ 04063000
*/*%INCLUDE SYSUT5  (BUILDWQE)                                       */ 04064000
*/*%INCLUDE SYSUT5  (HASPEXIT)                                       */ 04065000
*/*%INCLUDE SYSUT5  (FREESTAE)                                       */ 04066000
*/*%INCLUDE SYSUT5  (LOGRECVY)                                       */ 04067000
*/*%INCLUDE SYSUT5  (VWTOCLNP)                                       */ 04068000
*/*%INCLUDE SYSUT5  (GETBLOCK)                                       */ 04069000
*/*%INCLUDE SYSUT5  (WAITCHN )                                       */ 04070000
*/*%INCLUDE SYSUT5  (FREEORE )                                       */ 04071000
*/*%INCLUDE SYSUT5  (SETLOCK )                                       */ 04072000
*/*%INCLUDE SYSUT5  (FREELOCK)                                       */ 04073000
*                                                                  0866 04074000
*       ;                                                          0866 04075000
@DATA    DS    0H                                                       04076000
@CH00034 DC    H'9'                                                     04077000
@CH00092 DC    H'16'                                                    04078000
@SM03337 MVC   USERTEXT(0),WPLTXT(REG6)                                 04079000
@SM03342 MVC   WQETXT-1(0,@08),WPLTXT(REG6)                             04080000
         DS    0F                                                       04081000
@AL00344 DC    A(@CF00088)             LIST WITH   1 ARGUMENT(S)        04082000
@AL00388 DC    A(@CF00062)             LIST WITH   1 ARGUMENT(S)        04083000
@DATD    DSECT                                                          04084000
         DS    0F                                                       04085000
@SA00001 DS    18F                                                      04086000
@PC00003 DS    1F                                                       04087000
@SA00004 DS    1F                                                       04088000
@PC00004 DS    1F                                                       04089000
@SA00008 DS    15F                                                      04090000
@SA00002 DS    15F                                                      04091000
@PC00002 DS    1F                                                       04092000
@AL00001 DS    1A                                                       04093000
@TF00001 DS    F                                                        04094000
IEAVVWTO CSECT                                                          04095000
         DS    0F                                                       04096000
@CF00062 DC    F'1'                                                     04097000
@CH00062 EQU   @CF00062+2                                               04098000
@CF00088 DC    F'2'                                                     04099000
@CF00084 DC    F'4'                                                     04100000
@CF01082 DC    F'5'                                                     04101000
@CF00187 DC    F'6'                                                     04102000
@CF00061 DC    F'8'                                                     04103000
@CF00333 DC    F'20'                                                    04104000
@CH00333 EQU   @CF00333+2                                               04105000
@CF00308 DC    F'4096'                                                  04106000
@CF03345 DC    F'-8'                                                    04107000
@CF03336 DC    F'-4'                                                    04108000
@CF03250 DC    F'-1'                                                    04109000
@CF03313 DC    XL4'80000000'                                            04110000
@CF03329 DC    XL4'0000FFFF'                                            04111000
@DATD    DSECT                                                          04112000
         DS    0D                                                       04113000
TEXTLNGT DS    F                                                        04114000
PARMPTR  DS    A                                                        04115000
@TS00001 DS    CL1                                                      04116000
STARTID  DS    CL1                                                      04117000
         DS    CL6                                                      04118000
CVDAREA  DS    CL8                                                      04119000
TSAREA   DS    CL7                                                      04120000
         ORG   TSAREA                                                   04121000
TSAREAHH DS    CL2                                                      04122000
TSAREAMM DS    CL2                                                      04123000
TSAREASS DS    CL2                                                      04124000
         ORG   TSAREA+7                                                 04125000
         DS    CL1                                                      04126000
USERPARM DS    CL136                                                    04127000
         ORG   USERPARM                                                 04128000
USERTEXT DS    CL128                                                    04129000
USERROUT DS    CL4                                                      04130000
         ORG   USERROUT                                                 04131000
USERRC   DS    CL2                                                      04132000
         ORG   USERPARM+132                                             04133000
USERDESC DS    CL4                                                      04134000
         ORG   USERDESC                                                 04135000
USERDC   DS    CL2                                                      04136000
         ORG   USERPARM+136                                             04137000
SSOB     DS    CL20                                                     04138000
         ORG   SSOB                                                     04139000
SSOBID   DS    CL4                                                      04140000
SSOBLEN  DS    FL2                                                      04141000
SSOBFUNC DS    FL2                                                      04142000
SSOBSSIB DS    AL4                                                      04143000
SSOBRETN DS    AL4                                                      04144000
SSOBINDV DS    AL4                                                      04145000
         ORG   SSOB+20                                                  04146000
SSWT     DS    CL16                                                     04147000
         ORG   SSWT                                                     04148000
SSWTLEN  DS    FL2                                                      04149000
@NM00011 DS    FL2                                                      04150000
SSWTWQE  DS    AL4                                                      04151000
SSWTMIN  DS    AL4                                                      04152000
SSWTORE  DS    AL4                                                      04153000
         ORG   SSWT+16                                                  04154000
EPARM    DS    CL24                                                     04155000
         DS    CL2                                                      04156000
RECSAVE  DS    CL66                                                     04157000
         ORG   RECSAVE                                                  04158000
RECRGMAP DS    CL2                                                      04159000
RECREGS  DS    CL64                                                     04160000
         ORG   RECSAVE+66                                               04161000
IEAVVWTO CSECT                                                          04162000
         DS    0F                                                       04163000
@SIZDATD DC    AL1(229)                                                 04164000
         DC    AL3(@ENDDATD-@DATD)                                      04165000
@CV00206 DC    V(IEAVMWTO)                                              04166000
@CV00207 DC    V(IEECVXIT)                                              04167000
@CV00208 DC    V(IGC0203E)                                              04168000
         DS    0D                                                       04169000
ABNDCODE DC    XL4'00000D23'                                            04170000
@CC01464 DC    C'VWTO'                                                  04171000
@CC03269 DC    C'SSOB'                                                  04172000
@CC03264 DC    C' +'                                                    04173000
@CB01462 DC    X'FFFF'                                                  04174000
@CB03252 DC    X'2000'                                                  04175000
@CB03254 DC    X'8000'                                                  04176000
@CB03267 DC    X'0200'                                                  04177000
CHARTAB  DC    CL16'0123456789ABCDEF'                                   04178000
         DS    CL2                                                      04179000
GETWWB   DS    CL4                                                      04180000
         ORG   GETWWB                                                   04181000
@NM00003 DC    AL1(231)                                                 04182000
@NM00004 DC    AL3(24)                                                  04183000
         ORG   GETWWB+4                                                 04184000
FROREXT  DS    CL4                                                      04185000
         ORG   FROREXT                                                  04186000
@NM00005 DC    AL1(231)                                                 04187000
@NM00006 DC    AL3(1024)                                                04188000
         ORG   FROREXT+4                                                04189000
FRWQEXT  DS    CL4                                                      04190000
         ORG   FRWQEXT                                                  04191000
@NM00007 DC    AL1(231)                                                 04192000
@NM00008 DC    AL3(4096)                                                04193000
         ORG   FRWQEXT+4                                                04194000
GETSP231 DS    CL4                                                      04195000
         ORG   GETSP231                                                 04196000
@NM00009 DC    AL1(231)                                                 04197000
@NM00010 DC    AL3(20+16)                                               04198000
         ORG   GETSP231+4                                               04199000
IDMAP    DC    X'80'                                                    04200000
         DC    X'40'                                                    04201000
         DC    X'20'                                                    04202000
         DC    X'10'                                                    04203000
         DC    X'08'                                                    04204000
         DC    X'04'                                                    04205000
         DC    X'02'                                                    04206000
         DC    X'01'                                                    04207000
TRTAB    DC    74CL1' '                                                 04208000
         DC    CL1''                                                   04209000
         DC    CL1'.'                                                   04210000
         DC    CL1'<'                                                   04211000
         DC    CL1'('                                                   04212000
         DC    CL1'+'                                                   04213000
         DC    X'4F'                                                    04214000
         DC    CL1'&&'                                                  04215000
         DC    9CL1' '                                                  04216000
         DC    X'5A'                                                    04217000
         DC    CL1'$'                                                   04218000
         DC    CL1'*'                                                   04219000
         DC    CL1')'                                                   04220000
         DC    CL1';'                                                   04221000
         DC    X'5F'                                                    04222000
         DC    CL1'-'                                                   04223000
         DC    CL1'/'                                                   04224000
         DC    9CL1' '                                                  04225000
         DC    CL1','                                                   04226000
         DC    CL1'%'                                                   04227000
         DC    CL1'_'                                                   04228000
         DC    CL1'>'                                                   04229000
         DC    CL1'?'                                                   04230000
         DC    10CL1' '                                                 04231000
         DC    CL1':'                                                   04232000
         DC    CL1'#'                                                   04233000
         DC    CL1'@'                                                   04234000
         DC    CL1''''                                                  04235000
         DC    CL1'='                                                   04236000
         DC    CL1'"'                                                   04237000
         DC    CL1' '                                                   04238000
         DC    CL1'a'                                                   04239000
         DC    CL1'b'                                                   04240000
         DC    CL1'c'                                                   04241000
         DC    CL1'd'                                                   04242000
         DC    CL1'e'                                                   04243000
         DC    CL1'f'                                                   04244000
         DC    CL1'g'                                                   04245000
         DC    CL1'h'                                                   04246000
         DC    CL1'i'                                                   04247000
         DC    7CL1' '                                                  04248000
         DC    CL1'j'                                                   04249000
         DC    CL1'k'                                                   04250000
         DC    CL1'l'                                                   04251000
         DC    CL1'm'                                                   04252000
         DC    CL1'n'                                                   04253000
         DC    CL1'o'                                                   04254000
         DC    CL1'p'                                                   04255000
         DC    CL1'q'                                                   04256000
         DC    CL1'r'                                                   04257000
         DC    8CL1' '                                                  04258000
         DC    CL1's'                                                   04259000
         DC    CL1't'                                                   04260000
         DC    CL1'u'                                                   04261000
         DC    CL1'v'                                                   04262000
         DC    CL1'w'                                                   04263000
         DC    CL1'x'                                                   04264000
         DC    CL1'y'                                                   04265000
         DC    CL1'z'                                                   04266000
         DC    23CL1' '                                                 04267000
         DC    CL1'A'                                                   04268000
         DC    CL1'B'                                                   04269000
         DC    CL1'C'                                                   04270000
         DC    CL1'D'                                                   04271000
         DC    CL1'E'                                                   04272000
         DC    CL1'F'                                                   04273000
         DC    CL1'G'                                                   04274000
         DC    CL1'H'                                                   04275000
         DC    CL1'I'                                                   04276000
         DC    7CL1' '                                                  04277000
         DC    CL1'J'                                                   04278000
         DC    CL1'K'                                                   04279000
         DC    CL1'L'                                                   04280000
         DC    CL1'M'                                                   04281000
         DC    CL1'N'                                                   04282000
         DC    CL1'O'                                                   04283000
         DC    CL1'P'                                                   04284000
         DC    CL1'Q'                                                   04285000
         DC    CL1'R'                                                   04286000
         DC    8CL1' '                                                  04287000
         DC    CL1'S'                                                   04288000
         DC    CL1'T'                                                   04289000
         DC    CL1'U'                                                   04290000
         DC    CL1'V'                                                   04291000
         DC    CL1'W'                                                   04292000
         DC    CL1'X'                                                   04293000
         DC    CL1'Y'                                                   04294000
         DC    CL1'Z'                                                   04295000
         DC    6CL1' '                                                  04296000
         DC    CL1'0'                                                   04297000
         DC    CL1'1'                                                   04298000
         DC    CL1'2'                                                   04299000
         DC    CL1'3'                                                   04300000
         DC    CL1'4'                                                   04301000
         DC    CL1'5'                                                   04302000
         DC    CL1'6'                                                   04303000
         DC    CL1'7'                                                   04304000
         DC    CL1'8'                                                   04305000
         DC    CL1'9'                                                   04306000
         DC    6CL1' '                                                  04307000
IEAVVWTO CSECT                                                          04308000
         DS   0H                                                        04309000
PATCHLOC DC (200)X'00'                                                  04310000
IEAVVWTO CSECT                                                          04311000
ELIST  ESTAE  ,MF=L                                                     04312000
@DATD    DSECT                                                          04313000
*                                                         /*@ZA19274*/  04314000
IEAVVWTO CSECT                                                          04315000
TRINST   TR    WQETXT(0,REG15),TRTAB                      /*@ZA19274*/  04316000
*                                                         /*@ZA19274*/  04317000
@DATD    DSECT                                                          04318000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                04319000
@ENDDATD EQU   *                                                        04320000
IEAVVWTO CSECT                                                          04321000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       04322000
@01      EQU   01                                                       04323000
@02      EQU   02                                                       04324000
@03      EQU   03                                                       04325000
@04      EQU   04                                                       04326000
@05      EQU   05                                                       04327000
@06      EQU   06                                                       04328000
@07      EQU   07                                                       04329000
@08      EQU   08                                                       04330000
@09      EQU   09                                                       04331000
@10      EQU   10                                                       04332000
@11      EQU   11                                                       04333000
@12      EQU   12                                                       04334000
@13      EQU   13                                                       04335000
@14      EQU   14                                                       04336000
@15      EQU   15                                                       04337000
CPEXTSAV EQU   @10                                                      04338000
ISCAN    EQU   @10                                                      04339000
REG0     EQU   @00                                                      04340000
REG1     EQU   @01                                                      04341000
REG2     EQU   @02                                                      04342000
REG3     EQU   @03                                                      04343000
REG4     EQU   @04                                                      04344000
REG5     EQU   @05                                                      04345000
REG6     EQU   @06                                                      04346000
REG7     EQU   @07                                                      04347000
REG8     EQU   @08                                                      04348000
REG9     EQU   @09                                                      04349000
REG10    EQU   @10                                                      04350000
REG11    EQU   @11                                                      04351000
REG12    EQU   @12                                                      04352000
REG13    EQU   @13                                                      04353000
REG14    EQU   @14                                                      04354000
REG15    EQU   @15                                                      04355000
TEXTPTR  EQU   @02                                                      04356000
RBSECPTR EQU   @05                                                      04357000
TCBPTR   EQU   @04                                                      04358000
ASCBPTR  EQU   @07                                                      04359000
PSA      EQU   0                                                        04360000
FLCRNPSW EQU   PSA                                                      04361000
FLCROPSW EQU   PSA+8                                                    04362000
FLCICCW2 EQU   PSA+16                                                   04363000
PSAEEPSW EQU   PSA+132                                                  04364000
PSAESPSW EQU   PSA+136                                                  04365000
FLCSVILC EQU   PSAESPSW+1                                               04366000
PSAEPPSW EQU   PSA+140                                                  04367000
FLCPIILC EQU   PSAEPPSW+1                                               04368000
FLCPICOD EQU   PSAEPPSW+2                                               04369000
PSAPICOD EQU   FLCPICOD+1                                               04370000
FLCTEA   EQU   PSAEPPSW+4                                               04371000
FLCPER   EQU   PSA+152                                                  04372000
FLCMCLA  EQU   PSA+168                                                  04373000
FLCIOEL  EQU   FLCMCLA+4                                                04374000
FLCIOA   EQU   FLCMCLA+16                                               04375000
FLCFSA   EQU   FLCMCLA+80                                               04376000
PSASUPER EQU   PSA+552                                                  04377000
PSASUP1  EQU   PSASUPER                                                 04378000
PSASUP2  EQU   PSASUPER+1                                               04379000
PSASUP3  EQU   PSASUPER+2                                               04380000
PSASUP4  EQU   PSASUPER+3                                               04381000
PSACLHT  EQU   PSA+640                                                  04382000
PSALKSA  EQU   PSA+696                                                  04383000
PSAHLHI  EQU   PSA+760                                                  04384000
PSALITA  EQU   PSA+764                                                  04385000
PSADSSFL EQU   PSA+836                                                  04386000
PSADSSF1 EQU   PSADSSFL                                                 04387000
PSADSSF3 EQU   PSADSSFL+2                                               04388000
PSADSSF4 EQU   PSADSSFL+3                                               04389000
PSARSVT  EQU   PSA+896                                                  04390000
PSALSFCC EQU   PSA+1012                                                 04391000
CVTPTR   EQU   16                                                       04392000
REFCHAR  EQU   0                                                        04393000
WWB      EQU   0                                                        04394000
WWBFWDPT EQU   WWB                                                      04395000
WWBBCKPT EQU   WWB+4                                                    04396000
WWBASCB  EQU   WWB+8                                                    04397000
WWBTCBAD EQU   WWB+12                                                   04398000
WWBFLAGS EQU   WWB+16                                                   04399000
WWBPOSTD EQU   WWBFLAGS                                                 04400000
WWBECB   EQU   WWB+20                                                   04401000
PARMLIST EQU   0                                                        04402000
PARMSTAT EQU   PARMLIST                                                 04403000
PARMFTPT EQU   PARMSTAT                                                 04404000
PARMFLAG EQU   PARMSTAT+1                                               04405000
PARMFRID EQU   PARMFLAG                                                 04406000
PARMNDMP EQU   PARMFLAG                                                 04407000
PARMCLAD EQU   PARMLIST+8                                               04408000
PARMRTAD EQU   PARMLIST+12                                              04409000
PARMRGAD EQU   PARMLIST+16                                              04410000
PARMID   EQU   PARMLIST+20                                              04411000
JESCT    EQU   0                                                        04412000
JESWAA   EQU   JESCT+8                                                  04413000
JESSSREQ EQU   JESCT+20                                                 04414000
JESALLOC EQU   JESCT+32                                                 04415000
JESUNALC EQU   JESCT+36                                                 04416000
JESCATL  EQU   JESCT+40                                                 04417000
SSREQ    EQU   0                                                        04418000
OREF     EQU   0                                                        04419000
ORELKP   EQU   OREF                                                     04420000
OREID    EQU   OREF+4                                                   04421000
OREXA    EQU   OREF+6                                                   04422000
OREKEY0  EQU   OREXA                                                    04423000
ORESUSP  EQU   OREXA                                                    04424000
OREXC    EQU   OREF+7                                                   04425000
OREBUFB  EQU   OREXC                                                    04426000
OREBUFD  EQU   OREXC                                                    04427000
ORETCB   EQU   OREF+8                                                   04428000
OREWQE   EQU   OREF+12                                                  04429000
ORERPY   EQU   OREF+16                                                  04430000
OREECB   EQU   OREF+20                                                  04431000
OREASID  EQU   OREF+24                                                  04432000
WQE      EQU   0                                                        04433000
WQELKP   EQU   WQE                                                      04434000
WQELKPA  EQU   WQELKP+1                                                 04435000
WQENBR   EQU   WQE+4                                                    04436000
WQERR    EQU   WQE+8                                                    04437000
WQEPAD   EQU   WQE+12                                                   04438000
WQETS    EQU   WQE+13                                                   04439000
WQETSHH  EQU   WQETS                                                    04440000
WQEPER1  EQU   WQETS+2                                                  04441000
WQETSMM  EQU   WQETS+3                                                  04442000
WQEPER2  EQU   WQETS+5                                                  04443000
WQETSSS  EQU   WQETS+6                                                  04444000
WQEPAD1  EQU   WQE+21                                                   04445000
WQEJOBNM EQU   WQE+22                                                   04446000
WQEPAD2  EQU   WQE+30                                                   04447000
WQETXT   EQU   WQE+31                                                   04448000
WQEXA    EQU   WQE+160                                                  04449000
WQEQFHC  EQU   WQEXA                                                    04450000
WQEORE   EQU   WQEXA                                                    04451000
WQEWTOR  EQU   WQEXA                                                    04452000
WQESUSP  EQU   WQEXA                                                    04453000
WQEAUTH  EQU   WQEXA                                                    04454000
WQEASID  EQU   WQE+161                                                  04455000
WQEAVAIL EQU   WQE+163                                                  04456000
WQEBUFB  EQU   WQEAVAIL                                                 04457000
WQEBUFC  EQU   WQEAVAIL                                                 04458000
WQEBUFD  EQU   WQEAVAIL                                                 04459000
WQEBUFE  EQU   WQEAVAIL                                                 04460000
WQETCB   EQU   WQE+164                                                  04461000
WQESEQN  EQU   WQE+169                                                  04462000
WQEMCSF  EQU   WQE+172                                                  04463000
WQEMCSF1 EQU   WQEMCSF                                                  04464000
WQEMCSA  EQU   WQEMCSF1                                                 04465000
WQEMCSB  EQU   WQEMCSF1                                                 04466000
WQEMCSG  EQU   WQEMCSF1                                                 04467000
WQEMCSH  EQU   WQEMCSF1                                                 04468000
WQEMCSF2 EQU   WQEMCSF+1                                                04469000
WQEMCSN  EQU   WQEMCSF2                                                 04470000
WQEMSGTP EQU   WQE+174                                                  04471000
WQEMSGT1 EQU   WQEMSGTP                                                 04472000
WQEROUT  EQU   WQE+176                                                  04473000
WQEROUT1 EQU   WQEROUT                                                  04474000
WQEROUT2 EQU   WQEROUT+1                                                04475000
WQEUCMID EQU   WQE+180                                                  04476000
WQERPYID EQU   WQE+182                                                  04477000
WQEDESCD EQU   WQE+184                                                  04478000
WQEDC1   EQU   WQEDESCD                                                 04479000
WQEDC2   EQU   WQEDESCD+1                                               04480000
WQEJSTCB EQU   WQE+188                                                  04481000
WMJM     EQU   0                                                        04482000
WMJMEXT  EQU   WMJM                                                     04483000
WMJMEXTA EQU   WMJMEXT+1                                                04484000
WMJMMLW  EQU   WMJM+4                                                   04485000
WMJMTS   EQU   WMJM+13                                                  04486000
WMJMSER  EQU   WMJM+122                                                 04487000
WMJMSER1 EQU   WMJMSER                                                  04488000
WMJMLTYP EQU   WMJM+134                                                 04489000
WMJMLTY1 EQU   WMJMLTYP                                                 04490000
WMJMECBF EQU   WMJM+148                                                 04491000
WMJMDSP  EQU   WMJM+160                                                 04492000
WMJMBUF  EQU   WMJM+163                                                 04493000
WMJMCS   EQU   WMJM+172                                                 04494000
WMJMCS1  EQU   WMJMCS                                                   04495000
WMJMCS2  EQU   WMJMCS+1                                                 04496000
WMJMMT   EQU   WMJM+174                                                 04497000
WMJMMT1  EQU   WMJMMT                                                   04498000
WMJMRTC  EQU   WMJM+176                                                 04499000
WMJMRCT1 EQU   WMJMRTC                                                  04500000
WMJMRCT2 EQU   WMJMRTC+1                                                04501000
WMJMDEC  EQU   WMJM+184                                                 04502000
WMJMDEC1 EQU   WMJMDEC                                                  04503000
WMJMDEC2 EQU   WMJMDEC+1                                                04504000
WMNM     EQU   0                                                        04505000
WMNMEXT  EQU   WMNM                                                     04506000
WMNMML1  EQU   WMNM+4                                                   04507000
WMNMLT1  EQU   WMNM+5                                                   04508000
WMNMST1  EQU   WMNM+84                                                  04509000
WMNMML2  EQU   WMNM+100                                                 04510000
WMNMLT2  EQU   WMNM+101                                                 04511000
WMNMST2  EQU   WMNM+180                                                 04512000
WPLRF    EQU   0                                                        04513000
WPLRPTR  EQU   WPLRF                                                    04514000
WPLRLN   EQU   WPLRPTR                                                  04515000
WPLRECB  EQU   WPLRF+4                                                  04516000
WPL      EQU   0                                                        04517000
WPLLGH   EQU   WPL                                                      04518000
WPLMCSF  EQU   WPL+2                                                    04519000
WPLMCSF1 EQU   WPLMCSF                                                  04520000
WPLMCSFA EQU   WPLMCSF1                                                 04521000
WPLMCSFD EQU   WPLMCSF1                                                 04522000
WPLMCSF2 EQU   WPLMCSF+1                                                04523000
WPLMCSFI EQU   WPLMCSF2                                                 04524000
WPLMCSFJ EQU   WPLMCSF2                                                 04525000
WPLTXT   EQU   WPL+4                                                    04526000
WPLFLGS  EQU   0                                                        04527000
WPLDESC  EQU   WPLFLGS                                                  04528000
WPLDESC1 EQU   WPLDESC                                                  04529000
WPLDESCA EQU   WPLDESC1                                                 04530000
WPLDESCB EQU   WPLDESC1                                                 04531000
WPLDESCG EQU   WPLDESC1                                                 04532000
WPLDESC2 EQU   WPLDESC+1                                                04533000
WPLROUT  EQU   WPLFLGS+2                                                04534000
WPLROUT1 EQU   WPLROUT                                                  04535000
WPLROUT2 EQU   WPLROUT+1                                                04536000
WPLROUTK EQU   WPLROUT2                                                 04537000
WPLMSGTY EQU   WPLFLGS+4                                                04538000
WPLMSGT1 EQU   WPLMSGTY                                                 04539000
WPLMSGTD EQU   WPLMSGT1                                                 04540000
WPLMSGT2 EQU   WPLMSGTY+1                                               04541000
WPLQID   EQU   WPLFLGS+6                                                04542000
WPLLS01  EQU   0                                                        04543000
WPLLTF   EQU   WPLLS01                                                  04544000
WPLLTF1  EQU   WPLLTF                                                   04545000
WPLAREA  EQU   WPLLS01+2                                                04546000
WPLLINES EQU   WPLLS01+3                                                04547000
WPLML    EQU   0                                                        04548000
WPLMLLEN EQU   WPLML+1                                                  04549000
WPLMLLTF EQU   WPLML+2                                                  04550000
WPLMLLT1 EQU   WPLMLLTF                                                 04551000
UCMPRFXP EQU   0                                                        04552000
UCM2PTR  EQU   0                                                        04553000
UCM2EXT  EQU   0                                                        04554000
UCM2STA  EQU   UCM2EXT+8                                                04555000
UCM2SFLG EQU   UCM2STA                                                  04556000
UCM2FEXT EQU   UCM2EXT+12                                               04557000
UCMPRFX  EQU   0                                                        04558000
UCMSAVE0 EQU   UCMPRFX+4                                                04559000
UCMSFLGS EQU   UCMPRFX+84                                               04560000
UCMSFLG1 EQU   UCMSFLGS                                                 04561000
UCMSYSG  EQU   UCMSFLG1                                                 04562000
UCMSFLG2 EQU   UCMSFLGS+1                                               04563000
UCMSYSI  EQU   UCMSFLG2                                                 04564000
UCMSYSO  EQU   UCMSFLG2                                                 04565000
UCMOWTOR EQU   UCMPRFX+86                                               04566000
UCMCMID  EQU   UCMPRFX+88                                               04567000
UCMXSA   EQU   UCMPRFX+104                                              04568000
UCMSDS1  EQU   UCMPRFX+156                                              04569000
UCM      EQU   0                                                        04570000
UCMAECB  EQU   UCM+4                                                    04571000
UCMOECB  EQU   UCM+8                                                    04572000
UCMDECB  EQU   UCM+12                                                   04573000
UCMLSTP  EQU   UCM+20                                                   04574000
UCMWTOQ  EQU   UCM+24                                                   04575000
UCMRPYQ  EQU   UCM+28                                                   04576000
UCMRPYI  EQU   UCM+32                                                   04577000
UCMRQLM  EQU   UCM+45                                                   04578000
UCMWQLM  EQU   UCM+46                                                   04579000
UCMRQNR  EQU   UCM+56                                                   04580000
UCMWQNR  EQU   UCM+58                                                   04581000
UCMWQEND EQU   UCM+60                                                   04582000
UCMPXA   EQU   UCM+64                                                   04583000
UCMPXB   EQU   UCM+68                                                   04584000
UCMMODE  EQU   UCMPXB                                                   04585000
UCMVDATA EQU   UCM+72                                                   04586000
UCMVEA   EQU   UCMVDATA                                                 04587000
UCMRQLM1 EQU   UCM+236                                                  04588000
UCMWQLM1 EQU   UCM+238                                                  04589000
UCMCTID  EQU   UCM+250                                                  04590000
UCMWECBT EQU   UCM+260                                                  04591000
UCMOECBT EQU   UCM+268                                                  04592000
UCMORECP EQU   UCM+272                                                  04593000
UCMWQECP EQU   UCM+276                                                  04594000
UCMASCB  EQU   UCM+280                                                  04595000
UCMFRRAD EQU   UCM+288                                                  04596000
UCMWAKUP EQU   UCM+292                                                  04597000
UCMJES3T EQU   UCM+296                                                  04598000
UCMRSV42 EQU   UCM+300                                                  04599000
UCMRSV51 EQU   UCM+301                                                  04600000
UCMEIL   EQU   0                                                        04601000
UCMRPYL  EQU   UCMEIL+1                                                 04602000
UCMRECBA EQU   UCMEIL+24                                                04603000
UCMEXIT  EQU   0                                                        04604000
UCMLIST  EQU   0                                                        04605000
UCMSTS   EQU   UCMLIST+24                                               04606000
UCMATR   EQU   UCMLIST+25                                               04607000
UCMXA    EQU   UCMLIST+26                                               04608000
UCMAUTH  EQU   UCMLIST+40                                               04609000
UCMAUTHA EQU   UCMAUTH                                                  04610000
UCMDISP  EQU   UCMLIST+42                                               04611000
UCMDISP1 EQU   UCMDISP                                                  04612000
UCMDISP2 EQU   UCMDISP+1                                                04613000
UCMMSG   EQU   UCMLIST+60                                               04614000
UCMMSG1  EQU   UCMMSG                                                   04615000
UCMDEVC  EQU   UCMLIST+63                                               04616000
UCMRCT   EQU   UCMLIST+68                                               04617000
UCMSDS5  EQU   UCMRCT                                                   04618000
UCMFEXTA EQU   0                                                        04619000
UCMFPPTR EQU   UCMFEXTA+4                                               04620000
UCMFMGFS EQU   UCMFEXTA+8                                               04621000
UCMFFLG1 EQU   UCMFMGFS                                                 04622000
UCMFMSGN EQU   UCMFFLG1                                                 04623000
UCMPEXTA EQU   0                                                        04624000
UCMPDM1  EQU   UCMPEXTA+4                                               04625000
FRRSPTR  EQU   0                                                        04626000
FRREPTR  EQU   0                                                        04627000
FRRS     EQU   0                                                        04628000
FRRSHEAD EQU   FRRS                                                     04629000
FRRSEMP  EQU   FRRSHEAD                                                 04630000
FRRSLAST EQU   FRRSHEAD+4                                               04631000
FRRSELEN EQU   FRRSHEAD+8                                               04632000
FRRSCURR EQU   FRRSHEAD+12                                              04633000
FRRSENTR EQU   0                                                        04634000
FRRSFRRA EQU   FRRSENTR                                                 04635000
FRRSFLGS EQU   FRRSENTR+4                                               04636000
FRRSFLG1 EQU   FRRSFLGS                                                 04637000
FRRSPARM EQU   FRRSENTR+8                                               04638000
BASE     EQU   0                                                        04639000
@NM00020 EQU   BASE+13                                                  04640000
BALGSTAT EQU   BASE+24                                                  04641000
BALOG    EQU   BALGSTAT+4                                               04642000
BALOGINT EQU   BALOG                                                    04643000
BASFL    EQU   BASE+36                                                  04644000
BARSW    EQU   BASFL                                                    04645000
MSLOGST  EQU   BASE+46                                                  04646000
BASPBYTE EQU   BASE+47                                                  04647000
BAMONITR EQU   BASE+56                                                  04648000
@NM00042 EQU   BASE+104                                                 04649000
MSLGCLOZ EQU   BASE+108                                                 04650000
MSCLOSSW EQU   MSLGCLOZ                                                 04651000
MSLGWLOG EQU   BASE+112                                                 04652000
MSWLOGSW EQU   MSLGWLOG                                                 04653000
MSLGWTR  EQU   BASE+116                                                 04654000
MSWTRSW  EQU   MSLGWTR                                                  04655000
MSLGSTRT EQU   BASE+120                                                 04656000
MSSTRTSW EQU   MSLGSTRT                                                 04657000
MS1BASEX EQU   BASE+136                                                 04658000
BASES01  EQU   0                                                        04659000
MSNTAL   EQU   BASES01                                                  04660000
MSSSB    EQU   BASES01+1                                                04661000
MSBTN    EQU   MSSSB                                                    04662000
MSPFG    EQU   BASES01+2                                                04663000
MSECBFL  EQU   BASES01+3                                                04664000
MSTUS    EQU   BASES01+4                                                04665000
MSSSA    EQU   MSTUS                                                    04666000
MSINLSW  EQU   MSSSA                                                    04667000
MSREOF   EQU   MSSSA                                                    04668000
MSNWP    EQU   MSSSA                                                    04669000
MSFHF    EQU   BASES01+5                                                04670000
ESTAPTR  EQU   0                                                        04671000
ESTA     EQU   0                                                        04672000
ESTAEXT  EQU   ESTA                                                     04673000
ESTAFLG1 EQU   ESTAEXT                                                  04674000
ESTAIO   EQU   ESTAFLG1                                                 04675000
ESTAFGRS EQU   ESTA+12                                                  04676000
ESTAFLG2 EQU   ESTAFGRS                                                 04677000
POSTRECY EQU   0                                                        04678000
RBPRFX   EQU   0                                                        04679000
RBBASIC  EQU   0                                                        04680000
RBEXRTNM EQU   RBBASIC                                                  04681000
RBTMFLD  EQU   RBEXRTNM                                                 04682000
RBSTAB   EQU   RBBASIC+10                                               04683000
XSTAB    EQU   RBSTAB                                                   04684000
RBSTAB1  EQU   XSTAB                                                    04685000
XSTAB1   EQU   RBSTAB1                                                  04686000
RBFTCKPT EQU   XSTAB1                                                   04687000
RBSTAB2  EQU   XSTAB+1                                                  04688000
XSTAB2   EQU   RBSTAB2                                                  04689000
RBTCBNXT EQU   XSTAB2                                                   04690000
RBFACTV  EQU   XSTAB2                                                   04691000
RBFDYN   EQU   XSTAB2                                                   04692000
RBECBWT  EQU   XSTAB2                                                   04693000
RBOPSW   EQU   RBBASIC+16                                               04694000
XRBPSW   EQU   RBOPSW                                                   04695000
RBOPSWB2 EQU   XRBPSW+1                                                 04696000
RBLINK   EQU   RBBASIC+28                                               04697000
XRBLNK   EQU   RBLINK                                                   04698000
RBWCF    EQU   XRBLNK                                                   04699000
RBLINKB  EQU   XRBLNK+1                                                 04700000
RBGRSAVE EQU   RBBASIC+32                                               04701000
XRBREG   EQU   RBGRSAVE                                                 04702000
RBGRS0   EQU   XRBREG                                                   04703000
RBGRS1   EQU   XRBREG+4                                                 04704000
RBGRS2   EQU   XRBREG+8                                                 04705000
RBGRS3   EQU   XRBREG+12                                                04706000
RBGRS4   EQU   XRBREG+16                                                04707000
RBGRS5   EQU   XRBREG+20                                                04708000
RBGRS6   EQU   XRBREG+24                                                04709000
RBGRS7   EQU   XRBREG+28                                                04710000
RBGRS8   EQU   XRBREG+32                                                04711000
RBGRS9   EQU   XRBREG+36                                                04712000
RBGRS10  EQU   XRBREG+40                                                04713000
RBGRS11  EQU   XRBREG+44                                                04714000
RBGRS12  EQU   XRBREG+48                                                04715000
RBGRS13  EQU   XRBREG+52                                                04716000
RBGRS14  EQU   XRBREG+56                                                04717000
RBGRS15  EQU   XRBREG+60                                                04718000
XRBESA   EQU   RBBASIC+96                                               04719000
RBEXSAVE EQU   XRBESA                                                   04720000
RBPREFIX EQU   0                                                        04721000
RBRSV019 EQU   RBPREFIX+14                                              04722000
RBRSV028 EQU   RBPREFIX+15                                              04723000
RBRSV041 EQU   RBPREFIX+27                                              04724000
RBRSV054 EQU   RBPREFIX+39                                              04725000
RBRTOPSW EQU   RBPREFIX+40                                              04726000
RBRTPSW2 EQU   RBRTOPSW+8                                               04727000
RBRTICIL EQU   RBRTPSW2                                                 04728000
RBFLAGS1 EQU   RBPREFIX+56                                              04729000
RBINTCDA EQU   RBPREFIX+61                                              04730000
RBSECT   EQU   0                                                        04731000
RBPPSAV  EQU   RBSECT                                                   04732000
@NM00075 EQU   RBSECT+10                                                04733000
@NM00076 EQU   @NM00075                                                 04734000
RBFTP    EQU   @NM00076                                                 04735000
RBTRSVRB EQU   @NM00076                                                 04736000
@NM00078 EQU   @NM00075+1                                               04737000
RBETXR   EQU   @NM00078                                                 04738000
RBEP     EQU   RBSECT+12                                                04739000
RBPGMQ   EQU   RBSECT+24                                                04740000
@NM00085 EQU   RBSECT+28                                                04741000
IRBEND   EQU   RBSECT+96                                                04742000
@NM00089 EQU   RBSECT+96                                                04743000
RBRSV138 EQU   @NM00089+7                                               04744000
RBRSV150 EQU   RBSECT+167                                               04745000
TCBFIX   EQU   0                                                        04746000
TCBFRS   EQU   TCBFIX                                                   04747000
TCB      EQU   0                                                        04748000
TCBRBP   EQU   TCB                                                      04749000
TCBPIE   EQU   TCB+4                                                    04750000
TCBPMASK EQU   TCBPIE                                                   04751000
TCBCMP   EQU   TCB+16                                                   04752000
TCBCMPF  EQU   TCBCMP                                                   04753000
TCBCPP   EQU   TCBCMPF                                                  04754000
TCBSTCC  EQU   TCBCMPF                                                  04755000
TCBCDBL  EQU   TCBCMPF                                                  04756000
TCBCWTO  EQU   TCBCMPF                                                  04757000
TCBCIND  EQU   TCBCMPF                                                  04758000
TCBCMSG  EQU   TCBCMPF                                                  04759000
TCBTRN   EQU   TCB+20                                                   04760000
TCBABF   EQU   TCBTRN                                                   04761000
TCBMSS   EQU   TCB+24                                                   04762000
TCBPKF   EQU   TCB+28                                                   04763000
TCBFLGS  EQU   TCB+29                                                   04764000
TCBFLGS1 EQU   TCBFLGS                                                  04765000
TCBFLGS2 EQU   TCBFLGS+1                                                04766000
TCBFLGS3 EQU   TCBFLGS+2                                                04767000
TCBFLGS4 EQU   TCBFLGS+3                                                04768000
TCBFLGS5 EQU   TCBFLGS+4                                                04769000
TCBABWF  EQU   TCBFLGS5                                                 04770000
TCBJPQ   EQU   TCB+44                                                   04771000
TCBPURGE EQU   TCBJPQ                                                   04772000
TCBGRS   EQU   TCB+48                                                   04773000
TCBFSA   EQU   TCB+112                                                  04774000
TCBTME   EQU   TCB+120                                                  04775000
TCBJSTCB EQU   TCB+124                                                  04776000
TCBOTC   EQU   TCB+132                                                  04777000
TCBTSFLG EQU   TCB+148                                                  04778000
TCBTSTSK EQU   TCBTSFLG                                                 04779000
TCBSTAB  EQU   TCB+160                                                  04780000
TCBNSTAE EQU   TCBSTAB                                                  04781000
TCBTCT   EQU   TCB+164                                                  04782000
TCBTCTGF EQU   TCBTCT                                                   04783000
TCBSCNDY EQU   TCB+172                                                  04784000
TCBNDSP  EQU   TCBSCNDY                                                 04785000
TCBNDSP1 EQU   TCBNDSP+1                                                04786000
TCBNDSP2 EQU   TCBNDSP+2                                                04787000
TCBNDSP3 EQU   TCBNDSP+3                                                04788000
TCBJSCB  EQU   TCB+180                                                  04789000
TCBRECDE EQU   TCBJSCB                                                  04790000
TCBEXT1  EQU   TCB+196                                                  04791000
TCBBITS  EQU   TCB+200                                                  04792000
TCBNDSP4 EQU   TCBBITS                                                  04793000
TCBNDSP5 EQU   TCBBITS+1                                                04794000
TCBFLGS6 EQU   TCBBITS+2                                                04795000
TCBFLGS7 EQU   TCBBITS+3                                                04796000
TCBDAR   EQU   TCB+204                                                  04797000
TCBDARC  EQU   TCBDAR                                                   04798000
TCBEXT2  EQU   TCB+208                                                  04799000
TCBTID   EQU   TCB+238                                                  04800000
TCBFOE   EQU   TCB+244                                                  04801000
TCBESTAE EQU   TCB+264                                                  04802000
TCBESTRM EQU   TCBESTAE+1                                               04803000
TCBFBYT1 EQU   TCB+276                                                  04804000
TCBFBYT2 EQU   TCB+277                                                  04805000
TCBRV124 EQU   TCB+278                                                  04806000
TCBRV133 EQU   TCB+279                                                  04807000
TCBXTNT2 EQU   0                                                        04808000
TCBGTF   EQU   TCBXTNT2                                                 04809000
TCBTFLG  EQU   TCBGTF                                                   04810000
TCBRV146 EQU   TCBXTNT2+28                                              04811000
TCBRV155 EQU   TCBXTNT2+29                                              04812000
TCBRV164 EQU   TCBXTNT2+30                                              04813000
TCBRV173 EQU   TCBXTNT2+31                                              04814000
ASVT     EQU   0                                                        04815000
ASVTFRST EQU   ASVT+524                                                 04816000
ASVTENTY EQU   ASVT+528                                                 04817000
ASCB     EQU   0                                                        04818000
ASCBASID EQU   ASCB+36                                                  04819000
ASCBFW1  EQU   ASCB+100                                                 04820000
ASCBRCTF EQU   ASCBFW1+2                                                04821000
ASCBFLG1 EQU   ASCBFW1+3                                                04822000
ASCBDSP1 EQU   ASCB+114                                                 04823000
ASCBFLG2 EQU   ASCB+115                                                 04824000
CVTMAP   EQU   0                                                        04825000
CVTDAR   EQU   CVTMAP+72                                                04826000
CVTFLGS1 EQU   CVTDAR                                                   04827000
CVTCUCB  EQU   CVTMAP+100                                               04828000
CVTDCB   EQU   CVTMAP+116                                               04829000
CVTIOQET EQU   CVTMAP+120                                               04830000
CVTIERLC EQU   CVTMAP+144                                               04831000
CVTMSER  EQU   CVTMAP+148                                               04832000
CVT0PT01 EQU   CVTMAP+152                                               04833000
CVTHEAD  EQU   CVTMAP+160                                               04834000
CVTSV76C EQU   CVTHEAD                                                  04835000
CVTOPTA  EQU   CVTMAP+182                                               04836000
CVTOPTB  EQU   CVTMAP+183                                               04837000
CVTABEND EQU   CVTMAP+200                                               04838000
CVTGTF   EQU   CVTMAP+236                                               04839000
CVTGTFST EQU   CVTGTF                                                   04840000
CVTGTFS  EQU   CVTGTFST                                                 04841000
CVTSTATE EQU   CVTGTFST                                                 04842000
CVTTMODE EQU   CVTGTFST                                                 04843000
CVTFORM  EQU   CVTGTFST                                                 04844000
CVTAQAVT EQU   CVTMAP+240                                               04845000
CVTTCMFG EQU   CVTAQAVT                                                 04846000
CVTVOLM2 EQU   CVTMAP+244                                               04847000
CVTTATA  EQU   CVTVOLM2                                                 04848000
CVTTSKS  EQU   CVTTATA                                                  04849000
CVTVOLF2 EQU   CVTTSKS                                                  04850000
CVTTAT   EQU   CVTTATA+1                                                04851000
CVTATER  EQU   CVTMAP+248                                               04852000
CVTEXT1  EQU   CVTMAP+252                                               04853000
CVTPURG  EQU   CVTMAP+260                                               04854000
CVTQMSG  EQU   CVTMAP+268                                               04855000
CVTDMSR  EQU   CVTMAP+272                                               04856000
CVTRSV37 EQU   CVTDMSR                                                  04857000
CVTDMSRF EQU   CVTRSV37                                                 04858000
CVTJESCT EQU   CVTMAP+296                                               04859000
CVTERPV  EQU   CVTMAP+316                                               04860000
CVTINTLA EQU   CVTMAP+320                                               04861000
CVTAPF   EQU   CVTMAP+324                                               04862000
CVTEXT2  EQU   CVTMAP+328                                               04863000
CVTHJES  EQU   CVTMAP+332                                               04864000
CVTPGSIA EQU   CVTMAP+348                                               04865000
CVTA1F1  EQU   CVTMAP+356                                               04866000
CVTSYSK  EQU   CVTMAP+357                                               04867000
CVTVOLM1 EQU   CVTMAP+380                                               04868000
CVTVOLF1 EQU   CVTVOLM1                                                 04869000
CVTATMCT EQU   CVTMAP+388                                               04870000
CVTXTNT1 EQU   0                                                        04871000
CVTXTNT2 EQU   0                                                        04872000
CVTDSSV  EQU   CVTXTNT2                                                 04873000
CVTFLGBT EQU   CVTXTNT2+5                                               04874000
CVTQID   EQU   CVTXTNT2+24                                              04875000
CVTRV400 EQU   CVTXTNT2+52                                              04876000
CVTRV409 EQU   CVTXTNT2+53                                              04877000
CVTATCVT EQU   CVTXTNT2+64                                              04878000
CVTRV429 EQU   CVTXTNT2+84                                              04879000
CVTRV438 EQU   CVTXTNT2+85                                              04880000
CVTRV457 EQU   CVTXTNT2+112                                             04881000
CVTRV466 EQU   CVTXTNT2+113                                             04882000
CVTFIX   EQU   0                                                        04883000
CVTRELNO EQU   CVTFIX+252                                               04884000
SCVTSECT EQU   0                                                        04885000
SCVTRMBR EQU   SCVTSECT+28                                              04886000
BITZERO  EQU   0                                                        04887000
IEFAB4F5 EQU   0                                                        04888000
IEFBB410 EQU   0                                                        04889000
IEFW21SD EQU   0                                                        04890000
SWAMGR   EQU   0                                                        04891000
BLKADDR  EQU   0                                                        04892000
TYPE     EQU   0                                                        04893000
CHNTAIL  EQU   0                                                        04894000
CURRID   EQU   UCMRPYL                                                  04895000
MSGFLAG  EQU   WQETXT                                                   04896000
MSGACTN  EQU   MSGFLAG                                                  04897000
MSGID    EQU   MSGFLAG+1                                                04898000
MSGBLNK  EQU   MSGFLAG+3                                                04899000
PPMSGFLG EQU   WQETXT                                                   04900000
XVSAV    EQU   RBEXSAVE                                                 04901000
XVA0     EQU   XVSAV                                                    04902000
XVA4     EQU   XVSAV+4                                                  04903000
XVA8     EQU   XVSAV+8                                                  04904000
XVRDMSV  EQU   XVSAV+12                                                 04905000
XVDESCD  EQU   XVRDMSV                                                  04906000
XVRCSAVE EQU   XVRDMSV+2                                                04907000
XVMSGTYP EQU   XVRDMSV+4                                                04908000
XVMSGLGH EQU   XVSAV+18                                                 04909000
XVPARMAD EQU   XVSAV+20                                                 04910000
XVWQEAD  EQU   XVSAV+24                                                 04911000
XVDFLAGS EQU   XVSAV+28                                                 04912000
XVD0     EQU   XVDFLAGS                                                 04913000
XVD0RPFD EQU   XVD0                                                     04914000
XVD0NWQE EQU   XVD0                                                     04915000
XVD0NORE EQU   XVD0                                                     04916000
XVD0QID  EQU   XVD0                                                     04917000
XVD0WWB  EQU   XVD0                                                     04918000
XVD0USER EQU   XVD0                                                     04919000
XVD0HDCY EQU   XVD0                                                     04920000
XVD1     EQU   XVDFLAGS+1                                               04921000
XVD1PRIV EQU   XVD1                                                     04922000
XVD1ALDN EQU   XVD1                                                     04923000
XVD1PP   EQU   XVD1                                                     04924000
XVD1AUTH EQU   XVD1                                                     04925000
XVD1PERR EQU   XVD1                                                     04926000
XVD2     EQU   XVDFLAGS+2                                               04927000
XVD2RDC  EQU   XVD2                                                     04928000
XVD2MSGT EQU   XVD2                                                     04929000
XVD2VALD EQU   XVD2                                                     04930000
XVD2DELW EQU   XVD2                                                     04931000
XVD2ZERO EQU   XVD2                                                     04932000
XVD2WTOR EQU   XVD2                                                     04933000
XVD2QFHC EQU   XVD2                                                     04934000
XVOREAD  EQU   XVSAV+32                                                 04935000
XVNEWDC  EQU   XVOREAD                                                  04936000
XVNEWRC  EQU   XVOREAD+2                                                04937000
XVWWB    EQU   XVSAV+36                                                 04938000
XVEXPMAD EQU   XVWWB                                                    04939000
XVWQEID  EQU   XVSAV+40                                                 04940000
XVWQEIDA EQU   XVWQEID                                                  04941000
XVCONID  EQU   XVWQEID+3                                                04942000
XVRET    EQU   XVSAV+44                                                 04943000
XVRETCOD EQU   XVRET                                                    04944000
TIMEFLD  EQU   XVA8                                                     04945000
ROUTMAP  EQU   WQEROUT                                                  04946000
OREPTR   EQU   XVOREAD                                                  04947000
WQEPTR   EQU   XVWQEAD                                                  04948000
WMJPTR   EQU   XVWQEAD                                                  04949000
WMNPTR   EQU   XVWQEAD                                                  04950000
WPLPTR   EQU   XVPARMAD                                                 04951000
UCMBASPT EQU   CVTCUCB                                                  04952000
UCMMCSPT EQU   UCMPRFXP                                                 04953000
UCMEILPT EQU   UCMLSTP                                                  04954000
UCMEXTPT EQU   UCM2PTR                                                  04955000
UCMUEWPT EQU   XVEXPMAD                                                 04956000
UCMDVEPT EQU   UCMVEA                                                   04957000
UCMFXPTR EQU   UCM2FEXT                                                 04958000
UCMPXPTR EQU   UCMFPPTR                                                 04959000
UCMIECBA EQU   UCMRECBA+4                                               04960000
RBSECS03 EQU   RBEP                                                     04961000
RBCDE    EQU   RBSECS03                                                 04962000
RBCDFLGS EQU   RBCDE                                                    04963000
RBSECS05 EQU   RBPGMQ                                                   04964000
RBSQE    EQU   RBSECS05                                                 04965000
RBSECS06 EQU   RBPGMQ                                                   04966000
RBIQE    EQU   RBSECS06                                                 04967000
RBSECS07 EQU   RBPGMQ                                                   04968000
RBIQE2   EQU   RBSECS07                                                 04969000
RBSECS08 EQU   IRBEND                                                   04970000
RBSECS09 EQU   IRBEND                                                   04971000
CVTS01   EQU   CVTPGSIA                                                 04972000
CVTLPDIA EQU   CVTS01+12                                                04973000
CVTDIRST EQU   CVTLPDIA                                                 04974000
CVTSLIDA EQU   CVTS01+24                                                04975000
CVTCTLFG EQU   CVTS01+50                                                04976000
CVTBLDCP EQU   CVTS01+140                                               04977000
CVTGETCL EQU   CVTS01+144                                               04978000
CVTFRECL EQU   CVTS01+148                                               04979000
CVTCRMN  EQU   CVTS01+156                                               04980000
CVTASVT  EQU   CVTS01+208                                               04981000
CVTRV210 EQU   CVTS01+424                                               04982000
CVTRV219 EQU   CVTS01+425                                               04983000
CVTRV228 EQU   CVTS01+426                                               04984000
CVTRV237 EQU   CVTS01+427                                               04985000
CVTMFRTR EQU   CVTS01+452                                               04986000
CVTRV262 EQU   CVTS01+468                                               04987000
CVTRV271 EQU   CVTS01+469                                               04988000
CVTRV280 EQU   CVTS01+470                                               04989000
CVTRV289 EQU   CVTS01+471                                               04990000
CVTRMBR  EQU   CVTS01+492                                               04991000
CVTGSDA  EQU   CVTS01+600                                               04992000
ASVTPTR  EQU   CVTASVT                                                  04993000
FLC      EQU   PSA                                                      04994000
PSARSVTE EQU   PSARSVT                                                  04995000
PSACSTK  EQU   PSARSVTE                                                 04996000
SCVTSPTR EQU   CVTABEND                                                 04997000
ASCBTBLE EQU   ASVTENTY                                                 04998000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    04999000
PSARSAV  EQU   PSARSVTE+60                                              05000000
PSARSTK  EQU   PSARSVTE+56                                              05001000
PSAESAV3 EQU   PSARSVTE+52                                              05002000
PSAESTK3 EQU   PSARSVTE+48                                              05003000
PSAESAV2 EQU   PSARSVTE+44                                              05004000
PSAESTK2 EQU   PSARSVTE+40                                              05005000
PSAESAV1 EQU   PSARSVTE+36                                              05006000
PSAESTK1 EQU   PSARSVTE+32                                              05007000
PSAPSAV  EQU   PSARSVTE+28                                              05008000
PSAPSTK  EQU   PSARSVTE+24                                              05009000
PSAMSAV  EQU   PSARSVTE+20                                              05010000
PSAMSTK  EQU   PSARSVTE+16                                              05011000
PSASSAV  EQU   PSARSVTE+12                                              05012000
PSASSTK  EQU   PSARSVTE+8                                               05013000
PSANSTK  EQU   PSARSVTE+4                                               05014000
CVTRV628 EQU   CVTS01+728                                               05015000
CVTRV627 EQU   CVTS01+724                                               05016000
CVTRV626 EQU   CVTS01+720                                               05017000
CVTRV625 EQU   CVTS01+716                                               05018000
CVTRV624 EQU   CVTS01+712                                               05019000
CVTRV623 EQU   CVTS01+708                                               05020000
CVTRV622 EQU   CVTS01+704                                               05021000
CVTRV621 EQU   CVTS01+700                                               05022000
CVTIHASU EQU   CVTS01+696                                               05023000
CVTRV619 EQU   CVTS01+692                                               05024000
CVTRV618 EQU   CVTS01+688                                               05025000
CVTRV617 EQU   CVTS01+684                                               05026000
CVTRV616 EQU   CVTS01+680                                               05027000
CVTRV615 EQU   CVTS01+676                                               05028000
CVTRV614 EQU   CVTS01+672                                               05029000
CVTRV613 EQU   CVTS01+668                                               05030000
CVTTCASP EQU   CVTS01+664                                               05031000
CVT0PT03 EQU   CVTS01+660                                               05032000
CVT0PT0E EQU   CVTS01+656                                               05033000
CVTRV609 EQU   CVTS01+652                                               05034000
CVTCGK   EQU   CVTS01+648                                               05035000
CVTRAC   EQU   CVTS01+644                                               05036000
CVTHSM   EQU   CVTS01+640                                               05037000
CVTRV605 EQU   CVTS01+636                                               05038000
CVTRV604 EQU   CVTS01+632                                               05039000
CVTEFF02 EQU   CVTS01+628                                               05040000
CVTCBBR  EQU   CVTS01+624                                               05041000
CVTSSCR  EQU   CVTS01+620                                               05042000
CVTEVENT EQU   CVTS01+616                                               05043000
CVTCRCA  EQU   CVTS01+612                                               05044000
CVTTPIO  EQU   CVTS01+608                                               05045000
CVTADV   EQU   CVTS01+604                                               05046000
CVTGSDAB EQU   CVTGSDA                                                  05047000
CVTQV3   EQU   CVTS01+596                                               05048000
CVTQV2   EQU   CVTS01+592                                               05049000
CVTQV1   EQU   CVTS01+588                                               05050000
CVTRPT   EQU   CVTS01+584                                               05051000
CVTSSRB  EQU   CVTS01+580                                               05052000
CVTCSDRL EQU   CVTS01+576                                               05053000
CVTEXP1  EQU   CVTS01+572                                               05054000
CVTRMPMT EQU   CVTS01+568                                               05055000
CVTRMPTT EQU   CVTS01+564                                               05056000
CVTVPSA  EQU   CVTS01+560                                               05057000
CVTVSTOP EQU   CVTS01+556                                               05058000
CVTGTFR8 EQU   CVTS01+552                                               05059000
CVTQUIT  EQU   CVTS01+548                                               05060000
CVTVACR  EQU   CVTS01+544                                               05061000
CVTWTCB  EQU   CVTS01+540                                               05062000
CVTSTPRS EQU   CVTS01+536                                               05063000
CVT0PT02 EQU   CVTS01+532                                               05064000
CVTDARCM EQU   CVTS01+528                                               05065000
CVTIRECM EQU   CVTS01+524                                               05066000
CVTJRECM EQU   CVTS01+520                                               05067000
CVTVEMS0 EQU   CVTS01+516                                               05068000
CVTSPFRR EQU   CVTS01+512                                               05069000
CVTRLSTG EQU   CVTS01+508                                               05070000
CVT0TC0A EQU   CVTS01+504                                               05071000
CVTGMBR  EQU   CVTS01+500                                               05072000
CVTLFRM  EQU   CVTS01+496                                               05073000
CVTVIOP  EQU   CVTS01+488                                               05074000
CVTRV307 EQU   CVTS01+486                                               05075000
CVTRV306 EQU   CVTS01+484                                               05076000
CVTRV305 EQU   CVTS01+482                                               05077000
CVTRV304 EQU   CVTS01+480                                               05078000
CVTRV303 EQU   CVTS01+478                                               05079000
CVTRV302 EQU   CVTS01+476                                               05080000
CVTTRCA  EQU   CVTS01+472                                               05081000
CVTRV297 EQU   CVTRV289                                                 05082000
CVTRV296 EQU   CVTRV289                                                 05083000
CVTRV295 EQU   CVTRV289                                                 05084000
CVTRV294 EQU   CVTRV289                                                 05085000
CVTRV293 EQU   CVTRV289                                                 05086000
CVTRV292 EQU   CVTRV289                                                 05087000
CVTRV291 EQU   CVTRV289                                                 05088000
CVTRV290 EQU   CVTRV289                                                 05089000
CVTRV288 EQU   CVTRV280                                                 05090000
CVTRV287 EQU   CVTRV280                                                 05091000
CVTRV286 EQU   CVTRV280                                                 05092000
CVTRV285 EQU   CVTRV280                                                 05093000
CVTRV284 EQU   CVTRV280                                                 05094000
CVTRV283 EQU   CVTRV280                                                 05095000
CVTRV282 EQU   CVTRV280                                                 05096000
CVTRV281 EQU   CVTRV280                                                 05097000
CVTRV279 EQU   CVTRV271                                                 05098000
CVTRV278 EQU   CVTRV271                                                 05099000
CVTRV277 EQU   CVTRV271                                                 05100000
CVTRV276 EQU   CVTRV271                                                 05101000
CVTRV275 EQU   CVTRV271                                                 05102000
CVTRV274 EQU   CVTRV271                                                 05103000
CVTRV273 EQU   CVTRV271                                                 05104000
CVTRV272 EQU   CVTRV271                                                 05105000
CVTRV270 EQU   CVTRV262                                                 05106000
CVTRV269 EQU   CVTRV262                                                 05107000
CVTRV268 EQU   CVTRV262                                                 05108000
CVTRV267 EQU   CVTRV262                                                 05109000
CVTRV266 EQU   CVTRV262                                                 05110000
CVTRV265 EQU   CVTRV262                                                 05111000
CVTRV264 EQU   CVTRV262                                                 05112000
CVTRV263 EQU   CVTRV262                                                 05113000
CVTVFP   EQU   CVTS01+464                                               05114000
CVTVSI   EQU   CVTS01+460                                               05115000
CVTVPSIB EQU   CVTS01+456                                               05116000
CVTMFACT EQU   CVTMFRTR                                                 05117000
CVTMFCTL EQU   CVTS01+448                                               05118000
CVTPVBP  EQU   CVTS01+444                                               05119000
CVTPWI   EQU   CVTS01+440                                               05120000
CVTRV254 EQU   CVTS01+438                                               05121000
CVTRV253 EQU   CVTS01+436                                               05122000
CVTRV252 EQU   CVTS01+434                                               05123000
CVTRV251 EQU   CVTS01+433                                               05124000
CVTRV250 EQU   CVTS01+432                                               05125000
CVTRV249 EQU   CVTS01+431                                               05126000
CVTRV248 EQU   CVTS01+430                                               05127000
CVTRV247 EQU   CVTS01+429                                               05128000
CVTRV246 EQU   CVTS01+428                                               05129000
CVTRV245 EQU   CVTRV237                                                 05130000
CVTRV244 EQU   CVTRV237                                                 05131000
CVTRV243 EQU   CVTRV237                                                 05132000
CVTRV242 EQU   CVTRV237                                                 05133000
CVTRV241 EQU   CVTRV237                                                 05134000
CVTRV240 EQU   CVTRV237                                                 05135000
CVTRV239 EQU   CVTRV237                                                 05136000
CVTRV238 EQU   CVTRV237                                                 05137000
CVTRV236 EQU   CVTRV228                                                 05138000
CVTRV235 EQU   CVTRV228                                                 05139000
CVTRV234 EQU   CVTRV228                                                 05140000
CVTRV233 EQU   CVTRV228                                                 05141000
CVTRV232 EQU   CVTRV228                                                 05142000
CVTRV231 EQU   CVTRV228                                                 05143000
CVTRV230 EQU   CVTRV228                                                 05144000
CVTRV229 EQU   CVTRV228                                                 05145000
CVTRV227 EQU   CVTRV219                                                 05146000
CVTRV226 EQU   CVTRV219                                                 05147000
CVTRV225 EQU   CVTRV219                                                 05148000
CVTRV224 EQU   CVTRV219                                                 05149000
CVTRV223 EQU   CVTRV219                                                 05150000
CVTRV222 EQU   CVTRV219                                                 05151000
CVTRV221 EQU   CVTRV219                                                 05152000
CVTRV220 EQU   CVTRV219                                                 05153000
CVTRV218 EQU   CVTRV210                                                 05154000
CVTRV217 EQU   CVTRV210                                                 05155000
CVTRV216 EQU   CVTRV210                                                 05156000
CVTRV215 EQU   CVTRV210                                                 05157000
CVTRV214 EQU   CVTRV210                                                 05158000
CVTRV213 EQU   CVTRV210                                                 05159000
CVTRV212 EQU   CVTRV210                                                 05160000
CVTRV211 EQU   CVTRV210                                                 05161000
CVTLCCAT EQU   CVTS01+420                                               05162000
CVTPCCAT EQU   CVTS01+416                                               05163000
CVTIPCRP EQU   CVTS01+412                                               05164000
CVTIPCRI EQU   CVTS01+408                                               05165000
CVTIPCDS EQU   CVTS01+404                                               05166000
CVTAIDVT EQU   CVTS01+400                                               05167000
CVTSSAP  EQU   CVTS01+396                                               05168000
CVTEHCIR EQU   CVTS01+392                                               05169000
CVTEHDEF EQU   CVTS01+388                                               05170000
CVTDAIR  EQU   CVTS01+384                                               05171000
CVTPERFM EQU   CVTS01+380                                               05172000
CVT044R2 EQU   CVTS01+376                                               05173000
CVTFETCH EQU   CVTS01+372                                               05174000
CVTRSTWD EQU   CVTS01+368                                               05175000
CVTSPOST EQU   CVTS01+364                                               05176000
CVTIOBP  EQU   CVTS01+360                                               05177000
CVTASMVT EQU   CVTS01+356                                               05178000
CVTRECRQ EQU   CVTS01+352                                               05179000
CVTWSAC  EQU   CVTS01+348                                               05180000
CVTRV149 EQU   CVTS01+344                                               05181000
CVTWSAL  EQU   CVTS01+340                                               05182000
CVTSPSA  EQU   CVTS01+336                                               05183000
CVTGLMN  EQU   CVTS01+332                                               05184000
CVTVEAC0 EQU   CVTS01+328                                               05185000
CVT062R1 EQU   CVTS01+324                                               05186000
CVTRPOST EQU   CVTS01+320                                               05187000
CVTDQIQE EQU   CVTS01+316                                               05188000
CVTCSD   EQU   CVTS01+312                                               05189000
CVTLKRMA EQU   CVTS01+308                                               05190000
CVTRSPIE EQU   CVTS01+304                                               05191000
CVTRENQ  EQU   CVTS01+300                                               05192000
CVTLQCB  EQU   CVTS01+296                                               05193000
CVTFQCB  EQU   CVTS01+292                                               05194000
CVTQCS01 EQU   CVTS01+288                                               05195000
CVTAPFT  EQU   CVTS01+284                                               05196000
CVTPARRL EQU   CVTS01+280                                               05197000
CVTVWAIT EQU   CVTS01+276                                               05198000
CVTGSPL  EQU   CVTS01+272                                               05199000
CVTLSMQ  EQU   CVTS01+268                                               05200000
CVTGSMQ  EQU   CVTS01+264                                               05201000
CVTEXPRO EQU   CVTS01+260                                               05202000
CVTOPCTP EQU   CVTS01+256                                               05203000
CVTSIC   EQU   CVTS01+252                                               05204000
CVTTPIOS EQU   CVTS01+248                                               05205000
CVTRTMS  EQU   CVTS01+244                                               05206000
CVTSDBF  EQU   CVTS01+240                                               05207000
CVTSCBP  EQU   CVTS01+236                                               05208000
CVTSDMP  EQU   CVTS01+232                                               05209000
CVTSV60  EQU   CVTS01+228                                               05210000
CVTRTMCT EQU   CVTS01+224                                               05211000
CVTASCBL EQU   CVTS01+220                                               05212000
CVTASCBH EQU   CVTS01+216                                               05213000
CVTGDA   EQU   CVTS01+212                                               05214000
CVTVVMDI EQU   CVTS01+204                                               05215000
CVTAQTOP EQU   CVTS01+200                                               05216000
CVTIOSCS EQU   CVTS01+196                                               05217000
CVTSDRM  EQU   CVTS01+192                                               05218000
CVTOPTE  EQU   CVTS01+188                                               05219000
CVTSTXU  EQU   CVTS01+184                                               05220000
CVTQUIS  EQU   CVTS01+180                                               05221000
CVTPARS  EQU   CVTS01+176                                               05222000
CVTS1EE  EQU   CVTS01+172                                               05223000
CVTFRAS  EQU   CVTS01+168                                               05224000
CVTQSAS  EQU   CVTS01+164                                               05225000
CVTCRAS  EQU   CVTS01+160                                               05226000
CVTDELCP EQU   CVTS01+152                                               05227000
CVTAUTHL EQU   CVTS01+136                                               05228000
CVTSCAN  EQU   CVTS01+132                                               05229000
CVTRV144 EQU   CVTS01+130                                               05230000
CVTMAXMP EQU   CVTS01+128                                               05231000
CVTSTCK  EQU   CVTS01+124                                               05232000
CVTRV139 EQU   CVTS01+123                                               05233000
CVTDSSAC EQU   CVTS01+122                                               05234000
CVTRV513 EQU   CVTS01+121                                               05235000
CVTIOSPL EQU   CVTS01+120                                               05236000
CVTPTGT  EQU   CVTS01+116                                               05237000
CVTCSPIE EQU   CVTS01+112                                               05238000
CVTSMFEX EQU   CVTS01+108                                               05239000
CVTOLT0A EQU   CVTS01+104                                               05240000
CVTSRBRT EQU   CVTS01+100                                               05241000
CVTPUTL  EQU   CVTS01+96                                                05242000
CVTASCRL EQU   CVTS01+92                                                05243000
CVTASCRF EQU   CVTS01+88                                                05244000
CVTRV326 EQU   CVTS01+84                                                05245000
CVTRV325 EQU   CVTS01+80                                                05246000
CVTRV324 EQU   CVTS01+76                                                05247000
CVT0VL01 EQU   CVTS01+72                                                05248000
CVTSHRVM EQU   CVTS01+68                                                05249000
CVTRV332 EQU   CVTS01+64                                                05250000
CVTTAS   EQU   CVTS01+60                                                05251000
CVTRSCN  EQU   CVTS01+56                                                05252000
CVTTRAC2 EQU   CVTS01+54                                                05253000
CVTTRACE EQU   CVTS01+52                                                05254000
CVTAPG   EQU   CVTS01+51                                                05255000
CVTSDTRC EQU   CVTCTLFG                                                 05256000
CVTGTRCE EQU   CVTCTLFG                                                 05257000
CVTNOMP  EQU   CVTCTLFG                                                 05258000
CVTRSV79 EQU   CVTCTLFG                                                 05259000
CVTDSTAT EQU   CVTCTLFG                                                 05260000
CVTRSV78 EQU   CVTCTLFG                                                 05261000
CVTRV333 EQU   CVTCTLFG                                                 05262000
CVTRV323 EQU   CVTCTLFG                                                 05263000
CVTSPVLK EQU   CVTS01+49                                                05264000
CVTRSV77 EQU   CVTS01+48                                                05265000
CVTRV331 EQU   CVTS01+44                                                05266000
CVTRV330 EQU   CVTS01+40                                                05267000
CVTRV329 EQU   CVTS01+36                                                05268000
CVTRV328 EQU   CVTS01+32                                                05269000
CVTRV322 EQU   CVTS01+28                                                05270000
CVTSLID  EQU   CVTSLIDA+1                                               05271000
CVTSYLK  EQU   CVTSLIDA                                                 05272000
CVTRV321 EQU   CVTS01+20                                                05273000
CVTRV320 EQU   CVTS01+16                                                05274000
CVTLPDIR EQU   CVTLPDIA+1                                               05275000
CVTRSV69 EQU   CVTDIRST                                                 05276000
CVTRSV68 EQU   CVTDIRST                                                 05277000
CVTRSV67 EQU   CVTDIRST                                                 05278000
CVTRSV66 EQU   CVTDIRST                                                 05279000
CVTRSV65 EQU   CVTDIRST                                                 05280000
CVTRSV64 EQU   CVTDIRST                                                 05281000
CVTRSV63 EQU   CVTDIRST                                                 05282000
CVTDICOM EQU   CVTDIRST                                                 05283000
CVTPVTP  EQU   CVTS01+8                                                 05284000
CVTLPDSR EQU   CVTS01+4                                                 05285000
CVTGETL  EQU   CVTS01                                                   05286000
RBRSV161 EQU   RBSECS09+64                                              05287000
RBSIRBWA EQU   RBSECS09                                                 05288000
RBIQEWRK EQU   RBSECS08+4                                               05289000
RBNEXAV  EQU   RBSECS08                                                 05290000
RBIQEA   EQU   RBIQE2                                                   05291000
RBIQE1   EQU   RBIQE+1                                                  05292000
RBUSE    EQU   RBIQE                                                    05293000
RBSQEA   EQU   RBSQE+1                                                  05294000
@NM00090 EQU   RBSQE                                                    05295000
RBCDE1   EQU   RBCDE+1                                                  05296000
RBCDLOAD EQU   RBCDFLGS                                                 05297000
RBCDXCTL EQU   RBCDFLGS                                                 05298000
RBCDSYNC EQU   RBCDFLGS                                                 05299000
RBCDNODE EQU   RBCDFLGS                                                 05300000
RBCDSAVE EQU   RBCDFLGS                                                 05301000
RBCDATCH EQU   RBCDFLGS                                                 05302000
RBRSV009 EQU   RBCDFLGS                                                 05303000
RBNOCELL EQU   RBCDFLGS                                                 05304000
UCMIECBP EQU   UCMIECBA+1                                               05305000
UCMIECBF EQU   UCMIECBA                                                 05306000
XVD3     EQU   XVDFLAGS+3                                               05307000
XVD2CON  EQU   XVD2                                                     05308000
XVRESV01 EQU   XVD1                                                     05309000
XVD1OEXT EQU   XVD1                                                     05310000
XVD1CFPL EQU   XVD1                                                     05311000
XVD0S250 EQU   XVD0                                                     05312000
@NM00148 EQU   SCVTSECT+180                                             05313000
@NM00147 EQU   SCVTSECT+176                                             05314000
SCVTPIQE EQU   SCVTSECT+172                                             05315000
@NM00146 EQU   SCVTSECT+168                                             05316000
SCVTPTRM EQU   SCVTSECT+164                                             05317000
@NM00145 EQU   SCVTSECT+160                                             05318000
@NM00144 EQU   SCVTSECT+156                                             05319000
SCVTQCBR EQU   SCVTSECT+152                                             05320000
SCVTSTAT EQU   SCVTSECT+148                                             05321000
@NM00143 EQU   SCVTSECT+144                                             05322000
SCVTTQE  EQU   SCVTSECT+140                                             05323000
@NM00142 EQU   SCVTSECT+136                                             05324000
SCVTSVCT EQU   SCVTSECT+132                                             05325000
@NM00141 EQU   SCVTSECT+128                                             05326000
@NM00140 EQU   SCVTSECT+124                                             05327000
SCVTRXLQ EQU   SCVTSECT+120                                             05328000
@NM00139 EQU   SCVTSECT+116                                             05329000
SCVTCTCB EQU   SCVTSECT+112                                             05330000
@NM00138 EQU   SCVTSECT+108                                             05331000
@NM00137 EQU   SCVTSECT+104                                             05332000
@NM00136 EQU   SCVTSECT+100                                             05333000
@NM00135 EQU   SCVTSECT+96                                              05334000
SCVTCOMM EQU   SCVTSECT+92                                              05335000
@NM00134 EQU   SCVTSECT+88                                              05336000
@NM00133 EQU   SCVTSECT+84                                              05337000
@NM00132 EQU   SCVTSECT+80                                              05338000
@NM00131 EQU   SCVTSECT+76                                              05339000
@NM00130 EQU   SCVTSECT+72                                              05340000
SCVTGMBR EQU   SCVTSECT+68                                              05341000
SCVTRPTR EQU   SCVTSECT+64                                              05342000
SCVTHSKP EQU   SCVTSECT+60                                              05343000
@NM00129 EQU   SCVTSECT+56                                              05344000
@NM00128 EQU   SCVTSECT+52                                              05345000
SCVTLFRM EQU   SCVTSECT+48                                              05346000
SCVTCDCL EQU   SCVTSECT+44                                              05347000
@NM00127 EQU   SCVTSECT+40                                              05348000
SCVTRACE EQU   SCVTSECT+36                                              05349000
@NM00126 EQU   SCVTSECT+32                                              05350000
@NM00125 EQU   SCVTSECT+24                                              05351000
@NM00124 EQU   SCVTSECT+20                                              05352000
@NM00123 EQU   SCVTSECT+16                                              05353000
@NM00122 EQU   SCVTSECT+14                                              05354000
SCVTBR14 EQU   SCVTSECT+12                                              05355000
SCVTSPET EQU   SCVTSECT+8                                               05356000
SCVTPGWR EQU   SCVTSECT+4                                               05357000
SCVTPGTM EQU   SCVTSECT                                                 05358000
CVTLEVL  EQU   CVTRELNO+2                                               05359000
CVTNUMB  EQU   CVTRELNO                                                 05360000
CVTMDL   EQU   CVTFIX+250                                               05361000
@NM00121 EQU   CVTFIX+248                                               05362000
@NM00120 EQU   CVTFIX                                                   05363000
CVTRV482 EQU   CVTXTNT2+128                                             05364000
CVTRV481 EQU   CVTXTNT2+124                                             05365000
CVTRV480 EQU   CVTXTNT2+120                                             05366000
CVTRV479 EQU   CVTXTNT2+118                                             05367000
CVTRV478 EQU   CVTXTNT2+117                                             05368000
CVTRV477 EQU   CVTXTNT2+116                                             05369000
CVTRV476 EQU   CVTXTNT2+115                                             05370000
CVTRV475 EQU   CVTXTNT2+114                                             05371000
CVTRV474 EQU   CVTRV466                                                 05372000
CVTRV473 EQU   CVTRV466                                                 05373000
CVTRV472 EQU   CVTRV466                                                 05374000
CVTRV471 EQU   CVTRV466                                                 05375000
CVTRV470 EQU   CVTRV466                                                 05376000
CVTRV469 EQU   CVTRV466                                                 05377000
CVTRV468 EQU   CVTRV466                                                 05378000
CVTRV467 EQU   CVTRV466                                                 05379000
CVTRV465 EQU   CVTRV457                                                 05380000
CVTRV464 EQU   CVTRV457                                                 05381000
CVTRV463 EQU   CVTRV457                                                 05382000
CVTRV462 EQU   CVTRV457                                                 05383000
CVTRV461 EQU   CVTRV457                                                 05384000
CVTRV460 EQU   CVTRV457                                                 05385000
CVTRV459 EQU   CVTRV457                                                 05386000
CVTRV458 EQU   CVTRV457                                                 05387000
CVTRV456 EQU   CVTXTNT2+108                                             05388000
CVTRV455 EQU   CVTXTNT2+104                                             05389000
CVTRV454 EQU   CVTXTNT2+100                                             05390000
CVTRV453 EQU   CVTXTNT2+96                                              05391000
CVTRV452 EQU   CVTXTNT2+94                                              05392000
CVTRV451 EQU   CVTXTNT2+92                                              05393000
CVTRV450 EQU   CVTXTNT2+90                                              05394000
CVTRV449 EQU   CVTXTNT2+88                                              05395000
CVTRV448 EQU   CVTXTNT2+87                                              05396000
CVTRV447 EQU   CVTXTNT2+86                                              05397000
CVTRV446 EQU   CVTRV438                                                 05398000
CVTRV445 EQU   CVTRV438                                                 05399000
CVTRV444 EQU   CVTRV438                                                 05400000
CVTRV443 EQU   CVTRV438                                                 05401000
CVTRV442 EQU   CVTRV438                                                 05402000
CVTRV441 EQU   CVTRV438                                                 05403000
CVTRV440 EQU   CVTRV438                                                 05404000
CVTRV439 EQU   CVTRV438                                                 05405000
CVTRV437 EQU   CVTRV429                                                 05406000
CVTRV436 EQU   CVTRV429                                                 05407000
CVTRV435 EQU   CVTRV429                                                 05408000
CVTRV434 EQU   CVTRV429                                                 05409000
CVTRV433 EQU   CVTRV429                                                 05410000
CVTRV432 EQU   CVTRV429                                                 05411000
CVTRV431 EQU   CVTRV429                                                 05412000
CVTRV430 EQU   CVTRV429                                                 05413000
CVTRV428 EQU   CVTXTNT2+80                                              05414000
CVTRV427 EQU   CVTXTNT2+76                                              05415000
CVTRV426 EQU   CVTXTNT2+72                                              05416000
CVTRV425 EQU   CVTXTNT2+68                                              05417000
CVTATACT EQU   CVTATCVT                                                 05418000
CVTRV423 EQU   CVTXTNT2+62                                              05419000
CVTRV422 EQU   CVTXTNT2+60                                              05420000
CVTRV421 EQU   CVTXTNT2+58                                              05421000
CVTRV420 EQU   CVTXTNT2+56                                              05422000
CVTRV419 EQU   CVTXTNT2+55                                              05423000
CVTRV418 EQU   CVTXTNT2+54                                              05424000
CVTRV417 EQU   CVTRV409                                                 05425000
CVTRV416 EQU   CVTRV409                                                 05426000
CVTRV415 EQU   CVTRV409                                                 05427000
CVTRV414 EQU   CVTRV409                                                 05428000
CVTRV413 EQU   CVTRV409                                                 05429000
CVTRV412 EQU   CVTRV409                                                 05430000
CVTRV411 EQU   CVTRV409                                                 05431000
CVTRV410 EQU   CVTRV409                                                 05432000
CVTRV408 EQU   CVTRV400                                                 05433000
CVTRV407 EQU   CVTRV400                                                 05434000
CVTRV406 EQU   CVTRV400                                                 05435000
CVTRV405 EQU   CVTRV400                                                 05436000
CVTRV404 EQU   CVTRV400                                                 05437000
CVTRV403 EQU   CVTRV400                                                 05438000
CVTRV402 EQU   CVTRV400                                                 05439000
CVTRV401 EQU   CVTRV400                                                 05440000
CVTICB   EQU   CVTXTNT2+48                                              05441000
CVTSKTA  EQU   CVTXTNT2+44                                              05442000
CVTCCVT  EQU   CVTXTNT2+40                                              05443000
CVTRSV98 EQU   CVTXTNT2+36                                              05444000
CVTRSV97 EQU   CVTXTNT2+34                                              05445000
CVTRSV96 EQU   CVTXTNT2+32                                              05446000
CVTOLTEP EQU   CVTXTNT2+28                                              05447000
CVTQIDA  EQU   CVTQID+1                                                 05448000
CVTRSV95 EQU   CVTQID                                                   05449000
CVTRSV94 EQU   CVTXTNT2+20                                              05450000
CVTRSV93 EQU   CVTXTNT2+16                                              05451000
CVTRSV92 EQU   CVTXTNT2+12                                              05452000
CVTDEBVR EQU   CVTXTNT2+8                                               05453000
CVTRSV91 EQU   CVTXTNT2+6                                               05454000
CVTRSV9H EQU   CVTFLGBT                                                 05455000
CVTRSV9G EQU   CVTFLGBT                                                 05456000
CVTRSV9F EQU   CVTFLGBT                                                 05457000
CVTRSV9E EQU   CVTFLGBT                                                 05458000
CVTRSV9D EQU   CVTFLGBT                                                 05459000
CVTRSV9C EQU   CVTFLGBT                                                 05460000
CVTVME   EQU   CVTFLGBT                                                 05461000
CVTNPE   EQU   CVTFLGBT                                                 05462000
CVTNUCLS EQU   CVTXTNT2+4                                               05463000
CVTDSSVA EQU   CVTDSSV+1                                                05464000
CVTRSV89 EQU   CVTDSSV                                                  05465000
CVTRSV88 EQU   CVTXTNT1+8                                               05466000
CVTRSV87 EQU   CVTXTNT1+4                                               05467000
CVTFACHN EQU   CVTXTNT1                                                 05468000
CVTRV488 EQU   CVTMAP+412                                               05469000
CVTRV487 EQU   CVTMAP+408                                               05470000
CVTRV486 EQU   CVTMAP+404                                               05471000
CVTRV485 EQU   CVTMAP+400                                               05472000
CVTACTAP EQU   CVTMAP+396                                               05473000
CVTAUTH  EQU   CVTMAP+392                                               05474000
CVTATMCA EQU   CVTATMCT+1                                               05475000
CVTATMST EQU   CVTATMCT                                                 05476000
CVTRSV61 EQU   CVTMAP+384                                               05477000
CVTVOLT1 EQU   CVTVOLM1+1                                               05478000
CVTVOLI1 EQU   CVTVOLF1                                                 05479000
CVTSTOA  EQU   CVTMAP+376                                               05480000
CVTRSV58 EQU   CVTMAP+374                                               05481000
CVTRSV57 EQU   CVTMAP+372                                               05482000
CVTDDCE  EQU   CVTMAP+368                                               05483000
CVTPNWFR EQU   CVTMAP+364                                               05484000
CVTSMF   EQU   CVTMAP+360                                               05485000
CVTSULK  EQU   CVTMAP+358                                               05486000
CVTSLKO  EQU   CVTSYSK                                                  05487000
CVTSLKP  EQU   CVTSYSK                                                  05488000
CVTSLKQ  EQU   CVTSYSK                                                  05489000
CVTSLKR  EQU   CVTSYSK                                                  05490000
CVTRSV56 EQU   CVTSYSK                                                  05491000
CVTRSV55 EQU   CVTSYSK                                                  05492000
CVTRSV54 EQU   CVTSYSK                                                  05493000
CVTRSV53 EQU   CVTSYSK                                                  05494000
CVTRSV52 EQU   CVTA1F1                                                  05495000
CVTRSV51 EQU   CVTA1F1                                                  05496000
CVTRSV50 EQU   CVTA1F1                                                  05497000
CVTRSV49 EQU   CVTA1F1                                                  05498000
CVTRSV48 EQU   CVTA1F1                                                  05499000
CVTRSV47 EQU   CVTA1F1                                                  05500000
CVTSRSW  EQU   CVTA1F1                                                  05501000
CVTPFSW  EQU   CVTA1F1                                                  05502000
CVTPCVT  EQU   CVTMAP+352                                               05503000
CVTRSV46 EQU   CVTMAP+344                                               05504000
CVTRSV45 EQU   CVTMAP+340                                               05505000
CVTRSV44 EQU   CVTMAP+338                                               05506000
CVTRSV43 EQU   CVTMAP+336                                               05507000
CVTHJESA EQU   CVTHJES+1                                                05508000
CVTRSV42 EQU   CVTHJES                                                  05509000
CVTEXT2A EQU   CVTEXT2+1                                                05510000
CVTRSV41 EQU   CVTEXT2                                                  05511000
CVTAPFA  EQU   CVTAPF+1                                                 05512000
CVTRSV40 EQU   CVTAPF                                                   05513000
CVTRV518 EQU   CVTINTLA                                                 05514000
CVTRV517 EQU   CVTERPV                                                  05515000
CVTEORM  EQU   CVTMAP+312                                               05516000
CVTMCHPR EQU   CVTMAP+308                                               05517000
CVTTZ    EQU   CVTMAP+304                                               05518000
CVTJEPS  EQU   CVTMAP+300                                               05519000
CVTMODE  EQU   CVTMAP+292                                               05520000
CVTPTRV  EQU   CVTMAP+288                                               05521000
CVTREAL  EQU   CVTMAP+284                                               05522000
CVTRSV39 EQU   CVTMAP+280                                               05523000
CVTRSV38 EQU   CVTMAP+276                                               05524000
CVTDMSRA EQU   CVTDMSR+1                                                05525000
CVTRV634 EQU   CVTDMSRF                                                 05526000
CVTRV633 EQU   CVTDMSRF                                                 05527000
CVTRV632 EQU   CVTDMSRF                                                 05528000
CVTRV631 EQU   CVTDMSRF                                                 05529000
CVTRV630 EQU   CVTDMSRF                                                 05530000
CVTRV629 EQU   CVTDMSRF                                                 05531000
CVTUDUMP EQU   CVTDMSRF                                                 05532000
CVTSDUMP EQU   CVTDMSRF                                                 05533000
CVTQMSGA EQU   CVTQMSG+1                                                05534000
CVTRSV36 EQU   CVTQMSG                                                  05535000
CVTAMFF  EQU   CVTMAP+264                                               05536000
CVTPURGA EQU   CVTPURG+1                                                05537000
CVTRSV35 EQU   CVTPURG                                                  05538000
CVTCBSP  EQU   CVTMAP+256                                               05539000
CVTATERA EQU   CVTATER+1                                                05540000
CVTSYST  EQU   CVTATER                                                  05541000
CVTVOLT2 EQU   CVTTAT                                                   05542000
CVTVOLI2 EQU   CVTVOLF2                                                 05543000
CVTAQAVB EQU   CVTAQAVT+1                                               05544000
CVTRSV34 EQU   CVTTCMFG                                                 05545000
CVTRSV33 EQU   CVTTCMFG                                                 05546000
CVTRSV32 EQU   CVTTCMFG                                                 05547000
CVTRSV31 EQU   CVTTCMFG                                                 05548000
CVTRSV30 EQU   CVTTCMFG                                                 05549000
CVTRSV29 EQU   CVTTCMFG                                                 05550000
CVTRSV28 EQU   CVTTCMFG                                                 05551000
CVTTCRDY EQU   CVTTCMFG                                                 05552000
CVTGTFA  EQU   CVTGTF+1                                                 05553000
CVTRSV27 EQU   CVTGTFST                                                 05554000
CVTRNIO  EQU   CVTGTFST                                                 05555000
CVTUSR   EQU   CVTGTFST                                                 05556000
CVTRV318 EQU   CVTFORM                                                  05557000
CVTRV317 EQU   CVTTMODE                                                 05558000
CVTRV316 EQU   CVTSTATE                                                 05559000
CVTRV315 EQU   CVTGTFS                                                  05560000
CVTGTFAV EQU   CVTGTFS                                                  05561000
CVT0SCR1 EQU   CVTMAP+232                                               05562000
CVTRV515 EQU   CVTMAP+228                                               05563000
CVTRMS   EQU   CVTMAP+224                                               05564000
CVTPATCH EQU   CVTMAP+220                                               05565000
CVTTSCE  EQU   CVTMAP+216                                               05566000
CVTLNKSC EQU   CVTMAP+214                                               05567000
CVTQABST EQU   CVTMAP+212                                               05568000
CVTMDLDS EQU   CVTMAP+208                                               05569000
CVTUSER  EQU   CVTMAP+204                                               05570000
CVTSMCA  EQU   CVTMAP+196                                               05571000
CVTRSV18 EQU   CVTMAP+192                                               05572000
CVTQLPAQ EQU   CVTMAP+188                                               05573000
CVTQCDSR EQU   CVTMAP+184                                               05574000
CVTRSV17 EQU   CVTOPTB                                                  05575000
CVTRSV16 EQU   CVTOPTB                                                  05576000
CVTFP    EQU   CVTOPTB                                                  05577000
CVTAPTHR EQU   CVTOPTB                                                  05578000
CVTNLOG  EQU   CVTOPTB                                                  05579000
CVTTOD   EQU   CVTOPTB                                                  05580000
CVTCTIMS EQU   CVTOPTB                                                  05581000
CVTPROT  EQU   CVTOPTB                                                  05582000
CVTXPFP  EQU   CVTOPTA                                                  05583000
CVTASCII EQU   CVTOPTA                                                  05584000
CVTRSV13 EQU   CVTOPTA                                                  05585000
CVTRSV12 EQU   CVTOPTA                                                  05586000
CVTNIP   EQU   CVTOPTA                                                  05587000
CVTDDR   EQU   CVTOPTA                                                  05588000
CVTAPR   EQU   CVTOPTA                                                  05589000
CVTCCH   EQU   CVTOPTA                                                  05590000
CVTSNCTR EQU   CVTMAP+180                                               05591000
CVTQMWR  EQU   CVTMAP+176                                               05592000
CVTQOCR  EQU   CVTMAP+172                                               05593000
CVT1EF00 EQU   CVTMAP+168                                               05594000
CVTMZ00  EQU   CVTMAP+164                                               05595000
CVTSV76Q EQU   CVTSV76C                                                 05596000
CVTRSV11 EQU   CVTMAP+156                                               05597000
CVTRV516 EQU   CVTIERLC                                                 05598000
CVTILCH  EQU   CVTMAP+140                                               05599000
CVT0DS   EQU   CVTMAP+136                                               05600000
CVTFBOSV EQU   CVTMAP+132                                               05601000
CVTNUCB  EQU   CVTMAP+128                                               05602000
CVTIXAVL EQU   CVTMAP+124                                               05603000
CVTSV76M EQU   CVTIOQET                                                 05604000
CVTDCBA  EQU   CVTMAP+117                                               05605000
CVTMVS2  EQU   CVTDCB                                                   05606000
CVT6DAT  EQU   CVTDCB                                                   05607000
CVT4MPS  EQU   CVTDCB                                                   05608000
CVTRSV09 EQU   CVTDCB                                                   05609000
CVT4MS1  EQU   CVTDCB                                                   05610000
CVT2SPS  EQU   CVTDCB                                                   05611000
CVT1SSS  EQU   CVTDCB                                                   05612000
CVTRSV08 EQU   CVTDCB                                                   05613000
CVTSTB   EQU   CVTMAP+112                                               05614000
CVTQTD00 EQU   CVTMAP+108                                               05615000
CVTQTE00 EQU   CVTMAP+104                                               05616000
CVTSJQ   EQU   CVTMAP+96                                                05617000
CVTPBLDL EQU   CVTMAP+92                                                05618000
CVTTPC   EQU   CVTMAP+88                                                05619000
CVTSVDCB EQU   CVTMAP+84                                                05620000
CVTBRET  EQU   CVTMAP+82                                                05621000
CVTEXIT  EQU   CVTMAP+80                                                05622000
CVT0FN00 EQU   CVTMAP+76                                                05623000
CVTDARA  EQU   CVTDAR+1                                                 05624000
CVTRSV07 EQU   CVTFLGS1                                                 05625000
CVTRSV06 EQU   CVTFLGS1                                                 05626000
CVTRSV05 EQU   CVTFLGS1                                                 05627000
CVTRSV04 EQU   CVTFLGS1                                                 05628000
CVTRSV03 EQU   CVTFLGS1                                                 05629000
CVTRSV02 EQU   CVTFLGS1                                                 05630000
CVTRSV01 EQU   CVTFLGS1                                                 05631000
CVTDMPLK EQU   CVTFLGS1                                                 05632000
CVTXITP  EQU   CVTMAP+68                                                05633000
CVTZDTAB EQU   CVTMAP+64                                                05634000
CVTMSLT  EQU   CVTMAP+60                                                05635000
CVTDATE  EQU   CVTMAP+56                                                05636000
CVTBTERM EQU   CVTMAP+52                                                05637000
CVTSYSAD EQU   CVTMAP+48                                                05638000
CVTXTLER EQU   CVTMAP+44                                                05639000
CVTILK2  EQU   CVTMAP+40                                                05640000
CVTILK1  EQU   CVTMAP+36                                                05641000
CVTPRLTV EQU   CVTMAP+32                                                05642000
CVTPCNVT EQU   CVTMAP+28                                                05643000
CVT0VL00 EQU   CVTMAP+24                                                05644000
CVTXAPG  EQU   CVTMAP+20                                                05645000
CVTBUF   EQU   CVTMAP+16                                                05646000
CVTJOB   EQU   CVTMAP+12                                                05647000
CVTLINK  EQU   CVTMAP+8                                                 05648000
CVT0EF00 EQU   CVTMAP+4                                                 05649000
CVTTCBP  EQU   CVTMAP                                                   05650000
CVT      EQU   CVTMAP                                                   05651000
ASCBEND  EQU   ASCB+208                                                 05652000
ASCBSRBT EQU   ASCB+200                                                 05653000
ASCBSWTL EQU   ASCB+196                                                 05654000
ASCBRS14 EQU   ASCB+195                                                 05655000
ASCBSMCT EQU   ASCB+194                                                 05656000
ASCBRS12 EQU   ASCB+192                                                 05657000
ASCBPCTT EQU   ASCB+188                                                 05658000
ASCBVGTT EQU   ASCB+184                                                 05659000
ASCBLGCB EQU   ASCB+180                                                 05660000
ASCBJBNS EQU   ASCB+176                                                 05661000
ASCBJBNI EQU   ASCB+172                                                 05662000
ASCBMCC  EQU   ASCB+168                                                 05663000
ASCBRTWA EQU   ASCB+164                                                 05664000
ASCBIQEA EQU   ASCB+160                                                 05665000
ASCBXMPQ EQU   ASCB+156                                                 05666000
ASCBRS01 EQU   ASCB+154                                                 05667000
ASCBFMCT EQU   ASCB+152                                                 05668000
ASCBOUXB EQU   ASCB+148                                                 05669000
ASCBOUCB EQU   ASCB+144                                                 05670000
ASCBMECB EQU   ASCB+140                                                 05671000
ASCBQECB EQU   ASCB+136                                                 05672000
ASCBCMSB EQU   ASCB+132                                                 05673000
ASCBCMSF EQU   ASCB+128                                                 05674000
ASCBTCBS EQU   ASCB+124                                                 05675000
ASCBNVSC EQU   ASCB+122                                                 05676000
ASCBVSC  EQU   ASCB+120                                                 05677000
ASCBSRBS EQU   ASCB+118                                                 05678000
ASCBSSRB EQU   ASCB+116                                                 05679000
ASCBRV06 EQU   ASCBFLG2                                                 05680000
ASCBRV05 EQU   ASCBFLG2                                                 05681000
ASCBRV04 EQU   ASCBFLG2                                                 05682000
ASCBSNQS EQU   ASCBFLG2                                                 05683000
ASCBS2S  EQU   ASCBFLG2                                                 05684000
ASCBCEXT EQU   ASCBFLG2                                                 05685000
ASCBPXMT EQU   ASCBFLG2                                                 05686000
ASCBXMPT EQU   ASCBFLG2                                                 05687000
ASCBRF07 EQU   ASCBDSP1                                                 05688000
ASCBRF06 EQU   ASCBDSP1                                                 05689000
ASCBRF05 EQU   ASCBDSP1                                                 05690000
ASCBRF04 EQU   ASCBDSP1                                                 05691000
ASCBRF03 EQU   ASCBDSP1                                                 05692000
ASCBRF02 EQU   ASCBDSP1                                                 05693000
ASCBFAIL EQU   ASCBDSP1                                                 05694000
ASCBNOQ  EQU   ASCBDSP1                                                 05695000
ASCBSWCT EQU   ASCB+112                                                 05696000
ASCBASXB EQU   ASCB+108                                                 05697000
ASCBTMCH EQU   ASCB+104                                                 05698000
ASCBNSWP EQU   ASCBFLG1                                                 05699000
ASCBTYP1 EQU   ASCBFLG1                                                 05700000
ASCBSTND EQU   ASCBFLG1                                                 05701000
ASCBABNT EQU   ASCBFLG1                                                 05702000
ASCBTERM EQU   ASCBFLG1                                                 05703000
ASCBS3S  EQU   ASCBFLG1                                                 05704000
ASCBCMSH EQU   ASCBFLG1                                                 05705000
ASCBTOFF EQU   ASCBFLG1                                                 05706000
ASCBRF01 EQU   ASCBRCTF                                                 05707000
ASCBTMLW EQU   ASCBRCTF                                                 05708000
ASCBOUT  EQU   ASCBRCTF                                                 05709000
ASCBWAIT EQU   ASCBRCTF                                                 05710000
ASCBRV08 EQU   ASCBRCTF                                                 05711000
ASCBFQU  EQU   ASCBRCTF                                                 05712000
ASCBFRS  EQU   ASCBRCTF                                                 05713000
ASCBTMNO EQU   ASCBRCTF                                                 05714000
ASCBAFFN EQU   ASCBFW1                                                  05715000
ASCBDUMP EQU   ASCB+96                                                  05716000
ASCBQSVC EQU   ASCB+92                                                  05717000
ASCBUBET EQU   ASCB+88                                                  05718000
ASCBECB  EQU   ASCB+84                                                  05719000
ASCBJSTL EQU   ASCB+80                                                  05720000
ASCBEWST EQU   ASCB+72                                                  05721000
ASCBEJST EQU   ASCB+64                                                  05722000
ASCBTSB  EQU   ASCB+60                                                  05723000
ASCBCSCB EQU   ASCB+56                                                  05724000
ASCBRSM  EQU   ASCB+52                                                  05725000
ASCBLDA  EQU   ASCB+48                                                  05726000
ASCBSTOR EQU   ASCB+44                                                  05727000
ASCBDP   EQU   ASCB+43                                                  05728000
ASCBRV07 EQU   ASCB+42                                                  05729000
ASCBIOSM EQU   ASCB+40                                                  05730000
ASCBSEQN EQU   ASCB+38                                                  05731000
ASCBCPUS EQU   ASCB+32                                                  05732000
ASCBSPL  EQU   ASCB+28                                                  05733000
ASCBLSLQ EQU   ASCB+24                                                  05734000
ASCBFSLQ EQU   ASCB+20                                                  05735000
ASCBIOSP EQU   ASCB+16                                                  05736000
ASCBLOCK EQU   ASCB+12                                                  05737000
ASCBBWDP EQU   ASCB+8                                                   05738000
ASCBFWDP EQU   ASCB+4                                                   05739000
ASCBASCB EQU   ASCB                                                     05740000
ASCBEGIN EQU   ASCB                                                     05741000
ASVTEND  EQU   ASVT+528                                                 05742000
ASVTAVAL EQU   ASVTENTY                                                 05743000
ASVTAVAI EQU   ASVTFRST                                                 05744000
ASVTRS00 EQU   ASVT+520                                                 05745000
ASVTMAXU EQU   ASVT+516                                                 05746000
ASVTASVT EQU   ASVT+512                                                 05747000
ASVTBEGN EQU   ASVT+512                                                 05748000
@NM00095 EQU   ASVT                                                     05749000
@NM00094 EQU   TCBXTNT2+32                                              05750000
TCBRV181 EQU   TCBRV173                                                 05751000
TCBRV180 EQU   TCBRV173                                                 05752000
TCBRV179 EQU   TCBRV173                                                 05753000
TCBRV178 EQU   TCBRV173                                                 05754000
TCBRV177 EQU   TCBRV173                                                 05755000
TCBRV176 EQU   TCBRV173                                                 05756000
TCBRV175 EQU   TCBRV173                                                 05757000
TCBRV174 EQU   TCBRV173                                                 05758000
TCBRV172 EQU   TCBRV164                                                 05759000
TCBRV171 EQU   TCBRV164                                                 05760000
TCBRV170 EQU   TCBRV164                                                 05761000
TCBRV169 EQU   TCBRV164                                                 05762000
TCBRV168 EQU   TCBRV164                                                 05763000
TCBRV167 EQU   TCBRV164                                                 05764000
TCBRV166 EQU   TCBRV164                                                 05765000
TCBRV165 EQU   TCBRV164                                                 05766000
TCBRV163 EQU   TCBRV155                                                 05767000
TCBRV162 EQU   TCBRV155                                                 05768000
TCBRV161 EQU   TCBRV155                                                 05769000
TCBRV160 EQU   TCBRV155                                                 05770000
TCBRV159 EQU   TCBRV155                                                 05771000
TCBRV158 EQU   TCBRV155                                                 05772000
TCBRV157 EQU   TCBRV155                                                 05773000
TCBRV156 EQU   TCBRV155                                                 05774000
TCBRV154 EQU   TCBRV146                                                 05775000
TCBRV153 EQU   TCBRV146                                                 05776000
TCBRV152 EQU   TCBRV146                                                 05777000
TCBRV151 EQU   TCBRV146                                                 05778000
TCBRV150 EQU   TCBRV146                                                 05779000
TCBRV149 EQU   TCBRV146                                                 05780000
TCBRV148 EQU   TCBRV146                                                 05781000
TCBRV147 EQU   TCBRV146                                                 05782000
TCBRV145 EQU   TCBXTNT2+26                                              05783000
TCBRV144 EQU   TCBXTNT2+24                                              05784000
TCBCAUF  EQU   TCBXTNT2+20                                              05785000
TCBRV142 EQU   TCBXTNT2+16                                              05786000
TCBRSV49 EQU   TCBXTNT2+12                                              05787000
TCBEVENT EQU   TCBXTNT2+8                                               05788000
TCBRCMP  EQU   TCBXTNT2+5                                               05789000
TCBRSVAB EQU   TCBXTNT2+4                                               05790000
TCBGTFA  EQU   TCBGTF+1                                                 05791000
TCBRSV47 EQU   TCBTFLG                                                  05792000
TCBRSV46 EQU   TCBTFLG                                                  05793000
TCBRSV45 EQU   TCBTFLG                                                  05794000
TCBRSV44 EQU   TCBTFLG                                                  05795000
TCBRSV43 EQU   TCBTFLG                                                  05796000
TCBDSPIT EQU   TCBTFLG                                                  05797000
TCBERRTN EQU   TCBTFLG                                                  05798000
TCBASYNC EQU   TCBTFLG                                                  05799000
@NM00093 EQU   TCB+296                                                  05800000
TCBSVCA2 EQU   TCB+292                                                  05801000
TCBSWASA EQU   TCB+288                                                  05802000
TCBDBTB  EQU   TCB+284                                                  05803000
TCBRPT   EQU   TCB+280                                                  05804000
TCBRV141 EQU   TCBRV133                                                 05805000
TCBRV140 EQU   TCBRV133                                                 05806000
TCBRV139 EQU   TCBRV133                                                 05807000
TCBRV138 EQU   TCBRV133                                                 05808000
TCBRV137 EQU   TCBRV133                                                 05809000
TCBRV136 EQU   TCBRV133                                                 05810000
TCBRV135 EQU   TCBRV133                                                 05811000
TCBRV134 EQU   TCBRV133                                                 05812000
TCBRV132 EQU   TCBRV124                                                 05813000
TCBRV131 EQU   TCBRV124                                                 05814000
TCBRV130 EQU   TCBRV124                                                 05815000
TCBRV129 EQU   TCBRV124                                                 05816000
TCBRV128 EQU   TCBRV124                                                 05817000
TCBRV127 EQU   TCBRV124                                                 05818000
TCBRV126 EQU   TCBRV124                                                 05819000
TCBRV125 EQU   TCBRV124                                                 05820000
TCBRV123 EQU   TCBFBYT2                                                 05821000
TCBRV122 EQU   TCBFBYT2                                                 05822000
TCBECBNV EQU   TCBFBYT2                                                 05823000
TCBSSSYN EQU   TCBFBYT2                                                 05824000
TCBFPRAP EQU   TCBFBYT2                                                 05825000
TCBFDW   EQU   TCBFBYT2                                                 05826000
TCBFMW   EQU   TCBFBYT2                                                 05827000
TCBCNCB  EQU   TCBFBYT2                                                 05828000
TCBLLH   EQU   TCBFBYT1                                                 05829000
TCBRV113 EQU   TCBFBYT1                                                 05830000
TCBEOT   EQU   TCBFBYT1                                                 05831000
TCBRTM2  EQU   TCBFBYT1                                                 05832000
TCBPGNLY EQU   TCBFBYT1                                                 05833000
TCBNDIOS EQU   TCBFBYT1                                                 05834000
TCBACTIV EQU   TCBFBYT1                                                 05835000
TCBEOTFM EQU   TCBFBYT1                                                 05836000
TCBAFFN  EQU   TCB+274                                                  05837000
TCBCCPVI EQU   TCB+272                                                  05838000
TCBUKYSP EQU   TCB+268                                                  05839000
TCBMODE  EQU   TCBESTAE+3                                               05840000
TCBERTYP EQU   TCBESTAE+2                                               05841000
TCBRV314 EQU   TCBESTRM                                                 05842000
TCBRV313 EQU   TCBESTRM                                                 05843000
TCBRV312 EQU   TCBESTRM                                                 05844000
TCBRV311 EQU   TCBESTRM                                                 05845000
TCBRV310 EQU   TCBESTRM                                                 05846000
TCBRV309 EQU   TCBESTRM                                                 05847000
TCBRV308 EQU   TCBESTRM                                                 05848000
TCBETERM EQU   TCBESTRM                                                 05849000
TCBSCBKY EQU   TCBESTAE                                                 05850000
TCBRTM12 EQU   TCB+260                                                  05851000
TCBTCBID EQU   TCB+256                                                  05852000
TCBRSV96 EQU   TCB+252                                                  05853000
TCBSWA   EQU   TCB+248                                                  05854000
TCBFOEA  EQU   TCBFOE+1                                                 05855000
TCBRSV42 EQU   TCBFOE                                                   05856000
TCBRV306 EQU   TCB+240                                                  05857000
TCBRSV41 EQU   TCB+239                                                  05858000
TCBRSVAA EQU   TCB+237                                                  05859000
TCBABCUR EQU   TCB+236                                                  05860000
TCBTMSAV EQU   TCB+232                                                  05861000
TCBIOTIM EQU   TCB+228                                                  05862000
TCBRTWA  EQU   TCB+224                                                  05863000
TCBBACK  EQU   TCB+220                                                  05864000
TCBTIRB  EQU   TCB+216                                                  05865000
TCBAECB  EQU   TCB+212                                                  05866000
TCBEXT2A EQU   TCBEXT2+1                                                05867000
TCBRSV39 EQU   TCBEXT2                                                  05868000
TCBSTMCT EQU   TCB+207                                                  05869000
TCBSYSCT EQU   TCB+206                                                  05870000
TCBRSV37 EQU   TCB+205                                                  05871000
TCBEXSVC EQU   TCBDAR                                                   05872000
TCBDARMS EQU   TCBDAR                                                   05873000
TCBDARWT EQU   TCBDAR                                                   05874000
TCBDARO  EQU   TCBDAR                                                   05875000
TCBDARMC EQU   TCBDARC                                                  05876000
TCBDARD  EQU   TCBDAR                                                   05877000
TCBDARS  EQU   TCBDAR                                                   05878000
TCBDARP  EQU   TCBDAR                                                   05879000
TCBGTOFM EQU   TCBFLGS7                                                 05880000
TCBADMP  EQU   TCBFLGS7                                                 05881000
TCBRSTSK EQU   TCBFLGS7                                                 05882000
TCBSVCS  EQU   TCBFLGS7                                                 05883000
TCBSTACK EQU   TCBFLGS7                                                 05884000
TCBRSV34 EQU   TCBFLGS7                                                 05885000
TCBRSV33 EQU   TCBFLGS7                                                 05886000
TCBGPECB EQU   TCBFLGS7                                                 05887000
TCBNTJS  EQU   TCBFLGS6                                                 05888000
TCBAPG   EQU   TCBFLGS6                                                 05889000
TCBMIGR  EQU   TCBFLGS6                                                 05890000
TCBRV303 EQU   TCBFLGS6                                                 05891000
TCBSPVLK EQU   TCBFLGS6                                                 05892000
TCBCPU   EQU   TCBFLGS6                                                 05893000
TCBPIE17 EQU   TCBFLGS6                                                 05894000
TCBRV    EQU   TCBFLGS6                                                 05895000
TCBRSV79 EQU   TCBNDSP5                                                 05896000
TCBRSV78 EQU   TCBNDSP5                                                 05897000
TCBRSV77 EQU   TCBNDSP5                                                 05898000
TCBRSV76 EQU   TCBNDSP5                                                 05899000
TCBRSV75 EQU   TCBNDSP5                                                 05900000
TCBRSV74 EQU   TCBNDSP5                                                 05901000
TCBRSV95 EQU   TCBNDSP5                                                 05902000
TCBRSV94 EQU   TCBNDSP5                                                 05903000
TCBRSV93 EQU   TCBNDSP4                                                 05904000
TCBRSV92 EQU   TCBNDSP4                                                 05905000
TCBRSV91 EQU   TCBNDSP4                                                 05906000
TCBRSV90 EQU   TCBNDSP4                                                 05907000
TCBRSV89 EQU   TCBNDSP4                                                 05908000
TCBRSV88 EQU   TCBNDSP4                                                 05909000
TCBRSV87 EQU   TCBNDSP4                                                 05910000
TCBRSV86 EQU   TCBNDSP4                                                 05911000
TCBEXT1A EQU   TCBEXT1+1                                                05912000
TCBRSV32 EQU   TCBEXT1                                                  05913000
TCBEXCPD EQU   TCB+192                                                  05914000
TCBIOBRC EQU   TCB+188                                                  05915000
TCBDDWTC EQU   TCB+186                                                  05916000
TCBDDEXC EQU   TCB+184                                                  05917000
TCBJSCBB EQU   TCBJSCB+1                                                05918000
@NM00092 EQU   TCBRECDE                                                 05919000
TCBREC   EQU   TCBRECDE                                                 05920000
TCBMDIDS EQU   TCB+176                                                  05921000
TCBNDINT EQU   TCBNDSP3                                                 05922000
TCBRSV27 EQU   TCBNDSP3                                                 05923000
TCBRSV26 EQU   TCBNDSP3                                                 05924000
TCBRSV25 EQU   TCBNDSP3                                                 05925000
TCBRSV24 EQU   TCBNDSP3                                                 05926000
TCBSRBND EQU   TCBNDSP3                                                 05927000
TCBRV302 EQU   TCBNDSP3                                                 05928000
TCBLJSND EQU   TCBNDSP3                                                 05929000
TCBABE   EQU   TCBNDSP2                                                 05930000
TCBDSS   EQU   TCBNDSP2                                                 05931000
TCBOWAIT EQU   TCBNDSP2                                                 05932000
TCBIWAIT EQU   TCBNDSP2                                                 05933000
TCBNDTS  EQU   TCBNDSP2                                                 05934000
TCBNDSVC EQU   TCBNDSP2                                                 05935000
TCBSTPP  EQU   TCBNDSP2                                                 05936000
TCBABD   EQU   TCBNDSP2                                                 05937000
TCBRSV22 EQU   TCBNDSP1                                                 05938000
TCBPIEND EQU   TCBNDSP1                                                 05939000
TCBTPSP  EQU   TCBNDSP1                                                 05940000
TCBDDRND EQU   TCBNDSP1                                                 05941000
TCBRSPND EQU   TCBNDSP1                                                 05942000
TCBRSTND EQU   TCBNDSP1                                                 05943000
TCBDARPN EQU   TCBNDSP1                                                 05944000
TCBDARTN EQU   TCBNDSP1                                                 05945000
TCBNDSP0 EQU   TCBNDSP                                                  05946000
TCBUSER  EQU   TCB+168                                                  05947000
TCBTCTB  EQU   TCBTCT+1                                                 05948000
TCBRSV9C EQU   TCBTCTGF                                                 05949000
TCBRSV9B EQU   TCBTCTGF                                                 05950000
TCBRSV9A EQU   TCBTCTGF                                                 05951000
TCBRSV99 EQU   TCBTCTGF                                                 05952000
TCBRSV98 EQU   TCBTCTGF                                                 05953000
TCBRSV97 EQU   TCBTCTGF                                                 05954000
TCBRSV20 EQU   TCBTCTGF                                                 05955000
TCBSMFGF EQU   TCBTCTGF                                                 05956000
TCBSTABB EQU   TCBSTAB+1                                                05957000
TCBSTCUR EQU   TCBNSTAE                                                 05958000
TCBRV301 EQU   TCBNSTAE                                                 05959000
TCBSYNCH EQU   TCBNSTAE                                                 05960000
TCBHALT  EQU   TCBNSTAE                                                 05961000
TCBPPSUP EQU   TCBNSTAE                                                 05962000
TCB33E   EQU   TCBNSTAE                                                 05963000
TCBQUIES EQU   TCBNSTAE                                                 05964000
TCBSTABE EQU   TCBNSTAE                                                 05965000
TCBAQE   EQU   TCB+156                                                  05966000
TCBPQE   EQU   TCB+152                                                  05967000
TCBTSDP  EQU   TCB+151                                                  05968000
TCBTSLP  EQU   TCB+150                                                  05969000
TCBSTPCT EQU   TCB+149                                                  05970000
TCBCPUBN EQU   TCBTSFLG                                                 05971000
TCBDYDSP EQU   TCBTSFLG                                                 05972000
TCBRSV18 EQU   TCBTSFLG                                                 05973000
TCBRSV17 EQU   TCBTSFLG                                                 05974000
TCBTIOTG EQU   TCBTSFLG                                                 05975000
TCBATT   EQU   TCBTSFLG                                                 05976000
TCBSTPPR EQU   TCBTSFLG                                                 05977000
TCBRV300 EQU   TCBTSTSK                                                 05978000
TCBECB   EQU   TCB+144                                                  05979000
TCBIQE   EQU   TCB+140                                                  05980000
TCBLTC   EQU   TCB+136                                                  05981000
TCBNTC   EQU   TCB+128                                                  05982000
TCBJSTCA EQU   TCBJSTCB+1                                               05983000
TCBRSV16 EQU   TCBJSTCB                                                 05984000
TCBTQET  EQU   TCBTME                                                   05985000
TCBTCB   EQU   TCB+116                                                  05986000
TCBFSAB  EQU   TCBFSA+1                                                 05987000
TCBQEL   EQU   TCBFSA                                                   05988000
TCBGRS15 EQU   TCBGRS+60                                                05989000
TCBGRS14 EQU   TCBGRS+56                                                05990000
TCBGRS13 EQU   TCBGRS+52                                                05991000
TCBGRS12 EQU   TCBGRS+48                                                05992000
TCBGRS11 EQU   TCBGRS+44                                                05993000
TCBGRS10 EQU   TCBGRS+40                                                05994000
TCBGRS9  EQU   TCBGRS+36                                                05995000
TCBGRS8  EQU   TCBGRS+32                                                05996000
TCBGRS7  EQU   TCBGRS+28                                                05997000
TCBGRS6  EQU   TCBGRS+24                                                05998000
TCBGRS5  EQU   TCBGRS+20                                                05999000
TCBGRS4  EQU   TCBGRS+16                                                06000000
TCBGRS3  EQU   TCBGRS+12                                                06001000
TCBGRS2  EQU   TCBGRS+8                                                 06002000
TCBGRS1  EQU   TCBGRS+4                                                 06003000
TCBGRS0  EQU   TCBGRS                                                   06004000
TCBJPQB  EQU   TCBJPQ+1                                                 06005000
TCBRSV15 EQU   TCBPURGE                                                 06006000
TCBRSV14 EQU   TCBPURGE                                                 06007000
TCBRSV13 EQU   TCBPURGE                                                 06008000
TCBRSV12 EQU   TCBPURGE                                                 06009000
TCBRSV11 EQU   TCBPURGE                                                 06010000
TCBRSV10 EQU   TCBPURGE                                                 06011000
TCBRSV09 EQU   TCBPURGE                                                 06012000
TCBJPQF  EQU   TCBPURGE                                                 06013000
TCBJLB   EQU   TCB+40                                                   06014000
TCBLLS   EQU   TCB+36                                                   06015000
TCBDSP   EQU   TCB+35                                                   06016000
TCBLMP   EQU   TCB+34                                                   06017000
TCBPNDSP EQU   TCBFLGS5                                                 06018000
TCBFCD1  EQU   TCBFLGS5                                                 06019000
TCBSTP   EQU   TCBFLGS5                                                 06020000
TCBSYS   EQU   TCBFLGS5                                                 06021000
TCBANDSP EQU   TCBFLGS5                                                 06022000
TCBPAGE  EQU   TCBFLGS5                                                 06023000
TCBUXNDF EQU   TCBABWF                                                  06024000
TCBFC    EQU   TCBFLGS5                                                 06025000
TCBONDSP EQU   TCBFLGS4                                                 06026000
TCBMPCND EQU   TCBFLGS4                                                 06027000
TCBMPCVQ EQU   TCBFLGS4                                                 06028000
TCBUXNDV EQU   TCBFLGS4                                                 06029000
TCBHNDSP EQU   TCBFLGS4                                                 06030000
TCBRQENA EQU   TCBFLGS4                                                 06031000
TCBSER   EQU   TCBFLGS4                                                 06032000
TCBNDUMP EQU   TCBFLGS4                                                 06033000
TCBDWSTA EQU   TCBFLGS3                                                 06034000
TCBRSV08 EQU   TCBFLGS3                                                 06035000
TCBRSV07 EQU   TCBFLGS3                                                 06036000
TCBRSV06 EQU   TCBFLGS3                                                 06037000
TCBABGM  EQU   TCBFLGS3                                                 06038000
TCBABTRM EQU   TCBFLGS3                                                 06039000
TCBADINP EQU   TCBFLGS3                                                 06040000
TCBFSM   EQU   TCBFLGS3                                                 06041000
TCBFTS   EQU   TCBFLGS2                                                 06042000
TCBFETXR EQU   TCBFLGS2                                                 06043000
TCBFDSOP EQU   TCBFLGS2                                                 06044000
TCBFJMC  EQU   TCBFLGS2                                                 06045000
TCBFSMC  EQU   TCBFLGS2                                                 06046000
TCBFABOP EQU   TCBFLGS2                                                 06047000
TCBFSTI  EQU   TCBFLGS2                                                 06048000
TCBFOINP EQU   TCBFLGS2                                                 06049000
TCBFX    EQU   TCBFLGS1                                                 06050000
TCBFS    EQU   TCBFLGS1                                                 06051000
TCBFT    EQU   TCBFLGS1                                                 06052000
TCBPDUMP EQU   TCBFLGS1                                                 06053000
TCBNONPR EQU   TCBFLGS1                                                 06054000
TCBFERA  EQU   TCBFLGS1                                                 06055000
TCBFE    EQU   TCBFLGS1                                                 06056000
TCBFA    EQU   TCBFLGS1                                                 06057000
TCBZERO  EQU   TCBPKF                                                   06058000
TCBFLAG  EQU   TCBPKF                                                   06059000
TCBMSSB  EQU   TCBMSS+1                                                 06060000
TCBRSV03 EQU   TCBMSS                                                   06061000
TCBTRNB  EQU   TCBTRN+1                                                 06062000
TCBRSV02 EQU   TCBABF                                                   06063000
TCBOLTEP EQU   TCBABF                                                   06064000
TCBTCP   EQU   TCBABF                                                   06065000
TCBTCPP  EQU   TCBABF                                                   06066000
TCBRSV01 EQU   TCBABF                                                   06067000
TCBGRPH  EQU   TCBABF                                                   06068000
TCBNOCHK EQU   TCBABF                                                   06069000
TCBMOD91 EQU   TCBABF                                                   06070000
TCBCMPC  EQU   TCBCMP+1                                                 06071000
TCBRV318 EQU   TCBCMSG                                                  06072000
TCBRV317 EQU   TCBCIND                                                  06073000
TCBRV316 EQU   TCBCWTO                                                  06074000
TCBCASID EQU   TCBCDBL                                                  06075000
TCBNOCC  EQU   TCBSTCC                                                  06076000
TCBDMPO  EQU   TCBCPP                                                   06077000
TCBCSTEP EQU   TCBCMPF                                                  06078000
TCBCREQ  EQU   TCBCMPF                                                  06079000
TCBTIO   EQU   TCB+12                                                   06080000
TCBDEB   EQU   TCB+8                                                    06081000
TCBPIEA  EQU   TCBPIE+1                                                 06082000
TCBPM    EQU   TCBPMASK                                                 06083000
@NM00091 EQU   TCBPMASK                                                 06084000
TCBFRS6  EQU   TCBFRS+24                                                06085000
TCBFRS4  EQU   TCBFRS+16                                                06086000
TCBFRS2  EQU   TCBFRS+8                                                 06087000
TCBFRS0  EQU   TCBFRS                                                   06088000
SIRBEND  EQU   RBSECT+168                                               06089000
SVRBEND  EQU   RBSECT+168                                               06090000
RBRSV158 EQU   RBRSV150                                                 06091000
RBRSV157 EQU   RBRSV150                                                 06092000
RBRSV156 EQU   RBRSV150                                                 06093000
RBRSV155 EQU   RBRSV150                                                 06094000
RBRSV154 EQU   RBRSV150                                                 06095000
RBRSV153 EQU   RBRSV150                                                 06096000
RBRSV152 EQU   RBRSV150                                                 06097000
RBRSV151 EQU   RBRSV150                                                 06098000
RBRSV149 EQU   RBSECT+166                                               06099000
RBRSV148 EQU   RBSECT+164                                               06100000
RBSCBB   EQU   RBSECT+144                                               06101000
TIRBEND  EQU   @NM00089+8                                               06102000
PRBEND   EQU   @NM00089+8                                               06103000
RBRSV146 EQU   RBRSV138                                                 06104000
RBRSV145 EQU   RBRSV138                                                 06105000
RBRSV144 EQU   RBRSV138                                                 06106000
RBRSV143 EQU   RBRSV138                                                 06107000
RBRSV142 EQU   RBRSV138                                                 06108000
RBRSV141 EQU   RBRSV138                                                 06109000
RBRSV140 EQU   RBRSV138                                                 06110000
RBRSV139 EQU   RBRSV138                                                 06111000
RBRSV137 EQU   @NM00089+6                                               06112000
RBRSV136 EQU   @NM00089+4                                               06113000
RBRSV135 EQU   @NM00089                                                 06114000
@NM00088 EQU   RBSECT+32                                                06115000
@NM00087 EQU   @NM00085+1                                               06116000
@NM00086 EQU   @NM00085                                                 06117000
RBPGMQ1  EQU   RBPGMQ+1                                                 06118000
@NM00084 EQU   RBPGMQ                                                   06119000
@NM00083 EQU   RBSECT+16                                                06120000
@NM00082 EQU   @NM00078                                                 06121000
@NM00081 EQU   @NM00078                                                 06122000
RBIQETP  EQU   @NM00078                                                 06123000
RBUSIQE  EQU   RBETXR                                                   06124000
RBATTN   EQU   @NM00078                                                 06125000
@NM00080 EQU   @NM00078                                                 06126000
@NM00079 EQU   @NM00078                                                 06127000
RBPMSVRB EQU   @NM00076                                                 06128000
RBATNXIT EQU   @NM00076                                                 06129000
@NM00077 EQU   @NM00076                                                 06130000
RBWAITP  EQU   @NM00076                                                 06131000
RBFNSVRB EQU   RBTRSVRB                                                 06132000
RBSIZE   EQU   RBSECT+8                                                 06133000
RBABOPSW EQU   RBSECT+4                                                 06134000
RBPPSAV1 EQU   RBPPSAV+1                                                06135000
@NM00074 EQU   RBPPSAV                                                  06136000
RBPRFXND EQU   RBPREFIX+64                                              06137000
RBINTCOD EQU   RBINTCDA+1                                               06138000
RBINLNTH EQU   RBINTCDA                                                 06139000
RBWCSA   EQU   RBPREFIX+60                                              06140000
RBRSV004 EQU   RBPREFIX+57                                              06141000
RBSSSYN  EQU   RBFLAGS1                                                 06142000
RBSCB    EQU   RBFLAGS1                                                 06143000
RBLONGWT EQU   RBFLAGS1                                                 06144000
RBASIR   EQU   RBFLAGS1                                                 06145000
RBRSV159 EQU   RBFLAGS1                                                 06146000
RBABEND  EQU   RBFLAGS1                                                 06147000
RBXWAIT  EQU   RBFLAGS1                                                 06148000
RBSLOCK  EQU   RBFLAGS1                                                 06149000
RBRTRAN  EQU   RBRTPSW2+4                                               06150000
RBRTINCD EQU   RBRTICIL+2                                               06151000
RBRTILC  EQU   RBRTICIL+1                                               06152000
RBRSV160 EQU   RBRTICIL                                                 06153000
RBRTPSW1 EQU   RBRTOPSW                                                 06154000
RBRSV062 EQU   RBRSV054                                                 06155000
RBRSV061 EQU   RBRSV054                                                 06156000
RBRSV060 EQU   RBRSV054                                                 06157000
RBRSV059 EQU   RBRSV054                                                 06158000
RBRSV058 EQU   RBRSV054                                                 06159000
RBRSV057 EQU   RBRSV054                                                 06160000
RBRSV056 EQU   RBRSV054                                                 06161000
RBRSV055 EQU   RBRSV054                                                 06162000
RBRSV053 EQU   RBPREFIX+38                                              06163000
RBRSV052 EQU   RBPREFIX+36                                              06164000
RBRSV051 EQU   RBPREFIX+32                                              06165000
RBPRFXST EQU   RBPREFIX+32                                              06166000
RBRSV050 EQU   RBPREFIX+28                                              06167000
RBRSV049 EQU   RBRSV041                                                 06168000
RBRSV048 EQU   RBRSV041                                                 06169000
RBRSV047 EQU   RBRSV041                                                 06170000
RBRSV046 EQU   RBRSV041                                                 06171000
RBRSV045 EQU   RBRSV041                                                 06172000
RBRSV044 EQU   RBRSV041                                                 06173000
RBRSV043 EQU   RBRSV041                                                 06174000
RBRSV042 EQU   RBRSV041                                                 06175000
RBRSV040 EQU   RBPREFIX+26                                              06176000
RBRSV039 EQU   RBPREFIX+24                                              06177000
RBRSV038 EQU   RBPREFIX+20                                              06178000
RBRSV037 EQU   RBPREFIX+16                                              06179000
RBRSV036 EQU   RBRSV028                                                 06180000
RBRSV035 EQU   RBRSV028                                                 06181000
RBRSV034 EQU   RBRSV028                                                 06182000
RBRSV033 EQU   RBRSV028                                                 06183000
RBRSV032 EQU   RBRSV028                                                 06184000
RBRSV031 EQU   RBRSV028                                                 06185000
RBRSV030 EQU   RBRSV028                                                 06186000
RBRSV029 EQU   RBRSV028                                                 06187000
RBRSV027 EQU   RBRSV019                                                 06188000
RBRSV026 EQU   RBRSV019                                                 06189000
RBRSV025 EQU   RBRSV019                                                 06190000
RBRSV024 EQU   RBRSV019                                                 06191000
RBRSV023 EQU   RBRSV019                                                 06192000
RBRSV022 EQU   RBRSV019                                                 06193000
RBRSV021 EQU   RBRSV019                                                 06194000
RBRSV020 EQU   RBRSV019                                                 06195000
RBRSV018 EQU   RBPREFIX+13                                              06196000
RBRSV017 EQU   RBPREFIX+12                                              06197000
RBSRV016 EQU   RBPREFIX+11                                              06198000
RBRSV015 EQU   RBPREFIX+10                                              06199000
RBRSV014 EQU   RBPREFIX+8                                               06200000
RBRSV013 EQU   RBPREFIX+4                                               06201000
RBRSV012 EQU   RBPREFIX                                                 06202000
XRBREG15 EQU   RBGRS15                                                  06203000
XRBREG14 EQU   RBGRS14                                                  06204000
XRBREG13 EQU   RBGRS13                                                  06205000
XRBREG12 EQU   RBGRS12                                                  06206000
XRBREG11 EQU   RBGRS11                                                  06207000
XRBREG10 EQU   RBGRS10                                                  06208000
XRBREG9  EQU   RBGRS9                                                   06209000
XRBREG8  EQU   RBGRS8                                                   06210000
XRBREG7  EQU   RBGRS7                                                   06211000
XRBREG6  EQU   RBGRS6                                                   06212000
XRBREG5  EQU   RBGRS5                                                   06213000
XRBREG4  EQU   RBGRS4                                                   06214000
XRBREG3  EQU   RBGRS3                                                   06215000
XRBREG2  EQU   RBGRS2                                                   06216000
XRBREG1  EQU   RBGRS1                                                   06217000
XRBREG0  EQU   RBGRS0                                                   06218000
XRBLNKA  EQU   RBLINKB                                                  06219000
XRBWT    EQU   RBWCF                                                    06220000
@NM00073 EQU   RBBASIC+24                                               06221000
RBOPSWPS EQU   RBOPSWB2                                                 06222000
@NM00072 EQU   RBOPSWB2                                                 06223000
@NM00071 EQU   XRBPSW                                                   06224000
@NM00070 EQU   RBBASIC+12                                               06225000
XRBWAIT  EQU   RBECBWT                                                  06226000
XRBFRRB  EQU   RBFDYN                                                   06227000
@NM00069 EQU   XSTAB2                                                   06228000
XRBACTV  EQU   RBFACTV                                                  06229000
XRBTCBP  EQU   RBTCBNXT                                                 06230000
@NM00068 EQU   XSTAB1                                                   06231000
XRBCKPT  EQU   RBFTCKPT                                                 06232000
@NM00067 EQU   XSTAB1                                                   06233000
@NM00066 EQU   RBBASIC+8                                                06234000
@NM00065 EQU   RBEXRTNM+1                                               06235000
RBTMIND3 EQU   RBTMFLD                                                  06236000
RBTMIND2 EQU   RBTMFLD                                                  06237000
RBTMCMP  EQU   RBTMFLD                                                  06238000
RBWLIM   EQU   RBTMFLD                                                  06239000
RBRSV005 EQU   RBTMFLD                                                  06240000
RBTMTOD  EQU   RBTMFLD                                                  06241000
RBTMQUE  EQU   RBTMFLD                                                  06242000
@NM00064 EQU   RBPRFX                                                   06243000
ESTARSVI EQU   ESTAFGRS+1                                               06244000
@NM00063 EQU   ESTAFLG2                                                 06245000
ESTABRNT EQU   ESTAFLG2                                                 06246000
@NM00062 EQU   ESTAFLG2                                                 06247000
ESTAEREC EQU   ESTAFLG2                                                 06248000
ESTATERM EQU   ESTAFLG2                                                 06249000
@NM00061 EQU   ESTAFLG2                                                 06250000
ESTAOWNR EQU   ESTA+8                                                   06251000
ESTAPARM EQU   ESTA+4                                                   06252000
ESTAEXIT EQU   ESTAEXT+1                                                06253000
ESTAHALT EQU   ESTAIO                                                   06254000
ESTANOIO EQU   ESTAIO                                                   06255000
ESTASYNC EQU   ESTAFLG1                                                 06256000
@NM00060 EQU   ESTAFLG1                                                 06257000
ESTAESTA EQU   ESTAFLG1                                                 06258000
@NM00059 EQU   ESTAFLG1                                                 06259000
ESTASTAR EQU   ESTAFLG1                                                 06260000
ESTASTAI EQU   ESTAFLG1                                                 06261000
MSSPARE  EQU   BASES01+48                                               06262000
MSUCBAL  EQU   BASES01+44                                               06263000
MSUCBPR  EQU   BASES01+40                                               06264000
MSBOBECB EQU   BASES01+36                                               06265000
MSSJQ    EQU   BASES01+32                                               06266000
MSECB    EQU   BASES01+28                                               06267000
MSPBP    EQU   BASES01+24                                               06268000
MSERM    EQU   BASES01+22                                               06269000
MSPASS   EQU   BASES01+14                                               06270000
MSVRB    EQU   BASES01+6                                                06271000
MSQHR    EQU   MSFHF                                                    06272000
@NM00058 EQU   MSFHF                                                    06273000
MSPSDT   EQU   MSFHF                                                    06274000
MSREPLYB EQU   MSFHF                                                    06275000
MSFAX    EQU   MSFHF                                                    06276000
MSTTT    EQU   MSFHF                                                    06277000
MSCSD    EQU   MSFHF                                                    06278000
MSNMF    EQU   MSFHF                                                    06279000
MSJNF    EQU   MSSSA                                                    06280000
MSYOUT   EQU   MSNWP                                                    06281000
MSNRP    EQU   MSSSA                                                    06282000
MSSRDR   EQU   MSREOF                                                   06283000
MSWRLOG  EQU   MSSSA                                                    06284000
MSNUPSW  EQU   MSSSA                                                    06285000
MSWRPEN  EQU   MSSSA                                                    06286000
MSSSSIPL EQU   MSINLSW                                                  06287000
MSSUM    EQU   MSECBFL                                                  06288000
MSMCR    EQU   MSECBFL                                                  06289000
MSYSOUT  EQU   MSECBFL                                                  06290000
MSYSIN   EQU   MSECBFL                                                  06291000
MSATTN   EQU   MSECBFL                                                  06292000
MSWTL    EQU   MSECBFL                                                  06293000
MSWTO    EQU   MSECBFL                                                  06294000
MSEXT    EQU   MSECBFL                                                  06295000
MSCCS    EQU   MSPFG                                                    06296000
MSBSP    EQU   MSPFG                                                    06297000
MSSYT    EQU   MSPFG                                                    06298000
MSSYN    EQU   MSPFG                                                    06299000
MSICR    EQU   MSPFG                                                    06300000
MSCMC    EQU   MSPFG                                                    06301000
MSPNB    EQU   MSPFG                                                    06302000
MSDATE   EQU   MSPFG                                                    06303000
@NM00057 EQU   MSBTN                                                    06304000
MSTN     EQU   MSBTN                                                    06305000
@NM00056 EQU   MSBTN                                                    06306000
@NM00055 EQU   MSBTN                                                    06307000
MSSO     EQU   MSBTN                                                    06308000
MSROLFLG EQU   MSBTN                                                    06309000
MSCANFLG EQU   MSBTN                                                    06310000
MSCONFLG EQU   MSBTN                                                    06311000
MSPNIP   EQU   MSNTAL                                                   06312000
MSQNIP   EQU   MSNTAL                                                   06313000
MSCURE34 EQU   MSNTAL                                                   06314000
@NM00054 EQU   MSNTAL                                                   06315000
@NM00053 EQU   MSNTAL                                                   06316000
@NM00052 EQU   MSNTAL                                                   06317000
@NM00051 EQU   MSNTAL                                                   06318000
MSNIP    EQU   MSNTAL                                                   06319000
@NM00050 EQU   MS1BASEX+40                                              06320000
@NM00049 EQU   MS1BASEX+20                                              06321000
@NM00048 EQU   MS1BASEX                                                 06322000
@NM00047 EQU   BASE+128                                                 06323000
MSLGJSCB EQU   BASE+124                                                 06324000
@NM00046 EQU   MSSTRTSW                                                 06325000
MSSTRTP  EQU   MSSTRTSW                                                 06326000
MSSTRTW  EQU   MSSTRTSW                                                 06327000
@NM00045 EQU   MSWTRSW                                                  06328000
MSWTRP   EQU   MSWTRSW                                                  06329000
MSWTRW   EQU   MSWTRSW                                                  06330000
@NM00044 EQU   MSWLOGSW                                                 06331000
MSWLOGP  EQU   MSWLOGSW                                                 06332000
MSWLOGW  EQU   MSWLOGSW                                                 06333000
@NM00043 EQU   MSCLOSSW                                                 06334000
MSCLOSP  EQU   MSCLOSSW                                                 06335000
MSCLOSW  EQU   MSCLOSSW                                                 06336000
MSLOGLMT EQU   @NM00042+1                                               06337000
MSLOGCLS EQU   @NM00042                                                 06338000
BAASCB   EQU   BASE+100                                                 06339000
MSSMFPRM EQU   BASE+96                                                  06340000
MSCOMMND EQU   BASE+92                                                  06341000
BASP12   EQU   BASE+90                                                  06342000
BASTCNT  EQU   BASE+88                                                  06343000
BASESCT  EQU   BASE+86                                                  06344000
BAJNCNT  EQU   BASE+84                                                  06345000
BASUBECB EQU   BASE+80                                                  06346000
BALOGCOM EQU   BASE+76                                                  06347000
BADACNT  EQU   BASE+74                                                  06348000
BATACNT  EQU   BASE+72                                                  06349000
BAJBNR   EQU   BASE+64                                                  06350000
BASP11   EQU   BASE+62                                                  06351000
BALCCNT  EQU   BASE+61                                                  06352000
BADUMPID EQU   BASE+60                                                  06353000
BABCMAX  EQU   BASE+58                                                  06354000
BAMONTR2 EQU   BASE+57                                                  06355000
@NM00041 EQU   BAMONITR                                                 06356000
BAMACTVE EQU   BAMONITR                                                 06357000
@NM00040 EQU   BAMONITR                                                 06358000
@NM00039 EQU   BAMONITR                                                 06359000
@NM00038 EQU   BAMONITR                                                 06360000
@NM00037 EQU   BAMONITR                                                 06361000
BASPACE  EQU   BAMONITR                                                 06362000
BADSN    EQU   BAMONITR                                                 06363000
BADSO    EQU   BASE+52                                                  06364000
BALOGECB EQU   BASE+48                                                  06365000
@NM00036 EQU   BASPBYTE                                                 06366000
@NM00035 EQU   BASPBYTE                                                 06367000
@NM00034 EQU   BASPBYTE                                                 06368000
@NM00033 EQU   BASPBYTE                                                 06369000
@NM00032 EQU   BASPBYTE                                                 06370000
BAMASCH  EQU   BASPBYTE                                                 06371000
BATRACE  EQU   BASPBYTE                                                 06372000
BAMSSTAR EQU   BASPBYTE                                                 06373000
@NM00031 EQU   MSLOGST                                                  06374000
@NM00030 EQU   MSLOGST                                                  06375000
MSLOGSTA EQU   MSLOGST                                                  06376000
MSLOGIPL EQU   MSLOGST                                                  06377000
MSLOGDAR EQU   MSLOGST                                                  06378000
MSLOGCOM EQU   MSLOGST                                                  06379000
MSLOGTHD EQU   MSLOGST                                                  06380000
MSLOGENQ EQU   MSLOGST                                                  06381000
BAMIPAR2 EQU   BASE+44                                                  06382000
BAMINPAR EQU   BASE+42                                                  06383000
BAPKES   EQU   BASE+40                                                  06384000
BAICTR   EQU   BASE+38                                                  06385000
@NM00029 EQU   BASE+37                                                  06386000
BADSET   EQU   BARSW                                                    06387000
BANOSET  EQU   BARSW                                                    06388000
BAMIDNT  EQU   BARSW                                                    06389000
BAHR     EQU   BARSW                                                    06390000
BAVU     EQU   BARSW                                                    06391000
BAINTSET EQU   BARSW                                                    06392000
MSTODWTO EQU   BARSW                                                    06393000
BAIN     EQU   BARSW                                                    06394000
BACV     EQU   BASE+32                                                  06395000
@NM00028 EQU   BALOG                                                    06396000
@NM00027 EQU   BALOG                                                    06397000
@NM00026 EQU   BALOG                                                    06398000
@NM00025 EQU   BALOG                                                    06399000
@NM00024 EQU   BALOG                                                    06400000
@NM00023 EQU   BALOG                                                    06401000
@NM00022 EQU   BALOG                                                    06402000
MSLOGSVC EQU   BALGSTAT                                                 06403000
BAPRC    EQU   BASE+20                                                  06404000
BAQ      EQU   BASE+16                                                  06405000
BAIPLCC  EQU   @NM00020+2                                               06406000
@NM00021 EQU   @NM00020                                                 06407000
BAIPL    EQU   BASE+12                                                  06408000
BALAD    EQU   BASE+8                                                   06409000
BATRM    EQU   BASE+4                                                   06410000
BACHN    EQU   BASE                                                     06411000
@NM00019 EQU   FRRSFLGS+1                                               06412000
@NM00018 EQU   FRRSFLG1                                                 06413000
FRRSNEST EQU   FRRSFLG1                                                 06414000
FRRSRCUR EQU   FRRSFLG1                                                 06415000
FRRSENTS EQU   FRRS+84                                                  06416000
FRRSRTMW EQU   FRRS+16                                                  06417000
UCMPRSV2 EQU   UCMPEXTA+20                                              06418000
UCMPRSV1 EQU   UCMPDM1+8                                                06419000
UCMPNMCC EQU   UCMPDM1+4                                                06420000
UCMPWQE  EQU   UCMPDM1                                                  06421000
UCMPUCMP EQU   UCMPEXTA                                                 06422000
UCMFRSV3 EQU   UCMFEXTA+20                                              06423000
UCMF80WQ EQU   UCMFEXTA+18                                              06424000
UCMF60WQ EQU   UCMFEXTA+16                                              06425000
UCMFRSV2 EQU   UCMFMGFS+4                                               06426000
UCMFRSV1 EQU   UCMFMGFS+2                                               06427000
UCMFFLG2 EQU   UCMFMGFS+1                                               06428000
UCMFBR07 EQU   UCMFFLG1                                                 06429000
UCMFBR06 EQU   UCMFFLG1                                                 06430000
UCMFBR05 EQU   UCMFFLG1                                                 06431000
UCMFBR04 EQU   UCMFFLG1                                                 06432000
UCMFBR03 EQU   UCMFFLG1                                                 06433000
UCMFMSGA EQU   UCMFFLG1                                                 06434000
UCMFMSGE EQU   UCMFFLG1                                                 06435000
UCMFUCMF EQU   UCMFEXTA                                                 06436000
UCMRCTA  EQU   UCMRCT+1                                                 06437000
UCMRSV31 EQU   UCMSDS5                                                  06438000
UCMSDS5G EQU   UCMSDS5                                                  06439000
UCMSDS5F EQU   UCMSDS5                                                  06440000
UCMRSV30 EQU   UCMSDS5                                                  06441000
UCMRSV29 EQU   UCMSDS5                                                  06442000
UCMSDS5C EQU   UCMSDS5                                                  06443000
UCMSDS5B EQU   UCMSDS5                                                  06444000
UCMSDS5A EQU   UCMSDS5                                                  06445000
UCMMLAST EQU   UCMLIST+64                                               06446000
UCMVHRSN EQU   UCMDEVC                                                  06447000
UCMDEVG  EQU   UCMDEVC                                                  06448000
UCMDEVF  EQU   UCMDEVC                                                  06449000
UCMDEVE  EQU   UCMDEVC                                                  06450000
UCMDEVD  EQU   UCMDEVC                                                  06451000
UCMDEVCC EQU   UCMDEVC                                                  06452000
UCMDEVB  EQU   UCMDEVC                                                  06453000
UCMDEVA  EQU   UCMDEVC                                                  06454000
UCMXOR   EQU   UCMLIST+62                                               06455000
UCMMSG2  EQU   UCMMSG+1                                                 06456000
UCMRSV27 EQU   UCMMSG1                                                  06457000
UCMRSV26 EQU   UCMMSG1                                                  06458000
UCMMSGF  EQU   UCMMSG1                                                  06459000
UCMMSGE  EQU   UCMMSG1                                                  06460000
UCMMSGD  EQU   UCMMSG1                                                  06461000
UCMMSGC  EQU   UCMMSG1                                                  06462000
UCMMSGB  EQU   UCMMSG1                                                  06463000
UCMMSGA  EQU   UCMMSG1                                                  06464000
UCMCOMPC EQU   UCMLIST+56                                               06465000
UCMWLAST EQU   UCMLIST+52                                               06466000
UCMOAOEN EQU   UCMLIST+48                                               06467000
UCMALTEN EQU   UCMLIST+44                                               06468000
UCMRV007 EQU   UCMDISP2                                                 06469000
UCMRV006 EQU   UCMDISP2                                                 06470000
UCMRV005 EQU   UCMDISP2                                                 06471000
UCMRV004 EQU   UCMDISP2                                                 06472000
UCMRV003 EQU   UCMDISP2                                                 06473000
UCMDISPK EQU   UCMDISP2                                                 06474000
UCMDISPJ EQU   UCMDISP2                                                 06475000
UCMDISPI EQU   UCMDISP2                                                 06476000
UCMDISPH EQU   UCMDISP1                                                 06477000
UCMDISPG EQU   UCMDISP1                                                 06478000
UCMDISPF EQU   UCMDISP1                                                 06479000
UCMDISPE EQU   UCMDISP1                                                 06480000
UCMDISPD EQU   UCMDISP1                                                 06481000
UCMDISPC EQU   UCMDISP1                                                 06482000
UCMDISPB EQU   UCMDISP1                                                 06483000
UCMDISPA EQU   UCMDISP1                                                 06484000
UCMAUTHB EQU   UCMAUTH+1                                                06485000
UCMRSV23 EQU   UCMAUTHA                                                 06486000
UCMRSV22 EQU   UCMAUTHA                                                 06487000
UCMRSV21 EQU   UCMAUTHA                                                 06488000
UCMRSV20 EQU   UCMAUTHA                                                 06489000
UCMRSV19 EQU   UCMAUTHA                                                 06490000
UCMAUTH3 EQU   UCMAUTHA                                                 06491000
UCMAUTH2 EQU   UCMAUTHA                                                 06492000
UCMAUTH1 EQU   UCMAUTHA                                                 06493000
UCMOUTQ  EQU   UCMLIST+36                                               06494000
UCMRSV18 EQU   UCMLIST+34                                               06495000
UCMRTCD  EQU   UCMLIST+32                                               06496000
UCMXB    EQU   UCMLIST+28                                               06497000
@NM00017 EQU   UCMXA+1                                                  06498000
UCMID    EQU   UCMXA                                                    06499000
UCMRSV17 EQU   UCMATR                                                   06500000
UCMRSV16 EQU   UCMATR                                                   06501000
UCMAT04  EQU   UCMATR                                                   06502000
UCMLF    EQU   UCMATR                                                   06503000
UCMUF    EQU   UCMATR                                                   06504000
UCMXF    EQU   UCMATR                                                   06505000
UCMIF    EQU   UCMATR                                                   06506000
UCMOF    EQU   UCMATR                                                   06507000
UCMTC    EQU   UCMSTS                                                   06508000
UCMTD    EQU   UCMSTS                                                   06509000
UCMTB    EQU   UCMSTS                                                   06510000
UCMTA    EQU   UCMSTS                                                   06511000
UCMCF    EQU   UCMSTS                                                   06512000
UCMBF    EQU   UCMSTS                                                   06513000
UCMPF    EQU   UCMSTS                                                   06514000
UCMAF    EQU   UCMSTS                                                   06515000
UCMNAME  EQU   UCMLIST+16                                               06516000
UCMUCB   EQU   UCMLIST+12                                               06517000
UCMDCB   EQU   UCMLIST+8                                                06518000
UCMSBR   EQU   UCMLIST+4                                                06519000
UCMECB   EQU   UCMLIST                                                  06520000
UCMTPSAV EQU   UCMEXIT+208                                              06521000
UCMXTSAV EQU   UCMEXIT+136                                              06522000
UCMDESCD EQU   UCMEXIT+132                                              06523000
UCMROUTC EQU   UCMEXIT+128                                              06524000
UCMMSTXT EQU   UCMEXIT                                                  06525000
UCMDECBA EQU   UCMEIL+20                                                06526000
UCMOECBA EQU   UCMEIL+16                                                06527000
UCMAECBA EQU   UCMEIL+12                                                06528000
UCMXECBA EQU   UCMEIL+8                                                 06529000
UCMNIPTR EQU   UCMEIL+4                                                 06530000
UCMRSV15 EQU   UCMEIL+3                                                 06531000
UCMRTCT  EQU   UCMEIL+2                                                 06532000
@NM00016 EQU   UCMEIL                                                   06533000
UCMRSV60 EQU   UCM+302                                                  06534000
UCMRSV59 EQU   UCMRSV51                                                 06535000
UCMRSV58 EQU   UCMRSV51                                                 06536000
UCMRSV57 EQU   UCMRSV51                                                 06537000
UCMRSV56 EQU   UCMRSV51                                                 06538000
UCMRSV55 EQU   UCMRSV51                                                 06539000
UCMRSV54 EQU   UCMRSV51                                                 06540000
UCMRSV53 EQU   UCMRSV51                                                 06541000
UCMRSV52 EQU   UCMRSV51                                                 06542000
UCMRSV50 EQU   UCMRSV42                                                 06543000
UCMRSV49 EQU   UCMRSV42                                                 06544000
UCMRSV48 EQU   UCMRSV42                                                 06545000
UCMRSV47 EQU   UCMRSV42                                                 06546000
UCMRSV46 EQU   UCMRSV42                                                 06547000
UCMRSV45 EQU   UCMRSV42                                                 06548000
UCMRSV44 EQU   UCMRSV42                                                 06549000
UCMRSV43 EQU   UCMRSV42                                                 06550000
UCMSWCH  EQU   UCM+284                                                  06551000
UCMOECBH EQU   UCM+264                                                  06552000
UCMWECBH EQU   UCM+256                                                  06553000
UCMMBEND EQU   UCM+252                                                  06554000
UCMRSV61 EQU   UCM+248                                                  06555000
UCMRP2AD EQU   UCM+244                                                  06556000
UCMCRAAD EQU   UCM+240                                                  06557000
UCMRV001 EQU   UCM+237                                                  06558000
UCMMBPTR EQU   UCM+232                                                  06559000
UCMMQNXT EQU   UCM+228                                                  06560000
UCMMQEND EQU   UCM+224                                                  06561000
UCMMQPTR EQU   UCM+220                                                  06562000
UCMTRECB EQU   UCM+216                                                  06563000
UCMMNECB EQU   UCM+212                                                  06564000
UCMMNTR  EQU   UCM+208                                                  06565000
UCMR9SV  EQU   UCM+204                                                  06566000
UCMSAVE4 EQU   UCM+140                                                  06567000
UCMSAVE3 EQU   UCM+84                                                   06568000
UCMVEL   EQU   UCMVDATA+8                                               06569000
UCMVEZ   EQU   UCMVDATA+4                                               06570000
UCMINCR  EQU   UCM+71                                                   06571000
UCMMODEL EQU   UCM+70                                                   06572000
UCMCORE  EQU   UCM+69                                                   06573000
UCMFIX   EQU   UCMMODE                                                  06574000
UCMMCS   EQU   UCMMODE                                                  06575000
UCMOGCE  EQU   UCMMODE                                                  06576000
UCMAMFA  EQU   UCMMODE                                                  06577000
UCMRSV14 EQU   UCMMODE                                                  06578000
UCMTPUTA EQU   UCMMODE                                                  06579000
UCMNOCON EQU   UCMMODE                                                  06580000
UCMRSV11 EQU   UCMMODE                                                  06581000
UCMWQECB EQU   UCM+52                                                   06582000
UCMRQECB EQU   UCM+48                                                   06583000
@NM00015 EQU   UCMRPYI                                                  06584000
UCMARECB EQU   UCM+16                                                   06585000
UCMLECB  EQU   UCMDECB                                                  06586000
UCMXECB  EQU   UCM                                                      06587000
UCMGMCNT EQU   UCMPRFX+158                                              06588000
UCMSDS2  EQU   UCMPRFX+157                                              06589000
UCMRSV09 EQU   UCMSDS1                                                  06590000
UCMRSV08 EQU   UCMSDS1                                                  06591000
UCMRSV07 EQU   UCMSDS1                                                  06592000
UCMRSV06 EQU   UCMSDS1                                                  06593000
UCMRSV05 EQU   UCMSDS1                                                  06594000
UCMRSV04 EQU   UCMSDS1                                                  06595000
UCMSDS1B EQU   UCMSDS1                                                  06596000
UCMSDS1A EQU   UCMSDS1                                                  06597000
UCMDTINT EQU   UCMPRFX+152                                              06598000
UCMLOGAD EQU   UCMPRFX+148                                              06599000
UCMNPECB EQU   UCMPRFX+144                                              06600000
UCMTPPTR EQU   UCMPRFX+140                                              06601000
UCMDOMRT EQU   UCMPRFX+136                                              06602000
UCMRUTCK EQU   UCMPRFX+132                                              06603000
UCMQRTN  EQU   UCMPRFX+128                                              06604000
UCM6WD   EQU   UCMXSA+20                                                06605000
UCM5WD   EQU   UCMXSA+16                                                06606000
UCM4WD   EQU   UCMXSA+12                                                06607000
UCM3WD   EQU   UCMXSA+8                                                 06608000
UCM2WD   EQU   UCMXSA+4                                                 06609000
UCM1WD   EQU   UCMXSA                                                   06610000
UCMRSV03 EQU   UCMPRFX+102                                              06611000
UCMHRDRT EQU   UCMPRFX+100                                              06612000
UCMUEXIT EQU   UCMPRFX+97                                               06613000
UCMXCT   EQU   UCMPRFX+96                                               06614000
UCMHCUCM EQU   UCMPRFX+92                                               06615000
UCMRSV02 EQU   UCMSFLG2                                                 06616000
UCMSYSN  EQU   UCMSFLG2                                                 06617000
UCMSYSM  EQU   UCMSFLG2                                                 06618000
UCMSYSL  EQU   UCMSFLG2                                                 06619000
UCMSYSK  EQU   UCMSFLG2                                                 06620000
UCMSYSJ  EQU   UCMSFLG2                                                 06621000
UCMRSV35 EQU   UCMSFLG1                                                 06622000
UCMSYSF  EQU   UCMSFLG1                                                 06623000
UCMSYSE  EQU   UCMSFLG1                                                 06624000
UCMSYSD  EQU   UCMSFLG1                                                 06625000
UCMSYSC  EQU   UCMSFLG1                                                 06626000
UCMSYSB  EQU   UCMSFLG1                                                 06627000
UCMRSV01 EQU   UCMSFLG1                                                 06628000
UCMWTOX  EQU   UCMPRFX+80                                               06629000
UCMDOME  EQU   UCMPRFX+76                                               06630000
UCMSVR0  EQU   UCMSAVE0+68                                              06631000
UCMSVQ0  EQU   UCMSAVE0+64                                              06632000
UCMSVP0  EQU   UCMSAVE0+60                                              06633000
UCMSVO0  EQU   UCMSAVE0+56                                              06634000
UCMSVN0  EQU   UCMSAVE0+52                                              06635000
UCMSVM0  EQU   UCMSAVE0+48                                              06636000
UCMSVL0  EQU   UCMSAVE0+44                                              06637000
UCMSVK0  EQU   UCMSAVE0+40                                              06638000
UCMSVJ0  EQU   UCMSAVE0+36                                              06639000
UCMSVI0  EQU   UCMSAVE0+32                                              06640000
UCMSVH0  EQU   UCMSAVE0+28                                              06641000
UCMSVG0  EQU   UCMSAVE0+24                                              06642000
UCMSVF0  EQU   UCMSAVE0+20                                              06643000
UCMSVE0  EQU   UCMSAVE0+16                                              06644000
UCMSVD0  EQU   UCMSAVE0+12                                              06645000
UCMSVC0  EQU   UCMSAVE0+8                                               06646000
UCMSVB0  EQU   UCMSAVE0+4                                               06647000
UCMSVA0  EQU   UCMSAVE0                                                 06648000
UCMMCENT EQU   UCMPRFX                                                  06649000
UCM2STAA EQU   UCM2STA+1                                                06650000
UCMRV008 EQU   UCM2SFLG                                                 06651000
UCMRSV34 EQU   UCM2SFLG                                                 06652000
UCMRSV33 EQU   UCM2SFLG                                                 06653000
UCM2WTOI EQU   UCM2SFLG                                                 06654000
UCM2DSTR EQU   UCM2SFLG                                                 06655000
UCM2DTAK EQU   UCM2SFLG                                                 06656000
UCM2SENT EQU   UCM2SFLG                                                 06657000
UCM2SDWA EQU   UCM2SFLG                                                 06658000
UCM2PST  EQU   UCM2EXT+4                                                06659000
UCM2RID  EQU   UCM2EXT+2                                                06660000
UCM2WID  EQU   UCM2EXT                                                  06661000
WPLMLTXT EQU   WPLML+4                                                  06662000
WPLMLLT2 EQU   WPLMLLTF+1                                               06663000
WPLRSV24 EQU   WPLMLLT1                                                 06664000
WPLRSV23 EQU   WPLMLLT1                                                 06665000
WPLRSV22 EQU   WPLMLLT1                                                 06666000
WPLRSV21 EQU   WPLMLLT1                                                 06667000
WPLMLLTD EQU   WPLMLLT1                                                 06668000
WPLMLLTC EQU   WPLMLLT1                                                 06669000
WPLMLLTB EQU   WPLMLLT1                                                 06670000
WPLMLLTA EQU   WPLMLLT1                                                 06671000
WPLML0   EQU   WPLML                                                    06672000
WPLLTF2  EQU   WPLLTF+1                                                 06673000
WPLRSV20 EQU   WPLLTF1                                                  06674000
WPLRSV19 EQU   WPLLTF1                                                  06675000
WPLRSV18 EQU   WPLLTF1                                                  06676000
WPLRSV17 EQU   WPLLTF1                                                  06677000
WPLLTFD  EQU   WPLLTF1                                                  06678000
WPLLTFC  EQU   WPLLTF1                                                  06679000
WPLLTFB  EQU   WPLLTF1                                                  06680000
WPLLTFA  EQU   WPLLTF1                                                  06681000
WPLRSV32 EQU   WPLMSGT2                                                 06682000
WPLRSV31 EQU   WPLMSGT2                                                 06683000
WPLRSV30 EQU   WPLMSGT2                                                 06684000
WPLRSV29 EQU   WPLMSGT2                                                 06685000
WPLRSV28 EQU   WPLMSGT2                                                 06686000
WPLRSV27 EQU   WPLMSGT2                                                 06687000
WPLRSV26 EQU   WPLMSGT2                                                 06688000
WPLRSV25 EQU   WPLMSGT2                                                 06689000
WPLRSV16 EQU   WPLMSGT1                                                 06690000
WPLRSV15 EQU   WPLMSGT1                                                 06691000
WPLMSGTF EQU   WPLMSGT1                                                 06692000
WPLRSV14 EQU   WPLMSGT1                                                 06693000
WPLMSGTC EQU   WPLMSGT1                                                 06694000
WPLMSGTB EQU   WPLMSGT1                                                 06695000
WPLMSGTA EQU   WPLMSGT1                                                 06696000
WPLRSV13 EQU   WPLROUT2                                                 06697000
WPLROUTO EQU   WPLROUT2                                                 06698000
WPLROUTN EQU   WPLROUT2                                                 06699000
WPLROUTM EQU   WPLROUT2                                                 06700000
WPLROUTL EQU   WPLROUT2                                                 06701000
WPLROUTJ EQU   WPLROUT2                                                 06702000
WPLROUTI EQU   WPLROUT2                                                 06703000
WPLROUTH EQU   WPLROUT1                                                 06704000
WPLROUTG EQU   WPLROUT1                                                 06705000
WPLROUTF EQU   WPLROUT1                                                 06706000
WPLROUTE EQU   WPLROUT1                                                 06707000
WPLROUTD EQU   WPLROUT1                                                 06708000
WPLROUTC EQU   WPLROUT1                                                 06709000
WPLROUTB EQU   WPLROUT1                                                 06710000
WPLROUTA EQU   WPLROUT1                                                 06711000
WPLRSV12 EQU   WPLDESC2                                                 06712000
WPLRSV11 EQU   WPLDESC2                                                 06713000
WPLRSV10 EQU   WPLDESC2                                                 06714000
WPLRSV09 EQU   WPLDESC2                                                 06715000
WPLRSV08 EQU   WPLDESC2                                                 06716000
WPLRSV07 EQU   WPLDESC2                                                 06717000
WPLDESCJ EQU   WPLDESC2                                                 06718000
WPLDESCI EQU   WPLDESC2                                                 06719000
WPLDESCH EQU   WPLDESC1                                                 06720000
WPLDESCF EQU   WPLDESC1                                                 06721000
WPLDESCE EQU   WPLDESC1                                                 06722000
WPLDESCD EQU   WPLDESC1                                                 06723000
WPLDESCC EQU   WPLDESC1                                                 06724000
WPLTXTL  EQU   WPLTXT+125                                               06725000
@NM00014 EQU   WPLTXT                                                   06726000
WPLRSV05 EQU   WPLMCSF2                                                 06727000
WPLRSV04 EQU   WPLMCSF2                                                 06728000
WPLMCSFN EQU   WPLMCSF2                                                 06729000
WPLRSV03 EQU   WPLMCSF2                                                 06730000
WPLNOWTP EQU   WPLMCSF2                                                 06731000
WPLMCSFK EQU   WPLMCSF2                                                 06732000
WPLMCSFH EQU   WPLMCSF1                                                 06733000
WPLMCSFG EQU   WPLMCSF1                                                 06734000
WPLMCSFF EQU   WPLMCSF1                                                 06735000
WPLMCSFE EQU   WPLMCSF1                                                 06736000
WPLMCSFC EQU   WPLMCSF1                                                 06737000
WPLMCSFB EQU   WPLMCSF1                                                 06738000
WPLRPTRA EQU   WPLRPTR+1                                                06739000
WQERSVC7 EQU   WMNM+184                                                 06740000
WQERSVC6 EQU   WMNM+181                                                 06741000
WQERSVC5 EQU   WMNMST2                                                  06742000
WQERSVC4 EQU   WMNMST2                                                  06743000
WQERSVC3 EQU   WMNMST2                                                  06744000
WQERSVC2 EQU   WMNMST2                                                  06745000
WQERSVC1 EQU   WMNMST2                                                  06746000
WQERSVB9 EQU   WMNMST2                                                  06747000
WQERSVB8 EQU   WMNMST2                                                  06748000
WMNMTPD2 EQU   WMNMST2                                                  06749000
WMNMTXT2 EQU   WMNM+108                                                 06750000
WMNMHCT2 EQU   WMNM+104                                                 06751000
WMNMTL2  EQU   WMNM+103                                                 06752000
WQERSV74 EQU   WMNM+102                                                 06753000
WQERSV73 EQU   WMNMLT2                                                  06754000
WQERSV72 EQU   WMNMLT2                                                  06755000
WQERSV71 EQU   WMNMLT2                                                  06756000
WQERSV70 EQU   WMNMLT2                                                  06757000
WMNMLT2D EQU   WMNMLT2                                                  06758000
WMNMLT2C EQU   WMNMLT2                                                  06759000
WMNMLT2B EQU   WMNMLT2                                                  06760000
WMNMLT2A EQU   WMNMLT2                                                  06761000
WMNMML2H EQU   WMNMML2                                                  06762000
WMNMML2G EQU   WMNMML2                                                  06763000
WQERSV69 EQU   WMNMML2                                                  06764000
WMNMML2E EQU   WMNMML2                                                  06765000
WMNMML2D EQU   WMNMML2                                                  06766000
WMNMML2C EQU   WMNMML2                                                  06767000
WMNMML2B EQU   WMNMML2                                                  06768000
WQERSV68 EQU   WMNMML2                                                  06769000
WMNMNX2  EQU   WMNM+97                                                  06770000
WMNMUC2  EQU   WMNM+96                                                  06771000
WQERSVB7 EQU   WMNM+88                                                  06772000
WQERSVB6 EQU   WMNM+85                                                  06773000
WQERSVB5 EQU   WMNMST1                                                  06774000
WQERSVB4 EQU   WMNMST1                                                  06775000
WQERSVB3 EQU   WMNMST1                                                  06776000
WQERSVB2 EQU   WMNMST1                                                  06777000
WQERSVB1 EQU   WMNMST1                                                  06778000
WQERSVA9 EQU   WMNMST1                                                  06779000
WQERSVA8 EQU   WMNMST1                                                  06780000
WMNMTPD1 EQU   WMNMST1                                                  06781000
WMNMTXT1 EQU   WMNM+12                                                  06782000
WMNMHCT1 EQU   WMNM+8                                                   06783000
WMNMTL1  EQU   WMNM+7                                                   06784000
WQERSV67 EQU   WMNM+6                                                   06785000
WQERSV66 EQU   WMNMLT1                                                  06786000
WQERSV65 EQU   WMNMLT1                                                  06787000
WQERSV64 EQU   WMNMLT1                                                  06788000
WQERSV63 EQU   WMNMLT1                                                  06789000
WMNMLT1D EQU   WMNMLT1                                                  06790000
WMNMLT1C EQU   WMNMLT1                                                  06791000
WMNMLT1B EQU   WMNMLT1                                                  06792000
WMNMLT1A EQU   WMNMLT1                                                  06793000
WMNMML1H EQU   WMNMML1                                                  06794000
WMNMML1G EQU   WMNMML1                                                  06795000
WMNMML1F EQU   WMNMML1                                                  06796000
WMNMML1E EQU   WMNMML1                                                  06797000
WMNMML1D EQU   WMNMML1                                                  06798000
WMNMML1C EQU   WMNMML1                                                  06799000
WMNMML1B EQU   WMNMML1                                                  06800000
WQERSV62 EQU   WMNMML1                                                  06801000
WMNMNX1  EQU   WMNMEXT+1                                                06802000
WMNMUC1  EQU   WMNMEXT                                                  06803000
WMJMJTCB EQU   WMJM+188                                                 06804000
WMJMDEC4 EQU   WMJMDEC+3                                                06805000
WMJMDEC3 EQU   WMJMDEC+2                                                06806000
WQERSV61 EQU   WMJMDEC2                                                 06807000
WQERSV60 EQU   WMJMDEC2                                                 06808000
WQERSV59 EQU   WMJMDEC2                                                 06809000
WQERSV58 EQU   WMJMDEC2                                                 06810000
WQERSV57 EQU   WMJMDEC2                                                 06811000
WQERSV56 EQU   WMJMDEC2                                                 06812000
WMJMDECJ EQU   WMJMDEC2                                                 06813000
WMJMDECI EQU   WMJMDEC2                                                 06814000
WMJMDECH EQU   WMJMDEC1                                                 06815000
WMJMDECG EQU   WMJMDEC1                                                 06816000
WMJMDECF EQU   WMJMDEC1                                                 06817000
WMJMDECE EQU   WMJMDEC1                                                 06818000
WMJMDECD EQU   WMJMDEC1                                                 06819000
WMJMDECC EQU   WMJMDEC1                                                 06820000
WMJMDECB EQU   WMJMDEC1                                                 06821000
WMJMDECA EQU   WMJMDEC1                                                 06822000
WQERSV54 EQU   WMJM+181                                                 06823000
WMJMUID  EQU   WMJM+180                                                 06824000
WMJMRCT4 EQU   WMJMRTC+3                                                06825000
WMJMRCT3 EQU   WMJMRTC+2                                                06826000
WQERSV53 EQU   WMJMRCT2                                                 06827000
WMJMRCTO EQU   WMJMRCT2                                                 06828000
WMJMRCTN EQU   WMJMRCT2                                                 06829000
WMJMRCTM EQU   WMJMRCT2                                                 06830000
WMJMRCTL EQU   WMJMRCT2                                                 06831000
WMJMRCTK EQU   WMJMRCT2                                                 06832000
WMJMRCTJ EQU   WMJMRCT2                                                 06833000
WMJMRCTI EQU   WMJMRCT2                                                 06834000
WMJMRCTH EQU   WMJMRCT1                                                 06835000
WMJMRCTG EQU   WMJMRCT1                                                 06836000
WMJMRCTF EQU   WMJMRCT1                                                 06837000
WMJMRCTE EQU   WMJMRCT1                                                 06838000
WMJMRCTD EQU   WMJMRCT1                                                 06839000
WMJMRCTC EQU   WMJMRCT1                                                 06840000
WMJMRCTB EQU   WMJMRCT1                                                 06841000
WMJMRCTA EQU   WMJMRCT1                                                 06842000
WMJMMT2  EQU   WMJMMT+1                                                 06843000
WQERSV52 EQU   WMJMMT1                                                  06844000
WQERSV51 EQU   WMJMMT1                                                  06845000
WMJMMT1F EQU   WMJMMT1                                                  06846000
WQERSV50 EQU   WMJMMT1                                                  06847000
WMJMMT1D EQU   WMJMMT1                                                  06848000
WQERSVA6 EQU   WMJMMT1                                                  06849000
WMJMMT1B EQU   WMJMMT1                                                  06850000
WMJMMT1A EQU   WMJMMT1                                                  06851000
WQERSV11 EQU   WMJMCS2                                                  06852000
WQERSV49 EQU   WMJMCS2                                                  06853000
WMJMCS2F EQU   WMJMCS2                                                  06854000
WQERSV48 EQU   WMJMCS2                                                  06855000
WQERSV47 EQU   WMJMCS2                                                  06856000
WMJMCS2C EQU   WMJMCS2                                                  06857000
WMJMCS2B EQU   WMJMCS2                                                  06858000
WMJMCS2A EQU   WMJMCS2                                                  06859000
WMJMCS1H EQU   WMJMCS1                                                  06860000
WMJMCS1G EQU   WMJMCS1                                                  06861000
WMJMCS1F EQU   WMJMCS1                                                  06862000
WMJMCS1E EQU   WMJMCS1                                                  06863000
WMJMCS1D EQU   WMJMCS1                                                  06864000
WMJMCS1C EQU   WMJMCS1                                                  06865000
WMJMCS1B EQU   WMJMCS1                                                  06866000
WMJMCS1A EQU   WMJMCS1                                                  06867000
WMJMSEQ  EQU   WMJM+169                                                 06868000
WMJMRTCT EQU   WMJM+168                                                 06869000
WMJMTCB  EQU   WMJM+164                                                 06870000
WQERSV45 EQU   WMJMBUF                                                  06871000
WMJMBUFG EQU   WMJMBUF                                                  06872000
WMJMBUFF EQU   WMJMBUF                                                  06873000
WMJMBUFE EQU   WMJMBUF                                                  06874000
WMJMBUFD EQU   WMJMBUF                                                  06875000
WMJMBUFC EQU   WMJMBUF                                                  06876000
WMJMBUFB EQU   WMJMBUF                                                  06877000
WMJMBUFA EQU   WMJMBUF                                                  06878000
WMJMASID EQU   WMJM+161                                                 06879000
WMJMDSPH EQU   WMJMDSP                                                  06880000
WMJMDSPG EQU   WMJMDSP                                                  06881000
WMJMDSPF EQU   WMJMDSP                                                  06882000
WMJMDSPE EQU   WMJMDSP                                                  06883000
WMJMDSPD EQU   WMJMDSP                                                  06884000
WMJMDSPC EQU   WMJMDSP                                                  06885000
WMJMDSPB EQU   WMJMDSP                                                  06886000
WMJMDSPA EQU   WMJMDSP                                                  06887000
WQERSVA5 EQU   WMJM+156                                                 06888000
WQERSVA4 EQU   WMJM+152                                                 06889000
WQERSVD8 EQU   WMJM+149                                                 06890000
WQERSVD7 EQU   WMJMECBF                                                 06891000
WQERSVD6 EQU   WMJMECBF                                                 06892000
WQERSVD5 EQU   WMJMECBF                                                 06893000
WQERSVD4 EQU   WMJMECBF                                                 06894000
WQERSVD3 EQU   WMJMECBF                                                 06895000
WQERSVD2 EQU   WMJMECBF                                                 06896000
WMJMMAJD EQU   WMJMECBF                                                 06897000
WMJMWAIT EQU   WMJMECBF                                                 06898000
WMJMMSGN EQU   WMJM+144                                                 06899000
WMJMAECB EQU   WMJM+140                                                 06900000
WMJMMIN  EQU   WMJM+136                                                 06901000
WMJMLTY2 EQU   WMJMLTYP+1                                               06902000
WQERSV38 EQU   WMJMLTY1                                                 06903000
WQERSV37 EQU   WMJMLTY1                                                 06904000
WQERSV36 EQU   WMJMLTY1                                                 06905000
WQERSV35 EQU   WMJMLTY1                                                 06906000
WMJMLTYD EQU   WMJMLTY1                                                 06907000
WMJMLTYC EQU   WMJMLTY1                                                 06908000
WMJMLTYB EQU   WMJMLTY1                                                 06909000
WMJMLTYA EQU   WMJMLTY1                                                 06910000
WQERSV34 EQU   WMJM+132                                                 06911000
WMJMCONS EQU   WMJM+124                                                 06912000
WMJMSER2 EQU   WMJMSER+1                                                06913000
WQERSV33 EQU   WMJMSER1                                                 06914000
WQERSV32 EQU   WMJMSER1                                                 06915000
WQERSV31 EQU   WMJMSER1                                                 06916000
WMJMSERE EQU   WMJMSER1                                                 06917000
WMJMSERD EQU   WMJMSER1                                                 06918000
WMJMSERC EQU   WMJMSER1                                                 06919000
WMJMSERB EQU   WMJMSER1                                                 06920000
WMJMSERA EQU   WMJMSER1                                                 06921000
WQERSV30 EQU   WMJM+120                                                 06922000
WQERSV29 EQU   WMJM+116                                                 06923000
WMJMRESA EQU   WMJM+108                                                 06924000
WNJNPAD3 EQU   WMJM+107                                                 06925000
WMJMHCID EQU   WMJM+103                                                 06926000
WMJMTXT  EQU   WMJM+31                                                  06927000
WMJMPAD2 EQU   WMJM+30                                                  06928000
WMJMJBNM EQU   WMJM+22                                                  06929000
WMJMPAD1 EQU   WMJM+21                                                  06930000
WMJMTSSS EQU   WMJMTS+6                                                 06931000
WMJMTSP2 EQU   WMJMTS+5                                                 06932000
WMJMTSMM EQU   WMJMTS+3                                                 06933000
WMJMTSP1 EQU   WMJMTS+2                                                 06934000
WMJMTSHH EQU   WMJMTS                                                   06935000
WMJMPAD  EQU   WMJM+12                                                  06936000
WMJMRR   EQU   WMJM+8                                                   06937000
WMJMTXTL EQU   WMJM+6                                                   06938000
WMJMAREA EQU   WMJM+5                                                   06939000
WMJMMLWH EQU   WMJMMLW                                                  06940000
WMJMMLWG EQU   WMJMMLW                                                  06941000
WMJMMLWF EQU   WMJMMLW                                                  06942000
WMJMMLWE EQU   WMJMMLW                                                  06943000
WMJMMLWD EQU   WMJMMLW                                                  06944000
WMJMMLWC EQU   WMJMMLW                                                  06945000
WMJMMLWB EQU   WMJMMLW                                                  06946000
WMJMMLWA EQU   WMJMMLW                                                  06947000
WMJMNXT  EQU   WMJMEXTA                                                 06948000
WMJMUC   EQU   WMJMEXT                                                  06949000
WQERSV26 EQU   WQE+186                                                  06950000
WQERSV25 EQU   WQEDC2                                                   06951000
WQERSV24 EQU   WQEDC2                                                   06952000
WQERSV23 EQU   WQEDC2                                                   06953000
WQERSV22 EQU   WQEDC2                                                   06954000
WQERSV21 EQU   WQEDC2                                                   06955000
WQERSV20 EQU   WQEDC2                                                   06956000
WQEDCJ   EQU   WQEDC2                                                   06957000
WQEDCI   EQU   WQEDC2                                                   06958000
WQEDCH   EQU   WQEDC1                                                   06959000
WQEDCG   EQU   WQEDC1                                                   06960000
WQEDCF   EQU   WQEDC1                                                   06961000
WQEDCE   EQU   WQEDC1                                                   06962000
WQEDCD   EQU   WQEDC1                                                   06963000
WQEDCC   EQU   WQEDC1                                                   06964000
WQEDCB   EQU   WQEDC1                                                   06965000
WQEDCA   EQU   WQEDC1                                                   06966000
WQERSV18 EQU   WQE+181                                                  06967000
WQERSV17 EQU   WQE+178                                                  06968000
WQERSV16 EQU   WQEROUT2                                                 06969000
WQEROUTO EQU   WQEROUT2                                                 06970000
WQEROUTN EQU   WQEROUT2                                                 06971000
WQEROUTM EQU   WQEROUT2                                                 06972000
WQEROUTL EQU   WQEROUT2                                                 06973000
WQEROUTK EQU   WQEROUT2                                                 06974000
WQEROUTJ EQU   WQEROUT2                                                 06975000
WQEROUTI EQU   WQEROUT2                                                 06976000
WQEROUTH EQU   WQEROUT1                                                 06977000
WQEROUTG EQU   WQEROUT1                                                 06978000
WQEROUTF EQU   WQEROUT1                                                 06979000
WQEROUTE EQU   WQEROUT1                                                 06980000
WQEROUTD EQU   WQEROUT1                                                 06981000
WQEROUTC EQU   WQEROUT1                                                 06982000
WQEROUTB EQU   WQEROUT1                                                 06983000
WQEROUTA EQU   WQEROUT1                                                 06984000
WQERSV15 EQU   WQEMSGT1                                                 06985000
WQERSV14 EQU   WQEMSGT1                                                 06986000
WQEMSGTF EQU   WQEMSGT1                                                 06987000
WQERSV13 EQU   WQEMSGT1                                                 06988000
WQEMSGTD EQU   WQEMSGT1                                                 06989000
WQEMSGTC EQU   WQEMSGT1                                                 06990000
WQEMSGTB EQU   WQEMSGT1                                                 06991000
WQEMSGTA EQU   WQEMSGT1                                                 06992000
WQEMCSP  EQU   WQEMCSF2                                                 06993000
WQEMCSO  EQU   WQEMCSF2                                                 06994000
WQERSV10 EQU   WQEMCSF2                                                 06995000
WQERSV09 EQU   WQEMCSF2                                                 06996000
WQEMCSK  EQU   WQEMCSF2                                                 06997000
WQEMCSJ  EQU   WQEMCSF2                                                 06998000
WQEMCSI  EQU   WQEMCSF2                                                 06999000
WQEMCSFF EQU   WQEMCSF1                                                 07000000
WQEMCSE  EQU   WQEMCSF1                                                 07001000
WQEMCSD  EQU   WQEMCSF1                                                 07002000
WQEMCSC  EQU   WQEMCSF1                                                 07003000
WQERTCT  EQU   WQE+168                                                  07004000
WQERSV07 EQU   WQEAVAIL                                                 07005000
WQERSV06 EQU   WQEAVAIL                                                 07006000
WQEBUFF  EQU   WQEAVAIL                                                 07007000
WQEBUFA  EQU   WQEAVAIL                                                 07008000
WQEDOM   EQU   WQEXA                                                    07009000
WQEQDFHC EQU   WQEXA                                                    07010000
WQEPURGE EQU   WQEXA                                                    07011000
WQEPAD3  EQU   WQE+159                                                  07012000
WQETXTL  EQU   WQETXT+127                                               07013000
@NM00013 EQU   WQETXT                                                   07014000
WQEUSE   EQU   WQELKP                                                   07015000
OREOPBUF EQU   OREF+28                                                  07016000
ORERSV11 EQU   OREF+26                                                  07017000
OREM     EQU   OREF+24                                                  07018000
OREECBA  EQU   OREECB+1                                                 07019000
ORETJID2 EQU   OREECB                                                   07020000
ORERPYA  EQU   ORERPY+1                                                 07021000
ORELNTH  EQU   ORERPY                                                   07022000
ORETCBA  EQU   ORETCB+1                                                 07023000
ORETJID1 EQU   ORETCB                                                   07024000
ORERSV10 EQU   OREXC                                                    07025000
ORERSV09 EQU   OREXC                                                    07026000
ORERSV08 EQU   OREXC                                                    07027000
OREBUFE  EQU   OREXC                                                    07028000
OREBUFC  EQU   OREXC                                                    07029000
OREBUFA  EQU   OREXC                                                    07030000
ORERSV06 EQU   OREXA                                                    07031000
ORERSV05 EQU   OREXA                                                    07032000
ORERSV04 EQU   OREXA                                                    07033000
ORERSV03 EQU   OREXA                                                    07034000
ORESWAP  EQU   OREXA                                                    07035000
ORERSV01 EQU   OREXA                                                    07036000
JESSASTA EQU   JESCT+48                                                 07037000
JESNUCBS EQU   JESCT+44                                                 07038000
JESPJESN EQU   JESCT+28                                                 07039000
JESSSCT  EQU   JESCT+24                                                 07040000
JESRESQM EQU   JESCT+16                                                 07041000
JESQMGR  EQU   JESCT+12                                                 07042000
JESUNITS EQU   JESCT+4                                                  07043000
@NM00012 EQU   JESCT                                                    07044000
PARMSYAD EQU   PARMLIST+4                                               07045000
PARMCTBK EQU   PARMSTAT+3                                               07046000
PARMSYSR EQU   PARMSTAT+2                                               07047000
@NM00002 EQU   PARMFLAG                                                 07048000
@NM00001 EQU   PARMFLAG                                                 07049000
PARMWARG EQU   PARMFLAG                                                 07050000
PARMRECU EQU   PARMFLAG                                                 07051000
PARMCWT  EQU   PARMFLAG                                                 07052000
PARMSDWA EQU   PARMFLAG                                                 07053000
WWBRESRV EQU   WWB+17                                                   07054000
@NM00119 EQU   PSA+3668                                                 07055000
PSASTAK  EQU   PSA+3072                                                 07056000
@NM00118 EQU   PSA+1048                                                 07057000
PSAUSEND EQU   PSA+1048                                                 07058000
PSARV062 EQU   PSA+1044                                                 07059000
PSACDAL  EQU   PSA+1040                                                 07060000
PSAWTCOD EQU   PSA+1036                                                 07061000
PSAATCVT EQU   PSA+1032                                                 07062000
PSAPCPSW EQU   PSA+1024                                                 07063000
PSAPIR2  EQU   PSA+1020                                                 07064000
PSARV059 EQU   PSA+1018                                                 07065000
PSASVC13 EQU   PSA+1016                                                 07066000
PSASFACC EQU   PSA+1008                                                 07067000
PSASTOP  EQU   PSA+992                                                  07068000
PSASTART EQU   PSA+976                                                  07069000
PSARSPSW EQU   PSA+968                                                  07070000
PSASRPSW EQU   PSA+960                                                  07071000
PSARV045 EQU   PSA+892                                                  07072000
PSARV044 EQU   PSA+888                                                  07073000
PSARV043 EQU   PSA+884                                                  07074000
PSARV042 EQU   PSA+880                                                  07075000
PSARV041 EQU   PSA+876                                                  07076000
PSARV040 EQU   PSA+872                                                  07077000
PSARV025 EQU   PSA+868                                                  07078000
PSADSSED EQU   PSA+868                                                  07079000
PSADSSPR EQU   PSA+864                                                  07080000
PSADSSFW EQU   PSA+860                                                  07081000
PSADSS14 EQU   PSA+856                                                  07082000
PSADSSPP EQU   PSA+848                                                  07083000
PSADSSRP EQU   PSA+840                                                  07084000
PSADSS05 EQU   PSADSSF4                                                 07085000
PSADSS10 EQU   PSADSSF4                                                 07086000
PSADSSVE EQU   PSADSSF4                                                 07087000
PSADSSDE EQU   PSADSSF4                                                 07088000
PSADSSC0 EQU   PSADSSF4                                                 07089000
PSADSSIE EQU   PSADSSF4                                                 07090000
PSADSS12 EQU   PSADSSF4                                                 07091000
PSADSSRC EQU   PSADSSF4                                                 07092000
PSARV057 EQU   PSADSSF3                                                 07093000
PSARV056 EQU   PSADSSF3                                                 07094000
PSARV055 EQU   PSADSSF3                                                 07095000
PSADSSMC EQU   PSADSSF3                                                 07096000
PSADSSRW EQU   PSADSSF3                                                 07097000
PSADSSNM EQU   PSADSSF3                                                 07098000
PSADSSES EQU   PSADSSF3                                                 07099000
PSADSSGP EQU   PSADSSF3                                                 07100000
PSADSSF2 EQU   PSADSSFL+1                                               07101000
PSADSSPI EQU   PSADSSF1                                                 07102000
PSADSSOI EQU   PSADSSF1                                                 07103000
PSADSSSP EQU   PSADSSF1                                                 07104000
PSADSSTP EQU   PSADSSF1                                                 07105000
PSADSSDW EQU   PSADSSF1                                                 07106000
PSADSSDD EQU   PSADSSF1                                                 07107000
PSADSSDM EQU   PSADSSF1                                                 07108000
PSADSSMV EQU   PSADSSF1                                                 07109000
PSADSSTS EQU   PSA+816                                                  07110000
PSADSSWK EQU   PSA+812                                                  07111000
PSADSSR3 EQU   PSA+808                                                  07112000
PSADSSR2 EQU   PSA+804                                                  07113000
PSADSSRS EQU   PSA+800                                                  07114000
PSASTOR  EQU   PSA+796                                                  07115000
PSACPUSA EQU   PSA+794                                                  07116000
PSAVSTAP EQU   PSA+792                                                  07117000
PSAWKVAP EQU   PSA+788                                                  07118000
PSAWKRAP EQU   PSA+784                                                  07119000
PSAMCHIC EQU   PSA+783                                                  07120000
PSARV061 EQU   PSA+782                                                  07121000
PSASYMSK EQU   PSA+781                                                  07122000
PSAMCHFL EQU   PSA+780                                                  07123000
PSACR0   EQU   PSA+776                                                  07124000
PSAPSWSV EQU   PSA+768                                                  07125000
PSACLHS  EQU   PSAHLHI                                                  07126000
PSALKR15 EQU   PSALKSA+60                                               07127000
PSALKR14 EQU   PSALKSA+56                                               07128000
PSALKR13 EQU   PSALKSA+52                                               07129000
PSALKR12 EQU   PSALKSA+48                                               07130000
PSALKR11 EQU   PSALKSA+44                                               07131000
PSALKR10 EQU   PSALKSA+40                                               07132000
PSALKR9  EQU   PSALKSA+36                                               07133000
PSALKR8  EQU   PSALKSA+32                                               07134000
PSALKR7  EQU   PSALKSA+28                                               07135000
PSALKR6  EQU   PSALKSA+24                                               07136000
PSALKR5  EQU   PSALKSA+20                                               07137000
PSALKR4  EQU   PSALKSA+16                                               07138000
PSALKR3  EQU   PSALKSA+12                                               07139000
PSALKR2  EQU   PSALKSA+8                                                07140000
PSALKR1  EQU   PSALKSA+4                                                07141000
PSALKR0  EQU   PSALKSA                                                  07142000
PSARV023 EQU   PSACLHT+52                                               07143000
PSALOCAL EQU   PSACLHT+48                                               07144000
PSACMSL  EQU   PSACLHT+44                                               07145000
PSAOPTL  EQU   PSACLHT+40                                               07146000
PSATPACL EQU   PSACLHT+36                                               07147000
PSATPDNL EQU   PSACLHT+32                                               07148000
PSATPNCL EQU   PSACLHT+28                                               07149000
PSAIOSLL EQU   PSACLHT+24                                               07150000
PSAIOSUL EQU   PSACLHT+20                                               07151000
PSAIOSCL EQU   PSACLHT+16                                               07152000
PSAIOSSL EQU   PSACLHT+12                                               07153000
PSASALCL EQU   PSACLHT+8                                                07154000
PSAASML  EQU   PSACLHT+4                                                07155000
PSADISPL EQU   PSACLHT                                                  07156000
PSASRSA  EQU   PSA+636                                                  07157000
PSARV050 EQU   PSA+634                                                  07158000
PSADSSGO EQU   PSA+633                                                  07159000
PSARECUR EQU   PSA+632                                                  07160000
PSAHLHIS EQU   PSA+628                                                  07161000
PSAIPCSA EQU   PSA+624                                                  07162000
@NM00117 EQU   PSA+621                                                  07163000
PSAIPCDM EQU   PSA+620                                                  07164000
PSAIPCD  EQU   PSA+616                                                  07165000
@NM00116 EQU   PSA+613                                                  07166000
PSAIPCRM EQU   PSA+612                                                  07167000
PSAIPCR  EQU   PSA+608                                                  07168000
PSAMCHEX EQU   PSA+600                                                  07169000
PSAMPSW  EQU   PSA+592                                                  07170000
PSAEXPS2 EQU   PSA+584                                                  07171000
PSAEXPS1 EQU   PSA+576                                                  07172000
PSAPIREG EQU   PSA+572                                                  07173000
PSARSREG EQU   PSA+568                                                  07174000
PSAGPREG EQU   PSA+556                                                  07175000
PSARV022 EQU   PSASUP4                                                  07176000
PSARV021 EQU   PSASUP4                                                  07177000
PSARV020 EQU   PSASUP4                                                  07178000
PSARV019 EQU   PSASUP4                                                  07179000
PSARV018 EQU   PSASUP4                                                  07180000
PSARV017 EQU   PSASUP4                                                  07181000
PSARV016 EQU   PSASUP4                                                  07182000
PSARV015 EQU   PSASUP4                                                  07183000
PSARV014 EQU   PSASUP3                                                  07184000
PSAULCMS EQU   PSASUP3                                                  07185000
PSARV012 EQU   PSASUP3                                                  07186000
PSAESTA  EQU   PSASUP3                                                  07187000
PSASPR   EQU   PSASUP3                                                  07188000
PSAPSREG EQU   PSASUP3                                                  07189000
PSAPI2   EQU   PSASUP3                                                  07190000
PSAIOSUP EQU   PSASUP3                                                  07191000
PSALCR   EQU   PSASUP2                                                  07192000
PSARTM   EQU   PSASUP2                                                  07193000
PSAACR   EQU   PSASUP2                                                  07194000
PSAIPCE2 EQU   PSASUP2                                                  07195000
PSAIPCES EQU   PSASUP2                                                  07196000
PSAIPCEC EQU   PSASUP2                                                  07197000
PSAGTF   EQU   PSASUP2                                                  07198000
PSAIPCRI EQU   PSASUP2                                                  07199000
PSATYPE6 EQU   PSASUP1                                                  07200000
PSATCTL  EQU   PSASUP1                                                  07201000
PSADISP  EQU   PSASUP1                                                  07202000
PSALOCK  EQU   PSASUP1                                                  07203000
PSAPI    EQU   PSASUP1                                                  07204000
PSAEXT   EQU   PSASUP1                                                  07205000
PSASVC   EQU   PSASUP1                                                  07206000
PSAIO    EQU   PSASUP1                                                  07207000
PSAAOLD  EQU   PSA+548                                                  07208000
PSAANEW  EQU   PSA+544                                                  07209000
PSATOLD  EQU   PSA+540                                                  07210000
PSATNEW  EQU   PSA+536                                                  07211000
PSALCCAR EQU   PSA+532                                                  07212000
PSALCCAV EQU   PSA+528                                                  07213000
PSAPCCAR EQU   PSA+524                                                  07214000
PSAPCCAV EQU   PSA+520                                                  07215000
PSACPULA EQU   PSA+518                                                  07216000
PSACPUPA EQU   PSA+516                                                  07217000
PSAPSA   EQU   PSA+512                                                  07218000
FLCHDEND EQU   PSA+512                                                  07219000
FLCCRSAV EQU   FLCMCLA+280                                              07220000
FLCGRSAV EQU   FLCMCLA+216                                              07221000
FLCFPSAV EQU   FLCMCLA+184                                              07222000
FLCFLA   EQU   FLCMCLA+88                                               07223000
FLCRGNCD EQU   FLCMCLA+84                                               07224000
FLCFSAA  EQU   FLCFSA+1                                                 07225000
@NM00115 EQU   FLCFSA                                                   07226000
@NM00114 EQU   FLCMCLA+72                                               07227000
FLCMCIC  EQU   FLCMCLA+64                                               07228000
@NM00113 EQU   FLCMCLA+20                                               07229000
FLCIOAA  EQU   FLCIOA+1                                                 07230000
@NM00112 EQU   FLCIOA                                                   07231000
@NM00111 EQU   FLCMCLA+15                                               07232000
@NM00110 EQU   FLCMCLA+14                                               07233000
@NM00109 EQU   FLCMCLA+12                                               07234000
FLCLCL   EQU   FLCMCLA+8                                                07235000
FLCIOELA EQU   FLCIOEL+1                                                07236000
@NM00108 EQU   FLCIOEL                                                  07237000
FLCCHNID EQU   FLCMCLA                                                  07238000
@NM00107 EQU   PSA+160                                                  07239000
FLCMTRCD EQU   PSA+157                                                  07240000
@NM00106 EQU   PSA+156                                                  07241000
FLCPERA  EQU   FLCPER+1                                                 07242000
@NM00105 EQU   FLCPER                                                   07243000
@NM00104 EQU   PSA+151                                                  07244000
FLCPERCD EQU   PSA+150                                                  07245000
FLCMCNUM EQU   PSA+149                                                  07246000
@NM00103 EQU   PSA+148                                                  07247000
FLCTEAA  EQU   FLCTEA+1                                                 07248000
@NM00102 EQU   FLCTEA                                                   07249000
PSAPIPC  EQU   PSAPICOD                                                 07250000
PSAPIMC  EQU   PSAPICOD                                                 07251000
PSAPIPER EQU   PSAPICOD                                                 07252000
PSARV049 EQU   FLCPICOD                                                 07253000
FLCPILCB EQU   FLCPIILC                                                 07254000
@NM00101 EQU   FLCPIILC                                                 07255000
@NM00100 EQU   PSAEPPSW                                                 07256000
FLCSVCN  EQU   PSAESPSW+2                                               07257000
FLCSILCB EQU   FLCSVILC                                                 07258000
@NM00099 EQU   FLCSVILC                                                 07259000
@NM00098 EQU   PSAESPSW                                                 07260000
FLCEICOD EQU   PSAEEPSW+2                                               07261000
PSASPAD  EQU   PSAEEPSW                                                 07262000
@NM00097 EQU   PSA+128                                                  07263000
FLCINPSW EQU   PSA+120                                                  07264000
FLCMNPSW EQU   PSA+112                                                  07265000
FLCPNPSW EQU   PSA+104                                                  07266000
FLCSNPSW EQU   PSA+96                                                   07267000
FLCENPSW EQU   PSA+88                                                   07268000
FLCTRACE EQU   PSA+84                                                   07269000
FLCTIMER EQU   PSA+80                                                   07270000
FLCCVT2  EQU   PSA+76                                                   07271000
FLCCAW   EQU   PSA+72                                                   07272000
FLCCSW   EQU   PSA+64                                                   07273000
FLCIOPSW EQU   PSA+56                                                   07274000
FLCMOPSW EQU   PSA+48                                                   07275000
FLCPOPSW EQU   PSA+40                                                   07276000
FLCSOPSW EQU   PSA+32                                                   07277000
FLCEOPSW EQU   PSA+24                                                   07278000
@NM00096 EQU   FLCICCW2+4                                               07279000
FLCCVT   EQU   FLCICCW2                                                 07280000
FLCICCW1 EQU   FLCROPSW                                                 07281000
FLCIPPSW EQU   FLCRNPSW                                                 07282000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      07283000
@RC00282 EQU   @RC00281                                                 07284000
@RC00311 EQU   @RC00310                                                 07285000
@RC00374 EQU   @RC00342                                                 07286000
@RC00444 EQU   @RC00443                                                 07287000
@RC00626 EQU   @EL00002                                                 07288000
@RC00719 EQU   @RC00713                                                 07289000
@RC00755 EQU   @RC00749                                                 07290000
@RF00774 EQU   @EL00003                                                 07291000
@RC00640 EQU   @RC00626                                                 07292000
@RF00725 EQU   @RC00719                                                 07293000
@RF00761 EQU   @RC00755                                                 07294000
@ENDDATA EQU   *                                                        07295000
         END   IEAVVWTO,(C'PLS2319',0701,78192)                         07296000
