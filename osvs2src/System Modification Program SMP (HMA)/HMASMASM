         TITLE 'HMASMASM - ASSEMBLY SYSGEN SCAN ROUTINE OF SMP'         00001000
HMASMASM CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'HMASMASM  78.334'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00009000
         BALR  @12,0                                               0001 00010000
@PSTART  DS    0H                                                  0001 00011000
         USING @PSTART,@12                                         0001 00012000
         ST    @13,@SA00001+4                                      0001 00013000
         LA    @14,@SA00001                                        0001 00014000
         ST    @14,8(,@13)                                         0001 00015000
         LR    @13,@14                                             0001 00016000
         MVC   @PC00001(16),0(@01)                                 0001 00017000
*   IOPPTR=CCAIOPTR;                /* SET POINTER TO THE IOP        */ 00018000
         L     IOPPTR,CCAIOPTR(,CCAPTR)                            0177 00019000
*   SAVBUFAD=IOPBUFAD;              /* SAVE BUFFER ADDR      @Z67SP00*/ 00020000
         L     @10,IOPBUFAD(,IOPPTR)                               0178 00021000
         ST    @10,SAVBUFAD                                        0178 00022000
*   SCPPTR=ADDR(ASMSCP);            /* PTR TO LOCAL SCP      @Z67SP00*/ 00023000
         LA    @10,ASMSCP                                          0179 00024000
         ST    @10,SCPPTR                                          0179 00025000
*   HMASMSCP=CRPSCPAD->HMASMSCP;    /* COPY PASSEF SCP       @Z67SP00*/ 00026000
         L     @08,@PC00001+4                                      0180 00027000
         L     @01,CRPSCPAD(,@08)                                  0180 00028000
         MVC   HMASMSCP(26,@10),HMASMSCP(@01)                      0180 00029000
*   CRPSCPAD=SCPPTR;                /* CHAIN CRP TO SCP      @Z67SP00*/ 00030000
         ST    @10,CRPSCPAD(,@08)                                  0181 00031000
*   BUPIOPAD=ADDR(HMASMIOP);        /* PTR TO IOP FOR BUE    @Z67SP00*/ 00032000
         L     @08,@PC00001                                        0182 00033000
         ST    IOPPTR,BUPIOPAD(,@08)                               0182 00034000
*   BUPFUNCT=BUPABKUP;              /* SET TO ADD BACKUP     @Z67SP00*/ 00035000
         MVI   BUPFUNCT(@08),X'01'                                 0183 00036000
*   BUFBASE=ADDR(MACTBL);           /* SET TO BASE BUFFER            */ 00037000
         LA    @08,MACTBL                                          0184 00038000
         ST    @08,BUFBASE                                         0184 00039000
*   MACNXT=ZERO;                    /* CLEAR CHAIN POINTER           */ 00040000
         SLR   @15,@15                                             0185 00041000
         STCM  @15,7,MACNXT(@08)                                   0185 00042000
*   MACCTR=ZERO;                    /* INITIALIZE MACRO COUNTER      */ 00043000
         MVI   MACCTR(@08),X'00'                                   0186 00044000
*   MODNAME=BLANK;                  /* BLANK OUT MODULE NAMS         */ 00045000
         MVI   MODNAME+1,C' '                                      0187 00046000
         MVC   MODNAME+2(6),MODNAME+1                              0187 00047000
         MVI   MODNAME,C' '                                        0187 00048000
*   SCPSRCH=ADDR(MODK);             /* INIT PTR TO FIRST ARGUMENT    */ 00049000
         LA    @08,MODK                                            0188 00050000
         ST    @08,SCPSRCH(,@10)                                   0188 00051000
*   SCPIORTN=ZERO;                  /* ZERO I/O RTN ADDR             */ 00052000
         ST    @15,SCPIORTN(,@10)                                  0189 00053000
*   SCPINLN=MAXJCL*LENGTH(BUFFER(1));/* SET INPUT RECORD LENGTH      */ 00054000
         L     @08,@PC00001+12                                     0190 00055000
         LH    @08,MAXJCL(,@08)                                    0190 00056000
         MH    @08,@CH00068                                        0190 00057000
         STH   @08,SCPINLN(,@10)                                   0190 00058000
*   SCPCHAR=ADDR(BUFFER);           /* SET INPUT LIST RECORD PTR     */ 00059000
         L     @08,@PC00001+8                                      0191 00060000
         ST    @08,SCPCHAR(,@10)                                   0191 00061000
*   ASMRTNCD=ZERO;                  /* INITIALIZE RETURN CODE        */ 00062000
         MVI   ASMRTNCD,X'00'                                      0192 00063000
*   SWITCHES=ZERO;                  /* INIT INTERNAL SW      @Z40SP00*/ 00064000
*                                                                  0193 00065000
         MVI   SWITCHES,X'00'                                      0193 00066000
*   /*****************************************************************/ 00067000
*   /*                                                               */ 00068000
*   /* CALL HMASMSCN TO SCAN THE JCL LOOKING FOR MOD= KEYWORD OR     */ 00069000
*   /* SYSPUNCH DD STATEMENT FOR DSN. THIS WILL PRODUCE THE ASSEMBLY */ 00070000
*   /* NAME UNDER WHICH THE ASSEMBLER INPUT IS EVENTUALLY STORED.    */ 00071000
*   /*                                                               */ 00072000
*   /*****************************************************************/ 00073000
*                                                                  0194 00074000
*   CALL HMASMSCN(HMASMSCP);        /* SCAN THE JCL STATEMENT        */ 00075000
         ST    @10,@AL00001                                        0194 00076000
         L     @15,@CV01384                                        0194 00077000
         LA    @01,@AL00001                                        0194 00078000
         BALR  @14,@15                                             0194 00079000
*   IF SCPRET^=SCPGOOD              /* SYNTAX ERROR?         @Z40SP00*/ 00080000
*       |MODNAME(1)=BLANK           /* OR MODULE NAME NOT FOUND      */ 00081000
*     THEN                          /* YES - RETURN SYNTAX ERROR     */ 00082000
         L     @10,SCPPTR                                          0195 00083000
         CLI   SCPRET(@10),0                                       0195 00084000
         BNE   @RT00195                                            0195 00085000
         CLI   MODNAME,C' '                                        0195 00086000
         BNE   @RF00195                                            0195 00087000
@RT00195 DS    0H                                                  0196 00088000
*     DO;                           /*                       @SA72421*/ 00089000
*       MSGTXT=MODERR;              /* WRITE ERROR MESSAGE   @Z67SP00*/ 00090000
         MVC   MSGTXT(25),MODERR                                   0197 00091000
*       ASMRTNCD=MAX(ASMRTNCD,SYNTERR);/* SAVE RC            @Z67SP00*/ 00092000
         SLR   @10,@10                                             0198 00093000
         IC    @10,ASMRTNCD                                        0198 00094000
         LA    @08,10                                              0198 00095000
         CR    @10,@08                                             0198 00096000
         BNL   *+6                                                      00097000
         LR    @10,@08                                             0198 00098000
         STC   @10,ASMRTNCD                                        0198 00099000
*     END;                          /*                       @SA72421*/ 00100000
         EJECT                                                          00101000
*                                                                  0200 00102000
*   /*****************************************************************/ 00103000
*   /*                                                               */ 00104000
*   /* IF JCL OK THEN LOCATE ASSEM ENTRY ON CDS AND CALL HMASMBUE TO */ 00105000
*   /* CREATE BACKUP COPY ON SCDS                            @Z67SP00*/ 00106000
*   /*                                                               */ 00107000
*   /*****************************************************************/ 00108000
*                                                                  0200 00109000
*   IF ASMRTNCD=ZERO                /*                       @Z67SP00*/ 00110000
*     THEN                          /*                       @Z67SP00*/ 00111000
@RF00195 CLI   ASMRTNCD,0                                          0200 00112000
         BNE   @RF00200                                            0200 00113000
*     DO;                           /*                       @Z67SP00*/ 00114000
*       IOPFUNCT=IOPLOC;            /*                       @Z67SP00*/ 00115000
         MVI   IOPFUNCT(IOPPTR),X'03'                              0202 00116000
*       IOPDSID=IOPCDS;             /*                       @Z67SP00*/ 00117000
         MVI   IOPDSID(IOPPTR),X'02'                               0203 00118000
*       IOPNAME=MODNAME;            /*                       @Z67SP00*/ 00119000
         MVC   IOPNAME(8,IOPPTR),MODNAME                           0204 00120000
*       IOPTYPE=IOPASM;             /*                       @Z67SP00*/ 00121000
         MVI   IOPTYPE(IOPPTR),X'01'                               0205 00122000
*       CALL HMASMIO(HMASMIOP);     /* LOC ASSEM             @Z67SP00*/ 00123000
         ST    IOPPTR,@AL00001                                     0206 00124000
         L     @15,@CV01381                                        0206 00125000
         LA    @01,@AL00001                                        0206 00126000
         BALR  @14,@15                                             0206 00127000
*       IF IOPRETRN=IOPGOOD         /* IF FOUND              @Z67SP00*/ 00128000
*         THEN                      /*                       @Z67SP00*/ 00129000
         CLI   IOPRETRN(IOPPTR),0                                  0207 00130000
         BNE   @RF00207                                            0207 00131000
*         DO;                       /*                       @Z67SP00*/ 00132000
*           BUPTYPE=BUPUPD;         /* INDICATE UPDATE OPER  @Z67SP00*/ 00133000
         L     @10,@PC00001                                        0209 00134000
         MVI   BUPTYPE(@10),X'02'                                  0209 00135000
*           CALL HMASMBUE(BUPPARM); /*                       @Z67SP00*/ 00136000
         ST    @10,@AL00001                                        0210 00137000
         L     @15,@CV01382                                        0210 00138000
         LA    @01,@AL00001                                        0210 00139000
         BALR  @14,@15                                             0210 00140000
*           RFY                                                    0211 00141000
*             RTNCODE RSTD;         /*                       @Z67SP00*/ 00142000
*           ASMRTNCD=MAX(ASMRTNCD,RTNCODE);/*                @Z67SP00*/ 00143000
         SLR   @14,@14                                             0212 00144000
         IC    @14,ASMRTNCD                                        0212 00145000
         CR    @14,RTNCODE                                         0212 00146000
         BNL   *+6                                                      00147000
         LR    @14,RTNCODE                                         0212 00148000
         STC   @14,ASMRTNCD                                        0212 00149000
*           RFY                                                    0213 00150000
*             RTNCODE UNRSTD;       /*                       @Z67SP00*/ 00151000
*         END;                      /*                       @Z67SP00*/ 00152000
*       ELSE                        /*                       @Z67SP00*/ 00153000
*         IF IOPRETRN=IOPNTFND      /* IF NOT FOUND          @Z67SP00*/ 00154000
*           THEN                    /*                       @Z67SP00*/ 00155000
         B     @RC00207                                            0215 00156000
@RF00207 CLI   IOPRETRN(IOPPTR),4                                  0215 00157000
         BNE   @RF00215                                            0215 00158000
*           DO;                     /*                       @Z67SP00*/ 00159000
*             IOPASMNT=''B;         /* ZERO ASSEM NTRY       @Z67SP00*/ 00160000
         XC    IOPASMNT(24,IOPPTR),IOPASMNT(IOPPTR)                0217 00161000
*             IOPNTLVL=IOPASMLC;    /* IN CURRENT FORMAT     @Z67SP00*/ 00162000
         MVI   IOPNTLVL(IOPPTR),X'02'                              0218 00163000
*             BUPTYPE=BUPADD;       /* INDICATE ADD OPER     @Z67SP00*/ 00164000
         L     @10,@PC00001                                        0219 00165000
         MVI   BUPTYPE(@10),X'01'                                  0219 00166000
*             CALL HMASMBUE(BUPPARM);/*                      @Z67SP00*/ 00167000
         ST    @10,@AL00001                                        0220 00168000
         L     @15,@CV01382                                        0220 00169000
         LA    @01,@AL00001                                        0220 00170000
         BALR  @14,@15                                             0220 00171000
*             RFY                                                  0221 00172000
*               RTNCODE RSTD;       /*                       @Z67SP00*/ 00173000
*             ASMRTNCD=MAX(ASMRTNCD,RTNCODE);/*              @Z67SP00*/ 00174000
         SLR   @14,@14                                             0222 00175000
         IC    @14,ASMRTNCD                                        0222 00176000
         CR    @14,RTNCODE                                         0222 00177000
         BNL   *+6                                                      00178000
         LR    @14,RTNCODE                                         0222 00179000
         STC   @14,ASMRTNCD                                        0222 00180000
*             RFY                                                  0223 00181000
*               RTNCODE UNRSTD;     /*                       @Z67SP00*/ 00182000
*           END;                    /*                       @Z67SP00*/ 00183000
*         ELSE                      /*                       @Z67SP00*/ 00184000
*           DO;                     /*                       @Z67SP00*/ 00185000
         B     @RC00215                                            0225 00186000
@RF00215 DS    0H                                                  0226 00187000
*             ASMRTNCD=MAX(ASMRTNCD,IOPRETRN);/*             @Z67SP00*/ 00188000
         SLR   @10,@10                                             0226 00189000
         IC    @10,ASMRTNCD                                        0226 00190000
         SLR   @08,@08                                             0226 00191000
         IC    @08,IOPRETRN(,IOPPTR)                               0226 00192000
         CR    @10,@08                                             0226 00193000
         BNL   *+6                                                      00194000
         LR    @10,@08                                             0226 00195000
         STC   @10,ASMRTNCD                                        0226 00196000
*             MSGTXT=LASTLINE;      /*                       @Z67SP00*/ 00197000
         MVC   MSGTXT(25),LASTLINE                                 0227 00198000
*           END;                    /*                       @Z67SP00*/ 00199000
*     END;                          /*                       @Z67SP00*/ 00200000
@RC00215 DS    0H                                                  0229 00201000
@RC00207 DS    0H                                                  0230 00202000
         EJECT                                                          00203000
*                                                                  0230 00204000
*   /*****************************************************************/ 00205000
*   /*                                                               */ 00206000
*   /* SCAN ASSEMBLY RECORDS FOR POSSIBLE MACRO CALLS. THE ASSUMPTION*/ 00207000
*   /* IS MADE THAT A VALID MACRO CALL MUST BE LONGER THAN 5         */ 00208000
*   /* CHARACTERS AND LESS THAN 9. THIS IS TO AVOID SCAN AND ANALYSIS*/ 00209000
*   /* OF EVERY VALID ASSEMBLER OP CODE. THE ONLY KNOWN EXCEPTION TO */ 00210000
*   /* THE ABOVE RULE IS THE CVT.                                    */ 00211000
*   /*                                                               */ 00212000
*   /*****************************************************************/ 00213000
*                                                                  0230 00214000
*   SEQNO=ZERO;                     /* RESET SEQUENCE NUMBER         */ 00215000
@RF00200 SLR   @10,@10                                             0230 00216000
         ST    @10,SEQNO                                           0230 00217000
*   SCPSRCH=ADDR(MACSTART);         /* INITIALIZE ARGUMENT FOR SCAN  */ 00218000
         L     @10,SCPPTR                                          0231 00219000
         LA    @08,MACSTART                                        0231 00220000
         ST    @08,SCPSRCH(,@10)                                   0231 00221000
*   SCPINLN=LENGTH(CRPBFDTA);       /* SET INPUT RECORD LEN  @Z67SP00*/ 00222000
         MVC   SCPINLN(2,@10),@CH01063                             0232 00223000
*   DO WHILE(                       /* PROCESS WHILE                 */ 00224000
*         ASMRTNCD=ZERO             /* RTNCODE IS OK         @Z67SP00*/ 00225000
*         &CRPBUFFR(1:2)^=SLASHAST  /* AND NOT EOF           @Z67SP00*/ 00226000
*         &JCLENSW=OFF              /* AND NOT JCL CARD      @Z67SP00*/ 00227000
*         &PREMSW=OFF               /* OR EOF                @Z67SP00*/ 00228000
*         );                        /*                       @Z67SP00*/ 00229000
         B     @DE00233                                            0233 00230000
@DL00233 DS    0H                                                  0234 00231000
*     IOPBUFAD=ADDR(CRPBUFFR);      /* PTR TO INPUT RCD      @Z67SP00*/ 00232000
         L     @10,@PC00001+4                                      0234 00233000
         LA    @08,CRPBUFFR(,@10)                                  0234 00234000
         ST    @08,IOPBUFAD(,IOPPTR)                               0234 00235000
*     SEQNO=SEQNO+SEQINCR;          /* BUMP SEQENCE NUMBER           */ 00236000
         LA    @08,100                                             0235 00237000
         AL    @08,SEQNO                                           0235 00238000
         ST    @08,SEQNO                                           0235 00239000
*     CVD(SEQNO,SEQPACK);           /* CONVERT NUMBER                */ 00240000
         CVD   @08,SEQPACK                                         0236 00241000
*     UNPK(SEQUENCE,SEQPACK);       /* PUT NUMBER INTO RECORD        */ 00242000
         UNPK  SEQUENCE(8,@10),SEQPACK(8)                          0237 00243000
*     LASTDIG=LASTDIG|MAKPRINT;     /* MAKE PRINTABLE                */ 00244000
         OI    LASTDIG(@10),X'F0'                                  0238 00245000
*     IOPDSID=IOPCDS;               /* INDICATE CONTROL DATA SET     */ 00246000
         MVI   IOPDSID(IOPPTR),X'02'                               0239 00247000
*     IOPFUNCT=IOPWRITE;            /* INDICATE WRITE OPERATION      */ 00248000
         MVI   IOPFUNCT(IOPPTR),X'51'                              0240 00249000
*     CALL HMASMIO(HMASMIOP);       /* WRITE ASSEMBLER RECORD TO CDS */ 00250000
         ST    IOPPTR,@AL00001                                     0241 00251000
         L     @15,@CV01381                                        0241 00252000
         LA    @01,@AL00001                                        0241 00253000
         BALR  @14,@15                                             0241 00254000
*     IF IOPRETRN^=IOPGOOD          /* SUCCESSFUL I/O?       @Z40SP00*/ 00255000
*       THEN                        /* NO - ERROR CONDITION          */ 00256000
         CLI   IOPRETRN(IOPPTR),0                                  0242 00257000
         BE    @RF00242                                            0242 00258000
*       DO;                         /*                       @SA72421*/ 00259000
*         ASMRTNCD=MAX(ASMRTNCD,STOPSMP);/*                  @Z67SP00*/ 00260000
         SLR   @10,@10                                             0244 00261000
         IC    @10,ASMRTNCD                                        0244 00262000
         LA    @08,16                                              0244 00263000
         CR    @10,@08                                             0244 00264000
         BNL   *+6                                                      00265000
         LR    @10,@08                                             0244 00266000
         STC   @10,ASMRTNCD                                        0244 00267000
*         MSGTXT=LASTLINE;          /* MSG TO WRITE          @Z67SP00*/ 00268000
         MVC   MSGTXT(25),LASTLINE                                 0245 00269000
*       END;                        /*                       @SA72421*/ 00270000
*     ELSE                          /*                       @Z67SP00*/ 00271000
*       DO;                         /*                       @Z67SP00*/ 00272000
         B     @RC00242                                            0247 00273000
@RF00242 DS    0H                                                  0248 00274000
*         IF CONTINSW=OFF           /* IS CONTINUATION PENDING?      */ 00275000
*           THEN                    /* NO - THEN OK TO SCAN          */ 00276000
         TM    CONTINSW,B'10000000'                                0248 00277000
         BNZ   @RF00248                                            0248 00278000
*           DO;                     /* GO AHEAD AND SCAN STMT        */ 00279000
*             SCPCHAR=ADDR(CRPBUFFR);/* RESET RCD ADDR       @Z67SP00*/ 00280000
         L     @10,SCPPTR                                          0250 00281000
         L     @08,@PC00001+4                                      0250 00282000
         LA    @08,CRPBUFFR(,@08)                                  0250 00283000
         ST    @08,SCPCHAR(,@10)                                   0250 00284000
*             CALL HMASMSCN(HMASMSCP);/* SCAN ASSEMBLER RECORD       */ 00285000
         ST    @10,@AL00001                                        0251 00286000
         L     @15,@CV01384                                        0251 00287000
         LA    @01,@AL00001                                        0251 00288000
         BALR  @14,@15                                             0251 00289000
*             IF SCPRET^=SCPGOOD    /* SYNTAX ERROR?         @Z40SP00*/ 00290000
*               THEN                /* YES - RETURN TO CALLER        */ 00291000
         L     @10,SCPPTR                                          0252 00292000
         CLI   SCPRET(@10),0                                       0252 00293000
         BE    @RF00252                                            0252 00294000
*               IF EXCERR=ON        /* MACRO TABLE EXCEEDED?         */ 00295000
*                 THEN              /* YES - INDICATE ERROR          */ 00296000
         TM    EXCERR,B'01000000'                                  0253 00297000
         BNO   @RF00253                                            0253 00298000
*                 DO;               /*                       @SA72421*/ 00299000
*                   ASMRTNCD=MAX(ASMRTNCD,TBLEXC);/*         @Z67SP00*/ 00300000
         SLR   @10,@10                                             0255 00301000
         IC    @10,ASMRTNCD                                        0255 00302000
         LA    @08,12                                              0255 00303000
         CR    @10,@08                                             0255 00304000
         BNL   *+6                                                      00305000
         LR    @10,@08                                             0255 00306000
         STC   @10,ASMRTNCD                                        0255 00307000
*                   MSGTXT=MACTBLEX;/* MSG TEXT              @Z67SP00*/ 00308000
         MVC   MSGTXT(25),MACTBLEX                                 0256 00309000
*                 END;              /*                       @SA72421*/ 00310000
*           END;                                                   0258 00311000
@RF00253 DS    0H                                                  0258 00312000
@RF00252 DS    0H                                                  0259 00313000
*         IF ASMRTNCD<STOPPTF       /* IF NO ERROR           @Z67SP00*/ 00314000
*           THEN                    /*                       @Z67SP00*/ 00315000
@RF00248 CLI   ASMRTNCD,8                                          0259 00316000
         BNL   @RF00259                                            0259 00317000
*           DO;                     /*                       @Z67SP00*/ 00318000
*             IF CRPBFCNT=BLANK     /* IF NOT CONTINUED      @Z67SP00*/ 00319000
*               THEN                /* YES - INDICATE NO CONTIN      */ 00320000
         L     @10,@PC00001+4                                      0261 00321000
         CLI   CRPBFCNT(@10),C' '                                  0261 00322000
         BNE   @RF00261                                            0261 00323000
*               CONTINSW=OFF;       /* TURN OFF CONTIN. SWITCH       */ 00324000
         NI    CONTINSW,B'01111111'                                0262 00325000
*             ELSE                  /* CONTINUATION IS PENDING       */ 00326000
*               CONTINSW=ON;        /* INDICATE CONTINUATION PEND    */ 00327000
         B     @RC00261                                            0263 00328000
@RF00261 OI    CONTINSW,B'10000000'                                0263 00329000
*             CALL HMASMCRD(HMASMCRP);/* READ NEXT RCD       @Z67SP00*/ 00330000
@RC00261 L     @10,@PC00001+4                                      0264 00331000
         ST    @10,@AL00001                                        0264 00332000
         L     @15,@CV01383                                        0264 00333000
         LA    @01,@AL00001                                        0264 00334000
         BALR  @14,@15                                             0264 00335000
*             IF CRPRETRN=CRPGOOD   /* IF READ OK            @Z67SP00*/ 00336000
*                 &CRPBUFFR(1:2)=TWOSLASH/* AND WAS JCL      @Z67SP00*/ 00337000
*               THEN                /*                       @Z67SP00*/ 00338000
         L     @10,@PC00001+4                                      0265 00339000
         CLI   CRPRETRN(@10),0                                     0265 00340000
         BNE   @RF00265                                            0265 00341000
         CLC   CRPBUFFR(2,@10),@CC01345                            0265 00342000
         BNE   @RF00265                                            0265 00343000
*               JCLENSW=ON;         /* SET SW                @Z67SP00*/ 00344000
         OI    JCLENSW,B'00010000'                                 0266 00345000
*             ELSE                  /*                       @Z67SP00*/ 00346000
*               IF CRPRETRN=CRPEOF  /* IF END OF FILE        @Z67SP00*/ 00347000
*                   |(CRPBUFFR(1:2)=TWOPLUS/* OR MCS         @Z67SP00*/ 00348000
*                   &CRPINDS=IOPPTS)/* ON PTS                @Z67SP00*/ 00349000
*                 THEN              /* YES - ERROR CONDITION         */ 00350000
         B     @RC00265                                            0267 00351000
@RF00265 L     @10,@PC00001+4                                      0267 00352000
         CLI   CRPRETRN(@10),4                                     0267 00353000
         BE    @RT00267                                            0267 00354000
         CLC   CRPBUFFR(2,@10),@CC01347                            0267 00355000
         BNE   @RF00267                                            0267 00356000
         CLI   CRPINDS(@10),6                                      0267 00357000
         BNE   @RF00267                                            0267 00358000
@RT00267 DS    0H                                                  0268 00359000
*                 PREMSW=ON;        /* PREMATURE EOF         @Z67SP00*/ 00360000
         OI    PREMSW,B'00001000'                                  0268 00361000
*               ELSE                /*                       @Z67SP00*/ 00362000
*                 IF CRPRETRN>CRPEOF/* I/O ERROR???          @Z40SP00*/ 00363000
*                   THEN            /* YES - ANOTHER ERROR           */ 00364000
         B     @RC00267                                            0269 00365000
@RF00267 L     @10,@PC00001+4                                      0269 00366000
         CLI   CRPRETRN(@10),4                                     0269 00367000
         BNH   @RF00269                                            0269 00368000
*                   DO;             /*                       @Z67SP00*/ 00369000
*                     MSGTXT=LASTLINE;/*                     @Z67SP00*/ 00370000
         MVC   MSGTXT(25),LASTLINE                                 0271 00371000
*                     ASMRTNCD=MAX(ASMRTNCD,STOPSMP);/*      @Z67SP00*/ 00372000
         SLR   @10,@10                                             0272 00373000
         IC    @10,ASMRTNCD                                        0272 00374000
         LA    @08,16                                              0272 00375000
         CR    @10,@08                                             0272 00376000
         BNL   *+6                                                      00377000
         LR    @10,@08                                             0272 00378000
         STC   @10,ASMRTNCD                                        0272 00379000
*                   END;            /*                       @Z67SP00*/ 00380000
*           END;                    /* END NO ERROR IN SCAN  @Z67SP00*/ 00381000
@RF00269 DS    0H                                                  0274 00382000
@RC00267 DS    0H                                                  0274 00383000
@RC00265 DS    0H                                                  0275 00384000
*       END;                        /* END WRITE OK          @Z67SP00*/ 00385000
@RF00259 DS    0H                                                  0276 00386000
*   END;                            /* END MAC LOOP          @Z67SP00*/ 00387000
@RC00242 DS    0H                                                  0276 00388000
@DE00233 CLI   ASMRTNCD,0                                          0276 00389000
         BNE   @DC00233                                            0276 00390000
         L     @10,@PC00001+4                                      0276 00391000
         CLC   CRPBUFFR(2,@10),@CC01343                            0276 00392000
         BE    @DC00233                                            0276 00393000
         TM    JCLENSW,B'00011000'                                 0276 00394000
         BZ    @DL00233                                            0276 00395000
@DC00233 DS    0H                                                  0277 00396000
         EJECT                                                          00397000
*                                                                  0277 00398000
*   /*****************************************************************/ 00399000
*   /*                                                               */ 00400000
*   /* THE ASSEMBLY HAS ALL BEEN WRITTEN TO THE CDS AND MACROS HAVE  */ 00401000
*   /* BEEN PICKED OFF THE STATEMENTS AND STORED IN AN ARRAY FIRST,  */ 00402000
*   /* THE ASSEMBLER INPUT IS STORED IN THE CDS                      */ 00403000
*   /*                                                               */ 00404000
*   /*****************************************************************/ 00405000
*                                                                  0277 00406000
*   IF ASMRTNCD<STOPPTF             /* IF NO SEVERE ERROR IN @Z67SP00*/ 00407000
*     THEN                          /* PREV ROUTINES         @Z67SP00*/ 00408000
         CLI   ASMRTNCD,8                                          0277 00409000
         BNL   @RF00277                                            0277 00410000
*     DO;                           /*                       @ZD00004*/ 00411000
*       IOPFUNCT=IOPSTOWR;          /* INDICATE STOW REPLACE         */ 00412000
         MVI   IOPFUNCT(IOPPTR),X'54'                              0279 00413000
*       CALL HMASMIO(HMASMIOP);     /* STOW CALLING BOOK IN CDS      */ 00414000
         ST    IOPPTR,@AL00001                                     0280 00415000
         L     @15,@CV01381                                        0280 00416000
         LA    @01,@AL00001                                        0280 00417000
         BALR  @14,@15                                             0280 00418000
*       IF IOPRETRN^=IOPGOOD        /* IF ERR IN STOW        @Z67SP00*/ 00419000
*         THEN                      /*                       @Z67SP00*/ 00420000
         CLI   IOPRETRN(IOPPTR),0                                  0281 00421000
         BE    @RF00281                                            0281 00422000
*         DO;                       /*                       @Z67SP00*/ 00423000
*           ASMRTNCD=MAX(ASMRTNCD,IOPRETRN);/* SAVE RC       @Z67SP00*/ 00424000
         SLR   @10,@10                                             0283 00425000
         IC    @10,ASMRTNCD                                        0283 00426000
         SLR   @08,@08                                             0283 00427000
         IC    @08,IOPRETRN(,IOPPTR)                               0283 00428000
         CR    @10,@08                                             0283 00429000
         BNL   *+6                                                      00430000
         LR    @10,@08                                             0283 00431000
         STC   @10,ASMRTNCD                                        0283 00432000
*           MSGTXT=LASTLINE;        /*                       @Z67SP00*/ 00433000
         MVC   MSGTXT(25),LASTLINE                                 0284 00434000
*         END;                      /*                       @Z67SP00*/ 00435000
*     END;                          /*                       @ZD00004*/ 00436000
@RF00281 DS    0H                                                  0287 00437000
         EJECT                                                          00438000
*                                                                  0287 00439000
*   /*****************************************************************/ 00440000
*   /*                                                               */ 00441000
*   /* IF ASSEMBLY ENTRY WAS STORED OK THEN NOW MUST UPDATE ALL      */ 00442000
*   /* RELATED MACRO ENTRIES.                                        */ 00443000
*   /*                                                               */ 00444000
*   /*****************************************************************/ 00445000
*                                                                  0287 00446000
*   BUFBASE=ADDR(MACTBL);           /* POINT TO BASE BUFFER          */ 00447000
@RF00277 LA    @10,MACTBL                                          0287 00448000
         ST    @10,BUFBASE                                         0287 00449000
*   DO I=1 TO MACCTR WHILE(         /* LOOP THROUGH MACRO LIST       */ 00450000
*         ASMRTNCD<STOPPTF          /* TILL END OR ERROR     @Z67SP00*/ 00451000
*         );                        /*                       @Z67SP00*/ 00452000
         LA    @10,1                                               0288 00453000
         B     @DE00288                                            0288 00454000
@DL00288 CLI   ASMRTNCD,8                                          0288 00455000
         BNL   @DC00288                                            0288 00456000
*     FOUND=OFF;                    /* INDICATE UPDATE MAC   @Z67SP00*/ 00457000
         NI    FOUND,B'11011111'                                   0289 00458000
*     IOPFUNCT=IOPLOC;              /* INDICATE BLDL OPERATION       */ 00459000
         MVI   IOPFUNCT(IOPPTR),X'03'                              0290 00460000
*     IOPDSID=IOPCDS;               /*                       @Z67SP00*/ 00461000
         MVI   IOPDSID(IOPPTR),X'02'                               0291 00462000
*     IOPNAME=MACCALL(I);           /* PUT MACRO NAME IN IOP         */ 00463000
         SLA   @10,3                                               0292 00464000
         L     @08,BUFBASE                                         0292 00465000
         ALR   @08,@10                                             0292 00466000
         AL    @08,@CF01456                                        0292 00467000
         MVC   IOPNAME(8,IOPPTR),MACCALL-4(@08)                    0292 00468000
*     IOPTYPE=IOPMAC;               /* INDICATE MACRO TYPE   @ZD00008*/ 00469000
         MVI   IOPTYPE(IOPPTR),X'03'                               0293 00470000
*     CALL HMASMIO(HMASMIOP);       /* LOCATE MEMBER IN THE CDS      */ 00471000
         ST    IOPPTR,@AL00001                                     0294 00472000
         L     @15,@CV01381                                        0294 00473000
         LA    @01,@AL00001                                        0294 00474000
         BALR  @14,@15                                             0294 00475000
*     IF IOPRETRN=IOPGOOD           /* SUCCESSFUL LOCATE (FOUND)     */ 00476000
*       THEN                        /* YES - CHECK IF ON LIST(CDS)   */ 00477000
         CLI   IOPRETRN(IOPPTR),0                                  0295 00478000
         BNE   @RF00295                                            0295 00479000
*       DO;                         /*                       @Z40SP00*/ 00480000
*         BUPTYPE=BUPUPD;           /* INDICATE UPDATE       @Z67SP00*/ 00481000
         L     @10,@PC00001                                        0297 00482000
         MVI   BUPTYPE(@10),X'02'                                  0297 00483000
*         DO K=1 BY 1               /* CHECK ASSEM LIST IN CDS ENTRY */ 00484000
*               WHILE IOPMACND(K)^=IOPEOLST;/* TILL END OF LIST    0298 00485000
*                                                            @ZD00004*/ 00486000
         LA    @10,1                                               0298 00487000
         STCM  @10,7,K                                             0298 00488000
         B     @DE00298                                            0298 00489000
@DL00298 DS    0H                                                  0299 00490000
*           IF IOPMCASM(K)=MODNAME  /* IF ASM FOUND IN MAC   @Z67SP00*/ 00491000
*               &IOPMCIND(K)=IOPMASMS/* AS SYSGEN ASM        @Z40SP00*/ 00492000
*             THEN                  /*                       @ZD00004*/ 00493000
         L     @10,K-1                                             0299 00494000
         LA    @10,0(,@10)                                         0299 00495000
         MH    @10,@CH00460                                        0299 00496000
         ST    @10,@TF00001                                        0299 00497000
         ALR   @10,IOPPTR                                          0299 00498000
         CLC   IOPMCASM-9(8,@10),MODNAME                           0299 00499000
         BNE   @RF00299                                            0299 00500000
         L     @10,@TF00001                                        0299 00501000
         SLR   @08,@08                                             0299 00502000
         IC    @08,IOPMCIND-9(@10,IOPPTR)                          0299 00503000
         C     @08,@CF00046                                        0299 00504000
         BNE   @RF00299                                            0299 00505000
*             FOUND=ON;             /* SET FOUND ASIS        @ZD00004*/ 00506000
         OI    FOUND,B'00100000'                                   0300 00507000
*         END;                                                     0301 00508000
@RF00299 LA    @10,1                                               0301 00509000
         L     @08,K-1                                             0301 00510000
         LA    @08,0(,@08)                                         0301 00511000
         ALR   @10,@08                                             0301 00512000
         STCM  @10,7,K                                             0301 00513000
@DE00298 L     @10,K-1                                             0301 00514000
         LA    @10,0(,@10)                                         0301 00515000
         MH    @10,@CH00460                                        0301 00516000
         SLR   @08,@08                                             0301 00517000
         IC    @08,IOPMACND-9(@10,IOPPTR)                          0301 00518000
         C     @08,@CF00648                                        0301 00519000
         BNE   @DL00298                                            0301 00520000
*       END;                        /* END MAC FOUND         @Z67SP00*/ 00521000
*     ELSE                          /*                       @Z67SP00*/ 00522000
*       IF IOPRETRN=IOPNTFND        /* IF MACRO NOT FOUND    @Z67SP00*/ 00523000
*         THEN                      /* CDS THEN MUST         @Z67SP00*/ 00524000
         B     @RC00295                                            0303 00525000
@RF00295 CLI   IOPRETRN(IOPPTR),4                                  0303 00526000
         BNE   @RF00303                                            0303 00527000
*         DO;                       /* INITIALIZE ENTRY      @Z67SP00*/ 00528000
*           K=1;                    /* INDEX TO FIRST ENTRY  @Z40SP00*/ 00529000
         MVC   K(3),@CF00046+1                                     0305 00530000
*           BUPTYPE=BUPADD;         /* INDICATE ADD ENTRY    @Z67SP00*/ 00531000
         L     @10,@PC00001                                        0306 00532000
         MVI   BUPTYPE(@10),X'01'                                  0306 00533000
*           IOPMACNT=''B;           /* ZERO ENTRY            @ZD00004*/ 00534000
         XC    IOPMACNT(104,IOPPTR),IOPMACNT(IOPPTR)               0307 00535000
*           IOPNTLVL=IOPMACLC;      /* CURRENT LEVEL         @ZD00004*/ 00536000
         MVI   IOPNTLVL(IOPPTR),X'03'                              0308 00537000
*           IOPFMID=BLANK;          /* BLANK FMID            @Z67SP00*/ 00538000
         MVI   IOPFMID+1(IOPPTR),C' '                              0309 00539000
         MVC   IOPFMID+2(5,IOPPTR),IOPFMID+1(IOPPTR)               0309 00540000
         MVI   IOPFMID(IOPPTR),C' '                                0309 00541000
*           IOPRMID=BLANK;          /* BLANK RMID FIELD      @ZD00008*/ 00542000
         MVI   IOPRMID+1(IOPPTR),C' '                              0310 00543000
         MVC   IOPRMID+2(5,IOPPTR),IOPRMID+1(IOPPTR)               0310 00544000
         MVI   IOPRMID(IOPPTR),C' '                                0310 00545000
*           IOPMCLNG=IOPMCASI;      /* ASSEMBLER LANGUAGE    @Z40SP00*/ 00546000
         MVI   IOPMCLNG(IOPPTR),X'00'                              0311 00547000
*           IOPMCDLB=BLANK;         /* NO DISTLIB            @Z40SP00*/ 00548000
         MVI   IOPMCDLB+1(IOPPTR),C' '                             0312 00549000
         MVC   IOPMCDLB+2(6,IOPPTR),IOPMCDLB+1(IOPPTR)             0312 00550000
         MVI   IOPMCDLB(IOPPTR),C' '                               0312 00551000
*           IOPMCSYS=BLANK;         /* NO TARGET LIBRARY     @Z40SP00*/ 00552000
         MVI   IOPMCSYS+1(IOPPTR),C' '                             0313 00553000
         MVC   IOPMCSYS+2(6,IOPPTR),IOPMCSYS+1(IOPPTR)             0313 00554000
         MVI   IOPMCSYS(IOPPTR),C' '                               0313 00555000
*         END;                      /*                       @Z67SP00*/ 00556000
*       ELSE                        /* NOT NOT-FOUND         @Z67SP00*/ 00557000
*         DO;                       /*                       @Z67SP00*/ 00558000
         B     @RC00303                                            0315 00559000
@RF00303 DS    0H                                                  0316 00560000
*           ASMRTNCD=MAX(ASMRTNCD,IOPRETRN);/* SAVE RC       @Z67SP00*/ 00561000
         SLR   @10,@10                                             0316 00562000
         IC    @10,ASMRTNCD                                        0316 00563000
         SLR   @08,@08                                             0316 00564000
         IC    @08,IOPRETRN(,IOPPTR)                               0316 00565000
         CR    @10,@08                                             0316 00566000
         BNL   *+6                                                      00567000
         LR    @10,@08                                             0316 00568000
         STC   @10,ASMRTNCD                                        0316 00569000
*           MSGTXT=LASTLINE;        /*                       @Z67SP00*/ 00570000
         MVC   MSGTXT(25),LASTLINE                                 0317 00571000
*         END;                      /*                       @Z67SP00*/ 00572000
*                                                                  0319 00573000
*     /***************************************************************/ 00574000
*     /*                                                             */ 00575000
*     /* IF NO SEVERE ERRORS IN LOCATE AND MACRO WAS EITHER ADDED OR */ 00576000
*     /* UPDATED THIS TIME THEN STORE BACKUP COPY ON SCDS IF         */ 00577000
*     /* REQUIRED, UPDATE MACRO, AND STOW ON CDS             @Z67SP00*/ 00578000
*     /*                                                             */ 00579000
*     /***************************************************************/ 00580000
*                                                                  0319 00581000
*     IF FOUND=OFF                  /* IF MAC WAS UPDDATED   @Z67SP00*/ 00582000
*         &ASMRTNCD<STOPPTF         /* AND NO ERRORS         @Z67SP00*/ 00583000
*       THEN                        /*                       @Z67SP00*/ 00584000
@RC00303 DS    0H                                                  0319 00585000
@RC00295 TM    FOUND,B'00100000'                                   0319 00586000
         BNZ   @RF00319                                            0319 00587000
         CLI   ASMRTNCD,8                                          0319 00588000
         BNL   @RF00319                                            0319 00589000
*       DO;                         /*                       @Z67SP00*/ 00590000
*         CALL HMASMBUE(BUPPARM);   /* CREATE BACKUP ENTRY   @Z67SP00*/ 00591000
         L     @10,@PC00001                                        0321 00592000
         ST    @10,@AL00001                                        0321 00593000
         L     @15,@CV01382                                        0321 00594000
         LA    @01,@AL00001                                        0321 00595000
         BALR  @14,@15                                             0321 00596000
*         RFY                                                      0322 00597000
*           RTNCODE RSTD;           /*                       @Z67SP00*/ 00598000
*         ASMRTNCD=MAX(ASMRTNCD,RTNCODE);/* SAVE RC          @Z67SP00*/ 00599000
         SLR   @14,@14                                             0323 00600000
         IC    @14,ASMRTNCD                                        0323 00601000
         CR    @14,RTNCODE                                         0323 00602000
         BNL   *+6                                                      00603000
         LR    @14,RTNCODE                                         0323 00604000
         STC   @14,ASMRTNCD                                        0323 00605000
*         RFY                                                      0324 00606000
*           RTNCODE UNRSTD;         /*                       @Z67SP00*/ 00607000
*         IF ASMRTNCD=ZERO          /* IF BACKUP OK          @Z67SP00*/ 00608000
*           THEN                    /*                       @Z67SP00*/ 00609000
         CLI   ASMRTNCD,0                                          0325 00610000
         BNE   @RF00325                                            0325 00611000
*           DO;                     /*                       @Z67SP00*/ 00612000
*             IOPMCASM(K)=MODNAME;  /* ADD THIS ASSEMBLY     @Z40SP00*/ 00613000
         L     @10,K-1                                             0327 00614000
         LA    @10,0(,@10)                                         0327 00615000
         MH    @10,@CH00460                                        0327 00616000
         ST    @10,@TF00001                                        0327 00617000
         ALR   @10,IOPPTR                                          0327 00618000
         MVC   IOPMCASM-9(8,@10),MODNAME                           0327 00619000
*             IOPMCIND(K)=IOPMASMS; /* SYGEN ASSEMBLY        @ZD00004*/ 00620000
         LA    @10,1                                               0328 00621000
         L     @08,@TF00001                                        0328 00622000
         STC   @10,IOPMCIND-9(@08,IOPPTR)                          0328 00623000
*             IOPMACND(K+1)=IOPEOLST;/* INDICATE END OF LS   @ZD00004*/ 00624000
         LA    @10,255                                             0329 00625000
         L     @08,@TF00001                                        0329 00626000
         STC   @10,IOPMACND(@08,IOPPTR)                            0329 00627000
*             IOPFUNCT=IOPSTOWR;    /* INDICATE STOW OPERATION       */ 00628000
         MVI   IOPFUNCT(IOPPTR),X'54'                              0330 00629000
*             CALL HMASMIO(HMASMIOP);/* STOW UPDATE MACRO ENTRY      */ 00630000
         ST    IOPPTR,@AL00001                                     0331 00631000
         L     @15,@CV01381                                        0331 00632000
         LA    @01,@AL00001                                        0331 00633000
         BALR  @14,@15                                             0331 00634000
*             IF IOPRETRN^=IOPGOOD  /* SUCCESSFUL STOW?      @Z40SP00*/ 00635000
*               THEN                /* NO - EXIT BADLY               */ 00636000
         CLI   IOPRETRN(IOPPTR),0                                  0332 00637000
         BE    @RF00332                                            0332 00638000
*               DO;                 /*                       @Z67SP00*/ 00639000
*                 ASMRTNCD=MAX(ASMRTNCD,IOPRETRN);/* SAVE RC @Z67SP00*/ 00640000
         SLR   @10,@10                                             0334 00641000
         IC    @10,ASMRTNCD                                        0334 00642000
         SLR   @08,@08                                             0334 00643000
         IC    @08,IOPRETRN(,IOPPTR)                               0334 00644000
         CR    @10,@08                                             0334 00645000
         BNL   *+6                                                      00646000
         LR    @10,@08                                             0334 00647000
         STC   @10,ASMRTNCD                                        0334 00648000
*                 MSGTXT=LASTLINE;  /* TXT FOR ERR MSG       @Z67SP00*/ 00649000
         MVC   MSGTXT(25),LASTLINE                                 0335 00650000
*               END;                /*                       @Z67SP00*/ 00651000
*           END;                    /* END BACKUP OK         @Z67SP00*/ 00652000
@RF00332 DS    0H                                                  0338 00653000
*       END;                                                       0338 00654000
@RF00325 DS    0H                                                  0339 00655000
*     IF I=MACCTR                   /* IF AT LAST MAC IN     @Z67SP00*/ 00656000
*         &MACNXT^=ZERO             /* BUFFER AND THIS IS    @Z67SP00   00657000
*                                      NOT LAST BUFFER       @Z67SP00*/ 00658000
*       THEN                        /* THEN RESET COUNT OF   @Z67SP00*/ 00659000
@RF00319 L     @10,BUFBASE                                         0339 00660000
         L     @08,I-1                                             0339 00661000
         LA    @08,0(,@08)                                         0339 00662000
         SLR   @15,@15                                             0339 00663000
         IC    @15,MACCTR(,@10)                                    0339 00664000
         CR    @08,@15                                             0339 00665000
         BNE   @RF00339                                            0339 00666000
         SLR   @08,@08                                             0339 00667000
         ICM   @08,7,MACNXT(@10)                                   0339 00668000
         LTR   @08,@08                                             0339 00669000
         BZ    @RF00339                                            0339 00670000
*       DO;                         /* RCD LEFT TO ZERO TO   @Z67SP00*/ 00671000
*         I=ZERO;                   /* CONTINUE OUTTER LOOP  @Z67SP00*/ 00672000
         SLR   @10,@10                                             0341 00673000
         STCM  @10,7,I                                             0341 00674000
*         BUFBASE=MACNXT;           /* AND POINT TO NEXT BUFFER      */ 00675000
         ST    @08,BUFBASE                                         0342 00676000
*       END;                        /*                               */ 00677000
*   END;                            /*                       @Z67SP00*/ 00678000
@RF00339 LA    @10,1                                               0344 00679000
         L     @08,I-1                                             0344 00680000
         LA    @08,0(,@08)                                         0344 00681000
         ALR   @10,@08                                             0344 00682000
@DE00288 STCM  @10,7,I                                             0344 00683000
         L     @08,BUFBASE                                         0344 00684000
         SLR   @15,@15                                             0344 00685000
         IC    @15,MACCTR(,@08)                                    0344 00686000
         CR    @10,@15                                             0344 00687000
         BNH   @DL00288                                            0344 00688000
@DC00288 DS    0H                                                  0345 00689000
         EJECT                                                          00690000
*                                                                  0345 00691000
*   /*****************************************************************/ 00692000
*   /*                                                               */ 00693000
*   /* NO MORE MACROS IN BUFFER, WRITE ERROR MESSAGE IF REQUIRED THEN*/ 00694000
*   /* FREE ALL BUFFERS                                      @Z67SP00*/ 00695000
*   /*                                                               */ 00696000
*   /*****************************************************************/ 00697000
*                                                                  0345 00698000
*   IF ASMRTNCD>=STOPPTF            /* IF ERR IN PROCESS     @Z67SP00*/ 00699000
*     THEN                          /*                       @Z67SP00*/ 00700000
         CLI   ASMRTNCD,8                                          0345 00701000
         BL    @RF00345                                            0345 00702000
*     DO;                           /* MESSAGE SET UP        @Z67SP00*/ 00703000
*       RFY                                                        0347 00704000
*         RTNCODE RSTD;             /*                       @Z67SP00*/ 00705000
*       IF MSGTXT=MODERR            /* IF ERR IN JCL         @Z67SP00*/ 00706000
*         THEN                      /*                       @Z67SP00*/ 00707000
         CLC   MSGTXT(25),MODERR                                   0348 00708000
         BNE   @RF00348                                            0348 00709000
*         CALL HMAASMR(BUFFER(1),MSGTXT);/*                  @Z67SP00*/ 00710000
         L     @14,@PC00001+8                                      0349 00711000
         ST    @14,@AL00001                                        0349 00712000
         LA    @14,MSGTXT                                          0349 00713000
         ST    @14,@AL00001+4                                      0349 00714000
         LA    @01,@AL00001                                        0349 00715000
         BAL   @14,HMAASMR                                         0349 00716000
*       ELSE                        /*                       @Z67SP00*/ 00717000
*         CALL HMAASMR(CRPBUFFR,MSGTXT);/* WRITE MSG         @Z67SP00*/ 00718000
         B     @RC00348                                            0350 00719000
@RF00348 L     @14,@PC00001+4                                      0350 00720000
         LA    @14,CRPBUFFR(,@14)                                  0350 00721000
         ST    @14,@AL00001                                        0350 00722000
         LA    @14,MSGTXT                                          0350 00723000
         ST    @14,@AL00001+4                                      0350 00724000
         LA    @01,@AL00001                                        0350 00725000
         BAL   @14,HMAASMR                                         0350 00726000
*       ASMRTNCD=MAX(ASMRTNCD,RTNCODE);/* SAVE RC            @Z67SP00*/ 00727000
@RC00348 SLR   @14,@14                                             0351 00728000
         IC    @14,ASMRTNCD                                        0351 00729000
         CR    @14,RTNCODE                                         0351 00730000
         BNL   *+6                                                      00731000
         LR    @14,RTNCODE                                         0351 00732000
         STC   @14,ASMRTNCD                                        0351 00733000
*       RFY                                                        0352 00734000
*         RTNCODE UNRSTD;           /*                       @Z67SP00*/ 00735000
*     END;                          /*                       @Z67SP00*/ 00736000
*   BUFBASE=ADDR(MACTBL);           /* SET TO BASE BUFFER            */ 00737000
@RF00345 LA    @10,MACTBL                                          0354 00738000
         ST    @10,BUFBASE                                         0354 00739000
*   BUFBASE=MACNXT;                 /* NOW TO NEXT BUFFER            */ 00740000
         SLR   @08,@08                                             0355 00741000
         ICM   @08,7,MACNXT(@10)                                   0355 00742000
         ST    @08,BUFBASE                                         0355 00743000
*   DO WHILE BUFBASE^=ZERO;         /* LOOP THRU ALL GM'D BUFFERS    */ 00744000
         B     @DE00356                                            0356 00745000
@DL00356 DS    0H                                                  0357 00746000
*     NXTBUF=BUFBASE;               /* SET ADDRESS TO FREEMAIN       */ 00747000
         L     @10,BUFBASE                                         0357 00748000
         ST    @10,NXTBUF                                          0357 00749000
*     BUFBASE=MACNXT;               /* PICK UP CHAINED BUFFER        */ 00750000
         SLR   @08,@08                                             0358 00751000
         ICM   @08,7,MACNXT(@10)                                   0358 00752000
         ST    @08,BUFBASE                                         0358 00753000
*     GEN(FREEMAIN     E,LV=84,A=NXTBUF)                           0359 00754000
*     REFS(NXTBUF);                 /*                       @Z40SP00*/ 00755000
         FREEMAIN     E,LV=84,A=NXTBUF                                  00756000
*   END;                                                           0360 00757000
@DE00356 SLR   @10,@10                                             0360 00758000
         C     @10,BUFBASE                                         0360 00759000
         BNE   @DL00356                                            0360 00760000
*   BUFBASE=ADDR(MACTBL);           /* RESET TO BASE BUFFER          */ 00761000
         LA    @08,MACTBL                                          0361 00762000
         ST    @08,BUFBASE                                         0361 00763000
*   MACCTR=ZERO;                    /* CLEAR COUNTER                 */ 00764000
         MVI   MACCTR(@08),X'00'                                   0362 00765000
*   MACNXT=ZERO;                    /* CLEAR CHAIN POINTER           */ 00766000
*                                                                  0363 00767000
         STCM  @10,7,MACNXT(@08)                                   0363 00768000
*   /*****************************************************************/ 00769000
*   /*                                                               */ 00770000
*   /* RETURN TO CALLER                                      @Z67SP00*/ 00771000
*   /*                                                               */ 00772000
*   /*****************************************************************/ 00773000
*                                                                  0364 00774000
*   IOPBUFAD=SAVBUFAD;              /*                       @Z67SP00*/ 00775000
         L     @10,SAVBUFAD                                        0364 00776000
         ST    @10,IOPBUFAD(,IOPPTR)                               0364 00777000
*   IF ASMRTNCD=ZERO                /*                       @Z67SP00*/ 00778000
*     THEN                          /*                       @Z67SP00*/ 00779000
         CLI   ASMRTNCD,0                                          0365 00780000
         BNE   @RF00365                                            0365 00781000
*     DO;                           /*                       @Z67SP00*/ 00782000
*       IF JCLENSW=ON               /*                       @Z67SP00*/ 00783000
*         THEN                      /*                       @Z67SP00*/ 00784000
         TM    JCLENSW,B'00010000'                                 0367 00785000
         BNO   @RF00367                                            0367 00786000
*         ASMRTNCD=JCLENC;          /*                       @Z67SP00*/ 00787000
         MVI   ASMRTNCD,X'06'                                      0368 00788000
*       ELSE                        /*                       @Z67SP00*/ 00789000
*         IF PREMSW=ON              /*                       @Z67SP00*/ 00790000
*           THEN                    /*                       @Z67SP00*/ 00791000
         B     @RC00367                                            0369 00792000
@RF00367 TM    PREMSW,B'00001000'                                  0369 00793000
         BNO   @RF00369                                            0369 00794000
*           ASMRTNCD=PREMEOF;       /*                       @Z67SP00*/ 00795000
         MVI   ASMRTNCD,X'0E'                                      0370 00796000
*     END;                          /*                       @Z67SP00*/ 00797000
@RF00369 DS    0H                                                  0371 00798000
@RC00367 DS    0H                                                  0372 00799000
*   RETURN CODE(ASMRTNCD);          /* EXIT WITH GOOD RETURN CODE    */ 00800000
@RF00365 SLR   @15,@15                                             0372 00801000
         IC    @15,ASMRTNCD                                        0372 00802000
         L     @13,4(,@13)                                         0372 00803000
         L     @14,12(,@13)                                        0372 00804000
         LM    @00,@12,20(@13)                                     0372 00805000
         BR    @14                                                 0372 00806000
         EJECT                                                          00807000
*                                                                  0373 00808000
*   /*****************************************************************/ 00809000
*   /*                                                               */ 00810000
*   /* THE FOLLOWING SUBROUTINE IS ENTERED FROM SCAN TO INCREMENT THE*/ 00811000
*   /* SCAN PTR FOR JCL SEARCH.                                      */ 00812000
*   /*                                                               */ 00813000
*   /*****************************************************************/ 00814000
*                                                                  0373 00815000
*BUMP010:                                                          0373 00816000
*   PROCEDURE;                                                     0373 00817000
@EL00001 L     @13,4(,@13)                                         0373 00818000
@EF00001 DS    0H                                                  0373 00819000
@ER00001 LM    @14,@12,12(@13)                                     0373 00820000
         BR    @14                                                 0373 00821000
BUMP010  STM   @14,@12,12(@13)                                     0373 00822000
*   IF SCPSTRNG(1)=IOPEOLST         /* END OF JCL BUFFER?    @Z40SP00*/ 00823000
*     THEN                          /* YES - ERROR CONDITION         */ 00824000
         L     @10,SCPPTR                                          0374 00825000
         L     @08,SCPCHAR(,@10)                                   0374 00826000
         CLI   SCPSTRNG(@08),255                                   0374 00827000
         BNE   @RF00374                                            0374 00828000
*     SCPRET=SCPSTOP;               /* INDICATE ERROR        @Z40SP00*/ 00829000
         MVI   SCPRET(@10),X'08'                                   0375 00830000
*   IF SCPPMLN=ZERO                 /* IF PASSBACK LENGTH IS ZERO    */ 00831000
*     THEN                          /* THEN BUMP SO NO LOOP OCCURS   */ 00832000
@RF00374 L     @10,SCPPTR                                          0376 00833000
         LH    @08,SCPPMLN(,@10)                                   0376 00834000
         LTR   @08,@08                                             0376 00835000
         BNZ   @RF00376                                            0376 00836000
*     SCPPMLN=1;                    /* RESET LENGTH          @Z40SP00*/ 00837000
         MVC   SCPPMLN(2,@10),@CH00046                             0377 00838000
*   END BUMP010;                    /* RETURN TO CONTINUE SCAN       */ 00839000
*                                                                  0378 00840000
@EL00002 DS    0H                                                  0378 00841000
@EF00002 DS    0H                                                  0378 00842000
@ER00002 LM    @14,@12,12(@13)                                     0378 00843000
         BR    @14                                                 0378 00844000
*   /*****************************************************************/ 00845000
*   /*                                                               */ 00846000
*   /* THE FOLLOWING SUBROUTINE IS ENTERED TO SAVE THE MODULE WHEN   */ 00847000
*   /* FOUND IN THE SEARCH OF THE JCL. SCAN STOPS AT THIS POINT.     */ 00848000
*   /*                                                               */ 00849000
*   /*****************************************************************/ 00850000
*                                                                  0379 00851000
*SAVMOD10:                                                         0379 00852000
*   PROCEDURE;                                                     0379 00853000
SAVMOD10 STM   @14,@12,12(@13)                                     0379 00854000
*   MODNAME=SCPSTRNG(1:SCPPMLN);    /* SAVE MODULE NAME      @Z40SP00*/ 00855000
         MVI   MODNAME+1,C' '                                      0380 00856000
         MVC   MODNAME+2(6),MODNAME+1                              0380 00857000
         L     @10,SCPPTR                                          0380 00858000
         LH    @08,SCPPMLN(,@10)                                   0380 00859000
         BCTR  @08,0                                               0380 00860000
         L     @10,SCPCHAR(,@10)                                   0380 00861000
         EX    @08,@SM01458                                        0380 00862000
*   END SAVMOD10;                   /* RETURN TO SCAN                */ 00863000
*                                                                  0381 00864000
@EL00003 DS    0H                                                  0381 00865000
@EF00003 DS    0H                                                  0381 00866000
@ER00003 LM    @14,@12,12(@13)                                     0381 00867000
         BR    @14                                                 0381 00868000
*   /*****************************************************************/ 00869000
*   /*                                                               */ 00870000
*   /* THE FOLLOWING SUBROUTINE IS INVOKED FROM SCAN OF ASSEMBLER    */ 00871000
*   /* INPUT FOR THE PURPOSE OF LABEL VERIFICATION. COMMENTS, AND    */ 00872000
*   /* OTHER UNLIKELY CANDIDATES FOR MACRO CALLS ARE ELIMINATED HERE.*/ 00873000
*   /*                                                               */ 00874000
*   /*****************************************************************/ 00875000
*                                                                  0382 00876000
*LABELCK:                                                          0382 00877000
*   PROCEDURE;                                                     0382 00878000
LABELCK  STM   @14,@12,12(@13)                                     0382 00879000
*   IF SCPPMLN=ZERO                 /* ZERO LABEL LENGTH?            */ 00880000
*     THEN                          /* YES - NON-ALPHANUMERIC        */ 00881000
         L     @10,SCPPTR                                          0383 00882000
         LH    @08,SCPPMLN(,@10)                                   0383 00883000
         LTR   @08,@08                                             0383 00884000
         BNZ   @RF00383                                            0383 00885000
*     SCPRET=SCPNDSCN;              /* SKIP IT..NOT CAND.    @Z40SP00*/ 00886000
         MVI   SCPRET(@10),X'04'                                   0384 00887000
*   END LABELCK;                    /* RETURN TO SCAN                */ 00888000
@EL00004 DS    0H                                                  0385 00889000
@EF00004 DS    0H                                                  0385 00890000
@ER00004 LM    @14,@12,12(@13)                                     0385 00891000
         BR    @14                                                 0385 00892000
         EJECT                                                          00893000
*                                                                  0386 00894000
*   /*****************************************************************/ 00895000
*   /*                                                               */ 00896000
*   /* THE FOLLOWING SUBROUTINE IS INVOKED FROM SCAN OF ASSEMBLER    */ 00897000
*   /* INPUT FOR THE PURPOSE OF SAVING MACRO CALLS IN AN ARRAY       */ 00898000
*   /*                                                               */ 00899000
*   /*****************************************************************/ 00900000
*                                                                  0386 00901000
*MACSV010:                                                         0386 00902000
*   PROCEDURE;                                                     0386 00903000
MACSV010 STM   @14,@12,@SA00005                                    0386 00904000
*   IF(SCPPMLN<=HIGHLIM             /* HIGH LIMIT EXCEEDED?          */ 00905000
*       &SCPPMLN>=LOWLIM)           /* LOW LIMIT EXCEEDED?           */ 00906000
*       |SCPSTRNG(1:LENGTH(CVT))=CVT/* OR WAS THIS CVT       @Z40SP00*/ 00907000
*     THEN                          /* WANT TO LOOK AT THIS ONE      */ 00908000
         L     @10,SCPPTR                                          0387 00909000
         LH    @10,SCPPMLN(,@10)                                   0387 00910000
         C     @10,@CF00041                                        0387 00911000
         BH    @GL00010                                            0387 00912000
         C     @10,@CF00064                                        0387 00913000
         BNL   @RT00387                                            0387 00914000
@GL00010 L     @10,SCPPTR                                          0387 00915000
         L     @10,SCPCHAR(,@10)                                   0387 00916000
         CLC   SCPSTRNG(4,@10),@CC01351                            0387 00917000
         BNE   @RF00387                                            0387 00918000
@RT00387 DS    0H                                                  0388 00919000
*     DO;                           /* ADD MACRO TO THE LIST         */ 00920000
*       MACSAVE=SCPSTRNG(1:SCPPMLN);/* SAVE THE NAME         @Z40SP00*/ 00921000
         MVI   MACSAVE+1,C' '                                      0389 00922000
         MVC   MACSAVE+2(6),MACSAVE+1                              0389 00923000
         L     @10,SCPPTR                                          0389 00924000
         LH    @08,SCPPMLN(,@10)                                   0389 00925000
         BCTR  @08,0                                               0389 00926000
         L     @10,SCPCHAR(,@10)                                   0389 00927000
         EX    @08,@SM01460                                        0389 00928000
*       BUFBASE=ADDR(MACTBL);       /* SET TO BASE BUFFER            */ 00929000
         LA    @10,MACTBL                                          0390 00930000
         ST    @10,BUFBASE                                         0390 00931000
*MACLOOP:                                                          0391 00932000
*       DO I=1 TO MACCTR;           /* LOOK AT ALL NAMES IN BUFFER   */ 00933000
MACLOOP  LA    @10,1                                               0391 00934000
         B     @DE00391                                            0391 00935000
@DL00391 DS    0H                                                  0392 00936000
*         IF MACCALL(I)=MACSAVE     /* IS IT THE SAME NAME ?         */ 00937000
*           THEN                                                   0392 00938000
         LR    @08,@10                                             0392 00939000
         SLA   @08,3                                               0392 00940000
         L     @01,BUFBASE                                         0392 00941000
         ALR   @01,@08                                             0392 00942000
         AL    @01,@CF01456                                        0392 00943000
         CLC   MACCALL-4(8,@01),MACSAVE                            0392 00944000
         BE    @RT00392                                            0392 00945000
*           RETURN;                 /* YES - RETURN TO SCAN          */ 00946000
*       END;                                                       0394 00947000
         AL    @10,@CF00046                                        0394 00948000
@DE00391 STCM  @10,7,I                                             0394 00949000
         L     @08,BUFBASE                                         0394 00950000
         SLR   @15,@15                                             0394 00951000
         IC    @15,MACCTR(,@08)                                    0394 00952000
         CR    @10,@15                                             0394 00953000
         BNH   @DL00391                                            0394 00954000
*       IF MACCTR=MACLIM            /* OUT OF ROOM IN THIS BUFFER ?  */ 00955000
*         THEN                                                     0395 00956000
         L     @10,BUFBASE                                         0395 00957000
         CLI   MACCTR(@10),10                                      0395 00958000
         BNE   @RF00395                                            0395 00959000
*         DO;                                                      0396 00960000
*           IF MACNXT^=ZERO         /* IS THERE A NEXT BUFFER ?      */ 00961000
*             THEN                                                 0397 00962000
         SLR   @08,@08                                             0397 00963000
         ICM   @08,7,MACNXT(@10)                                   0397 00964000
         LTR   @08,@08                                             0397 00965000
         BZ    @RF00397                                            0397 00966000
*             DO;                                                  0398 00967000
*               BUFBASE=MACNXT;     /* POINT TO NEXT BUFFER          */ 00968000
         ST    @08,BUFBASE                                         0399 00969000
*               GO TO MACLOOP;      /* YES - CONTINUE                */ 00970000
         B     MACLOOP                                             0400 00971000
*             END;                                                 0401 00972000
*           ELSE                                                   0402 00973000
*             DO;                   /*                       @ZD00003*/ 00974000
@RF00397 DS    0H                                                  0403 00975000
*               GEN(GETMAIN EC,LV=84,A=NXTBUF)                     0403 00976000
*               REFS(NXTBUF);       /*                       @Z40SP00*/ 00977000
         GETMAIN EC,LV=84,A=NXTBUF                                      00978000
*               RFY                                                0404 00979000
*                 RTNCODE RSTD;     /*                       @Z67SP00*/ 00980000
*               IF RTNCODE^=ZERO    /* IS STORAGE AVAILABLE ?        */ 00981000
*                 THEN                                             0405 00982000
         LTR   RTNCODE,RTNCODE                                     0405 00983000
         BZ    @RF00405                                            0405 00984000
*                 DO;               /* NO - SET UP FOR ERROR         */ 00985000
*                   EXCERR=ON;      /* SET ERROR INDICATOR           */ 00986000
         OI    EXCERR,B'01000000'                                  0407 00987000
*                   SCPRET=SCPSTOP; /* STOP SCAN             @Z40SP00*/ 00988000
         L     @14,SCPPTR                                          0408 00989000
         MVI   SCPRET(@14),X'08'                                   0408 00990000
*                   RETURN;         /* RETURN TO SCAN                */ 00991000
@EL00005 DS    0H                                                  0409 00992000
@EF00005 DS    0H                                                  0409 00993000
@ER00005 LM    @14,@12,@SA00005                                    0409 00994000
         BR    @14                                                 0409 00995000
*                 END;                                             0410 00996000
*               RFY                                                0411 00997000
*                 RTNCODE UNRSTD;   /*                       @Z67SP00*/ 00998000
@RF00405 DS    0H                                                  0412 00999000
*               MACNXT=NXTBUF;      /* CHAIN IN THE NEW BUFFER       */ 01000000
         L     @10,NXTBUF                                          0412 01001000
         L     @08,BUFBASE                                         0412 01002000
         STCM  @10,7,MACNXT(@08)                                   0412 01003000
*               BUFBASE=MACNXT;     /* PICK UP ADDRESSABILITY        */ 01004000
         ST    @10,BUFBASE                                         0413 01005000
*               MACCTR=ZERO;        /* RESET NAME COUNTER            */ 01006000
         MVI   MACCTR(@10),X'00'                                   0414 01007000
*               MACNXT=ZERO;        /* AND ITS CHAIN POINTER         */ 01008000
         SLR   @08,@08                                             0415 01009000
         STCM  @08,7,MACNXT(@10)                                   0415 01010000
*             END;                                                 0416 01011000
*         END;                                                     0417 01012000
*       MACCTR=MACCTR+1;            /* BUMP THE NAME COUNT           */ 01013000
@RF00395 L     @10,BUFBASE                                         0418 01014000
         LA    @08,1                                               0418 01015000
         SLR   @15,@15                                             0418 01016000
         IC    @15,MACCTR(,@10)                                    0418 01017000
         ALR   @08,@15                                             0418 01018000
         STC   @08,MACCTR(,@10)                                    0418 01019000
*       MACCALL(MACCTR)=MACSAVE;    /* INSERT THE NAME               */ 01020000
         SLA   @08,3                                               0419 01021000
         ALR   @10,@08                                             0419 01022000
         AL    @10,@CF01456                                        0419 01023000
         MVC   MACCALL-4(8,@10),MACSAVE                            0419 01024000
*     END;                                                         0420 01025000
*   ELSE                            /* INDICATE STOP SCAN            */ 01026000
*     SCPRET=SCPNDSCN;              /* INDICATE NO MAC CALL  @Z40SP00*/ 01027000
         B     @RC00387                                            0421 01028000
@RF00387 L     @10,SCPPTR                                          0421 01029000
         MVI   SCPRET(@10),X'04'                                   0421 01030000
*   END MACSV010;                   /* RETURN TO SCAN                */ 01031000
         B     @EL00005                                            0422 01032000
         EJECT                                                          01033000
*                                                                  0423 01034000
*   /*****************************************************************/ 01035000
*   /*                                                               */ 01036000
*   /* ROUTINE TO PRINT LINE IN ERROR DETECTED IN JCLIN SCAN.@SA72421*/ 01037000
*   /* TWO POINTERS ARE RECEIVED. ONE POINTS TO THE LINE IN  @SA72421*/ 01038000
*   /* ERROR RECORD. THE OTHER POINTS TO AN ACTION FIELD     @SA72421*/ 01039000
*   /* DESCRIBING THE ACTION TAKEN.                          @SA72421*/ 01040000
*   /*                                                               */ 01041000
*   /*****************************************************************/ 01042000
*                                                                  0423 01043000
*HMAASMR:                           /* ERROR PRINT ROUTINE   @SA72421*/ 01044000
*   PROC(LINE,ACTION);              /*                       @Z67SP00*/ 01045000
HMAASMR  STM   @14,@12,@SA00006                                    0423 01046000
         MVC   @PC00006(8),0(@01)                                  0423 01047000
*   DCL                                                            0424 01048000
*     LINE CHAR(80);                /* LINE IN ERROR         @Z67SP00*/ 01049000
*   DCL                                                            0425 01050000
*     ACTION CHAR(25);              /* ACTION/INFO TAKEN     @Z67SP00*/ 01051000
*   DCL                                                            0426 01052000
*     ASMRBFSV PTR(31);             /* BUFF ADDRESS SAVE AREA      0426 01053000
*                                                            @SA72421*/ 01054000
*   DCL                                                            0427 01055000
*     1 JCLINOUT,                   /* CORE AREA EQUATING TO HMASMPRL   01056000
*                                                            @SA72421*/ 01057000
*       3 * CHAR(10),               /* HMASMPRL CONTROL AREA @SA72421*/ 01058000
*       3 PRNTMAP CHAR(120),        /* PRINT LINE MAP        @SA72421*/ 01059000
*         5 * CHAR(10) INIT('----------'),/* PREFIX          @SA72421*/ 01060000
*         5 JCLINDAT CHAR(80),      /* LINE IN ERROR         @SA72421*/ 01061000
*         5 * CHAR(5) INIT(' '),    /* SPACING               @SA72421*/ 01062000
*         5 JCLINACT CHAR(25);      /* ACTION INFO           @SA72421*/ 01063000
*   ASMRBFSV=IOPBUFAD;              /* SAVE BUFFER ADDRESS   @SA72421*/ 01064000
         L     @10,IOPBUFAD(,IOPPTR)                               0428 01065000
         ST    @10,ASMRBFSV                                        0428 01066000
*   IOPBUFAD=ADDR(JCLINOUT);        /* EQUATE PRL TO JCLINOUT MAP  0429 01067000
*                                                            @SA72421*/ 01068000
         LA    @10,JCLINOUT                                        0429 01069000
         ST    @10,IOPBUFAD(,IOPPTR)                               0429 01070000
*   JCLINDAT=LINE;                  /* FILL IN LINE IN ERROR @SA72421*/ 01071000
         L     @08,@PC00006                                        0430 01072000
         MVC   JCLINDAT(80),LINE(@08)                              0430 01073000
*   JCLINACT=ACTION;                /* FILL IN ACTION INFO   @SA72421*/ 01074000
         L     @08,@PC00006+4                                      0431 01075000
         MVC   JCLINACT(25),ACTION(@08)                            0431 01076000
*   PRLRLEN=LENGTH(PRNTMAP);        /* FILL IN LNGTH OF PRINT DATA 0432 01077000
*                                                            @SA72421*/ 01078000
         MVC   PRLRLEN(2,@10),@CH01443                             0432 01079000
*   PRLFLGS=ZERO;                   /* RESET FLAGS           @Z40SP00*/ 01080000
         MVI   PRLFLGS(@10),X'00'                                  0433 01081000
*   IOPDSID=IOPPRINT;               /* SET PRINT INDICATOR   @SA72421*/ 01082000
         MVI   IOPDSID(IOPPTR),X'0B'                               0434 01083000
*   IOPFUNCT=IOPWRITE;              /* INDICATE WRITE OP     @SA72421*/ 01084000
         MVI   IOPFUNCT(IOPPTR),X'51'                              0435 01085000
*   CALL HMASMIO(HMASMIOP);         /* WRITE LINE IN ERROR   @SA72421*/ 01086000
         ST    IOPPTR,@AL00001                                     0436 01087000
         L     @15,@CV01381                                        0436 01088000
         LA    @01,@AL00001                                        0436 01089000
         BALR  @14,@15                                             0436 01090000
*   IOPBUFAD=ASMRBFSV;              /* RESTORE BUFFER ADDRESS      0437 01091000
*                                                            @SA72421*/ 01092000
         L     @10,ASMRBFSV                                        0437 01093000
         ST    @10,IOPBUFAD(,IOPPTR)                               0437 01094000
*   RETURN CODE(IOPRETRN);          /* RETURN WITH IO CODE   @Z40SP00*/ 01095000
         SLR   @15,@15                                             0438 01096000
         IC    @15,IOPRETRN(,IOPPTR)                               0438 01097000
         L     @14,@SA00006                                        0438 01098000
         LM    @00,@12,@SA00006+8                                  0438 01099000
         BR    @14                                                 0438 01100000
*   END HMAASMR;                    /*                       @SA72421*/ 01101000
*   END HMASMASM                    /*                       @SA72421*/ 01102000
*                                                                  0440 01103000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 01104000
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */ 01105000
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */ 01106000
*/*%INCLUDE SYSLIB  (HMASMPRL)                                       */ 01107000
*/*%INCLUDE SYSLIB  (HMASMSCP)                                       */ 01108000
*/*%INCLUDE SYSLIB  (HMASMCRP)                                       */ 01109000
*                                                                  0440 01110000
*       ;                                                          0440 01111000
@DATA    DS    0H                                                       01112000
@CH00460 DC    H'9'                                                     01113000
@CH01063 DC    H'71'                                                    01114000
@CH00068 DC    H'80'                                                    01115000
@CH01443 DC    H'120'                                                   01116000
@SM01458 MVC   MODNAME(0),SCPSTRNG(@10)                                 01117000
@SM01460 MVC   MACSAVE(0),SCPSTRNG(@10)                                 01118000
         DS    0F                                                       01119000
@SA00001 DS    18F                                                      01120000
@PC00001 DS    4F                                                       01121000
@SA00005 DS    15F                                                      01122000
@SA00006 DS    0F                                                       01123000
@PC00006 EQU   @SA00006+60                                              01124000
         DS    17F                                                      01125000
@AL00001 DS    2A                                                       01126000
@TF00001 DS    F                                                        01127000
         DS    0F                                                       01128000
@CF00046 DC    F'1'                                                     01129000
@CH00046 EQU   @CF00046+2                                               01130000
@CF00064 DC    F'6'                                                     01131000
@CF00041 DC    F'8'                                                     01132000
@CF00648 DC    F'255'                                                   01133000
@CF01456 DC    F'-4'                                                    01134000
@CV01381 DC    V(HMASMIO)                                               01135000
@CV01382 DC    V(HMASMBUE)                                              01136000
@CV01383 DC    V(HMASMCRD)                                              01137000
@CV01384 DC    V(HMASMSCN)                                              01138000
         DS    0D                                                       01139000
SCPPTR   DS    A                                                        01140000
SEQNO    DS    F                                                        01141000
SAVBUFAD DS    A                                                        01142000
BUFBASE  DC    A(0)                                                     01143000
NXTBUF   DC    A(0)                                                     01144000
ASMRBFSV DS    A                                                        01145000
         DS    CL1                                                      01146000
K        DS    AL3                                                      01147000
         DS    CL1                                                      01148000
I        DS    AL3                                                      01149000
ASMRTNCD DS    FL1                                                      01150000
@CC01351 DC    C'CVT '                                                  01151000
@CC01343 DC    C'/*'                                                    01152000
@CC01345 DC    C'//'                                                    01153000
@CC01347 DC    C'++'                                                    01154000
         DS    CL5                                                      01155000
SEQPACK  DS    CL8                                                      01156000
MACSAVE  DS    CL8                                                      01157000
MODNAME  DS    CL8                                                      01158000
PATCHASM DS    CL80                                                     01159000
         ORG   PATCHASM                                                 01160000
@NM00179 DC    80X'FF'                                                  01161000
         ORG   PATCHASM+80                                              01162000
MSGTXT   DS    CL25                                                     01163000
MODERR   DC    CL25'ERR LOCATING MOD KEYWORD.'                          01164000
LASTLINE DC    CL25'*****-LAST LINE PROCESSED'                          01165000
MACTBLEX DC    CL25'MACRO TABLE EXCEEDED     '                          01166000
ASMSCP   DS    CL26                                                     01167000
SWITCHES DS    BL1                                                      01168000
         ORG   SWITCHES                                                 01169000
CONTINSW DS    BL1                                                      01170000
EXCERR   EQU   SWITCHES+0                                               01171000
FOUND    EQU   SWITCHES+0                                               01172000
JCLENSW  EQU   SWITCHES+0                                               01173000
PREMSW   EQU   SWITCHES+0                                               01174000
@NM00180 EQU   SWITCHES+0                                               01175000
         ORG   SWITCHES+1                                               01176000
MACTBL   DS    CL84                                                     01177000
JCLINOUT DS    CL130                                                    01178000
         ORG   JCLINOUT                                                 01179000
@NM00183 DS    CL10                                                     01180000
PRNTMAP  DS    CL120                                                    01181000
         ORG   PRNTMAP                                                  01182000
@NM00184 DC    CL10'----------'                                         01183000
JCLINDAT DS    CL80                                                     01184000
@NM00185 DC    CL5' '                                                   01185000
JCLINACT DS    CL25                                                     01186000
         ORG   JCLINOUT+130                                             01187000
HMASMASM CSECT                                                          01188000
*      TABLES FOR JCL SCAN FOR MODULE NAME                              01189000
*                                                                       01190000
MODK     DSCAN  KEY='MOD=',SUCC=MODSV,ALT=SYSPK                         01191000
MODSV    DSCAN  ROUT=SAVMOD10                                           01192000
SYSPK    DSCAN  KEY='//SYSPUNCH',SUCC=DSNLOOK,ALT=SYSGO      @YA05006   01193000
SYSGO    DSCAN  KEY='//SYSGO',SUCC=DSNLOOK,ALT=SYSLIN        @YA05006   01194000
SYSLIN   DSCAN  KEY='//SYSLIN',SUCC=DSNLOOK,ALT=BUMP1        @YA05006   01195000
BUMP1    DSCAN  ROUT=BUMP010,SUCC=MODK,MINLEN=0                         01196000
DSNLOOK  DSCAN  KEY='DSN=',SUCC=LPARENK,ALT=DSNLOOK2         @Z40SP00   01197000
DSNLOOK2 DSCAN  KEY='DSNAME=',SUCC=LPARENK,ALT=DDCONT1       @Z40SP00   01198000
DDCONT1  DSCAN  KEY='// ',SUCC=DSNLOOK,ALT=DDNEW1            @YA05006   01199000
DDNEW1   DSCAN  KEY='//',SUCC=SYSPK,ALT=BUMP2                @YA05006   01200000
BUMP2    DSCAN  ROUT=BUMP010,SUCC=DSNLOOK,MINLEN=0                      01201000
LPARENK  DSCAN  KEY='(',ALT=BUMP3,SUCC=MODSV                            01202000
BUMP3    DSCAN  ROUT=BUMP010,SUCC=LPARENK,MINLEN=0                      01203000
*                                                                       01204000
*      TABLES FOR ASSEMBLER INPUT SCAN FOR MACRO NAMES                  01205000
*                                                                       01206000
MACSTART DSCAN  KEY=' ',BLANKS=ON,SUCC=COPYSV,ALT=MLABELK     @XA10584  01207000
MLABELK  DSCAN  KEY='.',ALT=ASTERCK,SUCC=ASTERCK              @Z40SP00  01208000
ASTERCK  DSCAN  KEY='*',ALT=LABELK                                      01209000
LABELK   DSCAN  SUCC=OPSV,MINLEN=0,ROUT=LABELCK                         01210000
COPYSV   DSCAN  KEY='COPY',ALT=OPSV,SUCC=OPSV                 @Z40SP00  01211000
OPSV     DSCAN  ROUT=MACSV010,MINLEN=0                                  01212000
HMASMASM CSECT                                                          01213000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01214000
@01      EQU   01                                                       01215000
@02      EQU   02                                                       01216000
@03      EQU   03                                                       01217000
@04      EQU   04                                                       01218000
@05      EQU   05                                                       01219000
@06      EQU   06                                                       01220000
@07      EQU   07                                                       01221000
@08      EQU   08                                                       01222000
@09      EQU   09                                                       01223000
@10      EQU   10                                                       01224000
@11      EQU   11                                                       01225000
@12      EQU   12                                                       01226000
@13      EQU   13                                                       01227000
@14      EQU   14                                                       01228000
@15      EQU   15                                                       01229000
CCAPTR   EQU   @11                                                      01230000
IOPPTR   EQU   @09                                                      01231000
RTNCODE  EQU   @15                                                      01232000
RTNREG   EQU   @14                                                      01233000
HMASMCCA EQU   0                                                        01234000
CCAFBUFR EQU   HMASMCCA+4                                               01235000
CCADSAD  EQU   CCAFBUFR+124                                             01236000
CCATPAD  EQU   CCAFBUFR+128                                             01237000
CCAFLAG7 EQU   CCAFBUFR+132                                             01238000
CCAFIOP  EQU   HMASMCCA+140                                             01239000
CCAIOPTR EQU   CCAFIOP                                                  01240000
CCAFSYS  EQU   HMASMCCA+148                                             01241000
CCASREL  EQU   CCAFSYS+12                                               01242000
CCAFLAGA EQU   CCAFSYS+21                                               01243000
CCAFSTA  EQU   HMASMCCA+188                                             01244000
CCAFICT  EQU   HMASMCCA+192                                             01245000
CCAFPGM  EQU   HMASMCCA+208                                             01246000
CCABLDLP EQU   CCAFPGM                                                  01247000
CCADBLDL EQU   CCAFPGM+4                                                01248000
CCAFGTP  EQU   HMASMCCA+224                                             01249000
CCASEGTP EQU   CCAFGTP                                                  01250000
@NM00011 EQU   HMASMCCA+244                                             01251000
CCAFFUNC EQU   HMASMCCA+264                                             01252000
CCAFLAG1 EQU   CCAFFUNC+8                                               01253000
CCAFLAG2 EQU   CCAFFUNC+11                                              01254000
CCAFPROC EQU   HMASMCCA+276                                             01255000
CCAFLAG3 EQU   CCAFPROC                                                 01256000
CCAFDIS  EQU   HMASMCCA+278                                             01257000
CCAFLAG4 EQU   CCAFDIS                                                  01258000
CCAFLAG5 EQU   CCAFDIS+1                                                01259000
CCAFLAG6 EQU   CCAFDIS+2                                                01260000
CCAFCNV  EQU   HMASMCCA+281                                             01261000
CCAFLAG8 EQU   CCAFCNV                                                  01262000
CCAFCTL  EQU   HMASMCCA+282                                             01263000
CCAFLAG9 EQU   CCAFCTL                                                  01264000
CCAFDSNG EQU   HMASMCCA+298                                             01265000
CCAFLAGB EQU   CCAFDSNG                                                 01266000
CCABLDLA EQU   0                                                        01267000
@NM00027 EQU   CCABLDLA                                                 01268000
CCABLDLL EQU   0                                                        01269000
@NM00029 EQU   CCABLDLL                                                 01270000
CCALKDRC EQU   @NM00029+20                                              01271000
@NM00031 EQU   CCABLDLL+124                                             01272000
CCAASMRC EQU   @NM00031+20                                              01273000
@NM00033 EQU   CCABLDLL+248                                             01274000
CCACPYRC EQU   @NM00033+20                                              01275000
@NM00035 EQU   CCABLDLL+372                                             01276000
CCACOMRC EQU   @NM00035+20                                              01277000
@NM00037 EQU   CCABLDLL+496                                             01278000
CCAZAPRC EQU   @NM00037+20                                              01279000
@NM00039 EQU   CCABLDLL+620                                             01280000
CCASUPRC EQU   @NM00039+20                                              01281000
@NM00041 EQU   CCABLDLL+744                                             01282000
CCAUPDRC EQU   @NM00041+20                                              01283000
CCABLDLM EQU   0                                                        01284000
CCABELMT EQU   CCABLDLM+4                                               01285000
CCABMPOS EQU   CCABELMT                                                 01286000
HMASMIOP EQU   0                                                        01287000
IOPDSID  EQU   HMASMIOP                                                 01288000
IOPFUNCT EQU   HMASMIOP+1                                               01289000
IOPRETRN EQU   HMASMIOP+2                                               01290000
IOPTYPE  EQU   HMASMIOP+3                                               01291000
IOPNAME  EQU   HMASMIOP+4                                               01292000
@NM00045 EQU   HMASMIOP+12                                              01293000
@NM00046 EQU   @NM00045                                                 01294000
IOPDDNAM EQU   HMASMIOP+24                                              01295000
IOPBUFAD EQU   HMASMIOP+52                                              01296000
IOPDRMAP EQU   HMASMIOP+56                                              01297000
IOPINAME EQU   IOPDRMAP                                                 01298000
IOPINAM  EQU   IOPINAME                                                 01299000
IOPITYP  EQU   IOPINAM                                                  01300000
IOPUSERL EQU   IOPDRMAP+11                                              01301000
IOPEND   EQU   IOPDRMAP+12                                              01302000
IOPLMCTL EQU   0                                                        01303000
IOPQSMIF EQU   0                                                        01304000
@NM00156 EQU   IOPQSMIF                                                 01305000
IOPQSMLS EQU   IOPQSMIF+8                                               01306000
IOPQSMNM EQU   IOPQSMLS                                                 01307000
IOPBS02  EQU   0                                                        01308000
IOPBS04  EQU   0                                                        01309000
IOPBAPF  EQU   IOPBS04                                                  01310000
HMASMPRL EQU   0                                                        01311000
PRLRLEN  EQU   HMASMPRL                                                 01312000
PRLSPAN  EQU   HMASMPRL+2                                               01313000
PRLFLGS  EQU   PRLSPAN                                                  01314000
PRLDATE  EQU   HMASMPRL+4                                               01315000
PRLTIME  EQU   HMASMPRL+7                                               01316000
PRLEND   EQU   HMASMPRL+10                                              01317000
HMASMSCP EQU   0                                                        01318000
SCPCHAR  EQU   HMASMSCP                                                 01319000
SCPSRCH  EQU   HMASMSCP+4                                               01320000
SCPIORTN EQU   HMASMSCP+12                                              01321000
SCPIOPAD EQU   HMASMSCP+16                                              01322000
SCPINLN  EQU   HMASMSCP+20                                              01323000
SCPPMLN  EQU   HMASMSCP+22                                              01324000
SCPEOR   EQU   HMASMSCP+24                                              01325000
SCPRETRN EQU   HMASMSCP+25                                              01326000
SCPRET   EQU   SCPRETRN                                                 01327000
SCPSTRNG EQU   0                                                        01328000
MACBUF   EQU   0                                                        01329000
MACCTR   EQU   MACBUF                                                   01330000
MACNXT   EQU   MACBUF+1                                                 01331000
MACCALL  EQU   MACBUF+4                                                 01332000
CCADSIDA EQU   0                                                        01333000
CCATYPEA EQU   0                                                        01334000
IOPBS01  EQU   0                                                        01335000
IOPBS03  EQU   0                                                        01336000
SCPIOPRM EQU   0                                                        01337000
BUPPARM  EQU   0                                                        01338000
BUPFUNCT EQU   BUPPARM                                                  01339000
BUPTYPE  EQU   BUPPARM+1                                                01340000
BUPFLAGS EQU   BUPPARM+3                                                01341000
BUPIOPAD EQU   BUPPARM+12                                               01342000
HMASMCRP EQU   0                                                        01343000
CRPSCPAD EQU   HMASMCRP+4                                               01344000
CRPINDS  EQU   HMASMCRP+8                                               01345000
CRPRETRN EQU   HMASMCRP+10                                              01346000
CRPFLG1  EQU   HMASMCRP+14                                              01347000
CRPFLG2  EQU   HMASMCRP+16                                              01348000
CRPINSW0 EQU   CRPFLG2                                                  01349000
CRPINSW1 EQU   CRPFLG2                                                  01350000
CRPINSW2 EQU   CRPFLG2                                                  01351000
CRPINSW3 EQU   CRPFLG2                                                  01352000
CRPBUFFR EQU   HMASMCRP+18                                              01353000
CRPBFCTL EQU   CRPBUFFR                                                 01354000
CRPBFDTA EQU   CRPBFCTL                                                 01355000
CRPBFCNT EQU   CRPBFCTL+71                                              01356000
BUFFER   EQU   0                                                        01357000
MAXJCL   EQU   0                                                        01358000
LINE     EQU   0                                                        01359000
ACTION   EQU   0                                                        01360000
IOPUDATA EQU   IOPEND                                                   01361000
IOPINAM3 EQU   IOPINAME                                                 01362000
@NM00052 EQU   IOPINAM3                                                 01363000
IOPSTCMP EQU   IOPUDATA                                                 01364000
IOPDYNDT EQU   IOPUDATA                                                 01365000
IOPSPACE EQU   IOPDYNDT+44                                              01366000
IOPDTYPE EQU   IOPDYNDT+50                                              01367000
IOPNTMAX EQU   IOPDRMAP                                                 01368000
IOPNTMAP EQU   IOPDRMAP                                                 01369000
IOPCDMAP EQU   IOPNTMAP                                                 01370000
IOPPTMAP EQU   IOPCDMAP                                                 01371000
IOPSCMAP EQU   IOPPTMAP                                                 01372000
IOPDIRCT EQU   IOPSCMAP+12                                              01373000
IOPCDMAX EQU   IOPDIRCT                                                 01374000
IOPCQMAP EQU   IOPDRMAP                                                 01375000
@NM00063 EQU   IOPUDATA                                                 01376000
@NM00064 EQU   IOPUDATA                                                 01377000
IOPASMNT EQU   IOPUDATA                                                 01378000
IOPASMDR EQU   IOPASMNT                                                 01379000
IOPNTLVL EQU   IOPASMDR                                                 01380000
IOPABUNT EQU   IOPASMDR+1                                               01381000
IOPLMDNT EQU   IOPUDATA                                                 01382000
IOPLMDDR EQU   IOPLMDNT                                                 01383000
IOPLMLEP EQU   IOPLMDDR+1                                               01384000
IOPLMDF1 EQU   IOPLMLEP                                                 01385000
IOPFLGS2 EQU   IOPLMDF1                                                 01386000
IOPLMDF2 EQU   IOPLMLEP+1                                               01387000
IOPLMDF3 EQU   IOPLMLEP+2                                               01388000
IOPLMDF4 EQU   IOPLMLEP+3                                               01389000
IOPLMDF5 EQU   IOPLMDDR+5                                               01390000
IOPFLGS3 EQU   IOPLMDF5                                                 01391000
IOPLMDFX EQU   IOPLMDNT+24                                              01392000
@NM00073 EQU   IOPLMDFX                                                 01393000
IOPLNTRY EQU   IOPLMDFX+8                                               01394000
IOPLSYS  EQU   IOPLNTRY                                                 01395000
IOPSYSLB EQU   IOPLSYS                                                  01396000
IOPMACNT EQU   IOPUDATA                                                 01397000
IOPMACDR EQU   IOPMACNT                                                 01398000
IOPRMIDE EQU   IOPMACDR+1                                               01399000
IOPRMID  EQU   IOPRMIDE                                                 01400000
IOPRMST  EQU   IOPRMIDE+7                                               01401000
IOPFMIDE EQU   IOPMACDR+9                                               01402000
IOPFMID  EQU   IOPFMIDE                                                 01403000
IOPMCLNG EQU   IOPMACDR+17                                              01404000
IOPMACFX EQU   IOPMACNT+24                                              01405000
IOPBUNT  EQU   IOPMACFX                                                 01406000
IOPMCSYS EQU   IOPMACFX+64                                              01407000
IOPMCDLB EQU   IOPMACFX+72                                              01408000
IOPMCEND EQU   IOPMACNT+104                                             01409000
IOPMACVR EQU   IOPMCEND                                                 01410000
IOPMCENT EQU   IOPMACVR                                                 01411000
IOPMCDTA EQU   IOPMCENT                                                 01412000
IOPMCASM EQU   IOPMCDTA                                                 01413000
IOPMACID EQU   IOPMCASM                                                 01414000
IOPMACND EQU   IOPMACID                                                 01415000
IOPMACST EQU   IOPMCASM+7                                               01416000
IOPMCIND EQU   IOPMCENT+8                                               01417000
IOPEOFNT EQU   IOPUDATA                                                 01418000
IOPSRCNT EQU   IOPUDATA                                                 01419000
IOPSRCDR EQU   IOPSRCNT                                                 01420000
@NM00084 EQU   IOPSRCDR+1                                               01421000
@NM00086 EQU   @NM00084+7                                               01422000
@NM00090 EQU   IOPSRCDR+9                                               01423000
IOPSRCFX EQU   IOPSRCNT+24                                              01424000
@NM00094 EQU   IOPSRCFX                                                 01425000
IOPSREND EQU   IOPSRCNT+104                                             01426000
IOPSRCVR EQU   IOPSREND                                                 01427000
IOPSNTRY EQU   IOPSRCVR                                                 01428000
IOPSRDTA EQU   IOPSNTRY                                                 01429000
IOPSRCID EQU   IOPSRDTA                                                 01430000
IOPSRCST EQU   IOPSRDTA+7                                               01431000
IOPMODNT EQU   IOPUDATA                                                 01432000
IOPMODDR EQU   IOPMODNT                                                 01433000
@NM00100 EQU   IOPMODDR+1                                               01434000
@NM00102 EQU   @NM00100+7                                               01435000
@NM00106 EQU   IOPMODDR+9                                               01436000
IOPMODFX EQU   IOPMODNT+24                                              01437000
@NM00110 EQU   IOPMODFX                                                 01438000
IOPMDLEP EQU   IOPMODFX+8                                               01439000
IOPMODF1 EQU   IOPMDLEP                                                 01440000
IOPMODF2 EQU   IOPMDLEP+1                                               01441000
IOPMODF3 EQU   IOPMDLEP+2                                               01442000
IOPMODF4 EQU   IOPMDLEP+3                                               01443000
IOPMDEND EQU   IOPMODNT+104                                             01444000
IOPMODVR EQU   IOPMDEND                                                 01445000
IOPMNTRY EQU   IOPMODVR                                                 01446000
IOPMDDTA EQU   IOPMNTRY                                                 01447000
IOPLMODS EQU   IOPMDDTA                                                 01448000
IOPMODID EQU   IOPLMODS                                                 01449000
IOPMODST EQU   IOPLMODS+7                                               01450000
IOPDLBNT EQU   IOPUDATA                                                 01451000
IOPDLBDR EQU   IOPDLBNT                                                 01452000
IOPDLBFX EQU   IOPDLBNT+24                                              01453000
@NM00121 EQU   IOPDLBFX                                                 01454000
IOPDLEND EQU   IOPDLBNT+104                                             01455000
IOPDLBVR EQU   IOPDLEND                                                 01456000
IOPDNTRY EQU   IOPDLBVR                                                 01457000
IOPDSYS  EQU   IOPDNTRY                                                 01458000
IOPSYSNT EQU   IOPUDATA                                                 01459000
IOPSYSDR EQU   IOPSYSNT                                                 01460000
IOPSYSF1 EQU   IOPSYSDR+4                                               01461000
IOPFLGS7 EQU   IOPSYSF1                                                 01462000
IOPSYSFX EQU   IOPSYSNT+24                                              01463000
@NM00128 EQU   IOPSYSFX                                                 01464000
IOPSYEND EQU   IOPSYSNT+184                                             01465000
IOPSYSVR EQU   IOPSYEND                                                 01466000
IOPSYSTR EQU   IOPSYSVR                                                 01467000
IOPSYNTR EQU   IOPSYSTR                                                 01468000
IOPPTFNT EQU   IOPUDATA                                                 01469000
IOPPTFDR EQU   IOPPTFNT                                                 01470000
IOPPSTAT EQU   IOPPTFDR+2                                               01471000
IOPPTFF1 EQU   IOPPSTAT                                                 01472000
IOPFLGS5 EQU   IOPPTFF1                                                 01473000
IOPPTFF2 EQU   IOPPSTAT+1                                               01474000
IOPPTFF3 EQU   IOPPSTAT+3                                               01475000
IOPPTFFX EQU   IOPPTFNT+24                                              01476000
@NM00137 EQU   IOPPTFFX                                                 01477000
@NM00138 EQU   @NM00137                                                 01478000
IOPPDTES EQU   IOPPTFFX+41                                              01479000
@NM00141 EQU   IOPPDTES                                                 01480000
IOPPTPFX EQU   IOPPDTES+6                                               01481000
IOPDATES EQU   IOPPTPFX                                                 01482000
IOPPTEND EQU   IOPPTFNT+104                                             01483000
IOPPTFVR EQU   IOPPTEND                                                 01484000
IOPPNTRY EQU   IOPPTFVR                                                 01485000
IOPPMODS EQU   IOPPNTRY                                                 01486000
IOPENTNT EQU   IOPUDATA+104                                             01487000
IOPSRLNT EQU   IOPUDATA+104                                             01488000
IOPPRENT EQU   IOPUDATA+104                                             01489000
IOPNPRNT EQU   IOPUDATA+104                                             01490000
IOPSUPNT EQU   IOPUDATA+104                                             01491000
IOPREQNT EQU   IOPUDATA+104                                             01492000
IOPIRQNT EQU   IOPUDATA+104                                             01493000
IOPFIDNT EQU   IOPUDATA+104                                             01494000
IOPDELNT EQU   IOPUDATA+104                                             01495000
IOPVERNT EQU   IOPUDATA+104                                             01496000
IOPSBYNT EQU   IOPUDATA+104                                             01497000
IOPQSMNT EQU   IOPUDATA                                                 01498000
IOPQSMDR EQU   IOPQSMNT                                                 01499000
IOPQFMNT EQU   IOPUDATA                                                 01500000
IOPQFMDR EQU   IOPQFMNT                                                 01501000
IOPQFEND EQU   IOPQFMNT+2                                               01502000
IOPQFMVR EQU   IOPQFEND                                                 01503000
IOPQFMLS EQU   IOPQFMVR                                                 01504000
IOPQFMNM EQU   IOPQFMLS                                                 01505000
IOPPTSYS EQU   IOPUDATA                                                 01506000
IOPPTSDR EQU   IOPPTSYS                                                 01507000
IOPPTSFX EQU   IOPPTSYS+24                                              01508000
IOPDSSPC EQU   IOPPTSFX                                                 01509000
IOPPTFG1 EQU   IOPPTSFX+34                                              01510000
IOPPSEND EQU   IOPPTSYS+1064                                            01511000
IOPPTSVR EQU   IOPPSEND                                                 01512000
IOPPTNTR EQU   IOPPTSVR                                                 01513000
@NM00166 EQU   IOPPTNTR                                                 01514000
IOPPTFMD EQU   @NM00166                                                 01515000
IOPPTREL EQU   IOPPTFMD                                                 01516000
IOPBPDS  EQU   IOPUDATA                                                 01517000
IOPBLEP1 EQU   IOPBPDS+8                                                01518000
IOPBLEP2 EQU   IOPBPDS+9                                                01519000
@NM00170 EQU   IOPBPDS+18                                               01520000
IOPBFTB0 EQU   @NM00170                                                 01521000
IOPBFTB1 EQU   IOPBFTB0                                                 01522000
ASMREC   EQU   CRPBUFFR                                                 01523000
SEQUENCE EQU   ASMREC+72                                                01524000
LASTDIG  EQU   SEQUENCE+7                                               01525000
PRLDATA  EQU   PRLEND                                                   01526000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01527000
@NM00182 EQU   SEQUENCE                                                 01528000
@NM00181 EQU   ASMREC                                                   01529000
IOPBCEND EQU   IOPBPDS+21                                               01530000
IOPBFTB3 EQU   IOPBFTB0+2                                               01531000
IOPBFTB2 EQU   IOPBFTB0+1                                               01532000
@NM00172 EQU   IOPBFTB1                                                 01533000
IOPBAPFP EQU   IOPBFTB1                                                 01534000
IOPBSSI  EQU   IOPBFTB1                                                 01535000
IOPBPAGA EQU   IOPBFTB1                                                 01536000
@NM00171 EQU   IOPBFTB1                                                 01537000
IOPBAOSL EQU   IOPBFTB1                                                 01538000
IOPBSEPA EQU   IOPBPDS+15                                               01539000
IOPBFTBL EQU   IOPBPDS+13                                               01540000
IOPBSTOR EQU   IOPBPDS+10                                               01541000
IOPBREFR EQU   IOPBLEP2                                                 01542000
IOPBLEF  EQU   IOPBLEP2                                                 01543000
IOPBTEST EQU   IOPBLEP2                                                 01544000
IOPBNE   EQU   IOPBLEP2                                                 01545000
@NM00169 EQU   IOPBLEP2                                                 01546000
IOPBDC   EQU   IOPBLEP2                                                 01547000
@NM00168 EQU   IOPBLEP1                                                 01548000
IOPBSCTR EQU   IOPBLEP1                                                 01549000
IOPBOL   EQU   IOPBLEP1                                                 01550000
@NM00167 EQU   IOPBLEP1                                                 01551000
IOPBOVLY EQU   IOPBLEP1                                                 01552000
IOPBREUS EQU   IOPBLEP1                                                 01553000
IOPBRENT EQU   IOPBLEP1                                                 01554000
IOPBNL   EQU   IOPBPDS+7                                                01555000
IOPBTTRN EQU   IOPBPDS+4                                                01556000
IOPBZERO EQU   IOPBPDS+3                                                01557000
IOPBTTRT EQU   IOPBPDS                                                  01558000
IOPPTIND EQU   IOPPTNTR+8                                               01559000
IOPPTSND EQU   IOPPTREL                                                 01560000
@NM00165 EQU   IOPPTSFX+872                                             01561000
IOPSYZPP EQU   IOPPTSFX+772                                             01562000
IOPSYZPR EQU   IOPPTSFX+771                                             01563000
IOPSYZPS EQU   IOPPTSFX+763                                             01564000
IOPSYZAP EQU   IOPPTSFX+755                                             01565000
IOPSYUPP EQU   IOPPTSFX+655                                             01566000
IOPSYUPR EQU   IOPPTSFX+654                                             01567000
IOPSYUPS EQU   IOPPTSFX+646                                             01568000
IOPSYUPD EQU   IOPPTSFX+638                                             01569000
IOPSYSPP EQU   IOPPTSFX+538                                             01570000
IOPSYSPR EQU   IOPPTSFX+537                                             01571000
IOPSYSPS EQU   IOPPTSFX+529                                             01572000
IOPSYSUP EQU   IOPPTSFX+521                                             01573000
IOPSYLKP EQU   IOPPTSFX+421                                             01574000
IOPSYLKR EQU   IOPPTSFX+420                                             01575000
IOPSYLKS EQU   IOPPTSFX+412                                             01576000
IOPSYLKD EQU   IOPPTSFX+404                                             01577000
IOPSYCPP EQU   IOPPTSFX+304                                             01578000
IOPSYCPR EQU   IOPPTSFX+303                                             01579000
IOPSYCPS EQU   IOPPTSFX+295                                             01580000
IOPSYCPY EQU   IOPPTSFX+287                                             01581000
IOPSYCOP EQU   IOPPTSFX+187                                             01582000
IOPSYCOR EQU   IOPPTSFX+186                                             01583000
IOPSYCOS EQU   IOPPTSFX+178                                             01584000
IOPSYCOM EQU   IOPPTSFX+170                                             01585000
IOPSYASP EQU   IOPPTSFX+70                                              01586000
IOPSYASR EQU   IOPPTSFX+69                                              01587000
IOPSYASS EQU   IOPPTSFX+61                                              01588000
IOPSYASM EQU   IOPPTSFX+53                                              01589000
@NM00164 EQU   IOPPTSFX+35                                              01590000
@NM00163 EQU   IOPPTFG1                                                 01591000
IOPPTSNJ EQU   IOPPTFG1                                                 01592000
IOPPTSNP EQU   IOPPTFG1                                                 01593000
IOPSYPLN EQU   IOPPTSFX+32                                              01594000
IOPDSPFX EQU   IOPPTSFX+6                                               01595000
IOPDSDIR EQU   IOPDSSPC+4                                               01596000
IOPDSSEC EQU   IOPDSSPC+2                                               01597000
IOPDSPRM EQU   IOPDSSPC                                                 01598000
@NM00162 EQU   IOPPTSDR+4                                               01599000
IOPPTPEM EQU   IOPPTSDR+2                                               01600000
IOPPCNVL EQU   IOPPTSDR+1                                               01601000
@NM00161 EQU   IOPPTSDR                                                 01602000
IOPQFMTP EQU   IOPQFMLS+8                                               01603000
@NM00160 EQU   IOPQFMLS+7                                               01604000
IOPQFMND EQU   IOPQFMNM                                                 01605000
@NM00159 EQU   IOPQFMDR                                                 01606000
@NM00155 EQU   IOPQSMDR                                                 01607000
@NM00154 EQU   IOPSBYNT+8                                               01608000
IOPSBYST EQU   IOPSBYNT+7                                               01609000
IOPSBYNM EQU   IOPSBYNT                                                 01610000
@NM00153 EQU   IOPVERNT+8                                               01611000
IOPVERST EQU   IOPVERNT+7                                               01612000
IOPVERNM EQU   IOPVERNT                                                 01613000
@NM00152 EQU   IOPDELNT+8                                               01614000
IOPDELST EQU   IOPDELNT+7                                               01615000
IOPDELNM EQU   IOPDELNT                                                 01616000
@NM00151 EQU   IOPFIDNT+8                                               01617000
IOPFIDST EQU   IOPFIDNT+7                                               01618000
IOPFIDNM EQU   IOPFIDNT                                                 01619000
@NM00150 EQU   IOPIRQNT+8                                               01620000
IOPIRQST EQU   IOPIRQNT+7                                               01621000
IOPIRQNM EQU   IOPIRQNT                                                 01622000
@NM00149 EQU   IOPREQNT+8                                               01623000
IOPREQST EQU   IOPREQNT+7                                               01624000
IOPREQNM EQU   IOPREQNT                                                 01625000
@NM00148 EQU   IOPSUPNT+8                                               01626000
IOPSUPST EQU   IOPSUPNT+7                                               01627000
IOPSUPNM EQU   IOPSUPNT                                                 01628000
@NM00147 EQU   IOPNPRNT+8                                               01629000
IOPNPRST EQU   IOPNPRNT+7                                               01630000
IOPNPRNM EQU   IOPNPRNT                                                 01631000
@NM00146 EQU   IOPPRENT+8                                               01632000
IOPPREST EQU   IOPPRENT+7                                               01633000
IOPPRENM EQU   IOPPRENT                                                 01634000
@NM00145 EQU   IOPSRLNT+8                                               01635000
IOPSRLST EQU   IOPSRLNT+7                                               01636000
@NM00144 EQU   IOPSRLNT+4                                               01637000
IOPSRLNM EQU   IOPSRLNT                                                 01638000
@NM00143 EQU   IOPENTNT+8                                               01639000
IOPENTST EQU   IOPENTNT+7                                               01640000
IOPENTNM EQU   IOPENTNT                                                 01641000
IOPPIND  EQU   IOPPNTRY+8                                               01642000
IOPPTFND EQU   IOPPMODS                                                 01643000
IOPPFMID EQU   IOPPTFFX+73                                              01644000
@NM00142 EQU   IOPPTPFX+24                                              01645000
IOPUCLT  EQU   IOPDATES+21                                              01646000
IOPUCLD  EQU   IOPDATES+18                                              01647000
IOPACCT  EQU   IOPDATES+15                                              01648000
IOPACCD  EQU   IOPDATES+12                                              01649000
IOPRSTT  EQU   IOPDATES+9                                               01650000
IOPRSTD  EQU   IOPDATES+6                                               01651000
IOPAPPT  EQU   IOPDATES+3                                               01652000
IOPAPPD  EQU   IOPDATES                                                 01653000
IOPRECT  EQU   @NM00141+3                                               01654000
IOPRECD  EQU   @NM00141                                                 01655000
@NM00140 EQU   IOPPTFFX+8                                               01656000
@NM00139 EQU   @NM00137+7                                               01657000
IOPPRELN EQU   @NM00138                                                 01658000
@NM00136 EQU   IOPPTFDR+20                                              01659000
IOPSBYNO EQU   IOPPTFDR+13                                              01660000
IOPDBYNO EQU   IOPPTFDR+6                                               01661000
@NM00135 EQU   IOPPTFF3                                                 01662000
IOPFLF   EQU   IOPPTFF3                                                 01663000
IOPDBYP  EQU   IOPPTFF3                                                 01664000
IOPSBYP  EQU   IOPPTFF3                                                 01665000
IOPPMDLP EQU   IOPPTFF2+1                                               01666000
IOPPADDP EQU   IOPPTFF2+1                                               01667000
@NM00134 EQU   IOPPTFF2+1                                               01668000
IOPLRFP  EQU   IOPPTFF2                                                 01669000
IOPJCLP  EQU   IOPPTFF2                                                 01670000
IOPSUPP  EQU   IOPPTFF2                                                 01671000
IOPREQP  EQU   IOPPTFF2                                                 01672000
IOPPREP  EQU   IOPPTFF2                                                 01673000
IOPNPRP  EQU   IOPPTFF2                                                 01674000
IOPIRQP  EQU   IOPPTFF2                                                 01675000
IOPDELP  EQU   IOPPTFF2                                                 01676000
IOPREGEN EQU   IOPFLGS5                                                 01677000
IOPBYP   EQU   IOPFLGS5                                                 01678000
IOPDUMMP EQU   IOPFLGS5                                                 01679000
@NM00133 EQU   IOPFLGS5                                                 01680000
IOPERROR EQU   IOPFLGS5                                                 01681000
IOPACC   EQU   IOPFLGS5                                                 01682000
IOPRES   EQU   IOPFLGS5                                                 01683000
IOPAPP   EQU   IOPFLGS5                                                 01684000
IOPPTYPE EQU   IOPPTFDR+1                                               01685000
@NM00132 EQU   IOPPTFDR                                                 01686000
IOPSYSTP EQU   IOPSYSTR+8                                               01687000
IOPSYSND EQU   IOPSYNTR                                                 01688000
@NM00131 EQU   IOPSYSFX+21                                              01689000
IOPSYSID EQU   IOPSYSFX+13                                              01690000
IOPNUCID EQU   IOPSYSFX+12                                              01691000
IOPSREL  EQU   IOPSYSFX+8                                               01692000
@NM00130 EQU   @NM00128+7                                               01693000
@NM00129 EQU   @NM00128                                                 01694000
@NM00127 EQU   IOPSYSDR+5                                               01695000
@NM00126 EQU   IOPFLGS7                                                 01696000
IOPSYNG  EQU   IOPFLGS7                                                 01697000
IOPSYDL  EQU   IOPFLGS7                                                 01698000
IOPSTSNP EQU   IOPFLGS7                                                 01699000
IOPMTSNP EQU   IOPFLGS7                                                 01700000
IOPPEMAX EQU   IOPSYSDR+2                                               01701000
IOPSCNVL EQU   IOPSYSDR+1                                               01702000
@NM00125 EQU   IOPSYSDR                                                 01703000
IOPDLIND EQU   IOPDNTRY+8                                               01704000
IOPDLBND EQU   IOPDSYS                                                  01705000
@NM00124 EQU   IOPDLBFX+8                                               01706000
@NM00123 EQU   @NM00121+7                                               01707000
@NM00122 EQU   @NM00121                                                 01708000
@NM00120 EQU   IOPDLBDR+1                                               01709000
@NM00119 EQU   IOPDLBDR                                                 01710000
IOPMDIND EQU   IOPMNTRY+8                                               01711000
@NM00118 EQU   IOPMODST                                                 01712000
IOPMODND EQU   IOPMODID                                                 01713000
IOPDLIB  EQU   IOPMODFX+72                                              01714000
@NM00117 EQU   IOPMODFX+12                                              01715000
@NM00116 EQU   IOPMODF4                                                 01716000
@NM00115 EQU   IOPMODF3                                                 01717000
@NM00114 EQU   IOPMODF2                                                 01718000
IOPMPAGA EQU   IOPMODF2                                                 01719000
IOPMNE   EQU   IOPMODF2                                                 01720000
@NM00113 EQU   IOPMODF1                                                 01721000
IOPMDC   EQU   IOPMODF1                                                 01722000
IOPMREFR EQU   IOPMODF1                                                 01723000
IOPMOVLY EQU   IOPMODF1                                                 01724000
IOPMSCTR EQU   IOPMODF1                                                 01725000
IOPMREUS EQU   IOPMODF1                                                 01726000
IOPMRENT EQU   IOPMODF1                                                 01727000
IOPMAPF  EQU   IOPMODF1                                                 01728000
@NM00112 EQU   @NM00110+7                                               01729000
@NM00111 EQU   @NM00110                                                 01730000
@NM00109 EQU   IOPMODDR+17                                              01731000
@NM00108 EQU   @NM00106+7                                               01732000
@NM00107 EQU   @NM00106                                                 01733000
@NM00105 EQU   @NM00102                                                 01734000
@NM00104 EQU   @NM00102                                                 01735000
@NM00103 EQU   @NM00102                                                 01736000
@NM00101 EQU   @NM00100                                                 01737000
@NM00099 EQU   IOPMODDR                                                 01738000
IOPSRIND EQU   IOPSNTRY+8                                               01739000
@NM00098 EQU   IOPSRCST                                                 01740000
IOPSRCND EQU   IOPSRCID                                                 01741000
IOPSRDLB EQU   IOPSRCFX+72                                              01742000
IOPSRSYS EQU   IOPSRCFX+64                                              01743000
@NM00097 EQU   IOPSRCFX+8                                               01744000
@NM00096 EQU   @NM00094+7                                               01745000
@NM00095 EQU   @NM00094                                                 01746000
@NM00093 EQU   IOPSRCDR+18                                              01747000
IOPSRLNG EQU   IOPSRCDR+17                                              01748000
@NM00092 EQU   @NM00090+7                                               01749000
@NM00091 EQU   @NM00090                                                 01750000
@NM00089 EQU   @NM00086                                                 01751000
@NM00088 EQU   @NM00086                                                 01752000
@NM00087 EQU   @NM00086                                                 01753000
@NM00085 EQU   @NM00084                                                 01754000
@NM00083 EQU   IOPSRCDR                                                 01755000
IOPEOFND EQU   IOPEOFNT                                                 01756000
IOPMCTYP EQU   IOPMCIND                                                 01757000
@NM00082 EQU   IOPMACST                                                 01758000
@NM00081 EQU   IOPMACFX+8                                               01759000
IOPBUTYP EQU   IOPBUNT+7                                                01760000
IOPBUSMD EQU   IOPBUNT                                                  01761000
@NM00080 EQU   IOPMACDR+18                                              01762000
IOPFMST  EQU   IOPFMIDE+7                                               01763000
@NM00079 EQU   IOPRMST                                                  01764000
IOPRMASM EQU   IOPRMST                                                  01765000
@NM00078 EQU   IOPRMST                                                  01766000
@NM00077 EQU   IOPMACDR                                                 01767000
IOPLMIND EQU   IOPLNTRY+8                                               01768000
IOPLMDND EQU   IOPSYSLB                                                 01769000
@NM00075 EQU   @NM00073+7                                               01770000
@NM00074 EQU   @NM00073                                                 01771000
@NM00072 EQU   IOPLMDDR+6                                               01772000
@NM00071 EQU   IOPFLGS3                                                 01773000
IOPCHREP EQU   IOPFLGS3                                                 01774000
IOPLINK  EQU   IOPFLGS3                                                 01775000
IOPCOPY  EQU   IOPFLGS3                                                 01776000
@NM00070 EQU   IOPLMDF4                                                 01777000
@NM00069 EQU   IOPLMDF3                                                 01778000
@NM00068 EQU   IOPLMDF2                                                 01779000
IOPPAGA  EQU   IOPLMDF2                                                 01780000
IOPNE    EQU   IOPLMDF2                                                 01781000
@NM00067 EQU   IOPFLGS2                                                 01782000
IOPDC    EQU   IOPFLGS2                                                 01783000
IOPREFR  EQU   IOPFLGS2                                                 01784000
IOPOVLY  EQU   IOPFLGS2                                                 01785000
IOPSCTR  EQU   IOPFLGS2                                                 01786000
IOPREUS  EQU   IOPFLGS2                                                 01787000
IOPRENT  EQU   IOPFLGS2                                                 01788000
IOPAPF   EQU   IOPFLGS2                                                 01789000
@NM00066 EQU   IOPLMDDR                                                 01790000
@NM00065 EQU   IOPASMDR+9                                               01791000
IOPABUTP EQU   IOPABUNT+7                                               01792000
IOPABUPT EQU   IOPABUNT                                                 01793000
IOPALLOC EQU   @NM00064+4                                               01794000
IOPUSED  EQU   @NM00064                                                 01795000
IOPTPSEQ EQU   @NM00063+8                                               01796000
IOPVLSER EQU   @NM00063+2                                               01797000
IOPBLKSI EQU   @NM00063                                                 01798000
IOPCQMAX EQU   IOPCQMAP+12                                              01799000
@NM00062 EQU   IOPCQMAP+11                                              01800000
@NM00061 EQU   IOPCQMAP+8                                               01801000
@NM00060 EQU   IOPCQMAP                                                 01802000
IOPPTMAX EQU   IOPCDMAX                                                 01803000
@NM00059 EQU   IOPSCMAP+11                                              01804000
@NM00058 EQU   IOPSCMAP+8                                               01805000
@NM00057 EQU   IOPSCMAP                                                 01806000
IOPDIRMX EQU   IOPNTMAX+12                                              01807000
@NM00056 EQU   IOPNTMAX+11                                              01808000
@NM00055 EQU   IOPNTMAX+8                                               01809000
@NM00054 EQU   IOPNTMAX                                                 01810000
@NM00053 EQU   IOPDTYPE                                                 01811000
IOPDMOD  EQU   IOPDTYPE                                                 01812000
IOPDJCL  EQU   IOPDTYPE                                                 01813000
IOPDSRC  EQU   IOPDTYPE                                                 01814000
IOPDMAC  EQU   IOPDTYPE                                                 01815000
IOPSDIR  EQU   IOPSPACE+4                                               01816000
IOPSSCND EQU   IOPSPACE+2                                               01817000
IOPSPRIM EQU   IOPSPACE                                                 01818000
IOPDSN   EQU   IOPDYNDT                                                 01819000
IOPNTYPE EQU   IOPSTCMP+17                                              01820000
IOPNNAME EQU   IOPSTCMP+9                                               01821000
IOPOTYPE EQU   IOPSTCMP+8                                               01822000
IOPONAME EQU   IOPSTCMP                                                 01823000
IOPISEQ3 EQU   IOPINAM3+6                                               01824000
IOPITYP3 EQU   @NM00052+5                                               01825000
IOPIPTF3 EQU   @NM00052                                                 01826000
CRPDDNAM EQU   HMASMCRP+98                                              01827000
CRPBFSEQ EQU   CRPBUFFR+72                                              01828000
CRPINSWF EQU   CRPFLG2+1                                                01829000
CRPINSWE EQU   CRPFLG2+1                                                01830000
CRPINSWD EQU   CRPFLG2+1                                                01831000
CRPINSWC EQU   CRPFLG2+1                                                01832000
CRPINSWB EQU   CRPFLG2+1                                                01833000
CRPINSWA EQU   CRPFLG2+1                                                01834000
CRPINSW9 EQU   CRPFLG2+1                                                01835000
CRPINSW8 EQU   CRPFLG2+1                                                01836000
CRPINSW7 EQU   CRPFLG2                                                  01837000
CRPINSW6 EQU   CRPFLG2                                                  01838000
CRPINSW5 EQU   CRPFLG2                                                  01839000
CRPINSW4 EQU   CRPFLG2                                                  01840000
CRPEOF1  EQU   CRPINSW3                                                 01841000
CRPWRTLG EQU   CRPINSW2                                                 01842000
CRPEXADD EQU   CRPINSW1                                                 01843000
CRPEOFSW EQU   CRPINSW0                                                 01844000
@NM00178 EQU   CRPFLG1+1                                                01845000
CRPRPT   EQU   CRPFLG1+1                                                01846000
CRPLIST  EQU   CRPFLG1+1                                                01847000
CRPNOWPP EQU   CRPFLG1+1                                                01848000
CRPTRMEX EQU   CRPFLG1+1                                                01849000
CRPEOFEN EQU   CRPFLG1+1                                                01850000
CRPSCNCL EQU   CRPFLG1                                                  01851000
CRPOFFST EQU   CRPFLG1                                                  01852000
CRPOTHER EQU   CRPFLG1                                                  01853000
CRPPRINT EQU   CRPFLG1                                                  01854000
CRPLOG   EQU   CRPFLG1                                                  01855000
CRPPTS   EQU   CRPFLG1                                                  01856000
CRPLOGCK EQU   CRPFLG1                                                  01857000
CRPBFPRM EQU   CRPFLG1                                                  01858000
@NM00177 EQU   HMASMCRP+11                                              01859000
CRPOUTDS EQU   HMASMCRP+9                                               01860000
@NM00176 EQU   HMASMCRP+1                                               01861000
CRPUXNUM EQU   HMASMCRP                                                 01862000
BUPGTPAD EQU   BUPPARM+16                                               01863000
@NM00002 EQU   BUPPARM+11                                               01864000
BUPSYSMD EQU   BUPPARM+4                                                01865000
@NM00001 EQU   BUPFLAGS                                                 01866000
BUPREDO  EQU   BUPFLAGS                                                 01867000
BUPSTYPE EQU   BUPPARM+2                                                01868000
@NM00175 EQU   SCPEOR                                                   01869000
SCPNORT  EQU   SCPEOR                                                   01870000
SCPNOSUC EQU   SCPEOR                                                   01871000
SCPRTERR EQU   SCPEOR                                                   01872000
SCPCOMNT EQU   SCPEOR                                                   01873000
SCPNOCT  EQU   SCPEOR                                                   01874000
SCPCONT  EQU   SCPEOR                                                   01875000
SCPWKAR  EQU   HMASMSCP+8                                               01876000
PRLCONC  EQU   PRLTIME+2                                                01877000
@NM00174 EQU   PRLTIME                                                  01878000
PRLHDADR EQU   PRLDATE                                                  01879000
@NM00173 EQU   PRLFLGS                                                  01880000
PRLBLANK EQU   PRLFLGS                                                  01881000
PRLHEADO EQU   PRLFLGS                                                  01882000
PRLHEAD  EQU   PRLFLGS                                                  01883000
IOPBS04E EQU   IOPBS04+2                                                01884000
IOPBAPFC EQU   IOPBAPF+1                                                01885000
IOPBAPFL EQU   IOPBAPF                                                  01886000
IOPBS2NM EQU   IOPBS02+3                                                01887000
IOPBS2EP EQU   IOPBS02                                                  01888000
IOPQSMTP EQU   IOPQSMLS+8                                               01889000
@NM00158 EQU   IOPQSMLS+7                                               01890000
IOPQSMND EQU   IOPQSMNM                                                 01891000
@NM00157 EQU   @NM00156+7                                               01892000
IOPQSMFM EQU   @NM00156                                                 01893000
@NM00076 EQU   IOPLMCTL+17                                              01894000
IOPLMCRD EQU   IOPLMCTL+9                                               01895000
IOPLMCRN EQU   IOPLMCTL+1                                               01896000
IOPLMCC  EQU   IOPLMCTL                                                 01897000
@NM00051 EQU   IOPUSERL                                                 01898000
@NM00050 EQU   IOPUSERL                                                 01899000
IOPALIS  EQU   IOPUSERL                                                 01900000
IOPTTR   EQU   IOPDRMAP+8                                               01901000
IOPINAM2 EQU   IOPINAM+1                                                01902000
IOPITYP2 EQU   IOPITYP                                                  01903000
@NM00049 EQU   HMASMIOP+32                                              01904000
IOPDELDD EQU   IOPDDNAM                                                 01905000
@NM00048 EQU   @NM00045+10                                              01906000
IOPSEQNO EQU   @NM00045+8                                               01907000
@NM00047 EQU   @NM00046+7                                               01908000
IOPPTFNM EQU   @NM00046                                                 01909000
IOPNAM17 EQU   IOPNAME                                                  01910000
CCABMREC EQU   CCABELMT+10                                              01911000
CCABPOS  EQU   CCABMPOS+8                                               01912000
CCABNAME EQU   CCABMPOS                                                 01913000
@NM00044 EQU   CCABLDLM+2                                               01914000
@NM00043 EQU   CCABLDLM                                                 01915000
CCAUPDPM EQU   @NM00041+24                                              01916000
@NM00042 EQU   @NM00041+21                                              01917000
CCARUPDT EQU   CCAUPDRC                                                 01918000
CCAUPDSP EQU   @NM00041+12                                              01919000
CCAUPDTE EQU   @NM00041+8                                               01920000
CCAUPDNM EQU   @NM00041                                                 01921000
CCASUPPM EQU   @NM00039+24                                              01922000
@NM00040 EQU   @NM00039+21                                              01923000
CCARSUP  EQU   CCASUPRC                                                 01924000
CCASUPSP EQU   @NM00039+12                                              01925000
CCAIOSUP EQU   @NM00039+8                                               01926000
CCASUPNM EQU   @NM00039                                                 01927000
CCAZAPPM EQU   @NM00037+24                                              01928000
@NM00038 EQU   @NM00037+21                                              01929000
CCARZAP  EQU   CCAZAPRC                                                 01930000
CCAZAPSP EQU   @NM00037+12                                              01931000
CCASPZAP EQU   @NM00037+8                                               01932000
CCAZAPNM EQU   @NM00037                                                 01933000
CCACOMPM EQU   @NM00035+24                                              01934000
@NM00036 EQU   @NM00035+21                                              01935000
CCARCOMP EQU   CCACOMRC                                                 01936000
CCACOMSP EQU   @NM00035+12                                              01937000
CCACOMRS EQU   @NM00035+8                                               01938000
CCACOMNM EQU   @NM00035                                                 01939000
CCACPYPM EQU   @NM00033+24                                              01940000
@NM00034 EQU   @NM00033+21                                              01941000
CCARCOPY EQU   CCACPYRC                                                 01942000
CCACPYSP EQU   @NM00033+12                                              01943000
CCACOPY  EQU   @NM00033+8                                               01944000
CCACPYNM EQU   @NM00033                                                 01945000
CCAASMPM EQU   @NM00031+24                                              01946000
@NM00032 EQU   @NM00031+21                                              01947000
CCARASM  EQU   CCAASMRC                                                 01948000
CCAASMSP EQU   @NM00031+12                                              01949000
CCAASM   EQU   @NM00031+8                                               01950000
CCAASMNM EQU   @NM00031                                                 01951000
CCALKDPM EQU   @NM00029+24                                              01952000
@NM00030 EQU   @NM00029+21                                              01953000
CCARLINK EQU   CCALKDRC                                                 01954000
CCALKDSP EQU   @NM00029+12                                              01955000
CCALKED  EQU   @NM00029+8                                               01956000
CCALKDNM EQU   @NM00029                                                 01957000
CCAPGMPM EQU   @NM00027+24                                              01958000
@NM00028 EQU   @NM00027+21                                              01959000
CCABPGRC EQU   @NM00027+20                                              01960000
CCABPGSP EQU   @NM00027+12                                              01961000
CCABPGAD EQU   @NM00027+8                                               01962000
CCABPGNM EQU   @NM00027                                                 01963000
CCAEND   EQU   HMASMCCA+371                                             01964000
@NM00026 EQU   HMASMCCA+309                                             01965000
CCACURDD EQU   CCAFDSNG+3                                               01966000
CCACURDS EQU   CCAFDSNG+2                                               01967000
@NM00025 EQU   CCAFLAGB                                                 01968000
CCAOUTNG EQU   CCAFLAGB                                                 01969000
CCALOGNG EQU   CCAFLAGB                                                 01970000
CCAFMID  EQU   HMASMCCA+291                                             01971000
CCALSTDS EQU   CCAFCTL+8                                                01972000
CCARPTDS EQU   CCAFCTL+7                                                01973000
CCATIME  EQU   CCAFCTL+4                                                01974000
CCADATE  EQU   CCAFCTL+1                                                01975000
@NM00024 EQU   CCAFLAG9                                                 01976000
CCARVCAN EQU   CCAFLAG9                                                 01977000
CCARVEST EQU   CCAFLAG9                                                 01978000
CCAPTSNJ EQU   CCAFLAG9                                                 01979000
CCASTSNP EQU   CCAFLAG9                                                 01980000
CCAMTSNP EQU   CCAFLAG9                                                 01981000
CCAPTSNP EQU   CCAFLAG9                                                 01982000
@NM00023 EQU   CCAFLAG8                                                 01983000
CCAACDSC EQU   CCAFLAG8                                                 01984000
CCACDSC  EQU   CCAFLAG8                                                 01985000
@NM00022 EQU   CCAFLAG6                                                 01986000
CCAACRUP EQU   CCAFLAG6                                                 01987000
CCACRQUP EQU   CCAFLAG6                                                 01988000
CCAACDUP EQU   CCAFLAG6                                                 01989000
CCACDSUP EQU   CCAFLAG6                                                 01990000
@NM00021 EQU   CCAFLAG5                                                 01991000
CCAACROS EQU   CCAFLAG5                                                 01992000
CCACRQOS EQU   CCAFLAG5                                                 01993000
CCAACDOS EQU   CCAFLAG5                                                 01994000
CCACDSOS EQU   CCAFLAG5                                                 01995000
@NM00020 EQU   CCAFLAG4                                                 01996000
CCAACRIS EQU   CCAFLAG4                                                 01997000
CCACRQIS EQU   CCAFLAG4                                                 01998000
CCAACDIS EQU   CCAFLAG4                                                 01999000
CCACDSIS EQU   CCAFLAG4                                                 02000000
@NM00019 EQU   CCAFLAG3+1                                               02001000
CCARGNP  EQU   CCAFLAG3+1                                               02002000
CCADISRQ EQU   CCAFLAG3+1                                               02003000
CCAICTOK EQU   CCAFLAG3                                                 02004000
CCADELP  EQU   CCAFLAG3                                                 02005000
CCACMPRS EQU   CCAFLAG3                                                 02006000
CCAZAPP  EQU   CCAFLAG3                                                 02007000
CCALINKP EQU   CCAFLAG3                                                 02008000
CCACOPYP EQU   CCAFLAG3                                                 02009000
CCAASIP  EQU   CCAFLAG3                                                 02010000
CCAUPDP  EQU   CCAFLAG3                                                 02011000
CCAEOSMP EQU   CCAFLAG2                                                 02012000
CCAEOFNC EQU   CCAFLAG2                                                 02013000
@NM00018 EQU   CCAFLAG2                                                 02014000
CCACHECK EQU   CCAFLAG2                                                 02015000
CCATERM  EQU   CCAFLAG2                                                 02016000
CCASVCLB EQU   CCAFLAG2                                                 02017000
CCANCPTF EQU   CCAFLAG2                                                 02018000
@NM00017 EQU   CCAFLAG1+1                                               02019000
CCAUNL   EQU   CCAFLAG1+1                                               02020000
CCARESET EQU   CCAFLAG1+1                                               02021000
CCALOG   EQU   CCAFLAG1+1                                               02022000
CCACNV   EQU   CCAFLAG1+1                                               02023000
CCALIST  EQU   CCAFLAG1                                                 02024000
CCAUPDU  EQU   CCAFLAG1                                                 02025000
CCAUPDJ  EQU   CCAFLAG1                                                 02026000
CCARES   EQU   CCAFLAG1                                                 02027000
CCAREJ   EQU   CCAFLAG1                                                 02028000
CCAACCPT EQU   CCAFLAG1                                                 02029000
CCAAPPLY EQU   CCAFLAG1                                                 02030000
CCAREC   EQU   CCAFLAG1                                                 02031000
CCAFUNCT EQU   CCAFFUNC                                                 02032000
@NM00016 EQU   @NM00011+18                                              02033000
@NM00015 EQU   @NM00011+16                                              02034000
CCATBLPA EQU   @NM00011+12                                              02035000
@NM00014 EQU   @NM00011+8                                               02036000
@NM00013 EQU   @NM00011+4                                               02037000
@NM00012 EQU   @NM00011                                                 02038000
CCAIFGTP EQU   CCAFGTP+16                                               02039000
CCAGTP3  EQU   CCAFGTP+12                                               02040000
CCAGTP2  EQU   CCAFGTP+8                                                02041000
CCAGTP1  EQU   CCAFGTP+4                                                02042000
CCASETAD EQU   CCASEGTP                                                 02043000
CCACLST  EQU   CCAFPGM+12                                               02044000
CCASPDCB EQU   CCAFPGM+8                                                02045000
CCAICLMD EQU   CCAFICT+12                                               02046000
CCAICMOD EQU   CCAFICT+8                                                02047000
CCAICPTF EQU   CCAFICT+4                                                02048000
CCAICT   EQU   CCAFICT                                                  02049000
CCARVAD  EQU   CCAFSTA                                                  02050000
CCAACDID EQU   CCAFSYS+32                                               02051000
CCACDSID EQU   CCAFSYS+24                                               02052000
CCALNLEN EQU   CCAFSYS+22                                               02053000
@NM00010 EQU   CCAFLAGA                                                 02054000
CCAPSYSF EQU   CCAFLAGA                                                 02055000
CCAASYSF EQU   CCAFLAGA                                                 02056000
CCACSYSF EQU   CCAFLAGA                                                 02057000
CCANUCID EQU   CCAFSYS+20                                               02058000
CCAASREL EQU   CCAFSYS+16                                               02059000
CCACSREL EQU   CCASREL                                                  02060000
CCAPEMAX EQU   CCAFSYS+10                                               02061000
CCAPGLEN EQU   CCAFSYS+8                                                02062000
CCAIOPAS EQU   CCAFSYS+4                                                02063000
CCAIOPCS EQU   CCAFSYS                                                  02064000
CCAPESIZ EQU   CCAFIOP+4                                                02065000
@NM00009 EQU   CCAFLAG7+3                                               02066000
CCALOGP  EQU   CCAFLAG7+2                                               02067000
CCAOUTP  EQU   CCAFLAG7+2                                               02068000
CCASLBP  EQU   CCAFLAG7+2                                               02069000
CCARPTP  EQU   CCAFLAG7+2                                               02070000
CCALISTP EQU   CCAFLAG7+2                                               02071000
CCAJCLP  EQU   CCAFLAG7+2                                               02072000
CCAPTFP  EQU   CCAFLAG7+2                                               02073000
CCATLBP  EQU   CCAFLAG7+2                                               02074000
CCAUT3P  EQU   CCAFLAG7+1                                               02075000
CCAUT2P  EQU   CCAFLAG7+1                                               02076000
CCAUT1P  EQU   CCAFLAG7+1                                               02077000
CCAWK5P  EQU   CCAFLAG7+1                                               02078000
CCAWK4P  EQU   CCAFLAG7+1                                               02079000
CCAWK3P  EQU   CCAFLAG7+1                                               02080000
CCAWK2P  EQU   CCAFLAG7+1                                               02081000
CCAWK1P  EQU   CCAFLAG7+1                                               02082000
CCAACRQP EQU   CCAFLAG7                                                 02083000
CCACRQP  EQU   CCAFLAG7                                                 02084000
CCASTSP  EQU   CCAFLAG7                                                 02085000
CCAMTSP  EQU   CCAFLAG7                                                 02086000
CCAPTSP  EQU   CCAFLAG7                                                 02087000
CCASCDSP EQU   CCAFLAG7                                                 02088000
CCAACDSP EQU   CCAFLAG7                                                 02089000
CCACDSP  EQU   CCAFLAG7                                                 02090000
@NM00008 EQU   CCAFBUFR+122                                             02091000
@NM00007 EQU   CCAFBUFR+120                                             02092000
@NM00006 EQU   CCAFBUFR+118                                             02093000
CCATBFMX EQU   CCAFBUFR+116                                             02094000
CCA4BFMX EQU   CCAFBUFR+114                                             02095000
CCA3BFMX EQU   CCAFBUFR+112                                             02096000
CCA2BFMX EQU   CCAFBUFR+110                                             02097000
CCA1BFMX EQU   CCAFBUFR+108                                             02098000
CCAXBFMX EQU   CCAFBUFR+106                                             02099000
CCAQBFMX EQU   CCAFBUFR+104                                             02100000
CCASBFMX EQU   CCAFBUFR+102                                             02101000
CCAMBFMX EQU   CCAFBUFR+100                                             02102000
CCAPBFMX EQU   CCAFBUFR+98                                              02103000
CCAVBFMX EQU   CCAFBUFR+96                                              02104000
CCAABFMX EQU   CCAFBUFR+94                                              02105000
CCACBFMX EQU   CCAFBUFR+92                                              02106000
@NM00005 EQU   CCAFBUFR+88                                              02107000
@NM00004 EQU   CCAFBUFR+84                                              02108000
CCA4BFSZ EQU   CCAFBUFR+80                                              02109000
CCATBFSZ EQU   CCAFBUFR+76                                              02110000
CCAWBFSZ EQU   CCAFBUFR+72                                              02111000
CCAQBFSZ EQU   CCAFBUFR+68                                              02112000
CCAPBFSZ EQU   CCAFBUFR+64                                              02113000
CCAVBFSZ EQU   CCAFBUFR+60                                              02114000
CCACBFSZ EQU   CCAFBUFR+56                                              02115000
@NM00003 EQU   CCAFBUFR+52                                              02116000
CCA4BFOA EQU   CCAFBUFR+48                                              02117000
CCA4BFIA EQU   CCAFBUFR+44                                              02118000
CCATBFIA EQU   CCAFBUFR+40                                              02119000
CCAWBFOA EQU   CCAFBUFR+36                                              02120000
CCAWBFIA EQU   CCAFBUFR+32                                              02121000
CCAQBFOA EQU   CCAFBUFR+28                                              02122000
CCAQBFIA EQU   CCAFBUFR+24                                              02123000
CCAPBFOA EQU   CCAFBUFR+20                                              02124000
CCAPBFIA EQU   CCAFBUFR+16                                              02125000
CCAVBFOA EQU   CCAFBUFR+12                                              02126000
CCAVBFIA EQU   CCAFBUFR+8                                               02127000
CCACBFOA EQU   CCAFBUFR+4                                               02128000
CCACBFIA EQU   CCAFBUFR                                                 02129000
CCAID    EQU   HMASMCCA                                                 02130000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      02131000
@RF00376 EQU   @EL00002                                                 02132000
@RF00383 EQU   @EL00004                                                 02133000
@RT00392 EQU   @EL00005                                                 02134000
@RC00387 EQU   @EL00005                                                 02135000
@ENDDATA EQU   *                                                        02136000
         END   HMASMASM,(C'PLS1823',0802,78334)                         02137000
