         TITLE 'HMASMCPL  COMPLETENESS DETERMINATION ROUTINE'           00001000
HMASMCPL CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'HMASMCPL  78.334'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00009000
         BALR  @12,0                                               0001 00010000
@PSTART  LA    @10,4095(,@12)                                      0001 00011000
         LA    @09,4095(,@10)                                      0001 00012000
         USING @PSTART,@12                                         0001 00013000
         USING @PSTART+4095,@10                                    0001 00014000
         USING @PSTART+8190,@09                                    0001 00015000
         ST    @13,@SA00001+4                                      0001 00016000
         LA    @14,@SA00001                                        0001 00017000
         ST    @14,8(,@13)                                         0001 00018000
         LR    @13,@14                                             0001 00019000
         MVC   @PC00001(4),0(@01)                                  0001 00020000
*   CPLRTNCD=ZERO;                  /*                               */ 00021000
         SLR   CPLRTNCD,CPLRTNCD                                   0204 00022000
*   IOPPTR=CCAIOPTR;                /* PTR TO IOP                    */ 00023000
         MVC   IOPPTR(4),CCAIOPTR(CCAPTR)                          0205 00024000
*   HMASMMGP=''B;                   /* CLEAR MSG PARM                */ 00025000
         XC    HMASMMGP(28),HMASMMGP                               0206 00026000
*   MGPHLDS=ON;                     /* ALL MSG TO LOG AND            */ 00027000
*   MGPPRINT=ON;                    /* SMPOUT                        */ 00028000
         OI    MGPHLDS,B'10010000'                                 0208 00029000
*   CPLSW=''B;                      /* CLEAR INTERNAL SWITCHES       */ 00030000
         XC    CPLSW(2),CPLSW                                      0209 00031000
*   IF GONOGO=NOGO                  /* IF PARM INDICATED THAT        */ 00032000
*       |GONOGO=DELNOGO             /*                               */ 00033000
*       |GONOGO=STAENOGO            /*                               */ 00034000
*     THEN                          /* PGM RETURN BAD RC THEN SET    */ 00035000
         L     @08,@PC00001                                        0210 00036000
         CLI   GONOGO(@08),C'B'                                    0210 00037000
         BE    @RT00210                                            0210 00038000
         CLI   GONOGO(@08),C'D'                                    0210 00039000
         BE    @RT00210                                            0210 00040000
         CLI   GONOGO(@08),C'S'                                    0210 00041000
         BNE   @RF00210                                            0210 00042000
@RT00210 DS    0H                                                  0211 00043000
*     NOGOSW=ON;                    /* SW TO MAKE CHECK EASIER       */ 00044000
         OI    NOGOSW,B'10000000'                                  0211 00045000
*   RFY                                                            0212 00046000
*     RTNCODE RSTD;                 /*                               */ 00047000
*                                                                  0212 00048000
@RF00210 DS    0H                                                  0213 00049000
*   /*****************************************************************/ 00050000
*   /*                                                               */ 00051000
*   /* CALL TABLE SUBROUTINE TO ZERO OUT USER FLAGS                  */ 00052000
*   /*                                                               */ 00053000
*   /*****************************************************************/ 00054000
*                                                                  0213 00055000
*   TSLPMLAD=ADDR(TSLICTSR);        /* TSL PARAMETER LIST            */ 00056000
         LA    @14,TSLICTSR                                        0213 00057000
         ST    @14,TSLPMLAD                                        0213 00058000
*   TSLTBLXP=ZERO;                  /*                               */ 00059000
         SLR   @14,@14                                             0214 00060000
         ST    @14,TSLTBLXP                                        0214 00061000
*   TSLFUNCT=TSLFCLRP;              /* RESET TEMP FLAGS              */ 00062000
         MVI   TSLFUNCT,X'05'                                      0215 00063000
*   CALL HMASMTSB(TSLPARMS);        /* CALL TBL SUBROUTINE           */ 00064000
         L     @15,@CV01870                                        0216 00065000
         LA    @01,@AL00216                                        0216 00066000
         BALR  @14,@15                                             0216 00067000
*   CPLRTNCD=MAX(CPLRTNCD,RTNCODE); /*                               */ 00068000
*                                                                  0217 00069000
         CR    CPLRTNCD,RTNCODE                                    0217 00070000
         BNL   *+6                                                      00071000
         LR    CPLRTNCD,RTNCODE                                    0217 00072000
*   /*****************************************************************/ 00073000
*   /*                                                               */ 00074000
*   /* CALL ROUTINE TO GO THRU ICT AND MARK ALL ELEMENTS AND RELATED */ 00075000
*   /* ICT ENTRIES COMPLETE AND NOGO (IF REQUIRED) FOR THOSE ELEMENTS*/ 00076000
*   /* PROCESSED THIS TIME                                           */ 00077000
*   /*                                                               */ 00078000
*   /*****************************************************************/ 00079000
*                                                                  0218 00080000
*   IF CPLRTNCD<STOPFUNC            /*                               */ 00081000
*     THEN                          /*                               */ 00082000
         CH    CPLRTNCD,@CH00033                                   0218 00083000
         BNL   @RF00218                                            0218 00084000
*     DO;                           /*                               */ 00085000
*       CALL ICTCK1;                /*                               */ 00086000
         BAL   @14,ICTCK1                                          0220 00087000
*       CPLRTNCD=MAX(CPLRTNCD,RTNCODE);/*                            */ 00088000
         CR    CPLRTNCD,RTNCODE                                    0221 00089000
         BNL   *+6                                                      00090000
         LR    CPLRTNCD,RTNCODE                                    0221 00091000
*     END;                          /*                               */ 00092000
*                                                                  0222 00093000
*   /*****************************************************************/ 00094000
*   /*                                                               */ 00095000
*   /* CALL ROUTINE TO PUT OUT ERROR MESSAGE FOR ALL SYSMODS         */ 00096000
*   /* TERMINATED DUE TO ERROR IN LAST SYSTEM UTILITY INVOKED        */ 00097000
*   /*                                                               */ 00098000
*   /*****************************************************************/ 00099000
*                                                                  0223 00100000
*   IF CPLRTNCD<STOPFUNC            /*                               */ 00101000
*     THEN                          /*                               */ 00102000
@RF00218 CH    CPLRTNCD,@CH00033                                   0223 00103000
         BNL   @RF00223                                            0223 00104000
*     DO;                           /*                               */ 00105000
*       CALL SMDNG1;                /*                               */ 00106000
         BAL   @14,SMDNG1                                          0225 00107000
*       CPLRTNCD=MAX(CPLRTNCD,RTNCODE);/*                            */ 00108000
         CR    CPLRTNCD,RTNCODE                                    0226 00109000
         BNL   *+6                                                      00110000
         LR    CPLRTNCD,RTNCODE                                    0226 00111000
*     END;                          /*                               */ 00112000
*                                                                  0227 00113000
*   /*****************************************************************/ 00114000
*   /*                                                               */ 00115000
*   /* NOW CALL ROUTINE TO CHECK FOR ANY SYSMODS THAT SHOULD BE      */ 00116000
*   /* TERMINATED DUE TO PROCESS ERROR IN ANOTHER SYSMOD             */ 00117000
*   /*                                                               */ 00118000
*   /*****************************************************************/ 00119000
*                                                                  0228 00120000
*   IF CPLRTNCD<STOPFUNC            /*                               */ 00121000
*     THEN                          /*                               */ 00122000
@RF00223 CH    CPLRTNCD,@CH00033                                   0228 00123000
         BNL   @RF00228                                            0228 00124000
*     DO;                           /*                               */ 00125000
*       CALL SMDNG2;                /*                               */ 00126000
         BAL   @14,SMDNG2                                          0230 00127000
*       CPLRTNCD=MAX(CPLRTNCD,RTNCODE);/*                            */ 00128000
         CR    CPLRTNCD,RTNCODE                                    0231 00129000
         BNL   *+6                                                      00130000
         LR    CPLRTNCD,RTNCODE                                    0231 00131000
*     END;                          /*                               */ 00132000
*                                                                  0232 00133000
*   /*****************************************************************/ 00134000
*   /*                                                               */ 00135000
*   /* CALL ROUTINE TO CHECK TO SEE WHETHER ANY SYSMODS HAVE         */ 00136000
*   /* COMPLETED SUCCESSFULLY OR NOT AND MARK THEM AND ALL RELATED   */ 00137000
*   /* SYSMODS COMPLETE AND NOGO IF REQUIRED                         */ 00138000
*   /*                                                               */ 00139000
*   /*****************************************************************/ 00140000
*                                                                  0233 00141000
*   IF CPLRTNCD<STOPFUNC            /*                               */ 00142000
*     THEN                          /*                               */ 00143000
@RF00228 CH    CPLRTNCD,@CH00033                                   0233 00144000
         BNL   @RF00233                                            0233 00145000
*     DO;                           /*                               */ 00146000
*       CALL SMDCK1;                /*                               */ 00147000
         BAL   @14,SMDCK1                                          0235 00148000
*       CPLRTNCD=MAX(CPLRTNCD,RTNCODE);/*                            */ 00149000
         CR    CPLRTNCD,RTNCODE                                    0236 00150000
         BNL   *+6                                                      00151000
         LR    CPLRTNCD,RTNCODE                                    0236 00152000
*     END;                          /*                               */ 00153000
*                                                                  0237 00154000
*   /*****************************************************************/ 00155000
*   /*                                                               */ 00156000
*   /* CALL ROUTINE TO CHECK FOR ANY SYSMODS THAT WERE COMPLETED     */ 00157000
*   /* SUCCESSFULLY IN THIS PASS (IE ALL MODS COMPLETE AND ALL       */ 00158000
*   /* REQUISITE SYSMODS SATISFIED                                   */ 00159000
*   /*                                                               */ 00160000
*   /*****************************************************************/ 00161000
*                                                                  0238 00162000
*   IF CPLRTNCD<STOPFUNC            /*                               */ 00163000
*     THEN                          /*                               */ 00164000
@RF00233 CH    CPLRTNCD,@CH00033                                   0238 00165000
         BNL   @RF00238                                            0238 00166000
*     DO;                           /*                               */ 00167000
*       CALL SMDOK1;                /*                               */ 00168000
         BAL   @14,SMDOK1                                          0240 00169000
*       CPLRTNCD=MAX(CPLRTNCD,RTNCODE);/*                            */ 00170000
         CR    CPLRTNCD,RTNCODE                                    0241 00171000
         BNL   *+6                                                      00172000
         LR    CPLRTNCD,RTNCODE                                    0241 00173000
*     END;                          /*                               */ 00174000
*                                                                  0242 00175000
*   /*****************************************************************/ 00176000
*   /*                                                               */ 00177000
*   /* IF PREVIOUS FUNCTIONS OK THEN CALL ROUTINE TO CHECK TO SEE IF */ 00178000
*   /* ANY LMODS WERE COMPLETED DURING THIS PASS AND MARK LMODS      */ 00179000
*   /* COMPLETE                                                      */ 00180000
*   /*                                                               */ 00181000
*   /*****************************************************************/ 00182000
*                                                                  0243 00183000
*   IF CPLRTNCD<STOPFUNC            /*                               */ 00184000
*     THEN                          /*                               */ 00185000
@RF00238 CH    CPLRTNCD,@CH00033                                   0243 00186000
         BNL   @RF00243                                            0243 00187000
*     DO;                           /*                               */ 00188000
*       CALL LMDCK1;                /*                               */ 00189000
         BAL   @14,LMDCK1                                          0245 00190000
*       CPLRTNCD=MAX(CPLRTNCD,RTNCODE);/*                            */ 00191000
         CR    CPLRTNCD,RTNCODE                                    0246 00192000
         BNL   *+6                                                      00193000
         LR    CPLRTNCD,RTNCODE                                    0246 00194000
*     END;                          /*                               */ 00195000
*                                                                  0247 00196000
*   /*****************************************************************/ 00197000
*   /*                                                               */ 00198000
*   /* PRIOR TO RETURNING CALL ROUTINE TO GO THRU AND TURN OFF THE IN*/ 00199000
*   /* PROCESS INDICATOR FOR ALL THOSE ELEMENTS THAT ARE MARKED      */ 00200000
*   /* COMPLETED                                                     */ 00201000
*   /*                                                               */ 00202000
*   /*****************************************************************/ 00203000
*                                                                  0248 00204000
*   CALL CPLRESET;                  /*                               */ 00205000
@RF00243 BAL   @14,CPLRESET                                        0248 00206000
*   CPLRTNCD=MAX(CPLRTNCD,RTNCODE); /* SAVE RC                       */ 00207000
*                                                                  0249 00208000
         CR    CPLRTNCD,RTNCODE                                    0249 00209000
         BNL   *+6                                                      00210000
         LR    CPLRTNCD,RTNCODE                                    0249 00211000
*   /*****************************************************************/ 00212000
*   /*                                                               */ 00213000
*   /* RETURN TO CALLER                                              */ 00214000
*   /*                                                               */ 00215000
*   /*****************************************************************/ 00216000
*                                                                  0250 00217000
*   RETURN CODE(CPLRTNCD);          /*                               */ 00218000
         LR    @15,CPLRTNCD                                        0250 00219000
         L     @13,4(,@13)                                         0250 00220000
         L     @14,12(,@13)                                        0250 00221000
         LM    @00,@12,20(@13)                                     0250 00222000
         BR    @14                                                 0250 00223000
*   RFY                                                            0251 00224000
*     RTNCODE UNRSTD;               /*                               */ 00225000
         EJECT                                                          00226000
*                                                                  0252 00227000
*   /*****************************************************************/ 00228000
*   /*                                                               */ 00229000
*   /* THIS ROUTINE IS CALLED UPON ENTRY TO SEARCH THRU THE ICT TO   */ 00230000
*   /* DETERMINE WHICH LMOD, MOD, AND SYSMOD WERE POTENTIALLY        */ 00231000
*   /* COMPLETED DURING THE LAST INVOCATION OF THE SYSTEM UTILITY    */ 00232000
*   /*                                                               */ 00233000
*   /*****************************************************************/ 00234000
*                                                                  0252 00235000
*ICTCK1:                            /*                               */ 00236000
*   PROCEDURE;                      /*                               */ 00237000
ICTCK1   STM   @14,@12,@SA00002                                    0252 00238000
*   DECLARE                         /*                               */ 00239000
*     M1PTR PTR(31),                /* PTR FOR ICT MOD LOOP          */ 00240000
*     MX1 FIXED(31),                /* INDEX THRU MODS INDEX         */ 00241000
*     M3PTR PTR(31),                /* PTR FOR ICT MOD LOOP          */ 00242000
*     L1PTR PTR(31),                /* PTR FOR ICT LMOD LOOP         */ 00243000
*     LX1 FIXED(31);                /* INDEX THRU LMOD INDEX         */ 00244000
*   DECLARE                         /*                               */ 00245000
*     OK1NGSET CHAR(1);             /*                               */ 00246000
*   RFY                                                            0255 00247000
*     ICTMOD BASED(M1PTR);          /* MOD BASED ON LOOP PTR         */ 00248000
*                                                                  0255 00249000
*   /*****************************************************************/ 00250000
*   /*                                                               */ 00251000
*   /* LOOP THRU ALL MOD ENTRIES TO SEE IF ANY MODS WERE LEFT AS     */ 00252000
*   /* NON-SELECTED BUT WITHOUT ANOTHER RELATED SELECTED ELEMENT.    */ 00253000
*   /* THIS COULD HAPPEN WHEN THE CDS/ACDS INDICATES THAT A HIGHER   */ 00254000
*   /* LEVEL OF THE MODULE ALREADY EXISTS. THUS ALL MODS FOR A SYSMOD*/ 00255000
*   /* COULD BE NON-SELECTED.                                        */ 00256000
*   /*                                                               */ 00257000
*   /*****************************************************************/ 00258000
*                                                                  0256 00259000
*   DO M1PTR=CCAICMOD BY LENGTH(ICTMOD(1)) WHILE(/* MOD LOOP         */ 00260000
*         ICTMEND(1)^=ICTENDNT);    /* TILL END                      */ 00261000
         L     M1PTR,CCAICMOD(,CCAPTR)                             0256 00262000
         B     @DE00256                                            0256 00263000
@DL00256 DS    0H                                                  0257 00264000
*     IF ICTMISEL(1)=OFF            /* IF ELEMENT NOT SELECTED       */ 00265000
*         &ICTMCPL(1)=OFF           /* AND NOT COMPLETE YET          */ 00266000
*       THEN                        /*                               */ 00267000
         TM    ICTMISEL(M1PTR),B'10000000'                         0257 00268000
         BNZ   @RF00257                                            0257 00269000
         TM    ICTMCPL(M1PTR),B'00100000'                          0257 00270000
         BNZ   @RF00257                                            0257 00271000
*       DO;                         /*                               */ 00272000
*         STOP=OFF;                 /*                               */ 00273000
         NI    STOP,B'10111111'                                    0259 00274000
*         DO M3PTR=CCAICMOD BY LENGTH(ICTMOD(1)) WHILE(/* MOD LOOP   */ 00275000
*               M3PTR->ICTMEND(1)^=ICTENDNT/* TILL END               */ 00276000
*               &STOP=OFF);         /* OR RELATED ELEMENT FOUND      */ 00277000
         L     M3PTR,CCAICMOD(,CCAPTR)                             0260 00278000
         B     @DE00260                                            0260 00279000
@DL00260 DS    0H                                                  0261 00280000
*           IF M1PTR^=M3PTR         /* IF NOT SAME ELEMENT ENTRY     */ 00281000
*               &ICTMNAME(1)=M3PTR->ICTMNAME(1)/* NAMES THE SAME     */ 00282000
*               &M3PTR->ICTMISEL(1)=ON/* AND ELEMENT SELECTED        */ 00283000
*             THEN                  /*                               */ 00284000
         CR    M1PTR,M3PTR                                         0261 00285000
         BE    @RF00261                                            0261 00286000
         CLC   ICTMNAME(8,M1PTR),ICTMNAME(M3PTR)                   0261 00287000
         BNE   @RF00261                                            0261 00288000
         TM    ICTMISEL(M3PTR),B'10000000'                         0261 00289000
         BNO   @RF00261                                            0261 00290000
*             DO;                   /*                               */ 00291000
*               IF ICTMFLG1(1)=M3PTR->ICTMFLG1(1)/* AND SAME TYPE    */ 00292000
*                 THEN              /*                               */ 00293000
         CLC   ICTMFLG1(1,M1PTR),ICTMFLG1(M3PTR)                   0263 00294000
         BNE   @RF00263                                            0263 00295000
*                 STOP=ON;          /* STOP SEARCH                   */ 00296000
         OI    STOP,B'01000000'                                    0264 00297000
*               ELSE                /*                               */ 00298000
*                 IF ICTMASM(1)=ON&M3PTR->ICTMMOD(1)=ON/* MOD/ASM PR */ 00299000
*                   THEN            /*                               */ 00300000
         B     @RC00263                                            0265 00301000
@RF00263 TM    ICTMASM(M1PTR),B'01000000'                          0265 00302000
         BNO   @RF00265                                            0265 00303000
         TM    ICTMMOD(M3PTR),B'10000000'                          0265 00304000
         BNO   @RF00265                                            0265 00305000
*                   STOP=ON;        /* STOP SEARCH                   */ 00306000
         OI    STOP,B'01000000'                                    0266 00307000
*                 ELSE              /*                               */ 00308000
*                   IF ICTMMOD(1)=ON&M3PTR->ICTMASM(1)=ON/* ASM/MOD  */ 00309000
*                     THEN          /*                               */ 00310000
         B     @RC00265                                            0267 00311000
@RF00265 TM    ICTMMOD(M1PTR),B'10000000'                          0267 00312000
         BNO   @RF00267                                            0267 00313000
         TM    ICTMASM(M3PTR),B'01000000'                          0267 00314000
         BNO   @RF00267                                            0267 00315000
*                     STOP=ON;      /* STOP SEARCH                   */ 00316000
         OI    STOP,B'01000000'                                    0268 00317000
*             END;                  /*                               */ 00318000
@RF00267 DS    0H                                                  0269 00319000
@RC00265 DS    0H                                                  0269 00320000
@RC00263 DS    0H                                                  0270 00321000
*         END;                      /* END SEARCH FOR RELATED ELEM   */ 00322000
@RF00261 AH    M3PTR,@CH02175                                      0270 00323000
@DE00260 CLC   ICTMEND(4,M3PTR),ICTENDNT                           0270 00324000
         BE    @DC00260                                            0270 00325000
         TM    STOP,B'01000000'                                    0270 00326000
         BZ    @DL00260                                            0270 00327000
@DC00260 DS    0H                                                  0271 00328000
*         IF STOP=OFF               /* IF NO RELATED ELEMENT FOUND   */ 00329000
*           THEN                    /*                               */ 00330000
         TM    STOP,B'01000000'                                    0271 00331000
         BNZ   @RF00271                                            0271 00332000
*           DO;                     /*                               */ 00333000
*             ICTMPROC(1)=ON;       /* MOD IN PROCESS                */ 00334000
*             ICTMCPL(1)=ON;        /* MOD COMPLETE                  */ 00335000
         OI    ICTMPROC(M1PTR),B'10100000'                         0274 00336000
*           END;                    /*                               */ 00337000
*       END;                        /* END ELEMENT NOT SELECTED      */ 00338000
@RF00271 DS    0H                                                  0277 00339000
*   END;                            /* END ICT MOD LOOP              */ 00340000
@RF00257 AH    M1PTR,@CH02175                                      0277 00341000
@DE00256 CLC   ICTMEND(4,M1PTR),ICTENDNT                           0277 00342000
         BNE   @DL00256                                            0277 00343000
*                                                                  0278 00344000
*   /*****************************************************************/ 00345000
*   /*                                                               */ 00346000
*   /* LOOP THRU ALL LMODS AND IF LMOD IN PROCESS THEN ALL MODS FOR  */ 00347000
*   /* LMOD ALSO IN PROCESS. IF LMOD NOGO THEN ALL MODS NOGO. IF LMOD*/ 00348000
*   /* MARKED IN PROCESS THEN CALL MUST BE AFTER LINK OR COPY SO DO  */ 00349000
*   /* NOT MARK ZAPS FOR THAT LMOD AS COMPLETED YET.                 */ 00350000
*   /*                                                               */ 00351000
*   /*****************************************************************/ 00352000
*                                                                  0278 00353000
*   RFY                                                            0278 00354000
*     ICTLMOD BASED(L1PTR);         /* BASE FOR ICT LMODS            */ 00355000
*   RFY                                                            0279 00356000
*     ICTIXLF BASED(ICTLCHN(1));    /* LMOD TO MOD INDEX LIST        */ 00357000
*   RFY                                                            0280 00358000
*     ICTMOD BASED(ICTIXL(LX1));    /* MOD BASED ON LMOD CHAIN       */ 00359000
*   DO L1PTR=CCAICLMD BY LENGTH(ICTLMOD(1)) WHILE(/* LMOD LOOP       */ 00360000
*         ICTLEND(1)^=ICTENDNT);    /*                               */ 00361000
         L     L1PTR,CCAICLMD(,CCAPTR)                             0281 00362000
         B     @DE00281                                            0281 00363000
@DL00281 DS    0H                                                  0282 00364000
*     IF ICTLPROC(1)=ON             /* IF LMOD PROCESSED IN THIS PASS*/ 00365000
*       THEN                        /*                               */ 00366000
         TM    ICTLPROC(L1PTR),B'10000000'                         0282 00367000
         BNO   @RF00282                                            0282 00368000
*       DO;                         /*                               */ 00369000
*         ICTLCPL(1)=ON;            /* LMOD IS COMPLETE              */ 00370000
         OI    ICTLCPL(L1PTR),B'00100000'                          0284 00371000
*         IF NOGOSW=ON              /* IF ERR IN PROCESS             */ 00372000
*           THEN                    /*                               */ 00373000
         TM    NOGOSW,B'10000000'                                  0285 00374000
         BNO   @RF00285                                            0285 00375000
*           ICTLNOGO(1)=ON;         /* LMOD IS NOGO                  */ 00376000
         OI    ICTLNOGO(L1PTR),B'01000000'                         0286 00377000
*         DO LX1=1 BY 1 WHILE(      /* LOOP THRU ALL LMOD TO MOD     */ 00378000
*               ICTIXL(LX1)^=ICTENDIX);/* INDEX LIST                 */ 00379000
@RF00285 LA    LX1,1                                               0287 00380000
         B     @DE00287                                            0287 00381000
@DL00287 DS    0H                                                  0288 00382000
*           IF ICTMZAP(1)=OFF       /* IF MOD IS NOT ZAP             */ 00383000
*             THEN                  /* THEN MOD IN PROCESS           */ 00384000
         LR    @08,LX1                                             0288 00385000
         SLA   @08,2                                               0288 00386000
         L     @01,ICTLCHN(,L1PTR)                                 0288 00387000
         AL    @01,@CF02213                                        0288 00388000
         L     @08,ICTIXL(@08,@01)                                 0288 00389000
         TM    ICTMZAP(@08),B'00100000'                            0288 00390000
         BNZ   @RF00288                                            0288 00391000
*             DO;                   /*                               */ 00392000
*               ICTMPROC(1)=ON;     /* MOD ALSO PROCESSED THIS PASS  */ 00393000
         OI    ICTMPROC(@08),B'10000000'                           0290 00394000
*               IF NOGOSW=ON        /* IF LMOD NOGO                  */ 00395000
*                 THEN              /* THEN                          */ 00396000
         TM    NOGOSW,B'10000000'                                  0291 00397000
         BNO   @RF00291                                            0291 00398000
*                 DO;               /*                               */ 00399000
*                   ICTMNOGO(1)=ON; /* MOD ALSO NOGO                 */ 00400000
*                   ICTMCPL(1)=ON;  /* MOD ALSO COMPLETE             */ 00401000
         OI    ICTMNOGO(@08),B'01100000'                           0294 00402000
*                 END;              /*                               */ 00403000
*             END;                  /*                               */ 00404000
@RF00291 DS    0H                                                  0297 00405000
*         END;                      /* END LOOP THRU LMOD TO MOD     */ 00406000
@RF00288 AH    LX1,@CH00037                                        0297 00407000
@DE00287 LR    @08,LX1                                             0297 00408000
         SLA   @08,2                                               0297 00409000
         L     @01,ICTLCHN(,L1PTR)                                 0297 00410000
         AL    @01,@CF02213                                        0297 00411000
         L     @08,ICTIXL(@08,@01)                                 0297 00412000
         CL    @08,ICTENDIX                                        0297 00413000
         BNE   @DL00287                                            0297 00414000
*       END;                        /* END LMOD PROCESSED THIS PASS  */ 00415000
*   END;                            /* END LOOP THRU LMODS           */ 00416000
@RF00282 AH    L1PTR,@CH01013                                      0299 00417000
@DE00281 CLC   ICTLEND(4,L1PTR),ICTENDNT                           0299 00418000
         BNE   @DL00281                                            0299 00419000
*                                                                  0300 00420000
*   /*****************************************************************/ 00421000
*   /*                                                               */ 00422000
*   /* NOW LOOP THRU ALL ICT MODS AND IF ANY MOD IN PROCESS THEN PTF */ 00423000
*   /* FOR THAT MOD ALSO IN PROCESS. IF MOD IS NOGO THEN PTF IS ALSO */ 00424000
*   /* NOGO IF TYPE MOD ENTRY IS MOD OR ZAP AND NOT COMPLETE THEN IF */ 00425000
*   /* ALL LMODS ARE COMPLETE OR IF NO LMODS THEM MOD CPL.           */ 00426000
*   /*                                                               */ 00427000
*   /*****************************************************************/ 00428000
*                                                                  0300 00429000
*   RFY                                                            0300 00430000
*     ICTMOD BASED(M1PTR);          /* BASE FOR ICT MODS             */ 00431000
*   RFY                                                            0301 00432000
*     ICTPTF BASED(ICTPPTR(1));     /* PTF BASED ON PTR FROM MOD     */ 00433000
*   RFY                                                            0302 00434000
*     ICTIXMF BASED(ICTMCHN(1));    /* MOD TO LMOD CHAIN             */ 00435000
*   RFY                                                            0303 00436000
*     ICTLMOD BASED(ICTIXM(MX1));   /* LMOD BASED ON MOD CHAIN PTR   */ 00437000
*   DO M1PTR=CCAICMOD BY LENGTH(ICTMOD(1)) WHILE(/* MOD LOOP         */ 00438000
*         ICTMEND(1)^=ICTENDNT);    /* TILL END                      */ 00439000
         L     M1PTR,CCAICMOD(,CCAPTR)                             0304 00440000
         B     @DE00304                                            0304 00441000
@DL00304 DS    0H                                                  0305 00442000
*     IF ICTMPROC(1)=ON             /* IF MOD PROCESSED IN THIS PASS */ 00443000
*       THEN                        /*                               */ 00444000
         TM    ICTMPROC(M1PTR),B'10000000'                         0305 00445000
         BNO   @RF00305                                            0305 00446000
*       DO;                         /*                               */ 00447000
*         ICTPPROC(1)=ON;           /* PTF IN PROCESS ALSO           */ 00448000
         L     @08,ICTPPTR(,M1PTR)                                 0307 00449000
         OI    ICTPPROC(@08),B'10000000'                           0307 00450000
*         IF NOGOSW=ON              /* IF PROCESS FAILED             */ 00451000
*           THEN                    /* THEN                          */ 00452000
         TM    NOGOSW,B'10000000'                                  0308 00453000
         BNO   @RF00308                                            0308 00454000
*           DO;                     /*                               */ 00455000
*             ICTMNOGO(1)=ON;       /* MARK MOD NOGO                 */ 00456000
*             ICTMCPL(1)=ON;        /* MARK MOD COMPLETE             */ 00457000
         OI    ICTMNOGO(M1PTR),B'01100000'                         0311 00458000
*             ICTPNOGO(1)=ON;       /* MARK PTF NOGO                 */ 00459000
*             ICTPCPL(1)=ON;        /* MARK PTF COMPLETED            */ 00460000
         L     @08,ICTPPTR(,M1PTR)                                 0313 00461000
         OI    ICTPNOGO(@08),B'01100000'                           0313 00462000
*           END;                    /* END MOD NOGO                  */ 00463000
*         IF ICTMMACR(1)=ON         /* IF MAC REPLACEMENT            */ 00464000
*             |ICTMMACU(1)=ON       /* OR MAC UPDATE                 */ 00465000
*             |ICTMSRCR(1)=ON       /* OR SRC REPLACEMENT            */ 00466000
*             |ICTMSRCU(1)=ON       /* OR SRC UPATE                  */ 00467000
*             |ICTMZAP(1)=ON        /* OR ZAP                        */ 00468000
*             |(ICTMMOD(1)=ON       /* OR MOD                        */ 00469000
*             &ICTMIDEL(1)=ON)      /* ... TO BE DELETED (NO LMODS)  */ 00470000
*             |(ICTMASM(1)=ON       /* OR ASSEM THAT IS NOT TO BE    */ 00471000
*             &ICTMMOD(1)=OFF)      /* LINKED(ASSEM NOT FOUND)       */ 00472000
*           THEN                    /* THEN PROCESSING IS COMPLETED  */ 00473000
@RF00308 TM    ICTMMACR(M1PTR),B'00101111'                         0315 00474000
         BNZ   @RT00315                                            0315 00475000
         TM    ICTMMOD(M1PTR),B'10000000'                          0315 00476000
         BNO   @GL00009                                            0315 00477000
         TM    ICTMIDEL(M1PTR),B'01000000'                         0315 00478000
         BO    @RT00315                                            0315 00479000
@GL00009 TM    ICTMASM(M1PTR),B'01000000'                          0315 00480000
         BNO   @RF00315                                            0315 00481000
         TM    ICTMMOD(M1PTR),B'10000000'                          0315 00482000
         BNZ   @RF00315                                            0315 00483000
@RT00315 DS    0H                                                  0316 00484000
*           ICTMCPL(1)=ON;          /* FOR THESE ELEMENTS SINCE IT IS   00485000
*                                      DONE ON THE MODULE CONTROL  0316 00486000
*                                      LEVEL                         */ 00487000
         OI    ICTMCPL(M1PTR),B'00100000'                          0316 00488000
*       END;                        /* END MOD PROCESSED IN THIS PASS*/ 00489000
@RF00315 DS    0H                                                  0318 00490000
*     IF ICTMCPL(1)=OFF             /* IF MOD NOT COMPLETE YET       */ 00491000
*         &ICTMISEL(1)=ON           /* AND MOD SELECTED              */ 00492000
*         &ICTMIDEL(1)=OFF          /* AND MOD NOT DELETED           */ 00493000
*         &(ICTMMOD(1)=ON           /* AND TYPE=MOD                  */ 00494000
*         |ICTMXPND(1)=ON)          /* OR EXPAND ZAP                 */ 00495000
*       THEN                        /*                               */ 00496000
@RF00305 TM    ICTMCPL(M1PTR),B'00100000'                          0318 00497000
         BNZ   @RF00318                                            0318 00498000
         TM    ICTMISEL(M1PTR),B'10000000'                         0318 00499000
         BNO   @RF00318                                            0318 00500000
         TM    ICTMIDEL(M1PTR),B'01000000'                         0318 00501000
         BNZ   @RF00318                                            0318 00502000
         TM    ICTMMOD(M1PTR),B'10010000'                          0318 00503000
         BZ    @RF00318                                            0318 00504000
*       DO;                         /*                               */ 00505000
*                                                                  0319 00506000
*         /***********************************************************/ 00507000
*         /*                                                         */ 00508000
*         /* CHECK ALL LMODS FOR NON-DELETED MOD ENTRIES             */ 00509000
*         /*                                                         */ 00510000
*         /***********************************************************/ 00511000
*                                                                  0320 00512000
*         ICTMCPL(1)=ON;            /* ASSUME ALL LMODS FOR MOD CPL  */ 00513000
         OI    ICTMCPL(M1PTR),B'00100000'                          0320 00514000
*         DO MX1=1 BY 1 WHILE(      /* LOOP THRU MOD TO LMOD INDEX   */ 00515000
*               ICTIXM(MX1)^=ICTENDIX);/* TILL END                   */ 00516000
         LA    MX1,1                                               0321 00517000
         B     @DE00321                                            0321 00518000
@DL00321 DS    0H                                                  0322 00519000
*           IF ICTLCPL(1)=OFF       /* IF LMOD NOT COMPLETE          */ 00520000
*             THEN                  /* THEN                          */ 00521000
         LR    @08,MX1                                             0322 00522000
         SLA   @08,2                                               0322 00523000
         L     @01,ICTMCHN(,M1PTR)                                 0322 00524000
         AL    @01,@CF02213                                        0322 00525000
         L     @08,ICTIXM(@08,@01)                                 0322 00526000
         TM    ICTLCPL(@08),B'00100000'                            0322 00527000
         BNZ   @RF00322                                            0322 00528000
*             ICTMCPL(1)=OFF;       /* MOD NOT COMPLETE              */ 00529000
         NI    ICTMCPL(M1PTR),B'11011111'                          0323 00530000
*         END;                      /* END MOD TO LOM INDEX LOOP     */ 00531000
@RF00322 AH    MX1,@CH00037                                        0324 00532000
@DE00321 LR    @08,MX1                                             0324 00533000
         SLA   @08,2                                               0324 00534000
         L     @01,ICTMCHN(,M1PTR)                                 0324 00535000
         AL    @01,@CF02213                                        0324 00536000
         L     @08,ICTIXM(@08,@01)                                 0324 00537000
         CL    @08,ICTENDIX                                        0324 00538000
         BNE   @DL00321                                            0324 00539000
*         IF ICTMCPL(1)=ON          /* IF MOD COMPLETE THEN          */ 00540000
*           THEN                    /*                               */ 00541000
         TM    ICTMCPL(M1PTR),B'00100000'                          0325 00542000
         BNO   @RF00325                                            0325 00543000
*           DO;                     /*                               */ 00544000
*             ICTMPROC(1)=ON;       /* INSURE ALSO IN PROCESS        */ 00545000
         OI    ICTMPROC(M1PTR),B'10000000'                         0327 00546000
*             ICTPPROC(1)=ON;       /*                               */ 00547000
         L     @08,ICTPPTR(,M1PTR)                                 0328 00548000
         OI    ICTPPROC(@08),B'10000000'                           0328 00549000
*           END;                    /*                               */ 00550000
*       END;                        /* END MOD NOT COMPLETE YET      */ 00551000
@RF00325 DS    0H                                                  0331 00552000
*   END;                            /* END LOOP THRU MODS            */ 00553000
@RF00318 AH    M1PTR,@CH02175                                      0331 00554000
@DE00304 CLC   ICTMEND(4,M1PTR),ICTENDNT                           0331 00555000
         BNE   @DL00304                                            0331 00556000
*                                                                  0332 00557000
*   /*****************************************************************/ 00558000
*   /*                                                               */ 00559000
*   /* LOOP CALLING ROUTINES TO MARK ALL RELATED ELEMENTS AS IN      */ 00560000
*   /* PROCESS AND POSSIBLY NOGO AND THEN CALL ROUTINE TO MARK ALL   */ 00561000
*   /* ELEMENTS OF NOGO SYSMODS AS NOGO AND COMPLETE. THIS LOOP      */ 00562000
*   /* CONTINUES UNTIL NO MORE SYSMODS ARE MARKED NOGO.              */ 00563000
*   /*                                                               */ 00564000
*   /*****************************************************************/ 00565000
*                                                                  0332 00566000
*   OK1NGSET=YES;                   /* ALLOW LOOP TO START           */ 00567000
         MVI   OK1NGSET,C'Y'                                       0332 00568000
*   DO WHILE(OK1NGSET=YES);         /* LOOP TILL NO PTFS MARKED NOGO */ 00569000
         B     @DE00333                                            0333 00570000
@DL00333 DS    0H                                                  0334 00571000
*     OK1NGSET=NO;                  /* SET TO STOP LOOP AFTER THIS   */ 00572000
         MVI   OK1NGSET,C'N'                                       0334 00573000
*     CALL CPLRELEM(OK1NGSET);      /* CHECK FOR RELATED ELEMENTS    */ 00574000
         LA    @01,@AL00335                                        0335 00575000
         BAL   @14,CPLRELEM                                        0335 00576000
*     CALL CPLMODNG;                /* MARK MODS FOR NOGO PTF NOGO   */ 00577000
         BAL   @14,CPLMODNG                                        0336 00578000
*   END;                            /*                               */ 00579000
@DE00333 CLI   OK1NGSET,C'Y'                                       0337 00580000
         BE    @DL00333                                            0337 00581000
*   RETURN CODE(ZERO);              /*                               */ 00582000
         SLR   @15,@15                                             0338 00583000
         L     @14,@SA00002                                        0338 00584000
         LM    @00,@12,@SA00002+8                                  0338 00585000
         BR    @14                                                 0338 00586000
*   END ICTCK1;                     /*                               */ 00587000
         EJECT                                                          00588000
*                                                                  0340 00589000
*   /*****************************************************************/ 00590000
*   /*                                                               */ 00591000
*   /* THIS ROUTINE IS CALLED AFTER INITIAL CHECKING OF THE ICT. ALL */ 00592000
*   /* SYSMODS THAT ARE MARKED NOGO AT THIS TIME HAVE BEEN MARKED AS */ 00593000
*   /* SUCH DUE TO AN ERROR IN ONE OF THE UTILITIES THAT WAS INVOKED */ 00594000
*   /* FOR ONE OF THE ELEMENTS OF THE SYSMOD. ISSUE A MESSAGE FOR THE*/ 00595000
*   /* SYSMOD INDICATING FUNCTION FAILED AND CAUSE WAS UTILITY       */ 00596000
*   /* FAULURE                                                       */ 00597000
*   /*                                                               */ 00598000
*   /*****************************************************************/ 00599000
*                                                                  0340 00600000
*SMDNG1:                            /*                               */ 00601000
*   PROCEDURE;                      /*                               */ 00602000
SMDNG1   STM   @14,@12,@SA00003                                    0340 00603000
*   DECLARE                         /*                               */ 00604000
*     P4PTR PTR(31);                /* PTR FOR ICT PTF LOOP          */ 00605000
*   RFY                                                            0342 00606000
*     ICTPTF BASED(P4PTR);          /*                               */ 00607000
*   DO P4PTR=CCAICPTF BY LENGTH(ICTPTF(1)) WHILE(/* PTF LOOP         */ 00608000
*         ICTPEND(1)^=ICTENDNT);    /* TILL END                      */ 00609000
         L     P4PTR,CCAICPTF(,CCAPTR)                             0343 00610000
         B     @DE00343                                            0343 00611000
@DL00343 DS    0H                                                  0344 00612000
*     IF ICTPPROC(1)=ON             /* IF PTF IN PROCESS             */ 00613000
*         &(ICTPNOGO(1)=ON          /* AND NOGO                      */ 00614000
*         |GONOGO=STAENOGO)         /* OR CALL FROM STAE RECOVERY    */ 00615000
*         &ICTPMSG(1)=OFF           /* AND NO MSG ISSUED YET         */ 00616000
*       THEN                        /*                               */ 00617000
         TM    ICTPPROC(P4PTR),B'10000000'                         0344 00618000
         BNO   @RF00344                                            0344 00619000
         TM    ICTPNOGO(P4PTR),B'01000000'                         0344 00620000
         BO    @GL00014                                            0344 00621000
         L     @08,@PC00001                                        0344 00622000
         CLI   GONOGO(@08),C'S'                                    0344 00623000
         BNE   @RF00344                                            0344 00624000
@GL00014 TM    ICTPMSG(P4PTR),B'00010000'                          0344 00625000
         BNZ   @RF00344                                            0344 00626000
*       DO;                         /* ISSUE ERROR MESSAGE           */ 00627000
*         ICTPNOGO(1)=ON;           /* SET SYSMOD IN ERROR AND       */ 00628000
*         ICTPCPL(1)=ON;            /* COMPLETE (IN CASE SER CALL)   */ 00629000
*         ICTPMSG(1)=ON;            /* INDICATE MSG WRITTEN          */ 00630000
         OI    ICTPNOGO(P4PTR),B'01110000'                         0348 00631000
*         MGPCLEAR=''B;             /* ZERO MSG PARM                 */ 00632000
         XC    MGPCLEAR(6),MGPCLEAR                                0349 00633000
*         MGPMGNO1=HMA302I;         /* XXXXXXX PROCESSING TERMINATED    00634000
*                                      FOR SYSMOD XXXXXXX - REASON = */ 00635000
         MVC   MGPMGNO1(2),@CH01873                                0350 00636000
*         IF GONOGO=NOGO            /* IF UTILITY FAILURE            */ 00637000
*           THEN                    /*                               */ 00638000
         L     @08,@PC00001                                        0351 00639000
         CLI   GONOGO(@08),C'B'                                    0351 00640000
         BNE   @RF00351                                            0351 00641000
*           MGPMGNO2=PART104;       /* SYSTEM UTILITY FAILURE        */ 00642000
         MVC   MGPMGNO2(2),@CH01880                                0352 00643000
*         ELSE                      /*                               */ 00644000
*           IF GONOGO=DELNOGO       /* IF CALL FROM DELETE           */ 00645000
*             THEN                  /*                               */ 00646000
         B     @RC00351                                            0353 00647000
@RF00351 L     @08,@PC00001                                        0353 00648000
         CLI   GONOGO(@08),C'D'                                    0353 00649000
         BNE   @RF00353                                            0353 00650000
*             MGPMGNO2=PART028;     /* DELETE PROCESSING FAILURE     */ 00651000
         MVC   MGPMGNO2(2),@CH00476                                0354 00652000
*           ELSE                    /* MUST BE CALL FROM STAE        */ 00653000
*             MGPMGNO2=PART030;     /* SYSTEM ABEND                  */ 00654000
         B     @RC00353                                            0355 00655000
@RF00353 MVC   MGPMGNO2(2),@CH00480                                0355 00656000
*         MGPVARPT(1)=ADDR(CCAFUNCT);/* FUNCTION                     */ 00657000
@RC00353 DS    0H                                                  0356 00658000
@RC00351 LA    @08,CCAFUNCT(,CCAPTR)                               0356 00659000
         ST    @08,MGPVARPT                                        0356 00660000
*         MGPVARPT(2)=ADDR(ICTPTFS(1));/* SYSMOD NUMBER              */ 00661000
         ST    P4PTR,MGPVARPT+4                                    0357 00662000
*         MGPTYPE=MGPINFO;          /* INFO ONLY                     */ 00663000
         MVI   MGPTYPE,X'01'                                       0358 00664000
*         CALL HMASMMSG(HMASMMGP);  /* WRITE MSG                     */ 00665000
         L     @15,@CV01866                                        0359 00666000
         LA    @01,@AL00359                                        0359 00667000
         BALR  @14,@15                                             0359 00668000
*       END;                        /* END PTF INPROCESS/NOGO        */ 00669000
*   END;                            /* END ICT PTF LOOP              */ 00670000
@RF00344 AH    P4PTR,@CH02176                                      0361 00671000
@DE00343 CLC   ICTPEND(4,P4PTR),ICTENDNT                           0361 00672000
         BNE   @DL00343                                            0361 00673000
*   RETURN CODE(ZERO);              /*                               */ 00674000
         SLR   @15,@15                                             0362 00675000
         L     @14,@SA00003                                        0362 00676000
         LM    @00,@12,@SA00003+8                                  0362 00677000
         BR    @14                                                 0362 00678000
*   END SMDNG1;                     /*                               */ 00679000
         EJECT                                                          00680000
*                                                                  0364 00681000
*   /*****************************************************************/ 00682000
*   /*                                                               */ 00683000
*   /* THIS ROUTINE IS CALLED TO CHECK FOR ANY SYSMODS THAT HAVE A   */ 00684000
*   /* DEPENDENCY ON ANOTHER SYSMOD THAT WAS MARKED NOGO DUE TO A    */ 00685000
*   /* PROCESSING ERROR                                              */ 00686000
*   /*                                                               */ 00687000
*   /*****************************************************************/ 00688000
*                                                                  0364 00689000
*SMDNG2:                            /*                               */ 00690000
*   PROCEDURE;                      /*                               */ 00691000
SMDNG2   STM   @14,@12,@SA00004                                    0364 00692000
*   DECLARE                         /*                               */ 00693000
*     P9PTR PTR(31);                /* PTR FOR ICT PTF LOOP          */ 00694000
*   DECLARE                         /*                               */ 00695000
*     NGSET CHAR(1);                /*                               */ 00696000
*   RFY                                                            0367 00697000
*     ICTPTF BASED(P9PTR);          /* ICT PTF SECTION BASE          */ 00698000
*   RFY                                                            0368 00699000
*     ICTPRELS BASED(ICTPPCHN(1));  /* PRE LIST                      */ 00700000
*   RFY                                                            0369 00701000
*     ICTREQLS BASED(ICTPRCHN(1));  /* REQ LIST                      */ 00702000
*   RFY                                                            0370 00703000
*     ICTIRQLS BASED(ICTPICHN(1));  /* IFREQ LIST                    */ 00704000
*   RFY                                                            0371 00705000
*     ICTSUPLS BASED(ICTPSCHN(1));  /* SUP LIST                      */ 00706000
*   RFY                                                            0372 00707000
*     ICTDELLS BASED(ICTPDCHN(1));  /* DELETE LIST                   */ 00708000
*   NGSET=YES;                      /*                               */ 00709000
         MVI   NGSET,C'Y'                                          0373 00710000
*   DO WHILE NGSET=YES;             /* LOOP TILL NO SYSMODS STOPPED  */ 00711000
         B     @DE00374                                            0374 00712000
@DL00374 DS    0H                                                  0375 00713000
*     NGSET=NO;                     /* STOP LOOP                     */ 00714000
         MVI   NGSET,C'N'                                          0375 00715000
*     DO P9PTR=CCAICPTF BY LENGTH(ICTPTF(1)) WHILE(/* ICT PTF LOOP   */ 00716000
*           ICTPEND(1)^=ICTENDNT);  /* TILL END                      */ 00717000
*                                                                  0376 00718000
         L     P9PTR,CCAICPTF(,CCAPTR)                             0376 00719000
         B     @DE00376                                            0376 00720000
@DL00376 DS    0H                                                  0377 00721000
*       /*************************************************************/ 00722000
*       /*                                                           */ 00723000
*       /* IF ANY PRE SYSMODS WERE MARKED NOGO THEN CURRENT SYSMOD IS*/ 00724000
*       /* ALSO MARKED NOGO AND MESSAGE IS ISSUED.                   */ 00725000
*       /*                                                           */ 00726000
*       /*************************************************************/ 00727000
*                                                                  0377 00728000
*       CALL NG2PRECK(ICTPTF(1),ICTPPCHN(1),LENGTH(ICTPRELS(1)),PART108 00729000
*           ,NGSET);                /*                               */ 00730000
*                                                                  0377 00731000
         MVC   @AL00001+8(12),@AL00377                             0377 00732000
         ST    P9PTR,@AL00001                                      0377 00733000
         LA    @08,ICTPPCHN(,P9PTR)                                0377 00734000
         ST    @08,@AL00001+4                                      0377 00735000
         LA    @01,@AL00001                                        0377 00736000
         BAL   @14,NG2PRECK                                        0377 00737000
*       /*************************************************************/ 00738000
*       /*                                                           */ 00739000
*       /* IF ANY REQ SYSMODS WERE MARKED NOGO THEN CURRENT SYSMOD IS*/ 00740000
*       /* ALSO MARKED NOGO AND MESSAGE IS ISSUED.                   */ 00741000
*       /*                                                           */ 00742000
*       /*************************************************************/ 00743000
*                                                                  0378 00744000
*       CALL NG2REQCK(ICTPTF(1),ICTPRCHN(1),LENGTH(ICTREQLS(1)),PART106 00745000
*           ,NGSET);                /*                               */ 00746000
*                                                                  0378 00747000
         MVC   @AL00001+8(12),@AL00378                             0378 00748000
         ST    P9PTR,@AL00001                                      0378 00749000
         LA    @08,ICTPRCHN(,P9PTR)                                0378 00750000
         ST    @08,@AL00001+4                                      0378 00751000
         LA    @01,@AL00001                                        0378 00752000
         BAL   @14,NG2REQCK                                        0378 00753000
*       /*************************************************************/ 00754000
*       /*                                                           */ 00755000
*       /* IF ANY IFREQ SYSMODS WERE MARKED NOGO THEN CURRENT SYSMOD */ 00756000
*       /* IS ALSO MARKED NOGO AND MESSAGE IS ISSUED.                */ 00757000
*       /*                                                           */ 00758000
*       /*************************************************************/ 00759000
*                                                                  0379 00760000
*       CALL NG2IRQCK(ICTPTF(1),ICTPICHN(1),LENGTH(ICTIRQLS(1)),PART107 00761000
*           ,NGSET);                /*                               */ 00762000
*                                                                  0379 00763000
         MVC   @AL00001+8(12),@AL00379                             0379 00764000
         ST    P9PTR,@AL00001                                      0379 00765000
         LA    @08,ICTPICHN(,P9PTR)                                0379 00766000
         ST    @08,@AL00001+4                                      0379 00767000
         LA    @01,@AL00001                                        0379 00768000
         BAL   @14,NG2IRQCK                                        0379 00769000
*       /*************************************************************/ 00770000
*       /*                                                           */ 00771000
*       /* IF CURRENT SYSMOD HAS NOT YET BEEN MARKED NOGO NUT FMID   */ 00772000
*       /* SYSMOD IS NOGO THEN CURRENT SYSMOD IS MARKED NOGO AND     */ 00773000
*       /* MESSAGE IS ISSUED.                                        */ 00774000
*       /*                                                           */ 00775000
*       /*************************************************************/ 00776000
*                                                                  0380 00777000
*       IF ICTPNOGO(1)=OFF          /* IF NOT NOGO YET               */ 00778000
*         THEN                      /*                               */ 00779000
         TM    ICTPNOGO(P9PTR),B'01000000'                         0380 00780000
         BNZ   @RF00380                                            0380 00781000
*         CALL NG2FMDCK(ICTPTF(1),PART109,NGSET);/*                  */ 00782000
*                                                                  0381 00783000
         MVC   @AL00001+4(8),@AL00381                              0381 00784000
         ST    P9PTR,@AL00001                                      0381 00785000
         LA    @01,@AL00001                                        0381 00786000
         BAL   @14,NG2FMDCK                                        0381 00787000
*       /*************************************************************/ 00788000
*       /*                                                           */ 00789000
*       /* IF CURRENT SYSMOD IS NOT NOGO THEN CHECK TO SEE IF ALL THE*/ 00790000
*       /* SYSMODS THAT SUPED IT OR DELETED IT ARE MARKED NOGO. IF SO*/ 00791000
*       /* THEN ISSUE ERR MSG AND MARK CURRENT SYSMOD NOGO.          */ 00792000
*       /*                                                           */ 00793000
*       /*************************************************************/ 00794000
*                                                                  0382 00795000
*       IF ICTPNOGO(1)=OFF          /* IF SYSMOD IS NOT NOGO         */ 00796000
*           &(ICTPSUPN(1)^=ZERO     /* AND IS SUPED                  */ 00797000
*           |(ICTPDEXP(1)=ON|ICTPDIMP(1)=ON))/* OR PTF DELETED       */ 00798000
*         THEN                      /*                               */ 00799000
@RF00380 TM    ICTPNOGO(P9PTR),B'01000000'                         0382 00800000
         BNZ   @RF00382                                            0382 00801000
         ICM   @08,3,ICTPSUPN(P9PTR)                               0382 00802000
         BNZ   @RT00382                                            0382 00803000
         TM    ICTPDEXP(P9PTR),B'00110000'                         0382 00804000
         BZ    @RF00382                                            0382 00805000
@RT00382 DS    0H                                                  0383 00806000
*         CALL NG2XX3CK(ICTPTF(1),NGSET);/*                          */ 00807000
         ST    P9PTR,@AL00001                                      0383 00808000
         LA    @08,NGSET                                           0383 00809000
         ST    @08,@AL00001+4                                      0383 00810000
         LA    @01,@AL00001                                        0383 00811000
         BAL   @14,NG2XX3CK                                        0383 00812000
*     END;                          /* END LOOP THRU ICT             */ 00813000
*                                                                  0384 00814000
@RF00382 AH    P9PTR,@CH02176                                      0384 00815000
@DE00376 CLC   ICTPEND(4,P9PTR),ICTENDNT                           0384 00816000
         BNE   @DL00376                                            0384 00817000
*     /***************************************************************/ 00818000
*     /*                                                             */ 00819000
*     /* NO CALL ROUTINE TO MARK ALL ELEMENTS OF NOGO PTFS AS NOGO   */ 00820000
*     /* AND THEN CALL ROUTINE TO MARK ALL PTFS WITH RELATED ELEMENTS*/ 00821000
*     /* AS NOGO                                                     */ 00822000
*     /*                                                             */ 00823000
*     /***************************************************************/ 00824000
*                                                                  0385 00825000
*     CALL CPLMODNG;                /* MARK MODS OF NOGO PTFS NOGO   */ 00826000
         BAL   @14,CPLMODNG                                        0385 00827000
*     CALL CPLRELEM(NGSET);         /* MARK RELATED SYSMODS AS NOGO  */ 00828000
         LA    @01,@AL00386                                        0386 00829000
         BAL   @14,CPLRELEM                                        0386 00830000
*   END;                            /* END DO WHILE LOOP             */ 00831000
@DE00374 CLI   NGSET,C'Y'                                          0387 00832000
         BE    @DL00374                                            0387 00833000
*   RETURN CODE(ZERO);              /*                               */ 00834000
         SLR   @15,@15                                             0388 00835000
         L     @14,@SA00004                                        0388 00836000
         LM    @00,@12,@SA00004+8                                  0388 00837000
         BR    @14                                                 0388 00838000
*   END SMDNG2;                     /*                               */ 00839000
         EJECT                                                          00840000
*                                                                  0390 00841000
*   /*****************************************************************/ 00842000
*   /*                                                               */ 00843000
*   /* THIS ROUTINE IS CALLED TO LOOP THRU ONE OF THE REQ LISTS FOR A*/ 00844000
*   /* SYSMOD TO DETERMINE WHETHER ANY REQS WERE NOGO. IF SO THEN THE*/ 00845000
*   /* CURRENT SYSMOD IS ALSO MARKED NOGO AND A MESSAGE IS ISSUED    */ 00846000
*   /*                                                               */ 00847000
*   /*****************************************************************/ 00848000
*                                                                  0390 00849000
*NG2XX1CK:                          /*                               */ 00850000
*NG2PRECK:                          /*                               */ 00851000
*NG2REQCK:                          /*                               */ 00852000
*NG2IRQCK:                          /*                               */ 00853000
*   PROCEDURE(XX1SMD,XX1CHN,XX1LEN,XX1PART2,XX1NGSET);/*             */ 00854000
NG2XX1CK DS    0H                                                  0390 00855000
NG2PRECK DS    0H                                                  0390 00856000
NG2REQCK DS    0H                                                  0390 00857000
NG2IRQCK STM   @14,@12,@SA00005                                    0390 00858000
         MVC   @PC00005(20),0(@01)                                 0390 00859000
*   DECLARE                         /*                               */ 00860000
*     XX1SMD CHAR(*),               /* CURRENT SYSMOD ICT ENTRY      */ 00861000
*     XX1CHN PTR(31),               /* PTR TO REQ LIST               */ 00862000
*     XX1LEN FIXED(31),             /* LENGTH OF ICT ENTRY           */ 00863000
*     XX1PART2 FIXED(31),           /* MSG PART 2 NUMBER             */ 00864000
*     XX1NGSET CHAR(1);             /* SMD MARKED NOGO               */ 00865000
*   DECLARE                         /*                               */ 00866000
*     XX1PTR1 PTR(31);              /*                               */ 00867000
*   DECLARE                         /*                               */ 00868000
*     XX1INDX FIXED(31);            /*                               */ 00869000
*   DECLARE                         /*                               */ 00870000
*     1 XX1SW BIT(8),               /*                               */ 00871000
*       3 XX1STOP1 BIT(1),          /*                               */ 00872000
*       3 XX1NG BIT(1),             /*                               */ 00873000
*       3 XX1OK BIT(1),             /*                               */ 00874000
*       3 XX1RQFND BIT(1),          /*                               */ 00875000
*       3 * BIT(4);                 /*                               */ 00876000
*   DECLARE                         /*                               */ 00877000
*     PBPTR PTR(31),                /* PTR FOR ICT PTF LOOP          */ 00878000
*     PXB FIXED(31),                /* INDEX THRU REQ LIST           */ 00879000
*     PGPTR PTR(31),                /* PTR FOR ICT PTF LOOP          */ 00880000
*     PXG FIXED(31);                /* INDEX THRU SUP LIST           */ 00881000
*   DECLARE                         /*                               */ 00882000
*     TEMP1PTF CHAR(7);             /*                               */ 00883000
*   RFY                             /*                               */ 00884000
*     ICTPTF BASED(PBPTR);          /*                               */ 00885000
*   RFY                             /*                               */ 00886000
*     ICTENTLS BASED(XX1CHN);       /*                               */ 00887000
*   XX1PTR1=ADDR(XX1SMD);           /* PTR TO CURRENT SYSMOD         */ 00888000
         L     XX1PTR1,@PC00005                                    0399 00889000
*   XX1INDX=XX1LEN/LENGTH(ICTENTLS(1));/* INDEX THRU CHAIN           */ 00890000
         L     @08,@PC00005+8                                      0400 00891000
         L     @00,XX1LEN(,@08)                                    0400 00892000
         SRDA  @00,32                                              0400 00893000
         D     @00,@CF00121                                        0400 00894000
         LR    XX1INDX,@01                                         0400 00895000
*   DO PXB=1 BY XX1INDX WHILE(      /* LOOP THRU REQ LISTS           */ 00896000
*         ICTENTND(PXB)^=ICTENDIX   /* TILL END                      */ 00897000
*         &XX1PTR1->ICTPNOGO(1)=OFF);/* OR TILL SYSMOD MARKED IN NO  */ 00898000
*                                                                  0401 00899000
         LA    PXB,1                                               0401 00900000
         B     @DE00401                                            0401 00901000
@DL00401 DS    0H                                                  0402 00902000
*     /***************************************************************/ 00903000
*     /*                                                             */ 00904000
*     /* IF REQ WAS NOT FOUND IN TARGET SYSTEM THEN IT MUST EXISTS IN*/ 00905000
*     /* ICT AS REAL OR SUPED ENTRY. SEE IF IT IS NOW COMPLETE       */ 00906000
*     /*                                                             */ 00907000
*     /***************************************************************/ 00908000
*                                                                  0402 00909000
*     IF ICTEREQT(PXB)=OFF          /* IF REQ NOT ON (A)CDS          */ 00910000
*         &ICTEREQB(PXB)=OFF        /* AND NOT BYPASS                */ 00911000
*       THEN                        /* THEN REQ MUST HAVE BE IN ICT  */ 00912000
         LR    @08,PXB                                             0402 00913000
         SLA   @08,3                                               0402 00914000
         L     @07,@PC00005+4                                      0402 00915000
         L     @07,XX1CHN(,@07)                                    0402 00916000
         ST    @08,@TF00001                                        0402 00917000
         ALR   @08,@07                                             0402 00918000
         BCTR  @08,0                                               0402 00919000
         TM    ICTEREQT-7(@08),B'00001010'                         0402 00920000
         BNZ   @RF00402                                            0402 00921000
*       DO;                         /* OR SUPED BY PTF IN ICT        */ 00922000
*         TEMP1PTF=ICTENTNM(PXB);   /* SAVE REQ NUMBER               */ 00923000
*                                                                  0404 00924000
         AL    @07,@TF00001                                        0404 00925000
         AL    @07,@CF02215                                        0404 00926000
         MVC   TEMP1PTF(7),ICTENTNM(@07)                           0404 00927000
*         /***********************************************************/ 00928000
*         /*                                                         */ 00929000
*         /* SEARCH THRU ICT TO SEE IF REQ EXISTS AS NON-SUPED ENTRY.*/ 00930000
*         /* IF FOUND AND NOGO THEN SET CURRENT SYSMOD NOGO AND ISSUE*/ 00931000
*         /* MESSAGE                                                 */ 00932000
*         /*                                                         */ 00933000
*         /***********************************************************/ 00934000
*                                                                  0405 00935000
*         XX1RQFND=OFF;             /* REQ NOT FOUND                 */ 00936000
         NI    XX1RQFND,B'11101111'                                0405 00937000
*         DO PBPTR=CCAICPTF BY LENGTH(ICTPTF(1)) WHILE(/* PTF LOOP   */ 00938000
*               ICTPEND(1)^=ICTENDNT/* OR END OF LIST                */ 00939000
*               &ICTPTFS(1)^=TEMP1PTF);/*                            */ 00940000
         L     PBPTR,CCAICPTF(,CCAPTR)                             0406 00941000
         B     @DE00406                                            0406 00942000
@DL00406 DS    0H                                                  0407 00943000
*         END;                      /*                               */ 00944000
         AH    PBPTR,@CH02176                                      0407 00945000
@DE00406 CLC   ICTPEND(4,PBPTR),ICTENDNT                           0407 00946000
         BE    @DC00406                                            0407 00947000
         CLC   ICTPTFS(7,PBPTR),TEMP1PTF                           0407 00948000
         BNE   @DL00406                                            0407 00949000
@DC00406 DS    0H                                                  0408 00950000
*         IF ICTPEND(1)^=ICTENDNT   /* IF REQ FOUND                  */ 00951000
*             &ICTPSUPN(1)=ZERO     /* AND NOT SUPED                 */ 00952000
*           THEN                    /*                               */ 00953000
         CLC   ICTPEND(4,PBPTR),ICTENDNT                           0408 00954000
         BE    @RF00408                                            0408 00955000
         ICM   @08,3,ICTPSUPN(PBPTR)                               0408 00956000
         BNZ   @RF00408                                            0408 00957000
*           DO;                     /*                               */ 00958000
*             XX1RQFND=ON;          /* SET REQ FOUND                 */ 00959000
*                                                                  0410 00960000
         OI    XX1RQFND,B'00010000'                                0410 00961000
*             /*******************************************************/ 00962000
*             /*                                                     */ 00963000
*             /* IF APPLY OR ACCEPT AND REQ IS NOGO THEN CURRENT     */ 00964000
*             /* SYSMOD IS ALSO NOGO                                 */ 00965000
*             /*                                                     */ 00966000
*             /*******************************************************/ 00967000
*                                                                  0411 00968000
*             IF CCAAPPLY=ON|CCAACCPT=ON/* IF APPLY OR ACCEPT        */ 00969000
*               THEN                /*                               */ 00970000
         TM    CCAAPPLY(CCAPTR),B'01100000'                        0411 00971000
         BZ    @RF00411                                            0411 00972000
*               DO;                 /*                               */ 00973000
*                 IF ICTPNOGO(1)=ON /* AND ITS NOGO                  */ 00974000
*                   THEN            /*                               */ 00975000
         TM    ICTPNOGO(PBPTR),B'01000000'                         0413 00976000
         BNO   @RF00413                                            0413 00977000
*                   DO;             /*                               */ 00978000
*                     XX1PTR1->ICTPNOGO(1)=ON;/*                     */ 00979000
*                     XX1PTR1->ICTPCPL(1)=ON;/*                      */ 00980000
         OI    ICTPNOGO(XX1PTR1),B'01100000'                       0416 00981000
*                     IF XX1PTR1->ICTPMSG(1)=OFF/* IF NO MSG YET     */ 00982000
*                       THEN        /*                               */ 00983000
         TM    ICTPMSG(XX1PTR1),B'00010000'                        0417 00984000
         BNZ   @RF00417                                            0417 00985000
*                       DO;         /*                               */ 00986000
*                         XX1PTR1->ICTPMSG(1)=ON;/*                  */ 00987000
         OI    ICTPMSG(XX1PTR1),B'00010000'                        0419 00988000
*                         MGPCLEAR=''B;/*                            */ 00989000
         XC    MGPCLEAR(6),MGPCLEAR                                0420 00990000
*                         MGPMGNO1=HMA302I;/* XXXXXXX PROCESSING   0421 00991000
*                                      TERMINATRED FOR SYSMOD XXXXXXX   00992000
*                                      - REASON =                    */ 00993000
         MVC   MGPMGNO1(2),@CH01873                                0421 00994000
*                         MGPMGNO2=XX1PART2;/* XXX SYSMOD FAILURE    */ 00995000
         L     @08,@PC00005+12                                     0422 00996000
         MVC   MGPMGNO2(2),XX1PART2+2(@08)                         0422 00997000
*                         MGPTYPE=MGPERR;/*                          */ 00998000
         MVI   MGPTYPE,X'03'                                       0423 00999000
*                         MGPVARPT(1)=ADDR(CCAFUNCT);/*              */ 01000000
         LA    @08,CCAFUNCT(,CCAPTR)                               0424 01001000
         ST    @08,MGPVARPT                                        0424 01002000
*                         MGPVARPT(2)=ADDR(XX1SMD);/*                */ 01003000
         L     @08,@PC00005                                        0425 01004000
         ST    @08,MGPVARPT+4                                      0425 01005000
*                         CALL HMASMMSG(HMASMMGP);/*                 */ 01006000
         L     @15,@CV01866                                        0426 01007000
         LA    @01,@AL00426                                        0426 01008000
         BALR  @14,@15                                             0426 01009000
*                         XX1NGSET=YES;/*                            */ 01010000
         L     @08,@PC00005+16                                     0427 01011000
         MVI   XX1NGSET(@08),C'Y'                                  0427 01012000
*                       END;        /* END MSG NOT ISSUED YET        */ 01013000
*                   END;            /* END REQ FOUND AS NOGO         */ 01014000
*               END;                /* END APPLY OR ACCEPT           */ 01015000
*                                                                  0430 01016000
*             /*******************************************************/ 01017000
*             /*                                                     */ 01018000
*             /* IF RESTORE AND CURRENT SYSMOD IS NOGO THEN ALL ITS  */ 01019000
*             /* REQS ARE ALSO NOGO                                  */ 01020000
*             /*                                                     */ 01021000
*             /*******************************************************/ 01022000
*                                                                  0431 01023000
*             ELSE                  /*                               */ 01024000
*               DO;                 /* MUST BE RESTORE               */ 01025000
         B     @RC00411                                            0431 01026000
@RF00411 DS    0H                                                  0432 01027000
*                 IF XX1PTR1->ICTPNOGO(1)=ON/* IF CURRENT NOGO       */ 01028000
*                   THEN            /*                               */ 01029000
         TM    ICTPNOGO(XX1PTR1),B'01000000'                       0432 01030000
         BNO   @RF00432                                            0432 01031000
*                   DO;             /* THEN ALL REQS NOGO            */ 01032000
*                     IF ICTPNOGO(1)=OFF/* IF REQ NOT ALREADY NOGO   */ 01033000
*                       THEN        /*                               */ 01034000
         TM    ICTPNOGO(PBPTR),B'01000000'                         0434 01035000
         BNZ   @RF00434                                            0434 01036000
*                       DO;         /*                               */ 01037000
*                         ICTPNOGO(1)=ON;/* MARK REQ NOGO            */ 01038000
*                         ICTPCPL(1)=ON;/* REQ COMPLETE              */ 01039000
*                         ICTPMSG(1)=ON;/* MESSAGE ISSUED            */ 01040000
         OI    ICTPNOGO(PBPTR),B'01110000'                         0438 01041000
*                         MGPCLEAR=''B;/*                            */ 01042000
         XC    MGPCLEAR(6),MGPCLEAR                                0439 01043000
*                         MGPMGNO1=HMA302I;/* XXXXXXXX PROCESSING  0440 01044000
*                                      TERMINATED FOR SYSMOD X7X - 0440 01045000
*                                      REASON =                      */ 01046000
         MVC   MGPMGNO1(2),@CH01873                                0440 01047000
*                         MGPMGNO2=XX1PART2;/* XXX SYSMOD FAILURE    */ 01048000
         L     @08,@PC00005+12                                     0441 01049000
         MVC   MGPMGNO2(2),XX1PART2+2(@08)                         0441 01050000
*                         MGPTYPE=MGPERR;/*                          */ 01051000
         MVI   MGPTYPE,X'03'                                       0442 01052000
*                         MGPVARPT(1)=ADDR(CCAFUNCT);/*              */ 01053000
         LA    @08,CCAFUNCT(,CCAPTR)                               0443 01054000
         ST    @08,MGPVARPT                                        0443 01055000
*                         MGPVARPT(2)=ADDR(ICTPTFS(1));/*            */ 01056000
         ST    PBPTR,MGPVARPT+4                                    0444 01057000
*                         CALL HMASMMSG(HMASMMGP);/*                 */ 01058000
         L     @15,@CV01866                                        0445 01059000
         LA    @01,@AL00445                                        0445 01060000
         BALR  @14,@15                                             0445 01061000
*                         XX1NGSET=YES;/*                            */ 01062000
         L     @08,@PC00005+16                                     0446 01063000
         MVI   XX1NGSET(@08),C'Y'                                  0446 01064000
*                       END;        /* END REQ NOT NOGO YET          */ 01065000
*                   END;            /* END CURRENT IS NOGO           */ 01066000
@RF00434 DS    0H                                                  0449 01067000
*               END;                /* END MUST BE RESTORE           */ 01068000
@RF00432 DS    0H                                                  0450 01069000
*           END;                    /* END REQ FOUND IN ICT          */ 01070000
*                                                                  0450 01071000
@RC00411 DS    0H                                                  0451 01072000
*         /***********************************************************/ 01073000
*         /*                                                         */ 01074000
*         /* IF REQ IS NOT IN ICT THEN IT MUST HAVE BEEN SUPED BY    */ 01075000
*         /* SOME OTHER SYSMOD IN ICT. SEARCH ICT FOR THAT SYSMOD. IF*/ 01076000
*         /* ALL SYSMODS THAT SUP REQ ARE NOGO THEN CURRENT    SYSMOD*/ 01077000
*         /* IS NOGO AND MESSAGE ISSUED. IF ONE NONE=NOGO SYSMOD IS  */ 01078000
*         /* FOUND THEN CURRENT SYSMOD STILL OK                      */ 01079000
*         /*                                                         */ 01080000
*         /***********************************************************/ 01081000
*                                                                  0451 01082000
*         RFY                       /*                               */ 01083000
*           ICTPTF BASED(PGPTR);    /*                               */ 01084000
@RF00408 DS    0H                                                  0452 01085000
*         RFY                       /*                               */ 01086000
*           ICTENTLS BASED(XX1CHN); /*                               */ 01087000
*         RFY                       /*                               */ 01088000
*           ICTSUPLS BASED(PGPTR->ICTPSCHN(1));/*                    */ 01089000
*         IF XX1RQFND=OFF           /* IF RERQ NOT FOUND IN ICT      */ 01090000
*           THEN                    /*                               */ 01091000
         TM    XX1RQFND,B'00010000'                                0454 01092000
         BNZ   @RF00454                                            0454 01093000
*           DO;                     /* REQ MUST BE SUPED BY PTF      */ 01094000
*             XX1STOP1=OFF;         /* INIT LOOP CONTROL SW          */ 01095000
*             XX1NG=OFF;            /* NOGO PTF NOT FOUND            */ 01096000
*             XX1OK=OFF;            /* GOOD PTF NOT FOUND            */ 01097000
         NI    XX1STOP1,B'00011111'                                0458 01098000
*             DO PGPTR=CCAICPTF BY LENGTH(ICTPTF(1)) WHILE(/* LOOP   */ 01099000
*                   ICTPEND(1)^=ICTENDNT/* TILL END                  */ 01100000
*                   &XX1STOP1=OFF); /* AND SW NOT SET                */ 01101000
         L     PGPTR,CCAICPTF(,CCAPTR)                             0459 01102000
         B     @DE00459                                            0459 01103000
@DL00459 DS    0H                                                  0460 01104000
*               DO PXG=1 BY 1 WHILE(/* LOOP THRU SUPS FOR PTF        */ 01105000
*                     ICTSUPND(PXG)^=ICTENDIX/* TILL END             */ 01106000
*                     &XX1STOP1=OFF);/* AND SW NOT SET               */ 01107000
         LA    PXG,1                                               0460 01108000
         B     @DE00460                                            0460 01109000
@DL00460 DS    0H                                                  0461 01110000
*                 IF ICTSUPNM(PXG)=TEMP1PTF/* IF REQ MATCHES SUP     */ 01111000
*                   THEN            /*                               */ 01112000
         LR    @08,PXG                                             0461 01113000
         SLA   @08,3                                               0461 01114000
         L     @07,ICTPSCHN(,PGPTR)                                0461 01115000
         ALR   @07,@08                                             0461 01116000
         AL    @07,@CF02215                                        0461 01117000
         CLC   ICTSUPNM(7,@07),TEMP1PTF                            0461 01118000
         BNE   @RF00461                                            0461 01119000
*                   DO;             /*                               */ 01120000
*                     IF CCAAPPLY=ON|CCAACCPT=ON/*                   */ 01121000
*                       THEN        /*                               */ 01122000
         TM    CCAAPPLY(CCAPTR),B'01100000'                        0463 01123000
         BZ    @RF00463                                            0463 01124000
*                       DO;         /*                               */ 01125000
*                         IF ICTPNOGO(1)=ON/* IF SYSMOD IS NOGO      */ 01126000
*                           THEN    /*                               */ 01127000
         TM    ICTPNOGO(PGPTR),B'01000000'                         0465 01128000
         BNO   @RF00465                                            0465 01129000
*                           XX1NG=ON;/* SET FOUND NOGO PTF           */ 01130000
         OI    XX1NG,B'01000000'                                   0466 01131000
*                         ELSE      /*                               */ 01132000
*                           DO;     /*                               */ 01133000
         B     @RC00465                                            0467 01134000
@RF00465 DS    0H                                                  0468 01135000
*                             XX1OK=ON;/* SET GOOD PTF FOUND         */ 01136000
*                             XX1STOP1=ON;/* STOP LOOP               */ 01137000
         OI    XX1OK,B'10100000'                                   0469 01138000
*                           END;    /*                               */ 01139000
*                       END;        /*                               */ 01140000
*                     ELSE          /* MUST BE RESTORE               */ 01141000
*                       DO;         /*                               */ 01142000
         B     @RC00463                                            0472 01143000
@RF00463 DS    0H                                                  0473 01144000
*                         IF XX1PTR1->ICTPNOGO(1)=ON/* IF CURRENT    */ 01145000
*                           THEN    /* NOGO                          */ 01146000
         TM    ICTPNOGO(XX1PTR1),B'01000000'                       0473 01147000
         BNO   @RF00473                                            0473 01148000
*                           DO;     /* THEN SUPS OF REQS NOGO        */ 01149000
*                             IF ICTPNOGO(1)=OFF/* IF SUP NOT NOGO   */ 01150000
*                               THEN/*                               */ 01151000
         TM    ICTPNOGO(PGPTR),B'01000000'                         0475 01152000
         BNZ   @RF00475                                            0475 01153000
*                               DO; /*                               */ 01154000
*                                 ICTPNOGO(1)=ON;/*                  */ 01155000
*                                 ICTPCPL(1)=ON;/*                   */ 01156000
*                                 ICTPMSG(1)=ON;/*                   */ 01157000
         OI    ICTPNOGO(PGPTR),B'01110000'                         0479 01158000
*                                 MGPCLEAR=''B;/*                    */ 01159000
         XC    MGPCLEAR(6),MGPCLEAR                                0480 01160000
*                                 MGPMGNO1=HMA302I;/* XXXXXXXX     0481 01161000
*                                      PROCESSING TERMINATED FOR   0481 01162000
*                                      SYSMOD X7X - REASON =         */ 01163000
         MVC   MGPMGNO1(2),@CH01873                                0481 01164000
*                                 MGPMGNO2=XX1PART2;/* XXX SYSMOD  0482 01165000
*                                      FAILURE                       */ 01166000
         L     @08,@PC00005+12                                     0482 01167000
         MVC   MGPMGNO2(2),XX1PART2+2(@08)                         0482 01168000
*                                 MGPTYPE=MGPERR;/*                  */ 01169000
         MVI   MGPTYPE,X'03'                                       0483 01170000
*                                 MGPVARPT(1)=ADDR(CCAFUNCT);/*      */ 01171000
         LA    @08,CCAFUNCT(,CCAPTR)                               0484 01172000
         ST    @08,MGPVARPT                                        0484 01173000
*                                 MGPVARPT(2)=ADDR(ICTPTFS(1));/*    */ 01174000
         ST    PGPTR,MGPVARPT+4                                    0485 01175000
*                                 CALL HMASMMSG(HMASMMGP);/*         */ 01176000
         L     @15,@CV01866                                        0486 01177000
         LA    @01,@AL00486                                        0486 01178000
         BALR  @14,@15                                             0486 01179000
*                                 XX1NGSET=YES;/*                    */ 01180000
         L     @08,@PC00005+16                                     0487 01181000
         MVI   XX1NGSET(@08),C'Y'                                  0487 01182000
*                               END;/* END SUP NOT NOGO YET          */ 01183000
*                           END;    /* END CURRENT NOGO              */ 01184000
@RF00475 DS    0H                                                  0490 01185000
*                       END;        /*                               */ 01186000
@RF00473 DS    0H                                                  0491 01187000
*                   END;            /* END REQ MATCHES SUP           */ 01188000
@RC00463 DS    0H                                                  0492 01189000
*               END;                /* END LOOP THRU SUPS            */ 01190000
@RF00461 AH    PXG,@CH00037                                        0492 01191000
@DE00460 LR    @08,PXG                                             0492 01192000
         SLA   @08,3                                               0492 01193000
         L     @07,ICTPSCHN(,PGPTR)                                0492 01194000
         AL    @07,@CF02215                                        0492 01195000
         L     @08,ICTSUPND(@08,@07)                               0492 01196000
         CL    @08,ICTENDIX                                        0492 01197000
         BE    @DC00460                                            0492 01198000
         TM    XX1STOP1,B'10000000'                                0492 01199000
         BZ    @DL00460                                            0492 01200000
@DC00460 DS    0H                                                  0493 01201000
*             END;                  /* END LOOP THRU ICT PTFS        */ 01202000
         AH    PGPTR,@CH02176                                      0493 01203000
@DE00459 CLC   ICTPEND(4,PGPTR),ICTENDNT                           0493 01204000
         BE    @DC00459                                            0493 01205000
         TM    XX1STOP1,B'10000000'                                0493 01206000
         BZ    @DL00459                                            0493 01207000
@DC00459 DS    0H                                                  0494 01208000
*             IF XX1NG=ON           /* IF SUPING NOGO SYSMOD FOUND   */ 01209000
*                 &XX1OK=OFF        /* AND NO SUPING OK PTF FOUND    */ 01210000
*               THEN                /* THEN                          */ 01211000
         TM    XX1NG,B'01000000'                                   0494 01212000
         BNO   @RF00494                                            0494 01213000
         TM    XX1OK,B'00100000'                                   0494 01214000
         BNZ   @RF00494                                            0494 01215000
*               DO;                 /* STOP CURRENT SYSMOD           */ 01216000
*                 XX1PTR1->ICTPNOGO(1)=ON;/*                         */ 01217000
*                 XX1PTR1->ICTPCPL(1)=ON;/*                          */ 01218000
         OI    ICTPNOGO(XX1PTR1),B'01100000'                       0497 01219000
*                 IF XX1PTR1->ICTPMSG(1)=OFF/* IF NO MSG YET         */ 01220000
*                   THEN            /*                               */ 01221000
         TM    ICTPMSG(XX1PTR1),B'00010000'                        0498 01222000
         BNZ   @RF00498                                            0498 01223000
*                   DO;             /*                               */ 01224000
*                     XX1PTR1->ICTPMSG(1)=ON;/*                      */ 01225000
         OI    ICTPMSG(XX1PTR1),B'00010000'                        0500 01226000
*                     MGPCLEAR=''B; /*                               */ 01227000
         XC    MGPCLEAR(6),MGPCLEAR                                0501 01228000
*                     MGPMGNO1=HMA302I;/* XXXXXXX PROCESSING       0502 01229000
*                                      TERMINATRED FOR SYSMOD XXXXXXX   01230000
*                                      - REASON =                    */ 01231000
         MVC   MGPMGNO1(2),@CH01873                                0502 01232000
*                     MGPMGNO2=XX1PART2;/* XXX SYSMOD FAILURE        */ 01233000
         L     @08,@PC00005+12                                     0503 01234000
         MVC   MGPMGNO2(2),XX1PART2+2(@08)                         0503 01235000
*                     MGPTYPE=MGPERR;/*                              */ 01236000
         MVI   MGPTYPE,X'03'                                       0504 01237000
*                     MGPVARPT(1)=ADDR(CCAFUNCT);/*                  */ 01238000
         LA    @08,CCAFUNCT(,CCAPTR)                               0505 01239000
         ST    @08,MGPVARPT                                        0505 01240000
*                     MGPVARPT(2)=ADDR(XX1SMD);/*                    */ 01241000
         L     @08,@PC00005                                        0506 01242000
         ST    @08,MGPVARPT+4                                      0506 01243000
*                     CALL HMASMMSG(HMASMMGP);/*                     */ 01244000
         L     @15,@CV01866                                        0507 01245000
         LA    @01,@AL00507                                        0507 01246000
         BALR  @14,@15                                             0507 01247000
*                     XX1NGSET=YES; /*                               */ 01248000
         L     @08,@PC00005+16                                     0508 01249000
         MVI   XX1NGSET(@08),C'Y'                                  0508 01250000
*                   END;            /* END MSG NOT ISSUED YET        */ 01251000
*               END;                /* END STOP CURRENT SYSMOD       */ 01252000
@RF00498 DS    0H                                                  0511 01253000
*           END;                    /* END REQ MUST BE SUPED         */ 01254000
@RF00494 DS    0H                                                  0512 01255000
*       END;                        /* END REQ NOT ON DS & NOT BYPASS*/ 01256000
@RF00454 DS    0H                                                  0513 01257000
*   END;                            /* END LOOP THRU REQ LIST        */ 01258000
@RF00402 ALR   PXB,XX1INDX                                         0513 01259000
@DE00401 LR    @08,PXB                                             0513 01260000
         SLA   @08,3                                               0513 01261000
         L     @07,@PC00005+4                                      0513 01262000
         L     @07,XX1CHN(,@07)                                    0513 01263000
         AL    @07,@CF02215                                        0513 01264000
         L     @08,ICTENTND(@08,@07)                               0513 01265000
         CL    @08,ICTENDIX                                        0513 01266000
         BE    @DC00401                                            0513 01267000
         TM    ICTPNOGO(XX1PTR1),B'01000000'                       0513 01268000
         BZ    @DL00401                                            0513 01269000
@DC00401 DS    0H                                                  0514 01270000
*   RETURN CODE(ZERO);              /*                               */ 01271000
         SLR   @15,@15                                             0514 01272000
         L     @14,@SA00005                                        0514 01273000
         LM    @00,@12,@SA00005+8                                  0514 01274000
         BR    @14                                                 0514 01275000
*   END NG2XX1CK;                   /*                               */ 01276000
         EJECT                                                          01277000
*                                                                  0516 01278000
*   /*****************************************************************/ 01279000
*   /*                                                               */ 01280000
*   /* THIS ROUTINE IS CALLED TO SEE IF THE FMID SYSMOD FOR THE      */ 01281000
*   /* CURRENT SYSMOD HAS BEEN MARKED NOGO. IF SO THEN THE CURRENT IS*/ 01282000
*   /* ALSO MARKED NOGO AND A MESSAGE IS ISSUED.                     */ 01283000
*   /*                                                               */ 01284000
*   /*****************************************************************/ 01285000
*                                                                  0516 01286000
*NG2XX2CK:                          /*                               */ 01287000
*NG2FMDCK:                          /*                               */ 01288000
*   PROCEDURE(XX2SMD,XX2PART2,XX2NGSET);/*                           */ 01289000
NG2XX2CK DS    0H                                                  0516 01290000
NG2FMDCK STM   @14,@12,@SA00006                                    0516 01291000
         MVC   @PC00006(12),0(@01)                                 0516 01292000
*   DECLARE                         /*                               */ 01293000
*     XX2SMD CHAR(*),               /* CURRENT SYSMOD ICT ENTRY      */ 01294000
*     XX2PART2 FIXED(31),           /* MSG PART 2 NUMBER             */ 01295000
*     XX2NGSET CHAR(1);             /* SMD MARKED NOGO               */ 01296000
*   DECLARE                         /*                               */ 01297000
*     XX2PTR1 PTR(31);              /*                               */ 01298000
*   DECLARE                         /*                               */ 01299000
*     PDPTR PTR(31);                /* PTR FOR ICT PTF LOOP          */ 01300000
*   RFY                                                            0520 01301000
*     ICTPTF BASED(PDPTR);          /*                               */ 01302000
*   XX2PTR1=ADDR(XX2SMD);           /* PTR TO CURRENT SYSMOD         */ 01303000
         L     XX2PTR1,@PC00006                                    0521 01304000
*   DO PDPTR=CCAICPTF BY LENGTH(ICTPTF(1)) WHILE(/* ICT PTF LOOP     */ 01305000
*         ICTPEND(1)^=ICTENDNT      /* TILL END                      */ 01306000
*         &ICTPTFS(1)^=XX2PTR1->ICTPFMID(1));/* OR FMID FOUND        */ 01307000
         L     PDPTR,CCAICPTF(,CCAPTR)                             0522 01308000
         B     @DE00522                                            0522 01309000
@DL00522 DS    0H                                                  0523 01310000
*   END;                            /*                               */ 01311000
         AH    PDPTR,@CH02176                                      0523 01312000
@DE00522 CLC   ICTPEND(4,PDPTR),ICTENDNT                           0523 01313000
         BE    @DC00522                                            0523 01314000
         CLC   ICTPTFS(7,PDPTR),ICTPFMID(XX2PTR1)                  0523 01315000
         BNE   @DL00522                                            0523 01316000
@DC00522 DS    0H                                                  0524 01317000
*   IF ICTPEND(1)^=ICTENDNT         /* IF FMID FOUND                 */ 01318000
*     THEN                          /*                               */ 01319000
         CLC   ICTPEND(4,PDPTR),ICTENDNT                           0524 01320000
         BE    @RF00524                                            0524 01321000
*     DO;                           /*                               */ 01322000
*       IF CCAAPPLY=ON|CCAACCPT=ON  /* IF APPLY OR ACCEPT            */ 01323000
*         THEN                      /*                               */ 01324000
         TM    CCAAPPLY(CCAPTR),B'01100000'                        0526 01325000
         BZ    @RF00526                                            0526 01326000
*         DO;                       /*                               */ 01327000
*           IF ICTPNOGO(1)=ON       /* IF FMID NOGO                  */ 01328000
*             THEN                  /*                               */ 01329000
         TM    ICTPNOGO(PDPTR),B'01000000'                         0528 01330000
         BNO   @RF00528                                            0528 01331000
*             DO;                   /*                               */ 01332000
*               MGPCLEAR=''B;       /*                               */ 01333000
         XC    MGPCLEAR(6),MGPCLEAR                                0530 01334000
*               MGPMGNO1=HMA302I;   /* XXXXXXX PROCESSING TERMINATED    01335000
*                                      FOR SYSMOD XXXXXXX - REASON=  */ 01336000
         MVC   MGPMGNO1(2),@CH01873                                0531 01337000
*               MGPMGNO2=XX2PART2;  /* FMID SYSMOD FAILURE           */ 01338000
         L     @08,@PC00006+4                                      0532 01339000
         MVC   MGPMGNO2(2),XX2PART2+2(@08)                         0532 01340000
*               MGPTYPE=MGPERR;     /*                               */ 01341000
         MVI   MGPTYPE,X'03'                                       0533 01342000
*               MGPVARPT(1)=ADDR(CCAFUNCT);/*                        */ 01343000
         LA    @08,CCAFUNCT(,CCAPTR)                               0534 01344000
         ST    @08,MGPVARPT                                        0534 01345000
*               MGPVARPT(2)=ADDR(XX2PTR1->ICTPTFS(1));/*             */ 01346000
         ST    XX2PTR1,MGPVARPT+4                                  0535 01347000
*               CALL HMASMMSG(HMASMMGP);/*                           */ 01348000
         L     @15,@CV01866                                        0536 01349000
         LA    @01,@AL00536                                        0536 01350000
         BALR  @14,@15                                             0536 01351000
*               XX2PTR1->ICTPNOGO(1)=ON;/*                           */ 01352000
*               XX2PTR1->ICTPCPL(1)=ON;/*                            */ 01353000
*               XX2PTR1->ICTPMSG(1)=ON;/*                            */ 01354000
         OI    ICTPNOGO(XX2PTR1),B'01110000'                       0539 01355000
*               XX2NGSET=YES;       /*                               */ 01356000
         L     @08,@PC00006+8                                      0540 01357000
         MVI   XX2NGSET(@08),C'Y'                                  0540 01358000
*             END;                  /* END FMID IS NOGO              */ 01359000
*         END;                      /* END APPLY OR ACCEPT           */ 01360000
*       ELSE                        /* MUST BE RESTORE               */ 01361000
*         DO;                       /*                               */ 01362000
         B     @RC00526                                            0543 01363000
@RF00526 DS    0H                                                  0544 01364000
*           IF XX2PTR1->ICTPNOGO(1)=ON/* IF SYSMOD NOGO              */ 01365000
*             THEN                  /*                               */ 01366000
         TM    ICTPNOGO(XX2PTR1),B'01000000'                       0544 01367000
         BNO   @RF00544                                            0544 01368000
*             DO;                   /*                               */ 01369000
*               IF ICTPNOGO(1)=OFF  /* IF FMID NOT NOGO YET          */ 01370000
*                 THEN              /*                               */ 01371000
         TM    ICTPNOGO(PDPTR),B'01000000'                         0546 01372000
         BNZ   @RF00546                                            0546 01373000
*                 DO;               /*                               */ 01374000
*                   MGPCLEAR=''B;   /*                               */ 01375000
         XC    MGPCLEAR(6),MGPCLEAR                                0548 01376000
*                   MGPMGNO1=HMA302I;/* X8X PROCESSING TERMINATED FOR   01377000
*                                      SYSMOD X7X - REASON =         */ 01378000
         MVC   MGPMGNO1(2),@CH01873                                0549 01379000
*                   MGPMGNO2=PART029;/* RELATED SYSMOD FAILURE       */ 01380000
         MVC   MGPMGNO2(2),@CH00478                                0550 01381000
*                   MGPTYPE=MGPERR; /*                               */ 01382000
         MVI   MGPTYPE,X'03'                                       0551 01383000
*                   MGPVARPT(1)=ADDR(CCAFUNCT);/*                    */ 01384000
         LA    @08,CCAFUNCT(,CCAPTR)                               0552 01385000
         ST    @08,MGPVARPT                                        0552 01386000
*                   MGPVARPT(2)=ADDR(ICTPTFS(1));/*                  */ 01387000
         ST    PDPTR,MGPVARPT+4                                    0553 01388000
*                   CALL HMASMMSG(HMASMMGP);/*                       */ 01389000
         L     @15,@CV01866                                        0554 01390000
         LA    @01,@AL00554                                        0554 01391000
         BALR  @14,@15                                             0554 01392000
*                   ICTPNOGO(1)=ON; /*                               */ 01393000
*                   ICTPCPL(1)=ON;  /*                               */ 01394000
*                   ICTPMSG(1)=ON;  /*                               */ 01395000
         OI    ICTPNOGO(PDPTR),B'01110000'                         0557 01396000
*                   XX2NGSET=YES;   /*                               */ 01397000
         L     @08,@PC00006+8                                      0558 01398000
         MVI   XX2NGSET(@08),C'Y'                                  0558 01399000
*                 END;              /* END FMID NOT NOGO YET         */ 01400000
*             END;                  /* END SYSMOD NOGO               */ 01401000
@RF00546 DS    0H                                                  0561 01402000
*         END;                      /* END RESTORE                   */ 01403000
@RF00544 DS    0H                                                  0562 01404000
*     END;                          /* END FMID FOUND                */ 01405000
@RC00526 DS    0H                                                  0563 01406000
*   RETURN CODE(ZERO);              /*                               */ 01407000
@RF00524 SLR   @15,@15                                             0563 01408000
         L     @14,@SA00006                                        0563 01409000
         LM    @00,@12,@SA00006+8                                  0563 01410000
         BR    @14                                                 0563 01411000
*   END NG2XX2CK;                   /*                               */ 01412000
         EJECT                                                          01413000
*                                                                  0565 01414000
*   /*****************************************************************/ 01415000
*   /*                                                               */ 01416000
*   /* THIS ROUTINE IS CALLED TO SEE IF THE CURRENT SYSMOD HAS BEEN  */ 01417000
*   /* SUPERCEEDED OR DELETED BY ANY SYSMOD AND IF SO TO SEE WHETHER */ 01418000
*   /* ALL SUCH SYSMODS HAVE BEEN MARKED NOGO. IF SO THEN THE CURRENT*/ 01419000
*   /* SYSMOD IS ALSO MARKED NOGO.                                   */ 01420000
*   /*                                                               */ 01421000
*   /*****************************************************************/ 01422000
*                                                                  0565 01423000
*NG2XX3CK:                          /*                               */ 01424000
*NG2SUPCK:                          /*                               */ 01425000
*NG2DELCK:                          /*                               */ 01426000
*   PROCEDURE(XX3SMD,XX3NGSET);     /*                               */ 01427000
NG2XX3CK DS    0H                                                  0565 01428000
NG2SUPCK DS    0H                                                  0565 01429000
NG2DELCK STM   @14,@12,@SA00007                                    0565 01430000
         MVC   @PC00007(8),0(@01)                                  0565 01431000
*   DECLARE                         /*                               */ 01432000
*     XX3SMD CHAR(*),               /* CURRENT SYSMOD ICT ENTRY      */ 01433000
*     XX3NGSET CHAR(1);             /* SMD MARKED NOGO               */ 01434000
*   DECLARE                         /*                               */ 01435000
*     XX3PTR1 PTR(31);              /*                               */ 01436000
*   DECLARE                         /*                               */ 01437000
*     PEPTR PTR(31),                /* PTR FOR ICT PTF LOOP          */ 01438000
*     PXE FIXED(31);                /* INDEX THRU SUP/DEL LIST       */ 01439000
*   RFY                                                            0569 01440000
*     ICTPTF BASED(PEPTR);          /*                               */ 01441000
*   RFY                             /*                               */ 01442000
*     ICTSUPLS BASED(ICTPSCHN(1));  /*                               */ 01443000
*   RFY                             /*                               */ 01444000
*     ICTDELLS BASED(ICTPDCHN(1));  /*                               */ 01445000
*   XX3PTR1=ADDR(XX3SMD);           /*                               */ 01446000
         L     XX3PTR1,@PC00007                                    0572 01447000
*   XX3PTR1->ICTPNOGO(1)=ON;        /* ASSUME ALL SUP/DEL ALSO NOGO  */ 01448000
         OI    ICTPNOGO(XX3PTR1),B'01000000'                       0573 01449000
*   DO PEPTR=CCAICPTF BY LENGTH(ICTPTF(1)) WHILE(/* ICT PTF LOOP     */ 01450000
*         ICTPEND(1)^=ICTENDNT      /* TILL END                      */ 01451000
*         &XX3PTR1->ICTPNOGO(1)=ON);/* OR NOGO RESET                 */ 01452000
         L     PEPTR,CCAICPTF(,CCAPTR)                             0574 01453000
         B     @DE00574                                            0574 01454000
@DL00574 DS    0H                                                  0575 01455000
*     IF XX3PTR1->ICTPSUPN(1)^=ZERO /* IF SYSMOD IS SUPED            */ 01456000
*       THEN                        /*                               */ 01457000
         ICM   @08,3,ICTPSUPN(XX3PTR1)                             0575 01458000
         BZ    @RF00575                                            0575 01459000
*       DO;                         /*                               */ 01460000
*         DO PXE=1 BY 1 WHILE(      /* LOOP THRU SUP LIST FOR THIS   */ 01461000
*               ICTSUPND(PXE)^=ICTENDIX/* SYSMOD TILL END            */ 01462000
*               &ICTSUPNM(PXE)^=XX3PTR1->ICTPTFS(1));/* OR SYSMOD    */ 01463000
         LA    PXE,1                                               0577 01464000
         B     @DE00577                                            0577 01465000
@DL00577 DS    0H                                                  0578 01466000
*         END;                      /*                               */ 01467000
         AH    PXE,@CH00037                                        0578 01468000
@DE00577 LR    @08,PXE                                             0578 01469000
         SLA   @08,3                                               0578 01470000
         L     @05,ICTPSCHN(,PEPTR)                                0578 01471000
         LA    @01,0(@08,@05)                                      0578 01472000
         AL    @01,@CF02215                                        0578 01473000
         L     @15,ICTSUPND(,@01)                                  0578 01474000
         CL    @15,ICTENDIX                                        0578 01475000
         BE    @DC00577                                            0578 01476000
         ALR   @05,@08                                             0578 01477000
         AL    @05,@CF02215                                        0578 01478000
         CLC   ICTSUPNM(7,@05),ICTPTFS(XX3PTR1)                    0578 01479000
         BNE   @DL00577                                            0578 01480000
@DC00577 DS    0H                                                  0579 01481000
*         IF ICTSUPND(PXE)^=ICTENDIX/* IF SYSMOD FOUND               */ 01482000
*             &ICTPNOGO(1)=OFF      /* AND SUPING SYSMOD NOT NOGO    */ 01483000
*           THEN                    /*                               */ 01484000
         LR    @08,PXE                                             0579 01485000
         SLA   @08,3                                               0579 01486000
         L     @05,ICTPSCHN(,PEPTR)                                0579 01487000
         AL    @05,@CF02215                                        0579 01488000
         L     @08,ICTSUPND(@08,@05)                               0579 01489000
         CL    @08,ICTENDIX                                        0579 01490000
         BE    @RF00579                                            0579 01491000
         TM    ICTPNOGO(PEPTR),B'01000000'                         0579 01492000
         BNZ   @RF00579                                            0579 01493000
*           XX3PTR1->ICTPNOGO(1)=OFF;/* THEN SUPED SYSMOD NOT NOGO   */ 01494000
         NI    ICTPNOGO(XX3PTR1),B'10111111'                       0580 01495000
*       END;                        /*                               */ 01496000
@RF00579 DS    0H                                                  0582 01497000
*     IF XX3PTR1->ICTPNOGO(1)=ON    /* IF STILL NOGO                 */ 01498000
*         &(XX3PTR1->ICTPDEXP(1)=ON /* AND IT IS DELETED             */ 01499000
*         |XX3PTR1->ICTPDIMP(1)=ON) /*                               */ 01500000
*       THEN                        /*                               */ 01501000
@RF00575 TM    ICTPNOGO(XX3PTR1),B'01000000'                       0582 01502000
         BNO   @RF00582                                            0582 01503000
         TM    ICTPDEXP(XX3PTR1),B'00110000'                       0582 01504000
         BZ    @RF00582                                            0582 01505000
*       DO;                         /*                               */ 01506000
*         DO PXE=1 BY 1 WHILE(      /* LOOP THRU SYSMODS             */ 01507000
*               ICTDELND(PXE)^=ICTENDIX/* SYSMOD TILL END            */ 01508000
*               &ICTDELNM(PXE)^=XX3PTR1->ICTPTFS(1));/* OR SYSMOD    */ 01509000
         LA    PXE,1                                               0584 01510000
         B     @DE00584                                            0584 01511000
@DL00584 DS    0H                                                  0585 01512000
*         END;                      /*                               */ 01513000
         AH    PXE,@CH00037                                        0585 01514000
@DE00584 LR    @08,PXE                                             0585 01515000
         SLA   @08,3                                               0585 01516000
         L     @05,ICTPDCHN(,PEPTR)                                0585 01517000
         LA    @01,0(@08,@05)                                      0585 01518000
         AL    @01,@CF02215                                        0585 01519000
         L     @15,ICTDELND(,@01)                                  0585 01520000
         CL    @15,ICTENDIX                                        0585 01521000
         BE    @DC00584                                            0585 01522000
         ALR   @05,@08                                             0585 01523000
         AL    @05,@CF02215                                        0585 01524000
         CLC   ICTDELNM(7,@05),ICTPTFS(XX3PTR1)                    0585 01525000
         BNE   @DL00584                                            0585 01526000
@DC00584 DS    0H                                                  0586 01527000
*         IF ICTDELND(PXE)^=ICTENDIX/* IF SYSMOD FOUND               */ 01528000
*             &ICTPNOGO(1)=OFF      /* AND DELETING SYSMOD NOT NOGO  */ 01529000
*           THEN                    /*                               */ 01530000
         LR    @08,PXE                                             0586 01531000
         SLA   @08,3                                               0586 01532000
         L     @05,ICTPDCHN(,PEPTR)                                0586 01533000
         AL    @05,@CF02215                                        0586 01534000
         L     @08,ICTDELND(@08,@05)                               0586 01535000
         CL    @08,ICTENDIX                                        0586 01536000
         BE    @RF00586                                            0586 01537000
         TM    ICTPNOGO(PEPTR),B'01000000'                         0586 01538000
         BNZ   @RF00586                                            0586 01539000
*           XX3PTR1->ICTPNOGO(1)=OFF;/* THEN DELETED SYSMOD NOT NOGO */ 01540000
         NI    ICTPNOGO(XX3PTR1),B'10111111'                       0587 01541000
*       END;                        /* END SYSMOD DELETED            */ 01542000
@RF00586 DS    0H                                                  0589 01543000
*   END;                            /* END LOOP THRU ICT SYSMODS     */ 01544000
*                                                                  0589 01545000
@RF00582 AH    PEPTR,@CH02176                                      0589 01546000
@DE00574 CLC   ICTPEND(4,PEPTR),ICTENDNT                           0589 01547000
         BE    @DC00574                                            0589 01548000
         TM    ICTPNOGO(XX3PTR1),B'01000000'                       0589 01549000
         BO    @DL00574                                            0589 01550000
@DC00574 DS    0H                                                  0590 01551000
*   /*****************************************************************/ 01552000
*   /*                                                               */ 01553000
*   /* IF SYSMOD STILL NOGO THEN ALL SUPING AND DELETING SYSMODS WERE*/ 01554000
*   /* NOGO SO ISSUE ERROR MESSAGE FOR SYSMOD NOW.                   */ 01555000
*   /*                                                               */ 01556000
*   /*****************************************************************/ 01557000
*                                                                  0590 01558000
*   RFY                                                            0590 01559000
*     ICTPTF BASED(XX3PTR1);        /*                               */ 01560000
*   IF ICTPNOGO(1)=ON               /* IF SYSMOD IS NOGO             */ 01561000
*     THEN                          /*                               */ 01562000
         TM    ICTPNOGO(XX3PTR1),B'01000000'                       0591 01563000
         BNO   @RF00591                                            0591 01564000
*     DO;                           /*                               */ 01565000
*       ICTPCPL(1)=ON;              /*                               */ 01566000
*       ICTPMSG(1)=ON;              /*                               */ 01567000
         OI    ICTPCPL(XX3PTR1),B'00110000'                        0594 01568000
*       XX3NGSET=YES;               /*                               */ 01569000
         L     @08,@PC00007+4                                      0595 01570000
         MVI   XX3NGSET(@08),C'Y'                                  0595 01571000
*       MGPCLEAR=''B;               /*                               */ 01572000
         XC    MGPCLEAR(6),MGPCLEAR                                0596 01573000
*       MGPMGNO1=HMA302I;           /* XXXXXXX PROCESSING TERMINATED    01574000
*                                      FOR SYSMOD XXXXXXX - REASON = */ 01575000
         MVC   MGPMGNO1(2),@CH01873                                0597 01576000
*       MGPTYPE=MGPERR;             /*                               */ 01577000
         MVI   MGPTYPE,X'03'                                       0598 01578000
*       MGPVARPT(1)=ADDR(CCAFUNCT); /*                               */ 01579000
         LA    @08,CCAFUNCT(,CCAPTR)                               0599 01580000
         ST    @08,MGPVARPT                                        0599 01581000
*       MGPVARPT(2)=ADDR(ICTPTFS(1));/*                              */ 01582000
         ST    XX3PTR1,MGPVARPT+4                                  0600 01583000
*       IF ICTPSUPN(1)^=ZERO        /* IF SYSMOD SUPED               */ 01584000
*         THEN                      /*                               */ 01585000
         ICM   @08,3,ICTPSUPN(XX3PTR1)                             0601 01586000
         BZ    @RF00601                                            0601 01587000
*         DO;                       /*                               */ 01588000
*           MGPMGNO2=PART110;       /* ALL SUPERCEDING SYSMODS FAILED*/ 01589000
         MVC   MGPMGNO2(2),@CH01891                                0603 01590000
*           CALL HMASMMSG(HMASMMGP);/*                               */ 01591000
         L     @15,@CV01866                                        0604 01592000
         LA    @01,@AL00604                                        0604 01593000
         BALR  @14,@15                                             0604 01594000
*         END;                      /*                               */ 01595000
*       IF ICTPDEXP(1)=ON|ICTPDIMP(1)=ON/* IF SYSMOD DELETED         */ 01596000
*         THEN                      /*                               */ 01597000
@RF00601 TM    ICTPDEXP(XX3PTR1),B'00110000'                       0606 01598000
         BZ    @RF00606                                            0606 01599000
*         DO;                       /*                               */ 01600000
*           MGPMGNO2=PART111;       /* ALL DELETING SYSMODS FAILED   */ 01601000
         MVC   MGPMGNO2(2),@CH01893                                0608 01602000
*           CALL HMASMMSG(HMASMMGP);/*                               */ 01603000
         L     @15,@CV01866                                        0609 01604000
         LA    @01,@AL00609                                        0609 01605000
         BALR  @14,@15                                             0609 01606000
*         END;                      /*                               */ 01607000
*     END;                          /* END SYSMOD STILL NOGO         */ 01608000
@RF00606 DS    0H                                                  0612 01609000
*   RETURN CODE(ZERO);              /*                               */ 01610000
@RF00591 SLR   @15,@15                                             0612 01611000
         L     @14,@SA00007                                        0612 01612000
         LM    @00,@12,@SA00007+8                                  0612 01613000
         BR    @14                                                 0612 01614000
*   END NG2XX3CK;                   /*                               */ 01615000
         EJECT                                                          01616000
*                                                                  0614 01617000
*   /*****************************************************************/ 01618000
*   /*                                                               */ 01619000
*   /* THIS ROUTINE IS CALLED TO GO THRU THE ICT SYSMOD ENTRIES AND  */ 01620000
*   /* DETERMINE WHICH SYSMODS ARE COMPLETED. THIS IS DONE BY CALLING*/ 01621000
*   /* HMASMCP2 FOR EACH SYSMOD. HMASMCP2 WILL DO ALL COMPLETION     */ 01622000
*   /* CHECKING FOR PRE, REQ, AND IFREQ RELATIONSHIPS                */ 01623000
*   /*                                                               */ 01624000
*   /*****************************************************************/ 01625000
*                                                                  0614 01626000
*SMDCK1:                            /*                               */ 01627000
*   PROCEDURE;                      /*                               */ 01628000
SMDCK1   STM   @14,@12,@SA00008                                    0614 01629000
*   DECLARE                         /*                               */ 01630000
*     P7PTR PTR(31),                /* PTR FOR ICT PTF LOOP          */ 01631000
*     PCPTR PTR(31),                /* PTR FOR ICT PTF LOOP          */ 01632000
*     PXC FIXED(31);                /*                               */ 01633000
*   DECLARE                         /*                               */ 01634000
*     SMDCKRC FIXED(8);             /* PROC RETURN CODE              */ 01635000
*   RFY                                                            0617 01636000
*     ICTPTF BASED(P7PTR);          /*                               */ 01637000
*   RFY                                                            0618 01638000
*     ICTDELLS BASED(PCPTR->ICTPDCHN(1));/* DELETE LIST              */ 01639000
*   SMDCKRC=ZERO;                   /* INIT RC                       */ 01640000
*                                                                  0619 01641000
         SLR   SMDCKRC,SMDCKRC                                     0619 01642000
*   /*****************************************************************/ 01643000
*   /*                                                               */ 01644000
*   /* LOOP CHECKING FOR COMPLETED SYSMODS UNTIL A PASS IS MADE THRU */ 01645000
*   /* ENTIRE ICT AND NO SYSMOD IS MARKED COMPLETED                  */ 01646000
*   /*                                                               */ 01647000
*   /*****************************************************************/ 01648000
*                                                                  0620 01649000
*   LOOPSW1=ON;                     /* SET SW TO LET LOOP GO         */ 01650000
         OI    LOOPSW1,B'00000001'                                 0620 01651000
*   DO WHILE LOOPSW1=ON;            /* LOOP WHILE SYSMOD CPL         */ 01652000
         B     @DE00621                                            0621 01653000
@DL00621 DS    0H                                                  0622 01654000
*     LOOPSW1=OFF;                  /* STOP LOOP IF NONE COMPLETED   */ 01655000
*                                                                  0622 01656000
         NI    LOOPSW1,B'11111110'                                 0622 01657000
*     /***************************************************************/ 01658000
*     /*                                                             */ 01659000
*     /* IF SYSMOD NOT BEING DELETED THEN CHECK FOR RELATED SYSMODS  */ 01660000
*     /* AS COMPLETE AND FOR FMID COMPLETE                           */ 01661000
*     /*                                                             */ 01662000
*     /***************************************************************/ 01663000
*                                                                  0623 01664000
*     DO P7PTR=CCAICPTF BY LENGTH(ICTPTF(1)) WHILE(/* ICT PTF LOOP   */ 01665000
*           ICTPEND(1)^=ICTENDNT);  /* TILL END                      */ 01666000
         L     P7PTR,CCAICPTF(,CCAPTR)                             0623 01667000
         B     @DE00623                                            0623 01668000
@DL00623 DS    0H                                                  0624 01669000
*       IF ICTPECPL(1)=ON           /* IF ALL ELEMENTS COMPLETE      */ 01670000
*           &ICTPGCPL(1)=OFF        /* BUT SYSMOD NOT COMPLETED      */ 01671000
*           &ICTPNOGO(1)=OFF        /* AND NOT NOGO                  */ 01672000
*           &ICTPPROC(1)=ON         /* AND IN PROCESS                */ 01673000
*           &ICTPDEXP(1)=OFF        /* AND NOT BEING DELETED         */ 01674000
*           &ICTPDIMP(1)=OFF        /*                               */ 01675000
*         THEN                      /* THEN ASSUME ALL REQ COMPLETE  */ 01676000
         TM    ICTPECPL(P7PTR),B'01000000'                         0624 01677000
         BNO   @RF00624                                            0624 01678000
         TM    ICTPGCPL(P7PTR),B'10000000'                         0624 01679000
         BNZ   @RF00624                                            0624 01680000
         TM    ICTPPROC(P7PTR),B'10000000'                         0624 01681000
         BNO   @RF00624                                            0624 01682000
         TM    ICTPNOGO(P7PTR),B'01000000'                         0624 01683000
         BNZ   @RF00624                                            0624 01684000
         TM    ICTPDEXP(P7PTR),B'00110000'                         0624 01685000
         BNZ   @RF00624                                            0624 01686000
*         DO;                       /*                               */ 01687000
*           CALL HMASMCP2(ICTPTF(1));/* DO REQ COMPLETION CHECK      */ 01688000
         ST    P7PTR,@AL00001                                      0626 01689000
         L     @15,@CV01861                                        0626 01690000
         LA    @01,@AL00001                                        0626 01691000
         BALR  @14,@15                                             0626 01692000
*           RFY                                                    0627 01693000
*             RTNCODE RSTD;         /*                               */ 01694000
*           IF RTNCODE=ZERO         /* IF RELATED SYSMODS COMPLETE   */ 01695000
*             THEN                  /* THEN                          */ 01696000
         LTR   RTNCODE,RTNCODE                                     0628 01697000
         BNZ   @RF00628                                            0628 01698000
*             DO;                   /*                               */ 01699000
*               IF ICTPTFS(1)^=ICTPFMID(1)/* IF NOT FIRST LVL        */ 01700000
*                 THEN              /* FUNCTION                      */ 01701000
         CLC   ICTPTFS(7,P7PTR),ICTPFMID(P7PTR)                    0630 01702000
         BE    @RF00630                                            0630 01703000
*                 DO;               /*                               */ 01704000
*                   DO PCPTR=CCAICPTF BY LENGTH(ICTPTF(1)) WHILE(/*  */ 01705000
*                         PCPTR->ICTPEND(1)^=ICTENDNT/* FIND END     */ 01706000
*                         &PCPTR->ICTPTFS(1)^=ICTPFMID(1));/* OR FMID*/ 01707000
         L     PCPTR,CCAICPTF(,CCAPTR)                             0632 01708000
         B     @DE00632                                            0632 01709000
@DL00632 DS    0H                                                  0633 01710000
*                   END;            /* FOUND                         */ 01711000
         AH    PCPTR,@CH02176                                      0633 01712000
@DE00632 CLC   ICTPEND(4,PCPTR),ICTENDNT                           0633 01713000
         BE    @DC00632                                            0633 01714000
         CLC   ICTPTFS(7,PCPTR),ICTPFMID(P7PTR)                    0633 01715000
         BNE   @DL00632                                            0633 01716000
@DC00632 DS    0H                                                  0634 01717000
*                   IF PCPTR->ICTPEND(1)=ICTENDNT/* IF FMID NT FND   */ 01718000
*                       |PCPTR->ICTPGCPL(1)=ON/* OR FMID COMPLETE    */ 01719000
*                     THEN          /*                               */ 01720000
         CLC   ICTPEND(4,PCPTR),ICTENDNT                           0634 01721000
         BE    @RT00634                                            0634 01722000
         TM    ICTPGCPL(PCPTR),B'10000000'                         0634 01723000
         BNO   @RF00634                                            0634 01724000
@RT00634 DS    0H                                                  0635 01725000
*                     DO;           /*                               */ 01726000
*                       ICTPGCPL(1)=ON;/* GROUP NOW COMPLETE         */ 01727000
         OI    ICTPGCPL(P7PTR),B'10000000'                         0636 01728000
*                       LOOPSW1=ON; /* GO THRU LOOP AGAIN            */ 01729000
         OI    LOOPSW1,B'00000001'                                 0637 01730000
*                     END;          /*                               */ 01731000
*                 END;              /*                               */ 01732000
*               ELSE                /*                               */ 01733000
*                 DO;               /*                               */ 01734000
         B     @RC00630                                            0640 01735000
@RF00630 DS    0H                                                  0641 01736000
*                   ICTPGCPL(1)=ON; /* GROUP NOW COMPLETE            */ 01737000
         OI    ICTPGCPL(P7PTR),B'10000000'                         0641 01738000
*                   LOOPSW1=ON;     /* GO THRU LOOP AGAIN            */ 01739000
         OI    LOOPSW1,B'00000001'                                 0642 01740000
*                 END;              /*                               */ 01741000
*             END;                  /*                               */ 01742000
@RC00630 DS    0H                                                  0645 01743000
*           RFY                                                    0645 01744000
*             RTNCODE UNRSTD;       /*                               */ 01745000
@RF00628 DS    0H                                                  0646 01746000
*         END;                      /* END ELEMENT COMPLETE          */ 01747000
*     END;                          /* END ICT PTF LOOP              */ 01748000
@RF00624 AH    P7PTR,@CH02176                                      0647 01749000
@DE00623 CLC   ICTPEND(4,P7PTR),ICTENDNT                           0647 01750000
         BNE   @DL00623                                            0647 01751000
*   END;                            /* END DO WHILE LOOP             */ 01752000
*                                                                  0648 01753000
@DE00621 TM    LOOPSW1,B'00000001'                                 0648 01754000
         BO    @DL00621                                            0648 01755000
*   /*****************************************************************/ 01756000
*   /*                                                               */ 01757000
*   /* IF SYSMOD IS BEING DELETED THEN SYSMOD IS COMPLETE WHEN ONE OF*/ 01758000
*   /* THE DELETING SYSMODS IS COMPLETE                              */ 01759000
*   /*                                                               */ 01760000
*   /*****************************************************************/ 01761000
*                                                                  0649 01762000
*   DO P7PTR=CCAICPTF BY LENGTH(ICTPTF(1)) WHILE(/* ICT PTF LOOP     */ 01763000
*         ICTPEND(1)^=ICTENDNT);    /* TILL END                      */ 01764000
         L     P7PTR,CCAICPTF(,CCAPTR)                             0649 01765000
         B     @DE00649                                            0649 01766000
@DL00649 DS    0H                                                  0650 01767000
*     IF ICTPCPL(1)=OFF             /* IF NOT COMPLETE YET           */ 01768000
*         &(ICTPDIMP(1)=ON          /* AND SYSMOD BEING DELETED      */ 01769000
*         |ICTPDEXP(1)=ON)          /*                               */ 01770000
*         &ICTPDCPL(1)=ON           /* AND DELETE PROCESSING DONE    */ 01771000
*       THEN                        /*                               */ 01772000
         TM    ICTPCPL(P7PTR),B'00100000'                          0650 01773000
         BNZ   @RF00650                                            0650 01774000
         TM    ICTPDIMP(P7PTR),B'00110000'                         0650 01775000
         BZ    @RF00650                                            0650 01776000
         TM    ICTPDCPL(P7PTR),B'00100000'                         0650 01777000
         BNO   @RF00650                                            0650 01778000
*       DO;                         /*                               */ 01779000
*         DO PCPTR=CCAICPTF BY LENGTH(ICTPTF(1)) WHILE(/* PTF LOOP   */ 01780000
*               PCPTR->ICTPEND(1)^=ICTENDNT);/* TILL END             */ 01781000
         L     PCPTR,CCAICPTF(,CCAPTR)                             0652 01782000
         B     @DE00652                                            0652 01783000
@DL00652 DS    0H                                                  0653 01784000
*           DO PXC=1 BY 1 WHILE(    /* LOOP THRU DELETE LIST         */ 01785000
*                 ICTDELND(PXC)^=ICTENDIX/* TILL END                 */ 01786000
*                 &ICTDELNM(PXC)^=ICTPTFS(1));/* OR SYSMOD FOUND     */ 01787000
         LA    PXC,1                                               0653 01788000
         B     @DE00653                                            0653 01789000
@DL00653 DS    0H                                                  0654 01790000
*           END;                    /* NOT FOUND                     */ 01791000
         AH    PXC,@CH00037                                        0654 01792000
@DE00653 LR    @08,PXC                                             0654 01793000
         SLA   @08,3                                               0654 01794000
         L     @15,ICTPDCHN(,PCPTR)                                0654 01795000
         LA    @01,0(@08,@15)                                      0654 01796000
         AL    @01,@CF02215                                        0654 01797000
         L     @14,ICTDELND(,@01)                                  0654 01798000
         CL    @14,ICTENDIX                                        0654 01799000
         BE    @DC00653                                            0654 01800000
         ALR   @15,@08                                             0654 01801000
         AL    @15,@CF02215                                        0654 01802000
         CLC   ICTDELNM(7,@15),ICTPTFS(P7PTR)                      0654 01803000
         BNE   @DL00653                                            0654 01804000
@DC00653 DS    0H                                                  0655 01805000
*           IF ICTDELND(PXC)^=ICTENDIX/* IF SYSMOD FOUND             */ 01806000
*               &PCPTR->ICTPECPL(1)=ON/* AND DELETING SMD COMPLETE   */ 01807000
*               &PCPTR->ICTPGCPL(1)=ON/*                             */ 01808000
*             THEN                  /*                               */ 01809000
         LR    @08,PXC                                             0655 01810000
         SLA   @08,3                                               0655 01811000
         L     @01,ICTPDCHN(,PCPTR)                                0655 01812000
         AL    @01,@CF02215                                        0655 01813000
         L     @08,ICTDELND(@08,@01)                               0655 01814000
         CL    @08,ICTENDIX                                        0655 01815000
         BE    @RF00655                                            0655 01816000
         TM    ICTPECPL(PCPTR),B'11000000'                         0655 01817000
         BNO   @RF00655                                            0655 01818000
*             DO;                   /*                               */ 01819000
*               ICTPECPL(1)=ON;     /*                               */ 01820000
*               ICTPGCPL(1)=ON;     /*                               */ 01821000
         OI    ICTPECPL(P7PTR),B'11000000'                         0658 01822000
*               ICTPPROC(1)=ON;     /*                               */ 01823000
         OI    ICTPPROC(P7PTR),B'10000000'                         0659 01824000
*             END;                  /*                               */ 01825000
*         END;                      /* END LOOP THRU SYSMODS         */ 01826000
@RF00655 AH    PCPTR,@CH02176                                      0661 01827000
@DE00652 CLC   ICTPEND(4,PCPTR),ICTENDNT                           0661 01828000
         BNE   @DL00652                                            0661 01829000
*       END;                        /* END SYSMOD NOT COMPLETE       */ 01830000
*   END;                            /* END ICT PTF LOOP              */ 01831000
@RF00650 AH    P7PTR,@CH02176                                      0663 01832000
@DE00649 CLC   ICTPEND(4,P7PTR),ICTENDNT                           0663 01833000
         BNE   @DL00649                                            0663 01834000
*   RETURN CODE(SMDCKRC);           /*                               */ 01835000
         LR    @15,SMDCKRC                                         0664 01836000
         L     @14,@SA00008                                        0664 01837000
         LM    @00,@12,@SA00008+8                                  0664 01838000
         BR    @14                                                 0664 01839000
*   END SMDCK1;                     /*                               */ 01840000
         EJECT                                                          01841000
*                                                                  0666 01842000
*   /*****************************************************************/ 01843000
*   /*                                                               */ 01844000
*   /* THIS ROUTINE IS CALLED AFTER ALL SYSMODS HAVE BEEN EXAMINED   */ 01845000
*   /* AND MARKED AS COMPLETED AND REQS SATISFIED. NOW GO THRU ICT   */ 01846000
*   /* SYSMODS AND FOR EACH SYSMOD THAT HAS HAD ALL OF ITS ELEMENT   */ 01847000
*   /* COMPLETED AND ALL REQS SATISFIED DO SUCCESS PROCESSING.       */ 01848000
*   /*                                                               */ 01849000
*   /*****************************************************************/ 01850000
*                                                                  0666 01851000
*SMDOK1:                            /*                               */ 01852000
*   PROCEDURE;                      /*                               */ 01853000
SMDOK1   STM   @14,@12,@SA00009                                    0666 01854000
*   DECLARE                         /*                               */ 01855000
*     P8PTR PTR(31),                /* PTR FOR ICT PTF LOOP          */ 01856000
*     SAVP8 PTR(31);                /* SAVE FOR ABOVE                */ 01857000
*   DECLARE                         /*                               */ 01858000
*     OKRC FIXED(8),                /*                               */ 01859000
*     OKRC1 FIXED(8);               /*                               */ 01860000
*   DECLARE                         /*                               */ 01861000
*     LON FIXED(15),                /*                               */ 01862000
*     CON FIXED(15);                /*                               */ 01863000
*   DECLARE                         /*                               */ 01864000
*     MAXNUM FIXED(16) INIT('7FFF'X);/*                              */ 01865000
*   RFY                                                            0671 01866000
*     ICTPTF BASED(P8PTR);          /*                               */ 01867000
*   RFY                                                            0672 01868000
*     HMASMIOP BASED(IOPPTR);       /*                               */ 01869000
*   OKRC=ZERO;                      /*                               */ 01870000
*                                                                  0673 01871000
         SLR   OKRC,OKRC                                           0673 01872000
*   /*****************************************************************/ 01873000
*   /*                                                               */ 01874000
*   /* LOOP THRU ICT SYSMOD ENTRIES UNTIL A COMPLTE PASS THRU HAS    */ 01875000
*   /* BEEN MADE WITHOUT FINDING ANT SYSMODS THAT ARE COMPLETED      */ 01876000
*   /*                                                               */ 01877000
*   /*****************************************************************/ 01878000
*                                                                  0674 01879000
*   LOOPSW1=ON;                     /*                               */ 01880000
         OI    LOOPSW1,B'00000001'                                 0674 01881000
*   DO WHILE LOOPSW1=ON;            /*                               */ 01882000
         B     @DE00675                                            0675 01883000
@DL00675 DS    0H                                                  0676 01884000
*     LOOPSW1=OFF;                  /* STOP LOOP                     */ 01885000
         NI    LOOPSW1,B'11111110'                                 0676 01886000
*     IF CCAAPPLY=ON|CCAACCPT=ON    /* SET UP ORDER NUMBERS TO BE    */ 01887000
*       THEN                        /* DETERMINE ORDER TO PROCESS    */ 01888000
         TM    CCAAPPLY(CCAPTR),B'01100000'                        0677 01889000
         BZ    @RF00677                                            0677 01890000
*       CON=ZERO;                   /*                               */ 01891000
         SLR   CON,CON                                             0678 01892000
*     ELSE                          /*                               */ 01893000
*       CON=MAXNUM;                 /*                               */ 01894000
         B     @RC00677                                            0679 01895000
@RF00677 SLR   CON,CON                                             0679 01896000
         ICM   CON,3,MAXNUM                                        0679 01897000
*     FND=ON;                       /*                               */ 01898000
@RC00677 OI    FND,B'00000010'                                     0680 01899000
*     DO WHILE(FND=ON               /* LOOP TILL NO MORE SYSMODS     */ 01900000
*           &OKRC<STOPFUNC);        /* OR ERROR                      */ 01901000
         B     @DE00681                                            0681 01902000
@DL00681 DS    0H                                                  0682 01903000
*       IF CCAAPPLY=ON|CCAACCPT=ON  /* SET UP ORDER NUMBERS TO BE    */ 01904000
*         THEN                      /* DETERMINE ORDER TO PROCESS    */ 01905000
         TM    CCAAPPLY(CCAPTR),B'01100000'                        0682 01906000
         BZ    @RF00682                                            0682 01907000
*         LON=MAXNUM;               /*                               */ 01908000
         SLR   LON,LON                                             0683 01909000
         ICM   LON,3,MAXNUM                                        0683 01910000
*       ELSE                        /*                               */ 01911000
*         LON=ZERO;                 /*                               */ 01912000
         B     @RC00682                                            0684 01913000
@RF00682 SLR   LON,LON                                             0684 01914000
*       FND=OFF;                    /* SET FOR NO SYSMOD FOUND       */ 01915000
@RC00682 NI    FND,B'11111101'                                     0685 01916000
*       OKRC1=ZERO;                 /*                               */ 01917000
         SLR   OKRC1,OKRC1                                         0686 01918000
*       DO P8PTR=CCAICPTF BY LENGTH(ICTPTF(1)) WHILE(/* PTF LOOP     */ 01919000
*             ICTPEND(1)^=ICTENDNT  /* TILL END                      */ 01920000
*             &OKRC1<STOPFUNC);     /* AND NO SERIOUS ERRORS         */ 01921000
         L     P8PTR,CCAICPTF(,CCAPTR)                             0687 01922000
         B     @DE00687                                            0687 01923000
@DL00687 DS    0H                                                  0688 01924000
*         IF ICTPPROC(1)=ON         /* IF SYSMOD IN PROCESS          */ 01925000
*             &ICTPNOGO(1)=OFF      /* BUT NOT NOGO                  */ 01926000
*             &ICTPECPL(1)=ON       /* AND ALL ELEMENTS COMPLETE     */ 01927000
*             &ICTPGCPL(1)=ON       /* AND RELATED SYSMOD COMPLETE   */ 01928000
*             &ICTPCPL(1)=OFF       /* AND NOT PROCESSED YET         */ 01929000
*           THEN                    /*                               */ 01930000
         TM    ICTPPROC(P8PTR),B'10000000'                         0688 01931000
         BNO   @RF00688                                            0688 01932000
         TM    ICTPNOGO(P8PTR),B'01000000'                         0688 01933000
         BNZ   @RF00688                                            0688 01934000
         TM    ICTPECPL(P8PTR),B'11000000'                         0688 01935000
         BNO   @RF00688                                            0688 01936000
         TM    ICTPCPL(P8PTR),B'00100000'                          0688 01937000
         BNZ   @RF00688                                            0688 01938000
*           DO;                     /*                               */ 01939000
*             IF((CCAAPPLY=ON|CCAACCPT=ON)/* IF APPLY/ACCEPT         */ 01940000
*                 &ICTPONUM(1)>CON  /* AND THIS HIGHER THAN CURR     */ 01941000
*                 &ICTPONUM(1)<LON) /* AND LESS THAN LAST ONE        */ 01942000
*                 |(CCARES=ON       /* OR RESTORE                    */ 01943000
*                 &ICTPONUM(1)<CON  /* AND THIS IS LESS THAN LAST    */ 01944000
*                 &ICTPONUM(1)>LON) /* AND GREATER THAN CURR         */ 01945000
*               THEN                /* THEN THIS IS POTENTIAL        */ 01946000
         TM    CCAAPPLY(CCAPTR),B'01100000'                        0690 01947000
         BZ    @GL00041                                            0690 01948000
         SLR   @08,@08                                             0690 01949000
         ICM   @08,3,ICTPONUM(P8PTR)                               0690 01950000
         CR    @08,CON                                             0690 01951000
         BNH   @GL00041                                            0690 01952000
         CR    @08,LON                                             0690 01953000
         BL    @RT00690                                            0690 01954000
@GL00041 TM    CCARES(CCAPTR),B'00001000'                          0690 01955000
         BNO   @RF00690                                            0690 01956000
         SLR   @08,@08                                             0690 01957000
         ICM   @08,3,ICTPONUM(P8PTR)                               0690 01958000
         CR    @08,CON                                             0690 01959000
         BNL   @RF00690                                            0690 01960000
         CR    @08,LON                                             0690 01961000
         BNH   @RF00690                                            0690 01962000
@RT00690 DS    0H                                                  0691 01963000
*               DO;                 /* NEXT SYSMOD                   */ 01964000
*                 LON=ICTPONUM(1);  /* SAVE SYSMOD ORDER NUMBER      */ 01965000
         SLR   LON,LON                                             0692 01966000
         ICM   LON,3,ICTPONUM(P8PTR)                               0692 01967000
*                 FND=ON;           /* NEXT SYSMOD FOUND             */ 01968000
         OI    FND,B'00000010'                                     0693 01969000
*                 SAVP8=P8PTR;      /* SAVE INDEX                    */ 01970000
         ST    P8PTR,SAVP8                                         0694 01971000
*               END;                /* END NEXT SYSMOD FOUND         */ 01972000
*           END;                    /* END SYSMOD ELIGIBLE           */ 01973000
@RF00690 DS    0H                                                  0697 01974000
*       END;                        /* END LOOP THRU SYSMODS         */ 01975000
@RF00688 AH    P8PTR,@CH02176                                      0697 01976000
@DE00687 CLC   ICTPEND(4,P8PTR),ICTENDNT                           0697 01977000
         BE    @DC00687                                            0697 01978000
         CH    OKRC1,@CH00033                                      0697 01979000
         BL    @DL00687                                            0697 01980000
@DC00687 DS    0H                                                  0698 01981000
*       IF FND=ON                   /* IF NEXT SYSMOD FOUND          */ 01982000
*         THEN                      /*                               */ 01983000
         TM    FND,B'00000010'                                     0698 01984000
         BNO   @RF00698                                            0698 01985000
*         DO;                       /*                               */ 01986000
*           LOOPSW1=ON;             /* SET TO CONTINUE OUTER LOOP    */ 01987000
         OI    LOOPSW1,B'00000001'                                 0700 01988000
*           P8PTR=SAVP8;            /* RESET INDEX                   */ 01989000
         L     P8PTR,SAVP8                                         0701 01990000
*           ICTPCPL(1)=ON;          /* PTF COMPLETE                  */ 01991000
         OI    ICTPCPL(P8PTR),B'00100000'                          0702 01992000
*           CON=ICTPONUM(1);        /*                               */ 01993000
         SLR   CON,CON                                             0703 01994000
         ICM   CON,3,ICTPONUM(P8PTR)                               0703 01995000
*           RFY                                                    0704 01996000
*             RTNCODE RSTD;         /*                               */ 01997000
*           IF ICTPDEXP(1)=OFF      /* IF NOT DELETED                */ 01998000
*               &ICTPDIMP(1)=OFF    /*                               */ 01999000
*             THEN                  /*                               */ 02000000
         TM    ICTPDEXP(P8PTR),B'00110000'                         0705 02001000
         BNZ   @RF00705                                            0705 02002000
*             CALL OK1NTDEL;        /*                               */ 02003000
         BAL   @14,OK1NTDEL                                        0706 02004000
*           ELSE                    /*                               */ 02005000
*             CALL OK1DEL;          /*                               */ 02006000
         B     @RC00705                                            0707 02007000
@RF00705 BAL   @14,OK1DEL                                          0707 02008000
*           OKRC1=MAX(OKRC1,RTNCODE);/*                              */ 02009000
@RC00705 CR    OKRC1,RTNCODE                                       0708 02010000
         BNL   *+6                                                      02011000
         LR    OKRC1,RTNCODE                                       0708 02012000
*           RFY                                                    0709 02013000
*             RTNCODE UNRSTD;       /*                               */ 02014000
*           ICTPPROC(1)=OFF;        /* PTF NO LONGER IN PROCESS      */ 02015000
         NI    ICTPPROC(P8PTR),B'01111111'                         0710 02016000
*           OKRC=MAX(OKRC,OKRC1);   /* UPDATE RETURN CODE            */ 02017000
         CR    OKRC,OKRC1                                          0711 02018000
         BNL   *+6                                                      02019000
         LR    OKRC,OKRC1                                          0711 02020000
*         END;                      /* END SYSMOD ELIGIBLE           */ 02021000
*     END;                          /* END ALL SYSMOD FOUND          */ 02022000
@RF00698 DS    0H                                                  0713 02023000
@DE00681 TM    FND,B'00000010'                                     0713 02024000
         BNO   @DC00681                                            0713 02025000
         CH    OKRC,@CH00033                                       0713 02026000
         BL    @DL00681                                            0713 02027000
@DC00681 DS    0H                                                  0714 02028000
*   END;                            /* END CONTINUAL LOOP            */ 02029000
@DE00675 TM    LOOPSW1,B'00000001'                                 0714 02030000
         BO    @DL00675                                            0714 02031000
*   RETURN CODE(OKRC);              /*                               */ 02032000
         LR    @15,OKRC                                            0715 02033000
         L     @14,@SA00009                                        0715 02034000
         LM    @00,@12,@SA00009+8                                  0715 02035000
         BR    @14                                                 0715 02036000
*                                                                  0716 02037000
*   /*****************************************************************/ 02038000
*   /*                                                               */ 02039000
*   /* ROUTINE CALLED TO COMPLETE PROCESSING FOR THOSE NON           */ 02040000
*   /* DELETED/NON SUPERCEDED SYSMODS                                */ 02041000
*   /*                                                               */ 02042000
*   /*****************************************************************/ 02043000
*                                                                  0716 02044000
*OK1NTDEL:                          /*                               */ 02045000
*   PROCEDURE;                      /*                               */ 02046000
OK1NTDEL STM   @14,@12,@SA00010                                    0716 02047000
*   DECLARE                         /*                               */ 02048000
*     NTDELRC FIXED(8);             /*                               */ 02049000
*   DECLARE                         /*                               */ 02050000
*     TMPID CHAR(8),                /* CDS/ACDS ID                   */ 02051000
*     TMPTYPE FIXED(8),             /* CDS/ACDS ID SYSMOD TYPE       */ 02052000
*     NTX FIXED(31);                /* INDEX THRU IOP                */ 02053000
*   DECLARE                         /*                               */ 02054000
*     TIMETEMP CHAR(4) BDY(WORD);   /*                               */ 02055000
*   DECLARE                         /*                               */ 02056000
*     SAVAPPD CHAR(3),              /*                               */ 02057000
*     SAVAPPT CHAR(3);              /*                               */ 02058000
*   RFY                             /*                               */ 02059000
*     HMASMIOP BASED(IOPPTR);       /*                               */ 02060000
*   RFY                             /*                               */ 02061000
*     ICTPTF BASED(P8PTR);          /*                               */ 02062000
*   NTDELRC=ZERO;                   /*                               */ 02063000
         SLR   NTDELRC,NTDELRC                                     0723 02064000
*   RFY                                                            0724 02065000
*     RTNCODE RSTD;                 /*                               */ 02066000
*                                                                  0724 02067000
*   /*****************************************************************/ 02068000
*   /*                                                               */ 02069000
*   /* IF NO SYSMOD ENTRY EXISTS ON THE DATASET ALREADY PUT ONE OUT  */ 02070000
*   /*                                                               */ 02071000
*   /*****************************************************************/ 02072000
*                                                                  0725 02073000
*   IF ICTPCDSE(1)=OFF              /* IF NO ENTRY ON DATASET        */ 02074000
*       &ICTPSUPN(1)=ZERO           /* AND NOT SUPED SYSMOD ENTRY    */ 02075000
*     THEN                          /*                               */ 02076000
         TM    ICTPCDSE(P8PTR),B'10000000'                         0725 02077000
         BNZ   @RF00725                                            0725 02078000
         ICM   @14,3,ICTPSUPN(P8PTR)                               0725 02079000
         BNZ   @RF00725                                            0725 02080000
*     DO;                           /*                               */ 02081000
*       CALL HMASMSEC(ICTPTF(1),IOPPTR);/* CREATE ONE                */ 02082000
         ST    P8PTR,@AL00001                                      0727 02083000
         LA    @14,IOPPTR                                          0727 02084000
         ST    @14,@AL00001+4                                      0727 02085000
         L     @15,@CV01867                                        0727 02086000
         LA    @01,@AL00001                                        0727 02087000
         BALR  @14,@15                                             0727 02088000
*       NTDELRC=MAX(NTDELRC,RTNCODE);/* SAVE RC                      */ 02089000
         CR    NTDELRC,RTNCODE                                     0728 02090000
         BNL   *+6                                                      02091000
         LR    NTDELRC,RTNCODE                                     0728 02092000
*     END;                          /*                               */ 02093000
*                                                                  0729 02094000
*   /*****************************************************************/ 02095000
*   /*                                                               */ 02096000
*   /* IF RESTORE AND SYSMOD HAD INLINE JCLIN THEN MUST NOW DELETE   */ 02097000
*   /* ANY ENTRIES THAT WERE ADDED TO CDS AS RESULT OF JCLIN         */ 02098000
*   /*                                                               */ 02099000
*   /*****************************************************************/ 02100000
*                                                                  0730 02101000
*   IF(ICTPJCLP(1)=ON               /* IF SYSMOD HAD JCLIN           */ 02102000
*       |ICTPADDP(1)=ON)            /* OR ADDED CDS ELEMENTS         */ 02103000
*       &CCARES=ON                  /* AND RESTORE                   */ 02104000
*       &NTDELRC<STOPPTF            /*                               */ 02105000
*     THEN                          /*                               */ 02106000
@RF00725 TM    ICTPJCLP(P8PTR),B'00000010'                         0730 02107000
         BO    @GL00050                                            0730 02108000
         TM    ICTPADDP(P8PTR),B'00000010'                         0730 02109000
         BNO   @RF00730                                            0730 02110000
@GL00050 TM    CCARES(CCAPTR),B'00001000'                          0730 02111000
         BNO   @RF00730                                            0730 02112000
         CH    NTDELRC,@CH00121                                    0730 02113000
         BNL   @RF00730                                            0730 02114000
*     DO;                           /*                               */ 02115000
*       BUPPARM=''B;                /* ZERO BUR PARM                 */ 02116000
         XC    BUPPARM(20),BUPPARM                                 0732 02117000
*       BUPFUNCT=BUPCDSDL;          /* SET TO DELETE CDS ENTRIES     */ 02118000
         MVI   BUPFUNCT,X'06'                                      0733 02119000
*       BUPSTYPE=ICTPTYPE(1);       /* SET SYSMOD TYPE               */ 02120000
         MVC   BUPSTYPE(1),ICTPTYPE(P8PTR)                         0734 02121000
*       BUPSYSMD=ICTPTFS(1);        /* SET SYSMOD NUMBER             */ 02122000
         MVC   BUPSYSMD(7),ICTPTFS(P8PTR)                          0735 02123000
*       CALL HMASMBUR(BUPPARM);     /* DELETE ENTRIES                */ 02124000
         L     @15,@CV01859                                        0736 02125000
         LA    @01,@AL00736                                        0736 02126000
         BALR  @14,@15                                             0736 02127000
*       NTDELRC=MAX(NTDELRC,RTNCODE);/* SAVE RC                      */ 02128000
         CR    NTDELRC,RTNCODE                                     0737 02129000
         BNL   *+6                                                      02130000
         LR    NTDELRC,RTNCODE                                     0737 02131000
*     END;                          /*                               */ 02132000
*                                                                  0738 02133000
*   /*****************************************************************/ 02134000
*   /*                                                               */ 02135000
*   /* IF RESTORE OR ACCEPT AFTER APPLY AND SYSMOD HAD INLINE JCLIN  */ 02136000
*   /* MUST NOW PURGE BACKUP COPIES FROM SCDS                        */ 02137000
*   /*                                                               */ 02138000
*   /*****************************************************************/ 02139000
*                                                                  0739 02140000
*   IF(ICTPJCLP(1)=ON               /* IF SYSMOD HAD JCLIN           */ 02141000
*       |ICTPADDP(1)=ON             /* OR ADDED ELEMENTS             */ 02142000
*       |ICTPMDLP(1)=ON)            /* OR DELETED ELEMENTS           */ 02143000
*       &(CCARES=ON                 /* AND EITHER RESTORE            */ 02144000
*       |(CCAACCPT=ON&TBLNOAPP=OFF))/* OR ACCEPT NOT NOAPPLY         */ 02145000
*       &NTDELRC<STOPPTF            /*                               */ 02146000
*     THEN                          /*                               */ 02147000
@RF00730 TM    ICTPJCLP(P8PTR),B'00000010'                         0739 02148000
         BO    @GL00053                                            0739 02149000
         TM    ICTPADDP(P8PTR),B'00000011'                         0739 02150000
         BZ    @RF00739                                            0739 02151000
@GL00053 TM    CCARES(CCAPTR),B'00001000'                          0739 02152000
         BO    @GL00052                                            0739 02153000
         TM    CCAACCPT(CCAPTR),B'00100000'                        0739 02154000
         BNO   @RF00739                                            0739 02155000
         L     @14,CCATBLPA(,CCAPTR)                               0739 02156000
         TM    TBLNOAPP(@14),B'10000000'                           0739 02157000
         BNZ   @RF00739                                            0739 02158000
@GL00052 CH    NTDELRC,@CH00121                                    0739 02159000
         BNL   @RF00739                                            0739 02160000
*     DO;                           /*                               */ 02161000
*       BUPPARM=''B;                /* ZERO BUR PARM                 */ 02162000
         XC    BUPPARM(20),BUPPARM                                 0741 02163000
*       BUPFUNCT=BUPSTOWD;          /* SET TO DELETE SCDS ENTRIES    */ 02164000
         MVI   BUPFUNCT,X'05'                                      0742 02165000
*       BUPSTYPE=ICTPTYPE(1);       /* SET SYSMOD TYPE               */ 02166000
         MVC   BUPSTYPE(1),ICTPTYPE(P8PTR)                         0743 02167000
*       BUPSYSMD=ICTPTFS(1);        /* SET SYSMOD NUMBER             */ 02168000
         MVC   BUPSYSMD(7),ICTPTFS(P8PTR)                          0744 02169000
*       CALL HMASMBUR(BUPPARM);     /* DELETE ENTRIES                */ 02170000
         L     @15,@CV01859                                        0745 02171000
         LA    @01,@AL00745                                        0745 02172000
         BALR  @14,@15                                             0745 02173000
*       NTDELRC=MAX(NTDELRC,RTNCODE);/* SAVE RC                      */ 02174000
         CR    NTDELRC,RTNCODE                                     0746 02175000
         BNL   *+6                                                      02176000
         LR    NTDELRC,RTNCODE                                     0746 02177000
*     END;                          /*                               */ 02178000
*                                                                  0747 02179000
*   /*****************************************************************/ 02180000
*   /*                                                               */ 02181000
*   /* IF RESTORE THEN PURGE ENTRIES FROM CRQ/ACRQ                   */ 02182000
*   /*                                                               */ 02183000
*   /*****************************************************************/ 02184000
*                                                                  0748 02185000
*   IF CCARES=ON                    /*                               */ 02186000
*       &NTDELRC<STOPPTF            /*                               */ 02187000
*     THEN                          /*                               */ 02188000
@RF00739 TM    CCARES(CCAPTR),B'00001000'                          0748 02189000
         BNO   @RF00748                                            0748 02190000
         CH    NTDELRC,@CH00121                                    0748 02191000
         BNL   @RF00748                                            0748 02192000
*     DO;                           /*                               */ 02193000
*       CALL HMASMPGC(ICTPTF(1));   /*                               */ 02194000
         ST    P8PTR,@AL00001                                      0750 02195000
         L     @15,@CV01864                                        0750 02196000
         LA    @01,@AL00001                                        0750 02197000
         BALR  @14,@15                                             0750 02198000
*       NTDELRC=MAX(NTDELRC,RTNCODE);/*                              */ 02199000
         CR    NTDELRC,RTNCODE                                     0751 02200000
         BNL   *+6                                                      02201000
         LR    NTDELRC,RTNCODE                                     0751 02202000
*     END;                          /*                               */ 02203000
*                                                                  0752 02204000
*   /*****************************************************************/ 02205000
*   /*                                                               */ 02206000
*   /* IF APPLY OR ACCEPT THEN WRITE RCDS TO CRQ/ACRQ                */ 02207000
*   /*                                                               */ 02208000
*   /*****************************************************************/ 02209000
*                                                                  0753 02210000
*   IF(CCAACCPT=ON|CCAAPPLY=ON)     /*                               */ 02211000
*       &ICTPSUPN(1)=ZERO           /* AND NOT SUPED SYSMOD ENTRY    */ 02212000
*       &NTDELRC<STOPPTF            /*                               */ 02213000
*     THEN                          /*                               */ 02214000
@RF00748 TM    CCAACCPT(CCAPTR),B'01100000'                        0753 02215000
         BZ    @RF00753                                            0753 02216000
         ICM   @14,3,ICTPSUPN(P8PTR)                               0753 02217000
         BNZ   @RF00753                                            0753 02218000
         CH    NTDELRC,@CH00121                                    0753 02219000
         BNL   @RF00753                                            0753 02220000
*     DO;                           /*                               */ 02221000
*       CALL HMASMCRW(ICTPTF(1));   /*                               */ 02222000
         ST    P8PTR,@AL00001                                      0755 02223000
         L     @15,@CV01860                                        0755 02224000
         LA    @01,@AL00001                                        0755 02225000
         BALR  @14,@15                                             0755 02226000
*       NTDELRC=MAX(NTDELRC,RTNCODE);/*                              */ 02227000
         CR    NTDELRC,RTNCODE                                     0756 02228000
         BNL   *+6                                                      02229000
         LR    NTDELRC,RTNCODE                                     0756 02230000
*     END;                          /*                               */ 02231000
*                                                                  0757 02232000
*   /*****************************************************************/ 02233000
*   /*                                                               */ 02234000
*   /* CALL ROUTINE TO STORE SUP INFO TO CDS/ACDS                    */ 02235000
*   /*                                                               */ 02236000
*   /*****************************************************************/ 02237000
*                                                                  0758 02238000
*   IF NTDELRC<STOPPTF              /* IF NO PREV ERRORS             */ 02239000
*       &(                          /* AND                           */ 02240000
*       ((CCAAPPLY=ON|CCAACCPT=ON)  /* EITHER APPLY OR ACCEPT        */ 02241000
*       &ICTPSUPN(1)=ZERO)          /* AND SYSMOD NOT SUPED          */ 02242000
*       |(CCARES=ON)                /* OR RESTORE                    */ 02243000
*       )                           /*                               */ 02244000
*     THEN                          /*                               */ 02245000
@RF00753 CH    NTDELRC,@CH00121                                    0758 02246000
         BNL   @RF00758                                            0758 02247000
         TM    CCAAPPLY(CCAPTR),B'01100000'                        0758 02248000
         BZ    @GL00061                                            0758 02249000
         ICM   @14,3,ICTPSUPN(P8PTR)                               0758 02250000
         BZ    @RT00758                                            0758 02251000
@GL00061 TM    CCARES(CCAPTR),B'00001000'                          0758 02252000
         BNO   @RF00758                                            0758 02253000
@RT00758 DS    0H                                                  0759 02254000
*     DO;                           /*                               */ 02255000
*       CALL HMASMSUP(ICTPTF(1));   /*                               */ 02256000
         ST    P8PTR,@AL00001                                      0760 02257000
         L     @15,@CV01869                                        0760 02258000
         LA    @01,@AL00001                                        0760 02259000
         BALR  @14,@15                                             0760 02260000
*       NTDELRC=MAX(NTDELRC,RTNCODE);/*                              */ 02261000
         CR    NTDELRC,RTNCODE                                     0761 02262000
         BNL   *+6                                                      02263000
         LR    NTDELRC,RTNCODE                                     0761 02264000
*     END;                          /*                               */ 02265000
*                                                                  0762 02266000
*   /*****************************************************************/ 02267000
*   /*                                                               */ 02268000
*   /* CALL ROUTINE TO UPDATE MODID FIELDS                           */ 02269000
*   /*                                                               */ 02270000
*   /*****************************************************************/ 02271000
*                                                                  0763 02272000
*   IF NTDELRC<STOPPTF              /*                               */ 02273000
*       &ICTPSUPN(1)=ZERO           /* AND NOT SUPED SYSMOD ENTRY    */ 02274000
*     THEN                          /*                               */ 02275000
@RF00758 CH    NTDELRC,@CH00121                                    0763 02276000
         BNL   @RF00763                                            0763 02277000
         ICM   @14,3,ICTPSUPN(P8PTR)                               0763 02278000
         BNZ   @RF00763                                            0763 02279000
*     DO;                           /*                               */ 02280000
*       CALL HMASMIDU(ICTPTF(1));   /*                               */ 02281000
         ST    P8PTR,@AL00001                                      0765 02282000
         L     @15,@CV01862                                        0765 02283000
         LA    @01,@AL00001                                        0765 02284000
         BALR  @14,@15                                             0765 02285000
*       NTDELRC=MAX(NTDELRC,RTNCODE);/*                              */ 02286000
         CR    NTDELRC,RTNCODE                                     0766 02287000
         BNL   *+6                                                      02288000
         LR    NTDELRC,RTNCODE                                     0766 02289000
*     END;                          /*                               */ 02290000
*                                                                  0767 02291000
*   /*****************************************************************/ 02292000
*   /*                                                               */ 02293000
*   /* DELETE SYSMOD ENTRIES FROM SMPPTS                             */ 02294000
*   /*                                                               */ 02295000
*   /*****************************************************************/ 02296000
*                                                                  0768 02297000
*   IF NTDELRC<STOPPTF              /* IF PREV FUNCTIONS OK          */ 02298000
*       &(                          /* AND EITHER                    */ 02299000
*       (CCAACCPT=ON&TBLNOAPP=OFF&CCAPTSNP=OFF)/* ACC BUT NOT NOAPP     02300000
*                                      AND NOT NOPURGE               */ 02301000
*       |(CCARES=ON&CCAPTSNJ=OFF)   /* OR RESTORE WITH REJECT        */ 02302000
*       )                           /*                               */ 02303000
*     THEN                          /*                               */ 02304000
@RF00763 CH    NTDELRC,@CH00121                                    0768 02305000
         BNL   @RF00768                                            0768 02306000
         TM    CCAACCPT(CCAPTR),B'00100000'                        0768 02307000
         BNO   @GL00065                                            0768 02308000
         L     @14,CCATBLPA(,CCAPTR)                               0768 02309000
         TM    TBLNOAPP(@14),B'10000000'                           0768 02310000
         BNZ   @GL00065                                            0768 02311000
         TM    CCAPTSNP(CCAPTR),B'10000000'                        0768 02312000
         BZ    @RT00768                                            0768 02313000
@GL00065 TM    CCARES(CCAPTR),B'00001000'                          0768 02314000
         BNO   @RF00768                                            0768 02315000
         TM    CCAPTSNJ(CCAPTR),B'00010000'                        0768 02316000
         BNZ   @RF00768                                            0768 02317000
@RT00768 DS    0H                                                  0769 02318000
*     DO;                           /*                               */ 02319000
*       CALL HMASMRJD(ICTPTFS(1),ICTPTPFX(1),ICTPRELN(1));         0770 02320000
         ST    P8PTR,@AL00001                                      0770 02321000
         LA    @14,ICTPTPFX(,P8PTR)                                0770 02322000
         ST    @14,@AL00001+4                                      0770 02323000
         LA    @14,ICTPRELN(,P8PTR)                                0770 02324000
         ST    @14,@AL00001+8                                      0770 02325000
         L     @15,@CV01865                                        0770 02326000
         LA    @01,@AL00001                                        0770 02327000
         BALR  @14,@15                                             0770 02328000
*       NTDELRC=MAX(NTDELRC,RTNCODE);/* SAVE RC                      */ 02329000
         CR    NTDELRC,RTNCODE                                     0771 02330000
         BNL   *+6                                                      02331000
         LR    NTDELRC,RTNCODE                                     0771 02332000
*     END;                          /*                               */ 02333000
*   RFY                                                            0773 02334000
*     RTNCODE UNRSTD;               /*                               */ 02335000
@RF00768 DS    0H                                                  0774 02336000
*                                                                  0774 02337000
*   /*****************************************************************/ 02338000
*   /*                                                               */ 02339000
*   /* IF SYSMOD PROCESSED OK THEN UPDATE THE CDS/ACDS ID LIST IN THE*/ 02340000
*   /* PTS SYSMOD ENTRY                                              */ 02341000
*   /*                                                               */ 02342000
*   /*****************************************************************/ 02343000
*                                                                  0774 02344000
*   IF NTDELRC<STOPPTF              /* IF PTF PROCESSED OK           */ 02345000
*       &(                          /* AND EITHER                    */ 02346000
*       CCAAPPLY=ON                 /* APPLY                         */ 02347000
*       |                           /* OR                            */ 02348000
*       (CCAACCPT=ON                /* ACCEPT WITH                   */ 02349000
*       &(TBLNOAPP=ON|CCAPTSNP=ON)) /* NOAPPLY OR NO PTS PURGE       */ 02350000
*       |                           /* OR                            */ 02351000
*       (CCARES=ON&CCAPTSNJ=ON)     /* OR RESTORE WITH NO PTS REJECT */ 02352000
*       )                           /*                               */ 02353000
*     THEN                          /*                               */ 02354000
         CH    NTDELRC,@CH00121                                    0774 02355000
         BNL   @RF00774                                            0774 02356000
         TM    CCAAPPLY(CCAPTR),B'01000000'                        0774 02357000
         BO    @RT00774                                            0774 02358000
         TM    CCAACCPT(CCAPTR),B'00100000'                        0774 02359000
         BNO   @GL00070                                            0774 02360000
         L     @08,CCATBLPA(,CCAPTR)                               0774 02361000
         TM    TBLNOAPP(@08),B'10000000'                           0774 02362000
         BO    @RT00774                                            0774 02363000
         TM    CCAPTSNP(CCAPTR),B'10000000'                        0774 02364000
         BO    @RT00774                                            0774 02365000
@GL00070 TM    CCARES(CCAPTR),B'00001000'                          0774 02366000
         BNO   @RF00774                                            0774 02367000
         TM    CCAPTSNJ(CCAPTR),B'00010000'                        0774 02368000
         BNO   @RF00774                                            0774 02369000
@RT00774 DS    0H                                                  0775 02370000
*     DO;                           /*                               */ 02371000
*       IOPFUNCT=IOPLOC;            /* LOCATE                        */ 02372000
         L     @08,IOPPTR                                          0776 02373000
         MVI   IOPFUNCT(@08),X'03'                                 0776 02374000
*       IOPNAME=ICTPTFS(1);         /* THE CURRENT                   */ 02375000
         MVI   IOPNAME+7(@08),C' '                                 0777 02376000
         MVC   IOPNAME(7,@08),ICTPTFS(P8PTR)                       0777 02377000
*       IOPTYPE=IOPSMD;             /* SYSMOD                        */ 02378000
         MVI   IOPTYPE(@08),X'0B'                                  0778 02379000
*       IOPDSID=IOPPTS;             /* ON THE SMPPTS                 */ 02380000
         MVI   IOPDSID(@08),X'06'                                  0779 02381000
*       CALL HMASMIO(HMASMIOP);     /*                               */ 02382000
         ST    @08,@AL00001                                        0780 02383000
         L     @15,@CV01863                                        0780 02384000
         LA    @01,@AL00001                                        0780 02385000
         BALR  @14,@15                                             0780 02386000
*       IF IOPRETRN=IOPGOOD         /* IF LOCATED OK                 */ 02387000
*         THEN                      /*                               */ 02388000
         L     @08,IOPPTR                                          0781 02389000
         CLI   IOPRETRN(@08),0                                     0781 02390000
         BNE   @RF00781                                            0781 02391000
*         DO;                       /*                               */ 02392000
*           IF CCAAPPLY=ON          /* IF APPLY                      */ 02393000
*               |CCARES=ON          /* OR RESTORE                    */ 02394000
*             THEN                  /*                               */ 02395000
         TM    CCAAPPLY(CCAPTR),B'01001000'                        0783 02396000
         BZ    @RF00783                                            0783 02397000
*             DO;                   /*                               */ 02398000
*               TMPID=CCACDSID;     /* SAVE CDSID                    */ 02399000
         MVC   TMPID(8),CCACDSID(CCAPTR)                           0785 02400000
*               TMPTYPE=IOPPAPID;   /* AND APPLY ID SUBENTRY TYPE    */ 02401000
         LA    TMPTYPE,40                                          0786 02402000
*               IOPAPP=ON;          /* SYSMOD APPLIED                */ 02403000
         OI    IOPAPP(@08),B'10000000'                             0787 02404000
*             END;                  /*                               */ 02405000
*           ELSE                    /*                               */ 02406000
*             DO;                   /*                               */ 02407000
         B     @RC00783                                            0789 02408000
@RF00783 DS    0H                                                  0790 02409000
*               TMPID=CCAACDID;     /* SAVE ACDSID                   */ 02410000
         MVC   TMPID(8),CCAACDID(CCAPTR)                           0790 02411000
*               TMPTYPE=IOPPACID;   /* AND ACCPT ID SUBENTRY TYPE    */ 02412000
         LA    TMPTYPE,41                                          0791 02413000
*               IOPACC=ON;          /* SYSMOD ACCEPTED               */ 02414000
         L     @08,IOPPTR                                          0792 02415000
         OI    IOPACC(@08),B'00100000'                             0792 02416000
*             END;                  /*                               */ 02417000
*           DO NTX=1 BY 1 WHILE(    /* LOOP THRU SYSMOD SUBENTRIES   */ 02418000
*                 IOPPTFND(NTX)^=IOPEOLST/* TILL END                 */ 02419000
*                 &(IOPPIND(NTX)^=TMPTYPE/* OR TILL ID AND TYPE MATCH*/ 02420000
*                 |IOPPMODS(NTX)^=TMPID));/* FOUND                   */ 02421000
@RC00783 LA    NTX,1                                               0794 02422000
         B     @DE00794                                            0794 02423000
@DL00794 DS    0H                                                  0795 02424000
*           END;                    /* END SEARCH FOR ID             */ 02425000
         AH    NTX,@CH00037                                        0795 02426000
@DE00794 L     @08,IOPPTR                                          0795 02427000
         LR    @15,NTX                                             0795 02428000
         MH    @15,@CH00035                                        0795 02429000
         SLR   @14,@14                                             0795 02430000
         IC    @14,IOPPTFND-9(@15,@08)                             0795 02431000
         CH    @14,@CH00628                                        0795 02432000
         BE    @DC00794                                            0795 02433000
         SLR   @14,@14                                             0795 02434000
         IC    @14,IOPPIND-9(@15,@08)                              0795 02435000
         CR    TMPTYPE,@14                                         0795 02436000
         BNE   @DL00794                                            0795 02437000
         ALR   @08,@15                                             0795 02438000
         CLC   IOPPMODS-9(8,@08),TMPID                             0795 02439000
         BNE   @DL00794                                            0795 02440000
@DC00794 DS    0H                                                  0796 02441000
*           SMDUPD=OFF;             /* INDICATE SYSMOD NOT UPDATED   */ 02442000
*                                                                  0796 02443000
         NI    SMDUPD,B'11111011'                                  0796 02444000
*           /*********************************************************/ 02445000
*           /*                                                       */ 02446000
*           /* NOW DETERMINE WHETHER SYSMOD MUST BE UPDATED AND IF SO*/ 02447000
*           /* EITHER ADD OR DELETE THE ID FROM THE ENTRY            */ 02448000
*           /*                                                       */ 02449000
*           /*********************************************************/ 02450000
*                                                                  0797 02451000
*           IF IOPPTFND(NTX)=IOPEOLST/* IF ID NOT FOUND              */ 02452000
*             THEN                  /*                               */ 02453000
         LA    @08,255                                             0797 02454000
         L     @15,IOPPTR                                          0797 02455000
         LR    @14,NTX                                             0797 02456000
         MH    @14,@CH00035                                        0797 02457000
         SLR   @07,@07                                             0797 02458000
         IC    @07,IOPPTFND-9(@14,@15)                             0797 02459000
         CR    @08,@07                                             0797 02460000
         BNE   @RF00797                                            0797 02461000
*             DO;                   /*                               */ 02462000
*               IF CCAAPPLY=ON|CCAACCPT=ON/* IF APPLY OR ACCEPT      */ 02463000
*                 THEN              /* THEN MUST ADD ID TO           */ 02464000
         TM    CCAAPPLY(CCAPTR),B'01100000'                        0799 02465000
         BZ    @RF00799                                            0799 02466000
*                 DO;               /* SYSMOD                        */ 02467000
*                   IOPPIND(NTX)=TMPTYPE;/* SET SUBENTRY TYPE        */ 02468000
         STC   TMPTYPE,IOPPIND-9(@14,@15)                          0801 02469000
*                   IOPPMODS(NTX)=TMPID;/* ID VALUE                  */ 02470000
         ST    @14,@TF00001                                        0802 02471000
         ALR   @14,@15                                             0802 02472000
         MVC   IOPPMODS-9(8,@14),TMPID                             0802 02473000
*                   IOPPTFND(NTX+1)=IOPEOLST;/* NEW END OF LIST      */ 02474000
         L     @05,@TF00001                                        0803 02475000
         STC   @08,IOPPTFND(@05,@15)                               0803 02476000
*                   SMDUPD=ON;      /*                               */ 02477000
         OI    SMDUPD,B'00000100'                                  0804 02478000
*                 END;              /*                               */ 02479000
*             END;                  /*                               */ 02480000
*           ELSE                    /*                               */ 02481000
*             DO;                   /*                               */ 02482000
         B     @RC00797                                            0807 02483000
@RF00797 DS    0H                                                  0808 02484000
*               IF CCARES=ON        /* IF RESTORE THEN MUST DELETE   */ 02485000
*                 THEN              /* ID FROM SYSMOD                */ 02486000
         TM    CCARES(CCAPTR),B'00001000'                          0808 02487000
         BNO   @RF00808                                            0808 02488000
*                 DO;               /*                               */ 02489000
*                   DO NTX=NTX BY 1 WHILE(/* SHIFT REST OF ENTRIES   */ 02490000
*                         IOPPTFND(NTX)^=IOPEOLST);/* OVER           */ 02491000
         B     @DE00810                                            0810 02492000
@DL00810 DS    0H                                                  0811 02493000
*                     IOPPNTRY(NTX)=IOPPNTRY(NTX+1);/* SHIFT ENTRY   */ 02494000
         L     @08,IOPPTR                                          0811 02495000
         LR    @05,NTX                                             0811 02496000
         MH    @05,@CH00035                                        0811 02497000
         ST    @05,@TF00001                                        0811 02498000
         ALR   @05,@08                                             0811 02499000
         AL    @08,@TF00001                                        0811 02500000
         MVC   IOPPNTRY-9(9,@05),IOPPNTRY(@08)                     0811 02501000
*                   END;            /* END SHIFT                     */ 02502000
         AH    NTX,@CH00037                                        0812 02503000
@DE00810 LR    @08,NTX                                             0812 02504000
         MH    @08,@CH00035                                        0812 02505000
         L     @05,IOPPTR                                          0812 02506000
         SLR   @15,@15                                             0812 02507000
         IC    @15,IOPPTFND-9(@08,@05)                             0812 02508000
         CH    @15,@CH00628                                        0812 02509000
         BNE   @DL00810                                            0812 02510000
*                   SMDUPD=ON;      /*                               */ 02511000
         OI    SMDUPD,B'00000100'                                  0813 02512000
*                   DO NTX=1 BY 1 WHILE(/* LOOP THRU SUBENTRIES      */ 02513000
*                         IOPPTFND(NTX)^=IOPEOLST/* TO SEE IF ANY    */ 02514000
*                         &IOPPIND(NTX)^=IOPPAPID);/* APPLY IDS ARE  */ 02515000
         LA    NTX,1                                               0814 02516000
         B     @DE00814                                            0814 02517000
@DL00814 DS    0H                                                  0815 02518000
*                   END;            /* LEFT                          */ 02519000
         AH    NTX,@CH00037                                        0815 02520000
@DE00814 L     @08,IOPPTR                                          0815 02521000
         LR    @05,NTX                                             0815 02522000
         MH    @05,@CH00035                                        0815 02523000
         SLR   @15,@15                                             0815 02524000
         IC    @15,IOPPTFND-9(@05,@08)                             0815 02525000
         CH    @15,@CH00628                                        0815 02526000
         BE    @DC00814                                            0815 02527000
         SLR   @15,@15                                             0815 02528000
         IC    @15,IOPPIND-9(@05,@08)                              0815 02529000
         CH    @15,@CH00497                                        0815 02530000
         BNE   @DL00814                                            0815 02531000
@DC00814 DS    0H                                                  0816 02532000
*                   IF IOPPTFND(NTX)=IOPEOLST/* IF NONE LEFT THEN    */ 02533000
*                     THEN          /* SYSMOD HAS NOT BEEN APPLIED   */ 02534000
         L     @08,IOPPTR                                          0816 02535000
         LR    @05,NTX                                             0816 02536000
         MH    @05,@CH00035                                        0816 02537000
         SLR   @15,@15                                             0816 02538000
         IC    @15,IOPPTFND-9(@05,@08)                             0816 02539000
         CH    @15,@CH00628                                        0816 02540000
         BNE   @RF00816                                            0816 02541000
*                     IOPAPP=OFF;   /*                               */ 02542000
         NI    IOPAPP(@08),B'01111111'                             0817 02543000
*                 END;              /*                               */ 02544000
@RF00816 DS    0H                                                  0819 02545000
*             END;                  /*                               */ 02546000
*                                                                  0819 02547000
@RF00808 DS    0H                                                  0820 02548000
*           /*********************************************************/ 02549000
*           /*                                                       */ 02550000
*           /* NOW STOW UPDATED PTS SYSMOD ENTRY                     */ 02551000
*           /*                                                       */ 02552000
*           /*********************************************************/ 02553000
*                                                                  0820 02554000
*           IF SMDUPD=ON            /* IF SYSMOD UPDATED             */ 02555000
*             THEN                  /*                               */ 02556000
@RC00797 TM    SMDUPD,B'00000100'                                  0820 02557000
         BNO   @RF00820                                            0820 02558000
*             DO;                   /*                               */ 02559000
*               IOPFUNCT=IOPSTOWR;  /*                               */ 02560000
         L     @08,IOPPTR                                          0822 02561000
         MVI   IOPFUNCT(@08),X'54'                                 0822 02562000
*               CALL HMASMIO(HMASMIOP);/*                            */ 02563000
         ST    @08,@AL00001                                        0823 02564000
         L     @15,@CV01863                                        0823 02565000
         LA    @01,@AL00001                                        0823 02566000
         BALR  @14,@15                                             0823 02567000
*               NTDELRC=MAX(NTDELRC,IOPRETRN);/* SAVE RC             */ 02568000
         L     @08,IOPPTR                                          0824 02569000
         SLR   @05,@05                                             0824 02570000
         IC    @05,IOPRETRN(,@08)                                  0824 02571000
         CR    NTDELRC,@05                                         0824 02572000
         BNL   *+6                                                      02573000
         LR    NTDELRC,@05                                         0824 02574000
*             END;                  /*                               */ 02575000
*         END;                      /* END SYSMOD LOCATED ON PTS     */ 02576000
*       ELSE                        /* IF ERR IN LOCATE              */ 02577000
*         NTDELRC=MAX(NTDELRC,IOPRETRN);/* SAVE RC                   */ 02578000
         B     @RC00781                                            0827 02579000
@RF00781 L     @08,IOPPTR                                          0827 02580000
         SLR   @05,@05                                             0827 02581000
         IC    @05,IOPRETRN(,@08)                                  0827 02582000
         CR    NTDELRC,@05                                         0827 02583000
         BNL   *+6                                                      02584000
         LR    NTDELRC,@05                                         0827 02585000
*     END;                          /* END UPDATE PTS SYSMOD GROUP   */ 02586000
@RC00781 DS    0H                                                  0829 02587000
*                                                                  0829 02588000
*   /*****************************************************************/ 02589000
*   /*                                                               */ 02590000
*   /* GET SYSTEM TIME TO PUT IN SYSMOD ENTRIES                      */ 02591000
*   /*                                                               */ 02592000
*   /*****************************************************************/ 02593000
*                                                                  0829 02594000
*   GEN(TIME DEC)                                                  0829 02595000
*   SETS(R0);                       /*                               */ 02596000
@RF00774 DS    0H                                                  0829 02597000
         TIME DEC                                                       02598000
*   RFY                             /*                               */ 02599000
*     R0 RSTD;                      /*                               */ 02600000
*   TIMETEMP=R0;                    /* SAVE TIME                     */ 02601000
         ST    R0,TIMETEMP                                         0831 02602000
*   RFY                             /*                               */ 02603000
*     R0 UNRSTD;                    /*                               */ 02604000
*                                                                  0832 02605000
*   /*****************************************************************/ 02606000
*   /*                                                               */ 02607000
*   /* IF ACCEPT WITHOUT NOAPPLY THEN TURN ON ACC BIT IN CDS SYSMOD  */ 02608000
*   /*                                                               */ 02609000
*   /*****************************************************************/ 02610000
*                                                                  0833 02611000
*   IF NTDELRC<STOPPTF              /*                               */ 02612000
*       &CCAACCPT=ON                /*                               */ 02613000
*       &TBLNOAPP=OFF               /*                               */ 02614000
*     THEN                          /*                               */ 02615000
         CH    NTDELRC,@CH00121                                    0833 02616000
         BNL   @RF00833                                            0833 02617000
         TM    CCAACCPT(CCAPTR),B'00100000'                        0833 02618000
         BNO   @RF00833                                            0833 02619000
         L     @08,CCATBLPA(,CCAPTR)                               0833 02620000
         TM    TBLNOAPP(@08),B'10000000'                           0833 02621000
         BNZ   @RF00833                                            0833 02622000
*     DO;                           /*                               */ 02623000
*       IOPFUNCT=IOPLOC;            /* GET                           */ 02624000
         L     @08,IOPPTR                                          0835 02625000
         MVI   IOPFUNCT(@08),X'03'                                 0835 02626000
*       IOPTYPE=IOPSMD;             /* SYSMOD ENTRY                  */ 02627000
         MVI   IOPTYPE(@08),X'0B'                                  0836 02628000
*       IOPNAME=ICTPTFS(1);         /* FOR CURRENT SYSMOD            */ 02629000
         MVI   IOPNAME+7(@08),C' '                                 0837 02630000
         MVC   IOPNAME(7,@08),ICTPTFS(P8PTR)                       0837 02631000
*       IOPDSID=IOPCDS;             /* FROM CDS                      */ 02632000
         MVI   IOPDSID(@08),X'02'                                  0838 02633000
*       CALL HMASMIO(HMASMIOP);     /*                               */ 02634000
         ST    @08,@AL00001                                        0839 02635000
         L     @15,@CV01863                                        0839 02636000
         LA    @01,@AL00001                                        0839 02637000
         BALR  @14,@15                                             0839 02638000
*       IF IOPRETRN=IOPGOOD         /* IF FOUND                      */ 02639000
*           &IOPDUMMP=OFF           /* AND NOT DUMMY SUP             */ 02640000
*         THEN                      /*                               */ 02641000
         L     @08,IOPPTR                                          0840 02642000
         CLI   IOPRETRN(@08),0                                     0840 02643000
         BNE   @RF00840                                            0840 02644000
         TM    IOPDUMMP(@08),B'00000100'                           0840 02645000
         BNZ   @RF00840                                            0840 02646000
*         DO;                       /*                               */ 02647000
*           IOPFUNCT=IOPSTOWR;      /*                               */ 02648000
         MVI   IOPFUNCT(@08),X'54'                                 0842 02649000
*           IOPACC=ON;              /* SET ACCEPT BIT                */ 02650000
         OI    IOPACC(@08),B'00100000'                             0843 02651000
*           IOPACCD=CCADATE;        /* SET DATE AND TIME             */ 02652000
         MVC   IOPACCD(3,@08),CCADATE(CCAPTR)                      0844 02653000
*           IOPACCT=TIMETEMP(1:3);  /*                               */ 02654000
         MVC   IOPACCT(3,@08),TIMETEMP                             0845 02655000
*           SAVAPPD=IOPAPPD;        /* SAVE APPLY DATE AND TIME TO   */ 02656000
         MVC   SAVAPPD(3),IOPAPPD(@08)                             0846 02657000
*           SAVAPPT=IOPAPPT;        /* PUT IN ACDS                   */ 02658000
         MVC   SAVAPPT(3),IOPAPPT(@08)                             0847 02659000
*           CALL HMASMIO(HMASMIOP); /*                               */ 02660000
         ST    @08,@AL00001                                        0848 02661000
         L     @15,@CV01863                                        0848 02662000
         LA    @01,@AL00001                                        0848 02663000
         BALR  @14,@15                                             0848 02664000
*         END;                      /*                               */ 02665000
*       IF IOPRETRN>IOPNTFND        /*                               */ 02666000
*         THEN                      /*                               */ 02667000
@RF00840 L     @08,IOPPTR                                          0850 02668000
         CLI   IOPRETRN(@08),4                                     0850 02669000
         BNH   @RF00850                                            0850 02670000
*         NTDELRC=MAX(NTDELRC,IOPRETRN);/*                           */ 02671000
         SLR   @05,@05                                             0851 02672000
         IC    @05,IOPRETRN(,@08)                                  0851 02673000
         CR    NTDELRC,@05                                         0851 02674000
         BNL   *+6                                                      02675000
         LR    NTDELRC,@05                                         0851 02676000
*     END;                          /*                               */ 02677000
@RF00850 DS    0H                                                  0853 02678000
*                                                                  0853 02679000
*   /*****************************************************************/ 02680000
*   /*                                                               */ 02681000
*   /* IF ALL PROCESSING FOR SYSMOD OK THEN STOW ENTRY               */ 02682000
*   /*                                                               */ 02683000
*   /*****************************************************************/ 02684000
*                                                                  0853 02685000
*   IF ICTPSUPN(1)=ZERO             /* IF NOT SUPED SYSMOD           */ 02686000
*     THEN                          /* THEN STOW (A)CDS ENTRY        */ 02687000
@RF00833 ICM   @08,3,ICTPSUPN(P8PTR)                               0853 02688000
         BNZ   @RF00853                                            0853 02689000
*     DO;                           /*                               */ 02690000
*       IF NTDELRC<STOPPTF          /* IF PREV FUNCTIONS OK          */ 02691000
*         THEN                      /*                               */ 02692000
         CH    NTDELRC,@CH00121                                    0855 02693000
         BNL   @RF00855                                            0855 02694000
*         DO;                       /*                               */ 02695000
*           IOPNAM17=ICTPTFS(1);    /*                               */ 02696000
         L     @08,IOPPTR                                          0857 02697000
         MVC   IOPNAM17(7,@08),ICTPTFS(P8PTR)                      0857 02698000
*           IOPTYPE=IOPSMD;         /*                               */ 02699000
         MVI   IOPTYPE(@08),X'0B'                                  0858 02700000
*           IF CCAAPPLY=ON          /* IF APPLY OR RESTORE           */ 02701000
*               |CCARES=ON          /*                               */ 02702000
*             THEN                  /*                               */ 02703000
         TM    CCAAPPLY(CCAPTR),B'01001000'                        0859 02704000
         BZ    @RF00859                                            0859 02705000
*             IOPDSID=IOPCDS;       /* LOCATE ON CDS                 */ 02706000
         MVI   IOPDSID(@08),X'02'                                  0860 02707000
*           ELSE                    /*                               */ 02708000
*             IOPDSID=IOPACDS;      /* LOCATE ON ACDS FOR ACCEPT     */ 02709000
         B     @RC00859                                            0861 02710000
@RF00859 L     @08,IOPPTR                                          0861 02711000
         MVI   IOPDSID(@08),X'0C'                                  0861 02712000
*           IF CCARES=OFF           /* NO NEED TO LOCATE FOR RESTORE */ 02713000
*             THEN                  /*                               */ 02714000
@RC00859 TM    CCARES(CCAPTR),B'00001000'                          0862 02715000
         BNZ   @RF00862                                            0862 02716000
*             DO;                   /*                               */ 02717000
*               IOPFUNCT=IOPLOC;    /*                               */ 02718000
         L     @08,IOPPTR                                          0864 02719000
         MVI   IOPFUNCT(@08),X'03'                                 0864 02720000
*               CALL HMASMIO(HMASMIOP);/*                            */ 02721000
         ST    @08,@AL00001                                        0865 02722000
         L     @15,@CV01863                                        0865 02723000
         LA    @01,@AL00001                                        0865 02724000
         BALR  @14,@15                                             0865 02725000
*               NTDELRC=MAX(NTDELRC,IOPRETRN);/*                     */ 02726000
         L     @08,IOPPTR                                          0866 02727000
         SLR   @05,@05                                             0866 02728000
         IC    @05,IOPRETRN(,@08)                                  0866 02729000
         CR    NTDELRC,@05                                         0866 02730000
         BNL   *+6                                                      02731000
         LR    NTDELRC,@05                                         0866 02732000
*             END;                  /*                               */ 02733000
*           ELSE                    /* IF NOT TO BE LOCATED THEN     */ 02734000
*             IOPRETRN=IOPGOOD;     /* PRIME RETURN CODE             */ 02735000
         B     @RC00862                                            0868 02736000
@RF00862 L     @08,IOPPTR                                          0868 02737000
         MVI   IOPRETRN(@08),X'00'                                 0868 02738000
*           IF IOPRETRN=IOPGOOD     /* IF SYSMOD LOCATED OK          */ 02739000
*             THEN                  /*                               */ 02740000
@RC00862 L     @08,IOPPTR                                          0869 02741000
         CLI   IOPRETRN(@08),0                                     0869 02742000
         BNE   @RF00869                                            0869 02743000
*             DO;                   /*                               */ 02744000
*               IF CCAAPPLY=ON      /* IF APPLY                      */ 02745000
*                 THEN              /*                               */ 02746000
         TM    CCAAPPLY(CCAPTR),B'01000000'                        0871 02747000
         BNO   @RF00871                                            0871 02748000
*                 DO;               /*                               */ 02749000
*                   IOPFUNCT=IOPSTOWR;/*                             */ 02750000
         MVI   IOPFUNCT(@08),X'54'                                 0873 02751000
*                   IOPAPP=ON;      /*                               */ 02752000
         OI    IOPAPP(@08),B'10000000'                             0874 02753000
*                   IOPAPPD=CCADATE;/*                               */ 02754000
         MVC   IOPAPPD(3,@08),CCADATE(CCAPTR)                      0875 02755000
*                   IOPAPPT=TIMETEMP(1:3);/*                         */ 02756000
         MVC   IOPAPPT(3,@08),TIMETEMP                             0876 02757000
*                 END;              /*                               */ 02758000
*               ELSE                /*                               */ 02759000
*                 IF CCAACCPT=ON    /* IF ACCEPT                     */ 02760000
*                   THEN            /* THEN                          */ 02761000
         B     @RC00871                                            0878 02762000
@RF00871 TM    CCAACCPT(CCAPTR),B'00100000'                        0878 02763000
         BNO   @RF00878                                            0878 02764000
*                   DO;             /*                               */ 02765000
*                     IOPFUNCT=IOPSTOWR;/* UPDATE DIRECTORY          */ 02766000
         L     @08,IOPPTR                                          0880 02767000
         MVI   IOPFUNCT(@08),X'54'                                 0880 02768000
*                     IOPREGEN=ON;  /* SET REGEN                     */ 02769000
*                     IOPACC=ON;    /*                               */ 02770000
         OI    IOPREGEN(@08),B'00100001'                           0882 02771000
*                     IOPACCD=CCADATE;/* SET ACC DATE AND TIME       */ 02772000
         MVC   IOPACCD(3,@08),CCADATE(CCAPTR)                      0883 02773000
*                     IOPACCT=TIMETEMP(1:3);/*                       */ 02774000
         MVC   IOPACCT(3,@08),TIMETEMP                             0884 02775000
*                     IF TBLNOAPP=OFF/* AND APPLY IF NOT             */ 02776000
*                       THEN        /* NOAPPLY OPTION                */ 02777000
         L     @05,CCATBLPA(,CCAPTR)                               0885 02778000
         TM    TBLNOAPP(@05),B'10000000'                           0885 02779000
         BNZ   @RF00885                                            0885 02780000
*                       DO;         /*                               */ 02781000
*                         IOPAPP=ON;/*                               */ 02782000
         OI    IOPAPP(@08),B'10000000'                             0887 02783000
*                         IOPAPPD=SAVAPPD;/* SET APPLY DATE IN ACDS  */ 02784000
         MVC   IOPAPPD(3,@08),SAVAPPD                              0888 02785000
*                         IOPAPPT=SAVAPPT;/*                         */ 02786000
         MVC   IOPAPPT(3,@08),SAVAPPT                              0889 02787000
*                       END;        /*                               */ 02788000
*                   END;            /*                               */ 02789000
*                 ELSE              /* IF RESTORE                    */ 02790000
*                   IOPFUNCT=IOPSTOWD;/* DO STOW DELETE              */ 02791000
         B     @RC00878                                            0892 02792000
@RF00878 L     @08,IOPPTR                                          0892 02793000
         MVI   IOPFUNCT(@08),X'53'                                 0892 02794000
*               IOPERROR=OFF;       /*                               */ 02795000
@RC00878 DS    0H                                                  0893 02796000
@RC00871 L     @08,IOPPTR                                          0893 02797000
         NI    IOPERROR(@08),B'11101111'                           0893 02798000
*               CALL HMASMIO(HMASMIOP);/* UPDATE DATASET WITH      0894 02799000
*                                      COMPLETED SYSMOD ENTRY        */ 02800000
         ST    @08,@AL00001                                        0894 02801000
         L     @15,@CV01863                                        0894 02802000
         LA    @01,@AL00001                                        0894 02803000
         BALR  @14,@15                                             0894 02804000
*               NTDELRC=MAX(NTDELRC,IOPRETRN);/* SAVE RC             */ 02805000
         L     @08,IOPPTR                                          0895 02806000
         SLR   @05,@05                                             0895 02807000
         IC    @05,IOPRETRN(,@08)                                  0895 02808000
         CR    NTDELRC,@05                                         0895 02809000
         BNL   *+6                                                      02810000
         LR    NTDELRC,@05                                         0895 02811000
*               ICTPFLG1(1)=IOPPTFF1;/* RESET STATUS INDICATORS      */ 02812000
         MVC   ICTPFLG1(1,P8PTR),IOPPTFF1(@08)                     0896 02813000
*             END;                  /*                               */ 02814000
*         END;                      /* END SYSMOD COMPLETED OK       */ 02815000
@RF00869 DS    0H                                                  0899 02816000
*       MGPCLEAR=''B;               /*                               */ 02817000
@RF00855 XC    MGPCLEAR(6),MGPCLEAR                                0899 02818000
*       MGPVARPT(1)=ADDR(CCAFUNCT); /* FUNCTION                      */ 02819000
         LA    @08,CCAFUNCT(,CCAPTR)                               0900 02820000
         ST    @08,MGPVARPT                                        0900 02821000
*       MGPVARPT(2)=ADDR(ICTPTFS(1));/* SYSMOD NUMBER                */ 02822000
         ST    P8PTR,MGPVARPT+4                                    0901 02823000
*       MGPTYPE=MGPINFO;            /*                               */ 02824000
*                                                                  0902 02825000
         MVI   MGPTYPE,X'01'                                       0902 02826000
*       /*************************************************************/ 02827000
*       /*                                                           */ 02828000
*       /* IF SYSMOD COMPLETED OK THEN ISSUE MESSAGE                 */ 02829000
*       /*                                                           */ 02830000
*       /*************************************************************/ 02831000
*                                                                  0903 02832000
*       IF NTDELRC<STOPPTF          /*                               */ 02833000
*         THEN                      /*                               */ 02834000
         CH    NTDELRC,@CH00121                                    0903 02835000
         BNL   @RF00903                                            0903 02836000
*         MGPMGNO1=HMA227I;         /* XXXXXXXX PROCESSING         0904 02837000
*                                      SUCCESSFULL FOR SYSMOD XXXXXXX*/ 02838000
*                                                                  0904 02839000
         MVC   MGPMGNO1(2),@CH00476                                0904 02840000
*       /*************************************************************/ 02841000
*       /*                                                           */ 02842000
*       /* IF SYSMOD DID NOT COMPLETE OK THEN ISSUE ERROR MESSAGE    */ 02843000
*       /*                                                           */ 02844000
*       /*************************************************************/ 02845000
*                                                                  0905 02846000
*       ELSE                        /*                               */ 02847000
*         DO;                       /*                               */ 02848000
         B     @RC00903                                            0905 02849000
@RF00903 DS    0H                                                  0906 02850000
*           MGPMGNO1=HMA302I;       /* XXXXXXX PROCESSING TERMINATED    02851000
*                                      FOR SYSMOD XXXXXXX - REASON = */ 02852000
         MVC   MGPMGNO1(2),@CH01873                                0906 02853000
*           MGPMGNO2=PART105;       /* SMP UPDATE FAILURE            */ 02854000
         MVC   MGPMGNO2(2),@CH00950                                0907 02855000
*         END;                      /*                               */ 02856000
*       CALL HMASMMSG(HMASMMGP);    /*                               */ 02857000
@RC00903 L     @15,@CV01866                                        0909 02858000
         LA    @01,@AL00909                                        0909 02859000
         BALR  @14,@15                                             0909 02860000
*     END;                          /* END NOT SUPED SYSMOD          */ 02861000
*   RETURN CODE(NTDELRC);           /*                               */ 02862000
@RF00853 LR    @15,NTDELRC                                         0911 02863000
         L     @14,@SA00010                                        0911 02864000
         LM    @00,@12,@SA00010+8                                  0911 02865000
         BR    @14                                                 0911 02866000
*   END OK1NTDEL;                   /*                               */ 02867000
*                                                                  0913 02868000
*   /*****************************************************************/ 02869000
*   /*                                                               */ 02870000
*   /* ROUTINE TO COMPLETE PROCESSING FOR DELETED SYSMODS            */ 02871000
*   /*                                                               */ 02872000
*   /*****************************************************************/ 02873000
*                                                                  0913 02874000
*OK1DEL:                            /*                               */ 02875000
*   PROCEDURE;                      /*                               */ 02876000
OK1DEL   STM   @14,@12,@SA00011                                    0913 02877000
*   DECLARE                         /*                               */ 02878000
*     DELRC FIXED(8);               /*                               */ 02879000
*   DECLARE                         /*                               */ 02880000
*     PFPTR PTR(31),                /*                               */ 02881000
*     PXF FIXED(31),                /*                               */ 02882000
*     SAVPF PTR(31),                /*                               */ 02883000
*     REDOPTR PTR(31);              /*                               */ 02884000
*   DECLARE                         /*                               */ 02885000
*     HOLDNUM FIXED(15);            /*                               */ 02886000
*   RFY                             /*                               */ 02887000
*     HMASMIOP BASED(IOPPTR);       /*                               */ 02888000
*   RFY                             /*                               */ 02889000
*     ICTPTF BASED(P8PTR);          /*                               */ 02890000
*   RFY                             /*                               */ 02891000
*     ICTDELLS BASED(PFPTR->ICTPDCHN(1));/*                          */ 02892000
*   DELRC=ZERO;                     /*                               */ 02893000
         SLR   DELRC,DELRC                                         0920 02894000
*   IOPTYPE=IOPSMD;                 /*                               */ 02895000
         L     @08,IOPPTR                                          0921 02896000
         MVI   IOPTYPE(@08),X'0B'                                  0921 02897000
*   IF CCAAPPLY=ON                  /*                               */ 02898000
*     THEN                          /*                               */ 02899000
         TM    CCAAPPLY(CCAPTR),B'01000000'                        0922 02900000
         BNO   @RF00922                                            0922 02901000
*     IOPDSID=IOPCDS;               /*                               */ 02902000
         MVI   IOPDSID(@08),X'02'                                  0923 02903000
*   ELSE                            /*                               */ 02904000
*     IOPDSID=IOPACDS;              /*                               */ 02905000
*                                                                  0924 02906000
         B     @RC00922                                            0924 02907000
@RF00922 L     @08,IOPPTR                                          0924 02908000
         MVI   IOPDSID(@08),X'0C'                                  0924 02909000
*   /*****************************************************************/ 02910000
*   /*                                                               */ 02911000
*   /* CALL ROUTINE TO PROCESS THE SUPED SYSMODS FROM THE DELETED    */ 02912000
*   /* SYSMOD                                                        */ 02913000
*   /*                                                               */ 02914000
*   /*****************************************************************/ 02915000
*                                                                  0925 02916000
*   CALL CPLSUPDL;                  /*                               */ 02917000
@RC00922 BAL   @14,CPLSUPDL                                        0925 02918000
*   RFY                             /*                               */ 02919000
*     RTNCODE RSTD;                 /*                               */ 02920000
*   DELRC=MAX(DELRC,RTNCODE);       /*                               */ 02921000
         CR    DELRC,RTNCODE                                       0927 02922000
         BNL   *+6                                                      02923000
         LR    DELRC,RTNCODE                                       0927 02924000
*   RFY                             /*                               */ 02925000
*     RTNCODE UNRSTD;               /*                               */ 02926000
*                                                                  0928 02927000
*   /*****************************************************************/ 02928000
*   /*                                                               */ 02929000
*   /* IF SUP PROCESSING THEN PROCESS DELETING THE SYSMOD            */ 02930000
*   /*                                                               */ 02931000
*   /*****************************************************************/ 02932000
*                                                                  0929 02933000
*   IOPNAME=ICTPTFS(1);             /*                               */ 02934000
         L     @08,IOPPTR                                          0929 02935000
         MVI   IOPNAME+7(@08),C' '                                 0929 02936000
         MVC   IOPNAME(7,@08),ICTPTFS(P8PTR)                       0929 02937000
*   IF DELRC<STOPPTF                /*                               */ 02938000
*     THEN                          /*                               */ 02939000
         CH    DELRC,@CH00121                                      0930 02940000
         BNL   @RF00930                                            0930 02941000
*     DO;                           /*                               */ 02942000
*       IF ICTPDIMP(1)=ON           /* IF IMPLICITLY DELETED         */ 02943000
*         THEN                      /*                               */ 02944000
         TM    ICTPDIMP(P8PTR),B'00010000'                         0932 02945000
         BNO   @RF00932                                            0932 02946000
*         DO;                       /*                               */ 02947000
*           CALL REDOCHK(ICTPTF(1), /* SYSMOD BEING DELETED          */ 02948000
*               REDOPTR);           /* SAME SYSMOD BEING REINSTALLED */ 02949000
         ST    P8PTR,@AL00001                                      0934 02950000
         LA    @08,REDOPTR                                         0934 02951000
         ST    @08,@AL00001+4                                      0934 02952000
         LA    @01,@AL00001                                        0934 02953000
         BAL   @14,REDOCHK                                         0934 02954000
*           IF REDOPTR=ZERO         /* SYSMOD NOT BEING RE-INSTALLED */ 02955000
*             THEN                                                 0935 02956000
         ICM   @08,15,REDOPTR                                      0935 02957000
         BNZ   @RF00935                                            0935 02958000
*             DO;                                                  0936 02959000
*               IOPFUNCT=IOPSTOWD;  /*                               */ 02960000
         L     @08,IOPPTR                                          0937 02961000
         MVI   IOPFUNCT(@08),X'53'                                 0937 02962000
*               CALL HMASMIO(HMASMIOP);/* DELETE SYSMOD ENTRY        */ 02963000
         ST    @08,@AL00001                                        0938 02964000
         L     @15,@CV01863                                        0938 02965000
         LA    @01,@AL00001                                        0938 02966000
         BALR  @14,@15                                             0938 02967000
*               DELRC=MAX(DELRC,IOPRETRN);/* SAVE RC                 */ 02968000
         L     @08,IOPPTR                                          0939 02969000
         SLR   @05,@05                                             0939 02970000
         IC    @05,IOPRETRN(,@08)                                  0939 02971000
         CR    DELRC,@05                                           0939 02972000
         BNL   *+6                                                      02973000
         LR    DELRC,@05                                           0939 02974000
*             END;                                                 0940 02975000
*           ICTERROR(1)=OFF;        /* NO LONGER IN ERROR            */ 02976000
@RF00935 NI    ICTERROR(P8PTR),B'11101111'                         0941 02977000
*         END;                      /*                               */ 02978000
*       ELSE                        /* IF EXPLICITLY DELETED         */ 02979000
*         IF ICTPPDEL(1)=OFF        /* AND NOT PREVIOUSLY DELETED    */ 02980000
*           THEN                    /*                               */ 02981000
         B     @RC00932                                            0943 02982000
@RF00932 TM    ICTPPDEL(P8PTR),B'00100000'                         0943 02983000
         BNZ   @RF00943                                            0943 02984000
*           DO;                     /*                               */ 02985000
*             HOLDNUM=ZERO;         /*                               */ 02986000
         SLR   HOLDNUM,HOLDNUM                                     0945 02987000
*             DO PFPTR=CCAICPTF BY LENGTH(ICTPTF(1)) WHILE(/* LOOP   */ 02988000
*                   PFPTR->ICTPEND(1)^=ICTENDNT);/* TILL END OF PTFS */ 02989000
         L     PFPTR,CCAICPTF(,CCAPTR)                             0946 02990000
         B     @DE00946                                            0946 02991000
@DL00946 DS    0H                                                  0947 02992000
*               IF PFPTR->ICTPCPL(1)=ON/* IF SYSMOD COMPLETE         */ 02993000
*                   &PFPTR->ICTPNOGO(1)=OFF/* AND NOT NOGO           */ 02994000
*                   &PFPTR->ICTPDELP(1)=ON/* AND HAS DELETES         */ 02995000
*                   &PFPTR->ICTPONUM(1)>HOLDNUM/* AND HIGHER ORDER   */ 02996000
*                 THEN              /* THEN SEE IF THIS ONES         */ 02997000
         TM    ICTPCPL(PFPTR),B'00100000'                          0947 02998000
         BNO   @RF00947                                            0947 02999000
         TM    ICTPNOGO(PFPTR),B'01000000'                         0947 03000000
         BNZ   @RF00947                                            0947 03001000
         TM    ICTPDELP(PFPTR),B'10000000'                         0947 03002000
         BNO   @RF00947                                            0947 03003000
         SLR   @08,@08                                             0947 03004000
         ICM   @08,3,ICTPONUM(PFPTR)                               0947 03005000
         CR    HOLDNUM,@08                                         0947 03006000
         BNL   @RF00947                                            0947 03007000
*                 DO;               /* DELETES CURRENT ON            */ 03008000
*                   DO PXF=1 BY 1 WHILE(/* SEE IF THIS DELETES       */ 03009000
*                         ICTDELND(PXF)^=ICTENDIX/* CURRENT          */ 03010000
*                         &ICTDELNM(PXF)^=ICTPTFS(1));/*             */ 03011000
         LA    PXF,1                                               0949 03012000
         B     @DE00949                                            0949 03013000
@DL00949 DS    0H                                                  0950 03014000
*                   END;            /*                               */ 03015000
         AH    PXF,@CH00037                                        0950 03016000
@DE00949 LR    @08,PXF                                             0950 03017000
         SLA   @08,3                                               0950 03018000
         L     @07,ICTPDCHN(,PFPTR)                                0950 03019000
         LA    @01,0(@08,@07)                                      0950 03020000
         AL    @01,@CF02215                                        0950 03021000
         L     @15,ICTDELND(,@01)                                  0950 03022000
         CL    @15,ICTENDIX                                        0950 03023000
         BE    @DC00949                                            0950 03024000
         ALR   @07,@08                                             0950 03025000
         AL    @07,@CF02215                                        0950 03026000
         CLC   ICTDELNM(7,@07),ICTPTFS(P8PTR)                      0950 03027000
         BNE   @DL00949                                            0950 03028000
@DC00949 DS    0H                                                  0951 03029000
*                   IF ICTDELND(PXF)^=ICTENDIX/* IF NOT STOP         */ 03030000
*                     THEN          /* AT END                        */ 03031000
         LR    @08,PXF                                             0951 03032000
         SLA   @08,3                                               0951 03033000
         L     @07,ICTPDCHN(,PFPTR)                                0951 03034000
         AL    @07,@CF02215                                        0951 03035000
         L     @08,ICTDELND(@08,@07)                               0951 03036000
         CL    @08,ICTENDIX                                        0951 03037000
         BE    @RF00951                                            0951 03038000
*                     DO;           /*                               */ 03039000
*                       HOLDNUM=PFPTR->ICTPONUM(1);/* SAVE ORDER     */ 03040000
         SLR   HOLDNUM,HOLDNUM                                     0953 03041000
         ICM   HOLDNUM,3,ICTPONUM(PFPTR)                           0953 03042000
*                       SAVPF=PFPTR;/*                               */ 03043000
         ST    PFPTR,SAVPF                                         0954 03044000
*                     END;          /*                               */ 03045000
*                 END;              /*                               */ 03046000
@RF00951 DS    0H                                                  0957 03047000
*             END;                  /*                               */ 03048000
@RF00947 AH    PFPTR,@CH02176                                      0957 03049000
@DE00946 CLC   ICTPEND(4,PFPTR),ICTENDNT                           0957 03050000
         BNE   @DL00946                                            0957 03051000
*             IOPPTFDR=''B;         /*                               */ 03052000
         L     @08,IOPPTR                                          0958 03053000
         XC    IOPPTFDR(24,@08),IOPPTFDR(@08)                      0958 03054000
*             IOPPTFFX=''B;         /*                               */ 03055000
         XC    IOPPTFFX(80,@08),IOPPTFFX(@08)                      0959 03056000
*             IOPDUMMP=ON;          /* DUMMY ONLY DELETED            */ 03057000
         OI    IOPDUMMP(@08),B'00000100'                           0960 03058000
*             IOPDBYP=ON;           /* DELNUM PRESENT                */ 03059000
         OI    IOPDBYP(@08),B'01000000'                            0961 03060000
*             IOPPTYPE=IOPPFUNC;    /* DELETED ENTRIES ARE FUNCTIONS */ 03061000
         MVI   IOPPTYPE(@08),X'04'                                 0962 03062000
*             IOPDBYNO=SAVPF->ICTPTFS(1);/* PUT IN DELETEING SMD     */ 03063000
         L     @05,SAVPF                                           0963 03064000
         MVC   IOPDBYNO(7,@08),ICTPTFS(@05)                        0963 03065000
*             IOPFUNCT=IOPSTOWR;    /*                               */ 03066000
         MVI   IOPFUNCT(@08),X'54'                                 0964 03067000
*             CALL HMASMIO(HMASMIOP);/*                              */ 03068000
         ST    @08,@AL00001                                        0965 03069000
         L     @15,@CV01863                                        0965 03070000
         LA    @01,@AL00001                                        0965 03071000
         BALR  @14,@15                                             0965 03072000
*             DELRC=MAX(DELRC,IOPRETRN);/* SAVE RC                   */ 03073000
         L     @08,IOPPTR                                          0966 03074000
         SLR   @05,@05                                             0966 03075000
         IC    @05,IOPRETRN(,@08)                                  0966 03076000
         CR    DELRC,@05                                           0966 03077000
         BNL   *+6                                                      03078000
         LR    DELRC,@05                                           0966 03079000
*             ICTPFLG1(1)=IOPPTFF1; /* RESET FLAGS                   */ 03080000
         MVC   ICTPFLG1(1,P8PTR),IOPPTFF1(@08)                     0967 03081000
*           END;                    /*                               */ 03082000
*     END;                          /* END SUP PROCESSING OK         */ 03083000
@RF00943 DS    0H                                                  0969 03084000
@RC00932 DS    0H                                                  0970 03085000
*   CALL HMASMPGC(ICTPTF(1));       /* PURGE CRQ/SCRQ DATA           */ 03086000
@RF00930 ST    P8PTR,@AL00001                                      0970 03087000
         L     @15,@CV01864                                        0970 03088000
         LA    @01,@AL00001                                        0970 03089000
         BALR  @14,@15                                             0970 03090000
*   RFY                             /*                               */ 03091000
*     RTNCODE RSTD;                 /*                               */ 03092000
*   DELRC=MAX(DELRC,RTNCODE);       /*                               */ 03093000
         CR    DELRC,RTNCODE                                       0972 03094000
         BNL   *+6                                                      03095000
         LR    DELRC,RTNCODE                                       0972 03096000
*   RFY                             /*                               */ 03097000
*     RTNCODE UNRSTD;               /*                               */ 03098000
*   RETURN CODE(DELRC);             /*                               */ 03099000
         LR    @15,DELRC                                           0974 03100000
         L     @14,@SA00011                                        0974 03101000
         LM    @00,@12,@SA00011+8                                  0974 03102000
         BR    @14                                                 0974 03103000
*   END OK1DEL;                     /*                               */ 03104000
         EJECT                                                          03105000
*                                                                  0976 03106000
*   /*****************************************************************/ 03107000
*   /*                                                               */ 03108000
*   /* ROUTINE CALLED TO PROCESS THE SUPERCEDED SYSMODS FOR THOSE    */ 03109000
*   /* SYSMODS BEING DELETED COMPLETE                                */ 03110000
*   /*                                                               */ 03111000
*   /*****************************************************************/ 03112000
*                                                                  0976 03113000
*CPLSUPDL:                          /*                               */ 03114000
*   PROCEDURE;                      /*                               */ 03115000
CPLSUPDL STM   @14,@12,@SA00012                                    0976 03116000
*   DECLARE                         /*                               */ 03117000
*     1 SUPDLSW BIT(8),             /*                               */ 03118000
*       3 SUPFND BIT(1),            /*                               */ 03119000
*       3 * BIT(7);                 /*                               */ 03120000
*   DECLARE                         /*                               */ 03121000
*     SUPDLRC FIXED(8);             /*                               */ 03122000
*   DECLARE                         /*                               */ 03123000
*     SUPDLX FIXED(31);             /*                               */ 03124000
*   DECLARE                         /*                               */ 03125000
*     PXH FIXED(31);                /*                               */ 03126000
*   RFY                             /*                               */ 03127000
*     HMASMIOP BASED(IOPPTR);       /*                               */ 03128000
*   RFY                             /*                               */ 03129000
*     ICTPTF BASED(P8PTR);          /*                               */ 03130000
*   RFY                             /*                               */ 03131000
*     ICTSUPLS BASED(ICTPSCHN(1));  /*                               */ 03132000
*   SUPDLRC=ZERO;                   /*                               */ 03133000
         SLR   SUPDLRC,SUPDLRC                                     0984 03134000
*   SUPFND=OFF;                     /*                               */ 03135000
*                                                                  0985 03136000
         NI    SUPFND,B'01111111'                                  0985 03137000
*   /*****************************************************************/ 03138000
*   /*                                                               */ 03139000
*   /* LOOP THRU ICT AND PROCESS ALL SUPED SYSMODS FROM THE SYSMOD   */ 03140000
*   /* BEING DELETED                                                 */ 03141000
*   /*                                                               */ 03142000
*   /*****************************************************************/ 03143000
*                                                                  0986 03144000
*   DO PXH=1 BY 1 WHILE(            /* LOOP THRU PTFS SUPS           */ 03145000
*         SUPDLRC<STOPPTF           /* TILL ERROR                    */ 03146000
*         &ICTSUPND(PXH)^=ICTENDNT);/* OR END                        */ 03147000
         LA    PXH,1                                               0986 03148000
         B     @DE00986                                            0986 03149000
@DL00986 DS    0H                                                  0987 03150000
*     IOPFUNCT=IOPLOC;              /*                               */ 03151000
         L     @08,IOPPTR                                          0987 03152000
         MVI   IOPFUNCT(@08),X'03'                                 0987 03153000
*     IOPNAME=ICTSUPNM(PXH);        /* PICK UP SUPED NUMBER          */ 03154000
         MVI   IOPNAME+7(@08),C' '                                 0988 03155000
         LR    @02,PXH                                             0988 03156000
         SLA   @02,3                                               0988 03157000
         L     @01,ICTPSCHN(,P8PTR)                                0988 03158000
         ALR   @01,@02                                             0988 03159000
         AL    @01,@CF02215                                        0988 03160000
         MVC   IOPNAME(7,@08),ICTSUPNM(@01)                        0988 03161000
*     IOPTYPE=IOPSMD;               /*                               */ 03162000
         MVI   IOPTYPE(@08),X'0B'                                  0989 03163000
*     CALL HMASMIO(HMASMIOP);       /* LOCATE SUPED SYSMOD           */ 03164000
         ST    @08,@AL00001                                        0990 03165000
         L     @15,@CV01863                                        0990 03166000
         LA    @01,@AL00001                                        0990 03167000
         BALR  @14,@15                                             0990 03168000
*     IF IOPRETRN=IOPGOOD           /* IF FOUND                      */ 03169000
*       THEN                        /*                               */ 03170000
         L     @08,IOPPTR                                          0991 03171000
         CLI   IOPRETRN(@08),0                                     0991 03172000
         BNE   @RF00991                                            0991 03173000
*       DO;                         /*                               */ 03174000
*         IF IOPSBYNO=ICTPTFS(1)    /* IF THIS WAS LAST SUP          */ 03175000
*           THEN                    /*                               */ 03176000
         CLC   IOPSBYNO(7,@08),ICTPTFS(P8PTR)                      0993 03177000
         BNE   @RF00993                                            0993 03178000
*           DO;                     /*                               */ 03179000
*             IOPSBYNO='';          /* BLANK IT OUT                  */ 03180000
         MVI   IOPSBYNO(@08),C' '                                  0995 03181000
         MVC   IOPSBYNO+1(6,@08),IOPSBYNO(@08)                     0995 03182000
*             SUPFND=ON;            /* NEED TO UPDATE RCD            */ 03183000
         OI    SUPFND,B'10000000'                                  0996 03184000
*           END;                    /*                               */ 03185000
*         ELSE                      /* NOT MATCH IN LAST SUP         */ 03186000
*           DO;                     /*                               */ 03187000
         B     @RC00993                                            0998 03188000
@RF00993 DS    0H                                                  0999 03189000
*             DO SUPDLX=1 BY 1 WHILE(/* LOOP THRU ITS SUBNTS         */ 03190000
*                   IOPPTFND(SUPDLX)^=IOPEOLST/* TILL END            */ 03191000
*                   &IOPSBYNM(SUPDLX)^=ICTPTFS(1));/* OR MATCH       */ 03192000
         LA    SUPDLX,1                                            0999 03193000
         B     @DE00999                                            0999 03194000
@DL00999 DS    0H                                                  1000 03195000
*             END;                  /*                               */ 03196000
         AH    SUPDLX,@CH00037                                     1000 03197000
@DE00999 L     @08,IOPPTR                                          1000 03198000
         LR    @15,SUPDLX                                          1000 03199000
         MH    @15,@CH00035                                        1000 03200000
         SLR   @14,@14                                             1000 03201000
         IC    @14,IOPPTFND-9(@15,@08)                             1000 03202000
         CH    @14,@CH00628                                        1000 03203000
         BE    @DC00999                                            1000 03204000
         ALR   @08,@15                                             1000 03205000
         CLC   IOPSBYNM-9(7,@08),ICTPTFS(P8PTR)                    1000 03206000
         BNE   @DL00999                                            1000 03207000
@DC00999 DS    0H                                                  1001 03208000
*             IF IOPSBYNM(SUPDLX)=ICTPTFS(1)/* IF MATCH              */ 03209000
*               THEN                /*                               */ 03210000
         LR    @08,SUPDLX                                          1001 03211000
         MH    @08,@CH00035                                        1001 03212000
         L     @01,IOPPTR                                          1001 03213000
         ALR   @01,@08                                             1001 03214000
         CLC   IOPSBYNM-9(7,@01),ICTPTFS(P8PTR)                    1001 03215000
         BNE   @RF01001                                            1001 03216000
*               DO;                 /*                               */ 03217000
*                 SUPFND=ON;        /*                               */ 03218000
         OI    SUPFND,B'10000000'                                  1003 03219000
*                 DO UNTIL(         /* MOVE REST OF                  */ 03220000
*                       IOPPTFND(SUPDLX)=IOPEOLST);/* ENTRIES        */ 03221000
@DL01004 DS    0H                                                  1005 03222000
*                   IOPPNTRY(SUPDLX)=IOPPNTRY(SUPDLX+1);/*           */ 03223000
         L     @08,IOPPTR                                          1005 03224000
         LR    @15,SUPDLX                                          1005 03225000
         MH    @15,@CH00035                                        1005 03226000
         ST    @15,@TF00001                                        1005 03227000
         ALR   @15,@08                                             1005 03228000
         AL    @08,@TF00001                                        1005 03229000
         MVC   IOPPNTRY-9(9,@15),IOPPNTRY(@08)                     1005 03230000
*                   SUPDLX=SUPDLX+1;/*                               */ 03231000
         AH    SUPDLX,@CH00037                                     1006 03232000
*                 END;              /* END MOVE LOOP                 */ 03233000
@DE01004 LR    @08,SUPDLX                                          1007 03234000
         MH    @08,@CH00035                                        1007 03235000
         L     @01,IOPPTR                                          1007 03236000
         SLR   @00,@00                                             1007 03237000
         IC    @00,IOPPTFND-9(@08,@01)                             1007 03238000
         CH    @00,@CH00628                                        1007 03239000
         BNE   @DL01004                                            1007 03240000
*               END;                /* END MATCH FOUND               */ 03241000
*           END;                    /* END NOT MATCH IN LAST SUP     */ 03242000
@RF01001 DS    0H                                                  1010 03243000
*         IF SUPFND=ON              /* IF CHANGE MADE                */ 03244000
*           THEN                    /*                               */ 03245000
@RC00993 TM    SUPFND,B'10000000'                                  1010 03246000
         BNO   @RF01010                                            1010 03247000
*           DO;                     /*                               */ 03248000
*             IOPSBYP=OFF;          /* ASSUME NOT SUPED              */ 03249000
         L     @08,IOPPTR                                          1012 03250000
         NI    IOPSBYP(@08),B'01111111'                            1012 03251000
*             IF IOPSBYNO(1)=BLANK  /* IF NO LAST SUP                */ 03252000
*               THEN                /*                               */ 03253000
         CLI   IOPSBYNO(@08),C' '                                  1013 03254000
         BNE   @RF01013                                            1013 03255000
*               DO;                 /*                               */ 03256000
*                 DO SUPDLX=1 BY 1 WHILE(/* SEE IF ANY SUPBY         */ 03257000
*                       IOPPTFND(SUPDLX)^=IOPEOLST/* LEFT IN         */ 03258000
*                       &IOPPIND(SUPDLX)^=IOPPSBY);/* SYSMOD         */ 03259000
         LA    SUPDLX,1                                            1015 03260000
         B     @DE01015                                            1015 03261000
@DL01015 DS    0H                                                  1016 03262000
*                 END;              /*                               */ 03263000
         AH    SUPDLX,@CH00037                                     1016 03264000
@DE01015 L     @08,IOPPTR                                          1016 03265000
         LR    @15,SUPDLX                                          1016 03266000
         MH    @15,@CH00035                                        1016 03267000
         SLR   @14,@14                                             1016 03268000
         IC    @14,IOPPTFND-9(@15,@08)                             1016 03269000
         CH    @14,@CH00628                                        1016 03270000
         BE    @DC01015                                            1016 03271000
         SLR   @14,@14                                             1016 03272000
         IC    @14,IOPPIND-9(@15,@08)                              1016 03273000
         CH    @14,@CH01072                                        1016 03274000
         BNE   @DL01015                                            1016 03275000
@DC01015 DS    0H                                                  1017 03276000
*                 IF IOPPTFND(SUPDLX)^=IOPEOLST/* IF FOUND           */ 03277000
*                   THEN            /*                               */ 03278000
         L     @08,IOPPTR                                          1017 03279000
         LR    @15,SUPDLX                                          1017 03280000
         MH    @15,@CH00035                                        1017 03281000
         SLR   @14,@14                                             1017 03282000
         IC    @14,IOPPTFND-9(@15,@08)                             1017 03283000
         CH    @14,@CH00628                                        1017 03284000
         BE    @RF01017                                            1017 03285000
*                   IOPSBYP=ON;     /* SET SYSMOD SUPED              */ 03286000
         OI    IOPSBYP(@08),B'10000000'                            1018 03287000
*               END;                /*                               */ 03288000
*             ELSE                  /* IF LASTSUP PRESENT            */ 03289000
*               IOPSBYP=ON;         /* SET SYSMOD SUPED              */ 03290000
         B     @RC01013                                            1020 03291000
@RF01013 L     @08,IOPPTR                                          1020 03292000
         OI    IOPSBYP(@08),B'10000000'                            1020 03293000
*             IOPFUNCT=IOPSTOWR;    /* UPDATE SUPED SYSMOD           */ 03294000
@RC01013 L     @08,IOPPTR                                          1021 03295000
         MVI   IOPFUNCT(@08),X'54'                                 1021 03296000
*             IF IOPPTFND(1)=IOPEOLST/* IF NO SUBENTRIES             */ 03297000
*               THEN                /*                               */ 03298000
         CLI   IOPPTFND(@08),255                                   1022 03299000
         BNE   @RF01022                                            1022 03300000
*               DO;                 /*                               */ 03301000
*                 IOPDUMMP=ON;      /* THEN THIS IS DUMMY SYSMOD     */ 03302000
         OI    IOPDUMMP(@08),B'00000100'                           1024 03303000
*                 IF IOPDBYP=OFF    /* IF NO DELETE ENTRY            */ 03304000
*                     &IOPSBYP=OFF  /* OR SUPED                      */ 03305000
*                   THEN            /* THEN SHOULD                   */ 03306000
         TM    IOPDBYP(@08),B'11000000'                            1025 03307000
         BNZ   @RF01025                                            1025 03308000
*                   IOPFUNCT=IOPSTOWD;/* DELETE THIS GUY             */ 03309000
         MVI   IOPFUNCT(@08),X'53'                                 1026 03310000
*               END;                /*                               */ 03311000
@RF01025 DS    0H                                                  1028 03312000
*             CALL HMASMIO(HMASMIOP);/* STOW DEL/REP SYSMOD          */ 03313000
@RF01022 L     @08,IOPPTR                                          1028 03314000
         ST    @08,@AL00001                                        1028 03315000
         L     @15,@CV01863                                        1028 03316000
         LA    @01,@AL00001                                        1028 03317000
         BALR  @14,@15                                             1028 03318000
*             SUPDLRC=MAX(SUPDLRC,IOPRETRN);/*                       */ 03319000
         L     @08,IOPPTR                                          1029 03320000
         SLR   @02,@02                                             1029 03321000
         IC    @02,IOPRETRN(,@08)                                  1029 03322000
         CR    SUPDLRC,@02                                         1029 03323000
         BNL   *+6                                                      03324000
         LR    SUPDLRC,@02                                         1029 03325000
*           END;                    /* END CHANGE MADE TO SUPED SMD  */ 03326000
*       END;                        /* END SUP FOUND                 */ 03327000
*     ELSE                          /*                               */ 03328000
*       IF IOPRETRN>IOPNTFND        /* IF ERR IN LOCATE              */ 03329000
*         THEN                      /*                               */ 03330000
         B     @RC00991                                            1032 03331000
@RF00991 L     @08,IOPPTR                                          1032 03332000
         CLI   IOPRETRN(@08),4                                     1032 03333000
         BNH   @RF01032                                            1032 03334000
*         SUPDLRC=MAX(SUPDLRC,IOPRETRN);/* SAVE RC                   */ 03335000
         SLR   @02,@02                                             1033 03336000
         IC    @02,IOPRETRN(,@08)                                  1033 03337000
         CR    SUPDLRC,@02                                         1033 03338000
         BNL   *+6                                                      03339000
         LR    SUPDLRC,@02                                         1033 03340000
*   END;                            /* END LOOP THRU SUP LIST IN ICT */ 03341000
*                                                                  1034 03342000
@RF01032 DS    0H                                                  1034 03343000
@RC00991 AH    PXH,@CH00037                                        1034 03344000
@DE00986 CH    SUPDLRC,@CH00121                                    1034 03345000
         BNL   @DC00986                                            1034 03346000
         LR    @08,PXH                                             1034 03347000
         SLA   @08,3                                               1034 03348000
         L     @02,ICTPSCHN(,P8PTR)                                1034 03349000
         AL    @02,@CF02215                                        1034 03350000
         L     @08,ICTSUPND(@08,@02)                               1034 03351000
         CL    @08,ICTENDNT                                        1034 03352000
         BNE   @DL00986                                            1034 03353000
@DC00986 DS    0H                                                  1035 03354000
*   /*****************************************************************/ 03355000
*   /*                                                               */ 03356000
*   /* RETURN TO CALLER WITH RETURN CODE SET UP DURING PROCESS       */ 03357000
*   /*                                                               */ 03358000
*   /*****************************************************************/ 03359000
*                                                                  1035 03360000
*   RETURN CODE(SUPDLRC);           /*                               */ 03361000
         LR    @15,SUPDLRC                                         1035 03362000
         L     @14,@SA00012                                        1035 03363000
         LM    @00,@12,@SA00012+8                                  1035 03364000
         BR    @14                                                 1035 03365000
*   END CPLSUPDL;                   /*                               */ 03366000
*   END SMDOK1;                     /*                               */ 03367000
         EJECT                                                          03368000
*                                                                  1038 03369000
*   /*****************************************************************/ 03370000
*   /*                                                               */ 03371000
*   /* ROUTINE CALLED TO DETERMINE WHETHER AN LMOD IS COMPLETE. A    */ 03372000
*   /* LMOD IS COMPLETE ONLY WHEN ALL OF ITS ASSOCIATED MODULES ARE  */ 03373000
*   /* COMPLETE                                                      */ 03374000
*   /*                                                               */ 03375000
*   /*****************************************************************/ 03376000
*                                                                  1038 03377000
*LMDCK1:                            /*                               */ 03378000
*   PROCEDURE;                      /*                               */ 03379000
LMDCK1   STM   @14,@12,12(@13)                                     1038 03380000
*   DECLARE                         /*                               */ 03381000
*     L6PTR PTR(31),                /* PTR FOR ICT LMOD LOOP         */ 03382000
*     LX6 FIXED(31);                /* INDEX THRU LMOD TO MOD INDEX  */ 03383000
*   RFY                                                            1040 03384000
*     ICTLMOD BASED(L6PTR);         /* LMODS BASED ON ADDR OF LMODS  */ 03385000
*   RFY                                                            1041 03386000
*     ICTIXLF BASED(ICTLCHN(1));    /* LMOD TO MOD LIST BASED ON LMOD*/ 03387000
*   RFY                                                            1042 03388000
*     ICTMOD BASED(ICTIXL(LX6));    /* MOD BASED ON LMOD TO MOD PTR  */ 03389000
*   DO L6PTR=CCAICLMD BY LENGTH(ICTLMOD(1)) WHILE(/* LMOD LOOP       */ 03390000
*         ICTLEND(1)^=ICTENDNT);    /* TILL END                      */ 03391000
         L     L6PTR,CCAICLMD(,CCAPTR)                             1043 03392000
         B     @DE01043                                            1043 03393000
@DL01043 DS    0H                                                  1044 03394000
*     IF ICTLCPL(1)=OFF             /* IF LMOD NOT ALREADY COMPLETE  */ 03395000
*       THEN                        /* THEN SEE IF COMPLETED         */ 03396000
         TM    ICTLCPL(L6PTR),B'00100000'                          1044 03397000
         BNZ   @RF01044                                            1044 03398000
*       DO;                         /* NOW                           */ 03399000
*         ICTLCPL(1)=ON;            /* ASSUME ALL MODS FOR LMOD CPLT */ 03400000
         OI    ICTLCPL(L6PTR),B'00100000'                          1046 03401000
*         DO LX6=1 BY 1 WHILE(      /* LOOP THRI LMOD TO MOD INDEX   */ 03402000
*               ICTIXL(LX6)^=ICTENDIX);/* TILL END                   */ 03403000
         LA    LX6,1                                               1047 03404000
         B     @DE01047                                            1047 03405000
@DL01047 DS    0H                                                  1048 03406000
*           IF ICTMCPL(1)=OFF       /* IF ANY MOD IS NOT COMPLETE    */ 03407000
*             THEN                  /* THEN                          */ 03408000
         LR    @08,LX6                                             1048 03409000
         SLA   @08,2                                               1048 03410000
         L     @01,ICTLCHN(,L6PTR)                                 1048 03411000
         AL    @01,@CF02213                                        1048 03412000
         L     @08,ICTIXL(@08,@01)                                 1048 03413000
         TM    ICTMCPL(@08),B'00100000'                            1048 03414000
         BNZ   @RF01048                                            1048 03415000
*             ICTLCPL(1)=OFF;       /* LMOD IS NOT COMPLETE YET      */ 03416000
         NI    ICTLCPL(L6PTR),B'11011111'                          1049 03417000
*         END;                      /* END LOOP THRU LMOD TO MOD     */ 03418000
@RF01048 AH    LX6,@CH00037                                        1050 03419000
@DE01047 LR    @08,LX6                                             1050 03420000
         SLA   @08,2                                               1050 03421000
         L     @01,ICTLCHN(,L6PTR)                                 1050 03422000
         AL    @01,@CF02213                                        1050 03423000
         L     @08,ICTIXL(@08,@01)                                 1050 03424000
         CL    @08,ICTENDIX                                        1050 03425000
         BNE   @DL01047                                            1050 03426000
*       END;                        /* END LMOD NOT COMPLETE YET     */ 03427000
*   END;                            /* END LOOP THRU LMODS           */ 03428000
@RF01044 AH    L6PTR,@CH01013                                      1052 03429000
@DE01043 CLC   ICTLEND(4,L6PTR),ICTENDNT                           1052 03430000
         BNE   @DL01043                                            1052 03431000
*   RETURN CODE(ZERO);              /*                               */ 03432000
         SLR   @15,@15                                             1053 03433000
         L     @14,12(,@13)                                        1053 03434000
         LM    @00,@12,20(@13)                                     1053 03435000
         BR    @14                                                 1053 03436000
*   END LMDCK1;                     /*                               */ 03437000
         EJECT                                                          03438000
*                                                                  1055 03439000
*   /*****************************************************************/ 03440000
*   /*                                                               */ 03441000
*   /* THIS ROUTINE GOES THRU ALL SECTIONS OF THE ICT AND TURNS OFF  */ 03442000
*   /* THE INPROCESS INDICATOR FOR ALL THOSE ELEMENTS MARKED AS AS   */ 03443000
*   /* COMPLETED                                                     */ 03444000
*   /*                                                               */ 03445000
*   /*****************************************************************/ 03446000
*                                                                  1055 03447000
*CPLRESET:                          /*                               */ 03448000
*   PROCEDURE;                      /*                               */ 03449000
CPLRESET STM   @14,@12,@SA00014                                    1055 03450000
*   DECLARE                         /*                               */ 03451000
*     P2PTR PTR(31),                /* PTR FOR ICT PTF LOOP          */ 03452000
*     M2PTR PTR(31),                /* PTR FOR ICT MOD LOOP          */ 03453000
*     L2PTR PTR(31);                /* PTR FOR ICT LMOD LOOP         */ 03454000
*   DECLARE                         /*                               */ 03455000
*     RESETRC FIXED(8);             /*                               */ 03456000
*   RFY                                                            1058 03457000
*     ICTPTF BASED(P2PTR);          /*                               */ 03458000
*   RFY                                                            1059 03459000
*     ICTMOD BASED(M2PTR);          /*                               */ 03460000
*   RFY                                                            1060 03461000
*     ICTLMOD BASED(L2PTR);         /*                               */ 03462000
*                                                                  1060 03463000
*   /*****************************************************************/ 03464000
*   /*                                                               */ 03465000
*   /* TURN OFF PTF IN PROCESS INDICATORS                            */ 03466000
*   /*                                                               */ 03467000
*   /*****************************************************************/ 03468000
*                                                                  1061 03469000
*   RESETRC=ZERO;                   /*                               */ 03470000
         SLR   RESETRC,RESETRC                                     1061 03471000
*   DO P2PTR=CCAICPTF BY LENGTH(ICTPTF(1)) WHILE(/* LOOP THRU PTFS   */ 03472000
*         ICTPEND(1)^=ICTENDNT);    /*                               */ 03473000
         L     P2PTR,CCAICPTF(,CCAPTR)                             1062 03474000
         B     @DE01062                                            1062 03475000
@DL01062 DS    0H                                                  1063 03476000
*     IF ICTPCPL(1)=ON              /* IF PTF COMPLETE THEN          */ 03477000
*       THEN                        /* NO LONGER                     */ 03478000
         TM    ICTPCPL(P2PTR),B'00100000'                          1063 03479000
         BNO   @RF01063                                            1063 03480000
*       ICTPPROC(1)=OFF;            /* IN PROCESS                    */ 03481000
         NI    ICTPPROC(P2PTR),B'01111111'                         1064 03482000
*     IF ICTPNOGO(1)=ON             /* IF PTF IS NOGO                */ 03483000
*         &ICTPTYPE(1)=IOPPFUNC     /* AND SYSMOD IS FUNCTION TYPE   */ 03484000
*       THEN                        /*                               */ 03485000
@RF01063 TM    ICTPNOGO(P2PTR),B'01000000'                         1065 03486000
         BNO   @RF01065                                            1065 03487000
         CLI   ICTPTYPE(P2PTR),4                                   1065 03488000
         BNE   @RF01065                                            1065 03489000
*       DO;                         /*                               */ 03490000
*         MGPCLEAR=''B;             /* ZERO MSG PARM                 */ 03491000
         XC    MGPCLEAR(6),MGPCLEAR                                1067 03492000
*         MGPMGNO1=HMA370I;         /* XXXXXXXX PROCESSING TERMINATED   03493000
*                                      BECAUSE FUNCTION SYSMOD     1068 03494000
*                                      XXXXXXX FAILED                */ 03495000
         MVC   MGPMGNO1(2),@CH01875                                1068 03496000
*         MGPVARPT(1)=ADDR(CCAFUNCT);/* FUNCTION NAME                */ 03497000
         LA    @08,CCAFUNCT(,CCAPTR)                               1069 03498000
         ST    @08,MGPVARPT                                        1069 03499000
*         MGPVARPT(2)=ADDR(ICTPTFS(1));/* SYSMOD NUMBER              */ 03500000
         ST    P2PTR,MGPVARPT+4                                    1070 03501000
*         MGPTYPE=MGPSEV;           /*                               */ 03502000
         MVI   MGPTYPE,X'04'                                       1071 03503000
*         CALL HMASMMSG(HMASMMGP);  /*                               */ 03504000
         L     @15,@CV01866                                        1072 03505000
         LA    @01,@AL01072                                        1072 03506000
         BALR  @14,@15                                             1072 03507000
*         RESETRC=STOPFUNC;         /* SET RETURN CODE               */ 03508000
         LA    RESETRC,12                                          1073 03509000
*       END;                        /*                               */ 03510000
*   END;                            /*                               */ 03511000
*                                                                  1075 03512000
@RF01065 AH    P2PTR,@CH02176                                      1075 03513000
@DE01062 CLC   ICTPEND(4,P2PTR),ICTENDNT                           1075 03514000
         BNE   @DL01062                                            1075 03515000
*   /*****************************************************************/ 03516000
*   /*                                                               */ 03517000
*   /* TURN OFF MOD IN PROCESS INDICATORS                            */ 03518000
*   /*                                                               */ 03519000
*   /*****************************************************************/ 03520000
*                                                                  1076 03521000
*   DO M2PTR=CCAICMOD BY LENGTH(ICTMOD(1)) WHILE(/* LOOP THRU MODS   */ 03522000
*         ICTMEND(1)^=ICTENDNT);    /*                               */ 03523000
         L     M2PTR,CCAICMOD(,CCAPTR)                             1076 03524000
         B     @DE01076                                            1076 03525000
@DL01076 DS    0H                                                  1077 03526000
*     ICTMPROC(1)=OFF;              /*                               */ 03527000
         NI    ICTMPROC(M2PTR),B'01111111'                         1077 03528000
*   END;                            /*                               */ 03529000
*                                                                  1078 03530000
         AH    M2PTR,@CH02175                                      1078 03531000
@DE01076 CLC   ICTMEND(4,M2PTR),ICTENDNT                           1078 03532000
         BNE   @DL01076                                            1078 03533000
*   /*****************************************************************/ 03534000
*   /*                                                               */ 03535000
*   /* TURN OFF LMD IN PROCESS INDICATORS                            */ 03536000
*   /*                                                               */ 03537000
*   /*****************************************************************/ 03538000
*                                                                  1079 03539000
*   DO L2PTR=CCAICLMD BY LENGTH(ICTLMOD(1)) WHILE(/* LOOP THRU LMODS */ 03540000
*         ICTLEND(1)^=ICTENDNT);    /*                               */ 03541000
         L     L2PTR,CCAICLMD(,CCAPTR)                             1079 03542000
         B     @DE01079                                            1079 03543000
@DL01079 DS    0H                                                  1080 03544000
*     ICTLPROC(1)=OFF;              /*                               */ 03545000
         NI    ICTLPROC(L2PTR),B'01111111'                         1080 03546000
*   END;                            /*                               */ 03547000
*                                                                  1081 03548000
         AH    L2PTR,@CH01013                                      1081 03549000
@DE01079 CLC   ICTLEND(4,L2PTR),ICTENDNT                           1081 03550000
         BNE   @DL01079                                            1081 03551000
*   /*****************************************************************/ 03552000
*   /*                                                               */ 03553000
*   /* RETURN TO CALLER                                              */ 03554000
*   /*                                                               */ 03555000
*   /*****************************************************************/ 03556000
*                                                                  1082 03557000
*   RETURN CODE(RESETRC);           /*                               */ 03558000
         LR    @15,RESETRC                                         1082 03559000
         L     @14,@SA00014                                        1082 03560000
         LM    @00,@12,@SA00014+8                                  1082 03561000
         BR    @14                                                 1082 03562000
*   END CPLRESET;                   /*                               */ 03563000
         EJECT                                                          03564000
*                                                                  1084 03565000
*   /*****************************************************************/ 03566000
*   /*                                                               */ 03567000
*   /* LOOP THRU PTF SECTION OF ICT AND FOR EACH PTF MARKED AS BEING */ 03568000
*   /* IN PROCESS AND NOGO THEN MARK ALL MODS FOR THAT PTF AS IN     */ 03569000
*   /* PROCESS AND NOGO                                              */ 03570000
*   /*                                                               */ 03571000
*   /*****************************************************************/ 03572000
*                                                                  1084 03573000
*CPLMODNG:                          /*                               */ 03574000
*   PROCEDURE;                      /*                               */ 03575000
CPLMODNG STM   @14,@12,12(@13)                                     1084 03576000
*   DECLARE                         /*                               */ 03577000
*     P1PTR PTR(31),                /* PTR FOR ICT PTF LOOP          */ 03578000
*     PX1 FIXED(31);                /* INDEX THRU PTF INDEX          */ 03579000
*   RFY                                                            1086 03580000
*     ICTPTF BASED(P1PTR);          /* BASE FOR PTFS                 */ 03581000
*   RFY                                                            1087 03582000
*     ICTIXPF BASED(ICTPCHN(1));    /* BASE FOR PTF TO MOD INDEX     */ 03583000
*   RFY                                                            1088 03584000
*     ICTMOD BASED(ICTIXP(PX1));    /* MOD BASED ON PTF TO MOD LIST  */ 03585000
*   DO P1PTR=CCAICPTF BY LENGTH(ICTPTF(1)) WHILE(/* LOOP THRU PTFS   */ 03586000
*         ICTPEND(1)^=ICTENDNT);    /* TILL END                      */ 03587000
         L     P1PTR,CCAICPTF(,CCAPTR)                             1089 03588000
         B     @DE01089                                            1089 03589000
@DL01089 DS    0H                                                  1090 03590000
*     IF ICTPGCPL(1)=ON             /*                               */ 03591000
*       THEN                        /*                               */ 03592000
         TM    ICTPGCPL(P1PTR),B'10000000'                         1090 03593000
         BNO   @RF01090                                            1090 03594000
*       ICTPCPL(1)=ON;              /*                               */ 03595000
         OI    ICTPCPL(P1PTR),B'00100000'                          1091 03596000
*     ICTPECPL(1)=ON;               /* ASSUME ALL MOD FOR PTF CMPLT  */ 03597000
@RF01090 OI    ICTPECPL(P1PTR),B'01000000'                         1092 03598000
*     DO PX1=1 BY 1 WHILE(          /* LOOP THRU PTF TO MOD INDEX    */ 03599000
*           ICTIXP(PX1)^=ICTENDIX); /* TILL END                      */ 03600000
         LA    PX1,1                                               1093 03601000
         B     @DE01093                                            1093 03602000
@DL01093 DS    0H                                                  1094 03603000
*       IF ICTPNOGO(1)=ON           /* IF PTF NOGO                   */ 03604000
*         THEN                      /* THEN                          */ 03605000
         TM    ICTPNOGO(P1PTR),B'01000000'                         1094 03606000
         BNO   @RF01094                                            1094 03607000
*         DO;                       /*                               */ 03608000
*           ICTPCPL(1)=ON;          /*                               */ 03609000
         OI    ICTPCPL(P1PTR),B'00100000'                          1096 03610000
*           ICTMNOGO(1)=ON;         /* MOD NOGO                      */ 03611000
*           ICTMPROC(1)=ON;         /* MOD CONSIDERED IN PROCESS     */ 03612000
*           ICTMCPL(1)=ON;          /* MOD COMPLETE                  */ 03613000
         LR    @08,PX1                                             1099 03614000
         SLA   @08,2                                               1099 03615000
         L     @01,ICTPCHN(,P1PTR)                                 1099 03616000
         AL    @01,@CF02213                                        1099 03617000
         L     @08,ICTIXP(@08,@01)                                 1099 03618000
         OI    ICTMNOGO(@08),B'11100000'                           1099 03619000
*         END;                      /*                               */ 03620000
*       ELSE                        /*                               */ 03621000
*         IF ICTMCPL(1)=OFF         /* IF ANY MOD FOR PTF NOT        */ 03622000
*             &ICTMSELM(1)=OFF      /* AND ELEMENT NOT ELIMINATED    */ 03623000
*           THEN                    /* COMPLETE THEN PTF ALSO        */ 03624000
         B     @RC01094                                            1101 03625000
@RF01094 LR    @08,PX1                                             1101 03626000
         SLA   @08,2                                               1101 03627000
         L     @01,ICTPCHN(,P1PTR)                                 1101 03628000
         AL    @01,@CF02213                                        1101 03629000
         L     @08,ICTIXP(@08,@01)                                 1101 03630000
         TM    ICTMCPL(@08),B'00100000'                            1101 03631000
         BNZ   @RF01101                                            1101 03632000
         TM    ICTMSELM(@08),B'00100000'                           1101 03633000
         BNZ   @RF01101                                            1101 03634000
*           ICTPECPL(1)=OFF;        /* NOT COMPLETE                  */ 03635000
         NI    ICTPECPL(P1PTR),B'10111111'                         1102 03636000
*     END;                          /* END PTF TO MOD INDEX LOOP     */ 03637000
@RF01101 DS    0H                                                  1103 03638000
@RC01094 AH    PX1,@CH00037                                        1103 03639000
@DE01093 LR    @08,PX1                                             1103 03640000
         SLA   @08,2                                               1103 03641000
         L     @01,ICTPCHN(,P1PTR)                                 1103 03642000
         AL    @01,@CF02213                                        1103 03643000
         L     @08,ICTIXP(@08,@01)                                 1103 03644000
         CL    @08,ICTENDIX                                        1103 03645000
         BNE   @DL01093                                            1103 03646000
*   END;                            /* END LOOP THRU ICT PTFS        */ 03647000
         AH    P1PTR,@CH02176                                      1104 03648000
@DE01089 CLC   ICTPEND(4,P1PTR),ICTENDNT                           1104 03649000
         BNE   @DL01089                                            1104 03650000
*   RETURN CODE(ZERO);              /*                               */ 03651000
         SLR   @15,@15                                             1105 03652000
         L     @14,12(,@13)                                        1105 03653000
         LM    @00,@12,20(@13)                                     1105 03654000
         BR    @14                                                 1105 03655000
*   END CPLMODNG;                   /*                               */ 03656000
         EJECT                                                          03657000
*                                                                  1107 03658000
*/********************************************************************/ 03659000
*/*                                                                  */ 03660000
*/*       FIND ALL ELEMENTS THAT ARE RELATED TO THE CURRENT          */ 03661000
*/*       ELEMENT AND MARK THEM IN PROCESS, COMPLETE, AND IF         */ 03662000
*/*       REQUIRED, NOGO.                                            */ 03663000
*/*                                                                  */ 03664000
*/*       THE FOLLOWING DIAGRAM DESCRIBES LOGIC.                     */ 03665000
*/*       A INDICATES 'AND' CONDITION.                               */ 03666000
*/*       O INDICATES 'OR'  CONDITION.                               */ 03667000
*/*                                                                  */ 03668000
*/*     NAME 1 MATCHES NAME 2 -------|                               */ 03669000
*/*                                  A -----|                        */ 03670000
*/*     TYPE 1 MATCHES TYPE 2 -------|      |                        */ 03671000
*/*                                         |                        */ 03672000
*/*                                         |                        */ 03673000
*/*     NAME 1 MATCHES NAME 2 -------|      |                        */ 03674000
*/*                                  |      |                        */ 03675000
*/*     TYPE 1 MODULE REPLACEMENT ---|      |                        */ 03676000
*/*                                  A ---- |                        */ 03677000
*/*     TYPE 2 IS ZAP ------|        |      |                        */ 03678000
*/*                         O -------|      O -- POST ELEMENT 2      */ 03679000
*/*     TYPE 2 IS EXPAND ---|               |                        */ 03680000
*/*                                         |                        */ 03681000
*/*                                         |                        */ 03682000
*/*     TYPE 1 MACRO REPLACEMENT ----|      |                        */ 03683000
*/*                                  A -----|                        */ 03684000
*/*     TYPE 2 MACRO UPDATE ---------|      |                        */ 03685000
*/*                                         |                        */ 03686000
*/*     TYPE 1 SOURCE REPLACEMENT ---|      |                        */ 03687000
*/*                                  A -----|                        */ 03688000
*/*     TYPE 2 SOURCE UPDATE --------|                               */ 03689000
*/*                                                                  */ 03690000
*/********************************************************************/ 03691000
*                                                                  1107 03692000
*CPLRELEM:                                                         1107 03693000
*   PROCEDURE(RELEMNG);             /*                               */ 03694000
CPLRELEM STM   @14,@12,@SA00016                                    1107 03695000
         MVC   @PC00016(4),0(@01)                                  1107 03696000
*   DECLARE                         /*                               */ 03697000
*     RELEMNG CHAR(1);              /*                               */ 03698000
*   DECLARE                         /*                               */ 03699000
*     1 RELEMSW BIT(8),             /*                               */ 03700000
*       3 RELSTOP BIT(1),           /*                               */ 03701000
*       3 RELTYPE BIT(1),           /* USED IN RELEM CHECK           */ 03702000
*       3 RELFND BIT(1),            /* USED IN RELEM CHECK           */ 03703000
*       3 * BIT(5);                 /*                               */ 03704000
*   DECLARE                         /*                               */ 03705000
*     M4PTR PTR(31),                /* PTR FOR ICT MOD LOOP          */ 03706000
*     M5PTR PTR(31);                /* PTR FOR ICT MOD LOOP          */ 03707000
*   RFY                             /*                               */ 03708000
*     ICTMOD BASED(M4PTR);          /* BASE FOR ICT MODS             */ 03709000
*   RFY                                                            1112 03710000
*     ICTPTF BASED(M5PTR->ICTPPTR(1));/* PTF BASED ON SECONDARY MOD  */ 03711000
*   RELEMSW=''B;                    /*                               */ 03712000
         MVI   RELEMSW,X'00'                                       1113 03713000
*   DO M4PTR=CCAICMOD BY LENGTH(ICTMOD(1)) WHILE(/* LOOP THRU MODS   */ 03714000
*         ICTMEND(1)^=ICTENDNT);    /* NOGO ELEMENTS                 */ 03715000
         L     M4PTR,CCAICMOD(,CCAPTR)                             1114 03716000
         B     @DE01114                                            1114 03717000
@DL01114 DS    0H                                                  1115 03718000
*     IF ICTMISEL(1)=ON             /* IF ELEMENT IS SELECTED AND    */ 03719000
*         &ICTMNORL(1)=OFF          /* AND RELATED ELEM PRESENT      */ 03720000
*         &(ICTMPROC(1)=ON          /* ELEMENT WAS PROCESSED         */ 03721000
*         |ICTMCPL(1)=ON            /* OR COMPLETED                  */ 03722000
*         |ICTMNOGO(1)=ON)          /* OR NOGO                       */ 03723000
*       THEN                        /*                               */ 03724000
         TM    ICTMISEL(M4PTR),B'10000000'                         1115 03725000
         BNO   @RF01115                                            1115 03726000
         TM    ICTMNORL(M4PTR),B'00010000'                         1115 03727000
         BNZ   @RF01115                                            1115 03728000
         TM    ICTMPROC(M4PTR),B'11100000'                         1115 03729000
         BZ    @RF01115                                            1115 03730000
*       DO;                         /* HAVE RELATED ELEMENTS MARKED  */ 03731000
*         RELFND=OFF;               /* NO RELATED TYPE FOUND         */ 03732000
         NI    RELFND,B'11011111'                                  1117 03733000
*         DO M5PTR=CCAICMOD BY LENGTH(ICTMOD(1)) WHILE(/* LOOP       */ 03734000
*               M5PTR->ICTMEND(1)^=ICTENDNT);/* ICT MODS FOR REL.EL. */ 03735000
*                                                                  1118 03736000
         L     M5PTR,CCAICMOD(,CCAPTR)                             1118 03737000
         B     @DE01118                                            1118 03738000
@DL01118 DS    0H                                                  1119 03739000
*           /*********************************************************/ 03740000
*           /*                                                       */ 03741000
*           /* CHECK TO SEE IF THE PRIMARY ELEMENT IS EQUAL TO THE   */ 03742000
*           /* SECONDARY ELEMENT AND SECONDARY ELEMENT NOT ACTUALLY  */ 03743000
*           /* SAME AS FIRST ELEMENT AND SECONDARY NOT PROC          */ 03744000
*           /*                                                       */ 03745000
*           /*********************************************************/ 03746000
*                                                                  1119 03747000
*           IF ICTMNAME(1)=M5PTR->ICTMNAME(1)/* IF SAME NAME         */ 03748000
*               &M5PTR->ICTMNOGO(1)=OFF/* AND SECOND NOT ALRDY. NOGO */ 03749000
*               &M4PTR^=M5PTR       /* AND THIS IS NOT CURRENT MOD   */ 03750000
*             THEN                  /*                               */ 03751000
         CLC   ICTMNAME(8,M4PTR),ICTMNAME(M5PTR)                   1119 03752000
         BNE   @RF01119                                            1119 03753000
         TM    ICTMNOGO(M5PTR),B'01000000'                         1119 03754000
         BNZ   @RF01119                                            1119 03755000
         CR    M4PTR,M5PTR                                         1119 03756000
         BE    @RF01119                                            1119 03757000
*             DO;                   /* CHECK IF RELATED.             */ 03758000
*                                                                  1120 03759000
*               /*****************************************************/ 03760000
*               /*                                                   */ 03761000
*               /* CHECK TO SEE IF ELEMENTS ARE RELATED (IE THEY ARE */ 03762000
*               /* OF THE SAME TYPE                                  */ 03763000
*               /*                                                   */ 03764000
*               /*****************************************************/ 03765000
*                                                                  1121 03766000
*               IF(ICTMMOD(1)=ON&M5PTR->ICTMMOD(1)=ON)/* IF SAME     */ 03767000
*                   |(ICTMASM(1)=ON&M5PTR->ICTMASM(1)=ON)/* TYPE     */ 03768000
*                   |(ICTMZAP(1)=ON&M5PTR->ICTMZAP(1)=ON)/*          */ 03769000
*                 THEN              /*                               */ 03770000
         TM    ICTMMOD(M4PTR),B'10000000'                          1121 03771000
         BNO   @GL00094                                            1121 03772000
         TM    ICTMMOD(M5PTR),B'10000000'                          1121 03773000
         BO    @RT01121                                            1121 03774000
@GL00094 TM    ICTMASM(M4PTR),B'01000000'                          1121 03775000
         BNO   @GL00093                                            1121 03776000
         TM    ICTMASM(M5PTR),B'01000000'                          1121 03777000
         BO    @RT01121                                            1121 03778000
@GL00093 TM    ICTMZAP(M4PTR),B'00100000'                          1121 03779000
         BNO   @RF01121                                            1121 03780000
         TM    ICTMZAP(M5PTR),B'00100000'                          1121 03781000
         BNO   @RF01121                                            1121 03782000
@RT01121 DS    0H                                                  1122 03783000
*                 RELTYPE=ON;       /* THEN INDICATED RELATED        */ 03784000
         OI    RELTYPE,B'01000000'                                 1122 03785000
*               ELSE                /*                               */ 03786000
*                 IF(ICTMMACR(1)=ON&M5PTR->ICTMMACR(1)=ON)/*         */ 03787000
*                     |(ICTMMACU(1)=ON&M5PTR->ICTMMACU(1)=ON)/*      */ 03788000
*                     |(ICTMSRCR(1)=ON&M5PTR->ICTMSRCR(1)=ON)/*      */ 03789000
*                     |(ICTMSRCU(1)=ON&M5PTR->ICTMSRCU(1)=ON)/*      */ 03790000
*                   THEN            /*                               */ 03791000
         B     @RC01121                                            1123 03792000
@RF01121 TM    ICTMMACR(M4PTR),B'00001000'                         1123 03793000
         BNO   @GL00100                                            1123 03794000
         TM    ICTMMACR(M5PTR),B'00001000'                         1123 03795000
         BO    @RT01123                                            1123 03796000
@GL00100 TM    ICTMMACU(M4PTR),B'00000100'                         1123 03797000
         BNO   @GL00099                                            1123 03798000
         TM    ICTMMACU(M5PTR),B'00000100'                         1123 03799000
         BO    @RT01123                                            1123 03800000
@GL00099 TM    ICTMSRCR(M4PTR),B'00000010'                         1123 03801000
         BNO   @GL00098                                            1123 03802000
         TM    ICTMSRCR(M5PTR),B'00000010'                         1123 03803000
         BO    @RT01123                                            1123 03804000
@GL00098 TM    ICTMSRCU(M4PTR),B'00000001'                         1123 03805000
         BNO   @RF01123                                            1123 03806000
         TM    ICTMSRCU(M5PTR),B'00000001'                         1123 03807000
         BNO   @RF01123                                            1123 03808000
@RT01123 DS    0H                                                  1124 03809000
*                   RELTYPE=ON;     /* THEN INDICATED RELATED        */ 03810000
         OI    RELTYPE,B'01000000'                                 1124 03811000
*                 ELSE              /* OR                            */ 03812000
*                   IF ICTMMOD(1)=ON/* IF FIRST IS MOD THAT          */ 03813000
*                       &ICTMNOGO(1)=ON/* IS NOGO                    */ 03814000
*                       &(M5PTR->ICTMZAP(1)=ON/* AND SECOND IS ZAP   */ 03815000
*                       |M5PTR->ICTMXPND(1)=ON)/* OR EXPAND ZAP      */ 03816000
*                     THEN          /*                               */ 03817000
         B     @RC01123                                            1125 03818000
@RF01123 TM    ICTMMOD(M4PTR),B'10000000'                          1125 03819000
         BNO   @RF01125                                            1125 03820000
         TM    ICTMNOGO(M4PTR),B'01000000'                         1125 03821000
         BNO   @RF01125                                            1125 03822000
         TM    ICTMZAP(M5PTR),B'00110000'                          1125 03823000
         BZ    @RF01125                                            1125 03824000
*                     RELTYPE=ON;   /* THEN INDICATED RELATED        */ 03825000
         OI    RELTYPE,B'01000000'                                 1126 03826000
*                   ELSE            /* OR                            */ 03827000
*                     IF ICTMMACR(1)=ON/* IF FIRST IS MAC            */ 03828000
*                         &ICTMNOGO(1)=ON/* IS NOGO                  */ 03829000
*                         &(M5PTR->ICTMMACR(1)=ON/* AND 2ND IS MAC   */ 03830000
*                         |M5PTR->ICTMMACU(1)=ON)/* OR MACUPD        */ 03831000
*                       THEN        /*                               */ 03832000
         B     @RC01125                                            1127 03833000
@RF01125 TM    ICTMMACR(M4PTR),B'00001000'                         1127 03834000
         BNO   @RF01127                                            1127 03835000
         TM    ICTMNOGO(M4PTR),B'01000000'                         1127 03836000
         BNO   @RF01127                                            1127 03837000
         TM    ICTMMACR(M5PTR),B'00001100'                         1127 03838000
         BZ    @RF01127                                            1127 03839000
*                       RELTYPE=ON; /* THEN INDICATED RELATED        */ 03840000
         OI    RELTYPE,B'01000000'                                 1128 03841000
*                     ELSE          /* OR                            */ 03842000
*                       IF ICTMSRCR(1)=ON/* IF FIRST IS SRC          */ 03843000
*                           &ICTMNOGO(1)=ON/* IS NOGO                */ 03844000
*                           &(M5PTR->ICTMSRCR(1)=ON/* AND 2ND IS SRC */ 03845000
*                           |M5PTR->ICTMSRCU(1)=ON)/* OR SRCUPD      */ 03846000
*                         THEN      /*                               */ 03847000
         B     @RC01127                                            1129 03848000
@RF01127 TM    ICTMSRCR(M4PTR),B'00000010'                         1129 03849000
         BNO   @RF01129                                            1129 03850000
         TM    ICTMNOGO(M4PTR),B'01000000'                         1129 03851000
         BNO   @RF01129                                            1129 03852000
         TM    ICTMSRCR(M5PTR),B'00000011'                         1129 03853000
         BZ    @RF01129                                            1129 03854000
*                         RELTYPE=ON;/* THEN INDICATED RELATED       */ 03855000
         OI    RELTYPE,B'01000000'                                 1130 03856000
*                       ELSE        /*                               */ 03857000
*                         RELTYPE=OFF;/* NOT RELATED TYPE ENTRIES    */ 03858000
*                                                                  1131 03859000
         B     @RC01129                                            1131 03860000
@RF01129 NI    RELTYPE,B'10111111'                                 1131 03861000
*               /*****************************************************/ 03862000
*               /*                                                   */ 03863000
*               /* IF ELEMENTS ARE RELATED TYPES AND SYSMOD FOR      */ 03864000
*               /* SECONDARY IS NOT NOGO OR COMPLETE THEN SET        */ 03865000
*               /* PROCESSING BITS FOR SECONDARY BASED ON STATUS OF  */ 03866000
*               /* BITS IN PRIMARY                                   */ 03867000
*               /*                                                   */ 03868000
*               /*****************************************************/ 03869000
*                                                                  1132 03870000
*               IF RELTYPE=ON       /* IF RELATED TYPE               */ 03871000
*                 THEN              /*                               */ 03872000
@RC01129 DS    0H                                                  1132 03873000
@RC01127 DS    0H                                                  1132 03874000
@RC01125 DS    0H                                                  1132 03875000
@RC01123 DS    0H                                                  1132 03876000
@RC01121 TM    RELTYPE,B'01000000'                                 1132 03877000
         BNO   @RF01132                                            1132 03878000
*                 DO;               /*                               */ 03879000
*                   RELFND=ON;      /* RELTYPE FOUND SW              */ 03880000
         OI    RELFND,B'00100000'                                  1134 03881000
*                   IF ICTPNOGO(1)=OFF/* IF SECONDARY SYSMOD NOT     */ 03882000
*                       &ICTPCPL(1)=OFF/* NOGO OR COMPLETE           */ 03883000
*                     THEN          /*                               */ 03884000
         L     @08,ICTPPTR(,M5PTR)                                 1135 03885000
         TM    ICTPNOGO(@08),B'01100000'                           1135 03886000
         BNZ   @RF01135                                            1135 03887000
*                     DO;           /*                               */ 03888000
*                       IF ICTMPROC(1)=ON/* IF PRIMARY IN PROCESS    */ 03889000
*                         THEN      /*                               */ 03890000
         TM    ICTMPROC(M4PTR),B'10000000'                         1137 03891000
         BNO   @RF01137                                            1137 03892000
*                         DO;       /*                               */ 03893000
*                           M5PTR->ICTMPROC(1)=ON;/* SECOND IN PROC  */ 03894000
         OI    ICTMPROC(M5PTR),B'10000000'                         1139 03895000
*                           ICTPPROC(1)=ON;/* PTF FOR SECOND MOD IN     03896000
*                                      PROCESS                       */ 03897000
         L     @08,ICTPPTR(,M5PTR)                                 1140 03898000
         OI    ICTPPROC(@08),B'10000000'                           1140 03899000
*                         END;      /*                               */ 03900000
*                       IF ICTMCPL(1)=ON/* IF PRIMARY COMPLETE       */ 03901000
*                         THEN      /* THEN                          */ 03902000
@RF01137 TM    ICTMCPL(M4PTR),B'00100000'                          1142 03903000
         BNO   @RF01142                                            1142 03904000
*                         M5PTR->ICTMCPL(1)=ON;/* SECOND COMPLETE    */ 03905000
         OI    ICTMCPL(M5PTR),B'00100000'                          1143 03906000
*                       IF ICTMNOGO(1)=ON/* IF PRIMARY NOGO          */ 03907000
*                         THEN      /* THEN SECONDARY IS ALSO        */ 03908000
@RF01142 TM    ICTMNOGO(M4PTR),B'01000000'                         1144 03909000
         BNO   @RF01144                                            1144 03910000
*                         DO;       /*                               */ 03911000
*                           M5PTR->ICTMNOGO(1)=ON;/* SECOND IS NOGO  */ 03912000
         OI    ICTMNOGO(M5PTR),B'01000000'                         1146 03913000
*                           ICTPNOGO(1)=ON;/* PTF FOR SECOND MOD NOGO*/ 03914000
*                           ICTPCPL(1)=ON;/* AND COMPLETE            */ 03915000
         L     @08,ICTPPTR(,M5PTR)                                 1148 03916000
         OI    ICTPNOGO(@08),B'01100000'                           1148 03917000
*                           IF ICTPMSG(1)=OFF/* IF NO MSG YET        */ 03918000
*                             THEN  /*                               */ 03919000
         TM    ICTPMSG(@08),B'00010000'                            1149 03920000
         BNZ   @RF01149                                            1149 03921000
*                             DO;   /*                               */ 03922000
*                               ICTPMSG(1)=ON;/*                     */ 03923000
         OI    ICTPMSG(@08),B'00010000'                            1151 03924000
*                               MGPCLEAR=''B;/*                      */ 03925000
         XC    MGPCLEAR(6),MGPCLEAR                                1152 03926000
*                               MGPMGNO1=HMA302I;/* X8X PROCESSING 1153 03927000
*                                      TERMINATED FOR SYSMOD X7X - 1153 03928000
*                                      REASON =                      */ 03929000
         MVC   MGPMGNO1(2),@CH01873                                1153 03930000
*                               MGPMGNO2=PART029;/* RELATED SYSMOD 1154 03931000
*                                      FAILED                        */ 03932000
         MVC   MGPMGNO2(2),@CH00478                                1154 03933000
*                               MGPVARPT(1)=ADDR(CCAFUNCT);/* FUNC   */ 03934000
         LA    @15,CCAFUNCT(,CCAPTR)                               1155 03935000
         ST    @15,MGPVARPT                                        1155 03936000
*                               MGPVARPT(2)=ADDR(ICTPTFS(1));      1156 03937000
         ST    @08,MGPVARPT+4                                      1156 03938000
*                               MGPTYPE=MGPERR;/*                    */ 03939000
         MVI   MGPTYPE,X'03'                                       1157 03940000
*                               CALL HMASMMSG(HMASMMGP);/*           */ 03941000
         L     @15,@CV01866                                        1158 03942000
         LA    @01,@AL01158                                        1158 03943000
         BALR  @14,@15                                             1158 03944000
*                               RELEMNG=YES;/* SET SYSMOD MRKD NOGO  */ 03945000
         L     @08,@PC00016                                        1159 03946000
         MVI   RELEMNG(@08),C'Y'                                   1159 03947000
*                             END;  /*                               */ 03948000
*                         END;      /*                               */ 03949000
@RF01149 DS    0H                                                  1162 03950000
*                     END;          /* END SECON NOT NOGO/CPL        */ 03951000
@RF01144 DS    0H                                                  1163 03952000
*                 END;              /* END ELEMENTS ARE RELATED      */ 03953000
@RF01135 DS    0H                                                  1164 03954000
*             END;                  /* END SAME NAME/NO NOGO YET     */ 03955000
@RF01132 DS    0H                                                  1165 03956000
*         END;                      /* END SECONDARY ICT MOD LOOP    */ 03957000
@RF01119 AH    M5PTR,@CH02175                                      1165 03958000
@DE01118 CLC   ICTMEND(4,M5PTR),ICTENDNT                           1165 03959000
         BNE   @DL01118                                            1165 03960000
*         IF RELFND=OFF             /* IF NO RELATED ELEMENTS        */ 03961000
*           THEN                    /* SET BIT IN ICT SO THAT NO     */ 03962000
         TM    RELFND,B'00100000'                                  1166 03963000
         BNZ   @RF01166                                            1166 03964000
*           ICTMNORL(1)=ON;         /* MORE LOOP THRU HERE FOR MOD   */ 03965000
         OI    ICTMNORL(M4PTR),B'00010000'                         1167 03966000
*       END;                        /* END PRIMARY SELECTED/NOGO     */ 03967000
@RF01166 DS    0H                                                  1169 03968000
*   END;                            /* END PRIMARY ICT MOD LOOP      */ 03969000
*                                                                  1169 03970000
@RF01115 AH    M4PTR,@CH02175                                      1169 03971000
@DE01114 CLC   ICTMEND(4,M4PTR),ICTENDNT                           1169 03972000
         BNE   @DL01114                                            1169 03973000
*   /*****************************************************************/ 03974000
*   /*                                                               */ 03975000
*   /* NOW CHECK FOR ELEMENTS THAT WERE ELIMINATED AND DO NOT HAVE A */ 03976000
*   /* RELATED ELEMENT IN THE ICT. THESE ELEMENTS ARE NOW CONSIDERED */ 03977000
*   /* COMPLETED                                                     */ 03978000
*   /*                                                               */ 03979000
*   /*****************************************************************/ 03980000
*                                                                  1170 03981000
*   DO M4PTR=CCAICMOD BY LENGTH(ICTMOD(1)) WHILE(/* LOOP THRU MODS   */ 03982000
*         ICTMEND(1)^=ICTENDNT);    /* TILL END                      */ 03983000
         L     M4PTR,CCAICMOD(,CCAPTR)                             1170 03984000
         B     @DE01170                                            1170 03985000
@DL01170 DS    0H                                                  1171 03986000
*     IF ICTMISEL(1)=OFF            /* IF ELEMENT NOT SELECTED       */ 03987000
*         &ICTMELCK(1)=OFF          /* AND NOT CHECKED YET           */ 03988000
*       THEN                        /*                               */ 03989000
         TM    ICTMISEL(M4PTR),B'10000000'                         1171 03990000
         BNZ   @RF01171                                            1171 03991000
         TM    ICTMELCK(M4PTR),B'00100000'                         1171 03992000
         BNZ   @RF01171                                            1171 03993000
*       DO;                         /*                               */ 03994000
*         ICTMELCK(1)=ON;           /* ELEMENT CHECKED               */ 03995000
         OI    ICTMELCK(M4PTR),B'00100000'                         1173 03996000
*         RELSTOP=OFF;              /*                               */ 03997000
         NI    RELSTOP,B'01111111'                                 1174 03998000
*         DO M5PTR=CCAICMOD BY LENGTH(ICTMOD(1)) WHILE(/* LOOP       */ 03999000
*               M5PTR->ICTMEND(1)^=ICTENDNT/* TILL END               */ 04000000
*               &RELSTOP=OFF);      /* OR RELATED SELECTED ELEM FOUND*/ 04001000
         L     M5PTR,CCAICMOD(,CCAPTR)                             1175 04002000
         B     @DE01175                                            1175 04003000
@DL01175 DS    0H                                                  1176 04004000
*           IF ICTMNAME(1)=M5PTR->ICTMNAME(1)/* IF SAME ELEMENT      */ 04005000
*               &M5PTR->ICTMISEL(1)=ON/* AND THIS ONE SELECTED       */ 04006000
*             THEN                  /*                               */ 04007000
         CLC   ICTMNAME(8,M4PTR),ICTMNAME(M5PTR)                   1176 04008000
         BNE   @RF01176                                            1176 04009000
         TM    ICTMISEL(M5PTR),B'10000000'                         1176 04010000
         BNO   @RF01176                                            1176 04011000
*             DO;                   /*                               */ 04012000
*               IF(ICTMMOD(1)=ON&M5PTR->ICTMMOD(1)=ON)/* AND TYPE    */ 04013000
*                   |(ICTMASM(1)=ON&M5PTR->ICTMASM(1)=ON)/*          */ 04014000
*                   |(ICTMZAP(1)=ON&M5PTR->ICTMZAP(1)=ON)/*          */ 04015000
*                 THEN              /*                               */ 04016000
         TM    ICTMMOD(M4PTR),B'10000000'                          1178 04017000
         BNO   @GL00114                                            1178 04018000
         TM    ICTMMOD(M5PTR),B'10000000'                          1178 04019000
         BO    @RT01178                                            1178 04020000
@GL00114 TM    ICTMASM(M4PTR),B'01000000'                          1178 04021000
         BNO   @GL00113                                            1178 04022000
         TM    ICTMASM(M5PTR),B'01000000'                          1178 04023000
         BO    @RT01178                                            1178 04024000
@GL00113 TM    ICTMZAP(M4PTR),B'00100000'                          1178 04025000
         BNO   @RF01178                                            1178 04026000
         TM    ICTMZAP(M5PTR),B'00100000'                          1178 04027000
         BNO   @RF01178                                            1178 04028000
@RT01178 DS    0H                                                  1179 04029000
*                 RELSTOP=ON;       /* STOP LOOP                     */ 04030000
         OI    RELSTOP,B'10000000'                                 1179 04031000
*               ELSE                /*                               */ 04032000
*                 IF(ICTMMACR(1)=ON&M5PTR->ICTMMACR(1)=ON)/*         */ 04033000
*                     |(ICTMMACU(1)=ON&M5PTR->ICTMMACU(1)=ON)/*      */ 04034000
*                     |(ICTMSRCR(1)=ON&M5PTR->ICTMSRCR(1)=ON)/*      */ 04035000
*                     |(ICTMSRCU(1)=ON&M5PTR->ICTMSRCU(1)=ON)/*      */ 04036000
*                   THEN            /*                               */ 04037000
         B     @RC01178                                            1180 04038000
@RF01178 TM    ICTMMACR(M4PTR),B'00001000'                         1180 04039000
         BNO   @GL00120                                            1180 04040000
         TM    ICTMMACR(M5PTR),B'00001000'                         1180 04041000
         BO    @RT01180                                            1180 04042000
@GL00120 TM    ICTMMACU(M4PTR),B'00000100'                         1180 04043000
         BNO   @GL00119                                            1180 04044000
         TM    ICTMMACU(M5PTR),B'00000100'                         1180 04045000
         BO    @RT01180                                            1180 04046000
@GL00119 TM    ICTMSRCR(M4PTR),B'00000010'                         1180 04047000
         BNO   @GL00118                                            1180 04048000
         TM    ICTMSRCR(M5PTR),B'00000010'                         1180 04049000
         BO    @RT01180                                            1180 04050000
@GL00118 TM    ICTMSRCU(M4PTR),B'00000001'                         1180 04051000
         BNO   @RF01180                                            1180 04052000
         TM    ICTMSRCU(M5PTR),B'00000001'                         1180 04053000
         BNO   @RF01180                                            1180 04054000
@RT01180 DS    0H                                                  1181 04055000
*                   RELSTOP=ON;     /* STOP LOOP                     */ 04056000
         OI    RELSTOP,B'10000000'                                 1181 04057000
*             END;                  /* END SAME TYPE AND SELECTED    */ 04058000
@RF01180 DS    0H                                                  1182 04059000
@RC01178 DS    0H                                                  1183 04060000
*         END;                      /* END SECOND LOOP               */ 04061000
@RF01176 AH    M5PTR,@CH02175                                      1183 04062000
@DE01175 CLC   ICTMEND(4,M5PTR),ICTENDNT                           1183 04063000
         BE    @DC01175                                            1183 04064000
         TM    RELSTOP,B'10000000'                                 1183 04065000
         BZ    @DL01175                                            1183 04066000
@DC01175 DS    0H                                                  1184 04067000
*         IF RELSTOP=OFF            /* IF NO RELATED ELEMENT         */ 04068000
*           THEN                    /* THEN FIRST ELEMENT            */ 04069000
         TM    RELSTOP,B'10000000'                                 1184 04070000
         BNZ   @RF01184                                            1184 04071000
*           ICTMCPL(1)=ON;          /* IS COMPLETE                   */ 04072000
         OI    ICTMCPL(M4PTR),B'00100000'                          1185 04073000
*       END;                        /* END ELEMENT NOT SELECTED      */ 04074000
@RF01184 DS    0H                                                  1187 04075000
*   END;                            /* END FIRST MOD LOOP            */ 04076000
*                                                                  1187 04077000
@RF01171 AH    M4PTR,@CH02175                                      1187 04078000
@DE01170 CLC   ICTMEND(4,M4PTR),ICTENDNT                           1187 04079000
         BNE   @DL01170                                            1187 04080000
*   /*****************************************************************/ 04081000
*   /*                                                               */ 04082000
*   /* RETURN TO CALLER                                              */ 04083000
*   /*                                                               */ 04084000
*   /*****************************************************************/ 04085000
*                                                                  1188 04086000
*   RETURN CODE(ZERO);              /* RETURN TO CALLER              */ 04087000
         SLR   @15,@15                                             1188 04088000
         L     @14,@SA00016                                        1188 04089000
         LM    @00,@12,@SA00016+8                                  1188 04090000
         BR    @14                                                 1188 04091000
*   END CPLRELEM;                                                  1189 04092000
*                                                                  1190 04093000
*/********************************************************************/ 04094000
*/*                                                                  */ 04095000
*/* REDOCHK  - SEARCH THE ICT PTF SECTION FOR A NON-NOGO SYSMOD      */ 04096000
*/*            MATCHING (BUT NOT EQUAL TO) THE ICT SYSMOD ENTRY      */ 04097000
*/*            PASSED.                                               */ 04098000
*/*                                                                  */ 04099000
*/********************************************************************/ 04100000
*                                                                  1190 04101000
*REDOCHK:                                                          1190 04102000
*   PROC(REDOPTF,REDO@);                                           1190 04103000
REDOCHK  STM   @14,@12,12(@13)                                     1190 04104000
         MVC   @PC00017(8),0(@01)                                  1190 04105000
*   DCL                                                            1191 04106000
*     REDOPTF CHAR(*);              /* ICT PTF SECTION ENTRY         */ 04107000
*   DCL                                                            1192 04108000
*     REDO@ PTR(31);                /* RETURNED TO CALLER WITH     1192 04109000
*                                      ADDRESS OF ANOTHER ICT PTF  1192 04110000
*                                      SECTION ENTRY (OR ZERO)       */ 04111000
*   DCL                                                            1193 04112000
*     REDOPT1 PTR(31);              /* LOCAL POINTER                 */ 04113000
*   DCL                                                            1194 04114000
*     REDOPTFS CHAR(7);             /* LOCAL SAVE AREA               */ 04115000
*   REDO@=0;                        /* CLEAR PTR RETURNED TO CALLER  */ 04116000
         L     @08,@PC00017+4                                      1195 04117000
         SLR   @03,@03                                             1195 04118000
         ST    @03,REDO@(,@08)                                     1195 04119000
*   REDOPTFS=ADDR(REDOPTF)->ICTPTFS(1);/* SAVE NAME OF SYSMOD PASSED */ 04120000
         L     @08,@PC00017                                        1196 04121000
         MVC   REDOPTFS(7),ICTPTFS(@08)                            1196 04122000
*   REDOPT1=CCAICPTF;               /* POINT TO FIRST ENTRY IN ICT 1197 04123000
*                                      PTF SECTION                   */ 04124000
         L     REDOPT1,CCAICPTF(,CCAPTR)                           1197 04125000
*   RESPECIFY                                                      1198 04126000
*     ICTPTF BASED(REDOPT1);        /* ADDRESS ICT PTF SECT ENTRY    */ 04127000
*   DO REDOPT1=REDOPT1 BY LENGTH(ICTPTF)/* GO THRU ICT PTF SECTION   */ 04128000
*         WHILE ICTPEND(1)^=ICTENDNT/* NOT AT END                    */ 04129000
*         &REDO@=0;                 /* MATCHING SYSMOD NOT YET FOUND */ 04130000
         B     @DE01199                                            1199 04131000
@DL01199 DS    0H                                                  1200 04132000
*     IF REDOPT1^=ADDR(REDOPTF)     /* NOT ENTRY PASSED              */ 04133000
*         &ICTPTFS(1)=REDOPTFS      /* MATCHES SYSMOD NAME PASSED    */ 04134000
*         &ICTPNOGO(1)=OFF          /* NOT NOGO                      */ 04135000
*       THEN                                                       1200 04136000
         L     @08,@PC00017                                        1200 04137000
         CR    REDOPT1,@08                                         1200 04138000
         BE    @RF01200                                            1200 04139000
         CLC   ICTPTFS(7,REDOPT1),REDOPTFS                         1200 04140000
         BNE   @RF01200                                            1200 04141000
         TM    ICTPNOGO(REDOPT1),B'01000000'                       1200 04142000
         BNZ   @RF01200                                            1200 04143000
*       REDO@=REDOPT1;              /* POINT TO MATCHING SYSMOD      */ 04144000
         L     @08,@PC00017+4                                      1201 04145000
         ST    REDOPT1,REDO@(,@08)                                 1201 04146000
*   END;                                                           1202 04147000
@RF01200 AH    REDOPT1,@CH02176                                    1202 04148000
@DE01199 CLC   ICTPEND(4,REDOPT1),ICTENDNT                         1202 04149000
         BE    @DC01199                                            1202 04150000
         L     @08,@PC00017+4                                      1202 04151000
         ICM   @03,15,REDO@(@08)                                   1202 04152000
         BZ    @DL01199                                            1202 04153000
@DC01199 DS    0H                                                  1203 04154000
*   RETURN;                                                        1203 04155000
@EL00017 DS    0H                                                  1203 04156000
@EF00017 DS    0H                                                  1203 04157000
@ER00017 LM    @14,@12,12(@13)                                     1203 04158000
         BR    @14                                                 1203 04159000
*   END REDOCHK;                                                   1204 04160000
*   END HMASMCPL                    /*                               */ 04161000
*                                                                  1205 04162000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 04163000
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */ 04164000
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */ 04165000
*/*%INCLUDE SYSLIB  (HMASMICT)                                       */ 04166000
*/*%INCLUDE SYSLIB  (HMASMMGP)                                       */ 04167000
*/*%INCLUDE SYSLIB  (HMASMSPL)                                       */ 04168000
*                                                                  1205 04169000
*       ;                                                          1205 04170000
@DATA    DS    0H                                                       04171000
@CH00037 DC    H'1'                                                     04172000
@CH00035 DC    H'9'                                                     04173000
@CH00033 DC    H'12'                                                    04174000
@CH00476 DC    H'28'                                                    04175000
@CH00478 DC    H'29'                                                    04176000
@CH00480 DC    H'30'                                                    04177000
@CH00497 DC    H'40'                                                    04178000
@CH01013 DC    H'54'                                                    04179000
@CH01873 DC    H'103'                                                   04180000
@CH01880 DC    H'104'                                                   04181000
@CH00950 DC    H'105'                                                   04182000
@CH01891 DC    H'110'                                                   04183000
@CH01893 DC    H'111'                                                   04184000
@CH02176 DC    H'116'                                                   04185000
@CH02175 DC    H'144'                                                   04186000
@CH01072 DC    H'170'                                                   04187000
@CH01875 DC    H'171'                                                   04188000
@CH00628 DC    H'255'                                                   04189000
         DS    0F                                                       04190000
@AL00216 DC    A(TSLPARMS)             LIST WITH   1 ARGUMENT(S)        04191000
@AL00335 DC    A(OK1NGSET)             LIST WITH   1 ARGUMENT(S)        04192000
@AL00359 EQU   *                       LIST WITH   1 ARGUMENT(S)        04193000
@AL00426 EQU   *                       LIST WITH   1 ARGUMENT(S)        04194000
@AL00445 EQU   *                       LIST WITH   1 ARGUMENT(S)        04195000
@AL00486 EQU   *                       LIST WITH   1 ARGUMENT(S)        04196000
@AL00507 EQU   *                       LIST WITH   1 ARGUMENT(S)        04197000
@AL00536 EQU   *                       LIST WITH   1 ARGUMENT(S)        04198000
@AL00554 EQU   *                       LIST WITH   1 ARGUMENT(S)        04199000
@AL00604 EQU   *                       LIST WITH   1 ARGUMENT(S)        04200000
@AL00609 EQU   *                       LIST WITH   1 ARGUMENT(S)        04201000
@AL00909 EQU   *                       LIST WITH   1 ARGUMENT(S)        04202000
@AL01072 EQU   *                       LIST WITH   1 ARGUMENT(S)        04203000
@AL01158 DC    A(HMASMMGP)             LIST WITH   1 ARGUMENT(S)        04204000
@AL00377 DC    A(@CF00121)             LIST WITH   3 ARGUMENT(S)        04205000
         DC    A(@CF01887)                                              04206000
         DC    A(NGSET)                                                 04207000
@AL00378 DC    A(@CF00121)             LIST WITH   3 ARGUMENT(S)        04208000
         DC    A(@CF01883)                                              04209000
         DC    A(NGSET)                                                 04210000
@AL00379 DC    A(@CF00197)             LIST WITH   3 ARGUMENT(S)        04211000
         DC    A(@CF01885)                                              04212000
         DC    A(NGSET)                                                 04213000
@AL00381 DC    A(@CF01889)             LIST WITH   2 ARGUMENT(S)        04214000
@AL00386 DC    A(NGSET)                LIST WITH   1 ARGUMENT(S)        04215000
@AL00736 EQU   *                       LIST WITH   1 ARGUMENT(S)        04216000
@AL00745 DC    A(BUPPARM)              LIST WITH   1 ARGUMENT(S)        04217000
         DS    0F                                                       04218000
@SA00001 DS    18F                                                      04219000
@PC00001 DS    1F                                                       04220000
@SA00002 DS    15F                                                      04221000
@SA00004 DS    15F                                                      04222000
@SA00009 DS    15F                                                      04223000
@SA00010 DS    15F                                                      04224000
@SA00011 DS    15F                                                      04225000
@PC00017 DS    2F                                                       04226000
@SA00012 DS    0F                                                       04227000
@SA00006 DS    0F                                                       04228000
@PC00006 EQU   @SA00006+60                                              04229000
@SA00005 DS    0F                                                       04230000
@PC00005 EQU   @SA00005+60                                              04231000
@SA00007 DS    0F                                                       04232000
@PC00007 EQU   @SA00007+60                                              04233000
@SA00016 DS    0F                                                       04234000
@PC00016 EQU   @SA00016+60                                              04235000
@SA00014 DS    0F                                                       04236000
@SA00008 DS    0F                                                       04237000
@SA00003 DS    0F                                                       04238000
         DS    20F                                                      04239000
@AL00001 DS    5A                                                       04240000
@TF00001 DS    F                                                        04241000
         DS    0F                                                       04242000
@CF00121 DC    F'8'                                                     04243000
@CH00121 EQU   @CF00121+2                                               04244000
@CF00197 DC    F'16'                                                    04245000
@CF01883 DC    F'106'                                                   04246000
@CF01885 DC    F'107'                                                   04247000
@CF01887 DC    F'108'                                                   04248000
@CF01889 DC    F'109'                                                   04249000
@CF02215 DC    F'-8'                                                    04250000
@CF02213 DC    F'-4'                                                    04251000
@CV01859 DC    V(HMASMBUR)                                              04252000
@CV01860 DC    V(HMASMCRW)                                              04253000
@CV01861 DC    V(HMASMCP2)                                              04254000
@CV01862 DC    V(HMASMIDU)                                              04255000
@CV01863 DC    V(HMASMIO)                                               04256000
@CV01864 DC    V(HMASMPGC)                                              04257000
@CV01865 DC    V(HMASMRJD)                                              04258000
@CV01866 DC    V(HMASMMSG)                                              04259000
@CV01867 DC    V(HMASMSEC)                                              04260000
@CV01869 DC    V(HMASMSUP)                                              04261000
@CV01870 DC    V(HMASMTSB)                                              04262000
@CV01868 DC    V(HMASMSUB)                                              04263000
         DS    0D                                                       04264000
IOPPTR   DS    A                                                        04265000
SAVP8    DS    A                                                        04266000
SAVPF    DS    A                                                        04267000
REDOPTR  DS    A                                                        04268000
MAXNUM   DC    XL2'7FFF'                                                04269000
         DS    CL2                                                      04270000
ICTENDCH DC    X'FFFFFFFF'                                              04271000
HMASMMGP DS    CL28                                                     04272000
         ORG   HMASMMGP                                                 04273000
MGPFIXED DS    CL12                                                     04274000
         ORG   MGPFIXED                                                 04275000
MGPCLEAR DS    CL6                                                      04276000
         ORG   MGPCLEAR                                                 04277000
MGPMGNO1 DS    FL2                                                      04278000
MGPMGNO2 DS    FL2                                                      04279000
MGPMGNO3 DS    FL2                                                      04280000
         ORG   MGPFIXED+6                                               04281000
MGPFLAGS DS    BL2                                                      04282000
         ORG   MGPFLAGS                                                 04283000
MGPPRINT DS    BL1                                                      04284000
MGPLIST  EQU   MGPFLAGS+0                                               04285000
MGPRPT   EQU   MGPFLAGS+0                                               04286000
MGPHLDS  EQU   MGPFLAGS+0                                               04287000
MGPWTOR  EQU   MGPFLAGS+0                                               04288000
MGPWTO   EQU   MGPFLAGS+0                                               04289000
MGPWTP   EQU   MGPFLAGS+0                                               04290000
@NM00225 EQU   MGPFLAGS+0                                               04291000
         ORG   MGPFIXED+8                                               04292000
MGPTYPE  DS    FL1                                                      04293000
@NM00226 DS    CL3                                                      04294000
         ORG   HMASMMGP+12                                              04295000
MGPVAR   DS    CL16                                                     04296000
         ORG   MGPVAR                                                   04297000
MGPVARPT DS    4A                                                       04298000
         ORG   HMASMMGP+28                                              04299000
HMASMSPL DS    CL5                                                      04300000
         ORG   HMASMSPL                                                 04301000
SPLPMAD  DS    AL4                                                      04302000
SPLFUNCT DS    FL1                                                      04303000
         ORG   HMASMSPL+5                                               04304000
         DS    CL3                                                      04305000
BUPPARM  DS    CL20                                                     04306000
         ORG   BUPPARM                                                  04307000
BUPFUNCT DS    FL1                                                      04308000
BUPTYPE  DS    FL1                                                      04309000
BUPSTYPE DS    FL1                                                      04310000
BUPFLAGS DS    BL1                                                      04311000
         ORG   BUPFLAGS                                                 04312000
BUPREDO  DS    BL1                                                      04313000
@NM00227 EQU   BUPFLAGS+0                                               04314000
         ORG   BUPPARM+4                                                04315000
BUPSYSMD DS    CL7                                                      04316000
@NM00228 DS    CL1                                                      04317000
BUPIOPAD DS    AL4                                                      04318000
BUPGTPAD DS    AL4                                                      04319000
         ORG   BUPPARM+20                                               04320000
TSLPARMS DS    CL10                                                     04321000
         ORG   TSLPARMS                                                 04322000
TSLTBLXP DS    AL4                                                      04323000
TSLPMLAD DS    AL4                                                      04324000
TSLFUNCT DS    FL1                                                      04325000
TSLRETRN DS    FL1                                                      04326000
         ORG   TSLPARMS+10                                              04327000
         DS    CL2                                                      04328000
TSLICTSR DS    CL14                                                     04329000
         ORG   TSLICTSR                                                 04330000
TSLISMD  DS    CL7                                                      04331000
TSLIOPTF DS    CL1                                                      04332000
         ORG   TSLIOPTF                                                 04333000
TSLIONXT DS    BL1                                                      04334000
@NM00243 EQU   TSLIOPTF+0                                               04335000
         ORG   TSLICTSR+8                                               04336000
TSLICTP  DS    AL4                                                      04337000
TSLICTF  DS    CL1                                                      04338000
         ORG   TSLICTF                                                  04339000
TSLIFND  DS    BL1                                                      04340000
TSLIOK   EQU   TSLICTF+0                                                04341000
TSLISUP  EQU   TSLICTF+0                                                04342000
TSLIDEL  EQU   TSLICTF+0                                                04343000
TSLIDLE  EQU   TSLICTF+0                                                04344000
TSLIDLI  EQU   TSLICTF+0                                                04345000
TSLINOG  EQU   TSLICTF+0                                                04346000
@NM00244 EQU   TSLICTF+0                                                04347000
         ORG   TSLICTSR+13                                              04348000
@NM00245 DS    BL1                                                      04349000
         ORG   TSLICTSR+14                                              04350000
         DS    CL2                                                      04351000
TSLLSTSR DS    CL16                                                     04352000
         ORG   TSLLSTSR                                                 04353000
TSLLSMD  DS    CL7                                                      04354000
TSLLOPTF DS    CL1                                                      04355000
         ORG   TSLLOPTF                                                 04356000
TSLLONXT DS    BL1                                                      04357000
@NM00246 EQU   TSLLOPTF+0                                               04358000
         ORG   TSLLSTSR+8                                               04359000
TSLLOFST DS    FL4                                                      04360000
TSLLRTNP DS    AL4                                                      04361000
         ORG   TSLLSTSR+16                                              04362000
TSLGET   DS    CL13                                                     04363000
         ORG   TSLGET                                                   04364000
TSLGSMD  DS    CL7                                                      04365000
TSLGOPTF DS    CL1                                                      04366000
         ORG   TSLGOPTF                                                 04367000
@NM00247 DS    BL1                                                      04368000
@NM00248 EQU   TSLGOPTF+0                                               04369000
@NM00249 EQU   TSLGOPTF+0                                               04370000
TSLGOMSG EQU   TSLGOPTF+0                                               04371000
TSLGOXTD EQU   TSLGOPTF+0                                               04372000
@NM00250 EQU   TSLGOPTF+0                                               04373000
         ORG   TSLGET+8                                                 04374000
TSLGIOPP DS    AL4                                                      04375000
TSLGDSID DS    FL1                                                      04376000
         ORG   TSLGET+13                                                04377000
         DS    CL3                                                      04378000
TSLSICDS DS    CL20                                                     04379000
         ORG   TSLSICDS                                                 04380000
TSLSSMD  DS    CL7                                                      04381000
TSLSOPTF DS    CL1                                                      04382000
         ORG   TSLSOPTF                                                 04383000
TSLSOICT DS    BL1                                                      04384000
TSLSOCDS EQU   TSLSOPTF+0                                               04385000
TSLSOALL EQU   TSLSOPTF+0                                               04386000
TSLSOMSG EQU   TSLSOPTF+0                                               04387000
TSLSOXTD EQU   TSLSOPTF+0                                               04388000
@NM00251 EQU   TSLSOPTF+0                                               04389000
         ORG   TSLSICDS+8                                               04390000
TSLSICTP DS    AL4                                                      04391000
TSLSIOPP DS    AL4                                                      04392000
TSLSICTF DS    CL1                                                      04393000
         ORG   TSLSICTF                                                 04394000
TSLSIFND DS    BL1                                                      04395000
TSLSIOK  EQU   TSLSICTF+0                                               04396000
TSLSISUP EQU   TSLSICTF+0                                               04397000
TSLSIDEL EQU   TSLSICTF+0                                               04398000
TSLSIDLE EQU   TSLSICTF+0                                               04399000
TSLSIDLI EQU   TSLSICTF+0                                               04400000
TSLSINOG EQU   TSLSICTF+0                                               04401000
TSLSISLS EQU   TSLSICTF+0                                               04402000
         ORG   TSLSICDS+17                                              04403000
@NM00252 DS    BL1                                                      04404000
TSLSCDSF DS    CL1                                                      04405000
         ORG   TSLSCDSF                                                 04406000
TSLSCFND DS    BL1                                                      04407000
TSLSCOK  EQU   TSLSCDSF+0                                               04408000
TSLSCSUP EQU   TSLSCDSF+0                                               04409000
TSLSCDEL EQU   TSLSCDSF+0                                               04410000
@NM00253 EQU   TSLSCDSF+0                                               04411000
@NM00254 EQU   TSLSCDSF+0                                               04412000
TSLSCERR EQU   TSLSCDSF+0                                               04413000
TSLSDUM  EQU   TSLSCDSF+0                                               04414000
         ORG   TSLSICDS+19                                              04415000
@NM00255 DS    BL1                                                      04416000
         ORG   TSLSICDS+20                                              04417000
TSLENTSR DS    CL16                                                     04418000
         ORG   TSLENTSR                                                 04419000
TSLETYPE DS    FL1                                                      04420000
TSLEVER# DS    FL1                                                      04421000
TSLEOPTF DS    CL1                                                      04422000
         ORG   TSLEOPTF                                                 04423000
TSLEONXT DS    BL1                                                      04424000
@NM00256 EQU   TSLEOPTF+0                                               04425000
         ORG   TSLENTSR+3                                               04426000
@NM00257 DS    BL1                                                      04427000
TSLENMEP DS    AL4                                                      04428000
TSLEBGNP DS    AL4                                                      04429000
TSLEFNDP DS    AL4                                                      04430000
         ORG   TSLENTSR+16                                              04431000
TSLMFUNC DS    CL8                                                      04432000
         ORG   TSLMFUNC                                                 04433000
TSLMTYPE DS    FL1                                                      04434000
TSLMSMD  DS    CL7                                                      04435000
         ORG   TSLMFUNC+8                                               04436000
TSLRELM  DS    CL16                                                     04437000
         ORG   TSLRELM                                                  04438000
TSLRSMD  DS    CL7                                                      04439000
@NM00258 DS    CL1                                                      04440000
TSLRAPTR DS    AL4                                                      04441000
TSLRRTNP DS    AL4                                                      04442000
         ORG   TSLRELM+16                                               04443000
CPLSW    DS    BL2                                                      04444000
         ORG   CPLSW                                                    04445000
NOGOSW   DS    BL1                                                      04446000
STOP     EQU   CPLSW+0                                                  04447000
PTFCPL   EQU   CPLSW+0                                                  04448000
MODCPL   EQU   CPLSW+0                                                  04449000
LMDCPL   EQU   CPLSW+0                                                  04450000
SMDUPD   EQU   CPLSW+0                                                  04451000
FND      EQU   CPLSW+0                                                  04452000
LOOPSW1  EQU   CPLSW+0                                                  04453000
@NM00259 DS    BL1                                                      04454000
         ORG   CPLSW+2                                                  04455000
OK1NGSET DS    CL1                                                      04456000
NGSET    DS    CL1                                                      04457000
XX1SW    DS    BL1                                                      04458000
         ORG   XX1SW                                                    04459000
XX1STOP1 DS    BL1                                                      04460000
XX1NG    EQU   XX1SW+0                                                  04461000
XX1OK    EQU   XX1SW+0                                                  04462000
XX1RQFND EQU   XX1SW+0                                                  04463000
@NM00260 EQU   XX1SW+0                                                  04464000
         ORG   XX1SW+1                                                  04465000
TEMP1PTF DS    CL7                                                      04466000
TMPID    DS    CL8                                                      04467000
TIMETEMP DS    CL4                                                      04468000
SAVAPPD  DS    CL3                                                      04469000
SAVAPPT  DS    CL3                                                      04470000
SUPDLSW  DS    BL1                                                      04471000
         ORG   SUPDLSW                                                  04472000
SUPFND   DS    BL1                                                      04473000
@NM00261 EQU   SUPDLSW+0                                                04474000
         ORG   SUPDLSW+1                                                04475000
RELEMSW  DS    BL1                                                      04476000
         ORG   RELEMSW                                                  04477000
RELSTOP  DS    BL1                                                      04478000
RELTYPE  EQU   RELEMSW+0                                                04479000
RELFND   EQU   RELEMSW+0                                                04480000
@NM00262 EQU   RELEMSW+0                                                04481000
         ORG   RELEMSW+1                                                04482000
REDOPTFS DS    CL7                                                      04483000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       04484000
@01      EQU   01                                                       04485000
@02      EQU   02                                                       04486000
@03      EQU   03                                                       04487000
@04      EQU   04                                                       04488000
@05      EQU   05                                                       04489000
@06      EQU   06                                                       04490000
@07      EQU   07                                                       04491000
@08      EQU   08                                                       04492000
@09      EQU   09                                                       04493000
@10      EQU   10                                                       04494000
@11      EQU   11                                                       04495000
@12      EQU   12                                                       04496000
@13      EQU   13                                                       04497000
@14      EQU   14                                                       04498000
@15      EQU   15                                                       04499000
REDOPT1  EQU   @02                                                      04500000
M5PTR    EQU   @02                                                      04501000
M4PTR    EQU   @03                                                      04502000
PX1      EQU   @03                                                      04503000
P1PTR    EQU   @02                                                      04504000
RESETRC  EQU   @03                                                      04505000
L2PTR    EQU   @02                                                      04506000
M2PTR    EQU   @02                                                      04507000
P2PTR    EQU   @02                                                      04508000
LX6      EQU   @03                                                      04509000
L6PTR    EQU   @02                                                      04510000
PXH      EQU   @05                                                      04511000
SUPDLX   EQU   @02                                                      04512000
SUPDLRC  EQU   @03                                                      04513000
HOLDNUM  EQU   @06                                                      04514000
PXF      EQU   @05                                                      04515000
PFPTR    EQU   @02                                                      04516000
DELRC    EQU   @03                                                      04517000
NTX      EQU   @02                                                      04518000
TMPTYPE  EQU   @05                                                      04519000
NTDELRC  EQU   @03                                                      04520000
CON      EQU   @06                                                      04521000
LON      EQU   @02                                                      04522000
OKRC1    EQU   @03                                                      04523000
OKRC     EQU   @05                                                      04524000
P8PTR    EQU   @04                                                      04525000
SMDCKRC  EQU   @05                                                      04526000
PXC      EQU   @02                                                      04527000
PCPTR    EQU   @04                                                      04528000
P7PTR    EQU   @03                                                      04529000
PXE      EQU   @04                                                      04530000
PEPTR    EQU   @03                                                      04531000
XX3PTR1  EQU   @02                                                      04532000
PDPTR    EQU   @02                                                      04533000
XX2PTR1  EQU   @03                                                      04534000
PXG      EQU   @05                                                      04535000
PGPTR    EQU   @02                                                      04536000
PXB      EQU   @04                                                      04537000
PBPTR    EQU   @02                                                      04538000
XX1INDX  EQU   @06                                                      04539000
XX1PTR1  EQU   @03                                                      04540000
P9PTR    EQU   @02                                                      04541000
P4PTR    EQU   @02                                                      04542000
LX1      EQU   @03                                                      04543000
L1PTR    EQU   @02                                                      04544000
M3PTR    EQU   @03                                                      04545000
MX1      EQU   @03                                                      04546000
M1PTR    EQU   @02                                                      04547000
CPLRTNCD EQU   @03                                                      04548000
CCAPTR   EQU   @11                                                      04549000
RTNCODE  EQU   @15                                                      04550000
R0       EQU   @00                                                      04551000
RTNREG   EQU   @14                                                      04552000
HMASMCCA EQU   0                                                        04553000
CCAFBUFR EQU   HMASMCCA+4                                               04554000
CCADSAD  EQU   CCAFBUFR+124                                             04555000
CCATPAD  EQU   CCAFBUFR+128                                             04556000
CCAFLAG7 EQU   CCAFBUFR+132                                             04557000
CCAFIOP  EQU   HMASMCCA+140                                             04558000
CCAIOPTR EQU   CCAFIOP                                                  04559000
CCAFSYS  EQU   HMASMCCA+148                                             04560000
CCASREL  EQU   CCAFSYS+12                                               04561000
CCAFLAGA EQU   CCAFSYS+21                                               04562000
CCACDSID EQU   CCAFSYS+24                                               04563000
CCAACDID EQU   CCAFSYS+32                                               04564000
CCAFSTA  EQU   HMASMCCA+188                                             04565000
CCAFICT  EQU   HMASMCCA+192                                             04566000
CCAICT   EQU   CCAFICT                                                  04567000
CCAICPTF EQU   CCAFICT+4                                                04568000
CCAICMOD EQU   CCAFICT+8                                                04569000
CCAICLMD EQU   CCAFICT+12                                               04570000
CCAFPGM  EQU   HMASMCCA+208                                             04571000
CCABLDLP EQU   CCAFPGM                                                  04572000
CCADBLDL EQU   CCAFPGM+4                                                04573000
CCAFGTP  EQU   HMASMCCA+224                                             04574000
CCASEGTP EQU   CCAFGTP                                                  04575000
@NM00009 EQU   HMASMCCA+244                                             04576000
CCATBLPA EQU   @NM00009+12                                              04577000
CCAFFUNC EQU   HMASMCCA+264                                             04578000
CCAFUNCT EQU   CCAFFUNC                                                 04579000
CCAFLAG1 EQU   CCAFFUNC+8                                               04580000
CCAAPPLY EQU   CCAFLAG1                                                 04581000
CCAACCPT EQU   CCAFLAG1                                                 04582000
CCARES   EQU   CCAFLAG1                                                 04583000
CCAFLAG2 EQU   CCAFFUNC+11                                              04584000
CCAFPROC EQU   HMASMCCA+276                                             04585000
CCAFLAG3 EQU   CCAFPROC                                                 04586000
CCAFDIS  EQU   HMASMCCA+278                                             04587000
CCAFLAG4 EQU   CCAFDIS                                                  04588000
CCAFLAG5 EQU   CCAFDIS+1                                                04589000
CCAFLAG6 EQU   CCAFDIS+2                                                04590000
CCAFCNV  EQU   HMASMCCA+281                                             04591000
CCAFLAG8 EQU   CCAFCNV                                                  04592000
CCAFCTL  EQU   HMASMCCA+282                                             04593000
CCAFLAG9 EQU   CCAFCTL                                                  04594000
CCAPTSNP EQU   CCAFLAG9                                                 04595000
CCAPTSNJ EQU   CCAFLAG9                                                 04596000
CCADATE  EQU   CCAFCTL+1                                                04597000
CCAFDSNG EQU   HMASMCCA+298                                             04598000
CCAFLAGB EQU   CCAFDSNG                                                 04599000
CCABLDLA EQU   0                                                        04600000
@NM00025 EQU   CCABLDLA                                                 04601000
CCABLDLL EQU   0                                                        04602000
@NM00027 EQU   CCABLDLL                                                 04603000
CCALKDRC EQU   @NM00027+20                                              04604000
@NM00029 EQU   CCABLDLL+124                                             04605000
CCAASMRC EQU   @NM00029+20                                              04606000
@NM00031 EQU   CCABLDLL+248                                             04607000
CCACPYRC EQU   @NM00031+20                                              04608000
@NM00033 EQU   CCABLDLL+372                                             04609000
CCACOMRC EQU   @NM00033+20                                              04610000
@NM00035 EQU   CCABLDLL+496                                             04611000
CCAZAPRC EQU   @NM00035+20                                              04612000
@NM00037 EQU   CCABLDLL+620                                             04613000
CCASUPRC EQU   @NM00037+20                                              04614000
@NM00039 EQU   CCABLDLL+744                                             04615000
CCAUPDRC EQU   @NM00039+20                                              04616000
CCABLDLM EQU   0                                                        04617000
CCABELMT EQU   CCABLDLM+4                                               04618000
CCABMPOS EQU   CCABELMT                                                 04619000
HMASMIOP EQU   0                                                        04620000
IOPDSID  EQU   HMASMIOP                                                 04621000
IOPFUNCT EQU   HMASMIOP+1                                               04622000
IOPRETRN EQU   HMASMIOP+2                                               04623000
IOPTYPE  EQU   HMASMIOP+3                                               04624000
IOPNAME  EQU   HMASMIOP+4                                               04625000
IOPNAM17 EQU   IOPNAME                                                  04626000
@NM00043 EQU   HMASMIOP+12                                              04627000
@NM00044 EQU   @NM00043                                                 04628000
IOPDDNAM EQU   HMASMIOP+24                                              04629000
IOPBUFAD EQU   HMASMIOP+52                                              04630000
IOPDRMAP EQU   HMASMIOP+56                                              04631000
IOPINAME EQU   IOPDRMAP                                                 04632000
IOPINAM  EQU   IOPINAME                                                 04633000
IOPITYP  EQU   IOPINAM                                                  04634000
IOPUSERL EQU   IOPDRMAP+11                                              04635000
IOPEND   EQU   IOPDRMAP+12                                              04636000
IOPLMCTL EQU   0                                                        04637000
IOPQSMIF EQU   0                                                        04638000
@NM00154 EQU   IOPQSMIF                                                 04639000
IOPQSMLS EQU   IOPQSMIF+8                                               04640000
IOPQSMNM EQU   IOPQSMLS                                                 04641000
IOPBS02  EQU   0                                                        04642000
IOPBS04  EQU   0                                                        04643000
IOPBAPF  EQU   IOPBS04                                                  04644000
HMASMICT EQU   0                                                        04645000
ICTCORE  EQU   HMASMICT                                                 04646000
ICTPSPLN EQU   ICTCORE                                                  04647000
ICTMSPLN EQU   ICTCORE+4                                                04648000
ICTLSPLN EQU   ICTCORE+8                                                04649000
ICTGMSPL EQU   0                                                        04650000
ICTPTF   EQU   0                                                        04651000
ICTPTFS  EQU   ICTPTF                                                   04652000
ICTPEND  EQU   ICTPTFS                                                  04653000
ICTPFLG1 EQU   ICTPTF+7                                                 04654000
ICTERROR EQU   ICTPFLG1                                                 04655000
ICTPFLG3 EQU   ICTPTF+8                                                 04656000
ICTPPROC EQU   ICTPFLG3                                                 04657000
ICTPNOGO EQU   ICTPFLG3                                                 04658000
ICTPCPL  EQU   ICTPFLG3                                                 04659000
ICTPMSG  EQU   ICTPFLG3                                                 04660000
ICTPFLG5 EQU   ICTPTF+9                                                 04661000
ICTPDELP EQU   ICTPFLG5                                                 04662000
ICTPJCLP EQU   ICTPFLG5                                                 04663000
ICTPADDP EQU   ICTPFLG5+1                                               04664000
ICTPMDLP EQU   ICTPFLG5+1                                               04665000
ICTPFLG6 EQU   ICTPTF+11                                                04666000
ICTPFLF  EQU   ICTPFLG6                                                 04667000
ICTPFLG2 EQU   ICTPTF+12                                                04668000
ICTPFLG4 EQU   ICTPTF+13                                                04669000
ICTPCDSE EQU   ICTPFLG4                                                 04670000
ICTPDEXP EQU   ICTPFLG4                                                 04671000
ICTPDIMP EQU   ICTPFLG4                                                 04672000
ICTPFLG8 EQU   ICTPTF+14                                                04673000
ICTPGCPL EQU   ICTPFLG8                                                 04674000
ICTPECPL EQU   ICTPFLG8                                                 04675000
ICTPDCPL EQU   ICTPFLG8                                                 04676000
ICTPFLG9 EQU   ICTPTF+15                                                04677000
ICTPPDEL EQU   ICTPFLG9                                                 04678000
@NM00181 EQU   ICTPFLG9                                                 04679000
ICTPFLGA EQU   ICTPTF+16                                                04680000
ICTPUSR1 EQU   ICTPFLGA                                                 04681000
ICTPTYPE EQU   ICTPTF+17                                                04682000
ICTPONUM EQU   ICTPTF+18                                                04683000
ICTPSUPN EQU   ICTPTF+20                                                04684000
ICTPFMID EQU   ICTPTF+22                                                04685000
ICTPRELN EQU   ICTPTF+36                                                04686000
ICTPTPFX EQU   ICTPTF+38                                                04687000
ICTPCHN  EQU   ICTPTF+64                                                04688000
ICTPRCHN EQU   ICTPTF+68                                                04689000
ICTPSCHN EQU   ICTPTF+72                                                04690000
ICTPPCHN EQU   ICTPTF+76                                                04691000
ICTPICHN EQU   ICTPTF+80                                                04692000
ICTPNCHN EQU   ICTPTF+84                                                04693000
ICTPVCHN EQU   ICTPTF+88                                                04694000
ICTPDCHN EQU   ICTPTF+92                                                04695000
ICTPBCHN EQU   ICTPTF+96                                                04696000
ICTIXPF  EQU   0                                                        04697000
ICTIXP   EQU   ICTIXPF                                                  04698000
ICTENTLS EQU   0                                                        04699000
ICTENTNT EQU   ICTENTLS                                                 04700000
ICTENTNM EQU   ICTENTNT                                                 04701000
ICTENTND EQU   ICTENTNM                                                 04702000
ICTENTST EQU   ICTENTNT+7                                               04703000
ICTEREQB EQU   ICTENTST                                                 04704000
ICTEREQT EQU   ICTENTST                                                 04705000
ICTREQLS EQU   0                                                        04706000
ICTREQNT EQU   ICTREQLS                                                 04707000
ICTREQNM EQU   ICTREQNT                                                 04708000
ICTREQST EQU   ICTREQNT+7                                               04709000
ICTSUPLS EQU   0                                                        04710000
ICTSUPNT EQU   ICTSUPLS                                                 04711000
ICTSUPNM EQU   ICTSUPNT                                                 04712000
ICTSUPND EQU   ICTSUPNM                                                 04713000
ICTPRELS EQU   0                                                        04714000
ICTPRENT EQU   ICTPRELS                                                 04715000
ICTPRENM EQU   ICTPRENT                                                 04716000
ICTPREST EQU   ICTPRENT+7                                               04717000
ICTIRQLS EQU   0                                                        04718000
ICTIRQNT EQU   ICTIRQLS                                                 04719000
ICTIRQNM EQU   ICTIRQNT                                                 04720000
ICTIRQST EQU   ICTIRQNT+7                                               04721000
ICTCSRST EQU   ICTIRQNT+15                                              04722000
ICTNPRLS EQU   0                                                        04723000
ICTNPRNT EQU   ICTNPRLS                                                 04724000
ICTNPRNM EQU   ICTNPRNT                                                 04725000
ICTVRSLS EQU   0                                                        04726000
ICTVRSNT EQU   ICTVRSLS                                                 04727000
ICTVRSNM EQU   ICTVRSNT                                                 04728000
ICTDELLS EQU   0                                                        04729000
ICTDELNT EQU   ICTDELLS                                                 04730000
ICTDELNM EQU   ICTDELNT                                                 04731000
ICTDELND EQU   ICTDELNM                                                 04732000
ICTDELST EQU   ICTDELNT+7                                               04733000
ICTSBYLS EQU   0                                                        04734000
ICTSBYNT EQU   ICTSBYLS                                                 04735000
ICTSBYNM EQU   ICTSBYNT                                                 04736000
ICTMOD   EQU   0                                                        04737000
ICTMNAME EQU   ICTMOD                                                   04738000
ICTMEND  EQU   ICTMNAME                                                 04739000
ICTMFLG2 EQU   ICTMOD+8                                                 04740000
ICTMPROC EQU   ICTMFLG2                                                 04741000
ICTMNOGO EQU   ICTMFLG2                                                 04742000
ICTMCPL  EQU   ICTMFLG2                                                 04743000
ICTMFLG1 EQU   ICTMOD+9                                                 04744000
ICTMMODR EQU   ICTMFLG1                                                 04745000
ICTMMOD  EQU   ICTMMODR                                                 04746000
ICTMASM  EQU   ICTMMODR                                                 04747000
ICTMZAP  EQU   ICTMFLG1                                                 04748000
ICTMXPND EQU   ICTMFLG1                                                 04749000
ICTMMACR EQU   ICTMFLG1                                                 04750000
ICTMMACU EQU   ICTMFLG1                                                 04751000
ICTMSRCR EQU   ICTMFLG1                                                 04752000
ICTMSRCU EQU   ICTMFLG1                                                 04753000
ICTMFLG3 EQU   ICTMOD+10                                                04754000
ICTMFLG4 EQU   ICTMOD+11                                                04755000
ICTMISEL EQU   ICTMFLG4                                                 04756000
ICTMIDEL EQU   ICTMFLG4                                                 04757000
ICTMSELM EQU   ICTMFLG4                                                 04758000
ICTMFLG5 EQU   ICTMOD+12                                                04759000
ICTMELCK EQU   ICTMFLG5                                                 04760000
ICTMNORL EQU   ICTMFLG5                                                 04761000
ICTMODF4 EQU   ICTMOD+13                                                04762000
ICTMLEP1 EQU   ICTMODF4                                                 04763000
ICTMODF5 EQU   ICTMOD+14                                                04764000
ICTMLEP2 EQU   ICTMODF5                                                 04765000
ICTMODF6 EQU   ICTMOD+15                                                04766000
ICTMLEP3 EQU   ICTMODF6                                                 04767000
ICTMODF7 EQU   ICTMOD+16                                                04768000
ICTMLEP4 EQU   ICTMODF7                                                 04769000
ICTMACF4 EQU   ICTMOD+17                                                04770000
ICTPPTR  EQU   ICTMOD+96                                                04771000
ICTMCHN  EQU   ICTMOD+100                                               04772000
ICTMICHN EQU   ICTMOD+104                                               04773000
ICTMACHN EQU   ICTMOD+112                                               04774000
ICTMTCHN EQU   ICTMOD+116                                               04775000
ICTMVCHN EQU   ICTMOD+120                                               04776000
ICTMUCHN EQU   ICTMOD+124                                               04777000
ICTIXMF  EQU   0                                                        04778000
ICTIXM   EQU   ICTIXMF                                                  04779000
ICTMIDLS EQU   0                                                        04780000
ICTMID   EQU   ICTMIDLS                                                 04781000
ICTMODID EQU   ICTMID                                                   04782000
ICTMODST EQU   ICTMID+7                                                 04783000
ICTASMLS EQU   0                                                        04784000
ICTASMAD EQU   ICTASMLS                                                 04785000
ICTTALLS EQU   0                                                        04786000
ICTTALNM EQU   ICTTALLS                                                 04787000
ICTMVRLS EQU   0                                                        04788000
ICTMVRNT EQU   ICTMVRLS                                                 04789000
ICTMVRNM EQU   ICTMVRNT                                                 04790000
ICTMUMLS EQU   0                                                        04791000
ICTMUMNT EQU   ICTMUMLS                                                 04792000
ICTMUMNM EQU   ICTMUMNT                                                 04793000
ICTLMOD  EQU   0                                                        04794000
ICTLMNAM EQU   ICTLMOD                                                  04795000
ICTLNAME EQU   ICTLMNAM                                                 04796000
ICTLEND  EQU   ICTLNAME                                                 04797000
ICTLFLG4 EQU   ICTLMOD+8                                                04798000
ICTLPROC EQU   ICTLFLG4                                                 04799000
ICTLNOGO EQU   ICTLFLG4                                                 04800000
ICTLCPL  EQU   ICTLFLG4                                                 04801000
ICTLFLG1 EQU   ICTLMOD+9                                                04802000
ICTLFLG5 EQU   ICTLMOD+10                                               04803000
ICTLFLG6 EQU   ICTLMOD+11                                               04804000
ICTLFLG7 EQU   ICTLMOD+12                                               04805000
ICTLFLG2 EQU   ICTLMOD+13                                               04806000
ICTLFLG3 EQU   ICTLMOD+14                                               04807000
ICTLCHN  EQU   ICTLMOD+34                                               04808000
ICTIXLF  EQU   0                                                        04809000
ICTIXL   EQU   ICTIXLF                                                  04810000
SPLPPACK EQU   0                                                        04811000
SPLPUNPK EQU   0                                                        04812000
SPLPDSN  EQU   0                                                        04813000
SPLODSN  EQU   SPLPDSN                                                  04814000
TBLXPARM EQU   0                                                        04815000
TBLXINDX EQU   TBLXPARM+4                                               04816000
TBLXTBL  EQU   TBLXPARM+28                                              04817000
TBLXFLG1 EQU   TBLXPARM+80                                              04818000
TBLXRC   EQU   TBLXPARM+92                                              04819000
TBLXOPTS EQU   0                                                        04820000
TBLFLAGS EQU   TBLXOPTS+8                                               04821000
TBLFLG1  EQU   TBLFLAGS                                                 04822000
TBLNOAPP EQU   TBLFLG1                                                  04823000
TBLFLG2  EQU   TBLFLAGS+2                                               04824000
TBLFLG3  EQU   TBLFLAGS+3                                               04825000
TBLFLG4  EQU   TBLFLAGS+5                                               04826000
TBLFLG5  EQU   TBLFLAGS+7                                               04827000
CCADSIDA EQU   0                                                        04828000
CCATYPEA EQU   0                                                        04829000
IOPBS01  EQU   0                                                        04830000
IOPBS03  EQU   0                                                        04831000
GONOGO   EQU   0                                                        04832000
XX1SMD   EQU   0                                                        04833000
XX1CHN   EQU   0                                                        04834000
XX1LEN   EQU   0                                                        04835000
XX1PART2 EQU   0                                                        04836000
XX1NGSET EQU   0                                                        04837000
XX2SMD   EQU   0                                                        04838000
XX2PART2 EQU   0                                                        04839000
XX2NGSET EQU   0                                                        04840000
XX3SMD   EQU   0                                                        04841000
XX3NGSET EQU   0                                                        04842000
RELEMNG  EQU   0                                                        04843000
REDOPTF  EQU   0                                                        04844000
REDO@    EQU   0                                                        04845000
IOPUDATA EQU   IOPEND                                                   04846000
IOPINAM3 EQU   IOPINAME                                                 04847000
@NM00050 EQU   IOPINAM3                                                 04848000
IOPSTCMP EQU   IOPUDATA                                                 04849000
IOPDYNDT EQU   IOPUDATA                                                 04850000
IOPSPACE EQU   IOPDYNDT+44                                              04851000
IOPDTYPE EQU   IOPDYNDT+50                                              04852000
IOPNTMAX EQU   IOPDRMAP                                                 04853000
IOPNTMAP EQU   IOPDRMAP                                                 04854000
IOPCDMAP EQU   IOPNTMAP                                                 04855000
IOPPTMAP EQU   IOPCDMAP                                                 04856000
IOPSCMAP EQU   IOPPTMAP                                                 04857000
IOPDIRCT EQU   IOPSCMAP+12                                              04858000
IOPCDMAX EQU   IOPDIRCT                                                 04859000
IOPCQMAP EQU   IOPDRMAP                                                 04860000
@NM00061 EQU   IOPUDATA                                                 04861000
@NM00062 EQU   IOPUDATA                                                 04862000
IOPASMNT EQU   IOPUDATA                                                 04863000
IOPASMDR EQU   IOPASMNT                                                 04864000
IOPABUNT EQU   IOPASMDR+1                                               04865000
IOPLMDNT EQU   IOPUDATA                                                 04866000
IOPLMDDR EQU   IOPLMDNT                                                 04867000
IOPLMLEP EQU   IOPLMDDR+1                                               04868000
IOPLMDF1 EQU   IOPLMLEP                                                 04869000
IOPFLGS2 EQU   IOPLMDF1                                                 04870000
IOPLMDF2 EQU   IOPLMLEP+1                                               04871000
IOPLMDF3 EQU   IOPLMLEP+2                                               04872000
IOPLMDF4 EQU   IOPLMLEP+3                                               04873000
IOPLMDF5 EQU   IOPLMDDR+5                                               04874000
IOPFLGS3 EQU   IOPLMDF5                                                 04875000
IOPLMDFX EQU   IOPLMDNT+24                                              04876000
@NM00071 EQU   IOPLMDFX                                                 04877000
IOPLNTRY EQU   IOPLMDFX+8                                               04878000
IOPLSYS  EQU   IOPLNTRY                                                 04879000
IOPSYSLB EQU   IOPLSYS                                                  04880000
IOPMACNT EQU   IOPUDATA                                                 04881000
IOPMACDR EQU   IOPMACNT                                                 04882000
IOPRMIDE EQU   IOPMACDR+1                                               04883000
IOPRMST  EQU   IOPRMIDE+7                                               04884000
IOPFMIDE EQU   IOPMACDR+9                                               04885000
IOPMACFX EQU   IOPMACNT+24                                              04886000
IOPBUNT  EQU   IOPMACFX                                                 04887000
IOPMCEND EQU   IOPMACNT+104                                             04888000
IOPMACVR EQU   IOPMCEND                                                 04889000
IOPMCENT EQU   IOPMACVR                                                 04890000
IOPMCDTA EQU   IOPMCENT                                                 04891000
IOPMCASM EQU   IOPMCDTA                                                 04892000
IOPMACID EQU   IOPMCASM                                                 04893000
IOPMACST EQU   IOPMCASM+7                                               04894000
IOPMCIND EQU   IOPMCENT+8                                               04895000
IOPEOFNT EQU   IOPUDATA                                                 04896000
IOPSRCNT EQU   IOPUDATA                                                 04897000
IOPSRCDR EQU   IOPSRCNT                                                 04898000
@NM00082 EQU   IOPSRCDR+1                                               04899000
@NM00084 EQU   @NM00082+7                                               04900000
@NM00088 EQU   IOPSRCDR+9                                               04901000
IOPSRCFX EQU   IOPSRCNT+24                                              04902000
@NM00092 EQU   IOPSRCFX                                                 04903000
IOPSREND EQU   IOPSRCNT+104                                             04904000
IOPSRCVR EQU   IOPSREND                                                 04905000
IOPSNTRY EQU   IOPSRCVR                                                 04906000
IOPSRDTA EQU   IOPSNTRY                                                 04907000
IOPSRCID EQU   IOPSRDTA                                                 04908000
IOPSRCST EQU   IOPSRDTA+7                                               04909000
IOPMODNT EQU   IOPUDATA                                                 04910000
IOPMODDR EQU   IOPMODNT                                                 04911000
@NM00098 EQU   IOPMODDR+1                                               04912000
@NM00100 EQU   @NM00098+7                                               04913000
@NM00104 EQU   IOPMODDR+9                                               04914000
IOPMODFX EQU   IOPMODNT+24                                              04915000
@NM00108 EQU   IOPMODFX                                                 04916000
IOPMDLEP EQU   IOPMODFX+8                                               04917000
IOPMODF1 EQU   IOPMDLEP                                                 04918000
IOPMODF2 EQU   IOPMDLEP+1                                               04919000
IOPMODF3 EQU   IOPMDLEP+2                                               04920000
IOPMODF4 EQU   IOPMDLEP+3                                               04921000
IOPMDEND EQU   IOPMODNT+104                                             04922000
IOPMODVR EQU   IOPMDEND                                                 04923000
IOPMNTRY EQU   IOPMODVR                                                 04924000
IOPMDDTA EQU   IOPMNTRY                                                 04925000
IOPLMODS EQU   IOPMDDTA                                                 04926000
IOPMODID EQU   IOPLMODS                                                 04927000
IOPMODST EQU   IOPLMODS+7                                               04928000
IOPDLBNT EQU   IOPUDATA                                                 04929000
IOPDLBDR EQU   IOPDLBNT                                                 04930000
IOPDLBFX EQU   IOPDLBNT+24                                              04931000
@NM00119 EQU   IOPDLBFX                                                 04932000
IOPDLEND EQU   IOPDLBNT+104                                             04933000
IOPDLBVR EQU   IOPDLEND                                                 04934000
IOPDNTRY EQU   IOPDLBVR                                                 04935000
IOPDSYS  EQU   IOPDNTRY                                                 04936000
IOPSYSNT EQU   IOPUDATA                                                 04937000
IOPSYSDR EQU   IOPSYSNT                                                 04938000
IOPSYSF1 EQU   IOPSYSDR+4                                               04939000
IOPFLGS7 EQU   IOPSYSF1                                                 04940000
IOPSYSFX EQU   IOPSYSNT+24                                              04941000
@NM00126 EQU   IOPSYSFX                                                 04942000
IOPSYEND EQU   IOPSYSNT+184                                             04943000
IOPSYSVR EQU   IOPSYEND                                                 04944000
IOPSYSTR EQU   IOPSYSVR                                                 04945000
IOPSYNTR EQU   IOPSYSTR                                                 04946000
IOPPTFNT EQU   IOPUDATA                                                 04947000
IOPPTFDR EQU   IOPPTFNT                                                 04948000
IOPPTYPE EQU   IOPPTFDR+1                                               04949000
IOPPSTAT EQU   IOPPTFDR+2                                               04950000
IOPPTFF1 EQU   IOPPSTAT                                                 04951000
IOPFLGS5 EQU   IOPPTFF1                                                 04952000
IOPAPP   EQU   IOPFLGS5                                                 04953000
IOPACC   EQU   IOPFLGS5                                                 04954000
IOPERROR EQU   IOPFLGS5                                                 04955000
IOPDUMMP EQU   IOPFLGS5                                                 04956000
IOPREGEN EQU   IOPFLGS5                                                 04957000
IOPPTFF2 EQU   IOPPSTAT+1                                               04958000
IOPPTFF3 EQU   IOPPSTAT+3                                               04959000
IOPSBYP  EQU   IOPPTFF3                                                 04960000
IOPDBYP  EQU   IOPPTFF3                                                 04961000
IOPDBYNO EQU   IOPPTFDR+6                                               04962000
IOPSBYNO EQU   IOPPTFDR+13                                              04963000
IOPPTFFX EQU   IOPPTFNT+24                                              04964000
@NM00135 EQU   IOPPTFFX                                                 04965000
@NM00136 EQU   @NM00135                                                 04966000
IOPPDTES EQU   IOPPTFFX+41                                              04967000
@NM00139 EQU   IOPPDTES                                                 04968000
IOPPTPFX EQU   IOPPDTES+6                                               04969000
IOPDATES EQU   IOPPTPFX                                                 04970000
IOPAPPD  EQU   IOPDATES                                                 04971000
IOPAPPT  EQU   IOPDATES+3                                               04972000
IOPACCD  EQU   IOPDATES+12                                              04973000
IOPACCT  EQU   IOPDATES+15                                              04974000
IOPPTEND EQU   IOPPTFNT+104                                             04975000
IOPPTFVR EQU   IOPPTEND                                                 04976000
IOPPNTRY EQU   IOPPTFVR                                                 04977000
IOPPMODS EQU   IOPPNTRY                                                 04978000
IOPPTFND EQU   IOPPMODS                                                 04979000
IOPPIND  EQU   IOPPNTRY+8                                               04980000
IOPENTNT EQU   IOPUDATA+104                                             04981000
IOPSRLNT EQU   IOPUDATA+104                                             04982000
IOPPRENT EQU   IOPUDATA+104                                             04983000
IOPNPRNT EQU   IOPUDATA+104                                             04984000
IOPSUPNT EQU   IOPUDATA+104                                             04985000
IOPREQNT EQU   IOPUDATA+104                                             04986000
IOPIRQNT EQU   IOPUDATA+104                                             04987000
IOPFIDNT EQU   IOPUDATA+104                                             04988000
IOPDELNT EQU   IOPUDATA+104                                             04989000
IOPVERNT EQU   IOPUDATA+104                                             04990000
IOPSBYNT EQU   IOPUDATA+104                                             04991000
IOPSBYNM EQU   IOPSBYNT                                                 04992000
IOPQSMNT EQU   IOPUDATA                                                 04993000
IOPQSMDR EQU   IOPQSMNT                                                 04994000
IOPQFMNT EQU   IOPUDATA                                                 04995000
IOPQFMDR EQU   IOPQFMNT                                                 04996000
IOPQFEND EQU   IOPQFMNT+2                                               04997000
IOPQFMVR EQU   IOPQFEND                                                 04998000
IOPQFMLS EQU   IOPQFMVR                                                 04999000
IOPQFMNM EQU   IOPQFMLS                                                 05000000
IOPPTSYS EQU   IOPUDATA                                                 05001000
IOPPTSDR EQU   IOPPTSYS                                                 05002000
IOPPTSFX EQU   IOPPTSYS+24                                              05003000
IOPDSSPC EQU   IOPPTSFX                                                 05004000
IOPPTFG1 EQU   IOPPTSFX+34                                              05005000
IOPPSEND EQU   IOPPTSYS+1064                                            05006000
IOPPTSVR EQU   IOPPSEND                                                 05007000
IOPPTNTR EQU   IOPPTSVR                                                 05008000
@NM00164 EQU   IOPPTNTR                                                 05009000
IOPPTFMD EQU   @NM00164                                                 05010000
IOPPTREL EQU   IOPPTFMD                                                 05011000
IOPBPDS  EQU   IOPUDATA                                                 05012000
IOPBLEP1 EQU   IOPBPDS+8                                                05013000
IOPBLEP2 EQU   IOPBPDS+9                                                05014000
@NM00168 EQU   IOPBPDS+18                                               05015000
IOPBFTB0 EQU   @NM00168                                                 05016000
IOPBFTB1 EQU   IOPBFTB0                                                 05017000
ICTENDNT EQU   ICTENDCH                                                 05018000
ICTENDIX EQU   ICTENDCH                                                 05019000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    05020000
IOPBCEND EQU   IOPBPDS+21                                               05021000
IOPBFTB3 EQU   IOPBFTB0+2                                               05022000
IOPBFTB2 EQU   IOPBFTB0+1                                               05023000
@NM00170 EQU   IOPBFTB1                                                 05024000
IOPBAPFP EQU   IOPBFTB1                                                 05025000
IOPBSSI  EQU   IOPBFTB1                                                 05026000
IOPBPAGA EQU   IOPBFTB1                                                 05027000
@NM00169 EQU   IOPBFTB1                                                 05028000
IOPBAOSL EQU   IOPBFTB1                                                 05029000
IOPBSEPA EQU   IOPBPDS+15                                               05030000
IOPBFTBL EQU   IOPBPDS+13                                               05031000
IOPBSTOR EQU   IOPBPDS+10                                               05032000
IOPBREFR EQU   IOPBLEP2                                                 05033000
IOPBLEF  EQU   IOPBLEP2                                                 05034000
IOPBTEST EQU   IOPBLEP2                                                 05035000
IOPBNE   EQU   IOPBLEP2                                                 05036000
@NM00167 EQU   IOPBLEP2                                                 05037000
IOPBDC   EQU   IOPBLEP2                                                 05038000
@NM00166 EQU   IOPBLEP1                                                 05039000
IOPBSCTR EQU   IOPBLEP1                                                 05040000
IOPBOL   EQU   IOPBLEP1                                                 05041000
@NM00165 EQU   IOPBLEP1                                                 05042000
IOPBOVLY EQU   IOPBLEP1                                                 05043000
IOPBREUS EQU   IOPBLEP1                                                 05044000
IOPBRENT EQU   IOPBLEP1                                                 05045000
IOPBNL   EQU   IOPBPDS+7                                                05046000
IOPBTTRN EQU   IOPBPDS+4                                                05047000
IOPBZERO EQU   IOPBPDS+3                                                05048000
IOPBTTRT EQU   IOPBPDS                                                  05049000
IOPPTIND EQU   IOPPTNTR+8                                               05050000
IOPPTSND EQU   IOPPTREL                                                 05051000
@NM00163 EQU   IOPPTSFX+872                                             05052000
IOPSYZPP EQU   IOPPTSFX+772                                             05053000
IOPSYZPR EQU   IOPPTSFX+771                                             05054000
IOPSYZPS EQU   IOPPTSFX+763                                             05055000
IOPSYZAP EQU   IOPPTSFX+755                                             05056000
IOPSYUPP EQU   IOPPTSFX+655                                             05057000
IOPSYUPR EQU   IOPPTSFX+654                                             05058000
IOPSYUPS EQU   IOPPTSFX+646                                             05059000
IOPSYUPD EQU   IOPPTSFX+638                                             05060000
IOPSYSPP EQU   IOPPTSFX+538                                             05061000
IOPSYSPR EQU   IOPPTSFX+537                                             05062000
IOPSYSPS EQU   IOPPTSFX+529                                             05063000
IOPSYSUP EQU   IOPPTSFX+521                                             05064000
IOPSYLKP EQU   IOPPTSFX+421                                             05065000
IOPSYLKR EQU   IOPPTSFX+420                                             05066000
IOPSYLKS EQU   IOPPTSFX+412                                             05067000
IOPSYLKD EQU   IOPPTSFX+404                                             05068000
IOPSYCPP EQU   IOPPTSFX+304                                             05069000
IOPSYCPR EQU   IOPPTSFX+303                                             05070000
IOPSYCPS EQU   IOPPTSFX+295                                             05071000
IOPSYCPY EQU   IOPPTSFX+287                                             05072000
IOPSYCOP EQU   IOPPTSFX+187                                             05073000
IOPSYCOR EQU   IOPPTSFX+186                                             05074000
IOPSYCOS EQU   IOPPTSFX+178                                             05075000
IOPSYCOM EQU   IOPPTSFX+170                                             05076000
IOPSYASP EQU   IOPPTSFX+70                                              05077000
IOPSYASR EQU   IOPPTSFX+69                                              05078000
IOPSYASS EQU   IOPPTSFX+61                                              05079000
IOPSYASM EQU   IOPPTSFX+53                                              05080000
@NM00162 EQU   IOPPTSFX+35                                              05081000
@NM00161 EQU   IOPPTFG1                                                 05082000
IOPPTSNJ EQU   IOPPTFG1                                                 05083000
IOPPTSNP EQU   IOPPTFG1                                                 05084000
IOPSYPLN EQU   IOPPTSFX+32                                              05085000
IOPDSPFX EQU   IOPPTSFX+6                                               05086000
IOPDSDIR EQU   IOPDSSPC+4                                               05087000
IOPDSSEC EQU   IOPDSSPC+2                                               05088000
IOPDSPRM EQU   IOPDSSPC                                                 05089000
@NM00160 EQU   IOPPTSDR+4                                               05090000
IOPPTPEM EQU   IOPPTSDR+2                                               05091000
IOPPCNVL EQU   IOPPTSDR+1                                               05092000
@NM00159 EQU   IOPPTSDR                                                 05093000
IOPQFMTP EQU   IOPQFMLS+8                                               05094000
@NM00158 EQU   IOPQFMLS+7                                               05095000
IOPQFMND EQU   IOPQFMNM                                                 05096000
@NM00157 EQU   IOPQFMDR                                                 05097000
@NM00153 EQU   IOPQSMDR                                                 05098000
@NM00152 EQU   IOPSBYNT+8                                               05099000
IOPSBYST EQU   IOPSBYNT+7                                               05100000
@NM00151 EQU   IOPVERNT+8                                               05101000
IOPVERST EQU   IOPVERNT+7                                               05102000
IOPVERNM EQU   IOPVERNT                                                 05103000
@NM00150 EQU   IOPDELNT+8                                               05104000
IOPDELST EQU   IOPDELNT+7                                               05105000
IOPDELNM EQU   IOPDELNT                                                 05106000
@NM00149 EQU   IOPFIDNT+8                                               05107000
IOPFIDST EQU   IOPFIDNT+7                                               05108000
IOPFIDNM EQU   IOPFIDNT                                                 05109000
@NM00148 EQU   IOPIRQNT+8                                               05110000
IOPIRQST EQU   IOPIRQNT+7                                               05111000
IOPIRQNM EQU   IOPIRQNT                                                 05112000
@NM00147 EQU   IOPREQNT+8                                               05113000
IOPREQST EQU   IOPREQNT+7                                               05114000
IOPREQNM EQU   IOPREQNT                                                 05115000
@NM00146 EQU   IOPSUPNT+8                                               05116000
IOPSUPST EQU   IOPSUPNT+7                                               05117000
IOPSUPNM EQU   IOPSUPNT                                                 05118000
@NM00145 EQU   IOPNPRNT+8                                               05119000
IOPNPRST EQU   IOPNPRNT+7                                               05120000
IOPNPRNM EQU   IOPNPRNT                                                 05121000
@NM00144 EQU   IOPPRENT+8                                               05122000
IOPPREST EQU   IOPPRENT+7                                               05123000
IOPPRENM EQU   IOPPRENT                                                 05124000
@NM00143 EQU   IOPSRLNT+8                                               05125000
IOPSRLST EQU   IOPSRLNT+7                                               05126000
@NM00142 EQU   IOPSRLNT+4                                               05127000
IOPSRLNM EQU   IOPSRLNT                                                 05128000
@NM00141 EQU   IOPENTNT+8                                               05129000
IOPENTST EQU   IOPENTNT+7                                               05130000
IOPENTNM EQU   IOPENTNT                                                 05131000
IOPPFMID EQU   IOPPTFFX+73                                              05132000
@NM00140 EQU   IOPPTPFX+24                                              05133000
IOPUCLT  EQU   IOPDATES+21                                              05134000
IOPUCLD  EQU   IOPDATES+18                                              05135000
IOPRSTT  EQU   IOPDATES+9                                               05136000
IOPRSTD  EQU   IOPDATES+6                                               05137000
IOPRECT  EQU   @NM00139+3                                               05138000
IOPRECD  EQU   @NM00139                                                 05139000
@NM00138 EQU   IOPPTFFX+8                                               05140000
@NM00137 EQU   @NM00135+7                                               05141000
IOPPRELN EQU   @NM00136                                                 05142000
@NM00134 EQU   IOPPTFDR+20                                              05143000
@NM00133 EQU   IOPPTFF3                                                 05144000
IOPFLF   EQU   IOPPTFF3                                                 05145000
IOPPMDLP EQU   IOPPTFF2+1                                               05146000
IOPPADDP EQU   IOPPTFF2+1                                               05147000
@NM00132 EQU   IOPPTFF2+1                                               05148000
IOPLRFP  EQU   IOPPTFF2                                                 05149000
IOPJCLP  EQU   IOPPTFF2                                                 05150000
IOPSUPP  EQU   IOPPTFF2                                                 05151000
IOPREQP  EQU   IOPPTFF2                                                 05152000
IOPPREP  EQU   IOPPTFF2                                                 05153000
IOPNPRP  EQU   IOPPTFF2                                                 05154000
IOPIRQP  EQU   IOPPTFF2                                                 05155000
IOPDELP  EQU   IOPPTFF2                                                 05156000
IOPBYP   EQU   IOPFLGS5                                                 05157000
@NM00131 EQU   IOPFLGS5                                                 05158000
IOPRES   EQU   IOPFLGS5                                                 05159000
@NM00130 EQU   IOPPTFDR                                                 05160000
IOPSYSTP EQU   IOPSYSTR+8                                               05161000
IOPSYSND EQU   IOPSYNTR                                                 05162000
@NM00129 EQU   IOPSYSFX+21                                              05163000
IOPSYSID EQU   IOPSYSFX+13                                              05164000
IOPNUCID EQU   IOPSYSFX+12                                              05165000
IOPSREL  EQU   IOPSYSFX+8                                               05166000
@NM00128 EQU   @NM00126+7                                               05167000
@NM00127 EQU   @NM00126                                                 05168000
@NM00125 EQU   IOPSYSDR+5                                               05169000
@NM00124 EQU   IOPFLGS7                                                 05170000
IOPSYNG  EQU   IOPFLGS7                                                 05171000
IOPSYDL  EQU   IOPFLGS7                                                 05172000
IOPSTSNP EQU   IOPFLGS7                                                 05173000
IOPMTSNP EQU   IOPFLGS7                                                 05174000
IOPPEMAX EQU   IOPSYSDR+2                                               05175000
IOPSCNVL EQU   IOPSYSDR+1                                               05176000
@NM00123 EQU   IOPSYSDR                                                 05177000
IOPDLIND EQU   IOPDNTRY+8                                               05178000
IOPDLBND EQU   IOPDSYS                                                  05179000
@NM00122 EQU   IOPDLBFX+8                                               05180000
@NM00121 EQU   @NM00119+7                                               05181000
@NM00120 EQU   @NM00119                                                 05182000
@NM00118 EQU   IOPDLBDR+1                                               05183000
@NM00117 EQU   IOPDLBDR                                                 05184000
IOPMDIND EQU   IOPMNTRY+8                                               05185000
@NM00116 EQU   IOPMODST                                                 05186000
IOPMODND EQU   IOPMODID                                                 05187000
IOPDLIB  EQU   IOPMODFX+72                                              05188000
@NM00115 EQU   IOPMODFX+12                                              05189000
@NM00114 EQU   IOPMODF4                                                 05190000
@NM00113 EQU   IOPMODF3                                                 05191000
@NM00112 EQU   IOPMODF2                                                 05192000
IOPMPAGA EQU   IOPMODF2                                                 05193000
IOPMNE   EQU   IOPMODF2                                                 05194000
@NM00111 EQU   IOPMODF1                                                 05195000
IOPMDC   EQU   IOPMODF1                                                 05196000
IOPMREFR EQU   IOPMODF1                                                 05197000
IOPMOVLY EQU   IOPMODF1                                                 05198000
IOPMSCTR EQU   IOPMODF1                                                 05199000
IOPMREUS EQU   IOPMODF1                                                 05200000
IOPMRENT EQU   IOPMODF1                                                 05201000
IOPMAPF  EQU   IOPMODF1                                                 05202000
@NM00110 EQU   @NM00108+7                                               05203000
@NM00109 EQU   @NM00108                                                 05204000
@NM00107 EQU   IOPMODDR+17                                              05205000
@NM00106 EQU   @NM00104+7                                               05206000
@NM00105 EQU   @NM00104                                                 05207000
@NM00103 EQU   @NM00100                                                 05208000
@NM00102 EQU   @NM00100                                                 05209000
@NM00101 EQU   @NM00100                                                 05210000
@NM00099 EQU   @NM00098                                                 05211000
@NM00097 EQU   IOPMODDR                                                 05212000
IOPSRIND EQU   IOPSNTRY+8                                               05213000
@NM00096 EQU   IOPSRCST                                                 05214000
IOPSRCND EQU   IOPSRCID                                                 05215000
IOPSRDLB EQU   IOPSRCFX+72                                              05216000
IOPSRSYS EQU   IOPSRCFX+64                                              05217000
@NM00095 EQU   IOPSRCFX+8                                               05218000
@NM00094 EQU   @NM00092+7                                               05219000
@NM00093 EQU   @NM00092                                                 05220000
@NM00091 EQU   IOPSRCDR+18                                              05221000
IOPSRLNG EQU   IOPSRCDR+17                                              05222000
@NM00090 EQU   @NM00088+7                                               05223000
@NM00089 EQU   @NM00088                                                 05224000
@NM00087 EQU   @NM00084                                                 05225000
@NM00086 EQU   @NM00084                                                 05226000
@NM00085 EQU   @NM00084                                                 05227000
@NM00083 EQU   @NM00082                                                 05228000
@NM00081 EQU   IOPSRCDR                                                 05229000
IOPEOFND EQU   IOPEOFNT                                                 05230000
IOPMCTYP EQU   IOPMCIND                                                 05231000
@NM00080 EQU   IOPMACST                                                 05232000
IOPMACND EQU   IOPMACID                                                 05233000
IOPMCDLB EQU   IOPMACFX+72                                              05234000
IOPMCSYS EQU   IOPMACFX+64                                              05235000
@NM00079 EQU   IOPMACFX+8                                               05236000
IOPBUTYP EQU   IOPBUNT+7                                                05237000
IOPBUSMD EQU   IOPBUNT                                                  05238000
@NM00078 EQU   IOPMACDR+18                                              05239000
IOPMCLNG EQU   IOPMACDR+17                                              05240000
IOPFMST  EQU   IOPFMIDE+7                                               05241000
IOPFMID  EQU   IOPFMIDE                                                 05242000
@NM00077 EQU   IOPRMST                                                  05243000
IOPRMASM EQU   IOPRMST                                                  05244000
@NM00076 EQU   IOPRMST                                                  05245000
IOPRMID  EQU   IOPRMIDE                                                 05246000
@NM00075 EQU   IOPMACDR                                                 05247000
IOPLMIND EQU   IOPLNTRY+8                                               05248000
IOPLMDND EQU   IOPSYSLB                                                 05249000
@NM00073 EQU   @NM00071+7                                               05250000
@NM00072 EQU   @NM00071                                                 05251000
@NM00070 EQU   IOPLMDDR+6                                               05252000
@NM00069 EQU   IOPFLGS3                                                 05253000
IOPCHREP EQU   IOPFLGS3                                                 05254000
IOPLINK  EQU   IOPFLGS3                                                 05255000
IOPCOPY  EQU   IOPFLGS3                                                 05256000
@NM00068 EQU   IOPLMDF4                                                 05257000
@NM00067 EQU   IOPLMDF3                                                 05258000
@NM00066 EQU   IOPLMDF2                                                 05259000
IOPPAGA  EQU   IOPLMDF2                                                 05260000
IOPNE    EQU   IOPLMDF2                                                 05261000
@NM00065 EQU   IOPFLGS2                                                 05262000
IOPDC    EQU   IOPFLGS2                                                 05263000
IOPREFR  EQU   IOPFLGS2                                                 05264000
IOPOVLY  EQU   IOPFLGS2                                                 05265000
IOPSCTR  EQU   IOPFLGS2                                                 05266000
IOPREUS  EQU   IOPFLGS2                                                 05267000
IOPRENT  EQU   IOPFLGS2                                                 05268000
IOPAPF   EQU   IOPFLGS2                                                 05269000
@NM00064 EQU   IOPLMDDR                                                 05270000
@NM00063 EQU   IOPASMDR+9                                               05271000
IOPABUTP EQU   IOPABUNT+7                                               05272000
IOPABUPT EQU   IOPABUNT                                                 05273000
IOPNTLVL EQU   IOPASMDR                                                 05274000
IOPALLOC EQU   @NM00062+4                                               05275000
IOPUSED  EQU   @NM00062                                                 05276000
IOPTPSEQ EQU   @NM00061+8                                               05277000
IOPVLSER EQU   @NM00061+2                                               05278000
IOPBLKSI EQU   @NM00061                                                 05279000
IOPCQMAX EQU   IOPCQMAP+12                                              05280000
@NM00060 EQU   IOPCQMAP+11                                              05281000
@NM00059 EQU   IOPCQMAP+8                                               05282000
@NM00058 EQU   IOPCQMAP                                                 05283000
IOPPTMAX EQU   IOPCDMAX                                                 05284000
@NM00057 EQU   IOPSCMAP+11                                              05285000
@NM00056 EQU   IOPSCMAP+8                                               05286000
@NM00055 EQU   IOPSCMAP                                                 05287000
IOPDIRMX EQU   IOPNTMAX+12                                              05288000
@NM00054 EQU   IOPNTMAX+11                                              05289000
@NM00053 EQU   IOPNTMAX+8                                               05290000
@NM00052 EQU   IOPNTMAX                                                 05291000
@NM00051 EQU   IOPDTYPE                                                 05292000
IOPDMOD  EQU   IOPDTYPE                                                 05293000
IOPDJCL  EQU   IOPDTYPE                                                 05294000
IOPDSRC  EQU   IOPDTYPE                                                 05295000
IOPDMAC  EQU   IOPDTYPE                                                 05296000
IOPSDIR  EQU   IOPSPACE+4                                               05297000
IOPSSCND EQU   IOPSPACE+2                                               05298000
IOPSPRIM EQU   IOPSPACE                                                 05299000
IOPDSN   EQU   IOPDYNDT                                                 05300000
IOPNTYPE EQU   IOPSTCMP+17                                              05301000
IOPNNAME EQU   IOPSTCMP+9                                               05302000
IOPOTYPE EQU   IOPSTCMP+8                                               05303000
IOPONAME EQU   IOPSTCMP                                                 05304000
IOPISEQ3 EQU   IOPINAM3+6                                               05305000
IOPITYP3 EQU   @NM00050+5                                               05306000
IOPIPTF3 EQU   @NM00050                                                 05307000
@NM00242 EQU   TBLFLG5                                                  05308000
TBLICTOK EQU   TBLFLG5                                                  05309000
@NM00241 EQU   TBLFLG4                                                  05310000
TBLBPFM  EQU   TBLFLG4                                                  05311000
@NM00240 EQU   TBLFLG4                                                  05312000
TBLBPIRQ EQU   TBLFLG4                                                  05313000
TBLBPREQ EQU   TBLFLG4                                                  05314000
TBLBPPRE EQU   TBLFLG4                                                  05315000
TBLBPID  EQU   TBLFLG4                                                  05316000
@NM00239 EQU   TBLFLG3+1                                                05317000
TBLSTS   EQU   TBLFLG3                                                  05318000
TBLMTS   EQU   TBLFLG3                                                  05319000
TBLPTS   EQU   TBLFLG3                                                  05320000
TBLACRQ  EQU   TBLFLG3                                                  05321000
TBLCRQ   EQU   TBLFLG3                                                  05322000
TBLSCDS  EQU   TBLFLG3                                                  05323000
TBLACDS  EQU   TBLFLG3                                                  05324000
TBLCDS   EQU   TBLFLG3                                                  05325000
TBLMASS  EQU   TBLFLG2                                                  05326000
@NM00238 EQU   TBLFLG2                                                  05327000
TBLFMID  EQU   TBLFLG2                                                  05328000
TBLGROUP EQU   TBLFLG2                                                  05329000
TBLEXC   EQU   TBLFLG2                                                  05330000
TBLSEL   EQU   TBLFLG2                                                  05331000
@NM00237 EQU   TBLFLG1+1                                                05332000
TBLDISW  EQU   TBLFLG1+1                                                05333000
TBLDISR  EQU   TBLFLG1+1                                                05334000
TBLDISN  EQU   TBLFLG1+1                                                05335000
TBLNOJCL EQU   TBLFLG1                                                  05336000
TBLFLUSH EQU   TBLFLG1                                                  05337000
TBLUSER  EQU   TBLFLG1                                                  05338000
TBLAPAR  EQU   TBLFLG1                                                  05339000
TBLCOMP  EQU   TBLFLG1                                                  05340000
TBLASSEM EQU   TBLFLG1                                                  05341000
TBLCHECK EQU   TBLFLG1                                                  05342000
@NM00236 EQU   TBLXOPTS+5                                               05343000
TBLNUCID EQU   TBLXOPTS+4                                               05344000
TBLJCLGT EQU   TBLXOPTS                                                 05345000
TBLXEND0 EQU   TBLXPARM+124                                             05346000
@NM00235 EQU   TBLXPARM+108                                             05347000
TBLXIOP3 EQU   TBLXPARM+104                                             05348000
TBLXD2GT EQU   TBLXPARM+100                                             05349000
TBLXDLGT EQU   TBLXPARM+96                                              05350000
@NM00234 EQU   TBLXRC+3                                                 05351000
TBLXIRC  EQU   TBLXRC+2                                                 05352000
TBLXLRC  EQU   TBLXRC+1                                                 05353000
TBLXTRC  EQU   TBLXRC                                                   05354000
TBLXIBGN EQU   TBLXPARM+88                                              05355000
TBLXTSLP EQU   TBLXPARM+84                                              05356000
@NM00233 EQU   TBLXPARM+83                                              05357000
@NM00232 EQU   TBLXPARM+82                                              05358000
@NM00231 EQU   TBLXPARM+81                                              05359000
@NM00230 EQU   TBLXFLG1                                                 05360000
TBLXTCRC EQU   TBLXFLG1                                                 05361000
TBLXFUND EQU   TBLXPARM+72                                              05362000
TBLXFUNC EQU   TBLXPARM+64                                              05363000
@NM00229 EQU   TBLXPARM+62                                              05364000
TBLXCRQI EQU   TBLXPARM+61                                              05365000
TBLXCDSI EQU   TBLXPARM+60                                              05366000
TBLXLMGT EQU   TBLXPARM+56                                              05367000
TBLXSCGT EQU   TBLXPARM+52                                              05368000
TBLXSREL EQU   TBLXPARM+48                                              05369000
TBLXASGT EQU   TBLXPARM+44                                              05370000
TBLXIFGT EQU   TBLXPARM+40                                              05371000
TBLXNULL EQU   TBLXPARM+36                                              05372000
TBLXTOP  EQU   TBLXPARM+32                                              05373000
TBLXSEGT EQU   TBLXPARM+24                                              05374000
TBLXIOPF EQU   TBLXPARM+20                                              05375000
TBLXIOP2 EQU   TBLXPARM+16                                              05376000
TBLXEND  EQU   TBLXINDX+8                                               05377000
TBLXSTRT EQU   TBLXINDX+4                                               05378000
TBLXCUR  EQU   TBLXINDX                                                 05379000
TBLXHDR  EQU   TBLXPARM                                                 05380000
SPLIFIL  EQU   SPLODSN+33                                               05381000
SPLISMD  EQU   SPLODSN+26                                               05382000
SPLIPFX  EQU   SPLODSN                                                  05383000
SPLIUNPK EQU   SPLPUNPK+8                                               05384000
SPLOUNPK EQU   SPLPUNPK                                                 05385000
SPLOPACK EQU   SPLPPACK+8                                               05386000
SPLIPACK EQU   SPLPPACK                                                 05387000
@NM00224 EQU   ICTLMOD+38                                               05388000
ICTLTTR  EQU   ICTLMOD+31                                               05389000
ICTTG2   EQU   ICTLMOD+23                                               05390000
ICTTG1   EQU   ICTLMOD+15                                               05391000
@NM00223 EQU   ICTLFLG3                                                 05392000
ICTLZAP  EQU   ICTLFLG3                                                 05393000
ICTLLKD  EQU   ICTLFLG3                                                 05394000
ICTLCPY  EQU   ICTLFLG3                                                 05395000
ICTLXPND EQU   ICTLFLG3                                                 05396000
ICTTIND2 EQU   ICTLFLG3                                                 05397000
ICTTIND1 EQU   ICTLFLG3                                                 05398000
@NM00222 EQU   ICTLFLG2                                                 05399000
ICTLDEL  EQU   ICTLFLG2                                                 05400000
@NM00221 EQU   ICTLFLG2                                                 05401000
ICTLTDEL EQU   ICTLFLG2                                                 05402000
ICTLINK  EQU   ICTLFLG2                                                 05403000
ICTCOPY  EQU   ICTLFLG2                                                 05404000
@NM00220 EQU   ICTLFLG7                                                 05405000
@NM00219 EQU   ICTLFLG6                                                 05406000
@NM00218 EQU   ICTLFLG5                                                 05407000
ICTLPAGA EQU   ICTLFLG5                                                 05408000
ICTLNE   EQU   ICTLFLG5                                                 05409000
@NM00217 EQU   ICTLFLG1                                                 05410000
ICTLDC   EQU   ICTLFLG1                                                 05411000
ICTLREFR EQU   ICTLFLG1                                                 05412000
ICTLOVLY EQU   ICTLFLG1                                                 05413000
ICTLSCTR EQU   ICTLFLG1                                                 05414000
ICTLREUS EQU   ICTLFLG1                                                 05415000
ICTLRENT EQU   ICTLFLG1                                                 05416000
ICTLAPF  EQU   ICTLFLG1                                                 05417000
@NM00216 EQU   ICTLFLG4                                                 05418000
ICTLPASS EQU   ICTLFLG4                                                 05419000
ICTLDDCK EQU   ICTLFLG4                                                 05420000
ICTLMSG  EQU   ICTLFLG4                                                 05421000
@NM00215 EQU   ICTMUMNT+7                                               05422000
ICTMUMND EQU   ICTMUMNM                                                 05423000
@NM00214 EQU   ICTMVRNT+7                                               05424000
ICTMVRND EQU   ICTMVRNM                                                 05425000
ICTTALND EQU   ICTTALNM                                                 05426000
ICTASMND EQU   ICTASMAD                                                 05427000
ICTMIDTY EQU   ICTMODST                                                 05428000
ICTMIDAM EQU   ICTMODST                                                 05429000
ICTMIDRG EQU   ICTMODST                                                 05430000
ICTMIDF1 EQU   ICTMODST                                                 05431000
ICTMIDPL EQU   ICTMODST                                                 05432000
ICTMIDPS EQU   ICTMODST                                                 05433000
@NM00213 EQU   ICTMODST                                                 05434000
ICTMIDND EQU   ICTMODID                                                 05435000
@NM00212 EQU   ICTMOD+128                                               05436000
ICTMICHA EQU   ICTMOD+108                                               05437000
@NM00211 EQU   ICTMOD+95                                                05438000
ICTMFMID EQU   ICTMOD+88                                                05439000
@NM00210 EQU   ICTMOD+87                                                05440000
ICTMRMID EQU   ICTMOD+80                                                05441000
ICTMSSI  EQU   ICTMOD+72                                                05442000
ICTMDOBJ EQU   ICTMOD+64                                                05443000
ICTMSYSL EQU   ICTMOD+56                                                05444000
ICTMDSTL EQU   ICTMOD+48                                                05445000
ICTMASLB EQU   ICTMOD+40                                                05446000
ICTTOLIB EQU   ICTMOD+32                                                05447000
ICTFMLIB EQU   ICTMOD+24                                                05448000
ICTMRELN EQU   ICTMOD+22                                                05449000
@NM00209 EQU   ICTMOD+21                                                05450000
ICTMLANG EQU   ICTMOD+20                                                05451000
@NM00208 EQU   ICTMOD+19                                                05452000
ICTMACF5 EQU   ICTMOD+18                                                05453000
ICTMZMPR EQU   ICTMACF4                                                 05454000
ICTMZOMZ EQU   ICTMACF4                                                 05455000
ICTMDOAS EQU   ICTMACF4                                                 05456000
ICTMXUPD EQU   ICTMACF4                                                 05457000
ICTMFXC  EQU   ICTMACF4                                                 05458000
ICTMFXBS EQU   ICTMACF4                                                 05459000
ICTMHASM EQU   ICTMACF4                                                 05460000
ICTMACDL EQU   ICTMACF4                                                 05461000
@NM00207 EQU   ICTMLEP4                                                 05462000
@NM00206 EQU   ICTMLEP3                                                 05463000
@NM00205 EQU   ICTMLEP2                                                 05464000
ICTMPAGA EQU   ICTMLEP2                                                 05465000
ICTMNE   EQU   ICTMLEP2                                                 05466000
@NM00204 EQU   ICTMLEP1                                                 05467000
ICTMDC   EQU   ICTMLEP1                                                 05468000
ICTMREFR EQU   ICTMLEP1                                                 05469000
ICTMOVLY EQU   ICTMLEP1                                                 05470000
ICTMSCTR EQU   ICTMLEP1                                                 05471000
ICTMREUS EQU   ICTMLEP1                                                 05472000
ICTMRENT EQU   ICTMLEP1                                                 05473000
ICTMAPF  EQU   ICTMLEP1                                                 05474000
@NM00203 EQU   ICTMFLG5                                                 05475000
ICTMCOPY EQU   ICTMFLG5                                                 05476000
ICTMPASS EQU   ICTMFLG5                                                 05477000
@NM00202 EQU   ICTMFLG4                                                 05478000
ICTMTSEL EQU   ICTMFLG4                                                 05479000
ICTMDSTE EQU   ICTMFLG4                                                 05480000
ICTMMIDE EQU   ICTMFLG4                                                 05481000
ICTMASOC EQU   ICTMFLG4                                                 05482000
@NM00201 EQU   ICTMFLG3                                                 05483000
ICTMPRMS EQU   ICTMFLG3                                                 05484000
ICTMALIS EQU   ICTMFLG3                                                 05485000
ICTMWRK  EQU   ICTMFLG3                                                 05486000
ICTMTRX  EQU   ICTMFLG3                                                 05487000
ICTMRELF EQU   ICTMFLG3                                                 05488000
ICTLIBTX EQU   ICTMFLG3                                                 05489000
ICTLIBLK EQU   ICTMFLG3                                                 05490000
@NM00200 EQU   ICTMFLG2                                                 05491000
@NM00199 EQU   ICTMFLG2                                                 05492000
ICTMMIDU EQU   ICTMFLG2                                                 05493000
ICTMDEL  EQU   ICTMFLG2                                                 05494000
ICTMMSG  EQU   ICTMFLG2                                                 05495000
@NM00198 EQU   ICTSBYNT+7                                               05496000
ICTSBYND EQU   ICTSBYNM                                                 05497000
ICTDELEX EQU   ICTDELST                                                 05498000
@NM00197 EQU   ICTVRSNT+7                                               05499000
ICTVRSND EQU   ICTVRSNM                                                 05500000
@NM00196 EQU   ICTNPRNT+7                                               05501000
ICTNPRND EQU   ICTNPRNM                                                 05502000
@NM00195 EQU   ICTCSRST                                                 05503000
@NM00194 EQU   ICTCSRST                                                 05504000
ICTCSRF  EQU   ICTCSRST                                                 05505000
@NM00193 EQU   ICTCSRST                                                 05506000
ICTCSRNM EQU   ICTIRQNT+8                                               05507000
@NM00192 EQU   ICTIRQST                                                 05508000
ICTIREQT EQU   ICTIRQST                                                 05509000
ICTIREQI EQU   ICTIRQST                                                 05510000
ICTIREQB EQU   ICTIRQST                                                 05511000
ICTIREQS EQU   ICTIRQST                                                 05512000
@NM00191 EQU   ICTIRQST                                                 05513000
ICTIRQND EQU   ICTIRQNM                                                 05514000
@NM00190 EQU   ICTPREST                                                 05515000
ICTPREQT EQU   ICTPREST                                                 05516000
ICTPREQI EQU   ICTPREST                                                 05517000
ICTPREQB EQU   ICTPREST                                                 05518000
ICTPREQS EQU   ICTPREST                                                 05519000
@NM00189 EQU   ICTPREST                                                 05520000
ICTPREND EQU   ICTPRENM                                                 05521000
@NM00188 EQU   ICTSUPNT+7                                               05522000
@NM00187 EQU   ICTREQST                                                 05523000
ICTRREQT EQU   ICTREQST                                                 05524000
ICTRREQI EQU   ICTREQST                                                 05525000
ICTRREQB EQU   ICTREQST                                                 05526000
ICTRREQS EQU   ICTREQST                                                 05527000
@NM00186 EQU   ICTREQST                                                 05528000
ICTREQND EQU   ICTREQNM                                                 05529000
@NM00185 EQU   ICTENTST                                                 05530000
ICTEREQI EQU   ICTENTST                                                 05531000
ICTEREQS EQU   ICTENTST                                                 05532000
@NM00184 EQU   ICTENTST                                                 05533000
@NM00183 EQU   ICTPTF+100                                               05534000
ICTPRECT EQU   ICTPTF+33                                                05535000
ICTPRECD EQU   ICTPTF+30                                                05536000
ICTPVERN EQU   ICTPTF+29                                                05537000
ICTPUSR8 EQU   ICTPFLGA                                                 05538000
ICTPUSR7 EQU   ICTPFLGA                                                 05539000
ICTPUSR6 EQU   ICTPFLGA                                                 05540000
ICTPUSR5 EQU   ICTPFLGA                                                 05541000
ICTPUSR4 EQU   ICTPFLGA                                                 05542000
ICTPUSR3 EQU   ICTPFLGA                                                 05543000
ICTPUSR2 EQU   ICTPFLGA                                                 05544000
ICTPPASS EQU   ICTPUSR1                                                 05545000
@NM00182 EQU   @NM00181                                                 05546000
ICTPRQBY EQU   @NM00181                                                 05547000
ICTPRQOK EQU   @NM00181                                                 05548000
ICTPRQCK EQU   @NM00181                                                 05549000
@NM00180 EQU   ICTPFLG9                                                 05550000
ICTPWRKO EQU   ICTPFLG9                                                 05551000
ICTPMSL  EQU   ICTPFLG9                                                 05552000
@NM00179 EQU   ICTPFLG8                                                 05553000
@NM00178 EQU   ICTPFLG4                                                 05554000
@NM00177 EQU   ICTPFLG4                                                 05555000
@NM00176 EQU   ICTPFLG4                                                 05556000
ICTPGELM EQU   ICTPFLG4                                                 05557000
ICTPREDO EQU   ICTPFLG4                                                 05558000
@NM00175 EQU   ICTPFLG2                                                 05559000
ICTPRCND EQU   ICTPFLG2                                                 05560000
ICTPTPS  EQU   ICTPFLG2                                                 05561000
ICTPTR1  EQU   ICTPFLG2                                                 05562000
ICTPVRSP EQU   ICTPFLG2                                                 05563000
@NM00174 EQU   ICTPFLG6                                                 05564000
ICTFLF   EQU   ICTPFLF                                                  05565000
ICTPDBYP EQU   ICTPFLG6                                                 05566000
ICTPSBYP EQU   ICTPFLG6                                                 05567000
@NM00173 EQU   ICTPFLG5+1                                               05568000
ICTPLRFP EQU   ICTPFLG5                                                 05569000
ICTPSUPP EQU   ICTPFLG5                                                 05570000
ICTPREQP EQU   ICTPFLG5                                                 05571000
ICTPPREP EQU   ICTPFLG5                                                 05572000
ICTPNPRP EQU   ICTPFLG5                                                 05573000
ICTPIRQP EQU   ICTPFLG5                                                 05574000
@NM00172 EQU   ICTPFLG3                                                 05575000
ICTPSLST EQU   ICTPFLG3                                                 05576000
ICTPNOLB EQU   ICTPFLG3                                                 05577000
ICTPVERJ EQU   ICTPFLG3                                                 05578000
ICTPROCS EQU   ICTPPROC                                                 05579000
ICTREGEN EQU   ICTPFLG1                                                 05580000
ICTBYP   EQU   ICTPFLG1                                                 05581000
ICTDUMMP EQU   ICTPFLG1                                                 05582000
@NM00171 EQU   ICTPFLG1                                                 05583000
ICTACC   EQU   ICTPFLG1                                                 05584000
ICTRES   EQU   ICTPFLG1                                                 05585000
ICTAPP   EQU   ICTPFLG1                                                 05586000
ICTLEN   EQU   ICTGMSPL+1                                               05587000
ICTSP    EQU   ICTGMSPL                                                 05588000
ICTLLEN  EQU   ICTLSPLN+1                                               05589000
ICTLSP   EQU   ICTLSPLN                                                 05590000
ICTMLEN  EQU   ICTMSPLN+1                                               05591000
ICTMSP   EQU   ICTMSPLN                                                 05592000
ICTPLEN  EQU   ICTPSPLN+1                                               05593000
ICTPSP   EQU   ICTPSPLN                                                 05594000
IOPBS04E EQU   IOPBS04+2                                                05595000
IOPBAPFC EQU   IOPBAPF+1                                                05596000
IOPBAPFL EQU   IOPBAPF                                                  05597000
IOPBS2NM EQU   IOPBS02+3                                                05598000
IOPBS2EP EQU   IOPBS02                                                  05599000
IOPQSMTP EQU   IOPQSMLS+8                                               05600000
@NM00156 EQU   IOPQSMLS+7                                               05601000
IOPQSMND EQU   IOPQSMNM                                                 05602000
@NM00155 EQU   @NM00154+7                                               05603000
IOPQSMFM EQU   @NM00154                                                 05604000
@NM00074 EQU   IOPLMCTL+17                                              05605000
IOPLMCRD EQU   IOPLMCTL+9                                               05606000
IOPLMCRN EQU   IOPLMCTL+1                                               05607000
IOPLMCC  EQU   IOPLMCTL                                                 05608000
@NM00049 EQU   IOPUSERL                                                 05609000
@NM00048 EQU   IOPUSERL                                                 05610000
IOPALIS  EQU   IOPUSERL                                                 05611000
IOPTTR   EQU   IOPDRMAP+8                                               05612000
IOPINAM2 EQU   IOPINAM+1                                                05613000
IOPITYP2 EQU   IOPITYP                                                  05614000
@NM00047 EQU   HMASMIOP+32                                              05615000
IOPDELDD EQU   IOPDDNAM                                                 05616000
@NM00046 EQU   @NM00043+10                                              05617000
IOPSEQNO EQU   @NM00043+8                                               05618000
@NM00045 EQU   @NM00044+7                                               05619000
IOPPTFNM EQU   @NM00044                                                 05620000
CCABMREC EQU   CCABELMT+10                                              05621000
CCABPOS  EQU   CCABMPOS+8                                               05622000
CCABNAME EQU   CCABMPOS                                                 05623000
@NM00042 EQU   CCABLDLM+2                                               05624000
@NM00041 EQU   CCABLDLM                                                 05625000
CCAUPDPM EQU   @NM00039+24                                              05626000
@NM00040 EQU   @NM00039+21                                              05627000
CCARUPDT EQU   CCAUPDRC                                                 05628000
CCAUPDSP EQU   @NM00039+12                                              05629000
CCAUPDTE EQU   @NM00039+8                                               05630000
CCAUPDNM EQU   @NM00039                                                 05631000
CCASUPPM EQU   @NM00037+24                                              05632000
@NM00038 EQU   @NM00037+21                                              05633000
CCARSUP  EQU   CCASUPRC                                                 05634000
CCASUPSP EQU   @NM00037+12                                              05635000
CCAIOSUP EQU   @NM00037+8                                               05636000
CCASUPNM EQU   @NM00037                                                 05637000
CCAZAPPM EQU   @NM00035+24                                              05638000
@NM00036 EQU   @NM00035+21                                              05639000
CCARZAP  EQU   CCAZAPRC                                                 05640000
CCAZAPSP EQU   @NM00035+12                                              05641000
CCASPZAP EQU   @NM00035+8                                               05642000
CCAZAPNM EQU   @NM00035                                                 05643000
CCACOMPM EQU   @NM00033+24                                              05644000
@NM00034 EQU   @NM00033+21                                              05645000
CCARCOMP EQU   CCACOMRC                                                 05646000
CCACOMSP EQU   @NM00033+12                                              05647000
CCACOMRS EQU   @NM00033+8                                               05648000
CCACOMNM EQU   @NM00033                                                 05649000
CCACPYPM EQU   @NM00031+24                                              05650000
@NM00032 EQU   @NM00031+21                                              05651000
CCARCOPY EQU   CCACPYRC                                                 05652000
CCACPYSP EQU   @NM00031+12                                              05653000
CCACOPY  EQU   @NM00031+8                                               05654000
CCACPYNM EQU   @NM00031                                                 05655000
CCAASMPM EQU   @NM00029+24                                              05656000
@NM00030 EQU   @NM00029+21                                              05657000
CCARASM  EQU   CCAASMRC                                                 05658000
CCAASMSP EQU   @NM00029+12                                              05659000
CCAASM   EQU   @NM00029+8                                               05660000
CCAASMNM EQU   @NM00029                                                 05661000
CCALKDPM EQU   @NM00027+24                                              05662000
@NM00028 EQU   @NM00027+21                                              05663000
CCARLINK EQU   CCALKDRC                                                 05664000
CCALKDSP EQU   @NM00027+12                                              05665000
CCALKED  EQU   @NM00027+8                                               05666000
CCALKDNM EQU   @NM00027                                                 05667000
CCAPGMPM EQU   @NM00025+24                                              05668000
@NM00026 EQU   @NM00025+21                                              05669000
CCABPGRC EQU   @NM00025+20                                              05670000
CCABPGSP EQU   @NM00025+12                                              05671000
CCABPGAD EQU   @NM00025+8                                               05672000
CCABPGNM EQU   @NM00025                                                 05673000
CCAEND   EQU   HMASMCCA+371                                             05674000
@NM00024 EQU   HMASMCCA+309                                             05675000
CCACURDD EQU   CCAFDSNG+3                                               05676000
CCACURDS EQU   CCAFDSNG+2                                               05677000
@NM00023 EQU   CCAFLAGB                                                 05678000
CCAOUTNG EQU   CCAFLAGB                                                 05679000
CCALOGNG EQU   CCAFLAGB                                                 05680000
CCAFMID  EQU   HMASMCCA+291                                             05681000
CCALSTDS EQU   CCAFCTL+8                                                05682000
CCARPTDS EQU   CCAFCTL+7                                                05683000
CCATIME  EQU   CCAFCTL+4                                                05684000
@NM00022 EQU   CCAFLAG9                                                 05685000
CCARVCAN EQU   CCAFLAG9                                                 05686000
CCARVEST EQU   CCAFLAG9                                                 05687000
CCASTSNP EQU   CCAFLAG9                                                 05688000
CCAMTSNP EQU   CCAFLAG9                                                 05689000
@NM00021 EQU   CCAFLAG8                                                 05690000
CCAACDSC EQU   CCAFLAG8                                                 05691000
CCACDSC  EQU   CCAFLAG8                                                 05692000
@NM00020 EQU   CCAFLAG6                                                 05693000
CCAACRUP EQU   CCAFLAG6                                                 05694000
CCACRQUP EQU   CCAFLAG6                                                 05695000
CCAACDUP EQU   CCAFLAG6                                                 05696000
CCACDSUP EQU   CCAFLAG6                                                 05697000
@NM00019 EQU   CCAFLAG5                                                 05698000
CCAACROS EQU   CCAFLAG5                                                 05699000
CCACRQOS EQU   CCAFLAG5                                                 05700000
CCAACDOS EQU   CCAFLAG5                                                 05701000
CCACDSOS EQU   CCAFLAG5                                                 05702000
@NM00018 EQU   CCAFLAG4                                                 05703000
CCAACRIS EQU   CCAFLAG4                                                 05704000
CCACRQIS EQU   CCAFLAG4                                                 05705000
CCAACDIS EQU   CCAFLAG4                                                 05706000
CCACDSIS EQU   CCAFLAG4                                                 05707000
@NM00017 EQU   CCAFLAG3+1                                               05708000
CCARGNP  EQU   CCAFLAG3+1                                               05709000
CCADISRQ EQU   CCAFLAG3+1                                               05710000
CCAICTOK EQU   CCAFLAG3                                                 05711000
CCADELP  EQU   CCAFLAG3                                                 05712000
CCACMPRS EQU   CCAFLAG3                                                 05713000
CCAZAPP  EQU   CCAFLAG3                                                 05714000
CCALINKP EQU   CCAFLAG3                                                 05715000
CCACOPYP EQU   CCAFLAG3                                                 05716000
CCAASIP  EQU   CCAFLAG3                                                 05717000
CCAUPDP  EQU   CCAFLAG3                                                 05718000
CCAEOSMP EQU   CCAFLAG2                                                 05719000
CCAEOFNC EQU   CCAFLAG2                                                 05720000
@NM00016 EQU   CCAFLAG2                                                 05721000
CCACHECK EQU   CCAFLAG2                                                 05722000
CCATERM  EQU   CCAFLAG2                                                 05723000
CCASVCLB EQU   CCAFLAG2                                                 05724000
CCANCPTF EQU   CCAFLAG2                                                 05725000
@NM00015 EQU   CCAFLAG1+1                                               05726000
CCAUNL   EQU   CCAFLAG1+1                                               05727000
CCARESET EQU   CCAFLAG1+1                                               05728000
CCALOG   EQU   CCAFLAG1+1                                               05729000
CCACNV   EQU   CCAFLAG1+1                                               05730000
CCALIST  EQU   CCAFLAG1                                                 05731000
CCAUPDU  EQU   CCAFLAG1                                                 05732000
CCAUPDJ  EQU   CCAFLAG1                                                 05733000
CCAREJ   EQU   CCAFLAG1                                                 05734000
CCAREC   EQU   CCAFLAG1                                                 05735000
@NM00014 EQU   @NM00009+18                                              05736000
@NM00013 EQU   @NM00009+16                                              05737000
@NM00012 EQU   @NM00009+8                                               05738000
@NM00011 EQU   @NM00009+4                                               05739000
@NM00010 EQU   @NM00009                                                 05740000
CCAIFGTP EQU   CCAFGTP+16                                               05741000
CCAGTP3  EQU   CCAFGTP+12                                               05742000
CCAGTP2  EQU   CCAFGTP+8                                                05743000
CCAGTP1  EQU   CCAFGTP+4                                                05744000
CCASETAD EQU   CCASEGTP                                                 05745000
CCACLST  EQU   CCAFPGM+12                                               05746000
CCASPDCB EQU   CCAFPGM+8                                                05747000
CCARVAD  EQU   CCAFSTA                                                  05748000
CCALNLEN EQU   CCAFSYS+22                                               05749000
@NM00008 EQU   CCAFLAGA                                                 05750000
CCAPSYSF EQU   CCAFLAGA                                                 05751000
CCAASYSF EQU   CCAFLAGA                                                 05752000
CCACSYSF EQU   CCAFLAGA                                                 05753000
CCANUCID EQU   CCAFSYS+20                                               05754000
CCAASREL EQU   CCAFSYS+16                                               05755000
CCACSREL EQU   CCASREL                                                  05756000
CCAPEMAX EQU   CCAFSYS+10                                               05757000
CCAPGLEN EQU   CCAFSYS+8                                                05758000
CCAIOPAS EQU   CCAFSYS+4                                                05759000
CCAIOPCS EQU   CCAFSYS                                                  05760000
CCAPESIZ EQU   CCAFIOP+4                                                05761000
@NM00007 EQU   CCAFLAG7+3                                               05762000
CCALOGP  EQU   CCAFLAG7+2                                               05763000
CCAOUTP  EQU   CCAFLAG7+2                                               05764000
CCASLBP  EQU   CCAFLAG7+2                                               05765000
CCARPTP  EQU   CCAFLAG7+2                                               05766000
CCALISTP EQU   CCAFLAG7+2                                               05767000
CCAJCLP  EQU   CCAFLAG7+2                                               05768000
CCAPTFP  EQU   CCAFLAG7+2                                               05769000
CCATLBP  EQU   CCAFLAG7+2                                               05770000
CCAUT3P  EQU   CCAFLAG7+1                                               05771000
CCAUT2P  EQU   CCAFLAG7+1                                               05772000
CCAUT1P  EQU   CCAFLAG7+1                                               05773000
CCAWK5P  EQU   CCAFLAG7+1                                               05774000
CCAWK4P  EQU   CCAFLAG7+1                                               05775000
CCAWK3P  EQU   CCAFLAG7+1                                               05776000
CCAWK2P  EQU   CCAFLAG7+1                                               05777000
CCAWK1P  EQU   CCAFLAG7+1                                               05778000
CCAACRQP EQU   CCAFLAG7                                                 05779000
CCACRQP  EQU   CCAFLAG7                                                 05780000
CCASTSP  EQU   CCAFLAG7                                                 05781000
CCAMTSP  EQU   CCAFLAG7                                                 05782000
CCAPTSP  EQU   CCAFLAG7                                                 05783000
CCASCDSP EQU   CCAFLAG7                                                 05784000
CCAACDSP EQU   CCAFLAG7                                                 05785000
CCACDSP  EQU   CCAFLAG7                                                 05786000
@NM00006 EQU   CCAFBUFR+122                                             05787000
@NM00005 EQU   CCAFBUFR+120                                             05788000
@NM00004 EQU   CCAFBUFR+118                                             05789000
CCATBFMX EQU   CCAFBUFR+116                                             05790000
CCA4BFMX EQU   CCAFBUFR+114                                             05791000
CCA3BFMX EQU   CCAFBUFR+112                                             05792000
CCA2BFMX EQU   CCAFBUFR+110                                             05793000
CCA1BFMX EQU   CCAFBUFR+108                                             05794000
CCAXBFMX EQU   CCAFBUFR+106                                             05795000
CCAQBFMX EQU   CCAFBUFR+104                                             05796000
CCASBFMX EQU   CCAFBUFR+102                                             05797000
CCAMBFMX EQU   CCAFBUFR+100                                             05798000
CCAPBFMX EQU   CCAFBUFR+98                                              05799000
CCAVBFMX EQU   CCAFBUFR+96                                              05800000
CCAABFMX EQU   CCAFBUFR+94                                              05801000
CCACBFMX EQU   CCAFBUFR+92                                              05802000
@NM00003 EQU   CCAFBUFR+88                                              05803000
@NM00002 EQU   CCAFBUFR+84                                              05804000
CCA4BFSZ EQU   CCAFBUFR+80                                              05805000
CCATBFSZ EQU   CCAFBUFR+76                                              05806000
CCAWBFSZ EQU   CCAFBUFR+72                                              05807000
CCAQBFSZ EQU   CCAFBUFR+68                                              05808000
CCAPBFSZ EQU   CCAFBUFR+64                                              05809000
CCAVBFSZ EQU   CCAFBUFR+60                                              05810000
CCACBFSZ EQU   CCAFBUFR+56                                              05811000
@NM00001 EQU   CCAFBUFR+52                                              05812000
CCA4BFOA EQU   CCAFBUFR+48                                              05813000
CCA4BFIA EQU   CCAFBUFR+44                                              05814000
CCATBFIA EQU   CCAFBUFR+40                                              05815000
CCAWBFOA EQU   CCAFBUFR+36                                              05816000
CCAWBFIA EQU   CCAFBUFR+32                                              05817000
CCAQBFOA EQU   CCAFBUFR+28                                              05818000
CCAQBFIA EQU   CCAFBUFR+24                                              05819000
CCAPBFOA EQU   CCAFBUFR+20                                              05820000
CCAPBFIA EQU   CCAFBUFR+16                                              05821000
CCAVBFOA EQU   CCAFBUFR+12                                              05822000
CCAVBFIA EQU   CCAFBUFR+8                                               05823000
CCACBFOA EQU   CCAFBUFR+4                                               05824000
CCACBFIA EQU   CCAFBUFR                                                 05825000
CCAID    EQU   HMASMCCA                                                 05826000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      05827000
@RF00413 EQU   @RC00411                                                 05828000
@RF00417 EQU   @RC00411                                                 05829000
@RC00465 EQU   @RC00463                                                 05830000
@RF00528 EQU   @RC00526                                                 05831000
@RF00634 EQU   @RC00630                                                 05832000
@RF00799 EQU   @RC00797                                                 05833000
@RF00820 EQU   @RC00781                                                 05834000
@RF00885 EQU   @RC00878                                                 05835000
@RF01017 EQU   @RC01013                                                 05836000
@RF01010 EQU   @RC00991                                                 05837000
@ENDDATA EQU   *                                                        05838000
         END   HMASMCPL,(C'PLS1957',0802,78334)                         05839000
