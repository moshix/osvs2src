         TITLE 'HMASMDLE - ELEMENT/LMOD DELETE PROCESSOR'               00001000
HMASMDLE CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'HMASMDLE  78.334'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00009000
         BALR  @12,0                                               0001 00010000
@PSTART  LA    @10,4095(,@12)                                      0001 00011000
         USING @PSTART,@12                                         0001 00012000
         USING @PSTART+4095,@10                                    0001 00013000
         ST    @13,@SA00001+4                                      0001 00014000
         LA    @14,@SA00001                                        0001 00015000
         ST    @14,8(,@13)                                         0001 00016000
         LR    @13,@14                                             0001 00017000
*                                                                  0207 00018000
*   /*****************************************************************/ 00019000
*   /*                                                               */ 00020000
*   /* MAIN MODULE SEGMENT                                           */ 00021000
*   /*                                                               */ 00022000
*   /*****************************************************************/ 00023000
*                                                                  0207 00024000
*   HIGHDLE=0;                      /* CLEAR RETURN CODE COLLECTOR   */ 00025000
         SLR   HIGHDLE,HIGHDLE                                     0207 00026000
*   IOPPTR=CCAIOPTR;                /* POINT TO GENERAL-USE IOP      */ 00027000
         MVC   IOPPTR(4),CCAIOPTR(CCAPTR)                          0208 00028000
*   LOCALIOP=ADDR(LOCIOP);          /* POINT TO LOCAL IOP            */ 00029000
         LA    LOCALIOP,LOCIOP                                     0209 00030000
*   DLEFLAGS=''B;                   /* CLEAR LOCAL FLAGS             */ 00031000
         MVI   DLEFLAGS,X'00'                                      0210 00032000
*   HMASMGTP(1)=''B;                /* CLEAR SELECT LIST GTP         */ 00033000
         XC    HMASMGTP(28),HMASMGTP                               0211 00034000
*   HMASMGTP(2)=''B;                /* CLEAR LMOD-TO-MOD GTP         */ 00035000
         XC    HMASMGTP+28(28),HMASMGTP+28                         0212 00036000
*   HMASMGTP(3)=''B;                /* CLEAR TST GTP                 */ 00037000
*                                                                  0213 00038000
         XC    HMASMGTP+56(28),HMASMGTP+56                         0213 00039000
*   /*****************************************************************/ 00040000
*   /*                                                               */ 00041000
*   /* INITIALIZE TST GTP                                            */ 00042000
*   /*                                                               */ 00043000
*   /*****************************************************************/ 00044000
*                                                                  0214 00045000
*   GTPRCDLN(3)=LENGTH(TSTRCRD);    /* RECORD LENGTH                 */ 00046000
         LA    @15,16                                              0214 00047000
         STH   @15,GTPRCDLN+56                                     0214 00048000
*   GTPKEYLN(3)=LENGTH(TSTRCRD);    /* KEY LENGTH                    */ 00049000
         STH   @15,GTPKEYLN+56                                     0215 00050000
*   GTPBUFAD(3)=ADDR(TSTRCRD);      /* BUFFER ADDRESS                */ 00051000
         LA    @15,TSTRCRD                                         0216 00052000
         ST    @15,GTPBUFAD+56                                     0216 00053000
*   GTPPSIZE(3)=GTP512B;            /* PAGE SIZE                     */ 00054000
         NI    GTPPSIZE+56,B'11111001'                             0217 00055000
         OI    GTPPSIZE+56,B'00000001'                             0217 00056000
*                                                                  0218 00057000
*   /*****************************************************************/ 00058000
*   /*                                                               */ 00059000
*   /* GO THRU THE ICT PTF SECTION                                   */ 00060000
*   /*                                                               */ 00061000
*   /*****************************************************************/ 00062000
*                                                                  0218 00063000
*   RESPECIFY                                                      0218 00064000
*     ICTPTF BASED(CCAICPTF);       /* ADDRESS ENTIRE PTF SECTION    */ 00065000
*   DO I=1 BY 1 WHILE ICTPEND(I)^=ICTENDNT/* NOT AT END              */ 00066000
*         &HIGHDLE<STOPFUNC;        /* NO TERMINATING ERRORS         */ 00067000
         LA    I,1                                                 0219 00068000
         B     @DE00219                                            0219 00069000
@DL00219 DS    0H                                                  0220 00070000
*     IF ICTPNOGO(I)=OFF            /* SYSMOD NOT NOGO               */ 00071000
*         &ICTPGELM(I)=OFF          /* SYSMOD NOT ELIMINATED         */ 00072000
*       THEN                                                       0220 00073000
         LR    @03,I                                               0220 00074000
         MH    @03,@CH02104                                        0220 00075000
         L     @15,CCAICPTF(,CCAPTR)                               0220 00076000
         ST    @03,@TF00001                                        0220 00077000
         ALR   @03,@15                                             0220 00078000
         AL    @03,@CF02118                                        0220 00079000
         TM    ICTPNOGO-8(@03),B'01000000'                         0220 00080000
         BNZ   @RF00220                                            0220 00081000
         LR    @03,@15                                             0220 00082000
         AL    @03,@TF00001                                        0220 00083000
         AL    @03,@CF02119                                        0220 00084000
         TM    ICTPGELM-13(@03),B'00001000'                        0220 00085000
         BNZ   @RF00220                                            0220 00086000
*       DO;                                                        0221 00087000
*                                                                  0221 00088000
*         /***********************************************************/ 00089000
*         /*                                                         */ 00090000
*         /* PROCESS ELEMENTS IN ONE NON-NOGO SYSMOD                 */ 00091000
*         /*                                                         */ 00092000
*         /***********************************************************/ 00093000
*                                                                  0222 00094000
*         RESPECIFY                                                0222 00095000
*           ICTIXPF BASED(ICTPCHN(I));/* ADDRESS LIST OF PTRS TO MOD    00096000
*                                      SECT ENTRIES FOR THIS SYSMOD  */ 00097000
*         CPTF=ADDR(ICTPTF(I));     /* SAVE ADDR. OF PTF SECT ENTRY  */ 00098000
         L     @03,@TF00001                                        0223 00099000
         AL    @15,@CF02120                                        0223 00100000
         LA    @03,ICTPTF(@03,@15)                                 0223 00101000
         ST    @03,CPTF                                            0223 00102000
*         SYSMODRC=0;               /* CLEAR RETURN CODE FOR THIS  0224 00103000
*                                      SYSMOD                        */ 00104000
         SLR   @03,@03                                             0224 00105000
         ST    @03,SYSMODRC                                        0224 00106000
*         SBKUPD=OFF;               /* SCDS BACKUP ENTRY NOT CREATED    00107000
*                                      OR UPDATED FOR THIS SYSMOD    */ 00108000
*         PTFENT=OFF;               /* NO ELEMENTS PROCESSED         */ 00109000
         NI    SBKUPD,B'00111111'                                  0226 00110000
*         IF CCAAPPLY=ON            /* APPLY                         */ 00111000
*             |CCAACCPT=ON          /* ACCEPT                        */ 00112000
*           THEN                                                   0227 00113000
         TM    CCAAPPLY(CCAPTR),B'01100000'                        0227 00114000
         BZ    @RF00227                                            0227 00115000
*           CALL MDLPCHK;           /* DETERMINE THE SETTING OF    0228 00116000
*                                      ICTPMDLP FOR THIS SYSMOD      */ 00117000
*                                                                  0228 00118000
         BAL   @14,MDLPCHK                                         0228 00119000
*         /***********************************************************/ 00120000
*         /*                                                         */ 00121000
*         /* GO THRU MOD SECTION ENTIRES FOR ONE SYSMOD              */ 00122000
*         /*                                                         */ 00123000
*         /***********************************************************/ 00124000
*                                                                  0229 00125000
*         DO K=1 BY 1 WHILE ICTIXP(K)^=ICTENDIX/* NOT AT END         */ 00126000
*               &SYSMODRC<STOPPTF;  /* SYSMOD NOT TERMINATED         */ 00127000
@RF00227 LA    K,1                                                 0229 00128000
         B     @DE00229                                            0229 00129000
@DL00229 DS    0H                                                  0230 00130000
*           RESPECIFY                                              0230 00131000
*             ICTMOD BASED(ICTIXP(K));/* ADDRESS MOD SECT ENTRY      */ 00132000
*           IF(ICTMTSEL(1)=ON       /* ELEMENT SELECTED DURING     0231 00133000
*                                      ELEMENT SELECTION PROCESSING  */ 00134000
*               |ICTMISEL(1)=ON)    /* ELEMENT SELECTED              */ 00135000
*               &ICTMIDEL(1)=ON     /* ... FOR DELETION              */ 00136000
*             THEN                                                 0231 00137000
         LR    @15,K                                               0231 00138000
         SLA   @15,2                                               0231 00139000
         LR    @14,I                                               0231 00140000
         MH    @14,@CH02104                                        0231 00141000
         L     @09,CCAICPTF(,CCAPTR)                               0231 00142000
         LA    @01,0(@14,@09)                                      0231 00143000
         AL    @01,@CF02121                                        0231 00144000
         L     @01,ICTPCHN-64(,@01)                                0231 00145000
         AL    @01,@CF02122                                        0231 00146000
         L     @15,ICTIXP(@15,@01)                                 0231 00147000
         TM    ICTMTSEL(@15),B'10000010'                           0231 00148000
         BZ    @RF00231                                            0231 00149000
         TM    ICTMIDEL(@15),B'01000000'                           0231 00150000
         BNO   @RF00231                                            0231 00151000
*             DO;                                                  0232 00152000
*                                                                  0232 00153000
*               /*****************************************************/ 00154000
*               /*                                                   */ 00155000
*               /* PROCESS DELETED ELEMENT                           */ 00156000
*               /*                                                   */ 00157000
*               /*****************************************************/ 00158000
*                                                                  0233 00159000
*               CALL PTFENTRY(ICTPTF(I),/* CREATE (A)CDS PTF ENTRY   */ 00160000
*                   SYSMODRC);      /* RETURN CODE PARAMETER         */ 00161000
         AL    @09,@CF02120                                        0233 00162000
         LA    @15,ICTPTF(@14,@09)                                 0233 00163000
         ST    @15,@AL00001                                        0233 00164000
         LA    @15,SYSMODRC                                        0233 00165000
         ST    @15,@AL00001+4                                      0233 00166000
         LA    @01,@AL00001                                        0233 00167000
         BAL   @14,PTFENTRY                                        0233 00168000
*               IF ICTMMACR(1)=ON   /* MACRO                         */ 00169000
*                   |ICTMSRCR(1)=ON /* SOURCE                        */ 00170000
*                 THEN                                             0234 00171000
         LR    @15,K                                               0234 00172000
         SLA   @15,2                                               0234 00173000
         LR    @14,I                                               0234 00174000
         MH    @14,@CH02104                                        0234 00175000
         L     @01,CCAICPTF(,CCAPTR)                               0234 00176000
         AL    @01,@CF02121                                        0234 00177000
         L     @01,ICTPCHN-64(@14,@01)                             0234 00178000
         AL    @01,@CF02122                                        0234 00179000
         L     @15,ICTIXP(@15,@01)                                 0234 00180000
         TM    ICTMMACR(@15),B'00001010'                           0234 00181000
         BZ    @RF00234                                            0234 00182000
*                 CALL SRCMAC(ICTMOD(1),/* PROCESS MACRO OR SRC      */ 00183000
*                     SYSMODRC);    /* RETURN CODE                   */ 00184000
         ST    @15,@AL00001                                        0235 00185000
         LA    @15,SYSMODRC                                        0235 00186000
         ST    @15,@AL00001+4                                      0235 00187000
         LA    @01,@AL00001                                        0235 00188000
         BAL   @14,SRCMAC                                          0235 00189000
*               ELSE                                               0236 00190000
*                 IF ICTMMOD(1)=ON  /* MODULE                        */ 00191000
*                   THEN                                           0236 00192000
         B     @RC00234                                            0236 00193000
@RF00234 LR    @15,K                                               0236 00194000
         SLA   @15,2                                               0236 00195000
         LR    @14,I                                               0236 00196000
         MH    @14,@CH02104                                        0236 00197000
         L     @01,CCAICPTF(,CCAPTR)                               0236 00198000
         AL    @01,@CF02121                                        0236 00199000
         L     @01,ICTPCHN-64(@14,@01)                             0236 00200000
         AL    @01,@CF02122                                        0236 00201000
         L     @15,ICTIXP(@15,@01)                                 0236 00202000
         TM    ICTMMOD(@15),B'10000000'                            0236 00203000
         BNO   @RF00236                                            0236 00204000
*                   CALL MOD(ICTMOD(1),/* PROCESS MOD                */ 00205000
*                       SYSMODRC);  /* RETURN CODE                   */ 00206000
         ST    @15,@AL00001                                        0237 00207000
         LA    @15,SYSMODRC                                        0237 00208000
         ST    @15,@AL00001+4                                      0237 00209000
         LA    @01,@AL00001                                        0237 00210000
         BAL   @14,MOD                                             0237 00211000
*             END;                                                 0238 00212000
@RF00236 DS    0H                                                  0238 00213000
@RC00234 DS    0H                                                  0239 00214000
*         END;                      /* END LOOP THRU MOD SECT ENTRIES*/ 00215000
*                                                                  0239 00216000
@RF00231 AH    K,@CH00085                                          0239 00217000
@DE00229 LR    @15,K                                               0239 00218000
         SLA   @15,2                                               0239 00219000
         LR    @14,I                                               0239 00220000
         MH    @14,@CH02104                                        0239 00221000
         L     @01,CCAICPTF(,CCAPTR)                               0239 00222000
         AL    @01,@CF02121                                        0239 00223000
         L     @01,ICTPCHN-64(@14,@01)                             0239 00224000
         AL    @01,@CF02122                                        0239 00225000
         L     @15,ICTIXP(@15,@01)                                 0239 00226000
         CL    @15,ICTENDIX                                        0239 00227000
         BE    @DC00229                                            0239 00228000
         L     @15,SYSMODRC                                        0239 00229000
         CH    @15,@CH00110                                        0239 00230000
         BL    @DL00229                                            0239 00231000
@DC00229 DS    0H                                                  0240 00232000
*         /***********************************************************/ 00233000
*         /*                                                         */ 00234000
*         /* DELETE APPROPRIATE LMODS                                */ 00235000
*         /*                                                         */ 00236000
*         /***********************************************************/ 00237000
*                                                                  0240 00238000
*         IF CCAAPPLY=ON            /* APPLY                         */ 00239000
*             |CCARES=ON            /* RESTORE                       */ 00240000
*           THEN                                                   0240 00241000
         TM    CCAAPPLY(CCAPTR),B'01001000'                        0240 00242000
         BZ    @RF00240                                            0240 00243000
*           CALL DELLMODS(SYSMODRC);/* DELETE LMODS                  */ 00244000
*                                                                  0241 00245000
         LA    @01,@AL00241                                        0241 00246000
         BAL   @14,DELLMODS                                        0241 00247000
*         /***********************************************************/ 00248000
*         /*                                                         */ 00249000
*         /* ALL ELEMENTS FROM ONE SYSMOD PROCESSED                  */ 00250000
*         /*                                                         */ 00251000
*         /***********************************************************/ 00252000
*                                                                  0242 00253000
*         ICTPDCPL(I)=ON;           /* DELETE PROC. COMPLETE FOR SMD.*/ 00254000
@RF00240 LR    @03,I                                               0242 00255000
         MH    @03,@CH02104                                        0242 00256000
         L     @15,CCAICPTF(,CCAPTR)                               0242 00257000
         ST    @03,@TF00001                                        0242 00258000
         ALR   @03,@15                                             0242 00259000
         AL    @03,@CF02123                                        0242 00260000
         OI    ICTPDCPL-14(@03),B'00100000'                        0242 00261000
*         IF SBKUPD=ON              /* SYSMOD ENTRY CREATED/UPDATED     00262000
*                                      ON SCDS                       */ 00263000
*           THEN                                                   0243 00264000
         TM    SBKUPD,B'10000000'                                  0243 00265000
         BNO   @RF00243                                            0243 00266000
*           DO;                                                    0244 00267000
*                                                                  0244 00268000
*             /*******************************************************/ 00269000
*             /*                                                     */ 00270000
*             /* STOW THE SCDS SYSMOD BACKUP ENTRY                   */ 00271000
*             /*                                                     */ 00272000
*             /*******************************************************/ 00273000
*                                                                  0245 00274000
*             BUPFUNCT=BUPSTOW;     /* STOW SYSMOD ENTRY ON SCDS     */ 00275000
         MVI   BUPFUNCT,X'03'                                      0245 00276000
*             BUPSYSMD=ICTPTFS(I);  /* SYSMOD-ID                     */ 00277000
         LR    @03,@15                                             0246 00278000
         AL    @03,@TF00001                                        0246 00279000
         AL    @03,@CF02120                                        0246 00280000
         MVC   BUPSYSMD(7),ICTPTFS(@03)                            0246 00281000
*             BUPSTYPE=ICTPTYPE(I); /* SYSMOD TYPE                   */ 00282000
         L     @03,@TF00001                                        0247 00283000
         AL    @15,@CF02125                                        0247 00284000
         SLR   @14,@14                                             0247 00285000
         IC    @14,ICTPTYPE-17(@03,@15)                            0247 00286000
         STC   @14,BUPSTYPE                                        0247 00287000
*             CALL HMASMBUE(BUPPARM);/* STOW THE SYSMOD ENTRY        */ 00288000
         L     @15,@CV01851                                        0248 00289000
         LA    @01,@AL00248                                        0248 00290000
         BALR  @14,@15                                             0248 00291000
*             RESPECIFY                                            0249 00292000
*               REG15 RSTD;                                        0249 00293000
*             SYSMODRC=MAX(SYSMODRC,REG15);/* MAINTAIN RETURN CODE   */ 00294000
         L     @14,SYSMODRC                                        0250 00295000
         CR    @14,REG15                                           0250 00296000
         BNL   *+6                                                      00297000
         LR    @14,REG15                                           0250 00298000
         ST    @14,SYSMODRC                                        0250 00299000
*             RESPECIFY                                            0251 00300000
*               REG15 UNRSTD;                                      0251 00301000
*           END;                                                   0252 00302000
*         HIGHDLE=MAX(HIGHDLE,SYSMODRC);/* MAINTAIN RETURN CODE      */ 00303000
@RF00243 L     @03,SYSMODRC                                        0253 00304000
         CR    HIGHDLE,@03                                         0253 00305000
         BNL   *+6                                                      00306000
         LR    HIGHDLE,@03                                         0253 00307000
*         IF PTFENT=ON              /* PTF ENTRY CREATED             */ 00308000
*           THEN                                                   0254 00309000
         TM    PTFENT,B'01000000'                                  0254 00310000
         BNO   @RF00254                                            0254 00311000
*           DO;                                                    0255 00312000
*                                                                  0255 00313000
*             /*******************************************************/ 00314000
*             /*                                                     */ 00315000
*             /* GO TO THE COMPLETION PROCESSOR WITH THE RESULTS OF  */ 00316000
*             /* DELETE PROCESSING FOR THIS SYSMOD                   */ 00317000
*             /*                                                     */ 00318000
*             /*******************************************************/ 00319000
*                                                                  0256 00320000
*             IF SYSMODRC<STOPPTF   /* SYSMOD NOT TERMINATED         */ 00321000
*               THEN                                               0256 00322000
         CH    @03,@CH00110                                        0256 00323000
         BNL   @RF00256                                            0256 00324000
*               SYSMCPL=GOOD;                                      0257 00325000
         MVI   SYSMCPL,C'G'                                        0257 00326000
*             ELSE                                                 0258 00327000
*               SYSMCPL=DLEBAD;                                    0258 00328000
         B     @RC00256                                            0258 00329000
@RF00256 MVI   SYSMCPL,C'D'                                        0258 00330000
*             CALL HMASMCPL(SYSMCPL);                              0259 00331000
@RC00256 L     @15,@CV01852                                        0259 00332000
         LA    @01,@AL00259                                        0259 00333000
         BALR  @14,@15                                             0259 00334000
*             RESPECIFY                                            0260 00335000
*               REG15 RSTD;                                        0260 00336000
*             HIGHDLE=MAX(HIGHDLE,REG15);/* MAINTAIN RETURN CODE     */ 00337000
         CR    HIGHDLE,REG15                                       0261 00338000
         BNL   *+6                                                      00339000
         LR    HIGHDLE,REG15                                       0261 00340000
*             RESPECIFY                                            0262 00341000
*               REG15 UNRSTD;                                      0262 00342000
*           END;                                                   0263 00343000
*       END;                        /* END NON-NOGO SYSMOD           */ 00344000
@RF00254 DS    0H                                                  0265 00345000
*   END;                            /* END LOOP THRU ICT PTF SECTION */ 00346000
@RF00220 AH    I,@CH00085                                          0265 00347000
@DE00219 LR    @03,I                                               0265 00348000
         MH    @03,@CH02104                                        0265 00349000
         L     @01,CCAICPTF(,CCAPTR)                               0265 00350000
         AL    @01,@CF02120                                        0265 00351000
         L     @03,ICTPEND(@03,@01)                                0265 00352000
         CL    @03,ICTENDNT                                        0265 00353000
         BE    @DC00219                                            0265 00354000
         CH    HIGHDLE,@CH00032                                    0265 00355000
         BL    @DL00219                                            0265 00356000
@DC00219 DS    0H                                                  0266 00357000
*                                                                  0266 00358000
*   /*****************************************************************/ 00359000
*   /*                                                               */ 00360000
*   /* SET THE DELETE PROCESSING COMPLETE FLAG IN ALL REMAINING      */ 00361000
*   /* SYSMODS IN THE ICT PTF SECTION AND CALL HMASMCPL              */ 00362000
*   /*                                                               */ 00363000
*   /*****************************************************************/ 00364000
*                                                                  0266 00365000
*   RESPECIFY                                                      0266 00366000
*     ICTPTF BASED(CCAICPTF);       /* ADDRESS ENTIRE PTF SECTION    */ 00367000
*   DO J=1 BY 1 WHILE ICTPEND(J)^=ICTENDNT;                        0267 00368000
         LA    J,1                                                 0267 00369000
         B     @DE00267                                            0267 00370000
@DL00267 DS    0H                                                  0268 00371000
*     ICTPDCPL(J)=ON;               /* DELETE PROCESSING COMPLETE    */ 00372000
         LR    @04,J                                               0268 00373000
         MH    @04,@CH02104                                        0268 00374000
         L     @03,CCAICPTF(,CCAPTR)                               0268 00375000
         ALR   @03,@04                                             0268 00376000
         AL    @03,@CF02123                                        0268 00377000
         OI    ICTPDCPL-14(@03),B'00100000'                        0268 00378000
*   END;                                                           0269 00379000
         AH    J,@CH00085                                          0269 00380000
@DE00267 LR    @04,J                                               0269 00381000
         MH    @04,@CH02104                                        0269 00382000
         L     @03,CCAICPTF(,CCAPTR)                               0269 00383000
         AL    @03,@CF02120                                        0269 00384000
         L     @04,ICTPEND(@04,@03)                                0269 00385000
         CL    @04,ICTENDNT                                        0269 00386000
         BNE   @DL00267                                            0269 00387000
*   SYSMCPL=GOOD;                                                  0270 00388000
         MVI   SYSMCPL,C'G'                                        0270 00389000
*   CALL HMASMCPL(SYSMCPL);                                        0271 00390000
*                                                                  0271 00391000
         L     @15,@CV01852                                        0271 00392000
         LA    @01,@AL00271                                        0271 00393000
         BALR  @14,@15                                             0271 00394000
*   /*****************************************************************/ 00395000
*   /*                                                               */ 00396000
*   /* FREE TST GTA FILE                                             */ 00397000
*   /*                                                               */ 00398000
*   /*****************************************************************/ 00399000
*                                                                  0272 00400000
*   GTPFUNCT(3)=GTPFREE;            /* FREE TST GTA FILE             */ 00401000
         MVI   GTPFUNCT+56,X'0A'                                   0272 00402000
*   CALL HMASMGTA(HMASMGTP(3));                                    0273 00403000
         L     @15,@CV01853                                        0273 00404000
         LA    @01,@AL00273                                        0273 00405000
         BALR  @14,@15                                             0273 00406000
*   RETURN CODE(HIGHDLE);                                          0274 00407000
         LR    @15,HIGHDLE                                         0274 00408000
         L     @13,4(,@13)                                         0274 00409000
         L     @14,12(,@13)                                        0274 00410000
         LM    @00,@12,20(@13)                                     0274 00411000
         BR    @14                                                 0274 00412000
*                                                                  0275 00413000
*/********************************************************************/ 00414000
*/*                                                                  */ 00415000
*/* SRCMAC  - PROCESS DELETED SRC AND MAC ENTRIES                    */ 00416000
*/*                                                                  */ 00417000
*/*                                                                  */ 00418000
*/*                                                                  */ 00419000
*/********************************************************************/ 00420000
*                                                                  0275 00421000
*SRCMAC:                                                           0275 00422000
*   PROC(SRCMACE,SRCMACRC);                                        0275 00423000
SRCMAC   STM   @14,@12,@SA00002                                    0275 00424000
         MVC   @PC00002(8),0(@01)                                  0275 00425000
*   DCL                                                            0276 00426000
*     SRCMACE CHAR(*);              /* SRC OR MAC ICT MOD SECT ENTRY */ 00427000
*   DCL                                                            0277 00428000
*     SRCMACRC FIXED(31);           /* RETURN CODE PARAMETER         */ 00429000
*   DCL                                                            0278 00430000
*     SRCMACTP FIXED(8);            /* ELEMENT TYPE (IOPMAC/IOPSRC)  */ 00431000
*   DCL                                                            0279 00432000
*     MM FIXED(15);                 /* INDEX - ALIAS LISTS           */ 00433000
*   RESPECIFY                                                      0280 00434000
*     ICTMOD BASED(ADDR(SRCMACE));  /* ADDRESS ENTRY PASSED          */ 00435000
*   IF ICTMISEL(1)=ON               /* ELEMENT SELECTED FOR DELETION */ 00436000
*     THEN                                                         0281 00437000
         L     @05,@PC00002                                        0281 00438000
         TM    ICTMISEL(@05),B'10000000'                           0281 00439000
         BNO   @RF00281                                            0281 00440000
*     ICTMPROC(1)=ON;               /* MARK ELEMENT "IN-PROCESS"     */ 00441000
         OI    ICTMPROC(@05),B'10000000'                           0282 00442000
*   IF ICTMMACR(1)=ON THEN          /* SET ELEMENT TYPE:             */ 00443000
@RF00281 L     @05,@PC00002                                        0283 00444000
         TM    ICTMMACR(@05),B'00001000'                           0283 00445000
         BNO   @RF00283                                            0283 00446000
*     SRCMACTP=IOPMAC;              /* ... MACRO ELEMENT             */ 00447000
         MVI   SRCMACTP,X'03'                                      0284 00448000
*   ELSE                                                           0285 00449000
*     SRCMACTP=IOPSRC;              /* ... SRC ELEMENT               */ 00450000
         B     @RC00283                                            0285 00451000
@RF00283 MVI   SRCMACTP,X'08'                                      0285 00452000
*   IF CCAAPPLY=ON                  /* APPLY PROCESSING              */ 00453000
*       &ICTMISEL(1)=ON             /* ELEMENT SELECTED FOR DELETION */ 00454000
*       &ICTPPTR(1)->ICTPDEXP(1)=OFF/* OWNING SYSMOD NOT DELETED     */ 00455000
*       &ICTPPTR(1)->ICTPDIMP(1)=OFF/* OWNING SYSMOD NOT DELETED     */ 00456000
*       &SRCMACRC<STOPPTF           /* NOT TERMINATING               */ 00457000
*     THEN                                                         0286 00458000
@RC00283 TM    CCAAPPLY(CCAPTR),B'01000000'                        0286 00459000
         BNO   @RF00286                                            0286 00460000
         L     @05,@PC00002                                        0286 00461000
         TM    ICTMISEL(@05),B'10000000'                           0286 00462000
         BNO   @RF00286                                            0286 00463000
         L     @01,ICTPPTR(,@05)                                   0286 00464000
         TM    ICTPDEXP(@01),B'00110000'                           0286 00465000
         BNZ   @RF00286                                            0286 00466000
         L     @15,@PC00002+4                                      0286 00467000
         L     @14,SRCMACRC(,@15)                                  0286 00468000
         CH    @14,@CH00110                                        0286 00469000
         BNL   @RF00286                                            0286 00470000
*     DO;                                                          0287 00471000
*                                                                  0287 00472000
*       /*************************************************************/ 00473000
*       /*                                                           */ 00474000
*       /* ACCESS CDS ELEMENT ENTRY FOR SRC OR MAC                   */ 00475000
*       /*                                                           */ 00476000
*       /*************************************************************/ 00477000
*                                                                  0288 00478000
*       CALL CDSELEM(ICTMOD(1),     /* ACCESS ENTRY ON CDS           */ 00479000
*           SRCMACRC);              /* RETURN CODE PARAMETER         */ 00480000
         ST    @05,@AL00001                                        0288 00481000
         ST    @15,@AL00001+4                                      0288 00482000
         LA    @01,@AL00001                                        0288 00483000
         BAL   @14,CDSELEM                                         0288 00484000
*       IF IOPRETRN=IOPGOOD         /* CDS ENTRY ACCESSED            */ 00485000
*         THEN                                                     0289 00486000
*                                                                  0289 00487000
         L     @05,IOPPTR                                          0289 00488000
         CLI   IOPRETRN(@05),0                                     0289 00489000
         BNE   @RF00289                                            0289 00490000
*         /***********************************************************/ 00491000
*         /*                                                         */ 00492000
*         /* BACKUP CDS ELEMENT ENTRY ON SCDS DATASET                */ 00493000
*         /*                                                         */ 00494000
*         /***********************************************************/ 00495000
*                                                                  0290 00496000
*         CALL BACKUP(SRCMACRC);    /* CREATE BACKUP ENTRY ASSOCIATED   00497000
*                                      WITH CURRENT SYSMOD           */ 00498000
         L     @05,@PC00002+4                                      0290 00499000
         ST    @05,@AL00001                                        0290 00500000
         LA    @01,@AL00001                                        0290 00501000
         BAL   @14,BACKUP                                          0290 00502000
*     END;                                                         0291 00503000
@RF00289 DS    0H                                                  0292 00504000
*                                                                  0292 00505000
*   /*****************************************************************/ 00506000
*   /*                                                               */ 00507000
*   /* DELETE ELEMENT FROM TARGET SYSTEM                             */ 00508000
*   /*                                                               */ 00509000
*   /*****************************************************************/ 00510000
*                                                                  0292 00511000
*   IF SRCMACRC<STOPPTF             /* SUCCESSFULLY BACKED UP        */ 00512000
*       &ICTMISEL(1)=ON             /* ELEMENT SELECTED FOR DELETION */ 00513000
*     THEN                                                         0292 00514000
@RF00286 L     @05,@PC00002+4                                      0292 00515000
         L     @15,SRCMACRC(,@05)                                  0292 00516000
         CH    @15,@CH00110                                        0292 00517000
         BNL   @RF00292                                            0292 00518000
         L     @15,@PC00002                                        0292 00519000
         TM    ICTMISEL(@15),B'10000000'                           0292 00520000
         BNO   @RF00292                                            0292 00521000
*     DO;                                                          0293 00522000
*       TARGETDD=ICTTOLIB(1);       /* TARGET SYSTEM LIBRARY         */ 00523000
         MVC   TARGETDD(8),ICTTOLIB(@15)                           0294 00524000
*       CALL DELMEMBR(ICTMNAME(1),  /* MEMBER NAME TO BE DELETED     */ 00525000
*           SRCMACTP,               /* ELEMENT TYPE (IOPMAC/IOPSRC)  */ 00526000
*           TARGETDD,               /* TARGET SYS LIBRARY (DDNAME)   */ 00527000
*           SRCMACRC);              /* RETURN CODE PARAMETER         */ 00528000
         ST    @15,@AL00001                                        0295 00529000
         LA    @15,SRCMACTP                                        0295 00530000
         ST    @15,@AL00001+4                                      0295 00531000
         LA    @15,TARGETDD                                        0295 00532000
         ST    @15,@AL00001+8                                      0295 00533000
         ST    @05,@AL00001+12                                     0295 00534000
         LA    @01,@AL00001                                        0295 00535000
         BAL   @14,DELMEMBR                                        0295 00536000
*     END;                                                         0296 00537000
*                                                                  0296 00538000
*   /*****************************************************************/ 00539000
*   /*                                                               */ 00540000
*   /* DELETE ELEMENT'S ALIASES FROM TARGET SYSTEM ... THIS IS DONE  */ 00541000
*   /* FOR ELEMENTS WHICH ARE ACTUALLY BEING DELETED (ICTMISEL=ON)   */ 00542000
*   /* AND FOR ELEMENTS WHICH WERE AT ONE TIME SELECTED FOR DELETION */ 00543000
*   /* (ICTMTSEL=ON)                                                 */ 00544000
*   /*                                                               */ 00545000
*   /*****************************************************************/ 00546000
*                                                                  0297 00547000
*   RESPECIFY                                                      0297 00548000
*     ICTTALLS BASED(ICTMTCHN(1));  /* ADDRESS ALIAS LIST FOR ELEMENT*/ 00549000
@RF00292 DS    0H                                                  0298 00550000
*   IF SRCMACRC<STOPPTF             /* BACKUP WAS SUCCESSFUL         */ 00551000
*     THEN                                                         0298 00552000
         L     @05,@PC00002+4                                      0298 00553000
         L     @05,SRCMACRC(,@05)                                  0298 00554000
         CH    @05,@CH00110                                        0298 00555000
         BNL   @RF00298                                            0298 00556000
*     DO;                                                          0299 00557000
*                                                                  0299 00558000
*       /*************************************************************/ 00559000
*       /*                                                           */ 00560000
*       /* GO THRU ELEMENT''S ALIAS LIST                             */ 00561000
*       /*                                                           */ 00562000
*       /*************************************************************/ 00563000
*                                                                  0300 00564000
*       DO MM=1 BY 1 WHILE ICTTALND(MM)^=ICTENDIX;                 0300 00565000
         LA    MM,1                                                0300 00566000
         B     @DE00300                                            0300 00567000
@DL00300 DS    0H                                                  0301 00568000
*         CALL DELMEMBR(ICTTALNM(MM),/* MEMBER NAME TO BE DELETED    */ 00569000
*             SRCMACTP,             /* ELEMENT TYPE (IOPMAC/IOPSRC)  */ 00570000
*             TARGETDD,             /* TARGET SYS LIBRARY (DDNAME)   */ 00571000
*             SRCMACRC);            /* RETURN CODE PARAMETER         */ 00572000
         LR    @05,MM                                              0301 00573000
         SLA   @05,3                                               0301 00574000
         L     @03,@PC00002                                        0301 00575000
         L     @03,ICTMTCHN(,@03)                                  0301 00576000
         AL    @03,@CF02127                                        0301 00577000
         LA    @05,ICTTALNM(@05,@03)                               0301 00578000
         ST    @05,@AL00001                                        0301 00579000
         LA    @05,SRCMACTP                                        0301 00580000
         ST    @05,@AL00001+4                                      0301 00581000
         LA    @05,TARGETDD                                        0301 00582000
         ST    @05,@AL00001+8                                      0301 00583000
         L     @05,@PC00002+4                                      0301 00584000
         ST    @05,@AL00001+12                                     0301 00585000
         LA    @01,@AL00001                                        0301 00586000
         BAL   @14,DELMEMBR                                        0301 00587000
*       END;                                                       0302 00588000
         AH    MM,@CH00085                                         0302 00589000
@DE00300 LR    @05,MM                                              0302 00590000
         SLA   @05,3                                               0302 00591000
         L     @03,@PC00002                                        0302 00592000
         L     @03,ICTMTCHN(,@03)                                  0302 00593000
         AL    @03,@CF02127                                        0302 00594000
         L     @05,ICTTALND(@05,@03)                               0302 00595000
         CL    @05,ICTENDIX                                        0302 00596000
         BNE   @DL00300                                            0302 00597000
*     END;                                                         0303 00598000
*                                                                  0303 00599000
*   /*****************************************************************/ 00600000
*   /*                                                               */ 00601000
*   /* DELETE ELEMENT ENTRY FROM (A)CDS                              */ 00602000
*   /*                                                               */ 00603000
*   /*****************************************************************/ 00604000
*                                                                  0304 00605000
*   IF SRCMACRC<STOPPTF             /* BACKUP WAS SUCCESSFUL         */ 00606000
*       &ICTMISEL(1)=ON             /* ELEMENT SELECTED FOR DELETION */ 00607000
*     THEN                                                         0304 00608000
@RF00298 L     @05,@PC00002+4                                      0304 00609000
         L     @15,SRCMACRC(,@05)                                  0304 00610000
         CH    @15,@CH00110                                        0304 00611000
         BNL   @RF00304                                            0304 00612000
         L     @15,@PC00002                                        0304 00613000
         TM    ICTMISEL(@15),B'10000000'                           0304 00614000
         BNO   @RF00304                                            0304 00615000
*     CALL DELENTRY(ICTMOD(1),      /* ENTRY TO DELETE FROM (A)CDS   */ 00616000
*         SRCMACRC);                /* RETURN CODE PARAMETER         */ 00617000
         ST    @15,@AL00001                                        0305 00618000
         ST    @05,@AL00001+4                                      0305 00619000
         LA    @01,@AL00001                                        0305 00620000
         BAL   @14,DELENTRY                                        0305 00621000
*   RETURN;                                                        0306 00622000
@EL00002 DS    0H                                                  0306 00623000
@EF00002 DS    0H                                                  0306 00624000
@ER00002 LM    @14,@12,@SA00002                                    0306 00625000
         BR    @14                                                 0306 00626000
*   END SRCMAC;                                                    0307 00627000
         B     @EL00002                                            0307 00628000
*                                                                  0308 00629000
*/********************************************************************/ 00630000
*/*                                                                  */ 00631000
*/* MOD     - PROCESS DELETED MODULE ENTRIES                         */ 00632000
*/*                                                                  */ 00633000
*/*                                                                  */ 00634000
*/*                                                                  */ 00635000
*/********************************************************************/ 00636000
*                                                                  0308 00637000
*MOD:                                                              0308 00638000
*   PROC(MODICTE,MODRC);                                           0308 00639000
MOD      STM   @14,@12,@SA00003                                    0308 00640000
         MVC   @PC00003(8),0(@01)                                  0308 00641000
*   DCL                                                            0309 00642000
*     MODICTE CHAR(*);              /* ICT MOD SECTION ENTRY         */ 00643000
*   DCL                                                            0310 00644000
*     MODRC FIXED(31);              /* RETURN CODE PARAMETER         */ 00645000
*   DCL                                                            0311 00646000
*     KK FIXED(15);                 /* INDEX - ALIAS LISTS           */ 00647000
*   RESPECIFY                                                      0312 00648000
*     ICTMOD BASED(ADDR(MODICTE));  /* ADDRESS ENTRY PASSED          */ 00649000
*   ICTMPROC(1)=ON;                 /* MARK ELEMENT "IN-PROCESS"     */ 00650000
         L     @05,@PC00003                                        0313 00651000
         OI    ICTMPROC(@05),B'10000000'                           0313 00652000
*   IF CCAACCPT=ON                  /* ACCEPT PROCESSING             */ 00653000
*       &ICTMISEL(1)=ON             /* ELEMENT SELECTED FOR DELETION */ 00654000
*       &MODRC<STOPPTF              /* NOT TERMINATING               */ 00655000
*     THEN                                                         0314 00656000
         TM    CCAACCPT(CCAPTR),B'00100000'                        0314 00657000
         BNO   @RF00314                                            0314 00658000
         TM    ICTMISEL(@05),B'10000000'                           0314 00659000
         BNO   @RF00314                                            0314 00660000
         L     @15,@PC00003+4                                      0314 00661000
         L     @14,MODRC(,@15)                                     0314 00662000
         CH    @14,@CH00110                                        0314 00663000
         BNL   @RF00314                                            0314 00664000
*     DO;                                                          0315 00665000
*                                                                  0315 00666000
*       /*************************************************************/ 00667000
*       /*                                                           */ 00668000
*       /* ACCEPT PROCESSING FOR MODULE ELEMENT                      */ 00669000
*       /*                                                           */ 00670000
*       /*************************************************************/ 00671000
*                                                                  0316 00672000
*                                                                  0316 00673000
*       /*************************************************************/ 00674000
*       /*                                                           */ 00675000
*       /* DELETE ELEMENT FROM TARGET DISTRIBUTION LIB               */ 00676000
*       /*                                                           */ 00677000
*       /*************************************************************/ 00678000
*                                                                  0316 00679000
*       TARGETDD=ICTMDSTL(1);       /* DELETE FROM DISTLIB FOR ACCEPT*/ 00680000
         MVC   TARGETDD(8),ICTMDSTL(@05)                           0316 00681000
*       CALL DELMEMBR(ICTMNAME(1),  /* MEMBER NAME TO BE DELETED     */ 00682000
*           IOPMOD,                 /* ELEMENT TYPE                  */ 00683000
*           TARGETDD,               /* TARGET DISTLIB (DDNAME)       */ 00684000
*           MODRC);                 /* RETURN CODE PARAMETER         */ 00685000
*                                                                  0317 00686000
         ST    @05,@AL00001                                        0317 00687000
         LA    @05,@CH00128+1                                      0317 00688000
         ST    @05,@AL00001+4                                      0317 00689000
         LA    @05,TARGETDD                                        0317 00690000
         ST    @05,@AL00001+8                                      0317 00691000
         ST    @15,@AL00001+12                                     0317 00692000
         LA    @01,@AL00001                                        0317 00693000
         BAL   @14,DELMEMBR                                        0317 00694000
*       /*************************************************************/ 00695000
*       /*                                                           */ 00696000
*       /* DELETE ELEMENT''S ALIASES FROM TARGET SYSTEM              */ 00697000
*       /*                                                           */ 00698000
*       /*************************************************************/ 00699000
*                                                                  0318 00700000
*       RESPECIFY                                                  0318 00701000
*         ICTTALLS BASED(ICTMTCHN(1));/* ADDRESS ALIAS LIST FOR    0318 00702000
*                                      ELEMENT                       */ 00703000
*       DO KK=1 BY 1 WHILE ICTTALND(KK)^=ICTENDIX;                 0319 00704000
         LA    KK,1                                                0319 00705000
         B     @DE00319                                            0319 00706000
@DL00319 DS    0H                                                  0320 00707000
*         CALL DELMEMBR(ICTTALNM(KK),/* MEMBER NAME TO BE DELETED    */ 00708000
*             IOPMOD,               /* ELEMENT TYPE                  */ 00709000
*             TARGETDD,             /* TARGET DISTLIB (DDNAME)       */ 00710000
*             MODRC);               /* RETURN CODE PARAMETER         */ 00711000
         LR    @05,KK                                              0320 00712000
         SLA   @05,3                                               0320 00713000
         L     @03,@PC00003                                        0320 00714000
         L     @03,ICTMTCHN(,@03)                                  0320 00715000
         AL    @03,@CF02127                                        0320 00716000
         LA    @05,ICTTALNM(@05,@03)                               0320 00717000
         ST    @05,@AL00001                                        0320 00718000
         LA    @05,@CH00128+1                                      0320 00719000
         ST    @05,@AL00001+4                                      0320 00720000
         LA    @05,TARGETDD                                        0320 00721000
         ST    @05,@AL00001+8                                      0320 00722000
         L     @05,@PC00003+4                                      0320 00723000
         ST    @05,@AL00001+12                                     0320 00724000
         LA    @01,@AL00001                                        0320 00725000
         BAL   @14,DELMEMBR                                        0320 00726000
*       END;                                                       0321 00727000
*                                                                  0321 00728000
         AH    KK,@CH00085                                         0321 00729000
@DE00319 LR    @05,KK                                              0321 00730000
         SLA   @05,3                                               0321 00731000
         L     @03,@PC00003                                        0321 00732000
         L     @01,ICTMTCHN(,@03)                                  0321 00733000
         AL    @01,@CF02127                                        0321 00734000
         L     @05,ICTTALND(@05,@01)                               0321 00735000
         CL    @05,ICTENDIX                                        0321 00736000
         BNE   @DL00319                                            0321 00737000
*       /*************************************************************/ 00738000
*       /*                                                           */ 00739000
*       /* DELETE ELEMENT ENTRY FROM ACDS                            */ 00740000
*       /*                                                           */ 00741000
*       /*************************************************************/ 00742000
*                                                                  0322 00743000
*       CALL DELENTRY(ICTMOD(1),    /* ENTRY TO DELETE FROM ACDS     */ 00744000
*           MODRC);                 /* RETURN CODE PARAMETER         */ 00745000
         ST    @03,@AL00001                                        0322 00746000
         L     @05,@PC00003+4                                      0322 00747000
         ST    @05,@AL00001+4                                      0322 00748000
         LA    @01,@AL00001                                        0322 00749000
         BAL   @14,DELENTRY                                        0322 00750000
*     END;                          /* END PROCESSING FOR ACCEPT     */ 00751000
*   IF(CCAAPPLY=ON                  /* APPLY PROCESSING              */ 00752000
*       |CCARES=ON)                 /* RESTORE PROCESSING            */ 00753000
*       &ICTMISEL(1)=ON             /* ELEMENT SELECTED FOR DELETION */ 00754000
*       &MODRC<STOPPTF              /* NOT TERMINATING               */ 00755000
*     THEN                                                         0324 00756000
@RF00314 TM    CCAAPPLY(CCAPTR),B'01001000'                        0324 00757000
         BZ    @RF00324                                            0324 00758000
         L     @05,@PC00003                                        0324 00759000
         TM    ICTMISEL(@05),B'10000000'                           0324 00760000
         BNO   @RF00324                                            0324 00761000
         L     @15,@PC00003+4                                      0324 00762000
         L     @14,MODRC(,@15)                                     0324 00763000
         CH    @14,@CH00110                                        0324 00764000
         BNL   @RF00324                                            0324 00765000
*     DO;                                                          0325 00766000
*                                                                  0325 00767000
*       /*************************************************************/ 00768000
*       /*                                                           */ 00769000
*       /* APPLY OR RESTORE PROCESSING FOR MODS AND ASSEMBLIES       */ 00770000
*       /*                                                           */ 00771000
*       /*************************************************************/ 00772000
*                                                                  0326 00773000
*                                                                  0326 00774000
*       /*************************************************************/ 00775000
*       /*                                                           */ 00776000
*       /* ACCESS CDS MOD ENTRY FOR MODULE OR ASSEMBLY BEING DELETED */ 00777000
*       /*                                                           */ 00778000
*       /*************************************************************/ 00779000
*                                                                  0326 00780000
*       CALL CDSELEM(ICTMOD(1),     /* ACCESS CDS ELEMENT ENTRY      */ 00781000
*           MODRC);                 /* RETURN CODE PARAMETER         */ 00782000
         ST    @05,@AL00001                                        0326 00783000
         ST    @15,@AL00001+4                                      0326 00784000
         LA    @01,@AL00001                                        0326 00785000
         BAL   @14,CDSELEM                                         0326 00786000
*       IF ICTPPTR(1)->ICTPDEXP(1)=OFF/* NOT FROM DELETED SYSMOD     */ 00787000
*           &ICTPPTR(1)->ICTPDIMP(1)=OFF/* NOT FROM DELETED SYSMOD   */ 00788000
*           &CCARES=OFF             /* NOT RESTORE (I.E., APPLY)     */ 00789000
*           &IOPRETRN=IOPGOOD       /* ENTRY FOUND ON CDS            */ 00790000
*         THEN                                                     0327 00791000
*                                                                  0327 00792000
         L     @05,@PC00003                                        0327 00793000
         L     @05,ICTPPTR(,@05)                                   0327 00794000
         TM    ICTPDEXP(@05),B'00110000'                           0327 00795000
         BNZ   @RF00327                                            0327 00796000
         TM    CCARES(CCAPTR),B'00001000'                          0327 00797000
         BNZ   @RF00327                                            0327 00798000
         L     @05,IOPPTR                                          0327 00799000
         CLI   IOPRETRN(@05),0                                     0327 00800000
         BNE   @RF00327                                            0327 00801000
*         /***********************************************************/ 00802000
*         /*                                                         */ 00803000
*         /* BACKUP CDS ENTRY FOR MODULE ON SCDS (APPLY)             */ 00804000
*         /*                                                         */ 00805000
*         /***********************************************************/ 00806000
*                                                                  0328 00807000
*         CALL BACKUP(MODRC);       /* CREATE BACKUP ENTRY ASSOCIATED   00808000
*                                      WITH CURRENT SYSMOD           */ 00809000
*                                                                  0328 00810000
         L     @05,@PC00003+4                                      0328 00811000
         ST    @05,@AL00001                                        0328 00812000
         LA    @01,@AL00001                                        0328 00813000
         BAL   @14,BACKUP                                          0328 00814000
*       /*************************************************************/ 00815000
*       /*                                                           */ 00816000
*       /* PUT LMODS FOR THIS MOD ENTRY IN SELECT-LIST GTA FILE      */ 00817000
*       /*                                                           */ 00818000
*       /*************************************************************/ 00819000
*                                                                  0329 00820000
*       IF MODRC<STOPPTF            /* BACKUP SUCCESSFUL             */ 00821000
*         THEN                                                     0329 00822000
@RF00327 L     @05,@PC00003+4                                      0329 00823000
         L     @15,MODRC(,@05)                                     0329 00824000
         CH    @15,@CH00110                                        0329 00825000
         BNL   @RF00329                                            0329 00826000
*         CALL XRFSEL(MODRC);       /* PUT LMODS IN SELECT-LIST      */ 00827000
         ST    @05,@AL00001                                        0330 00828000
         LA    @01,@AL00001                                        0330 00829000
         BAL   @14,XRFSEL                                          0330 00830000
*                                                                  0331 00831000
*       /*************************************************************/ 00832000
*       /*                                                           */ 00833000
*       /* DELETE MOD ENTRY FROM THE CDS                             */ 00834000
*       /*                                                           */ 00835000
*       /*************************************************************/ 00836000
*                                                                  0331 00837000
*       IF CCARES=ON                /* RESTORE PROCESSING            */ 00838000
*         THEN                                                     0331 00839000
@RF00329 TM    CCARES(CCAPTR),B'00001000'                          0331 00840000
         BNO   @RF00331                                            0331 00841000
*         CALL SRCHPTF(IOPBUSMD,    /* SYSMOD CAUSING BACKUP         */ 00842000
*             PPARM);               /* PTR TO PTF ENTRY IN ICT       */ 00843000
         L     @05,IOPPTR                                          0332 00844000
         LA    @05,IOPBUSMD(,@05)                                  0332 00845000
         ST    @05,@AL00001                                        0332 00846000
         LA    @05,PPARM                                           0332 00847000
         ST    @05,@AL00001+4                                      0332 00848000
         LA    @01,@AL00001                                        0332 00849000
         BAL   @14,SRCHPTF                                         0332 00850000
*       IF MODRC<STOPPTF            /* BACKUP AND LMOD DELETE OK     */ 00851000
*         THEN                                                     0333 00852000
@RF00331 L     @05,@PC00003+4                                      0333 00853000
         L     @05,MODRC(,@05)                                     0333 00854000
         CH    @05,@CH00110                                        0333 00855000
         BNL   @RF00333                                            0333 00856000
*         IF CCARES=OFF             /* NOT RESTORE                   */ 00857000
*             |(CCARES=ON           /* RESTORE ...                   */ 00858000
*             &PPARM^=0)            /* CAUSER OF BKUP BEING RESTORED */ 00859000
*           THEN                                                   0334 00860000
         TM    CCARES(CCAPTR),B'00001000'                          0334 00861000
         BZ    @RT00334                                            0334 00862000
         TM    CCARES(CCAPTR),B'00001000'                          0334 00863000
         BNO   @RF00334                                            0334 00864000
         ICM   @05,15,PPARM                                        0334 00865000
         BZ    @RF00334                                            0334 00866000
@RT00334 DS    0H                                                  0335 00867000
*           CALL DELENTRY(ICTMOD(1),/* MOD ENTRY TO DELETE FROM CDS  */ 00868000
*               MODRC);             /* RETURN CODE PARAMETER         */ 00869000
         L     @05,@PC00003                                        0335 00870000
         ST    @05,@AL00001                                        0335 00871000
         L     @05,@PC00003+4                                      0335 00872000
         ST    @05,@AL00001+4                                      0335 00873000
         LA    @01,@AL00001                                        0335 00874000
         BAL   @14,DELENTRY                                        0335 00875000
*     END;                                                         0336 00876000
*   RETURN;                                                        0337 00877000
@EL00003 DS    0H                                                  0337 00878000
@EF00003 DS    0H                                                  0337 00879000
@ER00003 LM    @14,@12,@SA00003                                    0337 00880000
         BR    @14                                                 0337 00881000
*   END MOD;                                                       0338 00882000
         B     @EL00003                                            0338 00883000
*                                                                  0339 00884000
*/********************************************************************/ 00885000
*/*                                                                  */ 00886000
*/*  DELLMODS   - DETERMINE WHETHER ANY OF THE LOAD MODULES          */ 00887000
*/*               ASSOCIATED WITH DELETED MODULES MAY BE DELETED     */ 00888000
*/*               FROM THE TARGET SYSTEM (AND THE CDS).              */ 00889000
*/*                                                                  */ 00890000
*/*               NOTE - THE SELECT-LIST GTA FILE IS EXPECTED TO     */ 00891000
*/*               CONTAIN THE NAMES OF ALL LMODS ASSOCIATED WITH     */ 00892000
*/*               MODULES BEING DELETED.                             */ 00893000
*/*                                                                  */ 00894000
*/********************************************************************/ 00895000
*                                                                  0339 00896000
*DELLMODS:                                                         0339 00897000
*   PROC(DELLMRC);                                                 0339 00898000
DELLMODS STM   @14,@12,@SA00004                                    0339 00899000
         MVC   @PC00004(4),0(@01)                                  0339 00900000
*   DCL                                                            0340 00901000
*     DELLMRC FIXED(31);            /* RETURN CODE PARAMETER         */ 00902000
*                                                                  0340 00903000
*   /*****************************************************************/ 00904000
*   /*                                                               */ 00905000
*   /* INITIALIZE XREF OUTPUT GTP FOR HMASMXRF                       */ 00906000
*   /*                                                               */ 00907000
*   /*****************************************************************/ 00908000
*                                                                  0341 00909000
*   GTPRCDLN(2)=LENGTH(XRFRCD);     /* RECORD LENGTH                 */ 00910000
         MVC   GTPRCDLN+28(2),@CH00470                             0341 00911000
*   GTPBUFAD(2)=ADDR(XRFRCD);       /* RECORD BUFFER ADDRESS         */ 00912000
*                                                                  0342 00913000
         LA    @05,XRFRCD                                          0342 00914000
         ST    @05,GTPBUFAD+28                                     0342 00915000
*   /*****************************************************************/ 00916000
*   /*                                                               */ 00917000
*   /* INITIALIZE LISTPARM PASSED TO HMASMXRF                        */ 00918000
*   /*                                                               */ 00919000
*   /*****************************************************************/ 00920000
*                                                                  0343 00921000
*   LISTPARM=''B;                   /* CLEAR LISTPARM PASSED TO    0343 00922000
*                                      HMASMXRF                      */ 00923000
         XC    LISTPARM(19),LISTPARM                               0343 00924000
*   LISTLMD=ON;                     /* LMOD ENTRIES                  */ 00925000
         OI    LISTLMD,B'00100000'                                 0344 00926000
*   LISTXREF=ON;                    /* XREF FUNCTION                 */ 00927000
         OI    LISTXREF,B'01000000'                                0345 00928000
*   LISTCDS=ON;                     /* ... GET CDS LMODS             */ 00929000
         OI    LISTCDS,B'01000000'                                 0346 00930000
*   LISTSEL=ON;                     /* ... USE SELECT LIST PASSED    */ 00931000
*                                                                  0347 00932000
         OI    LISTSEL,B'10000000'                                 0347 00933000
*   /*****************************************************************/ 00934000
*   /*                                                               */ 00935000
*   /* BUILD LMOD-TO-MOD XREF GTA FILE                               */ 00936000
*   /*                                                               */ 00937000
*   /*****************************************************************/ 00938000
*                                                                  0348 00939000
*   IF DELLMRC<STOPPTF              /* NO TERMINATING ERRORS         */ 00940000
*     THEN                                                         0348 00941000
         L     @05,@PC00004                                        0348 00942000
         L     @05,DELLMRC(,@05)                                   0348 00943000
         CH    @05,@CH00110                                        0348 00944000
         BNL   @RF00348                                            0348 00945000
*     DO;                                                          0349 00946000
*       CALL HMASMXRF(LISTPARM,     /* LIST PARM LIST                */ 00947000
*           HMASMGTP(2),            /* GTP FOR OUTPUT GTA FILE       */ 00948000
*           HMASMGTP(1));           /* GTP FOR SET GTA FILE          */ 00949000
         L     @15,@CV01857                                        0350 00950000
         LA    @01,@AL00350                                        0350 00951000
         BALR  @14,@15                                             0350 00952000
*       RESPECIFY                                                  0351 00953000
*         REG15 RSTD;                                              0351 00954000
*       IF REG15>=STOPPTF           /* TERMINATING ERROR             */ 00955000
*         THEN                                                     0352 00956000
         CH    REG15,@CH00110                                      0352 00957000
         BL    @RF00352                                            0352 00958000
*         DELLMRC=MAX(DELLMRC,REG15);                              0353 00959000
         L     @14,@PC00004                                        0353 00960000
         L     @05,DELLMRC(,@14)                                   0353 00961000
         CR    @05,REG15                                           0353 00962000
         BNL   *+6                                                      00963000
         LR    @05,REG15                                           0353 00964000
         ST    @05,DELLMRC(,@14)                                   0353 00965000
*       RESPECIFY                                                  0354 00966000
*         REG15 UNRSTD;                                            0354 00967000
@RF00352 DS    0H                                                  0355 00968000
*     END;                                                         0355 00969000
*                                                                  0356 00970000
*   /*****************************************************************/ 00971000
*   /*                                                               */ 00972000
*   /* GO THRU THE LMODS IN THE SET GTA FILE AND CALL DELLMOD PROC   */ 00973000
*   /* FOR EACH LOAD MODULE                                          */ 00974000
*   /*                                                               */ 00975000
*   /*****************************************************************/ 00976000
*                                                                  0356 00977000
*   GTPFUNCT(1)=GTPOPENN;           /* RESTART GTA FILE FROM START   */ 00978000
@RF00348 MVI   GTPFUNCT,X'01'                                      0356 00979000
*   GTPRCDLN(1)=LENGTH(HMASMSET);   /* RECORD LENGTH                 */ 00980000
         MVC   GTPRCDLN(2),@CH00032                                0357 00981000
*   GTPBUFAD(1)=ADDR(HMASMSET);     /* RECORD BUFFER ADDRESS         */ 00982000
         LA    @05,HMASMSET                                        0358 00983000
         ST    @05,GTPBUFAD                                        0358 00984000
*   CALL HMASMGTA(HMASMGTP(1));                                    0359 00985000
         L     @15,@CV01853                                        0359 00986000
         LA    @01,@AL00359                                        0359 00987000
         BALR  @14,@15                                             0359 00988000
*   GTPFUNCT(1)=GTPGETN;            /* GET NEXT RECORD FUNCTION      */ 00989000
         MVI   GTPFUNCT,X'08'                                      0360 00990000
*   CALL HMASMGTA(HMASMGTP(1));     /* GET FIRST RECORD              */ 00991000
         L     @15,@CV01853                                        0361 00992000
         LA    @01,@AL00361                                        0361 00993000
         BALR  @14,@15                                             0361 00994000
*   DO WHILE GTPRETRN(1)=GTPGOOD;                                  0362 00995000
         B     @DE00362                                            0362 00996000
@DL00362 DS    0H                                                  0363 00997000
*     CALL DELLMOD(SENAME,DELLMRC); /* SEE IF LOAD MODULE SHOULD BE     00998000
*                                      DELETED ... IF SO, DELETE IT  */ 00999000
         LA    @05,SENAME                                          0363 01000000
         ST    @05,@AL00001                                        0363 01001000
         L     @05,@PC00004                                        0363 01002000
         ST    @05,@AL00001+4                                      0363 01003000
         LA    @01,@AL00001                                        0363 01004000
         BAL   @14,DELLMOD                                         0363 01005000
*     CALL HMASMGTA(HMASMGTP(1));   /* GET NEXT RECORD FROM SELECT 0364 01006000
*                                      LIST GTA FILE                 */ 01007000
         L     @15,@CV01853                                        0364 01008000
         LA    @01,@AL00364                                        0364 01009000
         BALR  @14,@15                                             0364 01010000
*   END;                                                           0365 01011000
*                                                                  0365 01012000
@DE00362 CLI   GTPRETRN,0                                          0365 01013000
         BE    @DL00362                                            0365 01014000
*   /*****************************************************************/ 01015000
*   /*                                                               */ 01016000
*   /* FREE THE GTA FILES                                            */ 01017000
*   /*                                                               */ 01018000
*   /*****************************************************************/ 01019000
*                                                                  0366 01020000
*   GTPFUNCT(1)=GTPFREE;            /* FREE SELECT LIST FILE         */ 01021000
         MVI   GTPFUNCT,X'0A'                                      0366 01022000
*   CALL HMASMGTA(HMASMGTP(1));                                    0367 01023000
         L     @15,@CV01853                                        0367 01024000
         LA    @01,@AL00367                                        0367 01025000
         BALR  @14,@15                                             0367 01026000
*   GTPFUNCT(2)=GTPFREE;            /* FREE LMOD-TO-MOD FILE         */ 01027000
         MVI   GTPFUNCT+28,X'0A'                                   0368 01028000
*   CALL HMASMGTA(HMASMGTP(2));                                    0369 01029000
         L     @15,@CV01853                                        0369 01030000
         LA    @01,@AL00369                                        0369 01031000
         BALR  @14,@15                                             0369 01032000
*   RETURN;                                                        0370 01033000
@EL00004 DS    0H                                                  0370 01034000
@EF00004 DS    0H                                                  0370 01035000
@ER00004 LM    @14,@12,@SA00004                                    0370 01036000
         BR    @14                                                 0370 01037000
*   END DELLMODS;                                                  0371 01038000
*                                                                  0372 01039000
*/********************************************************************/ 01040000
*/*                                                                  */ 01041000
*/*  DELLMOD    - DETERMINE WHETHER THE LOAD MODULE PASSED MAY       */ 01042000
*/*               BE DELETED FROM THE TARGET SYSTEM AND WHETHER      */ 01043000
*/*               THE LMOD ENTRY MAY BE DELETED FROM THE CDS.        */ 01044000
*/*                                                                  */ 01045000
*/*             - CALL LMODDEL TO DO THE ACTUAL DELETION OF THE      */ 01046000
*/*               LOAD MODULE AND CDS LMOD ENTRY.                    */ 01047000
*/*                                                                  */ 01048000
*/*               * THE LOAD MODULE MAY BE DELETED IF ALL OF THE     */ 01049000
*/*                 MODULES WHICH MAKE UP THE LOAD MODULE ARE        */ 01050000
*/*                 FOUND IN THE ICT MARKED AS SELECTED.             */ 01051000
*/*                                                                  */ 01052000
*/*               * THE CDS LMOD ENTRY MAY BE DELETED IF ALL THE     */ 01053000
*/*                 MODULES WHICH MAKE UP THE LOAD MODULE ARE        */ 01054000
*/*                 FOUND IN THE ICT MARKED AS SELECTED (ICTMISEL)   */ 01055000
*/*                 FOR DELETION (ICTMIDEL).                         */ 01056000
*/*                                                                  */ 01057000
*/*               * THE CDS LMOD ENTRY MUST BE BACKED UP IF ANY      */ 01058000
*/*                 OF THE MODS WHICH MAKE UP THE LOAD MODULE ARE    */ 01059000
*/*                 NOT FROM A DELETED SYSMOD.                       */ 01060000
*/*                                                                  */ 01061000
*/*               NOTE - THE LMOD-TO-MOD GTA FILE IS EXPECTED TO     */ 01062000
*/*               BE INITIALIZED WITH MOD DATA FOR THE LOAD MODULE   */ 01063000
*/*               PASSED TO THIS PROCEDURE.                          */ 01064000
*/*                                                                  */ 01065000
*/********************************************************************/ 01066000
*                                                                  0372 01067000
*DELLMOD:                                                          0372 01068000
*   PROC(LMDNAME,DELLMRC1);                                        0372 01069000
DELLMOD  STM   @14,@12,@SA00005                                    0372 01070000
         MVC   @PC00005(8),0(@01)                                  0372 01071000
*   DCL                                                            0373 01072000
*     LMDNAME CHAR(8);              /* LOAD MODULE NAME              */ 01073000
*   DCL                                                            0374 01074000
*     DELLMRC1 FIXED(31);           /* RETURN CODE PARAMETER         */ 01075000
*   DCL                                                            0375 01076000
*     MPTR PTR(31);                 /* PTR TO AN ICT MOD SECT ENTRY  */ 01077000
*   CURNTLMD=LMDNAME;               /* LMOD "CURRENTLY BEING       0376 01078000
*                                      PROCESSED" AS PASSED BY CALLER*/ 01079000
         L     @05,@PC00005                                        0376 01080000
         MVC   CURNTLMD(8),LMDNAME(@05)                            0376 01081000
*                                                                  0377 01082000
*   /*****************************************************************/ 01083000
*   /*                                                               */ 01084000
*   /* INITIALIZE FOR LOAD MODULE DELETE PROCESSING                  */ 01085000
*   /*                                                               */ 01086000
*   /*****************************************************************/ 01087000
*                                                                  0377 01088000
*   DLLMFLGS=''B;                   /* CLEAR LMOD PROCESSING FLAGS   */ 01089000
*                                                                  0377 01090000
         MVI   DLLMFLGS,X'00'                                      0377 01091000
*   /*****************************************************************/ 01092000
*   /*                                                               */ 01093000
*   /* LOCATE LOAD MODULE PASSED IN LMOD-TO-MOD GTA FILE             */ 01094000
*   /*                                                               */ 01095000
*   /*****************************************************************/ 01096000
*                                                                  0378 01097000
*   IF DELLMRC1<STOPPTF             /* NO TERMINATING ERRORS         */ 01098000
*     THEN                                                         0378 01099000
         L     @05,@PC00005+4                                      0378 01100000
         L     @05,DELLMRC1(,@05)                                  0378 01101000
         CH    @05,@CH00110                                        0378 01102000
         BNL   @RF00378                                            0378 01103000
*     DO;                                                          0379 01104000
*       ALLMODS=ON;                 /* ASSUME ALL MODS FOR LMOD ARE     01105000
*                                      IN THE ICT                    */ 01106000
*       ALLIDEL=ON;                 /* ASSUME ALL MODS FOR LMOD ARE     01107000
*                                      IN THE ICT AND BEING DELETED  */ 01108000
         OI    ALLMODS,B'11000000'                                 0381 01109000
*       IF CPTF->ICTPDEXP(1)=OFF    /* "CURRENT" SYSMOD NOT DELETED  */ 01110000
*           &CPTF->ICTPDIMP(1)=OFF  /* "CURRENT" SYSMOD NOT DELETED  */ 01111000
*         THEN                                                     0382 01112000
         L     @05,CPTF                                            0382 01113000
         TM    ICTPDEXP(@05),B'00110000'                           0382 01114000
         BNZ   @RF00382                                            0382 01115000
*         LMBKUP=ON;                /* ASSUME BACKUP IS REQUIRED     */ 01116000
         OI    LMBKUP,B'00010000'                                  0383 01117000
*       GTPFUNCT(2)=GTPLOC;         /* LOCATE RECORD IN FILE         */ 01118000
@RF00382 MVI   GTPFUNCT+28,X'03'                                   0384 01119000
*       GTPRCDLN(2)=LENGTH(XRFRCD); /* RECORD LENGTH                 */ 01120000
         MVC   GTPRCDLN+28(2),@CH00470                             0385 01121000
*       GTPKEYLN(2)=LENGTH(XRFETYPE)+LENGTH(XRFENAME);/* KEY LENGTH  */ 01122000
         MVC   GTPKEYLN+28(2),@CH00432                             0386 01123000
*       GTPBUFAD(2)=ADDR(XRFRCD);   /* RECORD BUFFER ADDRESS         */ 01124000
         LA    @05,XRFRCD                                          0387 01125000
         ST    @05,GTPBUFAD+28                                     0387 01126000
*       XRFKEY1=''B;                /* CLEAR ENTIRE KEY FIELD        */ 01127000
         XC    XRFKEY1(29),XRFKEY1                                 0388 01128000
*       XRFETYPE=IOPLMD;            /* SET ELEMENT TYPE - LOAD MODULE*/ 01129000
         MVI   XRFETYPE,X'02'                                      0389 01130000
*       XRFENAME=CURNTLMD;          /* SET ELEMENT NAME - NAME PASSD.*/ 01131000
         MVC   XRFENAME(8),CURNTLMD                                0390 01132000
*       CALL HMASMGTA(HMASMGTP(2)); /* *** LOCATE LOAD MODULE ***    */ 01133000
         L     @15,@CV01853                                        0391 01134000
         LA    @01,@AL00391                                        0391 01135000
         BALR  @14,@15                                             0391 01136000
*       IF GTPRETRN(2)=GTPGOOD      /* LMOD FOUND IN FILE            */ 01137000
*         THEN                                                     0392 01138000
         CLI   GTPRETRN+28,0                                       0392 01139000
         BNE   @RF00392                                            0392 01140000
*         DO;                                                      0393 01141000
*           GTPFUNCT(2)=GTPSTRTN;   /* RESTART GET-NEXT OPERATION AT    01142000
*                                      RECORD JUST LOCATED           */ 01143000
         MVI   GTPFUNCT+28,X'06'                                   0394 01144000
*           CALL HMASMGTA(HMASMGTP(2));/* RESTART GET-NEXT           */ 01145000
         L     @15,@CV01853                                        0395 01146000
         LA    @01,@AL00395                                        0395 01147000
         BALR  @14,@15                                             0395 01148000
*           IF GTPRETRN(2)=GTPGOOD  /* RESTART SUCCESSFUL            */ 01149000
*             THEN                                                 0396 01150000
         CLI   GTPRETRN+28,0                                       0396 01151000
         BNE   @RF00396                                            0396 01152000
*             DO;                                                  0397 01153000
*               GTPFUNCT(2)=GTPGETN;/* GET-NEXT RECORD OPERATION     */ 01154000
         MVI   GTPFUNCT+28,X'08'                                   0398 01155000
*               CALL HMASMGTA(HMASMGTP(2));/* GET FIRST RECORD       */ 01156000
         L     @15,@CV01853                                        0399 01157000
         LA    @01,@AL00399                                        0399 01158000
         BALR  @14,@15                                             0399 01159000
*             END;                                                 0400 01160000
*         END;                                                     0401 01161000
@RF00396 DS    0H                                                  0402 01162000
*     END;                                                         0402 01163000
@RF00392 DS    0H                                                  0403 01164000
*                                                                  0403 01165000
*   /*****************************************************************/ 01166000
*   /*                                                               */ 01167000
*   /* GO THRU LMOD-TO-MOD XREF GTA FILE. DETERMINE WHETHER THE LOAD */ 01168000
*   /* MODULE MAY BE DELETED BY CHECKING THE ICT FOR EACH MOD WHICH  */ 01169000
*   /* MAKES UP THE LOAD MODULE.                                     */ 01170000
*   /*                                                               */ 01171000
*   /*****************************************************************/ 01172000
*                                                                  0403 01173000
*   DO WHILE DELLMRC1<STOPPTF       /* NO TERMINATING ERRORS         */ 01174000
*         &XRF2LMD=CURNTLMD         /* STILL LMOD PASSED             */ 01175000
*         &ALLMODS=ON               /* ALL MODS (SO FAR) ARE IN ICT  */ 01176000
*         &GTPRETRN(2)=GTPGOOD;     /* NOT AT END OF GTA FILE        */ 01177000
*                                                                  0403 01178000
@RF00378 B     @DE00403                                            0403 01179000
@DL00403 DS    0H                                                  0404 01180000
*     /***************************************************************/ 01181000
*     /*                                                             */ 01182000
*     /* A MOD FOUND WHICH MAKES UP THIS LOAD MODULE ... CHECK THE   */ 01183000
*     /* ICT FOR THE STATUS OF THE MOD                               */ 01184000
*     /*                                                             */ 01185000
*     /***************************************************************/ 01186000
*                                                                  0404 01187000
*     CALL SRCHMOD(XRF2MOD,MPTR);   /* SEARCH ICT FOR A SELECTED OR     01188000
*                                      DELETED VERSION OF THIS MOD   */ 01189000
         LA    @01,@AL00404                                        0404 01190000
         BAL   @14,SRCHMOD                                         0404 01191000
*     IF MPTR=0                     /* MOD (FOR LMOD) NOT IN ICT     */ 01192000
*       THEN                                                       0405 01193000
         ICM   @05,15,MPTR                                         0405 01194000
         BNZ   @RF00405                                            0405 01195000
*       ALLMODS=OFF;                /* ALL MODS ARE NOT IN THE ICT 0406 01196000
*                                      ... LOAD MODULE CANNOT BE   0406 01197000
*                                      DELETED                       */ 01198000
         NI    ALLMODS,B'01111111'                                 0406 01199000
*     ELSE                                                         0407 01200000
*       DO;                                                        0407 01201000
*                                                                  0407 01202000
         B     @RC00405                                            0407 01203000
@RF00405 DS    0H                                                  0408 01204000
*         /***********************************************************/ 01205000
*         /*                                                         */ 01206000
*         /* MOD (FOR LMOD) IS IN ICT ... CHECK IT TO DETERMINE WHAT */ 01207000
*         /* SHOULD BE DONE TO THE CDS LMOD ENTRY                    */ 01208000
*         /*                                                         */ 01209000
*         /***********************************************************/ 01210000
*                                                                  0408 01211000
*         IF MPTR->ICTMIDEL(1)=ON   /* MOD SELECTED FOR DELETION     */ 01212000
*             &MPTR->ICTPPTR(1)->ICTPDEXP(1)=OFF/* MOD IS NOT FROM 0408 01213000
*                                      ...                           */ 01214000
*             &MPTR->ICTPPTR(1)->ICTPDIMP(1)=OFF/* .. A DELETED    0408 01215000
*                                      SYSMOD                        */ 01216000
*           THEN                                                   0408 01217000
         L     @05,MPTR                                            0408 01218000
         TM    ICTMIDEL(@05),B'01000000'                           0408 01219000
         BNO   @RF00408                                            0408 01220000
         L     @05,ICTPPTR(,@05)                                   0408 01221000
         TM    ICTPDEXP(@05),B'00110000'                           0408 01222000
         BNZ   @RF00408                                            0408 01223000
*           LMBKUP=ON;              /* LMOD ENTRY BACKUP REQUIRED    */ 01224000
         OI    LMBKUP,B'00010000'                                  0409 01225000
*         IF MPTR->ICTMIDEL(1)=OFF  /* NOT A DELETED MOD             */ 01226000
*           THEN                                                   0410 01227000
@RF00408 L     @05,MPTR                                            0410 01228000
         TM    ICTMIDEL(@05),B'01000000'                           0410 01229000
         BNZ   @RF00410                                            0410 01230000
*           ALLIDEL=OFF;            /* A NON-DELETED MOD FOUND       */ 01231000
         NI    ALLIDEL,B'10111111'                                 0411 01232000
*       END;                                                       0412 01233000
@RF00410 DS    0H                                                  0413 01234000
*     CALL HMASMGTA(HMASMGTP(2));   /* GET NEXT XREF GTA RECORD      */ 01235000
@RC00405 L     @15,@CV01853                                        0413 01236000
         LA    @01,@AL00413                                        0413 01237000
         BALR  @14,@15                                             0413 01238000
*   END;                                                           0414 01239000
@DE00403 L     @05,@PC00005+4                                      0414 01240000
         L     @05,DELLMRC1(,@05)                                  0414 01241000
         CH    @05,@CH00110                                        0414 01242000
         BNL   @DC00403                                            0414 01243000
         CLC   XRF2LMD(8),CURNTLMD                                 0414 01244000
         BNE   @DC00403                                            0414 01245000
         TM    ALLMODS,B'10000000'                                 0414 01246000
         BNO   @DC00403                                            0414 01247000
         CLI   GTPRETRN+28,0                                       0414 01248000
         BE    @DL00403                                            0414 01249000
@DC00403 DS    0H                                                  0415 01250000
*                                                                  0415 01251000
*   /*****************************************************************/ 01252000
*   /*                                                               */ 01253000
*   /* ALL RECORDS IN LMOD-TO-MOD FILE FOR THE CURRENT LMOD HAVE BEEN*/ 01254000
*   /* PROCESSED                                                     */ 01255000
*   /*                                                               */ 01256000
*   /*****************************************************************/ 01257000
*                                                                  0415 01258000
*   IF ALLMODS=ON                   /* ALL MODS FOR LMOD FOUND IN ICT   01259000
*                                      ... LOAD MOD DELETEABLE       */ 01260000
*       &DELLMRC1<STOPPTF           /* NO TERMINATING ERRORS         */ 01261000
*     THEN                                                         0415 01262000
*                                                                  0415 01263000
         TM    ALLMODS,B'10000000'                                 0415 01264000
         BNO   @RF00415                                            0415 01265000
         L     @05,@PC00005+4                                      0415 01266000
         L     @15,DELLMRC1(,@05)                                  0415 01267000
         CH    @15,@CH00110                                        0415 01268000
         BNL   @RF00415                                            0415 01269000
*     /***************************************************************/ 01270000
*     /*                                                             */ 01271000
*     /* DELETE THE LOAD MODULE FROM TARGET LIBRARIES AND THE LMOD   */ 01272000
*     /* ENTRY FROM THE CDS (IF APPROPRIATE)                         */ 01273000
*     /*                                                             */ 01274000
*     /***************************************************************/ 01275000
*                                                                  0416 01276000
*     CALL LMODDEL(DELLMRC1);       /* DELETE LMOD "CURNTLMD"        */ 01277000
         ST    @05,@AL00001                                        0416 01278000
         LA    @01,@AL00001                                        0416 01279000
         BAL   @14,LMODDEL                                         0416 01280000
*   RETURN;                                                        0417 01281000
@EL00005 DS    0H                                                  0417 01282000
@EF00005 DS    0H                                                  0417 01283000
@ER00005 LM    @14,@12,@SA00005                                    0417 01284000
         BR    @14                                                 0417 01285000
*   END DELLMOD;                                                   0418 01286000
         B     @EL00005                                            0418 01287000
*                                                                  0419 01288000
*/********************************************************************/ 01289000
*/*                                                                  */ 01290000
*/*  DELENTRY   - DELETE AN (A)CDS ELEMENT ENTRY (MOD, MAC OR SRC)   */ 01291000
*/*                                                                  */ 01292000
*/*                                                                  */ 01293000
*/*                                                                  */ 01294000
*/********************************************************************/ 01295000
*                                                                  0419 01296000
*DELENTRY:                                                         0419 01297000
*   PROC(MLENTRY,DELENTRC);                                        0419 01298000
DELENTRY STM   @14,@12,@SA00006                                    0419 01299000
         MVC   @PC00006(8),0(@01)                                  0419 01300000
*   DCL                                                            0420 01301000
*     MLENTRY CHAR(*);              /* ICT MOD ENTRY                 */ 01302000
*   DCL                                                            0421 01303000
*     DELENTRC FIXED(31);           /* RETURN CODE PARAMETER         */ 01304000
*                                                                  0421 01305000
*   /*****************************************************************/ 01306000
*   /*                                                               */ 01307000
*   /* INITIALIZE LOCAL IOP FOR PROCESSING                           */ 01308000
*   /*                                                               */ 01309000
*   /*****************************************************************/ 01310000
*                                                                  0422 01311000
*   RESPECIFY                                                      0422 01312000
*     ICTMOD BASED(ADDR(MLENTRY));  /* ADDRESS ICT MOD ENTRY PASSED  */ 01313000
*   IF CCAAPPLY=ON                  /* APPLY PROCESSING              */ 01314000
*       |CCARES=ON                  /* RESTORE PROCESSING            */ 01315000
*     THEN                                                         0423 01316000
         TM    CCAAPPLY(CCAPTR),B'01001000'                        0423 01317000
         BZ    @RF00423                                            0423 01318000
*     LOCALIOP->IOPDSID=IOPCDS;     /* ... USE CDS DATASET           */ 01319000
         MVI   IOPDSID(LOCALIOP),X'02'                             0424 01320000
*   ELSE                                                           0425 01321000
*     LOCALIOP->IOPDSID=IOPACDS;    /* ... USE ACDS DATASET          */ 01322000
         B     @RC00423                                            0425 01323000
@RF00423 MVI   IOPDSID(LOCALIOP),X'0C'                             0425 01324000
*   LOCALIOP->IOPFUNCT=IOPSTOWD;    /* DELETE                        */ 01325000
*                                                                  0426 01326000
@RC00423 MVI   IOPFUNCT(LOCALIOP),X'53'                            0426 01327000
*   /*****************************************************************/ 01328000
*   /*                                                               */ 01329000
*   /* INITIALIZE IOP FOR DELETION OF (A)CDS MOD/MAC/SRC ENTRY       */ 01330000
*   /*                                                               */ 01331000
*   /*****************************************************************/ 01332000
*                                                                  0427 01333000
*   LOCALIOP->IOPNAME=ICTMNAME(1);  /* ... SET ENTRY NAME            */ 01334000
         L     @05,@PC00006                                        0427 01335000
         MVC   IOPNAME(8,LOCALIOP),ICTMNAME(@05)                   0427 01336000
*   IF ICTMMOD(1)=ON                /* MOD REPLACEMENT               */ 01337000
*     THEN                                                         0428 01338000
         TM    ICTMMOD(@05),B'10000000'                            0428 01339000
         BNO   @RF00428                                            0428 01340000
*     LOCALIOP->IOPTYPE=IOPMOD;     /* ... SET ENTRY TYPE            */ 01341000
         MVI   IOPTYPE(LOCALIOP),X'05'                             0429 01342000
*   ELSE                                                           0430 01343000
*     IF ICTMSRCR(1)=ON             /* SOURCE REPLACEMENT            */ 01344000
*       THEN                                                       0430 01345000
         B     @RC00428                                            0430 01346000
@RF00428 L     @05,@PC00006                                        0430 01347000
         TM    ICTMSRCR(@05),B'00000010'                           0430 01348000
         BNO   @RF00430                                            0430 01349000
*       LOCALIOP->IOPTYPE=IOPSRC;   /* ... SET ENTRY TYPE            */ 01350000
         MVI   IOPTYPE(LOCALIOP),X'08'                             0431 01351000
*     ELSE                                                         0432 01352000
*       IF ICTMMACR(1)=ON           /* MACRO REPLACEMENT             */ 01353000
*         THEN                                                     0432 01354000
         B     @RC00430                                            0432 01355000
@RF00430 L     @05,@PC00006                                        0432 01356000
         TM    ICTMMACR(@05),B'00001000'                           0432 01357000
         BNO   @RF00432                                            0432 01358000
*         LOCALIOP->IOPTYPE=IOPMAC; /* ... SET ENTRY TYPE            */ 01359000
*                                                                  0433 01360000
         MVI   IOPTYPE(LOCALIOP),X'03'                             0433 01361000
*   /*****************************************************************/ 01362000
*   /*                                                               */ 01363000
*   /* DELETE THE ENTRY FROM THE (A)CDS                              */ 01364000
*   /*                                                               */ 01365000
*   /*****************************************************************/ 01366000
*                                                                  0434 01367000
*   CALL HMASMIO(LOCALIOP->HMASMIOP);                              0434 01368000
@RF00432 DS    0H                                                  0434 01369000
@RC00430 DS    0H                                                  0434 01370000
@RC00428 ST    LOCALIOP,@AL00001                                   0434 01371000
         L     @15,@CV01854                                        0434 01372000
         LA    @01,@AL00001                                        0434 01373000
         BALR  @14,@15                                             0434 01374000
*   DELENTRC=MAX(DELENTRC,LOCALIOP->IOPRETRN);                     0435 01375000
         L     @05,@PC00006+4                                      0435 01376000
         L     @15,DELENTRC(,@05)                                  0435 01377000
         SLR   @14,@14                                             0435 01378000
         IC    @14,IOPRETRN(,LOCALIOP)                             0435 01379000
         CR    @15,@14                                             0435 01380000
         BNL   *+6                                                      01381000
         LR    @15,@14                                             0435 01382000
         ST    @15,DELENTRC(,@05)                                  0435 01383000
*   RETURN;                                                        0436 01384000
@EL00006 DS    0H                                                  0436 01385000
@EF00006 DS    0H                                                  0436 01386000
@ER00006 LM    @14,@12,@SA00006                                    0436 01387000
         BR    @14                                                 0436 01388000
*   END DELENTRY;                                                  0437 01389000
*                                                                  0438 01390000
*/********************************************************************/ 01391000
*/*                                                                  */ 01392000
*/*  DELMEMBR   - DELETE A MEMBER FROM A TARGET SYSTEM LIBRARY       */ 01393000
*/*                                                                  */ 01394000
*/*                                                                  */ 01395000
*/*                                                                  */ 01396000
*/********************************************************************/ 01397000
*                                                                  0438 01398000
*DELMEMBR:                                                         0438 01399000
*   PROC(MEMBRNAM,MEMBRTP,DDNAME,DELMEMRC);                        0438 01400000
DELMEMBR STM   @14,@12,@SA00007                                    0438 01401000
         MVC   @PC00007(16),0(@01)                                 0438 01402000
*   DCL                                                            0439 01403000
*     MEMBRNAM CHAR(8);             /* MEMBER NAME                   */ 01404000
*   DCL                                                            0440 01405000
*     MEMBRTP FIXED(8);             /* MEMBER TYPE (IOPTYPE VALUES)  */ 01406000
*   DCL                                                            0441 01407000
*     DDNAME CHAR(8);               /* DDNAME OF LIBRARY FROM WHICH     01408000
*                                      ELEMENT IS TO BE DELETED      */ 01409000
*   DCL                                                            0442 01410000
*     DELMEMRC FIXED(31);           /* RETURN CODE PARAMETER         */ 01411000
*   IF DDNAME^=BLANKDDN             /* VALID DDNAME (NON-BLANKS)     */ 01412000
*       &DDNAME^=ZERODDN            /* VALID DDNAME (NON-ZEROS)      */ 01413000
*       &DDNAME^=SYSPUNCH           /* VALID DDNAME (NOT "SYSPUNCH") */ 01414000
*     THEN                                                         0443 01415000
         L     @05,@PC00007+8                                      0443 01416000
         CLC   DDNAME(8,@05),@CC01867                              0443 01417000
         BE    @RF00443                                            0443 01418000
         CLC   DDNAME(8,@05),ZERODDN                               0443 01419000
         BE    @RF00443                                            0443 01420000
         CLC   DDNAME(8,@05),@CC01872                              0443 01421000
         BE    @RF00443                                            0443 01422000
*     DO;                                                          0444 01423000
*                                                                  0444 01424000
*       /*************************************************************/ 01425000
*       /*                                                           */ 01426000
*       /* INITIALIZE IOP FOR PROCESSING                             */ 01427000
*       /*                                                           */ 01428000
*       /*************************************************************/ 01429000
*                                                                  0445 01430000
*       LOCALIOP->IOPNAME=MEMBRNAM; /* MEMBER NAME PASSED            */ 01431000
         L     @15,@PC00007                                        0445 01432000
         MVC   IOPNAME(8,LOCALIOP),MEMBRNAM(@15)                   0445 01433000
*       LOCALIOP->IOPDSID=IOPDDNM;  /* DATASET SPECIFIED VIA DDNAME  */ 01434000
         MVI   IOPDSID(LOCALIOP),X'0E'                             0446 01435000
*       LOCALIOP->IOPDELDD=DDNAME;  /* DDNAME PASSED                 */ 01436000
         MVC   IOPDELDD(8,LOCALIOP),DDNAME(@05)                    0447 01437000
*       LOCALIOP->IOPTYPE=IOPMEM;   /* NON-SMP DATASET MEMBER        */ 01438000
         MVI   IOPTYPE(LOCALIOP),X'11'                             0448 01439000
*       LOCALIOP->IOPFUNCT=IOPSTOWD;/* STOW DELETE MEMBER            */ 01440000
*                                                                  0449 01441000
         MVI   IOPFUNCT(LOCALIOP),X'53'                            0449 01442000
*       /*************************************************************/ 01443000
*       /*                                                           */ 01444000
*       /* DELETE MEMBER                                             */ 01445000
*       /*                                                           */ 01446000
*       /*************************************************************/ 01447000
*                                                                  0450 01448000
*       CALL HMASMIO(LOCALIOP->HMASMIOP);                          0450 01449000
         ST    LOCALIOP,@AL00001                                   0450 01450000
         L     @15,@CV01854                                        0450 01451000
         LA    @01,@AL00001                                        0450 01452000
         BALR  @14,@15                                             0450 01453000
*       DELMEMRC=MAX(DELMEMRC,LOCALIOP->IOPRETRN);                 0451 01454000
         L     @05,@PC00007+12                                     0451 01455000
         L     @15,DELMEMRC(,@05)                                  0451 01456000
         SLR   @14,@14                                             0451 01457000
         IC    @14,IOPRETRN(,LOCALIOP)                             0451 01458000
         CR    @15,@14                                             0451 01459000
         BNL   *+6                                                      01460000
         LR    @15,@14                                             0451 01461000
         ST    @15,DELMEMRC(,@05)                                  0451 01462000
*     END;                                                         0452 01463000
*   IF DDNAME^=BLANKDDN             /* VALID DDNAME (NON-BLANKS)     */ 01464000
*       &DDNAME^=ZERODDN            /* VALID DDNAME (NON-ZEROS)      */ 01465000
*       &DDNAME^=SYSPUNCH           /* VALID DDNAME (NOT "SYSPUNCH") */ 01466000
*       &LOCALIOP->IOPRETRN=IOPGOOD /* DELETED SUCCESSFULLY          */ 01467000
*     THEN                                                         0453 01468000
@RF00443 L     @05,@PC00007+8                                      0453 01469000
         CLC   DDNAME(8,@05),@CC01867                              0453 01470000
         BE    @RF00453                                            0453 01471000
         CLC   DDNAME(8,@05),ZERODDN                               0453 01472000
         BE    @RF00453                                            0453 01473000
         CLC   DDNAME(8,@05),@CC01872                              0453 01474000
         BE    @RF00453                                            0453 01475000
         CLI   IOPRETRN(LOCALIOP),0                                0453 01476000
         BNE   @RF00453                                            0453 01477000
*     DO;                                                          0454 01478000
*                                                                  0454 01479000
*       /*************************************************************/ 01480000
*       /*                                                           */ 01481000
*       /* CHECK TST GTA FILE TO SEE IF HMA224 HAS ALREADY BEEN      */ 01482000
*       /* ISSUED FOR THIS MEMBER/DDNAME                             */ 01483000
*       /*                                                           */ 01484000
*       /*************************************************************/ 01485000
*                                                                  0455 01486000
*       GTPFUNCT(3)=GTPLOC;         /* LOCATE                        */ 01487000
         MVI   GTPFUNCT+56,X'03'                                   0455 01488000
*       TSTMEMNM=MEMBRNAM;          /* ... MEMBER NAME               */ 01489000
         L     @15,@PC00007                                        0456 01490000
         MVC   TSTMEMNM(8),MEMBRNAM(@15)                           0456 01491000
*       TSTDDNAM=DDNAME;            /* ... DDNAME                    */ 01492000
         MVC   TSTDDNAM(8),DDNAME(@05)                             0457 01493000
*       CALL HMASMGTA(HMASMGTP(3)); /* CHECK GTA FILE                */ 01494000
         L     @15,@CV01853                                        0458 01495000
         LA    @01,@AL00458                                        0458 01496000
         BALR  @14,@15                                             0458 01497000
*       IF GTPRETRN(3)=GTPNTFND     /* MEMBER NOT ALREADY DELETED    */ 01498000
*         THEN                                                     0459 01499000
         CLI   GTPRETRN+56,4                                       0459 01500000
         BNE   @RF00459                                            0459 01501000
*         DO;                                                      0460 01502000
*                                                                  0460 01503000
*           /*********************************************************/ 01504000
*           /*                                                       */ 01505000
*           /* ISSUE HMA224I FOR MEMBER WHICH WAS DELETED            */ 01506000
*           /*                                                       */ 01507000
*           /*********************************************************/ 01508000
*                                                                  0461 01509000
*           HMASMMGP=''B;           /* CLEAR HMASMMSG PARM LIST      */ 01510000
         XC    HMASMMGP(24),HMASMMGP                               0461 01511000
*           MGPMGNO1=HMA224I;       /* HMA224I - PRIMARY MSG #       */ 01512000
         MVC   MGPMGNO1(2),@CH00460                                0462 01513000
*           MGPMGNO2=PART031;       /* ... MESSAGE PART              */ 01514000
         MVC   MGPMGNO2(2),@CH00040                                0463 01515000
*           MGPMGNO3=PART016;       /* ... MESSAGE PART              */ 01516000
         MVC   MGPMGNO3(2),@CH00186                                0464 01517000
*           MGPPRINT=ON;            /* ROUTE MSG TO SMPOUT           */ 01518000
         OI    MGPPRINT,B'10000000'                                0465 01519000
*           MGPTYPE=MGPINFO;        /* INFORMATIONAL MESSAGE         */ 01520000
         MVI   MGPTYPE,X'01'                                       0466 01521000
*           MGPVARPT(1)=ADDR(CCATYPEA(MEMBRTP));/* MEMBER TYPE       */ 01522000
         L     @05,@PC00007+4                                      0467 01523000
         SLR   @15,@15                                             0467 01524000
         IC    @15,MEMBRTP(,@05)                                   0467 01525000
         SLA   @15,3                                               0467 01526000
         L     @05,CCATPAD(,CCAPTR)                                0467 01527000
         AL    @05,@CF02127                                        0467 01528000
         LA    @05,CCATYPEA(@15,@05)                               0467 01529000
         ST    @05,MGPVARPT                                        0467 01530000
*           MGPVARPT(2)=ADDR(MEMBRNAM);/* MEMBER NAME                */ 01531000
         L     @05,@PC00007                                        0468 01532000
         ST    @05,MGPVARPT+4                                      0468 01533000
*           MGPVARPT(3)=ADDR(DDNAME);/* LIBRARY DDNAME               */ 01534000
         L     @05,@PC00007+8                                      0469 01535000
         ST    @05,MGPVARPT+8                                      0469 01536000
*           CALL HMASMMSG(HMASMMGP);/* ISSUE MESSAGE                 */ 01537000
*                                                                  0470 01538000
         L     @15,@CV01855                                        0470 01539000
         LA    @01,@AL00470                                        0470 01540000
         BALR  @14,@15                                             0470 01541000
*           /*********************************************************/ 01542000
*           /*                                                       */ 01543000
*           /* PUT MEMBER/DDNAME IN TST GTA FILE                     */ 01544000
*           /*                                                       */ 01545000
*           /*********************************************************/ 01546000
*                                                                  0471 01547000
*           GTPFUNCT(3)=GTPADD;     /* ADD MEMBER/DDNAME             */ 01548000
         MVI   GTPFUNCT+56,X'04'                                   0471 01549000
*           CALL HMASMGTA(HMASMGTP(3));/* ... TO TST GTA FILE        */ 01550000
         L     @15,@CV01853                                        0472 01551000
         LA    @01,@AL00472                                        0472 01552000
         BALR  @14,@15                                             0472 01553000
*           DELMEMRC=MAX(DELMEMRC,GTPRETRN(3));/* MAINTAIN RTN.CODE  */ 01554000
         L     @05,@PC00007+12                                     0473 01555000
         L     @15,DELMEMRC(,@05)                                  0473 01556000
         SLR   @14,@14                                             0473 01557000
         IC    @14,GTPRETRN+56                                     0473 01558000
         CR    @15,@14                                             0473 01559000
         BNL   *+6                                                      01560000
         LR    @15,@14                                             0473 01561000
         ST    @15,DELMEMRC(,@05)                                  0473 01562000
*         END;                                                     0474 01563000
*     END;                                                         0475 01564000
*   RETURN;                                                        0476 01565000
@EL00007 DS    0H                                                  0476 01566000
@EF00007 DS    0H                                                  0476 01567000
@ER00007 LM    @14,@12,@SA00007                                    0476 01568000
         BR    @14                                                 0476 01569000
*   END DELMEMBR;                                                  0477 01570000
         B     @EL00007                                            0477 01571000
*                                                                  0478 01572000
*/********************************************************************/ 01573000
*/*                                                                  */ 01574000
*/*  XRFSEL     - BUILD SELECT-LIST XREF GTA FILE FOR ALL LMODS      */ 01575000
*/*               IN THE CDS ++MOD ENTRY IOP POINTED TO BY IOPPTR    */ 01576000
*/*                                                                  */ 01577000
*/*               NOTE - THE IOP POINTED TO BY IOPPTR IS EXPECTED    */ 01578000
*/*               TO BE INITIALIZED WITH THE CDS MOD ENTRY FOR THE   */ 01579000
*/*               MOD BEING DELETED (FROM THIS ENTRY, LMODS ARE      */ 01580000
*/*               FOUND).                                            */ 01581000
*/*                                                                  */ 01582000
*/********************************************************************/ 01583000
*                                                                  0478 01584000
*XRFSEL:                                                           0478 01585000
*   PROC(LMXRFRC);                                                 0478 01586000
XRFSEL   STM   @14,@12,@SA00008                                    0478 01587000
         MVC   @PC00008(4),0(@01)                                  0478 01588000
*   DCL                                                            0479 01589000
*     LMXRFRC FIXED(31);            /* RETURN CODE PARAMETER         */ 01590000
*   DCL                                                            0480 01591000
*     LL FIXED(31);                 /* INDEX - IOP SUB-ENTRY         */ 01592000
*                                                                  0481 01593000
*   /*****************************************************************/ 01594000
*   /*                                                               */ 01595000
*   /* GO THRU LMODS IN THE CDS MOD ENTRY IOP AND BUILD SELECT LIST  */ 01596000
*   /*                                                               */ 01597000
*   /*****************************************************************/ 01598000
*                                                                  0481 01599000
*   DO LL=1 BY 1 WHILE IOPRETRN=IOPGOOD/* VALID MOD IOP PASSED       */ 01600000
*         &IOPMODND(LL)^=IOPEOLST   /* NOT END OF SUBENTRIES         */ 01601000
*         &LMXRFRC<STOPPTF;         /* NO TERMINATING ERRORS         */ 01602000
         LA    LL,1                                                0481 01603000
         B     @DE00481                                            0481 01604000
@DL00481 DS    0H                                                  0482 01605000
*     IF IOPMDIND(LL)=IOPMDLMD      /* LMOD SUB-ENTRY                */ 01606000
*       THEN                                                       0482 01607000
         L     @03,IOPPTR                                          0482 01608000
         LR    @15,LL                                              0482 01609000
         MH    @15,@CH00432                                        0482 01610000
         SLR   @14,@14                                             0482 01611000
         IC    @14,IOPMDIND-9(@15,@03)                             0482 01612000
         CH    @14,@CH00085                                        0482 01613000
         BNE   @RF00482                                            0482 01614000
*       DO;                                                        0483 01615000
*                                                                  0483 01616000
*         /***********************************************************/ 01617000
*         /*                                                         */ 01618000
*         /* INITIALIZE SET RECORD FOR LMOD AND PUT TO GTA FILE      */ 01619000
*         /*                                                         */ 01620000
*         /***********************************************************/ 01621000
*                                                                  0484 01622000
*         SELSTFLG=''B;             /* CLEAR TYPE FLAGS IN SET       */ 01623000
         XC    SELSTFLG(2),SELSTFLG                                0484 01624000
*         SEFLAGS=''B;              /* CLEAR SELECT/EXCLUDE FLAGS    */ 01625000
         MVI   SEFLAGS,X'00'                                       0485 01626000
*         SESELECT=ON;              /* SET SELECT FLAG               */ 01627000
         OI    SESELECT,B'01000000'                                0486 01628000
*         SELMD=ON;                 /* SET LMOD TYPE                 */ 01629000
         OI    SELMD,B'00001000'                                   0487 01630000
*         SENAME=IOPLMODS(LL);      /* PUT LMOD NAME INTO RECORD     */ 01631000
         ALR   @03,@15                                             0488 01632000
         MVC   SENAME(8),IOPLMODS-9(@03)                           0488 01633000
*         GTPFUNCT(1)=GTPADD;       /* PUT SET RECORD TO GTA FILE    */ 01634000
         MVI   GTPFUNCT,X'04'                                      0489 01635000
*         GTPRCDLN(1)=LENGTH(HMASMSET);/* SET RECORD LENGTH          */ 01636000
         MVC   GTPRCDLN(2),@CH00032                                0490 01637000
*         GTPKEYLN(1)=LENGTH(SELSTENT);/* SET KEY LENGTH             */ 01638000
         MVC   GTPKEYLN(2),@CH00033                                0491 01639000
*         GTPBUFAD(1)=ADDR(HMASMSET);/* POINT TO SET RECORD          */ 01640000
         LA    @03,HMASMSET                                        0492 01641000
         ST    @03,GTPBUFAD                                        0492 01642000
*         CALL HMASMGTA(HMASMGTP(1));/* PUT SET RECORD TO GTA FILE   */ 01643000
         L     @15,@CV01853                                        0493 01644000
         LA    @01,@AL00493                                        0493 01645000
         BALR  @14,@15                                             0493 01646000
*         LMXRFRC=MAX(LMXRFRC,GTPRETRN(1));/* MAINTAIN RETURN CODE   */ 01647000
         L     @03,@PC00008                                        0494 01648000
         L     @15,LMXRFRC(,@03)                                   0494 01649000
         SLR   @14,@14                                             0494 01650000
         IC    @14,GTPRETRN                                        0494 01651000
         CR    @15,@14                                             0494 01652000
         BNL   *+6                                                      01653000
         LR    @15,@14                                             0494 01654000
         ST    @15,LMXRFRC(,@03)                                   0494 01655000
*       END;                                                       0495 01656000
*   END;                                                           0496 01657000
@RF00482 AH    LL,@CH00085                                         0496 01658000
@DE00481 L     @03,IOPPTR                                          0496 01659000
         CLI   IOPRETRN(@03),0                                     0496 01660000
         BNE   @DC00481                                            0496 01661000
         LR    @15,LL                                              0496 01662000
         MH    @15,@CH00432                                        0496 01663000
         SLR   @14,@14                                             0496 01664000
         IC    @14,IOPMODND-9(@15,@03)                             0496 01665000
         CH    @14,@CH00621                                        0496 01666000
         BE    @DC00481                                            0496 01667000
         L     @03,@PC00008                                        0496 01668000
         L     @03,LMXRFRC(,@03)                                   0496 01669000
         CH    @03,@CH00110                                        0496 01670000
         BL    @DL00481                                            0496 01671000
@DC00481 DS    0H                                                  0497 01672000
*   RETURN;                                                        0497 01673000
@EL00008 DS    0H                                                  0497 01674000
@EF00008 DS    0H                                                  0497 01675000
@ER00008 LM    @14,@12,@SA00008                                    0497 01676000
         BR    @14                                                 0497 01677000
*   END XRFSEL;                                                    0498 01678000
*                                                                  0499 01679000
*/********************************************************************/ 01680000
*/*                                                                  */ 01681000
*/* LMODDEL  - DELETE LOAD MODULE FROM THE TARGET SYSTEM LIBRARIES.  */ 01682000
*/*                                                                  */ 01683000
*/*          - DELETE THE LMOD ENTRY FROM THE CDS IF ALL MODS ARE    */ 01684000
*/*            BEING DELETED.                                        */ 01685000
*/*                                                                  */ 01686000
*/*          * CONDITIONS ON ENTRY:                                  */ 01687000
*/*                                                                  */ 01688000
*/*            - CURNTLMD - NAME OF LMOD TO BE DELETED               */ 01689000
*/*                                                                  */ 01690000
*/*            - DLLMFLGS:                                           */ 01691000
*/*                                                                  */ 01692000
*/*               LMBKUP   - '1'  LMOD ENTRY SHOULD BE BACKED UP.    */ 01693000
*/*                          '0'  LMOD ENTRY BACKUP NOT REQUIRED.    */ 01694000
*/*               ALLMODS  - '1'  ALL MODS (FOR LMOD) FOUND IN ICT   */ 01695000
*/*                               (CONDITION FOR CALLING THIS PROC). */ 01696000
*/*               ALLIDEL  - '1'  ALL MODS FOUND AND BEING DELETED.  */ 01697000
*/*                          '0'  ALL MODS FOUND BUT SOME ARE NOT    */ 01698000
*/*                               BEING DELETED.                     */ 01699000
*/*                                                                  */ 01700000
*/********************************************************************/ 01701000
*                                                                  0499 01702000
*LMODDEL:                                                          0499 01703000
*   PROC(LMDDRC);                                                  0499 01704000
LMODDEL  STM   @14,@12,@SA00009                                    0499 01705000
         MVC   @PC00009(4),0(@01)                                  0499 01706000
*   DCL                                                            0500 01707000
*     LMDDRC FIXED(31);             /* RETURN CODE                   */ 01708000
*   DCL                                                            0501 01709000
*     LM FIXED(15);                 /* INDEX - LMOD SECT ENTRIES     */ 01710000
*   DCL                                                            0502 01711000
*     LMSYSLIB CHAR(8);             /* LOAD MODULE''S SYSLIB DDNAME  */ 01712000
*                                                                  0503 01713000
*   /*****************************************************************/ 01714000
*   /*                                                               */ 01715000
*   /* ACCESS LMOD ON CDS TO FIND TARGET SYSTEM LIBRARIES            */ 01716000
*   /*                                                               */ 01717000
*   /*****************************************************************/ 01718000
*                                                                  0503 01719000
*   LMDENTRY=OFF;                   /* ASSUME LMOD ENTRY NOT FOUND   */ 01720000
         NI    LMDENTRY,B'11011111'                                0503 01721000
*   IOPNAME=CURNTLMD;               /* LOAD MODULE NAME              */ 01722000
         L     @05,IOPPTR                                          0504 01723000
         MVC   IOPNAME(8,@05),CURNTLMD                             0504 01724000
*   IOPDSID=IOPCDS;                 /* SMPCDS DATASET                */ 01725000
         MVI   IOPDSID(@05),X'02'                                  0505 01726000
*   IOPFUNCT=IOPLOC;                /* GET ENTIRE ENTRY              */ 01727000
         MVI   IOPFUNCT(@05),X'03'                                 0506 01728000
*   IOPTYPE=IOPLMD;                 /* LMOD TYPE ENTRY               */ 01729000
         MVI   IOPTYPE(@05),X'02'                                  0507 01730000
*   CALL HMASMIO(HMASMIOP);                                        0508 01731000
         ST    @05,@AL00001                                        0508 01732000
         L     @15,@CV01854                                        0508 01733000
         LA    @01,@AL00001                                        0508 01734000
         BALR  @14,@15                                             0508 01735000
*   IF IOPRETRN>IOPNOTFD            /* TERMINATING ERROR             */ 01736000
*     THEN                                                         0509 01737000
         L     @05,IOPPTR                                          0509 01738000
         CLI   IOPRETRN(@05),4                                     0509 01739000
         BNH   @RF00509                                            0509 01740000
*     LMDDRC=MAX(LMDDRC,IOPRETRN);  /* MAINTAIN RETURN CODE          */ 01741000
         L     @15,@PC00009                                        0510 01742000
         L     @14,LMDDRC(,@15)                                    0510 01743000
         SLR   @09,@09                                             0510 01744000
         IC    @09,IOPRETRN(,@05)                                  0510 01745000
         CR    @14,@09                                             0510 01746000
         BNL   *+6                                                      01747000
         LR    @14,@09                                             0510 01748000
         ST    @14,LMDDRC(,@15)                                    0510 01749000
*   ELSE                                                           0511 01750000
*     IF IOPRETRN=IOPGOOD           /* LMOD ENTRY FOUND              */ 01751000
*       THEN                                                       0511 01752000
*                                                                  0511 01753000
         B     @RC00509                                            0511 01754000
@RF00509 L     @05,IOPPTR                                          0511 01755000
         CLI   IOPRETRN(@05),0                                     0511 01756000
         BNE   @RF00511                                            0511 01757000
*       /*************************************************************/ 01758000
*       /*                                                           */ 01759000
*       /* CDS LMOD ENTRY FOUND                                      */ 01760000
*       /*                                                           */ 01761000
*       /*************************************************************/ 01762000
*                                                                  0512 01763000
*       DO;                                                        0512 01764000
*         LMDENTRY=ON;              /* INDICATE LMOD ENTRY FOUND     */ 01765000
         OI    LMDENTRY,B'00100000'                                0513 01766000
*         IF CCARES=ON              /* RESTORE PROCESSING            */ 01767000
*           THEN                                                   0514 01768000
         TM    CCARES(CCAPTR),B'00001000'                          0514 01769000
         BNO   @RF00514                                            0514 01770000
*           DO;                                                    0515 01771000
*                                                                  0515 01772000
*             /*******************************************************/ 01773000
*             /*                                                     */ 01774000
*             /* FOR RESTORE PROCESSING SEE IF SYSMOD CAUSING "ADD"  */ 01775000
*             /* OF CDS LMOD ENTRY IS BEING RESTORED                 */ 01776000
*             /*                                                     */ 01777000
*             /*******************************************************/ 01778000
*                                                                  0516 01779000
*             IF IOPBUTYP=IOPBUADD  /* LMOD ENTRY "ADDED"            */ 01780000
*               THEN                                               0516 01781000
         CLI   IOPBUTYP(@05),1                                     0516 01782000
         BNE   @RF00516                                            0516 01783000
*               CALL SRCHPTF(IOPBUSMD,/* SYSMOD WHICH ADDED LMOD     */ 01784000
*                   PPARM);         /* PTR TO PTF ENTRY IN ICT       */ 01785000
         LA    @05,IOPBUSMD(,@05)                                  0517 01786000
         ST    @05,@AL00001                                        0517 01787000
         LA    @05,PPARM                                           0517 01788000
         ST    @05,@AL00001+4                                      0517 01789000
         LA    @01,@AL00001                                        0517 01790000
         BAL   @14,SRCHPTF                                         0517 01791000
*             ELSE                                                 0518 01792000
*               PPARM=0;            /* CLEAR PTR TO PTF ENTRY IN ICT */ 01793000
         B     @RC00516                                            0518 01794000
@RF00516 SLR   @05,@05                                             0518 01795000
         ST    @05,PPARM                                           0518 01796000
*           END;                                                   0519 01797000
@RC00516 DS    0H                                                  0520 01798000
*       END;                                                       0520 01799000
@RF00514 DS    0H                                                  0521 01800000
*   IF LMDDRC<STOPPTF               /* NOT TERMINATING               */ 01801000
*       &LMDENTRY=ON                /* LMOD ENTRY FOUND              */ 01802000
*       &ALLIDEL=ON                 /* NO SELECTED MODS FOR LMOD ...    01803000
*                                      (I.E., LMOD WILL BE DELETED)  */ 01804000
*       &LMBKUP=ON                  /* LMOD BACKUP REQUIRED ........    01805000
*                                      (I.E., SOME DELETED MODS WERE    01806000
*                                      FROM NON-DELETED SYSMODS)     */ 01807000
*       &CCARES=OFF                 /* NOT RESTORE PROCESSING        */ 01808000
*       &CPTF->ICTPDEXP(1)=OFF      /* SYSMOD NOT BEING DELETED      */ 01809000
*       &CPTF->ICTPDIMP(1)=OFF      /* SYSMOD NOT BEING DELETED      */ 01810000
*     THEN                                                         0521 01811000
*                                                                  0521 01812000
@RF00511 DS    0H                                                  0521 01813000
@RC00509 L     @05,@PC00009                                        0521 01814000
         L     @15,LMDDRC(,@05)                                    0521 01815000
         CH    @15,@CH00110                                        0521 01816000
         BNL   @RF00521                                            0521 01817000
         TM    LMDENTRY,B'01110000'                                0521 01818000
         BNO   @RF00521                                            0521 01819000
         TM    CCARES(CCAPTR),B'00001000'                          0521 01820000
         BNZ   @RF00521                                            0521 01821000
         L     @01,CPTF                                            0521 01822000
         TM    ICTPDEXP(@01),B'00110000'                           0521 01823000
         BNZ   @RF00521                                            0521 01824000
*     /***************************************************************/ 01825000
*     /*                                                             */ 01826000
*     /* BACKUP CDS LMOD ENTRY ON SCDS (APPLY)                       */ 01827000
*     /*                                                             */ 01828000
*     /***************************************************************/ 01829000
*                                                                  0522 01830000
*     CALL BACKUP(LMDDRC);          /* CREATE BACKUP LMOD ENTRY    0522 01831000
*                                      ASSOCIATED WITH CURRENT SYSMOD*/ 01832000
*                                                                  0522 01833000
         ST    @05,@AL00001                                        0522 01834000
         LA    @01,@AL00001                                        0522 01835000
         BAL   @14,BACKUP                                          0522 01836000
*   /*****************************************************************/ 01837000
*   /*                                                               */ 01838000
*   /* DELETE LOAD MODULE FROM ALL TARGET LIBS SPECIFIED IN ENTRY    */ 01839000
*   /*                                                               */ 01840000
*   /*****************************************************************/ 01841000
*                                                                  0523 01842000
*   IF LMDDRC<STOPPTF               /* NOT TERMINATING               */ 01843000
*       &LMDENTRY=ON                /* LMOD ENTRY FOUND ON (A)CDS    */ 01844000
*     THEN                                                         0523 01845000
@RF00521 L     @05,@PC00009                                        0523 01846000
         L     @05,LMDDRC(,@05)                                    0523 01847000
         CH    @05,@CH00110                                        0523 01848000
         BNL   @RF00523                                            0523 01849000
         TM    LMDENTRY,B'00100000'                                0523 01850000
         BNO   @RF00523                                            0523 01851000
*     DO;                                                          0524 01852000
*                                                                  0524 01853000
*       /*************************************************************/ 01854000
*       /*                                                           */ 01855000
*       /* GO THRU ALL TARGET LIBS FOUND IN (A)CDS LMOD ENTRY        */ 01856000
*       /*                                                           */ 01857000
*       /*************************************************************/ 01858000
*                                                                  0525 01859000
*       DO LM=1 BY 1 WHILE IOPLMDND(LM)^=IOPEOLST;                 0525 01860000
         LA    LM,1                                                0525 01861000
         B     @DE00525                                            0525 01862000
@DL00525 DS    0H                                                  0526 01863000
*         IF IOPLMIND(LM)=IOPLMSYS  /* SYSLIB SUB-ENTRY FOUND        */ 01864000
*           THEN                                                   0526 01865000
         L     @05,IOPPTR                                          0526 01866000
         LR    @03,LM                                              0526 01867000
         MH    @03,@CH00432                                        0526 01868000
         SLR   @15,@15                                             0526 01869000
         IC    @15,IOPLMIND-9(@03,@05)                             0526 01870000
         CH    @15,@CH00085                                        0526 01871000
         BNE   @RF00526                                            0526 01872000
*           DO;                                                    0527 01873000
*             LMSYSLIB=IOPSYSLB(LM);/* SAVE SYSLIB/DDNAME            */ 01874000
         ALR   @05,@03                                             0528 01875000
         MVC   LMSYSLIB(8),IOPSYSLB-9(@05)                         0528 01876000
*             CALL DELMEMBR(CURNTLMD,/* LOAD MODULE TO BE DELETED    */ 01877000
*                 IOPLMD,           /* ELEMENT TYPE - LOAD MODULE    */ 01878000
*                 LMSYSLIB,         /* SYSLIB/DDNAME                 */ 01879000
*                 LMDDRC);          /* RETURN CODE PARAMETER         */ 01880000
         MVC   @AL00001(12),@AL00529                               0529 01881000
         L     @05,@PC00009                                        0529 01882000
         ST    @05,@AL00001+12                                     0529 01883000
         LA    @01,@AL00001                                        0529 01884000
         BAL   @14,DELMEMBR                                        0529 01885000
*             IF LMDDRC<STOPPTF     /* NOT TERMINATING               */ 01886000
*               THEN                                               0530 01887000
         L     @05,@PC00009                                        0530 01888000
         L     @05,LMDDRC(,@05)                                    0530 01889000
         CH    @05,@CH00110                                        0530 01890000
         BNL   @RF00530                                            0530 01891000
*               CALL LMALIAS(LMSYSLIB);/* DELETE LOAD MODULE''S    0531 01892000
*                                      ALIASES FROM SYSLIB           */ 01893000
         LA    @01,@AL00531                                        0531 01894000
         BAL   @14,LMALIAS                                         0531 01895000
*           END;                                                   0532 01896000
@RF00530 DS    0H                                                  0533 01897000
*       END;                                                       0533 01898000
@RF00526 AH    LM,@CH00085                                         0533 01899000
@DE00525 LR    @05,LM                                              0533 01900000
         MH    @05,@CH00432                                        0533 01901000
         L     @03,IOPPTR                                          0533 01902000
         SLR   @15,@15                                             0533 01903000
         IC    @15,IOPLMDND-9(@05,@03)                             0533 01904000
         CH    @15,@CH00621                                        0533 01905000
         BNE   @DL00525                                            0533 01906000
*     END;                                                         0534 01907000
*                                                                  0535 01908000
*   /*****************************************************************/ 01909000
*   /*                                                               */ 01910000
*   /* DELETE LMOD ENTRY FROM CDS                                    */ 01911000
*   /*                                                               */ 01912000
*   /*****************************************************************/ 01913000
*                                                                  0535 01914000
*   IF LMDDRC<STOPPTF               /* NOT TERMINATING               */ 01915000
*       &ALLIDEL=ON                 /* NO SELECTED MODS FOR LMOD     */ 01916000
*       &LMDENTRY=ON                /* CDS LMOD ENTRY FOUND          */ 01917000
*       &(CCARES=OFF                /* NOT RESTORE                   */ 01918000
*       |(CCARES=ON                 /* RESTORE ...                   */ 01919000
*       &PPARM^=0))                 /* SYSMOD ADDING LMOD BEING REST */ 01920000
*     THEN                                                         0535 01921000
@RF00523 L     @15,@PC00009                                        0535 01922000
         L     @15,LMDDRC(,@15)                                    0535 01923000
         CH    @15,@CH00110                                        0535 01924000
         BNL   @RF00535                                            0535 01925000
         TM    ALLIDEL,B'01100000'                                 0535 01926000
         BNO   @RF00535                                            0535 01927000
         TM    CCARES(CCAPTR),B'00001000'                          0535 01928000
         BZ    @RT00535                                            0535 01929000
         TM    CCARES(CCAPTR),B'00001000'                          0535 01930000
         BNO   @RF00535                                            0535 01931000
         ICM   @15,15,PPARM                                        0535 01932000
         BZ    @RF00535                                            0535 01933000
@RT00535 DS    0H                                                  0536 01934000
*     DO;                                                          0536 01935000
*       IOPNAME=CURNTLMD;           /* LOAD MODULE NAME              */ 01936000
         L     @15,IOPPTR                                          0537 01937000
         MVC   IOPNAME(8,@15),CURNTLMD                             0537 01938000
*       IOPDSID=IOPCDS;             /* CDS DATASET                   */ 01939000
         MVI   IOPDSID(@15),X'02'                                  0538 01940000
*       IOPTYPE=IOPLMD;             /* ENTRY TYPE - LMOD             */ 01941000
         MVI   IOPTYPE(@15),X'02'                                  0539 01942000
*       IOPFUNCT=IOPSTOWD;          /* SET STOW DELETE IN IOP        */ 01943000
         MVI   IOPFUNCT(@15),X'53'                                 0540 01944000
*       CALL HMASMIO(HMASMIOP);     /* DELETE LMOD ENTRY             */ 01945000
         ST    @15,@AL00001                                        0541 01946000
         L     @15,@CV01854                                        0541 01947000
         LA    @01,@AL00001                                        0541 01948000
         BALR  @14,@15                                             0541 01949000
*       LMDDRC=MAX(LMDDRC,IOPRETRN);/* MAINTAIN RETURN CODE          */ 01950000
         L     @15,@PC00009                                        0542 01951000
         L     @14,LMDDRC(,@15)                                    0542 01952000
         L     @01,IOPPTR                                          0542 01953000
         SLR   @00,@00                                             0542 01954000
         IC    @00,IOPRETRN(,@01)                                  0542 01955000
         CR    @14,@00                                             0542 01956000
         BNL   *+6                                                      01957000
         LR    @14,@00                                             0542 01958000
         ST    @14,LMDDRC(,@15)                                    0542 01959000
*       CALL LMPRCICT(CURNTLMD);    /* MARK ANY ICT LMOD ENTRIES AS     01960000
*                                      "IN-PROCESS"                  */ 01961000
         LA    @01,@AL00543                                        0543 01962000
         BAL   @14,LMPRCICT                                        0543 01963000
*     END;                                                         0544 01964000
*   RETURN;                                                        0545 01965000
@EL00009 DS    0H                                                  0545 01966000
@EF00009 DS    0H                                                  0545 01967000
@ER00009 LM    @14,@12,@SA00009                                    0545 01968000
         BR    @14                                                 0545 01969000
*   END LMODDEL;                                                   0546 01970000
         B     @EL00009                                            0546 01971000
*                                                                  0547 01972000
*/********************************************************************/ 01973000
*/*                                                                  */ 01974000
*/* SRCHPTF - SERACH ICT PTF SECTION FOR A NON-NOGO SYSMOD ENTRY     */ 01975000
*/*            REPRESENTING THE SYSMOD-ID PASSED.                    */ 01976000
*/*                                                                  */ 01977000
*/*          - THE CALLER''S RETURN PARAMETER IS SET TO POINT TO     */ 01978000
*/*            THE PTF SECTION ENTRY (IF FOUND).                     */ 01979000
*/*                                                                  */ 01980000
*/*                                                                  */ 01981000
*/********************************************************************/ 01982000
*                                                                  0547 01983000
*SRCHPTF:                                                          0547 01984000
*   PROC(SMDNAME,SMDPTR);                                          0547 01985000
SRCHPTF  STM   @14,@12,12(@13)                                     0547 01986000
         MVC   @PC00010(8),0(@01)                                  0547 01987000
*   DCL                                                            0548 01988000
*     SMDNAME CHAR(7);              /* SYSMOD ID                     */ 01989000
*   DCL                                                            0549 01990000
*     SMDPTR PTR(31);               /* POINTER RETURNED TO THE CALLER   01991000
*                                      POINTING TO THE PTF SECTION 0549 01992000
*                                      ENTRY FOUND ... SET TO ZERO IF   01993000
*                                      NO PTF SECTION ENTRY FOUND    */ 01994000
*   DCL                                                            0550 01995000
*     NN FIXED(15);                 /* INDEX - ICT PTF SECT ENTRIES  */ 01996000
*   RESPECIFY                                                      0551 01997000
*     ICTPTF BASED(CCAICPTF);       /* ADDRESS ENTIRE ICT PTF SECT   */ 01998000
*   SMDPTR=0;                       /* CLEAR PTR RETURNED            */ 01999000
*                                                                  0552 02000000
         L     @15,@PC00010+4                                      0552 02001000
         SLR   @14,@14                                             0552 02002000
         ST    @14,SMDPTR(,@15)                                    0552 02003000
*   /*****************************************************************/ 02004000
*   /*                                                               */ 02005000
*   /* GO THRU ICT MOD SECTION                                       */ 02006000
*   /*                                                               */ 02007000
*   /*****************************************************************/ 02008000
*                                                                  0553 02009000
*   DO NN=1 BY 1 WHILE ICTPEND(NN)^=ICTENDNT/* NOT AT END OF ICT     */ 02010000
*         &SMDPTR=0;                /* ENTRY NOT FOUND               */ 02011000
         LA    NN,1                                                0553 02012000
         B     @DE00553                                            0553 02013000
@DL00553 DS    0H                                                  0554 02014000
*     IF ICTPTFS(NN)=SMDNAME        /* SYSMOD ENTRY FOUND            */ 02015000
*         &ICTPNOGO(NN)=OFF         /* ... NOT NOGO                  */ 02016000
*       THEN                                                       0554 02017000
         LR    @03,NN                                              0554 02018000
         MH    @03,@CH02104                                        0554 02019000
         L     @15,CCAICPTF(,CCAPTR)                               0554 02020000
         L     @14,@PC00010                                        0554 02021000
         ST    @03,@TF00001                                        0554 02022000
         ALR   @03,@15                                             0554 02023000
         AL    @03,@CF02120                                        0554 02024000
         CLC   ICTPTFS(7,@03),SMDNAME(@14)                         0554 02025000
         BNE   @RF00554                                            0554 02026000
         LR    @03,@15                                             0554 02027000
         AL    @03,@TF00001                                        0554 02028000
         AL    @03,@CF02118                                        0554 02029000
         TM    ICTPNOGO-8(@03),B'01000000'                         0554 02030000
         BNZ   @RF00554                                            0554 02031000
*       SMDPTR=ADDR(ICTPTF(NN));    /* SET PTR RETURNED TO CALLER    */ 02032000
         L     @03,@PC00010+4                                      0555 02033000
         L     @14,@TF00001                                        0555 02034000
         AL    @15,@CF02120                                        0555 02035000
         LA    @15,ICTPTF(@14,@15)                                 0555 02036000
         ST    @15,SMDPTR(,@03)                                    0555 02037000
*   END;                                                           0556 02038000
@RF00554 AH    NN,@CH00085                                         0556 02039000
@DE00553 LR    @03,NN                                              0556 02040000
         MH    @03,@CH02104                                        0556 02041000
         L     @01,CCAICPTF(,CCAPTR)                               0556 02042000
         AL    @01,@CF02120                                        0556 02043000
         L     @03,ICTPEND(@03,@01)                                0556 02044000
         CL    @03,ICTENDNT                                        0556 02045000
         BE    @DC00553                                            0556 02046000
         L     @03,@PC00010+4                                      0556 02047000
         ICM   @15,15,SMDPTR(@03)                                  0556 02048000
         BZ    @DL00553                                            0556 02049000
@DC00553 DS    0H                                                  0557 02050000
*   END SRCHPTF;                                                   0557 02051000
@EL00010 DS    0H                                                  0557 02052000
@EF00010 DS    0H                                                  0557 02053000
@ER00010 LM    @14,@12,12(@13)                                     0557 02054000
         BR    @14                                                 0557 02055000
*                                                                  0558 02056000
*/********************************************************************/ 02057000
*/*                                                                  */ 02058000
*/* SRCHMOD - SERACH ICT MOD SECTION FOR A SELECTED MOD-TYPE ENTRY   */ 02059000
*/*            MATCHING THE ELEMENT PASSED.                          */ 02060000
*/*                                                                  */ 02061000
*/*            THE ICT IS SERACHED FOR A ++MOD-TYPE MOD SECTION      */ 02062000
*/*            ENTRY.                                                */ 02063000
*/*                                                                  */ 02064000
*/*          - THE CALLER''S RETURN PARAMETER IS SET TO POINT TO     */ 02065000
*/*            THE MOD SECTION ENTRY (IF FOUND).                     */ 02066000
*/*                                                                  */ 02067000
*/*                                                                  */ 02068000
*/********************************************************************/ 02069000
*                                                                  0558 02070000
*SRCHMOD:                                                          0558 02071000
*   PROC(SMODNAME,SMODPTR);                                        0558 02072000
SRCHMOD  STM   @14,@12,12(@13)                                     0558 02073000
         MVC   @PC00011(8),0(@01)                                  0558 02074000
*   DCL                                                            0559 02075000
*     SMODNAME CHAR(8);             /* ++MOD ELEMENT NAME            */ 02076000
*   DCL                                                            0560 02077000
*     SMODPTR PTR(31);              /* POINTER RETURNED TO THE CALLER   02078000
*                                      POINTING TO THE MOD SECTION 0560 02079000
*                                      ENTRY FOUND ... SET TO ZERO IF   02080000
*                                      NO MOD SECTION ENTRY FOUND    */ 02081000
*   DCL                                                            0561 02082000
*     JJ FIXED(15);                 /* INDEX - ICT MOD SECT ENTRIES  */ 02083000
*   RESPECIFY                                                      0562 02084000
*     ICTMOD BASED(CCAICMOD);       /* ADDRESS ENTIRE ICT MOD SECT   */ 02085000
*   SMODPTR=0;                      /* CLEAR PTR RETURNED            */ 02086000
*                                                                  0563 02087000
         L     @15,@PC00011+4                                      0563 02088000
         SLR   @14,@14                                             0563 02089000
         ST    @14,SMODPTR(,@15)                                   0563 02090000
*   /*****************************************************************/ 02091000
*   /*                                                               */ 02092000
*   /* GO THRU ICT MOD SECTION                                       */ 02093000
*   /*                                                               */ 02094000
*   /*****************************************************************/ 02095000
*                                                                  0564 02096000
*   DO JJ=1 BY 1 WHILE ICTMEND(JJ)^=ICTENDNT/* NOT AT END OF ICT     */ 02097000
*         &SMODPTR=0;               /* ENTRY NOT FOUND               */ 02098000
         LA    JJ,1                                                0564 02099000
         B     @DE00564                                            0564 02100000
@DL00564 DS    0H                                                  0565 02101000
*     IF ICTMNAME(JJ)=SMODNAME      /* ELEMENT NAMES MATCH           */ 02102000
*         &ICTMMOD(JJ)=ON           /* ++MOD-TYPE ENTRY              */ 02103000
*         &ICTMISEL(JJ)=ON          /* ELEMENT IS SELECTED           */ 02104000
*         &ICTMSELM(JJ)=OFF         /* ELEMENT IS NOT ELMINIATED     */ 02105000
*         &ICTPPTR(JJ)->ICTPNOGO(1)=OFF/* SYSMOD IS NOT NOGO         */ 02106000
*       THEN                                                       0565 02107000
         LR    @03,JJ                                              0565 02108000
         MH    @03,@CH02105                                        0565 02109000
         L     @15,CCAICMOD(,CCAPTR)                               0565 02110000
         L     @14,@PC00011                                        0565 02111000
         ST    @03,@TF00001                                        0565 02112000
         ALR   @03,@15                                             0565 02113000
         AL    @03,@CF02134                                        0565 02114000
         CLC   ICTMNAME(8,@03),SMODNAME(@14)                       0565 02115000
         BNE   @RF00565                                            0565 02116000
         LR    @03,@15                                             0565 02117000
         AL    @03,@TF00001                                        0565 02118000
         AL    @03,@CF02135                                        0565 02119000
         TM    ICTMMOD-9(@03),B'10000000'                          0565 02120000
         BNO   @RF00565                                            0565 02121000
         LR    @03,@15                                             0565 02122000
         AL    @03,@TF00001                                        0565 02123000
         AL    @03,@CF02136                                        0565 02124000
         TM    ICTMISEL-11(@03),B'10000000'                        0565 02125000
         BNO   @RF00565                                            0565 02126000
         TM    ICTMSELM-11(@03),B'00100000'                        0565 02127000
         BNZ   @RF00565                                            0565 02128000
         L     @03,@TF00001                                        0565 02129000
         AL    @03,@CF02137                                        0565 02130000
         L     @03,ICTPPTR-96(@03,@15)                             0565 02131000
         TM    ICTPNOGO(@03),B'01000000'                           0565 02132000
         BNZ   @RF00565                                            0565 02133000
*       SMODPTR=ADDR(ICTMOD(JJ));   /* SET PTR RETURNED TO CALLER    */ 02134000
         L     @03,@PC00011+4                                      0566 02135000
         L     @14,@TF00001                                        0566 02136000
         AL    @15,@CF02134                                        0566 02137000
         LA    @15,ICTMOD(@14,@15)                                 0566 02138000
         ST    @15,SMODPTR(,@03)                                   0566 02139000
*   END;                                                           0567 02140000
@RF00565 AH    JJ,@CH00085                                         0567 02141000
@DE00564 LR    @03,JJ                                              0567 02142000
         MH    @03,@CH02105                                        0567 02143000
         L     @01,CCAICMOD(,CCAPTR)                               0567 02144000
         AL    @01,@CF02134                                        0567 02145000
         L     @03,ICTMEND(@03,@01)                                0567 02146000
         CL    @03,ICTENDNT                                        0567 02147000
         BE    @DC00564                                            0567 02148000
         L     @03,@PC00011+4                                      0567 02149000
         ICM   @15,15,SMODPTR(@03)                                 0567 02150000
         BZ    @DL00564                                            0567 02151000
@DC00564 DS    0H                                                  0568 02152000
*   END SRCHMOD;                                                   0568 02153000
@EL00011 DS    0H                                                  0568 02154000
@EF00011 DS    0H                                                  0568 02155000
@ER00011 LM    @14,@12,12(@13)                                     0568 02156000
         BR    @14                                                 0568 02157000
*                                                                  0569 02158000
*/********************************************************************/ 02159000
*/*                                                                  */ 02160000
*/* CDSELEM  - ACCESS CDS ENTRY FOR SPECIFIED ELEMENT                */ 02161000
*/*                                                                  */ 02162000
*/*          - USES IOP POINTED TO BY IOPPTR ... RESUTLING           */ 02163000
*/*            I/O RETURN CODE AND MOD DATA CAN BE FOUND THERE       */ 02164000
*/*                                                                  */ 02165000
*/********************************************************************/ 02166000
*                                                                  0569 02167000
*CDSELEM:                                                          0569 02168000
*   PROC(CDSMICTE,CDSELRC);                                        0569 02169000
CDSELEM  STM   @14,@12,@SA00012                                    0569 02170000
         MVC   @PC00012(8),0(@01)                                  0569 02171000
*   DCL                                                            0570 02172000
*     CDSMICTE CHAR(*);             /* ICT MOD SECTION ENTRY         */ 02173000
*   DCL                                                            0571 02174000
*     CDSELRC FIXED(31);            /* RETURN CODE PARAMETER         */ 02175000
*   RESPECIFY                                                      0572 02176000
*     ICTMOD BASED(ADDR(CDSMICTE)); /* ADDRESS ICT ENTRY             */ 02177000
*                                                                  0572 02178000
*   /*****************************************************************/ 02179000
*   /*                                                               */ 02180000
*   /* INITIALIZE IOP FOR LOCATE OF CDS MOD ENTRY                    */ 02181000
*   /*                                                               */ 02182000
*   /*****************************************************************/ 02183000
*                                                                  0573 02184000
*   IOPDSID=IOPCDS;                 /* ACCESS CDS                    */ 02185000
         L     @15,IOPPTR                                          0573 02186000
         MVI   IOPDSID(@15),X'02'                                  0573 02187000
*   IOPFUNCT=IOPLOC;                /* GET ENTIRE ENTRY (LOCATE)     */ 02188000
         MVI   IOPFUNCT(@15),X'03'                                 0574 02189000
*   IOPNAME=ICTMNAME(1);            /* ENTRY NAME                    */ 02190000
         L     @14,@PC00012                                        0575 02191000
         MVC   IOPNAME(8,@15),ICTMNAME(@14)                        0575 02192000
*   IOPRETRN=IOPGOOD;               /* CLEAR IOP RETURN CODE FIELD   */ 02193000
         MVI   IOPRETRN(@15),X'00'                                 0576 02194000
*   IF ICTMMOD(1)=ON                /* ICT MOD ENTRY                 */ 02195000
*     THEN                                                         0577 02196000
         TM    ICTMMOD(@14),B'10000000'                            0577 02197000
         BNO   @RF00577                                            0577 02198000
*     IOPTYPE=IOPMOD;               /* MOD TYPE ENTRY                */ 02199000
         MVI   IOPTYPE(@15),X'05'                                  0578 02200000
*   ELSE                                                           0579 02201000
*     IF ICTMMACR(1)=ON             /* ICT MAC ENTRY                 */ 02202000
*       THEN                                                       0579 02203000
         B     @RC00577                                            0579 02204000
@RF00577 L     @15,@PC00012                                        0579 02205000
         TM    ICTMMACR(@15),B'00001000'                           0579 02206000
         BNO   @RF00579                                            0579 02207000
*       IOPTYPE=IOPMAC;             /* MAC TYPE ENTRY                */ 02208000
         L     @01,IOPPTR                                          0580 02209000
         MVI   IOPTYPE(@01),X'03'                                  0580 02210000
*     ELSE                                                         0581 02211000
*       IF ICTMSRCR(1)=ON           /* ICT SRC ENTRY                 */ 02212000
*         THEN                                                     0581 02213000
         B     @RC00579                                            0581 02214000
@RF00579 L     @15,@PC00012                                        0581 02215000
         TM    ICTMSRCR(@15),B'00000010'                           0581 02216000
         BNO   @RF00581                                            0581 02217000
*         IOPTYPE=IOPSRC;           /* SRC TYPE ENTRY                */ 02218000
         L     @01,IOPPTR                                          0582 02219000
         MVI   IOPTYPE(@01),X'08'                                  0582 02220000
*       ELSE                                                       0583 02221000
*         IOPRETRN=IOPEOF;          /* UN-KNOWN TYPE OF ICT ENTRY    */ 02222000
         B     @RC00581                                            0583 02223000
@RF00581 L     @01,IOPPTR                                          0583 02224000
         MVI   IOPRETRN(@01),X'04'                                 0583 02225000
*   IF IOPRETRN=IOPGOOD             /* VALID ICT ENTRY PASSED        */ 02226000
*     THEN                                                         0584 02227000
@RC00581 DS    0H                                                  0584 02228000
@RC00579 DS    0H                                                  0584 02229000
@RC00577 L     @15,IOPPTR                                          0584 02230000
         CLI   IOPRETRN(@15),0                                     0584 02231000
         BNE   @RF00584                                            0584 02232000
*     CALL HMASMIO(HMASMIOP);       /* LOCATE ELEMENT ON CDS         */ 02233000
         ST    @15,@AL00001                                        0585 02234000
         L     @15,@CV01854                                        0585 02235000
         LA    @01,@AL00001                                        0585 02236000
         BALR  @14,@15                                             0585 02237000
*   IF IOPRETRN>IOPEOF              /* I/O ERROR                     */ 02238000
*     THEN                                                         0586 02239000
@RF00584 L     @15,IOPPTR                                          0586 02240000
         CLI   IOPRETRN(@15),4                                     0586 02241000
         BNH   @RF00586                                            0586 02242000
*     CDSELRC=MAX(CDSELRC,IOPRETRN);/* MAINTAIN ERROR RETURN CODES   */ 02243000
         L     @14,@PC00012+4                                      0587 02244000
         L     @09,CDSELRC(,@14)                                   0587 02245000
         SLR   @08,@08                                             0587 02246000
         IC    @08,IOPRETRN(,@15)                                  0587 02247000
         CR    @09,@08                                             0587 02248000
         BNL   *+6                                                      02249000
         LR    @09,@08                                             0587 02250000
         ST    @09,CDSELRC(,@14)                                   0587 02251000
*   RETURN;                                                        0588 02252000
@EL00012 DS    0H                                                  0588 02253000
@EF00012 DS    0H                                                  0588 02254000
@ER00012 LM    @14,@12,@SA00012                                    0588 02255000
         BR    @14                                                 0588 02256000
*   END CDSELEM;                                                   0589 02257000
         B     @EL00012                                            0589 02258000
*                                                                  0590 02259000
*/********************************************************************/ 02260000
*/*                                                                  */ 02261000
*/* BACKUP   - BACKUP A CDS ELEMENT ENTRY BY CALLING HMASMBUE        */ 02262000
*/*                                                                  */ 02263000
*/*            THE BACKUP ENTRY WILL BE ASSOCIATED WITH THE SYSMOD   */ 02264000
*/*            REPRESENTED BY THE ICT PTF SECTION ENTRY POINTED TO   */ 02265000
*/*            BY CPTF                                               */ 02266000
*/*                                                                  */ 02267000
*/*               NOTE - THE IOP POINTED TO BY IOPPTR IS EXPECTED    */ 02268000
*/*               TO BE INITIALIZED WITH THE CDS ELEMENT ENTRY TO    */ 02269000
*/*               BE BACKED UP ON THE SCDS                           */ 02270000
*/*                                                                  */ 02271000
*/********************************************************************/ 02272000
*                                                                  0590 02273000
*BACKUP:                                                           0590 02274000
*   PROC(BKUPRC);                                                  0590 02275000
BACKUP   STM   @14,@12,@SA00013                                    0590 02276000
         MVC   @PC00013(4),0(@01)                                  0590 02277000
*   DCL                                                            0591 02278000
*     BKUPRC FIXED(31);             /* RETURN CODE                   */ 02279000
*                                                                  0591 02280000
*   /*****************************************************************/ 02281000
*   /*                                                               */ 02282000
*   /* INITIALIZE HMASMBUE PARM LIST (BUPPARM)                       */ 02283000
*   /*                                                               */ 02284000
*   /*****************************************************************/ 02285000
*                                                                  0592 02286000
*   BUPPARM=''B;                    /* CLEAR PARM LIST               */ 02287000
         XC    BUPPARM(20),BUPPARM                                 0592 02288000
*   BUPFUNCT=BUPEBKUP;              /* BACKUP CDS ELEMENT ENTRY      */ 02289000
         MVI   BUPFUNCT,X'02'                                      0593 02290000
*   BUPTYPE=BUPDEL;                 /* ENTRY IS BEING DELETED        */ 02291000
         MVI   BUPTYPE,X'03'                                       0594 02292000
*   BUPSYSMD=CPTF->ICTPTFS(1);      /* SYSMOD-ID (DELETING SYSMOD)   */ 02293000
         L     @15,CPTF                                            0595 02294000
         MVC   BUPSYSMD(7),ICTPTFS(@15)                            0595 02295000
*   BUPSTYPE=CPTF->ICTPTYPE(1);     /* SYSMOD TYPE (DELETING  SYSMOD)*/ 02296000
         MVC   BUPSTYPE(1),ICTPTYPE(@15)                           0596 02297000
*   BUPIOPAD=IOPPTR;                /* IOP WITH CDS ELEMENT ENTRY    */ 02298000
         MVC   BUPIOPAD(4),IOPPTR                                  0597 02299000
*   BUPGTPAD=0;                     /* N/A                           */ 02300000
         SLR   @15,@15                                             0598 02301000
         ST    @15,BUPGTPAD                                        0598 02302000
*   CALL HMASMBUE(BUPPARM);         /* BACKUP THE ENTRY              */ 02303000
         L     @15,@CV01851                                        0599 02304000
         LA    @01,@AL00599                                        0599 02305000
         BALR  @14,@15                                             0599 02306000
*   RESPECIFY                                                      0600 02307000
*     REG15 RSTD;                                                  0600 02308000
*   BKUPRC=MAX(BKUPRC,REG15);       /* SAVE RETURN CODE              */ 02309000
         L     @14,@PC00013                                        0601 02310000
         L     @09,BKUPRC(,@14)                                    0601 02311000
         CR    @09,REG15                                           0601 02312000
         BNL   *+6                                                      02313000
         LR    @09,REG15                                           0601 02314000
         ST    @09,BKUPRC(,@14)                                    0601 02315000
*   RESPECIFY                                                      0602 02316000
*     REG15 UNRSTD;                                                0602 02317000
*   IF BKUPRC>=STOPPTF              /* SYSMOD TERMINATING ERROR      */ 02318000
*     THEN                                                         0603 02319000
         CH    @09,@CH00110                                        0603 02320000
         BL    @RF00603                                            0603 02321000
*     DO;                                                          0604 02322000
*                                                                  0604 02323000
*       /*************************************************************/ 02324000
*       /*                                                           */ 02325000
*       /* MARK THE SYSMOD DELETING THIS ELEMENT NOGO                */ 02326000
*       /*                                                           */ 02327000
*       /*************************************************************/ 02328000
*                                                                  0605 02329000
*       CPTF->ICTPNOGO(1)=ON;       /* SET NOGO FLAG                 */ 02330000
         L     @01,CPTF                                            0605 02331000
         OI    ICTPNOGO(@01),B'01000000'                           0605 02332000
*     END;                                                         0606 02333000
*   ELSE                                                           0607 02334000
*     SBKUPD=ON;                    /* SCDS SYSMOD ENTRY HAS BEEN  0607 02335000
*                                      CREATED OR UPDATED            */ 02336000
         B     @RC00603                                            0607 02337000
@RF00603 OI    SBKUPD,B'10000000'                                  0607 02338000
*   RETURN;                                                        0608 02339000
@EL00013 DS    0H                                                  0608 02340000
@EF00013 DS    0H                                                  0608 02341000
@ER00013 LM    @14,@12,@SA00013                                    0608 02342000
         BR    @14                                                 0608 02343000
*   END BACKUP;                                                    0609 02344000
         B     @EL00013                                            0609 02345000
*                                                                  0610 02346000
*/********************************************************************/ 02347000
*/*                                                                  */ 02348000
*/* LMPRCICT - FOR A GIVEN LOAD MODULE WHICH HAS BEEN DELETED,       */ 02349000
*/*            MARK ANY ICT LMOD ENTRIES FOR THE SAME LOAD MODULE    */ 02350000
*/*            AS "IN-PROCESS" SO THE COMPLETION PROCEDURE (HMASMCPL)*/ 02351000
*/*            WILL KNOW THAT THE LMOD HAS BEEN PROCESSED            */ 02352000
*/*                                                                  */ 02353000
*/********************************************************************/ 02354000
*                                                                  0610 02355000
*LMPRCICT:                                                         0610 02356000
*   PROC(DLMNAME);                                                 0610 02357000
LMPRCICT STM   @14,@12,12(@13)                                     0610 02358000
         MVC   @PC00014(4),0(@01)                                  0610 02359000
*   DCL                                                            0611 02360000
*     DLMNAME CHAR(8);              /* LOAD MODULE NAME              */ 02361000
*   DCL                                                            0612 02362000
*     LN FIXED(15);                 /* INDEX - ICT LMOD SECTION      */ 02363000
*   RESPECIFY                                                      0613 02364000
*     ICTLMOD BASED(CCAICLMD);      /* ADDRESS ENTIRE LMOD SECT      */ 02365000
*                                                                  0613 02366000
*   /*****************************************************************/ 02367000
*   /*                                                               */ 02368000
*   /* GO THRU THE ICT LMOD LOOKING FOR THE LOAD MODULE NAME PASSED  */ 02369000
*   /*                                                               */ 02370000
*   /*****************************************************************/ 02371000
*                                                                  0614 02372000
*   DO LN=1 BY 1 WHILE ICTLEND(LN)^=ICTENDNT;                      0614 02373000
         LA    LN,1                                                0614 02374000
         B     @DE00614                                            0614 02375000
@DL00614 DS    0H                                                  0615 02376000
*     IF ICTLMNAM(LN)=DLMNAME       /* LMOD ENTRY MATCHES NAME PASSED*/ 02377000
*       THEN                                                       0615 02378000
         LR    @03,LN                                              0615 02379000
         MH    @03,@CH01006                                        0615 02380000
         L     @15,CCAICLMD(,CCAPTR)                               0615 02381000
         L     @14,@PC00014                                        0615 02382000
         ST    @03,@TF00001                                        0615 02383000
         ALR   @03,@15                                             0615 02384000
         AL    @03,@CF02138                                        0615 02385000
         CLC   ICTLMNAM(8,@03),DLMNAME(@14)                        0615 02386000
         BNE   @RF00615                                            0615 02387000
*       DO;                                                        0616 02388000
*                                                                  0616 02389000
*         /***********************************************************/ 02390000
*         /*                                                         */ 02391000
*         /* MARK THE LMOD ENTRY AS "IN-PROCESS"                     */ 02392000
*         /*                                                         */ 02393000
*         /***********************************************************/ 02394000
*                                                                  0617 02395000
*         ICTLPROC(LN)=ON;          /* SET "IN-PROCESS" FLAG         */ 02396000
         AL    @15,@TF00001                                        0617 02397000
         AL    @15,@CF02139                                        0617 02398000
         OI    ICTLPROC-8(@15),B'10000000'                         0617 02399000
*       END;                                                       0618 02400000
*   END;                                                           0619 02401000
@RF00615 AH    LN,@CH00085                                         0619 02402000
@DE00614 LR    @03,LN                                              0619 02403000
         MH    @03,@CH01006                                        0619 02404000
         L     @01,CCAICLMD(,CCAPTR)                               0619 02405000
         AL    @01,@CF02138                                        0619 02406000
         L     @03,ICTLEND(@03,@01)                                0619 02407000
         CL    @03,ICTENDNT                                        0619 02408000
         BNE   @DL00614                                            0619 02409000
*   RETURN;                                                        0620 02410000
@EL00014 DS    0H                                                  0620 02411000
@EF00014 DS    0H                                                  0620 02412000
@ER00014 LM    @14,@12,12(@13)                                     0620 02413000
         BR    @14                                                 0620 02414000
*   END LMPRCICT;                                                  0621 02415000
*                                                                  0622 02416000
*/********************************************************************/ 02417000
*/*                                                                  */ 02418000
*/* MDLPCHK  - DETERMINE THE SETTING OF ICTPMDLP FOR THE "CURRENT"   */ 02419000
*/*            SYSMOD.  ICTPMDLP WILL BE SET IF AN SCDS BACKUP ENTRY */ 02420000
*/*            WILL BE CREATED FOR THIS SYSMOD AT APPLY TIME.        */ 02421000
*/*            AN SCDS BACKUP ENTRY WILL BE CREATED IF THERE ARE     */ 02422000
*/*            DELETED ELEMENTS IN THE SYSMOD AND THE SYSMOD IS      */ 02423000
*/*            NOT BEING DELETED (EITHER EXPLICITLY OR IMPLICITLY).  */ 02424000
*/*                                                                  */ 02425000
*/*           ON ENTRY: CPTF IS EXPECTED TO BE POINTING TO THE ICT   */ 02426000
*/*                     PTF SECTION ENTRY REPRESENTING THE "CURRENT" */ 02427000
*/*                     SYSMOD.                                      */ 02428000
*/*                                                                  */ 02429000
*/********************************************************************/ 02430000
*                                                                  0622 02431000
*MDLPCHK:                                                          0622 02432000
*   PROC;                                                          0622 02433000
MDLPCHK  STM   @14,@12,12(@13)                                     0622 02434000
*   DCL                                                            0623 02435000
*     MDLINX FIXED(15);             /* INDEX INTO "CURRENT" SYSMOD'S    02436000
*                                      LIST OF ELEMENTS              */ 02437000
*   RESPECIFY                                                      0624 02438000
*     ICTPTF BASED(CPTF);           /* ADDRESS "CURRENT" SYSMOD      */ 02439000
*   RESPECIFY                                                      0625 02440000
*     ICTIXPF BASED(ICTPCHN(1));    /* ADDRESS LIST OF ELEMENTS      */ 02441000
*   RESPECIFY                                                      0626 02442000
*     ICTMOD BASED(ICTIXPF(MDLINX));/* ADDRESS AN ELEMENT            */ 02443000
*   ICTPMDLP(1)=OFF;                /* CLEAR MDLP FLAG IN ICT ENTRY  */ 02444000
         L     @15,CPTF                                            0627 02445000
         NI    ICTPMDLP(@15),B'11111110'                           0627 02446000
*   IF ICTPDEXP(1)=OFF              /* SYSMOD NOT EXPLICITLY DELETED */ 02447000
*       &ICTPDIMP(1)=OFF            /* SYSMOD NOT IMPLICITLY DELETED */ 02448000
*     THEN                                                         0628 02449000
         TM    ICTPDEXP(@15),B'00110000'                           0628 02450000
         BNZ   @RF00628                                            0628 02451000
*     DO;                                                          0629 02452000
*                                                                  0629 02453000
*       /*************************************************************/ 02454000
*       /*                                                           */ 02455000
*       /* GO THRU MOD SECTION ENTRIES FOR THIS SYSMOD               */ 02456000
*       /*                                                           */ 02457000
*       /*************************************************************/ 02458000
*                                                                  0630 02459000
*       DO MDLINX=1 BY 1 WHILE ICTIXP(MDLINX)^=ICTENDIX/* NOT END    */ 02460000
*             &ICTPMDLP(1)=OFF;     /* FLAG NOT YET SET              */ 02461000
         LA    MDLINX,1                                            0630 02462000
         B     @DE00630                                            0630 02463000
@DL00630 DS    0H                                                  0631 02464000
*         IF ICTMISEL(1)=ON         /* ELEMENT SELECTED              */ 02465000
*             &ICTMIDEL(1)=ON       /* ... FOR DELETION              */ 02466000
*           THEN                                                   0631 02467000
         LR    @03,MDLINX                                          0631 02468000
         SLA   @03,2                                               0631 02469000
         L     @15,CPTF                                            0631 02470000
         L     @01,ICTPCHN(,@15)                                   0631 02471000
         AL    @01,@CF02122                                        0631 02472000
         L     @03,ICTIXPF(@03,@01)                                0631 02473000
         TM    ICTMISEL(@03),B'11000000'                           0631 02474000
         BNO   @RF00631                                            0631 02475000
*           ICTPMDLP(1)=ON;         /* SET FLAG WHICH IMPLIES THAT AN   02476000
*                                      SCDS BACKUP ENTRY WILL BE   0632 02477000
*                                      CREATED AT APPLY TIME         */ 02478000
         OI    ICTPMDLP(@15),B'00000001'                           0632 02479000
*       END;                                                       0633 02480000
@RF00631 AH    MDLINX,@CH00085                                     0633 02481000
@DE00630 LR    @03,MDLINX                                          0633 02482000
         SLA   @03,2                                               0633 02483000
         L     @15,CPTF                                            0633 02484000
         L     @01,ICTPCHN(,@15)                                   0633 02485000
         AL    @01,@CF02122                                        0633 02486000
         L     @03,ICTIXP(@03,@01)                                 0633 02487000
         CL    @03,ICTENDIX                                        0633 02488000
         BE    @DC00630                                            0633 02489000
         TM    ICTPMDLP(@15),B'00000001'                           0633 02490000
         BZ    @DL00630                                            0633 02491000
@DC00630 DS    0H                                                  0634 02492000
*     END;                                                         0634 02493000
*   RETURN;                                                        0635 02494000
@EL00015 DS    0H                                                  0635 02495000
@EF00015 DS    0H                                                  0635 02496000
@ER00015 LM    @14,@12,12(@13)                                     0635 02497000
         BR    @14                                                 0635 02498000
*   END MDLPCHK;                                                   0636 02499000
         B     @EL00015                                            0636 02500000
*                                                                  0637 02501000
*/********************************************************************/ 02502000
*/*                                                                  */ 02503000
*/* PTFENTRY - CALL HMASMSEC TO CREATE AN (A)CDS PTF ENTRY FOR       */ 02504000
*/*            THE SYSMOD PASSED                                     */ 02505000
*/*                                                                  */ 02506000
*/*                                                                  */ 02507000
*/*                                                                  */ 02508000
*/********************************************************************/ 02509000
*                                                                  0637 02510000
*PTFENTRY:                                                         0637 02511000
*   PROC(PTFICT,PTFENTRC);                                         0637 02512000
PTFENTRY STM   @14,@12,@SA00016                                    0637 02513000
         MVC   @PC00016(8),0(@01)                                  0637 02514000
*   DCL                                                            0638 02515000
*     PTFICT CHAR(*);               /* ICT PTF ENTRY                 */ 02516000
*   DCL                                                            0639 02517000
*     PTFENTRC FIXED(31);           /* RETURN CODE PARAMETER         */ 02518000
*   RESPECIFY                                                      0640 02519000
*     ICTPTF BASED(ADDR(PTFICT));   /* ADDRESS ENTRY PASSED          */ 02520000
*   IF PTFENT=OFF                   /* PTF ENTRY NOT YET CREATED     */ 02521000
*     THEN                                                         0641 02522000
         TM    PTFENT,B'01000000'                                  0641 02523000
         BNZ   @RF00641                                            0641 02524000
*     DO;                                                          0642 02525000
*       CALL HMASMSEC(ICTPTF(1),IOPPTR);/* CREATE (A)CDS PTF ENTRY 0643 02526000
*                                      FOR THIS SYSMOD "IN-ERROR"    */ 02527000
         L     @15,@PC00016                                        0643 02528000
         ST    @15,@AL00001                                        0643 02529000
         LA    @15,IOPPTR                                          0643 02530000
         ST    @15,@AL00001+4                                      0643 02531000
         L     @15,@CV01856                                        0643 02532000
         LA    @01,@AL00001                                        0643 02533000
         BALR  @14,@15                                             0643 02534000
*       RESPECIFY                                                  0644 02535000
*         REG15 RSTD;                                              0644 02536000
*       PTFENTRC=MAX(PTFENTRC,REG15);/* MAINTAIN RETURN CODE         */ 02537000
         L     @14,@PC00016+4                                      0645 02538000
         L     @09,PTFENTRC(,@14)                                  0645 02539000
         CR    @09,REG15                                           0645 02540000
         BNL   *+6                                                      02541000
         LR    @09,REG15                                           0645 02542000
         ST    @09,PTFENTRC(,@14)                                  0645 02543000
*       RESPECIFY                                                  0646 02544000
*         REG15 UNRSTD;                                            0646 02545000
*       PTFENT=ON;                  /* (A)CDS PTF ENTRY CREATED      */ 02546000
         OI    PTFENT,B'01000000'                                  0647 02547000
*     END;                                                         0648 02548000
*   RETURN;                                                        0649 02549000
@EL00016 DS    0H                                                  0649 02550000
@EF00016 DS    0H                                                  0649 02551000
@ER00016 LM    @14,@12,@SA00016                                    0649 02552000
         BR    @14                                                 0649 02553000
*   END PTFENTRY;                                                  0650 02554000
         B     @EL00016                                            0650 02555000
*                                                                  0651 02556000
*/********************************************************************/ 02557000
*/*                                                                  */ 02558000
*/* LMALIAS  - FIND LOAD MODULE ALIASES IN (A)CDS LMOD ENTRY AND     */ 02559000
*/*            DELETE THEM FROM SYSLIB PASSED                        */ 02560000
*/*                                                                  */ 02561000
*/*            NOTE - THE IOP USED BY THIS PROCEDURE MUST BE         */ 02562000
*/*                   INITIALIZED BY DOING A LOCATE FOR THE CDS      */ 02563000
*/*                   LMOD ENTRY ASSOCIATED WITH THE LOAD MODULE     */ 02564000
*/*                   WHOSE ALIASES ARE TO BE PROCESSED              */ 02565000
*/*                                                                  */ 02566000
*/********************************************************************/ 02567000
*                                                                  0651 02568000
*LMALIAS:                                                          0651 02569000
*   PROC(LMDDN);                                                   0651 02570000
LMALIAS  STM   @14,@12,@SA00017                                    0651 02571000
         MVC   @PC00017(4),0(@01)                                  0651 02572000
*   DCL                                                            0652 02573000
*     LMDDN CHAR(8);                /* SYSLIB DDNAME                 */ 02574000
*   DCL                                                            0653 02575000
*     1 LMDFLGS BIT(8),             /* LOCAL FLAGS                   */ 02576000
*      2 LMDEOF BIT(1),             /* END-OF-FILE ON CDS LMOD ENTRY */ 02577000
*      2 STMTCONT BIT(1),           /* LKED CNTRL STMT CONTINUED     */ 02578000
*      2 * BIT(6);                  /*                               */ 02579000
*   DCL                                                            0654 02580000
*     STMTTYPE CHAR(1);             /* LKED CNTRL STMT TYPE          */ 02581000
*   DCL                                                            0655 02582000
*     ALIASTYP CHAR(1) CONSTANT('A');/* ALIAS CNTRL STMT             */ 02583000
*   DCL                                                            0656 02584000
*     NOTYPE CHAR(1) CONSTANT('N'); /* ALL OTHER LKED STMTS          */ 02585000
*   DCL                                                            0657 02586000
*     KEYALIAS CHAR(5) INIT('ALIAS');                              0657 02587000
*   DCL                                                            0658 02588000
*     BLANK8 CHAR(8) CONSTANT('        ');                         0658 02589000
*                                                                  0658 02590000
*   /*****************************************************************/ 02591000
*   /*                                                               */ 02592000
*   /* LKED CNTRL STMT INPUT BUFFER MAPPING                          */ 02593000
*   /*                                                               */ 02594000
*   /*****************************************************************/ 02595000
*                                                                  0659 02596000
*   DCL                                                            0659 02597000
*     BUFINDX FIXED(15);            /* INPUT BUFFER INDEX            */ 02598000
*   DCL                                                            0660 02599000
*     1 STMTBUF CHAR(80) BASED,     /* STMT INPUT BUFFER             */ 02600000
*      2 STMT CHAR(71),             /* DATA FIELD                    */ 02601000
*      2 STMT72 CHAR(1),            /* CONTINUATION FIELD            */ 02602000
*      2 * CHAR(8);                 /* SEQUENCE NO. FIELD            */ 02603000
*   DCL                                                            0661 02604000
*     COL16 FIXED(15) CONSTANT(16); /* START POSITION OF CONTD STMT  */ 02605000
*                                                                  0661 02606000
*   /*****************************************************************/ 02607000
*   /*                                                               */ 02608000
*   /* ALIAS NAME ARRAY                                              */ 02609000
*   /*                                                               */ 02610000
*   /*****************************************************************/ 02611000
*                                                                  0662 02612000
*   DCL                                                            0662 02613000
*     MAXALIAS FIXED(31) CONSTANT(16);/* MAXIMUM NUMBER OF ALIASES 0662 02614000
*                                      ALLOWED BY LINKAGE EDITOR     */ 02615000
*   DCL                                                            0663 02616000
*     OPARRAY(MAXALIAS) CHAR(8);    /* ARRAY OF ALIAS NAMES          */ 02617000
*   DCL                                                            0664 02618000
*     OPINDX FIXED(15);             /* INDEX INTO OPARRAY            */ 02619000
*   DCL                                                            0665 02620000
*     LMDRTN FIXED(31);             /* RETURN CODE COLLECTOR         */ 02621000
*   RESPECIFY                                                      0666 02622000
*     STMTBUF BASED(IOPBUFAD);      /* ADDRESS INPUT BUFFER AREA     */ 02623000
*   LMDFLGS=''B;                    /* CLEAR LOCAL FLAGS             */ 02624000
         MVI   LMDFLGS,X'00'                                       0667 02625000
*   LMDRTN=0;                       /* CLEAR RETURN CODE             */ 02626000
*                                                                  0668 02627000
         SLR   @05,@05                                             0668 02628000
         ST    @05,LMDRTN                                          0668 02629000
*   /*****************************************************************/ 02630000
*   /*                                                               */ 02631000
*   /* BLANK ALL ENTRIES IN ALIAS NAME ARRAY (OPARRAY)               */ 02632000
*   /*                                                               */ 02633000
*   /*****************************************************************/ 02634000
*                                                                  0669 02635000
*   DO OPINDX=1 BY 1 TO MAXALIAS;                                  0669 02636000
         LA    OPINDX,1                                            0669 02637000
@DL00669 DS    0H                                                  0670 02638000
*     OPARRAY(OPINDX)=BLANK8;       /* BLANK ALIAS NAME ENTRY        */ 02639000
         LR    @05,OPINDX                                          0670 02640000
         SLA   @05,3                                               0670 02641000
         LA    @02,OPARRAY-8(@05)                                  0670 02642000
         MVC   0(8,@02),@CC01867                                   0670 02643000
*   END;                                                           0671 02644000
         AH    OPINDX,@CH00085                                     0671 02645000
         CH    OPINDX,@CH00186                                     0671 02646000
         BNH   @DL00669                                            0671 02647000
*   OPINDX=1;                       /* INITIALIZE ARRAY INDEX        */ 02648000
*                                                                  0672 02649000
         LA    OPINDX,1                                            0672 02650000
*   /*****************************************************************/ 02651000
*   /*                                                               */ 02652000
*   /* POSITION TO LMOD MEMBER DATA IN CDS                           */ 02653000
*   /*                                                               */ 02654000
*   /*****************************************************************/ 02655000
*                                                                  0673 02656000
*   IOPFUNCT=IOPPOSI;                                              0673 02657000
         L     @05,IOPPTR                                          0673 02658000
         MVI   IOPFUNCT(@05),X'02'                                 0673 02659000
*   CALL HMASMIO(HMASMIOP);                                        0674 02660000
         ST    @05,@AL00001                                        0674 02661000
         L     @15,@CV01854                                        0674 02662000
         LA    @01,@AL00001                                        0674 02663000
         BALR  @14,@15                                             0674 02664000
*   LMDRTN=MAX(LMDRTN,IOPRETRN);    /* MAINTAIN RETURN CODE          */ 02665000
*                                                                  0675 02666000
         L     @05,IOPPTR                                          0675 02667000
         L     @02,LMDRTN                                          0675 02668000
         SLR   @15,@15                                             0675 02669000
         IC    @15,IOPRETRN(,@05)                                  0675 02670000
         CR    @02,@15                                             0675 02671000
         BNL   *+6                                                      02672000
         LR    @02,@15                                             0675 02673000
         ST    @02,LMDRTN                                          0675 02674000
*   /*****************************************************************/ 02675000
*   /*                                                               */ 02676000
*   /* READ FIRST RECORD FROM LMOD MEMBER DATA ... IGNORE IT         */ 02677000
*   /*                                                               */ 02678000
*   /*****************************************************************/ 02679000
*                                                                  0676 02680000
*   IF LMDRTN=ZERO THEN                                            0676 02681000
         LTR   @02,@02                                             0676 02682000
         BNZ   @RF00676                                            0676 02683000
*     DO;                                                          0677 02684000
*       IOPFUNCT=IOPREAD;                                          0678 02685000
         MVI   IOPFUNCT(@05),X'01'                                 0678 02686000
*       CALL HMASMIO(HMASMIOP);                                    0679 02687000
         ST    @05,@AL00001                                        0679 02688000
         L     @15,@CV01854                                        0679 02689000
         LA    @01,@AL00001                                        0679 02690000
         BALR  @14,@15                                             0679 02691000
*       IF IOPRETRN=IOPEOF          /* END-OF-FILE ENCOUNTERED       */ 02692000
*         THEN                                                     0680 02693000
         L     @05,IOPPTR                                          0680 02694000
         CLI   IOPRETRN(@05),4                                     0680 02695000
         BNE   @RF00680                                            0680 02696000
*         LMDEOF=ON;                /* SET END-OF-FILE FLAG          */ 02697000
         OI    LMDEOF,B'10000000'                                  0681 02698000
*       ELSE                                                       0682 02699000
*         LMDRTN=MAX(LMDRTN,IOPRETRN);/* MAINTAIN RETURN CODE        */ 02700000
         B     @RC00680                                            0682 02701000
@RF00680 L     @05,LMDRTN                                          0682 02702000
         L     @02,IOPPTR                                          0682 02703000
         SLR   @15,@15                                             0682 02704000
         IC    @15,IOPRETRN(,@02)                                  0682 02705000
         CR    @05,@15                                             0682 02706000
         BNL   *+6                                                      02707000
         LR    @05,@15                                             0682 02708000
         ST    @05,LMDRTN                                          0682 02709000
*     END;                                                         0683 02710000
*                                                                  0683 02711000
@RC00680 DS    0H                                                  0684 02712000
*   /*****************************************************************/ 02713000
*   /*                                                               */ 02714000
*   /* READ SECOND RECORD FROM LMOD MEMBER DATA                      */ 02715000
*   /*                                                               */ 02716000
*   /*****************************************************************/ 02717000
*                                                                  0684 02718000
*   IF LMDRTN=ZERO THEN                                            0684 02719000
@RF00676 ICM   @05,15,LMDRTN                                       0684 02720000
         BNZ   @RF00684                                            0684 02721000
*     DO;                                                          0685 02722000
*       IOPFUNCT=IOPREAD;                                          0686 02723000
         L     @05,IOPPTR                                          0686 02724000
         MVI   IOPFUNCT(@05),X'01'                                 0686 02725000
*       CALL HMASMIO(HMASMIOP);                                    0687 02726000
         ST    @05,@AL00001                                        0687 02727000
         L     @15,@CV01854                                        0687 02728000
         LA    @01,@AL00001                                        0687 02729000
         BALR  @14,@15                                             0687 02730000
*       IF IOPRETRN=IOPEOF          /* END-OF-FILE ENCOUNTERED       */ 02731000
*         THEN                                                     0688 02732000
         L     @05,IOPPTR                                          0688 02733000
         CLI   IOPRETRN(@05),4                                     0688 02734000
         BNE   @RF00688                                            0688 02735000
*         LMDEOF=ON;                /* SET END-OF-FILE FLAG          */ 02736000
         OI    LMDEOF,B'10000000'                                  0689 02737000
*       ELSE                                                       0690 02738000
*         LMDRTN=MAX(LMDRTN,IOPRETRN);/* MAINTAIN RETURN CODE        */ 02739000
         B     @RC00688                                            0690 02740000
@RF00688 L     @05,LMDRTN                                          0690 02741000
         L     @02,IOPPTR                                          0690 02742000
         SLR   @15,@15                                             0690 02743000
         IC    @15,IOPRETRN(,@02)                                  0690 02744000
         CR    @05,@15                                             0690 02745000
         BNL   *+6                                                      02746000
         LR    @05,@15                                             0690 02747000
         ST    @05,LMDRTN                                          0690 02748000
*     END;                                                         0691 02749000
@RC00688 DS    0H                                                  0692 02750000
*                                                                  0692 02751000
*   /*****************************************************************/ 02752000
*   /*                                                               */ 02753000
*   /* PROCESS THE REMAINING RECORDS IN LMOD MEMBER                  */ 02754000
*   /*                                                               */ 02755000
*   /*****************************************************************/ 02756000
*                                                                  0692 02757000
*   DO WHILE LMDRTN<STOPPTF         /* NO TERMINATING ERRORS         */ 02758000
*         &LMDEOF=OFF;              /* NOT AT END-OF-FILE            */ 02759000
@RF00684 B     @DE00692                                            0692 02760000
@DL00692 DS    0H                                                  0693 02761000
*     CALL STMTCHK(BUFINDX);        /* DETERMINE STATEMENT TYPE      */ 02762000
         LA    @01,@AL00693                                        0693 02763000
         BAL   @14,STMTCHK                                         0693 02764000
*     IF STMTTYPE=ALIASTYP          /* "ALIAS" STATEMENT             */ 02765000
*       THEN                                                       0694 02766000
         CLI   STMTTYPE,C'A'                                       0694 02767000
         BNE   @RF00694                                            0694 02768000
*       CALL OPERANDS(BUFINDX);     /* PICK UP ALIAS OPERANDS        */ 02769000
         LA    @01,@AL00695                                        0695 02770000
         BAL   @14,OPERANDS                                        0695 02771000
*     STMTCONT=OFF;                 /* CLEAR STMT CONTINUED FLAG     */ 02772000
@RF00694 NI    STMTCONT,B'10111111'                                0696 02773000
*     IF STMT(1)=' '                /* LKED CNTRL STMT (COL 1 BLANK) */ 02774000
*         &STMT72^=' '              /* CONTINUED (COL 72 NON-BLANK)  */ 02775000
*       THEN                                                       0697 02776000
         L     @05,IOPPTR                                          0697 02777000
         L     @05,IOPBUFAD(,@05)                                  0697 02778000
         CLI   STMT(@05),C' '                                      0697 02779000
         BNE   @RF00697                                            0697 02780000
         CLI   STMT72(@05),C' '                                    0697 02781000
         BE    @RF00697                                            0697 02782000
*       STMTCONT=ON;                /* SET STMT CONTIUNED FLAG       */ 02783000
*                                                                  0698 02784000
         OI    STMTCONT,B'01000000'                                0698 02785000
*     /***************************************************************/ 02786000
*     /*                                                             */ 02787000
*     /* READ THE NEXT LMOD RECORD                                   */ 02788000
*     /*                                                             */ 02789000
*     /***************************************************************/ 02790000
*                                                                  0699 02791000
*     IOPFUNCT=IOPREAD;                                            0699 02792000
@RF00697 L     @05,IOPPTR                                          0699 02793000
         MVI   IOPFUNCT(@05),X'01'                                 0699 02794000
*     CALL HMASMIO(HMASMIOP);                                      0700 02795000
         ST    @05,@AL00001                                        0700 02796000
         L     @15,@CV01854                                        0700 02797000
         LA    @01,@AL00001                                        0700 02798000
         BALR  @14,@15                                             0700 02799000
*     IF IOPRETRN=IOPEOF            /* END-OF-FILE ENCOUNTERED       */ 02800000
*       THEN                                                       0701 02801000
         L     @05,IOPPTR                                          0701 02802000
         CLI   IOPRETRN(@05),4                                     0701 02803000
         BNE   @RF00701                                            0701 02804000
*       LMDEOF=ON;                  /* SET END-OF-FILE FLAG          */ 02805000
         OI    LMDEOF,B'10000000'                                  0702 02806000
*     ELSE                                                         0703 02807000
*       LMDRTN=MAX(LMDRTN,IOPRETRN);/* MAINTAIN RETURN CODE          */ 02808000
         B     @RC00701                                            0703 02809000
@RF00701 L     @05,LMDRTN                                          0703 02810000
         L     @02,IOPPTR                                          0703 02811000
         SLR   @15,@15                                             0703 02812000
         IC    @15,IOPRETRN(,@02)                                  0703 02813000
         CR    @05,@15                                             0703 02814000
         BNL   *+6                                                      02815000
         LR    @05,@15                                             0703 02816000
         ST    @05,LMDRTN                                          0703 02817000
*   END;                                                           0704 02818000
*                                                                  0704 02819000
@RC00701 DS    0H                                                  0704 02820000
@DE00692 L     @05,LMDRTN                                          0704 02821000
         CH    @05,@CH00110                                        0704 02822000
         BNL   @DC00692                                            0704 02823000
         TM    LMDEOF,B'10000000'                                  0704 02824000
         BZ    @DL00692                                            0704 02825000
@DC00692 DS    0H                                                  0705 02826000
*   /*****************************************************************/ 02827000
*   /*                                                               */ 02828000
*   /* DELETE ALL ALIAS NAMES FROM THE DDNAME PASSED                 */ 02829000
*   /*                                                               */ 02830000
*   /*****************************************************************/ 02831000
*                                                                  0705 02832000
*   DO OPINDX=1 BY 1 TO MAXALIAS    /* GO THUR OPARRAY OF ALIASES    */ 02833000
*         WHILE(OPARRAY(OPINDX)^=BLANK8/* NOT AT END OF ALIASES      */ 02834000
*         &LMDRTN<STOPPTF);         /* NO TERMINATING ERRORS         */ 02835000
         LA    OPINDX,1                                            0705 02836000
@DL00705 LR    @05,OPINDX                                          0705 02837000
         SLA   @05,3                                               0705 02838000
         LA    @02,OPARRAY-8(@05)                                  0705 02839000
         CLC   0(8,@02),@CC01867                                   0705 02840000
         BE    @DC00705                                            0705 02841000
         L     @02,LMDRTN                                          0705 02842000
         CH    @02,@CH00110                                        0705 02843000
         BNL   @DC00705                                            0705 02844000
*     CALL DELMEMBR(OPARRAY(OPINDX),/* ALIAS NAME TO BE DELETED      */ 02845000
*         IOPLMD,                   /* ELEMENT TYPE - LOAD MODULE    */ 02846000
*         LMDDN,                    /* DDNAME OF DATASET             */ 02847000
*         LMDRTN);                  /* RETURN CODE PARAMETER         */ 02848000
         LA    @05,OPARRAY-8(@05)                                  0706 02849000
         ST    @05,@AL00001                                        0706 02850000
         LA    @05,@CH00181+1                                      0706 02851000
         ST    @05,@AL00001+4                                      0706 02852000
         L     @05,@PC00017                                        0706 02853000
         ST    @05,@AL00001+8                                      0706 02854000
         LA    @05,LMDRTN                                          0706 02855000
         ST    @05,@AL00001+12                                     0706 02856000
         LA    @01,@AL00001                                        0706 02857000
         BAL   @14,DELMEMBR                                        0706 02858000
*   END;                                                           0707 02859000
         AH    OPINDX,@CH00085                                     0707 02860000
         CH    OPINDX,@CH00186                                     0707 02861000
         BNH   @DL00705                                            0707 02862000
@DC00705 DS    0H                                                  0708 02863000
*   RETURN;                                                        0708 02864000
@EL00017 DS    0H                                                  0708 02865000
@EF00017 DS    0H                                                  0708 02866000
@ER00017 LM    @14,@12,@SA00017                                    0708 02867000
         BR    @14                                                 0708 02868000
*                                                                  0709 02869000
*/********************************************************************/ 02870000
*/*                                                                  */ 02871000
*/* STMTCHK  - DETERMINE THE TYPE OF STATEMENT IN THE INPUT BUFFER   */ 02872000
*/*                                                                  */ 02873000
*/********************************************************************/ 02874000
*                                                                  0709 02875000
*STMTCHK:                                                          0709 02876000
*   PROC(STEND);                                                   0709 02877000
STMTCHK  STM   @14,@12,12(@13)                                     0709 02878000
         MVC   @PC00018(4),0(@01)                                  0709 02879000
*   DCL                                                            0710 02880000
*     STEND FIXED(15);              /* INDEX OF THE CHARACTER      0710 02881000
*                                      FOLLOWING THE LKED CNTRL STMT    02882000
*                                      FOUND                         */ 02883000
*   DCL                                                            0711 02884000
*     ST FIXED(15);                 /* LOCAL INDEX                   */ 02885000
*   DCL                                                            0712 02886000
*     STE FIXED(15);                /* LOCAL INDEX                   */ 02887000
*   DCL                                                            0713 02888000
*     KEYL FIXED(15);               /* KEYWORD LENGTH                */ 02889000
*   IF STMTCONT=ON                  /* CONTINUED LKED STATEMENT      */ 02890000
*     THEN                                                         0714 02891000
         TM    STMTCONT,B'01000000'                                0714 02892000
         BNO   @RF00714                                            0714 02893000
*     STEND=COL16;                  /* OPERANDS START IN COLUMN 16   */ 02894000
         L     @15,@PC00018                                        0715 02895000
         MVC   STEND(2,@15),@CH00186                               0715 02896000
*   ELSE                                                           0716 02897000
*     DO;                                                          0716 02898000
*                                                                  0716 02899000
         B     @RC00714                                            0716 02900000
@RF00714 DS    0H                                                  0717 02901000
*       /*************************************************************/ 02902000
*       /*                                                           */ 02903000
*       /* DETERMINE THE TYPE OF STATEMENT IN STMTBUF                */ 02904000
*       /*                                                           */ 02905000
*       /*************************************************************/ 02906000
*                                                                  0717 02907000
*       STMTTYPE=NOTYPE;            /* INITIALIZE TO NO VALID TYPE   */ 02908000
         MVI   STMTTYPE,C'N'                                       0717 02909000
*       IF STMTBUF(1)=' '           /* LKED CNTRL STMT (BLANK COL 1) */ 02910000
*         THEN                                                     0718 02911000
         L     @01,IOPPTR                                          0718 02912000
         L     @01,IOPBUFAD(,@01)                                  0718 02913000
         CLI   STMTBUF(@01),C' '                                   0718 02914000
         BNE   @RF00718                                            0718 02915000
*         DO;                                                      0719 02916000
*           ST=1;                   /* START IN COLUMN 1             */ 02917000
*                                                                  0720 02918000
         LA    ST,1                                                0720 02919000
*           /*********************************************************/ 02920000
*           /*                                                       */ 02921000
*           /* FIND THE FIRST NON-BLANK                              */ 02922000
*           /*                                                       */ 02923000
*           /*********************************************************/ 02924000
*                                                                  0721 02925000
*           DO WHILE STMT(ST)=' '&ST<=LENGTH(STMT);                0721 02926000
         B     @DE00721                                            0721 02927000
@DL00721 DS    0H                                                  0722 02928000
*             ST=ST+1;              /* INCREMENT TO NEXT POSITION    */ 02929000
         AH    ST,@CH00085                                         0722 02930000
*           END;                                                   0723 02931000
*                                                                  0723 02932000
@DE00721 L     @03,IOPPTR                                          0723 02933000
         L     @03,IOPBUFAD(,@03)                                  0723 02934000
         ALR   @03,ST                                              0723 02935000
         BCTR  @03,0                                               0723 02936000
         CLI   STMT(@03),C' '                                      0723 02937000
         BNE   @DC00721                                            0723 02938000
         CH    ST,@CH01036                                         0723 02939000
         BNH   @DL00721                                            0723 02940000
@DC00721 DS    0H                                                  0724 02941000
*           /*********************************************************/ 02942000
*           /*                                                       */ 02943000
*           /* FIND THE NEXT BLANK                                   */ 02944000
*           /*                                                       */ 02945000
*           /*********************************************************/ 02946000
*                                                                  0724 02947000
*           STE=ST;                 /* START AT 1ST NON-BLANK        */ 02948000
         LR    STE,ST                                              0724 02949000
*           DO WHILE STMT(STE)^=' '&STE<=LENGTH(STMT);             0725 02950000
         B     @DE00725                                            0725 02951000
@DL00725 DS    0H                                                  0726 02952000
*             STE=STE+1;            /* INCREMENT TO NEXT POSITION    */ 02953000
         AH    STE,@CH00085                                        0726 02954000
*           END;                                                   0727 02955000
@DE00725 L     @01,IOPPTR                                          0727 02956000
         L     @01,IOPBUFAD(,@01)                                  0727 02957000
         ALR   @01,STE                                             0727 02958000
         BCTR  @01,0                                               0727 02959000
         CLI   STMT(@01),C' '                                      0727 02960000
         BE    @DC00725                                            0727 02961000
         CH    STE,@CH01036                                        0727 02962000
         BNH   @DL00725                                            0727 02963000
@DC00725 DS    0H                                                  0728 02964000
*           KEYL=STE-ST;            /* LENGTH OF KEYWORD FOUND       */ 02965000
         LR    KEYL,STE                                            0728 02966000
         SLR   KEYL,ST                                             0728 02967000
*           IF KEYL>0               /* NOT AT END-OF-STMT            */ 02968000
*             THEN                                                 0729 02969000
         LTR   KEYL,KEYL                                           0729 02970000
         BNP   @RF00729                                            0729 02971000
*             DO;                                                  0730 02972000
*                                                                  0730 02973000
*               /*****************************************************/ 02974000
*               /*                                                   */ 02975000
*               /* SEE IF KEYWORD FOUND IS "ALIAS"                   */ 02976000
*               /*                                                   */ 02977000
*               /*****************************************************/ 02978000
*                                                                  0731 02979000
*               IF KEYL=LENGTH(KEYALIAS)/* PROPER LENGTH             */ 02980000
*                   &STMT(ST:ST+KEYL-1)=KEYALIAS(1:KEYL-1)/* "ALIAS" */ 02981000
*                 THEN                                             0731 02982000
         CH    KEYL,@CH00128                                       0731 02983000
         BNE   @RF00731                                            0731 02984000
         L     @05,IOPPTR                                          0731 02985000
         L     @05,IOPBUFAD(,@05)                                  0731 02986000
         LR    @15,KEYL                                            0731 02987000
         BCTR  @15,0                                               0731 02988000
         BCTR  @15,0                                               0731 02989000
         ALR   @05,ST                                              0731 02990000
         BCTR  @05,0                                               0731 02991000
         EX    @15,@SC02141                                        0731 02992000
         BNE   @RF00731                                            0731 02993000
*                 DO;                                              0732 02994000
*                   STMTTYPE=ALIASTYP;/* SET STMT TYPE INDICATOR     */ 02995000
         MVI   STMTTYPE,C'A'                                       0733 02996000
*                   STEND=STE;      /* SET INDEX TO END OF KYWRD +1  */ 02997000
         L     @02,@PC00018                                        0734 02998000
         STH   STE,STEND(,@02)                                     0734 02999000
*                 END;                                             0735 03000000
*             END;                                                 0736 03001000
*         END;                                                     0737 03002000
*     END;                                                         0738 03003000
*   RETURN;                                                        0739 03004000
@EL00018 DS    0H                                                  0739 03005000
@EF00018 DS    0H                                                  0739 03006000
@ER00018 LM    @14,@12,12(@13)                                     0739 03007000
         BR    @14                                                 0739 03008000
*   END STMTCHK;                                                   0740 03009000
         B     @EL00018                                            0740 03010000
*                                                                  0741 03011000
*/********************************************************************/ 03012000
*/*                                                                  */ 03013000
*/* OPERANDS - FILL IN THE OPARRAY WITH THE ALIAS NAMES ON THE       */ 03014000
*/*            LKED CONTROL STATEMENT                                */ 03015000
*/*                                                                  */ 03016000
*/********************************************************************/ 03017000
*                                                                  0741 03018000
*OPERANDS:                                                         0741 03019000
*   PROC(STRTINDX);                                                0741 03020000
OPERANDS STM   @14,@02,12(@13)                                     0741 03021000
         STM   @04,@12,36(@13)                                     0741 03022000
         MVC   @PC00019(4),0(@01)                                  0741 03023000
*   DCL                                                            0742 03024000
*     STRTINDX FIXED(15);           /* INDEX OF THE CHARACTER IN   0742 03025000
*                                      STMTBUF WHERE OPERANDS START  */ 03026000
*   DCL                                                            0743 03027000
*     OPSTART FIXED(15);            /* 1ST CHARACTER OF AN OPERAND   */ 03028000
*   DCL                                                            0744 03029000
*     CHARINDX FIXED(15);           /* INDEX TO CHAR IN STMT         */ 03030000
*   CHARINDX=STRTINDX;              /* STARTING INDEX                */ 03031000
         L     @15,@PC00019                                        0745 03032000
         LH    CHARINDX,STRTINDX(,@15)                             0745 03033000
*   DO WHILE CHARINDX<=LENGTH(STMT);                               0746 03034000
*                                                                  0746 03035000
         B     @DE00746                                            0746 03036000
@DL00746 DS    0H                                                  0747 03037000
*     /***************************************************************/ 03038000
*     /*                                                             */ 03039000
*     /* FIND THE FIRST NON-BLANK                                    */ 03040000
*     /*                                                             */ 03041000
*     /***************************************************************/ 03042000
*                                                                  0747 03043000
*     DO WHILE STMT(CHARINDX)=' '&CHARINDX<=LENGTH(STMT);          0747 03044000
         B     @DE00747                                            0747 03045000
@DL00747 DS    0H                                                  0748 03046000
*       CHARINDX=CHARINDX+1;        /* INCREMENT TO NEXT POSITION    */ 03047000
         AH    CHARINDX,@CH00085                                   0748 03048000
*     END;                                                         0749 03049000
@DE00747 L     @01,IOPPTR                                          0749 03050000
         L     @01,IOPBUFAD(,@01)                                  0749 03051000
         ALR   @01,CHARINDX                                        0749 03052000
         BCTR  @01,0                                               0749 03053000
         CLI   STMT(@01),C' '                                      0749 03054000
         BNE   @DC00747                                            0749 03055000
         CH    CHARINDX,@CH01036                                   0749 03056000
         BNH   @DL00747                                            0749 03057000
@DC00747 DS    0H                                                  0750 03058000
*     OPSTART=CHARINDX;             /* SAVE START OF OPERAND         */ 03059000
*                                                                  0750 03060000
         LR    OPSTART,CHARINDX                                    0750 03061000
*     /***************************************************************/ 03062000
*     /*                                                             */ 03063000
*     /* FIND THE NEXT BLANK OR COMMA                                */ 03064000
*     /*                                                             */ 03065000
*     /***************************************************************/ 03066000
*                                                                  0751 03067000
*     DO WHILE STMT(CHARINDX)^=' '  /* NOT A BLANK                   */ 03068000
*           &STMT(CHARINDX)^=','    /* NOT A COMMA                   */ 03069000
*           &CHARINDX<=LENGTH(STMT);/* NOT AT END                    */ 03070000
         B     @DE00751                                            0751 03071000
@DL00751 DS    0H                                                  0752 03072000
*       CHARINDX=CHARINDX+1;        /* INCREMENT TO NEXT POSITION    */ 03073000
         AH    CHARINDX,@CH00085                                   0752 03074000
*     END;                                                         0753 03075000
@DE00751 L     @05,IOPPTR                                          0753 03076000
         L     @05,IOPBUFAD(,@05)                                  0753 03077000
         LR    @01,@05                                             0753 03078000
         ALR   @01,CHARINDX                                        0753 03079000
         BCTR  @01,0                                               0753 03080000
         CLI   STMT(@01),C' '                                      0753 03081000
         BE    @DC00751                                            0753 03082000
         ALR   @05,CHARINDX                                        0753 03083000
         BCTR  @05,0                                               0753 03084000
         CLI   STMT(@05),C','                                      0753 03085000
         BE    @DC00751                                            0753 03086000
         CH    CHARINDX,@CH01036                                   0753 03087000
         BNH   @DL00751                                            0753 03088000
@DC00751 DS    0H                                                  0754 03089000
*     IF(CHARINDX-OPSTART)>0        /* NOT AT END-OF-STMT            */ 03090000
*         &(CHARINDX-OPSTART)<=LENGTH(OPARRAY)/* OPERAND NOT TOO LONG*/ 03091000
*         &OPINDX<=MAXALIAS         /* ROOM IN OPARRAY               */ 03092000
*       THEN                                                       0754 03093000
         LR    @05,CHARINDX                                        0754 03094000
         SLR   @05,OPSTART                                         0754 03095000
         LTR   @05,@05                                             0754 03096000
         BNP   @RF00754                                            0754 03097000
         CH    @05,@CH00110                                        0754 03098000
         BH    @RF00754                                            0754 03099000
         CH    OPINDX,@CH00186                                     0754 03100000
         BH    @RF00754                                            0754 03101000
*       DO;                                                        0755 03102000
*         OPARRAY(OPINDX)=STMT(OPSTART:CHARINDX-1);                0756 03103000
         LR    @15,OPINDX                                          0756 03104000
         SLA   @15,3                                               0756 03105000
         LA    @14,OPARRAY-8(@15)                                  0756 03106000
         MVI   1(@14),C' '                                         0756 03107000
         MVC   2(6,@14),1(@14)                                     0756 03108000
         BCTR  @05,0                                               0756 03109000
         L     @01,IOPPTR                                          0756 03110000
         L     @01,IOPBUFAD(,@01)                                  0756 03111000
         ALR   @01,OPSTART                                         0756 03112000
         BCTR  @01,0                                               0756 03113000
         EX    @05,@SM02143                                        0756 03114000
*         OPINDX=OPINDX+1;          /* INCREMENT POSITION IN ARRAY   */ 03115000
         AH    OPINDX,@CH00085                                     0757 03116000
*       END;                                                       0758 03117000
*     IF STMT(CHARINDX)=' '         /* STOPPED ON A BLANK            */ 03118000
*       THEN                                                       0759 03119000
@RF00754 L     @01,IOPPTR                                          0759 03120000
         L     @01,IOPBUFAD(,@01)                                  0759 03121000
         ALR   @01,CHARINDX                                        0759 03122000
         BCTR  @01,0                                               0759 03123000
         CLI   STMT(@01),C' '                                      0759 03124000
         BNE   @RF00759                                            0759 03125000
*       CHARINDX=LENGTH(STMT)+1;    /* TERMINATE LOOP                */ 03126000
         LA    CHARINDX,72                                         0760 03127000
*     ELSE                                                         0761 03128000
*       CHARINDX=CHARINDX+1;        /* MOVE OVER COMMA. NEXT OPERAND */ 03129000
         B     @RC00759                                            0761 03130000
@RF00759 AH    CHARINDX,@CH00085                                   0761 03131000
*   END;                                                           0762 03132000
@RC00759 DS    0H                                                  0762 03133000
@DE00746 CH    CHARINDX,@CH01036                                   0762 03134000
         BNH   @DL00746                                            0762 03135000
*   RETURN;                                                        0763 03136000
@EL00019 DS    0H                                                  0763 03137000
@EF00019 DS    0H                                                  0763 03138000
@ER00019 LM    @14,@02,12(@13)                                     0763 03139000
         LM    @04,@12,36(@13)                                     0763 03140000
         BR    @14                                                 0763 03141000
*   END OPERANDS;                                                  0764 03142000
*   END LMALIAS;                                                   0765 03143000
*   END HMASMDLE                                                   0766 03144000
*                                                                  0766 03145000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 03146000
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */ 03147000
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */ 03148000
*/*%INCLUDE SYSLIB  (HMASMICT)                                       */ 03149000
*/*%INCLUDE SYSLIB  (HMASMGTP)                                       */ 03150000
*/*%INCLUDE SYSLIB  (HMASMSET)                                       */ 03151000
*/*%INCLUDE SYSLIB  (HMASMMGP)                                       */ 03152000
*                                                                  0766 03153000
*       ;                                                          0766 03154000
@DATA    DS    0H                                                       03155000
@CH00085 DC    H'1'                                                     03156000
@CH00181 DC    H'2'                                                     03157000
@CH00128 DC    H'5'                                                     03158000
@CH00110 DC    H'8'                                                     03159000
@CH00432 DC    H'9'                                                     03160000
@CH00033 DC    H'10'                                                    03161000
@CH00032 DC    H'12'                                                    03162000
@CH00186 DC    H'16'                                                    03163000
@CH00460 DC    H'25'                                                    03164000
@CH00470 DC    H'30'                                                    03165000
@CH00040 DC    H'31'                                                    03166000
@CH01006 DC    H'54'                                                    03167000
@CH01036 DC    H'71'                                                    03168000
@CH02104 DC    H'116'                                                   03169000
@CH02105 DC    H'144'                                                   03170000
@CH00621 DC    H'255'                                                   03171000
@SC02141 CLC   STMT(0,@05),KEYALIAS                                     03172000
@SM02143 MVC   0(0,@14),STMT(@01)                                       03173000
         DS    0F                                                       03174000
@AL00241 DC    A(SYSMODRC)             LIST WITH   1 ARGUMENT(S)        03175000
@AL00248 EQU   *                       LIST WITH   1 ARGUMENT(S)        03176000
@AL00599 DC    A(BUPPARM)              LIST WITH   1 ARGUMENT(S)        03177000
@AL00259 EQU   *                       LIST WITH   1 ARGUMENT(S)        03178000
@AL00271 DC    A(SYSMCPL)              LIST WITH   1 ARGUMENT(S)        03179000
@AL00273 EQU   *                       LIST WITH   1 ARGUMENT(S)        03180000
@AL00458 EQU   *                       LIST WITH   1 ARGUMENT(S)        03181000
@AL00472 DC    A(HMASMGTP+56)          LIST WITH   1 ARGUMENT(S)        03182000
@AL00350 DC    A(LISTPARM)             LIST WITH   3 ARGUMENT(S)        03183000
@AL00369 EQU   *                       LIST WITH   1 ARGUMENT(S)        03184000
@AL00391 EQU   *                       LIST WITH   1 ARGUMENT(S)        03185000
@AL00395 EQU   *                       LIST WITH   1 ARGUMENT(S)        03186000
@AL00399 EQU   *                       LIST WITH   1 ARGUMENT(S)        03187000
@AL00413 DC    A(HMASMGTP+28)          LIST WITH   1 ARGUMENT(S)        03188000
@AL00359 EQU   *                       LIST WITH   1 ARGUMENT(S)        03189000
@AL00361 EQU   *                       LIST WITH   1 ARGUMENT(S)        03190000
@AL00364 EQU   *                       LIST WITH   1 ARGUMENT(S)        03191000
@AL00367 EQU   *                       LIST WITH   1 ARGUMENT(S)        03192000
@AL00493 DC    A(HMASMGTP)             LIST WITH   1 ARGUMENT(S)        03193000
@AL00404 DC    A(XRF2MOD)              LIST WITH   2 ARGUMENT(S)        03194000
         DC    A(MPTR)                                                  03195000
@AL00470 DC    A(HMASMMGP)             LIST WITH   1 ARGUMENT(S)        03196000
@AL00529 EQU   *                       LIST WITH   3 ARGUMENT(S)        03197000
@AL00543 DC    A(CURNTLMD)             LIST WITH   1 ARGUMENT(S)        03198000
         DC    A(@CH00181+1)                                            03199000
@AL00531 DC    A(LMSYSLIB)             LIST WITH   1 ARGUMENT(S)        03200000
@AL00693 EQU   *                       LIST WITH   1 ARGUMENT(S)        03201000
@AL00695 DC    A(BUFINDX)              LIST WITH   1 ARGUMENT(S)        03202000
         DS    0F                                                       03203000
@SA00001 DS    18F                                                      03204000
@SA00002 DS    15F                                                      03205000
@PC00002 DS    2F                                                       03206000
@SA00003 DS    15F                                                      03207000
@PC00003 DS    2F                                                       03208000
@SA00004 DS    15F                                                      03209000
@PC00004 DS    1F                                                       03210000
@PC00010 DS    2F                                                       03211000
@SA00005 DS    15F                                                      03212000
@PC00005 DS    2F                                                       03213000
@PC00011 DS    2F                                                       03214000
@SA00009 DS    15F                                                      03215000
@PC00009 DS    1F                                                       03216000
@SA00017 DS    15F                                                      03217000
@PC00017 DS    1F                                                       03218000
@PC00014 DS    1F                                                       03219000
@PC00018 DS    1F                                                       03220000
@PC00019 DS    1F                                                       03221000
@SA00008 DS    0F                                                       03222000
@PC00008 EQU   @SA00008+60                                              03223000
@SA00006 DS    0F                                                       03224000
@PC00006 EQU   @SA00006+60                                              03225000
@SA00007 DS    0F                                                       03226000
@PC00007 EQU   @SA00007+60                                              03227000
@SA00013 DS    0F                                                       03228000
@PC00013 EQU   @SA00013+60                                              03229000
@SA00012 DS    0F                                                       03230000
@PC00012 EQU   @SA00012+60                                              03231000
@SA00016 DS    0F                                                       03232000
@PC00016 EQU   @SA00016+60                                              03233000
         DS    19F                                                      03234000
@AL00001 DS    4A                                                       03235000
@TF00001 DS    F                                                        03236000
         DS    0F                                                       03237000
@CF02134 DC    F'-144'                                                  03238000
@CF02135 DC    F'-135'                                                  03239000
@CF02136 DC    F'-133'                                                  03240000
@CF02120 DC    F'-116'                                                  03241000
@CF02118 DC    F'-108'                                                  03242000
@CF02119 DC    F'-103'                                                  03243000
@CF02123 DC    F'-102'                                                  03244000
@CF02125 DC    F'-99'                                                   03245000
@CF02138 DC    F'-54'                                                   03246000
@CF02121 DC    F'-52'                                                   03247000
@CF02137 DC    F'-48'                                                   03248000
@CF02139 DC    F'-46'                                                   03249000
@CF02127 DC    F'-8'                                                    03250000
@CF02122 DC    F'-4'                                                    03251000
@CV01851 DC    V(HMASMBUE)                                              03252000
@CV01852 DC    V(HMASMCPL)                                              03253000
@CV01853 DC    V(HMASMGTA)                                              03254000
@CV01854 DC    V(HMASMIO)                                               03255000
@CV01855 DC    V(HMASMMSG)                                              03256000
@CV01856 DC    V(HMASMSEC)                                              03257000
@CV01857 DC    V(HMASMXRF)                                              03258000
         DS    0D                                                       03259000
IOPPTR   DS    A                                                        03260000
SYSMODRC DS    F                                                        03261000
PPARM    DS    A                                                        03262000
MPTR     DS    A                                                        03263000
LMDRTN   DS    F                                                        03264000
BUFINDX  DS    H                                                        03265000
SRCMACTP DS    FL1                                                      03266000
@CC01867 DC    C'        '                                              03267000
@CC01872 DC    C'SYSPUNCH'                                              03268000
         DS    CL1                                                      03269000
ICTENDCH DC    X'FFFFFFFF'                                              03270000
HMASMSET DS    CL12                                                     03271000
         ORG   HMASMSET                                                 03272000
SELSTENT DS    CL10                                                     03273000
         ORG   SELSTENT                                                 03274000
SELSTFLG DS    BL2                                                      03275000
         ORG   SELSTFLG                                                 03276000
@NM00228 DS    BL1                                                      03277000
SEMCS    EQU   SELSTFLG+0                                               03278000
SESMD    EQU   SELSTFLG+0                                               03279000
SESRC    DS    BL1                                                      03280000
SEDLB    EQU   SELSTFLG+1                                               03281000
SEMOD    EQU   SELSTFLG+1                                               03282000
SEMAC    EQU   SELSTFLG+1                                               03283000
SELMD    EQU   SELSTFLG+1                                               03284000
SEASM    EQU   SELSTFLG+1                                               03285000
SEFMD    EQU   SELSTFLG+1                                               03286000
SESYS    EQU   SELSTFLG+1                                               03287000
         ORG   SELSTENT+2                                               03288000
SENAME   DS    CL8                                                      03289000
         ORG   SENAME                                                   03290000
SESMDNO  DS    CL7                                                      03291000
         ORG   SESMDNO                                                  03292000
SEPTFNO  DS    CL7                                                      03293000
         ORG   SENAME+7                                                 03294000
@NM00229 DS    CL1                                                      03295000
         ORG   HMASMSET+10                                              03296000
SEFLAGS  DS    BL1                                                      03297000
         ORG   SEFLAGS                                                  03298000
SEGROUP  DS    BL1                                                      03299000
SESELECT EQU   SEFLAGS+0                                                03300000
SEEXCLUD EQU   SEFLAGS+0                                                03301000
SENOJCL  EQU   SEFLAGS+0                                                03302000
SEFMID   EQU   SEFLAGS+0                                                03303000
@NM00230 EQU   SEFLAGS+0                                                03304000
SEFOUND  EQU   SEFLAGS+0                                                03305000
         ORG   HMASMSET+11                                              03306000
SEFLAG2  DS    BL1                                                      03307000
         ORG   SEFLAG2                                                  03308000
SEFLAG2A DS    BL1                                                      03309000
SEFLAG2B EQU   SEFLAG2+0                                                03310000
SEFLAG2C EQU   SEFLAG2+0                                                03311000
SEFLAG2D EQU   SEFLAG2+0                                                03312000
SEFLAG2E EQU   SEFLAG2+0                                                03313000
SEFLAG2F EQU   SEFLAG2+0                                                03314000
SEFLAG2G EQU   SEFLAG2+0                                                03315000
SEFLAG2H EQU   SEFLAG2+0                                                03316000
         ORG   HMASMSET+12                                              03317000
XRFRCD   DS    CL30                                                     03318000
         ORG   XRFRCD                                                   03319000
XRFKEY1  DS    CL29                                                     03320000
         ORG   XRFKEY1                                                  03321000
XRFETYPE DS    FL1                                                      03322000
XRFENAME DS    CL8                                                      03323000
XRFRTYPE DS    FL1                                                      03324000
XRFUKEY1 DS    FL1                                                      03325000
@NM00231 DS    CL18                                                     03326000
         ORG   XRFRCD+29                                                03327000
XRFNKEY1 DS    CL1                                                      03328000
         ORG   XRFNKEY1                                                 03329000
XRFFLAG1 DS    BL1                                                      03330000
         ORG   XRFFLAG1                                                 03331000
XRFFLGA  DS    BL1                                                      03332000
XRFFLGB  EQU   XRFFLAG1+0                                               03333000
XRFFLGC  EQU   XRFFLAG1+0                                               03334000
XRFFLGD  EQU   XRFFLAG1+0                                               03335000
XRFFLGE  EQU   XRFFLAG1+0                                               03336000
XRFFLGF  EQU   XRFFLAG1+0                                               03337000
XRFFLGG  EQU   XRFFLAG1+0                                               03338000
XRFFLGH  EQU   XRFFLAG1+0                                               03339000
         ORG   XRFRCD+30                                                03340000
LISTPARM DS    CL19                                                     03341000
         ORG   LISTPARM                                                 03342000
LISTPRM1 DS    BL2                                                      03343000
         ORG   LISTPRM1                                                 03344000
LISTALL1 DS    BL1                                                      03345000
LISTCDS  EQU   LISTPRM1+0                                               03346000
LISTACDS EQU   LISTPRM1+0                                               03347000
LISTSCDS EQU   LISTPRM1+0                                               03348000
LISTCRQ  EQU   LISTPRM1+0                                               03349000
LISTACRQ EQU   LISTPRM1+0                                               03350000
LISTPTS  EQU   LISTPRM1+0                                               03351000
@NM00252 EQU   LISTPRM1+0                                               03352000
LISTLOG  EQU   LISTPRM1+1                                               03353000
@NM00253 EQU   LISTPRM1+1                                               03354000
         ORG   LISTPARM+2                                               03355000
LISTPRM2 DS    BL2                                                      03356000
         ORG   LISTPRM2                                                 03357000
LISTALL2 DS    BL1                                                      03358000
LISTASM  EQU   LISTPRM2+0                                               03359000
LISTLMD  EQU   LISTPRM2+0                                               03360000
LISTMAC  EQU   LISTPRM2+0                                               03361000
LISTMOD  EQU   LISTPRM2+0                                               03362000
LISTSRC  EQU   LISTPRM2+0                                               03363000
LISTDLB  EQU   LISTPRM2+0                                               03364000
LISTSYS  EQU   LISTPRM2+0                                               03365000
LISTSMD  DS    BL1                                                      03366000
LISTFMD  EQU   LISTPRM2+1                                               03367000
LISTMCS  EQU   LISTPRM2+1                                               03368000
@NM00254 EQU   LISTPRM2+1                                               03369000
         ORG   LISTPARM+4                                               03370000
LISTPRM3 DS    BL2                                                      03371000
         ORG   LISTPRM3                                                 03372000
LISTALL3 DS    BL1                                                      03373000
LISTNOAP EQU   LISTPRM3+0                                               03374000
LISTNOAC EQU   LISTPRM3+0                                               03375000
LISTRES  EQU   LISTPRM3+0                                               03376000
LISTFUNC EQU   LISTPRM3+0                                               03377000
LISTPTF  EQU   LISTPRM3+0                                               03378000
LISTAPAR EQU   LISTPRM3+0                                               03379000
LISTUSER EQU   LISTPRM3+0                                               03380000
LISTSUP  DS    BL1                                                      03381000
LISTNSUP EQU   LISTPRM3+1                                               03382000
LISTDEL  EQU   LISTPRM3+1                                               03383000
LISTBYP  EQU   LISTPRM3+1                                               03384000
LISTERR  EQU   LISTPRM3+1                                               03385000
@NM00255 EQU   LISTPRM3+1                                               03386000
         ORG   LISTPARM+6                                               03387000
LISTPRM4 DS    BL1                                                      03388000
         ORG   LISTPRM4                                                 03389000
LISTSEL  DS    BL1                                                      03390000
LISTXREF EQU   LISTPRM4+0                                               03391000
@NM00256 EQU   LISTPRM4+0                                               03392000
         ORG   LISTPARM+7                                               03393000
LISTDATE DS    CL12                                                     03394000
         ORG   LISTDATE                                                 03395000
LISTBDAT DS    CL6                                                      03396000
         ORG   LISTBDAT                                                 03397000
LISTBMM  DS    CL2                                                      03398000
LISTBDD  DS    CL2                                                      03399000
LISTBYY  DS    CL2                                                      03400000
         ORG   LISTDATE+6                                               03401000
LISTEDAT DS    CL6                                                      03402000
         ORG   LISTEDAT                                                 03403000
LISTEMM  DS    CL2                                                      03404000
LISTEDD  DS    CL2                                                      03405000
LISTEYY  DS    CL2                                                      03406000
         ORG   LISTPARM+19                                              03407000
         DS    CL3                                                      03408000
BUPPARM  DS    CL20                                                     03409000
         ORG   BUPPARM                                                  03410000
BUPFUNCT DS    FL1                                                      03411000
BUPTYPE  DS    FL1                                                      03412000
BUPSTYPE DS    FL1                                                      03413000
BUPFLAGS DS    BL1                                                      03414000
         ORG   BUPFLAGS                                                 03415000
BUPREDO  DS    BL1                                                      03416000
@NM00257 EQU   BUPFLAGS+0                                               03417000
         ORG   BUPPARM+4                                                03418000
BUPSYSMD DS    CL7                                                      03419000
@NM00258 DS    CL1                                                      03420000
BUPIOPAD DS    AL4                                                      03421000
BUPGTPAD DS    AL4                                                      03422000
         ORG   BUPPARM+20                                               03423000
HMASMMGP DS    CL24                                                     03424000
         ORG   HMASMMGP                                                 03425000
MGPFIXED DS    CL12                                                     03426000
         ORG   MGPFIXED                                                 03427000
MGPCLEAR DS    CL6                                                      03428000
         ORG   MGPCLEAR                                                 03429000
MGPMGNO1 DS    FL2                                                      03430000
MGPMGNO2 DS    FL2                                                      03431000
MGPMGNO3 DS    FL2                                                      03432000
         ORG   MGPFIXED+6                                               03433000
MGPFLAGS DS    BL2                                                      03434000
         ORG   MGPFLAGS                                                 03435000
MGPPRINT DS    BL1                                                      03436000
MGPLIST  EQU   MGPFLAGS+0                                               03437000
MGPRPT   EQU   MGPFLAGS+0                                               03438000
MGPHLDS  EQU   MGPFLAGS+0                                               03439000
MGPWTOR  EQU   MGPFLAGS+0                                               03440000
MGPWTO   EQU   MGPFLAGS+0                                               03441000
MGPWTP   EQU   MGPFLAGS+0                                               03442000
@NM00259 EQU   MGPFLAGS+0                                               03443000
         ORG   MGPFIXED+8                                               03444000
MGPTYPE  DS    FL1                                                      03445000
@NM00260 DS    CL3                                                      03446000
         ORG   HMASMMGP+12                                              03447000
MGPVAR   DS    CL12                                                     03448000
         ORG   MGPVAR                                                   03449000
MGPVARPT DS    3A                                                       03450000
         ORG   HMASMMGP+24                                              03451000
ZERODDN  DC    X'0000000000000000'                                      03452000
TARGETDD DS    CL8                                                      03453000
SYSMCPL  DS    CL1                                                      03454000
         DS    CL3                                                      03455000
@NM00261 DS    CL5                                                      03456000
         ORG   @NM00261                                                 03457000
CPTF     DS    AL4                                                      03458000
DLEFLAGS DS    BL1                                                      03459000
         ORG   DLEFLAGS                                                 03460000
SBKUPD   DS    BL1                                                      03461000
PTFENT   EQU   DLEFLAGS+0                                               03462000
@NM00262 EQU   DLEFLAGS+0                                               03463000
         ORG   @NM00261+5                                               03464000
@NM00263 DS    CL9                                                      03465000
         ORG   @NM00263                                                 03466000
CURNTLMD DS    CL8                                                      03467000
DLLMFLGS DS    BL1                                                      03468000
         ORG   DLLMFLGS                                                 03469000
ALLMODS  DS    BL1                                                      03470000
ALLIDEL  EQU   DLLMFLGS+0                                               03471000
LMDENTRY EQU   DLLMFLGS+0                                               03472000
LMBKUP   EQU   DLLMFLGS+0                                               03473000
@NM00264 EQU   DLLMFLGS+0                                               03474000
         ORG   @NM00263+9                                               03475000
TSTRCRD  DS    CL16                                                     03476000
         ORG   TSTRCRD                                                  03477000
TSTMEMNM DS    CL8                                                      03478000
TSTDDNAM DS    CL8                                                      03479000
         ORG   TSTRCRD+16                                               03480000
LOCIOP   DS    CL68                                                     03481000
LMSYSLIB DS    CL8                                                      03482000
LMDFLGS  DS    BL1                                                      03483000
         ORG   LMDFLGS                                                  03484000
LMDEOF   DS    BL1                                                      03485000
STMTCONT EQU   LMDFLGS+0                                                03486000
@NM00265 EQU   LMDFLGS+0                                                03487000
         ORG   LMDFLGS+1                                                03488000
STMTTYPE DS    CL1                                                      03489000
KEYALIAS DC    CL5'ALIAS'                                               03490000
         DS    CL3                                                      03491000
HMASMGTP DS    CL28                                                     03492000
         ORG   HMASMGTP+0                                               03493000
GTPFUNCT DS    FL1                                                      03494000
GTPRETRN DS    FL1                                                      03495000
@NM00225 DS    CL2                                                      03496000
GTPRCDLN DS    FL2                                                      03497000
GTPKEYLN DS    FL2                                                      03498000
GTPWKAD  DS    AL4                                                      03499000
GTPBUFAD DS    AL4                                                      03500000
GTPRESTR DS    CL10                                                     03501000
         ORG   GTPRESTR+0                                               03502000
GTPPAG   DS    AL4                                                      03503000
GTPRCD   DS    AL4                                                      03504000
GTPPOS   DS    FL2                                                      03505000
         ORG   HMASMGTP+26                                              03506000
GTPFLGS1 DS    BL1                                                      03507000
         ORG   GTPFLGS1+0                                               03508000
GTPNOSPM DS    BL1                                                      03509000
GTPRCDNF EQU   GTPFLGS1+0                                               03510000
@NM00226 EQU   GTPFLGS1+0                                               03511000
GTPPSIZE EQU   GTPFLGS1+0                                               03512000
         ORG   HMASMGTP+27                                              03513000
@NM00227 DS    FL1                                                      03514000
         ORG   HMASMGTP+84                                              03515000
OPARRAY  DS    16CL8                                                    03516000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       03517000
@01      EQU   01                                                       03518000
@02      EQU   02                                                       03519000
@03      EQU   03                                                       03520000
@04      EQU   04                                                       03521000
@05      EQU   05                                                       03522000
@06      EQU   06                                                       03523000
@07      EQU   07                                                       03524000
@08      EQU   08                                                       03525000
@09      EQU   09                                                       03526000
@10      EQU   10                                                       03527000
@11      EQU   11                                                       03528000
@12      EQU   12                                                       03529000
@13      EQU   13                                                       03530000
@14      EQU   14                                                       03531000
@15      EQU   15                                                       03532000
CHARINDX EQU   @02                                                      03533000
OPSTART  EQU   @04                                                      03534000
KEYL     EQU   @04                                                      03535000
STE      EQU   @03                                                      03536000
ST       EQU   @02                                                      03537000
OPINDX   EQU   @03                                                      03538000
MDLINX   EQU   @02                                                      03539000
LN       EQU   @02                                                      03540000
JJ       EQU   @02                                                      03541000
NN       EQU   @02                                                      03542000
LM       EQU   @02                                                      03543000
LL       EQU   @02                                                      03544000
KK       EQU   @02                                                      03545000
MM       EQU   @02                                                      03546000
K        EQU   @03                                                      03547000
J        EQU   @02                                                      03548000
I        EQU   @02                                                      03549000
LOCALIOP EQU   @04                                                      03550000
HIGHDLE  EQU   @05                                                      03551000
CCAPTR   EQU   @11                                                      03552000
REG15    EQU   @15                                                      03553000
RTNCODE  EQU   @15                                                      03554000
RTNREG   EQU   @14                                                      03555000
HMASMCCA EQU   0                                                        03556000
CCAFBUFR EQU   HMASMCCA+4                                               03557000
CCADSAD  EQU   CCAFBUFR+124                                             03558000
CCATPAD  EQU   CCAFBUFR+128                                             03559000
CCAFLAG7 EQU   CCAFBUFR+132                                             03560000
CCAFIOP  EQU   HMASMCCA+140                                             03561000
CCAIOPTR EQU   CCAFIOP                                                  03562000
CCAFSYS  EQU   HMASMCCA+148                                             03563000
CCASREL  EQU   CCAFSYS+12                                               03564000
CCAFLAGA EQU   CCAFSYS+21                                               03565000
CCAFSTA  EQU   HMASMCCA+188                                             03566000
CCAFICT  EQU   HMASMCCA+192                                             03567000
CCAICT   EQU   CCAFICT                                                  03568000
CCAICPTF EQU   CCAFICT+4                                                03569000
CCAICMOD EQU   CCAFICT+8                                                03570000
CCAICLMD EQU   CCAFICT+12                                               03571000
CCAFPGM  EQU   HMASMCCA+208                                             03572000
CCABLDLP EQU   CCAFPGM                                                  03573000
CCADBLDL EQU   CCAFPGM+4                                                03574000
CCAFGTP  EQU   HMASMCCA+224                                             03575000
CCASEGTP EQU   CCAFGTP                                                  03576000
@NM00009 EQU   HMASMCCA+244                                             03577000
CCAFFUNC EQU   HMASMCCA+264                                             03578000
CCAFLAG1 EQU   CCAFFUNC+8                                               03579000
CCAAPPLY EQU   CCAFLAG1                                                 03580000
CCAACCPT EQU   CCAFLAG1                                                 03581000
CCARES   EQU   CCAFLAG1                                                 03582000
CCAFLAG2 EQU   CCAFFUNC+11                                              03583000
CCAFPROC EQU   HMASMCCA+276                                             03584000
CCAFLAG3 EQU   CCAFPROC                                                 03585000
CCAFDIS  EQU   HMASMCCA+278                                             03586000
CCAFLAG4 EQU   CCAFDIS                                                  03587000
CCAFLAG5 EQU   CCAFDIS+1                                                03588000
CCAFLAG6 EQU   CCAFDIS+2                                                03589000
CCAFCNV  EQU   HMASMCCA+281                                             03590000
CCAFLAG8 EQU   CCAFCNV                                                  03591000
CCAFCTL  EQU   HMASMCCA+282                                             03592000
CCAFLAG9 EQU   CCAFCTL                                                  03593000
CCAFDSNG EQU   HMASMCCA+298                                             03594000
CCAFLAGB EQU   CCAFDSNG                                                 03595000
CCATYPEA EQU   0                                                        03596000
CCABLDLA EQU   0                                                        03597000
@NM00025 EQU   CCABLDLA                                                 03598000
CCABLDLL EQU   0                                                        03599000
@NM00027 EQU   CCABLDLL                                                 03600000
CCALKDRC EQU   @NM00027+20                                              03601000
@NM00029 EQU   CCABLDLL+124                                             03602000
CCAASMRC EQU   @NM00029+20                                              03603000
@NM00031 EQU   CCABLDLL+248                                             03604000
CCACPYRC EQU   @NM00031+20                                              03605000
@NM00033 EQU   CCABLDLL+372                                             03606000
CCACOMRC EQU   @NM00033+20                                              03607000
@NM00035 EQU   CCABLDLL+496                                             03608000
CCAZAPRC EQU   @NM00035+20                                              03609000
@NM00037 EQU   CCABLDLL+620                                             03610000
CCASUPRC EQU   @NM00037+20                                              03611000
@NM00039 EQU   CCABLDLL+744                                             03612000
CCAUPDRC EQU   @NM00039+20                                              03613000
CCABLDLM EQU   0                                                        03614000
CCABELMT EQU   CCABLDLM+4                                               03615000
CCABMPOS EQU   CCABELMT                                                 03616000
HMASMIOP EQU   0                                                        03617000
IOPDSID  EQU   HMASMIOP                                                 03618000
IOPFUNCT EQU   HMASMIOP+1                                               03619000
IOPRETRN EQU   HMASMIOP+2                                               03620000
IOPTYPE  EQU   HMASMIOP+3                                               03621000
IOPNAME  EQU   HMASMIOP+4                                               03622000
@NM00043 EQU   HMASMIOP+12                                              03623000
@NM00044 EQU   @NM00043                                                 03624000
IOPDDNAM EQU   HMASMIOP+24                                              03625000
IOPDELDD EQU   IOPDDNAM                                                 03626000
IOPBUFAD EQU   HMASMIOP+52                                              03627000
IOPDRMAP EQU   HMASMIOP+56                                              03628000
IOPINAME EQU   IOPDRMAP                                                 03629000
IOPINAM  EQU   IOPINAME                                                 03630000
IOPITYP  EQU   IOPINAM                                                  03631000
IOPUSERL EQU   IOPDRMAP+11                                              03632000
IOPEND   EQU   IOPDRMAP+12                                              03633000
IOPLMCTL EQU   0                                                        03634000
IOPQSMIF EQU   0                                                        03635000
@NM00154 EQU   IOPQSMIF                                                 03636000
IOPQSMLS EQU   IOPQSMIF+8                                               03637000
IOPQSMNM EQU   IOPQSMLS                                                 03638000
IOPBS02  EQU   0                                                        03639000
IOPBS04  EQU   0                                                        03640000
IOPBAPF  EQU   IOPBS04                                                  03641000
HMASMICT EQU   0                                                        03642000
ICTCORE  EQU   HMASMICT                                                 03643000
ICTPSPLN EQU   ICTCORE                                                  03644000
ICTMSPLN EQU   ICTCORE+4                                                03645000
ICTLSPLN EQU   ICTCORE+8                                                03646000
ICTGMSPL EQU   0                                                        03647000
ICTPTF   EQU   0                                                        03648000
ICTPTFS  EQU   ICTPTF                                                   03649000
ICTPEND  EQU   ICTPTFS                                                  03650000
ICTPFLG1 EQU   ICTPTF+7                                                 03651000
ICTPFLG3 EQU   ICTPTF+8                                                 03652000
ICTPPROC EQU   ICTPFLG3                                                 03653000
ICTPNOGO EQU   ICTPFLG3                                                 03654000
ICTPFLG5 EQU   ICTPTF+9                                                 03655000
ICTPMDLP EQU   ICTPFLG5+1                                               03656000
ICTPFLG6 EQU   ICTPTF+11                                                03657000
ICTPFLF  EQU   ICTPFLG6                                                 03658000
ICTPFLG2 EQU   ICTPTF+12                                                03659000
ICTPFLG4 EQU   ICTPTF+13                                                03660000
ICTPDEXP EQU   ICTPFLG4                                                 03661000
ICTPDIMP EQU   ICTPFLG4                                                 03662000
ICTPGELM EQU   ICTPFLG4                                                 03663000
ICTPFLG8 EQU   ICTPTF+14                                                03664000
ICTPDCPL EQU   ICTPFLG8                                                 03665000
ICTPFLG9 EQU   ICTPTF+15                                                03666000
@NM00181 EQU   ICTPFLG9                                                 03667000
ICTPFLGA EQU   ICTPTF+16                                                03668000
ICTPUSR1 EQU   ICTPFLGA                                                 03669000
ICTPTYPE EQU   ICTPTF+17                                                03670000
ICTPCHN  EQU   ICTPTF+64                                                03671000
ICTPRCHN EQU   ICTPTF+68                                                03672000
ICTPSCHN EQU   ICTPTF+72                                                03673000
ICTPPCHN EQU   ICTPTF+76                                                03674000
ICTPICHN EQU   ICTPTF+80                                                03675000
ICTPNCHN EQU   ICTPTF+84                                                03676000
ICTPVCHN EQU   ICTPTF+88                                                03677000
ICTPDCHN EQU   ICTPTF+92                                                03678000
ICTPBCHN EQU   ICTPTF+96                                                03679000
ICTIXPF  EQU   0                                                        03680000
ICTIXP   EQU   ICTIXPF                                                  03681000
ICTENTLS EQU   0                                                        03682000
ICTENTNT EQU   ICTENTLS                                                 03683000
ICTENTNM EQU   ICTENTNT                                                 03684000
ICTENTST EQU   ICTENTNT+7                                               03685000
ICTREQLS EQU   0                                                        03686000
ICTREQNT EQU   ICTREQLS                                                 03687000
ICTREQNM EQU   ICTREQNT                                                 03688000
ICTREQST EQU   ICTREQNT+7                                               03689000
ICTSUPLS EQU   0                                                        03690000
ICTSUPNT EQU   ICTSUPLS                                                 03691000
ICTSUPNM EQU   ICTSUPNT                                                 03692000
ICTPRELS EQU   0                                                        03693000
ICTPRENT EQU   ICTPRELS                                                 03694000
ICTPRENM EQU   ICTPRENT                                                 03695000
ICTPREST EQU   ICTPRENT+7                                               03696000
ICTIRQLS EQU   0                                                        03697000
ICTIRQNT EQU   ICTIRQLS                                                 03698000
ICTIRQNM EQU   ICTIRQNT                                                 03699000
ICTIRQST EQU   ICTIRQNT+7                                               03700000
ICTCSRST EQU   ICTIRQNT+15                                              03701000
ICTNPRLS EQU   0                                                        03702000
ICTNPRNT EQU   ICTNPRLS                                                 03703000
ICTNPRNM EQU   ICTNPRNT                                                 03704000
ICTVRSLS EQU   0                                                        03705000
ICTVRSNT EQU   ICTVRSLS                                                 03706000
ICTVRSNM EQU   ICTVRSNT                                                 03707000
ICTDELLS EQU   0                                                        03708000
ICTDELNT EQU   ICTDELLS                                                 03709000
ICTDELNM EQU   ICTDELNT                                                 03710000
ICTDELST EQU   ICTDELNT+7                                               03711000
ICTSBYLS EQU   0                                                        03712000
ICTSBYNT EQU   ICTSBYLS                                                 03713000
ICTSBYNM EQU   ICTSBYNT                                                 03714000
ICTMOD   EQU   0                                                        03715000
ICTMNAME EQU   ICTMOD                                                   03716000
ICTMEND  EQU   ICTMNAME                                                 03717000
ICTMFLG2 EQU   ICTMOD+8                                                 03718000
ICTMPROC EQU   ICTMFLG2                                                 03719000
ICTMFLG1 EQU   ICTMOD+9                                                 03720000
ICTMMODR EQU   ICTMFLG1                                                 03721000
ICTMMOD  EQU   ICTMMODR                                                 03722000
ICTMMACR EQU   ICTMFLG1                                                 03723000
ICTMSRCR EQU   ICTMFLG1                                                 03724000
ICTMFLG3 EQU   ICTMOD+10                                                03725000
ICTMFLG4 EQU   ICTMOD+11                                                03726000
ICTMISEL EQU   ICTMFLG4                                                 03727000
ICTMIDEL EQU   ICTMFLG4                                                 03728000
ICTMSELM EQU   ICTMFLG4                                                 03729000
ICTMTSEL EQU   ICTMFLG4                                                 03730000
ICTMFLG5 EQU   ICTMOD+12                                                03731000
ICTMODF4 EQU   ICTMOD+13                                                03732000
ICTMLEP1 EQU   ICTMODF4                                                 03733000
ICTMODF5 EQU   ICTMOD+14                                                03734000
ICTMLEP2 EQU   ICTMODF5                                                 03735000
ICTMODF6 EQU   ICTMOD+15                                                03736000
ICTMLEP3 EQU   ICTMODF6                                                 03737000
ICTMODF7 EQU   ICTMOD+16                                                03738000
ICTMLEP4 EQU   ICTMODF7                                                 03739000
ICTMACF4 EQU   ICTMOD+17                                                03740000
ICTTOLIB EQU   ICTMOD+32                                                03741000
ICTMDSTL EQU   ICTMOD+48                                                03742000
ICTPPTR  EQU   ICTMOD+96                                                03743000
ICTMCHN  EQU   ICTMOD+100                                               03744000
ICTMICHN EQU   ICTMOD+104                                               03745000
ICTMACHN EQU   ICTMOD+112                                               03746000
ICTMTCHN EQU   ICTMOD+116                                               03747000
ICTMVCHN EQU   ICTMOD+120                                               03748000
ICTMUCHN EQU   ICTMOD+124                                               03749000
ICTIXMF  EQU   0                                                        03750000
ICTMIDLS EQU   0                                                        03751000
ICTMID   EQU   ICTMIDLS                                                 03752000
ICTMODID EQU   ICTMID                                                   03753000
ICTMODST EQU   ICTMID+7                                                 03754000
ICTASMLS EQU   0                                                        03755000
ICTASMAD EQU   ICTASMLS                                                 03756000
ICTTALLS EQU   0                                                        03757000
ICTTALNM EQU   ICTTALLS                                                 03758000
ICTTALND EQU   ICTTALNM                                                 03759000
ICTMVRLS EQU   0                                                        03760000
ICTMVRNT EQU   ICTMVRLS                                                 03761000
ICTMVRNM EQU   ICTMVRNT                                                 03762000
ICTMUMLS EQU   0                                                        03763000
ICTMUMNT EQU   ICTMUMLS                                                 03764000
ICTMUMNM EQU   ICTMUMNT                                                 03765000
ICTLMOD  EQU   0                                                        03766000
ICTLMNAM EQU   ICTLMOD                                                  03767000
ICTLNAME EQU   ICTLMNAM                                                 03768000
ICTLEND  EQU   ICTLNAME                                                 03769000
ICTLFLG4 EQU   ICTLMOD+8                                                03770000
ICTLPROC EQU   ICTLFLG4                                                 03771000
ICTLFLG1 EQU   ICTLMOD+9                                                03772000
ICTLFLG5 EQU   ICTLMOD+10                                               03773000
ICTLFLG6 EQU   ICTLMOD+11                                               03774000
ICTLFLG7 EQU   ICTLMOD+12                                               03775000
ICTLFLG2 EQU   ICTLMOD+13                                               03776000
ICTLFLG3 EQU   ICTLMOD+14                                               03777000
ICTLCHN  EQU   ICTLMOD+34                                               03778000
ICTIXLF  EQU   0                                                        03779000
STMTBUF  EQU   0                                                        03780000
STMT     EQU   STMTBUF                                                  03781000
STMT72   EQU   STMTBUF+71                                               03782000
CCADSIDA EQU   0                                                        03783000
IOPBS01  EQU   0                                                        03784000
IOPBS03  EQU   0                                                        03785000
SRCMACE  EQU   0                                                        03786000
SRCMACRC EQU   0                                                        03787000
MODICTE  EQU   0                                                        03788000
MODRC    EQU   0                                                        03789000
DELLMRC  EQU   0                                                        03790000
LMDNAME  EQU   0                                                        03791000
DELLMRC1 EQU   0                                                        03792000
MLENTRY  EQU   0                                                        03793000
DELENTRC EQU   0                                                        03794000
MEMBRNAM EQU   0                                                        03795000
MEMBRTP  EQU   0                                                        03796000
DDNAME   EQU   0                                                        03797000
DELMEMRC EQU   0                                                        03798000
LMXRFRC  EQU   0                                                        03799000
LMDDRC   EQU   0                                                        03800000
SMDNAME  EQU   0                                                        03801000
SMDPTR   EQU   0                                                        03802000
SMODNAME EQU   0                                                        03803000
SMODPTR  EQU   0                                                        03804000
CDSMICTE EQU   0                                                        03805000
CDSELRC  EQU   0                                                        03806000
BKUPRC   EQU   0                                                        03807000
DLMNAME  EQU   0                                                        03808000
PTFICT   EQU   0                                                        03809000
PTFENTRC EQU   0                                                        03810000
LMDDN    EQU   0                                                        03811000
STEND    EQU   0                                                        03812000
STRTINDX EQU   0                                                        03813000
IOPUDATA EQU   IOPEND                                                   03814000
IOPINAM3 EQU   IOPINAME                                                 03815000
@NM00050 EQU   IOPINAM3                                                 03816000
IOPSTCMP EQU   IOPUDATA                                                 03817000
IOPDYNDT EQU   IOPUDATA                                                 03818000
IOPSPACE EQU   IOPDYNDT+44                                              03819000
IOPDTYPE EQU   IOPDYNDT+50                                              03820000
IOPNTMAX EQU   IOPDRMAP                                                 03821000
IOPNTMAP EQU   IOPDRMAP                                                 03822000
IOPCDMAP EQU   IOPNTMAP                                                 03823000
IOPPTMAP EQU   IOPCDMAP                                                 03824000
IOPSCMAP EQU   IOPPTMAP                                                 03825000
IOPDIRCT EQU   IOPSCMAP+12                                              03826000
IOPCDMAX EQU   IOPDIRCT                                                 03827000
IOPCQMAP EQU   IOPDRMAP                                                 03828000
@NM00061 EQU   IOPUDATA                                                 03829000
@NM00062 EQU   IOPUDATA                                                 03830000
IOPASMNT EQU   IOPUDATA                                                 03831000
IOPASMDR EQU   IOPASMNT                                                 03832000
IOPABUNT EQU   IOPASMDR+1                                               03833000
IOPLMDNT EQU   IOPUDATA                                                 03834000
IOPLMDDR EQU   IOPLMDNT                                                 03835000
IOPLMLEP EQU   IOPLMDDR+1                                               03836000
IOPLMDF1 EQU   IOPLMLEP                                                 03837000
IOPFLGS2 EQU   IOPLMDF1                                                 03838000
IOPLMDF2 EQU   IOPLMLEP+1                                               03839000
IOPLMDF3 EQU   IOPLMLEP+2                                               03840000
IOPLMDF4 EQU   IOPLMLEP+3                                               03841000
IOPLMDF5 EQU   IOPLMDDR+5                                               03842000
IOPFLGS3 EQU   IOPLMDF5                                                 03843000
IOPLMDFX EQU   IOPLMDNT+24                                              03844000
@NM00071 EQU   IOPLMDFX                                                 03845000
IOPLNTRY EQU   IOPLMDFX+8                                               03846000
IOPLSYS  EQU   IOPLNTRY                                                 03847000
IOPSYSLB EQU   IOPLSYS                                                  03848000
IOPLMDND EQU   IOPSYSLB                                                 03849000
IOPLMIND EQU   IOPLNTRY+8                                               03850000
IOPMACNT EQU   IOPUDATA                                                 03851000
IOPMACDR EQU   IOPMACNT                                                 03852000
IOPRMIDE EQU   IOPMACDR+1                                               03853000
IOPRMST  EQU   IOPRMIDE+7                                               03854000
IOPFMIDE EQU   IOPMACDR+9                                               03855000
IOPMACFX EQU   IOPMACNT+24                                              03856000
IOPBUNT  EQU   IOPMACFX                                                 03857000
IOPBUSMD EQU   IOPBUNT                                                  03858000
IOPBUTYP EQU   IOPBUNT+7                                                03859000
IOPMCEND EQU   IOPMACNT+104                                             03860000
IOPMACVR EQU   IOPMCEND                                                 03861000
IOPMCENT EQU   IOPMACVR                                                 03862000
IOPMCDTA EQU   IOPMCENT                                                 03863000
IOPMCASM EQU   IOPMCDTA                                                 03864000
IOPMACID EQU   IOPMCASM                                                 03865000
IOPMACST EQU   IOPMCASM+7                                               03866000
IOPMCIND EQU   IOPMCENT+8                                               03867000
IOPEOFNT EQU   IOPUDATA                                                 03868000
IOPSRCNT EQU   IOPUDATA                                                 03869000
IOPSRCDR EQU   IOPSRCNT                                                 03870000
@NM00082 EQU   IOPSRCDR+1                                               03871000
@NM00084 EQU   @NM00082+7                                               03872000
@NM00088 EQU   IOPSRCDR+9                                               03873000
IOPSRCFX EQU   IOPSRCNT+24                                              03874000
@NM00092 EQU   IOPSRCFX                                                 03875000
IOPSREND EQU   IOPSRCNT+104                                             03876000
IOPSRCVR EQU   IOPSREND                                                 03877000
IOPSNTRY EQU   IOPSRCVR                                                 03878000
IOPSRDTA EQU   IOPSNTRY                                                 03879000
IOPSRCID EQU   IOPSRDTA                                                 03880000
IOPSRCST EQU   IOPSRDTA+7                                               03881000
IOPMODNT EQU   IOPUDATA                                                 03882000
IOPMODDR EQU   IOPMODNT                                                 03883000
@NM00098 EQU   IOPMODDR+1                                               03884000
@NM00100 EQU   @NM00098+7                                               03885000
@NM00104 EQU   IOPMODDR+9                                               03886000
IOPMODFX EQU   IOPMODNT+24                                              03887000
@NM00108 EQU   IOPMODFX                                                 03888000
IOPMDLEP EQU   IOPMODFX+8                                               03889000
IOPMODF1 EQU   IOPMDLEP                                                 03890000
IOPMODF2 EQU   IOPMDLEP+1                                               03891000
IOPMODF3 EQU   IOPMDLEP+2                                               03892000
IOPMODF4 EQU   IOPMDLEP+3                                               03893000
IOPMDEND EQU   IOPMODNT+104                                             03894000
IOPMODVR EQU   IOPMDEND                                                 03895000
IOPMNTRY EQU   IOPMODVR                                                 03896000
IOPMDDTA EQU   IOPMNTRY                                                 03897000
IOPLMODS EQU   IOPMDDTA                                                 03898000
IOPMODID EQU   IOPLMODS                                                 03899000
IOPMODND EQU   IOPMODID                                                 03900000
IOPMODST EQU   IOPLMODS+7                                               03901000
IOPMDIND EQU   IOPMNTRY+8                                               03902000
IOPDLBNT EQU   IOPUDATA                                                 03903000
IOPDLBDR EQU   IOPDLBNT                                                 03904000
IOPDLBFX EQU   IOPDLBNT+24                                              03905000
@NM00119 EQU   IOPDLBFX                                                 03906000
IOPDLEND EQU   IOPDLBNT+104                                             03907000
IOPDLBVR EQU   IOPDLEND                                                 03908000
IOPDNTRY EQU   IOPDLBVR                                                 03909000
IOPDSYS  EQU   IOPDNTRY                                                 03910000
IOPSYSNT EQU   IOPUDATA                                                 03911000
IOPSYSDR EQU   IOPSYSNT                                                 03912000
IOPSYSF1 EQU   IOPSYSDR+4                                               03913000
IOPFLGS7 EQU   IOPSYSF1                                                 03914000
IOPSYSFX EQU   IOPSYSNT+24                                              03915000
@NM00126 EQU   IOPSYSFX                                                 03916000
IOPSYEND EQU   IOPSYSNT+184                                             03917000
IOPSYSVR EQU   IOPSYEND                                                 03918000
IOPSYSTR EQU   IOPSYSVR                                                 03919000
IOPSYNTR EQU   IOPSYSTR                                                 03920000
IOPPTFNT EQU   IOPUDATA                                                 03921000
IOPPTFDR EQU   IOPPTFNT                                                 03922000
IOPPSTAT EQU   IOPPTFDR+2                                               03923000
IOPPTFF1 EQU   IOPPSTAT                                                 03924000
IOPFLGS5 EQU   IOPPTFF1                                                 03925000
IOPPTFF2 EQU   IOPPSTAT+1                                               03926000
IOPPTFF3 EQU   IOPPSTAT+3                                               03927000
IOPPTFFX EQU   IOPPTFNT+24                                              03928000
@NM00135 EQU   IOPPTFFX                                                 03929000
@NM00136 EQU   @NM00135                                                 03930000
IOPPDTES EQU   IOPPTFFX+41                                              03931000
@NM00139 EQU   IOPPDTES                                                 03932000
IOPPTPFX EQU   IOPPDTES+6                                               03933000
IOPDATES EQU   IOPPTPFX                                                 03934000
IOPPTEND EQU   IOPPTFNT+104                                             03935000
IOPPTFVR EQU   IOPPTEND                                                 03936000
IOPPNTRY EQU   IOPPTFVR                                                 03937000
IOPPMODS EQU   IOPPNTRY                                                 03938000
IOPENTNT EQU   IOPUDATA+104                                             03939000
IOPSRLNT EQU   IOPUDATA+104                                             03940000
IOPPRENT EQU   IOPUDATA+104                                             03941000
IOPNPRNT EQU   IOPUDATA+104                                             03942000
IOPSUPNT EQU   IOPUDATA+104                                             03943000
IOPREQNT EQU   IOPUDATA+104                                             03944000
IOPIRQNT EQU   IOPUDATA+104                                             03945000
IOPFIDNT EQU   IOPUDATA+104                                             03946000
IOPDELNT EQU   IOPUDATA+104                                             03947000
IOPVERNT EQU   IOPUDATA+104                                             03948000
IOPSBYNT EQU   IOPUDATA+104                                             03949000
IOPQSMNT EQU   IOPUDATA                                                 03950000
IOPQSMDR EQU   IOPQSMNT                                                 03951000
IOPQFMNT EQU   IOPUDATA                                                 03952000
IOPQFMDR EQU   IOPQFMNT                                                 03953000
IOPQFEND EQU   IOPQFMNT+2                                               03954000
IOPQFMVR EQU   IOPQFEND                                                 03955000
IOPQFMLS EQU   IOPQFMVR                                                 03956000
IOPQFMNM EQU   IOPQFMLS                                                 03957000
IOPPTSYS EQU   IOPUDATA                                                 03958000
IOPPTSDR EQU   IOPPTSYS                                                 03959000
IOPPTSFX EQU   IOPPTSYS+24                                              03960000
IOPDSSPC EQU   IOPPTSFX                                                 03961000
IOPPTFG1 EQU   IOPPTSFX+34                                              03962000
IOPPSEND EQU   IOPPTSYS+1064                                            03963000
IOPPTSVR EQU   IOPPSEND                                                 03964000
IOPPTNTR EQU   IOPPTSVR                                                 03965000
@NM00164 EQU   IOPPTNTR                                                 03966000
IOPPTFMD EQU   @NM00164                                                 03967000
IOPPTREL EQU   IOPPTFMD                                                 03968000
IOPBPDS  EQU   IOPUDATA                                                 03969000
IOPBLEP1 EQU   IOPBPDS+8                                                03970000
IOPBLEP2 EQU   IOPBPDS+9                                                03971000
@NM00168 EQU   IOPBPDS+18                                               03972000
IOPBFTB0 EQU   @NM00168                                                 03973000
IOPBFTB1 EQU   IOPBFTB0                                                 03974000
ICTENDNT EQU   ICTENDCH                                                 03975000
ICTENDIX EQU   ICTENDCH                                                 03976000
XRFRCD1  EQU   XRFRCD                                                   03977000
XRFRCD2  EQU   XRFRCD                                                   03978000
XRF2LMD  EQU   XRFRCD2+1                                                03979000
XRF2MOD  EQU   XRFRCD2+11                                               03980000
XRFRCD3  EQU   XRFRCD                                                   03981000
XRF3MAC  EQU   XRFRCD3+1                                                03982000
XRF3MOD  EQU   XRF3MAC                                                  03983000
XRF3PF1  EQU   XRFRCD3+24                                               03984000
XRFRCD4  EQU   XRFRCD                                                   03985000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    03986000
@NM00251 EQU   XRFRCD4+28                                               03987000
@NM00250 EQU   XRFRCD4+18                                               03988000
XRFX4PTF EQU   XRFRCD4+11                                               03989000
@NM00249 EQU   XRFRCD4+10                                               03990000
@NM00248 EQU   XRFRCD4+9                                                03991000
XRF4PTF  EQU   XRFRCD4+1                                                03992000
@NM00247 EQU   XRFRCD4                                                  03993000
@NM00246 EQU   XRFRCD3+29                                               03994000
@NM00245 EQU   XRFRCD3+28                                               03995000
XRF3PF3  EQU   XRFRCD3+27                                               03996000
XRF3PIND EQU   XRFRCD3+26                                               03997000
XRF3PTYP EQU   XRFRCD3+25                                               03998000
XRF3STAT EQU   XRF3PF1                                                  03999000
XRF3PTF  EQU   XRFRCD3+17                                               04000000
XRF3TIM  EQU   XRFRCD3+14                                               04001000
XRF3DAT  EQU   XRFRCD3+11                                               04002000
@NM00244 EQU   XRFRCD3+10                                               04003000
@NM00243 EQU   XRFRCD3+9                                                04004000
XRF3SRC  EQU   XRF3MOD                                                  04005000
@NM00242 EQU   XRFRCD3                                                  04006000
@NM00241 EQU   XRFRCD2+29                                               04007000
@NM00240 EQU   XRFRCD2+19                                               04008000
@NM00239 EQU   XRFRCD2+10                                               04009000
@NM00238 EQU   XRFRCD2+9                                                04010000
@NM00237 EQU   XRFRCD2                                                  04011000
@NM00236 EQU   XRFRCD1+29                                               04012000
@NM00235 EQU   XRFRCD1+19                                               04013000
XRF1MAC  EQU   XRFRCD1+11                                               04014000
@NM00234 EQU   XRFRCD1+10                                               04015000
@NM00233 EQU   XRFRCD1+9                                                04016000
XRF1ASM  EQU   XRFRCD1+1                                                04017000
@NM00232 EQU   XRFRCD1                                                  04018000
IOPBCEND EQU   IOPBPDS+21                                               04019000
IOPBFTB3 EQU   IOPBFTB0+2                                               04020000
IOPBFTB2 EQU   IOPBFTB0+1                                               04021000
@NM00170 EQU   IOPBFTB1                                                 04022000
IOPBAPFP EQU   IOPBFTB1                                                 04023000
IOPBSSI  EQU   IOPBFTB1                                                 04024000
IOPBPAGA EQU   IOPBFTB1                                                 04025000
@NM00169 EQU   IOPBFTB1                                                 04026000
IOPBAOSL EQU   IOPBFTB1                                                 04027000
IOPBSEPA EQU   IOPBPDS+15                                               04028000
IOPBFTBL EQU   IOPBPDS+13                                               04029000
IOPBSTOR EQU   IOPBPDS+10                                               04030000
IOPBREFR EQU   IOPBLEP2                                                 04031000
IOPBLEF  EQU   IOPBLEP2                                                 04032000
IOPBTEST EQU   IOPBLEP2                                                 04033000
IOPBNE   EQU   IOPBLEP2                                                 04034000
@NM00167 EQU   IOPBLEP2                                                 04035000
IOPBDC   EQU   IOPBLEP2                                                 04036000
@NM00166 EQU   IOPBLEP1                                                 04037000
IOPBSCTR EQU   IOPBLEP1                                                 04038000
IOPBOL   EQU   IOPBLEP1                                                 04039000
@NM00165 EQU   IOPBLEP1                                                 04040000
IOPBOVLY EQU   IOPBLEP1                                                 04041000
IOPBREUS EQU   IOPBLEP1                                                 04042000
IOPBRENT EQU   IOPBLEP1                                                 04043000
IOPBNL   EQU   IOPBPDS+7                                                04044000
IOPBTTRN EQU   IOPBPDS+4                                                04045000
IOPBZERO EQU   IOPBPDS+3                                                04046000
IOPBTTRT EQU   IOPBPDS                                                  04047000
IOPPTIND EQU   IOPPTNTR+8                                               04048000
IOPPTSND EQU   IOPPTREL                                                 04049000
@NM00163 EQU   IOPPTSFX+872                                             04050000
IOPSYZPP EQU   IOPPTSFX+772                                             04051000
IOPSYZPR EQU   IOPPTSFX+771                                             04052000
IOPSYZPS EQU   IOPPTSFX+763                                             04053000
IOPSYZAP EQU   IOPPTSFX+755                                             04054000
IOPSYUPP EQU   IOPPTSFX+655                                             04055000
IOPSYUPR EQU   IOPPTSFX+654                                             04056000
IOPSYUPS EQU   IOPPTSFX+646                                             04057000
IOPSYUPD EQU   IOPPTSFX+638                                             04058000
IOPSYSPP EQU   IOPPTSFX+538                                             04059000
IOPSYSPR EQU   IOPPTSFX+537                                             04060000
IOPSYSPS EQU   IOPPTSFX+529                                             04061000
IOPSYSUP EQU   IOPPTSFX+521                                             04062000
IOPSYLKP EQU   IOPPTSFX+421                                             04063000
IOPSYLKR EQU   IOPPTSFX+420                                             04064000
IOPSYLKS EQU   IOPPTSFX+412                                             04065000
IOPSYLKD EQU   IOPPTSFX+404                                             04066000
IOPSYCPP EQU   IOPPTSFX+304                                             04067000
IOPSYCPR EQU   IOPPTSFX+303                                             04068000
IOPSYCPS EQU   IOPPTSFX+295                                             04069000
IOPSYCPY EQU   IOPPTSFX+287                                             04070000
IOPSYCOP EQU   IOPPTSFX+187                                             04071000
IOPSYCOR EQU   IOPPTSFX+186                                             04072000
IOPSYCOS EQU   IOPPTSFX+178                                             04073000
IOPSYCOM EQU   IOPPTSFX+170                                             04074000
IOPSYASP EQU   IOPPTSFX+70                                              04075000
IOPSYASR EQU   IOPPTSFX+69                                              04076000
IOPSYASS EQU   IOPPTSFX+61                                              04077000
IOPSYASM EQU   IOPPTSFX+53                                              04078000
@NM00162 EQU   IOPPTSFX+35                                              04079000
@NM00161 EQU   IOPPTFG1                                                 04080000
IOPPTSNJ EQU   IOPPTFG1                                                 04081000
IOPPTSNP EQU   IOPPTFG1                                                 04082000
IOPSYPLN EQU   IOPPTSFX+32                                              04083000
IOPDSPFX EQU   IOPPTSFX+6                                               04084000
IOPDSDIR EQU   IOPDSSPC+4                                               04085000
IOPDSSEC EQU   IOPDSSPC+2                                               04086000
IOPDSPRM EQU   IOPDSSPC                                                 04087000
@NM00160 EQU   IOPPTSDR+4                                               04088000
IOPPTPEM EQU   IOPPTSDR+2                                               04089000
IOPPCNVL EQU   IOPPTSDR+1                                               04090000
@NM00159 EQU   IOPPTSDR                                                 04091000
IOPQFMTP EQU   IOPQFMLS+8                                               04092000
@NM00158 EQU   IOPQFMLS+7                                               04093000
IOPQFMND EQU   IOPQFMNM                                                 04094000
@NM00157 EQU   IOPQFMDR                                                 04095000
@NM00153 EQU   IOPQSMDR                                                 04096000
@NM00152 EQU   IOPSBYNT+8                                               04097000
IOPSBYST EQU   IOPSBYNT+7                                               04098000
IOPSBYNM EQU   IOPSBYNT                                                 04099000
@NM00151 EQU   IOPVERNT+8                                               04100000
IOPVERST EQU   IOPVERNT+7                                               04101000
IOPVERNM EQU   IOPVERNT                                                 04102000
@NM00150 EQU   IOPDELNT+8                                               04103000
IOPDELST EQU   IOPDELNT+7                                               04104000
IOPDELNM EQU   IOPDELNT                                                 04105000
@NM00149 EQU   IOPFIDNT+8                                               04106000
IOPFIDST EQU   IOPFIDNT+7                                               04107000
IOPFIDNM EQU   IOPFIDNT                                                 04108000
@NM00148 EQU   IOPIRQNT+8                                               04109000
IOPIRQST EQU   IOPIRQNT+7                                               04110000
IOPIRQNM EQU   IOPIRQNT                                                 04111000
@NM00147 EQU   IOPREQNT+8                                               04112000
IOPREQST EQU   IOPREQNT+7                                               04113000
IOPREQNM EQU   IOPREQNT                                                 04114000
@NM00146 EQU   IOPSUPNT+8                                               04115000
IOPSUPST EQU   IOPSUPNT+7                                               04116000
IOPSUPNM EQU   IOPSUPNT                                                 04117000
@NM00145 EQU   IOPNPRNT+8                                               04118000
IOPNPRST EQU   IOPNPRNT+7                                               04119000
IOPNPRNM EQU   IOPNPRNT                                                 04120000
@NM00144 EQU   IOPPRENT+8                                               04121000
IOPPREST EQU   IOPPRENT+7                                               04122000
IOPPRENM EQU   IOPPRENT                                                 04123000
@NM00143 EQU   IOPSRLNT+8                                               04124000
IOPSRLST EQU   IOPSRLNT+7                                               04125000
@NM00142 EQU   IOPSRLNT+4                                               04126000
IOPSRLNM EQU   IOPSRLNT                                                 04127000
@NM00141 EQU   IOPENTNT+8                                               04128000
IOPENTST EQU   IOPENTNT+7                                               04129000
IOPENTNM EQU   IOPENTNT                                                 04130000
IOPPIND  EQU   IOPPNTRY+8                                               04131000
IOPPTFND EQU   IOPPMODS                                                 04132000
IOPPFMID EQU   IOPPTFFX+73                                              04133000
@NM00140 EQU   IOPPTPFX+24                                              04134000
IOPUCLT  EQU   IOPDATES+21                                              04135000
IOPUCLD  EQU   IOPDATES+18                                              04136000
IOPACCT  EQU   IOPDATES+15                                              04137000
IOPACCD  EQU   IOPDATES+12                                              04138000
IOPRSTT  EQU   IOPDATES+9                                               04139000
IOPRSTD  EQU   IOPDATES+6                                               04140000
IOPAPPT  EQU   IOPDATES+3                                               04141000
IOPAPPD  EQU   IOPDATES                                                 04142000
IOPRECT  EQU   @NM00139+3                                               04143000
IOPRECD  EQU   @NM00139                                                 04144000
@NM00138 EQU   IOPPTFFX+8                                               04145000
@NM00137 EQU   @NM00135+7                                               04146000
IOPPRELN EQU   @NM00136                                                 04147000
@NM00134 EQU   IOPPTFDR+20                                              04148000
IOPSBYNO EQU   IOPPTFDR+13                                              04149000
IOPDBYNO EQU   IOPPTFDR+6                                               04150000
@NM00133 EQU   IOPPTFF3                                                 04151000
IOPFLF   EQU   IOPPTFF3                                                 04152000
IOPDBYP  EQU   IOPPTFF3                                                 04153000
IOPSBYP  EQU   IOPPTFF3                                                 04154000
IOPPMDLP EQU   IOPPTFF2+1                                               04155000
IOPPADDP EQU   IOPPTFF2+1                                               04156000
@NM00132 EQU   IOPPTFF2+1                                               04157000
IOPLRFP  EQU   IOPPTFF2                                                 04158000
IOPJCLP  EQU   IOPPTFF2                                                 04159000
IOPSUPP  EQU   IOPPTFF2                                                 04160000
IOPREQP  EQU   IOPPTFF2                                                 04161000
IOPPREP  EQU   IOPPTFF2                                                 04162000
IOPNPRP  EQU   IOPPTFF2                                                 04163000
IOPIRQP  EQU   IOPPTFF2                                                 04164000
IOPDELP  EQU   IOPPTFF2                                                 04165000
IOPREGEN EQU   IOPFLGS5                                                 04166000
IOPBYP   EQU   IOPFLGS5                                                 04167000
IOPDUMMP EQU   IOPFLGS5                                                 04168000
@NM00131 EQU   IOPFLGS5                                                 04169000
IOPERROR EQU   IOPFLGS5                                                 04170000
IOPACC   EQU   IOPFLGS5                                                 04171000
IOPRES   EQU   IOPFLGS5                                                 04172000
IOPAPP   EQU   IOPFLGS5                                                 04173000
IOPPTYPE EQU   IOPPTFDR+1                                               04174000
@NM00130 EQU   IOPPTFDR                                                 04175000
IOPSYSTP EQU   IOPSYSTR+8                                               04176000
IOPSYSND EQU   IOPSYNTR                                                 04177000
@NM00129 EQU   IOPSYSFX+21                                              04178000
IOPSYSID EQU   IOPSYSFX+13                                              04179000
IOPNUCID EQU   IOPSYSFX+12                                              04180000
IOPSREL  EQU   IOPSYSFX+8                                               04181000
@NM00128 EQU   @NM00126+7                                               04182000
@NM00127 EQU   @NM00126                                                 04183000
@NM00125 EQU   IOPSYSDR+5                                               04184000
@NM00124 EQU   IOPFLGS7                                                 04185000
IOPSYNG  EQU   IOPFLGS7                                                 04186000
IOPSYDL  EQU   IOPFLGS7                                                 04187000
IOPSTSNP EQU   IOPFLGS7                                                 04188000
IOPMTSNP EQU   IOPFLGS7                                                 04189000
IOPPEMAX EQU   IOPSYSDR+2                                               04190000
IOPSCNVL EQU   IOPSYSDR+1                                               04191000
@NM00123 EQU   IOPSYSDR                                                 04192000
IOPDLIND EQU   IOPDNTRY+8                                               04193000
IOPDLBND EQU   IOPDSYS                                                  04194000
@NM00122 EQU   IOPDLBFX+8                                               04195000
@NM00121 EQU   @NM00119+7                                               04196000
@NM00120 EQU   @NM00119                                                 04197000
@NM00118 EQU   IOPDLBDR+1                                               04198000
@NM00117 EQU   IOPDLBDR                                                 04199000
@NM00116 EQU   IOPMODST                                                 04200000
IOPDLIB  EQU   IOPMODFX+72                                              04201000
@NM00115 EQU   IOPMODFX+12                                              04202000
@NM00114 EQU   IOPMODF4                                                 04203000
@NM00113 EQU   IOPMODF3                                                 04204000
@NM00112 EQU   IOPMODF2                                                 04205000
IOPMPAGA EQU   IOPMODF2                                                 04206000
IOPMNE   EQU   IOPMODF2                                                 04207000
@NM00111 EQU   IOPMODF1                                                 04208000
IOPMDC   EQU   IOPMODF1                                                 04209000
IOPMREFR EQU   IOPMODF1                                                 04210000
IOPMOVLY EQU   IOPMODF1                                                 04211000
IOPMSCTR EQU   IOPMODF1                                                 04212000
IOPMREUS EQU   IOPMODF1                                                 04213000
IOPMRENT EQU   IOPMODF1                                                 04214000
IOPMAPF  EQU   IOPMODF1                                                 04215000
@NM00110 EQU   @NM00108+7                                               04216000
@NM00109 EQU   @NM00108                                                 04217000
@NM00107 EQU   IOPMODDR+17                                              04218000
@NM00106 EQU   @NM00104+7                                               04219000
@NM00105 EQU   @NM00104                                                 04220000
@NM00103 EQU   @NM00100                                                 04221000
@NM00102 EQU   @NM00100                                                 04222000
@NM00101 EQU   @NM00100                                                 04223000
@NM00099 EQU   @NM00098                                                 04224000
@NM00097 EQU   IOPMODDR                                                 04225000
IOPSRIND EQU   IOPSNTRY+8                                               04226000
@NM00096 EQU   IOPSRCST                                                 04227000
IOPSRCND EQU   IOPSRCID                                                 04228000
IOPSRDLB EQU   IOPSRCFX+72                                              04229000
IOPSRSYS EQU   IOPSRCFX+64                                              04230000
@NM00095 EQU   IOPSRCFX+8                                               04231000
@NM00094 EQU   @NM00092+7                                               04232000
@NM00093 EQU   @NM00092                                                 04233000
@NM00091 EQU   IOPSRCDR+18                                              04234000
IOPSRLNG EQU   IOPSRCDR+17                                              04235000
@NM00090 EQU   @NM00088+7                                               04236000
@NM00089 EQU   @NM00088                                                 04237000
@NM00087 EQU   @NM00084                                                 04238000
@NM00086 EQU   @NM00084                                                 04239000
@NM00085 EQU   @NM00084                                                 04240000
@NM00083 EQU   @NM00082                                                 04241000
@NM00081 EQU   IOPSRCDR                                                 04242000
IOPEOFND EQU   IOPEOFNT                                                 04243000
IOPMCTYP EQU   IOPMCIND                                                 04244000
@NM00080 EQU   IOPMACST                                                 04245000
IOPMACND EQU   IOPMACID                                                 04246000
IOPMCDLB EQU   IOPMACFX+72                                              04247000
IOPMCSYS EQU   IOPMACFX+64                                              04248000
@NM00079 EQU   IOPMACFX+8                                               04249000
@NM00078 EQU   IOPMACDR+18                                              04250000
IOPMCLNG EQU   IOPMACDR+17                                              04251000
IOPFMST  EQU   IOPFMIDE+7                                               04252000
IOPFMID  EQU   IOPFMIDE                                                 04253000
@NM00077 EQU   IOPRMST                                                  04254000
IOPRMASM EQU   IOPRMST                                                  04255000
@NM00076 EQU   IOPRMST                                                  04256000
IOPRMID  EQU   IOPRMIDE                                                 04257000
@NM00075 EQU   IOPMACDR                                                 04258000
@NM00073 EQU   @NM00071+7                                               04259000
@NM00072 EQU   @NM00071                                                 04260000
@NM00070 EQU   IOPLMDDR+6                                               04261000
@NM00069 EQU   IOPFLGS3                                                 04262000
IOPCHREP EQU   IOPFLGS3                                                 04263000
IOPLINK  EQU   IOPFLGS3                                                 04264000
IOPCOPY  EQU   IOPFLGS3                                                 04265000
@NM00068 EQU   IOPLMDF4                                                 04266000
@NM00067 EQU   IOPLMDF3                                                 04267000
@NM00066 EQU   IOPLMDF2                                                 04268000
IOPPAGA  EQU   IOPLMDF2                                                 04269000
IOPNE    EQU   IOPLMDF2                                                 04270000
@NM00065 EQU   IOPFLGS2                                                 04271000
IOPDC    EQU   IOPFLGS2                                                 04272000
IOPREFR  EQU   IOPFLGS2                                                 04273000
IOPOVLY  EQU   IOPFLGS2                                                 04274000
IOPSCTR  EQU   IOPFLGS2                                                 04275000
IOPREUS  EQU   IOPFLGS2                                                 04276000
IOPRENT  EQU   IOPFLGS2                                                 04277000
IOPAPF   EQU   IOPFLGS2                                                 04278000
@NM00064 EQU   IOPLMDDR                                                 04279000
@NM00063 EQU   IOPASMDR+9                                               04280000
IOPABUTP EQU   IOPABUNT+7                                               04281000
IOPABUPT EQU   IOPABUNT                                                 04282000
IOPNTLVL EQU   IOPASMDR                                                 04283000
IOPALLOC EQU   @NM00062+4                                               04284000
IOPUSED  EQU   @NM00062                                                 04285000
IOPTPSEQ EQU   @NM00061+8                                               04286000
IOPVLSER EQU   @NM00061+2                                               04287000
IOPBLKSI EQU   @NM00061                                                 04288000
IOPCQMAX EQU   IOPCQMAP+12                                              04289000
@NM00060 EQU   IOPCQMAP+11                                              04290000
@NM00059 EQU   IOPCQMAP+8                                               04291000
@NM00058 EQU   IOPCQMAP                                                 04292000
IOPPTMAX EQU   IOPCDMAX                                                 04293000
@NM00057 EQU   IOPSCMAP+11                                              04294000
@NM00056 EQU   IOPSCMAP+8                                               04295000
@NM00055 EQU   IOPSCMAP                                                 04296000
IOPDIRMX EQU   IOPNTMAX+12                                              04297000
@NM00054 EQU   IOPNTMAX+11                                              04298000
@NM00053 EQU   IOPNTMAX+8                                               04299000
@NM00052 EQU   IOPNTMAX                                                 04300000
@NM00051 EQU   IOPDTYPE                                                 04301000
IOPDMOD  EQU   IOPDTYPE                                                 04302000
IOPDJCL  EQU   IOPDTYPE                                                 04303000
IOPDSRC  EQU   IOPDTYPE                                                 04304000
IOPDMAC  EQU   IOPDTYPE                                                 04305000
IOPSDIR  EQU   IOPSPACE+4                                               04306000
IOPSSCND EQU   IOPSPACE+2                                               04307000
IOPSPRIM EQU   IOPSPACE                                                 04308000
IOPDSN   EQU   IOPDYNDT                                                 04309000
IOPNTYPE EQU   IOPSTCMP+17                                              04310000
IOPNNAME EQU   IOPSTCMP+9                                               04311000
IOPOTYPE EQU   IOPSTCMP+8                                               04312000
IOPONAME EQU   IOPSTCMP                                                 04313000
IOPISEQ3 EQU   IOPINAM3+6                                               04314000
IOPITYP3 EQU   @NM00050+5                                               04315000
IOPIPTF3 EQU   @NM00050                                                 04316000
@NM00266 EQU   STMTBUF+72                                               04317000
ICTIXL   EQU   ICTIXLF                                                  04318000
@NM00224 EQU   ICTLMOD+38                                               04319000
ICTLTTR  EQU   ICTLMOD+31                                               04320000
ICTTG2   EQU   ICTLMOD+23                                               04321000
ICTTG1   EQU   ICTLMOD+15                                               04322000
@NM00223 EQU   ICTLFLG3                                                 04323000
ICTLZAP  EQU   ICTLFLG3                                                 04324000
ICTLLKD  EQU   ICTLFLG3                                                 04325000
ICTLCPY  EQU   ICTLFLG3                                                 04326000
ICTLXPND EQU   ICTLFLG3                                                 04327000
ICTTIND2 EQU   ICTLFLG3                                                 04328000
ICTTIND1 EQU   ICTLFLG3                                                 04329000
@NM00222 EQU   ICTLFLG2                                                 04330000
ICTLDEL  EQU   ICTLFLG2                                                 04331000
@NM00221 EQU   ICTLFLG2                                                 04332000
ICTLTDEL EQU   ICTLFLG2                                                 04333000
ICTLINK  EQU   ICTLFLG2                                                 04334000
ICTCOPY  EQU   ICTLFLG2                                                 04335000
@NM00220 EQU   ICTLFLG7                                                 04336000
@NM00219 EQU   ICTLFLG6                                                 04337000
@NM00218 EQU   ICTLFLG5                                                 04338000
ICTLPAGA EQU   ICTLFLG5                                                 04339000
ICTLNE   EQU   ICTLFLG5                                                 04340000
@NM00217 EQU   ICTLFLG1                                                 04341000
ICTLDC   EQU   ICTLFLG1                                                 04342000
ICTLREFR EQU   ICTLFLG1                                                 04343000
ICTLOVLY EQU   ICTLFLG1                                                 04344000
ICTLSCTR EQU   ICTLFLG1                                                 04345000
ICTLREUS EQU   ICTLFLG1                                                 04346000
ICTLRENT EQU   ICTLFLG1                                                 04347000
ICTLAPF  EQU   ICTLFLG1                                                 04348000
@NM00216 EQU   ICTLFLG4                                                 04349000
ICTLPASS EQU   ICTLFLG4                                                 04350000
ICTLDDCK EQU   ICTLFLG4                                                 04351000
ICTLMSG  EQU   ICTLFLG4                                                 04352000
ICTLCPL  EQU   ICTLFLG4                                                 04353000
ICTLNOGO EQU   ICTLFLG4                                                 04354000
@NM00215 EQU   ICTMUMNT+7                                               04355000
ICTMUMND EQU   ICTMUMNM                                                 04356000
@NM00214 EQU   ICTMVRNT+7                                               04357000
ICTMVRND EQU   ICTMVRNM                                                 04358000
ICTASMND EQU   ICTASMAD                                                 04359000
ICTMIDTY EQU   ICTMODST                                                 04360000
ICTMIDAM EQU   ICTMODST                                                 04361000
ICTMIDRG EQU   ICTMODST                                                 04362000
ICTMIDF1 EQU   ICTMODST                                                 04363000
ICTMIDPL EQU   ICTMODST                                                 04364000
ICTMIDPS EQU   ICTMODST                                                 04365000
@NM00213 EQU   ICTMODST                                                 04366000
ICTMIDND EQU   ICTMODID                                                 04367000
ICTIXM   EQU   ICTIXMF                                                  04368000
@NM00212 EQU   ICTMOD+128                                               04369000
ICTMICHA EQU   ICTMOD+108                                               04370000
@NM00211 EQU   ICTMOD+95                                                04371000
ICTMFMID EQU   ICTMOD+88                                                04372000
@NM00210 EQU   ICTMOD+87                                                04373000
ICTMRMID EQU   ICTMOD+80                                                04374000
ICTMSSI  EQU   ICTMOD+72                                                04375000
ICTMDOBJ EQU   ICTMOD+64                                                04376000
ICTMSYSL EQU   ICTMOD+56                                                04377000
ICTMASLB EQU   ICTMOD+40                                                04378000
ICTFMLIB EQU   ICTMOD+24                                                04379000
ICTMRELN EQU   ICTMOD+22                                                04380000
@NM00209 EQU   ICTMOD+21                                                04381000
ICTMLANG EQU   ICTMOD+20                                                04382000
@NM00208 EQU   ICTMOD+19                                                04383000
ICTMACF5 EQU   ICTMOD+18                                                04384000
ICTMZMPR EQU   ICTMACF4                                                 04385000
ICTMZOMZ EQU   ICTMACF4                                                 04386000
ICTMDOAS EQU   ICTMACF4                                                 04387000
ICTMXUPD EQU   ICTMACF4                                                 04388000
ICTMFXC  EQU   ICTMACF4                                                 04389000
ICTMFXBS EQU   ICTMACF4                                                 04390000
ICTMHASM EQU   ICTMACF4                                                 04391000
ICTMACDL EQU   ICTMACF4                                                 04392000
@NM00207 EQU   ICTMLEP4                                                 04393000
@NM00206 EQU   ICTMLEP3                                                 04394000
@NM00205 EQU   ICTMLEP2                                                 04395000
ICTMPAGA EQU   ICTMLEP2                                                 04396000
ICTMNE   EQU   ICTMLEP2                                                 04397000
@NM00204 EQU   ICTMLEP1                                                 04398000
ICTMDC   EQU   ICTMLEP1                                                 04399000
ICTMREFR EQU   ICTMLEP1                                                 04400000
ICTMOVLY EQU   ICTMLEP1                                                 04401000
ICTMSCTR EQU   ICTMLEP1                                                 04402000
ICTMREUS EQU   ICTMLEP1                                                 04403000
ICTMRENT EQU   ICTMLEP1                                                 04404000
ICTMAPF  EQU   ICTMLEP1                                                 04405000
@NM00203 EQU   ICTMFLG5                                                 04406000
ICTMNORL EQU   ICTMFLG5                                                 04407000
ICTMELCK EQU   ICTMFLG5                                                 04408000
ICTMCOPY EQU   ICTMFLG5                                                 04409000
ICTMPASS EQU   ICTMFLG5                                                 04410000
@NM00202 EQU   ICTMFLG4                                                 04411000
ICTMDSTE EQU   ICTMFLG4                                                 04412000
ICTMMIDE EQU   ICTMFLG4                                                 04413000
ICTMASOC EQU   ICTMFLG4                                                 04414000
@NM00201 EQU   ICTMFLG3                                                 04415000
ICTMPRMS EQU   ICTMFLG3                                                 04416000
ICTMALIS EQU   ICTMFLG3                                                 04417000
ICTMWRK  EQU   ICTMFLG3                                                 04418000
ICTMTRX  EQU   ICTMFLG3                                                 04419000
ICTMRELF EQU   ICTMFLG3                                                 04420000
ICTLIBTX EQU   ICTMFLG3                                                 04421000
ICTLIBLK EQU   ICTMFLG3                                                 04422000
ICTMSRCU EQU   ICTMFLG1                                                 04423000
ICTMMACU EQU   ICTMFLG1                                                 04424000
ICTMXPND EQU   ICTMFLG1                                                 04425000
ICTMZAP  EQU   ICTMFLG1                                                 04426000
ICTMASM  EQU   ICTMMODR                                                 04427000
@NM00200 EQU   ICTMFLG2                                                 04428000
@NM00199 EQU   ICTMFLG2                                                 04429000
ICTMMIDU EQU   ICTMFLG2                                                 04430000
ICTMDEL  EQU   ICTMFLG2                                                 04431000
ICTMMSG  EQU   ICTMFLG2                                                 04432000
ICTMCPL  EQU   ICTMFLG2                                                 04433000
ICTMNOGO EQU   ICTMFLG2                                                 04434000
@NM00198 EQU   ICTSBYNT+7                                               04435000
ICTSBYND EQU   ICTSBYNM                                                 04436000
ICTDELEX EQU   ICTDELST                                                 04437000
ICTDELND EQU   ICTDELNM                                                 04438000
@NM00197 EQU   ICTVRSNT+7                                               04439000
ICTVRSND EQU   ICTVRSNM                                                 04440000
@NM00196 EQU   ICTNPRNT+7                                               04441000
ICTNPRND EQU   ICTNPRNM                                                 04442000
@NM00195 EQU   ICTCSRST                                                 04443000
@NM00194 EQU   ICTCSRST                                                 04444000
ICTCSRF  EQU   ICTCSRST                                                 04445000
@NM00193 EQU   ICTCSRST                                                 04446000
ICTCSRNM EQU   ICTIRQNT+8                                               04447000
@NM00192 EQU   ICTIRQST                                                 04448000
ICTIREQT EQU   ICTIRQST                                                 04449000
ICTIREQI EQU   ICTIRQST                                                 04450000
ICTIREQB EQU   ICTIRQST                                                 04451000
ICTIREQS EQU   ICTIRQST                                                 04452000
@NM00191 EQU   ICTIRQST                                                 04453000
ICTIRQND EQU   ICTIRQNM                                                 04454000
@NM00190 EQU   ICTPREST                                                 04455000
ICTPREQT EQU   ICTPREST                                                 04456000
ICTPREQI EQU   ICTPREST                                                 04457000
ICTPREQB EQU   ICTPREST                                                 04458000
ICTPREQS EQU   ICTPREST                                                 04459000
@NM00189 EQU   ICTPREST                                                 04460000
ICTPREND EQU   ICTPRENM                                                 04461000
@NM00188 EQU   ICTSUPNT+7                                               04462000
ICTSUPND EQU   ICTSUPNM                                                 04463000
@NM00187 EQU   ICTREQST                                                 04464000
ICTRREQT EQU   ICTREQST                                                 04465000
ICTRREQI EQU   ICTREQST                                                 04466000
ICTRREQB EQU   ICTREQST                                                 04467000
ICTRREQS EQU   ICTREQST                                                 04468000
@NM00186 EQU   ICTREQST                                                 04469000
ICTREQND EQU   ICTREQNM                                                 04470000
@NM00185 EQU   ICTENTST                                                 04471000
ICTEREQT EQU   ICTENTST                                                 04472000
ICTEREQI EQU   ICTENTST                                                 04473000
ICTEREQB EQU   ICTENTST                                                 04474000
ICTEREQS EQU   ICTENTST                                                 04475000
@NM00184 EQU   ICTENTST                                                 04476000
ICTENTND EQU   ICTENTNM                                                 04477000
@NM00183 EQU   ICTPTF+100                                               04478000
ICTPTPFX EQU   ICTPTF+38                                                04479000
ICTPRELN EQU   ICTPTF+36                                                04480000
ICTPRECT EQU   ICTPTF+33                                                04481000
ICTPRECD EQU   ICTPTF+30                                                04482000
ICTPVERN EQU   ICTPTF+29                                                04483000
ICTPFMID EQU   ICTPTF+22                                                04484000
ICTPSUPN EQU   ICTPTF+20                                                04485000
ICTPONUM EQU   ICTPTF+18                                                04486000
ICTPUSR8 EQU   ICTPFLGA                                                 04487000
ICTPUSR7 EQU   ICTPFLGA                                                 04488000
ICTPUSR6 EQU   ICTPFLGA                                                 04489000
ICTPUSR5 EQU   ICTPFLGA                                                 04490000
ICTPUSR4 EQU   ICTPFLGA                                                 04491000
ICTPUSR3 EQU   ICTPFLGA                                                 04492000
ICTPUSR2 EQU   ICTPFLGA                                                 04493000
ICTPPASS EQU   ICTPUSR1                                                 04494000
@NM00182 EQU   @NM00181                                                 04495000
ICTPRQBY EQU   @NM00181                                                 04496000
ICTPRQOK EQU   @NM00181                                                 04497000
ICTPRQCK EQU   @NM00181                                                 04498000
@NM00180 EQU   ICTPFLG9                                                 04499000
ICTPPDEL EQU   ICTPFLG9                                                 04500000
ICTPWRKO EQU   ICTPFLG9                                                 04501000
ICTPMSL  EQU   ICTPFLG9                                                 04502000
@NM00179 EQU   ICTPFLG8                                                 04503000
ICTPECPL EQU   ICTPFLG8                                                 04504000
ICTPGCPL EQU   ICTPFLG8                                                 04505000
@NM00178 EQU   ICTPFLG4                                                 04506000
@NM00177 EQU   ICTPFLG4                                                 04507000
@NM00176 EQU   ICTPFLG4                                                 04508000
ICTPREDO EQU   ICTPFLG4                                                 04509000
ICTPCDSE EQU   ICTPFLG4                                                 04510000
@NM00175 EQU   ICTPFLG2                                                 04511000
ICTPRCND EQU   ICTPFLG2                                                 04512000
ICTPTPS  EQU   ICTPFLG2                                                 04513000
ICTPTR1  EQU   ICTPFLG2                                                 04514000
ICTPVRSP EQU   ICTPFLG2                                                 04515000
@NM00174 EQU   ICTPFLG6                                                 04516000
ICTFLF   EQU   ICTPFLF                                                  04517000
ICTPDBYP EQU   ICTPFLG6                                                 04518000
ICTPSBYP EQU   ICTPFLG6                                                 04519000
ICTPADDP EQU   ICTPFLG5+1                                               04520000
@NM00173 EQU   ICTPFLG5+1                                               04521000
ICTPLRFP EQU   ICTPFLG5                                                 04522000
ICTPJCLP EQU   ICTPFLG5                                                 04523000
ICTPSUPP EQU   ICTPFLG5                                                 04524000
ICTPREQP EQU   ICTPFLG5                                                 04525000
ICTPPREP EQU   ICTPFLG5                                                 04526000
ICTPNPRP EQU   ICTPFLG5                                                 04527000
ICTPIRQP EQU   ICTPFLG5                                                 04528000
ICTPDELP EQU   ICTPFLG5                                                 04529000
@NM00172 EQU   ICTPFLG3                                                 04530000
ICTPSLST EQU   ICTPFLG3                                                 04531000
ICTPNOLB EQU   ICTPFLG3                                                 04532000
ICTPVERJ EQU   ICTPFLG3                                                 04533000
ICTPMSG  EQU   ICTPFLG3                                                 04534000
ICTPCPL  EQU   ICTPFLG3                                                 04535000
ICTPROCS EQU   ICTPPROC                                                 04536000
ICTREGEN EQU   ICTPFLG1                                                 04537000
ICTBYP   EQU   ICTPFLG1                                                 04538000
ICTDUMMP EQU   ICTPFLG1                                                 04539000
@NM00171 EQU   ICTPFLG1                                                 04540000
ICTERROR EQU   ICTPFLG1                                                 04541000
ICTACC   EQU   ICTPFLG1                                                 04542000
ICTRES   EQU   ICTPFLG1                                                 04543000
ICTAPP   EQU   ICTPFLG1                                                 04544000
ICTLEN   EQU   ICTGMSPL+1                                               04545000
ICTSP    EQU   ICTGMSPL                                                 04546000
ICTLLEN  EQU   ICTLSPLN+1                                               04547000
ICTLSP   EQU   ICTLSPLN                                                 04548000
ICTMLEN  EQU   ICTMSPLN+1                                               04549000
ICTMSP   EQU   ICTMSPLN                                                 04550000
ICTPLEN  EQU   ICTPSPLN+1                                               04551000
ICTPSP   EQU   ICTPSPLN                                                 04552000
IOPBS04E EQU   IOPBS04+2                                                04553000
IOPBAPFC EQU   IOPBAPF+1                                                04554000
IOPBAPFL EQU   IOPBAPF                                                  04555000
IOPBS2NM EQU   IOPBS02+3                                                04556000
IOPBS2EP EQU   IOPBS02                                                  04557000
IOPQSMTP EQU   IOPQSMLS+8                                               04558000
@NM00156 EQU   IOPQSMLS+7                                               04559000
IOPQSMND EQU   IOPQSMNM                                                 04560000
@NM00155 EQU   @NM00154+7                                               04561000
IOPQSMFM EQU   @NM00154                                                 04562000
@NM00074 EQU   IOPLMCTL+17                                              04563000
IOPLMCRD EQU   IOPLMCTL+9                                               04564000
IOPLMCRN EQU   IOPLMCTL+1                                               04565000
IOPLMCC  EQU   IOPLMCTL                                                 04566000
@NM00049 EQU   IOPUSERL                                                 04567000
@NM00048 EQU   IOPUSERL                                                 04568000
IOPALIS  EQU   IOPUSERL                                                 04569000
IOPTTR   EQU   IOPDRMAP+8                                               04570000
IOPINAM2 EQU   IOPINAM+1                                                04571000
IOPITYP2 EQU   IOPITYP                                                  04572000
@NM00047 EQU   HMASMIOP+32                                              04573000
@NM00046 EQU   @NM00043+10                                              04574000
IOPSEQNO EQU   @NM00043+8                                               04575000
@NM00045 EQU   @NM00044+7                                               04576000
IOPPTFNM EQU   @NM00044                                                 04577000
IOPNAM17 EQU   IOPNAME                                                  04578000
CCABMREC EQU   CCABELMT+10                                              04579000
CCABPOS  EQU   CCABMPOS+8                                               04580000
CCABNAME EQU   CCABMPOS                                                 04581000
@NM00042 EQU   CCABLDLM+2                                               04582000
@NM00041 EQU   CCABLDLM                                                 04583000
CCAUPDPM EQU   @NM00039+24                                              04584000
@NM00040 EQU   @NM00039+21                                              04585000
CCARUPDT EQU   CCAUPDRC                                                 04586000
CCAUPDSP EQU   @NM00039+12                                              04587000
CCAUPDTE EQU   @NM00039+8                                               04588000
CCAUPDNM EQU   @NM00039                                                 04589000
CCASUPPM EQU   @NM00037+24                                              04590000
@NM00038 EQU   @NM00037+21                                              04591000
CCARSUP  EQU   CCASUPRC                                                 04592000
CCASUPSP EQU   @NM00037+12                                              04593000
CCAIOSUP EQU   @NM00037+8                                               04594000
CCASUPNM EQU   @NM00037                                                 04595000
CCAZAPPM EQU   @NM00035+24                                              04596000
@NM00036 EQU   @NM00035+21                                              04597000
CCARZAP  EQU   CCAZAPRC                                                 04598000
CCAZAPSP EQU   @NM00035+12                                              04599000
CCASPZAP EQU   @NM00035+8                                               04600000
CCAZAPNM EQU   @NM00035                                                 04601000
CCACOMPM EQU   @NM00033+24                                              04602000
@NM00034 EQU   @NM00033+21                                              04603000
CCARCOMP EQU   CCACOMRC                                                 04604000
CCACOMSP EQU   @NM00033+12                                              04605000
CCACOMRS EQU   @NM00033+8                                               04606000
CCACOMNM EQU   @NM00033                                                 04607000
CCACPYPM EQU   @NM00031+24                                              04608000
@NM00032 EQU   @NM00031+21                                              04609000
CCARCOPY EQU   CCACPYRC                                                 04610000
CCACPYSP EQU   @NM00031+12                                              04611000
CCACOPY  EQU   @NM00031+8                                               04612000
CCACPYNM EQU   @NM00031                                                 04613000
CCAASMPM EQU   @NM00029+24                                              04614000
@NM00030 EQU   @NM00029+21                                              04615000
CCARASM  EQU   CCAASMRC                                                 04616000
CCAASMSP EQU   @NM00029+12                                              04617000
CCAASM   EQU   @NM00029+8                                               04618000
CCAASMNM EQU   @NM00029                                                 04619000
CCALKDPM EQU   @NM00027+24                                              04620000
@NM00028 EQU   @NM00027+21                                              04621000
CCARLINK EQU   CCALKDRC                                                 04622000
CCALKDSP EQU   @NM00027+12                                              04623000
CCALKED  EQU   @NM00027+8                                               04624000
CCALKDNM EQU   @NM00027                                                 04625000
CCAPGMPM EQU   @NM00025+24                                              04626000
@NM00026 EQU   @NM00025+21                                              04627000
CCABPGRC EQU   @NM00025+20                                              04628000
CCABPGSP EQU   @NM00025+12                                              04629000
CCABPGAD EQU   @NM00025+8                                               04630000
CCABPGNM EQU   @NM00025                                                 04631000
CCAEND   EQU   HMASMCCA+371                                             04632000
@NM00024 EQU   HMASMCCA+309                                             04633000
CCACURDD EQU   CCAFDSNG+3                                               04634000
CCACURDS EQU   CCAFDSNG+2                                               04635000
@NM00023 EQU   CCAFLAGB                                                 04636000
CCAOUTNG EQU   CCAFLAGB                                                 04637000
CCALOGNG EQU   CCAFLAGB                                                 04638000
CCAFMID  EQU   HMASMCCA+291                                             04639000
CCALSTDS EQU   CCAFCTL+8                                                04640000
CCARPTDS EQU   CCAFCTL+7                                                04641000
CCATIME  EQU   CCAFCTL+4                                                04642000
CCADATE  EQU   CCAFCTL+1                                                04643000
@NM00022 EQU   CCAFLAG9                                                 04644000
CCARVCAN EQU   CCAFLAG9                                                 04645000
CCARVEST EQU   CCAFLAG9                                                 04646000
CCAPTSNJ EQU   CCAFLAG9                                                 04647000
CCASTSNP EQU   CCAFLAG9                                                 04648000
CCAMTSNP EQU   CCAFLAG9                                                 04649000
CCAPTSNP EQU   CCAFLAG9                                                 04650000
@NM00021 EQU   CCAFLAG8                                                 04651000
CCAACDSC EQU   CCAFLAG8                                                 04652000
CCACDSC  EQU   CCAFLAG8                                                 04653000
@NM00020 EQU   CCAFLAG6                                                 04654000
CCAACRUP EQU   CCAFLAG6                                                 04655000
CCACRQUP EQU   CCAFLAG6                                                 04656000
CCAACDUP EQU   CCAFLAG6                                                 04657000
CCACDSUP EQU   CCAFLAG6                                                 04658000
@NM00019 EQU   CCAFLAG5                                                 04659000
CCAACROS EQU   CCAFLAG5                                                 04660000
CCACRQOS EQU   CCAFLAG5                                                 04661000
CCAACDOS EQU   CCAFLAG5                                                 04662000
CCACDSOS EQU   CCAFLAG5                                                 04663000
@NM00018 EQU   CCAFLAG4                                                 04664000
CCAACRIS EQU   CCAFLAG4                                                 04665000
CCACRQIS EQU   CCAFLAG4                                                 04666000
CCAACDIS EQU   CCAFLAG4                                                 04667000
CCACDSIS EQU   CCAFLAG4                                                 04668000
@NM00017 EQU   CCAFLAG3+1                                               04669000
CCARGNP  EQU   CCAFLAG3+1                                               04670000
CCADISRQ EQU   CCAFLAG3+1                                               04671000
CCAICTOK EQU   CCAFLAG3                                                 04672000
CCADELP  EQU   CCAFLAG3                                                 04673000
CCACMPRS EQU   CCAFLAG3                                                 04674000
CCAZAPP  EQU   CCAFLAG3                                                 04675000
CCALINKP EQU   CCAFLAG3                                                 04676000
CCACOPYP EQU   CCAFLAG3                                                 04677000
CCAASIP  EQU   CCAFLAG3                                                 04678000
CCAUPDP  EQU   CCAFLAG3                                                 04679000
CCAEOSMP EQU   CCAFLAG2                                                 04680000
CCAEOFNC EQU   CCAFLAG2                                                 04681000
@NM00016 EQU   CCAFLAG2                                                 04682000
CCACHECK EQU   CCAFLAG2                                                 04683000
CCATERM  EQU   CCAFLAG2                                                 04684000
CCASVCLB EQU   CCAFLAG2                                                 04685000
CCANCPTF EQU   CCAFLAG2                                                 04686000
@NM00015 EQU   CCAFLAG1+1                                               04687000
CCAUNL   EQU   CCAFLAG1+1                                               04688000
CCARESET EQU   CCAFLAG1+1                                               04689000
CCALOG   EQU   CCAFLAG1+1                                               04690000
CCACNV   EQU   CCAFLAG1+1                                               04691000
CCALIST  EQU   CCAFLAG1                                                 04692000
CCAUPDU  EQU   CCAFLAG1                                                 04693000
CCAUPDJ  EQU   CCAFLAG1                                                 04694000
CCAREJ   EQU   CCAFLAG1                                                 04695000
CCAREC   EQU   CCAFLAG1                                                 04696000
CCAFUNCT EQU   CCAFFUNC                                                 04697000
@NM00014 EQU   @NM00009+18                                              04698000
@NM00013 EQU   @NM00009+16                                              04699000
CCATBLPA EQU   @NM00009+12                                              04700000
@NM00012 EQU   @NM00009+8                                               04701000
@NM00011 EQU   @NM00009+4                                               04702000
@NM00010 EQU   @NM00009                                                 04703000
CCAIFGTP EQU   CCAFGTP+16                                               04704000
CCAGTP3  EQU   CCAFGTP+12                                               04705000
CCAGTP2  EQU   CCAFGTP+8                                                04706000
CCAGTP1  EQU   CCAFGTP+4                                                04707000
CCASETAD EQU   CCASEGTP                                                 04708000
CCACLST  EQU   CCAFPGM+12                                               04709000
CCASPDCB EQU   CCAFPGM+8                                                04710000
CCARVAD  EQU   CCAFSTA                                                  04711000
CCAACDID EQU   CCAFSYS+32                                               04712000
CCACDSID EQU   CCAFSYS+24                                               04713000
CCALNLEN EQU   CCAFSYS+22                                               04714000
@NM00008 EQU   CCAFLAGA                                                 04715000
CCAPSYSF EQU   CCAFLAGA                                                 04716000
CCAASYSF EQU   CCAFLAGA                                                 04717000
CCACSYSF EQU   CCAFLAGA                                                 04718000
CCANUCID EQU   CCAFSYS+20                                               04719000
CCAASREL EQU   CCAFSYS+16                                               04720000
CCACSREL EQU   CCASREL                                                  04721000
CCAPEMAX EQU   CCAFSYS+10                                               04722000
CCAPGLEN EQU   CCAFSYS+8                                                04723000
CCAIOPAS EQU   CCAFSYS+4                                                04724000
CCAIOPCS EQU   CCAFSYS                                                  04725000
CCAPESIZ EQU   CCAFIOP+4                                                04726000
@NM00007 EQU   CCAFLAG7+3                                               04727000
CCALOGP  EQU   CCAFLAG7+2                                               04728000
CCAOUTP  EQU   CCAFLAG7+2                                               04729000
CCASLBP  EQU   CCAFLAG7+2                                               04730000
CCARPTP  EQU   CCAFLAG7+2                                               04731000
CCALISTP EQU   CCAFLAG7+2                                               04732000
CCAJCLP  EQU   CCAFLAG7+2                                               04733000
CCAPTFP  EQU   CCAFLAG7+2                                               04734000
CCATLBP  EQU   CCAFLAG7+2                                               04735000
CCAUT3P  EQU   CCAFLAG7+1                                               04736000
CCAUT2P  EQU   CCAFLAG7+1                                               04737000
CCAUT1P  EQU   CCAFLAG7+1                                               04738000
CCAWK5P  EQU   CCAFLAG7+1                                               04739000
CCAWK4P  EQU   CCAFLAG7+1                                               04740000
CCAWK3P  EQU   CCAFLAG7+1                                               04741000
CCAWK2P  EQU   CCAFLAG7+1                                               04742000
CCAWK1P  EQU   CCAFLAG7+1                                               04743000
CCAACRQP EQU   CCAFLAG7                                                 04744000
CCACRQP  EQU   CCAFLAG7                                                 04745000
CCASTSP  EQU   CCAFLAG7                                                 04746000
CCAMTSP  EQU   CCAFLAG7                                                 04747000
CCAPTSP  EQU   CCAFLAG7                                                 04748000
CCASCDSP EQU   CCAFLAG7                                                 04749000
CCAACDSP EQU   CCAFLAG7                                                 04750000
CCACDSP  EQU   CCAFLAG7                                                 04751000
@NM00006 EQU   CCAFBUFR+122                                             04752000
@NM00005 EQU   CCAFBUFR+120                                             04753000
@NM00004 EQU   CCAFBUFR+118                                             04754000
CCATBFMX EQU   CCAFBUFR+116                                             04755000
CCA4BFMX EQU   CCAFBUFR+114                                             04756000
CCA3BFMX EQU   CCAFBUFR+112                                             04757000
CCA2BFMX EQU   CCAFBUFR+110                                             04758000
CCA1BFMX EQU   CCAFBUFR+108                                             04759000
CCAXBFMX EQU   CCAFBUFR+106                                             04760000
CCAQBFMX EQU   CCAFBUFR+104                                             04761000
CCASBFMX EQU   CCAFBUFR+102                                             04762000
CCAMBFMX EQU   CCAFBUFR+100                                             04763000
CCAPBFMX EQU   CCAFBUFR+98                                              04764000
CCAVBFMX EQU   CCAFBUFR+96                                              04765000
CCAABFMX EQU   CCAFBUFR+94                                              04766000
CCACBFMX EQU   CCAFBUFR+92                                              04767000
@NM00003 EQU   CCAFBUFR+88                                              04768000
@NM00002 EQU   CCAFBUFR+84                                              04769000
CCA4BFSZ EQU   CCAFBUFR+80                                              04770000
CCATBFSZ EQU   CCAFBUFR+76                                              04771000
CCAWBFSZ EQU   CCAFBUFR+72                                              04772000
CCAQBFSZ EQU   CCAFBUFR+68                                              04773000
CCAPBFSZ EQU   CCAFBUFR+64                                              04774000
CCAVBFSZ EQU   CCAFBUFR+60                                              04775000
CCACBFSZ EQU   CCAFBUFR+56                                              04776000
@NM00001 EQU   CCAFBUFR+52                                              04777000
CCA4BFOA EQU   CCAFBUFR+48                                              04778000
CCA4BFIA EQU   CCAFBUFR+44                                              04779000
CCATBFIA EQU   CCAFBUFR+40                                              04780000
CCAWBFOA EQU   CCAFBUFR+36                                              04781000
CCAWBFIA EQU   CCAFBUFR+32                                              04782000
CCAQBFOA EQU   CCAFBUFR+28                                              04783000
CCAQBFIA EQU   CCAFBUFR+24                                              04784000
CCAPBFOA EQU   CCAFBUFR+20                                              04785000
CCAPBFIA EQU   CCAFBUFR+16                                              04786000
CCAVBFOA EQU   CCAFBUFR+12                                              04787000
CCAVBFIA EQU   CCAFBUFR+8                                               04788000
CCACBFOA EQU   CCAFBUFR+4                                               04789000
CCACBFIA EQU   CCAFBUFR                                                 04790000
CCAID    EQU   HMASMCCA                                                 04791000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      04792000
@RF00304 EQU   @EL00002                                                 04793000
@RF00324 EQU   @EL00003                                                 04794000
@RF00334 EQU   @EL00003                                                 04795000
@RF00333 EQU   @EL00003                                                 04796000
@RF00415 EQU   @EL00005                                                 04797000
@RF00453 EQU   @EL00007                                                 04798000
@RF00459 EQU   @EL00007                                                 04799000
@RF00535 EQU   @EL00009                                                 04800000
@RF00586 EQU   @EL00012                                                 04801000
@RC00603 EQU   @EL00013                                                 04802000
@RF00628 EQU   @EL00015                                                 04803000
@RF00641 EQU   @EL00016                                                 04804000
@RC00714 EQU   @EL00018                                                 04805000
@RF00718 EQU   @EL00018                                                 04806000
@RF00729 EQU   @EL00018                                                 04807000
@RF00731 EQU   @EL00018                                                 04808000
@ENDDATA EQU   *                                                        04809000
         END   HMASMDLE,(C'PLS2118',0802,78334)                         04810000
