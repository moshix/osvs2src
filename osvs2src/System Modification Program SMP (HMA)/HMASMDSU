         TITLE 'HMASMDSU - SMP DRIVER SETUP ROUTINE'                    00001000
HMASMDSU CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'HMASMDSU  78.334'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00009000
         BALR  @12,0                                               0001 00010000
@PSTART  DS    0H                                                  0001 00011000
         USING @PSTART,@12                                         0001 00012000
         ST    @13,@SA00001+4                                      0001 00013000
         LA    @14,@SA00001                                        0001 00014000
         ST    @14,8(,@13)                                         0001 00015000
         LR    @13,@14                                             0001 00016000
         MVC   @PC00001(4),0(@01)                                  0001 00017000
*   DSURTNCD=ZERO;                  /*                               */ 00018000
         MVI   DSURTNCD,X'00'                                      0192 00019000
*   DSUFLG1=''B;                    /*                               */ 00020000
         MVI   DSUFLG1,X'00'                                       0193 00021000
*   IOPPTR=CCAIOPTR;                /* PTR TO FIOP                   */ 00022000
         L     IOPPTR,CCAIOPTR(,CCAPTR)                            0194 00023000
*   SAVIOPTR=IOPPTR;                /* SAVE ADDR OF IOP              */ 00024000
         ST    IOPPTR,SAVIOPTR                                     0195 00025000
*   SAVBUFAD=IOPBUFAD;              /* SAVE BUFFER ADDRESS           */ 00026000
         MVC   SAVBUFAD(4),IOPBUFAD(IOPPTR)                        0196 00027000
*   CCAID=IDCCA;                    /* DUMP ID INTO THE CCA          */ 00028000
         MVC   CCAID(4,CCAPTR),@CC01353                            0197 00029000
*   CALL HMASMDC2;                  /*                               */ 00030000
         L     @15,@CV01325                                        0198 00031000
         BALR  @14,@15                                             0198 00032000
*   RFY                                                            0199 00033000
*     RTNCODE RSTD;                 /*                               */ 00034000
*   DSURTNCD=MAX(DSURTNCD,RTNCODE); /*                               */ 00035000
         SLR   @14,@14                                             0200 00036000
         IC    @14,DSURTNCD                                        0200 00037000
         CR    @14,RTNCODE                                         0200 00038000
         BNL   *+6                                                      00039000
         LR    @14,RTNCODE                                         0200 00040000
         STC   @14,DSURTNCD                                        0200 00041000
*   RFY                                                            0201 00042000
*     RTNCODE UNRSTD;               /*                               */ 00043000
*   GEN(TIME DEC);                  /* GET CURRENT DATE AND TIME     */ 00044000
         TIME DEC                                                       00045000
*   RFY                                                            0203 00046000
*    (R0,                                                          0203 00047000
*     R1) RSTD;                     /* RESTRICT DATE & TIME          */ 00048000
*   CCADATE=R1;                     /* PUT DATE IN THE CCA           */ 00049000
         STCM  R1,7,CCADATE(CCAPTR)                                0204 00050000
*   TIMETEMP=R0;                    /* SAVE TIME STAMP               */ 00051000
         ST    R0,TIMETEMP                                         0205 00052000
*   RFY                                                            0206 00053000
*    (R0,                                                          0206 00054000
*     R1) UNRSTD;                   /* RELEASE REGS                  */ 00055000
*   CCATIME=TIMETEMP(1:3);          /* SAVE TIME IN CCA              */ 00056000
         MVC   CCATIME(3,CCAPTR),TIMETEMP                          0207 00057000
*   CCAFMID='';                     /* INIT FMID TO BLANK            */ 00058000
         MVI   CCAFMID(CCAPTR),C' '                                0208 00059000
         MVC   CCAFMID+1(6,CCAPTR),CCAFMID(CCAPTR)                 0208 00060000
*   HMASMMGP=''B;                   /* ZERO MSG PARM                 */ 00061000
         XC    HMASMMGP(24),HMASMMGP                               0209 00062000
*   MGPPRINT=ON;                    /* ALL MSG TO PRINTER            */ 00063000
*   MGPHLDS=ON;                     /* ALL MSG TO LOG                */ 00064000
         OI    MGPPRINT,B'10010000'                                0211 00065000
         EJECT                                                          00066000
*                                                                  0212 00067000
*   /*****************************************************************/ 00068000
*   /*                                                               */ 00069000
*   /* CHECK FOR SMPOUT ANS SMPLOG DD CARDS                          */ 00070000
*   /*                                                               */ 00071000
*   /*****************************************************************/ 00072000
*                                                                  0212 00073000
*   DEVDDNAM=CCADSIDA(IOPPRINT);    /*                               */ 00074000
         L     @10,CCADSAD(,CCAPTR)                                0212 00075000
         MVC   DEVDDNAM(8),CCADSIDA+80(@10)                        0212 00076000
*   GEN(DEVTYPE DEVDDNAM,DEVADDR)                                  0213 00077000
*   REFS(DEVDDNAM,DEVADDR);         /* SMPOUT PRESENT?               */ 00078000
         DEVTYPE DEVDDNAM,DEVADDR                                       00079000
*   RFY                             /*                               */ 00080000
*     RTNCODE RSTD;                 /*                               */ 00081000
*   IF RTNCODE^=ZERO                /* PRESENT?                      */ 00082000
*     THEN                          /* NO - ERROR STOP SMP           */ 00083000
         LTR   RTNCODE,RTNCODE                                     0215 00084000
         BZ    @RF00215                                            0215 00085000
*     CCAOUTNG=ON;                  /*                               */ 00086000
         OI    CCAOUTNG(CCAPTR),B'01000000'                        0216 00087000
*   ELSE                            /*                               */ 00088000
*     CCAOUTP=ON;                   /*                               */ 00089000
         B     @RC00215                                            0217 00090000
@RF00215 OI    CCAOUTP(CCAPTR),B'00000010'                         0217 00091000
*   RFY                             /*                               */ 00092000
*     RTNCODE UNRSTD;               /*                               */ 00093000
@RC00215 DS    0H                                                  0219 00094000
*   DEVDDNAM=CCADSIDA(IOPHLDS);     /*                               */ 00095000
         L     @10,CCADSAD(,CCAPTR)                                0219 00096000
         MVC   DEVDDNAM(8),CCADSIDA(@10)                           0219 00097000
*   GEN(DEVTYPE DEVDDNAM,DEVADDR)                                  0220 00098000
*   REFS(DEVDDNAM,DEVADDR);         /* SMPLOG PRESENT?               */ 00099000
         DEVTYPE DEVDDNAM,DEVADDR                                       00100000
*   RFY                             /*                               */ 00101000
*     RTNCODE RSTD;                 /*                               */ 00102000
*   IF RTNCODE^=ZERO                /* PRESENT?                      */ 00103000
*     THEN                          /* NO - ERROR STOP SMP           */ 00104000
         LTR   RTNCODE,RTNCODE                                     0222 00105000
         BZ    @RF00222                                            0222 00106000
*     CCALOGNG=ON;                  /*                               */ 00107000
         OI    CCALOGNG(CCAPTR),B'10000000'                        0223 00108000
*   ELSE                            /*                               */ 00109000
*     CCALOGP=ON;                   /*                               */ 00110000
         B     @RC00222                                            0224 00111000
@RF00222 OI    CCALOGP(CCAPTR),B'00000001'                         0224 00112000
*   RFY                             /*                               */ 00113000
*     RTNCODE UNRSTD;               /*                               */ 00114000
*                                                                  0225 00115000
@RC00222 DS    0H                                                  0226 00116000
*   /*****************************************************************/ 00117000
*   /*                                                               */ 00118000
*   /* IF NO SMPOUT DD CARD ISSUE MESSAGE                            */ 00119000
*   /*                                                               */ 00120000
*   /*****************************************************************/ 00121000
*                                                                  0226 00122000
*   IF CCAOUTNG=ON                  /* IF NO SMPOUT                  */ 00123000
*     THEN                          /*                               */ 00124000
         TM    CCAOUTNG(CCAPTR),B'01000000'                        0226 00125000
         BNO   @RF00226                                            0226 00126000
*     DO;                           /*                               */ 00127000
*       MGPMGNO1=HMA283I;           /* X8X DDCARD MISSING            */ 00128000
         MVC   MGPMGNO1(2),@CH00524                                0228 00129000
*       MGPVARPT(1)=ADDR(CCADSIDA(IOPPRINT));/*                      */ 00130000
         L     @10,CCADSAD(,CCAPTR)                                0229 00131000
         LA    @10,CCADSIDA+80(,@10)                               0229 00132000
         ST    @10,MGPVARPT                                        0229 00133000
*       MGPTYPE=MGPTERM;            /*                               */ 00134000
         MVI   MGPTYPE,X'05'                                       0230 00135000
*       CALL HMASMMSG(HMASMMGP);    /*                               */ 00136000
         L     @15,@CV01328                                        0231 00137000
         LA    @01,@AL00231                                        0231 00138000
         BALR  @14,@15                                             0231 00139000
*       DSURTNCD=STOPSMP;           /*                               */ 00140000
         MVI   DSURTNCD,X'10'                                      0232 00141000
*     END;                          /*                               */ 00142000
*                                                                  0233 00143000
*   /*****************************************************************/ 00144000
*   /*                                                               */ 00145000
*   /* IF NO SMPLOG DD CARD ISSUE MESSAGE                            */ 00146000
*   /*                                                               */ 00147000
*   /*****************************************************************/ 00148000
*                                                                  0234 00149000
*   IF CCALOGNG=ON                  /* IF NO SMPLOG                  */ 00150000
*     THEN                          /*                               */ 00151000
@RF00226 TM    CCALOGNG(CCAPTR),B'10000000'                        0234 00152000
         BNO   @RF00234                                            0234 00153000
*     DO;                           /*                               */ 00154000
*       MGPMGNO1=HMA283I;           /* X8X DDCARD MISSING            */ 00155000
         MVC   MGPMGNO1(2),@CH00524                                0236 00156000
*       MGPVARPT(1)=ADDR(CCADSIDA(IOPHLDS));/*                       */ 00157000
         L     @10,CCADSAD(,CCAPTR)                                0237 00158000
         ST    @10,MGPVARPT                                        0237 00159000
*       MGPTYPE=MGPTERM;            /*                               */ 00160000
         MVI   MGPTYPE,X'05'                                       0238 00161000
*       CALL HMASMMSG(HMASMMGP);    /*                               */ 00162000
         L     @15,@CV01328                                        0239 00163000
         LA    @01,@AL00239                                        0239 00164000
         BALR  @14,@15                                             0239 00165000
*       DSURTNCD=STOPSMP;           /*                               */ 00166000
         MVI   DSURTNCD,X'10'                                      0240 00167000
*     END;                          /*                               */ 00168000
         EJECT                                                          00169000
*                                                                  0242 00170000
*   /*****************************************************************/ 00171000
*   /*                                                               */ 00172000
*   /* SET UP TO SCAN INPUT PARM LIST. IF NONE SPECIFIED, SKIP SCAN  */ 00173000
*   /* ENTERS SUBROUTINES BELOW TO SAVE VALUES OBTAINED              */ 00174000
*   /*                                                               */ 00175000
*   /*****************************************************************/ 00176000
*                                                                  0242 00177000
*   IF DSUPLEN^=ZERO                /* ANY PARMS ON EXEC STMT?       */ 00178000
*       &DSURTNCD=ZERO              /*                               */ 00179000
*     THEN                          /* YES - SCAN FOR DATA           */ 00180000
@RF00234 L     @10,@PC00001                                        0242 00181000
         LH    @06,DSUPLEN(,@10)                                   0242 00182000
         LTR   @06,@06                                             0242 00183000
         BZ    @RF00242                                            0242 00184000
         CLI   DSURTNCD,0                                          0242 00185000
         BNE   @RF00242                                            0242 00186000
*     DO;                           /* USING SCAN ROUTINE            */ 00187000
*       PRMFLGS=OFF;                /* INIT PARM FLAGS       @Z40SP00*/ 00188000
         MVI   PRMFLGS,B'00000000'                                 0244 00189000
*       EXECPARM='';                /*                               */ 00190000
         MVI   EXECPARM,C' '                                       0245 00191000
         MVC   EXECPARM+1(101),EXECPARM                            0245 00192000
*       QUOTE1=QUOTE;               /*                               */ 00193000
         MVI   QUOTE1,C''''                                        0246 00194000
*       PMLEN=MIN(DSUPLEN,100);     /*                               */ 00195000
         LA    @15,100                                             0247 00196000
         CR    @06,@15                                             0247 00197000
         BNH   *+6                                                      00198000
         LR    @06,@15                                             0247 00199000
         ST    @06,PMLEN                                           0247 00200000
*       EXECDATA(1:PMLEN)=DSUPDATA(1:PMLEN);/* MOVE PARM             */ 00201000
         LR    @15,@06                                             0248 00202000
         BCTR  @15,0                                               0248 00203000
         EX    @15,@SM01450                                        0248 00204000
*       EXECDATA(PMLEN+1)=QUOTE;    /*                               */ 00205000
         LA    @10,EXECDATA(@06)                                   0249 00206000
         MVI   0(@10),C''''                                        0249 00207000
*       MGPCLEAR=''B;               /*                               */ 00208000
         XC    MGPCLEAR(6),MGPCLEAR                                0250 00209000
*       MGPMGNO1=HMA424I;           /* HMASMP EXEC PARMS = X100X     */ 00210000
         MVC   MGPMGNO1(2),@CH01340                                0251 00211000
*       MGPVARPT(1)=ADDR(EXECPARM); /*                               */ 00212000
         LA    @10,EXECPARM                                        0252 00213000
         ST    @10,MGPVARPT                                        0252 00214000
*       MGPTYPE=MGPINFO;            /*                               */ 00215000
         MVI   MGPTYPE,X'01'                                       0253 00216000
*       CALL HMASMMSG(HMASMMGP);    /*                               */ 00217000
         L     @15,@CV01328                                        0254 00218000
         LA    @01,@AL00254                                        0254 00219000
         BALR  @14,@15                                             0254 00220000
*       HMASMSCP=''B;               /* ZERO SCP PARM                 */ 00221000
         XC    HMASMSCP(26),HMASMSCP                               0255 00222000
*       SCPCHAR=ADDR(DSUPDATA);     /* POINT TO PARM LIST            */ 00223000
         L     @10,@PC00001                                        0256 00224000
         LA    @06,DSUPDATA(,@10)                                  0256 00225000
         ST    @06,SCPCHAR                                         0256 00226000
*       SCPSRCH=ADPRMSCN;           /* SET START ADDR        @YA07510*/ 00227000
         MVC   SCPSRCH(4),ADPRMSCN                                 0257 00228000
*       SCPINLN=DSUPLEN;            /* SET STRING LENGTH             */ 00229000
         MVC   SCPINLN(2),DSUPLEN(@10)                             0258 00230000
*       CALL HMASMSCN(HMASMSCP);    /* SCAN PARM LIST                */ 00231000
         L     @15,@CV01329                                        0259 00232000
         LA    @01,@AL00259                                        0259 00233000
         BALR  @14,@15                                             0259 00234000
*       IF SCPRET^=SCPGOOD          /* SYNTAX ERROR?                 */ 00235000
*         THEN                      /* YES - INCORRECT PARM LIST     */ 00236000
         CLI   SCPRET,0                                            0260 00237000
         BE    @RF00260                                            0260 00238000
*         DO;                       /* ISSUE ERROR MESSAGE           */ 00239000
*           ERRCOL=SCPCHAR-ADDR(DSUPDATA)+1;/* SYNTAX ERR COL        */ 00240000
         L     @10,@PC00001                                        0262 00241000
         LA    @10,DSUPDATA(,@10)                                  0262 00242000
         LCR   @10,@10                                             0262 00243000
         AL    @10,SCPCHAR                                         0262 00244000
         AH    @10,@CH00089                                        0262 00245000
         STH   @10,ERRCOL                                          0262 00246000
*           CVD(ERRCOL,DBLWRD);     /*                               */ 00247000
         CVD   @10,DBLWRD                                          0263 00248000
*           UNPK(CHARCOL,DBLWRD);   /*                               */ 00249000
         UNPK  CHARCOL(2),DBLWRD(8)                                0264 00250000
*           LASTDIG=LASTDIG|MAKEPRNT;/*                              */ 00251000
         OI    LASTDIG,X'F0'                                       0265 00252000
*           MGPCLEAR=MGPCLEAR&&MGPCLEAR;/* ZERO MSG PARM     @Z40SP00*/ 00253000
         XC    MGPCLEAR(6),MGPCLEAR                                0266 00254000
*           MGPTYPE=MGPTERM;        /* SET SEVERITY          @ZD00001*/ 00255000
         MVI   MGPTYPE,X'05'                                       0267 00256000
*           MGPMGNO1=HMA203I;       /* SYNTAX ERROR IN               */ 00257000
         MVC   MGPMGNO1(2),@CH00042                                0268 00258000
*           MGPMGNO2=PART020;       /* EXEC PARM                     */ 00259000
         MVC   MGPMGNO2(2),@CH00358                                0269 00260000
*           MGPMGNO3=PART026;       /* AT COL XX                     */ 00261000
         MVC   MGPMGNO3(2),@CH00467                                0270 00262000
*           MGPVARPT(1)=ADDR(CHARCOL);/*                             */ 00263000
         LA    @10,CHARCOL                                         0271 00264000
         ST    @10,MGPVARPT                                        0271 00265000
*           CALL HMASMMSG(HMASMMGP);/* ISSUE MESSAGE                 */ 00266000
         L     @15,@CV01328                                        0272 00267000
         LA    @01,@AL00272                                        0272 00268000
         BALR  @14,@15                                             0272 00269000
*           DSURTNCD=STOPSMP;       /* SET RETURN CODE       @YA07506*/ 00270000
         MVI   DSURTNCD,X'10'                                      0273 00271000
*         END;                                                     0274 00272000
*     END;                                                         0275 00273000
@RF00260 DS    0H                                                  0276 00274000
         EJECT                                                          00275000
*                                                                  0276 00276000
*   /*****************************************************************/ 00277000
*   /*                                                               */ 00278000
*   /* IF DATE NOT SPECIFIED ON EXEC THEN ASK OPERATOR FOR DATE TO   */ 00279000
*   /* USE VIA CALL TO HMASMMSG(MSG WILL DO WTO FOR THIS SPECIAL MSG */ 00280000
*   /* NUMBER). INSURE THAT DATE ENTERED ON PARM OR DATE RETURNED BY */ 00281000
*   /* OPERATOR IS VALID. IF NOT ISSUE ANOTHER REQUEST TO OPERATOR.  */ 00282000
*   /* CONTINUE TILL VALID REPLY ENTERED.                    @Z40SP00*/ 00283000
*   /*                                                               */ 00284000
*   /*****************************************************************/ 00285000
*                                                                  0276 00286000
*   IF DSURTNCD=ZERO                /* IF PREV FUNCTIONS OK          */ 00287000
*     THEN                          /*                               */ 00288000
@RF00242 CLI   DSURTNCD,0                                          0276 00289000
         BNE   @RF00276                                            0276 00290000
*     DO;                           /*                               */ 00291000
*       MGPMGNO1=HMA399D;           /* INDICATE WTOR MESSAGE         */ 00292000
         MVC   MGPMGNO1(2),@CH01338                                0278 00293000
*       MGPVARPT(1)=ADDR(DATEOP);   /* POINT TO REPLY AREA           */ 00294000
         LA    @10,DATEOP                                          0279 00295000
         ST    @10,MGPVARPT                                        0279 00296000
*       MGPVARPT(2)=LENGTH(DATEOP); /* REPLY LENGTH                  */ 00297000
         MVC   MGPVARPT+4(4),@CF00132                              0280 00298000
*       MGPPRINT=OFF;               /* NOT TO PRINTER                */ 00299000
*       MGPHLDS=OFF;                /* NOT TO LOG                    */ 00300000
*       MGPWTOR=ON;                 /* BUT TO OPERATOR               */ 00301000
         OI    MGPWTOR,B'00001000'                                 0283 00302000
         NI    MGPPRINT,B'01101111'                                0283 00303000
*       MGPTYPE=MGPDEC;             /*                       @Z67SP00*/ 00304000
         MVI   MGPTYPE,X'06'                                       0284 00305000
*       GO TO TSTDAT;               /* BR AROUND MSG FIRST TINE THRU.   00306000
*                                      THERE SHOULD BE EITHER THE  0285 00307000
*                                      DATA ENTERED AS PARM OR BLANKS   00308000
*                                      IN DATEOP. BLANKS INDICATE NO    00309000
*                                      PARM DATE ENTERED AND WILL  0285 00310000
*                                      CAUSE ERR ON NUMERIC CHECK  0285 00311000
*                                      WHICH WILL CAUSE ISSUE OF DATE   00312000
*                                      REQUEST               @OS64458*/ 00313000
         B     TSTDAT                                              0285 00314000
*DATEMSG:                                                          0286 00315000
*       CALL HMASMMSG(HMASMMGP);    /* ASK OPERATOR FOR THE DATE     */ 00316000
DATEMSG  L     @15,@CV01328                                        0286 00317000
         LA    @01,@AL00286                                        0286 00318000
         BALR  @14,@15                                             0286 00319000
*       DATEOP(1)=DATEOP(1)|UPCASE; /* MAKE DATE UPPER CASE          */ 00320000
         OI    DATEOP,X'40'                                        0287 00321000
*TSTDAT:                            /*                       @OS64458*/ 00322000
*       IF DATEOP(1)^=USEIT         /* DID HE ENTER A NEW DATE?      */ 00323000
*         THEN                      /* YES - UPDATE THE CCA          */ 00324000
TSTDAT   CLI   DATEOP,C'U'                                         0288 00325000
         BE    @RF00288                                            0288 00326000
*         DO;                                                      0289 00327000
*           IF(DATEOP&CHAR0)^=CHAR0 /* DATE NUMERIC?         @OS64458*/ 00328000
*             THEN                  /* NO - THEN ERR         @OS64458*/ 00329000
         MVC   @TS00001(5),DATEOP                                  0290 00330000
         NC    @TS00001(5),@CC01355                                0290 00331000
         CLC   @TS00001(5),@CC01355                                0290 00332000
         BE    @RF00290                                            0290 00333000
*             DO;                   /*                       @OS64458*/ 00334000
*               DATEOP='';          /* RE-INIT REPLY AREA TO BLANKS     00335000
*                                                            @OS64458*/ 00336000
         MVI   DATEOP,C' '                                         0292 00337000
         MVC   DATEOP+1(4),DATEOP                                  0292 00338000
*               GO TO DATEMSG;      /* GO TO RE-ISSUE TOW MSG      0293 00339000
*                                                            @OS64458*/ 00340000
         B     DATEMSG                                             0293 00341000
*             END;                  /* END DATE BAD GROUP    @OS64458*/ 00342000
*           PACK(CCADATE,DATEOP);   /* PUT THE PROPER DATE IN CCA    */ 00343000
@RF00290 PACK  CCADATE(3,CCAPTR),DATEOP(5)                         0295 00344000
*         END;                                                     0296 00345000
*       MGPPRINT=ON;                /* MSG TO PRINTER                */ 00346000
@RF00288 DS    0H                                                  0298 00347000
*       MGPHLDS=ON;                 /* MSG TO LOG                    */ 00348000
*       MGPWTOR=OFF;                /* BUT NOT TO OPERATOR           */ 00349000
         OI    MGPPRINT,B'10010000'                                0299 00350000
         NI    MGPWTOR,B'11110111'                                 0299 00351000
*     END;                          /* END GET DATE CODE             */ 00352000
         EJECT                                                          00353000
*                                                                  0301 00354000
*   /*****************************************************************/ 00355000
*   /*                                                               */ 00356000
*   /* CALL ROUTINE TO OPEN ALL DATA SET REQUIRING DATA TO BE SET UP */ 00357000
*   /* IN THE CCA                                                    */ 00358000
*   /*                                                               */ 00359000
*   /*****************************************************************/ 00360000
*                                                                  0301 00361000
*   IF DSURTNCD=ZERO                /*                               */ 00362000
*     THEN                          /*                               */ 00363000
@RF00276 CLI   DSURTNCD,0                                          0301 00364000
         BNE   @RF00301                                            0301 00365000
*     DO;                           /*                               */ 00366000
*       CALL DSUOPEN;               /* DO OPENS                      */ 00367000
         BAL   @14,DSUOPEN                                         0303 00368000
*       RFY                                                        0304 00369000
*         RTNCODE RSTD;             /*                               */ 00370000
*       DSURTNCD=MAX(DSURTNCD,RTNCODE);/* SAVE RC                    */ 00371000
         SLR   @14,@14                                             0305 00372000
         IC    @14,DSURTNCD                                        0305 00373000
         CR    @14,RTNCODE                                         0305 00374000
         BNL   *+6                                                      00375000
         LR    @14,RTNCODE                                         0305 00376000
         STC   @14,DSURTNCD                                        0305 00377000
*       RFY                                                        0306 00378000
*         RTNCODE UNRSTD;           /*                               */ 00379000
*     END;                          /*                               */ 00380000
*                                                                  0307 00381000
*   /*****************************************************************/ 00382000
*   /*                                                               */ 00383000
*   /* CALL ROUTINE TO GETMAIN I/O BUFFERS FOR ALL OPEN DATA SETS    */ 00384000
*   /*                                                               */ 00385000
*   /*****************************************************************/ 00386000
*                                                                  0308 00387000
*   IF DSURTNCD=ZERO                /*                               */ 00388000
*     THEN                          /*                               */ 00389000
@RF00301 CLI   DSURTNCD,0                                          0308 00390000
         BNE   @RF00308                                            0308 00391000
*     DO;                           /*                               */ 00392000
*       CALL DSUGETMN;              /* DO OPENS                      */ 00393000
         BAL   @14,DSUGETMN                                        0310 00394000
*       RFY                                                        0311 00395000
*         RTNCODE RSTD;             /*                               */ 00396000
*       DSURTNCD=MAX(DSURTNCD,RTNCODE);/* SAVE RC                    */ 00397000
         SLR   @14,@14                                             0312 00398000
         IC    @14,DSURTNCD                                        0312 00399000
         CR    @14,RTNCODE                                         0312 00400000
         BNL   *+6                                                      00401000
         LR    @14,RTNCODE                                         0312 00402000
         STC   @14,DSURTNCD                                        0312 00403000
*       RFY                                                        0313 00404000
*         RTNCODE UNRSTD;           /*                               */ 00405000
*     END;                          /*                               */ 00406000
         EJECT                                                          00407000
*                                                                  0315 00408000
*   /*****************************************************************/ 00409000
*   /*                                                               */ 00410000
*   /* BLDL THE SYSTEM ENTRY IN THE CDS. IF FOUND, THEN THE CCA IS   */ 00411000
*   /* UPDATED WITH INFORMATION FROM THE CDS SYSTEM DIR.             */ 00412000
*   /*                                                               */ 00413000
*   /*****************************************************************/ 00414000
*                                                                  0315 00415000
*   IF DSURTNCD=ZERO                /*                               */ 00416000
*     THEN                          /*                               */ 00417000
@RF00308 CLI   DSURTNCD,0                                          0315 00418000
         BNE   @RF00315                                            0315 00419000
*     DO;                           /*                               */ 00420000
*       CCAIOPTR=ZERO;              /* SET IOPPTR TO ZERO SO THAT  0317 00421000
*                                      WHEN DS1 IS CALLED IT WILL NOT   00422000
*                                      ATTEMP TO FREE EXISTING IOP.     00423000
*                                      EXISTING ONE IF THE FIXED   0317 00424000
*                                      LENGTH ONE PASSED FROM      0317 00425000
*                                      HMASMDRV                      */ 00426000
         SLR   @10,@10                                             0317 00427000
         ST    @10,CCAIOPTR(,CCAPTR)                               0317 00428000
*       IOPPTR=CCAIOPCS;            /* IOP FOR CDS SYSTEM            */ 00429000
         L     IOPPTR,CCAIOPCS(,CCAPTR)                            0318 00430000
*       IOPDSID=IOPCDS;             /*                               */ 00431000
         MVI   IOPDSID(IOPPTR),X'02'                               0319 00432000
*       IOPFUNCT=IOPBLDL;           /* BLDL FOR DIRECTORY DATA       */ 00433000
         MVI   IOPFUNCT(IOPPTR),X'04'                              0320 00434000
*       IOPTYPE=IOPSYS;             /* SYSTEM ENTRY                  */ 00435000
         MVI   IOPTYPE(IOPPTR),X'07'                               0321 00436000
*       IOPRETRN=IOPNTFND;          /* INIT RC SO IF BLDL NOT DONE 0322 00437000
*                                      DS1 WILL TREAT AS NOT FOUND   */ 00438000
         MVI   IOPRETRN(IOPPTR),X'04'                              0322 00439000
*       IF CCACDSP=ON               /* IF CDS DD PRESENT             */ 00440000
*         THEN                      /* THEN                          */ 00441000
         TM    CCACDSP(CCAPTR),B'10000000'                         0323 00442000
         BNO   @RF00323                                            0323 00443000
*         DO;                       /* LOC SYSTEM ENTRY              */ 00444000
*           CALL HMASMIO(HMASMIOP); /* BLDL SYSTEM ENTRY             */ 00445000
         ST    IOPPTR,@AL00001                                     0325 00446000
         L     @15,@CV01327                                        0325 00447000
         LA    @01,@AL00001                                        0325 00448000
         BALR  @14,@15                                             0325 00449000
*           IF IOPRETRN>IOPNTFND    /* IF ERR IN BLDL                */ 00450000
*             THEN                  /*                               */ 00451000
         CLI   IOPRETRN(IOPPTR),4                                  0326 00452000
         BNH   @RF00326                                            0326 00453000
*             DSURTNCD=MAX(DSURTNCD,IOPRETRN);/* SAVE RC             */ 00454000
         SLR   @10,@10                                             0327 00455000
         IC    @10,DSURTNCD                                        0327 00456000
         SLR   @06,@06                                             0327 00457000
         IC    @06,IOPRETRN(,IOPPTR)                               0327 00458000
         CR    @10,@06                                             0327 00459000
         BNL   *+6                                                      00460000
         LR    @10,@06                                             0327 00461000
         STC   @10,DSURTNCD                                        0327 00462000
*         END;                      /*                               */ 00463000
@RF00326 DS    0H                                                  0329 00464000
*       IF IOPRETRN<=IOPNTFND       /* IF NO SERIOS ERROR IN BLDL    */ 00465000
*         THEN                      /*                               */ 00466000
@RF00323 CLI   IOPRETRN(IOPPTR),4                                  0329 00467000
         BH    @RF00329                                            0329 00468000
*         DO;                       /*                               */ 00469000
*           CALL HMASMDS1(HMASMIOP,'Y');/* PASS IOP FOR CDS WITH   0331 00470000
*                                      INDICATOR THAT IOP IS PRIMED  */ 00471000
         ST    IOPPTR,@AL00001                                     0331 00472000
         LA    @10,@CC01406                                        0331 00473000
         ST    @10,@AL00001+4                                      0331 00474000
         L     @15,@CV01326                                        0331 00475000
         LA    @01,@AL00001                                        0331 00476000
         BALR  @14,@15                                             0331 00477000
*           RFY                                                    0332 00478000
*             RTNCODE RSTD;         /*                               */ 00479000
*           DSURTNCD=MAX(DSURTNCD,RTNCODE);/* SAVE RC                */ 00480000
         SLR   @14,@14                                             0333 00481000
         IC    @14,DSURTNCD                                        0333 00482000
         CR    @14,RTNCODE                                         0333 00483000
         BNL   *+6                                                      00484000
         LR    @14,RTNCODE                                         0333 00485000
         STC   @14,DSURTNCD                                        0333 00486000
*           RFY                                                    0334 00487000
*             RTNCODE UNRSTD;       /*                               */ 00488000
*         END;                      /*                               */ 00489000
*     END;                          /*                               */ 00490000
*                                                                  0336 00491000
@RF00329 DS    0H                                                  0337 00492000
*   /*****************************************************************/ 00493000
*   /*                                                               */ 00494000
*   /* BLDL THE SYSTEM ENTRY IN THE ACDS. IF FOUND, THEN THE CCA IS  */ 00495000
*   /* UPDATED WITH INFORMATION FROM THE ACDS SYSTEM DIR.            */ 00496000
*   /*                                                               */ 00497000
*   /*****************************************************************/ 00498000
*                                                                  0337 00499000
*   IF DSURTNCD=ZERO                /*                               */ 00500000
*     THEN                          /*                               */ 00501000
@RF00315 CLI   DSURTNCD,0                                          0337 00502000
         BNE   @RF00337                                            0337 00503000
*     DO;                           /*                               */ 00504000
*       IOPPTR=CCAIOPAS;            /* IOP FOR ACDS SYSTEM           */ 00505000
         L     IOPPTR,CCAIOPAS(,CCAPTR)                            0339 00506000
*       IOPDSID=IOPACDS;            /*                               */ 00507000
         MVI   IOPDSID(IOPPTR),X'0C'                               0340 00508000
*       IOPFUNCT=IOPBLDL;           /* BLDL FOR DIRECTORY DATA       */ 00509000
         MVI   IOPFUNCT(IOPPTR),X'04'                              0341 00510000
*       IOPTYPE=IOPSYS;             /* SYSTEM ENTRY                  */ 00511000
         MVI   IOPTYPE(IOPPTR),X'07'                               0342 00512000
*       IOPRETRN=IOPNTFND;          /* INIT RC SO IF BLDL NOT DONE 0343 00513000
*                                      DS1 WILL TREAT AS NOT FOUND   */ 00514000
         MVI   IOPRETRN(IOPPTR),X'04'                              0343 00515000
*       IF CCAACDSP=ON              /* IF ACDS DD PRESENT            */ 00516000
*         THEN                      /* THEN                          */ 00517000
         TM    CCAACDSP(CCAPTR),B'01000000'                        0344 00518000
         BNO   @RF00344                                            0344 00519000
*         DO;                       /* LOC SYSTEM ENTRY              */ 00520000
*           IOPBUFAD=SAVBUFAD;      /* SET BUFFER ADDR               */ 00521000
         MVC   IOPBUFAD(4,IOPPTR),SAVBUFAD                         0346 00522000
*           CALL HMASMIO(HMASMIOP); /* FLBL SYSTEM ENTRY             */ 00523000
         ST    IOPPTR,@AL00001                                     0347 00524000
         L     @15,@CV01327                                        0347 00525000
         LA    @01,@AL00001                                        0347 00526000
         BALR  @14,@15                                             0347 00527000
*           IF IOPRETRN>IOPNTFND    /* IF ERR IN BLDL                */ 00528000
*             THEN                  /*                               */ 00529000
         CLI   IOPRETRN(IOPPTR),4                                  0348 00530000
         BNH   @RF00348                                            0348 00531000
*             DSURTNCD=MAX(DSURTNCD,IOPRETRN);/* SAVE RC             */ 00532000
         SLR   @10,@10                                             0349 00533000
         IC    @10,DSURTNCD                                        0349 00534000
         SLR   @06,@06                                             0349 00535000
         IC    @06,IOPRETRN(,IOPPTR)                               0349 00536000
         CR    @10,@06                                             0349 00537000
         BNL   *+6                                                      00538000
         LR    @10,@06                                             0349 00539000
         STC   @10,DSURTNCD                                        0349 00540000
*         END;                      /*                               */ 00541000
@RF00348 DS    0H                                                  0351 00542000
*       IF IOPRETRN<=IOPNTFND       /* IF NO SERIOS ERROR IN BLDL    */ 00543000
*         THEN                      /*                               */ 00544000
@RF00344 CLI   IOPRETRN(IOPPTR),4                                  0351 00545000
         BH    @RF00351                                            0351 00546000
*         DO;                       /*                               */ 00547000
*           CALL HMASMDS1(HMASMIOP,'Y');/* PASS IOP FOR ACDS WITH  0353 00548000
*                                      INDICATOR THAT IOP IS PRIMED  */ 00549000
         ST    IOPPTR,@AL00001                                     0353 00550000
         LA    @10,@CC01406                                        0353 00551000
         ST    @10,@AL00001+4                                      0353 00552000
         L     @15,@CV01326                                        0353 00553000
         LA    @01,@AL00001                                        0353 00554000
         BALR  @14,@15                                             0353 00555000
*           RFY                                                    0354 00556000
*             RTNCODE RSTD;         /*                               */ 00557000
*           DSURTNCD=MAX(DSURTNCD,RTNCODE);/* SAVE RC                */ 00558000
         SLR   @14,@14                                             0355 00559000
         IC    @14,DSURTNCD                                        0355 00560000
         CR    @14,RTNCODE                                         0355 00561000
         BNL   *+6                                                      00562000
         LR    @14,RTNCODE                                         0355 00563000
         STC   @14,DSURTNCD                                        0355 00564000
*           RFY                                                    0356 00565000
*             RTNCODE UNRSTD;       /*                               */ 00566000
*         END;                      /*                               */ 00567000
*     END;                          /*                               */ 00568000
*                                                                  0358 00569000
@RF00351 DS    0H                                                  0359 00570000
*   /*****************************************************************/ 00571000
*   /*                                                               */ 00572000
*   /* BLDL THE SYSTEM ENTRY IN THE PTS . IF FOUND, THEN THE CCA IS  */ 00573000
*   /* UPDATED WITH INFORMATION FROM THE ACDS SYSTEM DIR.            */ 00574000
*   /*                                                               */ 00575000
*   /*****************************************************************/ 00576000
*                                                                  0359 00577000
*   IF DSURTNCD=ZERO                /*                               */ 00578000
*     THEN                          /*                               */ 00579000
@RF00337 CLI   DSURTNCD,0                                          0359 00580000
         BNE   @RF00359                                            0359 00581000
*     DO;                           /*                               */ 00582000
*       IF CCAIOPTR^=ZERO           /* IF IOP GETMAIN BY DS1 DUE     */ 00583000
*         THEN                      /* TO CDS/ACDS PEMAX THEN        */ 00584000
         L     @10,CCAIOPTR(,CCAPTR)                               0361 00585000
         LTR   @10,@10                                             0361 00586000
         BZ    @RF00361                                            0361 00587000
*         IOPPTR=CCAIOPTR;          /* USE IT                        */ 00588000
         LR    IOPPTR,@10                                          0362 00589000
*       ELSE                        /* IF NONE OBTAINED YET USE THE  */ 00590000
*         IOPPTR=SAVIOPTR;          /* ONE PASSED BY HMASMDRV        */ 00591000
         B     @RC00361                                            0363 00592000
@RF00361 L     IOPPTR,SAVIOPTR                                     0363 00593000
*       IOPDSID=IOPPTS;             /*                               */ 00594000
@RC00361 MVI   IOPDSID(IOPPTR),X'06'                               0364 00595000
*       IOPFUNCT=IOPBLDL;           /* BLDL FOR DIRECTORY DATA       */ 00596000
         MVI   IOPFUNCT(IOPPTR),X'04'                              0365 00597000
*       IOPTYPE=IOPSYS;             /* SYSTEM ENTRY                  */ 00598000
         MVI   IOPTYPE(IOPPTR),X'07'                               0366 00599000
*       IOPRETRN=IOPNTFND;          /* INIT RC SO IF BLDL NOT DONE 0367 00600000
*                                      DS1 WILL TREAT AS NOT FOUND   */ 00601000
         MVI   IOPRETRN(IOPPTR),X'04'                              0367 00602000
*       IF CCAPTSP=ON               /* IF PTS DD PRESENT             */ 00603000
*         THEN                      /* THEN                          */ 00604000
         TM    CCAPTSP(CCAPTR),B'00010000'                         0368 00605000
         BNO   @RF00368                                            0368 00606000
*         DO;                       /* LOC SYSTEM ENTRY              */ 00607000
*           IOPBUFAD=SAVBUFAD;      /* SET BUFFER ADDR               */ 00608000
         MVC   IOPBUFAD(4,IOPPTR),SAVBUFAD                         0370 00609000
*           CALL HMASMIO(HMASMIOP); /* FLBL SYSTEM ENTRY             */ 00610000
         ST    IOPPTR,@AL00001                                     0371 00611000
         L     @15,@CV01327                                        0371 00612000
         LA    @01,@AL00001                                        0371 00613000
         BALR  @14,@15                                             0371 00614000
*           IF IOPRETRN>IOPNTFND    /* IF ERR IN BLDL                */ 00615000
*             THEN                  /*                               */ 00616000
         CLI   IOPRETRN(IOPPTR),4                                  0372 00617000
         BNH   @RF00372                                            0372 00618000
*             DSURTNCD=MAX(DSURTNCD,IOPRETRN);/* SAVE RC             */ 00619000
         SLR   @10,@10                                             0373 00620000
         IC    @10,DSURTNCD                                        0373 00621000
         SLR   @06,@06                                             0373 00622000
         IC    @06,IOPRETRN(,IOPPTR)                               0373 00623000
         CR    @10,@06                                             0373 00624000
         BNL   *+6                                                      00625000
         LR    @10,@06                                             0373 00626000
         STC   @10,DSURTNCD                                        0373 00627000
*         END;                      /*                               */ 00628000
@RF00372 DS    0H                                                  0375 00629000
*       IF IOPRETRN<=IOPNTFND       /* IF NO SERIOS ERROR IN BLDL    */ 00630000
*         THEN                      /*                               */ 00631000
@RF00368 CLI   IOPRETRN(IOPPTR),4                                  0375 00632000
         BH    @RF00375                                            0375 00633000
*         DO;                       /*                               */ 00634000
*           CALL HMASMDS1(HMASMIOP,'Y');/* PASS IOP FOR PTS WITH   0377 00635000
*                                      INDICATOR THAT IOP IS PRIMED  */ 00636000
         ST    IOPPTR,@AL00001                                     0377 00637000
         LA    @10,@CC01406                                        0377 00638000
         ST    @10,@AL00001+4                                      0377 00639000
         L     @15,@CV01326                                        0377 00640000
         LA    @01,@AL00001                                        0377 00641000
         BALR  @14,@15                                             0377 00642000
*           RFY                                                    0378 00643000
*             RTNCODE RSTD;         /*                               */ 00644000
*           DSURTNCD=MAX(DSURTNCD,RTNCODE);/* SAVE RC                */ 00645000
         SLR   @14,@14                                             0379 00646000
         IC    @14,DSURTNCD                                        0379 00647000
         CR    @14,RTNCODE                                         0379 00648000
         BNL   *+6                                                      00649000
         LR    @14,RTNCODE                                         0379 00650000
         STC   @14,DSURTNCD                                        0379 00651000
*           RFY                                                    0380 00652000
*             RTNCODE UNRSTD;       /*                               */ 00653000
*         END;                      /*                               */ 00654000
*     END;                          /*                               */ 00655000
@RF00375 DS    0H                                                  0383 00656000
         EJECT                                                          00657000
*                                                                  0383 00658000
*   /*****************************************************************/ 00659000
*   /*                                                               */ 00660000
*   /* LOCATE THE SYSTEM ENTRY IN THE CDS. IF FOUND, THEN THE CCA IS */ 00661000
*   /* UPDATED WITH INFORMATION FROM THE CDS.                        */ 00662000
*   /*                                                               */ 00663000
*   /*****************************************************************/ 00664000
*                                                                  0383 00665000
*   IF DSURTNCD=ZERO                /* IF PREV FUNCTIONS OK          */ 00666000
*       &CCACSYSF=ON                /* AND SYSTEM ENTRY FOUND        */ 00667000
*     THEN                          /*                               */ 00668000
@RF00359 CLI   DSURTNCD,0                                          0383 00669000
         BNE   @RF00383                                            0383 00670000
         TM    CCACSYSF(CCAPTR),B'10000000'                        0383 00671000
         BNO   @RF00383                                            0383 00672000
*     DO;                           /*                               */ 00673000
*       IOPPTR=CCAIOPTR;            /* FULL IOP FOR LOCATE           */ 00674000
         L     IOPPTR,CCAIOPTR(,CCAPTR)                            0385 00675000
*       IOPBUFAD=SAVBUFAD;          /* SET BUFFER ADDR               */ 00676000
         MVC   IOPBUFAD(4,IOPPTR),SAVBUFAD                         0386 00677000
*       IOPDSID=IOPCDS;             /*                               */ 00678000
         MVI   IOPDSID(IOPPTR),X'02'                               0387 00679000
*       CALL HMASMDS1(HMASMIOP,'N');/* PASS IOP FOR CDS WITH       0388 00680000
*                                      INDICATOR THAT IT IS NOT    0388 00681000
*                                      PRIMED                        */ 00682000
         ST    IOPPTR,@AL00001                                     0388 00683000
         LA    @10,@CC01407                                        0388 00684000
         ST    @10,@AL00001+4                                      0388 00685000
         L     @15,@CV01326                                        0388 00686000
         LA    @01,@AL00001                                        0388 00687000
         BALR  @14,@15                                             0388 00688000
*       RFY                                                        0389 00689000
*         RTNCODE RSTD;             /*                               */ 00690000
*       DSURTNCD=MAX(DSURTNCD,RTNCODE);/* SAVE RC                    */ 00691000
         SLR   @14,@14                                             0390 00692000
         IC    @14,DSURTNCD                                        0390 00693000
         CR    @14,RTNCODE                                         0390 00694000
         BNL   *+6                                                      00695000
         LR    @14,RTNCODE                                         0390 00696000
         STC   @14,DSURTNCD                                        0390 00697000
*       RFY                                                        0391 00698000
*         RTNCODE UNRSTD;           /*                               */ 00699000
*     END;                          /*                               */ 00700000
*                                                                  0392 00701000
*   /*****************************************************************/ 00702000
*   /*                                                               */ 00703000
*   /* LOCATE SYSTEM ENTRY ON ACDS AND IF FOUND SET PEMAX TO MAX OF  */ 00704000
*   /* CDS AND ACDS SYSTEM ENTRY PEMAX                               */ 00705000
*   /*                                                               */ 00706000
*   /*****************************************************************/ 00707000
*                                                                  0393 00708000
*   IF DSURTNCD=ZERO                /* IF PREV FUNCTIONS OK          */ 00709000
*       &CCAASYSF=ON                /* AND SYSTEM ENTRY FOUND        */ 00710000
*     THEN                          /*                               */ 00711000
@RF00383 CLI   DSURTNCD,0                                          0393 00712000
         BNE   @RF00393                                            0393 00713000
         TM    CCAASYSF(CCAPTR),B'01000000'                        0393 00714000
         BNO   @RF00393                                            0393 00715000
*     DO;                           /*                               */ 00716000
*       IOPPTR=CCAIOPTR;            /* FULL IOP FOR LOCATE           */ 00717000
         L     IOPPTR,CCAIOPTR(,CCAPTR)                            0395 00718000
*       IOPBUFAD=SAVBUFAD;          /* SET BUFFER ADDR               */ 00719000
         MVC   IOPBUFAD(4,IOPPTR),SAVBUFAD                         0396 00720000
*       IOPDSID=IOPACDS;            /*                               */ 00721000
         MVI   IOPDSID(IOPPTR),X'0C'                               0397 00722000
*       CALL HMASMDS1(HMASMIOP,'N');/* PASS IOP FOR ACDS WITH      0398 00723000
*                                      INDICATOR THAT IT IS NOT    0398 00724000
*                                      PRIMED                        */ 00725000
         ST    IOPPTR,@AL00001                                     0398 00726000
         LA    @10,@CC01407                                        0398 00727000
         ST    @10,@AL00001+4                                      0398 00728000
         L     @15,@CV01326                                        0398 00729000
         LA    @01,@AL00001                                        0398 00730000
         BALR  @14,@15                                             0398 00731000
*       RFY                                                        0399 00732000
*         RTNCODE RSTD;             /*                               */ 00733000
*       DSURTNCD=MAX(DSURTNCD,RTNCODE);/* SAVE RC                    */ 00734000
         SLR   @14,@14                                             0400 00735000
         IC    @14,DSURTNCD                                        0400 00736000
         CR    @14,RTNCODE                                         0400 00737000
         BNL   *+6                                                      00738000
         LR    @14,RTNCODE                                         0400 00739000
         STC   @14,DSURTNCD                                        0400 00740000
*       RFY                                                        0401 00741000
*         RTNCODE UNRSTD;           /*                               */ 00742000
*       IOPPTR=CCAIOPTR;            /* GENERAL IOP                   */ 00743000
         L     IOPPTR,CCAIOPTR(,CCAPTR)                            0402 00744000
*     END;                          /*                               */ 00745000
         EJECT                                                          00746000
*                                                                  0404 00747000
*   /*****************************************************************/ 00748000
*   /*                                                               */ 00749000
*   /* LOCATE SYSTEM ENTRY ON PTS AND IF FOUND SET ANY CCA FIELDS    */ 00750000
*   /* APPLICABLE                                                    */ 00751000
*   /*                                                               */ 00752000
*   /*****************************************************************/ 00753000
*                                                                  0404 00754000
*   IF DSURTNCD=ZERO                /*                               */ 00755000
*       &CCAPSYSF=ON                /* PTS SYSTEM ENTRY FOUND?       */ 00756000
*     THEN                          /*                               */ 00757000
@RF00393 CLI   DSURTNCD,0                                          0404 00758000
         BNE   @RF00404                                            0404 00759000
         TM    CCAPSYSF(CCAPTR),B'00100000'                        0404 00760000
         BNO   @RF00404                                            0404 00761000
*     DO;                           /*                               */ 00762000
*       IOPPTR=CCAIOPTR;            /* FULL IOP ADDR                 */ 00763000
         L     IOPPTR,CCAIOPTR(,CCAPTR)                            0406 00764000
*       IOPBUFAD=SAVBUFAD;          /* SET BUFFER ADDR               */ 00765000
         MVC   IOPBUFAD(4,IOPPTR),SAVBUFAD                         0407 00766000
*       IOPDSID=IOPPTS;             /*                               */ 00767000
         MVI   IOPDSID(IOPPTR),X'06'                               0408 00768000
*       CALL HMASMDS1(HMASMIOP,'N');/* PASS IOP FOR PTS WITH       0409 00769000
*                                      INDICATOR THAT IT IS NOT    0409 00770000
*                                      PRIMED                        */ 00771000
         ST    IOPPTR,@AL00001                                     0409 00772000
         LA    @10,@CC01407                                        0409 00773000
         ST    @10,@AL00001+4                                      0409 00774000
         L     @15,@CV01326                                        0409 00775000
         LA    @01,@AL00001                                        0409 00776000
         BALR  @14,@15                                             0409 00777000
*       RFY                                                        0410 00778000
*         RTNCODE RSTD;             /*                               */ 00779000
*       DSURTNCD=MAX(DSURTNCD,RTNCODE);/* SAVE RC                    */ 00780000
         SLR   @14,@14                                             0411 00781000
         IC    @14,DSURTNCD                                        0411 00782000
         CR    @14,RTNCODE                                         0411 00783000
         BNL   *+6                                                      00784000
         LR    @14,RTNCODE                                         0411 00785000
         STC   @14,DSURTNCD                                        0411 00786000
*       RFY                                                        0412 00787000
*         RTNCODE UNRSTD;           /*                               */ 00788000
*     END;                          /*                               */ 00789000
*                                                                  0413 00790000
*   /*****************************************************************/ 00791000
*   /*                                                               */ 00792000
*   /* IF NEW IOP PTR OBTAINED THEN INSURE THAT BUFAD IN IOP IS OK   */ 00793000
*   /*                                                               */ 00794000
*   /*****************************************************************/ 00795000
*                                                                  0414 00796000
*   IF CCAIOPTR=ZERO                /*                               */ 00797000
*     THEN                          /*                               */ 00798000
@RF00404 ICM   @10,15,CCAIOPTR(CCAPTR)                             0414 00799000
         BNZ   @RF00414                                            0414 00800000
*     CCAIOPTR=SAVIOPTR;            /* RESET PTR TO PASSED IOP       */ 00801000
         MVC   CCAIOPTR(4,CCAPTR),SAVIOPTR                         0415 00802000
*   IOPPTR=CCAIOPTR;                /*                               */ 00803000
@RF00414 L     IOPPTR,CCAIOPTR(,CCAPTR)                            0416 00804000
*   IOPBUFAD=SAVBUFAD;              /*                               */ 00805000
         MVC   IOPBUFAD(4,IOPPTR),SAVBUFAD                         0417 00806000
         EJECT                                                          00807000
*                                                                  0418 00808000
*   /*****************************************************************/ 00809000
*   /*                                                               */ 00810000
*   /* IF OUT OF STORAGE CONDITION OCCURRED THEN ISSUE MESSAGE       */ 00811000
*   /*                                                               */ 00812000
*   /*****************************************************************/ 00813000
*                                                                  0418 00814000
*   IF M202I=ON                     /* IF OUT OF STORAGE             */ 00815000
*     THEN                          /*                               */ 00816000
         TM    M202I,B'10000000'                                   0418 00817000
         BNO   @RF00418                                            0418 00818000
*     DO;                           /*                               */ 00819000
*       MGPCLEAR=''B;               /*                               */ 00820000
         XC    MGPCLEAR(6),MGPCLEAR                                0420 00821000
*       MGPMGNO1=HMA202I;           /* UNABLE TO OBTAIN STORAGE FOR     00822000
*                                      WORK AREAS                    */ 00823000
         MVC   MGPMGNO1(2),@CH00238                                0421 00824000
*       MGPTYPE=MGPTERM;            /*                               */ 00825000
         MVI   MGPTYPE,X'05'                                       0422 00826000
*       CALL HMASMMSG(HMASMMGP);    /*                               */ 00827000
         L     @15,@CV01328                                        0423 00828000
         LA    @01,@AL00423                                        0423 00829000
         BALR  @14,@15                                             0423 00830000
*       DSURTNCD=MAX(DSURTNCD,STOPSMP);/* SET RC TO 16               */ 00831000
         SLR   @10,@10                                             0424 00832000
         IC    @10,DSURTNCD                                        0424 00833000
         LA    @06,16                                              0424 00834000
         CR    @10,@06                                             0424 00835000
         BNL   *+6                                                      00836000
         LR    @10,@06                                             0424 00837000
         STC   @10,DSURTNCD                                        0424 00838000
*     END;                          /*                               */ 00839000
*                                                                  0425 00840000
*   /*****************************************************************/ 00841000
*   /*                                                               */ 00842000
*   /* PROCESSING COMPLETED - NOW RETURN                             */ 00843000
*   /*                                                               */ 00844000
*   /*****************************************************************/ 00845000
*                                                                  0426 00846000
*   RETURN CODE(DSURTNCD);          /*                               */ 00847000
@RF00418 SLR   @15,@15                                             0426 00848000
         IC    @15,DSURTNCD                                        0426 00849000
         L     @13,4(,@13)                                         0426 00850000
         L     @14,12(,@13)                                        0426 00851000
         LM    @00,@12,20(@13)                                     0426 00852000
         BR    @14                                                 0426 00853000
         EJECT                                                          00854000
*                                                                  0427 00855000
*   /*****************************************************************/ 00856000
*   /*                                                               */ 00857000
*   /* ROUTINE CALLED TO OPEN ALL SMP DATA SETS TO DETERMINE BLOCKING*/ 00858000
*   /* FACTORS FOR LATER BUFFER GETMAINS. IF THE DATA SET IS ALREADY */ 00859000
*   /* OPEN HMASMIO WILL STILL PASS BACK THE BLKSIZE FOR THAT DATA   */ 00860000
*   /* SET.                                                          */ 00861000
*   /*                                                               */ 00862000
*   /*****************************************************************/ 00863000
*                                                                  0427 00864000
*DSUOPEN:                           /*                               */ 00865000
*   PROCEDURE;                      /*                               */ 00866000
@EL00001 L     @13,4(,@13)                                         0427 00867000
@EF00001 DS    0H                                                  0427 00868000
@ER00001 LM    @14,@12,12(@13)                                     0427 00869000
         BR    @14                                                 0427 00870000
DSUOPEN  STM   @14,@12,@SA00002                                    0427 00871000
*   DECLARE                         /*                               */ 00872000
*     OPNRTNCD FIXED(8);            /*                               */ 00873000
*   RFY                                                            0429 00874000
*     HMASMIOP BASED(IOPPTR);       /*                               */ 00875000
*   OPNRTNCD=ZERO;                  /* INIT RC                       */ 00876000
         MVI   OPNRTNCD,X'00'                                      0430 00877000
*   IOPFUNCT=IOPOPEN;               /* SET TO OPEN DATA SET          */ 00878000
         MVI   IOPFUNCT(IOPPTR),X'00'                              0431 00879000
*   IOPDSID=IOPCDS;                 /* OPEN CDS DS           @SA74317*/ 00880000
         MVI   IOPDSID(IOPPTR),X'02'                               0432 00881000
*   CALL HMASMIO(HMASMIOP);         /* DO OPEN TO GET BLKSIZ @SA74317*/ 00882000
         ST    IOPPTR,@AL00001                                     0433 00883000
         L     @15,@CV01327                                        0433 00884000
         LA    @01,@AL00001                                        0433 00885000
         BALR  @14,@15                                             0433 00886000
*   IF IOPRETRN=IOPIOERR            /* IF I/O ERR                    */ 00887000
*     THEN                          /* SAVE RC                       */ 00888000
         CLI   IOPRETRN(IOPPTR),16                                 0434 00889000
         BNE   @RF00434                                            0434 00890000
*     OPNRTNCD=IOPIOERR;            /*                               */ 00891000
         MVI   OPNRTNCD,X'10'                                      0435 00892000
*   IF IOPRETRN=IOPGOOD             /* OPEN OK?              @YA07506*/ 00893000
*     THEN                          /* YES                   @SA74317*/ 00894000
@RF00434 CLI   IOPRETRN(IOPPTR),0                                  0436 00895000
         BNE   @RF00436                                            0436 00896000
*     DO;                           /*                               */ 00897000
*       CCACDSP=ON;                 /*                               */ 00898000
         OI    CCACDSP(CCAPTR),B'10000000'                         0438 00899000
*       CCACBFMX=IOPBLKSI/LRECL;    /* CALC BLOCKING FCTR    @SA74317*/ 00900000
         LH    @00,IOPBLKSI(,IOPPTR)                               0439 00901000
         SRDA  @00,32                                              0439 00902000
         D     @00,@CF00516                                        0439 00903000
         STH   @01,CCACBFMX(,CCAPTR)                               0439 00904000
*     END;                          /*                               */ 00905000
*   IOPDSID=IOPACDS;                /* SET TO OPEN ACDS      @SA74317*/ 00906000
@RF00436 MVI   IOPDSID(IOPPTR),X'0C'                               0441 00907000
*   CALL HMASMIO(HMASMIOP);         /* DO OPEN               @SA74317*/ 00908000
         ST    IOPPTR,@AL00001                                     0442 00909000
         L     @15,@CV01327                                        0442 00910000
         LA    @01,@AL00001                                        0442 00911000
         BALR  @14,@15                                             0442 00912000
*   IF IOPRETRN=IOPIOERR            /* IF I/O ERR                    */ 00913000
*     THEN                          /* SAVE RC                       */ 00914000
         CLI   IOPRETRN(IOPPTR),16                                 0443 00915000
         BNE   @RF00443                                            0443 00916000
*     OPNRTNCD=IOPIOERR;            /*                               */ 00917000
         MVI   OPNRTNCD,X'10'                                      0444 00918000
*   IF IOPRETRN=IOPGOOD             /* OPEN OK?              @YA07506*/ 00919000
*     THEN                          /* YES                   @SA74317*/ 00920000
@RF00443 CLI   IOPRETRN(IOPPTR),0                                  0445 00921000
         BNE   @RF00445                                            0445 00922000
*     DO;                           /*                               */ 00923000
*       CCAACDSP=ON;                /*                               */ 00924000
         OI    CCAACDSP(CCAPTR),B'01000000'                        0447 00925000
*       CCAABFMX=IOPBLKSI/LRECL;    /* SET ACDS BLKING FACTOR        */ 00926000
         LH    @00,IOPBLKSI(,IOPPTR)                               0448 00927000
         SRDA  @00,32                                              0448 00928000
         D     @00,@CF00516                                        0448 00929000
         STH   @01,CCAABFMX(,CCAPTR)                               0448 00930000
*     END;                          /*                               */ 00931000
*   IOPDSID=IOPSCDS;                /* INDICATE SMPSCDS      @Z40SP00*/ 00932000
@RF00445 MVI   IOPDSID(IOPPTR),X'21'                               0450 00933000
*   CALL HMASMIO(HMASMIOP);         /* OPEN SMPSCDS          @Z40SP00*/ 00934000
         ST    IOPPTR,@AL00001                                     0451 00935000
         L     @15,@CV01327                                        0451 00936000
         LA    @01,@AL00001                                        0451 00937000
         BALR  @14,@15                                             0451 00938000
*   IF IOPRETRN=IOPIOERR            /* IF I/O ERR                    */ 00939000
*     THEN                          /* SAVE RC                       */ 00940000
         CLI   IOPRETRN(IOPPTR),16                                 0452 00941000
         BNE   @RF00452                                            0452 00942000
*     OPNRTNCD=IOPIOERR;            /*                               */ 00943000
         MVI   OPNRTNCD,X'10'                                      0453 00944000
*   IF IOPRETRN=IOPGOOD             /* DID IT GET OPENED?            */ 00945000
*     THEN                          /* YES - SAVE BLKSIZE            */ 00946000
@RF00452 CLI   IOPRETRN(IOPPTR),0                                  0454 00947000
         BNE   @RF00454                                            0454 00948000
*     DO;                           /*                               */ 00949000
*       CCASCDSP=ON;                /* SCDS PRESENT                  */ 00950000
         OI    CCASCDSP(CCAPTR),B'00100000'                        0456 00951000
*       CCAVBFMX=IOPBLKSI/LRECL;    /* SET SCDS BLOCK FACTOR         */ 00952000
         LH    @00,IOPBLKSI(,IOPPTR)                               0457 00953000
         SRDA  @00,32                                              0457 00954000
         D     @00,@CF00516                                        0457 00955000
         STH   @01,CCAVBFMX(,CCAPTR)                               0457 00956000
*     END;                          /*                               */ 00957000
*   IOPDSID=IOPPTS;                 /* INDICATE SMPPTS       @Z40SP00*/ 00958000
@RF00454 MVI   IOPDSID(IOPPTR),X'06'                               0459 00959000
*   CALL HMASMIO(HMASMIOP);         /* OPEN SMPPTS           @Z40SP00*/ 00960000
         ST    IOPPTR,@AL00001                                     0460 00961000
         L     @15,@CV01327                                        0460 00962000
         LA    @01,@AL00001                                        0460 00963000
         BALR  @14,@15                                             0460 00964000
*   IF IOPRETRN=IOPIOERR            /* IF I/O ERR                    */ 00965000
*     THEN                          /* SAVE RC                       */ 00966000
         CLI   IOPRETRN(IOPPTR),16                                 0461 00967000
         BNE   @RF00461                                            0461 00968000
*     OPNRTNCD=IOPIOERR;            /*                               */ 00969000
         MVI   OPNRTNCD,X'10'                                      0462 00970000
*   IF IOPRETRN=IOPGOOD             /* DID IT GET OPENED?            */ 00971000
*     THEN                          /* YES - SAVE BLKSIZE            */ 00972000
@RF00461 CLI   IOPRETRN(IOPPTR),0                                  0463 00973000
         BNE   @RF00463                                            0463 00974000
*     DO;                           /*                               */ 00975000
*       CCAPTSP=ON;                 /* PTS PRESENT                   */ 00976000
         OI    CCAPTSP(CCAPTR),B'00010000'                         0465 00977000
*       CCAPBFMX=IOPBLKSI/LRECL;    /* SET PTS BLOCK FACTOR  @Z40SP00*/ 00978000
         LH    @00,IOPBLKSI(,IOPPTR)                               0466 00979000
         SRDA  @00,32                                              0466 00980000
         D     @00,@CF00516                                        0466 00981000
         STH   @01,CCAPBFMX(,CCAPTR)                               0466 00982000
*     END;                          /*                               */ 00983000
*   IOPDSID=IOPMTS;                 /* INDICATE SMPMTS               */ 00984000
@RF00463 MVI   IOPDSID(IOPPTR),X'12'                               0468 00985000
*   CALL HMASMIO(HMASMIOP);         /* OPEN PTS                      */ 00986000
         ST    IOPPTR,@AL00001                                     0469 00987000
         L     @15,@CV01327                                        0469 00988000
         LA    @01,@AL00001                                        0469 00989000
         BALR  @14,@15                                             0469 00990000
*   IF IOPRETRN=IOPIOERR            /* IF I/O ERR                    */ 00991000
*     THEN                          /* SAVE RC                       */ 00992000
         CLI   IOPRETRN(IOPPTR),16                                 0470 00993000
         BNE   @RF00470                                            0470 00994000
*     OPNRTNCD=IOPIOERR;            /*                               */ 00995000
         MVI   OPNRTNCD,X'10'                                      0471 00996000
*   IF IOPRETRN=IOPGOOD             /* DID IT GET OPENED?            */ 00997000
*     THEN                          /* YES - SAVE BLKSIZE            */ 00998000
@RF00470 CLI   IOPRETRN(IOPPTR),0                                  0472 00999000
         BNE   @RF00472                                            0472 01000000
*     DO;                           /*                               */ 01001000
*       CCAMTSP=ON;                 /* MTS PRESENT                   */ 01002000
         OI    CCAMTSP(CCAPTR),B'00001000'                         0474 01003000
*       CCAMBFMX=IOPBLKSI/LRECL;    /* SET MTS BLOCK FACTOR  @Z40SP00*/ 01004000
         LH    @00,IOPBLKSI(,IOPPTR)                               0475 01005000
         SRDA  @00,32                                              0475 01006000
         D     @00,@CF00516                                        0475 01007000
         STH   @01,CCAMBFMX(,CCAPTR)                               0475 01008000
*     END;                          /*                               */ 01009000
*   IOPDSID=IOPSTS;                 /* INDICATE SMPSTS       @Z40SP00*/ 01010000
@RF00472 MVI   IOPDSID(IOPPTR),X'1A'                               0477 01011000
*   CALL HMASMIO(HMASMIOP);         /* OPEN PTS              @Z40SP00*/ 01012000
         ST    IOPPTR,@AL00001                                     0478 01013000
         L     @15,@CV01327                                        0478 01014000
         LA    @01,@AL00001                                        0478 01015000
         BALR  @14,@15                                             0478 01016000
*   IF IOPRETRN=IOPIOERR            /* IF I/O ERR                    */ 01017000
*     THEN                          /* SAVE RC                       */ 01018000
         CLI   IOPRETRN(IOPPTR),16                                 0479 01019000
         BNE   @RF00479                                            0479 01020000
*     OPNRTNCD=IOPIOERR;            /*                               */ 01021000
         MVI   OPNRTNCD,X'10'                                      0480 01022000
*   IF IOPRETRN=IOPGOOD             /* DID IT GET OPENED?    @Z40SP00*/ 01023000
*     THEN                          /* YES - SAVE BLKSIZE    @Z40SP00*/ 01024000
@RF00479 CLI   IOPRETRN(IOPPTR),0                                  0481 01025000
         BNE   @RF00481                                            0481 01026000
*     DO;                           /*                               */ 01027000
*       CCASTSP=ON;                 /* STS PRESENT                   */ 01028000
         OI    CCASTSP(CCAPTR),B'00000100'                         0483 01029000
*       CCASBFMX=IOPBLKSI/LRECL;    /* SET STS BLOCK FACTOR  @Z40SP00*/ 01030000
         LH    @00,IOPBLKSI(,IOPPTR)                               0484 01031000
         SRDA  @00,32                                              0484 01032000
         D     @00,@CF00516                                        0484 01033000
         STH   @01,CCASBFMX(,CCAPTR)                               0484 01034000
*     END;                          /*                               */ 01035000
*   IOPDSID=IOPCRQ;                 /* INDICATE SMPCRQ               */ 01036000
@RF00481 MVI   IOPDSID(IOPPTR),X'1C'                               0486 01037000
*   CALL HMASMIO(HMASMIOP);         /* OPEN SMPCRQ                   */ 01038000
         ST    IOPPTR,@AL00001                                     0487 01039000
         L     @15,@CV01327                                        0487 01040000
         LA    @01,@AL00001                                        0487 01041000
         BALR  @14,@15                                             0487 01042000
*   IF IOPRETRN=IOPIOERR            /* IF I/O ERR                    */ 01043000
*     THEN                          /* SAVE RC                       */ 01044000
         CLI   IOPRETRN(IOPPTR),16                                 0488 01045000
         BNE   @RF00488                                            0488 01046000
*     OPNRTNCD=IOPIOERR;            /*                               */ 01047000
         MVI   OPNRTNCD,X'10'                                      0489 01048000
*   IF IOPRETRN=IOPGOOD             /* DID IT GET OPENED?            */ 01049000
*     THEN                          /* YES - SAVE BLKSIZE            */ 01050000
@RF00488 CLI   IOPRETRN(IOPPTR),0                                  0490 01051000
         BNE   @RF00490                                            0490 01052000
*     DO;                           /*                               */ 01053000
*       CCACRQP=ON;                 /* CRQ PRESENT                   */ 01054000
         OI    CCACRQP(CCAPTR),B'00000010'                         0492 01055000
*       CCAQBFMX=IOPBLKSI/LRECL;    /* SAVE CRQ BLOCKING FACTOR      */ 01056000
         LH    @00,IOPBLKSI(,IOPPTR)                               0493 01057000
         SRDA  @00,32                                              0493 01058000
         D     @00,@CF00516                                        0493 01059000
         STH   @01,CCAQBFMX(,CCAPTR)                               0493 01060000
*     END;                          /*                               */ 01061000
*   IOPDSID=IOPACRQ;                /* INDICATE SMPACRQ              */ 01062000
@RF00490 MVI   IOPDSID(IOPPTR),X'1E'                               0495 01063000
*   CALL HMASMIO(HMASMIOP);         /* OPEN SMPACRQ                  */ 01064000
         ST    IOPPTR,@AL00001                                     0496 01065000
         L     @15,@CV01327                                        0496 01066000
         LA    @01,@AL00001                                        0496 01067000
         BALR  @14,@15                                             0496 01068000
*   IF IOPRETRN=IOPIOERR            /* IF I/O ERR                    */ 01069000
*     THEN                          /* SAVE RC                       */ 01070000
         CLI   IOPRETRN(IOPPTR),16                                 0497 01071000
         BNE   @RF00497                                            0497 01072000
*     OPNRTNCD=IOPIOERR;            /*                               */ 01073000
         MVI   OPNRTNCD,X'10'                                      0498 01074000
*   IF IOPRETRN=IOPGOOD             /* DID IT GET OPENED?            */ 01075000
*     THEN                          /* YES - SAVE BLKSIZE            */ 01076000
@RF00497 CLI   IOPRETRN(IOPPTR),0                                  0499 01077000
         BNE   @RF00499                                            0499 01078000
*     DO;                           /*                               */ 01079000
*       CCAACRQP=ON;                /* ACRQ PRESENT                  */ 01080000
         OI    CCAACRQP(CCAPTR),B'00000001'                        0501 01081000
*       CCAXBFMX=IOPBLKSI/LRECL;    /* SAVE ACRQ BLOCKING FACTOR     */ 01082000
         LH    @00,IOPBLKSI(,IOPPTR)                               0502 01083000
         SRDA  @00,32                                              0502 01084000
         D     @00,@CF00516                                        0502 01085000
         STH   @01,CCAXBFMX(,CCAPTR)                               0502 01086000
*     END;                          /*                               */ 01087000
*   IOPDSID=IOPWK1;                 /* INDICATE SMPWK1               */ 01088000
@RF00499 MVI   IOPDSID(IOPPTR),X'23'                               0504 01089000
*   CALL HMASMIO(HMASMIOP);         /* OPEN SMPWK1                   */ 01090000
         ST    IOPPTR,@AL00001                                     0505 01091000
         L     @15,@CV01327                                        0505 01092000
         LA    @01,@AL00001                                        0505 01093000
         BALR  @14,@15                                             0505 01094000
*   IF IOPRETRN=IOPIOERR            /* IF I/O ERR                    */ 01095000
*     THEN                          /* SAVE RC                       */ 01096000
         CLI   IOPRETRN(IOPPTR),16                                 0506 01097000
         BNE   @RF00506                                            0506 01098000
*     OPNRTNCD=IOPIOERR;            /*                               */ 01099000
         MVI   OPNRTNCD,X'10'                                      0507 01100000
*   IF IOPRETRN=IOPGOOD             /* DID IT GET OPENED?            */ 01101000
*     THEN                          /* YES - SAVE BLKSIZE            */ 01102000
@RF00506 CLI   IOPRETRN(IOPPTR),0                                  0508 01103000
         BNE   @RF00508                                            0508 01104000
*     DO;                           /*                               */ 01105000
*       CCAWK1P=ON;                 /* WK1 PRESENT                   */ 01106000
         OI    CCAWK1P(CCAPTR),B'10000000'                         0510 01107000
*       CCA1BFMX=IOPBLKSI/LRECL;    /* SET WK1 BLOCK FACTOR          */ 01108000
         LH    @00,IOPBLKSI(,IOPPTR)                               0511 01109000
         SRDA  @00,32                                              0511 01110000
         D     @00,@CF00516                                        0511 01111000
         STH   @01,CCA1BFMX(,CCAPTR)                               0511 01112000
*     END;                          /*                               */ 01113000
*   IOPDSID=IOPWK2;                 /* INDICATE SMPWK2               */ 01114000
@RF00508 MVI   IOPDSID(IOPPTR),X'24'                               0513 01115000
*   CALL HMASMIO(HMASMIOP);         /* OPEN SMPWK2                   */ 01116000
         ST    IOPPTR,@AL00001                                     0514 01117000
         L     @15,@CV01327                                        0514 01118000
         LA    @01,@AL00001                                        0514 01119000
         BALR  @14,@15                                             0514 01120000
*   IF IOPRETRN=IOPIOERR            /* IF I/O ERR                    */ 01121000
*     THEN                          /* SAVE RC                       */ 01122000
         CLI   IOPRETRN(IOPPTR),16                                 0515 01123000
         BNE   @RF00515                                            0515 01124000
*     OPNRTNCD=IOPIOERR;            /*                               */ 01125000
         MVI   OPNRTNCD,X'10'                                      0516 01126000
*   IF IOPRETRN=IOPGOOD             /* DID IT GET OPENED?            */ 01127000
*     THEN                          /* YES - SAVE BLKSIZE            */ 01128000
@RF00515 CLI   IOPRETRN(IOPPTR),0                                  0517 01129000
         BNE   @RF00517                                            0517 01130000
*     DO;                           /*                               */ 01131000
*       CCAWK2P=ON;                 /* WK2 PRESENT                   */ 01132000
         OI    CCAWK2P(CCAPTR),B'01000000'                         0519 01133000
*       CCA2BFMX=IOPBLKSI/LRECL;    /* SET WK2 BLOCK FACTOR          */ 01134000
         LH    @00,IOPBLKSI(,IOPPTR)                               0520 01135000
         SRDA  @00,32                                              0520 01136000
         D     @00,@CF00516                                        0520 01137000
         STH   @01,CCA2BFMX(,CCAPTR)                               0520 01138000
*     END;                          /*                               */ 01139000
*   IOPDSID=IOPWK3;                 /* INDICATE SMPWK3               */ 01140000
@RF00517 MVI   IOPDSID(IOPPTR),X'25'                               0522 01141000
*   CALL HMASMIO(HMASMIOP);         /* OPEN SMPWK3                   */ 01142000
         ST    IOPPTR,@AL00001                                     0523 01143000
         L     @15,@CV01327                                        0523 01144000
         LA    @01,@AL00001                                        0523 01145000
         BALR  @14,@15                                             0523 01146000
*   IF IOPRETRN=IOPIOERR            /* IF I/O ERR                    */ 01147000
*     THEN                          /* SAVE RC                       */ 01148000
         CLI   IOPRETRN(IOPPTR),16                                 0524 01149000
         BNE   @RF00524                                            0524 01150000
*     OPNRTNCD=IOPIOERR;            /*                               */ 01151000
         MVI   OPNRTNCD,X'10'                                      0525 01152000
*   IF IOPRETRN=IOPGOOD             /* DID IT GET OPENED?            */ 01153000
*     THEN                          /* YES - SAVE BLKSIZE            */ 01154000
@RF00524 CLI   IOPRETRN(IOPPTR),0                                  0526 01155000
         BNE   @RF00526                                            0526 01156000
*     DO;                           /*                               */ 01157000
*       CCAWK3P=ON;                 /* WK3 PRESENT                   */ 01158000
         OI    CCAWK3P(CCAPTR),B'00100000'                         0528 01159000
*       CCA3BFMX=IOPBLKSI/LRECL;    /* SET WK3 BLOCK FACTOR          */ 01160000
         LH    @00,IOPBLKSI(,IOPPTR)                               0529 01161000
         SRDA  @00,32                                              0529 01162000
         D     @00,@CF00516                                        0529 01163000
         STH   @01,CCA3BFMX(,CCAPTR)                               0529 01164000
*     END;                          /*                               */ 01165000
*   IOPDSID=IOPWK4;                 /* INDICATE SMPWK4               */ 01166000
@RF00526 MVI   IOPDSID(IOPPTR),X'26'                               0531 01167000
*   CALL HMASMIO(HMASMIOP);         /* OPEN SMPWK4                   */ 01168000
         ST    IOPPTR,@AL00001                                     0532 01169000
         L     @15,@CV01327                                        0532 01170000
         LA    @01,@AL00001                                        0532 01171000
         BALR  @14,@15                                             0532 01172000
*   IF IOPRETRN=IOPIOERR            /* IF I/O ERR                    */ 01173000
*     THEN                          /* SAVE RC                       */ 01174000
         CLI   IOPRETRN(IOPPTR),16                                 0533 01175000
         BNE   @RF00533                                            0533 01176000
*     OPNRTNCD=IOPIOERR;            /*                               */ 01177000
         MVI   OPNRTNCD,X'10'                                      0534 01178000
*   IF IOPRETRN=IOPGOOD             /* DID IT GET OPENED?            */ 01179000
*     THEN                          /* YES - SAVE BLKSIZE            */ 01180000
@RF00533 CLI   IOPRETRN(IOPPTR),0                                  0535 01181000
         BNE   @RF00535                                            0535 01182000
*     DO;                           /*                               */ 01183000
*       CCAWK4P=ON;                 /* WK4 PRESENT                   */ 01184000
         OI    CCAWK4P(CCAPTR),B'00010000'                         0537 01185000
*       CCA4BFMX=IOPBLKSI/LRECL;    /* SET WK4 BLOCK FACTOR          */ 01186000
         LH    @00,IOPBLKSI(,IOPPTR)                               0538 01187000
         SRDA  @00,32                                              0538 01188000
         D     @00,@CF00516                                        0538 01189000
         STH   @01,CCA4BFMX(,CCAPTR)                               0538 01190000
*     END;                          /*                               */ 01191000
*   DEVDDNAM=CCADSIDA(IOPWK5);      /*                               */ 01192000
@RF00535 L     @10,CCADSAD(,CCAPTR)                                0540 01193000
         MVC   DEVDDNAM(8),CCADSIDA+304(@10)                       0540 01194000
*   GEN(DEVTYPE  DEVDDNAM,DEVADDR)                                 0541 01195000
*   REFS(DEVDDNAM,DEVADDR);         /*                               */ 01196000
         DEVTYPE  DEVDDNAM,DEVADDR                                      01197000
*   RFY                                                            0542 01198000
*     RTNCODE RSTD;                 /*                               */ 01199000
*   IF RTNCODE=ZERO                 /* SMPWRK5 PRESENT               */ 01200000
*     THEN                          /*                               */ 01201000
         LTR   RTNCODE,RTNCODE                                     0543 01202000
         BNZ   @RF00543                                            0543 01203000
*     CCAWK5P=ON;                   /*                               */ 01204000
         OI    CCAWK5P(CCAPTR),B'00001000'                         0544 01205000
*   RFY                                                            0545 01206000
*     RTNCODE UNRSTD;               /*                               */ 01207000
@RF00543 DS    0H                                                  0546 01208000
*   DEVDDNAM=CCADSIDA(IOPRPT);      /*                               */ 01209000
         L     @10,CCADSAD(,CCAPTR)                                0546 01210000
         MVC   DEVDDNAM(8),CCADSIDA+320(@10)                       0546 01211000
*   GEN(DEVTYPE  DEVDDNAM,DEVADDR)                                 0547 01212000
*   REFS(DEVDDNAM,DEVADDR);         /*                               */ 01213000
         DEVTYPE  DEVDDNAM,DEVADDR                                      01214000
*   RFY                                                            0548 01215000
*     RTNCODE RSTD;                 /*                               */ 01216000
*   IF RTNCODE=ZERO                 /* SMPRPT PRESENT                */ 01217000
*     THEN                          /*                               */ 01218000
         LTR   RTNCODE,RTNCODE                                     0549 01219000
         BNZ   @RF00549                                            0549 01220000
*     DO;                           /*                               */ 01221000
*       CCARPTP=ON;                 /*                               */ 01222000
         OI    CCARPTP(CCAPTR),B'00001000'                         0551 01223000
*       CCARPTDS=IOPRPT;            /* SET TO USE FOR ALL REPORTS    */ 01224000
         MVI   CCARPTDS(CCAPTR),X'29'                              0552 01225000
*     END;                          /*                               */ 01226000
*   ELSE                            /*                               */ 01227000
*     CCARPTDS=IOPPRINT;            /* ELSE USE SMPOUT               */ 01228000
         B     @RC00549                                            0554 01229000
@RF00549 MVI   CCARPTDS(CCAPTR),X'0B'                              0554 01230000
*   RFY                                                            0555 01231000
*     RTNCODE UNRSTD;               /*                               */ 01232000
@RC00549 DS    0H                                                  0556 01233000
*   DEVDDNAM=CCADSIDA(IOPLIST);     /*                               */ 01234000
         L     @10,CCADSAD(,CCAPTR)                                0556 01235000
         MVC   DEVDDNAM(8),CCADSIDA+328(@10)                       0556 01236000
*   GEN(DEVTYPE  DEVDDNAM,DEVADDR)                                 0557 01237000
*   REFS(DEVDDNAM,DEVADDR);         /*                               */ 01238000
         DEVTYPE  DEVDDNAM,DEVADDR                                      01239000
*   RFY                                                            0558 01240000
*     RTNCODE RSTD;                 /*                               */ 01241000
*   IF RTNCODE=ZERO                 /* SMPLIST PRESENT               */ 01242000
*     THEN                          /*                               */ 01243000
         LTR   RTNCODE,RTNCODE                                     0559 01244000
         BNZ   @RF00559                                            0559 01245000
*     DO;                           /*                               */ 01246000
*       CCALISTP=ON;                /*                               */ 01247000
         OI    CCALISTP(CCAPTR),B'00010000'                        0561 01248000
*       CCALSTDS=IOPLIST;           /* SET TO USE FOR ALL LISTS      */ 01249000
         MVI   CCALSTDS(CCAPTR),X'2A'                              0562 01250000
*     END;                          /*                               */ 01251000
*   ELSE                            /*                               */ 01252000
*     CCALSTDS=IOPPRINT;            /* ELSE USE SMPOUT               */ 01253000
         B     @RC00559                                            0564 01254000
@RF00559 MVI   CCALSTDS(CCAPTR),X'0B'                              0564 01255000
*   RFY                                                            0565 01256000
*     RTNCODE UNRSTD;               /*                               */ 01257000
@RC00559 DS    0H                                                  0566 01258000
*   RETURN CODE(OPNRTNCD);          /*                               */ 01259000
         SLR   @15,@15                                             0566 01260000
         IC    @15,OPNRTNCD                                        0566 01261000
         L     @14,@SA00002                                        0566 01262000
         LM    @00,@12,@SA00002+8                                  0566 01263000
         BR    @14                                                 0566 01264000
*   END DSUOPEN;                    /*                               */ 01265000
         EJECT                                                          01266000
*                                                                  0568 01267000
*   /*****************************************************************/ 01268000
*   /*                                                               */ 01269000
*   /* ROUTINE CALLED TO GETMAIN INPUT AND OUTBUT BUFFER AREA FOR THE*/ 01270000
*   /* VARIOUS SMP DATA SETS OPENED PREVIOUSLY. THE ADDRESSES OF THE */ 01271000
*   /* BUFFER AREAS ARE PUT INTO APPROPRIATE FIELDS IN THE CCA       */ 01272000
*   /*                                                               */ 01273000
*   /*****************************************************************/ 01274000
*                                                                  0568 01275000
*DSUGETMN:                          /*                               */ 01276000
*   PROCEDURE;                      /*                               */ 01277000
DSUGETMN STM   @14,@12,@SA00003                                    0568 01278000
*   DECLARE                         /*                               */ 01279000
*     GETRTNCD FIXED(8);            /*                               */ 01280000
*   GETRTNCD=ZERO;                  /* INIT RC                       */ 01281000
         MVI   GETRTNCD,X'00'                                      0570 01282000
*   RFY                                                            0571 01283000
*     SIZE RSTD;                                                   0571 01284000
*   RFY                                                            0572 01285000
*     GMADDR RSTD;                  /*                               */ 01286000
*                                                                  0572 01287000
*   /*****************************************************************/ 01288000
*   /*                                                               */ 01289000
*   /* GET BUFFERS FOR CDS/ACDS                                      */ 01290000
*   /*                                                               */ 01291000
*   /*****************************************************************/ 01292000
*                                                                  0573 01293000
*   IF GETRTNCD=ZERO                /*                               */ 01294000
*       &(CCACDSP=ON                /* AND EITHER CDS PRESENT        */ 01295000
*       |CCAACDSP=ON)               /* OR ACDS PRESENT               */ 01296000
*     THEN                          /*                               */ 01297000
         CLI   GETRTNCD,0                                          0573 01298000
         BNE   @RF00573                                            0573 01299000
         TM    CCACDSP(CCAPTR),B'11000000'                         0573 01300000
         BZ    @RF00573                                            0573 01301000
*     DO;                           /*                               */ 01302000
*       SIZE=MAX(CCACBFMX,CCAABFMX)*(LRECL*2);/* CALC STORAGE        */ 01303000
         LH    SIZE,CCACBFMX(,CCAPTR)                              0575 01304000
         LH    @10,CCAABFMX(,CCAPTR)                               0575 01305000
         CR    SIZE,@10                                            0575 01306000
         BNL   *+6                                                      01307000
         LR    SIZE,@10                                            0575 01308000
         MH    SIZE,@CH00863                                       0575 01309000
*       GMADDR=ADDR(CCACBFIA);      /* RTN ADDR                      */ 01310000
         LA    GMADDR,CCACBFIA(,CCAPTR)                            0576 01311000
*       GEN(GETMAIN EC,LV=(SIZE),A=(GMADDR))                       0577 01312000
*       REFS(SIZE,CCACBFIA);        /* GET INPUT/OUTPUT BFRS @Z40SP00*/ 01313000
         GETMAIN EC,LV=(SIZE),A=(GMADDR)                                01314000
*       RFY                                                        0578 01315000
*         RTNCODE RSTD;             /*                       @Z40SP00*/ 01316000
*       IF RTNCODE^=IOPGOOD         /* GETMAIN OK??          @YA07506*/ 01317000
*         THEN                      /* NO - ERR STOP         @SA74317*/ 01318000
         LTR   RTNCODE,RTNCODE                                     0579 01319000
         BZ    @RF00579                                            0579 01320000
*         DO;                       /* ERR                   @SA74317*/ 01321000
*           M202I=ON;               /*                               */ 01322000
         OI    M202I,B'10000000'                                   0581 01323000
*           GETRTNCD=STOPSMP;       /*                               */ 01324000
         MVI   GETRTNCD,X'10'                                      0582 01325000
*         END;                      /*                               */ 01326000
*       ELSE                        /*                               */ 01327000
*         DO;                       /*                               */ 01328000
         B     @RC00579                                            0584 01329000
@RF00579 DS    0H                                                  0585 01330000
*           CCACBFOA=CCACBFIA+SIZE/2;/* CAL OUTPUT BUFFER ADDR       */ 01331000
         LR    @00,SIZE                                            0585 01332000
         SRDA  @00,32                                              0585 01333000
         D     @00,@CF00186                                        0585 01334000
         AL    @01,CCACBFIA(,CCAPTR)                               0585 01335000
         ST    @01,CCACBFOA(,CCAPTR)                               0585 01336000
*           CCACBFSZ=SIZE;          /* SAVE GETMAIN SIZE     @Z40SP00*/ 01337000
         ST    SIZE,CCACBFSZ(,CCAPTR)                              0586 01338000
*         END;                      /*                               */ 01339000
*       RFY                                                        0588 01340000
*         RTNCODE UNRSTD;                                          0588 01341000
@RC00579 DS    0H                                                  0589 01342000
*     END;                          /*                               */ 01343000
*                                                                  0590 01344000
*   /*****************************************************************/ 01345000
*   /*                                                               */ 01346000
*   /* GET BUFFERS FOR SCDS                                          */ 01347000
*   /*                                                               */ 01348000
*   /*****************************************************************/ 01349000
*                                                                  0590 01350000
*   IF GETRTNCD=ZERO                /* PREV FUNCTIONS OK             */ 01351000
*       &CCASCDSP=ON                /* AND SCDS PRESENT              */ 01352000
*     THEN                          /*                               */ 01353000
@RF00573 CLI   GETRTNCD,0                                          0590 01354000
         BNE   @RF00590                                            0590 01355000
         TM    CCASCDSP(CCAPTR),B'00100000'                        0590 01356000
         BNO   @RF00590                                            0590 01357000
*     DO;                           /*                               */ 01358000
*       SIZE=CCAVBFMX*(LRECL*2);    /* CALC GETMAIN SIZE             */ 01359000
         LH    SIZE,CCAVBFMX(,CCAPTR)                              0592 01360000
         MH    SIZE,@CH00863                                       0592 01361000
*       GMADDR=ADDR(CCAVBFIA);      /* RTN ADDR                      */ 01362000
         LA    GMADDR,CCAVBFIA(,CCAPTR)                            0593 01363000
*       GEN(GETMAIN EC,LV=(SIZE),A=(GMADDR))                       0594 01364000
*       REFS(SIZE,CCAVBFIA);        /* GET BUFFERS                   */ 01365000
         GETMAIN EC,LV=(SIZE),A=(GMADDR)                                01366000
*       RFY                                                        0595 01367000
*         RTNCODE RSTD;             /*                               */ 01368000
*       IF RTNCODE^=IOPGOOD         /* NO ROOM?                      */ 01369000
*         THEN                      /* NO - ISSUE MESSAGE AND LEAVE  */ 01370000
         LTR   RTNCODE,RTNCODE                                     0596 01371000
         BZ    @RF00596                                            0596 01372000
*         DO;                                                      0597 01373000
*           M202I=ON;               /* SET SW TO ISSUE MSG           */ 01374000
         OI    M202I,B'10000000'                                   0598 01375000
*           GETRTNCD=STOPSMP;       /* SET RETURN CODE               */ 01376000
         MVI   GETRTNCD,X'10'                                      0599 01377000
*         END;                      /* END GETMAIN FAILED            */ 01378000
*       ELSE                        /*                               */ 01379000
*         DO;                       /*                               */ 01380000
         B     @RC00596                                            0601 01381000
@RF00596 DS    0H                                                  0602 01382000
*           CCAVBFOA=CCAVBFIA+SIZE/2;/* ADDR OF OUTPUT BUFFER        */ 01383000
         LR    @00,SIZE                                            0602 01384000
         SRDA  @00,32                                              0602 01385000
         D     @00,@CF00186                                        0602 01386000
         AL    @01,CCAVBFIA(,CCAPTR)                               0602 01387000
         ST    @01,CCAVBFOA(,CCAPTR)                               0602 01388000
*           CCAVBFSZ=SIZE;          /* SAVE GETMAIN SIZE             */ 01389000
         ST    SIZE,CCAVBFSZ(,CCAPTR)                              0603 01390000
*         END;                      /*                               */ 01391000
*       RFY                                                        0605 01392000
*         RTNCODE UNRSTD;           /*                               */ 01393000
@RC00596 DS    0H                                                  0606 01394000
*     END;                          /*                               */ 01395000
*                                                                  0607 01396000
*   /*****************************************************************/ 01397000
*   /*                                                               */ 01398000
*   /* GET BUFFERS FOR PTS/MTS/STS                                   */ 01399000
*   /*                                                               */ 01400000
*   /*****************************************************************/ 01401000
*                                                                  0607 01402000
*   IF GETRTNCD=ZERO                /* PREV FUNCTIONS OK             */ 01403000
*       &(CCAPTSP=ON                /* AND EITHER PTS PRESENT        */ 01404000
*       |CCAMTSP=ON                 /* OR MTS PRESENT                */ 01405000
*       |CCASTSP=ON)                /* OR STS PRESENT                */ 01406000
*     THEN                          /*                               */ 01407000
@RF00590 CLI   GETRTNCD,0                                          0607 01408000
         BNE   @RF00607                                            0607 01409000
         TM    CCAPTSP(CCAPTR),B'00011100'                         0607 01410000
         BZ    @RF00607                                            0607 01411000
*     DO;                           /*                               */ 01412000
*       SIZE=MAX(CCAPBFMX,CCAMBFMX,CCASBFMX)*(LRECL*2);/* CALC     0609 01413000
*                                      GETMAIN SIZE          @Z40SP00*/ 01414000
         LH    SIZE,CCAPBFMX(,CCAPTR)                              0609 01415000
         LH    @10,CCAMBFMX(,CCAPTR)                               0609 01416000
         CR    SIZE,@10                                            0609 01417000
         BNL   *+6                                                      01418000
         LR    SIZE,@10                                            0609 01419000
         LH    @10,CCASBFMX(,CCAPTR)                               0609 01420000
         CR    SIZE,@10                                            0609 01421000
         BNL   *+6                                                      01422000
         LR    SIZE,@10                                            0609 01423000
         MH    SIZE,@CH00863                                       0609 01424000
*       GMADDR=ADDR(CCAPBFIA);      /* RTN ADDR                      */ 01425000
         LA    GMADDR,CCAPBFIA(,CCAPTR)                            0610 01426000
*       GEN(GETMAIN EC,LV=(SIZE),A=(GMADDR))                       0611 01427000
*       REFS(SIZE,CCAPBFIA);        /* GET BUFFERS           @Z40SP00*/ 01428000
         GETMAIN EC,LV=(SIZE),A=(GMADDR)                                01429000
*       RFY                                                        0612 01430000
*         RTNCODE RSTD;             /*                       @Z40SP00*/ 01431000
*       IF RTNCODE^=IOPGOOD         /* NO ROOM?                      */ 01432000
*         THEN                      /* NO - ISSUE MESSAGE AND LEAVE  */ 01433000
         LTR   RTNCODE,RTNCODE                                     0613 01434000
         BZ    @RF00613                                            0613 01435000
*         DO;                                                      0614 01436000
*           M202I=ON;               /* SET SW TO ISSUE MSG           */ 01437000
         OI    M202I,B'10000000'                                   0615 01438000
*           GETRTNCD=STOPSMP;       /* SET RETURN CODE       @YA07506*/ 01439000
         MVI   GETRTNCD,X'10'                                      0616 01440000
*         END;                      /* END GETMAIN FAILED            */ 01441000
*       ELSE                        /*                               */ 01442000
*         DO;                       /*                               */ 01443000
         B     @RC00613                                            0618 01444000
@RF00613 DS    0H                                                  0619 01445000
*           CCAPBFOA=CCAPBFIA+SIZE/2;/* ADDR OF OUTPUT BUFFER        */ 01446000
         LR    @00,SIZE                                            0619 01447000
         SRDA  @00,32                                              0619 01448000
         D     @00,@CF00186                                        0619 01449000
         AL    @01,CCAPBFIA(,CCAPTR)                               0619 01450000
         ST    @01,CCAPBFOA(,CCAPTR)                               0619 01451000
*           CCAPBFSZ=SIZE;          /* SAVE GETMAIN SIZE     @Z40SP00*/ 01452000
         ST    SIZE,CCAPBFSZ(,CCAPTR)                              0620 01453000
*         END;                      /*                               */ 01454000
*       RFY                                                        0622 01455000
*         RTNCODE UNRSTD;           /*                               */ 01456000
@RC00613 DS    0H                                                  0623 01457000
*     END;                          /*                               */ 01458000
*                                                                  0624 01459000
*   /*****************************************************************/ 01460000
*   /*                                                               */ 01461000
*   /* GET BUFFERS FOR CRQ/ACRQ                                      */ 01462000
*   /*                                                               */ 01463000
*   /*****************************************************************/ 01464000
*                                                                  0624 01465000
*   IF GETRTNCD=ZERO                /* IF PREV FUNCTIONS OK          */ 01466000
*       &(CCACRQP=ON                /* AND CRQ OR ACRQ DD PRESENT    */ 01467000
*       |CCAACRQP=ON)               /*                               */ 01468000
*     THEN                          /*                               */ 01469000
@RF00607 CLI   GETRTNCD,0                                          0624 01470000
         BNE   @RF00624                                            0624 01471000
         TM    CCACRQP(CCAPTR),B'00000011'                         0624 01472000
         BZ    @RF00624                                            0624 01473000
*     DO;                           /*                               */ 01474000
*       SIZE=MAX(CCAQBFMX,CCAXBFMX)*(LRECL*2);/* CALC SIZE           */ 01475000
         LH    SIZE,CCAQBFMX(,CCAPTR)                              0626 01476000
         LH    @10,CCAXBFMX(,CCAPTR)                               0626 01477000
         CR    SIZE,@10                                            0626 01478000
         BNL   *+6                                                      01479000
         LR    SIZE,@10                                            0626 01480000
         MH    SIZE,@CH00863                                       0626 01481000
*       GMADDR=ADDR(CCAQBFIA);      /* RTN ADDR                      */ 01482000
         LA    GMADDR,CCAQBFIA(,CCAPTR)                            0627 01483000
*       GEN(GETMAIN EC,LV=(SIZE),A=(GMADDR))                       0628 01484000
*       REFS(SIZE,CCAQBFIA);        /* GET BUFFERS                   */ 01485000
         GETMAIN EC,LV=(SIZE),A=(GMADDR)                                01486000
*       RFY                                                        0629 01487000
*         RTNCODE RSTD;             /*                               */ 01488000
*       IF RTNCODE^=IOPGOOD         /* NO ROOM?                      */ 01489000
*         THEN                      /* NO - ISSUE MESSAGE AND LEAVE  */ 01490000
         LTR   RTNCODE,RTNCODE                                     0630 01491000
         BZ    @RF00630                                            0630 01492000
*         DO;                                                      0631 01493000
*           M202I=ON;               /* SET SW TO ISSUE MSG           */ 01494000
         OI    M202I,B'10000000'                                   0632 01495000
*           GETRTNCD=STOPSMP;       /* SET RETURN CODE               */ 01496000
         MVI   GETRTNCD,X'10'                                      0633 01497000
*         END;                      /* END GETMAIN FAILED            */ 01498000
*       ELSE                        /*                               */ 01499000
*         DO;                       /*                               */ 01500000
         B     @RC00630                                            0635 01501000
@RF00630 DS    0H                                                  0636 01502000
*           CCAQBFOA=CCAQBFIA+SIZE/2;/* ADDR OF OUTPUT BUFFER        */ 01503000
         LR    @00,SIZE                                            0636 01504000
         SRDA  @00,32                                              0636 01505000
         D     @00,@CF00186                                        0636 01506000
         AL    @01,CCAQBFIA(,CCAPTR)                               0636 01507000
         ST    @01,CCAQBFOA(,CCAPTR)                               0636 01508000
*           CCAQBFSZ=SIZE;          /* SAVE GETMAIN SIZE             */ 01509000
         ST    SIZE,CCAQBFSZ(,CCAPTR)                              0637 01510000
*         END;                      /*                               */ 01511000
*       RFY                                                        0639 01512000
*         RTNCODE UNRSTD;           /*                               */ 01513000
@RC00630 DS    0H                                                  0640 01514000
*     END;                          /*                               */ 01515000
*                                                                  0641 01516000
*   /*****************************************************************/ 01517000
*   /*                                                               */ 01518000
*   /* GET BUFFERS FOR WRK1/WRK2/WRK3                                */ 01519000
*   /*                                                               */ 01520000
*   /*****************************************************************/ 01521000
*                                                                  0641 01522000
*   IF GETRTNCD=ZERO                /* ALL PREV FUNCTIONS OK         */ 01523000
*       &(CCAWK1P=ON                /* AND EITHER WRK1 PRESENT       */ 01524000
*       |CCAWK2P=ON                 /* OR WK2 PRESENT                */ 01525000
*       |CCAWK3P=ON)                /* OR WK3 PRESENT                */ 01526000
*     THEN                          /*                               */ 01527000
@RF00624 CLI   GETRTNCD,0                                          0641 01528000
         BNE   @RF00641                                            0641 01529000
         TM    CCAWK1P(CCAPTR),B'11100000'                         0641 01530000
         BZ    @RF00641                                            0641 01531000
*     DO;                           /*                               */ 01532000
*       SIZE=MAX(CCA1BFMX,CCA2BFMX,CCA3BFMX)*LRECL*2;/* SET MAX    0643 01533000
*                                      BUFFER SIZE                   */ 01534000
         LH    SIZE,CCA1BFMX(,CCAPTR)                              0643 01535000
         LH    @10,CCA2BFMX(,CCAPTR)                               0643 01536000
         CR    SIZE,@10                                            0643 01537000
         BNL   *+6                                                      01538000
         LR    SIZE,@10                                            0643 01539000
         LH    @10,CCA3BFMX(,CCAPTR)                               0643 01540000
         CR    SIZE,@10                                            0643 01541000
         BNL   *+6                                                      01542000
         LR    SIZE,@10                                            0643 01543000
         MH    SIZE,@CH00863                                       0643 01544000
*       GMADDR=ADDR(CCAWBFIA);      /* RTN ADDR                      */ 01545000
         LA    GMADDR,CCAWBFIA(,CCAPTR)                            0644 01546000
*       GEN(GETMAIN EC,LV=(SIZE),A=(GMADDR))                       0645 01547000
*       REFS(SIZE,CCAWBFIA);        /* GET BUFFERS                   */ 01548000
         GETMAIN EC,LV=(SIZE),A=(GMADDR)                                01549000
*       RFY                                                        0646 01550000
*         RTNCODE RSTD;             /*                               */ 01551000
*       IF RTNCODE^=IOPGOOD         /* NO ROOM?                      */ 01552000
*         THEN                      /* NO - ISSUE MESSAGE AND LEAVE  */ 01553000
         LTR   RTNCODE,RTNCODE                                     0647 01554000
         BZ    @RF00647                                            0647 01555000
*         DO;                                                      0648 01556000
*           M202I=ON;               /* SET SW TO ISSUE MSG           */ 01557000
         OI    M202I,B'10000000'                                   0649 01558000
*           GETRTNCD=STOPSMP;       /* SET RETURN CODE               */ 01559000
         MVI   GETRTNCD,X'10'                                      0650 01560000
*         END;                      /* END GETMAIN FAILED            */ 01561000
*       ELSE                        /*                               */ 01562000
*         DO;                       /*                               */ 01563000
         B     @RC00647                                            0652 01564000
@RF00647 DS    0H                                                  0653 01565000
*           CCAWBFOA=CCAWBFIA+SIZE/2;/* ADDR OF OUTPUT BUFFER        */ 01566000
         LR    @00,SIZE                                            0653 01567000
         SRDA  @00,32                                              0653 01568000
         D     @00,@CF00186                                        0653 01569000
         AL    @01,CCAWBFIA(,CCAPTR)                               0653 01570000
         ST    @01,CCAWBFOA(,CCAPTR)                               0653 01571000
*           CCAWBFSZ=SIZE;          /* SAVE GETMAIN SIZE             */ 01572000
         ST    SIZE,CCAWBFSZ(,CCAPTR)                              0654 01573000
*         END;                      /*                               */ 01574000
*       RFY                                                        0656 01575000
*         RTNCODE UNRSTD;           /*                               */ 01576000
@RC00647 DS    0H                                                  0657 01577000
*     END;                          /*                               */ 01578000
*                                                                  0658 01579000
*   /*****************************************************************/ 01580000
*   /*                                                               */ 01581000
*   /* GET BUFFERS FOR WRK4                                          */ 01582000
*   /*                                                               */ 01583000
*   /*****************************************************************/ 01584000
*                                                                  0658 01585000
*   IF GETRTNCD=ZERO                /* ALL PREV FUNCTIONS OK         */ 01586000
*       &CCAWK4P=ON                 /* AND WK4 DD PRESENT            */ 01587000
*     THEN                          /*                               */ 01588000
@RF00641 CLI   GETRTNCD,0                                          0658 01589000
         BNE   @RF00658                                            0658 01590000
         TM    CCAWK4P(CCAPTR),B'00010000'                         0658 01591000
         BNO   @RF00658                                            0658 01592000
*     DO;                           /*                               */ 01593000
*       SIZE=CCA4BFMX*LRECL*2;      /* SET MAX BUFFER SIZE           */ 01594000
         LH    SIZE,CCA4BFMX(,CCAPTR)                              0660 01595000
         MH    SIZE,@CH00863                                       0660 01596000
*       GMADDR=ADDR(CCA4BFIA);      /* RTN ADDR                      */ 01597000
         LA    GMADDR,CCA4BFIA(,CCAPTR)                            0661 01598000
*       GEN(GETMAIN EC,LV=(SIZE),A=(GMADDR))                       0662 01599000
*       REFS(SIZE,CCA4BFIA);        /* GET BUFFERS                   */ 01600000
         GETMAIN EC,LV=(SIZE),A=(GMADDR)                                01601000
*       RFY                                                        0663 01602000
*         RTNCODE RSTD;             /*                               */ 01603000
*       IF RTNCODE^=IOPGOOD         /* NO ROOM?                      */ 01604000
*         THEN                      /* NO - ISSUE MESSAGE AND LEAVE  */ 01605000
         LTR   RTNCODE,RTNCODE                                     0664 01606000
         BZ    @RF00664                                            0664 01607000
*         DO;                                                      0665 01608000
*           M202I=ON;               /* SET SW TO ISSUE MSG           */ 01609000
         OI    M202I,B'10000000'                                   0666 01610000
*           GETRTNCD=STOPSMP;       /* SET RETURN CODE               */ 01611000
         MVI   GETRTNCD,X'10'                                      0667 01612000
*         END;                      /* END GETMAIN FAILED            */ 01613000
*       ELSE                        /*                               */ 01614000
*         DO;                       /*                               */ 01615000
         B     @RC00664                                            0669 01616000
@RF00664 DS    0H                                                  0670 01617000
*           CCA4BFOA=CCA4BFIA+SIZE/2;/* ADDR OF OUTPUT BUFFER        */ 01618000
         LR    @00,SIZE                                            0670 01619000
         SRDA  @00,32                                              0670 01620000
         D     @00,@CF00186                                        0670 01621000
         AL    @01,CCA4BFIA(,CCAPTR)                               0670 01622000
         ST    @01,CCA4BFOA(,CCAPTR)                               0670 01623000
*           CCA4BFSZ=SIZE;          /* SAVE GETMAIN SIZE             */ 01624000
         ST    SIZE,CCA4BFSZ(,CCAPTR)                              0671 01625000
*         END;                      /*                               */ 01626000
*       RFY                                                        0673 01627000
*         RTNCODE UNRSTD;           /*                               */ 01628000
@RC00664 DS    0H                                                  0674 01629000
*     END;                          /*                               */ 01630000
*   RFY                                                            0675 01631000
*     SIZE UNRSTD;                                                 0675 01632000
@RF00658 DS    0H                                                  0676 01633000
*   RFY                                                            0676 01634000
*     GMADDR UNRSTD;                /*                               */ 01635000
*                                                                  0676 01636000
*   /*****************************************************************/ 01637000
*   /*                                                               */ 01638000
*   /* RETURN WITH CODE SET UP DURING PROCESSING                     */ 01639000
*   /*                                                               */ 01640000
*   /*****************************************************************/ 01641000
*                                                                  0677 01642000
*   RETURN CODE(GETRTNCD);          /*                               */ 01643000
         SLR   @15,@15                                             0677 01644000
         IC    @15,GETRTNCD                                        0677 01645000
         L     @14,@SA00003                                        0677 01646000
         LM    @00,@12,@SA00003+8                                  0677 01647000
         BR    @14                                                 0677 01648000
*   END DSUGETMN;                   /*                               */ 01649000
         EJECT                                                          01650000
*                                                                  0679 01651000
*   /*****************************************************************/ 01652000
*   /*                                                               */ 01653000
*   /* THE REST OF THE HMASMDSU MODULE CONSISTS OF DSCAN ROUTS. THESE*/ 01654000
*   /* ROUTS WILL BE CALLED FROM HMASMSCN WHENEVER THE KEY IS FOUND  */ 01655000
*   /* AND THE ROUT IS SPECIFIED. REGISTER ONE WILL BE RESTRICTED    */ 01656000
*   /* SINCE HMASMSCN DEPENDS UPON REGISTER ONE NOT BEING CHANGED. IT*/ 01657000
*   /* KEEPS THE ADDRESS OF ITS SAVE AREA IN AN AREA IN THE HMASMSCP */ 01658000
*   /* AND REGISTER ONE POINTS TO THE HMASMSCP               @Z40SP00*/ 01659000
*   /* THE RETURN REG(REG14) IS ALSO RESTRICTED SO THAT SAVE AREAS   */ 01660000
*   /* WILL NOT BE NEEDED FOR EACH PROC                      @Z40SP00*/ 01661000
*   /*                                                               */ 01662000
*   /*****************************************************************/ 01663000
*                                                                  0679 01664000
*   RFY                                                            0679 01665000
*     R1 RSTD;                      /*                       @Z40SP00*/ 01666000
*   RFY                                                            0680 01667000
*     RTNREG RSTD;                  /*                       @Z40SP00*/ 01668000
*                                                                  0681 01669000
*   /*****************************************************************/ 01670000
*   /*                                                               */ 01671000
*   /* ROUT ENTERED WHEN DATE KEYWORD FOUND ON PARM          @Z40SP00*/ 01672000
*   /*                                                               */ 01673000
*   /*****************************************************************/ 01674000
*                                                                  0681 01675000
*RDATE:                             /*                       @Z40SP00*/ 01676000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Z40SP00*/ 01677000
RDATE    DS    0H                                                  0682 01678000
*   IF PRMDATE=ON                   /* DATE ENTERED ALREADY? @Z40SP00*/ 01679000
*     THEN                          /* YES                   @Z40SP00*/ 01680000
         TM    PRMDATE,B'10000000'                                 0682 01681000
         BNO   @RF00682                                            0682 01682000
*     SCPRET=SCPSTOP;               /* SYNTAX ERR            @Z40SP00*/ 01683000
         MVI   SCPRET,X'08'                                        0683 01684000
*   ELSE                            /* NOT ENTERED ALREADY   @Z40SP00*/ 01685000
*     DO;                           /*                       @Z40SP00*/ 01686000
         B     @RC00682                                            0684 01687000
@RF00682 DS    0H                                                  0685 01688000
*       PRMDATE=ON;                 /*                       @Z40SP00*/ 01689000
         OI    PRMDATE,B'10000000'                                 0685 01690000
*       SCPRET=SCPGOOD;             /*                       @Z40SP00*/ 01691000
         MVI   SCPRET,X'00'                                        0686 01692000
*     END;                          /*                       @Z40SP00*/ 01693000
*   END RDATE;                      /*                       @Z40SP00*/ 01694000
*                                                                  0688 01695000
@EL00004 DS    0H                                                  0688 01696000
@EF00004 DS    0H                                                  0688 01697000
@ER00004 BR    @14                                                 0688 01698000
*   /*****************************************************************/ 01699000
*   /*                                                               */ 01700000
*   /* ROUT ENTERED WHEN FMID KEYWORD FOUND ON PARM                  */ 01701000
*   /*                                                               */ 01702000
*   /*****************************************************************/ 01703000
*                                                                  0689 01704000
*RFMID:                             /*                               */ 01705000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                               */ 01706000
RFMID    DS    0H                                                  0690 01707000
*   IF PRMFMID=ON                   /* FMID ENTERED ALREADY?         */ 01708000
*     THEN                          /* YES                           */ 01709000
         TM    PRMFMID,B'01000000'                                 0690 01710000
         BNO   @RF00690                                            0690 01711000
*     SCPRET=SCPSTOP;               /* SYNTAX ERR                    */ 01712000
         MVI   SCPRET,X'08'                                        0691 01713000
*   ELSE                            /* NOT ENTERED ALREADY           */ 01714000
*     DO;                           /*                               */ 01715000
         B     @RC00690                                            0692 01716000
@RF00690 DS    0H                                                  0693 01717000
*       PRMFMID=ON;                 /*                               */ 01718000
         OI    PRMFMID,B'01000000'                                 0693 01719000
*       SCPRET=SCPGOOD;             /*                               */ 01720000
         MVI   SCPRET,X'00'                                        0694 01721000
*     END;                          /*                               */ 01722000
*   END RFMID;                      /*                               */ 01723000
@EL00005 DS    0H                                                  0696 01724000
@EF00005 DS    0H                                                  0696 01725000
@ER00005 BR    @14                                                 0696 01726000
*                                                                  0697 01727000
*   /*****************************************************************/ 01728000
*   /*                                                               */ 01729000
*   /* THIS ROUTINE CHECKS AND SAVES THE DATE ENTERED        @OS64458*/ 01730000
*   /* ON THE EXEC STATEMENT PARAMETER LIST                  @OS64458*/ 01731000
*   /*                                                               */ 01732000
*   /*****************************************************************/ 01733000
*                                                                  0697 01734000
*RDATEV:                                                           0697 01735000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @OS64458*/ 01736000
RDATEV   DS    0H                                                  0698 01737000
*   SCPRET=SCPGOOD;                 /* SET SCAN RETURN CODE FOR GOOD    01738000
*                                      RETURN                @OS64458*/ 01739000
         MVI   SCPRET,X'00'                                        0698 01740000
*   IF SCPSTRNG(1:3)^=IPL           /* SIPL DATE USE               0699 01741000
*                                      REQUESTED@OS64458             */ 01742000
*       &SCPSTRNG(1)^=USEIT         /* OR U TYPE ENTRY       @OS64458*/ 01743000
*     THEN                          /* NO                    @OS64458*/ 01744000
         L     @15,SCPCHAR                                         0699 01745000
         CLC   SCPSTRNG(3,@15),@CC01346                            0699 01746000
         BE    @RF00699                                            0699 01747000
         CLI   SCPSTRNG(@15),C'U'                                  0699 01748000
         BE    @RF00699                                            0699 01749000
*     IF SCPSTRNG(1:5)^=REPLY       /* REPLY REQUEST FROM OP @OS64458*/ 01750000
*       THEN                        /* NO - THEN DATE MUST HAVE BEEN    01751000
*                                      ENTERED               @OS64458*/ 01752000
         CLC   SCPSTRNG(5,@15),@CC01348                            0700 01753000
         BE    @RF00700                                            0700 01754000
*       DO;                         /* CHECK FOR ALL NUMERICS      0701 01755000
*                                                            @OS64458*/ 01756000
*         DATEOP=SCPSTRNG(1:SCPPMLN);/* SAVE DATE ENTERED    @OS64458*/ 01757000
         MVI   DATEOP+1,C' '                                       0702 01758000
         MVC   DATEOP+2(3),DATEOP+1                                0702 01759000
         LH    @10,SCPPMLN                                         0702 01760000
         BCTR  @10,0                                               0702 01761000
         EX    @10,@SM01456                                        0702 01762000
*         IF(DATEOP&CHAR0)^=CHAR0   /* DATA NUMERIC?         @OS64458*/ 01763000
*           THEN                    /* NO - ERR              @OS64458*/ 01764000
         MVC   @TS00001(5),DATEOP                                  0703 01765000
         NC    @TS00001(5),@CC01355                                0703 01766000
         CLC   @TS00001(5),@CC01355                                0703 01767000
         BE    @RF00703                                            0703 01768000
*           SCPRET=SCPSTOP;         /* RETURN ERR CODE       @OS64458*/ 01769000
         MVI   SCPRET,X'08'                                        0704 01770000
*       END;                        /* END DATE ENTERED GROUP      0705 01771000
*                                                            @OS64458*/ 01772000
*     ELSE                                                         0706 01773000
*       ;                           /* REPLY FROM OP REQUESTED, LEAVE   01774000
*                                      DATEOP AS IS          @OS64458   01775000
*                                      WILL CAUSE REPLY MSG TO BE  0706 01776000
*                                      GENREATED             @OS64458*/ 01777000
@RF00700 DS    0H                                                  0707 01778000
*   ELSE                                                           0707 01779000
*     DATEOP(1)=USEIT;              /* MOVE 'U' INTO REPLY AREA    0707 01780000
*                                                            @OS64458   01781000
*                                      CAUSING IPL DATE TO BE USED 0707 01782000
*                                                            @OS64458*/ 01783000
         B     @RC00699                                            0707 01784000
@RF00699 MVI   DATEOP,C'U'                                         0707 01785000
*   END RDATEV;                     /* END CHECK AND SAVE PARM DATE     01786000
*                                      ROUTINE               @OS64458*/ 01787000
@EL00006 DS    0H                                                  0708 01788000
@EF00006 DS    0H                                                  0708 01789000
@ER00006 BR    @14                                                 0708 01790000
*                                                                  0709 01791000
*   /*****************************************************************/ 01792000
*   /*                                                               */ 01793000
*   /* THIS ROUTINE SAVES THE FMID VALUE FROM THE EXEC STATEMENT IN  */ 01794000
*   /* THE CCA                                                       */ 01795000
*   /*                                                               */ 01796000
*   /*****************************************************************/ 01797000
*                                                                  0709 01798000
*RFMIDV:                                                           0709 01799000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                          */ 01800000
RFMIDV   DS    0H                                                  0710 01801000
*   CCAFMID=SCPSTRNG(1:SCPPMLN);    /*                               */ 01802000
         MVI   CCAFMID+1(CCAPTR),C' '                              0710 01803000
         MVC   CCAFMID+2(5,CCAPTR),CCAFMID+1(CCAPTR)               0710 01804000
         LH    @15,SCPPMLN                                         0710 01805000
         BCTR  @15,0                                               0710 01806000
         L     @10,SCPCHAR                                         0710 01807000
         EX    @15,@SM01458                                        0710 01808000
*   RETURN;                         /*                               */ 01809000
@EL00007 DS    0H                                                  0711 01810000
@EF00007 DS    0H                                                  0711 01811000
@ER00007 BR    @14                                                 0711 01812000
*   END RFMIDV;                     /*                               */ 01813000
*   END HMASMDSU                                                   0713 01814000
*                                                                  0713 01815000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 01816000
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */ 01817000
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */ 01818000
*/*%INCLUDE SYSLIB  (HMASMICT)                                       */ 01819000
*/*%INCLUDE SYSLIB  (HMASMMGP)                                       */ 01820000
*/*%INCLUDE SYSLIB  (HMASMSCP)                                       */ 01821000
*/*%INCLUDE SYSLIB  (HMASMGTP)                                       */ 01822000
*                                                                  0713 01823000
*       ;                                                          0713 01824000
@DATA    DS    0H                                                       01825000
@CH00089 DC    H'1'                                                     01826000
@CH00238 DC    H'3'                                                     01827000
@CH00042 DC    H'4'                                                     01828000
@CH00358 DC    H'20'                                                    01829000
@CH00467 DC    H'26'                                                    01830000
@CH00524 DC    H'84'                                                    01831000
@CH00863 DC    H'160'                                                   01832000
@CH01338 DC    H'200'                                                   01833000
@CH01340 DC    H'225'                                                   01834000
@SM01450 MVC   EXECDATA(0),DSUPDATA(@10)                                01835000
@SM01456 MVC   DATEOP(0),SCPSTRNG(@15)                                  01836000
@SM01458 MVC   CCAFMID(0,CCAPTR),SCPSTRNG(@10)                          01837000
         DS    0F                                                       01838000
@AL00231 EQU   *                       LIST WITH   1 ARGUMENT(S)        01839000
@AL00239 EQU   *                       LIST WITH   1 ARGUMENT(S)        01840000
@AL00254 EQU   *                       LIST WITH   1 ARGUMENT(S)        01841000
@AL00272 EQU   *                       LIST WITH   1 ARGUMENT(S)        01842000
@AL00286 EQU   *                       LIST WITH   1 ARGUMENT(S)        01843000
@AL00423 DC    A(HMASMMGP)             LIST WITH   1 ARGUMENT(S)        01844000
@AL00259 DC    A(HMASMSCP)             LIST WITH   1 ARGUMENT(S)        01845000
         DS    0F                                                       01846000
@SA00001 DS    18F                                                      01847000
@PC00001 DS    1F                                                       01848000
@SA00002 DS    15F                                                      01849000
@SA00003 DS    15F                                                      01850000
@AL00001 DS    2A                                                       01851000
         DS    0F                                                       01852000
@CF00186 DC    F'2'                                                     01853000
@CF00132 DC    F'5'                                                     01854000
@CF00516 DC    F'80'                                                    01855000
@CV01325 DC    V(HMASMDC2)                                              01856000
@CV01326 DC    V(HMASMDS1)                                              01857000
@CV01327 DC    V(HMASMIO)                                               01858000
@CV01328 DC    V(HMASMMSG)                                              01859000
@CV01329 DC    V(HMASMSCN)                                              01860000
         DS    0D                                                       01861000
SAVBUFAD DS    A                                                        01862000
SAVIOPTR DS    A                                                        01863000
ADPRMSCN DC    AL4(KDATE)                                               01864000
PMLEN    DS    F                                                        01865000
ERRCOL   DS    H                                                        01866000
DSURTNCD DS    FL1                                                      01867000
OPNRTNCD DS    FL1                                                      01868000
GETRTNCD DS    FL1                                                      01869000
@TS00001 DS    CL5                                                      01870000
@CC01348 DC    C'REPLY'                                                 01871000
@CC01355 DC    C'00000'                                                 01872000
@CC01353 DC    C'CCA '                                                  01873000
@CC01346 DC    C'IPL'                                                   01874000
@CC01406 DC    C'Y'                                                     01875000
@CC01407 DC    C'N'                                                     01876000
         DS    CL3                                                      01877000
HMASMMGP DS    CL24                                                     01878000
         ORG   HMASMMGP                                                 01879000
MGPFIXED DS    CL12                                                     01880000
         ORG   MGPFIXED                                                 01881000
MGPCLEAR DS    CL6                                                      01882000
         ORG   MGPCLEAR                                                 01883000
MGPMGNO1 DS    FL2                                                      01884000
MGPMGNO2 DS    FL2                                                      01885000
MGPMGNO3 DS    FL2                                                      01886000
         ORG   MGPFIXED+6                                               01887000
MGPFLAGS DS    BL2                                                      01888000
         ORG   MGPFLAGS                                                 01889000
MGPPRINT DS    BL1                                                      01890000
MGPLIST  EQU   MGPFLAGS+0                                               01891000
MGPRPT   EQU   MGPFLAGS+0                                               01892000
MGPHLDS  EQU   MGPFLAGS+0                                               01893000
MGPWTOR  EQU   MGPFLAGS+0                                               01894000
MGPWTO   EQU   MGPFLAGS+0                                               01895000
MGPWTP   EQU   MGPFLAGS+0                                               01896000
@NM00171 EQU   MGPFLAGS+0                                               01897000
         ORG   MGPFIXED+8                                               01898000
MGPTYPE  DS    FL1                                                      01899000
@NM00172 DS    CL3                                                      01900000
         ORG   HMASMMGP+12                                              01901000
MGPVAR   DS    CL12                                                     01902000
         ORG   MGPVAR                                                   01903000
MGPVARPT DS    3A                                                       01904000
         ORG   HMASMMGP+24                                              01905000
HMASMSCP DS    CL26                                                     01906000
         ORG   HMASMSCP                                                 01907000
SCPCHAR  DS    AL4                                                      01908000
SCPSRCH  DS    AL4                                                      01909000
SCPWKAR  DS    AL4                                                      01910000
SCPIORTN DS    AL4                                                      01911000
SCPIOPAD DS    AL4                                                      01912000
SCPINLN  DS    FL2                                                      01913000
SCPPMLN  DS    FL2                                                      01914000
SCPEOR   DS    BL1                                                      01915000
         ORG   SCPEOR                                                   01916000
SCPCONT  DS    BL1                                                      01917000
SCPNOCT  EQU   SCPEOR+0                                                 01918000
SCPCOMNT EQU   SCPEOR+0                                                 01919000
SCPRTERR EQU   SCPEOR+0                                                 01920000
SCPNOSUC EQU   SCPEOR+0                                                 01921000
SCPNORT  EQU   SCPEOR+0                                                 01922000
@NM00173 EQU   SCPEOR+0                                                 01923000
         ORG   HMASMSCP+25                                              01924000
SCPRETRN DS    FL1                                                      01925000
         ORG   SCPRETRN                                                 01926000
SCPRET   DS    FL1                                                      01927000
         ORG   HMASMSCP+26                                              01928000
DSUFLG1  DS    BL1                                                      01929000
         ORG   DSUFLG1                                                  01930000
M202I    DS    BL1                                                      01931000
@NM00177 EQU   DSUFLG1+0                                                01932000
         ORG   DSUFLG1+1                                                01933000
DATEOP   DC    CL5'U    '                                               01934000
TIMETEMP DS    CL4                                                      01935000
DEVDDNAM DS    CL8                                                      01936000
DEVADDR  DS    CL8                                                      01937000
PATCHDSU DS    CL80                                                     01938000
         ORG   PATCHDSU                                                 01939000
@NM00178 DC    80X'FF'                                                  01940000
         ORG   PATCHDSU+80                                              01941000
PRMFLGS  DS    BL1                                                      01942000
         ORG   PRMFLGS                                                  01943000
PRMDATE  DS    BL1                                                      01944000
PRMFMID  EQU   PRMFLGS+0                                                01945000
@NM00179 EQU   PRMFLGS+0                                                01946000
         ORG   PRMFLGS+1                                                01947000
EXECPARM DS    CL102                                                    01948000
         ORG   EXECPARM                                                 01949000
QUOTE1   DS    CL1                                                      01950000
EXECDATA DS    CL100                                                    01951000
QUOTE2   DS    CL1                                                      01952000
         ORG   EXECPARM+102                                             01953000
         DS    CL5                                                      01954000
DBLWRD   DS    CL8                                                      01955000
CHARCOL  DS    CL2                                                      01956000
         ORG   CHARCOL                                                  01957000
@NM00180 DS    CL1                                                      01958000
LASTDIG  DS    CL1                                                      01959000
         ORG   CHARCOL+2                                                01960000
HMASMDSU CSECT                                                          01961000
KDATE    DSCAN KEY='DATE',ALT=KFMID,SUCC=KDATEEQ,ROUT=RDATE             01962000
KDATEEQ  DSCAN KEY='=',SUCC=KDATEV                                      01963000
KDATEV   DSCAN MAXLEN=5,SUCC=KCOMMA1,ROUT=RDATEV                        01964000
KFMID    DSCAN KEY='FMID',SUCC=KFMIDEQ,ROUT=RFMID                       01965000
KFMIDEQ  DSCAN KEY='=',SUCC=KFMIDV                                      01966000
KFMIDV   DSCAN MINLEN=7,MAXLEN=7,SUCC=KCOMMA1,ROUT=RFMIDV               01967000
KCOMMA1  DSCAN KEY=',',IO=NO,SUCC=KDATE                                 01968000
HMASMDSU CSECT                                                          01969000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01970000
@01      EQU   01                                                       01971000
@02      EQU   02                                                       01972000
@03      EQU   03                                                       01973000
@04      EQU   04                                                       01974000
@05      EQU   05                                                       01975000
@06      EQU   06                                                       01976000
@07      EQU   07                                                       01977000
@08      EQU   08                                                       01978000
@09      EQU   09                                                       01979000
@10      EQU   10                                                       01980000
@11      EQU   11                                                       01981000
@12      EQU   12                                                       01982000
@13      EQU   13                                                       01983000
@14      EQU   14                                                       01984000
@15      EQU   15                                                       01985000
CCAPTR   EQU   @11                                                      01986000
IOPPTR   EQU   @07                                                      01987000
RTNREG   EQU   @14                                                      01988000
RTNCODE  EQU   @15                                                      01989000
R0       EQU   @00                                                      01990000
R1       EQU   @01                                                      01991000
SIZE     EQU   @02                                                      01992000
GMADDR   EQU   @03                                                      01993000
HMASMCCA EQU   0                                                        01994000
CCAID    EQU   HMASMCCA                                                 01995000
CCAFBUFR EQU   HMASMCCA+4                                               01996000
CCACBFIA EQU   CCAFBUFR                                                 01997000
CCACBFOA EQU   CCAFBUFR+4                                               01998000
CCAVBFIA EQU   CCAFBUFR+8                                               01999000
CCAVBFOA EQU   CCAFBUFR+12                                              02000000
CCAPBFIA EQU   CCAFBUFR+16                                              02001000
CCAPBFOA EQU   CCAFBUFR+20                                              02002000
CCAQBFIA EQU   CCAFBUFR+24                                              02003000
CCAQBFOA EQU   CCAFBUFR+28                                              02004000
CCAWBFIA EQU   CCAFBUFR+32                                              02005000
CCAWBFOA EQU   CCAFBUFR+36                                              02006000
CCA4BFIA EQU   CCAFBUFR+44                                              02007000
CCA4BFOA EQU   CCAFBUFR+48                                              02008000
CCACBFSZ EQU   CCAFBUFR+56                                              02009000
CCAVBFSZ EQU   CCAFBUFR+60                                              02010000
CCAPBFSZ EQU   CCAFBUFR+64                                              02011000
CCAQBFSZ EQU   CCAFBUFR+68                                              02012000
CCAWBFSZ EQU   CCAFBUFR+72                                              02013000
CCA4BFSZ EQU   CCAFBUFR+80                                              02014000
CCACBFMX EQU   CCAFBUFR+92                                              02015000
CCAABFMX EQU   CCAFBUFR+94                                              02016000
CCAVBFMX EQU   CCAFBUFR+96                                              02017000
CCAPBFMX EQU   CCAFBUFR+98                                              02018000
CCAMBFMX EQU   CCAFBUFR+100                                             02019000
CCASBFMX EQU   CCAFBUFR+102                                             02020000
CCAQBFMX EQU   CCAFBUFR+104                                             02021000
CCAXBFMX EQU   CCAFBUFR+106                                             02022000
CCA1BFMX EQU   CCAFBUFR+108                                             02023000
CCA2BFMX EQU   CCAFBUFR+110                                             02024000
CCA3BFMX EQU   CCAFBUFR+112                                             02025000
CCA4BFMX EQU   CCAFBUFR+114                                             02026000
CCADSAD  EQU   CCAFBUFR+124                                             02027000
CCATPAD  EQU   CCAFBUFR+128                                             02028000
CCAFLAG7 EQU   CCAFBUFR+132                                             02029000
CCACDSP  EQU   CCAFLAG7                                                 02030000
CCAACDSP EQU   CCAFLAG7                                                 02031000
CCASCDSP EQU   CCAFLAG7                                                 02032000
CCAPTSP  EQU   CCAFLAG7                                                 02033000
CCAMTSP  EQU   CCAFLAG7                                                 02034000
CCASTSP  EQU   CCAFLAG7                                                 02035000
CCACRQP  EQU   CCAFLAG7                                                 02036000
CCAACRQP EQU   CCAFLAG7                                                 02037000
CCAWK1P  EQU   CCAFLAG7+1                                               02038000
CCAWK2P  EQU   CCAFLAG7+1                                               02039000
CCAWK3P  EQU   CCAFLAG7+1                                               02040000
CCAWK4P  EQU   CCAFLAG7+1                                               02041000
CCAWK5P  EQU   CCAFLAG7+1                                               02042000
CCALISTP EQU   CCAFLAG7+2                                               02043000
CCARPTP  EQU   CCAFLAG7+2                                               02044000
CCAOUTP  EQU   CCAFLAG7+2                                               02045000
CCALOGP  EQU   CCAFLAG7+2                                               02046000
CCAFIOP  EQU   HMASMCCA+140                                             02047000
CCAIOPTR EQU   CCAFIOP                                                  02048000
CCAFSYS  EQU   HMASMCCA+148                                             02049000
CCAIOPCS EQU   CCAFSYS                                                  02050000
CCAIOPAS EQU   CCAFSYS+4                                                02051000
CCASREL  EQU   CCAFSYS+12                                               02052000
CCAFLAGA EQU   CCAFSYS+21                                               02053000
CCACSYSF EQU   CCAFLAGA                                                 02054000
CCAASYSF EQU   CCAFLAGA                                                 02055000
CCAPSYSF EQU   CCAFLAGA                                                 02056000
CCAFSTA  EQU   HMASMCCA+188                                             02057000
CCAFICT  EQU   HMASMCCA+192                                             02058000
CCAICT   EQU   CCAFICT                                                  02059000
CCAFPGM  EQU   HMASMCCA+208                                             02060000
CCABLDLP EQU   CCAFPGM                                                  02061000
CCADBLDL EQU   CCAFPGM+4                                                02062000
CCAFGTP  EQU   HMASMCCA+224                                             02063000
CCASEGTP EQU   CCAFGTP                                                  02064000
@NM00009 EQU   HMASMCCA+244                                             02065000
CCAFFUNC EQU   HMASMCCA+264                                             02066000
CCAFLAG1 EQU   CCAFFUNC+8                                               02067000
CCAFLAG2 EQU   CCAFFUNC+11                                              02068000
CCAFPROC EQU   HMASMCCA+276                                             02069000
CCAFLAG3 EQU   CCAFPROC                                                 02070000
CCAFDIS  EQU   HMASMCCA+278                                             02071000
CCAFLAG4 EQU   CCAFDIS                                                  02072000
CCAFLAG5 EQU   CCAFDIS+1                                                02073000
CCAFLAG6 EQU   CCAFDIS+2                                                02074000
CCAFCNV  EQU   HMASMCCA+281                                             02075000
CCAFLAG8 EQU   CCAFCNV                                                  02076000
CCAFCTL  EQU   HMASMCCA+282                                             02077000
CCAFLAG9 EQU   CCAFCTL                                                  02078000
CCADATE  EQU   CCAFCTL+1                                                02079000
CCATIME  EQU   CCAFCTL+4                                                02080000
CCARPTDS EQU   CCAFCTL+7                                                02081000
CCALSTDS EQU   CCAFCTL+8                                                02082000
CCAFMID  EQU   HMASMCCA+291                                             02083000
CCAFDSNG EQU   HMASMCCA+298                                             02084000
CCAFLAGB EQU   CCAFDSNG                                                 02085000
CCALOGNG EQU   CCAFLAGB                                                 02086000
CCAOUTNG EQU   CCAFLAGB                                                 02087000
CCADSIDA EQU   0                                                        02088000
CCABLDLA EQU   0                                                        02089000
@NM00025 EQU   CCABLDLA                                                 02090000
CCABLDLL EQU   0                                                        02091000
@NM00027 EQU   CCABLDLL                                                 02092000
CCALKDRC EQU   @NM00027+20                                              02093000
@NM00029 EQU   CCABLDLL+124                                             02094000
CCAASMRC EQU   @NM00029+20                                              02095000
@NM00031 EQU   CCABLDLL+248                                             02096000
CCACPYRC EQU   @NM00031+20                                              02097000
@NM00033 EQU   CCABLDLL+372                                             02098000
CCACOMRC EQU   @NM00033+20                                              02099000
@NM00035 EQU   CCABLDLL+496                                             02100000
CCAZAPRC EQU   @NM00035+20                                              02101000
@NM00037 EQU   CCABLDLL+620                                             02102000
CCASUPRC EQU   @NM00037+20                                              02103000
@NM00039 EQU   CCABLDLL+744                                             02104000
CCAUPDRC EQU   @NM00039+20                                              02105000
CCABLDLM EQU   0                                                        02106000
CCABELMT EQU   CCABLDLM+4                                               02107000
CCABMPOS EQU   CCABELMT                                                 02108000
HMASMIOP EQU   0                                                        02109000
IOPDSID  EQU   HMASMIOP                                                 02110000
IOPFUNCT EQU   HMASMIOP+1                                               02111000
IOPRETRN EQU   HMASMIOP+2                                               02112000
IOPTYPE  EQU   HMASMIOP+3                                               02113000
IOPNAME  EQU   HMASMIOP+4                                               02114000
@NM00043 EQU   HMASMIOP+12                                              02115000
@NM00044 EQU   @NM00043                                                 02116000
IOPDDNAM EQU   HMASMIOP+24                                              02117000
IOPBUFAD EQU   HMASMIOP+52                                              02118000
IOPDRMAP EQU   HMASMIOP+56                                              02119000
IOPINAME EQU   IOPDRMAP                                                 02120000
IOPINAM  EQU   IOPINAME                                                 02121000
IOPITYP  EQU   IOPINAM                                                  02122000
IOPUSERL EQU   IOPDRMAP+11                                              02123000
IOPEND   EQU   IOPDRMAP+12                                              02124000
IOPLMCTL EQU   0                                                        02125000
IOPQSMIF EQU   0                                                        02126000
@NM00154 EQU   IOPQSMIF                                                 02127000
IOPQSMLS EQU   IOPQSMIF+8                                               02128000
IOPQSMNM EQU   IOPQSMLS                                                 02129000
IOPBS02  EQU   0                                                        02130000
IOPBS04  EQU   0                                                        02131000
IOPBAPF  EQU   IOPBS04                                                  02132000
HMASMICT EQU   0                                                        02133000
ICTCORE  EQU   HMASMICT                                                 02134000
ICTPSPLN EQU   ICTCORE                                                  02135000
ICTMSPLN EQU   ICTCORE+4                                                02136000
ICTLSPLN EQU   ICTCORE+8                                                02137000
ICTGMSPL EQU   0                                                        02138000
SCPSTRNG EQU   0                                                        02139000
HMASMGTP EQU   0                                                        02140000
GTPRESTR EQU   HMASMGTP+16                                              02141000
GTPFLGS1 EQU   HMASMGTP+26                                              02142000
CCATYPEA EQU   0                                                        02143000
IOPBS01  EQU   0                                                        02144000
IOPBS03  EQU   0                                                        02145000
SCPIOPRM EQU   0                                                        02146000
DSUPARM  EQU   0                                                        02147000
DSUPLEN  EQU   DSUPARM                                                  02148000
DSUPEND  EQU   DSUPARM+2                                                02149000
DSUPDATA EQU   DSUPEND                                                  02150000
IOPUDATA EQU   IOPEND                                                   02151000
IOPINAM3 EQU   IOPINAME                                                 02152000
@NM00050 EQU   IOPINAM3                                                 02153000
IOPSTCMP EQU   IOPUDATA                                                 02154000
IOPDYNDT EQU   IOPUDATA                                                 02155000
IOPSPACE EQU   IOPDYNDT+44                                              02156000
IOPDTYPE EQU   IOPDYNDT+50                                              02157000
IOPNTMAX EQU   IOPDRMAP                                                 02158000
IOPNTMAP EQU   IOPDRMAP                                                 02159000
IOPCDMAP EQU   IOPNTMAP                                                 02160000
IOPPTMAP EQU   IOPCDMAP                                                 02161000
IOPSCMAP EQU   IOPPTMAP                                                 02162000
IOPDIRCT EQU   IOPSCMAP+12                                              02163000
IOPCDMAX EQU   IOPDIRCT                                                 02164000
IOPCQMAP EQU   IOPDRMAP                                                 02165000
@NM00061 EQU   IOPUDATA                                                 02166000
IOPBLKSI EQU   @NM00061                                                 02167000
@NM00062 EQU   IOPUDATA                                                 02168000
IOPASMNT EQU   IOPUDATA                                                 02169000
IOPASMDR EQU   IOPASMNT                                                 02170000
IOPABUNT EQU   IOPASMDR+1                                               02171000
IOPLMDNT EQU   IOPUDATA                                                 02172000
IOPLMDDR EQU   IOPLMDNT                                                 02173000
IOPLMLEP EQU   IOPLMDDR+1                                               02174000
IOPLMDF1 EQU   IOPLMLEP                                                 02175000
IOPFLGS2 EQU   IOPLMDF1                                                 02176000
IOPLMDF2 EQU   IOPLMLEP+1                                               02177000
IOPLMDF3 EQU   IOPLMLEP+2                                               02178000
IOPLMDF4 EQU   IOPLMLEP+3                                               02179000
IOPLMDF5 EQU   IOPLMDDR+5                                               02180000
IOPFLGS3 EQU   IOPLMDF5                                                 02181000
IOPLMDFX EQU   IOPLMDNT+24                                              02182000
@NM00071 EQU   IOPLMDFX                                                 02183000
IOPLNTRY EQU   IOPLMDFX+8                                               02184000
IOPLSYS  EQU   IOPLNTRY                                                 02185000
IOPSYSLB EQU   IOPLSYS                                                  02186000
IOPMACNT EQU   IOPUDATA                                                 02187000
IOPMACDR EQU   IOPMACNT                                                 02188000
IOPRMIDE EQU   IOPMACDR+1                                               02189000
IOPRMST  EQU   IOPRMIDE+7                                               02190000
IOPFMIDE EQU   IOPMACDR+9                                               02191000
IOPMACFX EQU   IOPMACNT+24                                              02192000
IOPBUNT  EQU   IOPMACFX                                                 02193000
IOPMCEND EQU   IOPMACNT+104                                             02194000
IOPMACVR EQU   IOPMCEND                                                 02195000
IOPMCENT EQU   IOPMACVR                                                 02196000
IOPMCDTA EQU   IOPMCENT                                                 02197000
IOPMCASM EQU   IOPMCDTA                                                 02198000
IOPMACID EQU   IOPMCASM                                                 02199000
IOPMACST EQU   IOPMCASM+7                                               02200000
IOPMCIND EQU   IOPMCENT+8                                               02201000
IOPEOFNT EQU   IOPUDATA                                                 02202000
IOPSRCNT EQU   IOPUDATA                                                 02203000
IOPSRCDR EQU   IOPSRCNT                                                 02204000
@NM00082 EQU   IOPSRCDR+1                                               02205000
@NM00084 EQU   @NM00082+7                                               02206000
@NM00088 EQU   IOPSRCDR+9                                               02207000
IOPSRCFX EQU   IOPSRCNT+24                                              02208000
@NM00092 EQU   IOPSRCFX                                                 02209000
IOPSREND EQU   IOPSRCNT+104                                             02210000
IOPSRCVR EQU   IOPSREND                                                 02211000
IOPSNTRY EQU   IOPSRCVR                                                 02212000
IOPSRDTA EQU   IOPSNTRY                                                 02213000
IOPSRCID EQU   IOPSRDTA                                                 02214000
IOPSRCST EQU   IOPSRDTA+7                                               02215000
IOPMODNT EQU   IOPUDATA                                                 02216000
IOPMODDR EQU   IOPMODNT                                                 02217000
@NM00098 EQU   IOPMODDR+1                                               02218000
@NM00100 EQU   @NM00098+7                                               02219000
@NM00104 EQU   IOPMODDR+9                                               02220000
IOPMODFX EQU   IOPMODNT+24                                              02221000
@NM00108 EQU   IOPMODFX                                                 02222000
IOPMDLEP EQU   IOPMODFX+8                                               02223000
IOPMODF1 EQU   IOPMDLEP                                                 02224000
IOPMODF2 EQU   IOPMDLEP+1                                               02225000
IOPMODF3 EQU   IOPMDLEP+2                                               02226000
IOPMODF4 EQU   IOPMDLEP+3                                               02227000
IOPMDEND EQU   IOPMODNT+104                                             02228000
IOPMODVR EQU   IOPMDEND                                                 02229000
IOPMNTRY EQU   IOPMODVR                                                 02230000
IOPMDDTA EQU   IOPMNTRY                                                 02231000
IOPLMODS EQU   IOPMDDTA                                                 02232000
IOPMODID EQU   IOPLMODS                                                 02233000
IOPMODST EQU   IOPLMODS+7                                               02234000
IOPDLBNT EQU   IOPUDATA                                                 02235000
IOPDLBDR EQU   IOPDLBNT                                                 02236000
IOPDLBFX EQU   IOPDLBNT+24                                              02237000
@NM00119 EQU   IOPDLBFX                                                 02238000
IOPDLEND EQU   IOPDLBNT+104                                             02239000
IOPDLBVR EQU   IOPDLEND                                                 02240000
IOPDNTRY EQU   IOPDLBVR                                                 02241000
IOPDSYS  EQU   IOPDNTRY                                                 02242000
IOPSYSNT EQU   IOPUDATA                                                 02243000
IOPSYSDR EQU   IOPSYSNT                                                 02244000
IOPSYSF1 EQU   IOPSYSDR+4                                               02245000
IOPFLGS7 EQU   IOPSYSF1                                                 02246000
IOPSYSFX EQU   IOPSYSNT+24                                              02247000
@NM00126 EQU   IOPSYSFX                                                 02248000
IOPSYEND EQU   IOPSYSNT+184                                             02249000
IOPSYSVR EQU   IOPSYEND                                                 02250000
IOPSYSTR EQU   IOPSYSVR                                                 02251000
IOPSYNTR EQU   IOPSYSTR                                                 02252000
IOPPTFNT EQU   IOPUDATA                                                 02253000
IOPPTFDR EQU   IOPPTFNT                                                 02254000
IOPPSTAT EQU   IOPPTFDR+2                                               02255000
IOPPTFF1 EQU   IOPPSTAT                                                 02256000
IOPFLGS5 EQU   IOPPTFF1                                                 02257000
IOPPTFF2 EQU   IOPPSTAT+1                                               02258000
IOPPTFF3 EQU   IOPPSTAT+3                                               02259000
IOPPTFFX EQU   IOPPTFNT+24                                              02260000
@NM00135 EQU   IOPPTFFX                                                 02261000
@NM00136 EQU   @NM00135                                                 02262000
IOPPDTES EQU   IOPPTFFX+41                                              02263000
@NM00139 EQU   IOPPDTES                                                 02264000
IOPPTPFX EQU   IOPPDTES+6                                               02265000
IOPDATES EQU   IOPPTPFX                                                 02266000
IOPPTEND EQU   IOPPTFNT+104                                             02267000
IOPPTFVR EQU   IOPPTEND                                                 02268000
IOPPNTRY EQU   IOPPTFVR                                                 02269000
IOPPMODS EQU   IOPPNTRY                                                 02270000
IOPENTNT EQU   IOPUDATA+104                                             02271000
IOPSRLNT EQU   IOPUDATA+104                                             02272000
IOPPRENT EQU   IOPUDATA+104                                             02273000
IOPNPRNT EQU   IOPUDATA+104                                             02274000
IOPSUPNT EQU   IOPUDATA+104                                             02275000
IOPREQNT EQU   IOPUDATA+104                                             02276000
IOPIRQNT EQU   IOPUDATA+104                                             02277000
IOPFIDNT EQU   IOPUDATA+104                                             02278000
IOPDELNT EQU   IOPUDATA+104                                             02279000
IOPVERNT EQU   IOPUDATA+104                                             02280000
IOPSBYNT EQU   IOPUDATA+104                                             02281000
IOPQSMNT EQU   IOPUDATA                                                 02282000
IOPQSMDR EQU   IOPQSMNT                                                 02283000
IOPQFMNT EQU   IOPUDATA                                                 02284000
IOPQFMDR EQU   IOPQFMNT                                                 02285000
IOPQFEND EQU   IOPQFMNT+2                                               02286000
IOPQFMVR EQU   IOPQFEND                                                 02287000
IOPQFMLS EQU   IOPQFMVR                                                 02288000
IOPQFMNM EQU   IOPQFMLS                                                 02289000
IOPPTSYS EQU   IOPUDATA                                                 02290000
IOPPTSDR EQU   IOPPTSYS                                                 02291000
IOPPTSFX EQU   IOPPTSYS+24                                              02292000
IOPDSSPC EQU   IOPPTSFX                                                 02293000
IOPPTFG1 EQU   IOPPTSFX+34                                              02294000
IOPPSEND EQU   IOPPTSYS+1064                                            02295000
IOPPTSVR EQU   IOPPSEND                                                 02296000
IOPPTNTR EQU   IOPPTSVR                                                 02297000
@NM00164 EQU   IOPPTNTR                                                 02298000
IOPPTFMD EQU   @NM00164                                                 02299000
IOPPTREL EQU   IOPPTFMD                                                 02300000
IOPBPDS  EQU   IOPUDATA                                                 02301000
IOPBLEP1 EQU   IOPBPDS+8                                                02302000
IOPBLEP2 EQU   IOPBPDS+9                                                02303000
@NM00168 EQU   IOPBPDS+18                                               02304000
IOPBFTB0 EQU   @NM00168                                                 02305000
IOPBFTB1 EQU   IOPBFTB0                                                 02306000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02307000
IOPBCEND EQU   IOPBPDS+21                                               02308000
IOPBFTB3 EQU   IOPBFTB0+2                                               02309000
IOPBFTB2 EQU   IOPBFTB0+1                                               02310000
@NM00170 EQU   IOPBFTB1                                                 02311000
IOPBAPFP EQU   IOPBFTB1                                                 02312000
IOPBSSI  EQU   IOPBFTB1                                                 02313000
IOPBPAGA EQU   IOPBFTB1                                                 02314000
@NM00169 EQU   IOPBFTB1                                                 02315000
IOPBAOSL EQU   IOPBFTB1                                                 02316000
IOPBSEPA EQU   IOPBPDS+15                                               02317000
IOPBFTBL EQU   IOPBPDS+13                                               02318000
IOPBSTOR EQU   IOPBPDS+10                                               02319000
IOPBREFR EQU   IOPBLEP2                                                 02320000
IOPBLEF  EQU   IOPBLEP2                                                 02321000
IOPBTEST EQU   IOPBLEP2                                                 02322000
IOPBNE   EQU   IOPBLEP2                                                 02323000
@NM00167 EQU   IOPBLEP2                                                 02324000
IOPBDC   EQU   IOPBLEP2                                                 02325000
@NM00166 EQU   IOPBLEP1                                                 02326000
IOPBSCTR EQU   IOPBLEP1                                                 02327000
IOPBOL   EQU   IOPBLEP1                                                 02328000
@NM00165 EQU   IOPBLEP1                                                 02329000
IOPBOVLY EQU   IOPBLEP1                                                 02330000
IOPBREUS EQU   IOPBLEP1                                                 02331000
IOPBRENT EQU   IOPBLEP1                                                 02332000
IOPBNL   EQU   IOPBPDS+7                                                02333000
IOPBTTRN EQU   IOPBPDS+4                                                02334000
IOPBZERO EQU   IOPBPDS+3                                                02335000
IOPBTTRT EQU   IOPBPDS                                                  02336000
IOPPTIND EQU   IOPPTNTR+8                                               02337000
IOPPTSND EQU   IOPPTREL                                                 02338000
@NM00163 EQU   IOPPTSFX+872                                             02339000
IOPSYZPP EQU   IOPPTSFX+772                                             02340000
IOPSYZPR EQU   IOPPTSFX+771                                             02341000
IOPSYZPS EQU   IOPPTSFX+763                                             02342000
IOPSYZAP EQU   IOPPTSFX+755                                             02343000
IOPSYUPP EQU   IOPPTSFX+655                                             02344000
IOPSYUPR EQU   IOPPTSFX+654                                             02345000
IOPSYUPS EQU   IOPPTSFX+646                                             02346000
IOPSYUPD EQU   IOPPTSFX+638                                             02347000
IOPSYSPP EQU   IOPPTSFX+538                                             02348000
IOPSYSPR EQU   IOPPTSFX+537                                             02349000
IOPSYSPS EQU   IOPPTSFX+529                                             02350000
IOPSYSUP EQU   IOPPTSFX+521                                             02351000
IOPSYLKP EQU   IOPPTSFX+421                                             02352000
IOPSYLKR EQU   IOPPTSFX+420                                             02353000
IOPSYLKS EQU   IOPPTSFX+412                                             02354000
IOPSYLKD EQU   IOPPTSFX+404                                             02355000
IOPSYCPP EQU   IOPPTSFX+304                                             02356000
IOPSYCPR EQU   IOPPTSFX+303                                             02357000
IOPSYCPS EQU   IOPPTSFX+295                                             02358000
IOPSYCPY EQU   IOPPTSFX+287                                             02359000
IOPSYCOP EQU   IOPPTSFX+187                                             02360000
IOPSYCOR EQU   IOPPTSFX+186                                             02361000
IOPSYCOS EQU   IOPPTSFX+178                                             02362000
IOPSYCOM EQU   IOPPTSFX+170                                             02363000
IOPSYASP EQU   IOPPTSFX+70                                              02364000
IOPSYASR EQU   IOPPTSFX+69                                              02365000
IOPSYASS EQU   IOPPTSFX+61                                              02366000
IOPSYASM EQU   IOPPTSFX+53                                              02367000
@NM00162 EQU   IOPPTSFX+35                                              02368000
@NM00161 EQU   IOPPTFG1                                                 02369000
IOPPTSNJ EQU   IOPPTFG1                                                 02370000
IOPPTSNP EQU   IOPPTFG1                                                 02371000
IOPSYPLN EQU   IOPPTSFX+32                                              02372000
IOPDSPFX EQU   IOPPTSFX+6                                               02373000
IOPDSDIR EQU   IOPDSSPC+4                                               02374000
IOPDSSEC EQU   IOPDSSPC+2                                               02375000
IOPDSPRM EQU   IOPDSSPC                                                 02376000
@NM00160 EQU   IOPPTSDR+4                                               02377000
IOPPTPEM EQU   IOPPTSDR+2                                               02378000
IOPPCNVL EQU   IOPPTSDR+1                                               02379000
@NM00159 EQU   IOPPTSDR                                                 02380000
IOPQFMTP EQU   IOPQFMLS+8                                               02381000
@NM00158 EQU   IOPQFMLS+7                                               02382000
IOPQFMND EQU   IOPQFMNM                                                 02383000
@NM00157 EQU   IOPQFMDR                                                 02384000
@NM00153 EQU   IOPQSMDR                                                 02385000
@NM00152 EQU   IOPSBYNT+8                                               02386000
IOPSBYST EQU   IOPSBYNT+7                                               02387000
IOPSBYNM EQU   IOPSBYNT                                                 02388000
@NM00151 EQU   IOPVERNT+8                                               02389000
IOPVERST EQU   IOPVERNT+7                                               02390000
IOPVERNM EQU   IOPVERNT                                                 02391000
@NM00150 EQU   IOPDELNT+8                                               02392000
IOPDELST EQU   IOPDELNT+7                                               02393000
IOPDELNM EQU   IOPDELNT                                                 02394000
@NM00149 EQU   IOPFIDNT+8                                               02395000
IOPFIDST EQU   IOPFIDNT+7                                               02396000
IOPFIDNM EQU   IOPFIDNT                                                 02397000
@NM00148 EQU   IOPIRQNT+8                                               02398000
IOPIRQST EQU   IOPIRQNT+7                                               02399000
IOPIRQNM EQU   IOPIRQNT                                                 02400000
@NM00147 EQU   IOPREQNT+8                                               02401000
IOPREQST EQU   IOPREQNT+7                                               02402000
IOPREQNM EQU   IOPREQNT                                                 02403000
@NM00146 EQU   IOPSUPNT+8                                               02404000
IOPSUPST EQU   IOPSUPNT+7                                               02405000
IOPSUPNM EQU   IOPSUPNT                                                 02406000
@NM00145 EQU   IOPNPRNT+8                                               02407000
IOPNPRST EQU   IOPNPRNT+7                                               02408000
IOPNPRNM EQU   IOPNPRNT                                                 02409000
@NM00144 EQU   IOPPRENT+8                                               02410000
IOPPREST EQU   IOPPRENT+7                                               02411000
IOPPRENM EQU   IOPPRENT                                                 02412000
@NM00143 EQU   IOPSRLNT+8                                               02413000
IOPSRLST EQU   IOPSRLNT+7                                               02414000
@NM00142 EQU   IOPSRLNT+4                                               02415000
IOPSRLNM EQU   IOPSRLNT                                                 02416000
@NM00141 EQU   IOPENTNT+8                                               02417000
IOPENTST EQU   IOPENTNT+7                                               02418000
IOPENTNM EQU   IOPENTNT                                                 02419000
IOPPIND  EQU   IOPPNTRY+8                                               02420000
IOPPTFND EQU   IOPPMODS                                                 02421000
IOPPFMID EQU   IOPPTFFX+73                                              02422000
@NM00140 EQU   IOPPTPFX+24                                              02423000
IOPUCLT  EQU   IOPDATES+21                                              02424000
IOPUCLD  EQU   IOPDATES+18                                              02425000
IOPACCT  EQU   IOPDATES+15                                              02426000
IOPACCD  EQU   IOPDATES+12                                              02427000
IOPRSTT  EQU   IOPDATES+9                                               02428000
IOPRSTD  EQU   IOPDATES+6                                               02429000
IOPAPPT  EQU   IOPDATES+3                                               02430000
IOPAPPD  EQU   IOPDATES                                                 02431000
IOPRECT  EQU   @NM00139+3                                               02432000
IOPRECD  EQU   @NM00139                                                 02433000
@NM00138 EQU   IOPPTFFX+8                                               02434000
@NM00137 EQU   @NM00135+7                                               02435000
IOPPRELN EQU   @NM00136                                                 02436000
@NM00134 EQU   IOPPTFDR+20                                              02437000
IOPSBYNO EQU   IOPPTFDR+13                                              02438000
IOPDBYNO EQU   IOPPTFDR+6                                               02439000
@NM00133 EQU   IOPPTFF3                                                 02440000
IOPFLF   EQU   IOPPTFF3                                                 02441000
IOPDBYP  EQU   IOPPTFF3                                                 02442000
IOPSBYP  EQU   IOPPTFF3                                                 02443000
IOPPMDLP EQU   IOPPTFF2+1                                               02444000
IOPPADDP EQU   IOPPTFF2+1                                               02445000
@NM00132 EQU   IOPPTFF2+1                                               02446000
IOPLRFP  EQU   IOPPTFF2                                                 02447000
IOPJCLP  EQU   IOPPTFF2                                                 02448000
IOPSUPP  EQU   IOPPTFF2                                                 02449000
IOPREQP  EQU   IOPPTFF2                                                 02450000
IOPPREP  EQU   IOPPTFF2                                                 02451000
IOPNPRP  EQU   IOPPTFF2                                                 02452000
IOPIRQP  EQU   IOPPTFF2                                                 02453000
IOPDELP  EQU   IOPPTFF2                                                 02454000
IOPREGEN EQU   IOPFLGS5                                                 02455000
IOPBYP   EQU   IOPFLGS5                                                 02456000
IOPDUMMP EQU   IOPFLGS5                                                 02457000
@NM00131 EQU   IOPFLGS5                                                 02458000
IOPERROR EQU   IOPFLGS5                                                 02459000
IOPACC   EQU   IOPFLGS5                                                 02460000
IOPRES   EQU   IOPFLGS5                                                 02461000
IOPAPP   EQU   IOPFLGS5                                                 02462000
IOPPTYPE EQU   IOPPTFDR+1                                               02463000
@NM00130 EQU   IOPPTFDR                                                 02464000
IOPSYSTP EQU   IOPSYSTR+8                                               02465000
IOPSYSND EQU   IOPSYNTR                                                 02466000
@NM00129 EQU   IOPSYSFX+21                                              02467000
IOPSYSID EQU   IOPSYSFX+13                                              02468000
IOPNUCID EQU   IOPSYSFX+12                                              02469000
IOPSREL  EQU   IOPSYSFX+8                                               02470000
@NM00128 EQU   @NM00126+7                                               02471000
@NM00127 EQU   @NM00126                                                 02472000
@NM00125 EQU   IOPSYSDR+5                                               02473000
@NM00124 EQU   IOPFLGS7                                                 02474000
IOPSYNG  EQU   IOPFLGS7                                                 02475000
IOPSYDL  EQU   IOPFLGS7                                                 02476000
IOPSTSNP EQU   IOPFLGS7                                                 02477000
IOPMTSNP EQU   IOPFLGS7                                                 02478000
IOPPEMAX EQU   IOPSYSDR+2                                               02479000
IOPSCNVL EQU   IOPSYSDR+1                                               02480000
@NM00123 EQU   IOPSYSDR                                                 02481000
IOPDLIND EQU   IOPDNTRY+8                                               02482000
IOPDLBND EQU   IOPDSYS                                                  02483000
@NM00122 EQU   IOPDLBFX+8                                               02484000
@NM00121 EQU   @NM00119+7                                               02485000
@NM00120 EQU   @NM00119                                                 02486000
@NM00118 EQU   IOPDLBDR+1                                               02487000
@NM00117 EQU   IOPDLBDR                                                 02488000
IOPMDIND EQU   IOPMNTRY+8                                               02489000
@NM00116 EQU   IOPMODST                                                 02490000
IOPMODND EQU   IOPMODID                                                 02491000
IOPDLIB  EQU   IOPMODFX+72                                              02492000
@NM00115 EQU   IOPMODFX+12                                              02493000
@NM00114 EQU   IOPMODF4                                                 02494000
@NM00113 EQU   IOPMODF3                                                 02495000
@NM00112 EQU   IOPMODF2                                                 02496000
IOPMPAGA EQU   IOPMODF2                                                 02497000
IOPMNE   EQU   IOPMODF2                                                 02498000
@NM00111 EQU   IOPMODF1                                                 02499000
IOPMDC   EQU   IOPMODF1                                                 02500000
IOPMREFR EQU   IOPMODF1                                                 02501000
IOPMOVLY EQU   IOPMODF1                                                 02502000
IOPMSCTR EQU   IOPMODF1                                                 02503000
IOPMREUS EQU   IOPMODF1                                                 02504000
IOPMRENT EQU   IOPMODF1                                                 02505000
IOPMAPF  EQU   IOPMODF1                                                 02506000
@NM00110 EQU   @NM00108+7                                               02507000
@NM00109 EQU   @NM00108                                                 02508000
@NM00107 EQU   IOPMODDR+17                                              02509000
@NM00106 EQU   @NM00104+7                                               02510000
@NM00105 EQU   @NM00104                                                 02511000
@NM00103 EQU   @NM00100                                                 02512000
@NM00102 EQU   @NM00100                                                 02513000
@NM00101 EQU   @NM00100                                                 02514000
@NM00099 EQU   @NM00098                                                 02515000
@NM00097 EQU   IOPMODDR                                                 02516000
IOPSRIND EQU   IOPSNTRY+8                                               02517000
@NM00096 EQU   IOPSRCST                                                 02518000
IOPSRCND EQU   IOPSRCID                                                 02519000
IOPSRDLB EQU   IOPSRCFX+72                                              02520000
IOPSRSYS EQU   IOPSRCFX+64                                              02521000
@NM00095 EQU   IOPSRCFX+8                                               02522000
@NM00094 EQU   @NM00092+7                                               02523000
@NM00093 EQU   @NM00092                                                 02524000
@NM00091 EQU   IOPSRCDR+18                                              02525000
IOPSRLNG EQU   IOPSRCDR+17                                              02526000
@NM00090 EQU   @NM00088+7                                               02527000
@NM00089 EQU   @NM00088                                                 02528000
@NM00087 EQU   @NM00084                                                 02529000
@NM00086 EQU   @NM00084                                                 02530000
@NM00085 EQU   @NM00084                                                 02531000
@NM00083 EQU   @NM00082                                                 02532000
@NM00081 EQU   IOPSRCDR                                                 02533000
IOPEOFND EQU   IOPEOFNT                                                 02534000
IOPMCTYP EQU   IOPMCIND                                                 02535000
@NM00080 EQU   IOPMACST                                                 02536000
IOPMACND EQU   IOPMACID                                                 02537000
IOPMCDLB EQU   IOPMACFX+72                                              02538000
IOPMCSYS EQU   IOPMACFX+64                                              02539000
@NM00079 EQU   IOPMACFX+8                                               02540000
IOPBUTYP EQU   IOPBUNT+7                                                02541000
IOPBUSMD EQU   IOPBUNT                                                  02542000
@NM00078 EQU   IOPMACDR+18                                              02543000
IOPMCLNG EQU   IOPMACDR+17                                              02544000
IOPFMST  EQU   IOPFMIDE+7                                               02545000
IOPFMID  EQU   IOPFMIDE                                                 02546000
@NM00077 EQU   IOPRMST                                                  02547000
IOPRMASM EQU   IOPRMST                                                  02548000
@NM00076 EQU   IOPRMST                                                  02549000
IOPRMID  EQU   IOPRMIDE                                                 02550000
@NM00075 EQU   IOPMACDR                                                 02551000
IOPLMIND EQU   IOPLNTRY+8                                               02552000
IOPLMDND EQU   IOPSYSLB                                                 02553000
@NM00073 EQU   @NM00071+7                                               02554000
@NM00072 EQU   @NM00071                                                 02555000
@NM00070 EQU   IOPLMDDR+6                                               02556000
@NM00069 EQU   IOPFLGS3                                                 02557000
IOPCHREP EQU   IOPFLGS3                                                 02558000
IOPLINK  EQU   IOPFLGS3                                                 02559000
IOPCOPY  EQU   IOPFLGS3                                                 02560000
@NM00068 EQU   IOPLMDF4                                                 02561000
@NM00067 EQU   IOPLMDF3                                                 02562000
@NM00066 EQU   IOPLMDF2                                                 02563000
IOPPAGA  EQU   IOPLMDF2                                                 02564000
IOPNE    EQU   IOPLMDF2                                                 02565000
@NM00065 EQU   IOPFLGS2                                                 02566000
IOPDC    EQU   IOPFLGS2                                                 02567000
IOPREFR  EQU   IOPFLGS2                                                 02568000
IOPOVLY  EQU   IOPFLGS2                                                 02569000
IOPSCTR  EQU   IOPFLGS2                                                 02570000
IOPREUS  EQU   IOPFLGS2                                                 02571000
IOPRENT  EQU   IOPFLGS2                                                 02572000
IOPAPF   EQU   IOPFLGS2                                                 02573000
@NM00064 EQU   IOPLMDDR                                                 02574000
@NM00063 EQU   IOPASMDR+9                                               02575000
IOPABUTP EQU   IOPABUNT+7                                               02576000
IOPABUPT EQU   IOPABUNT                                                 02577000
IOPNTLVL EQU   IOPASMDR                                                 02578000
IOPALLOC EQU   @NM00062+4                                               02579000
IOPUSED  EQU   @NM00062                                                 02580000
IOPTPSEQ EQU   @NM00061+8                                               02581000
IOPVLSER EQU   @NM00061+2                                               02582000
IOPCQMAX EQU   IOPCQMAP+12                                              02583000
@NM00060 EQU   IOPCQMAP+11                                              02584000
@NM00059 EQU   IOPCQMAP+8                                               02585000
@NM00058 EQU   IOPCQMAP                                                 02586000
IOPPTMAX EQU   IOPCDMAX                                                 02587000
@NM00057 EQU   IOPSCMAP+11                                              02588000
@NM00056 EQU   IOPSCMAP+8                                               02589000
@NM00055 EQU   IOPSCMAP                                                 02590000
IOPDIRMX EQU   IOPNTMAX+12                                              02591000
@NM00054 EQU   IOPNTMAX+11                                              02592000
@NM00053 EQU   IOPNTMAX+8                                               02593000
@NM00052 EQU   IOPNTMAX                                                 02594000
@NM00051 EQU   IOPDTYPE                                                 02595000
IOPDMOD  EQU   IOPDTYPE                                                 02596000
IOPDJCL  EQU   IOPDTYPE                                                 02597000
IOPDSRC  EQU   IOPDTYPE                                                 02598000
IOPDMAC  EQU   IOPDTYPE                                                 02599000
IOPSDIR  EQU   IOPSPACE+4                                               02600000
IOPSSCND EQU   IOPSPACE+2                                               02601000
IOPSPRIM EQU   IOPSPACE                                                 02602000
IOPDSN   EQU   IOPDYNDT                                                 02603000
IOPNTYPE EQU   IOPSTCMP+17                                              02604000
IOPNNAME EQU   IOPSTCMP+9                                               02605000
IOPOTYPE EQU   IOPSTCMP+8                                               02606000
IOPONAME EQU   IOPSTCMP                                                 02607000
IOPISEQ3 EQU   IOPINAM3+6                                               02608000
IOPITYP3 EQU   @NM00050+5                                               02609000
IOPIPTF3 EQU   @NM00050                                                 02610000
@NM00176 EQU   HMASMGTP+27                                              02611000
GTPPSIZE EQU   GTPFLGS1                                                 02612000
@NM00175 EQU   GTPFLGS1                                                 02613000
GTPRCDNF EQU   GTPFLGS1                                                 02614000
GTPNOSPM EQU   GTPFLGS1                                                 02615000
GTPPOS   EQU   GTPRESTR+8                                               02616000
GTPRCD   EQU   GTPRESTR+4                                               02617000
GTPPAG   EQU   GTPRESTR                                                 02618000
GTPBUFAD EQU   HMASMGTP+12                                              02619000
GTPWKAD  EQU   HMASMGTP+8                                               02620000
GTPKEYLN EQU   HMASMGTP+6                                               02621000
GTPRCDLN EQU   HMASMGTP+4                                               02622000
@NM00174 EQU   HMASMGTP+2                                               02623000
GTPRETRN EQU   HMASMGTP+1                                               02624000
GTPFUNCT EQU   HMASMGTP                                                 02625000
ICTLEN   EQU   ICTGMSPL+1                                               02626000
ICTSP    EQU   ICTGMSPL                                                 02627000
ICTLLEN  EQU   ICTLSPLN+1                                               02628000
ICTLSP   EQU   ICTLSPLN                                                 02629000
ICTMLEN  EQU   ICTMSPLN+1                                               02630000
ICTMSP   EQU   ICTMSPLN                                                 02631000
ICTPLEN  EQU   ICTPSPLN+1                                               02632000
ICTPSP   EQU   ICTPSPLN                                                 02633000
IOPBS04E EQU   IOPBS04+2                                                02634000
IOPBAPFC EQU   IOPBAPF+1                                                02635000
IOPBAPFL EQU   IOPBAPF                                                  02636000
IOPBS2NM EQU   IOPBS02+3                                                02637000
IOPBS2EP EQU   IOPBS02                                                  02638000
IOPQSMTP EQU   IOPQSMLS+8                                               02639000
@NM00156 EQU   IOPQSMLS+7                                               02640000
IOPQSMND EQU   IOPQSMNM                                                 02641000
@NM00155 EQU   @NM00154+7                                               02642000
IOPQSMFM EQU   @NM00154                                                 02643000
@NM00074 EQU   IOPLMCTL+17                                              02644000
IOPLMCRD EQU   IOPLMCTL+9                                               02645000
IOPLMCRN EQU   IOPLMCTL+1                                               02646000
IOPLMCC  EQU   IOPLMCTL                                                 02647000
@NM00049 EQU   IOPUSERL                                                 02648000
@NM00048 EQU   IOPUSERL                                                 02649000
IOPALIS  EQU   IOPUSERL                                                 02650000
IOPTTR   EQU   IOPDRMAP+8                                               02651000
IOPINAM2 EQU   IOPINAM+1                                                02652000
IOPITYP2 EQU   IOPITYP                                                  02653000
@NM00047 EQU   HMASMIOP+32                                              02654000
IOPDELDD EQU   IOPDDNAM                                                 02655000
@NM00046 EQU   @NM00043+10                                              02656000
IOPSEQNO EQU   @NM00043+8                                               02657000
@NM00045 EQU   @NM00044+7                                               02658000
IOPPTFNM EQU   @NM00044                                                 02659000
IOPNAM17 EQU   IOPNAME                                                  02660000
CCABMREC EQU   CCABELMT+10                                              02661000
CCABPOS  EQU   CCABMPOS+8                                               02662000
CCABNAME EQU   CCABMPOS                                                 02663000
@NM00042 EQU   CCABLDLM+2                                               02664000
@NM00041 EQU   CCABLDLM                                                 02665000
CCAUPDPM EQU   @NM00039+24                                              02666000
@NM00040 EQU   @NM00039+21                                              02667000
CCARUPDT EQU   CCAUPDRC                                                 02668000
CCAUPDSP EQU   @NM00039+12                                              02669000
CCAUPDTE EQU   @NM00039+8                                               02670000
CCAUPDNM EQU   @NM00039                                                 02671000
CCASUPPM EQU   @NM00037+24                                              02672000
@NM00038 EQU   @NM00037+21                                              02673000
CCARSUP  EQU   CCASUPRC                                                 02674000
CCASUPSP EQU   @NM00037+12                                              02675000
CCAIOSUP EQU   @NM00037+8                                               02676000
CCASUPNM EQU   @NM00037                                                 02677000
CCAZAPPM EQU   @NM00035+24                                              02678000
@NM00036 EQU   @NM00035+21                                              02679000
CCARZAP  EQU   CCAZAPRC                                                 02680000
CCAZAPSP EQU   @NM00035+12                                              02681000
CCASPZAP EQU   @NM00035+8                                               02682000
CCAZAPNM EQU   @NM00035                                                 02683000
CCACOMPM EQU   @NM00033+24                                              02684000
@NM00034 EQU   @NM00033+21                                              02685000
CCARCOMP EQU   CCACOMRC                                                 02686000
CCACOMSP EQU   @NM00033+12                                              02687000
CCACOMRS EQU   @NM00033+8                                               02688000
CCACOMNM EQU   @NM00033                                                 02689000
CCACPYPM EQU   @NM00031+24                                              02690000
@NM00032 EQU   @NM00031+21                                              02691000
CCARCOPY EQU   CCACPYRC                                                 02692000
CCACPYSP EQU   @NM00031+12                                              02693000
CCACOPY  EQU   @NM00031+8                                               02694000
CCACPYNM EQU   @NM00031                                                 02695000
CCAASMPM EQU   @NM00029+24                                              02696000
@NM00030 EQU   @NM00029+21                                              02697000
CCARASM  EQU   CCAASMRC                                                 02698000
CCAASMSP EQU   @NM00029+12                                              02699000
CCAASM   EQU   @NM00029+8                                               02700000
CCAASMNM EQU   @NM00029                                                 02701000
CCALKDPM EQU   @NM00027+24                                              02702000
@NM00028 EQU   @NM00027+21                                              02703000
CCARLINK EQU   CCALKDRC                                                 02704000
CCALKDSP EQU   @NM00027+12                                              02705000
CCALKED  EQU   @NM00027+8                                               02706000
CCALKDNM EQU   @NM00027                                                 02707000
CCAPGMPM EQU   @NM00025+24                                              02708000
@NM00026 EQU   @NM00025+21                                              02709000
CCABPGRC EQU   @NM00025+20                                              02710000
CCABPGSP EQU   @NM00025+12                                              02711000
CCABPGAD EQU   @NM00025+8                                               02712000
CCABPGNM EQU   @NM00025                                                 02713000
CCAEND   EQU   HMASMCCA+371                                             02714000
@NM00024 EQU   HMASMCCA+309                                             02715000
CCACURDD EQU   CCAFDSNG+3                                               02716000
CCACURDS EQU   CCAFDSNG+2                                               02717000
@NM00023 EQU   CCAFLAGB                                                 02718000
@NM00022 EQU   CCAFLAG9                                                 02719000
CCARVCAN EQU   CCAFLAG9                                                 02720000
CCARVEST EQU   CCAFLAG9                                                 02721000
CCAPTSNJ EQU   CCAFLAG9                                                 02722000
CCASTSNP EQU   CCAFLAG9                                                 02723000
CCAMTSNP EQU   CCAFLAG9                                                 02724000
CCAPTSNP EQU   CCAFLAG9                                                 02725000
@NM00021 EQU   CCAFLAG8                                                 02726000
CCAACDSC EQU   CCAFLAG8                                                 02727000
CCACDSC  EQU   CCAFLAG8                                                 02728000
@NM00020 EQU   CCAFLAG6                                                 02729000
CCAACRUP EQU   CCAFLAG6                                                 02730000
CCACRQUP EQU   CCAFLAG6                                                 02731000
CCAACDUP EQU   CCAFLAG6                                                 02732000
CCACDSUP EQU   CCAFLAG6                                                 02733000
@NM00019 EQU   CCAFLAG5                                                 02734000
CCAACROS EQU   CCAFLAG5                                                 02735000
CCACRQOS EQU   CCAFLAG5                                                 02736000
CCAACDOS EQU   CCAFLAG5                                                 02737000
CCACDSOS EQU   CCAFLAG5                                                 02738000
@NM00018 EQU   CCAFLAG4                                                 02739000
CCAACRIS EQU   CCAFLAG4                                                 02740000
CCACRQIS EQU   CCAFLAG4                                                 02741000
CCAACDIS EQU   CCAFLAG4                                                 02742000
CCACDSIS EQU   CCAFLAG4                                                 02743000
@NM00017 EQU   CCAFLAG3+1                                               02744000
CCARGNP  EQU   CCAFLAG3+1                                               02745000
CCADISRQ EQU   CCAFLAG3+1                                               02746000
CCAICTOK EQU   CCAFLAG3                                                 02747000
CCADELP  EQU   CCAFLAG3                                                 02748000
CCACMPRS EQU   CCAFLAG3                                                 02749000
CCAZAPP  EQU   CCAFLAG3                                                 02750000
CCALINKP EQU   CCAFLAG3                                                 02751000
CCACOPYP EQU   CCAFLAG3                                                 02752000
CCAASIP  EQU   CCAFLAG3                                                 02753000
CCAUPDP  EQU   CCAFLAG3                                                 02754000
CCAEOSMP EQU   CCAFLAG2                                                 02755000
CCAEOFNC EQU   CCAFLAG2                                                 02756000
@NM00016 EQU   CCAFLAG2                                                 02757000
CCACHECK EQU   CCAFLAG2                                                 02758000
CCATERM  EQU   CCAFLAG2                                                 02759000
CCASVCLB EQU   CCAFLAG2                                                 02760000
CCANCPTF EQU   CCAFLAG2                                                 02761000
@NM00015 EQU   CCAFLAG1+1                                               02762000
CCAUNL   EQU   CCAFLAG1+1                                               02763000
CCARESET EQU   CCAFLAG1+1                                               02764000
CCALOG   EQU   CCAFLAG1+1                                               02765000
CCACNV   EQU   CCAFLAG1+1                                               02766000
CCALIST  EQU   CCAFLAG1                                                 02767000
CCAUPDU  EQU   CCAFLAG1                                                 02768000
CCAUPDJ  EQU   CCAFLAG1                                                 02769000
CCARES   EQU   CCAFLAG1                                                 02770000
CCAREJ   EQU   CCAFLAG1                                                 02771000
CCAACCPT EQU   CCAFLAG1                                                 02772000
CCAAPPLY EQU   CCAFLAG1                                                 02773000
CCAREC   EQU   CCAFLAG1                                                 02774000
CCAFUNCT EQU   CCAFFUNC                                                 02775000
@NM00014 EQU   @NM00009+18                                              02776000
@NM00013 EQU   @NM00009+16                                              02777000
CCATBLPA EQU   @NM00009+12                                              02778000
@NM00012 EQU   @NM00009+8                                               02779000
@NM00011 EQU   @NM00009+4                                               02780000
@NM00010 EQU   @NM00009                                                 02781000
CCAIFGTP EQU   CCAFGTP+16                                               02782000
CCAGTP3  EQU   CCAFGTP+12                                               02783000
CCAGTP2  EQU   CCAFGTP+8                                                02784000
CCAGTP1  EQU   CCAFGTP+4                                                02785000
CCASETAD EQU   CCASEGTP                                                 02786000
CCACLST  EQU   CCAFPGM+12                                               02787000
CCASPDCB EQU   CCAFPGM+8                                                02788000
CCAICLMD EQU   CCAFICT+12                                               02789000
CCAICMOD EQU   CCAFICT+8                                                02790000
CCAICPTF EQU   CCAFICT+4                                                02791000
CCARVAD  EQU   CCAFSTA                                                  02792000
CCAACDID EQU   CCAFSYS+32                                               02793000
CCACDSID EQU   CCAFSYS+24                                               02794000
CCALNLEN EQU   CCAFSYS+22                                               02795000
@NM00008 EQU   CCAFLAGA                                                 02796000
CCANUCID EQU   CCAFSYS+20                                               02797000
CCAASREL EQU   CCAFSYS+16                                               02798000
CCACSREL EQU   CCASREL                                                  02799000
CCAPEMAX EQU   CCAFSYS+10                                               02800000
CCAPGLEN EQU   CCAFSYS+8                                                02801000
CCAPESIZ EQU   CCAFIOP+4                                                02802000
@NM00007 EQU   CCAFLAG7+3                                               02803000
CCASLBP  EQU   CCAFLAG7+2                                               02804000
CCAJCLP  EQU   CCAFLAG7+2                                               02805000
CCAPTFP  EQU   CCAFLAG7+2                                               02806000
CCATLBP  EQU   CCAFLAG7+2                                               02807000
CCAUT3P  EQU   CCAFLAG7+1                                               02808000
CCAUT2P  EQU   CCAFLAG7+1                                               02809000
CCAUT1P  EQU   CCAFLAG7+1                                               02810000
@NM00006 EQU   CCAFBUFR+122                                             02811000
@NM00005 EQU   CCAFBUFR+120                                             02812000
@NM00004 EQU   CCAFBUFR+118                                             02813000
CCATBFMX EQU   CCAFBUFR+116                                             02814000
@NM00003 EQU   CCAFBUFR+88                                              02815000
@NM00002 EQU   CCAFBUFR+84                                              02816000
CCATBFSZ EQU   CCAFBUFR+76                                              02817000
@NM00001 EQU   CCAFBUFR+52                                              02818000
CCATBFIA EQU   CCAFBUFR+40                                              02819000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      02820000
@RC00682 EQU   @EL00004                                                 02821000
@RC00690 EQU   @EL00005                                                 02822000
@RC00699 EQU   @EL00006                                                 02823000
@RC00700 EQU   @RC00699                                                 02824000
@RF00703 EQU   @RC00700                                                 02825000
@ENDDATA EQU   *                                                        02826000
         END   HMASMDSU,(C'PLS2013',0802,78334)                         02827000
