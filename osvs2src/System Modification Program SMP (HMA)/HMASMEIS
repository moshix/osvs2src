         TITLE 'HMASMEIS - SMP ENTRIES IN STORAGE'                      00001000
HMASMEIS CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'HMASMEIS  78.334'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00009000
         BALR  @12,0                                               0001 00010000
@PSTART  LA    @10,4095(,@12)                                      0001 00011000
         LA    @09,4095(,@10)                                      0001 00012000
         USING @PSTART,@12                                         0001 00013000
         USING @PSTART+4095,@10                                    0001 00014000
         USING @PSTART+8190,@09                                    0001 00015000
         ST    @13,@SA00001+4                                      0001 00016000
         LA    @14,@SA00001                                        0001 00017000
         ST    @14,8(,@13)                                         0001 00018000
         LR    @13,@14                                             0001 00019000
         MVC   @PC00001(4),0(@01)                                  0001 00020000
*                                                                  0179 00021000
*   /*****************************************************************/ 00022000
*   /*                                                               */ 00023000
*   /* THE FIRST SEGMENT OF CODE WILL PERFORM INITIALIZATION FOR     */ 00024000
*   /* HMASMEIS. THE DATA SET ID AND FUNCTION IN THE IOP PASSED BY   */ 00025000
*   /* THE USER ARE CHECKED TO SEE IF THEY ARE SUPPORTED BY HMASMEIS.*/ 00026000
*   /* IF THEY ARE NOT A RETURN CODE OF 16 IS SET                    */ 00027000
*   /*                                                               */ 00028000
*   /*****************************************************************/ 00029000
*                                                                  0179 00030000
*   EISRC=IOPGOOD;                  /* INIT RC TO GOOD               */ 00031000
         SLR   EISRC,EISRC                                         0179 00032000
*   EISSW1='';                      /* INIT TO INVALID DATA SET AND     00033000
*                                      TO INVALID FUNCTION           */ 00034000
         MVI   EISSW1,X'00'                                        0180 00035000
*   IOPPTR=ADDR(EISMIOP);           /* ADDRESS OF INPUT PARM         */ 00036000
*                                                                  0181 00037000
         L     IOPPTR,@PC00001                                     0181 00038000
*   /*****************************************************************/ 00039000
*   /*                                                               */ 00040000
*   /* CALL ROUTINE TO SETUP VARIOUS INDICIES TO ARRAY AND GTPS USED */ 00041000
*   /* DURING PROCESSING. ALSO CHECK PARAMETER LIST FOR VALIDITY     */ 00042000
*   /*                                                               */ 00043000
*   /*****************************************************************/ 00044000
*                                                                  0182 00045000
*                                   /*                               */ 00046000
*   CALL EISSETUP;                  /*                               */ 00047000
         BAL   @14,EISSETUP                                        0182 00048000
*   RFY                                                            0183 00049000
*     RTNCODE RSTD;                 /*                               */ 00050000
*   EISRC=MAX(EISRC,RTNCODE);       /*                               */ 00051000
         CR    EISRC,RTNCODE                                       0184 00052000
         BNL   *+6                                                      00053000
         LR    EISRC,RTNCODE                                       0184 00054000
*   RFY                                                            0185 00055000
*     RTNCODE UNRSTD;               /*                               */ 00056000
         EJECT                                                          00057000
*                                                                  0186 00058000
*   /*****************************************************************/ 00059000
*   /*                                                               */ 00060000
*   /* BASED ON THE VALUE IN FNCINDX DETERMINE THE PROPER SUBROUTINE */ 00061000
*   /* TO CALL AND CALL IT. SGTPINDX IS SET UP TO USE THE GTP FOR THE*/ 00062000
*   /* DIS GTP TO USE THIS TIME                                      */ 00063000
*   /*                                                               */ 00064000
*   /*****************************************************************/ 00065000
*                                                                  0186 00066000
*   IF EISRC=IOPGOOD                /* IF VALID DSID AND FUNC        */ 00067000
*     THEN                          /* THEN DO                       */ 00068000
         SLR   @11,@11                                             0186 00069000
         CR    EISRC,@11                                           0186 00070000
         BNE   @RF00186                                            0186 00071000
*     DO;                           /* THEN DO                       */ 00072000
*       IF DSFIRST(PGTPINDX)=ZERO   /* IF FIRST TIME FOR THIS DIS  0188 00073000
*                                      FILE                  @Z67SP00*/ 00074000
*         THEN                      /* ACCESS FOR DATASET            */ 00075000
         SLR   @08,@08                                             0188 00076000
         IC    @08,PGTPINDX                                        0188 00077000
         SLR   @05,@05                                             0188 00078000
         IC    @05,DSFIRST-1(@08)                                  0188 00079000
         CR    @11,@05                                             0188 00080000
         BNE   @RF00188                                            0188 00081000
*         DO;                       /*                       @Z67SP00*/ 00082000
*           HMASMGTP(PGTPINDX)=''B; /* ZERO PROPER GTP       @Z67SP00*/ 00083000
         LR    @11,@08                                             0190 00084000
         MH    @11,@CH00467                                        0190 00085000
         LA    @05,HMASMGTP-28(@11)                                0190 00086000
         XC    0(28,@05),0(@05)                                    0190 00087000
*           GTPRCDLN(PGTPINDX)=DSDIRLN(PDSINDX);/* SET RCD LEN FROM     00088000
*                                      VALUE IN CONTROL ARRAY      0191 00089000
*                                                            @Z67SP00*/ 00090000
         LR    @05,PDSINDX                                         0191 00091000
         MH    @05,@CH01521                                        0191 00092000
         SLR   @02,@02                                             0191 00093000
         IC    @02,DSDIRLN-103(@05)                                0191 00094000
         STH   @02,GTPRCDLN-28(@11)                                0191 00095000
*           GTPKEYLN(PGTPINDX)=KEYLEN;/* KEY LEN = 8         @Z67SP00*/ 00096000
         LA    @05,8                                               0192 00097000
         STH   @05,GTPKEYLN-28(@11)                                0192 00098000
*           GTPNOSPM(PGTPINDX)=ON;  /* NO MSG IF UNABLE TO ADD RCD TO   00099000
*                                      FILE                  @Z67SP00*/ 00100000
         LA    @05,GTPNOSPM-28(@11)                                0193 00101000
         OI    0(@05),B'10000000'                                  0193 00102000
*           DSFIRST(PGTPINDX)=ONE;  /* SET NOT FIRST SW      @Z67SP00*/ 00103000
         LA    @11,1                                               0194 00104000
         STC   @11,DSFIRST-1(@08)                                  0194 00105000
*         END;                      /*                       @Z67SP00*/ 00106000
*       IF DSFIRST(SGTPINDX)=ZERO   /* IF FIRST TIME FOR THIS DIS  0196 00107000
*                                      FILE                  @Z67SP00*/ 00108000
*         THEN                      /* ACCESS FOR DATASET            */ 00109000
@RF00188 SLR   @11,@11                                             0196 00110000
         IC    @11,SGTPINDX                                        0196 00111000
         SLR   @08,@08                                             0196 00112000
         IC    @08,DSFIRST-1(@11)                                  0196 00113000
         CH    @08,@CH00252                                        0196 00114000
         BNE   @RF00196                                            0196 00115000
*         DO;                       /*                       @Z67SP00*/ 00116000
*           HMASMGTP(SGTPINDX)=''B; /* ZERO PROPER GTP       @Z67SP00*/ 00117000
         LR    @08,@11                                             0198 00118000
         MH    @08,@CH00467                                        0198 00119000
         LA    @05,HMASMGTP-28(@08)                                0198 00120000
         XC    0(28,@05),0(@05)                                    0198 00121000
*           GTPRCDLN(SGTPINDX)=DSDIRLN(SDSINDX);/* SET RCD LEN FROM     00122000
*                                      VALUE IN CONTROL ARRAY      0199 00123000
*                                                            @Z67SP00*/ 00124000
         SLR   @05,@05                                             0199 00125000
         IC    @05,SDSINDX                                         0199 00126000
         MH    @05,@CH01521                                        0199 00127000
         SLR   @02,@02                                             0199 00128000
         IC    @02,DSDIRLN-103(@05)                                0199 00129000
         STH   @02,GTPRCDLN-28(@08)                                0199 00130000
*           GTPKEYLN(SGTPINDX)=KEYLEN;/* KEY LEN = 8         @Z67SP00*/ 00131000
         LA    @05,8                                               0200 00132000
         STH   @05,GTPKEYLN-28(@08)                                0200 00133000
*           GTPNOSPM(SGTPINDX)=ON;  /* NO MSG IF UNABLE TO ADD RCD TO   00134000
*                                      FILE                  @Z67SP00*/ 00135000
         LA    @05,GTPNOSPM-28(@08)                                0201 00136000
         OI    0(@05),B'10000000'                                  0201 00137000
*           DSFIRST(SGTPINDX)=ONE;  /* SET NOT FIRST SW      @Z67SP00*/ 00138000
         LA    @08,1                                               0202 00139000
         STC   @08,DSFIRST-1(@11)                                  0202 00140000
*         END;                      /*                       @Z67SP00*/ 00141000
*       CALL EISRTN;                /* PERFORM FUNCTION              */ 00142000
@RF00196 SLR   @11,@11                                             0204 00143000
         IC    @11,FNCINDX                                         0204 00144000
         SLA   @11,3                                               0204 00145000
         L     @15,FNCADDR-8(@11)                                  0204 00146000
         BALR  @14,@15                                             0204 00147000
*       RFY                                                        0205 00148000
*         RTNCODE RSTD;                                            0205 00149000
*       EISRC=RTNCODE;              /* SAVE EISRTN RETURN CODE       */ 00150000
         LR    EISRC,RTNCODE                                       0206 00151000
*       RFY                                                        0207 00152000
*         RTNCODE UNRSTD;                                          0207 00153000
*     END;                                                         0208 00154000
*   IOPRETRN=EISRC;                 /* RETURN CODE TO USER           */ 00155000
@RF00186 STC   EISRC,IOPRETRN(,IOPPTR)                             0209 00156000
*   RETURN CODE(EISRC);                                            0210 00157000
         LR    @15,EISRC                                           0210 00158000
         L     @13,4(,@13)                                         0210 00159000
         L     @14,12(,@13)                                        0210 00160000
         LM    @00,@12,20(@13)                                     0210 00161000
         BR    @14                                                 0210 00162000
         EJECT                                                          00163000
*                                                                  0211 00164000
*   /*****************************************************************/ 00165000
*   /*                                                               */ 00166000
*   /* ROUTINE CALLED TO VERIFY THE INPUT PARAMETER FOR VALID        */ 00167000
*   /* FUNCTION AND DATASETID. IF BOTH ARE OK THEN THIS ROUTINE WILL */ 00168000
*   /* ALSO SET UP VARIOUS INDICIES INTO THE GTP ARRAY AND OTHER     */ 00169000
*   /* ARRAYS IN THE MODULE FOR BOTH THE PRIMARY AND SECONDARY       */ 00170000
*   /* PROCESSING FILES.                                             */ 00171000
*   /*                                                               */ 00172000
*   /*****************************************************************/ 00173000
*                                                                  0211 00174000
*EISSETUP:                          /*                               */ 00175000
*   PROCEDURE;                      /*                               */ 00176000
EISSETUP STM   @14,@02,12(@13)                                     0211 00177000
         STM   @04,@12,36(@13)                                     0211 00178000
*   DECLARE                         /*                               */ 00179000
*     SETUPRC FIXED(8);             /* LOCAL RC                      */ 00180000
*   RFY                             /*                       @Z67SP00*/ 00181000
*     HMASMIOP BASED(IOPPTR);       /*                       @Z67SP00*/ 00182000
*   SETUPRC=ZERO;                   /* INIT RC                       */ 00183000
*                                                                  0214 00184000
         SLR   SETUPRC,SETUPRC                                     0214 00185000
*   /*****************************************************************/ 00186000
*   /*                                                               */ 00187000
*   /* CHECK TO INSURE DATASET VALID. IF NOT SET RC=16               */ 00188000
*   /*                                                               */ 00189000
*   /*****************************************************************/ 00190000
*                                                                  0215 00191000
*   DO PDSINDX=ONE TO DIM(DSARRAY)  /* SEE IF DSID SUPPORTED         */ 00192000
*         WHILE(VALDSNSW=OFF);                                     0215 00193000
         LA    PDSINDX,1                                           0215 00194000
@DL00215 TM    VALDSNSW,B'10000000'                                0215 00195000
         BNZ   @DC00215                                            0215 00196000
*     IF IOPDSID=DSMAIN(PDSINDX)    /* IF MATCH THEN TURN VALID      */ 00197000
*       THEN                        /*                               */ 00198000
         LR    @11,PDSINDX                                         0216 00199000
         MH    @11,@CH01521                                        0216 00200000
         SLR   @08,@08                                             0216 00201000
         IC    @08,IOPDSID(,IOPPTR)                                0216 00202000
         SLR   @05,@05                                             0216 00203000
         IC    @05,DSMAIN-103(@11)                                 0216 00204000
         CR    @08,@05                                             0216 00205000
         BNE   @RF00216                                            0216 00206000
*       VALDSNSW=ON;                /* DATASET SWITCH ON             */ 00207000
         OI    VALDSNSW,B'10000000'                                0217 00208000
*   END;                                                           0218 00209000
@RF00216 AH    PDSINDX,@CH00087                                    0218 00210000
         CH    PDSINDX,@CH00112                                    0218 00211000
         BNH   @DL00215                                            0218 00212000
@DC00215 DS    0H                                                  0219 00213000
*   IF VALDSNSW=ON                  /* IF VALID DATASET      @Z67SP00*/ 00214000
*     THEN                          /*                               */ 00215000
         TM    VALDSNSW,B'10000000'                                0219 00216000
         BNO   @RF00219                                            0219 00217000
*     DO;                           /*                       @Z67SP00*/ 00218000
*       PDSINDX=PDSINDX-ONE;        /* SET PRIMARY INDEX     @Z67SP00*/ 00219000
         BCTR  PDSINDX,0                                           0221 00220000
*       SDSINDX=PDSINDX+NUMDS/2;    /* SET SECONDARY INDEX   @Z67SP00*/ 00221000
         LA    @11,4(,PDSINDX)                                     0222 00222000
         STC   @11,SDSINDX                                         0222 00223000
*     END;                          /*                       @Z67SP00*/ 00224000
*   ELSE                            /* INVALID DATASET       @Z67SP00*/ 00225000
*     SETUPRC=IOPIOERR;             /*                               */ 00226000
*                                                                  0224 00227000
         B     @RC00219                                            0224 00228000
@RF00219 LA    SETUPRC,16                                          0224 00229000
*   /*****************************************************************/ 00230000
*   /*                                                               */ 00231000
*   /* CHECK TO INSURE FUNCTION REQUESTED VALID. IF NOT SET RC=16.   */ 00232000
*   /*                                                               */ 00233000
*   /*****************************************************************/ 00234000
*                                                                  0225 00235000
*   IF SETUPRC=ZERO                 /* IF VALID DSID THEN CHECK      */ 00236000
*     THEN                                                         0225 00237000
@RC00219 CH    SETUPRC,@CH00252                                    0225 00238000
         BNE   @RF00225                                            0225 00239000
*     DO;                           /*                       @Z67SP00*/ 00240000
*       DO FNCINDX=ONE TO DIM(FNCARRAY)/* FOR VALID FUNCTION         */ 00241000
*             WHILE(VALFNCSW=OFF);  /*                               */ 00242000
         LA    @11,1                                               0227 00243000
         STC   @11,FNCINDX                                         0227 00244000
@DL00227 TM    VALFNCSW,B'01000000'                                0227 00245000
         BNZ   @DC00227                                            0227 00246000
*         IF IOPFUNCT=FNCIOPCD(FNCINDX)/* IF MATCH THEN TURN VALID   */ 00247000
*           THEN                    /*                               */ 00248000
         SLA   @11,3                                               0228 00249000
         SLR   @08,@08                                             0228 00250000
         IC    @08,IOPFUNCT(,IOPPTR)                               0228 00251000
         SLR   @05,@05                                             0228 00252000
         IC    @05,FNCIOPCD-8(@11)                                 0228 00253000
         CR    @08,@05                                             0228 00254000
         BNE   @RF00228                                            0228 00255000
*           VALFNCSW=ON;            /* FUNCTION SWITCH ON            */ 00256000
         OI    VALFNCSW,B'01000000'                                0229 00257000
*       END;                                                       0230 00258000
@RF00228 LA    @11,1                                               0230 00259000
         SLR   @08,@08                                             0230 00260000
         IC    @08,FNCINDX                                         0230 00261000
         ALR   @11,@08                                             0230 00262000
         STC   @11,FNCINDX                                         0230 00263000
         CH    @11,@CH00436                                        0230 00264000
         BNH   @DL00227                                            0230 00265000
@DC00227 DS    0H                                                  0231 00266000
*       IF VALFNCSW=ON              /* IF FUNCTION VALID     @Z67SP00*/ 00267000
*         THEN                      /*                       @Z67SP00*/ 00268000
         TM    VALFNCSW,B'01000000'                                0231 00269000
         BNO   @RF00231                                            0231 00270000
*         FNCINDX=FNCINDX-ONE;      /* ADJUST INDEX          @Z67SP00*/ 00271000
         SLR   @11,@11                                             0232 00272000
         IC    @11,FNCINDX                                         0232 00273000
         BCTR  @11,0                                               0232 00274000
         STC   @11,FNCINDX                                         0232 00275000
*       ELSE                        /*                       @Z67SP00*/ 00276000
*         SETUPRC=IOPIOERR;         /* RC=16                 @Z67SP00*/ 00277000
         B     @RC00231                                            0233 00278000
@RF00231 LA    SETUPRC,16                                          0233 00279000
*     END;                                                         0234 00280000
*                                                                  0234 00281000
@RC00231 DS    0H                                                  0235 00282000
*   /*****************************************************************/ 00283000
*   /*                                                               */ 00284000
*   /* IF FUNCTION AND DATASET OK THEN SET UP INDEX FOR CORRECT GTP  */ 00285000
*   /* TO USE DURING PROCESS BASED ON DATASET AND TYPE ENTRY. IF     */ 00286000
*   /* INVALID COMBINATION SET RC=16.                                */ 00287000
*   /*                                                               */ 00288000
*   /*****************************************************************/ 00289000
*                                                                  0235 00290000
*   IF SETUPRC=ZERO                 /*                       @Z67SP00*/ 00291000
*     THEN                          /*                       @Z67SP00*/ 00292000
@RF00225 CH    SETUPRC,@CH00252                                    0235 00293000
         BNE   @RF00235                                            0235 00294000
*     DO;                           /*                       @Z67SP00*/ 00295000
*       IF IOPFUNCT=IOPINIT         /* USE FIRST GTP FILE    @Z67SP00*/ 00296000
*           |IOPFUNCT=IOPFREE       /* FOR THESE FUNCTIONS   @Z67SP00*/ 00297000
*           |IOPFUNCT=IOPCLOSN      /*                       @Z67SP00*/ 00298000
*           |IOPFUNCT=IOPWRDIR      /*                       @Z67SP00*/ 00299000
*         THEN                      /*                       @Z67SP00*/ 00300000
         CLI   IOPFUNCT(IOPPTR),8                                  0237 00301000
         BE    @RT00237                                            0237 00302000
         CLI   IOPFUNCT(IOPPTR),9                                  0237 00303000
         BE    @RT00237                                            0237 00304000
         CLI   IOPFUNCT(IOPPTR),12                                 0237 00305000
         BE    @RT00237                                            0237 00306000
         CLI   IOPFUNCT(IOPPTR),89                                 0237 00307000
         BNE   @RF00237                                            0237 00308000
@RT00237 DS    0H                                                  0238 00309000
*         DO;                       /*                       @Z67SP00*/ 00310000
*           PGTPINDX=DSGTPFRS(PDSINDX);/*                    @Z67SP00*/ 00311000
         LA    @11,103                                             0239 00312000
         LR    @01,PDSINDX                                         0239 00313000
         MR    @00,@11                                             0239 00314000
         SLR   @08,@08                                             0239 00315000
         IC    @08,DSGTPFRS-103(@01)                               0239 00316000
         STC   @08,PGTPINDX                                        0239 00317000
*           SGTPINDX=DSGTPFRS(SDSINDX);/*                    @Z67SP00*/ 00318000
         LR    @01,@11                                             0240 00319000
         SLR   @11,@11                                             0240 00320000
         IC    @11,SDSINDX                                         0240 00321000
         MR    @00,@11                                             0240 00322000
         SLR   @11,@11                                             0240 00323000
         IC    @11,DSGTPFRS-103(@01)                               0240 00324000
         STC   @11,SGTPINDX                                        0240 00325000
*         END;                      /*                       @Z67SP00*/ 00326000
*       ELSE                        /*                       @Z67SP00*/ 00327000
*         IF IOPFUNCT=IOPLOC        /* GTP BASED ON TYPE AND @Z67SP00*/ 00328000
*             |IOPFUNCT=IOPBLDL     /*                       @Z67SP00*/ 00329000
*             |IOPFUNCT=IOPUDEO     /* DATASET FOR THESE     @Z67SP00*/ 00330000
*             |IOPFUNCT=IOPSTOWR    /* FUNCTIONS             @Z67SP00*/ 00331000
*             |IOPFUNCT=IOPSTOWD    /*                       @Z67SP00*/ 00332000
*           THEN                    /*                       @Z67SP00*/ 00333000
         B     @RC00237                                            0242 00334000
@RF00237 CLI   IOPFUNCT(IOPPTR),3                                  0242 00335000
         BE    @RT00242                                            0242 00336000
         CLI   IOPFUNCT(IOPPTR),4                                  0242 00337000
         BE    @RT00242                                            0242 00338000
         CLI   IOPFUNCT(IOPPTR),86                                 0242 00339000
         BE    @RT00242                                            0242 00340000
         CLI   IOPFUNCT(IOPPTR),84                                 0242 00341000
         BE    @RT00242                                            0242 00342000
         CLI   IOPFUNCT(IOPPTR),83                                 0242 00343000
         BNE   @RF00242                                            0242 00344000
@RT00242 DS    0H                                                  0243 00345000
*           DO;                     /*                       @Z67SP00*/ 00346000
*             PGTPINDX=GTP(IOPTYPE,PDSINDX);/*               @Z67SP00*/ 00347000
         SLR   @11,@11                                             0244 00348000
         IC    @11,IOPTYPE(,IOPPTR)                                0244 00349000
         SLA   @11,3                                               0244 00350000
         LR    @08,PDSINDX                                         0244 00351000
         ALR   @08,@11                                             0244 00352000
         SLR   @05,@05                                             0244 00353000
         IC    @05,GTP-9(@08)                                      0244 00354000
         STC   @05,PGTPINDX                                        0244 00355000
*             SGTPINDX=GTP(IOPTYPE,SDSINDX);/*               @Z67SP00*/ 00356000
         SLR   @08,@08                                             0245 00357000
         IC    @08,SDSINDX                                         0245 00358000
         ALR   @11,@08                                             0245 00359000
         SLR   @08,@08                                             0245 00360000
         IC    @08,GTP-9(@11)                                      0245 00361000
         STC   @08,SGTPINDX                                        0245 00362000
*           END;                    /*                       @Z67SP00*/ 00363000
*         ELSE                      /*                       @Z67SP00*/ 00364000
*           IF IOPFUNCT=IOPSTOWC    /*                       @Z67SP00*/ 00365000
*             THEN                  /*                       @Z67SP00*/ 00366000
         B     @RC00242                                            0247 00367000
@RF00242 CLI   IOPFUNCT(IOPPTR),82                                 0247 00368000
         BNE   @RF00247                                            0247 00369000
*             DO;                   /*                       @Z67SP00*/ 00370000
*               PGTPINDX=GTP(IOPOTYPE,PDSINDX);/*            @Z67SP00*/ 00371000
         SLR   @11,@11                                             0249 00372000
         IC    @11,IOPOTYPE(,IOPPTR)                               0249 00373000
         SLA   @11,3                                               0249 00374000
         LR    @08,PDSINDX                                         0249 00375000
         ALR   @08,@11                                             0249 00376000
         SLR   @05,@05                                             0249 00377000
         IC    @05,GTP-9(@08)                                      0249 00378000
         STC   @05,PGTPINDX                                        0249 00379000
*               SGTPINDX=GTP(IOPOTYPE,SDSINDX);/*            @Z67SP00*/ 00380000
         SLR   @08,@08                                             0250 00381000
         IC    @08,SDSINDX                                         0250 00382000
         ALR   @11,@08                                             0250 00383000
         SLR   @08,@08                                             0250 00384000
         IC    @08,GTP-9(@11)                                      0250 00385000
         STC   @08,SGTPINDX                                        0250 00386000
*             END;                  /*                       @Z67SP00*/ 00387000
*           ELSE                    /*                       @Z67SP00*/ 00388000
*             IF IOPFUNCT=IOPGETN   /* USE CURRENT GETN      @Z67SP00*/ 00389000
*               THEN                /*                       @Z67SP00*/ 00390000
         B     @RC00247                                            0252 00391000
@RF00247 CLI   IOPFUNCT(IOPPTR),10                                 0252 00392000
         BNE   @RF00252                                            0252 00393000
*               DO;                 /*                       @Z67SP00*/ 00394000
*                 PGTPINDX=DSGTPGN(PDSINDX);/*               @Z67SP00*/ 00395000
         LA    @11,103                                             0254 00396000
         LR    @01,PDSINDX                                         0254 00397000
         MR    @00,@11                                             0254 00398000
         SLR   @08,@08                                             0254 00399000
         IC    @08,DSGTPGN-103(@01)                                0254 00400000
         STC   @08,PGTPINDX                                        0254 00401000
*                 SGTPINDX=DSGTPGN(SDSINDX);/*               @Z67SP00*/ 00402000
         LR    @01,@11                                             0255 00403000
         SLR   @11,@11                                             0255 00404000
         IC    @11,SDSINDX                                         0255 00405000
         MR    @00,@11                                             0255 00406000
         SLR   @11,@11                                             0255 00407000
         IC    @11,DSGTPGN-103(@01)                                0255 00408000
         STC   @11,SGTPINDX                                        0255 00409000
*               END;                /*                       @Z67SP00*/ 00410000
*       IF PGTPINDX=ZERO            /* IF NO PRIME GTP       @Z67SP00*/ 00411000
*         THEN                      /* THEN INVALID          @Z67SP00*/ 00412000
@RF00252 DS    0H                                                  0257 00413000
@RC00247 DS    0H                                                  0257 00414000
@RC00242 DS    0H                                                  0257 00415000
@RC00237 CLI   PGTPINDX,0                                          0257 00416000
         BNE   @RF00257                                            0257 00417000
*         SETUPRC=IOPIOERR;         /* COMBINATION           @Z67SP00*/ 00418000
         LA    SETUPRC,16                                          0258 00419000
*     END;                          /*                       @Z67SP00*/ 00420000
@RF00257 DS    0H                                                  0260 00421000
*   RETURN CODE(SETUPRC);           /*                       @Z67SP00*/ 00422000
@RF00235 LR    @15,SETUPRC                                         0260 00423000
         L     @14,12(,@13)                                        0260 00424000
         LM    @00,@02,20(@13)                                     0260 00425000
         LM    @04,@12,36(@13)                                     0260 00426000
         BR    @14                                                 0260 00427000
*   END EISSETUP;                   /*                       @Z67SP00*/ 00428000
         EJECT                                                          00429000
*                                                                  0262 00430000
*   /*****************************************************************/ 00431000
*   /*                                                               */ 00432000
*   /* THIS ROUTINE IS CALLED TO INITIALLY LOAD UP THE DIS FILE FROM */ 00433000
*   /* THE APPROPRIATE SMP DATASET.                                  */ 00434000
*   /*                                                               */ 00435000
*   /*****************************************************************/ 00436000
*                                                                  0262 00437000
*EISINIT:                                                          0262 00438000
*   PROC;                                                          0262 00439000
EISINIT  STM   @14,@12,@SA00003                                    0262 00440000
*   DECLARE                         /*                       @Z67SP00*/ 00441000
*     INITIOP CHAR(LENGTH(HMASMIOP)+LENGTH(IOPDIRMX));/* IOP FOR IO     00442000
*                                      CALLS                         */ 00443000
*   DECLARE                         /*                       @Z67SP00*/ 00444000
*     INITPTR PTR(31);              /* PTR TO LOCAL IOP      @Z67SP00*/ 00445000
*   DECLARE                         /*                       @Z67SP00*/ 00446000
*     INITRC FIXED(8);              /* EISINIT RETURN CODE           */ 00447000
*   RFY                                                            0266 00448000
*     HMASMIOP BASED(INITPTR);                                     0266 00449000
*   INITRC=IOPGOOD;                 /* INIT RETURN CODE TO SUCCESSFUL*/ 00450000
         SLR   INITRC,INITRC                                       0267 00451000
*   INITPTR=ADDR(INITIOP);          /*                       @Z67SP00*/ 00452000
         LA    INITPTR,INITIOP                                     0268 00453000
*   IOPDSID=DSMAIN(PDSINDX);        /* PUT DSID IN IOP               */ 00454000
         LR    @11,PDSINDX                                         0269 00455000
         MH    @11,@CH01521                                        0269 00456000
         SLR   @08,@08                                             0269 00457000
         IC    @08,DSMAIN-103(@11)                                 0269 00458000
         STC   @08,IOPDSID(,INITPTR)                               0269 00459000
*   IOPFUNCT=IOPCLOSN;              /* CLOSE FILE FOR GETN PROCESS   */ 00460000
         MVI   IOPFUNCT(INITPTR),X'0C'                             0270 00461000
*   CALL HMASMIO(HMASMIOP);         /* CALL IO TO RETRIEVE RECORD    */ 00462000
         ST    INITPTR,@AL00001                                    0271 00463000
         L     @15,@CV01269                                        0271 00464000
         LA    @01,@AL00001                                        0271 00465000
         BALR  @14,@15                                             0271 00466000
*   INITRC=MAX(INITRC,IOPRETRN);    /* SAVE RC                       */ 00467000
         SLR   @11,@11                                             0272 00468000
         IC    @11,IOPRETRN(,INITPTR)                              0272 00469000
         CR    INITRC,@11                                          0272 00470000
         BNL   *+6                                                      00471000
         LR    INITRC,@11                                          0272 00472000
*   IF INITRC=IOPGOOD               /* IF VALID REQUEST AND DS       */ 00473000
*       &CCACHECK=OFF               /* AND NOT CHECK         @Z67SP00*/ 00474000
*     THEN                          /* CLOSED OK                     */ 00475000
         SLR   @11,@11                                             0273 00476000
         CR    INITRC,@11                                          0273 00477000
         BNE   @RF00273                                            0273 00478000
         L     @08,@CA00037                                        0273 00479000
         TM    CCACHECK-HMASMCCA(@08),B'00010000'                  0273 00480000
         BNZ   @RF00273                                            0273 00481000
*     DO;                           /*                               */ 00482000
*       TMPINDX=PGTPINDX;           /* SAVE FIRST GTP INDEX  @Z67SP00*/ 00483000
         SLR   TMPINDX,TMPINDX                                     0275 00484000
         IC    TMPINDX,PGTPINDX                                    0275 00485000
*       IOPFUNCT=IOPGETNC;          /* REQUEST GET NEXT WITH COUNT   */ 00486000
         MVI   IOPFUNCT(INITPTR),X'0B'                             0276 00487000
*       GTPRETRN(TMPINDX)=GTPGOOD;  /* SET RC                        */ 00488000
         LR    @08,TMPINDX                                         0277 00489000
         MH    @08,@CH00467                                        0277 00490000
         STC   @11,GTPRETRN-28(@08)                                0277 00491000
*       DO MEMUSE=0 BY 1 WHILE(     /* LOOP COUNTING ENTS    @Z67SP00*/ 00492000
*             GTPRETRN(TMPINDX)=GTPGOOD/* RETRIEVE AND ADD RCD TO  0278 00493000
*                                      FILE                          */ 00494000
*             &IOPRETRN=IOPGOOD);   /* WHILE IO & GTA RC'S=ZERO      */ 00495000
         LR    MEMUSE,@11                                          0278 00496000
         B     @DE00278                                            0278 00497000
@DL00278 DS    0H                                                  0279 00498000
*         CALL HMASMIO(HMASMIOP);   /* CALL IO TO RETRIEVE RECORD    */ 00499000
         ST    INITPTR,@AL00001                                    0279 00500000
         L     @15,@CV01269                                        0279 00501000
         LA    @01,@AL00001                                        0279 00502000
         BALR  @14,@15                                             0279 00503000
*         IF IOPRETRN=IOPGOOD       /* IF RECORD RETRIEVED THEN DO   */ 00504000
*           THEN                                                   0280 00505000
         CLI   IOPRETRN(INITPTR),0                                 0280 00506000
         BNE   @RF00280                                            0280 00507000
*           DO;                     /*                               */ 00508000
*             TMPINDX=GTP(IOPTYPE,PDSINDX);/* GTP TO USE     @Z67SP00*/ 00509000
         SLR   @11,@11                                             0282 00510000
         IC    @11,IOPTYPE(,INITPTR)                               0282 00511000
         SLA   @11,3                                               0282 00512000
         ALR   @11,PDSINDX                                         0282 00513000
         SLR   TMPINDX,TMPINDX                                     0282 00514000
         IC    TMPINDX,GTP-9(@11)                                  0282 00515000
*             IF DSFIRST(TMPINDX)=ZERO/* IF GTP NOT INIT     @Z67SP00*/ 00516000
*               THEN                /*                       @Z67SP00*/ 00517000
         SLR   @11,@11                                             0283 00518000
         IC    @11,DSFIRST-1(TMPINDX)                              0283 00519000
         CH    @11,@CH00252                                        0283 00520000
         BNE   @RF00283                                            0283 00521000
*               DO;                 /*                       @Z67SP00*/ 00522000
*                 HMASMGTP(TMPINDX)=''B;/*                   @Z67SP00*/ 00523000
         LR    @11,TMPINDX                                         0285 00524000
         MH    @11,@CH00467                                        0285 00525000
         LA    @08,HMASMGTP-28(@11)                                0285 00526000
         XC    0(28,@08),0(@08)                                    0285 00527000
*                 GTPRCDLN(TMPINDX)=DSDIRLN(PDSINDX);/*      @Z67SP00*/ 00528000
         LR    @08,PDSINDX                                         0286 00529000
         MH    @08,@CH01521                                        0286 00530000
         SLR   @07,@07                                             0286 00531000
         IC    @07,DSDIRLN-103(@08)                                0286 00532000
         STH   @07,GTPRCDLN-28(@11)                                0286 00533000
*                 GTPKEYLN(TMPINDX)=KEYLEN;/*                @Z67SP00*/ 00534000
         LA    @08,8                                               0287 00535000
         STH   @08,GTPKEYLN-28(@11)                                0287 00536000
*                 GTPNOSPM(TMPINDX)=ON;/*                    @Z67SP00*/ 00537000
         LA    @08,GTPNOSPM-28(@11)                                0288 00538000
         OI    0(@08),B'10000000'                                  0288 00539000
*                 DSFIRST(TMPINDX)=ONE;/* GTA INIT           @Z67SP00*/ 00540000
         LA    @11,1                                               0289 00541000
         STC   @11,DSFIRST-1(TMPINDX)                              0289 00542000
*               END;                /*                       @Z67SP00*/ 00543000
*             GTPBUFAD(TMPINDX)=ADDR(IOPDRMAP);/* RECORD FROM TO ADD    00544000
*                                      VIA GTA                       */ 00545000
@RF00283 LR    @11,TMPINDX                                         0291 00546000
         MH    @11,@CH00467                                        0291 00547000
         LA    @08,IOPDRMAP(,INITPTR)                              0291 00548000
         ST    @08,GTPBUFAD-28(@11)                                0291 00549000
*             GTPFUNCT(TMPINDX)=GTPADD;/* ADD TO IN STORAGE FILE   0292 00550000
*                                                            @Z67SP00*/ 00551000
         LA    @08,4                                               0292 00552000
         STC   @08,GTPFUNCT-28(@11)                                0292 00553000
*             CALL HMASMGTA(HMASMGTP(TMPINDX));/* ADD VIA CALL TO GTA   00554000
*                                                            @Z67SP00*/ 00555000
         LA    @11,HMASMGTP-28(@11)                                0293 00556000
         ST    @11,@AL00001                                        0293 00557000
         L     @15,@CV01268                                        0293 00558000
         LA    @01,@AL00001                                        0293 00559000
         BALR  @14,@15                                             0293 00560000
*           END;                                                   0294 00561000
*       END;                        /* END RETRIEVE AND ADD          */ 00562000
@RF00280 AH    MEMUSE,@CH00087                                     0295 00563000
@DE00278 LR    @11,TMPINDX                                         0295 00564000
         MH    @11,@CH00467                                        0295 00565000
         SLR   @08,@08                                             0295 00566000
         IC    @08,GTPRETRN-28(@11)                                0295 00567000
         CH    @08,@CH00252                                        0295 00568000
         BNE   @DC00278                                            0295 00569000
         CLI   IOPRETRN(INITPTR),0                                 0295 00570000
         BE    @DL00278                                            0295 00571000
@DC00278 DS    0H                                                  0296 00572000
*       IF IOPRETRN=IOPEOF          /* IF NO MORE CDS ENTRIES        */ 00573000
*         THEN                      /* THEN DO                       */ 00574000
         CLI   IOPRETRN(INITPTR),4                                 0296 00575000
         BNE   @RF00296                                            0296 00576000
*         DO;                       /*                       @Z67SP00*/ 00577000
*           DSBLKCT(PDSINDX)=IOPALLOC;/* SAVE COUNT OF ALLOCATED BLKS*/ 00578000
         LR    @11,PDSINDX                                         0298 00579000
         MH    @11,@CH01521                                        0298 00580000
         L     @08,IOPALLOC(,INITPTR)                              0298 00581000
         ST    @08,DSBLKCT-103(@11)                                0298 00582000
*           DSMEMMAX(PDSINDX)=IOPALLOC*(LENGTH(OUTFILL)/DSDIRLN(PDSINDX 00583000
*               ));                 /* MAX ENTRIES EQUALS NUMBER OF     00584000
*                                      ALLOCATED BLOCKS TIMES MAX PER   00585000
*                                      BLOCK                 @Z67SP00*/ 00586000
         LA    @01,254                                             0299 00587000
         SLR   @00,@00                                             0299 00588000
         SLR   @07,@07                                             0299 00589000
         IC    @07,DSDIRLN-103(@11)                                0299 00590000
         DR    @00,@07                                             0299 00591000
         LR    @15,@08                                             0299 00592000
         MR    @14,@01                                             0299 00593000
         ST    @15,DSMEMMAX-103(@11)                               0299 00594000
*           DSMEMUSE(PDSINDX)=MEMUSE;/* SET COUNT OF ENTS    @Z67SP00*/ 00595000
         ST    MEMUSE,DSMEMUSE-103(@11)                            0300 00596000
*         END;                      /*                       @Z67SP00*/ 00597000
*       ELSE                        /*                               */ 00598000
*         INITRC=MAX(INITRC,IOPRETRN,GTPRETRN(TMPINDX));/* SAVE RC   */ 00599000
         B     @RC00296                                            0302 00600000
@RF00296 SLR   @11,@11                                             0302 00601000
         IC    @11,IOPRETRN(,INITPTR)                              0302 00602000
         CR    @11,INITRC                                          0302 00603000
         BNL   *+6                                                      00604000
         LR    @11,INITRC                                          0302 00605000
         LR    @08,TMPINDX                                         0302 00606000
         MH    @08,@CH00467                                        0302 00607000
         SLR   @15,@15                                             0302 00608000
         IC    @15,GTPRETRN-28(@08)                                0302 00609000
         CR    @11,@15                                             0302 00610000
         BNL   *+6                                                      00611000
         LR    @11,@15                                             0302 00612000
         LR    INITRC,@11                                          0302 00613000
*       IF INITRC>IOPEOF            /* IF IO ERROR OR OUT OF IN      */ 00614000
*         THEN                      /* STORAGE SPACE THEN DO         */ 00615000
@RC00296 CH    INITRC,@CH00039                                     0303 00616000
         BNH   @RF00303                                            0303 00617000
*         DO;                       /*                               */ 00618000
*           CALL EISFREE;           /* FREE FILE BUILT       @Z67SP00*/ 00619000
         BAL   @14,EISFREE                                         0305 00620000
*           RFY                                                    0306 00621000
*             RTNCODE RSTD;         /*                       @Z67SP00*/ 00622000
*           INITRC=MAX(INITRC,RTNCODE);/* SAVE RC            @Z67SP00*/ 00623000
         CR    INITRC,RTNCODE                                      0307 00624000
         BNL   *+6                                                      00625000
         LR    INITRC,RTNCODE                                      0307 00626000
*           RFY                                                    0308 00627000
*             RTNCODE UNRSTD;       /*                       @Z67SP00*/ 00628000
*           LOADOKSW=OFF;           /* DIR NOT LOADED        @Z67SP00*/ 00629000
         NI    LOADOKSW,B'11011111'                                0309 00630000
*         END;                                                     0310 00631000
*       ELSE                        /* IF IN STORAGE FILE INITIALIZED*/ 00632000
*         DO;                                                      0311 00633000
         B     @RC00303                                            0311 00634000
@RF00303 DS    0H                                                  0312 00635000
*           LOADOKSW=ON;            /* DIR LOADED OK         @Z67SP00*/ 00636000
         OI    LOADOKSW,B'00100000'                                0312 00637000
*           TMPINDX=DSGTPFRS(PDSINDX);/* FIRST GTP OF FILE   @Z67SP00*/ 00638000
         LR    @11,PDSINDX                                         0313 00639000
         MH    @11,@CH01521                                        0313 00640000
         SLR   TMPINDX,TMPINDX                                     0313 00641000
         IC    TMPINDX,DSGTPFRS-103(@11)                           0313 00642000
*           GTPFUNCT(TMPINDX)=GTPOPENN;/* POS TO START       @Z67SP00*/ 00643000
         LR    @11,TMPINDX                                         0314 00644000
         MH    @11,@CH00467                                        0314 00645000
         LA    @08,1                                               0314 00646000
         STC   @08,GTPFUNCT-28(@11)                                0314 00647000
*           CALL HMASMGTA(HMASMGTP(TMPINDX));/* VIA CALL TO GTA      */ 00648000
         LA    @11,HMASMGTP-28(@11)                                0315 00649000
         ST    @11,@AL00001                                        0315 00650000
         L     @15,@CV01268                                        0315 00651000
         LA    @01,@AL00001                                        0315 00652000
         BALR  @14,@15                                             0315 00653000
*           INITRC=GTPRETRN(TMPINDX);/* SAVE GTA RETURN CODE         */ 00654000
         LR    @11,TMPINDX                                         0316 00655000
         MH    @11,@CH00467                                        0316 00656000
         SLR   INITRC,INITRC                                       0316 00657000
         IC    INITRC,GTPRETRN-28(@11)                             0316 00658000
*           DSGTPGN(PDSINDX)=TMPINDX;/* GTP FOR NEXT GETN    @Z67SP00*/ 00659000
         LA    @11,103                                             0317 00660000
         LR    @01,PDSINDX                                         0317 00661000
         MR    @00,@11                                             0317 00662000
         STC   TMPINDX,DSGTPGN-103(@01)                            0317 00663000
*           DSGTPGN(SDSINDX)=DSGTPFRS(SDSINDX);/*            @Z67SP00*/ 00664000
         LR    @01,@11                                             0318 00665000
         SLR   @11,@11                                             0318 00666000
         IC    @11,SDSINDX                                         0318 00667000
         MR    @00,@11                                             0318 00668000
         SLR   @11,@11                                             0318 00669000
         IC    @11,DSGTPFRS-103(@01)                               0318 00670000
         STC   @11,DSGTPGN-103(@01)                                0318 00671000
*         END;                                                     0319 00672000
*       IOPFUNCT=IOPCLOSN;          /* SET UP TO CLOSE FOR GETN      */ 00673000
@RC00303 MVI   IOPFUNCT(INITPTR),X'0C'                             0320 00674000
*       CALL HMASMIO(HMASMIOP);     /* CALL IO TO DO CLOSE           */ 00675000
         ST    INITPTR,@AL00001                                    0321 00676000
         L     @15,@CV01269                                        0321 00677000
         LA    @01,@AL00001                                        0321 00678000
         BALR  @14,@15                                             0321 00679000
*       INITRC=MAX(INITRC,IOPRETRN);/* SAVE MAXIMUM RETURN CODE      */ 00680000
         SLR   @11,@11                                             0322 00681000
         IC    @11,IOPRETRN(,INITPTR)                              0322 00682000
         CR    INITRC,@11                                          0322 00683000
         BNL   *+6                                                      00684000
         LR    INITRC,@11                                          0322 00685000
*       IOPFUNCT=IOPCLOSE;          /* SET UP TO CLOSE FOR DATA      */ 00686000
         MVI   IOPFUNCT(INITPTR),X'50'                             0323 00687000
*       CALL HMASMIO(HMASMIOP);     /* CALL IO TO DO CLOSE           */ 00688000
         ST    INITPTR,@AL00001                                    0324 00689000
         L     @15,@CV01269                                        0324 00690000
         LA    @01,@AL00001                                        0324 00691000
         BALR  @14,@15                                             0324 00692000
*       INITRC=MAX(INITRC,IOPRETRN);/* SAVE MAXIMUM RETURN CODE      */ 00693000
         SLR   @11,@11                                             0325 00694000
         IC    @11,IOPRETRN(,INITPTR)                              0325 00695000
         CR    INITRC,@11                                          0325 00696000
         BNL   *+6                                                      00697000
         LR    INITRC,@11                                          0325 00698000
*       IF LOADOKSW=ON              /* IF DIR LOADED         @Z67SP00*/ 00699000
*         THEN                      /* THEN                  @Z67SP00*/ 00700000
         TM    LOADOKSW,B'00100000'                                0326 00701000
         BNO   @RF00326                                            0326 00702000
*         CCAFLAG4=CCAFLAG4|DSMSKON(PDSINDX);/* TURN ON DIRECTORY IN    00703000
*                                      STORAGE INDICATOR             */ 00704000
         L     @11,@CA00037                                        0327 00705000
         LR    @08,PDSINDX                                         0327 00706000
         MH    @08,@CH01521                                        0327 00707000
         LA    @04,DSMSKON-103(@08)                                0327 00708000
         OC    CCAFLAG4-HMASMCCA(1,@11),0(@04)                     0327 00709000
*     END;                          /* END OF INITIAL SUCCESSFUL   0328 00710000
*                                      CLOSE OPERATION               */ 00711000
@RF00326 DS    0H                                                  0329 00712000
*   RETURN CODE(INITRC);                                           0329 00713000
@RF00273 LR    @15,INITRC                                          0329 00714000
         L     @14,@SA00003                                        0329 00715000
         LM    @00,@12,@SA00003+8                                  0329 00716000
         BR    @14                                                 0329 00717000
*   END EISINIT;                                                   0330 00718000
         EJECT                                                          00719000
*                                                                  0331 00720000
*   /*****************************************************************/ 00721000
*   /*                                                               */ 00722000
*   /* ROUTINE TO FREE THE GTA FILE ASSOCIATED WITH EITHER THE       */ 00723000
*   /* PRIMARY AND/OR SECONDARY DIS FILES                    @Z67SP00*/ 00724000
*   /*                                                               */ 00725000
*   /*****************************************************************/ 00726000
*                                                                  0331 00727000
*EISFREE:                           /*                       @Z67SP00*/ 00728000
*   PROC;                           /*                       @Z67SP00*/ 00729000
EISFREE  STM   @14,@12,@SA00004                                    0331 00730000
*   DECLARE                         /*                       @Z67SP00*/ 00731000
*     FREERC FIXED(8);              /*                       @Z67SP00*/ 00732000
*   FREERC=IOPGOOD;                 /* INIT RETURN CODE      @Z67SP00*/ 00733000
*                                                                  0333 00734000
         SLR   FREERC,FREERC                                       0333 00735000
*   /*****************************************************************/ 00736000
*   /*                                                               */ 00737000
*   /* FREE SECONDARY DIS FILE IN ALL CASES (CHECK OR NOT)   @Z67SP00*/ 00738000
*   /*                                                               */ 00739000
*   /*****************************************************************/ 00740000
*                                                                  0334 00741000
*   DO TMPINDX=DSGTPFRS(SDSINDX) TO DSGTPLST(SDSINDX);/*     @Z67SP00   00742000
*                                                            @Z67SP00*/ 00743000
         SLR   @11,@11                                             0334 00744000
         IC    @11,SDSINDX                                         0334 00745000
         MH    @11,@CH01521                                        0334 00746000
         SLR   TMPINDX,TMPINDX                                     0334 00747000
         IC    TMPINDX,DSGTPFRS-103(@11)                           0334 00748000
         B     @DE00334                                            0334 00749000
@DL00334 DS    0H                                                  0335 00750000
*     IF DSFIRST(TMPINDX)=ONE       /* IF GTP INIT ALREADY   @Z67SP00*/ 00751000
*       THEN                        /*                       @Z67SP00*/ 00752000
         SLR   @11,@11                                             0335 00753000
         IC    @11,DSFIRST-1(TMPINDX)                              0335 00754000
         CH    @11,@CH00087                                        0335 00755000
         BNE   @RF00335                                            0335 00756000
*       DO;                         /*                       @Z67SP00*/ 00757000
*         GTPFUNCT(TMPINDX)=GTPFREE;/* SET TO FREE PRIMARY   @Z67SP00*/ 00758000
         LR    @11,TMPINDX                                         0337 00759000
         MH    @11,@CH00467                                        0337 00760000
         LA    @08,10                                              0337 00761000
         STC   @08,GTPFUNCT-28(@11)                                0337 00762000
*         CALL HMASMGTA(HMASMGTP(TMPINDX));/* FREE PRIMARY   @Z67SP00*/ 00763000
         LA    @11,HMASMGTP-28(@11)                                0338 00764000
         ST    @11,@AL00001                                        0338 00765000
         L     @15,@CV01268                                        0338 00766000
         LA    @01,@AL00001                                        0338 00767000
         BALR  @14,@15                                             0338 00768000
*         FREERC=MAX(FREERC,GTPRETRN(TMPINDX));/* SAVE RC    @Z67SP00*/ 00769000
         LR    @11,TMPINDX                                         0339 00770000
         MH    @11,@CH00467                                        0339 00771000
         SLR   @08,@08                                             0339 00772000
         IC    @08,GTPRETRN-28(@11)                                0339 00773000
         CR    FREERC,@08                                          0339 00774000
         BNL   *+6                                                      00775000
         LR    FREERC,@08                                          0339 00776000
*         DSFIRST(TMPINDX)=ZERO;    /* GTP NOT INIT          @Z67SP00*/ 00777000
         SLR   @11,@11                                             0340 00778000
         STC   @11,DSFIRST-1(TMPINDX)                              0340 00779000
*       END;                        /*                       @Z67SP00*/ 00780000
*   END;                            /* END GTP LOOP          @Z67SP00*/ 00781000
@RF00335 AH    TMPINDX,@CH00087                                    0342 00782000
@DE00334 SLR   @11,@11                                             0342 00783000
         IC    @11,SDSINDX                                         0342 00784000
         MH    @11,@CH01521                                        0342 00785000
         SLR   @08,@08                                             0342 00786000
         IC    @08,DSGTPLST-103(@11)                               0342 00787000
         CR    TMPINDX,@08                                         0342 00788000
         BNH   @DL00334                                            0342 00789000
*   IF CCACHECK=OFF                 /* IF NOT IN CHECK MODE  @Z67SP00*/ 00790000
*     THEN                          /*                       @Z67SP00*/ 00791000
         L     @11,@CA00037                                        0343 00792000
         TM    CCACHECK-HMASMCCA(@11),B'00010000'                  0343 00793000
         BNZ   @RF00343                                            0343 00794000
*     DO;                           /*                       @Z67SP00*/ 00795000
*       DO TMPINDX=DSGTPFRS(PDSINDX) TO DSGTPLST(PDSINDX);/* @Z67SP00*/ 00796000
         LR    @11,PDSINDX                                         0345 00797000
         MH    @11,@CH01521                                        0345 00798000
         SLR   TMPINDX,TMPINDX                                     0345 00799000
         IC    TMPINDX,DSGTPFRS-103(@11)                           0345 00800000
         B     @DE00345                                            0345 00801000
@DL00345 DS    0H                                                  0346 00802000
*         IF DSFIRST(TMPINDX)=ONE   /* IF GTP INIT ALREADY   @Z67SP00*/ 00803000
*           THEN                    /*                       @Z67SP00*/ 00804000
         SLR   @11,@11                                             0346 00805000
         IC    @11,DSFIRST-1(TMPINDX)                              0346 00806000
         CH    @11,@CH00087                                        0346 00807000
         BNE   @RF00346                                            0346 00808000
*           DO;                     /*                       @Z67SP00*/ 00809000
*             GTPFUNCT(TMPINDX)=GTPFREE;/* SET TO FREE PRIM  @Z67SP00*/ 00810000
         LR    @11,TMPINDX                                         0348 00811000
         MH    @11,@CH00467                                        0348 00812000
         LA    @08,10                                              0348 00813000
         STC   @08,GTPFUNCT-28(@11)                                0348 00814000
*             CALL HMASMGTA(HMASMGTP(TMPINDX));/* FREE PRIM  @Z67SP00*/ 00815000
         LA    @11,HMASMGTP-28(@11)                                0349 00816000
         ST    @11,@AL00001                                        0349 00817000
         L     @15,@CV01268                                        0349 00818000
         LA    @01,@AL00001                                        0349 00819000
         BALR  @14,@15                                             0349 00820000
*             FREERC=MAX(FREERC,GTPRETRN(TMPINDX));/* SV RC  @Z67SP00*/ 00821000
         LR    @11,TMPINDX                                         0350 00822000
         MH    @11,@CH00467                                        0350 00823000
         SLR   @08,@08                                             0350 00824000
         IC    @08,GTPRETRN-28(@11)                                0350 00825000
         CR    FREERC,@08                                          0350 00826000
         BNL   *+6                                                      00827000
         LR    FREERC,@08                                          0350 00828000
*             DSFIRST(TMPINDX)=ZERO;/* GTP NOT INIT          @Z67SP00*/ 00829000
         SLR   @11,@11                                             0351 00830000
         STC   @11,DSFIRST-1(TMPINDX)                              0351 00831000
*           END;                    /*                       @Z67SP00*/ 00832000
*       END;                        /* END GTP LOOP          @Z67SP00*/ 00833000
@RF00346 AH    TMPINDX,@CH00087                                    0353 00834000
@DE00345 LR    @11,PDSINDX                                         0353 00835000
         MH    @11,@CH01521                                        0353 00836000
         SLR   @08,@08                                             0353 00837000
         IC    @08,DSGTPLST-103(@11)                               0353 00838000
         CR    TMPINDX,@08                                         0353 00839000
         BNH   @DL00345                                            0353 00840000
*       CCAFLAG4=CCAFLAG4&DSMSKOFF(PDSINDX);/* DIS NOT LOADED INTO 0354 00841000
*                                      STORAGE               @Z67SP00*/ 00842000
         L     @11,@CA00037                                        0354 00843000
         LR    @08,PDSINDX                                         0354 00844000
         MH    @08,@CH01521                                        0354 00845000
         LA    @05,DSMSKOFF-103(@08)                               0354 00846000
         NC    CCAFLAG4-HMASMCCA(1,@11),0(@05)                     0354 00847000
*       CCAFLAG6=CCAFLAG6&DSMSKOFF(PDSINDX);/* DIS NOT UPDATED IN  0355 00848000
*                                      STORAGE               @Z67SP00*/ 00849000
         LA    @05,DSMSKOFF-103(@08)                               0355 00850000
         NC    CCAFLAG6-HMASMCCA(1,@11),0(@05)                     0355 00851000
*       DSMEMMAX(PDSINDX)=ZERO;     /* NO DIR BLKS ALLOC     @Z67SP00*/ 00852000
         SLR   @11,@11                                             0356 00853000
         ST    @11,DSMEMMAX-103(@08)                               0356 00854000
*       DSMEMUSE(PDSINDX)=ONE;      /* ONE FOR EOF MEMBER    @Z67SP00*/ 00855000
         LA    @11,1                                               0357 00856000
         ST    @11,DSMEMUSE-103(@08)                               0357 00857000
*     END;                          /*                       @Z67SP00*/ 00858000
*   RETURN CODE(FREERC);            /* RETURN                @Z67SP00*/ 00859000
@RF00343 LR    @15,FREERC                                          0359 00860000
         L     @14,@SA00004                                        0359 00861000
         LM    @00,@12,@SA00004+8                                  0359 00862000
         BR    @14                                                 0359 00863000
*   END EISFREE;                    /*                       @Z67SP00*/ 00864000
         EJECT                                                          00865000
*                                                                  0361 00866000
*   /*****************************************************************/ 00867000
*   /*                                                               */ 00868000
*   /* ROUTINE CALLED TO LOCATE ENTRY IN DIS FILE. IF IN CHECK MODE  */ 00869000
*   /* THEN SECONDARY IS SEARCH FIRST AND THEN PRIMARY. IF NOT IN    */ 00870000
*   /* CHECK MODE THEN JUST PRIMARY IS SEARCHED              @Z67SP00*/ 00871000
*   /*                                                               */ 00872000
*   /*****************************************************************/ 00873000
*                                                                  0361 00874000
*EISLOC:                            /*                       @Z67SP00*/ 00875000
*                                                                  0361 00876000
*   /*****************************************************************/ 00877000
*   /*                                                               */ 00878000
*   /* ROUTINE CALLED TO HANDLE IOPBLDL OPERATIONS           @Z67SP00*/ 00879000
*   /*                                                               */ 00880000
*   /*****************************************************************/ 00881000
*                                                                  0361 00882000
*EISBLDL:                           /*                       @Z67SP00*/ 00883000
*   PROC;                           /*                       @Z67SP00*/ 00884000
EISLOC   DS    0H                                                  0361 00885000
EISBLDL  STM   @14,@12,@SA00005                                    0361 00886000
*   DECLARE                         /*                       @Z67SP00*/ 00887000
*     LOCRC FIXED(8);               /* PROC RETURN CODE      @Z67SP00*/ 00888000
*   RFY                                                            0363 00889000
*     HMASMIOP BASED(IOPPTR);       /* PASSED IOP            @Z67SP00*/ 00890000
*   LOCRC=IOPGOOD;                  /* INDICATE ENTRY FOUND  @Z67SP00*/ 00891000
         SLR   LOCRC,LOCRC                                         0364 00892000
*   FNDSW=OFF;                      /* ENTRY NOT FOUND SW    @Z67SP00*/ 00893000
         NI    FNDSW,B'11101111'                                   0365 00894000
*   IF CCACHECK=ON                  /* IF IN CHECK MODE      @Z67SP00*/ 00895000
*     THEN                          /* THEN                  @Z67SP00*/ 00896000
         L     @11,@CA00037                                        0366 00897000
         TM    CCACHECK-HMASMCCA(@11),B'00010000'                  0366 00898000
         BNO   @RF00366                                            0366 00899000
*     DO;                           /*                       @Z67SP00*/ 00900000
*       GTPFUNCT(SGTPINDX)=GTPLOC;  /* LOC ENTRY             @Z67SP00*/ 00901000
         SLR   @11,@11                                             0368 00902000
         IC    @11,SGTPINDX                                        0368 00903000
         MH    @11,@CH00467                                        0368 00904000
         LA    @08,3                                               0368 00905000
         STC   @08,GTPFUNCT-28(@11)                                0368 00906000
*       GTPBUFAD(SGTPINDX)=ADDR(DSBUFFR(SDSINDX));/* TMP BUFF      0369 00907000
*                                                            @Z67SP00*/ 00908000
         SLR   @08,@08                                             0369 00909000
         IC    @08,SDSINDX                                         0369 00910000
         MH    @08,@CH01521                                        0369 00911000
         LA    @05,DSBUFFR-103(@08)                                0369 00912000
         ST    @05,GTPBUFAD-28(@11)                                0369 00913000
*       DSBUFFR(SDSINDX,1:DSDIRLN(SDSINDX))=IOPDRMAP(1:DSDIRLN(SDSINDX) 00914000
*           );                      /* MOVE BUFFER           @Z67SP00*/ 00915000
         LA    @05,DSBUFFR-103(@08)                                0370 00916000
         SLR   @03,@03                                             0370 00917000
         IC    @03,DSDIRLN-103(@08)                                0370 00918000
         BCTR  @03,0                                               0370 00919000
         MVC   @TS00001(12),IOPDRMAP(IOPPTR)                       0370 00920000
         EX    @03,@SM01524                                        0370 00921000
*       CALL HMASMGTA(HMASMGTP(SGTPINDX));/* LOC RCD         @Z67SP00*/ 00922000
         LA    @11,HMASMGTP-28(@11)                                0371 00923000
         ST    @11,@AL00001                                        0371 00924000
         L     @15,@CV01268                                        0371 00925000
         LA    @01,@AL00001                                        0371 00926000
         BALR  @14,@15                                             0371 00927000
*       IF GTPRETRN(SGTPINDX)=GTPGOOD/* IF FOUND             @Z67SP00*/ 00928000
*         THEN                      /*                       @Z67SP00*/ 00929000
         SLR   @11,@11                                             0372 00930000
         IC    @11,SGTPINDX                                        0372 00931000
         MH    @11,@CH00467                                        0372 00932000
         SLR   @08,@08                                             0372 00933000
         IC    @08,GTPRETRN-28(@11)                                0372 00934000
         CH    @08,@CH00252                                        0372 00935000
         BNE   @RF00372                                            0372 00936000
*         DO;                       /*                       @Z67SP00*/ 00937000
*           FNDSW=ON;               /* ENTRY FOUND           @Z67SP00*/ 00938000
         OI    FNDSW,B'00010000'                                   0374 00939000
*           IF DSBFDEL(SDSINDX)^=TXTDEL/* IF MEM DELETED     @Z67SP00*/ 00940000
*             THEN                  /* THEN MOVE RCD TO IOP  @Z67SP00*/ 00941000
         SLR   @11,@11                                             0375 00942000
         IC    @11,SDSINDX                                         0375 00943000
         MH    @11,@CH01521                                        0375 00944000
         LA    @08,DSBFDEL-103(@11)                                0375 00945000
         CLC   0(8,@08),@CC01281                                   0375 00946000
         BE    @RF00375                                            0375 00947000
*             IOPDRMAP(1:DSDIRLN(SDSINDX))=DSBUFFR(SDSINDX,1:DSDIRLN(   00948000
*                 SDSINDX));        /* MOVE RCD TO IOP       @Z67SP00*/ 00949000
         SLR   @08,@08                                             0376 00950000
         IC    @08,DSDIRLN-103(@11)                                0376 00951000
         BCTR  @08,0                                               0376 00952000
         LA    @05,DSBUFFR-103(@11)                                0376 00953000
         EX    @08,@SM01526                                        0376 00954000
*           ELSE                    /* ELSE SET RC TO        @Z67SP00*/ 00955000
*             LOCRC=IOPNTFND;       /* INDICATE NOT FOUND    @Z67SP00*/ 00956000
         B     @RC00375                                            0377 00957000
@RF00375 LA    LOCRC,4                                             0377 00958000
*         END;                      /*                       @Z67SP00*/ 00959000
@RC00375 DS    0H                                                  0379 00960000
*     END;                          /*                       @Z67SP00*/ 00961000
@RF00372 DS    0H                                                  0380 00962000
*   IF FNDSW=OFF                    /* IF NOT FOUND YET      @Z67SP00*/ 00963000
*     THEN                          /* THEN TRY TO LOCATE    @Z67SP00*/ 00964000
@RF00366 TM    FNDSW,B'00010000'                                   0380 00965000
         BNZ   @RF00380                                            0380 00966000
*     DO;                           /* ON PRIMARY FILE       @Z67SP00*/ 00967000
*       GTPFUNCT(PGTPINDX)=GTPLOC;  /* LOC ENTRY             @Z67SP00*/ 00968000
         SLR   @11,@11                                             0382 00969000
         IC    @11,PGTPINDX                                        0382 00970000
         MH    @11,@CH00467                                        0382 00971000
         LA    @08,3                                               0382 00972000
         STC   @08,GTPFUNCT-28(@11)                                0382 00973000
*       GTPBUFAD(PGTPINDX)=ADDR(IOPDRMAP);/* INPUT BUFFER    @Z67SP00*/ 00974000
         LA    @08,IOPDRMAP(,IOPPTR)                               0383 00975000
         ST    @08,GTPBUFAD-28(@11)                                0383 00976000
*       CALL HMASMGTA(HMASMGTP(PGTPINDX));/* LOC RCD         @Z67SP00*/ 00977000
         LA    @11,HMASMGTP-28(@11)                                0384 00978000
         ST    @11,@AL00001                                        0384 00979000
         L     @15,@CV01268                                        0384 00980000
         LA    @01,@AL00001                                        0384 00981000
         BALR  @14,@15                                             0384 00982000
*       LOCRC=GTPRETRN(PGTPINDX);   /* SAVE RC               @Z67SP00*/ 00983000
         SLR   @11,@11                                             0385 00984000
         IC    @11,PGTPINDX                                        0385 00985000
         MH    @11,@CH00467                                        0385 00986000
         SLR   LOCRC,LOCRC                                         0385 00987000
         IC    LOCRC,GTPRETRN-28(@11)                              0385 00988000
*     END;                          /*                       @Z67SP00*/ 00989000
*                                                                  0386 00990000
*   /*****************************************************************/ 00991000
*   /*                                                               */ 00992000
*   /* RETURN WITH CODE FROM LOC/BLDL                        @Z67SP00*/ 00993000
*   /*                                                               */ 00994000
*   /*****************************************************************/ 00995000
*                                                                  0387 00996000
*   RETURN CODE(LOCRC);             /*                       @Z67SP00*/ 00997000
@RF00380 LR    @15,LOCRC                                           0387 00998000
         L     @14,@SA00005                                        0387 00999000
         LM    @00,@12,@SA00005+8                                  0387 01000000
         BR    @14                                                 0387 01001000
*   END EISLOC;                     /*                       @Z67SP00*/ 01002000
         EJECT                                                          01003000
*                                                                  0389 01004000
*   /*****************************************************************/ 01005000
*   /*                                                               */ 01006000
*   /* ROUTINE CALLED TO HANDLE SEQUENTIAL READS FROM THE DIRECTORY. */ 01007000
*   /* IF IN CHECK MODE THE SECONDARY DIS IS SEARCH FIRST AND ITS    */ 01008000
*   /* RESULT USED. IF NOT FOUND THEN THE PRIMARYS DIS IS OBTAINED   */ 01009000
*   /* AND RETURNED TO THE USER                              @Z67SP00*/ 01010000
*   /*                                                               */ 01011000
*   /*****************************************************************/ 01012000
*                                                                  0389 01013000
*EISGETN:                           /*                       @Z67SP00*/ 01014000
*   PROC;                           /*                       @Z67SP00*/ 01015000
EISGETN  STM   @14,@12,@SA00006                                    0389 01016000
*   DECLARE                         /*                       @Z67SP00*/ 01017000
*     GETNRC FIXED(8);              /* PROC RETURN CODE      @Z67SP00*/ 01018000
*   DECLARE                         /*                       @Z67SP00*/ 01019000
*     1 GETNSW BIT(8),              /*                       @Z67SP00*/ 01020000
*       3 PREAD BIT(1),             /*                       @Z67SP00*/ 01021000
*       3 SREAD BIT(1),             /*                       @Z67SP00*/ 01022000
*       3 DEL BIT(1),               /* RCD FOUND AS DEL IN SECONDARY    01023000
*                                      DIS FILE              @Z67SP00*/ 01024000
*       3 STOP BIT(1),              /* LOOP CONTROL          @Z67SP00*/ 01025000
*       3 STOP2 BIT(1),             /* LOOP CONTROL          @Z67SP00*/ 01026000
*       3 * BIT(3);                 /*                       @Z67SP00*/ 01027000
*   RFY                                                            0392 01028000
*     HMASMIOP BASED(IOPPTR);       /* PASSED IOP            @Z67SP00*/ 01029000
*   GETNRC=IOPGOOD;                 /* INIT RC               @Z67SP00*/ 01030000
         SLR   GETNRC,GETNRC                                       0393 01031000
*   DEL=ON;                         /* INIT SW SO LOOP WILL BE     0394 01032000
*                                      EXECUTED ONCE         @Z67SP00*/ 01033000
         OI    DEL,B'00100000'                                     0394 01034000
*   DO WHILE DEL=ON;                /* READ UNTIL NO DELETED RCD   0395 01035000
*                                      FOUND IN SECONDARY DIS      0395 01036000
*                                                            @Z67SP00*/ 01037000
         B     @DE00395                                            0395 01038000
@DL00395 DS    0H                                                  0396 01039000
*     GETNSW=OFF;                   /*                       @Z67SP00*/ 01040000
         MVI   GETNSW,B'00000000'                                  0396 01041000
*     DEL=OFF;                      /* STOP LOOP             @Z67SP00*/ 01042000
*                                                                  0397 01043000
         NI    DEL,B'11011111'                                     0397 01044000
*     /***************************************************************/ 01045000
*     /*                                                             */ 01046000
*     /* DETERMINE WHICH DIS FILES A READ SHOULD BE DONE FROM        */ 01047000
*     /*                                                     @Z67SP00*/ 01048000
*     /*                                                             */ 01049000
*     /***************************************************************/ 01050000
*                                                                  0398 01051000
*     IF CCACHECK=OFF               /* IF NOT IN CHECK MODE  @Z67SP00*/ 01052000
*       THEN                        /* THEN                  @Z67SP00*/ 01053000
         L     @11,@CA00037                                        0398 01054000
         TM    CCACHECK-HMASMCCA(@11),B'00010000'                  0398 01055000
         BNZ   @RF00398                                            0398 01056000
*       DO;                         /* READ FROM ONLY        @Z67SP00*/ 01057000
*         SEOF(PDSINDX)=ON;         /*                       @Z67SP00*/ 01058000
         LR    @11,PDSINDX                                         0400 01059000
         MH    @11,@CH01521                                        0400 01060000
         LA    @08,SEOF-103(@11)                                   0400 01061000
         OI    0(@08),B'01000000'                                  0400 01062000
*         IF PEOF(PDSINDX)=OFF      /* IF NOT EOF ON PRIMARY @Z67SP00*/ 01063000
*           THEN                    /* THEN READ FROM        @Z67SP00*/ 01064000
         LA    @08,PEOF-103(@11)                                   0401 01065000
         TM    0(@08),B'10000000'                                  0401 01066000
         BNZ   @RF00401                                            0401 01067000
*           PREAD=ON;               /* THE PRIMARY DIS       @Z67SP00*/ 01068000
         OI    PREAD,B'10000000'                                   0402 01069000
*         SREAD=OFF;                /*                       @Z67SP00*/ 01070000
@RF00401 NI    SREAD,B'10111111'                                   0403 01071000
*       END;                        /*                       @Z67SP00*/ 01072000
*     ELSE                          /*                       @Z67SP00*/ 01073000
*       IF DSBFNAME(PDSINDX)<DSBFNAME(SDSINDX)/* DETERMINE   @Z67SP00*/ 01074000
*           &PEOF(PDSINDX)=OFF      /*                       @Z67SP00*/ 01075000
*         THEN                      /* BUFFER TO READ FROM   @Z67SP00*/ 01076000
         B     @RC00398                                            0405 01077000
@RF00398 LA    @11,103                                             0405 01078000
         LR    @01,PDSINDX                                         0405 01079000
         MR    @00,@11                                             0405 01080000
         LR    @07,@11                                             0405 01081000
         SLR   @11,@11                                             0405 01082000
         IC    @11,SDSINDX                                         0405 01083000
         MR    @06,@11                                             0405 01084000
         LA    @11,DSBFNAME-103(@01)                               0405 01085000
         LA    @08,DSBFNAME-103(@07)                               0405 01086000
         CLC   0(8,@11),0(@08)                                     0405 01087000
         BNL   @RF00405                                            0405 01088000
         LA    @11,PEOF-103(@01)                                   0405 01089000
         TM    0(@11),B'10000000'                                  0405 01090000
         BNZ   @RF00405                                            0405 01091000
*         PREAD=ON;                 /* READ FROM PRINARY     @Z67SP00*/ 01092000
         OI    PREAD,B'10000000'                                   0406 01093000
*       ELSE                        /*                       @Z67SP00*/ 01094000
*         IF DSBFNAME(PDSINDX)>DSBFNAME(SDSINDX)/*           @Z67SP00*/ 01095000
*             &SEOF(PDSINDX)=OFF    /*                       @Z67SP00*/ 01096000
*           THEN                    /*                       @Z67SP00*/ 01097000
         B     @RC00405                                            0407 01098000
@RF00405 LA    @11,103                                             0407 01099000
         LR    @01,PDSINDX                                         0407 01100000
         MR    @00,@11                                             0407 01101000
         LR    @07,@11                                             0407 01102000
         SLR   @11,@11                                             0407 01103000
         IC    @11,SDSINDX                                         0407 01104000
         MR    @06,@11                                             0407 01105000
         LA    @11,DSBFNAME-103(@01)                               0407 01106000
         LA    @08,DSBFNAME-103(@07)                               0407 01107000
         CLC   0(8,@11),0(@08)                                     0407 01108000
         BNH   @RF00407                                            0407 01109000
         LA    @11,SEOF-103(@01)                                   0407 01110000
         TM    0(@11),B'01000000'                                  0407 01111000
         BNZ   @RF00407                                            0407 01112000
*           SREAD=ON;               /* SECONDARY READ        @Z67SP00*/ 01113000
         OI    SREAD,B'01000000'                                   0408 01114000
*         ELSE                      /*                       @Z67SP00*/ 01115000
*           DO;                     /* RCD EQUAL             @Z67SP00*/ 01116000
         B     @RC00407                                            0409 01117000
@RF00407 DS    0H                                                  0410 01118000
*             IF PEOF(PDSINDX)=OFF  /*                       @Z67SP00*/ 01119000
*               THEN                /*                       @Z67SP00*/ 01120000
         LR    @11,PDSINDX                                         0410 01121000
         MH    @11,@CH01521                                        0410 01122000
         LA    @08,PEOF-103(@11)                                   0410 01123000
         TM    0(@08),B'10000000'                                  0410 01124000
         BNZ   @RF00410                                            0410 01125000
*               PREAD=ON;           /* READ FROM BOTH        @Z67SP00*/ 01126000
         OI    PREAD,B'10000000'                                   0411 01127000
*             IF SEOF(PDSINDX)=OFF  /*                       @Z67SP00*/ 01128000
*               THEN                /*                       @Z67SP00*/ 01129000
@RF00410 LR    @11,PDSINDX                                         0412 01130000
         MH    @11,@CH01521                                        0412 01131000
         LA    @08,SEOF-103(@11)                                   0412 01132000
         TM    0(@08),B'01000000'                                  0412 01133000
         BNZ   @RF00412                                            0412 01134000
*               SREAD=ON;           /*                       @Z67SP00*/ 01135000
         OI    SREAD,B'01000000'                                   0413 01136000
*           END;                    /*                       @Z67SP00*/ 01137000
*                                                                  0414 01138000
@RF00412 DS    0H                                                  0415 01139000
*     /***************************************************************/ 01140000
*     /*                                                             */ 01141000
*     /* GET NEXT RECORDS FROM DIS FILES                     @Z67SP00*/ 01142000
*     /*                                                             */ 01143000
*     /***************************************************************/ 01144000
*                                                                  0415 01145000
*     IF PREAD=ON                   /* IF PRIMARY READ       @Z67SP00*/ 01146000
*       THEN                        /*                       @Z67SP00*/ 01147000
@RC00407 DS    0H                                                  0415 01148000
@RC00405 DS    0H                                                  0415 01149000
@RC00398 TM    PREAD,B'10000000'                                   0415 01150000
         BNO   @RF00415                                            0415 01151000
*       DO;                         /*                       @Z67SP00*/ 01152000
*         STOP=OFF;                 /* LET LOOP GO THUR 1    @Z67SP00*/ 01153000
         NI    STOP,B'11101111'                                    0417 01154000
*         DO WHILE STOP=OFF;        /* LOOP TILL RCD FOUND   @Z67SP00*/ 01155000
         B     @DE00418                                            0418 01156000
@DL00418 DS    0H                                                  0419 01157000
*           STOP=ON;                /* STOP LOOP             @Z67SP00*/ 01158000
         OI    STOP,B'00010000'                                    0419 01159000
*           GTPFUNCT(PGTPINDX)=GTPGETN;/* GET RCD INTO TEMP  @Z67SP00*/ 01160000
         SLR   @11,@11                                             0420 01161000
         IC    @11,PGTPINDX                                        0420 01162000
         MH    @11,@CH00467                                        0420 01163000
         LA    @08,8                                               0420 01164000
         STC   @08,GTPFUNCT-28(@11)                                0420 01165000
*           GTPBUFAD(PGTPINDX)=ADDR(DSBUFFR(PDSINDX));/* BFR @Z67SP00*/ 01166000
         LR    @08,PDSINDX                                         0421 01167000
         MH    @08,@CH01521                                        0421 01168000
         LA    @08,DSBUFFR-103(@08)                                0421 01169000
         ST    @08,GTPBUFAD-28(@11)                                0421 01170000
*           CALL HMASMGTA(HMASMGTP(PGTPINDX));/* GET RCD     @Z67SP00*/ 01171000
         LA    @11,HMASMGTP-28(@11)                                0422 01172000
         ST    @11,@AL00001                                        0422 01173000
         L     @15,@CV01268                                        0422 01174000
         LA    @01,@AL00001                                        0422 01175000
         BALR  @14,@15                                             0422 01176000
*           IF GTPRETRN(PGTPINDX)=GTPEOF/* IF END OF FILE    @Z67SP00*/ 01177000
*             THEN                  /*                       @Z67SP00*/ 01178000
         SLR   @11,@11                                             0423 01179000
         IC    @11,PGTPINDX                                        0423 01180000
         LR    @08,@11                                             0423 01181000
         MH    @08,@CH00467                                        0423 01182000
         SLR   @05,@05                                             0423 01183000
         IC    @05,GTPRETRN-28(@08)                                0423 01184000
         CH    @05,@CH00039                                        0423 01185000
         BNE   @RF00423                                            0423 01186000
*             DO;                   /*                       @Z67SP00*/ 01187000
*               IF PGTPINDX<=DSGTPLST(PDSINDX)/* IF NOT AT   @Z67SP00*/ 01188000
*                 THEN              /* END OF GTPS FOR THIS  @Z67SP00*/ 01189000
         LR    @08,PDSINDX                                         0425 01190000
         MH    @08,@CH01521                                        0425 01191000
         SLR   @05,@05                                             0425 01192000
         IC    @05,DSGTPLST-103(@08)                               0425 01193000
         CR    @11,@05                                             0425 01194000
         BH    @RF00425                                            0425 01195000
*                 DO;               /* DATASET THEN GO       @Z67SP00*/ 01196000
*                   STOP2=OFF;      /* LET LOOP GO THRU ONCE @Z67SP00*/ 01197000
         NI    STOP2,B'11110111'                                   0427 01198000
*                   DO WHILE STOP2=OFF;/* GET NEXT FILE      @Z67SP00*/ 01199000
         B     @DE00428                                            0428 01200000
@DL00428 DS    0H                                                  0429 01201000
*                     PGTPINDX=PGTPINDX+1;/* BUMP INDEX TO NEXT GTP     01202000
*                                                            @Z67SP00*/ 01203000
         LA    @11,1                                               0429 01204000
         SLR   @08,@08                                             0429 01205000
         IC    @08,PGTPINDX                                        0429 01206000
         ALR   @08,@11                                             0429 01207000
         STC   @08,PGTPINDX                                        0429 01208000
*                     IF PGTPINDX>DSGTPLST(PDSINDX)/* IF     @Z67SP00*/ 01209000
*                         |DSFIRST(PGTPINDX)=ONE/* AT END OF GTPS OR    01210000
*                                      THIS GTP HAS RCDS     @Z67SP00*/ 01211000
*                       THEN        /* THEN STOP LOOP AND    @Z67SP00*/ 01212000
         LR    @05,PDSINDX                                         0430 01213000
         MH    @05,@CH01521                                        0430 01214000
         SLR   @15,@15                                             0430 01215000
         IC    @15,DSGTPLST-103(@05)                               0430 01216000
         CR    @08,@15                                             0430 01217000
         BH    @RT00430                                            0430 01218000
         SLR   @05,@05                                             0430 01219000
         IC    @05,DSFIRST-1(@08)                                  0430 01220000
         CR    @11,@05                                             0430 01221000
         BNE   @RF00430                                            0430 01222000
@RT00430 DS    0H                                                  0431 01223000
*                       STOP2=ON;   /* PROCESS ITS RCDS      @Z67SP00*/ 01224000
         OI    STOP2,B'00001000'                                   0431 01225000
*                   END;            /*                       @Z67SP00*/ 01226000
@RF00430 DS    0H                                                  0432 01227000
@DE00428 TM    STOP2,B'00001000'                                   0432 01228000
         BZ    @DL00428                                            0432 01229000
*                 END;              /*                       @Z67SP00*/ 01230000
*               IF PGTPINDX>DSGTPLST(PDSINDX)/* IF NO GTP    @Z67SP00*/ 01231000
*                 THEN              /* THEN                  @Z67SP00*/ 01232000
@RF00425 LR    @11,PDSINDX                                         0434 01233000
         MH    @11,@CH01521                                        0434 01234000
         SLR   @08,@08                                             0434 01235000
         IC    @08,PGTPINDX                                        0434 01236000
         SLR   @05,@05                                             0434 01237000
         IC    @05,DSGTPLST-103(@11)                               0434 01238000
         CR    @08,@05                                             0434 01239000
         BNH   @RF00434                                            0434 01240000
*                 DO;               /*                       @Z67SP00*/ 01241000
*                   PEOF(PDSINDX)=ON;/* END OF FILE          @Z67SP00*/ 01242000
         LA    @08,PEOF-103(@11)                                   0436 01243000
         OI    0(@08),B'10000000'                                  0436 01244000
*                   PGTPINDX=DSGTPFRS(PDSINDX);/* FIRST GTP  @Z67SP00*/ 01245000
         SLR   @08,@08                                             0437 01246000
         IC    @08,DSGTPFRS-103(@11)                               0437 01247000
         STC   @08,PGTPINDX                                        0437 01248000
*                   DSGTPGN(PDSINDX)=DSGTPFRS(PDSINDX);/*    @Z67SP00*/ 01249000
         STC   @08,DSGTPGN-103(@11)                                0438 01250000
*                 END;              /*                       @Z67SP00*/ 01251000
*               ELSE                /*                       @Z67SP00*/ 01252000
*                 DO;               /*                       @Z67SP00*/ 01253000
         B     @RC00434                                            0440 01254000
@RF00434 DS    0H                                                  0441 01255000
*                   GTPFUNCT(PGTPINDX)=GTPOPENN;/* OPEN      @Z67SP00*/ 01256000
         SLR   @11,@11                                             0441 01257000
         IC    @11,PGTPINDX                                        0441 01258000
         MH    @11,@CH00467                                        0441 01259000
         LA    @08,1                                               0441 01260000
         STC   @08,GTPFUNCT-28(@11)                                0441 01261000
*                   CALL HMASMGTA(HMASMGTP(PGTPINDX));/*     @Z67SP00*/ 01262000
         LA    @11,HMASMGTP-28(@11)                                0442 01263000
         ST    @11,@AL00001                                        0442 01264000
         L     @15,@CV01268                                        0442 01265000
         LA    @01,@AL00001                                        0442 01266000
         BALR  @14,@15                                             0442 01267000
*                   DSGTPGN(PDSINDX)=PGTPINDX;/*             @Z67SP00*/ 01268000
         LR    @11,PDSINDX                                         0443 01269000
         MH    @11,@CH01521                                        0443 01270000
         SLR   @08,@08                                             0443 01271000
         IC    @08,PGTPINDX                                        0443 01272000
         STC   @08,DSGTPGN-103(@11)                                0443 01273000
*                   STOP=OFF;       /* CONTINUE WITH READS   @Z67SP00*/ 01274000
         NI    STOP,B'11101111'                                    0444 01275000
*                 END;              /*                       @Z67SP00*/ 01276000
*             END;                  /* END GTP EOF           @Z67SP00*/ 01277000
@RC00434 DS    0H                                                  0447 01278000
*         END;                      /* END GTA READ LOOP     @Z67SP00*/ 01279000
@RF00423 DS    0H                                                  0447 01280000
@DE00418 TM    STOP,B'00010000'                                    0447 01281000
         BZ    @DL00418                                            0447 01282000
*       END;                        /* END NEED PRIM READ    @Z67SP00*/ 01283000
*     IF SREAD=ON                   /* IF SECONDARY DIS READ @Z67SP00*/ 01284000
*       THEN                        /*                       @Z67SP00*/ 01285000
@RF00415 TM    SREAD,B'01000000'                                   0449 01286000
         BNO   @RF00449                                            0449 01287000
*       DO;                         /*                       @Z67SP00*/ 01288000
*         STOP=OFF;                 /* LET LOOP GO THUR 1    @Z67SP00*/ 01289000
         NI    STOP,B'11101111'                                    0451 01290000
*         DO WHILE STOP=OFF;        /* LOOP TILL RCD FOUND   @Z67SP00*/ 01291000
         B     @DE00452                                            0452 01292000
@DL00452 DS    0H                                                  0453 01293000
*           STOP=ON;                /* STOP LOOP             @Z67SP00*/ 01294000
         OI    STOP,B'00010000'                                    0453 01295000
*           GTPFUNCT(SGTPINDX)=GTPGETN;/* GET RCD INTO TEMP  @Z67SP00*/ 01296000
         SLR   @11,@11                                             0454 01297000
         IC    @11,SGTPINDX                                        0454 01298000
         MH    @11,@CH00467                                        0454 01299000
         LA    @08,8                                               0454 01300000
         STC   @08,GTPFUNCT-28(@11)                                0454 01301000
*           GTPBUFAD(SGTPINDX)=ADDR(DSBUFFR(SDSINDX));/* BFR @Z67SP00*/ 01302000
         SLR   @08,@08                                             0455 01303000
         IC    @08,SDSINDX                                         0455 01304000
         MH    @08,@CH01521                                        0455 01305000
         LA    @08,DSBUFFR-103(@08)                                0455 01306000
         ST    @08,GTPBUFAD-28(@11)                                0455 01307000
*           CALL HMASMGTA(HMASMGTP(SGTPINDX));/* GET RCD     @Z67SP00*/ 01308000
         LA    @11,HMASMGTP-28(@11)                                0456 01309000
         ST    @11,@AL00001                                        0456 01310000
         L     @15,@CV01268                                        0456 01311000
         LA    @01,@AL00001                                        0456 01312000
         BALR  @14,@15                                             0456 01313000
*           IF GTPRETRN(SGTPINDX)=GTPEOF/* IF END OF FILE    @Z67SP00*/ 01314000
*             THEN                  /*                       @Z67SP00*/ 01315000
         SLR   @11,@11                                             0457 01316000
         IC    @11,SGTPINDX                                        0457 01317000
         LR    @08,@11                                             0457 01318000
         MH    @08,@CH00467                                        0457 01319000
         SLR   @05,@05                                             0457 01320000
         IC    @05,GTPRETRN-28(@08)                                0457 01321000
         CH    @05,@CH00039                                        0457 01322000
         BNE   @RF00457                                            0457 01323000
*             DO;                   /*                       @Z67SP00*/ 01324000
*               IF SGTPINDX<=DSGTPLST(SDSINDX)/* IF NOT AT   @Z67SP00*/ 01325000
*                 THEN              /* END OF GTPS FOR THIS  @Z67SP00*/ 01326000
         SLR   @08,@08                                             0459 01327000
         IC    @08,SDSINDX                                         0459 01328000
         MH    @08,@CH01521                                        0459 01329000
         SLR   @05,@05                                             0459 01330000
         IC    @05,DSGTPLST-103(@08)                               0459 01331000
         CR    @11,@05                                             0459 01332000
         BH    @RF00459                                            0459 01333000
*                 DO;               /* DATASET THEN GO       @Z67SP00*/ 01334000
*                   STOP2=OFF;      /*                       @Z67SP00*/ 01335000
         NI    STOP2,B'11110111'                                   0461 01336000
*                   DO WHILE STOP2=OFF;/* GET NEXT FILE      @Z67SP00*/ 01337000
         B     @DE00462                                            0462 01338000
@DL00462 DS    0H                                                  0463 01339000
*                     SGTPINDX=SGTPINDX+1;/* BUMP INDEX TO NEXT GTP     01340000
*                                                            @Z67SP00*/ 01341000
         LA    @11,1                                               0463 01342000
         SLR   @08,@08                                             0463 01343000
         IC    @08,SGTPINDX                                        0463 01344000
         ALR   @08,@11                                             0463 01345000
         STC   @08,SGTPINDX                                        0463 01346000
*                     IF SGTPINDX>DSGTPLST(SDSINDX)/* IF     @Z67SP00*/ 01347000
*                         |DSFIRST(SGTPINDX)=ONE/* AT END OF GTPS OR    01348000
*                                      THIS GTP HAS RCDS     @Z67SP00*/ 01349000
*                       THEN        /* THEN STOP LOOP AND    @Z67SP00*/ 01350000
         SLR   @05,@05                                             0464 01351000
         IC    @05,SDSINDX                                         0464 01352000
         MH    @05,@CH01521                                        0464 01353000
         SLR   @15,@15                                             0464 01354000
         IC    @15,DSGTPLST-103(@05)                               0464 01355000
         CR    @08,@15                                             0464 01356000
         BH    @RT00464                                            0464 01357000
         SLR   @05,@05                                             0464 01358000
         IC    @05,DSFIRST-1(@08)                                  0464 01359000
         CR    @11,@05                                             0464 01360000
         BNE   @RF00464                                            0464 01361000
@RT00464 DS    0H                                                  0465 01362000
*                       STOP2=ON;   /* PROCESS ITS RCDS      @Z67SP00*/ 01363000
         OI    STOP2,B'00001000'                                   0465 01364000
*                   END;            /*                       @Z67SP00*/ 01365000
@RF00464 DS    0H                                                  0466 01366000
@DE00462 TM    STOP2,B'00001000'                                   0466 01367000
         BZ    @DL00462                                            0466 01368000
*                 END;              /*                       @Z67SP00*/ 01369000
*               IF SGTPINDX>DSGTPLST(SDSINDX)/* IF NO GTP    @Z67SP00*/ 01370000
*                 THEN              /* THEN                  @Z67SP00*/ 01371000
@RF00459 LA    @11,103                                             0468 01372000
         SLR   @01,@01                                             0468 01373000
         IC    @01,SDSINDX                                         0468 01374000
         MR    @00,@11                                             0468 01375000
         SLR   @08,@08                                             0468 01376000
         IC    @08,SGTPINDX                                        0468 01377000
         SLR   @05,@05                                             0468 01378000
         IC    @05,DSGTPLST-103(@01)                               0468 01379000
         CR    @08,@05                                             0468 01380000
         BNH   @RF00468                                            0468 01381000
*                 DO;               /*                               */ 01382000
*                   SEOF(PDSINDX)=ON;/* END OF FILE          @Z67SP00*/ 01383000
         LR    @07,@11                                             0470 01384000
         MR    @06,PDSINDX                                         0470 01385000
         LA    @11,SEOF-103(@07)                                   0470 01386000
         OI    0(@11),B'01000000'                                  0470 01387000
*                   SGTPINDX=DSGTPFRS(SDSINDX);/* FIRST GTP          */ 01388000
         SLR   @11,@11                                             0471 01389000
         IC    @11,DSGTPFRS-103(@01)                               0471 01390000
         STC   @11,SGTPINDX                                        0471 01391000
*                   DSGTPGN(SDSINDX)=DSGTPFRS(SDSINDX);/*    @Z67SP00*/ 01392000
         STC   @11,DSGTPGN-103(@01)                                0472 01393000
*                 END;              /*                               */ 01394000
*               ELSE                /*                       @Z67SP00*/ 01395000
*                 DO;               /*                       @Z67SP00*/ 01396000
         B     @RC00468                                            0474 01397000
@RF00468 DS    0H                                                  0475 01398000
*                   GTPFUNCT(SGTPINDX)=GTPOPENN;/* OPEN      @Z67SP00*/ 01399000
         SLR   @11,@11                                             0475 01400000
         IC    @11,SGTPINDX                                        0475 01401000
         MH    @11,@CH00467                                        0475 01402000
         LA    @08,1                                               0475 01403000
         STC   @08,GTPFUNCT-28(@11)                                0475 01404000
*                   CALL HMASMGTA(HMASMGTP(SGTPINDX));/*     @Z67SP00*/ 01405000
         LA    @11,HMASMGTP-28(@11)                                0476 01406000
         ST    @11,@AL00001                                        0476 01407000
         L     @15,@CV01268                                        0476 01408000
         LA    @01,@AL00001                                        0476 01409000
         BALR  @14,@15                                             0476 01410000
*                   DSGTPGN(SDSINDX)=SGTPINDX;/* SET GETN    @Z67SP00*/ 01411000
         SLR   @11,@11                                             0477 01412000
         IC    @11,SDSINDX                                         0477 01413000
         MH    @11,@CH01521                                        0477 01414000
         SLR   @08,@08                                             0477 01415000
         IC    @08,SGTPINDX                                        0477 01416000
         STC   @08,DSGTPGN-103(@11)                                0477 01417000
*                   STOP=OFF;       /* CONTINUE WITH READS   @Z67SP00*/ 01418000
         NI    STOP,B'11101111'                                    0478 01419000
*                 END;              /*                       @Z67SP00*/ 01420000
*             END;                  /* END GTP EOF           @Z67SP00*/ 01421000
@RC00468 DS    0H                                                  0481 01422000
*         END;                      /* END GTA READ LOOP     @Z67SP00*/ 01423000
@RF00457 DS    0H                                                  0481 01424000
@DE00452 TM    STOP,B'00010000'                                    0481 01425000
         BZ    @DL00452                                            0481 01426000
*       END;                        /*                       @Z67SP00*/ 01427000
*                                                                  0482 01428000
*     /***************************************************************/ 01429000
*     /*                                                             */ 01430000
*     /* CHECK FOR END OF FILE ON BOTH DIS FILES             @Z67SP00*/ 01431000
*     /*                                                             */ 01432000
*     /***************************************************************/ 01433000
*                                                                  0483 01434000
*     IF PEOF(PDSINDX)=ON           /* IF EOF ON PRIMARY     @Z67SP00*/ 01435000
*         &SEOF(PDSINDX)=ON         /* AND EOF ON SECONDARY  @Z67SP00*/ 01436000
*       THEN                        /*                       @Z67SP00*/ 01437000
@RF00449 LR    @11,PDSINDX                                         0483 01438000
         MH    @11,@CH01521                                        0483 01439000
         LA    @08,PEOF-103(@11)                                   0483 01440000
         TM    0(@08),B'11000000'                                  0483 01441000
         BNO   @RF00483                                            0483 01442000
*       GETNRC=IOPEOF;              /* SET END OF FILE RC    @Z67SP00*/ 01443000
*                                                                  0484 01444000
         LA    GETNRC,4                                            0484 01445000
*     /***************************************************************/ 01446000
*     /*                                                             */ 01447000
*     /* NOT END OF FILE OF BOTH PRIMARY AND SECONDARY       @Z67SP00*/ 01448000
*     /*                                                             */ 01449000
*     /***************************************************************/ 01450000
*                                                                  0485 01451000
*     ELSE                          /*                       @Z67SP00*/ 01452000
*       DO;                         /*                       @Z67SP00*/ 01453000
*                                                                  0485 01454000
         B     @RC00483                                            0485 01455000
@RF00483 DS    0H                                                  0486 01456000
*         /***********************************************************/ 01457000
*         /*                                                         */ 01458000
*         /* CHECK FOR SECONDARY RECORD LOWER THAN PRIMARY   @Z67SP00*/ 01459000
*         /*                                                         */ 01460000
*         /***********************************************************/ 01461000
*                                                                  0486 01462000
*         IF(SEOF(PDSINDX)=OFF      /* IF NOT EOF ON SDIS    @Z67SP00*/ 01463000
*             &DSBFNAME(SDSINDX)<=DSBFNAME(PDSINDX))/* IF SECONDARY     01464000
*                                      HAS KEY LESS THAN PRIMARY   0486 01465000
*                                                            @Z67SP00*/ 01466000
*             |PEOF(PDSINDX)=ON     /* OR EOF ON PRIMARY     @Z67SP00*/ 01467000
*           THEN                    /* THEN                  @Z67SP00*/ 01468000
         LA    @11,103                                             0486 01469000
         LR    @01,PDSINDX                                         0486 01470000
         MR    @00,@11                                             0486 01471000
         LA    @08,SEOF-103(@01)                                   0486 01472000
         TM    0(@08),B'01000000'                                  0486 01473000
         BNZ   @GL00014                                            0486 01474000
         LR    @07,@11                                             0486 01475000
         SLR   @11,@11                                             0486 01476000
         IC    @11,SDSINDX                                         0486 01477000
         MR    @06,@11                                             0486 01478000
         LA    @11,DSBFNAME-103(@07)                               0486 01479000
         LA    @08,DSBFNAME-103(@01)                               0486 01480000
         CLC   0(8,@11),0(@08)                                     0486 01481000
         BNH   @RT00486                                            0486 01482000
@GL00014 LR    @11,PDSINDX                                         0486 01483000
         MH    @11,@CH01521                                        0486 01484000
         LA    @08,PEOF-103(@11)                                   0486 01485000
         TM    0(@08),B'10000000'                                  0486 01486000
         BNO   @RF00486                                            0486 01487000
@RT00486 DS    0H                                                  0487 01488000
*           DO;                     /*                       @Z67SP00*/ 01489000
*             IF DSBFDEL(SDSINDX)^=TXTDEL/* IF NOT DELETED   @Z67SP00*/ 01490000
*               THEN                /* THEN                  @Z67SP00*/ 01491000
         SLR   @11,@11                                             0488 01492000
         IC    @11,SDSINDX                                         0488 01493000
         MH    @11,@CH01521                                        0488 01494000
         LA    @08,DSBFDEL-103(@11)                                0488 01495000
         CLC   0(8,@08),@CC01281                                   0488 01496000
         BE    @RF00488                                            0488 01497000
*               IOPDRMAP(1:DSDIRLN(SDSINDX))=DSBUFFR(SDSINDX,1:DSDIRLN( 01498000
*                   SDSINDX));      /* MOVE RCD              @Z67SP00*/ 01499000
         SLR   @08,@08                                             0489 01500000
         IC    @08,DSDIRLN-103(@11)                                0489 01501000
         BCTR  @08,0                                               0489 01502000
         LA    @05,DSBUFFR-103(@11)                                0489 01503000
         EX    @08,@SM01526                                        0489 01504000
*             ELSE                  /* IF DELETED TYPE       @Z67SP00*/ 01505000
*               DEL=ON;             /* SET SW TO CAUSE LOOP BACK TO     01506000
*                                      READ NEXT RCD FROM SECONDARY     01507000
*                                      DIS                   @Z67SP00*/ 01508000
         B     @RC00488                                            0490 01509000
@RF00488 OI    DEL,B'00100000'                                     0490 01510000
*           END;                    /*                       @Z67SP00*/ 01511000
@RC00488 DS    0H                                                  0492 01512000
*         IF(PEOF(PDSINDX)=OFF      /* IF NOT EOF ON PDIS    @Z67SP00*/ 01513000
*             &DSBFNAME(PDSINDX)<DSBFNAME(SDSINDX))/* AND PRIMARY HAS   01514000
*                                      LOWER KEY THAN SECONDARY    0492 01515000
*                                                            @Z67SP00*/ 01516000
*             |SEOF(PDSINDX)=ON     /* OR EOF ON SECONDARY   @Z67SP00*/ 01517000
*           THEN                    /*                       @Z67SP00*/ 01518000
@RF00486 LA    @11,103                                             0492 01519000
         LR    @01,PDSINDX                                         0492 01520000
         MR    @00,@11                                             0492 01521000
         LA    @08,PEOF-103(@01)                                   0492 01522000
         TM    0(@08),B'10000000'                                  0492 01523000
         BNZ   @GL00016                                            0492 01524000
         LR    @07,@11                                             0492 01525000
         SLR   @11,@11                                             0492 01526000
         IC    @11,SDSINDX                                         0492 01527000
         MR    @06,@11                                             0492 01528000
         LA    @11,DSBFNAME-103(@01)                               0492 01529000
         LA    @08,DSBFNAME-103(@07)                               0492 01530000
         CLC   0(8,@11),0(@08)                                     0492 01531000
         BL    @RT00492                                            0492 01532000
@GL00016 LR    @11,PDSINDX                                         0492 01533000
         MH    @11,@CH01521                                        0492 01534000
         LA    @08,SEOF-103(@11)                                   0492 01535000
         TM    0(@08),B'01000000'                                  0492 01536000
         BNO   @RF00492                                            0492 01537000
@RT00492 DS    0H                                                  0493 01538000
*           IOPDRMAP(1:DSDIRLN(PDSINDX))=DSBUFFR(PDSINDX,1:DSDIRLN(     01539000
*               PDSINDX));          /* MOVE RCD              @Z67SP00*/ 01540000
         LR    @11,PDSINDX                                         0493 01541000
         MH    @11,@CH01521                                        0493 01542000
         SLR   @08,@08                                             0493 01543000
         IC    @08,DSDIRLN-103(@11)                                0493 01544000
         BCTR  @08,0                                               0493 01545000
         LA    @05,DSBUFFR-103(@11)                                0493 01546000
         EX    @08,@SM01526                                        0493 01547000
*       END;                        /*                       @Z67SP00*/ 01548000
@RF00492 DS    0H                                                  0495 01549000
*   END;                            /* END LOOP READING DIR  @Z67SP00*/ 01550000
*                                                                  0495 01551000
@RC00483 DS    0H                                                  0495 01552000
@DE00395 TM    DEL,B'00100000'                                     0495 01553000
         BO    @DL00395                                            0495 01554000
*   /*****************************************************************/ 01555000
*   /*                                                               */ 01556000
*   /* RETURN TO CALLER WITH RC AND DIR INFO SET UP          @Z67SP00*/ 01557000
*   /*                                                               */ 01558000
*   /*****************************************************************/ 01559000
*                                                                  0496 01560000
*   RETURN CODE(GETNRC);            /*                       @Z67SP00*/ 01561000
         LR    @15,GETNRC                                          0496 01562000
         L     @14,@SA00006                                        0496 01563000
         LM    @00,@12,@SA00006+8                                  0496 01564000
         BR    @14                                                 0496 01565000
*   END EISGETN;                    /*                       @Z67SP00*/ 01566000
         EJECT                                                          01567000
*                                                                  0498 01568000
*   /*****************************************************************/ 01569000
*   /*                                                               */ 01570000
*   /* ROUTINE CALLED TO CLOSE DIS FILES IN PREPARATION FOR          */ 01571000
*   /* SEQUENTIAL READ PROCESSING                            @Z67SP00*/ 01572000
*   /*                                                               */ 01573000
*   /*****************************************************************/ 01574000
*                                                                  0498 01575000
*EISCLOSN:                          /*                       @Z67SP00*/ 01576000
*   PROC;                           /*                       @Z67SP00*/ 01577000
*                                                                  0498 01578000
EISCLOSN STM   @14,@12,@SA00007                                    0498 01579000
*   /*****************************************************************/ 01580000
*   /*                                                               */ 01581000
*   /* CLOSE SECONDARY FILE IF ONE EXISTS                    @Z67SP00*/ 01582000
*   /*                                                               */ 01583000
*   /*****************************************************************/ 01584000
*                                                                  0499 01585000
*   IF CCACHECK=ON                  /* IF IN CHECK MODE      @Z67SP00*/ 01586000
*     THEN                          /*                       @Z67SP00*/ 01587000
         L     @11,@CA00037                                        0499 01588000
         TM    CCACHECK-HMASMCCA(@11),B'00010000'                  0499 01589000
         BNO   @RF00499                                            0499 01590000
*     DO;                           /*                       @Z67SP00*/ 01591000
*       GTPFUNCT(SGTPINDX)=GTPOPENN;/* RESET PTRS            @Z67SP00*/ 01592000
         SLR   @11,@11                                             0501 01593000
         IC    @11,SGTPINDX                                        0501 01594000
         MH    @11,@CH00467                                        0501 01595000
         LA    @08,1                                               0501 01596000
         STC   @08,GTPFUNCT-28(@11)                                0501 01597000
*       CALL HMASMGTA(HMASMGTP(SGTPINDX));/* DO OPEN         @Z67SP00*/ 01598000
         LA    @11,HMASMGTP-28(@11)                                0502 01599000
         ST    @11,@AL00001                                        0502 01600000
         L     @15,@CV01268                                        0502 01601000
         LA    @01,@AL00001                                        0502 01602000
         BALR  @14,@15                                             0502 01603000
*       DSBUFFR(SDSINDX)='';        /* BLANK BUFFER          @Z67SP00*/ 01604000
         SLR   @11,@11                                             0503 01605000
         IC    @11,SDSINDX                                         0503 01606000
         MH    @11,@CH01521                                        0503 01607000
         LA    @08,DSBUFFR-103(@11)                                0503 01608000
         MVI   0(@08),C' '                                         0503 01609000
         MVC   1(73,@08),0(@08)                                    0503 01610000
*       DSFLAGS1(SDSINDX)=ZERO;     /*                       @Z67SP00*/ 01611000
         SLR   @08,@08                                             0504 01612000
         STC   @08,DSFLAGS1-103(@11)                               0504 01613000
*     END;                          /*                       @Z67SP00*/ 01614000
*                                                                  0505 01615000
*   /*****************************************************************/ 01616000
*   /*                                                               */ 01617000
*   /* CLOSE PRIMARY FILE                                    @Z67SP00*/ 01618000
*   /*                                                               */ 01619000
*   /*****************************************************************/ 01620000
*                                                                  0506 01621000
*   GTPFUNCT(PGTPINDX)=GTPOPENN;    /*                       @Z67SP00*/ 01622000
@RF00499 SLR   @11,@11                                             0506 01623000
         IC    @11,PGTPINDX                                        0506 01624000
         MH    @11,@CH00467                                        0506 01625000
         LA    @08,1                                               0506 01626000
         STC   @08,GTPFUNCT-28(@11)                                0506 01627000
*   CALL HMASMGTA(HMASMGTP(PGTPINDX));/* DO OPEN             @Z67SP00*/ 01628000
         LA    @11,HMASMGTP-28(@11)                                0507 01629000
         ST    @11,@AL00001                                        0507 01630000
         L     @15,@CV01268                                        0507 01631000
         LA    @01,@AL00001                                        0507 01632000
         BALR  @14,@15                                             0507 01633000
*   DSBUFFR(PDSINDX)='';            /* BLANK BUFFER          @Z67SP00*/ 01634000
         LR    @11,PDSINDX                                         0508 01635000
         MH    @11,@CH01521                                        0508 01636000
         LA    @08,DSBUFFR-103(@11)                                0508 01637000
         MVI   0(@08),C' '                                         0508 01638000
         MVC   1(73,@08),0(@08)                                    0508 01639000
*   DSFLAGS1(PDSINDX)=ZERO;         /*                       @Z67SP00*/ 01640000
         SLR   @08,@08                                             0509 01641000
         STC   @08,DSFLAGS1-103(@11)                               0509 01642000
*   RETURN CODE(IOPGOOD);           /*                       @Z67SP00*/ 01643000
         LR    @15,@08                                             0510 01644000
         L     @14,@SA00007                                        0510 01645000
         LM    @00,@12,@SA00007+8                                  0510 01646000
         BR    @14                                                 0510 01647000
*   END EISCLOSN;                   /*                       @Z67SP00*/ 01648000
         EJECT                                                          01649000
*                                                                  0512 01650000
*   /*****************************************************************/ 01651000
*   /*                                                               */ 01652000
*   /* ROUTINE CALLED TO PERFORM THE STOWR FUNCTION. THE DATA PORTION*/ 01653000
*   /* HAS ALREADY BEEN WRITTEN AND THE TTR IN THE DIRECTORY ENTRY   */ 01654000
*   /* POINTS TO THE NEW DATA AREA                           @Z67SP00*/ 01655000
*   /*                                                               */ 01656000
*   /*****************************************************************/ 01657000
*                                                                  0512 01658000
*EISSTOWR:                          /*                       @Z67SP00*/ 01659000
*                                                                  0512 01660000
*   /*****************************************************************/ 01661000
*   /*                                                               */ 01662000
*   /* ALTERNATE ENTRY POINT TO PERFORM THE UPDATE DIRECTORY ONLY    */ 01663000
*   /* FUNCTION                                              @Z67SP00*/ 01664000
*   /*                                                               */ 01665000
*   /*****************************************************************/ 01666000
*                                                                  0512 01667000
*EISUDEO:                           /*                       @Z67SP00*/ 01668000
*   PROC;                           /*                       @Z67SP00*/ 01669000
EISSTOWR DS    0H                                                  0512 01670000
EISUDEO  STM   @14,@12,@SA00008                                    0512 01671000
*   DECLARE                         /*                       @Z67SP00*/ 01672000
*     STOWRRC FIXED(8);             /* INTERNAL RETURN CODE          */ 01673000
*   RFY                                                            0514 01674000
*     HMASMIOP BASED(IOPPTR);       /* REFERENCE CALLERS IOP         */ 01675000
*   STOWRRC=IOPGOOD;                /* INIT RETURN CODE              */ 01676000
         SLR   STOWRRC,STOWRRC                                     0515 01677000
*   IF CCACHECK=OFF                 /* IF NOT CHECK MODE     @Z67SP00*/ 01678000
*     THEN                          /*                       @Z67SP00*/ 01679000
         L     @11,@CA00037                                        0516 01680000
         TM    CCACHECK-HMASMCCA(@11),B'00010000'                  0516 01681000
         BNZ   @RF00516                                            0516 01682000
*     DO;                           /*                       @Z67SP00*/ 01683000
*       GTPBUFAD(PGTPINDX)=ADDR(IOPDRMAP);/* SET PTR TO ENTRY      0518 01684000
*                                                            @Z67SP00*/ 01685000
         SLR   @11,@11                                             0518 01686000
         IC    @11,PGTPINDX                                        0518 01687000
         MH    @11,@CH00467                                        0518 01688000
         LA    @08,IOPDRMAP(,IOPPTR)                               0518 01689000
         ST    @08,GTPBUFAD-28(@11)                                0518 01690000
*       GTPFUNCT(PGTPINDX)=GTPADD;  /* ADD ENTRY TO DIS      @Z67SP00*/ 01691000
         LA    @08,4                                               0519 01692000
         STC   @08,GTPFUNCT-28(@11)                                0519 01693000
*       CALL HMASMGTA(HMASMGTP(PGTPINDX));/* ADD VIA CALL TO HMASMGTA   01694000
*                                                            @Z67SP00*/ 01695000
         LA    @11,HMASMGTP-28(@11)                                0520 01696000
         ST    @11,@AL00001                                        0520 01697000
         L     @15,@CV01268                                        0520 01698000
         LA    @01,@AL00001                                        0520 01699000
         BALR  @14,@15                                             0520 01700000
*       STOWRRC=GTPRETRN(PGTPINDX); /* SAVE ADD RETURN CODE  @Z67SP00*/ 01701000
         SLR   @11,@11                                             0521 01702000
         IC    @11,PGTPINDX                                        0521 01703000
         MH    @11,@CH00467                                        0521 01704000
         SLR   STOWRRC,STOWRRC                                     0521 01705000
         IC    STOWRRC,GTPRETRN-28(@11)                            0521 01706000
*       IF STOWRRC=ZERO             /* IF RCD STOWED         @Z67SP00*/ 01707000
*           &GTPRCDNF(PGTPINDX)=ON  /* AND NOT THERE BEFORE  @Z67SP00*/ 01708000
*         THEN                      /* THEN INCR RCDS USED   @Z67SP00*/ 01709000
         CH    STOWRRC,@CH00252                                    0522 01710000
         BNE   @RF00522                                            0522 01711000
         LA    @08,GTPRCDNF-28(@11)                                0522 01712000
         TM    0(@08),B'01000000'                                  0522 01713000
         BNO   @RF00522                                            0522 01714000
*         DSMEMUSE(PDSINDX)=DSMEMUSE(PDSINDX)+1;/* BY 1      @Z67SP00*/ 01715000
         LR    @11,PDSINDX                                         0523 01716000
         MH    @11,@CH01521                                        0523 01717000
         LA    @08,1                                               0523 01718000
         AL    @08,DSMEMUSE-103(@11)                               0523 01719000
         ST    @08,DSMEMUSE-103(@11)                               0523 01720000
*     END;                          /*                       @Z67SP00*/ 01721000
*   ELSE                            /* IF CHECK MODE         @Z67SP00*/ 01722000
*     DO;                           /*                       @Z67SP00*/ 01723000
         B     @RC00516                                            0525 01724000
@RF00516 DS    0H                                                  0526 01725000
*       GTPBUFAD(SGTPINDX)=ADDR(IOPDRMAP);/* SET PTR TO ENTRY      0526 01726000
*                                                            @Z67SP00*/ 01727000
         SLR   @11,@11                                             0526 01728000
         IC    @11,SGTPINDX                                        0526 01729000
         MH    @11,@CH00467                                        0526 01730000
         LA    @08,IOPDRMAP(,IOPPTR)                               0526 01731000
         ST    @08,GTPBUFAD-28(@11)                                0526 01732000
*       GTPFUNCT(SGTPINDX)=GTPADD;  /* ADD ENTRY TO DIS      @Z67SP00*/ 01733000
         LA    @08,4                                               0527 01734000
         STC   @08,GTPFUNCT-28(@11)                                0527 01735000
*       CALL HMASMGTA(HMASMGTP(SGTPINDX));/* ADD VIA CALL TO HMASMGTA   01736000
*                                                            @Z67SP00*/ 01737000
         LA    @11,HMASMGTP-28(@11)                                0528 01738000
         ST    @11,@AL00001                                        0528 01739000
         L     @15,@CV01268                                        0528 01740000
         LA    @01,@AL00001                                        0528 01741000
         BALR  @14,@15                                             0528 01742000
*       STOWRRC=GTPRETRN(SGTPINDX); /* SAVE ADD RETURN CODE  @Z67SP00*/ 01743000
         SLR   @11,@11                                             0529 01744000
         IC    @11,SGTPINDX                                        0529 01745000
         MH    @11,@CH00467                                        0529 01746000
         SLR   STOWRRC,STOWRRC                                     0529 01747000
         IC    STOWRRC,GTPRETRN-28(@11)                            0529 01748000
*     END;                          /*                       @Z67SP00*/ 01749000
*   IF STOWRRC^=GTPGOOD             /* IF NO SPACE THEN DO           */ 01750000
*     THEN                                                         0531 01751000
@RC00516 CH    STOWRRC,@CH00252                                    0531 01752000
         BE    @RF00531                                            0531 01753000
*     DO;                           /*                       @Z67SP00*/ 01754000
*       CALL EISSPMSG;              /* ISSUE OUT OF SPCE MSG @Z67SP00*/ 01755000
         BAL   @14,EISSPMSG                                        0533 01756000
*       RFY                                                        0534 01757000
*         RTNCODE RSTD;             /*                               */ 01758000
*       STOWRRC=RTNCODE;            /* PASS ALONG RC         @Z67SP00*/ 01759000
         LR    STOWRRC,RTNCODE                                     0535 01760000
*       RFY                         /*                       @Z67SP00*/ 01761000
*         RTNCODE UNRSTD;           /*                       @Z67SP00*/ 01762000
*     END;                                                         0537 01763000
*   ELSE                            /*                       @Z67SP00*/ 01764000
*     CCAFLAG6=CCAFLAG6|DSMSKON(PDSINDX);/* SET DIS UPDATED  @Z67SP00*/ 01765000
         B     @RC00531                                            0538 01766000
@RF00531 L     @11,@CA00037                                        0538 01767000
         LR    @08,PDSINDX                                         0538 01768000
         MH    @08,@CH01521                                        0538 01769000
         LA    @05,DSMSKON-103(@08)                                0538 01770000
         OC    CCAFLAG6-HMASMCCA(1,@11),0(@05)                     0538 01771000
*   IF DSMEMUSE(PDSINDX)>DSMEMMAX(PDSINDX)/* IF STOW CAUSED  @Z67SP00*/ 01772000
*     THEN                          /*                       @Z67SP00*/ 01773000
@RC00531 LR    @11,PDSINDX                                         0539 01774000
         MH    @11,@CH01521                                        0539 01775000
         L     @08,DSMEMUSE-103(@11)                               0539 01776000
         C     @08,DSMEMMAX-103(@11)                               0539 01777000
         BNH   @RF00539                                            0539 01778000
*     DO;                           /*                       @Z67SP00*/ 01779000
*       HMASMMGP=''B;               /* WRITE ERROR MSG       @Z67SP00*/ 01780000
         XC    HMASMMGP(24),HMASMMGP                               0541 01781000
*       MGPPRINT=ON;                /*                       @Z67SP00*/ 01782000
*       MGPHLDS=ON;                 /*                       @Z67SP00*/ 01783000
         OI    MGPPRINT,B'10010000'                                0543 01784000
*       MGPMGNO1=HMA267I;           /* DIRECTORY SPACE EXCEEDED    0544 01785000
*                                      ATTEMPTING TO STORE   @Z67SP00*/ 01786000
         MVC   MGPMGNO1(2),@CH01031                                0544 01787000
*       MGPMGNO2=PART031;           /* XXXXXXXX XXXXXXXX     @Z67SP00*/ 01788000
         MVC   MGPMGNO2(2),@CH00042                                0545 01789000
*       MGPMGNO3=PART016;           /* ON XXXXXXXX LIBRARY   @Z67SP00*/ 01790000
         MVC   MGPMGNO3(2),@CH00188                                0546 01791000
*       MGPVARPT(1)=ADDR(CCATYPEA(IOPTYPE));/* TYPE          @Z67SP00*/ 01792000
         SLR   @11,@11                                             0547 01793000
         IC    @11,IOPTYPE(,IOPPTR)                                0547 01794000
         SLA   @11,3                                               0547 01795000
         L     @08,@CA00037                                        0547 01796000
         L     @05,CCATPAD-HMASMCCA(,@08)                          0547 01797000
         AL    @05,@CF01530                                        0547 01798000
         LA    @11,CCATYPEA(@11,@05)                               0547 01799000
         ST    @11,MGPVARPT                                        0547 01800000
*       MGPVARPT(2)=ADDR(IOPNAME);  /* MEMBER NAME           @Z67SP00*/ 01801000
         LA    @11,IOPNAME(,IOPPTR)                                0548 01802000
         ST    @11,MGPVARPT+4                                      0548 01803000
*       MGPVARPT(3)=ADDR(CCADSIDA(IOPDSID));/* DATASET       @Z67SP00*/ 01804000
         SLR   @11,@11                                             0549 01805000
         IC    @11,IOPDSID(,IOPPTR)                                0549 01806000
         SLA   @11,3                                               0549 01807000
         L     @08,CCADSAD-HMASMCCA(,@08)                          0549 01808000
         AL    @08,@CF01530                                        0549 01809000
         LA    @11,CCADSIDA(@11,@08)                               0549 01810000
         ST    @11,MGPVARPT+8                                      0549 01811000
*       MGPTYPE=MGPSEV;             /*                       @Z67SP00*/ 01812000
         MVI   MGPTYPE,X'04'                                       0550 01813000
*       CALL HMASMMSG(HMASMMGP);    /*                       @Z67SP00*/ 01814000
         L     @15,@CV01270                                        0551 01815000
         LA    @01,@AL00551                                        0551 01816000
         BALR  @14,@15                                             0551 01817000
*       STOWRRC=IOPDIRFL;           /* SET RC                @Z67SP00*/ 01818000
         LA    STOWRRC,12                                          0552 01819000
*       GTPFUNCT(PGTPINDX)=GTPDEL;  /* DELETE ELEMENT JUST   @Z67SP00*/ 01820000
         SLR   @11,@11                                             0553 01821000
         IC    @11,PGTPINDX                                        0553 01822000
         MH    @11,@CH00467                                        0553 01823000
         LA    @08,5                                               0553 01824000
         STC   @08,GTPFUNCT-28(@11)                                0553 01825000
*       CALL HMASMGTA(HMASMGTP(PGTPINDX));/* ADDED           @Z67SP00*/ 01826000
         LA    @11,HMASMGTP-28(@11)                                0554 01827000
         ST    @11,@AL00001                                        0554 01828000
         L     @15,@CV01268                                        0554 01829000
         LA    @01,@AL00001                                        0554 01830000
         BALR  @14,@15                                             0554 01831000
*     END;                          /*                       @Z67SP00*/ 01832000
*   RETURN CODE(STOWRRC);                                          0556 01833000
@RF00539 LR    @15,STOWRRC                                         0556 01834000
         L     @14,@SA00008                                        0556 01835000
         LM    @00,@12,@SA00008+8                                  0556 01836000
         BR    @14                                                 0556 01837000
*   END EISSTOWR;                                                  0557 01838000
         EJECT                                                          01839000
*                                                                  0558 01840000
*   /*****************************************************************/ 01841000
*   /*                                                               */ 01842000
*   /* THIS ROUTINE IS CALLED TO PERFORM THE STOW DELETE FUNCTION.   */ 01843000
*   /*                                                               */ 01844000
*   /*****************************************************************/ 01845000
*                                                                  0558 01846000
*EISSTOWD:                          /*                       @Z67SP00*/ 01847000
*   PROC;                           /*                       @Z67SP00*/ 01848000
EISSTOWD STM   @14,@12,@SA00009                                    0558 01849000
*   DECLARE                         /*                       @Z67SP00*/ 01850000
*     STOWDRC FIXED(8);             /*                       @Z67SP00*/ 01851000
*   STOWDRC=IOPGOOD;                /* INIT RC               @Z67SP00*/ 01852000
         SLR   STOWDRC,STOWDRC                                     0560 01853000
*   IF CCACHECK=OFF                 /* IF NOT IN CHECK MODE  @Z67SP00*/ 01854000
*     THEN                          /*                       @Z67SP00*/ 01855000
         L     @11,@CA00037                                        0561 01856000
         TM    CCACHECK-HMASMCCA(@11),B'00010000'                  0561 01857000
         BNZ   @RF00561                                            0561 01858000
*     DO;                           /*                       @Z67SP00*/ 01859000
*       GTPFUNCT(PGTPINDX)=GTPDEL;  /* DO DELETE FROM PRIM   @Z67SP00*/ 01860000
         SLR   @11,@11                                             0563 01861000
         IC    @11,PGTPINDX                                        0563 01862000
         MH    @11,@CH00467                                        0563 01863000
         LA    @08,5                                               0563 01864000
         STC   @08,GTPFUNCT-28(@11)                                0563 01865000
*       GTPBUFAD(PGTPINDX)=ADDR(IOPDRMAP);/* DIR ENTRY ADDR  @Z67SP00*/ 01866000
         LA    @08,IOPDRMAP(,IOPPTR)                               0564 01867000
         ST    @08,GTPBUFAD-28(@11)                                0564 01868000
*       CALL HMASMGTA(HMASMGTP(PGTPINDX));/* DO DELETE       @Z67SP00*/ 01869000
         LA    @11,HMASMGTP-28(@11)                                0565 01870000
         ST    @11,@AL00001                                        0565 01871000
         L     @15,@CV01268                                        0565 01872000
         LA    @01,@AL00001                                        0565 01873000
         BALR  @14,@15                                             0565 01874000
*       STOWDRC=MAX(STOWDRC,GTPRETRN(PGTPINDX));/* SAVE RC   @Z67SP00*/ 01875000
         SLR   @11,@11                                             0566 01876000
         IC    @11,PGTPINDX                                        0566 01877000
         MH    @11,@CH00467                                        0566 01878000
         SLR   @08,@08                                             0566 01879000
         IC    @08,GTPRETRN-28(@11)                                0566 01880000
         CR    STOWDRC,@08                                         0566 01881000
         BNL   *+6                                                      01882000
         LR    STOWDRC,@08                                         0566 01883000
*       IF GTPRETRN(PGTPINDX)=GTPGOOD/* IF DELETE OK         @Z67SP00*/ 01884000
*           &GTPRCDNF(PGTPINDX)=OFF /* AND RCD FOUND         @Z67SP00*/ 01885000
*         THEN                      /* THEN DECR USED CNT    @Z67SP00*/ 01886000
         LTR   @08,@08                                             0567 01887000
         BNZ   @RF00567                                            0567 01888000
         LA    @08,GTPRCDNF-28(@11)                                0567 01889000
         TM    0(@08),B'01000000'                                  0567 01890000
         BNZ   @RF00567                                            0567 01891000
*         DSMEMUSE(PDSINDX)=DSMEMUSE(PDSINDX)-ONE;/* BY 1    @Z67SP00*/ 01892000
         LR    @11,PDSINDX                                         0568 01893000
         MH    @11,@CH01521                                        0568 01894000
         L     @08,DSMEMUSE-103(@11)                               0568 01895000
         BCTR  @08,0                                               0568 01896000
         ST    @08,DSMEMUSE-103(@11)                               0568 01897000
*     END;                          /*                       @Z67SP00*/ 01898000
*   ELSE                            /* IF IN CHECK THEN      @Z67SP00*/ 01899000
*     DO;                           /*                       @Z67SP00*/ 01900000
         B     @RC00561                                            0570 01901000
@RF00561 DS    0H                                                  0571 01902000
*       DSBUFFR(SDSINDX,1:DSDIRLN(SDSINDX))=IOPDRMAP(1:DSDIRLN(SGTPINDX 01903000
*           ));                     /* MOVE RCD TO TEMP BUFFER     0571 01904000
*                                                            @Z67SP00*/ 01905000
         SLR   @11,@11                                             0571 01906000
         IC    @11,SDSINDX                                         0571 01907000
         MH    @11,@CH01521                                        0571 01908000
         LA    @08,DSBUFFR-103(@11)                                0571 01909000
         SLR   @05,@05                                             0571 01910000
         IC    @05,DSDIRLN-103(@11)                                0571 01911000
         BCTR  @05,0                                               0571 01912000
         MVC   @TS00001(12),IOPDRMAP(IOPPTR)                       0571 01913000
         EX    @05,@SM01531                                        0571 01914000
*       DSBFDEL(SDSINDX)=TXTDEL;    /* MARK AS DELETED       @Z67SP00*/ 01915000
         LA    @08,DSBFDEL-103(@11)                                0572 01916000
         MVC   0(8,@08),@CC01281                                   0572 01917000
*       GTPFUNCT(SGTPINDX)=GTPADD;  /* DO ADD/REP            @Z67SP00*/ 01918000
         SLR   @08,@08                                             0573 01919000
         IC    @08,SGTPINDX                                        0573 01920000
         MH    @08,@CH00467                                        0573 01921000
         LA    @05,4                                               0573 01922000
         STC   @05,GTPFUNCT-28(@08)                                0573 01923000
*       GTPBUFAD(SGTPINDX)=ADDR(DSBUFFR(SDSINDX));/* RCD ADD @Z67SP00*/ 01924000
         LA    @11,DSBUFFR-103(@11)                                0574 01925000
         ST    @11,GTPBUFAD-28(@08)                                0574 01926000
*       CALL HMASMGTA(HMASMGTP(SGTPINDX));/* DO ADD/REP      @Z67SP00*/ 01927000
         LA    @11,HMASMGTP-28(@08)                                0575 01928000
         ST    @11,@AL00001                                        0575 01929000
         L     @15,@CV01268                                        0575 01930000
         LA    @01,@AL00001                                        0575 01931000
         BALR  @14,@15                                             0575 01932000
*       IF GTPRETRN(SGTPINDX)^=GTPGOOD/* IF NO SPACE         @Z67SP00*/ 01933000
*         THEN                                                     0576 01934000
         SLR   @11,@11                                             0576 01935000
         IC    @11,SGTPINDX                                        0576 01936000
         MH    @11,@CH00467                                        0576 01937000
         SLR   @08,@08                                             0576 01938000
         IC    @08,GTPRETRN-28(@11)                                0576 01939000
         CH    @08,@CH00252                                        0576 01940000
         BE    @RF00576                                            0576 01941000
*         DO;                       /*                       @Z67SP00*/ 01942000
*           CALL EISSPMSG;          /* ISSUE OUT OF SPCE MSG @Z67SP00*/ 01943000
         BAL   @14,EISSPMSG                                        0578 01944000
*           RFY                                                    0579 01945000
*             RTNCODE RSTD;         /*                               */ 01946000
*           STOWDRC=RTNCODE;        /*                               */ 01947000
         LR    STOWDRC,RTNCODE                                     0580 01948000
*           RFY                                                    0581 01949000
*             RTNCODE UNRSTD;       /*                               */ 01950000
*         END;                                                     0582 01951000
*     END;                          /*                       @Z67SP00*/ 01952000
@RF00576 DS    0H                                                  0584 01953000
*   IF STOWDRC=ZERO                 /* IF DELETE OK          @Z67SP00*/ 01954000
*     THEN                          /*                       @Z67SP00*/ 01955000
@RC00561 CH    STOWDRC,@CH00252                                    0584 01956000
         BNE   @RF00584                                            0584 01957000
*     CCAFLAG6=CCAFLAG6|DSMSKON(PDSINDX);/* SET DIS UPDATED  @Z67SP00*/ 01958000
         L     @11,@CA00037                                        0585 01959000
         LR    @08,PDSINDX                                         0585 01960000
         MH    @08,@CH01521                                        0585 01961000
         LA    @05,DSMSKON-103(@08)                                0585 01962000
         OC    CCAFLAG6-HMASMCCA(1,@11),0(@05)                     0585 01963000
*   RETURN CODE(STOWDRC);           /*                       @Z67SP00*/ 01964000
@RF00584 LR    @15,STOWDRC                                         0586 01965000
         L     @14,@SA00009                                        0586 01966000
         LM    @00,@12,@SA00009+8                                  0586 01967000
         BR    @14                                                 0586 01968000
*   END EISSTOWD;                   /*                       @Z67SP00*/ 01969000
         EJECT                                                          01970000
*                                                                  0588 01971000
*   /*****************************************************************/ 01972000
*   /*                                                               */ 01973000
*   /* THIS ROUTINE WILL FORMAT THE IN STORAGE DIRECTORY INTO        */ 01974000
*   /* DIRECTORY BLOCK FORMAT. IF THE NUMBER OF BLOCKS FORMATTED IS  */ 01975000
*   /* LESS THAN OR EQUAL TO THE NUMBER OF DIRECTORY BLOCKS ALLOCATED*/ 01976000
*   /* THEN IN STORAGE DIRECTORY WILL BE REFORMATTED AND WRITTEN OUT */ 01977000
*   /* TO THE APPROPRIATE SMP DATA SET. IF THE NUMBER OF DIRECTORY   */ 01978000
*   /* BLOCKS FORMATTED IS GREATER THAN THE NUMBER OF DIRECTORY      */ 01979000
*   /* BLOCKS ALLOCATED THEN HMA2823 WILL BE ISSUED AND A RETURN CODE*/ 01980000
*   /* OF 12 WILL BE SET.                                            */ 01981000
*   /*                                                               */ 01982000
*   /*****************************************************************/ 01983000
*                                                                  0588 01984000
*EISWRDIR:                          /*                       @Z67SP00*/ 01985000
*   PROC;                           /*                       @Z67SP00*/ 01986000
EISWRDIR STM   @14,@12,@SA00010                                    0588 01987000
*   DECLARE                                                        0589 01988000
*     WRDIRRC FIXED(8);             /* INTERNAL RETURN CODE          */ 01989000
*   DECLARE                         /*                       @Z67SP00*/ 01990000
*     DECALLOC CHAR(5) BDY(DWORD);  /* DIR BLK ALLOC DECIMAL COUNT   */ 01991000
*   DECLARE                         /*                       @Z67SP00*/ 01992000
*     DECREQD CHAR(5) BDY(DWORD);   /* DIR BLK REQUIRED DECIMAL COUNT*/ 01993000
*   DECLARE                                                        0592 01994000
*     PRTALLOC CHAR(5);             /* DIR BLK ALLOC PRINTABLE COUNT */ 01995000
*   DECLARE                                                        0593 01996000
*     PRTREQD CHAR(5);              /* DIR BLK REQUIRED PRINTABLE  0593 01997000
*                                      CNT.                          */ 01998000
*   DECLARE                                                        0594 01999000
*     PRTMSK BIT(8) CONSTANT('F0'X);/* USED TO MAKE LAST CHAR      0594 02000000
*                                      PRINTABLE                     */ 02001000
*   WRDIRRC=IOPGOOD;                /* INITIALIZE RETURN CODE        */ 02002000
         SLR   WRDIRRC,WRDIRRC                                     0595 02003000
*   CALL EISFORM;                   /* DETERMINE IF INSTORAGE WILL 0596 02004000
*                                      FIT ON SMP DATA SET           */ 02005000
         BAL   @14,EISFORM                                         0596 02006000
*   RFY                                                            0597 02007000
*     RTNCODE RSTD;                                                0597 02008000
*   WRDIRRC=RTNCODE;                /* SAVE RC FROM FORMAT ROUTINE   */ 02009000
         LR    WRDIRRC,RTNCODE                                     0598 02010000
*   RFY                                                            0599 02011000
*     RTNCODE UNRSTD;                                              0599 02012000
*   IF DIRBKCT>DSBLKCT(PDSINDX)     /* IF NOT ENOUGH SPACE THEN DO   */ 02013000
*     THEN                          /*                       @Z67SP00*/ 02014000
         LR    @11,PDSINDX                                         0600 02015000
         MH    @11,@CH01521                                        0600 02016000
         L     @08,DSBLKCT-103(@11)                                0600 02017000
         CR    DIRBKCT,@08                                         0600 02018000
         BNH   @RF00600                                            0600 02019000
*     DO;                           /*                       @Z67SP00*/ 02020000
*       HMASMMGP=''B;               /* CLEAR MESSAGE PARMS           */ 02021000
         XC    HMASMMGP(24),HMASMMGP                               0602 02022000
*       MGPPRINT=ON;                /* MESSAGES TO SYSOUT            */ 02023000
*       MGPHLDS=ON;                 /* MESSAGES TO LOG               */ 02024000
         OI    MGPPRINT,B'10010000'                                0604 02025000
*       MGPTYPE=MGPSEV;             /* SET TO SEVERE MESSAGE         */ 02026000
         MVI   MGPTYPE,X'04'                                       0605 02027000
*       MGPMGNO1=HMA282I;           /* SET MESSAGE NUMBER            */ 02028000
         MVC   MGPMGNO1(2),@CH00518                                0606 02029000
*       MGPVARPT(1)=ADDR(DSDDNAME(PDSINDX));/*                       */ 02030000
         LA    @11,DSDDNAME-103(@11)                               0607 02031000
         ST    @11,MGPVARPT                                        0607 02032000
*       CVD(DIRBKCT,DECREQD);       /* CONVERT REQUIRED BLK CT TO DEC*/ 02033000
         CVD   DIRBKCT,@TS00001                                    0608 02034000
         MVC   DECREQD(5),@TS00001+3                               0608 02035000
*       UNPK(PRTREQD,DECREQD);      /* UNPACK DECIMAL RED BLOCK CNT. */ 02036000
         UNPK  PRTREQD(5),DECREQD(5)                               0609 02037000
*       PRTREQD(5)=PRTREQD(5)|PRTMSK;/* MAKE LAST CHAR PRINTABLE     */ 02038000
         OI    PRTREQD+4,X'F0'                                     0610 02039000
*       MGPVARPT(2)=ADDR(PRTREQD);  /* INSERT REQD CNT INTO MSG      */ 02040000
         LA    @11,PRTREQD                                         0611 02041000
         ST    @11,MGPVARPT+4                                      0611 02042000
*       CVD(DSBLKCT(PDSINDX),DECALLOC);/* CNV. ALLOC CT. TO DEC      */ 02043000
         CVD   @08,@TS00001                                        0612 02044000
         MVC   DECALLOC(5),@TS00001+3                              0612 02045000
*       UNPK(PRTALLOC,DECALLOC);    /* UNPACK DECIMAL ALOOCATED CNT. */ 02046000
         UNPK  PRTALLOC(5),DECALLOC(5)                             0613 02047000
*       PRTALLOC(5)=PRTALLOC(5)|PRTMSK;/* MAKE LAST CHAR PRINTABLE   */ 02048000
         OI    PRTALLOC+4,X'F0'                                    0614 02049000
*       MGPVARPT(3)=ADDR(PRTALLOC); /* INSERT ALLOC CNT INTO MSG     */ 02050000
         LA    @11,PRTALLOC                                        0615 02051000
         ST    @11,MGPVARPT+8                                      0615 02052000
*       CALL HMASMMSG(HMASMMGP);    /* NOT ENOUGH SPACE ON SMP DS    */ 02053000
         L     @15,@CV01270                                        0616 02054000
         LA    @01,@AL00616                                        0616 02055000
         BALR  @14,@15                                             0616 02056000
*       WRDIRRC=STOPFUNC;           /* SET RC TO STOP FUNCTION       */ 02057000
         LA    WRDIRRC,12                                          0617 02058000
*     END;                                                         0618 02059000
*   ELSE                            /* IF ENOUGH SPACE THEN WRITE OUT   02060000
*                                      INSTORAGE FILE TO SMP DATA SET*/ 02061000
*     IF CCACHECK=OFF               /* IF NOT IN CHECK MODE  @Z67SP00*/ 02062000
*       THEN                        /*                       @Z67SP00*/ 02063000
         B     @RC00600                                            0619 02064000
@RF00600 L     @11,@CA00037                                        0619 02065000
         TM    CCACHECK-HMASMCCA(@11),B'00010000'                  0619 02066000
         BNZ   @RF00619                                            0619 02067000
*       DO;                         /*                       @Z67SP00*/ 02068000
*         DSFLAGS1(PDSINDX)=''B;    /* ZERO EOF FLAGS BITS   @Z67SP00*/ 02069000
         LR    @11,PDSINDX                                         0621 02070000
         MH    @11,@CH01521                                        0621 02071000
         LA    @08,DSFLAGS1-103(@11)                               0621 02072000
         MVI   0(@08),X'00'                                        0621 02073000
*         CALL EISWRITE;            /* WRITE IN STORAGE DIRECTORY TO    02074000
*                                      SMP DATA SET                  */ 02075000
         BAL   @14,EISWRITE                                        0622 02076000
*         RFY                                                      0623 02077000
*           RTNCODE RSTD;                                          0623 02078000
*         WRDIRRC=RTNCODE;          /* SAVE RETURN CODE FROM WRITE   */ 02079000
         LR    WRDIRRC,RTNCODE                                     0624 02080000
*         RFY                                                      0625 02081000
*           RTNCODE UNRSTD;                                        0625 02082000
*       END;                        /* END OF WRITE TO SMP DATA SET  */ 02083000
*   CCAFLAG6=CCAFLAG6&DSMSKOFF(PDSINDX);/* TURN OFF DIS UPDATED    0627 02084000
*                                      INDICATOR             @Z67SP00*/ 02085000
@RF00619 DS    0H                                                  0627 02086000
@RC00600 L     @11,@CA00037                                        0627 02087000
         LR    @08,PDSINDX                                         0627 02088000
         MH    @08,@CH01521                                        0627 02089000
         LA    @01,DSMSKOFF-103(@08)                               0627 02090000
         NC    CCAFLAG6-HMASMCCA(1,@11),0(@01)                     0627 02091000
*   RETURN CODE(WRDIRRC);                                          0628 02092000
         LR    @15,WRDIRRC                                         0628 02093000
         L     @14,@SA00010                                        0628 02094000
         LM    @00,@12,@SA00010+8                                  0628 02095000
         BR    @14                                                 0628 02096000
*   END EISWRDIR;                                                  0629 02097000
         EJECT                                                          02098000
*                                                                  0630 02099000
*   /*****************************************************************/ 02100000
*   /*                                                               */ 02101000
*   /* THIS ROUTINE WILL READ THE IN STORAGE DIRECTORY VIA CALLS TO  */ 02102000
*   /* HMASMGTA AND FORMAT THE RECORDS INTO DIRECTORY BLOCKS. THE    */ 02103000
*   /* OUTPUT FROM THIS ROUTINE WILL BE A COUNT OF THE DIRECTORY     */ 02104000
*   /* BLOCKS FORMATTED(DIRBKCT).                                    */ 02105000
*   /*                                                               */ 02106000
*   /*****************************************************************/ 02107000
*                                                                  0630 02108000
*EISFORM:                                                          0630 02109000
*   PROC;                                                          0630 02110000
EISFORM  STM   @14,@06,@SA00011                                    0630 02111000
         STM   @08,@12,@SA00011+36                                 0630 02112000
*   DECLARE                                                        0631 02113000
*     FORMRC FIXED(8);              /* INTERNAL RETURN CODE          */ 02114000
*   RFY                                                            0632 02115000
*     HMASMIOP BASED(WRDIRPTR);     /* USE APPROPRIATE IOP           */ 02116000
*   FORMRC=IOPGOOD;                 /* INIT INTERNAL RETURN CODE     */ 02117000
         SLR   FORMRC,FORMRC                                       0633 02118000
*   UNUSEDSP=LENGTH(OUTFILL);       /* INIT UNUSED DIRECTORY SPACE   */ 02119000
         LA    UNUSEDSP,254                                        0634 02120000
*   DIRBKCT=ZERO;                   /* INIT NO. OF DIRECTORY BLOCKS     02121000
*                                      FORMATTED                     */ 02122000
         SLR   DIRBKCT,DIRBKCT                                     0635 02123000
*   GTPFUNCT(PGTPINDX)=GTPOPENN;    /* OPEN FOR GETN PROCESSING      */ 02124000
         SLR   @11,@11                                             0636 02125000
         IC    @11,PGTPINDX                                        0636 02126000
         MH    @11,@CH00467                                        0636 02127000
         LA    @08,1                                               0636 02128000
         STC   @08,GTPFUNCT-28(@11)                                0636 02129000
*   CALL HMASMGTA(HMASMGTP(PGTPINDX));/* VIA CALL TO GTA             */ 02130000
         LA    @11,HMASMGTP-28(@11)                                0637 02131000
         ST    @11,@AL00001                                        0637 02132000
         L     @15,@CV01268                                        0637 02133000
         LA    @01,@AL00001                                        0637 02134000
         BALR  @14,@15                                             0637 02135000
*   DO WHILE(FORMRC=GTPGOOD);       /* FORMAT UNTIL ALL RECORDS FROM    02136000
*                                      IN STORAGE FILE HAVE BEEN   0638 02137000
*                                      FORMATTED                     */ 02138000
         B     @DE00638                                            0638 02139000
@DL00638 DS    0H                                                  0639 02140000
*     CALL EISGETN;                 /* GET NEXT RCD FROM GTA @Z67SP00*/ 02141000
         BAL   @14,EISGETN                                         0639 02142000
*     RFY                           /*                       @Z67SP00*/ 02143000
*       RTNCODE RSTD;               /*                       @Z67SP00*/ 02144000
*     FORMRC=RTNCODE;               /* SAVE GTA RETURN CODE          */ 02145000
         LR    FORMRC,RTNCODE                                      0641 02146000
*     RFY                           /*                       @Z67SP00*/ 02147000
*       RTNCODE UNRSTD;             /*                       @Z67SP00*/ 02148000
*     IF FORMRC=GTPGOOD             /* IF RECORD RETRIVED THEN DO    */ 02149000
*       THEN                        /*                               */ 02150000
         CH    FORMRC,@CH00252                                     0643 02151000
         BNE   @RF00643                                            0643 02152000
*       DO;                         /*                               */ 02153000
*         MVSIZE=((ULEN&NOALIAS)*2+DIRBASE);/* CALCULATE SIZE OF   0645 02154000
*                                      ENTRY                         */ 02155000
         SLR   @11,@11                                             0645 02156000
         IC    @11,PGTPINDX                                        0645 02157000
         MH    @11,@CH00467                                        0645 02158000
         L     @11,GTPBUFAD-28(@11)                                0645 02159000
         LA    MVSIZE,31                                           0645 02160000
         SLR   @08,@08                                             0645 02161000
         IC    @08,ULEN(,@11)                                      0645 02162000
         NR    MVSIZE,@08                                          0645 02163000
         ALR   MVSIZE,MVSIZE                                       0645 02164000
         AH    MVSIZE,@CH00033                                     0645 02165000
*         IF MVSIZE>UNUSEDSP        /* IF DIRECTORY BLOCK FULL THEN  */ 02166000
*           THEN                    /* DO                            */ 02167000
         CR    MVSIZE,UNUSEDSP                                     0646 02168000
         BNH   @RF00646                                            0646 02169000
*           DO;                     /*                       @Z67SP00*/ 02170000
*             DIRBKCT=DIRBKCT+ONE;  /* INCR COUNT OF DIR. BLOCKS     */ 02171000
         AH    DIRBKCT,@CH00087                                    0648 02172000
*             UNUSEDSP=LENGTH(OUTFILL);/* REINIT UNUSED SPACE        */ 02173000
         LA    UNUSEDSP,254                                        0649 02174000
*           END;                    /*                               */ 02175000
*         UNUSEDSP=UNUSEDSP-MVSIZE; /* UPDATE UNUSED SPACE COUNT     */ 02176000
@RF00646 SLR   UNUSEDSP,MVSIZE                                     0651 02177000
*       END;                                                       0652 02178000
*     ELSE                                                         0653 02179000
*       DO;                         /*                       @Z67SP00*/ 02180000
         B     @RC00643                                            0653 02181000
@RF00643 DS    0H                                                  0654 02182000
*         IF DIRBASE>UNUSEDSP       /* IF END OF FILE RETURNED THEN  */ 02183000
*           THEN                    /*                       @Z67SP00*/ 02184000
         CH    UNUSEDSP,@CH00033                                   0654 02185000
         BNL   @RF00654                                            0654 02186000
*           DIRBKCT=DIRBKCT+ONE;    /* UP COUNT OF DIR. BLKS IF    0655 02187000
*                                      NECESSARY                     */ 02188000
         AH    DIRBKCT,@CH00087                                    0655 02189000
*         DIRBKCT=DIRBKCT+ONE;      /* WRITE OUT PAGE WITH EOF       */ 02190000
@RF00654 AH    DIRBKCT,@CH00087                                    0656 02191000
*       END;                                                       0657 02192000
*   END;                                                           0658 02193000
@RC00643 DS    0H                                                  0658 02194000
@DE00638 CH    FORMRC,@CH00252                                     0658 02195000
         BE    @DL00638                                            0658 02196000
*   PGTPINDX=DSGTPFRS(PDSINDX);     /* RESET INDEX BACK TO FIRST GTP    02197000
*                                      FOR DATASET           @Z67SP00*/ 02198000
         LR    @11,PDSINDX                                         0659 02199000
         MH    @11,@CH01521                                        0659 02200000
         SLR   @08,@08                                             0659 02201000
         IC    @08,DSGTPFRS-103(@11)                               0659 02202000
         STC   @08,PGTPINDX                                        0659 02203000
*   RETURN CODE(FORMRC);                                           0660 02204000
         LR    @15,FORMRC                                          0660 02205000
         L     @14,@SA00011                                        0660 02206000
         LM    @00,@06,@SA00011+8                                  0660 02207000
         LM    @08,@12,@SA00011+36                                 0660 02208000
         BR    @14                                                 0660 02209000
*   END EISFORM;                                                   0661 02210000
         EJECT                                                          02211000
*                                                                  0662 02212000
*   /*****************************************************************/ 02213000
*   /*                                                               */ 02214000
*   /* THIS ROUTINE WILL FORMAT THE IN STORAGE DIRECTORY INTO        */ 02215000
*   /* DIRECTORY BLOCK FORMAT AND UPDATE THE APPROPRIATE SMP DATA SET*/ 02216000
*   /* DIRECTORY                                                     */ 02217000
*   /*                                                               */ 02218000
*   /*****************************************************************/ 02219000
*                                                                  0662 02220000
*EISWRITE:                                                         0662 02221000
*   PROC;                                                          0662 02222000
EISWRITE STM   @14,@12,@SA00012                                    0662 02223000
*   DECLARE                                                        0663 02224000
*     WRITRC FIXED(8);              /* INTERNAL RETURN CODE          */ 02225000
*   DECLARE                                                        0664 02226000
*     1 WRITSW BIT(8),              /* SWITCH FOR THIS ROUTINE       */ 02227000
*       3 WRITSTOP BIT(1),          /* ON FOR EOF CONDITION          */ 02228000
*       3 * BIT(7);                 /* UNUSED                        */ 02229000
*   RFY                                                            0665 02230000
*     HMASMIOP BASED(WRDIRPTR);     /* ADDRESS APPROPRIATE IOP       */ 02231000
*   WRITRC=IOPGOOD;                 /* INIT INTERNAL RETURN CODE     */ 02232000
         SLR   WRITRC,WRITRC                                       0666 02233000
*   UNUSEDSP=LENGTH(OUTFILL);       /* INIT UNUSED DIRECTORY SPACE   */ 02234000
         LA    UNUSEDSP,254                                        0667 02235000
*   FILLPTR=ADDR(OUTFILL);          /* INIT TO BEGINNING OF DIRECTORY   02236000
*                                      BLOCK                         */ 02237000
         LA    FILLPTR,OUTFILL                                     0668 02238000
*   DIRBKCT=ZERO;                   /* INIT COUNT OF DIR BLOCKS      */ 02239000
         SLR   DIRBKCT,DIRBKCT                                     0669 02240000
*   GTPFUNCT(PGTPINDX)=GTPOPENN;    /* POSITION TO START OF IN     0670 02241000
*                                      STORAGE FILE                  */ 02242000
         SLR   @11,@11                                             0670 02243000
         IC    @11,PGTPINDX                                        0670 02244000
         MH    @11,@CH00467                                        0670 02245000
         LA    @06,1                                               0670 02246000
         STC   @06,GTPFUNCT-28(@11)                                0670 02247000
*   CALL HMASMGTA(HMASMGTP(PGTPINDX));/* VIA CALL TO HMASMGTA        */ 02248000
         LA    @11,HMASMGTP-28(@11)                                0671 02249000
         ST    @11,@AL00001                                        0671 02250000
         L     @15,@CV01268                                        0671 02251000
         LA    @01,@AL00001                                        0671 02252000
         BALR  @14,@15                                             0671 02253000
*   WRITSTOP=OFF;                   /* CONTINUE WITH WRITE           */ 02254000
         NI    WRITSTOP,B'01111111'                                0672 02255000
*   DO WHILE(WRITRC=IOPGOOD         /* RETRIEVE AND FORMAT UNTIL EOF */ 02256000
*         &WRITSTOP=OFF);           /* CONDITION RETURNED            */ 02257000
         B     @DE00673                                            0673 02258000
@DL00673 DS    0H                                                  0674 02259000
*     CALL EISGETN;                 /* GET NEXT RCD          @Z67SP00*/ 02260000
         BAL   @14,EISGETN                                         0674 02261000
*     RFY                           /*                       @Z67SP00*/ 02262000
*       RTNCODE RSTD;               /*                       @Z67SP00*/ 02263000
*     WRITRC=RTNCODE;               /* SAVE RC               @Z67SP00*/ 02264000
         LR    WRITRC,RTNCODE                                      0676 02265000
*     RFY                           /*                       @Z67SP00*/ 02266000
*       RTNCODE UNRSTD;             /*                       @Z67SP00*/ 02267000
*     IF WRITRC=GTPGOOD             /* IF RECORD RETRIEVED           */ 02268000
*       THEN                                                       0678 02269000
         CH    WRITRC,@CH00252                                     0678 02270000
         BNE   @RF00678                                            0678 02271000
*       DO;                         /* THEN DO                       */ 02272000
*         MVSIZE=((ULEN&NOALIAS)*2+DIRBASE);/* CALC. ENTRY SIZE      */ 02273000
         SLR   @11,@11                                             0680 02274000
         IC    @11,PGTPINDX                                        0680 02275000
         MH    @11,@CH00467                                        0680 02276000
         L     @11,GTPBUFAD-28(@11)                                0680 02277000
         LA    MVSIZE,31                                           0680 02278000
         SLR   @15,@15                                             0680 02279000
         IC    @15,ULEN(,@11)                                      0680 02280000
         NR    MVSIZE,@15                                          0680 02281000
         ALR   MVSIZE,MVSIZE                                       0680 02282000
         AH    MVSIZE,@CH00033                                     0680 02283000
*         IF MVSIZE>UNUSEDSP        /* IF NO SPACE WRITE OUT BUFFER  */ 02284000
*           THEN                                                   0681 02285000
         CR    MVSIZE,UNUSEDSP                                     0681 02286000
         BNH   @RF00681                                            0681 02287000
*           DO;                     /* TO SMP DATA SET               */ 02288000
*             CALL BLKWRITE;                                       0683 02289000
         BAL   @14,BLKWRITE                                        0683 02290000
*             RFY                                                  0684 02291000
*               RTNCODE RSTD;                                      0684 02292000
*             WRITRC=RTNCODE;       /* SAVE RETURN CODE              */ 02293000
         LR    WRITRC,RTNCODE                                      0685 02294000
*             RFY                                                  0686 02295000
*               RTNCODE UNRSTD;                                    0686 02296000
*           END;                                                   0687 02297000
*         IF WRITRC=IOPGOOD THEN                                   0688 02298000
@RF00681 CH    WRITRC,@CH00252                                     0688 02299000
         BNE   @RF00688                                            0688 02300000
*           DO;                     /* CONTINUE IF WRITE OK          */ 02301000
*             OUTMEM(1:MVSIZE)=     /* WRITE RECORD TO OUTPUT BUFFER */ 02302000
*                 NTRYMAP(1:MVSIZE);                               0690 02303000
         LR    @11,MVSIZE                                          0690 02304000
         BCTR  @11,0                                               0690 02305000
         SLR   @15,@15                                             0690 02306000
         IC    @15,PGTPINDX                                        0690 02307000
         MH    @15,@CH00467                                        0690 02308000
         L     @15,GTPBUFAD-28(@15)                                0690 02309000
         EX    @11,@SM01533                                        0690 02310000
*             OUTKEY(1:8)=NTRYKEY(1:8);/* SAVE KEY OF LAST RECORD    */ 02311000
         MVC   OUTKEY(8),NTRYKEY(@15)                              0691 02312000
*             UNUSEDSP=UNUSEDSP-MVSIZE;/* UPDATE UNUSED SPACE COUNT  */ 02313000
         SLR   UNUSEDSP,MVSIZE                                     0692 02314000
*             FILLPTR=FILLPTR+MVSIZE;/* UPDATE PTR TO NEXT RECORD IN    02315000
*                                      OUTPUT BUFFER                 */ 02316000
         ALR   FILLPTR,MVSIZE                                      0693 02317000
*           END;                    /* END OF OUTPUT BUFFER UPDATE   */ 02318000
*       END;                        /* END OF RECORD RETRIEVED       */ 02319000
*     ELSE                                                         0696 02320000
*       DO;                         /* IF EOF THEN DO                */ 02321000
         B     @RC00678                                            0696 02322000
@RF00678 DS    0H                                                  0697 02323000
*         WRITRC=IOPGOOD;           /* RESET RC TO SUCCESSFUL        */ 02324000
         SLR   WRITRC,WRITRC                                       0697 02325000
*         WRITSTOP=ON;              /* SIGNAL STOP WRITE DUE TO EOF  */ 02326000
         OI    WRITSTOP,B'10000000'                                0698 02327000
*         MVSIZE=DIRBASE;           /* SET LENGTH OF RECORD          */ 02328000
         LA    MVSIZE,12                                           0699 02329000
*         IF MVSIZE>UNUSEDSP        /* IF NO SPACE WRITE OUT BUFFER  */ 02330000
*           THEN                                                   0700 02331000
         CR    MVSIZE,UNUSEDSP                                     0700 02332000
         BNH   @RF00700                                            0700 02333000
*           DO;                     /* TO SMP DATA SET               */ 02334000
*             CALL BLKWRITE;                                       0702 02335000
         BAL   @14,BLKWRITE                                        0702 02336000
*             RFY                                                  0703 02337000
*               RTNCODE RSTD;                                      0703 02338000
*             WRITRC=RTNCODE;       /* SAVE RETURN CODE              */ 02339000
         LR    WRITRC,RTNCODE                                      0704 02340000
*             RFY                                                  0705 02341000
*               RTNCODE UNRSTD;                                    0705 02342000
*           END;                                                   0706 02343000
*         IF WRITRC=IOPGOOD THEN                                   0707 02344000
@RF00700 CH    WRITRC,@CH00252                                     0707 02345000
         BNE   @RF00707                                            0707 02346000
*           DO;                     /* CONTINUE IF WRITE OK          */ 02347000
*             OUTMEM(1:MVSIZE)=     /* WRITE END OF FILE RECORD TO   */ 02348000
*                 EOFRCD(1:MVSIZE); /* OUTPUT BUFFER                 */ 02349000
         LR    @11,MVSIZE                                          0709 02350000
         BCTR  @11,0                                               0709 02351000
         EX    @11,@SM01535                                        0709 02352000
*             OUTKEY(1:8)=EOFKEY(1:8);/* SAVE KEY OF LAST RECORD     */ 02353000
         MVC   OUTKEY(8),EOFKEY                                    0710 02354000
*             UNUSEDSP=UNUSEDSP-MVSIZE;/* DECREMENT UNUSED SPACE     */ 02355000
         SLR   UNUSEDSP,MVSIZE                                     0711 02356000
*             CALL BLKWRITE;        /* WRITE LAST DIRECTORY BLOCK    */ 02357000
         BAL   @14,BLKWRITE                                        0712 02358000
*             RFY                                                  0713 02359000
*               RTNCODE RSTD;                                      0713 02360000
*             WRITRC=RTNCODE;       /* SAVE WRITE RETURN CODE        */ 02361000
         LR    WRITRC,RTNCODE                                      0714 02362000
*             RFY                                                  0715 02363000
*               RTNCODE UNRSTD;                                    0715 02364000
*           END;                    /* END WRITE OF LAST BLOCK       */ 02365000
*       END;                        /* END UPDATE OF OUTPUT BUFFER   */ 02366000
@RF00707 DS    0H                                                  0718 02367000
*   END;                            /* END OF FORMAT AND WRITE       */ 02368000
@RC00678 DS    0H                                                  0718 02369000
@DE00673 CH    WRITRC,@CH00252                                     0718 02370000
         BNE   @DC00673                                            0718 02371000
         TM    WRITSTOP,B'10000000'                                0718 02372000
         BZ    @DL00673                                            0718 02373000
@DC00673 DS    0H                                                  0719 02374000
*   PGTPINDX=DSGTPFRS(PDSINDX);     /* SET INDEX BACK TO FIRST GTP 0719 02375000
*                                      FOR DATASET           @Z67SP00*/ 02376000
         LR    @11,PDSINDX                                         0719 02377000
         MH    @11,@CH01521                                        0719 02378000
         SLR   @08,@08                                             0719 02379000
         IC    @08,DSGTPFRS-103(@11)                               0719 02380000
         STC   @08,PGTPINDX                                        0719 02381000
*   RETURN CODE(WRITRC);                                           0720 02382000
         LR    @15,WRITRC                                          0720 02383000
         L     @14,@SA00012                                        0720 02384000
         LM    @00,@12,@SA00012+8                                  0720 02385000
         BR    @14                                                 0720 02386000
*   END EISWRITE;                                                  0721 02387000
         EJECT                                                          02388000
*                                                                  0722 02389000
*   /*****************************************************************/ 02390000
*   /*                                                               */ 02391000
*   /* THIS ROUTINE WILL READ A DIRECTORY BLOCK FROM THE SMP DATA SET*/ 02392000
*   /* INTO INBUFF AND WILL WRITE OUT THE DIRECTORY BLOCK FROM OUBUFF*/ 02393000
*   /*                                                               */ 02394000
*   /*****************************************************************/ 02395000
*                                                                  0722 02396000
*BLKWRITE:                                                         0722 02397000
*   PROC;                                                          0722 02398000
BLKWRITE STM   @14,@04,@SA00013                                    0722 02399000
         ST    @06,@SA00013+28                                     0722 02400000
         STM   @09,@12,@SA00013+32                                 0722 02401000
*   DECLARE                                                        0723 02402000
*     INBUFF CHAR(264);             /* BUFFER TO CONTAIN OUTPUT OF 0723 02403000
*                                      DIRECTORY READ                */ 02404000
*   DECLARE                                                        0724 02405000
*     BLKIOP CHAR(LENGTH(HMASMIOP));/* IOP FOR READ AND WRITE        */ 02406000
*   DECLARE                                                        0725 02407000
*     BLKPTR PTR(31) INIT(ADDR(BLKIOP));/* ADDRESS IOP USED HERE     */ 02408000
*   DECLARE                                                        0726 02409000
*     BLKWRRC FIXED(8);             /* INTERNAL RETURN CODE          */ 02410000
*   RFY                                                            0727 02411000
*     HMASMIOP BASED(BLKPTR);       /* USE THIS ROUTINES IOP         */ 02412000
*   BLKWRRC=IOPGOOD;                /* INIT INTERNAL RETURN CODE     */ 02413000
         SLR   BLKWRRC,BLKWRRC                                     0728 02414000
*   IOPDSID=DSDIR(PDSINDX);         /* SET APPROPRIATE DSID          */ 02415000
         L     @11,BLKPTR                                          0729 02416000
         LR    @06,PDSINDX                                         0729 02417000
         MH    @06,@CH01521                                        0729 02418000
         SLR   @04,@04                                             0729 02419000
         IC    @04,DSDIR-103(@06)                                  0729 02420000
         STC   @04,IOPDSID(,@11)                                   0729 02421000
*   IF DIRBKCT=ZERO                 /* IF WRITE OF FIRST BLOCK THEN     02422000
*                                      CLOSE SMP DATA SET DIRECTORY  */ 02423000
*     THEN                                                         0730 02424000
         LTR   DIRBKCT,DIRBKCT                                     0730 02425000
         BNZ   @RF00730                                            0730 02426000
*     DO;                                                          0731 02427000
*       IOPFUNCT=IOPCLOSE;          /* SET FUNCTION TO CLOSE         */ 02428000
         MVI   IOPFUNCT(@11),X'50'                                 0732 02429000
*       CALL HMASMIO(HMASMIOP);     /* CALL HMASMIO TO DO CLOSE      */ 02430000
         ST    @11,@AL00001                                        0733 02431000
         L     @15,@CV01269                                        0733 02432000
         LA    @01,@AL00001                                        0733 02433000
         BALR  @14,@15                                             0733 02434000
*       BLKWRRC=IOPRETRN;           /* SAVE RETURN CODE              */ 02435000
         L     @11,BLKPTR                                          0734 02436000
         SLR   BLKWRRC,BLKWRRC                                     0734 02437000
         IC    BLKWRRC,IOPRETRN(,@11)                              0734 02438000
*     END;                                                         0735 02439000
*   IF BLKWRRC=IOPGOOD              /* IF CLOSE SUCCESSFUL           */ 02440000
*     THEN                                                         0736 02441000
@RF00730 CH    BLKWRRC,@CH00252                                    0736 02442000
         BNE   @RF00736                                            0736 02443000
*     DO;                           /* THEN DO                       */ 02444000
*       DIRBKCT=DIRBKCT+ONE;        /* UP COUNT OF BLOCKS WRITTEN    */ 02445000
         AH    DIRBKCT,@CH00087                                    0738 02446000
*       OUTBLKSZ=LENGTH(OUTFILL)-UNUSEDSP+LENGTH(OUTBLKSZ);/* SET UP    02447000
*                                      THE LENGTH OF DIRECTORY BLOCK */ 02448000
         LA    @11,254                                             0739 02449000
         LR    @06,@11                                             0739 02450000
         SLR   @06,UNUSEDSP                                        0739 02451000
         LA    @06,2(,@06)                                         0739 02452000
         STH   @06,OUTBLKSZ                                        0739 02453000
*       UNUSEDSP=LENGTH(OUTFILL);   /* RE-INIT UNUSED SPACE CT       */ 02454000
         LR    UNUSEDSP,@11                                        0740 02455000
*       FILLPTR=ADDR(OUTFILL);      /* RE-INIT NEXT RECORD POSITION  */ 02456000
         LA    FILLPTR,OUTFILL                                     0741 02457000
*       IOPFUNCT=IOPREAD;           /* SET FUNCTION TO READ          */ 02458000
         L     @11,BLKPTR                                          0742 02459000
         MVI   IOPFUNCT(@11),X'01'                                 0742 02460000
*       IOPBUFAD=ADDR(INBUFF);      /* PASS ADDRESS OF INPUT BUFFER  */ 02461000
         LA    @06,INBUFF                                          0743 02462000
         ST    @06,IOPBUFAD(,@11)                                  0743 02463000
*       CALL HMASMIO(HMASMIOP);     /* READ DIRECTORY BLOCK          */ 02464000
         ST    @11,@AL00001                                        0744 02465000
         L     @15,@CV01269                                        0744 02466000
         LA    @01,@AL00001                                        0744 02467000
         BALR  @14,@15                                             0744 02468000
*       BLKWRRC=IOPRETRN;           /* SAVE RETURN CODE              */ 02469000
         L     @11,BLKPTR                                          0745 02470000
         SLR   BLKWRRC,BLKWRRC                                     0745 02471000
         IC    BLKWRRC,IOPRETRN(,@11)                              0745 02472000
*       IF BLKWRRC=IOPGOOD          /* IF READ SUCCESSFUL THEN DO  0746 02473000
*                                      WRITE                         */ 02474000
*         THEN                                                     0746 02475000
         CH    BLKWRRC,@CH00252                                    0746 02476000
         BNE   @RF00746                                            0746 02477000
*         DO;                                                      0747 02478000
*           IOPFUNCT=IOPWRITE;      /* SET FUNCTION TO WRITE         */ 02479000
         MVI   IOPFUNCT(@11),X'51'                                 0748 02480000
*           IOPBUFAD=ADDR(OUTBUFF); /* PASS OUTPUT ADDRESS           */ 02481000
         LA    @06,OUTBUFF                                         0749 02482000
         ST    @06,IOPBUFAD(,@11)                                  0749 02483000
*           CALL HMASMIO(HMASMIOP); /* WRITE DIRECTORY BLOCK         */ 02484000
         ST    @11,@AL00001                                        0750 02485000
         L     @15,@CV01269                                        0750 02486000
         LA    @01,@AL00001                                        0750 02487000
         BALR  @14,@15                                             0750 02488000
*           BLKWRRC=IOPRETRN;       /* SAVE RETURN CODE              */ 02489000
         L     @11,BLKPTR                                          0751 02490000
         SLR   BLKWRRC,BLKWRRC                                     0751 02491000
         IC    BLKWRRC,IOPRETRN(,@11)                              0751 02492000
*         END;                                                     0752 02493000
*       IF BLKWRRC^=IOPGOOD|        /* IF BAD READ OR WRITE          */ 02494000
*           OUTKEY(1:8)=EOFKEY(1:8) /* LAST BLOCK WRITTEN            */ 02495000
*         THEN                                                     0753 02496000
@RF00746 CH    BLKWRRC,@CH00252                                    0753 02497000
         BNE   @RT00753                                            0753 02498000
         CLC   OUTKEY(8),EOFKEY                                    0753 02499000
         BNE   @RF00753                                            0753 02500000
@RT00753 DS    0H                                                  0754 02501000
*         DO;                       /* THEN DO                       */ 02502000
*           IOPFUNCT=IOPCLOSE;      /* SET FUNCTION TO CLOSE         */ 02503000
         L     @11,BLKPTR                                          0755 02504000
         MVI   IOPFUNCT(@11),X'50'                                 0755 02505000
*           CALL HMASMIO(HMASMIOP); /* CALL IO TO DO CLOSE           */ 02506000
         ST    @11,@AL00001                                        0756 02507000
         L     @15,@CV01269                                        0756 02508000
         LA    @01,@AL00001                                        0756 02509000
         BALR  @14,@15                                             0756 02510000
*           BLKWRRC=MAX(IOPRETRN,BLKWRRC);/* SAVE MAX RC             */ 02511000
         L     @11,BLKPTR                                          0757 02512000
         SLR   @06,@06                                             0757 02513000
         IC    @06,IOPRETRN(,@11)                                  0757 02514000
         CR    BLKWRRC,@06                                         0757 02515000
         BNL   *+6                                                      02516000
         LR    BLKWRRC,@06                                         0757 02517000
*         END;                                                     0758 02518000
*     END;                                                         0759 02519000
@RF00753 DS    0H                                                  0760 02520000
*   RETURN CODE(BLKWRRC);                                          0760 02521000
@RF00736 LR    @15,BLKWRRC                                         0760 02522000
         L     @14,@SA00013                                        0760 02523000
         LM    @00,@04,@SA00013+8                                  0760 02524000
         L     @06,@SA00013+28                                     0760 02525000
         LM    @09,@12,@SA00013+32                                 0760 02526000
         BR    @14                                                 0760 02527000
*   END BLKWRITE;                                                  0761 02528000
         EJECT                                                          02529000
*                                                                  0762 02530000
*   /*****************************************************************/ 02531000
*   /*                                                               */ 02532000
*   /* THIS ROUTINE IS CALLED TO PERFORM STOW CHANGE OPERATIONS BOTH */ 02533000
*   /* THE SECONDARY AND PRIMARY FILES ARE USED                      */ 02534000
*   /*                                                               */ 02535000
*   /*****************************************************************/ 02536000
*                                                                  0762 02537000
*EISSTOWC:                                                         0762 02538000
*   PROC;                                                          0762 02539000
EISSTOWC STM   @14,@12,@SA00014                                    0762 02540000
*   DECLARE                                                        0763 02541000
*     STOWNIOP CHAR(LENGTH(HMASMIOP)+/* IOP TO LOCATE MEMBER         */ 02542000
*         LENGTH(IOPDIRMX));        /* IN IOPNNAME                   */ 02543000
*   DECLARE                                                        0764 02544000
*     STOWOIOP CHAR(LENGTH(HMASMIOP)+/* IOP TO LOCATE MEMBER         */ 02545000
*         LENGTH(IOPDIRMX));        /* IN IOPONAME                   */ 02546000
*   DECLARE                         /*                       @Z67SP00*/ 02547000
*     STOWNPTR PTR(31) INIT(ADDR(STOWNIOP));/* ADDRESS OF NEWIOP     */ 02548000
*   DECLARE                         /*                       @Z67SP00*/ 02549000
*     STOWOPTR PTR(31) INIT(ADDR(STOWOIOP));/* ADDRESS OF OLDIOP     */ 02550000
*   DECLARE                                                        0767 02551000
*     STOWCRC FIXED(8);             /* INTERNAL RETURN CODE          */ 02552000
*   DECLARE                         /*                       @Z67SP00*/ 02553000
*     1 * DEF(IOPDRMAP),            /*                       @Z67SP00*/ 02554000
*       3 * CHAR(8),                /* ENTRY NAME            @Z67SP00*/ 02555000
*       3 DELTYP CHAR(8);           /* DELETED. IF DEL ON SECONDARY     02556000
*                                      DIS                   @Z67SP00*/ 02557000
*   DECLARE                         /*                       @Z67SP00*/ 02558000
*     1 * BIT(8),                   /*                       @Z67SP00*/ 02559000
*       3 DFND BIT(1),              /* NEW FOUND AS DEL      @Z67SP00*/ 02560000
*       3 * BIT(7);                 /*                       @Z67SP00*/ 02561000
*                                                                  0769 02562000
*   /*****************************************************************/ 02563000
*   /*                                                               */ 02564000
*   /* ATTEMPT TO LOCATE MEMBER IN IOPONAME PASSED BY CALLER         */ 02565000
*   /*                                                               */ 02566000
*   /*****************************************************************/ 02567000
*                                                                  0770 02568000
*   RFY                                                            0770 02569000
*     HMASMIOP BASED(STOWOPTR);     /* IOPONAME OP WHERE IOPONAME    */ 02570000
*   STOWCRC=GTPNTFND;               /* RCD NOT FOUND YET     @Z67SP00*/ 02571000
         LA    STOWCRC,4                                           0771 02572000
*   GTPFUNCT(PGTPINDX)=GTPLOC;      /* LOCATE IOPONAME VIA CALL TO 0772 02573000
*                                      GTA                           */ 02574000
         LA    @11,3                                               0772 02575000
         LA    @08,28                                              0772 02576000
         SLR   @01,@01                                             0772 02577000
         IC    @01,PGTPINDX                                        0772 02578000
         MR    @00,@08                                             0772 02579000
         STC   @11,GTPFUNCT-28(@01)                                0772 02580000
*   GTPBUFAD(PGTPINDX)=ADDR(IOPDRMAP);/* ADDRESS OF OUTPUT BUFFER    */ 02581000
         L     @05,STOWOPTR                                        0773 02582000
         LA    @00,IOPDRMAP(,@05)                                  0773 02583000
         ST    @00,GTPBUFAD-28(@01)                                0773 02584000
*   IOPINAM=IOPPTR->IOPONAME;       /* LOCATE RECORD WITH KEY IN   0774 02585000
*                                      IOPONAME                      */ 02586000
         MVC   IOPINAM(8,@05),IOPONAME(IOPPTR)                     0774 02587000
*   IF CCACHECK=ON                  /* IF IN CHECK MODE LOOK @Z67SP00*/ 02588000
*     THEN                          /* AT SECONDARY DIS      @Z67SP00*/ 02589000
         L     @15,@CA00037                                        0775 02590000
         TM    CCACHECK-HMASMCCA(@15),B'00010000'                  0775 02591000
         BNO   @RF00775                                            0775 02592000
*     DO;                           /*                       @Z67SP00*/ 02593000
*       GTPFUNCT(SGTPINDX)=GTPLOC;  /*                       @Z67SP00*/ 02594000
         LR    @01,@08                                             0777 02595000
         SLR   @08,@08                                             0777 02596000
         IC    @08,SGTPINDX                                        0777 02597000
         MR    @00,@08                                             0777 02598000
         STC   @11,GTPFUNCT-28(@01)                                0777 02599000
*       GTPBUFAD(SGTPINDX)=ADDR(IOPDRMAP);/*                 @Z67SP00*/ 02600000
         LA    @11,IOPDRMAP(,@05)                                  0778 02601000
         ST    @11,GTPBUFAD-28(@01)                                0778 02602000
*       CALL HMASMGTA(HMASMGTP(SGTPINDX));/*                 @Z67SP00*/ 02603000
         LA    @11,HMASMGTP-28(@01)                                0779 02604000
         ST    @11,@AL00001                                        0779 02605000
         L     @15,@CV01268                                        0779 02606000
         LA    @01,@AL00001                                        0779 02607000
         BALR  @14,@15                                             0779 02608000
*       IF GTPRETRN(SGTPINDX)=GTPGOOD/* IF FOUND             @Z67SP00*/ 02609000
*           &DELTYP=TXTDEL          /* AS DELETED THEN       @Z67SP00*/ 02610000
*         THEN                      /*                       @Z67SP00*/ 02611000
         SLR   @11,@11                                             0780 02612000
         IC    @11,SGTPINDX                                        0780 02613000
         MH    @11,@CH00467                                        0780 02614000
         SLR   @08,@08                                             0780 02615000
         IC    @08,GTPRETRN-28(@11)                                0780 02616000
         CH    @08,@CH00252                                        0780 02617000
         BNE   @RF00780                                            0780 02618000
         L     @11,STOWOPTR                                        0780 02619000
         CLC   DELTYP(8,@11),@CC01281                              0780 02620000
         BNE   @RF00780                                            0780 02621000
*         STOWCRC=IOPSTCRR;         /* ERROR                 @Z67SP00*/ 02622000
         LA    STOWCRC,8                                           0781 02623000
*       ELSE                        /*                       @Z67SP00*/ 02624000
*         STOWCRC=MAX(STOWCRC,GTPRETRN(SGTPINDX));/* SAVE RC @Z67SP00*/ 02625000
         B     @RC00780                                            0782 02626000
@RF00780 SLR   @11,@11                                             0782 02627000
         IC    @11,SGTPINDX                                        0782 02628000
         MH    @11,@CH00467                                        0782 02629000
         SLR   @08,@08                                             0782 02630000
         IC    @08,GTPRETRN-28(@11)                                0782 02631000
         CR    STOWCRC,@08                                         0782 02632000
         BNL   *+6                                                      02633000
         LR    STOWCRC,@08                                         0782 02634000
*     END;                          /*                       @Z67SP00*/ 02635000
@RC00780 DS    0H                                                  0784 02636000
*   IF STOWCRC=GTPNTFND             /* IF RCD NOT FOUND IN SECONDARY    02637000
*                                      OR SECONDARY NOT      @Z67SP00*/ 02638000
*     THEN                          /* SEARCHED              @Z67SP00*/ 02639000
@RF00775 CH    STOWCRC,@CH00039                                    0784 02640000
         BNE   @RF00784                                            0784 02641000
*     DO;                           /*                       @Z67SP00*/ 02642000
*       GTPFUNCT(PGTPINDX)=GTPLOC;  /*                       @Z67SP00*/ 02643000
         SLR   @11,@11                                             0786 02644000
         IC    @11,PGTPINDX                                        0786 02645000
         MH    @11,@CH00467                                        0786 02646000
         LA    @08,3                                               0786 02647000
         STC   @08,GTPFUNCT-28(@11)                                0786 02648000
*       CALL HMASMGTA(HMASMGTP(PGTPINDX));/* VIA CALL TO HMASMGTA    */ 02649000
         LA    @11,HMASMGTP-28(@11)                                0787 02650000
         ST    @11,@AL00001                                        0787 02651000
         L     @15,@CV01268                                        0787 02652000
         LA    @01,@AL00001                                        0787 02653000
         BALR  @14,@15                                             0787 02654000
*       IF GTPRETRN(PGTPINDX)=GTPGOOD/* IF FOUND THEN        @Z67SP00*/ 02655000
*         THEN                      /* CHANGE RC TO INDICATE @Z67SP00*/ 02656000
         SLR   @11,@11                                             0788 02657000
         IC    @11,PGTPINDX                                        0788 02658000
         MH    @11,@CH00467                                        0788 02659000
         SLR   @08,@08                                             0788 02660000
         IC    @08,GTPRETRN-28(@11)                                0788 02661000
         CH    @08,@CH00252                                        0788 02662000
         BNE   @RF00788                                            0788 02663000
*         STOWCRC=GTPGOOD;          /* ENTRY FOUND           @Z67SP00*/ 02664000
         SLR   STOWCRC,STOWCRC                                     0789 02665000
*       ELSE                        /*                       @Z67SP00*/ 02666000
*         STOWCRC=IOPSTCRR;         /* STOW CHANGE ERR       @Z67SP00*/ 02667000
         B     @RC00788                                            0790 02668000
@RF00788 LA    STOWCRC,8                                           0790 02669000
*     END;                          /*                       @Z67SP00*/ 02670000
*                                                                  0791 02671000
@RC00788 DS    0H                                                  0792 02672000
*   /*****************************************************************/ 02673000
*   /*                                                               */ 02674000
*   /* IF OLD ENTRY FOUND IN PROPER DATASET THEN SEE IF NEW NAME     */ 02675000
*   /* ALREADY THERE                                         @Z67SP00*/ 02676000
*   /*                                                               */ 02677000
*   /*****************************************************************/ 02678000
*                                                                  0792 02679000
*   IF STOWCRC=GTPGOOD              /* IF MEMBER FOUND       @Z67SP00*/ 02680000
*     THEN                          /* THEN CONTINUE         @Z67SP00*/ 02681000
@RF00784 CH    STOWCRC,@CH00252                                    0792 02682000
         BNE   @RF00792                                            0792 02683000
*     DO;                           /*                       @Z67SP00*/ 02684000
*       RFY                                                        0794 02685000
*         HMASMIOP BASED(STOWNPTR); /* IOP TO RETRIEVE IOPNNAME KEY  */ 02686000
*       IOPINAM=IOPPTR->IOPNNAME;   /* LOCATE RECORD WITH KEY IN   0795 02687000
*                                      IOPNNAME                      */ 02688000
         L     @11,STOWNPTR                                        0795 02689000
         MVC   IOPINAM(8,@11),IOPNNAME(IOPPTR)                     0795 02690000
*       STOWCRC=GTPNTFND;           /* NEW NAME NOT FOUND    @Z67SP00*/ 02691000
         LA    STOWCRC,4                                           0796 02692000
*       DFND=OFF;                   /* NOT FOUND AS DELETED  @Z67SP00*/ 02693000
         NI    DFND,B'01111111'                                    0797 02694000
*       IF CCACHECK=ON              /* IF IN CHECK MODE      @Z67SP00*/ 02695000
*         THEN                      /* THEN SEARCH SECONDARY @Z67SP00*/ 02696000
         L     @08,@CA00037                                        0798 02697000
         TM    CCACHECK-HMASMCCA(@08),B'00010000'                  0798 02698000
         BNO   @RF00798                                            0798 02699000
*         DO;                       /* DIS                   @Z67SP00*/ 02700000
*           GTPBUFAD(SGTPINDX)=ADDR(IOPDRMAP);/*             @Z67SP00*/ 02701000
         SLR   @08,@08                                             0800 02702000
         IC    @08,SGTPINDX                                        0800 02703000
         MH    @08,@CH00467                                        0800 02704000
         LA    @11,IOPDRMAP(,@11)                                  0800 02705000
         ST    @11,GTPBUFAD-28(@08)                                0800 02706000
*           CALL HMASMGTA(HMASMGTP(SGTPINDX));/* LOC NEW     @Z67SP00*/ 02707000
         LA    @11,HMASMGTP-28(@08)                                0801 02708000
         ST    @11,@AL00001                                        0801 02709000
         L     @15,@CV01268                                        0801 02710000
         LA    @01,@AL00001                                        0801 02711000
         BALR  @14,@15                                             0801 02712000
*           IF GTPRETRN(SGTPINDX)=GTPGOOD/* IF FOUND THEN    @Z67SP00*/ 02713000
*             THEN                  /* CHECK FOR DELETED     @Z67SP00*/ 02714000
         SLR   @11,@11                                             0802 02715000
         IC    @11,SGTPINDX                                        0802 02716000
         MH    @11,@CH00467                                        0802 02717000
         SLR   @08,@08                                             0802 02718000
         IC    @08,GTPRETRN-28(@11)                                0802 02719000
         CH    @08,@CH00252                                        0802 02720000
         BNE   @RF00802                                            0802 02721000
*             DO;                   /*                       @Z67SP00*/ 02722000
*               IF DELTYP^=TXTDEL   /* IF NOT DELETED        @Z67SP00*/ 02723000
*                 THEN              /*                       @Z67SP00*/ 02724000
         L     @11,STOWNPTR                                        0804 02725000
         CLC   DELTYP(8,@11),@CC01281                              0804 02726000
         BE    @RF00804                                            0804 02727000
*                 STOWCRC=IOPSTCRR; /* SET BAD RC            @Z67SP00*/ 02728000
         LA    STOWCRC,8                                           0805 02729000
*               ELSE                /* FOUND AS DELETED      @Z67SP00*/ 02730000
*                 DFND=ON;          /* IN SECONDARY          @Z67SP00*/ 02731000
         B     @RC00804                                            0806 02732000
@RF00804 OI    DFND,B'10000000'                                    0806 02733000
*             END;                  /*                       @Z67SP00*/ 02734000
@RC00804 DS    0H                                                  0808 02735000
*         END;                      /*                       @Z67SP00*/ 02736000
@RF00802 DS    0H                                                  0809 02737000
*       IF STOWCRC^=IOPSTCRR        /* IF NOT ERR YET        @Z67SP00*/ 02738000
*           &DFND=OFF               /* OR FOUND AS DELETED TYPE IN 0809 02739000
*                                      SECONDARY             @Z67SP00*/ 02740000
*         THEN                      /* THEN CHECK IN         @Z67SP00*/ 02741000
@RF00798 CH    STOWCRC,@CH00112                                    0809 02742000
         BE    @RF00809                                            0809 02743000
         TM    DFND,B'10000000'                                    0809 02744000
         BNZ   @RF00809                                            0809 02745000
*         DO;                       /* PRIMRARY              @Z67SP00*/ 02746000
*           GTPBUFAD(PGTPINDX)=ADDR(IOPDRMAP);/*             @Z67SP00*/ 02747000
         SLR   @11,@11                                             0811 02748000
         IC    @11,PGTPINDX                                        0811 02749000
         MH    @11,@CH00467                                        0811 02750000
         L     @08,STOWNPTR                                        0811 02751000
         LA    @08,IOPDRMAP(,@08)                                  0811 02752000
         ST    @08,GTPBUFAD-28(@11)                                0811 02753000
*           CALL HMASMGTA(HMASMGTP(PGTPINDX));/* LOC IN PRIM @Z67SP00*/ 02754000
         LA    @11,HMASMGTP-28(@11)                                0812 02755000
         ST    @11,@AL00001                                        0812 02756000
         L     @15,@CV01268                                        0812 02757000
         LA    @01,@AL00001                                        0812 02758000
         BALR  @14,@15                                             0812 02759000
*           IF GTPRETRN(PGTPINDX)=GTPGOOD/* IF FOUND         @Z67SP00*/ 02760000
*             THEN                  /*                       @Z67SP00*/ 02761000
         SLR   @11,@11                                             0813 02762000
         IC    @11,PGTPINDX                                        0813 02763000
         MH    @11,@CH00467                                        0813 02764000
         SLR   @08,@08                                             0813 02765000
         IC    @08,GTPRETRN-28(@11)                                0813 02766000
         CH    @08,@CH00252                                        0813 02767000
         BNE   @RF00813                                            0813 02768000
*             STOWCRC=IOPSTCRR;     /* ERROR                 @Z67SP00*/ 02769000
         LA    STOWCRC,8                                           0814 02770000
*         END;                      /*                       @Z67SP00*/ 02771000
@RF00813 DS    0H                                                  0816 02772000
*       IF STOWCRC=GTPNTFND         /* IF NEW NOT FOUND      @Z67SP00*/ 02773000
*         THEN                      /*                       @Z67SP00*/ 02774000
@RF00809 CH    STOWCRC,@CH00039                                    0816 02775000
         BNE   @RF00816                                            0816 02776000
*         DO;                       /*                       @Z67SP00*/ 02777000
*                                                                  0817 02778000
*           /*********************************************************/ 02779000
*           /*                                                       */ 02780000
*           /* DELETE MEMBER FROM EITHER PRIMARY OR ADD DELETED TYPE */ 02781000
*           /* MEMBER TO SECONDARY                           @Z67SP00*/ 02782000
*           /*                                                       */ 02783000
*           /*********************************************************/ 02784000
*                                                                  0818 02785000
*           RFY                                                    0818 02786000
*             HMASMIOP BASED(STOWOPTR);/* ADDRESS IOP WITH OLD KEY   */ 02787000
*           IF CCACHECK=OFF         /* IF NOT IN CHECK       @Z67SP00*/ 02788000
*             THEN                  /*                       @Z67SP00*/ 02789000
         L     @11,@CA00037                                        0819 02790000
         TM    CCACHECK-HMASMCCA(@11),B'00010000'                  0819 02791000
         BNZ   @RF00819                                            0819 02792000
*             DO;                   /*                       @Z67SP00*/ 02793000
*               GTPFUNCT(PGTPINDX)=GTPDEL;/* DELETE CURRENT RECORD 0821 02794000
*                                      WITH OLD KEY FROM DIS         */ 02795000
         SLR   @11,@11                                             0821 02796000
         IC    @11,PGTPINDX                                        0821 02797000
         MH    @11,@CH00467                                        0821 02798000
         LA    @08,5                                               0821 02799000
         STC   @08,GTPFUNCT-28(@11)                                0821 02800000
*               GTPBUFAD(PGTPINDX)=ADDR(IOPDRMAP);/* POINT TO RECORD    02801000
*                                      TO BE ADDED                   */ 02802000
         L     @08,STOWOPTR                                        0822 02803000
         LA    @08,IOPDRMAP(,@08)                                  0822 02804000
         ST    @08,GTPBUFAD-28(@11)                                0822 02805000
*               CALL HMASMGTA(HMASMGTP(PGTPINDX));/* VIA CALL TO GTA */ 02806000
         LA    @11,HMASMGTP-28(@11)                                0823 02807000
         ST    @11,@AL00001                                        0823 02808000
         L     @15,@CV01268                                        0823 02809000
         LA    @01,@AL00001                                        0823 02810000
         BALR  @14,@15                                             0823 02811000
*               STOWCRC=GTPRETRN(PGTPINDX);/* SAVE RETURN CD @Z67SP00*/ 02812000
         SLR   @11,@11                                             0824 02813000
         IC    @11,PGTPINDX                                        0824 02814000
         MH    @11,@CH00467                                        0824 02815000
         SLR   STOWCRC,STOWCRC                                     0824 02816000
         IC    STOWCRC,GTPRETRN-28(@11)                            0824 02817000
*             END;                  /*                       @Z67SP00*/ 02818000
*           ELSE                    /*                       @Z67SP00*/ 02819000
*             DO;                   /*                       @Z67SP00*/ 02820000
         B     @RC00819                                            0826 02821000
@RF00819 DS    0H                                                  0827 02822000
*               GTPFUNCT(SGTPINDX)=GTPADD;/* ADD DELETED     @Z67SP00*/ 02823000
         SLR   @11,@11                                             0827 02824000
         IC    @11,SGTPINDX                                        0827 02825000
         MH    @11,@CH00467                                        0827 02826000
         LA    @08,4                                               0827 02827000
         STC   @08,GTPFUNCT-28(@11)                                0827 02828000
*               DELTYP=TXTDEL;      /* RCD TO SECONDARY      @Z67SP00*/ 02829000
         L     @08,STOWOPTR                                        0828 02830000
         MVC   DELTYP(8,@08),@CC01281                              0828 02831000
*               GTPBUFAD(SGTPINDX)=ADDR(IOPDRMAP);/* POINT TO RECORD    02832000
*                                      TO BE ADDED                   */ 02833000
         LA    @08,IOPDRMAP(,@08)                                  0829 02834000
         ST    @08,GTPBUFAD-28(@11)                                0829 02835000
*               CALL HMASMGTA(HMASMGTP(SGTPINDX));/* VIA CALL TO GTA */ 02836000
         LA    @11,HMASMGTP-28(@11)                                0830 02837000
         ST    @11,@AL00001                                        0830 02838000
         L     @15,@CV01268                                        0830 02839000
         LA    @01,@AL00001                                        0830 02840000
         BALR  @14,@15                                             0830 02841000
*               STOWCRC=GTPRETRN(SGTPINDX);/* SAVE RETURN CD @Z67SP00*/ 02842000
         SLR   @11,@11                                             0831 02843000
         IC    @11,SGTPINDX                                        0831 02844000
         MH    @11,@CH00467                                        0831 02845000
         SLR   STOWCRC,STOWCRC                                     0831 02846000
         IC    STOWCRC,GTPRETRN-28(@11)                            0831 02847000
*             END;                  /*                       @Z67SP00*/ 02848000
*                                                                  0832 02849000
*           /*********************************************************/ 02850000
*           /*                                                       */ 02851000
*           /* ADD NEW NAME TO EITHER PRIME OR SECOND DIS    @Z67SP00*/ 02852000
*           /*                                                       */ 02853000
*           /*********************************************************/ 02854000
*                                                                  0833 02855000
*           IF STOWCRC=GTPGOOD      /* IF STOW ADD/DEL OK    @Z67SP00*/ 02856000
*             THEN                  /*                       @Z67SP00*/ 02857000
@RC00819 CH    STOWCRC,@CH00252                                    0833 02858000
         BNE   @RF00833                                            0833 02859000
*             DO;                   /*                       @Z67SP00*/ 02860000
*               IOPINAM=IOPPTR->IOPNNAME;/* REPLACE WITH NEW KEY     */ 02861000
         L     @11,STOWOPTR                                        0835 02862000
         MVC   IOPINAM(8,@11),IOPNNAME(IOPPTR)                     0835 02863000
*               IF CCACHECK=OFF     /* IF NOT IN CHECK       @Z67SP00*/ 02864000
*                 THEN              /*                       @Z67SP00*/ 02865000
         L     @11,@CA00037                                        0836 02866000
         TM    CCACHECK-HMASMCCA(@11),B'00010000'                  0836 02867000
         BNZ   @RF00836                                            0836 02868000
*                 DO;               /*                       @Z67SP00*/ 02869000
*                   GTPFUNCT(PGTPINDX)=GTPADD;/* AND ADD TO IN     0838 02870000
*                                      STORAGE FILE          @Z67SP00*/ 02871000
         SLR   @11,@11                                             0838 02872000
         IC    @11,PGTPINDX                                        0838 02873000
         MH    @11,@CH00467                                        0838 02874000
         LA    @08,4                                               0838 02875000
         STC   @08,GTPFUNCT-28(@11)                                0838 02876000
*                   CALL HMASMGTA(HMASMGTP(PGTPINDX));/* VIA CALL TO    02877000
*                                      HMASMGTA              @Z67SP00*/ 02878000
         LA    @11,HMASMGTP-28(@11)                                0839 02879000
         ST    @11,@AL00001                                        0839 02880000
         L     @15,@CV01268                                        0839 02881000
         LA    @01,@AL00001                                        0839 02882000
         BALR  @14,@15                                             0839 02883000
*                   STOWCRC=GTPRETRN(PGTPINDX);/* SAVE RETURN CODE 0840 02884000
*                                      FROM STOW ADD         @Z67SP00*/ 02885000
         SLR   @11,@11                                             0840 02886000
         IC    @11,PGTPINDX                                        0840 02887000
         MH    @11,@CH00467                                        0840 02888000
         SLR   STOWCRC,STOWCRC                                     0840 02889000
         IC    STOWCRC,GTPRETRN-28(@11)                            0840 02890000
*                 END;              /*                       @Z67SP00*/ 02891000
*               ELSE                /* IF CHECK              @Z67SP00*/ 02892000
*                 DO;               /*                       @Z67SP00*/ 02893000
         B     @RC00836                                            0842 02894000
@RF00836 DS    0H                                                  0843 02895000
*                   GTPFUNCT(SGTPINDX)=GTPADD;/* AND ADD TO IN     0843 02896000
*                                      STORAGE FILE          @Z67SP00*/ 02897000
         SLR   @11,@11                                             0843 02898000
         IC    @11,SGTPINDX                                        0843 02899000
         MH    @11,@CH00467                                        0843 02900000
         LA    @08,4                                               0843 02901000
         STC   @08,GTPFUNCT-28(@11)                                0843 02902000
*                   CALL HMASMGTA(HMASMGTP(SGTPINDX));/* VIA CALL TO    02903000
*                                      HMASMGTA              @Z67SP00*/ 02904000
         LA    @11,HMASMGTP-28(@11)                                0844 02905000
         ST    @11,@AL00001                                        0844 02906000
         L     @15,@CV01268                                        0844 02907000
         LA    @01,@AL00001                                        0844 02908000
         BALR  @14,@15                                             0844 02909000
*                   STOWCRC=GTPRETRN(SGTPINDX);/* SAVE RETURN CODE 0845 02910000
*                                      FROM STOW ADD         @Z67SP00*/ 02911000
         SLR   @11,@11                                             0845 02912000
         IC    @11,SGTPINDX                                        0845 02913000
         MH    @11,@CH00467                                        0845 02914000
         SLR   STOWCRC,STOWCRC                                     0845 02915000
         IC    STOWCRC,GTPRETRN-28(@11)                            0845 02916000
*                 END;              /*                       @Z67SP00*/ 02917000
*             END;                  /*                       @Z67SP00*/ 02918000
@RC00836 DS    0H                                                  0848 02919000
*           IF STOWCRC^=GTPGOOD     /* IF NO SPACE THEN DO           */ 02920000
*             THEN                                                 0848 02921000
@RF00833 CH    STOWCRC,@CH00252                                    0848 02922000
         BE    @RF00848                                            0848 02923000
*             DO;                   /*                       @Z67SP00*/ 02924000
*               CALL EISSPMSG;      /* ISSUE OUT OF SPCE MSG @Z67SP00*/ 02925000
         BAL   @14,EISSPMSG                                        0850 02926000
*               RFY                                                0851 02927000
*                 RTNCODE RSTD;     /*                               */ 02928000
*               STOWCRC=RTNCODE;    /*                               */ 02929000
         LR    STOWCRC,RTNCODE                                     0852 02930000
*               RFY                                                0853 02931000
*                 RTNCODE UNRSTD;   /*                               */ 02932000
*             END;                                                 0854 02933000
*         END;                                                     0855 02934000
@RF00848 DS    0H                                                  0856 02935000
*     END;                                                         0856 02936000
@RF00816 DS    0H                                                  0857 02937000
*   IF STOWCRC=ZERO                 /* IF STOWC DONE         @Z67SP00*/ 02938000
*     THEN                          /*                       @Z67SP00*/ 02939000
@RF00792 CH    STOWCRC,@CH00252                                    0857 02940000
         BNE   @RF00857                                            0857 02941000
*     CCAFLAG6=CCAFLAG6|DSMSKON(PDSINDX);/* TURN ON DIS UPDATED    0858 02942000
*                                      INDICATOR             @Z67SP00*/ 02943000
         L     @11,@CA00037                                        0858 02944000
         LR    @08,PDSINDX                                         0858 02945000
         MH    @08,@CH01521                                        0858 02946000
         LA    @05,DSMSKON-103(@08)                                0858 02947000
         OC    CCAFLAG6-HMASMCCA(1,@11),0(@05)                     0858 02948000
*   RETURN CODE(STOWCRC);                                          0859 02949000
@RF00857 LR    @15,STOWCRC                                         0859 02950000
         L     @14,@SA00014                                        0859 02951000
         LM    @00,@12,@SA00014+8                                  0859 02952000
         BR    @14                                                 0859 02953000
*   END EISSTOWC;                                                  0860 02954000
         EJECT                                                          02955000
*                                                                  0861 02956000
*   /*****************************************************************/ 02957000
*   /*                                                               */ 02958000
*   /* ROUTINE CALLED WHEN ADD TO DIS FILE RESULTS IN OUT OF SPACE   */ 02959000
*   /* CONDITION                                                     */ 02960000
*   /*                                                               */ 02961000
*   /*****************************************************************/ 02962000
*                                                                  0861 02963000
*EISSPMSG:                          /*                               */ 02964000
*   PROCEDURE;                      /*                               */ 02965000
EISSPMSG STM   @14,@12,@SA00015                                    0861 02966000
*   DECLARE                         /*                               */ 02967000
*     MSGRC FIXED(8);               /*                               */ 02968000
*   RFY                                                            0863 02969000
*     HMASMIOP BASED(IOPPTR);       /*                       @Z67SP00*/ 02970000
*   HMASMMGP=''B;                   /* CLEAR MESSAGE PARMS   @Z67SP00*/ 02971000
         XC    HMASMMGP(24),HMASMMGP                               0864 02972000
*   MGPPRINT=ON;                    /* MESSAGES TO SYSOUT    @Z67SP00*/ 02973000
*   MGPHLDS=ON;                     /* MESSAGES TO LOG       @Z67SP00*/ 02974000
*                                                                  0866 02975000
         OI    MGPPRINT,B'10010000'                                0866 02976000
*   /*****************************************************************/ 02977000
*   /*                                                               */ 02978000
*   /* IF DATASET IN STORAGE FOR OUTPUT OR IF IN CHECK MODE THEN     */ 02979000
*   /* CANNOT CONTINUE, ELSE JUST WARNING MSG                @Z67SP00*/ 02980000
*   /*                                                               */ 02981000
*   /*****************************************************************/ 02982000
*                                                                  0867 02983000
*   IF CCACHECK=ON                  /* IN CHECK MODE         @Z67SP00*/ 02984000
*       |IOPDSID=IOPCDS&CCACDSOS=ON /*                       @Z67SP00*/ 02985000
*       |IOPDSID=IOPACDS&CCAACDOS=ON/*                       @Z67SP00*/ 02986000
*       |IOPDSID=IOPCRQ&CCACRQOS=ON /*                       @Z67SP00*/ 02987000
*       |IOPDSID=IOPACRQ&CCAACROS=ON/*                       @Z67SP00*/ 02988000
*     THEN                          /*                       @Z67SP00*/ 02989000
         L     @11,@CA00037                                        0867 02990000
         TM    CCACHECK-HMASMCCA(@11),B'00010000'                  0867 02991000
         BO    @RT00867                                            0867 02992000
         CLI   IOPDSID(IOPPTR),2                                   0867 02993000
         BNE   @GL00026                                            0867 02994000
         TM    CCACDSOS-HMASMCCA(@11),B'10000000'                  0867 02995000
         BO    @RT00867                                            0867 02996000
@GL00026 CLI   IOPDSID(IOPPTR),12                                  0867 02997000
         BNE   @GL00025                                            0867 02998000
         L     @11,@CA00037                                        0867 02999000
         TM    CCAACDOS-HMASMCCA(@11),B'01000000'                  0867 03000000
         BO    @RT00867                                            0867 03001000
@GL00025 CLI   IOPDSID(IOPPTR),28                                  0867 03002000
         BNE   @GL00024                                            0867 03003000
         L     @11,@CA00037                                        0867 03004000
         TM    CCACRQOS-HMASMCCA(@11),B'00100000'                  0867 03005000
         BO    @RT00867                                            0867 03006000
@GL00024 CLI   IOPDSID(IOPPTR),30                                  0867 03007000
         BNE   @RF00867                                            0867 03008000
         L     @11,@CA00037                                        0867 03009000
         TM    CCAACROS-HMASMCCA(@11),B'00010000'                  0867 03010000
         BNO   @RF00867                                            0867 03011000
@RT00867 DS    0H                                                  0868 03012000
*     DO;                           /*                               */ 03013000
*       MGPTYPE=MGPSEV;             /* SEVER ERROR                   */ 03014000
         MVI   MGPTYPE,X'04'                                       0869 03015000
*       MSGRC=STOPFUNC;             /* STOP FUNCTION         @Z67SP00*/ 03016000
         LA    MSGRC,12                                            0870 03017000
*     END;                          /*                       @Z67SP00*/ 03018000
*   ELSE                            /*                       @Z67SP00*/ 03019000
*     DO;                           /*                       @Z67SP00*/ 03020000
         B     @RC00867                                            0872 03021000
@RF00867 DS    0H                                                  0873 03022000
*       MGPTYPE=MGPINFO;            /*                       @Z67SP00*/ 03023000
         MVI   MGPTYPE,X'01'                                       0873 03024000
*       MSGRC=ZERO;                 /*                       @Z67SP00*/ 03025000
         SLR   MSGRC,MSGRC                                         0874 03026000
*     END;                          /*                       @Z67SP00*/ 03027000
*   MGPCLEAR=''B;                   /*                       @Z67SP00*/ 03028000
@RC00867 XC    MGPCLEAR(6),MGPCLEAR                                0876 03029000
*   MGPMGNO1=HMA305I;               /* INSUFFICIENT STORAGE FOR    0877 03030000
*                                      XXXXXXXX IN STORAGE STOW/BLDL    03031000
*                                      OPERATIONS            @Z67SP00*/ 03032000
         MVC   MGPMGNO1(2),@CH01285                                0877 03033000
*   MGPVARPT(1)=ADDR(DSDDNAME(SDSINDX));/* INSERT DD                 */ 03034000
         SLR   @11,@11                                             0878 03035000
         IC    @11,SDSINDX                                         0878 03036000
         MH    @11,@CH01521                                        0878 03037000
         LA    @11,DSDDNAME-103(@11)                               0878 03038000
         ST    @11,MGPVARPT                                        0878 03039000
*   CALL HMASMMSG(HMASMMGP);        /*                               */ 03040000
         L     @15,@CV01270                                        0879 03041000
         LA    @01,@AL00879                                        0879 03042000
         BALR  @14,@15                                             0879 03043000
*   IF MSGRC=ZERO                   /* IF ONLY INFO MSG      @Z67SP00*/ 03044000
*     THEN                          /* THEN CAN NOW FREE     @Z67SP00*/ 03045000
         CH    MSGRC,@CH00252                                      0880 03046000
         BNE   @RF00880                                            0880 03047000
*     DO;                           /* DIR. IF STOPFUNC THEN @Z67SP00*/ 03048000
*       CALL EISFREE;               /* CANT FREE DIR UNTIL   @Z67SP00*/ 03049000
         BAL   @14,EISFREE                                         0882 03050000
*       RFY                         /* DIRECTORY             @Z67SP00*/ 03051000
*         RTNCODE RSTD;             /*                       @Z67SP00*/ 03052000
*       MSGRC=MAX(MSGRC,RTNCODE);   /* AFTER CALL FOR WRITE  @Z67SP00*/ 03053000
         CR    MSGRC,RTNCODE                                       0884 03054000
         BNL   *+6                                                      03055000
         LR    MSGRC,RTNCODE                                       0884 03056000
*       RFY                         /* DIRECTORY             @Z67SP00*/ 03057000
*         RTNCODE UNRSTD;           /*                       @Z67SP00*/ 03058000
*     END;                          /*                       @Z67SP00*/ 03059000
*   RETURN CODE(MSGRC);             /*                               */ 03060000
@RF00880 LR    @15,MSGRC                                           0887 03061000
         L     @14,@SA00015                                        0887 03062000
         LM    @00,@12,@SA00015+8                                  0887 03063000
         BR    @14                                                 0887 03064000
*   END EISSPMSG;                   /*                               */ 03065000
*   END HMASMEIS                                                   0889 03066000
*                                                                  0889 03067000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 03068000
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */ 03069000
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */ 03070000
*/*%INCLUDE SYSLIB  (HMASMMGP)                                       */ 03071000
*/*%INCLUDE SYSLIB  (HMASMGTP)                                       */ 03072000
*                                                                  0889 03073000
*       ;                                                          0889 03074000
@DATA    DS    0H                                                       03075000
@CH00252 DC    H'0'                                                     03076000
@CH00087 DC    H'1'                                                     03077000
@CH00039 DC    H'4'                                                     03078000
@CH00112 DC    H'8'                                                     03079000
@CH00436 DC    H'11'                                                    03080000
@CH00033 DC    H'12'                                                    03081000
@CH00188 DC    H'16'                                                    03082000
@CH00467 DC    H'28'                                                    03083000
@CH00042 DC    H'31'                                                    03084000
@CH01031 DC    H'68'                                                    03085000
@CH00518 DC    H'83'                                                    03086000
@CH01521 DC    H'103'                                                   03087000
@CH01285 DC    H'106'                                                   03088000
@SM01524 MVC   0(0,@05),@TS00001                                        03089000
@SM01526 MVC   IOPDRMAP(0,IOPPTR),0(@05)                                03090000
@SM01531 MVC   0(0,@08),@TS00001                                        03091000
@SM01533 MVC   OUTMEM(0,FILLPTR),NTRYMAP(@15)                           03092000
@SM01535 MVC   OUTMEM(0,FILLPTR),EOFRCD                                 03093000
         DS    0F                                                       03094000
@AL00551 EQU   *                       LIST WITH   1 ARGUMENT(S)        03095000
@AL00616 EQU   *                       LIST WITH   1 ARGUMENT(S)        03096000
@AL00879 DC    A(HMASMMGP)             LIST WITH   1 ARGUMENT(S)        03097000
         DS    0F                                                       03098000
@SA00001 DS    18F                                                      03099000
@PC00001 DS    1F                                                       03100000
@SA00003 DS    15F                                                      03101000
@SA00008 DS    15F                                                      03102000
@SA00009 DS    15F                                                      03103000
@SA00014 DS    15F                                                      03104000
@SA00010 DS    15F                                                      03105000
@SA00015 DS    15F                                                      03106000
@SA00011 DS    14F                                                      03107000
@SA00012 DS    15F                                                      03108000
@SA00013 DS    0F                                                       03109000
@SA00007 DS    0F                                                       03110000
@SA00006 DS    0F                                                       03111000
@SA00005 DS    0F                                                       03112000
@SA00004 DS    0F                                                       03113000
         DS    15F                                                      03114000
@AL00001 DS    1A                                                       03115000
         DS    0F                                                       03116000
@CF01530 DC    F'-8'                                                    03117000
@CA00037 DC    A(HMASMCCA)                                              03118000
@CV01268 DC    V(HMASMGTA)                                              03119000
@CV01269 DC    V(HMASMIO)                                               03120000
@CV01270 DC    V(HMASMMSG)                                              03121000
         DS    0D                                                       03122000
WRDIRPTR DC    AL4(WRDIRIOP)                                            03123000
BLKPTR   DC    AL4(BLKIOP)                                              03124000
STOWNPTR DC    AL4(STOWNIOP)                                            03125000
STOWOPTR DC    AL4(STOWOIOP)                                            03126000
FNCINDX  DS    FL1                                                      03127000
PGTPINDX DS    FL1                                                      03128000
SGTPINDX DS    FL1                                                      03129000
SDSINDX  DS    FL1                                                      03130000
         DS    0D                                                       03131000
@TS00001 DS    CL12                                                     03132000
@CC01281 DC    C'DELETED.'                                              03133000
HMASMMGP DS    CL24                                                     03134000
         ORG   HMASMMGP                                                 03135000
MGPFIXED DS    CL12                                                     03136000
         ORG   MGPFIXED                                                 03137000
MGPCLEAR DS    CL6                                                      03138000
         ORG   MGPCLEAR                                                 03139000
MGPMGNO1 DS    FL2                                                      03140000
MGPMGNO2 DS    FL2                                                      03141000
MGPMGNO3 DS    FL2                                                      03142000
         ORG   MGPFIXED+6                                               03143000
MGPFLAGS DS    BL2                                                      03144000
         ORG   MGPFLAGS                                                 03145000
MGPPRINT DS    BL1                                                      03146000
MGPLIST  EQU   MGPFLAGS+0                                               03147000
MGPRPT   EQU   MGPFLAGS+0                                               03148000
MGPHLDS  EQU   MGPFLAGS+0                                               03149000
MGPWTOR  EQU   MGPFLAGS+0                                               03150000
MGPWTO   EQU   MGPFLAGS+0                                               03151000
MGPWTP   EQU   MGPFLAGS+0                                               03152000
@NM00171 EQU   MGPFLAGS+0                                               03153000
         ORG   MGPFIXED+8                                               03154000
MGPTYPE  DS    FL1                                                      03155000
@NM00172 DS    CL3                                                      03156000
         ORG   HMASMMGP+12                                              03157000
MGPVAR   DS    CL12                                                     03158000
         ORG   MGPVAR                                                   03159000
MGPVARPT DS    3A                                                       03160000
         ORG   HMASMMGP+24                                              03161000
TYPGTPTB DS    CL136                                                    03162000
         ORG   TYPGTPTB                                                 03163000
ASM      DC    AL1(1)                                                   03164000
         DC    AL1(8)                                                   03165000
         DC    AL1(0)                                                   03166000
         DC    AL1(0)                                                   03167000
         DC    AL1(17)                                                  03168000
         DC    AL1(18)                                                  03169000
         DC    AL1(0)                                                   03170000
         DC    AL1(0)                                                   03171000
LMD      DC    AL1(2)                                                   03172000
         DC    AL1(9)                                                   03173000
         DC    AL1(0)                                                   03174000
         DC    AL1(0)                                                   03175000
         DC    AL1(17)                                                  03176000
         DC    AL1(18)                                                  03177000
         DC    AL1(0)                                                   03178000
         DC    AL1(0)                                                   03179000
MAC      DC    AL1(3)                                                   03180000
         DC    AL1(10)                                                  03181000
         DC    AL1(0)                                                   03182000
         DC    AL1(0)                                                   03183000
         DC    AL1(17)                                                  03184000
         DC    AL1(18)                                                  03185000
         DC    AL1(0)                                                   03186000
         DC    AL1(0)                                                   03187000
MCU      DC    AL1(0)                                                   03188000
         DC    AL1(0)                                                   03189000
         DC    AL1(0)                                                   03190000
         DC    AL1(0)                                                   03191000
         DC    AL1(0)                                                   03192000
         DC    AL1(0)                                                   03193000
         DC    AL1(0)                                                   03194000
         DC    AL1(0)                                                   03195000
MOD      DC    AL1(4)                                                   03196000
         DC    AL1(11)                                                  03197000
         DC    AL1(0)                                                   03198000
         DC    AL1(0)                                                   03199000
         DC    AL1(17)                                                  03200000
         DC    AL1(18)                                                  03201000
         DC    AL1(0)                                                   03202000
         DC    AL1(0)                                                   03203000
DLB      DC    AL1(6)                                                   03204000
         DC    AL1(12)                                                  03205000
         DC    AL1(0)                                                   03206000
         DC    AL1(0)                                                   03207000
         DC    AL1(17)                                                  03208000
         DC    AL1(18)                                                  03209000
         DC    AL1(0)                                                   03210000
         DC    AL1(0)                                                   03211000
SYS      DC    AL1(1)                                                   03212000
         DC    AL1(8)                                                   03213000
         DC    AL1(0)                                                   03214000
         DC    AL1(0)                                                   03215000
         DC    AL1(17)                                                  03216000
         DC    AL1(18)                                                  03217000
         DC    AL1(0)                                                   03218000
         DC    AL1(0)                                                   03219000
SRC      DC    AL1(5)                                                   03220000
         DC    AL1(12)                                                  03221000
         DC    AL1(0)                                                   03222000
         DC    AL1(0)                                                   03223000
         DC    AL1(17)                                                  03224000
         DC    AL1(18)                                                  03225000
         DC    AL1(0)                                                   03226000
         DC    AL1(0)                                                   03227000
SCU      DC    AL1(0)                                                   03228000
         DC    AL1(0)                                                   03229000
         DC    AL1(0)                                                   03230000
         DC    AL1(0)                                                   03231000
         DC    AL1(0)                                                   03232000
         DC    AL1(0)                                                   03233000
         DC    AL1(0)                                                   03234000
         DC    AL1(0)                                                   03235000
DND      DC    AL1(7)                                                   03236000
         DC    AL1(14)                                                  03237000
         DC    AL1(15)                                                  03238000
         DC    AL1(16)                                                  03239000
         DC    AL1(17)                                                  03240000
         DC    AL1(18)                                                  03241000
         DC    AL1(19)                                                  03242000
         DC    AL1(20)                                                  03243000
SMD      DC    AL1(7)                                                   03244000
         DC    AL1(14)                                                  03245000
         DC    AL1(0)                                                   03246000
         DC    AL1(0)                                                   03247000
         DC    AL1(17)                                                  03248000
         DC    AL1(18)                                                  03249000
         DC    AL1(0)                                                   03250000
         DC    AL1(0)                                                   03251000
ZAP      DC    AL1(0)                                                   03252000
         DC    AL1(0)                                                   03253000
         DC    AL1(0)                                                   03254000
         DC    AL1(0)                                                   03255000
         DC    AL1(0)                                                   03256000
         DC    AL1(0)                                                   03257000
         DC    AL1(0)                                                   03258000
         DC    AL1(0)                                                   03259000
XZP      DC    AL1(0)                                                   03260000
         DC    AL1(0)                                                   03261000
         DC    AL1(0)                                                   03262000
         DC    AL1(0)                                                   03263000
         DC    AL1(0)                                                   03264000
         DC    AL1(0)                                                   03265000
         DC    AL1(0)                                                   03266000
         DC    AL1(0)                                                   03267000
FMD      DC    AL1(0)                                                   03268000
         DC    AL1(0)                                                   03269000
         DC    AL1(15)                                                  03270000
         DC    AL1(16)                                                  03271000
         DC    AL1(0)                                                   03272000
         DC    AL1(0)                                                   03273000
         DC    AL1(19)                                                  03274000
         DC    AL1(20)                                                  03275000
CSR      DC    AL1(0)                                                   03276000
         DC    AL1(0)                                                   03277000
         DC    AL1(15)                                                  03278000
         DC    AL1(16)                                                  03279000
         DC    AL1(0)                                                   03280000
         DC    AL1(0)                                                   03281000
         DC    AL1(19)                                                  03282000
         DC    AL1(20)                                                  03283000
MCS      DC    AL1(0)                                                   03284000
         DC    AL1(0)                                                   03285000
         DC    AL1(0)                                                   03286000
         DC    AL1(0)                                                   03287000
         DC    AL1(0)                                                   03288000
         DC    AL1(0)                                                   03289000
         DC    AL1(0)                                                   03290000
         DC    AL1(0)                                                   03291000
MEM      DC    AL1(0)                                                   03292000
         DC    AL1(0)                                                   03293000
         DC    AL1(0)                                                   03294000
         DC    AL1(0)                                                   03295000
         DC    AL1(0)                                                   03296000
         DC    AL1(0)                                                   03297000
         DC    AL1(0)                                                   03298000
         DC    AL1(0)                                                   03299000
         ORG   TYPGTPTB+136                                             03300000
PATCHEIS DS    CL80                                                     03301000
         ORG   PATCHEIS                                                 03302000
@NM00178 DC    80X'FF'                                                  03303000
         ORG   PATCHEIS+80                                              03304000
EISSW1   DS    BL1                                                      03305000
         ORG   EISSW1                                                   03306000
VALDSNSW DS    BL1                                                      03307000
VALFNCSW EQU   EISSW1+0                                                 03308000
LOADOKSW EQU   EISSW1+0                                                 03309000
FNDSW    EQU   EISSW1+0                                                 03310000
@NM00179 EQU   EISSW1+0                                                 03311000
         ORG   EISSW1+1                                                 03312000
         DS    CL3                                                      03313000
OUTBUFF  DS    CL264                                                    03314000
         ORG   OUTBUFF                                                  03315000
OUTKEY   DS    CL8                                                      03316000
OUTDATA  DS    CL256                                                    03317000
         ORG   OUTDATA                                                  03318000
OUTBLKSZ DS    FL2                                                      03319000
OUTFILL  DS    CL254                                                    03320000
         ORG   OUTBUFF+264                                              03321000
EOFRCD   DS    CL12                                                     03322000
         ORG   EOFRCD                                                   03323000
EOFKEY   DC    X'FFFFFFFFFFFFFFFF'                                      03324000
EOFTTR   DC    4X'00'                                                   03325000
         ORG   EOFRCD+12                                                03326000
WRDIRIOP DS    CL130                                                    03327000
INITIOP  DS    CL130                                                    03328000
GETNSW   DS    BL1                                                      03329000
         ORG   GETNSW                                                   03330000
PREAD    DS    BL1                                                      03331000
SREAD    EQU   GETNSW+0                                                 03332000
DEL      EQU   GETNSW+0                                                 03333000
STOP     EQU   GETNSW+0                                                 03334000
STOP2    EQU   GETNSW+0                                                 03335000
@NM00182 EQU   GETNSW+0                                                 03336000
         ORG   GETNSW+1                                                 03337000
         DS    CL7                                                      03338000
DECALLOC DS    CL5                                                      03339000
         DS    CL3                                                      03340000
DECREQD  DS    CL5                                                      03341000
PRTALLOC DS    CL5                                                      03342000
PRTREQD  DS    CL5                                                      03343000
WRITSW   DS    BL1                                                      03344000
         ORG   WRITSW                                                   03345000
WRITSTOP DS    BL1                                                      03346000
@NM00183 EQU   WRITSW+0                                                 03347000
         ORG   WRITSW+1                                                 03348000
INBUFF   DS    CL264                                                    03349000
BLKIOP   DS    CL68                                                     03350000
STOWNIOP DS    CL130                                                    03351000
STOWOIOP DS    CL130                                                    03352000
@NM00186 DS    BL1                                                      03353000
         ORG   @NM00186                                                 03354000
DFND     DS    BL1                                                      03355000
@NM00187 EQU   @NM00186+0                                               03356000
         ORG   @NM00186+1                                               03357000
         DS    CL3                                                      03358000
HMASMGTP DS    CL28                                                     03359000
         ORG   HMASMGTP+0                                               03360000
GTPFUNCT DS    FL1                                                      03361000
GTPRETRN DS    FL1                                                      03362000
@NM00173 DS    CL2                                                      03363000
GTPRCDLN DS    FL2                                                      03364000
GTPKEYLN DS    FL2                                                      03365000
GTPWKAD  DS    AL4                                                      03366000
GTPBUFAD DS    AL4                                                      03367000
GTPRESTR DS    CL10                                                     03368000
         ORG   GTPRESTR+0                                               03369000
GTPPAG   DS    AL4                                                      03370000
GTPRCD   DS    AL4                                                      03371000
GTPPOS   DS    FL2                                                      03372000
         ORG   HMASMGTP+26                                              03373000
GTPFLGS1 DS    BL1                                                      03374000
         ORG   GTPFLGS1+0                                               03375000
GTPNOSPM DS    BL1                                                      03376000
GTPRCDNF EQU   GTPFLGS1+0                                               03377000
@NM00174 EQU   GTPFLGS1+0                                               03378000
GTPPSIZE EQU   GTPFLGS1+0                                               03379000
         ORG   HMASMGTP+27                                              03380000
@NM00175 DS    FL1                                                      03381000
         ORG   HMASMGTP+560                                             03382000
DSARRAY  DS    CL103                                                    03383000
         ORG   DSARRAY+0                                                03384000
DSMAIN   DC    AL1(2)                                                   03385000
DSDIR    DC    AL1(8)                                                   03386000
DSDIRLN  DC    AL1(36)                                                  03387000
DSMSKON  DC    B'10000000'                                              03388000
DSMSKOFF DC    B'01111111'                                              03389000
DSGTPFRS DC    AL1(1)                                                   03390000
DSGTPLST DC    AL1(7)                                                   03391000
DSGTPGN  DC    AL1(1)                                                   03392000
DSFLAGS1 DC    AL1(0)                                                   03393000
         ORG   DSFLAGS1+0                                               03394000
PEOF     DS    BL1                                                      03395000
SEOF     EQU   DSFLAGS1+0                                               03396000
@NM00176 EQU   DSFLAGS1+0                                               03397000
         ORG   DSARRAY+9                                                03398000
DSBLKCT  DC    FL4'0'                                                   03399000
DSMEMMAX DC    FL4'0'                                                   03400000
DSMEMUSE DC    FL4'1'                                                   03401000
DSDDNAME DC    CL8'SMPCDS  '                                            03402000
DSBUFFR  DC    CL74' '                                                  03403000
         ORG   DSBUFFR+0                                                03404000
DSBFNAME DS    CL8                                                      03405000
DSBFDEL  DS    CL8                                                      03406000
         ORG   DSARRAY+103                                              03407000
         ORG   DSARRAY+103                                              03408000
         DC    AL1(12)                                                  03409000
         DC    AL1(13)                                                  03410000
         DC    AL1(36)                                                  03411000
         DC    B'01000000'                                              03412000
         DC    B'10111111'                                              03413000
         DC    AL1(8)                                                   03414000
         DC    AL1(14)                                                  03415000
         DC    AL1(8)                                                   03416000
         DC    AL1(0)                                                   03417000
         DC    FL4'0'                                                   03418000
         DC    FL4'0'                                                   03419000
         DC    FL4'1'                                                   03420000
         DC    CL8'SMPACDS '                                            03421000
         DC    CL74' '                                                  03422000
         ORG   DSARRAY+206                                              03423000
         ORG   DSARRAY+206                                              03424000
         DC    AL1(28)                                                  03425000
         DC    AL1(29)                                                  03426000
         DC    AL1(14)                                                  03427000
         DC    B'00100000'                                              03428000
         DC    B'11011111'                                              03429000
         DC    AL1(15)                                                  03430000
         DC    AL1(15)                                                  03431000
         DC    AL1(15)                                                  03432000
         DC    AL1(0)                                                   03433000
         DC    FL4'0'                                                   03434000
         DC    FL4'0'                                                   03435000
         DC    FL4'1'                                                   03436000
         DC    CL8'SMPCRQ  '                                            03437000
         DC    CL74' '                                                  03438000
         ORG   DSARRAY+309                                              03439000
         ORG   DSARRAY+309                                              03440000
         DC    AL1(30)                                                  03441000
         DC    AL1(31)                                                  03442000
         DC    AL1(14)                                                  03443000
         DC    B'00010000'                                              03444000
         DC    B'11101111'                                              03445000
         DC    AL1(16)                                                  03446000
         DC    AL1(16)                                                  03447000
         DC    AL1(16)                                                  03448000
         DC    AL1(0)                                                   03449000
         DC    FL4'0'                                                   03450000
         DC    FL4'0'                                                   03451000
         DC    FL4'1'                                                   03452000
         DC    CL8'SMPACRQ '                                            03453000
         DC    CL74' '                                                  03454000
         ORG   DSARRAY+412                                              03455000
         ORG   DSARRAY+412                                              03456000
         DC    AL1(2)                                                   03457000
         DC    AL1(8)                                                   03458000
         DC    AL1(36)                                                  03459000
         DC    B'00000000'                                              03460000
         DC    B'11111111'                                              03461000
         DC    AL1(17)                                                  03462000
         DC    AL1(17)                                                  03463000
         DC    AL1(17)                                                  03464000
         DC    AL1(0)                                                   03465000
         DC    FL4'0'                                                   03466000
         DC    FL4'0'                                                   03467000
         DC    FL4'1'                                                   03468000
         DC    CL8'SMPCDS  '                                            03469000
         DC    CL74' '                                                  03470000
         ORG   DSARRAY+515                                              03471000
         ORG   DSARRAY+515                                              03472000
         DC    AL1(12)                                                  03473000
         DC    AL1(13)                                                  03474000
         DC    AL1(36)                                                  03475000
         DC    B'00000000'                                              03476000
         DC    B'11111111'                                              03477000
         DC    AL1(18)                                                  03478000
         DC    AL1(18)                                                  03479000
         DC    AL1(18)                                                  03480000
         DC    AL1(0)                                                   03481000
         DC    FL4'0'                                                   03482000
         DC    FL4'0'                                                   03483000
         DC    FL4'1'                                                   03484000
         DC    CL8'SMPACDS '                                            03485000
         DC    CL74' '                                                  03486000
         ORG   DSARRAY+618                                              03487000
         ORG   DSARRAY+618                                              03488000
         DC    AL1(28)                                                  03489000
         DC    AL1(29)                                                  03490000
         DC    AL1(14)                                                  03491000
         DC    B'00000000'                                              03492000
         DC    B'11111111'                                              03493000
         DC    AL1(19)                                                  03494000
         DC    AL1(19)                                                  03495000
         DC    AL1(19)                                                  03496000
         DC    AL1(0)                                                   03497000
         DC    FL4'0'                                                   03498000
         DC    FL4'0'                                                   03499000
         DC    FL4'1'                                                   03500000
         DC    CL8'SMPCRQ  '                                            03501000
         DC    CL74' '                                                  03502000
         ORG   DSARRAY+721                                              03503000
         ORG   DSARRAY+721                                              03504000
         DC    AL1(30)                                                  03505000
         DC    AL1(31)                                                  03506000
         DC    AL1(14)                                                  03507000
         DC    B'00000000'                                              03508000
         DC    B'11111111'                                              03509000
         DC    AL1(20)                                                  03510000
         DC    AL1(20)                                                  03511000
         DC    AL1(20)                                                  03512000
         DC    AL1(0)                                                   03513000
         DC    FL4'0'                                                   03514000
         DC    FL4'0'                                                   03515000
         DC    FL4'1'                                                   03516000
         DC    CL8'SMPACRQ '                                            03517000
         DC    CL74' '                                                  03518000
         ORG   DSARRAY+824                                              03519000
DSFIRST  DC    20AL1(0)                                                 03520000
FNCARRAY DS    CL8                                                      03521000
         ORG   FNCARRAY+0                                               03522000
FNCIOPCD DC    AL1(8)                                                   03523000
@NM00177 DS    CL3                                                      03524000
FNCADDR  DC    AL4(EISINIT)                                             03525000
         ORG   FNCARRAY+8                                               03526000
         ORG   FNCARRAY+8                                               03527000
         DC    AL1(9)                                                   03528000
         DS    CL3                                                      03529000
         DC    AL4(EISFREE)                                             03530000
         ORG   FNCARRAY+16                                              03531000
         ORG   FNCARRAY+16                                              03532000
         DC    AL1(3)                                                   03533000
         DS    CL3                                                      03534000
         DC    AL4(EISLOC)                                              03535000
         ORG   FNCARRAY+24                                              03536000
         ORG   FNCARRAY+24                                              03537000
         DC    AL1(4)                                                   03538000
         DS    CL3                                                      03539000
         DC    AL4(EISBLDL)                                             03540000
         ORG   FNCARRAY+32                                              03541000
         ORG   FNCARRAY+32                                              03542000
         DC    AL1(10)                                                  03543000
         DS    CL3                                                      03544000
         DC    AL4(EISGETN)                                             03545000
         ORG   FNCARRAY+40                                              03546000
         ORG   FNCARRAY+40                                              03547000
         DC    AL1(12)                                                  03548000
         DS    CL3                                                      03549000
         DC    AL4(EISCLOSN)                                            03550000
         ORG   FNCARRAY+48                                              03551000
         ORG   FNCARRAY+48                                              03552000
         DC    AL1(86)                                                  03553000
         DS    CL3                                                      03554000
         DC    AL4(EISUDEO)                                             03555000
         ORG   FNCARRAY+56                                              03556000
         ORG   FNCARRAY+56                                              03557000
         DC    AL1(84)                                                  03558000
         DS    CL3                                                      03559000
         DC    AL4(EISSTOWR)                                            03560000
         ORG   FNCARRAY+64                                              03561000
         ORG   FNCARRAY+64                                              03562000
         DC    AL1(83)                                                  03563000
         DS    CL3                                                      03564000
         DC    AL4(EISSTOWD)                                            03565000
         ORG   FNCARRAY+72                                              03566000
         ORG   FNCARRAY+72                                              03567000
         DC    AL1(82)                                                  03568000
         DS    CL3                                                      03569000
         DC    AL4(EISSTOWC)                                            03570000
         ORG   FNCARRAY+80                                              03571000
         ORG   FNCARRAY+80                                              03572000
         DC    AL1(89)                                                  03573000
         DS    CL3                                                      03574000
         DC    AL4(EISWRDIR)                                            03575000
         ORG   FNCARRAY+88                                              03576000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       03577000
@01      EQU   01                                                       03578000
@02      EQU   02                                                       03579000
@03      EQU   03                                                       03580000
@04      EQU   04                                                       03581000
@05      EQU   05                                                       03582000
@06      EQU   06                                                       03583000
@07      EQU   07                                                       03584000
@08      EQU   08                                                       03585000
@09      EQU   09                                                       03586000
@10      EQU   10                                                       03587000
@11      EQU   11                                                       03588000
@12      EQU   12                                                       03589000
@13      EQU   13                                                       03590000
@14      EQU   14                                                       03591000
@15      EQU   15                                                       03592000
MSGRC    EQU   @02                                                      03593000
STOWCRC  EQU   @02                                                      03594000
BLKWRRC  EQU   @02                                                      03595000
WRITRC   EQU   @02                                                      03596000
FORMRC   EQU   @02                                                      03597000
WRDIRRC  EQU   @02                                                      03598000
STOWDRC  EQU   @02                                                      03599000
STOWRRC  EQU   @02                                                      03600000
GETNRC   EQU   @02                                                      03601000
LOCRC    EQU   @02                                                      03602000
FREERC   EQU   @04                                                      03603000
INITRC   EQU   @05                                                      03604000
INITPTR  EQU   @04                                                      03605000
SETUPRC  EQU   @02                                                      03606000
UNUSEDSP EQU   @05                                                      03607000
MVSIZE   EQU   @06                                                      03608000
FILLPTR  EQU   @08                                                      03609000
EISRC    EQU   @02                                                      03610000
MEMUSE   EQU   @06                                                      03611000
DIRBKCT  EQU   @07                                                      03612000
TMPINDX  EQU   @02                                                      03613000
PDSINDX  EQU   @03                                                      03614000
IOPPTR   EQU   @04                                                      03615000
RTNCODE  EQU   @15                                                      03616000
         EXTRN HMASMCCA                                                 03617000
CCADSIDA EQU   0                                                        03618000
CCATYPEA EQU   0                                                        03619000
CCABLDLA EQU   0                                                        03620000
@NM00025 EQU   CCABLDLA                                                 03621000
CCABLDLL EQU   0                                                        03622000
@NM00027 EQU   CCABLDLL                                                 03623000
CCALKDRC EQU   @NM00027+20                                              03624000
@NM00029 EQU   CCABLDLL+124                                             03625000
CCAASMRC EQU   @NM00029+20                                              03626000
@NM00031 EQU   CCABLDLL+248                                             03627000
CCACPYRC EQU   @NM00031+20                                              03628000
@NM00033 EQU   CCABLDLL+372                                             03629000
CCACOMRC EQU   @NM00033+20                                              03630000
@NM00035 EQU   CCABLDLL+496                                             03631000
CCAZAPRC EQU   @NM00035+20                                              03632000
@NM00037 EQU   CCABLDLL+620                                             03633000
CCASUPRC EQU   @NM00037+20                                              03634000
@NM00039 EQU   CCABLDLL+744                                             03635000
CCAUPDRC EQU   @NM00039+20                                              03636000
CCABLDLM EQU   0                                                        03637000
CCABELMT EQU   CCABLDLM+4                                               03638000
CCABMPOS EQU   CCABELMT                                                 03639000
HMASMIOP EQU   0                                                        03640000
IOPDSID  EQU   HMASMIOP                                                 03641000
IOPFUNCT EQU   HMASMIOP+1                                               03642000
IOPRETRN EQU   HMASMIOP+2                                               03643000
IOPTYPE  EQU   HMASMIOP+3                                               03644000
IOPNAME  EQU   HMASMIOP+4                                               03645000
@NM00043 EQU   HMASMIOP+12                                              03646000
@NM00044 EQU   @NM00043                                                 03647000
IOPDDNAM EQU   HMASMIOP+24                                              03648000
IOPBUFAD EQU   HMASMIOP+52                                              03649000
IOPDRMAP EQU   HMASMIOP+56                                              03650000
IOPINAME EQU   IOPDRMAP                                                 03651000
IOPINAM  EQU   IOPINAME                                                 03652000
IOPITYP  EQU   IOPINAM                                                  03653000
IOPUSERL EQU   IOPDRMAP+11                                              03654000
IOPEND   EQU   IOPDRMAP+12                                              03655000
IOPLMCTL EQU   0                                                        03656000
IOPQSMIF EQU   0                                                        03657000
@NM00154 EQU   IOPQSMIF                                                 03658000
IOPQSMLS EQU   IOPQSMIF+8                                               03659000
IOPQSMNM EQU   IOPQSMLS                                                 03660000
IOPBS02  EQU   0                                                        03661000
IOPBS04  EQU   0                                                        03662000
IOPBAPF  EQU   IOPBS04                                                  03663000
EISRTN   EQU   0                                                        03664000
OUTMEM   EQU   0                                                        03665000
NTRYMAP  EQU   0                                                        03666000
NTRYKEY  EQU   NTRYMAP                                                  03667000
ULEN     EQU   NTRYMAP+11                                               03668000
IOPBS01  EQU   0                                                        03669000
IOPBS03  EQU   0                                                        03670000
CCAFBUFR EQU   HMASMCCA+4                                               03671000
CCADSAD  EQU   CCAFBUFR+124                                             03672000
CCATPAD  EQU   CCAFBUFR+128                                             03673000
CCAFLAG7 EQU   CCAFBUFR+132                                             03674000
CCAFIOP  EQU   HMASMCCA+140                                             03675000
CCAFSYS  EQU   HMASMCCA+148                                             03676000
CCASREL  EQU   CCAFSYS+12                                               03677000
CCAFLAGA EQU   CCAFSYS+21                                               03678000
CCAFSTA  EQU   HMASMCCA+188                                             03679000
CCAFICT  EQU   HMASMCCA+192                                             03680000
CCAFPGM  EQU   HMASMCCA+208                                             03681000
CCABLDLP EQU   CCAFPGM                                                  03682000
CCADBLDL EQU   CCAFPGM+4                                                03683000
CCAFGTP  EQU   HMASMCCA+224                                             03684000
CCASEGTP EQU   CCAFGTP                                                  03685000
@NM00009 EQU   HMASMCCA+244                                             03686000
CCAFFUNC EQU   HMASMCCA+264                                             03687000
CCAFLAG1 EQU   CCAFFUNC+8                                               03688000
CCAFLAG2 EQU   CCAFFUNC+11                                              03689000
CCACHECK EQU   CCAFLAG2                                                 03690000
CCAFPROC EQU   HMASMCCA+276                                             03691000
CCAFLAG3 EQU   CCAFPROC                                                 03692000
CCAFDIS  EQU   HMASMCCA+278                                             03693000
CCAFLAG4 EQU   CCAFDIS                                                  03694000
CCAFLAG5 EQU   CCAFDIS+1                                                03695000
CCACDSOS EQU   CCAFLAG5                                                 03696000
CCAACDOS EQU   CCAFLAG5                                                 03697000
CCACRQOS EQU   CCAFLAG5                                                 03698000
CCAACROS EQU   CCAFLAG5                                                 03699000
CCAFLAG6 EQU   CCAFDIS+2                                                03700000
CCAFCNV  EQU   HMASMCCA+281                                             03701000
CCAFLAG8 EQU   CCAFCNV                                                  03702000
CCAFCTL  EQU   HMASMCCA+282                                             03703000
CCAFLAG9 EQU   CCAFCTL                                                  03704000
CCAFDSNG EQU   HMASMCCA+298                                             03705000
CCAFLAGB EQU   CCAFDSNG                                                 03706000
EISMIOP  EQU   0                                                        03707000
IOPUDATA EQU   IOPEND                                                   03708000
IOPINAM3 EQU   IOPINAME                                                 03709000
@NM00050 EQU   IOPINAM3                                                 03710000
IOPSTCMP EQU   IOPUDATA                                                 03711000
IOPONAME EQU   IOPSTCMP                                                 03712000
IOPOTYPE EQU   IOPSTCMP+8                                               03713000
IOPNNAME EQU   IOPSTCMP+9                                               03714000
IOPDYNDT EQU   IOPUDATA                                                 03715000
IOPSPACE EQU   IOPDYNDT+44                                              03716000
IOPDTYPE EQU   IOPDYNDT+50                                              03717000
IOPNTMAX EQU   IOPDRMAP                                                 03718000
IOPDIRMX EQU   IOPNTMAX+12                                              03719000
IOPNTMAP EQU   IOPDRMAP                                                 03720000
IOPCDMAP EQU   IOPNTMAP                                                 03721000
IOPPTMAP EQU   IOPCDMAP                                                 03722000
IOPSCMAP EQU   IOPPTMAP                                                 03723000
IOPDIRCT EQU   IOPSCMAP+12                                              03724000
IOPCDMAX EQU   IOPDIRCT                                                 03725000
IOPCQMAP EQU   IOPDRMAP                                                 03726000
@NM00061 EQU   IOPUDATA                                                 03727000
@NM00062 EQU   IOPUDATA                                                 03728000
IOPALLOC EQU   @NM00062+4                                               03729000
IOPASMNT EQU   IOPUDATA                                                 03730000
IOPASMDR EQU   IOPASMNT                                                 03731000
IOPABUNT EQU   IOPASMDR+1                                               03732000
IOPLMDNT EQU   IOPUDATA                                                 03733000
IOPLMDDR EQU   IOPLMDNT                                                 03734000
IOPLMLEP EQU   IOPLMDDR+1                                               03735000
IOPLMDF1 EQU   IOPLMLEP                                                 03736000
IOPFLGS2 EQU   IOPLMDF1                                                 03737000
IOPLMDF2 EQU   IOPLMLEP+1                                               03738000
IOPLMDF3 EQU   IOPLMLEP+2                                               03739000
IOPLMDF4 EQU   IOPLMLEP+3                                               03740000
IOPLMDF5 EQU   IOPLMDDR+5                                               03741000
IOPFLGS3 EQU   IOPLMDF5                                                 03742000
IOPLMDFX EQU   IOPLMDNT+24                                              03743000
@NM00071 EQU   IOPLMDFX                                                 03744000
IOPLNTRY EQU   IOPLMDFX+8                                               03745000
IOPLSYS  EQU   IOPLNTRY                                                 03746000
IOPSYSLB EQU   IOPLSYS                                                  03747000
IOPMACNT EQU   IOPUDATA                                                 03748000
IOPMACDR EQU   IOPMACNT                                                 03749000
IOPRMIDE EQU   IOPMACDR+1                                               03750000
IOPRMST  EQU   IOPRMIDE+7                                               03751000
IOPFMIDE EQU   IOPMACDR+9                                               03752000
IOPMACFX EQU   IOPMACNT+24                                              03753000
IOPBUNT  EQU   IOPMACFX                                                 03754000
IOPMCEND EQU   IOPMACNT+104                                             03755000
IOPMACVR EQU   IOPMCEND                                                 03756000
IOPMCENT EQU   IOPMACVR                                                 03757000
IOPMCDTA EQU   IOPMCENT                                                 03758000
IOPMCASM EQU   IOPMCDTA                                                 03759000
IOPMACID EQU   IOPMCASM                                                 03760000
IOPMACST EQU   IOPMCASM+7                                               03761000
IOPMCIND EQU   IOPMCENT+8                                               03762000
IOPEOFNT EQU   IOPUDATA                                                 03763000
IOPSRCNT EQU   IOPUDATA                                                 03764000
IOPSRCDR EQU   IOPSRCNT                                                 03765000
@NM00082 EQU   IOPSRCDR+1                                               03766000
@NM00084 EQU   @NM00082+7                                               03767000
@NM00088 EQU   IOPSRCDR+9                                               03768000
IOPSRCFX EQU   IOPSRCNT+24                                              03769000
@NM00092 EQU   IOPSRCFX                                                 03770000
IOPSREND EQU   IOPSRCNT+104                                             03771000
IOPSRCVR EQU   IOPSREND                                                 03772000
IOPSNTRY EQU   IOPSRCVR                                                 03773000
IOPSRDTA EQU   IOPSNTRY                                                 03774000
IOPSRCID EQU   IOPSRDTA                                                 03775000
IOPSRCST EQU   IOPSRDTA+7                                               03776000
IOPMODNT EQU   IOPUDATA                                                 03777000
IOPMODDR EQU   IOPMODNT                                                 03778000
@NM00098 EQU   IOPMODDR+1                                               03779000
@NM00100 EQU   @NM00098+7                                               03780000
@NM00104 EQU   IOPMODDR+9                                               03781000
IOPMODFX EQU   IOPMODNT+24                                              03782000
@NM00108 EQU   IOPMODFX                                                 03783000
IOPMDLEP EQU   IOPMODFX+8                                               03784000
IOPMODF1 EQU   IOPMDLEP                                                 03785000
IOPMODF2 EQU   IOPMDLEP+1                                               03786000
IOPMODF3 EQU   IOPMDLEP+2                                               03787000
IOPMODF4 EQU   IOPMDLEP+3                                               03788000
IOPMDEND EQU   IOPMODNT+104                                             03789000
IOPMODVR EQU   IOPMDEND                                                 03790000
IOPMNTRY EQU   IOPMODVR                                                 03791000
IOPMDDTA EQU   IOPMNTRY                                                 03792000
IOPLMODS EQU   IOPMDDTA                                                 03793000
IOPMODID EQU   IOPLMODS                                                 03794000
IOPMODST EQU   IOPLMODS+7                                               03795000
IOPDLBNT EQU   IOPUDATA                                                 03796000
IOPDLBDR EQU   IOPDLBNT                                                 03797000
IOPDLBFX EQU   IOPDLBNT+24                                              03798000
@NM00119 EQU   IOPDLBFX                                                 03799000
IOPDLEND EQU   IOPDLBNT+104                                             03800000
IOPDLBVR EQU   IOPDLEND                                                 03801000
IOPDNTRY EQU   IOPDLBVR                                                 03802000
IOPDSYS  EQU   IOPDNTRY                                                 03803000
IOPSYSNT EQU   IOPUDATA                                                 03804000
IOPSYSDR EQU   IOPSYSNT                                                 03805000
IOPSYSF1 EQU   IOPSYSDR+4                                               03806000
IOPFLGS7 EQU   IOPSYSF1                                                 03807000
IOPSYSFX EQU   IOPSYSNT+24                                              03808000
@NM00126 EQU   IOPSYSFX                                                 03809000
IOPSYEND EQU   IOPSYSNT+184                                             03810000
IOPSYSVR EQU   IOPSYEND                                                 03811000
IOPSYSTR EQU   IOPSYSVR                                                 03812000
IOPSYNTR EQU   IOPSYSTR                                                 03813000
IOPPTFNT EQU   IOPUDATA                                                 03814000
IOPPTFDR EQU   IOPPTFNT                                                 03815000
IOPPSTAT EQU   IOPPTFDR+2                                               03816000
IOPPTFF1 EQU   IOPPSTAT                                                 03817000
IOPFLGS5 EQU   IOPPTFF1                                                 03818000
IOPPTFF2 EQU   IOPPSTAT+1                                               03819000
IOPPTFF3 EQU   IOPPSTAT+3                                               03820000
IOPPTFFX EQU   IOPPTFNT+24                                              03821000
@NM00135 EQU   IOPPTFFX                                                 03822000
@NM00136 EQU   @NM00135                                                 03823000
IOPPDTES EQU   IOPPTFFX+41                                              03824000
@NM00139 EQU   IOPPDTES                                                 03825000
IOPPTPFX EQU   IOPPDTES+6                                               03826000
IOPDATES EQU   IOPPTPFX                                                 03827000
IOPPTEND EQU   IOPPTFNT+104                                             03828000
IOPPTFVR EQU   IOPPTEND                                                 03829000
IOPPNTRY EQU   IOPPTFVR                                                 03830000
IOPPMODS EQU   IOPPNTRY                                                 03831000
IOPENTNT EQU   IOPUDATA+104                                             03832000
IOPSRLNT EQU   IOPUDATA+104                                             03833000
IOPPRENT EQU   IOPUDATA+104                                             03834000
IOPNPRNT EQU   IOPUDATA+104                                             03835000
IOPSUPNT EQU   IOPUDATA+104                                             03836000
IOPREQNT EQU   IOPUDATA+104                                             03837000
IOPIRQNT EQU   IOPUDATA+104                                             03838000
IOPFIDNT EQU   IOPUDATA+104                                             03839000
IOPDELNT EQU   IOPUDATA+104                                             03840000
IOPVERNT EQU   IOPUDATA+104                                             03841000
IOPSBYNT EQU   IOPUDATA+104                                             03842000
IOPQSMNT EQU   IOPUDATA                                                 03843000
IOPQSMDR EQU   IOPQSMNT                                                 03844000
IOPQFMNT EQU   IOPUDATA                                                 03845000
IOPQFMDR EQU   IOPQFMNT                                                 03846000
IOPQFEND EQU   IOPQFMNT+2                                               03847000
IOPQFMVR EQU   IOPQFEND                                                 03848000
IOPQFMLS EQU   IOPQFMVR                                                 03849000
IOPQFMNM EQU   IOPQFMLS                                                 03850000
IOPPTSYS EQU   IOPUDATA                                                 03851000
IOPPTSDR EQU   IOPPTSYS                                                 03852000
IOPPTSFX EQU   IOPPTSYS+24                                              03853000
IOPDSSPC EQU   IOPPTSFX                                                 03854000
IOPPTFG1 EQU   IOPPTSFX+34                                              03855000
IOPPSEND EQU   IOPPTSYS+1064                                            03856000
IOPPTSVR EQU   IOPPSEND                                                 03857000
IOPPTNTR EQU   IOPPTSVR                                                 03858000
@NM00164 EQU   IOPPTNTR                                                 03859000
IOPPTFMD EQU   @NM00164                                                 03860000
IOPPTREL EQU   IOPPTFMD                                                 03861000
IOPBPDS  EQU   IOPUDATA                                                 03862000
IOPBLEP1 EQU   IOPBPDS+8                                                03863000
IOPBLEP2 EQU   IOPBPDS+9                                                03864000
@NM00168 EQU   IOPBPDS+18                                               03865000
IOPBFTB0 EQU   @NM00168                                                 03866000
IOPBFTB1 EQU   IOPBFTB0                                                 03867000
GTP      EQU   TYPGTPTB                                                 03868000
@NM00184 EQU   IOPDRMAP                                                 03869000
DELTYP   EQU   @NM00184+8                                               03870000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    03871000
@NM00185 EQU   @NM00184                                                 03872000
IOPBCEND EQU   IOPBPDS+21                                               03873000
IOPBFTB3 EQU   IOPBFTB0+2                                               03874000
IOPBFTB2 EQU   IOPBFTB0+1                                               03875000
@NM00170 EQU   IOPBFTB1                                                 03876000
IOPBAPFP EQU   IOPBFTB1                                                 03877000
IOPBSSI  EQU   IOPBFTB1                                                 03878000
IOPBPAGA EQU   IOPBFTB1                                                 03879000
@NM00169 EQU   IOPBFTB1                                                 03880000
IOPBAOSL EQU   IOPBFTB1                                                 03881000
IOPBSEPA EQU   IOPBPDS+15                                               03882000
IOPBFTBL EQU   IOPBPDS+13                                               03883000
IOPBSTOR EQU   IOPBPDS+10                                               03884000
IOPBREFR EQU   IOPBLEP2                                                 03885000
IOPBLEF  EQU   IOPBLEP2                                                 03886000
IOPBTEST EQU   IOPBLEP2                                                 03887000
IOPBNE   EQU   IOPBLEP2                                                 03888000
@NM00167 EQU   IOPBLEP2                                                 03889000
IOPBDC   EQU   IOPBLEP2                                                 03890000
@NM00166 EQU   IOPBLEP1                                                 03891000
IOPBSCTR EQU   IOPBLEP1                                                 03892000
IOPBOL   EQU   IOPBLEP1                                                 03893000
@NM00165 EQU   IOPBLEP1                                                 03894000
IOPBOVLY EQU   IOPBLEP1                                                 03895000
IOPBREUS EQU   IOPBLEP1                                                 03896000
IOPBRENT EQU   IOPBLEP1                                                 03897000
IOPBNL   EQU   IOPBPDS+7                                                03898000
IOPBTTRN EQU   IOPBPDS+4                                                03899000
IOPBZERO EQU   IOPBPDS+3                                                03900000
IOPBTTRT EQU   IOPBPDS                                                  03901000
IOPPTIND EQU   IOPPTNTR+8                                               03902000
IOPPTSND EQU   IOPPTREL                                                 03903000
@NM00163 EQU   IOPPTSFX+872                                             03904000
IOPSYZPP EQU   IOPPTSFX+772                                             03905000
IOPSYZPR EQU   IOPPTSFX+771                                             03906000
IOPSYZPS EQU   IOPPTSFX+763                                             03907000
IOPSYZAP EQU   IOPPTSFX+755                                             03908000
IOPSYUPP EQU   IOPPTSFX+655                                             03909000
IOPSYUPR EQU   IOPPTSFX+654                                             03910000
IOPSYUPS EQU   IOPPTSFX+646                                             03911000
IOPSYUPD EQU   IOPPTSFX+638                                             03912000
IOPSYSPP EQU   IOPPTSFX+538                                             03913000
IOPSYSPR EQU   IOPPTSFX+537                                             03914000
IOPSYSPS EQU   IOPPTSFX+529                                             03915000
IOPSYSUP EQU   IOPPTSFX+521                                             03916000
IOPSYLKP EQU   IOPPTSFX+421                                             03917000
IOPSYLKR EQU   IOPPTSFX+420                                             03918000
IOPSYLKS EQU   IOPPTSFX+412                                             03919000
IOPSYLKD EQU   IOPPTSFX+404                                             03920000
IOPSYCPP EQU   IOPPTSFX+304                                             03921000
IOPSYCPR EQU   IOPPTSFX+303                                             03922000
IOPSYCPS EQU   IOPPTSFX+295                                             03923000
IOPSYCPY EQU   IOPPTSFX+287                                             03924000
IOPSYCOP EQU   IOPPTSFX+187                                             03925000
IOPSYCOR EQU   IOPPTSFX+186                                             03926000
IOPSYCOS EQU   IOPPTSFX+178                                             03927000
IOPSYCOM EQU   IOPPTSFX+170                                             03928000
IOPSYASP EQU   IOPPTSFX+70                                              03929000
IOPSYASR EQU   IOPPTSFX+69                                              03930000
IOPSYASS EQU   IOPPTSFX+61                                              03931000
IOPSYASM EQU   IOPPTSFX+53                                              03932000
@NM00162 EQU   IOPPTSFX+35                                              03933000
@NM00161 EQU   IOPPTFG1                                                 03934000
IOPPTSNJ EQU   IOPPTFG1                                                 03935000
IOPPTSNP EQU   IOPPTFG1                                                 03936000
IOPSYPLN EQU   IOPPTSFX+32                                              03937000
IOPDSPFX EQU   IOPPTSFX+6                                               03938000
IOPDSDIR EQU   IOPDSSPC+4                                               03939000
IOPDSSEC EQU   IOPDSSPC+2                                               03940000
IOPDSPRM EQU   IOPDSSPC                                                 03941000
@NM00160 EQU   IOPPTSDR+4                                               03942000
IOPPTPEM EQU   IOPPTSDR+2                                               03943000
IOPPCNVL EQU   IOPPTSDR+1                                               03944000
@NM00159 EQU   IOPPTSDR                                                 03945000
IOPQFMTP EQU   IOPQFMLS+8                                               03946000
@NM00158 EQU   IOPQFMLS+7                                               03947000
IOPQFMND EQU   IOPQFMNM                                                 03948000
@NM00157 EQU   IOPQFMDR                                                 03949000
@NM00153 EQU   IOPQSMDR                                                 03950000
@NM00152 EQU   IOPSBYNT+8                                               03951000
IOPSBYST EQU   IOPSBYNT+7                                               03952000
IOPSBYNM EQU   IOPSBYNT                                                 03953000
@NM00151 EQU   IOPVERNT+8                                               03954000
IOPVERST EQU   IOPVERNT+7                                               03955000
IOPVERNM EQU   IOPVERNT                                                 03956000
@NM00150 EQU   IOPDELNT+8                                               03957000
IOPDELST EQU   IOPDELNT+7                                               03958000
IOPDELNM EQU   IOPDELNT                                                 03959000
@NM00149 EQU   IOPFIDNT+8                                               03960000
IOPFIDST EQU   IOPFIDNT+7                                               03961000
IOPFIDNM EQU   IOPFIDNT                                                 03962000
@NM00148 EQU   IOPIRQNT+8                                               03963000
IOPIRQST EQU   IOPIRQNT+7                                               03964000
IOPIRQNM EQU   IOPIRQNT                                                 03965000
@NM00147 EQU   IOPREQNT+8                                               03966000
IOPREQST EQU   IOPREQNT+7                                               03967000
IOPREQNM EQU   IOPREQNT                                                 03968000
@NM00146 EQU   IOPSUPNT+8                                               03969000
IOPSUPST EQU   IOPSUPNT+7                                               03970000
IOPSUPNM EQU   IOPSUPNT                                                 03971000
@NM00145 EQU   IOPNPRNT+8                                               03972000
IOPNPRST EQU   IOPNPRNT+7                                               03973000
IOPNPRNM EQU   IOPNPRNT                                                 03974000
@NM00144 EQU   IOPPRENT+8                                               03975000
IOPPREST EQU   IOPPRENT+7                                               03976000
IOPPRENM EQU   IOPPRENT                                                 03977000
@NM00143 EQU   IOPSRLNT+8                                               03978000
IOPSRLST EQU   IOPSRLNT+7                                               03979000
@NM00142 EQU   IOPSRLNT+4                                               03980000
IOPSRLNM EQU   IOPSRLNT                                                 03981000
@NM00141 EQU   IOPENTNT+8                                               03982000
IOPENTST EQU   IOPENTNT+7                                               03983000
IOPENTNM EQU   IOPENTNT                                                 03984000
IOPPIND  EQU   IOPPNTRY+8                                               03985000
IOPPTFND EQU   IOPPMODS                                                 03986000
IOPPFMID EQU   IOPPTFFX+73                                              03987000
@NM00140 EQU   IOPPTPFX+24                                              03988000
IOPUCLT  EQU   IOPDATES+21                                              03989000
IOPUCLD  EQU   IOPDATES+18                                              03990000
IOPACCT  EQU   IOPDATES+15                                              03991000
IOPACCD  EQU   IOPDATES+12                                              03992000
IOPRSTT  EQU   IOPDATES+9                                               03993000
IOPRSTD  EQU   IOPDATES+6                                               03994000
IOPAPPT  EQU   IOPDATES+3                                               03995000
IOPAPPD  EQU   IOPDATES                                                 03996000
IOPRECT  EQU   @NM00139+3                                               03997000
IOPRECD  EQU   @NM00139                                                 03998000
@NM00138 EQU   IOPPTFFX+8                                               03999000
@NM00137 EQU   @NM00135+7                                               04000000
IOPPRELN EQU   @NM00136                                                 04001000
@NM00134 EQU   IOPPTFDR+20                                              04002000
IOPSBYNO EQU   IOPPTFDR+13                                              04003000
IOPDBYNO EQU   IOPPTFDR+6                                               04004000
@NM00133 EQU   IOPPTFF3                                                 04005000
IOPFLF   EQU   IOPPTFF3                                                 04006000
IOPDBYP  EQU   IOPPTFF3                                                 04007000
IOPSBYP  EQU   IOPPTFF3                                                 04008000
IOPPMDLP EQU   IOPPTFF2+1                                               04009000
IOPPADDP EQU   IOPPTFF2+1                                               04010000
@NM00132 EQU   IOPPTFF2+1                                               04011000
IOPLRFP  EQU   IOPPTFF2                                                 04012000
IOPJCLP  EQU   IOPPTFF2                                                 04013000
IOPSUPP  EQU   IOPPTFF2                                                 04014000
IOPREQP  EQU   IOPPTFF2                                                 04015000
IOPPREP  EQU   IOPPTFF2                                                 04016000
IOPNPRP  EQU   IOPPTFF2                                                 04017000
IOPIRQP  EQU   IOPPTFF2                                                 04018000
IOPDELP  EQU   IOPPTFF2                                                 04019000
IOPREGEN EQU   IOPFLGS5                                                 04020000
IOPBYP   EQU   IOPFLGS5                                                 04021000
IOPDUMMP EQU   IOPFLGS5                                                 04022000
@NM00131 EQU   IOPFLGS5                                                 04023000
IOPERROR EQU   IOPFLGS5                                                 04024000
IOPACC   EQU   IOPFLGS5                                                 04025000
IOPRES   EQU   IOPFLGS5                                                 04026000
IOPAPP   EQU   IOPFLGS5                                                 04027000
IOPPTYPE EQU   IOPPTFDR+1                                               04028000
@NM00130 EQU   IOPPTFDR                                                 04029000
IOPSYSTP EQU   IOPSYSTR+8                                               04030000
IOPSYSND EQU   IOPSYNTR                                                 04031000
@NM00129 EQU   IOPSYSFX+21                                              04032000
IOPSYSID EQU   IOPSYSFX+13                                              04033000
IOPNUCID EQU   IOPSYSFX+12                                              04034000
IOPSREL  EQU   IOPSYSFX+8                                               04035000
@NM00128 EQU   @NM00126+7                                               04036000
@NM00127 EQU   @NM00126                                                 04037000
@NM00125 EQU   IOPSYSDR+5                                               04038000
@NM00124 EQU   IOPFLGS7                                                 04039000
IOPSYNG  EQU   IOPFLGS7                                                 04040000
IOPSYDL  EQU   IOPFLGS7                                                 04041000
IOPSTSNP EQU   IOPFLGS7                                                 04042000
IOPMTSNP EQU   IOPFLGS7                                                 04043000
IOPPEMAX EQU   IOPSYSDR+2                                               04044000
IOPSCNVL EQU   IOPSYSDR+1                                               04045000
@NM00123 EQU   IOPSYSDR                                                 04046000
IOPDLIND EQU   IOPDNTRY+8                                               04047000
IOPDLBND EQU   IOPDSYS                                                  04048000
@NM00122 EQU   IOPDLBFX+8                                               04049000
@NM00121 EQU   @NM00119+7                                               04050000
@NM00120 EQU   @NM00119                                                 04051000
@NM00118 EQU   IOPDLBDR+1                                               04052000
@NM00117 EQU   IOPDLBDR                                                 04053000
IOPMDIND EQU   IOPMNTRY+8                                               04054000
@NM00116 EQU   IOPMODST                                                 04055000
IOPMODND EQU   IOPMODID                                                 04056000
IOPDLIB  EQU   IOPMODFX+72                                              04057000
@NM00115 EQU   IOPMODFX+12                                              04058000
@NM00114 EQU   IOPMODF4                                                 04059000
@NM00113 EQU   IOPMODF3                                                 04060000
@NM00112 EQU   IOPMODF2                                                 04061000
IOPMPAGA EQU   IOPMODF2                                                 04062000
IOPMNE   EQU   IOPMODF2                                                 04063000
@NM00111 EQU   IOPMODF1                                                 04064000
IOPMDC   EQU   IOPMODF1                                                 04065000
IOPMREFR EQU   IOPMODF1                                                 04066000
IOPMOVLY EQU   IOPMODF1                                                 04067000
IOPMSCTR EQU   IOPMODF1                                                 04068000
IOPMREUS EQU   IOPMODF1                                                 04069000
IOPMRENT EQU   IOPMODF1                                                 04070000
IOPMAPF  EQU   IOPMODF1                                                 04071000
@NM00110 EQU   @NM00108+7                                               04072000
@NM00109 EQU   @NM00108                                                 04073000
@NM00107 EQU   IOPMODDR+17                                              04074000
@NM00106 EQU   @NM00104+7                                               04075000
@NM00105 EQU   @NM00104                                                 04076000
@NM00103 EQU   @NM00100                                                 04077000
@NM00102 EQU   @NM00100                                                 04078000
@NM00101 EQU   @NM00100                                                 04079000
@NM00099 EQU   @NM00098                                                 04080000
@NM00097 EQU   IOPMODDR                                                 04081000
IOPSRIND EQU   IOPSNTRY+8                                               04082000
@NM00096 EQU   IOPSRCST                                                 04083000
IOPSRCND EQU   IOPSRCID                                                 04084000
IOPSRDLB EQU   IOPSRCFX+72                                              04085000
IOPSRSYS EQU   IOPSRCFX+64                                              04086000
@NM00095 EQU   IOPSRCFX+8                                               04087000
@NM00094 EQU   @NM00092+7                                               04088000
@NM00093 EQU   @NM00092                                                 04089000
@NM00091 EQU   IOPSRCDR+18                                              04090000
IOPSRLNG EQU   IOPSRCDR+17                                              04091000
@NM00090 EQU   @NM00088+7                                               04092000
@NM00089 EQU   @NM00088                                                 04093000
@NM00087 EQU   @NM00084                                                 04094000
@NM00086 EQU   @NM00084                                                 04095000
@NM00085 EQU   @NM00084                                                 04096000
@NM00083 EQU   @NM00082                                                 04097000
@NM00081 EQU   IOPSRCDR                                                 04098000
IOPEOFND EQU   IOPEOFNT                                                 04099000
IOPMCTYP EQU   IOPMCIND                                                 04100000
@NM00080 EQU   IOPMACST                                                 04101000
IOPMACND EQU   IOPMACID                                                 04102000
IOPMCDLB EQU   IOPMACFX+72                                              04103000
IOPMCSYS EQU   IOPMACFX+64                                              04104000
@NM00079 EQU   IOPMACFX+8                                               04105000
IOPBUTYP EQU   IOPBUNT+7                                                04106000
IOPBUSMD EQU   IOPBUNT                                                  04107000
@NM00078 EQU   IOPMACDR+18                                              04108000
IOPMCLNG EQU   IOPMACDR+17                                              04109000
IOPFMST  EQU   IOPFMIDE+7                                               04110000
IOPFMID  EQU   IOPFMIDE                                                 04111000
@NM00077 EQU   IOPRMST                                                  04112000
IOPRMASM EQU   IOPRMST                                                  04113000
@NM00076 EQU   IOPRMST                                                  04114000
IOPRMID  EQU   IOPRMIDE                                                 04115000
@NM00075 EQU   IOPMACDR                                                 04116000
IOPLMIND EQU   IOPLNTRY+8                                               04117000
IOPLMDND EQU   IOPSYSLB                                                 04118000
@NM00073 EQU   @NM00071+7                                               04119000
@NM00072 EQU   @NM00071                                                 04120000
@NM00070 EQU   IOPLMDDR+6                                               04121000
@NM00069 EQU   IOPFLGS3                                                 04122000
IOPCHREP EQU   IOPFLGS3                                                 04123000
IOPLINK  EQU   IOPFLGS3                                                 04124000
IOPCOPY  EQU   IOPFLGS3                                                 04125000
@NM00068 EQU   IOPLMDF4                                                 04126000
@NM00067 EQU   IOPLMDF3                                                 04127000
@NM00066 EQU   IOPLMDF2                                                 04128000
IOPPAGA  EQU   IOPLMDF2                                                 04129000
IOPNE    EQU   IOPLMDF2                                                 04130000
@NM00065 EQU   IOPFLGS2                                                 04131000
IOPDC    EQU   IOPFLGS2                                                 04132000
IOPREFR  EQU   IOPFLGS2                                                 04133000
IOPOVLY  EQU   IOPFLGS2                                                 04134000
IOPSCTR  EQU   IOPFLGS2                                                 04135000
IOPREUS  EQU   IOPFLGS2                                                 04136000
IOPRENT  EQU   IOPFLGS2                                                 04137000
IOPAPF   EQU   IOPFLGS2                                                 04138000
@NM00064 EQU   IOPLMDDR                                                 04139000
@NM00063 EQU   IOPASMDR+9                                               04140000
IOPABUTP EQU   IOPABUNT+7                                               04141000
IOPABUPT EQU   IOPABUNT                                                 04142000
IOPNTLVL EQU   IOPASMDR                                                 04143000
IOPUSED  EQU   @NM00062                                                 04144000
IOPTPSEQ EQU   @NM00061+8                                               04145000
IOPVLSER EQU   @NM00061+2                                               04146000
IOPBLKSI EQU   @NM00061                                                 04147000
IOPCQMAX EQU   IOPCQMAP+12                                              04148000
@NM00060 EQU   IOPCQMAP+11                                              04149000
@NM00059 EQU   IOPCQMAP+8                                               04150000
@NM00058 EQU   IOPCQMAP                                                 04151000
IOPPTMAX EQU   IOPCDMAX                                                 04152000
@NM00057 EQU   IOPSCMAP+11                                              04153000
@NM00056 EQU   IOPSCMAP+8                                               04154000
@NM00055 EQU   IOPSCMAP                                                 04155000
@NM00054 EQU   IOPNTMAX+11                                              04156000
@NM00053 EQU   IOPNTMAX+8                                               04157000
@NM00052 EQU   IOPNTMAX                                                 04158000
@NM00051 EQU   IOPDTYPE                                                 04159000
IOPDMOD  EQU   IOPDTYPE                                                 04160000
IOPDJCL  EQU   IOPDTYPE                                                 04161000
IOPDSRC  EQU   IOPDTYPE                                                 04162000
IOPDMAC  EQU   IOPDTYPE                                                 04163000
IOPSDIR  EQU   IOPSPACE+4                                               04164000
IOPSSCND EQU   IOPSPACE+2                                               04165000
IOPSPRIM EQU   IOPSPACE                                                 04166000
IOPDSN   EQU   IOPDYNDT                                                 04167000
IOPNTYPE EQU   IOPSTCMP+17                                              04168000
IOPISEQ3 EQU   IOPINAM3+6                                               04169000
IOPITYP3 EQU   @NM00050+5                                               04170000
IOPIPTF3 EQU   @NM00050                                                 04171000
CCAEND   EQU   HMASMCCA+371                                             04172000
@NM00024 EQU   HMASMCCA+309                                             04173000
CCACURDD EQU   CCAFDSNG+3                                               04174000
CCACURDS EQU   CCAFDSNG+2                                               04175000
@NM00023 EQU   CCAFLAGB                                                 04176000
CCAOUTNG EQU   CCAFLAGB                                                 04177000
CCALOGNG EQU   CCAFLAGB                                                 04178000
CCAFMID  EQU   HMASMCCA+291                                             04179000
CCALSTDS EQU   CCAFCTL+8                                                04180000
CCARPTDS EQU   CCAFCTL+7                                                04181000
CCATIME  EQU   CCAFCTL+4                                                04182000
CCADATE  EQU   CCAFCTL+1                                                04183000
@NM00022 EQU   CCAFLAG9                                                 04184000
CCARVCAN EQU   CCAFLAG9                                                 04185000
CCARVEST EQU   CCAFLAG9                                                 04186000
CCAPTSNJ EQU   CCAFLAG9                                                 04187000
CCASTSNP EQU   CCAFLAG9                                                 04188000
CCAMTSNP EQU   CCAFLAG9                                                 04189000
CCAPTSNP EQU   CCAFLAG9                                                 04190000
@NM00021 EQU   CCAFLAG8                                                 04191000
CCAACDSC EQU   CCAFLAG8                                                 04192000
CCACDSC  EQU   CCAFLAG8                                                 04193000
@NM00020 EQU   CCAFLAG6                                                 04194000
CCAACRUP EQU   CCAFLAG6                                                 04195000
CCACRQUP EQU   CCAFLAG6                                                 04196000
CCAACDUP EQU   CCAFLAG6                                                 04197000
CCACDSUP EQU   CCAFLAG6                                                 04198000
@NM00019 EQU   CCAFLAG5                                                 04199000
@NM00018 EQU   CCAFLAG4                                                 04200000
CCAACRIS EQU   CCAFLAG4                                                 04201000
CCACRQIS EQU   CCAFLAG4                                                 04202000
CCAACDIS EQU   CCAFLAG4                                                 04203000
CCACDSIS EQU   CCAFLAG4                                                 04204000
@NM00017 EQU   CCAFLAG3+1                                               04205000
CCARGNP  EQU   CCAFLAG3+1                                               04206000
CCADISRQ EQU   CCAFLAG3+1                                               04207000
CCAICTOK EQU   CCAFLAG3                                                 04208000
CCADELP  EQU   CCAFLAG3                                                 04209000
CCACMPRS EQU   CCAFLAG3                                                 04210000
CCAZAPP  EQU   CCAFLAG3                                                 04211000
CCALINKP EQU   CCAFLAG3                                                 04212000
CCACOPYP EQU   CCAFLAG3                                                 04213000
CCAASIP  EQU   CCAFLAG3                                                 04214000
CCAUPDP  EQU   CCAFLAG3                                                 04215000
CCAEOSMP EQU   CCAFLAG2                                                 04216000
CCAEOFNC EQU   CCAFLAG2                                                 04217000
@NM00016 EQU   CCAFLAG2                                                 04218000
CCATERM  EQU   CCAFLAG2                                                 04219000
CCASVCLB EQU   CCAFLAG2                                                 04220000
CCANCPTF EQU   CCAFLAG2                                                 04221000
@NM00015 EQU   CCAFLAG1+1                                               04222000
CCAUNL   EQU   CCAFLAG1+1                                               04223000
CCARESET EQU   CCAFLAG1+1                                               04224000
CCALOG   EQU   CCAFLAG1+1                                               04225000
CCACNV   EQU   CCAFLAG1+1                                               04226000
CCALIST  EQU   CCAFLAG1                                                 04227000
CCAUPDU  EQU   CCAFLAG1                                                 04228000
CCAUPDJ  EQU   CCAFLAG1                                                 04229000
CCARES   EQU   CCAFLAG1                                                 04230000
CCAREJ   EQU   CCAFLAG1                                                 04231000
CCAACCPT EQU   CCAFLAG1                                                 04232000
CCAAPPLY EQU   CCAFLAG1                                                 04233000
CCAREC   EQU   CCAFLAG1                                                 04234000
CCAFUNCT EQU   CCAFFUNC                                                 04235000
@NM00014 EQU   @NM00009+18                                              04236000
@NM00013 EQU   @NM00009+16                                              04237000
CCATBLPA EQU   @NM00009+12                                              04238000
@NM00012 EQU   @NM00009+8                                               04239000
@NM00011 EQU   @NM00009+4                                               04240000
@NM00010 EQU   @NM00009                                                 04241000
CCAIFGTP EQU   CCAFGTP+16                                               04242000
CCAGTP3  EQU   CCAFGTP+12                                               04243000
CCAGTP2  EQU   CCAFGTP+8                                                04244000
CCAGTP1  EQU   CCAFGTP+4                                                04245000
CCASETAD EQU   CCASEGTP                                                 04246000
CCACLST  EQU   CCAFPGM+12                                               04247000
CCASPDCB EQU   CCAFPGM+8                                                04248000
CCAICLMD EQU   CCAFICT+12                                               04249000
CCAICMOD EQU   CCAFICT+8                                                04250000
CCAICPTF EQU   CCAFICT+4                                                04251000
CCAICT   EQU   CCAFICT                                                  04252000
CCARVAD  EQU   CCAFSTA                                                  04253000
CCAACDID EQU   CCAFSYS+32                                               04254000
CCACDSID EQU   CCAFSYS+24                                               04255000
CCALNLEN EQU   CCAFSYS+22                                               04256000
@NM00008 EQU   CCAFLAGA                                                 04257000
CCAPSYSF EQU   CCAFLAGA                                                 04258000
CCAASYSF EQU   CCAFLAGA                                                 04259000
CCACSYSF EQU   CCAFLAGA                                                 04260000
CCANUCID EQU   CCAFSYS+20                                               04261000
CCAASREL EQU   CCAFSYS+16                                               04262000
CCACSREL EQU   CCASREL                                                  04263000
CCAPEMAX EQU   CCAFSYS+10                                               04264000
CCAPGLEN EQU   CCAFSYS+8                                                04265000
CCAIOPAS EQU   CCAFSYS+4                                                04266000
CCAIOPCS EQU   CCAFSYS                                                  04267000
CCAPESIZ EQU   CCAFIOP+4                                                04268000
CCAIOPTR EQU   CCAFIOP                                                  04269000
@NM00007 EQU   CCAFLAG7+3                                               04270000
CCALOGP  EQU   CCAFLAG7+2                                               04271000
CCAOUTP  EQU   CCAFLAG7+2                                               04272000
CCASLBP  EQU   CCAFLAG7+2                                               04273000
CCARPTP  EQU   CCAFLAG7+2                                               04274000
CCALISTP EQU   CCAFLAG7+2                                               04275000
CCAJCLP  EQU   CCAFLAG7+2                                               04276000
CCAPTFP  EQU   CCAFLAG7+2                                               04277000
CCATLBP  EQU   CCAFLAG7+2                                               04278000
CCAUT3P  EQU   CCAFLAG7+1                                               04279000
CCAUT2P  EQU   CCAFLAG7+1                                               04280000
CCAUT1P  EQU   CCAFLAG7+1                                               04281000
CCAWK5P  EQU   CCAFLAG7+1                                               04282000
CCAWK4P  EQU   CCAFLAG7+1                                               04283000
CCAWK3P  EQU   CCAFLAG7+1                                               04284000
CCAWK2P  EQU   CCAFLAG7+1                                               04285000
CCAWK1P  EQU   CCAFLAG7+1                                               04286000
CCAACRQP EQU   CCAFLAG7                                                 04287000
CCACRQP  EQU   CCAFLAG7                                                 04288000
CCASTSP  EQU   CCAFLAG7                                                 04289000
CCAMTSP  EQU   CCAFLAG7                                                 04290000
CCAPTSP  EQU   CCAFLAG7                                                 04291000
CCASCDSP EQU   CCAFLAG7                                                 04292000
CCAACDSP EQU   CCAFLAG7                                                 04293000
CCACDSP  EQU   CCAFLAG7                                                 04294000
@NM00006 EQU   CCAFBUFR+122                                             04295000
@NM00005 EQU   CCAFBUFR+120                                             04296000
@NM00004 EQU   CCAFBUFR+118                                             04297000
CCATBFMX EQU   CCAFBUFR+116                                             04298000
CCA4BFMX EQU   CCAFBUFR+114                                             04299000
CCA3BFMX EQU   CCAFBUFR+112                                             04300000
CCA2BFMX EQU   CCAFBUFR+110                                             04301000
CCA1BFMX EQU   CCAFBUFR+108                                             04302000
CCAXBFMX EQU   CCAFBUFR+106                                             04303000
CCAQBFMX EQU   CCAFBUFR+104                                             04304000
CCASBFMX EQU   CCAFBUFR+102                                             04305000
CCAMBFMX EQU   CCAFBUFR+100                                             04306000
CCAPBFMX EQU   CCAFBUFR+98                                              04307000
CCAVBFMX EQU   CCAFBUFR+96                                              04308000
CCAABFMX EQU   CCAFBUFR+94                                              04309000
CCACBFMX EQU   CCAFBUFR+92                                              04310000
@NM00003 EQU   CCAFBUFR+88                                              04311000
@NM00002 EQU   CCAFBUFR+84                                              04312000
CCA4BFSZ EQU   CCAFBUFR+80                                              04313000
CCATBFSZ EQU   CCAFBUFR+76                                              04314000
CCAWBFSZ EQU   CCAFBUFR+72                                              04315000
CCAQBFSZ EQU   CCAFBUFR+68                                              04316000
CCAPBFSZ EQU   CCAFBUFR+64                                              04317000
CCAVBFSZ EQU   CCAFBUFR+60                                              04318000
CCACBFSZ EQU   CCAFBUFR+56                                              04319000
@NM00001 EQU   CCAFBUFR+52                                              04320000
CCA4BFOA EQU   CCAFBUFR+48                                              04321000
CCA4BFIA EQU   CCAFBUFR+44                                              04322000
CCATBFIA EQU   CCAFBUFR+40                                              04323000
CCAWBFOA EQU   CCAFBUFR+36                                              04324000
CCAWBFIA EQU   CCAFBUFR+32                                              04325000
CCAQBFOA EQU   CCAFBUFR+28                                              04326000
CCAQBFIA EQU   CCAFBUFR+24                                              04327000
CCAPBFOA EQU   CCAFBUFR+20                                              04328000
CCAPBFIA EQU   CCAFBUFR+16                                              04329000
CCAVBFOA EQU   CCAFBUFR+12                                              04330000
CCAVBFIA EQU   CCAFBUFR+8                                               04331000
CCACBFOA EQU   CCAFBUFR+4                                               04332000
CCACBFIA EQU   CCAFBUFR                                                 04333000
CCAID    EQU   HMASMCCA                                                 04334000
@NM00181 EQU   NTRYMAP+12                                               04335000
@NM00180 EQU   NTRYMAP+8                                                04336000
IOPBS04E EQU   IOPBS04+2                                                04337000
IOPBAPFC EQU   IOPBAPF+1                                                04338000
IOPBAPFL EQU   IOPBAPF                                                  04339000
IOPBS2NM EQU   IOPBS02+3                                                04340000
IOPBS2EP EQU   IOPBS02                                                  04341000
IOPQSMTP EQU   IOPQSMLS+8                                               04342000
@NM00156 EQU   IOPQSMLS+7                                               04343000
IOPQSMND EQU   IOPQSMNM                                                 04344000
@NM00155 EQU   @NM00154+7                                               04345000
IOPQSMFM EQU   @NM00154                                                 04346000
@NM00074 EQU   IOPLMCTL+17                                              04347000
IOPLMCRD EQU   IOPLMCTL+9                                               04348000
IOPLMCRN EQU   IOPLMCTL+1                                               04349000
IOPLMCC  EQU   IOPLMCTL                                                 04350000
@NM00049 EQU   IOPUSERL                                                 04351000
@NM00048 EQU   IOPUSERL                                                 04352000
IOPALIS  EQU   IOPUSERL                                                 04353000
IOPTTR   EQU   IOPDRMAP+8                                               04354000
IOPINAM2 EQU   IOPINAM+1                                                04355000
IOPITYP2 EQU   IOPITYP                                                  04356000
@NM00047 EQU   HMASMIOP+32                                              04357000
IOPDELDD EQU   IOPDDNAM                                                 04358000
@NM00046 EQU   @NM00043+10                                              04359000
IOPSEQNO EQU   @NM00043+8                                               04360000
@NM00045 EQU   @NM00044+7                                               04361000
IOPPTFNM EQU   @NM00044                                                 04362000
IOPNAM17 EQU   IOPNAME                                                  04363000
CCABMREC EQU   CCABELMT+10                                              04364000
CCABPOS  EQU   CCABMPOS+8                                               04365000
CCABNAME EQU   CCABMPOS                                                 04366000
@NM00042 EQU   CCABLDLM+2                                               04367000
@NM00041 EQU   CCABLDLM                                                 04368000
CCAUPDPM EQU   @NM00039+24                                              04369000
@NM00040 EQU   @NM00039+21                                              04370000
CCARUPDT EQU   CCAUPDRC                                                 04371000
CCAUPDSP EQU   @NM00039+12                                              04372000
CCAUPDTE EQU   @NM00039+8                                               04373000
CCAUPDNM EQU   @NM00039                                                 04374000
CCASUPPM EQU   @NM00037+24                                              04375000
@NM00038 EQU   @NM00037+21                                              04376000
CCARSUP  EQU   CCASUPRC                                                 04377000
CCASUPSP EQU   @NM00037+12                                              04378000
CCAIOSUP EQU   @NM00037+8                                               04379000
CCASUPNM EQU   @NM00037                                                 04380000
CCAZAPPM EQU   @NM00035+24                                              04381000
@NM00036 EQU   @NM00035+21                                              04382000
CCARZAP  EQU   CCAZAPRC                                                 04383000
CCAZAPSP EQU   @NM00035+12                                              04384000
CCASPZAP EQU   @NM00035+8                                               04385000
CCAZAPNM EQU   @NM00035                                                 04386000
CCACOMPM EQU   @NM00033+24                                              04387000
@NM00034 EQU   @NM00033+21                                              04388000
CCARCOMP EQU   CCACOMRC                                                 04389000
CCACOMSP EQU   @NM00033+12                                              04390000
CCACOMRS EQU   @NM00033+8                                               04391000
CCACOMNM EQU   @NM00033                                                 04392000
CCACPYPM EQU   @NM00031+24                                              04393000
@NM00032 EQU   @NM00031+21                                              04394000
CCARCOPY EQU   CCACPYRC                                                 04395000
CCACPYSP EQU   @NM00031+12                                              04396000
CCACOPY  EQU   @NM00031+8                                               04397000
CCACPYNM EQU   @NM00031                                                 04398000
CCAASMPM EQU   @NM00029+24                                              04399000
@NM00030 EQU   @NM00029+21                                              04400000
CCARASM  EQU   CCAASMRC                                                 04401000
CCAASMSP EQU   @NM00029+12                                              04402000
CCAASM   EQU   @NM00029+8                                               04403000
CCAASMNM EQU   @NM00029                                                 04404000
CCALKDPM EQU   @NM00027+24                                              04405000
@NM00028 EQU   @NM00027+21                                              04406000
CCARLINK EQU   CCALKDRC                                                 04407000
CCALKDSP EQU   @NM00027+12                                              04408000
CCALKED  EQU   @NM00027+8                                               04409000
CCALKDNM EQU   @NM00027                                                 04410000
CCAPGMPM EQU   @NM00025+24                                              04411000
@NM00026 EQU   @NM00025+21                                              04412000
CCABPGRC EQU   @NM00025+20                                              04413000
CCABPGSP EQU   @NM00025+12                                              04414000
CCABPGAD EQU   @NM00025+8                                               04415000
CCABPGNM EQU   @NM00025                                                 04416000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      04417000
@RF00522 EQU   @RC00516                                                 04418000
@RF00567 EQU   @RC00561                                                 04419000
@RF00688 EQU   @RC00678                                                 04420000
@ENDDATA EQU   *                                                        04421000
         END   HMASMEIS,(C'PLS2013',0802,78334)                         04422000
