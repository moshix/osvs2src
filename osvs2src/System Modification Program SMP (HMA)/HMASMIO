         TITLE 'HMASMIO - HMASMP INPUT/OUTPUT ROUTINE'                  00001000
HMASMIO  CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'HMASMIO   78.334'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00009000
         BALR  @12,0                                               0001 00010000
@PSTART  LA    @10,4095(,@12)                                      0001 00011000
         LA    @09,4095(,@10)                                      0001 00012000
         LA    @08,4095(,@09)                                      0001 00013000
         USING @PSTART,@12                                         0001 00014000
         USING @PSTART+4095,@10                                    0001 00015000
         USING @PSTART+8190,@09                                    0001 00016000
         USING @PSTART+12285,@08                                   0001 00017000
         MVC   @PC00001(4),0(@01)                                  0001 00018000
JSCBDISP EQU 188                                                        00019000
JSCBAOS1 EQU  72                                                        00020000
JSCBAOS2 EQU 192                                                        00021000
         EJECT                                                          00022000
*                                                                  0325 00023000
*   /*****************************************************************/ 00024000
*   /*                                                               */ 00025000
*   /* CHECK FOR ENTERED BEFORE AND ADJUST SAVE AREAS                */ 00026000
*   /*                                                               */ 00027000
*   /*****************************************************************/ 00028000
*                                                                  0325 00029000
*   IOPPTR=ADDR(PASSIOP);           /* SET UP ADDR OF IOP            */ 00030000
         L     IOPPTR,@PC00001                                     0325 00031000
*   IOENTCNT=IOENTCNT+1;            /* BUMP ENTRY COUNTER            */ 00032000
         SLR   @11,@11                                             0326 00033000
         IC    @11,IOENTCNT                                        0326 00034000
         LA    @11,1(,@11)                                         0326 00035000
         STC   @11,IOENTCNT                                        0326 00036000
*   IF IOENTCNT>DIM(IOSVAREA)       /* EXCEEDED MAX ENTRIES? @ZA12350*/ 00037000
*     THEN                          /* YES - EXIT                    */ 00038000
         CLI   IOENTCNT,6                                          0327 00039000
         BNH   @RF00327                                            0327 00040000
*     DO;                                                          0328 00041000
*       IOENTCNT=IOENTCNT-1;        /* DECR COUNTER          @ZA12350*/ 00042000
         BCTR  @11,0                                               0329 00043000
         STC   @11,IOENTCNT                                        0329 00044000
*       IOPRETRN=IOPIOERR;          /* SET I/O ERROR                 */ 00045000
         MVI   IOPRETRN(IOPPTR),X'10'                              0330 00046000
*       RETURN;                     /* EXIT                          */ 00047000
@EL00001 DS    0H                                                  0331 00048000
@EF00001 DS    0H                                                  0331 00049000
@ER00001 LM    @14,@12,12(@13)                                     0331 00050000
         BR    @14                                                 0331 00051000
*     END;                          /*                       @Z40SP00*/ 00052000
*   R1=ADDR(IOSVAREA(IOENTCNT));    /* SET PTR TO DCLED AREA @ZA12350*/ 00053000
@RF00327 SLR   @11,@11                                             0333 00054000
         IC    @11,IOENTCNT                                        0333 00055000
         LR    @04,@11                                             0333 00056000
         MH    @04,@CH00833                                        0333 00057000
         L     R1,ADIOSAVE                                         0333 00058000
         AL    R1,@CF04235                                         0333 00059000
         LA    R1,IOSVAREA(@04,R1)                                 0333 00060000
*   RFY                                                            0334 00061000
*     SVAREAS BASED(R1);            /*                       @Z40SP00*/ 00062000
*   SVBACK=R13;                     /* CHAIN BACKWARDS               */ 00063000
         ST    R13,SVBACK(,R1)                                     0335 00064000
*   RFY                                                            0336 00065000
*     SVAREAS BASED(R13);                                          0336 00066000
*   SVFWRD=R1;                      /* CHAIN FORWARDS                */ 00067000
         ST    R1,SVFWRD(,R13)                                     0337 00068000
*   R13=R1;                         /* SET UP NEW SAVE AREA          */ 00069000
         LR    R13,R1                                              0338 00070000
*   RFY                                                            0339 00071000
*    (R1) UNRSTD;                                                  0339 00072000
*                                                                  0339 00073000
*   /*****************************************************************/ 00074000
*   /*                                                               */ 00075000
*   /* SAVE EXISTING MGP IN CASE RE-ENTRY FROM MSG FROM IO   @ZA25875*/ 00076000
*   /* INITIALIAZE HMASMMGP AND SAVE IOP BUFFER ADDRESS              */ 00077000
*   /*                                                               */ 00078000
*   /*****************************************************************/ 00079000
*                                                                  0340 00080000
*   SAVDSID(IOENTCNT)=IOPDSID;      /* SAVE DSID             @ZA25875*/ 00081000
         SLR   @04,@04                                             0340 00082000
         IC    @04,IOPDSID(,IOPPTR)                                0340 00083000
         STC   @04,SAVDSID-1(@11)                                  0340 00084000
*   SAVCCADS(IOENTCNT)=CCACURDS;    /* SAVE CURRENT DSID     @Z67SP00*/ 00085000
         L     @03,@CA00038                                        0341 00086000
         SLR   @15,@15                                             0341 00087000
         IC    @15,CCACURDS-HMASMCCA(,@03)                         0341 00088000
         STC   @15,SAVCCADS-1(@11)                                 0341 00089000
*   CCACURDS=IOPDSID;               /* MOVE NEW DSID OVER    @Z67SP00*/ 00090000
         STC   @04,CCACURDS-HMASMCCA(,@03)                         0342 00091000
*   IF IOENTCNT>1                   /* IF RE-ENTRY           @ZA25875*/ 00092000
*     THEN                          /*                       @ZA25875*/ 00093000
         CLI   IOENTCNT,1                                          0343 00094000
         BNH   @RF00343                                            0343 00095000
*     SAVMGP(IOENTCNT-1)=HMASMMGP;  /* SAVE MGP              @ZA25875*/ 00096000
         MH    @11,@CH00033                                        0344 00097000
         LA    @04,SAVMGP-24(@11)                                  0344 00098000
         MVC   0(12,@04),HMASMMGP                                  0344 00099000
*   HMASMMGP=HMASMMGP&&HMASMMGP;    /* CLEAR MSG PARM        @Z40SP00*/ 00100000
@RF00343 XC    HMASMMGP(24),HMASMMGP                               0345 00101000
*   MGPPRINT=ON;                    /*                       @Z67SP00*/ 00102000
*   MGPHLDS=ON;                     /*                       @Z67SP00*/ 00103000
         OI    MGPPRINT,B'10010000'                                0347 00104000
*   IOPRETRN=IOPGOOD;               /* SET RETURN CODE       @ZA25875*/ 00105000
         MVI   IOPRETRN(IOPPTR),X'00'                              0348 00106000
*   IF IOPDSID>IOPNUMDS             /* IF INVALID DSID       @Z67SP00*/ 00107000
*     THEN                          /*                       @Z67SP00*/ 00108000
         CLI   IOPDSID(IOPPTR),42                                  0349 00109000
         BH    @RT00349                                            0349 00110000
*     GO TO BADEXIT;                /* RC=16                 @Z67SP00*/ 00111000
*   IF IOPDSID=IOPWKX               /* IF WKX THEN RESET TO  @Z67SP00*/ 00112000
*     THEN                          /* WK1 THRU WK4          @Z67SP00*/ 00113000
         CLI   IOPDSID(IOPPTR),40                                  0351 00114000
         BNE   @RF00351                                            0351 00115000
*     DO;                           /*                       @Z67SP00*/ 00116000
*       CALL IODSCHCK;              /*                       @Z67SP00*/ 00117000
         BAL   @14,IODSCHCK                                        0353 00118000
*       IF IOPRETRN^=IOPGOOD        /* IF ERR                @Z67SP00*/ 00119000
*         THEN                      /*                       @Z67SP00*/ 00120000
         CLI   IOPRETRN(IOPPTR),0                                  0354 00121000
         BNE   @RT00354                                            0354 00122000
*         GO TO EXIT;               /*                       @Z67SP00*/ 00123000
*     END;                          /*                       @Z67SP00*/ 00124000
         EJECT                                                          00125000
*IOINIT0:                           /*                       @ZA25875*/ 00126000
*                                                                  0357 00127000
*   /*****************************************************************/ 00128000
*   /*                                                               */ 00129000
*   /* IF PREV ERR ON PRINTER THEN NO MSG TO PRINTER AND IF THIS IS  */ 00130000
*   /* WRITE TO PRINTER TRY TO SWITCH WRITE TO LOG           @ZA25875*/ 00131000
*   /*                                                               */ 00132000
*   /*****************************************************************/ 00133000
*                                                                  0357 00134000
*   CCACURDS=IOPDSID;               /* MOVE NEW DSID OVER    @Z67SP00*/ 00135000
@RF00351 DS    0H                                                  0357 00136000
IOINIT0  L     @11,@CA00038                                        0357 00137000
         MVC   CCACURDS-HMASMCCA(1,@11),IOPDSID(IOPPTR)            0357 00138000
*   IF CCAOUTNG=ON                  /* IF PREV ERR TO PRINT  @Z67SP00*/ 00139000
*     THEN                          /*                       @ZA25875*/ 00140000
         TM    CCAOUTNG-HMASMCCA(@11),B'01000000'                  0358 00141000
         BNO   @RF00358                                            0358 00142000
*     DO;                           /*                       @ZA25875*/ 00143000
*       IF IOPDSID=IOPPRINT         /* IF WRITE TO PRINT     @ZA25875*/ 00144000
*         THEN                      /*                       @ZA25875*/ 00145000
         CLI   IOPDSID(IOPPTR),11                                  0360 00146000
         BNE   @RF00360                                            0360 00147000
*         IF CCALOGNG=OFF           /* IF LOG OK             @Z67SP00*/ 00148000
*             &IOPFUNCT=IOPWRITE    /* AND WRITE OPERATION   @ZA25875*/ 00149000
*           THEN                    /*                       @ZA25875*/ 00150000
         TM    CCALOGNG-HMASMCCA(@11),B'10000000'                  0361 00151000
         BNZ   @RF00361                                            0361 00152000
         CLI   IOPFUNCT(IOPPTR),81                                 0361 00153000
         BNE   @RF00361                                            0361 00154000
*           DO;                     /*                       @ZA25875*/ 00155000
*             IOPRETRN=IOPNTOPN;    /* SET RC TO 12          @Z67SP00*/ 00156000
         MVI   IOPRETRN(IOPPTR),X'0C'                              0363 00157000
*             IF PRLHEAD=OFF        /* IF NOT WORKING WITH   @Z67SP00*/ 00158000
*                 &PRLHEADO=OFF     /* HEADINGS              @Z67SP00*/ 00159000
*               THEN                /* THEN SWITCH OUTPUT    @Z67SP00*/ 00160000
         L     @11,IOPBUFAD(,IOPPTR)                               0364 00161000
         TM    PRLHEAD(@11),B'11000000'                            0364 00162000
         BNZ   @RF00364                                            0364 00163000
*               DO;                 /* TO LOG                @Z67SP00*/ 00164000
*                 PRLRLEN=PRLRLEN+LENGTH(HMASMPRL);/*        @ZA25875*/ 00165000
         LA    @04,10                                              0366 00166000
         AH    @04,PRLRLEN(,@11)                                   0366 00167000
         STH   @04,PRLRLEN(,@11)                                   0366 00168000
*                 IOPDSID=IOPHLDS;  /* SWITCH TO LOG         @ZA25875*/ 00169000
         MVI   IOPDSID(IOPPTR),X'01'                               0367 00170000
*               END;                /*                       @Z67SP00*/ 00171000
*             ELSE                  /*                       @Z67SP00*/ 00172000
*               IF PRLBLANK=ON      /* IF WRITE BLANK LINE   @Z67SP00*/ 00173000
*                 THEN              /* THEN NOTHING TO       @Z67SP00*/ 00174000
         B     @RC00364                                            0369 00175000
@RF00364 L     @11,IOPBUFAD(,IOPPTR)                               0369 00176000
         TM    PRLBLANK(@11),B'00100000'                           0369 00177000
         BO    @RT00369                                            0369 00178000
*                 GO TO EXIT;       /* SWITCH TO LOG         @Z67SP00*/ 00179000
*           END;                    /*                       @ZA25875*/ 00180000
*         ELSE                      /*                       @ZA25875*/ 00181000
*           DO;                     /*                       @ZA25875*/ 00182000
         B     @RC00361                                            0372 00183000
@RF00361 DS    0H                                                  0373 00184000
*             IOPRETRN=IOPIOERR;    /*                       @ZA25875*/ 00185000
         MVI   IOPRETRN(IOPPTR),X'10'                              0373 00186000
*             GO TO EXIT;           /*                       @ZA25875*/ 00187000
         B     EXIT                                                0374 00188000
*           END;                    /*                       @ZA25875*/ 00189000
*     END;                          /*                       @ZA25875*/ 00190000
@RC00361 DS    0H                                                  0376 00191000
@RF00360 DS    0H                                                  0377 00192000
         EJECT                                                          00193000
*                                                                  0377 00194000
*   /*****************************************************************/ 00195000
*   /*                                                               */ 00196000
*   /* IF PREV ERR ON LOG THEN NO MSG TO LOG AND IF THIS IS WRITE TO */ 00197000
*   /* LOG TRY TO SWITCH WRITE TO PRINTER                    @ZA25875*/ 00198000
*   /*                                                               */ 00199000
*   /*****************************************************************/ 00200000
*                                                                  0377 00201000
*   IF CCALOGNG=ON                  /* IF PREV LOG ERR       @Z67SP00*/ 00202000
*     THEN                          /*                       @ZA25875*/ 00203000
@RF00358 L     @11,@CA00038                                        0377 00204000
         TM    CCALOGNG-HMASMCCA(@11),B'10000000'                  0377 00205000
         BNO   @RF00377                                            0377 00206000
*     DO;                           /*                       @ZA25875*/ 00207000
*       IF IOPDSID=IOPHLDS          /* IF WRITE TO LOG       @ZA25875*/ 00208000
*         THEN                      /*                       @ZA25875*/ 00209000
         CLI   IOPDSID(IOPPTR),1                                   0379 00210000
         BNE   @RF00379                                            0379 00211000
*         IF CCAOUTNG=OFF           /* IF OK FOR PRINTER     @Z67SP00*/ 00212000
*             &IOPFUNCT=IOPWRITE    /* AND WRITE OPERATION   @ZA25875*/ 00213000
*           THEN                    /*                       @ZA25875*/ 00214000
         TM    CCAOUTNG-HMASMCCA(@11),B'01000000'                  0380 00215000
         BNZ   @RF00380                                            0380 00216000
         CLI   IOPFUNCT(IOPPTR),81                                 0380 00217000
         BNE   @RF00380                                            0380 00218000
*           DO;                     /*                       @ZA25875*/ 00219000
*             PRLRLEN=PRLRLEN-LENGTH(HMASMPRL);/*            @ZA25875*/ 00220000
         L     @11,IOPBUFAD(,IOPPTR)                               0382 00221000
         LH    @04,PRLRLEN(,@11)                                   0382 00222000
         SH    @04,@CH00034                                        0382 00223000
         STH   @04,PRLRLEN(,@11)                                   0382 00224000
*             IOPDSID=IOPPRINT;     /* SWITCH TO PRINTER     @ZA25875*/ 00225000
         MVI   IOPDSID(IOPPTR),X'0B'                               0383 00226000
*             IOPRETRN=IOPNTOPN;    /* SET RC TO 12          @ZA25875*/ 00227000
         MVI   IOPRETRN(IOPPTR),X'0C'                              0384 00228000
*           END;                    /*                       @ZA25875*/ 00229000
*         ELSE                      /* IF PRINT DEAD TOO     @ZA25875*/ 00230000
*           DO;                     /*                       @ZA25875*/ 00231000
         B     @RC00380                                            0386 00232000
@RF00380 DS    0H                                                  0387 00233000
*             IOPRETRN=IOPIOERR;    /* SET BAD RC            @ZA25875*/ 00234000
         MVI   IOPRETRN(IOPPTR),X'10'                              0387 00235000
*             GO TO EXIT;           /*                       @ZA25875*/ 00236000
         B     EXIT                                                0388 00237000
*           END;                    /*                       @ZA25875*/ 00238000
*     END;                          /*                       @ZA25875*/ 00239000
*                                                                  0390 00240000
@RC00380 DS    0H                                                  0390 00241000
@RF00379 DS    0H                                                  0391 00242000
*   /*****************************************************************/ 00243000
*   /*                                                               */ 00244000
*   /* CALL HMASMION TO CONVERT THE PASSED MEMBER NAME TO THE FORM   */ 00245000
*   /* THAT IT IS STORED ON THE SPECIFIED DATA SET           @ZD00008*/ 00246000
*   /*                                                               */ 00247000
*   /*****************************************************************/ 00248000
*                                                                  0391 00249000
*   CALL HMASMION(HMASMIOP);        /*                       @ZD00008*/ 00250000
@RF00377 ST    IOPPTR,@AL00001                                     0391 00251000
         L     @15,@CV03344                                        0391 00252000
         LA    @01,@AL00001                                        0391 00253000
         BALR  @14,@15                                             0391 00254000
*   IF IOPRETRN^=IOPGOOD            /* IF BAD RTN FROM ION   @ZD00008*/ 00255000
*     THEN                          /*                       @ZD00008*/ 00256000
         CLI   IOPRETRN(IOPPTR),0                                  0392 00257000
         BNE   @RT00392                                            0392 00258000
*     GO TO EXIT;                   /* RETURN                @ZD00008*/ 00259000
         EJECT                                                          00260000
*                                                                  0394 00261000
*   /*****************************************************************/ 00262000
*   /*                                                               */ 00263000
*   /* CHECK FOR CLOSE ALL FUNCTION - LOOP CLOSING ALL OPEN FILES    */ 00264000
*   /*                                                               */ 00265000
*   /*****************************************************************/ 00266000
*                                                                  0394 00267000
*   IF IOPFUNCT=IOPCLOSA            /* IS IT CLOSE ALL FUNCTION      */ 00268000
*     THEN                          /* YES - CLOSE                   */ 00269000
         CLI   IOPFUNCT(IOPPTR),87                                 0394 00270000
         BNE   @RF00394                                            0394 00271000
*     DO;                                                          0395 00272000
*       DO OUTIN=IN TO OUT BY 2;    /* LOOP CLOSING INPUT AND OUTPUT    00273000
*                                      DCBS                  @Z67SP00*/ 00274000
         LA    @11,1                                               0396 00275000
         SLR   @04,@04                                             0396 00276000
         IC    @04,IOENTCNT                                        0396 00277000
         LA    @04,INOUT-1(@04)                                    0396 00278000
         STC   @11,OUTIN(,@04)                                     0396 00279000
@DL00396 DS    0H                                                  0397 00280000
*         DO DCBNO=1 TO IOPNUMDS;   /* LOOP THRU ALL DCBS    @Z40SP00*/ 00281000
         LA    @11,1                                               0397 00282000
         STC   @11,DCBNO                                           0397 00283000
@DL00397 DS    0H                                                  0398 00284000
*           DCBPTR=DCBS(DCBNO,OUTIN);/* PICK UP DCB AD               */ 00285000
         SLA   @11,2                                               0398 00286000
         SLR   @04,@04                                             0398 00287000
         IC    @04,IOENTCNT                                        0398 00288000
         LA    @04,INOUT-1(@04)                                    0398 00289000
         SLR   @15,@15                                             0398 00290000
         IC    @15,OUTIN(,@04)                                     0398 00291000
         ALR   @11,@15                                             0398 00292000
         SLA   @11,2                                               0398 00293000
         L     DCBPTR,DCBS-20(@11)                                 0398 00294000
*           IF DCBPTR^=ZERO         /* ANY DCB FOR THIS TYPE @Z40SP00*/ 00295000
*               &DCBOFOPN=ON        /* AND DCB OPENED        @SA72416*/ 00296000
*             THEN                  /* YES                   @SA72416*/ 00297000
         LTR   DCBPTR,DCBPTR                                       0399 00298000
         BZ    @RF00399                                            0399 00299000
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0399 00300000
         BNO   @RF00399                                            0399 00301000
*             DO;                   /*                       @YA07506*/ 00302000
*               GEN(CLOSE ((DCBPTR)));/* CLOSE IT            @SA74327*/ 00303000
         CLOSE ((DCBPTR))                                               00304000
*               IF DCBOFOPN=ON      /* CLOSE FAIL?           @YA07506*/ 00305000
*                 THEN              /* YES                   @YA07506*/ 00306000
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0402 00307000
         BNO   @RF00402                                            0402 00308000
*                 DO;               /* NEED TO WRITE MSG     @Z40SP00*/ 00309000
*                   IF DCBNO=IOPPRINT/* IF PRINTER THEN      @Z40SP00*/ 00310000
*                     THEN          /* SET SO NO MORE MSG    @Z40SP00*/ 00311000
         CLI   DCBNO,11                                            0404 00312000
         BNE   @RF00404                                            0404 00313000
*                     DO;           /*                       @Z67SP00*/ 00314000
*                       CCAOUTNG=ON;/* GO TO SMPOUT          @Z67SP00*/ 00315000
         L     @11,@CA00038                                        0406 00316000
         OI    CCAOUTNG-HMASMCCA(@11),B'01000000'                  0406 00317000
*                       CCATERM=ON; /* STOP SMP AT DRV       @Z67SP00*/ 00318000
         OI    CCATERM-HMASMCCA(@11),B'00100000'                   0407 00319000
*                     END;          /*                       @Z67SP00*/ 00320000
*                   IF DCBNO=IOPHLDS/* IF LOG THEN SET       @Z40SP00*/ 00321000
*                     THEN          /* NO MORE MSG TO        @Z40SP00*/ 00322000
@RF00404 CLI   DCBNO,1                                             0409 00323000
         BNE   @RF00409                                            0409 00324000
*                     DO;           /*                       @Z67SP00*/ 00325000
*                       CCALOGNG=ON;/* SMPLOG                @Z67SP00*/ 00326000
         L     @11,@CA00038                                        0411 00327000
         OI    CCALOGNG-HMASMCCA(@11),B'10000000'                  0411 00328000
*                       CCATERM=ON; /* STOP SMP AT DRV       @Z67SP00*/ 00329000
         OI    CCATERM-HMASMCCA(@11),B'00100000'                   0412 00330000
*                     END;          /*                       @Z67SP00*/ 00331000
*                   MGPTYPE=MGPSEV; /* SET MESSAGE SEV.      @ZD00001*/ 00332000
@RF00409 MVI   MGPTYPE,X'04'                                       0414 00333000
*                   IOPRETRN=IOPNTCLS;/* SET RETURN CODE     @YA07506*/ 00334000
         MVI   IOPRETRN(IOPPTR),X'0C'                              0415 00335000
*                   MGPMGNO1=HMA201I;/* UNABLE TO XXX        @Z40SP00*/ 00336000
         MVC   MGPMGNO1(2),@CH00183                                0416 00337000
*                   MGPVARPT(1)=ADDR(TXTCLOSE);/* CLOSE      @Z40SP00*/ 00338000
         LA    @11,@CC03331                                        0417 00339000
         ST    @11,MGPVARPT                                        0417 00340000
*                   MGPVARPT(2)=ADDR(CCADSIDA(IOPDSID));/*   @Z67SP00*/ 00341000
         SLR   @11,@11                                             0418 00342000
         IC    @11,IOPDSID(,IOPPTR)                                0418 00343000
         SLA   @11,3                                               0418 00344000
         L     @04,@CA00038                                        0418 00345000
         L     @04,CCADSAD-HMASMCCA(,@04)                          0418 00346000
         AL    @04,@CF04239                                        0418 00347000
         LA    @11,CCADSIDA(@11,@04)                               0418 00348000
         ST    @11,MGPVARPT+4                                      0418 00349000
*                   CALL HMASMMSG(HMASMMGP);/* WRITE MSG     @Z40SP00*/ 00350000
         L     @15,@CV03346                                        0419 00351000
         LA    @01,@AL00419                                        0419 00352000
         BALR  @14,@15                                             0419 00353000
*                 END;              /*                       @Z40SP00*/ 00354000
*             END;                  /* END NO DCB OR NOT OPN @Z67SP00*/ 00355000
@RF00402 DS    0H                                                  0422 00356000
*         END;                      /* END CLOSE 1 TYPE GROUP@SA72416*/ 00357000
@RF00399 LA    @11,1                                               0422 00358000
         SLR   @04,@04                                             0422 00359000
         IC    @04,DCBNO                                           0422 00360000
         ALR   @11,@04                                             0422 00361000
         STC   @11,DCBNO                                           0422 00362000
         CH    @11,@CH00374                                        0422 00363000
         BNH   @DL00397                                            0422 00364000
*       END;                        /* END INPUT/OUTPUT LOOP @Z67SP00*/ 00365000
         SLR   @04,@04                                             0423 00366000
         IC    @04,IOENTCNT                                        0423 00367000
         LA    @04,INOUT-1(@04)                                    0423 00368000
         LA    @11,2                                               0423 00369000
         SLR   @03,@03                                             0423 00370000
         IC    @03,OUTIN(,@04)                                     0423 00371000
         ALR   @11,@03                                             0423 00372000
         SLR   @04,@04                                             0423 00373000
         IC    @04,IOENTCNT                                        0423 00374000
         LA    @04,INOUT-1(@04)                                    0423 00375000
         STC   @11,OUTIN(,@04)                                     0423 00376000
         CH    @11,@CH00235                                        0423 00377000
         BNH   @DL00396                                            0423 00378000
*       GO TO EXIT;                 /* RETURN TO CALLER      @YA07506*/ 00379000
         B     EXIT                                                0424 00380000
*     END;                                                         0425 00381000
         EJECT                                                          00382000
*                                                                  0426 00383000
*   /*****************************************************************/ 00384000
*   /*                                                               */ 00385000
*   /* DETERMINE DCB TO USE BASED ON IOPDSID VALUE IN IOP. IF THE    */ 00386000
*   /* DATASET CAN BE FOR INPUT OR OUTPUT DETERMINE MODE BASED ON    */ 00387000
*   /* IOPFUNCT                                                      */ 00388000
*   /*                                                               */ 00389000
*   /*****************************************************************/ 00390000
*                                                                  0426 00391000
*IOINIT:                                                           0426 00392000
*   IF IOPFUNCT<=IOPCLOSE           /* INPUT FUNCTION?       @SA72416*/ 00393000
*     THEN                          /* YES                   @SA72416*/ 00394000
@RF00394 DS    0H                                                  0426 00395000
IOINIT   CLI   IOPFUNCT(IOPPTR),80                                 0426 00396000
         BH    @RF00426                                            0426 00397000
*     OUTIN=IN;                     /* SET TYPE INDX TO INPUT@SA72416*/ 00398000
         SLR   @11,@11                                             0427 00399000
         IC    @11,IOENTCNT                                        0427 00400000
         LA    @11,INOUT-1(@11)                                    0427 00401000
         MVI   OUTIN(@11),X'01'                                    0427 00402000
*   ELSE                            /* MUST BE OUTPUT FUNCT  @SA72416*/ 00403000
*     OUTIN=OUT;                    /* SET TYPE TO OUTPUT    @SA72416*/ 00404000
         B     @RC00426                                            0428 00405000
@RF00426 SLR   @11,@11                                             0428 00406000
         IC    @11,IOENTCNT                                        0428 00407000
         LA    @11,INOUT-1(@11)                                    0428 00408000
         MVI   OUTIN(@11),X'03'                                    0428 00409000
*IOCLOSCK:                                                         0429 00410000
*   DCBPTR=DCBS(IOPDSID,OUTIN);     /* GET PROPER DCB ADDR   @ZA12350*/ 00411000
*                                                                  0429 00412000
@RC00426 DS    0H                                                  0429 00413000
IOCLOSCK SLR   @11,@11                                             0429 00414000
         IC    @11,IOPDSID(,IOPPTR)                                0429 00415000
         SLA   @11,2                                               0429 00416000
         SLR   @04,@04                                             0429 00417000
         IC    @04,IOENTCNT                                        0429 00418000
         LA    @04,INOUT-1(@04)                                    0429 00419000
         SLR   @15,@15                                             0429 00420000
         IC    @15,OUTIN(,@04)                                     0429 00421000
         ALR   @11,@15                                             0429 00422000
         SLA   @11,2                                               0429 00423000
         L     DCBPTR,DCBS-20(@11)                                 0429 00424000
*   /*****************************************************************/ 00425000
*   /*                                                               */ 00426000
*   /* IF OPERATION IS CLOSE THEN CLOSE DCB, BOTH INPUT AND OUTPUT   */ 00427000
*   /* TYPES. IF IT WAS THE CDS DIRECTORY AND THE UPDATE DCB IS OPEN */ 00428000
*   /* CLOSE IT AND OPEN AND CLOSE NORMAL CDS DCB IN ORDER TO RESET  */ 00429000
*   /* SMPCDS LRECL AND BLKSIZE                              @Z40SP00*/ 00430000
*   /*                                                               */ 00431000
*   /*****************************************************************/ 00432000
*                                                                  0430 00433000
*   IF IOPFUNCT=IOPCLOSE            /* IS THIS CLOSE OPERATION?      */ 00434000
*     THEN                          /* YES -                 @SA72416*/ 00435000
         CLI   IOPFUNCT(IOPPTR),80                                 0430 00436000
         BNE   @RF00430                                            0430 00437000
*     DO;                           /* CLOSE THE DCB         @SA72416*/ 00438000
*       IF DCBPTR^=ZERO             /* IS THERE A DCB ADDR   @Z40SP00*/ 00439000
*           &DCBOFOPN=ON            /* AND IS IT OPEN?       @YA07506*/ 00440000
*         THEN                      /* YES - THEN OK TO CLOSE        */ 00441000
         LTR   DCBPTR,DCBPTR                                       0432 00442000
         BZ    @RF00432                                            0432 00443000
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0432 00444000
         BNO   @RF00432                                            0432 00445000
*         DO;                       /*                       @YA07506*/ 00446000
*           GEN(CLOSE ((DCBPTR)));  /* CLOSE THE DCB         @SA72416*/ 00447000
         CLOSE ((DCBPTR))                                               00448000
*           IF DCBOFOPN=ON          /* CLOSE FAIL?           @YA07506*/ 00449000
*             THEN                  /* YES                   @YA07506*/ 00450000
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0435 00451000
         BO    @RT00435                                            0435 00452000
*             GO TO CLOSFAIL;       /* GO WRITE CLOSE MSG    @Z40SP00*/ 00453000
*         END;                      /* END DCB AND OPEN      @YA07506*/ 00454000
*       IF OUTIN=IN                 /* LAST CLOSE FOR INPUT DCB?     */ 00455000
*         THEN                      /* YES                   @SA72416*/ 00456000
@RF00432 SLR   @11,@11                                             0438 00457000
         IC    @11,IOENTCNT                                        0438 00458000
         LA    @11,INOUT-1(@11)                                    0438 00459000
         CLI   OUTIN(@11),1                                        0438 00460000
         BNE   @RF00438                                            0438 00461000
*         DO;                       /* RESET TO DO OUTPUT DCB@SA72416*/ 00462000
*           OUTIN=OUT;              /* SET TYPE INDEX TO OUTPUT      */ 00463000
         MVI   OUTIN(@11),X'03'                                    0440 00464000
*           GO TO IOCLOSCK;         /* GO TO CLOSE IT        @SA72416*/ 00465000
         B     IOCLOSCK                                            0441 00466000
*         END;                      /*                       @SA72416*/ 00467000
*       IF IOPDSID=IOPCDSD          /* IS THIS DIRECT DATA SET?      */ 00468000
*           |IOPDSID=IOPACDSD       /* OR ACDS DIRECTORY     @ZD00006*/ 00469000
*           |IOPDSID=IOPCRQD        /* OR CRQ DIRECTORY      @Z67SP00*/ 00470000
*           |IOPDSID=IOPACRQD       /* OR ACRQ DIRECTORY     @Z67SP00*/ 00471000
*         THEN                      /* CHECK FOR UPDAT OPEN          */ 00472000
@RF00438 CLI   IOPDSID(IOPPTR),8                                   0443 00473000
         BE    @RT00443                                            0443 00474000
         CLI   IOPDSID(IOPPTR),13                                  0443 00475000
         BE    @RT00443                                            0443 00476000
         CLI   IOPDSID(IOPPTR),29                                  0443 00477000
         BE    @RT00443                                            0443 00478000
         CLI   IOPDSID(IOPPTR),31                                  0443 00479000
         BNE   @RF00443                                            0443 00480000
@RT00443 DS    0H                                                  0444 00481000
*         DO;                                                      0444 00482000
*           DCBPTR=ADDIRDCB;        /* POINT TO DIR DCB      @Z40SP01*/ 00483000
         L     DCBPTR,ADDIRDCB                                     0445 00484000
*           IF DCBOFOPN=ON          /* IS IT OPEN?                   */ 00485000
*             THEN                  /* YES - CLOSE IT                */ 00486000
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0446 00487000
         BNO   @RF00446                                            0446 00488000
*             DO;                                                  0447 00489000
*               GEN(CLOSE ((DCBPTR)));/* ISSUE CLOSE         @ZD00003*/ 00490000
         CLOSE ((DCBPTR))                                               00491000
*               IF DCBOFOPN=ON      /* CLOSE FAIL?           @YA07506*/ 00492000
*                 THEN              /* YES                   @YA07506*/ 00493000
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0449 00494000
         BO    @RT00449                                            0449 00495000
*                 GO TO CLOSFAIL;   /* GO WRITE ERR MSG      @Z40SP00*/ 00496000
*                                                                  0450 00497000
*               /*****************************************************/ 00498000
*               /*                                                   */ 00499000
*               /* FOLLOWING CODE IS TO UPDATE THE VTOC WITH CORRECT */ 00500000
*               /* LRECL, BLKSIZE, AND KEY LENGTH                    */ 00501000
*               /*                                                   */ 00502000
*               /*****************************************************/ 00503000
*                                                                  0451 00504000
*               IF IOPDSID=IOPCDSD  /* IF CDS DIRECT         @ZD00004*/ 00505000
*                 THEN              /* THEN POINT TO         @ZD00004*/ 00506000
         CLI   IOPDSID(IOPPTR),8                                   0451 00507000
         BNE   @RF00451                                            0451 00508000
*                 DO;               /*                       @ZD00004*/ 00509000
*                   DSBFMX=CCACBFMX;/* CDS BLK               @ZD00004*/ 00510000
         L     @11,@CA00038                                        0453 00511000
         MVC   DSBFMX(2),CCACBFMX-HMASMCCA(@11)                    0453 00512000
*                   DCBPTR=ADCDODCB;/* CDS OUTPUT DCB        @ZD00004*/ 00513000
         L     DCBPTR,ADCDODCB                                     0454 00514000
*                 END;              /*                       @ZD00004*/ 00515000
*               ELSE                /* ELSE IS ACDS SO POINT @ZD00004*/ 00516000
*                 IF IOPDSID=IOPACDSD/* IF ACDS              @Z67SP00*/ 00517000
*                   THEN            /*                       @Z67SP00*/ 00518000
         B     @RC00451                                            0456 00519000
@RF00451 CLI   IOPDSID(IOPPTR),13                                  0456 00520000
         BNE   @RF00456                                            0456 00521000
*                   DO;             /*                       @ZD00004*/ 00522000
*                     DSBFMX=CCAABFMX;/* ACDS BLK            @ZD00004*/ 00523000
         L     @11,@CA00038                                        0458 00524000
         MVC   DSBFMX(2),CCAABFMX-HMASMCCA(@11)                    0458 00525000
*                     DCBPTR=ADACODCB;/* TO ACDS ODCB        @ZD00004*/ 00526000
         L     DCBPTR,ADACODCB                                     0459 00527000
*                   END;            /*                       @ZD00004*/ 00528000
*                 ELSE              /*                       @Z67SP00*/ 00529000
*                   IF IOPDSID=IOPCRQD/* IF CRQ              @Z67SP00*/ 00530000
*                     THEN          /*                       @Z67SP00*/ 00531000
         B     @RC00456                                            0461 00532000
@RF00456 CLI   IOPDSID(IOPPTR),29                                  0461 00533000
         BNE   @RF00461                                            0461 00534000
*                     DO;           /*                       @Z67SP00*/ 00535000
*                       DSBFMX=CCAQBFMX;/*                   @Z67SP00*/ 00536000
         L     @11,@CA00038                                        0463 00537000
         MVC   DSBFMX(2),CCAQBFMX-HMASMCCA(@11)                    0463 00538000
*                       DCBPTR=ADCQODCB;/*                   @Z67SP00*/ 00539000
         L     DCBPTR,ADCQODCB                                     0464 00540000
*                     END;          /*                       @Z67SP00*/ 00541000
*                   ELSE            /* MUST BE ACRQ          @Z67SP00*/ 00542000
*                     DO;           /*                       @Z67SP00*/ 00543000
         B     @RC00461                                            0466 00544000
@RF00461 DS    0H                                                  0467 00545000
*                       DSBFMX=CCAXBFMX;/*                   @Z67SP00*/ 00546000
         L     @11,@CA00038                                        0467 00547000
         MVC   DSBFMX(2),CCAXBFMX-HMASMCCA(@11)                    0467 00548000
*                       DCBPTR=ADAQODCB;/*                   @Z67SP00*/ 00549000
         L     DCBPTR,ADAQODCB                                     0468 00550000
*                     END;          /*                       @Z67SP00*/ 00551000
*               IF DCBOFOPN=ON      /* IF DCB OPEN           @YA07506*/ 00552000
*                 THEN              /* THEN                  @YA07506*/ 00553000
@RC00461 DS    0H                                                  0470 00554000
@RC00456 DS    0H                                                  0470 00555000
@RC00451 TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0470 00556000
         BNO   @RF00470                                            0470 00557000
*                 GEN(CLOSE ((DCBPTR)));/* INSURE DCB CLOSED @Z67SP00*/ 00558000
         CLOSE ((DCBPTR))                                               00559000
*               DCBBLKSI=DSBFMX*DCBLRECL;/* RESET BLKSIZE TO ORIGINAL   00560000
*                                      BLOCKSIZE. SIZE IS NOW 256. 0472 00561000
*                                      MUST BE RESET TO MULTIPLE OF     00562000
*                                      80                    @Z67SP00*/ 00563000
@RF00470 LH    @11,DSBFMX                                          0472 00564000
         MH    @11,DCBLRECL+72(,DCBPTR)                            0472 00565000
         STH   @11,DCBBLKSI+52(,DCBPTR)                            0472 00566000
*               GEN(OPEN  ((DCBPTR),OUTPUT));/* OPEN DCB     @Z67SP00*/ 00567000
         OPEN  ((DCBPTR),OUTPUT)                                        00568000
*               IF DCBOFOPN=OFF     /* OPEN FAIL?            @YA07506*/ 00569000
*                 THEN              /* YES                   @YA07506*/ 00570000
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0474 00571000
         BZ    @RT00474                                            0474 00572000
*                 GO TO OPENFAIL;   /* WRITE ERR MSG         @Z40SP00*/ 00573000
*               GEN(CLOSE ((DCBPTR)));/* CLOSE IT            @ZD00003*/ 00574000
         CLOSE ((DCBPTR))                                               00575000
*               IF DCBOFOPN=ON      /* CLOSE FAIL?           @YA07506*/ 00576000
*                 THEN              /* YES                   @YA07506*/ 00577000
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0477 00578000
         BO    @RT00477                                            0477 00579000
*                 GO TO CLOSFAIL;   /* GO WRITE ERR MSG      @YA07506*/ 00580000
*             END;                  /* END DCB OPEN GROUP            */ 00581000
*         END;                                                     0480 00582000
@RF00446 DS    0H                                                  0481 00583000
*     END;                          /* END FUNCTION = CLOSE          */ 00584000
@RF00443 DS    0H                                                  0482 00585000
*                                                                  0482 00586000
*   /*****************************************************************/ 00587000
*   /*                                                               */ 00588000
*   /* NOW CHECK TO SEE IF THERE IS ANY PROCESSING TO DO FOR CLOSE   */ 00589000
*   /* OPERATION FOR THE SPECIFIED DATASET. IF SO GO TO ROUTINE ELSE */ 00590000
*   /* GO TO COMMON EXIT                                     @Z67SP00*/ 00591000
*   /*                                                               */ 00592000
*   /*****************************************************************/ 00593000
*                                                                  0482 00594000
*   IF IOPFUNCT=IOPCLOSE            /*                       @Z67SP00*/ 00595000
*     THEN                          /*                       @Z67SP00*/ 00596000
@RF00430 CLI   IOPFUNCT(IOPPTR),80                                 0482 00597000
         BNE   @RF00482                                            0482 00598000
*     IF IOPDSID=IOPCDS             /*                       @Z67SP00*/ 00599000
*         |IOPDSID=IOPACDS          /*                       @Z67SP00*/ 00600000
*         |IOPDSID=IOPSCDS          /*                       @Z67SP00*/ 00601000
*         |IOPDSID=IOPPTS           /*                       @Z67SP00*/ 00602000
*         |IOPDSID=IOPMTS           /*                       @Z67SP00*/ 00603000
*         |IOPDSID=IOPSTS           /*                       @Z67SP00*/ 00604000
*         |IOPDSID=IOPCRQ           /*                       @Z67SP00*/ 00605000
*         |IOPDSID=IOPACRQ          /*                       @Z67SP00*/ 00606000
*         |IOPDSID=IOPWK1           /*                       @Z67SP00*/ 00607000
*         |IOPDSID=IOPWK2           /*                       @Z67SP00*/ 00608000
*         |IOPDSID=IOPWK3           /*                       @Z67SP00*/ 00609000
*         |IOPDSID=IOPWK4           /*                       @Z67SP00*/ 00610000
*         |IOPDSID=IOPWK5           /*                       @Z67SP00*/ 00611000
*       THEN                        /*                       @Z67SP00*/ 00612000
         CLI   IOPDSID(IOPPTR),2                                   0483 00613000
         BE    @RT00483                                            0483 00614000
         CLI   IOPDSID(IOPPTR),12                                  0483 00615000
         BE    @RT00483                                            0483 00616000
         CLI   IOPDSID(IOPPTR),33                                  0483 00617000
         BE    @RT00483                                            0483 00618000
         CLI   IOPDSID(IOPPTR),6                                   0483 00619000
         BE    @RT00483                                            0483 00620000
         CLI   IOPDSID(IOPPTR),18                                  0483 00621000
         BE    @RT00483                                            0483 00622000
         CLI   IOPDSID(IOPPTR),26                                  0483 00623000
         BE    @RT00483                                            0483 00624000
         CLI   IOPDSID(IOPPTR),28                                  0483 00625000
         BE    @RT00483                                            0483 00626000
         CLI   IOPDSID(IOPPTR),30                                  0483 00627000
         BE    @RT00483                                            0483 00628000
         CLI   IOPDSID(IOPPTR),35                                  0483 00629000
         BE    @RT00483                                            0483 00630000
         CLI   IOPDSID(IOPPTR),36                                  0483 00631000
         BE    @RT00483                                            0483 00632000
         CLI   IOPDSID(IOPPTR),37                                  0483 00633000
         BE    @RT00483                                            0483 00634000
         CLI   IOPDSID(IOPPTR),38                                  0483 00635000
         BE    @RT00483                                            0483 00636000
         CLI   IOPDSID(IOPPTR),39                                  0483 00637000
         BNE   @RF00483                                            0483 00638000
@RT00483 DS    0H                                                  0484 00639000
*       GO TO IOROUT;               /* NEED CLOSE LOGIC      @Z67SP00*/ 00640000
         SLR   @11,@11                                             0484 00641000
         IC    @11,IOPDSID(,IOPPTR)                                0484 00642000
         SLA   @11,2                                               0484 00643000
         L     @11,IOHNDLRS-4(@11)                                 0484 00644000
         BR    @11                                                 0484 00645000
*     ELSE                          /*                       @Z67SP00*/ 00646000
*       GO TO GOODEXIT;             /*                       @Z67SP00*/ 00647000
         EJECT                                                          00648000
*                                                                  0486 00649000
*   /*****************************************************************/ 00650000
*   /*                                                               */ 00651000
*   /* IF IOPDSID=IOPDDNM OR IOPDSID=IOPTXTDD INSURE THAT DCB IS     */ 00652000
*   /* OPENED FOR THE CORRECT DDNAME                         @Z30XX9J*/ 00653000
*   /*                                                               */ 00654000
*   /*****************************************************************/ 00655000
*                                                                  0486 00656000
*   IF(IOPDSID=IOPDDNM              /* USING ANY DD CARD?    @Z30XX9J*/ 00657000
*       |IOPDSID=IOPTXTDD           /* OR TEXTLIB DD         @Z40SP00*/ 00658000
*       |IOPDSID=IOPANYDD)          /* OR OTHER VARIABLE DD  @Z40SP00*/ 00659000
*       &(DCBOFOPN=OFF              /* AND IF EITHER THE DCB IS    0486 00660000
*                                      CLOSED                @Z40SP00*/ 00661000
*       |((IOPFUNCT<IOPCLOSE&       /* OR IF OPEN AND INPUT  @Z40SP00*/ 00662000
*       IOPDDNAM^=LASTDDI)          /* AND NOT SAME AS LAST INPUT OR    00663000
*                                                            @Z40SP00*/ 00664000
*       |(IOPFUNCT>IOPCLOSE&        /* OR IF OPEN AND OUTPT  @Z40SP00*/ 00665000
*       IOPDDNAM^=LASTDDO)))        /* AND NOT SAME DDNAME AS LAST 0486 00666000
*                                      OUTPUT                @Z40SP00*/ 00667000
*     THEN                          /* IF CONDITION MET      @Z30XX9J*/ 00668000
@RF00482 CLI   IOPDSID(IOPPTR),14                                  0486 00669000
         BE    @GL00020                                            0486 00670000
         CLI   IOPDSID(IOPPTR),24                                  0486 00671000
         BE    @GL00020                                            0486 00672000
         CLI   IOPDSID(IOPPTR),24                                  0486 00673000
         BNE   @RF00486                                            0486 00674000
@GL00020 TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0486 00675000
         BZ    @RT00486                                            0486 00676000
         CLI   IOPFUNCT(IOPPTR),80                                 0486 00677000
         BNL   @GL00024                                            0486 00678000
         CLC   IOPDDNAM(8,IOPPTR),LASTDDI                          0486 00679000
         BNE   @RT00486                                            0486 00680000
@GL00024 CLI   IOPFUNCT(IOPPTR),80                                 0486 00681000
         BNH   @RF00486                                            0486 00682000
         CLC   IOPDDNAM(8,IOPPTR),LASTDDO                          0486 00683000
         BE    @RF00486                                            0486 00684000
@RT00486 DS    0H                                                  0487 00685000
*     DO;                           /*                       @Z30XX9J*/ 00686000
*       IF DCBOFOPN=ON              /* DCB OPEN?             @Z30XX9J*/ 00687000
*         THEN                      /* YES                   @Z30XX9J*/ 00688000
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0488 00689000
         BNO   @RF00488                                            0488 00690000
*         DO;                       /*                       @YA07506*/ 00691000
*           GEN(CLOSE  ((DCBPTR))); /* CLOSE IT              @Z30XX9J*/ 00692000
         CLOSE  ((DCBPTR))                                              00693000
*           IF DCBOFOPN=ON          /* CLOSE FAIL?           @YA07506*/ 00694000
*             THEN                  /* YES                   @YA07506*/ 00695000
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0491 00696000
         BO    @RT00491                                            0491 00697000
*             GO TO CLOSFAIL;       /* GO WRITE ERR MSG      @Z40SP00*/ 00698000
*         END;                      /* END DCB WAS OPENED    @YA07506*/ 00699000
*       DCBDSORG=INITDSRG;          /* ZERO DSORG            @Z30XX9J*/ 00700000
@RF00488 MVC   DCBDSORG+16(2,DCBPTR),INITDSRG                      0494 00701000
*       DCBRECFM=ZERO;              /* RECORD FORMAT         @Z40SP00*/ 00702000
         MVI   DCBRECFM+28(DCBPTR),X'00'                           0495 00703000
*       DCBLRECL=ZERO;              /* LRECL AND             @Z40SP00*/ 00704000
         SLR   @11,@11                                             0496 00705000
         STH   @11,DCBLRECL+72(,DCBPTR)                            0496 00706000
*       DCBBLKSI=ZERO;              /* BLKSIZE               @Z40SP00*/ 00707000
         STH   @11,DCBBLKSI+52(,DCBPTR)                            0497 00708000
*       DCBDDNAM=IOPDDNAM;          /* SET NEW DDNAME IN DCB @Z40SP00*/ 00709000
         MVC   DCBDDNAM+40(8,DCBPTR),IOPDDNAM(IOPPTR)              0498 00710000
*       IF IOPFUNCT<IOPCLOSE        /* INPUT REQUEST?        @Z40SP00*/ 00711000
*         THEN                      /* YES                   @Z40SP00*/ 00712000
         CLI   IOPFUNCT(IOPPTR),80                                 0499 00713000
         BNL   @RF00499                                            0499 00714000
*         LASTDDI=IOPDDNAM;         /* SET NEW INPUT DDNAME  @Z40SP00*/ 00715000
         MVC   LASTDDI(8),IOPDDNAM(IOPPTR)                         0500 00716000
*       ELSE                        /* MUST BE OUTPUT        @Z40SP00*/ 00717000
*         LASTDDO=IOPDDNAM;         /* SET NEW OUTPUT DDNAME @Z40SP00*/ 00718000
         B     @RC00499                                            0501 00719000
@RF00499 MVC   LASTDDO(8),IOPDDNAM(IOPPTR)                         0501 00720000
*     END;                          /* END IOPDSID=IOPDDNM   @Z30XX9J*/ 00721000
*                                                                  0502 00722000
@RC00499 DS    0H                                                  0503 00723000
*   /*****************************************************************/ 00724000
*   /*                                                               */ 00725000
*   /* IF DATA SET IS FOR COMPRESS,TEXTLIB, OR OTHER NON-DEFINED DATA*/ 00726000
*   /* SETS THEN SAVE DD NAME IN APPROPRIATE SAVE AREA       @Z40SP00*/ 00727000
*   /*                                                               */ 00728000
*   /*****************************************************************/ 00729000
*                                                                  0503 00730000
*   IF IOPDSID=IOPDDNM              /* DD FOR COMPRESS?      @Z40SP00*/ 00731000
*       |IOPDSID=IOPTXTDD           /* OR FOR TEXTLIB?       @Z40SP00*/ 00732000
*       |IOPDSID=IOPANYDD           /* OR OTHER UN-DEFINED   @Z40SP00*/ 00733000
*     THEN                          /* YES                   @Z40SP00*/ 00734000
@RF00486 CLI   IOPDSID(IOPPTR),14                                  0503 00735000
         BE    @RT00503                                            0503 00736000
         CLI   IOPDSID(IOPPTR),24                                  0503 00737000
         BE    @RT00503                                            0503 00738000
         CLI   IOPDSID(IOPPTR),24                                  0503 00739000
         BNE   @RF00503                                            0503 00740000
@RT00503 DS    0H                                                  0504 00741000
*     DO;                           /*                       @Z67SP00*/ 00742000
*       CCADSIDA(IOPDSID)=IOPDDNAM; /* IN DD ARRAY           @Z40SP00*/ 00743000
         SLR   @11,@11                                             0505 00744000
         IC    @11,IOPDSID(,IOPPTR)                                0505 00745000
         SLA   @11,3                                               0505 00746000
         L     @04,@CA00038                                        0505 00747000
         L     @03,CCADSAD-HMASMCCA(,@04)                          0505 00748000
         ALR   @03,@11                                             0505 00749000
         AL    @03,@CF04239                                        0505 00750000
         MVC   CCADSIDA(8,@03),IOPDDNAM(IOPPTR)                    0505 00751000
*       CCACURDD=IOPDDNAM;          /* MOVE DDNAME OVER      @Z67SP00*/ 00752000
         MVC   CCACURDD-HMASMCCA(8,@04),IOPDDNAM(IOPPTR)           0506 00753000
*     END;                          /*                       @Z67SP00*/ 00754000
*                                                                  0508 00755000
*   /*****************************************************************/ 00756000
*   /*                                                               */ 00757000
*   /* IF DATA SET IS MACRO LIBRARY INSURE THAT DCB IS OPEN FOR      */ 00758000
*   /* CORRECT DDNAME                                        @Z40SP00*/ 00759000
*   /*                                                               */ 00760000
*   /*****************************************************************/ 00761000
*                                                                  0508 00762000
*   IF IOPDSID=IOPMACL              /* MACRO LIBRARY?        @Z40SP00*/ 00763000
*       &CCADSIDA(IOPMACL)^=IOPDDNAM/* AND NOT SAME DDNAME THAT DCB     00764000
*                                      IS OPEN FOR           @Z67SP00*/ 00765000
*     THEN                          /* NO                    @Z40SP00*/ 00766000
@RF00503 CLI   IOPDSID(IOPPTR),5                                   0508 00767000
         BNE   @RF00508                                            0508 00768000
         L     @11,@CA00038                                        0508 00769000
         L     @11,CCADSAD-HMASMCCA(,@11)                          0508 00770000
         CLC   CCADSIDA+32(8,@11),IOPDDNAM(IOPPTR)                 0508 00771000
         BE    @RF00508                                            0508 00772000
*     DO;                           /* CLOSE MACRO LIB DCB   @Z40SP00*/ 00773000
*       IF DCBOFOPN=ON              /* DCB OPEN              @Z40SP00*/ 00774000
*         THEN                      /* YES                   @Z40SP00*/ 00775000
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0510 00776000
         BNO   @RF00510                                            0510 00777000
*         DO;                       /*                       @Z40SP00*/ 00778000
*           GEN(CLOSE  ((DCBPTR))); /* CLOSE DCB             @Z40SP00*/ 00779000
         CLOSE  ((DCBPTR))                                              00780000
*           IF DCBOFOPN=ON          /* CLOSE FAIL?           @YA07506*/ 00781000
*             THEN                  /* YES                   @YA07506*/ 00782000
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0513 00783000
         BO    @RT00513                                            0513 00784000
*             GO TO CLOSFAIL;       /* GO WRITE MSG          @YA07506*/ 00785000
*         END;                      /* END DCB WAS OPENED    @YA07506*/ 00786000
*       DCBDDNAM=IOPDDNAM;          /* SET NEW DD NAME       @Z40SP00*/ 00787000
@RF00510 MVC   DCBDDNAM+40(8,DCBPTR),IOPDDNAM(IOPPTR)              0516 00788000
*       CCADSIDA(IOPMACL)=IOPDDNAM; /* SAVE NEW MAC DD       @Z67SP00*/ 00789000
         L     @11,@CA00038                                        0517 00790000
         L     @04,CCADSAD-HMASMCCA(,@11)                          0517 00791000
         MVC   CCADSIDA+32(8,@04),IOPDDNAM(IOPPTR)                 0517 00792000
*       CCACURDD=IOPDDNAM;          /* MOVE DDNAME OVER      @Z67SP00*/ 00793000
         MVC   CCACURDD-HMASMCCA(8,@11),IOPDDNAM(IOPPTR)           0518 00794000
*     END;                          /* END MAC DSID          @Z40SP00*/ 00795000
*                                                                  0519 00796000
*   /*****************************************************************/ 00797000
*   /*                                                               */ 00798000
*   /* IF DATA SET IS SOURCE LIBRARY INSURE THAT DCB IS OPEN FOR     */ 00799000
*   /* CORRECT DDNAME                                        @Z40SP00*/ 00800000
*   /*                                                               */ 00801000
*   /*****************************************************************/ 00802000
*                                                                  0520 00803000
*   IF IOPDSID=IOPSRCL              /* SOURCE LIBRARY?       @Z40SP00*/ 00804000
*       &CCADSIDA(IOPSRCL)^=IOPDDNAM/* AND NOT SAME DDNAME THAT DCB     00805000
*                                      IS OPEN FOR           @Z40SP00*/ 00806000
*     THEN                          /* NO                    @Z40SP00*/ 00807000
@RF00508 CLI   IOPDSID(IOPPTR),22                                  0520 00808000
         BNE   @RF00520                                            0520 00809000
         L     @11,@CA00038                                        0520 00810000
         L     @11,CCADSAD-HMASMCCA(,@11)                          0520 00811000
         CLC   CCADSIDA+168(8,@11),IOPDDNAM(IOPPTR)                0520 00812000
         BE    @RF00520                                            0520 00813000
*     DO;                           /* CLOSE SOURCE LIB DCB  @Z40SP00*/ 00814000
*       IF DCBOFOPN=ON              /* DCB OPEN              @Z40SP00*/ 00815000
*         THEN                      /* YES                   @Z40SP00*/ 00816000
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0522 00817000
         BNO   @RF00522                                            0522 00818000
*         DO;                       /*                       @Z40SP00*/ 00819000
*           GEN(CLOSE  ((DCBPTR))); /* CLOSE DCB             @Z40SP00*/ 00820000
         CLOSE  ((DCBPTR))                                              00821000
*           IF DCBOFOPN=ON          /* CLOSE FAIL?           @YA07506*/ 00822000
*             THEN                  /* YES                   @YA07506*/ 00823000
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0525 00824000
         BO    @RT00525                                            0525 00825000
*             GO TO CLOSFAIL;       /* GO WRITE ERR MSG      @YA07506*/ 00826000
*         END;                      /* END DCB WAS OPENED    @YA07506*/ 00827000
*       DCBDDNAM=IOPDDNAM;          /* SET NEW DD NAME       @Z40SP00*/ 00828000
@RF00522 MVC   DCBDDNAM+40(8,DCBPTR),IOPDDNAM(IOPPTR)              0528 00829000
*       CCADSIDA(IOPSRCL)=IOPDDNAM; /* SAVE NEW SRC DD       @Z67SP00*/ 00830000
         L     @11,@CA00038                                        0529 00831000
         L     @04,CCADSAD-HMASMCCA(,@11)                          0529 00832000
         MVC   CCADSIDA+168(8,@04),IOPDDNAM(IOPPTR)                0529 00833000
*       CCACURDD=IOPDDNAM;          /* MOVE DDNAME OVER      @Z67SP00*/ 00834000
         MVC   CCACURDD-HMASMCCA(8,@11),IOPDDNAM(IOPPTR)           0530 00835000
*     END;                          /* END SOURCE DSID       @Z40SP00*/ 00836000
*                                                                  0532 00837000
*   /*****************************************************************/ 00838000
*   /*                                                               */ 00839000
*   /* IF FUNCTION WAS TO CHANGE A DD FROM MEMBER OF PDS BACK TO A   */ 00840000
*   /* REAL PDS THEN COPY SAVED JFCB INTO WORK JFCB AREA     @Z40SP00*/ 00841000
*   /*                                                               */ 00842000
*   /*****************************************************************/ 00843000
*                                                                  0532 00844000
*   SKIPRDJF=OFF;                   /* SET TO DO RDJFCB      @Z40SP00*/ 00845000
@RF00520 NI    SKIPRDJF,B'11011111'                                0532 00846000
*   IF IOPDSID=IOPJFCB              /* REQUEST FOR JFCB ?    @Z40SP00*/ 00847000
*     THEN                          /* YES                   @Z40SP00*/ 00848000
         CLI   IOPDSID(IOPPTR),25                                  0533 00849000
         BNE   @RF00533                                            0533 00850000
*     DO;                           /* YES                   @Z40SP00*/ 00851000
*       DCBDDNAM=IOPDDNAM;          /* SET DCB DDNAME        @Z40SP00*/ 00852000
         MVC   DCBDDNAM+40(8,DCBPTR),IOPDDNAM(IOPPTR)              0535 00853000
*       CCADSIDA(IOPJFCB)=IOPDDNAM; /* SAVE NAME IN CASE ERR @Z67SP00*/ 00854000
         L     @11,@CA00038                                        0536 00855000
         L     @04,CCADSAD-HMASMCCA(,@11)                          0536 00856000
         MVC   CCADSIDA+192(8,@04),IOPDDNAM(IOPPTR)                0536 00857000
*       CCACURDD=IOPDDNAM;          /* MOVE DDNAME OVER      @Z67SP00*/ 00858000
         MVC   CCACURDD-HMASMCCA(8,@11),IOPDDNAM(IOPPTR)           0537 00859000
*       IF IOPFUNCT=IOPJFCBP        /* CHANGE BACK TO PDS?   @Z40SP00*/ 00860000
*         THEN                      /* YES                   @Z40SP00*/ 00861000
         CLI   IOPFUNCT(IOPPTR),6                                  0538 00862000
         BNE   @RF00538                                            0538 00863000
*         DO;                       /* SET SW TO SKIP RDJFCB @Z40SP00*/ 00864000
*           SKIPRDJF=ON;            /* ALREADY HAVE SAVED    @Z40SP00*/ 00865000
         OI    SKIPRDJF,B'00100000'                                0540 00866000
*           IF JFCB01NM=IOPDDNAM    /* IF SAVED IN 01 JFCB   @Z67SP00*/ 00867000
*             THEN                  /* THEN RESTORE THAT     @Z67SP00*/ 00868000
         CLC   JFCB01NM(8),IOPDDNAM(IOPPTR)                        0541 00869000
         BNE   @RF00541                                            0541 00870000
*             DO;                   /*                       @Z67SP00*/ 00871000
*               JFCBAREA=ADJFCB01->JFCBAREA;/* TO TEMP ONE   @Z67SP00*/ 00872000
         L     @11,JFCBPTR                                         0543 00873000
         L     @04,ADJFCB01                                        0543 00874000
         MVC   JFCBAREA(176,@11),JFCBAREA(@04)                     0543 00875000
*               JFCB01NM(1)=BLANK;  /* JFCB NOW FREE         @Z67SP00*/ 00876000
         MVI   JFCB01NM,C' '                                       0544 00877000
*             END;                  /*                       @Z67SP00*/ 00878000
*           ELSE                    /* IF NOT SAVED IN 01    @Z67SP00*/ 00879000
*             IF JFCB02NM=IOPDDNAM  /* IF SAVED IN 02        @Z67SP00*/ 00880000
*               THEN                /* SO RESTORE THAT ONE   @Z67SP00*/ 00881000
         B     @RC00541                                            0546 00882000
@RF00541 CLC   JFCB02NM(8),IOPDDNAM(IOPPTR)                        0546 00883000
         BNE   @RF00546                                            0546 00884000
*               DO;                 /*                       @Z67SP00*/ 00885000
*                 JFCBAREA=ADJFCB02->JFCBAREA;/* TO TEMP AREA      0548 00886000
*                                                            @Z67SP00*/ 00887000
         L     @11,JFCBPTR                                         0548 00888000
         L     @04,ADJFCB02                                        0548 00889000
         MVC   JFCBAREA(176,@11),JFCBAREA(@04)                     0548 00890000
*                 JFCB02NM(1)=BLANK;/* JFCB NOW FREE         @Z67SP00*/ 00891000
         MVI   JFCB02NM,C' '                                       0549 00892000
*               END;                /*                       @Z67SP00*/ 00893000
*             ELSE                  /* ELSE                  @Z67SP00*/ 00894000
*               GO TO BADEXIT;      /* INTERNAL ERROR        @Z67SP00*/ 00895000
*           JFCBOPSW=ON;            /*                       @Z67SP00*/ 00896000
@RC00541 L     @11,JFCBPTR                                         0552 00897000
         OI    JFCBOPSW(@11),B'10000000'                           0552 00898000
*           JFCNWRIT=OFF;           /*                       @Z67SP00*/ 00899000
         NI    JFCNWRIT(@11),B'11110111'                           0553 00900000
*           JFCBELNM=' ';           /* BLANK ELEMENT NAME    @Z67SP00*/ 00901000
         MVI   JFCBELNM+1(@11),C' '                                0554 00902000
         MVC   JFCBELNM+2(6,@11),JFCBELNM+1(@11)                   0554 00903000
         MVI   JFCBELNM(@11),C' '                                  0554 00904000
*         END;                      /* END END CHANGE BACK   @Z40SP00*/ 00905000
*     END;                          /* END JFCB FUNCTION     @Z40SP00*/ 00906000
@RF00538 DS    0H                                                  0557 00907000
         EJECT                                                          00908000
*                                                                  0557 00909000
*   /*****************************************************************/ 00910000
*   /*                                                               */ 00911000
*   /* CHECK IF PROPER DCB IS OPEN, AND EXIT TO PROPER ROUTINE       */ 00912000
*   /*                                                               */ 00913000
*   /*****************************************************************/ 00914000
*                                                                  0557 00915000
*   IF DCBOFOPN=OFF                 /* IS THE DCB OPEN?      @Z40SP00*/ 00916000
*     THEN                          /* NO - MUST OPEN IT             */ 00917000
@RF00533 TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0557 00918000
         BNZ   @RF00557                                            0557 00919000
*     DO;                           /* GET LIST FORM OPEN    @Z40SP00*/ 00920000
*                                                                  0558 00921000
*       /*************************************************************/ 00922000
*       /*                                                           */ 00923000
*       /* IF FUNCTION WAS OPEN OR THE DATA SET WAS THE CDS OR       */ 00924000
*       /* REQUEST WAS FOR A JFCB MODIFICATION THEN ISSUE RDJFCB     */ 00925000
*       /* BEFORE OPEN TO PREVENT DD STATEMENT MISSING MESSAGE AND TO*/ 00926000
*       /* DO ANY MODIFICATIONS ALREADY SET UP IF IT WAS THE CDS THEN*/ 00927000
*       /* INSURE THAT DATA SET WILL BE OPENED WITH DISP=OLD @Z40SP00*/ 00928000
*       /*                                                           */ 00929000
*       /*************************************************************/ 00930000
*                                                                  0559 00931000
*       RFY                                                        0559 00932000
*         R1 RSTD;                                                 0559 00933000
*       IF IOPFUNCT=IOPOPEN         /* IS THIS SPECIFIC OPEN?        */ 00934000
*           |IOPDSID=IOPJFCB        /* OR JFCB CHANGE        @Z40SP00*/ 00935000
*           |IOPDSID=IOPPTFIN       /* OR PTFIN              @Z67SP00*/ 00936000
*           |IOPDSID=IOPLRF         /* OR LRF                @Z67SP00*/ 00937000
*         THEN                      /* YES - RDJFCB FIRST            */ 00938000
         CLI   IOPFUNCT(IOPPTR),0                                  0560 00939000
         BE    @RT00560                                            0560 00940000
         CLI   IOPDSID(IOPPTR),25                                  0560 00941000
         BE    @RT00560                                            0560 00942000
         CLI   IOPDSID(IOPPTR),10                                  0560 00943000
         BE    @RT00560                                            0560 00944000
         CLI   IOPDSID(IOPPTR),32                                  0560 00945000
         BNE   @RF00560                                            0560 00946000
@RT00560 DS    0H                                                  0561 00947000
*         DO;                                                      0561 00948000
*                                                                  0561 00949000
*           /*********************************************************/ 00950000
*           /*                                                       */ 00951000
*           /* IF SW NOT SET TO SKIP OVER RDJFCB, ISSUE RDJFCB TO    */ 00952000
*           /* INSURE THAT DD CARD IS PRESENT BEFORE OPEN TYPE=J     */ 00953000
*           /*                                               @Z40SP00*/ 00954000
*           /*                                                       */ 00955000
*           /*********************************************************/ 00956000
*                                                                  0562 00957000
*           IF SKIPRDJF=OFF         /* WAS SW SET TO SKIP RDJFCB FOR    00958000
*                                      CHANGE JFCB TYPES     @Z40SP00*/ 00959000
*             THEN                  /* NO                    @Z40SP00*/ 00960000
         TM    SKIPRDJF,B'00100000'                                0562 00961000
         BNZ   @RF00562                                            0562 00962000
*             DO;                   /* RDJFCB TO CHECK DD    @Z40SP00*/ 00963000
*                                                                  0563 00964000
*               /*****************************************************/ 00965000
*               /*                                                   */ 00966000
*               /* IF REQUEST FOR PTFIN DCB OPEN FOR FILE 1 (SYSMODS)*/ 00967000
*               /* THEN COPY QSAM PTFIN DCB TO DCB TO BE USED. THEN  */ 00968000
*               /* ISSUE READ JFCB MACRO                             */ 00969000
*               /*                                                   */ 00970000
*               /*****************************************************/ 00971000
*                                                                  0564 00972000
*               IF IOPDSID=IOPPTFIN /* IF PTFIN              @Z67SP00*/ 00973000
*                   &IOPSEQNO=1     /* FILE 1                @Z67SP00*/ 00974000
*                 THEN              /*                       @Z67SP00*/ 00975000
         CLI   IOPDSID(IOPPTR),10                                  0564 00976000
         BNE   @RF00564                                            0564 00977000
         CLC   IOPSEQNO(2,IOPPTR),@CH00088                         0564 00978000
         BNE   @RF00564                                            0564 00979000
*                 DO;               /*                       @Z67SP00*/ 00980000
*                   LENDCB=ADPTFND-ADPTFDCB;/* DCB LENGTH    @Z67SP00*/ 00981000
         L     @11,ADPTFDCB                                        0566 00982000
         L     @04,ADPTFND                                         0566 00983000
         SLR   @04,@11                                             0566 00984000
         STH   @04,LENDCB                                          0566 00985000
*                   ADPTFDCB->IHADCB(1:LENDCB)=ADSVPTF->IHADCB(1:LENDCB 00986000
*                       );          /* MOVE IT               @Z67SP00*/ 00987000
         BCTR  @04,0                                               0567 00988000
         L     @03,ADSVPTF                                         0567 00989000
         EX    @04,@SM04242                                        0567 00990000
*                 END;              /*                       @Z67SP00*/ 00991000
*               JFCBDSNM(1)=BLANK;  /* RESET NAME IN JFCB            */ 00992000
@RF00564 L     @11,JFCBPTR                                         0569 00993000
         MVI   JFCBDSNM(@11),C' '                                  0569 00994000
*               R1=DCBS(IOPDSID,OUTIN+1);/* OPEN LST FRM AD  @ZA12350*/ 00995000
         SLR   @11,@11                                             0570 00996000
         IC    @11,IOPDSID(,IOPPTR)                                0570 00997000
         SLA   @11,2                                               0570 00998000
         SLR   @04,@04                                             0570 00999000
         IC    @04,IOENTCNT                                        0570 01000000
         LA    @04,INOUT-1(@04)                                    0570 01001000
         SLR   @03,@03                                             0570 01002000
         IC    @03,OUTIN(,@04)                                     0570 01003000
         ALR   @11,@03                                             0570 01004000
         SLA   @11,2                                               0570 01005000
         L     R1,DCBS-16(@11)                                     0570 01006000
*               GEN(RDJFCB MF=(E,(1)));/* READ JFCB INTO STORAGE     */ 01007000
         RDJFCB MF=(E,(1))                                              01008000
*               IF JFCBDSNM(1)=BLANK/* DD CARD PRESENT?      @Z40SP00*/ 01009000
*                 THEN              /* NO - INDICATE CANT OPEN       */ 01010000
         L     @11,JFCBPTR                                         0572 01011000
         CLI   JFCBDSNM(@11),C' '                                  0572 01012000
         BNE   @RF00572                                            0572 01013000
*                 DO;                                              0573 01014000
*                   IOPRETRN=IOPNTOPN;/* SET BAD RTN CODE    @Z40SP00*/ 01015000
         MVI   IOPRETRN(IOPPTR),X'0C'                              0574 01016000
*                   IF IOPFUNCT=IOPOPEN/* IF OPEN REQUEST    @Z67SP00*/ 01017000
*                     THEN          /* RETURN WITH RC BUT    @Z67SP00*/ 01018000
         CLI   IOPFUNCT(IOPPTR),0                                  0575 01019000
         BE    @RT00575                                            0575 01020000
*                     GO TO EXIT;   /* NO MSG                @Z67SP00*/ 01021000
*                   GO TO NODDMSG;  /* IF IMPLIED OPEN FOR ONE OF THE   01022000
*                                      OTHER DDS THEN MSG    @Z67SP00*/ 01023000
         B     NODDMSG                                             0577 01024000
*                 END;                                             0578 01025000
*                                                                  0578 01026000
*               /*****************************************************/ 01027000
*               /*                                                   */ 01028000
*               /* CALL ROUTINE TO DO ANY MODIFICATIONS TO JFCB      */ 01029000
*               /*                                           @Z67SP00*/ 01030000
*               /*                                                   */ 01031000
*               /*****************************************************/ 01032000
*                                                                  0579 01033000
*               CALL JFCBMOD;       /* MODIFY JFCB           @Z40SP00*/ 01034000
@RF00572 BAL   @14,JFCBMOD                                         0579 01035000
*             END;                  /* END RDJFCB GROUP      @Z40SP00*/ 01036000
*                                                                  0580 01037000
*           /*********************************************************/ 01038000
*           /*                                                       */ 01039000
*           /* IF DATASET IS PTFIN THEN MODIFY DCB FOR EITHER PTFIN  */ 01040000
*           /* INPUT (FILE 1) OR LOAD RELFILE INPUT (FILE>1)         */ 01041000
*           /*                                                       */ 01042000
*           /*********************************************************/ 01043000
*                                                                  0581 01044000
*           IF IOPDSID=IOPPTFIN     /* IF PTFIN DATSET       @Z67SP00*/ 01045000
*             THEN                  /*                       @Z67SP00*/ 01046000
@RF00562 CLI   IOPDSID(IOPPTR),10                                  0581 01047000
         BNE   @RF00581                                            0581 01048000
*             IF IOPSEQNO>1         /* IF RELFILE PART OF    @Z67SP00*/ 01049000
*               THEN                /* PTFIN DATASET         @Z67SP00*/ 01050000
         LH    @11,IOPSEQNO(,IOPPTR)                               0582 01051000
         CH    @11,@CH00088                                        0582 01052000
         BNH   @RF00582                                            0582 01053000
*               DO;                 /*                       @Z67SP00*/ 01054000
*                 DCBLRECL=ZERO;    /* USE LRECL AND BLKSIZE @Z67SP00*/ 01055000
         SLR   @11,@11                                             0584 01056000
         STH   @11,DCBLRECL+72(,DCBPTR)                            0584 01057000
*                 DCBBLKSI=ZERO;    /* FROM SL TAPE          @Z67SP00*/ 01058000
         STH   @11,DCBBLKSI+52(,DCBPTR)                            0585 01059000
*                 DCBRECFM=RECFMNL; /* USE RECFM FROM SL TP  @Z67SP00*/ 01060000
         MVI   DCBRECFM+28(DCBPTR),B'00000000'                     0586 01061000
*                 DCBMRECP=MACRFE;  /* SET MACRF=E           @Z67SP00*/ 01062000
         OI    DCBMRECP+40(DCBPTR),B'10000000'                     0587 01063000
*                 DCBERACC=OFF;     /* ERROPT INVAL FOR EXCP @Z67SP00*/ 01064000
         NI    DCBERACC+84(DCBPTR),B'01111111'                     0588 01065000
*               END;                /*                       @Z67SP00*/ 01066000
*                                                                  0589 01067000
*           /*********************************************************/ 01068000
*           /*                                                       */ 01069000
*           /* TRY TO OPEN DCB                               @Z40SP00*/ 01070000
*           /*                                                       */ 01071000
*           /*********************************************************/ 01072000
*                                                                  0590 01073000
*           IF IOPRETRN^=IOPGOOD    /* IF ERROR IN JFCBMOD   @Z67SP00*/ 01074000
*               |(IOPDSID=IOPLRF&IOPFUNCT=IOPDEL)/* OR DELETE OF LRF    01075000
*                                      DATASET THEN NO NEED TO DO  0590 01076000
*                                      OPEN                  @Z67SP00*/ 01077000
*             THEN                  /* THEN                  @Z67SP00*/ 01078000
@RF00582 DS    0H                                                  0590 01079000
@RF00581 CLI   IOPRETRN(IOPPTR),0                                  0590 01080000
         BNE   @RT00590                                            0590 01081000
         CLI   IOPDSID(IOPPTR),32                                  0590 01082000
         BNE   @RF00590                                            0590 01083000
         CLI   IOPFUNCT(IOPPTR),15                                 0590 01084000
         BE    @RT00590                                            0590 01085000
*             GO TO EXIT;           /* RETURN                @Z67SP00*/ 01086000
*           ELSE                    /* IF ERR IN JFCB MOD    @Z67SP00*/ 01087000
*             DO;                   /*                       @Z67SP00*/ 01088000
@RF00590 DS    0H                                                  0593 01089000
*               R1=DCBS(IOPDSID,OUTIN+1);/* OPEN LST FRM     @Z67SP00*/ 01090000
         SLR   @11,@11                                             0593 01091000
         IC    @11,IOPDSID(,IOPPTR)                                0593 01092000
         SLA   @11,2                                               0593 01093000
         SLR   @04,@04                                             0593 01094000
         IC    @04,IOENTCNT                                        0593 01095000
         LA    @04,INOUT-1(@04)                                    0593 01096000
         SLR   @03,@03                                             0593 01097000
         IC    @03,OUTIN(,@04)                                     0593 01098000
         ALR   @11,@03                                             0593 01099000
         SLA   @11,2                                               0593 01100000
         L     R1,DCBS-16(@11)                                     0593 01101000
*               GEN(OPEN MF=(E,(1)),TYPE=J)                        0594 01102000
*               FLOWS(DCBEXIT);     /* OPEN DCB              @Z67SP00*/ 01103000
         OPEN MF=(E,(1)),TYPE=J                                         01104000
*               IF DCBOFOPN=OFF     /* OPEN FAIL?            @Z40SP00*/ 01105000
*                 THEN              /* YES - INDICATE ERROR          */ 01106000
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0595 01107000
         BZ    @RT00595                                            0595 01108000
*                 GO TO OPENFAIL;   /* NEED TO PRINT MSG     @ZA12356*/ 01109000
*             END;                  /*                       @Z67SP00*/ 01110000
*         END;                                                     0598 01111000
*                                                                  0599 01112000
*       /*************************************************************/ 01113000
*       /*                                                           */ 01114000
*       /* IMPLIED OPEN - NOT SPECIFIC OPEN REQUEST - CHECK OPEN     */ 01115000
*       /*                                                           */ 01116000
*       /*************************************************************/ 01117000
*                                                                  0599 01118000
*       ELSE                        /* NOT SPECIFIC OPEN OR MACLIB 0599 01119000
*                                      OPEN                  @VS05286*/ 01120000
*         DO;                       /* THEN IMPLIED OPEN     @VS05286*/ 01121000
         B     @RC00560                                            0599 01122000
@RF00560 DS    0H                                                  0600 01123000
*           DEVDDNAM=DCBDDNAM;      /* SET DD NAME TO FIND   @Z40SP00*/ 01124000
         MVC   DEVDDNAM(8),DCBDDNAM+40(DCBPTR)                     0600 01125000
*           GEN(DEVTYPE DEVDDNAM,DEVADDR)                          0601 01126000
*           REFS(DEVDDNAM,DEVADDR); /* SEE IF DD HERE        @Z40SP00*/ 01127000
         DEVTYPE DEVDDNAM,DEVADDR                                       01128000
*           RFY                                                    0602 01129000
*             RTNCODE RSTD;         /*                       @Z40SP00*/ 01130000
*           IF RTNCODE^=ZERO        /* DD FOUND?             @Z40SP00*/ 01131000
*             THEN                  /* NO                    @Z40SP00*/ 01132000
         LTR   RTNCODE,RTNCODE                                     0603 01133000
         BNZ   @RT00603                                            0603 01134000
*             GO TO NODDMSG;        /* GO WRITE MSG          @Z40SP00*/ 01135000
*           RFY                                                    0605 01136000
*             RTNCODE UNRSTD;       /*                       @Z40SP00*/ 01137000
*           R1=DCBS(IOPDSID,OUTIN+1);/* OPEN LIST FORM AD    @ZA12350*/ 01138000
         SLR   @11,@11                                             0606 01139000
         IC    @11,IOPDSID(,IOPPTR)                                0606 01140000
         SLA   @11,2                                               0606 01141000
         SLR   @04,@04                                             0606 01142000
         IC    @04,IOENTCNT                                        0606 01143000
         LA    @04,INOUT-1(@04)                                    0606 01144000
         SLR   @03,@03                                             0606 01145000
         IC    @03,OUTIN(,@04)                                     0606 01146000
         ALR   @11,@03                                             0606 01147000
         SLA   @11,2                                               0606 01148000
         L     R1,DCBS-16(@11)                                     0606 01149000
*           GEN(OPEN    MF=(E,(1))) /* OPEN THE DCB                  */ 01150000
*           FLOWS(DCBEXIT);                                        0607 01151000
         OPEN    MF=(E,(1))                                             01152000
*           RFY                                                    0608 01153000
*             R1 UNRSTD;            /*                       @Z40SP00*/ 01154000
*           IF DCBOFOPN=OFF         /* DCB STILL NOT OPEN??          */ 01155000
*             THEN                  /* NO - ERROR CONDITION          */ 01156000
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0609 01157000
         BZ    @RT00609                                            0609 01158000
*             GO TO OPENFAIL;       /* GO WRITE ERR MSG      @Z40SP00*/ 01159000
*         END;                      /* END IMPLIED OPEN GROUP      0611 01160000
*                                                            @VS05286*/ 01161000
*     END;                          /* END DCB NOT OPEN      @VS05286*/ 01162000
@RC00560 DS    0H                                                  0613 01163000
         EJECT                                                          01164000
*                                                                  0613 01165000
*   /*****************************************************************/ 01166000
*   /*                                                               */ 01167000
*   /* DCB NOW OPENED. DCBPTR IS POINTING TO THE CORRECT DCB AND WILL*/ 01168000
*   /* REMAIN SO THROUGHOUT THE PROGRAM. IF FUNCTION WAS OPEN THEN   */ 01169000
*   /* PUT DCB BLKSIZE IN IOP AND RETURN                     @Z40SP00*/ 01170000
*   /*                                                               */ 01171000
*   /*****************************************************************/ 01172000
*                                                                  0613 01173000
*   IF IOPFUNCT=IOPOPEN             /* IS FUNCTION OPEN ONLY?        */ 01174000
*     THEN                          /* YES -                 @VS05286*/ 01175000
@RF00557 CLI   IOPFUNCT(IOPPTR),0                                  0613 01176000
         BNE   @RF00613                                            0613 01177000
*     DO;                           /*                       @VS05286*/ 01178000
*       IOPBLKSI=DCBBLKSI;          /* PUT BLKSIZE IN IOP    @VS05286*/ 01179000
         MVC   IOPBLKSI(2,IOPPTR),DCBBLKSI+52(DCBPTR)              0615 01180000
*       IF IOPDSID=IOPPTFIN         /* IF PTFIN              @Z67SP00*/ 01181000
*         THEN                      /*                       @Z67SP00*/ 01182000
         CLI   IOPDSID(IOPPTR),10                                  0616 01183000
         BNE   @RF00616                                            0616 01184000
*         DO;                       /*                       @Z67SP00*/ 01185000
*           IOPVLSER=JFCBVOLS(1:6); /* VOLSER OF TAPE        @Z67SP00*/ 01186000
         L     @11,JFCBPTR                                         0618 01187000
         MVC   IOPVLSER(6,IOPPTR),JFCBVOLS(@11)                    0618 01188000
*           IF JFCBFLSQ=ZERO        /*                       @Z67SP00*/ 01189000
*             THEN                  /*                       @Z67SP00*/ 01190000
         ICM   @04,3,JFCBFLSQ(@11)                                 0619 01191000
         BNZ   @RF00619                                            0619 01192000
*             IOPTPSEQ=1;           /*                       @Z67SP00*/ 01193000
         MVC   IOPTPSEQ(2,IOPPTR),@CH00088                         0620 01194000
*           ELSE                    /*                       @Z67SP00*/ 01195000
*             IOPTPSEQ=JFCBFLSQ;    /* FILE NUMBER           @Z67SP00*/ 01196000
         B     @RC00619                                            0621 01197000
@RF00619 L     @11,JFCBPTR                                         0621 01198000
         MVC   IOPTPSEQ(2,IOPPTR),JFCBFLSQ(@11)                    0621 01199000
*         END;                      /*                       @Z67SP00*/ 01200000
*       GO TO GOODEXIT;             /* EXIT GOOD TO REQUESTOR        */ 01201000
         B     GOODEXIT                                            0623 01202000
*     END;                          /* END OPEN ONLY FUNCTION GROUP     01203000
*                                                            @VS05286*/ 01204000
*                                                                  0624 01205000
*   /*****************************************************************/ 01206000
*   /*                                                               */ 01207000
*   /* BRANCH TO THE PROPER SUBROUTINE BASED ON THE DATA SET ID      */ 01208000
*   /* SPECIFIED IN IOPDSID                                  @Z40SP00*/ 01209000
*   /*                                                               */ 01210000
*   /*****************************************************************/ 01211000
*                                                                  0625 01212000
*   GO TO IOROUT;                   /* EXIT TO ROUTINE FOR THIS DS   */ 01213000
@RF00613 SLR   @11,@11                                             0625 01214000
         IC    @11,IOPDSID(,IOPPTR)                                0625 01215000
         SLA   @11,2                                               0625 01216000
         L     @11,IOHNDLRS-4(@11)                                 0625 01217000
         BR    @11                                                 0625 01218000
         EJECT                                                          01219000
*                                                                  0626 01220000
*   /*****************************************************************/ 01221000
*   /*                                                               */ 01222000
*   /* ROUTINE TO HANDLE SMPJCLIN,SMPPTFIN, AND SMPREPIN. IT ALSO    */ 01223000
*   /* THIS ROUTINE ALSO HANDLES THE DIRECTORY FOR THE SMPUCS,       */ 01224000
*   /* SMPMTS, SMPPTS, AND THE SMPACDS                       @Z40SP00*/ 01225000
*   /*                                                               */ 01226000
*   /*****************************************************************/ 01227000
*                                                                  0626 01228000
*JCLINRTN:                                                         0626 01229000
*MTSDRTN:                                                          0626 01230000
*PTSDRTN:                           /*                       @Z40SP00*/ 01231000
*STSDRTN:                           /*                       @Z40SP00*/ 01232000
*SCDSDRTN:                          /*                       @Z67SP00*/ 01233000
*   IF IOPFUNCT=IOPREAD             /* READ REQUEST?         @Z40SP00*/ 01234000
*     THEN                          /* YES                   @Z40SP00*/ 01235000
JCLINRTN DS    0H                                                  0626 01236000
MTSDRTN  DS    0H                                                  0626 01237000
PTSDRTN  DS    0H                                                  0626 01238000
STSDRTN  DS    0H                                                  0626 01239000
SCDSDRTN CLI   IOPFUNCT(IOPPTR),1                                  0626 01240000
         BNE   @RF00626                                            0626 01241000
*     CALL GET;                     /* GET A RECORD          @Z40SP00*/ 01242000
         BAL   @14,GET                                             0627 01243000
*   ELSE                            /* NOT READ REQUEST      @Z40SP00*/ 01244000
*     IOPRETRN=IOPIOERR;            /* SET BAD RETURN        @Z40SP00*/ 01245000
         B     @RC00626                                            0628 01246000
@RF00626 MVI   IOPRETRN(IOPPTR),X'10'                              0628 01247000
*   GO TO EXIT;                     /* RETURN                @Z40SP00*/ 01248000
         B     EXIT                                                0629 01249000
         EJECT                                                          01250000
*                                                                  0630 01251000
*   /*****************************************************************/ 01252000
*   /*                                                               */ 01253000
*   /* ROUTINE TO SET TO HANDLE CDS DATA SET                 @SA72416*/ 01254000
*   /*                                                               */ 01255000
*   /*****************************************************************/ 01256000
*                                                                  0630 01257000
*CDSRTN:                                                           0630 01258000
*   PDSI=CDS;                       /* SET INDEX TO CDS LOG  @SA72416*/ 01259000
CDSRTN   MVI   PDSI,X'01'                                          0630 01260000
*   DSBFRMX=CCACBFMX;               /* CDS BLOCKING FCTR     @SA74317*/ 01261000
         L     @11,@CA00038                                        0631 01262000
         MVC   DSBFRMX(2),CCACBFMX-HMASMCCA(@11)                   0631 01263000
*   DSBFPTRI=CCACBFIA;              /* CDS INPUT BUFFER      @Z67SP00*/ 01264000
         MVC   DSBFPTRI(4),CCACBFIA-HMASMCCA(@11)                  0632 01265000
*   DSBFPTRO=CCACBFOA;              /* CDS OUTPUT BUFFER     @Z67SP00*/ 01266000
         MVC   DSBFPTRO(4),CCACBFOA-HMASMCCA(@11)                  0633 01267000
*   IF CCACDSIS=ON                  /* IF CDS DIR IN STOR    @ZD00003*/ 01268000
*     THEN                          /* THEN SET SW TO USE    @ZD00003*/ 01269000
         TM    CCACDSIS-HMASMCCA(@11),B'10000000'                  0634 01270000
         BNO   @RF00634                                            0634 01271000
*     DISISW=ON;                    /* IN-STORAGE ACCESS     @Z67SP00*/ 01272000
         OI    DISISW,B'00010000'                                  0635 01273000
*   ELSE                            /*                       @ZD00004*/ 01274000
*     DISISW=OFF;                   /* INIT SWITCH TO INDICATE THAT     01275000
*                                      DIRECTORY NOT IN STORAGE FOR     01276000
*                                      SPECIFIED DATA SET    @Z67SP00*/ 01277000
         B     @RC00634                                            0636 01278000
@RF00634 NI    DISISW,B'11101111'                                  0636 01279000
*   IF CCACDSOS=ON                  /* IF CDS DIR IN STOR    @Z67SP00*/ 01280000
*       |((CCAAPPLY=ON|CCARES=ON)   /* OR APPLY/REST CHECK   @Z67SP00*/ 01281000
*       &CCACHECK=ON)               /*                       @Z67SP00*/ 01282000
*     THEN                          /* FOR UPDATE THEN SET   @Z67SP00*/ 01283000
@RC00634 L     @11,@CA00038                                        0637 01284000
         TM    CCACDSOS-HMASMCCA(@11),B'10000000'                  0637 01285000
         BO    @RT00637                                            0637 01286000
         TM    CCAAPPLY-HMASMCCA(@11),B'01001000'                  0637 01287000
         BZ    @RF00637                                            0637 01288000
         TM    CCACHECK-HMASMCCA(@11),B'00010000'                  0637 01289000
         BNO   @RF00637                                            0637 01290000
@RT00637 DS    0H                                                  0638 01291000
*     DISOSW=ON;                    /* IN-STORAGE ACCESS     @Z67SP00*/ 01292000
         OI    DISOSW,B'00001000'                                  0638 01293000
*   ELSE                            /*                       @Z67SP00*/ 01294000
*     DISOSW=OFF;                   /* INIT SWITCH TO INDICATE THAT     01295000
*                                      DIRECTORY NOT IN STORAGE FOR     01296000
*                                      UPDATE                @Z67SP00*/ 01297000
         B     @RC00637                                            0639 01298000
@RF00637 NI    DISOSW,B'11110111'                                  0639 01299000
*   GO TO PDSRTNS;                  /* BRANCH TO COMMON CDS/ACDS     */ 01300000
*                                                                  0640 01301000
         B     PDSRTNS                                             0640 01302000
*   /*****************************************************************/ 01303000
*   /*                                                               */ 01304000
*   /* ROUTINE TO SET TO HANDLE THE SMPACDS DATA SET         @SA72416*/ 01305000
*   /*                                                               */ 01306000
*   /*****************************************************************/ 01307000
*                                                                  0641 01308000
*ACDSRTN:                                                          0641 01309000
*   PDSI=ACDS;                      /* SET INDEX TO ACDS LOGIC       */ 01310000
ACDSRTN  MVI   PDSI,X'02'                                          0641 01311000
*   DSBFRMX=CCAABFMX;               /* MAX BLK FOR ACDS      @SA74317*/ 01312000
         L     @11,@CA00038                                        0642 01313000
         MVC   DSBFRMX(2),CCAABFMX-HMASMCCA(@11)                   0642 01314000
*   DSBFPTRI=CCACBFIA;              /* ACDS INPUT BUFFER     @Z67SP00*/ 01315000
         MVC   DSBFPTRI(4),CCACBFIA-HMASMCCA(@11)                  0643 01316000
*   DSBFPTRO=CCACBFOA;              /* ACDS OUTPUT BUFFER    @Z67SP00*/ 01317000
         MVC   DSBFPTRO(4),CCACBFOA-HMASMCCA(@11)                  0644 01318000
*   IF CCAACDIS=ON                  /* IF ACDS DIR IN STOR   @ZD00003*/ 01319000
*     THEN                          /* THEN SET SW TO USE    @ZD00003*/ 01320000
         TM    CCAACDIS-HMASMCCA(@11),B'01000000'                  0645 01321000
         BNO   @RF00645                                            0645 01322000
*     DISISW=ON;                    /* IN-STORAGE ACCESS     @Z67SP00*/ 01323000
         OI    DISISW,B'00010000'                                  0646 01324000
*   ELSE                            /*                       @ZD00004*/ 01325000
*     DISISW=OFF;                   /* INIT SWITCH TO INDICATE THAT     01326000
*                                      DIRECTORY NOT IN STORAGE FOR     01327000
*                                      SPECIFIED DATA SET    @Z67SP00*/ 01328000
         B     @RC00645                                            0647 01329000
@RF00645 NI    DISISW,B'11101111'                                  0647 01330000
*   IF CCAACDOS=ON                  /* IF ACDS DIR IN STOR   @Z67SP00*/ 01331000
*       |(CCAACCPT=ON&CCACHECK=ON)  /* OR ACCEPT CHECK       @Z67SP00*/ 01332000
*     THEN                          /* FOR UPDATE THEN SET   @Z67SP00*/ 01333000
@RC00645 L     @11,@CA00038                                        0648 01334000
         TM    CCAACDOS-HMASMCCA(@11),B'01000000'                  0648 01335000
         BO    @RT00648                                            0648 01336000
         TM    CCAACCPT-HMASMCCA(@11),B'00100000'                  0648 01337000
         BNO   @RF00648                                            0648 01338000
         TM    CCACHECK-HMASMCCA(@11),B'00010000'                  0648 01339000
         BNO   @RF00648                                            0648 01340000
@RT00648 DS    0H                                                  0649 01341000
*     DISOSW=ON;                    /* IN-STORAGE ACCESS     @Z67SP00*/ 01342000
         OI    DISOSW,B'00001000'                                  0649 01343000
*   ELSE                            /*                       @Z67SP00*/ 01344000
*     DISOSW=OFF;                   /* INIT SWITCH TO INDICATE THAT     01345000
*                                      DIRECTORY NOT IN STORAGE FOR     01346000
*                                      UPDATE                @Z67SP00*/ 01347000
         B     @RC00648                                            0650 01348000
@RF00648 NI    DISOSW,B'11110111'                                  0650 01349000
*   GO TO PDSRTNS;                  /* BRANCH TO COMMON CDS/ACDS     */ 01350000
         B     PDSRTNS                                             0651 01351000
*                                                                  0652 01352000
*   /*****************************************************************/ 01353000
*   /*                                                               */ 01354000
*   /* ROUTINE TO SET TO HANDLE SCDS DATASET                 @Z67SP00*/ 01355000
*   /*                                                               */ 01356000
*   /*****************************************************************/ 01357000
*                                                                  0652 01358000
*SCDSRTN:                                                          0652 01359000
*   PDSI=SCDS;                      /* SET INDEX TO CDSD     @Z67SP00*/ 01360000
SCDSRTN  MVI   PDSI,X'03'                                          0652 01361000
*   DSBFRMX=CCAVBFMX;               /* SCDS BLOCKING FACTOR  @Z67SP00*/ 01362000
         L     @11,@CA00038                                        0653 01363000
         MVC   DSBFRMX(2),CCAVBFMX-HMASMCCA(@11)                   0653 01364000
*   DSBFPTRI=CCAVBFIA;              /* SCDS INPUT BUFFER     @Z67SP00*/ 01365000
         MVC   DSBFPTRI(4),CCAVBFIA-HMASMCCA(@11)                  0654 01366000
*   DSBFPTRO=CCAVBFOA;              /* SCDS OUTPUT BUFFER    @Z67SP00*/ 01367000
         MVC   DSBFPTRO(4),CCAVBFOA-HMASMCCA(@11)                  0655 01368000
*   DISISW=OFF;                     /* INIT SWITCH TO INDICATE THAT     01369000
*                                      DIRECTORY NOT IN STORAGE FOR     01370000
*                                      SPECIFIED DATA SET    @Z67SP00*/ 01371000
*   DISOSW=OFF;                     /* INIT SWITCH TO INDICATE THAT     01372000
*                                      DIRECTORY NOT IN STORAGE FOR     01373000
*                                      UPDATE                @Z67SP00*/ 01374000
         NI    DISISW,B'11100111'                                  0657 01375000
*   GO TO PDSRTNS;                  /* BRANCH TO COMMON CDS/ACDS     */ 01376000
*                                                                  0658 01377000
         B     PDSRTNS                                             0658 01378000
*   /*****************************************************************/ 01379000
*   /*                                                               */ 01380000
*   /* ROUTINE TO HANDLE THE SMPPTS DATA SET                 @Z40SP00*/ 01381000
*   /*                                                               */ 01382000
*   /*****************************************************************/ 01383000
*                                                                  0659 01384000
*PTSRTN:                            /*                       @Z40SP00*/ 01385000
*   PDSI=PTS;                       /* SET INDEX TO USE PTS  @Z67SP00*/ 01386000
PTSRTN   MVI   PDSI,X'04'                                          0659 01387000
*   DSBFRMX=CCAPBFMX;               /* PTS BLOCKING FACTOR   @Z67SP00*/ 01388000
         L     @11,@CA00038                                        0660 01389000
         MVC   DSBFRMX(2),CCAPBFMX-HMASMCCA(@11)                   0660 01390000
*   DSBFPTRI=CCAPBFIA;              /* PTS INPUT BUFFER      @Z67SP00*/ 01391000
         MVC   DSBFPTRI(4),CCAPBFIA-HMASMCCA(@11)                  0661 01392000
*   DSBFPTRO=CCAPBFOA;              /* PTS OUTPUT BUFFER     @Z67SP00*/ 01393000
         MVC   DSBFPTRO(4),CCAPBFOA-HMASMCCA(@11)                  0662 01394000
*   DISISW=OFF;                     /* INIT SWITCH TO INDICATE THAT     01395000
*                                      DIRECTORY NOT IN STORAGE FOR     01396000
*                                      SPECIFIED DATA SET    @Z67SP00*/ 01397000
*   DISOSW=OFF;                     /* INIT SWITCH TO INDICATE THAT     01398000
*                                      DIRECTORY NOT IN STORAGE FOR     01399000
*                                      UPDATE                @Z67SP00*/ 01400000
         NI    DISISW,B'11100111'                                  0664 01401000
*   GO TO PDSRTNS;                  /* BRANCH TO COMMON CDS/ACDS     */ 01402000
         B     PDSRTNS                                             0665 01403000
*                                                                  0666 01404000
*   /*****************************************************************/ 01405000
*   /*                                                               */ 01406000
*   /* ROUTINE TO HANDLE THE SMPMTS DATA SET                 @Z40SP00*/ 01407000
*   /*                                                               */ 01408000
*   /*****************************************************************/ 01409000
*                                                                  0666 01410000
*MTSRTN:                            /*                       @Z40SP00*/ 01411000
*   PDSI=MTS;                       /* SET INDEX TO USE MTS  @Z67SP00*/ 01412000
MTSRTN   MVI   PDSI,X'05'                                          0666 01413000
*   DSBFRMX=CCAMBFMX;               /* MTS BLOCKING FACTOR   @Z67SP00*/ 01414000
         L     @11,@CA00038                                        0667 01415000
         MVC   DSBFRMX(2),CCAMBFMX-HMASMCCA(@11)                   0667 01416000
*   DSBFPTRI=CCAPBFIA;              /* MTS INPUT BUFFER      @Z67SP00*/ 01417000
         MVC   DSBFPTRI(4),CCAPBFIA-HMASMCCA(@11)                  0668 01418000
*   DSBFPTRO=CCAPBFOA;              /* MTS OUTPUT BUFFER     @Z67SP00*/ 01419000
         MVC   DSBFPTRO(4),CCAPBFOA-HMASMCCA(@11)                  0669 01420000
*   DISISW=OFF;                     /* INIT SWITCH TO INDICATE THAT     01421000
*                                      DIRECTORY NOT IN STORAGE FOR     01422000
*                                      SPECIFIED DATA SET    @Z67SP00*/ 01423000
*   DISOSW=OFF;                     /* INIT SWITCH TO INDICATE THAT     01424000
*                                      DIRECTORY NOT IN STORAGE FOR     01425000
*                                      UPDATE                @Z67SP00*/ 01426000
         NI    DISISW,B'11100111'                                  0671 01427000
*   GO TO PDSRTNS;                  /* BRANCH TO COMMON CDS/ACDS     */ 01428000
*                                                                  0672 01429000
         B     PDSRTNS                                             0672 01430000
*   /*****************************************************************/ 01431000
*   /*                                                               */ 01432000
*   /* ROUTINE TO HANDLE THE SMPSTS DATA SET                 @Z40SP00*/ 01433000
*   /*                                                               */ 01434000
*   /*****************************************************************/ 01435000
*                                                                  0673 01436000
*STSRTN:                            /*                       @Z40SP00*/ 01437000
*   PDSI=STS;                       /* SET INDEX TO USE STS  @Z67SP00*/ 01438000
STSRTN   MVI   PDSI,X'06'                                          0673 01439000
*   DSBFRMX=CCASBFMX;               /* STS BLOCKING FACTOR   @Z67SP00*/ 01440000
         L     @11,@CA00038                                        0674 01441000
         MVC   DSBFRMX(2),CCASBFMX-HMASMCCA(@11)                   0674 01442000
*   DSBFPTRI=CCAPBFIA;              /* STS INPUT BUFFER      @Z67SP00*/ 01443000
         MVC   DSBFPTRI(4),CCAPBFIA-HMASMCCA(@11)                  0675 01444000
*   DSBFPTRO=CCAPBFOA;              /* STS OUTPUT BUFFER     @Z67SP00*/ 01445000
         MVC   DSBFPTRO(4),CCAPBFOA-HMASMCCA(@11)                  0676 01446000
*   DISISW=OFF;                     /* INIT SWITCH TO INDICATE THAT     01447000
*                                      DIRECTORY NOT IN STORAGE FOR     01448000
*                                      SPECIFIED DATA SET    @Z67SP00*/ 01449000
*   DISOSW=OFF;                     /* INIT SWITCH TO INDICATE THAT     01450000
*                                      DIRECTORY NOT IN STORAGE FOR     01451000
*                                      UPDATE                @Z67SP00*/ 01452000
         NI    DISISW,B'11100111'                                  0678 01453000
*   GO TO PDSRTNS;                  /* BRANCH TO COMMON CDS/ACDS     */ 01454000
         B     PDSRTNS                                             0679 01455000
*                                                                  0680 01456000
*   /*****************************************************************/ 01457000
*   /*                                                               */ 01458000
*   /* ROUTINE TO SET TO HANDLE CRQ DATA SET                 @Z67SP00*/ 01459000
*   /*                                                               */ 01460000
*   /*****************************************************************/ 01461000
*                                                                  0680 01462000
*CRQRTN:                                                           0680 01463000
*   PDSI=CRQ;                       /* SET INDEX TO CDS LOG  @Z67SP00*/ 01464000
CRQRTN   MVI   PDSI,X'07'                                          0680 01465000
*   DSBFRMX=CCAQBFMX;               /* CRQ BLOCKING FCTR     @Z67SP00*/ 01466000
         L     @11,@CA00038                                        0681 01467000
         MVC   DSBFRMX(2),CCAQBFMX-HMASMCCA(@11)                   0681 01468000
*   DSBFPTRI=CCAQBFIA;              /* CRQ INPUT BUFFER      @Z67SP00*/ 01469000
         MVC   DSBFPTRI(4),CCAQBFIA-HMASMCCA(@11)                  0682 01470000
*   DSBFPTRO=CCAQBFOA;              /* CRQ OUTPUT BUFFER     @Z67SP00*/ 01471000
         MVC   DSBFPTRO(4),CCAQBFOA-HMASMCCA(@11)                  0683 01472000
*   IF CCACRQIS=ON                  /* IF CRQ DIR IN STOR    @Z67SP00*/ 01473000
*     THEN                          /* THEN SET SW TO USE    @Z67SP00*/ 01474000
         TM    CCACRQIS-HMASMCCA(@11),B'00100000'                  0684 01475000
         BNO   @RF00684                                            0684 01476000
*     DISISW=ON;                    /* IN-STORAGE ACCESS     @Z67SP00*/ 01477000
         OI    DISISW,B'00010000'                                  0685 01478000
*   ELSE                            /*                       @Z40ZP67*/ 01479000
*     DISISW=OFF;                   /* INIT SWITCH TO INDICATE THAT     01480000
*                                      DIRECTORY NOT IN STORAGE FOR     01481000
*                                      SPECIFIED DATA SET    @Z67SP00*/ 01482000
         B     @RC00684                                            0686 01483000
@RF00684 NI    DISISW,B'11101111'                                  0686 01484000
*   IF CCACRQOS=ON                  /* IF CRQ DIR IN STOR    @Z67SP00*/ 01485000
*     THEN                          /* FOR UPDATE THEN SET   @Z67SP00*/ 01486000
@RC00684 L     @11,@CA00038                                        0687 01487000
         TM    CCACRQOS-HMASMCCA(@11),B'00100000'                  0687 01488000
         BNO   @RF00687                                            0687 01489000
*     DISOSW=ON;                    /* IN-STORAGE ACCESS     @Z67SP00*/ 01490000
         OI    DISOSW,B'00001000'                                  0688 01491000
*   ELSE                            /*                       @Z67SP00*/ 01492000
*     DISOSW=OFF;                   /* INIT SWITCH TO INDICATE THAT     01493000
*                                      DIRECTORY NOT IN STORAGE FOR     01494000
*                                      UPDATE                @Z67SP00*/ 01495000
         B     @RC00687                                            0689 01496000
@RF00687 NI    DISOSW,B'11110111'                                  0689 01497000
*   GO TO PDSRTNS;                  /* BRANCH TO COMMON PDS  @Z67SP00*/ 01498000
*                                                                  0690 01499000
         B     PDSRTNS                                             0690 01500000
*   /*****************************************************************/ 01501000
*   /*                                                               */ 01502000
*   /* ROUTINE TO SET TO HANDLE THE SMPACRQ DATA SET         @Z67SP00*/ 01503000
*   /*                                                               */ 01504000
*   /*****************************************************************/ 01505000
*                                                                  0691 01506000
*ACRQRTN:                                                          0691 01507000
*   PDSI=ACRQ;                      /* SET INDEX TO ACRQ LOG @Z67SP00*/ 01508000
ACRQRTN  MVI   PDSI,X'08'                                          0691 01509000
*   DSBFRMX=CCAXBFMX;               /* MAX BLK FOR ACRQ      @Z67SP00*/ 01510000
         L     @11,@CA00038                                        0692 01511000
         MVC   DSBFRMX(2),CCAXBFMX-HMASMCCA(@11)                   0692 01512000
*   DSBFPTRI=CCAQBFIA;              /* ACRQ INPUT BUFFER     @Z67SP00*/ 01513000
         MVC   DSBFPTRI(4),CCAQBFIA-HMASMCCA(@11)                  0693 01514000
*   DSBFPTRO=CCAQBFOA;              /* ACRQ OUTPUT BUFFER    @Z67SP00*/ 01515000
         MVC   DSBFPTRO(4),CCAQBFOA-HMASMCCA(@11)                  0694 01516000
*   IF CCAACRIS=ON                  /* IF ACRQ DIR IN STOR   @Z67SP00*/ 01517000
*     THEN                          /* THEN SET SW TO USE    @Z67SP00*/ 01518000
         TM    CCAACRIS-HMASMCCA(@11),B'00010000'                  0695 01519000
         BNO   @RF00695                                            0695 01520000
*     DISISW=ON;                    /* IN-STORAGE ACCESS     @Z67SP00*/ 01521000
         OI    DISISW,B'00010000'                                  0696 01522000
*   ELSE                            /*                       @ZD00004*/ 01523000
*     DISISW=OFF;                   /* INIT SWITCH TO INDICATE THAT     01524000
*                                      DIRECTORY NOT IN STORAGE FOR     01525000
*                                      SPECIFIED DATA SET    @Z67SP00*/ 01526000
         B     @RC00695                                            0697 01527000
@RF00695 NI    DISISW,B'11101111'                                  0697 01528000
*   IF CCAACROS=ON                  /* IF ACRQ DIR IN STOR   @Z67SP00*/ 01529000
*     THEN                          /* FOR UPDATE THEN SET   @Z67SP00*/ 01530000
@RC00695 L     @11,@CA00038                                        0698 01531000
         TM    CCAACROS-HMASMCCA(@11),B'00010000'                  0698 01532000
         BNO   @RF00698                                            0698 01533000
*     DISOSW=ON;                    /* IN-STORAGE ACCESS     @Z67SP00*/ 01534000
         OI    DISOSW,B'00001000'                                  0699 01535000
*   ELSE                            /*                       @Z67SP00*/ 01536000
*     DISOSW=OFF;                   /* INIT SWITCH TO INDICATE THAT     01537000
*                                      DIRECTORY NOT IN STORAGE FOR     01538000
*                                      UPDATE                @Z67SP00*/ 01539000
         B     @RC00698                                            0700 01540000
@RF00698 NI    DISOSW,B'11110111'                                  0700 01541000
*   GO TO PDSRTNS;                  /* BRANCH TO COMMON PDS  @Z67SP00*/ 01542000
         B     PDSRTNS                                             0701 01543000
*                                                                  0702 01544000
*   /*****************************************************************/ 01545000
*   /*                                                               */ 01546000
*   /* ROUTINE TO HANDLE SMPWRK1, SMPWRK2,SMPWRK3, SMPWRK4   @Z67SP00*/ 01547000
*   /*                                                               */ 01548000
*   /*****************************************************************/ 01549000
*                                                                  0702 01550000
*WK1RTN:                            /*                       @Z67SP00*/ 01551000
*   PDSI=WK1;                       /* SET INDEX INTO ARRAY  @Z67SP00*/ 01552000
WK1RTN   MVI   PDSI,X'09'                                          0702 01553000
*   DSBFRMX=CCA1BFMX;               /* DS BLOCKING FACTOR    @Z67SP00*/ 01554000
         L     @11,@CA00038                                        0703 01555000
         MVC   DSBFRMX(2),CCA1BFMX-HMASMCCA(@11)                   0703 01556000
*   GO TO WKXRTN;                   /*                       @Z67SP00*/ 01557000
         B     WKXRTN                                              0704 01558000
*WK2RTN:                            /*                       @Z67SP00*/ 01559000
*   PDSI=WK2;                       /* SET INDEX INTO ARRAY  @Z67SP00*/ 01560000
WK2RTN   MVI   PDSI,X'0A'                                          0705 01561000
*   DSBFRMX=CCA2BFMX;               /* DS BLOCKING FACTOR    @Z67SP00*/ 01562000
         L     @11,@CA00038                                        0706 01563000
         MVC   DSBFRMX(2),CCA2BFMX-HMASMCCA(@11)                   0706 01564000
*   GO TO WKXRTN;                   /*                       @Z67SP00*/ 01565000
         B     WKXRTN                                              0707 01566000
*WK3RTN:                            /*                       @Z67SP00*/ 01567000
*   PDSI=WK3;                       /* SET INDEX INTO ARRAY  @Z67SP00*/ 01568000
WK3RTN   MVI   PDSI,X'0B'                                          0708 01569000
*   DSBFRMX=CCA3BFMX;               /* DS BLOCKING FACTOR    @Z67SP00*/ 01570000
         L     @11,@CA00038                                        0709 01571000
         MVC   DSBFRMX(2),CCA3BFMX-HMASMCCA(@11)                   0709 01572000
*   GO TO WKXRTN;                   /*                       @Z67SP00*/ 01573000
         B     WKXRTN                                              0710 01574000
*WK4RTN:                            /*                       @Z67SP00*/ 01575000
*   PDSI=WK4;                       /* SET INDEX INTO ARRAY  @Z67SP00*/ 01576000
WK4RTN   MVI   PDSI,X'0C'                                          0711 01577000
*   DSBFRMX=CCA4BFMX;               /* DS BLOCKING FACTOR    @Z67SP00*/ 01578000
         L     @11,@CA00038                                        0712 01579000
         MVC   DSBFRMX(2),CCA4BFMX-HMASMCCA(@11)                   0712 01580000
*   DSBFPTRI=CCA4BFIA;              /* INPUT BUFFER          @Z67SP00*/ 01581000
         MVC   DSBFPTRI(4),CCA4BFIA-HMASMCCA(@11)                  0713 01582000
*   DSBFPTRO=CCA4BFOA;              /* OUTPUT BUFFER         @Z67SP00*/ 01583000
         MVC   DSBFPTRO(4),CCA4BFOA-HMASMCCA(@11)                  0714 01584000
*   DISISW=OFF;                     /* DIR NOT INSTORAGE     @Z67SP00*/ 01585000
*   DISOSW=OFF;                     /* DIR NOT INSTORAGE     @Z67SP00*/ 01586000
         NI    DISISW,B'11100111'                                  0716 01587000
*   GO TO PDSRTNS;                  /* BR TO COMMON PDS RTN  @Z67SP00*/ 01588000
         B     PDSRTNS                                             0717 01589000
*WK5RTN:                            /*                       @Z67SP00*/ 01590000
*   PDSI=WK5;                       /* SET INDEX INTO ARRAY  @Z67SP00*/ 01591000
WK5RTN   MVI   PDSI,X'0D'                                          0718 01592000
*   DSBFRMX=ZERO;                   /* NO BUFFER             @Z67SP00*/ 01593000
         SLR   @11,@11                                             0719 01594000
         STH   @11,DSBFRMX                                         0719 01595000
*   GO TO WKXRTN;                   /*                       @Z67SP00*/ 01596000
         B     WKXRTN                                              0720 01597000
*WKXRTN:                            /*                       @Z67SP00*/ 01598000
*   DSBFPTRI=CCAWBFIA;              /* INPUT BUFFER          @Z67SP00*/ 01599000
WKXRTN   L     @11,@CA00038                                        0721 01600000
         MVC   DSBFPTRI(4),CCAWBFIA-HMASMCCA(@11)                  0721 01601000
*   DSBFPTRO=CCAWBFOA;              /* OUTPUT BUFFER         @Z67SP00*/ 01602000
         MVC   DSBFPTRO(4),CCAWBFOA-HMASMCCA(@11)                  0722 01603000
*   DISISW=OFF;                     /* DIR NOT INSTORAGE     @Z67SP00*/ 01604000
*   DISOSW=OFF;                     /* DIR NOT INSTORAGE     @Z67SP00*/ 01605000
         NI    DISISW,B'11100111'                                  0724 01606000
*   GO TO PDSRTNS;                  /* BR TO COMMON PDS RTN  @Z67SP00*/ 01607000
         B     PDSRTNS                                             0725 01608000
         EJECT                                                          01609000
*                                                                  0726 01610000
*   /*****************************************************************/ 01611000
*   /*                                                               */ 01612000
*   /* COMMON LOGIC FOR SMP PDS DATASETS                     @Z67SP00*/ 01613000
*   /*                                                               */ 01614000
*   /*****************************************************************/ 01615000
*                                                                  0726 01616000
*PDSRTNS:                                                          0726 01617000
*   PDSADDR=ADDR(PDSARRAY(PDSI));   /* PTR TO ARRAY FOR DS   @Z67SP00*/ 01618000
*                                                                  0726 01619000
PDSRTNS  SLR   @11,@11                                             0726 01620000
         IC    @11,PDSI                                            0726 01621000
         SLA   @11,4                                               0726 01622000
         LA    @11,PDSARRAY-16(@11)                                0726 01623000
         ST    @11,PDSADDR                                         0726 01624000
*   /*****************************************************************/ 01625000
*   /*                                                               */ 01626000
*   /* SET VARIABLE MESSAGE PARTS TO PROPER ENTRY TYPE IN CASE ERROR */ 01627000
*   /* DURING PROCESSING                                     @Z40SP00*/ 01628000
*   /*                                                               */ 01629000
*   /*****************************************************************/ 01630000
*                                                                  0727 01631000
*   IF IOPFUNCT=IOPSTOWC            /* IF STOW CHANGE        @Z40SP00*/ 01632000
*     THEN                          /* THEN ONLY INDICATE    @Z40SP00*/ 01633000
         CLI   IOPFUNCT(IOPPTR),82                                 0727 01634000
         BNE   @RF00727                                            0727 01635000
*     IOPTYPE=IOPMEM;               /* MEMBER                @Z67SP00*/ 01636000
*                                                                  0728 01637000
         MVI   IOPTYPE(IOPPTR),X'11'                               0728 01638000
*   /*****************************************************************/ 01639000
*   /*                                                               */ 01640000
*   /* IF CLOSE OPERATION THEN RESET COUNTS OF NUMBER OF RECORDS IN  */ 01641000
*   /* INPUT AND OUTPUT BUFFERS SO THAT NEXT TIME THRU PROCESSING    */ 01642000
*   /* WILL PICK UP CORRECT COUNTS                           @Z67SP00*/ 01643000
*   /*                                                               */ 01644000
*   /*****************************************************************/ 01645000
*                                                                  0729 01646000
*   IF IOPFUNCT=IOPCLOSE            /*                       @Z67SP00*/ 01647000
*     THEN                          /*                       @Z67SP00*/ 01648000
@RF00727 CLI   IOPFUNCT(IOPPTR),80                                 0729 01649000
         BNE   @RF00729                                            0729 01650000
*     DO;                           /*                       @Z67SP00*/ 01651000
*       DSBFCNTI=ZERO;              /*                       @Z67SP00*/ 01652000
         SLR   @11,@11                                             0731 01653000
         L     @04,PDSADDR                                         0731 01654000
         STH   @11,DSBFCNTI(,@04)                                  0731 01655000
*       DSBFCNTO=ZERO;              /*                       @Z67SP00*/ 01656000
         STH   @11,DSBFCNTO(,@04)                                  0732 01657000
*       DSBFRMX=ZERO;               /*                       @Z67SP00*/ 01658000
         STH   @11,DSBFRMX                                         0733 01659000
*       GO TO GOODEXIT;             /*                       @Z67SP00*/ 01660000
         B     GOODEXIT                                            0734 01661000
*     END;                          /*                       @Z67SP00*/ 01662000
         EJECT                                                          01663000
*                                                                  0736 01664000
*   /*****************************************************************/ 01665000
*   /*                                                               */ 01666000
*   /* CHECK FUNCTION FOR SMP PDS OUTPUT OPERATION           @Z67SP00*/ 01667000
*   /*                                                               */ 01668000
*   /*****************************************************************/ 01669000
*                                                                  0736 01670000
*   IF IOPFUNCT>IOPCLOSE            /* OUTPUT OPERATION?     @Z40SP00*/ 01671000
*     THEN                          /* YES - DO PROPER OUTPUT OP     */ 01672000
@RF00729 CLI   IOPFUNCT(IOPPTR),80                                 0736 01673000
         BNH   @RF00736                                            0736 01674000
*     DO;                                                          0737 01675000
*                                                                  0737 01676000
*       /*************************************************************/ 01677000
*       /*                                                           */ 01678000
*       /* IF DEB ADDR SAVE AREA NOT SET THEN SAVE CURRENT DEB       */ 01679000
*       /*                                                   @XA12947*/ 01680000
*       /*                                                           */ 01681000
*       /*************************************************************/ 01682000
*                                                                  0738 01683000
*       IF PDSDEBAD=ZERO            /* NEED TO SAVE DEB ADDR @Z67SP00*/ 01684000
*         THEN                      /* YES - TEN SAVE IT     @XA12947*/ 01685000
         L     @11,PDSADDR                                         0738 01686000
         ICM   @04,7,PDSDEBAD(@11)                                 0738 01687000
         BNZ   @RF00738                                            0738 01688000
*         PDSDEBAD=DCBDEBA;         /* GET DEB ADDR FROM DCB @Z67SP00*/ 01689000
*                                                                  0739 01690000
         MVC   PDSDEBAD(3,@11),DCBDEBA+40(DCBPTR)                  0739 01691000
*       /*************************************************************/ 01692000
*       /*                                                           */ 01693000
*       /* IF EOF MEMBER TTR NOT OBTAINED BEFORE FIRST OUTPUT        */ 01694000
*       /* OPERATION GET IT (EOTHER LOCATE OR CREATE IT)     @XA12947*/ 01695000
*       /*                                                           */ 01696000
*       /*************************************************************/ 01697000
*                                                                  0740 01698000
*       IF EOFTTR=ZERO              /* EOF TTR BEEN OBTAINED @Z67SP00*/ 01699000
*           &(IOPDSID=IOPCDS        /* AND DS IS CDS         @Z67SP00*/ 01700000
*           |IOPDSID=IOPSCDS        /* OR SCDS               @Z67SP00*/ 01701000
*           |IOPDSID=IOPACDS        /* OR ACDS               @Z67SP00*/ 01702000
*           |IOPDSID=IOPCRQ         /* OR CRQ                @Z67SP00*/ 01703000
*           |IOPDSID=IOPACRQ)       /* OR ACRQ               @Z67SP00*/ 01704000
*         THEN                      /* NO - GET IT NOW       @XA12947*/ 01705000
@RF00738 L     @11,PDSADDR                                         0740 01706000
         ICM   @04,7,EOFTTR(@11)                                   0740 01707000
         BNZ   @RF00740                                            0740 01708000
         CLI   IOPDSID(IOPPTR),2                                   0740 01709000
         BE    @RT00740                                            0740 01710000
         CLI   IOPDSID(IOPPTR),33                                  0740 01711000
         BE    @RT00740                                            0740 01712000
         CLI   IOPDSID(IOPPTR),12                                  0740 01713000
         BE    @RT00740                                            0740 01714000
         CLI   IOPDSID(IOPPTR),28                                  0740 01715000
         BE    @RT00740                                            0740 01716000
         CLI   IOPDSID(IOPPTR),30                                  0740 01717000
         BNE   @RF00740                                            0740 01718000
@RT00740 DS    0H                                                  0741 01719000
*         DO;                       /*                       @XA12947*/ 01720000
*           SAVTTR=IOPTTR;          /* SAVE TTR ACROSS CALL TO EOFSTR   01721000
*                                      AS OPERATION MAY NOT BE ONE 0742 01722000
*                                      THAT RESETS TTR(IOPUDEO).   0742 01723000
*                                                            @ZA13037*/ 01724000
         MVC   SAVTTR(3),IOPTTR(IOPPTR)                            0742 01725000
*           SAVUSERL=IOPUSERL;      /* SAVE USER DATA LEN AND ALIAS     01726000
*                                      INDICATOR             @ZA14019*/ 01727000
         MVC   SAVUSERL(1),IOPUSERL(IOPPTR)                        0743 01728000
*           CALL EOFSTR;            /* GET EOF TTR           @XA12947*/ 01729000
         BAL   @14,EOFSTR                                          0744 01730000
*           IOPTTR=SAVTTR;          /* TTR OF MEMBER         @XA12947*/ 01731000
         MVC   IOPTTR(3,IOPPTR),SAVTTR                             0745 01732000
*           IOPUSERL=SAVUSERL;      /* RESET LEN AND ALIAS   @ZA14019*/ 01733000
         MVC   IOPUSERL(1,IOPPTR),SAVUSERL                         0746 01734000
*           IF IOPRETRN^=IOPGOOD    /* IF ERROR IN GETTING   @XA12947*/ 01735000
*             THEN                  /* EOF TTR THEN RETURN   @XA12947*/ 01736000
         CLI   IOPRETRN(IOPPTR),0                                  0747 01737000
         BNE   @RT00747                                            0747 01738000
*             GO TO EXIT;           /* WITH CODE PASSED BACK @XA12947*/ 01739000
*         END;                      /*                       @XA12947*/ 01740000
*                                                                  0749 01741000
*       /*************************************************************/ 01742000
*       /*                                                           */ 01743000
*       /* FUNCTION IS SMP PDS STOW CHANGE OR DELETE         @Z67SP00*/ 01744000
*       /*                                                           */ 01745000
*       /*************************************************************/ 01746000
*                                                                  0750 01747000
*       IF IOPFUNCT=IOPSTOWC        /* IS THIS STOW CHANGE OPERATION */ 01748000
*           |IOPFUNCT=IOPSTOWD      /* OR STOW DELETE OPERATION?     */ 01749000
*           |IOPFUNCT=IOPUDEO       /* OR UPDATE DIRECT ONLY @Z67SP00*/ 01750000
*         THEN                      /* YES                   @Z40SP00*/ 01751000
@RF00740 CLI   IOPFUNCT(IOPPTR),82                                 0750 01752000
         BE    @RT00750                                            0750 01753000
         CLI   IOPFUNCT(IOPPTR),83                                 0750 01754000
         BE    @RT00750                                            0750 01755000
         CLI   IOPFUNCT(IOPPTR),86                                 0750 01756000
         BNE   @RF00750                                            0750 01757000
@RT00750 DS    0H                                                  0751 01758000
*         DO;                                                      0751 01759000
*           CALL STOW;              /* DELETE OR CHANGE THE ENTRY    */ 01760000
         BAL   @14,STOW                                            0752 01761000
*           DSBFCNTO=ZERO;          /* RESET BUFFER COUNT    @Z67SP00*/ 01762000
         L     @11,PDSADDR                                         0753 01763000
         SLR   @04,@04                                             0753 01764000
         STH   @04,DSBFCNTO(,@11)                                  0753 01765000
*           GO TO EXIT;             /* RETURN TO REQUESTOR           */ 01766000
         B     EXIT                                                0754 01767000
*         END;                                                     0755 01768000
*                                                                  0755 01769000
*       /*************************************************************/ 01770000
*       /*                                                           */ 01771000
*       /* FUNCTION IS WRITE TO SMP PDS                      @Z67SP00*/ 01772000
*       /*                                                           */ 01773000
*       /*************************************************************/ 01774000
*                                                                  0756 01775000
*       IF IOPFUNCT=IOPWRITE        /* IS IT A WRITE OPERATION?      */ 01776000
*         THEN                      /* YES - DO WRITE OPERATION      */ 01777000
@RF00750 CLI   IOPFUNCT(IOPPTR),81                                 0756 01778000
         BNE   @RF00756                                            0756 01779000
*         DO;                                                      0757 01780000
*           DSBFCNTO=DSBFCNTO+1;    /* INCR RCDS IN BFR CNT  @SA74317*/ 01781000
         L     @11,PDSADDR                                         0758 01782000
         LA    @04,1                                               0758 01783000
         AH    @04,DSBFCNTO(,@11)                                  0758 01784000
         STH   @04,DSBFCNTO(,@11)                                  0758 01785000
*           DSOBUFR(DSBFCNTO)=LOGICREC;/* MOVE RCD TO BUFF   @SA74317*/ 01786000
         L     @03,DSBFPTRO                                        0759 01787000
         LR    @15,@04                                             0759 01788000
         MH    @15,@CH00512                                        0759 01789000
         ALR   @15,@03                                             0759 01790000
         AL    @15,@CF04248                                        0759 01791000
         L     @14,IOPBUFAD(,IOPPTR)                               0759 01792000
         MVC   DSOBUFR(80,@15),LOGICREC(@14)                       0759 01793000
*           WRITESW=ON;             /* INDICATE WRITE PERFORMED    0760 01794000
*                                                            @SA74317*/ 01795000
         OI    WRITESW(@11),B'10000000'                            0760 01796000
*           IF DSBFCNTO>=DSBFRMX    /* BUFFER FULL?          @SA74317*/ 01797000
*             THEN                  /* YES - WRITE IT        @SA74317*/ 01798000
         CH    @04,DSBFRMX                                         0761 01799000
         BL    @RF00761                                            0761 01800000
*             DO;                   /*                       @SA74317*/ 01801000
*               BUFFSV=IOPBUFAD;    /* SAVE BUFFER ADDR      @ZD00009*/ 01802000
         ST    @14,BUFFSV                                          0763 01803000
*               IOPBUFAD=DSBFPTRO;  /* SET OUTPUT BUFFR ADDR @Z67SP00*/ 01804000
         ST    @03,IOPBUFAD(,IOPPTR)                               0764 01805000
*               CALL WRITE;         /* WRITE RECORD TO THE CDS       */ 01806000
         BAL   @14,WRITE                                           0765 01807000
*               IOPBUFAD=BUFFSV;    /* RESET BUFFER ADDR     @ZD00009*/ 01808000
         MVC   IOPBUFAD(4,IOPPTR),BUFFSV                           0766 01809000
*               IF NOTESW=ON        /* NEED TO DUE NOTE?     @XA12947*/ 01810000
*                 THEN              /* YES - DUE TO JCLIN    @XA12947*/ 01811000
         L     @11,PDSADDR                                         0767 01812000
         TM    NOTESW(@11),B'01000000'                             0767 01813000
         BNO   @RF00767                                            0767 01814000
*                 DO;               /* PSEUDO STOW? THEN     @XA12947*/ 01815000
*                   CALL NOTE(IOPTTR);/* DO NOTE TO GET TTR  @XA12947*/ 01816000
         LA    @11,IOPTTR(,IOPPTR)                                 0769 01817000
         ST    @11,@AL00001                                        0769 01818000
         LA    @01,@AL00001                                        0769 01819000
         BAL   @14,NOTE                                            0769 01820000
*                   DCBRELAD(1:3)=IOPTTR;/* OF RCD JUST WRITTEN INTO    01821000
*                                      THE DCB FOR THE NEXT PSEUDO 0770 01822000
*                                      STOW                  @XA12947*/ 01823000
         MVC   DCBRELAD(3,DCBPTR),IOPTTR(IOPPTR)                   0770 01824000
*                   NOTESW=OFF;     /* RESET SW TO PREVENT   @XA12947*/ 01825000
         L     @11,PDSADDR                                         0771 01826000
         NI    NOTESW(@11),B'10111111'                             0771 01827000
*                 END;              /* NOTE ON NEXT WRITE    @XA12947*/ 01828000
*               DSBFCNTO=ZERO;      /* INIT CNT OF RCD IN BUF      0773 01829000
*                                                            @SA74317*/ 01830000
@RF00767 L     @11,PDSADDR                                         0773 01831000
         SLR   @04,@04                                             0773 01832000
         STH   @04,DSBFCNTO(,@11)                                  0773 01833000
*               GO TO EXIT;         /* RETURN TO CALLER.     @ZD00009*/ 01834000
         B     EXIT                                                0774 01835000
*             END;                                                 0775 01836000
*           GO TO GOODEXIT;         /* MOVE TO BUFR OK - RTN @SA74317*/ 01837000
         B     GOODEXIT                                            0776 01838000
*         END;                      /* END WRITE OPERATION   @SA74317*/ 01839000
         EJECT                                                          01840000
*                                                                  0778 01841000
*       /*************************************************************/ 01842000
*       /*                                                           */ 01843000
*       /* SMP PDS MEMBER IS TO BE REPLACED - CALCULATE LENGTH OF    */ 01844000
*       /* USER DATA BY LOOPING THRU ENTRY TILL FF BYTE IS FOUND.    */ 01845000
*       /*                                                           */ 01846000
*       /*************************************************************/ 01847000
*                                                                  0778 01848000
*       IF IOPFUNCT=IOPSTOWR        /* STOW REPLACE?         @Z40SP00*/ 01849000
*         THEN                      /* YES                   @Z40SP00*/ 01850000
@RF00756 CLI   IOPFUNCT(IOPPTR),84                                 0778 01851000
         BNE   @RF00778                                            0778 01852000
*         DO;                       /* DO OPERATION          @Z40SP00*/ 01853000
*                                                                  0779 01854000
*           /*********************************************************/ 01855000
*           /*                                                       */ 01856000
*           /* CALULATE LENGTH OF USER DATA                  @ZD00004*/ 01857000
*           /*                                                       */ 01858000
*           /*********************************************************/ 01859000
*                                                                  0780 01860000
*           CALL HMASMIO1(HMASMIOP,DIRLEN,XTNDLEN);/*        @Z67SP00*/ 01861000
         MVC   @AL00001+4(8),@AL00780                              0780 01862000
         ST    IOPPTR,@AL00001                                     0780 01863000
         L     @15,@CV03345                                        0780 01864000
         LA    @01,@AL00001                                        0780 01865000
         BALR  @14,@15                                             0780 01866000
*           IF IOPTYPE^=IOPLMD      /* NOT LMOD ENTRY        @ZD00008*/ 01867000
*               &IOPTYPE^=IOPASM    /* NOT ASM ENTRY         @ZD00008*/ 01868000
*               &(IOPDSID=IOPCDS    /* FOR CDS               @Z67SP00*/ 01869000
*               |IOPDSID=IOPACDS    /* OR ACDS               @Z67SP00*/ 01870000
*               |IOPDSID=IOPSCDS    /* OR SCDS               @Z67SP00*/ 01871000
*               |                   /* OR                    @Z67SP00*/ 01872000
*               (IOPDSID=IOPPTS     /* FOR PTS               @Z67SP00*/ 01873000
*               &(IOPTYPE=IOPSMD    /* SYSMOD ENTRY          @Z67SP00*/ 01874000
*               |IOPTYPE=IOPSYS))   /* OR SYSTEM ENTRY       @Z67SP00*/ 01875000
*               |                   /* OR                    @Z67SP00*/ 01876000
*               ((IOPDSID=IOPCRQ    /* CRQ                   @Z67SP00*/ 01877000
*               |IOPDSID=IOPACRQ)   /* OR ACRQ               @Z67SP00*/ 01878000
*               &IOPTYPE=IOPFMD))   /* AND TYPE IS FMID      @Z67SP00*/ 01879000
*             THEN                  /* NO - WRITE OUT RCD    @SA74317*/ 01880000
         CLI   IOPTYPE(IOPPTR),2                                   0781 01881000
         BE    @RF00781                                            0781 01882000
         CLI   IOPTYPE(IOPPTR),1                                   0781 01883000
         BE    @RF00781                                            0781 01884000
         CLI   IOPDSID(IOPPTR),2                                   0781 01885000
         BE    @RT00781                                            0781 01886000
         CLI   IOPDSID(IOPPTR),12                                  0781 01887000
         BE    @RT00781                                            0781 01888000
         CLI   IOPDSID(IOPPTR),33                                  0781 01889000
         BE    @RT00781                                            0781 01890000
         CLI   IOPDSID(IOPPTR),6                                   0781 01891000
         BNE   @GL00050                                            0781 01892000
         CLI   IOPTYPE(IOPPTR),11                                  0781 01893000
         BE    @RT00781                                            0781 01894000
         CLI   IOPTYPE(IOPPTR),7                                   0781 01895000
         BE    @RT00781                                            0781 01896000
@GL00050 CLI   IOPDSID(IOPPTR),28                                  0781 01897000
         BE    @GL00056                                            0781 01898000
         CLI   IOPDSID(IOPPTR),30                                  0781 01899000
         BNE   @RF00781                                            0781 01900000
@GL00056 CLI   IOPTYPE(IOPPTR),14                                  0781 01901000
         BNE   @RF00781                                            0781 01902000
@RT00781 DS    0H                                                  0782 01903000
*             DO;                   /* FROM IOP              @SA74317*/ 01904000
*               DSBFCNTO=ZERO;      /* INIT RCD IN BFR CNT   @SA74317*/ 01905000
         SLR   @11,@11                                             0783 01906000
         L     @04,PDSADDR                                         0783 01907000
         STH   @11,DSBFCNTO(,@04)                                  0783 01908000
*               IOPUSERL=DIRLEN/2;  /* CALC DIR LENGTH IN HALFWORDS     01909000
*                                                            @Z67SP00*/ 01910000
*                                                                  0784 01911000
         L     @00,DIRLEN                                          0784 01912000
         SRDA  @00,32                                              0784 01913000
         D     @00,@CF00183                                        0784 01914000
         STC   @01,IOPUSERL(,IOPPTR)                               0784 01915000
*               /*****************************************************/ 01916000
*               /*                                                   */ 01917000
*               /* IF GREATER THAN CAN BE CONTAINED IN ACTUAL USER   */ 01918000
*               /* DATA AREA THEN WRITE OVERFLOW DATA TO DATA AREA IN*/ 01919000
*               /* 80 BYTE MULTIPLES                         @Z40SP00*/ 01920000
*               /*                                                   */ 01921000
*               /*****************************************************/ 01922000
*                                                                  0785 01923000
*               IF XTNDLEN^=ZERO    /* IF DATA EXTENDED      @Z67SP00*/ 01924000
*                 THEN              /* YES                   @SA74317*/ 01925000
         C     @11,XTNDLEN                                         0785 01926000
         BE    @RF00785                                            0785 01927000
*                 DO;               /*                       @SA74317*/ 01928000
*                   DO J=1 TO XTNDLEN BY PDSLRECL;/* WRITE EXTEND  0787 01929000
*                                      DATA                  @Z67SP00*/ 01930000
         LA    @11,1                                               0787 01931000
         ST    @11,J                                               0787 01932000
         B     @DE00787                                            0787 01933000
@DL00787 DS    0H                                                  0788 01934000
*                     DSBFCNTO=DSBFCNTO+1;/* INCR RCD IN BUFR      0788 01935000
*                                                            @SA74317*/ 01936000
         L     @04,PDSADDR                                         0788 01937000
         LA    @03,1                                               0788 01938000
         AH    @03,DSBFCNTO(,@04)                                  0788 01939000
         STH   @03,DSBFCNTO(,@04)                                  0788 01940000
*                     TMPCPTR1=ADDR(XTNDCHAR(J));/* PTR TO NXT NEXT     01941000
*                                      80 CHAR RECORD        @Z67SP00*/ 01942000
         LA    @04,IOPUDATA(,IOPPTR)                               0789 01943000
         AL    @04,DIRLEN                                          0789 01944000
         BCTR  @04,0                                               0789 01945000
         LA    @11,XTNDCHAR(@11,@04)                               0789 01946000
         ST    @11,TMPCPTR1                                        0789 01947000
*                     DSOBUFR(DSBFCNTO)=TMPCPTR1->LOGICREC;/*      0790 01948000
*                                                            @SA74317*/ 01949000
         L     @04,DSBFPTRO                                        0790 01950000
         LR    @15,@03                                             0790 01951000
         MH    @15,@CH00512                                        0790 01952000
         ALR   @15,@04                                             0790 01953000
         AL    @15,@CF04248                                        0790 01954000
         MVC   DSOBUFR(80,@15),LOGICREC(@11)                       0790 01955000
*                     IF DSBFCNTO>=DSBFRMX/* BUFFER FULL?    @SA74317*/ 01956000
*                       THEN        /* YES                   @SA74317*/ 01957000
         CH    @03,DSBFRMX                                         0791 01958000
         BL    @RF00791                                            0791 01959000
*                       DO;         /* WRITE IT OUT          @SA74317*/ 01960000
*                         BUFFSV=IOPBUFAD;/* SAVE BUFFER ADDR      0793 01961000
*                                                            @ZD00009*/ 01962000
         MVC   BUFFSV(4),IOPBUFAD(IOPPTR)                          0793 01963000
*                         IOPBUFAD=DSBFPTRO;/* PTR TO BUFFER @Z67SP00*/ 01964000
         ST    @04,IOPBUFAD(,IOPPTR)                               0794 01965000
*                         CALL WRITE;/* WRITE BLOCK          @SA74317*/ 01966000
         BAL   @14,WRITE                                           0795 01967000
*                         IOPBUFAD=BUFFSV;/* RESET IOPBUFAD  @SA74317*/ 01968000
         MVC   IOPBUFAD(4,IOPPTR),BUFFSV                           0796 01969000
*                         DSBFCNTO=ZERO;/* RESET RCD IN BLOCK      0797 01970000
*                                                            @SA74317*/ 01971000
         L     @11,PDSADDR                                         0797 01972000
         SLR   @04,@04                                             0797 01973000
         STH   @04,DSBFCNTO(,@11)                                  0797 01974000
*                         IF NOTESW=ON/* NEED TO DUE NOTE?   @XA12947*/ 01975000
*                           THEN    /* YES - DUE TO JCLIN    @XA12947*/ 01976000
         TM    NOTESW(@11),B'01000000'                             0798 01977000
         BNO   @RF00798                                            0798 01978000
*                           DO;     /* PSEUDO STOW? THEN     @XA12947*/ 01979000
*                             CALL NOTE(IOPTTR);/* DO NOTE TO GET TTR   01980000
*                                                            @XA12947*/ 01981000
         LA    @11,IOPTTR(,IOPPTR)                                 0800 01982000
         ST    @11,@AL00001                                        0800 01983000
         LA    @01,@AL00001                                        0800 01984000
         BAL   @14,NOTE                                            0800 01985000
*                             DCBRELAD(1:3)=IOPTTR;/* OF RCD JUST  0801 01986000
*                                      WRITTEN INTO THE DCB FOR THE     01987000
*                                      NEXT PSEUDO STOW      @XA12947*/ 01988000
         MVC   DCBRELAD(3,DCBPTR),IOPTTR(IOPPTR)                   0801 01989000
*                             NOTESW=OFF;/* RESET SW TO PREVENT    0802 01990000
*                                                            @XA12947*/ 01991000
         L     @11,PDSADDR                                         0802 01992000
         NI    NOTESW(@11),B'10111111'                             0802 01993000
*                           END;    /* NOTE ON NEXT WRITE    @XA12947*/ 01994000
*                       END;        /* END WRITE GROUP       @SA74317*/ 01995000
@RF00798 DS    0H                                                  0805 01996000
*                   END;            /* END DO WRITE GROUP    @SA74317*/ 01997000
@RF00791 LA    @11,80                                              0805 01998000
         AL    @11,J                                               0805 01999000
         ST    @11,J                                               0805 02000000
@DE00787 C     @11,XTNDLEN                                         0805 02001000
         BNH   @DL00787                                            0805 02002000
*                 END;              /* END DIR EXTENDED      @SA74317*/ 02003000
*                                                                  0806 02004000
*               /*****************************************************/ 02005000
*               /*                                                   */ 02006000
*               /* MEMBER IS DIRECTORY ONLY. INDICATE IT AS AN ALIAS */ 02007000
*               /* OF EOF MEMBER. IF EOF NOT PRESENT, STOW IT AND    */ 02008000
*               /* RELOCATE IT TO OBTAIN TTR OF THE EOF RECORD       */ 02009000
*               /* ASSIGNED AND WRITTEN BY STOW. THE TTR IS PLACED IN*/ 02010000
*               /* THE DIRECTORY-ONLY CDS MEMBERS.           @SA74317*/ 02011000
*               /*                                                   */ 02012000
*               /*****************************************************/ 02013000
*                                                                  0807 02014000
*               ELSE                /* DIR NOT EXTENDED      @SA74317*/ 02015000
*                 DO;               /*                       @SA74317*/ 02016000
         B     @RC00785                                            0807 02017000
@RF00785 DS    0H                                                  0808 02018000
*                   IOPALIS=ON;     /* SET ALIAS INDICATOR   @Z67SP00*/ 02019000
         OI    IOPALIS(IOPPTR),B'10000000'                         0808 02020000
*                   IOPTTR=EOFTTR;  /* SET TTR TO EOF TTR    @Z67SP00*/ 02021000
         L     @11,PDSADDR                                         0809 02022000
         MVC   IOPTTR(3,IOPPTR),EOFTTR(@11)                        0809 02023000
*                   DSBFCNTO=ZERO;  /* RESET BUFFER COUNT    @Z67SP00*/ 02024000
         SLR   @04,@04                                             0810 02025000
         STH   @04,DSBFCNTO(,@11)                                  0810 02026000
*                 END;              /*                       @SA74317*/ 02027000
*             END;                  /* END NOT LMOD/ASM      @SA74317*/ 02028000
*                                                                  0812 02029000
@RC00785 DS    0H                                                  0813 02030000
*           /*********************************************************/ 02031000
*           /*                                                       */ 02032000
*           /* BEFORE DOING STOW WRITE OUT SHORT BLOCK IF ONE. THIS  */ 02033000
*           /* IS DONE FOR ALL TYPES OF ENTRIES(LMODS AND ASM).      */ 02034000
*           /*                                               @SA74317*/ 02035000
*           /*                                                       */ 02036000
*           /*********************************************************/ 02037000
*                                                                  0813 02038000
*           IF DSBFCNTO^=ZERO       /* ANY RCDS IN BUFFER?   @SA74317*/ 02039000
*             THEN                  /* YES                   @SA74317*/ 02040000
@RF00781 L     @11,PDSADDR                                         0813 02041000
         LH    @11,DSBFCNTO(,@11)                                  0813 02042000
         LTR   @11,@11                                             0813 02043000
         BZ    @RF00813                                            0813 02044000
*             DO;                   /* WRITE SHORT BLOCK     @SA74317*/ 02045000
*               BUFFSV=IOPBUFAD;    /* SAVE BUFFER ADDR      @ZD00009*/ 02046000
         MVC   BUFFSV(4),IOPBUFAD(IOPPTR)                          0815 02047000
*               IOPBUFAD=DSBFPTRO;  /* PTR TO BUFFER         @Z67SP00*/ 02048000
         MVC   IOPBUFAD(4,IOPPTR),DSBFPTRO                         0816 02049000
*               DCBBLKSI=DSBFCNTO*PDSLRECL;/* RESET BLOCK LENGTH   0817 02050000
*                                                            @SA74317*/ 02051000
         MH    @11,@CH00512                                        0817 02052000
         STH   @11,DCBBLKSI+52(,DCBPTR)                            0817 02053000
*               CALL WRITE;         /* WRITE IT              @SA74317*/ 02054000
         BAL   @14,WRITE                                           0818 02055000
*               DCBBLKSI=DSBFRMX*PDSLRECL;/* RESET BLOCKSIZE @SA74317*/ 02056000
         LH    @11,DSBFRMX                                         0819 02057000
         MH    @11,@CH00512                                        0819 02058000
         STH   @11,DCBBLKSI+52(,DCBPTR)                            0819 02059000
*               IOPBUFAD=BUFFSV;    /* RESET IOPBUFAD        @SA74317*/ 02060000
         MVC   IOPBUFAD(4,IOPPTR),BUFFSV                           0820 02061000
*               DSBFCNTO=ZERO;      /* RESET RCD IN BUFR COUNT     0821 02062000
*                                                            @SA74317*/ 02063000
         L     @11,PDSADDR                                         0821 02064000
         SLR   @04,@04                                             0821 02065000
         STH   @04,DSBFCNTO(,@11)                                  0821 02066000
*               IF NOTESW=ON        /* NEED TO DUE NOTE?     @XA12947*/ 02067000
*                 THEN              /* YES - DUE TO JCLIN    @XA12947*/ 02068000
         TM    NOTESW(@11),B'01000000'                             0822 02069000
         BNO   @RF00822                                            0822 02070000
*                 DO;               /* PSEUDO STOW? THEN     @XA12947*/ 02071000
*                   CALL NOTE(IOPTTR);/* DO NOTE TO GET TTR  @XA12947*/ 02072000
         LA    @11,IOPTTR(,IOPPTR)                                 0824 02073000
         ST    @11,@AL00001                                        0824 02074000
         LA    @01,@AL00001                                        0824 02075000
         BAL   @14,NOTE                                            0824 02076000
*                   DCBRELAD(1:3)=IOPTTR;/* OF RCD JUST WRITTEN INTO    02077000
*                                      THE DCB FOR THE NEXT PSEUDO 0825 02078000
*                                      STOW                  @XA12947*/ 02079000
         MVC   DCBRELAD(3,DCBPTR),IOPTTR(IOPPTR)                   0825 02080000
*                   NOTESW=OFF;     /* RESET SW TO PREVENT   @XA12947*/ 02081000
         L     @11,PDSADDR                                         0826 02082000
         NI    NOTESW(@11),B'10111111'                             0826 02083000
*                 END;              /* NOTE ON NEXT WRITE    @XA12947*/ 02084000
*             END;                  /*                       @SA74317*/ 02085000
*                                                                  0828 02086000
@RF00822 DS    0H                                                  0829 02087000
*           /*********************************************************/ 02088000
*           /*                                                       */ 02089000
*           /* ALL DATA RECORD WRITTEN TO DATASET. NOW STOW  @Z67SP00*/ 02090000
*           /* NOW DO STOW FOR MEMBER                        @Z67SP00*/ 02091000
*           /*                                                       */ 02092000
*           /*********************************************************/ 02093000
*                                                                  0829 02094000
*           CALL STOW;              /* STOW THE ENTRY        @Z67SP00*/ 02095000
@RF00813 BAL   @14,STOW                                            0829 02096000
*           WRITESW=OFF;            /* INDICATE NO WRITE HAS BEEN  0830 02097000
*                                      DONE                          */ 02098000
*                                                                  0830 02099000
         L     @11,PDSADDR                                         0830 02100000
         NI    WRITESW(@11),B'01111111'                            0830 02101000
*           /*********************************************************/ 02102000
*           /*                                                       */ 02103000
*           /* IF DATA SET HAS BEEN EXTENDED CLOSE BOTH INPUT AND    */ 02104000
*           /* OUTPUT DCBS TO INSURE THAT EXTENSION IS BROUGHT IN FOR*/ 02105000
*           /* NEXT INPUT OPERATION                          @ZD00004*/ 02106000
*           /*                                                       */ 02107000
*           /*********************************************************/ 02108000
*                                                                  0831 02109000
*           IF DCBDEBA^=PDSDEBAD    /* HAS DEB BEEN MOVED?   @Z67SP00*/ 02110000
*             THEN                  /* YES - DATA SET HAS NEW EXTENT */ 02111000
         CLC   DCBDEBA+40(3,DCBPTR),PDSDEBAD(@11)                  0831 02112000
         BE    @RF00831                                            0831 02113000
*             DO;                                                  0832 02114000
*               PDSDEBAD=ZERO;      /* SET TO SAVE DEB NEXT TIME THRU   02115000
*                                      OUTPUT FUNCTION       @Z67SP00*/ 02116000
         SLR   @04,@04                                             0833 02117000
         STCM  @04,7,PDSDEBAD(@11)                                 0833 02118000
*               DCBPTR=DCBS(IOPDSID,IN);/* CLOSE INPUT DCB FOR THIS     02119000
*                                      DATA SET              @ZA12350*/ 02120000
         SLR   @11,@11                                             0834 02121000
         IC    @11,IOPDSID(,IOPPTR)                                0834 02122000
         SLA   @11,4                                               0834 02123000
         L     DCBPTR,DCBS-16(@11)                                 0834 02124000
*               GEN(CLOSE ((DCBPTR)));/* CLOSE DCB           @XA12947*/ 02125000
         CLOSE ((DCBPTR))                                               02126000
*               IF DCBOFOPN=ON      /* CLOSE FAIL?           @XA12947*/ 02127000
*                 THEN              /* YES                   @XA12947*/ 02128000
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0836 02129000
         BO    @RT00836                                            0836 02130000
*                 GO TO CLOSFAIL;   /* GO WRITE ERR MSG      @XA12947*/ 02131000
*               DCBPTR=DCBS(IOPDSID,OUT);/* CLOSE OUTPUT DCB FOR THIS   02132000
*                                      DATA SET              @ZA12350*/ 02133000
         SLR   @11,@11                                             0838 02134000
         IC    @11,IOPDSID(,IOPPTR)                                0838 02135000
         SLA   @11,4                                               0838 02136000
         L     DCBPTR,DCBS-8(@11)                                  0838 02137000
*               GEN(CLOSE ((DCBPTR)));/* CLOSE INPUT DCB     @XA12947*/ 02138000
         CLOSE ((DCBPTR))                                               02139000
*               IF DCBOFOPN=ON      /* CLOSE FAIL?           @XA12947*/ 02140000
*                 THEN              /* YES                   @XA12947*/ 02141000
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0840 02142000
         BO    @RT00840                                            0840 02143000
*                 GO TO CLOSFAIL;   /* GO WRITE ERR MSG      @XA12947*/ 02144000
*             END;                  /*                       @XA12947*/ 02145000
*           GO TO EXIT;             /* RETURN TO REQUESTOR           */ 02146000
         B     EXIT                                                0843 02147000
*         END;                      /* END STOW REPLACE CODE @Z40SP00*/ 02148000
         EJECT                                                          02149000
*                                                                  0845 02150000
*       /*************************************************************/ 02151000
*       /*                                                           */ 02152000
*       /* CHECK TO SEE IF REQUEST TO WRITE OUT IN-STORAGE COPY OF   */ 02153000
*       /* DIRECTORY                                         @ZD00003*/ 02154000
*       /*                                                           */ 02155000
*       /*************************************************************/ 02156000
*                                                                  0845 02157000
*       IF IOPFUNCT=IOPWRDIR        /* IF WRITE DIR REQUEST  @ZD00003*/ 02158000
*         THEN                      /*                       @ZD00003*/ 02159000
@RF00778 CLI   IOPFUNCT(IOPPTR),89                                 0845 02160000
         BNE   @RF00845                                            0845 02161000
*         DO;                       /*                       @ZD00003*/ 02162000
*           CALL HMASMEIS(HMASMIOP);/* CALL EIS TO WRITE IT  @ZD00003*/ 02163000
         ST    IOPPTR,@AL00001                                     0847 02164000
         L     @15,@CV03343                                        0847 02165000
         LA    @01,@AL00001                                        0847 02166000
         BALR  @14,@15                                             0847 02167000
*           GO TO EXIT;             /* GO TO RETURN CODE     @ZD00003*/ 02168000
         B     EXIT                                                0848 02169000
*         END;                      /*                       @ZD00003*/ 02170000
*                                                                  0849 02171000
*       /*************************************************************/ 02172000
*       /*                                                           */ 02173000
*       /* INVALID OUTPUT REQUEST FOR SMP PDS                @Z40SP00*/ 02174000
*       /*                                                           */ 02175000
*       /*************************************************************/ 02176000
*                                                                  0850 02177000
*       IOPRETRN=IOPIOERR;          /* INVALID REQUEST SET   @Z67SP00*/ 02178000
@RF00845 MVI   IOPRETRN(IOPPTR),X'10'                              0850 02179000
*       GO TO EXIT;                 /* BAD RTN AND EXIT      @Z40SP00*/ 02180000
         B     EXIT                                                0851 02181000
*     END;                          /* END OF FUNCTION IS OUTPUT TYPE*/ 02182000
         EJECT                                                          02183000
*                                                                  0853 02184000
*   /*****************************************************************/ 02185000
*   /*                                                               */ 02186000
*   /* PDS READ OPERATION. IF NO MORE RECORDS IN CURRENT BUFFER READ */ 02187000
*   /* IN ANOTHER BLOCK AND RESET INDEX INTO BLOCK. MOVE RECORD      */ 02188000
*   /* POINTED TO BE INDEX FROM BLOCK TO USER BUFFER AREA    @YA07506*/ 02189000
*   /*                                                               */ 02190000
*   /*****************************************************************/ 02191000
*                                                                  0853 02192000
*   IF IOPFUNCT=IOPREAD             /* IS IT READ OPERATION?         */ 02193000
*     THEN                          /* YES - ISSUE READ              */ 02194000
@RF00736 CLI   IOPFUNCT(IOPPTR),1                                  0853 02195000
         BNE   @RF00853                                            0853 02196000
*     DO;                                                          0854 02197000
*       DSBFCNTI=DSBFCNTI+1;        /* INCR BUFFER NUMBER    @SA74317*/ 02198000
         L     @11,PDSADDR                                         0855 02199000
         LA    @04,1                                               0855 02200000
         AH    @04,DSBFCNTI(,@11)                                  0855 02201000
         STH   @04,DSBFCNTI(,@11)                                  0855 02202000
*       IF DSBFCNTI>DSBFSIZI        /* NO MORE RCDS IN BLOCK @SA74317*/ 02203000
*         THEN                      /* NO                    @SA74317*/ 02204000
         CH    @04,DSBFSIZI(,@11)                                  0856 02205000
         BNH   @RF00856                                            0856 02206000
*         DO;                       /* GET NEXT BLOCK        @SA74317*/ 02207000
*           BUFFSV=IOPBUFAD;        /* SAVE BUFFER ADDR      @ZD00009*/ 02208000
         MVC   BUFFSV(4),IOPBUFAD(IOPPTR)                          0858 02209000
*           IOPBUFAD=DSBFPTRI;      /* PTR TO INPUT BUFFR    @Z67SP00*/ 02210000
         MVC   IOPBUFAD(4,IOPPTR),DSBFPTRI                         0859 02211000
*           CALL READ;              /* READ A PDS RECORD             */ 02212000
         BAL   @14,READ                                            0860 02213000
*           IOPBUFAD=BUFFSV;        /* RESET IOPBUFAD        @SA74317*/ 02214000
         MVC   IOPBUFAD(4,IOPPTR),BUFFSV                           0861 02215000
*           IF IOPRETRN=IOPGOOD     /* READ OK?              @SA74317*/ 02216000
*               &DSBFRMX>ONE        /* AND PDS BLOCKED       @SA74317*/ 02217000
*             THEN                  /* YES                   @SA74317*/ 02218000
         CLI   IOPRETRN(IOPPTR),0                                  0862 02219000
         BNE   @RF00862                                            0862 02220000
         LH    @11,DSBFRMX                                         0862 02221000
         CH    @11,@CH00088                                        0862 02222000
         BNH   @RF00862                                            0862 02223000
*             DSBFSIZI=(DCBBLKSI-IOBRSCT)/PDSLRECL;/* CALC   @SA74317*/ 02224000
         LA    @11,52                                              0863 02225000
         ALR   @11,DCBPTR                                          0863 02226000
         L     @04,DCBIOBA(,@11)                                   0863 02227000
         LH    @00,DCBBLKSI(,@11)                                  0863 02228000
         SH    @00,IOBRSCT+8(,@04)                                 0863 02229000
         SRDA  @00,32                                              0863 02230000
         D     @00,@CF00512                                        0863 02231000
         L     @11,PDSADDR                                         0863 02232000
         STH   @01,DSBFSIZI(,@11)                                  0863 02233000
*           ELSE                    /* RCD IN BLOCK          @SA74317*/ 02234000
*             DSBFSIZI=ONE;         /* ELSE 1 RCD/BLK        @SA74317*/ 02235000
         B     @RC00862                                            0864 02236000
@RF00862 L     @11,PDSADDR                                         0864 02237000
         MVC   DSBFSIZI(2,@11),@CH00088                            0864 02238000
*           DSBFCNTI=ONE;           /* SET TO MOVE FIRST RCD @SA74317*/ 02239000
@RC00862 L     @11,PDSADDR                                         0865 02240000
         MVC   DSBFCNTI(2,@11),@CH00088                            0865 02241000
*         END;                      /* END READ GROUP        @SA74317*/ 02242000
*       IF IOPRETRN=IOPEOF          /* END OF FILE?          @SA74317*/ 02243000
*         THEN                      /* YES                   @SA74317*/ 02244000
@RF00856 CLI   IOPRETRN(IOPPTR),4                                  0867 02245000
         BNE   @RF00867                                            0867 02246000
*         DSBFCNTI=ZERO;            /* RESET RCD COUNT       @SA74317*/ 02247000
         L     @11,PDSADDR                                         0868 02248000
         SLR   @04,@04                                             0868 02249000
         STH   @04,DSBFCNTI(,@11)                                  0868 02250000
*       ELSE                        /* NOT EOF               @SA74317*/ 02251000
*         LOGICREC=DSIBUFR(DSBFCNTI);/* MV RCD TO USER BUFR  @SA74317*/ 02252000
         B     @RC00867                                            0869 02253000
@RF00867 L     @11,IOPBUFAD(,IOPPTR)                               0869 02254000
         L     @04,PDSADDR                                         0869 02255000
         LH    @04,DSBFCNTI(,@04)                                  0869 02256000
         MH    @04,@CH00512                                        0869 02257000
         L     @03,DSBFPTRI                                        0869 02258000
         ALR   @03,@04                                             0869 02259000
         AL    @03,@CF04248                                        0869 02260000
         MVC   LOGICREC(80,@11),DSIBUFR(@03)                       0869 02261000
*       GO TO EXIT;                 /* RETURN TO REQUESTOR           */ 02262000
         B     EXIT                                                0870 02263000
*     END;                                                         0871 02264000
*                                                                  0871 02265000
*   /*****************************************************************/ 02266000
*   /*                                                               */ 02267000
*   /* FUNCTION IS PDS POSITION FOR INPUT(POINT) ISSUE POINT AND     */ 02268000
*   /* RETURN                                                @Z40SP00*/ 02269000
*   /*                                                               */ 02270000
*   /*****************************************************************/ 02271000
*                                                                  0872 02272000
*   IF IOPFUNCT=IOPPOSI             /* POSITION INPUT OPERATION?     */ 02273000
*     THEN                          /* YES - POINT AND RETURN        */ 02274000
@RF00853 CLI   IOPFUNCT(IOPPTR),2                                  0872 02275000
         BNE   @RF00872                                            0872 02276000
*     DO;                                                          0873 02277000
*       CALL POINT;                 /* POSITION FOR INPUT            */ 02278000
         BAL   @14,POINT                                           0874 02279000
*       DSBFCNTI=ZERO;              /* INIT INDEX INTO BLOCK @SA74317*/ 02280000
         SLR   @11,@11                                             0875 02281000
         L     @04,PDSADDR                                         0875 02282000
         STH   @11,DSBFCNTI(,@04)                                  0875 02283000
*       DSBFSIZI=ZERO;              /* INIT NUM RCD IN BLOCK @SA74317*/ 02284000
         STH   @11,DSBFSIZI(,@04)                                  0876 02285000
*       GO TO EXIT;                 /* AND RETURN            @Z40SP00*/ 02286000
         B     EXIT                                                0877 02287000
*     END;                                                         0878 02288000
         EJECT                                                          02289000
*                                                                  0879 02290000
*   /*****************************************************************/ 02291000
*   /*                                                               */ 02292000
*   /* FUNCTION IS SMPCDS/SMPACDS LOCATE OR BLDL. IF FUNCTION WAS    */ 02293000
*   /* BLDL OR IF MEMBER IS ALIAS RETURN ELSE READ DIRECTORY         */ 02294000
*   /* EXTENSION.                                                    */ 02295000
*   /*                                                               */ 02296000
*   /*****************************************************************/ 02297000
*                                                                  0879 02298000
*   IF IOPFUNCT=IOPLOC              /* LOCATE?               @Z40SP00*/ 02299000
*       |IOPFUNCT=IOPBLDL           /* OR BLDL?              @Z40SP00*/ 02300000
*       |IOPFUNCT=IOPXTND           /* OR EXTEND NTRY IN IOP @ZD00002*/ 02301000
*     THEN                          /* YES                   @Z40SP00*/ 02302000
@RF00872 CLI   IOPFUNCT(IOPPTR),3                                  0879 02303000
         BE    @RT00879                                            0879 02304000
         CLI   IOPFUNCT(IOPPTR),4                                  0879 02305000
         BE    @RT00879                                            0879 02306000
         CLI   IOPFUNCT(IOPPTR),7                                  0879 02307000
         BNE   @RF00879                                            0879 02308000
@RT00879 DS    0H                                                  0880 02309000
*     DO;                           /*                       @Z40SP00*/ 02310000
*                                                                  0880 02311000
*       /*************************************************************/ 02312000
*       /*                                                           */ 02313000
*       /* CALC DIRECTORY LENGTH                             @Z67SP00*/ 02314000
*       /*                                                           */ 02315000
*       /*************************************************************/ 02316000
*                                                                  0881 02317000
*       CALL HMASMIO1(HMASMIOP,DIRLEN,XTNDLEN);/*            @Z67SP00*/ 02318000
         MVC   @AL00001+4(8),@AL00881                              0881 02319000
         ST    IOPPTR,@AL00001                                     0881 02320000
         L     @15,@CV03345                                        0881 02321000
         LA    @01,@AL00001                                        0881 02322000
         BALR  @14,@15                                             0881 02323000
*       IF IOPFUNCT^=IOPXTND        /* IF DIR DATA NOT ALREADY IN IOP   02324000
*                                                            @ZD00002*/ 02325000
*         THEN                      /* THEN GET IT VIA BLDL  @ZD00002*/ 02326000
         CLI   IOPFUNCT(IOPPTR),7                                  0882 02327000
         BE    @RF00882                                            0882 02328000
*         DO;                       /*                       @Z67SP00*/ 02329000
*           CALL BLDL;              /* LOCATE MEMBER IN THE CDS      */ 02330000
         BAL   @14,BLDL                                            0884 02331000
*           IF IOPRETRN=IOPNTFND    /* IF NOT FOUND          @Z67SP00*/ 02332000
*               &IOPTYPE=IOPSYS     /* AND WAS SYSTEM ENTRY  @Z67SP00*/ 02333000
*               &(IOPDSID=IOPCDS|IOPDSID=IOPACDS)/* CDS      @Z67SP00*/ 02334000
*             THEN                  /* FORMAT THEN TRY TO    @Z67SP00*/ 02335000
         CLI   IOPRETRN(IOPPTR),4                                  0885 02336000
         BNE   @RF00885                                            0885 02337000
         CLI   IOPTYPE(IOPPTR),7                                   0885 02338000
         BNE   @RF00885                                            0885 02339000
         CLI   IOPDSID(IOPPTR),2                                   0885 02340000
         BE    @RT00885                                            0885 02341000
         CLI   IOPDSID(IOPPTR),12                                  0885 02342000
         BNE   @RF00885                                            0885 02343000
@RT00885 DS    0H                                                  0886 02344000
*             DO;                   /* LOC IN R3 FORMAT      @Z67SP00*/ 02345000
*               SAVSYS=IOPINAME;    /* SAVE R4 INTERNAL      @Z67SP00*/ 02346000
         MVC   SAVSYS(8),IOPINAME(IOPPTR)                          0887 02347000
*               IOPINAME=OLDSYS;    /* SET NAME              @Z67SP00*/ 02348000
         MVC   IOPINAME(8,IOPPTR),@CC03371                         0888 02349000
*               CALL BLDL;          /* LOCATE IT             @Z67SP00*/ 02350000
         BAL   @14,BLDL                                            0889 02351000
*               IOPINAME=SAVSYS;    /* RESET NAME            @Z67SP00*/ 02352000
         MVC   IOPINAME(8,IOPPTR),SAVSYS                           0890 02353000
*             END;                  /*                       @Z67SP00*/ 02354000
*         END;                      /*                       @Z67SP00*/ 02355000
@RF00885 DS    0H                                                  0893 02356000
*       IF IOPRETRN^=IOPGOOD        /* IF MEMBER NOT FOUND   @YA07506*/ 02357000
*           |IOPFUNCT=IOPBLDL       /* OR WAS BLDL ONLY      @Z40SP00*/ 02358000
*         THEN                      /* YES - THEN NO EXTENSION       */ 02359000
@RF00882 CLI   IOPRETRN(IOPPTR),0                                  0893 02360000
         BNE   @RT00893                                            0893 02361000
         CLI   IOPFUNCT(IOPPTR),4                                  0893 02362000
         BE    @RT00893                                            0893 02363000
*         GO TO EXIT;               /* RETURN TO REQUESTOR           */ 02364000
*       IF IOPTYPE=IOPSMD           /* IF SYSMOD TYPE        @Z67SP00*/ 02365000
*           &IOPDUMMP=ON            /* AND NO DATA           @Z67SP00*/ 02366000
*         THEN                      /*                       @Z67SP00*/ 02367000
         CLI   IOPTYPE(IOPPTR),11                                  0895 02368000
         BNE   @RF00895                                            0895 02369000
         TM    IOPDUMMP(IOPPTR),B'00000100'                        0895 02370000
         BNO   @RF00895                                            0895 02371000
*         DO;                       /*                       @Z67SP00*/ 02372000
*           IOPPTFFX=''B;           /* ZERO FIXED FIELDS     @Z67SP00*/ 02373000
         XC    IOPPTFFX(80,IOPPTR),IOPPTFFX(IOPPTR)                0897 02374000
*           IOPPFMID='';            /* BLANK FMID FIELD      @Z67SP00*/ 02375000
         MVI   IOPPFMID(IOPPTR),C' '                               0898 02376000
         MVC   IOPPFMID+1(6,IOPPTR),IOPPFMID(IOPPTR)               0898 02377000
*           IOPPTFND(1)=IOPEOLST;   /* SET END OF LIST MARK  @Z67SP00*/ 02378000
         MVI   IOPPTFND(IOPPTR),X'FF'                              0899 02379000
*           GO TO GOODEXIT;         /*                       @Z67SP00*/ 02380000
         B     GOODEXIT                                            0900 02381000
*         END;                      /*                       @Z67SP00*/ 02382000
*       IF IOPALIS=ON               /* IF ALIAS              @Z67SP00*/ 02383000
*           |IOPDSID=IOPWK5         /* OR SMPWRK5 DATASET    @Z67SP00*/ 02384000
*           |IOPTYPE=IOPASM         /* OR ASM?               @ZD00004*/ 02385000
*           |(IOPDSID=IOPPTS        /* OR PTS DATASET        @Z67SP00*/ 02386000
*           &IOPTYPE=IOPMCS)        /* AND MCS TYPE ENTRY    @Z67SP00*/ 02387000
*           |IOPDSID=IOPMTS         /* OR MTS                @Z67SP00*/ 02388000
*           |IOPDSID=IOPSTS         /* OR STS                @Z67SP00*/ 02389000
*           |((IOPDSID=IOPCRQ|IOPDSID=IOPACRQ)/* OR CRQ/ACRQ @Z67SP00*/ 02390000
*           &IOPTYPE=IOPCSR)        /* CAUSER ENTRY          @Z67SP00*/ 02391000
*         THEN                      /* THEN NO EXTEND DATA   @ZD00004*/ 02392000
@RF00895 TM    IOPALIS(IOPPTR),B'10000000'                         0902 02393000
         BO    @RT00902                                            0902 02394000
         CLI   IOPDSID(IOPPTR),39                                  0902 02395000
         BE    @RT00902                                            0902 02396000
         CLI   IOPTYPE(IOPPTR),1                                   0902 02397000
         BE    @RT00902                                            0902 02398000
         CLI   IOPDSID(IOPPTR),6                                   0902 02399000
         BNE   @GL00068                                            0902 02400000
         CLI   IOPTYPE(IOPPTR),16                                  0902 02401000
         BE    @RT00902                                            0902 02402000
@GL00068 CLI   IOPDSID(IOPPTR),18                                  0902 02403000
         BE    @RT00902                                            0902 02404000
         CLI   IOPDSID(IOPPTR),26                                  0902 02405000
         BE    @RT00902                                            0902 02406000
         CLI   IOPDSID(IOPPTR),28                                  0902 02407000
         BE    @GL00073                                            0902 02408000
         CLI   IOPDSID(IOPPTR),30                                  0902 02409000
         BNE   @RF00902                                            0902 02410000
@GL00073 CLI   IOPTYPE(IOPPTR),15                                  0902 02411000
         BE    @RT00902                                            0902 02412000
*         GO TO GOODEXIT;           /* RETURN                @ZD00004*/ 02413000
*                                                                  0903 02414000
*       /*************************************************************/ 02415000
*       /*                                                           */ 02416000
*       /* THIS DIRECTORY ENTRY IS EXTENDED - READ EXTENSION FROM THE*/ 02417000
*       /* SMPCDS/SMPACDS DATA PORTION AND APPEND IT TO THE USER DATA*/ 02418000
*       /* FIELD IN THE HMASMIOP                             @Z40SP00*/ 02419000
*       /*                                                           */ 02420000
*       /*************************************************************/ 02421000
*                                                                  0904 02422000
*       CALL POINT;                 /* POSITION TO READ EXTENSION    */ 02423000
@RF00902 BAL   @14,POINT                                           0904 02424000
*       DSBFCNTI=ONE;               /* SET INDEX INTO BLOCK TO MOVE     02425000
*                                      FIRST RCD             @SA74317*/ 02426000
         LA    @11,1                                               0905 02427000
         L     @04,PDSADDR                                         0905 02428000
         STH   @11,DSBFCNTI(,@04)                                  0905 02429000
*       DSBFSIZI=ZERO;              /* SET NUM OF RCDS IN BLOCK TO 0906 02430000
*                                      ZERO TO FORCE READ    @SA74317*/ 02431000
         SLR   @03,@03                                             0906 02432000
         STH   @03,DSBFSIZI(,@04)                                  0906 02433000
*       DO N=1 TO CCAPESIZ-DIRLEN BY PDSLRECL;/* LOOP TO READ      0907 02434000
*                                      EXTENSION             @Z67SP00*/ 02435000
         ST    @11,N                                               0907 02436000
         B     @DE00907                                            0907 02437000
@DL00907 DS    0H                                                  0908 02438000
*         IF DSBFCNTI>DSBFSIZI      /* ANY MORE RCDS IN BLK? @SA74317*/ 02439000
*           THEN                    /* NO                    @SA74317*/ 02440000
         L     @11,PDSADDR                                         0908 02441000
         LH    @04,DSBFCNTI(,@11)                                  0908 02442000
         CH    @04,DSBFSIZI(,@11)                                  0908 02443000
         BNH   @RF00908                                            0908 02444000
*           DO;                     /* READ ANOTHER BLOCK    @SA74317*/ 02445000
*             BUFFSV=IOPBUFAD;      /* SAVE BUFFER ADDR      @ZD00009*/ 02446000
         MVC   BUFFSV(4),IOPBUFAD(IOPPTR)                          0910 02447000
*             IOPBUFAD=DSBFPTRI;    /* PTR TO INPUT BUFFER   @Z67SP00*/ 02448000
         MVC   IOPBUFAD(4,IOPPTR),DSBFPTRI                         0911 02449000
*             CALL READ;            /* READ EXTENSION MEMBER RECORD  */ 02450000
         BAL   @14,READ                                            0912 02451000
*             IOPBUFAD=BUFFSV;      /* RESET IOPBUFAD        @SA74317*/ 02452000
         MVC   IOPBUFAD(4,IOPPTR),BUFFSV                           0913 02453000
*             IF IOPRETRN=IOPGOOD   /* READ OK?              @SA74317*/ 02454000
*                 &DSBFRMX>ONE      /* AND PDS BLOCKED?      @SA74317*/ 02455000
*               THEN                /* YES - CALC RCD PER BLK      0914 02456000
*                                                            @SA74317*/ 02457000
         CLI   IOPRETRN(IOPPTR),0                                  0914 02458000
         BNE   @RF00914                                            0914 02459000
         LH    @11,DSBFRMX                                         0914 02460000
         CH    @11,@CH00088                                        0914 02461000
         BNH   @RF00914                                            0914 02462000
*               DSBFSIZI=(DCBBLKSI-IOBRSCT)/PDSLRECL;/*      @SA74317*/ 02463000
         LA    @11,52                                              0915 02464000
         ALR   @11,DCBPTR                                          0915 02465000
         L     @04,DCBIOBA(,@11)                                   0915 02466000
         LH    @00,DCBBLKSI(,@11)                                  0915 02467000
         SH    @00,IOBRSCT+8(,@04)                                 0915 02468000
         SRDA  @00,32                                              0915 02469000
         D     @00,@CF00512                                        0915 02470000
         L     @11,PDSADDR                                         0915 02471000
         STH   @01,DSBFSIZI(,@11)                                  0915 02472000
*             ELSE                  /* PDS NOT BLOCKED       @SA74317*/ 02473000
*               DSBFSIZI=ONE;       /* SET BLOCKING FACTOR   @SA74317*/ 02474000
         B     @RC00914                                            0916 02475000
@RF00914 L     @11,PDSADDR                                         0916 02476000
         MVC   DSBFSIZI(2,@11),@CH00088                            0916 02477000
*             DSBFCNTI=ZERO;        /* INIT INDEX IN CASE READ ERR 0917 02478000
*                                                            @SA74317*/ 02479000
@RC00914 L     @11,PDSADDR                                         0917 02480000
         SLR   @04,@04                                             0917 02481000
         STH   @04,DSBFCNTI(,@11)                                  0917 02482000
*             IF IOPRETRN=IOPEOF    /* HAVE ALL RECORDS BEEN READ?   */ 02483000
*               THEN                /* YES                   @Z40SP00*/ 02484000
         CLI   IOPRETRN(IOPPTR),4                                  0918 02485000
         BE    @RT00918                                            0918 02486000
*               GO TO GOODEXIT;     /* RETURN WITH RC=0      @ZD00004*/ 02487000
*             IF IOPRETRN>IOPEOF    /* I/O ERROR?                    */ 02488000
*               THEN                /* EXIT TO REQUESTOR             */ 02489000
         CLI   IOPRETRN(IOPPTR),4                                  0920 02490000
         BH    @RT00920                                            0920 02491000
*               GO TO EXIT;         /* WITH ERROR INDICATOR          */ 02492000
*             DSBFCNTI=ONE;         /* SET TO MOVE FIRST RCD @SA74317*/ 02493000
         MVC   DSBFCNTI(2,@11),@CH00088                            0922 02494000
*           END;                    /* END READ GROUP        @SA74317*/ 02495000
*         TMPCPTR1=ADDR(XTNDCHAR(N));/* PTR TO NXT 80 CHARS  @Z40SP00*/ 02496000
@RF00908 L     @11,N                                               0924 02497000
         LA    @04,IOPUDATA(,IOPPTR)                               0924 02498000
         AL    @04,DIRLEN                                          0924 02499000
         BCTR  @04,0                                               0924 02500000
         LA    @04,XTNDCHAR(@11,@04)                               0924 02501000
         ST    @04,TMPCPTR1                                        0924 02502000
*         TMPCPTR1->LOGICREC=DSIBUFR(DSBFCNTI);/* MOVE RCD FROM BLOCK   02503000
*                                      TO IOP AREA           @SA74317*/ 02504000
         L     @03,PDSADDR                                         0925 02505000
         LH    @15,DSBFCNTI(,@03)                                  0925 02506000
         LR    @14,@15                                             0925 02507000
         MH    @14,@CH00512                                        0925 02508000
         L     @01,DSBFPTRI                                        0925 02509000
         ALR   @01,@14                                             0925 02510000
         AL    @01,@CF04248                                        0925 02511000
         MVC   LOGICREC(80,@04),DSIBUFR(@01)                       0925 02512000
*         IF IOPTYPE=IOPLMD         /* IF LMOD THEN RETURN   @Z67SP00*/ 02513000
*           THEN                    /* AFTER READING FIRST   @Z67SP00*/ 02514000
         CLI   IOPTYPE(IOPPTR),2                                   0926 02515000
         BE    @RT00926                                            0926 02516000
*           GOTO EXIT;              /* DATA RECORD           @Z67SP00*/ 02517000
*         DSBFCNTI=DSBFCNTI+ONE;    /* INCR INDEX TO NEXT RCD      0928 02518000
*                                                            @SA74317*/ 02519000
         AH    @15,@CH00088                                        0928 02520000
         STH   @15,DSBFCNTI(,@03)                                  0928 02521000
*       END;                                                       0929 02522000
*                                                                  0929 02523000
         AL    @11,@CF00512                                        0929 02524000
         ST    @11,N                                               0929 02525000
@DE00907 L     @04,@CA00038                                        0929 02526000
         L     @04,CCAPESIZ-HMASMCCA(,@04)                         0929 02527000
         SL    @04,DIRLEN                                          0929 02528000
         CR    @11,@04                                             0929 02529000
         BNH   @DL00907                                            0929 02530000
*       /*************************************************************/ 02531000
*       /*                                                           */ 02532000
*       /* IOP FULL. CHECK FOR ANY MORE RCDS IN BLOCK OR TRY ANOTHER */ 02533000
*       /* READ TO CHECK FOR EOF CONDITION                   @SA74317*/ 02534000
*       /*                                                           */ 02535000
*       /*************************************************************/ 02536000
*                                                                  0930 02537000
*       IF DSBFCNTI>DSBFSIZI        /* ANY MORE RCDS IN BLOCK?     0930 02538000
*                                                            @SA74317*/ 02539000
*         THEN                      /* NO                    @SA74317*/ 02540000
         L     @11,PDSADDR                                         0930 02541000
         LH    @04,DSBFCNTI(,@11)                                  0930 02542000
         CH    @04,DSBFSIZI(,@11)                                  0930 02543000
         BNH   @RF00930                                            0930 02544000
*         DO;                       /* TRY ANOTHER READ      @SA74317*/ 02545000
*           BUFFSV=IOPBUFAD;        /* SAVE BUFFER ADDR      @ZD00009*/ 02546000
         MVC   BUFFSV(4),IOPBUFAD(IOPPTR)                          0932 02547000
*           IOPBUFAD=DSBFPTRI;      /* PTR TO INPUT BUFFER   @Z67SP00*/ 02548000
         MVC   IOPBUFAD(4,IOPPTR),DSBFPTRI                         0933 02549000
*           CALL READ;              /* DO READ               @SA74317*/ 02550000
         BAL   @14,READ                                            0934 02551000
*           IOPBUFAD=BUFFSV;        /* RESET IOPBUFAD        @SA74317*/ 02552000
         MVC   IOPBUFAD(4,IOPPTR),BUFFSV                           0935 02553000
*           IF IOPRETRN=IOPEOF      /* END OF FILE?          @SA74317*/ 02554000
*             THEN                  /* YES - THEN LOC OK     @SA74317*/ 02555000
         CLI   IOPRETRN(IOPPTR),4                                  0936 02556000
         BE    @RT00936                                            0936 02557000
*             GO TO GOODEXIT;       /* RETURN WITH RC=0      @ZD00004*/ 02558000
*         END;                      /* MORE RCD THAN IOP - ERR     0938 02559000
*                                                            @SA74317*/ 02560000
*       MGPMGNO1=HMA219I;           /* PTF ELEMENT MAXIMUM EXCEEDED     02561000
*                                                            @Z67SP00*/ 02562000
@RF00930 MVC   MGPMGNO1(2),@CH00355                                0939 02563000
*       MGPMGNO2=PART032;           /* FOR XXXXXXXX XXXXXXXX @Z67SP00*/ 02564000
         MVC   MGPMGNO2(2),@CH00086                                0940 02565000
*       MGPMGNO3=PART016;           /* ON XXXXXXXX LIBRARY   @Z67SP00*/ 02566000
         MVC   MGPMGNO3(2),@CH00188                                0941 02567000
*       MGPVARPT(1)=ADDR(CCATYPEA(IOPTYPE));/* TYPE MEMBER   @ZD00008*/ 02568000
         SLR   @11,@11                                             0942 02569000
         IC    @11,IOPTYPE(,IOPPTR)                                0942 02570000
         SLA   @11,3                                               0942 02571000
         L     @04,@CA00038                                        0942 02572000
         L     @03,CCATPAD-HMASMCCA(,@04)                          0942 02573000
         AL    @03,@CF04239                                        0942 02574000
         LA    @11,CCATYPEA(@11,@03)                               0942 02575000
         ST    @11,MGPVARPT                                        0942 02576000
*       MGPVARPT(2)=ADDR(IOPNAME);  /* MEMBER NAME           @Z67SP00*/ 02577000
         LA    @11,IOPNAME(,IOPPTR)                                0943 02578000
         ST    @11,MGPVARPT+4                                      0943 02579000
*       MGPVARPT(3)=ADDR(CCADSIDA(IOPDSID));/* DD NAME       @Z67SP00*/ 02580000
         SLR   @11,@11                                             0944 02581000
         IC    @11,IOPDSID(,IOPPTR)                                0944 02582000
         SLA   @11,3                                               0944 02583000
         L     @03,CCADSAD-HMASMCCA(,@04)                          0944 02584000
         AL    @03,@CF04239                                        0944 02585000
         LA    @11,CCADSIDA(@11,@03)                               0944 02586000
         ST    @11,MGPVARPT+8                                      0944 02587000
*       IF CCALIST=ON               /* IF LIST FUNCTION      @Z67SP00*/ 02588000
*         THEN                      /* THEN ONLY             @ZD00001*/ 02589000
         TM    CCALIST-HMASMCCA(@04),B'00000001'                   0945 02590000
         BNO   @RF00945                                            0945 02591000
*         MGPTYPE=MGPWARN;          /* WARNING               @ZD00001*/ 02592000
         MVI   MGPTYPE,X'02'                                       0946 02593000
*       ELSE                        /* ELSE MESSAGE IS       @ZD00001*/ 02594000
*         IF CCAUPDJ=ON             /* IF JCLIN THEN         @Z67SP00*/ 02595000
*             |CCACNV=ON            /* OR CONVERT            @Z67SP00*/ 02596000
*           THEN                    /*                       @ZD00005*/ 02597000
         B     @RC00945                                            0947 02598000
@RF00945 L     @11,@CA00038                                        0947 02599000
         TM    CCAUPDJ-HMASMCCA(@11),B'00000100'                   0947 02600000
         BO    @RT00947                                            0947 02601000
         TM    CCACNV-HMASMCCA(@11),B'10000000'                    0947 02602000
         BNO   @RF00947                                            0947 02603000
@RT00947 DS    0H                                                  0948 02604000
*           MGPTYPE=MGPSEV;         /* STOP CONVERT          @ZD00005*/ 02605000
         MVI   MGPTYPE,X'04'                                       0948 02606000
*         ELSE                      /*                       @ZD00005*/ 02607000
*           MGPTYPE=MGPERR;         /* ERR TO STOP PTF       @ZD00001*/ 02608000
         B     @RC00947                                            0949 02609000
@RF00947 MVI   MGPTYPE,X'03'                                       0949 02610000
*       CALL HMASMMSG(HMASMMGP);    /* WRITE MSG             @YA05690*/ 02611000
@RC00947 DS    0H                                                  0950 02612000
@RC00945 L     @15,@CV03346                                        0950 02613000
         LA    @01,@AL00950                                        0950 02614000
         BALR  @14,@15                                             0950 02615000
*       IOPRETRN=IOPEXC;            /* SET RETURN CODE       @YA05690*/ 02616000
         MVI   IOPRETRN(IOPPTR),X'08'                              0951 02617000
*       GO TO EXIT;                 /* RETURN TO CALLER      @YA05690*/ 02618000
         B     EXIT                                                0952 02619000
*     END;                          /* END BLDL OR LOC       @Z40SP00*/ 02620000
*                                                                  0953 02621000
*   /*****************************************************************/ 02622000
*   /*                                                               */ 02623000
*   /* IF REQUEST FOR IN-STORAGE DIRECTORY OPERATION         @ZD00003*/ 02624000
*   /*                                                               */ 02625000
*   /*****************************************************************/ 02626000
*                                                                  0954 02627000
*   IF IOPFUNCT=IOPINIT             /* INIT IN-STORE-DIR?    @ZD00003*/ 02628000
*       |IOPFUNCT=IOPFREE           /* FREE IN-STORE-DIR?    @ZD00003*/ 02629000
*       |(DISISW=ON                 /* OR DIR IS IN STORE    @Z67SP00*/ 02630000
*       &(IOPFUNCT=IOPCLOSN         /* AND CLOSE REQUEST?    @ZD00003*/ 02631000
*       |IOPFUNCT=IOPGETN))         /* OR GET NEXT?          @ZD00003*/ 02632000
*     THEN                          /* THEN PROCESS VIA CALL @ZD00003*/ 02633000
@RF00879 CLI   IOPFUNCT(IOPPTR),8                                  0954 02634000
         BE    @RT00954                                            0954 02635000
         CLI   IOPFUNCT(IOPPTR),9                                  0954 02636000
         BE    @RT00954                                            0954 02637000
         TM    DISISW,B'00010000'                                  0954 02638000
         BNO   @RF00954                                            0954 02639000
         CLI   IOPFUNCT(IOPPTR),12                                 0954 02640000
         BE    @RT00954                                            0954 02641000
         CLI   IOPFUNCT(IOPPTR),10                                 0954 02642000
         BNE   @RF00954                                            0954 02643000
@RT00954 DS    0H                                                  0955 02644000
*     DO;                           /*                       @ZD00003*/ 02645000
*       IF IOPFUNCT=IOPINIT         /* IF INIT REQUEST       @Z67SP00*/ 02646000
*         THEN                      /*                       @Z67SP00*/ 02647000
         CLI   IOPFUNCT(IOPPTR),8                                  0956 02648000
         BNE   @RF00956                                            0956 02649000
*         IF(IOPDSID=IOPCDS&CCACDSIS=OFF)/* AND DATASET      @Z67SP00*/ 02650000
*             |(IOPDSID=IOPACDS&CCAACDIS=OFF)/* NOT IN       @Z67SP00*/ 02651000
*             |(IOPDSID=IOPCRQ&CCACRQIS=OFF)/* STORAGE       @Z67SP00*/ 02652000
*             |(IOPDSID=IOPACRQ&CCAACRIS=OFF)/*              @Z67SP00*/ 02653000
*           THEN                    /*                       @Z67SP00*/ 02654000
         CLI   IOPDSID(IOPPTR),2                                   0957 02655000
         BNE   @GL00083                                            0957 02656000
         L     @11,@CA00038                                        0957 02657000
         TM    CCACDSIS-HMASMCCA(@11),B'10000000'                  0957 02658000
         BZ    @RT00957                                            0957 02659000
@GL00083 CLI   IOPDSID(IOPPTR),12                                  0957 02660000
         BNE   @GL00082                                            0957 02661000
         L     @11,@CA00038                                        0957 02662000
         TM    CCAACDIS-HMASMCCA(@11),B'01000000'                  0957 02663000
         BZ    @RT00957                                            0957 02664000
@GL00082 CLI   IOPDSID(IOPPTR),28                                  0957 02665000
         BNE   @GL00081                                            0957 02666000
         L     @11,@CA00038                                        0957 02667000
         TM    CCACRQIS-HMASMCCA(@11),B'00100000'                  0957 02668000
         BZ    @RT00957                                            0957 02669000
@GL00081 CLI   IOPDSID(IOPPTR),30                                  0957 02670000
         BNE   @RF00957                                            0957 02671000
         L     @11,@CA00038                                        0957 02672000
         TM    CCAACRIS-HMASMCCA(@11),B'00010000'                  0957 02673000
         BNZ   @RF00957                                            0957 02674000
@RT00957 DS    0H                                                  0958 02675000
*           CALL HMASMEIS(HMASMIOP);/* LOAD DIRECTORY        @Z67SP00*/ 02676000
         ST    IOPPTR,@AL00001                                     0958 02677000
         L     @15,@CV03343                                        0958 02678000
         LA    @01,@AL00001                                        0958 02679000
         BALR  @14,@15                                             0958 02680000
*         ELSE                      /* IN INIT AND DIR IN    @Z67SP00*/ 02681000
*           ;                       /* STORAGE - NO PROCESS  @Z67SP00*/ 02682000
@RF00957 DS    0H                                                  0960 02683000
*       ELSE                        /* IF NOT INIT           @Z67SP00*/ 02684000
*         CALL HMASMEIS(HMASMIOP);  /* CALL EIS              @ZD00003*/ 02685000
         B     @RC00956                                            0960 02686000
@RF00956 ST    IOPPTR,@AL00001                                     0960 02687000
         L     @15,@CV03343                                        0960 02688000
         LA    @01,@AL00001                                        0960 02689000
         BALR  @14,@15                                             0960 02690000
*       IF IOPRETRN=IOPGOOD         /* IF FUNCTION WAS OK    @ZD00003*/ 02691000
*         THEN                      /* THEN MUST TRANSLATE   @ZD00003*/ 02692000
@RC00956 CLI   IOPRETRN(IOPPTR),0                                  0961 02693000
         BNE   @RF00961                                            0961 02694000
*         DO;                       /*                       @Z67SP00*/ 02695000
*           IF IOPFUNCT=IOPGETN     /* IF GETNEXT            @Z67SP00*/ 02696000
*             THEN                  /*                       @Z67SP00*/ 02697000
         CLI   IOPFUNCT(IOPPTR),10                                 0963 02698000
         BNE   @RF00963                                            0963 02699000
*             CALL HMASMION(HMASMIOP);/* VIA CALL TO ION     @ZD00003*/ 02700000
         ST    IOPPTR,@AL00001                                     0964 02701000
         L     @15,@CV03344                                        0964 02702000
         LA    @01,@AL00001                                        0964 02703000
         BALR  @14,@15                                             0964 02704000
*           ELSE                    /*                       @Z67SP00*/ 02705000
*             IF IOPFUNCT=IOPINIT   /* IF REQUEST TO INIT    @Z67SP00*/ 02706000
*               THEN                /* DIS FILE THEN SET SW  @Z67SP00*/ 02707000
         B     @RC00963                                            0965 02708000
@RF00963 CLI   IOPFUNCT(IOPPTR),8                                  0965 02709000
         BNE   @RF00965                                            0965 02710000
*               NOTESW=ON;          /* TO CAUSE NOTE FOR TTR @Z67SP00*/ 02711000
         L     @11,PDSADDR                                         0966 02712000
         OI    NOTESW(@11),B'01000000'                             0966 02713000
*         END;                      /*                       @Z67SP00*/ 02714000
*       GO TO EXIT;                 /* GO TO EXIT CODE       @ZD00003*/ 02715000
         B     EXIT                                                0968 02716000
*     END;                          /*                       @ZD00003*/ 02717000
*                                                                  0969 02718000
*   /*****************************************************************/ 02719000
*   /*                                                               */ 02720000
*   /* IF FUNCTION WAS REQUEST TO GET NEXT DIRECTORY ENTRY OR CLOSE  */ 02721000
*   /* FOR GET NEXT FUNCTION THEN CALL IO GET NEXT ROUTINE   @ZD00008*/ 02722000
*   /*                                                               */ 02723000
*   /*****************************************************************/ 02724000
*                                                                  0970 02725000
*   IF IOPFUNCT=IOPGETN             /* IF GET NEXT           @ZD00008*/ 02726000
*       |IOPFUNCT=IOPGETNC          /* OR GET NEXT WITH CNT  @ZD00008*/ 02727000
*       |IOPFUNCT=IOPCLOSN          /* OR GET NEXT CLOSE     @ZD00008*/ 02728000
*     THEN                          /*                       @ZD00008*/ 02729000
@RF00954 CLI   IOPFUNCT(IOPPTR),10                                 0970 02730000
         BE    @RT00970                                            0970 02731000
         CLI   IOPFUNCT(IOPPTR),11                                 0970 02732000
         BE    @RT00970                                            0970 02733000
         CLI   IOPFUNCT(IOPPTR),12                                 0970 02734000
         BNE   @RF00970                                            0970 02735000
@RT00970 DS    0H                                                  0971 02736000
*     DO;                           /*                       @ZD00008*/ 02737000
*       CALL IORDS;                 /*                       @ZD00008*/ 02738000
         BAL   @14,IORDS                                           0972 02739000
*       GO TO EXIT;                 /*                       @ZD00008*/ 02740000
         B     EXIT                                                0973 02741000
*     END;                          /*                       @ZD00008*/ 02742000
*                                                                  0974 02743000
*   /*****************************************************************/ 02744000
*   /*                                                               */ 02745000
*   /* INVALID INPUT REQUEST FOR SMPCDS/SMPACDS              @Z40SP00*/ 02746000
*   /*                                                               */ 02747000
*   /*****************************************************************/ 02748000
*                                                                  0975 02749000
*   IOPRETRN=IOPIOERR;              /* SET BAD RTN CDE AND   @Z40SP00*/ 02750000
@RF00970 MVI   IOPRETRN(IOPPTR),X'10'                              0975 02751000
*   GO TO EXIT;                     /* RETURN                @Z40SP00*/ 02752000
         B     EXIT                                                0976 02753000
         EJECT                                                          02754000
*                                                                  0977 02755000
*   /*****************************************************************/ 02756000
*   /*                                                               */ 02757000
*   /* THE FOLLOWING SETS UP TO HANDLE THE SMPOUT DATASET    @Z67SP00*/ 02758000
*   /*                                                               */ 02759000
*   /*****************************************************************/ 02760000
*                                                                  0977 02761000
*PRTRTN:                                                           0977 02762000
*   ARRYADDR=ADDR(SMPARRAY);        /* PTR TO CORRECT DATA   @Z40SP00*/ 02763000
PRTRTN   LA    @11,SMPARRAY                                        0977 02764000
         ST    @11,ARRYADDR                                        0977 02765000
*   PGLEN=CCAPGLEN;                 /* PAGE LEN SPEC BY USER @Z67SP00*/ 02766000
         L     @11,@CA00038                                        0978 02767000
         MVC   PGLEN(2),CCAPGLEN-HMASMCCA(@11)                     0978 02768000
*   GO TO PRINTRTN;                 /* GO TO PROCESS LINE    @Z40SP00*/ 02769000
*                                                                  0979 02770000
         B     PRINTRTN                                            0979 02771000
*   /*****************************************************************/ 02772000
*   /*                                                               */ 02773000
*   /* THE FOLLOWING SETS UP TO HANDLE THE SYSPRINT DATASET  @Z67SP00*/ 02774000
*   /*                                                               */ 02775000
*   /*****************************************************************/ 02776000
*                                                                  0980 02777000
*SYSRTN:                            /*                       @Z40SP00*/ 02778000
*   ARRYADDR=ADDR(SYSARRAY);        /* PTR TO CORRECT DATA   @Z40SP00*/ 02779000
SYSRTN   LA    @11,SYSARRAY                                        0980 02780000
         ST    @11,ARRYADDR                                        0980 02781000
*   PGLEN=PGLENDFT;                 /* FIXED PAGE LEN=60     @Z67SP00*/ 02782000
         MVC   PGLEN(2),@CH00805                                   0981 02783000
*   GO TO PRINTRTN;                 /* GO TO PROCESS LINE    @Z40SP00*/ 02784000
*                                                                  0982 02785000
         B     PRINTRTN                                            0982 02786000
*   /*****************************************************************/ 02787000
*   /*                                                               */ 02788000
*   /* THE FOLLOWING SETS UP TO HANDLE THE SMPRPT DATASET    @Z67SP00*/ 02789000
*   /*                                                               */ 02790000
*   /*****************************************************************/ 02791000
*                                                                  0983 02792000
*RPTRTN:                            /*                       @Z67SP00*/ 02793000
*   ARRYADDR=ADDR(RPTARRAY);        /* PTR TO CORRECT DATA   @Z67SP00*/ 02794000
RPTRTN   LA    @11,RPTARRAY                                        0983 02795000
         ST    @11,ARRYADDR                                        0983 02796000
*   PGLEN=PGLENDFT;                 /* FIXED PAGE LEN=60     @Z67SP00*/ 02797000
         MVC   PGLEN(2),@CH00805                                   0984 02798000
*   GO TO PRINTRTN;                 /*                       @Z67SP00*/ 02799000
*                                                                  0985 02800000
         B     PRINTRTN                                            0985 02801000
*   /*****************************************************************/ 02802000
*   /*                                                               */ 02803000
*   /* THE FOLLOWING SETS UP TO HANDLE THE SMPLIST DATASET   @Z67SP00*/ 02804000
*   /*                                                               */ 02805000
*   /*****************************************************************/ 02806000
*                                                                  0986 02807000
*LSTRTN:                            /*                       @Z67SP00*/ 02808000
*   ARRYADDR=ADDR(LSTARRAY);        /* PTR TO CORRECT DATA   @Z67SP00*/ 02809000
LSTRTN   LA    @11,LSTARRAY                                        0986 02810000
         ST    @11,ARRYADDR                                        0986 02811000
*   PGLEN=PGLENDFT;                 /* FIXED PAGE LEN=60     @Z67SP00*/ 02812000
         MVC   PGLEN(2),@CH00805                                   0987 02813000
*   GO TO PRINTRTN;                 /*                       @Z67SP00*/ 02814000
         B     PRINTRTN                                            0988 02815000
*                                                                  0989 02816000
*   /*****************************************************************/ 02817000
*   /*                                                               */ 02818000
*   /* COMMON CODE TO HANDLE THE SMPOUT AND SYSPRINT DATA SET@Z40SP00*/ 02819000
*   /*                                                               */ 02820000
*   /*****************************************************************/ 02821000
*                                                                  0989 02822000
*PRINTRTN:                          /*                       @Z40SP00*/ 02823000
*                                                                  0989 02824000
*   /*****************************************************************/ 02825000
*   /*                                                               */ 02826000
*   /* ADD A HEADING TO THE SMPOUT/SYSPRINT DATA SETS        @Z40SP00*/ 02827000
*   /*                                                               */ 02828000
*   /*****************************************************************/ 02829000
*                                                                  0989 02830000
*   IF PRLHEAD=ON                   /* IS THIS A HEADER ADDITION?    */ 02831000
*     THEN                          /* YES - ADD HEADER TO BUFFER    */ 02832000
PRINTRTN L     @11,IOPBUFAD(,IOPPTR)                               0989 02833000
         TM    PRLHEAD(@11),B'10000000'                            0989 02834000
         BNO   @RF00989                                            0989 02835000
*     DO;                           /* BUILD HEADER BUFFER           */ 02836000
*       HEADCT=HEADCT+1;            /* BUMP HEADER COUNT             */ 02837000
         L     @04,ARRYADDR                                        0991 02838000
         LA    @03,1                                               0991 02839000
         AH    @03,HEADCT(,@04)                                    0991 02840000
         STH   @03,HEADCT(,@04)                                    0991 02841000
*       LINECT=LINEMAX;             /* SET LINES PRINTED TO MAX VALUE   02842000
*                                      TO FORCE NEW PAGE ON NEXT   0992 02843000
*                                      WRITE                 @Z67SP00*/ 02844000
         MVC   LINECT(2,@04),@CH03486                              0992 02845000
*       IF PRLBLANK=ON              /* DOES PRL INDICATE BLNK LINE?  */ 02846000
*         THEN                      /* YES - POINT TO BLNK LINE      */ 02847000
         TM    PRLBLANK(@11),B'00100000'                           0993 02848000
         BNO   @RF00993                                            0993 02849000
*         HEADADDR(HEADCT)=ADDR(PRNTBUF);/* POINT TO BUFFER          */ 02850000
         SLA   @03,2                                               0994 02851000
         LA    @11,PRNTBUF                                         0994 02852000
         AL    @04,@CF04250                                        0994 02853000
         ST    @11,HEADADDR(@03,@04)                               0994 02854000
*       ELSE                        /* ELSE IT IS NON-BLANK          */ 02855000
*         HEADADDR(HEADCT)=PRLHDADR;/* SAVE HEADER ADDRESS           */ 02856000
         B     @RC00993                                            0995 02857000
@RF00993 L     @11,ARRYADDR                                        0995 02858000
         LH    @04,HEADCT(,@11)                                    0995 02859000
         SLA   @04,2                                               0995 02860000
         L     @03,IOPBUFAD(,IOPPTR)                               0995 02861000
         SLR   @15,@15                                             0995 02862000
         ICM   @15,7,PRLHDADR(@03)                                 0995 02863000
         AL    @11,@CF04250                                        0995 02864000
         ST    @15,HEADADDR(@04,@11)                               0995 02865000
*       GO TO GOODEXIT;             /* RETURN WITH GOOD RETURN CODE  */ 02866000
         B     GOODEXIT                                            0996 02867000
*     END;                                                         0997 02868000
*                                                                  0998 02869000
*   /*****************************************************************/ 02870000
*   /*                                                               */ 02871000
*   /* DELETE ALL HEADINGS FROM THE SMPOUT/SYSPRINT DATA SETS@Z40SP00*/ 02872000
*   /*                                                               */ 02873000
*   /*****************************************************************/ 02874000
*                                                                  0998 02875000
*   IF PRLHEADO=ON                  /* CLEAR HEAD REQUEST?           */ 02876000
*     THEN                          /* YES - CLEAR OUT BUFFER        */ 02877000
@RF00989 L     @11,IOPBUFAD(,IOPPTR)                               0998 02878000
         TM    PRLHEADO(@11),B'01000000'                           0998 02879000
         BNO   @RF00998                                            0998 02880000
*     DO;                           /* RESET HEADER INDICATORS       */ 02881000
*       HEADCT=HEADSTRT;            /* RESET HEADER COUNTER          */ 02882000
         L     @11,ARRYADDR                                        1000 02883000
         MVC   HEADCT(2,@11),@CH00183                              1000 02884000
*       LINECT=LINEMAX;             /* SET LINES PRINTED TO MAX VALUE   02885000
*                                      TO FORCE NEW PAGE HEADINGS  1001 02886000
*                                      WHEN NEXT LINE PRINTED      1001 02887000
*                                                            @Z67SP00*/ 02888000
         MVC   LINECT(2,@11),@CH03486                              1001 02889000
*       GO TO GOODEXIT;             /* RETURN TO REQUESTOR           */ 02890000
         B     GOODEXIT                                            1002 02891000
*     END;                                                         1003 02892000
*                                                                  1003 02893000
*   /*****************************************************************/ 02894000
*   /*                                                               */ 02895000
*   /* IF THE DATA SET IS SYSPRINT THEN CHECK TO SEE IF THERE WAS A  */ 02896000
*   /* PREVIOUS I/O ERROR. IF SO THEN RETURN WITH BAD CODE   @Z40SP00*/ 02897000
*   /*                                                               */ 02898000
*   /*****************************************************************/ 02899000
*                                                                  1004 02900000
*   IF IOPDSID=IOPSYSPT             /* SYSPRINT DATA SET     @Z40SP00*/ 02901000
*       &SYSPDEAD=ON                /* AND PREVIOUS ERROR    @Z40SP00*/ 02902000
*     THEN                          /* YES                   @Z40SP00*/ 02903000
@RF00998 CLI   IOPDSID(IOPPTR),20                                  1004 02904000
         BNE   @RF01004                                            1004 02905000
         TM    SYSPDEAD,B'10000000'                                1004 02906000
         BNO   @RF01004                                            1004 02907000
*     DO;                           /* RETURN WITH BAD CODE  @Z40SP00*/ 02908000
*       IOPRETRN=IOPIOERR;          /* BAD RETURN CODE       @Z40SP00*/ 02909000
         MVI   IOPRETRN(IOPPTR),X'10'                              1006 02910000
*       GO TO EXIT;                 /* RETURN TO CALLER      @Z40SP00*/ 02911000
         B     EXIT                                                1007 02912000
*     END;                          /* END SYSPRINT DEAD     @Z40SP00*/ 02913000
*                                                                  1008 02914000
*   /*****************************************************************/ 02915000
*   /*                                                               */ 02916000
*   /* IF REQUEST TO WRITE BLANK LINE AND AT TOP OF NEXT PAGE THEN DO*/ 02917000
*   /* NOT WRITE LINE. RETURN WITH RC=0                      @Z67SP00*/ 02918000
*   /*                                                               */ 02919000
*   /*****************************************************************/ 02920000
*                                                                  1009 02921000
*   IF LINECT>=PGLEN-HEADCT         /* IF AT BOTTOM OF PAGE  @Z67SP00*/ 02922000
*       &(PRLBLANK=ON               /* AND REQUEST FOR BLANK @Z67SP00*/ 02923000
*       |PRLDATA(1:PRLRLEN)=PRNTDATA(1:PRLRLEN))/* OR LINE   @Z67SP00*/ 02924000
*     THEN                          /* TO WRITE IS BLANK     @Z67SP00*/ 02925000
@RF01004 L     @11,ARRYADDR                                        1009 02926000
         LH    @04,PGLEN                                           1009 02927000
         SH    @04,HEADCT(,@11)                                    1009 02928000
         CH    @04,LINECT(,@11)                                    1009 02929000
         BH    @RF01009                                            1009 02930000
         L     @11,IOPBUFAD(,IOPPTR)                               1009 02931000
         TM    PRLBLANK(@11),B'00100000'                           1009 02932000
         BO    @RT01009                                            1009 02933000
         LH    @04,PRLRLEN(,@11)                                   1009 02934000
         BCTR  @04,0                                               1009 02935000
         EX    @04,@SC04251                                        1009 02936000
         BE    @RT01009                                            1009 02937000
*     GO TO GOODEXIT;               /* (PRNTDATA INIT TO BLANK) THEN    02938000
*                                      RETURN WITH NO WRITE  @Z67SP00*/ 02939000
*                                                                  1011 02940000
*   /*****************************************************************/ 02941000
*   /*                                                               */ 02942000
*   /* PUT PAGE NUMBER, TIME AND DATE INTO THE PAGE HEADING AND PRINT*/ 02943000
*   /* THE SMPOUT/SYSPRINT HEADINGS PREVIOUSLY SET UP        @Z40SP00*/ 02944000
*   /*                                                               */ 02945000
*   /*****************************************************************/ 02946000
*                                                                  1011 02947000
*   IF LINECT>=PGLEN-HEADCT         /* IF NUMBER OF LINES ALREADY  1011 02948000
*                                      PRINTED WAS MAX       @Z67SP00*/ 02949000
*     THEN                          /* THEN MUST START AT            */ 02950000
@RF01009 L     @11,ARRYADDR                                        1011 02951000
         LH    @04,PGLEN                                           1011 02952000
         SH    @04,HEADCT(,@11)                                    1011 02953000
         CH    @04,LINECT(,@11)                                    1011 02954000
         BH    @RF01011                                            1011 02955000
*     DO;                           /* TOP OF NEW PAGE               */ 02956000
*       LINECT=ZERO;                /* NO LINES PRINTED      @Z67SP00*/ 02957000
         SLR   @04,@04                                             1013 02958000
         STH   @04,LINECT(,@11)                                    1013 02959000
*       IF IOPDSID=IOPPRINT         /* WORKING WITH SMPOUT?  @Z40SP00*/ 02960000
*         THEN                      /* YES                   @Z40SP00*/ 02961000
         CLI   IOPDSID(IOPPTR),11                                  1014 02962000
         BNE   @RF01014                                            1014 02963000
*         MHEAD=OUTHEAD;            /* SET FOR SMPOUT HEADING@Z40SP00*/ 02964000
         MVC   MHEAD(31),OUTHEAD                                   1015 02965000
*       ELSE                        /*                       @Z40SP00*/ 02966000
*         IF IOPDSID=IOPSYSPT       /* IS IT SYSPRINT?       @Z67SP00*/ 02967000
*           THEN                    /*                       @Z67SP00*/ 02968000
         B     @RC01014                                            1016 02969000
@RF01014 CLI   IOPDSID(IOPPTR),20                                  1016 02970000
         BNE   @RF01016                                            1016 02971000
*           MHEAD=PRNTHEAD;         /* SET FOR SYSPRINT      @Z40SP00*/ 02972000
         MVI   MHEAD+15,C' '                                       1017 02973000
         MVC   MHEAD+16(15),MHEAD+15                               1017 02974000
         MVC   MHEAD(15),PRNTHEAD                                  1017 02975000
*         ELSE                      /*                       @Z67SP00*/ 02976000
*           IF IOPDSID=IOPRPT       /* IF SMPRPT                     */ 02977000
*             THEN                  /*                               */ 02978000
         B     @RC01016                                            1018 02979000
@RF01016 CLI   IOPDSID(IOPPTR),41                                  1018 02980000
         BNE   @RF01018                                            1018 02981000
*             MHEAD=RPTHEAD;        /* MUST BE SMPRPT        @Z67SP00*/ 02982000
         MVI   MHEAD+13,C' '                                       1019 02983000
         MVC   MHEAD+14(17),MHEAD+13                               1019 02984000
         MVC   MHEAD(13),RPTHEAD                                   1019 02985000
*           ELSE                    /*                       @Z67SP00*/ 02986000
*             MHEAD=LSTHEAD;        /*                       @Z67SP00*/ 02987000
         B     @RC01018                                            1020 02988000
@RF01018 MVI   MHEAD+14,C' '                                       1020 02989000
         MVC   MHEAD+15(16),MHEAD+14                               1020 02990000
         MVC   MHEAD(14),LSTHEAD                                   1020 02991000
*       PAGENO=PAGENO+1;            /* BUMP PAGE COUNTER             */ 02992000
@RC01018 DS    0H                                                  1021 02993000
@RC01016 DS    0H                                                  1021 02994000
@RC01014 L     @11,ARRYADDR                                        1021 02995000
         LA    @04,1                                               1021 02996000
         LH    @03,PAGENO(,@11)                                    1021 02997000
         ALR   @03,@04                                             1021 02998000
         STH   @03,PAGENO(,@11)                                    1021 02999000
*       CVD(PAGENO,DBLWRD);         /* CONVERT PAGE NUMBER           */ 03000000
         CVD   @03,DBLWRD                                          1022 03001000
*       UNPK(PAGEFLD,DBLWRD);       /* PUT PAGENO IN OUTPUT LINE     */ 03002000
         UNPK  PAGEFLD(4),DBLWRD(8)                                1023 03003000
*       LASTDIG=LASTDIG|MAKPRINT;   /* MAKE LAST DIG PRINTABLE       */ 03004000
         OI    LASTDIG,X'F0'                                       1024 03005000
*       UNPK(DATE,CCADATE);         /* MAKE DATE PRINTABLE           */ 03006000
         L     @11,@CA00038                                        1025 03007000
         UNPK  DATE(5),CCADATE-HMASMCCA(3,@11)                     1025 03008000
*       DAY=DAY|MAKPRINT;           /* MAKE DATE PRINTABLE           */ 03009000
         OI    DAY,X'F0'                                           1026 03010000
*       YY=DATEYY;                  /* PUT YEAR INTO MESSAGE         */ 03011000
         MVC   YY(2),DATEYY                                        1027 03012000
*       DDD=DATEDDD;                /* PUT DAY INTO MESSAGE          */ 03013000
         MVC   DDD(3),DATEDDD                                      1028 03014000
*       TIMETEMP(1:3)=CCATIME;      /* GET TIME FROM CCA     @SA74333*/ 03015000
         MVC   TIMETEMP(3),CCATIME-HMASMCCA(@11)                   1029 03016000
*       UNPK(TIMEAREA,TIMETEMP);    /* UNPACK TIME STAMP     @SA74333*/ 03017000
         UNPK  TIMEAREA(8),TIMETEMP(4)                             1030 03018000
*       HH=TIMEHH;                  /* MOVE HOURS            @SA74333*/ 03019000
         MVC   HH(2),TIMEHH                                        1031 03020000
*       MM=TIMEMM;                  /* MOVE MINUTES          @SA74333*/ 03021000
         MVC   MM(2),TIMEMM                                        1032 03022000
*       TT=TIMETT;                  /* MOVE TENTHS           @SA74333*/ 03023000
         MVC   TT(2),TIMETT                                        1033 03024000
*       DO K=1 TO HEADCT;           /* LOOP THROUGH HEADERS          */ 03025000
         B     @DE01034                                            1034 03026000
@DL01034 DS    0H                                                  1035 03027000
*         BUFFSV=IOPBUFAD;          /* SAVE BUFFER ADDR      @ZD00009*/ 03028000
         MVC   BUFFSV(4),IOPBUFAD(IOPPTR)                          1035 03029000
*         IOPBUFAD=HEADADDR(K);     /* GET HEADING ADDR      @YA07506*/ 03030000
         SLA   @04,2                                               1036 03031000
         L     @11,ARRYADDR                                        1036 03032000
         AL    @11,@CF04250                                        1036 03033000
         L     @11,HEADADDR(@04,@11)                               1036 03034000
         ST    @11,IOPBUFAD(,IOPPTR)                               1036 03035000
*         SAVRETRN(IOENTCNT)=IOPRETRN;/* SAVE CURR RETURN    @ZA25875*/ 03036000
         SLR   @11,@11                                             1037 03037000
         IC    @11,IOENTCNT                                        1037 03038000
         SLR   @04,@04                                             1037 03039000
         IC    @04,IOPRETRN(,IOPPTR)                               1037 03040000
         STC   @04,SAVRETRN-1(@11)                                 1037 03041000
*         CALL PUT;                 /* OUTPUT HEADER                 */ 03042000
         BAL   @14,PUT                                             1038 03043000
*         IOPBUFAD=BUFFSV;          /* RESET BUFFER ADDR     @ZD00009*/ 03044000
         MVC   IOPBUFAD(4,IOPPTR),BUFFSV                           1039 03045000
*         IF IOPRETRN^=IOPGOOD      /* SUCCESS?              @YA07506*/ 03046000
*           THEN                    /* NO - RETURN TO CALLER         */ 03047000
         CLI   IOPRETRN(IOPPTR),0                                  1040 03048000
         BE    @RF01040                                            1040 03049000
*           DO;                     /*                       @ZA99999*/ 03050000
*             IOPRETRN=MAX(IOPRETRN,SAVRETRN(IOENTCNT));/*   @ZA25875*/ 03051000
         SLR   @11,@11                                             1042 03052000
         IC    @11,IOENTCNT                                        1042 03053000
         SLR   @04,@04                                             1042 03054000
         IC    @04,IOPRETRN(,IOPPTR)                               1042 03055000
         SLR   @03,@03                                             1042 03056000
         IC    @03,SAVRETRN-1(@11)                                 1042 03057000
         CR    @04,@03                                             1042 03058000
         BNL   *+6                                                      03059000
         LR    @04,@03                                             1042 03060000
         STC   @04,IOPRETRN(,IOPPTR)                               1042 03061000
*             GO TO EXIT;           /* RETURN                        */ 03062000
         B     EXIT                                                1043 03063000
*           END;                    /*                       @ZA99999*/ 03064000
*         IOPRETRN=SAVRETRN(IOENTCNT);/* RESET RTN CODE      @ZA99999*/ 03065000
@RF01040 SLR   @11,@11                                             1045 03066000
         IC    @11,IOENTCNT                                        1045 03067000
         SLR   @04,@04                                             1045 03068000
         IC    @04,SAVRETRN-1(@11)                                 1045 03069000
         STC   @04,IOPRETRN(,IOPPTR)                               1045 03070000
*       END;                                                       1046 03071000
         LA    @04,1                                               1046 03072000
         AL    @04,K                                               1046 03073000
@DE01034 ST    @04,K                                               1046 03074000
         L     @11,ARRYADDR                                        1046 03075000
         CH    @04,HEADCT(,@11)                                    1046 03076000
         BNH   @DL01034                                            1046 03077000
*     END;                                                         1047 03078000
*                                                                  1048 03079000
*   /*****************************************************************/ 03080000
*   /*                                                               */ 03081000
*   /* PRINT THE SMPOUT/SYSPRINT DATA LINE                   @Z40SP00*/ 03082000
*   /*                                                               */ 03083000
*   /*****************************************************************/ 03084000
*                                                                  1048 03085000
*   IF PRLBLANK=OFF                 /* BLANK LINE?                   */ 03086000
*     THEN                          /* NO - MOVE USER LINE           */ 03087000
@RF01011 L     @11,IOPBUFAD(,IOPPTR)                               1048 03088000
         TM    PRLBLANK(@11),B'00100000'                           1048 03089000
         BNZ   @RF01048                                            1048 03090000
*     IF PRLRLEN>=LENGTH(PRNTDATA)  /* LENGTH GREATER OR EQUAL TO  1049 03091000
*                                      MAX?                  @Z40SP00*/ 03092000
*       THEN                        /* YES                   @Z40SP00*/ 03093000
         LH    @04,PRLRLEN(,@11)                                   1049 03094000
         CH    @04,@CH03564                                        1049 03095000
         BL    @RF01049                                            1049 03096000
*       PRNTDATA=PRLDATA(1:LENGTH(PRNTDATA));/* MOVE MAX     @Z40SP00*/ 03097000
         MVC   PRNTDATA(120),PRLDATA(@11)                          1050 03098000
*     ELSE                          /* IF LESS MOVE ONLY     @Z40SP00*/ 03099000
*       PRNTDATA(1:PRLRLEN)=PRLDATA(1:PRLRLEN);/* THAT PASSED IN   1051 03100000
*                                      BUFFER                @Z40SP00*/ 03101000
         B     @RC01049                                            1051 03102000
@RF01049 L     @11,IOPBUFAD(,IOPPTR)                               1051 03103000
         LH    @04,PRLRLEN(,@11)                                   1051 03104000
         BCTR  @04,0                                               1051 03105000
         EX    @04,@SM04253                                        1051 03106000
*   BUFFSV=IOPBUFAD;                /* SAVE BUFFER ADDR      @ZD00009*/ 03107000
@RC01049 DS    0H                                                  1052 03108000
@RF01048 MVC   BUFFSV(4),IOPBUFAD(IOPPTR)                          1052 03109000
*   IOPBUFAD=ADDR(PRNTBUF);         /* POINT TO OUTPUT BUFFER        */ 03110000
         LA    @11,PRNTBUF                                         1053 03111000
         ST    @11,IOPBUFAD(,IOPPTR)                               1053 03112000
*   SAVRETRN(IOENTCNT)=IOPRETRN;    /* SAVE CURRENT RC       @ZA25875*/ 03113000
         SLR   @11,@11                                             1054 03114000
         IC    @11,IOENTCNT                                        1054 03115000
         SLR   @04,@04                                             1054 03116000
         IC    @04,IOPRETRN(,IOPPTR)                               1054 03117000
         STC   @04,SAVRETRN-1(@11)                                 1054 03118000
*   CALL PUT;                       /* WRITE STATEMENT TO PRINTER    */ 03119000
         BAL   @14,PUT                                             1055 03120000
*   IOPRETRN=MAX(IOPRETRN,SAVRETRN(IOENTCNT));/*             @ZA25875*/ 03121000
         SLR   @11,@11                                             1056 03122000
         IC    @11,IOENTCNT                                        1056 03123000
         SLR   @04,@04                                             1056 03124000
         IC    @04,IOPRETRN(,IOPPTR)                               1056 03125000
         SLR   @03,@03                                             1056 03126000
         IC    @03,SAVRETRN-1(@11)                                 1056 03127000
         CR    @04,@03                                             1056 03128000
         BNL   *+6                                                      03129000
         LR    @04,@03                                             1056 03130000
         STC   @04,IOPRETRN(,IOPPTR)                               1056 03131000
*   IOPBUFAD=BUFFSV;                /* RESET BUFFER ADDR     @ZD00009*/ 03132000
         MVC   IOPBUFAD(4,IOPPTR),BUFFSV                           1057 03133000
*   LINECT=LINECT+1;                /* INCR LINES PRINTED    @Z67SP00*/ 03134000
         L     @11,ARRYADDR                                        1058 03135000
         LA    @04,1                                               1058 03136000
         AH    @04,LINECT(,@11)                                    1058 03137000
         STH   @04,LINECT(,@11)                                    1058 03138000
*   PRNTBUF=BLANK;                  /* BLANK OUT PRINT LINE          */ 03139000
         MVI   PRNTBUF+1,C' '                                      1059 03140000
         MVC   PRNTBUF+2(119),PRNTBUF+1                            1059 03141000
         MVI   PRNTBUF,C' '                                        1059 03142000
*   GO TO EXIT;                     /* RETURN TO REQUESTOR           */ 03143000
         B     EXIT                                                1060 03144000
         EJECT                                                          03145000
*                                                                  1061 03146000
*   /*****************************************************************/ 03147000
*   /*                                                               */ 03148000
*   /* THE FOLLOWING ROUTINE IS TO HANDLE THE HISTORY LOG FILE       */ 03149000
*   /*                                                               */ 03150000
*   /*****************************************************************/ 03151000
*                                                                  1061 03152000
*HISTPRTN:                                                         1061 03153000
*   IF IOPFUNCT>IOPCLOSE            /* OUTPUT OPERATION?     @Z40SP00*/ 03154000
*     THEN                          /* YES                   @Z40SP00*/ 03155000
HISTPRTN CLI   IOPFUNCT(IOPPTR),80                                 1061 03156000
         BNH   @RF01061                                            1061 03157000
*     DO;                           /*                       @Z40SP00*/ 03158000
*       IF IOPFUNCT=IOPWRITE        /* WRITE OPERATION?      @Z40SP00*/ 03159000
*         THEN                      /* YES WRITE A RECORD WITH STAMP */ 03160000
         CLI   IOPFUNCT(IOPPTR),81                                 1063 03161000
         BNE   @RF01063                                            1063 03162000
*         DO;                       /* OF TIME AND DATE              */ 03163000
*                                                                  1064 03164000
*           /*********************************************************/ 03165000
*           /*                                                       */ 03166000
*           /* FUNCTION IS WRITE TO THE LOG - GET TIME AND DATE AND  */ 03167000
*           /* WRITE MESSAGE. TCLOSE IS ISSUED TO WRITE END OF FILE  */ 03168000
*           /* TO SAVE DATA                                          */ 03169000
*           /*                                                       */ 03170000
*           /*********************************************************/ 03171000
*                                                                  1065 03172000
*           IF PRLRLEN>250          /* IF GREATER THAN MAX   @Z67SP00*/ 03173000
*             THEN                  /* RESE MSG TO MAX       @Z67SP00*/ 03174000
         LA    @11,250                                             1065 03175000
         L     @04,IOPBUFAD(,IOPPTR)                               1065 03176000
         CH    @11,PRLRLEN(,@04)                                   1065 03177000
         BNL   @RF01065                                            1065 03178000
*             PRLRLEN=250;          /*                       @Z67SP00*/ 03179000
         STH   @11,PRLRLEN(,@04)                                   1066 03180000
*           PRLSPAN=ZERO;           /* INSURE NO SPANNING INFO       */ 03181000
@RF01065 L     @11,IOPBUFAD(,IOPPTR)                               1067 03182000
         SLR   @04,@04                                             1067 03183000
         STH   @04,PRLSPAN(,@11)                                   1067 03184000
*           PRLDATE=CCADATE;        /* GET CORRECT DATE FROM CCA     */ 03185000
         L     @04,@CA00038                                        1068 03186000
         MVC   PRLDATE(3,@11),CCADATE-HMASMCCA(@04)                1068 03187000
*           GEN(TIME        DEC);   /* ISSUE TIME MACRO              */ 03188000
         TIME        DEC                                                03189000
*           RFY                                                    1070 03190000
*             R0 RSTD;              /* RESTRICT PASSBK REGISTER      */ 03191000
*           TIMETEMP=R0;            /* PUT TIME INTO SAVE AREA       */ 03192000
         ST    R0,TIMETEMP                                         1071 03193000
*           RFY                                                    1072 03194000
*             R0 UNRSTD;            /* RELEASE REGISTER              */ 03195000
*           PRLTIME=TIMETEMP(1:3);  /* PUT TIME IN PRL               */ 03196000
         L     @11,IOPBUFAD(,IOPPTR)                               1073 03197000
         MVC   PRLTIME(3,@11),TIMETEMP                             1073 03198000
*           CALL WRITE;             /* WRITE RECORD TO HISTORY LOG   */ 03199000
         BAL   @14,WRITE                                           1074 03200000
*         END;                                                     1075 03201000
*                                                                  1075 03202000
*       /*************************************************************/ 03203000
*       /*                                                           */ 03204000
*       /* FUNCTION IS POSITION FOR OUTPUT OR TO WRITE END OF FILE   */ 03205000
*       /* AFTER A WRITE OPERATION - POINT TO END OF LOG             */ 03206000
*       /*                                                           */ 03207000
*       /*************************************************************/ 03208000
*                                                                  1076 03209000
*       GEN(CLOSE (HISTDCB,LEAVE),TYPE=T);/* WRITE EOF               */ 03210000
@RF01063 DS    0H                                                  1076 03211000
         CLOSE (HISTDCB,LEAVE),TYPE=T                                   03212000
*     END;                                                         1077 03213000
*                                                                  1077 03214000
*   /*****************************************************************/ 03215000
*   /*                                                               */ 03216000
*   /* FUNCTION IS INPUT FOR SMPLOG, POSITION FOR INPUT OR READ      */ 03217000
*   /*                                                               */ 03218000
*   /*****************************************************************/ 03219000
*                                                                  1078 03220000
*   ELSE                            /* OTHERWISE, CHECK FURTHER      */ 03221000
*     IF IOPFUNCT=IOPREAD           /* IS IT A READ OPERATION?       */ 03222000
*       THEN                        /* YES - READ A RECORD           */ 03223000
         B     @RC01061                                            1078 03224000
@RF01061 CLI   IOPFUNCT(IOPPTR),1                                  1078 03225000
         BNE   @RF01078                                            1078 03226000
*       CALL READ;                  /* READ A RECORD INTO THE PRL    */ 03227000
         BAL   @14,READ                                            1079 03228000
*     ELSE                          /* OTHERWISE, IT IS POSITION     */ 03229000
*       IF IOPFUNCT=IOPPOSI         /* POSITION FOR INPUT?   @Z40SP00*/ 03230000
*         THEN                      /* YES                   @Z40SP00*/ 03231000
         B     @RC01078                                            1080 03232000
@RF01078 CLI   IOPFUNCT(IOPPTR),2                                  1080 03233000
         BNE   @RF01080                                            1080 03234000
*         GEN(CLOSE (HISTDCB,REREAD),TYPE=T)                       1081 03235000
*         REFS(HISTDCB);            /* REPOSITION AT START   @Z40SP00*/ 03236000
*                                                                  1081 03237000
         CLOSE (HISTDCB,REREAD),TYPE=T                                  03238000
*   /*****************************************************************/ 03239000
*   /*                                                               */ 03240000
*   /* INVALID REQUEST FOR SMPLOG                            @Z40SP00*/ 03241000
*   /*                                                               */ 03242000
*   /*****************************************************************/ 03243000
*                                                                  1082 03244000
*       ELSE                        /* NOT VALID FUNCTION    @Z40SP00*/ 03245000
*         IOPRETRN=IOPIOERR;        /* SET BAD RTN CDE       @Z40SP00*/ 03246000
         B     @RC01080                                            1082 03247000
@RF01080 MVI   IOPRETRN(IOPPTR),X'10'                              1082 03248000
*   GO TO EXIT;                     /* RETURN TO REQUESTOR           */ 03249000
         B     EXIT                                                1083 03250000
         EJECT                                                          03251000
*                                                                  1084 03252000
*   /*****************************************************************/ 03253000
*   /*                                                               */ 03254000
*   /* THE FOLLOWING ROUTINE IS TO HANDLE THE CDS AND ACDS DIRECTORY */ 03255000
*   /*                                                               */ 03256000
*   /*****************************************************************/ 03257000
*                                                                  1084 03258000
*CDSDIRTN:                                                         1084 03259000
*   IF CCACDSOS=ON                  /* CDS IN STORAGE FOR    @Z67SP00*/ 03260000
*     THEN                          /* UPDATE                @Z67SP00*/ 03261000
CDSDIRTN L     @11,@CA00038                                        1084 03262000
         TM    CCACDSOS-HMASMCCA(@11),B'10000000'                  1084 03263000
         BNO   @RF01084                                            1084 03264000
*     DISOSW=ON;                    /* YES - SET DIS OUTPUT  @Z67SP00*/ 03265000
         OI    DISOSW,B'00001000'                                  1085 03266000
*   ELSE                            /* NO                    @Z67SP00*/ 03267000
*     DISOSW=OFF;                   /* SET NO OUTPUT SW      @Z67SP00*/ 03268000
         B     @RC01084                                            1086 03269000
@RF01084 NI    DISOSW,B'11110111'                                  1086 03270000
*   PDSDDNAM=CCADSIDA(IOPCDS);      /* SET DD NAME           @Z67SP00*/ 03271000
@RC01084 L     @11,@CA00038                                        1087 03272000
         L     @11,CCADSAD-HMASMCCA(,@11)                          1087 03273000
         MVC   PDSDDNAM(8),CCADSIDA+8(@11)                         1087 03274000
*   GO TO PDSDRTNS;                 /*                       @Z67SP00*/ 03275000
         B     PDSDRTNS                                            1088 03276000
*ACDSDRTN:                                                         1089 03277000
*   IF CCAACDOS=ON                  /* ACDS IN STORAGE FOR   @Z67SP00*/ 03278000
*     THEN                          /* UPDATE                @Z67SP00*/ 03279000
ACDSDRTN L     @11,@CA00038                                        1089 03280000
         TM    CCAACDOS-HMASMCCA(@11),B'01000000'                  1089 03281000
         BNO   @RF01089                                            1089 03282000
*     DISOSW=ON;                    /* YES - SET DIS OUTPUT  @Z67SP00*/ 03283000
         OI    DISOSW,B'00001000'                                  1090 03284000
*   ELSE                            /* NO                    @Z67SP00*/ 03285000
*     DISOSW=OFF;                   /* SET NO OUTPUT SW      @Z67SP00*/ 03286000
         B     @RC01089                                            1091 03287000
@RF01089 NI    DISOSW,B'11110111'                                  1091 03288000
*   PDSDDNAM=CCADSIDA(IOPACDS);     /* SET DD NAME           @Z67SP00*/ 03289000
@RC01089 L     @11,@CA00038                                        1092 03290000
         L     @11,CCADSAD-HMASMCCA(,@11)                          1092 03291000
         MVC   PDSDDNAM(8),CCADSIDA+88(@11)                        1092 03292000
*   GO TO PDSDRTNS;                 /*                       @Z67SP00*/ 03293000
         B     PDSDRTNS                                            1093 03294000
*CRQDRTN:                           /*                       @Z67SP00*/ 03295000
*   IF CCACRQOS=ON                  /* CRQ IN STORAGE FOR    @Z67SP00*/ 03296000
*     THEN                          /* UPDATE                @Z67SP00*/ 03297000
CRQDRTN  L     @11,@CA00038                                        1094 03298000
         TM    CCACRQOS-HMASMCCA(@11),B'00100000'                  1094 03299000
         BNO   @RF01094                                            1094 03300000
*     DISOSW=ON;                    /* YES - SET DIS OUTPUT  @Z67SP00*/ 03301000
         OI    DISOSW,B'00001000'                                  1095 03302000
*   ELSE                            /* NO                    @Z67SP00*/ 03303000
*     DISOSW=OFF;                   /* SET NO OUTPUT SW      @Z67SP00*/ 03304000
         B     @RC01094                                            1096 03305000
@RF01094 NI    DISOSW,B'11110111'                                  1096 03306000
*   PDSDDNAM=CCADSIDA(IOPCRQ);      /* SET DD NAME           @Z67SP00*/ 03307000
@RC01094 L     @11,@CA00038                                        1097 03308000
         L     @11,CCADSAD-HMASMCCA(,@11)                          1097 03309000
         MVC   PDSDDNAM(8),CCADSIDA+216(@11)                       1097 03310000
*   GO TO PDSDRTNS;                 /*                       @Z67SP00*/ 03311000
         B     PDSDRTNS                                            1098 03312000
*ACRQDRTN:                          /*                       @Z67SP00*/ 03313000
*   IF CCAACROS=ON                  /* ACRQ IN STORAGE FOR   @Z67SP00*/ 03314000
*     THEN                          /* UPDATE                @Z67SP00*/ 03315000
ACRQDRTN L     @11,@CA00038                                        1099 03316000
         TM    CCAACROS-HMASMCCA(@11),B'00010000'                  1099 03317000
         BNO   @RF01099                                            1099 03318000
*     DISOSW=ON;                    /* YES - SET DIS OUTPUT  @Z67SP00*/ 03319000
         OI    DISOSW,B'00001000'                                  1100 03320000
*   ELSE                            /* NO                    @Z67SP00*/ 03321000
*     DISOSW=OFF;                   /* SET NO OUTPUT SW      @Z67SP00*/ 03322000
         B     @RC01099                                            1101 03323000
@RF01099 NI    DISOSW,B'11110111'                                  1101 03324000
*   PDSDDNAM=CCADSIDA(IOPACRQ);     /* SET DD NAME           @Z67SP00*/ 03325000
@RC01099 L     @11,@CA00038                                        1102 03326000
         L     @11,CCADSAD-HMASMCCA(,@11)                          1102 03327000
         MVC   PDSDDNAM(8),CCADSIDA+232(@11)                       1102 03328000
*   GO TO PDSDRTNS;                 /*                       @Z67SP00*/ 03329000
         B     PDSDRTNS                                            1103 03330000
*                                                                  1104 03331000
*   /*****************************************************************/ 03332000
*   /*                                                               */ 03333000
*   /* ROUTINES TO HANDLE DIRECTORY DCBS FOR DATASETS THAT CAN BE    */ 03334000
*   /* UPDATED IN AN IN STORAGE ONLY MODE                    @Z67SP00*/ 03335000
*   /*                                                               */ 03336000
*   /*****************************************************************/ 03337000
*                                                                  1104 03338000
*PDSDRTNS:                          /*                       @Z67SP00*/ 03339000
*   IF DISOSW=ON                    /* IN JCLIN MODE?        @Z67SP00*/ 03340000
*     THEN                          /* YES - USE UPDAT DCB           */ 03341000
PDSDRTNS TM    DISOSW,B'00001000'                                  1104 03342000
         BNO   @RF01104                                            1104 03343000
*     DO;                                                          1105 03344000
*       DCBPTR=ADDIRDCB;            /* UPDATE TO DIRECT DCB  @Z40SP01*/ 03345000
         L     DCBPTR,ADDIRDCB                                     1106 03346000
*       IF DCBOFOPN=OFF             /* IS DCB CLOSED                 */ 03347000
*         THEN                      /* YES - OPEN IT                 */ 03348000
         LA    @11,40                                              1107 03349000
         ALR   @11,DCBPTR                                          1107 03350000
         TM    DCBOFOPN(@11),B'00010000'                           1107 03351000
         BNZ   @RF01107                                            1107 03352000
*         DO;                       /*                               */ 03353000
*           DCBDDNAM=PDSDDNAM;      /* SET DD NAME           @Z67SP00*/ 03354000
         MVC   DCBDDNAM(8,@11),PDSDDNAM                            1109 03355000
*           GEN(OPEN     (DIRUDCB,UPDAT));/* OPEN THE DCB            */ 03356000
         OPEN     (DIRUDCB,UPDAT)                                       03357000
*           IF DCBOFOPN=OFF         /* DCB STILL CLOSED              */ 03358000
*             THEN                  /* YES - ERR CONDITION           */ 03359000
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     1111 03360000
         BZ    @RT01111                                            1111 03361000
*             GO TO OPENFAIL;       /* WRITE ERR MSG                 */ 03362000
*         END;                                                     1113 03363000
*                                                                  1113 03364000
*       /*************************************************************/ 03365000
*       /*                                                           */ 03366000
*       /* READ/WRITE OPERATIONS WHEN USING DIRUDCB(IN-STORAGE MODE) */ 03367000
*       /*                                                           */ 03368000
*       /*************************************************************/ 03369000
*                                                                  1114 03370000
*       IF IOPFUNCT=IOPREAD         /* READ OPERATION?               */ 03371000
*         THEN                      /* YES - ISSUE READ              */ 03372000
@RF01107 CLI   IOPFUNCT(IOPPTR),1                                  1114 03373000
         BNE   @RF01114                                            1114 03374000
*         CALL READ;                /* READ DIRECTORY ENTRY          */ 03375000
         BAL   @14,READ                                            1115 03376000
*       ELSE                        /* OTHERWISE - WRITE OPERATION   */ 03377000
*         IF IOPFUNCT=IOPWRITE      /* WRITE?                @Z40SP00*/ 03378000
*           THEN                    /* YES                   @Z40SP00*/ 03379000
         B     @RC01114                                            1116 03380000
@RF01114 CLI   IOPFUNCT(IOPPTR),81                                 1116 03381000
         BNE   @RF01116                                            1116 03382000
*           CALL WRITE;             /* ISSUE WRITE                   */ 03383000
*                                                                  1117 03384000
         BAL   @14,WRITE                                           1117 03385000
*       /*************************************************************/ 03386000
*       /*                                                           */ 03387000
*       /* INVALID REQUEST FOR IN-STORAGE DIRECTORY          @Z40SP00*/ 03388000
*       /*                                                           */ 03389000
*       /*************************************************************/ 03390000
*                                                                  1118 03391000
*         ELSE                      /* INVALID FUNCTION      @Z40SP00*/ 03392000
*           IOPRETRN=IOPIOERR;      /* SET BAD RTN CDE       @Z40SP00*/ 03393000
         B     @RC01116                                            1118 03394000
@RF01116 MVI   IOPRETRN(IOPPTR),X'10'                              1118 03395000
*       GO TO EXIT;                 /* RETURN                        */ 03396000
         B     EXIT                                                1119 03397000
*     END;                          /* END IN-STORAGE MODE?  @SA99996*/ 03398000
*                                                                  1120 03399000
*   /*****************************************************************/ 03400000
*   /*                                                               */ 03401000
*   /* FOR PDS DIRECTORY ACCESS USE GET                      @SA99996*/ 03402000
*   /*                                                               */ 03403000
*   /*****************************************************************/ 03404000
*                                                                  1121 03405000
*   IF IOPFUNCT=IOPREAD             /* READ REQUEST?         @Z40SP00*/ 03406000
*     THEN                          /* YES                   @Z40SP00*/ 03407000
@RF01104 CLI   IOPFUNCT(IOPPTR),1                                  1121 03408000
         BNE   @RF01121                                            1121 03409000
*     CALL GET;                     /* GET DIRECTORY BLOCK   @SA99996*/ 03410000
*                                                                  1122 03411000
         BAL   @14,GET                                             1122 03412000
*   /*****************************************************************/ 03413000
*   /*                                                               */ 03414000
*   /* INVALID REQUEST FOR PDS DIRECTORY                     @Z40SP00*/ 03415000
*   /*                                                               */ 03416000
*   /*****************************************************************/ 03417000
*                                                                  1123 03418000
*   ELSE                            /* INVALID REQUEST       @Z40SP00*/ 03419000
*     IOPRETRN=IOPIOERR;            /* SET BAD RTN CDE       @Z40SP00*/ 03420000
         B     @RC01121                                            1123 03421000
@RF01121 MVI   IOPRETRN(IOPPTR),X'10'                              1123 03422000
*   GO TO EXIT;                     /*                       @SA99996*/ 03423000
         B     EXIT                                                1124 03424000
         EJECT                                                          03425000
*                                                                  1125 03426000
*   /*****************************************************************/ 03427000
*   /*                                                               */ 03428000
*   /* THE FOLLOWING ROUTINE IS TO HANDLE THE SMPCNTL DATA SET       */ 03429000
*   /*                                                               */ 03430000
*   /*****************************************************************/ 03431000
*                                                                  1125 03432000
*CNTLRTN:                                                          1125 03433000
*   IF CONTEOF=ON                   /* HAS EOF BEEN REACHED YET?     */ 03434000
*     THEN                          /* YES - DON'T READ              */ 03435000
CNTLRTN  TM    CONTEOF,B'01000000'                                 1125 03436000
         BNO   @RF01125                                            1125 03437000
*     IOPRETRN=IOPEOF;              /* SET EOF RETURN CODE   @YA07506*/ 03438000
         MVI   IOPRETRN(IOPPTR),X'04'                              1126 03439000
*   ELSE                            /* OTHERWISE - ISSUE READ        */ 03440000
*     IF IOPFUNCT=IOPREAD           /* READ REQUEST          @Z40SP00*/ 03441000
*       THEN                        /* YES                   @Z40SP00*/ 03442000
         B     @RC01125                                            1127 03443000
@RF01125 CLI   IOPFUNCT(IOPPTR),1                                  1127 03444000
         BNE   @RF01127                                            1127 03445000
*       DO;                                                        1128 03446000
*         CALL GET;                 /* GET A CONTROL CARD RECORD     */ 03447000
         BAL   @14,GET                                             1129 03448000
*         IF IOPRETRN=IOPEOF        /* IS IT NOW EOF?        @YA07506*/ 03449000
*           THEN                    /* YES - INDICATE EOF FOUND      */ 03450000
         CLI   IOPRETRN(IOPPTR),4                                  1130 03451000
         BNE   @RF01130                                            1130 03452000
*           CONTEOF=ON;             /* CONTROL CARD END OF FILE      */ 03453000
         OI    CONTEOF,B'01000000'                                 1131 03454000
*       END;                                                       1132 03455000
*                                                                  1132 03456000
*   /*****************************************************************/ 03457000
*   /*                                                               */ 03458000
*   /* INVALID REQUEST FOR SMPCNTL                           @Z40SP00*/ 03459000
*   /*                                                               */ 03460000
*   /*****************************************************************/ 03461000
*                                                                  1133 03462000
*     ELSE                          /* NOT READ - INVALID    @Z40SP00*/ 03463000
*       IOPRETRN=IOPIOERR;          /* SET BAD RTN CDE       @Z40SP00*/ 03464000
         B     @RC01127                                            1133 03465000
@RF01127 MVI   IOPRETRN(IOPPTR),X'10'                              1133 03466000
*   GO TO EXIT;                     /* RETURN TO CALLER              */ 03467000
         B     EXIT                                                1134 03468000
         EJECT                                                          03469000
*                                                                  1135 03470000
*   /*****************************************************************/ 03471000
*   /*                                                               */ 03472000
*   /* THE FOLLOWING IS TO HANDLE THE SYSUT1 DATA SET WHEN IT IS TO  */ 03473000
*   /* BE USED AS LRECL=80                                   @Z40SP00*/ 03474000
*   /*                                                               */ 03475000
*   /*****************************************************************/ 03476000
*                                                                  1135 03477000
*SCR1RTN:                                                          1135 03478000
*   IF IOPFUNCT=IOPREAD             /* IS IT A READ OPERATION?       */ 03479000
*     THEN                          /* YES - READ A RECORD           */ 03480000
SCR1RTN  CLI   IOPFUNCT(IOPPTR),1                                  1135 03481000
         BNE   @RF01135                                            1135 03482000
*     CALL GET;                     /* USING QSAM - INTO BUFAD       */ 03483000
         BAL   @14,GET                                             1136 03484000
*   ELSE                            /* OTHERWISE - IT IS WRITE       */ 03485000
*     IF IOPFUNCT=IOPWRITE          /* WRITEREQUEST?         @Z40SP00*/ 03486000
*       THEN                        /* YES                   @Z40SP00*/ 03487000
         B     @RC01135                                            1137 03488000
@RF01135 CLI   IOPFUNCT(IOPPTR),81                                 1137 03489000
         BNE   @RF01137                                            1137 03490000
*       CALL PUT;                   /* ISSUE QSAM PUT                */ 03491000
*                                                                  1138 03492000
         BAL   @14,PUT                                             1138 03493000
*   /*****************************************************************/ 03494000
*   /*                                                               */ 03495000
*   /* INVALID REQUEST FOR SYSUT1                            @Z40SP00*/ 03496000
*   /*                                                               */ 03497000
*   /*****************************************************************/ 03498000
*                                                                  1139 03499000
*     ELSE                          /* NOT WRITE - INVALID   @Z40SP00*/ 03500000
*       IOPRETRN=IOPIOERR;          /* SET BAD RTN CDE       @Z40SP00*/ 03501000
         B     @RC01137                                            1139 03502000
@RF01137 MVI   IOPRETRN(IOPPTR),X'10'                              1139 03503000
*   GO TO EXIT;                     /* RETURN TO REQUESTOR           */ 03504000
*                                                                  1140 03505000
         B     EXIT                                                1140 03506000
*   /*****************************************************************/ 03507000
*   /*                                                               */ 03508000
*   /* THIS ROUTINE IS TO HANDLE THE SYSUT1 DATA SET WHEN IT IS TO BE*/ 03509000
*   /* USED AS LRECL=256                                     @Z40SP00*/ 03510000
*   /*                                                               */ 03511000
*   /*****************************************************************/ 03512000
*                                                                  1141 03513000
*SCR2RTN:                                                          1141 03514000
*   IF IOPFUNCT=IOPREAD             /* IS THIS A READ OPERATION      */ 03515000
*     THEN                          /* YES - ISSUE READ              */ 03516000
SCR2RTN  CLI   IOPFUNCT(IOPPTR),1                                  1141 03517000
         BNE   @RF01141                                            1141 03518000
*     CALL READ;                    /* INVOKE READ SUBROUTINE        */ 03519000
         BAL   @14,READ                                            1142 03520000
*   ELSE                            /* OTHERWISE - IT IS A WRITE     */ 03521000
*     IF IOPFUNCT=IOPWRITE          /* WRITE REQUEST?        @Z40SP00*/ 03522000
*       THEN                        /* YES                   @Z40SP00*/ 03523000
         B     @RC01141                                            1143 03524000
@RF01141 CLI   IOPFUNCT(IOPPTR),81                                 1143 03525000
         BNE   @RF01143                                            1143 03526000
*       CALL WRITE;                 /* INVOKE WRITE SUBROUTINE       */ 03527000
*                                                                  1144 03528000
         BAL   @14,WRITE                                           1144 03529000
*   /*****************************************************************/ 03530000
*   /*                                                               */ 03531000
*   /* INVALID REQUEST FOR SYSUT1                            @Z40SP00*/ 03532000
*   /*                                                               */ 03533000
*   /*****************************************************************/ 03534000
*                                                                  1145 03535000
*     ELSE                          /* NOT WRITE - INVALID   @Z40SP00*/ 03536000
*       IOPRETRN=IOPIOERR;          /* SET BAD RTN CDE       @Z40SP00*/ 03537000
         B     @RC01143                                            1145 03538000
@RF01143 MVI   IOPRETRN(IOPPTR),X'10'                              1145 03539000
*   GO TO EXIT;                     /* RETURN                @Z40SP00*/ 03540000
         B     EXIT                                                1146 03541000
         EJECT                                                          03542000
*                                                                  1147 03543000
*   /*****************************************************************/ 03544000
*   /*                                                               */ 03545000
*   /* ROUTINE TO HANDLE THE SOURCE LIBRARIES                @Z40SP00*/ 03546000
*   /*                                                               */ 03547000
*   /*****************************************************************/ 03548000
*                                                                  1147 03549000
*SRCRTN:                            /*                       @Z40SP00*/ 03550000
*                                                                  1147 03551000
*   /*****************************************************************/ 03552000
*   /*                                                               */ 03553000
*   /* ROUTINE TO HANDLE THE MACRO LIBRARIES                 @Z40SP00*/ 03554000
*   /*                                                               */ 03555000
*   /*****************************************************************/ 03556000
*                                                                  1147 03557000
*MACRTN:                                                           1147 03558000
*                                                                  1147 03559000
*   /*****************************************************************/ 03560000
*   /*                                                               */ 03561000
*   /* IF A LOCATE OPERATION, THEN CHECK CURRENT LIBRARY             */ 03562000
*   /*                                                               */ 03563000
*   /*****************************************************************/ 03564000
*                                                                  1147 03565000
*MACSRCRT:                          /*                       @Z40SP00*/ 03566000
*   DISISW=OFF;                     /* INIT SWITCH TO INDICATE THAT     03567000
*                                      DIRECTORY NOT IN STORAGE FOR     03568000
*                                      SPECIFIED DATA SET    @Z67SP00*/ 03569000
SRCRTN   DS    0H                                                  1147 03570000
MACRTN   DS    0H                                                  1147 03571000
MACSRCRT NI    DISISW,B'11101111'                                  1147 03572000
*   IF IOPFUNCT=IOPLOC              /* IS IT A LOCATE?               */ 03573000
*       |IOPFUNCT=IOPBLDL           /* OR BLDL               @Z40SP00*/ 03574000
*     THEN                          /* YES                   @Z40SP00*/ 03575000
         CLI   IOPFUNCT(IOPPTR),3                                  1148 03576000
         BE    @RT01148                                            1148 03577000
         CLI   IOPFUNCT(IOPPTR),4                                  1148 03578000
         BNE   @RF01148                                            1148 03579000
@RT01148 DS    0H                                                  1149 03580000
*     DO;                                                          1149 03581000
*       CALL BLDL;                  /* SEARCH CURRENT LIBRARY        */ 03582000
         BAL   @14,BLDL                                            1150 03583000
*       GO TO EXIT;                 /* RETURN                        */ 03584000
         B     EXIT                                                1151 03585000
*     END;                                                         1152 03586000
*                                                                  1152 03587000
*   /*****************************************************************/ 03588000
*   /*                                                               */ 03589000
*   /* INVALID REQUEST FOR MACRO/SOURCE LIBRARIES            @Z40SP00*/ 03590000
*   /*                                                               */ 03591000
*   /*****************************************************************/ 03592000
*                                                                  1153 03593000
*   IOPRETRN=IOPIOERR;              /* SET BAD RTN           @Z40SP00*/ 03594000
@RF01148 MVI   IOPRETRN(IOPPTR),X'10'                              1153 03595000
*   GO TO EXIT;                     /* RETURN                @Z40SP00*/ 03596000
         B     EXIT                                                1154 03597000
         EJECT                                                          03598000
*                                                                  1155 03599000
*   /*****************************************************************/ 03600000
*   /*                                                               */ 03601000
*   /* ROUTINE TO HANDLE DYNAMICALLY ALLOCATED DATASET(IOPLRF)Z67SP00*/ 03602000
*   /*                                                               */ 03603000
*   /*****************************************************************/ 03604000
*                                                                  1155 03605000
*LRFRTN:                            /*                       @Z67SP00*/ 03606000
*   IF IOPFUNCT=IOPALC              /* IF ALLOCATE           @Z67SP00*/ 03607000
*       |IOPFUNCT=IOPDALC           /* OR DE-ALLOCATE        @Z67SP00*/ 03608000
*       |IOPFUNCT=IOPDEL            /* OR DELETE             @Z67SP00*/ 03609000
*     THEN                          /*                       @Z67SP00*/ 03610000
LRFRTN   CLI   IOPFUNCT(IOPPTR),13                                 1155 03611000
         BE    @RT01155                                            1155 03612000
         CLI   IOPFUNCT(IOPPTR),14                                 1155 03613000
         BE    @RT01155                                            1155 03614000
         CLI   IOPFUNCT(IOPPTR),15                                 1155 03615000
         BNE   @RF01155                                            1155 03616000
@RT01155 DS    0H                                                  1156 03617000
*     DO;                           /*                       @Z67SP00*/ 03618000
*       GEN(CLOSE ((DCBPTR)))                                      1157 03619000
*       REFS(DCBPTR);               /* CLOSE DCB             @Z67SP00*/ 03620000
         CLOSE ((DCBPTR))                                               03621000
*       IF DCBOFOPN=ON              /* IF CLOSE FAILED       @Z67SP00*/ 03622000
*         THEN                      /*                       @Z67SP00*/ 03623000
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     1158 03624000
         BO    @RT01158                                            1158 03625000
*         GO TO CLOSFAIL;           /* GO ISSUE MSG          @Z67SP00*/ 03626000
*       TCBPTR=CVTNTCB;             /* ADDR OF CURRENT TCB   @Z67SP00*/ 03627000
         L     @11,CVTPTR                                          1160 03628000
         L     @11,CVTTCBP(,@11)                                   1160 03629000
         L     @11,CVTNTCB(,@11)                                   1160 03630000
         ST    @11,TCBPTR                                          1160 03631000
*       TCBPTR=JSCBTCBP;            /* ADDR OF INITS TCB     @Z67SP00*/ 03632000
         L     @11,TCBJSCB(,@11)                                   1161 03633000
         L     @11,JSCBTCBP(,@11)                                  1161 03634000
         ST    @11,TCBPTR                                          1161 03635000
*       RNAME=IOPDSN;               /* SET RESOURCE NAME     @Z67SP00*/ 03636000
         MVC   RNAME(44),IOPDSN(IOPPTR)                            1162 03637000
*       DO RNAMELEN=0 TO LENGTH(RNAME) WHILE(/* CALC LEN     @Z67SP00*/ 03638000
*             RNAME(RNAMELEN+1)^=BLANK);/* OF RNAME          @Z67SP00*/ 03639000
         SLR   @11,@11                                             1163 03640000
         STC   @11,RNAMELEN                                        1163 03641000
@DL01163 LA    @04,RNAME(@11)                                      1163 03642000
         CLI   0(@04),C' '                                         1163 03643000
         BE    @DC01163                                            1163 03644000
*       END;                        /*                       @Z67SP00*/ 03645000
         AH    @11,@CH00088                                        1164 03646000
         STC   @11,RNAMELEN                                        1164 03647000
         CH    @11,@CH00384                                        1164 03648000
         BNH   @DL01163                                            1164 03649000
@DC01163 DS    0H                                                  1165 03650000
*       IF IOPFUNCT=IOPALC          /* IF ALLOC REQUEST      @Z67SP00*/ 03651000
*         THEN                      /*                       @Z67SP00*/ 03652000
         CLI   IOPFUNCT(IOPPTR),13                                 1165 03653000
         BNE   @RF01165                                            1165 03654000
*         DO;                       /*                       @Z67SP00*/ 03655000
*           GEN(ENQ (QNAME,ENQRNAME,,0,SYSTEM),TCB=TCBPTR,RET=USE) 1167 03656000
*           REFS(QNAME,ENQRNAME,TCBPTR);/* ENQ ON DATASET NAME     1167 03657000
*                                      ALLOCATED SO THAT SYSTEM WILL    03658000
*                                      ALLOW RELEASE TO BE DONE AT 1167 03659000
*                                      COPY CLOSE            @Z67SP00*/ 03660000
         ENQ (QNAME,ENQRNAME,,0,SYSTEM),TCB=TCBPTR,RET=USE              03661000
*           RFY                     /*                       @Z67SP00*/ 03662000
*             RTNCODE RSTD;         /*                       @Z67SP00*/ 03663000
*           IF RTNCODE=ZERO         /* IF ENQ DONE OK        @Z67SP00*/ 03664000
*             THEN                  /* THEN                  @Z67SP00*/ 03665000
         LTR   RTNCODE,RTNCODE                                     1169 03666000
         BNZ   @RF01169                                            1169 03667000
*             ENQDONE=ON;           /* REMEMBER TO DO DEQ    @Z67SP00*/ 03668000
         OI    ENQDONE,B'01000000'                                 1170 03669000
*           ELSE                    /*                       @Z67SP00*/ 03670000
*             DO;                   /*                       @Z67SP00*/ 03671000
         B     @RC01169                                            1171 03672000
@RF01169 DS    0H                                                  1172 03673000
*               IF ENQRC=ENQNTAVL   /* IF RESOURCE NOT AVAIL @Z67SP00*/ 03674000
*                 THEN              /*                       @Z67SP00*/ 03675000
         CLI   ENQRC(RTNCODE),4                                    1172 03676000
         BNE   @RF01172                                            1172 03677000
*                 DO;               /*                       @Z67SP00*/ 03678000
*                   MGPMGNO1=HMA403I;/* ENQ FAILED FOR DATASET X44X     03679000
*                                                            @Z67SP00*/ 03680000
         MVC   MGPMGNO1(2),@CH03325                                1174 03681000
*                   MGPVARPT(1)=ADDR(IOPDSN);/* DSN          @Z67SP00*/ 03682000
         LA    @14,IOPDSN(,IOPPTR)                                 1175 03683000
         ST    @14,MGPVARPT                                        1175 03684000
*                   MGPTYPE=MGPERR; /*                       @Z67SP00*/ 03685000
         MVI   MGPTYPE,X'03'                                       1176 03686000
*                   CALL HMASMMSG(HMASMMGP);/*               @Z67SP00*/ 03687000
         L     @15,@CV03346                                        1177 03688000
         LA    @01,@AL01177                                        1177 03689000
         BALR  @14,@15                                             1177 03690000
*                   IOPRETRN=IOPNQERR;/* ENQ ERROR           @Z67SP00*/ 03691000
         MVI   IOPRETRN(IOPPTR),X'08'                              1178 03692000
*                 END;              /* END NOT AVAILABLE     @Z67SP00*/ 03693000
*               ELSE                /*                       @Z67SP00*/ 03694000
*                 ENQDONE=ON;       /*                       @Z67SP00*/ 03695000
         B     @RC01172                                            1180 03696000
@RF01172 OI    ENQDONE,B'01000000'                                 1180 03697000
*             END;                  /* END NOT 0 ENQ RC      @Z67SP00*/ 03698000
@RC01172 DS    0H                                                  1182 03699000
*           RFY                     /*                       @Z67SP00*/ 03700000
*             RTNCODE UNRSTD;       /*                       @Z67SP00*/ 03701000
@RC01169 DS    0H                                                  1183 03702000
*         END;                      /* END ALC REQUEST       @Z67SP00*/ 03703000
*       ELSE                        /* IF NOT ALC REQUEST    @Z67SP00*/ 03704000
*         DO;                       /*                       @Z67SP00*/ 03705000
         B     @RC01165                                            1184 03706000
@RF01165 DS    0H                                                  1185 03707000
*           IF ENQDONE=ON           /* IF ENQ DONE           @Z67SP00*/ 03708000
*             THEN                  /*                       @Z67SP00*/ 03709000
         TM    ENQDONE,B'01000000'                                 1185 03710000
         BNO   @RF01185                                            1185 03711000
*             GEN(DEQ (QNAME,ENQRNAME,0,SYSTEM),TCB=TCBPTR,RET=HAVE)    03712000
*             REFS(QNAME,ENQRNAME,TCBPTR);/* DEQ ON DATASET NAME   1186 03713000
*                                                            @Z67SP00*/ 03714000
         DEQ (QNAME,ENQRNAME,0,SYSTEM),TCB=TCBPTR,RET=HAVE              03715000
*         END;                      /* END NOT ALC           @Z67SP00*/ 03716000
*       GO TO EXIT;                 /* RETURN                @Z67SP00*/ 03717000
         B     EXIT                                                1188 03718000
*     END;                          /*                       @Z67SP00*/ 03719000
*   GO TO ANYDDRTN;                 /* GO TO CODE TO HANDLE OTHER  1190 03720000
*                                      FUNCTIONS             @Z67SP00*/ 03721000
         B     ANYDDRTN                                            1190 03722000
*                                                                  1191 03723000
*   /*****************************************************************/ 03724000
*   /*                                                               */ 03725000
*   /* ROUTINE TO HANDLE OPERATIONS TO DATA SETS DEFINED IN THE      */ 03726000
*   /* IOPDDNAM. THESE DATA SETS MAY BE TEXTLIB(IOPDSID=IOPTXTDD) OF */ 03727000
*   /* OPERATING SYSTEM LIBRARIES(IOPDSID=IOPANYDD) TO GIVE BLDL AND */ 03728000
*   /* STOW CAPIBILITY                                       @Z40SP00*/ 03729000
*   /* IN ORDER TO DELETE A MEMBER THE LIBRARY MUST NOT BE MARKED AS */ 03730000
*   /* UNMOVEABLE. IF IOPDSID=IOPDDNM THE THIS IS CHECKED    @Z40SP00*/ 03731000
*   /*                                                               */ 03732000
*   /*****************************************************************/ 03733000
*                                                                  1191 03734000
*DDDELRTN:                          /*                       @Z30XX9J*/ 03735000
*   IF DCBDSGU=ON                   /* OPENED UNMOVEABLE DS  @Z30XX9J*/ 03736000
*       &IOPFUNCT=IOPSTOWD          /* AND FUNCTION WAS DELETE FROM     03737000
*                                      SYSTEM DATA SET       @Z40SP00*/ 03738000
*     THEN                          /* YES - CANT DO SCR/COMPR     1191 03739000
*                                                            @Z30XX9J*/ 03740000
DDDELRTN TM    DCBDSGU+16(DCBPTR),B'00000001'                      1191 03741000
         BNO   @RF01191                                            1191 03742000
         CLI   IOPFUNCT(IOPPTR),83                                 1191 03743000
         BNE   @RF01191                                            1191 03744000
*     DO;                           /* ERR                   @Z30XX9J*/ 03745000
*       IOPRETRN=IOPUNMOV;          /* SET RETURN CODE       @Z30XX9J*/ 03746000
         MVI   IOPRETRN(IOPPTR),X'04'                              1193 03747000
*       GO TO EXIT;                 /* RETURN                @Z30XX9J*/ 03748000
         B     EXIT                                                1194 03749000
*     END;                          /* END UNMOVEABLE DS GROUP     1195 03750000
*                                                            @Z30XX9J*/ 03751000
*                                                                  1195 03752000
*   /*****************************************************************/ 03753000
*   /*                                                               */ 03754000
*   /* ROUTINE ENTERED IF IOPDSID=IOPTXTDD OR IOPANYDD. ALSO FALL    */ 03755000
*   /* THRU HERE IF IOPDSID=IOPDDNM AND DATA SET IS NOT UNMOVEABLE   */ 03756000
*   /*                                                               */ 03757000
*   /*****************************************************************/ 03758000
*                                                                  1196 03759000
*ANYDDRTN:                          /*                       @Z40SP00*/ 03760000
*   DISISW=OFF;                     /* INIT SWITCH TO INDICATE THAT     03761000
*                                      DIRECTORY NOT IN STORAGE FOR     03762000
*                                      SPECIFIED DATA SET    @Z67SP00*/ 03763000
@RF01191 DS    0H                                                  1196 03764000
ANYDDRTN DS    0H                                                  1197 03765000
*   DISOSW=OFF;                     /*                       @Z67SP00*/ 03766000
         NI    DISISW,B'11100111'                                  1197 03767000
*   DSBFRMX=DCBBLKSI/TXTLRECL;      /* SET BUFFER FACTOR     @Z67SP00*/ 03768000
         LH    @00,DCBBLKSI+52(,DCBPTR)                            1198 03769000
         SRDA  @00,32                                              1198 03770000
         D     @00,@CF00512                                        1198 03771000
         STH   @01,DSBFRMX                                         1198 03772000
*   PDSI=XXX;                       /*                       @Z67SP00*/ 03773000
         LA    @11,14                                              1199 03774000
         STC   @11,PDSI                                            1199 03775000
*   PDSADDR=ADDR(PDSARRAY(PDSI));   /* SET CONTROL ARRAY AD  @Z67SP00*/ 03776000
         SLA   @11,4                                               1200 03777000
         LA    @11,PDSARRAY-16(@11)                                1200 03778000
         ST    @11,PDSADDR                                         1200 03779000
*   IF IOPFUNCT=IOPSTOWD            /* DELETE OPERATION?     @Z40SP00*/ 03780000
*       |IOPFUNCT=IOPUDEO           /* OR DIRECT UPDATE      @Z40SP00*/ 03781000
*     THEN                          /* YES                   @Z40SP00*/ 03782000
         CLI   IOPFUNCT(IOPPTR),83                                 1201 03783000
         BE    @RT01201                                            1201 03784000
         CLI   IOPFUNCT(IOPPTR),86                                 1201 03785000
         BNE   @RF01201                                            1201 03786000
@RT01201 DS    0H                                                  1202 03787000
*     DO;                           /* DO DELETE             @Z40SP00*/ 03788000
*       CALL STOW;                  /* DO STOW DELETE        @Z30XX9J*/ 03789000
         BAL   @14,STOW                                            1203 03790000
*       GO TO EXIT;                 /* RETURN                @Z30XX9J*/ 03791000
         B     EXIT                                                1204 03792000
*     END;                          /* END STOW DELETE       @Z40SP00*/ 03793000
*                                                                  1205 03794000
*   /*****************************************************************/ 03795000
*   /*                                                               */ 03796000
*   /* FUNCTION=LOCATE                                       @Z40SP00*/ 03797000
*   /*                                                               */ 03798000
*   /*****************************************************************/ 03799000
*                                                                  1206 03800000
*   IF IOPFUNCT=IOPLOC              /* LOCATE?               @Z40SP00*/ 03801000
*       |IOPFUNCT=IOPBLDL           /* OR BLDL?              @Z40SP00*/ 03802000
*     THEN                          /* YES                   @Z40SP00*/ 03803000
@RF01201 CLI   IOPFUNCT(IOPPTR),3                                  1206 03804000
         BE    @RT01206                                            1206 03805000
         CLI   IOPFUNCT(IOPPTR),4                                  1206 03806000
         BNE   @RF01206                                            1206 03807000
@RT01206 DS    0H                                                  1207 03808000
*     DO;                           /*                       @Z40SP00*/ 03809000
*       CALL BLDL;                  /* DO LOCATE             @Z40SP00*/ 03810000
         BAL   @14,BLDL                                            1208 03811000
*       GO TO EXIT;                 /* RETURN                @Z40SP00*/ 03812000
         B     EXIT                                                1209 03813000
*     END;                          /* END LOCATE OPERATION  @Z40SP00*/ 03814000
*                                                                  1211 03815000
*   /*****************************************************************/ 03816000
*   /*                                                               */ 03817000
*   /* FUNCTION IS INPUT(READ) FOR TEXT LIBRARY CHECK CCA TO SEE IF A*/ 03818000
*   /* BUFFER HAS BEEN GETMAINED FOR THIS AREA YET. IF NOT GET ONE   */ 03819000
*   /*                                                       @Z40SP00*/ 03820000
*   /*                                                               */ 03821000
*   /*****************************************************************/ 03822000
*                                                                  1211 03823000
*   RFY                                                            1211 03824000
*     SIZE RSTD;                    /* REMOVE SIZE FROM USE  @Z40SP00*/ 03825000
@RF01206 DS    0H                                                  1212 03826000
*   IF DCBBLKSI>CCATBFSZ            /* CURRENT BUFFER TOO SMALL    1212 03827000
*                                                            @Z40SP00*/ 03828000
*     THEN                          /* YES                   @Z40SP00*/ 03829000
         L     @11,@CA00038                                        1212 03830000
         L     @03,CCATBFSZ-HMASMCCA(,@11)                         1212 03831000
         CH    @03,DCBBLKSI+52(,DCBPTR)                            1212 03832000
         BNL   @RF01212                                            1212 03833000
*     DO;                           /* GET ANOTHER AREA      @Z40SP00*/ 03834000
*       IF CCATBFSZ^=ZERO           /* IS THERE A BUFFER?    @Z40SP00*/ 03835000
*         THEN                      /* YES                   @Z40SP00*/ 03836000
         LTR   @03,@03                                             1214 03837000
         BZ    @RF01214                                            1214 03838000
*         DO;                       /* FREE PRESENT BUFFER   @Z40SP00*/ 03839000
*           SIZE=CCATBFSZ;          /* FREEMAIN SIZE         @Z40SP00*/ 03840000
         LR    SIZE,@03                                            1216 03841000
*           FREEADDR=CCATBFIA;      /* SET FREEMAIN ADDR     @Z40SP00*/ 03842000
         MVC   FREEADDR(4),CCATBFIA-HMASMCCA(@11)                  1217 03843000
*           GEN(FREEMAIN E,LV=(SIZE),A=FREEADDR)                   1218 03844000
*           REFS(SIZE,FREEADDR);    /* FREE OLD AREA         @Z40SP00*/ 03845000
         FREEMAIN E,LV=(SIZE),A=FREEADDR                                03846000
*         END;                      /* END FREEMAIN          @Z40SP00*/ 03847000
*       SIZE=DCBBLKSI;              /* NEW SIZE              @Z40SP00*/ 03848000
@RF01214 LH    SIZE,DCBBLKSI+52(,DCBPTR)                           1220 03849000
*       GEN(GETMAIN EC,LV=(SIZE),A=GETADDR)                        1221 03850000
*       REFS(SIZE,GETADDR);         /* GET ANOTHER AREA      @Z40SP00*/ 03851000
         GETMAIN EC,LV=(SIZE),A=GETADDR                                 03852000
*       RFY                                                        1222 03853000
*         RTNCODE RSTD;             /* REMOVE R15 FROM USE   @Z40SP00*/ 03854000
*       IF RTNCODE^=IOPGOOD         /* GETMAIN DONE?         @Z40SP00*/ 03855000
*         THEN                      /* NO                    @Z40SP00*/ 03856000
         SLR   @14,@14                                             1223 03857000
         CR    RTNCODE,@14                                         1223 03858000
         BE    @RF01223                                            1223 03859000
*         DO;                       /*                       @Z40SP00*/ 03860000
*           RFY                                                    1225 03861000
*             RTNCODE UNRSTD;       /* RETURN R15 FOR USE    @Z40SP00*/ 03862000
*           CCATBFIA=ZERO;          /* SET BUFFER ADDR       @Z40SP00*/ 03863000
         L     @11,@CA00038                                        1226 03864000
         ST    @14,CCATBFIA-HMASMCCA(,@11)                         1226 03865000
*           MGPMGNO1=HMA202I;       /* SET FOR GETMAIN FAIL  @Z40SP00*/ 03866000
         MVC   MGPMGNO1(2),@CH00235                                1227 03867000
*           MGPTYPE=MGPERR;         /* SET MESSAGE SEVERITY  @ZD00001*/ 03868000
         MVI   MGPTYPE,X'03'                                       1228 03869000
*           CALL HMASMMSG(HMASMMGP);/* WRITE MSG             @Z40SP00*/ 03870000
         L     @15,@CV03346                                        1229 03871000
         LA    @01,@AL01229                                        1229 03872000
         BALR  @14,@15                                             1229 03873000
*           IOPRETRN=IOPNTOPN;      /* SET RETURN CODE       @Z40SP00*/ 03874000
         MVI   IOPRETRN(IOPPTR),X'0C'                              1230 03875000
*           GO TO EXIT;             /* RETURN                @Z40SP00*/ 03876000
         B     EXIT                                                1231 03877000
*         END;                      /* END GETMAIN FAIL      @Z40SP00*/ 03878000
*       CCATBFIA=GETADDR;           /* SET ADDR OF GETMAIN   @Z40SP00*/ 03879000
@RF01223 L     @11,@CA00038                                        1233 03880000
         MVC   CCATBFIA-HMASMCCA(4,@11),GETADDR                    1233 03881000
*       CCATBFSZ=SIZE;              /* PUT GETMAIN SIZE IN CCA     1234 03882000
*                                                            @Z40SP00*/ 03883000
         ST    SIZE,CCATBFSZ-HMASMCCA(,@11)                        1234 03884000
*       CCATBFMX=DCBBLKSI/TXTLRECL; /* MAX RCD IN BLK        @Z40SP00*/ 03885000
         LH    @00,DCBBLKSI+52(,DCBPTR)                            1235 03886000
         SRDA  @00,32                                              1235 03887000
         D     @00,@CF00512                                        1235 03888000
         STH   @01,CCATBFMX-HMASMCCA(,@11)                         1235 03889000
*       RFY                                                        1236 03890000
*         SIZE UNRSTD;              /* RETURN REG FOR USE    @Z40SP00*/ 03891000
*     END;                          /* END NEED GETMAIN      @Z40SP00*/ 03892000
*                                                                  1238 03893000
*   /*****************************************************************/ 03894000
*   /*                                                               */ 03895000
*   /* BUFFER IS AVAILABLE. OPERATION IS POSITION FOR INPUT FOR A    */ 03896000
*   /* TXTLIB DATA SET                                       @Z40SP00*/ 03897000
*   /*                                                               */ 03898000
*   /*****************************************************************/ 03899000
*                                                                  1238 03900000
*   IF IOPFUNCT=IOPPOSI             /* POSITION FOR INPUT?   @Z40SP00*/ 03901000
*     THEN                          /* YES                   @Z40SP00*/ 03902000
@RF01212 CLI   IOPFUNCT(IOPPTR),2                                  1238 03903000
         BNE   @RF01238                                            1238 03904000
*     DO;                           /*                       @Z40SP00*/ 03905000
*       CALL POINT;                 /* POINT                 @Z40SP00*/ 03906000
         BAL   @14,POINT                                           1240 03907000
*       TBFRCNTI=ZERO;              /* ZERO RCD CNT          @Z40SP00*/ 03908000
         SLR   @11,@11                                             1241 03909000
         STH   @11,TBFRCNTI                                        1241 03910000
*       TBFRSIZ=ZERO;               /* ZERO RCDS IN BUFR     @Z40SP00*/ 03911000
         STH   @11,TBFRSIZ                                         1242 03912000
*       GO TO EXIT;                 /* RETURN                @Z40SP00*/ 03913000
         B     EXIT                                                1243 03914000
*     END;                          /* END POSITION          @Z40SP00*/ 03915000
*                                                                  1244 03916000
*   /*****************************************************************/ 03917000
*   /*                                                               */ 03918000
*   /* OPERATION IS READ FROM TXTLIB DATA SET                @Z40SP00*/ 03919000
*   /*                                                               */ 03920000
*   /*****************************************************************/ 03921000
*                                                                  1245 03922000
*   IF IOPFUNCT=IOPREAD             /* READ                  @Z40SP00*/ 03923000
*     THEN                          /* YES                   @Z40SP00*/ 03924000
@RF01238 CLI   IOPFUNCT(IOPPTR),1                                  1245 03925000
         BNE   @RF01245                                            1245 03926000
*     DO;                           /*                       @Z40SP00*/ 03927000
*       IOPRETRN=IOPGOOD;           /* SET GOOD RTN CODE     @Z40SP00*/ 03928000
         MVI   IOPRETRN(IOPPTR),X'00'                              1247 03929000
*       TBFRCNTI=TBFRCNTI+1;        /* UPDATE RCD NUM        @Z40SP00*/ 03930000
         LA    @11,1                                               1248 03931000
         AH    @11,TBFRCNTI                                        1248 03932000
         STH   @11,TBFRCNTI                                        1248 03933000
*       IF TBFRCNTI>TBFRSIZ         /* ANY RCDS IN BLK?      @Z40SP00*/ 03934000
*         THEN                      /* NO                    @Z40SP00*/ 03935000
         CH    @11,TBFRSIZ                                         1249 03936000
         BNH   @RF01249                                            1249 03937000
*         DO;                       /*                       @Z40SP00*/ 03938000
*           BUFFSV=IOPBUFAD;        /* SAVE BUFFER ADDR      @ZD00009*/ 03939000
         MVC   BUFFSV(4),IOPBUFAD(IOPPTR)                          1251 03940000
*           IOPBUFAD=CCATBFIA;      /* INPUT BUFFER ADDR     @Z40SP00*/ 03941000
         L     @11,@CA00038                                        1252 03942000
         MVC   IOPBUFAD(4,IOPPTR),CCATBFIA-HMASMCCA(@11)           1252 03943000
*           CALL READ;              /* READ NEXT BLOCK       @Z40SP00*/ 03944000
         BAL   @14,READ                                            1253 03945000
*           IOPBUFAD=BUFFSV;        /* RESET IOPBUFAD        @Z40SP00*/ 03946000
         MVC   IOPBUFAD(4,IOPPTR),BUFFSV                           1254 03947000
*           IF IOPRETRN=IOPGOOD     /* GOOD READ             @Z40SP00*/ 03948000
*               &CCATBFMX>1         /* AND DS BLOCKED        @Z40SP00*/ 03949000
*             THEN                  /* YES                   @Z40SP00*/ 03950000
         CLI   IOPRETRN(IOPPTR),0                                  1255 03951000
         BNE   @RF01255                                            1255 03952000
         L     @11,@CA00038                                        1255 03953000
         LH    @11,CCATBFMX-HMASMCCA(,@11)                         1255 03954000
         CH    @11,@CH00088                                        1255 03955000
         BNH   @RF01255                                            1255 03956000
*             TBFRSIZ=(DCBBLKSI-IOBRSCT)/TXTLRECL;/*         @Z40SP00*/ 03957000
         LA    @11,52                                              1256 03958000
         ALR   @11,DCBPTR                                          1256 03959000
         L     @04,DCBIOBA(,@11)                                   1256 03960000
         LH    @00,DCBBLKSI(,@11)                                  1256 03961000
         SH    @00,IOBRSCT+8(,@04)                                 1256 03962000
         SRDA  @00,32                                              1256 03963000
         D     @00,@CF00512                                        1256 03964000
         STH   @01,TBFRSIZ                                         1256 03965000
*           ELSE                    /* NOT BLOCKED AND GOOD  @Z40SP00*/ 03966000
*             TBFRSIZ=ONE;          /* UNBLOCKED             @Z40SP00*/ 03967000
         B     @RC01255                                            1257 03968000
@RF01255 MVC   TBFRSIZ(2),@CH00088                                 1257 03969000
*           TBFRCNTI=ONE;           /* RESET RCD LEFT        @Z40SP00*/ 03970000
@RC01255 MVC   TBFRCNTI(2),@CH00088                                1258 03971000
*         END;                      /* END BLOCK EMPTY       @Z40SP00*/ 03972000
*       IF IOPRETRN=IOPEOF          /* END OF FILE           @Z40SP00*/ 03973000
*         THEN                      /* YES                   @Z40SP00*/ 03974000
@RF01249 CLI   IOPRETRN(IOPPTR),4                                  1260 03975000
         BNE   @RF01260                                            1260 03976000
*         TBFRCNTI=ZERO;            /* RESET CNT FOR NEXT RD @Z40SP00*/ 03977000
         SLR   @11,@11                                             1261 03978000
         STH   @11,TBFRCNTI                                        1261 03979000
*       ELSE                        /* NOT EOF               @Z40SP00*/ 03980000
*         LOGICREC=TXTIBUFR(TBFRCNTI);/* MOVE RCD TO BFR     @Z40SP00*/ 03981000
         B     @RC01260                                            1262 03982000
@RF01260 L     @11,IOPBUFAD(,IOPPTR)                               1262 03983000
         LH    @04,TBFRCNTI                                        1262 03984000
         MH    @04,@CH00512                                        1262 03985000
         L     @03,@CA00038                                        1262 03986000
         L     @03,CCATBFIA-HMASMCCA(,@03)                         1262 03987000
         ALR   @03,@04                                             1262 03988000
         AL    @03,@CF04248                                        1262 03989000
         MVC   LOGICREC(80,@11),TXTIBUFR(@03)                      1262 03990000
*       GO TO EXIT;                 /* RETURN                @Z40SP00*/ 03991000
         B     EXIT                                                1263 03992000
*     END;                          /* END READ              @Z40SP00*/ 03993000
*                                                                  1264 03994000
*   /*****************************************************************/ 03995000
*   /*                                                               */ 03996000
*   /* INVALID REQUEST FOR TEXTLIB                           @Z40SP00*/ 03997000
*   /*                                                               */ 03998000
*   /*****************************************************************/ 03999000
*                                                                  1265 04000000
*   IOPRETRN=IOPIOERR;              /* INVALID FUNCTION      @Z40SP00*/ 04001000
@RF01245 MVI   IOPRETRN(IOPPTR),X'10'                              1265 04002000
*   GO TO EXIT;                     /* RETURN                @Z40SP00*/ 04003000
         B     EXIT                                                1266 04004000
         EJECT                                                          04005000
*                                                                  1267 04006000
*   /*****************************************************************/ 04007000
*   /*                                                               */ 04008000
*   /* THIS ROUTINE IS TO HANDLE THE SMPPUNCH DATA SET       @Z40SP00*/ 04009000
*   /*                                                               */ 04010000
*   /*****************************************************************/ 04011000
*                                                                  1267 04012000
*PUNRTN:                            /*                       @Z40SP00*/ 04013000
*   IF IOPFUNCT=IOPWRITE            /* WRITE REQUEST?        @Z40SP00*/ 04014000
*     THEN                          /* YES                   @Z40SP00*/ 04015000
PUNRTN   CLI   IOPFUNCT(IOPPTR),81                                 1267 04016000
         BNE   @RF01267                                            1267 04017000
*     DO;                           /*                       @Z40SP00*/ 04018000
*       PRNTDATA(1:PRLRLEN)=PRLDATA(1:PRLRLEN);/* MOVE DATA TO OUTPUT   04019000
*                                      BUFFER                @Z40SP00*/ 04020000
         L     @11,IOPBUFAD(,IOPPTR)                               1269 04021000
         LH    @04,PRLRLEN(,@11)                                   1269 04022000
         BCTR  @04,0                                               1269 04023000
         EX    @04,@SM04253                                        1269 04024000
*       BUFFSV=IOPBUFAD;            /* SAVE BUFFER ADDR      @ZD00009*/ 04025000
         ST    @11,BUFFSV                                          1270 04026000
*       IOPBUFAD=ADDR(PRNTDATA(1)); /* POINT TO DATA TO PUNCH      1271 04027000
*                                                            @Z40SP00*/ 04028000
         LA    @11,PRNTDATA                                        1271 04029000
         ST    @11,IOPBUFAD(,IOPPTR)                               1271 04030000
*       CALL PUT;                   /* PUNCH IT              @Z40SP00*/ 04031000
         BAL   @14,PUT                                             1272 04032000
*       IOPBUFAD=BUFFSV;            /* RESET BUFFER ADDR     @ZD00009*/ 04033000
         MVC   IOPBUFAD(4,IOPPTR),BUFFSV                           1273 04034000
*       PRNTDATA=BLANK;             /* BLANK OUT BUFFER      @Z40SP00*/ 04035000
         MVI   PRNTDATA+1,C' '                                     1274 04036000
         MVC   PRNTDATA+2(118),PRNTDATA+1                          1274 04037000
         MVI   PRNTDATA,C' '                                       1274 04038000
*     END;                          /* END WRITE REQUEST     @Z40SP00*/ 04039000
*   ELSE                            /* NOT WRITE - INVALID   @Z40SP00*/ 04040000
*     IOPRETRN=IOPIOERR;            /* SET BAD RTN CDE AND   @Z40SP00*/ 04041000
         B     @RC01267                                            1276 04042000
@RF01267 MVI   IOPRETRN(IOPPTR),X'10'                              1276 04043000
*   GO TO EXIT;                     /* RETURN                @Z40SP00*/ 04044000
         B     EXIT                                                1277 04045000
         EJECT                                                          04046000
*                                                                  1278 04047000
*   /*****************************************************************/ 04048000
*   /*                                                               */ 04049000
*   /* THIS ROUTINE IS CALLED WHEN A REQUEST HAS BEEN MADE TO MODIFY */ 04050000
*   /* A DATA SET TO BE OTHER THAN REQUESTED ON THE DD CARD. THE PDS */ 04051000
*   /* MAY BECOME A MEMBER OF A PDS AND THEN CHANGED BACK OR THE     */ 04052000
*   /* REQUEST COUND BE JUST TO RETRIEVE THE JFCB            @Z40SP00*/ 04053000
*   /*                                                               */ 04054000
*   /*****************************************************************/ 04055000
*                                                                  1278 04056000
*JFCBRTN:                           /*                       @Z40SP00*/ 04057000
*   GEN(CLOSE  ((DCBPTR)))                                         1278 04058000
*   REFS(DCBPTR);                   /* CLOSE DCB             @Z67SP00*/ 04059000
JFCBRTN  CLOSE  ((DCBPTR))                                              04060000
*   IF DCBOFOPN=ON                  /* IF CLOSE FAILED       @Z67SP00*/ 04061000
*     THEN                          /*                       @Z67SP00*/ 04062000
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     1279 04063000
         BO    @RT01279                                            1279 04064000
*     GO TO CLOSFAIL;               /* GO WRITE ERR MSG      @Z67SP00*/ 04065000
*   GO TO EXIT;                     /* RETURN                @Z67SP00*/ 04066000
         B     EXIT                                                1281 04067000
         EJECT                                                          04068000
*                                                                  1282 04069000
*   /*****************************************************************/ 04070000
*   /*                                                               */ 04071000
*   /* ROUTINE TO HANDLE REQUESTES FOR THE SMPPTFIN DATASET  @Z67SP00*/ 04072000
*   /*                                                               */ 04073000
*   /*****************************************************************/ 04074000
*                                                                  1282 04075000
*PTFINRTN:                          /*                       @Z67SP00*/ 04076000
*                                                                  1282 04077000
*   /*****************************************************************/ 04078000
*   /*                                                               */ 04079000
*   /* PROCESS READ REQUESTS                                 @Z67SP00*/ 04080000
*   /*                                                               */ 04081000
*   /*****************************************************************/ 04082000
*                                                                  1282 04083000
*   IF IOPFUNCT=IOPREAD             /* IF READ REQUEST       @Z67SP00*/ 04084000
*     THEN                          /*                       @Z67SP00*/ 04085000
PTFINRTN CLI   IOPFUNCT(IOPPTR),1                                  1282 04086000
         BNE   @RF01282                                            1282 04087000
*     DO;                           /*                       @Z67SP00*/ 04088000
*       CALL GET;                   /* GET NEXT RECORD       @Z67SP00*/ 04089000
         BAL   @14,GET                                             1284 04090000
*       GO TO EXIT;                 /*                       @Z67SP00*/ 04091000
         B     EXIT                                                1285 04092000
*     END;                          /*                       @Z67SP00*/ 04093000
*                                                                  1286 04094000
*   /*****************************************************************/ 04095000
*   /*                                                               */ 04096000
*   /* PROCESS POISTION FOR INPUT REQUESTS. JFCB HAS ALREADY BEEN    */ 04097000
*   /* MODIFIED TO POINT TO CORRECT DATASETNAME AND FILE NUMBER. NOW */ 04098000
*   /* CLOSE DCB WITH REREAD OPTION TO PREVENT TAPE REWIND           */ 04099000
*   /*                                                               */ 04100000
*   /*****************************************************************/ 04101000
*                                                                  1287 04102000
*   IF IOPFUNCT=IOPPOSI             /* IF POSITION FOR INPUT @Z67SP00*/ 04103000
*     THEN                          /*                       @Z67SP00*/ 04104000
@RF01282 CLI   IOPFUNCT(IOPPTR),2                                  1287 04105000
         BNE   @RF01287                                            1287 04106000
*     DO;                           /*                       @Z67SP00*/ 04107000
*       GEN(CLOSE ((DCBPTR),REREAD));/* CLOSE DCB            @Z40SP00*/ 04108000
         CLOSE ((DCBPTR),REREAD)                                        04109000
*       IF DCBOFOPN=ON              /* CLOSE FAIL?           @Z40SP00*/ 04110000
*         THEN                      /* YES                   @Z40SP00*/ 04111000
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     1290 04112000
         BO    @RT01290                                            1290 04113000
*         GO TO CLOSFAIL;           /* GO WRITE ERR MSG      @Z40SP00*/ 04114000
*       GO TO EXIT;                 /* RETURN                @Z40SP00*/ 04115000
         B     EXIT                                                1292 04116000
*     END;                          /*                       @Z67SP00*/ 04117000
*   GO TO BADEXIT;                  /* INVALID REQUEST       @Z67SP00*/ 04118000
         B     BADEXIT                                             1294 04119000
         EJECT                                                          04120000
*                                                                  1295 04121000
*   /*****************************************************************/ 04122000
*   /*                                                               */ 04123000
*   /* ROUTINE CALLED TO SET IOPDSID BASED ON TYPE MEMBER SPECIFIED  */ 04124000
*   /* IF IOPDSID PASSED WAS IOPWKX                          @Z67SP00*/ 04125000
*   /*                                                               */ 04126000
*   /*****************************************************************/ 04127000
*                                                                  1295 04128000
*IODSCHCK:                          /*                       @Z67SP00*/ 04129000
*   PROCEDURE;                      /*                       @Z67SP00*/ 04130000
IODSCHCK STM   @14,@12,12(@13)                                     1295 04131000
*   IF IOPTYPE=IOPMCR               /* IF MAC REPLACEMENT    @Z67SP00*/ 04132000
*       |IOPTYPE=IOPMCU             /* OR UPDATE             @Z67SP00*/ 04133000
*     THEN                          /*                       @Z67SP00*/ 04134000
         CLI   IOPTYPE(IOPPTR),3                                   1296 04135000
         BE    @RT01296                                            1296 04136000
         CLI   IOPTYPE(IOPPTR),4                                   1296 04137000
         BNE   @RF01296                                            1296 04138000
@RT01296 DS    0H                                                  1297 04139000
*     DO;                           /*                       @Z67SP00*/ 04140000
*       IOPDDNAM=CCADSIDA(IOPWK1);  /*                       @Z67SP00*/ 04141000
         L     @11,@CA00038                                        1298 04142000
         L     @11,CCADSAD-HMASMCCA(,@11)                          1298 04143000
         MVC   IOPDDNAM(8,IOPPTR),CCADSIDA+272(@11)                1298 04144000
*       IOPDSID=IOPWK1;             /* USE WK1               @Z67SP00*/ 04145000
         MVI   IOPDSID(IOPPTR),X'23'                               1299 04146000
*     END;                          /*                       @Z67SP00*/ 04147000
*   ELSE                            /*                       @Z67SP00*/ 04148000
*     IF IOPTYPE=IOPSRC             /* IF SRC REPLACEMENT    @Z67SP00*/ 04149000
*         |IOPTYPE=IOPSCU           /* OR SRCUPD             @Z67SP00*/ 04150000
*       THEN                        /*                       @Z67SP00*/ 04151000
         B     @RC01296                                            1301 04152000
@RF01296 CLI   IOPTYPE(IOPPTR),8                                   1301 04153000
         BE    @RT01301                                            1301 04154000
         CLI   IOPTYPE(IOPPTR),9                                   1301 04155000
         BNE   @RF01301                                            1301 04156000
@RT01301 DS    0H                                                  1302 04157000
*       DO;                         /*                       @Z67SP00*/ 04158000
*         IOPDDNAM=CCADSIDA(IOPWK2);/*                       @Z67SP00*/ 04159000
         L     @11,@CA00038                                        1303 04160000
         L     @11,CCADSAD-HMASMCCA(,@11)                          1303 04161000
         MVC   IOPDDNAM(8,IOPPTR),CCADSIDA+280(@11)                1303 04162000
*         IOPDSID=IOPWK2;           /* USE WK2               @Z67SP00*/ 04163000
         MVI   IOPDSID(IOPPTR),X'24'                               1304 04164000
*       END;                        /*                       @Z67SP00*/ 04165000
*     ELSE                          /*                       @Z67SP00*/ 04166000
*       IF IOPTYPE=IOPMOD           /* IF MOD REPLACEMENT    @Z67SP00*/ 04167000
*           |IOPTYPE=IOPASM         /* OR ASSEMBLY           @Z67SP00*/ 04168000
*           |IOPTYPE=IOPZAP         /* OR ZAP                @Z67SP00*/ 04169000
*         THEN                      /*                       @Z67SP00*/ 04170000
         B     @RC01301                                            1306 04171000
@RF01301 CLI   IOPTYPE(IOPPTR),5                                   1306 04172000
         BE    @RT01306                                            1306 04173000
         CLI   IOPTYPE(IOPPTR),1                                   1306 04174000
         BE    @RT01306                                            1306 04175000
         CLI   IOPTYPE(IOPPTR),12                                  1306 04176000
         BNE   @RF01306                                            1306 04177000
@RT01306 DS    0H                                                  1307 04178000
*         DO;                       /*                       @Z67SP00*/ 04179000
*           IOPDDNAM=CCADSIDA(IOPWK3);/*                     @Z67SP00*/ 04180000
         L     @11,@CA00038                                        1308 04181000
         L     @11,CCADSAD-HMASMCCA(,@11)                          1308 04182000
         MVC   IOPDDNAM(8,IOPPTR),CCADSIDA+288(@11)                1308 04183000
*           IOPDSID=IOPWK3;         /* USE WK3               @Z67SP00*/ 04184000
         MVI   IOPDSID(IOPPTR),X'25'                               1309 04185000
*         END;                      /*                       @Z67SP00*/ 04186000
*       ELSE                        /*                       @Z67SP00*/ 04187000
*         IF IOPTYPE=IOPXZP         /* IF EXPAND CARDS       @Z67SP00*/ 04188000
*           THEN                    /*                       @Z67SP00*/ 04189000
         B     @RC01306                                            1311 04190000
@RF01306 CLI   IOPTYPE(IOPPTR),13                                  1311 04191000
         BNE   @RF01311                                            1311 04192000
*           DO;                     /*                       @Z67SP00*/ 04193000
*             IOPDDNAM=CCADSIDA(IOPWK4);/*                   @Z67SP00*/ 04194000
         L     @11,@CA00038                                        1313 04195000
         L     @11,CCADSAD-HMASMCCA(,@11)                          1313 04196000
         MVC   IOPDDNAM(8,IOPPTR),CCADSIDA+296(@11)                1313 04197000
*             IOPDSID=IOPWK4;       /* USE WK4               @Z67SP00*/ 04198000
         MVI   IOPDSID(IOPPTR),X'26'                               1314 04199000
*           END;                    /*                       @Z67SP00*/ 04200000
*         ELSE                      /* INVALID TYPE/DSID     @Z67SP00*/ 04201000
*           IOPRETRN=IOPIOERR;      /* SO SET BAD ERROR      @Z67SP00*/ 04202000
         B     @RC01311                                            1316 04203000
@RF01311 MVI   IOPRETRN(IOPPTR),X'10'                              1316 04204000
*   END IODSCHCK;                   /*                       @Z67SP00*/ 04205000
@EL00002 DS    0H                                                  1317 04206000
@EF00002 DS    0H                                                  1317 04207000
@ER00002 LM    @14,@12,12(@13)                                     1317 04208000
         BR    @14                                                 1317 04209000
         EJECT                                                          04210000
*                                                                  1318 04211000
*   /*****************************************************************/ 04212000
*   /*                                                               */ 04213000
*   /* ROUTINE CALLED AFTER RDJFCB ISSUED. THIS ROUTINE WILL DO ALL  */ 04214000
*   /* PROCESSING REQUIRED TO CHANGE THE JFCB                @Z67SP00*/ 04215000
*   /*                                                               */ 04216000
*   /*****************************************************************/ 04217000
*                                                                  1318 04218000
*JFCBMOD:                           /*                       @Z67SP00*/ 04219000
*   PROCEDURE;                      /*                       @Z67SP00*/ 04220000
JFCBMOD  STM   @14,@12,@SA00003                                    1318 04221000
*   IOPRETRN=IOPGOOD;               /* SET RETURN CODE       @Z67SP00*/ 04222000
*                                                                  1319 04223000
         MVI   IOPRETRN(IOPPTR),X'00'                              1319 04224000
*   /*****************************************************************/ 04225000
*   /*                                                               */ 04226000
*   /* MODIFY JFCB FOR IOPJFCB DATASET                       @Z67SP00*/ 04227000
*   /*                                                               */ 04228000
*   /*****************************************************************/ 04229000
*                                                                  1320 04230000
*   IF IOPDSID=IOPJFCB              /* JFCB CHANGE?          @Z40SP00*/ 04231000
*       &(IOPFUNCT=IOPJFCSI         /* CHANGE TO MEM OF PDS FOR INPUT   04232000
*                                                            @Z40SP00*/ 04233000
*       |IOPFUNCT=IOPJFCSO)         /* OR CHANGE TO MEM OF PDS FOR 1320 04234000
*                                      OUTPUT                @Z40SP00*/ 04235000
*     THEN                          /* YES                   @Z40SP00*/ 04236000
         CLI   IOPDSID(IOPPTR),25                                  1320 04237000
         BNE   @RF01320                                            1320 04238000
         CLI   IOPFUNCT(IOPPTR),5                                  1320 04239000
         BE    @RT01320                                            1320 04240000
         CLI   IOPFUNCT(IOPPTR),88                                 1320 04241000
         BNE   @RF01320                                            1320 04242000
@RT01320 DS    0H                                                  1321 04243000
*     DO;                           /* SAVE JFCB             @Z40SP00*/ 04244000
*       IF JFCB01NM(1)=BLANK        /* IF NO SAVE IN 01      @Z67SP00*/ 04245000
*         THEN                      /* THEN SAVE JFCB THERE  @Z67SP00*/ 04246000
         CLI   JFCB01NM,C' '                                       1322 04247000
         BNE   @RF01322                                            1322 04248000
*         DO;                       /*                       @Z67SP00*/ 04249000
*           ADJFCB01->JFCBAREA=JFCBAREA;/*                   @Z67SP00*/ 04250000
         L     @11,ADJFCB01                                        1324 04251000
         L     @04,JFCBPTR                                         1324 04252000
         MVC   JFCBAREA(176,@11),JFCBAREA(@04)                     1324 04253000
*           JFCB01NM=IOPDDNAM;      /* JFCB IN USE BY        @Z67SP00*/ 04254000
         MVC   JFCB01NM(8),IOPDDNAM(IOPPTR)                        1325 04255000
*         END;                      /*                       @Z67SP00*/ 04256000
*       ELSE                        /* IF 01 IN USE          @Z67SP00*/ 04257000
*         IF JFCB02NM(1)=BLANK      /* IF 02 NOT IN          @Z67SP00*/ 04258000
*           THEN                    /* SAVE JFCB THERE       @Z67SP00*/ 04259000
         B     @RC01322                                            1327 04260000
@RF01322 CLI   JFCB02NM,C' '                                       1327 04261000
         BNE   @RF01327                                            1327 04262000
*           DO;                     /*                       @Z67SP00*/ 04263000
*             ADJFCB02->JFCBAREA=JFCBAREA;/*                 @Z67SP00*/ 04264000
         L     @11,ADJFCB02                                        1329 04265000
         L     @04,JFCBPTR                                         1329 04266000
         MVC   JFCBAREA(176,@11),JFCBAREA(@04)                     1329 04267000
*             JFCB02NM=IOPDDNAM;    /* JFCB IN USE BY        @Z67SP00*/ 04268000
         MVC   JFCB02NM(8),IOPDDNAM(IOPPTR)                        1330 04269000
*           END;                    /*                       @Z67SP00*/ 04270000
*         ELSE                      /* IF BOTH FILLED        @Z67SP00*/ 04271000
*           IOPRETRN=IOPIOERR;      /* INTERNAL ERROR        @Z67SP00*/ 04272000
         B     @RC01327                                            1332 04273000
@RF01327 MVI   IOPRETRN(IOPPTR),X'10'                              1332 04274000
*       IF IOPFUNCT=IOPJFCSO        /* IF RESET FOR OUTPUT   @Z67SP00*/ 04275000
*           &JFCDISP=DISPNEW        /* AND DS IS ALLOC NEW   @Z67SP00*/ 04276000
*         THEN                      /* CHANGE TO DISP=OLD    @Z67SP00*/ 04277000
@RC01327 DS    0H                                                  1333 04278000
@RC01322 CLI   IOPFUNCT(IOPPTR),88                                 1333 04279000
         BNE   @RF01333                                            1333 04280000
         L     @11,JFCBPTR                                         1333 04281000
         TM    JFCDISP(@11),B'11000000'                            1333 04282000
         BNO   @RF01333                                            1333 04283000
*         JFCDISP=DISPOLD;          /* SO NO OUTPUT PROBLEMS WITH  1334 04284000
*                                      UTILITY. DISP WILL BE RESET 1334 04285000
*                                      WHEN DS CHANGED BACK TO PDS 1334 04286000
*                                                            @Z67SP00*/ 04287000
         NI    JFCDISP(@11),B'01111111'                            1334 04288000
         OI    JFCDISP(@11),B'01000000'                            1334 04289000
*       JFCBOPSW=ON;                /* SET REWITE AT OPEN SW @Z40SP00*/ 04290000
@RF01333 L     @11,JFCBPTR                                         1335 04291000
         OI    JFCBOPSW(@11),B'10000000'                           1335 04292000
*       JFCNWRIT=OFF;               /* RESET NO WRITE BIT    @Z67SP00*/ 04293000
         NI    JFCNWRIT(@11),B'11110111'                           1336 04294000
*       JFCPDS=ON;                  /* SET MEM OF PDS        @Z40SP00*/ 04295000
         OI    JFCPDS(@11),B'00000001'                             1337 04296000
*       JFCBELNM=IOPINAM;           /* SET MEMBER NAME       @ZD00008*/ 04297000
         MVC   JFCBELNM(8,@11),IOPINAM(IOPPTR)                     1338 04298000
*     END;                          /* END JFCB CHANGE       @Z40SP00*/ 04299000
*                                                                  1339 04300000
*   /*****************************************************************/ 04301000
*   /*                                                               */ 04302000
*   /* MODIFY JFCB FOR IOPCDS OR IOPACDS DATASETS            @Z67SP00*/ 04303000
*   /*                                                               */ 04304000
*   /*****************************************************************/ 04305000
*                                                                  1340 04306000
*   IF IOPDSID=IOPCDSM              /* WAS THIS FOR CDS?     @YA05376*/ 04307000
*       |IOPDSID=IOPCDSA            /* OR ACDS?              @SA72416*/ 04308000
*     THEN                          /* YES - CHECK DISP      @YA05376*/ 04309000
@RF01320 CLI   IOPDSID(IOPPTR),2                                   1340 04310000
         BE    @RT01340                                            1340 04311000
         CLI   IOPDSID(IOPPTR),12                                  1340 04312000
         BNE   @RF01340                                            1340 04313000
@RT01340 DS    0H                                                  1341 04314000
*     IF JFCDISP=DISPMOD            /* DISP=MOD?             @YA05376*/ 04315000
*       THEN                        /* YES                   @YA05376*/ 04316000
         L     @11,JFCBPTR                                         1341 04317000
         TM    JFCDISP(@11),B'10000000'                            1341 04318000
         BNO   @RF01341                                            1341 04319000
         TM    JFCDISP(@11),B'01000000'                            1341 04320000
         BNZ   @RF01341                                            1341 04321000
*       DO;                         /*                       @YA05376*/ 04322000
*         JFCDISP=DISPOLD;          /* CHANGE TO DISP=OLD    @YA05376*/ 04323000
         NI    JFCDISP(@11),B'01111111'                            1343 04324000
         OI    JFCDISP(@11),B'01000000'                            1343 04325000
*         JFCBOPSW=ON;              /* INDICATE THAT JFCB SHOULD BE     04326000
*                                      REWRITTEN AT OPEN     @Z40SP00*/ 04327000
         OI    JFCBOPSW(@11),B'10000000'                           1344 04328000
*         JFCNWRIT=OFF;             /* RESET NO WRITE BIT    @Z67SP00*/ 04329000
         NI    JFCNWRIT(@11),B'11110111'                           1345 04330000
*       END;                        /* END CDS/ACDS          @YA05376*/ 04331000
*                                                                  1346 04332000
*   /*****************************************************************/ 04333000
*   /*                                                               */ 04334000
*   /* MODIFY JFCB FOR IOPPTFIN DATASET                      @Z67SP00*/ 04335000
*   /*                                                               */ 04336000
*   /*****************************************************************/ 04337000
*                                                                  1347 04338000
*   IF IOPDSID=IOPPTFIN             /* IF PTFIN              @Z67SP00*/ 04339000
*     THEN                          /*                       @Z67SP00*/ 04340000
@RF01341 DS    0H                                                  1347 04341000
@RF01340 CLI   IOPDSID(IOPPTR),10                                  1347 04342000
         BNE   @RF01347                                            1347 04343000
*     DO;                           /*                       @Z67SP00*/ 04344000
*       IF IOPSEQNO=1               /* IF FILE 1 THEN        @Z67SP00*/ 04345000
*         THEN                      /*                       @Z67SP00*/ 04346000
         CLC   IOPSEQNO(2,IOPPTR),@CH00088                         1349 04347000
         BNE   @RF01349                                            1349 04348000
*         DO;                       /*                       @Z67SP00*/ 04349000
*           IF PTFJFSV=OFF          /* IF JFCB NOT SAVED YET @Z67SP00*/ 04350000
*               |PTFF2OP=OFF        /* OR NEVER OPENED 2ND   @Z67SP00*/ 04351000
*             THEN                  /* FILE                  @Z67SP00*/ 04352000
         TM    PTFJFSV,B'00000011'                                 1351 04353000
         BO    @RF01351                                            1351 04354000
*             DO;                   /*                               */ 04355000
*               PTFJFSV=ON;         /* INDICATE JFCB SAVED   @Z67SP00*/ 04356000
         OI    PTFJFSV,B'00000010'                                 1353 04357000
*               ADJFCBPT->JFCBAREA=JFCBAREA;/* SAVE IT       @Z67SP00*/ 04358000
         L     @11,ADJFCBPT                                        1354 04359000
         L     @04,JFCBPTR                                         1354 04360000
         MVC   JFCBAREA(176,@11),JFCBAREA(@04)                     1354 04361000
*             END;                  /*                               */ 04362000
*           ELSE                    /* IF SECOND TIME THEN   @Z67SP00*/ 04363000
*             JFCBAREA=ADJFCBPT->JFCBAREA;/* COPY FROM SAVE  @Z67SP00*/ 04364000
         B     @RC01351                                            1356 04365000
@RF01351 L     @11,JFCBPTR                                         1356 04366000
         L     @04,ADJFCBPT                                        1356 04367000
         MVC   JFCBAREA(176,@11),JFCBAREA(@04)                     1356 04368000
*           JFCBOPSW=ON;            /* REWRITE JFCB AT OPEN  @Z67SP00*/ 04369000
@RC01351 L     @11,JFCBPTR                                         1357 04370000
         OI    JFCBOPSW(@11),B'10000000'                           1357 04371000
*           JFCNWRIT=OFF;           /* MERGE BACK JFCB       @Z67SP00*/ 04372000
         NI    JFCNWRIT(@11),B'11110111'                           1358 04373000
*         END;                      /*                       @Z67SP00*/ 04374000
*       ELSE                        /* IF RELFILE ON TAPE    @Z67SP00*/ 04375000
*         DO;                       /*                       @Z67SP00*/ 04376000
         B     @RC01349                                            1360 04377000
@RF01349 DS    0H                                                  1361 04378000
*           IF JFCSL=OFF            /* IF NOT SL TAPE        @Z67SP00*/ 04379000
*             THEN                  /*                       @Z67SP00*/ 04380000
         L     @11,JFCBPTR                                         1361 04381000
         TM    JFCSL(@11),B'00000010'                              1361 04382000
         BNZ   @RF01361                                            1361 04383000
*             DO;                   /*                       @Z67SP00*/ 04384000
*               MGPCLEAR=''B;       /*                       @Z67SP00*/ 04385000
         XC    MGPCLEAR(6),MGPCLEAR                                1363 04386000
*               MGPMGNO1=HMA343I;   /* PTFIN WITH RELFILES MUST BE 1364 04387000
*                                      STANDARD LABEL        @Z67SP00*/ 04388000
         MVC   MGPMGNO1(2),@CH03323                                1364 04389000
*               MGPTYPE=MGPTERM;    /*                       @Z67SP00*/ 04390000
         MVI   MGPTYPE,X'05'                                       1365 04391000
*               CALL HMASMMSG(HMASMMGP);/* WRITE MSG         @Z67SP00*/ 04392000
         L     @15,@CV03346                                        1366 04393000
         LA    @01,@AL01366                                        1366 04394000
         BALR  @14,@15                                             1366 04395000
*               IOPRETRN=IOPNTOPN;  /*                       @Z67SP00*/ 04396000
         MVI   IOPRETRN(IOPPTR),X'0C'                              1367 04397000
*             END;                  /*                       @Z67SP00*/ 04398000
*           ELSE                    /* IF TAPE IS SL         @Z67SP00*/ 04399000
*             DO;                   /*                       @Z67SP00*/ 04400000
         B     @RC01361                                            1369 04401000
@RF01361 DS    0H                                                  1370 04402000
*               PTFF2OP=ON;         /* OPENED SECOND FILE    @Z67SP00*/ 04403000
         OI    PTFF2OP,B'00000001'                                 1370 04404000
*               JFCRECFM=RECFMNL;   /* GET RECFM FROM TAPE   @Z67SP00*/ 04405000
         L     @11,JFCBPTR                                         1371 04406000
         MVI   JFCRECFM(@11),B'00000000'                           1371 04407000
*               JFCLRECL=ZERO;      /* GET LRECL FROM TAPE   @Z67SP00*/ 04408000
         SLR   @04,@04                                             1372 04409000
         STH   @04,JFCLRECL(,@11)                                  1372 04410000
*               JFCBLKSI=ZERO;      /* GET BLKSIZE FROM TP   @Z67SP00*/ 04411000
         STH   @04,JFCBLKSI(,@11)                                  1373 04412000
*               JFCBDSNM=IOPDSN;    /* MOVE DSN TO JFCB      @Z67SP00*/ 04413000
         MVC   JFCBDSNM(44,@11),IOPDSN(IOPPTR)                     1374 04414000
*               JFCBFLSQ=IOPSEQNO;  /* MOVE FILE SEQ NUM     @Z67SP00*/ 04415000
         MVC   JFCBFLSQ(2,@11),IOPSEQNO(IOPPTR)                    1375 04416000
*               JFCBOPSW=ON;        /* REWRITE JFCB AT OPEN  @Z67SP00*/ 04417000
         OI    JFCBOPSW(@11),B'10000000'                           1376 04418000
*               JFCNWRIT=OFF;       /* MERGE BACK JFCB       @Z67SP00*/ 04419000
         NI    JFCNWRIT(@11),B'11110111'                           1377 04420000
*             END;                  /*                       @Z67SP00*/ 04421000
*         END;                      /* END PTFIN FILE 1      @Z67SP00*/ 04422000
@RC01361 DS    0H                                                  1380 04423000
*     END;                          /* END PTFIN DATASET     @Z67SP00*/ 04424000
*                                                                  1380 04425000
@RC01349 DS    0H                                                  1381 04426000
*   /*****************************************************************/ 04427000
*   /*                                                               */ 04428000
*   /* MODIFY JFCB FOR IOPLRF DATASET                        @Z67SP00*/ 04429000
*   /*                                                               */ 04430000
*   /*****************************************************************/ 04431000
*                                                                  1381 04432000
*   IF IOPDSID=IOPLRF               /* IF LRF DS             @Z67SP00*/ 04433000
*       &(IOPFUNCT=IOPALC           /* ALLOCATE              @Z67SP00*/ 04434000
*       |IOPFUNCT=IOPDALC           /* DEALLOCATE            @Z67SP00*/ 04435000
*       |IOPFUNCT=IOPDEL)           /* OR DELETE             @Z67SP00*/ 04436000
*     THEN                          /*                       @Z67SP00*/ 04437000
@RF01347 CLI   IOPDSID(IOPPTR),32                                  1381 04438000
         BNE   @RF01381                                            1381 04439000
         CLI   IOPFUNCT(IOPPTR),13                                 1381 04440000
         BE    @RT01381                                            1381 04441000
         CLI   IOPFUNCT(IOPPTR),14                                 1381 04442000
         BE    @RT01381                                            1381 04443000
         CLI   IOPFUNCT(IOPPTR),15                                 1381 04444000
         BNE   @RF01381                                            1381 04445000
@RT01381 DS    0H                                                  1382 04446000
*     DO;                           /*                       @Z67SP00*/ 04447000
*       JFCRECFM=RECFMNL;           /* GET RECFM FROM DS     @Z67SP00*/ 04448000
         L     @11,JFCBPTR                                         1383 04449000
         MVI   JFCRECFM(@11),B'00000000'                           1383 04450000
*       IF IOPFUNCT=IOPALC          /* IF NEW DATASET ALLOC  @Z67SP00*/ 04451000
*           &IOPSPRIM^=ZERO         /* (IE SPACE SPECIFIED   @Z67SP00*/ 04452000
*         THEN                      /* THEN MUST SET RECFM   @Z67SP00*/ 04453000
         CLI   IOPFUNCT(IOPPTR),13                                 1384 04454000
         BNE   @RF01384                                            1384 04455000
         ICM   @04,3,IOPSPRIM(IOPPTR)                              1384 04456000
         BZ    @RF01384                                            1384 04457000
*         IF IOPDMAC=ON             /* IF MAC/SRC/ OR JCLIN  @Z67SP00*/ 04458000
*             |IOPDSRC=ON           /*                       @Z67SP00*/ 04459000
*             |IOPDJCL=ON           /*                       @Z67SP00*/ 04460000
*           THEN                    /*                       @Z67SP00*/ 04461000
         TM    IOPDMAC(IOPPTR),B'11100000'                         1385 04462000
         BZ    @RF01385                                            1385 04463000
*           DO;                     /* THEN ASSUME           @Z67SP00*/ 04464000
*             JFCFMREC=RECFMF;      /* RECFM=F               @Z67SP00*/ 04465000
         NI    JFCFMREC(@11),B'10111111'                           1387 04466000
         OI    JFCFMREC(@11),B'10000000'                           1387 04467000
*             JFCRFB=RECFMB;        /* RECFM=.B              @Z67SP00*/ 04468000
         OI    JFCRFB(@11),B'00010000'                             1388 04469000
*           END;                    /*                       @Z67SP00*/ 04470000
*         ELSE                      /* MUST BE MOD TYPE      @Z67SP00*/ 04471000
*           JFCFMREC=RECFMU;        /* ASSUME RECFM=U        @Z67SP00*/ 04472000
         B     @RC01385                                            1390 04473000
@RF01385 L     @11,JFCBPTR                                         1390 04474000
         OI    JFCFMREC(@11),B'11000000'                           1390 04475000
*       JFCLRECL=ZERO;              /* GET LRECL FROM DS     @Z67SP00*/ 04476000
@RC01385 DS    0H                                                  1391 04477000
@RF01384 SLR   @11,@11                                             1391 04478000
         L     @04,JFCBPTR                                         1391 04479000
         STH   @11,JFCLRECL(,@04)                                  1391 04480000
*       JFCBLKSI=ZERO;              /* GET BLKSIZE FROM DS   @Z67SP00*/ 04481000
         STH   @11,JFCBLKSI(,@04)                                  1392 04482000
*       CALL HMASMALC(HMASMIOP,INFMJFCB);/* CALL ALC MOD     @Z67SP00*/ 04483000
         ST    IOPPTR,@AL00001                                     1393 04484000
         ST    @04,@AL00001+4                                      1393 04485000
         L     @15,@CV03342                                        1393 04486000
         LA    @01,@AL00001                                        1393 04487000
         BALR  @14,@15                                             1393 04488000
*       RFY                                                        1394 04489000
*         RTNCODE RSTD;             /*                       @Z67SP00*/ 04490000
*       IOPRETRN=RTNCODE;           /* SAVE RC FROM ALC      @Z67SP00*/ 04491000
         STC   RTNCODE,IOPRETRN(,IOPPTR)                           1395 04492000
*       RFY                                                        1396 04493000
*         RTNCODE UNRSTD;           /*                       @Z67SP00*/ 04494000
*       IF IOPRETRN<IOPNTFND        /* IF ALLOC OK           @Z67SP00*/ 04495000
*         THEN                      /*                       @Z67SP00*/ 04496000
         CLI   IOPRETRN(IOPPTR),4                                  1397 04497000
         BNL   @RF01397                                            1397 04498000
*         DO;                       /*                       @Z67SP00*/ 04499000
*           JFCBOPSW=ON;            /* REWRITE JFCB AT OPEN  @Z67SP00*/ 04500000
         L     @11,JFCBPTR                                         1399 04501000
         OI    JFCBOPSW(@11),B'10000000'                           1399 04502000
*           JFCNWRIT=OFF;           /* RESET NO WRITE BIT    @Z67SP00*/ 04503000
         NI    JFCNWRIT(@11),B'11110111'                           1400 04504000
*         END;                      /*                       @Z67SP00*/ 04505000
*     END;                          /* END LRF DATASET       @Z67SP00*/ 04506000
*   RETURN;                         /* RETURN TO CALLER      @Z67SP00*/ 04507000
@EL00003 DS    0H                                                  1403 04508000
@EF00003 DS    0H                                                  1403 04509000
@ER00003 LM    @14,@12,@SA00003                                    1403 04510000
         BR    @14                                                 1403 04511000
*   END JFCBMOD;                    /*                       @Z67SP00*/ 04512000
         B     @EL00003                                            1404 04513000
         EJECT                                                          04514000
*                                                                  1405 04515000
*   /*****************************************************************/ 04516000
*   /*                                                               */ 04517000
*   /* DCB EXIT ROUTINE TO FIX BLKSIZE WHEN MISSING                  */ 04518000
*   /*                                                               */ 04519000
*   /*****************************************************************/ 04520000
*                                                                  1405 04521000
*DCBEXIT:                                                          1405 04522000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);                          1405 04523000
DCBEXIT  DS    0H                                                  1406 04524000
*   DECLARE                         /*                       @Z67SP00*/ 04525000
*     WKXBLKSI CONSTANT(3200);      /*                       @Z67SP00*/ 04526000
*   RFY                                                            1407 04527000
*     RTNREG RSTD;                                                 1407 04528000
*                                                                  1407 04529000
*   /*****************************************************************/ 04530000
*   /*                                                               */ 04531000
*   /* NOW INSURE THAT BLKSIZE IS MULTIPLE OF LRECL FOR DATASETS     */ 04532000
*   /* ALLOCATED WITHOUT DCB ATTRIBUTES AND SET BLKSIZE FOR WORK     */ 04533000
*   /* FILES IF NOT ALREADY ALLOCATED                        @Z67SP00*/ 04534000
*   /*                                                               */ 04535000
*   /*****************************************************************/ 04536000
*                                                                  1408 04537000
*   IF DCBRECL^=RECFMU              /* DO NOT CHECK BLKSIZE  @Z40SP00*/ 04538000
*       &IOPDSID^=IOPLRF            /* AND LRECL IF RECFM=U  @Z67SP00*/ 04539000
*     THEN                          /* OR FOR LRF DATASET    @Z40SP00*/ 04540000
         TM    DCBRECL+28(DCBPTR),B'11000000'                      1408 04541000
         BO    @RF01408                                            1408 04542000
         CLI   IOPDSID(IOPPTR),32                                  1408 04543000
         BE    @RF01408                                            1408 04544000
*     DO;                           /* BLKSIZE NOT A MULTIPLE OF   1409 04545000
*                                      LRECL IN THIS CASE    @Z40SP02*/ 04546000
*       IF DCBBLKSI=ZERO            /* IS BLOCK SIZE SPECIFIED?      */ 04547000
*           |(DCBBLKSI//DCBLRECL)^=ZERO/* OR IF THE SYSUT1 BLKSIZE 1410 04548000
*                                      HAS BEEN PREVIOUSLY SET TO AN    04549000
*                                      UNACCEPTABLE VALUE THEN     1410 04550000
*                                                            @YA05115*/ 04551000
*         THEN                      /* NO - SET TO LRECL             */ 04552000
         SLR   @15,@15                                             1410 04553000
         LH    @11,DCBBLKSI+52(,DCBPTR)                            1410 04554000
         CR    @11,@15                                             1410 04555000
         BE    @RT01410                                            1410 04556000
         LR    @00,@11                                             1410 04557000
         SRDA  @00,32                                              1410 04558000
         LH    @11,DCBLRECL+72(,DCBPTR)                            1410 04559000
         DR    @00,@11                                             1410 04560000
         CR    @00,@15                                             1410 04561000
         BE    @RF01410                                            1410 04562000
@RT01410 DS    0H                                                  1411 04563000
*         DO;                       /*                       @Z67SP00*/ 04564000
*           IF IOPDSID=IOPWK1       /* IF WRK DATA SETS      @Z67SP00*/ 04565000
*               |IOPDSID=IOPWK2     /*                       @Z67SP00*/ 04566000
*               |IOPDSID=IOPWK3     /*                       @Z67SP00*/ 04567000
*               |IOPDSID=IOPWK4     /*                       @Z67SP00*/ 04568000
*             THEN                  /*                       @Z67SP00*/ 04569000
         CLI   IOPDSID(IOPPTR),35                                  1412 04570000
         BE    @RT01412                                            1412 04571000
         CLI   IOPDSID(IOPPTR),36                                  1412 04572000
         BE    @RT01412                                            1412 04573000
         CLI   IOPDSID(IOPPTR),37                                  1412 04574000
         BE    @RT01412                                            1412 04575000
         CLI   IOPDSID(IOPPTR),38                                  1412 04576000
         BNE   @RF01412                                            1412 04577000
@RT01412 DS    0H                                                  1413 04578000
*             DCBBLKSI=WKXBLKSI;    /* SET BLKSIZE=3200      @Z67SP00*/ 04579000
         MVC   DCBBLKSI+52(2,DCBPTR),@CH04103                      1413 04580000
*           ELSE                    /*                       @Z67SP00*/ 04581000
*             DCBBLKSI=DCBLRECL;    /* SET BLKSIZE TO LRECL          */ 04582000
         B     @RC01412                                            1414 04583000
@RF01412 MVC   DCBBLKSI+52(2,DCBPTR),DCBLRECL+72(DCBPTR)           1414 04584000
*         END;                      /*                       @Z67SP00*/ 04585000
@RC01412 DS    0H                                                  1416 04586000
*       IF IOPDSID=IOPSCR1          /* OPENING SYSUT1 SCR1 DATA SET ?   04587000
*                                                            @YA05115*/ 04588000
*         THEN                      /* YES THEN INSURE THAT  @YA05115*/ 04589000
@RF01410 CLI   IOPDSID(IOPPTR),3                                   1416 04590000
         BNE   @RF01416                                            1416 04591000
*         DCBKEYLE=ZERO;            /* KEYLEN IS RESET TO 0 FROM ANY    04592000
*                                      PREVIOUS USES         @YA05115*/ 04593000
         MVI   DCBKEYLE+16(DCBPTR),X'00'                           1417 04594000
*     END;                                                         1418 04595000
*   RFY                                                            1419 04596000
*     RTNREG UNRSTD;                                               1419 04597000
*   END DCBEXIT;                                                   1420 04598000
@EL00004 DS    0H                                                  1420 04599000
@EF00004 DS    0H                                                  1420 04600000
@ER00004 BR    @14                                                 1420 04601000
         EJECT                                                          04602000
*READ:                                                             1421 04603000
*   PROCEDURE OPTIONS(SAVEAREA);    /* READ SUBROUTINE               */ 04604000
*                                                                  1421 04605000
READ     STM   @14,@12,12(@13)                                     1421 04606000
         ST    @13,@SA00005+4                                      1421 04607000
         LA    @14,@SA00005                                        1421 04608000
         ST    @14,8(,@13)                                         1421 04609000
         LR    @13,@14                                             1421 04610000
*   /*****************************************************************/ 04611000
*   /*                                                               */ 04612000
*   /* THIS ROUTINE IS INVOKED TO PERFORM BSAM READS. THE DCB ADDR IS*/ 04613000
*   /* OBTAINED FROM DCBPTR, THE AREA ADDRESS IS OBTAINED FROM       */ 04614000
*   /* IOPBUFAD. THE RECORD LENGTH IS TAKEN FROM THE SPECIFIED DCB.  */ 04615000
*   /*                                                               */ 04616000
*   /*****************************************************************/ 04617000
*                                                                  1422 04618000
*   IOPRETRN=IOPGOOD;               /* INDICATE GOOD RETURN          */ 04619000
         MVI   IOPRETRN(IOPPTR),X'00'                              1422 04620000
*   DCBEODA=ADDR(READEOF);          /* SET EODAD ADDR IN DCB         */ 04621000
         LA    @11,READEOF                                         1423 04622000
         STCM  @11,7,DCBEODA+28(DCBPTR)                            1423 04623000
*   RFY                                                            1424 04624000
*     IOPREG RSTD;                  /* REMOVE REG FROM USE   @Z40SP00*/ 04625000
*   IOPREG=IOPBUFAD;                /* GET IOP BUFFER ADDR TO REG    */ 04626000
         L     IOPREG,IOPBUFAD(,IOPPTR)                            1425 04627000
*   GENERATE CODE FLOWS(READEOF,BSAMERR) REFS(DCBPTR,IOPREG,IODECB);    04628000
*                                         /*                 @ZD00003*/ 04629000
         READ  IODECB,SF,(DCBPTR),(IOPREG),'S',MF=E READ RECORD         04630000
         CHECK IODECB                                                   04631000
*   RFY                                                            1427 04632000
*     IOPREG UNRSTD;                /* RETURN REG TO USE     @Z40SP00*/ 04633000
*   RETURN;                         /* EXIT                          */ 04634000
@EL00005 L     @13,4(,@13)                                         1428 04635000
@EF00005 DS    0H                                                  1428 04636000
@ER00005 LM    @14,@12,12(@13)                                     1428 04637000
         BR    @14                                                 1428 04638000
*READEOF:                                                          1429 04639000
*   IOPRETRN=IOPEOF;                /* INDICATE END OF FILE FOUND    */ 04640000
READEOF  MVI   IOPRETRN(IOPPTR),X'04'                              1429 04641000
*   END READ;                       /* EXIT TO REQUESTOR             */ 04642000
         B     @EL00005                                            1430 04643000
         EJECT                                                          04644000
*WRITE:                                                            1431 04645000
*   PROCEDURE OPTIONS(NOSAVEAREA);  /*                       @Z40SP00*/ 04646000
*                                                                  1431 04647000
WRITE    STM   @14,@12,12(@13)                                     1431 04648000
*   /*****************************************************************/ 04649000
*   /*                                                               */ 04650000
*   /* THIS ROUTINE IS INVOKED TO PERFORM BSAM WRITES - SINCE THIS   */ 04651000
*   /* ROUTINE CAN BE RE-ENTERED DUE TO MULTIPLE I/O ERROR THE SAVE  */ 04652000
*   /* AREA AND CHAINING MUST BE HANDLED SIMILIAR TO THAT AT THE MAIN*/ 04653000
*   /* ENTRY FOR HMASMIO. AFTER ENTRY CODE IS SET UP THE DCB ADDRESS */ 04654000
*   /* IS OBTAINED FROM DCBPTR, AND THE I/O AREA IS GOTTON FROM      */ 04655000
*   /* IOPBUFAD                                              @Z40SP00*/ 04656000
*   /*                                                               */ 04657000
*   /*****************************************************************/ 04658000
*                                                                  1432 04659000
*   WTENTCNT=WTENTCNT+1;            /* INCR RE-ENTRY COUNT   @Z40SP00*/ 04660000
         SLR   @11,@11                                             1432 04661000
         IC    @11,WTENTCNT                                        1432 04662000
         LA    @11,1(,@11)                                         1432 04663000
         STC   @11,WTENTCNT                                        1432 04664000
*   IF WTENTCNT>DIM(WTSVAREA)       /* IF GREATER THEN CODE  @ZA12350*/ 04665000
*     THEN                          /* ALLOWS THEN CANT DO   @Z40SP00*/ 04666000
         CLI   WTENTCNT,6                                          1433 04667000
         BNH   @RF01433                                            1433 04668000
*     DO;                           /* WRITE                 @Z40SP00*/ 04669000
*       WTENTCNT=WTENTCNT-1;        /* DECR ENTRY COUNT      @Z40SP00*/ 04670000
         BCTR  @11,0                                               1435 04671000
         STC   @11,WTENTCNT                                        1435 04672000
*       IOPRETRN=IOPIOERR;          /* SET I/O ERR RTN       @Z40SP00*/ 04673000
         MVI   IOPRETRN(IOPPTR),X'10'                              1436 04674000
*       RETURN;                     /* AND RETURN TO CALLER  @Z40SP00*/ 04675000
@EL00006 DS    0H                                                  1437 04676000
@EF00006 DS    0H                                                  1437 04677000
@ER00006 LM    @14,@12,12(@13)                                     1437 04678000
         BR    @14                                                 1437 04679000
*     END;                          /*                       @Z40SP00*/ 04680000
*   RFY                                                            1439 04681000
*     R1 RSTD;                      /*                       @ZA12350*/ 04682000
@RF01433 DS    0H                                                  1440 04683000
*   R1=ADDR(WTSVAREA(WTENTCNT));    /* SET ADDR TO PROPER SAVE AREA     04684000
*                                      DECLARED IN IO        @ZA12350*/ 04685000
         SLR   @11,@11                                             1440 04686000
         IC    @11,WTENTCNT                                        1440 04687000
         MH    @11,@CH00833                                        1440 04688000
         L     R1,ADWTSAVE                                         1440 04689000
         AL    R1,@CF04235                                         1440 04690000
         LA    R1,WTSVAREA(@11,R1)                                 1440 04691000
*   RFY                                                            1441 04692000
*     SVAREAS BASED(R1);            /*                       @Z40SP00*/ 04693000
*   SVBACK=R13;                     /* ST 13,SAVE+4          @Z40SP00*/ 04694000
         ST    R13,SVBACK(,R1)                                     1442 04695000
*   RFY                                                            1443 04696000
*     SVAREAS BASED(R13);           /*                       @Z40SP00*/ 04697000
*   SVFWRD=R1;                      /* ST R1,8(R13)          @Z40SP00*/ 04698000
         ST    R1,SVFWRD(,R13)                                     1444 04699000
*   R13=R1;                         /* SET PTR TO NEW SAVE AREA      */ 04700000
         LR    R13,R1                                              1445 04701000
*   RFY                                                            1446 04702000
*     R1 UNRSTD;                    /*                       @Z40SP00*/ 04703000
*                                                                  1446 04704000
*   /*****************************************************************/ 04705000
*   /*                                                               */ 04706000
*   /* SAVE AREA GOTTEN AND CHAINED TOGETHER NOW DO WRITE    @Z40SP00*/ 04707000
*   /*                                                               */ 04708000
*   /*****************************************************************/ 04709000
*                                                                  1447 04710000
*   RFY                                                            1447 04711000
*    (LENREG,                                                      1447 04712000
*     IOPREG) RSTD;                 /* REMOVE REG FROM USE   @Z40SP00*/ 04713000
*   IOPREG=IOPBUFAD;                /* GET IOP BUFFER ADDR TO REG    */ 04714000
         L     @11,IOPBUFAD(,IOPPTR)                               1448 04715000
         LR    IOPREG,@11                                          1448 04716000
*   IF IOPDSID=IOPHLDS              /* IS THIS HISTORY LOG WRITE?    */ 04717000
*     THEN                          /* YES - SET LENGTH OF RECORD    */ 04718000
         CLI   IOPDSID(IOPPTR),1                                   1449 04719000
         BNE   @RF01449                                            1449 04720000
*     LENREG=PRLRLEN;               /* FROM PRL LENGTH               */ 04721000
         LH    LENREG,PRLRLEN(,@11)                                1450 04722000
*   ELSE                            /* OTHERWISE - SET TO ZERO       */ 04723000
*     LENREG=ZERO;                  /* SET ZERO LENGTH - UNUSED      */ 04724000
         B     @RC01449                                            1451 04725000
@RF01449 SLR   LENREG,LENREG                                       1451 04726000
*   GENERATE CODE FLOWS(BSAMERR,BPAMERR) REFS(DCBPTR,IOPREG,LENREG,     04727000
*       IODECB);                                                   1452 04728000
@RC01449 DS    0H                                                  1452 04729000
*                                                /*          @ZD00003*/ 04730000
         WRITE IODECB,SF,(DCBPTR),(IOPREG),(LENREG),MF=E WRITE RECORD   04731000
         CHECK IODECB                 WAIT FOR COMPLETION OF I/O        04732000
*   RFY                                                            1453 04733000
*    (LENREG,                                                      1453 04734000
*     IOPREG) UNRSTD;               /* RETURN REGS FOR USE   @Z40SP00*/ 04735000
*                                                                  1453 04736000
*   /*****************************************************************/ 04737000
*   /*                                                               */ 04738000
*   /* MUST NOW RESET SAVE AREA CHAIN                        @ZA12350*/ 04739000
*   /*                                                               */ 04740000
*   /*****************************************************************/ 04741000
*                                                                  1454 04742000
*   RFY                                                            1454 04743000
*     SVAREAS BASED(R13);           /*                       @Z40SP00*/ 04744000
*   R13=SVBACK;                     /* ADDR OF OLD SAVE AREA @Z40SP00*/ 04745000
         L     R13,SVBACK(,R13)                                    1455 04746000
*   WTENTCNT=WTENTCNT-1;            /* DECR ENTRY COUNT      @Z40SP00*/ 04747000
         SLR   @11,@11                                             1456 04748000
         IC    @11,WTENTCNT                                        1456 04749000
         BCTR  @11,0                                               1456 04750000
         STC   @11,WTENTCNT                                        1456 04751000
*   END WRITE;                      /* EXIT TO REQUESTOR             */ 04752000
         B     @EL00006                                            1457 04753000
         EJECT                                                          04754000
*POINT:                                                            1458 04755000
*   PROCEDURE OPTIONS(SAVEAREA);                                   1458 04756000
*                                                                  1458 04757000
POINT    STM   @14,@12,12(@13)                                     1458 04758000
         ST    @13,@SA00007+4                                      1458 04759000
         LA    @14,@SA00007                                        1458 04760000
         ST    @14,8(,@13)                                         1458 04761000
         LR    @13,@14                                             1458 04762000
*   /*****************************************************************/ 04763000
*   /*                                                               */ 04764000
*   /* THIS ROUTINE IS INVOKED TO PERFORM POINT OPERATIONS. THE TTR  */ 04765000
*   /* IS OBTAINED FROM IOPTTR AND THE DCB ADDRESS IS GOTTEN FROM    */ 04766000
*   /* DCBPTR.                                                       */ 04767000
*   /*                                                               */ 04768000
*   /*****************************************************************/ 04769000
*                                                                  1459 04770000
*   DECLARE                         /*                       @Z40SP00*/ 04771000
*     1 POINTTTR CHAR(4) BDY(WORD), /* TTR FOR POINT MACRO   @Z40SP00*/ 04772000
*      2 PTTR13 CHAR(3),            /* THREE BYTE TTR        @Z40SP00*/ 04773000
*      2 PTTR4 FIXED(8) INIT(0);    /* MUST BE ZERO          @Z40SP00*/ 04774000
*   IOPRETRN=IOPGOOD;               /* SET RETURN CODE       @Z40SP00*/ 04775000
         MVI   IOPRETRN(IOPPTR),X'00'                              1460 04776000
*   PTTR13=IOPTTR;                  /* MOVE TTR TO PARM AREA @Z40SP00*/ 04777000
         MVC   PTTR13(3),IOPTTR(IOPPTR)                            1461 04778000
*   PTTR4=ZERO;                     /* LAST BYTE MUST BE 0   @Z40SP00*/ 04779000
         MVI   PTTR4,X'00'                                         1462 04780000
*   GENERATE REFS(DCBPTR,POINTTTR);                                1463 04781000
         POINT (DCBPTR),POINTTTR       POINT TO MEMBER       @Z40SP00   04782000
*   END POINT;                      /*                       @Z40SP00*/ 04783000
@EL00007 L     @13,4(,@13)                                         1464 04784000
@EF00007 DS    0H                                                  1464 04785000
@ER00007 LM    @14,@12,12(@13)                                     1464 04786000
         BR    @14                                                 1464 04787000
         EJECT                                                          04788000
*NOTE:                                                             1465 04789000
*   PROCEDURE(NOTETTR) OPTIONS(SAVEAREA);                          1465 04790000
*                                                                  1465 04791000
NOTE     STM   @14,@12,12(@13)                                     1465 04792000
         ST    @13,@SA00008+4                                      1465 04793000
         LA    @14,@SA00008                                        1465 04794000
         ST    @14,8(,@13)                                         1465 04795000
         LR    @13,@14                                             1465 04796000
         MVC   @PC00008(4),0(@01)                                  1465 04797000
*   /*****************************************************************/ 04798000
*   /*                                                               */ 04799000
*   /* THIS ROUTINE IS INVOKED TO PERFORM THE NOTE OPERATION. THE DCB*/ 04800000
*   /* ADDRESS IS OBTAINED FROM DCBPTR AND THE TTR IS RETURNED IN THE*/ 04801000
*   /* IOPTTR FIELD.                                                 */ 04802000
*   /*                                                               */ 04803000
*   /*****************************************************************/ 04804000
*                                                                  1466 04805000
*   DECLARE                                                        1466 04806000
*     NOTETTR PTR(24);              /* TTR FOR NOTES                 */ 04807000
*   IOPRETRN=IOPGOOD;               /* INDICATE GOOD RETURN  @YA07506*/ 04808000
         MVI   IOPRETRN(IOPPTR),X'00'                              1467 04809000
*   GENERATE REFS(DCBPTR);                                         1468 04810000
         NOTE  (DCBPTR)             NOTE THE DCB                        04811000
*   RFY                                                            1469 04812000
*     R1 RSTD;                                                     1469 04813000
*   TEMPTTR=R1;                     /* PUT TTR IN TEMP AREA          */ 04814000
         ST    R1,TEMPTTR                                          1470 04815000
*   RFY                                                            1471 04816000
*     R1 UNRSTD;                                                   1471 04817000
*   NOTETTR=TEMPTTR(1:3);           /* PUT THE TTR IN THE PARM LIST  */ 04818000
         L     @11,@PC00008                                        1472 04819000
         MVC   NOTETTR(3,@11),TEMPTTR                              1472 04820000
*   END NOTE;                       /* EXIT TO REQUESTOR             */ 04821000
@EL00008 L     @13,4(,@13)                                         1473 04822000
@EF00008 DS    0H                                                  1473 04823000
@ER00008 LM    @14,@12,12(@13)                                     1473 04824000
         BR    @14                                                 1473 04825000
         EJECT                                                          04826000
*STOW:                                                             1474 04827000
*   PROCEDURE OPTIONS(SAVEAREA);                                   1474 04828000
*                                                                  1474 04829000
STOW     STM   @14,@12,12(@13)                                     1474 04830000
         ST    @13,@SA00009+4                                      1474 04831000
         LA    @14,@SA00009                                        1474 04832000
         ST    @14,8(,@13)                                         1474 04833000
         LR    @13,@14                                             1474 04834000
*   /*****************************************************************/ 04835000
*   /*                                                               */ 04836000
*   /* THIS ROUTINE IS INVOKED TO STOW MEMBERS INTO A PDS. THE DCB   */ 04837000
*   /* ADDRESS IS OBTAINED FROM DCBPTR, AND THE STOW PARM LIST IS    */ 04838000
*   /* CONTAINED WITHIN THE IOP. IF THE OPERATION IS STOW DELETE OR  */ 04839000
*   /* STOW REPLACE, THEN NO CHANGE NEED BE MADE TO THE IOP. FOR STOW*/ 04840000
*   /* CHANGE, THE USER DATA FIELD CONTAINS THE NAMES TO BE SWAPPED  */ 04841000
*   /* IN THE DIRECTORY.                                             */ 04842000
*   /*                                                               */ 04843000
*   /*****************************************************************/ 04844000
*                                                                  1475 04845000
*   DECLARE                         /*                       @ZD00008*/ 04846000
*     IOPPTR2 PTR(31);              /* PTR TO ALT IOP        @ZD00008*/ 04847000
*   DECLARE                         /*                       @ZD00008*/ 04848000
*     1 STOWCPRM,                   /* STOW CHANGE PARM      @ZD00008*/ 04849000
*       3 STOWONAM CHAR(8),         /* OLD NAME              @ZD00008*/ 04850000
*       3 STOWNNAM CHAR(8);         /* NEW NAME              @ZD00008*/ 04851000
*   DECLARE                         /*                       @ZD00003*/ 04852000
*     SAVONAME CHAR(8);             /* FOR SAVING NAMES      @ZD00003*/ 04853000
*   DECLARE                         /* ACROSS CALLS          @ZD00003*/ 04854000
*     SAVNNAME CHAR(8);             /* TO EIS FOR STOWC      @ZD00003*/ 04855000
*   DECLARE                         /*                       @ZA17736*/ 04856000
*     RELADSV CHAR(3);              /* DCBRELAD SAVE         @ZA17736*/ 04857000
*   DECLARE                         /*                       @ZA17736*/ 04858000
*     1 OFLGSSV CHAR(1),            /* DCBOFLGS SAVE FOR STOW      1480 04859000
*                                                            @ZA17736*/ 04860000
*       3 OFLWRSV BIT(1),           /* ON IF LAST IO WRITE   @ZA17736*/ 04861000
*       3 * BIT(7);                 /*                       @ZA17736*/ 04862000
*   DECLARE                         /* FOR PROPER SAVING OF  @ZA17736*/ 04863000
*     SAVMASK BIT(8) CONSTANT('80'X);/* DCBOFLWR             @ZA17736*/ 04864000
*   RFY                                                            1482 04865000
*     IOPREG RSTD;                  /* REMOVE REG FROM USE   @Z40SP00*/ 04866000
*   IOPREG=ADDR(IOPINAM);           /*                       @ZD00008*/ 04867000
         LA    IOPREG,IOPINAM(,IOPPTR)                             1483 04868000
*   IOPRETRN=IOPGOOD;               /* INIT RETURN CODE      @ZD00003*/ 04869000
*                                                                  1484 04870000
         MVI   IOPRETRN(IOPPTR),X'00'                              1484 04871000
*   /*****************************************************************/ 04872000
*   /*                                                               */ 04873000
*   /* OPERATION IS STOW REPLACE(ADD) OR STOW OF DIRECTORY INFO ONLY */ 04874000
*   /*                                                       @Z40SP00*/ 04875000
*   /*                                                               */ 04876000
*   /*****************************************************************/ 04877000
*                                                                  1485 04878000
*   IF(IOPFUNCT=IOPSTOWR            /* IS THIS STOW (REPLACE)?       */ 04879000
*       |IOPFUNCT=IOPUDEO)          /* OR IS IT UPDATE DIRECT ONLY   */ 04880000
*       &DISOSW=OFF                 /* AND DIRECTORY NOT INSTORAGE 1485 04881000
*                                      FOR UPDATE            @Z67SP00*/ 04882000
*     THEN                          /* YES - PERFORM THE OPERATION   */ 04883000
         CLI   IOPFUNCT(IOPPTR),84                                 1485 04884000
         BE    @GL00117                                            1485 04885000
         CLI   IOPFUNCT(IOPPTR),86                                 1485 04886000
         BNE   @RF01485                                            1485 04887000
@GL00117 TM    DISOSW,B'00001000'                                  1485 04888000
         BNZ   @RF01485                                            1485 04889000
*     DO;                                                          1486 04890000
*       IF IOPFUNCT=IOPUDEO         /* DIRECTORY ONLY UPDATE @ZA17736*/ 04891000
*         THEN                      /* YES                   @ZA17736*/ 04892000
         CLI   IOPFUNCT(IOPPTR),86                                 1487 04893000
         BNE   @RF01487                                            1487 04894000
*         DO;                       /*                       @ZA17736*/ 04895000
*           RELADSV=DCBRELAD(1:3);  /* SAVE ACROSS STOW      @ZA17736*/ 04896000
         MVC   RELADSV(3),DCBRELAD(DCBPTR)                         1489 04897000
*           DCBRELAD(1:3)=IOPTTR;   /* PUT TTR FROM IOP INTO DCB SO     04898000
*                                      THAT STOW WILL USE IT @ZA17736*/ 04899000
         MVC   DCBRELAD(3,DCBPTR),IOPTTR(IOPPTR)                   1490 04900000
*           OFLGSSV=DCBOFLGS;       /* SAVE FLAGS ACROSS STOW@ZA17736*/ 04901000
         LA    @11,40                                              1491 04902000
         ALR   @11,DCBPTR                                          1491 04903000
         MVC   OFLGSSV(1),DCBOFLGS(@11)                            1491 04904000
*           DCBOFLWR=OFF;           /* SET BIT TO ZERO       @ZA17736*/ 04905000
         NI    DCBOFLWR(@11),B'01111111'                           1492 04906000
*           OFLGSSV=OFLGSSV&SAVMASK;/* SAVE ONLY DCBOFLWR    @ZA17736*/ 04907000
         NI    OFLGSSV,X'80'                                       1493 04908000
*         END;                      /* END DIRECT ONLY UPDAT @Z40SP00*/ 04909000
*       GENERATE REFS(DCBPTR,IOPREG);                              1495 04910000
@RF01487 DS    0H                                                  1495 04911000
        STOW  (DCBPTR),(IOPREG),R    STOW THE UPDATED MEMBER            04912000
*       RFY                                                        1496 04913000
*         RTNCODE RSTD;                                            1496 04914000
*       IOPRETRN=RTNCODE;           /* PUT RETURN CODE IN THE IOP    */ 04915000
         STC   RTNCODE,IOPRETRN(,IOPPTR)                           1497 04916000
*       RFY                                                        1498 04917000
*         RTNCODE UNRSTD;                                          1498 04918000
*       IF IOPFUNCT=IOPUDEO         /* DIRECTORY ONLY UPDATE @ZA17736*/ 04919000
*         THEN                      /* RESET TTR AND FLAGS   @ZA17736*/ 04920000
         CLI   IOPFUNCT(IOPPTR),86                                 1499 04921000
         BNE   @RF01499                                            1499 04922000
*         DO;                       /*                       @ZA17736*/ 04923000
*           DCBRELAD(1:3)=RELADSV;  /* RESET RELAD           @ZA17736*/ 04924000
         MVC   DCBRELAD(3,DCBPTR),RELADSV                          1501 04925000
*           DCBOFLGS=DCBOFLGS|OFLGSSV;/* RESTORE FLAGS       @ZA17736*/ 04926000
         OC    DCBOFLGS+40(1,DCBPTR),OFLGSSV                       1502 04927000
*         END;                      /* END DIRECT ONLY UPDAT @ZA17736*/ 04928000
*       IF IOPRETRN<IOPDIRFL        /* IS RETURN CODE OK??   @Z40SP00*/ 04929000
*         THEN                      /* YES - SET RTN CODE TO ZERO    */ 04930000
@RF01499 CLI   IOPRETRN(IOPPTR),12                                 1504 04931000
         BNL   @RF01504                                            1504 04932000
*         DO;                       /*                       @Z40SP00*/ 04933000
*           IOPRETRN=IOPGOOD;       /* INDICATE GOOD RETURN          */ 04934000
         MVI   IOPRETRN(IOPPTR),X'00'                              1506 04935000
*           MGPPRINT=OFF;           /* NOT TO PRINTER        @Z40SP00*/ 04936000
         NI    MGPPRINT,B'01111111'                                1507 04937000
*           MGPTYPE=MGPINFO;        /* SET MESSAGE SEVERITY  @ZD00001*/ 04938000
         MVI   MGPTYPE,X'01'                                       1508 04939000
*           MGPMGNO1=HMA218I;       /* SUCCESSFULLY STORED   @Z40SP00*/ 04940000
         MVC   MGPMGNO1(2),@CH00450                                1509 04941000
*         END;                                                     1510 04942000
*       ELSE                        /* STOW RTN NOT GOOD     @YA07506*/ 04943000
*         IF IOPRETRN=IOPDIRFL      /* DIRECTORY FULL?       @Z40SP00*/ 04944000
*           THEN                    /* YES - INDICATE IN MESSAGE     */ 04945000
         B     @RC01504                                            1511 04946000
@RF01504 CLI   IOPRETRN(IOPPTR),12                                 1511 04947000
         BNE   @RF01511                                            1511 04948000
*           DO;                     /*                       @ZD00001*/ 04949000
*             MGPTYPE=MGPSEV;       /* SET MESSAGE SEVERITY  @ZD00001*/ 04950000
         MVI   MGPTYPE,X'04'                                       1513 04951000
*             MGPMGNO1=HMA267I;     /* DIRECTORY EXCEEDED    @Z40SP00*/ 04952000
         MVC   MGPMGNO1(2),@CH01031                                1514 04953000
*           END;                    /*                       @ZD00001*/ 04954000
*         ELSE                      /* ELSE MUST BE I/O ERROR        */ 04955000
*           DO;                     /*                       @YA07506*/ 04956000
         B     @RC01511                                            1516 04957000
@RF01511 DS    0H                                                  1517 04958000
*             MGPTYPE=MGPTERM;      /* SET MESSAGE SEVERITY  @ZD00001*/ 04959000
         MVI   MGPTYPE,X'05'                                       1517 04960000
*             MGPMGNO1=HMA268I;     /* I/O ERR ATTEMPTING TO STORE   */ 04961000
         MVC   MGPMGNO1(2),@CH01033                                1518 04962000
*             IOPRETRN=IOPIOERR;    /* SET TO HIGEST SMP RTN @YA07506*/ 04963000
         MVI   IOPRETRN(IOPPTR),X'10'                              1519 04964000
*           END;                    /*                       @YA07506*/ 04965000
*     END;                                                         1521 04966000
@RC01511 DS    0H                                                  1521 04967000
@RC01504 DS    0H                                                  1522 04968000
         EJECT                                                          04969000
*                                                                  1522 04970000
*   /*****************************************************************/ 04971000
*   /*                                                               */ 04972000
*   /* OPERATION IS STOW DELETE                              @Z40SP00*/ 04973000
*   /*                                                               */ 04974000
*   /*****************************************************************/ 04975000
*                                                                  1522 04976000
*   IF IOPFUNCT=IOPSTOWD            /* IS IT A STOW DELETE FUNCTION  */ 04977000
*       &DISOSW=OFF                 /* AND DIRECTORY NOT INSTORAGE 1522 04978000
*                                      FOR UPDATE            @Z67SP00*/ 04979000
*     THEN                          /* YES - DELETE THE ENTRY        */ 04980000
@RF01485 CLI   IOPFUNCT(IOPPTR),83                                 1522 04981000
         BNE   @RF01522                                            1522 04982000
         TM    DISOSW,B'00001000'                                  1522 04983000
         BNZ   @RF01522                                            1522 04984000
*     DO;                                                          1523 04985000
*       GENERATE REFS(DCBPTR,IOPREG);                              1524 04986000
         STOW   (DCBPTR),(IOPREG),D   DELETE THE CDS ENTRY              04987000
*       RFY                                                        1525 04988000
*         RTNCODE RSTD;                                            1525 04989000
*       IOPRETRN=RTNCODE;           /* SAVE STOW RETURN CODE @ZD00001*/ 04990000
         STC   RTNCODE,IOPRETRN(,IOPPTR)                           1526 04991000
*       RFY                                                        1527 04992000
*         RTNCODE UNRSTD;           /*                       @ZD00001*/ 04993000
*       IF IOPRETRN<IOPDIRFL        /* RETURN CODE OK??      @ZD00001*/ 04994000
*         THEN                      /* YES - MAKE IT REAL GOOD       */ 04995000
         CLI   IOPRETRN(IOPPTR),12                                 1528 04996000
         BNL   @RF01528                                            1528 04997000
*         DO;                       /* INDICATE IN MESSAGE..OK       */ 04998000
*           IOPRETRN=IOPGOOD;       /* RETURN GOOD CODE      @Z40SP00*/ 04999000
         MVI   IOPRETRN(IOPPTR),X'00'                              1530 05000000
*           MGPPRINT=OFF;           /* NOT TO PRINTER        @Z40SP00*/ 05001000
         NI    MGPPRINT,B'01111111'                                1531 05002000
*           MGPTYPE=MGPINFO;        /* SET MESSAGE SEVERITY  @ZD00001*/ 05003000
         MVI   MGPTYPE,X'01'                                       1532 05004000
*           MGPMGNO1=HMA224I;       /* SUCCESSFULLY DELETED  @Z40SP00*/ 05005000
         MVC   MGPMGNO1(2),@CH00461                                1533 05006000
*         END;                                                     1534 05007000
*       ELSE                        /* OTHERWISE , INDICATE ERROR    */ 05008000
*         DO;                                                      1535 05009000
         B     @RC01528                                            1535 05010000
@RF01528 DS    0H                                                  1536 05011000
*           IOPRETRN=IOPIOERR;      /* RETURN I/O ERR RTN CDE@YA07506*/ 05012000
         MVI   IOPRETRN(IOPPTR),X'10'                              1536 05013000
*           MGPTYPE=MGPTERM;        /* SET MESSAGE SEVERITY  @ZD00001*/ 05014000
         MVI   MGPTYPE,X'05'                                       1537 05015000
*           MGPMGNO1=HMA268I;       /* I/O ERROR ATTEMPTING TO STORE */ 05016000
         MVC   MGPMGNO1(2),@CH01033                                1538 05017000
*         END;                                                     1539 05018000
*     END;                                                         1540 05019000
@RC01528 DS    0H                                                  1541 05020000
*   RFY                                                            1541 05021000
*     IOPREG UNRSTD;                /* RETURN REG TO USE     @Z40SP00*/ 05022000
@RF01522 DS    0H                                                  1542 05023000
         EJECT                                                          05024000
*                                                                  1542 05025000
*   /*****************************************************************/ 05026000
*   /*                                                               */ 05027000
*   /* THE OPERATION MUST BE STOW CHANGE - USER DATA CONTAINS NAMES  */ 05028000
*   /*                                                               */ 05029000
*   /*****************************************************************/ 05030000
*                                                                  1542 05031000
*   IF IOPFUNCT=IOPSTOWC            /* IF STOW CHANGE        @ZD00003*/ 05032000
*     THEN                          /*                       @ZD00003*/ 05033000
         CLI   IOPFUNCT(IOPPTR),82                                 1542 05034000
         BNE   @RF01542                                            1542 05035000
*     DO;                           /*                       @ZD00003*/ 05036000
*       IOPPTR2=ADDR(IOIOP);        /* IOP TO BE PASSED      @ZD00008*/ 05037000
         LA    @11,IOIOP                                           1544 05038000
         ST    @11,IOPPTR2                                         1544 05039000
*       RFY                                                        1545 05040000
*         HMASMIOP BASED(IOPPTR2);  /*                       @ZD00008*/ 05041000
*       IOPFUNCT=IOPNCODE;          /* SET FUNCT TO CAUSE ION TO   1546 05042000
*                                      CONVERT NAME          @Z67SP00*/ 05043000
         MVI   IOPFUNCT(@11),X'10'                                 1546 05044000
*       IOPDSID=IOPPTR->IOPDSID;    /* DATA SET PASSED       @ZD00008*/ 05045000
         MVC   IOPDSID(1,@11),IOPDSID(IOPPTR)                      1547 05046000
*       IOPNAME=IOPPTR->IOPONAME;   /* OLD NAME              @ZD00008*/ 05047000
         MVC   IOPNAME(8,@11),IOPONAME(IOPPTR)                     1548 05048000
*       IOPTYPE=IOPPTR->IOPOTYPE;   /* OLD TYPE              @ZD00008*/ 05049000
         MVC   IOPTYPE(1,@11),IOPOTYPE(IOPPTR)                     1549 05050000
*       CALL HMASMION(HMASMIOP);    /* CONVERT NAME          @ZD00008*/ 05051000
         ST    @11,@AL00001                                        1550 05052000
         L     @15,@CV03344                                        1550 05053000
         LA    @01,@AL00001                                        1550 05054000
         BALR  @14,@15                                             1550 05055000
*       STOWONAM=IOPINAM;           /* MOVE NAME TO STOW LST @ZD00008*/ 05056000
         L     @11,IOPPTR2                                         1551 05057000
         MVC   STOWONAM(8),IOPINAM(@11)                            1551 05058000
*       IOPNAME=IOPPTR->IOPNNAME;   /* NEW NAME              @ZD00008*/ 05059000
         MVC   IOPNAME(8,@11),IOPNNAME(IOPPTR)                     1552 05060000
*       IOPTYPE=IOPPTR->IOPNTYPE;   /* NEW TYPE              @ZD00008*/ 05061000
         MVC   IOPTYPE(1,@11),IOPNTYPE(IOPPTR)                     1553 05062000
*       CALL HMASMION(HMASMIOP);    /* CONVERT NAME          @ZD00008*/ 05063000
         ST    @11,@AL00001                                        1554 05064000
         L     @15,@CV03344                                        1554 05065000
         LA    @01,@AL00001                                        1554 05066000
         BALR  @14,@15                                             1554 05067000
*       STOWNNAM=IOPINAM;           /* MOVE NAME TO STOW LST @ZD00008*/ 05068000
         L     @11,IOPPTR2                                         1555 05069000
         MVC   STOWNNAM(8),IOPINAM(@11)                            1555 05070000
*       RFY                                                        1556 05071000
*         HMASMIOP BASED(IOPPTR);   /*                       @ZD00008*/ 05072000
*       IF DISOSW=OFF               /* IF DIRECTORY NOT INSTORAGE    */ 05073000
*         THEN                      /* FOR UPDATE            @Z67SP00*/ 05074000
         TM    DISOSW,B'00001000'                                  1557 05075000
         BNZ   @RF01557                                            1557 05076000
*         DO;                       /*                       @Z67SP00*/ 05077000
*           RFY                                                    1559 05078000
*             IOPREG RSTD;          /* REMOVE REG FROM USE   @Z40SP00*/ 05079000
*           IOPREG=ADDR(STOWCPRM);  /* POINT STOW LIST       @ZD00008*/ 05080000
         LA    IOPREG,STOWCPRM                                     1560 05081000
*           GENERATE REFS(DCBPTR,IOPREG);                          1561 05082000
         STOW  (DCBPTR),(IOPREG),C CHANGE THE ENTRY NAME                05083000
*           RFY                                                    1562 05084000
*             RTNCODE RSTD;                                        1562 05085000
*           IOPRETRN=RTNCODE;       /* SAVE RETURN CODE      @Z40SP00*/ 05086000
         STC   RTNCODE,IOPRETRN(,IOPPTR)                           1563 05087000
*           RFY                                                    1564 05088000
*            (RTNCODE,                                             1564 05089000
*             IOPREG) UNRSTD;       /* RETURN REGS FOR USE   @Z40SP00*/ 05090000
*           IF IOPRETRN=IOPGOOD     /* IF STOW OK            @SA76001*/ 05091000
*             THEN                  /*                       @SA76001*/ 05092000
         CLI   IOPRETRN(IOPPTR),0                                  1565 05093000
         BNE   @RF01565                                            1565 05094000
*             DO;                   /*                       @SA76001*/ 05095000
*               MGPPRINT=OFF;       /* NOT TO PRINTER        @SA76001*/ 05096000
         NI    MGPPRINT,B'01111111'                                1567 05097000
*               MGPTYPE=MGPINFO;    /* SET MESSAGE SEVERITY  @ZD00001*/ 05098000
         MVI   MGPTYPE,X'01'                                       1568 05099000
*               MGPMGNO1=HMA218I;   /* SUCCESSFULLY STORED   @SA76001*/ 05100000
         MVC   MGPMGNO1(2),@CH00450                                1569 05101000
*             END;                  /*                       @SA76001*/ 05102000
*           ELSE                    /* STOW NOT OK           @SA76001*/ 05103000
*             IF IOPRETRN>=IOPIOERR /* IF SEVER ERROR        @SA76001*/ 05104000
*               THEN                /*                       @SA76001*/ 05105000
         B     @RC01565                                            1571 05106000
@RF01565 CLI   IOPRETRN(IOPPTR),16                                 1571 05107000
         BL    @RF01571                                            1571 05108000
*               DO;                 /*                       @SA76001*/ 05109000
*                 MGPTYPE=MGPTERM;  /* SET MESSAGE SEVERITY  @ZD00001*/ 05110000
         MVI   MGPTYPE,X'05'                                       1573 05111000
*                 MGPMGNO1=HMA268I; /* I/O ERROR OCCURRED ATTEMPTING    05112000
*                                      TO STORE              @SA76001*/ 05113000
         MVC   MGPMGNO1(2),@CH01033                                1574 05114000
*                 IOPRETRN=IOPIOERR;/* SET RTN TO 16         @SA76001*/ 05115000
         MVI   IOPRETRN(IOPPTR),X'10'                              1575 05116000
*               END;                /*                       @SA76001*/ 05117000
*             ELSE                  /* NOT SEVERE ERROR      @SA76001*/ 05118000
*               IF IOPRETRN=IOPDIRFL/* IF DIRECTOY FULL      @SA76001*/ 05119000
*                 THEN              /*                       @SA76001*/ 05120000
         B     @RC01571                                            1577 05121000
@RF01571 CLI   IOPRETRN(IOPPTR),12                                 1577 05122000
         BNE   @RF01577                                            1577 05123000
*                 DO;               /* SET MESSAGE SEVERITY  @ZD00001*/ 05124000
*                   MGPTYPE=MGPSEV; /* SET MESSAGE SEVERITY  @ZD00001*/ 05125000
         MVI   MGPTYPE,X'04'                                       1579 05126000
*                   MGPMGNO1=HMA267I;/* DIRECTORY SPACE EXCEEDED   1580 05127000
*                                      ATTEMPTING TO STORE   @SA76001*/ 05128000
         MVC   MGPMGNO1(2),@CH01031                                1580 05129000
*                 END;              /* SET MESSAGE SEVERITY  @ZD00001*/ 05130000
*               ELSE                /* NOT DIRECT FULL       @SA76001*/ 05131000
*                 DO;               /*                       @SA76001*/ 05132000
         B     @RC01577                                            1582 05133000
@RF01577 DS    0H                                                  1583 05134000
*                   MGPTYPE=MGPERR; /* SET MESSAGE SEVERITY  @ZD00001*/ 05135000
         MVI   MGPTYPE,X'03'                                       1583 05136000
*                   MGPMGNO1=HMA214I;/* STORE FAILED FOR     @SA76001*/ 05137000
         MVC   MGPMGNO1(2),@CH00067                                1584 05138000
*                   IOPRETRN=IOPSTCRR;/* RESET RC TO 8       @SA76001*/ 05139000
         MVI   IOPRETRN(IOPPTR),X'08'                              1585 05140000
*                 END;              /*                       @SA76001*/ 05141000
*         END;                      /* END DIS NOT IN STOR.  @Z67SP00*/ 05142000
@RC01577 DS    0H                                                  1587 05143000
@RC01571 DS    0H                                                  1587 05144000
@RC01565 DS    0H                                                  1588 05145000
*     END;                          /* END STOW CHANGE       @ZD00003*/ 05146000
@RF01557 DS    0H                                                  1589 05147000
         EJECT                                                          05148000
*                                                                  1589 05149000
*   /*****************************************************************/ 05150000
*   /*                                                               */ 05151000
*   /* IF NOT JCLIN OR CONVERT THEN WRITE MESSAGE            @Z67SP00*/ 05152000
*   /*                                                               */ 05153000
*   /*****************************************************************/ 05154000
*                                                                  1589 05155000
*   IF DISOSW=OFF                   /* IF NOT DIW WRITE      @ZD00003*/ 05156000
*       |IOPRETRN^=IOPGOOD          /* OR IF ERROR           @Z67SP00*/ 05157000
*     THEN                          /*                       @ZD00003*/ 05158000
@RF01542 TM    DISOSW,B'00001000'                                  1589 05159000
         BZ    @RT01589                                            1589 05160000
         CLI   IOPRETRN(IOPPTR),0                                  1589 05161000
         BE    @RF01589                                            1589 05162000
@RT01589 DS    0H                                                  1590 05163000
*     CALL MEMMSG;                  /* WRITE MSG TO LOG      @ZD00003*/ 05164000
*                                                                  1590 05165000
         BAL   @14,MEMMSG                                          1590 05166000
*   /*****************************************************************/ 05167000
*   /*                                                               */ 05168000
*   /* IF DATASET DIRECTORY IS BEING MAINTAINED IN AN IN STORAGE FILE*/ 05169000
*   /* ALSO THEN CALL HMASMEIS TO UPDATE IN STORAGE VERSION OF       */ 05170000
*   /* DIRECTORY                                             @Z67SP00*/ 05171000
*   /*                                                               */ 05172000
*   /*****************************************************************/ 05173000
*                                                                  1591 05174000
*   IF IOPRETRN=IOPGOOD             /* IF STOW DONE OK       @ZD00003*/ 05175000
*       &DISISW=ON                  /* AND SPECIFIED DIRCT   @Z67SP00*/ 05176000
*     THEN                          /* IS IN STORAGE         @ZD00003*/ 05177000
@RF01589 CLI   IOPRETRN(IOPPTR),0                                  1591 05178000
         BNE   @RF01591                                            1591 05179000
         TM    DISISW,B'00010000'                                  1591 05180000
         BNO   @RF01591                                            1591 05181000
*     DO;                           /*                       @ZD00003*/ 05182000
*                                                                  1592 05183000
*       /*************************************************************/ 05184000
*       /*                                                           */ 05185000
*       /* IF DATASET IN STORAGE FOR OUTPUT THEN MUST CHANGE CCW     */ 05186000
*       /* CHAIN TO WRITE EOF RCD AND PRESERVE TTR AS PREVIOUSLY     */ 05187000
*       /* DETERMINED (BY DOING NOTE AFTER FIRST WRITE)      @Z67SP00*/ 05188000
*       /*                                                           */ 05189000
*       /*************************************************************/ 05190000
*                                                                  1593 05191000
*       IF DISOSW=ON                /* IF DIR IN STORAGE FOR @Z67SP00*/ 05192000
*           &IOPFUNCT=IOPSTOWR      /* AND STOW REPLACE      @Z67SP00*/ 05193000
*           &IOPALIS=OFF            /* OUTPUT AND NOT ALIAS  @Z67SP00*/ 05194000
*         THEN                      /* NO - MUST WRITE EOF   @Z67SP00*/ 05195000
         TM    DISOSW,B'00001000'                                  1593 05196000
         BNO   @RF01593                                            1593 05197000
         CLI   IOPFUNCT(IOPPTR),84                                 1593 05198000
         BNE   @RF01593                                            1593 05199000
         TM    IOPALIS(IOPPTR),B'10000000'                         1593 05200000
         BNZ   @RF01593                                            1593 05201000
*         DO;                       /*                       @Z67SP00*/ 05202000
*           TTRSV=DCBRELAD(1:3);    /* SAVE TTR IN DCB       @Z67SP00*/ 05203000
         MVC   TTRSV(3),DCBRELAD(DCBPTR)                           1595 05204000
*           DCBBLKSI=ZERO;          /* SET TO WRT 0 LEN RCD  @Z67SP00*/ 05205000
         SLR   @11,@11                                             1596 05206000
         STH   @11,DCBBLKSI+52(,DCBPTR)                            1596 05207000
*           DO M=1 TO 10;           /* LOOP THROUGH CCWS     @Z67SP00*/ 05208000
         LA    @11,1                                               1597 05209000
         ST    @11,M                                               1597 05210000
@DL01597 DS    0H                                                  1598 05211000
*             IF CCWOP(M)=WCKD      /* WRT CNT,KEY,DATA?     @Z67SP00*/ 05212000
*               THEN                /* YES - TURN OFF DATA   @Z67SP00*/ 05213000
         SLA   @11,3                                               1598 05214000
         L     @04,DCBIOBA+52(,DCBPTR)                             1598 05215000
         L     @04,IOBSTART+8(,@04)                                1598 05216000
         ST    @11,@TF00001                                        1598 05217000
         ALR   @11,@04                                             1598 05218000
         AL    @11,@CF04239                                        1598 05219000
         CLI   CCWOP(@11),X'1D'                                    1598 05220000
         BNE   @RF01598                                            1598 05221000
*               DO;                 /*                       @Z67SP00*/ 05222000
*                 CCWFLGSV=CCWFLAG(M);/* SAVE CCW FLAG       @Z67SP00*/ 05223000
         LR    @11,@04                                             1600 05224000
         AL    @11,@TF00001                                        1600 05225000
         AL    @11,@CF04250                                        1600 05226000
         MVC   CCWFLGSV(1),CCWFLAG-4(@11)                          1600 05227000
*                 CCWDATA(M)=OFF;   /* TURN OFF DATA CHN BIT @Z67SP00*/ 05228000
         AL    @04,@TF00001                                        1601 05229000
         AL    @04,@CF04250                                        1601 05230000
         NI    CCWDATA-4(@04),B'01111111'                          1601 05231000
*                 GO TO WRITZERO;   /* WRITE 0 LEN RCD       @Z67SP00*/ 05232000
         B     WRITZERO                                            1602 05233000
*               END;                /*                       @Z67SP00*/ 05234000
*           END;                    /*                       @Z67SP00*/ 05235000
@RF01598 LA    @11,1                                               1604 05236000
         AL    @11,M                                               1604 05237000
         ST    @11,M                                               1604 05238000
         CH    @11,@CH00034                                        1604 05239000
         BNH   @DL01597                                            1604 05240000
*WRITZERO:                          /*                       @Z67SP00*/ 05241000
*           CALL WRITE;             /* WRITE 0 LEN RCD       @Z67SP00*/ 05242000
WRITZERO BAL   @14,WRITE                                           1605 05243000
*           NOTESW=ON;              /* SET SW TO FORCE NOTE TO GET 1606 05244000
*                                      TTR ON NEXT OUTPUT OP @Z67SP00*/ 05245000
         L     @11,PDSADDR                                         1606 05246000
         OI    NOTESW(@11),B'01000000'                             1606 05247000
*           DCBBLKSI=DSBFRMX*PDSLRECL;/* RESET BLKSIZE       @Z67SP00*/ 05248000
         LA    @11,52                                              1607 05249000
         ALR   @11,DCBPTR                                          1607 05250000
         LH    @04,DSBFRMX                                         1607 05251000
         MH    @04,@CH00512                                        1607 05252000
         STH   @04,DCBBLKSI(,@11)                                  1607 05253000
*           CCWFLAG(M)=CCWFLGSV;    /* RESET CCW FLAG IN STR @Z67SP00*/ 05254000
         L     @04,M                                               1608 05255000
         SLA   @04,3                                               1608 05256000
         L     @11,DCBIOBA(,@11)                                   1608 05257000
         L     @11,IOBSTART+8(,@11)                                1608 05258000
         ALR   @11,@04                                             1608 05259000
         AL    @11,@CF04250                                        1608 05260000
         MVC   CCWFLAG-4(1,@11),CCWFLGSV                           1608 05261000
*           IOPTTR=TTRSV;           /* RESTORE TTR FOR THIS  @Z67SP00*/ 05262000
         MVC   IOPTTR(3,IOPPTR),TTRSV                              1609 05263000
*         END;                      /* END IS ALIAS GROUP    @Z67SP00*/ 05264000
*       IF IOPFUNCT=IOPSTOWC        /* IF STOW CHANGE        @ZD00003*/ 05265000
*         THEN                      /*                       @ZD00003*/ 05266000
@RF01593 CLI   IOPFUNCT(IOPPTR),82                                 1611 05267000
         BNE   @RF01611                                            1611 05268000
*         DO;                       /*                       @ZD00003*/ 05269000
*           SAVONAME=IOPONAME;      /* SAVE ACTUAL NAMES     @ZD00003*/ 05270000
         MVC   SAVONAME(8),IOPONAME(IOPPTR)                        1613 05271000
*           SAVNNAME=IOPNNAME;      /* ACROSS CALLS          @ZD00003*/ 05272000
         MVC   SAVNNAME(8),IOPNNAME(IOPPTR)                        1614 05273000
*           IOPONAME=STOWONAM;      /* PASS CONVERTED        @ZD00003*/ 05274000
         MVC   IOPONAME(8,IOPPTR),STOWONAM                         1615 05275000
*           IOPNNAME=STOWNNAM;      /* TO EIS                @ZD00003*/ 05276000
         MVC   IOPNNAME(8,IOPPTR),STOWNNAM                         1616 05277000
*         END;                      /*                       @ZD00003*/ 05278000
*       CALL HMASMEIS(HMASMIOP);    /* STOW TO IN-STORE DIR  @ZD00003*/ 05279000
@RF01611 ST    IOPPTR,@AL00001                                     1618 05280000
         L     @15,@CV03343                                        1618 05281000
         LA    @01,@AL00001                                        1618 05282000
         BALR  @14,@15                                             1618 05283000
*       IF IOPFUNCT=IOPSTOWC        /* IF STOW CHANGE        @ZD00003*/ 05284000
*         THEN                      /*                       @ZD00003*/ 05285000
         CLI   IOPFUNCT(IOPPTR),82                                 1619 05286000
         BNE   @RF01619                                            1619 05287000
*         DO;                       /*                       @ZD00003*/ 05288000
*           IOPONAME=SAVONAME;      /* RETURN ACTUAL NAMES   @ZD00003*/ 05289000
         MVC   IOPONAME(8,IOPPTR),SAVONAME                         1621 05290000
*           IOPNNAME=SAVNNAME;      /*                       @ZD00003*/ 05291000
         MVC   IOPNNAME(8,IOPPTR),SAVNNAME                         1622 05292000
*         END;                      /*                       @ZD00003*/ 05293000
*       IF IOPRETRN=IOPGOOD         /* IF OPERATION OK       @Z67SP00*/ 05294000
*           &CCAUPDJ=OFF            /* AND NOT JCLIN         @Z67SP00*/ 05295000
*           &DISOSW=ON              /* AND ONLY DIRECTORY    @Z67SP00*/ 05296000
*         THEN                      /* UPDATE                @Z67SP00*/ 05297000
@RF01619 CLI   IOPRETRN(IOPPTR),0                                  1624 05298000
         BNE   @RF01624                                            1624 05299000
         L     @11,@CA00038                                        1624 05300000
         TM    CCAUPDJ-HMASMCCA(@11),B'00000100'                   1624 05301000
         BNZ   @RF01624                                            1624 05302000
         TM    DISOSW,B'00001000'                                  1624 05303000
         BNO   @RF01624                                            1624 05304000
*         DO;                       /* THEN ISSUE MESSAGE    @Z67SP00*/ 05305000
*           MGPTYPE=MGPINFO;        /*                       @Z67SP00*/ 05306000
         MVI   MGPTYPE,X'01'                                       1626 05307000
*           MGPPRINT=OFF;           /* NO MSG TO SMPOUT      @Z67SP00*/ 05308000
         NI    MGPPRINT,B'01111111'                                1627 05309000
*           IF IOPFUNCT=IOPSTOWR    /*                       @Z67SP00*/ 05310000
*               |IOPFUNCT=IOPSTOWC  /*                       @Z67SP00*/ 05311000
*               |IOPFUNCT=IOPUDEO   /*                       @Z67SP00*/ 05312000
*             THEN                  /*                       @Z67SP00*/ 05313000
         CLI   IOPFUNCT(IOPPTR),84                                 1628 05314000
         BE    @RT01628                                            1628 05315000
         CLI   IOPFUNCT(IOPPTR),82                                 1628 05316000
         BE    @RT01628                                            1628 05317000
         CLI   IOPFUNCT(IOPPTR),86                                 1628 05318000
         BNE   @RF01628                                            1628 05319000
@RT01628 DS    0H                                                  1629 05320000
*             MGPMGNO1=HMA218I;     /* SUCCESSFULLY STORED   @Z67SP00*/ 05321000
         MVC   MGPMGNO1(2),@CH00450                                1629 05322000
*           ELSE                    /*                       @Z67SP00*/ 05323000
*             MGPMGNO1=HMA224I;     /* SUCCESSFULLY DELETED  @Z67SP00*/ 05324000
         B     @RC01628                                            1630 05325000
@RF01628 MVC   MGPMGNO1(2),@CH00461                                1630 05326000
*           CALL MEMMSG;            /*                       @Z67SP00*/ 05327000
@RC01628 BAL   @14,MEMMSG                                          1631 05328000
*         END;                      /*                       @Z67SP00*/ 05329000
*     END;                          /*                       @ZD00003*/ 05330000
*   END STOW;                       /*                       @Z40SP00*/ 05331000
@EL00009 L     @13,4(,@13)                                         1634 05332000
@EF00009 DS    0H                                                  1634 05333000
@ER00009 LM    @14,@12,12(@13)                                     1634 05334000
         BR    @14                                                 1634 05335000
         EJECT                                                          05336000
*GET:                                                              1635 05337000
*   PROCEDURE OPTIONS(SAVEAREA);                                   1635 05338000
*                                                                  1635 05339000
GET      STM   @14,@12,12(@13)                                     1635 05340000
         ST    @13,@SA00010+4                                      1635 05341000
         LA    @14,@SA00010                                        1635 05342000
         ST    @14,8(,@13)                                         1635 05343000
         LR    @13,@14                                             1635 05344000
*   /*****************************************************************/ 05345000
*   /*                                                               */ 05346000
*   /* THIS ROUTINE HANDLES QSAM GETS. THE DCB IS GOTTEN FROM DCBPTR */ 05347000
*   /* AND THE AREA ADDRESS IS IN IOPBUFAD.                          */ 05348000
*   /*                                                               */ 05349000
*   /*****************************************************************/ 05350000
*                                                                  1636 05351000
*   IOPRETRN=IOPGOOD;               /* INDICATE SUCCESSFUL GET OP    */ 05352000
         MVI   IOPRETRN(IOPPTR),X'00'                              1636 05353000
*   DCBEODA=ADDR(GETEOD);           /* DUMP EODAD ADDR TO DCB        */ 05354000
         LA    @11,GETEOD                                          1637 05355000
         STCM  @11,7,DCBEODA+28(DCBPTR)                            1637 05356000
*   RFY                                                            1638 05357000
*     IOPREG RSTD;                  /* REMOVE REG FROM USE   @Z40SP00*/ 05358000
*   IOPREG=IOPBUFAD;                /* GET BUFFER ADDR TO REGISTER   */ 05359000
         L     IOPREG,IOPBUFAD(,IOPPTR)                            1639 05360000
*   GENERATE CODE FLOWS(GETEOD,QSAMERR) REFS(DCBPTR,IOPREG);       1640 05361000
         GET   (DCBPTR),(IOPREG)       GET THE RECORD TO BUFFER         05362000
*   RFY                                                            1641 05363000
*     IOPREG UNRSTD;                /* RETURN REG FOR USE    @Z40SP00*/ 05364000
*   RETURN;                         /* RETURN TO REQUESTOR           */ 05365000
@EL00010 L     @13,4(,@13)                                         1642 05366000
@EF00010 DS    0H                                                  1642 05367000
@ER00010 LM    @14,@12,12(@13)                                     1642 05368000
         BR    @14                                                 1642 05369000
*GETEOD:                                                           1643 05370000
*   IOPRETRN=IOPEOF;                /* INDICATE END OF FILE  @YA07506*/ 05371000
GETEOD   MVI   IOPRETRN(IOPPTR),X'04'                              1643 05372000
*   END GET;                        /* EXIT TO REQUESTOR             */ 05373000
         B     @EL00010                                            1644 05374000
         EJECT                                                          05375000
*PUT:                               /*                               */ 05376000
*   PROCEDURE OPTIONS(SAVEAREA);                                   1645 05377000
*                                                                  1645 05378000
PUT      STM   @14,@12,12(@13)                                     1645 05379000
         ST    @13,@SA00011+4                                      1645 05380000
         LA    @14,@SA00011                                        1645 05381000
         ST    @14,8(,@13)                                         1645 05382000
         LR    @13,@14                                             1645 05383000
*   /*****************************************************************/ 05384000
*   /*                                                               */ 05385000
*   /* THIS ROUTINE IS ENTERED TO PREFORM QSAM PUTS                  */ 05386000
*   /*                                                               */ 05387000
*   /*****************************************************************/ 05388000
*                                                                  1646 05389000
*   IOPRETRN=IOPGOOD;               /* SET SMP RTN           @YA07506*/ 05390000
         MVI   IOPRETRN(IOPPTR),X'00'                              1646 05391000
*   RFY                                                            1647 05392000
*     IOPREG RSTD;                  /* REMOVE REG FROM USE   @Z40SP00*/ 05393000
*   IOPREG=IOPBUFAD;                /* PUT BUFFER ADDR IN REG        */ 05394000
         L     IOPREG,IOPBUFAD(,IOPPTR)                            1648 05395000
*   GENERATE REFS(DCBPTR,IOPREG) FLOWS(QSAMERR);                   1649 05396000
         PUT  (DCBPTR),(IOPREG)                                         05397000
*   RFY                                                            1650 05398000
*     IOPREG UNRSTD;                /* RETURN REG TO USE     @Z40SP00*/ 05399000
*   END PUT;                                                       1651 05400000
@EL00011 L     @13,4(,@13)                                         1651 05401000
@EF00011 DS    0H                                                  1651 05402000
@ER00011 LM    @14,@12,12(@13)                                     1651 05403000
         BR    @14                                                 1651 05404000
         EJECT                                                          05405000
*BLDL:                                                             1652 05406000
*   PROCEDURE OPTIONS(SAVEAREA);                                   1652 05407000
*                                                                  1652 05408000
BLDL     STM   @14,@12,12(@13)                                     1652 05409000
         ST    @13,@SA00012+4                                      1652 05410000
         LA    @14,@SA00012                                        1652 05411000
         ST    @14,8(,@13)                                         1652 05412000
         LR    @13,@14                                             1652 05413000
*   /*****************************************************************/ 05414000
*   /*                                                               */ 05415000
*   /* THIS ROUTINE IS USED TO LOCATE MEMBERS IN A PDS. A BLDL PARM  */ 05416000
*   /* LIST IS CONSTRUCTED FROM INFORMATION IN THE IOP. THE USER DATA*/ 05417000
*   /* AND TTR ARE DUMPED INTO THE IOP AFTER THE OPERATION IS        */ 05418000
*   /* COMPLETED SUCCESSFULLY.                                       */ 05419000
*   /*                                                               */ 05420000
*   /*****************************************************************/ 05421000
*                                                                  1653 05422000
*   DECLARE                                                        1653 05423000
*     1 BLDLLIST,                   /* PARM LIST FOR BLDL OPERATION  */ 05424000
*      2 * FIXED(15) INIT(1),       /* NUMBER OF ENTRIES             */ 05425000
*      2 * FIXED(15) INIT(76),      /* LENGTH OF EACH ENTRY          */ 05426000
*      2 BLDLNAME CHAR(8),          /* NAME FOR THE BLDL             */ 05427000
*      2 BLDLTTR PTR(24) BDY(BYTE), /* TTR FROM BLDL                 */ 05428000
*      2 * CHAR(1),                 /* UNUSED                        */ 05429000
*      2 * CHAR(1),                 /* UNUSED                        */ 05430000
*      2 BLDLUSRL PTR(8),           /* LENGTH OF USER DATA           */ 05431000
*       3 BLDLALIS BIT(1),          /* ENTRY IS ALIAS        @Z40SP00*/ 05432000
*       3 BLDLTTRC BIT(2),          /* NUMBR OF TTRS         @Z40SP00*/ 05433000
*       3 * BIT(5),                 /* ACTUAL USER DATA LEN  @Z40SP00*/ 05434000
*      2 BLDLUSER CHAR(62);         /* USER DATA                     */ 05435000
*   IF DISISW=ON                    /* IF DIRECTORY IS IN    @Z67SP00*/ 05436000
*     THEN                          /* STORAGE THEN          @ZD00003*/ 05437000
         TM    DISISW,B'00010000'                                  1654 05438000
         BNO   @RF01654                                            1654 05439000
*     CALL HMASMEIS(HMASMIOP);      /* CALL EIS              @ZD00003*/ 05440000
         ST    IOPPTR,@AL00001                                     1655 05441000
         L     @15,@CV03343                                        1655 05442000
         LA    @01,@AL00001                                        1655 05443000
         BALR  @14,@15                                             1655 05444000
*   ELSE                            /* IF NOT IN STORAGE     @ZD00003*/ 05445000
*     DO;                           /*                       @ZD00003*/ 05446000
         B     @RC01654                                            1656 05447000
@RF01654 DS    0H                                                  1657 05448000
*       BLDLNAME=IOPINAM;           /* PUT NAME IN LIST      @ZD00008*/ 05449000
         MVC   BLDLNAME(8),IOPINAM(IOPPTR)                         1657 05450000
*       GENERATE REFS(DCBPTR,BLDLLIST);                            1658 05451000
         BLDL  (DCBPTR),BLDLLIST      LOCATE THE MEMBER                 05452000
*       RFY                                                        1659 05453000
*         RTNCODE RSTD;             /*                       @ZD00001*/ 05454000
*       IOPRETRN=RTNCODE;           /* PUT RETURN CODE IN THE IOP    */ 05455000
         STC   RTNCODE,IOPRETRN(,IOPPTR)                           1660 05456000
*       RFY                                                        1661 05457000
*         RTNCODE UNRSTD;           /*                       @ZD00001*/ 05458000
*       IF IOPRETRN^=IOPGOOD        /* IS ENTRY LOCATED?     @YA07506*/ 05459000
*         THEN                      /* NO - SET ERROR CODE           */ 05460000
         CLI   IOPRETRN(IOPPTR),0                                  1662 05461000
         BE    @RF01662                                            1662 05462000
*         DO;                                                      1663 05463000
*           IOPTTR=ZERO;            /* ZERO THE TTR                  */ 05464000
         SLR   @11,@11                                             1664 05465000
         STCM  @11,7,IOPTTR(IOPPTR)                                1664 05466000
*           IF IOPRETRN>IOPNTFND    /* I/O ERROR?            @Z40SP00*/ 05467000
*             THEN                  /* YES - INDICATE ERROR          */ 05468000
         CLI   IOPRETRN(IOPPTR),4                                  1665 05469000
         BNH   @RF01665                                            1665 05470000
*             DO;                   /*                       @Z40SP00*/ 05471000
*               IOPRETRN=IOPIOERR;  /* SET RC TO I/O ERR     @YA07506*/ 05472000
         MVI   IOPRETRN(IOPPTR),X'10'                              1667 05473000
*               MGPTYPE=MGPTERM;    /* SET MESSAGE SEVERITY  @ZD00001*/ 05474000
         MVI   MGPTYPE,X'05'                                       1668 05475000
*               MGPMGNO1=HMA269I;   /* I/O ERROR ATTEMPTING TO BLDL  */ 05476000
         MVC   MGPMGNO1(2),@CH01035                                1669 05477000
*               CALL MEMMSG;        /* WRITE MEMBER ERROR MESSAGE    */ 05478000
         BAL   @14,MEMMSG                                          1670 05479000
*             END;                                                 1671 05480000
*         END;                                                     1672 05481000
*       ELSE                        /* IF RETURN IS GOOD     @ZD00003*/ 05482000
*         DO;                       /*                       @ZD00003*/ 05483000
         B     @RC01662                                            1673 05484000
@RF01662 DS    0H                                                  1674 05485000
*           IOPTTR=BLDLTTR;         /* PUT TTR IN THE IOP    @VS05281*/ 05486000
         MVC   IOPTTR(3,IOPPTR),BLDLTTR                            1674 05487000
*           IOPUSERL=BLDLUSRL;      /* PUT THE USER DATA LENGTH IN   */ 05488000
         MVC   IOPUSERL(1,IOPPTR),BLDLUSRL                         1675 05489000
*           BLDLALIS=OFF;           /* TURN OFF ALIAS BIT SO THAT THE   05490000
*                                      BYTE WILL CONTAIN ACTUAL USER    05491000
*                                      DATA LENGTH           @Z40SP00*/ 05492000
         NI    BLDLALIS,B'01111111'                                1676 05493000
*           BLDLTTRC=OFF;           /* SAME FOR TTRC FIELD   @Z40SP00*/ 05494000
         NI    BLDLTTRC,B'10011111'                                1677 05495000
*           IF BLDLUSRL>ZERO        /* IS THERE USER DATA?   @Z40SP00*/ 05496000
*             THEN                  /* YES - MOVE TO REQUESTOR AREA  */ 05497000
         CLI   BLDLUSRL,0                                          1678 05498000
         BNH   @RF01678                                            1678 05499000
*             IOPUDATA(1:(2*BLDLUSRL))=BLDLUSER;/* MOVE USRDTA     1679 05500000
*                                                            @ZD00003*/ 05501000
         SLR   @11,@11                                             1679 05502000
         IC    @11,BLDLUSRL                                        1679 05503000
         ALR   @11,@11                                             1679 05504000
         BCTR  @11,0                                               1679 05505000
         EX    @11,@SM04259                                        1679 05506000
*         END;                      /* END RTN IS ZERO       @ZD00003*/ 05507000
*     END;                          /* END DIR NOT IN STORE  @ZD00003*/ 05508000
*   END BLDL;                       /* EXIT TO REQUESTOR             */ 05509000
@EL00012 L     @13,4(,@13)                                         1682 05510000
@EF00012 DS    0H                                                  1682 05511000
@ER00012 LM    @14,@12,12(@13)                                     1682 05512000
         BR    @14                                                 1682 05513000
         EJECT                                                          05514000
*EOFSTR:                                                           1683 05515000
*   PROCEDURE OPTIONS(SAVEAREA);                                   1683 05516000
*                                                                  1683 05517000
EOFSTR   STM   @14,@12,12(@13)                                     1683 05518000
         ST    @13,@SA00013+4                                      1683 05519000
         LA    @14,@SA00013                                        1683 05520000
         ST    @14,8(,@13)                                         1683 05521000
         LR    @13,@14                                             1683 05522000
*   /*****************************************************************/ 05523000
*   /*                                                               */ 05524000
*   /* THIS SUBROUTINE IS INVOKED TO STORE THE EOF RECORD, IF NOT    */ 05525000
*   /* ALREADY IN THE CDS. IF PRESENT, THE TTR OF THE EOF MEMBER IS  */ 05526000
*   /* PLACED IN THE CURRENT MEMBER WHICH IS TO BE STORED AS AN ALIAS*/ 05527000
*   /* OF THE EOF MEMBER.                                            */ 05528000
*   /*                                                               */ 05529000
*   /*****************************************************************/ 05530000
*                                                                  1684 05531000
*   DECLARE                         /*                       @Z40SP00*/ 05532000
*     EOFFNCSV FIXED(8),            /* TO SAVE IOPFUNCT      @ZA13037*/ 05533000
*     EOFTYPSV FIXED(8),            /* TO SAVE IOPTYPET      @Z67SP00*/ 05534000
*     EOFNMSV CHAR(8),              /* TO SAVE IOPNAME       @Z67SP00*/ 05535000
*     EOFINMSV CHAR(8),             /* TO SAVE IOPINAM       @Z67SP00*/ 05536000
*     EOFLSV FIXED(8),              /* TO SAVE IOPUSERL      @Z40SP00*/ 05537000
*     EOFDATSV CHAR(LENGTH(IOPDIRCT));/* TO SAVE USER DATA   @Z40SP00*/ 05538000
*   DECLARE                         /*                       @Z67SP00*/ 05539000
*     SAVBFMX FIXED(15);            /*                       @Z67SP00*/ 05540000
*   SAVBFMX=DSBFRMX;                /* THESE HERE TO PREVENT @Z67SP00*/ 05541000
         LH    @11,DSBFRMX                                         1686 05542000
         STH   @11,SAVBFMX                                         1686 05543000
*   DSBFRMX=SAVBFMX;                /* COMPILERE ERR MSG     @Z67SP00*/ 05544000
         STH   @11,DSBFRMX                                         1687 05545000
*   EOFFNCSV=IOPFUNCT;              /* SAVE IOPFUNCT ACROSS EOF    1688 05546000
*                                      MEMBER STOW           @ZD00003*/ 05547000
         MVC   EOFFNCSV(1),IOPFUNCT(IOPPTR)                        1688 05548000
*   EOFTYPSV=IOPTYPE;               /* SAVE TYPE MEMBER      @Z67SP00*/ 05549000
         MVC   EOFTYPSV(1),IOPTYPE(IOPPTR)                         1689 05550000
*   EOFNMSV=IOPNAME;                /* SAVE MEMBER NAME      @Z67SP00*/ 05551000
         MVC   EOFNMSV(8),IOPNAME(IOPPTR)                          1690 05552000
*   EOFINMSV=IOPINAM;               /* SAVE MEMBER NAME      @Z67SP00*/ 05553000
         MVC   EOFINMSV(8),IOPINAM(IOPPTR)                         1691 05554000
*   EOFLSV=IOPUSERL;                /* SAVE USER DATA LENGTH @Z40SP00*/ 05555000
         MVC   EOFLSV(1),IOPUSERL(IOPPTR)                          1692 05556000
*   EOFDATSV=IOPDIRCT;              /* SAVE USER DATA        @Z40SP00*/ 05557000
         MVC   EOFDATSV(24),IOPDIRCT(IOPPTR)                       1693 05558000
*EOFBLDL:                                                          1694 05559000
*   IOPFUNCT=IOPNCODE;              /* ENCODE OPERATION      @Z67SP00*/ 05560000
EOFBLDL  MVI   IOPFUNCT(IOPPTR),X'10'                              1694 05561000
*   IOPTYPE=IOPDND;                 /* EOF MEMBER            @Z67SP00*/ 05562000
         MVI   IOPTYPE(IOPPTR),X'0A'                               1695 05563000
*   CALL HMASMION(HMASMIOP);        /* ENCODE EOF MEMBER NAM @Z67SP00*/ 05564000
         ST    IOPPTR,@AL00001                                     1696 05565000
         L     @15,@CV03344                                        1696 05566000
         LA    @01,@AL00001                                        1696 05567000
         BALR  @14,@15                                             1696 05568000
*   IOPFUNCT=IOPBLDL;               /* SET TO BLDL           @ZD00003*/ 05569000
         MVI   IOPFUNCT(IOPPTR),X'04'                              1697 05570000
*   CALL BLDL;                      /* LOCATE EOF MEMBER IN THE CDS  */ 05571000
         BAL   @14,BLDL                                            1698 05572000
*   IF IOPRETRN=IOPNTFND            /* MEMBER NOT THERE      @YA07506*/ 05573000
*     THEN                          /* MUST CREATE MEMBER            */ 05574000
         CLI   IOPRETRN(IOPPTR),4                                  1699 05575000
         BNE   @RF01699                                            1699 05576000
*     DO;                           /* STOW AN EOF MEMBER            */ 05577000
*       IOPFUNCT=IOPSTOWR;          /*                       @ZA13037*/ 05578000
         MVI   IOPFUNCT(IOPPTR),X'54'                              1701 05579000
*       IOPUSERL=ZERO;              /* INDICATE ZERO USER DATA       */ 05580000
         MVI   IOPUSERL(IOPPTR),X'00'                              1702 05581000
*       CALL STOW;                  /* STOW EOF MEMBER IN THE CDS    */ 05582000
         BAL   @14,STOW                                            1703 05583000
*       IF IOPRETRN=IOPGOOD         /* STOW SUCCESSFUL?      @ZD00003*/ 05584000
*         THEN                      /* NO - CANNOT CONTINUE          */ 05585000
         CLI   IOPRETRN(IOPPTR),0                                  1704 05586000
         BE    @RT01704                                            1704 05587000
*         GO TO EOFBLDL;            /* GO BACK AND GET THE TTR       */ 05588000
*     END;                                                         1706 05589000
*   IOPNAME=EOFNMSV;                /* RESTORE MEMBER NAME   @Z67SP00*/ 05590000
@RF01699 MVC   IOPNAME(8,IOPPTR),EOFNMSV                           1707 05591000
*   IOPTYPE=EOFTYPSV;               /* RESTORE TYPE          @Z67SP00*/ 05592000
         MVC   IOPTYPE(1,IOPPTR),EOFTYPSV                          1708 05593000
*   IOPFUNCT=EOFFNCSV;              /* RESTORE FUNCTION      @ZD00003*/ 05594000
         MVC   IOPFUNCT(1,IOPPTR),EOFFNCSV                         1709 05595000
*   IOPINAM=EOFINMSV;               /* RESTORE MEMBER NAME   @Z67SP00*/ 05596000
         MVC   IOPINAM(8,IOPPTR),EOFINMSV                          1710 05597000
*   IOPDIRCT=EOFDATSV;              /* RESTORE USER DATA     @Z40SP00*/ 05598000
         MVC   IOPDIRCT(24,IOPPTR),EOFDATSV                        1711 05599000
*   IOPUSERL=EOFLSV;                /* RESTORE DATA LENGTH   @Z40SP00*/ 05600000
         MVC   IOPUSERL(1,IOPPTR),EOFLSV                           1712 05601000
*   IF IOPRETRN=IOPGOOD             /* EOF MEMBER FOUND OK?  @ZD00003*/ 05602000
*     THEN                          /* YES - THEN            @ZD00003*/ 05603000
         CLI   IOPRETRN(IOPPTR),0                                  1713 05604000
         BNE   @RF01713                                            1713 05605000
*     EOFTTR=IOPTTR;                /* SAVE TTR OF EOF MEMBER        */ 05606000
         L     @11,PDSADDR                                         1714 05607000
         MVC   EOFTTR(3,@11),IOPTTR(IOPPTR)                        1714 05608000
*   END EOFSTR;                                                    1715 05609000
@EL00013 L     @13,4(,@13)                                         1715 05610000
@EF00013 DS    0H                                                  1715 05611000
@ER00013 LM    @14,@12,12(@13)                                     1715 05612000
         BR    @14                                                 1715 05613000
         EJECT                                                          05614000
*                                                                  1716 05615000
*   /*****************************************************************/ 05616000
*   /*                                                               */ 05617000
*   /* ROUTINE TO INTERFACE WITH SEQUENTIAL DIRETORY READ    @ZD00008*/ 05618000
*   /*                                                               */ 05619000
*   /*****************************************************************/ 05620000
*                                                                  1716 05621000
*IORDS:                             /*                       @ZD00008*/ 05622000
*   PROCEDURE;                      /*                       @ZD00008*/ 05623000
IORDS    STM   @14,@12,@SA00014                                    1716 05624000
*   HMASMRDP=HMASMRDP&&HMASMRDP;    /* CLEAR RDS PARM        @ZD00008*/ 05625000
         XC    HMASMRDP(26),HMASMRDP                               1717 05626000
*   IF IOPFUNCT=IOPGETN             /* MOVE IOP FUNCT TO RDP @XA16640*/ 05627000
*     THEN                          /*                       @XA16640*/ 05628000
         CLI   IOPFUNCT(IOPPTR),10                                 1718 05629000
         BNE   @RF01718                                            1718 05630000
*     RDPFUNCT=RDPGETN;             /*                       @XA16640*/ 05631000
         MVI   RDPFUNCT,X'01'                                      1719 05632000
*   ELSE                            /*                       @XA16640*/ 05633000
*     IF IOPFUNCT=IOPGETNC          /*                       @XA16640*/ 05634000
*       THEN                        /*                       @XA16640*/ 05635000
         B     @RC01718                                            1720 05636000
@RF01718 CLI   IOPFUNCT(IOPPTR),11                                 1720 05637000
         BNE   @RF01720                                            1720 05638000
*       RDPFUNCT=RDPGETNC;          /*                       @XA16640*/ 05639000
         MVI   RDPFUNCT,X'02'                                      1721 05640000
*     ELSE                          /*                       @XA16640*/ 05641000
*       RDPFUNCT=RDPCLOSE;          /*                       @ZD00008*/ 05642000
         B     @RC01720                                            1722 05643000
@RF01720 MVI   RDPFUNCT,X'03'                                      1722 05644000
*   RDPDSID=IOPDSID;                /* PASS DATASET ID       @Z67SP00*/ 05645000
@RC01720 DS    0H                                                  1723 05646000
@RC01718 MVC   RDPDSID(1),IOPDSID(IOPPTR)                          1723 05647000
*   RDPBUFAD=ADDR(IOPDRMAP);        /* RETURN AREA           @ZD00008*/ 05648000
         LA    @11,IOPDRMAP(,IOPPTR)                               1724 05649000
         ST    @11,RDPBUFAD                                        1724 05650000
*   CALL HMASMRDS(HMASMRDP);        /* GET ENTRY             @ZD00008*/ 05651000
         L     @15,@CV03347                                        1725 05652000
         LA    @01,@AL01725                                        1725 05653000
         BALR  @14,@15                                             1725 05654000
*   IOPRETRN=RDPRETRN;              /* MOVE RETURN TO IOP    @ZD00008*/ 05655000
         MVC   IOPRETRN(1,IOPPTR),RDPRETRN                         1726 05656000
*   IF RDPRETRN=RDPEOF              /* IF END OF FILE        @ZD00008*/ 05657000
*       &IOPFUNCT=IOPGETNC          /* AND COUNT REQUESTED   @ZD00008*/ 05658000
*     THEN                          /*                       @ZD00008*/ 05659000
         CLI   RDPRETRN,4                                          1727 05660000
         BNE   @RF01727                                            1727 05661000
         CLI   IOPFUNCT(IOPPTR),11                                 1727 05662000
         BNE   @RF01727                                            1727 05663000
*     DO;                           /*                       @ZD00008*/ 05664000
*       IOPALLOC=RDPALLOC;          /* MOVE BLK ALLOCATED    @ZD00008*/ 05665000
         MVC   IOPALLOC(4,IOPPTR),RDPALLOC                         1729 05666000
*       IOPUSED=RDPUSED;            /* MOVE BLK USED         @ZD00008*/ 05667000
         MVC   IOPUSED(4,IOPPTR),RDPUSED                           1730 05668000
*     END;                          /*                       @ZD00008*/ 05669000
*   IF RDPRETRN=RDPGOOD             /* IF MEMBER RETRIEVED   @ZD00008*/ 05670000
*       &(IOPFUNCT=IOPGETN          /* AND GETN OR GETNC     @ZD00008*/ 05671000
*       |IOPFUNCT=IOPGETNC)         /*                       @ZD00008*/ 05672000
*     THEN                          /*                       @ZD00008*/ 05673000
@RF01727 CLI   RDPRETRN,0                                          1732 05674000
         BNE   @RF01732                                            1732 05675000
         CLI   IOPFUNCT(IOPPTR),10                                 1732 05676000
         BE    @RT01732                                            1732 05677000
         CLI   IOPFUNCT(IOPPTR),11                                 1732 05678000
         BNE   @RF01732                                            1732 05679000
@RT01732 DS    0H                                                  1733 05680000
*     CALL HMASMION(HMASMIOP);      /* CALL ION TO SET IOPNAME AND 1733 05681000
*                                      IOPTYPE               @ZD00008*/ 05682000
         ST    IOPPTR,@AL00001                                     1733 05683000
         L     @15,@CV03344                                        1733 05684000
         LA    @01,@AL00001                                        1733 05685000
         BALR  @14,@15                                             1733 05686000
*   END IORDS;                      /*                       @ZD00008*/ 05687000
@EL00014 DS    0H                                                  1734 05688000
@EF00014 DS    0H                                                  1734 05689000
@ER00014 LM    @14,@12,@SA00014                                    1734 05690000
         BR    @14                                                 1734 05691000
         EJECT                                                          05692000
*                                                                  1735 05693000
*   /*****************************************************************/ 05694000
*   /*                                                               */ 05695000
*   /* THE FOLLOWING ARE SYNAD EXITS FOR THE VARIOUS ACCESS METHODS  */ 05696000
*   /*                                                               */ 05697000
*   /*****************************************************************/ 05698000
*                                                                  1735 05699000
*   RFY                                                            1735 05700000
*    (R0,                                                          1735 05701000
*     R1) RSTD;                     /* REMOVE REG FROM USE   @Z40SP00*/ 05702000
*QSAMERR:                                                          1736 05703000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @YA12120*/ 05704000
QSAMERR  DS    0H                                                  1737 05705000
*   DECLARE                         /*                       @Z40SP00*/ 05706000
*     ERRENTCT FIXED(8) INIT(0);    /* ENTRY COUNT FOR SYNAD @YA12120*/ 05707000
*   DECLARE                                                        1738 05708000
*     ERRSAVE1 CHAR(64) BDY(WORD);  /* SAVE AREA FOR ALL REG @YA12120*/ 05709000
*   DECLARE                         /*                       @Z40SP00*/ 05710000
*     ERRSAVE2(3) CHAR(64) BDY(WORD);/* SAVE AREA FOR REGS FOR     1739 05711000
*                                      MULTIPLE REENTRIES - COULD BE    05712000
*                                      SYSPRINT THEN SMPOUT THEN   1739 05713000
*                                      SMPLOG                @Z40SP00*/ 05714000
*   DECLARE                         /*                       @Z40SP00*/ 05715000
*     SYNDISP FIXED(8) CONSTANT(49);/* JOBNAME OFFSET        @Z40SP00*/ 05716000
*   DECLARE                                                        1741 05717000
*     SYNJOBN CHAR(1) BASED(R1+SYNDISP);/* JOBNAME IN SYNAD MSG      */ 05718000
*                                                                  1741 05719000
*   /*****************************************************************/ 05720000
*   /*                                                               */ 05721000
*   /* QSAM ERROR HAS OCCURRED                                       */ 05722000
*   /*                                                               */ 05723000
*   /*****************************************************************/ 05724000
*                                                                  1742 05725000
*   STM(R0,RTNCODE,ERRSAVE1);       /* SAVE ALL REGS ACROSS SYNAD. 1742 05726000
*                                      SAVE AREA IS NOT PROVIDED BY     05727000
*                                      CALLER THUS OWN MUST BE     1742 05728000
*                                      PROVIDED              @YA12120*/ 05729000
         STM   R0,RTNCODE,ERRSAVE1                                 1742 05730000
*   GEN(SYNADAF ACSMETH=QSAM);      /* ISSUE SYNADAF FOR MESSAGE     */ 05731000
         SYNADAF ACSMETH=QSAM                                           05732000
*   GO TO SYNMSG;                   /* GO WRITE OUT MSG      @Z40SP00*/ 05733000
*                                                                  1744 05734000
         B     SYNMSG                                              1744 05735000
*   /*****************************************************************/ 05736000
*   /*                                                               */ 05737000
*   /* BSAM I/O ERROR OCCURRED                                       */ 05738000
*   /*                                                               */ 05739000
*   /*****************************************************************/ 05740000
*                                                                  1745 05741000
*BSAMERR:                                                          1745 05742000
*   ENTRY;                                                         1745 05743000
BSAMERR  DS    0H                                                  1746 05744000
*   STM(R0,RTNCODE,ERRSAVE1);       /* SAVE ALL REGS ACROSS SYNAD. 1746 05745000
*                                      SAVE AREA IS NOT PROVIDED BY     05746000
*                                      CALLER THUS OWN MUST BE     1746 05747000
*                                      PROVIDED              @YA12120*/ 05748000
         STM   R0,RTNCODE,ERRSAVE1                                 1746 05749000
*   GEN(SYNADAF ACSMETH=BSAM);      /* GET SYNAD MESSAGE             */ 05750000
         SYNADAF ACSMETH=BSAM                                           05751000
*   GO TO SYNMSG;                   /* GO PRINT MESSAGE              */ 05752000
*                                                                  1748 05753000
         B     SYNMSG                                              1748 05754000
*   /*****************************************************************/ 05755000
*   /*                                                               */ 05756000
*   /* BPAM I/O ERROR OCCURRED                                       */ 05757000
*   /*                                                               */ 05758000
*   /*****************************************************************/ 05759000
*                                                                  1749 05760000
*BPAMERR:                                                          1749 05761000
*   ENTRY;                          /*                       @Z40SP00*/ 05762000
BPAMERR  DS    0H                                                  1750 05763000
*   STM(R0,RTNCODE,ERRSAVE1);       /* SAVE ALL REGS ACROSS SYNAD. 1750 05764000
*                                      SAVE AREA IS NOT PROVIDED BY     05765000
*                                      CALLER THUS OWN MUST BE     1750 05766000
*                                      PROVIDED              @YA12120*/ 05767000
         STM   R0,RTNCODE,ERRSAVE1                                 1750 05768000
*   GEN(SYNADAF ACSMETH=BPAM);      /* GET SYNAD MESSAGE             */ 05769000
         SYNADAF ACSMETH=BPAM                                           05770000
*   GO TO SYNMSG;                   /* GO PRINT MESSAGE              */ 05771000
         B     SYNMSG                                              1752 05772000
*                                                                  1753 05773000
*   /*****************************************************************/ 05774000
*   /*                                                               */ 05775000
*   /* COMMON ROUTINE TO PUT OUT I/O ERROR MSG               @Z40SP00*/ 05776000
*   /*                                                               */ 05777000
*   /*****************************************************************/ 05778000
*                                                                  1753 05779000
*SYNMSG:                                                           1753 05780000
*   ERRENTCT=ERRENTCT+1;            /* UPDATE ENTRY COUNT    @YA12120*/ 05781000
SYNMSG   SLR   @11,@11                                             1753 05782000
         IC    @11,ERRENTCT                                        1753 05783000
         LA    @11,1(,@11)                                         1753 05784000
         STC   @11,ERRENTCT                                        1753 05785000
*   ERRSAVE2(ERRENTCT)=ERRSAVE1;    /* MOVE SAVED REGS TO SAVE ARRAY    05786000
*                                      IN CASE REENTRY       @YA12120*/ 05787000
         SLA   @11,6                                               1754 05788000
         LA    @04,ERRSAVE2-64(@11)                                1754 05789000
         MVC   0(64,@04),ERRSAVE1                                  1754 05790000
*   MGPVARPT(1)=ADDR(SYNJOBN);      /* POINT TO JOBNAME IN MESSAGE   */ 05791000
         LA    @11,49                                              1755 05792000
         ALR   @11,R1                                              1755 05793000
         ST    @11,MGPVARPT                                        1755 05794000
*   RFY                                                            1756 05795000
*    (R0,                                                          1756 05796000
*     R1) UNRSTD;                   /*                       @Z40SP00*/ 05797000
*   MGPMGNO1=HMA274I;               /* INDICATE I/O ERROR MESSAGE    */ 05798000
         MVC   MGPMGNO1(2),@CH03320                                1757 05799000
*   MGPMGNO2=PART027;               /* INDICATE SYNAD SECONDARY      */ 05800000
         MVC   MGPMGNO2(2),@CH00465                                1758 05801000
*   MGPMGNO3=ZERO;                  /* NO TERTIARY                   */ 05802000
         SLR   @11,@11                                             1759 05803000
         STH   @11,MGPMGNO3                                        1759 05804000
*   IF IOPDSID=IOPSYSPT             /* SYSPRINT DATA SET     @Z40SP00*/ 05805000
*     THEN                          /* YES                   @Z40SP00*/ 05806000
         CLI   IOPDSID(IOPPTR),20                                  1760 05807000
         BNE   @RF01760                                            1760 05808000
*     SYSPDEAD=ON;                  /* SET SYSPRINT DEAD     @Z40SP00*/ 05809000
         OI    SYSPDEAD,B'10000000'                                1761 05810000
*   ELSE                            /*                       @Z40SP00*/ 05811000
*     IF IOPDSID=IOPPRINT           /* IS IT THE PRINTER             */ 05812000
*       THEN                        /* YES - SET PRINT OFF           */ 05813000
         B     @RC01760                                            1762 05814000
@RF01760 CLI   IOPDSID(IOPPTR),11                                  1762 05815000
         BNE   @RF01762                                            1762 05816000
*       DO;                         /*                       @Z67SP00*/ 05817000
*         CCAOUTNG=ON;              /* SET OUT NO GOOD       @Z67SP00*/ 05818000
         L     @11,@CA00038                                        1764 05819000
         OI    CCAOUTNG-HMASMCCA(@11),B'01000000'                  1764 05820000
*         CCATERM=ON;               /* STOP SMP AT DRV       @Z67SP00*/ 05821000
         OI    CCATERM-HMASMCCA(@11),B'00100000'                   1765 05822000
*       END;                        /*                       @Z67SP00*/ 05823000
*     ELSE                          /* OTHERWISE - CHECK FOR HISTLOG */ 05824000
*       IF IOPDSID=IOPHLDS          /* IS IT THE LOG?                */ 05825000
*         THEN                      /* YES - SET LOG DEAD            */ 05826000
         B     @RC01762                                            1767 05827000
@RF01762 CLI   IOPDSID(IOPPTR),1                                   1767 05828000
         BNE   @RF01767                                            1767 05829000
*         DO;                       /*                       @Z67SP00*/ 05830000
*           CCALOGNG=ON;            /* SET LOG DEAD          @Z67SP00*/ 05831000
         L     @11,@CA00038                                        1769 05832000
         OI    CCALOGNG-HMASMCCA(@11),B'10000000'                  1769 05833000
*           CCATERM=ON;             /* STOP SMP AT DRV       @Z67SP00*/ 05834000
         OI    CCATERM-HMASMCCA(@11),B'00100000'                   1770 05835000
*         END;                      /*                       @Z67SP00*/ 05836000
*   MGPTYPE=MGPTERM;                /* SET MESSAGE SEVERITY  @ZD00001*/ 05837000
@RF01767 DS    0H                                                  1772 05838000
@RC01762 DS    0H                                                  1772 05839000
@RC01760 MVI   MGPTYPE,X'05'                                       1772 05840000
*   CALL HMASMMSG(HMASMMGP);        /* WRITE MESSAGE                 */ 05841000
         L     @15,@CV03346                                        1773 05842000
         LA    @01,@AL01773                                        1773 05843000
         BALR  @14,@15                                             1773 05844000
*   IOPRETRN=IOPIOERR;              /* INDICATE I/O ERROR FOUND      */ 05845000
         MVI   IOPRETRN(IOPPTR),X'10'                              1774 05846000
*   GEN(SYNADRLS);                  /* RELEASE SYNAD WORK AREA       */ 05847000
         SYNADRLS                                                       05848000
*   ERRSAVE1=ERRSAVE2(ERRENTCT);    /* MOVE REGS TO LM AREA  @YA12120*/ 05849000
         SLR   @11,@11                                             1776 05850000
         IC    @11,ERRENTCT                                        1776 05851000
         LR    @04,@11                                             1776 05852000
         SLA   @04,6                                               1776 05853000
         LA    @03,ERRSAVE2-64(@04)                                1776 05854000
         MVC   ERRSAVE1(64),0(@03)                                 1776 05855000
*   ERRENTCT=ERRENTCT-1;            /* DECR ENTRY COUNT      @YA12120*/ 05856000
         BCTR  @11,0                                               1777 05857000
         STC   @11,ERRENTCT                                        1777 05858000
*   LM(R0,RTNCODE,ERRSAVE1);        /* RESTORE REGS          @YA12120*/ 05859000
         LM    R0,RTNCODE,ERRSAVE1                                 1778 05860000
*   RFY                                                            1779 05861000
*     RTNREG UNRSTD;                                               1779 05862000
*   END QSAMERR;                    /* RETURN AND CONTINUE           */ 05863000
@EL00015 DS    0H                                                  1780 05864000
@EF00015 DS    0H                                                  1780 05865000
@ER00015 BR    @14                                                 1780 05866000
         EJECT                                                          05867000
*                                                                  1781 05868000
*   /*****************************************************************/ 05869000
*   /*                                                               */ 05870000
*   /* THE FOLLOWING ROUTINE IS INVOKED TO PRINT STOW/BLDL MESSAGES  */ 05871000
*   /* MESSAGE TYPE HAS ALREADY BEEN SET UP BY CALLER        @ZD00001*/ 05872000
*   /*                                                               */ 05873000
*   /*****************************************************************/ 05874000
*                                                                  1781 05875000
*MEMMSG:                                                           1781 05876000
*   PROCEDURE OPTIONS(SAVEAREA);                                   1781 05877000
MEMMSG   STM   @14,@12,12(@13)                                     1781 05878000
         ST    @13,@SA00016+4                                      1781 05879000
         LA    @14,@SA00016                                        1781 05880000
         ST    @14,8(,@13)                                         1781 05881000
         LR    @13,@14                                             1781 05882000
*   MGPMGNO2=PART031;               /* XXXXXXXX XXXXXXXX     @Z67SP00*/ 05883000
         MVC   MGPMGNO2(2),@CH00043                                1782 05884000
*   MGPMGNO3=PART016;               /* ON XXXXXXXX LIBRARY   @Z67SP00*/ 05885000
         MVC   MGPMGNO3(2),@CH00188                                1783 05886000
*   MGPVARPT(1)=ADDR(CCATYPEA(IOPTYPE));/* TYPE MEMBER       @Z67SP00*/ 05887000
         SLR   @11,@11                                             1784 05888000
         IC    @11,IOPTYPE(,IOPPTR)                                1784 05889000
         SLA   @11,3                                               1784 05890000
         L     @04,@CA00038                                        1784 05891000
         L     @03,CCATPAD-HMASMCCA(,@04)                          1784 05892000
         AL    @03,@CF04239                                        1784 05893000
         LA    @11,CCATYPEA(@11,@03)                               1784 05894000
         ST    @11,MGPVARPT                                        1784 05895000
*   MGPVARPT(2)=ADDR(MEMNAME);      /* SET VARIABLE PTR TO MEMBER NM */ 05896000
         LA    @11,MEMNAME                                         1785 05897000
         ST    @11,MGPVARPT+4                                      1785 05898000
*   MGPVARPT(3)=ADDR(CCADSIDA(IOPDSID));/* SET DD NAME       @Z67SP00*/ 05899000
         SLR   @11,@11                                             1786 05900000
         IC    @11,IOPDSID(,IOPPTR)                                1786 05901000
         SLA   @11,3                                               1786 05902000
         L     @04,CCADSAD-HMASMCCA(,@04)                          1786 05903000
         AL    @04,@CF04239                                        1786 05904000
         LA    @11,CCADSIDA(@11,@04)                               1786 05905000
         ST    @11,MGPVARPT+8                                      1786 05906000
*   IF IOPFUNCT=IOPSTOWC            /* IF STOW CHANGE        @SA76001*/ 05907000
*     THEN                          /* THEN NAME IN MSG IS   @SA76001*/ 05908000
         CLI   IOPFUNCT(IOPPTR),82                                 1787 05909000
         BNE   @RF01787                                            1787 05910000
*     MEMNAME=IOPNNAME;             /* NEW NAME              @ZD00008*/ 05911000
         MVC   MEMNAME(8),IOPNNAME(IOPPTR)                         1788 05912000
*   ELSE                            /* IF NOT STOW CHANGE    @Z40SP00*/ 05913000
*     MEMNAME=IOPNAME;              /* MOVE NAME TO MSG AREA @Z40SP00*/ 05914000
         B     @RC01787                                            1789 05915000
@RF01787 MVC   MEMNAME(8),IOPNAME(IOPPTR)                          1789 05916000
*   CALL HMASMMSG(HMASMMGP);        /* ISSUE MESSAGE                 */ 05917000
@RC01787 L     @15,@CV03346                                        1790 05918000
         LA    @01,@AL01790                                        1790 05919000
         BALR  @14,@15                                             1790 05920000
*   END MEMMSG;                     /* RETURN                        */ 05921000
@EL00016 L     @13,4(,@13)                                         1791 05922000
@EF00016 DS    0H                                                  1791 05923000
@ER00016 LM    @14,@12,12(@13)                                     1791 05924000
         BR    @14                                                 1791 05925000
         EJECT                                                          05926000
*                                                                  1792 05927000
*   /*****************************************************************/ 05928000
*   /*                                                               */ 05929000
*   /* ROUTINE CALLED TO PRINT DD MISSING MESSAGE            @Z40SP00*/ 05930000
*   /*                                                               */ 05931000
*   /*****************************************************************/ 05932000
*                                                                  1792 05933000
*NODDMSG:                           /*                       @Z40SP00*/ 05934000
*   MGPMGNO1=HMA283I;               /* ****ERROR**** XXXXXXXX DDCARD    05935000
*                                      MISSING               @Z40SP00*/ 05936000
NODDMSG  MVC   MGPMGNO1(2),@CH00520                                1792 05937000
*   MGPVARPT(1)=ADDR(CCADSIDA(IOPDSID));/* DD NAME           @Z40SP00*/ 05938000
         SLR   @11,@11                                             1793 05939000
         IC    @11,IOPDSID(,IOPPTR)                                1793 05940000
         SLA   @11,3                                               1793 05941000
         L     @04,@CA00038                                        1793 05942000
         L     @04,CCADSAD-HMASMCCA(,@04)                          1793 05943000
         AL    @04,@CF04239                                        1793 05944000
         LA    @11,CCADSIDA(@11,@04)                               1793 05945000
         ST    @11,MGPVARPT                                        1793 05946000
*   GO TO WTERRMSG;                 /*                       @Z40SP00*/ 05947000
*                                                                  1794 05948000
         B     WTERRMSG                                            1794 05949000
*   /*****************************************************************/ 05950000
*   /*                                                               */ 05951000
*   /* ROUTINES ENTERED TO WRITE OUT OPEN/CLOSE FAIL MSG AND SET     */ 05952000
*   /* RETURN CODES                                          @Z40SP00*/ 05953000
*   /*                                                               */ 05954000
*   /*****************************************************************/ 05955000
*                                                                  1795 05956000
*CLOSFAIL:                          /*                       @Z40SP00*/ 05957000
*   MGPVARPT(1)=ADDR(TXTCLOSE);     /* CLOSE                 @Z40SP00*/ 05958000
CLOSFAIL LA    @11,@CC03331                                        1795 05959000
         ST    @11,MGPVARPT                                        1795 05960000
*   GO TO OPENCLOS;                 /* GO WRITE MSG          @Z40SP00*/ 05961000
         B     OPENCLOS                                            1796 05962000
*OPENFAIL:                          /*                       @Z40SP00*/ 05963000
*   MGPVARPT(1)=ADDR(TXTOPEN);      /* OPEN                  @Z40SP00*/ 05964000
OPENFAIL LA    @11,@CC03333                                        1797 05965000
         ST    @11,MGPVARPT                                        1797 05966000
*OPENCLOS:                          /*                       @Z40SP00*/ 05967000
*   MGPMGNO1=HMA201I;               /* XXX FAILED FOR XXXX   @Z40SP00*/ 05968000
OPENCLOS MVC   MGPMGNO1(2),@CH00183                                1798 05969000
*   MGPVARPT(2)=ADDR(CCADSIDA(IOPDSID));/* DD NAME           @Z40SP00*/ 05970000
         SLR   @11,@11                                             1799 05971000
         IC    @11,IOPDSID(,IOPPTR)                                1799 05972000
         SLA   @11,3                                               1799 05973000
         L     @04,@CA00038                                        1799 05974000
         L     @04,CCADSAD-HMASMCCA(,@04)                          1799 05975000
         AL    @04,@CF04239                                        1799 05976000
         LA    @11,CCADSIDA(@11,@04)                               1799 05977000
         ST    @11,MGPVARPT+4                                      1799 05978000
*WTERRMSG:                          /*                       @Z40SP00*/ 05979000
*   IF IOPDSID=IOPHLDS              /* OPEN/CLOSE FOR LOG    @Z40SP00*/ 05980000
*     THEN                          /* YES - THEN NO ERR     @Z40SP00*/ 05981000
WTERRMSG CLI   IOPDSID(IOPPTR),1                                   1800 05982000
         BNE   @RF01800                                            1800 05983000
*     DO;                           /*                       @Z67SP00*/ 05984000
*       CCALOGNG=ON;                /* LOG UNUSEABLE         @Z67SP00*/ 05985000
         L     @11,@CA00038                                        1802 05986000
         OI    CCALOGNG-HMASMCCA(@11),B'10000000'                  1802 05987000
*       CCATERM=ON;                 /* STOP SMP AT DRV       @Z67SP00*/ 05988000
         OI    CCATERM-HMASMCCA(@11),B'00100000'                   1803 05989000
*     END;                          /*                       @Z67SP00*/ 05990000
*   ELSE                            /* NOT LOG OPEN/CLOSE    @Z40SP00*/ 05991000
*     IF IOPDSID=IOPPRINT           /* WAS IT SMPOUT?        @Z40SP00*/ 05992000
*       THEN                        /* YES - NO ERR MSG      @Z40SP00*/ 05993000
         B     @RC01800                                            1805 05994000
@RF01800 CLI   IOPDSID(IOPPTR),11                                  1805 05995000
         BNE   @RF01805                                            1805 05996000
*       DO;                         /*                       @Z67SP00*/ 05997000
*         CCAOUTNG=ON;              /*                       @Z67SP00*/ 05998000
         L     @11,@CA00038                                        1807 05999000
         OI    CCAOUTNG-HMASMCCA(@11),B'01000000'                  1807 06000000
*         CCATERM=ON;               /* STOP SMP AT DRV       @Z67SP00*/ 06001000
         OI    CCATERM-HMASMCCA(@11),B'00100000'                   1808 06002000
*       END;                        /*                       @Z67SP00*/ 06003000
*   MGPTYPE=MGPSEV;                 /* SET MESSAGE SEVERITY  @ZD00001*/ 06004000
@RF01805 DS    0H                                                  1810 06005000
@RC01800 MVI   MGPTYPE,X'04'                                       1810 06006000
*   CALL HMASMMSG(HMASMMGP);        /* WRITE MSG             @Z40SP00*/ 06007000
         L     @15,@CV03346                                        1811 06008000
         LA    @01,@AL01811                                        1811 06009000
         BALR  @14,@15                                             1811 06010000
*   IOPRETRN=IOPNTOPN;              /* SAME RETURN FOR BOTH  @ZA25875*/ 06011000
         MVI   IOPRETRN(IOPPTR),X'0C'                              1812 06012000
*   IF IOPFUNCT=IOPWRITE            /* IF WRITE              @ZA25875*/ 06013000
*       &(                          /* AND                   @ZA25875*/ 06014000
*       (IOPDSID=IOPHLDS            /* IF WRITE TO LOG       @ZA25875*/ 06015000
*       &CCAOUTNG=OFF)              /* AND PRINTER OK        @ZA25875*/ 06016000
*       |                           /* OR                    @ZA25875*/ 06017000
*       (IOPDSID=IOPPRINT           /* WRITE TO PRINTER      @ZA25875*/ 06018000
*       &CCALOGNG=OFF)              /* AND LOG OK            @ZA25875*/ 06019000
*       )                           /*                       @ZA25875*/ 06020000
*     THEN                          /* THEN                  @ZA25875*/ 06021000
         CLI   IOPFUNCT(IOPPTR),81                                 1813 06022000
         BNE   @RF01813                                            1813 06023000
         CLI   IOPDSID(IOPPTR),1                                   1813 06024000
         BNE   @GL00132                                            1813 06025000
         L     @11,@CA00038                                        1813 06026000
         TM    CCAOUTNG-HMASMCCA(@11),B'01000000'                  1813 06027000
         BZ    @RT01813                                            1813 06028000
@GL00132 CLI   IOPDSID(IOPPTR),11                                  1813 06029000
         BNE   @RF01813                                            1813 06030000
         L     @11,@CA00038                                        1813 06031000
         TM    CCALOGNG-HMASMCCA(@11),B'10000000'                  1813 06032000
         BZ    @RT01813                                            1813 06033000
*     GO TO IOINIT0;                /* GO TO TOP OF PGM SO THAT MSG     06034000
*                                      WILL BE SWITCHED TO ALTERNATE    06035000
*                                      DATA SET              @ZA25875*/ 06036000
*   GO TO EXIT;                     /* GO TO RETURN POINT    @Z40SP00*/ 06037000
         B     EXIT                                                1815 06038000
         EJECT                                                          06039000
*                                                                  1816 06040000
*   /*****************************************************************/ 06041000
*   /*                                                               */ 06042000
*   /* COMMON RETURN POINT FROM HMASMIO TO CALLING PROCEDURE.        */ 06043000
*   /* GOODEXIT SETS RETURN CODE TO COMPLETED SUCCESSFULLY AND EXIT  */ 06044000
*   /* ASSUMES THAT THE RETURN CODE HAS PREVIOUSLY BEEN SET UP. IF   */ 06045000
*   /* THIS IS A RE-ENTRY THE GETMAINED SAVE AREA IS FREED AND IN ALL*/ 06046000
*   /* CASES THE ENTRY COUNT IS DECREMENTED BY ONE.          @Z40SP00*/ 06047000
*   /*                                                               */ 06048000
*   /*****************************************************************/ 06049000
*                                                                  1816 06050000
*BADEXIT:                           /*                       @Z67SP00*/ 06051000
*   IOPRETRN=IOPIOERR;              /*                       @Z67SP00*/ 06052000
BADEXIT  MVI   IOPRETRN(IOPPTR),X'10'                              1816 06053000
*   GO TO EXIT;                     /*                       @Z67SP00*/ 06054000
         B     EXIT                                                1817 06055000
*GOODEXIT:                                                         1818 06056000
*   IOPRETRN=IOPGOOD;               /* INDICATE SUCCESS      @YA07506*/ 06057000
GOODEXIT MVI   IOPRETRN(IOPPTR),X'00'                              1818 06058000
*EXIT:                                                             1819 06059000
*   IOPDSID=SAVDSID(IOENTCNT);      /* RESET DSID            @ZA25875*/ 06060000
EXIT     SLR   @11,@11                                             1819 06061000
         IC    @11,IOENTCNT                                        1819 06062000
         SLR   @04,@04                                             1819 06063000
         IC    @04,SAVDSID-1(@11)                                  1819 06064000
         STC   @04,IOPDSID(,IOPPTR)                                1819 06065000
*   CCACURDS=SAVCCADS(IOENTCNT);    /* RESET LAST DSID       @Z67SP00*/ 06066000
         L     @04,@CA00038                                        1820 06067000
         SLR   @03,@03                                             1820 06068000
         IC    @03,SAVCCADS-1(@11)                                 1820 06069000
         STC   @03,CCACURDS-HMASMCCA(,@04)                         1820 06070000
*   IF IOENTCNT>1                   /* IF RE-ENTRY           @ZA25875*/ 06071000
*     THEN                          /*                       @ZA25875*/ 06072000
         CLI   IOENTCNT,1                                          1821 06073000
         BNH   @RF01821                                            1821 06074000
*     HMASMMGP=SAVMGP(IOENTCNT-1);  /* RESTORE MGP           @ZA25875*/ 06075000
         MVI   HMASMMGP+12,C' '                                    1822 06076000
         MVC   HMASMMGP+13(11),HMASMMGP+12                         1822 06077000
         MH    @11,@CH00033                                        1822 06078000
         LA    @04,SAVMGP-24(@11)                                  1822 06079000
         MVC   HMASMMGP(12),0(@04)                                 1822 06080000
*   RFY                                                            1823 06081000
*     SVAREAS BASED(R13);           /* IO SAVE AREA          @Z40SP00*/ 06082000
@RF01821 DS    0H                                                  1824 06083000
*   R13=SVBACK;                     /* CHAIN SAVE AREAS BACK         */ 06084000
         L     R13,SVBACK(,R13)                                    1824 06085000
*   IOENTCNT=IOENTCNT-1;            /* DECREMENT ENTRY COUNTER       */ 06086000
         SLR   @11,@11                                             1825 06087000
         IC    @11,IOENTCNT                                        1825 06088000
         BCTR  @11,0                                               1825 06089000
         STC   @11,IOENTCNT                                        1825 06090000
*   END HMASMIO                                                    1826 06091000
*                                                                  1826 06092000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 06093000
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */ 06094000
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */ 06095000
*/*%INCLUDE SYSLIB  (HMASMPRL)                                       */ 06096000
*/*%INCLUDE SYSLIB  (HMASMRDP)                                       */ 06097000
*/*%INCLUDE SYSLIB  (HMASMMGP)                                       */ 06098000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 06099000
*/*%INCLUDE SYSLIB  (IKJTCB  )                                       */ 06100000
*/*%INCLUDE SYSLIB  (IEZJSCB )                                       */ 06101000
*/*%INCLUDE SYSLIB  (IHADCBDF)                                       */ 06102000
*/*%INCLUDE SYSLIB  (IHADCB  )                                       */ 06103000
*/*%INCLUDE SYSLIB  (IEZIOB  )                                       */ 06104000
*/*%INCLUDE SYSLIB  (IEFJFCBN)                                       */ 06105000
*                                                                  1826 06106000
*       ;                                                          1826 06107000
         B     @EL00001                                            1826 06108000
@DATA    DS    0H                                                       06109000
@CH00088 DC    H'1'                                                     06110000
@CH00235 DC    H'3'                                                     06111000
@CH00034 DC    H'10'                                                    06112000
@CH00033 DC    H'12'                                                    06113000
@CH00067 DC    H'15'                                                    06114000
@CH00188 DC    H'16'                                                    06115000
@CH00450 DC    H'19'                                                    06116000
@CH00355 DC    H'20'                                                    06117000
@CH00461 DC    H'25'                                                    06118000
@CH00465 DC    H'27'                                                    06119000
@CH00043 DC    H'31'                                                    06120000
@CH00086 DC    H'32'                                                    06121000
@CH00374 DC    H'42'                                                    06122000
@CH00384 DC    H'44'                                                    06123000
@CH00805 DC    H'60'                                                    06124000
@CH01031 DC    H'68'                                                    06125000
@CH01033 DC    H'69'                                                    06126000
@CH01035 DC    H'70'                                                    06127000
@CH00833 DC    H'72'                                                    06128000
@CH03320 DC    H'75'                                                    06129000
@CH00520 DC    H'84'                                                    06130000
@CH03564 DC    H'120'                                                   06131000
@CH03323 DC    H'144'                                                   06132000
@CH03325 DC    H'204'                                                   06133000
@CH04103 DC    H'3200'                                                  06134000
@CH03486 DC    H'10000'                                                 06135000
@SM04242 MVC   IHADCB(0,@11),IHADCB(@03)                                06136000
@SC04251 CLC   PRLDATA(0,@11),PRNTDATA                                  06137000
@SM04253 MVC   PRNTDATA(0),PRLDATA(@11)                                 06138000
@SM04259 MVC   IOPUDATA(0,IOPPTR),BLDLUSER                              06139000
         DS    0F                                                       06140000
@AL00419 EQU   *                       LIST WITH   1 ARGUMENT(S)        06141000
@AL00950 EQU   *                       LIST WITH   1 ARGUMENT(S)        06142000
@AL01177 EQU   *                       LIST WITH   1 ARGUMENT(S)        06143000
@AL01229 EQU   *                       LIST WITH   1 ARGUMENT(S)        06144000
@AL01366 EQU   *                       LIST WITH   1 ARGUMENT(S)        06145000
@AL01773 EQU   *                       LIST WITH   1 ARGUMENT(S)        06146000
@AL01790 EQU   *                       LIST WITH   1 ARGUMENT(S)        06147000
@AL01811 DC    A(HMASMMGP)             LIST WITH   1 ARGUMENT(S)        06148000
@AL00780 EQU   *                       LIST WITH   2 ARGUMENT(S)        06149000
@AL00881 DC    A(DIRLEN)               LIST WITH   2 ARGUMENT(S)        06150000
         DC    A(XTNDLEN)                                               06151000
@AL01725 DC    A(HMASMRDP)             LIST WITH   1 ARGUMENT(S)        06152000
         DS    0F                                                       06153000
@PC00001 DS    1F                                                       06154000
@SA00010 DS    18F                                                      06155000
@SA00013 DS    18F                                                      06156000
@SA00009 DS    18F                                                      06157000
@SA00008 DS    18F                                                      06158000
@PC00008 DS    1F                                                       06159000
@SA00005 DS    18F                                                      06160000
@SA00007 DS    18F                                                      06161000
@SA00012 DS    18F                                                      06162000
@SA00011 DS    18F                                                      06163000
@SA00016 DS    18F                                                      06164000
@SA00014 DS    0F                                                       06165000
@SA00003 DS    0F                                                       06166000
         DS    15F                                                      06167000
@AL00001 DS    3A                                                       06168000
@TF00001 DS    F                                                        06169000
         DS    0F                                                       06170000
@CF00183 DC    F'2'                                                     06171000
@CH00183 EQU   @CF00183+2                                               06172000
@CF00512 DC    F'80'                                                    06173000
@CH00512 EQU   @CF00512+2                                               06174000
@CF04248 DC    F'-80'                                                   06175000
@CF04235 DC    F'-72'                                                   06176000
@CF04239 DC    F'-8'                                                    06177000
@CF04250 DC    F'-4'                                                    06178000
@CA00038 DC    A(HMASMCCA)                                              06179000
@CV03342 DC    V(HMASMALC)                                              06180000
@CV03343 DC    V(HMASMEIS)                                              06181000
@CV03344 DC    V(HMASMION)                                              06182000
@CV03345 DC    V(HMASMIO1)                                              06183000
@CV03346 DC    V(HMASMMSG)                                              06184000
@CV03347 DC    V(HMASMRDS)                                              06185000
         DS    0D                                                       06186000
DIRLEN   DS    F                                                        06187000
TCBPTR   DC    A(0)                                                     06188000
IOBPRPTR DS    A                                                        06189000
IOBSTPTR DS    A                                                        06190000
JFCBPTR  DC    AL4(JFCBOPEN)                                            06191000
J        DS    A                                                        06192000
K        DS    A                                                        06193000
M        DS    A                                                        06194000
N        DS    A                                                        06195000
BUFFSV   DS    A                                                        06196000
XTNDLEN  DS    F                                                        06197000
ADDIRDCB DC    AL4(DIRUDCB)                                             06198000
ADCDODCB DC    AL4(CDSODCB)                                             06199000
ADACODCB DC    AL4(ACDSODCB)                                            06200000
ADCQODCB DC    AL4(CRQODCB)                                             06201000
ADAQODCB DC    AL4(ACRQODCB)                                            06202000
ADPTFDCB DC    AL4(PTFDCB)                                              06203000
ADPTFND  DC    AL4(PTFDCBND)                                            06204000
ADSVPTF  DC    AL4(SVPTFDCB)                                            06205000
DSBFPTRI DS    A                                                        06206000
DSBFPTRO DS    A                                                        06207000
PDSADDR  DS    A                                                        06208000
TMPCPTR1 DS    A                                                        06209000
ARRYADDR DS    A                                                        06210000
GETADDR  DC    F'0'                                                     06211000
ADIOSAVE DC    AL4(IOSAVE)                                              06212000
ADWTSAVE DC    AL4(WTSAVE)                                              06213000
ADJFCB01 DC    AL4(JFCBSAV1)                                            06214000
ADJFCB02 DC    AL4(JFCBSAV2)                                            06215000
ADJFCBPT DC    AL4(JFCBPTF)                                             06216000
IOPPTR2  DS    A                                                        06217000
INITDSRG DC    H'0'                                                     06218000
DSBFMX   DS    H                                                        06219000
DSBFRMX  DS    H                                                        06220000
PGLEN    DS    H                                                        06221000
TBFRCNTI DC    H'0'                                                     06222000
TBFRSIZ  DC    H'0'                                                     06223000
LENDCB   DS    H                                                        06224000
SAVBFMX  DS    H                                                        06225000
DCBNO    DS    FL1                                                      06226000
TTRSV    DS    AL3                                                      06227000
PDSI     DC    AL1(0)                                                   06228000
SAVUSERL DS    FL1                                                      06229000
IOENTCNT DC    AL1(0)                                                   06230000
WTENTCNT DC    AL1(0)                                                   06231000
EOFFNCSV DS    FL1                                                      06232000
EOFTYPSV DS    FL1                                                      06233000
EOFLSV   DS    FL1                                                      06234000
ERRENTCT DC    AL1(0)                                                   06235000
@CC03371 DC    C'1SYSTEM '                                              06236000
@CC03331 DC    C'CLOSE'                                                 06237000
@CC03333 DC    C'OPEN '                                                 06238000
         DS    CL2                                                      06239000
HMASMRDP DS    CL26                                                     06240000
         ORG   HMASMRDP                                                 06241000
RDPDSID  DS    FL1                                                      06242000
RDPFUNCT DS    FL1                                                      06243000
RDPRETRN DS    FL1                                                      06244000
@NM00173 DS    FL1                                                      06245000
RDPBUFAD DS    AL4                                                      06246000
RDPWKAD  DS    AL4                                                      06247000
RDPENTS  DS    FL4                                                      06248000
RDPALLOC DS    FL4                                                      06249000
RDPUSED  DS    FL4                                                      06250000
RDPTYPE  DS    BL2                                                      06251000
         ORG   HMASMRDP+26                                              06252000
         DS    CL2                                                      06253000
HMASMMGP DS    CL24                                                     06254000
         ORG   HMASMMGP                                                 06255000
MGPFIXED DS    CL12                                                     06256000
         ORG   MGPFIXED                                                 06257000
MGPCLEAR DS    CL6                                                      06258000
         ORG   MGPCLEAR                                                 06259000
MGPMGNO1 DS    FL2                                                      06260000
MGPMGNO2 DS    FL2                                                      06261000
MGPMGNO3 DS    FL2                                                      06262000
         ORG   MGPFIXED+6                                               06263000
MGPFLAGS DS    BL2                                                      06264000
         ORG   MGPFLAGS                                                 06265000
MGPPRINT DS    BL1                                                      06266000
MGPLIST  EQU   MGPFLAGS+0                                               06267000
MGPRPT   EQU   MGPFLAGS+0                                               06268000
MGPHLDS  EQU   MGPFLAGS+0                                               06269000
MGPWTOR  EQU   MGPFLAGS+0                                               06270000
MGPWTO   EQU   MGPFLAGS+0                                               06271000
MGPWTP   EQU   MGPFLAGS+0                                               06272000
@NM00174 EQU   MGPFLAGS+0                                               06273000
         ORG   MGPFIXED+8                                               06274000
MGPTYPE  DS    FL1                                                      06275000
@NM00175 DS    CL3                                                      06276000
         ORG   HMASMMGP+12                                              06277000
MGPVAR   DS    CL12                                                     06278000
         ORG   MGPVAR                                                   06279000
MGPVARPT DS    3A                                                       06280000
         ORG   HMASMMGP+24                                              06281000
LASTDDI  DC    CL8' '                                                   06282000
LASTDDO  DC    CL8' '                                                   06283000
CCWFLGSV DS    BL1                                                      06284000
         DS    CL3                                                      06285000
TEMPTTR  DS    CL4                                                      06286000
MEMNAME  DS    CL8                                                      06287000
IOIOP    DS    CL68                                                     06288000
SAVSYS   DS    CL8                                                      06289000
PATCHIO  DS    CL80                                                     06290000
         ORG   PATCHIO                                                  06291000
@NM00208 DC    80X'FF'                                                  06292000
         ORG   PATCHIO+80                                               06293000
PDSDDNAM DS    CL8                                                      06294000
SAVTTR   DS    CL3                                                      06295000
         DS    CL1                                                      06296000
DBLWRD   DS    CL8                                                      06297000
TIMETEMP DS    CL4                                                      06298000
SMPARRAY DS    CL46                                                     06299000
         ORG   SMPARRAY                                                 06300000
@NM00225 DC    AL4(MAINHEAD)                                            06301000
         DC    AL4(PRNTBUF)                                             06302000
         DS    8XL4                                                     06303000
@NM00226 DC    H'0'                                                     06304000
@NM00227 DC    H'2'                                                     06305000
@NM00228 DC    H'10000'                                                 06306000
         ORG   SMPARRAY+46                                              06307000
MAINHEAD DS    CL121                                                    06308000
         ORG   MAINHEAD                                                 06309000
@NM00241 DC    CL1'1'                                                   06310000
@NM00242 DC    5CL1' '                                                  06311000
@NM00243 DC    CL5'DATE '                                               06312000
DATEFLD  DS    CL6                                                      06313000
         ORG   DATEFLD                                                  06314000
YY       DS    CL2                                                      06315000
@NM00244 DC    CL1'.'                                                   06316000
DDD      DS    CL3                                                      06317000
         ORG   MAINHEAD+17                                              06318000
@NM00245 DC    2CL1' '                                                  06319000
@NM00246 DC    CL5'TIME '                                               06320000
HH       DS    CL2                                                      06321000
@NM00247 DC    CL1':'                                                   06322000
MM       DS    CL2                                                      06323000
@NM00248 DC    CL1':'                                                   06324000
TT       DS    CL2                                                      06325000
@NM00249 DC    6CL1' '                                                  06326000
@NM00250 DC    CL17'HMASMP LVL 04.00 '                                  06327000
MHEAD    DC    CL31' '                                                  06328000
@NM00251 DC    24CL1' '                                                 06329000
@NM00252 DC    CL5'PAGE '                                               06330000
PAGEFLD  DS    CL4                                                      06331000
         ORG   PAGEFLD                                                  06332000
@NM00253 DS    CL3                                                      06333000
LASTDIG  DS    BL1                                                      06334000
         ORG   MAINHEAD+119                                             06335000
@NM00254 DC    2CL1' '                                                  06336000
         ORG   MAINHEAD+121                                             06337000
PRNTBUF  DS    CL121                                                    06338000
         ORG   PRNTBUF                                                  06339000
PRNTASA  DC    CL1' '                                                   06340000
PRNTDATA DC    CL120' '                                                 06341000
         ORG   PRNTBUF+121                                              06342000
SYSARRAY DS    CL46                                                     06343000
         ORG   SYSARRAY                                                 06344000
@NM00229 DC    AL4(MAINHEAD)                                            06345000
         DC    AL4(PRNTBUF)                                             06346000
         DS    8XL4                                                     06347000
@NM00230 DC    H'0'                                                     06348000
@NM00231 DC    H'2'                                                     06349000
@NM00232 DC    H'10000'                                                 06350000
         ORG   SYSARRAY+46                                              06351000
         DS    CL2                                                      06352000
RPTARRAY DS    CL46                                                     06353000
         ORG   RPTARRAY                                                 06354000
@NM00233 DC    AL4(MAINHEAD)                                            06355000
         DC    AL4(PRNTBUF)                                             06356000
         DS    8XL4                                                     06357000
@NM00234 DC    H'0'                                                     06358000
@NM00235 DC    H'2'                                                     06359000
@NM00236 DC    H'10000'                                                 06360000
         ORG   RPTARRAY+46                                              06361000
         DS    CL2                                                      06362000
LSTARRAY DS    CL46                                                     06363000
         ORG   LSTARRAY                                                 06364000
@NM00237 DC    AL4(MAINHEAD)                                            06365000
         DC    AL4(PRNTBUF)                                             06366000
         DS    8XL4                                                     06367000
@NM00238 DC    H'0'                                                     06368000
@NM00239 DC    H'2'                                                     06369000
@NM00240 DC    H'10000'                                                 06370000
         ORG   LSTARRAY+46                                              06371000
OUTHEAD  DC    CL31'MESSAGES AND CONTROL STATEMENTS'                    06372000
PRNTHEAD DC    CL15'SYSPRINT OUTPUT'                                    06373000
RPTHEAD  DC    CL13'SMPRPT OUTPUT'                                      06374000
LSTHEAD  DC    CL14'SMPLIST OUTPUT'                                     06375000
QNAME    DC    CL8'SYSDSN  '                                            06376000
ENQRNAME DS    CL45                                                     06377000
         ORG   ENQRNAME                                                 06378000
RNAMELEN DS    FL1                                                      06379000
RNAME    DC    CL44' '                                                  06380000
         ORG   ENQRNAME+45                                              06381000
SWITCHES DC    AL2(0)                                                   06382000
         ORG   SWITCHES                                                 06383000
SYSPDEAD DS    BL1                                                      06384000
CONTEOF  EQU   SWITCHES+0                                               06385000
SKIPRDJF EQU   SWITCHES+0                                               06386000
DISISW   EQU   SWITCHES+0                                               06387000
DISOSW   EQU   SWITCHES+0                                               06388000
ALIASW   EQU   SWITCHES+0                                               06389000
PTFJFSV  EQU   SWITCHES+0                                               06390000
PTFF2OP  EQU   SWITCHES+0                                               06391000
CHNGDISP DS    BL1                                                      06392000
ENQDONE  EQU   SWITCHES+1                                               06393000
@NM00257 EQU   SWITCHES+1                                               06394000
         ORG   SWITCHES+2                                               06395000
         DS    CL2                                                      06396000
EXITLST  DS    CL8                                                      06397000
         ORG   EXITLST                                                  06398000
JFCEXL   DS    CL4                                                      06399000
         ORG   JFCEXL                                                   06400000
@NM00258 DC    X'07'                                                    06401000
@NM00259 DC    AL3(JFCBOPEN)                                            06402000
         ORG   EXITLST+4                                                06403000
DCBXL    DS    CL4                                                      06404000
         ORG   DCBXL                                                    06405000
@NM00260 DC    X'85'                                                    06406000
@NM00261 DC    AL3(DCBEXIT)                                             06407000
         ORG   EXITLST+8                                                06408000
DEVDDNAM DS    CL8                                                      06409000
DEVADDR  DS    CL8                                                      06410000
DCBDCLS  DS    CL672                                                    06411000
         ORG   DCBDCLS                                                  06412000
HISTENT  DS    CL16                                                     06413000
         ORG   HISTENT                                                  06414000
@NM00265 DC    AL4(HISTDCB)                                             06415000
@NM00266 DC    AL4(OPHISTI)                                             06416000
@NM00267 DC    AL4(HISTDCB)                                             06417000
@NM00268 DC    AL4(OPHISTO)                                             06418000
         ORG   DCBDCLS+16                                               06419000
CDSENT   DS    CL16                                                     06420000
         ORG   CDSENT                                                   06421000
@NM00269 DC    AL4(CDSIDCB)                                             06422000
@NM00270 DC    AL4(OPCDSI)                                              06423000
@NM00271 DC    AL4(CDSODCB)                                             06424000
@NM00272 DC    AL4(OPCDSO)                                              06425000
         ORG   DCBDCLS+32                                               06426000
SCR1ENT  DS    CL16                                                     06427000
         ORG   SCR1ENT                                                  06428000
@NM00273 DC    AL4(SCR1DCB)                                             06429000
@NM00274 DC    AL4(OPSCR1I)                                             06430000
@NM00275 DC    AL4(SCR1DCB)                                             06431000
@NM00276 DC    AL4(OPSCR1O)                                             06432000
         ORG   DCBDCLS+48                                               06433000
SCR2ENT  DS    CL16                                                     06434000
         ORG   SCR2ENT                                                  06435000
@NM00277 DC    AL4(SCR2DCB)                                             06436000
@NM00278 DC    AL4(OPSCR2I)                                             06437000
@NM00279 DC    AL4(SCR2DCB)                                             06438000
@NM00280 DC    AL4(OPSCR2O)                                             06439000
         ORG   DCBDCLS+64                                               06440000
MACENT   DS    CL16                                                     06441000
         ORG   MACENT                                                   06442000
@NM00281 DC    AL4(MACDCB)                                              06443000
@NM00282 DC    AL4(OPMACI)                                              06444000
@NM00283 DC    A(0)                                                     06445000
@NM00284 DC    A(0)                                                     06446000
         ORG   DCBDCLS+80                                               06447000
PTSENT   DS    CL16                                                     06448000
         ORG   PTSENT                                                   06449000
@NM00285 DC    AL4(PTSIDCB)                                             06450000
@NM00286 DC    AL4(OPPTSI)                                              06451000
@NM00287 DC    AL4(PTSODCB)                                             06452000
@NM00288 DC    AL4(OPPTSO)                                              06453000
         ORG   DCBDCLS+96                                               06454000
SGTENT   DS    CL16                                                     06455000
         ORG   SGTENT                                                   06456000
@NM00289 DC    AL4(SGTDCB)                                              06457000
@NM00290 DC    AL4(OPSGTI)                                              06458000
@NM00291 DC    A(0)                                                     06459000
@NM00292 DC    A(0)                                                     06460000
         ORG   DCBDCLS+112                                              06461000
CDSDENT  DS    CL16                                                     06462000
         ORG   CDSDENT                                                  06463000
@NM00293 DC    AL4(CDSDDCB)                                             06464000
@NM00294 DC    AL4(OPCDSDI)                                             06465000
@NM00295 DC    AL4(CDSDDCB)                                             06466000
@NM00296 DC    AL4(OPCDSDO)                                             06467000
         ORG   DCBDCLS+128                                              06468000
CONTENT  DS    CL16                                                     06469000
         ORG   CONTENT                                                  06470000
@NM00297 DC    AL4(CONTDCB)                                             06471000
@NM00298 DC    AL4(OPCONTI)                                             06472000
@NM00299 DC    A(0)                                                     06473000
@NM00300 DC    A(0)                                                     06474000
         ORG   DCBDCLS+144                                              06475000
PTFENT   DS    CL16                                                     06476000
         ORG   PTFENT                                                   06477000
@NM00301 DC    AL4(PTFDCB)                                              06478000
@NM00302 DC    AL4(OPPTFI)                                              06479000
@NM00303 DC    A(0)                                                     06480000
@NM00304 DC    A(0)                                                     06481000
         ORG   DCBDCLS+160                                              06482000
PRTENT   DS    CL16                                                     06483000
         ORG   PRTENT                                                   06484000
@NM00305 DC    A(0)                                                     06485000
@NM00306 DC    A(0)                                                     06486000
@NM00307 DC    AL4(PRTDCB)                                              06487000
@NM00308 DC    AL4(OPPRTO)                                              06488000
         ORG   DCBDCLS+176                                              06489000
ACDSENT  DS    CL16                                                     06490000
         ORG   ACDSENT                                                  06491000
@NM00309 DC    AL4(ACDSIDCB)                                            06492000
@NM00310 DC    AL4(OPACDSI)                                             06493000
@NM00311 DC    AL4(ACDSODCB)                                            06494000
@NM00312 DC    AL4(OPACDSO)                                             06495000
         ORG   DCBDCLS+192                                              06496000
ACDSDENT DS    CL16                                                     06497000
         ORG   ACDSDENT                                                 06498000
@NM00313 DC    AL4(ACDSDDCB)                                            06499000
@NM00314 DC    AL4(OPACDSDI)                                            06500000
@NM00315 DC    AL4(ACDSDDCB)                                            06501000
@NM00316 DC    AL4(OPACDSDO)                                            06502000
         ORG   DCBDCLS+208                                              06503000
STNDDD   DS    CL16                                                     06504000
         ORG   STNDDD                                                   06505000
@NM00317 DC    AL4(STNDIDCB)                                            06506000
@NM00318 DC    AL4(OPSTNDI)                                             06507000
@NM00319 DC    AL4(STNDODCB)                                            06508000
@NM00320 DC    AL4(OPSTNDO)                                             06509000
         ORG   DCBDCLS+224                                              06510000
PUNENT   DS    CL16                                                     06511000
         ORG   PUNENT                                                   06512000
@NM00321 DC    A(0)                                                     06513000
@NM00322 DC    A(0)                                                     06514000
@NM00323 DC    AL4(PUNODCB)                                             06515000
@NM00324 DC    AL4(OPPUNO)                                              06516000
         ORG   DCBDCLS+240                                              06517000
@NM00325 DS    CL16                                                     06518000
         ORG   @NM00325                                                 06519000
@NM00326 DC    A(0)                                                     06520000
@NM00327 DC    A(0)                                                     06521000
@NM00328 DC    A(0)                                                     06522000
@NM00329 DC    A(0)                                                     06523000
         ORG   DCBDCLS+256                                              06524000
@NM00330 DS    CL16                                                     06525000
         ORG   @NM00330                                                 06526000
@NM00331 DC    A(0)                                                     06527000
@NM00332 DC    A(0)                                                     06528000
@NM00333 DC    A(0)                                                     06529000
@NM00334 DC    A(0)                                                     06530000
         ORG   DCBDCLS+272                                              06531000
MTSENT   DS    CL16                                                     06532000
         ORG   MTSENT                                                   06533000
@NM00335 DC    AL4(MTSIDCB)                                             06534000
@NM00336 DC    AL4(OPMTSI)                                              06535000
@NM00337 DC    AL4(MTSODCB)                                             06536000
@NM00338 DC    AL4(OPMTSO)                                              06537000
         ORG   DCBDCLS+288                                              06538000
MTSDENT  DS    CL16                                                     06539000
         ORG   MTSDENT                                                  06540000
@NM00339 DC    AL4(MTSDDCB)                                             06541000
@NM00340 DC    AL4(OPMTSDI)                                             06542000
@NM00341 DC    A(0)                                                     06543000
@NM00342 DC    A(0)                                                     06544000
         ORG   DCBDCLS+304                                              06545000
SYSPTENT DS    CL16                                                     06546000
         ORG   SYSPTENT                                                 06547000
@NM00343 DC    A(0)                                                     06548000
@NM00344 DC    A(0)                                                     06549000
@NM00345 DC    AL4(SYSODCB)                                             06550000
@NM00346 DC    AL4(OPSYSO)                                              06551000
         ORG   DCBDCLS+320                                              06552000
@NM00347 DS    CL16                                                     06553000
         ORG   @NM00347                                                 06554000
@NM00348 DC    A(0)                                                     06555000
@NM00349 DC    A(0)                                                     06556000
@NM00350 DC    A(0)                                                     06557000
@NM00351 DC    A(0)                                                     06558000
         ORG   DCBDCLS+336                                              06559000
SRCENT   DS    CL16                                                     06560000
         ORG   SRCENT                                                   06561000
@NM00352 DC    AL4(SRCDCB)                                              06562000
@NM00353 DC    AL4(OPSRCI)                                              06563000
@NM00354 DC    A(0)                                                     06564000
@NM00355 DC    A(0)                                                     06565000
         ORG   DCBDCLS+352                                              06566000
PTSDENT  DS    CL16                                                     06567000
         ORG   PTSDENT                                                  06568000
@NM00356 DC    AL4(PTSDDCB)                                             06569000
@NM00357 DC    AL4(OPPTSDI)                                             06570000
@NM00358 DC    A(0)                                                     06571000
@NM00359 DC    A(0)                                                     06572000
         ORG   DCBDCLS+368                                              06573000
ANYDDENT DS    CL16                                                     06574000
         ORG   ANYDDENT                                                 06575000
@NM00360 DC    AL4(STNDIDCB)                                            06576000
@NM00361 DC    AL4(OPSTNDI)                                             06577000
@NM00362 DC    AL4(STNDODCB)                                            06578000
@NM00363 DC    AL4(OPSTNDO)                                             06579000
         ORG   DCBDCLS+384                                              06580000
JFCBENT  DS    CL16                                                     06581000
         ORG   JFCBENT                                                  06582000
@NM00364 DC    AL4(JFCBDCB)                                             06583000
@NM00365 DC    AL4(OPJFCBI)                                             06584000
@NM00366 DC    AL4(JFCBDCB)                                             06585000
@NM00367 DC    AL4(OPJFCBO)                                             06586000
         ORG   DCBDCLS+400                                              06587000
STSENT   DS    CL16                                                     06588000
         ORG   STSENT                                                   06589000
@NM00368 DC    AL4(STSIDCB)                                             06590000
@NM00369 DC    AL4(OPSTSI)                                              06591000
@NM00370 DC    AL4(STSODCB)                                             06592000
@NM00371 DC    AL4(OPSTSO)                                              06593000
         ORG   DCBDCLS+416                                              06594000
STSDENT  DS    CL16                                                     06595000
         ORG   STSDENT                                                  06596000
@NM00372 DC    AL4(STSDDCB)                                             06597000
@NM00373 DC    AL4(OPSTSDI)                                             06598000
@NM00374 DC    A(0)                                                     06599000
@NM00375 DC    A(0)                                                     06600000
         ORG   DCBDCLS+432                                              06601000
CRQENT   DS    CL16                                                     06602000
         ORG   CRQENT                                                   06603000
@NM00376 DC    AL4(CRQIDCB)                                             06604000
@NM00377 DC    AL4(OPCRQI)                                              06605000
@NM00378 DC    AL4(CRQODCB)                                             06606000
@NM00379 DC    AL4(OPCRQO)                                              06607000
         ORG   DCBDCLS+448                                              06608000
CRQDENT  DS    CL16                                                     06609000
         ORG   CRQDENT                                                  06610000
@NM00380 DC    AL4(CRQDIDCB)                                            06611000
@NM00381 DC    AL4(OPCRQDI)                                             06612000
@NM00382 DC    A(0)                                                     06613000
@NM00383 DC    A(0)                                                     06614000
         ORG   DCBDCLS+464                                              06615000
ACRQENT  DS    CL16                                                     06616000
         ORG   ACRQENT                                                  06617000
@NM00384 DC    AL4(ACRQIDCB)                                            06618000
@NM00385 DC    AL4(OPACRQI)                                             06619000
@NM00386 DC    AL4(ACRQODCB)                                            06620000
@NM00387 DC    AL4(OPACRQO)                                             06621000
         ORG   DCBDCLS+480                                              06622000
ACRQDENT DS    CL16                                                     06623000
         ORG   ACRQDENT                                                 06624000
@NM00388 DC    AL4(ACRQDDCB)                                            06625000
@NM00389 DC    AL4(OPACRQDI)                                            06626000
@NM00390 DC    A(0)                                                     06627000
@NM00391 DC    A(0)                                                     06628000
         ORG   DCBDCLS+496                                              06629000
LRFENT   DS    CL16                                                     06630000
         ORG   LRFENT                                                   06631000
@NM00392 DC    AL4(LRFIDCB)                                             06632000
@NM00393 DC    AL4(OPLRFI)                                              06633000
@NM00394 DC    A(0)                                                     06634000
@NM00395 DC    A(0)                                                     06635000
         ORG   DCBDCLS+512                                              06636000
SCDSENT  DS    CL16                                                     06637000
         ORG   SCDSENT                                                  06638000
@NM00396 DC    AL4(SCDSIDCB)                                            06639000
@NM00397 DC    AL4(OPSCDSI)                                             06640000
@NM00398 DC    AL4(SCDSODCB)                                            06641000
@NM00399 DC    AL4(OPSCDSO)                                             06642000
         ORG   DCBDCLS+528                                              06643000
SCDSDENT DS    CL16                                                     06644000
         ORG   SCDSDENT                                                 06645000
@NM00400 DC    AL4(SCDSDDCB)                                            06646000
@NM00401 DC    AL4(OPSCDSDI)                                            06647000
@NM00402 DC    A(0)                                                     06648000
@NM00403 DC    A(0)                                                     06649000
         ORG   DCBDCLS+544                                              06650000
WK1ENT   DS    CL16                                                     06651000
         ORG   WK1ENT                                                   06652000
@NM00404 DC    AL4(WK1IDCB)                                             06653000
@NM00405 DC    AL4(OPWK1I)                                              06654000
@NM00406 DC    AL4(WK1ODCB)                                             06655000
@NM00407 DC    AL4(OPWK1O)                                              06656000
         ORG   DCBDCLS+560                                              06657000
WK2ENT   DS    CL16                                                     06658000
         ORG   WK2ENT                                                   06659000
@NM00408 DC    AL4(WK2IDCB)                                             06660000
@NM00409 DC    AL4(OPWK2I)                                              06661000
@NM00410 DC    AL4(WK2ODCB)                                             06662000
@NM00411 DC    AL4(OPWK2O)                                              06663000
         ORG   DCBDCLS+576                                              06664000
WK3ENT   DS    CL16                                                     06665000
         ORG   WK3ENT                                                   06666000
@NM00412 DC    AL4(WK3IDCB)                                             06667000
@NM00413 DC    AL4(OPWK3I)                                              06668000
@NM00414 DC    AL4(WK3ODCB)                                             06669000
@NM00415 DC    AL4(OPWK3O)                                              06670000
         ORG   DCBDCLS+592                                              06671000
WK4ENT   DS    CL16                                                     06672000
         ORG   WK4ENT                                                   06673000
@NM00416 DC    AL4(WK4IDCB)                                             06674000
@NM00417 DC    AL4(OPWK4I)                                              06675000
@NM00418 DC    AL4(WK4ODCB)                                             06676000
@NM00419 DC    AL4(OPWK4O)                                              06677000
         ORG   DCBDCLS+608                                              06678000
WK5ENT   DS    CL16                                                     06679000
         ORG   WK5ENT                                                   06680000
@NM00420 DC    AL4(WK5IDCB)                                             06681000
@NM00421 DC    AL4(OPWK5I)                                              06682000
@NM00422 DC    AL4(WK5ODCB)                                             06683000
@NM00423 DC    AL4(OPWK5O)                                              06684000
         ORG   DCBDCLS+624                                              06685000
WKXENT   DS    CL16                                                     06686000
         ORG   WKXENT                                                   06687000
@NM00424 DC    A(0)                                                     06688000
@NM00425 DC    A(0)                                                     06689000
@NM00426 DC    A(0)                                                     06690000
@NM00427 DC    A(0)                                                     06691000
         ORG   DCBDCLS+640                                              06692000
RPTENT   DS    CL16                                                     06693000
         ORG   RPTENT                                                   06694000
@NM00428 DC    A(0)                                                     06695000
@NM00429 DC    A(0)                                                     06696000
@NM00430 DC    AL4(RPTODCB)                                             06697000
@NM00431 DC    AL4(OPRPTO)                                              06698000
         ORG   DCBDCLS+656                                              06699000
LSTENT   DS    CL16                                                     06700000
         ORG   LSTENT                                                   06701000
@NM00432 DC    A(0)                                                     06702000
@NM00433 DC    A(0)                                                     06703000
@NM00434 DC    AL4(LSTODCB)                                             06704000
@NM00435 DC    AL4(OPLSTO)                                              06705000
         ORG   DCBDCLS+672                                              06706000
ENDENTS  DS    0C                                                       06707000
         ORG   DCBDCLS+672                                              06708000
JFCB01NM DC    CL8'        '                                            06709000
JFCB02NM DC    CL8'        '                                            06710000
POINTTTR DS    CL4                                                      06711000
         ORG   POINTTTR                                                 06712000
PTTR13   DS    CL3                                                      06713000
PTTR4    DC    AL1(0)                                                   06714000
         ORG   POINTTTR+4                                               06715000
STOWCPRM DS    CL16                                                     06716000
         ORG   STOWCPRM                                                 06717000
STOWONAM DS    CL8                                                      06718000
STOWNNAM DS    CL8                                                      06719000
         ORG   STOWCPRM+16                                              06720000
SAVONAME DS    CL8                                                      06721000
SAVNNAME DS    CL8                                                      06722000
RELADSV  DS    CL3                                                      06723000
OFLGSSV  DS    CL1                                                      06724000
         ORG   OFLGSSV                                                  06725000
OFLWRSV  DS    BL1                                                      06726000
@NM00438 EQU   OFLGSSV+0                                                06727000
         ORG   OFLGSSV+1                                                06728000
BLDLLIST DS    CL80                                                     06729000
         ORG   BLDLLIST                                                 06730000
@NM00439 DC    H'1'                                                     06731000
@NM00440 DC    H'76'                                                    06732000
BLDLNAME DS    CL8                                                      06733000
BLDLTTR  DS    AL3                                                      06734000
@NM00441 DS    CL1                                                      06735000
@NM00442 DS    CL1                                                      06736000
BLDLUSRL DS    AL1                                                      06737000
         ORG   BLDLUSRL                                                 06738000
BLDLALIS DS    BL1                                                      06739000
BLDLTTRC EQU   BLDLUSRL+0                                               06740000
@NM00443 EQU   BLDLUSRL+0                                               06741000
         ORG   BLDLLIST+18                                              06742000
BLDLUSER DS    CL62                                                     06743000
         ORG   BLDLLIST+80                                              06744000
EOFNMSV  DS    CL8                                                      06745000
EOFINMSV DS    CL8                                                      06746000
EOFDATSV DS    CL24                                                     06747000
ERRSAVE1 DS    CL64                                                     06748000
PDSARRAY DS    CL16                                                     06749000
         ORG   PDSARRAY+0                                               06750000
@NM00213 DC    CL1'N'                                                   06751000
@NM00214 DC    AL3(0)                                                   06752000
@NM00215 DC    CL1' '                                                   06753000
@NM00216 DC    AL3(0)                                                   06754000
@NM00217 DC    AL1(0)                                                   06755000
@NM00218 DC    CL1' '                                                   06756000
@NM00219 DC    H'0'                                                     06757000
@NM00220 DC    H'0'                                                     06758000
@NM00221 DC    H'0'                                                     06759000
         ORG   PDSARRAY+16                                              06760000
         ORG   PDSARRAY+16                                              06761000
         DC    CL1'N'                                                   06762000
         DC    AL3(0)                                                   06763000
         DC    CL1' '                                                   06764000
         DC    AL3(0)                                                   06765000
         DC    AL1(0)                                                   06766000
         DC    CL1' '                                                   06767000
         DC    H'0'                                                     06768000
         DC    H'0'                                                     06769000
         DC    H'0'                                                     06770000
         ORG   PDSARRAY+32                                              06771000
         ORG   PDSARRAY+32                                              06772000
         DC    CL1'N'                                                   06773000
         DC    AL3(0)                                                   06774000
         DC    CL1' '                                                   06775000
         DC    AL3(0)                                                   06776000
         DC    AL1(0)                                                   06777000
         DC    CL1' '                                                   06778000
         DC    H'0'                                                     06779000
         DC    H'0'                                                     06780000
         DC    H'0'                                                     06781000
         ORG   PDSARRAY+48                                              06782000
         ORG   PDSARRAY+48                                              06783000
         DC    CL1'N'                                                   06784000
         DC    AL3(0)                                                   06785000
         DC    CL1' '                                                   06786000
         DC    AL3(0)                                                   06787000
         DC    AL1(0)                                                   06788000
         DC    CL1' '                                                   06789000
         DC    H'0'                                                     06790000
         DC    H'0'                                                     06791000
         DC    H'0'                                                     06792000
         ORG   PDSARRAY+64                                              06793000
         ORG   PDSARRAY+64                                              06794000
         DC    CL1'N'                                                   06795000
         DC    AL3(0)                                                   06796000
         DC    CL1' '                                                   06797000
         DC    AL3(0)                                                   06798000
         DC    AL1(0)                                                   06799000
         DC    CL1' '                                                   06800000
         DC    H'0'                                                     06801000
         DC    H'0'                                                     06802000
         DC    H'0'                                                     06803000
         ORG   PDSARRAY+80                                              06804000
         ORG   PDSARRAY+80                                              06805000
         DC    CL1'N'                                                   06806000
         DC    AL3(0)                                                   06807000
         DC    CL1' '                                                   06808000
         DC    AL3(0)                                                   06809000
         DC    AL1(0)                                                   06810000
         DC    CL1' '                                                   06811000
         DC    H'0'                                                     06812000
         DC    H'0'                                                     06813000
         DC    H'0'                                                     06814000
         ORG   PDSARRAY+96                                              06815000
         ORG   PDSARRAY+96                                              06816000
         DC    CL1'N'                                                   06817000
         DC    AL3(0)                                                   06818000
         DC    CL1' '                                                   06819000
         DC    AL3(0)                                                   06820000
         DC    AL1(0)                                                   06821000
         DC    CL1' '                                                   06822000
         DC    H'0'                                                     06823000
         DC    H'0'                                                     06824000
         DC    H'0'                                                     06825000
         ORG   PDSARRAY+112                                             06826000
         ORG   PDSARRAY+112                                             06827000
         DC    CL1'N'                                                   06828000
         DC    AL3(0)                                                   06829000
         DC    CL1' '                                                   06830000
         DC    AL3(0)                                                   06831000
         DC    AL1(0)                                                   06832000
         DC    CL1' '                                                   06833000
         DC    H'0'                                                     06834000
         DC    H'0'                                                     06835000
         DC    H'0'                                                     06836000
         ORG   PDSARRAY+128                                             06837000
         ORG   PDSARRAY+128                                             06838000
         DC    CL1'N'                                                   06839000
         DC    AL3(0)                                                   06840000
         DC    CL1' '                                                   06841000
         DC    AL3(0)                                                   06842000
         DC    AL1(0)                                                   06843000
         DC    CL1' '                                                   06844000
         DC    H'0'                                                     06845000
         DC    H'0'                                                     06846000
         DC    H'0'                                                     06847000
         ORG   PDSARRAY+144                                             06848000
         ORG   PDSARRAY+144                                             06849000
         DC    CL1'N'                                                   06850000
         DC    AL3(0)                                                   06851000
         DC    CL1' '                                                   06852000
         DC    AL3(0)                                                   06853000
         DC    AL1(0)                                                   06854000
         DC    CL1' '                                                   06855000
         DC    H'0'                                                     06856000
         DC    H'0'                                                     06857000
         DC    H'0'                                                     06858000
         ORG   PDSARRAY+160                                             06859000
         ORG   PDSARRAY+160                                             06860000
         DC    CL1'N'                                                   06861000
         DC    AL3(0)                                                   06862000
         DC    CL1' '                                                   06863000
         DC    AL3(0)                                                   06864000
         DC    AL1(0)                                                   06865000
         DC    CL1' '                                                   06866000
         DC    H'0'                                                     06867000
         DC    H'0'                                                     06868000
         DC    H'0'                                                     06869000
         ORG   PDSARRAY+176                                             06870000
         ORG   PDSARRAY+176                                             06871000
         DC    CL1'N'                                                   06872000
         DC    AL3(0)                                                   06873000
         DC    CL1' '                                                   06874000
         DC    AL3(0)                                                   06875000
         DC    AL1(0)                                                   06876000
         DC    CL1' '                                                   06877000
         DC    H'0'                                                     06878000
         DC    H'0'                                                     06879000
         DC    H'0'                                                     06880000
         ORG   PDSARRAY+192                                             06881000
         ORG   PDSARRAY+192                                             06882000
         DC    CL1'N'                                                   06883000
         DC    AL3(0)                                                   06884000
         DC    CL1' '                                                   06885000
         DC    AL3(0)                                                   06886000
         DC    AL1(0)                                                   06887000
         DC    CL1' '                                                   06888000
         DC    H'0'                                                     06889000
         DC    H'0'                                                     06890000
         DC    H'0'                                                     06891000
         ORG   PDSARRAY+208                                             06892000
         ORG   PDSARRAY+208                                             06893000
         DC    CL1'N'                                                   06894000
         DC    AL3(0)                                                   06895000
         DC    CL1' '                                                   06896000
         DC    AL3(0)                                                   06897000
         DC    AL1(0)                                                   06898000
         DC    CL1' '                                                   06899000
         DC    H'0'                                                     06900000
         DC    H'0'                                                     06901000
         DC    H'0'                                                     06902000
         ORG   PDSARRAY+224                                             06903000
SAVMGP   DS    6CL12                                                    06904000
INOUT    DC    6AL1(0)                                                  06905000
SAVDSID  DS    6AL1                                                     06906000
SAVCCADS DC    6AL1(0)                                                  06907000
SAVRETRN DS    6AL1                                                     06908000
IOHNDLRS DC    AL4(HISTPRTN)                                            06909000
         DC    AL4(CDSRTN)                                              06910000
         DC    AL4(SCR1RTN)                                             06911000
         DC    AL4(SCR2RTN)                                             06912000
         DC    AL4(MACRTN)                                              06913000
         DC    AL4(PTSRTN)                                              06914000
         DC    AL4(JCLINRTN)                                            06915000
         DC    AL4(CDSDIRTN)                                            06916000
         DC    AL4(CNTLRTN)                                             06917000
         DC    AL4(PTFINRTN)                                            06918000
         DC    AL4(PRTRTN)                                              06919000
         DC    AL4(ACDSRTN)                                             06920000
         DC    AL4(ACDSDRTN)                                            06921000
         DC    AL4(DDDELRTN)                                            06922000
         DC    AL4(PUNRTN)                                              06923000
         DC    AL4(BADEXIT)                                             06924000
         DC    AL4(BADEXIT)                                             06925000
         DC    AL4(MTSRTN)                                              06926000
         DC    AL4(MTSDRTN)                                             06927000
         DC    AL4(SYSRTN)                                              06928000
         DC    AL4(BADEXIT)                                             06929000
         DC    AL4(SRCRTN)                                              06930000
         DC    AL4(PTSDRTN)                                             06931000
         DC    AL4(ANYDDRTN)                                            06932000
         DC    AL4(JFCBRTN)                                             06933000
         DC    AL4(STSRTN)                                              06934000
         DC    AL4(STSDRTN)                                             06935000
         DC    AL4(CRQRTN)                                              06936000
         DC    AL4(CRQDRTN)                                             06937000
         DC    AL4(ACRQRTN)                                             06938000
         DC    AL4(ACRQDRTN)                                            06939000
         DC    AL4(LRFRTN)                                              06940000
         DC    AL4(SCDSRTN)                                             06941000
         DC    AL4(SCDSDRTN)                                            06942000
         DC    AL4(WK1RTN)                                              06943000
         DC    AL4(WK2RTN)                                              06944000
         DC    AL4(WK3RTN)                                              06945000
         DC    AL4(WK4RTN)                                              06946000
         DC    AL4(WK5RTN)                                              06947000
         DC    A(0)                                                     06948000
         DC    AL4(RPTRTN)                                              06949000
         DC    AL4(LSTRTN)                                              06950000
ERRSAVE2 DS    3CL64                                                    06951000
HMASMIO  CSECT                                                          06952000
*                                   /* SAVE AREA DECLARES    @ZA12350*/ 06953000
IOSAVE   DS    0F                   /* BDY ALIGNMENT         @ZA12350*/ 06954000
         DS    6CL72                /* MAIN IO SAVE AREAS    @ZA12350*/ 06955000
WTSAVE   DS    0F                   /* BDY ALIGNMENT         @ZA12350*/ 06956000
         DS    6CL72                /* WRITE RTN SAVE AREAS  @ZA12350*/ 06957000
HMASMIO  CSECT                                                          06958000
*                                             /*             @Z67SP00*/ 06959000
         DS    0F                   /* ALIGN ON FULL WORD    @Z40SP00*/ 06960000
JFCBOPEN DS    176C                 /* WORK JFCB             @Z40SP00*/ 06961000
         DS    0F                   /* ALIGN ON FULL WORD    @Z40SP00*/ 06962000
JFCBSAV1 DS    176C                 /* SAVED JFCB 1          @Z67SP00*/ 06963000
         DS    0F                   /* ALIGN OF FULL WORD    @Z40SP00*/ 06964000
JFCBSAV2 DS    176C                 /* SAVED JFCB 2          @Z67SP00*/ 06965000
         DS    0F                   /* ALIGN OF FULL WORD    @Z40SP00*/ 06966000
JFCBPTF  DS    176C                 /* SAVED JFCB FOR PTFIN  @Z67SP00*/ 06967000
HMASMIO  CSECT                                                          06968000
*                                   /*                       @ZD00003*/ 06969000
         READ  IODECB,SF,MF=L       DECB FOR READS AND WRITES           06970000
OPENLIST DS    0F                                                       06971000
OPHISTI  OPEN  (HISTDCB,OUTIN),MF=L                                     06972000
OPCDSI   OPEN  (CDSIDCB,INPUT),MF=L                                     06973000
OPSCR1I  OPEN  (SCR1DCB,INPUT),MF=L                                     06974000
OPSCR2I  OPEN  (SCR2DCB,INPUT),MF=L                                     06975000
OPMACI   OPEN  (MACDCB,INPUT),MF=L                                      06976000
OPPTSI   OPEN  (PTSIDCB,INPUT),MF=L                                     06977000
OPSGTI   OPEN  (SGTDCB,INPUT),MF=L                                      06978000
OPCDSDI  OPEN  (CDSDDCB,INPUT),MF=L                                     06979000
OPCDSDO  OPEN  (CDSDDCB,OUTPUT),MF=L                                    06980000
OPCONTI  OPEN  (CONTDCB,INPUT),MF=L                                     06981000
OPPTFI   OPEN  (PTFDCB,INPUT),MF=L                                      06982000
OPPRTO   OPEN  (PRTDCB,OUTPUT),MF=L                                     06983000
OPACDSI  OPEN  (ACDSIDCB,INPUT),MF=L                                    06984000
OPACDSO  OPEN  (ACDSODCB,OUTPUT),MF=L                                   06985000
OPACDSDI OPEN  (ACDSDDCB,INPUT),MF=L                                    06986000
OPACDSDO OPEN  (ACDSDDCB,OUTPUT),MF=L /*                     @ZD00006*/ 06987000
OPHISTO  OPEN  (HISTDCB,OUTIN),MF=L                                     06988000
OPCDSO   OPEN  (CDSODCB,OUTPUT),MF=L                                    06989000
OPSCR1O  OPEN  (SCR1DCB,OUTPUT),MF=L                                    06990000
OPSCR2O  OPEN  (SCR2DCB,OUTPUT),MF=L                                    06991000
OPPTSO   OPEN  (PTSODCB,OUTPUT),MF=L                                    06992000
OPSTNDI  OPEN  (STNDIDCB,INPUT),MF=L  /*                     @Z40SP00*/ 06993000
OPSTNDO  OPEN  (STNDODCB,OUTPUT),MF=L                                   06994000
OPPUNO   OPEN  (PUNODCB,OUTPUT),MF=L  /*                     @Z67SP00*/ 06995000
OPMTSI   OPEN  (MTSIDCB,INPUT),MF=L   /*                     @Z40SP00*/ 06996000
OPMTSO   OPEN  (MTSODCB,OUTPUT),MF=L  /*                     @Z40SP00*/ 06997000
OPMTSDI  OPEN  (MTSDDCB,INPUT),MF=L                                     06998000
OPSYSO   OPEN  (SYSODCB,OUTPUT),MF=L                                    06999000
OPSRCI   OPEN  (SRCDCB,INPUT),MF=L                                      07000000
OPPTSDI  OPEN  (PTSDDCB,INPUT),MF=L                                     07001000
OPJFCBI  OPEN  (JFCBDCB,INPUT),MF=L /*                       @Z40SP00*/ 07002000
OPJFCBO  OPEN  (JFCBDCB,OUTPUT),MF=L /*                      @Z40SP00*/ 07003000
OPSTSI   OPEN  (STSIDCB,INPUT),MF=L   /*                     @Z40SP00*/ 07004000
OPSTSO   OPEN  (STSODCB,OUTPUT),MF=L  /*                     @Z40SP00*/ 07005000
OPSTSDI  OPEN  (STSDDCB,INPUT),MF=L                                     07006000
OPCRQI   OPEN  (CRQIDCB,INPUT),MF=L /*                       @Z67SP00*/ 07007000
OPCRQO   OPEN  (CRQODCB,OUTPUT),MF=L /*                      @Z67SP00*/ 07008000
OPCRQDI  OPEN  (CRQDIDCB,INPUT),MF=L /*                      @Z67SP00*/ 07009000
OPACRQI  OPEN  (ACRQIDCB,INPUT),MF=L /*                      @Z67SP00*/ 07010000
OPACRQO  OPEN  (ACRQODCB,OUTPUT),MF=L /*                     @Z67SP00*/ 07011000
OPACRQDI OPEN  (ACRQDDCB,INPUT),MF=L /*                      @Z67SP00*/ 07012000
OPLRFI   OPEN  (LRFIDCB,INPUT),MF=L /*                       @Z67SP00*/ 07013000
OPSCDSI  OPEN  (SCDSIDCB,INPUT),MF=L  /*                     @Z67SP00*/ 07014000
OPSCDSO  OPEN  (SCDSODCB,OUTPUT),MF=L /*                     @Z67SP00*/ 07015000
OPSCDSDI OPEN  (SCDSDDCB,INPUT),MF=L  /*                     @Z67SP00*/ 07016000
OPWK1I   OPEN  (WK1IDCB,INPUT),MF=L   /*                     @Z67SP00*/ 07017000
OPWK1O   OPEN  (WK1ODCB,OUTPUT),MF=L  /*                     @Z67SP00*/ 07018000
OPWK2I   OPEN  (WK2IDCB,INPUT),MF=L   /*                     @Z67SP00*/ 07019000
OPWK2O   OPEN  (WK2ODCB,OUTPUT),MF=L  /*                     @Z67SP00*/ 07020000
OPWK3I   OPEN  (WK3IDCB,INPUT),MF=L   /*                     @Z67SP00*/ 07021000
OPWK3O   OPEN  (WK3ODCB,OUTPUT),MF=L  /*                     @Z67SP00*/ 07022000
OPWK4I   OPEN  (WK4IDCB,INPUT),MF=L   /*                     @Z67SP00*/ 07023000
OPWK4O   OPEN  (WK4ODCB,OUTPUT),MF=L  /*                     @Z67SP00*/ 07024000
OPWK5I   OPEN  (WK5IDCB,INPUT),MF=L   /*                     @Z67SP00*/ 07025000
OPWK5O   OPEN  (WK5ODCB,OUTPUT),MF=L  /*                     @Z67SP00*/ 07026000
OPRPTO   OPEN  (RPTODCB,OUTPUT),MF=L  /*                     @Z67SP00*/ 07027000
OPLSTO   OPEN  (LSTODCB,OUTPUT),MF=L  /*                     @Z67SP00*/ 07028000
HMASMIO  CSECT                                                          07029000
         EJECT                                                          07030000
DIRUDCB  DCB   DEVD=DA,DSORG=PS,MACRF=(R,W),DDNAME=SMPCDS,RECFM=FB,    X07031000
               LRECL=256,BLKSIZE=256,SYNAD=BSAMERR,KEYLEN=8,           X07032000
               EXLST=JFCEXL                                  @SA76154   07033000
         EJECT                                                          07034000
HISTDCB  DCB   DEVD=DA,DSORG=PS,MACRF=(R,W),DDNAME=SMPLOG,BLKSIZE=260, X07035000
               RECFM=U,SYNAD=BSAMERR,EXLST=JFCEXL                       07036000
         EJECT                                                          07037000
CDSIDCB  DCB   DEVD=DA,DSORG=PO,MACRF=R,DDNAME=SMPCDS,LRECL=80,        X07038000
               RECFM=FB,SYNAD=BPAMERR,EXLST=JFCEXL,KEYLEN=0             07039000
         EJECT                                                          07040000
CDSODCB  DCB   DEVD=DA,DSORG=PO,MACRF=W,DDNAME=SMPCDS,LRECL=80,        X07041000
               RECFM=FB,SYNAD=BPAMERR,EXLST=JFCEXL,KEYLEN=0             07042000
         EJECT                                                          07043000
ACDSIDCB DCB   DEVD=DA,DSORG=PO,MACRF=R,DDNAME=SMPACDS,LRECL=80,       X07044000
               RECFM=FB,SYNAD=BPAMERR,EXLST=JFCEXL,KEYLEN=0             07045000
          EJECT                                                         07046000
ACDSODCB DCB   DEVD=DA,DSORG=PO,MACRF=W,DDNAME=SMPACDS,LRECL=80,       X07047000
               RECFM=FB,SYNAD=BPAMERR,EXLST=JFCEXL,KEYLEN=0             07048000
         EJECT                                                          07049000
SCR1DCB  DCB   DEVD=DA,DSORG=PS,MACRF=(GM,PM),DDNAME=SYSUT1,LRECL=80,  X07050000
               RECFM=FB,EXLST=JFCEXL,SYNAD=QSAMERR                      07051000
         EJECT                                                          07052000
SCR2DCB  DCB   DEVD=DA,DSORG=PS,MACRF=(R,W),DDNAME=SYSUT1,LRECL=256,   X07053000
               RECFM=F,SYNAD=BSAMERR,BLKSIZE=256,KEYLEN=8,             X07054000
               EXLST=JFCEXL                                  @SA76154   07055000
         EJECT                                                          07056000
MACDCB   DCB   DEVD=DA,DSORG=PO,MACRF=R,DDNAME=XXXXXXXX,EXLST=JFCEXL,  X07057000
               LRECL=80,RECFM=FB,SYNAD=BPAMERR                          07058000
         EJECT                                                          07059000
PTSIDCB  DCB   DEVD=DA,DSORG=PO,MACRF=R,DDNAME=SMPPTS,LRECL=80,        X07060000
               RECFM=FB,EXLST=JFCEXL,SYNAD=BPAMERR                      07061000
         EJECT                                                          07062000
PTSODCB  DCB   DEVD=DA,DSORG=PO,MACRF=W,DDNAME=SMPPTS,LRECL=80,        X07063000
               RECFM=FB,EXLST=JFCEXL,SYNAD=BPAMERR                      07064000
         EJECT                                                          07065000
SGTDCB   DCB   DEVD=DA,DSORG=PS,MACRF=GM,DDNAME=SMPJCLIN,LRECL=80,     X07066000
               RECFM=FB,EXLST=JFCEXL,SYNAD=QSAMERR                      07067000
         EJECT                                                          07068000
CDSDDCB  DCB   DEVD=DA,DSORG=PS,MACRF=(GM,PM),DDNAME=SMPCDS,RECFM=FB,  X07069000
               LRECL=256,BLKSIZE=256,EXLST=JFCEXL,                     X07070000
               SYNAD=QSAMERR                                 @XA11694   07071000
         EJECT                                                          07072000
ACDSDDCB DCB   DEVD=DA,DSORG=PS,MACRF=(GM,PM),DDNAME=SMPACDS,RECFM=FB, X07073000
               LRECL=256,BLKSIZE=256,EXLST=JFCEXL,                     X07074000
               SYNAD=QSAMERR                                 @XA11694   07075000
         EJECT                                                          07076000
CONTDCB  DCB   DEVD=DA,DSORG=PS,MACRF=GM,DDNAME=SMPCNTL,LRECL=80,      X07077000
               RECFM=FB,EXLST=JFCEXL,SYNAD=QSAMERR           @ZD00003   07078000
         EJECT                                                          07079000
PTFDCB   DCB   DEVD=DA,DSORG=PS,MACRF=GM,DDNAME=SMPPTFIN,RECFM=FB,     X07080000
               EXLST=JFCEXL,SYNAD=QSAMERR,EROPT=ACC          @Z67SP00   07081000
PTFDCBND EQU   *                                             @Z67SP00   07082000
         EJECT                                                          07083000
SVPTFDCB DCB   DEVD=DA,DSORG=PS,MACRF=GM,DDNAME=SMPPTFIN,LRECL=80,     X07084000
               RECFM=FB,EXLST=JFCEXL,SYNAD=QSAMERR,EROPT=ACC @Z67SP00   07085000
         EJECT                                                          07086000
PRTDCB   DCB   DEVD=DA,DSORG=PS,MACRF=PM,DDNAME=SMPOUT,RECFM=FBA,      X07087000
               LRECL=121,EXLST=JFCEXL,SYNAD=QSAMERR          @ZD00003   07088000
         EJECT                                                          07089000
STNDIDCB DCB   DEVD=DA,DSORG=PO,MACRF=R,DDNAME=XXXXXXXX,               X07090000
               SYNAD=BPAMERR,EXLST=JFCEXL                    @Z40SP00   07091000
         EJECT                                                          07092000
STNDODCB DCB   DEVD=DA,DSORG=PO,MACRF=W,DDNAME=XXXXXXXX,               X07093000
               SYNAD=BPAMERR,EXLST=JFCEXL                    @Z40SP00   07094000
         EJECT                                                          07095000
PUNODCB  DCB   DEVD=DA,DSORG=PS,MACRF=PM,DDNAME=SMPPUNCH,RECFM=FB,     X07096000
               LRECL=80,EXLST=JFCEXL,SYNAD=QSAMERR           @Z67SP00   07097000
         EJECT                                                          07098000
MTSIDCB  DCB   DEVD=DA,DSORG=PO,MACRF=R,DDNAME=SMPMTS,RECFM=FB,        X07099000
               LRECL=80,EXLST=JFCEXL,SYNAD=BPAMERR           @Z40SP00   07100000
         EJECT                                                          07101000
MTSODCB  DCB   DEVD=DA,DSORG=PO,MACRF=W,DDNAME=SMPMTS,LRECL=80,        X07102000
               RECFM=FB,EXLST=JFCEXL,SYNAD=BPAMERR           @Z40SP00   07103000
         EJECT                                                          07104000
MTSDDCB  DCB   DEVD=DA,DSORG=PS,MACRF=GM,DDNAME=SMPMTS,RECFM=FB,       X07105000
               LRECL=256,BLKSIZE=256,EXLST=JFCEXL,                     X07106000
               SYNAD=QSAMERR                                 @Z40SP00   07107000
         EJECT                                                          07108000
SYSODCB  DCB   DEVD=DA,DSORG=PS,MACRF=PM,DDNAME=SYSPRINT,RECFM=FBA,    X07109000
               LRECL=121,EXLST=JFCEXL,SYNAD=QSAMERR          @ZD00003   07110000
         EJECT                                                          07111000
SRCDCB   DCB   DEVD=DA,DSORG=PO,MACRF=R,DDNAME=XXXXXXXX,RECFM=FB,      X07112000
               LRECL=80,SYNAD=BPAMERR,EXLST=JFCEXL           @Z40SP00   07113000
         EJECT                                                          07114000
PTSDDCB  DCB   DEVD=DA,DSORG=PS,MACRF=GM,DDNAME=SMPPTS,RECFM=FB,       X07115000
               LRECL=256,BLKSIZE=256,EXLST=JFCEXL,                     X07116000
               SYNAD=QSAMERR                                 @Z40SP00   07117000
         EJECT                                                          07118000
JFCBDCB  DCB   DEVD=DA,DSORG=PO,MACRF=(R,W),DDNAME=XXXXXXXX,           X07119000
               EXLST=JFCEXL                                  @Z40SP00   07120000
         EJECT                                                          07121000
STSIDCB  DCB   DEVD=DA,DSORG=PO,MACRF=R,DDNAME=SMPSTS,RECFM=FB,        X07122000
               LRECL=80,EXLST=JFCEXL,SYNAD=BPAMERR           @Z40SP00   07123000
         EJECT                                                          07124000
STSODCB  DCB   DEVD=DA,DSORG=PO,MACRF=W,DDNAME=SMPSTS,LRECL=80,        X07125000
               RECFM=FB,EXLST=JFCEXL,SYNAD=BPAMERR           @Z40SP00   07126000
         EJECT                                                          07127000
STSDDCB  DCB   DEVD=DA,DSORG=PS,MACRF=GM,DDNAME=SMPSTS,RECFM=FB,       X07128000
               LRECL=256,BLKSIZE=256,EXLST=JFCEXL,                     X07129000
               SYNAD=QSAMERR                                 @Z40SP00   07130000
         EJECT                                                          07131000
CRQIDCB  DCB   DEVD=DA,DSORG=PO,MACRF=R,DDNAME=SMPCRQ,RECFM=FB,        X07132000
               LRECL=80,EXLST=JFCEXL,SYNAD=BPAMERR           @Z67SP00   07133000
         EJECT                                                          07134000
CRQODCB  DCB   DEVD=DA,DSORG=PO,MACRF=W,DDNAME=SMPCRQ,LRECL=80,        X07135000
               RECFM=FB,EXLST=JFCEXL,SYNAD=BPAMERR           @Z67SP00   07136000
         EJECT                                                          07137000
CRQDIDCB DCB   DEVD=DA,DSORG=PS,MACRF=GM,DDNAME=SMPCRQ,RECFM=FB,       X07138000
               LRECL=256,BLKSIZE=256,EXLST=JFCEXL,                     X07139000
               SYNAD=QSAMERR                                 @Z67SP00   07140000
         EJECT                                                          07141000
ACRQIDCB DCB   DEVD=DA,DSORG=PO,MACRF=R,DDNAME=SMPACRQ,RECFM=FB,       X07142000
               LRECL=80,EXLST=JFCEXL,SYNAD=BPAMERR           @Z67SP00   07143000
         EJECT                                                          07144000
ACRQODCB DCB   DEVD=DA,DSORG=PO,MACRF=W,DDNAME=SMPACRQ,LRECL=80,       X07145000
               RECFM=FB,EXLST=JFCEXL,SYNAD=BPAMERR           @Z67SP00   07146000
         EJECT                                                          07147000
ACRQDDCB DCB   DEVD=DA,DSORG=PS,MACRF=GM,DDNAME=SMPACRQ,RECFM=FB,      X07148000
               LRECL=256,BLKSIZE=256,EXLST=JFCEXL,                     X07149000
               SYNAD=QSAMERR                                 @Z67SP00   07150000
         EJECT                                                          07151000
LRFIDCB  DCB   DEVD=DA,DSORG=PO,MACRF=R,DDNAME=SMPTLIB,                X07152000
               EXLST=JFCEXL                                  @Z67SP00   07153000
         EJECT                                                          07154000
SCDSIDCB DCB   DEVD=DA,DSORG=PO,MACRF=R,DDNAME=SMPSCDS,LRECL=80,       X07155000
               RECFM=FB,SYNAD=BPAMERR,EXLST=JFCEXL,KEYLEN=0  @Z67SP00   07156000
         EJECT                                                          07157000
SCDSODCB DCB   DEVD=DA,DSORG=PO,MACRF=W,DDNAME=SMPSCDS,LRECL=80,       X07158000
               RECFM=FB,SYNAD=BPAMERR,EXLST=JFCEXL,KEYLEN=0  @Z67SP00   07159000
         EJECT                                                          07160000
SCDSDDCB DCB   DEVD=DA,DSORG=PS,MACRF=(GM,PM),DDNAME=SMPSCDS,RECFM=FB, X07161000
               LRECL=256,BLKSIZE=256,EXLST=JFCEXL,                     X07162000
               SYNAD=QSAMERR                                 @Z67SP00   07163000
         EJECT                                                          07164000
WK1IDCB  DCB   DEVD=DA,DSORG=PO,MACRF=R,DDNAME=SMPWRK1,LRECL=80,       X07165000
               RECFM=FB,EXLST=JFCEXL,SYNAD=BPAMERR           @Z67SP00   07166000
         EJECT                                                          07167000
WK1ODCB  DCB   DEVD=DA,DSORG=PO,MACRF=W,DDNAME=SMPWRK1,LRECL=80,       X07168000
               RECFM=FB,EXLST=JFCEXL,SYNAD=BPAMERR           @Z67SP00   07169000
         EJECT                                                          07170000
WK2IDCB  DCB   DEVD=DA,DSORG=PO,MACRF=R,DDNAME=SMPWRK2,LRECL=80,       X07171000
               RECFM=FB,EXLST=JFCEXL,SYNAD=BPAMERR           @Z67SP00   07172000
         EJECT                                                          07173000
WK2ODCB  DCB   DEVD=DA,DSORG=PO,MACRF=W,DDNAME=SMPWRK2,LRECL=80,       X07174000
               RECFM=FB,EXLST=JFCEXL,SYNAD=BPAMERR           @Z67SP00   07175000
         EJECT                                                          07176000
WK3IDCB  DCB   DEVD=DA,DSORG=PO,MACRF=R,DDNAME=SMPWRK3,LRECL=80,       X07177000
               RECFM=FB,EXLST=JFCEXL,SYNAD=BPAMERR           @Z67SP00   07178000
         EJECT                                                          07179000
WK3ODCB  DCB   DEVD=DA,DSORG=PO,MACRF=W,DDNAME=SMPWRK3,LRECL=80,       X07180000
               RECFM=FB,EXLST=JFCEXL,SYNAD=BPAMERR           @Z67SP00   07181000
         EJECT                                                          07182000
WK4IDCB  DCB   DEVD=DA,DSORG=PO,MACRF=R,DDNAME=SMPWRK4,LRECL=80,       X07183000
               RECFM=FB,EXLST=JFCEXL,SYNAD=BPAMERR           @Z67SP00   07184000
         EJECT                                                          07185000
WK4ODCB  DCB   DEVD=DA,DSORG=PO,MACRF=W,DDNAME=SMPWRK4,LRECL=80,       X07186000
               RECFM=FB,EXLST=JFCEXL,SYNAD=BPAMERR           @Z67SP00   07187000
         EJECT                                                          07188000
WK5IDCB  DCB   DEVD=DA,DSORG=PO,MACRF=R,DDNAME=SMPWRK5,BLKSIZE=7294,   X07189000
               RECFM=U,EXLST=JFCEXL,SYNAD=BPAMERR            @Z67SP00   07190000
         EJECT                                                          07191000
WK5ODCB  DCB   DEVD=DA,DSORG=PO,MACRF=W,DDNAME=SMPWRK5,BLKSIZE=7294,   X07192000
               RECFM=U,EXLST=JFCEXL,SYNAD=BPAMERR            @Z67SP00   07193000
         EJECT                                                          07194000
RPTODCB  DCB   DEVD=DA,DSORG=PS,MACRF=PM,DDNAME=SMPRPT,RECFM=FA,       X07195000
               LRECL=121,EXLST=JFCEXL,SYNAD=QSAMERR          @Z67SP00   07196000
         EJECT                                                          07197000
LSTODCB  DCB   DEVD=DA,DSORG=PS,MACRF=PM,DDNAME=SMPLIST,RECFM=FA,      X07198000
               LRECL=121,EXLST=JFCEXL,SYNAD=QSAMERR          @Z67SP00   07199000
         EJECT                                                          07200000
HMASMIO  CSECT                                                          07201000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       07202000
@01      EQU   01                                                       07203000
@02      EQU   02                                                       07204000
@03      EQU   03                                                       07205000
@04      EQU   04                                                       07206000
@05      EQU   05                                                       07207000
@06      EQU   06                                                       07208000
@07      EQU   07                                                       07209000
@08      EQU   08                                                       07210000
@09      EQU   09                                                       07211000
@10      EQU   10                                                       07212000
@11      EQU   11                                                       07213000
@12      EQU   12                                                       07214000
@13      EQU   13                                                       07215000
@14      EQU   14                                                       07216000
@15      EQU   15                                                       07217000
IOPPTR   EQU   @05                                                      07218000
DCBPTR   EQU   @02                                                      07219000
R0       EQU   @00                                                      07220000
R1       EQU   @01                                                      07221000
IOPREG   EQU   @03                                                      07222000
SIZE     EQU   @04                                                      07223000
LENREG   EQU   @04                                                      07224000
R13      EQU   @13                                                      07225000
RTNREG   EQU   @14                                                      07226000
RTNCODE  EQU   @15                                                      07227000
         EXTRN HMASMCCA                                                 07228000
CVTPTR   EQU   16                                                       07229000
CCADSIDA EQU   0                                                        07230000
CCATYPEA EQU   0                                                        07231000
CCABLDLA EQU   0                                                        07232000
@NM00025 EQU   CCABLDLA                                                 07233000
CCABLDLL EQU   0                                                        07234000
@NM00027 EQU   CCABLDLL                                                 07235000
CCALKDRC EQU   @NM00027+20                                              07236000
@NM00029 EQU   CCABLDLL+124                                             07237000
CCAASMRC EQU   @NM00029+20                                              07238000
@NM00031 EQU   CCABLDLL+248                                             07239000
CCACPYRC EQU   @NM00031+20                                              07240000
@NM00033 EQU   CCABLDLL+372                                             07241000
CCACOMRC EQU   @NM00033+20                                              07242000
@NM00035 EQU   CCABLDLL+496                                             07243000
CCAZAPRC EQU   @NM00035+20                                              07244000
@NM00037 EQU   CCABLDLL+620                                             07245000
CCASUPRC EQU   @NM00037+20                                              07246000
@NM00039 EQU   CCABLDLL+744                                             07247000
CCAUPDRC EQU   @NM00039+20                                              07248000
CCABLDLM EQU   0                                                        07249000
CCABELMT EQU   CCABLDLM+4                                               07250000
CCABMPOS EQU   CCABELMT                                                 07251000
HMASMIOP EQU   0                                                        07252000
IOPDSID  EQU   HMASMIOP                                                 07253000
IOPFUNCT EQU   HMASMIOP+1                                               07254000
IOPRETRN EQU   HMASMIOP+2                                               07255000
IOPTYPE  EQU   HMASMIOP+3                                               07256000
IOPNAME  EQU   HMASMIOP+4                                               07257000
@NM00043 EQU   HMASMIOP+12                                              07258000
@NM00044 EQU   @NM00043                                                 07259000
IOPSEQNO EQU   @NM00043+8                                               07260000
IOPDDNAM EQU   HMASMIOP+24                                              07261000
IOPBUFAD EQU   HMASMIOP+52                                              07262000
IOPDRMAP EQU   HMASMIOP+56                                              07263000
IOPINAME EQU   IOPDRMAP                                                 07264000
IOPINAM  EQU   IOPINAME                                                 07265000
IOPITYP  EQU   IOPINAM                                                  07266000
IOPTTR   EQU   IOPDRMAP+8                                               07267000
IOPUSERL EQU   IOPDRMAP+11                                              07268000
IOPALIS  EQU   IOPUSERL                                                 07269000
IOPEND   EQU   IOPDRMAP+12                                              07270000
IOPLMCTL EQU   0                                                        07271000
IOPQSMIF EQU   0                                                        07272000
@NM00154 EQU   IOPQSMIF                                                 07273000
IOPQSMLS EQU   IOPQSMIF+8                                               07274000
IOPQSMNM EQU   IOPQSMLS                                                 07275000
IOPBS02  EQU   0                                                        07276000
IOPBS04  EQU   0                                                        07277000
IOPBAPF  EQU   IOPBS04                                                  07278000
XTNDCHAR EQU   0                                                        07279000
HMASMPRL EQU   0                                                        07280000
PRLRLEN  EQU   HMASMPRL                                                 07281000
PRLSPAN  EQU   HMASMPRL+2                                               07282000
PRLFLGS  EQU   PRLSPAN                                                  07283000
PRLHEAD  EQU   PRLFLGS                                                  07284000
PRLHEADO EQU   PRLFLGS                                                  07285000
PRLBLANK EQU   PRLFLGS                                                  07286000
PRLDATE  EQU   HMASMPRL+4                                               07287000
PRLHDADR EQU   PRLDATE                                                  07288000
PRLTIME  EQU   HMASMPRL+7                                               07289000
PRLEND   EQU   HMASMPRL+10                                              07290000
CVTMAP   EQU   0                                                        07291000
CVTTCBP  EQU   CVTMAP                                                   07292000
CVTDAR   EQU   CVTMAP+72                                                07293000
CVTFLGS1 EQU   CVTDAR                                                   07294000
CVTDCB   EQU   CVTMAP+116                                               07295000
CVTIERLC EQU   CVTMAP+144                                               07296000
CVTOPTA  EQU   CVTMAP+182                                               07297000
CVTOPTB  EQU   CVTMAP+183                                               07298000
CVTGTF   EQU   CVTMAP+236                                               07299000
CVTGTFST EQU   CVTGTF                                                   07300000
CVTGTFS  EQU   CVTGTFST                                                 07301000
CVTSTATE EQU   CVTGTFST                                                 07302000
CVTTMODE EQU   CVTGTFST                                                 07303000
CVTFORM  EQU   CVTGTFST                                                 07304000
CVTAQAVT EQU   CVTMAP+240                                               07305000
CVTTCMFG EQU   CVTAQAVT                                                 07306000
CVTVOLM2 EQU   CVTMAP+244                                               07307000
CVTTATA  EQU   CVTVOLM2                                                 07308000
CVTTSKS  EQU   CVTTATA                                                  07309000
CVTVOLF2 EQU   CVTTSKS                                                  07310000
CVTTAT   EQU   CVTTATA+1                                                07311000
CVTATER  EQU   CVTMAP+248                                               07312000
CVTEXT1  EQU   CVTMAP+252                                               07313000
CVTPURG  EQU   CVTMAP+260                                               07314000
CVTQMSG  EQU   CVTMAP+268                                               07315000
CVTDMSR  EQU   CVTMAP+272                                               07316000
CVTRSV37 EQU   CVTDMSR                                                  07317000
CVTDMSRF EQU   CVTRSV37                                                 07318000
CVTERPV  EQU   CVTMAP+316                                               07319000
CVTINTLA EQU   CVTMAP+320                                               07320000
CVTAPF   EQU   CVTMAP+324                                               07321000
CVTEXT2  EQU   CVTMAP+328                                               07322000
CVTHJES  EQU   CVTMAP+332                                               07323000
CVTPGSIA EQU   CVTMAP+348                                               07324000
CVTA1F1  EQU   CVTMAP+356                                               07325000
CVTSYSK  EQU   CVTMAP+357                                               07326000
CVTVOLM1 EQU   CVTMAP+380                                               07327000
CVTVOLF1 EQU   CVTVOLM1                                                 07328000
CVTXTNT1 EQU   0                                                        07329000
CVTXTNT2 EQU   0                                                        07330000
CVTDSSV  EQU   CVTXTNT2                                                 07331000
CVTFLGBT EQU   CVTXTNT2+5                                               07332000
CVTQID   EQU   CVTXTNT2+24                                              07333000
CVTRV400 EQU   CVTXTNT2+52                                              07334000
CVTRV409 EQU   CVTXTNT2+53                                              07335000
CVTATCVT EQU   CVTXTNT2+64                                              07336000
CVTRV429 EQU   CVTXTNT2+84                                              07337000
CVTRV438 EQU   CVTXTNT2+85                                              07338000
CVTRV457 EQU   CVTXTNT2+112                                             07339000
CVTRV466 EQU   CVTXTNT2+113                                             07340000
CVTFIX   EQU   0                                                        07341000
CVTRELNO EQU   CVTFIX+252                                               07342000
TCBFIX   EQU   0                                                        07343000
TCBFRS   EQU   TCBFIX                                                   07344000
TCB      EQU   0                                                        07345000
TCBPIE   EQU   TCB+4                                                    07346000
TCBPMASK EQU   TCBPIE                                                   07347000
TCBCMP   EQU   TCB+16                                                   07348000
TCBCMPF  EQU   TCBCMP                                                   07349000
TCBCPP   EQU   TCBCMPF                                                  07350000
TCBSTCC  EQU   TCBCMPF                                                  07351000
TCBCDBL  EQU   TCBCMPF                                                  07352000
TCBCWTO  EQU   TCBCMPF                                                  07353000
TCBCIND  EQU   TCBCMPF                                                  07354000
TCBCMSG  EQU   TCBCMPF                                                  07355000
TCBTRN   EQU   TCB+20                                                   07356000
TCBABF   EQU   TCBTRN                                                   07357000
TCBMSS   EQU   TCB+24                                                   07358000
TCBPKF   EQU   TCB+28                                                   07359000
TCBFLGS  EQU   TCB+29                                                   07360000
TCBFLGS1 EQU   TCBFLGS                                                  07361000
TCBFLGS2 EQU   TCBFLGS+1                                                07362000
TCBFLGS3 EQU   TCBFLGS+2                                                07363000
TCBFLGS4 EQU   TCBFLGS+3                                                07364000
TCBFLGS5 EQU   TCBFLGS+4                                                07365000
TCBABWF  EQU   TCBFLGS5                                                 07366000
TCBJPQ   EQU   TCB+44                                                   07367000
TCBPURGE EQU   TCBJPQ                                                   07368000
TCBGRS   EQU   TCB+48                                                   07369000
TCBFSA   EQU   TCB+112                                                  07370000
TCBTME   EQU   TCB+120                                                  07371000
TCBJSTCB EQU   TCB+124                                                  07372000
TCBTSFLG EQU   TCB+148                                                  07373000
TCBTSTSK EQU   TCBTSFLG                                                 07374000
TCBSTAB  EQU   TCB+160                                                  07375000
TCBNSTAE EQU   TCBSTAB                                                  07376000
TCBTCT   EQU   TCB+164                                                  07377000
TCBTCTGF EQU   TCBTCT                                                   07378000
TCBSCNDY EQU   TCB+172                                                  07379000
TCBNDSP  EQU   TCBSCNDY                                                 07380000
TCBNDSP1 EQU   TCBNDSP+1                                                07381000
TCBNDSP2 EQU   TCBNDSP+2                                                07382000
TCBNDSP3 EQU   TCBNDSP+3                                                07383000
TCBJSCB  EQU   TCB+180                                                  07384000
TCBRECDE EQU   TCBJSCB                                                  07385000
TCBEXT1  EQU   TCB+196                                                  07386000
TCBBITS  EQU   TCB+200                                                  07387000
TCBNDSP4 EQU   TCBBITS                                                  07388000
TCBNDSP5 EQU   TCBBITS+1                                                07389000
TCBFLGS6 EQU   TCBBITS+2                                                07390000
TCBFLGS7 EQU   TCBBITS+3                                                07391000
TCBDAR   EQU   TCB+204                                                  07392000
TCBDARC  EQU   TCBDAR                                                   07393000
TCBEXT2  EQU   TCB+208                                                  07394000
TCBXSCT  EQU   TCB+240                                                  07395000
TCBXSCT1 EQU   TCBXSCT                                                  07396000
TCBFOE   EQU   TCB+244                                                  07397000
TCBESTAE EQU   TCB+264                                                  07398000
TCBESTRM EQU   TCBESTAE+1                                               07399000
TCBFBYT1 EQU   TCB+276                                                  07400000
TCBFBYT2 EQU   TCB+277                                                  07401000
TCBRV124 EQU   TCB+278                                                  07402000
TCBRV133 EQU   TCB+279                                                  07403000
TCBXTNT2 EQU   0                                                        07404000
TCBGTF   EQU   TCBXTNT2                                                 07405000
TCBTFLG  EQU   TCBGTF                                                   07406000
TCBRV146 EQU   TCBXTNT2+28                                              07407000
TCBRV155 EQU   TCBXTNT2+29                                              07408000
TCBRV164 EQU   TCBXTNT2+30                                              07409000
TCBRV173 EQU   TCBXTNT2+31                                              07410000
IEZJSCB  EQU   0                                                        07411000
JSCBSEC1 EQU   IEZJSCB+188                                              07412000
JSCHPCE  EQU   JSCBSEC1+4                                               07413000
JSCBTCBP EQU   JSCBSEC1+20                                              07414000
JSCBDCB  EQU   JSCBSEC1+36                                              07415000
JSCBOPTS EQU   JSCBSEC1+48                                              07416000
JSCBSWT1 EQU   JSCBSEC1+55                                              07417000
JSCBWTP  EQU   JSCBSEC1+64                                              07418000
JSCBWTFG EQU   JSCBWTP                                                  07419000
JSCBEND1 EQU   IEZJSCB+260                                              07420000
IHADCB   EQU   0                                                        07421000
IHADCS00 EQU   0                                                        07422000
DCBRELAD EQU   IHADCS00                                                 07423000
DCBFDAD  EQU   IHADCS00+5                                               07424000
IHADCS01 EQU   0                                                        07425000
DCBDVTBL EQU   IHADCS01                                                 07426000
IHADCS11 EQU   0                                                        07427000
DCBRELB  EQU   IHADCS11                                                 07428000
DCBKEYLE EQU   DCBRELB                                                  07429000
DCBREL   EQU   DCBRELB+1                                                07430000
DCBBUFCB EQU   IHADCS11+4                                               07431000
DCBDSORG EQU   IHADCS11+10                                              07432000
DCBDSRG1 EQU   DCBDSORG                                                 07433000
DCBDSGU  EQU   DCBDSRG1                                                 07434000
DCBDSRG2 EQU   DCBDSORG+1                                               07435000
DCBIOBAD EQU   IHADCS11+12                                              07436000
DCBODEB  EQU   DCBIOBAD                                                 07437000
DCBLNP   EQU   DCBODEB                                                  07438000
DCBQSLM  EQU   DCBLNP                                                   07439000
DCBIOBAA EQU   DCBODEB+1                                                07440000
IHADCS50 EQU   0                                                        07441000
DCBSVCXL EQU   IHADCS50                                                 07442000
DCBEODAD EQU   IHADCS50+4                                               07443000
DCBBFALN EQU   DCBEODAD                                                 07444000
DCBHIARC EQU   DCBBFALN                                                 07445000
DCBBFTEK EQU   DCBHIARC                                                 07446000
DCBBFT   EQU   DCBBFTEK                                                 07447000
DCBEODA  EQU   DCBEODAD+1                                               07448000
DCBEXLST EQU   IHADCS50+8                                               07449000
DCBRECFM EQU   DCBEXLST                                                 07450000
DCBRECLA EQU   DCBRECFM                                                 07451000
DCBRECL  EQU   DCBRECLA                                                 07452000
IHADCS24 EQU   0                                                        07453000
DCBDDNAM EQU   IHADCS24                                                 07454000
DCBOFLGS EQU   IHADCS24+8                                               07455000
DCBOFLWR EQU   DCBOFLGS                                                 07456000
DCBOFOPN EQU   DCBOFLGS                                                 07457000
DCBIFLG  EQU   IHADCS24+9                                               07458000
DCBMACR  EQU   IHADCS24+10                                              07459000
DCBMACR1 EQU   DCBMACR                                                  07460000
DCBMRECP EQU   DCBMACR1                                                 07461000
DCBMRFE  EQU   DCBMACR1                                                 07462000
DCBMRGET EQU   DCBMRFE                                                  07463000
DCBMRAPG EQU   DCBMACR1                                                 07464000
DCBMRRD  EQU   DCBMRAPG                                                 07465000
DCBMRCI  EQU   DCBMACR1                                                 07466000
DCBMRMVG EQU   DCBMRCI                                                  07467000
DCBMRLCG EQU   DCBMACR1                                                 07468000
DCBMRABC EQU   DCBMACR1                                                 07469000
DCBMRPT1 EQU   DCBMRABC                                                 07470000
DCBMRSBG EQU   DCBMRPT1                                                 07471000
DCBMRCRL EQU   DCBMACR1                                                 07472000
DCBMRCHK EQU   DCBMRCRL                                                 07473000
DCBMRRDX EQU   DCBMRCHK                                                 07474000
DCBMRDMG EQU   DCBMACR1                                                 07475000
DCBMACR2 EQU   DCBMACR+1                                                07476000
DCBMRPUT EQU   DCBMACR2                                                 07477000
DCBMRWRT EQU   DCBMACR2                                                 07478000
DCBMRMVP EQU   DCBMACR2                                                 07479000
DCBMR5WD EQU   DCBMACR2                                                 07480000
DCBMRLDM EQU   DCBMR5WD                                                 07481000
DCBMRLCP EQU   DCBMRLDM                                                 07482000
DCBMR4WD EQU   DCBMACR2                                                 07483000
DCBMRPT2 EQU   DCBMR4WD                                                 07484000
DCBMRTMD EQU   DCBMRPT2                                                 07485000
DCBMR3WD EQU   DCBMACR2                                                 07486000
DCBMRCTL EQU   DCBMR3WD                                                 07487000
DCBMRSTK EQU   DCBMRCTL                                                 07488000
DCBMR1WD EQU   DCBMACR2                                                 07489000
DCBMRSWA EQU   DCBMR1WD                                                 07490000
DCBMRDMD EQU   DCBMRSWA                                                 07491000
IHADCS25 EQU   0                                                        07492000
DCBMACRF EQU   IHADCS25+2                                               07493000
DCBMACF1 EQU   DCBMACRF                                                 07494000
DCBMFFE  EQU   DCBMACF1                                                 07495000
DCBMFGET EQU   DCBMFFE                                                  07496000
DCBMFAPG EQU   DCBMACF1                                                 07497000
DCBMFRD  EQU   DCBMFAPG                                                 07498000
DCBMFCI  EQU   DCBMACF1                                                 07499000
DCBMFMVG EQU   DCBMFCI                                                  07500000
DCBMFLCG EQU   DCBMACF1                                                 07501000
DCBMFABC EQU   DCBMACF1                                                 07502000
DCBMFPT1 EQU   DCBMFABC                                                 07503000
DCBMFSBG EQU   DCBMFPT1                                                 07504000
DCBMFCRL EQU   DCBMACF1                                                 07505000
DCBMFCHK EQU   DCBMFCRL                                                 07506000
DCBMFDMG EQU   DCBMACF1                                                 07507000
DCBMACF2 EQU   DCBMACRF+1                                               07508000
DCBMFPUT EQU   DCBMACF2                                                 07509000
DCBMFWRT EQU   DCBMACF2                                                 07510000
DCBMFMVP EQU   DCBMACF2                                                 07511000
DCBMF5WD EQU   DCBMACF2                                                 07512000
DCBMFLDM EQU   DCBMF5WD                                                 07513000
DCBMFLCP EQU   DCBMFLDM                                                 07514000
DCBMF4WD EQU   DCBMACF2                                                 07515000
DCBMFPT2 EQU   DCBMF4WD                                                 07516000
DCBMFTMD EQU   DCBMFPT2                                                 07517000
DCBMF3WD EQU   DCBMACF2                                                 07518000
DCBMFCTL EQU   DCBMF3WD                                                 07519000
DCBMFSTK EQU   DCBMFCTL                                                 07520000
DCBMF1WD EQU   DCBMACF2                                                 07521000
DCBMFSWA EQU   DCBMF1WD                                                 07522000
DCBMFDMD EQU   DCBMFSWA                                                 07523000
DCBDEBAD EQU   IHADCS25+4                                               07524000
DCBIFLGS EQU   DCBDEBAD                                                 07525000
DCBDEBA  EQU   DCBDEBAD+1                                               07526000
IHADCS26 EQU   0                                                        07527000
DCBWRITE EQU   IHADCS26                                                 07528000
IHADCS36 EQU   0                                                        07529000
DCBGERR  EQU   IHADCS36                                                 07530000
DCBPERR  EQU   DCBGERR                                                  07531000
DCBCHECK EQU   DCBPERR                                                  07532000
DCBOPTCD EQU   DCBCHECK                                                 07533000
DCBOPTH  EQU   DCBOPTCD                                                 07534000
DCBOPTO  EQU   DCBOPTH                                                  07535000
DCBOPTZ  EQU   DCBOPTCD                                                 07536000
DCBGERRA EQU   DCBCHECK+1                                               07537000
DCBPERRA EQU   DCBGERRA                                                 07538000
DCBSYNAD EQU   IHADCS36+4                                               07539000
DCBCIND1 EQU   IHADCS36+8                                               07540000
DCBCIND2 EQU   IHADCS36+9                                               07541000
DCBBLKSI EQU   IHADCS36+10                                              07542000
DCBIOBA  EQU   IHADCS36+16                                              07543000
DCBCICB  EQU   IHADCS36+20                                              07544000
IHADCS52 EQU   0                                                        07545000
DCBDIRCT EQU   IHADCS52                                                 07546000
DCBQSWS  EQU   DCBDIRCT                                                 07547000
DCBUSASI EQU   DCBQSWS                                                  07548000
DCBQADFS EQU   DCBUSASI                                                 07549000
DCBBUFOF EQU   DCBDIRCT+1                                               07550000
IHADCS38 EQU   0                                                        07551000
DCBEOBR  EQU   IHADCS38                                                 07552000
DCBLRECL EQU   IHADCS38+10                                              07553000
DCBPOINT EQU   IHADCS38+12                                              07554000
DCBCNTRL EQU   DCBPOINT                                                 07555000
IOBPREFX EQU   0                                                        07556000
IOBCFLG1 EQU   IOBPREFX                                                 07557000
IOBSTDRD EQU   0                                                        07558000
IOBFLAG1 EQU   IOBSTDRD                                                 07559000
IOBCYCCK EQU   IOBFLAG1                                                 07560000
IOBRSTRT EQU   IOBFLAG1                                                 07561000
IOBFLAG2 EQU   IOBSTDRD+1                                               07562000
IOBPURGE EQU   IOBFLAG2                                                 07563000
IOBRDHA0 EQU   IOBFLAG2                                                 07564000
IOBSENS0 EQU   IOBSTDRD+2                                               07565000
IOBS0B7  EQU   IOBSENS0                                                 07566000
IOBSENS1 EQU   IOBSTDRD+3                                               07567000
IOBECBPT EQU   IOBSTDRD+4                                               07568000
IOBFLAG3 EQU   IOBSTDRD+8                                               07569000
IOBFL3   EQU   IOBFLAG3                                                 07570000
IOBCNC   EQU   IOBFL3                                                   07571000
IOBICL   EQU   IOBFL3                                                   07572000
IOBCSW   EQU   IOBSTDRD+9                                               07573000
IOBIOCSW EQU   IOBCSW                                                   07574000
IOBSTBYT EQU   IOBIOCSW+3                                               07575000
IOBUSTAT EQU   IOBSTBYT                                                 07576000
IOBCSTAT EQU   IOBSTBYT+1                                               07577000
IOBSTART EQU   IOBSTDRD+16                                              07578000
IOBDCBPT EQU   IOBSTDRD+20                                              07579000
IOBFLAG4 EQU   IOBDCBPT                                                 07580000
IOBRESTR EQU   IOBSTDRD+24                                              07581000
IOBINCAM EQU   IOBSTDRD+28                                              07582000
IOBBTAMF EQU   IOBINCAM                                                 07583000
INFMJFCB EQU   0                                                        07584000
JFCBDSNM EQU   INFMJFCB                                                 07585000
JFCBELNM EQU   INFMJFCB+44                                              07586000
JFCBTSDM EQU   INFMJFCB+52                                              07587000
JFCNWRIT EQU   JFCBTSDM                                                 07588000
JFCFCBID EQU   INFMJFCB+56                                              07589000
JFCBFRID EQU   JFCFCBID                                                 07590000
JFCBLTYP EQU   INFMJFCB+66                                              07591000
JFCSL    EQU   JFCBLTYP                                                 07592000
JFCBOTTR EQU   INFMJFCB+67                                              07593000
JFCBUFOF EQU   JFCBOTTR                                                 07594000
JFCBFLSQ EQU   JFCBOTTR+1                                               07595000
JFCFUNC  EQU   JFCBFLSQ                                                 07596000
JFCBMASK EQU   INFMJFCB+72                                              07597000
JFCBOPS1 EQU   JFCBMASK                                                 07598000
JFCBFLG1 EQU   JFCBMASK+5                                               07599000
JFCOPEN  EQU   JFCBFLG1                                                 07600000
JFCBFLG2 EQU   JFCBMASK+6                                               07601000
JFCDEFER EQU   JFCBFLG2                                                 07602000
JFCBIND1 EQU   INFMJFCB+86                                              07603000
JFCPDS   EQU   JFCBIND1                                                 07604000
JFCBIND2 EQU   INFMJFCB+87                                              07605000
JFCDISP  EQU   JFCBIND2                                                 07606000
JFCAMPTR EQU   INFMJFCB+88                                              07607000
JFCBUFRQ EQU   JFCAMPTR                                                 07608000
JFCBUFNO EQU   JFCBUFRQ                                                 07609000
JFCBGNCP EQU   JFCAMPTR+1                                               07610000
JFCBHIAR EQU   JFCBGNCP                                                 07611000
JFCBFALN EQU   JFCBHIAR                                                 07612000
JFCBFTEK EQU   JFCBFALN                                                 07613000
JFCBBFTA EQU   JFCBFTEK                                                 07614000
JFCEROPT EQU   INFMJFCB+92                                              07615000
JFCTRTCH EQU   INFMJFCB+93                                              07616000
DCBEROPT EQU   0                                                        07617000
DCBERACC EQU   DCBEROPT                                                 07618000
DSIBUFR  EQU   0                                                        07619000
DSOBUFR  EQU   0                                                        07620000
PDSARRY1 EQU   0                                                        07621000
PDSDEBAD EQU   PDSARRY1+1                                               07622000
EOFTTR   EQU   PDSARRY1+5                                               07623000
PDSSW    EQU   PDSARRY1+8                                               07624000
WRITESW  EQU   PDSSW                                                    07625000
NOTESW   EQU   PDSSW                                                    07626000
DSBFCNTI EQU   PDSARRY1+10                                              07627000
DSBFCNTO EQU   PDSARRY1+12                                              07628000
DSBFSIZI EQU   PDSARRY1+14                                              07629000
PRNTARRY EQU   0                                                        07630000
HEADADDR EQU   PRNTARRY                                                 07631000
PAGENO   EQU   PRNTARRY+40                                              07632000
HEADCT   EQU   PRNTARRY+42                                              07633000
LINECT   EQU   PRNTARRY+44                                              07634000
TXTIBUFR EQU   0                                                        07635000
@NM00255 EQU   0                                                        07636000
CVTNTCB  EQU   @NM00255                                                 07637000
ENQRTNAR EQU   0                                                        07638000
ENQRC    EQU   ENQRTNAR+3                                               07639000
LOGICREC EQU   0                                                        07640000
CCWS     EQU   0                                                        07641000
CCWOP    EQU   CCWS                                                     07642000
CCWFLAG  EQU   CCWS+4                                                   07643000
CCWDATA  EQU   CCWFLAG                                                  07644000
IOSVAREA EQU   0                                                        07645000
WTSVAREA EQU   0                                                        07646000
SVAREAS  EQU   0                                                        07647000
SVBACK   EQU   SVAREAS+4                                                07648000
SVFWRD   EQU   SVAREAS+8                                                07649000
OUTIN    EQU   0                                                        07650000
JFCBAREA EQU   0                                                        07651000
IOROUT   EQU   0                                                        07652000
SYNJOBN  EQU   0                                                        07653000
IOPBS01  EQU   0                                                        07654000
IOPBS03  EQU   0                                                        07655000
CCAFBUFR EQU   HMASMCCA+4                                               07656000
CCACBFIA EQU   CCAFBUFR                                                 07657000
CCACBFOA EQU   CCAFBUFR+4                                               07658000
CCAVBFIA EQU   CCAFBUFR+8                                               07659000
CCAVBFOA EQU   CCAFBUFR+12                                              07660000
CCAPBFIA EQU   CCAFBUFR+16                                              07661000
CCAPBFOA EQU   CCAFBUFR+20                                              07662000
CCAQBFIA EQU   CCAFBUFR+24                                              07663000
CCAQBFOA EQU   CCAFBUFR+28                                              07664000
CCAWBFIA EQU   CCAFBUFR+32                                              07665000
CCAWBFOA EQU   CCAFBUFR+36                                              07666000
CCATBFIA EQU   CCAFBUFR+40                                              07667000
CCA4BFIA EQU   CCAFBUFR+44                                              07668000
CCA4BFOA EQU   CCAFBUFR+48                                              07669000
CCATBFSZ EQU   CCAFBUFR+76                                              07670000
CCACBFMX EQU   CCAFBUFR+92                                              07671000
CCAABFMX EQU   CCAFBUFR+94                                              07672000
CCAVBFMX EQU   CCAFBUFR+96                                              07673000
CCAPBFMX EQU   CCAFBUFR+98                                              07674000
CCAMBFMX EQU   CCAFBUFR+100                                             07675000
CCASBFMX EQU   CCAFBUFR+102                                             07676000
CCAQBFMX EQU   CCAFBUFR+104                                             07677000
CCAXBFMX EQU   CCAFBUFR+106                                             07678000
CCA1BFMX EQU   CCAFBUFR+108                                             07679000
CCA2BFMX EQU   CCAFBUFR+110                                             07680000
CCA3BFMX EQU   CCAFBUFR+112                                             07681000
CCA4BFMX EQU   CCAFBUFR+114                                             07682000
CCATBFMX EQU   CCAFBUFR+116                                             07683000
CCADSAD  EQU   CCAFBUFR+124                                             07684000
CCATPAD  EQU   CCAFBUFR+128                                             07685000
CCAFLAG7 EQU   CCAFBUFR+132                                             07686000
CCAFIOP  EQU   HMASMCCA+140                                             07687000
CCAPESIZ EQU   CCAFIOP+4                                                07688000
CCAFSYS  EQU   HMASMCCA+148                                             07689000
CCAPGLEN EQU   CCAFSYS+8                                                07690000
CCASREL  EQU   CCAFSYS+12                                               07691000
CCAFLAGA EQU   CCAFSYS+21                                               07692000
CCAFSTA  EQU   HMASMCCA+188                                             07693000
CCAFICT  EQU   HMASMCCA+192                                             07694000
CCAFPGM  EQU   HMASMCCA+208                                             07695000
CCABLDLP EQU   CCAFPGM                                                  07696000
CCADBLDL EQU   CCAFPGM+4                                                07697000
CCAFGTP  EQU   HMASMCCA+224                                             07698000
CCASEGTP EQU   CCAFGTP                                                  07699000
@NM00009 EQU   HMASMCCA+244                                             07700000
CCAFFUNC EQU   HMASMCCA+264                                             07701000
CCAFLAG1 EQU   CCAFFUNC+8                                               07702000
CCAAPPLY EQU   CCAFLAG1                                                 07703000
CCAACCPT EQU   CCAFLAG1                                                 07704000
CCARES   EQU   CCAFLAG1                                                 07705000
CCAUPDJ  EQU   CCAFLAG1                                                 07706000
CCALIST  EQU   CCAFLAG1                                                 07707000
CCACNV   EQU   CCAFLAG1+1                                               07708000
CCAFLAG2 EQU   CCAFFUNC+11                                              07709000
CCATERM  EQU   CCAFLAG2                                                 07710000
CCACHECK EQU   CCAFLAG2                                                 07711000
CCAFPROC EQU   HMASMCCA+276                                             07712000
CCAFLAG3 EQU   CCAFPROC                                                 07713000
CCAFDIS  EQU   HMASMCCA+278                                             07714000
CCAFLAG4 EQU   CCAFDIS                                                  07715000
CCACDSIS EQU   CCAFLAG4                                                 07716000
CCAACDIS EQU   CCAFLAG4                                                 07717000
CCACRQIS EQU   CCAFLAG4                                                 07718000
CCAACRIS EQU   CCAFLAG4                                                 07719000
CCAFLAG5 EQU   CCAFDIS+1                                                07720000
CCACDSOS EQU   CCAFLAG5                                                 07721000
CCAACDOS EQU   CCAFLAG5                                                 07722000
CCACRQOS EQU   CCAFLAG5                                                 07723000
CCAACROS EQU   CCAFLAG5                                                 07724000
CCAFLAG6 EQU   CCAFDIS+2                                                07725000
CCAFCNV  EQU   HMASMCCA+281                                             07726000
CCAFLAG8 EQU   CCAFCNV                                                  07727000
CCAFCTL  EQU   HMASMCCA+282                                             07728000
CCAFLAG9 EQU   CCAFCTL                                                  07729000
CCADATE  EQU   CCAFCTL+1                                                07730000
CCATIME  EQU   CCAFCTL+4                                                07731000
CCAFDSNG EQU   HMASMCCA+298                                             07732000
CCAFLAGB EQU   CCAFDSNG                                                 07733000
CCALOGNG EQU   CCAFLAGB                                                 07734000
CCAOUTNG EQU   CCAFLAGB                                                 07735000
CCACURDS EQU   CCAFDSNG+2                                               07736000
CCACURDD EQU   CCAFDSNG+3                                               07737000
PASSIOP  EQU   0                                                        07738000
NOTETTR  EQU   0                                                        07739000
IOPUDATA EQU   IOPEND                                                   07740000
IOPINAM3 EQU   IOPINAME                                                 07741000
@NM00050 EQU   IOPINAM3                                                 07742000
IOPSTCMP EQU   IOPUDATA                                                 07743000
IOPONAME EQU   IOPSTCMP                                                 07744000
IOPOTYPE EQU   IOPSTCMP+8                                               07745000
IOPNNAME EQU   IOPSTCMP+9                                               07746000
IOPNTYPE EQU   IOPSTCMP+17                                              07747000
IOPDYNDT EQU   IOPUDATA                                                 07748000
IOPDSN   EQU   IOPDYNDT                                                 07749000
IOPSPACE EQU   IOPDYNDT+44                                              07750000
IOPSPRIM EQU   IOPSPACE                                                 07751000
IOPDTYPE EQU   IOPDYNDT+50                                              07752000
IOPDMAC  EQU   IOPDTYPE                                                 07753000
IOPDSRC  EQU   IOPDTYPE                                                 07754000
IOPDJCL  EQU   IOPDTYPE                                                 07755000
IOPNTMAX EQU   IOPDRMAP                                                 07756000
IOPNTMAP EQU   IOPDRMAP                                                 07757000
IOPCDMAP EQU   IOPNTMAP                                                 07758000
IOPPTMAP EQU   IOPCDMAP                                                 07759000
IOPSCMAP EQU   IOPPTMAP                                                 07760000
IOPDIRCT EQU   IOPSCMAP+12                                              07761000
IOPCDMAX EQU   IOPDIRCT                                                 07762000
IOPCQMAP EQU   IOPDRMAP                                                 07763000
@NM00061 EQU   IOPUDATA                                                 07764000
IOPBLKSI EQU   @NM00061                                                 07765000
IOPVLSER EQU   @NM00061+2                                               07766000
IOPTPSEQ EQU   @NM00061+8                                               07767000
@NM00062 EQU   IOPUDATA                                                 07768000
IOPUSED  EQU   @NM00062                                                 07769000
IOPALLOC EQU   @NM00062+4                                               07770000
IOPASMNT EQU   IOPUDATA                                                 07771000
IOPASMDR EQU   IOPASMNT                                                 07772000
IOPABUNT EQU   IOPASMDR+1                                               07773000
IOPLMDNT EQU   IOPUDATA                                                 07774000
IOPLMDDR EQU   IOPLMDNT                                                 07775000
IOPLMLEP EQU   IOPLMDDR+1                                               07776000
IOPLMDF1 EQU   IOPLMLEP                                                 07777000
IOPFLGS2 EQU   IOPLMDF1                                                 07778000
IOPLMDF2 EQU   IOPLMLEP+1                                               07779000
IOPLMDF3 EQU   IOPLMLEP+2                                               07780000
IOPLMDF4 EQU   IOPLMLEP+3                                               07781000
IOPLMDF5 EQU   IOPLMDDR+5                                               07782000
IOPFLGS3 EQU   IOPLMDF5                                                 07783000
IOPLMDFX EQU   IOPLMDNT+24                                              07784000
@NM00071 EQU   IOPLMDFX                                                 07785000
IOPLNTRY EQU   IOPLMDFX+8                                               07786000
IOPLSYS  EQU   IOPLNTRY                                                 07787000
IOPSYSLB EQU   IOPLSYS                                                  07788000
IOPMACNT EQU   IOPUDATA                                                 07789000
IOPMACDR EQU   IOPMACNT                                                 07790000
IOPRMIDE EQU   IOPMACDR+1                                               07791000
IOPRMST  EQU   IOPRMIDE+7                                               07792000
IOPFMIDE EQU   IOPMACDR+9                                               07793000
IOPMACFX EQU   IOPMACNT+24                                              07794000
IOPBUNT  EQU   IOPMACFX                                                 07795000
IOPMCEND EQU   IOPMACNT+104                                             07796000
IOPMACVR EQU   IOPMCEND                                                 07797000
IOPMCENT EQU   IOPMACVR                                                 07798000
IOPMCDTA EQU   IOPMCENT                                                 07799000
IOPMCASM EQU   IOPMCDTA                                                 07800000
IOPMACID EQU   IOPMCASM                                                 07801000
IOPMACST EQU   IOPMCASM+7                                               07802000
IOPMCIND EQU   IOPMCENT+8                                               07803000
IOPEOFNT EQU   IOPUDATA                                                 07804000
IOPSRCNT EQU   IOPUDATA                                                 07805000
IOPSRCDR EQU   IOPSRCNT                                                 07806000
@NM00082 EQU   IOPSRCDR+1                                               07807000
@NM00084 EQU   @NM00082+7                                               07808000
@NM00088 EQU   IOPSRCDR+9                                               07809000
IOPSRCFX EQU   IOPSRCNT+24                                              07810000
@NM00092 EQU   IOPSRCFX                                                 07811000
IOPSREND EQU   IOPSRCNT+104                                             07812000
IOPSRCVR EQU   IOPSREND                                                 07813000
IOPSNTRY EQU   IOPSRCVR                                                 07814000
IOPSRDTA EQU   IOPSNTRY                                                 07815000
IOPSRCID EQU   IOPSRDTA                                                 07816000
IOPSRCST EQU   IOPSRDTA+7                                               07817000
IOPMODNT EQU   IOPUDATA                                                 07818000
IOPMODDR EQU   IOPMODNT                                                 07819000
@NM00098 EQU   IOPMODDR+1                                               07820000
@NM00100 EQU   @NM00098+7                                               07821000
@NM00104 EQU   IOPMODDR+9                                               07822000
IOPMODFX EQU   IOPMODNT+24                                              07823000
@NM00108 EQU   IOPMODFX                                                 07824000
IOPMDLEP EQU   IOPMODFX+8                                               07825000
IOPMODF1 EQU   IOPMDLEP                                                 07826000
IOPMODF2 EQU   IOPMDLEP+1                                               07827000
IOPMODF3 EQU   IOPMDLEP+2                                               07828000
IOPMODF4 EQU   IOPMDLEP+3                                               07829000
IOPMDEND EQU   IOPMODNT+104                                             07830000
IOPMODVR EQU   IOPMDEND                                                 07831000
IOPMNTRY EQU   IOPMODVR                                                 07832000
IOPMDDTA EQU   IOPMNTRY                                                 07833000
IOPLMODS EQU   IOPMDDTA                                                 07834000
IOPMODID EQU   IOPLMODS                                                 07835000
IOPMODST EQU   IOPLMODS+7                                               07836000
IOPDLBNT EQU   IOPUDATA                                                 07837000
IOPDLBDR EQU   IOPDLBNT                                                 07838000
IOPDLBFX EQU   IOPDLBNT+24                                              07839000
@NM00119 EQU   IOPDLBFX                                                 07840000
IOPDLEND EQU   IOPDLBNT+104                                             07841000
IOPDLBVR EQU   IOPDLEND                                                 07842000
IOPDNTRY EQU   IOPDLBVR                                                 07843000
IOPDSYS  EQU   IOPDNTRY                                                 07844000
IOPSYSNT EQU   IOPUDATA                                                 07845000
IOPSYSDR EQU   IOPSYSNT                                                 07846000
IOPSYSF1 EQU   IOPSYSDR+4                                               07847000
IOPFLGS7 EQU   IOPSYSF1                                                 07848000
IOPSYSFX EQU   IOPSYSNT+24                                              07849000
@NM00126 EQU   IOPSYSFX                                                 07850000
IOPSYEND EQU   IOPSYSNT+184                                             07851000
IOPSYSVR EQU   IOPSYEND                                                 07852000
IOPSYSTR EQU   IOPSYSVR                                                 07853000
IOPSYNTR EQU   IOPSYSTR                                                 07854000
IOPPTFNT EQU   IOPUDATA                                                 07855000
IOPPTFDR EQU   IOPPTFNT                                                 07856000
IOPPSTAT EQU   IOPPTFDR+2                                               07857000
IOPPTFF1 EQU   IOPPSTAT                                                 07858000
IOPFLGS5 EQU   IOPPTFF1                                                 07859000
IOPDUMMP EQU   IOPFLGS5                                                 07860000
IOPPTFF2 EQU   IOPPSTAT+1                                               07861000
IOPPTFF3 EQU   IOPPSTAT+3                                               07862000
IOPPTFFX EQU   IOPPTFNT+24                                              07863000
@NM00135 EQU   IOPPTFFX                                                 07864000
@NM00136 EQU   @NM00135                                                 07865000
IOPPDTES EQU   IOPPTFFX+41                                              07866000
@NM00139 EQU   IOPPDTES                                                 07867000
IOPPTPFX EQU   IOPPDTES+6                                               07868000
IOPDATES EQU   IOPPTPFX                                                 07869000
IOPPFMID EQU   IOPPTFFX+73                                              07870000
IOPPTEND EQU   IOPPTFNT+104                                             07871000
IOPPTFVR EQU   IOPPTEND                                                 07872000
IOPPNTRY EQU   IOPPTFVR                                                 07873000
IOPPMODS EQU   IOPPNTRY                                                 07874000
IOPPTFND EQU   IOPPMODS                                                 07875000
IOPENTNT EQU   IOPUDATA+104                                             07876000
IOPSRLNT EQU   IOPUDATA+104                                             07877000
IOPPRENT EQU   IOPUDATA+104                                             07878000
IOPNPRNT EQU   IOPUDATA+104                                             07879000
IOPSUPNT EQU   IOPUDATA+104                                             07880000
IOPREQNT EQU   IOPUDATA+104                                             07881000
IOPIRQNT EQU   IOPUDATA+104                                             07882000
IOPFIDNT EQU   IOPUDATA+104                                             07883000
IOPDELNT EQU   IOPUDATA+104                                             07884000
IOPVERNT EQU   IOPUDATA+104                                             07885000
IOPSBYNT EQU   IOPUDATA+104                                             07886000
IOPQSMNT EQU   IOPUDATA                                                 07887000
IOPQSMDR EQU   IOPQSMNT                                                 07888000
IOPQFMNT EQU   IOPUDATA                                                 07889000
IOPQFMDR EQU   IOPQFMNT                                                 07890000
IOPQFEND EQU   IOPQFMNT+2                                               07891000
IOPQFMVR EQU   IOPQFEND                                                 07892000
IOPQFMLS EQU   IOPQFMVR                                                 07893000
IOPQFMNM EQU   IOPQFMLS                                                 07894000
IOPPTSYS EQU   IOPUDATA                                                 07895000
IOPPTSDR EQU   IOPPTSYS                                                 07896000
IOPPTSFX EQU   IOPPTSYS+24                                              07897000
IOPDSSPC EQU   IOPPTSFX                                                 07898000
IOPPTFG1 EQU   IOPPTSFX+34                                              07899000
IOPPSEND EQU   IOPPTSYS+1064                                            07900000
IOPPTSVR EQU   IOPPSEND                                                 07901000
IOPPTNTR EQU   IOPPTSVR                                                 07902000
@NM00164 EQU   IOPPTNTR                                                 07903000
IOPPTFMD EQU   @NM00164                                                 07904000
IOPPTREL EQU   IOPPTFMD                                                 07905000
IOPBPDS  EQU   IOPUDATA                                                 07906000
IOPBLEP1 EQU   IOPBPDS+8                                                07907000
IOPBLEP2 EQU   IOPBPDS+9                                                07908000
@NM00168 EQU   IOPBPDS+18                                               07909000
IOPBFTB0 EQU   @NM00168                                                 07910000
IOPBFTB1 EQU   IOPBFTB0                                                 07911000
PRLDATA  EQU   PRLEND                                                   07912000
CVTS01   EQU   CVTPGSIA                                                 07913000
CVTLPDIA EQU   CVTS01+12                                                07914000
CVTDIRST EQU   CVTLPDIA                                                 07915000
CVTSLIDA EQU   CVTS01+24                                                07916000
CVTCTLFG EQU   CVTS01+50                                                07917000
CVTRV210 EQU   CVTS01+424                                               07918000
CVTRV219 EQU   CVTS01+425                                               07919000
CVTRV228 EQU   CVTS01+426                                               07920000
CVTRV237 EQU   CVTS01+427                                               07921000
CVTMFRTR EQU   CVTS01+452                                               07922000
CVTRV262 EQU   CVTS01+468                                               07923000
CVTRV271 EQU   CVTS01+469                                               07924000
CVTRV280 EQU   CVTS01+470                                               07925000
CVTRV289 EQU   CVTS01+471                                               07926000
CVTGSDA  EQU   CVTS01+600                                               07927000
JSCBSEC2 EQU   JSCBEND1                                                 07928000
JSCBSEC3 EQU   JSCBEND1                                                 07929000
JSCBJCT  EQU   JSCBSEC3                                                 07930000
JSCBJCTA EQU   JSCBJCT+1                                                07931000
JSCBASID EQU   JSCBSEC3+8                                               07932000
JSCBJNL  EQU   JSCBSEC3+28                                              07933000
JSCBJJSB EQU   JSCBJNL                                                  07934000
JSCBSUB  EQU   JSCBSEC3+40                                              07935000
JSCSCT   EQU   JSCBSEC3+68                                              07936000
JSCRSV45 EQU   JSCBSEC3+112                                             07937000
JSCRSV46 EQU   JSCRSV45                                                 07938000
JSCRSV47 EQU   JSCRSV45+2                                               07939000
IOBORG01 EQU   IOBPREFX+8                                               07940000
IOBNIOBA EQU   IOBORG01                                                 07941000
IOBNFLG1 EQU   IOBNIOBA                                                 07942000
IOBORG02 EQU   IOBPREFX+8                                               07943000
IOBDQADA EQU   IOBORG02                                                 07944000
IOBDEQIN EQU   IOBDQADA                                                 07945000
IOBORG03 EQU   IOBPREFX+12                                              07946000
IOBORG04 EQU   IOBINCAM                                                 07947000
IOBORG12 EQU   IOBINCAM                                                 07948000
IOBFL4   EQU   IOBORG12                                                 07949000
IOBEXTEN EQU   IOBSTDRD+32                                              07950000
IOBSEEK  EQU   IOBEXTEN                                                 07951000
IOBBB    EQU   IOBSEEK+1                                                07952000
IOBCC    EQU   IOBSEEK+3                                                07953000
IOBHH    EQU   IOBSEEK+5                                                07954000
IOBORG05 EQU   IOBEXTEN                                                 07955000
IOBORG06 EQU   IOBEXTEN                                                 07956000
IOBNXTPT EQU   IOBORG06+4                                               07957000
IOBSTATA EQU   IOBNXTPT                                                 07958000
IOBORG07 EQU   IOBEXTEN+8                                               07959000
W1IEXTEN EQU   IOBORG07                                                 07960000
IOBORG08 EQU   IOBEXTEN+8                                               07961000
IOBINDCT EQU   IOBORG08+4                                               07962000
IOBUNSQR EQU   IOBORG08+5                                               07963000
IOBFCHAD EQU   IOBORG08+8                                               07964000
IOBORG09 EQU   IOBEXTEN+8                                               07965000
IOBDPLAD EQU   IOBORG09+4                                               07966000
IOBDTYPE EQU   IOBORG09+8                                               07967000
IOBDTYP2 EQU   IOBORG09+9                                               07968000
IOBDSTAT EQU   IOBORG09+10                                              07969000
IOBSTAT1 EQU   IOBDSTAT                                                 07970000
IOBORG10 EQU   IOBEXTEN+8                                               07971000
IOBSEEK2 EQU   IOBORG10                                                 07972000
IOBORG11 EQU   IOBEXTEN                                                 07973000
IOBERCT  EQU   IOBORG11                                                 07974000
IOBUCBXV EQU   IOBERCT                                                  07975000
IOBNAME  EQU   IOBORG11+4                                               07976000
IOBORG13 EQU   IOBEXTEN                                                 07977000
IOBSKADR EQU   IOBORG13                                                 07978000
JFCKEYLE EQU   JFCTRTCH                                                 07979000
JFCCODE  EQU   JFCKEYLE                                                 07980000
JFCSTACK EQU   JFCTRTCH                                                 07981000
JFCMODE  EQU   JFCSTACK                                                 07982000
JFCSPPRT EQU   JFCTRTCH                                                 07983000
JFCBABFS EQU   JFCSPPRT+2                                               07984000
JFCLIMCT EQU   JFCBABFS                                                 07985000
JFCDSORG EQU   JFCSPPRT+5                                               07986000
JFCDSRG1 EQU   JFCDSORG                                                 07987000
JFCDSRG2 EQU   JFCDSORG+1                                               07988000
JFCRECFM EQU   JFCSPPRT+7                                               07989000
JFCRCFM  EQU   JFCRECFM                                                 07990000
JFCFMREC EQU   JFCRCFM                                                  07991000
JFCRFB   EQU   JFCRECFM                                                 07992000
JFCOPTCD EQU   JFCSPPRT+8                                               07993000
JFCWVCSP EQU   JFCOPTCD                                                 07994000
JFCWVCIS EQU   JFCWVCSP                                                 07995000
JFCWVCBD EQU   JFCWVCIS                                                 07996000
JFCALLOW EQU   JFCOPTCD                                                 07997000
JFCRSV17 EQU   JFCALLOW                                                 07998000
JFCOVER  EQU   JFCRSV17                                                 07999000
JFCPCIBT EQU   JFCOPTCD                                                 08000000
JFCMAST  EQU   JFCPCIBT                                                 08001000
JFCEXT   EQU   JFCMAST                                                  08002000
JFCBCKPT EQU   JFCOPTCD                                                 08003000
JFCIND   EQU   JFCBCKPT                                                 08004000
JFCRSV18 EQU   JFCOPTCD                                                 08005000
JFCCYL   EQU   JFCRSV18                                                 08006000
JFCACT   EQU   JFCCYL                                                   08007000
JFCREDUC EQU   JFCOPTCD                                                 08008000
JFCRSV19 EQU   JFCREDUC                                                 08009000
JFCRSV20 EQU   JFCRSV19                                                 08010000
JFCRSV21 EQU   JFCOPTCD                                                 08011000
JFCDEL   EQU   JFCRSV21                                                 08012000
JFCOPTJ  EQU   JFCOPTCD                                                 08013000
JFCREORG EQU   JFCOPTJ                                                  08014000
JFCBLKSI EQU   JFCSPPRT+9                                               08015000
JFCBUFSI EQU   JFCBLKSI                                                 08016000
JFCAMSYN EQU   JFCSPPRT+11                                              08017000
JFCLRECL EQU   JFCAMSYN                                                 08018000
JFCNCP   EQU   JFCAMSYN+2                                               08019000
JFCNTM   EQU   JFCAMSYN+3                                               08020000
JFCBFSEQ EQU   JFCNTM                                                   08021000
JFCPCI   EQU   JFCBFSEQ                                                 08022000
JFCRESRV EQU   JFCAMSYN+4                                               08023000
JFCUCSEG EQU   JFCRESRV                                                 08024000
JFCUCSOP EQU   JFCUCSEG+4                                               08025000
JFCOUTLI EQU   JFCUCSEG+5                                               08026000
JFCTHRSH EQU   JFCOUTLI                                                 08027000
JFCCPRI  EQU   JFCTHRSH                                                 08028000
JFCBVOLS EQU   JFCUCSEG+10                                              08029000
JFCBS001 EQU   JFCBVOLS                                                 08030000
JFCBPQTY EQU   JFCBS001+34                                              08031000
JFCBCTRI EQU   JFCBS001+37                                              08032000
JFCBSQTY EQU   JFCBS001+38                                              08033000
JFCFLGS1 EQU   JFCBS001+41                                              08034000
IOBRSCT  EQU   IOBCSW+5                                                 08035000
TIMEAREA EQU   DBLWRD                                                   08036000
TIMEHH   EQU   TIMEAREA+1                                               08037000
TIMEMM   EQU   TIMEAREA+3                                               08038000
TIMETT   EQU   TIMEAREA+5                                               08039000
DATE     EQU   DBLWRD                                                   08040000
DATEYY   EQU   DATE                                                     08041000
DATEDDD  EQU   DATE+2                                                   08042000
DAY      EQU   DATEDDD+2                                                08043000
FREEADDR EQU   GETADDR                                                  08044000
DCBS     EQU   DCBDCLS                                                  08045000
@NM00436 EQU   JFCBOPS1+4                                               08046000
JFCBOPSW EQU   @NM00436                                                 08047000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    08048000
@NM00437 EQU   @NM00436                                                 08049000
@NM00224 EQU   DATEDDD                                                  08050000
@NM00223 EQU   TIMEAREA+7                                               08051000
@NM00222 EQU   TIMEAREA                                                 08052000
JFCBEND  EQU   JFCBS001+58                                              08053000
JFCBSPTN EQU   JFCBS001+57                                              08054000
JFCBVLCT EQU   JFCBS001+56                                              08055000
JFCBDRLH EQU   JFCBS001+53                                              08056000
JFCBSBNM EQU   JFCBS001+50                                              08057000
JFCBABST EQU   JFCBS001+48                                              08058000
JFCBSPNM EQU   JFCBS001+45                                              08059000
JFCBDQTY EQU   JFCBS001+42                                              08060000
JFCBUAFF EQU   JFCFLGS1                                                 08061000
JFCRSV45 EQU   JFCFLGS1                                                 08062000
JFCVRDS  EQU   JFCFLGS1                                                 08063000
JFCBCEOV EQU   JFCFLGS1                                                 08064000
JFCRSV42 EQU   JFCFLGS1                                                 08065000
JFCRSV41 EQU   JFCFLGS1                                                 08066000
JFCTOPEN EQU   JFCFLGS1                                                 08067000
JFCBDLET EQU   JFCFLGS1                                                 08068000
JFCRQID  EQU   JFCBSQTY                                                 08069000
JFCROUND EQU   JFCBCTRI                                                 08070000
JFCALX   EQU   JFCBCTRI                                                 08071000
JFCMIXG  EQU   JFCBCTRI                                                 08072000
JFCONTIG EQU   JFCBCTRI                                                 08073000
JFCRSV29 EQU   JFCBCTRI                                                 08074000
JFCBMSGP EQU   JFCBCTRI                                                 08075000
JFCBSPAC EQU   JFCBCTRI                                                 08076000
JFCRUNIT EQU   JFCBPQTY                                                 08077000
JFCBEXAD EQU   JFCBS001+31                                              08078000
JFCBEXTL EQU   JFCBS001+30                                              08079000
JFCMSVGP EQU   JFCBS001+22                                              08080000
@NM00206 EQU   JFCBS001                                                 08081000
JFCAVOLS EQU   JFCBVOLS                                                 08082000
JFCBNVOL EQU   JFCUCSEG+9                                               08083000
JFCBNTCS EQU   JFCUCSEG+8                                               08084000
JFCSOWA  EQU   JFCOUTLI+1                                               08085000
JFCSEND  EQU   JFCCPRI                                                  08086000
JFCEQUAL EQU   JFCCPRI                                                  08087000
JFCRECV  EQU   JFCCPRI                                                  08088000
JFCRSV34 EQU   JFCCPRI                                                  08089000
JFCRSV33 EQU   JFCCPRI                                                  08090000
JFCRSV55 EQU   JFCCPRI                                                  08091000
JFCRSV54 EQU   JFCCPRI                                                  08092000
JFCRSV53 EQU   JFCCPRI                                                  08093000
JFCRSV27 EQU   JFCUCSOP                                                 08094000
JFCRSV26 EQU   JFCUCSOP                                                 08095000
JFCFCBVR EQU   JFCUCSOP                                                 08096000
JFCFCBAL EQU   JFCUCSOP                                                 08097000
JFCVER   EQU   JFCUCSOP                                                 08098000
JFCRSV25 EQU   JFCUCSOP                                                 08099000
JFCFOLD  EQU   JFCUCSOP                                                 08100000
JFCBEXTP EQU   JFCUCSOP                                                 08101000
JFCUCSID EQU   JFCUCSEG                                                 08102000
JFCINTVL EQU   JFCSPPRT+19                                              08103000
JFCDBUFN EQU   JFCRESRV+3                                               08104000
JFCCYLOF EQU   JFCRESRV+2                                               08105000
JFCRKP   EQU   JFCRESRV                                                 08106000
JFCPCIR2 EQU   JFCPCI                                                   08107000
JFCPCIR1 EQU   JFCPCI                                                   08108000
JFCPCIN2 EQU   JFCPCI                                                   08109000
JFCPCIN1 EQU   JFCPCI                                                   08110000
JFCPCIA2 EQU   JFCPCI                                                   08111000
JFCPCIA1 EQU   JFCPCI                                                   08112000
JFCPCIX2 EQU   JFCPCI                                                   08113000
JFCPCIX1 EQU   JFCPCI                                                   08114000
JFCBUFMX EQU   JFCNCP                                                   08115000
JFCBAXBF EQU   JFCBUFSI                                                 08116000
JFCREL   EQU   JFCREORG                                                 08117000
JFCRSV22 EQU   JFCDEL                                                   08118000
JFCSRCHD EQU   JFCRSV20                                                 08119000
JFCOPTQ  EQU   JFCACT                                                   08120000
JFCFEED  EQU   JFCIND                                                   08121000
JFCCBWU  EQU   JFCEXT                                                   08122000
JFCWUMSG EQU   JFCOVER                                                  08123000
JFCSDNAM EQU   JFCWVCBD                                                 08124000
@NM00205 EQU   JFCRECFM                                                 08125000
JFCCHAR  EQU   JFCRECFM                                                 08126000
JFCRFS   EQU   JFCRECFM                                                 08127000
JFCRFO   EQU   JFCRCFM                                                  08128000
JFCRSV16 EQU   JFCDSRG2                                                 08129000
JFCRSV15 EQU   JFCDSRG2                                                 08130000
JFCORGTR EQU   JFCDSRG2                                                 08131000
JFCORGAM EQU   JFCDSRG2                                                 08132000
JFCRSV13 EQU   JFCDSRG2                                                 08133000
JFCORGTQ EQU   JFCDSRG2                                                 08134000
JFCORGTX EQU   JFCDSRG2                                                 08135000
JFCORGGS EQU   JFCDSRG2                                                 08136000
JFCORGU  EQU   JFCDSRG1                                                 08137000
JFCORGPO EQU   JFCDSRG1                                                 08138000
JFCORGMQ EQU   JFCDSRG1                                                 08139000
JFCORGCQ EQU   JFCDSRG1                                                 08140000
JFCORGCX EQU   JFCDSRG1                                                 08141000
JFCORGDA EQU   JFCDSRG1                                                 08142000
JFCORGPS EQU   JFCDSRG1                                                 08143000
JFCORGIS EQU   JFCDSRG1                                                 08144000
JFCTRKBL EQU   JFCLIMCT+1                                               08145000
@NM00204 EQU   JFCLIMCT                                                 08146000
JFCDEN   EQU   JFCSPPRT+1                                               08147000
JFCPRTSP EQU   JFCSPPRT                                                 08148000
JFCONE   EQU   JFCMODE                                                  08149000
JFCTWO   EQU   JFCMODE                                                  08150000
JFCRSV07 EQU   JFCMODE                                                  08151000
JFCRSV06 EQU   JFCMODE                                                  08152000
JFCMODER EQU   JFCMODE                                                  08153000
JFCMODEO EQU   JFCMODE                                                  08154000
JFCEBCD  EQU   JFCMODE                                                  08155000
JFCBIN   EQU   JFCMODE                                                  08156000
JFCRSV32 EQU   JFCCODE                                                  08157000
JFCTTY   EQU   JFCCODE                                                  08158000
JFCASCII EQU   JFCCODE                                                  08159000
JFCNCR   EQU   JFCCODE                                                  08160000
JFCBUR   EQU   JFCCODE                                                  08161000
JFCFRI   EQU   JFCCODE                                                  08162000
JFCBCD   EQU   JFCCODE                                                  08163000
JFCNOCON EQU   JFCCODE                                                  08164000
IOBSKSS  EQU   IOBSKADR+3                                               08165000
IOBSK0   EQU   IOBSKADR+2                                               08166000
IOBSKTT  EQU   IOBSKADR+1                                               08167000
IOBSKRV  EQU   IOBSKADR                                                 08168000
IOBCSWSV EQU   IOBORG11+17                                              08169000
IOBSENSV EQU   IOBORG11+16                                              08170000
IOBRCD   EQU   IOBORG11+12                                              08171000
IOBMDREC EQU   IOBORG11+8                                               08172000
IOBNAMEA EQU   IOBNAME+1                                                08173000
IOBNAMSZ EQU   IOBNAME                                                  08174000
IOBERCTA EQU   IOBERCT+1                                                08175000
IOBRTYPE EQU   IOBUCBXV                                                 08176000
IOBRDCHP EQU   IOBORG10+20                                              08177000
IOBNEXTA EQU   IOBORG10+16                                              08178000
IOBREADA EQU   IOBORG10+12                                              08179000
IOBBUFC  EQU   IOBORG10+8                                               08180000
IOBSK2R  EQU   IOBSEEK2+7                                               08181000
IOBSK2HH EQU   IOBSEEK2+5                                               08182000
IOBSK2CC EQU   IOBSEEK2+3                                               08183000
IOBSK2BB EQU   IOBSEEK2+1                                               08184000
IOBSK2M  EQU   IOBSEEK2                                                 08185000
IOBCHNPR EQU   IOBORG09+40                                              08186000
IOBDNCRF EQU   IOBORG09+32                                              08187000
IOBRSV35 EQU   IOBORG09+24                                              08188000
IOBDQPTR EQU   IOBORG09+20                                              08189000
IOBRSV34 EQU   IOBORG09+18                                              08190000
IOBDBYTN EQU   IOBORG09+16                                              08191000
IOBDCPND EQU   IOBORG09+12                                              08192000
IOBSTAT2 EQU   IOBDSTAT+1                                               08193000
IOBSIORT EQU   IOBSTAT1                                                 08194000
IOBADDVU EQU   IOBSTAT1                                                 08195000
IOBBUFF  EQU   IOBSTAT1                                                 08196000
IOBENQUE EQU   IOBSTAT1                                                 08197000
IOBPASS2 EQU   IOBSTAT1                                                 08198000
IOBSYNCH EQU   IOBSTAT1                                                 08199000
IOBNEWVL EQU   IOBSTAT1                                                 08200000
IOBABNRM EQU   IOBSTAT1                                                 08201000
IOBRELEX EQU   IOBDTYP2                                                 08202000
IOBADDTY EQU   IOBDTYP2                                                 08203000
IOBTYPE  EQU   IOBDTYP2                                                 08204000
IOBRQUST EQU   IOBDTYP2                                                 08205000
IOBSUFFX EQU   IOBDTYP2                                                 08206000
IOBSBLKL EQU   IOBDTYP2                                                 08207000
IOBSKEY  EQU   IOBDTYP2                                                 08208000
IOBRELBL EQU   IOBDTYPE                                                 08209000
IOBRDEXC EQU   IOBDTYPE                                                 08210000
IOBDYNBF EQU   IOBDTYPE                                                 08211000
IOBACTAD EQU   IOBDTYPE                                                 08212000
IOBFDBCK EQU   IOBDTYPE                                                 08213000
IOBEXTSC EQU   IOBDTYPE                                                 08214000
IOBOVFLO EQU   IOBDTYPE                                                 08215000
IOBVERFY EQU   IOBDTYPE                                                 08216000
IOBDPLB  EQU   IOBDPLAD+1                                               08217000
IOBDAYLI EQU   IOBDPLAD                                                 08218000
IOBDIOBS EQU   IOBORG09+2                                               08219000
IOBDBYTR EQU   IOBORG09                                                 08220000
IOBBCHAD EQU   IOBORG08+12                                              08221000
IOBFCHNB EQU   IOBFCHAD+1                                               08222000
IOBCOUNT EQU   IOBFCHAD                                                 08223000
IOBASYN  EQU   IOBORG08+7                                               08224000
IOBAPP   EQU   IOBORG08+6                                               08225000
IOBRSV32 EQU   IOBUNSQR                                                 08226000
IOBRSV31 EQU   IOBUNSQR                                                 08227000
IOBRSV30 EQU   IOBUNSQR                                                 08228000
IOBKNRWR EQU   IOBUNSQR                                                 08229000
IOBKNWR  EQU   IOBUNSQR                                                 08230000
IOBNTAV2 EQU   IOBUNSQR                                                 08231000
IOBNTAV1 EQU   IOBUNSQR                                                 08232000
IOBCPBSY EQU   IOBUNSQR                                                 08233000
IOBCHNNL EQU   IOBINDCT                                                 08234000
IOBRSV29 EQU   IOBINDCT                                                 08235000
IOBRSV28 EQU   IOBINDCT                                                 08236000
IOBRSV27 EQU   IOBINDCT                                                 08237000
IOBKEYAD EQU   IOBINDCT                                                 08238000
IOBOVPTR EQU   IOBINDCT                                                 08239000
IOBUNSCH EQU   IOBINDCT                                                 08240000
IOBDEQCP EQU   IOBINDCT                                                 08241000
IOBCCWAD EQU   IOBORG08                                                 08242000
W1OEXTEN EQU   W1IEXTEN                                                 08243000
IOBCCW   EQU   IOBORG06+8                                               08244000
IOBNXTPB EQU   IOBNXTPT+1                                               08245000
IOBRSV26 EQU   IOBSTATA                                                 08246000
IOBRSV25 EQU   IOBSTATA                                                 08247000
IOBRSV24 EQU   IOBSTATA                                                 08248000
IOBRSV23 EQU   IOBSTATA                                                 08249000
IOBRSV22 EQU   IOBSTATA                                                 08250000
IOBRSV21 EQU   IOBSTATA                                                 08251000
IOBRSV20 EQU   IOBSTATA                                                 08252000
IOBAVLFL EQU   IOBSTATA                                                 08253000
IOBRSV37 EQU   IOBORG06+1                                               08254000
IOBUCBXG EQU   IOBORG06                                                 08255000
IOBCPA   EQU   IOBORG05+32                                              08256000
IOBERINF EQU   IOBORG05+16                                              08257000
IOBERCCW EQU   IOBORG05+8                                               08258000
IOBSNDPT EQU   IOBORG05+7                                               08259000
IOBRCVPT EQU   IOBORG05+6                                               08260000
IOBWORK  EQU   IOBORG05+1                                               08261000
IOBUCBX  EQU   IOBORG05                                                 08262000
IOBR     EQU   IOBSEEK+7                                                08263000
IOBHH2   EQU   IOBHH+1                                                  08264000
IOBHH1   EQU   IOBHH                                                    08265000
IOBCC2   EQU   IOBCC+1                                                  08266000
IOBCC1   EQU   IOBCC                                                    08267000
IOBBB2   EQU   IOBBB+1                                                  08268000
IOBBB1   EQU   IOBBB                                                    08269000
IOBM     EQU   IOBSEEK                                                  08270000
IOBRSV46 EQU   IOBFL4                                                   08271000
IOBRSV47 EQU   IOBFL4                                                   08272000
IOBENT   EQU   IOBFL4                                                   08273000
IOBEQP   EQU   IOBFL4                                                   08274000
IOBBUS   EQU   IOBFL4                                                   08275000
IOBDCK   EQU   IOBFL4                                                   08276000
IOBREJ   EQU   IOBFL4                                                   08277000
IOBOVR   EQU   IOBFL4                                                   08278000
IOBCRILC EQU   IOBORG04+1                                               08279000
IOBCRDCC EQU   IOBORG04                                                 08280000
IOBGQECB EQU   IOBORG03                                                 08281000
IOBSWAP  EQU   IOBORG02+4                                               08282000
IOBDQADB EQU   IOBDQADA+1                                               08283000
IOBRSV13 EQU   IOBDEQIN                                                 08284000
IOBRSV12 EQU   IOBDEQIN                                                 08285000
IOBRSV11 EQU   IOBDEQIN                                                 08286000
IOBRSV10 EQU   IOBDEQIN                                                 08287000
IOBRSV09 EQU   IOBDEQIN                                                 08288000
IOBRSV08 EQU   IOBDEQIN                                                 08289000
IOBRSV07 EQU   IOBDEQIN                                                 08290000
IOBDEQ   EQU   IOBDEQIN                                                 08291000
IOBNECB  EQU   IOBORG01+4                                               08292000
IOBNIOBB EQU   IOBNIOBA+1                                               08293000
IOBFIRST EQU   IOBNFLG1                                                 08294000
IOBUPERR EQU   IOBNFLG1                                                 08295000
IOBSPAN  EQU   IOBNFLG1                                                 08296000
IOBBKSPC EQU   IOBNFLG1                                                 08297000
IOBUPDAT EQU   IOBNFLG1                                                 08298000
IOBREAD  EQU   IOBNFLG1                                                 08299000
IOBWRITE EQU   IOBNFLG1                                                 08300000
IOBPRTOV EQU   IOBNFLG1                                                 08301000
JSCBEND3 EQU   JSCBSEC3+120                                             08302000
JSCRSV52 EQU   JSCBSEC3+116                                             08303000
JSCRSV51 EQU   JSCRSV47+1                                               08304000
JSCRSV50 EQU   JSCRSV47                                                 08305000
JSCRSV49 EQU   JSCRSV46+1                                               08306000
JSCRSV48 EQU   JSCRSV46                                                 08307000
JSCRSV44 EQU   JSCBSEC3+108                                             08308000
JSCRSV43 EQU   JSCBSEC3+104                                             08309000
JSCRSV42 EQU   JSCBSEC3+100                                             08310000
JSCBASWA EQU   JSCBSEC3+96                                              08311000
JSCBUFPT EQU   JSCBSEC3+92                                              08312000
JSCBACT  EQU   JSCBSEC3+88                                              08313000
JSCBSWSP EQU   JSCBSEC3+87                                              08314000
JSCRSV33 EQU   JSCBSEC3+86                                              08315000
JSCDDNUM EQU   JSCBSEC3+84                                              08316000
JSCRSV53 EQU   JSCBSEC3+82                                              08317000
JSCDDNNO EQU   JSCBSEC3+80                                              08318000
JSCBVATA EQU   JSCBSEC3+76                                              08319000
JSCTMCOR EQU   JSCBSEC3+72                                              08320000
JSCSCTP  EQU   JSCSCT+1                                                 08321000
JSCRSV55 EQU   JSCSCT                                                   08322000
JSCRSV54 EQU   JSCBSEC3+64                                              08323000
JSCDSABQ EQU   JSCBSEC3+60                                              08324000
JSCBSSIB EQU   JSCBSEC3+56                                              08325000
JSCBFRBA EQU   JSCBSEC3+48                                              08326000
JSCRSV28 EQU   JSCBSEC3+46                                              08327000
JSCBSONO EQU   JSCBSEC3+44                                              08328000
JSCBSUBA EQU   JSCBSUB+1                                                08329000
JSCRSV31 EQU   JSCBSUB                                                  08330000
JSCBSMLR EQU   JSCBSEC3+36                                              08331000
JSCBJNLR EQU   JSCBSEC3+32                                              08332000
JSCBJNLA EQU   JSCBJNL+1                                                08333000
JSCBJSBT EQU   JSCBJJSB                                                 08334000
JSCBJSBX EQU   JSCBJJSB                                                 08335000
JSCBJSBA EQU   JSCBJJSB                                                 08336000
JSCBJSBI EQU   JSCBJJSB                                                 08337000
@NM00185 EQU   JSCBJJSB                                                 08338000
JSCBJNLE EQU   JSCBJJSB                                                 08339000
JSCBJNLF EQU   JSCBJJSB                                                 08340000
JSCBJNLN EQU   JSCBJJSB                                                 08341000
@NM00184 EQU   JSCBSEC3+24                                              08342000
JSCBJRBA EQU   JSCBSEC3+16                                              08343000
JSCBIECB EQU   JSCBSEC3+12                                              08344000
JSCRSV25 EQU   JSCBSEC3+10                                              08345000
JSCBTJID EQU   JSCBASID                                                 08346000
JSCBPSCB EQU   JSCBSEC3+4                                               08347000
JSCJCTP  EQU   JSCBJCTA                                                 08348000
JSCRSV24 EQU   JSCBJCT                                                  08349000
JSCBEND2 EQU   JSCBSEC2                                                 08350000
CVTRV628 EQU   CVTS01+728                                               08351000
CVTRV627 EQU   CVTS01+724                                               08352000
CVTRV626 EQU   CVTS01+720                                               08353000
CVTRV625 EQU   CVTS01+716                                               08354000
CVTRV624 EQU   CVTS01+712                                               08355000
CVTRV623 EQU   CVTS01+708                                               08356000
CVTRV622 EQU   CVTS01+704                                               08357000
CVTRV621 EQU   CVTS01+700                                               08358000
CVTIHASU EQU   CVTS01+696                                               08359000
CVTSUSP  EQU   CVTS01+692                                               08360000
CVTT6SVC EQU   CVTS01+688                                               08361000
CVTCDAL  EQU   CVTS01+684                                               08362000
CVTTCTL  EQU   CVTS01+680                                               08363000
CVTRSUME EQU   CVTS01+676                                               08364000
CVTJTERM EQU   CVTS01+672                                               08365000
CVTASMRM EQU   CVTS01+668                                               08366000
CVTTCASP EQU   CVTS01+664                                               08367000
CVT0PT03 EQU   CVTS01+660                                               08368000
CVT0PT0E EQU   CVTS01+656                                               08369000
CVTRV609 EQU   CVTS01+652                                               08370000
CVTCGK   EQU   CVTS01+648                                               08371000
CVTRAC   EQU   CVTS01+644                                               08372000
CVTRV606 EQU   CVTS01+640                                               08373000
CVTRV605 EQU   CVTS01+636                                               08374000
CVTRV604 EQU   CVTS01+632                                               08375000
CVTEFF02 EQU   CVTS01+628                                               08376000
CVTCBBR  EQU   CVTS01+624                                               08377000
CVTSSCR  EQU   CVTS01+620                                               08378000
CVTEVENT EQU   CVTS01+616                                               08379000
CVTCRCA  EQU   CVTS01+612                                               08380000
CVTTPIO  EQU   CVTS01+608                                               08381000
CVTADV   EQU   CVTS01+604                                               08382000
CVTGSDAB EQU   CVTGSDA                                                  08383000
CVTQV3   EQU   CVTS01+596                                               08384000
CVTQV2   EQU   CVTS01+592                                               08385000
CVTQV1   EQU   CVTS01+588                                               08386000
CVTRPT   EQU   CVTS01+584                                               08387000
CVTSSRB  EQU   CVTS01+580                                               08388000
CVTCSDRL EQU   CVTS01+576                                               08389000
CVTEXP1  EQU   CVTS01+572                                               08390000
CVTRMPMT EQU   CVTS01+568                                               08391000
CVTRMPTT EQU   CVTS01+564                                               08392000
CVTVPSA  EQU   CVTS01+560                                               08393000
CVTVSTOP EQU   CVTS01+556                                               08394000
CVTGTFR8 EQU   CVTS01+552                                               08395000
CVTQUIT  EQU   CVTS01+548                                               08396000
CVTVACR  EQU   CVTS01+544                                               08397000
CVTWTCB  EQU   CVTS01+540                                               08398000
CVTSTPRS EQU   CVTS01+536                                               08399000
CVT0PT02 EQU   CVTS01+532                                               08400000
CVTDARCM EQU   CVTS01+528                                               08401000
CVTIRECM EQU   CVTS01+524                                               08402000
CVTJRECM EQU   CVTS01+520                                               08403000
CVTVEMS0 EQU   CVTS01+516                                               08404000
CVTSPFRR EQU   CVTS01+512                                               08405000
CVTRLSTG EQU   CVTS01+508                                               08406000
CVT0TC0A EQU   CVTS01+504                                               08407000
CVTGMBR  EQU   CVTS01+500                                               08408000
CVTLFRM  EQU   CVTS01+496                                               08409000
CVTRMBR  EQU   CVTS01+492                                               08410000
CVTVIOP  EQU   CVTS01+488                                               08411000
CVTRV307 EQU   CVTS01+486                                               08412000
CVTRV306 EQU   CVTS01+484                                               08413000
CVTRV305 EQU   CVTS01+482                                               08414000
CVTRV304 EQU   CVTS01+480                                               08415000
CVTRV303 EQU   CVTS01+478                                               08416000
CVTRV302 EQU   CVTS01+476                                               08417000
CVTTRCA  EQU   CVTS01+472                                               08418000
CVTRV297 EQU   CVTRV289                                                 08419000
CVTRV296 EQU   CVTRV289                                                 08420000
CVTRV295 EQU   CVTRV289                                                 08421000
CVTRV294 EQU   CVTRV289                                                 08422000
CVTRV293 EQU   CVTRV289                                                 08423000
CVTRV292 EQU   CVTRV289                                                 08424000
CVTRV291 EQU   CVTRV289                                                 08425000
CVTRV290 EQU   CVTRV289                                                 08426000
CVTRV288 EQU   CVTRV280                                                 08427000
CVTRV287 EQU   CVTRV280                                                 08428000
CVTRV286 EQU   CVTRV280                                                 08429000
CVTRV285 EQU   CVTRV280                                                 08430000
CVTRV284 EQU   CVTRV280                                                 08431000
CVTRV283 EQU   CVTRV280                                                 08432000
CVTRV282 EQU   CVTRV280                                                 08433000
CVTRV281 EQU   CVTRV280                                                 08434000
CVTRV279 EQU   CVTRV271                                                 08435000
CVTRV278 EQU   CVTRV271                                                 08436000
CVTRV277 EQU   CVTRV271                                                 08437000
CVTRV276 EQU   CVTRV271                                                 08438000
CVTRV275 EQU   CVTRV271                                                 08439000
CVTRV274 EQU   CVTRV271                                                 08440000
CVTRV273 EQU   CVTRV271                                                 08441000
CVTRV272 EQU   CVTRV271                                                 08442000
CVTRV270 EQU   CVTRV262                                                 08443000
CVTRV269 EQU   CVTRV262                                                 08444000
CVTRV268 EQU   CVTRV262                                                 08445000
CVTRV267 EQU   CVTRV262                                                 08446000
CVTRV266 EQU   CVTRV262                                                 08447000
CVTRV265 EQU   CVTRV262                                                 08448000
CVTRV264 EQU   CVTRV262                                                 08449000
CVTRV263 EQU   CVTRV262                                                 08450000
CVTVFP   EQU   CVTS01+464                                               08451000
CVTVSI   EQU   CVTS01+460                                               08452000
CVTVPSIB EQU   CVTS01+456                                               08453000
CVTMFACT EQU   CVTMFRTR                                                 08454000
CVTMFCTL EQU   CVTS01+448                                               08455000
CVTPVBP  EQU   CVTS01+444                                               08456000
CVTPWI   EQU   CVTS01+440                                               08457000
CVTRV254 EQU   CVTS01+438                                               08458000
CVTRV253 EQU   CVTS01+436                                               08459000
CVTRV252 EQU   CVTS01+434                                               08460000
CVTRV251 EQU   CVTS01+433                                               08461000
CVTRV250 EQU   CVTS01+432                                               08462000
CVTRV249 EQU   CVTS01+431                                               08463000
CVTRV248 EQU   CVTS01+430                                               08464000
CVTRV247 EQU   CVTS01+429                                               08465000
CVTRV246 EQU   CVTS01+428                                               08466000
CVTRV245 EQU   CVTRV237                                                 08467000
CVTRV244 EQU   CVTRV237                                                 08468000
CVTRV243 EQU   CVTRV237                                                 08469000
CVTRV242 EQU   CVTRV237                                                 08470000
CVTRV241 EQU   CVTRV237                                                 08471000
CVTRV240 EQU   CVTRV237                                                 08472000
CVTRV239 EQU   CVTRV237                                                 08473000
CVTRV238 EQU   CVTRV237                                                 08474000
CVTRV236 EQU   CVTRV228                                                 08475000
CVTRV235 EQU   CVTRV228                                                 08476000
CVTRV234 EQU   CVTRV228                                                 08477000
CVTRV233 EQU   CVTRV228                                                 08478000
CVTRV232 EQU   CVTRV228                                                 08479000
CVTRV231 EQU   CVTRV228                                                 08480000
CVTRV230 EQU   CVTRV228                                                 08481000
CVTRV229 EQU   CVTRV228                                                 08482000
CVTRV227 EQU   CVTRV219                                                 08483000
CVTRV226 EQU   CVTRV219                                                 08484000
CVTRV225 EQU   CVTRV219                                                 08485000
CVTRV224 EQU   CVTRV219                                                 08486000
CVTRV223 EQU   CVTRV219                                                 08487000
CVTRV222 EQU   CVTRV219                                                 08488000
CVTRV221 EQU   CVTRV219                                                 08489000
CVTRV220 EQU   CVTRV219                                                 08490000
CVTRV218 EQU   CVTRV210                                                 08491000
CVTRV217 EQU   CVTRV210                                                 08492000
CVTRV216 EQU   CVTRV210                                                 08493000
CVTRV215 EQU   CVTRV210                                                 08494000
CVTRV214 EQU   CVTRV210                                                 08495000
CVTRV213 EQU   CVTRV210                                                 08496000
CVTRV212 EQU   CVTRV210                                                 08497000
CVTRV211 EQU   CVTRV210                                                 08498000
CVTLCCAT EQU   CVTS01+420                                               08499000
CVTPCCAT EQU   CVTS01+416                                               08500000
CVTIPCRP EQU   CVTS01+412                                               08501000
CVTIPCRI EQU   CVTS01+408                                               08502000
CVTIPCDS EQU   CVTS01+404                                               08503000
CVTAIDVT EQU   CVTS01+400                                               08504000
CVTSSAP  EQU   CVTS01+396                                               08505000
CVTEHCIR EQU   CVTS01+392                                               08506000
CVTEHDEF EQU   CVTS01+388                                               08507000
CVTDAIR  EQU   CVTS01+384                                               08508000
CVTPERFM EQU   CVTS01+380                                               08509000
CVT044R2 EQU   CVTS01+376                                               08510000
CVTFETCH EQU   CVTS01+372                                               08511000
CVTRSTWD EQU   CVTS01+368                                               08512000
CVTSPOST EQU   CVTS01+364                                               08513000
CVTIOBP  EQU   CVTS01+360                                               08514000
CVTASMVT EQU   CVTS01+356                                               08515000
CVTRECRQ EQU   CVTS01+352                                               08516000
CVTWSAC  EQU   CVTS01+348                                               08517000
CVTRV149 EQU   CVTS01+344                                               08518000
CVTWSAL  EQU   CVTS01+340                                               08519000
CVTSPSA  EQU   CVTS01+336                                               08520000
CVTGLMN  EQU   CVTS01+332                                               08521000
CVTVEAC0 EQU   CVTS01+328                                               08522000
CVT062R1 EQU   CVTS01+324                                               08523000
CVTRPOST EQU   CVTS01+320                                               08524000
CVTDQIQE EQU   CVTS01+316                                               08525000
CVTCSD   EQU   CVTS01+312                                               08526000
CVTLKRMA EQU   CVTS01+308                                               08527000
CVTRSPIE EQU   CVTS01+304                                               08528000
CVTRENQ  EQU   CVTS01+300                                               08529000
CVTLQCB  EQU   CVTS01+296                                               08530000
CVTFQCB  EQU   CVTS01+292                                               08531000
CVTQCS01 EQU   CVTS01+288                                               08532000
CVTAPFT  EQU   CVTS01+284                                               08533000
CVTPARRL EQU   CVTS01+280                                               08534000
CVTVWAIT EQU   CVTS01+276                                               08535000
CVTGSPL  EQU   CVTS01+272                                               08536000
CVTLSMQ  EQU   CVTS01+268                                               08537000
CVTGSMQ  EQU   CVTS01+264                                               08538000
CVTEXPRO EQU   CVTS01+260                                               08539000
CVTOPCTP EQU   CVTS01+256                                               08540000
CVTSIC   EQU   CVTS01+252                                               08541000
CVTTPIOS EQU   CVTS01+248                                               08542000
CVTRTMS  EQU   CVTS01+244                                               08543000
CVTSDBF  EQU   CVTS01+240                                               08544000
CVTSCBP  EQU   CVTS01+236                                               08545000
CVTSDMP  EQU   CVTS01+232                                               08546000
CVTSV60  EQU   CVTS01+228                                               08547000
CVTRTMCT EQU   CVTS01+224                                               08548000
CVTASCBL EQU   CVTS01+220                                               08549000
CVTASCBH EQU   CVTS01+216                                               08550000
CVTGDA   EQU   CVTS01+212                                               08551000
CVTASVT  EQU   CVTS01+208                                               08552000
CVTVVMDI EQU   CVTS01+204                                               08553000
CVTAQTOP EQU   CVTS01+200                                               08554000
CVTIOSCS EQU   CVTS01+196                                               08555000
CVTSDRM  EQU   CVTS01+192                                               08556000
CVTOPTE  EQU   CVTS01+188                                               08557000
CVTSTXU  EQU   CVTS01+184                                               08558000
CVTQUIS  EQU   CVTS01+180                                               08559000
CVTPARS  EQU   CVTS01+176                                               08560000
CVTS1EE  EQU   CVTS01+172                                               08561000
CVTFRAS  EQU   CVTS01+168                                               08562000
CVTQSAS  EQU   CVTS01+164                                               08563000
CVTCRAS  EQU   CVTS01+160                                               08564000
CVTCRMN  EQU   CVTS01+156                                               08565000
CVTDELCP EQU   CVTS01+152                                               08566000
CVTFRECL EQU   CVTS01+148                                               08567000
CVTGETCL EQU   CVTS01+144                                               08568000
CVTBLDCP EQU   CVTS01+140                                               08569000
CVTAUTHL EQU   CVTS01+136                                               08570000
CVTSCAN  EQU   CVTS01+132                                               08571000
CVTRV144 EQU   CVTS01+130                                               08572000
CVTMAXMP EQU   CVTS01+128                                               08573000
CVTSTCK  EQU   CVTS01+124                                               08574000
CVTRV139 EQU   CVTS01+123                                               08575000
CVTDSSAC EQU   CVTS01+122                                               08576000
CVTRV513 EQU   CVTS01+121                                               08577000
CVTIOSPL EQU   CVTS01+120                                               08578000
CVTPTGT  EQU   CVTS01+116                                               08579000
CVTCSPIE EQU   CVTS01+112                                               08580000
CVTSMFEX EQU   CVTS01+108                                               08581000
CVTOLT0A EQU   CVTS01+104                                               08582000
CVTSRBRT EQU   CVTS01+100                                               08583000
CVTPUTL  EQU   CVTS01+96                                                08584000
CVTASCRL EQU   CVTS01+92                                                08585000
CVTASCRF EQU   CVTS01+88                                                08586000
CVTRV326 EQU   CVTS01+84                                                08587000
CVTRV325 EQU   CVTS01+80                                                08588000
CVTRV324 EQU   CVTS01+76                                                08589000
CVT0VL01 EQU   CVTS01+72                                                08590000
CVTSHRVM EQU   CVTS01+68                                                08591000
CVTRV332 EQU   CVTS01+64                                                08592000
CVTTAS   EQU   CVTS01+60                                                08593000
CVTRSCN  EQU   CVTS01+56                                                08594000
CVTTRAC2 EQU   CVTS01+54                                                08595000
CVTTRACE EQU   CVTS01+52                                                08596000
CVTAPG   EQU   CVTS01+51                                                08597000
CVTSDTRC EQU   CVTCTLFG                                                 08598000
CVTGTRCE EQU   CVTCTLFG                                                 08599000
CVTNOMP  EQU   CVTCTLFG                                                 08600000
CVTRSV79 EQU   CVTCTLFG                                                 08601000
CVTDSTAT EQU   CVTCTLFG                                                 08602000
CVTRSV78 EQU   CVTCTLFG                                                 08603000
CVTRV333 EQU   CVTCTLFG                                                 08604000
CVTRV323 EQU   CVTCTLFG                                                 08605000
CVTSPVLK EQU   CVTS01+49                                                08606000
CVTRSV77 EQU   CVTS01+48                                                08607000
CVTRV331 EQU   CVTS01+44                                                08608000
CVTRV330 EQU   CVTS01+40                                                08609000
CVTRV329 EQU   CVTS01+36                                                08610000
CVTRV328 EQU   CVTS01+32                                                08611000
CVTRV322 EQU   CVTS01+28                                                08612000
CVTSLID  EQU   CVTSLIDA+1                                               08613000
CVTSYLK  EQU   CVTSLIDA                                                 08614000
CVTRV321 EQU   CVTS01+20                                                08615000
CVTRV320 EQU   CVTS01+16                                                08616000
CVTLPDIR EQU   CVTLPDIA+1                                               08617000
CVTRSV69 EQU   CVTDIRST                                                 08618000
CVTRSV68 EQU   CVTDIRST                                                 08619000
CVTRSV67 EQU   CVTDIRST                                                 08620000
CVTRSV66 EQU   CVTDIRST                                                 08621000
CVTRSV65 EQU   CVTDIRST                                                 08622000
CVTRSV64 EQU   CVTDIRST                                                 08623000
CVTRSV63 EQU   CVTDIRST                                                 08624000
CVTDICOM EQU   CVTDIRST                                                 08625000
CVTPVTP  EQU   CVTS01+8                                                 08626000
CVTLPDSR EQU   CVTS01+4                                                 08627000
CVTGETL  EQU   CVTS01                                                   08628000
IOPBCEND EQU   IOPBPDS+21                                               08629000
IOPBFTB3 EQU   IOPBFTB0+2                                               08630000
IOPBFTB2 EQU   IOPBFTB0+1                                               08631000
@NM00170 EQU   IOPBFTB1                                                 08632000
IOPBAPFP EQU   IOPBFTB1                                                 08633000
IOPBSSI  EQU   IOPBFTB1                                                 08634000
IOPBPAGA EQU   IOPBFTB1                                                 08635000
@NM00169 EQU   IOPBFTB1                                                 08636000
IOPBAOSL EQU   IOPBFTB1                                                 08637000
IOPBSEPA EQU   IOPBPDS+15                                               08638000
IOPBFTBL EQU   IOPBPDS+13                                               08639000
IOPBSTOR EQU   IOPBPDS+10                                               08640000
IOPBREFR EQU   IOPBLEP2                                                 08641000
IOPBLEF  EQU   IOPBLEP2                                                 08642000
IOPBTEST EQU   IOPBLEP2                                                 08643000
IOPBNE   EQU   IOPBLEP2                                                 08644000
@NM00167 EQU   IOPBLEP2                                                 08645000
IOPBDC   EQU   IOPBLEP2                                                 08646000
@NM00166 EQU   IOPBLEP1                                                 08647000
IOPBSCTR EQU   IOPBLEP1                                                 08648000
IOPBOL   EQU   IOPBLEP1                                                 08649000
@NM00165 EQU   IOPBLEP1                                                 08650000
IOPBOVLY EQU   IOPBLEP1                                                 08651000
IOPBREUS EQU   IOPBLEP1                                                 08652000
IOPBRENT EQU   IOPBLEP1                                                 08653000
IOPBNL   EQU   IOPBPDS+7                                                08654000
IOPBTTRN EQU   IOPBPDS+4                                                08655000
IOPBZERO EQU   IOPBPDS+3                                                08656000
IOPBTTRT EQU   IOPBPDS                                                  08657000
IOPPTIND EQU   IOPPTNTR+8                                               08658000
IOPPTSND EQU   IOPPTREL                                                 08659000
@NM00163 EQU   IOPPTSFX+872                                             08660000
IOPSYZPP EQU   IOPPTSFX+772                                             08661000
IOPSYZPR EQU   IOPPTSFX+771                                             08662000
IOPSYZPS EQU   IOPPTSFX+763                                             08663000
IOPSYZAP EQU   IOPPTSFX+755                                             08664000
IOPSYUPP EQU   IOPPTSFX+655                                             08665000
IOPSYUPR EQU   IOPPTSFX+654                                             08666000
IOPSYUPS EQU   IOPPTSFX+646                                             08667000
IOPSYUPD EQU   IOPPTSFX+638                                             08668000
IOPSYSPP EQU   IOPPTSFX+538                                             08669000
IOPSYSPR EQU   IOPPTSFX+537                                             08670000
IOPSYSPS EQU   IOPPTSFX+529                                             08671000
IOPSYSUP EQU   IOPPTSFX+521                                             08672000
IOPSYLKP EQU   IOPPTSFX+421                                             08673000
IOPSYLKR EQU   IOPPTSFX+420                                             08674000
IOPSYLKS EQU   IOPPTSFX+412                                             08675000
IOPSYLKD EQU   IOPPTSFX+404                                             08676000
IOPSYCPP EQU   IOPPTSFX+304                                             08677000
IOPSYCPR EQU   IOPPTSFX+303                                             08678000
IOPSYCPS EQU   IOPPTSFX+295                                             08679000
IOPSYCPY EQU   IOPPTSFX+287                                             08680000
IOPSYCOP EQU   IOPPTSFX+187                                             08681000
IOPSYCOR EQU   IOPPTSFX+186                                             08682000
IOPSYCOS EQU   IOPPTSFX+178                                             08683000
IOPSYCOM EQU   IOPPTSFX+170                                             08684000
IOPSYASP EQU   IOPPTSFX+70                                              08685000
IOPSYASR EQU   IOPPTSFX+69                                              08686000
IOPSYASS EQU   IOPPTSFX+61                                              08687000
IOPSYASM EQU   IOPPTSFX+53                                              08688000
@NM00162 EQU   IOPPTSFX+35                                              08689000
@NM00161 EQU   IOPPTFG1                                                 08690000
IOPPTSNJ EQU   IOPPTFG1                                                 08691000
IOPPTSNP EQU   IOPPTFG1                                                 08692000
IOPSYPLN EQU   IOPPTSFX+32                                              08693000
IOPDSPFX EQU   IOPPTSFX+6                                               08694000
IOPDSDIR EQU   IOPDSSPC+4                                               08695000
IOPDSSEC EQU   IOPDSSPC+2                                               08696000
IOPDSPRM EQU   IOPDSSPC                                                 08697000
@NM00160 EQU   IOPPTSDR+4                                               08698000
IOPPTPEM EQU   IOPPTSDR+2                                               08699000
IOPPCNVL EQU   IOPPTSDR+1                                               08700000
@NM00159 EQU   IOPPTSDR                                                 08701000
IOPQFMTP EQU   IOPQFMLS+8                                               08702000
@NM00158 EQU   IOPQFMLS+7                                               08703000
IOPQFMND EQU   IOPQFMNM                                                 08704000
@NM00157 EQU   IOPQFMDR                                                 08705000
@NM00153 EQU   IOPQSMDR                                                 08706000
@NM00152 EQU   IOPSBYNT+8                                               08707000
IOPSBYST EQU   IOPSBYNT+7                                               08708000
IOPSBYNM EQU   IOPSBYNT                                                 08709000
@NM00151 EQU   IOPVERNT+8                                               08710000
IOPVERST EQU   IOPVERNT+7                                               08711000
IOPVERNM EQU   IOPVERNT                                                 08712000
@NM00150 EQU   IOPDELNT+8                                               08713000
IOPDELST EQU   IOPDELNT+7                                               08714000
IOPDELNM EQU   IOPDELNT                                                 08715000
@NM00149 EQU   IOPFIDNT+8                                               08716000
IOPFIDST EQU   IOPFIDNT+7                                               08717000
IOPFIDNM EQU   IOPFIDNT                                                 08718000
@NM00148 EQU   IOPIRQNT+8                                               08719000
IOPIRQST EQU   IOPIRQNT+7                                               08720000
IOPIRQNM EQU   IOPIRQNT                                                 08721000
@NM00147 EQU   IOPREQNT+8                                               08722000
IOPREQST EQU   IOPREQNT+7                                               08723000
IOPREQNM EQU   IOPREQNT                                                 08724000
@NM00146 EQU   IOPSUPNT+8                                               08725000
IOPSUPST EQU   IOPSUPNT+7                                               08726000
IOPSUPNM EQU   IOPSUPNT                                                 08727000
@NM00145 EQU   IOPNPRNT+8                                               08728000
IOPNPRST EQU   IOPNPRNT+7                                               08729000
IOPNPRNM EQU   IOPNPRNT                                                 08730000
@NM00144 EQU   IOPPRENT+8                                               08731000
IOPPREST EQU   IOPPRENT+7                                               08732000
IOPPRENM EQU   IOPPRENT                                                 08733000
@NM00143 EQU   IOPSRLNT+8                                               08734000
IOPSRLST EQU   IOPSRLNT+7                                               08735000
@NM00142 EQU   IOPSRLNT+4                                               08736000
IOPSRLNM EQU   IOPSRLNT                                                 08737000
@NM00141 EQU   IOPENTNT+8                                               08738000
IOPENTST EQU   IOPENTNT+7                                               08739000
IOPENTNM EQU   IOPENTNT                                                 08740000
IOPPIND  EQU   IOPPNTRY+8                                               08741000
@NM00140 EQU   IOPPTPFX+24                                              08742000
IOPUCLT  EQU   IOPDATES+21                                              08743000
IOPUCLD  EQU   IOPDATES+18                                              08744000
IOPACCT  EQU   IOPDATES+15                                              08745000
IOPACCD  EQU   IOPDATES+12                                              08746000
IOPRSTT  EQU   IOPDATES+9                                               08747000
IOPRSTD  EQU   IOPDATES+6                                               08748000
IOPAPPT  EQU   IOPDATES+3                                               08749000
IOPAPPD  EQU   IOPDATES                                                 08750000
IOPRECT  EQU   @NM00139+3                                               08751000
IOPRECD  EQU   @NM00139                                                 08752000
@NM00138 EQU   IOPPTFFX+8                                               08753000
@NM00137 EQU   @NM00135+7                                               08754000
IOPPRELN EQU   @NM00136                                                 08755000
@NM00134 EQU   IOPPTFDR+20                                              08756000
IOPSBYNO EQU   IOPPTFDR+13                                              08757000
IOPDBYNO EQU   IOPPTFDR+6                                               08758000
@NM00133 EQU   IOPPTFF3                                                 08759000
IOPFLF   EQU   IOPPTFF3                                                 08760000
IOPDBYP  EQU   IOPPTFF3                                                 08761000
IOPSBYP  EQU   IOPPTFF3                                                 08762000
IOPPMDLP EQU   IOPPTFF2+1                                               08763000
IOPPADDP EQU   IOPPTFF2+1                                               08764000
@NM00132 EQU   IOPPTFF2+1                                               08765000
IOPLRFP  EQU   IOPPTFF2                                                 08766000
IOPJCLP  EQU   IOPPTFF2                                                 08767000
IOPSUPP  EQU   IOPPTFF2                                                 08768000
IOPREQP  EQU   IOPPTFF2                                                 08769000
IOPPREP  EQU   IOPPTFF2                                                 08770000
IOPNPRP  EQU   IOPPTFF2                                                 08771000
IOPIRQP  EQU   IOPPTFF2                                                 08772000
IOPDELP  EQU   IOPPTFF2                                                 08773000
IOPREGEN EQU   IOPFLGS5                                                 08774000
IOPBYP   EQU   IOPFLGS5                                                 08775000
@NM00131 EQU   IOPFLGS5                                                 08776000
IOPERROR EQU   IOPFLGS5                                                 08777000
IOPACC   EQU   IOPFLGS5                                                 08778000
IOPRES   EQU   IOPFLGS5                                                 08779000
IOPAPP   EQU   IOPFLGS5                                                 08780000
IOPPTYPE EQU   IOPPTFDR+1                                               08781000
@NM00130 EQU   IOPPTFDR                                                 08782000
IOPSYSTP EQU   IOPSYSTR+8                                               08783000
IOPSYSND EQU   IOPSYNTR                                                 08784000
@NM00129 EQU   IOPSYSFX+21                                              08785000
IOPSYSID EQU   IOPSYSFX+13                                              08786000
IOPNUCID EQU   IOPSYSFX+12                                              08787000
IOPSREL  EQU   IOPSYSFX+8                                               08788000
@NM00128 EQU   @NM00126+7                                               08789000
@NM00127 EQU   @NM00126                                                 08790000
@NM00125 EQU   IOPSYSDR+5                                               08791000
@NM00124 EQU   IOPFLGS7                                                 08792000
IOPSYNG  EQU   IOPFLGS7                                                 08793000
IOPSYDL  EQU   IOPFLGS7                                                 08794000
IOPSTSNP EQU   IOPFLGS7                                                 08795000
IOPMTSNP EQU   IOPFLGS7                                                 08796000
IOPPEMAX EQU   IOPSYSDR+2                                               08797000
IOPSCNVL EQU   IOPSYSDR+1                                               08798000
@NM00123 EQU   IOPSYSDR                                                 08799000
IOPDLIND EQU   IOPDNTRY+8                                               08800000
IOPDLBND EQU   IOPDSYS                                                  08801000
@NM00122 EQU   IOPDLBFX+8                                               08802000
@NM00121 EQU   @NM00119+7                                               08803000
@NM00120 EQU   @NM00119                                                 08804000
@NM00118 EQU   IOPDLBDR+1                                               08805000
@NM00117 EQU   IOPDLBDR                                                 08806000
IOPMDIND EQU   IOPMNTRY+8                                               08807000
@NM00116 EQU   IOPMODST                                                 08808000
IOPMODND EQU   IOPMODID                                                 08809000
IOPDLIB  EQU   IOPMODFX+72                                              08810000
@NM00115 EQU   IOPMODFX+12                                              08811000
@NM00114 EQU   IOPMODF4                                                 08812000
@NM00113 EQU   IOPMODF3                                                 08813000
@NM00112 EQU   IOPMODF2                                                 08814000
IOPMPAGA EQU   IOPMODF2                                                 08815000
IOPMNE   EQU   IOPMODF2                                                 08816000
@NM00111 EQU   IOPMODF1                                                 08817000
IOPMDC   EQU   IOPMODF1                                                 08818000
IOPMREFR EQU   IOPMODF1                                                 08819000
IOPMOVLY EQU   IOPMODF1                                                 08820000
IOPMSCTR EQU   IOPMODF1                                                 08821000
IOPMREUS EQU   IOPMODF1                                                 08822000
IOPMRENT EQU   IOPMODF1                                                 08823000
IOPMAPF  EQU   IOPMODF1                                                 08824000
@NM00110 EQU   @NM00108+7                                               08825000
@NM00109 EQU   @NM00108                                                 08826000
@NM00107 EQU   IOPMODDR+17                                              08827000
@NM00106 EQU   @NM00104+7                                               08828000
@NM00105 EQU   @NM00104                                                 08829000
@NM00103 EQU   @NM00100                                                 08830000
@NM00102 EQU   @NM00100                                                 08831000
@NM00101 EQU   @NM00100                                                 08832000
@NM00099 EQU   @NM00098                                                 08833000
@NM00097 EQU   IOPMODDR                                                 08834000
IOPSRIND EQU   IOPSNTRY+8                                               08835000
@NM00096 EQU   IOPSRCST                                                 08836000
IOPSRCND EQU   IOPSRCID                                                 08837000
IOPSRDLB EQU   IOPSRCFX+72                                              08838000
IOPSRSYS EQU   IOPSRCFX+64                                              08839000
@NM00095 EQU   IOPSRCFX+8                                               08840000
@NM00094 EQU   @NM00092+7                                               08841000
@NM00093 EQU   @NM00092                                                 08842000
@NM00091 EQU   IOPSRCDR+18                                              08843000
IOPSRLNG EQU   IOPSRCDR+17                                              08844000
@NM00090 EQU   @NM00088+7                                               08845000
@NM00089 EQU   @NM00088                                                 08846000
@NM00087 EQU   @NM00084                                                 08847000
@NM00086 EQU   @NM00084                                                 08848000
@NM00085 EQU   @NM00084                                                 08849000
@NM00083 EQU   @NM00082                                                 08850000
@NM00081 EQU   IOPSRCDR                                                 08851000
IOPEOFND EQU   IOPEOFNT                                                 08852000
IOPMCTYP EQU   IOPMCIND                                                 08853000
@NM00080 EQU   IOPMACST                                                 08854000
IOPMACND EQU   IOPMACID                                                 08855000
IOPMCDLB EQU   IOPMACFX+72                                              08856000
IOPMCSYS EQU   IOPMACFX+64                                              08857000
@NM00079 EQU   IOPMACFX+8                                               08858000
IOPBUTYP EQU   IOPBUNT+7                                                08859000
IOPBUSMD EQU   IOPBUNT                                                  08860000
@NM00078 EQU   IOPMACDR+18                                              08861000
IOPMCLNG EQU   IOPMACDR+17                                              08862000
IOPFMST  EQU   IOPFMIDE+7                                               08863000
IOPFMID  EQU   IOPFMIDE                                                 08864000
@NM00077 EQU   IOPRMST                                                  08865000
IOPRMASM EQU   IOPRMST                                                  08866000
@NM00076 EQU   IOPRMST                                                  08867000
IOPRMID  EQU   IOPRMIDE                                                 08868000
@NM00075 EQU   IOPMACDR                                                 08869000
IOPLMIND EQU   IOPLNTRY+8                                               08870000
IOPLMDND EQU   IOPSYSLB                                                 08871000
@NM00073 EQU   @NM00071+7                                               08872000
@NM00072 EQU   @NM00071                                                 08873000
@NM00070 EQU   IOPLMDDR+6                                               08874000
@NM00069 EQU   IOPFLGS3                                                 08875000
IOPCHREP EQU   IOPFLGS3                                                 08876000
IOPLINK  EQU   IOPFLGS3                                                 08877000
IOPCOPY  EQU   IOPFLGS3                                                 08878000
@NM00068 EQU   IOPLMDF4                                                 08879000
@NM00067 EQU   IOPLMDF3                                                 08880000
@NM00066 EQU   IOPLMDF2                                                 08881000
IOPPAGA  EQU   IOPLMDF2                                                 08882000
IOPNE    EQU   IOPLMDF2                                                 08883000
@NM00065 EQU   IOPFLGS2                                                 08884000
IOPDC    EQU   IOPFLGS2                                                 08885000
IOPREFR  EQU   IOPFLGS2                                                 08886000
IOPOVLY  EQU   IOPFLGS2                                                 08887000
IOPSCTR  EQU   IOPFLGS2                                                 08888000
IOPREUS  EQU   IOPFLGS2                                                 08889000
IOPRENT  EQU   IOPFLGS2                                                 08890000
IOPAPF   EQU   IOPFLGS2                                                 08891000
@NM00064 EQU   IOPLMDDR                                                 08892000
@NM00063 EQU   IOPASMDR+9                                               08893000
IOPABUTP EQU   IOPABUNT+7                                               08894000
IOPABUPT EQU   IOPABUNT                                                 08895000
IOPNTLVL EQU   IOPASMDR                                                 08896000
IOPCQMAX EQU   IOPCQMAP+12                                              08897000
@NM00060 EQU   IOPCQMAP+11                                              08898000
@NM00059 EQU   IOPCQMAP+8                                               08899000
@NM00058 EQU   IOPCQMAP                                                 08900000
IOPPTMAX EQU   IOPCDMAX                                                 08901000
@NM00057 EQU   IOPSCMAP+11                                              08902000
@NM00056 EQU   IOPSCMAP+8                                               08903000
@NM00055 EQU   IOPSCMAP                                                 08904000
IOPDIRMX EQU   IOPNTMAX+12                                              08905000
@NM00054 EQU   IOPNTMAX+11                                              08906000
@NM00053 EQU   IOPNTMAX+8                                               08907000
@NM00052 EQU   IOPNTMAX                                                 08908000
@NM00051 EQU   IOPDTYPE                                                 08909000
IOPDMOD  EQU   IOPDTYPE                                                 08910000
IOPSDIR  EQU   IOPSPACE+4                                               08911000
IOPSSCND EQU   IOPSPACE+2                                               08912000
IOPISEQ3 EQU   IOPINAM3+6                                               08913000
IOPITYP3 EQU   @NM00050+5                                               08914000
IOPIPTF3 EQU   @NM00050                                                 08915000
CCAEND   EQU   HMASMCCA+371                                             08916000
@NM00024 EQU   HMASMCCA+309                                             08917000
@NM00023 EQU   CCAFLAGB                                                 08918000
CCAFMID  EQU   HMASMCCA+291                                             08919000
CCALSTDS EQU   CCAFCTL+8                                                08920000
CCARPTDS EQU   CCAFCTL+7                                                08921000
@NM00022 EQU   CCAFLAG9                                                 08922000
CCARVCAN EQU   CCAFLAG9                                                 08923000
CCARVEST EQU   CCAFLAG9                                                 08924000
CCAPTSNJ EQU   CCAFLAG9                                                 08925000
CCASTSNP EQU   CCAFLAG9                                                 08926000
CCAMTSNP EQU   CCAFLAG9                                                 08927000
CCAPTSNP EQU   CCAFLAG9                                                 08928000
@NM00021 EQU   CCAFLAG8                                                 08929000
CCAACDSC EQU   CCAFLAG8                                                 08930000
CCACDSC  EQU   CCAFLAG8                                                 08931000
@NM00020 EQU   CCAFLAG6                                                 08932000
CCAACRUP EQU   CCAFLAG6                                                 08933000
CCACRQUP EQU   CCAFLAG6                                                 08934000
CCAACDUP EQU   CCAFLAG6                                                 08935000
CCACDSUP EQU   CCAFLAG6                                                 08936000
@NM00019 EQU   CCAFLAG5                                                 08937000
@NM00018 EQU   CCAFLAG4                                                 08938000
@NM00017 EQU   CCAFLAG3+1                                               08939000
CCARGNP  EQU   CCAFLAG3+1                                               08940000
CCADISRQ EQU   CCAFLAG3+1                                               08941000
CCAICTOK EQU   CCAFLAG3                                                 08942000
CCADELP  EQU   CCAFLAG3                                                 08943000
CCACMPRS EQU   CCAFLAG3                                                 08944000
CCAZAPP  EQU   CCAFLAG3                                                 08945000
CCALINKP EQU   CCAFLAG3                                                 08946000
CCACOPYP EQU   CCAFLAG3                                                 08947000
CCAASIP  EQU   CCAFLAG3                                                 08948000
CCAUPDP  EQU   CCAFLAG3                                                 08949000
CCAEOSMP EQU   CCAFLAG2                                                 08950000
CCAEOFNC EQU   CCAFLAG2                                                 08951000
@NM00016 EQU   CCAFLAG2                                                 08952000
CCASVCLB EQU   CCAFLAG2                                                 08953000
CCANCPTF EQU   CCAFLAG2                                                 08954000
@NM00015 EQU   CCAFLAG1+1                                               08955000
CCAUNL   EQU   CCAFLAG1+1                                               08956000
CCARESET EQU   CCAFLAG1+1                                               08957000
CCALOG   EQU   CCAFLAG1+1                                               08958000
CCAUPDU  EQU   CCAFLAG1                                                 08959000
CCAREJ   EQU   CCAFLAG1                                                 08960000
CCAREC   EQU   CCAFLAG1                                                 08961000
CCAFUNCT EQU   CCAFFUNC                                                 08962000
@NM00014 EQU   @NM00009+18                                              08963000
@NM00013 EQU   @NM00009+16                                              08964000
CCATBLPA EQU   @NM00009+12                                              08965000
@NM00012 EQU   @NM00009+8                                               08966000
@NM00011 EQU   @NM00009+4                                               08967000
@NM00010 EQU   @NM00009                                                 08968000
CCAIFGTP EQU   CCAFGTP+16                                               08969000
CCAGTP3  EQU   CCAFGTP+12                                               08970000
CCAGTP2  EQU   CCAFGTP+8                                                08971000
CCAGTP1  EQU   CCAFGTP+4                                                08972000
CCASETAD EQU   CCASEGTP                                                 08973000
CCACLST  EQU   CCAFPGM+12                                               08974000
CCASPDCB EQU   CCAFPGM+8                                                08975000
CCAICLMD EQU   CCAFICT+12                                               08976000
CCAICMOD EQU   CCAFICT+8                                                08977000
CCAICPTF EQU   CCAFICT+4                                                08978000
CCAICT   EQU   CCAFICT                                                  08979000
CCARVAD  EQU   CCAFSTA                                                  08980000
CCAACDID EQU   CCAFSYS+32                                               08981000
CCACDSID EQU   CCAFSYS+24                                               08982000
CCALNLEN EQU   CCAFSYS+22                                               08983000
@NM00008 EQU   CCAFLAGA                                                 08984000
CCAPSYSF EQU   CCAFLAGA                                                 08985000
CCAASYSF EQU   CCAFLAGA                                                 08986000
CCACSYSF EQU   CCAFLAGA                                                 08987000
CCANUCID EQU   CCAFSYS+20                                               08988000
CCAASREL EQU   CCAFSYS+16                                               08989000
CCACSREL EQU   CCASREL                                                  08990000
CCAPEMAX EQU   CCAFSYS+10                                               08991000
CCAIOPAS EQU   CCAFSYS+4                                                08992000
CCAIOPCS EQU   CCAFSYS                                                  08993000
CCAIOPTR EQU   CCAFIOP                                                  08994000
@NM00007 EQU   CCAFLAG7+3                                               08995000
CCALOGP  EQU   CCAFLAG7+2                                               08996000
CCAOUTP  EQU   CCAFLAG7+2                                               08997000
CCASLBP  EQU   CCAFLAG7+2                                               08998000
CCARPTP  EQU   CCAFLAG7+2                                               08999000
CCALISTP EQU   CCAFLAG7+2                                               09000000
CCAJCLP  EQU   CCAFLAG7+2                                               09001000
CCAPTFP  EQU   CCAFLAG7+2                                               09002000
CCATLBP  EQU   CCAFLAG7+2                                               09003000
CCAUT3P  EQU   CCAFLAG7+1                                               09004000
CCAUT2P  EQU   CCAFLAG7+1                                               09005000
CCAUT1P  EQU   CCAFLAG7+1                                               09006000
CCAWK5P  EQU   CCAFLAG7+1                                               09007000
CCAWK4P  EQU   CCAFLAG7+1                                               09008000
CCAWK3P  EQU   CCAFLAG7+1                                               09009000
CCAWK2P  EQU   CCAFLAG7+1                                               09010000
CCAWK1P  EQU   CCAFLAG7+1                                               09011000
CCAACRQP EQU   CCAFLAG7                                                 09012000
CCACRQP  EQU   CCAFLAG7                                                 09013000
CCASTSP  EQU   CCAFLAG7                                                 09014000
CCAMTSP  EQU   CCAFLAG7                                                 09015000
CCAPTSP  EQU   CCAFLAG7                                                 09016000
CCASCDSP EQU   CCAFLAG7                                                 09017000
CCAACDSP EQU   CCAFLAG7                                                 09018000
CCACDSP  EQU   CCAFLAG7                                                 09019000
@NM00006 EQU   CCAFBUFR+122                                             09020000
@NM00005 EQU   CCAFBUFR+120                                             09021000
@NM00004 EQU   CCAFBUFR+118                                             09022000
@NM00003 EQU   CCAFBUFR+88                                              09023000
@NM00002 EQU   CCAFBUFR+84                                              09024000
CCA4BFSZ EQU   CCAFBUFR+80                                              09025000
CCAWBFSZ EQU   CCAFBUFR+72                                              09026000
CCAQBFSZ EQU   CCAFBUFR+68                                              09027000
CCAPBFSZ EQU   CCAFBUFR+64                                              09028000
CCAVBFSZ EQU   CCAFBUFR+60                                              09029000
CCACBFSZ EQU   CCAFBUFR+56                                              09030000
@NM00001 EQU   CCAFBUFR+52                                              09031000
CCAID    EQU   HMASMCCA                                                 09032000
@NM00264 EQU   SVAREAS+12                                               09033000
@NM00263 EQU   SVAREAS                                                  09034000
@NM00262 EQU   CCWS+1                                                   09035000
@NM00256 EQU   ENQRTNAR                                                 09036000
CVTLTCB  EQU   @NM00255+4                                               09037000
@NM00212 EQU   PDSARRY1+9                                               09038000
@NM00211 EQU   PDSSW                                                    09039000
@NM00210 EQU   PDSARRY1+4                                               09040000
@NM00209 EQU   PDSARRY1                                                 09041000
@NM00207 EQU   DCBEROPT                                                 09042000
JFCRSV05 EQU   JFCEROPT                                                 09043000
JFCRSV04 EQU   JFCEROPT                                                 09044000
JFCRSV03 EQU   JFCEROPT                                                 09045000
JFCRSV02 EQU   JFCEROPT                                                 09046000
JFCTOPT  EQU   JFCEROPT                                                 09047000
JFCABN   EQU   JFCEROPT                                                 09048000
JFCSKP   EQU   JFCEROPT                                                 09049000
JFCACC   EQU   JFCEROPT                                                 09050000
JFCBUFL  EQU   JFCAMPTR+2                                               09051000
JFCFWORD EQU   JFCBFTEK                                                 09052000
JFCDWORD EQU   JFCBFTEK                                                 09053000
JFCHIER1 EQU   JFCBFTEK                                                 09054000
JFCDYN   EQU   JFCBFTEK                                                 09055000
JFCEXC   EQU   JFCBFTEK                                                 09056000
JFCBBFTR EQU   JFCBBFTA                                                 09057000
JFCSIM   EQU   JFCBBFTA                                                 09058000
JFCHIER  EQU   JFCBFTEK                                                 09059000
JFCBFOUT EQU   JFCBUFNO                                                 09060000
JFCBUFIN EQU   JFCBUFNO                                                 09061000
JFCTEMP  EQU   JFCBIND2                                                 09062000
JFCREQ   EQU   JFCBIND2                                                 09063000
JFCENT   EQU   JFCBIND2                                                 09064000
JFCSHARE EQU   JFCBIND2                                                 09065000
JFCSECUR EQU   JFCBIND2                                                 09066000
JFCGDG   EQU   JFCBIND1                                                 09067000
JFCADDED EQU   JFCBIND1                                                 09068000
JFCLOC   EQU   JFCBIND1                                                 09069000
JFCRLSE  EQU   JFCBIND1                                                 09070000
JFCBXPDT EQU   INFMJFCB+83                                              09071000
JFCBCRDT EQU   INFMJFCB+80                                              09072000
JFCBOPS2 EQU   JFCBMASK+7                                               09073000
JFCRCTLG EQU   JFCBFLG2                                                 09074000
JFCBBUFF EQU   JFCBFLG2                                                 09075000
JFCTRACE EQU   JFCBFLG2                                                 09076000
JFCSDRPS EQU   JFCBFLG2                                                 09077000
JFCMODNW EQU   JFCBFLG2                                                 09078000
JFCNRPS  EQU   JFCDEFER                                                 09079000
JFCOUTOP EQU   JFCBFLG2                                                 09080000
JFCINOP  EQU   JFCBFLG2                                                 09081000
JFCBPWBP EQU   JFCOPEN                                                  09082000
@NM00203 EQU   JFCOPEN                                                  09083000
JFCDUAL  EQU   JFCBFLG1                                                 09084000
JFCSLDES EQU   JFCBFLG1                                                 09085000
JFCSLCRE EQU   JFCBFLG1                                                 09086000
JFCSTAND EQU   JFCBFLG1                                                 09087000
JFCBVLSQ EQU   INFMJFCB+70                                              09088000
JFCRSV31 EQU   JFCFUNC                                                  09089000
JFCFNCBT EQU   JFCFUNC                                                  09090000
JFCFNCBX EQU   JFCFUNC                                                  09091000
JFCFNCBD EQU   JFCFUNC                                                  09092000
JFCFNCBW EQU   JFCFUNC                                                  09093000
JFCFNCBP EQU   JFCFUNC                                                  09094000
JFCFNCBR EQU   JFCFUNC                                                  09095000
JFCFNCBI EQU   JFCFUNC                                                  09096000
JFCBFOFL EQU   JFCBUFOF                                                 09097000
JFCNL    EQU   JFCBLTYP                                                 09098000
JFCNSL   EQU   JFCBLTYP                                                 09099000
JFCSUL   EQU   JFCBLTYP                                                 09100000
JFCBLP   EQU   JFCBLTYP                                                 09101000
JFCBLTM  EQU   JFCBLTYP                                                 09102000
JFCBAL   EQU   JFCBLTYP                                                 09103000
JFCRSV38 EQU   JFCBLTYP                                                 09104000
JFCVINDX EQU   INFMJFCB+64                                              09105000
JFCNLREC EQU   INFMJFCB+62                                              09106000
JFCBADBF EQU   INFMJFCB+60                                              09107000
JFCAMSTR EQU   JFCBFRID+2                                               09108000
JFCAMCRO EQU   JFCBFRID                                                 09109000
JFCBDSCB EQU   INFMJFCB+53                                              09110000
JFCPAT   EQU   JFCBTSDM                                                 09111000
JFCNDCB  EQU   JFCBTSDM                                                 09112000
JFCNDSCB EQU   JFCBTSDM                                                 09113000
JFCTTR   EQU   JFCBTSDM                                                 09114000
JFCSDS   EQU   JFCBTSDM                                                 09115000
JFCVSL   EQU   JFCBTSDM                                                 09116000
JFCCAT   EQU   JFCBTSDM                                                 09117000
JFCIPLTX EQU   JFCBELNM                                                 09118000
JFCBQNAM EQU   JFCBDSNM                                                 09119000
IOBERRCT EQU   IOBSTDRD+30                                              09120000
IOBRSV19 EQU   IOBINCAM+1                                               09121000
IOBOLTST EQU   IOBBTAMF                                                 09122000
IOBRFTMG EQU   IOBBTAMF                                                 09123000
IOBRSV17 EQU   IOBBTAMF                                                 09124000
IOBRSV16 EQU   IOBBTAMF                                                 09125000
IOBRSV15 EQU   IOBBTAMF                                                 09126000
IOBRSV14 EQU   IOBBTAMF                                                 09127000
IOBINUSE EQU   IOBBTAMF                                                 09128000
IOBPRMER EQU   IOBBTAMF                                                 09129000
IOBRSTRB EQU   IOBRESTR+1                                               09130000
IOBREPOS EQU   IOBRESTR                                                 09131000
IOBDCBPB EQU   IOBDCBPT+1                                               09132000
IOBRSV44 EQU   IOBFLAG4                                                 09133000
IOBJES3I EQU   IOBFLAG4                                                 09134000
IOBRSV42 EQU   IOBFLAG4                                                 09135000
IOBRSV41 EQU   IOBFLAG4                                                 09136000
IOBRSV40 EQU   IOBFLAG4                                                 09137000
IOBPMERR EQU   IOBFLAG4                                                 09138000
IOBCC3WE EQU   IOBFLAG4                                                 09139000
IOBGDPOL EQU   IOBFLAG4                                                 09140000
IOBSTRTB EQU   IOBSTART+1                                               09141000
IOBSIOCC EQU   IOBSTART                                                 09142000
IOBCSB7  EQU   IOBCSTAT                                                 09143000
IOBCSB6  EQU   IOBCSTAT                                                 09144000
IOBCSB5  EQU   IOBCSTAT                                                 09145000
IOBCSB4  EQU   IOBCSTAT                                                 09146000
IOBCSB3  EQU   IOBCSTAT                                                 09147000
IOBCSB2  EQU   IOBCSTAT                                                 09148000
IOBCSB1  EQU   IOBCSTAT                                                 09149000
IOBCSB0  EQU   IOBCSTAT                                                 09150000
IOBUSB7  EQU   IOBUSTAT                                                 09151000
IOBUSB6  EQU   IOBUSTAT                                                 09152000
IOBUSB5  EQU   IOBUSTAT                                                 09153000
IOBUSB4  EQU   IOBUSTAT                                                 09154000
IOBUSB3  EQU   IOBUSTAT                                                 09155000
IOBUSB2  EQU   IOBUSTAT                                                 09156000
IOBUSB1  EQU   IOBUSTAT                                                 09157000
IOBUSB0  EQU   IOBUSTAT                                                 09158000
IOBCMDA  EQU   IOBIOCSW                                                 09159000
IOBLOG   EQU   IOBFL3                                                   09160000
IOBJAM   EQU   IOBICL                                                   09161000
IOBMSG   EQU   IOBFL3                                                   09162000
IOBSDR   EQU   IOBCNC                                                   09163000
IOBACU   EQU   IOBFL3                                                   09164000
IOBCDC   EQU   IOBFL3                                                   09165000
IOBICC   EQU   IOBFL3                                                   09166000
IOBCCC   EQU   IOBFL3                                                   09167000
IOBECBPB EQU   IOBECBPT+1                                               09168000
IOBECBCC EQU   IOBECBPT                                                 09169000
IOBS1B7  EQU   IOBSENS1                                                 09170000
IOBS1B6  EQU   IOBSENS1                                                 09171000
IOBS1B5  EQU   IOBSENS1                                                 09172000
IOBS1B4  EQU   IOBSENS1                                                 09173000
IOBS1B3  EQU   IOBSENS1                                                 09174000
IOBS1B2  EQU   IOBSENS1                                                 09175000
IOBS1B1  EQU   IOBSENS1                                                 09176000
IOBS1B0  EQU   IOBSENS1                                                 09177000
IOBSNSC9 EQU   IOBS0B7                                                  09178000
IOBS0B6  EQU   IOBSENS0                                                 09179000
IOBS0B5  EQU   IOBSENS0                                                 09180000
IOBS0B4  EQU   IOBSENS0                                                 09181000
IOBS0B3  EQU   IOBSENS0                                                 09182000
IOBS0B2  EQU   IOBSENS0                                                 09183000
IOBS0B1  EQU   IOBSENS0                                                 09184000
IOBS0B0  EQU   IOBSENS0                                                 09185000
IOBPNCH  EQU   IOBFLAG2                                                 09186000
IOBSTATO EQU   IOBFLAG2                                                 09187000
IOBSKUPD EQU   IOBFLAG2                                                 09188000
IOBALTTR EQU   IOBFLAG2                                                 09189000
IOBRRT2  EQU   IOBRDHA0                                                 09190000
IOBRRT3  EQU   IOBPURGE                                                 09191000
IOBSENSE EQU   IOBFLAG2                                                 09192000
IOBHALT  EQU   IOBFLAG2                                                 09193000
IOBSPSVC EQU   IOBRSTRT                                                 09194000
IOBUNREL EQU   IOBFLAG1                                                 09195000
IOBIOERR EQU   IOBFLAG1                                                 09196000
IOBFCREX EQU   IOBCYCCK                                                 09197000
IOBRPSTN EQU   IOBFLAG1                                                 09198000
IOBERRTN EQU   IOBFLAG1                                                 09199000
IOBCMDCH EQU   IOBFLAG1                                                 09200000
IOBDATCH EQU   IOBFLAG1                                                 09201000
IOBCNOPA EQU   IOBPREFX+12                                              09202000
IOBCICB  EQU   IOBPREFX+8                                               09203000
IOBCECB  EQU   IOBPREFX+4                                               09204000
IOBCONOP EQU   IOBPREFX+3                                               09205000
IOBCINOP EQU   IOBPREFX+2                                               09206000
IOBRSV05 EQU   IOBPREFX+1                                               09207000
IOBPCI   EQU   IOBCFLG1                                                 09208000
IOBRSTCH EQU   IOBCFLG1                                                 09209000
IOBABAPP EQU   IOBCFLG1                                                 09210000
IOBPTST  EQU   IOBCFLG1                                                 09211000
IOBRSV04 EQU   IOBCFLG1                                                 09212000
IOBRSV03 EQU   IOBCFLG1                                                 09213000
IOBRSV02 EQU   IOBCFLG1                                                 09214000
IOBRSV01 EQU   IOBCFLG1                                                 09215000
DCBNOTE  EQU   DCBCNTRL                                                 09216000
@NM00202 EQU   IHADCS38+8                                               09217000
DCBEOBW  EQU   IHADCS38+4                                               09218000
DCBEOBRA EQU   DCBEOBR+1                                                09219000
DCBNCP   EQU   DCBEOBR                                                  09220000
DCBDIRCQ EQU   DCBBUFOF                                                 09221000
DCBQSTRU EQU   DCBUSASI                                                 09222000
@NM00201 EQU   DCBUSASI                                                 09223000
DCBQADF3 EQU   DCBQADFS                                                 09224000
DCBQADF2 EQU   DCBQADFS                                                 09225000
DCBQADF1 EQU   DCBQADFS                                                 09226000
DCBBLBP  EQU   DCBUSASI                                                 09227000
@NM00200 EQU   DCBUSASI                                                 09228000
DCBCICBA EQU   DCBCICB+1                                                09229000
@NM00199 EQU   DCBCICB                                                  09230000
DCBOFFSW EQU   IHADCS36+15                                              09231000
DCBOFFSR EQU   IHADCS36+14                                              09232000
DCBWCPL  EQU   IHADCS36+13                                              09233000
DCBWCPO  EQU   IHADCS36+12                                              09234000
DCBCNQSM EQU   DCBCIND2                                                 09235000
DCBCNFEO EQU   DCBCIND2                                                 09236000
DCBCNCHS EQU   DCBCIND2                                                 09237000
DCBCNBFP EQU   DCBCIND2                                                 09238000
DCBCNIOE EQU   DCBCIND2                                                 09239000
DCBCNCLO EQU   DCBCIND2                                                 09240000
DCBCNWRO EQU   DCBCIND2                                                 09241000
DCBCNSTO EQU   DCBCIND2                                                 09242000
DCBCNEXB EQU   DCBCIND1                                                 09243000
@NM00198 EQU   DCBCIND1                                                 09244000
DCBCNBRM EQU   DCBCIND1                                                 09245000
@NM00197 EQU   DCBCIND1                                                 09246000
DCBCNEVA EQU   DCBCIND1                                                 09247000
DCBCNEVB EQU   DCBCIND1                                                 09248000
DCBCNSRD EQU   DCBCIND1                                                 09249000
DCBCNTOV EQU   DCBCIND1                                                 09250000
DCBSYNA  EQU   DCBSYNAD+1                                               09251000
DCBIOBL  EQU   DCBSYNAD                                                 09252000
DCBCHCKA EQU   DCBPERRA                                                 09253000
@NM00196 EQU   DCBOPTCD                                                 09254000
DCBOPTT  EQU   DCBOPTCD                                                 09255000
DCBSRCHD EQU   DCBOPTZ                                                  09256000
DCBOPTQ  EQU   DCBOPTCD                                                 09257000
DCBBCKPT EQU   DCBOPTO                                                  09258000
DCBOPTC  EQU   DCBOPTCD                                                 09259000
DCBOPTU  EQU   DCBOPTCD                                                 09260000
DCBOPTW  EQU   DCBOPTCD                                                 09261000
DCBREAD  EQU   DCBWRITE                                                 09262000
@NM00195 EQU   DCBIFLGS                                                 09263000
DCBIFIOE EQU   DCBIFLGS                                                 09264000
DCBIFPCT EQU   DCBIFLGS                                                 09265000
DCBIFEC  EQU   DCBIFLGS                                                 09266000
DCBMFSTI EQU   DCBMFDMD                                                 09267000
DCBMFAWR EQU   DCBMFSTK                                                 09268000
DCBMFUIP EQU   DCBMFTMD                                                 09269000
DCBMFIDW EQU   DCBMFLCP                                                 09270000
DCBMFWRK EQU   DCBMFMVP                                                 09271000
DCBMFRDQ EQU   DCBMFWRT                                                 09272000
DCBMFGTQ EQU   DCBMFPUT                                                 09273000
DCBMFSTL EQU   DCBMACF2                                                 09274000
DCBMFCK  EQU   DCBMFDMG                                                 09275000
DCBMFRDX EQU   DCBMFCHK                                                 09276000
DCBMFDBF EQU   DCBMFSBG                                                 09277000
DCBMFRDI EQU   DCBMFLCG                                                 09278000
DCBMFRDK EQU   DCBMFMVG                                                 09279000
DCBMFWRQ EQU   DCBMFRD                                                  09280000
DCBMFPTQ EQU   DCBMFGET                                                 09281000
DCBMFECP EQU   DCBMACF1                                                 09282000
DCBTIOT  EQU   IHADCS25                                                 09283000
DCBMRSTI EQU   DCBMRDMD                                                 09284000
DCBMRAWR EQU   DCBMRSTK                                                 09285000
DCBMRUIP EQU   DCBMRTMD                                                 09286000
DCBMRIDW EQU   DCBMRLCP                                                 09287000
DCBMRWRK EQU   DCBMRMVP                                                 09288000
DCBMRRDQ EQU   DCBMRWRT                                                 09289000
DCBMRGTQ EQU   DCBMRPUT                                                 09290000
DCBMRSTL EQU   DCBMACR2                                                 09291000
DCBMRCK  EQU   DCBMRDMG                                                 09292000
DCBPGFXA EQU   DCBMRRDX                                                 09293000
DCBMRDBF EQU   DCBMRSBG                                                 09294000
DCBMRRDI EQU   DCBMRLCG                                                 09295000
DCBMRRDK EQU   DCBMRMVG                                                 09296000
DCBMRWRQ EQU   DCBMRRD                                                  09297000
DCBMRPTQ EQU   DCBMRGET                                                 09298000
@NM00194 EQU   DCBIFLG                                                  09299000
DCBIBIOE EQU   DCBIFLG                                                  09300000
DCBIBPCT EQU   DCBIFLG                                                  09301000
DCBIBEC  EQU   DCBIFLG                                                  09302000
DCBOFIOF EQU   DCBOFLGS                                                 09303000
DCBOFUEX EQU   DCBOFLGS                                                 09304000
DCBOFTM  EQU   DCBOFLGS                                                 09305000
DCBOFPPC EQU   DCBOFLGS                                                 09306000
DCBOFEOV EQU   DCBOFLGS                                                 09307000
DCBOFLRB EQU   DCBOFLGS                                                 09308000
DCBOFIOD EQU   DCBOFLWR                                                 09309000
DCBEXLSA EQU   DCBEXLST+1                                               09310000
DCBRECKL EQU   DCBRECFM                                                 09311000
DCBRECCC EQU   DCBRECFM                                                 09312000
DCBRECSB EQU   DCBRECFM                                                 09313000
DCBRECBR EQU   DCBRECFM                                                 09314000
DCBRECTO EQU   DCBRECLA                                                 09315000
DCBBFA   EQU   DCBBFTEK                                                 09316000
DCBH0    EQU   DCBBFTEK                                                 09317000
DCBBFTKD EQU   DCBBFTEK                                                 09318000
DCBBFTE  EQU   DCBBFT                                                   09319000
DCBBFTKR EQU   DCBBFT                                                   09320000
DCBBFTS  EQU   DCBBFT                                                   09321000
DCBH1    EQU   DCBBFTEK                                                 09322000
DCBSVCXA EQU   DCBSVCXL+1                                               09323000
@NM00193 EQU   DCBSVCXL                                                 09324000
DCBODEBA EQU   DCBIOBAA                                                 09325000
@NM00192 EQU   DCBQSLM                                                  09326000
DCBUPDBT EQU   DCBQSLM                                                  09327000
DCBUPDCM EQU   DCBQSLM                                                  09328000
DCB1DVDS EQU   DCBQSLM                                                  09329000
@NM00191 EQU   DCBDSRG2                                                 09330000
DCBACBM  EQU   DCBDSRG2                                                 09331000
@NM00190 EQU   DCBDSRG2                                                 09332000
DCBDSGTQ EQU   DCBDSRG2                                                 09333000
DCBDSGTX EQU   DCBDSRG2                                                 09334000
DCBDSGGS EQU   DCBDSRG2                                                 09335000
DCBDSGPO EQU   DCBDSRG1                                                 09336000
DCBDSGMQ EQU   DCBDSRG1                                                 09337000
DCBDSGCQ EQU   DCBDSRG1                                                 09338000
DCBDSGCX EQU   DCBDSRG1                                                 09339000
DCBDSGDA EQU   DCBDSRG1                                                 09340000
DCBDSGPS EQU   DCBDSRG1                                                 09341000
DCBDSGIS EQU   DCBDSRG1                                                 09342000
DCBBUFL  EQU   IHADCS11+8                                               09343000
DCBBUFCA EQU   DCBBUFCB+1                                               09344000
DCBBUFNO EQU   DCBBUFCB                                                 09345000
DCBDEVT  EQU   DCBREL                                                   09346000
DCBTRBAL EQU   IHADCS01+6                                               09347000
@NM00189 EQU   IHADCS01+5                                               09348000
@NM00188 EQU   IHADCS01+4                                               09349000
DCBDVTBA EQU   DCBDVTBL+1                                               09350000
@NM00187 EQU   DCBDVTBL                                                 09351000
DCBKEYCN EQU   IHADCS00+4                                               09352000
@NM00186 EQU   IHADCB                                                   09353000
JSCBCSCB EQU   JSCBSEC1+68                                              09354000
JSCBPMG  EQU   JSCBWTP+2                                                09355000
JSCBWTSP EQU   JSCBWTP+1                                                09356000
JSCRSV23 EQU   JSCBWTFG                                                 09357000
JSCRSV22 EQU   JSCBWTFG                                                 09358000
JSCRSV21 EQU   JSCBWTFG                                                 09359000
JSCRSV20 EQU   JSCBWTFG                                                 09360000
JSCRSV19 EQU   JSCBWTFG                                                 09361000
JSCRSV18 EQU   JSCBWTFG                                                 09362000
JSCBRET  EQU   JSCBWTFG                                                 09363000
JSCBIOFG EQU   JSCBWTFG                                                 09364000
@NM00183 EQU   JSCBSEC1+60                                              09365000
JSCBQMPI EQU   JSCBSEC1+56                                              09366000
JSCBPMSG EQU   JSCBSWT1                                                 09367000
JSCRSV16 EQU   JSCBSWT1                                                 09368000
JSCRSV15 EQU   JSCBSWT1                                                 09369000
JSCRSV14 EQU   JSCBSWT1                                                 09370000
JSCRSV13 EQU   JSCBSWT1                                                 09371000
JSCRSV12 EQU   JSCBSWT1                                                 09372000
JSCRSV11 EQU   JSCBSWT1                                                 09373000
JSCBPASS EQU   JSCBSWT1                                                 09374000
JSCBTTTR EQU   JSCBSEC1+52                                              09375000
JSCRSV10 EQU   JSCBSEC1+49                                              09376000
JSCBAUTH EQU   JSCBOPTS                                                 09377000
JSCSIOTS EQU   JSCBOPTS                                                 09378000
JSCRSV08 EQU   JSCBOPTS                                                 09379000
JSCRSV07 EQU   JSCBOPTS                                                 09380000
JSCRSV06 EQU   JSCBOPTS                                                 09381000
JSCBLONG EQU   JSCBOPTS                                                 09382000
JSCRSV05 EQU   JSCBOPTS                                                 09383000
JSCRSV04 EQU   JSCBOPTS                                                 09384000
JSCBSECB EQU   JSCBSEC1+44                                              09385000
JSCRSV03 EQU   JSCBSEC1+41                                              09386000
JSCBSTEP EQU   JSCBSEC1+40                                              09387000
JSCBDCBA EQU   JSCBDCB+1                                                09388000
JSCRSV02 EQU   JSCBDCB                                                  09389000
JSCBID   EQU   JSCBSEC1+32                                              09390000
JSCBDBTB EQU   JSCBSEC1+28                                              09391000
JSCBIJSC EQU   JSCBSEC1+24                                              09392000
JSCBPCC  EQU   JSCBSEC1+16                                              09393000
JSCBTCP  EQU   JSCBSEC1+12                                              09394000
JSCBSHR  EQU   JSCBSEC1+8                                               09395000
JSCHPCEA EQU   JSCHPCE+1                                                09396000
JSCRSV32 EQU   JSCHPCE                                                  09397000
JSCRSV01 EQU   JSCBSEC1                                                 09398000
@NM00182 EQU   IEZJSCB                                                  09399000
@NM00181 EQU   TCBXTNT2+32                                              09400000
TCBRV181 EQU   TCBRV173                                                 09401000
TCBRV180 EQU   TCBRV173                                                 09402000
TCBRV179 EQU   TCBRV173                                                 09403000
TCBRV178 EQU   TCBRV173                                                 09404000
TCBRV177 EQU   TCBRV173                                                 09405000
TCBRV176 EQU   TCBRV173                                                 09406000
TCBRV175 EQU   TCBRV173                                                 09407000
TCBRV174 EQU   TCBRV173                                                 09408000
TCBRV172 EQU   TCBRV164                                                 09409000
TCBRV171 EQU   TCBRV164                                                 09410000
TCBRV170 EQU   TCBRV164                                                 09411000
TCBRV169 EQU   TCBRV164                                                 09412000
TCBRV168 EQU   TCBRV164                                                 09413000
TCBRV167 EQU   TCBRV164                                                 09414000
TCBRV166 EQU   TCBRV164                                                 09415000
TCBRV165 EQU   TCBRV164                                                 09416000
TCBRV163 EQU   TCBRV155                                                 09417000
TCBRV162 EQU   TCBRV155                                                 09418000
TCBRV161 EQU   TCBRV155                                                 09419000
TCBRV160 EQU   TCBRV155                                                 09420000
TCBRV159 EQU   TCBRV155                                                 09421000
TCBRV158 EQU   TCBRV155                                                 09422000
TCBRV157 EQU   TCBRV155                                                 09423000
TCBRV156 EQU   TCBRV155                                                 09424000
TCBRV154 EQU   TCBRV146                                                 09425000
TCBRV153 EQU   TCBRV146                                                 09426000
TCBRV152 EQU   TCBRV146                                                 09427000
TCBRV151 EQU   TCBRV146                                                 09428000
TCBRV150 EQU   TCBRV146                                                 09429000
TCBRV149 EQU   TCBRV146                                                 09430000
TCBRV148 EQU   TCBRV146                                                 09431000
TCBRV147 EQU   TCBRV146                                                 09432000
TCBRV145 EQU   TCBXTNT2+26                                              09433000
TCBRV144 EQU   TCBXTNT2+24                                              09434000
TCBRV143 EQU   TCBXTNT2+20                                              09435000
TCBRV142 EQU   TCBXTNT2+16                                              09436000
TCBRSV49 EQU   TCBXTNT2+12                                              09437000
TCBEVENT EQU   TCBXTNT2+8                                               09438000
TCBRCMP  EQU   TCBXTNT2+5                                               09439000
TCBRSVAB EQU   TCBXTNT2+4                                               09440000
TCBGTFA  EQU   TCBGTF+1                                                 09441000
TCBRSV47 EQU   TCBTFLG                                                  09442000
TCBRSV46 EQU   TCBTFLG                                                  09443000
TCBRSV45 EQU   TCBTFLG                                                  09444000
TCBRSV44 EQU   TCBTFLG                                                  09445000
TCBRSV43 EQU   TCBTFLG                                                  09446000
TCBDSPIT EQU   TCBTFLG                                                  09447000
TCBERRTN EQU   TCBTFLG                                                  09448000
TCBASYNC EQU   TCBTFLG                                                  09449000
@NM00180 EQU   TCB+296                                                  09450000
TCBSVCA2 EQU   TCB+292                                                  09451000
TCBSWASA EQU   TCB+288                                                  09452000
TCBDBTB  EQU   TCB+284                                                  09453000
TCBRPT   EQU   TCB+280                                                  09454000
TCBRV141 EQU   TCBRV133                                                 09455000
TCBRV140 EQU   TCBRV133                                                 09456000
TCBRV139 EQU   TCBRV133                                                 09457000
TCBRV138 EQU   TCBRV133                                                 09458000
TCBRV137 EQU   TCBRV133                                                 09459000
TCBRV136 EQU   TCBRV133                                                 09460000
TCBRV135 EQU   TCBRV133                                                 09461000
TCBRV134 EQU   TCBRV133                                                 09462000
TCBRV132 EQU   TCBRV124                                                 09463000
TCBRV131 EQU   TCBRV124                                                 09464000
TCBRV130 EQU   TCBRV124                                                 09465000
TCBRV129 EQU   TCBRV124                                                 09466000
TCBRV128 EQU   TCBRV124                                                 09467000
TCBRV127 EQU   TCBRV124                                                 09468000
TCBRV126 EQU   TCBRV124                                                 09469000
TCBRV125 EQU   TCBRV124                                                 09470000
TCBRV123 EQU   TCBFBYT2                                                 09471000
TCBRV122 EQU   TCBFBYT2                                                 09472000
TCBECBNV EQU   TCBFBYT2                                                 09473000
TCBSSSYN EQU   TCBFBYT2                                                 09474000
TCBFPRAP EQU   TCBFBYT2                                                 09475000
TCBFDW   EQU   TCBFBYT2                                                 09476000
TCBFMW   EQU   TCBFBYT2                                                 09477000
TCBCNCB  EQU   TCBFBYT2                                                 09478000
TCBLLH   EQU   TCBFBYT1                                                 09479000
TCBRV113 EQU   TCBFBYT1                                                 09480000
TCBEOT   EQU   TCBFBYT1                                                 09481000
TCBRTM2  EQU   TCBFBYT1                                                 09482000
TCBPGNLY EQU   TCBFBYT1                                                 09483000
TCBNDIOS EQU   TCBFBYT1                                                 09484000
TCBRV327 EQU   TCBFBYT1                                                 09485000
TCBEOTFM EQU   TCBFBYT1                                                 09486000
TCBAFFN  EQU   TCB+274                                                  09487000
TCBRV326 EQU   TCB+272                                                  09488000
TCBUKYSP EQU   TCB+268                                                  09489000
TCBMODE  EQU   TCBESTAE+3                                               09490000
TCBERTYP EQU   TCBESTAE+2                                               09491000
TCBRV314 EQU   TCBESTRM                                                 09492000
TCBRV313 EQU   TCBESTRM                                                 09493000
TCBRV312 EQU   TCBESTRM                                                 09494000
TCBRV311 EQU   TCBESTRM                                                 09495000
TCBRV310 EQU   TCBESTRM                                                 09496000
TCBRV309 EQU   TCBESTRM                                                 09497000
TCBRV308 EQU   TCBESTRM                                                 09498000
TCBETERM EQU   TCBESTRM                                                 09499000
TCBSCBKY EQU   TCBESTAE                                                 09500000
TCBRTM12 EQU   TCB+260                                                  09501000
TCBTCBID EQU   TCB+256                                                  09502000
TCBSTAWA EQU   TCB+252                                                  09503000
TCBSWA   EQU   TCB+248                                                  09504000
TCBFOEA  EQU   TCBFOE+1                                                 09505000
TCBRSV42 EQU   TCBFOE                                                   09506000
TCBCCPVI EQU   TCBXSCT+2                                                09507000
TCBRV325 EQU   TCBXSCT+1                                                09508000
TCBRV324 EQU   TCBXSCT1                                                 09509000
TCBRV323 EQU   TCBXSCT1                                                 09510000
TCBRV322 EQU   TCBXSCT1                                                 09511000
TCBRV321 EQU   TCBXSCT1                                                 09512000
TCBRV320 EQU   TCBXSCT1                                                 09513000
TCBRV319 EQU   TCBXSCT1                                                 09514000
TCBS3A   EQU   TCBXSCT1                                                 09515000
TCBACTIV EQU   TCBXSCT1                                                 09516000
TCBRSV41 EQU   TCB+239                                                  09517000
TCBTID   EQU   TCB+238                                                  09518000
TCBRSVAA EQU   TCB+237                                                  09519000
TCBABCUR EQU   TCB+236                                                  09520000
TCBTMSAV EQU   TCB+232                                                  09521000
TCBIOTIM EQU   TCB+228                                                  09522000
TCBRTWA  EQU   TCB+224                                                  09523000
TCBBACK  EQU   TCB+220                                                  09524000
TCBTIRB  EQU   TCB+216                                                  09525000
TCBAECB  EQU   TCB+212                                                  09526000
TCBEXT2A EQU   TCBEXT2+1                                                09527000
TCBRSV39 EQU   TCBEXT2                                                  09528000
TCBSTMCT EQU   TCB+207                                                  09529000
TCBSYSCT EQU   TCB+206                                                  09530000
TCBRSV37 EQU   TCB+205                                                  09531000
TCBEXSVC EQU   TCBDAR                                                   09532000
TCBDARMS EQU   TCBDAR                                                   09533000
TCBDARWT EQU   TCBDAR                                                   09534000
TCBDARO  EQU   TCBDAR                                                   09535000
TCBDARMC EQU   TCBDARC                                                  09536000
TCBDARD  EQU   TCBDAR                                                   09537000
TCBDARS  EQU   TCBDAR                                                   09538000
TCBDARP  EQU   TCBDAR                                                   09539000
TCBGTOFM EQU   TCBFLGS7                                                 09540000
TCBADMP  EQU   TCBFLGS7                                                 09541000
TCBRSTSK EQU   TCBFLGS7                                                 09542000
TCBSVCS  EQU   TCBFLGS7                                                 09543000
TCBSTACK EQU   TCBFLGS7                                                 09544000
TCBRSV34 EQU   TCBFLGS7                                                 09545000
TCBRSV33 EQU   TCBFLGS7                                                 09546000
TCBGPECB EQU   TCBFLGS7                                                 09547000
TCBNTJS  EQU   TCBFLGS6                                                 09548000
TCBAPG   EQU   TCBFLGS6                                                 09549000
TCBMIGR  EQU   TCBFLGS6                                                 09550000
TCBRV303 EQU   TCBFLGS6                                                 09551000
TCBSPVLK EQU   TCBFLGS6                                                 09552000
TCBCPU   EQU   TCBFLGS6                                                 09553000
TCBPIE17 EQU   TCBFLGS6                                                 09554000
TCBRV    EQU   TCBFLGS6                                                 09555000
TCBRSV79 EQU   TCBNDSP5                                                 09556000
TCBRSV78 EQU   TCBNDSP5                                                 09557000
TCBRSV77 EQU   TCBNDSP5                                                 09558000
TCBRSV76 EQU   TCBNDSP5                                                 09559000
TCBRSV75 EQU   TCBNDSP5                                                 09560000
TCBRSV74 EQU   TCBNDSP5                                                 09561000
TCBRSV95 EQU   TCBNDSP5                                                 09562000
TCBRSV94 EQU   TCBNDSP5                                                 09563000
TCBRSV93 EQU   TCBNDSP4                                                 09564000
TCBRSV92 EQU   TCBNDSP4                                                 09565000
TCBRSV91 EQU   TCBNDSP4                                                 09566000
TCBRSV90 EQU   TCBNDSP4                                                 09567000
TCBRSV89 EQU   TCBNDSP4                                                 09568000
TCBRSV88 EQU   TCBNDSP4                                                 09569000
TCBRSV87 EQU   TCBNDSP4                                                 09570000
TCBRSV86 EQU   TCBNDSP4                                                 09571000
TCBEXT1A EQU   TCBEXT1+1                                                09572000
TCBRSV32 EQU   TCBEXT1                                                  09573000
TCBEXCPD EQU   TCB+192                                                  09574000
TCBIOBRC EQU   TCB+188                                                  09575000
TCBDDWTC EQU   TCB+186                                                  09576000
TCBDDEXC EQU   TCB+184                                                  09577000
TCBJSCBB EQU   TCBJSCB+1                                                09578000
@NM00179 EQU   TCBRECDE                                                 09579000
TCBREC   EQU   TCBRECDE                                                 09580000
TCBMDIDS EQU   TCB+176                                                  09581000
TCBNDINT EQU   TCBNDSP3                                                 09582000
TCBRSV27 EQU   TCBNDSP3                                                 09583000
TCBRSV26 EQU   TCBNDSP3                                                 09584000
TCBRSV25 EQU   TCBNDSP3                                                 09585000
TCBRSV24 EQU   TCBNDSP3                                                 09586000
TCBSRBND EQU   TCBNDSP3                                                 09587000
TCBRV302 EQU   TCBNDSP3                                                 09588000
TCBLJSND EQU   TCBNDSP3                                                 09589000
TCBABE   EQU   TCBNDSP2                                                 09590000
TCBDSS   EQU   TCBNDSP2                                                 09591000
TCBOWAIT EQU   TCBNDSP2                                                 09592000
TCBIWAIT EQU   TCBNDSP2                                                 09593000
TCBNDTS  EQU   TCBNDSP2                                                 09594000
TCBNDSVC EQU   TCBNDSP2                                                 09595000
TCBSTPP  EQU   TCBNDSP2                                                 09596000
TCBABD   EQU   TCBNDSP2                                                 09597000
TCBRSV22 EQU   TCBNDSP1                                                 09598000
TCBPIEND EQU   TCBNDSP1                                                 09599000
TCBTPSP  EQU   TCBNDSP1                                                 09600000
TCBDDRND EQU   TCBNDSP1                                                 09601000
TCBRSPND EQU   TCBNDSP1                                                 09602000
TCBRSTND EQU   TCBNDSP1                                                 09603000
TCBDARPN EQU   TCBNDSP1                                                 09604000
TCBDARTN EQU   TCBNDSP1                                                 09605000
TCBNDSP0 EQU   TCBNDSP                                                  09606000
TCBUSER  EQU   TCB+168                                                  09607000
TCBTCTB  EQU   TCBTCT+1                                                 09608000
TCBRSV9C EQU   TCBTCTGF                                                 09609000
TCBRSV9B EQU   TCBTCTGF                                                 09610000
TCBRSV9A EQU   TCBTCTGF                                                 09611000
TCBRSV99 EQU   TCBTCTGF                                                 09612000
TCBRSV98 EQU   TCBTCTGF                                                 09613000
TCBRSV97 EQU   TCBTCTGF                                                 09614000
TCBRSV20 EQU   TCBTCTGF                                                 09615000
TCBSMFGF EQU   TCBTCTGF                                                 09616000
TCBSTABB EQU   TCBSTAB+1                                                09617000
TCBSTCUR EQU   TCBNSTAE                                                 09618000
TCBRV301 EQU   TCBNSTAE                                                 09619000
TCBSYNCH EQU   TCBNSTAE                                                 09620000
TCBHALT  EQU   TCBNSTAE                                                 09621000
TCBPPSUP EQU   TCBNSTAE                                                 09622000
TCB33E   EQU   TCBNSTAE                                                 09623000
TCBQUIES EQU   TCBNSTAE                                                 09624000
TCBSTABE EQU   TCBNSTAE                                                 09625000
TCBAQE   EQU   TCB+156                                                  09626000
TCBPQE   EQU   TCB+152                                                  09627000
TCBTSDP  EQU   TCB+151                                                  09628000
TCBTSLP  EQU   TCB+150                                                  09629000
TCBSTPCT EQU   TCB+149                                                  09630000
TCBCPUBN EQU   TCBTSFLG                                                 09631000
TCBDYDSP EQU   TCBTSFLG                                                 09632000
TCBRSV18 EQU   TCBTSFLG                                                 09633000
TCBRSV17 EQU   TCBTSFLG                                                 09634000
TCBTIOTG EQU   TCBTSFLG                                                 09635000
TCBATT   EQU   TCBTSFLG                                                 09636000
TCBSTPPR EQU   TCBTSFLG                                                 09637000
TCBRV300 EQU   TCBTSTSK                                                 09638000
TCBECB   EQU   TCB+144                                                  09639000
TCBIQE   EQU   TCB+140                                                  09640000
TCBLTC   EQU   TCB+136                                                  09641000
TCBOTC   EQU   TCB+132                                                  09642000
TCBNTC   EQU   TCB+128                                                  09643000
TCBJSTCA EQU   TCBJSTCB+1                                               09644000
TCBRSV16 EQU   TCBJSTCB                                                 09645000
TCBTQET  EQU   TCBTME                                                   09646000
TCBTCB   EQU   TCB+116                                                  09647000
TCBFSAB  EQU   TCBFSA+1                                                 09648000
TCBQEL   EQU   TCBFSA                                                   09649000
TCBGRS15 EQU   TCBGRS+60                                                09650000
TCBGRS14 EQU   TCBGRS+56                                                09651000
TCBGRS13 EQU   TCBGRS+52                                                09652000
TCBGRS12 EQU   TCBGRS+48                                                09653000
TCBGRS11 EQU   TCBGRS+44                                                09654000
TCBGRS10 EQU   TCBGRS+40                                                09655000
TCBGRS9  EQU   TCBGRS+36                                                09656000
TCBGRS8  EQU   TCBGRS+32                                                09657000
TCBGRS7  EQU   TCBGRS+28                                                09658000
TCBGRS6  EQU   TCBGRS+24                                                09659000
TCBGRS5  EQU   TCBGRS+20                                                09660000
TCBGRS4  EQU   TCBGRS+16                                                09661000
TCBGRS3  EQU   TCBGRS+12                                                09662000
TCBGRS2  EQU   TCBGRS+8                                                 09663000
TCBGRS1  EQU   TCBGRS+4                                                 09664000
TCBGRS0  EQU   TCBGRS                                                   09665000
TCBJPQB  EQU   TCBJPQ+1                                                 09666000
TCBRSV15 EQU   TCBPURGE                                                 09667000
TCBRSV14 EQU   TCBPURGE                                                 09668000
TCBRSV13 EQU   TCBPURGE                                                 09669000
TCBRSV12 EQU   TCBPURGE                                                 09670000
TCBRSV11 EQU   TCBPURGE                                                 09671000
TCBRSV10 EQU   TCBPURGE                                                 09672000
TCBRSV09 EQU   TCBPURGE                                                 09673000
TCBJPQF  EQU   TCBPURGE                                                 09674000
TCBJLB   EQU   TCB+40                                                   09675000
TCBLLS   EQU   TCB+36                                                   09676000
TCBDSP   EQU   TCB+35                                                   09677000
TCBLMP   EQU   TCB+34                                                   09678000
TCBPNDSP EQU   TCBFLGS5                                                 09679000
TCBFCD1  EQU   TCBFLGS5                                                 09680000
TCBSTP   EQU   TCBFLGS5                                                 09681000
TCBSYS   EQU   TCBFLGS5                                                 09682000
TCBANDSP EQU   TCBFLGS5                                                 09683000
TCBPAGE  EQU   TCBFLGS5                                                 09684000
TCBUXNDF EQU   TCBABWF                                                  09685000
TCBFC    EQU   TCBFLGS5                                                 09686000
TCBONDSP EQU   TCBFLGS4                                                 09687000
TCBMPCND EQU   TCBFLGS4                                                 09688000
TCBMPCVQ EQU   TCBFLGS4                                                 09689000
TCBUXNDV EQU   TCBFLGS4                                                 09690000
TCBHNDSP EQU   TCBFLGS4                                                 09691000
TCBRQENA EQU   TCBFLGS4                                                 09692000
TCBSER   EQU   TCBFLGS4                                                 09693000
TCBNDUMP EQU   TCBFLGS4                                                 09694000
TCBDWSTA EQU   TCBFLGS3                                                 09695000
TCBRSV08 EQU   TCBFLGS3                                                 09696000
TCBRSV07 EQU   TCBFLGS3                                                 09697000
TCBRSV06 EQU   TCBFLGS3                                                 09698000
TCBABGM  EQU   TCBFLGS3                                                 09699000
TCBABTRM EQU   TCBFLGS3                                                 09700000
TCBADINP EQU   TCBFLGS3                                                 09701000
TCBFSM   EQU   TCBFLGS3                                                 09702000
TCBFTS   EQU   TCBFLGS2                                                 09703000
TCBFETXR EQU   TCBFLGS2                                                 09704000
TCBFDSOP EQU   TCBFLGS2                                                 09705000
TCBFJMC  EQU   TCBFLGS2                                                 09706000
TCBFSMC  EQU   TCBFLGS2                                                 09707000
TCBFABOP EQU   TCBFLGS2                                                 09708000
TCBFSTI  EQU   TCBFLGS2                                                 09709000
TCBFOINP EQU   TCBFLGS2                                                 09710000
TCBFX    EQU   TCBFLGS1                                                 09711000
TCBFS    EQU   TCBFLGS1                                                 09712000
TCBFT    EQU   TCBFLGS1                                                 09713000
TCBPDUMP EQU   TCBFLGS1                                                 09714000
TCBNONPR EQU   TCBFLGS1                                                 09715000
TCBFERA  EQU   TCBFLGS1                                                 09716000
TCBFE    EQU   TCBFLGS1                                                 09717000
TCBFA    EQU   TCBFLGS1                                                 09718000
TCBZERO  EQU   TCBPKF                                                   09719000
TCBFLAG  EQU   TCBPKF                                                   09720000
TCBMSSB  EQU   TCBMSS+1                                                 09721000
TCBRSV03 EQU   TCBMSS                                                   09722000
TCBTRNB  EQU   TCBTRN+1                                                 09723000
TCBRSV02 EQU   TCBABF                                                   09724000
TCBOLTEP EQU   TCBABF                                                   09725000
TCBTCP   EQU   TCBABF                                                   09726000
TCBTCPP  EQU   TCBABF                                                   09727000
TCBRSV01 EQU   TCBABF                                                   09728000
TCBGRPH  EQU   TCBABF                                                   09729000
TCBNOCHK EQU   TCBABF                                                   09730000
TCBMOD91 EQU   TCBABF                                                   09731000
TCBCMPC  EQU   TCBCMP+1                                                 09732000
TCBRV318 EQU   TCBCMSG                                                  09733000
TCBRV317 EQU   TCBCIND                                                  09734000
TCBRV316 EQU   TCBCWTO                                                  09735000
TCBCASID EQU   TCBCDBL                                                  09736000
TCBNOCC  EQU   TCBSTCC                                                  09737000
TCBDMPO  EQU   TCBCPP                                                   09738000
TCBCSTEP EQU   TCBCMPF                                                  09739000
TCBCREQ  EQU   TCBCMPF                                                  09740000
TCBTIO   EQU   TCB+12                                                   09741000
TCBDEB   EQU   TCB+8                                                    09742000
TCBPIEA  EQU   TCBPIE+1                                                 09743000
TCBPM    EQU   TCBPMASK                                                 09744000
@NM00178 EQU   TCBPMASK                                                 09745000
TCBRBP   EQU   TCB                                                      09746000
TCBFRS6  EQU   TCBFRS+24                                                09747000
TCBFRS4  EQU   TCBFRS+16                                                09748000
TCBFRS2  EQU   TCBFRS+8                                                 09749000
TCBFRS0  EQU   TCBFRS                                                   09750000
CVTLEVL  EQU   CVTRELNO+2                                               09751000
CVTNUMB  EQU   CVTRELNO                                                 09752000
CVTMDL   EQU   CVTFIX+250                                               09753000
@NM00177 EQU   CVTFIX+248                                               09754000
@NM00176 EQU   CVTFIX                                                   09755000
CVTRV482 EQU   CVTXTNT2+128                                             09756000
CVTRV481 EQU   CVTXTNT2+124                                             09757000
CVTRV480 EQU   CVTXTNT2+120                                             09758000
CVTRV479 EQU   CVTXTNT2+118                                             09759000
CVTRV478 EQU   CVTXTNT2+117                                             09760000
CVTRV477 EQU   CVTXTNT2+116                                             09761000
CVTRV476 EQU   CVTXTNT2+115                                             09762000
CVTRV475 EQU   CVTXTNT2+114                                             09763000
CVTRV474 EQU   CVTRV466                                                 09764000
CVTRV473 EQU   CVTRV466                                                 09765000
CVTRV472 EQU   CVTRV466                                                 09766000
CVTRV471 EQU   CVTRV466                                                 09767000
CVTRV470 EQU   CVTRV466                                                 09768000
CVTRV469 EQU   CVTRV466                                                 09769000
CVTRV468 EQU   CVTRV466                                                 09770000
CVTRV467 EQU   CVTRV466                                                 09771000
CVTRV465 EQU   CVTRV457                                                 09772000
CVTRV464 EQU   CVTRV457                                                 09773000
CVTRV463 EQU   CVTRV457                                                 09774000
CVTRV462 EQU   CVTRV457                                                 09775000
CVTRV461 EQU   CVTRV457                                                 09776000
CVTRV460 EQU   CVTRV457                                                 09777000
CVTRV459 EQU   CVTRV457                                                 09778000
CVTRV458 EQU   CVTRV457                                                 09779000
CVTRV456 EQU   CVTXTNT2+108                                             09780000
CVTRV455 EQU   CVTXTNT2+104                                             09781000
CVTRV454 EQU   CVTXTNT2+100                                             09782000
CVTRV453 EQU   CVTXTNT2+96                                              09783000
CVTRV452 EQU   CVTXTNT2+94                                              09784000
CVTRV451 EQU   CVTXTNT2+92                                              09785000
CVTRV450 EQU   CVTXTNT2+90                                              09786000
CVTRV449 EQU   CVTXTNT2+88                                              09787000
CVTRV448 EQU   CVTXTNT2+87                                              09788000
CVTRV447 EQU   CVTXTNT2+86                                              09789000
CVTRV446 EQU   CVTRV438                                                 09790000
CVTRV445 EQU   CVTRV438                                                 09791000
CVTRV444 EQU   CVTRV438                                                 09792000
CVTRV443 EQU   CVTRV438                                                 09793000
CVTRV442 EQU   CVTRV438                                                 09794000
CVTRV441 EQU   CVTRV438                                                 09795000
CVTRV440 EQU   CVTRV438                                                 09796000
CVTRV439 EQU   CVTRV438                                                 09797000
CVTRV437 EQU   CVTRV429                                                 09798000
CVTRV436 EQU   CVTRV429                                                 09799000
CVTRV435 EQU   CVTRV429                                                 09800000
CVTRV434 EQU   CVTRV429                                                 09801000
CVTRV433 EQU   CVTRV429                                                 09802000
CVTRV432 EQU   CVTRV429                                                 09803000
CVTRV431 EQU   CVTRV429                                                 09804000
CVTRV430 EQU   CVTRV429                                                 09805000
CVTRV428 EQU   CVTXTNT2+80                                              09806000
CVTRV427 EQU   CVTXTNT2+76                                              09807000
CVTRV426 EQU   CVTXTNT2+72                                              09808000
CVTRV425 EQU   CVTXTNT2+68                                              09809000
CVTATACT EQU   CVTATCVT                                                 09810000
CVTRV423 EQU   CVTXTNT2+62                                              09811000
CVTRV422 EQU   CVTXTNT2+60                                              09812000
CVTRV421 EQU   CVTXTNT2+58                                              09813000
CVTRV420 EQU   CVTXTNT2+56                                              09814000
CVTRV419 EQU   CVTXTNT2+55                                              09815000
CVTRV418 EQU   CVTXTNT2+54                                              09816000
CVTRV417 EQU   CVTRV409                                                 09817000
CVTRV416 EQU   CVTRV409                                                 09818000
CVTRV415 EQU   CVTRV409                                                 09819000
CVTRV414 EQU   CVTRV409                                                 09820000
CVTRV413 EQU   CVTRV409                                                 09821000
CVTRV412 EQU   CVTRV409                                                 09822000
CVTRV411 EQU   CVTRV409                                                 09823000
CVTRV410 EQU   CVTRV409                                                 09824000
CVTRV408 EQU   CVTRV400                                                 09825000
CVTRV407 EQU   CVTRV400                                                 09826000
CVTRV406 EQU   CVTRV400                                                 09827000
CVTRV405 EQU   CVTRV400                                                 09828000
CVTRV404 EQU   CVTRV400                                                 09829000
CVTRV403 EQU   CVTRV400                                                 09830000
CVTRV402 EQU   CVTRV400                                                 09831000
CVTRV401 EQU   CVTRV400                                                 09832000
CVTICB   EQU   CVTXTNT2+48                                              09833000
CVTSKTA  EQU   CVTXTNT2+44                                              09834000
CVTRSV99 EQU   CVTXTNT2+40                                              09835000
CVTRSV98 EQU   CVTXTNT2+36                                              09836000
CVTRSV97 EQU   CVTXTNT2+34                                              09837000
CVTRSV96 EQU   CVTXTNT2+32                                              09838000
CVTOLTEP EQU   CVTXTNT2+28                                              09839000
CVTQIDA  EQU   CVTQID+1                                                 09840000
CVTRSV95 EQU   CVTQID                                                   09841000
CVTRSV94 EQU   CVTXTNT2+20                                              09842000
CVTRSV93 EQU   CVTXTNT2+16                                              09843000
CVTRSV92 EQU   CVTXTNT2+12                                              09844000
CVTDEBVR EQU   CVTXTNT2+8                                               09845000
CVTRSV91 EQU   CVTXTNT2+6                                               09846000
CVTRSV9H EQU   CVTFLGBT                                                 09847000
CVTRSV9G EQU   CVTFLGBT                                                 09848000
CVTRSV9F EQU   CVTFLGBT                                                 09849000
CVTRSV9E EQU   CVTFLGBT                                                 09850000
CVTRSV9D EQU   CVTFLGBT                                                 09851000
CVTBAH   EQU   CVTFLGBT                                                 09852000
CVTVME   EQU   CVTFLGBT                                                 09853000
CVTNPE   EQU   CVTFLGBT                                                 09854000
CVTNUCLS EQU   CVTXTNT2+4                                               09855000
CVTDSSVA EQU   CVTDSSV+1                                                09856000
CVTRSV89 EQU   CVTDSSV                                                  09857000
CVTRSV88 EQU   CVTXTNT1+8                                               09858000
CVTRSV87 EQU   CVTXTNT1+4                                               09859000
CVTFACHN EQU   CVTXTNT1                                                 09860000
CVTRV488 EQU   CVTMAP+412                                               09861000
CVTRV487 EQU   CVTMAP+408                                               09862000
CVTRV486 EQU   CVTMAP+404                                               09863000
CVTRV485 EQU   CVTMAP+400                                               09864000
CVTACTAP EQU   CVTMAP+396                                               09865000
CVTAUTH  EQU   CVTMAP+392                                               09866000
CVTRV490 EQU   CVTMAP+388                                               09867000
CVTSU    EQU   CVTMAP+384                                               09868000
CVTVOLT1 EQU   CVTVOLM1+1                                               09869000
CVTVOLI1 EQU   CVTVOLF1                                                 09870000
CVTSTOA  EQU   CVTMAP+376                                               09871000
CVTRSV58 EQU   CVTMAP+374                                               09872000
CVTRSV57 EQU   CVTMAP+372                                               09873000
CVTDDCE  EQU   CVTMAP+368                                               09874000
CVTPNWFR EQU   CVTMAP+364                                               09875000
CVTSMF   EQU   CVTMAP+360                                               09876000
CVTSULK  EQU   CVTMAP+358                                               09877000
CVTSLKO  EQU   CVTSYSK                                                  09878000
CVTSLKP  EQU   CVTSYSK                                                  09879000
CVTSLKQ  EQU   CVTSYSK                                                  09880000
CVTSLKR  EQU   CVTSYSK                                                  09881000
CVTRSV56 EQU   CVTSYSK                                                  09882000
CVTRSV55 EQU   CVTSYSK                                                  09883000
CVTRSV54 EQU   CVTSYSK                                                  09884000
CVTRSV53 EQU   CVTSYSK                                                  09885000
CVTRSV52 EQU   CVTA1F1                                                  09886000
CVTRSV51 EQU   CVTA1F1                                                  09887000
CVTRSV50 EQU   CVTA1F1                                                  09888000
CVTRSV49 EQU   CVTA1F1                                                  09889000
CVTRSV48 EQU   CVTA1F1                                                  09890000
CVTRSV47 EQU   CVTA1F1                                                  09891000
CVTSRSW  EQU   CVTA1F1                                                  09892000
CVTPFSW  EQU   CVTA1F1                                                  09893000
CVTPCVT  EQU   CVTMAP+352                                               09894000
CVTRSV46 EQU   CVTMAP+344                                               09895000
CVTRSV45 EQU   CVTMAP+340                                               09896000
CVTRSV44 EQU   CVTMAP+338                                               09897000
CVTRSV43 EQU   CVTMAP+336                                               09898000
CVTHJESA EQU   CVTHJES+1                                                09899000
CVTRSV42 EQU   CVTHJES                                                  09900000
CVTEXT2A EQU   CVTEXT2+1                                                09901000
CVTRSV41 EQU   CVTEXT2                                                  09902000
CVTAPFA  EQU   CVTAPF+1                                                 09903000
CVTRSV40 EQU   CVTAPF                                                   09904000
CVTRV518 EQU   CVTINTLA                                                 09905000
CVTRV517 EQU   CVTERPV                                                  09906000
CVTEORM  EQU   CVTMAP+312                                               09907000
CVTMCHPR EQU   CVTMAP+308                                               09908000
CVTTZ    EQU   CVTMAP+304                                               09909000
CVTJEPS  EQU   CVTMAP+300                                               09910000
CVTJESCT EQU   CVTMAP+296                                               09911000
CVTMODE  EQU   CVTMAP+292                                               09912000
CVTPTRV  EQU   CVTMAP+288                                               09913000
CVTREAL  EQU   CVTMAP+284                                               09914000
CVTRSV39 EQU   CVTMAP+280                                               09915000
CVTRSV38 EQU   CVTMAP+276                                               09916000
CVTDMSRA EQU   CVTDMSR+1                                                09917000
CVTRV634 EQU   CVTDMSRF                                                 09918000
CVTRV633 EQU   CVTDMSRF                                                 09919000
CVTRV632 EQU   CVTDMSRF                                                 09920000
CVTRV631 EQU   CVTDMSRF                                                 09921000
CVTRV630 EQU   CVTDMSRF                                                 09922000
CVTRV629 EQU   CVTDMSRF                                                 09923000
CVTUDUMP EQU   CVTDMSRF                                                 09924000
CVTSDUMP EQU   CVTDMSRF                                                 09925000
CVTQMSGA EQU   CVTQMSG+1                                                09926000
CVTRSV36 EQU   CVTQMSG                                                  09927000
CVTAMFF  EQU   CVTMAP+264                                               09928000
CVTPURGA EQU   CVTPURG+1                                                09929000
CVTRSV35 EQU   CVTPURG                                                  09930000
CVTCBSP  EQU   CVTMAP+256                                               09931000
CVTATERA EQU   CVTATER+1                                                09932000
CVTSYST  EQU   CVTATER                                                  09933000
CVTVOLT2 EQU   CVTTAT                                                   09934000
CVTVOLI2 EQU   CVTVOLF2                                                 09935000
CVTAQAVB EQU   CVTAQAVT+1                                               09936000
CVTRSV34 EQU   CVTTCMFG                                                 09937000
CVTRSV33 EQU   CVTTCMFG                                                 09938000
CVTRSV32 EQU   CVTTCMFG                                                 09939000
CVTRSV31 EQU   CVTTCMFG                                                 09940000
CVTRSV30 EQU   CVTTCMFG                                                 09941000
CVTRSV29 EQU   CVTTCMFG                                                 09942000
CVTLDEV  EQU   CVTTCMFG                                                 09943000
CVTTCRDY EQU   CVTTCMFG                                                 09944000
CVTGTFA  EQU   CVTGTF+1                                                 09945000
CVTRSV27 EQU   CVTGTFST                                                 09946000
CVTRNIO  EQU   CVTGTFST                                                 09947000
CVTUSR   EQU   CVTGTFST                                                 09948000
CVTRV318 EQU   CVTFORM                                                  09949000
CVTRV317 EQU   CVTTMODE                                                 09950000
CVTRV316 EQU   CVTSTATE                                                 09951000
CVTRV315 EQU   CVTGTFS                                                  09952000
CVTGTFAV EQU   CVTGTFS                                                  09953000
CVT0SCR1 EQU   CVTMAP+232                                               09954000
CVTRV515 EQU   CVTMAP+228                                               09955000
CVTRMS   EQU   CVTMAP+224                                               09956000
CVTPATCH EQU   CVTMAP+220                                               09957000
CVTTSCE  EQU   CVTMAP+216                                               09958000
CVTLNKSC EQU   CVTMAP+214                                               09959000
CVTQABST EQU   CVTMAP+212                                               09960000
CVTMDLDS EQU   CVTMAP+208                                               09961000
CVTUSER  EQU   CVTMAP+204                                               09962000
CVTABEND EQU   CVTMAP+200                                               09963000
CVTSMCA  EQU   CVTMAP+196                                               09964000
CVTRSV18 EQU   CVTMAP+192                                               09965000
CVTQLPAQ EQU   CVTMAP+188                                               09966000
CVTQCDSR EQU   CVTMAP+184                                               09967000
CVTVS1B  EQU   CVTOPTB                                                  09968000
CVTVS1A  EQU   CVTOPTB                                                  09969000
CVTFP    EQU   CVTOPTB                                                  09970000
CVTAPTHR EQU   CVTOPTB                                                  09971000
CVTNLOG  EQU   CVTOPTB                                                  09972000
CVTTOD   EQU   CVTOPTB                                                  09973000
CVTCTIMS EQU   CVTOPTB                                                  09974000
CVTPROT  EQU   CVTOPTB                                                  09975000
CVTXPFP  EQU   CVTOPTA                                                  09976000
CVTASCII EQU   CVTOPTA                                                  09977000
CVTRSV13 EQU   CVTOPTA                                                  09978000
CVTRSV12 EQU   CVTOPTA                                                  09979000
CVTNIP   EQU   CVTOPTA                                                  09980000
CVTDDR   EQU   CVTOPTA                                                  09981000
CVTAPR   EQU   CVTOPTA                                                  09982000
CVTCCH   EQU   CVTOPTA                                                  09983000
CVTSNCTR EQU   CVTMAP+180                                               09984000
CVTQMWR  EQU   CVTMAP+176                                               09985000
CVTQOCR  EQU   CVTMAP+172                                               09986000
CVT1EF00 EQU   CVTMAP+168                                               09987000
CVTMZ00  EQU   CVTMAP+164                                               09988000
CVTHEAD  EQU   CVTMAP+160                                               09989000
CVTRSV11 EQU   CVTMAP+156                                               09990000
CVT0PT01 EQU   CVTMAP+152                                               09991000
CVTMSER  EQU   CVTMAP+148                                               09992000
CVTRV516 EQU   CVTIERLC                                                 09993000
CVTILCH  EQU   CVTMAP+140                                               09994000
CVT0DS   EQU   CVTMAP+136                                               09995000
CVTFBOSV EQU   CVTMAP+132                                               09996000
CVTNUCB  EQU   CVTMAP+128                                               09997000
CVTIXAVL EQU   CVTMAP+124                                               09998000
CVTIOQET EQU   CVTMAP+120                                               09999000
CVTDCBA  EQU   CVTMAP+117                                               10000000
CVTMVS2  EQU   CVTDCB                                                   10001000
CVT6DAT  EQU   CVTDCB                                                   10002000
CVT4MPS  EQU   CVTDCB                                                   10003000
CVTRSV09 EQU   CVTDCB                                                   10004000
CVT4MS1  EQU   CVTDCB                                                   10005000
CVT2SPS  EQU   CVTDCB                                                   10006000
CVT1SSS  EQU   CVTDCB                                                   10007000
CVTRSV08 EQU   CVTDCB                                                   10008000
CVTSTB   EQU   CVTMAP+112                                               10009000
CVTQTD00 EQU   CVTMAP+108                                               10010000
CVTQTE00 EQU   CVTMAP+104                                               10011000
CVTCUCB  EQU   CVTMAP+100                                               10012000
CVTSJQ   EQU   CVTMAP+96                                                10013000
CVTPBLDL EQU   CVTMAP+92                                                10014000
CVTTPC   EQU   CVTMAP+88                                                10015000
CVTSVDCB EQU   CVTMAP+84                                                10016000
CVTBRET  EQU   CVTMAP+82                                                10017000
CVTEXIT  EQU   CVTMAP+80                                                10018000
CVT0FN00 EQU   CVTMAP+76                                                10019000
CVTDARA  EQU   CVTDAR+1                                                 10020000
CVTRSV07 EQU   CVTFLGS1                                                 10021000
CVTRSV06 EQU   CVTFLGS1                                                 10022000
CVTRSV05 EQU   CVTFLGS1                                                 10023000
CVTRSV04 EQU   CVTFLGS1                                                 10024000
CVTRSV03 EQU   CVTFLGS1                                                 10025000
CVTRSV02 EQU   CVTFLGS1                                                 10026000
CVTRSV01 EQU   CVTFLGS1                                                 10027000
CVTDMPLK EQU   CVTFLGS1                                                 10028000
CVTXITP  EQU   CVTMAP+68                                                10029000
CVTZDTAB EQU   CVTMAP+64                                                10030000
CVTMSLT  EQU   CVTMAP+60                                                10031000
CVTDATE  EQU   CVTMAP+56                                                10032000
CVTBTERM EQU   CVTMAP+52                                                10033000
CVTSYSAD EQU   CVTMAP+48                                                10034000
CVTXTLER EQU   CVTMAP+44                                                10035000
CVTILK2  EQU   CVTMAP+40                                                10036000
CVTILK1  EQU   CVTMAP+36                                                10037000
CVTPRLTV EQU   CVTMAP+32                                                10038000
CVTPCNVT EQU   CVTMAP+28                                                10039000
CVT0VL00 EQU   CVTMAP+24                                                10040000
CVTXAPG  EQU   CVTMAP+20                                                10041000
CVTBUF   EQU   CVTMAP+16                                                10042000
CVTJOB   EQU   CVTMAP+12                                                10043000
CVTLINK  EQU   CVTMAP+8                                                 10044000
CVT0EF00 EQU   CVTMAP+4                                                 10045000
CVT      EQU   CVTMAP                                                   10046000
PRLCONC  EQU   PRLTIME+2                                                10047000
@NM00172 EQU   PRLTIME                                                  10048000
@NM00171 EQU   PRLFLGS                                                  10049000
IOPBS04E EQU   IOPBS04+2                                                10050000
IOPBAPFC EQU   IOPBAPF+1                                                10051000
IOPBAPFL EQU   IOPBAPF                                                  10052000
IOPBS2NM EQU   IOPBS02+3                                                10053000
IOPBS2EP EQU   IOPBS02                                                  10054000
IOPQSMTP EQU   IOPQSMLS+8                                               10055000
@NM00156 EQU   IOPQSMLS+7                                               10056000
IOPQSMND EQU   IOPQSMNM                                                 10057000
@NM00155 EQU   @NM00154+7                                               10058000
IOPQSMFM EQU   @NM00154                                                 10059000
@NM00074 EQU   IOPLMCTL+17                                              10060000
IOPLMCRD EQU   IOPLMCTL+9                                               10061000
IOPLMCRN EQU   IOPLMCTL+1                                               10062000
IOPLMCC  EQU   IOPLMCTL                                                 10063000
@NM00049 EQU   IOPUSERL                                                 10064000
@NM00048 EQU   IOPUSERL                                                 10065000
IOPINAM2 EQU   IOPINAM+1                                                10066000
IOPITYP2 EQU   IOPITYP                                                  10067000
@NM00047 EQU   HMASMIOP+32                                              10068000
IOPDELDD EQU   IOPDDNAM                                                 10069000
@NM00046 EQU   @NM00043+10                                              10070000
@NM00045 EQU   @NM00044+7                                               10071000
IOPPTFNM EQU   @NM00044                                                 10072000
IOPNAM17 EQU   IOPNAME                                                  10073000
CCABMREC EQU   CCABELMT+10                                              10074000
CCABPOS  EQU   CCABMPOS+8                                               10075000
CCABNAME EQU   CCABMPOS                                                 10076000
@NM00042 EQU   CCABLDLM+2                                               10077000
@NM00041 EQU   CCABLDLM                                                 10078000
CCAUPDPM EQU   @NM00039+24                                              10079000
@NM00040 EQU   @NM00039+21                                              10080000
CCARUPDT EQU   CCAUPDRC                                                 10081000
CCAUPDSP EQU   @NM00039+12                                              10082000
CCAUPDTE EQU   @NM00039+8                                               10083000
CCAUPDNM EQU   @NM00039                                                 10084000
CCASUPPM EQU   @NM00037+24                                              10085000
@NM00038 EQU   @NM00037+21                                              10086000
CCARSUP  EQU   CCASUPRC                                                 10087000
CCASUPSP EQU   @NM00037+12                                              10088000
CCAIOSUP EQU   @NM00037+8                                               10089000
CCASUPNM EQU   @NM00037                                                 10090000
CCAZAPPM EQU   @NM00035+24                                              10091000
@NM00036 EQU   @NM00035+21                                              10092000
CCARZAP  EQU   CCAZAPRC                                                 10093000
CCAZAPSP EQU   @NM00035+12                                              10094000
CCASPZAP EQU   @NM00035+8                                               10095000
CCAZAPNM EQU   @NM00035                                                 10096000
CCACOMPM EQU   @NM00033+24                                              10097000
@NM00034 EQU   @NM00033+21                                              10098000
CCARCOMP EQU   CCACOMRC                                                 10099000
CCACOMSP EQU   @NM00033+12                                              10100000
CCACOMRS EQU   @NM00033+8                                               10101000
CCACOMNM EQU   @NM00033                                                 10102000
CCACPYPM EQU   @NM00031+24                                              10103000
@NM00032 EQU   @NM00031+21                                              10104000
CCARCOPY EQU   CCACPYRC                                                 10105000
CCACPYSP EQU   @NM00031+12                                              10106000
CCACOPY  EQU   @NM00031+8                                               10107000
CCACPYNM EQU   @NM00031                                                 10108000
CCAASMPM EQU   @NM00029+24                                              10109000
@NM00030 EQU   @NM00029+21                                              10110000
CCARASM  EQU   CCAASMRC                                                 10111000
CCAASMSP EQU   @NM00029+12                                              10112000
CCAASM   EQU   @NM00029+8                                               10113000
CCAASMNM EQU   @NM00029                                                 10114000
CCALKDPM EQU   @NM00027+24                                              10115000
@NM00028 EQU   @NM00027+21                                              10116000
CCARLINK EQU   CCALKDRC                                                 10117000
CCALKDSP EQU   @NM00027+12                                              10118000
CCALKED  EQU   @NM00027+8                                               10119000
CCALKDNM EQU   @NM00027                                                 10120000
CCAPGMPM EQU   @NM00025+24                                              10121000
@NM00026 EQU   @NM00025+21                                              10122000
CCABPGRC EQU   @NM00025+20                                              10123000
CCABPGSP EQU   @NM00025+12                                              10124000
CCABPGAD EQU   @NM00025+8                                               10125000
CCABPGNM EQU   @NM00025                                                 10126000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      10127000
@RT00349 EQU   BADEXIT                                                  10128000
@RT00354 EQU   EXIT                                                     10129000
@RT00369 EQU   EXIT                                                     10130000
@RC00364 EQU   @RC00361                                                 10131000
@RT00392 EQU   EXIT                                                     10132000
@RT00435 EQU   CLOSFAIL                                                 10133000
@RT00449 EQU   CLOSFAIL                                                 10134000
@RT00474 EQU   OPENFAIL                                                 10135000
@RT00477 EQU   CLOSFAIL                                                 10136000
@RF00483 EQU   GOODEXIT                                                 10137000
@RT00491 EQU   CLOSFAIL                                                 10138000
@RT00513 EQU   CLOSFAIL                                                 10139000
@RT00525 EQU   CLOSFAIL                                                 10140000
@RF00546 EQU   BADEXIT                                                  10141000
@RT00575 EQU   EXIT                                                     10142000
@RT00590 EQU   EXIT                                                     10143000
@RT00595 EQU   OPENFAIL                                                 10144000
@RT00603 EQU   NODDMSG                                                  10145000
@RT00609 EQU   OPENFAIL                                                 10146000
@RF00616 EQU   GOODEXIT                                                 10147000
@RC00619 EQU   GOODEXIT                                                 10148000
@RC00626 EQU   EXIT                                                     10149000
@RC00637 EQU   PDSRTNS                                                  10150000
@RC00648 EQU   PDSRTNS                                                  10151000
@RC00687 EQU   PDSRTNS                                                  10152000
@RC00698 EQU   PDSRTNS                                                  10153000
@RT00747 EQU   EXIT                                                     10154000
@RF00761 EQU   GOODEXIT                                                 10155000
@RT00836 EQU   CLOSFAIL                                                 10156000
@RT00840 EQU   CLOSFAIL                                                 10157000
@RF00831 EQU   EXIT                                                     10158000
@RC00867 EQU   EXIT                                                     10159000
@RT00893 EQU   EXIT                                                     10160000
@RT00902 EQU   GOODEXIT                                                 10161000
@RT00918 EQU   GOODEXIT                                                 10162000
@RT00920 EQU   EXIT                                                     10163000
@RT00926 EQU   EXIT                                                     10164000
@RT00936 EQU   GOODEXIT                                                 10165000
@RF00961 EQU   EXIT                                                     10166000
@RF00965 EQU   EXIT                                                     10167000
@RC00963 EQU   EXIT                                                     10168000
@RC00993 EQU   GOODEXIT                                                 10169000
@RT01009 EQU   GOODEXIT                                                 10170000
@RC01080 EQU   EXIT                                                     10171000
@RC01078 EQU   EXIT                                                     10172000
@RC01061 EQU   EXIT                                                     10173000
@RT01111 EQU   OPENFAIL                                                 10174000
@RC01116 EQU   EXIT                                                     10175000
@RC01114 EQU   EXIT                                                     10176000
@RC01121 EQU   EXIT                                                     10177000
@RC01127 EQU   EXIT                                                     10178000
@RC01125 EQU   EXIT                                                     10179000
@RC01137 EQU   EXIT                                                     10180000
@RC01135 EQU   EXIT                                                     10181000
@RC01143 EQU   EXIT                                                     10182000
@RC01141 EQU   EXIT                                                     10183000
@RT01158 EQU   CLOSFAIL                                                 10184000
@RC01165 EQU   EXIT                                                     10185000
@RF01185 EQU   EXIT                                                     10186000
@RF01155 EQU   ANYDDRTN                                                 10187000
@RC01260 EQU   EXIT                                                     10188000
@RC01267 EQU   EXIT                                                     10189000
@RT01279 EQU   CLOSFAIL                                                 10190000
@RT01290 EQU   CLOSFAIL                                                 10191000
@RF01287 EQU   BADEXIT                                                  10192000
@RC01311 EQU   @EL00002                                                 10193000
@RC01306 EQU   @EL00002                                                 10194000
@RC01301 EQU   @EL00002                                                 10195000
@RC01296 EQU   @EL00002                                                 10196000
@RF01381 EQU   @EL00003                                                 10197000
@RF01397 EQU   @EL00003                                                 10198000
@RF01408 EQU   @EL00004                                                 10199000
@RF01416 EQU   @EL00004                                                 10200000
@RF01591 EQU   @EL00009                                                 10201000
@RF01624 EQU   @EL00009                                                 10202000
@RC01654 EQU   @EL00012                                                 10203000
@RC01662 EQU   @EL00012                                                 10204000
@RF01678 EQU   @EL00012                                                 10205000
@RT01704 EQU   EOFBLDL                                                  10206000
@RF01713 EQU   @EL00013                                                 10207000
@RF01732 EQU   @EL00014                                                 10208000
@RT01813 EQU   IOINIT0                                                  10209000
@RF01813 EQU   EXIT                                                     10210000
@RF01130 EQU   @RC01127                                                 10211000
@RF01665 EQU   @RC01662                                                 10212000
@ENDDATA EQU   *                                                        10213000
         END   HMASMIO,(C'PLS2032',0802,78334)                          10214000
