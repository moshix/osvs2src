         TITLE 'HMASMLKD - LINK EDIT SYSGEN SCAN ROUTINE OF SMP'        00001000
HMASMLKD CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'HMASMLKD  78.334'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00009000
         BALR  @12,0                                               0001 00010000
@PSTART  LA    @10,4095(,@12)                                      0001 00011000
         USING @PSTART,@12                                         0001 00012000
         USING @PSTART+4095,@10                                    0001 00013000
         ST    @13,@SA00001+4                                      0001 00014000
         LA    @14,@SA00001                                        0001 00015000
         ST    @14,8(,@13)                                         0001 00016000
         LR    @13,@14                                             0001 00017000
         MVC   @PC00001(16),0(@01)                                 0001 00018000
*   IOPPTR=CCAIOPTR;                /* INITIALIZE IOP PTR            */ 00019000
         L     @15,CCAIOPTR(,CCAPTR)                               0210 00020000
         ST    @15,IOPPTR                                          0210 00021000
*   SCPPTR=ADDR(LKDSCP);            /* PTR TO LOCAL SCP      @Z67SP00*/ 00022000
         LA    @14,LKDSCP                                          0211 00023000
         ST    @14,SCPPTR                                          0211 00024000
*   HMASMSCP=CRPSCPAD->HMASMSCP;    /* COPY PASSED SCP       @Z67SP00*/ 00025000
         L     @09,@PC00001+4                                      0212 00026000
         L     @01,CRPSCPAD(,@09)                                  0212 00027000
         MVC   HMASMSCP(26,@14),HMASMSCP(@01)                      0212 00028000
*   CRPSCPAD=SCPPTR;                /* CHAIN CRP TO SCP      @Z67SP00*/ 00029000
         ST    @14,CRPSCPAD(,@09)                                  0213 00030000
*   RFY                                                            0214 00031000
*     HMASMGTP BASED(ADDR(MDDLBGTP));/*                              */ 00032000
*   HMASMGTP=''B;                   /* SET UP MOD/DLIB GTP   @Z67SP00*/ 00033000
         LA    @14,MDDLBGTP                                        0215 00034000
         XC    HMASMGTP(28,@14),HMASMGTP(@14)                      0215 00035000
*   GTPRCDLN=LENGTH(MDDLBRCD);      /*                       @Z67SP00*/ 00036000
         MVC   GTPRCDLN(2,@14),@CH00216                            0216 00037000
*   GTPKEYLN=LENGTH(CSECTN);        /*                       @Z67SP00*/ 00038000
         MVC   GTPKEYLN(2,@14),@CH00043                            0217 00039000
*   GTPBUFAD=ADDR(MDDLBRCD);        /*                       @Z67SP00*/ 00040000
         LA    @09,MDDLBRCD                                        0218 00041000
         ST    @09,GTPBUFAD(,@14)                                  0218 00042000
*   GTPPSIZE=GTP512B;               /*                       @Z67SP00*/ 00043000
         NI    GTPPSIZE(@14),B'11111001'                           0219 00044000
         OI    GTPPSIZE(@14),B'00000001'                           0219 00045000
*   RFY                                                            0220 00046000
*     HMASMGTP BASED(ADDR(CCGTP));  /* CONTROL CARD GTP      @Z67SP00*/ 00047000
*   HMASMGTP=''B;                   /* SET UP MOD/DLIB GTP   @Z67SP00*/ 00048000
         LA    @14,CCGTP                                           0221 00049000
         XC    HMASMGTP(28,@14),HMASMGTP(@14)                      0221 00050000
*   GTPRCDLN=LENGTH(CCRCD);         /*                       @Z67SP00*/ 00051000
         MVC   GTPRCDLN(2,@14),@CH00548                            0222 00052000
*   GTPKEYLN=LENGTH(CCKEY);         /*                       @Z67SP00*/ 00053000
         MVC   GTPKEYLN(2,@14),@CH00064                            0223 00054000
*   GTPBUFAD=ADDR(CCRCD);           /*                       @Z67SP00*/ 00055000
         LA    @09,CCRCD                                           0224 00056000
         ST    @09,GTPBUFAD(,@14)                                  0224 00057000
*   RFY                                                            0225 00058000
*     HMASMGTP BASED(GTPPTR);       /*                       @Z67SP00*/ 00059000
*   BUPIOPAD=ADDR(HMASMIOP);        /*                       @Z67SP00*/ 00060000
         L     @14,@PC00001                                        0226 00061000
         ST    @15,BUPIOPAD(,@14)                                  0226 00062000
*   BUPFUNCT=BUPABKUP;              /*                       @Z67SP00*/ 00063000
         MVI   BUPFUNCT(@14),X'01'                                 0227 00064000
*   LKDRTNCD=ZERO;                  /* INIT RC                       */ 00065000
         MVI   LKDRTNCD,X'00'                                      0228 00066000
*   SYSLADDR=ZERO;                  /* INITIALIZE ADDR OF SYSLMOD    */ 00067000
         SLR   @14,@14                                             0229 00068000
         ST    @14,SYSLADDR                                        0229 00069000
*   MODKEYPT=ZERO;                  /* INIT ADDR OF MOD= KEY @SA72421*/ 00070000
         ST    @14,MODKEYPT                                        0230 00071000
*   SWITCHES=ZERO;                  /* ZERO SWITCH BYTE      @Z40SP00*/ 00072000
         STCM  @14,7,SWITCHES                                      0231 00073000
*   SAVBUFAD=IOPBUFAD;              /* SAVE CURRENT BUFFER ADDR      */ 00074000
         L     @15,IOPBUFAD(,@15)                                  0232 00075000
         ST    @15,SAVBUFAD                                        0232 00076000
         EJECT                                                          00077000
*                                                                  0233 00078000
*   /*****************************************************************/ 00079000
*   /*                                                               */ 00080000
*   /* PROCESS DATA FROM JCL BUFFER PASSED                   @Z67SP00*/ 00081000
*   /*                                                               */ 00082000
*   /*****************************************************************/ 00083000
*                                                                  0233 00084000
*   IF LKDRTNCD=ZERO                /*                       @Z67SP00*/ 00085000
*     THEN                          /*                       @Z67SP00*/ 00086000
         CLI   LKDRTNCD,0                                          0233 00087000
         BNE   @RF00233                                            0233 00088000
*     DO;                           /*                       @Z67SP00*/ 00089000
*       CALL LKDJCL;                /*                       @Z67SP00*/ 00090000
         BAL   @14,LKDJCL                                          0235 00091000
*       RFY                                                        0236 00092000
*         RTNCODE RSTD;             /*                       @Z67SP00*/ 00093000
*       LKDRTNCD=MAX(LKDRTNCD,RTNCODE);/*                    @Z67SP00*/ 00094000
         SLR   @14,@14                                             0237 00095000
         IC    @14,LKDRTNCD                                        0237 00096000
         CR    @14,RTNCODE                                         0237 00097000
         BNL   *+6                                                      00098000
         LR    @14,RTNCODE                                         0237 00099000
         STC   @14,LKDRTNCD                                        0237 00100000
*       RFY                                                        0238 00101000
*         RTNCODE UNRSTD;           /*                       @Z67SP00*/ 00102000
*     END;                          /*                       @Z67SP00*/ 00103000
*                                                                  0239 00104000
*   /*****************************************************************/ 00105000
*   /*                                                               */ 00106000
*   /* IF JCL PROCESS OK NOW PROCESS DATA FROM INPUT STREAM  @Z67SP00*/ 00107000
*   /*                                                               */ 00108000
*   /*****************************************************************/ 00109000
*                                                                  0240 00110000
*   IF LKDRTNCD=ZERO                /*                       @Z67SP00*/ 00111000
*     THEN                          /*                       @Z67SP00*/ 00112000
@RF00233 CLI   LKDRTNCD,0                                          0240 00113000
         BNE   @RF00240                                            0240 00114000
*     DO;                           /*                       @Z67SP00*/ 00115000
*       CALL LKDCC;                 /*                       @Z67SP00*/ 00116000
         BAL   @14,LKDCC                                           0242 00117000
*       RFY                                                        0243 00118000
*         RTNCODE RSTD;             /*                       @Z67SP00*/ 00119000
*       LKDRTNCD=MAX(LKDRTNCD,RTNCODE);/*                    @Z67SP00*/ 00120000
         SLR   @14,@14                                             0244 00121000
         IC    @14,LKDRTNCD                                        0244 00122000
         CR    @14,RTNCODE                                         0244 00123000
         BNL   *+6                                                      00124000
         LR    @14,RTNCODE                                         0244 00125000
         STC   @14,LKDRTNCD                                        0244 00126000
*       RFY                                                        0245 00127000
*         RTNCODE UNRSTD;           /*                       @Z67SP00*/ 00128000
*     END;                          /*                       @Z67SP00*/ 00129000
*                                                                  0246 00130000
*   /*****************************************************************/ 00131000
*   /*                                                               */ 00132000
*   /* IF CONTROL CARDS PROCESSED OK BUT NAME CARD NOT FOUND THEN GET*/ 00133000
*   /* LMOD NAME FROM JCL                                    @Z67SP00*/ 00134000
*   /*                                                               */ 00135000
*   /*****************************************************************/ 00136000
*                                                                  0247 00137000
*   IF LKDRTNCD=ZERO                /* CC PROCESSED OK       @Z67SP00*/ 00138000
*       &NAMEFND=OFF                /* BUT NAME NOT FOUND    @Z67SP00*/ 00139000
*     THEN                          /*                       @Z67SP00*/ 00140000
@RF00240 CLI   LKDRTNCD,0                                          0247 00141000
         BNE   @RF00247                                            0247 00142000
         TM    NAMEFND,B'00010000'                                 0247 00143000
         BNZ   @RF00247                                            0247 00144000
*     DO;                           /*                       @Z67SP00*/ 00145000
*       CALL LKDLNAME;              /*                       @Z67SP00*/ 00146000
         BAL   @14,LKDLNAME                                        0249 00147000
*       RFY                                                        0250 00148000
*         RTNCODE RSTD;             /*                       @Z67SP00*/ 00149000
*       LKDRTNCD=MAX(LKDRTNCD,RTNCODE);/*                    @Z67SP00*/ 00150000
         SLR   @14,@14                                             0251 00151000
         IC    @14,LKDRTNCD                                        0251 00152000
         CR    @14,RTNCODE                                         0251 00153000
         BNL   *+6                                                      00154000
         LR    @14,RTNCODE                                         0251 00155000
         STC   @14,LKDRTNCD                                        0251 00156000
*       RFY                                                        0252 00157000
*         RTNCODE UNRSTD;           /*                       @Z67SP00*/ 00158000
*     END;                          /*                       @Z67SP00*/ 00159000
*                                                                  0253 00160000
*   /*****************************************************************/ 00161000
*   /*                                                               */ 00162000
*   /* NOW FREE BOTH GTPS THAT MAY HAVE BEEN USED AND        @Z67SP00*/ 00163000
*   /* RETURN TO CALLER                                      @Z67SP00*/ 00164000
*   /*                                                               */ 00165000
*   /*****************************************************************/ 00166000
*                                                                  0254 00167000
*   GTPPTR=ADDR(MDDLBGTP);          /*                       @Z67SP00*/ 00168000
@RF00247 LA    @15,MDDLBGTP                                        0254 00169000
         ST    @15,GTPPTR                                          0254 00170000
*   GTPFUNCT=GTPFREE;               /*                       @Z67SP00*/ 00171000
         MVI   GTPFUNCT(@15),X'0A'                                 0255 00172000
*   CALL HMASMGTA(HMASMGTP);        /*                       @Z67SP00*/ 00173000
         ST    @15,@AL00001                                        0256 00174000
         L     @15,@CV01384                                        0256 00175000
         LA    @01,@AL00001                                        0256 00176000
         BALR  @14,@15                                             0256 00177000
*   GTPPTR=ADDR(CCGTP);             /*                       @Z67SP00*/ 00178000
         LA    @15,CCGTP                                           0257 00179000
         ST    @15,GTPPTR                                          0257 00180000
*   GTPFUNCT=GTPFREE;               /*                       @Z67SP00*/ 00181000
         MVI   GTPFUNCT(@15),X'0A'                                 0258 00182000
*   CALL HMASMGTA(HMASMGTP);        /*                       @Z67SP00*/ 00183000
         ST    @15,@AL00001                                        0259 00184000
         L     @15,@CV01384                                        0259 00185000
         LA    @01,@AL00001                                        0259 00186000
         BALR  @14,@15                                             0259 00187000
*   IF LKDRTNCD=ZERO                /*                       @Z67SP00*/ 00188000
*     THEN                          /*                       @Z67SP00*/ 00189000
         CLI   LKDRTNCD,0                                          0260 00190000
         BNE   @RF00260                                            0260 00191000
*     DO;                           /*                       @Z67SP00*/ 00192000
*       IF JCLENSW=ON               /* IF JCL CARD STOPPED   @Z67SP00*/ 00193000
*         THEN                      /* SCAN                  @Z67SP00*/ 00194000
         TM    JCLENSW,B'10000000'                                 0262 00195000
         BNO   @RF00262                                            0262 00196000
*         LKDRTNCD=JCLENC;          /* THEN SET RC           @Z67SP00*/ 00197000
         MVI   LKDRTNCD,X'06'                                      0263 00198000
*       ELSE                        /* ELSE                  @Z67SP00*/ 00199000
*         IF PREMSW=ON              /* IF END OF FILE        @Z67SP00*/ 00200000
*           THEN                    /* STOPPED SCAN          @Z67SP00*/ 00201000
         B     @RC00262                                            0264 00202000
@RF00262 TM    PREMSW,B'01000000'                                  0264 00203000
         BNO   @RF00264                                            0264 00204000
*           LKDRTNCD=PREMEOF;       /* SET RC                @Z67SP00*/ 00205000
         MVI   LKDRTNCD,X'0E'                                      0265 00206000
*     END;                          /*                       @Z67SP00*/ 00207000
@RF00264 DS    0H                                                  0266 00208000
@RC00262 DS    0H                                                  0267 00209000
*   RETURN CODE(LKDRTNCD);          /*                       @Z67SP00*/ 00210000
@RF00260 SLR   @15,@15                                             0267 00211000
         IC    @15,LKDRTNCD                                        0267 00212000
         L     @13,4(,@13)                                         0267 00213000
         L     @14,12(,@13)                                        0267 00214000
         LM    @00,@12,20(@13)                                     0267 00215000
         BR    @14                                                 0267 00216000
         EJECT                                                          00217000
*                                                                  0268 00218000
*   /*****************************************************************/ 00219000
*   /*                                                               */ 00220000
*   /* PROCESS JCL IN BUFFER LOOKING FOR LEPARMS AND DSN     @Z67SP00*/ 00221000
*   /*                                                               */ 00222000
*   /*****************************************************************/ 00223000
*                                                                  0268 00224000
*LKDJCL:                            /*                       @Z67SP00*/ 00225000
*   PROCEDURE;                      /*                       @Z67SP00*/ 00226000
@EL00001 L     @13,4(,@13)                                         0268 00227000
@EF00001 DS    0H                                                  0268 00228000
@ER00001 LM    @14,@12,12(@13)                                     0268 00229000
         BR    @14                                                 0268 00230000
LKDJCL   STM   @14,@12,@SA00002                                    0268 00231000
*   DECLARE                         /*                       @Z67SP00*/ 00232000
*     JCLRC FIXED(8);               /*                       @Z67SP00*/ 00233000
*   JCLRC=ZERO;                     /*                       @Z67SP00*/ 00234000
         MVI   JCLRC,X'00'                                         0270 00235000
*   IOPLMDNT=''B;                   /* INIT LMOD ENTRY       @Z67SP00*/ 00236000
         L     @01,IOPPTR                                          0271 00237000
         XC    IOPLMDNT(104,@01),IOPLMDNT(@01)                     0271 00238000
*   SCPCHAR=ADDR(BUFFER);           /* SET POINTER TO STRING         */ 00239000
*                                                                  0272 00240000
         L     @15,@PC00001+8                                      0272 00241000
         L     @14,SCPPTR                                          0272 00242000
         ST    @15,SCPCHAR(,@14)                                   0272 00243000
*   /*****************************************************************/ 00244000
*   /*                                                               */ 00245000
*   /* LOOK THRU ALL JCL IN BUFFER                           @Z67SP00*/ 00246000
*   /*                                                               */ 00247000
*   /*****************************************************************/ 00248000
*                                                                  0273 00249000
*   DO UNTIL(                       /* LOOP THRU ALL JCL     @Z67SP00*/ 00250000
*         SCPSTRNG(1)=IOPEOLST      /* UNTIL END OF JCL      @Z67SP00*/ 00251000
*         |JCLRC^=ZERO);            /* OR ERROR              @Z67SP00*/ 00252000
*                                                                  0273 00253000
@DL00273 DS    0H                                                  0274 00254000
*     /***************************************************************/ 00255000
*     /*                                                             */ 00256000
*     /* LOOK FOR SPECIAL CHARACTERS - THEY SEPERATE KEYWORDS        */ 00257000
*     /*                                                     @Z67SP00*/ 00258000
*     /*                                                             */ 00259000
*     /***************************************************************/ 00260000
*                                                                  0274 00261000
*     DO WHILE SCPSTRNG(1)>=CHARA   /* AS LONG AS LOOKING AT CHAR    */ 00262000
*           &SCPSTRNG(1)<=CHARZ;    /* DATA                  @Z40SP00*/ 00263000
         B     @DE00274                                            0274 00264000
@DL00274 DS    0H                                                  0275 00265000
*       SCPCHAR=SCPCHAR+1;          /* SKIP PAST DATA                */ 00266000
         L     @15,SCPPTR                                          0275 00267000
         LA    @14,1                                               0275 00268000
         AL    @14,SCPCHAR(,@15)                                   0275 00269000
         ST    @14,SCPCHAR(,@15)                                   0275 00270000
*     END;                                                         0276 00271000
@DE00274 L     @01,SCPPTR                                          0276 00272000
         L     @15,SCPCHAR(,@01)                                   0276 00273000
         CLI   SCPSTRNG(@15),C'A'                                  0276 00274000
         BL    @DC00274                                            0276 00275000
         CLI   SCPSTRNG(@15),C'Z'                                  0276 00276000
         BNH   @DL00274                                            0276 00277000
@DC00274 DS    0H                                                  0277 00278000
*     SCPCHAR=SCPCHAR+1;            /* SEARCH TILL JCL               */ 00279000
         L     @15,SCPPTR                                          0277 00280000
         LA    @14,1                                               0277 00281000
         L     @09,SCPCHAR(,@15)                                   0277 00282000
         ALR   @09,@14                                             0277 00283000
         ST    @09,SCPCHAR(,@15)                                   0277 00284000
*     IF SCPSTRNG(1)^=IOPEOLST      /* IF NOT AT END         @Z67SP00*/ 00285000
*       THEN                        /*                       @Z67SP00*/ 00286000
         CLI   SCPSTRNG(@09),255                                   0278 00287000
         BE    @RF00278                                            0278 00288000
*       DO;                         /*                       @Z67SP00*/ 00289000
*                                                                  0279 00290000
*         /***********************************************************/ 00291000
*         /*                                                         */ 00292000
*         /* NOW LOOK AT CHAR AFTER SPECIAL CHARACTER TOO SEE IF IT  */ 00293000
*         /* IS ONE OF THE KEYWORDS THAT MUST BE SAVED       @Z67SP00*/ 00294000
*         /*                                                         */ 00295000
*         /***********************************************************/ 00296000
*                                                                  0280 00297000
*         IF SCPSTRNG(1)>=CHARA     /* IS THIS CHARACTER ALPHABETIC? */ 00298000
*             &SCPSTRNG(1)<=CHARZ   /* SAME AS ABOVE         @Z40SP00*/ 00299000
*           THEN                    /* YES - CONSIDER IT AS POSSIBLE */ 00300000
         CLI   SCPSTRNG(@09),C'A'                                  0280 00301000
         BL    @RF00280                                            0280 00302000
         CLI   SCPSTRNG(@09),C'Z'                                  0280 00303000
         BH    @RF00280                                            0280 00304000
*           DO TEMPPTR1=1 TO DIM(KEYS);/* LOOK THRU KEYS     @SA75303*/ 00305000
         ST    @14,TEMPPTR1                                        0281 00306000
@DL00281 DS    0H                                                  0282 00307000
*             TEMPPTR2=KEYLEN(TEMPPTR1);/* GET LENGTH                */ 00308000
*                                                                  0282 00309000
         MH    @14,@CH00466                                        0282 00310000
         SLR   @15,@15                                             0282 00311000
         IC    @15,KEYLEN-13(@14)                                  0282 00312000
         ST    @15,TEMPPTR2                                        0282 00313000
*             /*******************************************************/ 00314000
*             /*                                                     */ 00315000
*             /* IF MATCH FOUND IN KEYWORD TABLE, THEN GO TO ROUTINE */ 00316000
*             /*                                                     */ 00317000
*             /*******************************************************/ 00318000
*                                                                  0283 00319000
*             IF SCPSTRNG(1:TEMPPTR2)=/*                     @Z40SP00*/ 00320000
*                 KEYWORD(TEMPPTR1,1:TEMPPTR2) THEN/*        @Z67SP00*/ 00321000
         L     @01,SCPPTR                                          0283 00322000
         L     @01,SCPCHAR(,@01)                                   0283 00323000
         BCTR  @15,0                                               0283 00324000
         LA    @09,KEYWORD-13(@14)                                 0283 00325000
         EX    @15,@SC01727                                        0283 00326000
         BNE   @RF00283                                            0283 00327000
*               DO;                 /*                       @Z67SP00*/ 00328000
*                 CALL KEYROUT;     /*                       @Z67SP00*/ 00329000
         LA    @01,KEYROUTS-13(@14)                                0285 00330000
         ICM   @15,15,0(@01)                                       0285 00331000
         BALR  @14,@15                                             0285 00332000
*                 RFY                                              0286 00333000
*                   RTNCODE RSTD;   /*                       @Z67SP00*/ 00334000
*                 JCLRC=MAX(JCLRC,RTNCODE);/* SAVE RC        @Z67SP00*/ 00335000
         SLR   @14,@14                                             0287 00336000
         IC    @14,JCLRC                                           0287 00337000
         CR    @14,RTNCODE                                         0287 00338000
         BNL   *+6                                                      00339000
         LR    @14,RTNCODE                                         0287 00340000
         STC   @14,JCLRC                                           0287 00341000
*                 RFY                                              0288 00342000
*                   RTNCODE UNRSTD; /*                       @Z67SP00*/ 00343000
*               END;                /*                       @Z67SP00*/ 00344000
*           END;                    /*                       @Z67SP00*/ 00345000
@RF00283 LA    @14,1                                               0290 00346000
         AL    @14,TEMPPTR1                                        0290 00347000
         ST    @14,TEMPPTR1                                        0290 00348000
         C     @14,@CF00070                                        0290 00349000
         BNH   @DL00281                                            0290 00350000
*       END;                        /* END NOT AT EOLST      @Z67SP00*/ 00351000
@RF00280 DS    0H                                                  0292 00352000
*   END;                            /* END JCL LOOP          @Z67SP00*/ 00353000
*                                                                  0292 00354000
@RF00278 DS    0H                                                  0292 00355000
@DE00273 L     @01,SCPPTR                                          0292 00356000
         L     @01,SCPCHAR(,@01)                                   0292 00357000
         CLI   SCPSTRNG(@01),255                                   0292 00358000
         BE    @DC00273                                            0292 00359000
         CLI   JCLRC,0                                             0292 00360000
         BE    @DL00273                                            0292 00361000
@DC00273 DS    0H                                                  0293 00362000
*   /*****************************************************************/ 00363000
*   /*                                                               */ 00364000
*   /* SEE IF SYSLMOD FOUND. IF NOT ISSUE ERROR MSG          @Z67SP00*/ 00365000
*   /*                                                               */ 00366000
*   /*****************************************************************/ 00367000
*                                                                  0293 00368000
*   IF SYSTSW=ON                    /* SYSLMOD FOUND?        @Z67SP00*/ 00369000
*     THEN                          /*                       @Z67SP00*/ 00370000
         TM    SYSTSW,B'00001000'                                  0293 00371000
         BNO   @RF00293                                            0293 00372000
*     DO;                           /*                       @Z67SP00*/ 00373000
*       FLAGSAV1=IOPLMDF1;          /* SAVE LKED FLAGS 1     @ZD00004*/ 00374000
         L     @15,IOPPTR                                          0295 00375000
         MVC   FLAGSAV1(1),IOPLMDF1(@15)                           0295 00376000
*       FLAGSAV2=IOPLMDF2;          /* SAVE LKED FLAGS 2     @ZD00004*/ 00377000
         MVC   FLAGSAV2(1),IOPLMDF2(@15)                           0296 00378000
*       FLAGSAV3=IOPLMDF3;          /* SAVE LKED FLAGS 3     @ZD00004*/ 00379000
         MVC   FLAGSAV3(1),IOPLMDF3(@15)                           0297 00380000
*       FLAGSAV4=IOPLMDF4;          /* SAVE LKED FLAGS 4     @ZD00004*/ 00381000
         MVC   FLAGSAV4(1),IOPLMDF4(@15)                           0298 00382000
*       FLAGSAV5=IOPLMDF5;          /* SAVE LMD OPTIONS      @ZD00004*/ 00383000
         MVC   FLAGSAV5(1),IOPLMDF5(@15)                           0299 00384000
*     END;                          /*                       @Z67SP00*/ 00385000
*   ELSE                            /* NO - SYNTAX ERROR             */ 00386000
*     DO;                           /*                       @SA72421*/ 00387000
         B     @RC00293                                            0301 00388000
@RF00293 DS    0H                                                  0302 00389000
*       CALL LKDERR(BUFFER,NOSYSL); /* WRITE ERR MSG         @Z67SP00*/ 00390000
         L     @15,@PC00001+8                                      0302 00391000
         ST    @15,@AL00001                                        0302 00392000
         LA    @15,NOSYSL                                          0302 00393000
         ST    @15,@AL00001+4                                      0302 00394000
         LA    @01,@AL00001                                        0302 00395000
         BAL   @14,LKDERR                                          0302 00396000
*       JCLRC=MAX(JCLRC,SYNTERR);   /* SAVE RC               @Z67SP00*/ 00397000
         SLR   @15,@15                                             0303 00398000
         IC    @15,JCLRC                                           0303 00399000
         LA    @14,10                                              0303 00400000
         CR    @15,@14                                             0303 00401000
         BNL   *+6                                                      00402000
         LR    @15,@14                                             0303 00403000
         STC   @15,JCLRC                                           0303 00404000
*     END;                          /*                       @SA72421*/ 00405000
*                                                                  0304 00406000
*   /*****************************************************************/ 00407000
*   /*                                                               */ 00408000
*   /* ALL JCL PROCESSED NOW RETURN                          @Z67SP00*/ 00409000
*   /*                                                               */ 00410000
*   /*****************************************************************/ 00411000
*                                                                  0305 00412000
*   RETURN CODE(JCLRC);             /*                       @Z67SP00*/ 00413000
@RC00293 SLR   @15,@15                                             0305 00414000
         IC    @15,JCLRC                                           0305 00415000
         L     @14,@SA00002                                        0305 00416000
         LM    @00,@12,@SA00002+8                                  0305 00417000
         BR    @14                                                 0305 00418000
*   END LKDJCL;                     /*                       @Z67SP00*/ 00419000
         EJECT                                                          00420000
*                                                                  0307 00421000
*   /*****************************************************************/ 00422000
*   /*                                                               */ 00423000
*   /* NOW THAT JCL HAS BEEN SCANNED SET UP TO SCAN LKED CONTROL     */ 00424000
*   /* CARDS FROM JCLIN INPUT STREAM. INITIALIZE LOCAL VERIABLES, SET*/ 00425000
*   /* UP SCP.                                                       */ 00426000
*   /*                                                               */ 00427000
*   /*****************************************************************/ 00428000
*                                                                  0307 00429000
*LKDCC:                             /*                       @Z67SP00*/ 00430000
*   PROCEDURE;                      /*                       @Z67SP00*/ 00431000
LKDCC    STM   @14,@12,@SA00003                                    0307 00432000
*   DECLARE                         /*                       @Z67SP00*/ 00433000
*     CCRC FIXED(8);                /*                       @Z67SP00*/ 00434000
*   CCRC=ZERO;                      /*                       @Z67SP00*/ 00435000
*                                                                  0309 00436000
         MVI   CCRC,X'00'                                          0309 00437000
*   /*****************************************************************/ 00438000
*   /*                                                               */ 00439000
*   /* INSURE THAT GTPS USED TO HOLD MOD/DLIB PAIRS AND CONTROL CARDS*/ 00440000
*   /* ARE INITIALIZED TO ZERO                               @Z67SP00*/ 00441000
*   /*                                                               */ 00442000
*   /*****************************************************************/ 00443000
*                                                                  0310 00444000
*   RFY                                                            0310 00445000
*     HMASMGTP BASED(ADDR(MDDLBGTP));/*                              */ 00446000
*   HMASMGTP=''B;                   /* SET UP MOD/DLIB GTP   @Z67SP00*/ 00447000
         LA    @15,MDDLBGTP                                        0311 00448000
         XC    HMASMGTP(28,@15),HMASMGTP(@15)                      0311 00449000
*   GTPRCDLN=LENGTH(MDDLBRCD);      /*                       @Z67SP00*/ 00450000
         MVC   GTPRCDLN(2,@15),@CH00216                            0312 00451000
*   GTPKEYLN=LENGTH(CSECTN);        /*                       @Z67SP00*/ 00452000
         MVC   GTPKEYLN(2,@15),@CH00043                            0313 00453000
*   GTPBUFAD=ADDR(MDDLBRCD);        /*                       @Z67SP00*/ 00454000
         LA    @14,MDDLBRCD                                        0314 00455000
         ST    @14,GTPBUFAD(,@15)                                  0314 00456000
*   GTPPSIZE=GTP512B;               /*                       @Z67SP00*/ 00457000
         NI    GTPPSIZE(@15),B'11111001'                           0315 00458000
         OI    GTPPSIZE(@15),B'00000001'                           0315 00459000
*   RFY                                                            0316 00460000
*     HMASMGTP BASED(ADDR(CCGTP));  /* CONTROL CARD GTP      @Z67SP00*/ 00461000
*   HMASMGTP=''B;                   /* SET UP MOD/DLIB GTP   @Z67SP00*/ 00462000
         LA    @15,CCGTP                                           0317 00463000
         XC    HMASMGTP(28,@15),HMASMGTP(@15)                      0317 00464000
*   GTPRCDLN=LENGTH(CCRCD);         /*                       @Z67SP00*/ 00465000
         MVC   GTPRCDLN(2,@15),@CH00548                            0318 00466000
*   GTPKEYLN=LENGTH(CCKEY);         /*                       @Z67SP00*/ 00467000
         MVC   GTPKEYLN(2,@15),@CH00064                            0319 00468000
*   GTPBUFAD=ADDR(CCRCD);           /*                       @Z67SP00*/ 00469000
         LA    @14,CCRCD                                           0320 00470000
         ST    @14,GTPBUFAD(,@15)                                  0320 00471000
*   RFY                                                            0321 00472000
*     HMASMGTP BASED(GTPPTR);       /*                       @Z67SP00*/ 00473000
*                                                                  0321 00474000
*   /*****************************************************************/ 00475000
*   /*                                                               */ 00476000
*   /* INITIALIZE SCP AND BUFFER AREA                        @Z67SP00*/ 00477000
*   /*                                                               */ 00478000
*   /*****************************************************************/ 00479000
*                                                                  0322 00480000
*   CCSEQNO=ZERO;                   /* RESET SEQUENCE NUMBER @Z67SP00*/ 00481000
         SLR   @15,@15                                             0322 00482000
         STCM  @15,15,CCSEQNO                                      0322 00483000
*   SCPIORTN=ZERO;                  /* INDICATE NO I/O ROUTINE       */ 00484000
         L     @14,SCPPTR                                          0323 00485000
         ST    @15,SCPIORTN(,@14)                                  0323 00486000
*   SCPSRCH=ADDR(KINCLUDE);         /* POINT AT START SEARCH ARG     */ 00487000
         LA    @15,KINCLUDE                                        0324 00488000
         ST    @15,SCPSRCH(,@14)                                   0324 00489000
*   SCPINLN=LENGTH(CRPBFDTA);       /* SET INPUT RCD LEN     @Z67SP00*/ 00490000
         MVC   SCPINLN(2,@14),@CH01063                             0325 00491000
*   SCPCHAR=ADDR(CRPBUFFR);         /* PTR TO DATA TO SCAN   @Z67SP00*/ 00492000
*                                                                  0326 00493000
         L     @15,@PC00001+4                                      0326 00494000
         LA    @15,CRPBUFFR(,@15)                                  0326 00495000
         ST    @15,SCPCHAR(,@14)                                   0326 00496000
*   /*****************************************************************/ 00497000
*   /*                                                               */ 00498000
*   /* FIRST CONTROL CARD IS IN BUFFER. NOW SCAN CARD AND ALL OTHER  */ 00499000
*   /* CARDS UNTIL END OF INPUT OR ERROR                     @Z67SP00*/ 00500000
*   /*                                                               */ 00501000
*   /*****************************************************************/ 00502000
*                                                                  0327 00503000
*   DO WHILE(                       /* LOOP SCANNING RCDS    @Z67SP00*/ 00504000
*         SCPSTRNG(1:2)^=SLASHAST   /* TILL END              @Z67SP00*/ 00505000
*         &JCLENSW=OFF              /* OF JCL CARD FOUND     @Z67SP00*/ 00506000
*         &PREMSW=OFF               /* OR EOF FOUND          @Z67SP00*/ 00507000
*         &CCRC=ZERO);              /* OR ERROR              @Z40SP00*/ 00508000
         B     @DE00327                                            0327 00509000
@DL00327 DS    0H                                                  0328 00510000
*     CCORDER=CCOTHR;               /* SET TYPE CONTROL CARD @Z67SP00*/ 00511000
         MVI   CCORDER,X'01'                                       0328 00512000
*     CALL HMASMSCN(HMASMSCP);      /* SCAN LKED CONTROL STMT        */ 00513000
*                                                                  0329 00514000
         L     @01,SCPPTR                                          0329 00515000
         ST    @01,@AL00001                                        0329 00516000
         L     @15,@CV01386                                        0329 00517000
         LA    @01,@AL00001                                        0329 00518000
         BALR  @14,@15                                             0329 00519000
*     /***************************************************************/ 00520000
*     /*                                                             */ 00521000
*     /* IF CARD SCANNED SUCCESSFULLY CHECK FOR CONTINUATION         */ 00522000
*     /* CHARACTER AND SET DSCAN ACCORDINGLY                 @Z67SP00*/ 00523000
*     /*                                                             */ 00524000
*     /***************************************************************/ 00525000
*                                                                  0330 00526000
*     IF SCPRETRN=SCPGOOD           /* IF SCAN OK            @Z67SP00*/ 00527000
*       THEN                        /*                       @Z67SP00*/ 00528000
         L     @15,SCPPTR                                          0330 00529000
         CLI   SCPRETRN(@15),0                                     0330 00530000
         BNE   @RF00330                                            0330 00531000
*       DO;                         /*                       @Z67SP00*/ 00532000
*         SCPCHAR=ADDR(CRPBUFFR);   /* START OF CARD         @Z67SP00*/ 00533000
         L     @14,@PC00001+4                                      0332 00534000
         LA    @09,CRPBUFFR(,@14)                                  0332 00535000
         ST    @09,SCPCHAR(,@15)                                   0332 00536000
*         IF CRPBFCNT^=BLANK        /* IS CONTINUATION INDICATED   0333 00537000
*                                                            @Z67SP00*/ 00538000
*           THEN                    /* YES                   @XA07462*/ 00539000
         CLI   CRPBFCNT(@14),C' '                                  0333 00540000
         BE    @RF00333                                            0333 00541000
*           IF INCLPARM=ON          /* IS THIS PARMLIB CONTINUATION     00542000
*                                                            @XA07462*/ 00543000
*             THEN                  /*                       @XA07462*/ 00544000
         TM    INCLPARM,B'00000100'                                0334 00545000
         BNO   @RF00334                                            0334 00546000
*             SCPSRCH=ADDR(KLKDSVCC);/* SET SCAN ENTRY TO IMMEDIATELY   00547000
*                                      WRITE PARMLIB CONTINUATION TO    00548000
*                                      CDS                   @XA07462*/ 00549000
         LA    @14,KLKDSVCC                                        0335 00550000
         ST    @14,SCPSRCH(,@15)                                   0335 00551000
*           ELSE                    /*                       @XA07462*/ 00552000
*             IF INCLFND=ON&        /* IF ANY INCLUDE CONTINUATION 0336 00553000
*                                                            @XA07462*/ 00554000
*                 INCLSYSL=OFF      /* EXCEPT PARMLIB OR SYSLMOD   0336 00555000
*                                                            @XA07462*/ 00556000
*               THEN                /* SET SCAN ENTRY TO CONTINUE  0336 00557000
*                                                            @XA07462*/ 00558000
         B     @RC00334                                            0336 00559000
@RF00334 TM    INCLFND,B'00000001'                                 0336 00560000
         BNO   @RF00336                                            0336 00561000
         TM    INCLSYSL,B'00000010'                                0336 00562000
         BNZ   @RF00336                                            0336 00563000
*               SCPSRCH=ADDR(KCSECTV);/* SEARCH FOR MOD      @XA07462*/ 00564000
         LA    @15,KCSECTV                                         0337 00565000
         L     @14,SCPPTR                                          0337 00566000
         ST    @15,SCPSRCH(,@14)                                   0337 00567000
*             ELSE                                                 0338 00568000
*               ;                   /* OTHER THAN INCLUDE OR INCLUDE    00569000
*                                      SYSLMOD - NO CHANGE   @XA07462*/ 00570000
@RF00336 DS    0H                                                  0339 00571000
*         ELSE                      /*                       @XA07462*/ 00572000
*           DO;                     /* POSSIBLE LAST OF CONTINUATIONS   00573000
*                                                            @XA07462*/ 00574000
         B     @RC00333                                            0339 00575000
@RF00333 DS    0H                                                  0340 00576000
*             SCPSRCH=ADDR(KINCLUDE);/* SET SCAN ADDR        @Z67SP00*/ 00577000
         LA    @15,KINCLUDE                                        0340 00578000
         L     @14,SCPPTR                                          0340 00579000
         ST    @15,SCPSRCH(,@14)                                   0340 00580000
*             INCLFND=OFF;          /* TURN OFF INCLUDE FOUND SWS- 0341 00581000
*                                      ANY                   @XA07462*/ 00582000
*             INCLPARM=OFF;         /* - PARMLIB             @XA07462*/ 00583000
*             INCLSYSL=OFF;         /* - SYSLMOD             @XA07462*/ 00584000
         NI    INCLFND,B'11111000'                                 0343 00585000
*           END;                    /*                       @XA07462*/ 00586000
*REREAD:                            /*                       @XA07462*/ 00587000
*         CALL HMASMCRD(HMASMCRP);  /* READ JCLIN RCD        @Z67SP00*/ 00588000
@RC00333 DS    0H                                                  0345 00589000
REREAD   L     @15,@PC00001+4                                      0345 00590000
         ST    @15,@AL00001                                        0345 00591000
         L     @15,@CV01383                                        0345 00592000
         LA    @01,@AL00001                                        0345 00593000
         BALR  @14,@15                                             0345 00594000
*         IF CRPRETRN=CRPGOOD       /* IF RECORD OBTAINED OK @Z67SP00*/ 00595000
*           THEN                    /*                       @Z67SP00*/ 00596000
         L     @15,@PC00001+4                                      0346 00597000
         CLI   CRPRETRN(@15),0                                     0346 00598000
         BNE   @RF00346                                            0346 00599000
*           DO;                     /*                       @Z67SP00*/ 00600000
*             IF CRPBUFFR(1:2)=TWOSLASH/* JCL FOUND?         @Z67SP00*/ 00601000
*               THEN                                               0348 00602000
         CLC   CRPBUFFR(2,@15),@CC01407                            0348 00603000
         BNE   @RF00348                                            0348 00604000
*               JCLENSW=ON;         /* REMEMBER IT           @Z67SP00*/ 00605000
         OI    JCLENSW,B'10000000'                                 0349 00606000
*             ELSE                  /*                       @Z67SP00*/ 00607000
*               IF CRPINDS=IOPPTS   /* IF PTS DATASET        @Z67SP00*/ 00608000
*                   &CRPBUFFR(1:2)=TWOPLUS/* AND NEX MCS     @Z67SP00*/ 00609000
*                 THEN              /* TREAT AS PREMATURE    @Z67SP00*/ 00610000
         B     @RC00348                                            0350 00611000
@RF00348 L     @15,@PC00001+4                                      0350 00612000
         CLI   CRPINDS(@15),6                                      0350 00613000
         BNE   @RF00350                                            0350 00614000
         CLC   CRPBUFFR(2,@15),@CC01409                            0350 00615000
         BNE   @RF00350                                            0350 00616000
*                 PREMSW=ON;        /* END OF FILE           @Z67SP00*/ 00617000
         OI    PREMSW,B'01000000'                                  0351 00618000
*             IF INCLSYSL=ON        /* IS INCLUDE SYSLMOD          0352 00619000
*                                      CONTINUATION BEING PROCESSED     00620000
*                                                            @XA07462*/ 00621000
*               THEN                /* YES ---               @XA07462*/ 00622000
@RF00350 DS    0H                                                  0352 00623000
@RC00348 TM    INCLSYSL,B'00000010'                                0352 00624000
         BNO   @RF00352                                            0352 00625000
*               IF CRPBFCNT^=BLANK  /* THIS ANOTHER CONT     @Z67SP00*/ 00626000
*                 THEN              /* YES ---               @XA07462*/ 00627000
         L     @15,@PC00001+4                                      0353 00628000
         CLI   CRPBFCNT(@15),C' '                                  0353 00629000
         BNE   @RT00353                                            0353 00630000
*                 GO TO REREAD;     /* READ NEXT CARD        @Z67SP00*/ 00631000
*               ELSE                /*                       @Z67SP00*/ 00632000
*                 DO;               /*                       @Z67SP00*/ 00633000
*                   INCLFND=OFF;    /* NOT IN INCLUDE        @Z67SP00*/ 00634000
*                   INCLSYSL=OFF;   /* NOT SYSLMOD CONT      @Z67SP00*/ 00635000
         NI    INCLFND,B'11111100'                                 0357 00636000
*                   GO TO REREAD;   /* READ NEXT RCD         @Z67SP00*/ 00637000
         B     REREAD                                              0358 00638000
*                 END;              /*                       @XA07462*/ 00639000
*           END;                    /*                       @Z67SP00*/ 00640000
*         ELSE                      /* RCD NOT READ          @Z67SP00*/ 00641000
*           IF CRPRETRN=CRPEOF      /* PREMATURE END OF FILE?@Z67SP00*/ 00642000
*             THEN                  /* YES - INDICATE ERROR          */ 00643000
         B     @RC00346                                            0361 00644000
@RF00346 L     @15,@PC00001+4                                      0361 00645000
         CLI   CRPRETRN(@15),4                                     0361 00646000
         BNE   @RF00361                                            0361 00647000
*             PREMSW=ON;            /* PREMATURE EOF         @Z67SP00*/ 00648000
         OI    PREMSW,B'01000000'                                  0362 00649000
*           ELSE                    /*                       @Z67SP00*/ 00650000
*             IF CRPRETRN>CRPEOF    /* SERIOUS ERROR?        @Z67SP00*/ 00651000
*               THEN                /* YES - I/O ERROR               */ 00652000
         B     @RC00361                                            0363 00653000
@RF00361 L     @15,@PC00001+4                                      0363 00654000
         CLI   CRPRETRN(@15),4                                     0363 00655000
         BNH   @RF00363                                            0363 00656000
*               DO;                 /*                       @Z67SP00*/ 00657000
*                 CCRC=MAX(CCRC,CRPRETRN);/* SAVE RC         @Z67SP00*/ 00658000
         SLR   @14,@14                                             0365 00659000
         IC    @14,CCRC                                            0365 00660000
         SLR   @09,@09                                             0365 00661000
         IC    @09,CRPRETRN(,@15)                                  0365 00662000
         CR    @14,@09                                             0365 00663000
         BNL   *+6                                                      00664000
         LR    @14,@09                                             0365 00665000
         STC   @14,CCRC                                            0365 00666000
*                 CALL LKDERR(CRPBUFFR,LASTLINE);/*          @Z67SP00*/ 00667000
         LA    @15,CRPBUFFR(,@15)                                  0366 00668000
         ST    @15,@AL00001                                        0366 00669000
         LA    @15,LASTLINE                                        0366 00670000
         ST    @15,@AL00001+4                                      0366 00671000
         LA    @01,@AL00001                                        0366 00672000
         BAL   @14,LKDERR                                          0366 00673000
*               END;                /*                       @Z67SP00*/ 00674000
*       END;                        /* END SCAN OK           @Z67SP00*/ 00675000
*                                                                  0368 00676000
*     /***************************************************************/ 00677000
*     /*                                                             */ 00678000
*     /* IF SCAN RETURN CODE NOT OK THEN CHECK FOR ERRS      @Z67SP00*/ 00679000
*     /*                                                             */ 00680000
*     /***************************************************************/ 00681000
*                                                                  0369 00682000
*     ELSE                          /*                       @Z67SP00*/ 00683000
*       DO;                         /*                       @Z67SP00*/ 00684000
         B     @RC00330                                            0369 00685000
@RF00330 DS    0H                                                  0370 00686000
*         IF EXCERR=ON              /* IOP EXCEEDED ERR?     @YA05690*/ 00687000
*             |INTERR=ON            /* I/O ERROR?                    */ 00688000
*           THEN                    /* YES - RETURN                  */ 00689000
         TM    EXCERR,B'11000000'                                  0370 00690000
         BZ    @RF00370                                            0370 00691000
*           DO;                     /*                       @SA72421*/ 00692000
*             CALL LKDERR(CRPBUFFR,LASTLINE);/* ERR MSG      @Z67SP00*/ 00693000
         L     @15,@PC00001+4                                      0372 00694000
         LA    @15,CRPBUFFR(,@15)                                  0372 00695000
         ST    @15,@AL00001                                        0372 00696000
         LA    @15,LASTLINE                                        0372 00697000
         ST    @15,@AL00001+4                                      0372 00698000
         LA    @01,@AL00001                                        0372 00699000
         BAL   @14,LKDERR                                          0372 00700000
*             CCRC=MAX(CCRC,IOPIOERR);/* SET RC              @Z67SP00*/ 00701000
         SLR   @15,@15                                             0373 00702000
         IC    @15,CCRC                                            0373 00703000
         LA    @14,16                                              0373 00704000
         CR    @15,@14                                             0373 00705000
         BNL   *+6                                                      00706000
         LR    @15,@14                                             0373 00707000
         STC   @15,CCRC                                            0373 00708000
*           END;                    /*                       @SA72421*/ 00709000
*         ELSE                      /* ELSE, MUST BE SYNTAX ERROR    */ 00710000
*           IF TBLEXC=ON            /* TABLE OVERFLOW?               */ 00711000
*             THEN                  /* YES - INDICATE                */ 00712000
         B     @RC00370                                            0375 00713000
@RF00370 TM    TBLEXC,B'00100000'                                  0375 00714000
         BNO   @RF00375                                            0375 00715000
*             DO;                   /*                       @SA72421*/ 00716000
*               CALL LKDERR(CRPBUFFR,TBLOFLOW);/* ERR        @Z67SP00*/ 00717000
         L     @15,@PC00001+4                                      0377 00718000
         LA    @15,CRPBUFFR(,@15)                                  0377 00719000
         ST    @15,@AL00001                                        0377 00720000
         LA    @15,TBLOFLOW                                        0377 00721000
         ST    @15,@AL00001+4                                      0377 00722000
         LA    @01,@AL00001                                        0377 00723000
         BAL   @14,LKDERR                                          0377 00724000
*               CCRC=MAX(CCRC,TBLERR);/* SET RC              @Z67SP00*/ 00725000
         SLR   @15,@15                                             0378 00726000
         IC    @15,CCRC                                            0378 00727000
         LA    @14,12                                              0378 00728000
         CR    @15,@14                                             0378 00729000
         BNL   *+6                                                      00730000
         LR    @15,@14                                             0378 00731000
         STC   @15,CCRC                                            0378 00732000
*             END;                  /*                       @SA72421*/ 00733000
*           ELSE                    /* MUST BE SYNTAX ERROR          */ 00734000
*             DO;                   /*                       @SA72421*/ 00735000
         B     @RC00375                                            0380 00736000
@RF00375 DS    0H                                                  0381 00737000
*               CALL LKDERR(CRPBUFFR,CNTRLERR);/* ERR        @Z67SP00*/ 00738000
         L     @15,@PC00001+4                                      0381 00739000
         LA    @15,CRPBUFFR(,@15)                                  0381 00740000
         ST    @15,@AL00001                                        0381 00741000
         LA    @15,CNTRLERR                                        0381 00742000
         ST    @15,@AL00001+4                                      0381 00743000
         LA    @01,@AL00001                                        0381 00744000
         BAL   @14,LKDERR                                          0381 00745000
*               CCRC=MAX(CCRC,SYNTERR);/* SET RC             @Z67SP00*/ 00746000
         SLR   @15,@15                                             0382 00747000
         IC    @15,CCRC                                            0382 00748000
         LA    @14,10                                              0382 00749000
         CR    @15,@14                                             0382 00750000
         BNL   *+6                                                      00751000
         LR    @15,@14                                             0382 00752000
         STC   @15,CCRC                                            0382 00753000
*             END;                  /*                       @SA72421*/ 00754000
*       END;                        /*                       @Z67SP00*/ 00755000
@RC00375 DS    0H                                                  0384 00756000
@RC00370 DS    0H                                                  0385 00757000
*   END;                                                           0385 00758000
*                                                                  0385 00759000
@RC00330 DS    0H                                                  0385 00760000
@DE00327 L     @01,SCPPTR                                          0385 00761000
         L     @01,SCPCHAR(,@01)                                   0385 00762000
         CLC   SCPSTRNG(2,@01),@CC01405                            0385 00763000
         BE    @DC00327                                            0385 00764000
         TM    JCLENSW,B'11000000'                                 0385 00765000
         BNZ   @DC00327                                            0385 00766000
         CLI   CCRC,0                                              0385 00767000
         BE    @DL00327                                            0385 00768000
@DC00327 DS    0H                                                  0386 00769000
*   /*****************************************************************/ 00770000
*   /*                                                               */ 00771000
*   /* RETURN TO CALLER                                      @Z67SP00*/ 00772000
*   /*                                                               */ 00773000
*   /*****************************************************************/ 00774000
*                                                                  0386 00775000
*   RETURN CODE(CCRC);              /*                       @Z67SP00*/ 00776000
         SLR   @15,@15                                             0386 00777000
         IC    @15,CCRC                                            0386 00778000
         L     @14,@SA00003                                        0386 00779000
         LM    @00,@12,@SA00003+8                                  0386 00780000
         BR    @14                                                 0386 00781000
*   END LKDCC;                      /*                       @Z67SP00*/ 00782000
         EJECT                                                          00783000
*                                                                  0388 00784000
*   /*****************************************************************/ 00785000
*   /*                                                               */ 00786000
*   /* NAME CARD NOT FOUND IN INPUT. SCAN JCL FOR NAME       @Z67SP00*/ 00787000
*   /*                                                               */ 00788000
*   /*****************************************************************/ 00789000
*                                                                  0388 00790000
*LKDLNAME:                          /*                       @Z67SP00*/ 00791000
*   PROCEDURE;                      /*                       @Z67SP00*/ 00792000
LKDLNAME STM   @14,@12,@SA00004                                    0388 00793000
*   DECLARE                         /*                       @Z67SP00*/ 00794000
*     LMNRC FIXED(8);               /*                       @Z67SP00*/ 00795000
*   LMNRC=ZERO;                     /*                       @Z67SP00*/ 00796000
         MVI   LMNRC,X'00'                                         0390 00797000
*   IF SYSLADDR^=ZERO               /* SYSLMOD FOUND                 */ 00798000
*     THEN                          /* YES - SCAN FOR MODNAME        */ 00799000
         L     @15,SYSLADDR                                        0391 00800000
         LTR   @15,@15                                             0391 00801000
         BZ    @RF00391                                            0391 00802000
*     DO;                                                          0392 00803000
*       SCPCHAR=SYSLADDR;           /* POINT TO ADDRESS              */ 00804000
         L     @14,SCPPTR                                          0393 00805000
         ST    @15,SCPCHAR(,@14)                                   0393 00806000
*       DO WHILE SCPSTRNG(1)^=IOPEOLST;/* LOOP LOOKING FOR LEFT PAREN   00807000
*                                                            @Z40SP00*/ 00808000
         B     @DE00394                                            0394 00809000
@DL00394 DS    0H                                                  0395 00810000
*         SCPCHAR=SCPCHAR+1;        /* BUMP STRING BASE              */ 00811000
         L     @15,SCPPTR                                          0395 00812000
         LA    @14,1                                               0395 00813000
         L     @09,SCPCHAR(,@15)                                   0395 00814000
         ALR   @09,@14                                             0395 00815000
         ST    @09,SCPCHAR(,@15)                                   0395 00816000
*         IF SCPSTRNG(1)=LPAREN     /* FND START OF MODNAME  @Z40SP00*/ 00817000
*           THEN                    /* GO TO CONTINUE SCAN           */ 00818000
         CLI   SCPSTRNG(@09),C'('                                  0396 00819000
         BNE   @RF00396                                            0396 00820000
*           DO;                                                    0397 00821000
*             SCPCHAR=SCPCHAR+1;    /* SKIP PAST LPAREN              */ 00822000
         ALR   @09,@14                                             0398 00823000
         ST    @09,SCPCHAR(,@15)                                   0398 00824000
*             GO TO MODNMGT;        /* GO SAVE THE MODULE NAME       */ 00825000
         B     MODNMGT                                             0399 00826000
*           END;                                                   0400 00827000
*       END;                                                       0401 00828000
@RF00396 DS    0H                                                  0401 00829000
@DE00394 L     @01,SCPPTR                                          0401 00830000
         L     @15,SCPCHAR(,@01)                                   0401 00831000
         CLI   SCPSTRNG(@15),255                                   0401 00832000
         BNE   @DL00394                                            0401 00833000
*       CALL LKDERR(JCLLINE,NOMODNM);/* WRITE ERR            @Z67SP00*/ 00834000
         L     @14,@PC00001+8                                      0402 00835000
         LCR   @14,@14                                             0402 00836000
         ALR   @14,@15                                             0402 00837000
         ST    @15,@TF00001                                        0402 00838000
         SRDA  @14,32                                              0402 00839000
         D     @14,@CF00538                                        0402 00840000
         LCR   @14,@14                                             0402 00841000
         AL    @14,@TF00001                                        0402 00842000
         ST    @14,@AL00001                                        0402 00843000
         LA    @15,NOMODNM                                         0402 00844000
         ST    @15,@AL00001+4                                      0402 00845000
         LA    @01,@AL00001                                        0402 00846000
         BAL   @14,LKDERR                                          0402 00847000
*       LMNRC=MAX(LMNRC,SYNTERR);   /* SET RC                @YA07506*/ 00848000
         SLR   @15,@15                                             0403 00849000
         IC    @15,LMNRC                                           0403 00850000
         LA    @14,10                                              0403 00851000
         CR    @15,@14                                             0403 00852000
         BNL   *+6                                                      00853000
         LR    @15,@14                                             0403 00854000
         STC   @15,LMNRC                                           0403 00855000
*     END;                                                         0404 00856000
*                                                                  0404 00857000
*   /*****************************************************************/ 00858000
*   /*                                                               */ 00859000
*   /* LOOP UNTIL MOD= FOUND OR END OF JCL REACHED                   */ 00860000
*   /*                                                               */ 00861000
*   /*****************************************************************/ 00862000
*                                                                  0405 00863000
*   ELSE                            /*                       @Z67SP00*/ 00864000
*     DO;                           /*                       @Z67SP00*/ 00865000
         B     @RC00391                                            0405 00866000
@RF00391 DS    0H                                                  0406 00867000
*       SCPCHAR=ADDR(BUFFER);       /* POINT TO JCL BUFFER           */ 00868000
         L     @15,@PC00001+8                                      0406 00869000
         L     @14,SCPPTR                                          0406 00870000
         ST    @15,SCPCHAR(,@14)                                   0406 00871000
*       DO WHILE SCPSTRNG(1)^=IOPEOLST;/* LOOP TO FIND MOD= KEYWORD     00872000
*                                                            @Z67SP00*/ 00873000
         B     @DE00407                                            0407 00874000
@DL00407 DS    0H                                                  0408 00875000
*         SCPCHAR=SCPCHAR+1;        /* BUMP STRING BASE              */ 00876000
         L     @15,SCPPTR                                          0408 00877000
         LA    @14,1                                               0408 00878000
         AL    @14,SCPCHAR(,@15)                                   0408 00879000
         ST    @14,SCPCHAR(,@15)                                   0408 00880000
*         IF SCPSTRNG(1:LENGTH(MODKEY))=MODKEY/* THIS MOD=?  @Z40SP00*/ 00881000
*           THEN                    /* THEN EXIT FROM SCAN LOOP      */ 00882000
         CLC   SCPSTRNG(4,@14),@CC01412                            0409 00883000
         BE    @RT00409                                            0409 00884000
*           GO TO MODKEYGT;         /*                       @Z67SP00*/ 00885000
*       END;                                                       0411 00886000
*                                                                  0411 00887000
@DE00407 L     @01,SCPPTR                                          0411 00888000
         L     @01,SCPCHAR(,@01)                                   0411 00889000
         CLI   SCPSTRNG(@01),255                                   0411 00890000
         BNE   @DL00407                                            0411 00891000
*       /*************************************************************/ 00892000
*       /*                                                           */ 00893000
*       /* MOD= KEYWORD NOT FOUND - ERROR                    @Z67SP00*/ 00894000
*       /*                                                           */ 00895000
*       /*************************************************************/ 00896000
*                                                                  0412 00897000
*       CALL LKDERR(CRPBUFFR,NOMODKEY);/* WRITE ERR MSG      @Z67SP00*/ 00898000
         L     @15,@PC00001+4                                      0412 00899000
         LA    @15,CRPBUFFR(,@15)                                  0412 00900000
         ST    @15,@AL00001                                        0412 00901000
         LA    @15,NOMODKEY                                        0412 00902000
         ST    @15,@AL00001+4                                      0412 00903000
         LA    @01,@AL00001                                        0412 00904000
         BAL   @14,LKDERR                                          0412 00905000
*       LMNRC=MAX(LMNRC,SYNTERR);   /*                       @YA07506*/ 00906000
         SLR   @15,@15                                             0413 00907000
         IC    @15,LMNRC                                           0413 00908000
         LA    @14,10                                              0413 00909000
         CR    @15,@14                                             0413 00910000
         BNL   *+6                                                      00911000
         LR    @15,@14                                             0413 00912000
         STC   @15,LMNRC                                           0413 00913000
*     END;                          /*                       @Z67SP00*/ 00914000
*   RETURN CODE(LMNRC);             /*                       @Z67SP00*/ 00915000
@RC00391 SLR   @15,@15                                             0415 00916000
         IC    @15,LMNRC                                           0415 00917000
         L     @14,@SA00004                                        0415 00918000
         LM    @00,@12,@SA00004+8                                  0415 00919000
         BR    @14                                                 0415 00920000
*MODKEYGT:                                                         0416 00921000
*   MODKEYPT=SCPCHAR;               /* SAVE ADDR OF MOD= KEYWORD   0416 00922000
*                                                            @SA72421*/ 00923000
MODKEYGT L     @15,SCPPTR                                          0416 00924000
         L     @14,SCPCHAR(,@15)                                   0416 00925000
         ST    @14,MODKEYPT                                        0416 00926000
*   SCPCHAR=SCPCHAR+LENGTH(MODKEY); /* BUMP PAST MOD KEYWORD         */ 00927000
*                                                                  0417 00928000
         AL    @14,@CF00062                                        0417 00929000
         ST    @14,SCPCHAR(,@15)                                   0417 00930000
*   /*****************************************************************/ 00931000
*   /*                                                               */ 00932000
*   /* MOD NAME FOUND ON SYSLMOD OR MOD= KEYWORD FOUND NOW GET LMOD  */ 00933000
*   /* NAME                                                  @Z67SP00*/ 00934000
*   /*                                                               */ 00935000
*   /*****************************************************************/ 00936000
*                                                                  0418 00937000
*MODNMGT:                                                          0418 00938000
*   TEMPPTR1=SCPCHAR;               /* SAVE START OF NAME ADDR       */ 00939000
MODNMGT  L     @01,SCPPTR                                          0418 00940000
         L     @15,SCPCHAR(,@01)                                   0418 00941000
         ST    @15,TEMPPTR1                                        0418 00942000
*   DO WHILE SCPSTRNG(1)^=IOPEOLST; /* BUMP & SCN FOR END    @Z40SP00*/ 00943000
         B     @DE00419                                            0419 00944000
@DL00419 DS    0H                                                  0420 00945000
*     SCPCHAR=SCPCHAR+1;            /* BUMP STRING BASE FOR SCAN     */ 00946000
         L     @15,SCPPTR                                          0420 00947000
         LA    @14,1                                               0420 00948000
         AL    @14,SCPCHAR(,@15)                                   0420 00949000
         ST    @14,SCPCHAR(,@15)                                   0420 00950000
*     IF SCPSTRNG(1)=COMMA          /* IS THIS A COMMA?      @Z40SP00*/ 00951000
*         |SCPSTRNG(1)=BLANK        /* OR BLANK?             @Z40SP00*/ 00952000
*         |SCPSTRNG(1)=RPAREN       /* OR RIGHT PAREN?       @Z40SP00*/ 00953000
*       THEN                                                       0421 00954000
         CLI   SCPSTRNG(@14),C','                                  0421 00955000
         BE    @RT00421                                            0421 00956000
         CLI   SCPSTRNG(@14),C' '                                  0421 00957000
         BE    @RT00421                                            0421 00958000
         CLI   SCPSTRNG(@14),C')'                                  0421 00959000
         BE    @RT00421                                            0421 00960000
*       GO TO MODNMGT2;             /* YES - EXIT FROM LOOP          */ 00961000
*   END;                                                           0423 00962000
*                                                                  0423 00963000
@DE00419 L     @15,SCPPTR                                          0423 00964000
         L     @01,SCPCHAR(,@15)                                   0423 00965000
         CLI   SCPSTRNG(@01),255                                   0423 00966000
         BNE   @DL00419                                            0423 00967000
*   /*****************************************************************/ 00968000
*   /*                                                               */ 00969000
*   /* UNABLE TO FIND LMOD NAME                              @SA72421*/ 00970000
*   /*                                                               */ 00971000
*   /*****************************************************************/ 00972000
*                                                                  0424 00973000
*   SCPCHAR=MODKEYPT;               /* POINT TO MOD= KEYWRD  @SA72421*/ 00974000
         L     @14,MODKEYPT                                        0424 00975000
         ST    @14,SCPCHAR(,@15)                                   0424 00976000
*   CALL LKDERR(JCLLINE,INVALKEY);  /* FIND LINE IN ERR      @Z67SP00*/ 00977000
         L     @15,@PC00001+8                                      0425 00978000
         LR    @00,@15                                             0425 00979000
         LCR   @00,@00                                             0425 00980000
         ALR   @00,@14                                             0425 00981000
         SRDA  @00,32                                              0425 00982000
         D     @00,@CF00538                                        0425 00983000
         SLR   @14,@00                                             0425 00984000
         ST    @14,@AL00001                                        0425 00985000
         LA    @15,INVALKEY                                        0425 00986000
         ST    @15,@AL00001+4                                      0425 00987000
         LA    @01,@AL00001                                        0425 00988000
         BAL   @14,LKDERR                                          0425 00989000
*   LMNRC=MAX(LMNRC,SYNTERR);       /* SET RC                @YA07506*/ 00990000
*                                                                  0426 00991000
         SLR   @15,@15                                             0426 00992000
         IC    @15,LMNRC                                           0426 00993000
         LA    @14,10                                              0426 00994000
         CR    @15,@14                                             0426 00995000
         BNL   *+6                                                      00996000
         LR    @15,@14                                             0426 00997000
         STC   @15,LMNRC                                           0426 00998000
*   /*****************************************************************/ 00999000
*   /*                                                               */ 01000000
*   /* IF LMOD NAME FOUND THEN CALC LENGTH OF NAME           @Z67SP00*/ 01001000
*   /*                                                               */ 01002000
*   /*****************************************************************/ 01003000
*                                                                  0427 01004000
*   IF LMNRC=ZERO                   /* IF NAME FOUND         @Z67SP00*/ 01005000
*     THEN                          /*                       @Z67SP00*/ 01006000
         CLI   LMNRC,0                                             0427 01007000
         BNE   @RF00427                                            0427 01008000
*     DO;                           /*                       @Z67SP00*/ 01009000
*MODNMGT2:                                                         0429 01010000
*       TEMPPTR2=SCPCHAR-TEMPPTR1;  /* CALCULATE CHAR LENGTH         */ 01011000
MODNMGT2 L     @15,TEMPPTR1                                        0429 01012000
         L     @14,SCPPTR                                          0429 01013000
         L     @09,SCPCHAR(,@14)                                   0429 01014000
         SLR   @09,@15                                             0429 01015000
         ST    @09,TEMPPTR2                                        0429 01016000
*       SCPCHAR=TEMPPTR1;           /* POINT TO NAME OF LMOD         */ 01017000
         ST    @15,SCPCHAR(,@14)                                   0430 01018000
*       SCPPMLN=TEMPPTR2;           /* INDICATE LENGTH FOR EXIT      */ 01019000
         STH   @09,SCPPMLN(,@14)                                   0431 01020000
*       CALL RNAMEV;                /* GO STOW MODULES INTO CDS      */ 01021000
         BAL   @14,RNAMEV                                          0432 01022000
*       IF SCPRET^=SCPGOOD          /* IF ERR IN STOW        @Z67SP00*/ 01023000
*         THEN                      /*                               */ 01024000
         L     @01,SCPPTR                                          0433 01025000
         CLI   SCPRET(@01),0                                       0433 01026000
         BE    @RF00433                                            0433 01027000
*         DO;                       /*                       @YA07506*/ 01028000
*           IF INTERR=ON            /* INTERNAL ERROR?               */ 01029000
*             THEN                  /* YES - MUST BE I/O ERROR       */ 01030000
         TM    INTERR,B'10000000'                                  0435 01031000
         BNO   @RF00435                                            0435 01032000
*             DO;                   /*                       @Z67SP00*/ 01033000
*               CALL LKDERR(CRPBUFFR,LASTLINE);/* ERR MSG    @Z67SP00*/ 01034000
         L     @15,@PC00001+4                                      0437 01035000
         LA    @15,CRPBUFFR(,@15)                                  0437 01036000
         ST    @15,@AL00001                                        0437 01037000
         LA    @15,LASTLINE                                        0437 01038000
         ST    @15,@AL00001+4                                      0437 01039000
         LA    @01,@AL00001                                        0437 01040000
         BAL   @14,LKDERR                                          0437 01041000
*               LMNRC=MAX(LMNRC,STOPSMP);/*                  @Z67SP00*/ 01042000
         SLR   @15,@15                                             0438 01043000
         IC    @15,LMNRC                                           0438 01044000
         LA    @14,16                                              0438 01045000
         CR    @15,@14                                             0438 01046000
         BNL   *+6                                                      01047000
         LR    @15,@14                                             0438 01048000
         STC   @15,LMNRC                                           0438 01049000
*             END;                  /*                       @Z67SP00*/ 01050000
*           ELSE                    /* NOT IO ERR            @SA72421*/ 01051000
*             DO;                   /*                       @Z67SP00*/ 01052000
         B     @RC00435                                            0440 01053000
@RF00435 DS    0H                                                  0441 01054000
*               CALL LKDERR(JCLLINE,STOWERR);/*              @Z67SP00*/ 01055000
         L     @01,SCPPTR                                          0441 01056000
         L     @15,SCPCHAR(,@01)                                   0441 01057000
         L     @14,@PC00001+8                                      0441 01058000
         LR    @00,@14                                             0441 01059000
         LCR   @00,@00                                             0441 01060000
         ALR   @00,@15                                             0441 01061000
         SRDA  @00,32                                              0441 01062000
         D     @00,@CF00538                                        0441 01063000
         SLR   @15,@00                                             0441 01064000
         ST    @15,@AL00001                                        0441 01065000
         LA    @15,STOWERR                                         0441 01066000
         ST    @15,@AL00001+4                                      0441 01067000
         LA    @01,@AL00001                                        0441 01068000
         BAL   @14,LKDERR                                          0441 01069000
*               LMNRC=MAX(LMNRC,SYNTERR);/* SET RC           @YA07506*/ 01070000
         SLR   @15,@15                                             0442 01071000
         IC    @15,LMNRC                                           0442 01072000
         LA    @14,10                                              0442 01073000
         CR    @15,@14                                             0442 01074000
         BNL   *+6                                                      01075000
         LR    @15,@14                                             0442 01076000
         STC   @15,LMNRC                                           0442 01077000
*             END;                  /*                       @Z67SP00*/ 01078000
*         END;                      /*                       @Z67SP00*/ 01079000
@RC00435 DS    0H                                                  0445 01080000
*     END;                          /*                       @Z67SP00*/ 01081000
*                                                                  0445 01082000
@RF00433 DS    0H                                                  0446 01083000
*   /*****************************************************************/ 01084000
*   /*                                                               */ 01085000
*   /* RETURN TO CALLER                                      @Z67SP00*/ 01086000
*   /*                                                               */ 01087000
*   /*****************************************************************/ 01088000
*                                                                  0446 01089000
*   RETURN CODE(LMNRC);             /*                       @Z67SP00*/ 01090000
@RF00427 SLR   @15,@15                                             0446 01091000
         IC    @15,LMNRC                                           0446 01092000
         L     @14,@SA00004                                        0446 01093000
         LM    @00,@12,@SA00004+8                                  0446 01094000
         BR    @14                                                 0446 01095000
*   END LKDLNAME;                   /*                       @Z67SP00*/ 01096000
         EJECT                                                          01097000
*                                                                  0448 01098000
*   /*****************************************************************/ 01099000
*   /*                                                               */ 01100000
*   /* ROUTINES ENTERED DURING SCANNING OF JCL BUFFER        @Z67SP00*/ 01101000
*   /*                                                               */ 01102000
*   /*****************************************************************/ 01103000
*                                                                  0448 01104000
*JCLROUTS:                          /*                       @Z67SP00*/ 01105000
*   PROCEDURE;                      /*                       @Z67SP00*/ 01106000
JCLROUTS STM   @14,@12,@SA00005                                    0448 01107000
*   DECLARE                         /*                       @Z67SP00*/ 01108000
*     JRTRC FIXED(8);               /*                       @Z67SP00*/ 01109000
*KEY010:                            /* RENT SPECIFIED                */ 01110000
*   ENTRY;                          /*                       @Z67SP00*/ 01111000
         B     @EC00450                                            0450 01112000
KEY010   STM   @14,@12,@SA00005                                    0450 01113000
@EC00450 DS    0H                                                  0451 01114000
*   IF PARMEQSW=ON                  /* PARM= FOUND?          @SA75303*/ 01115000
*     THEN                          /* YES                   @SA75303*/ 01116000
         TM    PARMEQSW,B'10000000'                                0451 01117000
         BNO   @RF00451                                            0451 01118000
*     IOPRENT=ON;                   /* INDICATE RENT                 */ 01119000
         L     @01,IOPPTR                                          0452 01120000
         OI    IOPRENT(@01),B'01000000'                            0452 01121000
*   GO TO SCANBMP;                  /* EXIT                          */ 01122000
         B     SCANBMP                                             0453 01123000
*KEY020:                            /* REUS SPECIFIED                */ 01124000
*   ENTRY;                          /*                       @Z67SP00*/ 01125000
KEY020   STM   @14,@12,@SA00005                                    0454 01126000
*   IF PARMEQSW=ON                  /* PARM= FOUND?          @SA75303*/ 01127000
*     THEN                          /* YES                   @SA75303*/ 01128000
         TM    PARMEQSW,B'10000000'                                0455 01129000
         BNO   @RF00455                                            0455 01130000
*     IOPREUS=ON;                   /* INDICATE REUS                 */ 01131000
         L     @01,IOPPTR                                          0456 01132000
         OI    IOPREUS(@01),B'00100000'                            0456 01133000
*   GO TO SCANBMP;                  /* EXIT                          */ 01134000
         B     SCANBMP                                             0457 01135000
*KEY030:                            /* SCTR SPECIFIED                */ 01136000
*   ENTRY;                          /*                       @Z67SP00*/ 01137000
KEY030   STM   @14,@12,@SA00005                                    0458 01138000
*   IF PARMEQSW=ON                  /* PARM= FOUND?          @SA75303*/ 01139000
*     THEN                          /* YES                   @SA75303*/ 01140000
         TM    PARMEQSW,B'10000000'                                0459 01141000
         BNO   @RF00459                                            0459 01142000
*     IOPSCTR=ON;                   /* INDICATE SCTR                 */ 01143000
         L     @01,IOPPTR                                          0460 01144000
         OI    IOPSCTR(@01),B'00010000'                            0460 01145000
*   GO TO SCANBMP;                  /* EXIT                          */ 01146000
         B     SCANBMP                                             0461 01147000
*KEY040:                            /* OVLY SPECIFIED                */ 01148000
*   ENTRY;                          /*                       @Z67SP00*/ 01149000
KEY040   STM   @14,@12,@SA00005                                    0462 01150000
*   IF PARMEQSW=ON                  /* PARM= FOUND?          @SA75303*/ 01151000
*     THEN                          /* YES                   @SA75303*/ 01152000
         TM    PARMEQSW,B'10000000'                                0463 01153000
         BNO   @RF00463                                            0463 01154000
*     IOPOVLY=ON;                   /* INDICATE OVLY                 */ 01155000
         L     @01,IOPPTR                                          0464 01156000
         OI    IOPOVLY(@01),B'00001000'                            0464 01157000
*   GO TO SCANBMP;                  /* EXIT                          */ 01158000
         B     SCANBMP                                             0465 01159000
*KEY050:                            /* REFR SPECIFIED                */ 01160000
*   ENTRY;                          /*                       @Z67SP00*/ 01161000
KEY050   STM   @14,@12,@SA00005                                    0466 01162000
*   IF PARMEQSW=ON                  /* PARM= FOUND?          @SA75303*/ 01163000
*     THEN                          /* YES                   @SA75303*/ 01164000
         TM    PARMEQSW,B'10000000'                                0467 01165000
         BNO   @RF00467                                            0467 01166000
*     IOPREFR=ON;                   /* INDICATE REFR SPECIFIED       */ 01167000
         L     @01,IOPPTR                                          0468 01168000
         OI    IOPREFR(@01),B'00000100'                            0468 01169000
*   GO TO SCANBMP;                  /* EXIT                          */ 01170000
         B     SCANBMP                                             0469 01171000
*KEY060:                            /* DC SPECIFIED                  */ 01172000
*   ENTRY;                          /*                       @Z67SP00*/ 01173000
KEY060   STM   @14,@12,@SA00005                                    0470 01174000
*   IF SCPSTRNG(3)>=CHARA           /* IS NEXT CHAR ALPHABETIC?      */ 01175000
*       &SCPSTRNG(3)<=CHARZ         /* HIGH RANGE FOR ALPHABETIC     */ 01176000
*     THEN                          /* IF ALPHABETIC         @Z40SP00*/ 01177000
         L     @01,SCPPTR                                          0471 01178000
         L     @15,SCPCHAR(,@01)                                   0471 01179000
         CLI   SCPSTRNG+2(@15),C'A'                                0471 01180000
         BL    @RF00471                                            0471 01181000
         CLI   SCPSTRNG+2(@15),C'Z'                                0471 01182000
         BNH   @RT00471                                            0471 01183000
*     GO TO JCLRTN;                 /* NOT NE SKIP           @Z40SP00*/ 01184000
*   IF PARMEQSW=ON                  /* PARM= FOUND?          @SA75303*/ 01185000
*     THEN                          /* YES                   @SA75303*/ 01186000
@RF00471 TM    PARMEQSW,B'10000000'                                0473 01187000
         BNO   @RF00473                                            0473 01188000
*     IOPDC=ON;                     /* INDICATE DC SPECIFIED         */ 01189000
         L     @01,IOPPTR                                          0474 01190000
         OI    IOPDC(@01),B'00000010'                              0474 01191000
*   GO TO SCANBMP;                  /* EXIT                          */ 01192000
         B     SCANBMP                                             0475 01193000
*KEY070:                            /* NE KEYWORD FOUND              */ 01194000
*   ENTRY;                          /*                       @Z67SP00*/ 01195000
KEY070   STM   @14,@12,@SA00005                                    0476 01196000
*   IF SCPSTRNG(3)>CHARA            /* IF NEXT CHAR IS ALPH  @ZA08843*/ 01197000
*       &SCPSTRNG(3)<=CHAR9         /* OR NUMERIC            @ZA08843*/ 01198000
*       &SCPSTRNG(3)^=BLANK         /* AND NOT BLANK         @ZA08843*/ 01199000
*     THEN                          /* THEN NOT NE PARM      @ZA08843*/ 01200000
         L     @01,SCPPTR                                          0477 01201000
         L     @15,SCPCHAR(,@01)                                   0477 01202000
         CLI   SCPSTRNG+2(@15),C'A'                                0477 01203000
         BNH   @RF00477                                            0477 01204000
         CLI   SCPSTRNG+2(@15),C'9'                                0477 01205000
         BH    @RF00477                                            0477 01206000
         CLI   SCPSTRNG+2(@15),C' '                                0477 01207000
         BNE   @RT00477                                            0477 01208000
*     GO TO JCLRTN;                 /* SKIP NE SETTING       @ZA08843*/ 01209000
*   IF PARMEQSW=ON                  /* PARM= FOUND?          @SA75303*/ 01210000
*     THEN                          /* YES                   @SA75303*/ 01211000
@RF00477 TM    PARMEQSW,B'10000000'                                0479 01212000
         BNO   @RF00479                                            0479 01213000
*     IOPNE=ON;                     /* NE SPECIFIED                  */ 01214000
         L     @01,IOPPTR                                          0480 01215000
         OI    IOPNE(@01),B'10000000'                              0480 01216000
*   GO TO SCANBMP;                  /* EXIT TO CONTINUE              */ 01217000
         B     SCANBMP                                             0481 01218000
*KEY075:                            /* APF PARM, AC=1 FOUND  @VS08700*/ 01219000
*   ENTRY;                          /*                       @Z67SP00*/ 01220000
KEY075   STM   @14,@12,@SA00005                                    0482 01221000
*   IF PARMEQSW=ON                  /* PARM= FOUND?          @SA75303*/ 01222000
*     THEN                          /* YES                   @SA75303*/ 01223000
         TM    PARMEQSW,B'10000000'                                0483 01224000
         BNO   @RF00483                                            0483 01225000
*     IOPAPF=ON;                    /* INDICATE APF IN IOP   @VS08700*/ 01226000
         L     @01,IOPPTR                                          0484 01227000
         OI    IOPAPF(@01),B'10000000'                             0484 01228000
*   GO TO SCANBMP;                  /* EXIT                  @VS08700*/ 01229000
         B     SCANBMP                                             0485 01230000
*KEY080:                            /* SYSLMOD DD FOUND              */ 01231000
*   ENTRY;                          /*                       @Z67SP00*/ 01232000
KEY080   STM   @14,@12,@SA00005                                    0486 01233000
*   SYSLSW=ON;                      /* INDICATE SYSLMOD FOUND        */ 01234000
         OI    SYSLSW,B'00010000'                                  0487 01235000
*   GO TO SCANBMP;                  /* RETURN TO CONTINUE            */ 01236000
         B     SCANBMP                                             0488 01237000
*                                                                  0489 01238000
*   /*****************************************************************/ 01239000
*   /*                                                               */ 01240000
*   /* ROUTS TO SAVE SYSTEM LIBRARY NAME                     @Z67SP00*/ 01241000
*   /*                                                               */ 01242000
*   /*****************************************************************/ 01243000
*                                                                  0489 01244000
*KEY090:                            /* DSN= KEYWORD FOUND            */ 01245000
*   ENTRY;                          /*                       @Z67SP00*/ 01246000
KEY090   STM   @14,@12,@SA00005                                    0489 01247000
*   IF SYSLSW=OFF                   /* IF SYSLMOD NOT FOUND          */ 01248000
*     THEN                          /* THEN RETURN                   */ 01249000
         TM    SYSLSW,B'00010000'                                  0490 01250000
         BZ    @RT00490                                            0490 01251000
*     GO TO SCANBMP;                /*                       @Z67SP00*/ 01252000
*   SYSLADDR=SCPCHAR;               /* SAVE ADDR OF SYSLMOD          */ 01253000
         L     @01,SCPPTR                                          0492 01254000
         L     @15,SCPCHAR(,@01)                                   0492 01255000
         ST    @15,SYSLADDR                                        0492 01256000
*KEY100:                            /* NAME= KEYWORD FOUND           */ 01257000
*   ENTRY;                          /*                       @Z67SP00*/ 01258000
         B     @EC00493                                            0493 01259000
KEY100   STM   @14,@12,@SA00005                                    0493 01260000
@EC00493 DS    0H                                                  0494 01261000
*   IF SYSTSW=ON                    /* IS SYSTEM LIBRARY FOUND?      */ 01262000
*     THEN                          /* THEN RETURN                   */ 01263000
         TM    SYSTSW,B'00001000'                                  0494 01264000
         BO    @RT00494                                            0494 01265000
*     GO TO SCANBMP;                /*                       @Z67SP00*/ 01266000
*   SCPCHAR=SCPCHAR+KEYLEN(TEMPPTR1);/* BUMP PAST KEYWORD            */ 01267000
*                                                                  0496 01268000
         L     @15,SCPPTR                                          0496 01269000
         L     @14,TEMPPTR1                                        0496 01270000
         MH    @14,@CH00466                                        0496 01271000
         SLR   @09,@09                                             0496 01272000
         IC    @09,KEYLEN-13(@14)                                  0496 01273000
         AL    @09,SCPCHAR(,@15)                                   0496 01274000
         ST    @09,SCPCHAR(,@15)                                   0496 01275000
*   /*****************************************************************/ 01276000
*   /*                                                               */ 01277000
*   /* PICK OFF THE SYSTEM LIBRARY FROM THE JCL                      */ 01278000
*   /*                                                               */ 01279000
*   /*****************************************************************/ 01280000
*                                                                  0497 01281000
*   SYSLSW=OFF;                     /* TURN OFF SYSLMOD SWITCH       */ 01282000
         NI    SYSLSW,B'11101111'                                  0497 01283000
*PICKLIB1:                                                         0498 01284000
*   TEMPPTR1=SCPCHAR;               /* SAVE CURRENT STRING PTR       */ 01285000
PICKLIB1 L     @01,SCPPTR                                          0498 01286000
         L     @15,SCPCHAR(,@01)                                   0498 01287000
         ST    @15,TEMPPTR1                                        0498 01288000
*   DO J=0 TO 8;                    /* LOOP THROUGH TO FIND END      */ 01289000
         SLR   @15,@15                                             0499 01290000
         ST    @15,J                                               0499 01291000
@DL00499 DS    0H                                                  0500 01292000
*     IF SCPSTRNG(1)=BLANK|         /* BLANK?                @Z40SP00*/ 01293000
*         SCPSTRNG(1)=COMMA|        /* OR COMMA?             @Z40SP00*/ 01294000
*         SCPSTRNG(1)=QUOTE|        /* OR QUOTE?             @Z40SP00*/ 01295000
*         SCPSTRNG(1)=LPAREN        /* START OF MEMBER NAME  @Z40SP00*/ 01296000
*       THEN                        /* THEN EXIT FROM LOOP           */ 01297000
         L     @15,SCPPTR                                          0500 01298000
         L     @14,SCPCHAR(,@15)                                   0500 01299000
         CLI   SCPSTRNG(@14),C' '                                  0500 01300000
         BE    @RT00500                                            0500 01301000
         CLI   SCPSTRNG(@14),C','                                  0500 01302000
         BE    @RT00500                                            0500 01303000
         CLI   SCPSTRNG(@14),C''''                                 0500 01304000
         BE    @RT00500                                            0500 01305000
         CLI   SCPSTRNG(@14),C'('                                  0500 01306000
         BE    @RT00500                                            0500 01307000
*       GO TO PICKLIB2;             /*                       @Z67SP00*/ 01308000
*     IF SCPSTRNG(1)=PERIOD         /* ANOTHER LEVEL OD DSN? @Z40SP00*/ 01309000
*       THEN                        /* YES                   @SA71759*/ 01310000
         CLI   SCPSTRNG(@14),C'.'                                  0502 01311000
         BNE   @RF00502                                            0502 01312000
*       DO;                         /*                       @SA72436*/ 01313000
*         SCPCHAR=SCPCHAR+1;        /* UPDATE PTR TO CHAR    @SA72436*/ 01314000
         AL    @14,@CF00048                                        0504 01315000
         ST    @14,SCPCHAR(,@15)                                   0504 01316000
*         GO TO PICKLIB1;           /* BRANCH TO PROCESS IT  @SA71759*/ 01317000
         B     PICKLIB1                                            0505 01318000
*       END;                        /*                       @SA72436*/ 01319000
*     SCPCHAR=SCPCHAR+1;            /* BUMP TO NEXT CHARACTER        */ 01320000
@RF00502 L     @15,SCPPTR                                          0507 01321000
         LA    @14,1                                               0507 01322000
         AL    @14,SCPCHAR(,@15)                                   0507 01323000
         ST    @14,SCPCHAR(,@15)                                   0507 01324000
*   END;                                                           0508 01325000
         LA    @15,1                                               0508 01326000
         AL    @15,J                                               0508 01327000
         ST    @15,J                                               0508 01328000
         C     @15,@CF00043                                        0508 01329000
         BNH   @DL00499                                            0508 01330000
*PICKLIB2:                                                         0509 01331000
*   IF J=0                          /* NO DSNAME CODED?      @SA72436*/ 01332000
*     THEN                          /* NO - ERR              @SA72436*/ 01333000
PICKLIB2 L     @15,J                                               0509 01334000
         LTR   @15,@15                                             0509 01335000
         BNZ   @RF00509                                            0509 01336000
*     DO;                           /*                       @SA72421*/ 01337000
*       CALL LKDERR(JCLLINE,NODSN); /* ERR MSG               @Z67SP00*/ 01338000
         L     @01,SCPPTR                                          0511 01339000
         L     @15,SCPCHAR(,@01)                                   0511 01340000
         L     @14,@PC00001+8                                      0511 01341000
         LR    @00,@14                                             0511 01342000
         LCR   @00,@00                                             0511 01343000
         ALR   @00,@15                                             0511 01344000
         SRDA  @00,32                                              0511 01345000
         D     @00,@CF00538                                        0511 01346000
         SLR   @15,@00                                             0511 01347000
         ST    @15,@AL00001                                        0511 01348000
         LA    @15,NODSN                                           0511 01349000
         ST    @15,@AL00001+4                                      0511 01350000
         LA    @01,@AL00001                                        0511 01351000
         BAL   @14,LKDERR                                          0511 01352000
*       JRTRC=SYNTERR;              /* SET RC TO ERR         @Z67SP00*/ 01353000
         MVI   JRTRC,X'0A'                                         0512 01354000
*       GO TO JCLRTN;               /*                       @Z67SP00*/ 01355000
         B     JCLRTN                                              0513 01356000
*     END;                          /*                       @SA72421*/ 01357000
*   SYSTLIB=TEMPPTR1->SCPSTRNG(1:J);/* GET LIB NAME          @Z40SP00*/ 01358000
@RF00509 MVI   SYSTLIB+1,C' '                                      0515 01359000
         MVC   SYSTLIB+2(6),SYSTLIB+1                              0515 01360000
         L     @15,J                                               0515 01361000
         BCTR  @15,0                                               0515 01362000
         L     @01,TEMPPTR1                                        0515 01363000
         EX    @15,@SM01737                                        0515 01364000
*   SYSTSW=ON;                      /* INDICATE SYSTEM LIBRARY GOTTEN*/ 01365000
         OI    SYSTSW,B'00001000'                                  0516 01366000
*   GO TO JCLRTN0;                  /* LOOK FOR NEXT KEYWORD         */ 01367000
         B     JCLRTN0                                             0517 01368000
*                                                                  0518 01369000
*   /*****************************************************************/ 01370000
*   /*                                                               */ 01371000
*   /* ALIGN2 LKED OPTION SCAN ROUTINE                               */ 01372000
*   /*                                                               */ 01373000
*   /*****************************************************************/ 01374000
*                                                                  0518 01375000
*KEY110:                                                           0518 01376000
*   ENTRY;                          /*                       @Z67SP00*/ 01377000
KEY110   STM   @14,@12,@SA00005                                    0518 01378000
*   IF PARMEQSW=ON                  /* PARM= FOUND?          @SA75303*/ 01379000
*     THEN                          /* YES                   @SA75303*/ 01380000
         TM    PARMEQSW,B'10000000'                                0519 01381000
         BNO   @RF00519                                            0519 01382000
*     IOPPAGA=ON;                   /* TURN ON LMOD ALIGN2 BIT     0520 01383000
*                                                            @XA05949*/ 01384000
         L     @01,IOPPTR                                          0520 01385000
         OI    IOPPAGA(@01),B'01000000'                            0520 01386000
*   GO TO SCANBMP;                  /* EXIT                  @XA05949*/ 01387000
*                                                                  0521 01388000
         B     SCANBMP                                             0521 01389000
*   /*****************************************************************/ 01390000
*   /*                                                               */ 01391000
*   /* COND= PARAMETER FOUND                                 @SA75303*/ 01392000
*   /*                                                               */ 01393000
*   /*****************************************************************/ 01394000
*                                                                  0522 01395000
*KEY120:                            /*                       @SA75303*/ 01396000
*   ENTRY;                          /*                       @Z67SP00*/ 01397000
KEY120   STM   @14,@12,@SA00005                                    0522 01398000
*   PARMEQSW=OFF;                   /* LINK-EDIT ATTRIBUTES ARE NOW     01399000
*                                      INVALID               @SA75303*/ 01400000
         NI    PARMEQSW,B'01111111'                                0523 01401000
*   GO TO SCANBMP;                  /* EXIT                  @SA75303*/ 01402000
*                                                                  0524 01403000
         B     SCANBMP                                             0524 01404000
*   /*****************************************************************/ 01405000
*   /*                                                               */ 01406000
*   /* PARM= PARAMETER FOUND                                 @SA75303*/ 01407000
*   /*                                                               */ 01408000
*   /*****************************************************************/ 01409000
*                                                                  0525 01410000
*KEY130:                            /*                       @SA75303*/ 01411000
*   ENTRY;                          /*                       @Z67SP00*/ 01412000
KEY130   STM   @14,@12,@SA00005                                    0525 01413000
*   IF SCPSTRNG(5)='='              /* IF PARM=              @ZA17731*/ 01414000
*     THEN                          /* THEN                  @ZA17731*/ 01415000
         L     @01,SCPPTR                                          0526 01416000
         L     @01,SCPCHAR(,@01)                                   0526 01417000
         CLI   SCPSTRNG+4(@01),C'='                                0526 01418000
         BNE   @RF00526                                            0526 01419000
*     PARMEQSW=ON;                  /* LINK-EDIT ATTRIBUTES ARE NOW     01420000
*                                      VALID                 @ZA17731*/ 01421000
         OI    PARMEQSW,B'10000000'                                0527 01422000
*   GO TO SCANBMP;                  /* EXIT                  @SA75303*/ 01423000
*                                                                  0528 01424000
         B     SCANBMP                                             0528 01425000
*   /*****************************************************************/ 01426000
*   /*                                                               */ 01427000
*   /* COMMON RETURN POINTS FOR ALL JCL SCAN ROUTS           @Z67SP00*/ 01428000
*   /*                                                               */ 01429000
*   /*****************************************************************/ 01430000
*                                                                  0529 01431000
*SCANBMP:                           /* BUMP THE SCAN PTR AFTER HIT   */ 01432000
*   SCPCHAR=SCPCHAR+KEYLEN(TEMPPTR1);/* INCR PAST KEY                */ 01433000
SCANBMP  L     @15,SCPPTR                                          0529 01434000
         L     @14,TEMPPTR1                                        0529 01435000
         MH    @14,@CH00466                                        0529 01436000
         SLR   @09,@09                                             0529 01437000
         IC    @09,KEYLEN-13(@14)                                  0529 01438000
         AL    @09,SCPCHAR(,@15)                                   0529 01439000
         ST    @09,SCPCHAR(,@15)                                   0529 01440000
*JCLRTN0:                           /*                       @Z67SP00*/ 01441000
*   JRTRC=ZERO;                     /*                       @Z67SP00*/ 01442000
JCLRTN0  MVI   JRTRC,X'00'                                         0530 01443000
*JCLRTN:                            /*                       @Z67SP00*/ 01444000
*   RETURN CODE(JRTRC);             /*                       @Z67SP00*/ 01445000
JCLRTN   SLR   @15,@15                                             0531 01446000
         IC    @15,JRTRC                                           0531 01447000
         L     @14,@SA00005                                        0531 01448000
         LM    @00,@12,@SA00005+8                                  0531 01449000
         BR    @14                                                 0531 01450000
*   END JCLROUTS;                   /* END JCL SCAN ROUTS    @Z67SP00*/ 01451000
         EJECT                                                          01452000
*                                                                  0533 01453000
*   /*****************************************************************/ 01454000
*   /*                                                               */ 01455000
*   /* PROCESS DLIB NAME FROM INCLUDE STATEMENT              @Z67SP00*/ 01456000
*   /*                                                               */ 01457000
*   /*****************************************************************/ 01458000
*                                                                  0533 01459000
*RDLIBV:                                                           0533 01460000
*   PROCEDURE;                                                     0533 01461000
RDLIBV   STM   @14,@12,@SA00006                                    0533 01462000
*   DLIBN=SCPSTRNG(1:SCPPMLN);      /* SAVE DIST LIB         @Z40SP00*/ 01463000
         MVI   DLIBN+1,C' '                                        0534 01464000
         MVC   DLIBN+2(6),DLIBN+1                                  0534 01465000
         L     @15,SCPPTR                                          0534 01466000
         LH    @14,SCPPMLN(,@15)                                   0534 01467000
         BCTR  @14,0                                               0534 01468000
         L     @01,SCPCHAR(,@15)                                   0534 01469000
         EX    @14,@SM01740                                        0534 01470000
*   IF DLIBN=PARMLIB                /* IS THIS PARMLIB?              */ 01471000
*     THEN                          /* YES - MUST WRITE INCLUDE STMT */ 01472000
         CLC   DLIBN(8),@CC01422                                   0535 01473000
         BNE   @RF00535                                            0535 01474000
*     DO;                           /* TO CDS                        */ 01475000
*       INCLPARM=ON;                /* INDICATE PARMLIB INCLUDE FOUND   01476000
*                                                            @XA07462*/ 01477000
         OI    INCLPARM,B'00000100'                                0537 01478000
*       CCORDER=CCOTHR;             /* CONTROL CARD          @Z67SP00*/ 01479000
         MVI   CCORDER,X'01'                                       0538 01480000
*       CALL RLKDSVCC;              /* WRITE STMT TO CDS             */ 01481000
         BAL   @14,RLKDSVCC                                        0539 01482000
*       RFY                         /*                       @Z67SP00*/ 01483000
*         RTNCODE RSTD;             /*                       @Z67SP00*/ 01484000
*       SCPRETRN=RTNCODE;           /*                       @Z67SP00*/ 01485000
         L     @14,SCPPTR                                          0541 01486000
         STC   RTNCODE,SCPRETRN(,@14)                              0541 01487000
*       RFY                         /*                       @Z67SP00*/ 01488000
*         RTNCODE UNRSTD;           /*                       @Z67SP00*/ 01489000
*     END;                                                         0543 01490000
*   ELSE                            /*                       @Z67SP00*/ 01491000
*     IF DLIBN=SYSLMOD              /* IS THIS SYSLMOD?              */ 01492000
*       THEN                        /* YES, MUST IGNORE IT           */ 01493000
         B     @RC00535                                            0544 01494000
@RF00535 CLC   DLIBN(8),@CC01424                                   0544 01495000
         BNE   @RF00544                                            0544 01496000
*       DO;                         /*                       @XA07462*/ 01497000
*         INCLSYSL=ON;              /* INDICATE SYSLMOD INCLUDE FOUND   01498000
*                                                            @XA07462*/ 01499000
         OI    INCLSYSL,B'00000010'                                0546 01500000
*         SCPRET=SCPNDSCN;          /* STOP SCN              @YA07506*/ 01501000
         L     @01,SCPPTR                                          0547 01502000
         MVI   SCPRET(@01),X'04'                                   0547 01503000
*       END;                        /*                       @XA07462*/ 01504000
*     ELSE                          /* OTHERWISE CONTINUE            */ 01505000
*       INCLFND=ON;                 /* IND. ANY INCLUDE FOUND      0549 01506000
*                                                            @XA07462*/ 01507000
         B     @RC00544                                            0549 01508000
@RF00544 OI    INCLFND,B'00000001'                                 0549 01509000
*   END RDLIBV;                     /* RETURN TO SCAN                */ 01510000
@EL00006 DS    0H                                                  0550 01511000
@EF00006 DS    0H                                                  0550 01512000
@ER00006 LM    @14,@12,@SA00006                                    0550 01513000
         BR    @14                                                 0550 01514000
         EJECT                                                          01515000
*                                                                  0551 01516000
*   /*****************************************************************/ 01517000
*   /*                                                               */ 01518000
*   /* PROCESS MODULE NAMES FROM INCLUDE STATEMENT           @Z67SP00*/ 01519000
*   /*                                                               */ 01520000
*   /*****************************************************************/ 01521000
*                                                                  0551 01522000
*RCSECTV:                                                          0551 01523000
*   PROCEDURE;                      /*                       @Z67SP00*/ 01524000
RCSECTV  STM   @14,@12,@SA00007                                    0551 01525000
*   DECLARE                         /*                       @Z67SP00*/ 01526000
*     SAVSEQNO FIXED(31);           /*                       @Z67SP00*/ 01527000
*   RFY                                                            0553 01528000
*     HMASMGTP BASED(GTPPTR);       /*                       @Z67SP00*/ 01529000
*   CSECTN=SCPSTRNG(1:SCPPMLN);     /* SAVE MODULE NAME      @Z67SP00*/ 01530000
         MVI   CSECTN+1,C' '                                       0554 01531000
         MVC   CSECTN+2(6),CSECTN+1                                0554 01532000
         L     @15,SCPPTR                                          0554 01533000
         LH    @14,SCPPMLN(,@15)                                   0554 01534000
         BCTR  @14,0                                               0554 01535000
         L     @01,SCPCHAR(,@15)                                   0554 01536000
         EX    @14,@SM01742                                        0554 01537000
*   DLIBN=DLIBN;                    /* SAVE DLIB NAME        @Z67SP00*/ 01538000
         MVC   @TS00001(8),DLIBN                                   0555 01539000
         MVC   DLIBN(8),@TS00001                                   0555 01540000
*   GTPPTR=ADDR(MDDLBGTP);          /* BASE FOR GTP          @Z67SP00*/ 01541000
         LA    @15,MDDLBGTP                                        0556 01542000
         ST    @15,GTPPTR                                          0556 01543000
*   GTPFUNCT=GTPADD;                /*                       @Z67SP00*/ 01544000
         MVI   GTPFUNCT(@15),X'04'                                 0557 01545000
*   CALL HMASMGTA(HMASMGTP);        /* SAVE MOD/DLIB PAIR    @Z67SP00*/ 01546000
         ST    @15,@AL00001                                        0558 01547000
         L     @15,@CV01384                                        0558 01548000
         LA    @01,@AL00001                                        0558 01549000
         BALR  @14,@15                                             0558 01550000
*   IF GTPRETRN=GTPGOOD             /*                       @Z67SP00*/ 01551000
*     THEN                          /*                       @Z67SP00*/ 01552000
         L     @01,GTPPTR                                          0559 01553000
         CLI   GTPRETRN(@01),0                                     0559 01554000
         BNE   @RF00559                                            0559 01555000
*     DO;                           /*                       @Z67SP00*/ 01556000
*       IF CHREPFND=ON              /* IF CH/REP STMT FOUND  @Z67SP00*/ 01557000
*         THEN                      /* BEFORE THIS INCLUDE   @Z67SP00*/ 01558000
         TM    CHREPFND,B'00100000'                                0561 01559000
         BNO   @RF00561                                            0561 01560000
*         DO;                       /*                       @Z67SP00*/ 01561000
*           CHREPFND=OFF;           /* RESET SW              @Z67SP00*/ 01562000
         NI    CHREPFND,B'11011111'                                0563 01563000
*           GTPPTR=ADDR(CCGTP);     /* CONTROL CARD GTP      @Z67SP00*/ 01564000
         LA    @15,CCGTP                                           0564 01565000
         ST    @15,GTPPTR                                          0564 01566000
*           GTPFUNCT=GTPLOC;        /*                       @Z67SP00*/ 01567000
         MVI   GTPFUNCT(@15),X'03'                                 0565 01568000
*           SAVSEQNO=CCSEQNO;       /* SAVE CURRENT SEQ NUM  @Z67SP00*/ 01569000
         MVC   SAVSEQNO(4),CCSEQNO                                 0566 01570000
*           CCSEQNO=CHRSEQNO;       /* FIND MOD CONTROL RCD  @Z67SP00*/ 01571000
         MVC   CCSEQNO(4),CHRSEQNO                                 0567 01572000
*           CCORDER=CCCHRP;         /* CHREP TYPE CARD       @Z67SP00*/ 01573000
         MVI   CCORDER,X'02'                                       0568 01574000
*           CALL HMASMGTA(HMASMGTP);/* FOR THE SET OF CH/REP @Z67SP00*/ 01575000
         ST    @15,@AL00001                                        0569 01576000
         L     @15,@CV01384                                        0569 01577000
         LA    @01,@AL00001                                        0569 01578000
         BALR  @14,@15                                             0569 01579000
*           IF GTPRETRN=GTPGOOD     /* STATEMENTS. IF FOUND  @Z67SP00*/ 01580000
*             THEN                  /*                       @Z67SP00*/ 01581000
         L     @15,GTPPTR                                          0570 01582000
         CLI   GTPRETRN(@15),0                                     0570 01583000
         BNE   @RF00570                                            0570 01584000
*             DO;                   /*                       @Z67SP00*/ 01585000
*               CCMOD=CSECTN;       /* PUT MOD NAME IN RCD   @Z67SP00*/ 01586000
         MVC   CCMOD(8),CSECTN                                     0572 01587000
*               CCDLIB=DLIBN;       /* PUT IN MODS DLIB      @Z67SP00*/ 01588000
         MVC   CCDLIB(8),DLIBN                                     0573 01589000
*               GTPFUNCT=GTPADD;    /* UPDATE GTA FILE       @Z67SP00*/ 01590000
         MVI   GTPFUNCT(@15),X'04'                                 0574 01591000
*               CALL HMASMGTA(HMASMGTP);/*                   @Z67SP00*/ 01592000
         ST    @15,@AL00001                                        0575 01593000
         L     @15,@CV01384                                        0575 01594000
         LA    @01,@AL00001                                        0575 01595000
         BALR  @14,@15                                             0575 01596000
*             END;                  /*                       @Z67SP00*/ 01597000
*           SCPRETRN=GTPRETRN;      /* SAVE RC               @Z67SP00*/ 01598000
@RF00570 L     @01,GTPPTR                                          0577 01599000
         IC    @00,GTPRETRN(,@01)                                  0577 01600000
         L     @01,SCPPTR                                          0577 01601000
         STC   @00,SCPRETRN(,@01)                                  0577 01602000
*           CCSEQNO=SAVSEQNO;       /* RESTORE SEQ NO        @Z67SP00*/ 01603000
         MVC   CCSEQNO(4),SAVSEQNO                                 0578 01604000
*         END;                      /* END CH/REP FOUND      @Z67SP00*/ 01605000
*     END;                          /*                       @Z67SP00*/ 01606000
*   ELSE                            /* UNABLE TO STORE MOD   @Z67SP00*/ 01607000
*     SCPRETRN=SCPSTOP;             /*                       @Z67SP00*/ 01608000
         B     @RC00559                                            0581 01609000
@RF00559 L     @01,SCPPTR                                          0581 01610000
         MVI   SCPRETRN(@01),X'08'                                 0581 01611000
*   END RCSECTV;                    /* RETURN                        */ 01612000
@EL00007 DS    0H                                                  0582 01613000
@EF00007 DS    0H                                                  0582 01614000
@ER00007 LM    @14,@12,@SA00007                                    0582 01615000
         BR    @14                                                 0582 01616000
         EJECT                                                          01617000
*                                                                  0583 01618000
*   /*****************************************************************/ 01619000
*   /*                                                               */ 01620000
*   /* ROUTINE CALLED WHEN CHANGE/REP STATEMENT FOUND. AT FIRST      */ 01621000
*   /* CH/REP FOUND WRITE AN ADDITIONAL RCD TO GTA FILE TO BE USED TO*/ 01622000
*   /* FILL IN THE MODULE NAME WHEN THE NEXT INCLUDE CARD IS FOUND.  */ 01623000
*   /* THEN WRITE CH/REP CARD TO GTA FILE.                           */ 01624000
*   /*                                                               */ 01625000
*   /*****************************************************************/ 01626000
*                                                                  0583 01627000
*RCHANGE:                                                          0583 01628000
*RREPLACE:                                                         0583 01629000
*   PROCEDURE;                      /*                       @Z67SP00*/ 01630000
RCHANGE  DS    0H                                                  0583 01631000
RREPLACE STM   @14,@12,@SA00008                                    0583 01632000
*   CHREPFLG=ON;                    /* INDICATE CHANGE/REPLACE CARDS */ 01633000
         OI    CHREPFLG,B'01000000'                                0584 01634000
*   IOPBUFAD=ADDR(CRPBUFFR);        /* SET PTR FOR RLKDSVCC  @Z67SP00*/ 01635000
*                                                                  0585 01636000
         L     @15,@PC00001+4                                      0585 01637000
         LA    @14,CRPBUFFR(,@15)                                  0585 01638000
         L     @01,IOPPTR                                          0585 01639000
         ST    @14,IOPBUFAD(,@01)                                  0585 01640000
*   /*****************************************************************/ 01641000
*   /*                                                               */ 01642000
*   /* IF FIRST CH/REP THEN WRITE ADDITIONAL RCD             @Z67SP00*/ 01643000
*   /*                                                               */ 01644000
*   /*****************************************************************/ 01645000
*                                                                  0586 01646000
*   IF CHREPFND=OFF                 /* IF FIRST TIME         @Z67SP00*/ 01647000
*     THEN                          /*                       @Z67SP00*/ 01648000
         TM    CHREPFND,B'00100000'                                0586 01649000
         BNZ   @RF00586                                            0586 01650000
*     DO;                           /*                       @Z67SP00*/ 01651000
*       SAVRCD1=CRPBUFFR;           /* SAVE BUFFR ACROSS CAL @Z67SP00*/ 01652000
         MVC   SAVRCD1(80),CRPBUFFR(@15)                           0588 01653000
*       IOPLMCTL=BLANK;             /* INIT BUFFER TO SAVE   @Z67SP00*/ 01654000
         MVI   IOPLMCTL+1(@14),C' '                                0589 01655000
         MVC   IOPLMCTL+2(78,@14),IOPLMCTL+1(@14)                  0589 01656000
         MVI   IOPLMCTL(@14),C' '                                  0589 01657000
*       IOPLMCC=IOPLMCRM;           /* CONTROL FOR CH/REP    @Z67SP00*/ 01658000
         MVI   IOPLMCC(@14),C'*'                                   0590 01659000
*       CHREPFND=ON;                /*                       @Z67SP00*/ 01660000
         OI    CHREPFND,B'00100000'                                0591 01661000
*       CCORDER=CCCHRP;             /* CHANGE/REP CRAD       @Z67SP00*/ 01662000
         MVI   CCORDER,X'02'                                       0592 01663000
*       CALL RLKDSVCC;              /* SAVE IT               @Z67SP00*/ 01664000
         BAL   @14,RLKDSVCC                                        0593 01665000
*       RFY                                                        0594 01666000
*         RTNCODE RSTD;             /*                       @Z67SP00*/ 01667000
*       SCPRETRN=RTNCODE;           /*                       @Z67SP00*/ 01668000
         L     @14,SCPPTR                                          0595 01669000
         STC   RTNCODE,SCPRETRN(,@14)                              0595 01670000
*       RFY                                                        0596 01671000
*         RTNCODE UNRSTD;           /*                       @Z67SP00*/ 01672000
*       CHRSEQNO=CCSEQNO;           /* SAVE CARD NUMBER      @Z67SP00*/ 01673000
         MVC   CHRSEQNO(4),CCSEQNO                                 0597 01674000
*       CRPBUFFR=SAVRCD1;           /* RESTORE OLD RECORD    @Z67SP00*/ 01675000
         L     @15,@PC00001+4                                      0598 01676000
         MVC   CRPBUFFR(80,@15),SAVRCD1                            0598 01677000
*     END;                          /*                       @Z67SP00*/ 01678000
*                                                                  0599 01679000
*   /*****************************************************************/ 01680000
*   /*                                                               */ 01681000
*   /* IF PREV FUNCTIONS OK THEN SAVE CH/REP                 @Z67SP00*/ 01682000
*   /*                                                               */ 01683000
*   /*****************************************************************/ 01684000
*                                                                  0600 01685000
*   IF SCPRETRN=SCPGOOD             /*                       @Z67SP00*/ 01686000
*     THEN                          /*                       @Z67SP00*/ 01687000
@RF00586 L     @01,SCPPTR                                          0600 01688000
         CLI   SCPRETRN(@01),0                                     0600 01689000
         BNE   @RF00600                                            0600 01690000
*     DO;                           /*                       @Z67SP00*/ 01691000
*WRITECC:                           /*                       @Z67SP00*/ 01692000
*       IOPLMCC=IOPLMCRC;           /* CH/REP CARD           @Z67SP00*/ 01693000
WRITECC  L     @01,IOPPTR                                          0602 01694000
         L     @01,IOPBUFAD(,@01)                                  0602 01695000
         MVI   IOPLMCC(@01),C'@'                                   0602 01696000
*       CCORDER=CCCHRP;             /* CHANGE/REP CRAD       @Z67SP00*/ 01697000
         MVI   CCORDER,X'02'                                       0603 01698000
*       CALL RLKDSVCC;              /*                       @Z67SP00*/ 01699000
         BAL   @14,RLKDSVCC                                        0604 01700000
*       RFY                                                        0605 01701000
*         RTNCODE RSTD;             /*                       @Z67SP00*/ 01702000
*       SCPRETRN=RTNCODE;           /*                       @Z67SP00*/ 01703000
         L     @14,SCPPTR                                          0606 01704000
         STC   RTNCODE,SCPRETRN(,@14)                              0606 01705000
*       RFY                                                        0607 01706000
*         RTNCODE UNRSTD;           /*                       @Z67SP00*/ 01707000
*       IF SCPRETRN=SCPGOOD         /*                       @Z67SP00*/ 01708000
*           &CRPBFCNT^=BLANK        /* IF CH/REP CONTINUED   @Z67SP00*/ 01709000
*         THEN                      /*                       @Z67SP00*/ 01710000
         CLI   SCPRETRN(@14),0                                     0608 01711000
         BNE   @RF00608                                            0608 01712000
         L     @15,@PC00001+4                                      0608 01713000
         CLI   CRPBFCNT(@15),C' '                                  0608 01714000
         BE    @RF00608                                            0608 01715000
*         DO;                       /*                       @Z67SP00*/ 01716000
*           CALL HMASMCRD(HMASMCRP);/* READ CONTINUATION     @Z67SP00*/ 01717000
         ST    @15,@AL00001                                        0610 01718000
         L     @15,@CV01383                                        0610 01719000
         LA    @01,@AL00001                                        0610 01720000
         BALR  @14,@15                                             0610 01721000
*           IF CRPRETRN=CRPGOOD     /* IF READ OK            @Z67SP00*/ 01722000
*             THEN                  /* THEN                  @Z67SP00*/ 01723000
         L     @15,@PC00001+4                                      0611 01724000
         CLI   CRPRETRN(@15),0                                     0611 01725000
         BE    @RT00611                                            0611 01726000
*             GO TO WRITECC;        /* WRITE IT              @Z67SP00*/ 01727000
*           INTERR=ON;              /* SET ERR FOUND         @Z67SP00*/ 01728000
         OI    INTERR,B'10000000'                                  0613 01729000
*           IF CRPRETRN=CRPEOF      /* IF END OF FILE        @Z67SP00*/ 01730000
*             THEN                  /*                       @Z67SP00*/ 01731000
         CLI   CRPRETRN(@15),4                                     0614 01732000
         BNE   @RF00614                                            0614 01733000
*             SCPRETRN=SCPSTOP;     /* STOP SCAN             @Z67SP00*/ 01734000
         L     @01,SCPPTR                                          0615 01735000
         MVI   SCPRETRN(@01),X'08'                                 0615 01736000
*           ELSE                    /*                       @Z67SP00*/ 01737000
*             SCPRETRN=CRPRETRN;    /* SAVE RC               @Z67SP00*/ 01738000
         B     @RC00614                                            0616 01739000
@RF00614 L     @15,@PC00001+4                                      0616 01740000
         IC    @14,CRPRETRN(,@15)                                  0616 01741000
         L     @15,SCPPTR                                          0616 01742000
         STC   @14,SCPRETRN(,@15)                                  0616 01743000
*         END;                      /*                       @Z67SP00*/ 01744000
@RC00614 DS    0H                                                  0618 01745000
*     END;                          /*                       @Z67SP00*/ 01746000
@RF00608 DS    0H                                                  0619 01747000
*   IF SCPRETRN^=SCPGOOD            /* IF NO ERR IN PROCESS  @Z67SP00*/ 01748000
*     THEN                          /* THEN RESET TO         @Z67SP00*/ 01749000
@RF00600 L     @15,SCPPTR                                          0619 01750000
         CLI   SCPRETRN(@15),0                                     0619 01751000
         BE    @RF00619                                            0619 01752000
*     SCPRETRN=SCPNDSCN;            /* STOP SCAN             @Z67SP00*/ 01753000
         MVI   SCPRETRN(@15),X'04'                                 0620 01754000
*   IOPBUFAD=SAVBUFAD;              /* RESET BUFFER          @Z67SP00*/ 01755000
@RF00619 L     @15,SAVBUFAD                                        0621 01756000
         L     @14,IOPPTR                                          0621 01757000
         ST    @15,IOPBUFAD(,@14)                                  0621 01758000
*   END RCHANGE;                    /* RETURN TO SCAN                */ 01759000
@EL00008 DS    0H                                                  0622 01760000
@EF00008 DS    0H                                                  0622 01761000
@ER00008 LM    @14,@12,@SA00008                                    0622 01762000
         BR    @14                                                 0622 01763000
         EJECT                                                          01764000
*                                                                  0623 01765000
*   /*****************************************************************/ 01766000
*   /*                                                               */ 01767000
*   /* ROUTINE CALLED TO SAVE LINK EDIT CONTROL CARDS IN GTA FILE.   */ 01768000
*   /* CARDS ARE SAVED IN ORDER OF PROCESSING BY ASSIGNING EACH CARD */ 01769000
*   /* A SEQUENCE NUMBER WHICH THEN BECOMES THE KEY INTO THE GTA     */ 01770000
*   /* FILE.                                                         */ 01771000
*   /*                                                               */ 01772000
*   /*****************************************************************/ 01773000
*                                                                  0623 01774000
*RLKDSVCC:                                                         0623 01775000
*   PROCEDURE;                      /*                       @Z67SP00*/ 01776000
RLKDSVCC STM   @14,@12,@SA00009                                    0623 01777000
*   RFY                                                            0624 01778000
*     HMASMGTP BASED(GTPPTR);       /*                       @Z67SP00*/ 01779000
*   CCSEQNO=CCSEQNO+1;              /*                       @Z67SP00*/ 01780000
         LA    @15,1                                               0625 01781000
         ICM   @14,15,CCSEQNO                                      0625 01782000
         ALR   @15,@14                                             0625 01783000
         STCM  @15,15,CCSEQNO                                      0625 01784000
*   CCDATA=CRPBUFFR;                /* MOVE INPUT BUFFER     @Z67SP00*/ 01785000
         L     @15,@PC00001+4                                      0626 01786000
         MVC   CCDATA(80),CRPBUFFR(@15)                            0626 01787000
*   GTPPTR=ADDR(CCGTP);             /* CONTROL CARD GTP      @Z67SP00*/ 01788000
         LA    @15,CCGTP                                           0627 01789000
         ST    @15,GTPPTR                                          0627 01790000
*   GTPFUNCT=GTPADD;                /*                       @Z67SP00*/ 01791000
         MVI   GTPFUNCT(@15),X'04'                                 0628 01792000
*   CALL HMASMGTA(HMASMGTP);        /*                       @Z67SP00*/ 01793000
         ST    @15,@AL00001                                        0629 01794000
         L     @15,@CV01384                                        0629 01795000
         LA    @01,@AL00001                                        0629 01796000
         BALR  @14,@15                                             0629 01797000
*   IF GTPRETRN^=GTPGOOD            /*                       @Z67SP00*/ 01798000
*     THEN                          /*                       @Z67SP00*/ 01799000
         L     @01,GTPPTR                                          0630 01800000
         CLI   GTPRETRN(@01),0                                     0630 01801000
         BE    @RF00630                                            0630 01802000
*     CALL LKDERR(CRPBUFFR,LASTLINE);/* WRITE ERR            @Z67SP00*/ 01803000
         L     @15,@PC00001+4                                      0631 01804000
         LA    @15,CRPBUFFR(,@15)                                  0631 01805000
         ST    @15,@AL00001                                        0631 01806000
         LA    @15,LASTLINE                                        0631 01807000
         ST    @15,@AL00001+4                                      0631 01808000
         LA    @01,@AL00001                                        0631 01809000
         BAL   @14,LKDERR                                          0631 01810000
*   CCENTRD=ON;                     /* CONTROL CARD ENTERED  @Z67SP00*/ 01811000
@RF00630 OI    CCENTRD,B'00001000'                                 0632 01812000
*   RETURN CODE(GTPRETRN);          /* RETURN WITH GTA RC    @Z67SP00*/ 01813000
         L     @01,GTPPTR                                          0633 01814000
         SLR   @15,@15                                             0633 01815000
         IC    @15,GTPRETRN(,@01)                                  0633 01816000
         L     @14,@SA00009                                        0633 01817000
         LM    @00,@12,@SA00009+8                                  0633 01818000
         BR    @14                                                 0633 01819000
*   END RLKDSVCC;                   /* RETURN TO SCAN                */ 01820000
         EJECT                                                          01821000
*                                                                  0635 01822000
*   /*****************************************************************/ 01823000
*   /*                                                               */ 01824000
*   /* ROUTINE CALLED WHEN NAME CARD ENCOUNTERED OR AFTER ALL LKED   */ 01825000
*   /* CONTROL CARDS READ AND LMOD NAME FOUND IN JCL. THIS ROUTINE   */ 01826000
*   /* TAKES ALL THE CONTROL CARDS SAVED IN THE GTA FILE AND WRITES  */ 01827000
*   /* THEM OUT TO THE CDS. IF REQUIRED THE CHANGE/REPLACE CARD      */ 01828000
*   /* ENTERED THIS TIME ARE MERGED WITH THE ONES IN THE CDS @Z67SP00*/ 01829000
*   /*                                                               */ 01830000
*   /*****************************************************************/ 01831000
*                                                                  0635 01832000
*RNAMEV:                            /*                       @Z67SP00*/ 01833000
*   PROCEDURE;                      /*                       @Z67SP00*/ 01834000
*                                                                  0635 01835000
RNAMEV   STM   @14,@12,@SA00010                                    0635 01836000
*   /*****************************************************************/ 01837000
*   /*                                                               */ 01838000
*   /* LOCATE LMOD ON CDS AND IF FOUND MERGE ANY CHANGE/REPLACE CARDS*/ 01839000
*   /* FOR AND MODULES NOT INCLUDED THIS TIME WITH THOSE IN THE CDS  */ 01840000
*   /*                                                               */ 01841000
*   /*****************************************************************/ 01842000
*                                                                  0636 01843000
*   SCPRETRN=SCPGOOD;               /* INIT RC IN CASE NOT CALLED  0636 01844000
*                                      FROM SCAN             @Z67SP00*/ 01845000
         L     @15,SCPPTR                                          0636 01846000
         MVI   SCPRETRN(@15),X'00'                                 0636 01847000
*   LMODNAM=SCPSTRNG(1:SCPPMLN);    /* SAVE LMOD NAME        @Z67SP00*/ 01848000
         MVI   LMODNAM+1,C' '                                      0637 01849000
         MVC   LMODNAM+2(6),LMODNAM+1                              0637 01850000
         LH    @14,SCPPMLN(,@15)                                   0637 01851000
         BCTR  @14,0                                               0637 01852000
         L     @01,SCPCHAR(,@15)                                   0637 01853000
         EX    @14,@SM01745                                        0637 01854000
*   IF LMODNAM(1:7)=IEANUC0         /* ONLY SUPPOTR 1 NUC    @Z67SP00*/ 01855000
*     THEN                          /*                       @Z67SP00*/ 01856000
         CLC   LMODNAM(7),@CC01418                                 0638 01857000
         BNE   @RF00638                                            0638 01858000
*     LMODNAM(8)=CHAR1;             /*                       @Z67SP00*/ 01859000
         MVI   LMODNAM+7,C'1'                                      0639 01860000
*   IOPTYPE=IOPLMD;                 /*                       @Z67SP00*/ 01861000
@RF00638 L     @15,IOPPTR                                          0640 01862000
         MVI   IOPTYPE(@15),X'02'                                  0640 01863000
*   IOPNAME=LMODNAM;                /*                       @Z67SP00*/ 01864000
         MVC   IOPNAME(8,@15),LMODNAM                              0641 01865000
*   IOPDSID=IOPCDS;                 /*                       @Z67SP00*/ 01866000
         MVI   IOPDSID(@15),X'02'                                  0642 01867000
*   IOPFUNCT=IOPLOC;                /*                       @Z67SP00*/ 01868000
         MVI   IOPFUNCT(@15),X'03'                                 0643 01869000
*   LMDFND=OFF;                     /* SET LMOD NOT FOUND SW @Z67SP00*/ 01870000
         NI    LMDFND,B'11111101'                                  0644 01871000
*   CALL HMASMIO(HMASMIOP);         /* LOCATE LMOD ON CDS    @Z67SP00*/ 01872000
         ST    @15,@AL00001                                        0645 01873000
         L     @15,@CV01382                                        0645 01874000
         LA    @01,@AL00001                                        0645 01875000
         BALR  @14,@15                                             0645 01876000
*   IF IOPRETRN=IOPGOOD             /* IF FOUND              @Z67SP00*/ 01877000
*     THEN                          /* PROCESS CHANGE REP    @Z67SP00*/ 01878000
         L     @15,IOPPTR                                          0646 01879000
         CLI   IOPRETRN(@15),0                                     0646 01880000
         BNE   @RF00646                                            0646 01881000
*     DO;                           /*                       @Z67SP00*/ 01882000
*       LMDFND=ON;                  /*                       @Z67SP00*/ 01883000
         OI    LMDFND,B'00000010'                                  0648 01884000
*       IF IOPCHREP=ON              /* AND LMOD HAD CH/REPS  @Z67SP00*/ 01885000
*         THEN                      /*                       @Z67SP00*/ 01886000
         TM    IOPCHREP(@15),B'00100000'                           0649 01887000
         BNO   @RF00649                                            0649 01888000
*         DO;                       /*                       @Z67SP00*/ 01889000
*                                                                  0650 01890000
*           /*********************************************************/ 01891000
*           /*                                                       */ 01892000
*           /* READ ALL CONTROL CARDS AND SAVE CH/REP CARDS FOR MODS */ 01893000
*           /* NOT LINKED THIS TIME IN CC GTP                @Z67SP00*/ 01894000
*           /*                                                       */ 01895000
*           /*********************************************************/ 01896000
*                                                                  0651 01897000
*           GTPPTR=ADDR(CCGTP);     /*                       @Z67SP00*/ 01898000
         LA    @14,CCGTP                                           0651 01899000
         ST    @14,GTPPTR                                          0651 01900000
*           SAVRCD1=CRPBUFFR;       /* SAVE RCD IN BUFFER    @Z67SP00*/ 01901000
         L     @14,@PC00001+4                                      0652 01902000
         MVC   SAVRCD1(80),CRPBUFFR(@14)                           0652 01903000
*           IOPBUFAD=ADDR(CRPBUFFR);/* INPUT BUFFER ADDR     @Z67SP00*/ 01904000
         LA    @14,CRPBUFFR(,@14)                                  0653 01905000
         ST    @14,IOPBUFAD(,@15)                                  0653 01906000
*           IOPFUNCT=IOPREAD;       /*                       @Z67SP00*/ 01907000
         MVI   IOPFUNCT(@15),X'01'                                 0654 01908000
*           CALL HMASMIO(HMASMIOP); /* PRIME BUFFER          @Z67SP00*/ 01909000
         ST    @15,@AL00001                                        0655 01910000
         L     @15,@CV01382                                        0655 01911000
         LA    @01,@AL00001                                        0655 01912000
         BALR  @14,@15                                             0655 01913000
*           DO WHILE(               /* LOOP                  @Z67SP00*/ 01914000
*                 IOPRETRN=IOPGOOD  /* TILL ERR OR EOF       @Z67SP00*/ 01915000
*                 &GTPRETRN=GTPGOOD);/* AND ABLE TO SAVE CC  @Z67SP00*/ 01916000
         B     @DE00656                                            0656 01917000
@DL00656 DS    0H                                                  0657 01918000
*             IF IOPLMCC=IOPLMCRM   /* IF MOD FOR CH/REPS    @Z67SP00*/ 01919000
*               THEN                /*                       @Z67SP00*/ 01920000
         L     @01,IOPPTR                                          0657 01921000
         L     @15,IOPBUFAD(,@01)                                  0657 01922000
         CLI   IOPLMCC(@15),C'*'                                   0657 01923000
         BNE   @RF00657                                            0657 01924000
*               DO;                 /*                       @Z67SP00*/ 01925000
*                 GTPPTR=ADDR(MDDLBGTP);/*                   @Z67SP00*/ 01926000
         LA    @14,MDDLBGTP                                        0659 01927000
         ST    @14,GTPPTR                                          0659 01928000
*                 GTPFUNCT=GTPLOC;  /*                       @Z67SP00*/ 01929000
         MVI   GTPFUNCT(@14),X'03'                                 0660 01930000
*                 CSECTN=IOPLMCRN;  /* SEE IF MOD WAS LINKED @Z67SP00*/ 01931000
         MVC   CSECTN(8),IOPLMCRN(@15)                             0661 01932000
*                 CALL HMASMGTA(HMASMGTP);/* LOC CSECT       @Z67SP00*/ 01933000
         ST    @14,@AL00001                                        0662 01934000
         L     @15,@CV01384                                        0662 01935000
         LA    @01,@AL00001                                        0662 01936000
         BALR  @14,@15                                             0662 01937000
*                 IF GTPRETRN=GTPNTFND/* IF NOT FOUND        @Z67SP00*/ 01938000
*                   THEN            /*                       @Z67SP00*/ 01939000
         L     @01,GTPPTR                                          0663 01940000
         CLI   GTPRETRN(@01),4                                     0663 01941000
         BNE   @RF00663                                            0663 01942000
*                   DO;             /*                       @Z67SP00*/ 01943000
*                     CCORDER=CCCHRP;/* CH/REP CARD          @Z67SP00*/ 01944000
         MVI   CCORDER,X'02'                                       0665 01945000
*                     CALL RLKDSVCC;/* SAVE CONTROL CARD     @Z67SP00*/ 01946000
         BAL   @14,RLKDSVCC                                        0666 01947000
*                     RFY                                          0667 01948000
*                       RTNCODE RSTD;/*                      @Z67SP00*/ 01949000
*                     IOPRETRN=RTNCODE;/* SAVE RC            @Z67SP00*/ 01950000
         L     @14,IOPPTR                                          0668 01951000
         STC   RTNCODE,IOPRETRN(,@14)                              0668 01952000
*                     RFY                                          0669 01953000
*                       RTNCODE UNRSTD;/*                    @Z67SP00*/ 01954000
*                     CALL HMASMIO(HMASMIOP);/* READ CH/REP  @Z67SP00*/ 01955000
         ST    @14,@AL00001                                        0670 01956000
         L     @15,@CV01382                                        0670 01957000
         LA    @01,@AL00001                                        0670 01958000
         BALR  @14,@15                                             0670 01959000
*                     DO WHILE(     /* PROCESS ALL CH/REPS   @Z67SP00*/ 01960000
*                           IOPLMCC=IOPLMCRC/*               @Z67SP00*/ 01961000
*                           &IOPRETRN=IOPGOOD);/*            @Z67SP00*/ 01962000
         B     @DE00671                                            0671 01963000
@DL00671 DS    0H                                                  0672 01964000
*                       CCORDER=CCCHRP;/* CH/REP CARD        @Z67SP00*/ 01965000
         MVI   CCORDER,X'02'                                       0672 01966000
*                       CALL RLKDSVCC;/* SAVE CC             @Z67SP00*/ 01967000
         BAL   @14,RLKDSVCC                                        0673 01968000
*                       RFY                                        0674 01969000
*                         RTNCODE RSTD;/*                    @Z67SP00*/ 01970000
*                       IOPRETRN=RTNCODE;/*                          */ 01971000
         L     @14,IOPPTR                                          0675 01972000
         STC   RTNCODE,IOPRETRN(,@14)                              0675 01973000
*                       IF RTNCODE=ZERO/* IF RCD SAVED OK    @Z67SP00*/ 01974000
*                         THEN      /*                               */ 01975000
         LTR   RTNCODE,RTNCODE                                     0676 01976000
         BNZ   @RF00676                                            0676 01977000
*                         CALL HMASMIO(HMASMIOP);/* READ     @Z67SP00*/ 01978000
         ST    @14,@AL00001                                        0677 01979000
         L     @15,@CV01382                                        0677 01980000
         LA    @01,@AL00001                                        0677 01981000
         BALR  @14,@15                                             0677 01982000
*                       RFY                                        0678 01983000
*                         RTNCODE UNRSTD;/*                  @Z67SP00*/ 01984000
@RF00676 DS    0H                                                  0679 01985000
*                     END;          /* END LOOP READ CH/REPS @Z67SP00*/ 01986000
@DE00671 L     @15,IOPPTR                                          0679 01987000
         L     @01,IOPBUFAD(,@15)                                  0679 01988000
         CLI   IOPLMCC(@01),C'@'                                   0679 01989000
         BNE   @DC00671                                            0679 01990000
         CLI   IOPRETRN(@15),0                                     0679 01991000
         BE    @DL00671                                            0679 01992000
@DC00671 DS    0H                                                  0680 01993000
*                   END;            /* END MOD NOT LINKED    @Z67SP00*/ 01994000
*                 ELSE              /* READ NEXT RCD IF      @Z67SP00*/ 01995000
*                   CALL HMASMIO(HMASMIOP);/* NO LINKED      @Z67SP00*/ 01996000
         B     @RC00663                                            0681 01997000
@RF00663 L     @01,IOPPTR                                          0681 01998000
         ST    @01,@AL00001                                        0681 01999000
         L     @15,@CV01382                                        0681 02000000
         LA    @01,@AL00001                                        0681 02001000
         BALR  @14,@15                                             0681 02002000
*                 GTPPTR=ADDR(CCGTP);/* GTP FOR CC           @Z67SP00*/ 02003000
@RC00663 LA    @15,CCGTP                                           0682 02004000
         ST    @15,GTPPTR                                          0682 02005000
*               END;                /* END CC IS MOD FOR CR  @Z67SP00*/ 02006000
*             ELSE                  /* IF NOT MOD FOR CH/REP @Z67SP00*/ 02007000
*               CALL HMASMIO(HMASMIOP);/* READ NEXT CARD     @Z67SP00*/ 02008000
         B     @RC00657                                            0684 02009000
@RF00657 L     @01,IOPPTR                                          0684 02010000
         ST    @01,@AL00001                                        0684 02011000
         L     @15,@CV01382                                        0684 02012000
         LA    @01,@AL00001                                        0684 02013000
         BALR  @14,@15                                             0684 02014000
*           END;                    /* END SAVE CH/REPS      @Z67SP00*/ 02015000
@RC00657 DS    0H                                                  0685 02016000
@DE00656 L     @01,IOPPTR                                          0685 02017000
         CLI   IOPRETRN(@01),0                                     0685 02018000
         BNE   @DC00656                                            0685 02019000
         L     @01,GTPPTR                                          0685 02020000
         CLI   GTPRETRN(@01),0                                     0685 02021000
         BE    @DL00656                                            0685 02022000
@DC00656 DS    0H                                                  0686 02023000
*           CRPBUFFR=SAVRCD1;       /* RESTORE BUFFER        @Z67SP00*/ 02024000
         L     @15,@PC00001+4                                      0686 02025000
         MVC   CRPBUFFR(80,@15),SAVRCD1                            0686 02026000
*         END;                      /* END LMOD HAD CH/REPS  @Z67SP00*/ 02027000
*     END;                          /* END LMOD FOUND ON CDS @Z67SP00*/ 02028000
*                                                                  0688 02029000
*   /*****************************************************************/ 02030000
*   /*                                                               */ 02031000
*   /* ERROR IN LMOD LOCATE ON CDS                           @Z67SP00*/ 02032000
*   /*                                                               */ 02033000
*   /*****************************************************************/ 02034000
*                                                                  0689 02035000
*   ELSE                            /* ELSE ERR              @Z67SP00*/ 02036000
*     IF IOPRETRN>IOPNTFND          /* IF ERR IN LOCATE      @Z67SP00*/ 02037000
*       THEN                        /*                       @Z67SP00*/ 02038000
         B     @RC00646                                            0689 02039000
@RF00646 L     @15,IOPPTR                                          0689 02040000
         CLI   IOPRETRN(@15),4                                     0689 02041000
         BNH   @RF00689                                            0689 02042000
*       SCPRETRN=IOPRETRN;          /* PASS ALONG RC         @Z67SP00*/ 02043000
         IC    @14,IOPRETRN(,@15)                                  0690 02044000
         L     @15,SCPPTR                                          0690 02045000
         STC   @14,SCPRETRN(,@15)                                  0690 02046000
*                                                                  0691 02047000
*   /*****************************************************************/ 02048000
*   /*                                                               */ 02049000
*   /* DETERMINE WHETHER LMOD CHANGE AND BACKUP ENTRY ON SCDS AND    */ 02050000
*   /* UPDATE LIBRARIES                                      @Z67SP00*/ 02051000
*   /*                                                               */ 02052000
*   /*****************************************************************/ 02053000
*                                                                  0691 02054000
*   IF IOPRETRN<=IOPNTFND           /* IF NO PREV ERRS       @Z67SP00*/ 02055000
*     THEN                          /*                       @Z67SP00*/ 02056000
@RF00689 DS    0H                                                  0691 02057000
@RC00646 L     @15,IOPPTR                                          0691 02058000
         CLI   IOPRETRN(@15),4                                     0691 02059000
         BH    @RF00691                                            0691 02060000
*     DO;                           /*                       @Z67SP00*/ 02061000
*       IF LMDFND=OFF               /* IF NEW LMOD ENTRY     @Z67SP00*/ 02062000
*         THEN                      /*                       @Z67SP00*/ 02063000
         TM    LMDFND,B'00000010'                                  0693 02064000
         BNZ   @RF00693                                            0693 02065000
*         DO;                       /*                       @Z67SP00*/ 02066000
*           STOWLMD=ON;             /*                       @Z67SP00*/ 02067000
         OI    STOWLMD,B'00000001'                                 0695 02068000
*           IOPLMDNT=''B;           /* INIT ENTRY            @Z67SP00*/ 02069000
         XC    IOPLMDNT(104,@15),IOPLMDNT(@15)                     0696 02070000
*           IOPNTLVL=IOPLMDLC;      /*                       @Z67SP00*/ 02071000
         MVI   IOPNTLVL(@15),X'02'                                 0697 02072000
*           BUPTYPE=BUPADD;         /*                       @Z67SP00*/ 02073000
         L     @14,@PC00001                                        0698 02074000
         MVI   BUPTYPE(@14),X'01'                                  0698 02075000
*           BUPIOPAD=ADDR(HMASMIOP);/*                       @Z67SP00*/ 02076000
         ST    @15,BUPIOPAD(,@14)                                  0699 02077000
*           CALL HMASMBUE(BUPPARM); /* BACKUP ENTRY          @Z67SP00*/ 02078000
         ST    @14,@AL00001                                        0700 02079000
         L     @15,@CV01385                                        0700 02080000
         LA    @01,@AL00001                                        0700 02081000
         BALR  @14,@15                                             0700 02082000
*           RFY                                                    0701 02083000
*             RTNCODE RSTD;         /*                       @Z67SP00*/ 02084000
*           IOPRETRN=RTNCODE;       /*                       @Z67SP00*/ 02085000
         L     @14,IOPPTR                                          0702 02086000
         STC   RTNCODE,IOPRETRN(,@14)                              0702 02087000
*           RFY                                                    0703 02088000
*             RTNCODE UNRSTD;       /*                       @Z67SP00*/ 02089000
*           J=1;                    /* INDEX FOR SYSLIB NAME @Z67SP00*/ 02090000
         MVC   J(4),@CF00048                                       0704 02091000
*           IOPLMDND(1)=IOPEOLST;   /*                       @Z67SP00*/ 02092000
         MVI   IOPLMDND(@14),X'FF'                                 0705 02093000
*         END;                      /*                       @Z67SP00*/ 02094000
*                                                                  0706 02095000
*       /*************************************************************/ 02096000
*       /*                                                           */ 02097000
*       /* IF LMOD WAS ALREADY THERE SEE IF IT IS BEING UPDATED      */ 02098000
*       /*                                                   @Z67SP00*/ 02099000
*       /*                                                           */ 02100000
*       /*************************************************************/ 02101000
*                                                                  0707 02102000
*       ELSE                        /*                       @Z67SP00*/ 02103000
*         DO;                       /*                       @Z67SP00*/ 02104000
         B     @RC00693                                            0707 02105000
@RF00693 DS    0H                                                  0708 02106000
*           I=0;                    /* COUNT OF SYSLIBS FND  @Z67SP00*/ 02107000
         SLR   @15,@15                                             0708 02108000
         ST    @15,I                                               0708 02109000
*           DO J=1 TO DIM(IOPLNTRY) WHILE(/* LOOP THRU IOP   @Z67SP00*/ 02110000
*                 IOPLMDND(J)^=IOPEOLST/* TILL END           @Z67SP00*/ 02111000
*                 &(IOPLSYS(J)^=SYSTLIB/* OR NOT SYSLIB      @Z67SP00*/ 02112000
*                 |IOPLMIND(J)^=IOPLMSYS));/*                @Z67SP00*/ 02113000
         LA    @15,1                                               0709 02114000
         ST    @15,J                                               0709 02115000
@DL00709 L     @14,IOPPTR                                          0709 02116000
         MH    @15,@CH00459                                        0709 02117000
         SLR   @09,@09                                             0709 02118000
         IC    @09,IOPLMDND-9(@15,@14)                             0709 02119000
         C     @09,@CF00648                                        0709 02120000
         BE    @DC00709                                            0709 02121000
         ST    @15,@TF00001                                        0709 02122000
         ALR   @15,@14                                             0709 02123000
         CLC   IOPLSYS-9(8,@15),SYSTLIB                            0709 02124000
         BNE   @DB00709                                            0709 02125000
         L     @15,@TF00001                                        0709 02126000
         SLR   @09,@09                                             0709 02127000
         IC    @09,IOPLMIND-9(@15,@14)                             0709 02128000
         C     @09,@CF00048                                        0709 02129000
         BE    @DC00709                                            0709 02130000
@DB00709 DS    0H                                                  0710 02131000
*             IF IOPLMIND(J)=IOPLMSYS/* IF SYSLIB TYPE       @Z67SP00*/ 02132000
*               THEN                /*                       @Z67SP00*/ 02133000
         LA    @15,1                                               0710 02134000
         L     @14,J                                               0710 02135000
         LR    @09,@14                                             0710 02136000
         MH    @09,@CH00459                                        0710 02137000
         L     @01,IOPPTR                                          0710 02138000
         SLR   @08,@08                                             0710 02139000
         IC    @08,IOPLMIND-9(@09,@01)                             0710 02140000
         CR    @15,@08                                             0710 02141000
         BNE   @RF00710                                            0710 02142000
*               DO;                 /*                       @Z67SP00*/ 02143000
*                 I=I+1;            /*                       @Z67SP00*/ 02144000
         AL    @15,I                                               0712 02145000
         ST    @15,I                                               0712 02146000
*                 IF I=2            /* IF SECOND SYSLIB      @Z67SP00*/ 02147000
*                   THEN            /* SAVE ITS POSITION     @Z67SP00*/ 02148000
         C     @15,@CF00058                                        0713 02149000
         BNE   @RF00713                                            0713 02150000
*                   K=J;            /*                       @Z67SP00*/ 02151000
         ST    @14,K                                               0714 02152000
*               END;                /*                       @Z67SP00*/ 02153000
@RF00713 DS    0H                                                  0716 02154000
*           END;                    /*                       @Z67SP00*/ 02155000
*                                                                  0716 02156000
@RF00710 LA    @15,1                                               0716 02157000
         AL    @15,J                                               0716 02158000
         ST    @15,J                                               0716 02159000
         C     @15,@CF00050                                        0716 02160000
         BNH   @DL00709                                            0716 02161000
@DC00709 DS    0H                                                  0717 02162000
*           /*********************************************************/ 02163000
*           /*                                                       */ 02164000
*           /* NOW CHECK TO SEE IF BEING CHANGED             @Z67SP00*/ 02165000
*           /*                                                       */ 02166000
*           /*********************************************************/ 02167000
*                                                                  0717 02168000
*           IF I>=2                 /* IF 2 SYSLIBS PRESENT  @Z67SP00*/ 02169000
*             THEN                  /* OVERLAY SECOND ONE    @Z67SP00*/ 02170000
         L     @15,I                                               0717 02171000
         C     @15,@CF00058                                        0717 02172000
         BL    @RF00717                                            0717 02173000
*             DO;                   /*                       @Z67SP00*/ 02174000
*               IOPLSYS(K)=SYSTLIB; /*                       @Z67SP00*/ 02175000
         L     @15,K                                               0719 02176000
         LR    @14,@15                                             0719 02177000
         MH    @14,@CH00459                                        0719 02178000
         L     @01,IOPPTR                                          0719 02179000
         ALR   @01,@14                                             0719 02180000
         MVC   IOPLSYS-9(8,@01),SYSTLIB                            0719 02181000
*               J=K;                /*                       @Z67SP00*/ 02182000
         ST    @15,J                                               0720 02183000
*             END;                  /*                       @Z67SP00*/ 02184000
*           STOWLMD=OFF;            /* NOT CHANGED           @Z67SP00*/ 02185000
@RF00717 NI    STOWLMD,B'11111110'                                 0722 02186000
*           IF IOPLSYS(J)^=SYSTLIB  /* IF SYSTLIB NOT FND    @Z67SP00*/ 02187000
*               |CCENTRD=ON         /* OR CC ENTERED         @D67SP00*/ 02188000
*               |IOPLMDF1^=FLAGSAV1 /* OR LEPARMS CHANGED    @Z67SP00*/ 02189000
*               |IOPLMDF2^=FLAGSAV2 /* OR LEPARMS CHANGED    @Z67SP00*/ 02190000
*               |IOPLMDF3^=FLAGSAV3 /* OR LEPARMS CHANGED    @Z67SP00*/ 02191000
*               |IOPLMDF4^=FLAGSAV4 /* OR LEPARMS CHANGED    @Z67SP00*/ 02192000
*               |IOPLMDF5^=FLAGSAV5 /* OR LEPARMS CHANGED    @Z67SP00*/ 02193000
*             THEN                  /*                       @Z67SP00*/ 02194000
         L     @15,IOPPTR                                          0723 02195000
         L     @14,J                                               0723 02196000
         MH    @14,@CH00459                                        0723 02197000
         ALR   @14,@15                                             0723 02198000
         CLC   IOPLSYS-9(8,@14),SYSTLIB                            0723 02199000
         BNE   @RT00723                                            0723 02200000
         TM    CCENTRD,B'00001000'                                 0723 02201000
         BO    @RT00723                                            0723 02202000
         CLC   IOPLMDF1(1,@15),FLAGSAV1                            0723 02203000
         BNE   @RT00723                                            0723 02204000
         CLC   IOPLMDF2(1,@15),FLAGSAV2                            0723 02205000
         BNE   @RT00723                                            0723 02206000
         CLC   IOPLMDF3(1,@15),FLAGSAV3                            0723 02207000
         BNE   @RT00723                                            0723 02208000
         CLC   IOPLMDF4(1,@15),FLAGSAV4                            0723 02209000
         BNE   @RT00723                                            0723 02210000
         CLC   IOPLMDF5(1,@15),FLAGSAV5                            0723 02211000
         BE    @RF00723                                            0723 02212000
@RT00723 DS    0H                                                  0724 02213000
*             DO;                   /*                       @Z67SP00*/ 02214000
*               STOWLMD=ON;         /* MUST UPDATE LMOD      @Z67SP00*/ 02215000
         OI    STOWLMD,B'00000001'                                 0725 02216000
*               BUPTYPE=BUPUPD;     /*                       @Z67SP00*/ 02217000
         L     @15,@PC00001                                        0726 02218000
         MVI   BUPTYPE(@15),X'02'                                  0726 02219000
*               BUPIOPAD=ADDR(HMASMIOP);/*                   @Z67SP00*/ 02220000
         L     @14,IOPPTR                                          0727 02221000
         ST    @14,BUPIOPAD(,@15)                                  0727 02222000
*               CALL HMASMBUE(BUPPARM);/*                    @Z67SP00*/ 02223000
         ST    @15,@AL00001                                        0728 02224000
         L     @15,@CV01385                                        0728 02225000
         LA    @01,@AL00001                                        0728 02226000
         BALR  @14,@15                                             0728 02227000
*               RFY                                                0729 02228000
*                 RTNCODE RSTD;     /*                       @Z67SP00*/ 02229000
*               IOPRETRN=RTNCODE;   /*                       @Z67SP00*/ 02230000
         L     @14,IOPPTR                                          0730 02231000
         STC   RTNCODE,IOPRETRN(,@14)                              0730 02232000
*               RFY                                                0731 02233000
*                 RTNCODE UNRSTD;   /*                       @Z67SP00*/ 02234000
*             END;                  /*                       @Z67SP00*/ 02235000
*         END;                      /*                       @Z67SP00*/ 02236000
@RF00723 DS    0H                                                  0734 02237000
*     END;                          /*                       @Z67SP00*/ 02238000
@RC00693 DS    0H                                                  0735 02239000
*                                                                  0735 02240000
*   /*****************************************************************/ 02241000
*   /*                                                               */ 02242000
*   /* WRITE CONTROL CARDS TO CDS AND STOW LMOD ENTRY        @Z67SP00*/ 02243000
*   /*                                                               */ 02244000
*   /*****************************************************************/ 02245000
*                                                                  0735 02246000
*   IF IOPRETRN<=IOPNTFND           /* IF PREV FUNCTIONS OK  @Z67SP00*/ 02247000
*       &STOWLMD=ON                 /*                       @Z67SP00*/ 02248000
*     THEN                          /*                       @Z67SP00*/ 02249000
@RF00691 L     @15,IOPPTR                                          0735 02250000
         CLI   IOPRETRN(@15),4                                     0735 02251000
         BH    @RF00735                                            0735 02252000
         TM    STOWLMD,B'00000001'                                 0735 02253000
         BNO   @RF00735                                            0735 02254000
*     DO;                           /*                       @Z67SP00*/ 02255000
*                                                                  0736 02256000
*       /*************************************************************/ 02257000
*       /*                                                           */ 02258000
*       /* SET NEW FIELDS IN LMOD ENTRY                      @Z67SP00*/ 02259000
*       /*                                                           */ 02260000
*       /*************************************************************/ 02261000
*                                                                  0737 02262000
*       IF IOPLMDND(J)=IOPEOLST     /* IF SYSLIB NOT FOUND   @Z67SP00*/ 02263000
*         THEN                      /*                       @Z67SP00*/ 02264000
         LA    @14,255                                             0737 02265000
         L     @09,J                                               0737 02266000
         MH    @09,@CH00459                                        0737 02267000
         SLR   @08,@08                                             0737 02268000
         IC    @08,IOPLMDND-9(@09,@15)                             0737 02269000
         CR    @14,@08                                             0737 02270000
         BNE   @RF00737                                            0737 02271000
*         DO;                       /*                       @Z67SP00*/ 02272000
*           IOPLSYS(J)=SYSTLIB;     /*                       @Z67SP00*/ 02273000
         ST    @09,@TF00001                                        0739 02274000
         ALR   @09,@15                                             0739 02275000
         MVC   IOPLSYS-9(8,@09),SYSTLIB                            0739 02276000
*           IOPLMIND(J)=IOPLMSYS;   /* SYSLIB TYPE ENTRY     @Z67SP00*/ 02277000
         LA    @09,1                                               0740 02278000
         L     @08,@TF00001                                        0740 02279000
         STC   @09,IOPLMIND-9(@08,@15)                             0740 02280000
*           IOPLMDND(J+1)=IOPEOLST; /*                       @Z67SP00*/ 02281000
         L     @01,@TF00001                                        0741 02282000
         STC   @14,IOPLMDND(@01,@15)                               0741 02283000
*         END;                      /*                       @Z67SP00*/ 02284000
*       IOPLMDF1=FLAGSAV1;          /* RESTORE LEPARMS 1     @ZD00004*/ 02285000
@RF00737 L     @15,IOPPTR                                          0743 02286000
         MVC   IOPLMDF1(1,@15),FLAGSAV1                            0743 02287000
*       IOPLMDF2=FLAGSAV2;          /* RESTORE LEPARMS 2     @ZD00004*/ 02288000
         MVC   IOPLMDF2(1,@15),FLAGSAV2                            0744 02289000
*       IOPLMDF3=FLAGSAV3;          /* RESTORE LEPARMS 3     @ZD00004*/ 02290000
         MVC   IOPLMDF3(1,@15),FLAGSAV3                            0745 02291000
*       IOPLMDF4=FLAGSAV4;          /* RESTORE LEPARMS 4     @ZD00004*/ 02292000
         MVC   IOPLMDF4(1,@15),FLAGSAV4                            0746 02293000
*       IOPLMDF5=FLAGSAV5;          /* RESTORE LMD OPTIONS   @ZD00004*/ 02294000
         MVC   IOPLMDF5(1,@15),FLAGSAV5                            0747 02295000
*       IOPLINK=ON;                 /* LKED PARMS OBTAINED           */ 02296000
         OI    IOPLINK(@15),B'01000000'                            0748 02297000
*       IF CHREPFLG=ON              /* THIS LMOD HAVE CH/REP STMTS?  */ 02298000
*         THEN                      /* YES - PUT IN IOP              */ 02299000
         TM    CHREPFLG,B'01000000'                                0749 02300000
         BNO   @RF00749                                            0749 02301000
*         DO;                                                      0750 02302000
*           IOPCHREP=ON;            /* INDICATE CHANGE/REPLACE IN IOP*/ 02303000
         OI    IOPCHREP(@15),B'00100000'                           0751 02304000
*           CHREPFLG=OFF;           /* RESET FLAG FOR NEXT           */ 02305000
         NI    CHREPFLG,B'10111111'                                0752 02306000
*         END;                                                     0753 02307000
*                                                                  0753 02308000
*       /*************************************************************/ 02309000
*       /*                                                           */ 02310000
*       /* NOW WRITE FIRST CONTROL RECORD PLUS ANY LINK EDIT CONTROL */ 02311000
*       /* CARDS THAT WERE FOUND                             @Z67SP00*/ 02312000
*       /*                                                           */ 02313000
*       /*************************************************************/ 02314000
*                                                                  0754 02315000
*       IOPFUNCT=IOPWRITE;          /* SET TO WRITE CC       @Z67SP00*/ 02316000
@RF00749 L     @15,IOPPTR                                          0754 02317000
         MVI   IOPFUNCT(@15),X'51'                                 0754 02318000
*       IOPBUFAD=ADDR(CCDATA);      /* READ INTO BUFFER      @Z67SP00*/ 02319000
         LA    @14,CCDATA                                          0755 02320000
         ST    @14,IOPBUFAD(,@15)                                  0755 02321000
*       CCDATA=IOPLMDFX;            /* MOVE RCD TO BUFFER    @Z67SP00*/ 02322000
         MVC   CCDATA(80),IOPLMDFX(@15)                            0756 02323000
*       CALL HMASMIO(HMASMIOP);     /* WRITE OUT FIRST RCD   @Z67SP00*/ 02324000
         ST    @15,@AL00001                                        0757 02325000
         L     @15,@CV01382                                        0757 02326000
         LA    @01,@AL00001                                        0757 02327000
         BALR  @14,@15                                             0757 02328000
*       GTPPTR=ADDR(CCGTP);         /*                       @Z67SP00*/ 02329000
         LA    @15,CCGTP                                           0758 02330000
         ST    @15,GTPPTR                                          0758 02331000
*       GTPFUNCT=GTPOPENN;          /*                       @Z67SP00*/ 02332000
         MVI   GTPFUNCT(@15),X'01'                                 0759 02333000
*       CALL HMASMGTA(HMASMGTP);    /*                       @Z67SP00*/ 02334000
         ST    @15,@AL00001                                        0760 02335000
         L     @15,@CV01384                                        0760 02336000
         LA    @01,@AL00001                                        0760 02337000
         BALR  @14,@15                                             0760 02338000
*       GTPFUNCT=GTPGETN;           /*                       @Z67SP00*/ 02339000
         L     @15,GTPPTR                                          0761 02340000
         MVI   GTPFUNCT(@15),X'08'                                 0761 02341000
*       CALL HMASMGTA(HMASMGTP);    /*                       @Z67SP00*/ 02342000
         ST    @15,@AL00001                                        0762 02343000
         L     @15,@CV01384                                        0762 02344000
         LA    @01,@AL00001                                        0762 02345000
         BALR  @14,@15                                             0762 02346000
*       SEQNO=ZERO;                 /* INIT RCD SEQUENCE NUM @Z67SP00*/ 02347000
         SLR   @15,@15                                             0763 02348000
         ST    @15,SEQNO                                           0763 02349000
*       DO WHILE(                   /*                       @Z67SP00*/ 02350000
*             IOPRETRN=IOPGOOD      /*                       @Z67SP00*/ 02351000
*             &GTPRETRN=GTPGOOD);   /*                       @Z67SP00*/ 02352000
         B     @DE00764                                            0764 02353000
@DL00764 DS    0H                                                  0765 02354000
*         IF IOPLMCC=IOPLMCRM       /* IF MOD CARD FOR CH/RP @Z67SP00*/ 02355000
*             &IOPLMCRN=BLANK8      /* BUT NO MOD NAME       @Z67SP00*/ 02356000
*           THEN                    /*                       @Z67SP00*/ 02357000
         L     @01,IOPPTR                                          0765 02358000
         L     @15,IOPBUFAD(,@01)                                  0765 02359000
         CLI   IOPLMCC(@15),C'*'                                   0765 02360000
         BNE   @RF00765                                            0765 02361000
         CLC   IOPLMCRN(8,@15),@CC01426                            0765 02362000
         BNE   @RF00765                                            0765 02363000
*           DO;                     /* SKIP CH/REPS          @Z67SP00*/ 02364000
*             DO WHILE(             /* LOOP                  @Z67SP00*/ 02365000
*                   GTPRETRN=GTPGOOD/* TILL EOF              @Z67SP00*/ 02366000
*                   &IOPLMCC=IOPLMCRC);/* OR TILL END OF CH/REP    0767 02367000
*                                                            @Z67SP00*/ 02368000
         B     @DE00767                                            0767 02369000
@DL00767 DS    0H                                                  0768 02370000
*               CALL HMASMGTA(HMASMGTP);/* CARDS             @Z67SP00*/ 02371000
         L     @01,GTPPTR                                          0768 02372000
         ST    @01,@AL00001                                        0768 02373000
         L     @15,@CV01384                                        0768 02374000
         LA    @01,@AL00001                                        0768 02375000
         BALR  @14,@15                                             0768 02376000
*             END;                  /*                       @Z67SP00*/ 02377000
@DE00767 L     @01,GTPPTR                                          0769 02378000
         CLI   GTPRETRN(@01),0                                     0769 02379000
         BNE   @DC00767                                            0769 02380000
         L     @01,IOPPTR                                          0769 02381000
         L     @01,IOPBUFAD(,@01)                                  0769 02382000
         CLI   IOPLMCC(@01),C'@'                                   0769 02383000
         BE    @DL00767                                            0769 02384000
@DC00767 DS    0H                                                  0770 02385000
*           END;                    /*                       @Z67SP00*/ 02386000
*         IF GTPRETRN=GTPGOOD       /* IF CONTROL CARD FOUND @Z67SP00*/ 02387000
*           THEN                    /*                       @Z67SP00*/ 02388000
@RF00765 L     @01,GTPPTR                                          0771 02389000
         CLI   GTPRETRN(@01),0                                     0771 02390000
         BNE   @RF00771                                            0771 02391000
*           DO;                     /*                       @Z67SP00*/ 02392000
*             SEQNO=SEQNO+INCR;     /* BUMP SEQUENCE NUMBER          */ 02393000
         LA    @15,100                                             0773 02394000
         AL    @15,SEQNO                                           0773 02395000
         ST    @15,SEQNO                                           0773 02396000
*             CVD(SEQNO,DBLWRD);    /* CONVERT NUMBER                */ 02397000
         CVD   @15,DBLWRD                                          0774 02398000
*             UNPK(CCRCDNO,DBLWRD); /* PUT NUMBER TO RECORD          */ 02399000
         UNPK  CCRCDNO(8),DBLWRD(8)                                0775 02400000
*             CCMAKPR=CCMAKPR|PRBITS;/* MAKE PRINTABLE               */ 02401000
         OI    CCMAKPR,X'F0'                                       0776 02402000
*             CALL HMASMIO(HMASMIOP);/* WRITE LINE           @Z67SP00*/ 02403000
         L     @01,IOPPTR                                          0777 02404000
         ST    @01,@AL00001                                        0777 02405000
         L     @15,@CV01382                                        0777 02406000
         LA    @01,@AL00001                                        0777 02407000
         BALR  @14,@15                                             0777 02408000
*             CALL HMASMGTA(HMASMGTP);/* READ NEXT CC        @Z67SP00*/ 02409000
         L     @01,GTPPTR                                          0778 02410000
         ST    @01,@AL00001                                        0778 02411000
         L     @15,@CV01384                                        0778 02412000
         LA    @01,@AL00001                                        0778 02413000
         BALR  @14,@15                                             0778 02414000
*           END;                    /*                       @Z67SP00*/ 02415000
*       END;                        /*                       @Z67SP00*/ 02416000
*                                                                  0780 02417000
@RF00771 DS    0H                                                  0780 02418000
@DE00764 L     @01,IOPPTR                                          0780 02419000
         CLI   IOPRETRN(@01),0                                     0780 02420000
         BNE   @DC00764                                            0780 02421000
         L     @01,GTPPTR                                          0780 02422000
         CLI   GTPRETRN(@01),0                                     0780 02423000
         BE    @DL00764                                            0780 02424000
@DC00764 DS    0H                                                  0781 02425000
*       /*************************************************************/ 02426000
*       /*                                                           */ 02427000
*       /* NOW STOW LMOD ENTRY ON CDS                        @Z67SP00*/ 02428000
*       /*                                                           */ 02429000
*       /*************************************************************/ 02430000
*                                                                  0781 02431000
*       IF IOPRETRN=IOPGOOD         /* IF WRITE WERE OK      @Z67SP00*/ 02432000
*         THEN                      /*                       @Z67SP00*/ 02433000
         L     @15,IOPPTR                                          0781 02434000
         CLI   IOPRETRN(@15),0                                     0781 02435000
         BNE   @RF00781                                            0781 02436000
*         DO;                       /*                       @Z67SP00*/ 02437000
*           IOPFUNCT=IOPSTOWR;      /* INDICATE STOW OPERATION       */ 02438000
         MVI   IOPFUNCT(@15),X'54'                                 0783 02439000
*           CALL HMASMIO(HMASMIOP); /* STOW LINK EDIT CON CARDS      */ 02440000
         ST    @15,@AL00001                                        0784 02441000
         L     @15,@CV01382                                        0784 02442000
         LA    @01,@AL00001                                        0784 02443000
         BALR  @14,@15                                             0784 02444000
*         END;                      /* END STOW LMOD         @Z67SP00*/ 02445000
*     END;                          /* END MUST STOW LMOD    @Z67SP00*/ 02446000
@RF00781 DS    0H                                                  0787 02447000
*   IOPBUFAD=SAVBUFAD;              /* RESET ADD IN CASE CHANGED   0787 02448000
*                                      DURING PROCESS        @Z67SP00*/ 02449000
@RF00735 L     @15,IOPPTR                                          0787 02450000
         L     @14,SAVBUFAD                                        0787 02451000
         ST    @14,IOPBUFAD(,@15)                                  0787 02452000
*                                                                  0788 02453000
*   /*****************************************************************/ 02454000
*   /*                                                               */ 02455000
*   /* CREATE AND STORE MODULE ENTRIES IN THE CDS. MEMBERS MAY BE    */ 02456000
*   /* UPDATED IF THIS LOAD MODULE DOES NOT APPEAR ON THE LOAD MODULE*/ 02457000
*   /* LIST.                                                         */ 02458000
*   /*                                                               */ 02459000
*   /*****************************************************************/ 02460000
*                                                                  0788 02461000
*   IF IOPRETRN=IOPGOOD             /* IF PREV FUNCTION OK   @Z67SP00*/ 02462000
*     THEN                          /*                       @Z67SP00*/ 02463000
         CLI   IOPRETRN(@15),0                                     0788 02464000
         BNE   @RF00788                                            0788 02465000
*     DO;                           /*                       @Z67SP00*/ 02466000
*       GTPPTR=ADDR(MDDLBGTP);      /* GTP WITH MODS         @Z67SP00*/ 02467000
         LA    @15,MDDLBGTP                                        0790 02468000
         ST    @15,GTPPTR                                          0790 02469000
*       GTPFUNCT=GTPOPENN;          /*                       @Z67SP00*/ 02470000
         MVI   GTPFUNCT(@15),X'01'                                 0791 02471000
*       CALL HMASMGTA(HMASMGTP);    /* POS TO FIRST RCD      @Z67SP00*/ 02472000
         ST    @15,@AL00001                                        0792 02473000
         L     @15,@CV01384                                        0792 02474000
         LA    @01,@AL00001                                        0792 02475000
         BALR  @14,@15                                             0792 02476000
*       GTPFUNCT=GTPGETN;           /* SEQUENTIAL READ       @Z67SP00*/ 02477000
         L     @15,GTPPTR                                          0793 02478000
         MVI   GTPFUNCT(@15),X'08'                                 0793 02479000
*       CALL HMASMGTA(HMASMGTP);    /* GET FIRST RCD         @Z67SP00*/ 02480000
         ST    @15,@AL00001                                        0794 02481000
         L     @15,@CV01384                                        0794 02482000
         LA    @01,@AL00001                                        0794 02483000
         BALR  @14,@15                                             0794 02484000
*       DO WHILE(                   /* LOOP READING AND STOW @Z67SP00*/ 02485000
*             IOPRETRN=IOPGOOD      /* TILL ERR IN LOC/STOW  @Z67SP00*/ 02486000
*             &GTPRETRN=GTPGOOD);   /* OR EOF ON MODS        @Z67SP00*/ 02487000
         B     @DE00795                                            0795 02488000
@DL00795 DS    0H                                                  0796 02489000
*         IOPNAME=CSECTN;           /* MOVE MOD NAME TO IOP  @Z67SP00*/ 02490000
         L     @15,IOPPTR                                          0796 02491000
         MVC   IOPNAME(8,@15),CSECTN                               0796 02492000
*         IOPTYPE=IOPMOD;           /* MOD TYPE RCD          @Z67SP00*/ 02493000
         MVI   IOPTYPE(@15),X'05'                                  0797 02494000
*         IOPFUNCT=IOPLOC;          /*                       @Z67SP00*/ 02495000
         MVI   IOPFUNCT(@15),X'03'                                 0798 02496000
*         CALL HMASMIO(HMASMIOP);   /* LOC MOD ON CDS        @Z67SP00*/ 02497000
*                                                                  0799 02498000
         ST    @15,@AL00001                                        0799 02499000
         L     @15,@CV01382                                        0799 02500000
         LA    @01,@AL00001                                        0799 02501000
         BALR  @14,@15                                             0799 02502000
*         /***********************************************************/ 02503000
*         /*                                                         */ 02504000
*         /* IF MOD NOT FOUD SET SET INITIAL ENTRY AND CALL BUE      */ 02505000
*         /*                                                 @Z67SP00*/ 02506000
*         /*                                                         */ 02507000
*         /***********************************************************/ 02508000
*                                                                  0800 02509000
*         IF IOPRETRN=IOPNTFND      /* IF NOT FOUND          @Z67SP00*/ 02510000
*           THEN                    /*                       @Z67SP00*/ 02511000
         L     @15,IOPPTR                                          0800 02512000
         CLI   IOPRETRN(@15),4                                     0800 02513000
         BNE   @RF00800                                            0800 02514000
*           DO;                     /*                       @Z67SP00*/ 02515000
*             IOPMODNT=''B;         /* INIT ENTRY            @Z67SP00*/ 02516000
         XC    IOPMODNT(104,@15),IOPMODNT(@15)                     0802 02517000
*             IOPNTLVL=IOPMODLC;    /* SET CONVERSION LEVEL  @Z67SP00*/ 02518000
         MVI   IOPNTLVL(@15),X'02'                                 0803 02519000
*             IOPRMID=BLANK;        /*                       @Z67SP00*/ 02520000
         MVI   IOPRMID+1(@15),C' '                                 0804 02521000
         MVC   IOPRMID+2(5,@15),IOPRMID+1(@15)                     0804 02522000
         MVI   IOPRMID(@15),C' '                                   0804 02523000
*             IOPFMID=BLANK;        /*                       @Z67SP00*/ 02524000
         MVI   IOPFMID+1(@15),C' '                                 0805 02525000
         MVC   IOPFMID+2(5,@15),IOPFMID+1(@15)                     0805 02526000
         MVI   IOPFMID(@15),C' '                                   0805 02527000
*             BUPTYPE=BUPADD;       /* INDICATE ADDED        @Z67SP00*/ 02528000
         L     @15,@PC00001                                        0806 02529000
         MVI   BUPTYPE(@15),X'01'                                  0806 02530000
*             CALL HMASMBUE(BUPPARM);/*                      @Z67SP00*/ 02531000
         ST    @15,@AL00001                                        0807 02532000
         L     @15,@CV01385                                        0807 02533000
         LA    @01,@AL00001                                        0807 02534000
         BALR  @14,@15                                             0807 02535000
*             RFY                                                  0808 02536000
*               RTNCODE RSTD;       /*                       @Z67SP00*/ 02537000
*             IOPRETRN=RTNCODE;     /* SAVE RC               @Z67SP00*/ 02538000
         L     @14,IOPPTR                                          0809 02539000
         STC   RTNCODE,IOPRETRN(,@14)                              0809 02540000
*             RFY                                                  0810 02541000
*               RTNCODE UNRSTD;     /*                       @Z67SP00*/ 02542000
*             J=1;                  /* PLACE WHERE LMOD NAME WILL BE    02543000
*                                      PLACED LATER          @Z67SP00*/ 02544000
         MVC   J(4),@CF00048                                       0811 02545000
*             IOPMODND(1)=IOPEOLST; /* SET END OF LIST       @Z67SP00*/ 02546000
         MVI   IOPMODND(@14),X'FF'                                 0812 02547000
*           END;                    /*                       @Z67SP00*/ 02548000
*                                                                  0813 02549000
*         /***********************************************************/ 02550000
*         /*                                                         */ 02551000
*         /* IF MOD FOUND ON CDS THEN DETERMINE WHETHER CHANGE WILL  */ 02552000
*         /* BE MADE AND IF SO CALL BUE THEN MAKE CHANGE     @Z67SP00*/ 02553000
*         /*                                                         */ 02554000
*         /***********************************************************/ 02555000
*                                                                  0814 02556000
*         ELSE                      /*                       @Z67SP00*/ 02557000
*           IF IOPRETRN=IOPGOOD     /* IF FOUND              @Z67SP00*/ 02558000
*             THEN                  /*                       @Z67SP00*/ 02559000
         B     @RC00800                                            0814 02560000
@RF00800 L     @01,IOPPTR                                          0814 02561000
         CLI   IOPRETRN(@01),0                                     0814 02562000
         BNE   @RF00814                                            0814 02563000
*             DO;                   /*                       @Z67SP00*/ 02564000
*               DO J=1 BY 1 WHILE(  /* LOOP THRU MOD SUBENTS @Z67SP00*/ 02565000
*                     IOPMODND(J)^=IOPEOLST/* TILL END       @Z67SP00*/ 02566000
*                     &(IOPLMODS(J)^=LMODNAM/* OR UNTIL SUBENT     0816 02567000
*                                                            @Z67SP00*/ 02568000
*                     |IOPMDIND(J)^=IOPMDLMD));/* FOUND AS LMOD TYPE    02569000
*                                      EQUAL TO ONE BEING PROCESS  0816 02570000
*                                                            @Z67SP00*/ 02571000
         LA    @15,1                                               0816 02572000
         ST    @15,J                                               0816 02573000
         B     @DE00816                                            0816 02574000
@DL00816 DS    0H                                                  0817 02575000
*               END;                /*                       @Z67SP00*/ 02576000
         LA    @15,1                                               0817 02577000
         AL    @15,J                                               0817 02578000
         ST    @15,J                                               0817 02579000
@DE00816 L     @15,IOPPTR                                          0817 02580000
         L     @14,J                                               0817 02581000
         MH    @14,@CH00459                                        0817 02582000
         SLR   @09,@09                                             0817 02583000
         IC    @09,IOPMODND-9(@14,@15)                             0817 02584000
         C     @09,@CF00648                                        0817 02585000
         BE    @DC00816                                            0817 02586000
         ST    @14,@TF00001                                        0817 02587000
         ALR   @14,@15                                             0817 02588000
         CLC   IOPLMODS-9(8,@14),LMODNAM                           0817 02589000
         BNE   @DL00816                                            0817 02590000
         L     @14,@TF00001                                        0817 02591000
         SLR   @09,@09                                             0817 02592000
         IC    @09,IOPMDIND-9(@14,@15)                             0817 02593000
         C     @09,@CF00048                                        0817 02594000
         BNE   @DL00816                                            0817 02595000
@DC00816 DS    0H                                                  0818 02596000
*               IF IOPMODND(J)=IOPEOLST/* IF LMOD NOT FOUND  @Z67SP00*/ 02597000
*                   |IOPDLIB^=DLIBN /* OR DLIB CHANGED       @Z67SP00*/ 02598000
*                 THEN              /*                       @Z67SP00*/ 02599000
         L     @15,IOPPTR                                          0818 02600000
         L     @14,J                                               0818 02601000
         MH    @14,@CH00459                                        0818 02602000
         SLR   @09,@09                                             0818 02603000
         IC    @09,IOPMODND-9(@14,@15)                             0818 02604000
         C     @09,@CF00648                                        0818 02605000
         BE    @RT00818                                            0818 02606000
         CLC   IOPDLIB(8,@15),DLIBN                                0818 02607000
         BE    @RF00818                                            0818 02608000
@RT00818 DS    0H                                                  0819 02609000
*                 DO;               /*                       @Z67SP00*/ 02610000
*                   BUPTYPE=BUPUPD; /* INDICATE UPDATE       @Z67SP00*/ 02611000
         L     @15,@PC00001                                        0820 02612000
         MVI   BUPTYPE(@15),X'02'                                  0820 02613000
*                   CALL HMASMBUE(BUPPARM);/* CREATE BACKUP  @Z67SP00*/ 02614000
         ST    @15,@AL00001                                        0821 02615000
         L     @15,@CV01385                                        0821 02616000
         LA    @01,@AL00001                                        0821 02617000
         BALR  @14,@15                                             0821 02618000
*                   RFY                                            0822 02619000
*                     RTNCODE RSTD; /*                       @Z67SP00*/ 02620000
*                   IOPRETRN=RTNCODE;/*                      @Z67SP00*/ 02621000
         L     @14,IOPPTR                                          0823 02622000
         STC   RTNCODE,IOPRETRN(,@14)                              0823 02623000
*                   RFY                                            0824 02624000
*                     RTNCODE UNRSTD;/*                      @Z67SP00*/ 02625000
*                 END;              /*                       @Z67SP00*/ 02626000
*             END;                  /*                       @Z67SP00*/ 02627000
*           ELSE                    /*                       @Z67SP00*/ 02628000
*             IF IOPRETRN=IOPEXC    /*                       @Z67SP00*/ 02629000
*               THEN                /*                       @Z67SP00*/ 02630000
         B     @RC00814                                            0827 02631000
@RF00814 L     @01,IOPPTR                                          0827 02632000
         CLI   IOPRETRN(@01),8                                     0827 02633000
         BNE   @RF00827                                            0827 02634000
*               EXCERR=ON;          /*                       @Z67SP00*/ 02635000
*                                                                  0828 02636000
         OI    EXCERR,B'01000000'                                  0828 02637000
*         /***********************************************************/ 02638000
*         /*                                                         */ 02639000
*         /* IF LOCATE OK AND BACKUP CREATED OK AND MOD CHANGED THEN */ 02640000
*         /* STOW MOD ON CDS                                 @Z67SP00*/ 02641000
*         /*                                                         */ 02642000
*         /***********************************************************/ 02643000
*                                                                  0829 02644000
*         IF IOPRETRN<=IOPNTFND     /* IF NO ERR IN LOCATE   @Z67SP00*/ 02645000
*             &(IOPMODND(J)=IOPEOLST/* AND LMOD NOT FOUND    @Z67SP00*/ 02646000
*             |IOPDLIB^=DLIBN)      /* IN MOD OR NEW DLIB    @Z67SP00*/ 02647000
*           THEN                    /*                       @Z67SP00*/ 02648000
@RF00827 DS    0H                                                  0829 02649000
@RC00814 DS    0H                                                  0829 02650000
@RC00800 L     @15,IOPPTR                                          0829 02651000
         CLI   IOPRETRN(@15),4                                     0829 02652000
         BH    @RF00829                                            0829 02653000
         L     @14,J                                               0829 02654000
         MH    @14,@CH00459                                        0829 02655000
         SLR   @09,@09                                             0829 02656000
         IC    @09,IOPMODND-9(@14,@15)                             0829 02657000
         C     @09,@CF00648                                        0829 02658000
         BE    @RT00829                                            0829 02659000
         CLC   IOPDLIB(8,@15),DLIBN                                0829 02660000
         BE    @RF00829                                            0829 02661000
@RT00829 DS    0H                                                  0830 02662000
*           DO;                     /*                       @Z67SP00*/ 02663000
*             IF IOPMODND(J)=IOPEOLST/* IF LMOD NOT FOUND    @Z67SP00*/ 02664000
*               THEN                /*                       @Z67SP00*/ 02665000
         LA    @15,255                                             0831 02666000
         L     @14,IOPPTR                                          0831 02667000
         L     @09,J                                               0831 02668000
         MH    @09,@CH00459                                        0831 02669000
         SLR   @08,@08                                             0831 02670000
         IC    @08,IOPMODND-9(@09,@14)                             0831 02671000
         CR    @15,@08                                             0831 02672000
         BNE   @RF00831                                            0831 02673000
*               DO;                 /*                       @Z67SP00*/ 02674000
*                 IOPLMODS(J)=LMODNAM;/* MOVE LMOD NAME      @Z67SP00*/ 02675000
         ST    @09,@TF00001                                        0833 02676000
         ALR   @09,@14                                             0833 02677000
         MVC   IOPLMODS-9(8,@09),LMODNAM                           0833 02678000
*                 IOPMDIND(J)=IOPMDLMD;/* LMOD TYPE          @Z67SP00*/ 02679000
         LA    @09,1                                               0834 02680000
         L     @08,@TF00001                                        0834 02681000
         STC   @09,IOPMDIND-9(@08,@14)                             0834 02682000
*                 IOPMODND(J+1)=IOPEOLST;/*                  @Z67SP00*/ 02683000
         L     @01,@TF00001                                        0835 02684000
         STC   @15,IOPMODND(@01,@14)                               0835 02685000
*               END;                /*                       @Z67SP00*/ 02686000
*             IOPDLIB=DLIBN;        /* MOVE DLIB             @Z67SP00*/ 02687000
@RF00831 L     @15,IOPPTR                                          0837 02688000
         MVC   IOPDLIB(8,@15),DLIBN                                0837 02689000
*             IOPFUNCT=IOPSTOWR;    /* STOW MOD ON CDS       @Z67SP00*/ 02690000
         MVI   IOPFUNCT(@15),X'54'                                 0838 02691000
*             CALL HMASMIO(HMASMIOP);/*                      @Z67SP00*/ 02692000
         ST    @15,@AL00001                                        0839 02693000
         L     @15,@CV01382                                        0839 02694000
         LA    @01,@AL00001                                        0839 02695000
         BALR  @14,@15                                             0839 02696000
*           END;                    /*                       @Z67SP00*/ 02697000
*         CALL HMASMGTA(HMASMGTP);  /* GET NEXT MOD/DLIB     @Z67SP00*/ 02698000
@RF00829 L     @01,GTPPTR                                          0841 02699000
         ST    @01,@AL00001                                        0841 02700000
         L     @15,@CV01384                                        0841 02701000
         LA    @01,@AL00001                                        0841 02702000
         BALR  @14,@15                                             0841 02703000
*       END;                        /* END GTA LOOP          @Z67SP00*/ 02704000
@DE00795 L     @01,IOPPTR                                          0842 02705000
         CLI   IOPRETRN(@01),0                                     0842 02706000
         BNE   @DC00795                                            0842 02707000
         L     @01,GTPPTR                                          0842 02708000
         CLI   GTPRETRN(@01),0                                     0842 02709000
         BE    @DL00795                                            0842 02710000
@DC00795 DS    0H                                                  0843 02711000
*     END;                          /* END LMOD PROCESSED    @Z67SP00*/ 02712000
*                                                                  0843 02713000
*   /*****************************************************************/ 02714000
*   /*                                                               */ 02715000
*   /* NOW FREE AND REINITIALIZE MOD/DLIB GTP                @Z67SP00*/ 02716000
*   /*                                                               */ 02717000
*   /*****************************************************************/ 02718000
*                                                                  0844 02719000
*   GTPPTR=ADDR(MDDLBGTP);          /*                       @Z67SP00*/ 02720000
@RF00788 LA    @15,MDDLBGTP                                        0844 02721000
         ST    @15,GTPPTR                                          0844 02722000
*   GTPFUNCT=GTPFREE;               /*                       @Z67SP00*/ 02723000
         MVI   GTPFUNCT(@15),X'0A'                                 0845 02724000
*   CALL HMASMGTA(HMASMGTP);        /*                       @Z67SP00*/ 02725000
         ST    @15,@AL00001                                        0846 02726000
         L     @15,@CV01384                                        0846 02727000
         LA    @01,@AL00001                                        0846 02728000
         BALR  @14,@15                                             0846 02729000
*   HMASMGTP=''B;                   /* SET UP MOD/DLIB GTP   @Z67SP00*/ 02730000
         L     @15,GTPPTR                                          0847 02731000
         XC    HMASMGTP(28,@15),HMASMGTP(@15)                      0847 02732000
*   GTPRCDLN=LENGTH(MDDLBRCD);      /*                       @Z67SP00*/ 02733000
         MVC   GTPRCDLN(2,@15),@CH00216                            0848 02734000
*   GTPKEYLN=LENGTH(CSECTN);        /*                       @Z67SP00*/ 02735000
         MVC   GTPKEYLN(2,@15),@CH00043                            0849 02736000
*   GTPBUFAD=ADDR(MDDLBRCD);        /*                       @Z67SP00*/ 02737000
         LA    @14,MDDLBRCD                                        0850 02738000
         ST    @14,GTPBUFAD(,@15)                                  0850 02739000
*   GTPPSIZE=GTP512B;               /*                       @Z67SP00*/ 02740000
*                                                                  0851 02741000
         NI    GTPPSIZE(@15),B'11111001'                           0851 02742000
         OI    GTPPSIZE(@15),B'00000001'                           0851 02743000
*   /*****************************************************************/ 02744000
*   /*                                                               */ 02745000
*   /* NOW FREE AND REINITIALIZE CONTROL CARD GTP            @Z67SP00*/ 02746000
*   /*                                                               */ 02747000
*   /*****************************************************************/ 02748000
*                                                                  0852 02749000
*   GTPPTR=ADDR(CCGTP);             /*                       @Z67SP00*/ 02750000
         LA    @15,CCGTP                                           0852 02751000
         ST    @15,GTPPTR                                          0852 02752000
*   GTPFUNCT=GTPFREE;               /*                       @Z67SP00*/ 02753000
         MVI   GTPFUNCT(@15),X'0A'                                 0853 02754000
*   CALL HMASMGTA(HMASMGTP);        /*                       @Z67SP00*/ 02755000
         ST    @15,@AL00001                                        0854 02756000
         L     @15,@CV01384                                        0854 02757000
         LA    @01,@AL00001                                        0854 02758000
         BALR  @14,@15                                             0854 02759000
*   GTPRCDLN=LENGTH(CCRCD);         /*                       @Z67SP00*/ 02760000
         L     @15,GTPPTR                                          0855 02761000
         MVC   GTPRCDLN(2,@15),@CH00548                            0855 02762000
*   GTPKEYLN=LENGTH(CCKEY);         /*                       @Z67SP00*/ 02763000
         MVC   GTPKEYLN(2,@15),@CH00064                            0856 02764000
*   GTPBUFAD=ADDR(CCRCD);           /*                       @Z67SP00*/ 02765000
         LA    @14,CCRCD                                           0857 02766000
         ST    @14,GTPBUFAD(,@15)                                  0857 02767000
*   SCPRETRN=IOPRETRN;              /* SET SCAN RC           @Z67SP00*/ 02768000
         L     @01,IOPPTR                                          0858 02769000
         IC    @00,IOPRETRN(,@01)                                  0858 02770000
         L     @01,SCPPTR                                          0858 02771000
         STC   @00,SCPRETRN(,@01)                                  0858 02772000
*   NAMEFND=ON;                     /* NAME FOUND            @Z67SP00*/ 02773000
*   CCENTRD=OFF;                    /* NO CC                 @Z67SP00*/ 02774000
         OI    NAMEFND,B'00010000'                                 0860 02775000
         NI    CCENTRD,B'11110111'                                 0860 02776000
*   END RNAMEV;                                                    0861 02777000
@EL00010 DS    0H                                                  0861 02778000
@EF00010 DS    0H                                                  0861 02779000
@ER00010 LM    @14,@12,@SA00010                                    0861 02780000
         BR    @14                                                 0861 02781000
         EJECT                                                          02782000
*                                                                  0862 02783000
*   /*****************************************************************/ 02784000
*   /*                                                               */ 02785000
*   /* ROUTINE TO PRINT LINE IN ERROR DETECTED IN JCLIN SCAN TWO     */ 02786000
*   /* POINTERS ARE RECEIVED. ONE POINTS TO THE LINE IN ERROR RECORD.*/ 02787000
*   /* THE OTHER POINTS TO AN ACTION FIELD DESCRIBING THE ACTION     */ 02788000
*   /* TAKEN.                                                @SA72421*/ 02789000
*   /*                                                               */ 02790000
*   /*****************************************************************/ 02791000
*                                                                  0862 02792000
*LKDERR:                            /* ERROR PRINT ROUTINE   @SA72421*/ 02793000
*   PROCEDURE(LINE,ACTION);         /*                       @Z67SP00*/ 02794000
LKDERR   STM   @14,@12,@SA00011                                    0862 02795000
         MVC   @PC00011(8),0(@01)                                  0862 02796000
*   DCL                                                            0863 02797000
*     LKDRBFSV PTR(31);             /* BUFF ADDRESS SAVE AREA      0863 02798000
*                                                            @SA72421*/ 02799000
*   DCL                                                            0864 02800000
*     LINE CHAR(80);                /* LINE IN ERROR         @Z67SP00*/ 02801000
*   DCL                                                            0865 02802000
*     ACTION CHAR(25);              /* ACTION INFO           @Z67SP00*/ 02803000
*   DCL                                                            0866 02804000
*     1 JCLINOUT,                   /* CORE AREA EQUATING TO HMASMPRL   02805000
*                                                            @SA72421*/ 02806000
*       3 * CHAR(LENGTH(HMASMPRL)), /* PRL CONTROL AREA      @Z40SP00*/ 02807000
*       3 PRNTMAP CHAR(120),        /* PRINT LINE MAP        @SA72421*/ 02808000
*         5 * CHAR(10) INIT('----------'),/* PREFIX          @SA72421*/ 02809000
*         5 JCLINDAT CHAR(80),      /* LINE IN ERROR         @SA72421*/ 02810000
*         5 * CHAR(5) INIT(' '),    /* SPACING               @SA72421*/ 02811000
*         5 JCLINACT CHAR(25);      /* ACTION INFO           @SA72421*/ 02812000
*   LKDRBFSV=IOPBUFAD;              /* SAVE BUFFER ADDRESS   @SA72421*/ 02813000
         L     @15,IOPPTR                                          0867 02814000
         L     @14,IOPBUFAD(,@15)                                  0867 02815000
         ST    @14,LKDRBFSV                                        0867 02816000
*   IOPBUFAD=ADDR(JCLINOUT);        /* EQUATE PRL TO JCLINOUT MAP  0868 02817000
*                                                            @SA72421*/ 02818000
         LA    @14,JCLINOUT                                        0868 02819000
         ST    @14,IOPBUFAD(,@15)                                  0868 02820000
*   JCLINDAT=LINE;                  /* FILL IN LINE IN ERROR @SA72421*/ 02821000
         L     @09,@PC00011                                        0869 02822000
         MVC   JCLINDAT(80),LINE(@09)                              0869 02823000
*   JCLINACT=ACTION;                /* FILL IN ACTION INFO   @SA72421*/ 02824000
         L     @09,@PC00011+4                                      0870 02825000
         MVC   JCLINACT(25),ACTION(@09)                            0870 02826000
*   PRLRLEN=LENGTH(PRNTMAP);        /* FILL IN LNGTH OF PRNT DATA  0871 02827000
*                                                            @SA72421*/ 02828000
         MVC   PRLRLEN(2,@14),@CH01711                             0871 02829000
*   PRLFLGS=ZERO;                   /* RESET FLAGS           @Z40SP00*/ 02830000
         MVI   PRLFLGS(@14),X'00'                                  0872 02831000
*   IOPDSID=IOPPRINT;               /* SET PRINT INDICATOR   @SA72421*/ 02832000
         MVI   IOPDSID(@15),X'0B'                                  0873 02833000
*   IOPFUNCT=IOPWRITE;              /* INDICATE WRITE OP     @SA72421*/ 02834000
         MVI   IOPFUNCT(@15),X'51'                                 0874 02835000
*   CALL HMASMIO(HMASMIOP);         /* WRITE LINE IN ERROR   @SA72421*/ 02836000
         ST    @15,@AL00001                                        0875 02837000
         L     @15,@CV01382                                        0875 02838000
         LA    @01,@AL00001                                        0875 02839000
         BALR  @14,@15                                             0875 02840000
*   IF IOPRETRN^=IOPGOOD            /* ERROR?                @YA07506*/ 02841000
*     THEN                                                         0876 02842000
         L     @15,IOPPTR                                          0876 02843000
         CLI   IOPRETRN(@15),0                                     0876 02844000
         BE    @RF00876                                            0876 02845000
*     IF LKDRTNCD<IOPRETRN          /* CHANGE RC?            @YA07506*/ 02846000
*       THEN                                                       0877 02847000
         CLC   LKDRTNCD(1),IOPRETRN(@15)                           0877 02848000
         BNL   @RF00877                                            0877 02849000
*       LKDRTNCD=IOPRETRN;          /* YES                   @YA07506*/ 02850000
         IC    @14,IOPRETRN(,@15)                                  0878 02851000
         STC   @14,LKDRTNCD                                        0878 02852000
*   IOPBUFAD=LKDRBFSV;              /* RESTORE BUFFER ADDRESS      0879 02853000
*                                                            @SA72421*/ 02854000
@RF00877 DS    0H                                                  0879 02855000
@RF00876 L     @15,LKDRBFSV                                        0879 02856000
         L     @14,IOPPTR                                          0879 02857000
         ST    @15,IOPBUFAD(,@14)                                  0879 02858000
*   END LKDERR;                     /* RETURN                @SA72421*/ 02859000
@EL00011 DS    0H                                                  0880 02860000
@EF00011 DS    0H                                                  0880 02861000
@ER00011 LM    @14,@12,@SA00011                                    0880 02862000
         BR    @14                                                 0880 02863000
*   END HMASMLKD                    /*                       @SA70537*/ 02864000
*                                                                  0881 02865000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 02866000
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */ 02867000
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */ 02868000
*/*%INCLUDE SYSLIB  (HMASMPRL)                                       */ 02869000
*/*%INCLUDE SYSLIB  (HMASMCRP)                                       */ 02870000
*/*%INCLUDE SYSLIB  (HMASMSCP)                                       */ 02871000
*/*%INCLUDE SYSLIB  (HMASMGTP)                                       */ 02872000
*                                                                  0881 02873000
*       ;                                                          0881 02874000
@DATA    DS    0H                                                       02875000
@CH00064 DC    H'5'                                                     02876000
@CH00459 DC    H'9'                                                     02877000
@CH00466 DC    H'13'                                                    02878000
@CH00216 DC    H'16'                                                    02879000
@CH01063 DC    H'71'                                                    02880000
@CH00548 DC    H'85'                                                    02881000
@CH01711 DC    H'120'                                                   02882000
@SC01727 CLC   SCPSTRNG(0,@01),0(@09)                                   02883000
@SM01737 MVC   SYSTLIB(0),SCPSTRNG(@01)                                 02884000
@SM01740 MVC   DLIBN(0),SCPSTRNG(@01)                                   02885000
@SM01742 MVC   CSECTN(0),SCPSTRNG(@01)                                  02886000
@SM01745 MVC   LMODNAM(0),SCPSTRNG(@01)                                 02887000
         DS    0F                                                       02888000
@SA00001 DS    18F                                                      02889000
@PC00001 DS    4F                                                       02890000
@SA00002 DS    15F                                                      02891000
@SA00003 DS    15F                                                      02892000
@SA00004 DS    15F                                                      02893000
@SA00010 DS    15F                                                      02894000
@SA00005 DS    15F                                                      02895000
@SA00006 DS    15F                                                      02896000
@SA00009 DS    15F                                                      02897000
@SA00008 DS    15F                                                      02898000
@SA00007 DS    0F                                                       02899000
@SA00011 DS    0F                                                       02900000
@PC00011 EQU   @SA00011+60                                              02901000
         DS    17F                                                      02902000
@AL00001 DS    2A                                                       02903000
@TF00001 DS    F                                                        02904000
         DS    0F                                                       02905000
@CF00048 DC    F'1'                                                     02906000
@CF00058 DC    F'2'                                                     02907000
@CF00062 DC    F'4'                                                     02908000
@CF00050 DC    F'7'                                                     02909000
@CF00043 DC    F'8'                                                     02910000
@CH00043 EQU   @CF00043+2                                               02911000
@CF00070 DC    F'15'                                                    02912000
@CF00538 DC    F'80'                                                    02913000
@CF00648 DC    F'255'                                                   02914000
@CV01382 DC    V(HMASMIO)                                               02915000
@CV01383 DC    V(HMASMCRD)                                              02916000
@CV01384 DC    V(HMASMGTA)                                              02917000
@CV01385 DC    V(HMASMBUE)                                              02918000
@CV01386 DC    V(HMASMSCN)                                              02919000
         DS    0D                                                       02920000
IOPPTR   DS    A                                                        02921000
SCPPTR   DS    A                                                        02922000
GTPPTR   DS    A                                                        02923000
TEMPPTR1 DS    A                                                        02924000
TEMPPTR2 DS    A                                                        02925000
I        DS    F                                                        02926000
J        DS    F                                                        02927000
K        DS    F                                                        02928000
SAVBUFAD DS    A                                                        02929000
MODKEYPT DS    A                                                        02930000
SYSLADDR DS    A                                                        02931000
SEQNO    DS    F                                                        02932000
CHRSEQNO DS    F                                                        02933000
SAVSEQNO DS    F                                                        02934000
LKDRBFSV DS    A                                                        02935000
LKDRTNCD DS    FL1                                                      02936000
JCLRC    DS    FL1                                                      02937000
CCRC     DS    FL1                                                      02938000
LMNRC    DS    FL1                                                      02939000
JRTRC    DS    FL1                                                      02940000
@TS00001 DS    CL8                                                      02941000
@CC01422 DC    C'PARMLIB '                                              02942000
@CC01424 DC    C'SYSLMOD '                                              02943000
@CC01426 DC    C'        '                                              02944000
@CC01418 DC    C'IEANUC0'                                               02945000
@CC01412 DC    C'MOD='                                                  02946000
@CC01405 DC    C'/*'                                                    02947000
@CC01407 DC    C'//'                                                    02948000
@CC01409 DC    C'++'                                                    02949000
NODSN    DC    CL25'NO DSNAME CODED          '                          02950000
NOSYSL   DC    CL25'NO SYSLMOD CARD FOUND    '                          02951000
LASTLINE DC    CL25'*****-LAST LINE PROCESSED'                          02952000
TBLOFLOW DC    CL25'*****-TABLE OVERFLOW     '                          02953000
CNTRLERR DC    CL25'ERROR IN LKED CNTRL STMT.'                          02954000
NOMODNM  DC    CL25'NO MODNAME FOUND IN STMT.'                          02955000
NOMODKEY DC    CL25'NO MOD KEYWORD FOUND     '                          02956000
INVALKEY DC    CL25'INVALID KEYWORD FOR MOD  '                          02957000
STOWERR  DC    CL25'ERROR ON MOD NAME STOW   '                          02958000
         DS    CL1                                                      02959000
LKDSCP   DS    CL26                                                     02960000
LMODNAM  DS    CL8                                                      02961000
SYSTLIB  DS    CL8                                                      02962000
FLAGSAV1 DS    CL1                                                      02963000
FLAGSAV2 DS    CL1                                                      02964000
FLAGSAV3 DS    CL1                                                      02965000
FLAGSAV4 DS    CL1                                                      02966000
FLAGSAV5 DS    CL1                                                      02967000
SAVRCD1  DS    CL80                                                     02968000
         DS    CL5                                                      02969000
DBLWRD   DS    CL8                                                      02970000
PATCHLKD DS    CL80                                                     02971000
         ORG   PATCHLKD                                                 02972000
@NM00182 DC    80X'FF'                                                  02973000
         ORG   PATCHLKD+80                                              02974000
SWITCHES DS    BL3                                                      02975000
         ORG   SWITCHES                                                 02976000
INTERR   DS    BL1                                                      02977000
EXCERR   EQU   SWITCHES+0                                               02978000
TBLEXC   EQU   SWITCHES+0                                               02979000
SYSLSW   EQU   SWITCHES+0                                               02980000
SYSTSW   EQU   SWITCHES+0                                               02981000
INCLPARM EQU   SWITCHES+0                                               02982000
INCLSYSL EQU   SWITCHES+0                                               02983000
INCLFND  EQU   SWITCHES+0                                               02984000
PARMEQSW DS    BL1                                                      02985000
CHREPFLG EQU   SWITCHES+1                                               02986000
CHREPFND EQU   SWITCHES+1                                               02987000
NAMEFND  EQU   SWITCHES+1                                               02988000
CCENTRD  EQU   SWITCHES+1                                               02989000
SYSTFND  EQU   SWITCHES+1                                               02990000
LMDFND   EQU   SWITCHES+1                                               02991000
STOWLMD  EQU   SWITCHES+1                                               02992000
JCLENSW  DS    BL1                                                      02993000
PREMSW   EQU   SWITCHES+2                                               02994000
@NM00183 EQU   SWITCHES+2                                               02995000
         ORG   SWITCHES+3                                               02996000
         DS    CL1                                                      02997000
MDDLBGTP DS    CL28                                                     02998000
MDDLBRCD DS    CL16                                                     02999000
         ORG   MDDLBRCD                                                 03000000
CSECTN   DS    CL8                                                      03001000
DLIBN    DS    CL8                                                      03002000
         ORG   MDDLBRCD+16                                              03003000
CCGTP    DS    CL28                                                     03004000
CCRCD    DS    CL85                                                     03005000
         ORG   CCRCD                                                    03006000
CCKEY    DS    CL5                                                      03007000
         ORG   CCKEY                                                    03008000
CCORDER  DS    FL1                                                      03009000
CCSEQNO  DS    FL4                                                      03010000
         ORG   CCRCD+5                                                  03011000
CCDATA   DS    CL80                                                     03012000
         ORG   CCDATA                                                   03013000
CCTYPE   DS    CL1                                                      03014000
CCMOD    DS    CL8                                                      03015000
CCDLIB   DS    CL8                                                      03016000
@NM00184 DS    CL55                                                     03017000
CCRCDNO  DS    CL8                                                      03018000
         ORG   CCRCDNO                                                  03019000
@NM00185 DS    CL7                                                      03020000
CCMAKPR  DS    BL1                                                      03021000
         ORG   CCRCD+85                                                 03022000
JCLINOUT DS    CL130                                                    03023000
         ORG   JCLINOUT                                                 03024000
@NM00186 DS    CL10                                                     03025000
PRNTMAP  DS    CL120                                                    03026000
         ORG   PRNTMAP                                                  03027000
@NM00187 DC    CL10'----------'                                         03028000
JCLINDAT DS    CL80                                                     03029000
@NM00188 DC    CL5' '                                                   03030000
JCLINACT DS    CL25                                                     03031000
         ORG   JCLINOUT+130                                             03032000
KEYS     DS    CL13                                                     03033000
         ORG   KEYS+0                                                   03034000
KEYWORD  DC    CL8'RENT'                                                03035000
KEYLEN   DC    AL1(4)                                                   03036000
KEYROUTS DC    AL4(KEY010)                                              03037000
         ORG   KEYS+13                                                  03038000
         ORG   KEYS+13                                                  03039000
         DC    CL8'REUS'                                                03040000
         DC    AL1(4)                                                   03041000
         DC    AL4(KEY020)                                              03042000
         ORG   KEYS+26                                                  03043000
         ORG   KEYS+26                                                  03044000
         DC    CL8'SCTR'                                                03045000
         DC    AL1(4)                                                   03046000
         DC    AL4(KEY030)                                              03047000
         ORG   KEYS+39                                                  03048000
         ORG   KEYS+39                                                  03049000
         DC    CL8'OVLY'                                                03050000
         DC    AL1(4)                                                   03051000
         DC    AL4(KEY040)                                              03052000
         ORG   KEYS+52                                                  03053000
         ORG   KEYS+52                                                  03054000
         DC    CL8'REFR'                                                03055000
         DC    AL1(4)                                                   03056000
         DC    AL4(KEY050)                                              03057000
         ORG   KEYS+65                                                  03058000
         ORG   KEYS+65                                                  03059000
         DC    CL8'DC'                                                  03060000
         DC    AL1(2)                                                   03061000
         DC    AL4(KEY060)                                              03062000
         ORG   KEYS+78                                                  03063000
         ORG   KEYS+78                                                  03064000
         DC    CL8'NE'                                                  03065000
         DC    AL1(2)                                                   03066000
         DC    AL4(KEY070)                                              03067000
         ORG   KEYS+91                                                  03068000
         ORG   KEYS+91                                                  03069000
         DC    CL8'AC=1'                                                03070000
         DC    AL1(4)                                                   03071000
         DC    AL4(KEY075)                                              03072000
         ORG   KEYS+104                                                 03073000
         ORG   KEYS+104                                                 03074000
         DC    CL8'SYSLMOD'                                             03075000
         DC    AL1(7)                                                   03076000
         DC    AL4(KEY080)                                              03077000
         ORG   KEYS+117                                                 03078000
         ORG   KEYS+117                                                 03079000
         DC    CL8'DSN='                                                03080000
         DC    AL1(4)                                                   03081000
         DC    AL4(KEY090)                                              03082000
         ORG   KEYS+130                                                 03083000
         ORG   KEYS+130                                                 03084000
         DC    CL8'DSNAME='                                             03085000
         DC    AL1(7)                                                   03086000
         DC    AL4(KEY090)                                              03087000
         ORG   KEYS+143                                                 03088000
         ORG   KEYS+143                                                 03089000
         DC    CL8'NAME='                                               03090000
         DC    AL1(5)                                                   03091000
         DC    AL4(KEY100)                                              03092000
         ORG   KEYS+156                                                 03093000
         ORG   KEYS+156                                                 03094000
         DC    CL8'ALIGN2'                                              03095000
         DC    AL1(6)                                                   03096000
         DC    AL4(KEY110)                                              03097000
         ORG   KEYS+169                                                 03098000
         ORG   KEYS+169                                                 03099000
         DC    CL8'COND='                                               03100000
         DC    AL1(5)                                                   03101000
         DC    AL4(KEY120)                                              03102000
         ORG   KEYS+182                                                 03103000
         ORG   KEYS+182                                                 03104000
         DC    CL8'PARM'                                                03105000
         DC    AL1(4)                                                   03106000
         DC    AL4(KEY130)                                              03107000
         ORG   KEYS+195                                                 03108000
HMASMLKD CSECT                                                          03109000
KINCLUDE DSCAN KEY='INCLUDE',ALT=KNAME,SUCC=KDLIBV                      03110000
KDLIBV   DSCAN MINLEN=1,MAXLEN=8,TYPE=AN,SUCC=KCSECTLP,ROUT=RDLIBV      03111000
KCSECTLP DSCAN KEY='(',SUCC=KCSECTV                                     03112000
KCSECTV  DSCAN MINLEN=1,MAXLEN=8,TYPE=AN,SUCC=KCSECTRP,ROUT=RCSECTV     03113000
KCSECTRP DSCAN KEY=')',ALT=KCSECTV,COMMA=NO                             03114000
KNAME    DSCAN KEY='NAME',ALT=KCHANGE,SUCC=KNAMEV                       03115000
KNAMEV   DSCAN MINLEN=1,MAXLEN=8,TYPE=AN,ROUT=RNAMEV                    03116000
KCHANGE  DSCAN KEY='CHANGE',ALT=KREPLACE,ROUT=RCHANGE                   03117000
KREPLACE DSCAN KEY='REPLACE',ALT=KLKDSVCC,ROUT=RREPLACE                 03118000
KLKDSVCC DSCAN MINLEN=0,ROUT=RLKDSVCC                                   03119000
HMASMLKD CSECT                                                          03120000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       03121000
@01      EQU   01                                                       03122000
@02      EQU   02                                                       03123000
@03      EQU   03                                                       03124000
@04      EQU   04                                                       03125000
@05      EQU   05                                                       03126000
@06      EQU   06                                                       03127000
@07      EQU   07                                                       03128000
@08      EQU   08                                                       03129000
@09      EQU   09                                                       03130000
@10      EQU   10                                                       03131000
@11      EQU   11                                                       03132000
@12      EQU   12                                                       03133000
@13      EQU   13                                                       03134000
@14      EQU   14                                                       03135000
@15      EQU   15                                                       03136000
CCAPTR   EQU   @11                                                      03137000
RTNCODE  EQU   @15                                                      03138000
RTNREG   EQU   @14                                                      03139000
HMASMCCA EQU   0                                                        03140000
CCAFBUFR EQU   HMASMCCA+4                                               03141000
CCADSAD  EQU   CCAFBUFR+124                                             03142000
CCATPAD  EQU   CCAFBUFR+128                                             03143000
CCAFLAG7 EQU   CCAFBUFR+132                                             03144000
CCAFIOP  EQU   HMASMCCA+140                                             03145000
CCAIOPTR EQU   CCAFIOP                                                  03146000
CCAFSYS  EQU   HMASMCCA+148                                             03147000
CCASREL  EQU   CCAFSYS+12                                               03148000
CCAFLAGA EQU   CCAFSYS+21                                               03149000
CCAFSTA  EQU   HMASMCCA+188                                             03150000
CCAFICT  EQU   HMASMCCA+192                                             03151000
CCAFPGM  EQU   HMASMCCA+208                                             03152000
CCABLDLP EQU   CCAFPGM                                                  03153000
CCADBLDL EQU   CCAFPGM+4                                                03154000
CCAFGTP  EQU   HMASMCCA+224                                             03155000
CCASEGTP EQU   CCAFGTP                                                  03156000
@NM00011 EQU   HMASMCCA+244                                             03157000
CCAFFUNC EQU   HMASMCCA+264                                             03158000
CCAFLAG1 EQU   CCAFFUNC+8                                               03159000
CCAFLAG2 EQU   CCAFFUNC+11                                              03160000
CCAFPROC EQU   HMASMCCA+276                                             03161000
CCAFLAG3 EQU   CCAFPROC                                                 03162000
CCAFDIS  EQU   HMASMCCA+278                                             03163000
CCAFLAG4 EQU   CCAFDIS                                                  03164000
CCAFLAG5 EQU   CCAFDIS+1                                                03165000
CCAFLAG6 EQU   CCAFDIS+2                                                03166000
CCAFCNV  EQU   HMASMCCA+281                                             03167000
CCAFLAG8 EQU   CCAFCNV                                                  03168000
CCAFCTL  EQU   HMASMCCA+282                                             03169000
CCAFLAG9 EQU   CCAFCTL                                                  03170000
CCAFDSNG EQU   HMASMCCA+298                                             03171000
CCAFLAGB EQU   CCAFDSNG                                                 03172000
CCABLDLA EQU   0                                                        03173000
@NM00027 EQU   CCABLDLA                                                 03174000
CCABLDLL EQU   0                                                        03175000
@NM00029 EQU   CCABLDLL                                                 03176000
CCALKDRC EQU   @NM00029+20                                              03177000
@NM00031 EQU   CCABLDLL+124                                             03178000
CCAASMRC EQU   @NM00031+20                                              03179000
@NM00033 EQU   CCABLDLL+248                                             03180000
CCACPYRC EQU   @NM00033+20                                              03181000
@NM00035 EQU   CCABLDLL+372                                             03182000
CCACOMRC EQU   @NM00035+20                                              03183000
@NM00037 EQU   CCABLDLL+496                                             03184000
CCAZAPRC EQU   @NM00037+20                                              03185000
@NM00039 EQU   CCABLDLL+620                                             03186000
CCASUPRC EQU   @NM00039+20                                              03187000
@NM00041 EQU   CCABLDLL+744                                             03188000
CCAUPDRC EQU   @NM00041+20                                              03189000
CCABLDLM EQU   0                                                        03190000
CCABELMT EQU   CCABLDLM+4                                               03191000
CCABMPOS EQU   CCABELMT                                                 03192000
HMASMIOP EQU   0                                                        03193000
IOPDSID  EQU   HMASMIOP                                                 03194000
IOPFUNCT EQU   HMASMIOP+1                                               03195000
IOPRETRN EQU   HMASMIOP+2                                               03196000
IOPTYPE  EQU   HMASMIOP+3                                               03197000
IOPNAME  EQU   HMASMIOP+4                                               03198000
@NM00045 EQU   HMASMIOP+12                                              03199000
@NM00046 EQU   @NM00045                                                 03200000
IOPDDNAM EQU   HMASMIOP+24                                              03201000
IOPBUFAD EQU   HMASMIOP+52                                              03202000
IOPDRMAP EQU   HMASMIOP+56                                              03203000
IOPINAME EQU   IOPDRMAP                                                 03204000
IOPINAM  EQU   IOPINAME                                                 03205000
IOPITYP  EQU   IOPINAM                                                  03206000
IOPUSERL EQU   IOPDRMAP+11                                              03207000
IOPEND   EQU   IOPDRMAP+12                                              03208000
IOPLMCTL EQU   0                                                        03209000
IOPLMCC  EQU   IOPLMCTL                                                 03210000
IOPLMCRN EQU   IOPLMCTL+1                                               03211000
IOPQSMIF EQU   0                                                        03212000
@NM00156 EQU   IOPQSMIF                                                 03213000
IOPQSMLS EQU   IOPQSMIF+8                                               03214000
IOPQSMNM EQU   IOPQSMLS                                                 03215000
IOPBS02  EQU   0                                                        03216000
IOPBS04  EQU   0                                                        03217000
IOPBAPF  EQU   IOPBS04                                                  03218000
HMASMPRL EQU   0                                                        03219000
PRLRLEN  EQU   HMASMPRL                                                 03220000
PRLSPAN  EQU   HMASMPRL+2                                               03221000
PRLFLGS  EQU   PRLSPAN                                                  03222000
PRLDATE  EQU   HMASMPRL+4                                               03223000
PRLTIME  EQU   HMASMPRL+7                                               03224000
PRLEND   EQU   HMASMPRL+10                                              03225000
HMASMSCP EQU   0                                                        03226000
SCPCHAR  EQU   HMASMSCP                                                 03227000
SCPSRCH  EQU   HMASMSCP+4                                               03228000
SCPIORTN EQU   HMASMSCP+12                                              03229000
SCPIOPAD EQU   HMASMSCP+16                                              03230000
SCPINLN  EQU   HMASMSCP+20                                              03231000
SCPPMLN  EQU   HMASMSCP+22                                              03232000
SCPEOR   EQU   HMASMSCP+24                                              03233000
SCPRETRN EQU   HMASMSCP+25                                              03234000
SCPRET   EQU   SCPRETRN                                                 03235000
SCPSTRNG EQU   0                                                        03236000
HMASMGTP EQU   0                                                        03237000
GTPFUNCT EQU   HMASMGTP                                                 03238000
GTPRETRN EQU   HMASMGTP+1                                               03239000
GTPRCDLN EQU   HMASMGTP+4                                               03240000
GTPKEYLN EQU   HMASMGTP+6                                               03241000
GTPBUFAD EQU   HMASMGTP+12                                              03242000
GTPRESTR EQU   HMASMGTP+16                                              03243000
GTPFLGS1 EQU   HMASMGTP+26                                              03244000
GTPPSIZE EQU   GTPFLGS1                                                 03245000
KEYROUT  EQU   0                                                        03246000
JCLLINE  EQU   0                                                        03247000
CCADSIDA EQU   0                                                        03248000
CCATYPEA EQU   0                                                        03249000
IOPBS01  EQU   0                                                        03250000
IOPBS03  EQU   0                                                        03251000
SCPIOPRM EQU   0                                                        03252000
BUPPARM  EQU   0                                                        03253000
BUPFUNCT EQU   BUPPARM                                                  03254000
BUPTYPE  EQU   BUPPARM+1                                                03255000
BUPFLAGS EQU   BUPPARM+3                                                03256000
BUPIOPAD EQU   BUPPARM+12                                               03257000
HMASMCRP EQU   0                                                        03258000
CRPSCPAD EQU   HMASMCRP+4                                               03259000
CRPINDS  EQU   HMASMCRP+8                                               03260000
CRPRETRN EQU   HMASMCRP+10                                              03261000
CRPFLG1  EQU   HMASMCRP+14                                              03262000
CRPFLG2  EQU   HMASMCRP+16                                              03263000
CRPINSW0 EQU   CRPFLG2                                                  03264000
CRPINSW1 EQU   CRPFLG2                                                  03265000
CRPINSW2 EQU   CRPFLG2                                                  03266000
CRPINSW3 EQU   CRPFLG2                                                  03267000
CRPBUFFR EQU   HMASMCRP+18                                              03268000
CRPBFCTL EQU   CRPBUFFR                                                 03269000
CRPBFDTA EQU   CRPBFCTL                                                 03270000
CRPBFCNT EQU   CRPBFCTL+71                                              03271000
BUFFER   EQU   0                                                        03272000
MAXJCL   EQU   0                                                        03273000
LINE     EQU   0                                                        03274000
ACTION   EQU   0                                                        03275000
IOPUDATA EQU   IOPEND                                                   03276000
IOPINAM3 EQU   IOPINAME                                                 03277000
@NM00052 EQU   IOPINAM3                                                 03278000
IOPSTCMP EQU   IOPUDATA                                                 03279000
IOPDYNDT EQU   IOPUDATA                                                 03280000
IOPSPACE EQU   IOPDYNDT+44                                              03281000
IOPDTYPE EQU   IOPDYNDT+50                                              03282000
IOPNTMAX EQU   IOPDRMAP                                                 03283000
IOPNTMAP EQU   IOPDRMAP                                                 03284000
IOPCDMAP EQU   IOPNTMAP                                                 03285000
IOPPTMAP EQU   IOPCDMAP                                                 03286000
IOPSCMAP EQU   IOPPTMAP                                                 03287000
IOPDIRCT EQU   IOPSCMAP+12                                              03288000
IOPCDMAX EQU   IOPDIRCT                                                 03289000
IOPCQMAP EQU   IOPDRMAP                                                 03290000
@NM00063 EQU   IOPUDATA                                                 03291000
@NM00064 EQU   IOPUDATA                                                 03292000
IOPASMNT EQU   IOPUDATA                                                 03293000
IOPASMDR EQU   IOPASMNT                                                 03294000
IOPNTLVL EQU   IOPASMDR                                                 03295000
IOPABUNT EQU   IOPASMDR+1                                               03296000
IOPLMDNT EQU   IOPUDATA                                                 03297000
IOPLMDDR EQU   IOPLMDNT                                                 03298000
IOPLMLEP EQU   IOPLMDDR+1                                               03299000
IOPLMDF1 EQU   IOPLMLEP                                                 03300000
IOPFLGS2 EQU   IOPLMDF1                                                 03301000
IOPAPF   EQU   IOPFLGS2                                                 03302000
IOPRENT  EQU   IOPFLGS2                                                 03303000
IOPREUS  EQU   IOPFLGS2                                                 03304000
IOPSCTR  EQU   IOPFLGS2                                                 03305000
IOPOVLY  EQU   IOPFLGS2                                                 03306000
IOPREFR  EQU   IOPFLGS2                                                 03307000
IOPDC    EQU   IOPFLGS2                                                 03308000
IOPLMDF2 EQU   IOPLMLEP+1                                               03309000
IOPNE    EQU   IOPLMDF2                                                 03310000
IOPPAGA  EQU   IOPLMDF2                                                 03311000
IOPLMDF3 EQU   IOPLMLEP+2                                               03312000
IOPLMDF4 EQU   IOPLMLEP+3                                               03313000
IOPLMDF5 EQU   IOPLMDDR+5                                               03314000
IOPFLGS3 EQU   IOPLMDF5                                                 03315000
IOPLINK  EQU   IOPFLGS3                                                 03316000
IOPCHREP EQU   IOPFLGS3                                                 03317000
IOPLMDFX EQU   IOPLMDNT+24                                              03318000
@NM00073 EQU   IOPLMDFX                                                 03319000
IOPLNTRY EQU   IOPLMDFX+8                                               03320000
IOPLSYS  EQU   IOPLNTRY                                                 03321000
IOPSYSLB EQU   IOPLSYS                                                  03322000
IOPLMDND EQU   IOPSYSLB                                                 03323000
IOPLMIND EQU   IOPLNTRY+8                                               03324000
IOPMACNT EQU   IOPUDATA                                                 03325000
IOPMACDR EQU   IOPMACNT                                                 03326000
IOPRMIDE EQU   IOPMACDR+1                                               03327000
IOPRMID  EQU   IOPRMIDE                                                 03328000
IOPRMST  EQU   IOPRMIDE+7                                               03329000
IOPFMIDE EQU   IOPMACDR+9                                               03330000
IOPFMID  EQU   IOPFMIDE                                                 03331000
IOPMACFX EQU   IOPMACNT+24                                              03332000
IOPBUNT  EQU   IOPMACFX                                                 03333000
IOPMCEND EQU   IOPMACNT+104                                             03334000
IOPMACVR EQU   IOPMCEND                                                 03335000
IOPMCENT EQU   IOPMACVR                                                 03336000
IOPMCDTA EQU   IOPMCENT                                                 03337000
IOPMCASM EQU   IOPMCDTA                                                 03338000
IOPMACID EQU   IOPMCASM                                                 03339000
IOPMACST EQU   IOPMCASM+7                                               03340000
IOPMCIND EQU   IOPMCENT+8                                               03341000
IOPEOFNT EQU   IOPUDATA                                                 03342000
IOPSRCNT EQU   IOPUDATA                                                 03343000
IOPSRCDR EQU   IOPSRCNT                                                 03344000
@NM00084 EQU   IOPSRCDR+1                                               03345000
@NM00086 EQU   @NM00084+7                                               03346000
@NM00090 EQU   IOPSRCDR+9                                               03347000
IOPSRCFX EQU   IOPSRCNT+24                                              03348000
@NM00094 EQU   IOPSRCFX                                                 03349000
IOPSREND EQU   IOPSRCNT+104                                             03350000
IOPSRCVR EQU   IOPSREND                                                 03351000
IOPSNTRY EQU   IOPSRCVR                                                 03352000
IOPSRDTA EQU   IOPSNTRY                                                 03353000
IOPSRCID EQU   IOPSRDTA                                                 03354000
IOPSRCST EQU   IOPSRDTA+7                                               03355000
IOPMODNT EQU   IOPUDATA                                                 03356000
IOPMODDR EQU   IOPMODNT                                                 03357000
@NM00100 EQU   IOPMODDR+1                                               03358000
@NM00102 EQU   @NM00100+7                                               03359000
@NM00106 EQU   IOPMODDR+9                                               03360000
IOPMODFX EQU   IOPMODNT+24                                              03361000
@NM00110 EQU   IOPMODFX                                                 03362000
IOPMDLEP EQU   IOPMODFX+8                                               03363000
IOPMODF1 EQU   IOPMDLEP                                                 03364000
IOPMODF2 EQU   IOPMDLEP+1                                               03365000
IOPMODF3 EQU   IOPMDLEP+2                                               03366000
IOPMODF4 EQU   IOPMDLEP+3                                               03367000
IOPDLIB  EQU   IOPMODFX+72                                              03368000
IOPMDEND EQU   IOPMODNT+104                                             03369000
IOPMODVR EQU   IOPMDEND                                                 03370000
IOPMNTRY EQU   IOPMODVR                                                 03371000
IOPMDDTA EQU   IOPMNTRY                                                 03372000
IOPLMODS EQU   IOPMDDTA                                                 03373000
IOPMODID EQU   IOPLMODS                                                 03374000
IOPMODND EQU   IOPMODID                                                 03375000
IOPMODST EQU   IOPLMODS+7                                               03376000
IOPMDIND EQU   IOPMNTRY+8                                               03377000
IOPDLBNT EQU   IOPUDATA                                                 03378000
IOPDLBDR EQU   IOPDLBNT                                                 03379000
IOPDLBFX EQU   IOPDLBNT+24                                              03380000
@NM00121 EQU   IOPDLBFX                                                 03381000
IOPDLEND EQU   IOPDLBNT+104                                             03382000
IOPDLBVR EQU   IOPDLEND                                                 03383000
IOPDNTRY EQU   IOPDLBVR                                                 03384000
IOPDSYS  EQU   IOPDNTRY                                                 03385000
IOPSYSNT EQU   IOPUDATA                                                 03386000
IOPSYSDR EQU   IOPSYSNT                                                 03387000
IOPSYSF1 EQU   IOPSYSDR+4                                               03388000
IOPFLGS7 EQU   IOPSYSF1                                                 03389000
IOPSYSFX EQU   IOPSYSNT+24                                              03390000
@NM00128 EQU   IOPSYSFX                                                 03391000
IOPSYEND EQU   IOPSYSNT+184                                             03392000
IOPSYSVR EQU   IOPSYEND                                                 03393000
IOPSYSTR EQU   IOPSYSVR                                                 03394000
IOPSYNTR EQU   IOPSYSTR                                                 03395000
IOPPTFNT EQU   IOPUDATA                                                 03396000
IOPPTFDR EQU   IOPPTFNT                                                 03397000
IOPPSTAT EQU   IOPPTFDR+2                                               03398000
IOPPTFF1 EQU   IOPPSTAT                                                 03399000
IOPFLGS5 EQU   IOPPTFF1                                                 03400000
IOPPTFF2 EQU   IOPPSTAT+1                                               03401000
IOPPTFF3 EQU   IOPPSTAT+3                                               03402000
IOPPTFFX EQU   IOPPTFNT+24                                              03403000
@NM00137 EQU   IOPPTFFX                                                 03404000
@NM00138 EQU   @NM00137                                                 03405000
IOPPDTES EQU   IOPPTFFX+41                                              03406000
@NM00141 EQU   IOPPDTES                                                 03407000
IOPPTPFX EQU   IOPPDTES+6                                               03408000
IOPDATES EQU   IOPPTPFX                                                 03409000
IOPPTEND EQU   IOPPTFNT+104                                             03410000
IOPPTFVR EQU   IOPPTEND                                                 03411000
IOPPNTRY EQU   IOPPTFVR                                                 03412000
IOPPMODS EQU   IOPPNTRY                                                 03413000
IOPENTNT EQU   IOPUDATA+104                                             03414000
IOPSRLNT EQU   IOPUDATA+104                                             03415000
IOPPRENT EQU   IOPUDATA+104                                             03416000
IOPNPRNT EQU   IOPUDATA+104                                             03417000
IOPSUPNT EQU   IOPUDATA+104                                             03418000
IOPREQNT EQU   IOPUDATA+104                                             03419000
IOPIRQNT EQU   IOPUDATA+104                                             03420000
IOPFIDNT EQU   IOPUDATA+104                                             03421000
IOPDELNT EQU   IOPUDATA+104                                             03422000
IOPVERNT EQU   IOPUDATA+104                                             03423000
IOPSBYNT EQU   IOPUDATA+104                                             03424000
IOPQSMNT EQU   IOPUDATA                                                 03425000
IOPQSMDR EQU   IOPQSMNT                                                 03426000
IOPQFMNT EQU   IOPUDATA                                                 03427000
IOPQFMDR EQU   IOPQFMNT                                                 03428000
IOPQFEND EQU   IOPQFMNT+2                                               03429000
IOPQFMVR EQU   IOPQFEND                                                 03430000
IOPQFMLS EQU   IOPQFMVR                                                 03431000
IOPQFMNM EQU   IOPQFMLS                                                 03432000
IOPPTSYS EQU   IOPUDATA                                                 03433000
IOPPTSDR EQU   IOPPTSYS                                                 03434000
IOPPTSFX EQU   IOPPTSYS+24                                              03435000
IOPDSSPC EQU   IOPPTSFX                                                 03436000
IOPPTFG1 EQU   IOPPTSFX+34                                              03437000
IOPPSEND EQU   IOPPTSYS+1064                                            03438000
IOPPTSVR EQU   IOPPSEND                                                 03439000
IOPPTNTR EQU   IOPPTSVR                                                 03440000
@NM00166 EQU   IOPPTNTR                                                 03441000
IOPPTFMD EQU   @NM00166                                                 03442000
IOPPTREL EQU   IOPPTFMD                                                 03443000
IOPBPDS  EQU   IOPUDATA                                                 03444000
IOPBLEP1 EQU   IOPBPDS+8                                                03445000
IOPBLEP2 EQU   IOPBPDS+9                                                03446000
@NM00170 EQU   IOPBPDS+18                                               03447000
IOPBFTB0 EQU   @NM00170                                                 03448000
IOPBFTB1 EQU   IOPBFTB0                                                 03449000
PRLDATA  EQU   PRLEND                                                   03450000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    03451000
IOPBCEND EQU   IOPBPDS+21                                               03452000
IOPBFTB3 EQU   IOPBFTB0+2                                               03453000
IOPBFTB2 EQU   IOPBFTB0+1                                               03454000
@NM00172 EQU   IOPBFTB1                                                 03455000
IOPBAPFP EQU   IOPBFTB1                                                 03456000
IOPBSSI  EQU   IOPBFTB1                                                 03457000
IOPBPAGA EQU   IOPBFTB1                                                 03458000
@NM00171 EQU   IOPBFTB1                                                 03459000
IOPBAOSL EQU   IOPBFTB1                                                 03460000
IOPBSEPA EQU   IOPBPDS+15                                               03461000
IOPBFTBL EQU   IOPBPDS+13                                               03462000
IOPBSTOR EQU   IOPBPDS+10                                               03463000
IOPBREFR EQU   IOPBLEP2                                                 03464000
IOPBLEF  EQU   IOPBLEP2                                                 03465000
IOPBTEST EQU   IOPBLEP2                                                 03466000
IOPBNE   EQU   IOPBLEP2                                                 03467000
@NM00169 EQU   IOPBLEP2                                                 03468000
IOPBDC   EQU   IOPBLEP2                                                 03469000
@NM00168 EQU   IOPBLEP1                                                 03470000
IOPBSCTR EQU   IOPBLEP1                                                 03471000
IOPBOL   EQU   IOPBLEP1                                                 03472000
@NM00167 EQU   IOPBLEP1                                                 03473000
IOPBOVLY EQU   IOPBLEP1                                                 03474000
IOPBREUS EQU   IOPBLEP1                                                 03475000
IOPBRENT EQU   IOPBLEP1                                                 03476000
IOPBNL   EQU   IOPBPDS+7                                                03477000
IOPBTTRN EQU   IOPBPDS+4                                                03478000
IOPBZERO EQU   IOPBPDS+3                                                03479000
IOPBTTRT EQU   IOPBPDS                                                  03480000
IOPPTIND EQU   IOPPTNTR+8                                               03481000
IOPPTSND EQU   IOPPTREL                                                 03482000
@NM00165 EQU   IOPPTSFX+872                                             03483000
IOPSYZPP EQU   IOPPTSFX+772                                             03484000
IOPSYZPR EQU   IOPPTSFX+771                                             03485000
IOPSYZPS EQU   IOPPTSFX+763                                             03486000
IOPSYZAP EQU   IOPPTSFX+755                                             03487000
IOPSYUPP EQU   IOPPTSFX+655                                             03488000
IOPSYUPR EQU   IOPPTSFX+654                                             03489000
IOPSYUPS EQU   IOPPTSFX+646                                             03490000
IOPSYUPD EQU   IOPPTSFX+638                                             03491000
IOPSYSPP EQU   IOPPTSFX+538                                             03492000
IOPSYSPR EQU   IOPPTSFX+537                                             03493000
IOPSYSPS EQU   IOPPTSFX+529                                             03494000
IOPSYSUP EQU   IOPPTSFX+521                                             03495000
IOPSYLKP EQU   IOPPTSFX+421                                             03496000
IOPSYLKR EQU   IOPPTSFX+420                                             03497000
IOPSYLKS EQU   IOPPTSFX+412                                             03498000
IOPSYLKD EQU   IOPPTSFX+404                                             03499000
IOPSYCPP EQU   IOPPTSFX+304                                             03500000
IOPSYCPR EQU   IOPPTSFX+303                                             03501000
IOPSYCPS EQU   IOPPTSFX+295                                             03502000
IOPSYCPY EQU   IOPPTSFX+287                                             03503000
IOPSYCOP EQU   IOPPTSFX+187                                             03504000
IOPSYCOR EQU   IOPPTSFX+186                                             03505000
IOPSYCOS EQU   IOPPTSFX+178                                             03506000
IOPSYCOM EQU   IOPPTSFX+170                                             03507000
IOPSYASP EQU   IOPPTSFX+70                                              03508000
IOPSYASR EQU   IOPPTSFX+69                                              03509000
IOPSYASS EQU   IOPPTSFX+61                                              03510000
IOPSYASM EQU   IOPPTSFX+53                                              03511000
@NM00164 EQU   IOPPTSFX+35                                              03512000
@NM00163 EQU   IOPPTFG1                                                 03513000
IOPPTSNJ EQU   IOPPTFG1                                                 03514000
IOPPTSNP EQU   IOPPTFG1                                                 03515000
IOPSYPLN EQU   IOPPTSFX+32                                              03516000
IOPDSPFX EQU   IOPPTSFX+6                                               03517000
IOPDSDIR EQU   IOPDSSPC+4                                               03518000
IOPDSSEC EQU   IOPDSSPC+2                                               03519000
IOPDSPRM EQU   IOPDSSPC                                                 03520000
@NM00162 EQU   IOPPTSDR+4                                               03521000
IOPPTPEM EQU   IOPPTSDR+2                                               03522000
IOPPCNVL EQU   IOPPTSDR+1                                               03523000
@NM00161 EQU   IOPPTSDR                                                 03524000
IOPQFMTP EQU   IOPQFMLS+8                                               03525000
@NM00160 EQU   IOPQFMLS+7                                               03526000
IOPQFMND EQU   IOPQFMNM                                                 03527000
@NM00159 EQU   IOPQFMDR                                                 03528000
@NM00155 EQU   IOPQSMDR                                                 03529000
@NM00154 EQU   IOPSBYNT+8                                               03530000
IOPSBYST EQU   IOPSBYNT+7                                               03531000
IOPSBYNM EQU   IOPSBYNT                                                 03532000
@NM00153 EQU   IOPVERNT+8                                               03533000
IOPVERST EQU   IOPVERNT+7                                               03534000
IOPVERNM EQU   IOPVERNT                                                 03535000
@NM00152 EQU   IOPDELNT+8                                               03536000
IOPDELST EQU   IOPDELNT+7                                               03537000
IOPDELNM EQU   IOPDELNT                                                 03538000
@NM00151 EQU   IOPFIDNT+8                                               03539000
IOPFIDST EQU   IOPFIDNT+7                                               03540000
IOPFIDNM EQU   IOPFIDNT                                                 03541000
@NM00150 EQU   IOPIRQNT+8                                               03542000
IOPIRQST EQU   IOPIRQNT+7                                               03543000
IOPIRQNM EQU   IOPIRQNT                                                 03544000
@NM00149 EQU   IOPREQNT+8                                               03545000
IOPREQST EQU   IOPREQNT+7                                               03546000
IOPREQNM EQU   IOPREQNT                                                 03547000
@NM00148 EQU   IOPSUPNT+8                                               03548000
IOPSUPST EQU   IOPSUPNT+7                                               03549000
IOPSUPNM EQU   IOPSUPNT                                                 03550000
@NM00147 EQU   IOPNPRNT+8                                               03551000
IOPNPRST EQU   IOPNPRNT+7                                               03552000
IOPNPRNM EQU   IOPNPRNT                                                 03553000
@NM00146 EQU   IOPPRENT+8                                               03554000
IOPPREST EQU   IOPPRENT+7                                               03555000
IOPPRENM EQU   IOPPRENT                                                 03556000
@NM00145 EQU   IOPSRLNT+8                                               03557000
IOPSRLST EQU   IOPSRLNT+7                                               03558000
@NM00144 EQU   IOPSRLNT+4                                               03559000
IOPSRLNM EQU   IOPSRLNT                                                 03560000
@NM00143 EQU   IOPENTNT+8                                               03561000
IOPENTST EQU   IOPENTNT+7                                               03562000
IOPENTNM EQU   IOPENTNT                                                 03563000
IOPPIND  EQU   IOPPNTRY+8                                               03564000
IOPPTFND EQU   IOPPMODS                                                 03565000
IOPPFMID EQU   IOPPTFFX+73                                              03566000
@NM00142 EQU   IOPPTPFX+24                                              03567000
IOPUCLT  EQU   IOPDATES+21                                              03568000
IOPUCLD  EQU   IOPDATES+18                                              03569000
IOPACCT  EQU   IOPDATES+15                                              03570000
IOPACCD  EQU   IOPDATES+12                                              03571000
IOPRSTT  EQU   IOPDATES+9                                               03572000
IOPRSTD  EQU   IOPDATES+6                                               03573000
IOPAPPT  EQU   IOPDATES+3                                               03574000
IOPAPPD  EQU   IOPDATES                                                 03575000
IOPRECT  EQU   @NM00141+3                                               03576000
IOPRECD  EQU   @NM00141                                                 03577000
@NM00140 EQU   IOPPTFFX+8                                               03578000
@NM00139 EQU   @NM00137+7                                               03579000
IOPPRELN EQU   @NM00138                                                 03580000
@NM00136 EQU   IOPPTFDR+20                                              03581000
IOPSBYNO EQU   IOPPTFDR+13                                              03582000
IOPDBYNO EQU   IOPPTFDR+6                                               03583000
@NM00135 EQU   IOPPTFF3                                                 03584000
IOPFLF   EQU   IOPPTFF3                                                 03585000
IOPDBYP  EQU   IOPPTFF3                                                 03586000
IOPSBYP  EQU   IOPPTFF3                                                 03587000
IOPPMDLP EQU   IOPPTFF2+1                                               03588000
IOPPADDP EQU   IOPPTFF2+1                                               03589000
@NM00134 EQU   IOPPTFF2+1                                               03590000
IOPLRFP  EQU   IOPPTFF2                                                 03591000
IOPJCLP  EQU   IOPPTFF2                                                 03592000
IOPSUPP  EQU   IOPPTFF2                                                 03593000
IOPREQP  EQU   IOPPTFF2                                                 03594000
IOPPREP  EQU   IOPPTFF2                                                 03595000
IOPNPRP  EQU   IOPPTFF2                                                 03596000
IOPIRQP  EQU   IOPPTFF2                                                 03597000
IOPDELP  EQU   IOPPTFF2                                                 03598000
IOPREGEN EQU   IOPFLGS5                                                 03599000
IOPBYP   EQU   IOPFLGS5                                                 03600000
IOPDUMMP EQU   IOPFLGS5                                                 03601000
@NM00133 EQU   IOPFLGS5                                                 03602000
IOPERROR EQU   IOPFLGS5                                                 03603000
IOPACC   EQU   IOPFLGS5                                                 03604000
IOPRES   EQU   IOPFLGS5                                                 03605000
IOPAPP   EQU   IOPFLGS5                                                 03606000
IOPPTYPE EQU   IOPPTFDR+1                                               03607000
@NM00132 EQU   IOPPTFDR                                                 03608000
IOPSYSTP EQU   IOPSYSTR+8                                               03609000
IOPSYSND EQU   IOPSYNTR                                                 03610000
@NM00131 EQU   IOPSYSFX+21                                              03611000
IOPSYSID EQU   IOPSYSFX+13                                              03612000
IOPNUCID EQU   IOPSYSFX+12                                              03613000
IOPSREL  EQU   IOPSYSFX+8                                               03614000
@NM00130 EQU   @NM00128+7                                               03615000
@NM00129 EQU   @NM00128                                                 03616000
@NM00127 EQU   IOPSYSDR+5                                               03617000
@NM00126 EQU   IOPFLGS7                                                 03618000
IOPSYNG  EQU   IOPFLGS7                                                 03619000
IOPSYDL  EQU   IOPFLGS7                                                 03620000
IOPSTSNP EQU   IOPFLGS7                                                 03621000
IOPMTSNP EQU   IOPFLGS7                                                 03622000
IOPPEMAX EQU   IOPSYSDR+2                                               03623000
IOPSCNVL EQU   IOPSYSDR+1                                               03624000
@NM00125 EQU   IOPSYSDR                                                 03625000
IOPDLIND EQU   IOPDNTRY+8                                               03626000
IOPDLBND EQU   IOPDSYS                                                  03627000
@NM00124 EQU   IOPDLBFX+8                                               03628000
@NM00123 EQU   @NM00121+7                                               03629000
@NM00122 EQU   @NM00121                                                 03630000
@NM00120 EQU   IOPDLBDR+1                                               03631000
@NM00119 EQU   IOPDLBDR                                                 03632000
@NM00118 EQU   IOPMODST                                                 03633000
@NM00117 EQU   IOPMODFX+12                                              03634000
@NM00116 EQU   IOPMODF4                                                 03635000
@NM00115 EQU   IOPMODF3                                                 03636000
@NM00114 EQU   IOPMODF2                                                 03637000
IOPMPAGA EQU   IOPMODF2                                                 03638000
IOPMNE   EQU   IOPMODF2                                                 03639000
@NM00113 EQU   IOPMODF1                                                 03640000
IOPMDC   EQU   IOPMODF1                                                 03641000
IOPMREFR EQU   IOPMODF1                                                 03642000
IOPMOVLY EQU   IOPMODF1                                                 03643000
IOPMSCTR EQU   IOPMODF1                                                 03644000
IOPMREUS EQU   IOPMODF1                                                 03645000
IOPMRENT EQU   IOPMODF1                                                 03646000
IOPMAPF  EQU   IOPMODF1                                                 03647000
@NM00112 EQU   @NM00110+7                                               03648000
@NM00111 EQU   @NM00110                                                 03649000
@NM00109 EQU   IOPMODDR+17                                              03650000
@NM00108 EQU   @NM00106+7                                               03651000
@NM00107 EQU   @NM00106                                                 03652000
@NM00105 EQU   @NM00102                                                 03653000
@NM00104 EQU   @NM00102                                                 03654000
@NM00103 EQU   @NM00102                                                 03655000
@NM00101 EQU   @NM00100                                                 03656000
@NM00099 EQU   IOPMODDR                                                 03657000
IOPSRIND EQU   IOPSNTRY+8                                               03658000
@NM00098 EQU   IOPSRCST                                                 03659000
IOPSRCND EQU   IOPSRCID                                                 03660000
IOPSRDLB EQU   IOPSRCFX+72                                              03661000
IOPSRSYS EQU   IOPSRCFX+64                                              03662000
@NM00097 EQU   IOPSRCFX+8                                               03663000
@NM00096 EQU   @NM00094+7                                               03664000
@NM00095 EQU   @NM00094                                                 03665000
@NM00093 EQU   IOPSRCDR+18                                              03666000
IOPSRLNG EQU   IOPSRCDR+17                                              03667000
@NM00092 EQU   @NM00090+7                                               03668000
@NM00091 EQU   @NM00090                                                 03669000
@NM00089 EQU   @NM00086                                                 03670000
@NM00088 EQU   @NM00086                                                 03671000
@NM00087 EQU   @NM00086                                                 03672000
@NM00085 EQU   @NM00084                                                 03673000
@NM00083 EQU   IOPSRCDR                                                 03674000
IOPEOFND EQU   IOPEOFNT                                                 03675000
IOPMCTYP EQU   IOPMCIND                                                 03676000
@NM00082 EQU   IOPMACST                                                 03677000
IOPMACND EQU   IOPMACID                                                 03678000
IOPMCDLB EQU   IOPMACFX+72                                              03679000
IOPMCSYS EQU   IOPMACFX+64                                              03680000
@NM00081 EQU   IOPMACFX+8                                               03681000
IOPBUTYP EQU   IOPBUNT+7                                                03682000
IOPBUSMD EQU   IOPBUNT                                                  03683000
@NM00080 EQU   IOPMACDR+18                                              03684000
IOPMCLNG EQU   IOPMACDR+17                                              03685000
IOPFMST  EQU   IOPFMIDE+7                                               03686000
@NM00079 EQU   IOPRMST                                                  03687000
IOPRMASM EQU   IOPRMST                                                  03688000
@NM00078 EQU   IOPRMST                                                  03689000
@NM00077 EQU   IOPMACDR                                                 03690000
@NM00075 EQU   @NM00073+7                                               03691000
@NM00074 EQU   @NM00073                                                 03692000
@NM00072 EQU   IOPLMDDR+6                                               03693000
@NM00071 EQU   IOPFLGS3                                                 03694000
IOPCOPY  EQU   IOPFLGS3                                                 03695000
@NM00070 EQU   IOPLMDF4                                                 03696000
@NM00069 EQU   IOPLMDF3                                                 03697000
@NM00068 EQU   IOPLMDF2                                                 03698000
@NM00067 EQU   IOPFLGS2                                                 03699000
@NM00066 EQU   IOPLMDDR                                                 03700000
@NM00065 EQU   IOPASMDR+9                                               03701000
IOPABUTP EQU   IOPABUNT+7                                               03702000
IOPABUPT EQU   IOPABUNT                                                 03703000
IOPALLOC EQU   @NM00064+4                                               03704000
IOPUSED  EQU   @NM00064                                                 03705000
IOPTPSEQ EQU   @NM00063+8                                               03706000
IOPVLSER EQU   @NM00063+2                                               03707000
IOPBLKSI EQU   @NM00063                                                 03708000
IOPCQMAX EQU   IOPCQMAP+12                                              03709000
@NM00062 EQU   IOPCQMAP+11                                              03710000
@NM00061 EQU   IOPCQMAP+8                                               03711000
@NM00060 EQU   IOPCQMAP                                                 03712000
IOPPTMAX EQU   IOPCDMAX                                                 03713000
@NM00059 EQU   IOPSCMAP+11                                              03714000
@NM00058 EQU   IOPSCMAP+8                                               03715000
@NM00057 EQU   IOPSCMAP                                                 03716000
IOPDIRMX EQU   IOPNTMAX+12                                              03717000
@NM00056 EQU   IOPNTMAX+11                                              03718000
@NM00055 EQU   IOPNTMAX+8                                               03719000
@NM00054 EQU   IOPNTMAX                                                 03720000
@NM00053 EQU   IOPDTYPE                                                 03721000
IOPDMOD  EQU   IOPDTYPE                                                 03722000
IOPDJCL  EQU   IOPDTYPE                                                 03723000
IOPDSRC  EQU   IOPDTYPE                                                 03724000
IOPDMAC  EQU   IOPDTYPE                                                 03725000
IOPSDIR  EQU   IOPSPACE+4                                               03726000
IOPSSCND EQU   IOPSPACE+2                                               03727000
IOPSPRIM EQU   IOPSPACE                                                 03728000
IOPDSN   EQU   IOPDYNDT                                                 03729000
IOPNTYPE EQU   IOPSTCMP+17                                              03730000
IOPNNAME EQU   IOPSTCMP+9                                               03731000
IOPOTYPE EQU   IOPSTCMP+8                                               03732000
IOPONAME EQU   IOPSTCMP                                                 03733000
IOPISEQ3 EQU   IOPINAM3+6                                               03734000
IOPITYP3 EQU   @NM00052+5                                               03735000
IOPIPTF3 EQU   @NM00052                                                 03736000
CRPDDNAM EQU   HMASMCRP+98                                              03737000
CRPBFSEQ EQU   CRPBUFFR+72                                              03738000
CRPINSWF EQU   CRPFLG2+1                                                03739000
CRPINSWE EQU   CRPFLG2+1                                                03740000
CRPINSWD EQU   CRPFLG2+1                                                03741000
CRPINSWC EQU   CRPFLG2+1                                                03742000
CRPINSWB EQU   CRPFLG2+1                                                03743000
CRPINSWA EQU   CRPFLG2+1                                                03744000
CRPINSW9 EQU   CRPFLG2+1                                                03745000
CRPINSW8 EQU   CRPFLG2+1                                                03746000
CRPINSW7 EQU   CRPFLG2                                                  03747000
CRPINSW6 EQU   CRPFLG2                                                  03748000
CRPINSW5 EQU   CRPFLG2                                                  03749000
CRPINSW4 EQU   CRPFLG2                                                  03750000
CRPEOF1  EQU   CRPINSW3                                                 03751000
CRPWRTLG EQU   CRPINSW2                                                 03752000
CRPEXADD EQU   CRPINSW1                                                 03753000
CRPEOFSW EQU   CRPINSW0                                                 03754000
@NM00177 EQU   CRPFLG1+1                                                03755000
CRPRPT   EQU   CRPFLG1+1                                                03756000
CRPLIST  EQU   CRPFLG1+1                                                03757000
CRPNOWPP EQU   CRPFLG1+1                                                03758000
CRPTRMEX EQU   CRPFLG1+1                                                03759000
CRPEOFEN EQU   CRPFLG1+1                                                03760000
CRPSCNCL EQU   CRPFLG1                                                  03761000
CRPOFFST EQU   CRPFLG1                                                  03762000
CRPOTHER EQU   CRPFLG1                                                  03763000
CRPPRINT EQU   CRPFLG1                                                  03764000
CRPLOG   EQU   CRPFLG1                                                  03765000
CRPPTS   EQU   CRPFLG1                                                  03766000
CRPLOGCK EQU   CRPFLG1                                                  03767000
CRPBFPRM EQU   CRPFLG1                                                  03768000
@NM00176 EQU   HMASMCRP+11                                              03769000
CRPOUTDS EQU   HMASMCRP+9                                               03770000
@NM00175 EQU   HMASMCRP+1                                               03771000
CRPUXNUM EQU   HMASMCRP                                                 03772000
BUPGTPAD EQU   BUPPARM+16                                               03773000
@NM00002 EQU   BUPPARM+11                                               03774000
BUPSYSMD EQU   BUPPARM+4                                                03775000
@NM00001 EQU   BUPFLAGS                                                 03776000
BUPREDO  EQU   BUPFLAGS                                                 03777000
BUPSTYPE EQU   BUPPARM+2                                                03778000
@NM00181 EQU   HMASMGTP+27                                              03779000
@NM00180 EQU   GTPFLGS1                                                 03780000
GTPRCDNF EQU   GTPFLGS1                                                 03781000
GTPNOSPM EQU   GTPFLGS1                                                 03782000
GTPPOS   EQU   GTPRESTR+8                                               03783000
GTPRCD   EQU   GTPRESTR+4                                               03784000
GTPPAG   EQU   GTPRESTR                                                 03785000
GTPWKAD  EQU   HMASMGTP+8                                               03786000
@NM00179 EQU   HMASMGTP+2                                               03787000
@NM00178 EQU   SCPEOR                                                   03788000
SCPNORT  EQU   SCPEOR                                                   03789000
SCPNOSUC EQU   SCPEOR                                                   03790000
SCPRTERR EQU   SCPEOR                                                   03791000
SCPCOMNT EQU   SCPEOR                                                   03792000
SCPNOCT  EQU   SCPEOR                                                   03793000
SCPCONT  EQU   SCPEOR                                                   03794000
SCPWKAR  EQU   HMASMSCP+8                                               03795000
PRLCONC  EQU   PRLTIME+2                                                03796000
@NM00174 EQU   PRLTIME                                                  03797000
PRLHDADR EQU   PRLDATE                                                  03798000
@NM00173 EQU   PRLFLGS                                                  03799000
PRLBLANK EQU   PRLFLGS                                                  03800000
PRLHEADO EQU   PRLFLGS                                                  03801000
PRLHEAD  EQU   PRLFLGS                                                  03802000
IOPBS04E EQU   IOPBS04+2                                                03803000
IOPBAPFC EQU   IOPBAPF+1                                                03804000
IOPBAPFL EQU   IOPBAPF                                                  03805000
IOPBS2NM EQU   IOPBS02+3                                                03806000
IOPBS2EP EQU   IOPBS02                                                  03807000
IOPQSMTP EQU   IOPQSMLS+8                                               03808000
@NM00158 EQU   IOPQSMLS+7                                               03809000
IOPQSMND EQU   IOPQSMNM                                                 03810000
@NM00157 EQU   @NM00156+7                                               03811000
IOPQSMFM EQU   @NM00156                                                 03812000
@NM00076 EQU   IOPLMCTL+17                                              03813000
IOPLMCRD EQU   IOPLMCTL+9                                               03814000
@NM00051 EQU   IOPUSERL                                                 03815000
@NM00050 EQU   IOPUSERL                                                 03816000
IOPALIS  EQU   IOPUSERL                                                 03817000
IOPTTR   EQU   IOPDRMAP+8                                               03818000
IOPINAM2 EQU   IOPINAM+1                                                03819000
IOPITYP2 EQU   IOPITYP                                                  03820000
@NM00049 EQU   HMASMIOP+32                                              03821000
IOPDELDD EQU   IOPDDNAM                                                 03822000
@NM00048 EQU   @NM00045+10                                              03823000
IOPSEQNO EQU   @NM00045+8                                               03824000
@NM00047 EQU   @NM00046+7                                               03825000
IOPPTFNM EQU   @NM00046                                                 03826000
IOPNAM17 EQU   IOPNAME                                                  03827000
CCABMREC EQU   CCABELMT+10                                              03828000
CCABPOS  EQU   CCABMPOS+8                                               03829000
CCABNAME EQU   CCABMPOS                                                 03830000
@NM00044 EQU   CCABLDLM+2                                               03831000
@NM00043 EQU   CCABLDLM                                                 03832000
CCAUPDPM EQU   @NM00041+24                                              03833000
@NM00042 EQU   @NM00041+21                                              03834000
CCARUPDT EQU   CCAUPDRC                                                 03835000
CCAUPDSP EQU   @NM00041+12                                              03836000
CCAUPDTE EQU   @NM00041+8                                               03837000
CCAUPDNM EQU   @NM00041                                                 03838000
CCASUPPM EQU   @NM00039+24                                              03839000
@NM00040 EQU   @NM00039+21                                              03840000
CCARSUP  EQU   CCASUPRC                                                 03841000
CCASUPSP EQU   @NM00039+12                                              03842000
CCAIOSUP EQU   @NM00039+8                                               03843000
CCASUPNM EQU   @NM00039                                                 03844000
CCAZAPPM EQU   @NM00037+24                                              03845000
@NM00038 EQU   @NM00037+21                                              03846000
CCARZAP  EQU   CCAZAPRC                                                 03847000
CCAZAPSP EQU   @NM00037+12                                              03848000
CCASPZAP EQU   @NM00037+8                                               03849000
CCAZAPNM EQU   @NM00037                                                 03850000
CCACOMPM EQU   @NM00035+24                                              03851000
@NM00036 EQU   @NM00035+21                                              03852000
CCARCOMP EQU   CCACOMRC                                                 03853000
CCACOMSP EQU   @NM00035+12                                              03854000
CCACOMRS EQU   @NM00035+8                                               03855000
CCACOMNM EQU   @NM00035                                                 03856000
CCACPYPM EQU   @NM00033+24                                              03857000
@NM00034 EQU   @NM00033+21                                              03858000
CCARCOPY EQU   CCACPYRC                                                 03859000
CCACPYSP EQU   @NM00033+12                                              03860000
CCACOPY  EQU   @NM00033+8                                               03861000
CCACPYNM EQU   @NM00033                                                 03862000
CCAASMPM EQU   @NM00031+24                                              03863000
@NM00032 EQU   @NM00031+21                                              03864000
CCARASM  EQU   CCAASMRC                                                 03865000
CCAASMSP EQU   @NM00031+12                                              03866000
CCAASM   EQU   @NM00031+8                                               03867000
CCAASMNM EQU   @NM00031                                                 03868000
CCALKDPM EQU   @NM00029+24                                              03869000
@NM00030 EQU   @NM00029+21                                              03870000
CCARLINK EQU   CCALKDRC                                                 03871000
CCALKDSP EQU   @NM00029+12                                              03872000
CCALKED  EQU   @NM00029+8                                               03873000
CCALKDNM EQU   @NM00029                                                 03874000
CCAPGMPM EQU   @NM00027+24                                              03875000
@NM00028 EQU   @NM00027+21                                              03876000
CCABPGRC EQU   @NM00027+20                                              03877000
CCABPGSP EQU   @NM00027+12                                              03878000
CCABPGAD EQU   @NM00027+8                                               03879000
CCABPGNM EQU   @NM00027                                                 03880000
CCAEND   EQU   HMASMCCA+371                                             03881000
@NM00026 EQU   HMASMCCA+309                                             03882000
CCACURDD EQU   CCAFDSNG+3                                               03883000
CCACURDS EQU   CCAFDSNG+2                                               03884000
@NM00025 EQU   CCAFLAGB                                                 03885000
CCAOUTNG EQU   CCAFLAGB                                                 03886000
CCALOGNG EQU   CCAFLAGB                                                 03887000
CCAFMID  EQU   HMASMCCA+291                                             03888000
CCALSTDS EQU   CCAFCTL+8                                                03889000
CCARPTDS EQU   CCAFCTL+7                                                03890000
CCATIME  EQU   CCAFCTL+4                                                03891000
CCADATE  EQU   CCAFCTL+1                                                03892000
@NM00024 EQU   CCAFLAG9                                                 03893000
CCARVCAN EQU   CCAFLAG9                                                 03894000
CCARVEST EQU   CCAFLAG9                                                 03895000
CCAPTSNJ EQU   CCAFLAG9                                                 03896000
CCASTSNP EQU   CCAFLAG9                                                 03897000
CCAMTSNP EQU   CCAFLAG9                                                 03898000
CCAPTSNP EQU   CCAFLAG9                                                 03899000
@NM00023 EQU   CCAFLAG8                                                 03900000
CCAACDSC EQU   CCAFLAG8                                                 03901000
CCACDSC  EQU   CCAFLAG8                                                 03902000
@NM00022 EQU   CCAFLAG6                                                 03903000
CCAACRUP EQU   CCAFLAG6                                                 03904000
CCACRQUP EQU   CCAFLAG6                                                 03905000
CCAACDUP EQU   CCAFLAG6                                                 03906000
CCACDSUP EQU   CCAFLAG6                                                 03907000
@NM00021 EQU   CCAFLAG5                                                 03908000
CCAACROS EQU   CCAFLAG5                                                 03909000
CCACRQOS EQU   CCAFLAG5                                                 03910000
CCAACDOS EQU   CCAFLAG5                                                 03911000
CCACDSOS EQU   CCAFLAG5                                                 03912000
@NM00020 EQU   CCAFLAG4                                                 03913000
CCAACRIS EQU   CCAFLAG4                                                 03914000
CCACRQIS EQU   CCAFLAG4                                                 03915000
CCAACDIS EQU   CCAFLAG4                                                 03916000
CCACDSIS EQU   CCAFLAG4                                                 03917000
@NM00019 EQU   CCAFLAG3+1                                               03918000
CCARGNP  EQU   CCAFLAG3+1                                               03919000
CCADISRQ EQU   CCAFLAG3+1                                               03920000
CCAICTOK EQU   CCAFLAG3                                                 03921000
CCADELP  EQU   CCAFLAG3                                                 03922000
CCACMPRS EQU   CCAFLAG3                                                 03923000
CCAZAPP  EQU   CCAFLAG3                                                 03924000
CCALINKP EQU   CCAFLAG3                                                 03925000
CCACOPYP EQU   CCAFLAG3                                                 03926000
CCAASIP  EQU   CCAFLAG3                                                 03927000
CCAUPDP  EQU   CCAFLAG3                                                 03928000
CCAEOSMP EQU   CCAFLAG2                                                 03929000
CCAEOFNC EQU   CCAFLAG2                                                 03930000
@NM00018 EQU   CCAFLAG2                                                 03931000
CCACHECK EQU   CCAFLAG2                                                 03932000
CCATERM  EQU   CCAFLAG2                                                 03933000
CCASVCLB EQU   CCAFLAG2                                                 03934000
CCANCPTF EQU   CCAFLAG2                                                 03935000
@NM00017 EQU   CCAFLAG1+1                                               03936000
CCAUNL   EQU   CCAFLAG1+1                                               03937000
CCARESET EQU   CCAFLAG1+1                                               03938000
CCALOG   EQU   CCAFLAG1+1                                               03939000
CCACNV   EQU   CCAFLAG1+1                                               03940000
CCALIST  EQU   CCAFLAG1                                                 03941000
CCAUPDU  EQU   CCAFLAG1                                                 03942000
CCAUPDJ  EQU   CCAFLAG1                                                 03943000
CCARES   EQU   CCAFLAG1                                                 03944000
CCAREJ   EQU   CCAFLAG1                                                 03945000
CCAACCPT EQU   CCAFLAG1                                                 03946000
CCAAPPLY EQU   CCAFLAG1                                                 03947000
CCAREC   EQU   CCAFLAG1                                                 03948000
CCAFUNCT EQU   CCAFFUNC                                                 03949000
@NM00016 EQU   @NM00011+18                                              03950000
@NM00015 EQU   @NM00011+16                                              03951000
CCATBLPA EQU   @NM00011+12                                              03952000
@NM00014 EQU   @NM00011+8                                               03953000
@NM00013 EQU   @NM00011+4                                               03954000
@NM00012 EQU   @NM00011                                                 03955000
CCAIFGTP EQU   CCAFGTP+16                                               03956000
CCAGTP3  EQU   CCAFGTP+12                                               03957000
CCAGTP2  EQU   CCAFGTP+8                                                03958000
CCAGTP1  EQU   CCAFGTP+4                                                03959000
CCASETAD EQU   CCASEGTP                                                 03960000
CCACLST  EQU   CCAFPGM+12                                               03961000
CCASPDCB EQU   CCAFPGM+8                                                03962000
CCAICLMD EQU   CCAFICT+12                                               03963000
CCAICMOD EQU   CCAFICT+8                                                03964000
CCAICPTF EQU   CCAFICT+4                                                03965000
CCAICT   EQU   CCAFICT                                                  03966000
CCARVAD  EQU   CCAFSTA                                                  03967000
CCAACDID EQU   CCAFSYS+32                                               03968000
CCACDSID EQU   CCAFSYS+24                                               03969000
CCALNLEN EQU   CCAFSYS+22                                               03970000
@NM00010 EQU   CCAFLAGA                                                 03971000
CCAPSYSF EQU   CCAFLAGA                                                 03972000
CCAASYSF EQU   CCAFLAGA                                                 03973000
CCACSYSF EQU   CCAFLAGA                                                 03974000
CCANUCID EQU   CCAFSYS+20                                               03975000
CCAASREL EQU   CCAFSYS+16                                               03976000
CCACSREL EQU   CCASREL                                                  03977000
CCAPEMAX EQU   CCAFSYS+10                                               03978000
CCAPGLEN EQU   CCAFSYS+8                                                03979000
CCAIOPAS EQU   CCAFSYS+4                                                03980000
CCAIOPCS EQU   CCAFSYS                                                  03981000
CCAPESIZ EQU   CCAFIOP+4                                                03982000
@NM00009 EQU   CCAFLAG7+3                                               03983000
CCALOGP  EQU   CCAFLAG7+2                                               03984000
CCAOUTP  EQU   CCAFLAG7+2                                               03985000
CCASLBP  EQU   CCAFLAG7+2                                               03986000
CCARPTP  EQU   CCAFLAG7+2                                               03987000
CCALISTP EQU   CCAFLAG7+2                                               03988000
CCAJCLP  EQU   CCAFLAG7+2                                               03989000
CCAPTFP  EQU   CCAFLAG7+2                                               03990000
CCATLBP  EQU   CCAFLAG7+2                                               03991000
CCAUT3P  EQU   CCAFLAG7+1                                               03992000
CCAUT2P  EQU   CCAFLAG7+1                                               03993000
CCAUT1P  EQU   CCAFLAG7+1                                               03994000
CCAWK5P  EQU   CCAFLAG7+1                                               03995000
CCAWK4P  EQU   CCAFLAG7+1                                               03996000
CCAWK3P  EQU   CCAFLAG7+1                                               03997000
CCAWK2P  EQU   CCAFLAG7+1                                               03998000
CCAWK1P  EQU   CCAFLAG7+1                                               03999000
CCAACRQP EQU   CCAFLAG7                                                 04000000
CCACRQP  EQU   CCAFLAG7                                                 04001000
CCASTSP  EQU   CCAFLAG7                                                 04002000
CCAMTSP  EQU   CCAFLAG7                                                 04003000
CCAPTSP  EQU   CCAFLAG7                                                 04004000
CCASCDSP EQU   CCAFLAG7                                                 04005000
CCAACDSP EQU   CCAFLAG7                                                 04006000
CCACDSP  EQU   CCAFLAG7                                                 04007000
@NM00008 EQU   CCAFBUFR+122                                             04008000
@NM00007 EQU   CCAFBUFR+120                                             04009000
@NM00006 EQU   CCAFBUFR+118                                             04010000
CCATBFMX EQU   CCAFBUFR+116                                             04011000
CCA4BFMX EQU   CCAFBUFR+114                                             04012000
CCA3BFMX EQU   CCAFBUFR+112                                             04013000
CCA2BFMX EQU   CCAFBUFR+110                                             04014000
CCA1BFMX EQU   CCAFBUFR+108                                             04015000
CCAXBFMX EQU   CCAFBUFR+106                                             04016000
CCAQBFMX EQU   CCAFBUFR+104                                             04017000
CCASBFMX EQU   CCAFBUFR+102                                             04018000
CCAMBFMX EQU   CCAFBUFR+100                                             04019000
CCAPBFMX EQU   CCAFBUFR+98                                              04020000
CCAVBFMX EQU   CCAFBUFR+96                                              04021000
CCAABFMX EQU   CCAFBUFR+94                                              04022000
CCACBFMX EQU   CCAFBUFR+92                                              04023000
@NM00005 EQU   CCAFBUFR+88                                              04024000
@NM00004 EQU   CCAFBUFR+84                                              04025000
CCA4BFSZ EQU   CCAFBUFR+80                                              04026000
CCATBFSZ EQU   CCAFBUFR+76                                              04027000
CCAWBFSZ EQU   CCAFBUFR+72                                              04028000
CCAQBFSZ EQU   CCAFBUFR+68                                              04029000
CCAPBFSZ EQU   CCAFBUFR+64                                              04030000
CCAVBFSZ EQU   CCAFBUFR+60                                              04031000
CCACBFSZ EQU   CCAFBUFR+56                                              04032000
@NM00003 EQU   CCAFBUFR+52                                              04033000
CCA4BFOA EQU   CCAFBUFR+48                                              04034000
CCA4BFIA EQU   CCAFBUFR+44                                              04035000
CCATBFIA EQU   CCAFBUFR+40                                              04036000
CCAWBFOA EQU   CCAFBUFR+36                                              04037000
CCAWBFIA EQU   CCAFBUFR+32                                              04038000
CCAQBFOA EQU   CCAFBUFR+28                                              04039000
CCAQBFIA EQU   CCAFBUFR+24                                              04040000
CCAPBFOA EQU   CCAFBUFR+20                                              04041000
CCAPBFIA EQU   CCAFBUFR+16                                              04042000
CCAVBFOA EQU   CCAFBUFR+12                                              04043000
CCAVBFIA EQU   CCAFBUFR+8                                               04044000
CCACBFOA EQU   CCAFBUFR+4                                               04045000
CCACBFIA EQU   CCAFBUFR                                                 04046000
CCAID    EQU   HMASMCCA                                                 04047000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      04048000
@RC00334 EQU   @RC00333                                                 04049000
@RT00353 EQU   REREAD                                                   04050000
@RF00363 EQU   @RC00330                                                 04051000
@RC00361 EQU   @RC00330                                                 04052000
@RC00346 EQU   @RC00330                                                 04053000
@RT00409 EQU   MODKEYGT                                                 04054000
@RT00421 EQU   MODNMGT2                                                 04055000
@RF00451 EQU   SCANBMP                                                  04056000
@RF00455 EQU   SCANBMP                                                  04057000
@RF00459 EQU   SCANBMP                                                  04058000
@RF00463 EQU   SCANBMP                                                  04059000
@RF00467 EQU   SCANBMP                                                  04060000
@RT00471 EQU   JCLRTN                                                   04061000
@RF00473 EQU   SCANBMP                                                  04062000
@RT00477 EQU   JCLRTN                                                   04063000
@RF00479 EQU   SCANBMP                                                  04064000
@RF00483 EQU   SCANBMP                                                  04065000
@RT00490 EQU   SCANBMP                                                  04066000
@RT00494 EQU   SCANBMP                                                  04067000
@RT00500 EQU   PICKLIB2                                                 04068000
@RF00519 EQU   SCANBMP                                                  04069000
@RF00526 EQU   SCANBMP                                                  04070000
@RC00544 EQU   @EL00006                                                 04071000
@RC00535 EQU   @EL00006                                                 04072000
@RC00559 EQU   @EL00007                                                 04073000
@RT00611 EQU   WRITECC                                                  04074000
@RF00649 EQU   @RC00646                                                 04075000
@RF00818 EQU   @RC00814                                                 04076000
@RF00352 EQU   @RC00346                                                 04077000
@RF00561 EQU   @RC00559                                                 04078000
@ENDDATA EQU   *                                                        04079000
         END   HMASMLKD,(C'PLS2046',0802,78334)                         04080000
