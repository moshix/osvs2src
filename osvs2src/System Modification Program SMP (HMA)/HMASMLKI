         TITLE 'HMASMLKI - SMP LINK ROUTINE INTERFACE'                  00001000
HMASMLKI CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'HMASMLKI  78.334'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00009000
         BALR  @12,0                                               0001 00010000
@PSTART  LA    @10,4095(,@12)                                      0001 00011000
         USING @PSTART,@12                                         0001 00012000
         USING @PSTART+4095,@10                                    0001 00013000
         ST    @13,@SA00001+4                                      0001 00014000
         LA    @14,@SA00001                                        0001 00015000
         ST    @14,8(,@13)                                         0001 00016000
         LR    @13,@14                                             0001 00017000
         EJECT                                                          00018000
*                                                                  0224 00019000
*   /*****************************************************************/ 00020000
*   /*                                                               */ 00021000
*   /* PROGRAM INITIALIZATION                                        */ 00022000
*   /*                                                               */ 00023000
*   /*****************************************************************/ 00024000
*                                                                  0224 00025000
*   FLAGS=CLEAR;                    /* RESET FLAG BYTE               */ 00026000
         MVI   FLAGS,X'00'                                         0224 00027000
*   LKIRTNCD=ZERO;                  /* INIT RC AREA          @YA07506*/ 00028000
         SLR   LKIRTNCD,LKIRTNCD                                   0225 00029000
*   HMASMMGP=''B;                   /* CLEAR MSG PARMS       @Z67SP00*/ 00030000
         XC    HMASMMGP(40),HMASMMGP                               0226 00031000
*   IOPPTR=CCAIOPTR;                /* ADDRESSIBILITY FOR IOP        */ 00032000
         MVC   IOPPTR(4),CCAIOPTR(CCAPTR)                          0227 00033000
*   RFY                                                            0228 00034000
*    (ICTLMOD) BASED(CCAICLMD);                                    0228 00035000
*   RFY                                                            0229 00036000
*    (ICTIXLF) BASED(ICTLCHN(I));                                  0229 00037000
*   RFY                                                            0230 00038000
*    (ICTMOD) BASED(ICTIXL(J));                                    0230 00039000
*   RFY                                                            0231 00040000
*    (ICTPTF) BASED(ICTPPTR(1));                                   0231 00041000
*   RFY                                                            0232 00042000
*     RVAPARM BASED(CCARVAD);       /* RVA BASE              @Z67SP00*/ 00043000
*                                                                  0232 00044000
*   /*****************************************************************/ 00045000
*   /*                                                               */ 00046000
*   /* CHECK FOR ELEMENTS TO BE LINKED FROM RELFILE DATASETS. IF MORE*/ 00047000
*   /* THAN ONE RELFILE IS TO BE PROCESSED THEN THE ELEMENTS FROM ALL*/ 00048000
*   /* BUT THE FIRST ARE TRANSFERED TO SYSUT5 AND THE MOD ENTRIES    */ 00049000
*   /* WILL INDICATE SYSUT5 AS FROMLIB. ELEMENTS FROM THE FIRST OR   */ 00050000
*   /* ONLY RELFILE DATASET WILL NOT BE TRANSFERED AND WILL INDICATE */ 00051000
*   /* SMPTLIB AS FROMLIB. THE JFCB PROCESSING FOR THIS RELFILE WILL */ 00052000
*   /* BE DONE.                                              @Z67SP00*/ 00053000
*   /*                                                               */ 00054000
*   /*****************************************************************/ 00055000
*                                                                  0233 00056000
*   CILPTFNO='';                    /*                       @Z67SP00*/ 00057000
         MVI   CILPTFNO,C' '                                       0233 00058000
         MVC   CILPTFNO+1(6),CILPTFNO                              0233 00059000
*   CILPTFDS='';                    /*                       @Z67SP00*/ 00060000
         MVI   CILPTFDS,C' '                                       0234 00061000
         MVC   CILPTFDS+1(43),CILPTFDS                             0234 00062000
*   CALL HMASMCIL(CILPTFNO,CILPTFDS);/*                      @Z67SP00*/ 00063000
         L     @15,@CV01635                                        0235 00064000
         LA    @01,@AL00235                                        0235 00065000
         BALR  @14,@15                                             0235 00066000
*   RFY                                                            0236 00067000
*     RTNCODE RSTD;                 /*                       @Z67SP00*/ 00068000
*   LKIRTNCD=MAX(RTNCODE,LKIRTNCD); /*                       @Z67SP00*/ 00069000
         CR    LKIRTNCD,RTNCODE                                    0237 00070000
         BNL   *+6                                                      00071000
         LR    LKIRTNCD,RTNCODE                                    0237 00072000
*   RFY                                                            0238 00073000
*     RTNCODE UNRSTD;               /*                       @Z67SP00*/ 00074000
*                                                                  0239 00075000
*   /*****************************************************************/ 00076000
*   /*                                                               */ 00077000
*   /* CONTINUE PROCESSING UNTIL NO MORE LOAD MODULES CAN BE FOUND   */ 00078000
*   /* ELIGIBLE FOR LINK EDITING.                            @Z67SP00*/ 00079000
*   /*                                                               */ 00080000
*   /*****************************************************************/ 00081000
*                                                                  0239 00082000
*   DOLINK=ON;                      /* INIT LOOP CONTROL     @Z67SP00*/ 00083000
         OI    DOLINK,B'01000000'                                  0239 00084000
*   DO WHILE DOLINK=ON&LKIRTNCD<STOPFUNC;/*                  @Z67SP00*/ 00085000
         B     @DE00240                                            0240 00086000
@DL00240 DS    0H                                                  0241 00087000
*     LINKERR=OFF;                  /* RESET ERROR SW        @Z67SP00*/ 00088000
*                                                                  0241 00089000
*     /***************************************************************/ 00090000
*     /*                                                             */ 00091000
*     /* THIS IS THE MAIN LOOP THRU THE ICT FROM THE LOAD MODULE TO  */ 00092000
*     /* THE PTF. PURPOSE IS TO SELECT THE LOAD MODULE TO PROCESS    */ 00093000
*     /* WITH THE ASSOCIATED MODULES. IT CREATES THE INCLUDE CARDS   */ 00094000
*     /* AFTER WRITTING OUT THE VALID CONTROL CARDS FROM THE CDS. IT */ 00095000
*     /* THEN INTERFACES WITH THE OTHER INTERNAL PROCEDURES FOR      */ 00096000
*     /* SPECIFIC FUNCTIONS AND FINALLY SETS THE RETURN CODE PASSED  */ 00097000
*     /* TO THE CALLING ROUTINE.                                     */ 00098000
*     /*                                                             */ 00099000
*     /***************************************************************/ 00100000
*                                                                  0242 00101000
*     DOLINK=OFF;                   /* RELET LOOP CONTROL    @Z67SP00*/ 00102000
         NI    LINKERR,B'10011111'                                 0242 00103000
*     DO I=1 BY 1 WHILE ICTLEND(I)^=ICTENDNT/* LOOP THRU LOAD MODS   */ 00104000
*           &DOLINK=OFF             /* STOP CHECKING LMODS WHEN ALL     00105000
*                                      POSSIBLE FOR THIS PASS HAVE 0243 00106000
*                                      BEEN SET UP           @Z67SP00*/ 00107000
*           &LKIRTNCD<STOPFUNC;     /*                       @Z67SP00*/ 00108000
         LA    I,1                                                 0243 00109000
         B     @DE00243                                            0243 00110000
@DL00243 DS    0H                                                  0244 00111000
*       IF ICTLLKD(I)=ON&ICTLCPL(I)=OFF&ICTLPROC(I)=OFF/* LINK-NOT 0244 00112000
*                                      COMPLETE-NOT INPROCESS        */ 00113000
*         THEN                                                     0244 00114000
         LR    @07,I                                               0244 00115000
         MH    @07,@CH01006                                        0244 00116000
         L     @05,CCAICLMD(,CCAPTR)                               0244 00117000
         ST    @07,@TF00001                                        0244 00118000
         ALR   @07,@05                                             0244 00119000
         AL    @07,@CF01910                                        0244 00120000
         TM    ICTLLKD-14(@07),B'00001000'                         0244 00121000
         BNO   @RF00244                                            0244 00122000
         AL    @05,@TF00001                                        0244 00123000
         AL    @05,@CF01911                                        0244 00124000
         TM    ICTLCPL-8(@05),B'10100000'                          0244 00125000
         BNZ   @RF00244                                            0244 00126000
*         DO;                       /*                               */ 00127000
*                                                                  0245 00128000
*           /*********************************************************/ 00129000
*           /*                                                       */ 00130000
*           /* CHECK LMODS MODS TO SEE IF ANY CAN BE LINKED  @Z67SP00*/ 00131000
*           /*                                                       */ 00132000
*           /*********************************************************/ 00133000
*                                                                  0246 00134000
*           DO J=1 BY 1 WHILE ICTIXL(J)^=ICTENDIX;/* LOOP THROUGH  0246 00135000
*                                      MODS                          */ 00136000
         LA    J,1                                                 0246 00137000
         B     @DE00246                                            0246 00138000
@DL00246 DS    0H                                                  0247 00139000
*             IF ICTMCPL(1)=OFF     /* IS MODULE COMPLETE            */ 00140000
*                 &ICTMISEL(1)=ON   /* SELECTED              @Z67SP00*/ 00141000
*                 &(ICTMMOD(1)=ON   /* MOD REPLACEMENT       @Z67SP00*/ 00142000
*                 |ICTMXPND(1)=ON)  /* OR EXPAND             @Z67SP00*/ 00143000
*               THEN                                               0247 00144000
         LR    @07,J                                               0247 00145000
         SLA   @07,2                                               0247 00146000
         LR    @05,I                                               0247 00147000
         MH    @05,@CH01006                                        0247 00148000
         L     @02,CCAICLMD(,CCAPTR)                               0247 00149000
         AL    @02,@CF01912                                        0247 00150000
         L     @05,ICTLCHN-34(@05,@02)                             0247 00151000
         AL    @05,@CF01913                                        0247 00152000
         L     @07,ICTIXL(@07,@05)                                 0247 00153000
         TM    ICTMCPL(@07),B'00100000'                            0247 00154000
         BNZ   @RF00247                                            0247 00155000
         TM    ICTMISEL(@07),B'10000000'                           0247 00156000
         BNO   @RF00247                                            0247 00157000
         TM    ICTMMOD(@07),B'10010000'                            0247 00158000
         BZ    @RF00247                                            0247 00159000
*               DO;                 /*                       @YA13566*/ 00160000
*                                                                  0248 00161000
*                 /***************************************************/ 00162000
*                 /*                                                 */ 00163000
*                 /* CREATE SYSMOD ENTRY ON THE CDS OR ACDS  @Z67SP00*/ 00164000
*                 /*                                                 */ 00165000
*                 /***************************************************/ 00166000
*                                                                  0249 00167000
*                 CALL HMASMSEC(ICTPTF(1),IOPPTR);/*         @Z67SP00*/ 00168000
         L     @07,ICTPPTR(,@07)                                   0249 00169000
         ST    @07,@AL00001                                        0249 00170000
         LA    @07,IOPPTR                                          0249 00171000
         ST    @07,@AL00001+4                                      0249 00172000
         L     @15,@CV01637                                        0249 00173000
         LA    @01,@AL00001                                        0249 00174000
         BALR  @14,@15                                             0249 00175000
*                 RFY                                              0250 00176000
*                   RTNCODE RSTD;   /*                       @Z67SP00*/ 00177000
*                 LKIRTNCD=MAX(LKIRTNCD,RTNCODE);/*          @Z67SP00*/ 00178000
         CR    LKIRTNCD,RTNCODE                                    0251 00179000
         BNL   *+6                                                      00180000
         LR    LKIRTNCD,RTNCODE                                    0251 00181000
*                 RFY                                              0252 00182000
*                   RTNCODE UNRSTD; /*                       @Z67SP00*/ 00183000
*                 ICTPROCS(1)=ON;   /* PTF IN PROCESS        @Z67SP00*/ 00184000
         LR    @07,J                                               0253 00185000
         SLA   @07,2                                               0253 00186000
         LR    @05,I                                               0253 00187000
         MH    @05,@CH01006                                        0253 00188000
         L     @02,CCAICLMD(,CCAPTR)                               0253 00189000
         LA    @01,0(@05,@02)                                      0253 00190000
         AL    @01,@CF01912                                        0253 00191000
         L     @01,ICTLCHN-34(,@01)                                0253 00192000
         AL    @01,@CF01913                                        0253 00193000
         L     @07,ICTIXL(@07,@01)                                 0253 00194000
         L     @07,ICTPPTR(,@07)                                   0253 00195000
         OI    ICTPROCS(@07),B'10000000'                           0253 00196000
*                 ICTLPROC(I)=ON;   /* LMOD IN PROCESS       @YA13566*/ 00197000
         ALR   @02,@05                                             0254 00198000
         AL    @02,@CF01911                                        0254 00199000
         OI    ICTLPROC-8(@02),B'10000000'                         0254 00200000
*                 CALLCPL=ON;       /* HMASMCPL NEEDED       @Z67SP00*/ 00201000
         OI    CALLCPL,B'00001000'                                 0255 00202000
*               END;                /*                       @YA13566*/ 00203000
*           END;                                                   0257 00204000
*                                                                  0257 00205000
@RF00247 AH    J,@CH00085                                          0257 00206000
@DE00246 LR    @07,J                                               0257 00207000
         SLA   @07,2                                               0257 00208000
         LR    @05,I                                               0257 00209000
         MH    @05,@CH01006                                        0257 00210000
         L     @02,CCAICLMD(,CCAPTR)                               0257 00211000
         LA    @01,0(@05,@02)                                      0257 00212000
         AL    @01,@CF01912                                        0257 00213000
         L     @01,ICTLCHN-34(,@01)                                0257 00214000
         AL    @01,@CF01913                                        0257 00215000
         L     @07,ICTIXL(@07,@01)                                 0257 00216000
         CL    @07,ICTENDIX                                        0257 00217000
         BNE   @DL00246                                            0257 00218000
*           /*********************************************************/ 00219000
*           /*                                                       */ 00220000
*           /* ABOVE CHECK FOUND THAT THE LMOD CAN SHOULD BE LINKED. */ 00221000
*           /*                                               @Z67SP00*/ 00222000
*           /*                                                       */ 00223000
*           /*********************************************************/ 00224000
*                                                                  0258 00225000
*           IF ICTLPROC(I)=ON       /* ELIGIBLE LMOD         @Z67SP00*/ 00226000
*               &LKIRTNCD<STOPFUNC  /*                       @Z67SP00*/ 00227000
*             THEN                  /* THEN PROCESS LMOD     @YA13566*/ 00228000
         ALR   @02,@05                                             0258 00229000
         AL    @02,@CF01911                                        0258 00230000
         TM    ICTLPROC-8(@02),B'10000000'                         0258 00231000
         BNO   @RF00258                                            0258 00232000
         CH    LKIRTNCD,@CH00032                                   0258 00233000
         BNL   @RF00258                                            0258 00234000
*             DO;                   /*                       @YA13566*/ 00235000
*                                                                  0259 00236000
*               /*****************************************************/ 00237000
*               /*                                                   */ 00238000
*               /* SET UP LINKAGE EDITOR PARMS, AND DD NAMES @Z67SP00*/ 00239000
*               /*                                                   */ 00240000
*               /*****************************************************/ 00241000
*                                                                  0260 00242000
*               IF PARMSET=OFF THEN /* NEED TO SET PARMS     @Z67SP00*/ 00243000
         TM    PARMSET,B'10000000'                                 0260 00244000
         BNZ   @RF00260                                            0260 00245000
*                 CALL PARMS;       /*                       @Z67SP00*/ 00246000
*                                                                  0261 00247000
         BAL   @14,PARMS                                           0261 00248000
*               /*****************************************************/ 00249000
*               /*                                                   */ 00250000
*               /* CALL ROUTINE TO PROCESS RECORDS FROM THE CDS LMOD */ 00251000
*               /* MEMBER.                                   @Z67SP00*/ 00252000
*               /*                                                   */ 00253000
*               /*****************************************************/ 00254000
*                                                                  0262 00255000
*               CALL CDSCARDS;      /*                       @Z67SP00*/ 00256000
*                                                                  0262 00257000
@RF00260 BAL   @14,CDSCARDS                                        0262 00258000
*               /*****************************************************/ 00259000
*               /*                                                   */ 00260000
*               /* WHEN THE ENTIRE CDS LMOD MEMBER HAS BEEN PROCESSED*/ 00261000
*               /* ( ALL LINK CONTROL RECORDS APPROPIATE ARE ON      */ 00262000
*               /* SYSUT1) THE LINKAGE EDITOR PREPROCESSING IS DONE  */ 00263000
*               /* FOR THIS LOAD MODULE.                     @Z67SP00*/ 00264000
*               /*                                                   */ 00265000
*               /*****************************************************/ 00266000
*                                                                  0263 00267000
*               IF LKIRTNCD<STOPFUNC THEN/*                  @Z67SP00*/ 00268000
         CH    LKIRTNCD,@CH00032                                   0263 00269000
         BNL   @RF00263                                            0263 00270000
*                 DO;               /*                       @Z67SP00*/ 00271000
*                   CALL MODCHK;    /*                       @Z67SP00*/ 00272000
*                                                                  0265 00273000
         BAL   @14,MODCHK                                          0265 00274000
*                   /*************************************************/ 00275000
*                   /*                                               */ 00276000
*                   /* CHECK FOR MORE LMODS ELIGIBLE FOR PROCESSING  */ 00277000
*                   /* IN THIS PASS TO THE LINKAGE EDITOR. IF MORE   */ 00278000
*                   /* CAN BE PROCESSED THE MAIN LMOD LOOP WILL BE   */ 00279000
*                   /* EXECUTED AGAIN. IF NO MORE CAN BE PICKED UP   */ 00280000
*                   /* DOLINK WILL BE SET TO STOP THE LMOD LOOP.     */ 00281000
*                   /*                                       @Z67SP00*/ 00282000
*                   /*                                               */ 00283000
*                   /*************************************************/ 00284000
*                                                                  0266 00285000
*                   CALL LMCHECK;   /*                       @Z67SP00*/ 00286000
*                                                                  0266 00287000
         BAL   @14,LMCHECK                                         0266 00288000
*                   /*************************************************/ 00289000
*                   /*                                               */ 00290000
*                   /* IF DOLINK IS SET OFF IT INDICATES THAT MORE   */ 00291000
*                   /* LMODS ARE ELIGIBLE TO BE LINKED ALONG WITH THE*/ 00292000
*                   /* CURRENT LMOD (INDEX VALUE IS I). THE INDEX    */ 00293000
*                   /* VALUE M IS FOR THE LMOD FOUND TO BE ELIBIBLE  */ 00294000
*                   /* FOR CONCURRENT PROCESSING. I WILL BE SET TO   */ 00295000
*                   /* M-1 SO THAT THE INTERNAL LOOP INDES           */ 00296000
*                   /* INCREMENTING PROCESSING WILL SET IT TO THE    */ 00297000
*                   /* CORRECT VALUE AND THE LMOD REFERENCED BY M    */ 00298000
*                   /* WILL BE THE NEXT PROCESSED IN THIS LOOP.      */ 00299000
*                   /*                                       @Z67SP00*/ 00300000
*                   /*                                               */ 00301000
*                   /*************************************************/ 00302000
*                                                                  0267 00303000
*                   IF DOLINK=OFF THEN/* SETUP FOR I TO BE   @Z67SP00*/ 00304000
         TM    DOLINK,B'01000000'                                  0267 00305000
         BNZ   @RF00267                                            0267 00306000
*                     I=M-1;        /* EQUAL TO M AT TOP.    @Z67SP00*/ 00307000
         LR    I,M                                                 0268 00308000
         BCTR  I,0                                                 0268 00309000
*                 END;              /*                       @Z67SP00*/ 00310000
@RF00267 DS    0H                                                  0270 00311000
*             END;                                                 0270 00312000
@RF00263 DS    0H                                                  0271 00313000
*         END;                      /* END LMOD HAD MODULES TO LINK     00314000
*                                      DO GROUP              @YA13566*/ 00315000
@RF00258 DS    0H                                                  0272 00316000
*     END;                                                         0272 00317000
*                                                                  0272 00318000
@RF00244 AH    I,@CH00085                                          0272 00319000
@DE00243 LR    @07,I                                               0272 00320000
         MH    @07,@CH01006                                        0272 00321000
         L     @05,CCAICLMD(,CCAPTR)                               0272 00322000
         AL    @05,@CF01916                                        0272 00323000
         L     @07,ICTLEND(@07,@05)                                0272 00324000
         CL    @07,ICTENDNT                                        0272 00325000
         BE    @DC00243                                            0272 00326000
         TM    DOLINK,B'01000000'                                  0272 00327000
         BNZ   @DC00243                                            0272 00328000
         CH    LKIRTNCD,@CH00032                                   0272 00329000
         BL    @DL00243                                            0272 00330000
@DC00243 DS    0H                                                  0273 00331000
*     /***************************************************************/ 00332000
*     /*                                                             */ 00333000
*     /* IF A LINK SHOULD NOW BE DONE THEN CALL PROC TO INIT THE     */ 00334000
*     /* LINKAGE EDITOR PARAMETERS AN INVOKE THE EDITOR      @Z67SP00*/ 00335000
*     /*                                                             */ 00336000
*     /***************************************************************/ 00337000
*                                                                  0273 00338000
*     IF DOLINK=ON&LKIRTNCD<STOPFUNC/*                       @Z67SP00*/ 00339000
*       THEN                                                       0273 00340000
         TM    DOLINK,B'01000000'                                  0273 00341000
         BNO   @RF00273                                            0273 00342000
         CH    LKIRTNCD,@CH00032                                   0273 00343000
         BNL   @RF00273                                            0273 00344000
*       DO;                         /*                       @YA07506*/ 00345000
*         PARMSET=OFF;              /*                       @Z67SP00*/ 00346000
         NI    PARMSET,B'01111111'                                 0275 00347000
*         CALL LINK;                /*                       @Z67SP00*/ 00348000
         BAL   @14,LINK                                            0276 00349000
*         RELFALC=OFF;              /*                               */ 00350000
*         RELFALCD=OFF;             /*                               */ 00351000
         NI    RELFALC,B'11111001'                                 0278 00352000
*       END;                        /*                       @YA07506*/ 00353000
*                                                                  0279 00354000
*     /***************************************************************/ 00355000
*     /*                                                             */ 00356000
*     /* DO SYSMOD COMPLETION PROCESSING                     @Z67SP00*/ 00357000
*     /*                                                             */ 00358000
*     /***************************************************************/ 00359000
*                                                                  0280 00360000
*     IF CALLCPL=ON THEN            /* HMASMCPL NEEDED       @Z67SP00*/ 00361000
@RF00273 TM    CALLCPL,B'00001000'                                 0280 00362000
         BNO   @RF00280                                            0280 00363000
*       DO;                         /*                       @Z67SP00*/ 00364000
*         IF LINKERR=ON THEN        /* DETERMINE PARM        @Z67SP00*/ 00365000
         TM    LINKERR,B'00100000'                                 0282 00366000
         BNO   @RF00282                                            0282 00367000
*           STATUS=BAD;             /* NORMAL PROCESSING@Z67SP00     */ 00368000
         MVI   STATUS,C'B'                                         0283 00369000
*         ELSE                      /*                       @Z67SP00*/ 00370000
*           STATUS=GOOD;            /* ERROR PROCESSING      @Z67SP00*/ 00371000
         B     @RC00282                                            0284 00372000
@RF00282 MVI   STATUS,C'G'                                         0284 00373000
*         CALL HMASMCPL(STATUS);    /*                       @Z67SP00*/ 00374000
@RC00282 L     @15,@CV01636                                        0285 00375000
         LA    @01,@AL00285                                        0285 00376000
         BALR  @14,@15                                             0285 00377000
*         RFY                                                      0286 00378000
*           RTNCODE RSTD;           /*                       @Z67SP00*/ 00379000
*         LKIRTNCD=MAX(RTNCODE,LKIRTNCD);/*                  @Z67SP00*/ 00380000
         CR    LKIRTNCD,RTNCODE                                    0287 00381000
         BNL   *+6                                                      00382000
         LR    LKIRTNCD,RTNCODE                                    0287 00383000
*         RFY                                                      0288 00384000
*           RTNCODE UNRSTD;         /*                       @Z67SP00*/ 00385000
*         CALLCPL=OFF;              /* RESET INDICATOR       @Z67SP00*/ 00386000
         NI    CALLCPL,B'11110111'                                 0289 00387000
*       END;                        /*                       @Z67SP00*/ 00388000
*   END;                            /* END OUTER LOOP        @Z67SP00*/ 00389000
@RF00280 DS    0H                                                  0291 00390000
@DE00240 TM    DOLINK,B'01000000'                                  0291 00391000
         BNO   @DC00240                                            0291 00392000
         CH    LKIRTNCD,@CH00032                                   0291 00393000
         BL    @DL00240                                            0291 00394000
@DC00240 DS    0H                                                  0292 00395000
*   RETURN CODE(LKIRTNCD);          /* SET RTNCODE TO FINISHED     0292 00396000
*                                                            @YA07506*/ 00397000
         LR    @15,LKIRTNCD                                        0292 00398000
         L     @13,4(,@13)                                         0292 00399000
         L     @14,12(,@13)                                        0292 00400000
         LM    @00,@12,20(@13)                                     0292 00401000
         BR    @14                                                 0292 00402000
*                                                                  0293 00403000
*   /*****************************************************************/ 00404000
*   /*                                                               */ 00405000
*   /* CHECK THE CDS MEMBER FOR LINKEDIT CONTROL CARDS. SPECIAL      */ 00406000
*   /* PROCESSING IS REQUIRED FOR CHANGE AND REPLACE RECORDS.        */ 00407000
*   /*                                                       @Z67SP00*/ 00408000
*   /*                                                               */ 00409000
*   /*****************************************************************/ 00410000
*                                                                  0293 00411000
*CDSCARDS:                                                         0293 00412000
*   PROC;                           /*                       @Z67SP00*/ 00413000
@EL00001 L     @13,4(,@13)                                         0293 00414000
@EF00001 DS    0H                                                  0293 00415000
@ER00001 LM    @14,@12,12(@13)                                     0293 00416000
         BR    @14                                                 0293 00417000
CDSCARDS STM   @14,@05,@SA00002                                    0293 00418000
         STM   @07,@12,@SA00002+32                                 0293 00419000
*   RFY                                                            0294 00420000
*    (ICTLMOD) BASED(CCAICLMD);                                    0294 00421000
*   RFY                                                            0295 00422000
*    (ICTIXLF) BASED(ICTLCHN(I));                                  0295 00423000
*   RFY                                                            0296 00424000
*    (ICTMOD) BASED(ICTIXL(J));                                    0296 00425000
*   RFY                                                            0297 00426000
*    (ICTPTF) BASED(ICTPPTR(1));                                   0297 00427000
*                                                                  0297 00428000
*   /*****************************************************************/ 00429000
*   /*                                                               */ 00430000
*   /* SET UP FOR READ OF LINK EDIT CONTROL CARDS FROM CDS   @Z67SP00*/ 00431000
*   /*                                                               */ 00432000
*   /*****************************************************************/ 00433000
*                                                                  0298 00434000
*   CALL POINT;                     /* POSITION TO CNTL DATA         */ 00435000
         BAL   @14,POINT                                           0298 00436000
*CKBLK:                                                            0299 00437000
*                                                                  0299 00438000
*   /*****************************************************************/ 00439000
*   /*                                                               */ 00440000
*   /* READ AND WRIETE NORMAL CONTROL RECORDS TO SYSUT1      @Z67SP00*/ 00441000
*   /*                                                               */ 00442000
*   /*****************************************************************/ 00443000
*                                                                  0299 00444000
*   DO WHILE BUFFER(1)=BLANK        /* SEARCH CTL RECS               */ 00445000
*         &LKIRTNCD<STOPFUNC        /*                       @Z67SP00*/ 00446000
*         &LINKEOF=OFF;             /* FOR CHANGE/REP CARDS  @Z67SP00*/ 00447000
*                                                                  0299 00448000
CKBLK    B     @DE00299                                            0299 00449000
@DL00299 DS    0H                                                  0300 00450000
*     /***************************************************************/ 00451000
*     /*                                                             */ 00452000
*     /* READ ANOTHER RECORD FROM THE CDS LMOD MEMBER        @Z67SP00*/ 00453000
*     /*                                                             */ 00454000
*     /***************************************************************/ 00455000
*                                                                  0300 00456000
*     CALL READ;                    /* READ A CONTROL RECORD         */ 00457000
         BAL   @14,READ                                            0300 00458000
*     IF LKIRTNCD<STOPFUNC          /*                       @Z67SP00*/ 00459000
*         &LINKEOF=OFF              /* RECORD TO WRITE       @S67SP00*/ 00460000
*         &BUFFER(1)=BLANK THEN     /* NOT C/R CARD          @Z67SP00*/ 00461000
*                                                                  0301 00462000
         CH    LKIRTNCD,@CH00032                                   0301 00463000
         BNL   @RF00301                                            0301 00464000
         TM    LINKEOF,B'00010000'                                 0301 00465000
         BNZ   @RF00301                                            0301 00466000
         L     @07,IOPPTR                                          0301 00467000
         L     @07,IOPBUFAD(,@07)                                  0301 00468000
         CLI   BUFFER(@07),C' '                                    0301 00469000
         BNE   @RF00301                                            0301 00470000
*       /*************************************************************/ 00471000
*       /*                                                           */ 00472000
*       /* WRITE NORMAL CONTROL CARDS TO SYSUT1              @Z67SP00*/ 00473000
*       /*                                                           */ 00474000
*       /*************************************************************/ 00475000
*                                                                  0302 00476000
*       CALL WRITE;                 /* WRITE CARDS TO SYSUT1         */ 00477000
         BAL   @14,WRITE                                           0302 00478000
*   END;                                                           0303 00479000
*                                                                  0303 00480000
@RF00301 DS    0H                                                  0303 00481000
@DE00299 L     @07,IOPPTR                                          0303 00482000
         L     @07,IOPBUFAD(,@07)                                  0303 00483000
         CLI   BUFFER(@07),C' '                                    0303 00484000
         BNE   @DC00299                                            0303 00485000
         CH    LKIRTNCD,@CH00032                                   0303 00486000
         BNL   @DC00299                                            0303 00487000
         TM    LINKEOF,B'00010000'                                 0303 00488000
         BZ    @DL00299                                            0303 00489000
@DC00299 DS    0H                                                  0304 00490000
*   /*****************************************************************/ 00491000
*   /*                                                               */ 00492000
*   /* IF FIRST CHAR OF CONTROL CARD IS EQUAL TO IOPLMCRM THEN THIS  */ 00493000
*   /* INDICATES THAT CHANGE/REPLACE CARDS FOLLOW FOR THE MODULE     */ 00494000
*   /* IDENTIFIED BY IOPLMCRN. THE CHANGE/REPLACE CARDS HAVE HE FIRST*/ 00495000
*   /* CHARACTERS SET EQUAL TO IOPLMCRC                      @Z67SP00*/ 00496000
*   /*                                                               */ 00497000
*   /*****************************************************************/ 00498000
*                                                                  0304 00499000
*   IF BUFFER(1)=IOPLMCRM           /* IF MOD FOR CH/REP     @Z67SP00*/ 00500000
*       &LKIRTNCD<STOPFUNC          /*                       @Z67SP00*/ 00501000
*       &LINKEOF=OFF                /*                       @Z67SP00*/ 00502000
*     THEN                          /*                       @Z67SP00*/ 00503000
*                                                                  0304 00504000
         L     @07,IOPPTR                                          0304 00505000
         L     @07,IOPBUFAD(,@07)                                  0304 00506000
         CLI   BUFFER(@07),C'*'                                    0304 00507000
         BNE   @RF00304                                            0304 00508000
         CH    LKIRTNCD,@CH00032                                   0304 00509000
         BNL   @RF00304                                            0304 00510000
         TM    LINKEOF,B'00010000'                                 0304 00511000
         BNZ   @RF00304                                            0304 00512000
*     /***************************************************************/ 00513000
*     /*                                                             */ 00514000
*     /* SEE IF THE CARD IS FOR A MOD IN THIS LMOD           @Z67SP00*/ 00515000
*     /*                                                             */ 00516000
*     /***************************************************************/ 00517000
*                                                                  0305 00518000
*SCAN:                                                             0305 00519000
*     DO J=1 BY 1 WHILE ICTIXL(J)^=ICTENDIX/* SEARCH MODS            */ 00520000
*           &LINKEOF=OFF&LKIRTNCD<STOPFUNC;/*                @Z67SP00*/ 00521000
SCAN     LA    J,1                                                 0305 00522000
         B     @DE00305                                            0305 00523000
@DL00305 DS    0H                                                  0306 00524000
*       IF ICTMNAME(1)=BUFFER(L2:L9)/* LOCATE MOD NAME               */ 00525000
*         THEN                      /*                       @Z67SP00*/ 00526000
         LR    @07,J                                               0306 00527000
         SLA   @07,2                                               0306 00528000
         LR    @05,I                                               0306 00529000
         MH    @05,@CH01006                                        0306 00530000
         L     @02,CCAICLMD(,CCAPTR)                               0306 00531000
         AL    @02,@CF01912                                        0306 00532000
         L     @05,ICTLCHN-34(@05,@02)                             0306 00533000
         AL    @05,@CF01913                                        0306 00534000
         L     @07,ICTIXL(@07,@05)                                 0306 00535000
         L     @05,IOPPTR                                          0306 00536000
         L     @05,IOPBUFAD(,@05)                                  0306 00537000
         CLC   ICTMNAME(8,@07),BUFFER+1(@05)                       0306 00538000
         BNE   @RF00306                                            0306 00539000
*         IF ICTMCPL(1)=OFF         /* IS MODULE COMPLETE    @Z67SP00*/ 00540000
*             &ICTMISEL(1)=ON       /* SELECTED              @Z67SP00*/ 00541000
*             &ICTMMOD(1)=ON        /* MOD REPLACEMENT       @Z67SP00*/ 00542000
*             &ICTMXPND(1)=OFF      /* NOT EXPAND ENTRY      @Z67SP00*/ 00543000
*           THEN                                                   0307 00544000
         TM    ICTMCPL(@07),B'00100000'                            0307 00545000
         BNZ   @RF00307                                            0307 00546000
         TM    ICTMISEL(@07),B'10000000'                           0307 00547000
         BNO   @RF00307                                            0307 00548000
         TM    ICTMMOD(@07),B'10000000'                            0307 00549000
         BNO   @RF00307                                            0307 00550000
         TM    ICTMXPND(@07),B'00010000'                           0307 00551000
         BNZ   @RF00307                                            0307 00552000
*           DO;                                                    0308 00553000
*             ICTMPROC(1)=ON;       /* SET MOD INPROCESS BIT ON      */ 00554000
         OI    ICTMPROC(@07),B'10000000'                           0309 00555000
*             BUFFER(1)=IOPLMCRC;   /* SO INDICATOR RECORD SKIPED  0310 00556000
*                                                            @Z67SP00*/ 00557000
*                                                                  0310 00558000
         MVI   BUFFER(@05),C'@'                                    0310 00559000
*             /*******************************************************/ 00560000
*             /*                                                     */ 00561000
*             /* GET ALL CHANGE REPLACE RECORDS FOR THIS ELEMENT AND */ 00562000
*             /* WRITE THEM TO SYSUT1.                       @Z67SP00*/ 00563000
*             /*                                                     */ 00564000
*             /*******************************************************/ 00565000
*                                                                  0311 00566000
*             DO WHILE BUFFER(1)=IOPLMCRC/* SRCH RCDS        @Z67SP00*/ 00567000
*                   &LINKEOF=OFF&LKIRTNCD<STOPFUNC;/*        @Z67SP00*/ 00568000
         B     @DE00311                                            0311 00569000
@DL00311 DS    0H                                                  0312 00570000
*               CALL READ;          /* READ A CNTL RECORD            */ 00571000
*                                                                  0312 00572000
         BAL   @14,READ                                            0312 00573000
*               /*****************************************************/ 00574000
*               /*                                                   */ 00575000
*               /* CHECK INDICATOR AND WRITE IF CORRECT      @Z67SP00*/ 00576000
*               /*                                                   */ 00577000
*               /*****************************************************/ 00578000
*                                                                  0313 00579000
*               IF BUFFER(1)=IOPLMCRC/* INDICATE CH/REP CC   @Z67SP00*/ 00580000
*                   &LINKEOF=OFF&LKIRTNCD<STOPFUNC/*         @Z67SP00*/ 00581000
*                 THEN                                             0313 00582000
         L     @07,IOPPTR                                          0313 00583000
         L     @07,IOPBUFAD(,@07)                                  0313 00584000
         CLI   BUFFER(@07),C'@'                                    0313 00585000
         BNE   @RF00313                                            0313 00586000
         TM    LINKEOF,B'00010000'                                 0313 00587000
         BNZ   @RF00313                                            0313 00588000
         CH    LKIRTNCD,@CH00032                                   0313 00589000
         BNL   @RF00313                                            0313 00590000
*                 DO;                                              0314 00591000
*                   BUFFER(1)=BLANK;/* CLEAR FIRST CHAR              */ 00592000
         MVI   BUFFER(@07),C' '                                    0315 00593000
*                   CALL WRITE;     /* WRITE A CHANGE/REPLACE CARD   */ 00594000
         BAL   @14,WRITE                                           0316 00595000
*                   BUFFER(1)=IOPLMCRC;/* SET FOR PROCC. BELOW     0317 00596000
*                                                            @Z67SP00*/ 00597000
         L     @07,IOPPTR                                          0317 00598000
         L     @07,IOPBUFAD(,@07)                                  0317 00599000
         MVI   BUFFER(@07),C'@'                                    0317 00600000
*                 END;                                             0318 00601000
*             END;                                                 0319 00602000
*                                                                  0319 00603000
@RF00313 DS    0H                                                  0319 00604000
@DE00311 L     @07,IOPPTR                                          0319 00605000
         L     @07,IOPBUFAD(,@07)                                  0319 00606000
         CLI   BUFFER(@07),C'@'                                    0319 00607000
         BNE   @DC00311                                            0319 00608000
         TM    LINKEOF,B'00010000'                                 0319 00609000
         BNZ   @DC00311                                            0319 00610000
         CH    LKIRTNCD,@CH00032                                   0319 00611000
         BL    @DL00311                                            0319 00612000
@DC00311 DS    0H                                                  0320 00613000
*             /*******************************************************/ 00614000
*             /*                                                     */ 00615000
*             /* ALL CHANGE REPLACE RECORDS HAVE BEEN WRITTEN FOR    */ 00616000
*             /* THIS ELEMENT.                               @Z67SP00*/ 00617000
*             /* BUILD INCLUDE FOR ELEMENT WITH CHANGE/REPLACE       */ 00618000
*             /*                                             @Z67SP00*/ 00619000
*             /*                                                     */ 00620000
*             /*******************************************************/ 00621000
*                                                                  0320 00622000
*             IF LKIRTNCD<STOPFUNC THEN/*                    @Z67SP00*/ 00623000
         CH    LKIRTNCD,@CH00032                                   0320 00624000
         BNL   @RF00320                                            0320 00625000
*               DO;                 /*                       @Z67SP00*/ 00626000
*                 LIBNAME=ICTFMLIB(1);/* MOVE IN LIB NAME    @Z67SP00*/ 00627000
         LR    @07,J                                               0322 00628000
         SLA   @07,2                                               0322 00629000
         LR    @05,I                                               0322 00630000
         MH    @05,@CH01006                                        0322 00631000
         L     @02,CCAICLMD(,CCAPTR)                               0322 00632000
         AL    @02,@CF01912                                        0322 00633000
         L     @05,ICTLCHN-34(@05,@02)                             0322 00634000
         AL    @05,@CF01913                                        0322 00635000
         L     @07,ICTIXL(@07,@05)                                 0322 00636000
         MVC   LIBNAME(8),ICTFMLIB(@07)                            0322 00637000
*                 MEMNAME=ICTMNAME(1);/* MOVE IN MOD NAME    @Z67SP00*/ 00638000
         MVC   MEMNAME(8),ICTMNAME(@07)                            0323 00639000
*                 PTFNO=ICTPTFS(1); /* AND PTF NUMBER        @Z67SP00*/ 00640000
         L     @05,ICTPPTR(,@07)                                   0324 00641000
         MVC   PTFNO(7),ICTPTFS(@05)                               0324 00642000
*                 IF CILPTFNO=PTFNO /* IF MOD FROM PTF       @Z67SP00*/ 00643000
*                     &ICTMRELN(1)^=ZERO/* AND RELFILE       @Z67SP00*/ 00644000
*                     &ICTMTRX(1)=OFF/* AND NOT MOVED        @Z67SP00*/ 00645000
*                   THEN            /* THEN NEED TO ALLOC    @Z67SP00*/ 00646000
         CLC   CILPTFNO(7),PTFNO                                   0325 00647000
         BNE   @RF00325                                            0325 00648000
         ICM   @05,3,ICTMRELN(@07)                                 0325 00649000
         BZ    @RF00325                                            0325 00650000
         TM    ICTMTRX(@07),B'00010000'                            0325 00651000
         BNZ   @RF00325                                            0325 00652000
*                   RELFALC=ON;     /* RELFILE               @Z67SP00*/ 00653000
         OI    RELFALC,B'00000100'                                 0326 00654000
*                 CALL CTLSTMT;     /*                       @Z67SP00*/ 00655000
@RF00325 BAL   @14,CTLSTMT                                         0327 00656000
*               END;                /*                       @Z67SP00*/ 00657000
*             IF BUFFER(1)=BLANK    /* MORE NORMAL LKD RECORDS     0329 00658000
*                                                            @Z67SP00*/ 00659000
*               THEN                                               0329 00660000
@RF00320 L     @07,IOPPTR                                          0329 00661000
         L     @07,IOPBUFAD(,@07)                                  0329 00662000
         CLI   BUFFER(@07),C' '                                    0329 00663000
         BE    @RT00329                                            0329 00664000
*               GOTO CKBLK;         /* BRANCH TO PROCESS RECORD      */ 00665000
*             ELSE                  /*                       @Z67SP00*/ 00666000
*                                                                  0331 00667000
*               /*****************************************************/ 00668000
*               /*                                                   */ 00669000
*               /* THIS MUST BE RECORD INDICATION C/R RECORDS FOLLOW */ 00670000
*               /* FOR SOME OTHER ELEMENT. RESET ELEMENT LOOP COUNTER*/ 00671000
*               /* AND LOOK FOR MATCH IN LMODS MODS.         @Z67SP00*/ 00672000
*               /*                                                   */ 00673000
*               /*****************************************************/ 00674000
*                                                                  0331 00675000
*               J=ZERO;             /* RESET LOOP COUNTER            */ 00676000
         SLR   J,J                                                 0331 00677000
*           END;                                                   0332 00678000
*     END;                                                         0333 00679000
*                                                                  0333 00680000
@RF00307 DS    0H                                                  0333 00681000
@RF00306 AH    J,@CH00085                                          0333 00682000
@DE00305 LR    @07,J                                               0333 00683000
         SLA   @07,2                                               0333 00684000
         LR    @05,I                                               0333 00685000
         MH    @05,@CH01006                                        0333 00686000
         L     @02,CCAICLMD(,CCAPTR)                               0333 00687000
         AL    @02,@CF01912                                        0333 00688000
         L     @05,ICTLCHN-34(@05,@02)                             0333 00689000
         AL    @05,@CF01913                                        0333 00690000
         L     @07,ICTIXL(@07,@05)                                 0333 00691000
         CL    @07,ICTENDIX                                        0333 00692000
         BE    @DC00305                                            0333 00693000
         TM    LINKEOF,B'00010000'                                 0333 00694000
         BNZ   @DC00305                                            0333 00695000
         CH    LKIRTNCD,@CH00032                                   0333 00696000
         BL    @DL00305                                            0333 00697000
@DC00305 DS    0H                                                  0334 00698000
*   /*****************************************************************/ 00699000
*   /*                                                               */ 00700000
*   /* THE CHANGE REPLACE ELEMENT NOT AN ELEMENT IN THIS LMOD. FLUSH */ 00701000
*   /* PAST THE RECORDS.                                     @Z67SP00*/ 00702000
*   /*                                                               */ 00703000
*   /*****************************************************************/ 00704000
*                                                                  0334 00705000
*   BUFFER(1)=IOPLMCRC;             /* INDICATE CH/REP       @Z67SP00*/ 00706000
@RF00304 L     @07,IOPPTR                                          0334 00707000
         L     @07,IOPBUFAD(,@07)                                  0334 00708000
         MVI   BUFFER(@07),C'@'                                    0334 00709000
*   DO WHILE BUFFER(1)=IOPLMCRC     /* SEARCH RECS FOR CH/RP @Z67SP00*/ 00710000
*         &LINKEOF=OFF&LKIRTNCD<STOPFUNC;/*                  @Z67SP00*/ 00711000
         B     @DE00335                                            0335 00712000
@DL00335 DS    0H                                                  0336 00713000
*     CALL READ;                    /* CALL READ RTN                 */ 00714000
         BAL   @14,READ                                            0336 00715000
*   END;                                                           0337 00716000
*                                                                  0337 00717000
@DE00335 L     @07,IOPPTR                                          0337 00718000
         L     @07,IOPBUFAD(,@07)                                  0337 00719000
         CLI   BUFFER(@07),C'@'                                    0337 00720000
         BNE   @DC00335                                            0337 00721000
         TM    LINKEOF,B'00010000'                                 0337 00722000
         BNZ   @DC00335                                            0337 00723000
         CH    LKIRTNCD,@CH00032                                   0337 00724000
         BL    @DL00335                                            0337 00725000
@DC00335 DS    0H                                                  0338 00726000
*   /*****************************************************************/ 00727000
*   /*                                                               */ 00728000
*   /* ONCE PAST THE ELEMENTS CHANGE REPLACE RECORDS CHECK THE NEW   */ 00729000
*   /* RECORD FOR TYPE                                       @Z67SP00*/ 00730000
*   /*                                                               */ 00731000
*   /*****************************************************************/ 00732000
*                                                                  0338 00733000
*   IF LINKEOF=OFF&LKIRTNCD<STOPFUNC THEN/*                  @Z67SP00*/ 00734000
         TM    LINKEOF,B'00010000'                                 0338 00735000
         BNZ   @RF00338                                            0338 00736000
         CH    LKIRTNCD,@CH00032                                   0338 00737000
         BNL   @RF00338                                            0338 00738000
*     DO;                           /*                       @Z67SP00*/ 00739000
*       IF BUFFER(1)=IOPLMCRM       /* MORE C/R RECORDS ?    @Z67SP00*/ 00740000
*         THEN                                                     0340 00741000
         L     @07,IOPPTR                                          0340 00742000
         L     @07,IOPBUFAD(,@07)                                  0340 00743000
         CLI   BUFFER(@07),C'*'                                    0340 00744000
         BE    @RT00340                                            0340 00745000
*         GOTO SCAN;                /* PROCESS RECORD                */ 00746000
*       ELSE                        /* THESE ARE NORMAL RECORDS FOR     00747000
*                                      LKD@Z67SP00                   */ 00748000
*         GOTO CKBLK;               /* PROCESS RECORD                */ 00749000
         B     CKBLK                                               0342 00750000
*     END;                          /*                       @Z67SP00*/ 00751000
*                                                                  0343 00752000
*   /*****************************************************************/ 00753000
*   /*                                                               */ 00754000
*   /* RESET INDICATOR FOR END OF FILE FROM CDS MEMBER       @Z67SP00*/ 00755000
*   /*                                                               */ 00756000
*   /*****************************************************************/ 00757000
*                                                                  0344 00758000
*   LINKEOF=OFF;                    /*                       @Z67SP00*/ 00759000
@RF00338 NI    LINKEOF,B'11101111'                                 0344 00760000
*   END CDSCARDS;                   /*                       @Z67SP00*/ 00761000
@EL00002 DS    0H                                                  0345 00762000
@EF00002 DS    0H                                                  0345 00763000
@ER00002 LM    @14,@05,@SA00002                                    0345 00764000
         LM    @07,@12,@SA00002+32                                 0345 00765000
         BR    @14                                                 0345 00766000
         EJECT                                                          00767000
*                                                                  0346 00768000
*   /*****************************************************************/ 00769000
*   /*                                                               */ 00770000
*   /* THIS PROCEDURE SETS UP THE OPTIONS LIST FOR LINK EDIT. IT     */ 00771000
*   /* SCANS THE ICT FOR THE REQUIRED PARAMETERS AND MOVES THEM INTO */ 00772000
*   /* THE OPTIONS LIST. IT THEN INVOKES THE LINKAGE EDITOR AND      */ 00773000
*   /* CHECKS THE RETURN CODE.                                       */ 00774000
*   /*                                                               */ 00775000
*   /*****************************************************************/ 00776000
*                                                                  0346 00777000
*PARMS:                                                            0346 00778000
*   PROC;                           /*                       @Z67SP00*/ 00779000
PARMS    STM   @14,@12,12(@13)                                     0346 00780000
*   RFY                                                            0347 00781000
*    (ICTLMOD) BASED(CCAICLMD);                                    0347 00782000
*   RFY                                                            0348 00783000
*    (ICTIXLF) BASED(ICTLCHN(I));                                  0348 00784000
*   RFY                                                            0349 00785000
*    (ICTMOD) BASED(ICTIXL(J));                                    0349 00786000
*   RFY                                                            0350 00787000
*    (ICTPTF) BASED(ICTPPTR(1));                                   0350 00788000
*   OPTLGTH=ZERO;                   /*                       @Z67SP00*/ 00789000
         SLR   @02,@02                                             0351 00790000
         STH   @02,OPTLGTH                                         0351 00791000
*   LX=ZERO;                        /*                       @Z67SP00*/ 00792000
         SLR   LX,LX                                               0352 00793000
*   LY=ZERO;                        /*                       @Z67SP00*/ 00794000
         SLR   LY,LY                                               0353 00795000
*   PARMSET=ON;                     /* LINK PARMS SET UP     @Z67SP00*/ 00796000
*                                                                  0354 00797000
         OI    PARMSET,B'10000000'                                 0354 00798000
*   /*****************************************************************/ 00799000
*   /*                                                               */ 00800000
*   /* GET USER SUPPLIED PARMS FROM CCA                      @Z67SP00*/ 00801000
*   /*                                                               */ 00802000
*   /*****************************************************************/ 00803000
*                                                                  0355 00804000
*   SYSPRINT=CCALKDSP;              /* SYSPRINT DD NAME      @Z67SP00*/ 00805000
         L     @05,CCABLDLP(,CCAPTR)                               0355 00806000
         MVC   SYSPRINT(8),CCALKDSP(@05)                           0355 00807000
*   DO LX=1 BY 1 WHILE CCALKDPM(LX)^=BLANK;/*                @Z67SP00*/ 00808000
         LA    LX,1                                                0356 00809000
         B     @DE00356                                            0356 00810000
@DL00356 DS    0H                                                  0357 00811000
*     OPTVAR(LX)=CCALKDPM(LX);      /* MOVE THRU PARMS       @Z67SP00*/ 00812000
         LA    @01,OPTVAR-1(LX)                                    0357 00813000
         L     @15,CCABLDLP(,CCAPTR)                               0357 00814000
         ALR   @15,LX                                              0357 00815000
         MVC   0(1,@01),CCALKDPM-1(@15)                            0357 00816000
*   END;                            /*                       @Z67SP00*/ 00817000
         AH    LX,@CH00085                                         0358 00818000
@DE00356 L     @01,CCABLDLP(,CCAPTR)                               0358 00819000
         ALR   @01,LX                                              0358 00820000
         CLI   CCALKDPM-1(@01),C' '                                0358 00821000
         BNE   @DL00356                                            0358 00822000
*   IF LX^=1 THEN                   /* ANY USER PARMS?       @Z67SP00*/ 00823000
         LA    @15,1                                               0359 00824000
         CR    LX,@15                                              0359 00825000
         BE    @RF00359                                            0359 00826000
*     DO;                           /*                       @Z67SP00*/ 00827000
*       OPTVAR(LX)=COMMA;           /* COMMA AFTER LAST      @Z67SP00*/ 00828000
         LA    @01,OPTVAR-1(LX)                                    0361 00829000
         MVC   0(1,@01),COMMA                                      0361 00830000
*       LX=LX+1;                    /* BUMP POSITION         @Z67SP00*/ 00831000
         ALR   LX,@15                                              0362 00832000
*     END;                          /*                       @Z67SP00*/ 00833000
*   LY=LX-1;                        /* FOR MOVING PARMS      @Z67SP00*/ 00834000
*                                                                  0364 00835000
@RF00359 LR    LY,LX                                               0364 00836000
         BCTR  LY,0                                                0364 00837000
*   /*****************************************************************/ 00838000
*   /*                                                               */ 00839000
*   /* NOW GET LMOD PARMS FOR ICT                            @Z67SP00*/ 00840000
*   /*                                                               */ 00841000
*   /*****************************************************************/ 00842000
*                                                                  0365 00843000
*   IF ICTLRENT(I)=ON               /* REENTERABLE                   */ 00844000
*     THEN                                                         0365 00845000
         LR    @02,I                                               0365 00846000
         MH    @02,@CH01006                                        0365 00847000
         L     @01,CCAICLMD(,CCAPTR)                               0365 00848000
         ALR   @01,@02                                             0365 00849000
         AL    @01,@CF01921                                        0365 00850000
         TM    ICTLRENT-9(@01),B'01000000'                         0365 00851000
         BNO   @RF00365                                            0365 00852000
*     DO;                                                          0366 00853000
*       LY=LY+L5;                   /* CALC DISP                     */ 00854000
         AH    LY,@CH01674                                         0367 00855000
*       OPTVAR(LX:LY)=RENT;         /* MOVE RENT PARM                */ 00856000
         LA    @02,OPTVAR-1(LX)                                    0368 00857000
         LR    @15,LY                                              0368 00858000
         SLR   @15,LX                                              0368 00859000
         EX    @15,@SM01922                                        0368 00860000
*     END;                                                         0369 00861000
*   IF ICTLREUS(I)=ON               /* SERIALLY REUSABLE             */ 00862000
*     THEN                                                         0370 00863000
@RF00365 LR    @05,I                                               0370 00864000
         MH    @05,@CH01006                                        0370 00865000
         L     @02,CCAICLMD(,CCAPTR)                               0370 00866000
         ALR   @02,@05                                             0370 00867000
         AL    @02,@CF01921                                        0370 00868000
         TM    ICTLREUS-9(@02),B'00100000'                         0370 00869000
         BNO   @RF00370                                            0370 00870000
*     DO;                                                          0371 00871000
*       LX=LY+L1;                   /* CALC DISP                     */ 00872000
         LA    LX,1                                                0372 00873000
         ALR   LX,LY                                               0372 00874000
*       LY=LY+L5;                   /* CALC DISP                     */ 00875000
         AH    LY,@CH01674                                         0373 00876000
*       OPTVAR(LX:LY)=REUS;         /* MOVE REUS PARM                */ 00877000
         LA    @02,OPTVAR-1(LX)                                    0374 00878000
         LR    @15,LY                                              0374 00879000
         SLR   @15,LX                                              0374 00880000
         EX    @15,@SM01924                                        0374 00881000
*     END;                                                         0375 00882000
*   IF ICTLSCTR(I)=ON               /* SCATTER LOAD                  */ 00883000
*     THEN                                                         0376 00884000
@RF00370 LR    @05,I                                               0376 00885000
         MH    @05,@CH01006                                        0376 00886000
         L     @02,CCAICLMD(,CCAPTR)                               0376 00887000
         ALR   @02,@05                                             0376 00888000
         AL    @02,@CF01921                                        0376 00889000
         TM    ICTLSCTR-9(@02),B'00010000'                         0376 00890000
         BNO   @RF00376                                            0376 00891000
*     DO;                                                          0377 00892000
*       LX=LY+L1;                   /* CALC DISP                     */ 00893000
         LA    LX,1                                                0378 00894000
         ALR   LX,LY                                               0378 00895000
*       LY=LY+L5;                   /* CALC DISP                     */ 00896000
         AH    LY,@CH01674                                         0379 00897000
*       OPTVAR(LX:LY)=SCTR;         /* MOVE SCTR PARM                */ 00898000
         LA    @02,OPTVAR-1(LX)                                    0380 00899000
         LR    @15,LY                                              0380 00900000
         SLR   @15,LX                                              0380 00901000
         EX    @15,@SM01926                                        0380 00902000
*     END;                                                         0381 00903000
*   IF ICTLOVLY(I)=ON               /* OVERLAY STRUCTURE             */ 00904000
*     THEN                                                         0382 00905000
@RF00376 LR    @05,I                                               0382 00906000
         MH    @05,@CH01006                                        0382 00907000
         L     @02,CCAICLMD(,CCAPTR)                               0382 00908000
         ALR   @02,@05                                             0382 00909000
         AL    @02,@CF01921                                        0382 00910000
         TM    ICTLOVLY-9(@02),B'00001000'                         0382 00911000
         BNO   @RF00382                                            0382 00912000
*     DO;                                                          0383 00913000
*       LX=LY+L1;                   /* CALC DISP                     */ 00914000
         LA    @02,1                                               0384 00915000
         LR    LX,LY                                               0384 00916000
         ALR   LX,@02                                              0384 00917000
*       LY=LY+L5;                   /* CALC DISP                     */ 00918000
         LA    @15,5                                               0385 00919000
         ALR   LY,@15                                              0385 00920000
*       OPTVAR(LX:LY)=OVLY;         /* MOVE OVLY PARM                */ 00921000
         LA    @01,OPTVAR-1(LX)                                    0386 00922000
         LR    @14,LY                                              0386 00923000
         SLR   @14,LX                                              0386 00924000
         EX    @14,@SM01928                                        0386 00925000
*       LX=LY+L1;                   /* CALC DISP                     */ 00926000
         ALR   @02,LY                                              0387 00927000
         LR    LX,@02                                              0387 00928000
*       LY=LY+L5;                   /* CALC DISP                     */ 00929000
         ALR   LY,@15                                              0388 00930000
*       OPTVAR(LX:LY)=XCAL;         /* MOVE XCAL PARM                */ 00931000
         LA    @02,OPTVAR-1(LX)                                    0389 00932000
         LR    @15,LY                                              0389 00933000
         SLR   @15,LX                                              0389 00934000
         EX    @15,@SM01930                                        0389 00935000
*     END;                                                         0390 00936000
*   IF ICTLREFR(I)=ON               /* REFRESHABLE                   */ 00937000
*     THEN                                                         0391 00938000
@RF00382 LR    @05,I                                               0391 00939000
         MH    @05,@CH01006                                        0391 00940000
         L     @02,CCAICLMD(,CCAPTR)                               0391 00941000
         ALR   @02,@05                                             0391 00942000
         AL    @02,@CF01921                                        0391 00943000
         TM    ICTLREFR-9(@02),B'00000100'                         0391 00944000
         BNO   @RF00391                                            0391 00945000
*     DO;                                                          0392 00946000
*       LX=LY+L1;                   /* CALC DISP                     */ 00947000
         LA    LX,1                                                0393 00948000
         ALR   LX,LY                                               0393 00949000
*       LY=LY+L5;                   /* CALC DISP                     */ 00950000
         AH    LY,@CH01674                                         0394 00951000
*       OPTVAR(LX:LY)=REFR;         /* MOVE REFR PARM                */ 00952000
         LA    @02,OPTVAR-1(LX)                                    0395 00953000
         LR    @15,LY                                              0395 00954000
         SLR   @15,LX                                              0395 00955000
         EX    @15,@SM01932                                        0395 00956000
*     END;                                                         0396 00957000
*   IF ICTLDC(I)=ON                 /* DOWNWARD COMPATIBILITY        */ 00958000
*     THEN                                                         0397 00959000
@RF00391 LR    @05,I                                               0397 00960000
         MH    @05,@CH01006                                        0397 00961000
         L     @02,CCAICLMD(,CCAPTR)                               0397 00962000
         ALR   @02,@05                                             0397 00963000
         AL    @02,@CF01921                                        0397 00964000
         TM    ICTLDC-9(@02),B'00000010'                           0397 00965000
         BNO   @RF00397                                            0397 00966000
*     DO;                                                          0398 00967000
*       LX=LY+L1;                   /* CALC DISP                     */ 00968000
         LA    LX,1                                                0399 00969000
         ALR   LX,LY                                               0399 00970000
*       LY=LY+L3;                   /* CALC DISP                     */ 00971000
         AH    LY,@CH01672                                         0400 00972000
*       OPTVAR(LX:LY)=DC;           /* MOVE DC PARM                  */ 00973000
         LA    @02,OPTVAR-1(LX)                                    0401 00974000
         LR    @15,LY                                              0401 00975000
         SLR   @15,LX                                              0401 00976000
         EX    @15,@SM01934                                        0401 00977000
*     END;                                                         0402 00978000
*   IF ICTLNE(I)=ON                 /* NOT EDITABLE                  */ 00979000
*     THEN                                                         0403 00980000
@RF00397 LR    @05,I                                               0403 00981000
         MH    @05,@CH01006                                        0403 00982000
         L     @02,CCAICLMD(,CCAPTR)                               0403 00983000
         ALR   @02,@05                                             0403 00984000
         AL    @02,@CF01936                                        0403 00985000
         TM    ICTLNE-10(@02),B'10000000'                          0403 00986000
         BNO   @RF00403                                            0403 00987000
*     DO;                                                          0404 00988000
*       LX=LY+L1;                   /* CALC DISP                     */ 00989000
         LA    LX,1                                                0405 00990000
         ALR   LX,LY                                               0405 00991000
*       LY=LY+L3;                   /* CALC DISP                     */ 00992000
         AH    LY,@CH01672                                         0406 00993000
*       OPTVAR(LX:LY)=NE;           /* MOVE NE PARM                  */ 00994000
         LA    @02,OPTVAR-1(LX)                                    0407 00995000
         LR    @15,LY                                              0407 00996000
         SLR   @15,LX                                              0407 00997000
         EX    @15,@SM01937                                        0407 00998000
*     END;                                                         0408 00999000
*   IF ICTLAPF(I)=ON THEN           /* APF PARM, AC=1        @VS08700*/ 01000000
@RF00403 LR    @05,I                                               0409 01001000
         MH    @05,@CH01006                                        0409 01002000
         L     @02,CCAICLMD(,CCAPTR)                               0409 01003000
         ALR   @02,@05                                             0409 01004000
         AL    @02,@CF01921                                        0409 01005000
         TM    ICTLAPF-9(@02),B'10000000'                          0409 01006000
         BNO   @RF00409                                            0409 01007000
*     DO;                           /*                       @VS08700*/ 01008000
*       LX=LY+L1;                   /* CALC DISP             @VS08700*/ 01009000
         LA    LX,1                                                0411 01010000
         ALR   LX,LY                                               0411 01011000
*       LY=LY+L5;                   /* CALC DISP             @VS08700*/ 01012000
         AH    LY,@CH01674                                         0412 01013000
*       OPTVAR(LX:LY)=APF;          /* PASS APF PARM,AC=1 TO EDITOR     01014000
*                                                            @VS08700*/ 01015000
         LA    @02,OPTVAR-1(LX)                                    0413 01016000
         LR    @15,LY                                              0413 01017000
         SLR   @15,LX                                              0413 01018000
         EX    @15,@SM01939                                        0413 01019000
*     END;                          /*                       @VS08700*/ 01020000
*   IF ICTLPAGA(I)=ON               /* VS ALIGN2 OPTION SPECIFIED? 0415 01021000
*                                                            @XA05949*/ 01022000
*     THEN                          /* YES                   @XA05949*/ 01023000
@RF00409 LR    @05,I                                               0415 01024000
         MH    @05,@CH01006                                        0415 01025000
         L     @02,CCAICLMD(,CCAPTR)                               0415 01026000
         ALR   @02,@05                                             0415 01027000
         AL    @02,@CF01936                                        0415 01028000
         TM    ICTLPAGA-10(@02),B'01000000'                        0415 01029000
         BNO   @RF00415                                            0415 01030000
*     DO;                           /* PROCESS IT            @XA05949*/ 01031000
*       LX=LY+1;                    /* SET STARTING POINT    @XA05949*/ 01032000
         LA    LX,1                                                0417 01033000
         ALR   LX,LY                                               0417 01034000
*       LY=LY+LENGTH(ALIGN2);       /* SET ENDING ADDR       @XA05949*/ 01035000
         AH    LY,@CH00238                                         0418 01036000
*       OPTVAR(LX:LY)=ALIGN2;       /* MOVE ALIGN2 TO PARM   @XA05949*/ 01037000
         LA    @02,OPTVAR-1(LX)                                    0419 01038000
         LR    @15,LY                                              0419 01039000
         SLR   @15,LX                                              0419 01040000
         EX    @15,@SM01941                                        0419 01041000
*     END;                          /* END ALIGN2 PROCESSING @XA05949*/ 01042000
*                                                                  0420 01043000
*   /*****************************************************************/ 01044000
*   /*                                                               */ 01045000
*   /* CALCULATE PARM LENGTH                                 @Z67SP00*/ 01046000
*   /*                                                               */ 01047000
*   /*****************************************************************/ 01048000
*                                                                  0421 01049000
*   IF LY^=ZERO THEN                /*                       @Z67SP00*/ 01050000
@RF00415 LTR   LY,LY                                               0421 01051000
         BZ    @RF00421                                            0421 01052000
*     OPTLGTH=LY-1;                 /*                       @Z67SP00*/ 01053000
         LR    @05,LY                                              0422 01054000
         BCTR  @05,0                                               0422 01055000
         STH   @05,OPTLGTH                                         0422 01056000
*   ASYSLMOD=ICTTG1(I);             /* SET SYSLMOD FOR LINK          */ 01057000
@RF00421 LR    @05,I                                               0423 01058000
         MH    @05,@CH01006                                        0423 01059000
         L     @01,CCAICLMD(,CCAPTR)                               0423 01060000
         ALR   @01,@05                                             0423 01061000
         AL    @01,@CF01943                                        0423 01062000
         MVC   ASYSLMOD(8),ICTTG1-15(@01)                          0423 01063000
*   END PARMS;                      /*                       @Z67SP00*/ 01064000
@EL00003 DS    0H                                                  0424 01065000
@EF00003 DS    0H                                                  0424 01066000
@ER00003 LM    @14,@12,12(@13)                                     0424 01067000
         BR    @14                                                 0424 01068000
*                                                                  0425 01069000
*   /*****************************************************************/ 01070000
*   /*                                                               */ 01071000
*   /* LINK TO THE LINKAGE EDITOR                            @Z67SP00*/ 01072000
*   /*                                                               */ 01073000
*   /*****************************************************************/ 01074000
*                                                                  0425 01075000
*LINK:                                                             0425 01076000
*   PROCEDURE;                                                     0425 01077000
*                                                                  0425 01078000
LINK     STM   @14,@05,@SA00004                                    0425 01079000
         STM   @07,@12,@SA00004+32                                 0425 01080000
*   /*****************************************************************/ 01081000
*   /*                                                               */ 01082000
*   /* CLOSE SYSUT1 WHICH IS SYSLIN TO THE LINKAGE EDITOR    @Z67SP00*/ 01083000
*   /*                                                               */ 01084000
*   /*****************************************************************/ 01085000
*                                                                  0426 01086000
*   CALL CLOSE;                     /* CLOSE SCR1 DATA SET           */ 01087000
*                                                                  0426 01088000
         BAL   @14,CLOSE                                           0426 01089000
*   /*****************************************************************/ 01090000
*   /*                                                               */ 01091000
*   /* ALLOCATE RELFILE DATASET IF REQUIRED                  @Z67SP00*/ 01092000
*   /*                                                               */ 01093000
*   /*****************************************************************/ 01094000
*                                                                  0427 01095000
*   IF LKIRTNCD<STOPPTF             /*                       @Z67SP00*/ 01096000
*       &RELFALC=ON                 /* IF RELFILE ALLOC REQ  @Z67SP00*/ 01097000
*     THEN                          /*                       @Z67SP00*/ 01098000
         CH    LKIRTNCD,@CH00110                                   0427 01099000
         BNL   @RF00427                                            0427 01100000
         TM    RELFALC,B'00000100'                                 0427 01101000
         BNO   @RF00427                                            0427 01102000
*     DO;                           /*                       @Z67SP00*/ 01103000
*       IOPFUNCT=IOPALC;            /* ALLOCATE IT           @Z67SP00*/ 01104000
         L     @07,IOPPTR                                          0429 01105000
         MVI   IOPFUNCT(@07),X'0D'                                 0429 01106000
*       IOPDSID=IOPLRF;             /*                       @Z67SP00*/ 01107000
         MVI   IOPDSID(@07),X'20'                                  0430 01108000
*       IOPDSN=CILPTFDS;            /*                       @Z67SP00*/ 01109000
         MVC   IOPDSN(44,@07),CILPTFDS                             0431 01110000
*       IOPSPACE=''B;               /*                       @Z67SP00*/ 01111000
         XC    IOPSPACE(6,@07),IOPSPACE(@07)                       0432 01112000
*       CALL HMASMIO(HMASMIOP);     /*                       @Z67SP00*/ 01113000
         ST    @07,@AL00001                                        0433 01114000
         L     @15,@CV01634                                        0433 01115000
         LA    @01,@AL00001                                        0433 01116000
         BALR  @14,@15                                             0433 01117000
*       LKIRTNCD=MAX(LKIRTNCD,IOPRETRN);/* SAVE RC           @Z67SP00*/ 01118000
         L     @07,IOPPTR                                          0434 01119000
         SLR   @15,@15                                             0434 01120000
         IC    @15,IOPRETRN(,@07)                                  0434 01121000
         CR    LKIRTNCD,@15                                        0434 01122000
         BNL   *+6                                                      01123000
         LR    LKIRTNCD,@15                                        0434 01124000
*       RELFALCD=ON;                /*                       @Z67SP00*/ 01125000
         OI    RELFALCD,B'00000010'                                0435 01126000
*     END;                          /*                       @Z67SP00*/ 01127000
*   ELSE                            /*                       @Z67SP00*/ 01128000
*     RELFALCD=OFF;                 /*                       @Z67SP00*/ 01129000
*                                                                  0437 01130000
         B     @RC00427                                            0437 01131000
@RF00427 NI    RELFALCD,B'11111101'                                0437 01132000
*   /*****************************************************************/ 01133000
*   /*                                                               */ 01134000
*   /* IF ALL OK THEN CALL IEWL                              @Z67SP00*/ 01135000
*   /*                                                               */ 01136000
*   /*****************************************************************/ 01137000
*                                                                  0438 01138000
*   IF LKIRTNCD<STOPPTF             /*                       @Z67SP00*/ 01139000
*     THEN                          /*                       @Z67SP00*/ 01140000
@RC00427 CH    LKIRTNCD,@CH00110                                   0438 01141000
         BNL   @RF00438                                            0438 01142000
*     DO;                           /*                       @Z67SP00*/ 01143000
*       RFY                                                        0440 01144000
*         LINKREG RSTD;                                            0440 01145000
*       LINKREG=CCALKED;            /* ADDR BLDL ENTRY - LKED        */ 01146000
         L     @07,CCABLDLP(,CCAPTR)                               0441 01147000
         L     LINKREG,CCALKED(,@07)                               0441 01148000
*       SAVRVANM=RVAEPRNM;          /* SAVE SMP PROCESSOR NM @Z67SP00*/ 01149000
         L     @03,CCARVAD(,CCAPTR)                                0442 01150000
         MVC   SAVRVANM(8),RVAEPRNM(@03)                           0442 01151000
*       RVAEPRNM=CCALKDNM;          /* INDICATE LINKEDITOR   @Z67SP00*/ 01152000
         MVC   RVAEPRNM(8,@03),CCALKDNM(@07)                       0443 01153000
*       GENERATE;                                                  0444 01154000
         LINK  DE=(LINKREG),PARAM=(OPTLST,DDNAMES),VL=1 EXEC LKED   */  01155000
*       RFY                                                        0445 01156000
*         RTNCODE RSTD;             /*                       @Z67SP00*/ 01157000
*       RVAEPRNM=SAVRVANM;          /* RESTORE SMP NAME      @Z67SP00*/ 01158000
         L     @14,CCARVAD(,CCAPTR)                                0446 01159000
         MVC   RVAEPRNM(8,@14),SAVRVANM                            0446 01160000
*       RFY                                                        0447 01161000
*         LINKREG UNRSTD;                                          0447 01162000
*       CVD(RTNCODE,SAVE1);         /* CONVERT TO DECIMAL    @Z40SP00*/ 01163000
         CVD   RTNCODE,SAVE1                                       0448 01164000
*       UNPK(SAVE2,SAVE1);          /* UNPACK                @Z40SP00*/ 01165000
         UNPK  SAVE2(8),SAVE1(8)                                   0449 01166000
*       SIGN=MASK;                  /* ELIMINATE SIGN BIT    @Z40SP00*/ 01167000
         OI    SIGN,B'11110000'                                    0450 01168000
*       IF RTNCODE>CCARLINK         /* SUCCESSFUL RETURN?    @YA07506*/ 01169000
*         THEN                                                     0451 01170000
         L     @14,CCABLDLP(,CCAPTR)                               0451 01171000
         SLR   @07,@07                                             0451 01172000
         IC    @07,CCARLINK(,@14)                                  0451 01173000
         CR    RTNCODE,@07                                         0451 01174000
         BNH   @RF00451                                            0451 01175000
*         DO;                                                      0452 01176000
*           LKIRTNCD=MAX(LKIRTNCD,STOPPTF);/* SET RC         @ZA16652*/ 01177000
         LA    @14,8                                               0453 01178000
         CR    LKIRTNCD,@14                                        0453 01179000
         BNL   *+6                                                      01180000
         LR    LKIRTNCD,@14                                        0453 01181000
*           LINKERR=ON;             /* SET ERROR INDICATOR           */ 01182000
         OI    LINKERR,B'00100000'                                 0454 01183000
*         END;                                                     0455 01184000
*       ELSE                                                       0456 01185000
*         DO;                                                      0456 01186000
         B     @RC00451                                            0456 01187000
@RF00451 DS    0H                                                  0457 01188000
*           IF RTNCODE^=ZERO        /* IF NON-ZERO RTN       @ZA16652*/ 01189000
*             THEN                  /* THEN MUST BE          @ZA16652*/ 01190000
         LTR   RTNCODE,RTNCODE                                     0457 01191000
         BZ    @RF00457                                            0457 01192000
*             LKIRTNCD=MAX(LKIRTNCD,WARNPTF);/* SET RC       @ZA16652*/ 01193000
         LA    @14,4                                               0458 01194000
         CR    LKIRTNCD,@14                                        0458 01195000
         BNL   *+6                                                      01196000
         LR    LKIRTNCD,@14                                        0458 01197000
*         END;                                                     0459 01198000
*                                                                  0459 01199000
@RF00457 DS    0H                                                  0460 01200000
*       /*************************************************************/ 01201000
*       /*                                                           */ 01202000
*       /* ISSUE MESSAGES FOR LINK COMPLETION                @Z67SP00*/ 01203000
*       /*                                                           */ 01204000
*       /*************************************************************/ 01205000
*                                                                  0460 01206000
*       CALL COMPMSG;               /* CALL COMPLETE RTN     @Z67SP00*/ 01207000
@RC00451 BAL   @14,COMPMSG                                         0460 01208000
*     END;                          /*                       @Z67SP00*/ 01209000
*   RFY                                                            0462 01210000
*     RTNCODE UNRSTD;               /*                       @Z67SP00*/ 01211000
*                                                                  0462 01212000
@RF00438 DS    0H                                                  0463 01213000
*   /*****************************************************************/ 01214000
*   /*                                                               */ 01215000
*   /* NOW FREE ALLOCATED RELFILES                           @Z67SP00*/ 01216000
*   /*                                                               */ 01217000
*   /*****************************************************************/ 01218000
*                                                                  0463 01219000
*   RELFALC=OFF;                    /*                       @Z67SP00*/ 01220000
         NI    RELFALC,B'11111011'                                 0463 01221000
*   IF RELFALCD=ON                  /*                       @Z67SP00*/ 01222000
*     THEN                          /*                       @Z67SP00*/ 01223000
         TM    RELFALCD,B'00000010'                                0464 01224000
         BNO   @RF00464                                            0464 01225000
*     DO;                           /*                       @Z67SP00*/ 01226000
*       IOPFUNCT=IOPDALC;           /*                       @Z67SP00*/ 01227000
         L     @07,IOPPTR                                          0466 01228000
         MVI   IOPFUNCT(@07),X'0E'                                 0466 01229000
*       IOPDSID=IOPLRF;             /*                       @Z67SP00*/ 01230000
         MVI   IOPDSID(@07),X'20'                                  0467 01231000
*       IOPDSN=CILPTFDS;            /*                       @Z67SP00*/ 01232000
         MVC   IOPDSN(44,@07),CILPTFDS                             0468 01233000
*       IOPSPACE=''B;               /*                       @Z67SP00*/ 01234000
         XC    IOPSPACE(6,@07),IOPSPACE(@07)                       0469 01235000
*       CALL HMASMIO(HMASMIOP);     /*                       @Z67SP00*/ 01236000
         ST    @07,@AL00001                                        0470 01237000
         L     @15,@CV01634                                        0470 01238000
         LA    @01,@AL00001                                        0470 01239000
         BALR  @14,@15                                             0470 01240000
*       LKIRTNCD=MAX(LKIRTNCD,IOPRETRN);/* SAVE RC           @Z67SP00*/ 01241000
         L     @07,IOPPTR                                          0471 01242000
         SLR   @15,@15                                             0471 01243000
         IC    @15,IOPRETRN(,@07)                                  0471 01244000
         CR    LKIRTNCD,@15                                        0471 01245000
         BNL   *+6                                                      01246000
         LR    LKIRTNCD,@15                                        0471 01247000
*       RELFALCD=OFF;               /*                       @Z67SP00*/ 01248000
         NI    RELFALCD,B'11111101'                                0472 01249000
*     END;                          /*                       @Z67SP00*/ 01250000
*   END LINK;                                                      0474 01251000
@EL00004 DS    0H                                                  0474 01252000
@EF00004 DS    0H                                                  0474 01253000
@ER00004 LM    @14,@05,@SA00004                                    0474 01254000
         LM    @07,@12,@SA00004+32                                 0474 01255000
         BR    @14                                                 0474 01256000
         EJECT                                                          01257000
*                                                                  0475 01258000
*   /*****************************************************************/ 01259000
*   /*                                                               */ 01260000
*   /* THIS PROCEDURE GAINS CONTROL ON A EOF RETURN FROM THE I/O     */ 01261000
*   /* ROUTINE. IT BUILDS AN INCLUDE CARD FOR THE MODULE CURRENTLY   */ 01262000
*   /* BEING PROCESSED IF ONE HAS NOT BEEN ALREADY AND AN INCLUDE    */ 01263000
*   /* CARD FOR ANY MODULES THAT STILL REMAIN ON THE ICT. IT THEN    */ 01264000
*   /* BUILDS AN INCLUDE CARD FOR THE LOAD MODULE, FOLLOWED BY A NAME*/ 01265000
*   /* CARD.                                                         */ 01266000
*   /*                                                               */ 01267000
*   /*****************************************************************/ 01268000
*                                                                  0475 01269000
*MODCHK:                                                           0475 01270000
*   PROCEDURE;                                                     0475 01271000
MODCHK   STM   @14,@05,@SA00005                                    0475 01272000
         STM   @07,@12,@SA00005+32                                 0475 01273000
*   RFY                                                            0476 01274000
*    (ICTLMOD) BASED(CCAICLMD);                                    0476 01275000
*   RFY                                                            0477 01276000
*    (ICTIXLF) BASED(ICTLCHN(I));                                  0477 01277000
*   RFY                                                            0478 01278000
*    (ICTMOD) BASED(ICTIXL(J));                                    0478 01279000
*   RFY                                                            0479 01280000
*    (ICTPTF) BASED(ICTPPTR(1));                                   0479 01281000
*                                                                  0479 01282000
*   /*****************************************************************/ 01283000
*   /*                                                               */ 01284000
*   /* LOOP THRU THE MODULES IN THE LOAD MODULE              @ZD00001*/ 01285000
*   /*                                                               */ 01286000
*   /*****************************************************************/ 01287000
*                                                                  0480 01288000
*   DO J=1 BY 1 WHILE ICTIXL(J)^=ICTENDIX;/* SEARCH MODS     @Z67SP00*/ 01289000
         LA    J,1                                                 0480 01290000
         B     @DE00480                                            0480 01291000
@DL00480 DS    0H                                                  0481 01292000
*     IF(ICTMPROC(1)=OFF&           /* IF MOD NOT INPROCESS-         */ 01293000
*         ICTMCPL(1)=OFF)           /* NOT COMPLETE          @OY04018*/ 01294000
*         &ICTMISEL(1)=ON           /* SELECTED              @Z67SP00*/ 01295000
*         &ICTMMOD(1)=ON            /* MOD REPLACEMENT       @Z67SP00*/ 01296000
*         &ICTMXPND(1)=OFF          /* NOT EXPAND ENTRY      @Z67SP00*/ 01297000
*       THEN                        /* THEN BUILD THE MOD INCLUDE  0481 01298000
*                                      CARD BEFORE           @OY04018*/ 01299000
         LR    @07,J                                               0481 01300000
         SLA   @07,2                                               0481 01301000
         LR    @05,I                                               0481 01302000
         MH    @05,@CH01006                                        0481 01303000
         L     @02,CCAICLMD(,CCAPTR)                               0481 01304000
         AL    @02,@CF01912                                        0481 01305000
         L     @05,ICTLCHN-34(@05,@02)                             0481 01306000
         AL    @05,@CF01913                                        0481 01307000
         L     @07,ICTIXL(@07,@05)                                 0481 01308000
         TM    ICTMPROC(@07),B'10100000'                           0481 01309000
         BNZ   @RF00481                                            0481 01310000
         TM    ICTMISEL(@07),B'10000000'                           0481 01311000
         BNO   @RF00481                                            0481 01312000
         TM    ICTMMOD(@07),B'10000000'                            0481 01313000
         BNO   @RF00481                                            0481 01314000
         TM    ICTMXPND(@07),B'00010000'                           0481 01315000
         BNZ   @RF00481                                            0481 01316000
*       DO;                         /* THE LMOD INCLUDE CARD @OY04018*/ 01317000
*         LIBNAME=ICTFMLIB(1);      /* SET LIB NAME                  */ 01318000
         MVC   LIBNAME(8),ICTFMLIB(@07)                            0483 01319000
*         MEMNAME=ICTMNAME(1);      /* SET MEMBER NAME               */ 01320000
         MVC   MEMNAME(8),ICTMNAME(@07)                            0484 01321000
*         PTFNO=ICTPTFS(1);         /* PTF NO FOR PRINTING   @ZD00001*/ 01322000
         L     @05,ICTPPTR(,@07)                                   0485 01323000
         MVC   PTFNO(7),ICTPTFS(@05)                               0485 01324000
*         IF CILPTFNO=PTFNO         /* IF MOD FROM PTF       @Z67SP00*/ 01325000
*             &ICTMRELN(1)^=ZERO    /* AND RELFILE           @Z67SP00*/ 01326000
*             &ICTMTRX(1)=OFF       /* AND NOT MOVED         @Z67SP00*/ 01327000
*           THEN                    /* THEN NEED TO ALLOC    @Z67SP00*/ 01328000
         CLC   CILPTFNO(7),PTFNO                                   0486 01329000
         BNE   @RF00486                                            0486 01330000
         ICM   @05,3,ICTMRELN(@07)                                 0486 01331000
         BZ    @RF00486                                            0486 01332000
         TM    ICTMTRX(@07),B'00010000'                            0486 01333000
         BNZ   @RF00486                                            0486 01334000
*           RELFALC=ON;             /* RELFILE               @Z67SP00*/ 01335000
         OI    RELFALC,B'00000100'                                 0487 01336000
*         CALL CTLSTMT;             /* CALL CTLSTMT ROUTINE          */ 01337000
@RF00486 BAL   @14,CTLSTMT                                         0488 01338000
*         IF LKIRTNCD>=STOPFUNC     /* STOP FUNCTION?        @YA07506*/ 01339000
*           THEN                                                   0489 01340000
         CH    LKIRTNCD,@CH00032                                   0489 01341000
         BNL   @RT00489                                            0489 01342000
*           RETURN;                 /* YES                   @YA07506*/ 01343000
*         ICTMPROC(1)=ON;           /* SET INPROCESS BIT             */ 01344000
         LR    @07,J                                               0491 01345000
         SLA   @07,2                                               0491 01346000
         LR    @05,I                                               0491 01347000
         MH    @05,@CH01006                                        0491 01348000
         L     @02,CCAICLMD(,CCAPTR)                               0491 01349000
         AL    @02,@CF01912                                        0491 01350000
         L     @05,ICTLCHN-34(@05,@02)                             0491 01351000
         AL    @05,@CF01913                                        0491 01352000
         L     @07,ICTIXL(@07,@05)                                 0491 01353000
         OI    ICTMPROC(@07),B'10000000'                           0491 01354000
*       END;                                                       0492 01355000
*   END;                                                           0493 01356000
*                                                                  0493 01357000
@RF00481 AH    J,@CH00085                                          0493 01358000
@DE00480 LR    @07,J                                               0493 01359000
         SLA   @07,2                                               0493 01360000
         LR    @05,I                                               0493 01361000
         MH    @05,@CH01006                                        0493 01362000
         L     @02,CCAICLMD(,CCAPTR)                               0493 01363000
         LA    @01,0(@05,@02)                                      0493 01364000
         AL    @01,@CF01912                                        0493 01365000
         L     @01,ICTLCHN-34(,@01)                                0493 01366000
         AL    @01,@CF01913                                        0493 01367000
         L     @07,ICTIXL(@07,@01)                                 0493 01368000
         CL    @07,ICTENDIX                                        0493 01369000
         BNE   @DL00480                                            0493 01370000
*   /*****************************************************************/ 01371000
*   /*                                                               */ 01372000
*   /* CHECK FOR NEED TO BYPASS BUILD OF LMOD INCLUDE FROM SYSLMOD.  */ 01373000
*   /*                                                       @Z67SP00*/ 01374000
*   /*                                                               */ 01375000
*   /*****************************************************************/ 01376000
*                                                                  0494 01377000
*   IF ICTLNE(I)=ON                 /* IF NOT-EDITABLE       @Z67SP00*/ 01378000
*       |(CCAACCPT=ON&ICTLXPND(I)=OFF)/* ..OR ACCEPT AND EXPAND    0494 01379000
*                                                            @Z67SP00*/ 01380000
*       |(ICTCOPY(I)=ON&ICTLXPND(I)=OFF)/* .. OR SYSGEN COPY LMOD  0494 01381000
*                                      BEING EXPANDED        @Z67SP00*/ 01382000
*     THEN                                                         0494 01383000
         ST    @05,@TF00001                                        0494 01384000
         ALR   @05,@02                                             0494 01385000
         AL    @05,@CF01936                                        0494 01386000
         TM    ICTLNE-10(@05),B'10000000'                          0494 01387000
         BO    @RT00494                                            0494 01388000
         TM    CCAACCPT(CCAPTR),B'00100000'                        0494 01389000
         BNO   @GL00033                                            0494 01390000
         AL    @02,@TF00001                                        0494 01391000
         AL    @02,@CF01910                                        0494 01392000
         TM    ICTLXPND-14(@02),B'00100000'                        0494 01393000
         BZ    @RT00494                                            0494 01394000
@GL00033 LR    @07,I                                               0494 01395000
         MH    @07,@CH01006                                        0494 01396000
         L     @05,CCAICLMD(,CCAPTR)                               0494 01397000
         ST    @07,@TF00001                                        0494 01398000
         ALR   @07,@05                                             0494 01399000
         AL    @07,@CF01949                                        0494 01400000
         TM    ICTCOPY-13(@07),B'10000000'                         0494 01401000
         BNO   @RF00494                                            0494 01402000
         AL    @05,@TF00001                                        0494 01403000
         AL    @05,@CF01910                                        0494 01404000
         TM    ICTLXPND-14(@05),B'00100000'                        0494 01405000
         BZ    @RT00494                                            0494 01406000
*     ;                             /* THEN INCLUDE STATEMENT WILL 0495 01407000
*                                      NOT BE BUILT          @Z67SP00*/ 01408000
*   ELSE                            /* OTHERWISE THE LMOD INCLUDE IS    01409000
*                                      CONSTRUCTED                   */ 01410000
*     DO;                                                          0496 01411000
@RF00494 DS    0H                                                  0497 01412000
*       LIBNAME=ICTTG1(I);          /* SET LIB NAME                  */ 01413000
         LR    @07,I                                               0497 01414000
         MH    @07,@CH01006                                        0497 01415000
         L     @05,CCAICLMD(,CCAPTR)                               0497 01416000
         ST    @07,@TF00001                                        0497 01417000
         ALR   @07,@05                                             0497 01418000
         AL    @07,@CF01943                                        0497 01419000
         MVC   LIBNAME(8),ICTTG1-15(@07)                           0497 01420000
*       MEMNAME=ICTLMNAM(I);        /* SET LM NAME                   */ 01421000
         AL    @05,@TF00001                                        0498 01422000
         AL    @05,@CF01916                                        0498 01423000
         MVC   MEMNAME(8),ICTLMNAM(@05)                            0498 01424000
*       PTFNO=BLANK;                /* NO PTF NO. PRINTED    @ZD00001*/ 01425000
         MVI   PTFNO+1,C' '                                        0499 01426000
         MVC   PTFNO+2(5),PTFNO+1                                  0499 01427000
         MVI   PTFNO,C' '                                          0499 01428000
*       CALL CTLSTMT;               /* INCLUDE FROM SYSLMOD          */ 01429000
         BAL   @14,CTLSTMT                                         0500 01430000
*       IF LKIRTNCD>=STOPFUNC       /* STOP FUNCTION?        @YA07506*/ 01431000
*         THEN                                                     0501 01432000
         CH    LKIRTNCD,@CH00032                                   0501 01433000
         BNL   @RT00501                                            0501 01434000
*         RETURN;                   /* YES                   @YA07506*/ 01435000
*     END;                                                         0503 01436000
*                                                                  0503 01437000
*   /*****************************************************************/ 01438000
*   /*                                                               */ 01439000
*   /* BUILD INCLUDE FOR EXPAND CARDS AFTER LMOD INCLUDE     @OY04018*/ 01440000
*   /*                                                               */ 01441000
*   /*****************************************************************/ 01442000
*                                                                  0504 01443000
*   DO J=1 BY 1                     /* SEARCH THRU MODSIN THIS LMOD     01444000
*                                                            @Z67SP00*/ 01445000
*         WHILE ICTIXL(J)^=ICTENDIX;/* LOOK FOR EXPANDABLES  @Z67SP00*/ 01446000
@RT00494 LA    J,1                                                 0504 01447000
         B     @DE00504                                            0504 01448000
@DL00504 DS    0H                                                  0505 01449000
*     IF ICTMPROC(1)=OFF            /* IS MOD NOT INPROCESS  @OY04018*/ 01450000
*         &ICTMCPL(1)=OFF           /* AND NOT COMPLETE      @OY04018*/ 01451000
*         &ICTMISEL(1)=ON           /* SELECTED              @Z67SP00*/ 01452000
*         &ICTMXPND(1)=ON THEN      /* AND EXPANDABLE        @OY04018*/ 01453000
         LR    @07,J                                               0505 01454000
         SLA   @07,2                                               0505 01455000
         LR    @05,I                                               0505 01456000
         MH    @05,@CH01006                                        0505 01457000
         L     @02,CCAICLMD(,CCAPTR)                               0505 01458000
         AL    @02,@CF01912                                        0505 01459000
         L     @05,ICTLCHN-34(@05,@02)                             0505 01460000
         AL    @05,@CF01913                                        0505 01461000
         L     @07,ICTIXL(@07,@05)                                 0505 01462000
         TM    ICTMPROC(@07),B'10100000'                           0505 01463000
         BNZ   @RF00505                                            0505 01464000
         TM    ICTMISEL(@07),B'10000000'                           0505 01465000
         BNO   @RF00505                                            0505 01466000
         TM    ICTMXPND(@07),B'00010000'                           0505 01467000
         BNO   @RF00505                                            0505 01468000
*       DO;                         /* THEN CREATE INCLUDE FOR EXPAND   01469000
*                                      CARDS ON PTS@OY04018          */ 01470000
*         LIBNAME=ICTFMLIB(1);      /* LIB NAME FOR INCLUDE, PTS   0507 01471000
*                                                            @OY04018*/ 01472000
         MVC   LIBNAME(8),ICTFMLIB(@07)                            0507 01473000
*         MEMNAME=ICTMNAME(1);      /* MOOVE IN MOD NAME FROM ICT  0508 01474000
*                                                            @OY04018*/ 01475000
         MVC   MEMNAME(8),ICTMNAME(@07)                            0508 01476000
*         PTFNO=ICTPTFS(1);         /* PTF FOR PRINTING      @ZD00001*/ 01477000
         L     @07,ICTPPTR(,@07)                                   0509 01478000
         MVC   PTFNO(7),ICTPTFS(@07)                               0509 01479000
*         CALL CTLSTMT;             /* BUILD LOWERCASE NAME INCLUDE     01480000
*                                                            @OY04018*/ 01481000
         BAL   @14,CTLSTMT                                         0510 01482000
*         ICTMPROC(1)=ON;           /* MOD INPROCESS         @OY05117*/ 01483000
         LR    @07,J                                               0511 01484000
         SLA   @07,2                                               0511 01485000
         LR    @05,I                                               0511 01486000
         MH    @05,@CH01006                                        0511 01487000
         L     @02,CCAICLMD(,CCAPTR)                               0511 01488000
         AL    @02,@CF01912                                        0511 01489000
         L     @05,ICTLCHN-34(@05,@02)                             0511 01490000
         AL    @05,@CF01913                                        0511 01491000
         L     @07,ICTIXL(@07,@05)                                 0511 01492000
         OI    ICTMPROC(@07),B'10000000'                           0511 01493000
*         IF LKIRTNCD>=STOPFUNC     /* STOP FUNCTION?        @YA07506*/ 01494000
*           THEN                                                   0512 01495000
         CH    LKIRTNCD,@CH00032                                   0512 01496000
         BNL   @RT00512                                            0512 01497000
*           RETURN;                 /* YES                   @YA07506*/ 01498000
*       END;                        /* END OF BUILD INCLUDE DO     0514 01499000
*                                                            @OY04018*/ 01500000
*   END;                            /* END OF LOOP LOOKING OF      0515 01501000
*                                      EXPANDABLE MODS       @OY04018*/ 01502000
*                                                                  0515 01503000
@RF00505 AH    J,@CH00085                                          0515 01504000
@DE00504 LR    @07,J                                               0515 01505000
         SLA   @07,2                                               0515 01506000
         LR    @05,I                                               0515 01507000
         MH    @05,@CH01006                                        0515 01508000
         L     @02,CCAICLMD(,CCAPTR)                               0515 01509000
         LA    @01,0(@05,@02)                                      0515 01510000
         AL    @01,@CF01912                                        0515 01511000
         L     @15,ICTLCHN-34(,@01)                                0515 01512000
         AL    @07,@CF01913                                        0515 01513000
         L     @07,ICTIXL(@07,@15)                                 0515 01514000
         CL    @07,ICTENDIX                                        0515 01515000
         BNE   @DL00504                                            0515 01516000
*   /*****************************************************************/ 01517000
*   /*                                                               */ 01518000
*   /* ALIAS STATEMENTS BUILT                                @ZD00001*/ 01519000
*   /*                                                               */ 01520000
*   /*****************************************************************/ 01521000
*                                                                  0516 01522000
*   J=1;                            /* SET INDEX TO MOD SECTION      */ 01523000
         LA    @07,1                                               0516 01524000
         LR    J,@07                                               0516 01525000
*   RFY                                                            0517 01526000
*     ICTTALLS BASED(ICTMTCHN(1));  /* ALIAS NAME LIST BASE  @Z67SP00*/ 01527000
*   IF ICTMALIS(1)=ON               /* ALIAS ON ++MOD        @ZA16651*/ 01528000
*       &ICTMNAME(1)=ICTLMNAM(I)    /* AND COPIED AT SYSGEN  @ZA16651*/ 01529000
*     THEN                          /* THEN LMOD NEEDS ALIAS         */ 01530000
         LR    @14,J                                               0518 01531000
         SLA   @14,2                                               0518 01532000
         AL    @15,@CF01913                                        0518 01533000
         L     @15,ICTIXL(@14,@15)                                 0518 01534000
         TM    ICTMALIS(@15),B'00000100'                           0518 01535000
         BNO   @RF00518                                            0518 01536000
         ALR   @02,@05                                             0518 01537000
         AL    @02,@CF01916                                        0518 01538000
         CLC   ICTMNAME(8,@15),ICTLMNAM(@02)                       0518 01539000
         BNE   @RF00518                                            0518 01540000
*     DO;                                                          0519 01541000
*                                                                  0519 01542000
*       /*************************************************************/ 01543000
*       /*                                                           */ 01544000
*       /* MOD COUNTER RESET FOR COPIED LMODS WHERE MODS AND LMODS   */ 01545000
*       /* ARE ONE FOR ONE.                                  @Z67SP00*/ 01546000
*       /*                                                           */ 01547000
*       /*************************************************************/ 01548000
*                                                                  0520 01549000
*       DO R=1 BY 1 WHILE ICTTALND(R)^=ICTENDIX;/*           @Z67SP00*/ 01550000
         LR    R,@07                                               0520 01551000
         B     @DE00520                                            0520 01552000
@DL00520 DS    0H                                                  0521 01553000
*         BUFFER=BLANK;             /* BLANK THE BUFFER              */ 01554000
         L     @07,IOPPTR                                          0521 01555000
         L     @07,IOPBUFAD(,@07)                                  0521 01556000
         MVI   BUFFER+1(@07),C' '                                  0521 01557000
         MVC   BUFFER+2(78,@07),BUFFER+1(@07)                      0521 01558000
         MVI   BUFFER(@07),C' '                                    0521 01559000
*         BUFFER(L2:L6)=ALIAS;      /* MOVE IN ALIAS STMT            */ 01560000
         MVC   BUFFER+1(5,@07),ALIAS                               0522 01561000
*         BUFFER(L8:L15)=ICTTALNM(R);/* PUT IN NAME          @Z67SP00*/ 01562000
         LR    @02,R                                               0523 01563000
         SLA   @02,3                                               0523 01564000
         LR    @15,J                                               0523 01565000
         SLA   @15,2                                               0523 01566000
         LR    @14,I                                               0523 01567000
         MH    @14,@CH01006                                        0523 01568000
         L     @01,CCAICLMD(,CCAPTR)                               0523 01569000
         AL    @01,@CF01912                                        0523 01570000
         L     @01,ICTLCHN-34(@14,@01)                             0523 01571000
         AL    @01,@CF01913                                        0523 01572000
         L     @01,ICTIXL(@15,@01)                                 0523 01573000
         L     @01,ICTMTCHN(,@01)                                  0523 01574000
         ALR   @01,@02                                             0523 01575000
         AL    @01,@CF01950                                        0523 01576000
         MVC   BUFFER+7(8,@07),ICTTALNM(@01)                       0523 01577000
*         CALL WRITE;               /* WRITE STMT OUT                */ 01578000
         BAL   @14,WRITE                                           0524 01579000
*         IF LKIRTNCD>=STOPFUNC     /* STOP A FUNCTION?      @YA07506*/ 01580000
*           THEN                                                   0525 01581000
         CH    LKIRTNCD,@CH00032                                   0525 01582000
         BNL   @RT00525                                            0525 01583000
*           RETURN;                 /* YES                   @YA07506*/ 01584000
*       END;                                                       0527 01585000
         AH    R,@CH00085                                          0527 01586000
@DE00520 LR    @07,R                                               0527 01587000
         SLA   @07,3                                               0527 01588000
         LR    @02,J                                               0527 01589000
         SLA   @02,2                                               0527 01590000
         LR    @15,I                                               0527 01591000
         MH    @15,@CH01006                                        0527 01592000
         L     @01,CCAICLMD(,CCAPTR)                               0527 01593000
         AL    @01,@CF01912                                        0527 01594000
         L     @01,ICTLCHN-34(@15,@01)                             0527 01595000
         AL    @01,@CF01913                                        0527 01596000
         L     @02,ICTIXL(@02,@01)                                 0527 01597000
         L     @02,ICTMTCHN(,@02)                                  0527 01598000
         AL    @02,@CF01950                                        0527 01599000
         L     @07,ICTTALND(@07,@02)                               0527 01600000
         CL    @07,ICTENDIX                                        0527 01601000
         BNE   @DL00520                                            0527 01602000
*     END;                          /*                       @YA07506*/ 01603000
*                                                                  0528 01604000
*   /*****************************************************************/ 01605000
*   /*                                                               */ 01606000
*   /* NAME STATEMENT                                        @ZA16651*/ 01607000
*   /*                                                               */ 01608000
*   /*****************************************************************/ 01609000
*                                                                  0529 01610000
*   BUFFER=BLANK;                   /* CLEAR BUFFER                  */ 01611000
@RF00518 L     @07,IOPPTR                                          0529 01612000
         L     @07,IOPBUFAD(,@07)                                  0529 01613000
         MVI   BUFFER+1(@07),C' '                                  0529 01614000
         MVC   BUFFER+2(78,@07),BUFFER+1(@07)                      0529 01615000
         MVI   BUFFER(@07),C' '                                    0529 01616000
*   BUFFER(L2:L6)=NAME;             /* INSERT NAME                   */ 01617000
         MVC   BUFFER+1(5,@07),NAME                                0530 01618000
*   LX=L8;                          /* SET LGTH FIELD                */ 01619000
         LA    LX,8                                                0531 01620000
*CK3:                                                              0532 01621000
*   IF ICTLMNAM(I,LX)=BLANK         /* LAST POSITION BLANK           */ 01622000
*     THEN                                                         0532 01623000
CK3      LR    @07,I                                               0532 01624000
         MH    @07,@CH01006                                        0532 01625000
         ALR   @07,LX                                              0532 01626000
         L     @01,CCAICLMD(,CCAPTR)                               0532 01627000
         ALR   @01,@07                                             0532 01628000
         AL    @01,@CF01951                                        0532 01629000
         CLI   ICTLMNAM(@01),C' '                                  0532 01630000
         BNE   @RF00532                                            0532 01631000
*     DO;                                                          0533 01632000
*       LX=LX-L1;                   /* CK NEXT POSITION              */ 01633000
         BCTR  LX,0                                                0534 01634000
*       GOTO CK3;                   /* BRANCH BACK TO TEST           */ 01635000
         B     CK3                                                 0535 01636000
*     END;                                                         0536 01637000
*   LY=L6+LX;                       /* CALC DISP                     */ 01638000
@RF00532 LA    LY,6                                                0537 01639000
         ALR   LY,LX                                               0537 01640000
*   BUFFER(L7:LY)=ICTLMNAM(I);      /* MOVE IN MEMBER NAME           */ 01641000
         L     @05,IOPPTR                                          0538 01642000
         L     @05,IOPBUFAD(,@05)                                  0538 01643000
         LR    @02,LY                                              0538 01644000
         SH    @02,@CH00238                                        0538 01645000
         LR    @15,I                                               0538 01646000
         MH    @15,@CH01006                                        0538 01647000
         L     @01,CCAICLMD(,CCAPTR)                               0538 01648000
         ALR   @01,@15                                             0538 01649000
         AL    @01,@CF01916                                        0538 01650000
         EX    @02,@SM01952                                        0538 01651000
*   LZ=LY+L3;                       /* CALC DISP                     */ 01652000
         LA    LZ,3                                                0539 01653000
         ALR   LZ,LY                                               0539 01654000
*   LY=LY+L1;                       /* CALC DISP                     */ 01655000
         AH    LY,@CH01668                                         0540 01656000
*   BUFFER(LY:LZ)=REPL;             /* MOVE IN REPLACE               */ 01657000
         ALR   @05,LY                                              0541 01658000
         BCTR  @05,0                                               0541 01659000
         LR    @02,LZ                                              0541 01660000
         SLR   @02,LY                                              0541 01661000
         EX    @02,@SM01954                                        0541 01662000
*   CALL WRITE;                     /* CALL WRITE RTN                */ 01663000
*                                                                  0542 01664000
         BAL   @14,WRITE                                           0542 01665000
*   /*****************************************************************/ 01666000
*   /*                                                               */ 01667000
*   /* RESET INPROCESS INDICATOR                             @Z67SP00*/ 01668000
*   /*                                                               */ 01669000
*   /*****************************************************************/ 01670000
*                                                                  0543 01671000
*   DO J=1 BY 1                     /* SEARCH THRU MODSIN THIS LMOD     01672000
*                                                            @Z67SP00*/ 01673000
*         WHILE ICTIXL(J)^=ICTENDIX;/*                       @Z67SP00*/ 01674000
         LA    J,1                                                 0543 01675000
         B     @DE00543                                            0543 01676000
@DL00543 DS    0H                                                  0544 01677000
*     IF ICTMPROC(1)=ON             /* IS MOD INPROCESS      @Z67SP00*/ 01678000
*       THEN                                                       0544 01679000
         LR    @07,J                                               0544 01680000
         SLA   @07,2                                               0544 01681000
         LR    @05,I                                               0544 01682000
         MH    @05,@CH01006                                        0544 01683000
         L     @02,CCAICLMD(,CCAPTR)                               0544 01684000
         AL    @02,@CF01912                                        0544 01685000
         L     @05,ICTLCHN-34(@05,@02)                             0544 01686000
         AL    @05,@CF01913                                        0544 01687000
         L     @07,ICTIXL(@07,@05)                                 0544 01688000
         TM    ICTMPROC(@07),B'10000000'                           0544 01689000
         BNO   @RF00544                                            0544 01690000
*       ICTMPROC(1)=OFF;            /*                       @Z67SP00*/ 01691000
         NI    ICTMPROC(@07),B'01111111'                           0545 01692000
*   END;                            /*                       @Z67SP00*/ 01693000
@RF00544 AH    J,@CH00085                                          0546 01694000
@DE00543 LR    @07,J                                               0546 01695000
         SLA   @07,2                                               0546 01696000
         LR    @05,I                                               0546 01697000
         MH    @05,@CH01006                                        0546 01698000
         L     @02,CCAICLMD(,CCAPTR)                               0546 01699000
         AL    @02,@CF01912                                        0546 01700000
         L     @05,ICTLCHN-34(@05,@02)                             0546 01701000
         AL    @05,@CF01913                                        0546 01702000
         L     @07,ICTIXL(@07,@05)                                 0546 01703000
         CL    @07,ICTENDIX                                        0546 01704000
         BNE   @DL00543                                            0546 01705000
*   END MODCHK;                                                    0547 01706000
@EL00005 DS    0H                                                  0547 01707000
@EF00005 DS    0H                                                  0547 01708000
@ER00005 LM    @14,@05,@SA00005                                    0547 01709000
         LM    @07,@12,@SA00005+32                                 0547 01710000
         BR    @14                                                 0547 01711000
         EJECT                                                          01712000
*                                                                  0548 01713000
*   /*****************************************************************/ 01714000
*   /*                                                               */ 01715000
*   /* THIS PROCEDURE CREATES THE ACTUAL INCLUDE CARD FOR THE LINKAGE*/ 01716000
*   /* EDITOR.                                                       */ 01717000
*   /*                                                               */ 01718000
*   /*****************************************************************/ 01719000
*                                                                  0548 01720000
*CTLSTMT:                                                          0548 01721000
*   PROCEDURE;                                                     0548 01722000
CTLSTMT  STM   @14,@05,@SA00006                                    0548 01723000
         STM   @07,@12,@SA00006+32                                 0548 01724000
*   RFY                                                            0549 01725000
*    (ICTLMOD) BASED(CCAICLMD);                                    0549 01726000
*   RFY                                                            0550 01727000
*    (ICTIXLF) BASED(ICTLCHN(I));                                  0550 01728000
*   RFY                                                            0551 01729000
*    (ICTMOD) BASED(ICTIXL(J));                                    0551 01730000
*   RFY                                                            0552 01731000
*    (ICTPTF) BASED(ICTPPTR(1));                                   0552 01732000
*   CTLBUFF=BLANK;                  /* CLEAR BUFFER                  */ 01733000
         MVI   CTLBUFF+1,C' '                                      0553 01734000
         MVC   CTLBUFF+2(78),CTLBUFF+1                             0553 01735000
         MVI   CTLBUFF,C' '                                        0553 01736000
*   CTLBUFF(L2:L8)=INCLUDE;         /* MOVE INCLUDE STMT             */ 01737000
         MVC   CTLBUFF+1(7),INCLUDE                                0554 01738000
*   LX=L8;                          /* SET LENGTH FIELD              */ 01739000
         LA    LX,8                                                0555 01740000
*CK1:                                                              0556 01741000
*   IF LIBNAME(LX)=BLANK            /* LAST CHAR BLANK               */ 01742000
*     THEN                                                         0556 01743000
CK1      LA    @07,LIBNAME-1(LX)                                   0556 01744000
         CLI   0(@07),C' '                                         0556 01745000
         BNE   @RF00556                                            0556 01746000
*     DO;                                                          0557 01747000
*       LX=LX-L1;                   /* CK NEXT POSITION              */ 01748000
         BCTR  LX,0                                                0558 01749000
*       GOTO CK1;                   /* BRANCH BACK TO TEST           */ 01750000
         B     CK1                                                 0559 01751000
*     END;                                                         0560 01752000
*   LY=L9+LX;                       /* CALC DISP IN BUFFER           */ 01753000
@RF00556 LA    LY,9                                                0561 01754000
         ALR   LY,LX                                               0561 01755000
*   CTLBUFF(L10:LY)=LIBNAME;        /* MOVE IN LIB NAME              */ 01756000
         LR    @07,LY                                              0562 01757000
         SH    @07,@CH00033                                        0562 01758000
         EX    @07,@SM01956                                        0562 01759000
*   LY=LY+L1;                       /* CALC DISP                     */ 01760000
         AH    LY,@CH01668                                         0563 01761000
*   CTLBUFF(LY)=LPAREN;             /* MOVE IN LEFT PAREN            */ 01762000
         LA    @07,CTLBUFF-1(LY)                                   0564 01763000
         MVC   0(1,@07),LPAREN                                     0564 01764000
*   LX=L8;                          /* SET LGTH FIELD                */ 01765000
         LA    LX,8                                                0565 01766000
*CK2:                                                              0566 01767000
*   IF MEMNAME(LX)=BLANK            /* LAST CHAR BLANK               */ 01768000
*     THEN                                                         0566 01769000
CK2      LA    @07,MEMNAME-1(LX)                                   0566 01770000
         CLI   0(@07),C' '                                         0566 01771000
         BNE   @RF00566                                            0566 01772000
*     DO;                                                          0567 01773000
*       LX=LX-L1;                   /* CK NEXT POSITION              */ 01774000
         BCTR  LX,0                                                0568 01775000
*       GOTO CK2;                   /* BRANCH BACK TO TEST           */ 01776000
         B     CK2                                                 0569 01777000
*     END;                                                         0570 01778000
*   LZ=LY+LX;                       /* CALC DISP                     */ 01779000
@RF00566 LR    LZ,LY                                               0571 01780000
         ALR   LZ,LX                                               0571 01781000
*   LY=LY+L1;                       /* CALC DISP                     */ 01782000
         LA    @02,1                                               0572 01783000
         ALR   LY,@02                                              0572 01784000
*   CTLBUFF(LY:LZ)=MEMNAME;         /* MOVE IN MOD NAME      @Z67SP00*/ 01785000
         LA    @01,CTLBUFF-1(LY)                                   0573 01786000
         LR    @15,LZ                                              0573 01787000
         SLR   @15,LY                                              0573 01788000
         EX    @15,@SM01958                                        0573 01789000
*   LZ=LZ+L1;                       /* CALC DISP                     */ 01790000
         ALR   LZ,@02                                              0574 01791000
*   CTLBUFF(LZ)=RPAREN;             /* MOVE IN RIGHT PAREN   @Z67SP00*/ 01792000
         LA    @01,CTLBUFF-1(LZ)                                   0575 01793000
         MVC   0(1,@01),RPAREN                                     0575 01794000
*   CTLBUFF(41:47)=PTFNO;           /* PTF NO. INTO STMT     @ZD00001*/ 01795000
         MVC   CTLBUFF+40(7),PTFNO                                 0576 01796000
*   IOPBUFAD=ADDR(CTLBUFF);         /* ALTERNATE BUFFER      @Z67SP00*/ 01797000
         LA    @07,CTLBUFF                                         0577 01798000
         L     @01,IOPPTR                                          0577 01799000
         ST    @07,IOPBUFAD(,@01)                                  0577 01800000
*   CALL WRITE;                     /* CALL WRITE RTN                */ 01801000
         BAL   @14,WRITE                                           0578 01802000
*   IOPBUFAD=ADDR(BUFFER);          /* ORIGINAL BUFFER       @Z67SP00*/ 01803000
         L     @07,IOPPTR                                          0579 01804000
         L     @15,IOPBUFAD(,@07)                                  0579 01805000
         ST    @15,IOPBUFAD(,@07)                                  0579 01806000
*   END CTLSTMT;                                                   0580 01807000
@EL00006 DS    0H                                                  0580 01808000
@EF00006 DS    0H                                                  0580 01809000
@ER00006 LM    @14,@05,@SA00006                                    0580 01810000
         LM    @07,@12,@SA00006+32                                 0580 01811000
         BR    @14                                                 0580 01812000
         EJECT                                                          01813000
*                                                                  0581 01814000
*   /*****************************************************************/ 01815000
*   /*                                                               */ 01816000
*   /* THIS PROCEDURE ISSUES A POINT REQUEST TO THE I/O ROUTINE WHEN */ 01817000
*   /* CALLED.                                                       */ 01818000
*   /*                                                               */ 01819000
*   /*****************************************************************/ 01820000
*                                                                  0581 01821000
*POINT:                                                            0581 01822000
*   PROCEDURE;                                                     0581 01823000
POINT    STM   @14,@05,@SA00007                                    0581 01824000
         STM   @07,@12,@SA00007+32                                 0581 01825000
*   RFY                                                            0582 01826000
*    (ICTLMOD) BASED(CCAICLMD);                                    0582 01827000
*   RFY                                                            0583 01828000
*    (ICTIXLF) BASED(ICTLCHN(I));                                  0583 01829000
*   RFY                                                            0584 01830000
*    (ICTMOD) BASED(ICTIXL(J));                                    0584 01831000
*   RFY                                                            0585 01832000
*    (ICTPTF) BASED(ICTPPTR(1));                                   0585 01833000
*                                                                  0585 01834000
*   /*****************************************************************/ 01835000
*   /*                                                               */ 01836000
*   /* NO CONTROL CARDS FOR ACCEPT LINKS                     @Z67SP00*/ 01837000
*   /*                                                               */ 01838000
*   /*****************************************************************/ 01839000
*                                                                  0586 01840000
*   IF CCAACCPT=ON THEN             /*                       @Z67SP00*/ 01841000
         TM    CCAACCPT(CCAPTR),B'00100000'                        0586 01842000
         BNO   @RF00586                                            0586 01843000
*     LINKEOF=ON;                   /*                       @Z67SP00*/ 01844000
         OI    LINKEOF,B'00010000'                                 0587 01845000
*   ELSE                            /*                       @Z67SP00*/ 01846000
*                                                                  0588 01847000
*     /***************************************************************/ 01848000
*     /*                                                             */ 01849000
*     /* APPLY AND RESTORE GER THE LINK CONTRO CARDS         @Z67SP00*/ 01850000
*     /*                                                             */ 01851000
*     /***************************************************************/ 01852000
*                                                                  0588 01853000
*     DO;                           /*                       @Z67SP00*/ 01854000
         B     @RC00586                                            0588 01855000
@RF00586 DS    0H                                                  0589 01856000
*       IOPDSID=IOPCDSM;            /* INDICATE CDS                  */ 01857000
         L     @07,IOPPTR                                          0589 01858000
         MVI   IOPDSID(@07),X'02'                                  0589 01859000
*       IOPFUNCT=IOPPOSI;           /* INDICATE POINT REQUEST        */ 01860000
         MVI   IOPFUNCT(@07),X'02'                                 0590 01861000
*       IOPNAME=ICTLMNAM(I);        /* NAME OF LM                    */ 01862000
         LR    @05,I                                               0591 01863000
         MH    @05,@CH01006                                        0591 01864000
         L     @15,CCAICLMD(,CCAPTR)                               0591 01865000
         ST    @05,@TF00001                                        0591 01866000
         ALR   @05,@15                                             0591 01867000
         AL    @05,@CF01916                                        0591 01868000
         MVC   IOPNAME(8,@07),ICTLMNAM(@05)                        0591 01869000
*       IOPTYPE=IOPLMD;             /* INDICATE LM TYPE      @ZD00008*/ 01870000
         MVI   IOPTYPE(@07),X'02'                                  0592 01871000
*       IOPTTR=ICTLTTR(I);          /* TTR FOR LM                    */ 01872000
         AL    @15,@TF00001                                        0593 01873000
         AL    @15,@CF01961                                        0593 01874000
         MVC   IOPTTR(3,@07),ICTLTTR-31(@15)                       0593 01875000
*       CALL HMASMIO(HMASMIOP);     /* CALL I/O ROUTINE              */ 01876000
         ST    @07,@AL00001                                        0594 01877000
         L     @15,@CV01634                                        0594 01878000
         LA    @01,@AL00001                                        0594 01879000
         BALR  @14,@15                                             0594 01880000
*       LKIRTNCD=MAX(LKIRTNCD,IOPRETRN);/* ERROR CODE        @Z67SP00*/ 01881000
         L     @07,IOPPTR                                          0595 01882000
         SLR   @05,@05                                             0595 01883000
         IC    @05,IOPRETRN(,@07)                                  0595 01884000
         CR    LKIRTNCD,@05                                        0595 01885000
         BNL   *+6                                                      01886000
         LR    LKIRTNCD,@05                                        0595 01887000
*       IF IOPRETRN^=IOPGOOD        /* SUCCESSFUL POINT?     @YA07506*/ 01888000
*         THEN                                                     0596 01889000
         CLI   IOPRETRN(@07),0                                     0596 01890000
         BE    @RF00596                                            0596 01891000
*         DO;                                                      0597 01892000
*           LINKERR=ON;             /* INDICATE ERROR                */ 01893000
         OI    LINKERR,B'00100000'                                 0598 01894000
*           MGPMGNO3=ZERO;          /* NO THIRD PART         @Z40SP00*/ 01895000
         SLR   @07,@07                                             0599 01896000
         STH   @07,MGPMGNO3                                        0599 01897000
*         END;                                                     0600 01898000
*       ELSE                        /* GOOD IO               @Z67SP00*/ 01899000
*         DO;                       /*                       @Z67SP00*/ 01900000
         B     @RC00596                                            0601 01901000
@RF00596 DS    0H                                                  0602 01902000
*           CALL READ;              /* READ TO CONTROL RCD   @Z67SP00*/ 01903000
         BAL   @14,READ                                            0602 01904000
*           BUFFER(1)=BLANK;        /* TO SKIP THIS RCD      @Z67SP00*/ 01905000
         L     @07,IOPPTR                                          0603 01906000
         L     @07,IOPBUFAD(,@07)                                  0603 01907000
         MVI   BUFFER(@07),C' '                                    0603 01908000
*         END;                      /*                       @Z67SP00*/ 01909000
*     END;                          /*                       @Z67SP00*/ 01910000
*   END POINT;                                                     0606 01911000
@EL00007 DS    0H                                                  0606 01912000
@EF00007 DS    0H                                                  0606 01913000
@ER00007 LM    @14,@05,@SA00007                                    0606 01914000
         LM    @07,@12,@SA00007+32                                 0606 01915000
         BR    @14                                                 0606 01916000
         EJECT                                                          01917000
*                                                                  0607 01918000
*   /*****************************************************************/ 01919000
*   /*                                                               */ 01920000
*   /* THIS PROCEDURE ISSUES A READ REQUEST TO THE I/O ROUTINE WHEN  */ 01921000
*   /* CALLED.                                                       */ 01922000
*   /*                                                               */ 01923000
*   /*****************************************************************/ 01924000
*                                                                  0607 01925000
*READ:                                                             0607 01926000
*   PROCEDURE OPTIONS(SAVEAREA);                                   0607 01927000
READ     STM   @14,@05,12(@13)                                     0607 01928000
         STM   @07,@12,48(@13)                                     0607 01929000
         ST    @13,@SA00008+4                                      0607 01930000
         LA    @14,@SA00008                                        0607 01931000
         ST    @14,8(,@13)                                         0607 01932000
         LR    @13,@14                                             0607 01933000
*   IOPDSID=IOPCDSM;                /* INDICATE CDS                  */ 01934000
         L     @07,IOPPTR                                          0608 01935000
         MVI   IOPDSID(@07),X'02'                                  0608 01936000
*   IOPFUNCT=IOPREAD;               /* INDICATE READ REQUEST         */ 01937000
         MVI   IOPFUNCT(@07),X'01'                                 0609 01938000
*   CALL HMASMIO(HMASMIOP);         /* CALL I/O ROUTINE TO READ A  0610 01939000
*                                      MEMBER                        */ 01940000
         ST    @07,@AL00001                                        0610 01941000
         L     @15,@CV01634                                        0610 01942000
         LA    @01,@AL00001                                        0610 01943000
         BALR  @14,@15                                             0610 01944000
*   IF IOPRETRN=IOPEOF              /* END OF FILE?          @YA07506*/ 01945000
*     THEN                                                         0611 01946000
         L     @07,IOPPTR                                          0611 01947000
         CLI   IOPRETRN(@07),4                                     0611 01948000
         BNE   @RF00611                                            0611 01949000
*     LINKEOF=ON;                   /* SET EOF INDICATOR             */ 01950000
         OI    LINKEOF,B'00010000'                                 0612 01951000
*   IF IOPRETRN>IOPEOF THEN                                        0613 01952000
@RF00611 L     @07,IOPPTR                                          0613 01953000
         CLI   IOPRETRN(@07),4                                     0613 01954000
         BNH   @RF00613                                            0613 01955000
*     DO;                                                          0614 01956000
*       LINKERR=ON;                 /* INDICATE ERROR                */ 01957000
         OI    LINKERR,B'00100000'                                 0615 01958000
*       LKIRTNCD=MAX(LKIRTNCD,IOPRETRN);/* EROR CODE         @Z67SP00*/ 01959000
         SLR   @15,@15                                             0616 01960000
         IC    @15,IOPRETRN(,@07)                                  0616 01961000
         CR    LKIRTNCD,@15                                        0616 01962000
         BNL   *+6                                                      01963000
         LR    LKIRTNCD,@15                                        0616 01964000
*       MGPMGNO3=ZERO;              /* NO THIRD PART         @Z40SP00*/ 01965000
         SLR   @07,@07                                             0617 01966000
         STH   @07,MGPMGNO3                                        0617 01967000
*     END;                                                         0618 01968000
*   END READ;                                                      0619 01969000
@EL00008 L     @13,4(,@13)                                         0619 01970000
@EF00008 DS    0H                                                  0619 01971000
@ER00008 LM    @14,@05,12(@13)                                     0619 01972000
         LM    @07,@12,48(@13)                                     0619 01973000
         BR    @14                                                 0619 01974000
         EJECT                                                          01975000
*                                                                  0620 01976000
*   /*****************************************************************/ 01977000
*   /*                                                               */ 01978000
*   /* THIS PROCEDURE ISSUES A WRITE REQUEST TO THE I/O ROUTINE WHEN */ 01979000
*   /* CALLED.                                                       */ 01980000
*   /*                                                               */ 01981000
*   /*****************************************************************/ 01982000
*                                                                  0620 01983000
*WRITE:                                                            0620 01984000
*   PROCEDURE OPTIONS(SAVEAREA);                                   0620 01985000
WRITE    STM   @14,@05,12(@13)                                     0620 01986000
         STM   @07,@12,48(@13)                                     0620 01987000
         ST    @13,@SA00009+4                                      0620 01988000
         LA    @14,@SA00009                                        0620 01989000
         ST    @14,8(,@13)                                         0620 01990000
         LR    @13,@14                                             0620 01991000
*   IOPDSID=IOPSCR1;                /* INDICATE SCRATCH DS           */ 01992000
         L     @07,IOPPTR                                          0621 01993000
         MVI   IOPDSID(@07),X'03'                                  0621 01994000
*   IOPFUNCT=IOPWRITE;              /* WRITE OPERATION               */ 01995000
         MVI   IOPFUNCT(@07),X'51'                                 0622 01996000
*   CALL HMASMIO(HMASMIOP);         /* CALL I/O ROUTINE              */ 01997000
         ST    @07,@AL00001                                        0623 01998000
         L     @15,@CV01634                                        0623 01999000
         LA    @01,@AL00001                                        0623 02000000
         BALR  @14,@15                                             0623 02001000
*   IF IOPRETRN^=IOPGOOD            /* I/O BAD.              @Z67SP00*/ 02002000
*     THEN                                                         0624 02003000
         L     @07,IOPPTR                                          0624 02004000
         CLI   IOPRETRN(@07),0                                     0624 02005000
         BE    @RF00624                                            0624 02006000
*     DO;                                                          0625 02007000
*       LINKERR=ON;                 /* INDICATE ERROR                */ 02008000
         OI    LINKERR,B'00100000'                                 0626 02009000
*       LKIRTNCD=MAX(LKIRTNCD,IOPRETRN);/* ERROR CODE        @Z67SP00*/ 02010000
         SLR   @15,@15                                             0627 02011000
         IC    @15,IOPRETRN(,@07)                                  0627 02012000
         CR    LKIRTNCD,@15                                        0627 02013000
         BNL   *+6                                                      02014000
         LR    LKIRTNCD,@15                                        0627 02015000
*       MGPMGNO3=ZERO;              /* NO THIRD PART         @Z40SP00*/ 02016000
         SLR   @07,@07                                             0628 02017000
         STH   @07,MGPMGNO3                                        0628 02018000
*     END;                                                         0629 02019000
*   END WRITE;                                                     0630 02020000
@EL00009 L     @13,4(,@13)                                         0630 02021000
@EF00009 DS    0H                                                  0630 02022000
@ER00009 LM    @14,@05,12(@13)                                     0630 02023000
         LM    @07,@12,48(@13)                                     0630 02024000
         BR    @14                                                 0630 02025000
         EJECT                                                          02026000
*                                                                  0631 02027000
*   /*****************************************************************/ 02028000
*   /*                                                               */ 02029000
*   /* THIS PROCEDURE ISSUES A CLOSE REQUEST TO THE I/O ROUTINE WHEN */ 02030000
*   /* CALLED.                                                       */ 02031000
*   /*                                                               */ 02032000
*   /*****************************************************************/ 02033000
*                                                                  0631 02034000
*CLOSE:                                                            0631 02035000
*   PROCEDURE OPTIONS(SAVEAREA);                                   0631 02036000
CLOSE    STM   @14,@05,12(@13)                                     0631 02037000
         STM   @07,@12,48(@13)                                     0631 02038000
         ST    @13,@SA00010+4                                      0631 02039000
         LA    @14,@SA00010                                        0631 02040000
         ST    @14,8(,@13)                                         0631 02041000
         LR    @13,@14                                             0631 02042000
*   IOPDSID=IOPSCR1;                /* INDICATE SCRATCH DS           */ 02043000
         L     @07,IOPPTR                                          0632 02044000
         MVI   IOPDSID(@07),X'03'                                  0632 02045000
*   IOPFUNCT=IOPCLOSE;              /* CLOSE OPERATION               */ 02046000
         MVI   IOPFUNCT(@07),X'50'                                 0633 02047000
*   CALL HMASMIO(HMASMIOP);         /* CALL I/O ROUTINE              */ 02048000
         ST    @07,@AL00001                                        0634 02049000
         L     @15,@CV01634                                        0634 02050000
         LA    @01,@AL00001                                        0634 02051000
         BALR  @14,@15                                             0634 02052000
*   IF IOPRETRN=IOPGOOD             /* I/O SUCCESSFUL?       @YA07506*/ 02053000
*     THEN                                                         0635 02054000
         L     @07,IOPPTR                                          0635 02055000
         CLI   IOPRETRN(@07),0                                     0635 02056000
         BE    @RT00635                                            0635 02057000
*     RETURN;                       /* YES, CONTINUE                 */ 02058000
*   ELSE                                                           0637 02059000
*     DO;                                                          0637 02060000
*       IF LKIRTNCD<IOPRETRN        /* CHANGE RC?            @YA07506*/ 02061000
*         THEN                                                     0638 02062000
         SLR   @15,@15                                             0638 02063000
         IC    @15,IOPRETRN(,@07)                                  0638 02064000
         CR    LKIRTNCD,@15                                        0638 02065000
         BNL   @RF00638                                            0638 02066000
*         LKIRTNCD=IOPRETRN;        /* YES                   @YA07506*/ 02067000
         LR    LKIRTNCD,@15                                        0639 02068000
*       LINKERR=ON;                 /* INDICATE ERROR                */ 02069000
@RF00638 OI    LINKERR,B'00100000'                                 0640 02070000
*       MGPMGNO3=ZERO;              /* NO THIRD PART         @Z40SP00*/ 02071000
         SLR   @07,@07                                             0641 02072000
         STH   @07,MGPMGNO3                                        0641 02073000
*     END;                                                         0642 02074000
*   END CLOSE;                                                     0643 02075000
@EL00010 L     @13,4(,@13)                                         0643 02076000
@EF00010 DS    0H                                                  0643 02077000
@ER00010 LM    @14,@05,12(@13)                                     0643 02078000
         LM    @07,@12,48(@13)                                     0643 02079000
         BR    @14                                                 0643 02080000
         EJECT                                                          02081000
*                                                                  0644 02082000
*   /*****************************************************************/ 02083000
*   /*                                                               */ 02084000
*   /* THIS PROCEDURE SCANS THE ICT FOR LOAD MODULES WITH IDENTICAL  */ 02085000
*   /* CHARACTERISTICS TO INCLUDE IN THE LINK REQUEST. WHEN A LOAD   */ 02086000
*   /* MOD IS FOUND THAT MATCHES THE CURRENT LOAD MOD CHARACTERISTICS*/ 02087000
*   /* THE LOOP COUNTER IS RESET TO THIS LOAD MOD AND PROCESSING     */ 02088000
*   /* BEGINS WITH THE NEW LOAD MODULE.                              */ 02089000
*   /*                                                               */ 02090000
*   /*****************************************************************/ 02091000
*                                                                  0644 02092000
*LMCHECK:                                                          0644 02093000
*   PROCEDURE OPTIONS(SAVEAREA);                                   0644 02094000
LMCHECK  STM   @14,@02,12(@13)                                     0644 02095000
         STM   @04,@12,36(@13)                                     0644 02096000
         ST    @13,@SA00011+4                                      0644 02097000
         LA    @14,@SA00011                                        0644 02098000
         ST    @14,8(,@13)                                         0644 02099000
         LR    @13,@14                                             0644 02100000
*   RFY                                                            0645 02101000
*    (ICTLMOD) BASED(CCAICLMD);                                    0645 02102000
*   RFY                                                            0646 02103000
*    (ICTIXLF) BASED(ICTLCHN(I));                                  0646 02104000
*   RFY                                                            0647 02105000
*    (ICTMOD) BASED(ICTIXL(J));                                    0647 02106000
*   RFY                                                            0648 02107000
*    (ICTPTF) BASED(ICTPPTR(1));                                   0648 02108000
*                                                                  0648 02109000
*   /*****************************************************************/ 02110000
*   /*                                                               */ 02111000
*   /* ASSUME NO OTHER LMODS WILL BE LINKED. DOLINK ON MEANS NO LMODS*/ 02112000
*   /* CAN BE CONCURRENTLY LINKED IN THIS PASS TO THE LINKAGE EDITOR.*/ 02113000
*   /* DOLINK OFF WILL CAUSE THE MAIN LINK PROCESSING TO CONTIUE     */ 02114000
*   /* SETTLING UP CONTROL CARDS FOR THE LMODS FOUND TO BE ELIGIBLE  */ 02115000
*   /* FOR CONCURRENT PROCESSING.                            @Z67SP00*/ 02116000
*   /*                                                               */ 02117000
*   /*****************************************************************/ 02118000
*                                                                  0649 02119000
*   DOLINK=ON;                      /*                       @Z67SP00*/ 02120000
*                                                                  0649 02121000
         OI    DOLINK,B'01000000'                                  0649 02122000
*   /*****************************************************************/ 02123000
*   /*                                                               */ 02124000
*   /* SEARCH ICT LMODS FROM NEXT AFTER CURRENT              @Z67SP00*/ 02125000
*   /*                                                               */ 02126000
*   /*****************************************************************/ 02127000
*                                                                  0650 02128000
*   DO M=(I+1) BY 1                 /*                       @Z67SP00*/ 02129000
*         WHILE ICTLEND(M)^=ICTENDNT/* FOR CALL TO LINK      @OY04018*/ 02130000
*         &DOLINK=ON;               /* UNTIL NO OTHERS       @Z67SP00*/ 02131000
*                                                                  0650 02132000
         LA    M,1                                                 0650 02133000
         ALR   M,I                                                 0650 02134000
         B     @DE00650                                            0650 02135000
@DL00650 DS    0H                                                  0651 02136000
*     /***************************************************************/ 02137000
*     /*                                                             */ 02138000
*     /* LOOK FOR ELEGIBLE LMOD TO LINK IN SAME CALL TO EDITOR       */ 02139000
*     /*                                                             */ 02140000
*     /***************************************************************/ 02141000
*                                                                  0651 02142000
*     IF ICTTG1(M)=ICTTG1(I)&       /* SAME LIBS                     */ 02143000
*         ICTLCPL(M)=OFF&           /* NOT COMPLETED         @Z40SP00*/ 02144000
*         ICTLPROC(M)=OFF&          /* NOT ITSELF            @Z40SP00*/ 02145000
*         ICTLLKD(M)=ON THEN        /* LINKABLE              @Z40SP00*/ 02146000
         LA    @05,54                                              0651 02147000
         LR    @01,M                                               0651 02148000
         MR    @00,@05                                             0651 02149000
         L     @02,CCAICLMD(,CCAPTR)                               0651 02150000
         LR    @07,@05                                             0651 02151000
         MR    @06,I                                               0651 02152000
         ST    @01,@TF00001                                        0651 02153000
         ALR   @01,@02                                             0651 02154000
         AL    @01,@CF01943                                        0651 02155000
         ST    @07,@TF00002                                        0651 02156000
         ALR   @07,@02                                             0651 02157000
         AL    @07,@CF01943                                        0651 02158000
         CLC   ICTTG1-15(8,@01),ICTTG1-15(@07)                     0651 02159000
         BNE   @RF00651                                            0651 02160000
         LR    @05,@02                                             0651 02161000
         AL    @05,@TF00001                                        0651 02162000
         AL    @05,@CF01911                                        0651 02163000
         TM    ICTLCPL-8(@05),B'10100000'                          0651 02164000
         BNZ   @RF00651                                            0651 02165000
         LR    @05,@02                                             0651 02166000
         AL    @05,@TF00001                                        0651 02167000
         AL    @05,@CF01910                                        0651 02168000
         TM    ICTLLKD-14(@05),B'00001000'                         0651 02169000
         BNO   @RF00651                                            0651 02170000
*       IF                          /*                       @ZD00005*/ 02171000
*           ICTLFLG1(M)=ICTLFLG1(I)&/* LE PARMS SAME         @ZD00004*/ 02172000
*           ICTLFLG5(M)=ICTLFLG5(I)&/*                       @ZD00004*/ 02173000
*           ICTLFLG6(M)=ICTLFLG6(I)&/*                       @ZD00004*/ 02174000
*           ICTLFLG7(M)=ICTLFLG7(I) /*                       @ZD00004*/ 02175000
*         THEN                                                     0652 02176000
*                                                                  0652 02177000
         LR    @05,@02                                             0652 02178000
         AL    @05,@TF00001                                        0652 02179000
         AL    @05,@CF01921                                        0652 02180000
         LR    @01,@02                                             0652 02181000
         AL    @01,@TF00002                                        0652 02182000
         AL    @01,@CF01921                                        0652 02183000
         CLC   ICTLFLG1-9(1,@05),ICTLFLG1-9(@01)                   0652 02184000
         BNE   @RF00652                                            0652 02185000
         LR    @05,@02                                             0652 02186000
         AL    @05,@TF00001                                        0652 02187000
         AL    @05,@CF01936                                        0652 02188000
         LR    @01,@02                                             0652 02189000
         AL    @01,@TF00002                                        0652 02190000
         AL    @01,@CF01936                                        0652 02191000
         CLC   ICTLFLG5-10(1,@05),ICTLFLG5-10(@01)                 0652 02192000
         BNE   @RF00652                                            0652 02193000
         LR    @05,@02                                             0652 02194000
         AL    @05,@TF00001                                        0652 02195000
         AL    @05,@CF01962                                        0652 02196000
         LR    @01,@02                                             0652 02197000
         AL    @01,@TF00002                                        0652 02198000
         AL    @01,@CF01962                                        0652 02199000
         CLC   ICTLFLG6-11(1,@05),ICTLFLG6-11(@01)                 0652 02200000
         BNE   @RF00652                                            0652 02201000
         LR    @05,@02                                             0652 02202000
         AL    @05,@TF00001                                        0652 02203000
         AL    @05,@CF01963                                        0652 02204000
         AL    @02,@TF00002                                        0652 02205000
         AL    @02,@CF01963                                        0652 02206000
         CLC   ICTLFLG7-12(1,@05),ICTLFLG7-12(@02)                 0652 02207000
         BNE   @RF00652                                            0652 02208000
*         /***********************************************************/ 02209000
*         /*                                                         */ 02210000
*         /* THIS ONE CAN BE LINKED ALONG WITH CURRENT LMOD GO BACK  */ 02211000
*         /* TO MAIN LOOP TO PROCESS THIS LMOD FOR LINKING           */ 02212000
*         /*                                                         */ 02213000
*         /***********************************************************/ 02214000
*                                                                  0653 02215000
*         DO;                       /*                       @Z67SP00*/ 02216000
*           DOLINK=OFF;             /* DONT LINK YET         @Z67SP00*/ 02217000
         NI    DOLINK,B'10111111'                                  0654 02218000
*         END;                      /*                       @Z67SP00*/ 02219000
*   END;                                                           0656 02220000
*                                                                  0656 02221000
@RF00652 DS    0H                                                  0656 02222000
@RF00651 AH    M,@CH00085                                          0656 02223000
@DE00650 LR    @05,M                                               0656 02224000
         MH    @05,@CH01006                                        0656 02225000
         L     @02,CCAICLMD(,CCAPTR)                               0656 02226000
         AL    @02,@CF01916                                        0656 02227000
         L     @05,ICTLEND(@05,@02)                                0656 02228000
         CL    @05,ICTENDNT                                        0656 02229000
         BE    @DC00650                                            0656 02230000
         TM    DOLINK,B'01000000'                                  0656 02231000
         BO    @DL00650                                            0656 02232000
@DC00650 DS    0H                                                  0657 02233000
*   /*****************************************************************/ 02234000
*   /*                                                               */ 02235000
*   /* M WILL BE SET TO THE VALUE OF THE LMOD FOUND TO BE ELIGIBLE   */ 02236000
*   /* FOR CONCURRENT PROCESSING SO THAT I IN THE MAIN LOOP CAN BE   */ 02237000
*   /* SET TO POINT TO THIS LMOD ENTRY@Z67SP00                       */ 02238000
*   /*                                                               */ 02239000
*   /*****************************************************************/ 02240000
*                                                                  0657 02241000
*   IF DOLINK=OFF THEN              /* CONCURRENT LMOD       @Z67SP00*/ 02242000
         TM    DOLINK,B'01000000'                                  0657 02243000
         BNZ   @RF00657                                            0657 02244000
*     M=M-1;                        /* BUMP M DOWN           @Z67SP00*/ 02245000
         BCTR  M,0                                                 0658 02246000
*   END LMCHECK;                                                   0659 02247000
@EL00011 L     @13,4(,@13)                                         0659 02248000
@EF00011 DS    0H                                                  0659 02249000
@ER00011 LM    @14,@02,12(@13)                                     0659 02250000
         LM    @04,@12,36(@13)                                     0659 02251000
         BR    @14                                                 0659 02252000
         EJECT                                                          02253000
*                                                                  0660 02254000
*   /*****************************************************************/ 02255000
*   /*                                                               */ 02256000
*   /* THIS PROCEDURE IS INVOKED WHEN A LINK HAS BEEN COMPLETED.     */ 02257000
*   /* MESSAGES ARE ISSUED FOR ALL LOAD MODULES AND RELATED MODULES  */ 02258000
*   /* THAT WERE LINKED.                                             */ 02259000
*   /*                                                               */ 02260000
*   /*****************************************************************/ 02261000
*                                                                  0660 02262000
*COMPMSG:                                                          0660 02263000
*   PROCEDURE;                                                     0660 02264000
COMPMSG  STM   @14,@12,@SA00012                                    0660 02265000
*   RFY                                                            0661 02266000
*    (ICTLMOD) BASED(CCAICLMD);                                    0661 02267000
*   RFY                                                            0662 02268000
*    (ICTIXLF) BASED(ICTLCHN(I));                                  0662 02269000
*   RFY                                                            0663 02270000
*    (ICTMOD) BASED(ICTIXL(J));                                    0663 02271000
*   RFY                                                            0664 02272000
*    (ICTPTF) BASED(ICTPPTR(1));                                   0664 02273000
*   DCL                                                            0665 02274000
*     OUTCOME CHAR(10);             /* SUCCESS OF FAIL IN MSG@Z67SP00*/ 02275000
*   DCL                                                            0666 02276000
*     OK CHAR(2) CONSTANT('00');    /* FOR MSG SEVERITY      @Z67SP00*/ 02277000
*   DO I=1 BY 1 WHILE ICTLEND(I)^=ICTENDNT;/* LOOP THRU LM   @Z67SP00*/ 02278000
         LA    I,1                                                 0667 02279000
         B     @DE00667                                            0667 02280000
@DL00667 DS    0H                                                  0668 02281000
*     IF ICTLPROC(I)=ON&ICTLCPL(I)=OFF/* INPROCESS-NOT COMP  @Z67SP00*/ 02282000
*         &ICTLLKD(I)=ON            /* LINKED                @Z67SP00*/ 02283000
*       THEN                                                       0668 02284000
         LR    @05,I                                               0668 02285000
         MH    @05,@CH01006                                        0668 02286000
         L     @15,CCAICLMD(,CCAPTR)                               0668 02287000
         ST    @05,@TF00001                                        0668 02288000
         ALR   @05,@15                                             0668 02289000
         AL    @05,@CF01911                                        0668 02290000
         TM    ICTLPROC-8(@05),B'10000000'                         0668 02291000
         BNO   @RF00668                                            0668 02292000
         TM    ICTLCPL-8(@05),B'00100000'                          0668 02293000
         BNZ   @RF00668                                            0668 02294000
         AL    @15,@TF00001                                        0668 02295000
         AL    @15,@CF01910                                        0668 02296000
         TM    ICTLLKD-14(@15),B'00001000'                         0668 02297000
         BNO   @RF00668                                            0668 02298000
*       DO;                         /*                       @ZD00001*/ 02299000
*         DO J=1 BY 1 WHILE ICTIXL(J)^=ICTENDIX;/* SEARCH MOD      0670 02300000
*                                                            @Z67SP00*/ 02301000
         LA    J,1                                                 0670 02302000
         B     @DE00670                                            0670 02303000
@DL00670 DS    0H                                                  0671 02304000
*           IF ICTMCPL(1)=OFF       /* MOD COMPLETE                  */ 02305000
*               &ICTMISEL(1)=ON     /* SELECTED              @Z67SP00*/ 02306000
*               &(ICTMMOD(1)=ON     /* MOD REPLACEMENT       @Z67SP00*/ 02307000
*               |ICTMXPND(1)=ON)    /* OR EXPAND             @Z67SP00*/ 02308000
*             THEN                                                 0671 02309000
         LR    @05,J                                               0671 02310000
         SLA   @05,2                                               0671 02311000
         LR    @02,I                                               0671 02312000
         MH    @02,@CH01006                                        0671 02313000
         L     @01,CCAICLMD(,CCAPTR)                               0671 02314000
         AL    @01,@CF01912                                        0671 02315000
         L     @02,ICTLCHN-34(@02,@01)                             0671 02316000
         AL    @02,@CF01913                                        0671 02317000
         L     @05,ICTIXL(@05,@02)                                 0671 02318000
         TM    ICTMCPL(@05),B'00100000'                            0671 02319000
         BNZ   @RF00671                                            0671 02320000
         TM    ICTMISEL(@05),B'10000000'                           0671 02321000
         BNO   @RF00671                                            0671 02322000
         TM    ICTMMOD(@05),B'10010000'                            0671 02323000
         BZ    @RF00671                                            0671 02324000
*             DO;                   /*                       @ZD00005*/ 02325000
*                                                                  0672 02326000
*               /*****************************************************/ 02327000
*               /*                                                   */ 02328000
*               /* ISSUE MESSAGE FOR LINK OF MOD IN LMOD     @Z67SP00*/ 02329000
*               /*                                                   */ 02330000
*               /*****************************************************/ 02331000
*                                                                  0673 02332000
*               IF LINKERR=OFF THEN /*                       @Z67SP00*/ 02333000
         TM    LINKERR,B'00100000'                                 0673 02334000
         BNZ   @RF00673                                            0673 02335000
*                 OUTCOME=TXTSUCC;  /* SUCCESSFUL IN MSG     @Z67SP00*/ 02336000
         MVC   OUTCOME(10),@CC01731                                0674 02337000
*               ELSE                /*                       @Z67SP00*/ 02338000
*                 OUTCOME=TXTFAIL;  /* OR FAILURE            @Z67SP00*/ 02339000
         B     @RC00673                                            0675 02340000
@RF00673 MVC   OUTCOME(10),@CC01734                                0675 02341000
*               MGPCLEAR=''B;       /* CLEAR MESSAGES        @Z67SP00*/ 02342000
@RC00673 XC    MGPCLEAR(6),MGPCLEAR                                0676 02343000
*               MGPPRINT=ON;        /* INDICATE PRINTER              */ 02344000
*               MGPHLDS=ON;         /* AND LOG               @Z40SP00*/ 02345000
         OI    MGPPRINT,B'10010000'                                0678 02346000
*               MGPMGNO1=HMA239I;   /* LINK MESSAGE          @Z67SP00*/ 02347000
         MVC   MGPMGNO1(2),@CH00487                                0679 02348000
*               MGPVARPT(1)=ADDR(OUTCOME);/* SUCCESS OR FAIL @Z67SP00*/ 02349000
         LA    @05,OUTCOME                                         0680 02350000
         ST    @05,MGPVARPT                                        0680 02351000
*               MGPVARPT(2)=ADDR(ICTMNAME(1));/* FOR MODULE  @Z67SP00*/ 02352000
         LR    @05,J                                               0681 02353000
         SLA   @05,2                                               0681 02354000
         LR    @02,I                                               0681 02355000
         MH    @02,@CH01006                                        0681 02356000
         L     @15,CCAICLMD(,CCAPTR)                               0681 02357000
         LA    @01,0(@02,@15)                                      0681 02358000
         AL    @01,@CF01912                                        0681 02359000
         L     @01,ICTLCHN-34(,@01)                                0681 02360000
         AL    @01,@CF01913                                        0681 02361000
         L     @05,ICTIXL(@05,@01)                                 0681 02362000
         ST    @05,MGPVARPT+4                                      0681 02363000
*               MGPVARPT(3)=ADDR(ICTLMNAM(I));/* LOAD MOD =  @Z67SP00*/ 02364000
         LA    @01,0(@02,@15)                                      0682 02365000
         AL    @01,@CF01916                                        0682 02366000
         ST    @01,MGPVARPT+8                                      0682 02367000
*               MGPVARPT(4)=ADDR(ICTTG1(I));/* LIBRARY NAME  @Z67SP00*/ 02368000
         AL    @15,@CF01943                                        0683 02369000
         LA    @02,ICTTG1-15(@02,@15)                              0683 02370000
         ST    @02,MGPVARPT+12                                     0683 02371000
*               MGPVARPT(5)=ADDR(ICTPTFS(1));/* PTF NUMBER   @Z67SP00*/ 02372000
         L     @05,ICTPPTR(,@05)                                   0684 02373000
         ST    @05,MGPVARPT+16                                     0684 02374000
*               MGPVARPT(6)=ADDR(LINKRTN);/* LINK RETURN CODE      0685 02375000
*                                                            @Z67SP00*/ 02376000
         LA    @05,LINKRTN                                         0685 02377000
         ST    @05,MGPVARPT+20                                     0685 02378000
*               IF LINKRTN=OK THEN  /* ZERO LINK RTN         @Z67SP00*/ 02379000
         CLC   LINKRTN(2),@CC01900                                 0686 02380000
         BNE   @RF00686                                            0686 02381000
*                 MGPTYPE=MGPINFO;  /*                       @Z67SP00*/ 02382000
         MVI   MGPTYPE,X'01'                                       0687 02383000
*               ELSE                /* NONZERO               @Z67SP00*/ 02384000
*                 IF LINKERR=ON THEN/* BAD LINK              @Z67SP00*/ 02385000
         B     @RC00686                                            0688 02386000
@RF00686 TM    LINKERR,B'00100000'                                 0688 02387000
         BNO   @RF00688                                            0688 02388000
*                   MGPTYPE=MGPERR; /*                       @Z67SP00*/ 02389000
         MVI   MGPTYPE,X'03'                                       0689 02390000
*                 ELSE              /* NON-ZERO BUT GOOD     @Z67SP00*/ 02391000
*                   MGPTYPE=MGPWARN;/*                       @Z67SP00*/ 02392000
         B     @RC00688                                            0690 02393000
@RF00688 MVI   MGPTYPE,X'02'                                       0690 02394000
*               CALL HMASMMSG(HMASMMGP);/* CALL MSG ROUTINE          */ 02395000
@RC00688 DS    0H                                                  0691 02396000
@RC00686 L     @15,@CV01638                                        0691 02397000
         LA    @01,@AL00691                                        0691 02398000
         BALR  @14,@15                                             0691 02399000
*             END;                  /*                       @Z67SP00*/ 02400000
*         END;                                                     0693 02401000
*                                                                  0693 02402000
@RF00671 AH    J,@CH00085                                          0693 02403000
@DE00670 LR    @05,J                                               0693 02404000
         SLA   @05,2                                               0693 02405000
         LR    @02,I                                               0693 02406000
         MH    @02,@CH01006                                        0693 02407000
         L     @15,CCAICLMD(,CCAPTR)                               0693 02408000
         LA    @01,0(@02,@15)                                      0693 02409000
         AL    @01,@CF01912                                        0693 02410000
         L     @01,ICTLCHN-34(,@01)                                0693 02411000
         AL    @01,@CF01913                                        0693 02412000
         L     @05,ICTIXL(@05,@01)                                 0693 02413000
         CL    @05,ICTENDIX                                        0693 02414000
         BNE   @DL00670                                            0693 02415000
*         /***********************************************************/ 02416000
*         /*                                                         */ 02417000
*         /* SECOND TARGET LIBRARY PROCESSING                @Z67SP00*/ 02418000
*         /*                                                         */ 02419000
*         /***********************************************************/ 02420000
*                                                                  0694 02421000
*         IF LINKERR=OFF THEN       /*                       @Z67SP00*/ 02422000
         TM    LINKERR,B'00100000'                                 0694 02423000
         BNZ   @RF00694                                            0694 02424000
*           DO;                     /*                       @Z67SP00*/ 02425000
*             IF ICTTG2(I,1)=BLANK  /* NO SECOND TARGET      @Z67SP00*/ 02426000
*                 |ICTTIND1(I)=OFF  /* OR 2 EXIST AND 2ND PASS     0696 02427000
*                                                            @Z67SP00*/ 02428000
*               THEN                /* CHECK FOR COMPLETE            */ 02429000
         ST    @02,@TF00001                                        0696 02430000
         ALR   @02,@15                                             0696 02431000
         AL    @02,@CF01965                                        0696 02432000
         CLI   ICTTG2-23(@02),C' '                                 0696 02433000
         BE    @RT00696                                            0696 02434000
         AL    @15,@TF00001                                        0696 02435000
         AL    @15,@CF01910                                        0696 02436000
         TM    ICTTIND1-14(@15),B'10000000'                        0696 02437000
         BNZ   @RF00696                                            0696 02438000
@RT00696 DS    0H                                                  0697 02439000
*               DO;                                                0697 02440000
*                 ICTTIND1(I)=ON;   /* RESET INDICATOR       @Z67SP00*/ 02441000
         LR    @05,I                                               0698 02442000
         MH    @05,@CH01006                                        0698 02443000
         L     @15,CCAICLMD(,CCAPTR)                               0698 02444000
         ST    @05,@TF00001                                        0698 02445000
         ALR   @05,@15                                             0698 02446000
         AL    @05,@CF01910                                        0698 02447000
         OI    ICTTIND1-14(@05),B'10000000'                        0698 02448000
*                 ICTLCPL(I)=ON;    /* SET COMPLETE BIT      @Z67SP00*/ 02449000
         AL    @15,@TF00001                                        0699 02450000
         AL    @15,@CF01911                                        0699 02451000
         OI    ICTLCPL-8(@15),B'00100000'                          0699 02452000
*               END;                                               0700 02453000
*             ELSE                  /* 2 TGTLIBS AND 2ND PASS      0701 02454000
*                                                            @ZA01957*/ 02455000
*               DO;                 /* SET UP FOR SECOND PASS      0701 02456000
*                                                            @ZA01957*/ 02457000
         B     @RC00696                                            0701 02458000
@RF00696 DS    0H                                                  0702 02459000
*                 LIBNAME=ICTTG1(I);/* REVERSE NAMES         @Z67SP00*/ 02460000
         LR    @05,I                                               0702 02461000
         MH    @05,@CH01006                                        0702 02462000
         L     @15,CCAICLMD(,CCAPTR)                               0702 02463000
         ST    @05,@TF00001                                        0702 02464000
         ALR   @05,@15                                             0702 02465000
         AL    @05,@CF01943                                        0702 02466000
         MVC   LIBNAME(8),ICTTG1-15(@05)                           0702 02467000
*                 ICTTG1(I)=ICTTG2(I);/* SECOND NOW FIRST    @Z67SP00*/ 02468000
         LR    @05,@15                                             0703 02469000
         AL    @05,@TF00001                                        0703 02470000
         AL    @05,@CF01943                                        0703 02471000
         LR    @14,@15                                             0703 02472000
         AL    @14,@TF00001                                        0703 02473000
         AL    @14,@CF01965                                        0703 02474000
         MVC   ICTTG1-15(8,@05),ICTTG2-23(@14)                     0703 02475000
*                 ICTTG2(I)=LIBNAME;/* FIRST NOW SWCOND      @Z67SP00*/ 02476000
         LR    @05,@15                                             0704 02477000
         AL    @05,@TF00001                                        0704 02478000
         AL    @05,@CF01965                                        0704 02479000
         MVC   ICTTG2-23(8,@05),LIBNAME                            0704 02480000
*                 ICTTIND1(I)=OFF;  /* IND. 2 TGTS. 2ND PASS @Z67SP00*/ 02481000
         LR    @05,@15                                             0705 02482000
         AL    @05,@TF00001                                        0705 02483000
         AL    @05,@CF01910                                        0705 02484000
         NI    ICTTIND1-14(@05),B'01111111'                        0705 02485000
*                 ICTLPROC(I)=OFF;  /* TO GET HIT AGAIN      @Z67SP00*/ 02486000
         AL    @15,@TF00001                                        0706 02487000
         AL    @15,@CF01911                                        0706 02488000
         NI    ICTLPROC-8(@15),B'01111111'                         0706 02489000
*               END;                                               0707 02490000
*           END;                    /*                       @Z67SP00*/ 02491000
@RC00696 DS    0H                                                  0709 02492000
*       END;                        /*                       @ZD00001*/ 02493000
@RF00694 DS    0H                                                  0710 02494000
*   END;                            /* END LOOP                      */ 02495000
@RF00668 AH    I,@CH00085                                          0710 02496000
@DE00667 LR    @05,I                                               0710 02497000
         MH    @05,@CH01006                                        0710 02498000
         L     @01,CCAICLMD(,CCAPTR)                               0710 02499000
         AL    @01,@CF01916                                        0710 02500000
         L     @05,ICTLEND(@05,@01)                                0710 02501000
         CL    @05,ICTENDNT                                        0710 02502000
         BNE   @DL00667                                            0710 02503000
*   END COMPMSG;                                                   0711 02504000
@EL00012 DS    0H                                                  0711 02505000
@EF00012 DS    0H                                                  0711 02506000
@ER00012 LM    @14,@12,@SA00012                                    0711 02507000
         BR    @14                                                 0711 02508000
         EJECT                                                          02509000
*   END HMASMLKI                                                   0712 02510000
*                                                                  0712 02511000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 02512000
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */ 02513000
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */ 02514000
*/*%INCLUDE SYSLIB  (HMASMICT)                                       */ 02515000
*/*%INCLUDE SYSLIB  (HMASMMGP)                                       */ 02516000
*                                                                  0712 02517000
*       ;                                                          0712 02518000
@DATA    DS    0H                                                       02519000
@CH00085 DC    H'1'                                                     02520000
@CH00238 DC    H'7'                                                     02521000
@CH00110 DC    H'8'                                                     02522000
@CH00033 DC    H'10'                                                    02523000
@CH00032 DC    H'12'                                                    02524000
@CH00487 DC    H'40'                                                    02525000
@CH01006 DC    H'54'                                                    02526000
@CH01668 DC    XL2'01'                                                  02527000
@CH01672 DC    XL2'03'                                                  02528000
@CH01674 DC    XL2'05'                                                  02529000
@SM01922 MVC   0(0,@02),RENT                                            02530000
@SM01924 MVC   0(0,@02),REUS                                            02531000
@SM01926 MVC   0(0,@02),SCTR                                            02532000
@SM01928 MVC   0(0,@01),OVLY                                            02533000
@SM01930 MVC   0(0,@02),XCAL                                            02534000
@SM01932 MVC   0(0,@02),REFR                                            02535000
@SM01934 MVC   0(0,@02),DC                                              02536000
@SM01937 MVC   0(0,@02),NE                                              02537000
@SM01939 MVC   0(0,@02),APF                                             02538000
@SM01941 MVC   0(0,@02),ALIGN2                                          02539000
@SM01952 MVC   BUFFER+6(0,@05),ICTLMNAM(@01)                            02540000
@SM01954 MVC   BUFFER(0,@05),REPL                                       02541000
@SM01956 MVC   CTLBUFF+9(0),LIBNAME                                     02542000
@SM01958 MVC   0(0,@01),MEMNAME                                         02543000
         DS    0F                                                       02544000
@AL00235 DC    A(CILPTFNO)             LIST WITH   2 ARGUMENT(S)        02545000
         DC    A(CILPTFDS)                                              02546000
@AL00285 DC    A(STATUS)               LIST WITH   1 ARGUMENT(S)        02547000
@AL00691 DC    A(HMASMMGP)             LIST WITH   1 ARGUMENT(S)        02548000
         DS    0F                                                       02549000
@SA00001 DS    18F                                                      02550000
@SA00002 DS    14F                                                      02551000
@SA00005 DS    14F                                                      02552000
@SA00011 DS    18F                                                      02553000
@SA00004 DS    14F                                                      02554000
@SA00007 DS    14F                                                      02555000
@SA00008 DS    18F                                                      02556000
@SA00009 DS    18F                                                      02557000
@SA00006 DS    14F                                                      02558000
@SA00010 DS    18F                                                      02559000
@SA00012 DS    0F                                                       02560000
         DS    15F                                                      02561000
@AL00001 DS    2A                                                       02562000
@TF00001 DS    F                                                        02563000
@TF00002 DS    F                                                        02564000
         DS    0F                                                       02565000
@CF01951 DC    F'-55'                                                   02566000
@CF01916 DC    F'-54'                                                   02567000
@CF01911 DC    F'-46'                                                   02568000
@CF01921 DC    F'-45'                                                   02569000
@CF01936 DC    F'-44'                                                   02570000
@CF01962 DC    F'-43'                                                   02571000
@CF01963 DC    F'-42'                                                   02572000
@CF01949 DC    F'-41'                                                   02573000
@CF01910 DC    F'-40'                                                   02574000
@CF01943 DC    F'-39'                                                   02575000
@CF01965 DC    F'-31'                                                   02576000
@CF01961 DC    F'-23'                                                   02577000
@CF01912 DC    F'-20'                                                   02578000
@CF01950 DC    F'-8'                                                    02579000
@CF01913 DC    F'-4'                                                    02580000
@CV01634 DC    V(HMASMIO)                                               02581000
@CV01635 DC    V(HMASMCIL)                                              02582000
@CV01636 DC    V(HMASMCPL)                                              02583000
@CV01637 DC    V(HMASMSEC)                                              02584000
@CV01638 DC    V(HMASMMSG)                                              02585000
         DS    0D                                                       02586000
IOPPTR   DS    A                                                        02587000
@CC01731 DC    C'SUCCESSFUL'                                            02588000
@CC01734 DC    C'FAILED    '                                            02589000
@CC01900 DC    C'00'                                                    02590000
         DS    CL2                                                      02591000
ICTENDCH DC    X'FFFFFFFF'                                              02592000
HMASMMGP DS    CL40                                                     02593000
         ORG   HMASMMGP                                                 02594000
MGPFIXED DS    CL12                                                     02595000
         ORG   MGPFIXED                                                 02596000
MGPCLEAR DS    CL6                                                      02597000
         ORG   MGPCLEAR                                                 02598000
MGPMGNO1 DS    FL2                                                      02599000
MGPMGNO2 DS    FL2                                                      02600000
MGPMGNO3 DS    FL2                                                      02601000
         ORG   MGPFIXED+6                                               02602000
MGPFLAGS DS    BL2                                                      02603000
         ORG   MGPFLAGS                                                 02604000
MGPPRINT DS    BL1                                                      02605000
MGPLIST  EQU   MGPFLAGS+0                                               02606000
MGPRPT   EQU   MGPFLAGS+0                                               02607000
MGPHLDS  EQU   MGPFLAGS+0                                               02608000
MGPWTOR  EQU   MGPFLAGS+0                                               02609000
MGPWTO   EQU   MGPFLAGS+0                                               02610000
MGPWTP   EQU   MGPFLAGS+0                                               02611000
@NM00225 EQU   MGPFLAGS+0                                               02612000
         ORG   MGPFIXED+8                                               02613000
MGPTYPE  DS    FL1                                                      02614000
@NM00226 DS    CL3                                                      02615000
         ORG   HMASMMGP+12                                              02616000
MGPVAR   DS    CL28                                                     02617000
         ORG   MGPVAR                                                   02618000
MGPVARPT DS    7A                                                       02619000
         ORG   HMASMMGP+40                                              02620000
SAVRVANM DS    CL8                                                      02621000
DDNAMES  DS    CL66                                                     02622000
         ORG   DDNAMES                                                  02623000
DDCOUNT  DC    XL2'42'                                                  02624000
ASYSLIN  DC    CL8'SYSUT1  '                                            02625000
DD2      DC    8X'00'                                                   02626000
ASYSLMOD DS    CL8                                                      02627000
DD3      DC    16X'00'                                                  02628000
SYSPRINT DS    CL8                                                      02629000
DD4      DC    8X'00'                                                   02630000
ASYSUT1  DC    CL8'SYSUT2  '                                            02631000
         ORG   DDNAMES+66                                               02632000
OPTLST   DS    CL93                                                     02633000
         ORG   OPTLST                                                   02634000
OPTLGTH  DS    FL2                                                      02635000
OPTVAR   DC    CL91' '                                                  02636000
         ORG   OPTLST+93                                                02637000
         DS    CL1                                                      02638000
WORKAREA DS    CL16                                                     02639000
         ORG   WORKAREA                                                 02640000
SAVE1    DS    CL8                                                      02641000
SAVE2    DS    CL8                                                      02642000
         ORG   SAVE2                                                    02643000
@NM00230 DS    CL6                                                      02644000
LINKRTN  DS    CL2                                                      02645000
         ORG   LINKRTN                                                  02646000
@NM00231 DS    CL1                                                      02647000
@NM00232 DS    CL1                                                      02648000
         ORG   @NM00232                                                 02649000
SIGN     DS    BL1                                                      02650000
         ORG   WORKAREA+16                                              02651000
INCLUDE  DC    CL7'INCLUDE'                                             02652000
RPAREN   DC    CL1')'                                                   02653000
REPL     DC    CL3'(R)'                                                 02654000
NAME     DC    CL5'NAME '                                               02655000
LPAREN   DC    CL1'('                                                   02656000
ALIAS    DC    CL5'ALIAS'                                               02657000
XCAL     DC    CL5'XCAL,'                                               02658000
NE       DC    CL3'NE,'                                                 02659000
REFR     DC    CL5'REFR,'                                               02660000
RENT     DC    CL5'RENT,'                                               02661000
REUS     DC    CL5'REUS,'                                               02662000
DC       DC    CL3'DC,'                                                 02663000
SCTR     DC    CL5'SCTR,'                                               02664000
OVLY     DC    CL5'OVLY,'                                               02665000
APF      DC    CL5'AC=1,'                                               02666000
ALIGN2   DC    CL7'ALIGN2,'                                             02667000
COMMA    DC    CL1','                                                   02668000
STATUS   DS    CL1                                                      02669000
FLAGS    DC    X'00'                                                    02670000
         ORG   FLAGS                                                    02671000
PARMSET  DS    BL1                                                      02672000
DOLINK   EQU   FLAGS+0                                                  02673000
LINKERR  EQU   FLAGS+0                                                  02674000
LINKEOF  EQU   FLAGS+0                                                  02675000
CALLCPL  EQU   FLAGS+0                                                  02676000
RELFALC  EQU   FLAGS+0                                                  02677000
RELFALCD EQU   FLAGS+0                                                  02678000
@NM00233 EQU   FLAGS+0                                                  02679000
         ORG   FLAGS+1                                                  02680000
LIBNAME  DS    CL8                                                      02681000
MEMNAME  DS    CL8                                                      02682000
PTFNO    DS    CL7                                                      02683000
CTLBUFF  DC    CL80' '                                                  02684000
PATCHLKI DS    CL80                                                     02685000
         ORG   PATCHLKI                                                 02686000
@NM00234 DC    80X'FF'                                                  02687000
         ORG   PATCHLKI+80                                              02688000
CILPTFNO DS    CL7                                                      02689000
CILPTFDS DS    CL44                                                     02690000
OUTCOME  DS    CL10                                                     02691000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02692000
@01      EQU   01                                                       02693000
@02      EQU   02                                                       02694000
@03      EQU   03                                                       02695000
@04      EQU   04                                                       02696000
@05      EQU   05                                                       02697000
@06      EQU   06                                                       02698000
@07      EQU   07                                                       02699000
@08      EQU   08                                                       02700000
@09      EQU   09                                                       02701000
@10      EQU   10                                                       02702000
@11      EQU   11                                                       02703000
@12      EQU   12                                                       02704000
@13      EQU   13                                                       02705000
@14      EQU   14                                                       02706000
@15      EQU   15                                                       02707000
LKIRTNCD EQU   @06                                                      02708000
LZ       EQU   @07                                                      02709000
LY       EQU   @03                                                      02710000
LX       EQU   @05                                                      02711000
J        EQU   @03                                                      02712000
R        EQU   @05                                                      02713000
I        EQU   @04                                                      02714000
M        EQU   @03                                                      02715000
CCAPTR   EQU   @11                                                      02716000
LINKREG  EQU   @02                                                      02717000
RTNCODE  EQU   @15                                                      02718000
HMASMCCA EQU   0                                                        02719000
CCAFBUFR EQU   HMASMCCA+4                                               02720000
CCADSAD  EQU   CCAFBUFR+124                                             02721000
CCATPAD  EQU   CCAFBUFR+128                                             02722000
CCAFLAG7 EQU   CCAFBUFR+132                                             02723000
CCAFIOP  EQU   HMASMCCA+140                                             02724000
CCAIOPTR EQU   CCAFIOP                                                  02725000
CCAFSYS  EQU   HMASMCCA+148                                             02726000
CCASREL  EQU   CCAFSYS+12                                               02727000
CCAFLAGA EQU   CCAFSYS+21                                               02728000
CCAFSTA  EQU   HMASMCCA+188                                             02729000
CCARVAD  EQU   CCAFSTA                                                  02730000
CCAFICT  EQU   HMASMCCA+192                                             02731000
CCAICT   EQU   CCAFICT                                                  02732000
CCAICPTF EQU   CCAFICT+4                                                02733000
CCAICMOD EQU   CCAFICT+8                                                02734000
CCAICLMD EQU   CCAFICT+12                                               02735000
CCAFPGM  EQU   HMASMCCA+208                                             02736000
CCABLDLP EQU   CCAFPGM                                                  02737000
CCADBLDL EQU   CCAFPGM+4                                                02738000
CCAFGTP  EQU   HMASMCCA+224                                             02739000
CCASEGTP EQU   CCAFGTP                                                  02740000
@NM00009 EQU   HMASMCCA+244                                             02741000
CCAFFUNC EQU   HMASMCCA+264                                             02742000
CCAFLAG1 EQU   CCAFFUNC+8                                               02743000
CCAACCPT EQU   CCAFLAG1                                                 02744000
CCAFLAG2 EQU   CCAFFUNC+11                                              02745000
CCAFPROC EQU   HMASMCCA+276                                             02746000
CCAFLAG3 EQU   CCAFPROC                                                 02747000
CCAFDIS  EQU   HMASMCCA+278                                             02748000
CCAFLAG4 EQU   CCAFDIS                                                  02749000
CCAFLAG5 EQU   CCAFDIS+1                                                02750000
CCAFLAG6 EQU   CCAFDIS+2                                                02751000
CCAFCNV  EQU   HMASMCCA+281                                             02752000
CCAFLAG8 EQU   CCAFCNV                                                  02753000
CCAFCTL  EQU   HMASMCCA+282                                             02754000
CCAFLAG9 EQU   CCAFCTL                                                  02755000
CCAFDSNG EQU   HMASMCCA+298                                             02756000
CCAFLAGB EQU   CCAFDSNG                                                 02757000
CCABLDLA EQU   0                                                        02758000
@NM00025 EQU   CCABLDLA                                                 02759000
CCABLDLL EQU   0                                                        02760000
@NM00027 EQU   CCABLDLL                                                 02761000
CCALKDNM EQU   @NM00027                                                 02762000
CCALKED  EQU   @NM00027+8                                               02763000
CCALKDSP EQU   @NM00027+12                                              02764000
CCALKDRC EQU   @NM00027+20                                              02765000
CCARLINK EQU   CCALKDRC                                                 02766000
CCALKDPM EQU   @NM00027+24                                              02767000
@NM00029 EQU   CCABLDLL+124                                             02768000
CCAASMRC EQU   @NM00029+20                                              02769000
@NM00031 EQU   CCABLDLL+248                                             02770000
CCACPYRC EQU   @NM00031+20                                              02771000
@NM00033 EQU   CCABLDLL+372                                             02772000
CCACOMRC EQU   @NM00033+20                                              02773000
@NM00035 EQU   CCABLDLL+496                                             02774000
CCAZAPRC EQU   @NM00035+20                                              02775000
@NM00037 EQU   CCABLDLL+620                                             02776000
CCASUPRC EQU   @NM00037+20                                              02777000
@NM00039 EQU   CCABLDLL+744                                             02778000
CCAUPDRC EQU   @NM00039+20                                              02779000
CCABLDLM EQU   0                                                        02780000
CCABELMT EQU   CCABLDLM+4                                               02781000
CCABMPOS EQU   CCABELMT                                                 02782000
HMASMIOP EQU   0                                                        02783000
IOPDSID  EQU   HMASMIOP                                                 02784000
IOPFUNCT EQU   HMASMIOP+1                                               02785000
IOPRETRN EQU   HMASMIOP+2                                               02786000
IOPTYPE  EQU   HMASMIOP+3                                               02787000
IOPNAME  EQU   HMASMIOP+4                                               02788000
@NM00043 EQU   HMASMIOP+12                                              02789000
@NM00044 EQU   @NM00043                                                 02790000
IOPDDNAM EQU   HMASMIOP+24                                              02791000
IOPBUFAD EQU   HMASMIOP+52                                              02792000
IOPDRMAP EQU   HMASMIOP+56                                              02793000
IOPINAME EQU   IOPDRMAP                                                 02794000
IOPINAM  EQU   IOPINAME                                                 02795000
IOPITYP  EQU   IOPINAM                                                  02796000
IOPTTR   EQU   IOPDRMAP+8                                               02797000
IOPUSERL EQU   IOPDRMAP+11                                              02798000
IOPEND   EQU   IOPDRMAP+12                                              02799000
IOPLMCTL EQU   0                                                        02800000
IOPQSMIF EQU   0                                                        02801000
@NM00154 EQU   IOPQSMIF                                                 02802000
IOPQSMLS EQU   IOPQSMIF+8                                               02803000
IOPQSMNM EQU   IOPQSMLS                                                 02804000
IOPBS02  EQU   0                                                        02805000
IOPBS04  EQU   0                                                        02806000
IOPBAPF  EQU   IOPBS04                                                  02807000
HMASMICT EQU   0                                                        02808000
ICTCORE  EQU   HMASMICT                                                 02809000
ICTPSPLN EQU   ICTCORE                                                  02810000
ICTMSPLN EQU   ICTCORE+4                                                02811000
ICTLSPLN EQU   ICTCORE+8                                                02812000
ICTGMSPL EQU   0                                                        02813000
ICTPTF   EQU   0                                                        02814000
ICTPTFS  EQU   ICTPTF                                                   02815000
ICTPFLG1 EQU   ICTPTF+7                                                 02816000
ICTPFLG3 EQU   ICTPTF+8                                                 02817000
ICTPPROC EQU   ICTPFLG3                                                 02818000
ICTPROCS EQU   ICTPPROC                                                 02819000
ICTPFLG5 EQU   ICTPTF+9                                                 02820000
ICTPFLG6 EQU   ICTPTF+11                                                02821000
ICTPFLF  EQU   ICTPFLG6                                                 02822000
ICTPFLG2 EQU   ICTPTF+12                                                02823000
ICTPFLG4 EQU   ICTPTF+13                                                02824000
ICTPFLG8 EQU   ICTPTF+14                                                02825000
ICTPFLG9 EQU   ICTPTF+15                                                02826000
@NM00181 EQU   ICTPFLG9                                                 02827000
ICTPFLGA EQU   ICTPTF+16                                                02828000
ICTPUSR1 EQU   ICTPFLGA                                                 02829000
ICTPCHN  EQU   ICTPTF+64                                                02830000
ICTPRCHN EQU   ICTPTF+68                                                02831000
ICTPSCHN EQU   ICTPTF+72                                                02832000
ICTPPCHN EQU   ICTPTF+76                                                02833000
ICTPICHN EQU   ICTPTF+80                                                02834000
ICTPNCHN EQU   ICTPTF+84                                                02835000
ICTPVCHN EQU   ICTPTF+88                                                02836000
ICTPDCHN EQU   ICTPTF+92                                                02837000
ICTPBCHN EQU   ICTPTF+96                                                02838000
ICTIXPF  EQU   0                                                        02839000
ICTENTLS EQU   0                                                        02840000
ICTENTNT EQU   ICTENTLS                                                 02841000
ICTENTNM EQU   ICTENTNT                                                 02842000
ICTENTST EQU   ICTENTNT+7                                               02843000
ICTREQLS EQU   0                                                        02844000
ICTREQNT EQU   ICTREQLS                                                 02845000
ICTREQNM EQU   ICTREQNT                                                 02846000
ICTREQST EQU   ICTREQNT+7                                               02847000
ICTSUPLS EQU   0                                                        02848000
ICTSUPNT EQU   ICTSUPLS                                                 02849000
ICTSUPNM EQU   ICTSUPNT                                                 02850000
ICTPRELS EQU   0                                                        02851000
ICTPRENT EQU   ICTPRELS                                                 02852000
ICTPRENM EQU   ICTPRENT                                                 02853000
ICTPREST EQU   ICTPRENT+7                                               02854000
ICTIRQLS EQU   0                                                        02855000
ICTIRQNT EQU   ICTIRQLS                                                 02856000
ICTIRQNM EQU   ICTIRQNT                                                 02857000
ICTIRQST EQU   ICTIRQNT+7                                               02858000
ICTCSRST EQU   ICTIRQNT+15                                              02859000
ICTNPRLS EQU   0                                                        02860000
ICTNPRNT EQU   ICTNPRLS                                                 02861000
ICTNPRNM EQU   ICTNPRNT                                                 02862000
ICTVRSLS EQU   0                                                        02863000
ICTVRSNT EQU   ICTVRSLS                                                 02864000
ICTVRSNM EQU   ICTVRSNT                                                 02865000
ICTDELLS EQU   0                                                        02866000
ICTDELNT EQU   ICTDELLS                                                 02867000
ICTDELNM EQU   ICTDELNT                                                 02868000
ICTDELST EQU   ICTDELNT+7                                               02869000
ICTSBYLS EQU   0                                                        02870000
ICTSBYNT EQU   ICTSBYLS                                                 02871000
ICTSBYNM EQU   ICTSBYNT                                                 02872000
ICTMOD   EQU   0                                                        02873000
ICTMNAME EQU   ICTMOD                                                   02874000
ICTMFLG2 EQU   ICTMOD+8                                                 02875000
ICTMPROC EQU   ICTMFLG2                                                 02876000
ICTMCPL  EQU   ICTMFLG2                                                 02877000
ICTMFLG1 EQU   ICTMOD+9                                                 02878000
ICTMMODR EQU   ICTMFLG1                                                 02879000
ICTMMOD  EQU   ICTMMODR                                                 02880000
ICTMXPND EQU   ICTMFLG1                                                 02881000
ICTMFLG3 EQU   ICTMOD+10                                                02882000
ICTMTRX  EQU   ICTMFLG3                                                 02883000
ICTMALIS EQU   ICTMFLG3                                                 02884000
ICTMFLG4 EQU   ICTMOD+11                                                02885000
ICTMISEL EQU   ICTMFLG4                                                 02886000
ICTMFLG5 EQU   ICTMOD+12                                                02887000
ICTMODF4 EQU   ICTMOD+13                                                02888000
ICTMLEP1 EQU   ICTMODF4                                                 02889000
ICTMODF5 EQU   ICTMOD+14                                                02890000
ICTMLEP2 EQU   ICTMODF5                                                 02891000
ICTMODF6 EQU   ICTMOD+15                                                02892000
ICTMLEP3 EQU   ICTMODF6                                                 02893000
ICTMODF7 EQU   ICTMOD+16                                                02894000
ICTMLEP4 EQU   ICTMODF7                                                 02895000
ICTMACF4 EQU   ICTMOD+17                                                02896000
ICTMRELN EQU   ICTMOD+22                                                02897000
ICTFMLIB EQU   ICTMOD+24                                                02898000
ICTPPTR  EQU   ICTMOD+96                                                02899000
ICTMCHN  EQU   ICTMOD+100                                               02900000
ICTMICHN EQU   ICTMOD+104                                               02901000
ICTMACHN EQU   ICTMOD+112                                               02902000
ICTMTCHN EQU   ICTMOD+116                                               02903000
ICTMVCHN EQU   ICTMOD+120                                               02904000
ICTMUCHN EQU   ICTMOD+124                                               02905000
ICTIXMF  EQU   0                                                        02906000
ICTMIDLS EQU   0                                                        02907000
ICTMID   EQU   ICTMIDLS                                                 02908000
ICTMODID EQU   ICTMID                                                   02909000
ICTMODST EQU   ICTMID+7                                                 02910000
ICTASMLS EQU   0                                                        02911000
ICTASMAD EQU   ICTASMLS                                                 02912000
ICTTALLS EQU   0                                                        02913000
ICTTALNM EQU   ICTTALLS                                                 02914000
ICTTALND EQU   ICTTALNM                                                 02915000
ICTMVRLS EQU   0                                                        02916000
ICTMVRNT EQU   ICTMVRLS                                                 02917000
ICTMVRNM EQU   ICTMVRNT                                                 02918000
ICTMUMLS EQU   0                                                        02919000
ICTMUMNT EQU   ICTMUMLS                                                 02920000
ICTMUMNM EQU   ICTMUMNT                                                 02921000
ICTLMOD  EQU   0                                                        02922000
ICTLMNAM EQU   ICTLMOD                                                  02923000
ICTLNAME EQU   ICTLMNAM                                                 02924000
ICTLEND  EQU   ICTLNAME                                                 02925000
ICTLFLG4 EQU   ICTLMOD+8                                                02926000
ICTLPROC EQU   ICTLFLG4                                                 02927000
ICTLCPL  EQU   ICTLFLG4                                                 02928000
ICTLFLG1 EQU   ICTLMOD+9                                                02929000
ICTLAPF  EQU   ICTLFLG1                                                 02930000
ICTLRENT EQU   ICTLFLG1                                                 02931000
ICTLREUS EQU   ICTLFLG1                                                 02932000
ICTLSCTR EQU   ICTLFLG1                                                 02933000
ICTLOVLY EQU   ICTLFLG1                                                 02934000
ICTLREFR EQU   ICTLFLG1                                                 02935000
ICTLDC   EQU   ICTLFLG1                                                 02936000
ICTLFLG5 EQU   ICTLMOD+10                                               02937000
ICTLNE   EQU   ICTLFLG5                                                 02938000
ICTLPAGA EQU   ICTLFLG5                                                 02939000
ICTLFLG6 EQU   ICTLMOD+11                                               02940000
ICTLFLG7 EQU   ICTLMOD+12                                               02941000
ICTLFLG2 EQU   ICTLMOD+13                                               02942000
ICTCOPY  EQU   ICTLFLG2                                                 02943000
ICTLFLG3 EQU   ICTLMOD+14                                               02944000
ICTTIND1 EQU   ICTLFLG3                                                 02945000
ICTLXPND EQU   ICTLFLG3                                                 02946000
ICTLLKD  EQU   ICTLFLG3                                                 02947000
ICTTG1   EQU   ICTLMOD+15                                               02948000
ICTTG2   EQU   ICTLMOD+23                                               02949000
ICTLTTR  EQU   ICTLMOD+31                                               02950000
ICTLCHN  EQU   ICTLMOD+34                                               02951000
ICTIXLF  EQU   0                                                        02952000
ICTIXL   EQU   ICTIXLF                                                  02953000
RVAPARM  EQU   0                                                        02954000
RVAINFO  EQU   RVAPARM                                                  02955000
RVAPASS  EQU   RVAPARM+12                                               02956000
RVASTAE  EQU   RVAPARM+20                                               02957000
RVAEPRNM EQU   RVASTAE+4                                                02958000
@NM00227 EQU   RVASTAE+16                                               02959000
@NM00228 EQU   RVASTAE+20                                               02960000
RVAFLAGS EQU   RVASTAE+24                                               02961000
BUFFER   EQU   0                                                        02962000
CCADSIDA EQU   0                                                        02963000
CCATYPEA EQU   0                                                        02964000
IOPBS01  EQU   0                                                        02965000
IOPBS03  EQU   0                                                        02966000
IOPUDATA EQU   IOPEND                                                   02967000
IOPINAM3 EQU   IOPINAME                                                 02968000
@NM00050 EQU   IOPINAM3                                                 02969000
IOPSTCMP EQU   IOPUDATA                                                 02970000
IOPDYNDT EQU   IOPUDATA                                                 02971000
IOPDSN   EQU   IOPDYNDT                                                 02972000
IOPSPACE EQU   IOPDYNDT+44                                              02973000
IOPDTYPE EQU   IOPDYNDT+50                                              02974000
IOPNTMAX EQU   IOPDRMAP                                                 02975000
IOPNTMAP EQU   IOPDRMAP                                                 02976000
IOPCDMAP EQU   IOPNTMAP                                                 02977000
IOPPTMAP EQU   IOPCDMAP                                                 02978000
IOPSCMAP EQU   IOPPTMAP                                                 02979000
IOPDIRCT EQU   IOPSCMAP+12                                              02980000
IOPCDMAX EQU   IOPDIRCT                                                 02981000
IOPCQMAP EQU   IOPDRMAP                                                 02982000
@NM00061 EQU   IOPUDATA                                                 02983000
@NM00062 EQU   IOPUDATA                                                 02984000
IOPASMNT EQU   IOPUDATA                                                 02985000
IOPASMDR EQU   IOPASMNT                                                 02986000
IOPABUNT EQU   IOPASMDR+1                                               02987000
IOPLMDNT EQU   IOPUDATA                                                 02988000
IOPLMDDR EQU   IOPLMDNT                                                 02989000
IOPLMLEP EQU   IOPLMDDR+1                                               02990000
IOPLMDF1 EQU   IOPLMLEP                                                 02991000
IOPFLGS2 EQU   IOPLMDF1                                                 02992000
IOPLMDF2 EQU   IOPLMLEP+1                                               02993000
IOPLMDF3 EQU   IOPLMLEP+2                                               02994000
IOPLMDF4 EQU   IOPLMLEP+3                                               02995000
IOPLMDF5 EQU   IOPLMDDR+5                                               02996000
IOPFLGS3 EQU   IOPLMDF5                                                 02997000
IOPLMDFX EQU   IOPLMDNT+24                                              02998000
@NM00071 EQU   IOPLMDFX                                                 02999000
IOPLNTRY EQU   IOPLMDFX+8                                               03000000
IOPLSYS  EQU   IOPLNTRY                                                 03001000
IOPSYSLB EQU   IOPLSYS                                                  03002000
IOPMACNT EQU   IOPUDATA                                                 03003000
IOPMACDR EQU   IOPMACNT                                                 03004000
IOPRMIDE EQU   IOPMACDR+1                                               03005000
IOPRMST  EQU   IOPRMIDE+7                                               03006000
IOPFMIDE EQU   IOPMACDR+9                                               03007000
IOPMACFX EQU   IOPMACNT+24                                              03008000
IOPBUNT  EQU   IOPMACFX                                                 03009000
IOPMCEND EQU   IOPMACNT+104                                             03010000
IOPMACVR EQU   IOPMCEND                                                 03011000
IOPMCENT EQU   IOPMACVR                                                 03012000
IOPMCDTA EQU   IOPMCENT                                                 03013000
IOPMCASM EQU   IOPMCDTA                                                 03014000
IOPMACID EQU   IOPMCASM                                                 03015000
IOPMACST EQU   IOPMCASM+7                                               03016000
IOPMCIND EQU   IOPMCENT+8                                               03017000
IOPEOFNT EQU   IOPUDATA                                                 03018000
IOPSRCNT EQU   IOPUDATA                                                 03019000
IOPSRCDR EQU   IOPSRCNT                                                 03020000
@NM00082 EQU   IOPSRCDR+1                                               03021000
@NM00084 EQU   @NM00082+7                                               03022000
@NM00088 EQU   IOPSRCDR+9                                               03023000
IOPSRCFX EQU   IOPSRCNT+24                                              03024000
@NM00092 EQU   IOPSRCFX                                                 03025000
IOPSREND EQU   IOPSRCNT+104                                             03026000
IOPSRCVR EQU   IOPSREND                                                 03027000
IOPSNTRY EQU   IOPSRCVR                                                 03028000
IOPSRDTA EQU   IOPSNTRY                                                 03029000
IOPSRCID EQU   IOPSRDTA                                                 03030000
IOPSRCST EQU   IOPSRDTA+7                                               03031000
IOPMODNT EQU   IOPUDATA                                                 03032000
IOPMODDR EQU   IOPMODNT                                                 03033000
@NM00098 EQU   IOPMODDR+1                                               03034000
@NM00100 EQU   @NM00098+7                                               03035000
@NM00104 EQU   IOPMODDR+9                                               03036000
IOPMODFX EQU   IOPMODNT+24                                              03037000
@NM00108 EQU   IOPMODFX                                                 03038000
IOPMDLEP EQU   IOPMODFX+8                                               03039000
IOPMODF1 EQU   IOPMDLEP                                                 03040000
IOPMODF2 EQU   IOPMDLEP+1                                               03041000
IOPMODF3 EQU   IOPMDLEP+2                                               03042000
IOPMODF4 EQU   IOPMDLEP+3                                               03043000
IOPMDEND EQU   IOPMODNT+104                                             03044000
IOPMODVR EQU   IOPMDEND                                                 03045000
IOPMNTRY EQU   IOPMODVR                                                 03046000
IOPMDDTA EQU   IOPMNTRY                                                 03047000
IOPLMODS EQU   IOPMDDTA                                                 03048000
IOPMODID EQU   IOPLMODS                                                 03049000
IOPMODST EQU   IOPLMODS+7                                               03050000
IOPDLBNT EQU   IOPUDATA                                                 03051000
IOPDLBDR EQU   IOPDLBNT                                                 03052000
IOPDLBFX EQU   IOPDLBNT+24                                              03053000
@NM00119 EQU   IOPDLBFX                                                 03054000
IOPDLEND EQU   IOPDLBNT+104                                             03055000
IOPDLBVR EQU   IOPDLEND                                                 03056000
IOPDNTRY EQU   IOPDLBVR                                                 03057000
IOPDSYS  EQU   IOPDNTRY                                                 03058000
IOPSYSNT EQU   IOPUDATA                                                 03059000
IOPSYSDR EQU   IOPSYSNT                                                 03060000
IOPSYSF1 EQU   IOPSYSDR+4                                               03061000
IOPFLGS7 EQU   IOPSYSF1                                                 03062000
IOPSYSFX EQU   IOPSYSNT+24                                              03063000
@NM00126 EQU   IOPSYSFX                                                 03064000
IOPSYEND EQU   IOPSYSNT+184                                             03065000
IOPSYSVR EQU   IOPSYEND                                                 03066000
IOPSYSTR EQU   IOPSYSVR                                                 03067000
IOPSYNTR EQU   IOPSYSTR                                                 03068000
IOPPTFNT EQU   IOPUDATA                                                 03069000
IOPPTFDR EQU   IOPPTFNT                                                 03070000
IOPPSTAT EQU   IOPPTFDR+2                                               03071000
IOPPTFF1 EQU   IOPPSTAT                                                 03072000
IOPFLGS5 EQU   IOPPTFF1                                                 03073000
IOPPTFF2 EQU   IOPPSTAT+1                                               03074000
IOPPTFF3 EQU   IOPPSTAT+3                                               03075000
IOPPTFFX EQU   IOPPTFNT+24                                              03076000
@NM00135 EQU   IOPPTFFX                                                 03077000
@NM00136 EQU   @NM00135                                                 03078000
IOPPDTES EQU   IOPPTFFX+41                                              03079000
@NM00139 EQU   IOPPDTES                                                 03080000
IOPPTPFX EQU   IOPPDTES+6                                               03081000
IOPDATES EQU   IOPPTPFX                                                 03082000
IOPPTEND EQU   IOPPTFNT+104                                             03083000
IOPPTFVR EQU   IOPPTEND                                                 03084000
IOPPNTRY EQU   IOPPTFVR                                                 03085000
IOPPMODS EQU   IOPPNTRY                                                 03086000
IOPENTNT EQU   IOPUDATA+104                                             03087000
IOPSRLNT EQU   IOPUDATA+104                                             03088000
IOPPRENT EQU   IOPUDATA+104                                             03089000
IOPNPRNT EQU   IOPUDATA+104                                             03090000
IOPSUPNT EQU   IOPUDATA+104                                             03091000
IOPREQNT EQU   IOPUDATA+104                                             03092000
IOPIRQNT EQU   IOPUDATA+104                                             03093000
IOPFIDNT EQU   IOPUDATA+104                                             03094000
IOPDELNT EQU   IOPUDATA+104                                             03095000
IOPVERNT EQU   IOPUDATA+104                                             03096000
IOPSBYNT EQU   IOPUDATA+104                                             03097000
IOPQSMNT EQU   IOPUDATA                                                 03098000
IOPQSMDR EQU   IOPQSMNT                                                 03099000
IOPQFMNT EQU   IOPUDATA                                                 03100000
IOPQFMDR EQU   IOPQFMNT                                                 03101000
IOPQFEND EQU   IOPQFMNT+2                                               03102000
IOPQFMVR EQU   IOPQFEND                                                 03103000
IOPQFMLS EQU   IOPQFMVR                                                 03104000
IOPQFMNM EQU   IOPQFMLS                                                 03105000
IOPPTSYS EQU   IOPUDATA                                                 03106000
IOPPTSDR EQU   IOPPTSYS                                                 03107000
IOPPTSFX EQU   IOPPTSYS+24                                              03108000
IOPDSSPC EQU   IOPPTSFX                                                 03109000
IOPPTFG1 EQU   IOPPTSFX+34                                              03110000
IOPPSEND EQU   IOPPTSYS+1064                                            03111000
IOPPTSVR EQU   IOPPSEND                                                 03112000
IOPPTNTR EQU   IOPPTSVR                                                 03113000
@NM00164 EQU   IOPPTNTR                                                 03114000
IOPPTFMD EQU   @NM00164                                                 03115000
IOPPTREL EQU   IOPPTFMD                                                 03116000
IOPBPDS  EQU   IOPUDATA                                                 03117000
IOPBLEP1 EQU   IOPBPDS+8                                                03118000
IOPBLEP2 EQU   IOPBPDS+9                                                03119000
@NM00168 EQU   IOPBPDS+18                                               03120000
IOPBFTB0 EQU   @NM00168                                                 03121000
IOPBFTB1 EQU   IOPBFTB0                                                 03122000
ICTENDNT EQU   ICTENDCH                                                 03123000
ICTENDIX EQU   ICTENDCH                                                 03124000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    03125000
IOPBCEND EQU   IOPBPDS+21                                               03126000
IOPBFTB3 EQU   IOPBFTB0+2                                               03127000
IOPBFTB2 EQU   IOPBFTB0+1                                               03128000
@NM00170 EQU   IOPBFTB1                                                 03129000
IOPBAPFP EQU   IOPBFTB1                                                 03130000
IOPBSSI  EQU   IOPBFTB1                                                 03131000
IOPBPAGA EQU   IOPBFTB1                                                 03132000
@NM00169 EQU   IOPBFTB1                                                 03133000
IOPBAOSL EQU   IOPBFTB1                                                 03134000
IOPBSEPA EQU   IOPBPDS+15                                               03135000
IOPBFTBL EQU   IOPBPDS+13                                               03136000
IOPBSTOR EQU   IOPBPDS+10                                               03137000
IOPBREFR EQU   IOPBLEP2                                                 03138000
IOPBLEF  EQU   IOPBLEP2                                                 03139000
IOPBTEST EQU   IOPBLEP2                                                 03140000
IOPBNE   EQU   IOPBLEP2                                                 03141000
@NM00167 EQU   IOPBLEP2                                                 03142000
IOPBDC   EQU   IOPBLEP2                                                 03143000
@NM00166 EQU   IOPBLEP1                                                 03144000
IOPBSCTR EQU   IOPBLEP1                                                 03145000
IOPBOL   EQU   IOPBLEP1                                                 03146000
@NM00165 EQU   IOPBLEP1                                                 03147000
IOPBOVLY EQU   IOPBLEP1                                                 03148000
IOPBREUS EQU   IOPBLEP1                                                 03149000
IOPBRENT EQU   IOPBLEP1                                                 03150000
IOPBNL   EQU   IOPBPDS+7                                                03151000
IOPBTTRN EQU   IOPBPDS+4                                                03152000
IOPBZERO EQU   IOPBPDS+3                                                03153000
IOPBTTRT EQU   IOPBPDS                                                  03154000
IOPPTIND EQU   IOPPTNTR+8                                               03155000
IOPPTSND EQU   IOPPTREL                                                 03156000
@NM00163 EQU   IOPPTSFX+872                                             03157000
IOPSYZPP EQU   IOPPTSFX+772                                             03158000
IOPSYZPR EQU   IOPPTSFX+771                                             03159000
IOPSYZPS EQU   IOPPTSFX+763                                             03160000
IOPSYZAP EQU   IOPPTSFX+755                                             03161000
IOPSYUPP EQU   IOPPTSFX+655                                             03162000
IOPSYUPR EQU   IOPPTSFX+654                                             03163000
IOPSYUPS EQU   IOPPTSFX+646                                             03164000
IOPSYUPD EQU   IOPPTSFX+638                                             03165000
IOPSYSPP EQU   IOPPTSFX+538                                             03166000
IOPSYSPR EQU   IOPPTSFX+537                                             03167000
IOPSYSPS EQU   IOPPTSFX+529                                             03168000
IOPSYSUP EQU   IOPPTSFX+521                                             03169000
IOPSYLKP EQU   IOPPTSFX+421                                             03170000
IOPSYLKR EQU   IOPPTSFX+420                                             03171000
IOPSYLKS EQU   IOPPTSFX+412                                             03172000
IOPSYLKD EQU   IOPPTSFX+404                                             03173000
IOPSYCPP EQU   IOPPTSFX+304                                             03174000
IOPSYCPR EQU   IOPPTSFX+303                                             03175000
IOPSYCPS EQU   IOPPTSFX+295                                             03176000
IOPSYCPY EQU   IOPPTSFX+287                                             03177000
IOPSYCOP EQU   IOPPTSFX+187                                             03178000
IOPSYCOR EQU   IOPPTSFX+186                                             03179000
IOPSYCOS EQU   IOPPTSFX+178                                             03180000
IOPSYCOM EQU   IOPPTSFX+170                                             03181000
IOPSYASP EQU   IOPPTSFX+70                                              03182000
IOPSYASR EQU   IOPPTSFX+69                                              03183000
IOPSYASS EQU   IOPPTSFX+61                                              03184000
IOPSYASM EQU   IOPPTSFX+53                                              03185000
@NM00162 EQU   IOPPTSFX+35                                              03186000
@NM00161 EQU   IOPPTFG1                                                 03187000
IOPPTSNJ EQU   IOPPTFG1                                                 03188000
IOPPTSNP EQU   IOPPTFG1                                                 03189000
IOPSYPLN EQU   IOPPTSFX+32                                              03190000
IOPDSPFX EQU   IOPPTSFX+6                                               03191000
IOPDSDIR EQU   IOPDSSPC+4                                               03192000
IOPDSSEC EQU   IOPDSSPC+2                                               03193000
IOPDSPRM EQU   IOPDSSPC                                                 03194000
@NM00160 EQU   IOPPTSDR+4                                               03195000
IOPPTPEM EQU   IOPPTSDR+2                                               03196000
IOPPCNVL EQU   IOPPTSDR+1                                               03197000
@NM00159 EQU   IOPPTSDR                                                 03198000
IOPQFMTP EQU   IOPQFMLS+8                                               03199000
@NM00158 EQU   IOPQFMLS+7                                               03200000
IOPQFMND EQU   IOPQFMNM                                                 03201000
@NM00157 EQU   IOPQFMDR                                                 03202000
@NM00153 EQU   IOPQSMDR                                                 03203000
@NM00152 EQU   IOPSBYNT+8                                               03204000
IOPSBYST EQU   IOPSBYNT+7                                               03205000
IOPSBYNM EQU   IOPSBYNT                                                 03206000
@NM00151 EQU   IOPVERNT+8                                               03207000
IOPVERST EQU   IOPVERNT+7                                               03208000
IOPVERNM EQU   IOPVERNT                                                 03209000
@NM00150 EQU   IOPDELNT+8                                               03210000
IOPDELST EQU   IOPDELNT+7                                               03211000
IOPDELNM EQU   IOPDELNT                                                 03212000
@NM00149 EQU   IOPFIDNT+8                                               03213000
IOPFIDST EQU   IOPFIDNT+7                                               03214000
IOPFIDNM EQU   IOPFIDNT                                                 03215000
@NM00148 EQU   IOPIRQNT+8                                               03216000
IOPIRQST EQU   IOPIRQNT+7                                               03217000
IOPIRQNM EQU   IOPIRQNT                                                 03218000
@NM00147 EQU   IOPREQNT+8                                               03219000
IOPREQST EQU   IOPREQNT+7                                               03220000
IOPREQNM EQU   IOPREQNT                                                 03221000
@NM00146 EQU   IOPSUPNT+8                                               03222000
IOPSUPST EQU   IOPSUPNT+7                                               03223000
IOPSUPNM EQU   IOPSUPNT                                                 03224000
@NM00145 EQU   IOPNPRNT+8                                               03225000
IOPNPRST EQU   IOPNPRNT+7                                               03226000
IOPNPRNM EQU   IOPNPRNT                                                 03227000
@NM00144 EQU   IOPPRENT+8                                               03228000
IOPPREST EQU   IOPPRENT+7                                               03229000
IOPPRENM EQU   IOPPRENT                                                 03230000
@NM00143 EQU   IOPSRLNT+8                                               03231000
IOPSRLST EQU   IOPSRLNT+7                                               03232000
@NM00142 EQU   IOPSRLNT+4                                               03233000
IOPSRLNM EQU   IOPSRLNT                                                 03234000
@NM00141 EQU   IOPENTNT+8                                               03235000
IOPENTST EQU   IOPENTNT+7                                               03236000
IOPENTNM EQU   IOPENTNT                                                 03237000
IOPPIND  EQU   IOPPNTRY+8                                               03238000
IOPPTFND EQU   IOPPMODS                                                 03239000
IOPPFMID EQU   IOPPTFFX+73                                              03240000
@NM00140 EQU   IOPPTPFX+24                                              03241000
IOPUCLT  EQU   IOPDATES+21                                              03242000
IOPUCLD  EQU   IOPDATES+18                                              03243000
IOPACCT  EQU   IOPDATES+15                                              03244000
IOPACCD  EQU   IOPDATES+12                                              03245000
IOPRSTT  EQU   IOPDATES+9                                               03246000
IOPRSTD  EQU   IOPDATES+6                                               03247000
IOPAPPT  EQU   IOPDATES+3                                               03248000
IOPAPPD  EQU   IOPDATES                                                 03249000
IOPRECT  EQU   @NM00139+3                                               03250000
IOPRECD  EQU   @NM00139                                                 03251000
@NM00138 EQU   IOPPTFFX+8                                               03252000
@NM00137 EQU   @NM00135+7                                               03253000
IOPPRELN EQU   @NM00136                                                 03254000
@NM00134 EQU   IOPPTFDR+20                                              03255000
IOPSBYNO EQU   IOPPTFDR+13                                              03256000
IOPDBYNO EQU   IOPPTFDR+6                                               03257000
@NM00133 EQU   IOPPTFF3                                                 03258000
IOPFLF   EQU   IOPPTFF3                                                 03259000
IOPDBYP  EQU   IOPPTFF3                                                 03260000
IOPSBYP  EQU   IOPPTFF3                                                 03261000
IOPPMDLP EQU   IOPPTFF2+1                                               03262000
IOPPADDP EQU   IOPPTFF2+1                                               03263000
@NM00132 EQU   IOPPTFF2+1                                               03264000
IOPLRFP  EQU   IOPPTFF2                                                 03265000
IOPJCLP  EQU   IOPPTFF2                                                 03266000
IOPSUPP  EQU   IOPPTFF2                                                 03267000
IOPREQP  EQU   IOPPTFF2                                                 03268000
IOPPREP  EQU   IOPPTFF2                                                 03269000
IOPNPRP  EQU   IOPPTFF2                                                 03270000
IOPIRQP  EQU   IOPPTFF2                                                 03271000
IOPDELP  EQU   IOPPTFF2                                                 03272000
IOPREGEN EQU   IOPFLGS5                                                 03273000
IOPBYP   EQU   IOPFLGS5                                                 03274000
IOPDUMMP EQU   IOPFLGS5                                                 03275000
@NM00131 EQU   IOPFLGS5                                                 03276000
IOPERROR EQU   IOPFLGS5                                                 03277000
IOPACC   EQU   IOPFLGS5                                                 03278000
IOPRES   EQU   IOPFLGS5                                                 03279000
IOPAPP   EQU   IOPFLGS5                                                 03280000
IOPPTYPE EQU   IOPPTFDR+1                                               03281000
@NM00130 EQU   IOPPTFDR                                                 03282000
IOPSYSTP EQU   IOPSYSTR+8                                               03283000
IOPSYSND EQU   IOPSYNTR                                                 03284000
@NM00129 EQU   IOPSYSFX+21                                              03285000
IOPSYSID EQU   IOPSYSFX+13                                              03286000
IOPNUCID EQU   IOPSYSFX+12                                              03287000
IOPSREL  EQU   IOPSYSFX+8                                               03288000
@NM00128 EQU   @NM00126+7                                               03289000
@NM00127 EQU   @NM00126                                                 03290000
@NM00125 EQU   IOPSYSDR+5                                               03291000
@NM00124 EQU   IOPFLGS7                                                 03292000
IOPSYNG  EQU   IOPFLGS7                                                 03293000
IOPSYDL  EQU   IOPFLGS7                                                 03294000
IOPSTSNP EQU   IOPFLGS7                                                 03295000
IOPMTSNP EQU   IOPFLGS7                                                 03296000
IOPPEMAX EQU   IOPSYSDR+2                                               03297000
IOPSCNVL EQU   IOPSYSDR+1                                               03298000
@NM00123 EQU   IOPSYSDR                                                 03299000
IOPDLIND EQU   IOPDNTRY+8                                               03300000
IOPDLBND EQU   IOPDSYS                                                  03301000
@NM00122 EQU   IOPDLBFX+8                                               03302000
@NM00121 EQU   @NM00119+7                                               03303000
@NM00120 EQU   @NM00119                                                 03304000
@NM00118 EQU   IOPDLBDR+1                                               03305000
@NM00117 EQU   IOPDLBDR                                                 03306000
IOPMDIND EQU   IOPMNTRY+8                                               03307000
@NM00116 EQU   IOPMODST                                                 03308000
IOPMODND EQU   IOPMODID                                                 03309000
IOPDLIB  EQU   IOPMODFX+72                                              03310000
@NM00115 EQU   IOPMODFX+12                                              03311000
@NM00114 EQU   IOPMODF4                                                 03312000
@NM00113 EQU   IOPMODF3                                                 03313000
@NM00112 EQU   IOPMODF2                                                 03314000
IOPMPAGA EQU   IOPMODF2                                                 03315000
IOPMNE   EQU   IOPMODF2                                                 03316000
@NM00111 EQU   IOPMODF1                                                 03317000
IOPMDC   EQU   IOPMODF1                                                 03318000
IOPMREFR EQU   IOPMODF1                                                 03319000
IOPMOVLY EQU   IOPMODF1                                                 03320000
IOPMSCTR EQU   IOPMODF1                                                 03321000
IOPMREUS EQU   IOPMODF1                                                 03322000
IOPMRENT EQU   IOPMODF1                                                 03323000
IOPMAPF  EQU   IOPMODF1                                                 03324000
@NM00110 EQU   @NM00108+7                                               03325000
@NM00109 EQU   @NM00108                                                 03326000
@NM00107 EQU   IOPMODDR+17                                              03327000
@NM00106 EQU   @NM00104+7                                               03328000
@NM00105 EQU   @NM00104                                                 03329000
@NM00103 EQU   @NM00100                                                 03330000
@NM00102 EQU   @NM00100                                                 03331000
@NM00101 EQU   @NM00100                                                 03332000
@NM00099 EQU   @NM00098                                                 03333000
@NM00097 EQU   IOPMODDR                                                 03334000
IOPSRIND EQU   IOPSNTRY+8                                               03335000
@NM00096 EQU   IOPSRCST                                                 03336000
IOPSRCND EQU   IOPSRCID                                                 03337000
IOPSRDLB EQU   IOPSRCFX+72                                              03338000
IOPSRSYS EQU   IOPSRCFX+64                                              03339000
@NM00095 EQU   IOPSRCFX+8                                               03340000
@NM00094 EQU   @NM00092+7                                               03341000
@NM00093 EQU   @NM00092                                                 03342000
@NM00091 EQU   IOPSRCDR+18                                              03343000
IOPSRLNG EQU   IOPSRCDR+17                                              03344000
@NM00090 EQU   @NM00088+7                                               03345000
@NM00089 EQU   @NM00088                                                 03346000
@NM00087 EQU   @NM00084                                                 03347000
@NM00086 EQU   @NM00084                                                 03348000
@NM00085 EQU   @NM00084                                                 03349000
@NM00083 EQU   @NM00082                                                 03350000
@NM00081 EQU   IOPSRCDR                                                 03351000
IOPEOFND EQU   IOPEOFNT                                                 03352000
IOPMCTYP EQU   IOPMCIND                                                 03353000
@NM00080 EQU   IOPMACST                                                 03354000
IOPMACND EQU   IOPMACID                                                 03355000
IOPMCDLB EQU   IOPMACFX+72                                              03356000
IOPMCSYS EQU   IOPMACFX+64                                              03357000
@NM00079 EQU   IOPMACFX+8                                               03358000
IOPBUTYP EQU   IOPBUNT+7                                                03359000
IOPBUSMD EQU   IOPBUNT                                                  03360000
@NM00078 EQU   IOPMACDR+18                                              03361000
IOPMCLNG EQU   IOPMACDR+17                                              03362000
IOPFMST  EQU   IOPFMIDE+7                                               03363000
IOPFMID  EQU   IOPFMIDE                                                 03364000
@NM00077 EQU   IOPRMST                                                  03365000
IOPRMASM EQU   IOPRMST                                                  03366000
@NM00076 EQU   IOPRMST                                                  03367000
IOPRMID  EQU   IOPRMIDE                                                 03368000
@NM00075 EQU   IOPMACDR                                                 03369000
IOPLMIND EQU   IOPLNTRY+8                                               03370000
IOPLMDND EQU   IOPSYSLB                                                 03371000
@NM00073 EQU   @NM00071+7                                               03372000
@NM00072 EQU   @NM00071                                                 03373000
@NM00070 EQU   IOPLMDDR+6                                               03374000
@NM00069 EQU   IOPFLGS3                                                 03375000
IOPCHREP EQU   IOPFLGS3                                                 03376000
IOPLINK  EQU   IOPFLGS3                                                 03377000
IOPCOPY  EQU   IOPFLGS3                                                 03378000
@NM00068 EQU   IOPLMDF4                                                 03379000
@NM00067 EQU   IOPLMDF3                                                 03380000
@NM00066 EQU   IOPLMDF2                                                 03381000
IOPPAGA  EQU   IOPLMDF2                                                 03382000
IOPNE    EQU   IOPLMDF2                                                 03383000
@NM00065 EQU   IOPFLGS2                                                 03384000
IOPDC    EQU   IOPFLGS2                                                 03385000
IOPREFR  EQU   IOPFLGS2                                                 03386000
IOPOVLY  EQU   IOPFLGS2                                                 03387000
IOPSCTR  EQU   IOPFLGS2                                                 03388000
IOPREUS  EQU   IOPFLGS2                                                 03389000
IOPRENT  EQU   IOPFLGS2                                                 03390000
IOPAPF   EQU   IOPFLGS2                                                 03391000
@NM00064 EQU   IOPLMDDR                                                 03392000
@NM00063 EQU   IOPASMDR+9                                               03393000
IOPABUTP EQU   IOPABUNT+7                                               03394000
IOPABUPT EQU   IOPABUNT                                                 03395000
IOPNTLVL EQU   IOPASMDR                                                 03396000
IOPALLOC EQU   @NM00062+4                                               03397000
IOPUSED  EQU   @NM00062                                                 03398000
IOPTPSEQ EQU   @NM00061+8                                               03399000
IOPVLSER EQU   @NM00061+2                                               03400000
IOPBLKSI EQU   @NM00061                                                 03401000
IOPCQMAX EQU   IOPCQMAP+12                                              03402000
@NM00060 EQU   IOPCQMAP+11                                              03403000
@NM00059 EQU   IOPCQMAP+8                                               03404000
@NM00058 EQU   IOPCQMAP                                                 03405000
IOPPTMAX EQU   IOPCDMAX                                                 03406000
@NM00057 EQU   IOPSCMAP+11                                              03407000
@NM00056 EQU   IOPSCMAP+8                                               03408000
@NM00055 EQU   IOPSCMAP                                                 03409000
IOPDIRMX EQU   IOPNTMAX+12                                              03410000
@NM00054 EQU   IOPNTMAX+11                                              03411000
@NM00053 EQU   IOPNTMAX+8                                               03412000
@NM00052 EQU   IOPNTMAX                                                 03413000
@NM00051 EQU   IOPDTYPE                                                 03414000
IOPDMOD  EQU   IOPDTYPE                                                 03415000
IOPDJCL  EQU   IOPDTYPE                                                 03416000
IOPDSRC  EQU   IOPDTYPE                                                 03417000
IOPDMAC  EQU   IOPDTYPE                                                 03418000
IOPSDIR  EQU   IOPSPACE+4                                               03419000
IOPSSCND EQU   IOPSPACE+2                                               03420000
IOPSPRIM EQU   IOPSPACE                                                 03421000
IOPNTYPE EQU   IOPSTCMP+17                                              03422000
IOPNNAME EQU   IOPSTCMP+9                                               03423000
IOPOTYPE EQU   IOPSTCMP+8                                               03424000
IOPONAME EQU   IOPSTCMP                                                 03425000
IOPISEQ3 EQU   IOPINAM3+6                                               03426000
IOPITYP3 EQU   @NM00050+5                                               03427000
IOPIPTF3 EQU   @NM00050                                                 03428000
RVAEND   EQU   RVASTAE+25                                               03429000
@NM00229 EQU   RVAFLAGS                                                 03430000
RVASDWFD EQU   RVAFLAGS                                                 03431000
RVAVS1   EQU   RVAFLAGS                                                 03432000
RVAMVS   EQU   RVAFLAGS                                                 03433000
RVAUSRCH EQU   @NM00228+2                                               03434000
RVASYSCH EQU   @NM00228                                                 03435000
RVAUSRCD EQU   @NM00227+2                                               03436000
RVASYSCD EQU   @NM00227                                                 03437000
RVAABNDC EQU   RVASTAE+12                                               03438000
RVASDWAP EQU   RVASTAE                                                  03439000
RVAREC   EQU   RVAPASS+4                                                03440000
RVATBL   EQU   RVAPASS                                                  03441000
RVAMAJNM EQU   RVAINFO+8                                                03442000
RVACCAP  EQU   RVAINFO+4                                                03443000
RVAHDR   EQU   RVAINFO                                                  03444000
@NM00224 EQU   ICTLMOD+38                                               03445000
@NM00223 EQU   ICTLFLG3                                                 03446000
ICTLZAP  EQU   ICTLFLG3                                                 03447000
ICTLCPY  EQU   ICTLFLG3                                                 03448000
ICTTIND2 EQU   ICTLFLG3                                                 03449000
@NM00222 EQU   ICTLFLG2                                                 03450000
ICTLDEL  EQU   ICTLFLG2                                                 03451000
@NM00221 EQU   ICTLFLG2                                                 03452000
ICTLTDEL EQU   ICTLFLG2                                                 03453000
ICTLINK  EQU   ICTLFLG2                                                 03454000
@NM00220 EQU   ICTLFLG7                                                 03455000
@NM00219 EQU   ICTLFLG6                                                 03456000
@NM00218 EQU   ICTLFLG5                                                 03457000
@NM00217 EQU   ICTLFLG1                                                 03458000
@NM00216 EQU   ICTLFLG4                                                 03459000
ICTLPASS EQU   ICTLFLG4                                                 03460000
ICTLDDCK EQU   ICTLFLG4                                                 03461000
ICTLMSG  EQU   ICTLFLG4                                                 03462000
ICTLNOGO EQU   ICTLFLG4                                                 03463000
@NM00215 EQU   ICTMUMNT+7                                               03464000
ICTMUMND EQU   ICTMUMNM                                                 03465000
@NM00214 EQU   ICTMVRNT+7                                               03466000
ICTMVRND EQU   ICTMVRNM                                                 03467000
ICTASMND EQU   ICTASMAD                                                 03468000
ICTMIDTY EQU   ICTMODST                                                 03469000
ICTMIDAM EQU   ICTMODST                                                 03470000
ICTMIDRG EQU   ICTMODST                                                 03471000
ICTMIDF1 EQU   ICTMODST                                                 03472000
ICTMIDPL EQU   ICTMODST                                                 03473000
ICTMIDPS EQU   ICTMODST                                                 03474000
@NM00213 EQU   ICTMODST                                                 03475000
ICTMIDND EQU   ICTMODID                                                 03476000
ICTIXM   EQU   ICTIXMF                                                  03477000
@NM00212 EQU   ICTMOD+128                                               03478000
ICTMICHA EQU   ICTMOD+108                                               03479000
@NM00211 EQU   ICTMOD+95                                                03480000
ICTMFMID EQU   ICTMOD+88                                                03481000
@NM00210 EQU   ICTMOD+87                                                03482000
ICTMRMID EQU   ICTMOD+80                                                03483000
ICTMSSI  EQU   ICTMOD+72                                                03484000
ICTMDOBJ EQU   ICTMOD+64                                                03485000
ICTMSYSL EQU   ICTMOD+56                                                03486000
ICTMDSTL EQU   ICTMOD+48                                                03487000
ICTMASLB EQU   ICTMOD+40                                                03488000
ICTTOLIB EQU   ICTMOD+32                                                03489000
@NM00209 EQU   ICTMOD+21                                                03490000
ICTMLANG EQU   ICTMOD+20                                                03491000
@NM00208 EQU   ICTMOD+19                                                03492000
ICTMACF5 EQU   ICTMOD+18                                                03493000
ICTMZMPR EQU   ICTMACF4                                                 03494000
ICTMZOMZ EQU   ICTMACF4                                                 03495000
ICTMDOAS EQU   ICTMACF4                                                 03496000
ICTMXUPD EQU   ICTMACF4                                                 03497000
ICTMFXC  EQU   ICTMACF4                                                 03498000
ICTMFXBS EQU   ICTMACF4                                                 03499000
ICTMHASM EQU   ICTMACF4                                                 03500000
ICTMACDL EQU   ICTMACF4                                                 03501000
@NM00207 EQU   ICTMLEP4                                                 03502000
@NM00206 EQU   ICTMLEP3                                                 03503000
@NM00205 EQU   ICTMLEP2                                                 03504000
ICTMPAGA EQU   ICTMLEP2                                                 03505000
ICTMNE   EQU   ICTMLEP2                                                 03506000
@NM00204 EQU   ICTMLEP1                                                 03507000
ICTMDC   EQU   ICTMLEP1                                                 03508000
ICTMREFR EQU   ICTMLEP1                                                 03509000
ICTMOVLY EQU   ICTMLEP1                                                 03510000
ICTMSCTR EQU   ICTMLEP1                                                 03511000
ICTMREUS EQU   ICTMLEP1                                                 03512000
ICTMRENT EQU   ICTMLEP1                                                 03513000
ICTMAPF  EQU   ICTMLEP1                                                 03514000
@NM00203 EQU   ICTMFLG5                                                 03515000
ICTMNORL EQU   ICTMFLG5                                                 03516000
ICTMELCK EQU   ICTMFLG5                                                 03517000
ICTMCOPY EQU   ICTMFLG5                                                 03518000
ICTMPASS EQU   ICTMFLG5                                                 03519000
@NM00202 EQU   ICTMFLG4                                                 03520000
ICTMTSEL EQU   ICTMFLG4                                                 03521000
ICTMDSTE EQU   ICTMFLG4                                                 03522000
ICTMMIDE EQU   ICTMFLG4                                                 03523000
ICTMASOC EQU   ICTMFLG4                                                 03524000
ICTMSELM EQU   ICTMFLG4                                                 03525000
ICTMIDEL EQU   ICTMFLG4                                                 03526000
@NM00201 EQU   ICTMFLG3                                                 03527000
ICTMPRMS EQU   ICTMFLG3                                                 03528000
ICTMWRK  EQU   ICTMFLG3                                                 03529000
ICTMRELF EQU   ICTMFLG3                                                 03530000
ICTLIBTX EQU   ICTMFLG3                                                 03531000
ICTLIBLK EQU   ICTMFLG3                                                 03532000
ICTMSRCU EQU   ICTMFLG1                                                 03533000
ICTMSRCR EQU   ICTMFLG1                                                 03534000
ICTMMACU EQU   ICTMFLG1                                                 03535000
ICTMMACR EQU   ICTMFLG1                                                 03536000
ICTMZAP  EQU   ICTMFLG1                                                 03537000
ICTMASM  EQU   ICTMMODR                                                 03538000
@NM00200 EQU   ICTMFLG2                                                 03539000
@NM00199 EQU   ICTMFLG2                                                 03540000
ICTMMIDU EQU   ICTMFLG2                                                 03541000
ICTMDEL  EQU   ICTMFLG2                                                 03542000
ICTMMSG  EQU   ICTMFLG2                                                 03543000
ICTMNOGO EQU   ICTMFLG2                                                 03544000
ICTMEND  EQU   ICTMNAME                                                 03545000
@NM00198 EQU   ICTSBYNT+7                                               03546000
ICTSBYND EQU   ICTSBYNM                                                 03547000
ICTDELEX EQU   ICTDELST                                                 03548000
ICTDELND EQU   ICTDELNM                                                 03549000
@NM00197 EQU   ICTVRSNT+7                                               03550000
ICTVRSND EQU   ICTVRSNM                                                 03551000
@NM00196 EQU   ICTNPRNT+7                                               03552000
ICTNPRND EQU   ICTNPRNM                                                 03553000
@NM00195 EQU   ICTCSRST                                                 03554000
@NM00194 EQU   ICTCSRST                                                 03555000
ICTCSRF  EQU   ICTCSRST                                                 03556000
@NM00193 EQU   ICTCSRST                                                 03557000
ICTCSRNM EQU   ICTIRQNT+8                                               03558000
@NM00192 EQU   ICTIRQST                                                 03559000
ICTIREQT EQU   ICTIRQST                                                 03560000
ICTIREQI EQU   ICTIRQST                                                 03561000
ICTIREQB EQU   ICTIRQST                                                 03562000
ICTIREQS EQU   ICTIRQST                                                 03563000
@NM00191 EQU   ICTIRQST                                                 03564000
ICTIRQND EQU   ICTIRQNM                                                 03565000
@NM00190 EQU   ICTPREST                                                 03566000
ICTPREQT EQU   ICTPREST                                                 03567000
ICTPREQI EQU   ICTPREST                                                 03568000
ICTPREQB EQU   ICTPREST                                                 03569000
ICTPREQS EQU   ICTPREST                                                 03570000
@NM00189 EQU   ICTPREST                                                 03571000
ICTPREND EQU   ICTPRENM                                                 03572000
@NM00188 EQU   ICTSUPNT+7                                               03573000
ICTSUPND EQU   ICTSUPNM                                                 03574000
@NM00187 EQU   ICTREQST                                                 03575000
ICTRREQT EQU   ICTREQST                                                 03576000
ICTRREQI EQU   ICTREQST                                                 03577000
ICTRREQB EQU   ICTREQST                                                 03578000
ICTRREQS EQU   ICTREQST                                                 03579000
@NM00186 EQU   ICTREQST                                                 03580000
ICTREQND EQU   ICTREQNM                                                 03581000
@NM00185 EQU   ICTENTST                                                 03582000
ICTEREQT EQU   ICTENTST                                                 03583000
ICTEREQI EQU   ICTENTST                                                 03584000
ICTEREQB EQU   ICTENTST                                                 03585000
ICTEREQS EQU   ICTENTST                                                 03586000
@NM00184 EQU   ICTENTST                                                 03587000
ICTENTND EQU   ICTENTNM                                                 03588000
ICTIXP   EQU   ICTIXPF                                                  03589000
@NM00183 EQU   ICTPTF+100                                               03590000
ICTPTPFX EQU   ICTPTF+38                                                03591000
ICTPRELN EQU   ICTPTF+36                                                03592000
ICTPRECT EQU   ICTPTF+33                                                03593000
ICTPRECD EQU   ICTPTF+30                                                03594000
ICTPVERN EQU   ICTPTF+29                                                03595000
ICTPFMID EQU   ICTPTF+22                                                03596000
ICTPSUPN EQU   ICTPTF+20                                                03597000
ICTPONUM EQU   ICTPTF+18                                                03598000
ICTPTYPE EQU   ICTPTF+17                                                03599000
ICTPUSR8 EQU   ICTPFLGA                                                 03600000
ICTPUSR7 EQU   ICTPFLGA                                                 03601000
ICTPUSR6 EQU   ICTPFLGA                                                 03602000
ICTPUSR5 EQU   ICTPFLGA                                                 03603000
ICTPUSR4 EQU   ICTPFLGA                                                 03604000
ICTPUSR3 EQU   ICTPFLGA                                                 03605000
ICTPUSR2 EQU   ICTPFLGA                                                 03606000
ICTPPASS EQU   ICTPUSR1                                                 03607000
@NM00182 EQU   @NM00181                                                 03608000
ICTPRQBY EQU   @NM00181                                                 03609000
ICTPRQOK EQU   @NM00181                                                 03610000
ICTPRQCK EQU   @NM00181                                                 03611000
@NM00180 EQU   ICTPFLG9                                                 03612000
ICTPPDEL EQU   ICTPFLG9                                                 03613000
ICTPWRKO EQU   ICTPFLG9                                                 03614000
ICTPMSL  EQU   ICTPFLG9                                                 03615000
@NM00179 EQU   ICTPFLG8                                                 03616000
ICTPDCPL EQU   ICTPFLG8                                                 03617000
ICTPECPL EQU   ICTPFLG8                                                 03618000
ICTPGCPL EQU   ICTPFLG8                                                 03619000
@NM00178 EQU   ICTPFLG4                                                 03620000
@NM00177 EQU   ICTPFLG4                                                 03621000
@NM00176 EQU   ICTPFLG4                                                 03622000
ICTPGELM EQU   ICTPFLG4                                                 03623000
ICTPDIMP EQU   ICTPFLG4                                                 03624000
ICTPDEXP EQU   ICTPFLG4                                                 03625000
ICTPREDO EQU   ICTPFLG4                                                 03626000
ICTPCDSE EQU   ICTPFLG4                                                 03627000
@NM00175 EQU   ICTPFLG2                                                 03628000
ICTPRCND EQU   ICTPFLG2                                                 03629000
ICTPTPS  EQU   ICTPFLG2                                                 03630000
ICTPTR1  EQU   ICTPFLG2                                                 03631000
ICTPVRSP EQU   ICTPFLG2                                                 03632000
@NM00174 EQU   ICTPFLG6                                                 03633000
ICTFLF   EQU   ICTPFLF                                                  03634000
ICTPDBYP EQU   ICTPFLG6                                                 03635000
ICTPSBYP EQU   ICTPFLG6                                                 03636000
ICTPMDLP EQU   ICTPFLG5+1                                               03637000
ICTPADDP EQU   ICTPFLG5+1                                               03638000
@NM00173 EQU   ICTPFLG5+1                                               03639000
ICTPLRFP EQU   ICTPFLG5                                                 03640000
ICTPJCLP EQU   ICTPFLG5                                                 03641000
ICTPSUPP EQU   ICTPFLG5                                                 03642000
ICTPREQP EQU   ICTPFLG5                                                 03643000
ICTPPREP EQU   ICTPFLG5                                                 03644000
ICTPNPRP EQU   ICTPFLG5                                                 03645000
ICTPIRQP EQU   ICTPFLG5                                                 03646000
ICTPDELP EQU   ICTPFLG5                                                 03647000
@NM00172 EQU   ICTPFLG3                                                 03648000
ICTPSLST EQU   ICTPFLG3                                                 03649000
ICTPNOLB EQU   ICTPFLG3                                                 03650000
ICTPVERJ EQU   ICTPFLG3                                                 03651000
ICTPMSG  EQU   ICTPFLG3                                                 03652000
ICTPCPL  EQU   ICTPFLG3                                                 03653000
ICTPNOGO EQU   ICTPFLG3                                                 03654000
ICTREGEN EQU   ICTPFLG1                                                 03655000
ICTBYP   EQU   ICTPFLG1                                                 03656000
ICTDUMMP EQU   ICTPFLG1                                                 03657000
@NM00171 EQU   ICTPFLG1                                                 03658000
ICTERROR EQU   ICTPFLG1                                                 03659000
ICTACC   EQU   ICTPFLG1                                                 03660000
ICTRES   EQU   ICTPFLG1                                                 03661000
ICTAPP   EQU   ICTPFLG1                                                 03662000
ICTPEND  EQU   ICTPTFS                                                  03663000
ICTLEN   EQU   ICTGMSPL+1                                               03664000
ICTSP    EQU   ICTGMSPL                                                 03665000
ICTLLEN  EQU   ICTLSPLN+1                                               03666000
ICTLSP   EQU   ICTLSPLN                                                 03667000
ICTMLEN  EQU   ICTMSPLN+1                                               03668000
ICTMSP   EQU   ICTMSPLN                                                 03669000
ICTPLEN  EQU   ICTPSPLN+1                                               03670000
ICTPSP   EQU   ICTPSPLN                                                 03671000
IOPBS04E EQU   IOPBS04+2                                                03672000
IOPBAPFC EQU   IOPBAPF+1                                                03673000
IOPBAPFL EQU   IOPBAPF                                                  03674000
IOPBS2NM EQU   IOPBS02+3                                                03675000
IOPBS2EP EQU   IOPBS02                                                  03676000
IOPQSMTP EQU   IOPQSMLS+8                                               03677000
@NM00156 EQU   IOPQSMLS+7                                               03678000
IOPQSMND EQU   IOPQSMNM                                                 03679000
@NM00155 EQU   @NM00154+7                                               03680000
IOPQSMFM EQU   @NM00154                                                 03681000
@NM00074 EQU   IOPLMCTL+17                                              03682000
IOPLMCRD EQU   IOPLMCTL+9                                               03683000
IOPLMCRN EQU   IOPLMCTL+1                                               03684000
IOPLMCC  EQU   IOPLMCTL                                                 03685000
@NM00049 EQU   IOPUSERL                                                 03686000
@NM00048 EQU   IOPUSERL                                                 03687000
IOPALIS  EQU   IOPUSERL                                                 03688000
IOPINAM2 EQU   IOPINAM+1                                                03689000
IOPITYP2 EQU   IOPITYP                                                  03690000
@NM00047 EQU   HMASMIOP+32                                              03691000
IOPDELDD EQU   IOPDDNAM                                                 03692000
@NM00046 EQU   @NM00043+10                                              03693000
IOPSEQNO EQU   @NM00043+8                                               03694000
@NM00045 EQU   @NM00044+7                                               03695000
IOPPTFNM EQU   @NM00044                                                 03696000
IOPNAM17 EQU   IOPNAME                                                  03697000
CCABMREC EQU   CCABELMT+10                                              03698000
CCABPOS  EQU   CCABMPOS+8                                               03699000
CCABNAME EQU   CCABMPOS                                                 03700000
@NM00042 EQU   CCABLDLM+2                                               03701000
@NM00041 EQU   CCABLDLM                                                 03702000
CCAUPDPM EQU   @NM00039+24                                              03703000
@NM00040 EQU   @NM00039+21                                              03704000
CCARUPDT EQU   CCAUPDRC                                                 03705000
CCAUPDSP EQU   @NM00039+12                                              03706000
CCAUPDTE EQU   @NM00039+8                                               03707000
CCAUPDNM EQU   @NM00039                                                 03708000
CCASUPPM EQU   @NM00037+24                                              03709000
@NM00038 EQU   @NM00037+21                                              03710000
CCARSUP  EQU   CCASUPRC                                                 03711000
CCASUPSP EQU   @NM00037+12                                              03712000
CCAIOSUP EQU   @NM00037+8                                               03713000
CCASUPNM EQU   @NM00037                                                 03714000
CCAZAPPM EQU   @NM00035+24                                              03715000
@NM00036 EQU   @NM00035+21                                              03716000
CCARZAP  EQU   CCAZAPRC                                                 03717000
CCAZAPSP EQU   @NM00035+12                                              03718000
CCASPZAP EQU   @NM00035+8                                               03719000
CCAZAPNM EQU   @NM00035                                                 03720000
CCACOMPM EQU   @NM00033+24                                              03721000
@NM00034 EQU   @NM00033+21                                              03722000
CCARCOMP EQU   CCACOMRC                                                 03723000
CCACOMSP EQU   @NM00033+12                                              03724000
CCACOMRS EQU   @NM00033+8                                               03725000
CCACOMNM EQU   @NM00033                                                 03726000
CCACPYPM EQU   @NM00031+24                                              03727000
@NM00032 EQU   @NM00031+21                                              03728000
CCARCOPY EQU   CCACPYRC                                                 03729000
CCACPYSP EQU   @NM00031+12                                              03730000
CCACOPY  EQU   @NM00031+8                                               03731000
CCACPYNM EQU   @NM00031                                                 03732000
CCAASMPM EQU   @NM00029+24                                              03733000
@NM00030 EQU   @NM00029+21                                              03734000
CCARASM  EQU   CCAASMRC                                                 03735000
CCAASMSP EQU   @NM00029+12                                              03736000
CCAASM   EQU   @NM00029+8                                               03737000
CCAASMNM EQU   @NM00029                                                 03738000
@NM00028 EQU   @NM00027+21                                              03739000
CCAPGMPM EQU   @NM00025+24                                              03740000
@NM00026 EQU   @NM00025+21                                              03741000
CCABPGRC EQU   @NM00025+20                                              03742000
CCABPGSP EQU   @NM00025+12                                              03743000
CCABPGAD EQU   @NM00025+8                                               03744000
CCABPGNM EQU   @NM00025                                                 03745000
CCAEND   EQU   HMASMCCA+371                                             03746000
@NM00024 EQU   HMASMCCA+309                                             03747000
CCACURDD EQU   CCAFDSNG+3                                               03748000
CCACURDS EQU   CCAFDSNG+2                                               03749000
@NM00023 EQU   CCAFLAGB                                                 03750000
CCAOUTNG EQU   CCAFLAGB                                                 03751000
CCALOGNG EQU   CCAFLAGB                                                 03752000
CCAFMID  EQU   HMASMCCA+291                                             03753000
CCALSTDS EQU   CCAFCTL+8                                                03754000
CCARPTDS EQU   CCAFCTL+7                                                03755000
CCATIME  EQU   CCAFCTL+4                                                03756000
CCADATE  EQU   CCAFCTL+1                                                03757000
@NM00022 EQU   CCAFLAG9                                                 03758000
CCARVCAN EQU   CCAFLAG9                                                 03759000
CCARVEST EQU   CCAFLAG9                                                 03760000
CCAPTSNJ EQU   CCAFLAG9                                                 03761000
CCASTSNP EQU   CCAFLAG9                                                 03762000
CCAMTSNP EQU   CCAFLAG9                                                 03763000
CCAPTSNP EQU   CCAFLAG9                                                 03764000
@NM00021 EQU   CCAFLAG8                                                 03765000
CCAACDSC EQU   CCAFLAG8                                                 03766000
CCACDSC  EQU   CCAFLAG8                                                 03767000
@NM00020 EQU   CCAFLAG6                                                 03768000
CCAACRUP EQU   CCAFLAG6                                                 03769000
CCACRQUP EQU   CCAFLAG6                                                 03770000
CCAACDUP EQU   CCAFLAG6                                                 03771000
CCACDSUP EQU   CCAFLAG6                                                 03772000
@NM00019 EQU   CCAFLAG5                                                 03773000
CCAACROS EQU   CCAFLAG5                                                 03774000
CCACRQOS EQU   CCAFLAG5                                                 03775000
CCAACDOS EQU   CCAFLAG5                                                 03776000
CCACDSOS EQU   CCAFLAG5                                                 03777000
@NM00018 EQU   CCAFLAG4                                                 03778000
CCAACRIS EQU   CCAFLAG4                                                 03779000
CCACRQIS EQU   CCAFLAG4                                                 03780000
CCAACDIS EQU   CCAFLAG4                                                 03781000
CCACDSIS EQU   CCAFLAG4                                                 03782000
@NM00017 EQU   CCAFLAG3+1                                               03783000
CCARGNP  EQU   CCAFLAG3+1                                               03784000
CCADISRQ EQU   CCAFLAG3+1                                               03785000
CCAICTOK EQU   CCAFLAG3                                                 03786000
CCADELP  EQU   CCAFLAG3                                                 03787000
CCACMPRS EQU   CCAFLAG3                                                 03788000
CCAZAPP  EQU   CCAFLAG3                                                 03789000
CCALINKP EQU   CCAFLAG3                                                 03790000
CCACOPYP EQU   CCAFLAG3                                                 03791000
CCAASIP  EQU   CCAFLAG3                                                 03792000
CCAUPDP  EQU   CCAFLAG3                                                 03793000
CCAEOSMP EQU   CCAFLAG2                                                 03794000
CCAEOFNC EQU   CCAFLAG2                                                 03795000
@NM00016 EQU   CCAFLAG2                                                 03796000
CCACHECK EQU   CCAFLAG2                                                 03797000
CCATERM  EQU   CCAFLAG2                                                 03798000
CCASVCLB EQU   CCAFLAG2                                                 03799000
CCANCPTF EQU   CCAFLAG2                                                 03800000
@NM00015 EQU   CCAFLAG1+1                                               03801000
CCAUNL   EQU   CCAFLAG1+1                                               03802000
CCARESET EQU   CCAFLAG1+1                                               03803000
CCALOG   EQU   CCAFLAG1+1                                               03804000
CCACNV   EQU   CCAFLAG1+1                                               03805000
CCALIST  EQU   CCAFLAG1                                                 03806000
CCAUPDU  EQU   CCAFLAG1                                                 03807000
CCAUPDJ  EQU   CCAFLAG1                                                 03808000
CCARES   EQU   CCAFLAG1                                                 03809000
CCAREJ   EQU   CCAFLAG1                                                 03810000
CCAAPPLY EQU   CCAFLAG1                                                 03811000
CCAREC   EQU   CCAFLAG1                                                 03812000
CCAFUNCT EQU   CCAFFUNC                                                 03813000
@NM00014 EQU   @NM00009+18                                              03814000
@NM00013 EQU   @NM00009+16                                              03815000
CCATBLPA EQU   @NM00009+12                                              03816000
@NM00012 EQU   @NM00009+8                                               03817000
@NM00011 EQU   @NM00009+4                                               03818000
@NM00010 EQU   @NM00009                                                 03819000
CCAIFGTP EQU   CCAFGTP+16                                               03820000
CCAGTP3  EQU   CCAFGTP+12                                               03821000
CCAGTP2  EQU   CCAFGTP+8                                                03822000
CCAGTP1  EQU   CCAFGTP+4                                                03823000
CCASETAD EQU   CCASEGTP                                                 03824000
CCACLST  EQU   CCAFPGM+12                                               03825000
CCASPDCB EQU   CCAFPGM+8                                                03826000
CCAACDID EQU   CCAFSYS+32                                               03827000
CCACDSID EQU   CCAFSYS+24                                               03828000
CCALNLEN EQU   CCAFSYS+22                                               03829000
@NM00008 EQU   CCAFLAGA                                                 03830000
CCAPSYSF EQU   CCAFLAGA                                                 03831000
CCAASYSF EQU   CCAFLAGA                                                 03832000
CCACSYSF EQU   CCAFLAGA                                                 03833000
CCANUCID EQU   CCAFSYS+20                                               03834000
CCAASREL EQU   CCAFSYS+16                                               03835000
CCACSREL EQU   CCASREL                                                  03836000
CCAPEMAX EQU   CCAFSYS+10                                               03837000
CCAPGLEN EQU   CCAFSYS+8                                                03838000
CCAIOPAS EQU   CCAFSYS+4                                                03839000
CCAIOPCS EQU   CCAFSYS                                                  03840000
CCAPESIZ EQU   CCAFIOP+4                                                03841000
@NM00007 EQU   CCAFLAG7+3                                               03842000
CCALOGP  EQU   CCAFLAG7+2                                               03843000
CCAOUTP  EQU   CCAFLAG7+2                                               03844000
CCASLBP  EQU   CCAFLAG7+2                                               03845000
CCARPTP  EQU   CCAFLAG7+2                                               03846000
CCALISTP EQU   CCAFLAG7+2                                               03847000
CCAJCLP  EQU   CCAFLAG7+2                                               03848000
CCAPTFP  EQU   CCAFLAG7+2                                               03849000
CCATLBP  EQU   CCAFLAG7+2                                               03850000
CCAUT3P  EQU   CCAFLAG7+1                                               03851000
CCAUT2P  EQU   CCAFLAG7+1                                               03852000
CCAUT1P  EQU   CCAFLAG7+1                                               03853000
CCAWK5P  EQU   CCAFLAG7+1                                               03854000
CCAWK4P  EQU   CCAFLAG7+1                                               03855000
CCAWK3P  EQU   CCAFLAG7+1                                               03856000
CCAWK2P  EQU   CCAFLAG7+1                                               03857000
CCAWK1P  EQU   CCAFLAG7+1                                               03858000
CCAACRQP EQU   CCAFLAG7                                                 03859000
CCACRQP  EQU   CCAFLAG7                                                 03860000
CCASTSP  EQU   CCAFLAG7                                                 03861000
CCAMTSP  EQU   CCAFLAG7                                                 03862000
CCAPTSP  EQU   CCAFLAG7                                                 03863000
CCASCDSP EQU   CCAFLAG7                                                 03864000
CCAACDSP EQU   CCAFLAG7                                                 03865000
CCACDSP  EQU   CCAFLAG7                                                 03866000
@NM00006 EQU   CCAFBUFR+122                                             03867000
@NM00005 EQU   CCAFBUFR+120                                             03868000
@NM00004 EQU   CCAFBUFR+118                                             03869000
CCATBFMX EQU   CCAFBUFR+116                                             03870000
CCA4BFMX EQU   CCAFBUFR+114                                             03871000
CCA3BFMX EQU   CCAFBUFR+112                                             03872000
CCA2BFMX EQU   CCAFBUFR+110                                             03873000
CCA1BFMX EQU   CCAFBUFR+108                                             03874000
CCAXBFMX EQU   CCAFBUFR+106                                             03875000
CCAQBFMX EQU   CCAFBUFR+104                                             03876000
CCASBFMX EQU   CCAFBUFR+102                                             03877000
CCAMBFMX EQU   CCAFBUFR+100                                             03878000
CCAPBFMX EQU   CCAFBUFR+98                                              03879000
CCAVBFMX EQU   CCAFBUFR+96                                              03880000
CCAABFMX EQU   CCAFBUFR+94                                              03881000
CCACBFMX EQU   CCAFBUFR+92                                              03882000
@NM00003 EQU   CCAFBUFR+88                                              03883000
@NM00002 EQU   CCAFBUFR+84                                              03884000
CCA4BFSZ EQU   CCAFBUFR+80                                              03885000
CCATBFSZ EQU   CCAFBUFR+76                                              03886000
CCAWBFSZ EQU   CCAFBUFR+72                                              03887000
CCAQBFSZ EQU   CCAFBUFR+68                                              03888000
CCAPBFSZ EQU   CCAFBUFR+64                                              03889000
CCAVBFSZ EQU   CCAFBUFR+60                                              03890000
CCACBFSZ EQU   CCAFBUFR+56                                              03891000
@NM00001 EQU   CCAFBUFR+52                                              03892000
CCA4BFOA EQU   CCAFBUFR+48                                              03893000
CCA4BFIA EQU   CCAFBUFR+44                                              03894000
CCATBFIA EQU   CCAFBUFR+40                                              03895000
CCAWBFOA EQU   CCAFBUFR+36                                              03896000
CCAWBFIA EQU   CCAFBUFR+32                                              03897000
CCAQBFOA EQU   CCAFBUFR+28                                              03898000
CCAQBFIA EQU   CCAFBUFR+24                                              03899000
CCAPBFOA EQU   CCAFBUFR+20                                              03900000
CCAPBFIA EQU   CCAFBUFR+16                                              03901000
CCAVBFOA EQU   CCAFBUFR+12                                              03902000
CCAVBFIA EQU   CCAFBUFR+8                                               03903000
CCACBFOA EQU   CCAFBUFR+4                                               03904000
CCACBFIA EQU   CCAFBUFR                                                 03905000
CCAID    EQU   HMASMCCA                                                 03906000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      03907000
@RT00329 EQU   CKBLK                                                    03908000
@RT00340 EQU   SCAN                                                     03909000
@RF00340 EQU   CKBLK                                                    03910000
@RF00464 EQU   @EL00004                                                 03911000
@RT00489 EQU   @EL00005                                                 03912000
@RT00501 EQU   @EL00005                                                 03913000
@RT00512 EQU   @EL00005                                                 03914000
@RT00525 EQU   @EL00005                                                 03915000
@RC00586 EQU   @EL00007                                                 03916000
@RC00596 EQU   @EL00007                                                 03917000
@RF00613 EQU   @EL00008                                                 03918000
@RF00624 EQU   @EL00009                                                 03919000
@RT00635 EQU   @EL00010                                                 03920000
@RF00657 EQU   @EL00011                                                 03921000
@ENDDATA EQU   *                                                        03922000
         END   HMASMLKI,(C'PLS2047',0802,78334)                         03923000
