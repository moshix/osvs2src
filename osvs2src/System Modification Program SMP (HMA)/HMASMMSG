         TITLE 'HMASMMSG - SMP MESSAGE MODULE'                          00001000
HMASMMSG CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'HMASMMSG  78.334'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00009000
         BALR  @12,0                                               0001 00010000
@PSTART  DS    0H                                                  0001 00011000
         USING @PSTART,@12                                         0001 00012000
         MVC   @PC00001(4),0(@01)                                  0001 00013000
         EJECT                                                          00014000
*                                                                  0185 00015000
*   /*****************************************************************/ 00016000
*   /*                                                               */ 00017000
*   /* CHECK FOR RE-ENTRY AND ADJUST SAVE AREAS                      */ 00018000
*   /*                                                               */ 00019000
*   /*****************************************************************/ 00020000
*                                                                  0185 00021000
*   IF ENTERED=ON                   /* IS THIS SECOND ENTRY?         */ 00022000
*     THEN                          /* YES - CHECK FURTHER FOR       */ 00023000
         TM    ENTERED,B'10000000'                                 0185 00024000
         BNO   @RF00185                                            0185 00025000
*     DO;                           /* THIRD ENTRY                   */ 00026000
*       IF REENTERD=ON              /* IF THIRD ENTRY,               */ 00027000
*         THEN                      /* EXIT TO CALLER                */ 00028000
         TM    REENTERD,B'01000000'                                0187 00029000
         BO    @RT00187                                            0187 00030000
*         RETURN;                   /* RETURN                        */ 00031000
*       REENTERD=ON;                /* INDICATE RE-ENTERED           */ 00032000
         OI    REENTERD,B'01000000'                                0189 00033000
*       R1=ADDR(SVAREA2);           /* POINT TO RE-ENTRY SAVE AREA   */ 00034000
         LA    R1,SVAREA2                                          0190 00035000
*     END;                                                         0191 00036000
*   ELSE                            /* OTHERWISE - USE PRIMARY SV    */ 00037000
*     DO;                                                          0192 00038000
         B     @RC00185                                            0192 00039000
@RF00185 DS    0H                                                  0193 00040000
*       R1=ADDR(SVAREA1);           /* POINT TO PRIME SAVE AREA      */ 00041000
         LA    R1,SVAREA1                                          0193 00042000
*       ENTERED=ON;                 /* INDICATE PRIMARY ENTRY        */ 00043000
         OI    ENTERED,B'10000000'                                 0194 00044000
*     END;                                                         0195 00045000
*   SVBACK=R13;                     /* CHAIN BACKWARD                */ 00046000
@RC00185 ST    R13,SVBACK(,R1)                                     0196 00047000
*   RFY                                                            0197 00048000
*     SVMAP BASED(R13);                                            0197 00049000
*   SVFWRD=R1;                      /* CHAIN FORWARD                 */ 00050000
         ST    R1,SVFWRD(,R13)                                     0198 00051000
*   R13=R1;                         /* SET UP NEW SAVE AREA          */ 00052000
         LR    R13,R1                                              0199 00053000
*   RFY                                                            0200 00054000
*     R1 UNRSTD;                                                   0200 00055000
*                                                                  0200 00056000
*   /*****************************************************************/ 00057000
*   /*                                                               */ 00058000
*   /* INITIALIZATION AND PARM(HMASMMGP) SAVE                @SA75296*/ 00059000
*   /*                                                               */ 00060000
*   /*****************************************************************/ 00061000
*                                                                  0201 00062000
*   IOPPTR=ADDR(IOP);               /* SET PTR TO IOP                */ 00063000
         LA    IOPPTR,IOP                                          0201 00064000
*   IOPBUFAD=ADDR(PRL);             /* SET PTR IN IOP TO PRL         */ 00065000
         LA    @10,PRL                                             0202 00066000
         ST    @10,IOPBUFAD(,IOPPTR)                               0202 00067000
*   IOPFUNCT=IOPWRITE;              /* INITIALIZE 'WRITE' OPERATION  */ 00068000
         MVI   IOPFUNCT(IOPPTR),X'51'                              0203 00069000
*   PRLFLGS=ZERO;                   /* CLEAR FLAGS IN PRL            */ 00070000
         MVI   PRLFLGS(@10),X'00'                                  0204 00071000
*   MSGRTNCD=ZERO;                  /* SET GOOD RETURN CODE  @Z67SP00*/ 00072000
         SLR   MSGRTNCD,MSGRTNCD                                   0205 00073000
*   IF REENTERD=ON                  /* SECOND ENTRY?         @SA75296*/ 00074000
*     THEN                          /* YES                   @SA75296*/ 00075000
         TM    REENTERD,B'01000000'                                0206 00076000
         BNO   @RF00206                                            0206 00077000
*     SAVMGP2=HMASMMGP;             /* SAVE MGP PARM         @ZD00001*/ 00078000
         L     @10,@PC00001                                        0207 00079000
         MVC   SAVMGP2(12),HMASMMGP(@10)                           0207 00080000
*   ELSE                            /* MUST BE FIRST ENTRY   @SA75296*/ 00081000
*     SAVMGP1=HMASMMGP;             /* SAVE MGP PARM         @ZD00001*/ 00082000
         B     @RC00206                                            0208 00083000
@RF00206 L     @10,@PC00001                                        0208 00084000
         MVC   SAVMGP1(12),HMASMMGP(@10)                           0208 00085000
         EJECT                                                          00086000
         EJECT                                                          00087000
*                                                                  0209 00088000
*   /*****************************************************************/ 00089000
*   /*                                                               */ 00090000
*   /* USING THE VAULES IN THE MGPMGNOX VARIABLES AS INDICIES INTO   */ 00091000
*   /* EITHER THE PRIMARY MESSAGE NUMBER LIST(FOR MGPMGNO1) OR INTO  */ 00092000
*   /* THE SECONDARY AND TERCIARY MESSAGE NUMBER LIST(FOR MGPMGNO2   */ 00093000
*   /* AND MGPMGNO3) BUILD THE CONCATENATED MESSAGE IN A BUFFER AREA */ 00094000
*   /* WHEN ONE OF THE MGPMGNOX IS A ZERO THEN THAT INDICATES THAT   */ 00095000
*   /* THERE ARE NO MORE PARTS TO BE CONCATENATED. FOR THE FIRST PART*/ 00096000
*   /* THE EXTERNAL MESSAGE NUMBER IS PLACED IN THE FIRSTS BUFFER    */ 00097000
*   /* POSITIONS. THE EXTERNAL NUMBER IS ONE LESS THAT THE NUMBER IN */ 00098000
*   /* MGPMGNO1(EX. MGPMGNO1=34, EXTERNAL MESSAGE NUMBER = HMA233I). */ 00099000
*   /*                                                       @Z67SP00*/ 00100000
*   /*                                                               */ 00101000
*   /*****************************************************************/ 00102000
*                                                                  0209 00103000
*   DO I=1 TO DIM(MSGNDX) WHILE(    /* PUT TOGETHER MSG      @Z67SP00*/ 00104000
*         MSGNDX(I)^=ZERO           /* ALL SPEC. MSG PARTS   @Z67SP00*/ 00105000
*         &MSGRTNCD<LONGMSG);       /* TILL END OR ERR       @Z67SP00*/ 00106000
@RC00206 LA    I,1                                                 0209 00107000
@DL00209 LR    @10,I                                               0209 00108000
         ALR   @10,@10                                             0209 00109000
         L     @08,@PC00001                                        0209 00110000
         BCTR  @10,0                                               0209 00111000
         BCTR  @10,0                                               0209 00112000
         LH    @10,MSGNDX(@10,@08)                                 0209 00113000
         LTR   @10,@10                                             0209 00114000
         BZ    @DC00209                                            0209 00115000
         CH    MSGRTNCD,@CH00054                                   0209 00116000
         BNL   @DC00209                                            0209 00117000
*     IF I=1 THEN                   /* INITIALIZE BUFFER IF FIRST MSG   00118000
*                                      SECTION                       */ 00119000
         CH    I,@CH00044                                          0210 00120000
         BNE   @RF00210                                            0210 00121000
*       DO;                                                        0211 00122000
*         MSGPTR=DC1PMSG(MSGNDX(I));/* ADDR OF PRIM MSG      @Z67SP00*/ 00123000
         SLA   @10,2                                               0212 00124000
         L     @15,@CA01347                                        0212 00125000
         AL    @15,@CF01363                                        0212 00126000
         L     MSGPTR,DC1PMSG-DC1PMSG(@10,@15)                     0212 00127000
*         MSGHDR=SYSMSGNO;          /* MOVE IN CONSTANT      @ZD00001*/ 00128000
         L     @10,IOPBUFAD(,IOPPTR)                               0213 00129000
         MVC   MSGHDR(11,@10),SYSMSGNO                             0213 00130000
*         MSGHDRSV=SEVERITY(MGPTYPE);/* APPEND SPECIFIED SEVERITY TO    00131000
*                                      MSGID                 @Z67SP00*/ 00132000
         SLR   @01,@01                                             0214 00133000
         IC    @01,MGPTYPE(,@08)                                   0214 00134000
         LA    @15,SEVERITY-1(@01)                                 0214 00135000
         MVC   MSGHDRSV(1,@10),0(@15)                              0214 00136000
*         MSGNO=MGPMGNO1+PAD;       /* ADD PADDING FACTOR    @ZD00001*/ 00137000
         LA    MSGNO,199                                           0215 00138000
         AH    MSGNO,MGPMGNO1(,@08)                                0215 00139000
*         CVD(MSGNO,DECNO);         /* CONVERT MSG #         @ZD00001*/ 00140000
         CVD   MSGNO,@TS00001                                      0216 00141000
         MVC   DECNO(3),@TS00001+5                                 0216 00142000
*         UNPK(MSGHDRNO,DECNO);     /*                       @ZD00001*/ 00143000
         UNPK  MSGHDRNO(3,@10),DECNO(3)                            0217 00144000
*         MSGHDRZN=MSGHDRZN|ZONE;   /* REMOVE ZONE FROM NO.  @ZD00001*/ 00145000
         OI    MSGHDRZN(@10),C'0'                                  0218 00146000
*         IF MGPTYPE=MGPERR         /* IF ERR TYPE MSG       @Z67SP00*/ 00147000
*             |MGPTYPE=MGPSEV       /* OR SEVERE             @Z67SP00*/ 00148000
*             |MGPTYPE=MGPTERM      /* OR TERMINATING        @Z67SP00*/ 00149000
*           THEN                                                   0219 00150000
         CLI   MGPTYPE(@08),3                                      0219 00151000
         BE    @RT00219                                            0219 00152000
         CLI   MGPTYPE(@08),4                                      0219 00153000
         BE    @RT00219                                            0219 00154000
         CLI   MGPTYPE(@08),5                                      0219 00155000
         BNE   @RF00219                                            0219 00156000
@RT00219 DS    0H                                                  0220 00157000
*           MSGHDRHL=HILIMGP;       /* FLAG ERRORS WITH AST. @ZD00001*/ 00158000
         L     @10,IOPBUFAD(,IOPPTR)                               0220 00159000
         MVC   MSGHDRHL(2,@10),@CC01271                            0220 00160000
*         CURLEN=DATASTRT;          /* UPDATE LENGTH         @SA75296*/ 00161000
@RF00219 MVI   CURLEN,X'0C'                                        0221 00162000
*       END;                                                       0222 00163000
*     ELSE                                                         0223 00164000
*       MSGPTR=DC1SMSG(MSGNDX(I));  /* POINT TO SECONDARY    @Z67SP00*/ 00165000
         B     @RC00210                                            0223 00166000
@RF00210 LR    @10,I                                               0223 00167000
         ALR   @10,@10                                             0223 00168000
         L     @08,@PC00001                                        0223 00169000
         BCTR  @08,0                                               0223 00170000
         BCTR  @08,0                                               0223 00171000
         LH    @10,MSGNDX(@10,@08)                                 0223 00172000
         SLA   @10,2                                               0223 00173000
         L     @08,@CA01348                                        0223 00174000
         AL    @08,@CF01363                                        0223 00175000
         L     MSGPTR,DC1SMSG-DC1SMSG(@10,@08)                     0223 00176000
*     IF CURLEN+MSGLEN-1>LOGLIM     /* CHECK IF TOO LONG     @SA75296*/ 00177000
*       THEN                        /*                       @Z67SP00*/ 00178000
@RC00210 SLR   @10,@10                                             0224 00179000
         IC    @10,CURLEN                                          0224 00180000
         SLR   @08,@08                                             0224 00181000
         IC    @08,MSGLEN(,MSGPTR)                                 0224 00182000
         ALR   @10,@08                                             0224 00183000
         BCTR  @10,0                                               0224 00184000
         CH    @10,@CH01247                                        0224 00185000
         BNH   @RF00224                                            0224 00186000
*       DO;                                                        0225 00187000
*         MSGRTNCD=LONGMSG;         /* SET RETURN CODE       @SA74329*/ 00188000
         LA    MSGRTNCD,8                                          0226 00189000
*       END;                                                       0227 00190000
*     ELSE                          /*                       @Z67SP00*/ 00191000
*       DO;                         /*                       @Z67SP00*/ 00192000
         B     @RC00224                                            0228 00193000
@RF00224 DS    0H                                                  0229 00194000
*         PRLDATA(CURLEN:CURLEN+MSGLEN-1)=MSGTEXT(1:MSGLEN);/* MOVE     00195000
*                                      MESSAGE SECTION       @SA75296*/ 00196000
         SLR   @10,@10                                             0229 00197000
         IC    @10,CURLEN                                          0229 00198000
         L     @08,IOPBUFAD(,IOPPTR)                               0229 00199000
         ALR   @10,@08                                             0229 00200000
         SLR   @07,@07                                             0229 00201000
         IC    @07,MSGLEN(,MSGPTR)                                 0229 00202000
         LR    @15,@07                                             0229 00203000
         BCTR  @15,0                                               0229 00204000
         EX    @15,@SM01364                                        0229 00205000
*         PRLDATA(CURLEN+MSGLEN)=BLANK;/* CLEAR BUFFER       @SA75296*/ 00206000
         SLR   @10,@10                                             0230 00207000
         IC    @10,CURLEN                                          0230 00208000
         ALR   @10,@07                                             0230 00209000
         ALR   @08,@10                                             0230 00210000
         MVI   PRLDATA-1(@08),C' '                                 0230 00211000
*         CURLEN=CURLEN+MSGLEN+1;   /* UPDATE CURRENT LENGTH @SA75296*/ 00212000
         LA    @10,1(,@10)                                         0231 00213000
         STC   @10,CURLEN                                          0231 00214000
*       END;                        /*                       @Z67SP00*/ 00215000
*   END;                                                           0233 00216000
@RC00224 AH    I,@CH00044                                          0233 00217000
         CH    I,@CH00056                                          0233 00218000
         BNH   @DL00209                                            0233 00219000
@DC00209 DS    0H                                                  0234 00220000
         EJECT                                                          00221000
*                                                                  0234 00222000
*   /*****************************************************************/ 00223000
*   /*                                                               */ 00224000
*   /* MESSAGE PARTS HAVE BEEN CONCATENATED. NOW SCAN THRU MESSAGE   */ 00225000
*   /* LOOKING FOR ANY REQUESTS FOR VARIABLE PARTS(INDICATED BY ONE  */ 00226000
*   /* OR MORE POUND SIGNS IN MESSAGE). EACH SET OF POUND SIGNS IS   */ 00227000
*   /* ONE VARIABLE PART. THE LENGTH OF THE POUND SIGN STRING IS     */ 00228000
*   /* DETERMINED THEN THAT MANY CHARACTERS FOR THE AREA POINTED TO  */ 00229000
*   /* BY THE APPROPRIATE MGPVARPT(X) IS MOVED INTO THE MESSAGE. X IS*/ 00230000
*   /* DETERMINED BY THE NUMBER OF GROUPS OF POUND SIGNS FOUND WITHIN*/ 00231000
*   /* THE MESSAGE                                           @Z67SP00*/ 00232000
*   /*                                                               */ 00233000
*   /*****************************************************************/ 00234000
*                                                                  0234 00235000
*   CURLEN=CURLEN-2;                /* INIT MAX LENGTH       @SA75296*/ 00236000
         SLR   @10,@10                                             0234 00237000
         IC    @10,CURLEN                                          0234 00238000
         BCTR  @10,0                                               0234 00239000
         BCTR  @10,0                                               0234 00240000
         STC   @10,CURLEN                                          0234 00241000
*   VARLEN=ZERO;                    /* INITIALIZE VARIBLE FIELD    0235 00242000
*                                      LENGTH                        */ 00243000
         SLR   VARLEN,VARLEN                                       0235 00244000
*   VARNDX=ONE;                     /* INITIALIZE VARIABLE FIELD   0236 00245000
*                                      INDEX                         */ 00246000
         LA    VARNDX,1                                            0236 00247000
*   DO I=DATASTRT TO CURLEN BY 1;   /* SCAN MESSAGE          @ZD00001*/ 00248000
         LA    I,12                                                0237 00249000
         B     @DE00237                                            0237 00250000
@DL00237 DS    0H                                                  0238 00251000
*     IF PRLDATA(I)=POUND THEN      /* SEARCH FOR #                  */ 00252000
         L     @10,IOPBUFAD(,IOPPTR)                               0238 00253000
         ALR   @10,I                                               0238 00254000
         CLI   PRLDATA-1(@10),C'#'                                 0238 00255000
         BNE   @RF00238                                            0238 00256000
*       DO;                                                        0239 00257000
*         VARLEN=VARLEN+1;          /* INCREMENT VAR FIELD LENGTH    */ 00258000
         LA    @10,1                                               0240 00259000
         ALR   VARLEN,@10                                          0240 00260000
*         IF I=CURLEN THEN          /* SAVE LENGTH LIMIT     @SA75296*/ 00261000
         SLR   @08,@08                                             0241 00262000
         IC    @08,CURLEN                                          0241 00263000
         CR    I,@08                                               0241 00264000
         BNE   @RF00241                                            0241 00265000
*           DO;                                                    0242 00266000
*             I=I+1;                /* UPDATE POINTER                */ 00267000
         ALR   I,@10                                               0243 00268000
*             GO TO FILLIN;         /* FILL IN CHARACTERS            */ 00269000
         B     FILLIN                                              0244 00270000
*           END;                                                   0245 00271000
*         ELSE                                                     0246 00272000
*           GO TO NEXTCHAR;         /* CONTINUE SCAN                 */ 00273000
*       END;                                                       0247 00274000
*     IF PRLDATA(I-1)=POUND THEN    /* END OF VARIABLE FIELD         */ 00275000
@RF00238 L     @10,IOPBUFAD(,IOPPTR)                               0248 00276000
         ALR   @10,I                                               0248 00277000
         CLI   PRLDATA-2(@10),C'#'                                 0248 00278000
         BNE   @RF00248                                            0248 00279000
*       DO;                                                        0249 00280000
*FILLIN:                            /* FILL IN VARIABLE FIELD        */ 00281000
*         VARSTART=I-VARLEN;        /* POINT TO START OF VAR FIELD   */ 00282000
FILLIN   LR    VARSTART,I                                          0250 00283000
         SLR   VARSTART,VARLEN                                     0250 00284000
*         PRLDATA(VARSTART:I-1)=VARSTRNG(1:VARLEN);/* MOVE VARIABLE     00285000
*                                      FIELD                         */ 00286000
         L     @10,IOPBUFAD(,IOPPTR)                               0251 00287000
         ALR   @10,VARSTART                                        0251 00288000
         LR    @15,I                                               0251 00289000
         SLR   @15,VARSTART                                        0251 00290000
         BCTR  @15,0                                               0251 00291000
         LR    @14,VARNDX                                          0251 00292000
         SLA   @14,2                                               0251 00293000
         L     @03,@PC00001                                        0251 00294000
         L     @01,MGPVARPT-4(@14,@03)                             0251 00295000
         EX    @15,@SM01366                                        0251 00296000
*         VARNDX=VARNDX+1;          /* INCREMENT TO NEXT VAR FIELD   */ 00297000
         LA    VARNDX,1(,VARNDX)                                   0252 00298000
*         VARLEN=ZERO;              /* RESET VARIABLE LENGTH FIELD   */ 00299000
         SLR   VARLEN,VARLEN                                       0253 00300000
*       END;                                                       0254 00301000
*NEXTCHAR:                                                         0255 00302000
*   END;                                                           0255 00303000
@RF00248 DS    0H                                                  0255 00304000
NEXTCHAR AH    I,@CH00044                                          0255 00305000
@DE00237 SLR   @10,@10                                             0255 00306000
         IC    @10,CURLEN                                          0255 00307000
         CR    I,@10                                               0255 00308000
         BNH   @DL00237                                            0255 00309000
         EJECT                                                          00310000
*                                                                  0256 00311000
*   /*****************************************************************/ 00312000
*   /*                                                               */ 00313000
*   /* MESSAGE BUILT AND ALL VARIABLE PARTS FILLED IN. NOW SCAN THRU */ 00314000
*   /* MESSAGE TO COMPRESS OUT ANY MULTIPLE BLANKS           @Z67SP00*/ 00315000
*   /*                                                               */ 00316000
*   /*****************************************************************/ 00317000
*                                                                  0256 00318000
*   DO INDEX=DATASTRT TO CURLEN WHILE INDEX+1<=CURLEN;/*     @ZD00001*/ 00319000
         LA    INDEX,12                                            0256 00320000
         B     @DE00256                                            0256 00321000
@DL00256 SLR   @10,@10                                             0256 00322000
         IC    @10,CURLEN                                          0256 00323000
         LA    @08,1                                               0256 00324000
         ALR   @08,INDEX                                           0256 00325000
         CR    @08,@10                                             0256 00326000
         BH    @DC00256                                            0256 00327000
*     IF PRLDATA(INDEX:INDEX+1)=TWOBLANK/* TWO BLANKS IN A ROW?    0257 00328000
*                                                            @Z67SP00*/ 00329000
*       THEN                                                       0257 00330000
         L     @08,IOPBUFAD(,IOPPTR)                               0257 00331000
         LR    @06,@08                                             0257 00332000
         ALR   @06,INDEX                                           0257 00333000
         CLC   PRLDATA-1(2,@06),@CC01258                           0257 00334000
         BNE   @RF00257                                            0257 00335000
*       DO;                         /* REMOVE BLANK AND ADJUST LENGTH   00336000
*                                                            @ZD00001*/ 00337000
*         PRLDATA(INDEX:CURLEN-1)=PRLDATA(INDEX+1:CURLEN);/* @SA75296*/ 00338000
         LR    @06,@08                                             0259 00339000
         ALR   @06,INDEX                                           0259 00340000
         LR    @15,@10                                             0259 00341000
         SLR   @15,INDEX                                           0259 00342000
         BCTR  @15,0                                               0259 00343000
         ALR   @08,INDEX                                           0259 00344000
         MVC   @TS00001(256),PRLDATA(@08)                          0259 00345000
         EX    @15,@SM01368                                        0259 00346000
*         CURLEN=CURLEN-1;          /*                       @SA75296*/ 00347000
         BCTR  @10,0                                               0260 00348000
         STC   @10,CURLEN                                          0260 00349000
*         INDEX=INDEX-1;                                           0261 00350000
         BCTR  INDEX,0                                             0261 00351000
*       END;                                                       0262 00352000
*   END;                                                           0263 00353000
@RF00257 AH    INDEX,@CH00044                                      0263 00354000
@DE00256 SLR   @10,@10                                             0263 00355000
         IC    @10,CURLEN                                          0263 00356000
         CR    INDEX,@10                                           0263 00357000
         BNH   @DL00256                                            0263 00358000
@DC00256 DS    0H                                                  0264 00359000
         EJECT                                                          00360000
*                                                                  0264 00361000
*   /*****************************************************************/ 00362000
*   /*                                                               */ 00363000
*   /* WRITE TO LOG ROUTINE                                  @SA99994*/ 00364000
*   /*                                                               */ 00365000
*   /*****************************************************************/ 00366000
*                                                                  0264 00367000
*   IF(MGPHLDS=ON                   /* IF MSG TO LOG         @Z67SP00*/ 00368000
*       |                           /* OR TO                 @Z67SP00*/ 00369000
*       (MGPPRINT=ON&CCAOUTNG=ON))  /* PRINT BUT PRINT DEAD  @Z67SP00*/ 00370000
*       &CCALOGNG=OFF               /* AND NO PREV LOG ERROR @Z67SP00*/ 00371000
*       &MSGRTNCD<LONGMSG           /* AND NO SEVERE ERR?    @Z67SP00*/ 00372000
*     THEN                          /* YES                   @SA99994*/ 00373000
         L     @10,@PC00001                                        0264 00374000
         TM    MGPHLDS(@10),B'00010000'                            0264 00375000
         BO    @GL00005                                            0264 00376000
         TM    MGPPRINT(@10),B'10000000'                           0264 00377000
         BNO   @RF00264                                            0264 00378000
         L     @10,@CA00069                                        0264 00379000
         TM    CCAOUTNG-HMASMCCA(@10),B'01000000'                  0264 00380000
         BNO   @RF00264                                            0264 00381000
@GL00005 L     @10,@CA00069                                        0264 00382000
         TM    CCALOGNG-HMASMCCA(@10),B'10000000'                  0264 00383000
         BNZ   @RF00264                                            0264 00384000
         CH    MSGRTNCD,@CH00054                                   0264 00385000
         BNL   @RF00264                                            0264 00386000
*     DO;                           /*                       @SA99994*/ 00387000
*       IOPDSID=IOPHLDS;            /* LOG DATA SET          @SA99994*/ 00388000
         MVI   IOPDSID(IOPPTR),X'01'                               0266 00389000
*       PRLRLEN=CURLEN+10;          /* LOG MSG LENGTH        @SA75296*/ 00390000
         L     @10,IOPBUFAD(,IOPPTR)                               0267 00391000
         LA    @08,10                                              0267 00392000
         SLR   @06,@06                                             0267 00393000
         IC    @06,CURLEN                                          0267 00394000
         ALR   @08,@06                                             0267 00395000
         STH   @08,PRLRLEN(,@10)                                   0267 00396000
*       CALL HMASMIO(HMASMIOP);     /* WRITE MSG             @SA99994*/ 00397000
         ST    IOPPTR,@AL00001                                     0268 00398000
         L     @15,@CV01281                                        0268 00399000
         LA    @01,@AL00001                                        0268 00400000
         BALR  @14,@15                                             0268 00401000
*       IF IOPRETRN^=IOPGOOD        /* WRITE OK?             @YA07506*/ 00402000
*         THEN                      /* NO                    @SA99994*/ 00403000
         CLI   IOPRETRN(IOPPTR),0                                  0269 00404000
         BE    @RF00269                                            0269 00405000
*         MSGRTNCD=IOPIOERR;        /* SET RETURN CODE       @Z67SP00*/ 00406000
         LA    MSGRTNCD,16                                         0270 00407000
*       IF REENTERD=ON              /* RE-ENTRY?             @Z67SP00*/ 00408000
*         THEN                      /* YES                   @Z67SP00*/ 00409000
@RF00269 TM    REENTERD,B'01000000'                                0271 00410000
         BNO   @RF00271                                            0271 00411000
*         HMASMMGP=SAVMGP2;         /* RESTORE PROPER MGP    @ZD00001*/ 00412000
         L     @10,@PC00001                                        0272 00413000
         MVC   HMASMMGP(12,@10),SAVMGP2                            0272 00414000
*       ELSE                        /* PRIMARY ENTRY         @Z67SP00*/ 00415000
*         HMASMMGP=SAVMGP1;         /* RESTORE PROPER MGP    @ZD00001*/ 00416000
         B     @RC00271                                            0273 00417000
@RF00271 L     @10,@PC00001                                        0273 00418000
         MVC   HMASMMGP(12,@10),SAVMGP1                            0273 00419000
*     END;                          /* END WRITE TO LOG GROUP      0274 00420000
*                                                            @SA99994*/ 00421000
@RC00271 DS    0H                                                  0275 00422000
         EJECT                                                          00423000
*                                                                  0275 00424000
*   /*****************************************************************/ 00425000
*   /*                                                               */ 00426000
*   /* WRITE TO SMPOUT, SMPLIST, SMPRPT, WTO, WTP, AND WTOR  @SA99994*/ 00427000
*   /*                                                               */ 00428000
*   /*****************************************************************/ 00429000
*                                                                  0275 00430000
*   IF MSGRTNCD<LONGMSG             /* IF NO SEVERE ERR?     @Z67SP00*/ 00431000
*     THEN                          /* YES                   @SA99994*/ 00432000
@RF00264 CH    MSGRTNCD,@CH00054                                   0275 00433000
         BNL   @RF00275                                            0275 00434000
*     DO;                           /*                       @SA99994*/ 00435000
*       EXTSW=OFF;                  /* SET EXTENDED SW       @SA99994*/ 00436000
*                                                                  0277 00437000
         NI    EXTSW,B'11011111'                                   0277 00438000
*       /*************************************************************/ 00439000
*       /*                                                           */ 00440000
*       /* LOOP WRITING LINES UNTIL ALL OF MESSAGE HAS BEEN WRITTEN  */ 00441000
*       /*                                                           */ 00442000
*       /*************************************************************/ 00443000
*                                                                  0278 00444000
*       DO UNTIL EXTSW=OFF;         /* DO AT LEAST ONCE AND THEN AS     00445000
*                                      MANY MORE TIMES AS REQUIRED 0278 00446000
*                                                            @Z67SP00*/ 00447000
*                                                                  0278 00448000
@DL00278 DS    0H                                                  0279 00449000
*         /***********************************************************/ 00450000
*         /*                                                         */ 00451000
*         /* CALCULATE LENGTH OF LINE TO PRINT               @Z67SP00*/ 00452000
*         /*                                                         */ 00453000
*         /***********************************************************/ 00454000
*                                                                  0279 00455000
*         IF CURLEN>PRINTLIM        /* PRINTER LIMIT EXCEEDED      0279 00456000
*                                                            @SA75296*/ 00457000
*           THEN                    /* YES                   @SA99994*/ 00458000
         CLI   CURLEN,120                                          0279 00459000
         BNH   @RF00279                                            0279 00460000
*           DO;                     /*                       @SA99994*/ 00461000
*             DO PRLRLEN=PRINTLIM TO 1 BY-1 WHILE PRLDATA(PRLRLEN)^=    00462000
*                   BLANK;          /* BACK UP TO LAST BLANK @SA99994*/ 00463000
         LA    @10,120                                             0281 00464000
         L     @08,IOPBUFAD(,IOPPTR)                               0281 00465000
         STH   @10,PRLRLEN(,@08)                                   0281 00466000
@DL00281 L     @10,IOPBUFAD(,IOPPTR)                               0281 00467000
         LH    @08,PRLRLEN(,@10)                                   0281 00468000
         ALR   @10,@08                                             0281 00469000
         CLI   PRLDATA-1(@10),C' '                                 0281 00470000
         BE    @DC00281                                            0281 00471000
*             END;                  /*                       @SA99994*/ 00472000
         L     @08,IOPBUFAD(,IOPPTR)                               0282 00473000
         SLR   @10,@10                                             0282 00474000
         BCTR  @10,0                                               0282 00475000
         AH    @10,PRLRLEN(,@08)                                   0282 00476000
         L     @08,IOPBUFAD(,IOPPTR)                               0282 00477000
         STH   @10,PRLRLEN(,@08)                                   0282 00478000
         LTR   @10,@10                                             0282 00479000
         BP    @DL00281                                            0282 00480000
@DC00281 DS    0H                                                  0283 00481000
*             PRLRLEN=PRLRLEN-1;    /* BACK UP TO NONBLANK   @SA99994*/ 00482000
         L     @10,IOPBUFAD(,IOPPTR)                               0283 00483000
         LH    @08,PRLRLEN(,@10)                                   0283 00484000
         BCTR  @08,0                                               0283 00485000
         STH   @08,PRLRLEN(,@10)                                   0283 00486000
*             EXTSW=ON;             /* SET EXTENDED SW       @SA99994*/ 00487000
         OI    EXTSW,B'00100000'                                   0284 00488000
*           END;                    /*                       @SA99994*/ 00489000
*         ELSE                      /* NOT GREATER THAN LIM  @SA99994*/ 00490000
*           DO;                     /*                       @Z67SP00*/ 00491000
         B     @RC00279                                            0286 00492000
@RF00279 DS    0H                                                  0287 00493000
*             PRLRLEN=CURLEN;       /* SET LENGTH            @SA75296*/ 00494000
         L     @10,IOPBUFAD(,IOPPTR)                               0287 00495000
         SLR   @08,@08                                             0287 00496000
         IC    @08,CURLEN                                          0287 00497000
         STH   @08,PRLRLEN(,@10)                                   0287 00498000
*             EXTSW=OFF;            /* STOP WRITE LOOP       @Z67SP00*/ 00499000
         NI    EXTSW,B'11011111'                                   0288 00500000
*           END;                    /*                       @Z67SP00*/ 00501000
         EJECT                                                          00502000
*                                                                  0290 00503000
*         /***********************************************************/ 00504000
*         /*                                                         */ 00505000
*         /* WRITE LINE TO SMPOUT                            @Z67SP00*/ 00506000
*         /*                                                         */ 00507000
*         /***********************************************************/ 00508000
*                                                                  0290 00509000
*         IF(MGPPRINT=ON            /* IF MSG TO SMPOUT      @Z67SP00*/ 00510000
*             |                     /* OR                    @Z67SP00*/ 00511000
*             (MGPHLDS=ON&CCALOGNG=ON))/* LOG BUT LOG NOGO   @Z67SP00*/ 00512000
*             &CCAOUTNG=OFF         /* AND NO PREV OUT ERR   @Z67SP00*/ 00513000
*           THEN                    /*                       @Z67SP00*/ 00514000
@RC00279 L     @10,@PC00001                                        0290 00515000
         TM    MGPPRINT(@10),B'10000000'                           0290 00516000
         BO    @GL00008                                            0290 00517000
         TM    MGPHLDS(@10),B'00010000'                            0290 00518000
         BNO   @RF00290                                            0290 00519000
         L     @10,@CA00069                                        0290 00520000
         TM    CCALOGNG-HMASMCCA(@10),B'10000000'                  0290 00521000
         BNO   @RF00290                                            0290 00522000
@GL00008 L     @10,@CA00069                                        0290 00523000
         TM    CCAOUTNG-HMASMCCA(@10),B'01000000'                  0290 00524000
         BNZ   @RF00290                                            0290 00525000
*           DO;                     /*                       @Z67SP00*/ 00526000
*             IOPDSID=IOPPRINT;     /* SET FOR PRINTER       @SA99994*/ 00527000
         MVI   IOPDSID(IOPPTR),X'0B'                               0292 00528000
*             CALL HMASMIO(HMASMIOP);/* DO WRITE             @SA99994*/ 00529000
         ST    IOPPTR,@AL00001                                     0293 00530000
         L     @15,@CV01281                                        0293 00531000
         LA    @01,@AL00001                                        0293 00532000
         BALR  @14,@15                                             0293 00533000
*             MSGRTNCD=MAX(MSGRTNCD,IOPRETRN);/* SAVE RC     @Z67SP00*/ 00534000
         SLR   @10,@10                                             0294 00535000
         IC    @10,IOPRETRN(,IOPPTR)                               0294 00536000
         CR    MSGRTNCD,@10                                        0294 00537000
         BNL   *+6                                                      00538000
         LR    MSGRTNCD,@10                                        0294 00539000
*             IF REENTERD=ON        /* RE-ENTRY?             @Z67SP00*/ 00540000
*               THEN                /* YES                   @Z67SP00*/ 00541000
         TM    REENTERD,B'01000000'                                0295 00542000
         BNO   @RF00295                                            0295 00543000
*               HMASMMGP=SAVMGP2;   /* RESTORE PROPER MGP    @ZD00001*/ 00544000
         L     @10,@PC00001                                        0296 00545000
         MVC   HMASMMGP(12,@10),SAVMGP2                            0296 00546000
*             ELSE                  /* PRIMARY ENTRY         @Z67SP00*/ 00547000
*               HMASMMGP=SAVMGP1;   /* RESTORE PROPER MGP    @ZD00001*/ 00548000
         B     @RC00295                                            0297 00549000
@RF00295 L     @10,@PC00001                                        0297 00550000
         MVC   HMASMMGP(12,@10),SAVMGP1                            0297 00551000
*           END;                    /*                       @Z67SP00*/ 00552000
*                                                                  0298 00553000
@RC00295 DS    0H                                                  0299 00554000
*         /***********************************************************/ 00555000
*         /*                                                         */ 00556000
*         /* WRITE TO PROGRAMMER ROUTINE                     @Z67SP00*/ 00557000
*         /*                                                         */ 00558000
*         /***********************************************************/ 00559000
*                                                                  0299 00560000
*         IF MGPWTP=ON              /* IS THIS A WTP MESSAGE?      0299 00561000
*                                                            @Z67SP00*/ 00562000
*             |                     /* OR                    @Z67SP00*/ 00563000
*             (MGPPRINT=ON&CCAOUTNG=ON)/* OUT BUT OUT DEAD   @Z67SP00*/ 00564000
*             |                     /* OR TO                 @Z67SP00*/ 00565000
*             (MGPHLDS=ON&CCALOGNG=ON&CCAOUTNG=ON)/* LOG BUT LOG IS     00566000
*                                      DEAD AND MSG HAS NOT ALREADY     00567000
*                                      BEEN ROUTED TO SMPOUT @Z67SP00*/ 00568000
*           THEN                    /* YES - MUST ISSUE WTP  @Z67SP00*/ 00569000
@RF00290 L     @10,@PC00001                                        0299 00570000
         TM    MGPWTP(@10),B'00000010'                             0299 00571000
         BO    @RT00299                                            0299 00572000
         TM    MGPPRINT(@10),B'10000000'                           0299 00573000
         BNO   @GL00011                                            0299 00574000
         L     @10,@CA00069                                        0299 00575000
         TM    CCAOUTNG-HMASMCCA(@10),B'01000000'                  0299 00576000
         BO    @RT00299                                            0299 00577000
@GL00011 L     @10,@PC00001                                        0299 00578000
         TM    MGPHLDS(@10),B'00010000'                            0299 00579000
         BNO   @RF00299                                            0299 00580000
         L     @10,@CA00069                                        0299 00581000
         TM    CCALOGNG-HMASMCCA(@10),B'11000000'                  0299 00582000
         BNO   @RF00299                                            0299 00583000
@RT00299 DS    0H                                                  0300 00584000
*           DO;                                                    0300 00585000
*             WTPLEN=CURLEN+4;      /* SET WTO LENGTH        @Z67SP00*/ 00586000
         SLR   @10,@10                                             0301 00587000
         IC    @10,CURLEN                                          0301 00588000
         LA    @08,4(,@10)                                         0301 00589000
         STH   @08,WTPLEN                                          0301 00590000
*             MSGHDRSV=WTPMGP;      /* APPEND INFORMATIONAL SEVERITY    00591000
*                                      TO MESSAGE ID         @Z67SP00*/ 00592000
         L     @08,IOPBUFAD(,IOPPTR)                               0302 00593000
         MVI   MSGHDRSV(@08),C'I'                                  0302 00594000
*             WTPTXT=PRLDATA(1:CURLEN);/* MOVE DATA TO WTO   @Z67SP00*/ 00595000
         MVI   WTPTXT+1,C' '                                       0303 00596000
         MVC   WTPTXT+2(99),WTPTXT+1                               0303 00597000
         BCTR  @10,0                                               0303 00598000
         EX    @10,@SM01372                                        0303 00599000
*             GEN(WTO MF=(E,WTPMSG))                               0304 00600000
*             REFS(WTPMSG);         /*                       @Z67SP00*/ 00601000
         WTO MF=(E,WTPMSG)                                              00602000
*           END;                                                   0305 00603000
         EJECT                                                          00604000
*                                                                  0306 00605000
*         /***********************************************************/ 00606000
*         /*                                                         */ 00607000
*         /* WRITE LINE TO SMPLIST IF REQUESTED              @Z67SP00*/ 00608000
*         /*                                                         */ 00609000
*         /***********************************************************/ 00610000
*                                                                  0306 00611000
*         IF MGPLIST=ON             /* IF MSG TO SMPLIST     @Z67SP00*/ 00612000
*             &CCALISTP=ON          /* AND SMPLIST DD PRES.  @Z67SP00*/ 00613000
*           THEN                    /*                       @Z67SP00*/ 00614000
@RF00299 L     @10,@PC00001                                        0306 00615000
         TM    MGPLIST(@10),B'01000000'                            0306 00616000
         BNO   @RF00306                                            0306 00617000
         L     @10,@CA00069                                        0306 00618000
         TM    CCALISTP-HMASMCCA(@10),B'00010000'                  0306 00619000
         BNO   @RF00306                                            0306 00620000
*           DO;                     /*                       @Z67SP00*/ 00621000
*             IOPDSID=IOPLIST;      /* SET FOR SMPLIST       @Z67SP00*/ 00622000
         MVI   IOPDSID(IOPPTR),X'2A'                               0308 00623000
*             CALL HMASMIO(HMASMIOP);/* DO WRITE             @Z67SP00*/ 00624000
         ST    IOPPTR,@AL00001                                     0309 00625000
         L     @15,@CV01281                                        0309 00626000
         LA    @01,@AL00001                                        0309 00627000
         BALR  @14,@15                                             0309 00628000
*             MSGRTNCD=MAX(MSGRTNCD,IOPRETRN);/* SAVE RC     @Z67SP00*/ 00629000
         SLR   @10,@10                                             0310 00630000
         IC    @10,IOPRETRN(,IOPPTR)                               0310 00631000
         CR    MSGRTNCD,@10                                        0310 00632000
         BNL   *+6                                                      00633000
         LR    MSGRTNCD,@10                                        0310 00634000
*             IF REENTERD=ON        /* RE-ENTRY?             @Z67SP00*/ 00635000
*               THEN                /* YES                   @Z67SP00*/ 00636000
         TM    REENTERD,B'01000000'                                0311 00637000
         BNO   @RF00311                                            0311 00638000
*               HMASMMGP=SAVMGP2;   /* RESTORE PROPER MGP    @Z67SP00*/ 00639000
         L     @10,@PC00001                                        0312 00640000
         MVC   HMASMMGP(12,@10),SAVMGP2                            0312 00641000
*             ELSE                  /* PRIMARY ENTRY         @Z67SP00*/ 00642000
*               HMASMMGP=SAVMGP1;   /* RESTORE PROPER MGP    @Z67SP00*/ 00643000
         B     @RC00311                                            0313 00644000
@RF00311 L     @10,@PC00001                                        0313 00645000
         MVC   HMASMMGP(12,@10),SAVMGP1                            0313 00646000
*           END;                    /*                       @Z67SP00*/ 00647000
*                                                                  0314 00648000
@RC00311 DS    0H                                                  0315 00649000
*         /***********************************************************/ 00650000
*         /*                                                         */ 00651000
*         /* WRITE LINE TO SMPRPT                            @Z67SP00*/ 00652000
*         /*                                                         */ 00653000
*         /***********************************************************/ 00654000
*                                                                  0315 00655000
*         IF MGPRPT=ON              /* IF MSG TO SMPRPT      @Z67SP00*/ 00656000
*             &CCARPTP=ON           /* AND SMPRPT DD PRESENT @Z67SP00*/ 00657000
*           THEN                    /*                       @Z67SP00*/ 00658000
@RF00306 L     @10,@PC00001                                        0315 00659000
         TM    MGPRPT(@10),B'00100000'                             0315 00660000
         BNO   @RF00315                                            0315 00661000
         L     @10,@CA00069                                        0315 00662000
         TM    CCARPTP-HMASMCCA(@10),B'00001000'                   0315 00663000
         BNO   @RF00315                                            0315 00664000
*           DO;                     /*                       @Z67SP00*/ 00665000
*             IOPDSID=IOPRPT;       /* SET FOR SMPRPTR       @Z67SP00*/ 00666000
         MVI   IOPDSID(IOPPTR),X'29'                               0317 00667000
*             CALL HMASMIO(HMASMIOP);/* DO WRITE             @Z67SP00*/ 00668000
         ST    IOPPTR,@AL00001                                     0318 00669000
         L     @15,@CV01281                                        0318 00670000
         LA    @01,@AL00001                                        0318 00671000
         BALR  @14,@15                                             0318 00672000
*             MSGRTNCD=MAX(MSGRTNCD,IOPRETRN);/* SAVE RC     @Z67SP00*/ 00673000
         SLR   @10,@10                                             0319 00674000
         IC    @10,IOPRETRN(,IOPPTR)                               0319 00675000
         CR    MSGRTNCD,@10                                        0319 00676000
         BNL   *+6                                                      00677000
         LR    MSGRTNCD,@10                                        0319 00678000
*             IF REENTERD=ON        /* RE-ENTRY?             @Z67SP00*/ 00679000
*               THEN                /* YES                   @Z67SP00*/ 00680000
         TM    REENTERD,B'01000000'                                0320 00681000
         BNO   @RF00320                                            0320 00682000
*               HMASMMGP=SAVMGP2;   /* RESTORE PROPER MGP    @Z67SP00*/ 00683000
         L     @10,@PC00001                                        0321 00684000
         MVC   HMASMMGP(12,@10),SAVMGP2                            0321 00685000
*             ELSE                  /* PRIMARY ENTRY         @Z67SP00*/ 00686000
*               HMASMMGP=SAVMGP1;   /* RESTORE PROPER MGP    @Z67SP00*/ 00687000
         B     @RC00320                                            0322 00688000
@RF00320 L     @10,@PC00001                                        0322 00689000
         MVC   HMASMMGP(12,@10),SAVMGP1                            0322 00690000
*           END;                    /*                       @Z67SP00*/ 00691000
@RC00320 DS    0H                                                  0324 00692000
         EJECT                                                          00693000
*                                                                  0324 00694000
*         /***********************************************************/ 00695000
*         /*                                                         */ 00696000
*         /* WRITE TO OPERATOR MSG ROUTINE                   @Z67SP00*/ 00697000
*         /*                                                         */ 00698000
*         /***********************************************************/ 00699000
*                                                                  0324 00700000
*         IF(MGPWTO=ON              /* IS THIS A WTO MESSAGE?      0324 00701000
*                                                            @Z67SP00*/ 00702000
*             |(EXTSW=ON            /* OR FIRST PART OF      @Z67SP00*/ 00703000
*             &MGPWTOR=ON))         /* WTOR                  @Z67SP00*/ 00704000
*             &MSGRTNCD<LONGMSG     /* AND SMPOUT WRITE OK?  @Z67SP00*/ 00705000
*           THEN                    /* YES - MUST ISSUE WTP  @Z67SP00*/ 00706000
@RF00315 L     @10,@PC00001                                        0324 00707000
         TM    MGPWTO(@10),B'00000100'                             0324 00708000
         BO    @GL00017                                            0324 00709000
         TM    EXTSW,B'00100000'                                   0324 00710000
         BNO   @RF00324                                            0324 00711000
         TM    MGPWTOR(@10),B'00001000'                            0324 00712000
         BNO   @RF00324                                            0324 00713000
@GL00017 CH    MSGRTNCD,@CH00054                                   0324 00714000
         BNL   @RF00324                                            0324 00715000
*           DO;                                                    0325 00716000
*             WTOLEN=CURLEN+4;      /* SET WTO LENGTH        @Z67SP00*/ 00717000
         SLR   @10,@10                                             0326 00718000
         IC    @10,CURLEN                                          0326 00719000
         LA    @08,4(,@10)                                         0326 00720000
         STH   @08,WTOLEN                                          0326 00721000
*             MSGHDRSV=WTOMGP;      /* APPEND INFORMATIONAL SEVERITY    00722000
*                                      TO MESSAGE ID         @Z67SP00*/ 00723000
         L     @08,IOPBUFAD(,IOPPTR)                               0327 00724000
         MVI   MSGHDRSV(@08),C'I'                                  0327 00725000
*             WTOTXT=PRLDATA(1:CURLEN);/* MOVE DATA TO WTO   @Z67SP00*/ 00726000
         MVI   WTOTXT+1,C' '                                       0328 00727000
         MVC   WTOTXT+2(99),WTOTXT+1                               0328 00728000
         BCTR  @10,0                                               0328 00729000
         EX    @10,@SM01374                                        0328 00730000
*             GEN(WTO MF=(E,WTOMSG))                               0329 00731000
*             REFS(WTOMSG);         /*                       @Z67SP00*/ 00732000
         WTO MF=(E,WTOMSG)                                              00733000
*           END;                                                   0330 00734000
*                                                                  0330 00735000
*         /***********************************************************/ 00736000
*         /*                                                         */ 00737000
*         /* WRITE TO OPERATOR WITH RESPONSE MESSAGE ROUTINE @Z67SP00*/ 00738000
*         /*                                                         */ 00739000
*         /***********************************************************/ 00740000
*                                                                  0331 00741000
*         IF(MGPWTOR=ON             /* WTOR TYPE MSG?        @Z67SP00*/ 00742000
*             &EXTSW=OFF)           /* AND ONLY LAST PART    @Z67SP00*/ 00743000
*             &MSGRTNCD<LONGMSG     /* AND NO PREV ERR?      @Z67SP00*/ 00744000
*           THEN                    /* YES - MUST ISSUE WTOR @Z67SP00*/ 00745000
@RF00324 L     @10,@PC00001                                        0331 00746000
         TM    MGPWTOR(@10),B'00001000'                            0331 00747000
         BNO   @RF00331                                            0331 00748000
         TM    EXTSW,B'00100000'                                   0331 00749000
         BNZ   @RF00331                                            0331 00750000
         CH    MSGRTNCD,@CH00054                                   0331 00751000
         BNL   @RF00331                                            0331 00752000
*           DO;                                                    0332 00753000
*             WTORRLN=CURLEN+4;     /* SET WTOR LENGTH       @Z67SP00*/ 00754000
         SLR   @08,@08                                             0333 00755000
         IC    @08,CURLEN                                          0333 00756000
         LA    @06,4(,@08)                                         0333 00757000
         STC   @06,WTORRLN                                         0333 00758000
*             MSGHDRSV=WTORMGP;     /* APPEND INFORMATIONAL SEVERITY    00759000
*                                      TO MESSAGE ID         @Z67SP00*/ 00760000
         L     @06,IOPBUFAD(,IOPPTR)                               0334 00761000
         MVI   MSGHDRSV(@06),C'I'                                  0334 00762000
*             WTORTXT=PRLDATA(1:CURLEN);/* MOVE DATA TO WTOR @Z67SP00*/ 00763000
         MVI   WTORTXT+1,C' '                                      0335 00764000
         MVC   WTORTXT+2(99),WTORTXT+1                             0335 00765000
         BCTR  @08,0                                               0335 00766000
         EX    @08,@SM01376                                        0335 00767000
*             RFY                                                  0336 00768000
*              (R2,                                                0336 00769000
*               R3) RSTD;           /*                       @Z67SP00*/ 00770000
*             R2=MGPVARPT(VARNDX);  /*                       @Z67SP00*/ 00771000
         LR    @08,VARNDX                                          0337 00772000
         SLA   @08,2                                               0337 00773000
         L     R2,MGPVARPT-4(@08,@10)                              0337 00774000
*             R3=MGPVARPT(VARNDX+1);/*                       @Z67SP00*/ 00775000
         L     R3,MGPVARPT(@08,@10)                                0338 00776000
*             GEN(WTOR (R2),(R3),,MF=(E,WTORMSG))                  0339 00777000
*             REFS(R2,R3,WTORMSG);  /* ISSUE WTOR            @Z67SP00*/ 00778000
         WTOR (R2),(R3),,MF=(E,WTORMSG)                                 00779000
*             RFY                                                  0340 00780000
*              (R2,                                                0340 00781000
*               R3) UNRSTD;         /*                       @Z67SP00*/ 00782000
*             GEN(WAIT ECB=ECB)     /*                       @Z67SP00*/ 00783000
*             REFS(ECB);            /*                       @Z67SP00*/ 00784000
         WAIT ECB=ECB                                                   00785000
*           END;                                                   0342 00786000
*                                                                  0343 00787000
*         /***********************************************************/ 00788000
*         /*                                                         */ 00789000
*         /* NOW DETERMINE IF THERE IS ANOTHER PART OF MSG TO WRIT   */ 00790000
*         /*                                                 @Z67SP00*/ 00791000
*         /*                                                         */ 00792000
*         /***********************************************************/ 00793000
*                                                                  0343 00794000
*         IF EXTSW=ON               /* PRINTER LINE EXTENDED?      0343 00795000
*                                                            @SA99994*/ 00796000
*           THEN                    /* YES                   @SA99994*/ 00797000
@RF00331 TM    EXTSW,B'00100000'                                   0343 00798000
         BNO   @RF00343                                            0343 00799000
*           DO;                     /*                       @SA99994*/ 00800000
*             PRLDATA(1:DATASTRT)=BLANK;/* INIT HEADING AREA @SA99994*/ 00801000
         L     @10,IOPBUFAD(,IOPPTR)                               0345 00802000
         MVI   PRLDATA+1(@10),C' '                                 0345 00803000
         MVC   PRLDATA+2(10,@10),PRLDATA+1(@10)                    0345 00804000
         MVI   PRLDATA(@10),C' '                                   0345 00805000
*             REMLEN=CURLEN-PRLRLEN-1;/* REMAING DATA LENGTH @SA75296*/ 00806000
         LH    @08,PRLRLEN(,@10)                                   0346 00807000
         SLR   REMLEN,REMLEN                                       0346 00808000
         IC    REMLEN,CURLEN                                       0346 00809000
         SLR   REMLEN,@08                                          0346 00810000
         BCTR  REMLEN,0                                            0346 00811000
*             PRLDATA(DATASTRT:REMLEN+DATASTRT-1)=PRLDATA(PRLRLEN+2:    00812000
*                 CURLEN);          /* MOVE REST OF DATA TO START OF    00813000
*                                      LINE                  @SA75296*/ 00814000
         LR    @06,REMLEN                                          0347 00815000
         BCTR  @06,0                                               0347 00816000
         ALR   @08,@10                                             0347 00817000
         MVC   @TS00001(256),PRLDATA+1(@08)                        0347 00818000
         EX    @06,@SM01378                                        0347 00819000
*             CURLEN=DATASTRT+REMLEN-1;/* RESET LINE LENGTH  @SA75296*/ 00820000
         LR    @10,REMLEN                                          0348 00821000
         SH    @10,@CH01359                                        0348 00822000
         STC   @10,CURLEN                                          0348 00823000
*           END;                    /* END LINE EXTENED GROUP      0349 00824000
*                                                            @SA99994*/ 00825000
*       END;                        /* END MULTI WRITE LOOP  @Z67SP00*/ 00826000
@RF00343 DS    0H                                                  0350 00827000
@DE00278 TM    EXTSW,B'00100000'                                   0350 00828000
         BNZ   @DL00278                                            0350 00829000
*     END;                          /* END PRINTER GROUP     @SA99994*/ 00830000
         EJECT                                                          00831000
*                                                                  0352 00832000
*   /*****************************************************************/ 00833000
*   /*                                                               */ 00834000
*   /* WRITE TO OPERATOR IF I/O ERROR MSG ROUTINE            @SA99994*/ 00835000
*   /*                                                               */ 00836000
*   /*****************************************************************/ 00837000
*                                                                  0352 00838000
*   IF MGPMGNO1=IOERRMSG            /*                       @Z67SP00*/ 00839000
*     THEN                          /* YES - MUST ISSUE WTO  @Z67SP00*/ 00840000
@RF00275 L     @10,@PC00001                                        0352 00841000
         CLC   MGPMGNO1(2,@10),@CH01249                            0352 00842000
         BNE   @RF00352                                            0352 00843000
*     DO;                                                          0353 00844000
*       WTOLEN=CURLEN+4;            /* SET WTO LENGTH        @SA75296*/ 00845000
         SLR   @10,@10                                             0354 00846000
         IC    @10,CURLEN                                          0354 00847000
         LA    @08,4(,@10)                                         0354 00848000
         STH   @08,WTOLEN                                          0354 00849000
*       MSGHDRSV=WTOMGP;            /* APPEND INFORMATIONAL  @ZD00001*/ 00850000
*                                                                  0355 00851000
         L     @08,IOPBUFAD(,IOPPTR)                               0355 00852000
         MVI   MSGHDRSV(@08),C'I'                                  0355 00853000
*       /*************************************************************/ 00854000
*       /*                                                           */ 00855000
*       /* SEVERITY TO MESSAGE ID                                    */ 00856000
*       /*                                                           */ 00857000
*       /*************************************************************/ 00858000
*                                                                  0356 00859000
*       WTOTXT=PRLDATA(1:CURLEN);   /* MOVE DATA TO WTO      @SA75296*/ 00860000
         MVI   WTOTXT+1,C' '                                       0356 00861000
         MVC   WTOTXT+2(99),WTOTXT+1                               0356 00862000
         BCTR  @10,0                                               0356 00863000
         EX    @10,@SM01374                                        0356 00864000
*       GEN(WTO  MF=(E,WTOMSG))                                    0357 00865000
*       REFS(WTOMSG);               /*                       @Z67SP00*/ 00866000
         WTO  MF=(E,WTOMSG)                                             00867000
*     END;                                                         0358 00868000
         EJECT                                                          00869000
*                                                                  0359 00870000
*   /*****************************************************************/ 00871000
*   /*                                                               */ 00872000
*   /* CODE TO SET UP PROPER RETURN CODE, SAVE AREA ADDRESS AND      */ 00873000
*   /* RETURN TO CALLING PROGRAM                             @SA74329*/ 00874000
*   /*                                                               */ 00875000
*   /*****************************************************************/ 00876000
*                                                                  0359 00877000
*   IF REENTERD=ON                  /* IS THIS RE-ENTRY?             */ 00878000
*     THEN                          /* YES - TURN OFF                */ 00879000
@RF00352 TM    REENTERD,B'01000000'                                0359 00880000
         BNO   @RF00359                                            0359 00881000
*     DO;                           /*                       @SA75296*/ 00882000
*       HMASMMGP=SAVMGP2;           /* RESTORE PASSED MGP    @ZD00001*/ 00883000
         L     @10,@PC00001                                        0361 00884000
         MVC   HMASMMGP(12,@10),SAVMGP2                            0361 00885000
*       REENTERD=OFF;               /* INDICATE RE-ENTRY COMPLETE    */ 00886000
         NI    REENTERD,B'10111111'                                0362 00887000
*     END;                          /* END RE-ENTRY GROUP    @SA75296*/ 00888000
*   ELSE                            /* OTHERWISE - INDICATE          */ 00889000
*     DO;                           /* ONE ENTRY GROUP       @SA75296*/ 00890000
         B     @RC00359                                            0364 00891000
@RF00359 DS    0H                                                  0365 00892000
*       HMASMMGP=SAVMGP1;           /* RESTORE PASSED MGP    @ZD00001*/ 00893000
         L     @10,@PC00001                                        0365 00894000
         MVC   HMASMMGP(12,@10),SAVMGP1                            0365 00895000
*       ENTERED=OFF;                /* MAIN ENTRY COMPLETE           */ 00896000
         NI    ENTERED,B'01111111'                                 0366 00897000
*     END;                          /* END ONE ENTRY GROUP   @SA75296*/ 00898000
*   R13=SVBACK;                     /* RESTORE SV AREA PTR           */ 00899000
@RC00359 L     R13,SVBACK(,R13)                                    0368 00900000
*   IF MSGRTNCD=IOPIOERR            /* SAVERE ERROR?         @Z67SP00*/ 00901000
*     THEN                          /* YES - SET BIT TO STOP @Z67SP00*/ 00902000
         CH    MSGRTNCD,@CH00042                                   0369 00903000
         BNE   @RF00369                                            0369 00904000
*     CCATERM=ON;                   /* SMP AT RTN TO DRV     @Z67SP00*/ 00905000
         L     @10,@CA00069                                        0370 00906000
         OI    CCATERM-HMASMCCA(@10),B'00100000'                   0370 00907000
*   RETURN CODE(MSGRTNCD);          /* RETURN WITH SET CODE  @SA74329*/ 00908000
@RF00369 LR    @15,MSGRTNCD                                        0371 00909000
         L     @14,12(,@13)                                        0371 00910000
         LM    @00,@12,20(@13)                                     0371 00911000
         BR    @14                                                 0371 00912000
*   END HMASMMSG                                                   0372 00913000
*                                                                  0372 00914000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00915000
*/*%INCLUDE SYSLIB  (HMASMMGP)                                       */ 00916000
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */ 00917000
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */ 00918000
*/*%INCLUDE SYSLIB  (HMASMPRL)                                       */ 00919000
*                                                                  0372 00920000
*       ;                                                          0372 00921000
@EL00001 DS    0H                                                  0372 00922000
@EF00001 DS    0H                                                  0372 00923000
@ER00001 LM    @14,@12,12(@13)                                     0372 00924000
         BR    @14                                                 0372 00925000
@DATA    DS    0H                                                       00926000
@CH00044 DC    H'1'                                                     00927000
@CH00056 DC    H'3'                                                     00928000
@CH00054 DC    H'8'                                                     00929000
@CH00042 DC    H'16'                                                    00930000
@CH01249 DC    H'75'                                                    00931000
@CH01247 DC    H'250'                                                   00932000
@CH01359 DC    H'-11'                                                   00933000
@SM01364 MVC   PRLDATA-1(0,@10),MSGTEXT(MSGPTR)                         00934000
@SM01366 MVC   PRLDATA-1(0,@10),VARSTRNG(@01)                           00935000
@SM01368 MVC   PRLDATA-1(0,@06),@TS00001                                00936000
@SM01372 MVC   WTPTXT(0),PRLDATA(@08)                                   00937000
@SM01374 MVC   WTOTXT(0),PRLDATA(@08)                                   00938000
@SM01376 MVC   WTORTXT(0),PRLDATA(@06)                                  00939000
@SM01378 MVC   PRLDATA+11(0,@10),@TS00001                               00940000
         DS    0F                                                       00941000
@PC00001 DS    1F                                                       00942000
@AL00001 DS    1A                                                       00943000
         DS    0F                                                       00944000
@CF01363 DC    F'-4'                                                    00945000
@CA00069 DC    A(HMASMCCA)                                              00946000
@CV01281 DC    V(HMASMIO)                                               00947000
@CA01347 DC    A(DC1PMSG)                                               00948000
@CA01348 DC    A(DC1SMSG)                                               00949000
         DS    0D                                                       00950000
ECB      DC    F'0'                                                     00951000
CURLEN   DS    FL1                                                      00952000
         DS    0D                                                       00953000
@TS00001 DS    CL256                                                    00954000
@CC01258 DC    C'  '                                                    00955000
@CC01271 DC    C'**'                                                    00956000
SYSMSGNO DC    CL11'HMA        '                                        00957000
         DS    CL1                                                      00958000
SVAREA1  DS    CL72                                                     00959000
SVAREA2  DS    CL72                                                     00960000
SWITCHES DC    AL1(0)                                                   00961000
         ORG   SWITCHES                                                 00962000
ENTERED  DS    BL1                                                      00963000
REENTERD EQU   SWITCHES+0                                               00964000
EXTSW    EQU   SWITCHES+0                                               00965000
         ORG   SWITCHES+1                                               00966000
DECNO    DS    CL3                                                      00967000
IOP      DS    CL68                                                     00968000
PRL      DS    CL260                                                    00969000
PATCHMSG DS    CL80                                                     00970000
         ORG   PATCHMSG                                                 00971000
@NM00181 DC    80X'FF'                                                  00972000
         ORG   PATCHMSG+80                                              00973000
SAVMGP1  DS    CL12                                                     00974000
SAVMGP2  DS    CL12                                                     00975000
SEVERITY DC    CL1'0'                                                   00976000
         DC    CL1'1'                                                   00977000
         DC    CL1'2'                                                   00978000
         DC    CL1'3'                                                   00979000
         DC    CL1'4'                                                   00980000
         DC    CL1'D'                                                   00981000
HMASMMSG CSECT                                                          00982000
WTPLST WTO 'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00983000
               XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX',            X00984000
               DESC=7,ROUTCDE=(11),MF=L                      @Z67SP00   00985000
HMASMMSG CSECT                                                          00986000
WTOLST WTO 'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00987000
               XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX',            X00988000
               DESC=7,ROUTCDE=(2,11),MF=L                    @ZA12166   00989000
HMASMMSG CSECT                                                          00990000
WTORLST WTOR 'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00991000
               XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX',,,ECB,    X00992000
               ROUTCDE=(1,2),MF=L                                       00993000
HMASMMSG CSECT                                                          00994000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00995000
@01      EQU   01                                                       00996000
@02      EQU   02                                                       00997000
@03      EQU   03                                                       00998000
@04      EQU   04                                                       00999000
@05      EQU   05                                                       01000000
@06      EQU   06                                                       01001000
@07      EQU   07                                                       01002000
@08      EQU   08                                                       01003000
@09      EQU   09                                                       01004000
@10      EQU   10                                                       01005000
@11      EQU   11                                                       01006000
@12      EQU   12                                                       01007000
@13      EQU   13                                                       01008000
@14      EQU   14                                                       01009000
@15      EQU   15                                                       01010000
MSGNO    EQU   @07                                                      01011000
REMLEN   EQU   @04                                                      01012000
MSGPTR   EQU   @06                                                      01013000
VARSTART EQU   @08                                                      01014000
VARNDX   EQU   @07                                                      01015000
VARLEN   EQU   @06                                                      01016000
INDEX    EQU   @04                                                      01017000
MSGRTNCD EQU   @05                                                      01018000
I        EQU   @04                                                      01019000
IOPPTR   EQU   @09                                                      01020000
R1       EQU   @01                                                      01021000
R2       EQU   @02                                                      01022000
R3       EQU   @03                                                      01023000
CCAPTR   EQU   @11                                                      01024000
R13      EQU   @13                                                      01025000
         EXTRN HMASMCCA                                                 01026000
         EXTRN DC1PMSG                                                  01027000
         EXTRN DC1SMSG                                                  01028000
CCABLDLA EQU   0                                                        01029000
@NM00027 EQU   CCABLDLA                                                 01030000
CCABLDLL EQU   0                                                        01031000
@NM00029 EQU   CCABLDLL                                                 01032000
CCALKDRC EQU   @NM00029+20                                              01033000
@NM00031 EQU   CCABLDLL+124                                             01034000
CCAASMRC EQU   @NM00031+20                                              01035000
@NM00033 EQU   CCABLDLL+248                                             01036000
CCACPYRC EQU   @NM00033+20                                              01037000
@NM00035 EQU   CCABLDLL+372                                             01038000
CCACOMRC EQU   @NM00035+20                                              01039000
@NM00037 EQU   CCABLDLL+496                                             01040000
CCAZAPRC EQU   @NM00037+20                                              01041000
@NM00039 EQU   CCABLDLL+620                                             01042000
CCASUPRC EQU   @NM00039+20                                              01043000
@NM00041 EQU   CCABLDLL+744                                             01044000
CCAUPDRC EQU   @NM00041+20                                              01045000
CCABLDLM EQU   0                                                        01046000
CCABELMT EQU   CCABLDLM+4                                               01047000
CCABMPOS EQU   CCABELMT                                                 01048000
HMASMIOP EQU   0                                                        01049000
IOPDSID  EQU   HMASMIOP                                                 01050000
IOPFUNCT EQU   HMASMIOP+1                                               01051000
IOPRETRN EQU   HMASMIOP+2                                               01052000
IOPNAME  EQU   HMASMIOP+4                                               01053000
@NM00045 EQU   HMASMIOP+12                                              01054000
@NM00046 EQU   @NM00045                                                 01055000
IOPDDNAM EQU   HMASMIOP+24                                              01056000
IOPBUFAD EQU   HMASMIOP+52                                              01057000
IOPDRMAP EQU   HMASMIOP+56                                              01058000
IOPINAME EQU   IOPDRMAP                                                 01059000
IOPINAM  EQU   IOPINAME                                                 01060000
IOPITYP  EQU   IOPINAM                                                  01061000
IOPUSERL EQU   IOPDRMAP+11                                              01062000
IOPEND   EQU   IOPDRMAP+12                                              01063000
IOPLMCTL EQU   0                                                        01064000
IOPQSMIF EQU   0                                                        01065000
@NM00156 EQU   IOPQSMIF                                                 01066000
IOPQSMLS EQU   IOPQSMIF+8                                               01067000
IOPQSMNM EQU   IOPQSMLS                                                 01068000
IOPBS02  EQU   0                                                        01069000
IOPBS04  EQU   0                                                        01070000
IOPBAPF  EQU   IOPBS04                                                  01071000
HMASMPRL EQU   0                                                        01072000
PRLRLEN  EQU   HMASMPRL                                                 01073000
PRLSPAN  EQU   HMASMPRL+2                                               01074000
PRLFLGS  EQU   PRLSPAN                                                  01075000
PRLDATE  EQU   HMASMPRL+4                                               01076000
PRLTIME  EQU   HMASMPRL+7                                               01077000
PRLEND   EQU   HMASMPRL+10                                              01078000
SVMAP    EQU   0                                                        01079000
SVBACK   EQU   SVMAP+4                                                  01080000
SVFWRD   EQU   SVMAP+8                                                  01081000
VARSTRNG EQU   0                                                        01082000
MSGMAP   EQU   0                                                        01083000
MSGLEN   EQU   MSGMAP                                                   01084000
MSGTEXT  EQU   MSGMAP+1                                                 01085000
CCADSIDA EQU   0                                                        01086000
CCATYPEA EQU   0                                                        01087000
IOPBS01  EQU   0                                                        01088000
IOPBS03  EQU   0                                                        01089000
CCAFBUFR EQU   HMASMCCA+4                                               01090000
CCADSAD  EQU   CCAFBUFR+124                                             01091000
CCATPAD  EQU   CCAFBUFR+128                                             01092000
CCAFLAG7 EQU   CCAFBUFR+132                                             01093000
CCALISTP EQU   CCAFLAG7+2                                               01094000
CCARPTP  EQU   CCAFLAG7+2                                               01095000
CCAFIOP  EQU   HMASMCCA+140                                             01096000
CCAFSYS  EQU   HMASMCCA+148                                             01097000
CCASREL  EQU   CCAFSYS+12                                               01098000
CCAFLAGA EQU   CCAFSYS+21                                               01099000
CCAFSTA  EQU   HMASMCCA+188                                             01100000
CCAFICT  EQU   HMASMCCA+192                                             01101000
CCAFPGM  EQU   HMASMCCA+208                                             01102000
CCABLDLP EQU   CCAFPGM                                                  01103000
CCADBLDL EQU   CCAFPGM+4                                                01104000
CCAFGTP  EQU   HMASMCCA+224                                             01105000
CCASEGTP EQU   CCAFGTP                                                  01106000
@NM00011 EQU   HMASMCCA+244                                             01107000
CCAFFUNC EQU   HMASMCCA+264                                             01108000
CCAFLAG1 EQU   CCAFFUNC+8                                               01109000
CCAFLAG2 EQU   CCAFFUNC+11                                              01110000
CCATERM  EQU   CCAFLAG2                                                 01111000
CCAFPROC EQU   HMASMCCA+276                                             01112000
CCAFLAG3 EQU   CCAFPROC                                                 01113000
CCAFDIS  EQU   HMASMCCA+278                                             01114000
CCAFLAG4 EQU   CCAFDIS                                                  01115000
CCAFLAG5 EQU   CCAFDIS+1                                                01116000
CCAFLAG6 EQU   CCAFDIS+2                                                01117000
CCAFCNV  EQU   HMASMCCA+281                                             01118000
CCAFLAG8 EQU   CCAFCNV                                                  01119000
CCAFCTL  EQU   HMASMCCA+282                                             01120000
CCAFLAG9 EQU   CCAFCTL                                                  01121000
CCAFDSNG EQU   HMASMCCA+298                                             01122000
CCAFLAGB EQU   CCAFDSNG                                                 01123000
CCALOGNG EQU   CCAFLAGB                                                 01124000
CCAOUTNG EQU   CCAFLAGB                                                 01125000
HMASMMGP EQU   0                                                        01126000
MGPFIXED EQU   HMASMMGP                                                 01127000
MGPCLEAR EQU   MGPFIXED                                                 01128000
MGPMGNO1 EQU   MGPCLEAR                                                 01129000
MGPFLAGS EQU   MGPFIXED+6                                               01130000
MGPPRINT EQU   MGPFLAGS                                                 01131000
MGPLIST  EQU   MGPFLAGS                                                 01132000
MGPRPT   EQU   MGPFLAGS                                                 01133000
MGPHLDS  EQU   MGPFLAGS                                                 01134000
MGPWTOR  EQU   MGPFLAGS                                                 01135000
MGPWTO   EQU   MGPFLAGS                                                 01136000
MGPWTP   EQU   MGPFLAGS                                                 01137000
MGPTYPE  EQU   MGPFIXED+8                                               01138000
MGPVAR   EQU   HMASMMGP+12                                              01139000
MGPVARPT EQU   MGPVAR                                                   01140000
IOPUDATA EQU   IOPEND                                                   01141000
IOPINAM3 EQU   IOPINAME                                                 01142000
@NM00052 EQU   IOPINAM3                                                 01143000
IOPSTCMP EQU   IOPUDATA                                                 01144000
IOPDYNDT EQU   IOPUDATA                                                 01145000
IOPSPACE EQU   IOPDYNDT+44                                              01146000
IOPDTYPE EQU   IOPDYNDT+50                                              01147000
IOPNTMAX EQU   IOPDRMAP                                                 01148000
IOPNTMAP EQU   IOPDRMAP                                                 01149000
IOPCDMAP EQU   IOPNTMAP                                                 01150000
IOPPTMAP EQU   IOPCDMAP                                                 01151000
IOPSCMAP EQU   IOPPTMAP                                                 01152000
IOPDIRCT EQU   IOPSCMAP+12                                              01153000
IOPCDMAX EQU   IOPDIRCT                                                 01154000
IOPCQMAP EQU   IOPDRMAP                                                 01155000
@NM00063 EQU   IOPUDATA                                                 01156000
@NM00064 EQU   IOPUDATA                                                 01157000
IOPASMNT EQU   IOPUDATA                                                 01158000
IOPASMDR EQU   IOPASMNT                                                 01159000
IOPABUNT EQU   IOPASMDR+1                                               01160000
IOPLMDNT EQU   IOPUDATA                                                 01161000
IOPLMDDR EQU   IOPLMDNT                                                 01162000
IOPLMLEP EQU   IOPLMDDR+1                                               01163000
IOPLMDF1 EQU   IOPLMLEP                                                 01164000
IOPFLGS2 EQU   IOPLMDF1                                                 01165000
IOPLMDF2 EQU   IOPLMLEP+1                                               01166000
IOPLMDF3 EQU   IOPLMLEP+2                                               01167000
IOPLMDF4 EQU   IOPLMLEP+3                                               01168000
IOPLMDF5 EQU   IOPLMDDR+5                                               01169000
IOPFLGS3 EQU   IOPLMDF5                                                 01170000
IOPLMDFX EQU   IOPLMDNT+24                                              01171000
@NM00073 EQU   IOPLMDFX                                                 01172000
IOPLNTRY EQU   IOPLMDFX+8                                               01173000
IOPLSYS  EQU   IOPLNTRY                                                 01174000
IOPSYSLB EQU   IOPLSYS                                                  01175000
IOPMACNT EQU   IOPUDATA                                                 01176000
IOPMACDR EQU   IOPMACNT                                                 01177000
IOPRMIDE EQU   IOPMACDR+1                                               01178000
IOPRMST  EQU   IOPRMIDE+7                                               01179000
IOPFMIDE EQU   IOPMACDR+9                                               01180000
IOPMACFX EQU   IOPMACNT+24                                              01181000
IOPBUNT  EQU   IOPMACFX                                                 01182000
IOPMCEND EQU   IOPMACNT+104                                             01183000
IOPMACVR EQU   IOPMCEND                                                 01184000
IOPMCENT EQU   IOPMACVR                                                 01185000
IOPMCDTA EQU   IOPMCENT                                                 01186000
IOPMCASM EQU   IOPMCDTA                                                 01187000
IOPMACID EQU   IOPMCASM                                                 01188000
IOPMACST EQU   IOPMCASM+7                                               01189000
IOPMCIND EQU   IOPMCENT+8                                               01190000
IOPEOFNT EQU   IOPUDATA                                                 01191000
IOPSRCNT EQU   IOPUDATA                                                 01192000
IOPSRCDR EQU   IOPSRCNT                                                 01193000
@NM00084 EQU   IOPSRCDR+1                                               01194000
@NM00086 EQU   @NM00084+7                                               01195000
@NM00090 EQU   IOPSRCDR+9                                               01196000
IOPSRCFX EQU   IOPSRCNT+24                                              01197000
@NM00094 EQU   IOPSRCFX                                                 01198000
IOPSREND EQU   IOPSRCNT+104                                             01199000
IOPSRCVR EQU   IOPSREND                                                 01200000
IOPSNTRY EQU   IOPSRCVR                                                 01201000
IOPSRDTA EQU   IOPSNTRY                                                 01202000
IOPSRCID EQU   IOPSRDTA                                                 01203000
IOPSRCST EQU   IOPSRDTA+7                                               01204000
IOPMODNT EQU   IOPUDATA                                                 01205000
IOPMODDR EQU   IOPMODNT                                                 01206000
@NM00100 EQU   IOPMODDR+1                                               01207000
@NM00102 EQU   @NM00100+7                                               01208000
@NM00106 EQU   IOPMODDR+9                                               01209000
IOPMODFX EQU   IOPMODNT+24                                              01210000
@NM00110 EQU   IOPMODFX                                                 01211000
IOPMDLEP EQU   IOPMODFX+8                                               01212000
IOPMODF1 EQU   IOPMDLEP                                                 01213000
IOPMODF2 EQU   IOPMDLEP+1                                               01214000
IOPMODF3 EQU   IOPMDLEP+2                                               01215000
IOPMODF4 EQU   IOPMDLEP+3                                               01216000
IOPMDEND EQU   IOPMODNT+104                                             01217000
IOPMODVR EQU   IOPMDEND                                                 01218000
IOPMNTRY EQU   IOPMODVR                                                 01219000
IOPMDDTA EQU   IOPMNTRY                                                 01220000
IOPLMODS EQU   IOPMDDTA                                                 01221000
IOPMODID EQU   IOPLMODS                                                 01222000
IOPMODST EQU   IOPLMODS+7                                               01223000
IOPDLBNT EQU   IOPUDATA                                                 01224000
IOPDLBDR EQU   IOPDLBNT                                                 01225000
IOPDLBFX EQU   IOPDLBNT+24                                              01226000
@NM00121 EQU   IOPDLBFX                                                 01227000
IOPDLEND EQU   IOPDLBNT+104                                             01228000
IOPDLBVR EQU   IOPDLEND                                                 01229000
IOPDNTRY EQU   IOPDLBVR                                                 01230000
IOPDSYS  EQU   IOPDNTRY                                                 01231000
IOPSYSNT EQU   IOPUDATA                                                 01232000
IOPSYSDR EQU   IOPSYSNT                                                 01233000
IOPSYSF1 EQU   IOPSYSDR+4                                               01234000
IOPFLGS7 EQU   IOPSYSF1                                                 01235000
IOPSYSFX EQU   IOPSYSNT+24                                              01236000
@NM00128 EQU   IOPSYSFX                                                 01237000
IOPSYEND EQU   IOPSYSNT+184                                             01238000
IOPSYSVR EQU   IOPSYEND                                                 01239000
IOPSYSTR EQU   IOPSYSVR                                                 01240000
IOPSYNTR EQU   IOPSYSTR                                                 01241000
IOPPTFNT EQU   IOPUDATA                                                 01242000
IOPPTFDR EQU   IOPPTFNT                                                 01243000
IOPPSTAT EQU   IOPPTFDR+2                                               01244000
IOPPTFF1 EQU   IOPPSTAT                                                 01245000
IOPFLGS5 EQU   IOPPTFF1                                                 01246000
IOPPTFF2 EQU   IOPPSTAT+1                                               01247000
IOPPTFF3 EQU   IOPPSTAT+3                                               01248000
IOPPTFFX EQU   IOPPTFNT+24                                              01249000
@NM00137 EQU   IOPPTFFX                                                 01250000
@NM00138 EQU   @NM00137                                                 01251000
IOPPDTES EQU   IOPPTFFX+41                                              01252000
@NM00141 EQU   IOPPDTES                                                 01253000
IOPPTPFX EQU   IOPPDTES+6                                               01254000
IOPDATES EQU   IOPPTPFX                                                 01255000
IOPPTEND EQU   IOPPTFNT+104                                             01256000
IOPPTFVR EQU   IOPPTEND                                                 01257000
IOPPNTRY EQU   IOPPTFVR                                                 01258000
IOPPMODS EQU   IOPPNTRY                                                 01259000
IOPENTNT EQU   IOPUDATA+104                                             01260000
IOPSRLNT EQU   IOPUDATA+104                                             01261000
IOPPRENT EQU   IOPUDATA+104                                             01262000
IOPNPRNT EQU   IOPUDATA+104                                             01263000
IOPSUPNT EQU   IOPUDATA+104                                             01264000
IOPREQNT EQU   IOPUDATA+104                                             01265000
IOPIRQNT EQU   IOPUDATA+104                                             01266000
IOPFIDNT EQU   IOPUDATA+104                                             01267000
IOPDELNT EQU   IOPUDATA+104                                             01268000
IOPVERNT EQU   IOPUDATA+104                                             01269000
IOPSBYNT EQU   IOPUDATA+104                                             01270000
IOPQSMNT EQU   IOPUDATA                                                 01271000
IOPQSMDR EQU   IOPQSMNT                                                 01272000
IOPQFMNT EQU   IOPUDATA                                                 01273000
IOPQFMDR EQU   IOPQFMNT                                                 01274000
IOPQFEND EQU   IOPQFMNT+2                                               01275000
IOPQFMVR EQU   IOPQFEND                                                 01276000
IOPQFMLS EQU   IOPQFMVR                                                 01277000
IOPQFMNM EQU   IOPQFMLS                                                 01278000
IOPPTSYS EQU   IOPUDATA                                                 01279000
IOPPTSDR EQU   IOPPTSYS                                                 01280000
IOPPTSFX EQU   IOPPTSYS+24                                              01281000
IOPDSSPC EQU   IOPPTSFX                                                 01282000
IOPPTFG1 EQU   IOPPTSFX+34                                              01283000
IOPPSEND EQU   IOPPTSYS+1064                                            01284000
IOPPTSVR EQU   IOPPSEND                                                 01285000
IOPPTNTR EQU   IOPPTSVR                                                 01286000
@NM00166 EQU   IOPPTNTR                                                 01287000
IOPPTFMD EQU   @NM00166                                                 01288000
IOPPTREL EQU   IOPPTFMD                                                 01289000
IOPBPDS  EQU   IOPUDATA                                                 01290000
IOPBLEP1 EQU   IOPBPDS+8                                                01291000
IOPBLEP2 EQU   IOPBPDS+9                                                01292000
@NM00170 EQU   IOPBPDS+18                                               01293000
IOPBFTB0 EQU   @NM00170                                                 01294000
IOPBFTB1 EQU   IOPBFTB0                                                 01295000
PRLDATA  EQU   PRLEND                                                   01296000
MSGHDR   EQU   PRLDATA                                                  01297000
MSGHDRNO EQU   MSGHDR+3                                                 01298000
MSGHDRZN EQU   MSGHDRNO+2                                               01299000
MSGHDRSV EQU   MSGHDR+6                                                 01300000
MSGHDRHL EQU   MSGHDR+8                                                 01301000
MSGNDX   EQU   MGPMGNO1                                                 01302000
WTPMSG   EQU   WTOLST                                                   01303000
WTPLEN   EQU   WTPMSG                                                   01304000
WTPTXT   EQU   WTPMSG+4                                                 01305000
WTOMSG   EQU   WTOLST                                                   01306000
WTOLEN   EQU   WTOMSG                                                   01307000
WTOTXT   EQU   WTOMSG+4                                                 01308000
WTORMSG  EQU   WTORLST                                                  01309000
WTORRLN  EQU   WTORMSG                                                  01310000
WTORTXT  EQU   WTORMSG+12                                               01311000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01312000
@NM00184 EQU   WTORMSG+10                                               01313000
WTORTLN  EQU   WTORMSG+8                                                01314000
WTORECB  EQU   WTORMSG+4                                                01315000
WTORRAD  EQU   WTORMSG+1                                                01316000
@NM00183 EQU   WTOMSG+2                                                 01317000
@NM00182 EQU   WTPMSG+2                                                 01318000
@NM00180 EQU   MSGHDR+10                                                01319000
@NM00179 EQU   MSGHDR+7                                                 01320000
@NM00178 EQU   MSGHDRNO                                                 01321000
@NM00177 EQU   MSGHDR                                                   01322000
IOPBCEND EQU   IOPBPDS+21                                               01323000
IOPBFTB3 EQU   IOPBFTB0+2                                               01324000
IOPBFTB2 EQU   IOPBFTB0+1                                               01325000
@NM00172 EQU   IOPBFTB1                                                 01326000
IOPBAPFP EQU   IOPBFTB1                                                 01327000
IOPBSSI  EQU   IOPBFTB1                                                 01328000
IOPBPAGA EQU   IOPBFTB1                                                 01329000
@NM00171 EQU   IOPBFTB1                                                 01330000
IOPBAOSL EQU   IOPBFTB1                                                 01331000
IOPBSEPA EQU   IOPBPDS+15                                               01332000
IOPBFTBL EQU   IOPBPDS+13                                               01333000
IOPBSTOR EQU   IOPBPDS+10                                               01334000
IOPBREFR EQU   IOPBLEP2                                                 01335000
IOPBLEF  EQU   IOPBLEP2                                                 01336000
IOPBTEST EQU   IOPBLEP2                                                 01337000
IOPBNE   EQU   IOPBLEP2                                                 01338000
@NM00169 EQU   IOPBLEP2                                                 01339000
IOPBDC   EQU   IOPBLEP2                                                 01340000
@NM00168 EQU   IOPBLEP1                                                 01341000
IOPBSCTR EQU   IOPBLEP1                                                 01342000
IOPBOL   EQU   IOPBLEP1                                                 01343000
@NM00167 EQU   IOPBLEP1                                                 01344000
IOPBOVLY EQU   IOPBLEP1                                                 01345000
IOPBREUS EQU   IOPBLEP1                                                 01346000
IOPBRENT EQU   IOPBLEP1                                                 01347000
IOPBNL   EQU   IOPBPDS+7                                                01348000
IOPBTTRN EQU   IOPBPDS+4                                                01349000
IOPBZERO EQU   IOPBPDS+3                                                01350000
IOPBTTRT EQU   IOPBPDS                                                  01351000
IOPPTIND EQU   IOPPTNTR+8                                               01352000
IOPPTSND EQU   IOPPTREL                                                 01353000
@NM00165 EQU   IOPPTSFX+872                                             01354000
IOPSYZPP EQU   IOPPTSFX+772                                             01355000
IOPSYZPR EQU   IOPPTSFX+771                                             01356000
IOPSYZPS EQU   IOPPTSFX+763                                             01357000
IOPSYZAP EQU   IOPPTSFX+755                                             01358000
IOPSYUPP EQU   IOPPTSFX+655                                             01359000
IOPSYUPR EQU   IOPPTSFX+654                                             01360000
IOPSYUPS EQU   IOPPTSFX+646                                             01361000
IOPSYUPD EQU   IOPPTSFX+638                                             01362000
IOPSYSPP EQU   IOPPTSFX+538                                             01363000
IOPSYSPR EQU   IOPPTSFX+537                                             01364000
IOPSYSPS EQU   IOPPTSFX+529                                             01365000
IOPSYSUP EQU   IOPPTSFX+521                                             01366000
IOPSYLKP EQU   IOPPTSFX+421                                             01367000
IOPSYLKR EQU   IOPPTSFX+420                                             01368000
IOPSYLKS EQU   IOPPTSFX+412                                             01369000
IOPSYLKD EQU   IOPPTSFX+404                                             01370000
IOPSYCPP EQU   IOPPTSFX+304                                             01371000
IOPSYCPR EQU   IOPPTSFX+303                                             01372000
IOPSYCPS EQU   IOPPTSFX+295                                             01373000
IOPSYCPY EQU   IOPPTSFX+287                                             01374000
IOPSYCOP EQU   IOPPTSFX+187                                             01375000
IOPSYCOR EQU   IOPPTSFX+186                                             01376000
IOPSYCOS EQU   IOPPTSFX+178                                             01377000
IOPSYCOM EQU   IOPPTSFX+170                                             01378000
IOPSYASP EQU   IOPPTSFX+70                                              01379000
IOPSYASR EQU   IOPPTSFX+69                                              01380000
IOPSYASS EQU   IOPPTSFX+61                                              01381000
IOPSYASM EQU   IOPPTSFX+53                                              01382000
@NM00164 EQU   IOPPTSFX+35                                              01383000
@NM00163 EQU   IOPPTFG1                                                 01384000
IOPPTSNJ EQU   IOPPTFG1                                                 01385000
IOPPTSNP EQU   IOPPTFG1                                                 01386000
IOPSYPLN EQU   IOPPTSFX+32                                              01387000
IOPDSPFX EQU   IOPPTSFX+6                                               01388000
IOPDSDIR EQU   IOPDSSPC+4                                               01389000
IOPDSSEC EQU   IOPDSSPC+2                                               01390000
IOPDSPRM EQU   IOPDSSPC                                                 01391000
@NM00162 EQU   IOPPTSDR+4                                               01392000
IOPPTPEM EQU   IOPPTSDR+2                                               01393000
IOPPCNVL EQU   IOPPTSDR+1                                               01394000
@NM00161 EQU   IOPPTSDR                                                 01395000
IOPQFMTP EQU   IOPQFMLS+8                                               01396000
@NM00160 EQU   IOPQFMLS+7                                               01397000
IOPQFMND EQU   IOPQFMNM                                                 01398000
@NM00159 EQU   IOPQFMDR                                                 01399000
@NM00155 EQU   IOPQSMDR                                                 01400000
@NM00154 EQU   IOPSBYNT+8                                               01401000
IOPSBYST EQU   IOPSBYNT+7                                               01402000
IOPSBYNM EQU   IOPSBYNT                                                 01403000
@NM00153 EQU   IOPVERNT+8                                               01404000
IOPVERST EQU   IOPVERNT+7                                               01405000
IOPVERNM EQU   IOPVERNT                                                 01406000
@NM00152 EQU   IOPDELNT+8                                               01407000
IOPDELST EQU   IOPDELNT+7                                               01408000
IOPDELNM EQU   IOPDELNT                                                 01409000
@NM00151 EQU   IOPFIDNT+8                                               01410000
IOPFIDST EQU   IOPFIDNT+7                                               01411000
IOPFIDNM EQU   IOPFIDNT                                                 01412000
@NM00150 EQU   IOPIRQNT+8                                               01413000
IOPIRQST EQU   IOPIRQNT+7                                               01414000
IOPIRQNM EQU   IOPIRQNT                                                 01415000
@NM00149 EQU   IOPREQNT+8                                               01416000
IOPREQST EQU   IOPREQNT+7                                               01417000
IOPREQNM EQU   IOPREQNT                                                 01418000
@NM00148 EQU   IOPSUPNT+8                                               01419000
IOPSUPST EQU   IOPSUPNT+7                                               01420000
IOPSUPNM EQU   IOPSUPNT                                                 01421000
@NM00147 EQU   IOPNPRNT+8                                               01422000
IOPNPRST EQU   IOPNPRNT+7                                               01423000
IOPNPRNM EQU   IOPNPRNT                                                 01424000
@NM00146 EQU   IOPPRENT+8                                               01425000
IOPPREST EQU   IOPPRENT+7                                               01426000
IOPPRENM EQU   IOPPRENT                                                 01427000
@NM00145 EQU   IOPSRLNT+8                                               01428000
IOPSRLST EQU   IOPSRLNT+7                                               01429000
@NM00144 EQU   IOPSRLNT+4                                               01430000
IOPSRLNM EQU   IOPSRLNT                                                 01431000
@NM00143 EQU   IOPENTNT+8                                               01432000
IOPENTST EQU   IOPENTNT+7                                               01433000
IOPENTNM EQU   IOPENTNT                                                 01434000
IOPPIND  EQU   IOPPNTRY+8                                               01435000
IOPPTFND EQU   IOPPMODS                                                 01436000
IOPPFMID EQU   IOPPTFFX+73                                              01437000
@NM00142 EQU   IOPPTPFX+24                                              01438000
IOPUCLT  EQU   IOPDATES+21                                              01439000
IOPUCLD  EQU   IOPDATES+18                                              01440000
IOPACCT  EQU   IOPDATES+15                                              01441000
IOPACCD  EQU   IOPDATES+12                                              01442000
IOPRSTT  EQU   IOPDATES+9                                               01443000
IOPRSTD  EQU   IOPDATES+6                                               01444000
IOPAPPT  EQU   IOPDATES+3                                               01445000
IOPAPPD  EQU   IOPDATES                                                 01446000
IOPRECT  EQU   @NM00141+3                                               01447000
IOPRECD  EQU   @NM00141                                                 01448000
@NM00140 EQU   IOPPTFFX+8                                               01449000
@NM00139 EQU   @NM00137+7                                               01450000
IOPPRELN EQU   @NM00138                                                 01451000
@NM00136 EQU   IOPPTFDR+20                                              01452000
IOPSBYNO EQU   IOPPTFDR+13                                              01453000
IOPDBYNO EQU   IOPPTFDR+6                                               01454000
@NM00135 EQU   IOPPTFF3                                                 01455000
IOPFLF   EQU   IOPPTFF3                                                 01456000
IOPDBYP  EQU   IOPPTFF3                                                 01457000
IOPSBYP  EQU   IOPPTFF3                                                 01458000
IOPPMDLP EQU   IOPPTFF2+1                                               01459000
IOPPADDP EQU   IOPPTFF2+1                                               01460000
@NM00134 EQU   IOPPTFF2+1                                               01461000
IOPLRFP  EQU   IOPPTFF2                                                 01462000
IOPJCLP  EQU   IOPPTFF2                                                 01463000
IOPSUPP  EQU   IOPPTFF2                                                 01464000
IOPREQP  EQU   IOPPTFF2                                                 01465000
IOPPREP  EQU   IOPPTFF2                                                 01466000
IOPNPRP  EQU   IOPPTFF2                                                 01467000
IOPIRQP  EQU   IOPPTFF2                                                 01468000
IOPDELP  EQU   IOPPTFF2                                                 01469000
IOPREGEN EQU   IOPFLGS5                                                 01470000
IOPBYP   EQU   IOPFLGS5                                                 01471000
IOPDUMMP EQU   IOPFLGS5                                                 01472000
@NM00133 EQU   IOPFLGS5                                                 01473000
IOPERROR EQU   IOPFLGS5                                                 01474000
IOPACC   EQU   IOPFLGS5                                                 01475000
IOPRES   EQU   IOPFLGS5                                                 01476000
IOPAPP   EQU   IOPFLGS5                                                 01477000
IOPPTYPE EQU   IOPPTFDR+1                                               01478000
@NM00132 EQU   IOPPTFDR                                                 01479000
IOPSYSTP EQU   IOPSYSTR+8                                               01480000
IOPSYSND EQU   IOPSYNTR                                                 01481000
@NM00131 EQU   IOPSYSFX+21                                              01482000
IOPSYSID EQU   IOPSYSFX+13                                              01483000
IOPNUCID EQU   IOPSYSFX+12                                              01484000
IOPSREL  EQU   IOPSYSFX+8                                               01485000
@NM00130 EQU   @NM00128+7                                               01486000
@NM00129 EQU   @NM00128                                                 01487000
@NM00127 EQU   IOPSYSDR+5                                               01488000
@NM00126 EQU   IOPFLGS7                                                 01489000
IOPSYNG  EQU   IOPFLGS7                                                 01490000
IOPSYDL  EQU   IOPFLGS7                                                 01491000
IOPSTSNP EQU   IOPFLGS7                                                 01492000
IOPMTSNP EQU   IOPFLGS7                                                 01493000
IOPPEMAX EQU   IOPSYSDR+2                                               01494000
IOPSCNVL EQU   IOPSYSDR+1                                               01495000
@NM00125 EQU   IOPSYSDR                                                 01496000
IOPDLIND EQU   IOPDNTRY+8                                               01497000
IOPDLBND EQU   IOPDSYS                                                  01498000
@NM00124 EQU   IOPDLBFX+8                                               01499000
@NM00123 EQU   @NM00121+7                                               01500000
@NM00122 EQU   @NM00121                                                 01501000
@NM00120 EQU   IOPDLBDR+1                                               01502000
@NM00119 EQU   IOPDLBDR                                                 01503000
IOPMDIND EQU   IOPMNTRY+8                                               01504000
@NM00118 EQU   IOPMODST                                                 01505000
IOPMODND EQU   IOPMODID                                                 01506000
IOPDLIB  EQU   IOPMODFX+72                                              01507000
@NM00117 EQU   IOPMODFX+12                                              01508000
@NM00116 EQU   IOPMODF4                                                 01509000
@NM00115 EQU   IOPMODF3                                                 01510000
@NM00114 EQU   IOPMODF2                                                 01511000
IOPMPAGA EQU   IOPMODF2                                                 01512000
IOPMNE   EQU   IOPMODF2                                                 01513000
@NM00113 EQU   IOPMODF1                                                 01514000
IOPMDC   EQU   IOPMODF1                                                 01515000
IOPMREFR EQU   IOPMODF1                                                 01516000
IOPMOVLY EQU   IOPMODF1                                                 01517000
IOPMSCTR EQU   IOPMODF1                                                 01518000
IOPMREUS EQU   IOPMODF1                                                 01519000
IOPMRENT EQU   IOPMODF1                                                 01520000
IOPMAPF  EQU   IOPMODF1                                                 01521000
@NM00112 EQU   @NM00110+7                                               01522000
@NM00111 EQU   @NM00110                                                 01523000
@NM00109 EQU   IOPMODDR+17                                              01524000
@NM00108 EQU   @NM00106+7                                               01525000
@NM00107 EQU   @NM00106                                                 01526000
@NM00105 EQU   @NM00102                                                 01527000
@NM00104 EQU   @NM00102                                                 01528000
@NM00103 EQU   @NM00102                                                 01529000
@NM00101 EQU   @NM00100                                                 01530000
@NM00099 EQU   IOPMODDR                                                 01531000
IOPSRIND EQU   IOPSNTRY+8                                               01532000
@NM00098 EQU   IOPSRCST                                                 01533000
IOPSRCND EQU   IOPSRCID                                                 01534000
IOPSRDLB EQU   IOPSRCFX+72                                              01535000
IOPSRSYS EQU   IOPSRCFX+64                                              01536000
@NM00097 EQU   IOPSRCFX+8                                               01537000
@NM00096 EQU   @NM00094+7                                               01538000
@NM00095 EQU   @NM00094                                                 01539000
@NM00093 EQU   IOPSRCDR+18                                              01540000
IOPSRLNG EQU   IOPSRCDR+17                                              01541000
@NM00092 EQU   @NM00090+7                                               01542000
@NM00091 EQU   @NM00090                                                 01543000
@NM00089 EQU   @NM00086                                                 01544000
@NM00088 EQU   @NM00086                                                 01545000
@NM00087 EQU   @NM00086                                                 01546000
@NM00085 EQU   @NM00084                                                 01547000
@NM00083 EQU   IOPSRCDR                                                 01548000
IOPEOFND EQU   IOPEOFNT                                                 01549000
IOPMCTYP EQU   IOPMCIND                                                 01550000
@NM00082 EQU   IOPMACST                                                 01551000
IOPMACND EQU   IOPMACID                                                 01552000
IOPMCDLB EQU   IOPMACFX+72                                              01553000
IOPMCSYS EQU   IOPMACFX+64                                              01554000
@NM00081 EQU   IOPMACFX+8                                               01555000
IOPBUTYP EQU   IOPBUNT+7                                                01556000
IOPBUSMD EQU   IOPBUNT                                                  01557000
@NM00080 EQU   IOPMACDR+18                                              01558000
IOPMCLNG EQU   IOPMACDR+17                                              01559000
IOPFMST  EQU   IOPFMIDE+7                                               01560000
IOPFMID  EQU   IOPFMIDE                                                 01561000
@NM00079 EQU   IOPRMST                                                  01562000
IOPRMASM EQU   IOPRMST                                                  01563000
@NM00078 EQU   IOPRMST                                                  01564000
IOPRMID  EQU   IOPRMIDE                                                 01565000
@NM00077 EQU   IOPMACDR                                                 01566000
IOPLMIND EQU   IOPLNTRY+8                                               01567000
IOPLMDND EQU   IOPSYSLB                                                 01568000
@NM00075 EQU   @NM00073+7                                               01569000
@NM00074 EQU   @NM00073                                                 01570000
@NM00072 EQU   IOPLMDDR+6                                               01571000
@NM00071 EQU   IOPFLGS3                                                 01572000
IOPCHREP EQU   IOPFLGS3                                                 01573000
IOPLINK  EQU   IOPFLGS3                                                 01574000
IOPCOPY  EQU   IOPFLGS3                                                 01575000
@NM00070 EQU   IOPLMDF4                                                 01576000
@NM00069 EQU   IOPLMDF3                                                 01577000
@NM00068 EQU   IOPLMDF2                                                 01578000
IOPPAGA  EQU   IOPLMDF2                                                 01579000
IOPNE    EQU   IOPLMDF2                                                 01580000
@NM00067 EQU   IOPFLGS2                                                 01581000
IOPDC    EQU   IOPFLGS2                                                 01582000
IOPREFR  EQU   IOPFLGS2                                                 01583000
IOPOVLY  EQU   IOPFLGS2                                                 01584000
IOPSCTR  EQU   IOPFLGS2                                                 01585000
IOPREUS  EQU   IOPFLGS2                                                 01586000
IOPRENT  EQU   IOPFLGS2                                                 01587000
IOPAPF   EQU   IOPFLGS2                                                 01588000
@NM00066 EQU   IOPLMDDR                                                 01589000
@NM00065 EQU   IOPASMDR+9                                               01590000
IOPABUTP EQU   IOPABUNT+7                                               01591000
IOPABUPT EQU   IOPABUNT                                                 01592000
IOPNTLVL EQU   IOPASMDR                                                 01593000
IOPALLOC EQU   @NM00064+4                                               01594000
IOPUSED  EQU   @NM00064                                                 01595000
IOPTPSEQ EQU   @NM00063+8                                               01596000
IOPVLSER EQU   @NM00063+2                                               01597000
IOPBLKSI EQU   @NM00063                                                 01598000
IOPCQMAX EQU   IOPCQMAP+12                                              01599000
@NM00062 EQU   IOPCQMAP+11                                              01600000
@NM00061 EQU   IOPCQMAP+8                                               01601000
@NM00060 EQU   IOPCQMAP                                                 01602000
IOPPTMAX EQU   IOPCDMAX                                                 01603000
@NM00059 EQU   IOPSCMAP+11                                              01604000
@NM00058 EQU   IOPSCMAP+8                                               01605000
@NM00057 EQU   IOPSCMAP                                                 01606000
IOPDIRMX EQU   IOPNTMAX+12                                              01607000
@NM00056 EQU   IOPNTMAX+11                                              01608000
@NM00055 EQU   IOPNTMAX+8                                               01609000
@NM00054 EQU   IOPNTMAX                                                 01610000
@NM00053 EQU   IOPDTYPE                                                 01611000
IOPDMOD  EQU   IOPDTYPE                                                 01612000
IOPDJCL  EQU   IOPDTYPE                                                 01613000
IOPDSRC  EQU   IOPDTYPE                                                 01614000
IOPDMAC  EQU   IOPDTYPE                                                 01615000
IOPSDIR  EQU   IOPSPACE+4                                               01616000
IOPSSCND EQU   IOPSPACE+2                                               01617000
IOPSPRIM EQU   IOPSPACE                                                 01618000
IOPDSN   EQU   IOPDYNDT                                                 01619000
IOPNTYPE EQU   IOPSTCMP+17                                              01620000
IOPNNAME EQU   IOPSTCMP+9                                               01621000
IOPOTYPE EQU   IOPSTCMP+8                                               01622000
IOPONAME EQU   IOPSTCMP                                                 01623000
IOPISEQ3 EQU   IOPINAM3+6                                               01624000
IOPITYP3 EQU   @NM00052+5                                               01625000
IOPIPTF3 EQU   @NM00052                                                 01626000
@NM00002 EQU   MGPFIXED+9                                               01627000
@NM00001 EQU   MGPFLAGS                                                 01628000
MGPMGNO3 EQU   MGPCLEAR+4                                               01629000
MGPMGNO2 EQU   MGPCLEAR+2                                               01630000
CCAEND   EQU   HMASMCCA+371                                             01631000
@NM00026 EQU   HMASMCCA+309                                             01632000
CCACURDD EQU   CCAFDSNG+3                                               01633000
CCACURDS EQU   CCAFDSNG+2                                               01634000
@NM00025 EQU   CCAFLAGB                                                 01635000
CCAFMID  EQU   HMASMCCA+291                                             01636000
CCALSTDS EQU   CCAFCTL+8                                                01637000
CCARPTDS EQU   CCAFCTL+7                                                01638000
CCATIME  EQU   CCAFCTL+4                                                01639000
CCADATE  EQU   CCAFCTL+1                                                01640000
@NM00024 EQU   CCAFLAG9                                                 01641000
CCARVCAN EQU   CCAFLAG9                                                 01642000
CCARVEST EQU   CCAFLAG9                                                 01643000
CCAPTSNJ EQU   CCAFLAG9                                                 01644000
CCASTSNP EQU   CCAFLAG9                                                 01645000
CCAMTSNP EQU   CCAFLAG9                                                 01646000
CCAPTSNP EQU   CCAFLAG9                                                 01647000
@NM00023 EQU   CCAFLAG8                                                 01648000
CCAACDSC EQU   CCAFLAG8                                                 01649000
CCACDSC  EQU   CCAFLAG8                                                 01650000
@NM00022 EQU   CCAFLAG6                                                 01651000
CCAACRUP EQU   CCAFLAG6                                                 01652000
CCACRQUP EQU   CCAFLAG6                                                 01653000
CCAACDUP EQU   CCAFLAG6                                                 01654000
CCACDSUP EQU   CCAFLAG6                                                 01655000
@NM00021 EQU   CCAFLAG5                                                 01656000
CCAACROS EQU   CCAFLAG5                                                 01657000
CCACRQOS EQU   CCAFLAG5                                                 01658000
CCAACDOS EQU   CCAFLAG5                                                 01659000
CCACDSOS EQU   CCAFLAG5                                                 01660000
@NM00020 EQU   CCAFLAG4                                                 01661000
CCAACRIS EQU   CCAFLAG4                                                 01662000
CCACRQIS EQU   CCAFLAG4                                                 01663000
CCAACDIS EQU   CCAFLAG4                                                 01664000
CCACDSIS EQU   CCAFLAG4                                                 01665000
@NM00019 EQU   CCAFLAG3+1                                               01666000
CCARGNP  EQU   CCAFLAG3+1                                               01667000
CCADISRQ EQU   CCAFLAG3+1                                               01668000
CCAICTOK EQU   CCAFLAG3                                                 01669000
CCADELP  EQU   CCAFLAG3                                                 01670000
CCACMPRS EQU   CCAFLAG3                                                 01671000
CCAZAPP  EQU   CCAFLAG3                                                 01672000
CCALINKP EQU   CCAFLAG3                                                 01673000
CCACOPYP EQU   CCAFLAG3                                                 01674000
CCAASIP  EQU   CCAFLAG3                                                 01675000
CCAUPDP  EQU   CCAFLAG3                                                 01676000
CCAEOSMP EQU   CCAFLAG2                                                 01677000
CCAEOFNC EQU   CCAFLAG2                                                 01678000
@NM00018 EQU   CCAFLAG2                                                 01679000
CCACHECK EQU   CCAFLAG2                                                 01680000
CCASVCLB EQU   CCAFLAG2                                                 01681000
CCANCPTF EQU   CCAFLAG2                                                 01682000
@NM00017 EQU   CCAFLAG1+1                                               01683000
CCAUNL   EQU   CCAFLAG1+1                                               01684000
CCARESET EQU   CCAFLAG1+1                                               01685000
CCALOG   EQU   CCAFLAG1+1                                               01686000
CCACNV   EQU   CCAFLAG1+1                                               01687000
CCALIST  EQU   CCAFLAG1                                                 01688000
CCAUPDU  EQU   CCAFLAG1                                                 01689000
CCAUPDJ  EQU   CCAFLAG1                                                 01690000
CCARES   EQU   CCAFLAG1                                                 01691000
CCAREJ   EQU   CCAFLAG1                                                 01692000
CCAACCPT EQU   CCAFLAG1                                                 01693000
CCAAPPLY EQU   CCAFLAG1                                                 01694000
CCAREC   EQU   CCAFLAG1                                                 01695000
CCAFUNCT EQU   CCAFFUNC                                                 01696000
@NM00016 EQU   @NM00011+18                                              01697000
@NM00015 EQU   @NM00011+16                                              01698000
CCATBLPA EQU   @NM00011+12                                              01699000
@NM00014 EQU   @NM00011+8                                               01700000
@NM00013 EQU   @NM00011+4                                               01701000
@NM00012 EQU   @NM00011                                                 01702000
CCAIFGTP EQU   CCAFGTP+16                                               01703000
CCAGTP3  EQU   CCAFGTP+12                                               01704000
CCAGTP2  EQU   CCAFGTP+8                                                01705000
CCAGTP1  EQU   CCAFGTP+4                                                01706000
CCASETAD EQU   CCASEGTP                                                 01707000
CCACLST  EQU   CCAFPGM+12                                               01708000
CCASPDCB EQU   CCAFPGM+8                                                01709000
CCAICLMD EQU   CCAFICT+12                                               01710000
CCAICMOD EQU   CCAFICT+8                                                01711000
CCAICPTF EQU   CCAFICT+4                                                01712000
CCAICT   EQU   CCAFICT                                                  01713000
CCARVAD  EQU   CCAFSTA                                                  01714000
CCAACDID EQU   CCAFSYS+32                                               01715000
CCACDSID EQU   CCAFSYS+24                                               01716000
CCALNLEN EQU   CCAFSYS+22                                               01717000
@NM00010 EQU   CCAFLAGA                                                 01718000
CCAPSYSF EQU   CCAFLAGA                                                 01719000
CCAASYSF EQU   CCAFLAGA                                                 01720000
CCACSYSF EQU   CCAFLAGA                                                 01721000
CCANUCID EQU   CCAFSYS+20                                               01722000
CCAASREL EQU   CCAFSYS+16                                               01723000
CCACSREL EQU   CCASREL                                                  01724000
CCAPEMAX EQU   CCAFSYS+10                                               01725000
CCAPGLEN EQU   CCAFSYS+8                                                01726000
CCAIOPAS EQU   CCAFSYS+4                                                01727000
CCAIOPCS EQU   CCAFSYS                                                  01728000
CCAPESIZ EQU   CCAFIOP+4                                                01729000
CCAIOPTR EQU   CCAFIOP                                                  01730000
@NM00009 EQU   CCAFLAG7+3                                               01731000
CCALOGP  EQU   CCAFLAG7+2                                               01732000
CCAOUTP  EQU   CCAFLAG7+2                                               01733000
CCASLBP  EQU   CCAFLAG7+2                                               01734000
CCAJCLP  EQU   CCAFLAG7+2                                               01735000
CCAPTFP  EQU   CCAFLAG7+2                                               01736000
CCATLBP  EQU   CCAFLAG7+2                                               01737000
CCAUT3P  EQU   CCAFLAG7+1                                               01738000
CCAUT2P  EQU   CCAFLAG7+1                                               01739000
CCAUT1P  EQU   CCAFLAG7+1                                               01740000
CCAWK5P  EQU   CCAFLAG7+1                                               01741000
CCAWK4P  EQU   CCAFLAG7+1                                               01742000
CCAWK3P  EQU   CCAFLAG7+1                                               01743000
CCAWK2P  EQU   CCAFLAG7+1                                               01744000
CCAWK1P  EQU   CCAFLAG7+1                                               01745000
CCAACRQP EQU   CCAFLAG7                                                 01746000
CCACRQP  EQU   CCAFLAG7                                                 01747000
CCASTSP  EQU   CCAFLAG7                                                 01748000
CCAMTSP  EQU   CCAFLAG7                                                 01749000
CCAPTSP  EQU   CCAFLAG7                                                 01750000
CCASCDSP EQU   CCAFLAG7                                                 01751000
CCAACDSP EQU   CCAFLAG7                                                 01752000
CCACDSP  EQU   CCAFLAG7                                                 01753000
@NM00008 EQU   CCAFBUFR+122                                             01754000
@NM00007 EQU   CCAFBUFR+120                                             01755000
@NM00006 EQU   CCAFBUFR+118                                             01756000
CCATBFMX EQU   CCAFBUFR+116                                             01757000
CCA4BFMX EQU   CCAFBUFR+114                                             01758000
CCA3BFMX EQU   CCAFBUFR+112                                             01759000
CCA2BFMX EQU   CCAFBUFR+110                                             01760000
CCA1BFMX EQU   CCAFBUFR+108                                             01761000
CCAXBFMX EQU   CCAFBUFR+106                                             01762000
CCAQBFMX EQU   CCAFBUFR+104                                             01763000
CCASBFMX EQU   CCAFBUFR+102                                             01764000
CCAMBFMX EQU   CCAFBUFR+100                                             01765000
CCAPBFMX EQU   CCAFBUFR+98                                              01766000
CCAVBFMX EQU   CCAFBUFR+96                                              01767000
CCAABFMX EQU   CCAFBUFR+94                                              01768000
CCACBFMX EQU   CCAFBUFR+92                                              01769000
@NM00005 EQU   CCAFBUFR+88                                              01770000
@NM00004 EQU   CCAFBUFR+84                                              01771000
CCA4BFSZ EQU   CCAFBUFR+80                                              01772000
CCATBFSZ EQU   CCAFBUFR+76                                              01773000
CCAWBFSZ EQU   CCAFBUFR+72                                              01774000
CCAQBFSZ EQU   CCAFBUFR+68                                              01775000
CCAPBFSZ EQU   CCAFBUFR+64                                              01776000
CCAVBFSZ EQU   CCAFBUFR+60                                              01777000
CCACBFSZ EQU   CCAFBUFR+56                                              01778000
@NM00003 EQU   CCAFBUFR+52                                              01779000
CCA4BFOA EQU   CCAFBUFR+48                                              01780000
CCA4BFIA EQU   CCAFBUFR+44                                              01781000
CCATBFIA EQU   CCAFBUFR+40                                              01782000
CCAWBFOA EQU   CCAFBUFR+36                                              01783000
CCAWBFIA EQU   CCAFBUFR+32                                              01784000
CCAQBFOA EQU   CCAFBUFR+28                                              01785000
CCAQBFIA EQU   CCAFBUFR+24                                              01786000
CCAPBFOA EQU   CCAFBUFR+20                                              01787000
CCAPBFIA EQU   CCAFBUFR+16                                              01788000
CCAVBFOA EQU   CCAFBUFR+12                                              01789000
CCAVBFIA EQU   CCAFBUFR+8                                               01790000
CCACBFOA EQU   CCAFBUFR+4                                               01791000
CCACBFIA EQU   CCAFBUFR                                                 01792000
CCAID    EQU   HMASMCCA                                                 01793000
@NM00176 EQU   SVMAP+12                                                 01794000
@NM00175 EQU   SVMAP                                                    01795000
PRLCONC  EQU   PRLTIME+2                                                01796000
@NM00174 EQU   PRLTIME                                                  01797000
PRLHDADR EQU   PRLDATE                                                  01798000
@NM00173 EQU   PRLFLGS                                                  01799000
PRLBLANK EQU   PRLFLGS                                                  01800000
PRLHEADO EQU   PRLFLGS                                                  01801000
PRLHEAD  EQU   PRLFLGS                                                  01802000
IOPBS04E EQU   IOPBS04+2                                                01803000
IOPBAPFC EQU   IOPBAPF+1                                                01804000
IOPBAPFL EQU   IOPBAPF                                                  01805000
IOPBS2NM EQU   IOPBS02+3                                                01806000
IOPBS2EP EQU   IOPBS02                                                  01807000
IOPQSMTP EQU   IOPQSMLS+8                                               01808000
@NM00158 EQU   IOPQSMLS+7                                               01809000
IOPQSMND EQU   IOPQSMNM                                                 01810000
@NM00157 EQU   @NM00156+7                                               01811000
IOPQSMFM EQU   @NM00156                                                 01812000
@NM00076 EQU   IOPLMCTL+17                                              01813000
IOPLMCRD EQU   IOPLMCTL+9                                               01814000
IOPLMCRN EQU   IOPLMCTL+1                                               01815000
IOPLMCC  EQU   IOPLMCTL                                                 01816000
@NM00051 EQU   IOPUSERL                                                 01817000
@NM00050 EQU   IOPUSERL                                                 01818000
IOPALIS  EQU   IOPUSERL                                                 01819000
IOPTTR   EQU   IOPDRMAP+8                                               01820000
IOPINAM2 EQU   IOPINAM+1                                                01821000
IOPITYP2 EQU   IOPITYP                                                  01822000
@NM00049 EQU   HMASMIOP+32                                              01823000
IOPDELDD EQU   IOPDDNAM                                                 01824000
@NM00048 EQU   @NM00045+10                                              01825000
IOPSEQNO EQU   @NM00045+8                                               01826000
@NM00047 EQU   @NM00046+7                                               01827000
IOPPTFNM EQU   @NM00046                                                 01828000
IOPNAM17 EQU   IOPNAME                                                  01829000
IOPTYPE  EQU   HMASMIOP+3                                               01830000
CCABMREC EQU   CCABELMT+10                                              01831000
CCABPOS  EQU   CCABMPOS+8                                               01832000
CCABNAME EQU   CCABMPOS                                                 01833000
@NM00044 EQU   CCABLDLM+2                                               01834000
@NM00043 EQU   CCABLDLM                                                 01835000
CCAUPDPM EQU   @NM00041+24                                              01836000
@NM00042 EQU   @NM00041+21                                              01837000
CCARUPDT EQU   CCAUPDRC                                                 01838000
CCAUPDSP EQU   @NM00041+12                                              01839000
CCAUPDTE EQU   @NM00041+8                                               01840000
CCAUPDNM EQU   @NM00041                                                 01841000
CCASUPPM EQU   @NM00039+24                                              01842000
@NM00040 EQU   @NM00039+21                                              01843000
CCARSUP  EQU   CCASUPRC                                                 01844000
CCASUPSP EQU   @NM00039+12                                              01845000
CCAIOSUP EQU   @NM00039+8                                               01846000
CCASUPNM EQU   @NM00039                                                 01847000
CCAZAPPM EQU   @NM00037+24                                              01848000
@NM00038 EQU   @NM00037+21                                              01849000
CCARZAP  EQU   CCAZAPRC                                                 01850000
CCAZAPSP EQU   @NM00037+12                                              01851000
CCASPZAP EQU   @NM00037+8                                               01852000
CCAZAPNM EQU   @NM00037                                                 01853000
CCACOMPM EQU   @NM00035+24                                              01854000
@NM00036 EQU   @NM00035+21                                              01855000
CCARCOMP EQU   CCACOMRC                                                 01856000
CCACOMSP EQU   @NM00035+12                                              01857000
CCACOMRS EQU   @NM00035+8                                               01858000
CCACOMNM EQU   @NM00035                                                 01859000
CCACPYPM EQU   @NM00033+24                                              01860000
@NM00034 EQU   @NM00033+21                                              01861000
CCARCOPY EQU   CCACPYRC                                                 01862000
CCACPYSP EQU   @NM00033+12                                              01863000
CCACOPY  EQU   @NM00033+8                                               01864000
CCACPYNM EQU   @NM00033                                                 01865000
CCAASMPM EQU   @NM00031+24                                              01866000
@NM00032 EQU   @NM00031+21                                              01867000
CCARASM  EQU   CCAASMRC                                                 01868000
CCAASMSP EQU   @NM00031+12                                              01869000
CCAASM   EQU   @NM00031+8                                               01870000
CCAASMNM EQU   @NM00031                                                 01871000
CCALKDPM EQU   @NM00029+24                                              01872000
@NM00030 EQU   @NM00029+21                                              01873000
CCARLINK EQU   CCALKDRC                                                 01874000
CCALKDSP EQU   @NM00029+12                                              01875000
CCALKED  EQU   @NM00029+8                                               01876000
CCALKDNM EQU   @NM00029                                                 01877000
CCAPGMPM EQU   @NM00027+24                                              01878000
@NM00028 EQU   @NM00027+21                                              01879000
CCABPGRC EQU   @NM00027+20                                              01880000
CCABPGSP EQU   @NM00027+12                                              01881000
CCABPGAD EQU   @NM00027+8                                               01882000
CCABPGNM EQU   @NM00027                                                 01883000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01884000
@RT00187 EQU   @EL00001                                                 01885000
@RF00241 EQU   NEXTCHAR                                                 01886000
@ENDDATA EQU   *                                                        01887000
         END   HMASMMSG,(C'PLS2101',0802,78334)                         01888000
