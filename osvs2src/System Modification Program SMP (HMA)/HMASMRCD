         TITLE 'HMASMRCD - LOAD RELFILES TO TLIB DATASETS'              00001000
HMASMRCD CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'HMASMRCD  78.334'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00009000
         BALR  @10,0                                               0001 00010000
@PSTART  LA    @12,4095(,@10)                                      0001 00011000
         USING @PSTART,@10                                         0001 00012000
         USING @PSTART+4095,@12                                    0001 00013000
         ST    @13,@SA00001+4                                      0001 00014000
         LA    @14,@SA00001                                        0001 00015000
         ST    @14,8(,@13)                                         0001 00016000
         LR    @13,@14                                             0001 00017000
         MVC   @PC00001(4),0(@01)                                  0001 00018000
*   RECXLAST=0;                     /* CLEAR CODE PASSED TO RECEIVE  */ 00019000
         L     @05,@PC00001                                        0209 00020000
         SLR   @09,@09                                             0209 00021000
         ST    @09,RECXLAST(,@05)                                  0209 00022000
*   HMASMMGP=''B;                   /* CLEAR HMASMMSG PARM BLOCK     */ 00023000
         XC    HMASMMGP(24),HMASMMGP                               0210 00024000
*   SPLPMAD=ADDR(LOCSPL);           /* SET UP ADDRESS OF LOCAL DSN   */ 00025000
         LA    @09,LOCSPL                                          0211 00026000
         ST    @09,SPLPMAD                                         0211 00027000
*   IOPPTR=RECXIOPG;                /* SET UP DEFAULT IOP PTR        */ 00028000
         L     IOPPTR,RECXIOPG(,@05)                               0212 00029000
*   LSW=''B;                        /* RESET LOCAL SWITCHES          */ 00030000
*                                                                  0213 00031000
         MVI   LSW,X'00'                                           0213 00032000
*   /*****************************************************************/ 00033000
*   /*                                                               */ 00034000
*   /* RESTART RELFILE GTA FILE FROM THE BEGINNING AND GET THE FIRST */ 00035000
*   /* RECORD                                                        */ 00036000
*   /*                                                               */ 00037000
*   /*****************************************************************/ 00038000
*                                                                  0214 00039000
*   RFY                                                            0214 00040000
*     HMASMGTP BASED(RECXGRFP);     /* ADDRESS RELFILE GTP           */ 00041000
*   GTPFUNCT=GTPOPENN;              /* RESTART FROM BEGINNING        */ 00042000
         L     @05,RECXGRFP(,@05)                                  0215 00043000
         MVI   GTPFUNCT(@05),X'01'                                 0215 00044000
*   CALL HMASMGTA(HMASMGTP);        /* GET TO BEGINNING OF FILE      */ 00045000
         ST    @05,@AL00001                                        0216 00046000
         L     @15,@CV01465                                        0216 00047000
         LA    @01,@AL00001                                        0216 00048000
         BALR  @14,@15                                             0216 00049000
*   GTPFUNCT=GTPGETN;               /* SET UP TO GET NEXT RECORD     */ 00050000
         L     @05,@PC00001                                        0217 00051000
         L     @05,RECXGRFP(,@05)                                  0217 00052000
         MVI   GTPFUNCT(@05),X'08'                                 0217 00053000
*   CALL HMASMGTA(HMASMGTP);        /* GET FIRST RECORD              */ 00054000
         ST    @05,@AL00001                                        0218 00055000
         L     @15,@CV01465                                        0218 00056000
         LA    @01,@AL00001                                        0218 00057000
         BALR  @14,@15                                             0218 00058000
*   IF GTPRETRN>=GTPEOF THEN        /* IF END OF FILE THEN           */ 00059000
         L     @05,@PC00001                                        0219 00060000
         L     @05,RECXGRFP(,@05)                                  0219 00061000
         CLI   GTPRETRN(@05),4                                     0219 00062000
         BL    @RF00219                                            0219 00063000
*     EOFSW=ON;                     /* POST EOF SW                   */ 00064000
         OI    EOFSW,B'00100000'                                   0220 00065000
*                                                                  0221 00066000
*   /*****************************************************************/ 00067000
*   /*                                                               */ 00068000
*   /* GO THRU ALL RELFILE GTA RECORDS                               */ 00069000
*   /*                                                               */ 00070000
*   /*****************************************************************/ 00071000
*                                                                  0221 00072000
*   DO WHILE EOFSW=OFF              /* ALL RECORDS NOT PROCESSED     */ 00073000
*         &RECXLAST<STOPFUNC;       /* NO TERMINATING ERRORS         */ 00074000
*                                                                  0221 00075000
@RF00219 B     @DE00221                                            0221 00076000
@DL00221 DS    0H                                                  0222 00077000
*     /***************************************************************/ 00078000
*     /*                                                             */ 00079000
*     /* GET ALL ELEMENTS TO BE LOADED FROM NEXT RELFILE             */ 00080000
*     /*                                                             */ 00081000
*     /***************************************************************/ 00082000
*                                                                  0222 00083000
*     CALL ELEMPROC(SUBRC);         /* GET ELEMENTS NEXT RELFILE     */ 00084000
         LA    @01,@AL00222                                        0222 00085000
         BAL   @14,ELEMPROC                                        0222 00086000
*     RECXLAST=MAX(RECXLAST,SUBRC); /* MAINTAIN MAX RETURN CODE      */ 00087000
         L     @05,@PC00001                                        0223 00088000
         L     @09,SUBRC                                           0223 00089000
         L     @08,RECXLAST(,@05)                                  0223 00090000
         CR    @08,@09                                             0223 00091000
         BNL   *+6                                                      00092000
         LR    @08,@09                                             0223 00093000
         ST    @08,RECXLAST(,@05)                                  0223 00094000
*     IF CURSYSM=ON                 /* SYSMOD WITH RELFILE ELEMENTS  */ 00095000
*         &SUBRC<STOPPTF            /* NO TERMINATING ERRORS         */ 00096000
*       THEN                                                       0224 00097000
         TM    CURSYSM,B'10000000'                                 0224 00098000
         BNO   @RF00224                                            0224 00099000
         CH    @09,@CH00037                                        0224 00100000
         BNL   @RF00224                                            0224 00101000
*       DO;                                                        0225 00102000
*                                                                  0225 00103000
*         /***********************************************************/ 00104000
*         /*                                                         */ 00105000
*         /* LOAD ALL ELEMENTS FROM THE RELFILE TO TLIB DATASET      */ 00106000
*         /*                                                         */ 00107000
*         /***********************************************************/ 00108000
*                                                                  0226 00109000
*         CALL COPYFILE(SUBRC);     /* LOAD ELEMENTS FROM 1 FILE     */ 00110000
         LA    @01,@AL00226                                        0226 00111000
         BAL   @14,COPYFILE                                        0226 00112000
*         RECXLAST=MAX(RECXLAST,SUBRC);/* MAINTAIN MAX RETURN CODE   */ 00113000
         L     @05,@PC00001                                        0227 00114000
         L     @09,SUBRC                                           0227 00115000
         L     @08,RECXLAST(,@05)                                  0227 00116000
         CR    @08,@09                                             0227 00117000
         BNL   *+6                                                      00118000
         LR    @08,@09                                             0227 00119000
         ST    @08,RECXLAST(,@05)                                  0227 00120000
*         IF SUBRC>0                /* "COPY" ERROR                  */ 00121000
*           THEN                                                   0228 00122000
         LTR   @09,@09                                             0228 00123000
         BNP   @RF00228                                            0228 00124000
*           DO;                                                    0229 00125000
*                                                                  0229 00126000
*             /*******************************************************/ 00127000
*             /*                                                     */ 00128000
*             /* ERROR(S) LOADING RELFILE ELEMENTS                   */ 00129000
*             /*                                                     */ 00130000
*             /*******************************************************/ 00131000
*                                                                  0230 00132000
*             CALL DELSYSM(SUBRC);  /* CLEANUP TLIB DATASETS         */ 00133000
         LA    @01,@AL00230                                        0230 00134000
         BAL   @14,DELSYSM                                         0230 00135000
*             RECXLAST=MAX(RECXLAST,SUBRC);/* MAINTAIN MAX RET CODE  */ 00136000
         L     @05,@PC00001                                        0231 00137000
         L     @09,RECXLAST(,@05)                                  0231 00138000
         L     @08,SUBRC                                           0231 00139000
         CR    @09,@08                                             0231 00140000
         BNL   *+6                                                      00141000
         LR    @09,@08                                             0231 00142000
         ST    @09,RECXLAST(,@05)                                  0231 00143000
*             CURSYSM=OFF;          /* NO SYSMOD BEING PROCESSED     */ 00144000
         NI    CURSYSM,B'01111111'                                 0232 00145000
*           END;                                                   0233 00146000
*         ELSE                                                     0234 00147000
*           DO;                                                    0234 00148000
*                                                                  0234 00149000
         B     @RC00228                                            0234 00150000
@RF00228 DS    0H                                                  0235 00151000
*             /*******************************************************/ 00152000
*             /*                                                     */ 00153000
*             /* NO ERROR(S) LOADING RELFILE ELEMENTS                */ 00154000
*             /*                                                     */ 00155000
*             /*******************************************************/ 00156000
*                                                                  0235 00157000
*             IF NEWSYSM=ON         /* A NEW SYSMOD FOUND IN GTA     */ 00158000
*                 |EOFSW=ON         /* END-OF-FILE FOR GTA FILE      */ 00159000
*               THEN                                               0235 00160000
         TM    NEWSYSM,B'01100000'                                 0235 00161000
         BZ    @RF00235                                            0235 00162000
*               DO;                                                0236 00163000
*                                                                  0236 00164000
*                 /***************************************************/ 00165000
*                 /*                                                 */ 00166000
*                 /* ALL ELEMENTS FOR THE A SYSMOD HAVE BEEN LOADED  */ 00167000
*                 /*                                                 */ 00168000
*                 /***************************************************/ 00169000
*                                                                  0237 00170000
*                 CALL PUTSYSM(SUBRC);/* RE-WRITE PTS SYSMOD ENTRY   */ 00171000
         LA    @01,@AL00237                                        0237 00172000
         BAL   @14,PUTSYSM                                         0237 00173000
*                 RECXLAST=MAX(RECXLAST,SUBRC);/* MAINTAIN R.C.      */ 00174000
         L     @05,@PC00001                                        0238 00175000
         L     @09,SUBRC                                           0238 00176000
         L     @08,RECXLAST(,@05)                                  0238 00177000
         CR    @08,@09                                             0238 00178000
         BNL   *+6                                                      00179000
         LR    @08,@09                                             0238 00180000
         ST    @08,RECXLAST(,@05)                                  0238 00181000
*                 CURSYSM=OFF;      /* NO SYSMOD BEING PROCESSED     */ 00182000
         NI    CURSYSM,B'01111111'                                 0239 00183000
*                 IF SUBRC>0 THEN   /* ERROR(S) WRITING SYSMOD TO PTS*/ 00184000
         LTR   @09,@09                                             0240 00185000
         BNP   @RF00240                                            0240 00186000
*                   CALL DELSYSM(SUBRC);/* CLEANUP TLIB DATASETS     */ 00187000
         LA    @01,@AL00241                                        0241 00188000
         BAL   @14,DELSYSM                                         0241 00189000
*               END;                                               0242 00190000
@RF00240 DS    0H                                                  0243 00191000
*           END;                                                   0243 00192000
@RF00235 DS    0H                                                  0244 00193000
*       END;                                                       0244 00194000
@RC00228 DS    0H                                                  0245 00195000
*   END;                                                           0245 00196000
@RF00224 DS    0H                                                  0245 00197000
@DE00221 TM    EOFSW,B'00100000'                                   0245 00198000
         BNZ   @DC00221                                            0245 00199000
         L     @05,@PC00001                                        0245 00200000
         L     @05,RECXLAST(,@05)                                  0245 00201000
         CH    @05,@CH00034                                        0245 00202000
         BL    @DL00221                                            0245 00203000
@DC00221 DS    0H                                                  0246 00204000
*   IF RECXLAST>=STOPPTF            /* ONE OR MORE SYSMODS FAILED    */ 00205000
*     THEN                                                         0246 00206000
         L     @05,@PC00001                                        0246 00207000
         L     @09,RECXLAST(,@05)                                  0246 00208000
         CH    @09,@CH00037                                        0246 00209000
         BL    @RF00246                                            0246 00210000
*     DO;                                                          0247 00211000
*                                                                  0247 00212000
*       /*************************************************************/ 00213000
*       /*                                                           */ 00214000
*       /* DELETE PTS SYSMOD AND MCS ENTRIES FOR SYSMODS WITH RELFILE*/ 00215000
*       /* ELEMENTS WHICH WERE NOT LOADED                            */ 00216000
*       /*                                                           */ 00217000
*       /*************************************************************/ 00218000
*                                                                  0248 00219000
*       RESPECIFY                                                  0248 00220000
*         HMASMGTP BASED(RECXGSMP); /* ADDRESS SUMMARY GTP           */ 00221000
*       GTPFUNCT=GTPOPENN;          /* RESTART FROM BEGINNING OF FILE*/ 00222000
         L     @05,RECXGSMP(,@05)                                  0249 00223000
         MVI   GTPFUNCT(@05),X'01'                                 0249 00224000
*       CALL HMASMGTA(HMASMGTP);                                   0250 00225000
         ST    @05,@AL00001                                        0250 00226000
         L     @15,@CV01465                                        0250 00227000
         LA    @01,@AL00001                                        0250 00228000
         BALR  @14,@15                                             0250 00229000
*       GTPFUNCT=GTPGETN;           /* SET UP GET NEXT RECORD FUNCT. */ 00230000
         L     @05,@PC00001                                        0251 00231000
         L     @05,RECXGSMP(,@05)                                  0251 00232000
         MVI   GTPFUNCT(@05),X'08'                                 0251 00233000
*       CALL HMASMGTA(HMASMGTP);    /* GET FIRST RECORD              */ 00234000
*                                                                  0252 00235000
         ST    @05,@AL00001                                        0252 00236000
         L     @15,@CV01465                                        0252 00237000
         LA    @01,@AL00001                                        0252 00238000
         BALR  @14,@15                                             0252 00239000
*       /*************************************************************/ 00240000
*       /*                                                           */ 00241000
*       /* GO THRU SUMMARY GTA FILE                                  */ 00242000
*       /*                                                           */ 00243000
*       /*************************************************************/ 00244000
*                                                                  0253 00245000
*       DO WHILE GTPRETRN=GTPGOOD;                                 0253 00246000
         B     @DE00253                                            0253 00247000
@DL00253 DS    0H                                                  0254 00248000
*         IF GSMRLFP=ON             /* RELFILES PRESENT IN SYSMOD    */ 00249000
*             &GSMRLFL=OFF          /* RELFILES NOT LOADED           */ 00250000
*           THEN                                                   0254 00251000
         L     @05,@PC00001                                        0254 00252000
         L     @05,RECXGSMP(,@05)                                  0254 00253000
         L     @05,GTPBUFAD(,@05)                                  0254 00254000
         TM    GSMRLFP(@05),B'01000000'                            0254 00255000
         BNO   @RF00254                                            0254 00256000
         TM    GSMRLFL(@05),B'00100000'                            0254 00257000
         BNZ   @RF00254                                            0254 00258000
*           DO;                                                    0255 00259000
*                                                                  0255 00260000
*             /*******************************************************/ 00261000
*             /*                                                     */ 00262000
*             /* SCRATCH SYSMOD ENTRY FROM PTS                       */ 00263000
*             /*                                                     */ 00264000
*             /*******************************************************/ 00265000
*                                                                  0256 00266000
*             IOPDSID=IOPPTS;       /* SMPPTS DATASET                */ 00267000
         MVI   IOPDSID(IOPPTR),X'06'                               0256 00268000
*             IOPNAME=GSMS#;        /* SYSMOD-ID FROM SUMMARY RECORD */ 00269000
         MVI   IOPNAME+7(IOPPTR),C' '                              0257 00270000
         MVC   IOPNAME(7,IOPPTR),GSMS#(@05)                        0257 00271000
*             IOPTYPE=IOPSMD;       /* ENTRY TYPE - SYSMOD           */ 00272000
         MVI   IOPTYPE(IOPPTR),X'0B'                               0258 00273000
*             IOPFUNCT=IOPSTOWD;    /* FUNCTION - STOW-DELETE ENTRY  */ 00274000
         MVI   IOPFUNCT(IOPPTR),X'53'                              0259 00275000
*             CALL HMASMIO(HMASMIOP);/* SCRATCH SYSMOD ENTRY FROM PTS*/ 00276000
*                                                                  0260 00277000
         ST    IOPPTR,@AL00001                                     0260 00278000
         L     @15,@CV01464                                        0260 00279000
         LA    @01,@AL00001                                        0260 00280000
         BALR  @14,@15                                             0260 00281000
*             /*******************************************************/ 00282000
*             /*                                                     */ 00283000
*             /* SCRATCH MCS ENTRY FROM PTS                          */ 00284000
*             /*                                                     */ 00285000
*             /*******************************************************/ 00286000
*                                                                  0261 00287000
*             IOPTYPE=IOPMCS;       /* ENTRY TYPE - MCS              */ 00288000
         MVI   IOPTYPE(IOPPTR),X'10'                               0261 00289000
*             IOPFUNCT=IOPSTOWD;    /* FUNCTION - STOW-DELETE ENTRY  */ 00290000
         MVI   IOPFUNCT(IOPPTR),X'53'                              0262 00291000
*             CALL HMASMIO(HMASMIOP);/* SCRATCH MCS ENTRY FROM PTS   */ 00292000
         ST    IOPPTR,@AL00001                                     0263 00293000
         L     @15,@CV01464                                        0263 00294000
         LA    @01,@AL00001                                        0263 00295000
         BALR  @14,@15                                             0263 00296000
*             IF GSMLERR=OFF        /* NO APPROPRIATE MSG ISSUED YET */ 00297000
*               THEN                                               0264 00298000
         L     @05,@PC00001                                        0264 00299000
         L     @05,RECXGSMP(,@05)                                  0264 00300000
         L     @05,GTPBUFAD(,@05)                                  0264 00301000
         TM    GSMLERR(@05),B'00000010'                            0264 00302000
         BNZ   @RF00264                                            0264 00303000
*               DO;                                                0265 00304000
*                                                                  0265 00305000
*                 /***************************************************/ 00306000
*                 /*                                                 */ 00307000
*                 /* ISSUE HMA391I FOR SYSMODS WHOSE ELEMENTS WERE   */ 00308000
*                 /* NOT LOADED                                      */ 00309000
*                 /*                                                 */ 00310000
*                 /***************************************************/ 00311000
*                                                                  0266 00312000
*                 HMASMMGP=''B;     /* CLEAR MGP                     */ 00313000
         XC    HMASMMGP(24),HMASMMGP                               0266 00314000
*                 MGPMGNO1=HMA391I; /* SET MESSAGE ID                */ 00315000
         SLR   @05,@05                                             0267 00316000
         IC    @05,HMA391I                                         0267 00317000
         STH   @05,MGPMGNO1                                        0267 00318000
*                 MGPVARPT(1)=ADDR(CURSYSM#);/* SET SYSMOD-ID IN MSG */ 00319000
         LA    @05,CURSYSM#                                        0268 00320000
         ST    @05,MGPVARPT                                        0268 00321000
*                 MGPTYPE=MGPERR;   /* STOP-SYSMOD ERROR             */ 00322000
         MVI   MGPTYPE,X'03'                                       0269 00323000
*                 MGPPRINT=ON;      /* PUT TO SMPOUT                 */ 00324000
*                 MGPHLDS=ON;       /* PUT TO SMPLOG                 */ 00325000
         OI    MGPPRINT,B'10010000'                                0271 00326000
*                 CALL HMASMMSG(HMASMMGP);/* ISSUE MESSAGE           */ 00327000
         L     @15,@CV01466                                        0272 00328000
         LA    @01,@AL00272                                        0272 00329000
         BALR  @14,@15                                             0272 00330000
*               END;                                               0273 00331000
*           END;                                                   0274 00332000
@RF00264 DS    0H                                                  0275 00333000
*         GTPFUNCT=GTPGETN;         /* SET UP TO GET NEXT RECORD     */ 00334000
@RF00254 L     @05,@PC00001                                        0275 00335000
         L     @05,RECXGSMP(,@05)                                  0275 00336000
         MVI   GTPFUNCT(@05),X'08'                                 0275 00337000
*         CALL HMASMGTA(HMASMGTP);  /* GET NEXT SUMMARY RECORD       */ 00338000
         ST    @05,@AL00001                                        0276 00339000
         L     @15,@CV01465                                        0276 00340000
         LA    @01,@AL00001                                        0276 00341000
         BALR  @14,@15                                             0276 00342000
*       END;                                                       0277 00343000
@DE00253 L     @05,@PC00001                                        0277 00344000
         L     @05,RECXGSMP(,@05)                                  0277 00345000
         CLI   GTPRETRN(@05),0                                     0277 00346000
         BE    @DL00253                                            0277 00347000
*     END;                                                         0278 00348000
*   RETURN CODE(RECXLAST);          /* PASS THE RETURN CODE          */ 00349000
@RF00246 L     @09,@PC00001                                        0279 00350000
         L     @15,RECXLAST(,@09)                                  0279 00351000
         L     @13,4(,@13)                                         0279 00352000
         L     @14,12(,@13)                                        0279 00353000
         LM    @00,@12,20(@13)                                     0279 00354000
         BR    @14                                                 0279 00355000
*                                                                  0280 00356000
*/********************************************************************/ 00357000
*/*                                                                  */ 00358000
*/*   ELEMPROC - BUILD "COPY" CONTROL STATEMENTS FOR MEMBERS OF      */ 00359000
*/*              ONE UN-LOADED DATASET  ON RELFILE TAPE              */ 00360000
*/*                                                                  */ 00361000
*/********************************************************************/ 00362000
*                                                                  0280 00363000
*ELEMPROC:                                                         0280 00364000
*   PROC(ELEMRC);                                                  0280 00365000
ELEMPROC STM   @14,@03,@SA00002                                    0280 00366000
         STM   @05,@12,@SA00002+24                                 0280 00367000
         MVC   @PC00002(4),0(@01)                                  0280 00368000
*   DCL                                                            0281 00369000
*     ELEMRC FIXED(31);             /* RETURN CODE PARAMETER         */ 00370000
*   DCL                                                            0282 00371000
*     SUB1RC FIXED(31);             /* R.C. PARM PASSED TO GETSYSM   */ 00372000
*   ELEMRC=0;                       /* INITIALIZE RETURN CODE        */ 00373000
         L     @05,@PC00002                                        0283 00374000
         SLR   @09,@09                                             0283 00375000
         ST    @09,ELEMRC(,@05)                                    0283 00376000
*   NEWSYSM=OFF;                    /* NEW SYSMOD NOT FOUND IN     0284 00377000
*                                      RELFILE GTA FILE              */ 00378000
         NI    NEWSYSM,B'10111111'                                 0284 00379000
*   IF EOFSW=OFF                    /* NOT AT END OF GTA FILE        */ 00380000
*       &GRFFLUSH=ON                /* THIS SYSMOD WAS FLUSHED       */ 00381000
*     THEN                                                         0285 00382000
         TM    EOFSW,B'00100000'                                   0285 00383000
         BNZ   @RF00285                                            0285 00384000
         L     @05,@PC00001                                        0285 00385000
         L     @05,RECXGRFP(,@05)                                  0285 00386000
         L     @05,GTPBUFAD(,@05)                                  0285 00387000
         TM    GRFFLUSH(@05),B'10000000'                           0285 00388000
         BNO   @RF00285                                            0285 00389000
*     DO;                           /* THEN FIND NEXT NON-FLUSHED    */ 00390000
*                                                                  0286 00391000
*       /*************************************************************/ 00392000
*       /*                                                           */ 00393000
*       /* SYSMOD FOUND IN RELFILE GTA IS BEING FLUSHED ... FIND NEXT*/ 00394000
*       /* NON-FLUSHED SYSMOD                                        */ 00395000
*       /*                                                           */ 00396000
*       /*************************************************************/ 00397000
*                                                                  0287 00398000
*       DO UNTIL GRFFLUSH=OFF|      /* SEARCH FOR NON-FLUSHED        */ 00399000
*             EOFSW=ON;             /* SYSMOD OR EOF                 */ 00400000
@DL00287 DS    0H                                                  0288 00401000
*         RFY                                                      0288 00402000
*           HMASMGTP BASED(RECXGRFP);/* REBASE HMASMGTP              */ 00403000
*         DO;                       /* HMASMGPF F(GTPGETN)RLEN(LENGTH   00404000
*                                      (GRFREC))B(RECXGRFP)          */ 00405000
*           GTPFUNCT=GTPGETN;       /* SET UP FUNCTION CODE          */ 00406000
         L     @05,@PC00001                                        0290 00407000
         L     @05,RECXGRFP(,@05)                                  0290 00408000
         MVI   GTPFUNCT(@05),X'08'                                 0290 00409000
*           GTPRCDLN=LENGTH(GRFREC);/* SET UP RLEN                   */ 00410000
         MVC   GTPRCDLN(2,@05),@CH00558                            0291 00411000
*           CALL HMASMGTA(HMASMGTP);/* HAVE FUNCTION PERFORMED       */ 00412000
         ST    @05,@AL00001                                        0292 00413000
         L     @15,@CV01465                                        0292 00414000
         LA    @01,@AL00001                                        0292 00415000
         BALR  @14,@15                                             0292 00416000
*         END;                                                     0293 00417000
*         IF GTPRETRN=GTPEOF THEN   /* IF END OF FILE THEN           */ 00418000
         L     @05,@PC00001                                        0294 00419000
         L     @05,RECXGRFP(,@05)                                  0294 00420000
         CLI   GTPRETRN(@05),4                                     0294 00421000
         BNE   @RF00294                                            0294 00422000
*           EOFSW=ON;               /* POST EOF SW                   */ 00423000
         OI    EOFSW,B'00100000'                                   0295 00424000
*       END;                                                       0296 00425000
@RF00294 DS    0H                                                  0296 00426000
@DE00287 L     @05,@PC00001                                        0296 00427000
         L     @05,RECXGRFP(,@05)                                  0296 00428000
         L     @05,GTPBUFAD(,@05)                                  0296 00429000
         TM    GRFFLUSH(@05),B'10000000'                           0296 00430000
         BZ    @DC00287                                            0296 00431000
         TM    EOFSW,B'00100000'                                   0296 00432000
         BNO   @DL00287                                            0296 00433000
@DC00287 DS    0H                                                  0297 00434000
*     END;                                                         0297 00435000
*   IF EOFSW=OFF                    /* NOT AT END OF GTA FILE        */ 00436000
*     THEN                                                         0298 00437000
@RF00285 TM    EOFSW,B'00100000'                                   0298 00438000
         BNZ   @RF00298                                            0298 00439000
*     DO;                                                          0299 00440000
*       RELFREST=GTPRESTR;          /* SAVE POSITION IN RELFILE GTA     00441000
*                                      ... RELFILE RESTART DATA      */ 00442000
         L     @05,@PC00001                                        0300 00443000
         L     @05,RECXGRFP(,@05)                                  0300 00444000
         MVC   RELFREST(10),GTPRESTR(@05)                          0300 00445000
*       ABSFSEQ=GRFFSEQ;            /* SAVE ABSOLUTE FILE SEQUENCE 0301 00446000
*                                      NUMBER                        */ 00447000
         L     @09,GTPBUFAD(,@05)                                  0301 00448000
         MVC   ABSFSEQ(2),GRFFSEQ(@09)                             0301 00449000
*       IF CURSYSM=OFF              /* NOT CURRENTLY PROCESSING A  0302 00450000
*                                      SYSMOD                        */ 00451000
*         THEN                                                     0302 00452000
         TM    CURSYSM,B'10000000'                                 0302 00453000
         BNZ   @RF00302                                            0302 00454000
*         DO;                                                      0303 00455000
*                                                                  0303 00456000
*           /*********************************************************/ 00457000
*           /*                                                       */ 00458000
*           /* INITIALIZE FOR PROCESSING A NEW SYSMOD ... GET PTS    */ 00459000
*           /* SYSMOD ENTRY AND GTA SUMMARY RECORD                   */ 00460000
*           /*                                                       */ 00461000
*           /*********************************************************/ 00462000
*                                                                  0304 00463000
*           SYSMREST=GTPRESTR;      /* SAVE POSITION IN RELFILE GTA     00464000
*                                      ... SYSMOD RESTART DATA       */ 00465000
         MVC   SYSMREST(10),GTPRESTR(@05)                          0304 00466000
*           CALL GETSYSM(GRFSM#,    /* SYSMOD-ID                     */ 00467000
*               GRFSTY,             /* SYSMOD TYPE                   */ 00468000
*               SUB1RC);            /* RETURN CODE                   */ 00469000
         LA    @05,GRFSM#(,@09)                                    0305 00470000
         ST    @05,@AL00001                                        0305 00471000
         LA    @05,GRFSTY(,@09)                                    0305 00472000
         ST    @05,@AL00001+4                                      0305 00473000
         LA    @05,SUB1RC                                          0305 00474000
         ST    @05,@AL00001+8                                      0305 00475000
         LA    @01,@AL00001                                        0305 00476000
         BAL   @14,GETSYSM                                         0305 00477000
*           ELEMRC=MAX(ELEMRC,SUB1RC);/* SAVE RETURN CODE            */ 00478000
         L     @05,@PC00002                                        0306 00479000
         L     @09,SUB1RC                                          0306 00480000
         L     @08,ELEMRC(,@05)                                    0306 00481000
         CR    @08,@09                                             0306 00482000
         BNL   *+6                                                      00483000
         LR    @08,@09                                             0306 00484000
         ST    @08,ELEMRC(,@05)                                    0306 00485000
*           IF SUB1RC=0 THEN                                       0307 00486000
         LTR   @09,@09                                             0307 00487000
         BNZ   @RF00307                                            0307 00488000
*             DO;                                                  0308 00489000
*               CURSYSM#=GRFSM#;    /* "CURRENT" SYSMOD-ID           */ 00490000
         L     @05,@PC00001                                        0309 00491000
         L     @05,RECXGRFP(,@05)                                  0309 00492000
         L     @05,GTPBUFAD(,@05)                                  0309 00493000
         MVC   CURSYSM#(7),GRFSM#(@05)                             0309 00494000
*               CURSYSM=ON;         /* PROCESSING SYSMOD             */ 00495000
         OI    CURSYSM,B'10000000'                                 0310 00496000
*             END;                                                 0311 00497000
*         END;                                                     0312 00498000
@RF00307 DS    0H                                                  0313 00499000
*       IF ELEMRC=0                 /* STILL GOOD RETURN CODE        */ 00500000
*         THEN                                                     0313 00501000
@RF00302 L     @05,@PC00002                                        0313 00502000
         ICM   @09,15,ELEMRC(@05)                                  0313 00503000
         BNZ   @RF00313                                            0313 00504000
*         DO;                                                      0314 00505000
*                                                                  0314 00506000
*           /*********************************************************/ 00507000
*           /*                                                       */ 00508000
*           /* CONSTRUCT TAPE DATA SET NAME                          */ 00509000
*           /*                                                       */ 00510000
*           /*********************************************************/ 00511000
*                                                                  0315 00512000
*           TAPESYSM=GRFSM#;        /* SET UP SYSMOD                 */ 00513000
         L     @09,@PC00001                                        0315 00514000
         L     @01,RECXGRFP(,@09)                                  0315 00515000
         L     @08,GTPBUFAD(,@01)                                  0315 00516000
         MVC   TAPESYSM(7),GRFSM#(@08)                             0315 00517000
*           TAPERELF=GRFRELF;       /* RELFILE NUMBER                */ 00518000
         MVC   TAPERELF(2),GRFRELF(@08)                            0316 00519000
*           TAPEASEQ=GRFFSEQ;       /* SAVE ABSOLUTE SEQUENCE        */ 00520000
         MVC   TAPEASEQ(2),GRFFSEQ(@08)                            0317 00521000
*           TLIBDSS#=GRFRELF#;      /* SAVE RELFILE (BINARY VALUE) 0318 00522000
*                                      FOR CONSTRUCTION OF TLIB DSN  */ 00523000
*                                                                  0318 00524000
         MVC   TLIBDSS#(2),GRFRELF#(@08)                           0318 00525000
*           /*********************************************************/ 00526000
*           /*                                                       */ 00527000
*           /* WRITE COPY "COPY INDD= ... OUTDD=" STMT. TO SYSUT1    */ 00528000
*           /*                                                       */ 00529000
*           /*********************************************************/ 00530000
*                                                                  0319 00531000
*           CCRELF=GRFRELF;         /* PUT RELFILE ON STMT.          */ 00532000
         MVC   CCRELF(4),GRFRELF(@08)                              0319 00533000
*           CCSMD=GRFSM#;           /* PUT SYSMOD ON STMT.           */ 00534000
         MVC   CCSMD(7),GRFSM#(@08)                                0320 00535000
*           DO;                     /* HMASMRIO F(IOPWRITE)IOP((RECXI   00536000
*                                      OPG))DSID(IOPSCR1)BUFFER(COPYC   00537000
*                                      ARD)                          */ 00538000
*             IOPPTR=(RECXIOPG);    /* SET UP IOP ADDRESS            */ 00539000
         L     IOPPTR,RECXIOPG(,@09)                               0322 00540000
*             IOPFUNCT=IOPWRITE;    /* SET UP FUNCTION CODE          */ 00541000
         MVI   IOPFUNCT(IOPPTR),X'51'                              0323 00542000
*             IOPDSID=IOPSCR1;      /* SET UP DSN CODE               */ 00543000
         MVI   IOPDSID(IOPPTR),X'03'                               0324 00544000
*             IOPBUFAD=ADDR(COPYCARD);/* SET BUFFER ADDRESS          */ 00545000
         LA    @05,COPYCARD                                        0325 00546000
         ST    @05,IOPBUFAD(,IOPPTR)                               0325 00547000
*             CALL HMASMIO(HMASMIOP);/* HAVE I/O PERFORMED           */ 00548000
         ST    IOPPTR,@AL00001                                     0326 00549000
         L     @15,@CV01464                                        0326 00550000
         LA    @01,@AL00001                                        0326 00551000
         BALR  @14,@15                                             0326 00552000
*           END;                                                   0327 00553000
*           ELEMRC=IOPRETRN;        /* SAVE RETURN CODE              */ 00554000
         L     @05,@PC00002                                        0328 00555000
         SLR   @09,@09                                             0328 00556000
         IC    @09,IOPRETRN(,IOPPTR)                               0328 00557000
         ST    @09,ELEMRC(,@05)                                    0328 00558000
*         END;                                                     0329 00559000
*                                                                  0330 00560000
*       /*************************************************************/ 00561000
*       /*                                                           */ 00562000
*       /* SET UP "SELECT MEMBER" STATEMENTS FOR THIS RELFILE        */ 00563000
*       /*                                                           */ 00564000
*       /*************************************************************/ 00565000
*                                                                  0330 00566000
*       COLPTR=ADDR(SCDATA);        /* POINT TO SELECT CARD DATA     */ 00567000
@RF00313 LA    COLPTR,SCDATA                                       0330 00568000
*       SCDATA=' ';                 /* BLANK DATA PORTION OF CARD    */ 00569000
         MVI   SCDATA+1,C' '                                       0331 00570000
         MVC   SCDATA+2(60),SCDATA+1                               0331 00571000
         MVI   SCDATA,C' '                                         0331 00572000
*       FILETYPE=''B;               /* CLEAR FILE TYPE INDICATORS    */ 00573000
         MVI   FILETYPE,X'00'                                      0332 00574000
*       SCSMD=GRFSM#;               /* PUT SYSMOD ON STMT.           */ 00575000
*                                                                  0333 00576000
         L     @09,@PC00001                                        0333 00577000
         L     @01,RECXGRFP(,@09)                                  0333 00578000
         L     @01,GTPBUFAD(,@01)                                  0333 00579000
         MVC   SCSMD(7),GRFSM#(@01)                                0333 00580000
*       /*************************************************************/ 00581000
*       /*                                                           */ 00582000
*       /* GO THRU ALL RELFILE RECORDS FOR "CURRENT" FILE            */ 00583000
*       /*                                                           */ 00584000
*       /*************************************************************/ 00585000
*                                                                  0334 00586000
*       DO WHILE ABSFSEQ=GRFFSEQ    /* PROCESSING SAME PTFIN FILE    */ 00587000
*             &EOFSW=OFF            /* NOT EOF ON RELFILE GTA FILE   */ 00588000
*             &ELEMRC=0;            /* GOOD RETURN CODE              */ 00589000
*                                                                  0334 00590000
         B     @DE00334                                            0334 00591000
@DL00334 DS    0H                                                  0335 00592000
*         /***********************************************************/ 00593000
*         /*                                                         */ 00594000
*         /* SET FILETYPE FLAGS FOR ELEMENT TYPES FOUND ON CURRENT   */ 00595000
*         /* FILE                                                    */ 00596000
*         /*                                                         */ 00597000
*         /***********************************************************/ 00598000
*                                                                  0335 00599000
*         IF GRFELTY=MCBMODTP       /* ++MOD ELEMENT                 */ 00600000
*           THEN                                                   0335 00601000
         L     @09,@PC00001                                        0335 00602000
         L     @01,RECXGRFP(,@09)                                  0335 00603000
         L     @01,GTPBUFAD(,@01)                                  0335 00604000
         CLI   GRFELTY(@01),4                                      0335 00605000
         BNE   @RF00335                                            0335 00606000
*           DMOD=ON;                /* MOD FILE TYPE                 */ 00607000
         OI    DMOD,B'10000000'                                    0336 00608000
*         ELSE                                                     0337 00609000
*           IF GRFELTY=MCBMCRTP     /* ++MAC ELEMENT                 */ 00610000
*             THEN                                                 0337 00611000
         B     @RC00335                                            0337 00612000
@RF00335 L     @09,@PC00001                                        0337 00613000
         L     @01,RECXGRFP(,@09)                                  0337 00614000
         L     @01,GTPBUFAD(,@01)                                  0337 00615000
         CLI   GRFELTY(@01),5                                      0337 00616000
         BNE   @RF00337                                            0337 00617000
*             DMAC=ON;              /* MAC FILE TYPE                 */ 00618000
         OI    DMAC,B'01000000'                                    0338 00619000
*           ELSE                                                   0339 00620000
*             IF GRFELTY=MCBSCRTP   /* ++SRC ELEMENT                 */ 00621000
*               THEN                                               0339 00622000
         B     @RC00337                                            0339 00623000
@RF00337 L     @09,@PC00001                                        0339 00624000
         L     @01,RECXGRFP(,@09)                                  0339 00625000
         L     @01,GTPBUFAD(,@01)                                  0339 00626000
         CLI   GRFELTY(@01),6                                      0339 00627000
         BNE   @RF00339                                            0339 00628000
*               DSRC=ON;            /* SRC FILE TYPE                 */ 00629000
         OI    DSRC,B'00100000'                                    0340 00630000
*             ELSE                                                 0341 00631000
*               IF GRFELTY=MCBJCLTP /* ++JCLIN ELEMENT               */ 00632000
*                 THEN                                             0341 00633000
         B     @RC00339                                            0341 00634000
@RF00339 L     @09,@PC00001                                        0341 00635000
         L     @01,RECXGRFP(,@09)                                  0341 00636000
         L     @01,GTPBUFAD(,@01)                                  0341 00637000
         CLI   GRFELTY(@01),10                                     0341 00638000
         BNE   @RF00341                                            0341 00639000
*                 DJCL=ON;          /* JCLIN FILE TYPE               */ 00640000
*                                                                  0342 00641000
         OI    DJCL,B'00010000'                                    0342 00642000
*         /***********************************************************/ 00643000
*         /*                                                         */ 00644000
*         /* CHECK IF ELEMENT WILL FIT ON CURRENT CARD               */ 00645000
*         /*                                                         */ 00646000
*         /***********************************************************/ 00647000
*                                                                  0343 00648000
*         GRFLOADD=ON;              /* POST ELEMENT LOADED           */ 00649000
@RF00341 DS    0H                                                  0343 00650000
@RC00339 DS    0H                                                  0343 00651000
@RC00337 DS    0H                                                  0343 00652000
@RC00335 L     @09,@PC00001                                        0343 00653000
         L     @01,RECXGRFP(,@09)                                  0343 00654000
         L     @01,GTPBUFAD(,@01)                                  0343 00655000
         OI    GRFLOADD(@01),B'01000000'                           0343 00656000
*         IF ADDR(SCEND)-COLPTR<    /* IF THERE IS NOT ENOUGH ROOM   */ 00657000
*             LENGTH(GRFELEM)+      /* ON CARD FOR ELEMENT AND       */ 00658000
*             LENGTH(REPLACE) THEN  /* REPLACE CODES                 */ 00659000
         LA    @08,SCEND                                           0344 00660000
         SLR   @08,COLPTR                                          0344 00661000
         CH    @08,@CH00341                                        0344 00662000
         BNL   @RF00344                                            0344 00663000
*           DO;                     /* PUT OUT THIS CARD             */ 00664000
*             COLPTR=COLPTR-        /* BACK UP TO COMMA              */ 00665000
*                 LENGTH(CARDCLOS); /* AFTER LAST PARAMETER          */ 00666000
         BCTR  COLPTR,0                                            0346 00667000
         BCTR  COLPTR,0                                            0346 00668000
*             CARDCLOS=') ';        /* CLOSE SUBPARAMETER LIST       */ 00669000
*                                                                  0347 00670000
         MVC   CARDCLOS(2,COLPTR),@CC01636                         0347 00671000
*             /*******************************************************/ 00672000
*             /*                                                     */ 00673000
*             /* WRITE COPY "SELECT MEMBER" STMT. TO SYSUT1 FILE     */ 00674000
*             /*                                                     */ 00675000
*             /*******************************************************/ 00676000
*                                                                  0348 00677000
*             DO;                   /* HMASMRIO F(IOPWRITE)IOP((RECXI   00678000
*                                      OPG))DSID(IOPSCR1)BUFFER(SCARD   00679000
*                                      )                             */ 00680000
*               IOPPTR=(RECXIOPG);  /* SET UP IOP ADDRESS            */ 00681000
         L     IOPPTR,RECXIOPG(,@09)                               0349 00682000
*               IOPFUNCT=IOPWRITE;  /* SET UP FUNCTION CODE          */ 00683000
         MVI   IOPFUNCT(IOPPTR),X'51'                              0350 00684000
*               IOPDSID=IOPSCR1;    /* SET UP DSN CODE               */ 00685000
         MVI   IOPDSID(IOPPTR),X'03'                               0351 00686000
*               IOPBUFAD=ADDR(SCARD);/* SET BUFFER ADDRESS           */ 00687000
         LA    @09,SCARD                                           0352 00688000
         ST    @09,IOPBUFAD(,IOPPTR)                               0352 00689000
*               CALL HMASMIO(HMASMIOP);/* HAVE I/O PERFORMED         */ 00690000
         ST    IOPPTR,@AL00001                                     0353 00691000
         L     @15,@CV01464                                        0353 00692000
         LA    @01,@AL00001                                        0353 00693000
         BALR  @14,@15                                             0353 00694000
*             END;                                                 0354 00695000
*             ELEMRC=IOPRETRN;      /* SAVE RETURN CODE              */ 00696000
         L     @09,@PC00002                                        0355 00697000
         SLR   @08,@08                                             0355 00698000
         IC    @08,IOPRETRN(,IOPPTR)                               0355 00699000
         ST    @08,ELEMRC(,@09)                                    0355 00700000
*             COLPTR=ADDR(SCDATA);  /* RESET POINTER                 */ 00701000
         LA    COLPTR,SCDATA                                       0356 00702000
*             SCDATA=' ';           /* BLANK OUT OLD DATA            */ 00703000
         MVI   SCDATA+1,C' '                                       0357 00704000
         MVC   SCDATA+2(60),SCDATA+1                               0357 00705000
         MVI   SCDATA,C' '                                         0357 00706000
*           END;                                                   0358 00707000
*                                                                  0358 00708000
*         /***********************************************************/ 00709000
*         /*                                                         */ 00710000
*         /* ADD ELEMENT TO CARD                                     */ 00711000
*         /*                                                         */ 00712000
*         /***********************************************************/ 00713000
*                                                                  0359 00714000
*         DO I=1 TO 8 WHILE         /* MOVE UNTIL BLANK FOUND        */ 00715000
*               GRFELEM(I)^=BLANK;  /* OR ALL 8 CHARACTERS MOVED     */ 00716000
@RF00344 LA    I,1                                                 0359 00717000
@DL00359 L     @07,@PC00001                                        0359 00718000
         L     @07,RECXGRFP(,@07)                                  0359 00719000
         L     @07,GTPBUFAD(,@07)                                  0359 00720000
         LR    @01,@07                                             0359 00721000
         ALR   @01,I                                               0359 00722000
         CLI   GRFELEM-1(@01),C' '                                 0359 00723000
         BE    @DC00359                                            0359 00724000
*           CARDCOL=GRFELEM(I);     /* MOVE 1 CHARACTER              */ 00725000
         ALR   @07,I                                               0360 00726000
         MVC   CARDCOL(1,COLPTR),GRFELEM-1(@07)                    0360 00727000
*           COLPTR=COLPTR+1;        /* POINT TO NEXT COLUMN          */ 00728000
         AH    COLPTR,@CH00041                                     0361 00729000
*         END;                                                     0362 00730000
         AH    I,@CH00041                                          0362 00731000
         CH    I,@CH00037                                          0362 00732000
         BNH   @DL00359                                            0362 00733000
@DC00359 DS    0H                                                  0363 00734000
*         CARDREP=REPLACE;          /* POST ,,R),( AFTER ELEMENT     */ 00735000
         MVC   CARDREP(6,COLPTR),@CC01544                          0363 00736000
*         COLPTR=COLPTR+            /* POINT PAST                    */ 00737000
*             LENGTH(REPLACE);      /* CONTROL DATA                  */ 00738000
         AH    COLPTR,@CH00090                                     0364 00739000
*         IF ELEMRC=0               /* STILL GOOD RETURN CODE        */ 00740000
*           THEN                                                   0365 00741000
         L     @09,@PC00002                                        0365 00742000
         ICM   @08,15,ELEMRC(@09)                                  0365 00743000
         BNZ   @RF00365                                            0365 00744000
*           DO;                                                    0366 00745000
*                                                                  0366 00746000
*             /*******************************************************/ 00747000
*             /*                                                     */ 00748000
*             /* GET NEXT RELFILE RECORD FROM THE GTA FILE           */ 00749000
*             /*                                                     */ 00750000
*             /*******************************************************/ 00751000
*                                                                  0367 00752000
*             RFY                                                  0367 00753000
*               HMASMGTP BASED(RECXGRFP);/* REBASE HMASMGTP          */ 00754000
*             DO;                   /* HMASMGPF F(GTPGETN)RLEN(LENGTH   00755000
*                                      (GRFREC))B(RECXGRFP)          */ 00756000
*               GTPFUNCT=GTPGETN;   /* SET UP FUNCTION CODE          */ 00757000
         L     @09,@PC00001                                        0369 00758000
         L     @09,RECXGRFP(,@09)                                  0369 00759000
         MVI   GTPFUNCT(@09),X'08'                                 0369 00760000
*               GTPRCDLN=LENGTH(GRFREC);/* SET UP RLEN               */ 00761000
         MVC   GTPRCDLN(2,@09),@CH00558                            0370 00762000
*               CALL HMASMGTA(HMASMGTP);/* HAVE FUNCTION PERFORMED   */ 00763000
         ST    @09,@AL00001                                        0371 00764000
         L     @15,@CV01465                                        0371 00765000
         LA    @01,@AL00001                                        0371 00766000
         BALR  @14,@15                                             0371 00767000
*             END;                                                 0372 00768000
*             IF GTPRETRN=GTPEOF THEN/* IF END OF FILE THEN          */ 00769000
         L     @09,@PC00001                                        0373 00770000
         L     @01,RECXGRFP(,@09)                                  0373 00771000
         CLI   GTPRETRN(@01),4                                     0373 00772000
         BNE   @RF00373                                            0373 00773000
*               EOFSW=ON;           /* POST EOF SW                   */ 00774000
         OI    EOFSW,B'00100000'                                   0374 00775000
*           END;                                                   0375 00776000
@RF00373 DS    0H                                                  0376 00777000
*       END;                        /* SELECT MEMBER STMTS BUILT FOR    00778000
*                                      ALL ELEMENTS IN RELFILE       */ 00779000
@RF00365 DS    0H                                                  0376 00780000
@DE00334 L     @09,@PC00001                                        0376 00781000
         L     @01,RECXGRFP(,@09)                                  0376 00782000
         L     @01,GTPBUFAD(,@01)                                  0376 00783000
         CLC   ABSFSEQ(2),GRFFSEQ(@01)                             0376 00784000
         BNE   @DC00334                                            0376 00785000
         TM    EOFSW,B'00100000'                                   0376 00786000
         BNZ   @DC00334                                            0376 00787000
         L     @09,@PC00002                                        0376 00788000
         ICM   @08,15,ELEMRC(@09)                                  0376 00789000
         BZ    @DL00334                                            0376 00790000
@DC00334 DS    0H                                                  0377 00791000
*       IF ELEMRC=0                 /* PROCESSING SUCCESSFUL         */ 00792000
*         THEN                                                     0377 00793000
         L     @09,@PC00002                                        0377 00794000
         ICM   @08,15,ELEMRC(@09)                                  0377 00795000
         BNZ   @RF00377                                            0377 00796000
*         DO;                                                      0378 00797000
*                                                                  0378 00798000
*           /*********************************************************/ 00799000
*           /*                                                       */ 00800000
*           /* FINISHED PROCESSING MEMBERS FOR "CURRENT" FILE ...    */ 00801000
*           /* EITHER A NEW RELFILE WAS DETECTED, A NEW-SYSMOD WAS   */ 00802000
*           /* ENCOUNTERED OR THE END OF THE RELFILE GTA FILE WAS    */ 00803000
*           /* ENCOUNTERED                                           */ 00804000
*           /*                                                       */ 00805000
*           /*********************************************************/ 00806000
*                                                                  0379 00807000
*           IF EOFSW=OFF THEN       /* IF NOT END OF FILE THEN       */ 00808000
         TM    EOFSW,B'00100000'                                   0379 00809000
         BNZ   @RF00379                                            0379 00810000
*             DO;                   /* CHECK IF NEW SYSMOD FOUND     */ 00811000
*               IF GRFSM#^=CURSYSM# THEN/* IF SYSMODS DO NOT MATCH   */ 00812000
         L     @04,@PC00001                                        0381 00813000
         L     @04,RECXGRFP(,@04)                                  0381 00814000
         L     @04,GTPBUFAD(,@04)                                  0381 00815000
         CLC   GRFSM#(7,@04),CURSYSM#                              0381 00816000
         BE    @RF00381                                            0381 00817000
*                 NEWSYSM=ON;       /* A NEW SYSMOD FOUND IN GTA     */ 00818000
         OI    NEWSYSM,B'01000000'                                 0382 00819000
*             END;                                                 0383 00820000
@RF00381 DS    0H                                                  0384 00821000
*           IF SCDCOL^=BLANK THEN   /* IF CURRENT CARD CONTAINS      */ 00822000
@RF00379 CLI   SCDCOL,C' '                                         0384 00823000
         BE    @RF00384                                            0384 00824000
*             DO;                   /* DATA THEN PUT OUT CARD        */ 00825000
*               COLPTR=COLPTR-      /* BACK UP TO COMMA              */ 00826000
*                   LENGTH(CARDCLOS);/* AFTER LAST RIGHT PAREN       */ 00827000
         BCTR  COLPTR,0                                            0386 00828000
         BCTR  COLPTR,0                                            0386 00829000
*               CARDCLOS=') ';      /* CLOSE PARAMETER LIST          */ 00830000
*                                                                  0387 00831000
         MVC   CARDCLOS(2,COLPTR),@CC01636                         0387 00832000
*               /*****************************************************/ 00833000
*               /*                                                   */ 00834000
*               /* WRITE LAST COPY "SELECT MEMBER" STMT. TO SYSUT1   */ 00835000
*               /* FILE                                              */ 00836000
*               /*                                                   */ 00837000
*               /*****************************************************/ 00838000
*                                                                  0388 00839000
*               DO;                 /* HMASMRIO F(IOPWRITE)IOP((RECXI   00840000
*                                      OPG))DSID(IOPSCR1)BUFFER(SCARD   00841000
*                                      )                             */ 00842000
*                 IOPPTR=(RECXIOPG);/* SET UP IOP ADDRESS            */ 00843000
         L     @09,@PC00001                                        0389 00844000
         L     IOPPTR,RECXIOPG(,@09)                               0389 00845000
*                 IOPFUNCT=IOPWRITE;/* SET UP FUNCTION CODE          */ 00846000
         MVI   IOPFUNCT(IOPPTR),X'51'                              0390 00847000
*                 IOPDSID=IOPSCR1;  /* SET UP DSN CODE               */ 00848000
         MVI   IOPDSID(IOPPTR),X'03'                               0391 00849000
*                 IOPBUFAD=ADDR(SCARD);/* SET BUFFER ADDRESS         */ 00850000
         LA    @05,SCARD                                           0392 00851000
         ST    @05,IOPBUFAD(,IOPPTR)                               0392 00852000
*                 CALL HMASMIO(HMASMIOP);/* HAVE I/O PERFORMED       */ 00853000
         ST    IOPPTR,@AL00001                                     0393 00854000
         L     @15,@CV01464                                        0393 00855000
         LA    @01,@AL00001                                        0393 00856000
         BALR  @14,@15                                             0393 00857000
*               END;                                               0394 00858000
*               ELEMRC=IOPRETRN;    /* SAVE RETURN CODE              */ 00859000
         L     @05,@PC00002                                        0395 00860000
         SLR   @09,@09                                             0395 00861000
         IC    @09,IOPRETRN(,IOPPTR)                               0395 00862000
         ST    @09,ELEMRC(,@05)                                    0395 00863000
*               SCDATA=' ';         /* BLANK OUT OLD DATA            */ 00864000
         MVI   SCDATA+1,C' '                                       0396 00865000
         MVC   SCDATA+2(60),SCDATA+1                               0396 00866000
         MVI   SCDATA,C' '                                         0396 00867000
*             END;                                                 0397 00868000
*                                                                  0397 00869000
*           /*********************************************************/ 00870000
*           /*                                                       */ 00871000
*           /* CLOSE SYSUT1 FILE                                     */ 00872000
*           /*                                                       */ 00873000
*           /*********************************************************/ 00874000
*                                                                  0398 00875000
*           DO;                     /* HMASMRIO F(IOPCLOSE)IOP((RECXI   00876000
*                                      OPG))DSID(IOPSCR1)            */ 00877000
@RF00384 DS    0H                                                  0399 00878000
*             IOPPTR=(RECXIOPG);    /* SET UP IOP ADDRESS            */ 00879000
         L     @09,@PC00001                                        0399 00880000
         L     IOPPTR,RECXIOPG(,@09)                               0399 00881000
*             IOPFUNCT=IOPCLOSE;    /* SET UP FUNCTION CODE          */ 00882000
         MVI   IOPFUNCT(IOPPTR),X'50'                              0400 00883000
*             IOPDSID=IOPSCR1;      /* SET UP DSN CODE               */ 00884000
         MVI   IOPDSID(IOPPTR),X'03'                               0401 00885000
*             CALL HMASMIO(HMASMIOP);/* HAVE I/O PERFORMED           */ 00886000
         ST    IOPPTR,@AL00001                                     0402 00887000
         L     @15,@CV01464                                        0402 00888000
         LA    @01,@AL00001                                        0402 00889000
         BALR  @14,@15                                             0402 00890000
*           END;                                                   0403 00891000
*           ELEMRC=MAX(ELEMRC,IOPRETRN);/* SAVE RETURN CODE          */ 00892000
         L     @05,@PC00002                                        0404 00893000
         L     @09,ELEMRC(,@05)                                    0404 00894000
         SLR   @08,@08                                             0404 00895000
         IC    @08,IOPRETRN(,IOPPTR)                               0404 00896000
         CR    @09,@08                                             0404 00897000
         BNL   *+6                                                      00898000
         LR    @09,@08                                             0404 00899000
         ST    @09,ELEMRC(,@05)                                    0404 00900000
*         END;                                                     0405 00901000
*     END;                          /* "COPY" SELECT MEMBER STMTS  0406 00902000
*                                      BUILT                         */ 00903000
@RF00377 DS    0H                                                  0407 00904000
*   RETURN CODE(ELEMRC);                                           0407 00905000
@RF00298 L     @05,@PC00002                                        0407 00906000
         L     @15,ELEMRC(,@05)                                    0407 00907000
         L     @14,@SA00002                                        0407 00908000
         LM    @00,@03,@SA00002+8                                  0407 00909000
         LM    @05,@12,@SA00002+24                                 0407 00910000
         BR    @14                                                 0407 00911000
*   END ELEMPROC;                                                  0408 00912000
*                                                                  0409 00913000
*/********************************************************************/ 00914000
*/*                                                                  */ 00915000
*/*   COPYFILE - COPY MEMBERS FROM ONE SMPPTFIN RELFILE TO SMPTLIB   */ 00916000
*/*              DATASET                                             */ 00917000
*/*                                                                  */ 00918000
*/*            - ALLOCATE DATASET ON SMPTLIB VOLUME                  */ 00919000
*/*                                                                  */ 00920000
*/*              * IF UNABLE TO ALLOCATE TLIB FILE FOR THIS          */ 00921000
*/*                RELFILE, THEN RETURN TO THE CALLER AS             */ 00922000
*/*                SUBSEQUENT ALLOCATIONS WILL ALSO FAIL.            */ 00923000
*/*                                                                  */ 00924000
*/*            - POSITION SMPPTFIN TO APPROPRIATE FILE (DSNAME)      */ 00925000
*/*                                                                  */ 00926000
*/*            - LOAD SMPPFIN DATASET TO SMPTLIB                     */ 00927000
*/*                                                                  */ 00928000
*/********************************************************************/ 00929000
*                                                                  0409 00930000
*COPYFILE:                                                         0409 00931000
*   PROC(COPYRC);                                                  0409 00932000
COPYFILE STM   @14,@03,@SA00003                                    0409 00933000
         STM   @05,@12,@SA00003+24                                 0409 00934000
         MVC   @PC00003(4),0(@01)                                  0409 00935000
*   DCL                                                            0410 00936000
*     COPYRC FIXED(31);             /* COPYFILE RETURN CODE PARAMETER*/ 00937000
*   DCL                                                            0411 00938000
*     1 COPYFFLG BIT(8),            /* LOCAL FLAGS                   */ 00939000
*      2 COPYFALC BIT(1),           /* TLIB DATASET ALLOCATED        */ 00940000
*      2 COPYFPOS BIT(1),           /* PTFIN POSITIONED TO FILE      */ 00941000
*      2 * BIT(6);                  /* UNUSED                        */ 00942000
*   COPYRC=0;                       /* CLEAR RETURN CODE PARAMETER   */ 00943000
         L     @05,@PC00003                                        0412 00944000
         SLR   @09,@09                                             0412 00945000
         ST    @09,COPYRC(,@05)                                    0412 00946000
*   COPYFFLG=''B;                   /* CLEAR LOCAL FLAGS             */ 00947000
         MVI   COPYFFLG,X'00'                                      0413 00948000
*   IOPPTR=RECXIOPP;                /* POINT TO PTS IOP              */ 00949000
         L     @09,@PC00001                                        0414 00950000
         L     IOPPTR,RECXIOPP(,@09)                               0414 00951000
*                                                                  0415 00952000
*   /*****************************************************************/ 00953000
*   /*                                                               */ 00954000
*   /* FORM SMPTLIB DATASET NAME                                     */ 00955000
*   /*                                                               */ 00956000
*   /*****************************************************************/ 00957000
*                                                                  0415 00958000
*   SPLPMAD=ADDR(SPLPDSN);          /* POINT TO PARAMETER LIST       */ 00959000
         L     @05,SPLPMAD                                         0415 00960000
         ST    @05,SPLPMAD                                         0415 00961000
*   SPLFUNCT=SPLBDDSN;              /* INDICATE DSN TO BE BUILT      */ 00962000
         MVI   SPLFUNCT,X'05'                                      0416 00963000
*   SPLIPFX=IOPPTPFX;               /* SET UP PREFIX                 */ 00964000
         MVC   SPLIPFX(26,@05),IOPPTPFX(IOPPTR)                    0417 00965000
*   SPLISMD=CURSYSM#;               /* SET UP CURRENT SYSMOD         */ 00966000
         MVC   SPLISMD(7,@05),CURSYSM#                             0418 00967000
*   SPLIFIL=TLIBDSS#;               /* SET UP BINARY RELFILE         */ 00968000
         MVC   SPLIFIL(2,@05),TLIBDSS#                             0419 00969000
*   CALL HMASMSUB(HMASMSPL);        /* FORM TLIB DATASET NAME        */ 00970000
         L     @15,@CV01467                                        0420 00971000
         LA    @01,@AL00420                                        0420 00972000
         BALR  @14,@15                                             0420 00973000
*   IOPPTR=RECXIOPG;                /* POINT TO GENERAL IOP          */ 00974000
*                                                                  0421 00975000
         L     @09,@PC00001                                        0421 00976000
         L     IOPPTR,RECXIOPG(,@09)                               0421 00977000
*   /*****************************************************************/ 00978000
*   /*                                                               */ 00979000
*   /* SET TLIB FILE TYPE BASED UPON ELEMENT TYPES IN RELFILE        */ 00980000
*   /*                                                               */ 00981000
*   /*****************************************************************/ 00982000
*                                                                  0422 00983000
*   IOPDTYPE=''B;                   /* CLEAR TLIB FILE TYPE          */ 00984000
         MVI   IOPDTYPE(IOPPTR),X'00'                              0422 00985000
*   IF DMOD=ON                      /* ++MOD FOUND                   */ 00986000
*     THEN                                                         0423 00987000
         TM    DMOD,B'10000000'                                    0423 00988000
         BNO   @RF00423                                            0423 00989000
*     IOPDMOD=ON;                   /* SET MOD-TYPE FILE             */ 00990000
         OI    IOPDMOD(IOPPTR),B'00010000'                         0424 00991000
*   IF DSRC=ON                      /* ++SRC FOUND                   */ 00992000
*     THEN                                                         0425 00993000
@RF00423 TM    DSRC,B'00100000'                                    0425 00994000
         BNO   @RF00425                                            0425 00995000
*     IOPDSRC=ON;                   /* SET SRC-TYPE FILE             */ 00996000
         OI    IOPDSRC(IOPPTR),B'01000000'                         0426 00997000
*   IF DMAC=ON                      /* ++MAC FOUND                   */ 00998000
*     THEN                                                         0427 00999000
@RF00425 TM    DMAC,B'01000000'                                    0427 01000000
         BNO   @RF00427                                            0427 01001000
*     IOPDMAC=ON;                   /* SET MAC-TYPE FILE             */ 01002000
         OI    IOPDMAC(IOPPTR),B'10000000'                         0428 01003000
*   IF DJCL=ON                      /* ++JCLIN FOUND                 */ 01004000
*     THEN                                                         0429 01005000
@RF00427 TM    DJCL,B'00010000'                                    0429 01006000
         BNO   @RF00429                                            0429 01007000
*     IOPDJCL=ON;                   /* SET JCLIN-TYPE FILE           */ 01008000
*                                                                  0430 01009000
         OI    IOPDJCL(IOPPTR),B'00100000'                         0430 01010000
*   /*****************************************************************/ 01011000
*   /*                                                               */ 01012000
*   /* ALLOCATE SMPTLIB DATASET FOR THIS RELFILE                     */ 01013000
*   /*                                                               */ 01014000
*   /*****************************************************************/ 01015000
*                                                                  0431 01016000
*   IOPSPACE=RECXDSPC;              /* SET UP SPACE PARAMETER        */ 01017000
@RF00429 L     @05,@PC00001                                        0431 01018000
         MVC   IOPSPACE(6,IOPPTR),RECXDSPC(@05)                    0431 01019000
*   IOPFUNCT=IOPALC;                /* ALLOC FUNCTION                */ 01020000
         MVI   IOPFUNCT(IOPPTR),X'0D'                              0432 01021000
*   IOPDSID=IOPLRF;                 /* TLIB DATASET                  */ 01022000
         MVI   IOPDSID(IOPPTR),X'20'                               0433 01023000
*   IOPDDNAM='SMPTLIB';             /* DDNAME FOR TLIB VOLUME(S)     */ 01024000
         MVI   IOPDDNAM+7(IOPPTR),C' '                             0434 01025000
         MVC   IOPDDNAM(7,IOPPTR),@CC01647                         0434 01026000
*   IOPDSN=SPLODSN;                 /* TLIB DSN FORMED ABOVE         */ 01027000
         L     @05,SPLPMAD                                         0435 01028000
         MVC   IOPDSN(44,IOPPTR),SPLODSN(@05)                      0435 01029000
*   CALL HMASMIO(HMASMIOP);         /* ALLOCATE THE TLIB DATASET     */ 01030000
         ST    IOPPTR,@AL00001                                     0436 01031000
         L     @15,@CV01464                                        0436 01032000
         LA    @01,@AL00001                                        0436 01033000
         BALR  @14,@15                                             0436 01034000
*   COPYRC=MAX(COPYRC,IOPRETRN);    /* MAINTAIN MAX RETURN CODE      */ 01035000
         L     @05,@PC00003                                        0437 01036000
         L     @09,COPYRC(,@05)                                    0437 01037000
         SLR   @08,@08                                             0437 01038000
         IC    @08,IOPRETRN(,IOPPTR)                               0437 01039000
         CR    @09,@08                                             0437 01040000
         BNL   *+6                                                      01041000
         LR    @09,@08                                             0437 01042000
         ST    @09,COPYRC(,@05)                                    0437 01043000
*   IF IOPRETRN>=STOPPTF            /* TLIB ALLOCATION ERROR         */ 01044000
*     THEN                                                         0438 01045000
         CLI   IOPRETRN(IOPPTR),8                                  0438 01046000
         BL    @RF00438                                            0438 01047000
*     DO;                                                          0439 01048000
*                                                                  0439 01049000
*       /*************************************************************/ 01050000
*       /*                                                           */ 01051000
*       /* ALLOCATION FAILED ... SET GSMLERR IN SUMMARY RECORD       */ 01052000
*       /*                                                           */ 01053000
*       /*************************************************************/ 01054000
*                                                                  0440 01055000
*       GSMLERR=ON;                 /* RELFILE PROCESSING ERROR      */ 01056000
         L     @05,@PC00001                                        0440 01057000
         L     @05,RECXGSMP(,@05)                                  0440 01058000
         L     @01,GTPBUFAD(,@05)                                  0440 01059000
         OI    GSMLERR(@01),B'00000010'                            0440 01060000
*       RECXGSMP->GTPFUNCT=GTPADD;  /* PUT RECORD BACK TO FILE       */ 01061000
         MVI   GTPFUNCT(@05),X'04'                                 0441 01062000
*       CALL HMASMGTA(RECXGSMP->HMASMGTP);                         0442 01063000
         ST    @05,@AL00001                                        0442 01064000
         L     @15,@CV01465                                        0442 01065000
         LA    @01,@AL00001                                        0442 01066000
         BALR  @14,@15                                             0442 01067000
*       IF CCATLBP=OFF              /* TLIB DD NOT PRESENT           */ 01068000
*         THEN                                                     0443 01069000
         TM    CCATLBP(CCAPTR),B'10000000'                         0443 01070000
         BNZ   @RF00443                                            0443 01071000
*         COPYRC=MAX(COPYRC,STOPFUNC);/* MAKE SURE RELFILE PROCESSING   01072000
*                                      STOPS                         */ 01073000
         L     @05,@PC00003                                        0444 01074000
         L     @09,COPYRC(,@05)                                    0444 01075000
         LA    @08,12                                              0444 01076000
         CR    @09,@08                                             0444 01077000
         BNL   *+6                                                      01078000
         LR    @09,@08                                             0444 01079000
         ST    @09,COPYRC(,@05)                                    0444 01080000
*     END;                                                         0445 01081000
*   ELSE                                                           0446 01082000
*     COPYFALC=ON;                  /* TLIB ALLOCATION SUCCESSFUL    */ 01083000
         B     @RC00438                                            0446 01084000
@RF00438 OI    COPYFALC,B'10000000'                                0446 01085000
*   IF COPYFALC=ON                  /* TLIB ALLOCATION SUCCESSFUL    */ 01086000
*     THEN                          /*                               */ 01087000
@RC00438 TM    COPYFALC,B'10000000'                                0447 01088000
         BNO   @RF00447                                            0447 01089000
*     DO;                                                          0448 01090000
*                                                                  0448 01091000
*       /*************************************************************/ 01092000
*       /*                                                           */ 01093000
*       /* POSITION TAPE TO PROPER FILE                              */ 01094000
*       /*                                                           */ 01095000
*       /*************************************************************/ 01096000
*                                                                  0449 01097000
*       DO;                         /* HMASMRIO F(IOPPOSI)IOP((RECXIO   01098000
*                                      PG))DSID(IOPPTFIN)DSN(TAPEDSN)   01099000
*                                      SEQ(TAPEASEQ)                 */ 01100000
*         IOPPTR=(RECXIOPG);        /* SET UP IOP ADDRESS            */ 01101000
         L     @09,@PC00001                                        0450 01102000
         L     IOPPTR,RECXIOPG(,@09)                               0450 01103000
*         IOPFUNCT=IOPPOSI;         /* SET UP FUNCTION CODE          */ 01104000
         MVI   IOPFUNCT(IOPPTR),X'02'                              0451 01105000
*         IOPDSID=IOPPTFIN;         /* SET UP DSN CODE               */ 01106000
         MVI   IOPDSID(IOPPTR),X'0A'                               0452 01107000
*         IOPSEQNO=TAPEASEQ;        /* SET UP SEQ                    */ 01108000
         MVC   IOPSEQNO(2,IOPPTR),TAPEASEQ                         0453 01109000
*         IOPDSN=TAPEDSN;           /* SET UP DSN                    */ 01110000
         MVC   IOPDSN(44,IOPPTR),TAPEDSN                           0454 01111000
*         CALL HMASMIO(HMASMIOP);   /* HAVE I/O PERFORMED            */ 01112000
         ST    IOPPTR,@AL00001                                     0455 01113000
         L     @15,@CV01464                                        0455 01114000
         LA    @01,@AL00001                                        0455 01115000
         BALR  @14,@15                                             0455 01116000
*       END;                                                       0456 01117000
*       COPYRC=MAX(COPYRC,IOPRETRN);/* MAINTAIN MAX RETURN CODE      */ 01118000
         L     @05,@PC00003                                        0457 01119000
         L     @09,COPYRC(,@05)                                    0457 01120000
         SLR   @08,@08                                             0457 01121000
         IC    @08,IOPRETRN(,IOPPTR)                               0457 01122000
         CR    @09,@08                                             0457 01123000
         BNL   *+6                                                      01124000
         LR    @09,@08                                             0457 01125000
         ST    @09,COPYRC(,@05)                                    0457 01126000
*       IF IOPRETRN>IOPGOOD THEN    /* IF PTFIN CANNOT BE OPENED     */ 01127000
         CLI   IOPRETRN(IOPPTR),0                                  0458 01128000
         BNH   @RF00458                                            0458 01129000
*         DO;                       /* POST LOAD ERROR IN SUMMARY    */ 01130000
*                                                                  0459 01131000
*           /*********************************************************/ 01132000
*           /*                                                       */ 01133000
*           /* POSITION FAILED ... SET GSMLERR IN SUMMARY RECORD     */ 01134000
*           /*                                                       */ 01135000
*           /*********************************************************/ 01136000
*                                                                  0460 01137000
*           GSMLERR=ON;             /* RELFILE PROCESSING ERROR      */ 01138000
         L     @05,@PC00001                                        0460 01139000
         L     @05,RECXGSMP(,@05)                                  0460 01140000
         L     @01,GTPBUFAD(,@05)                                  0460 01141000
         OI    GSMLERR(@01),B'00000010'                            0460 01142000
*           RECXGSMP->GTPFUNCT=GTPADD;/* PUT RECORD BACK TO FILE     */ 01143000
         MVI   GTPFUNCT(@05),X'04'                                 0461 01144000
*           CALL HMASMGTA(RECXGSMP->HMASMGTP);                     0462 01145000
         ST    @05,@AL00001                                        0462 01146000
         L     @15,@CV01465                                        0462 01147000
         LA    @01,@AL00001                                        0462 01148000
         BALR  @14,@15                                             0462 01149000
*         END;                                                     0463 01150000
*       ELSE                                                       0464 01151000
*         COPYFPOS=ON;              /* PTFIN POSITION SUCCESSFUL     */ 01152000
         B     @RC00458                                            0464 01153000
@RF00458 OI    COPYFPOS,B'01000000'                                0464 01154000
*     END;                                                         0465 01155000
@RC00458 DS    0H                                                  0466 01156000
*   IF COPYFALC=ON                  /* TLIB ALLOCATION SUCCESSFUL    */ 01157000
*       &COPYFPOS=ON                /* PTFIN POSITION SUCCESSFUL     */ 01158000
*     THEN                                                         0466 01159000
@RF00447 TM    COPYFALC,B'11000000'                                0466 01160000
         BNO   @RF00466                                            0466 01161000
*     DO;                                                          0467 01162000
*                                                                  0467 01163000
*       /*************************************************************/ 01164000
*       /*                                                           */ 01165000
*       /* SETUP STAE PARMS                                          */ 01166000
*       /*                                                           */ 01167000
*       /*************************************************************/ 01168000
*                                                                  0468 01169000
*       SAVRVANM=RVAEPRNM;          /* SAVE RVA PROC NM              */ 01170000
         L     @05,CCARVAD(,CCAPTR)                                0468 01171000
         MVC   SAVRVANM(8),RVAEPRNM(@05)                           0468 01172000
*       RVAEPRNM=CCACPYNM;          /* COPY PROC NAME                */ 01173000
*                                                                  0469 01174000
         L     @09,CCABLDLP(,CCAPTR)                               0469 01175000
         MVC   RVAEPRNM(8,@05),CCACPYNM(@09)                       0469 01176000
*       /*************************************************************/ 01177000
*       /*                                                           */ 01178000
*       /* INVOKE "COPY" TO COPY RELFILE TO TLIB                     */ 01179000
*       /*                                                           */ 01180000
*       /*************************************************************/ 01181000
*                                                                  0470 01182000
*       RTNREG=CCACOPY;             /* GET PROPER NAME FOR "COPY"    */ 01183000
         L     RTNREG,CCACOPY(,@09)                                0470 01184000
*       GEN(LINK DE=(RTNREG),PARAM=(0,ALTDD),VL=1);/* COPY FILE      */ 01185000
         LINK DE=(RTNREG),PARAM=(0,ALTDD),VL=1                          01186000
*       RVAEPRNM=SAVRVANM;          /* RESTORE RVA NAME              */ 01187000
         L     @05,CCARVAD(,CCAPTR)                                0472 01188000
         MVC   RVAEPRNM(8,@05),SAVRVANM                            0472 01189000
*       IF RTNCODE>CCACPYRC         /* CHECK AGAINST USER-SPECIFIED     01190000
*                                      RETURN CODE                   */ 01191000
*         THEN                                                     0473 01192000
         L     @05,CCABLDLP(,CCAPTR)                               0473 01193000
         SLR   @09,@09                                             0473 01194000
         IC    @09,CCACPYRC(,@05)                                  0473 01195000
         CR    RTNCODE,@09                                         0473 01196000
         BNH   @RF00473                                            0473 01197000
*         DO;                                                      0474 01198000
*                                                                  0474 01199000
*           /*********************************************************/ 01200000
*           /*                                                       */ 01201000
*           /* "COPY" FAILED ... ISSUE HMA351I ... SET GSMRLF FLAG   */ 01202000
*           /* OFF                                                   */ 01203000
*           /*                                                       */ 01204000
*           /*********************************************************/ 01205000
*                                                                  0475 01206000
*           COPYRC=MAX(COPYRC,STOPPTF);/* MAINTAIN MAX RETURN CODE   */ 01207000
         L     @09,@PC00003                                        0475 01208000
         L     @08,COPYRC(,@09)                                    0475 01209000
         LA    @07,8                                               0475 01210000
         CR    @08,@07                                             0475 01211000
         BNL   *+6                                                      01212000
         LR    @08,@07                                             0475 01213000
         ST    @08,COPYRC(,@09)                                    0475 01214000
*           FIX31=RTNCODE;          /* SAVE RETURN CODE FOR CONVERT  */ 01215000
         LR    FIX31,RTNCODE                                       0476 01216000
*           GSMLERR=ON;             /* POST LOAD ERROR               */ 01217000
         L     @09,@PC00001                                        0477 01218000
         L     @09,RECXGSMP(,@09)                                  0477 01219000
         L     @08,GTPBUFAD(,@09)                                  0477 01220000
         OI    GSMLERR(@08),B'00000010'                            0477 01221000
*           GSMRLFL=OFF;            /* RESET LOADED IN SUMMARY FILE  */ 01222000
*           GSMRECVD=OFF;           /* RESET RECEIVED IN SUMMARY     */ 01223000
*                                                                  0479 01224000
         NI    GSMRLFL(@08),B'01011111'                            0479 01225000
*           /*********************************************************/ 01226000
*           /*                                                       */ 01227000
*           /* PUT SUMMARY RECORD TO SUMMARY GTA FILE                */ 01228000
*           /*                                                       */ 01229000
*           /*********************************************************/ 01230000
*                                                                  0480 01231000
*           RECXGSMP->GTPFUNCT=GTPADD;/* PUT RECORD BACK TO FILE     */ 01232000
         MVI   GTPFUNCT(@09),X'04'                                 0480 01233000
*           CALL HMASMGTA(RECXGSMP->HMASMGTP);                     0481 01234000
         ST    @09,@AL00001                                        0481 01235000
         L     @15,@CV01465                                        0481 01236000
         LA    @01,@AL00001                                        0481 01237000
         BALR  @14,@15                                             0481 01238000
*           MAXCOPY=MAX(MAXCOPY,RTNCODE);/* MAINTAIN MAX COPY RET. 0482 01239000
*                                      CODE                          */ 01240000
         L     @09,MAXCOPY                                         0482 01241000
         CR    @09,RTNCODE                                         0482 01242000
         BNL   *+6                                                      01243000
         LR    @09,RTNCODE                                         0482 01244000
         ST    @09,MAXCOPY                                         0482 01245000
*           CVD(FIX31,PKDDEC);      /* CONVERT RTN CODE TO PKD DEC   */ 01246000
         CVD   FIX31,PKDDEC                                        0483 01247000
*           UNPK(EBCDIC,PKDDEC);    /* CONVERT PKD DEC TO EBCDIC     */ 01248000
         UNPK  EBCDIC(8),PKDDEC(8)                                 0484 01249000
*           MVZ(EBCDIC(8),EBCDIC(7));/* FIX UP LOW-ORDER DIGIT       */ 01250000
         MVZ   EBCDIC+7(1),EBCDIC+6                                0485 01251000
*           MGPCLEAR=''B;           /* CLEAR ALL MESSAGE NUMBERS     */ 01252000
         XC    MGPCLEAR(6),MGPCLEAR                                0486 01253000
*           MGPFLAGS=''B;           /* CLEAR ALL FLAGS               */ 01254000
         XC    MGPFLAGS(2),MGPFLAGS                                0487 01255000
*           MGPMGNO1=HMA351I;       /* PRIMARY MESSAGE               */ 01256000
         SLR   @05,@05                                             0488 01257000
         IC    @05,HMA351I                                         0488 01258000
         STH   @05,MGPMGNO1                                        0488 01259000
*           MGPMGNO2=PART102;       /* SECONDARY MESSAGE PART        */ 01260000
         SLR   @05,@05                                             0489 01261000
         IC    @05,PART102                                         0489 01262000
         STH   @05,MGPMGNO2                                        0489 01263000
*           MGPPRINT=ON;            /* MESSAGE TO SMPOUT             */ 01264000
*           MGPHLDS=ON;             /* MESSAGE TO SMPLOG             */ 01265000
         OI    MGPPRINT,B'10010000'                                0491 01266000
*           MGPVARPT(1)=ADDR(CURSYSM#);/* POINT TO SYSMOD NAME       */ 01267000
         LA    @05,CURSYSM#                                        0492 01268000
         ST    @05,MGPVARPT                                        0492 01269000
*           MGPVARPT(2)=ADDR(EBCDIC(7));/* POINT TO LAST TWO DIGITS     01270000
*                                      OF RC                         */ 01271000
         LA    @05,EBCDIC+6                                        0493 01272000
         ST    @05,MGPVARPT+4                                      0493 01273000
*           MGPTYPE=MGPERR;         /* STOP-SYSMOD ERROR             */ 01274000
         MVI   MGPTYPE,X'03'                                       0494 01275000
*           CALL HMASMMSG(HMASMMGP);/* ISSUE MESSAGE                 */ 01276000
         L     @15,@CV01466                                        0495 01277000
         LA    @01,@AL00495                                        0495 01278000
         BALR  @14,@15                                             0495 01279000
*         END;                                                     0496 01280000
*       ELSE                        /* IF LOADED THEN POST           */ 01281000
*         DO;                       /* GRFLOADD IN RELFILE RECORDS   */ 01282000
*                                                                  0497 01283000
         B     @RC00473                                            0497 01284000
@RF00473 DS    0H                                                  0498 01285000
*           /*********************************************************/ 01286000
*           /*                                                       */ 01287000
*           /* "COPY" SUCCESSFUL ... ONE RELFILE SUCCESSFULLY LOADED */ 01288000
*           /*                                                       */ 01289000
*           /*********************************************************/ 01290000
*                                                                  0498 01291000
*                                                                  0498 01292000
*           /*********************************************************/ 01293000
*           /*                                                       */ 01294000
*           /* POST RECORDS IN RELFILE GTA FILE TO INDICATE MEMBERS  */ 01295000
*           /* LOADED                                                */ 01296000
*           /*                                                       */ 01297000
*           /*********************************************************/ 01298000
*                                                                  0498 01299000
*           RECXGRFP->GTPFUNCT=GTPSTRTN;/* RESTART AT FIRST ELEMENT     01300000
*                                      FOR RELFILE JUST LOADED       */ 01301000
         L     @05,@PC00001                                        0498 01302000
         L     @05,RECXGRFP(,@05)                                  0498 01303000
         MVI   GTPFUNCT(@05),X'06'                                 0498 01304000
*           RECXGRFP->GTPRESTR=RELFREST;/* FIRST ELEMENT RESTART DATA*/ 01305000
         MVC   GTPRESTR(10,@05),RELFREST                           0499 01306000
*           CALL HMASMGTA(RECXGRFP->HMASMGTP);                     0500 01307000
         ST    @05,@AL00001                                        0500 01308000
         L     @15,@CV01465                                        0500 01309000
         LA    @01,@AL00001                                        0500 01310000
         BALR  @14,@15                                             0500 01311000
*           RECXGRFP->GTPFUNCT=GTPGETN;/* GET FIRST RELFILE RECORD   */ 01312000
         L     @05,@PC00001                                        0501 01313000
         L     @05,RECXGRFP(,@05)                                  0501 01314000
         MVI   GTPFUNCT(@05),X'08'                                 0501 01315000
*           CALL HMASMGTA(RECXGRFP->HMASMGTP);                     0502 01316000
*                                                                  0502 01317000
         ST    @05,@AL00001                                        0502 01318000
         L     @15,@CV01465                                        0502 01319000
         LA    @01,@AL00001                                        0502 01320000
         BALR  @14,@15                                             0502 01321000
*           /*********************************************************/ 01322000
*           /*                                                       */ 01323000
*           /* GO THRU ALL RECORDS IN RELFILE GTA FILE FOR MEMBERS   */ 01324000
*           /* LOADED                                                */ 01325000
*           /*                                                       */ 01326000
*           /*********************************************************/ 01327000
*                                                                  0503 01328000
*           DO WHILE RECXGRFP->GTPRETRN^=GTPEOF/* NOT END-OF-FILE    */ 01329000
*                 &ABSFSEQ=GRFFSEQ; /* FILE JUST LOADED              */ 01330000
         B     @DE00503                                            0503 01331000
@DL00503 DS    0H                                                  0504 01332000
*             GRFLOADD=ON;          /* POST LOADED FLAG              */ 01333000
         L     @05,@PC00001                                        0504 01334000
         L     @05,RECXGRFP(,@05)                                  0504 01335000
         L     @01,GTPBUFAD(,@05)                                  0504 01336000
         OI    GRFLOADD(@01),B'01000000'                           0504 01337000
*             RECXGRFP->GTPFUNCT=GTPADD;/* PUT RECORD BACK TO GTA  0505 01338000
*                                      FILE                          */ 01339000
         MVI   GTPFUNCT(@05),X'04'                                 0505 01340000
*             CALL HMASMGTA(RECXGRFP->HMASMGTP);                   0506 01341000
         ST    @05,@AL00001                                        0506 01342000
         L     @15,@CV01465                                        0506 01343000
         LA    @01,@AL00001                                        0506 01344000
         BALR  @14,@15                                             0506 01345000
*             RECXGRFP->GTPFUNCT=GTPGETN;/* GET NEXT RECORD          */ 01346000
         L     @05,@PC00001                                        0507 01347000
         L     @05,RECXGRFP(,@05)                                  0507 01348000
         MVI   GTPFUNCT(@05),X'08'                                 0507 01349000
*             CALL HMASMGTA(RECXGRFP->HMASMGTP);                   0508 01350000
         ST    @05,@AL00001                                        0508 01351000
         L     @15,@CV01465                                        0508 01352000
         LA    @01,@AL00001                                        0508 01353000
         BALR  @14,@15                                             0508 01354000
*           END;                                                   0509 01355000
@DE00503 L     @05,@PC00001                                        0509 01356000
         L     @05,RECXGRFP(,@05)                                  0509 01357000
         CLI   GTPRETRN(@05),4                                     0509 01358000
         BE    @DC00503                                            0509 01359000
         L     @05,GTPBUFAD(,@05)                                  0509 01360000
         CLC   ABSFSEQ(2),GRFFSEQ(@05)                             0509 01361000
         BE    @DL00503                                            0509 01362000
@DC00503 DS    0H                                                  0510 01363000
*         END;                                                     0510 01364000
*       IF COPYFALC=ON              /* TLIB DATASET ALLOCATED        */ 01365000
*         THEN                                                     0511 01366000
@RC00473 TM    COPYFALC,B'10000000'                                0511 01367000
         BNO   @RF00511                                            0511 01368000
*         DO;                                                      0512 01369000
*                                                                  0512 01370000
*           /*********************************************************/ 01371000
*           /*                                                       */ 01372000
*           /* FREE UP ALLOCATED SMPTLIB DATASET                     */ 01373000
*           /*                                                       */ 01374000
*           /*********************************************************/ 01375000
*                                                                  0513 01376000
*           DO;                     /* HMASMRIO F(IOPDALC)IOP((RECXIO   01377000
*                                      PG))DSID(IOPLRF)DSN(SPLODSN)  */ 01378000
*             IOPPTR=(RECXIOPG);    /* SET UP IOP ADDRESS            */ 01379000
         L     @09,@PC00001                                        0514 01380000
         L     IOPPTR,RECXIOPG(,@09)                               0514 01381000
*             IOPFUNCT=IOPDALC;     /* SET UP FUNCTION CODE          */ 01382000
         MVI   IOPFUNCT(IOPPTR),X'0E'                              0515 01383000
*             IOPDSID=IOPLRF;       /* SET UP DSN CODE               */ 01384000
         MVI   IOPDSID(IOPPTR),X'20'                               0516 01385000
*             IOPDDNAM='SMPTLIB';   /* SET UP DD NAME                */ 01386000
         MVI   IOPDDNAM+7(IOPPTR),C' '                             0517 01387000
         MVC   IOPDDNAM(7,IOPPTR),@CC01647                         0517 01388000
*             IOPDSN=SPLODSN;       /* SET UP DSN                    */ 01389000
         L     @05,SPLPMAD                                         0518 01390000
         MVC   IOPDSN(44,IOPPTR),SPLODSN(@05)                      0518 01391000
*             CALL HMASMIO(HMASMIOP);/* HAVE I/O PERFORMED           */ 01392000
         ST    IOPPTR,@AL00001                                     0519 01393000
         L     @15,@CV01464                                        0519 01394000
         LA    @01,@AL00001                                        0519 01395000
         BALR  @14,@15                                             0519 01396000
*           END;                                                   0520 01397000
*         END;                                                     0521 01398000
*     END;                                                         0522 01399000
@RF00511 DS    0H                                                  0523 01400000
*   RETURN CODE(COPYRC);            /* RETURN TO CALLER              */ 01401000
@RF00466 L     @05,@PC00003                                        0523 01402000
         L     @15,COPYRC(,@05)                                    0523 01403000
         L     @14,@SA00003                                        0523 01404000
         LM    @00,@03,@SA00003+8                                  0523 01405000
         LM    @05,@12,@SA00003+24                                 0523 01406000
         BR    @14                                                 0523 01407000
*   END COPYFILE;                                                  0524 01408000
*                                                                  0525 01409000
*/********************************************************************/ 01410000
*/*                                                                  */ 01411000
*/*   PUTSYSM  - POST FINAL STATUS IN RECEIVE SUMMARY GTA FILE       */ 01412000
*/*              RECORD AND RE-WRITE THE PTS SYSMOD ENTRY WITH       */ 01413000
*/*              THE ERROR FLAG OFF.                                 */ 01414000
*/*                                                                  */ 01415000
*/*              - ISSUE HMASM344I/PART085: RELFILE ELEMENTS LOADED. */ 01416000
*/*                                                                  */ 01417000
*/*                                                                  */ 01418000
*/********************************************************************/ 01419000
*                                                                  0525 01420000
*PUTSYSM:                                                          0525 01421000
*   PROC(PUTSMRC);                                                 0525 01422000
PUTSYSM  STM   @14,@03,@SA00004                                    0525 01423000
         STM   @05,@12,@SA00004+24                                 0525 01424000
         MVC   @PC00004(4),0(@01)                                  0525 01425000
*   DCL                                                            0526 01426000
*     PUTSMRC FIXED(31);            /* RETURN CODE PARAMETER         */ 01427000
*   PUTSMRC=0;                      /* CLEAR RETURN CODE PARAMETER   */ 01428000
*                                                                  0527 01429000
         L     @09,@PC00004                                        0527 01430000
         SLR   @08,@08                                             0527 01431000
         ST    @08,PUTSMRC(,@09)                                   0527 01432000
*   /*****************************************************************/ 01433000
*   /*                                                               */ 01434000
*   /* PUT SUMMARY RECORD FOR THIS SYSMOD TO GTA SUMMARY FILE        */ 01435000
*   /*                                                               */ 01436000
*   /*****************************************************************/ 01437000
*                                                                  0528 01438000
*   GSMRECVD=ON;                    /* SYSMOD SUCCESSFULLY RECEIVED  */ 01439000
*   GSMRLFL=ON;                     /* RELFILE ELEMENTS LOADED       */ 01440000
         L     @09,@PC00001                                        0529 01441000
         L     @09,RECXGSMP(,@09)                                  0529 01442000
         L     @01,GTPBUFAD(,@09)                                  0529 01443000
         OI    GSMRECVD(@01),B'10100000'                           0529 01444000
*   RECXGSMP->GTPFUNCT=GTPADD;      /* PUT RECORD BACK TO GTA FILE   */ 01445000
         MVI   GTPFUNCT(@09),X'04'                                 0530 01446000
*   CALL HMASMGTA(RECXGSMP->HMASMGTP);                             0531 01447000
*                                                                  0531 01448000
         ST    @09,@AL00001                                        0531 01449000
         L     @15,@CV01465                                        0531 01450000
         LA    @01,@AL00001                                        0531 01451000
         BALR  @14,@15                                             0531 01452000
*   /*****************************************************************/ 01453000
*   /*                                                               */ 01454000
*   /* RELFILES LOADED SUCCESSFULLY ... ISSUE HMA394I                */ 01455000
*   /*                                                               */ 01456000
*   /*****************************************************************/ 01457000
*                                                                  0532 01458000
*   MGPCLEAR=''B;                   /* CLEAR ALL MESSAGE NUMBERS     */ 01459000
         XC    MGPCLEAR(6),MGPCLEAR                                0532 01460000
*   MGPFLAGS=''B;                   /* CLEAR ALL FLAGS               */ 01461000
         XC    MGPFLAGS(2),MGPFLAGS                                0533 01462000
*   MGPMGNO1=HMA394I;               /* PRIMARY MESSAGE               */ 01463000
         SLR   @09,@09                                             0534 01464000
         IC    @09,HMA394I                                         0534 01465000
         STH   @09,MGPMGNO1                                        0534 01466000
*   MGPVARPT(1)=ADDR(CURSYSM#);     /* SYSMOD NAME                   */ 01467000
         LA    @09,CURSYSM#                                        0535 01468000
         ST    @09,MGPVARPT                                        0535 01469000
*   IF MAXCOPY>0 THEN                                              0536 01470000
         L     @09,MAXCOPY                                         0536 01471000
         LTR   @09,@09                                             0536 01472000
         BNP   @RF00536                                            0536 01473000
*     DO;                                                          0537 01474000
*                                                                  0537 01475000
*       /*************************************************************/ 01476000
*       /*                                                           */ 01477000
*       /* NON-ZERO COPY RETURN CODE ENCOUNTERED ... SET UP PART103  */ 01478000
*       /*                                                           */ 01479000
*       /*************************************************************/ 01480000
*                                                                  0538 01481000
*       FIX31=MAXCOPY;              /* MAXIMUM COPY RETURN CODE      */ 01482000
         LR    FIX31,@09                                           0538 01483000
*       CVD(FIX31,PKDDEC);          /* CONVERT RTN CODE TO PKD DEC   */ 01484000
         CVD   FIX31,PKDDEC                                        0539 01485000
*       UNPK(EBCDIC,PKDDEC);        /* CONVERT PKD DEC TO EBCDIC     */ 01486000
         UNPK  EBCDIC(8),PKDDEC(8)                                 0540 01487000
*       MVZ(EBCDIC(8),EBCDIC(7));   /* FIX UP LOW-ORDER DIGIT        */ 01488000
         MVZ   EBCDIC+7(1),EBCDIC+6                                0541 01489000
*       MGPMGNO3=PART103;           /* SECONDARY MESSAGE PART        */ 01490000
         SLR   @09,@09                                             0542 01491000
         IC    @09,PART103                                         0542 01492000
         STH   @09,MGPMGNO3                                        0542 01493000
*       MGPVARPT(2)=ADDR(EBCDIC(7));/* POINT TO LAST 2 DIGITS        */ 01494000
         LA    @09,EBCDIC+6                                        0543 01495000
         ST    @09,MGPVARPT+4                                      0543 01496000
*     END;                                                         0544 01497000
*   MGPPRINT=ON;                    /* MESSAGE TO SMPOUT             */ 01498000
@RF00536 DS    0H                                                  0546 01499000
*   MGPHLDS=ON;                     /* MESSAGE TO SMPLOG             */ 01500000
         OI    MGPPRINT,B'10010000'                                0546 01501000
*   MGPTYPE=MGPINFO;                /* INFORMATIONAL MESSAGE         */ 01502000
         MVI   MGPTYPE,X'01'                                       0547 01503000
*   CALL HMASMMSG(HMASMMGP);        /* ISSUE MESSAGE                 */ 01504000
*                                                                  0548 01505000
         L     @15,@CV01466                                        0548 01506000
         LA    @01,@AL00548                                        0548 01507000
         BALR  @14,@15                                             0548 01508000
*   /*****************************************************************/ 01509000
*   /*                                                               */ 01510000
*   /* RE-WRITE PTS SYSMOD ENTRY WITH "IN-ERROR" FLAG OFF            */ 01511000
*   /*                                                               */ 01512000
*   /*****************************************************************/ 01513000
*                                                                  0549 01514000
*   IOPPTR=RECXIOPP;                /* SET UP IOP POINTER FOR PTS    */ 01515000
         L     @09,@PC00001                                        0549 01516000
         L     IOPPTR,RECXIOPP(,@09)                               0549 01517000
*   IOPERROR=OFF;                   /* RESET ERROR FLAG IN PTS       */ 01518000
         NI    IOPERROR(IOPPTR),B'11101111'                        0550 01519000
*   DO;                             /* HMASMRIO F(IOPSTOWR)DSID(IOPPT   01520000
*                                      S)NAME(CURSYSM#)TYPE(IOPSMD)  */ 01521000
*     IOPFUNCT=IOPSTOWR;            /* SET UP FUNCTION CODE          */ 01522000
         MVI   IOPFUNCT(IOPPTR),X'54'                              0552 01523000
*     IOPDSID=IOPPTS;               /* SET UP DSN CODE               */ 01524000
         MVI   IOPDSID(IOPPTR),X'06'                               0553 01525000
*     IOPNAME=CURSYSM#;             /* SET UP NAME                   */ 01526000
         MVI   IOPNAME+7(IOPPTR),C' '                              0554 01527000
         MVC   IOPNAME(7,IOPPTR),CURSYSM#                          0554 01528000
*     IOPTYPE=IOPSMD;               /* SET UP TYPE                   */ 01529000
         MVI   IOPTYPE(IOPPTR),X'0B'                               0555 01530000
*     CALL HMASMIO(HMASMIOP);       /* HAVE I/O PERFORMED            */ 01531000
         ST    IOPPTR,@AL00001                                     0556 01532000
         L     @15,@CV01464                                        0556 01533000
         LA    @01,@AL00001                                        0556 01534000
         BALR  @14,@15                                             0556 01535000
*   END;                                                           0557 01536000
*   PUTSMRC=MAX(PUTSMRC,IOPRETRN);  /* MAINTAIN MAX RETURN CODE      */ 01537000
         L     @05,@PC00004                                        0558 01538000
         L     @09,PUTSMRC(,@05)                                   0558 01539000
         SLR   @08,@08                                             0558 01540000
         IC    @08,IOPRETRN(,IOPPTR)                               0558 01541000
         CR    @09,@08                                             0558 01542000
         BNL   *+6                                                      01543000
         LR    @09,@08                                             0558 01544000
         ST    @09,PUTSMRC(,@05)                                   0558 01545000
*   IF IOPRETRN=IOPGOOD THEN                                       0559 01546000
         CLI   IOPRETRN(IOPPTR),0                                  0559 01547000
         BNE   @RF00559                                            0559 01548000
*     DO;                                                          0560 01549000
*                                                                  0560 01550000
*       /*************************************************************/ 01551000
*       /*                                                           */ 01552000
*       /* ISSUE HMA393I ... SYSMOD SUCCESSFULLY RECEIVED            */ 01553000
*       /*                                                           */ 01554000
*       /*************************************************************/ 01555000
*                                                                  0561 01556000
*       DO;                         /* HMASMPMG M1(HMA393I)TYPE(INFO)   01557000
*                                      TARGET(SYSOUT,LOG)VAR(CURSYSM#   01558000
*                                      )                             */ 01559000
*         HMASMMGP=HMASMMGP&&HMASMMGP;/* SET PARMS TO ZEROS          */ 01560000
         XC    HMASMMGP(24),HMASMMGP                               0562 01561000
*         MGPMGNO1=HMA393I;         /* SET UP MSG 1 CODE             */ 01562000
         SLR   @05,@05                                             0563 01563000
         IC    @05,HMA393I                                         0563 01564000
         STH   @05,MGPMGNO1                                        0563 01565000
*         MGPTYPE=MGPINFO;          /* SET MESSAGE TYPE              */ 01566000
         MVI   MGPTYPE,X'01'                                       0564 01567000
*         MGPPRINT='1'B;            /* SET TARGET FLAG               */ 01568000
*         MGPHLDS='1'B;             /* SET TARGET FLAG               */ 01569000
         OI    MGPPRINT,B'10010000'                                0566 01570000
*         MGPVARPT(1)=ADDR(CURSYSM#);/* SET VARIABLE PTR             */ 01571000
         LA    @05,CURSYSM#                                        0567 01572000
         ST    @05,MGPVARPT                                        0567 01573000
*         CALL HMASMMSG(HMASMMGP);  /* HAVE MESSAGE ISSUED           */ 01574000
         L     @15,@CV01466                                        0568 01575000
         LA    @01,@AL00568                                        0568 01576000
         BALR  @14,@15                                             0568 01577000
*       END;                                                       0569 01578000
*     END;                                                         0570 01579000
*   RETURN CODE(PUTSMRC);           /* RETURN TO CALLER              */ 01580000
@RF00559 L     @05,@PC00004                                        0571 01581000
         L     @15,PUTSMRC(,@05)                                   0571 01582000
         L     @14,@SA00004                                        0571 01583000
         LM    @00,@03,@SA00004+8                                  0571 01584000
         LM    @05,@12,@SA00004+24                                 0571 01585000
         BR    @14                                                 0571 01586000
*   END PUTSYSM;                                                   0572 01587000
*                                                                  0573 01588000
*/********************************************************************/ 01589000
*/*                                                                  */ 01590000
*/*   DELSYSM  - CLEANUP TLIB DATASETS FOR A FAILING SYSMOD          */ 01591000
*/*                                                                  */ 01592000
*/*              NOTE - SYSMREST MUST BE INITIALIZED WITH THE DATA   */ 01593000
*/*              WHICH DEFINES THE FIRST RELFILE GTA RECORD FOR THE  */ 01594000
*/*              SYSMOD WHICH FAILED.                                */ 01595000
*/*                                                                  */ 01596000
*/********************************************************************/ 01597000
*                                                                  0573 01598000
*DELSYSM:                                                          0573 01599000
*   PROC(DELSMRC);                                                 0573 01600000
DELSYSM  STM   @14,@12,@SA00005                                    0573 01601000
         MVC   @PC00005(4),0(@01)                                  0573 01602000
*   DCL                                                            0574 01603000
*     DELSMRC FIXED(31);            /* RETURN CODE PARAMETER         */ 01604000
*   DCL                                                            0575 01605000
*     FAILSMD CHAR(7);              /* SYSMOD-ID                     */ 01606000
*   DELSMRC=0;                      /* CLEAR RETURN CODE PARAMETER   */ 01607000
*                                                                  0576 01608000
         L     @09,@PC00005                                        0576 01609000
         SLR   @08,@08                                             0576 01610000
         ST    @08,DELSMRC(,@09)                                   0576 01611000
*   /*****************************************************************/ 01612000
*   /*                                                               */ 01613000
*   /* PUT SUMMARY RECORD FOR THIS SYSMOD TO GTA SUMMARY FILE        */ 01614000
*   /*                                                               */ 01615000
*   /*****************************************************************/ 01616000
*                                                                  0577 01617000
*   RECXGSMP->GTPFUNCT=GTPADD;      /* PUT RECORD BACK TO GTA        */ 01618000
         L     @09,@PC00001                                        0577 01619000
         L     @09,RECXGSMP(,@09)                                  0577 01620000
         MVI   GTPFUNCT(@09),X'04'                                 0577 01621000
*   CALL HMASMGTA(RECXGSMP->HMASMGTP);                             0578 01622000
         ST    @09,@AL00001                                        0578 01623000
         L     @15,@CV01465                                        0578 01624000
         LA    @01,@AL00001                                        0578 01625000
         BALR  @14,@15                                             0578 01626000
*   RESPECIFY                                                      0579 01627000
*     HMASMGTP BASED(RECXGRFP);     /* ADDRESS RELFILE GTP           */ 01628000
*                                                                  0579 01629000
*   /*****************************************************************/ 01630000
*   /*                                                               */ 01631000
*   /* RE-POSITION RELFILE GTA FILE TO FIRST RECORD FOR THIS SYSMOD  */ 01632000
*   /*                                                               */ 01633000
*   /*****************************************************************/ 01634000
*                                                                  0580 01635000
*   GTPFUNCT=GTPSTRTN;              /* RESTART AT SPECIFIED RECORD   */ 01636000
         L     @09,@PC00001                                        0580 01637000
         L     @09,RECXGRFP(,@09)                                  0580 01638000
         MVI   GTPFUNCT(@09),X'06'                                 0580 01639000
*   GTPRESTR=SYSMREST;              /* RESTART DATA                  */ 01640000
         MVC   GTPRESTR(10,@09),SYSMREST                           0581 01641000
*   GTPRCDLN=LENGTH(GRFREC);        /* RELFILE RECORD LENGTH         */ 01642000
         MVC   GTPRCDLN(2,@09),@CH00558                            0582 01643000
*   CALL HMASMGTA(HMASMGTP);        /* POSITION TO 1ST RECORD FOR  0583 01644000
*                                      CURRENT SYSMOD                */ 01645000
*                                                                  0583 01646000
         ST    @09,@AL00001                                        0583 01647000
         L     @15,@CV01465                                        0583 01648000
         LA    @01,@AL00001                                        0583 01649000
         BALR  @14,@15                                             0583 01650000
*   /*****************************************************************/ 01651000
*   /*                                                               */ 01652000
*   /* GET THE FIRST RELFILE RECORD FOR THE CURRENT SYSMOD           */ 01653000
*   /*                                                               */ 01654000
*   /*****************************************************************/ 01655000
*                                                                  0584 01656000
*   GTPFUNCT=GTPGETN;               /* GET NEXT RECORD FUNCTION      */ 01657000
         L     @09,@PC00001                                        0584 01658000
         L     @09,RECXGRFP(,@09)                                  0584 01659000
         MVI   GTPFUNCT(@09),X'08'                                 0584 01660000
*   CALL HMASMGTA(HMASMGTP);        /* GET THE 1ST RECORD FOR THE  0585 01661000
*                                      CURRENT SYSMOD                */ 01662000
         ST    @09,@AL00001                                        0585 01663000
         L     @15,@CV01465                                        0585 01664000
         LA    @01,@AL00001                                        0585 01665000
         BALR  @14,@15                                             0585 01666000
*   FAILSMD=GRFSM#;                 /* CURRENT SYSMOD-ID             */ 01667000
         L     @09,@PC00001                                        0586 01668000
         L     @01,RECXGRFP(,@09)                                  0586 01669000
         L     @01,GTPBUFAD(,@01)                                  0586 01670000
         MVC   FAILSMD(7),GRFSM#(@01)                              0586 01671000
*                                                                  0587 01672000
*   /*****************************************************************/ 01673000
*   /*                                                               */ 01674000
*   /* GO THRU ALL RELFILE RECORDS FOR THIS SYSMOD                   */ 01675000
*   /*                                                               */ 01676000
*   /*****************************************************************/ 01677000
*                                                                  0587 01678000
*   DO WHILE GTPRETRN^=GTPEOF       /* NOT AT END OF RELFILE GTA     */ 01679000
*         &GRFSM#=FAILSMD           /* RELFILE SYSMOD-ID = CURRENT   */ 01680000
*         &CCATLBP=ON;              /* TLIB DD PRESENT               */ 01681000
         B     @DE00587                                            0587 01682000
@DL00587 DS    0H                                                  0588 01683000
*     ABSFSEQ=GRFFSEQ;              /* SET UP SEQUENCE NUMBER        */ 01684000
*                                                                  0588 01685000
         L     @09,@PC00001                                        0588 01686000
         L     @01,RECXGRFP(,@09)                                  0588 01687000
         L     @08,GTPBUFAD(,@01)                                  0588 01688000
         MVC   ABSFSEQ(2),GRFFSEQ(@08)                             0588 01689000
*     /***************************************************************/ 01690000
*     /*                                                             */ 01691000
*     /* FORM TLIB DATASET NAME FOR THIS RELFILE                     */ 01692000
*     /*                                                             */ 01693000
*     /***************************************************************/ 01694000
*                                                                  0589 01695000
*     SPLPMAD=ADDR(SPLPDSN);        /* POINT TO PARAMETER LIST       */ 01696000
         L     @07,SPLPMAD                                         0589 01697000
         ST    @07,SPLPMAD                                         0589 01698000
*     SPLFUNCT=SPLBDDSN;            /* INDICATE DSN TO BE BUILT      */ 01699000
         MVI   SPLFUNCT,X'05'                                      0590 01700000
*     SPLIPFX=RECXIOPP->IOPPTPFX;   /* DSN PREFIX FROM SYSMOD IOP    */ 01701000
         L     @06,RECXIOPP(,@09)                                  0591 01702000
         MVC   SPLIPFX(26,@07),IOPPTPFX(@06)                       0591 01703000
*     SPLISMD=RECXIOPP->IOPNAM17;   /* CURRENT SYSMOD-ID             */ 01704000
         MVC   SPLISMD(7,@07),IOPNAM17(@06)                        0592 01705000
*     SPLIFIL=GRFRELF#;             /* RELFILE (BINARY)              */ 01706000
         MVC   SPLIFIL(2,@07),GRFRELF#(@08)                        0593 01707000
*     CALL HMASMSUB(HMASMSPL);      /* FORM TLIB DSNAME              */ 01708000
*                                                                  0594 01709000
         L     @15,@CV01467                                        0594 01710000
         LA    @01,@AL00594                                        0594 01711000
         BALR  @14,@15                                             0594 01712000
*     /***************************************************************/ 01713000
*     /*                                                             */ 01714000
*     /* DELETE TLIB DATASET FOR THIS RELFILE                        */ 01715000
*     /*                                                             */ 01716000
*     /***************************************************************/ 01717000
*                                                                  0595 01718000
*     RECXIOPG->IOPFUNCT=IOPDEL;    /* DELETE DATASET FUNCTION       */ 01719000
         L     @09,@PC00001                                        0595 01720000
         L     @09,RECXIOPG(,@09)                                  0595 01721000
         MVI   IOPFUNCT(@09),X'0F'                                 0595 01722000
*     RECXIOPG->IOPDSID=IOPLRF;     /* TLIB DATASET                  */ 01723000
         MVI   IOPDSID(@09),X'20'                                  0596 01724000
*     RECXIOPG->IOPDDNAM='SMPTLIB'; /* DDNAME FOR TLIB VOLUME(S)     */ 01725000
         MVI   IOPDDNAM+7(@09),C' '                                0597 01726000
         MVC   IOPDDNAM(7,@09),@CC01647                            0597 01727000
*     RECXIOPG->IOPDSN=SPLODSN;     /* TLIB DSN FORMED ABOVE         */ 01728000
         L     @08,SPLPMAD                                         0598 01729000
         MVC   IOPDSN(44,@09),SPLODSN(@08)                         0598 01730000
*     CALL HMASMIO(RECXIOPG->HMASMIOP);/* DELETE DATASET             */ 01731000
*                                                                  0599 01732000
         ST    @09,@AL00001                                        0599 01733000
         L     @15,@CV01464                                        0599 01734000
         LA    @01,@AL00001                                        0599 01735000
         BALR  @14,@15                                             0599 01736000
*     /***************************************************************/ 01737000
*     /*                                                             */ 01738000
*     /* READ RELFILE GTA UNTIL NEXT RELFILE FOR THIS SYSMOD (OR EOF)*/ 01739000
*     /* IS ENCOUNTERED                                              */ 01740000
*     /*                                                             */ 01741000
*     /***************************************************************/ 01742000
*                                                                  0600 01743000
*     DO WHILE GTPRETRN^=GTPEOF&    /* NOT AT END OF GTA FILE        */ 01744000
*           ABSFSEQ=GRFFSEQ;        /* STILL THE SAME FILE SEQ #     */ 01745000
         B     @DE00600                                            0600 01746000
@DL00600 DS    0H                                                  0601 01747000
*       GTPFUNCT=GTPGETN;           /* GET NEXT RECORD FUNCTION      */ 01748000
         L     @09,@PC00001                                        0601 01749000
         L     @09,RECXGRFP(,@09)                                  0601 01750000
         MVI   GTPFUNCT(@09),X'08'                                 0601 01751000
*       CALL HMASMGTA(HMASMGTP);    /* GET THE NEXT RECORD           */ 01752000
         ST    @09,@AL00001                                        0602 01753000
         L     @15,@CV01465                                        0602 01754000
         LA    @01,@AL00001                                        0602 01755000
         BALR  @14,@15                                             0602 01756000
*     END;                                                         0603 01757000
@DE00600 L     @09,@PC00001                                        0603 01758000
         L     @09,RECXGRFP(,@09)                                  0603 01759000
         CLI   GTPRETRN(@09),4                                     0603 01760000
         BE    @DC00600                                            0603 01761000
         L     @01,GTPBUFAD(,@09)                                  0603 01762000
         CLC   ABSFSEQ(2),GRFFSEQ(@01)                             0603 01763000
         BE    @DL00600                                            0603 01764000
@DC00600 DS    0H                                                  0604 01765000
*   END;                                                           0604 01766000
@DE00587 L     @09,@PC00001                                        0604 01767000
         L     @09,RECXGRFP(,@09)                                  0604 01768000
         CLI   GTPRETRN(@09),4                                     0604 01769000
         BE    @DC00587                                            0604 01770000
         L     @01,GTPBUFAD(,@09)                                  0604 01771000
         CLC   GRFSM#(7,@01),FAILSMD                               0604 01772000
         BNE   @DC00587                                            0604 01773000
         TM    CCATLBP(CCAPTR),B'10000000'                         0604 01774000
         BO    @DL00587                                            0604 01775000
@DC00587 DS    0H                                                  0605 01776000
*   IF GTPRETRN>=GTPEOF             /* END OF GTA FILE ENCOUNTERED   */ 01777000
*     THEN                                                         0605 01778000
         L     @09,@PC00001                                        0605 01779000
         L     @01,RECXGRFP(,@09)                                  0605 01780000
         CLI   GTPRETRN(@01),4                                     0605 01781000
         BL    @RF00605                                            0605 01782000
*     EOFSW=ON;                     /* SET END-OF-FILE SWITCH        */ 01783000
         OI    EOFSW,B'00100000'                                   0606 01784000
*   RETURN CODE(DELSMRC);                                          0607 01785000
@RF00605 L     @09,@PC00005                                        0607 01786000
         L     @15,DELSMRC(,@09)                                   0607 01787000
         L     @14,@SA00005                                        0607 01788000
         LM    @00,@12,@SA00005+8                                  0607 01789000
         BR    @14                                                 0607 01790000
*   END DELSYSM;                                                   0608 01791000
*                                                                  0609 01792000
*/********************************************************************/ 01793000
*/*                                                                  */ 01794000
*/*   GETSYSM  - GET RECEIVE SUMMARY FILE RECORD AND SMPPTS SYSMOD   */ 01795000
*/*              ENTRY FOR THE SYSMOD TO BE PROCESSED                */ 01796000
*/*                                                                  */ 01797000
*/*                                                                  */ 01798000
*/*                                                                  */ 01799000
*/*                                                                  */ 01800000
*/********************************************************************/ 01801000
*                                                                  0609 01802000
*GETSYSM:                                                          0609 01803000
*   PROC(SUMSYSM,SUMSYSTY,GETSMRC);                                0609 01804000
GETSYSM  STM   @14,@03,@SA00006                                    0609 01805000
         STM   @05,@12,@SA00006+24                                 0609 01806000
         MVC   @PC00006(12),0(@01)                                 0609 01807000
*   DCL                                                            0610 01808000
*     SUMSYSM CHAR(7);              /* SYSMOD-ID                     */ 01809000
*   DCL                                                            0611 01810000
*     SUMSYSTY CHAR(1);             /* SYSMOD TYPE                   */ 01811000
*   DCL                                                            0612 01812000
*     GETSMRC FIXED(31);            /* RETURN CODE PARAMETER         */ 01813000
*   GETSMRC=0;                      /* CLEAR RETURN CODE             */ 01814000
*                                                                  0613 01815000
         L     @05,@PC00006+8                                      0613 01816000
         SLR   @09,@09                                             0613 01817000
         ST    @09,GETSMRC(,@05)                                   0613 01818000
*   /*****************************************************************/ 01819000
*   /*                                                               */ 01820000
*   /* GET NEW SYSMOD FROM SUMMARY FILE                              */ 01821000
*   /*                                                               */ 01822000
*   /*****************************************************************/ 01823000
*                                                                  0614 01824000
*   GSMS#=SUMSYSM;                  /* SET SYSMOD NUMBER FOR LOCATE  */ 01825000
         L     @05,@PC00001                                        0614 01826000
         L     @05,RECXGSMP(,@05)                                  0614 01827000
         L     @09,GTPBUFAD(,@05)                                  0614 01828000
         L     @08,@PC00006                                        0614 01829000
         MVC   GSMS#(7,@09),SUMSYSM(@08)                           0614 01830000
*   GSMSTY=SUMSYSTY;                /* SET SYSMOD TYPE FOR LOCATE    */ 01831000
         L     @08,@PC00006+4                                      0615 01832000
         MVC   GSMSTY(1,@09),SUMSYSTY(@08)                         0615 01833000
*   RFY                                                            0616 01834000
*     HMASMGTP BASED(RECXGSMP);     /* REBASE HMASMGTP               */ 01835000
*   DO;                             /* HMASMGPF F(GTPLOC)KLEN(LENGTH(   01836000
*                                      GSMKEY))RLEN(LENGTH(GSMREC))B(   01837000
*                                      RECXGSMP)                     */ 01838000
*     GTPFUNCT=GTPLOC;              /* SET UP FUNCTION CODE          */ 01839000
         MVI   GTPFUNCT(@05),X'03'                                 0618 01840000
*     GTPRCDLN=LENGTH(GSMREC);      /* SET UP RLEN                   */ 01841000
         MVC   GTPRCDLN(2,@05),@CH00543                            0619 01842000
*     GTPKEYLN=LENGTH(GSMKEY);      /* SET UP KLEN                   */ 01843000
         MVC   GTPKEYLN(2,@05),@CH00037                            0620 01844000
*     CALL HMASMGTA(HMASMGTP);      /* HAVE FUNCTION PERFORMED       */ 01845000
         ST    @05,@AL00001                                        0621 01846000
         L     @15,@CV01465                                        0621 01847000
         LA    @01,@AL00001                                        0621 01848000
         BALR  @14,@15                                             0621 01849000
*   END;                                                           0622 01850000
*   IF GTPRETRN=GTPNTFND THEN       /* IF RECORD NOT FOUND THEN      */ 01851000
         L     @05,@PC00001                                        0623 01852000
         L     @05,RECXGSMP(,@05)                                  0623 01853000
         CLI   GTPRETRN(@05),4                                     0623 01854000
         BNE   @RF00623                                            0623 01855000
*     DO;                           /* RETURN TO CALLER              */ 01856000
*                                                                  0624 01857000
*       /*************************************************************/ 01858000
*       /*                                                           */ 01859000
*       /* RECORD NOT FOUND ... INTERNAL PROCESSING ERROR            */ 01860000
*       /*                                                           */ 01861000
*       /*************************************************************/ 01862000
*                                                                  0625 01863000
*       GETSMRC=STOPFUNC;                                          0625 01864000
         L     @05,@PC00006+8                                      0625 01865000
         MVC   GETSMRC(4,@05),@CF00034                             0625 01866000
*     END;                                                         0626 01867000
*   ELSE                                                           0627 01868000
*     DO;                                                          0627 01869000
*                                                                  0627 01870000
         B     @RC00623                                            0627 01871000
@RF00623 DS    0H                                                  0628 01872000
*       /*************************************************************/ 01873000
*       /*                                                           */ 01874000
*       /* GET SYSMOD ENTRY FROM PTS                                 */ 01875000
*       /*                                                           */ 01876000
*       /*************************************************************/ 01877000
*                                                                  0628 01878000
*       DO;                         /* HMASMRIO F(IOPLOC)IOP((RECXIOP   01879000
*                                      P))DSID(IOPPTS)NAME(SUMSYSM)TY   01880000
*                                      PE(IOPSMD)                    */ 01881000
*         IOPPTR=(RECXIOPP);        /* SET UP IOP ADDRESS            */ 01882000
         L     @09,@PC00001                                        0629 01883000
         L     IOPPTR,RECXIOPP(,@09)                               0629 01884000
*         IOPFUNCT=IOPLOC;          /* SET UP FUNCTION CODE          */ 01885000
         MVI   IOPFUNCT(IOPPTR),X'03'                              0630 01886000
*         IOPDSID=IOPPTS;           /* SET UP DSN CODE               */ 01887000
         MVI   IOPDSID(IOPPTR),X'06'                               0631 01888000
*         IOPNAME=SUMSYSM;          /* SET UP NAME                   */ 01889000
         MVI   IOPNAME+7(IOPPTR),C' '                              0632 01890000
         L     @05,@PC00006                                        0632 01891000
         MVC   IOPNAME(7,IOPPTR),SUMSYSM(@05)                      0632 01892000
*         IOPTYPE=IOPSMD;           /* SET UP TYPE                   */ 01893000
         MVI   IOPTYPE(IOPPTR),X'0B'                               0633 01894000
*         CALL HMASMIO(HMASMIOP);   /* HAVE I/O PERFORMED            */ 01895000
         ST    IOPPTR,@AL00001                                     0634 01896000
         L     @15,@CV01464                                        0634 01897000
         LA    @01,@AL00001                                        0634 01898000
         BALR  @14,@15                                             0634 01899000
*       END;                                                       0635 01900000
*       GETSMRC=IOPRETRN;           /* SAVE LOCATE RETURN CODE       */ 01901000
         L     @05,@PC00006+8                                      0636 01902000
         SLR   @09,@09                                             0636 01903000
         IC    @09,IOPRETRN(,IOPPTR)                               0636 01904000
         ST    @09,GETSMRC(,@05)                                   0636 01905000
*       IF IOPRETRN=IOPNOTFD THEN   /* IF ENTRY NOT FOUND IN PTS     */ 01906000
         CLI   IOPRETRN(IOPPTR),4                                  0637 01907000
         BNE   @RF00637                                            0637 01908000
*         DO;                       /* ISSUE ERROR MESSAGE           */ 01909000
*                                                                  0638 01910000
*           /*********************************************************/ 01911000
*           /*                                                       */ 01912000
*           /* SYSMOD ENTRY NOT FOUND ON PTS ... ISSUE MESSAGE       */ 01913000
*           /* HMA246I AND HMA391I                                   */ 01914000
*           /*                                                       */ 01915000
*           /*********************************************************/ 01916000
*                                                                  0639 01917000
*           GETSMRC=STOPPTF;        /* SET RETURN CODE               */ 01918000
         MVC   GETSMRC(4,@05),@CF00037                             0639 01919000
*           HMASMMGP=''B;           /* CLEAR MGP                     */ 01920000
         XC    HMASMMGP(24),HMASMMGP                               0640 01921000
*           MGPMGNO1=HMA246I;       /* SET MESSAGE ID                */ 01922000
         SLR   @05,@05                                             0641 01923000
         IC    @05,HMA246I                                         0641 01924000
         STH   @05,MGPMGNO1                                        0641 01925000
*           MGPVARPT(1)=ADDR(SUMSYSM);/* SET SYSMOD-ID IN MSG        */ 01926000
         L     @05,@PC00006                                        0642 01927000
         ST    @05,MGPVARPT                                        0642 01928000
*           MGPVARPT(1)=ADDR(ENTRYX);/* ENTRY TYPE ("SYSMOD")        */ 01929000
         LA    @05,ENTRYX                                          0643 01930000
         ST    @05,MGPVARPT                                        0643 01931000
*           MGPVARPT(1)=ADDR(SMPPTS);/* DATASET ("SMPPTS")           */ 01932000
         LA    @05,SMPPTS                                          0644 01933000
         ST    @05,MGPVARPT                                        0644 01934000
*           MGPTYPE=MGPERR;         /* STOP-SYSMOD ERROR             */ 01935000
         MVI   MGPTYPE,X'03'                                       0645 01936000
*           MGPPRINT=ON;            /* PUT TO SMPOUT                 */ 01937000
*           MGPHLDS=ON;             /* PUT TO SMPLOG                 */ 01938000
         OI    MGPPRINT,B'10010000'                                0647 01939000
*           CALL HMASMMSG(HMASMMGP);/* ISSUE MESSAGE                 */ 01940000
         L     @15,@CV01466                                        0648 01941000
         LA    @01,@AL00648                                        0648 01942000
         BALR  @14,@15                                             0648 01943000
*           HMASMMGP=''B;           /* CLEAR MGP                     */ 01944000
         XC    HMASMMGP(24),HMASMMGP                               0649 01945000
*           MGPMGNO1=HMA391I;       /* SET MESSAGE ID                */ 01946000
         SLR   @05,@05                                             0650 01947000
         IC    @05,HMA391I                                         0650 01948000
         STH   @05,MGPMGNO1                                        0650 01949000
*           MGPVARPT(1)=ADDR(SUMSYSM);/* SET SYSMOD-ID IN MSG        */ 01950000
         L     @05,@PC00006                                        0651 01951000
         ST    @05,MGPVARPT                                        0651 01952000
*           MGPTYPE=MGPERR;         /* STOP-SYSMOD ERROR             */ 01953000
         MVI   MGPTYPE,X'03'                                       0652 01954000
*           MGPPRINT=ON;            /* PUT TO SMPOUT                 */ 01955000
*           MGPHLDS=ON;             /* PUT TO SMPLOG                 */ 01956000
         OI    MGPPRINT,B'10010000'                                0654 01957000
*           CALL HMASMMSG(HMASMMGP);/* ISSUE MESSAGE                 */ 01958000
         L     @15,@CV01466                                        0655 01959000
         LA    @01,@AL00655                                        0655 01960000
         BALR  @14,@15                                             0655 01961000
*           GSMLERR=ON;             /* POST LOAD ERROR IN SUMMARY    */ 01962000
*                                                                  0656 01963000
         L     @05,@PC00001                                        0656 01964000
         L     @05,RECXGSMP(,@05)                                  0656 01965000
         L     @01,GTPBUFAD(,@05)                                  0656 01966000
         OI    GSMLERR(@01),B'00000010'                            0656 01967000
*           /*********************************************************/ 01968000
*           /*                                                       */ 01969000
*           /* PUT SUMMARY RECORD BACK TO GTA WITH GSMLERR INDICATOR */ 01970000
*           /* SET                                                   */ 01971000
*           /*                                                       */ 01972000
*           /*********************************************************/ 01973000
*                                                                  0657 01974000
*           RFY                                                    0657 01975000
*             HMASMGTP BASED(RECXGSMP);/* REBASE HMASMGTP            */ 01976000
*           DO;                     /* HMASMGPF F(GTPADD)KLEN(LENGTH(   01977000
*                                      GSMKEY))RLEN(LENGTH(GSMREC))B(   01978000
*                                      RECXGSMP)                     */ 01979000
*             GTPFUNCT=GTPADD;      /* SET UP FUNCTION CODE          */ 01980000
         MVI   GTPFUNCT(@05),X'04'                                 0659 01981000
*             GTPRCDLN=LENGTH(GSMREC);/* SET UP RLEN                 */ 01982000
         MVC   GTPRCDLN(2,@05),@CH00543                            0660 01983000
*             GTPKEYLN=LENGTH(GSMKEY);/* SET UP KLEN                 */ 01984000
         MVC   GTPKEYLN(2,@05),@CH00037                            0661 01985000
*             CALL HMASMGTA(HMASMGTP);/* HAVE FUNCTION PERFORMED     */ 01986000
         ST    @05,@AL00001                                        0662 01987000
         L     @15,@CV01465                                        0662 01988000
         LA    @01,@AL00001                                        0662 01989000
         BALR  @14,@15                                             0662 01990000
*           END;                                                   0663 01991000
*         END;                                                     0664 01992000
*     END;                                                         0665 01993000
@RF00637 DS    0H                                                  0666 01994000
*   RETURN CODE(GETSMRC);           /* RETURN TO CALLER              */ 01995000
@RC00623 L     @05,@PC00006+8                                      0666 01996000
         L     @15,GETSMRC(,@05)                                   0666 01997000
         L     @14,@SA00006                                        0666 01998000
         LM    @00,@03,@SA00006+8                                  0666 01999000
         LM    @05,@12,@SA00006+24                                 0666 02000000
         BR    @14                                                 0666 02001000
*   END GETSYSM;                                                   0667 02002000
*   END HMASMRCD                                                   0668 02003000
*                                                                  0668 02004000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 02005000
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */ 02006000
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */ 02007000
*/*%INCLUDE SYSLIB  (HMASMGTP)                                       */ 02008000
*/*%INCLUDE SYSLIB  (HMASMMCB)                                       */ 02009000
*/*%INCLUDE SYSLIB  (HMASMSPL)                                       */ 02010000
*/*%INCLUDE SYSLIB  (HMASMMGP)                                       */ 02011000
*                                                                  0668 02012000
*       ;                                                          0668 02013000
@DATA    DS    0H                                                       02014000
@CH00041 DC    H'1'                                                     02015000
@CH00090 DC    H'6'                                                     02016000
@CH00341 DC    H'14'                                                    02017000
@CH00543 DC    H'18'                                                    02018000
@CH00558 DC    H'26'                                                    02019000
         DS    0F                                                       02020000
@AL00222 EQU   *                       LIST WITH   1 ARGUMENT(S)        02021000
@AL00226 EQU   *                       LIST WITH   1 ARGUMENT(S)        02022000
@AL00230 EQU   *                       LIST WITH   1 ARGUMENT(S)        02023000
@AL00237 EQU   *                       LIST WITH   1 ARGUMENT(S)        02024000
@AL00241 DC    A(SUBRC)                LIST WITH   1 ARGUMENT(S)        02025000
@AL00272 EQU   *                       LIST WITH   1 ARGUMENT(S)        02026000
@AL00495 EQU   *                       LIST WITH   1 ARGUMENT(S)        02027000
@AL00548 EQU   *                       LIST WITH   1 ARGUMENT(S)        02028000
@AL00568 EQU   *                       LIST WITH   1 ARGUMENT(S)        02029000
@AL00648 EQU   *                       LIST WITH   1 ARGUMENT(S)        02030000
@AL00655 DC    A(HMASMMGP)             LIST WITH   1 ARGUMENT(S)        02031000
@AL00420 EQU   *                       LIST WITH   1 ARGUMENT(S)        02032000
@AL00594 DC    A(HMASMSPL)             LIST WITH   1 ARGUMENT(S)        02033000
         DS    0F                                                       02034000
@SA00001 DS    18F                                                      02035000
@PC00001 DS    1F                                                       02036000
@SA00002 DS    14F                                                      02037000
@PC00002 DS    1F                                                       02038000
@SA00003 DS    14F                                                      02039000
@PC00003 DS    1F                                                       02040000
@SA00006 DS    0F                                                       02041000
@PC00006 EQU   @SA00006+56                                              02042000
@SA00004 DS    0F                                                       02043000
@PC00004 EQU   @SA00004+56                                              02044000
@SA00005 DS    0F                                                       02045000
@PC00005 EQU   @SA00005+60                                              02046000
         DS    17F                                                      02047000
@AL00001 DS    3A                                                       02048000
         DS    0F                                                       02049000
@CF00037 DC    F'8'                                                     02050000
@CH00037 EQU   @CF00037+2                                               02051000
@CF00034 DC    F'12'                                                    02052000
@CH00034 EQU   @CF00034+2                                               02053000
@CV01464 DC    V(HMASMIO)                                               02054000
@CV01465 DC    V(HMASMGTA)                                              02055000
@CV01466 DC    V(HMASMMSG)                                              02056000
@CV01467 DC    V(HMASMSUB)                                              02057000
         DS    0D                                                       02058000
P        DS    A                                                        02059000
SUBRC    DS    F                                                        02060000
MAXCOPY  DS    F                                                        02061000
SUB1RC   DS    F                                                        02062000
ABSFSEQ  DC    H'0'                                                     02063000
TAPEASEQ DC    H'0'                                                     02064000
TLIBDSS# DC    H'0'                                                     02065000
HMA246I  DC    AL1(47)                                                  02066000
HMA351I  DC    AL1(152)                                                 02067000
HMA391I  DC    AL1(192)                                                 02068000
HMA393I  DC    AL1(194)                                                 02069000
HMA394I  DC    AL1(195)                                                 02070000
PART102  DC    AL1(102)                                                 02071000
PART103  DC    AL1(103)                                                 02072000
@CC01647 DC    C'SMPTLIB'                                               02073000
@CC01544 DC    C',,R),('                                                02074000
@CC01636 DC    C') '                                                    02075000
HMASMSPL DS    CL5                                                      02076000
         ORG   HMASMSPL                                                 02077000
SPLPMAD  DS    AL4                                                      02078000
SPLFUNCT DS    FL1                                                      02079000
         ORG   HMASMSPL+5                                               02080000
SAVRVANM DS    CL8                                                      02081000
         DS    CL3                                                      02082000
HMASMMGP DS    CL24                                                     02083000
         ORG   HMASMMGP                                                 02084000
MGPFIXED DS    CL12                                                     02085000
         ORG   MGPFIXED                                                 02086000
MGPCLEAR DS    CL6                                                      02087000
         ORG   MGPCLEAR                                                 02088000
MGPMGNO1 DS    FL2                                                      02089000
MGPMGNO2 DS    FL2                                                      02090000
MGPMGNO3 DS    FL2                                                      02091000
         ORG   MGPFIXED+6                                               02092000
MGPFLAGS DS    BL2                                                      02093000
         ORG   MGPFLAGS                                                 02094000
MGPPRINT DS    BL1                                                      02095000
MGPLIST  EQU   MGPFLAGS+0                                               02096000
MGPRPT   EQU   MGPFLAGS+0                                               02097000
MGPHLDS  EQU   MGPFLAGS+0                                               02098000
MGPWTOR  EQU   MGPFLAGS+0                                               02099000
MGPWTO   EQU   MGPFLAGS+0                                               02100000
MGPWTP   EQU   MGPFLAGS+0                                               02101000
@NM00196 EQU   MGPFLAGS+0                                               02102000
         ORG   MGPFIXED+8                                               02103000
MGPTYPE  DS    FL1                                                      02104000
@NM00197 DS    CL3                                                      02105000
         ORG   HMASMMGP+12                                              02106000
MGPVAR   DS    CL12                                                     02107000
         ORG   MGPVAR                                                   02108000
MGPVARPT DS    3A                                                       02109000
         ORG   HMASMMGP+24                                              02110000
ENTRYX   DC    CL5'ENTRY'                                               02111000
SMPPTS   DC    CL6'SMPPTS'                                              02112000
CURSYSM# DC    CL7' '                                                   02113000
LSW      DS    BL1                                                      02114000
         ORG   LSW                                                      02115000
CURSYSM  DS    BL1                                                      02116000
NEWSYSM  EQU   LSW+0                                                    02117000
EOFSW    EQU   LSW+0                                                    02118000
@NM00198 EQU   LSW+0                                                    02119000
         ORG   LSW+1                                                    02120000
         DS    CL1                                                      02121000
PKDDEC   DS    CL8                                                      02122000
EBCDIC   DS    CL8                                                      02123000
FILETYPE DS    BL1                                                      02124000
         ORG   FILETYPE                                                 02125000
DMOD     DS    BL1                                                      02126000
DMAC     EQU   FILETYPE+0                                               02127000
DSRC     EQU   FILETYPE+0                                               02128000
DJCL     EQU   FILETYPE+0                                               02129000
@NM00199 EQU   FILETYPE+0                                               02130000
         ORG   FILETYPE+1                                               02131000
         DS    CL3                                                      02132000
RELFREST DS    CL10                                                     02133000
         DS    CL2                                                      02134000
SYSMREST DS    CL10                                                     02135000
COPYCARD DS    CL80                                                     02136000
         ORG   COPYCARD                                                 02137000
@NM00200 DC    CL33' COPY INDD=SMPPTFIN,OUTDD=SMPTLIB'                  02138000
@NM00201 DC    CL7' '                                                   02139000
@NM00202 DC    CL10'RELFILE - '                                         02140000
CCRELF   DS    CL4                                                      02141000
@NM00203 DC    CL18' '                                                  02142000
CCSMD    DS    CL7                                                      02143000
@NM00204 DC    CL1' '                                                   02144000
         ORG   COPYCARD+80                                              02145000
SCARD    DS    CL80                                                     02146000
         ORG   SCARD                                                    02147000
@NM00205 DC    CL8'  S M=(('                                            02148000
SCDATA   DC    CL62' '                                                  02149000
         ORG   SCDATA                                                   02150000
SCDCOL   DS    CL1                                                      02151000
         ORG   SCARD+70                                                 02152000
SCEND    DC    CL1' '                                                   02153000
SC72     DC    CL1' '                                                   02154000
SCSMD    DC    CL7' '                                                   02155000
@NM00206 DC    CL1' '                                                   02156000
         ORG   SCARD+80                                                 02157000
ALTDD    DS    CL90                                                     02158000
         ORG   ALTDD                                                    02159000
@NM00207 DC    AL2(88)                                                  02160000
ALTNAMES DS    CL88                                                     02161000
         ORG   ALTNAMES                                                 02162000
@NM00208 DC    32X'00'                                                  02163000
@NM00209 DC    CL8'SYSUT1'                                              02164000
@NM00210 DC    32X'00'                                                  02165000
@NM00211 DC    CL8'SYSUT2'                                              02166000
@NM00212 DC    CL8'SYSUT3'                                              02167000
         ORG   ALTDD+90                                                 02168000
TAPEDSN  DS    CL44                                                     02169000
         ORG   TAPEDSN                                                  02170000
TAPESREL DS    CL11                                                     02171000
         ORG   TAPESREL                                                 02172000
TAPESYSM DS    CL7                                                      02173000
@NM00213 DC    CL2'.F'                                                  02174000
TAPERELF DS    CL2                                                      02175000
         ORG   TAPEDSN+11                                               02176000
@NM00214 DC    CL33' '                                                  02177000
         ORG   TAPEDSN+44                                               02178000
LOCSPL   DS    CL44                                                     02179000
PATCHRCD DS    CL80                                                     02180000
         ORG   PATCHRCD                                                 02181000
@NM00215 DC    80X'FF'                                                  02182000
         ORG   PATCHRCD+80                                              02183000
COPYFFLG DS    BL1                                                      02184000
         ORG   COPYFFLG                                                 02185000
COPYFALC DS    BL1                                                      02186000
COPYFPOS EQU   COPYFFLG+0                                               02187000
@NM00216 EQU   COPYFFLG+0                                               02188000
         ORG   COPYFFLG+1                                               02189000
FAILSMD  DS    CL7                                                      02190000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02191000
@01      EQU   01                                                       02192000
@02      EQU   02                                                       02193000
@03      EQU   03                                                       02194000
@04      EQU   04                                                       02195000
@05      EQU   05                                                       02196000
@06      EQU   06                                                       02197000
@07      EQU   07                                                       02198000
@08      EQU   08                                                       02199000
@09      EQU   09                                                       02200000
@10      EQU   10                                                       02201000
@11      EQU   11                                                       02202000
@12      EQU   12                                                       02203000
@13      EQU   13                                                       02204000
@14      EQU   14                                                       02205000
@15      EQU   15                                                       02206000
FIX31    EQU   @05                                                      02207000
COLPTR   EQU   @05                                                      02208000
I        EQU   @06                                                      02209000
IOPPTR   EQU   @04                                                      02210000
CCAPTR   EQU   @11                                                      02211000
RTNREG   EQU   @14                                                      02212000
RTNCODE  EQU   @15                                                      02213000
GSMREC   EQU   0                                                        02214000
GSMKEY   EQU   GSMREC                                                   02215000
GSMS#    EQU   GSMKEY                                                   02216000
GSMSTY   EQU   GSMKEY+7                                                 02217000
GSMSTAT1 EQU   GSMREC+15                                                02218000
GSMLERR  EQU   GSMSTAT1                                                 02219000
GSMSTAT2 EQU   GSMREC+17                                                02220000
GSMRECVD EQU   GSMSTAT2                                                 02221000
GSMRLFP  EQU   GSMSTAT2                                                 02222000
GSMRLFL  EQU   GSMSTAT2                                                 02223000
GSRREC   EQU   0                                                        02224000
GSRKEY   EQU   GSRREC                                                   02225000
GRFREC   EQU   0                                                        02226000
GRFKEY   EQU   GRFREC                                                   02227000
GRFFSEQ  EQU   GRFKEY                                                   02228000
GRFELEM  EQU   GRFKEY+2                                                 02229000
GRFELTY  EQU   GRFKEY+10                                                02230000
GRFSM#   EQU   GRFREC+11                                                02231000
GRFSTY   EQU   GRFREC+18                                                02232000
GRFFLGS  EQU   GRFREC+19                                                02233000
GRFFLUSH EQU   GRFFLGS                                                  02234000
GRFLOADD EQU   GRFFLGS                                                  02235000
GRFRELF# EQU   GRFREC+20                                                02236000
GRFRELF  EQU   GRFREC+22                                                02237000
GPSREC   EQU   0                                                        02238000
GPSKEY   EQU   GPSREC                                                   02239000
HMASMCCA EQU   0                                                        02240000
CCAFBUFR EQU   HMASMCCA+4                                               02241000
CCADSAD  EQU   CCAFBUFR+124                                             02242000
CCATPAD  EQU   CCAFBUFR+128                                             02243000
CCAFLAG7 EQU   CCAFBUFR+132                                             02244000
CCATLBP  EQU   CCAFLAG7+2                                               02245000
CCAFIOP  EQU   HMASMCCA+140                                             02246000
CCAFSYS  EQU   HMASMCCA+148                                             02247000
CCASREL  EQU   CCAFSYS+12                                               02248000
CCAFLAGA EQU   CCAFSYS+21                                               02249000
CCAFSTA  EQU   HMASMCCA+188                                             02250000
CCARVAD  EQU   CCAFSTA                                                  02251000
CCAFICT  EQU   HMASMCCA+192                                             02252000
CCAFPGM  EQU   HMASMCCA+208                                             02253000
CCABLDLP EQU   CCAFPGM                                                  02254000
CCADBLDL EQU   CCAFPGM+4                                                02255000
CCAFGTP  EQU   HMASMCCA+224                                             02256000
CCASEGTP EQU   CCAFGTP                                                  02257000
@NM00017 EQU   HMASMCCA+244                                             02258000
CCAFFUNC EQU   HMASMCCA+264                                             02259000
CCAFLAG1 EQU   CCAFFUNC+8                                               02260000
CCAFLAG2 EQU   CCAFFUNC+11                                              02261000
CCAFPROC EQU   HMASMCCA+276                                             02262000
CCAFLAG3 EQU   CCAFPROC                                                 02263000
CCAFDIS  EQU   HMASMCCA+278                                             02264000
CCAFLAG4 EQU   CCAFDIS                                                  02265000
CCAFLAG5 EQU   CCAFDIS+1                                                02266000
CCAFLAG6 EQU   CCAFDIS+2                                                02267000
CCAFCNV  EQU   HMASMCCA+281                                             02268000
CCAFLAG8 EQU   CCAFCNV                                                  02269000
CCAFCTL  EQU   HMASMCCA+282                                             02270000
CCAFLAG9 EQU   CCAFCTL                                                  02271000
CCAFDSNG EQU   HMASMCCA+298                                             02272000
CCAFLAGB EQU   CCAFDSNG                                                 02273000
CCABLDLA EQU   0                                                        02274000
@NM00033 EQU   CCABLDLA                                                 02275000
CCABLDLL EQU   0                                                        02276000
@NM00035 EQU   CCABLDLL                                                 02277000
CCALKDRC EQU   @NM00035+20                                              02278000
@NM00037 EQU   CCABLDLL+124                                             02279000
CCAASMRC EQU   @NM00037+20                                              02280000
@NM00039 EQU   CCABLDLL+248                                             02281000
CCACPYNM EQU   @NM00039                                                 02282000
CCACOPY  EQU   @NM00039+8                                               02283000
CCACPYRC EQU   @NM00039+20                                              02284000
@NM00041 EQU   CCABLDLL+372                                             02285000
CCACOMRC EQU   @NM00041+20                                              02286000
@NM00043 EQU   CCABLDLL+496                                             02287000
CCAZAPRC EQU   @NM00043+20                                              02288000
@NM00045 EQU   CCABLDLL+620                                             02289000
CCASUPRC EQU   @NM00045+20                                              02290000
@NM00047 EQU   CCABLDLL+744                                             02291000
CCAUPDRC EQU   @NM00047+20                                              02292000
CCABLDLM EQU   0                                                        02293000
CCABELMT EQU   CCABLDLM+4                                               02294000
CCABMPOS EQU   CCABELMT                                                 02295000
HMASMIOP EQU   0                                                        02296000
IOPDSID  EQU   HMASMIOP                                                 02297000
IOPFUNCT EQU   HMASMIOP+1                                               02298000
IOPRETRN EQU   HMASMIOP+2                                               02299000
IOPTYPE  EQU   HMASMIOP+3                                               02300000
IOPNAME  EQU   HMASMIOP+4                                               02301000
IOPNAM17 EQU   IOPNAME                                                  02302000
@NM00051 EQU   HMASMIOP+12                                              02303000
@NM00052 EQU   @NM00051                                                 02304000
IOPSEQNO EQU   @NM00051+8                                               02305000
IOPDDNAM EQU   HMASMIOP+24                                              02306000
IOPBUFAD EQU   HMASMIOP+52                                              02307000
IOPDRMAP EQU   HMASMIOP+56                                              02308000
IOPINAME EQU   IOPDRMAP                                                 02309000
IOPINAM  EQU   IOPINAME                                                 02310000
IOPITYP  EQU   IOPINAM                                                  02311000
IOPUSERL EQU   IOPDRMAP+11                                              02312000
IOPEND   EQU   IOPDRMAP+12                                              02313000
IOPLMCTL EQU   0                                                        02314000
IOPQSMIF EQU   0                                                        02315000
@NM00162 EQU   IOPQSMIF                                                 02316000
IOPQSMLS EQU   IOPQSMIF+8                                               02317000
IOPQSMNM EQU   IOPQSMLS                                                 02318000
IOPBS02  EQU   0                                                        02319000
IOPBS04  EQU   0                                                        02320000
IOPBAPF  EQU   IOPBS04                                                  02321000
HMASMGTP EQU   0                                                        02322000
GTPFUNCT EQU   HMASMGTP                                                 02323000
GTPRETRN EQU   HMASMGTP+1                                               02324000
GTPRCDLN EQU   HMASMGTP+4                                               02325000
GTPKEYLN EQU   HMASMGTP+6                                               02326000
GTPBUFAD EQU   HMASMGTP+12                                              02327000
GTPRESTR EQU   HMASMGTP+16                                              02328000
GTPFLGS1 EQU   HMASMGTP+26                                              02329000
MCBPTFMP EQU   0                                                        02330000
MCBVERMP EQU   0                                                        02331000
MCBVEND  EQU   MCBVERMP+8                                               02332000
MCBIFMP  EQU   0                                                        02333000
MCBIEND  EQU   MCBIFMP+8                                                02334000
MCBELEMP EQU   0                                                        02335000
MCBELEPM EQU   MCBELEMP+136                                             02336000
MCBEFLG1 EQU   MCBELEPM                                                 02337000
MCBEFLG2 EQU   MCBELEPM+1                                               02338000
MCBEFLG3 EQU   MCBELEPM+2                                               02339000
MCBEFLG4 EQU   MCBELEPM+3                                               02340000
MCBEFLG5 EQU   MCBELEMP+140                                             02341000
MCBEEND  EQU   MCBELEMP+141                                             02342000
SPLPPACK EQU   0                                                        02343000
SPLPUNPK EQU   0                                                        02344000
SPLPDSN  EQU   0                                                        02345000
SPLODSN  EQU   SPLPDSN                                                  02346000
SPLIPFX  EQU   SPLODSN                                                  02347000
SPLISMD  EQU   SPLODSN+26                                               02348000
SPLIFIL  EQU   SPLODSN+33                                               02349000
RVAPARM  EQU   0                                                        02350000
RVAINFO  EQU   RVAPARM                                                  02351000
RVAPASS  EQU   RVAPARM+12                                               02352000
RVASTAE  EQU   RVAPARM+20                                               02353000
RVAEPRNM EQU   RVASTAE+4                                                02354000
@NM00193 EQU   RVASTAE+16                                               02355000
@NM00194 EQU   RVASTAE+20                                               02356000
RVAFLAGS EQU   RVASTAE+24                                               02357000
CARDCOL  EQU   0                                                        02358000
CARDCLOS EQU   0                                                        02359000
CARDREP  EQU   0                                                        02360000
CCADSIDA EQU   0                                                        02361000
CCATYPEA EQU   0                                                        02362000
DSNCHAR  EQU   0                                                        02363000
DSNSRELF EQU   0                                                        02364000
IOPBS01  EQU   0                                                        02365000
IOPBS03  EQU   0                                                        02366000
RECXPARM EQU   0                                                        02367000
RECXFLGS EQU   RECXPARM+8                                               02368000
RECXFLG1 EQU   RECXFLGS                                                 02369000
RECXFLG2 EQU   RECXFLGS+1                                               02370000
RECXFLG3 EQU   RECXFLGS+2                                               02371000
RECXFLG4 EQU   RECXFLGS+3                                               02372000
RECXIOPS EQU   RECXPARM+12                                              02373000
RECXIOPP EQU   RECXIOPS+4                                               02374000
RECXIOPG EQU   RECXIOPS+8                                               02375000
RECXLAST EQU   RECXPARM+24                                              02376000
RECXGSMP EQU   RECXPARM+40                                              02377000
RECXGRFP EQU   RECXPARM+48                                              02378000
RECXDSPC EQU   RECXPARM+74                                              02379000
ELEMRC   EQU   0                                                        02380000
COPYRC   EQU   0                                                        02381000
PUTSMRC  EQU   0                                                        02382000
DELSMRC  EQU   0                                                        02383000
SUMSYSM  EQU   0                                                        02384000
SUMSYSTY EQU   0                                                        02385000
GETSMRC  EQU   0                                                        02386000
IOPUDATA EQU   IOPEND                                                   02387000
IOPINAM3 EQU   IOPINAME                                                 02388000
@NM00058 EQU   IOPINAM3                                                 02389000
IOPSTCMP EQU   IOPUDATA                                                 02390000
IOPDYNDT EQU   IOPUDATA                                                 02391000
IOPDSN   EQU   IOPDYNDT                                                 02392000
IOPSPACE EQU   IOPDYNDT+44                                              02393000
IOPDTYPE EQU   IOPDYNDT+50                                              02394000
IOPDMAC  EQU   IOPDTYPE                                                 02395000
IOPDSRC  EQU   IOPDTYPE                                                 02396000
IOPDJCL  EQU   IOPDTYPE                                                 02397000
IOPDMOD  EQU   IOPDTYPE                                                 02398000
IOPNTMAX EQU   IOPDRMAP                                                 02399000
IOPNTMAP EQU   IOPDRMAP                                                 02400000
IOPCDMAP EQU   IOPNTMAP                                                 02401000
IOPPTMAP EQU   IOPCDMAP                                                 02402000
IOPSCMAP EQU   IOPPTMAP                                                 02403000
IOPDIRCT EQU   IOPSCMAP+12                                              02404000
IOPCDMAX EQU   IOPDIRCT                                                 02405000
IOPCQMAP EQU   IOPDRMAP                                                 02406000
@NM00069 EQU   IOPUDATA                                                 02407000
@NM00070 EQU   IOPUDATA                                                 02408000
IOPASMNT EQU   IOPUDATA                                                 02409000
IOPASMDR EQU   IOPASMNT                                                 02410000
IOPABUNT EQU   IOPASMDR+1                                               02411000
IOPLMDNT EQU   IOPUDATA                                                 02412000
IOPLMDDR EQU   IOPLMDNT                                                 02413000
IOPLMLEP EQU   IOPLMDDR+1                                               02414000
IOPLMDF1 EQU   IOPLMLEP                                                 02415000
IOPFLGS2 EQU   IOPLMDF1                                                 02416000
IOPLMDF2 EQU   IOPLMLEP+1                                               02417000
IOPLMDF3 EQU   IOPLMLEP+2                                               02418000
IOPLMDF4 EQU   IOPLMLEP+3                                               02419000
IOPLMDF5 EQU   IOPLMDDR+5                                               02420000
IOPFLGS3 EQU   IOPLMDF5                                                 02421000
IOPLMDFX EQU   IOPLMDNT+24                                              02422000
@NM00079 EQU   IOPLMDFX                                                 02423000
IOPLNTRY EQU   IOPLMDFX+8                                               02424000
IOPLSYS  EQU   IOPLNTRY                                                 02425000
IOPSYSLB EQU   IOPLSYS                                                  02426000
IOPMACNT EQU   IOPUDATA                                                 02427000
IOPMACDR EQU   IOPMACNT                                                 02428000
IOPRMIDE EQU   IOPMACDR+1                                               02429000
IOPRMST  EQU   IOPRMIDE+7                                               02430000
IOPFMIDE EQU   IOPMACDR+9                                               02431000
IOPMACFX EQU   IOPMACNT+24                                              02432000
IOPBUNT  EQU   IOPMACFX                                                 02433000
IOPMCEND EQU   IOPMACNT+104                                             02434000
IOPMACVR EQU   IOPMCEND                                                 02435000
IOPMCENT EQU   IOPMACVR                                                 02436000
IOPMCDTA EQU   IOPMCENT                                                 02437000
IOPMCASM EQU   IOPMCDTA                                                 02438000
IOPMACID EQU   IOPMCASM                                                 02439000
IOPMACST EQU   IOPMCASM+7                                               02440000
IOPMCIND EQU   IOPMCENT+8                                               02441000
IOPEOFNT EQU   IOPUDATA                                                 02442000
IOPSRCNT EQU   IOPUDATA                                                 02443000
IOPSRCDR EQU   IOPSRCNT                                                 02444000
@NM00090 EQU   IOPSRCDR+1                                               02445000
@NM00092 EQU   @NM00090+7                                               02446000
@NM00096 EQU   IOPSRCDR+9                                               02447000
IOPSRCFX EQU   IOPSRCNT+24                                              02448000
@NM00100 EQU   IOPSRCFX                                                 02449000
IOPSREND EQU   IOPSRCNT+104                                             02450000
IOPSRCVR EQU   IOPSREND                                                 02451000
IOPSNTRY EQU   IOPSRCVR                                                 02452000
IOPSRDTA EQU   IOPSNTRY                                                 02453000
IOPSRCID EQU   IOPSRDTA                                                 02454000
IOPSRCST EQU   IOPSRDTA+7                                               02455000
IOPMODNT EQU   IOPUDATA                                                 02456000
IOPMODDR EQU   IOPMODNT                                                 02457000
@NM00106 EQU   IOPMODDR+1                                               02458000
@NM00108 EQU   @NM00106+7                                               02459000
@NM00112 EQU   IOPMODDR+9                                               02460000
IOPMODFX EQU   IOPMODNT+24                                              02461000
@NM00116 EQU   IOPMODFX                                                 02462000
IOPMDLEP EQU   IOPMODFX+8                                               02463000
IOPMODF1 EQU   IOPMDLEP                                                 02464000
IOPMODF2 EQU   IOPMDLEP+1                                               02465000
IOPMODF3 EQU   IOPMDLEP+2                                               02466000
IOPMODF4 EQU   IOPMDLEP+3                                               02467000
IOPMDEND EQU   IOPMODNT+104                                             02468000
IOPMODVR EQU   IOPMDEND                                                 02469000
IOPMNTRY EQU   IOPMODVR                                                 02470000
IOPMDDTA EQU   IOPMNTRY                                                 02471000
IOPLMODS EQU   IOPMDDTA                                                 02472000
IOPMODID EQU   IOPLMODS                                                 02473000
IOPMODST EQU   IOPLMODS+7                                               02474000
IOPDLBNT EQU   IOPUDATA                                                 02475000
IOPDLBDR EQU   IOPDLBNT                                                 02476000
IOPDLBFX EQU   IOPDLBNT+24                                              02477000
@NM00127 EQU   IOPDLBFX                                                 02478000
IOPDLEND EQU   IOPDLBNT+104                                             02479000
IOPDLBVR EQU   IOPDLEND                                                 02480000
IOPDNTRY EQU   IOPDLBVR                                                 02481000
IOPDSYS  EQU   IOPDNTRY                                                 02482000
IOPSYSNT EQU   IOPUDATA                                                 02483000
IOPSYSDR EQU   IOPSYSNT                                                 02484000
IOPSYSF1 EQU   IOPSYSDR+4                                               02485000
IOPFLGS7 EQU   IOPSYSF1                                                 02486000
IOPSYSFX EQU   IOPSYSNT+24                                              02487000
@NM00134 EQU   IOPSYSFX                                                 02488000
IOPSYEND EQU   IOPSYSNT+184                                             02489000
IOPSYSVR EQU   IOPSYEND                                                 02490000
IOPSYSTR EQU   IOPSYSVR                                                 02491000
IOPSYNTR EQU   IOPSYSTR                                                 02492000
IOPPTFNT EQU   IOPUDATA                                                 02493000
IOPPTFDR EQU   IOPPTFNT                                                 02494000
IOPPSTAT EQU   IOPPTFDR+2                                               02495000
IOPPTFF1 EQU   IOPPSTAT                                                 02496000
IOPFLGS5 EQU   IOPPTFF1                                                 02497000
IOPERROR EQU   IOPFLGS5                                                 02498000
IOPPTFF2 EQU   IOPPSTAT+1                                               02499000
IOPPTFF3 EQU   IOPPSTAT+3                                               02500000
IOPPTFFX EQU   IOPPTFNT+24                                              02501000
@NM00143 EQU   IOPPTFFX                                                 02502000
@NM00144 EQU   @NM00143                                                 02503000
IOPPDTES EQU   IOPPTFFX+41                                              02504000
@NM00147 EQU   IOPPDTES                                                 02505000
IOPPTPFX EQU   IOPPDTES+6                                               02506000
IOPDATES EQU   IOPPTPFX                                                 02507000
IOPPTEND EQU   IOPPTFNT+104                                             02508000
IOPPTFVR EQU   IOPPTEND                                                 02509000
IOPPNTRY EQU   IOPPTFVR                                                 02510000
IOPPMODS EQU   IOPPNTRY                                                 02511000
IOPENTNT EQU   IOPUDATA+104                                             02512000
IOPSRLNT EQU   IOPUDATA+104                                             02513000
IOPPRENT EQU   IOPUDATA+104                                             02514000
IOPNPRNT EQU   IOPUDATA+104                                             02515000
IOPSUPNT EQU   IOPUDATA+104                                             02516000
IOPREQNT EQU   IOPUDATA+104                                             02517000
IOPIRQNT EQU   IOPUDATA+104                                             02518000
IOPFIDNT EQU   IOPUDATA+104                                             02519000
IOPDELNT EQU   IOPUDATA+104                                             02520000
IOPVERNT EQU   IOPUDATA+104                                             02521000
IOPSBYNT EQU   IOPUDATA+104                                             02522000
IOPQSMNT EQU   IOPUDATA                                                 02523000
IOPQSMDR EQU   IOPQSMNT                                                 02524000
IOPQFMNT EQU   IOPUDATA                                                 02525000
IOPQFMDR EQU   IOPQFMNT                                                 02526000
IOPQFEND EQU   IOPQFMNT+2                                               02527000
IOPQFMVR EQU   IOPQFEND                                                 02528000
IOPQFMLS EQU   IOPQFMVR                                                 02529000
IOPQFMNM EQU   IOPQFMLS                                                 02530000
IOPPTSYS EQU   IOPUDATA                                                 02531000
IOPPTSDR EQU   IOPPTSYS                                                 02532000
IOPPTSFX EQU   IOPPTSYS+24                                              02533000
IOPDSSPC EQU   IOPPTSFX                                                 02534000
IOPPTFG1 EQU   IOPPTSFX+34                                              02535000
IOPPSEND EQU   IOPPTSYS+1064                                            02536000
IOPPTSVR EQU   IOPPSEND                                                 02537000
IOPPTNTR EQU   IOPPTSVR                                                 02538000
@NM00172 EQU   IOPPTNTR                                                 02539000
IOPPTFMD EQU   @NM00172                                                 02540000
IOPPTREL EQU   IOPPTFMD                                                 02541000
IOPBPDS  EQU   IOPUDATA                                                 02542000
IOPBLEP1 EQU   IOPBPDS+8                                                02543000
IOPBLEP2 EQU   IOPBPDS+9                                                02544000
@NM00176 EQU   IOPBPDS+18                                               02545000
IOPBFTB0 EQU   @NM00176                                                 02546000
IOPBFTB1 EQU   IOPBFTB0                                                 02547000
MCBVVLST EQU   MCBVEND                                                  02548000
MCBVNTRY EQU   MCBVVLST                                                 02549000
MCBVNUM  EQU   MCBVNTRY                                                 02550000
MCBIVLST EQU   MCBIEND                                                  02551000
MCBINTRY EQU   MCBIVLST                                                 02552000
MCBINUM  EQU   MCBINTRY                                                 02553000
MCBEVLST EQU   MCBEEND                                                  02554000
MCBENTRY EQU   MCBEVLST                                                 02555000
MCBENUM  EQU   MCBENTRY                                                 02556000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02557000
MCBEIND  EQU   MCBEVLST+8                                               02558000
@NM00192 EQU   MCBENTRY+7                                               02559000
MCBEND   EQU   MCBENUM                                                  02560000
MCBIIND  EQU   MCBIVLST+8                                               02561000
@NM00185 EQU   MCBINTRY+7                                               02562000
MCBIND   EQU   MCBINUM                                                  02563000
MCBVIND  EQU   MCBVVLST+8                                               02564000
@NM00183 EQU   MCBVNTRY+7                                               02565000
MCBVND   EQU   MCBVNUM                                                  02566000
IOPBCEND EQU   IOPBPDS+21                                               02567000
IOPBFTB3 EQU   IOPBFTB0+2                                               02568000
IOPBFTB2 EQU   IOPBFTB0+1                                               02569000
@NM00178 EQU   IOPBFTB1                                                 02570000
IOPBAPFP EQU   IOPBFTB1                                                 02571000
IOPBSSI  EQU   IOPBFTB1                                                 02572000
IOPBPAGA EQU   IOPBFTB1                                                 02573000
@NM00177 EQU   IOPBFTB1                                                 02574000
IOPBAOSL EQU   IOPBFTB1                                                 02575000
IOPBSEPA EQU   IOPBPDS+15                                               02576000
IOPBFTBL EQU   IOPBPDS+13                                               02577000
IOPBSTOR EQU   IOPBPDS+10                                               02578000
IOPBREFR EQU   IOPBLEP2                                                 02579000
IOPBLEF  EQU   IOPBLEP2                                                 02580000
IOPBTEST EQU   IOPBLEP2                                                 02581000
IOPBNE   EQU   IOPBLEP2                                                 02582000
@NM00175 EQU   IOPBLEP2                                                 02583000
IOPBDC   EQU   IOPBLEP2                                                 02584000
@NM00174 EQU   IOPBLEP1                                                 02585000
IOPBSCTR EQU   IOPBLEP1                                                 02586000
IOPBOL   EQU   IOPBLEP1                                                 02587000
@NM00173 EQU   IOPBLEP1                                                 02588000
IOPBOVLY EQU   IOPBLEP1                                                 02589000
IOPBREUS EQU   IOPBLEP1                                                 02590000
IOPBRENT EQU   IOPBLEP1                                                 02591000
IOPBNL   EQU   IOPBPDS+7                                                02592000
IOPBTTRN EQU   IOPBPDS+4                                                02593000
IOPBZERO EQU   IOPBPDS+3                                                02594000
IOPBTTRT EQU   IOPBPDS                                                  02595000
IOPPTIND EQU   IOPPTNTR+8                                               02596000
IOPPTSND EQU   IOPPTREL                                                 02597000
@NM00171 EQU   IOPPTSFX+872                                             02598000
IOPSYZPP EQU   IOPPTSFX+772                                             02599000
IOPSYZPR EQU   IOPPTSFX+771                                             02600000
IOPSYZPS EQU   IOPPTSFX+763                                             02601000
IOPSYZAP EQU   IOPPTSFX+755                                             02602000
IOPSYUPP EQU   IOPPTSFX+655                                             02603000
IOPSYUPR EQU   IOPPTSFX+654                                             02604000
IOPSYUPS EQU   IOPPTSFX+646                                             02605000
IOPSYUPD EQU   IOPPTSFX+638                                             02606000
IOPSYSPP EQU   IOPPTSFX+538                                             02607000
IOPSYSPR EQU   IOPPTSFX+537                                             02608000
IOPSYSPS EQU   IOPPTSFX+529                                             02609000
IOPSYSUP EQU   IOPPTSFX+521                                             02610000
IOPSYLKP EQU   IOPPTSFX+421                                             02611000
IOPSYLKR EQU   IOPPTSFX+420                                             02612000
IOPSYLKS EQU   IOPPTSFX+412                                             02613000
IOPSYLKD EQU   IOPPTSFX+404                                             02614000
IOPSYCPP EQU   IOPPTSFX+304                                             02615000
IOPSYCPR EQU   IOPPTSFX+303                                             02616000
IOPSYCPS EQU   IOPPTSFX+295                                             02617000
IOPSYCPY EQU   IOPPTSFX+287                                             02618000
IOPSYCOP EQU   IOPPTSFX+187                                             02619000
IOPSYCOR EQU   IOPPTSFX+186                                             02620000
IOPSYCOS EQU   IOPPTSFX+178                                             02621000
IOPSYCOM EQU   IOPPTSFX+170                                             02622000
IOPSYASP EQU   IOPPTSFX+70                                              02623000
IOPSYASR EQU   IOPPTSFX+69                                              02624000
IOPSYASS EQU   IOPPTSFX+61                                              02625000
IOPSYASM EQU   IOPPTSFX+53                                              02626000
@NM00170 EQU   IOPPTSFX+35                                              02627000
@NM00169 EQU   IOPPTFG1                                                 02628000
IOPPTSNJ EQU   IOPPTFG1                                                 02629000
IOPPTSNP EQU   IOPPTFG1                                                 02630000
IOPSYPLN EQU   IOPPTSFX+32                                              02631000
IOPDSPFX EQU   IOPPTSFX+6                                               02632000
IOPDSDIR EQU   IOPDSSPC+4                                               02633000
IOPDSSEC EQU   IOPDSSPC+2                                               02634000
IOPDSPRM EQU   IOPDSSPC                                                 02635000
@NM00168 EQU   IOPPTSDR+4                                               02636000
IOPPTPEM EQU   IOPPTSDR+2                                               02637000
IOPPCNVL EQU   IOPPTSDR+1                                               02638000
@NM00167 EQU   IOPPTSDR                                                 02639000
IOPQFMTP EQU   IOPQFMLS+8                                               02640000
@NM00166 EQU   IOPQFMLS+7                                               02641000
IOPQFMND EQU   IOPQFMNM                                                 02642000
@NM00165 EQU   IOPQFMDR                                                 02643000
@NM00161 EQU   IOPQSMDR                                                 02644000
@NM00160 EQU   IOPSBYNT+8                                               02645000
IOPSBYST EQU   IOPSBYNT+7                                               02646000
IOPSBYNM EQU   IOPSBYNT                                                 02647000
@NM00159 EQU   IOPVERNT+8                                               02648000
IOPVERST EQU   IOPVERNT+7                                               02649000
IOPVERNM EQU   IOPVERNT                                                 02650000
@NM00158 EQU   IOPDELNT+8                                               02651000
IOPDELST EQU   IOPDELNT+7                                               02652000
IOPDELNM EQU   IOPDELNT                                                 02653000
@NM00157 EQU   IOPFIDNT+8                                               02654000
IOPFIDST EQU   IOPFIDNT+7                                               02655000
IOPFIDNM EQU   IOPFIDNT                                                 02656000
@NM00156 EQU   IOPIRQNT+8                                               02657000
IOPIRQST EQU   IOPIRQNT+7                                               02658000
IOPIRQNM EQU   IOPIRQNT                                                 02659000
@NM00155 EQU   IOPREQNT+8                                               02660000
IOPREQST EQU   IOPREQNT+7                                               02661000
IOPREQNM EQU   IOPREQNT                                                 02662000
@NM00154 EQU   IOPSUPNT+8                                               02663000
IOPSUPST EQU   IOPSUPNT+7                                               02664000
IOPSUPNM EQU   IOPSUPNT                                                 02665000
@NM00153 EQU   IOPNPRNT+8                                               02666000
IOPNPRST EQU   IOPNPRNT+7                                               02667000
IOPNPRNM EQU   IOPNPRNT                                                 02668000
@NM00152 EQU   IOPPRENT+8                                               02669000
IOPPREST EQU   IOPPRENT+7                                               02670000
IOPPRENM EQU   IOPPRENT                                                 02671000
@NM00151 EQU   IOPSRLNT+8                                               02672000
IOPSRLST EQU   IOPSRLNT+7                                               02673000
@NM00150 EQU   IOPSRLNT+4                                               02674000
IOPSRLNM EQU   IOPSRLNT                                                 02675000
@NM00149 EQU   IOPENTNT+8                                               02676000
IOPENTST EQU   IOPENTNT+7                                               02677000
IOPENTNM EQU   IOPENTNT                                                 02678000
IOPPIND  EQU   IOPPNTRY+8                                               02679000
IOPPTFND EQU   IOPPMODS                                                 02680000
IOPPFMID EQU   IOPPTFFX+73                                              02681000
@NM00148 EQU   IOPPTPFX+24                                              02682000
IOPUCLT  EQU   IOPDATES+21                                              02683000
IOPUCLD  EQU   IOPDATES+18                                              02684000
IOPACCT  EQU   IOPDATES+15                                              02685000
IOPACCD  EQU   IOPDATES+12                                              02686000
IOPRSTT  EQU   IOPDATES+9                                               02687000
IOPRSTD  EQU   IOPDATES+6                                               02688000
IOPAPPT  EQU   IOPDATES+3                                               02689000
IOPAPPD  EQU   IOPDATES                                                 02690000
IOPRECT  EQU   @NM00147+3                                               02691000
IOPRECD  EQU   @NM00147                                                 02692000
@NM00146 EQU   IOPPTFFX+8                                               02693000
@NM00145 EQU   @NM00143+7                                               02694000
IOPPRELN EQU   @NM00144                                                 02695000
@NM00142 EQU   IOPPTFDR+20                                              02696000
IOPSBYNO EQU   IOPPTFDR+13                                              02697000
IOPDBYNO EQU   IOPPTFDR+6                                               02698000
@NM00141 EQU   IOPPTFF3                                                 02699000
IOPFLF   EQU   IOPPTFF3                                                 02700000
IOPDBYP  EQU   IOPPTFF3                                                 02701000
IOPSBYP  EQU   IOPPTFF3                                                 02702000
IOPPMDLP EQU   IOPPTFF2+1                                               02703000
IOPPADDP EQU   IOPPTFF2+1                                               02704000
@NM00140 EQU   IOPPTFF2+1                                               02705000
IOPLRFP  EQU   IOPPTFF2                                                 02706000
IOPJCLP  EQU   IOPPTFF2                                                 02707000
IOPSUPP  EQU   IOPPTFF2                                                 02708000
IOPREQP  EQU   IOPPTFF2                                                 02709000
IOPPREP  EQU   IOPPTFF2                                                 02710000
IOPNPRP  EQU   IOPPTFF2                                                 02711000
IOPIRQP  EQU   IOPPTFF2                                                 02712000
IOPDELP  EQU   IOPPTFF2                                                 02713000
IOPREGEN EQU   IOPFLGS5                                                 02714000
IOPBYP   EQU   IOPFLGS5                                                 02715000
IOPDUMMP EQU   IOPFLGS5                                                 02716000
@NM00139 EQU   IOPFLGS5                                                 02717000
IOPACC   EQU   IOPFLGS5                                                 02718000
IOPRES   EQU   IOPFLGS5                                                 02719000
IOPAPP   EQU   IOPFLGS5                                                 02720000
IOPPTYPE EQU   IOPPTFDR+1                                               02721000
@NM00138 EQU   IOPPTFDR                                                 02722000
IOPSYSTP EQU   IOPSYSTR+8                                               02723000
IOPSYSND EQU   IOPSYNTR                                                 02724000
@NM00137 EQU   IOPSYSFX+21                                              02725000
IOPSYSID EQU   IOPSYSFX+13                                              02726000
IOPNUCID EQU   IOPSYSFX+12                                              02727000
IOPSREL  EQU   IOPSYSFX+8                                               02728000
@NM00136 EQU   @NM00134+7                                               02729000
@NM00135 EQU   @NM00134                                                 02730000
@NM00133 EQU   IOPSYSDR+5                                               02731000
@NM00132 EQU   IOPFLGS7                                                 02732000
IOPSYNG  EQU   IOPFLGS7                                                 02733000
IOPSYDL  EQU   IOPFLGS7                                                 02734000
IOPSTSNP EQU   IOPFLGS7                                                 02735000
IOPMTSNP EQU   IOPFLGS7                                                 02736000
IOPPEMAX EQU   IOPSYSDR+2                                               02737000
IOPSCNVL EQU   IOPSYSDR+1                                               02738000
@NM00131 EQU   IOPSYSDR                                                 02739000
IOPDLIND EQU   IOPDNTRY+8                                               02740000
IOPDLBND EQU   IOPDSYS                                                  02741000
@NM00130 EQU   IOPDLBFX+8                                               02742000
@NM00129 EQU   @NM00127+7                                               02743000
@NM00128 EQU   @NM00127                                                 02744000
@NM00126 EQU   IOPDLBDR+1                                               02745000
@NM00125 EQU   IOPDLBDR                                                 02746000
IOPMDIND EQU   IOPMNTRY+8                                               02747000
@NM00124 EQU   IOPMODST                                                 02748000
IOPMODND EQU   IOPMODID                                                 02749000
IOPDLIB  EQU   IOPMODFX+72                                              02750000
@NM00123 EQU   IOPMODFX+12                                              02751000
@NM00122 EQU   IOPMODF4                                                 02752000
@NM00121 EQU   IOPMODF3                                                 02753000
@NM00120 EQU   IOPMODF2                                                 02754000
IOPMPAGA EQU   IOPMODF2                                                 02755000
IOPMNE   EQU   IOPMODF2                                                 02756000
@NM00119 EQU   IOPMODF1                                                 02757000
IOPMDC   EQU   IOPMODF1                                                 02758000
IOPMREFR EQU   IOPMODF1                                                 02759000
IOPMOVLY EQU   IOPMODF1                                                 02760000
IOPMSCTR EQU   IOPMODF1                                                 02761000
IOPMREUS EQU   IOPMODF1                                                 02762000
IOPMRENT EQU   IOPMODF1                                                 02763000
IOPMAPF  EQU   IOPMODF1                                                 02764000
@NM00118 EQU   @NM00116+7                                               02765000
@NM00117 EQU   @NM00116                                                 02766000
@NM00115 EQU   IOPMODDR+17                                              02767000
@NM00114 EQU   @NM00112+7                                               02768000
@NM00113 EQU   @NM00112                                                 02769000
@NM00111 EQU   @NM00108                                                 02770000
@NM00110 EQU   @NM00108                                                 02771000
@NM00109 EQU   @NM00108                                                 02772000
@NM00107 EQU   @NM00106                                                 02773000
@NM00105 EQU   IOPMODDR                                                 02774000
IOPSRIND EQU   IOPSNTRY+8                                               02775000
@NM00104 EQU   IOPSRCST                                                 02776000
IOPSRCND EQU   IOPSRCID                                                 02777000
IOPSRDLB EQU   IOPSRCFX+72                                              02778000
IOPSRSYS EQU   IOPSRCFX+64                                              02779000
@NM00103 EQU   IOPSRCFX+8                                               02780000
@NM00102 EQU   @NM00100+7                                               02781000
@NM00101 EQU   @NM00100                                                 02782000
@NM00099 EQU   IOPSRCDR+18                                              02783000
IOPSRLNG EQU   IOPSRCDR+17                                              02784000
@NM00098 EQU   @NM00096+7                                               02785000
@NM00097 EQU   @NM00096                                                 02786000
@NM00095 EQU   @NM00092                                                 02787000
@NM00094 EQU   @NM00092                                                 02788000
@NM00093 EQU   @NM00092                                                 02789000
@NM00091 EQU   @NM00090                                                 02790000
@NM00089 EQU   IOPSRCDR                                                 02791000
IOPEOFND EQU   IOPEOFNT                                                 02792000
IOPMCTYP EQU   IOPMCIND                                                 02793000
@NM00088 EQU   IOPMACST                                                 02794000
IOPMACND EQU   IOPMACID                                                 02795000
IOPMCDLB EQU   IOPMACFX+72                                              02796000
IOPMCSYS EQU   IOPMACFX+64                                              02797000
@NM00087 EQU   IOPMACFX+8                                               02798000
IOPBUTYP EQU   IOPBUNT+7                                                02799000
IOPBUSMD EQU   IOPBUNT                                                  02800000
@NM00086 EQU   IOPMACDR+18                                              02801000
IOPMCLNG EQU   IOPMACDR+17                                              02802000
IOPFMST  EQU   IOPFMIDE+7                                               02803000
IOPFMID  EQU   IOPFMIDE                                                 02804000
@NM00085 EQU   IOPRMST                                                  02805000
IOPRMASM EQU   IOPRMST                                                  02806000
@NM00084 EQU   IOPRMST                                                  02807000
IOPRMID  EQU   IOPRMIDE                                                 02808000
@NM00083 EQU   IOPMACDR                                                 02809000
IOPLMIND EQU   IOPLNTRY+8                                               02810000
IOPLMDND EQU   IOPSYSLB                                                 02811000
@NM00081 EQU   @NM00079+7                                               02812000
@NM00080 EQU   @NM00079                                                 02813000
@NM00078 EQU   IOPLMDDR+6                                               02814000
@NM00077 EQU   IOPFLGS3                                                 02815000
IOPCHREP EQU   IOPFLGS3                                                 02816000
IOPLINK  EQU   IOPFLGS3                                                 02817000
IOPCOPY  EQU   IOPFLGS3                                                 02818000
@NM00076 EQU   IOPLMDF4                                                 02819000
@NM00075 EQU   IOPLMDF3                                                 02820000
@NM00074 EQU   IOPLMDF2                                                 02821000
IOPPAGA  EQU   IOPLMDF2                                                 02822000
IOPNE    EQU   IOPLMDF2                                                 02823000
@NM00073 EQU   IOPFLGS2                                                 02824000
IOPDC    EQU   IOPFLGS2                                                 02825000
IOPREFR  EQU   IOPFLGS2                                                 02826000
IOPOVLY  EQU   IOPFLGS2                                                 02827000
IOPSCTR  EQU   IOPFLGS2                                                 02828000
IOPREUS  EQU   IOPFLGS2                                                 02829000
IOPRENT  EQU   IOPFLGS2                                                 02830000
IOPAPF   EQU   IOPFLGS2                                                 02831000
@NM00072 EQU   IOPLMDDR                                                 02832000
@NM00071 EQU   IOPASMDR+9                                               02833000
IOPABUTP EQU   IOPABUNT+7                                               02834000
IOPABUPT EQU   IOPABUNT                                                 02835000
IOPNTLVL EQU   IOPASMDR                                                 02836000
IOPALLOC EQU   @NM00070+4                                               02837000
IOPUSED  EQU   @NM00070                                                 02838000
IOPTPSEQ EQU   @NM00069+8                                               02839000
IOPVLSER EQU   @NM00069+2                                               02840000
IOPBLKSI EQU   @NM00069                                                 02841000
IOPCQMAX EQU   IOPCQMAP+12                                              02842000
@NM00068 EQU   IOPCQMAP+11                                              02843000
@NM00067 EQU   IOPCQMAP+8                                               02844000
@NM00066 EQU   IOPCQMAP                                                 02845000
IOPPTMAX EQU   IOPCDMAX                                                 02846000
@NM00065 EQU   IOPSCMAP+11                                              02847000
@NM00064 EQU   IOPSCMAP+8                                               02848000
@NM00063 EQU   IOPSCMAP                                                 02849000
IOPDIRMX EQU   IOPNTMAX+12                                              02850000
@NM00062 EQU   IOPNTMAX+11                                              02851000
@NM00061 EQU   IOPNTMAX+8                                               02852000
@NM00060 EQU   IOPNTMAX                                                 02853000
@NM00059 EQU   IOPDTYPE                                                 02854000
IOPSDIR  EQU   IOPSPACE+4                                               02855000
IOPSSCND EQU   IOPSPACE+2                                               02856000
IOPSPRIM EQU   IOPSPACE                                                 02857000
IOPNTYPE EQU   IOPSTCMP+17                                              02858000
IOPNNAME EQU   IOPSTCMP+9                                               02859000
IOPOTYPE EQU   IOPSTCMP+8                                               02860000
IOPONAME EQU   IOPSTCMP                                                 02861000
IOPISEQ3 EQU   IOPINAM3+6                                               02862000
IOPITYP3 EQU   @NM00058+5                                               02863000
IOPIPTF3 EQU   @NM00058                                                 02864000
RECXRELM EQU   RECXPARM+72                                              02865000
RECXRCUR EQU   RECXPARM+70                                              02866000
RECXRNXT EQU   RECXPARM+68                                              02867000
RECXRFLE EQU   RECXPARM+66                                              02868000
RECXSEQ# EQU   RECXPARM+64                                              02869000
RECXSCNT EQU   RECXPARM+62                                              02870000
RECXCNT  EQU   RECXPARM+60                                              02871000
RECXMNDX EQU   RECXPARM+56                                              02872000
RECXGPSP EQU   RECXPARM+52                                              02873000
RECXGSRP EQU   RECXPARM+44                                              02874000
RECXPPTR EQU   RECXPARM+36                                              02875000
RECXMCB  EQU   RECXPARM+32                                              02876000
RECXMAX  EQU   RECXPARM+28                                              02877000
RECXIOPT EQU   RECXIOPS                                                 02878000
@NM00005 EQU   RECXFLG4                                                 02879000
@NM00004 EQU   RECXFLG3                                                 02880000
RECXPELM EQU   RECXFLG3                                                 02881000
RECXPUPD EQU   RECXFLG3                                                 02882000
RECXTXTF EQU   RECXFLG3                                                 02883000
RECXPTXT EQU   RECXFLG3                                                 02884000
RECXPIFS EQU   RECXFLG3                                                 02885000
RECXPVER EQU   RECXFLG3                                                 02886000
@NM00003 EQU   RECXFLG2                                                 02887000
RECXELEF EQU   RECXFLG2                                                 02888000
RECXJCLF EQU   RECXFLG2                                                 02889000
RECXAVER EQU   RECXFLG2                                                 02890000
RECXVERF EQU   RECXFLG2                                                 02891000
@NM00002 EQU   RECXFLG1                                                 02892000
RECXEXC  EQU   RECXFLG1                                                 02893000
RECXSEL  EQU   RECXFLG1                                                 02894000
RECXSYSS EQU   RECXFLG1                                                 02895000
RECXSYSF EQU   RECXFLG1                                                 02896000
RECXPEOF EQU   RECXFLG1                                                 02897000
RECXSYSM EQU   RECXFLG1                                                 02898000
RECXPROC EQU   RECXFLG1                                                 02899000
@NM00001 EQU   RECXPARM                                                 02900000
RVAEND   EQU   RVASTAE+25                                               02901000
@NM00195 EQU   RVAFLAGS                                                 02902000
RVASDWFD EQU   RVAFLAGS                                                 02903000
RVAVS1   EQU   RVAFLAGS                                                 02904000
RVAMVS   EQU   RVAFLAGS                                                 02905000
RVAUSRCH EQU   @NM00194+2                                               02906000
RVASYSCH EQU   @NM00194                                                 02907000
RVAUSRCD EQU   @NM00193+2                                               02908000
RVASYSCD EQU   @NM00193                                                 02909000
RVAABNDC EQU   RVASTAE+12                                               02910000
RVASDWAP EQU   RVASTAE                                                  02911000
RVAREC   EQU   RVAPASS+4                                                02912000
RVATBL   EQU   RVAPASS                                                  02913000
RVAMAJNM EQU   RVAINFO+8                                                02914000
RVACCAP  EQU   RVAINFO+4                                                02915000
RVAHDR   EQU   RVAINFO                                                  02916000
SPLIUNPK EQU   SPLPUNPK+8                                               02917000
SPLOUNPK EQU   SPLPUNPK                                                 02918000
SPLOPACK EQU   SPLPPACK+8                                               02919000
SPLIPACK EQU   SPLPPACK                                                 02920000
@NM00191 EQU   MCBEFLG5                                                 02921000
MCBEDEL  EQU   MCBEFLG5                                                 02922000
MCBESTD  EQU   MCBEFLG5                                                 02923000
@NM00190 EQU   MCBEFLG4                                                 02924000
@NM00189 EQU   MCBEFLG3                                                 02925000
@NM00188 EQU   MCBEFLG2                                                 02926000
MCBEPAGA EQU   MCBEFLG2                                                 02927000
MCBENE   EQU   MCBEFLG2                                                 02928000
@NM00187 EQU   MCBEFLG1                                                 02929000
MCBEDC   EQU   MCBEFLG1                                                 02930000
MCBEREFR EQU   MCBEFLG1                                                 02931000
MCBEOVLY EQU   MCBEFLG1                                                 02932000
MCBESCTR EQU   MCBEFLG1                                                 02933000
MCBEREUS EQU   MCBEFLG1                                                 02934000
MCBERENT EQU   MCBEFLG1                                                 02935000
MCBEAPF  EQU   MCBEFLG1                                                 02936000
MCBERMID EQU   MCBELEMP+129                                             02937000
MCBELLKD EQU   MCBELEMP+128                                             02938000
MCBEJLKD EQU   MCBELEMP+116                                             02939000
MCBELUPI EQU   MCBELEMP+115                                             02940000
MCBEJUPI EQU   MCBELEMP+103                                             02941000
MCBELCPY EQU   MCBELEMP+102                                             02942000
MCBEJCPY EQU   MCBELEMP+90                                              02943000
MCBELASM EQU   MCBELEMP+89                                              02944000
MCBEJASM EQU   MCBELEMP+77                                              02945000
MCBERLF  EQU   MCBELEMP+73                                              02946000
MCBESSI  EQU   MCBELEMP+65                                              02947000
MCBEDALS EQU   MCBELEMP+57                                              02948000
MCBEASLB EQU   MCBELEMP+49                                              02949000
MCBELKLB EQU   MCBELEMP+41                                              02950000
MCBETXLB EQU   MCBELEMP+33                                              02951000
MCBESYS  EQU   MCBELEMP+25                                              02952000
MCBEDOBJ EQU   MCBELEMP+17                                              02953000
MCBEDIST EQU   MCBELEMP+9                                               02954000
MCBENAME EQU   MCBELEMP+1                                               02955000
@NM00186 EQU   MCBELEMP                                                 02956000
MCBIFENV EQU   MCBIFMP+1                                                02957000
@NM00184 EQU   MCBIFMP                                                  02958000
MCBSFMID EQU   MCBVERMP+1                                               02959000
@NM00182 EQU   MCBVERMP                                                 02960000
MCBPTP   EQU   MCBPTFMP+10                                              02961000
MCBPRELN EQU   MCBPTFMP+8                                               02962000
MCBPNO   EQU   MCBPTFMP+1                                               02963000
MCBTYPE  EQU   MCBPTFMP                                                 02964000
@NM00181 EQU   HMASMGTP+27                                              02965000
GTPPSIZE EQU   GTPFLGS1                                                 02966000
@NM00180 EQU   GTPFLGS1                                                 02967000
GTPRCDNF EQU   GTPFLGS1                                                 02968000
GTPNOSPM EQU   GTPFLGS1                                                 02969000
GTPPOS   EQU   GTPRESTR+8                                               02970000
GTPRCD   EQU   GTPRESTR+4                                               02971000
GTPPAG   EQU   GTPRESTR                                                 02972000
GTPWKAD  EQU   HMASMGTP+8                                               02973000
@NM00179 EQU   HMASMGTP+2                                               02974000
IOPBS04E EQU   IOPBS04+2                                                02975000
IOPBAPFC EQU   IOPBAPF+1                                                02976000
IOPBAPFL EQU   IOPBAPF                                                  02977000
IOPBS2NM EQU   IOPBS02+3                                                02978000
IOPBS2EP EQU   IOPBS02                                                  02979000
IOPQSMTP EQU   IOPQSMLS+8                                               02980000
@NM00164 EQU   IOPQSMLS+7                                               02981000
IOPQSMND EQU   IOPQSMNM                                                 02982000
@NM00163 EQU   @NM00162+7                                               02983000
IOPQSMFM EQU   @NM00162                                                 02984000
@NM00082 EQU   IOPLMCTL+17                                              02985000
IOPLMCRD EQU   IOPLMCTL+9                                               02986000
IOPLMCRN EQU   IOPLMCTL+1                                               02987000
IOPLMCC  EQU   IOPLMCTL                                                 02988000
@NM00057 EQU   IOPUSERL                                                 02989000
@NM00056 EQU   IOPUSERL                                                 02990000
IOPALIS  EQU   IOPUSERL                                                 02991000
IOPTTR   EQU   IOPDRMAP+8                                               02992000
IOPINAM2 EQU   IOPINAM+1                                                02993000
IOPITYP2 EQU   IOPITYP                                                  02994000
@NM00055 EQU   HMASMIOP+32                                              02995000
IOPDELDD EQU   IOPDDNAM                                                 02996000
@NM00054 EQU   @NM00051+10                                              02997000
@NM00053 EQU   @NM00052+7                                               02998000
IOPPTFNM EQU   @NM00052                                                 02999000
CCABMREC EQU   CCABELMT+10                                              03000000
CCABPOS  EQU   CCABMPOS+8                                               03001000
CCABNAME EQU   CCABMPOS                                                 03002000
@NM00050 EQU   CCABLDLM+2                                               03003000
@NM00049 EQU   CCABLDLM                                                 03004000
CCAUPDPM EQU   @NM00047+24                                              03005000
@NM00048 EQU   @NM00047+21                                              03006000
CCARUPDT EQU   CCAUPDRC                                                 03007000
CCAUPDSP EQU   @NM00047+12                                              03008000
CCAUPDTE EQU   @NM00047+8                                               03009000
CCAUPDNM EQU   @NM00047                                                 03010000
CCASUPPM EQU   @NM00045+24                                              03011000
@NM00046 EQU   @NM00045+21                                              03012000
CCARSUP  EQU   CCASUPRC                                                 03013000
CCASUPSP EQU   @NM00045+12                                              03014000
CCAIOSUP EQU   @NM00045+8                                               03015000
CCASUPNM EQU   @NM00045                                                 03016000
CCAZAPPM EQU   @NM00043+24                                              03017000
@NM00044 EQU   @NM00043+21                                              03018000
CCARZAP  EQU   CCAZAPRC                                                 03019000
CCAZAPSP EQU   @NM00043+12                                              03020000
CCASPZAP EQU   @NM00043+8                                               03021000
CCAZAPNM EQU   @NM00043                                                 03022000
CCACOMPM EQU   @NM00041+24                                              03023000
@NM00042 EQU   @NM00041+21                                              03024000
CCARCOMP EQU   CCACOMRC                                                 03025000
CCACOMSP EQU   @NM00041+12                                              03026000
CCACOMRS EQU   @NM00041+8                                               03027000
CCACOMNM EQU   @NM00041                                                 03028000
CCACPYPM EQU   @NM00039+24                                              03029000
@NM00040 EQU   @NM00039+21                                              03030000
CCARCOPY EQU   CCACPYRC                                                 03031000
CCACPYSP EQU   @NM00039+12                                              03032000
CCAASMPM EQU   @NM00037+24                                              03033000
@NM00038 EQU   @NM00037+21                                              03034000
CCARASM  EQU   CCAASMRC                                                 03035000
CCAASMSP EQU   @NM00037+12                                              03036000
CCAASM   EQU   @NM00037+8                                               03037000
CCAASMNM EQU   @NM00037                                                 03038000
CCALKDPM EQU   @NM00035+24                                              03039000
@NM00036 EQU   @NM00035+21                                              03040000
CCARLINK EQU   CCALKDRC                                                 03041000
CCALKDSP EQU   @NM00035+12                                              03042000
CCALKED  EQU   @NM00035+8                                               03043000
CCALKDNM EQU   @NM00035                                                 03044000
CCAPGMPM EQU   @NM00033+24                                              03045000
@NM00034 EQU   @NM00033+21                                              03046000
CCABPGRC EQU   @NM00033+20                                              03047000
CCABPGSP EQU   @NM00033+12                                              03048000
CCABPGAD EQU   @NM00033+8                                               03049000
CCABPGNM EQU   @NM00033                                                 03050000
CCAEND   EQU   HMASMCCA+371                                             03051000
@NM00032 EQU   HMASMCCA+309                                             03052000
CCACURDD EQU   CCAFDSNG+3                                               03053000
CCACURDS EQU   CCAFDSNG+2                                               03054000
@NM00031 EQU   CCAFLAGB                                                 03055000
CCAOUTNG EQU   CCAFLAGB                                                 03056000
CCALOGNG EQU   CCAFLAGB                                                 03057000
CCAFMID  EQU   HMASMCCA+291                                             03058000
CCALSTDS EQU   CCAFCTL+8                                                03059000
CCARPTDS EQU   CCAFCTL+7                                                03060000
CCATIME  EQU   CCAFCTL+4                                                03061000
CCADATE  EQU   CCAFCTL+1                                                03062000
@NM00030 EQU   CCAFLAG9                                                 03063000
CCARVCAN EQU   CCAFLAG9                                                 03064000
CCARVEST EQU   CCAFLAG9                                                 03065000
CCAPTSNJ EQU   CCAFLAG9                                                 03066000
CCASTSNP EQU   CCAFLAG9                                                 03067000
CCAMTSNP EQU   CCAFLAG9                                                 03068000
CCAPTSNP EQU   CCAFLAG9                                                 03069000
@NM00029 EQU   CCAFLAG8                                                 03070000
CCAACDSC EQU   CCAFLAG8                                                 03071000
CCACDSC  EQU   CCAFLAG8                                                 03072000
@NM00028 EQU   CCAFLAG6                                                 03073000
CCAACRUP EQU   CCAFLAG6                                                 03074000
CCACRQUP EQU   CCAFLAG6                                                 03075000
CCAACDUP EQU   CCAFLAG6                                                 03076000
CCACDSUP EQU   CCAFLAG6                                                 03077000
@NM00027 EQU   CCAFLAG5                                                 03078000
CCAACROS EQU   CCAFLAG5                                                 03079000
CCACRQOS EQU   CCAFLAG5                                                 03080000
CCAACDOS EQU   CCAFLAG5                                                 03081000
CCACDSOS EQU   CCAFLAG5                                                 03082000
@NM00026 EQU   CCAFLAG4                                                 03083000
CCAACRIS EQU   CCAFLAG4                                                 03084000
CCACRQIS EQU   CCAFLAG4                                                 03085000
CCAACDIS EQU   CCAFLAG4                                                 03086000
CCACDSIS EQU   CCAFLAG4                                                 03087000
@NM00025 EQU   CCAFLAG3+1                                               03088000
CCARGNP  EQU   CCAFLAG3+1                                               03089000
CCADISRQ EQU   CCAFLAG3+1                                               03090000
CCAICTOK EQU   CCAFLAG3                                                 03091000
CCADELP  EQU   CCAFLAG3                                                 03092000
CCACMPRS EQU   CCAFLAG3                                                 03093000
CCAZAPP  EQU   CCAFLAG3                                                 03094000
CCALINKP EQU   CCAFLAG3                                                 03095000
CCACOPYP EQU   CCAFLAG3                                                 03096000
CCAASIP  EQU   CCAFLAG3                                                 03097000
CCAUPDP  EQU   CCAFLAG3                                                 03098000
CCAEOSMP EQU   CCAFLAG2                                                 03099000
CCAEOFNC EQU   CCAFLAG2                                                 03100000
@NM00024 EQU   CCAFLAG2                                                 03101000
CCACHECK EQU   CCAFLAG2                                                 03102000
CCATERM  EQU   CCAFLAG2                                                 03103000
CCASVCLB EQU   CCAFLAG2                                                 03104000
CCANCPTF EQU   CCAFLAG2                                                 03105000
@NM00023 EQU   CCAFLAG1+1                                               03106000
CCAUNL   EQU   CCAFLAG1+1                                               03107000
CCARESET EQU   CCAFLAG1+1                                               03108000
CCALOG   EQU   CCAFLAG1+1                                               03109000
CCACNV   EQU   CCAFLAG1+1                                               03110000
CCALIST  EQU   CCAFLAG1                                                 03111000
CCAUPDU  EQU   CCAFLAG1                                                 03112000
CCAUPDJ  EQU   CCAFLAG1                                                 03113000
CCARES   EQU   CCAFLAG1                                                 03114000
CCAREJ   EQU   CCAFLAG1                                                 03115000
CCAACCPT EQU   CCAFLAG1                                                 03116000
CCAAPPLY EQU   CCAFLAG1                                                 03117000
CCAREC   EQU   CCAFLAG1                                                 03118000
CCAFUNCT EQU   CCAFFUNC                                                 03119000
@NM00022 EQU   @NM00017+18                                              03120000
@NM00021 EQU   @NM00017+16                                              03121000
CCATBLPA EQU   @NM00017+12                                              03122000
@NM00020 EQU   @NM00017+8                                               03123000
@NM00019 EQU   @NM00017+4                                               03124000
@NM00018 EQU   @NM00017                                                 03125000
CCAIFGTP EQU   CCAFGTP+16                                               03126000
CCAGTP3  EQU   CCAFGTP+12                                               03127000
CCAGTP2  EQU   CCAFGTP+8                                                03128000
CCAGTP1  EQU   CCAFGTP+4                                                03129000
CCASETAD EQU   CCASEGTP                                                 03130000
CCACLST  EQU   CCAFPGM+12                                               03131000
CCASPDCB EQU   CCAFPGM+8                                                03132000
CCAICLMD EQU   CCAFICT+12                                               03133000
CCAICMOD EQU   CCAFICT+8                                                03134000
CCAICPTF EQU   CCAFICT+4                                                03135000
CCAICT   EQU   CCAFICT                                                  03136000
CCAACDID EQU   CCAFSYS+32                                               03137000
CCACDSID EQU   CCAFSYS+24                                               03138000
CCALNLEN EQU   CCAFSYS+22                                               03139000
@NM00016 EQU   CCAFLAGA                                                 03140000
CCAPSYSF EQU   CCAFLAGA                                                 03141000
CCAASYSF EQU   CCAFLAGA                                                 03142000
CCACSYSF EQU   CCAFLAGA                                                 03143000
CCANUCID EQU   CCAFSYS+20                                               03144000
CCAASREL EQU   CCAFSYS+16                                               03145000
CCACSREL EQU   CCASREL                                                  03146000
CCAPEMAX EQU   CCAFSYS+10                                               03147000
CCAPGLEN EQU   CCAFSYS+8                                                03148000
CCAIOPAS EQU   CCAFSYS+4                                                03149000
CCAIOPCS EQU   CCAFSYS                                                  03150000
CCAPESIZ EQU   CCAFIOP+4                                                03151000
CCAIOPTR EQU   CCAFIOP                                                  03152000
@NM00015 EQU   CCAFLAG7+3                                               03153000
CCALOGP  EQU   CCAFLAG7+2                                               03154000
CCAOUTP  EQU   CCAFLAG7+2                                               03155000
CCASLBP  EQU   CCAFLAG7+2                                               03156000
CCARPTP  EQU   CCAFLAG7+2                                               03157000
CCALISTP EQU   CCAFLAG7+2                                               03158000
CCAJCLP  EQU   CCAFLAG7+2                                               03159000
CCAPTFP  EQU   CCAFLAG7+2                                               03160000
CCAUT3P  EQU   CCAFLAG7+1                                               03161000
CCAUT2P  EQU   CCAFLAG7+1                                               03162000
CCAUT1P  EQU   CCAFLAG7+1                                               03163000
CCAWK5P  EQU   CCAFLAG7+1                                               03164000
CCAWK4P  EQU   CCAFLAG7+1                                               03165000
CCAWK3P  EQU   CCAFLAG7+1                                               03166000
CCAWK2P  EQU   CCAFLAG7+1                                               03167000
CCAWK1P  EQU   CCAFLAG7+1                                               03168000
CCAACRQP EQU   CCAFLAG7                                                 03169000
CCACRQP  EQU   CCAFLAG7                                                 03170000
CCASTSP  EQU   CCAFLAG7                                                 03171000
CCAMTSP  EQU   CCAFLAG7                                                 03172000
CCAPTSP  EQU   CCAFLAG7                                                 03173000
CCASCDSP EQU   CCAFLAG7                                                 03174000
CCAACDSP EQU   CCAFLAG7                                                 03175000
CCACDSP  EQU   CCAFLAG7                                                 03176000
@NM00014 EQU   CCAFBUFR+122                                             03177000
@NM00013 EQU   CCAFBUFR+120                                             03178000
@NM00012 EQU   CCAFBUFR+118                                             03179000
CCATBFMX EQU   CCAFBUFR+116                                             03180000
CCA4BFMX EQU   CCAFBUFR+114                                             03181000
CCA3BFMX EQU   CCAFBUFR+112                                             03182000
CCA2BFMX EQU   CCAFBUFR+110                                             03183000
CCA1BFMX EQU   CCAFBUFR+108                                             03184000
CCAXBFMX EQU   CCAFBUFR+106                                             03185000
CCAQBFMX EQU   CCAFBUFR+104                                             03186000
CCASBFMX EQU   CCAFBUFR+102                                             03187000
CCAMBFMX EQU   CCAFBUFR+100                                             03188000
CCAPBFMX EQU   CCAFBUFR+98                                              03189000
CCAVBFMX EQU   CCAFBUFR+96                                              03190000
CCAABFMX EQU   CCAFBUFR+94                                              03191000
CCACBFMX EQU   CCAFBUFR+92                                              03192000
@NM00011 EQU   CCAFBUFR+88                                              03193000
@NM00010 EQU   CCAFBUFR+84                                              03194000
CCA4BFSZ EQU   CCAFBUFR+80                                              03195000
CCATBFSZ EQU   CCAFBUFR+76                                              03196000
CCAWBFSZ EQU   CCAFBUFR+72                                              03197000
CCAQBFSZ EQU   CCAFBUFR+68                                              03198000
CCAPBFSZ EQU   CCAFBUFR+64                                              03199000
CCAVBFSZ EQU   CCAFBUFR+60                                              03200000
CCACBFSZ EQU   CCAFBUFR+56                                              03201000
@NM00009 EQU   CCAFBUFR+52                                              03202000
CCA4BFOA EQU   CCAFBUFR+48                                              03203000
CCA4BFIA EQU   CCAFBUFR+44                                              03204000
CCATBFIA EQU   CCAFBUFR+40                                              03205000
CCAWBFOA EQU   CCAFBUFR+36                                              03206000
CCAWBFIA EQU   CCAFBUFR+32                                              03207000
CCAQBFOA EQU   CCAFBUFR+28                                              03208000
CCAQBFIA EQU   CCAFBUFR+24                                              03209000
CCAPBFOA EQU   CCAFBUFR+20                                              03210000
CCAPBFIA EQU   CCAFBUFR+16                                              03211000
CCAVBFOA EQU   CCAFBUFR+12                                              03212000
CCAVBFIA EQU   CCAFBUFR+8                                               03213000
CCACBFOA EQU   CCAFBUFR+4                                               03214000
CCACBFIA EQU   CCAFBUFR                                                 03215000
CCAID    EQU   HMASMCCA                                                 03216000
GPSENT   EQU   GPSKEY+1                                                 03217000
GPSTYPE  EQU   GPSKEY                                                   03218000
@NM00008 EQU   GRFFLGS                                                  03219000
GSRFMID  EQU   GSRKEY+4                                                 03220000
GSRSREL  EQU   GSRKEY                                                   03221000
@NM00007 EQU   GSMSTAT2                                                 03222000
GSMSEL   EQU   GSMSTAT2                                                 03223000
@NM00006 EQU   GSMSTAT1+1                                               03224000
GSMHPRT  EQU   GSMSTAT1+1                                               03225000
GSMNFND  EQU   GSMSTAT1+1                                               03226000
GSMCERR  EQU   GSMSTAT1+1                                               03227000
GSMRERR  EQU   GSMSTAT1+1                                               03228000
GSMRDUP  EQU   GSMSTAT1                                                 03229000
GSMSIOE  EQU   GSMSTAT1                                                 03230000
GSMNAVER EQU   GSMSTAT1                                                 03231000
GSMEXCL  EQU   GSMSTAT1                                                 03232000
GSMRCVD  EQU   GSMSTAT1                                                 03233000
GSMSYNTX EQU   GSMSTAT1                                                 03234000
GSMUSR   EQU   GSMSTAT1                                                 03235000
GSMFMID  EQU   GSMREC+8                                                 03236000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      03237000
@RF00443 EQU   @RC00438                                                 03238000
@ENDDATA EQU   *                                                        03239000
         END   HMASMRCD,(C'PLS2107',0802,78334)                         03240000
