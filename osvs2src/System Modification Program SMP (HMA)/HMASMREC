         TITLE 'HMASMREC - RECEIVE SYSMOD PROCESSOR'                    00001000
HMASMREC CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'HMASMREC  78.334'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00009000
         BALR  @08,0                                               0001 00010000
@PSTART  LA    @09,4095(,@08)                                      0001 00011000
         LA    @10,4095(,@09)                                      0001 00012000
         LA    @12,4095(,@10)                                      0001 00013000
         USING @PSTART,@08                                         0001 00014000
         USING @PSTART+4095,@09                                    0001 00015000
         USING @PSTART+8190,@10                                    0001 00016000
         USING @PSTART+12285,@12                                   0001 00017000
         ST    @13,@SA00001+4                                      0001 00018000
         LA    @14,@SA00001                                        0001 00019000
         ST    @14,8(,@13)                                         0001 00020000
         LR    @13,@14                                             0001 00021000
         MVC   @PC00001(4),0(@01)                                  0001 00022000
*                                                                  0279 00023000
*   /*****************************************************************/ 00024000
*   /*                                                               */ 00025000
*   /* INITIALIZE DATA AREAS FOR RECEIVE PROCESSING                  */ 00026000
*   /*                                                               */ 00027000
*   /*****************************************************************/ 00028000
*                                                                  0279 00029000
*                                                                  0279 00030000
*   /*****************************************************************/ 00031000
*   /*                                                               */ 00032000
*   /* INITIALIZE PROCESS CONTROL FLAGS, ETC                         */ 00033000
*   /*                                                               */ 00034000
*   /*****************************************************************/ 00035000
*                                                                  0279 00036000
*   RECLFLGS=''B;                   /* CLEAR ALL FIELDS IN RECLFLGS  */ 00037000
         MVI   RECLFLGS,X'00'                                      0279 00038000
*   RECXPARM=''B;                   /* CLEAR ALL FIELDS IN RECXPARM  */ 00039000
         XC    RECXPARM(80),RECXPARM                               0280 00040000
*   RECXPPTR=ADDR(RECPARM);         /* INITIALIZE PTR TO RECPARM     */ 00041000
         L     @15,@PC00001                                        0281 00042000
         ST    @15,RECXPPTR                                        0281 00043000
*   IF RECSEL=ON THEN                                              0282 00044000
         TM    RECSEL(@15),B'10000000'                             0282 00045000
         BNO   @RF00282                                            0282 00046000
*     RECXSEL=ON;                   /* RECEIVE "SELECT" FLAG         */ 00047000
         OI    RECXSEL,B'00000100'                                 0283 00048000
*   IF RECEXC=ON THEN                                              0284 00049000
@RF00282 L     @15,@PC00001                                        0284 00050000
         TM    RECEXC(@15),B'01000000'                             0284 00051000
         BNO   @RF00284                                            0284 00052000
*     RECXEXC=ON;                   /* RECEIVE "EXCLUDE" FLAG        */ 00053000
         OI    RECXEXC,B'00000010'                                 0285 00054000
*   RECXMAX=ZERO;                   /* INITIALIZE RETURN CODE      0286 00055000
*                                      COLLECTOR                     */ 00056000
@RF00284 SLR   @15,@15                                             0286 00057000
         ST    @15,RECXMAX                                         0286 00058000
*   RECXPROC=GO;                    /* INITIALIZE PROCESS CONTROL  0287 00059000
*                                      FLAG                          */ 00060000
         OI    RECXPROC,B'10000000'                                0287 00061000
*   RECXSEQ#=0;                     /* SUMMARY FILE SEQUENCE NUMBER  */ 00062000
         STH   @15,RECXSEQ#                                        0288 00063000
*   RECXCNT=0;                      /* RECEIVED SYSMOD COUNT         */ 00064000
         STH   @15,RECXCNT                                         0289 00065000
*   RECXSCNT=0;                     /* SELECTED SYSMOD COUNT         */ 00066000
         STH   @15,RECXSCNT                                        0290 00067000
*   RECXRCUR=0;                     /* ABSOLUTE FILE SEQUENCE NUMBER    00068000
*                                      OF 1ST FILE OF CURRENT SYSMOD */ 00069000
         STH   @15,RECXRCUR                                        0291 00070000
*   RECXRNXT=0;                     /* ABSOLUTE FILE SEQUENCE NUMBER    00071000
*                                      OF 1ST FILE OF NEXT SYSMOD    */ 00072000
         STH   @15,RECXRNXT                                        0292 00073000
*   RECXRFLE=0;                     /* NUMBER OF FILES IN CURRENT  0293 00074000
*                                      SYSMOD                        */ 00075000
         STH   @15,RECXRFLE                                        0293 00076000
*   RECXMNDX=0;                     /* COUNT OF ELEMENTS IN CURRENT     00077000
*                                      SYSMOD                        */ 00078000
         ST    @15,RECXMNDX                                        0294 00079000
*   MCSCHECK=ON;                    /* CHECK MOD.CNTL.STMTS.         */ 00080000
         OI    MCSCHECK,B'00000010'                                0295 00081000
*   MPDRETRN=0;                     /* CLEAR LAST PARSED CNTRL STMT     00082000
*                                      RETURN CODE HOLDER            */ 00083000
         ST    @15,MPDRETRN                                        0296 00084000
*   VPARTS=' ';                     /* BLANK MSG VARIABLE PART SAVE     00085000
*                                      AREA                          */ 00086000
         MVI   VPARTS+1,C' '                                       0297 00087000
         MVC   VPARTS+2(22),VPARTS+1                               0297 00088000
         MVI   VPARTS,C' '                                         0297 00089000
*                                                                  0298 00090000
*   /*****************************************************************/ 00091000
*   /*                                                               */ 00092000
*   /* HMASMMSG PARM INITIALIZATION                                  */ 00093000
*   /*                                                               */ 00094000
*   /*****************************************************************/ 00095000
*                                                                  0298 00096000
*   HMASMMGP=''B;                   /* CLEAR MGP                     */ 00097000
         XC    HMASMMGP(28),HMASMMGP                               0298 00098000
*   MGPHLDS=ON;                     /* MESSAGES TO LOG               */ 00099000
*   MGPPRINT=ON;                    /* SET FOR MSG TO PRINTER        */ 00100000
*                                                                  0300 00101000
         OI    MGPHLDS,B'10010000'                                 0300 00102000
*   /*****************************************************************/ 00103000
*   /*                                                               */ 00104000
*   /* GET CORE FOR, SET UP ADDRESSIBILITY TO AND INITIALIZE         */ 00105000
*   /* WORKAREAS                                                     */ 00106000
*   /*                                                               */ 00107000
*   /*****************************************************************/ 00108000
*                                                                  0301 00109000
*                                                                  0301 00110000
*   /*****************************************************************/ 00111000
*   /*                                                               */ 00112000
*   /* INITIALIZE SUMMARY GTA FILE                                   */ 00113000
*   /*                                                               */ 00114000
*   /*****************************************************************/ 00115000
*                                                                  0301 00116000
*   RESPECIFY                                                      0301 00117000
*     GSMREC BASED(ADDR(GTASM));    /* SUMMARY RECORD BUFFER         */ 00118000
*   RECXGSMP=ADDR(GTPSM);           /* SUMMARY GTP                   */ 00119000
         LA    @14,GTPSM                                           0302 00120000
         ST    @14,RECXGSMP                                        0302 00121000
*   RESPECIFY                                                      0303 00122000
*     HMASMGTP BASED(RECXGSMP);     /* SUMMARY GTP                   */ 00123000
*   HMASMGTP=''B;                   /* SUMMARY FILE                  */ 00124000
         XC    HMASMGTP(28,@14),HMASMGTP(@14)                      0304 00125000
*   GTPRCDLN=LENGTH(GSMREC);        /* RECORD LENGTH                 */ 00126000
         MVC   GTPRCDLN(2,@14),@CH00593                            0305 00127000
*   GTPKEYLN=LENGTH(GSMKEY);        /* KEY LENGTH                    */ 00128000
         LA    @07,8                                               0306 00129000
         STH   @07,GTPKEYLN(,@14)                                  0306 00130000
*   GTPBUFAD=ADDR(GTASM);           /* BUFFER FOR SUMMARY RECORD     */ 00131000
         LA    @06,GTASM                                           0307 00132000
         ST    @06,GTPBUFAD(,@14)                                  0307 00133000
*   GSMREC=''B;                     /* CLEAR THE SUMMARY RECORD      */ 00134000
*                                                                  0308 00135000
         XC    GSMREC(18,@06),GSMREC(@06)                          0308 00136000
*   /*****************************************************************/ 00137000
*   /*                                                               */ 00138000
*   /* INITIALIZE SREL/FMID GTA FILE                                 */ 00139000
*   /*                                                               */ 00140000
*   /*****************************************************************/ 00141000
*                                                                  0309 00142000
*   RESPECIFY                                                      0309 00143000
*     GSRREC BASED(ADDR(GTASR));    /* SREL/FMID RECORD BUFFER       */ 00144000
*   RECXGSRP=ADDR(GTPSR);           /* SREL/FMID GTP                 */ 00145000
         LA    @14,GTPSR                                           0310 00146000
         ST    @14,RECXGSRP                                        0310 00147000
*   RESPECIFY                                                      0311 00148000
*     HMASMGTP BASED(RECXGSRP);     /* SREL/FMID GTP                 */ 00149000
*   HMASMGTP=''B;                   /* SREL/FMID FILE                */ 00150000
         XC    HMASMGTP(28,@14),HMASMGTP(@14)                      0312 00151000
*   GTPRCDLN=LENGTH(GSRREC);        /* RECORD LENGTH                 */ 00152000
         LA    @06,11                                              0313 00153000
         STH   @06,GTPRCDLN(,@14)                                  0313 00154000
*   GTPKEYLN=LENGTH(GSRKEY);        /* KEY LENGTH                    */ 00155000
         STH   @06,GTPKEYLN(,@14)                                  0314 00156000
*   GTPBUFAD=ADDR(GTASR);           /* BUFFER                        */ 00157000
*                                                                  0315 00158000
         LA    @05,GTASR                                           0315 00159000
         ST    @05,GTPBUFAD(,@14)                                  0315 00160000
*   /*****************************************************************/ 00161000
*   /*                                                               */ 00162000
*   /* INITIALIZE RELFILE GTA FILE                                   */ 00163000
*   /*                                                               */ 00164000
*   /*****************************************************************/ 00165000
*                                                                  0316 00166000
*   RESPECIFY                                                      0316 00167000
*     GRFREC BASED(ADDR(GTARF));    /* RELFILE RECORD BUFFER         */ 00168000
*   RECXGRFP=ADDR(GTPRF);           /* RELFILE GTP                   */ 00169000
         LA    @14,GTPRF                                           0317 00170000
         ST    @14,RECXGRFP                                        0317 00171000
*   RESPECIFY                                                      0318 00172000
*     HMASMGTP BASED(RECXGRFP);     /* RELFILE GTP                   */ 00173000
*   HMASMGTP=''B;                   /* RELFILE FILE                  */ 00174000
         XC    HMASMGTP(28,@14),HMASMGTP(@14)                      0319 00175000
*   GTPRCDLN=LENGTH(GRFREC);        /* RECORD LENGTH                 */ 00176000
         MVC   GTPRCDLN(2,@14),@CH00608                            0320 00177000
*   GTPKEYLN=LENGTH(GRFKEY);        /* KEY LENGTH                    */ 00178000
         STH   @06,GTPKEYLN(,@14)                                  0321 00179000
*   GTPBUFAD=ADDR(GTARF);           /* BUFFER                        */ 00180000
*                                                                  0322 00181000
         LA    @06,GTARF                                           0322 00182000
         ST    @06,GTPBUFAD(,@14)                                  0322 00183000
*   /*****************************************************************/ 00184000
*   /*                                                               */ 00185000
*   /* INITIALIZE PTS SYSTEM ENTRY GTA FILE                          */ 00186000
*   /*                                                               */ 00187000
*   /*****************************************************************/ 00188000
*                                                                  0323 00189000
*   RESPECIFY                                                      0323 00190000
*     GPSREC BASED(ADDR(GTAPS));    /* PTS SYS RECORD BUFFER         */ 00191000
*   RECXGPSP=ADDR(GTPPS);           /* PTS SYSTEM ENTRY GTP          */ 00192000
         LA    @14,GTPPS                                           0324 00193000
         ST    @14,RECXGPSP                                        0324 00194000
*   RESPECIFY                                                      0325 00195000
*     HMASMGTP BASED(RECXGPSP);     /* PTS SYSTEM ENTRY GTP          */ 00196000
*   HMASMGTP=''B;                   /* PTS SYSTEM ENTRY FILE         */ 00197000
         XC    HMASMGTP(28,@14),HMASMGTP(@14)                      0326 00198000
*   GTPRCDLN=LENGTH(GPSREC);        /* RECORD LENGTH                 */ 00199000
         STH   @07,GTPRCDLN(,@14)                                  0327 00200000
*   GTPKEYLN=LENGTH(GPSKEY);        /* KEY LENGTH                    */ 00201000
         STH   @07,GTPKEYLN(,@14)                                  0328 00202000
*   GTPBUFAD=ADDR(GTAPS);           /* BUFFER                        */ 00203000
*                                                                  0329 00204000
         LA    @07,GTAPS                                           0329 00205000
         ST    @07,GTPBUFAD(,@14)                                  0329 00206000
*   /*****************************************************************/ 00207000
*   /*                                                               */ 00208000
*   /* RECOVERY PARM INITIALIZATION                                  */ 00209000
*   /*                                                               */ 00210000
*   /*****************************************************************/ 00211000
*                                                                  0330 00212000
*   RESPECIFY                                                      0330 00213000
*     RVAPARM BASED(CCARVAD);       /* ADDRESS RVA                   */ 00214000
*   RVAREC=ADDR(RECXPARM);          /* PUT IN PTR TO RECXPARM        */ 00215000
*                                                                  0331 00216000
         L     @01,CCARVAD(,CCAPTR)                                0331 00217000
         LA    @00,RECXPARM                                        0331 00218000
         ST    @00,RVAREC(,@01)                                    0331 00219000
*   /*****************************************************************/ 00220000
*   /*                                                               */ 00221000
*   /* GET CORE FOR MCB FOR USE BY HMASMMPD                          */ 00222000
*   /*                                                               */ 00223000
*   /*****************************************************************/ 00224000
*                                                                  0332 00225000
*   RECXMCB=0;                      /* CLEAR PTR TO MCB              */ 00226000
         ST    @15,RECXMCB                                         0332 00227000
*   IF RECXMAX<STOPFUNC THEN                                       0333 00228000
         L     @15,RECXMAX                                         0333 00229000
         CH    @15,@CH00036                                        0333 00230000
         BNL   @RF00333                                            0333 00231000
*     DO;                                                          0334 00232000
*       SPLFUNCT=SPLGMIOP;          /* GETMAIN IOP FUNCTION          */ 00233000
         MVI   SPLFUNCT,X'03'                                      0335 00234000
*       CALL HMASMSUB(HMASMSPL);                                   0336 00235000
         L     @15,@CV01709                                        0336 00236000
         LA    @01,@AL00336                                        0336 00237000
         BALR  @14,@15                                             0336 00238000
*       RESPECIFY                                                  0337 00239000
*         REG15 RSTD;                                              0337 00240000
*       IF REG15^=0 THEN                                           0338 00241000
         LTR   REG15,REG15                                         0338 00242000
         BZ    @RF00338                                            0338 00243000
*         DO;                                                      0339 00244000
*                                                                  0339 00245000
*           /*********************************************************/ 00246000
*           /*                                                       */ 00247000
*           /* INSUFFICIENT STORAGE ... STOP RECEIVE                 */ 00248000
*           /*                                                       */ 00249000
*           /*********************************************************/ 00250000
*                                                                  0340 00251000
*           RFY                                                    0340 00252000
*             REG15 UNRSTD;                                        0340 00253000
*           RECXMAX=MAX(RECXMAX,STOPFUNC);/* SEVERE ERROR            */ 00254000
         L     @15,RECXMAX                                         0341 00255000
         LA    @14,12                                              0341 00256000
         CR    @15,@14                                             0341 00257000
         BNL   *+6                                                      00258000
         LR    @15,@14                                             0341 00259000
         ST    @15,RECXMAX                                         0341 00260000
*         END;                                                     0342 00261000
*       ELSE                                                       0343 00262000
*         DO;                                                      0343 00263000
         B     @RC00338                                            0343 00264000
@RF00338 DS    0H                                                  0344 00265000
*           RECXMCB=SPLPMAD;        /* SET UP ADDRESSIBILITY FOR MCB    00266000
*                                      CORE UPON WHICH ALL MCB TYPES    00267000
*                                      ARE MAPPED                    */ 00268000
         L     @15,SPLPMAD                                         0344 00269000
         ST    @15,RECXMCB                                         0344 00270000
*           RECXMCB->HMASMIOP=''B;  /* CLEAR MCB                     */ 00271000
         XC    HMASMIOP(68,@15),HMASMIOP(@15)                      0345 00272000
*         END;                                                     0346 00273000
*     END;                                                         0347 00274000
@RC00338 DS    0H                                                  0348 00275000
*   RESPECIFY                                                      0348 00276000
*     MCBPTFMP BASED(RECXMCB);      /* SYSMOD HEADER MCB             */ 00277000
@RF00333 DS    0H                                                  0349 00278000
*   RESPECIFY                                                      0349 00279000
*     MCBVERMP BASED(RECXMCB);      /* ++VER MCB                     */ 00280000
*   RESPECIFY                                                      0350 00281000
*     MCBIFMP BASED(RECXMCB);       /* ++IF MCB                      */ 00282000
*   RESPECIFY                                                      0351 00283000
*     MCBELEMP BASED(RECXMCB);      /* ++ELEM MCB                    */ 00284000
*                                                                  0351 00285000
*   /*****************************************************************/ 00286000
*   /*                                                               */ 00287000
*   /* GET PTS SYSMOD ENTRY IOP                                      */ 00288000
*   /*                                                               */ 00289000
*   /*****************************************************************/ 00290000
*                                                                  0352 00291000
*   RECXIOPP=0;                     /* CLEAR PTR TO IOP              */ 00292000
         SLR   @15,@15                                             0352 00293000
         ST    @15,RECXIOPP                                        0352 00294000
*   IF RECXMAX<STOPFUNC THEN                                       0353 00295000
         L     @15,RECXMAX                                         0353 00296000
         CH    @15,@CH00036                                        0353 00297000
         BNL   @RF00353                                            0353 00298000
*     DO;                                                          0354 00299000
*       SPLFUNCT=SPLGMIOP;          /* GETMAIN IOP FUNCTION          */ 00300000
         MVI   SPLFUNCT,X'03'                                      0355 00301000
*       CALL HMASMSUB(HMASMSPL);                                   0356 00302000
         L     @15,@CV01709                                        0356 00303000
         LA    @01,@AL00356                                        0356 00304000
         BALR  @14,@15                                             0356 00305000
*       RESPECIFY                                                  0357 00306000
*         REG15 RSTD;                                              0357 00307000
*       IF REG15^=0 THEN                                           0358 00308000
         LTR   REG15,REG15                                         0358 00309000
         BZ    @RF00358                                            0358 00310000
*         DO;                                                      0359 00311000
*                                                                  0359 00312000
*           /*********************************************************/ 00313000
*           /*                                                       */ 00314000
*           /* INSUFFICIENT STORAGE ... STOP RECEIVE                 */ 00315000
*           /*                                                       */ 00316000
*           /*********************************************************/ 00317000
*                                                                  0360 00318000
*           RFY                                                    0360 00319000
*             REG15 UNRSTD;                                        0360 00320000
*           RECXMAX=MAX(RECXMAX,STOPFUNC);/* SEVERE ERROR            */ 00321000
         L     @15,RECXMAX                                         0361 00322000
         LA    @14,12                                              0361 00323000
         CR    @15,@14                                             0361 00324000
         BNL   *+6                                                      00325000
         LR    @15,@14                                             0361 00326000
         ST    @15,RECXMAX                                         0361 00327000
*         END;                                                     0362 00328000
*       ELSE                                                       0363 00329000
*         DO;                                                      0363 00330000
         B     @RC00358                                            0363 00331000
@RF00358 DS    0H                                                  0364 00332000
*           RECXIOPP=SPLPMAD;       /* PTS SYSMOD IOP                */ 00333000
         L     @15,SPLPMAD                                         0364 00334000
         ST    @15,RECXIOPP                                        0364 00335000
*           RECXIOPP->HMASMIOP=''B; /* CLEAR IOP                     */ 00336000
         XC    HMASMIOP(68,@15),HMASMIOP(@15)                      0365 00337000
*           RECXIOPP->IOPDSID=IOPPTS;/* DATASET IS SMPPTS            */ 00338000
         MVI   IOPDSID(@15),X'06'                                  0366 00339000
*           RECXIOPP->IOPTYPE=IOPSMD;/* ENTRY TYPE IS "SMD"          */ 00340000
         MVI   IOPTYPE(@15),X'0B'                                  0367 00341000
*           RECXIOPP->IOPFUNCT=IOPOPEN;/* CHECKED BY HMASMRCF        */ 00342000
         MVI   IOPFUNCT(@15),X'00'                                 0368 00343000
*           RECXIOPP->IOPNAME=' ';  /* BLANK ENTRY NAME              */ 00344000
         MVI   IOPNAME+1(@15),C' '                                 0369 00345000
         MVC   IOPNAME+2(6,@15),IOPNAME+1(@15)                     0369 00346000
         MVI   IOPNAME(@15),C' '                                   0369 00347000
*           RECXIOPP->IOPRETRN=ZERO;/* CLEAR RETURN CODE FIELD       */ 00348000
         MVI   IOPRETRN(@15),X'00'                                 0370 00349000
*           RECXIOPP->IOPPTFNT=''B; /* CLEAR IOPUDATA PORTION        */ 00350000
         XC    IOPPTFNT(104,@15),IOPPTFNT(@15)                     0371 00351000
*           RECXIOPP->IOPNTLVL=IOPPTFLC;/* SET ENTRY LEVEL           */ 00352000
         MVI   IOPNTLVL(@15),X'02'                                 0372 00353000
*           RECXIOPP->IOPPTFND(1)=IOPEOLST;/* SET END-OF-LIST        */ 00354000
         MVI   IOPPTFND(@15),X'FF'                                 0373 00355000
*         END;                                                     0374 00356000
*     END;                                                         0375 00357000
*                                                                  0375 00358000
@RC00358 DS    0H                                                  0376 00359000
*   /*****************************************************************/ 00360000
*   /*                                                               */ 00361000
*   /* GET PTS MCS ENTRY IOP                                         */ 00362000
*   /*                                                               */ 00363000
*   /*****************************************************************/ 00364000
*                                                                  0376 00365000
*   RECXIOPT=0;                     /* CLEAR PTR TO IOP              */ 00366000
@RF00353 SLR   @15,@15                                             0376 00367000
         ST    @15,RECXIOPT                                        0376 00368000
*   IF RECXMAX<STOPFUNC THEN                                       0377 00369000
         L     @15,RECXMAX                                         0377 00370000
         CH    @15,@CH00036                                        0377 00371000
         BNL   @RF00377                                            0377 00372000
*     DO;                                                          0378 00373000
*       SPLFUNCT=SPLGMIOP;          /* GETMAIN IOP FUNCTION          */ 00374000
         MVI   SPLFUNCT,X'03'                                      0379 00375000
*       CALL HMASMSUB(HMASMSPL);                                   0380 00376000
         L     @15,@CV01709                                        0380 00377000
         LA    @01,@AL00380                                        0380 00378000
         BALR  @14,@15                                             0380 00379000
*       RESPECIFY                                                  0381 00380000
*         REG15 RSTD;                                              0381 00381000
*       IF REG15^=0 THEN                                           0382 00382000
         LTR   REG15,REG15                                         0382 00383000
         BZ    @RF00382                                            0382 00384000
*         DO;                                                      0383 00385000
*                                                                  0383 00386000
*           /*********************************************************/ 00387000
*           /*                                                       */ 00388000
*           /* INSUFFICIENT STORAGE ... STOP RECEIVE                 */ 00389000
*           /*                                                       */ 00390000
*           /*********************************************************/ 00391000
*                                                                  0384 00392000
*           RFY                                                    0384 00393000
*             REG15 UNRSTD;                                        0384 00394000
*           RECXMAX=MAX(RECXMAX,STOPFUNC);/* SEVERE ERROR            */ 00395000
         L     @15,RECXMAX                                         0385 00396000
         LA    @14,12                                              0385 00397000
         CR    @15,@14                                             0385 00398000
         BNL   *+6                                                      00399000
         LR    @15,@14                                             0385 00400000
         ST    @15,RECXMAX                                         0385 00401000
*         END;                                                     0386 00402000
*       ELSE                                                       0387 00403000
*         DO;                                                      0387 00404000
         B     @RC00382                                            0387 00405000
@RF00382 DS    0H                                                  0388 00406000
*           RECXIOPT=SPLPMAD;       /* PTS TEXT IOP                  */ 00407000
         L     @15,SPLPMAD                                         0388 00408000
         ST    @15,RECXIOPT                                        0388 00409000
*           RECXIOPT->HMASMIOP=''B; /* CLEAR IOP                     */ 00410000
         XC    HMASMIOP(68,@15),HMASMIOP(@15)                      0389 00411000
*           RECXIOPT->IOPDSID=IOPPTS;/* DATASET IS SMPPTS            */ 00412000
         MVI   IOPDSID(@15),X'06'                                  0390 00413000
*           RECXIOPT->IOPTYPE=IOPMCS;/* ENTRY TYPE IS "MCS"          */ 00414000
         MVI   IOPTYPE(@15),X'10'                                  0391 00415000
*           RECXIOPT->IOPNAME=' ';  /* BLANK ENTRY NAME              */ 00416000
         MVI   IOPNAME+1(@15),C' '                                 0392 00417000
         MVC   IOPNAME+2(6,@15),IOPNAME+1(@15)                     0392 00418000
         MVI   IOPNAME(@15),C' '                                   0392 00419000
*           RECXIOPT->IOPFUNCT=IOPOPEN;/* CHECKED BY HMASMRCF        */ 00420000
         MVI   IOPFUNCT(@15),X'00'                                 0393 00421000
*           RECXIOPT->IOPRETRN=ZERO;/* CLEAR RETURN CODE FIELD       */ 00422000
         MVI   IOPRETRN(@15),X'00'                                 0394 00423000
*           RECXIOPT->IOPPTFNT=''B; /* CLEAR IOPUDATA PORTION        */ 00424000
         XC    IOPPTFNT(104,@15),IOPPTFNT(@15)                     0395 00425000
*           RECXIOPT->IOPNTLVL=IOPPTFLC;/* SET ENTRY LEVEL           */ 00426000
         MVI   IOPNTLVL(@15),X'02'                                 0396 00427000
*         END;                                                     0397 00428000
*     END;                                                         0398 00429000
*                                                                  0398 00430000
@RC00382 DS    0H                                                  0399 00431000
*   /*****************************************************************/ 00432000
*   /*                                                               */ 00433000
*   /* CCAIOP USED AS THE GENERAL USE IOP                            */ 00434000
*   /*                                                               */ 00435000
*   /*****************************************************************/ 00436000
*                                                                  0399 00437000
*   SAVBUFAD=CCAIOPTR->IOPBUFAD;    /* SAVE IOPBUFAD BEFORE USE      */ 00438000
@RF00377 L     @15,CCAIOPTR(,CCAPTR)                               0399 00439000
         MVC   SAVBUFAD(4),IOPBUFAD(@15)                           0399 00440000
*   RECXIOPG=CCAIOPTR;              /* GENERAL USE IOP               */ 00441000
         ST    @15,RECXIOPG                                        0400 00442000
*   RECXIOPG->HMASMIOP=''B;         /* CLEAR IOP                     */ 00443000
         XC    HMASMIOP(68,@15),HMASMIOP(@15)                      0401 00444000
*   RECXIOPG->IOPNAME=' ';          /* BLANK ENTRY NAME              */ 00445000
         MVI   IOPNAME+1(@15),C' '                                 0402 00446000
         MVC   IOPNAME+2(6,@15),IOPNAME+1(@15)                     0402 00447000
         MVI   IOPNAME(@15),C' '                                   0402 00448000
*   RECXIOPG->IOPPTFNT=''B;         /* CLEAR IOPUDATA PORTION        */ 00449000
         XC    IOPPTFNT(104,@15),IOPPTFNT(@15)                     0403 00450000
*   RECXIOPG->IOPNTLVL=IOPPTFLC;    /* SET ENTRY LEVEL               */ 00451000
*                                                                  0404 00452000
         MVI   IOPNTLVL(@15),X'02'                                 0404 00453000
*   /*****************************************************************/ 00454000
*   /*                                                               */ 00455000
*   /* HMASMSCN PARAMETER INITIALIZATION (HMASMSCP)                  */ 00456000
*   /*                                                               */ 00457000
*   /*****************************************************************/ 00458000
*                                                                  0405 00459000
*   SCPPTR=ADDR(SCPSTORE);          /* SET TO STORAGE ALLOCATED FOR     00460000
*                                      SCP                           */ 00461000
         LA    @14,SCPSTORE                                        0405 00462000
         ST    @14,SCPPTR                                          0405 00463000
*   HMASMSCP=''B;                   /* CLEAR SCP                     */ 00464000
         XC    HMASMSCP(26,@14),HMASMSCP(@14)                      0406 00465000
*   SCPCOMNT=ON;                    /* SET SKIP-BY COMMENTS DURING 0407 00466000
*                                      SCAN                          */ 00467000
         OI    SCPCOMNT(@14),B'00100000'                           0407 00468000
*   SCPINLN=LENGTH(CRPBUFFR);       /* BUFFER IN CRD PARM LIST       */ 00469000
         MVC   SCPINLN(2,@14),@CH00429                             0408 00470000
*   SCPIORTN=ADDR(HMASMCRD);        /* FOR ADDITIONAL RECORDS DURING    00471000
*                                      SCAN GO HERE                  */ 00472000
         L     @07,@CV01708                                        0409 00473000
         ST    @07,SCPIORTN(,@14)                                  0409 00474000
*   SCPIOPAD=ADDR(HMASMCRP);        /* PARM LIST FOR HMASMCRD        */ 00475000
*                                                                  0410 00476000
         LA    @07,HMASMCRP                                        0410 00477000
         ST    @07,SCPIOPAD(,@14)                                  0410 00478000
*   /*****************************************************************/ 00479000
*   /*                                                               */ 00480000
*   /* HMASMCRD PARAMETER (HMASMCRP) INITIALIZATION                  */ 00481000
*   /*                                                               */ 00482000
*   /*****************************************************************/ 00483000
*                                                                  0411 00484000
*   HMASMCRP=''B;                   /* CLEAR THE CRP                 */ 00485000
         XC    HMASMCRP(106),HMASMCRP                              0411 00486000
*   CRPUXNUM=UXPUX001;              /* SET RECEIVE USER EXIT         */ 00487000
         MVI   CRPUXNUM,X'01'                                      0412 00488000
*   CRPSCPAD=SCPPTR;                /* SCP ADDRESS                   */ 00489000
         ST    @14,CRPSCPAD                                        0413 00490000
*   CRPINDS=IOPPTFIN;               /* INPUT DATASET (SMPPTFIN)      */ 00491000
         MVI   CRPINDS,X'0A'                                       0414 00492000
*   CRPOFFST=ON;                    /* OFFSET LINES TO SMPOUT        */ 00493000
*                                                                  0415 00494000
         OI    CRPOFFST,B'00000010'                                0415 00495000
*   /*****************************************************************/ 00496000
*   /*                                                               */ 00497000
*   /* HMASMMPD PARAMETER INITIALIZATION (MPPPARM)                   */ 00498000
*   /*                                                               */ 00499000
*   /*****************************************************************/ 00500000
*                                                                  0416 00501000
*   MPPPARM=''B;                    /* CLEAR MPPPARM PARM BLOCK      */ 00502000
         XC    MPPPARM(23),MPPPARM                                 0416 00503000
*   MPPIOPAD=RECXIOPP;              /* PTS PTF IOP ADDRESS           */ 00504000
         MVC   MPPIOPAD(4),RECXIOPP                                0417 00505000
*   MPPMCBAD=RECXMCB;               /* ADDRESS OF MCB TO BE FILLED   */ 00506000
         MVC   MPPMCBAD(4),RECXMCB                                 0418 00507000
*   MPPCRDAD=ADDR(HMASMCRD);        /* GET ROUTINE FOR USE BY MPD    */ 00508000
         L     @14,@CV01708                                        0419 00509000
         ST    @14,MPPCRDAD                                        0419 00510000
*   MPPCRDPM=ADDR(HMASMCRP);        /* GET ROUTINE PARM LIST         */ 00511000
         LA    @14,HMASMCRP                                        0420 00512000
         ST    @14,MPPCRDPM                                        0420 00513000
*   IF RECXMAX<STOPFUNC THEN                                       0421 00514000
         L     @14,RECXMAX                                         0421 00515000
         CH    @14,@CH00036                                        0421 00516000
         BNL   @RF00421                                            0421 00517000
*     DO;                                                          0422 00518000
*                                                                  0422 00519000
*       /*************************************************************/ 00520000
*       /*                                                           */ 00521000
*       /* ACCESS THE PTS SYSTEM ENTRY AND EXTRACT DATA PERTINENT TO */ 00522000
*       /* RECEIVE PROCESSING                                        */ 00523000
*       /*                                                           */ 00524000
*       /*************************************************************/ 00525000
*                                                                  0423 00526000
*       RECXIOPG->IOPDSID=IOPPTS;                                  0423 00527000
         MVI   IOPDSID(@15),X'06'                                  0423 00528000
*       RECXIOPG->IOPNAME=' ';                                     0424 00529000
         MVI   IOPNAME+1(@15),C' '                                 0424 00530000
         MVC   IOPNAME+2(6,@15),IOPNAME+1(@15)                     0424 00531000
         MVI   IOPNAME(@15),C' '                                   0424 00532000
*       RECXIOPG->IOPTYPE=IOPSYS;                                  0425 00533000
         MVI   IOPTYPE(@15),X'07'                                  0425 00534000
*       RECXIOPG->IOPFUNCT=IOPLOC;                                 0426 00535000
         MVI   IOPFUNCT(@15),X'03'                                 0426 00536000
*       CALL HMASMIO(RECXIOPG->HMASMIOP);/* GET PTS SYSTEM ENTRY     */ 00537000
         ST    @15,@AL00001                                        0427 00538000
         L     @15,@CV01703                                        0427 00539000
         LA    @01,@AL00001                                        0427 00540000
         BALR  @14,@15                                             0427 00541000
*       IF RECXIOPG->IOPRETRN>=IOPNOTFD THEN                       0428 00542000
         L     @15,RECXIOPG                                        0428 00543000
         CLI   IOPRETRN(@15),4                                     0428 00544000
         BL    @RF00428                                            0428 00545000
*         DO;                                                      0429 00546000
*                                                                  0429 00547000
*           /*********************************************************/ 00548000
*           /*                                                       */ 00549000
*           /* PTS SYSTEM ENTRY COULD NOT BE ACCESSED                */ 00550000
*           /*                                                       */ 00551000
*           /*********************************************************/ 00552000
*                                                                  0430 00553000
*           RECXMAX=STOPFUNC;       /* STOP RECEIVE                  */ 00554000
         LA    @14,12                                              0430 00555000
         ST    @14,RECXMAX                                         0430 00556000
*           RECXMAX=MAX(RECXMAX,RECXIOPG->IOPRETRN);/* IN CASE HIGHER*/ 00557000
         SLR   @07,@07                                             0431 00558000
         IC    @07,IOPRETRN(,@15)                                  0431 00559000
         CR    @14,@07                                             0431 00560000
         BNL   *+6                                                      00561000
         LR    @14,@07                                             0431 00562000
         ST    @14,RECXMAX                                         0431 00563000
*           IF RECXIOPG->IOPRETRN=IOPNOTFD THEN                    0432 00564000
         CLI   IOPRETRN(@15),4                                     0432 00565000
         BNE   @RF00432                                            0432 00566000
*             MGPTYPE=MGPSEV;       /* SEVERE ERROR                  */ 00567000
         MVI   MGPTYPE,X'04'                                       0433 00568000
*           ELSE                                                   0434 00569000
*             MGPTYPE=MGPINFO;      /* INFORMATIONAL ... AN I/O MSG     00570000
*                                      HAS BEEN ISSUED ALREADY IN  0434 00571000
*                                      THIS CASE                     */ 00572000
*                                                                  0434 00573000
         B     @RC00432                                            0434 00574000
@RF00432 MVI   MGPTYPE,X'01'                                       0434 00575000
*           /*********************************************************/ 00576000
*           /*                                                       */ 00577000
*           /* PTS SYSTEM ENTRY NOT FOUND ... ISSUE HMA246I          */ 00578000
*           /*                                                       */ 00579000
*           /*********************************************************/ 00580000
*                                                                  0435 00581000
*           CALL ERRMSG(HMA246I,NOPART,NOPART);/* PTS SYSTEM ENTRY 0435 00582000
*                                      NOT FOUND MESSAGE             */ 00583000
@RC00432 LA    @01,@AL00435                                        0435 00584000
         BAL   @14,ERRMSG                                          0435 00585000
*         END;                                                     0436 00586000
*       ELSE                                                       0437 00587000
*         DO;                                                      0437 00588000
*                                                                  0437 00589000
         B     @RC00428                                            0437 00590000
@RF00428 DS    0H                                                  0438 00591000
*           /*********************************************************/ 00592000
*           /*                                                       */ 00593000
*           /* PTS SYSTEM ENTRY FOUND ... EXTRACT DATA PERTINENT TO  */ 00594000
*           /* RECEIVE PROCESSING                                    */ 00595000
*           /*                                                       */ 00596000
*           /*********************************************************/ 00597000
*                                                                  0438 00598000
*           RESPECIFY                                              0438 00599000
*             HMASMIOP BASED(RECXIOPG);                            0438 00600000
*           RECXDSPC=IOPDSSPC;      /* RELFILE SPACE ALLOCATION DATA */ 00601000
         L     @15,RECXIOPG                                        0439 00602000
         MVC   RECXDSPC(6),IOPDSSPC(@15)                           0439 00603000
*           RECDSPFX=IOPDSPFX;      /* TLIB DSN PREFIX               */ 00604000
*                                                                  0440 00605000
         MVC   RECDSPFX(26),IOPDSPFX(@15)                          0440 00606000
*           /*********************************************************/ 00607000
*           /*                                                       */ 00608000
*           /* INITIALIZE PTS SYSTEM ENTRY GTA FILE FROM THE DATA IN */ 00609000
*           /* THE PTS SYSTEM ENTRY                                  */ 00610000
*           /*                                                       */ 00611000
*           /*********************************************************/ 00612000
*                                                                  0441 00613000
*           RESPECIFY                                              0441 00614000
*             HMASMGTP BASED(RECXGPSP);/* PTS SYSTEM ENTRY GTP       */ 00615000
*           DO I=1 BY 1 WHILE IOPPTSND(I)^=IOPEOLST&RECXMAX<STOPFUNC;   00616000
*                                                                  0442 00617000
         LA    @15,1                                               0442 00618000
         ST    @15,I                                               0442 00619000
         B     @DE00442                                            0442 00620000
@DL00442 DS    0H                                                  0443 00621000
*             /*******************************************************/ 00622000
*             /*                                                     */ 00623000
*             /* EXTRACT SRELS AND FMIDS FROM THE PTS SYSTEM ENTRY   */ 00624000
*             /* AND PUT THEM IN THE PTSSYS GTA FILE.                */ 00625000
*             /*                                                     */ 00626000
*             /*******************************************************/ 00627000
*                                                                  0443 00628000
*             IF IOPPTIND(I)=IOPPTFM|IOPPTIND(I)=IOPPTSRL THEN     0443 00629000
         L     @15,I                                               0443 00630000
         MH    @15,@CH00034                                        0443 00631000
         L     @01,RECXIOPG                                        0443 00632000
         SLR   @14,@14                                             0443 00633000
         IC    @14,IOPPTIND-9(@15,@01)                             0443 00634000
         CH    @14,@CH00041                                        0443 00635000
         BE    @RT00443                                            0443 00636000
         CH    @14,@CH00232                                        0443 00637000
         BNE   @RF00443                                            0443 00638000
@RT00443 DS    0H                                                  0444 00639000
*               DO;                                                0444 00640000
*                 GPSTYPE=IOPPTIND(I);/* SET FMID OR SREL TYPE       */ 00641000
         LA    @15,GTAPS                                           0445 00642000
         L     @14,RECXIOPG                                        0445 00643000
         L     @07,I                                               0445 00644000
         MH    @07,@CH00034                                        0445 00645000
         SLR   @06,@06                                             0445 00646000
         IC    @06,IOPPTIND-9(@07,@14)                             0445 00647000
         STC   @06,GPSTYPE(,@15)                                   0445 00648000
*                 GPSENT=' ';       /* BLANK PART OF RECORD          */ 00649000
         MVI   GPSENT+1(@15),C' '                                  0446 00650000
         MVC   GPSENT+2(5,@15),GPSENT+1(@15)                       0446 00651000
         MVI   GPSENT(@15),C' '                                    0446 00652000
*                 IF GPSTYPE=IOPPTFM THEN                          0447 00653000
         CLI   GPSTYPE(@15),1                                      0447 00654000
         BNE   @RF00447                                            0447 00655000
*                   GPSENT=IOPPTFMD(I);/* FMID VALUE                 */ 00656000
         ALR   @14,@07                                             0448 00657000
         MVC   GPSENT(7,@15),IOPPTFMD-9(@14)                       0448 00658000
*                 ELSE                                             0449 00659000
*                   GPSENT=IOPPTREL(I);/* SREL VALUE                 */ 00660000
         B     @RC00447                                            0449 00661000
@RF00447 LA    @15,GTAPS                                           0449 00662000
         MVI   GPSENT+4(@15),C' '                                  0449 00663000
         MVC   GPSENT+5(2,@15),GPSENT+4(@15)                       0449 00664000
         L     @14,I                                               0449 00665000
         MH    @14,@CH00034                                        0449 00666000
         L     @01,RECXIOPG                                        0449 00667000
         ALR   @01,@14                                             0449 00668000
         MVC   GPSENT(4,@15),IOPPTREL-9(@01)                       0449 00669000
*                 GTPFUNCT=GTPADD;  /* ADD RECORD TO FILE            */ 00670000
@RC00447 L     @15,RECXGPSP                                        0450 00671000
         MVI   GTPFUNCT(@15),X'04'                                 0450 00672000
*                 CALL HMASMGTA(HMASMGTP);/* ADD RECORD              */ 00673000
         ST    @15,@AL00001                                        0451 00674000
         L     @15,@CV01706                                        0451 00675000
         LA    @01,@AL00001                                        0451 00676000
         BALR  @14,@15                                             0451 00677000
*                 IF GTPRETRN>=GTPSPACE THEN                       0452 00678000
         L     @01,RECXGPSP                                        0452 00679000
         CLI   GTPRETRN(@01),12                                    0452 00680000
         BL    @RF00452                                            0452 00681000
*                   RECXMAX=STOPFUNC;                              0453 00682000
         MVC   RECXMAX(4),@CF00036                                 0453 00683000
*               END;                                               0454 00684000
@RF00452 DS    0H                                                  0455 00685000
*           END;                                                   0455 00686000
@RF00443 LA    @15,1                                               0455 00687000
         AL    @15,I                                               0455 00688000
         ST    @15,I                                               0455 00689000
@DE00442 L     @15,I                                               0455 00690000
         MH    @15,@CH00034                                        0455 00691000
         L     @01,RECXIOPG                                        0455 00692000
         SLR   @14,@14                                             0455 00693000
         IC    @14,IOPPTSND-9(@15,@01)                             0455 00694000
         CH    @14,@CH00766                                        0455 00695000
         BE    @DC00442                                            0455 00696000
         L     @15,RECXMAX                                         0455 00697000
         CH    @15,@CH00036                                        0455 00698000
         BL    @DL00442                                            0455 00699000
@DC00442 DS    0H                                                  0456 00700000
*         END;                                                     0456 00701000
*     END;                                                         0457 00702000
@RC00428 DS    0H                                                  0458 00703000
*   IF RECXMAX<STOPFUNC THEN                                       0458 00704000
@RF00421 L     @15,RECXMAX                                         0458 00705000
         CH    @15,@CH00036                                        0458 00706000
         BNL   @RF00458                                            0458 00707000
*     DO;                                                          0459 00708000
*                                                                  0459 00709000
*       /*************************************************************/ 00710000
*       /*                                                           */ 00711000
*       /* FOR PROCESSING SELECTED SYSMODS, DETERMINE HOW MANY       */ 00712000
*       /* SYSMODS ARE SELECTED SO RECEIVE MAY STOP WHEN ALL SELECTED*/ 00713000
*       /* SYSMODS HAVE BEEN PROCESSED                               */ 00714000
*       /*                                                           */ 00715000
*       /*************************************************************/ 00716000
*                                                                  0460 00717000
*       IF RECSEL=ON THEN                                          0460 00718000
         L     @15,@PC00001                                        0460 00719000
         TM    RECSEL(@15),B'10000000'                             0460 00720000
         BNO   @RF00460                                            0460 00721000
*         DO;                                                      0461 00722000
*                                                                  0461 00723000
*           /*********************************************************/ 00724000
*           /*                                                       */ 00725000
*           /* SELECT SPECIFIED                                      */ 00726000
*           /*                                                       */ 00727000
*           /*********************************************************/ 00728000
*                                                                  0462 00729000
*           RECXSCNT=0;             /* CLEAR COUNT OF SELECTED     0462 00730000
*                                      SYSMODS                       */ 00731000
         SLR   @15,@15                                             0462 00732000
         STH   @15,RECXSCNT                                        0462 00733000
*           RESPECIFY                                              0463 00734000
*             HMASMGTP BASED(CCASETAD);/* SELECT/EXCLUDE GTP         */ 00735000
*           GTPFUNCT=GTPOPENN;      /* OPEN SELECT/EXCLUDE GTA FILE  */ 00736000
         L     @15,CCASETAD(,CCAPTR)                               0464 00737000
         MVI   GTPFUNCT(@15),X'01'                                 0464 00738000
*           GTPBUFAD=ADDR(HMASMSET);/* SET UP POINTER TO SET STORE   */ 00739000
         LA    @14,HMASMSET                                        0465 00740000
         ST    @14,GTPBUFAD(,@15)                                  0465 00741000
*           CALL HMASMGTA(HMASMGTP);                               0466 00742000
         ST    @15,@AL00001                                        0466 00743000
         L     @15,@CV01706                                        0466 00744000
         LA    @01,@AL00001                                        0466 00745000
         BALR  @14,@15                                             0466 00746000
*           GTPFUNCT=GTPGETN;       /* SET FUNCTION TO GET RECORDS 0467 00747000
*                                      SEQUENTIALLY FROM SET         */ 00748000
         L     @15,CCASETAD(,CCAPTR)                               0467 00749000
         MVI   GTPFUNCT(@15),X'08'                                 0467 00750000
*           CALL HMASMGTA(HMASMGTP);/* GET FIRST RECORD              */ 00751000
*                                                                  0468 00752000
         ST    @15,@AL00001                                        0468 00753000
         L     @15,@CV01706                                        0468 00754000
         LA    @01,@AL00001                                        0468 00755000
         BALR  @14,@15                                             0468 00756000
*           /*********************************************************/ 00757000
*           /*                                                       */ 00758000
*           /* GO THRU ALL RECORDS IN SELECT/EXCLUDE TABLE (SET)     */ 00759000
*           /*                                                       */ 00760000
*           /*********************************************************/ 00761000
*                                                                  0469 00762000
*           DO WHILE GTPRETRN<GTPEOF;                              0469 00763000
         B     @DE00469                                            0469 00764000
@DL00469 DS    0H                                                  0470 00765000
*             IF SESMD=ON&SESELECT=ON THEN                         0470 00766000
         TM    SESMD,B'00000001'                                   0470 00767000
         BNO   @RF00470                                            0470 00768000
         TM    SESELECT,B'01000000'                                0470 00769000
         BNO   @RF00470                                            0470 00770000
*               DO;                                                0471 00771000
*                                                                  0471 00772000
*                 /***************************************************/ 00773000
*                 /*                                                 */ 00774000
*                 /* SELECTED SYSMOD                                 */ 00775000
*                 /*                                                 */ 00776000
*                 /***************************************************/ 00777000
*                                                                  0472 00778000
*                 RECXSCNT=RECXSCNT+1;/* INCREMENT COUNT             */ 00779000
         LH    @01,RECXSCNT                                        0472 00780000
         LA    @01,1(,@01)                                         0472 00781000
         STH   @01,RECXSCNT                                        0472 00782000
*               END;                                               0473 00783000
*             CALL HMASMGTA(HMASMGTP);/* GET NEXT RECORD             */ 00784000
@RF00470 L     @01,CCASETAD(,CCAPTR)                               0474 00785000
         ST    @01,@AL00001                                        0474 00786000
         L     @15,@CV01706                                        0474 00787000
         LA    @01,@AL00001                                        0474 00788000
         BALR  @14,@15                                             0474 00789000
*           END;                                                   0475 00790000
@DE00469 L     @01,CCASETAD(,CCAPTR)                               0475 00791000
         CLI   GTPRETRN(@01),4                                     0475 00792000
         BL    @DL00469                                            0475 00793000
*         END;                                                     0476 00794000
*     END;                                                         0477 00795000
@RF00460 DS    0H                                                  0478 00796000
*   IF RECXMAX<STOPFUNC THEN                                       0478 00797000
@RF00458 L     @15,RECXMAX                                         0478 00798000
         CH    @15,@CH00036                                        0478 00799000
         BNL   @RF00478                                            0478 00800000
*     DO;                                                          0479 00801000
*                                                                  0479 00802000
*       /*************************************************************/ 00803000
*       /*                                                           */ 00804000
*       /* OPEN SMPPTFIN TO THE MODIFICATION CONTROL STATEMENT FILE  */ 00805000
*       /*                                                           */ 00806000
*       /*************************************************************/ 00807000
*                                                                  0480 00808000
*       RECXIOPG->IOPDSID=IOPPTFIN; /* SMPPTFIN DATASET              */ 00809000
         L     @15,RECXIOPG                                        0480 00810000
         MVI   IOPDSID(@15),X'0A'                                  0480 00811000
*       RECXIOPG->IOPFUNCT=IOPOPEN; /* OPEN FUNCTION                 */ 00812000
         MVI   IOPFUNCT(@15),X'00'                                 0481 00813000
*       RECXIOPG->IOPSEQNO=1;       /* MUST BE SET FOR INITIAL OPEN  */ 00814000
         MVC   IOPSEQNO(2,@15),@CH00041                            0482 00815000
*       RECXIOPG->IOPTYPE=''B;      /* TYPE IS N/A                   */ 00816000
         SLR   @14,@14                                             0483 00817000
         STC   @14,IOPTYPE(,@15)                                   0483 00818000
*       RECXIOPG->IOPNAME=' ';      /* NAME IS N/A                   */ 00819000
         MVI   IOPNAME+1(@15),C' '                                 0484 00820000
         MVC   IOPNAME+2(6,@15),IOPNAME+1(@15)                     0484 00821000
         MVI   IOPNAME(@15),C' '                                   0484 00822000
*       RECXIOPG->IOPPTFNT=''B;     /* CLEAR THE REST OF IOP         */ 00823000
         XC    IOPPTFNT(104,@15),IOPPTFNT(@15)                     0485 00824000
*       CALL HMASMIO(RECXIOPG->HMASMIOP);                          0486 00825000
         ST    @15,@AL00001                                        0486 00826000
         L     @15,@CV01703                                        0486 00827000
         LA    @01,@AL00001                                        0486 00828000
         BALR  @14,@15                                             0486 00829000
*       IF IOPRETRN^=IOPGOOD THEN                                  0487 00830000
         L     @15,RECXIOPG                                        0487 00831000
         CLI   IOPRETRN(@15),0                                     0487 00832000
         BE    @RF00487                                            0487 00833000
*         RECXMAX=MAX(RECXMAX,IOPRETRN);/* MAINTAIN RETURN CODE      */ 00834000
         L     @14,RECXMAX                                         0488 00835000
         SLR   @07,@07                                             0488 00836000
         IC    @07,IOPRETRN(,@15)                                  0488 00837000
         CR    @14,@07                                             0488 00838000
         BNL   *+6                                                      00839000
         LR    @14,@07                                             0488 00840000
         ST    @14,RECXMAX                                         0488 00841000
*       ELSE                                                       0489 00842000
*         DO;                                                      0489 00843000
         B     @RC00487                                            0489 00844000
@RF00487 DS    0H                                                  0490 00845000
*           PTFINOPN=ON;            /* SMPPTFIN OPEN                 */ 00846000
*                                                                  0490 00847000
         OI    PTFINOPN,B'00010000'                                0490 00848000
*           /*********************************************************/ 00849000
*           /*                                                       */ 00850000
*           /* SMPPTFIN SUCCESSFULLY OPENED ... EXTRACT FILE SEQUENCE*/ 00851000
*           /* NUMBER OF MODIFICATION CONTROL STATEMENT FILE ...     */ 00852000
*           /* UNLOADED DATASET FILES (IF PRESENT) IMMEDIATELY FOLLOW*/ 00853000
*           /* THIS FILE                                             */ 00854000
*           /*                                                       */ 00855000
*           /*********************************************************/ 00856000
*                                                                  0491 00857000
*           RECXRNXT=RECXIOPG->IOPTPSEQ+1;/* THE ABSOLUTE FILE     0491 00858000
*                                      SEQUENCE NUMBER OF THE NEXT 0491 00859000
*                                      SYSMOD ENCOUNTERED WHICH HAS A   00860000
*                                      FILES KEYWORD IS THE FILE   0491 00861000
*                                      IMMEDIATELY FOLLOWING THE   0491 00862000
*                                      MODIFICATION CONTROL STATEMENT   00863000
*                                      FILE                          */ 00864000
         L     @01,RECXIOPG                                        0491 00865000
         LH    @01,IOPTPSEQ(,@01)                                  0491 00866000
         LA    @01,1(,@01)                                         0491 00867000
         STH   @01,RECXRNXT                                        0491 00868000
*         END;                                                     0492 00869000
*     END;                                                         0493 00870000
@RC00487 DS    0H                                                  0494 00871000
*                                                                  0494 00872000
*   /*****************************************************************/ 00873000
*   /*                                                               */ 00874000
*   /* PROCESS PTFIN DATASET                                         */ 00875000
*   /*                                                               */ 00876000
*   /*****************************************************************/ 00877000
*                                                                  0494 00878000
*   IF RECXMAX<STOPFUNC THEN                                       0494 00879000
@RF00478 L     @15,RECXMAX                                         0494 00880000
         CH    @15,@CH00036                                        0494 00881000
         BNL   @RF00494                                            0494 00882000
*     CALL READ;                    /* READ FIRST RECORD             */ 00883000
         BAL   @14,READ                                            0495 00884000
*   RECXSYSF=ON;                    /* SET TO FLUSH ANYTHING BEFORE     00885000
*                                      1ST SYSMOD HEADER FOUND       */ 00886000
@RF00494 OI    RECXSYSF,B'00010000'                                0496 00887000
*   DO WHILE RECXPROC=GO&RECXPEOF=OFF&RECXMAX<STOPFUNC;            0497 00888000
*                                                                  0497 00889000
         B     @DE00497                                            0497 00890000
@DL00497 DS    0H                                                  0498 00891000
*     /***************************************************************/ 00892000
*     /*                                                             */ 00893000
*     /* AT THIS POINT THERE IS A CARD READ FROM SMPPTFIN IN THE     */ 00894000
*     /* INPUT BUFFER                                                */ 00895000
*     /*                                                             */ 00896000
*     /***************************************************************/ 00897000
*                                                                  0498 00898000
*     CALL CHKBUF;                  /* CHECK FOR THE TYPE OF CARD IN    00899000
*                                      BUFFER                        */ 00900000
         BAL   @14,CHKBUF                                          0498 00901000
*     IF CHKTYPE=SMHEAD THEN                                       0499 00902000
         CLI   CHKTYPE,C'H'                                        0499 00903000
         BNE   @RF00499                                            0499 00904000
*       DO;                                                        0500 00905000
*                                                                  0500 00906000
*         /***********************************************************/ 00907000
*         /*                                                         */ 00908000
*         /* SYSMOD HEADER FOUND ... COMPLETE PROCESSING OF PREVIOUS */ 00909000
*         /*                                                         */ 00910000
*         /***********************************************************/ 00911000
*                                                                  0501 00912000
*         IF GSMHPRT=ON             /* PREVIOUS SYSMOD HEADER PRINTED*/ 00913000
*           THEN                                                   0501 00914000
         LA    @15,GTASM                                           0501 00915000
         TM    GSMHPRT(@15),B'00010000'                            0501 00916000
         BNO   @RF00501                                            0501 00917000
*           CALL SKIP(1);           /* SKIP ONE LINE ON SMPOUT       */ 00918000
         LA    @01,@AL00502                                        0502 00919000
         BAL   @14,SKIP                                            0502 00920000
*         IF RECXSYSM=ON            /* SYSMOD BEING PROCESSED        */ 00921000
*           THEN                                                   0503 00922000
@RF00501 TM    RECXSYSM,B'01000000'                                0503 00923000
         BNO   @RF00503                                            0503 00924000
*           DO;                                                    0504 00925000
*             IF RECXSYSF=OFF       /* ... NOT BEING FLUSHED         */ 00926000
*               THEN                                               0505 00927000
         TM    RECXSYSF,B'00010000'                                0505 00928000
         BNZ   @RF00505                                            0505 00929000
*               CALL HMASMRCC(RECXPARM);/* COMPLETE PROCESSING FOR 0506 00930000
*                                      PREVIOUS SYSMOD               */ 00931000
         L     @15,@CV01710                                        0506 00932000
         LA    @01,@AL00506                                        0506 00933000
         BALR  @14,@15                                             0506 00934000
*             ELSE                                                 0507 00935000
*               CALL HMASMRCF(RECXPARM);/* COMPLETE PROCESSING FOR 0507 00936000
*                                      PREVIOUS FLUSHED SYSMOD       */ 00937000
         B     @RC00505                                            0507 00938000
@RF00505 L     @15,@CV01711                                        0507 00939000
         LA    @01,@AL00507                                        0507 00940000
         BALR  @14,@15                                             0507 00941000
*           END;                                                   0508 00942000
@RC00505 DS    0H                                                  0509 00943000
*         CALL SYSMINIT;            /* RE-INITIALIZE FOR PROCESSING A   00944000
*                                      NEW SYSMOD                    */ 00945000
@RF00503 BAL   @14,SYSMINIT                                        0509 00946000
*         IF RECSEL=ON              /* PROCESSING SELECTED SYSMODS   */ 00947000
*             &RECXSCNT<=0          /* NO MORE SELECTED SYSMODS      */ 00948000
*           THEN                                                   0510 00949000
         L     @15,@PC00001                                        0510 00950000
         TM    RECSEL(@15),B'10000000'                             0510 00951000
         BNO   @RF00510                                            0510 00952000
         LH    @15,RECXSCNT                                        0510 00953000
         LTR   @15,@15                                             0510 00954000
         BP    @RF00510                                            0510 00955000
*           RECXPROC=STOP;          /* ALL SELECTED SYSMODS HAVE BEEN   00956000
*                                      PROCESSED ... STOP RECEIVE    */ 00957000
         NI    RECXPROC,B'01111111'                                0511 00958000
*       END;                                                       0512 00959000
*                                                                  0512 00960000
@RF00510 DS    0H                                                  0513 00961000
*     /***************************************************************/ 00962000
*     /*                                                             */ 00963000
*     /* CHECK FOR USER-EXIT RETURN CODES FROM PREVIOUS READ         */ 00964000
*     /*                                                             */ 00965000
*     /***************************************************************/ 00966000
*                                                                  0513 00967000
*     IF READRTN>=CRPTPTF THEN                                     0513 00968000
@RF00499 L     @15,READRTN                                         0513 00969000
         LA    @14,8                                               0513 00970000
         CR    @15,@14                                             0513 00971000
         BL    @RF00513                                            0513 00972000
*       DO;                                                        0514 00973000
*                                                                  0514 00974000
*         /***********************************************************/ 00975000
*         /*                                                         */ 00976000
*         /* STOP-SYSMOD, STOP-FUNCTION OR STOP-SMP USER-EXIT CODE   */ 00977000
*         /*                                                         */ 00978000
*         /***********************************************************/ 00979000
*                                                                  0515 00980000
*         RECXMAX=MAX(RECXMAX,READRTN);/* USER'S RETURN CODE         */ 00981000
         L     @07,RECXMAX                                         0515 00982000
         CR    @07,@15                                             0515 00983000
         BNL   *+6                                                      00984000
         LR    @07,@15                                             0515 00985000
         ST    @07,RECXMAX                                         0515 00986000
*         GSMUSR=ON;                /* USER EXIT FLUSH OR TERMINATE  */ 00987000
         LA    @07,GTASM                                           0516 00988000
         OI    GSMUSR(@07),B'10000000'                             0516 00989000
*         RECXSYSF=ON;              /* FLUSH CURRENT SYSMOD          */ 00990000
         OI    RECXSYSF,B'00010000'                                0517 00991000
*         IF READRTN>CRPTPTF THEN                                  0518 00992000
         CR    @15,@14                                             0518 00993000
         BNH   @RF00518                                            0518 00994000
*           RECXPROC=STOP;          /* STOP RECEIVE PROCESSING       */ 00995000
         NI    RECXPROC,B'01111111'                                0519 00996000
*       END;                                                       0520 00997000
@RF00518 DS    0H                                                  0521 00998000
*     IF RECXPROC=GO&RECXMAX<STOPFUNC THEN                         0521 00999000
@RF00513 TM    RECXPROC,B'10000000'                                0521 01000000
         BNO   @RF00521                                            0521 01001000
         L     @15,RECXMAX                                         0521 01002000
         CH    @15,@CH00036                                        0521 01003000
         BNL   @RF00521                                            0521 01004000
*       DO;                                                        0522 01005000
*         IF CHKTYPE=SMHEAD THEN                                   0523 01006000
         CLI   CHKTYPE,C'H'                                        0523 01007000
         BNE   @RF00523                                            0523 01008000
*           DO;                                                    0524 01009000
*                                                                  0524 01010000
*             /*******************************************************/ 01011000
*             /*                                                     */ 01012000
*             /* RECORD CONTAINS A SYSMOD HEADER                     */ 01013000
*             /* MODIFICATION-CNTRL-STMT                             */ 01014000
*             /*                                                     */ 01015000
*             /*******************************************************/ 01016000
*                                                                  0525 01017000
*             CALL HDRPROC;         /* PROCESS A NEW SYSMOD          */ 01018000
         BAL   @14,HDRPROC                                         0525 01019000
*           END;                                                   0526 01020000
*         IF CHKTYPE=SMCNTRL        /* NON-HEADER MOD.CNTL.STMT.     */ 01021000
*             &MCSCHECK=ON          /* BODY OF SYSMOD BEING CHECKED  */ 01022000
*           THEN                                                   0527 01023000
@RF00523 CLI   CHKTYPE,C'C'                                        0527 01024000
         BNE   @RF00527                                            0527 01025000
         TM    MCSCHECK,B'00000010'                                0527 01026000
         BNO   @RF00527                                            0527 01027000
*           DO;                                                    0528 01028000
*                                                                  0528 01029000
*             /*******************************************************/ 01030000
*             /*                                                     */ 01031000
*             /* RECORD CONTAINS A MODIFICATION-CONTROL STATEMENT    */ 01032000
*             /* (OTHER THAN A SYSMOD HEADER)                        */ 01033000
*             /*                                                     */ 01034000
*             /*******************************************************/ 01035000
*                                                                  0529 01036000
*             CALL CNTLPROC;        /* PROCESS CNTRL STATEMENT       */ 01037000
         BAL   @14,CNTLPROC                                        0529 01038000
*           END;                                                   0530 01039000
*         IF CHKTYPE=NOTCNTRL       /* NON-MOD.CNTL.STMT.            */ 01040000
*             &MCSCHECK=ON          /* BODY OF SYSMOD BEING CHECKED  */ 01041000
*           THEN                                                   0531 01042000
@RF00527 CLI   CHKTYPE,C'N'                                        0531 01043000
         BNE   @RF00531                                            0531 01044000
         TM    MCSCHECK,B'00000010'                                0531 01045000
         BNO   @RF00531                                            0531 01046000
*           DO;                                                    0532 01047000
*                                                                  0532 01048000
*             /*******************************************************/ 01049000
*             /*                                                     */ 01050000
*             /* RECORD CONTAINS A NON-MODIFICATION-CONTROL STATEMENT*/ 01051000
*             /*                                                     */ 01052000
*             /*******************************************************/ 01053000
*                                                                  0533 01054000
*             CALL TEXTPROC;        /* PROCESS TEXT RECORDS          */ 01055000
         BAL   @14,TEXTPROC                                        0533 01056000
*           END;                                                   0534 01057000
*       END;                                                       0535 01058000
@RF00531 DS    0H                                                  0536 01059000
*     CALL READ;                    /* GET THE NEXT PTFIN CARD       */ 01060000
@RF00521 BAL   @14,READ                                            0536 01061000
*   END;                            /* END OF PTFIN CARD PROCESSING. */ 01062000
@DE00497 TM    RECXPROC,B'10000000'                                0537 01063000
         BNO   @DC00497                                            0537 01064000
         TM    RECXPEOF,B'00100000'                                0537 01065000
         BNZ   @DC00497                                            0537 01066000
         L     @15,RECXMAX                                         0537 01067000
         CH    @15,@CH00036                                        0537 01068000
         BL    @DL00497                                            0537 01069000
@DC00497 DS    0H                                                  0538 01070000
*                                                                  0538 01071000
*   /*****************************************************************/ 01072000
*   /*                                                               */ 01073000
*   /* PTFIN DATASET PROCESSING COMPLETED                            */ 01074000
*   /*                                                               */ 01075000
*   /*****************************************************************/ 01076000
*                                                                  0538 01077000
*   IF RECXSYSM=ON                  /* PROCESSING A SYSMOD ?         */ 01078000
*     THEN                                                         0538 01079000
         TM    RECXSYSM,B'01000000'                                0538 01080000
         BNO   @RF00538                                            0538 01081000
*     DO;                                                          0539 01082000
*                                                                  0539 01083000
*       /*************************************************************/ 01084000
*       /*                                                           */ 01085000
*       /* FINISH UP THE LAST SYSMOD FROM PTFIN                      */ 01086000
*       /*                                                           */ 01087000
*       /*************************************************************/ 01088000
*                                                                  0540 01089000
*       IF GSMHPRT=ON               /* SYSMOD HEADER PRINTED         */ 01090000
*         THEN                                                     0540 01091000
         LA    @15,GTASM                                           0540 01092000
         TM    GSMHPRT(@15),B'00010000'                            0540 01093000
         BNO   @RF00540                                            0540 01094000
*         CALL SKIP(1);             /* SKIP ONE LINE ON SMPOUT       */ 01095000
         LA    @01,@AL00541                                        0541 01096000
         BAL   @14,SKIP                                            0541 01097000
*       IF RECXSYSF=OFF             /* SYSMOD NOT BEING FLUSHED      */ 01098000
*         THEN                                                     0542 01099000
@RF00540 TM    RECXSYSF,B'00010000'                                0542 01100000
         BNZ   @RF00542                                            0542 01101000
*         CALL HMASMRCC(RECXPARM);  /* COMPLETE PROCESSING FOR LAST     01102000
*                                      SYSMOD (NOT FLUSHED)          */ 01103000
         L     @15,@CV01710                                        0543 01104000
         LA    @01,@AL00543                                        0543 01105000
         BALR  @14,@15                                             0543 01106000
*       ELSE                                                       0544 01107000
*         CALL HMASMRCF(RECXPARM);  /* COMPLETE PROCESSING FOR LAST     01108000
*                                      SYSMOD (FLUSHED)              */ 01109000
         B     @RC00542                                            0544 01110000
@RF00542 L     @15,@CV01711                                        0544 01111000
         LA    @01,@AL00544                                        0544 01112000
         BALR  @14,@15                                             0544 01113000
*     END;                                                         0545 01114000
@RC00542 DS    0H                                                  0546 01115000
*   CALL SKIP(3);                   /* SKIP THREE LINES ON SMPOUT    */ 01116000
@RF00538 LA    @01,@AL00546                                        0546 01117000
         BAL   @14,SKIP                                            0546 01118000
*                                                                  0547 01119000
*   /*****************************************************************/ 01120000
*   /*                                                               */ 01121000
*   /* RECEIVE FUNCTION COMPLETION PROCESSING                        */ 01122000
*   /*                                                               */ 01123000
*   /*****************************************************************/ 01124000
*                                                                  0547 01125000
*   IF PTFINOPN=ON THEN                                            0547 01126000
         TM    PTFINOPN,B'00010000'                                0547 01127000
         BNO   @RF00547                                            0547 01128000
*     DO;                                                          0548 01129000
*                                                                  0548 01130000
*       /*************************************************************/ 01131000
*       /*                                                           */ 01132000
*       /* SMPPTFIN WAS OPENED ... CLOSE IT                          */ 01133000
*       /*                                                           */ 01134000
*       /*************************************************************/ 01135000
*                                                                  0549 01136000
*       RECXIOPG->IOPDSID=IOPPTFIN; /* SMPPTFIN DATASET              */ 01137000
         L     @15,RECXIOPG                                        0549 01138000
         MVI   IOPDSID(@15),X'0A'                                  0549 01139000
*       RECXIOPG->IOPFUNCT=IOPCLOSE;/* CLOSE FUNCTION                */ 01140000
         MVI   IOPFUNCT(@15),X'50'                                 0550 01141000
*       RECXIOPG->IOPTYPE=''B;      /* TYPE IS N/A                   */ 01142000
         SLR   @14,@14                                             0551 01143000
         STC   @14,IOPTYPE(,@15)                                   0551 01144000
*       RECXIOPG->IOPNAME=' ';      /* NAME IS N/A                   */ 01145000
         MVI   IOPNAME+1(@15),C' '                                 0552 01146000
         MVC   IOPNAME+2(6,@15),IOPNAME+1(@15)                     0552 01147000
         MVI   IOPNAME(@15),C' '                                   0552 01148000
*       RECXIOPG->IOPPTFNT=''B;     /* CLEAR THE REST OF IOP         */ 01149000
         XC    IOPPTFNT(104,@15),IOPPTFNT(@15)                     0553 01150000
*       CALL HMASMIO(RECXIOPG->HMASMIOP);                          0554 01151000
         ST    @15,@AL00001                                        0554 01152000
         L     @15,@CV01703                                        0554 01153000
         LA    @01,@AL00001                                        0554 01154000
         BALR  @14,@15                                             0554 01155000
*       IF IOPRETRN^=IOPGOOD THEN                                  0555 01156000
         L     @15,RECXIOPG                                        0555 01157000
         CLI   IOPRETRN(@15),0                                     0555 01158000
         BE    @RF00555                                            0555 01159000
*         RECXMAX=MAX(RECXMAX,IOPRETRN);/* MAINTAIN RETURN CODE      */ 01160000
         L     @14,RECXMAX                                         0556 01161000
         SLR   @07,@07                                             0556 01162000
         IC    @07,IOPRETRN(,@15)                                  0556 01163000
         CR    @14,@07                                             0556 01164000
         BNL   *+6                                                      01165000
         LR    @14,@07                                             0556 01166000
         ST    @14,RECXMAX                                         0556 01167000
*       PTFINOPN=OFF;               /* SMPPTFIN CLOSED               */ 01168000
@RF00555 NI    PTFINOPN,B'11101111'                                0557 01169000
*     END;                                                         0558 01170000
*                                                                  0559 01171000
*   /*****************************************************************/ 01172000
*   /*                                                               */ 01173000
*   /* LOAD RELFILE ELEMENTS TO SMPTLIB DASD DATASETS                */ 01174000
*   /*                                                               */ 01175000
*   /*****************************************************************/ 01176000
*                                                                  0559 01177000
*   IF RECXMAX<STOPFUNC&RECXGRFP->GTPWKAD^=0 THEN                  0559 01178000
@RF00547 L     @15,RECXMAX                                         0559 01179000
         CH    @15,@CH00036                                        0559 01180000
         BNL   @RF00559                                            0559 01181000
         L     @01,RECXGRFP                                        0559 01182000
         L     @15,GTPWKAD(,@01)                                   0559 01183000
         LTR   @15,@15                                             0559 01184000
         BZ    @RF00559                                            0559 01185000
*     DO;                                                          0560 01186000
*                                                                  0560 01187000
*       /*************************************************************/ 01188000
*       /*                                                           */ 01189000
*       /* THERE WERE RELFILE ELEMENTS PRESENT ... LOAD THEM TO THE  */ 01190000
*       /* SMPTLIB DATASETS                                          */ 01191000
*       /*                                                           */ 01192000
*       /*************************************************************/ 01193000
*                                                                  0561 01194000
*       CALL HMASMRCD(RECXPARM);                                   0561 01195000
         L     @15,@CV01713                                        0561 01196000
         LA    @01,@AL00561                                        0561 01197000
         BALR  @14,@15                                             0561 01198000
*       RECXMAX=MAX(RECXMAX,RECXLAST);/* SAVE HMASMRCD RETURN CODE   */ 01199000
         L     @15,RECXMAX                                         0562 01200000
         L     @14,RECXLAST                                        0562 01201000
         CR    @15,@14                                             0562 01202000
         BNL   *+6                                                      01203000
         LR    @15,@14                                             0562 01204000
         ST    @15,RECXMAX                                         0562 01205000
*     END;                                                         0563 01206000
*   IF RECSEL=ON THEN                                              0564 01207000
@RF00559 L     @15,@PC00001                                        0564 01208000
         TM    RECSEL(@15),B'10000000'                             0564 01209000
         BNO   @RF00564                                            0564 01210000
*     DO;                                                          0565 01211000
*                                                                  0565 01212000
*       /*************************************************************/ 01213000
*       /*                                                           */ 01214000
*       /* SELECT SPECIFIED ... ISSUE "HMA369I _______ SELECTED NOT  */ 01215000
*       /* FOUND ON SMPPTFIN" FOR ANY SYSMODS IN THE SELECT LIST     */ 01216000
*       /* WHICH WERE NOT ENCOUNTERED IN RECEIVE PROCESSING          */ 01217000
*       /*                                                           */ 01218000
*       /*************************************************************/ 01219000
*                                                                  0566 01220000
*       RESPECIFY                                                  0566 01221000
*         HMASMGTP BASED(CCASETAD); /* SELECT/EXCLUDE GTP            */ 01222000
*       GTPFUNCT=GTPOPENN;          /* OPEN SELECT/EXCLUDE GTA FILE  */ 01223000
         L     @15,CCASETAD(,CCAPTR)                               0567 01224000
         MVI   GTPFUNCT(@15),X'01'                                 0567 01225000
*       GTPBUFAD=ADDR(HMASMSET);    /* SET UP POINTER TO SET STORE   */ 01226000
         LA    @14,HMASMSET                                        0568 01227000
         ST    @14,GTPBUFAD(,@15)                                  0568 01228000
*       CALL HMASMGTA(HMASMGTP);                                   0569 01229000
         ST    @15,@AL00001                                        0569 01230000
         L     @15,@CV01706                                        0569 01231000
         LA    @01,@AL00001                                        0569 01232000
         BALR  @14,@15                                             0569 01233000
*       GTPFUNCT=GTPGETN;           /* SET FUNCTION TO GET RECORDS 0570 01234000
*                                      SEQUENTIALLY FROM SET         */ 01235000
         L     @15,CCASETAD(,CCAPTR)                               0570 01236000
         MVI   GTPFUNCT(@15),X'08'                                 0570 01237000
*       CALL HMASMGTA(HMASMGTP);    /* GET FIRST RECORD              */ 01238000
*                                                                  0571 01239000
         ST    @15,@AL00001                                        0571 01240000
         L     @15,@CV01706                                        0571 01241000
         LA    @01,@AL00001                                        0571 01242000
         BALR  @14,@15                                             0571 01243000
*       /*************************************************************/ 01244000
*       /*                                                           */ 01245000
*       /* GO THRU ALL RECORDS IN SELECT/EXCLUDE TABLE (SET)         */ 01246000
*       /*                                                           */ 01247000
*       /*************************************************************/ 01248000
*                                                                  0572 01249000
*       DO WHILE GTPRETRN<GTPEOF;                                  0572 01250000
         B     @DE00572                                            0572 01251000
@DL00572 DS    0H                                                  0573 01252000
*         IF SESMD=ON&SESELECT=ON THEN                             0573 01253000
         TM    SESMD,B'00000001'                                   0573 01254000
         BNO   @RF00573                                            0573 01255000
         TM    SESELECT,B'01000000'                                0573 01256000
         BNO   @RF00573                                            0573 01257000
*           DO;                                                    0574 01258000
*                                                                  0574 01259000
*             /*******************************************************/ 01260000
*             /*                                                     */ 01261000
*             /* SELECTED SYSMOD                                     */ 01262000
*             /*                                                     */ 01263000
*             /*******************************************************/ 01264000
*                                                                  0575 01265000
*             IF SEFOUND^=ON THEN   /* NOT FOUND ON PTFIN ?          */ 01266000
         TM    SEFOUND,B'00000001'                                 0575 01267000
         BO    @RF00575                                            0575 01268000
*               DO;                                                0576 01269000
*                                                                  0576 01270000
*                 /***************************************************/ 01271000
*                 /*                                                 */ 01272000
*                 /* NOT FOUND ON PTFIN                              */ 01273000
*                 /*                                                 */ 01274000
*                 /***************************************************/ 01275000
*                                                                  0577 01276000
*                 CALL ADDNFND(SESMDNO);/* ADD SYSMOD-ID TO RECEIVE     01277000
*                                      SUMMARY GTA FILE              */ 01278000
         LA    @01,@AL00577                                        0577 01279000
         BAL   @14,ADDNFND                                         0577 01280000
*                 MGPTYPE=MGPERR;   /* WARNING MESSAGE               */ 01281000
         MVI   MGPTYPE,X'03'                                       0578 01282000
*                 MSGSMDNM=SESMDNO; /* SYSMOD NUMBER                 */ 01283000
         MVC   MSGSMDNM(7),SESMDNO                                 0579 01284000
*                 CALL ERRMSG(HMA369I,NOPART,NOPART);              0580 01285000
         LA    @01,@AL00580                                        0580 01286000
         BAL   @14,ERRMSG                                          0580 01287000
*               END;                                               0581 01288000
*           END;                                                   0582 01289000
@RF00575 DS    0H                                                  0583 01290000
*         CALL HMASMGTA(HMASMGTP);  /* GET NEXT RECORD               */ 01291000
@RF00573 L     @01,CCASETAD(,CCAPTR)                               0583 01292000
         ST    @01,@AL00001                                        0583 01293000
         L     @15,@CV01706                                        0583 01294000
         LA    @01,@AL00001                                        0583 01295000
         BALR  @14,@15                                             0583 01296000
*       END;                                                       0584 01297000
@DE00572 L     @01,CCASETAD(,CCAPTR)                               0584 01298000
         CLI   GTPRETRN(@01),4                                     0584 01299000
         BL    @DL00572                                            0584 01300000
*     END;                                                         0585 01301000
*                                                                  0586 01302000
*   /*****************************************************************/ 01303000
*   /*                                                               */ 01304000
*   /* ISSUE HMA248I IF NO SYSMODS WERE RECEIVED                     */ 01305000
*   /*                                                               */ 01306000
*   /*****************************************************************/ 01307000
*                                                                  0586 01308000
*   IF RECXCNT=0                    /* NO SYSMODS SUCCESSFULLY RCVD  */ 01309000
*     THEN                                                         0586 01310000
@RF00564 LH    @15,RECXCNT                                         0586 01311000
         LTR   @15,@15                                             0586 01312000
         BNZ   @RF00586                                            0586 01313000
*     DO;                                                          0587 01314000
*       MGPTYPE=MGPWARN;            /* WARNING MESSAGE               */ 01315000
         MVI   MGPTYPE,X'02'                                       0588 01316000
*       CALL ERRMSG(HMA248I,NOPART,NOPART);                        0589 01317000
         LA    @01,@AL00589                                        0589 01318000
         BAL   @14,ERRMSG                                          0589 01319000
*     END;                                                         0590 01320000
*                                                                  0590 01321000
*   /*****************************************************************/ 01322000
*   /*                                                               */ 01323000
*   /* RECEIVE SUMMARY REPORT AND UPDATE OF PTS SYSTEM ENTRY         */ 01324000
*   /*                                                               */ 01325000
*   /*****************************************************************/ 01326000
*                                                                  0591 01327000
*   CALL HMASMRCL(RECXPARM);                                       0591 01328000
*                                                                  0591 01329000
@RF00586 L     @15,@CV01712                                        0591 01330000
         LA    @01,@AL00591                                        0591 01331000
         BALR  @14,@15                                             0591 01332000
*   /*****************************************************************/ 01333000
*   /*                                                               */ 01334000
*   /* CLEANUP STORAGE ALLOCATED FOR RECEIVE PROCESSING              */ 01335000
*   /*                                                               */ 01336000
*   /*****************************************************************/ 01337000
*                                                                  0592 01338000
*   IF RECXMCB^=0 THEN                                             0592 01339000
         L     @15,RECXMCB                                         0592 01340000
         LTR   @15,@15                                             0592 01341000
         BZ    @RF00592                                            0592 01342000
*     DO;                                                          0593 01343000
*                                                                  0593 01344000
*       /*************************************************************/ 01345000
*       /*                                                           */ 01346000
*       /* FREE STORAGE ALLOCATED TO MCB CONTROL BLOCK               */ 01347000
*       /*                                                           */ 01348000
*       /*************************************************************/ 01349000
*                                                                  0594 01350000
*       SPLPMAD=RECXMCB;            /* PTR TO STORAGE ALLOCATED      */ 01351000
         ST    @15,SPLPMAD                                         0594 01352000
*       SPLFUNCT=SPLFMIOP;          /* FREEMAIN IOP FUNCTION         */ 01353000
         MVI   SPLFUNCT,X'04'                                      0595 01354000
*       CALL HMASMSUB(HMASMSPL);                                   0596 01355000
         L     @15,@CV01709                                        0596 01356000
         LA    @01,@AL00596                                        0596 01357000
         BALR  @14,@15                                             0596 01358000
*     END;                                                         0597 01359000
*   IF RECXIOPP^=0 THEN                                            0598 01360000
@RF00592 L     @15,RECXIOPP                                        0598 01361000
         LTR   @15,@15                                             0598 01362000
         BZ    @RF00598                                            0598 01363000
*     DO;                                                          0599 01364000
*                                                                  0599 01365000
*       /*************************************************************/ 01366000
*       /*                                                           */ 01367000
*       /* FREE STORAGE ALLOCATED FOR PTS SYSMOD IOP                 */ 01368000
*       /*                                                           */ 01369000
*       /*************************************************************/ 01370000
*                                                                  0600 01371000
*       SPLPMAD=RECXIOPP;           /* PTR TO STORAGE ALLOCATED      */ 01372000
         ST    @15,SPLPMAD                                         0600 01373000
*       SPLFUNCT=SPLFMIOP;          /* FREEMAIN IOP FUNCTION         */ 01374000
         MVI   SPLFUNCT,X'04'                                      0601 01375000
*       CALL HMASMSUB(HMASMSPL);                                   0602 01376000
         L     @15,@CV01709                                        0602 01377000
         LA    @01,@AL00602                                        0602 01378000
         BALR  @14,@15                                             0602 01379000
*     END;                                                         0603 01380000
*   IF RECXIOPT^=0 THEN                                            0604 01381000
@RF00598 L     @15,RECXIOPT                                        0604 01382000
         LTR   @15,@15                                             0604 01383000
         BZ    @RF00604                                            0604 01384000
*     DO;                                                          0605 01385000
*                                                                  0605 01386000
*       /*************************************************************/ 01387000
*       /*                                                           */ 01388000
*       /* FREE STORAGE ALLOCATED FOR PTS MCS IOP                    */ 01389000
*       /*                                                           */ 01390000
*       /*************************************************************/ 01391000
*                                                                  0606 01392000
*       SPLPMAD=RECXIOPT;           /* PTR TO STORAGE ALLOCATED      */ 01393000
         ST    @15,SPLPMAD                                         0606 01394000
*       SPLFUNCT=SPLFMIOP;          /* FREEMAIN IOP FUNCTION         */ 01395000
         MVI   SPLFUNCT,X'04'                                      0607 01396000
*       CALL HMASMSUB(HMASMSPL);                                   0608 01397000
         L     @15,@CV01709                                        0608 01398000
         LA    @01,@AL00608                                        0608 01399000
         BALR  @14,@15                                             0608 01400000
*     END;                                                         0609 01401000
*   RESPECIFY                                                      0610 01402000
*     HMASMGTP BASED(RECXGSMP);     /* SUMMARY GTP                   */ 01403000
@RF00604 DS    0H                                                  0611 01404000
*   IF GTPWKAD^=0 THEN                                             0611 01405000
         L     @15,RECXGSMP                                        0611 01406000
         L     @14,GTPWKAD(,@15)                                   0611 01407000
         LTR   @14,@14                                             0611 01408000
         BZ    @RF00611                                            0611 01409000
*     DO;                                                          0612 01410000
*                                                                  0612 01411000
*       /*************************************************************/ 01412000
*       /*                                                           */ 01413000
*       /* FREE SUMMARY GTA FILE                                     */ 01414000
*       /*                                                           */ 01415000
*       /*************************************************************/ 01416000
*                                                                  0613 01417000
*       GTPFUNCT=GTPFREE;           /* FREE FUNCTION                 */ 01418000
         MVI   GTPFUNCT(@15),X'0A'                                 0613 01419000
*       CALL HMASMGTA(HMASMGTP);    /* FREE IT                       */ 01420000
         ST    @15,@AL00001                                        0614 01421000
         L     @15,@CV01706                                        0614 01422000
         LA    @01,@AL00001                                        0614 01423000
         BALR  @14,@15                                             0614 01424000
*     END;                                                         0615 01425000
*   RESPECIFY                                                      0616 01426000
*     HMASMGTP BASED(RECXGSRP);     /* SRELFMID GTP                  */ 01427000
@RF00611 DS    0H                                                  0617 01428000
*   IF GTPWKAD^=0 THEN                                             0617 01429000
         L     @15,RECXGSRP                                        0617 01430000
         L     @14,GTPWKAD(,@15)                                   0617 01431000
         LTR   @14,@14                                             0617 01432000
         BZ    @RF00617                                            0617 01433000
*     DO;                                                          0618 01434000
*                                                                  0618 01435000
*       /*************************************************************/ 01436000
*       /*                                                           */ 01437000
*       /* FREE SRELFMID GTA FILE                                    */ 01438000
*       /*                                                           */ 01439000
*       /*************************************************************/ 01440000
*                                                                  0619 01441000
*       GTPFUNCT=GTPFREE;           /* FREE FUNCTION                 */ 01442000
         MVI   GTPFUNCT(@15),X'0A'                                 0619 01443000
*       CALL HMASMGTA(HMASMGTP);    /* FREE IT                       */ 01444000
         ST    @15,@AL00001                                        0620 01445000
         L     @15,@CV01706                                        0620 01446000
         LA    @01,@AL00001                                        0620 01447000
         BALR  @14,@15                                             0620 01448000
*     END;                                                         0621 01449000
*   RESPECIFY                                                      0622 01450000
*     HMASMGTP BASED(RECXGRFP);     /* RELFILE GTP                   */ 01451000
@RF00617 DS    0H                                                  0623 01452000
*   IF GTPWKAD^=0 THEN                                             0623 01453000
         L     @15,RECXGRFP                                        0623 01454000
         L     @14,GTPWKAD(,@15)                                   0623 01455000
         LTR   @14,@14                                             0623 01456000
         BZ    @RF00623                                            0623 01457000
*     DO;                                                          0624 01458000
*                                                                  0624 01459000
*       /*************************************************************/ 01460000
*       /*                                                           */ 01461000
*       /* FREE RELFILE GTA FILE                                     */ 01462000
*       /*                                                           */ 01463000
*       /*************************************************************/ 01464000
*                                                                  0625 01465000
*       GTPFUNCT=GTPFREE;           /* FREE FUNCTION                 */ 01466000
         MVI   GTPFUNCT(@15),X'0A'                                 0625 01467000
*       CALL HMASMGTA(HMASMGTP);    /* FREE IT                       */ 01468000
         ST    @15,@AL00001                                        0626 01469000
         L     @15,@CV01706                                        0626 01470000
         LA    @01,@AL00001                                        0626 01471000
         BALR  @14,@15                                             0626 01472000
*     END;                                                         0627 01473000
*   RESPECIFY                                                      0628 01474000
*     HMASMGTP BASED(RECXGPSP);     /* PTS SYSTEM ENTRY GTP          */ 01475000
@RF00623 DS    0H                                                  0629 01476000
*   IF GTPWKAD^=0 THEN                                             0629 01477000
         L     @15,RECXGPSP                                        0629 01478000
         L     @14,GTPWKAD(,@15)                                   0629 01479000
         LTR   @14,@14                                             0629 01480000
         BZ    @RF00629                                            0629 01481000
*     DO;                                                          0630 01482000
*                                                                  0630 01483000
*       /*************************************************************/ 01484000
*       /*                                                           */ 01485000
*       /* FREE PTS SYSTEM ENTRY GTA FILE                            */ 01486000
*       /*                                                           */ 01487000
*       /*************************************************************/ 01488000
*                                                                  0631 01489000
*       GTPFUNCT=GTPFREE;           /* FREE FUNCTION                 */ 01490000
         MVI   GTPFUNCT(@15),X'0A'                                 0631 01491000
*       CALL HMASMGTA(HMASMGTP);    /* FREE IT                       */ 01492000
         ST    @15,@AL00001                                        0632 01493000
         L     @15,@CV01706                                        0632 01494000
         LA    @01,@AL00001                                        0632 01495000
         BALR  @14,@15                                             0632 01496000
*     END;                                                         0633 01497000
*                                                                  0633 01498000
*   /*****************************************************************/ 01499000
*   /*                                                               */ 01500000
*   /* RESTORE CCA IOP'S IOPBUFAD                                    */ 01501000
*   /*                                                               */ 01502000
*   /*****************************************************************/ 01503000
*                                                                  0634 01504000
*   CCAIOPTR->IOPBUFAD=SAVBUFAD;                                   0634 01505000
@RF00629 L     @01,CCAIOPTR(,CCAPTR)                               0634 01506000
         MVC   IOPBUFAD(4,@01),SAVBUFAD                            0634 01507000
*   RETURN CODE(RECXMAX);           /* RETURN TO THE CALLER          */ 01508000
         L     @15,RECXMAX                                         0635 01509000
         L     @13,4(,@13)                                         0635 01510000
         L     @14,12(,@13)                                        0635 01511000
         LM    @00,@12,20(@13)                                     0635 01512000
         BR    @14                                                 0635 01513000
*                                                                  0636 01514000
*/********************************************************************/ 01515000
*/*                                                                  */ 01516000
*/*    SYSMINIT - INITIALIZE DATA AREAS FOR PROCESSING A NEW SYSMOD  */ 01517000
*/*                                                                  */ 01518000
*/********************************************************************/ 01519000
*                                                                  0636 01520000
*SYSMINIT:                                                         0636 01521000
*   PROC;                                                          0636 01522000
@EL00001 L     @13,4(,@13)                                         0636 01523000
@EF00001 DS    0H                                                  0636 01524000
@ER00001 LM    @14,@12,12(@13)                                     0636 01525000
         BR    @14                                                 0636 01526000
SYSMINIT STM   @14,@12,@SA00002                                    0636 01527000
*                                                                  0637 01528000
*   /*****************************************************************/ 01529000
*   /*                                                               */ 01530000
*   /* RE-INITIALIZE PROCESS FLAGS FOR PROCESSING A NEW SYSMOD       */ 01531000
*   /*                                                               */ 01532000
*   /*****************************************************************/ 01533000
*                                                                  0637 01534000
*   RECXFLG2=ALLOFF;                                               0637 01535000
         MVI   RECXFLG2,B'00000000'                                0637 01536000
*   RECXFLG3=ALLOFF;                                               0638 01537000
         MVI   RECXFLG3,B'00000000'                                0638 01538000
*   RECXSYSM=OFF;                   /* CLEAR PROCESSING SYSMD      0639 01539000
*                                      INDICATOR                     */ 01540000
*   RECXSYSF=OFF;                   /* CLEAR FLUSH INDICATOR         */ 01541000
         NI    RECXSYSM,B'10101111'                                0640 01542000
*   RECXMNDX=0;                     /* COUNT OF ELEMENTS IN CURRENT     01543000
*                                      SYSMOD                        */ 01544000
         SLR   @15,@15                                             0641 01545000
         ST    @15,RECXMNDX                                        0641 01546000
*   REL4VER=OFF;                    /* CLEAR VALID REL4 ++VER FOUND  */ 01547000
*                                                                  0642 01548000
         NI    REL4VER,B'11011111'                                 0642 01549000
*   /*****************************************************************/ 01550000
*   /*                                                               */ 01551000
*   /* INITIALIZE GTA SUMMARY FILE RECORD FOR THIS NEW SYSMOD        */ 01552000
*   /*                                                               */ 01553000
*   /*****************************************************************/ 01554000
*                                                                  0643 01555000
*   GSMREC=''B;                     /* CLEAR RECORD                  */ 01556000
         LA    @15,GTASM                                           0643 01557000
         XC    GSMREC(18,@15),GSMREC(@15)                          0643 01558000
*   GSMFMID=NULLPTF#;               /* BLANK FMID FIELD              */ 01559000
         MVC   GSMFMID(7,@15),@CC01733                             0644 01560000
*   GSMS#=NULLPTF#;                 /* BLANK SYSMOD NUMBER           */ 01561000
*                                                                  0645 01562000
         MVC   GSMS#(7,@15),@CC01733                               0645 01563000
*   /*****************************************************************/ 01564000
*   /*                                                               */ 01565000
*   /* FREE CURRENT GTA SREL/FMID FILE AND RE-INITIALIZE             */ 01566000
*   /*                                                               */ 01567000
*   /*****************************************************************/ 01568000
*                                                                  0646 01569000
*   RESPECIFY                                                      0646 01570000
*     HMASMGTP BASED(RECXGSRP);     /* SRELFMID GTP                  */ 01571000
*   GTPFUNCT=GTPFREE;               /* FREE CURRENT SRELFMID FILE    */ 01572000
         L     @15,RECXGSRP                                        0647 01573000
         MVI   GTPFUNCT(@15),X'0A'                                 0647 01574000
*   CALL HMASMGTA(HMASMGTP);                                       0648 01575000
         ST    @15,@AL00001                                        0648 01576000
         L     @15,@CV01706                                        0648 01577000
         LA    @01,@AL00001                                        0648 01578000
         BALR  @14,@15                                             0648 01579000
*   HMASMGTP=''B;                   /* RE-INITIALIZE GTP             */ 01580000
         L     @15,RECXGSRP                                        0649 01581000
         XC    HMASMGTP(28,@15),HMASMGTP(@15)                      0649 01582000
*   GTPRCDLN=LENGTH(GSRREC);        /* RECORD LENGTH                 */ 01583000
         LA    @14,11                                              0650 01584000
         STH   @14,GTPRCDLN(,@15)                                  0650 01585000
*   GTPKEYLN=LENGTH(GSRKEY);        /* KEY LENGTH                    */ 01586000
         STH   @14,GTPKEYLN(,@15)                                  0651 01587000
*   GTPBUFAD=ADDR(GTASR);           /* BUFFER                        */ 01588000
         LA    @14,GTASR                                           0652 01589000
         ST    @14,GTPBUFAD(,@15)                                  0652 01590000
*                                                                  0653 01591000
*   /*****************************************************************/ 01592000
*   /*                                                               */ 01593000
*   /* INITIALIZE IOP FOR PTS SYSMOD ENTRY                           */ 01594000
*   /*                                                               */ 01595000
*   /*****************************************************************/ 01596000
*                                                                  0653 01597000
*   RECXIOPP->IOPNAME=' ';          /* BLANK ENTRY NAME              */ 01598000
         L     @15,RECXIOPP                                        0653 01599000
         MVI   IOPNAME+1(@15),C' '                                 0653 01600000
         MVC   IOPNAME+2(6,@15),IOPNAME+1(@15)                     0653 01601000
         MVI   IOPNAME(@15),C' '                                   0653 01602000
*   RECXIOPP->IOPPTFNT=''B;         /* CLEAR IOPUDATA PORTION        */ 01603000
         XC    IOPPTFNT(104,@15),IOPPTFNT(@15)                     0654 01604000
*   RECXIOPP->IOPNTLVL=IOPPTFLC;    /* SET ENTRY LEVEL               */ 01605000
         MVI   IOPNTLVL(@15),X'02'                                 0655 01606000
*   RECXIOPP->IOPPTPFX=RECDSPFX;    /* TLIB DATASET NAME PREFIX      */ 01607000
         MVC   IOPPTPFX(26,@15),RECDSPFX                           0656 01608000
*   RECXIOPP->IOPFUNCT=IOPOPEN;     /* CHECKED BY HMASMRCF           */ 01609000
         MVI   IOPFUNCT(@15),X'00'                                 0657 01610000
*   RECXIOPP->IOPRETRN=ZERO;        /* CLEAR RETURN CODE FIELD       */ 01611000
         MVI   IOPRETRN(@15),X'00'                                 0658 01612000
*   RECXIOPP->IOPPTFND(1)=IOPEOLST; /* SET END-OF-LIST               */ 01613000
*                                                                  0659 01614000
         MVI   IOPPTFND(@15),X'FF'                                 0659 01615000
*   /*****************************************************************/ 01616000
*   /*                                                               */ 01617000
*   /* INITIALIZE IOP FOR PTS MCS ENTRY                              */ 01618000
*   /*                                                               */ 01619000
*   /*****************************************************************/ 01620000
*                                                                  0660 01621000
*   RECXIOPT->IOPNAME=' ';          /* BLANK ENTRY NAME              */ 01622000
         L     @15,RECXIOPT                                        0660 01623000
         MVI   IOPNAME+1(@15),C' '                                 0660 01624000
         MVC   IOPNAME+2(6,@15),IOPNAME+1(@15)                     0660 01625000
         MVI   IOPNAME(@15),C' '                                   0660 01626000
*   RECXIOPT->IOPNAM17=UNKNOWN#;    /* SET TO UNKNOWN SYSMOD         */ 01627000
         MVC   IOPNAM17(7,@15),@CC01735                            0661 01628000
*   RECXIOPT->IOPPTFNT=''B;         /* CLEAR IOPUDATA PORTION        */ 01629000
         XC    IOPPTFNT(104,@15),IOPPTFNT(@15)                     0662 01630000
*   RECXIOPT->IOPFUNCT=IOPOPEN;     /* CHECKED BY HMASMRCF           */ 01631000
         MVI   IOPFUNCT(@15),X'00'                                 0663 01632000
*   RECXIOPT->IOPRETRN=ZERO;        /* CLEAR RETURN CODE FIELD       */ 01633000
         MVI   IOPRETRN(@15),X'00'                                 0664 01634000
*   RECXIOPT->IOPNTLVL=IOPPTFLC;    /* SET ENTRY LEVEL               */ 01635000
         MVI   IOPNTLVL(@15),X'02'                                 0665 01636000
*   RETURN;                                                        0666 01637000
@EL00002 DS    0H                                                  0666 01638000
@EF00002 DS    0H                                                  0666 01639000
@ER00002 LM    @14,@12,@SA00002                                    0666 01640000
         BR    @14                                                 0666 01641000
*   END SYSMINIT;                                                  0667 01642000
*                                                                  0668 01643000
*/********************************************************************/ 01644000
*/*                                                                  */ 01645000
*/*    HDRPROC - PROCESS HEADER SYSTEM MODIFICATION CONTROL          */ 01646000
*/*              STATEMENTS                                          */ 01647000
*/*                                                                  */ 01648000
*/*        1. CALL HMASMMPD TO PARSE THE SYSMOD HEADER STATEMENT     */ 01649000
*/*           AND SET UP FIELDS IN THE PTS PTF ENTRY IOP FOR THIS    */ 01650000
*/*           SYSMOD.                                                */ 01651000
*/*                                                                  */ 01652000
*/*        2. CHECK SELECT/EXCLUDE CRITERIA USING THE SELECT/EXCLUDE */ 01653000
*/*           LIST.                                                  */ 01654000
*/*                                                                  */ 01655000
*/*        3. ATTEMPT TO LOCATE A SYSMOD-TYPE ENTRY FOR THIS SYSMOD  */ 01656000
*/*           ON THE SMPPTS DATASET.                                 */ 01657000
*/*           - IF ONE IS FOUND AND NOT "IN ERROR", FLUSH THIS       */ 01658000
*/*             SYSMOD.                                              */ 01659000
*/*                                                                  */ 01660000
*/********************************************************************/ 01661000
*                                                                  0668 01662000
*HDRPROC:                                                          0668 01663000
*   PROC;                                                          0668 01664000
HDRPROC  STM   @14,@12,@SA00003                                    0668 01665000
*   RECXSYSM=ON;                    /* SET PROCESSING SYSMOD       0669 01666000
*                                      INDICATOR                     */ 01667000
         OI    RECXSYSM,B'01000000'                                0669 01668000
*   MCSCHECK=ON;                    /* RESTORE MOD.CNTL.STMT. CHECKS */ 01669000
*   DUP347=OFF;                     /* CLEAR HMA347I MSG ISSUED FLAG */ 01670000
         OI    MCSCHECK,B'00000010'                                0671 01671000
         NI    DUP347,B'11110111'                                  0671 01672000
*   GSMS#=CHKSMDID;                 /* INITIALIZE SYSMOD-ID          */ 01673000
         LA    @15,GTASM                                           0672 01674000
         MVC   GSMS#(7,@15),CHKSMDID                               0672 01675000
*   IF CHKSMD#=YES                  /* SYSMOD # FOUND BY CHKBUF PROC */ 01676000
*     THEN                                                         0673 01677000
         CLI   CHKSMD#,C'Y'                                        0673 01678000
         BNE   @RF00673                                            0673 01679000
*     DO;                                                          0674 01680000
*                                                                  0674 01681000
*       /*************************************************************/ 01682000
*       /*                                                           */ 01683000
*       /* DETERMINE WHETHER THE SYSMOD SHOULD BE EXCLUDED           */ 01684000
*       /*                                                           */ 01685000
*       /*************************************************************/ 01686000
*                                                                  0675 01687000
*       CALL SECHK;                 /* SEE IF IT SHOULD BE EXCLUDED  */ 01688000
         BAL   @14,SECHK                                           0675 01689000
*       IF GSMEXCL=OFF              /* SYSMOD NOT EXCLUDED           */ 01690000
*         THEN                                                     0676 01691000
         LA    @15,GTASM                                           0676 01692000
         TM    GSMEXCL(@15),B'00010000'                            0676 01693000
         BNZ   @RF00676                                            0676 01694000
*         CALL PTSCHK(GSMS#);       /* SEE IF IT IS ALREADY RECVD.   */ 01695000
         ST    @15,@AL00001                                        0677 01696000
         LA    @01,@AL00001                                        0677 01697000
         BAL   @14,PTSCHK                                          0677 01698000
*     END;                                                         0678 01699000
@RF00676 DS    0H                                                  0679 01700000
*   IF(GSMEXCL=OFF                  /* SYSMOD NOT EXCLUDED (YET)     */ 01701000
*       &GSMRCVD=OFF)               /* SYSMOD NOT ALREADY RECEIVED   */ 01702000
*       |GSMSEL=ON                  /* SYSMOD IS SELECTED            */ 01703000
*     THEN                                                         0679 01704000
@RF00673 LA    @15,GTASM                                           0679 01705000
         TM    GSMEXCL(@15),B'00110000'                            0679 01706000
         BZ    @RT00679                                            0679 01707000
         LA    @15,GTASM                                           0679 01708000
         TM    GSMSEL(@15),B'00010000'                             0679 01709000
         BNO   @RF00679                                            0679 01710000
@RT00679 DS    0H                                                  0680 01711000
*     DO;                                                          0680 01712000
*                                                                  0680 01713000
*       /*************************************************************/ 01714000
*       /*                                                           */ 01715000
*       /* WRITE THE FIRST RECORD FOR THIS SYSMOD (IN CRPBUFF) TO    */ 01716000
*       /* SMPPTS USING THE "DUMMY" PTS MCS ENTRY INITIALIZED BY     */ 01717000
*       /* SYSMINIT.... NOTE THAT THE "DUMMY" PTS MCS ENTRY IOP WILL */ 01718000
*       /* BE TURNED INTO A "REAL" IOP IF HMASMMPD IS ABLE TO        */ 01719000
*       /* SUCCESSFULLY PARSE THIS STATEMENT.                        */ 01720000
*       /*                                                           */ 01721000
*       /*************************************************************/ 01722000
*                                                                  0681 01723000
*       CALL SKIP(3);               /* SKIP THREE LINES ON SMPOUT TO    01724000
*                                      DELIMIT A SYSMOD              */ 01725000
         LA    @01,@AL00681                                        0681 01726000
         BAL   @14,SKIP                                            0681 01727000
*       CALL WRITEPTS(SMCNTRL);     /* WRITE TO SMPPTS (MCS ENTRY) 0682 01728000
*                                      AND AND SMPOUT.               */ 01729000
         LA    @01,@AL00682                                        0682 01730000
         BAL   @14,WRITEPTS                                        0682 01731000
*       GSMHPRT=ON;                 /* SYSMOD HEADER PRINTED         */ 01732000
         LA    @15,GTASM                                           0683 01733000
         OI    GSMHPRT(@15),B'00010000'                            0683 01734000
*     END;                                                         0684 01735000
*                                                                  0684 01736000
*   /*****************************************************************/ 01737000
*   /*                                                               */ 01738000
*   /* SET UP HMASMCRP PARAMETER LIST AND CALL HMASMMPD TO PARSE THE */ 01739000
*   /* HEADER STATEMENT.                                             */ 01740000
*   /*                                                               */ 01741000
*   /*****************************************************************/ 01742000
*                                                                  0685 01743000
*   CRPBFPRM=OFF;                   /* BUFFER NOT PRIMED FOR NEXT  0685 01744000
*                                      READ                          */ 01745000
@RF00679 NI    CRPBFPRM,B'01111111'                                0685 01746000
*   IF RECXSYSF=ON                  /* FLUSHING SYSMOD               */ 01747000
*       |GSMEXCL=ON                 /* SYSMOD EXCLUDED               */ 01748000
*     THEN                                                         0686 01749000
         TM    RECXSYSF,B'00010000'                                0686 01750000
         BO    @RT00686                                            0686 01751000
         LA    @15,GTASM                                           0686 01752000
         TM    GSMEXCL(@15),B'00010000'                            0686 01753000
         BNO   @RF00686                                            0686 01754000
@RT00686 DS    0H                                                  0687 01755000
*     DO;                                                          0687 01756000
*       CRPPTS=OFF;                 /* DO NOT WRITE TO SMPPTS        */ 01757000
*       CRPPRINT=OFF;               /* DO NOT WRITE TO SMPOUT        */ 01758000
         NI    CRPPTS,B'11010111'                                  0689 01759000
*     END;                                                         0690 01760000
*   ELSE                                                           0691 01761000
*     DO;                                                          0691 01762000
         B     @RC00686                                            0691 01763000
@RF00686 DS    0H                                                  0692 01764000
*       CRPPTS=ON;                  /* WRITE TO SMPPTS               */ 01765000
*       CRPPRINT=ON;                /* WRITE TO SMPOUT               */ 01766000
         OI    CRPPTS,B'00101000'                                  0693 01767000
*     END;                                                         0694 01768000
*   CRPLOG=OFF;                     /* DO NOT WRITE TO SMPLOG        */ 01769000
@RC00686 DS    0H                                                  0696 01770000
*   CRPOTHER=OFF;                   /* DO NOT WRITE TO CRDOUTDS      */ 01771000
         NI    CRPLOG,B'11101011'                                  0696 01772000
*   CRPUXNUM=UXPUX001;              /* SET RECEIVE USER EXIT         */ 01773000
         MVI   CRPUXNUM,X'01'                                      0697 01774000
*   MPPSMDNM=GSMS#;                 /* SYSMOD-ID (IF FOUND)          */ 01775000
         LA    @15,GTASM                                           0698 01776000
         MVC   MPPSMDNM(7),GSMS#(@15)                              0698 01777000
*   CALL HMASMMPD(MPPPARM);         /* PARSE STATEMENT               */ 01778000
         L     @15,@CV01707                                        0699 01779000
         LA    @01,@AL00699                                        0699 01780000
         BALR  @14,@15                                             0699 01781000
*   RESPECIFY                                                      0700 01782000
*     REG15 RSTD;                                                  0700 01783000
*   MPDRETRN=REG15;                 /* SAVE RETURN CODE FROM MPD     */ 01784000
         ST    REG15,MPDRETRN                                      0701 01785000
*   RESPECIFY                                                      0702 01786000
*     REG15 UNRSTD;                                                0702 01787000
*   IF MPDRETRN>0 THEN                                             0703 01788000
         L     @15,MPDRETRN                                        0703 01789000
         LTR   @15,@15                                             0703 01790000
         BNP   @RF00703                                            0703 01791000
*     CALL PARSERR;                 /* PROCESS NON-ZERO PARSE CODES  */ 01792000
*                                                                  0704 01793000
         BAL   @14,PARSERR                                         0704 01794000
*   /*****************************************************************/ 01795000
*   /*                                                               */ 01796000
*   /* PUT SYSMOD NAME IN PTS MCS IOP                                */ 01797000
*   /*                                                               */ 01798000
*   /*****************************************************************/ 01799000
*                                                                  0705 01800000
*   RECXIOPT->IOPNAM17=MCBPNO;      /* SYSMOD NAME                   */ 01801000
*                                                                  0705 01802000
@RF00703 L     @01,RECXIOPT                                        0705 01803000
         L     @15,RECXMCB                                         0705 01804000
         MVC   IOPNAM17(7,@01),MCBPNO(@15)                         0705 01805000
*   /*****************************************************************/ 01806000
*   /*                                                               */ 01807000
*   /* FILL IN GTA SUMMARY FILE RECORD                               */ 01808000
*   /*                                                               */ 01809000
*   /*****************************************************************/ 01810000
*                                                                  0706 01811000
*   GSMS#=MCBPNO;                   /* SYSMOD NUMBER                 */ 01812000
         LA    @14,GTASM                                           0706 01813000
         MVC   GSMS#(7,@14),MCBPNO(@15)                            0706 01814000
*   GSMSTY=MCBPTP;                  /* SYSMOD TYPE                   */ 01815000
*                                                                  0707 01816000
         MVC   GSMSTY(1,@14),MCBPTP(@15)                           0707 01817000
*   /*****************************************************************/ 01818000
*   /*                                                               */ 01819000
*   /* MAINTAIN RELFILE TAPE ABSOLUTE FILE SEQUENCE NUMBERS          */ 01820000
*   /*                                                               */ 01821000
*   /*****************************************************************/ 01822000
*                                                                  0708 01823000
*   RECXRFLE=MCBPRELN;              /* CURRENT SYSMOD'S # OF DATA  0708 01824000
*                                      FILES                         */ 01825000
         LH    @15,MCBPRELN(,@15)                                  0708 01826000
         STH   @15,RECXRFLE                                        0708 01827000
*   RECXRCUR=RECXRNXT;              /* CURRENT SYSMOD'S 1ST DATA FILE*/ 01828000
         LH    @14,RECXRNXT                                        0709 01829000
         STH   @14,RECXRCUR                                        0709 01830000
*   RECXRNXT=RECXRCUR+RECXRFLE;     /* NEXT SYSMOD'S 1ST DATA FILE   */ 01831000
         ALR   @14,@15                                             0710 01832000
         STH   @14,RECXRNXT                                        0710 01833000
*   IF CHKSMD#=NO                   /* SYSMOD # NOT FOUND 1ST RECORD */ 01834000
*     THEN                                                         0711 01835000
         CLI   CHKSMD#,C'N'                                        0711 01836000
         BNE   @RF00711                                            0711 01837000
*     DO;                                                          0712 01838000
*                                                                  0712 01839000
*       /*************************************************************/ 01840000
*       /*                                                           */ 01841000
*       /* DETERMINE WHETHER THE SYSMOD SHOULD BE EXCLUDED           */ 01842000
*       /*                                                           */ 01843000
*       /*************************************************************/ 01844000
*                                                                  0713 01845000
*       CALL SECHK;                 /* CHECK SELECT/EXCLUDE LIST     */ 01846000
         BAL   @14,SECHK                                           0713 01847000
*       IF GSMEXCL=OFF              /* SYSMOD NOT EXCLUDED           */ 01848000
*         THEN                                                     0714 01849000
         LA    @15,GTASM                                           0714 01850000
         TM    GSMEXCL(@15),B'00010000'                            0714 01851000
         BNZ   @RF00714                                            0714 01852000
*         CALL PTSCHK(GSMS#);       /* SEE IF IT IS ALREADY RECVD.   */ 01853000
         ST    @15,@AL00001                                        0715 01854000
         LA    @01,@AL00001                                        0715 01855000
         BAL   @14,PTSCHK                                          0715 01856000
*     END;                                                         0716 01857000
*                                                                  0716 01858000
@RF00714 DS    0H                                                  0717 01859000
*   /*****************************************************************/ 01860000
*   /*                                                               */ 01861000
*   /* CHECK IF THIS SYSMOD HAS ALREADY BEEN SEEN DURING THIS        */ 01862000
*   /* INVOCATION OF RECEIVE                                         */ 01863000
*   /*                                                               */ 01864000
*   /*****************************************************************/ 01865000
*                                                                  0717 01866000
*   CALL DUPCHK;                    /* CHECK FOR DUPLICATE SYSMOD    */ 01867000
@RF00711 BAL   @14,DUPCHK                                          0717 01868000
*   END HDRPROC;                                                   0718 01869000
@EL00003 DS    0H                                                  0718 01870000
@EF00003 DS    0H                                                  0718 01871000
@ER00003 LM    @14,@12,@SA00003                                    0718 01872000
         BR    @14                                                 0718 01873000
*                                                                  0719 01874000
*/********************************************************************/ 01875000
*/*                                                                  */ 01876000
*/*    CNTLPROC - PROCESS NON-HEADER SYSTEM MODIFICATION CONTROL     */ 01877000
*/*    STATEMENTS                                                    */ 01878000
*/*                                                                  */ 01879000
*/*        1. CHECK FOR SYSMOD CONSTRUCTION ERRORS.                  */ 01880000
*/*                                                                  */ 01881000
*/*        2. CALL HMASMMPD TO PARSE THE MODIFICATION CNTRL STMT.    */ 01882000
*/*                                                                  */ 01883000
*/*        3. CALL THE APPROPRIATE PROCEDURE TO PROCESS THE          */ 01884000
*/*           STATEMENT:                                             */ 01885000
*/*                                                                  */ 01886000
*/*           - VERPROC  : ++VER STATEMENTS.                         */ 01887000
*/*           - IFPROC   : ++IF  STATEMENTS.                         */ 01888000
*/*           - JCLPROC  : ++JCLIN STATEMENTS.                       */ 01889000
*/*           - ELEMPROC : ++MOD, ++MAC, ++SRC, ETC. STATEMENTS.     */ 01890000
*/*                                                                  */ 01891000
*/*           OR "FLUSH" THE SYSMOD IF A SYNTAX ERROR WAS DETECTED   */ 01892000
*/*           BY HMASMMPD.                                           */ 01893000
*/*                                                                  */ 01894000
*/********************************************************************/ 01895000
*                                                                  0719 01896000
*CNTLPROC:                                                         0719 01897000
*   PROC;                                                          0719 01898000
*                                                                  0719 01899000
CNTLPROC STM   @14,@12,@SA00004                                    0719 01900000
*   /*****************************************************************/ 01901000
*   /*                                                               */ 01902000
*   /* CHECK FOR SYSMOD CONSTRUCTION ERRORS                          */ 01903000
*   /*                                                               */ 01904000
*   /*****************************************************************/ 01905000
*                                                                  0720 01906000
*   IF RECXPTXT=ON                  /* ELEMENT TEXT RECORDS EXPECTED */ 01907000
*       &RECXTXTF=OFF               /* TEXT RECORDS NOT FOUND        */ 01908000
*       &RECXSYSF=OFF               /* SYSMOD NOT BEING FLUSHED      */ 01909000
*     THEN                                                         0720 01910000
         TM    RECXPTXT,B'00100000'                                0720 01911000
         BNO   @RF00720                                            0720 01912000
         TM    RECXTXTF,B'00010000'                                0720 01913000
         BNZ   @RF00720                                            0720 01914000
         TM    RECXSYSF,B'00010000'                                0720 01915000
         BNZ   @RF00720                                            0720 01916000
*     DO;                                                          0721 01917000
*                                                                  0721 01918000
*       /*************************************************************/ 01919000
*       /*                                                           */ 01920000
*       /* TEXT RECORDS SHOULD HAVE BEEN FOUND AFTER THE PREVIOUS    */ 01921000
*       /* CONTROL CARD BUT WERE NOT ... ISSUE HMA273I               */ 01922000
*       /*                                                           */ 01923000
*       /*************************************************************/ 01924000
*                                                                  0722 01925000
*       MGPTYPE=MGPERR;             /* STOP-SYSMOD ERROR             */ 01926000
         MVI   MGPTYPE,X'03'                                       0722 01927000
*       CALL ERRMSG(HMA273I,NOPART,NOPART);/* TEXT TEXT RECORDS NOT     01928000
*                                      FOUND FOR PRECEDING SYSTEM  0723 01929000
*                                      MODIFICATION CONTROL CARD     */ 01930000
         LA    @01,@AL00723                                        0723 01931000
         BAL   @14,ERRMSG                                          0723 01932000
*       RECXSYSF=ON;                /* FLUSH THE CURRENT SYSMOD      */ 01933000
         OI    RECXSYSF,B'00010000'                                0724 01934000
*       GSMSYNTX=ON;                /* SYNTAX/CONSTRUCTION ERROR     */ 01935000
         LA    @15,GTASM                                           0725 01936000
         OI    GSMSYNTX(@15),B'01000000'                           0725 01937000
*     END;                                                         0726 01938000
*                                                                  0727 01939000
*   /*****************************************************************/ 01940000
*   /*                                                               */ 01941000
*   /* WRITE THE FIRST RECORD FOR THIS STMT. (IN CRPBUFFR) TO SMPPTS.*/ 01942000
*   /* NOTE THAT THE SUBSEQUENT RECORDS WHICH MAKE UP THIS STATEMENT */ 01943000
*   /* WILL BE WRITTEN TO SMPPTS BY HMASMCRD (SEE THE INITIALIZATION */ 01944000
*   /* BELOW.)                                                       */ 01945000
*   /*                                                               */ 01946000
*   /*****************************************************************/ 01947000
*                                                                  0727 01948000
*   CALL WRITEPTS(SMCNTRL);         /* WRITE TO SMPPTS (MCS ENTRY) 0727 01949000
*                                      AND AND SMPOUT.               */ 01950000
@RF00720 LA    @01,@AL00727                                        0727 01951000
         BAL   @14,WRITEPTS                                        0727 01952000
*   IF RECXSYSM=OFF                 /* SYSMOD HEADER NOT BEEN FOUND  */ 01953000
*     THEN                                                         0728 01954000
         TM    RECXSYSM,B'01000000'                                0728 01955000
         BNZ   @RF00728                                            0728 01956000
*     DO;                                                          0729 01957000
*       MGPTYPE=MGPERR;             /* STOP-SYSMOD ERROR             */ 01958000
         MVI   MGPTYPE,X'03'                                       0730 01959000
*       CALL ERRMSG(HMA345I,NOPART,NOPART);/* ISSUE MESSAGE          */ 01960000
         LA    @01,@AL00731                                        0731 01961000
         BAL   @14,ERRMSG                                          0731 01962000
*     END;                                                         0732 01963000
*                                                                  0733 01964000
*   /*****************************************************************/ 01965000
*   /*                                                               */ 01966000
*   /* INITIALIZE FOR PROCESSING A NEW MODIFICATION CNTRL STMT       */ 01967000
*   /*                                                               */ 01968000
*   /*****************************************************************/ 01969000
*                                                                  0733 01970000
*   RECXPTXT=OFF;                   /* DO NOT EXPECT TEXT RECORDS TO    01971000
*                                      FOLLOW                        */ 01972000
@RF00728 NI    RECXPTXT,B'11011111'                                0733 01973000
*   DUP347=OFF;                     /* CLEAR HMA347I MSG ISSUED FLAG */ 01974000
         NI    DUP347,B'11110111'                                  0734 01975000
*   RECXPELM=OFF;                   /* CLEAR PROCESSING ELEMENT FLAG */ 01976000
         NI    RECXPELM,B'11111011'                                0735 01977000
*   IF RECXMAX<STOPFUNC THEN                                       0736 01978000
         L     @15,RECXMAX                                         0736 01979000
         CH    @15,@CH00036                                        0736 01980000
         BNL   @RF00736                                            0736 01981000
*     DO;                                                          0737 01982000
*                                                                  0737 01983000
*       /*************************************************************/ 01984000
*       /*                                                           */ 01985000
*       /* SET UP HMASMCRP PARAMETER LIST AND CALL HMASMMPD TO PARSE */ 01986000
*       /* THE MODIFICATION CONTROL STATEMENT.                       */ 01987000
*       /*                                                           */ 01988000
*       /*************************************************************/ 01989000
*                                                                  0738 01990000
*       CRPBFPRM=OFF;               /* BUFFER NOT PRIMED FOR NEXT  0738 01991000
*                                      READ                          */ 01992000
         NI    CRPBFPRM,B'01111111'                                0738 01993000
*       IF RECXSYSF=OFF THEN        /* FLUSHING SYSMOD ?             */ 01994000
         TM    RECXSYSF,B'00010000'                                0739 01995000
         BNZ   @RF00739                                            0739 01996000
*         CRPPTS=ON;                /* NO ... WRITE TO SMPPTS        */ 01997000
         OI    CRPPTS,B'00100000'                                  0740 01998000
*       ELSE                                                       0741 01999000
*         CRPPTS=OFF;               /* YES ... DO NOT WRITE TO SMPPTS*/ 02000000
         B     @RC00739                                            0741 02001000
@RF00739 NI    CRPPTS,B'11011111'                                  0741 02002000
*       CRPLOG=OFF;                 /* DO NOT WRITE TO SMPLOG        */ 02003000
@RC00739 DS    0H                                                  0743 02004000
*       CRPPRINT=ON;                /* WRITE TO SMPOUT               */ 02005000
*       CRPOTHER=OFF;               /* DO NOT WRITE TO CRDOUTDS      */ 02006000
         OI    CRPPRINT,B'00001000'                                0744 02007000
         NI    CRPLOG,B'11101011'                                  0744 02008000
*       CRPUXNUM=UXPUX001;          /* SET RECEIVE USER EXIT         */ 02009000
         MVI   CRPUXNUM,X'01'                                      0745 02010000
*       MPPSMDNM=GSMS#;             /* SYSMOD-ID (MAY BE NULLPTF#)   */ 02011000
         LA    @15,GTASM                                           0746 02012000
         MVC   MPPSMDNM(7),GSMS#(@15)                              0746 02013000
*       CALL HMASMMPD(MPPPARM);     /* PARSE THE STATEMENT           */ 02014000
         L     @15,@CV01707                                        0747 02015000
         LA    @01,@AL00747                                        0747 02016000
         BALR  @14,@15                                             0747 02017000
*       RESPECIFY                                                  0748 02018000
*         REG15 RSTD;                                              0748 02019000
*       MPDRETRN=REG15;             /* SAVE PARSE RETURN CODE        */ 02020000
         ST    REG15,MPDRETRN                                      0749 02021000
*       RESPECIFY                                                  0750 02022000
*         REG15 UNRSTD;                                            0750 02023000
*       IF MPDRETRN>0 THEN                                         0751 02024000
         L     @15,MPDRETRN                                        0751 02025000
         LTR   @15,@15                                             0751 02026000
         BNP   @RF00751                                            0751 02027000
*         CALL PARSERR;             /* PROCESS NON-ZERO PARSE CODES  */ 02028000
         BAL   @14,PARSERR                                         0752 02029000
*       ELSE                                                       0753 02030000
*         DO;                                                      0753 02031000
*                                                                  0753 02032000
         B     @RC00751                                            0753 02033000
@RF00751 DS    0H                                                  0754 02034000
*           /*********************************************************/ 02035000
*           /*                                                       */ 02036000
*           /* PARSE RETURN CODE = 0 ... PROCESS STATEMENTS          */ 02037000
*           /*                                                       */ 02038000
*           /*********************************************************/ 02039000
*                                                                  0754 02040000
*           IF MCBTYPE=MCBVERTP     /* ++VER STATEMENT               */ 02041000
*             THEN                                                 0754 02042000
         L     @01,RECXMCB                                         0754 02043000
         CLI   MCBTYPE(@01),2                                      0754 02044000
         BNE   @RF00754                                            0754 02045000
*             CALL VERPROC;         /* PROCESS ++VER                 */ 02046000
         BAL   @14,VERPROC                                         0755 02047000
*           ELSE                                                   0756 02048000
*             IF MCBTYPE=MCBIFTP    /* ++IF STATEMENT                */ 02049000
*               THEN                                               0756 02050000
         B     @RC00754                                            0756 02051000
@RF00754 L     @01,RECXMCB                                         0756 02052000
         CLI   MCBTYPE(@01),3                                      0756 02053000
         BNE   @RF00756                                            0756 02054000
*               CALL IFPROC;        /* PROCESS ++IF                  */ 02055000
         BAL   @14,IFPROC                                          0757 02056000
*             ELSE                                                 0758 02057000
*               IF MCBTYPE=MCBJCLTP /* ++JCLIN STATEMENT             */ 02058000
*                 THEN                                             0758 02059000
         B     @RC00756                                            0758 02060000
@RF00756 L     @01,RECXMCB                                         0758 02061000
         CLI   MCBTYPE(@01),10                                     0758 02062000
         BNE   @RF00758                                            0758 02063000
*                 CALL JCLPROC;     /* PROCESS ++JCLIN               */ 02064000
         BAL   @14,JCLPROC                                         0759 02065000
*               ELSE                                               0760 02066000
*                 IF MCBTYPE=MCBMODTP/* ++MOD STATEMENT              */ 02067000
*                     |MCBTYPE=MCBMCRTP/* ++MAC STATEMENT            */ 02068000
*                     |MCBTYPE=MCBSCRTP/* ++SRC STATEMENT            */ 02069000
*                     |MCBTYPE=MCBZAPTP/* ++ZAP STATEMENT            */ 02070000
*                     |MCBTYPE=MCBMCUTP/* ++MACUPD STATEMENT         */ 02071000
*                     |MCBTYPE=MCBSCUTP/* ++SRCUPD STATEMENT         */ 02072000
*                   THEN                                           0760 02073000
         B     @RC00758                                            0760 02074000
@RF00758 L     @15,RECXMCB                                         0760 02075000
         CLI   MCBTYPE(@15),4                                      0760 02076000
         BE    @RT00760                                            0760 02077000
         CLI   MCBTYPE(@15),5                                      0760 02078000
         BE    @RT00760                                            0760 02079000
         CLI   MCBTYPE(@15),6                                      0760 02080000
         BE    @RT00760                                            0760 02081000
         CLI   MCBTYPE(@15),7                                      0760 02082000
         BE    @RT00760                                            0760 02083000
         CLI   MCBTYPE(@15),8                                      0760 02084000
         BE    @RT00760                                            0760 02085000
         CLI   MCBTYPE(@15),9                                      0760 02086000
         BNE   @RF00760                                            0760 02087000
@RT00760 DS    0H                                                  0761 02088000
*                   CALL ELEMPROC;  /* PROCESS ELEMENT STATEMENTS    */ 02089000
         BAL   @14,ELEMPROC                                        0761 02090000
*                 ELSE                                             0762 02091000
*                   DO;                                            0762 02092000
*                                                                  0762 02093000
         B     @RC00760                                            0762 02094000
@RF00760 DS    0H                                                  0763 02095000
*                     /***********************************************/ 02096000
*                     /*                                             */ 02097000
*                     /* UN-KNOWN CONTROL TYPE OR SYNTAX ERROR       */ 02098000
*                     /* DETECTED BY HMASMMPD PROCEDURE              */ 02099000
*                     /*                                             */ 02100000
*                     /***********************************************/ 02101000
*                                                                  0763 02102000
*                     RECXSYSF=ON;  /* FLUSH THE SYSMOD              */ 02103000
         OI    RECXSYSF,B'00010000'                                0763 02104000
*                     GSMSYNTX=ON;  /* SYNTAX/CONSTRUCTION ERROR     */ 02105000
         LA    @15,GTASM                                           0764 02106000
         OI    GSMSYNTX(@15),B'01000000'                           0764 02107000
*                   END;                                           0765 02108000
*         END;                                                     0766 02109000
*     END;                                                         0767 02110000
*   END CNTLPROC;                                                  0768 02111000
@EL00004 DS    0H                                                  0768 02112000
@EF00004 DS    0H                                                  0768 02113000
@ER00004 LM    @14,@12,@SA00004                                    0768 02114000
         BR    @14                                                 0768 02115000
*                                                                  0769 02116000
*/********************************************************************/ 02117000
*/*                                                                  */ 02118000
*/*    VERPROC - PROCESS ++VER MODIFICATION CONTROL STATEMENTS.      */ 02119000
*/*                                                                  */ 02120000
*/*        1. CHECK THE SREL/FMID GTA FILE TO DETERMINE WHETHER      */ 02121000
*/*           ANOTHER ++VER IN THIS SYSMOD SPECIFIED THE SAME        */ 02122000
*/*           SREL/FMID AS THIS ++VER.  IF SO, THIS SYSMOD WILL      */ 02123000
*/*           BE "FLUSHED".                                          */ 02124000
*/*                                                                  */ 02125000
*/*        2. PUT THE SREL/FMID FROM THIS ++VER INTO THE SRELFMID    */ 02126000
*/*           GTA FILE.                                              */ 02127000
*/*                                                                  */ 02128000
*/*        3. CHECK THE SREL/FMID SUPPLIED ON THIS ++VER AGAINST     */ 02129000
*/*           THE PTS SYSTEM ENTRY TO DETERMINE THE APPLICABILITY    */ 02130000
*/*           OF THIS SYSMOD.  SET RECXAVER FLAG "ON" IF THIS        */ 02131000
*/*           ++VER IS APPLICABLE.                                   */ 02132000
*/*                                                                  */ 02133000
*/********************************************************************/ 02134000
*                                                                  0769 02135000
*VERPROC:                                                          0769 02136000
*   PROC;                                                          0769 02137000
VERPROC  STM   @14,@12,@SA00005                                    0769 02138000
*   DCL                                                            0770 02139000
*     VEROK CHAR(1);                /* LOCAL VER "OK" SWITCH         */ 02140000
*   DCL                                                            0771 02141000
*     1 VERFLGS BIT(8),             /* LOCAL FLAGS                   */ 02142000
*      2 SRELCHK BIT(1),            /* SREL MATCHES PTS SREL         */ 02143000
*      2 FMIDCHK BIT(1),            /* FMID MATCHES PTS FMID         */ 02144000
*      2 * BIT(6);                  /* UNUSED                        */ 02145000
*                                                                  0771 02146000
*   /*****************************************************************/ 02147000
*   /*                                                               */ 02148000
*   /* SET RECEIVE PROCESSING FLAGS                                  */ 02149000
*   /*                                                               */ 02150000
*   /*****************************************************************/ 02151000
*                                                                  0772 02152000
*   RECXVERF=ON;                    /* SET VER FOUND INDICATOR       */ 02153000
         OI    RECXVERF,B'10000000'                                0772 02154000
*   RECXPVER=ON;                    /* SET PROCESSING VER INDICATOR  */ 02155000
*   RECXPIFS=OFF;                   /* CLEAR PROCESSING IF INDICATOR */ 02156000
*                                                                  0774 02157000
         OI    RECXPVER,B'10000000'                                0774 02158000
         NI    RECXPIFS,B'10111111'                                0774 02159000
*   /*****************************************************************/ 02160000
*   /*                                                               */ 02161000
*   /* RE-INITIALIZE PROCESSING FLAGS                                */ 02162000
*   /*                                                               */ 02163000
*   /*****************************************************************/ 02164000
*                                                                  0775 02165000
*   VERFLGS=''B;                    /* CLEAR LOCAL FLAGS             */ 02166000
         MVI   VERFLGS,X'00'                                       0775 02167000
*   VEROK=YES;                      /* NO ERRORS ENCOUNTERED FOR VER */ 02168000
         MVI   VEROK,C'Y'                                          0776 02169000
*   VERFMID=MCBSFMID;               /* SAVE CURRENT FMID OPERAND     */ 02170000
         L     @01,RECXMCB                                         0777 02171000
         MVC   VERFMID(7),MCBSFMID(@01)                            0777 02172000
*                                                                  0778 02173000
*   /*****************************************************************/ 02174000
*   /*                                                               */ 02175000
*   /* CHECK FOR CONSTRUCTION ERRORS                                 */ 02176000
*   /*                                                               */ 02177000
*   /*****************************************************************/ 02178000
*                                                                  0778 02179000
*   IF RECXJCLF=ON                  /* JCLIN ALREADY FOUND           */ 02180000
*       |RECXMNDX>0                 /* SYSMOD ELEMENTS FOUND         */ 02181000
*     THEN                                                         0778 02182000
         TM    RECXJCLF,B'00100000'                                0778 02183000
         BO    @RT00778                                            0778 02184000
         L     @15,RECXMNDX                                        0778 02185000
         LTR   @15,@15                                             0778 02186000
         BNP   @RF00778                                            0778 02187000
@RT00778 DS    0H                                                  0779 02188000
*     DO;                                                          0779 02189000
*       RECXSYSF=ON;                /* FLUSH SYSMOD                  */ 02190000
         OI    RECXSYSF,B'00010000'                                0780 02191000
*       GSMSYNTX=ON;                /* SYNTAX/CONSTRUCTION ERROR     */ 02192000
         LA    @15,GTASM                                           0781 02193000
         OI    GSMSYNTX(@15),B'01000000'                           0781 02194000
*       VEROK=NO;                   /* SET SWITCH - DO NOT PERFORM 0782 02195000
*                                      SUBSEQUENT CHECKS             */ 02196000
         MVI   VEROK,C'N'                                          0782 02197000
*       MGPTYPE=MGPERR;             /* STOP-SYSMOD ERROR             */ 02198000
         MVI   MGPTYPE,X'03'                                       0783 02199000
*       CALL ERRMSG(HMA345I,NOPART,NOPART);/* ISSUE HMA345I          */ 02200000
         LA    @01,@AL00784                                        0784 02201000
         BAL   @14,ERRMSG                                          0784 02202000
*     END;                                                         0785 02203000
*                                                                  0786 02204000
*   /*****************************************************************/ 02205000
*   /*                                                               */ 02206000
*   /* DETERMINE THE RECEIVABILITY OF THIS SYSMOD BASED UPON THE     */ 02207000
*   /* BYPASS OPTIONS AND THE SREL/FMID(S) IN THE PTS SYSTEM ENTRY   */ 02208000
*   /*                                                               */ 02209000
*   /*****************************************************************/ 02210000
*                                                                  0786 02211000
*   IF RECXAVER=OFF                 /* APPLICABLE VER NOT YET FOUND  */ 02212000
*       &RECXMAX<STOPFUNC           /* NOT TERMINATING RECEIVE       */ 02213000
*       &VEROK=YES                  /* NO ERRORS FOR THIS ++VER      */ 02214000
*     THEN                                                         0786 02215000
@RF00778 TM    RECXAVER,B'01000000'                                0786 02216000
         BNZ   @RF00786                                            0786 02217000
         L     @15,RECXMAX                                         0786 02218000
         CH    @15,@CH00036                                        0786 02219000
         BNL   @RF00786                                            0786 02220000
         CLI   VEROK,C'Y'                                          0786 02221000
         BNE   @RF00786                                            0786 02222000
*     DO;                                                          0787 02223000
*       RESPECIFY                                                  0788 02224000
*         HMASMGTP BASED(RECXGPSP); /* PTS SYSTEM GTP                */ 02225000
*       IF RECXIOPP->IOPPTYPE=IOPPFUNC/* FUNCTION-TYPE SYSMOD        */ 02226000
*         THEN                                                     0789 02227000
         L     @01,RECXIOPP                                        0789 02228000
         CLI   IOPPTYPE(@01),4                                     0789 02229000
         BNE   @RF00789                                            0789 02230000
*         FMIDCHK=ON;               /* FMID CHK IS N/A FOR FUNCTIONS */ 02231000
         OI    FMIDCHK,B'01000000'                                 0790 02232000
*       ELSE                                                       0791 02233000
*         DO;                                                      0791 02234000
*                                                                  0791 02235000
         B     @RC00789                                            0791 02236000
@RF00789 DS    0H                                                  0792 02237000
*           /*********************************************************/ 02238000
*           /*                                                       */ 02239000
*           /* CHECK FMID FOR NON-FUNCTION-TYPE SYSMODS              */ 02240000
*           /*                                                       */ 02241000
*           /*********************************************************/ 02242000
*                                                                  0792 02243000
*           IF RECBPFM=OFF          /* FMID CRITERIA NOT BYPASSED    */ 02244000
*             THEN                                                 0792 02245000
         L     @15,@PC00001                                        0792 02246000
         TM    RECBPFM(@15),B'00000100'                            0792 02247000
         BNZ   @RF00792                                            0792 02248000
*             DO;                                                  0793 02249000
*                                                                  0793 02250000
*               /*****************************************************/ 02251000
*               /*                                                   */ 02252000
*               /* FMID SELECTION CRITERIA IS NOT BYPASSED ... CHECK */ 02253000
*               /* THIS VER'S FMID AGAINST PTS SYSTEM ENTRY          */ 02254000
*               /*                                                   */ 02255000
*               /*****************************************************/ 02256000
*                                                                  0794 02257000
*               GPSTYPE=IOPPTFM;    /* KEY: TYPE IS FMID             */ 02258000
         LA    @15,GTAPS                                           0794 02259000
         MVI   GPSTYPE(@15),X'01'                                  0794 02260000
*               IF MCBSFMID=NULLPTF#/* NO FMID ON ++VER              */ 02261000
*                 THEN                                             0795 02262000
         L     @01,RECXMCB                                         0795 02263000
         CLC   MCBSFMID(7,@01),@CC01733                            0795 02264000
         BNE   @RF00795                                            0795 02265000
*                 GPSENT=CCAFMID;   /* USE CCAFMID FOR GTA LOCATE    */ 02266000
         MVC   GPSENT(7,@15),CCAFMID(CCAPTR)                       0796 02267000
*               ELSE                                               0797 02268000
*                 GPSENT=MCBSFMID;  /* USE MCB FMID FOR GTA LOCATE   */ 02269000
         B     @RC00795                                            0797 02270000
@RF00795 LA    @15,GTAPS                                           0797 02271000
         L     @14,RECXMCB                                         0797 02272000
         MVC   GPSENT(7,@15),MCBSFMID(@14)                         0797 02273000
*               GTPFUNCT=GTPLOC;    /* LOCATE FUNCTION               */ 02274000
@RC00795 L     @15,RECXGPSP                                        0798 02275000
         MVI   GTPFUNCT(@15),X'03'                                 0798 02276000
*               CALL HMASMGTA(HMASMGTP);/* SEE IF FIMD IS IN PTS   0799 02277000
*                                      SYSTEM ENTRY                  */ 02278000
         ST    @15,@AL00001                                        0799 02279000
         L     @15,@CV01706                                        0799 02280000
         LA    @01,@AL00001                                        0799 02281000
         BALR  @14,@15                                             0799 02282000
*               IF GTPRETRN=GTPGOOD THEN                           0800 02283000
         L     @01,RECXGPSP                                        0800 02284000
         CLI   GTPRETRN(@01),0                                     0800 02285000
         BNE   @RF00800                                            0800 02286000
*                 FMIDCHK=ON;       /* FMID IS APPLICABLE TO THIS PTS*/ 02287000
         OI    FMIDCHK,B'01000000'                                 0801 02288000
*             END;                                                 0802 02289000
*           ELSE                                                   0803 02290000
*             FMIDCHK=ON;           /* FMID CHECK IS BYPASSED        */ 02291000
         B     @RC00792                                            0803 02292000
@RF00792 OI    FMIDCHK,B'01000000'                                 0803 02293000
*         END;                                                     0804 02294000
@RC00792 DS    0H                                                  0805 02295000
*       IF FMIDCHK=ON THEN                                         0805 02296000
@RC00789 TM    FMIDCHK,B'01000000'                                 0805 02297000
         BNO   @RF00805                                            0805 02298000
*         DO;                                                      0806 02299000
*                                                                  0806 02300000
*           /*********************************************************/ 02301000
*           /*                                                       */ 02302000
*           /* THE FMID ON THIS VER IS "OK" ... CHECK ALL SRELS      */ 02303000
*           /* AGAINST THE PTS SYSTEM ENTRY                          */ 02304000
*           /*                                                       */ 02305000
*           /*********************************************************/ 02306000
*                                                                  0807 02307000
*           GPSENT=' ';             /* BLANK ENTRY FIELD IN PTS SYS     02308000
*                                      RECORD                        */ 02309000
*                                                                  0807 02310000
         LA    @15,GTAPS                                           0807 02311000
         MVI   GPSENT+1(@15),C' '                                  0807 02312000
         MVC   GPSENT+2(5,@15),GPSENT+1(@15)                       0807 02313000
         MVI   GPSENT(@15),C' '                                    0807 02314000
*           /*********************************************************/ 02315000
*           /*                                                       */ 02316000
*           /* GO THRU THE SRELS SPECIFIED ON THIS ++VER AND COMPARE */ 02317000
*           /* THEM TO SRELS IN THE PTS SYSTEM ENTRY                 */ 02318000
*           /*                                                       */ 02319000
*           /*********************************************************/ 02320000
*                                                                  0808 02321000
*           DO II=1 BY 1 WHILE MCBVND(II)^=IOPEOLST/* NOT AT END     */ 02322000
*                 &SRELCHK=OFF;     /* SREL NOT FOUND IN PTS         */ 02323000
         LA    @15,1                                               0808 02324000
         ST    @15,II                                              0808 02325000
         B     @DE00808                                            0808 02326000
@DL00808 DS    0H                                                  0809 02327000
*             IF MCBVIND(II)=IOPPSREL THEN                         0809 02328000
         L     @15,RECXMCB                                         0809 02329000
         L     @14,II                                              0809 02330000
         MH    @14,@CH00034                                        0809 02331000
         SLR   @07,@07                                             0809 02332000
         IC    @07,MCBVIND-9(@14,@15)                              0809 02333000
         CH    @07,@CH01190                                        0809 02334000
         BNE   @RF00809                                            0809 02335000
*               DO;                                                0810 02336000
*                                                                  0810 02337000
*                 /***************************************************/ 02338000
*                 /*                                                 */ 02339000
*                 /* SREL FOUND IN MCB ... LOOK FOR IT IN PTS SYSTEM */ 02340000
*                 /* ENTRY GTA FILE                                  */ 02341000
*                 /*                                                 */ 02342000
*                 /***************************************************/ 02343000
*                                                                  0811 02344000
*                 GPSTYPE=IOPPTSRL; /* KEY: TYPE IS SREL             */ 02345000
         LA    @07,GTAPS                                           0811 02346000
         MVI   GPSTYPE(@07),X'02'                                  0811 02347000
*                 GPSENT(1:4)=MCBVNUM(II,1:4);/* KEY: SREL VALUE     */ 02348000
         ALR   @14,@15                                             0812 02349000
         BCTR  @14,0                                               0812 02350000
         MVC   GPSENT(4,@07),MCBVNUM-8(@14)                        0812 02351000
*                 GSRFMID=MCBSFMID; /* PUT FMID IN SRELFMID RECORD 0813 02352000
*                                      KEY                           */ 02353000
         LA    @14,GTASR                                           0813 02354000
         MVC   GSRFMID(7,@14),MCBSFMID(@15)                        0813 02355000
*                 GTPFUNCT=GTPLOC;  /* LOCATE FUNCTION               */ 02356000
         L     @15,RECXGPSP                                        0814 02357000
         MVI   GTPFUNCT(@15),X'03'                                 0814 02358000
*                 CALL HMASMGTA(HMASMGTP);/* SEE IF THERE IS A MATCH */ 02359000
         ST    @15,@AL00001                                        0815 02360000
         L     @15,@CV01706                                        0815 02361000
         LA    @01,@AL00001                                        0815 02362000
         BALR  @14,@15                                             0815 02363000
*                 IF GTPRETRN=GTPGOOD THEN                         0816 02364000
*                                                                  0816 02365000
         L     @01,RECXGPSP                                        0816 02366000
         CLI   GTPRETRN(@01),0                                     0816 02367000
         BNE   @RF00816                                            0816 02368000
*                   /*************************************************/ 02369000
*                   /*                                               */ 02370000
*                   /* FOUND IN PTS SYS ENTRY => APPLICABLE ++VER    */ 02371000
*                   /*                                               */ 02372000
*                   /*************************************************/ 02373000
*                                                                  0817 02374000
*                   SRELCHK=ON;     /* SREL MATCHES PTS SREL         */ 02375000
         OI    SRELCHK,B'10000000'                                 0817 02376000
*               END;                                               0818 02377000
@RF00816 DS    0H                                                  0819 02378000
*           END;                                                   0819 02379000
@RF00809 LA    @15,1                                               0819 02380000
         AL    @15,II                                              0819 02381000
         ST    @15,II                                              0819 02382000
@DE00808 L     @15,II                                              0819 02383000
         MH    @15,@CH00034                                        0819 02384000
         L     @01,RECXMCB                                         0819 02385000
         BCTR  @01,0                                               0819 02386000
         SLR   @14,@14                                             0819 02387000
         IC    @14,MCBVND-8(@15,@01)                               0819 02388000
         CH    @14,@CH00766                                        0819 02389000
         BE    @DC00808                                            0819 02390000
         TM    SRELCHK,B'10000000'                                 0819 02391000
         BZ    @DL00808                                            0819 02392000
@DC00808 DS    0H                                                  0820 02393000
*         END;                                                     0820 02394000
*     END;                                                         0821 02395000
@RF00805 DS    0H                                                  0822 02396000
*                                                                  0822 02397000
*   /*****************************************************************/ 02398000
*   /*                                                               */ 02399000
*   /* VALIDITY CHECK THE ++VER                                      */ 02400000
*   /*                                                               */ 02401000
*   /*****************************************************************/ 02402000
*                                                                  0822 02403000
*   IF VEROK=YES                    /* NO ERRORS FOR THIS ++VER      */ 02404000
*       &RECXMAX<STOPFUNC           /* NO TERMINATING ERRORS         */ 02405000
*     THEN                                                         0822 02406000
@RF00786 CLI   VEROK,C'Y'                                          0822 02407000
         BNE   @RF00822                                            0822 02408000
         L     @15,RECXMAX                                         0822 02409000
         CH    @15,@CH00036                                        0822 02410000
         BNL   @RF00822                                            0822 02411000
*     CALL VERCHK(VEROK);           /* CHECK THIS ++VER              */ 02412000
         LA    @01,@AL00823                                        0823 02413000
         BAL   @14,VERCHK                                          0823 02414000
*   IF VEROK=YES                    /* VALIDITY CHECK SUCCESSFUL     */ 02415000
*       &SRELCHK=ON                 /* AN SREL MATCHES A PTS SREL    */ 02416000
*       &FMIDCHK=ON                 /* FMID MATCHES A PTS FMID       */ 02417000
*       &RECXMAX<STOPFUNC           /* NO TERMINATING ERRORS         */ 02418000
*     THEN                                                         0824 02419000
@RF00822 CLI   VEROK,C'Y'                                          0824 02420000
         BNE   @RF00824                                            0824 02421000
         TM    SRELCHK,B'11000000'                                 0824 02422000
         BNO   @RF00824                                            0824 02423000
         L     @15,RECXMAX                                         0824 02424000
         CH    @15,@CH00036                                        0824 02425000
         BNL   @RF00824                                            0824 02426000
*     RECXAVER=ON;                  /* SET APPLICABLE ++VER FOUND    */ 02427000
         OI    RECXAVER,B'01000000'                                0825 02428000
*   RETURN;                                                        0826 02429000
@EL00005 DS    0H                                                  0826 02430000
@EF00005 DS    0H                                                  0826 02431000
@ER00005 LM    @14,@12,@SA00005                                    0826 02432000
         BR    @14                                                 0826 02433000
*   END VERPROC;                                                   0827 02434000
         B     @EL00005                                            0827 02435000
*                                                                  0828 02436000
*/********************************************************************/ 02437000
*/*                                                                  */ 02438000
*/*    IFPROC - PROCESS ++IF MODIFICATION CONTROL STATEMENTS         */ 02439000
*/*                                                                  */ 02440000
*/*           MAKE SURE THAT THE ++IF STATEMENT IS ASSOCIATED        */ 02441000
*/*           WITH A PRECEDING ++VER STATEMENT.  IF NOT, THE         */ 02442000
*/*           CURRENT SYSMOD IS SET TO BE "FLUSHED".                 */ 02443000
*/*                                                                  */ 02444000
*/********************************************************************/ 02445000
*                                                                  0828 02446000
*IFPROC:                                                           0828 02447000
*   PROC;                                                          0828 02448000
IFPROC   STM   @14,@12,@SA00006                                    0828 02449000
*   IF RECXPVER=OFF THEN                                           0829 02450000
         TM    RECXPVER,B'10000000'                                0829 02451000
         BNZ   @RF00829                                            0829 02452000
*     DO;                                                          0830 02453000
*                                                                  0830 02454000
*       /*************************************************************/ 02455000
*       /*                                                           */ 02456000
*       /* THE ++IF STATEMENT DOES NOT FOLLOW A ++VER ... ISSUE      */ 02457000
*       /* HMA349I                                                   */ 02458000
*       /*                                                           */ 02459000
*       /*************************************************************/ 02460000
*                                                                  0831 02461000
*       RECXSYSF=ON;                /* FLUSH SYSMOD                  */ 02462000
         OI    RECXSYSF,B'00010000'                                0831 02463000
*       GSMSYNTX=ON;                /* SYNTAX/CONSTRUCTION ERROR     */ 02464000
         LA    @15,GTASM                                           0832 02465000
         OI    GSMSYNTX(@15),B'01000000'                           0832 02466000
*       MGPTYPE=MGPERR;             /* STOP-SYSMOD ERROR             */ 02467000
         MVI   MGPTYPE,X'03'                                       0833 02468000
*       CALL ERRMSG(HMA349I,NOPART,NOPART);/* ++IF STMT NOT        0834 02469000
*                                      ASSOCIATED WITH ANY PRECEDING    02470000
*                                      ++VER.                        */ 02471000
         LA    @01,@AL00834                                        0834 02472000
         BAL   @14,ERRMSG                                          0834 02473000
*     END;                                                         0835 02474000
*   ELSE                                                           0836 02475000
*     DO;                                                          0836 02476000
*                                                                  0836 02477000
         B     @RC00829                                            0836 02478000
@RF00829 DS    0H                                                  0837 02479000
*       /*************************************************************/ 02480000
*       /*                                                           */ 02481000
*       /* THE ++IF STATEMENT IS ASSOCIATED WITH A PREVIOUS ++VER    */ 02482000
*       /*                                                           */ 02483000
*       /*************************************************************/ 02484000
*                                                                  0837 02485000
*       IF MCBIFENV=VERFMID THEN                                   0837 02486000
         L     @01,RECXMCB                                         0837 02487000
         CLC   MCBIFENV(7,@01),VERFMID                             0837 02488000
         BNE   @RF00837                                            0837 02489000
*         DO;                                                      0838 02490000
*                                                                  0838 02491000
*           /*********************************************************/ 02492000
*           /*                                                       */ 02493000
*           /* ++IF FMID OPERAND = ++VER FMID OPERAND ... ISSUE      */ 02494000
*           /* HMA363I/PART095                                       */ 02495000
*           /*                                                       */ 02496000
*           /*********************************************************/ 02497000
*                                                                  0839 02498000
*           RECXSYSF=ON;            /* FLUSH SYSMOD                  */ 02499000
         OI    RECXSYSF,B'00010000'                                0839 02500000
*           GSMSYNTX=ON;            /* SYNTAX/CONSTRUCTION ERROR     */ 02501000
         LA    @15,GTASM                                           0840 02502000
         OI    GSMSYNTX(@15),B'01000000'                           0840 02503000
*           MGPTYPE=MGPERR;         /* STOP-SYSMOD ERROR             */ 02504000
         MVI   MGPTYPE,X'03'                                       0841 02505000
*           CALL ERRMSG(HMA363I,PART095,NOPART);                   0842 02506000
         LA    @01,@AL00842                                        0842 02507000
         BAL   @14,ERRMSG                                          0842 02508000
*         END;                                                     0843 02509000
*       IF MCBIFENV=RECXIOPP->IOPNAM17 THEN                        0844 02510000
@RF00837 L     @01,RECXMCB                                         0844 02511000
         L     @15,RECXIOPP                                        0844 02512000
         CLC   MCBIFENV(7,@01),IOPNAM17(@15)                       0844 02513000
         BNE   @RF00844                                            0844 02514000
*         DO;                                                      0845 02515000
*                                                                  0845 02516000
*           /*********************************************************/ 02517000
*           /*                                                       */ 02518000
*           /* ++IF FMID OPERAND = CURRENT SYSMOD'S NAME ... ISSUE   */ 02519000
*           /* HMA363I/PART096                                       */ 02520000
*           /*                                                       */ 02521000
*           /*********************************************************/ 02522000
*                                                                  0846 02523000
*           RECXSYSF=ON;            /* FLUSH SYSMOD                  */ 02524000
         OI    RECXSYSF,B'00010000'                                0846 02525000
*           GSMSYNTX=ON;            /* SYNTAX/CONSTRUCTION ERROR     */ 02526000
         LA    @15,GTASM                                           0847 02527000
         OI    GSMSYNTX(@15),B'01000000'                           0847 02528000
*           MGPTYPE=MGPERR;         /* STOP-SYSMOD ERROR             */ 02529000
         MVI   MGPTYPE,X'03'                                       0848 02530000
*           CALL ERRMSG(HMA363I,PART096,NOPART);                   0849 02531000
         LA    @01,@AL00849                                        0849 02532000
         BAL   @14,ERRMSG                                          0849 02533000
*         END;                                                     0850 02534000
*     END;                                                         0851 02535000
*   RETURN;                                                        0852 02536000
@EL00006 DS    0H                                                  0852 02537000
@EF00006 DS    0H                                                  0852 02538000
@ER00006 LM    @14,@12,@SA00006                                    0852 02539000
         BR    @14                                                 0852 02540000
*   END IFPROC;                                                    0853 02541000
         B     @EL00006                                            0853 02542000
*                                                                  0854 02543000
*/********************************************************************/ 02544000
*/*                                                                  */ 02545000
*/*    JCLPROC - PROCESS ++JCLIN MODIFICATION CONTROL STATEMENTS     */ 02546000
*/*                                                                  */ 02547000
*/*        1. CHECK WHETHER AN APPLICABLE ++VER HAS BEEN FOUND.      */ 02548000
*/*           IF NOT, THIS SYSMOD IS SET TO BE "FLUSHED".            */ 02549000
*/*                                                                  */ 02550000
*/*        2. INSURE THAT NO ++JCLIN HAS YET BEEN PROCESSED FOR      */ 02551000
*/*           THIS SYSMOD.  IF SO, THIS SYSMOD IS SET TO BE          */ 02552000
*/*           "FLUSHED".                                             */ 02553000
*/*                                                                  */ 02554000
*/*        3. IF THE JCLIN DATA IS EXPECTED IN-LINE (I.E., NOT ON    */ 02555000
*/*           A TXLIB OR RELFILE), SET RECXPTXT "ON" TO INIDCATE     */ 02556000
*/*           THAT TEXT IS EXPECTED.                                 */ 02557000
*/*                                                                  */ 02558000
*/*        4. CALL RCTPROC TO SAVE RELFILE PARAMETER DATA (IF        */ 02559000
*/*           PRESENT.)                                              */ 02560000
*/*                                                                  */ 02561000
*/********************************************************************/ 02562000
*                                                                  0854 02563000
*JCLPROC:                                                          0854 02564000
*   PROC;                                                          0854 02565000
JCLPROC  STM   @14,@12,@SA00007                                    0854 02566000
*   RECXPTXT=OFF;                   /* TEXT RECORDS NOT EXPECTED     */ 02567000
*   RECXPUPD=OFF;                   /* NOT PROCESSING UPDATE ELEM    */ 02568000
*   RECXPVER=OFF;                   /* NOT PROCESSING ++VER          */ 02569000
*   RECXPELM=ON;                    /* PROCESSING AN ELEMENT         */ 02570000
         OI    RECXPELM,B'00000100'                                0858 02571000
         NI    RECXPTXT,B'01010111'                                0858 02572000
*   RECXRELM=0;                     /* CURRENT JCLIN HAS NO RELFILE  */ 02573000
         SLR   @15,@15                                             0859 02574000
         STH   @15,RECXRELM                                        0859 02575000
*   IF RECXAVER=OFF THEN                                           0860 02576000
         TM    RECXAVER,B'01000000'                                0860 02577000
         BNZ   @RF00860                                            0860 02578000
*     DO;                                                          0861 02579000
*                                                                  0861 02580000
*       /*************************************************************/ 02581000
*       /*                                                           */ 02582000
*       /* AN APPLICABLE ++VER HAS NOT BEEN FOUND. THIS SYSMOD MUST  */ 02583000
*       /* BE FLUSHED.                                               */ 02584000
*       /*                                                           */ 02585000
*       /*************************************************************/ 02586000
*                                                                  0862 02587000
*       RECXSYSF=ON;                /* FLUSH SYSMOD                  */ 02588000
         OI    RECXSYSF,B'00010000'                                0862 02589000
*       IF RECXVERF=ON              /* SOME ++VER HAS BEEN FOUND     */ 02590000
*           &GSMSYNTX=OFF           /* NO SYNTAX/CONSTRUCTION ERRORS */ 02591000
*         THEN                                                     0863 02592000
         TM    RECXVERF,B'10000000'                                0863 02593000
         BNO   @RF00863                                            0863 02594000
         LA    @15,GTASM                                           0863 02595000
         TM    GSMSYNTX(@15),B'01000000'                           0863 02596000
         BNZ   @RF00863                                            0863 02597000
*         DO;                                                      0864 02598000
*           GSMNAVER=ON;            /* SET NOT APPLICABLE IN SUMMARY */ 02599000
         OI    GSMNAVER(@15),B'00001000'                           0865 02600000
*           MCSCHECK=OFF;           /* SUPPRESS MOD.CNTL.STMT. CHECKS*/ 02601000
         NI    MCSCHECK,B'11111101'                                0866 02602000
*         END;                                                     0867 02603000
*       ELSE                                                       0868 02604000
*         GSMSYNTX=ON;              /* SET SYNTAX/CONSTRUCTION ERROR    02605000
*                                      FOR NO ++VER FOUND CONDITION  */ 02606000
         B     @RC00863                                            0868 02607000
@RF00863 LA    @15,GTASM                                           0868 02608000
         OI    GSMSYNTX(@15),B'01000000'                           0868 02609000
*     END;                                                         0869 02610000
*                                                                  0869 02611000
@RC00863 DS    0H                                                  0870 02612000
*   /*****************************************************************/ 02613000
*   /*                                                               */ 02614000
*   /* PROCESS JCLIN                                                 */ 02615000
*   /*                                                               */ 02616000
*   /*****************************************************************/ 02617000
*                                                                  0870 02618000
*   IF RECXJCLF=ON THEN                                            0870 02619000
@RF00860 TM    RECXJCLF,B'00100000'                                0870 02620000
         BNO   @RF00870                                            0870 02621000
*     DO;                                                          0871 02622000
*                                                                  0871 02623000
*       /*************************************************************/ 02624000
*       /*                                                           */ 02625000
*       /* IN-LINE JCLIN HAS ALREADY BEEN PROCESSED FOR FOR THIS     */ 02626000
*       /* SYSMOD (HMA342I ISSUED BY HMASMMPE).                      */ 02627000
*       /*                                                           */ 02628000
*       /*************************************************************/ 02629000
*                                                                  0872 02630000
*       RECXSYSF=ON;                /* FLUSH SYSMOD                  */ 02631000
         OI    RECXSYSF,B'00010000'                                0872 02632000
*       GSMSYNTX=ON;                /* SYNTAX/CONSTRUCTION ERROR     */ 02633000
         LA    @15,GTASM                                           0873 02634000
         OI    GSMSYNTX(@15),B'01000000'                           0873 02635000
*     END;                                                         0874 02636000
*   ELSE                                                           0875 02637000
*     DO;                                                          0875 02638000
*                                                                  0875 02639000
         B     @RC00870                                            0875 02640000
@RF00870 DS    0H                                                  0876 02641000
*       /*************************************************************/ 02642000
*       /*                                                           */ 02643000
*       /* PROCESS IN-LINE JCLIN                                     */ 02644000
*       /*                                                           */ 02645000
*       /*************************************************************/ 02646000
*                                                                  0876 02647000
*       IF MCBERLF(1)^=' ' THEN                                    0876 02648000
         L     @01,RECXMCB                                         0876 02649000
         CLI   MCBERLF(@01),C' '                                   0876 02650000
         BE    @RF00876                                            0876 02651000
*         CALL RCTPROC;             /* JCLIN IS ON A RELFILE         */ 02652000
         BAL   @14,RCTPROC                                         0877 02653000
*       ELSE                                                       0878 02654000
*         IF MCBETXLB(1)=' ' THEN                                  0878 02655000
         B     @RC00876                                            0878 02656000
@RF00876 L     @01,RECXMCB                                         0878 02657000
         CLI   MCBETXLB(@01),C' '                                  0878 02658000
         BNE   @RF00878                                            0878 02659000
*           RECXPTXT=ON;            /* JCLIN IS NOT ON A RELFILE OR     02660000
*                                      TXLIB, THEREFORE, TEXT IS   0879 02661000
*                                      EXPECTED.                     */ 02662000
         OI    RECXPTXT,B'00100000'                                0879 02663000
*     END;                                                         0880 02664000
@RF00878 DS    0H                                                  0880 02665000
@RC00876 DS    0H                                                  0881 02666000
*   RECXJCLF=ON;                    /* INDICATE IN-LINE JCLIN FOUND  */ 02667000
@RC00870 OI    RECXJCLF,B'00100000'                                0881 02668000
*   RETURN;                                                        0882 02669000
@EL00007 DS    0H                                                  0882 02670000
@EF00007 DS    0H                                                  0882 02671000
@ER00007 LM    @14,@12,@SA00007                                    0882 02672000
         BR    @14                                                 0882 02673000
*   END JCLPROC;                                                   0883 02674000
*                                                                  0884 02675000
*/********************************************************************/ 02676000
*/*                                                                  */ 02677000
*/*    ELEMPROC - PROCESS ++MOD, ++MAC, ++SRC, ++MACUPD, ++SRCUPD    */ 02678000
*/*               AND ++ZAP MODIFICATION CONTROL STATEMENTS.         */ 02679000
*/*                                                                  */ 02680000
*/*        1. CHECK WHETHER AN APPLICABLE ++VER HAS BEEN FOUND.      */ 02681000
*/*           IF NOT, THIS SYSMOD IS SET TO BE "FLUSHED".            */ 02682000
*/*                                                                  */ 02683000
*/*        2. CHECK WHETHER THE CURRENT SYSMOD HAS SUPPLIED:         */ 02684000
*/*                                                                  */ 02685000
*/*           (1) MORE THAN 1 REPLACEMENT FOR A GIVEN ELEMENT,       */ 02686000
*/*           (2) MORE THAN 1 UPDATE FOR A GIVEN ELEMENT,            */ 02687000
*/*           (3) AN UPDATE AND A REPLACEMENT FOR A GIVEN ELEMENT.   */ 02688000
*/*                                                                  */ 02689000
*/*           IF ANY OF THE ABOVE CONDITIONS ARE FOUND TO BE TRUE    */ 02690000
*/*           THE SYSMOD IS SET TO BE FLUSHED.                       */ 02691000
*/*                                                                  */ 02692000
*/*        3. IF IN-LINE TEXT IS EXPECTED FOR THIS ELEMENT (I.E.,    */ 02693000
*/*           NOT TXLIB, LKLIB OR RELFILE), SET RECXPTXT "ON" TO     */ 02694000
*/*           INDICATE THAT SUCH TEXT IS EXPECTED.                   */ 02695000
*/*                                                                  */ 02696000
*/*        4. CALL RCTPROC TO SAVE RELFILE PARAMETER DATA (IF        */ 02697000
*/*           PRESENT.)                                              */ 02698000
*/*                                                                  */ 02699000
*/********************************************************************/ 02700000
*                                                                  0884 02701000
*ELEMPROC:                                                         0884 02702000
*   PROC;                                                          0884 02703000
ELEMPROC STM   @14,@12,@SA00008                                    0884 02704000
*   DCL                                                            0885 02705000
*     INVELMN(3) FIXED(8);          /* INVALID ELEM COMBINATION ARRAY*/ 02706000
*   DCL                                                            0886 02707000
*     MM FIXED(15);                 /* INDEX - IOP SUBENTRIES        */ 02708000
*   DCL                                                            0887 02709000
*     NN FIXED(15);                 /* INDEX - INVELMN ARRAY         */ 02710000
*   RECXMNDX=RECXMNDX+1;            /* MAINTAIN COUNT OF ELEMENTS    */ 02711000
*                                                                  0888 02712000
         LA    @15,1                                               0888 02713000
         AL    @15,RECXMNDX                                        0888 02714000
         ST    @15,RECXMNDX                                        0888 02715000
*   /*****************************************************************/ 02716000
*   /*                                                               */ 02717000
*   /* RE-INITIALIZE ELEMENT PROCESSING FLAGS                        */ 02718000
*   /*                                                               */ 02719000
*   /*****************************************************************/ 02720000
*                                                                  0889 02721000
*   RECXPTXT=OFF;                   /* TEXT RECORDS NOT EXPECTED     */ 02722000
*   RECXTXTF=OFF;                   /* TEXT RECORDS NOT FOUND        */ 02723000
*   RECXPUPD=OFF;                   /* NOT PROCESSING UPDATE ELEM    */ 02724000
*   RECXPVER=OFF;                   /* NOT PROCESSING ++VER          */ 02725000
*   RECXPELM=ON;                    /* PROCESSING AN ELEMENT         */ 02726000
         OI    RECXPELM,B'00000100'                                0893 02727000
         NI    RECXPTXT,B'01000111'                                0893 02728000
*   RECXRELM=0;                     /* CURRENT ELEMENT HAS NO RELFILE*/ 02729000
         SLR   @15,@15                                             0894 02730000
         STH   @15,RECXRELM                                        0894 02731000
*   UPDCHG=OFF;                     /* IEBUPDTE ./CHANGE NOT FOUND   */ 02732000
*   UPDEND=OFF;                     /* IEBUPDTE ./ENDUP NOT FOUND    */ 02733000
*   DUP362=OFF;                     /* HMASM362 HAS BEEN ISSUED      */ 02734000
         NI    UPDCHG,B'00111011'                                  0897 02735000
*   IF RECXAVER=OFF THEN                                           0898 02736000
         TM    RECXAVER,B'01000000'                                0898 02737000
         BNZ   @RF00898                                            0898 02738000
*     DO;                                                          0899 02739000
*                                                                  0899 02740000
*       /*************************************************************/ 02741000
*       /*                                                           */ 02742000
*       /* AN APPLICABLE ++VER HAS NOT BEEN FOUND. THIS SYSMOD MUST  */ 02743000
*       /* BE FLUSHED.                                               */ 02744000
*       /*                                                           */ 02745000
*       /*************************************************************/ 02746000
*                                                                  0900 02747000
*       RECXSYSF=ON;                /* THIS WILL STOP RECORDS FROM 0900 02748000
*                                      BEING WRITTEN TO THE PTS      */ 02749000
         OI    RECXSYSF,B'00010000'                                0900 02750000
*       IF RECXVERF=ON              /* SOME ++VER HAS BEEN FOUND     */ 02751000
*           &GSMSYNTX=OFF           /* NO SYNTAX/CONSTRUCTION ERRORS */ 02752000
*         THEN                                                     0901 02753000
         TM    RECXVERF,B'10000000'                                0901 02754000
         BNO   @RF00901                                            0901 02755000
         LA    @15,GTASM                                           0901 02756000
         TM    GSMSYNTX(@15),B'01000000'                           0901 02757000
         BNZ   @RF00901                                            0901 02758000
*         DO;                                                      0902 02759000
*           GSMNAVER=ON;            /* SET NOT APPLICABLE IN SUMMARY */ 02760000
         OI    GSMNAVER(@15),B'00001000'                           0903 02761000
*           MCSCHECK=OFF;           /* SUPPRESS MOD.CNTL.STMT. CHECKS*/ 02762000
         NI    MCSCHECK,B'11111101'                                0904 02763000
*         END;                                                     0905 02764000
*       ELSE                                                       0906 02765000
*         GSMSYNTX=ON;              /* SET SYNTAX/CONSTRUCTION ERROR    02766000
*                                      FOR NO ++VER FOUND CONDITION  */ 02767000
         B     @RC00901                                            0906 02768000
@RF00901 LA    @15,GTASM                                           0906 02769000
         OI    GSMSYNTX(@15),B'01000000'                           0906 02770000
*     END;                                                         0907 02771000
@RC00901 DS    0H                                                  0908 02772000
*                                                                  0908 02773000
*   /*****************************************************************/ 02774000
*   /*                                                               */ 02775000
*   /* PROCESS ELEMENT                                               */ 02776000
*   /*                                                               */ 02777000
*   /*****************************************************************/ 02778000
*                                                                  0908 02779000
*   IF MCBERLF(1)^=' '              /* RELFILE KEYWORD OPERAND       */ 02780000
*     THEN                                                         0908 02781000
@RF00898 L     @01,RECXMCB                                         0908 02782000
         CLI   MCBERLF(@01),C' '                                   0908 02783000
         BE    @RF00908                                            0908 02784000
*     CALL RCTPROC;                 /* PROCESS RELFILE OPERAND       */ 02785000
         BAL   @14,RCTPROC                                         0909 02786000
*   ELSE                                                           0910 02787000
*     IF MCBETXLB(1)=' '            /* ELEMENT NOT ON TXLIB          */ 02788000
*         &MCBELKLB(1)=' '          /* ELEMENT NOT ON LKLIB          */ 02789000
*         &MCBEDEL(1)=OFF           /* DELETE NOT SPECIFIED          */ 02790000
*       THEN                                                       0910 02791000
         B     @RC00908                                            0910 02792000
@RF00908 L     @15,RECXMCB                                         0910 02793000
         CLI   MCBETXLB(@15),C' '                                  0910 02794000
         BNE   @RF00910                                            0910 02795000
         CLI   MCBELKLB(@15),C' '                                  0910 02796000
         BNE   @RF00910                                            0910 02797000
         TM    MCBEDEL(@15),B'01000000'                            0910 02798000
         BNZ   @RF00910                                            0910 02799000
*       RECXPTXT=ON;                /* TEXT RECORDS ARE EXPECTED TO     02800000
*                                      FOLLOW THIS ELEMENT STATEMENT */ 02801000
         OI    RECXPTXT,B'00100000'                                0911 02802000
*   IF MCBTYPE=MCBMCUTP             /* ++MACUPD ELEMENT              */ 02803000
*       |MCBTYPE=MCBSCUTP           /* ++SRCUPD ELEMENT              */ 02804000
*     THEN                                                         0912 02805000
@RF00910 DS    0H                                                  0912 02806000
@RC00908 L     @15,RECXMCB                                         0912 02807000
         CLI   MCBTYPE(@15),8                                      0912 02808000
         BE    @RT00912                                            0912 02809000
         CLI   MCBTYPE(@15),9                                      0912 02810000
         BNE   @RF00912                                            0912 02811000
@RT00912 DS    0H                                                  0913 02812000
*     RECXPUPD=ON;                  /* INDICATE UPDATE TEXT EXPECTED */ 02813000
         OI    RECXPUPD,B'00001000'                                0913 02814000
*                                                                  0914 02815000
*/********************************************************************/ 02816000
*/*                                                                  */ 02817000
*/*  CHECK FOR INVALID ELEMENT COMBINATIONS AS FOLLOWS:              */ 02818000
*/*                                                                  */ 02819000
*/*              MOD  |  ZAP  |  SRC  |  SRCUPD  |  MAC  | MACUPD |  */ 02820000
*/*            |------|-------|-------|----------|-------|--------|  */ 02821000
*/*     MOD    |      |  INV  |  OK   |    OK    |  OK   |   OK   |  */ 02822000
*/*            |------|-------|-------|----------|-------|--------|  */ 02823000
*/*     ZAP    | INV  |       |  INV  |   INV    |  OK   |   OK   |  */ 02824000
*/*            |------|-------|-------|----------|-------|--------|  */ 02825000
*/*     SRC    |  OK  |  INV  |       |   INV    |  OK   |   OK   |  */ 02826000
*/*            |------|-------|-------|----------|-------|--------|  */ 02827000
*/*     SRCUPD |  OK  |  INV  |  INV  |          |  OK   |   OK   |  */ 02828000
*/*            |------|-------|-------|----------|-------|--------|  */ 02829000
*/*     MAC    |  OK  |  OK   |  OK   |    OK    |       |  INV   |  */ 02830000
*/*            |------|-------|-------|----------|-------|--------|  */ 02831000
*/*     MACUPD |  OK  |  OK   |  OK   |    OK    |  INV  |        |  */ 02832000
*/*            |------|-------|-------|----------|-------|--------|  */ 02833000
*/*                                                                  */ 02834000
*/********************************************************************/ 02835000
*                                                                  0914 02836000
*   DO MM=1 BY 1 TO DIM(INVELMN);   /* CLEAR INVELMN ARRAY           */ 02837000
@RF00912 LA    @15,1                                               0914 02838000
         STH   @15,MM                                              0914 02839000
@DL00914 DS    0H                                                  0915 02840000
*     INVELMN(MM)=ZERO;                                            0915 02841000
         SLR   @14,@14                                             0915 02842000
         STC   @14,INVELMN-1(@15)                                  0915 02843000
*   END;                                                           0916 02844000
*                                                                  0916 02845000
         AL    @15,@CF00041                                        0916 02846000
         STH   @15,MM                                              0916 02847000
         CH    @15,@CH00043                                        0916 02848000
         BNH   @DL00914                                            0916 02849000
*   /*****************************************************************/ 02850000
*   /*                                                               */ 02851000
*   /* INITIALIZE INVELNM ARRAY WITH IOPPIND VALUES FOR ELEMENTS     */ 02852000
*   /* WHICH ARE INVALID IN COMBINATION WITH THE ELEMENT BEING       */ 02853000
*   /* PROCESSED                                                     */ 02854000
*   /*                                                               */ 02855000
*   /*****************************************************************/ 02856000
*                                                                  0917 02857000
*   IF MCBTYPE=MCBMODTP             /* ++MOD ELEMENT                 */ 02858000
*     THEN                                                         0917 02859000
         L     @01,RECXMCB                                         0917 02860000
         CLI   MCBTYPE(@01),4                                      0917 02861000
         BNE   @RF00917                                            0917 02862000
*     DO;                                                          0918 02863000
*       INVELMN(1)=IOPPZAP;         /* ZAP TO ELEMENT IS INVALID     */ 02864000
         MVI   INVELMN,X'02'                                       0919 02865000
*       VPART#1=MSGMOD;             /* SET UP FOR ERROR MESSAGE      */ 02866000
         MVC   VPART#1(8),MSGMOD                                   0920 02867000
*     END;                                                         0921 02868000
*   IF MCBTYPE=MCBZAPTP             /* ++ZAP ELEMENT                 */ 02869000
*     THEN                                                         0922 02870000
@RF00917 L     @01,RECXMCB                                         0922 02871000
         CLI   MCBTYPE(@01),7                                      0922 02872000
         BNE   @RF00922                                            0922 02873000
*     DO;                                                          0923 02874000
*       INVELMN(1)=IOPPMOD;         /* MOD ELEMENT IS INVALID        */ 02875000
         MVI   INVELMN,X'01'                                       0924 02876000
*       INVELMN(2)=IOPPSRCR;        /* SRC ELEMENT IS INVALID        */ 02877000
         MVI   INVELMN+1,X'06'                                     0925 02878000
*       INVELMN(3)=IOPPSRCU;        /* SRCUPD TO ELEMENT IS INVALID  */ 02879000
         MVI   INVELMN+2,X'07'                                     0926 02880000
*       VPART#1=MSGZAP;             /* SET UP FOR ERROR MESSAGE      */ 02881000
         MVC   VPART#1(8),MSGZAP                                   0927 02882000
*     END;                                                         0928 02883000
*   IF MCBTYPE=MCBSCRTP             /* ++SRC ELEMENT                 */ 02884000
*     THEN                                                         0929 02885000
@RF00922 L     @01,RECXMCB                                         0929 02886000
         CLI   MCBTYPE(@01),6                                      0929 02887000
         BNE   @RF00929                                            0929 02888000
*     DO;                                                          0930 02889000
*       INVELMN(1)=IOPPZAP;         /* ZAP TO ELEMENT IS INVALID     */ 02890000
         MVI   INVELMN,X'02'                                       0931 02891000
*       INVELMN(2)=IOPPSRCU;        /* SRCUPD TO ELEMENT IS INVALID  */ 02892000
         MVI   INVELMN+1,X'07'                                     0932 02893000
*       VPART#1=MSGSRCR;            /* SET UP FOR ERROR MESSAGE      */ 02894000
         MVC   VPART#1(8),MSGSRCR                                  0933 02895000
*     END;                                                         0934 02896000
*   IF MCBTYPE=MCBSCUTP             /* ++SRCUPD ELEMENT              */ 02897000
*     THEN                                                         0935 02898000
@RF00929 L     @01,RECXMCB                                         0935 02899000
         CLI   MCBTYPE(@01),9                                      0935 02900000
         BNE   @RF00935                                            0935 02901000
*     DO;                                                          0936 02902000
*       INVELMN(1)=IOPPZAP;         /* ZAP TO ELEMENT IS INVALID     */ 02903000
         MVI   INVELMN,X'02'                                       0937 02904000
*       INVELMN(2)=IOPPSRCR;        /* SRC ELEMENT IS INVALID        */ 02905000
         MVI   INVELMN+1,X'06'                                     0938 02906000
*       VPART#1=MSGSRCU;            /* SET UP FOR ERROR MESSAGE      */ 02907000
         MVC   VPART#1(8),MSGSRCU                                  0939 02908000
*     END;                                                         0940 02909000
*   IF MCBTYPE=MCBMCRTP             /* ++MAC ELEMENT                 */ 02910000
*     THEN                                                         0941 02911000
@RF00935 L     @01,RECXMCB                                         0941 02912000
         CLI   MCBTYPE(@01),5                                      0941 02913000
         BNE   @RF00941                                            0941 02914000
*     DO;                                                          0942 02915000
*       INVELMN(1)=IOPPMACU;        /* MACUPD TO ELEMENT IS INVALID  */ 02916000
         MVI   INVELMN,X'05'                                       0943 02917000
*       VPART#1=MSGMACR;            /* SET UP FOR ERROR MESSAGE      */ 02918000
         MVC   VPART#1(8),MSGMACR                                  0944 02919000
*     END;                                                         0945 02920000
*   IF MCBTYPE=MCBMCUTP             /* ++MACUPD ELEMENT              */ 02921000
*     THEN                                                         0946 02922000
@RF00941 L     @01,RECXMCB                                         0946 02923000
         CLI   MCBTYPE(@01),8                                      0946 02924000
         BNE   @RF00946                                            0946 02925000
*     DO;                                                          0947 02926000
*       INVELMN(1)=IOPPMACR;        /* MAC ELEMENT IS INVALID        */ 02927000
         MVI   INVELMN,X'04'                                       0948 02928000
*       VPART#1=MSGMACU;            /* SET UP FOR ERROR MESSAGE      */ 02929000
         MVC   VPART#1(8),MSGMACU                                  0949 02930000
*     END;                                                         0950 02931000
*   RESPECIFY                                                      0951 02932000
*     HMASMIOP BASED(RECXIOPP);     /* ADDRESS SYSMOD IOP            */ 02933000
@RF00946 DS    0H                                                  0952 02934000
*                                                                  0952 02935000
*   /*****************************************************************/ 02936000
*   /*                                                               */ 02937000
*   /* GO THRU ALL IOP SUBENTRIES                                    */ 02938000
*   /*                                                               */ 02939000
*   /*****************************************************************/ 02940000
*                                                                  0952 02941000
*   DO MM=1 BY 1 WHILE IOPPTFND(MM)^=IOPEOLST;                     0952 02942000
         LA    @15,1                                               0952 02943000
         STH   @15,MM                                              0952 02944000
         B     @DE00952                                            0952 02945000
@DL00952 DS    0H                                                  0953 02946000
*     IF IOPPMODS(MM)=MCBENAME      /* SUBENTRY NAME MATCHES CURRENT    02947000
*                                      ELEMENT                       */ 02948000
*       THEN                                                       0953 02949000
         LH    @15,MM                                              0953 02950000
         MH    @15,@CH00034                                        0953 02951000
         L     @01,RECXIOPP                                        0953 02952000
         ALR   @01,@15                                             0953 02953000
         L     @15,RECXMCB                                         0953 02954000
         CLC   IOPPMODS-9(8,@01),MCBENAME(@15)                     0953 02955000
         BNE   @RF00953                                            0953 02956000
*       DO;                                                        0954 02957000
*                                                                  0954 02958000
*         /***********************************************************/ 02959000
*         /*                                                         */ 02960000
*         /* GO THRU THE INVELMN ARRAY TO SEE IF ENTRY TYPE IN IOP   */ 02961000
*         /* MATCHES AN INVALID ENTRY TYPE IN INVELMN                */ 02962000
*         /*                                                         */ 02963000
*         /***********************************************************/ 02964000
*                                                                  0955 02965000
*         DO NN=1 BY 1 TO DIM(INVELMN);                            0955 02966000
         LA    @15,1                                               0955 02967000
         STH   @15,NN                                              0955 02968000
@DL00955 DS    0H                                                  0956 02969000
*           IF IOPPIND(MM)=INVELMN(NN)/* IOP SUB-ENTRY MATCHES     0956 02970000
*                                      INVALID TYPE                  */ 02971000
*             THEN                                                 0956 02972000
         LH    @14,MM                                              0956 02973000
         MH    @14,@CH00034                                        0956 02974000
         L     @01,RECXIOPP                                        0956 02975000
         SLR   @00,@00                                             0956 02976000
         IC    @00,IOPPIND-9(@14,@01)                              0956 02977000
         LA    @14,INVELMN-1(@15)                                  0956 02978000
         MVC   @ZT00003+3(1),0(@14)                                0956 02979000
         C     @00,@ZT00003                                        0956 02980000
         BNE   @RF00956                                            0956 02981000
*             DO;                                                  0957 02982000
*               CALL OPRNDKEY(INVELMN(NN),VPART#2);/* TRANSLATE IOP     02983000
*                                      SUB-ENTRY TYPE INTO EBCDIC  0958 02984000
*                                      STRING                        */ 02985000
         LA    @15,INVELMN-1(@15)                                  0958 02986000
         ST    @15,@AL00001                                        0958 02987000
         LA    @15,VPART#2                                         0958 02988000
         ST    @15,@AL00001+4                                      0958 02989000
         LA    @01,@AL00001                                        0958 02990000
         BAL   @14,OPRNDKEY                                        0958 02991000
*               VPART#3=MCBENAME;   /* SETUP ELEMENT NAME FOR MSG    */ 02992000
         L     @01,RECXMCB                                         0959 02993000
         MVC   VPART#3(8),MCBENAME(@01)                            0959 02994000
*               MGPTYPE=MGPERR;     /* STOP-SYSMOD ERROR             */ 02995000
         MVI   MGPTYPE,X'03'                                       0960 02996000
*               CALL ERRMSG(HMA378I,NOPART,NOPART);/* ISSUE MSG      */ 02997000
         LA    @01,@AL00961                                        0961 02998000
         BAL   @14,ERRMSG                                          0961 02999000
*               RECXSYSF=ON;        /* SET TO FLUSH SYSMOD           */ 03000000
         OI    RECXSYSF,B'00010000'                                0962 03001000
*               RECXGSMP->GTPBUFAD->GSMSYNTX=ON;/* SET SYNTAX ERROR     03002000
*                                      IN SUMMARY RECORD             */ 03003000
         L     @01,RECXGSMP                                        0963 03004000
         L     @01,GTPBUFAD(,@01)                                  0963 03005000
         OI    GSMSYNTX(@01),B'01000000'                           0963 03006000
*             END;                                                 0964 03007000
*         END;                                                     0965 03008000
@RF00956 LA    @15,1                                               0965 03009000
         AH    @15,NN                                              0965 03010000
         STH   @15,NN                                              0965 03011000
         CH    @15,@CH00043                                        0965 03012000
         BNH   @DL00955                                            0965 03013000
*       END;                                                       0966 03014000
*   END;                                                           0967 03015000
@RF00953 LA    @15,1                                               0967 03016000
         AH    @15,MM                                              0967 03017000
         STH   @15,MM                                              0967 03018000
@DE00952 LH    @15,MM                                              0967 03019000
         MH    @15,@CH00034                                        0967 03020000
         L     @01,RECXIOPP                                        0967 03021000
         SLR   @14,@14                                             0967 03022000
         IC    @14,IOPPTFND-9(@15,@01)                             0967 03023000
         CH    @14,@CH00766                                        0967 03024000
         BNE   @DL00952                                            0967 03025000
*   RETURN;                                                        0968 03026000
@EL00008 DS    0H                                                  0968 03027000
@EF00008 DS    0H                                                  0968 03028000
@ER00008 LM    @14,@12,@SA00008                                    0968 03029000
         BR    @14                                                 0968 03030000
*   END ELEMPROC;                                                  0969 03031000
*                                                                  0970 03032000
*/********************************************************************/ 03033000
*/*                                                                  */ 03034000
*/*    TEXTPROC - PROCESS NON-MODIFICATION CONTROL STATEMENT RECORDS */ 03035000
*/*                                                                  */ 03036000
*/*        1. CHECK THAT IN-LINE TEXT RECORDS ARE EXPECTED           */ 03037000
*/*           (RECXPTXT=ON).  IF NOT, ISSUE HMA273I AND SET          */ 03038000
*/*           TO "FLUSH" THE CURRENT SYSMOD.                         */ 03039000
*/*                                                                  */ 03040000
*/*        2. SET RECXTXTF=ON TO INDICATE THAT IN-LINE TEXT RECORDS  */ 03041000
*/*           HAVE BEEN FOUND FOR THE CURRENT ELEMENT.               */ 03042000
*/*                                                                  */ 03043000
*/*        3. IF PROCESSING UPDATE-TYPE ELEMENT TEXT RECORDS         */ 03044000
*/*           (RECXPUPD=ON) AND COLUMNS 1-2 CONTAIN "./", CALL       */ 03045000
*/*           UPDCHK TO INSURE THAT A SMP-RESTRICTED IEBUPDTE        */ 03046000
*/*           CONTROL STATEMENT HAS NOT BEEN SUPPLIED.               */ 03047000
*/*                                                                  */ 03048000
*/********************************************************************/ 03049000
*                                                                  0970 03050000
*TEXTPROC:                                                         0970 03051000
*   PROC;                                                          0970 03052000
*                                                                  0970 03053000
TEXTPROC STM   @14,@12,@SA00009                                    0970 03054000
*   /*****************************************************************/ 03055000
*   /*                                                               */ 03056000
*   /* CHECK FOR CONSTRUCTION ERRORS                                 */ 03057000
*   /*                                                               */ 03058000
*   /*****************************************************************/ 03059000
*                                                                  0971 03060000
*   IF RECXPTXT=ON THEN                                            0971 03061000
         TM    RECXPTXT,B'00100000'                                0971 03062000
         BNO   @RF00971                                            0971 03063000
*     DO;                                                          0972 03064000
*                                                                  0972 03065000
*       /*************************************************************/ 03066000
*       /*                                                           */ 03067000
*       /* PROCESSING IN-LINE TEXT RECORDS                           */ 03068000
*       /*                                                           */ 03069000
*       /*************************************************************/ 03070000
*                                                                  0973 03071000
*       RECXTXTF=ON;                /* INDICATE TEXT RECORDS FOUND   */ 03072000
         OI    RECXTXTF,B'00010000'                                0973 03073000
*       CALL WRITEPTS(NOTCNTRL);    /* WRITE RECORD TO SMPPTS TEXT 0974 03074000
*                                      ENTRY ONLY (NOT SMPOUT).      */ 03075000
         LA    @01,@AL00974                                        0974 03076000
         BAL   @14,WRITEPTS                                        0974 03077000
*       IF RECXPUPD=ON              /* ++UPDTE OR ++SRCUPD TEXT ?    */ 03078000
*         THEN                                                     0975 03079000
         TM    RECXPUPD,B'00001000'                                0975 03080000
         BNO   @RF00975                                            0975 03081000
*         CALL UPDCHK1;             /* YES ... CHECK EACH RECORD     */ 03082000
         BAL   @14,UPDCHK1                                         0976 03083000
*     END;                                                         0977 03084000
*   ELSE                                                           0978 03085000
*     DO;                                                          0978 03086000
*                                                                  0978 03087000
         B     @RC00971                                            0978 03088000
@RF00971 DS    0H                                                  0979 03089000
*       /*************************************************************/ 03090000
*       /*                                                           */ 03091000
*       /* NOT PROCESSING IN-LINE TEXT RECORDS                       */ 03092000
*       /*                                                           */ 03093000
*       /*************************************************************/ 03094000
*                                                                  0979 03095000
*       IF DUP347=OFF               /* HMA347/HMA327 HAS NOT ALREADY    03096000
*                                      BEEN ISSUED FOR THESE RECORDS */ 03097000
*           &MPDRETRN=0             /* NO PARSE ERROR ON LAST MOD. 0979 03098000
*                                      CNTRL. STMT.                  */ 03099000
*         THEN                                                     0979 03100000
         TM    DUP347,B'00001000'                                  0979 03101000
         BNZ   @RF00979                                            0979 03102000
         L     @15,MPDRETRN                                        0979 03103000
         LTR   @15,@15                                             0979 03104000
         BNZ   @RF00979                                            0979 03105000
*         DO;                                                      0980 03106000
*                                                                  0980 03107000
*           /*********************************************************/ 03108000
*           /*                                                       */ 03109000
*           /* ISSUE HMA347I OR HMA327 AND FLUSH SYSMOD              */ 03110000
*           /*                                                       */ 03111000
*           /*********************************************************/ 03112000
*                                                                  0981 03113000
*           RECXSYSF=ON;            /* FLUSH THE CURRENT SYSMOD      */ 03114000
         OI    RECXSYSF,B'00010000'                                0981 03115000
*           DUP347=ON;              /* HMA347I HAS BEEN ISSUED       */ 03116000
         OI    DUP347,B'00001000'                                  0982 03117000
*           CALL WRITEPTS(SMCNTRL); /* WRITE STATEMENT TO SMPOUT     */ 03118000
         LA    @01,@AL00983                                        0983 03119000
         BAL   @14,WRITEPTS                                        0983 03120000
*           MGPTYPE=MGPERR;         /* STOP-SYSMOD ERROR             */ 03121000
         MVI   MGPTYPE,X'03'                                       0984 03122000
*           IF RECXPELM=OFF         /* NOT PROCESSING ELEMENT STMTS  */ 03123000
*             THEN                                                 0985 03124000
         TM    RECXPELM,B'00000100'                                0985 03125000
         BNZ   @RF00985                                            0985 03126000
*             CALL ERRMSG(HMA347I,NOPART,NOPART);/* INVALID RECORD 0986 03127000
*                                      ... MODIFICATION CNTRL STMT 0986 03128000
*                                      EXPECTED.                     */ 03129000
         LA    @01,@AL00986                                        0986 03130000
         BAL   @14,ERRMSG                                          0986 03131000
*           ELSE                                                   0987 03132000
*             CALL ERRMSG(HMA327I,NOPART,NOPART);/* INPUT TEXT AFTER    03133000
*                                      LKLIB, TXLIB OR RELFILE       */ 03134000
         B     @RC00985                                            0987 03135000
@RF00985 LA    @01,@AL00987                                        0987 03136000
         BAL   @14,ERRMSG                                          0987 03137000
*           GSMSYNTX=ON;            /* SYNTAX/CONSTRUCTION ERROR     */ 03138000
@RC00985 LA    @15,GTASM                                           0988 03139000
         OI    GSMSYNTX(@15),B'01000000'                           0988 03140000
*         END;                                                     0989 03141000
*       ELSE                                                       0990 03142000
*         ;                         /* THE SYSMOD IS ALREADY BEING 0990 03143000
*                                      FLUSHED. AN APPROPRIATE     0990 03144000
*                                      MESSAGE HAS ALREADY BEEN    0990 03145000
*                                      ISSUED.                       */ 03146000
@RF00979 DS    0H                                                  0991 03147000
*     END;                                                         0991 03148000
*   RETURN;                                                        0992 03149000
@EL00009 DS    0H                                                  0992 03150000
@EF00009 DS    0H                                                  0992 03151000
@ER00009 LM    @14,@12,@SA00009                                    0992 03152000
         BR    @14                                                 0992 03153000
*   END TEXTPROC;                                                  0993 03154000
         B     @EL00009                                            0993 03155000
*                                                                  0994 03156000
*/********************************************************************/ 03157000
*/*                                                                  */ 03158000
*/*  PTSCHK -                                                        */ 03159000
*/*                                                                  */ 03160000
*/*      SEARCH THE PTS FOR A PTS PTF ENTRY MATCHING THE INPUT       */ 03161000
*/*      PARAMETER, SYSMNAME.                                        */ 03162000
*/*                                                                  */ 03163000
*/*      THIS PROCEDURE USES THE FOLLOWING IOPS:                     */ 03164000
*/*        RECXIOPG - GENERAL USE IOP                                */ 03165000
*/*                                                                  */ 03166000
*/*      SET RECXSYSF "ON", GSMRRCVD "ON" AND MCSCHECK "OFF" IF      */ 03167000
*/*      THE SYSMOD PASSED IS FOUND ON THE PTS (NOT IN ERROR).       */ 03168000
*/*                                                                  */ 03169000
*/*      RECXMAX WILL BE SET IF THE RETURN FROM HMASMIO IS           */ 03170000
*/*      GREATER THAN IOPNOTFD (NOT FOUND).                          */ 03171000
*/*                                                                  */ 03172000
*/********************************************************************/ 03173000
*                                                                  0994 03174000
*PTSCHK:                                                           0994 03175000
*   PROC(SYSMNAME);                                                0994 03176000
PTSCHK   STM   @14,@12,@SA00010                                    0994 03177000
         MVC   @PC00010(4),0(@01)                                  0994 03178000
*   DCL                                                            0995 03179000
*     SYSMNAME CHAR(7);             /* SYSMOD NAME                   */ 03180000
*   RESPECIFY                                                      0996 03181000
*     HMASMIOP BASED(RECXIOPG);     /* SET UP TO USE GENERAL USE IOP */ 03182000
*                                                                  0997 03183000
*   /*****************************************************************/ 03184000
*   /*                                                               */ 03185000
*   /* START SEARCHING PTS                                           */ 03186000
*   /*                                                               */ 03187000
*   /*****************************************************************/ 03188000
*                                                                  0997 03189000
*   IOPFUNCT=IOPBLDL;               /* DIRECTORY ONLY LOCATE         */ 03190000
         L     @15,RECXIOPG                                        0997 03191000
         MVI   IOPFUNCT(@15),X'04'                                 0997 03192000
*   IOPDSID=IOPPTS;                 /* DATA SET IS PTS               */ 03193000
         MVI   IOPDSID(@15),X'06'                                  0998 03194000
*   IOPNAME=SYSMNAME;               /* ENTRY NAME IS SYSMOD FOR WHICH   03195000
*                                      WE ARE LOOKING                */ 03196000
         MVI   IOPNAME+7(@15),C' '                                 0999 03197000
         L     @14,@PC00010                                        0999 03198000
         MVC   IOPNAME(7,@15),SYSMNAME(@14)                        0999 03199000
*   IOPTYPE=IOPSMD;                 /* ENTRY TYPE IS PTF             */ 03200000
         MVI   IOPTYPE(@15),X'0B'                                  1000 03201000
*   CALL HMASMIO(HMASMIOP);                                        1001 03202000
         ST    @15,@AL00001                                        1001 03203000
         L     @15,@CV01703                                        1001 03204000
         LA    @01,@AL00001                                        1001 03205000
         BALR  @14,@15                                             1001 03206000
*   IF IOPRETRN=IOPGOOD THEN                                       1002 03207000
         L     @15,RECXIOPG                                        1002 03208000
         CLI   IOPRETRN(@15),0                                     1002 03209000
         BNE   @RF01002                                            1002 03210000
*     DO;                                                          1003 03211000
*                                                                  1003 03212000
*       /*************************************************************/ 03213000
*       /*                                                           */ 03214000
*       /* PTS PTF ENTRY FOUND FOR SYSMOD                            */ 03215000
*       /*                                                           */ 03216000
*       /*************************************************************/ 03217000
*                                                                  1004 03218000
*       IF IOPERROR=OFF             /* NOT "IN ERROR"                */ 03219000
*         THEN                                                     1004 03220000
         TM    IOPERROR(@15),B'00010000'                           1004 03221000
         BNZ   @RF01004                                            1004 03222000
*         DO;                                                      1005 03223000
*                                                                  1005 03224000
*           /*********************************************************/ 03225000
*           /*                                                       */ 03226000
*           /* SET FLAGS IN RECXPARM AND GTA SUMMARY RECORD          */ 03227000
*           /*                                                       */ 03228000
*           /*********************************************************/ 03229000
*                                                                  1006 03230000
*           RECXSYSF=ON;            /* SET FLUSH INDICATOR           */ 03231000
         OI    RECXSYSF,B'00010000'                                1006 03232000
*           GSMRCVD=ON;             /* ALREADY ON SMPPTS DATASET     */ 03233000
         LA    @15,GTASM                                           1007 03234000
         OI    GSMRCVD(@15),B'00100000'                            1007 03235000
*           MCSCHECK=OFF;           /* SUPPRESS MOD.CNTL.STMT. CHECKS*/ 03236000
         NI    MCSCHECK,B'11111101'                                1008 03237000
*         END;                                                     1009 03238000
*     END;                                                         1010 03239000
@RF01004 DS    0H                                                  1011 03240000
*   IF IOPRETRN>IOPNOTFD            /* TERMINATING I/O ERROR         */ 03241000
*     THEN                                                         1011 03242000
@RF01002 L     @15,RECXIOPG                                        1011 03243000
         CLI   IOPRETRN(@15),4                                     1011 03244000
         BNH   @RF01011                                            1011 03245000
*     DO;                                                          1012 03246000
*                                                                  1012 03247000
*       /*************************************************************/ 03248000
*       /*                                                           */ 03249000
*       /* I/O ERROR ... TERMINATING                                 */ 03250000
*       /*                                                           */ 03251000
*       /*************************************************************/ 03252000
*                                                                  1013 03253000
*       RECXMAX=MAX(RECXMAX,IOPRETRN);                             1013 03254000
         L     @14,RECXMAX                                         1013 03255000
         SLR   @07,@07                                             1013 03256000
         IC    @07,IOPRETRN(,@15)                                  1013 03257000
         CR    @14,@07                                             1013 03258000
         BNL   *+6                                                      03259000
         LR    @14,@07                                             1013 03260000
         ST    @14,RECXMAX                                         1013 03261000
*       RECXSYSF=ON;                /* FLUSH SYSMOD                  */ 03262000
         OI    RECXSYSF,B'00010000'                                1014 03263000
*       GSMSIOE=ON;                 /* I/O ERROR ON SMP DATASET      */ 03264000
         LA    @15,GTASM                                           1015 03265000
         OI    GSMSIOE(@15),B'00000100'                            1015 03266000
*     END;                                                         1016 03267000
*   RETURN;                                                        1017 03268000
@EL00010 DS    0H                                                  1017 03269000
@EF00010 DS    0H                                                  1017 03270000
@ER00010 LM    @14,@12,@SA00010                                    1017 03271000
         BR    @14                                                 1017 03272000
*   END PTSCHK;                                                    1018 03273000
         B     @EL00010                                            1018 03274000
*                                                                  1019 03275000
*/********************************************************************/ 03276000
*/*                                                                  */ 03277000
*/*    READ -                                                        */ 03278000
*/*                                                                  */ 03279000
*/*    READ SYSTEM MODIFICATION CONTROL CARDS AND SYSMOD TEXT RECORDS*/ 03280000
*/*    FROM SMPPTFIN.                                                */ 03281000
*/*                                                                  */ 03282000
*/*    *  READ FROM PTFIN USING HMASMCRD.                            */ 03283000
*/*                                                                  */ 03284000
*/*    *  IF USER-EXIT RETURN CODE IS ENCOUNTERED:                   */ 03285000
*/*                                                                  */ 03286000
*/*       *  SAVE RETURN CODE IN READRTN                             */ 03287000
*/*                                                                  */ 03288000
*/*    *  IF HMASMCRD RETURN CODE  IS ENCOUNTERED:                   */ 03289000
*/*                                                                  */ 03290000
*/*       *  SAVE RETURN CODE IN READRTN                             */ 03291000
*/*                                                                  */ 03292000
*/*       *  FOR CRPEOF (END-OF-FILE) ---> RECXPEOF = ON             */ 03293000
*/*                                                                  */ 03294000
*/*       *  FOR >CRPEOF (TERMINATING ERRORS) ---> RECXPROC = STOP   */ 03295000
*/*                                           ---> RECXSYSF = ON     */ 03296000
*/*                                           ---> RECXMAX=CRPRETRN  */ 03297000
*/*                                                                  */ 03298000
*/********************************************************************/ 03299000
*                                                                  1019 03300000
*READ:                                                             1019 03301000
*   PROC;                                                          1019 03302000
READ     STM   @14,@12,@SA00011                                    1019 03303000
*   IF RECXPEOF=OFF&RECXPROC^=STOP THEN                            1020 03304000
         TM    RECXPROC,B'10000000'                                1020 03305000
         BNO   @RF01020                                            1020 03306000
         TM    RECXPEOF,B'00100000'                                1020 03307000
         BNZ   @RF01020                                            1020 03308000
*     DO;                                                          1021 03309000
*                                                                  1021 03310000
*       /*************************************************************/ 03311000
*       /*                                                           */ 03312000
*       /* SET UP HMASMCRP PARAMETER LIST AND CALL HMASMCRD TO READ  */ 03313000
*       /* FROM SMPPTFIN                                             */ 03314000
*       /*                                                           */ 03315000
*       /*************************************************************/ 03316000
*                                                                  1022 03317000
*       CRPBFPRM=OFF;               /* BUFFER NOT PRIMED             */ 03318000
*       CRPPTS=OFF;                 /* DO NOT WRITE TO SMPPTS        */ 03319000
*       CRPLOG=OFF;                 /* DO NOT WRITE TO SMPLOG        */ 03320000
*       CRPPRINT=OFF;               /* DO NOT WRITE TO SMPOUT        */ 03321000
*       CRPOTHER=OFF;               /* DO NOT WRITE TO CRDOUTDS      */ 03322000
*       CRPSCNCL=OFF;               /* NOT CALL FROM SCAN            */ 03323000
         NI    CRPBFPRM,B'01000010'                                1027 03324000
*       CRPSCPAD=0;                 /* SCAN PARM LIST - N/A          */ 03325000
         SLR   @15,@15                                             1028 03326000
         ST    @15,CRPSCPAD                                        1028 03327000
*       CRPUXNUM=UXPUX001;          /* SET RECEIVE USER EXIT         */ 03328000
         MVI   CRPUXNUM,X'01'                                      1029 03329000
*       CALL HMASMCRD(HMASMCRP);    /* GENERAL GET ROUTINE           */ 03330000
         L     @15,@CV01708                                        1030 03331000
         LA    @01,@AL01030                                        1030 03332000
         BALR  @14,@15                                             1030 03333000
*       RESPECIFY                                                  1031 03334000
*         REG15 RSTD;                                              1031 03335000
*       READRTN=REG15;              /* SAVE RETURN CODE FROM HMASMCRD   03336000
*                                      ROUTINE                       */ 03337000
         ST    REG15,READRTN                                       1032 03338000
*       RESPECIFY                                                  1033 03339000
*         REG15 UNRSTD;                                            1033 03340000
*       IF READRTN=CRPEOF THEN                                     1034 03341000
*                                                                  1034 03342000
         L     @15,READRTN                                         1034 03343000
         CH    @15,@CH00092                                        1034 03344000
         BNE   @RF01034                                            1034 03345000
*         /***********************************************************/ 03346000
*         /*                                                         */ 03347000
*         /* EOF FROM HMASMCRD ROUTINE                               */ 03348000
*         /*                                                         */ 03349000
*         /***********************************************************/ 03350000
*                                                                  1035 03351000
*         RECXPEOF=ON;              /* SET END-OF-FILE FLAG          */ 03352000
         OI    RECXPEOF,B'00100000'                                1035 03353000
*       IF READRTN>CRPEOF&CRPTRMEX=OFF THEN                        1036 03354000
@RF01034 L     @15,READRTN                                         1036 03355000
         CH    @15,@CH00092                                        1036 03356000
         BNH   @RF01036                                            1036 03357000
         TM    CRPTRMEX,B'01000000'                                1036 03358000
         BNZ   @RF01036                                            1036 03359000
*         DO;                                                      1037 03360000
*                                                                  1037 03361000
*           /*********************************************************/ 03362000
*           /*                                                       */ 03363000
*           /* TERMINATING ERROR FROM CRD ROUTINE ... NOT USER EXIT  */ 03364000
*           /*                                                       */ 03365000
*           /*********************************************************/ 03366000
*                                                                  1038 03367000
*           RECXPROC=STOP;          /* STOP RECEIVE PROCESSING       */ 03368000
*           RECXSYSF=ON;            /* FLUSH CURRENT SYSMOD          */ 03369000
         OI    RECXSYSF,B'00010000'                                1039 03370000
         NI    RECXPROC,B'01111111'                                1039 03371000
*           GSMSIOE=ON;             /* I/O ERROR ON SMP DATASET      */ 03372000
         LA    @14,GTASM                                           1040 03373000
         OI    GSMSIOE(@14),B'00000100'                            1040 03374000
*           RECXMAX=MAX(RECXMAX,READRTN);/* HMASMCRD'S RETURN CODE   */ 03375000
         L     @14,RECXMAX                                         1041 03376000
         CR    @14,@15                                             1041 03377000
         BNL   *+6                                                      03378000
         LR    @14,@15                                             1041 03379000
         ST    @14,RECXMAX                                         1041 03380000
*         END;                                                     1042 03381000
*     END;                                                         1043 03382000
*   RETURN;                                                        1044 03383000
@EL00011 DS    0H                                                  1044 03384000
@EF00011 DS    0H                                                  1044 03385000
@ER00011 LM    @14,@12,@SA00011                                    1044 03386000
         BR    @14                                                 1044 03387000
*   END READ;                                                      1045 03388000
         B     @EL00011                                            1045 03389000
*                                                                  1046 03390000
*/********************************************************************/ 03391000
*/*                                                                  */ 03392000
*/*    CHKBUF - SCAN INPUT BUFFER (CRDBUFFR) AND RETURN WITH AN      */ 03393000
*/*             INDICATION OF THE TYPE OF RECORD IN CHKTYPE.         */ 03394000
*/*                                                                  */ 03395000
*/*             CHKTYPE                                              */ 03396000
*/*             -------        ----------------------------------    */ 03397000
*/*                                                                  */ 03398000
*/*               'N' -------  NOT SMP MODIFICATION CNTRL STATEMENT. */ 03399000
*/*                                                                  */ 03400000
*/*               'C' -------  SMP MODIFICATION CNTRL STATEMENT      */ 03401000
*/*                            (OTHER THAN ++FUNCTION, ++PTF,        */ 03402000
*/*                             ++USERMOD OR ++APAR).                */ 03403000
*/*                                                                  */ 03404000
*/*               'H' -------  ++FUNCTION, ++PTF, ++USERMOD OR       */ 03405000
*/*                            ++APAR MODIFICATION CNTRL STATEMENT.  */ 03406000
*/*                                                                  */ 03407000
*/*                            CHKSMD# - 'Y' ==> SYSMOD-ID FOUND     */ 03408000
*/*                                                                  */ 03409000
*/*                            CHKSMDID - SYSMOD-ID OR "NULLPTF#"    */ 03410000
*/*                                                                  */ 03411000
*/********************************************************************/ 03412000
*                                                                  1046 03413000
*CHKBUF:                                                           1046 03414000
*   PROC;                                                          1046 03415000
CHKBUF   STM   @14,@12,@SA00012                                    1046 03416000
*   CHKSMD#=NO;                     /* SYSMOD # NOT FOUND            */ 03417000
         MVI   CHKSMD#,C'N'                                        1047 03418000
*   IF CRPBUFFR(1:2)^='++' THEN                                    1048 03419000
         CLC   CRPBUFFR(2),@CC01964                                1048 03420000
         BE    @RF01048                                            1048 03421000
*     CHKTYPE=NOTCNTRL;                                            1049 03422000
         MVI   CHKTYPE,C'N'                                        1049 03423000
*   ELSE                                                           1050 03424000
*     DO;                                                          1050 03425000
*                                                                  1050 03426000
         B     @RC01048                                            1050 03427000
@RF01048 DS    0H                                                  1051 03428000
*       /*************************************************************/ 03429000
*       /*                                                           */ 03430000
*       /* THE INPUT BUFFER (CRPBUFFR) CONTAINS A MODIFICATION       */ 03431000
*       /* CONTROL STATEMENT WHICH MUST BE SCANNED.                  */ 03432000
*       /*                                                           */ 03433000
*       /*************************************************************/ 03434000
*                                                                  1051 03435000
*       CHKTYPE=SMCNTRL;            /* SET THE CHKTYPE TO "SMCNTRL"     03436000
*                                      INITIALLY. IF THE RECORD IS 1051 03437000
*                                      FOUND TO CONTAIN A SYSMOD   1051 03438000
*                                      HEADER, CHKTYPE WILL BE SET TO   03439000
*                                      "SMHEAD" BY THE DSCAN ROUT  1051 03440000
*                                      PROCEDURE, SMHDTYPE.          */ 03441000
         MVI   CHKTYPE,C'C'                                        1051 03442000
*       CHKKEY=NO;                  /* SET INITIALLY TO "NO". IF THE    03443000
*                                      RECORD IS FOUND TO CONTAIN ANY   03444000
*                                      KEYWORD FOLLOWING THE '++', 1052 03445000
*                                      CHKKEY WILL BE SET TO "YES" BY   03446000
*                                      THE DSCAN ROUT ROUTINES.      */ 03447000
*                                                                  1052 03448000
         MVI   CHKKEY,C'N'                                         1052 03449000
*       /*************************************************************/ 03450000
*       /*                                                           */ 03451000
*       /* HMASMSCN PARAMETER INITIALIZATION (HMASMSCP)              */ 03452000
*       /*                                                           */ 03453000
*       /*************************************************************/ 03454000
*                                                                  1053 03455000
*       SCPCHAR=ADDR(CRPBUFFR);     /* INPUT BUFFER                  */ 03456000
         L     @15,SCPPTR                                          1053 03457000
         LA    @14,CRPBUFFR                                        1053 03458000
         ST    @14,SCPCHAR(,@15)                                   1053 03459000
*       SCPINLN=LENGTH(CRPBFCTL);   /* LENGTH OF SMP CNTRL STATEMENT */ 03460000
         MVC   SCPINLN(2,@15),@CH00431                             1054 03461000
*       SCPSRCH=ADDR(SYSMSCAN);     /* DSCANS FOR SYSMOD HEADERS     */ 03462000
         LA    @14,SYSMSCAN                                        1055 03463000
         ST    @14,SCPSRCH(,@15)                                   1055 03464000
*       SCPIORTN=0;                 /* DO NOT GO TO NEXT RECORD      */ 03465000
         SLR   @14,@14                                             1056 03466000
         ST    @14,SCPIORTN(,@15)                                  1056 03467000
*       SCPEOR=ZERO;                /* CLEAR END OF RECORD FLAG      */ 03468000
         MVI   SCPEOR(@15),X'00'                                   1057 03469000
*       SCPCOMNT=ON;                /* SET SKIP-BY COMMENTS DURING 1058 03470000
*                                      SCAN                          */ 03471000
*                                                                  1058 03472000
         OI    SCPCOMNT(@15),B'00100000'                           1058 03473000
*       /*************************************************************/ 03474000
*       /*                                                           */ 03475000
*       /* SCAN MODIFICATION CONTROL STATEMENT                       */ 03476000
*       /*                                                           */ 03477000
*       /*************************************************************/ 03478000
*                                                                  1059 03479000
*       CALL HMASMSCN(HMASMSCP);    /* SCAN STATEMENT                */ 03480000
         ST    @15,@AL00001                                        1059 03481000
         L     @15,@CV01705                                        1059 03482000
         LA    @01,@AL00001                                        1059 03483000
         BALR  @14,@15                                             1059 03484000
*       IF SCPRETRN>SCPBAD          /* TERMINATING ERR. FROM SCN     */ 03485000
*         THEN                                                     1060 03486000
         L     @15,SCPPTR                                          1060 03487000
         CLI   SCPRETRN(@15),4                                     1060 03488000
         BNH   @RF01060                                            1060 03489000
*         DO;                                                      1061 03490000
*                                                                  1061 03491000
*           /*********************************************************/ 03492000
*           /*                                                       */ 03493000
*           /* TERMINATING ERROR FROM SCAN ... FLUSH SYSMOD          */ 03494000
*           /*                                                       */ 03495000
*           /*********************************************************/ 03496000
*                                                                  1062 03497000
*           RECXSYSF=ON;            /* FLUSH THE SYSMOD              */ 03498000
         OI    RECXSYSF,B'00010000'                                1062 03499000
*           RECXMAX=MAX(RECXMAX,SCPRETRN);/* SAVE HIGH RETURN CODE   */ 03500000
         L     @14,RECXMAX                                         1063 03501000
         SLR   @07,@07                                             1063 03502000
         IC    @07,SCPRETRN(,@15)                                  1063 03503000
         CR    @14,@07                                             1063 03504000
         BNL   *+6                                                      03505000
         LR    @14,@07                                             1063 03506000
         ST    @14,RECXMAX                                         1063 03507000
*         END;                                                     1064 03508000
*       IF CHKKEY=NO                /* NO MCS KEYWORD FOUND          */ 03509000
*           &SCPRETRN<=SCPBAD       /* NOT TERMINATING ERR. FROM SCN */ 03510000
*         THEN                                                     1065 03511000
@RF01060 CLI   CHKKEY,C'N'                                         1065 03512000
         BNE   @RF01065                                            1065 03513000
         L     @01,SCPPTR                                          1065 03514000
         CLI   SCPRETRN(@01),4                                     1065 03515000
         BH    @RF01065                                            1065 03516000
*         DO;                                                      1066 03517000
*                                                                  1066 03518000
*           /*********************************************************/ 03519000
*           /*                                                       */ 03520000
*           /* THE STATEMENT WAS CONTINUED BEFORE THE KEYWORD        */ 03521000
*           /* FOLLOWING THE '++'                                    */ 03522000
*           /*                                                       */ 03523000
*           /*********************************************************/ 03524000
*                                                                  1067 03525000
*                                                                  1067 03526000
*           /*********************************************************/ 03527000
*           /*                                                       */ 03528000
*           /* PRINT THE RECORD IN ERROR                             */ 03529000
*           /*                                                       */ 03530000
*           /*********************************************************/ 03531000
*                                                                  1067 03532000
*           CRPBFPRM=ON;            /* SET BUFFER PRIMED             */ 03533000
*           CRPSCNCL=OFF;           /* USER EXIT - N/A               */ 03534000
         OI    CRPBFPRM,B'10000000'                                1068 03535000
         NI    CRPSCNCL,B'11111110'                                1068 03536000
*           CRPSCPAD=0;             /* SCP ADDRESS - N/A             */ 03537000
         SLR   @15,@15                                             1069 03538000
         ST    @15,CRPSCPAD                                        1069 03539000
*           CRPPTS=OFF;             /* DO NOT WRITE TO PTS           */ 03540000
*           CRPLOG=OFF;             /* DO NOT WRITE TO SMPLOG        */ 03541000
*           CRPPRINT=ON;            /* WRITE TO SMPOUT               */ 03542000
         OI    CRPPRINT,B'00001000'                                1072 03543000
         NI    CRPPTS,B'11001111'                                  1072 03544000
*           CALL HMASMCRD(HMASMCRP);                               1073 03545000
         L     @15,@CV01708                                        1073 03546000
         LA    @01,@AL01073                                        1073 03547000
         BALR  @14,@15                                             1073 03548000
*           IF CRPRETRN^=CRPGOOD THEN                              1074 03549000
         CLI   CRPRETRN,0                                          1074 03550000
         BE    @RF01074                                            1074 03551000
*             RECXMAX=MAX(RECXMAX,CRPRETRN);/* SAVE HIGHEST CODE     */ 03552000
*                                                                  1075 03553000
         L     @15,RECXMAX                                         1075 03554000
         SLR   @14,@14                                             1075 03555000
         IC    @14,CRPRETRN                                        1075 03556000
         CR    @15,@14                                             1075 03557000
         BNL   *+6                                                      03558000
         LR    @15,@14                                             1075 03559000
         ST    @15,RECXMAX                                         1075 03560000
*           /*********************************************************/ 03561000
*           /*                                                       */ 03562000
*           /* FLUSH THE SYSMOD WITH A SYNTAX ERROR AND ISSUE HMA345I*/ 03563000
*           /*                                                       */ 03564000
*           /*********************************************************/ 03565000
*                                                                  1076 03566000
*           RECXSYSF=ON;            /* FLUSH SYSMOD                  */ 03567000
@RF01074 OI    RECXSYSF,B'00010000'                                1076 03568000
*           GSMSYNTX=ON;            /* SYNTAX/CONSTRUCTION ERROR     */ 03569000
         LA    @15,GTASM                                           1077 03570000
         OI    GSMSYNTX(@15),B'01000000'                           1077 03571000
*           MGPTYPE=MGPERR;         /* STOP-SYSMOD ERROR             */ 03572000
         MVI   MGPTYPE,X'03'                                       1078 03573000
*           CALL ERRMSG(HMA345I,NOPART,NOPART);/* POSITIONAL PARM NOT   03574000
*                                      IN 1ST RECORD                 */ 03575000
         LA    @01,@AL01079                                        1079 03576000
         BAL   @14,ERRMSG                                          1079 03577000
*         END;                                                     1080 03578000
*     END;                                                         1081 03579000
*   RETURN;                                                        1082 03580000
@EL00012 DS    0H                                                  1082 03581000
@EF00012 DS    0H                                                  1082 03582000
@ER00012 LM    @14,@12,@SA00012                                    1082 03583000
         BR    @14                                                 1082 03584000
*                                                                  1083 03585000
*   /*****************************************************************/ 03586000
*   /*                                                               */ 03587000
*   /* DSCANS FOR SYSMOD HEADER STATEMENTS                           */ 03588000
*   /*                                                               */ 03589000
*   /*****************************************************************/ 03590000
*                                                                  1083 03591000
*   GEN DATA DEFS(SYSMSCAN) REFS(SMHDTYPE,SMCTTYPE,SM#VALUE);      1083 03592000
*                                                                  1084 03593000
*   /*****************************************************************/ 03594000
*   /*                                                               */ 03595000
*   /* DSCAN ROUT - SYSMOD HEADER FOUND                              */ 03596000
*   /*                                                               */ 03597000
*   /*****************************************************************/ 03598000
*                                                                  1084 03599000
*SMHDTYPE:                                                         1084 03600000
*   PROC;                                                          1084 03601000
         B     @PB00013                                            1084 03602000
SMHDTYPE STM   @14,@12,12(@13)                                     1084 03603000
*   CHKKEY=YES;                     /* KEYWORD FOUND                 */ 03604000
         MVI   CHKKEY,C'Y'                                         1085 03605000
*   CHKTYPE=SMHEAD;                 /* SET SYSMOD HEADER TYPE        */ 03606000
         MVI   CHKTYPE,C'H'                                        1086 03607000
*   CHKSMDID=NULLPTF#;              /* CLEAR SYSMOD-ID SAVE AREA     */ 03608000
         MVC   CHKSMDID(7),@CC01733                                1087 03609000
*   SCPRET=SCPGOOD;                 /* CONT SCAN ... RETURN CODE 0   */ 03610000
         L     @01,SCPPTR                                          1088 03611000
         MVI   SCPRET(@01),X'00'                                   1088 03612000
*   RETURN;                                                        1089 03613000
@EL00013 DS    0H                                                  1089 03614000
@EF00013 DS    0H                                                  1089 03615000
@ER00013 LM    @14,@12,12(@13)                                     1089 03616000
         BR    @14                                                 1089 03617000
*   END SMHDTYPE;                                                  1090 03618000
*                                                                  1091 03619000
*   /*****************************************************************/ 03620000
*   /*                                                               */ 03621000
*   /* DSCAN ROUT - NOT A SYSMOD HEADER                              */ 03622000
*   /*                                                               */ 03623000
*   /*****************************************************************/ 03624000
*                                                                  1091 03625000
*SMCTTYPE:                                                         1091 03626000
*   PROC;                                                          1091 03627000
SMCTTYPE STM   @14,@12,12(@13)                                     1091 03628000
*   CHKKEY=YES;                     /* KEYWORD FOUND                 */ 03629000
         MVI   CHKKEY,C'Y'                                         1092 03630000
*   SCPRET=SCPNDSCN;                /* STOP SCAN ... RETURN CODE 0   */ 03631000
         L     @01,SCPPTR                                          1093 03632000
         MVI   SCPRET(@01),X'04'                                   1093 03633000
*   RETURN;                                                        1094 03634000
@EL00014 DS    0H                                                  1094 03635000
@EF00014 DS    0H                                                  1094 03636000
@ER00014 LM    @14,@12,12(@13)                                     1094 03637000
         BR    @14                                                 1094 03638000
*   END SMCTTYPE;                                                  1095 03639000
*                                                                  1096 03640000
*   /*****************************************************************/ 03641000
*   /*                                                               */ 03642000
*   /* DSCAN ROUT - EXTRACT SYSMOD ID FROM STATEMENT                 */ 03643000
*   /*                                                               */ 03644000
*   /*****************************************************************/ 03645000
*                                                                  1096 03646000
*SM#VALUE:                                                         1096 03647000
*   PROC;                                                          1096 03648000
SM#VALUE STM   @14,@12,12(@13)                                     1096 03649000
*   DCL                                                            1097 03650000
*     1 * BASED(SCPCHAR),           /* ADDRESS SCP BUFFER            */ 03651000
*      2 SM#ID CHAR(7);             /*                               */ 03652000
*   CHKSMDID=SM#ID;                 /* SAVE SYSMOD-ID                */ 03653000
         L     @15,SCPPTR                                          1098 03654000
         L     @01,SCPCHAR(,@15)                                   1098 03655000
         MVC   CHKSMDID(7),SM#ID(@01)                              1098 03656000
*   SCPRET=SCPNDSCN;                /* STOP SCAN ... RETURN CODE 0   */ 03657000
         MVI   SCPRET(@15),X'04'                                   1099 03658000
*   CHKSMD#=YES;                    /* SYSMOD # FOUND                */ 03659000
         MVI   CHKSMD#,C'Y'                                        1100 03660000
*   RETURN;                                                        1101 03661000
@EL00015 DS    0H                                                  1101 03662000
@EF00015 DS    0H                                                  1101 03663000
@ER00015 LM    @14,@12,12(@13)                                     1101 03664000
         BR    @14                                                 1101 03665000
*   END SM#VALUE;                                                  1102 03666000
*   END CHKBUF;                                                    1103 03667000
         B     @EL00012                                            1103 03668000
*                                                                  1104 03669000
*/********************************************************************/ 03670000
*/*                                                                  */ 03671000
*/*    ERRMSG - PUT ERROR MESSAGES TO SMPOUT AND SMPLOG FILES.       */ 03672000
*/*                                                                  */ 03673000
*/********************************************************************/ 03674000
*                                                                  1104 03675000
*ERRMSG:                                                           1104 03676000
*   PROC(MSGCODE1,MSGCODE2,MSGCODE3);                              1104 03677000
ERRMSG   STM   @14,@12,@SA00016                                    1104 03678000
         MVC   @PC00016(12),0(@01)                                 1104 03679000
*   DCL                                                            1105 03680000
*     MSGCODE1 FIXED(8);            /* PRIMARY MESSAGE NUMBER        */ 03681000
*   DCL                                                            1106 03682000
*     MSGCODE2 FIXED(8);            /* SECONDARY MESSAGE NUMBER      */ 03683000
*   DCL                                                            1107 03684000
*     MSGCODE3 FIXED(8);            /* TERTIARY MESSAGE NUMBER       */ 03685000
*                                                                  1107 03686000
*   /*****************************************************************/ 03687000
*   /*                                                               */ 03688000
*   /* SET UP HMASMMSG PARM LIST (MGP)                               */ 03689000
*   /*                                                               */ 03690000
*   /*****************************************************************/ 03691000
*                                                                  1108 03692000
*   MGPCLEAR=''B;                   /* CLEAR ALL MESSAGE NUMBERS     */ 03693000
         XC    MGPCLEAR(6),MGPCLEAR                                1108 03694000
*   MGPMGNO1=MSGCODE1;              /* PRIMARY MESSAGE NUMBER        */ 03695000
         L     @15,@PC00016                                        1109 03696000
         SLR   @14,@14                                             1109 03697000
         IC    @14,MSGCODE1(,@15)                                  1109 03698000
         STH   @14,MGPMGNO1                                        1109 03699000
*   IF MSGCODE2^=NOPART THEN                                       1110 03700000
         L     @15,@PC00016+4                                      1110 03701000
         CLI   MSGCODE2(@15),0                                     1110 03702000
         BE    @RF01110                                            1110 03703000
*     MGPMGNO2=MSGCODE2;            /* SECONDARY MESSAGE PART        */ 03704000
         SLR   @14,@14                                             1111 03705000
         IC    @14,MSGCODE2(,@15)                                  1111 03706000
         STH   @14,MGPMGNO2                                        1111 03707000
*   IF MSGCODE3^=NOPART THEN                                       1112 03708000
@RF01110 L     @15,@PC00016+8                                      1112 03709000
         CLI   MSGCODE3(@15),0                                     1112 03710000
         BE    @RF01112                                            1112 03711000
*     MGPMGNO3=MSGCODE3;            /* TERCIARY MESSAGE PART         */ 03712000
         SLR   @14,@14                                             1113 03713000
         IC    @14,MSGCODE3(,@15)                                  1113 03714000
         STH   @14,MGPMGNO3                                        1113 03715000
*   MGPPRINT=ON;                    /* MSG TO SMPOUT                 */ 03716000
@RF01112 DS    0H                                                  1115 03717000
*   MGPHLDS=ON;                     /* MSG TO SMPLOG                 */ 03718000
*   MGPWTOR=OFF;                    /* NOT WTOR                      */ 03719000
*   MGPWTO=OFF;                     /* NOT WTO                       */ 03720000
*                                                                  1117 03721000
         OI    MGPPRINT,B'10010000'                                1117 03722000
         NI    MGPWTOR,B'11110011'                                 1117 03723000
*   /*****************************************************************/ 03724000
*   /*                                                               */ 03725000
*   /* SET UP VARIABLE PARTS OF CERTAIN MESSAGES                     */ 03726000
*   /*                                                               */ 03727000
*   /*****************************************************************/ 03728000
*                                                                  1118 03729000
*   IF MGPMGNO1=HMA246I THEN                                       1118 03730000
         CLC   MGPMGNO1(2),@CH01785                                1118 03731000
         BNE   @RF01118                                            1118 03732000
*     DO;                                                          1119 03733000
*                                                                  1119 03734000
*       /*************************************************************/ 03735000
*       /*                                                           */ 03736000
*       /* HMA246I                                                   */ 03737000
*       /*                                                           */ 03738000
*       /*************************************************************/ 03739000
*                                                                  1120 03740000
*       MGPVARPT(1)=ADDR(MSGSYS);   /* "SYSTEM"                      */ 03741000
         LA    @15,MSGSYS                                          1120 03742000
         ST    @15,MGPVARPT                                        1120 03743000
*       MGPVARPT(2)=ADDR(MSGENT);   /* "ENTRY"                       */ 03744000
         LA    @15,MSGENT                                          1121 03745000
         ST    @15,MGPVARPT+4                                      1121 03746000
*       MGPVARPT(3)=ADDR(MSGPTS);   /* "SMPPTS"                      */ 03747000
         LA    @15,MSGPTS                                          1122 03748000
         ST    @15,MGPVARPT+8                                      1122 03749000
*     END;                                                         1123 03750000
*   IF MGPMGNO1=HMA248I THEN                                       1124 03751000
@RF01118 CLC   MGPMGNO1(2),@CH01787                                1124 03752000
         BNE   @RF01124                                            1124 03753000
*     DO;                                                          1125 03754000
*                                                                  1125 03755000
*       /*************************************************************/ 03756000
*       /*                                                           */ 03757000
*       /* HMA248I                                                   */ 03758000
*       /*                                                           */ 03759000
*       /*************************************************************/ 03760000
*                                                                  1126 03761000
*       MGPVARPT(1)=ADDR(MSGREC);   /* "RECEIVE"                     */ 03762000
         LA    @15,MSGREC                                          1126 03763000
         ST    @15,MGPVARPT                                        1126 03764000
*     END;                                                         1127 03765000
*   IF MGPMGNO1=HMA259I THEN                                       1128 03766000
@RF01124 CLC   MGPMGNO1(2),@CH00949                                1128 03767000
         BNE   @RF01128                                            1128 03768000
*     DO;                                                          1129 03769000
*                                                                  1129 03770000
*       /*************************************************************/ 03771000
*       /*                                                           */ 03772000
*       /* HMA259I                                                   */ 03773000
*       /*                                                           */ 03774000
*       /*************************************************************/ 03775000
*                                                                  1130 03776000
*       MGPVARPT(1)=ADDR(MSGPTS);   /* "SMPPTS"                      */ 03777000
         LA    @15,MSGPTS                                          1130 03778000
         ST    @15,MGPVARPT                                        1130 03779000
*       MGPVARPT(2)=ADDR(MSGSYS);   /* "SYSTEM"                      */ 03780000
         LA    @15,MSGSYS                                          1131 03781000
         ST    @15,MGPVARPT+4                                      1131 03782000
*       MGPVARPT(3)=ADDR(MSGFMID);  /* "FMID "                       */ 03783000
         LA    @15,MSGFMID                                         1132 03784000
         ST    @15,MGPVARPT+8                                      1132 03785000
*       MGPVARPT(4)=ADDR(VPART#1);  /* FMID SYSMOD # BEING ADDED     */ 03786000
         LA    @15,VPART#1                                         1133 03787000
         ST    @15,MGPVARPT+12                                     1133 03788000
*     END;                                                         1134 03789000
*   IF MGPMGNO1=HMA369I THEN                                       1135 03790000
@RF01128 CLC   MGPMGNO1(2),@CH01208                                1135 03791000
         BNE   @RF01135                                            1135 03792000
*     DO;                                                          1136 03793000
*                                                                  1136 03794000
*       /*************************************************************/ 03795000
*       /*                                                           */ 03796000
*       /* HMA369I                                                   */ 03797000
*       /*                                                           */ 03798000
*       /*************************************************************/ 03799000
*                                                                  1137 03800000
*       MGPVARPT(1)=ADDR(MSGSMDNM); /* SYSMOD NAME                   */ 03801000
         LA    @15,MSGSMDNM                                        1137 03802000
         ST    @15,MGPVARPT                                        1137 03803000
*     END;                                                         1138 03804000
*   IF MGPMGNO1=HMA363I THEN                                       1139 03805000
@RF01135 CLC   MGPMGNO1(2),@CH01196                                1139 03806000
         BNE   @RF01139                                            1139 03807000
*     DO;                                                          1140 03808000
*                                                                  1140 03809000
*       /*************************************************************/ 03810000
*       /*                                                           */ 03811000
*       /* HMA363I                                                   */ 03812000
*       /*                                                           */ 03813000
*       /*************************************************************/ 03814000
*                                                                  1141 03815000
*       MGPVARPT(1)=ADDR(VPART#1);  /* VARIABLE PART                 */ 03816000
         LA    @15,VPART#1                                         1141 03817000
         ST    @15,MGPVARPT                                        1141 03818000
*       MGPVARPT(2)=ADDR(VPART#2);  /* VARIABLE PART                 */ 03819000
         LA    @15,VPART#2                                         1142 03820000
         ST    @15,MGPVARPT+4                                      1142 03821000
*       MGPVARPT(3)=ADDR(VPART#3);  /* VARIABLE PART                 */ 03822000
         LA    @15,VPART#3                                         1143 03823000
         ST    @15,MGPVARPT+8                                      1143 03824000
*     END;                                                         1144 03825000
*   IF MGPMGNO1=HMA378I THEN                                       1145 03826000
@RF01139 CLC   MGPMGNO1(2),@CH01810                                1145 03827000
         BNE   @RF01145                                            1145 03828000
*     DO;                                                          1146 03829000
*                                                                  1146 03830000
*       /*************************************************************/ 03831000
*       /*                                                           */ 03832000
*       /* HMA378I                                                   */ 03833000
*       /*                                                           */ 03834000
*       /*************************************************************/ 03835000
*                                                                  1147 03836000
*       MGPVARPT(1)=ADDR(VPART#1);  /* VARIABLE PART - ELEMENT TYPE  */ 03837000
         LA    @15,VPART#1                                         1147 03838000
         ST    @15,MGPVARPT                                        1147 03839000
*       MGPVARPT(2)=ADDR(VPART#2);  /* VARIABLE PART - ELEMENT TYPE  */ 03840000
         LA    @15,VPART#2                                         1148 03841000
         ST    @15,MGPVARPT+4                                      1148 03842000
*       MGPVARPT(3)=ADDR(VPART#3);  /* VARIABLE PART - ELEMENT NAME  */ 03843000
         LA    @15,VPART#3                                         1149 03844000
         ST    @15,MGPVARPT+8                                      1149 03845000
*     END;                                                         1150 03846000
*   CALL HMASMMSG(HMASMMGP);                                       1151 03847000
@RF01145 L     @15,@CV01704                                        1151 03848000
         LA    @01,@AL01151                                        1151 03849000
         BALR  @14,@15                                             1151 03850000
*   RESPECIFY                                                      1152 03851000
*     REG15 RSTD;                   /* CHECK RETURN CODE             */ 03852000
*   RECXMAX=MAX(RECXMAX,REG15);     /* SAVE IT IF HIGH               */ 03853000
         L     @14,RECXMAX                                         1153 03854000
         CR    @14,REG15                                           1153 03855000
         BNL   *+6                                                      03856000
         LR    @14,REG15                                           1153 03857000
         ST    @14,RECXMAX                                         1153 03858000
*   RESPECIFY                                                      1154 03859000
*     REG15 UNRSTD;                                                1154 03860000
*                                                                  1154 03861000
*   /*****************************************************************/ 03862000
*   /*                                                               */ 03863000
*   /* SET RECEIVE RETURN CODE BASED UPON MGPTYPE                    */ 03864000
*   /*                                                               */ 03865000
*   /*****************************************************************/ 03866000
*                                                                  1155 03867000
*   IF MGPTYPE=MGPWARN THEN                                        1155 03868000
         CLI   MGPTYPE,2                                           1155 03869000
         BNE   @RF01155                                            1155 03870000
*     RECXMAX=MAX(RECXMAX,PTFWARN); /* WARNING                       */ 03871000
         LA    @15,4                                               1156 03872000
         CR    @14,@15                                             1156 03873000
         BNL   *+6                                                      03874000
         LR    @14,@15                                             1156 03875000
         ST    @14,RECXMAX                                         1156 03876000
*   ELSE                                                           1157 03877000
*     IF MGPTYPE=MGPERR THEN                                       1157 03878000
         B     @RC01155                                            1157 03879000
@RF01155 CLI   MGPTYPE,3                                           1157 03880000
         BNE   @RF01157                                            1157 03881000
*       RECXMAX=MAX(RECXMAX,STOPPTF);/* STOP-SYSMOD                  */ 03882000
         L     @15,RECXMAX                                         1158 03883000
         LA    @14,8                                               1158 03884000
         CR    @15,@14                                             1158 03885000
         BNL   *+6                                                      03886000
         LR    @15,@14                                             1158 03887000
         ST    @15,RECXMAX                                         1158 03888000
*     ELSE                                                         1159 03889000
*       IF MGPTYPE=MGPSEV THEN                                     1159 03890000
         B     @RC01157                                            1159 03891000
@RF01157 CLI   MGPTYPE,4                                           1159 03892000
         BNE   @RF01159                                            1159 03893000
*         RECXMAX=MAX(RECXMAX,STOPFUNC);/* SEVERE                    */ 03894000
         L     @15,RECXMAX                                         1160 03895000
         LA    @14,12                                              1160 03896000
         CR    @15,@14                                             1160 03897000
         BNL   *+6                                                      03898000
         LR    @15,@14                                             1160 03899000
         ST    @15,RECXMAX                                         1160 03900000
*       ELSE                                                       1161 03901000
*         IF MGPTYPE=MGPTERM THEN                                  1161 03902000
         B     @RC01159                                            1161 03903000
@RF01159 CLI   MGPTYPE,5                                           1161 03904000
         BNE   @RF01161                                            1161 03905000
*           RECXMAX=MAX(RECXMAX,STOPSMP);/* TERMINATING              */ 03906000
         L     @15,RECXMAX                                         1162 03907000
         LA    @14,16                                              1162 03908000
         CR    @15,@14                                             1162 03909000
         BNL   *+6                                                      03910000
         LR    @15,@14                                             1162 03911000
         ST    @15,RECXMAX                                         1162 03912000
*   RETURN;                                                        1163 03913000
@EL00016 DS    0H                                                  1163 03914000
@EF00016 DS    0H                                                  1163 03915000
@ER00016 LM    @14,@12,@SA00016                                    1163 03916000
         BR    @14                                                 1163 03917000
*   END ERRMSG;                                                    1164 03918000
         B     @EL00016                                            1164 03919000
*                                                                  1165 03920000
*/********************************************************************/ 03921000
*/*                                                                  */ 03922000
*/*    PARSERR - PROCESS NON-ZERO RETURN CODES FROM PARSE PROCEDURES */ 03923000
*/*                                                                  */ 03924000
*/*        - CALLED TO PROCESS NON-ZERO RETURN CODES FROM THE        */ 03925000
*/*          PARSE ROUTINES (HMASMMPD).                              */ 03926000
*/*                                                                  */ 03927000
*/*        1. IF AN END-OF-FILE WAS ENCOUNTERED BY HMASMCRD,         */ 03928000
*/*           SET RECXPEOF TO STOP READS FROM PTFIN.                 */ 03929000
*/*                                                                  */ 03930000
*/*        2. IF THE RETURN CODE IS THE RESULT OF A USER EXIT:       */ 03931000
*/*                                                                  */ 03932000
*/*             - SET RECEIVE'S MAXIMUM RETURN CODE (RECXMAX)        */ 03933000
*/*               APPROPRIATELY AND SET GSMUSR IN THE SUMMARY        */ 03934000
*/*               RECORD.                                            */ 03935000
*/*                                                                  */ 03936000
*/*        2. IF THE RETURN CODE IS THE RESULT OF A SYNTAX ERROR:    */ 03937000
*/*                                                                  */ 03938000
*/*             - SET RECEIVE'S MAXIMUM RETURN CODE (RECXMAX)        */ 03939000
*/*               TO STOPPTF AND SET GSMSYNTX IN THE SUMMARY         */ 03940000
*/*               RECORD.                                            */ 03941000
*/*                                                                  */ 03942000
*/*        3. IF THE RETURN CODE IS THE RESULT OF A TERMINATING      */ 03943000
*/*           ERROR FROM HMASMCRD:                                   */ 03944000
*/*                                                                  */ 03945000
*/*             - SET RECEIVE'S MAXIMUM RETURN CODE (RECXMAX)        */ 03946000
*/*               TO HMASMCRD'S RETURN CODE AND SET GSMSIOE          */ 03947000
*/*               IN THE SUMMARY RECORD TO INDICATE SMP DATASET      */ 03948000
*/*               I/O ERROR.                                         */ 03949000
*/*                                                                  */ 03950000
*/*        4. IN ALL CASES, THE SYSMOD IS FLUSHED (RECXSYSF SET).    */ 03951000
*/*                                                                  */ 03952000
*/********************************************************************/ 03953000
*                                                                  1165 03954000
*PARSERR:                                                          1165 03955000
*   PROC;                                                          1165 03956000
PARSERR  STM   @14,@12,12(@13)                                     1165 03957000
*   RECXSYSF=ON;                    /* FLUSH THE SYSMOD              */ 03958000
         OI    RECXSYSF,B'00010000'                                1166 03959000
*   RECXMAX=MAX(RECXMAX,STOPPTF);   /* THE SYSMOD IS TERMINATED      */ 03960000
*                                                                  1167 03961000
         L     @15,RECXMAX                                         1167 03962000
         LA    @14,8                                               1167 03963000
         CR    @15,@14                                             1167 03964000
         BNL   *+6                                                      03965000
         LR    @15,@14                                             1167 03966000
         ST    @15,RECXMAX                                         1167 03967000
*   /*****************************************************************/ 03968000
*   /*                                                               */ 03969000
*   /* CHECK SETTINGS IN HMASMCRD'S PARAMETER LIST (HMASMCRP) TO     */ 03970000
*   /* DETERMINE WHAT HAS HAPPENED                                   */ 03971000
*   /*                                                               */ 03972000
*   /*****************************************************************/ 03973000
*                                                                  1168 03974000
*   IF CRPRETRN=CRPEOF              /* END-OF-FILE ENCOUNTERED       */ 03975000
*     THEN                                                         1168 03976000
         CLI   CRPRETRN,4                                          1168 03977000
         BNE   @RF01168                                            1168 03978000
*     RECXPEOF=ON;                  /* SET PTFIN EOF FLAG            */ 03979000
         OI    RECXPEOF,B'00100000'                                1169 03980000
*   IF CRPTRMEX=ON                  /* USER-EXIT RETURN CODE         */ 03981000
*     THEN                                                         1170 03982000
@RF01168 TM    CRPTRMEX,B'01000000'                                1170 03983000
         BNO   @RF01170                                            1170 03984000
*     DO;                                                          1171 03985000
*                                                                  1171 03986000
*       /*************************************************************/ 03987000
*       /*                                                           */ 03988000
*       /* RETURN CODE IS THE RESULT OF THE USER EXIT                */ 03989000
*       /*                                                           */ 03990000
*       /*************************************************************/ 03991000
*                                                                  1172 03992000
*       RECXMAX=MAX(RECXMAX,CRPRETRN);/* SAVE RETURN CODE            */ 03993000
         L     @15,RECXMAX                                         1172 03994000
         SLR   @14,@14                                             1172 03995000
         IC    @14,CRPRETRN                                        1172 03996000
         CR    @15,@14                                             1172 03997000
         BNL   *+6                                                      03998000
         LR    @15,@14                                             1172 03999000
         ST    @15,RECXMAX                                         1172 04000000
*       GSMUSR=ON;                  /* SET SUMMARY RECORD FLAG - USER   04001000
*                                      EXIT                          */ 04002000
         LA    @15,GTASM                                           1173 04003000
         OI    GSMUSR(@15),B'10000000'                             1173 04004000
*     END;                                                         1174 04005000
*   ELSE                                                           1175 04006000
*     DO;                                                          1175 04007000
*                                                                  1175 04008000
         B     @RC01170                                            1175 04009000
@RF01170 DS    0H                                                  1176 04010000
*       /*************************************************************/ 04011000
*       /*                                                           */ 04012000
*       /* RETURN CODE IS SYNTAX ERROR FROM PARSE OR I/O ERROR FROM  */ 04013000
*       /* HMASMCRD.                                                 */ 04014000
*       /*                                                           */ 04015000
*       /*************************************************************/ 04016000
*                                                                  1176 04017000
*       IF MPDRETRN<=STOPPTF THEN                                  1176 04018000
         L     @15,MPDRETRN                                        1176 04019000
         CH    @15,@CH00033                                        1176 04020000
         BH    @RF01176                                            1176 04021000
*         GSMSYNTX=ON;              /* SYNTAX/CONSTRUCTION ERROR     */ 04022000
         LA    @15,GTASM                                           1177 04023000
         OI    GSMSYNTX(@15),B'01000000'                           1177 04024000
*       ELSE                                                       1178 04025000
*         RECXMAX=MAX(RECXMAX,MPDRETRN);/* TERMINATING ERROR         */ 04026000
         B     @RC01176                                            1178 04027000
@RF01176 L     @15,RECXMAX                                         1178 04028000
         L     @14,MPDRETRN                                        1178 04029000
         CR    @15,@14                                             1178 04030000
         BNL   *+6                                                      04031000
         LR    @15,@14                                             1178 04032000
         ST    @15,RECXMAX                                         1178 04033000
*     END;                                                         1179 04034000
*   RETURN;                                                        1180 04035000
@EL00017 DS    0H                                                  1180 04036000
@EF00017 DS    0H                                                  1180 04037000
@ER00017 LM    @14,@12,12(@13)                                     1180 04038000
         BR    @14                                                 1180 04039000
*   END PARSERR;                                                   1181 04040000
         B     @EL00017                                            1181 04041000
*                                                                  1182 04042000
*/********************************************************************/ 04043000
*/*                                                                  */ 04044000
*/*    WRITEPTS - WRITE RECORD IN CRPBUFFR TO THE PTS MCS ENTRY      */ 04045000
*/*                         - AND/OR -                               */ 04046000
*/*               WRITE RECORD IN CRPBUFFR TO SMPOUT.                */ 04047000
*/*                                                                  */ 04048000
*/*        1. INITIALIZE THE CRP PARAMETER LIST:                     */ 04049000
*/*            - WRITE TO PTS MCS ENTRY (ALL RECORDS).               */ 04050000
*/*            - IF MODIFICATION CONTROL STATEMENT RECORD,           */ 04051000
*/*              - WRITE TO SMPOUT AND SMPLOG                        */ 04052000
*/*            - IF NOT A MODIFICATION CONTROL STATEMENT RECORD,     */ 04053000
*/*              - DO NOT WRITE TO SMPOUT AND SMPLOG.                */ 04054000
*/*                                                                  */ 04055000
*/*        2.  CALL HMASMCRD                                         */ 04056000
*/*                                                                  */ 04057000
*/*        3.  SET RECXMAX FOR NON-ZERO RETURN CODES FROM HMASMCRD   */ 04058000
*/*                                                                  */ 04059000
*/********************************************************************/ 04060000
*                                                                  1182 04061000
*WRITEPTS:                                                         1182 04062000
*   PROC(PRTFLG);                                                  1182 04063000
WRITEPTS STM   @14,@12,@SA00018                                    1182 04064000
         MVC   @PC00018(4),0(@01)                                  1182 04065000
*   DCL                                                            1183 04066000
*     PRTFLG CHAR(1);               /* ALLOWS THE CALLER TO SPECIFY     04067000
*                                      THAT THE RECORD IN CRPBUFFR BE   04068000
*                                      WRITTEN TO SMPOUT (WHEN SET TO   04069000
*                                      "SMCNTRL").                   */ 04070000
*                                                                  1183 04071000
*   /*****************************************************************/ 04072000
*   /*                                                               */ 04073000
*   /* HMASMCRP PARAMETER INITIALIZATION                             */ 04074000
*   /*                                                               */ 04075000
*   /*****************************************************************/ 04076000
*                                                                  1184 04077000
*   CRPSCNCL=OFF;                   /* THIS IN NOT A CALL FROM SCN   */ 04078000
*   CRPOTHER=OFF;                   /* DO NOT WRITE TO CRPOUTDS      */ 04079000
         NI    CRPSCNCL,B'11111010'                                1185 04080000
*   CRPUXNUM=0;                     /* USER EXIT - N/A               */ 04081000
         MVI   CRPUXNUM,X'00'                                      1186 04082000
*   CRPSCPAD=0;                     /* SCP ADDRESS - N/A             */ 04083000
         SLR   @15,@15                                             1187 04084000
         ST    @15,CRPSCPAD                                        1187 04085000
*   CRPLOG=OFF;                     /* DO NOT WRITE TO SMPLOG        */ 04086000
*   CRPBFPRM=ON;                    /* THE BUFFER IS PRIMED          */ 04087000
         OI    CRPBFPRM,B'10000000'                                1189 04088000
         NI    CRPLOG,B'11101111'                                  1189 04089000
*                                                                  1190 04090000
*   /*****************************************************************/ 04091000
*   /*                                                               */ 04092000
*   /* DETERMINE THE SETTING OF CRPPTS AND CRPPRINT                  */ 04093000
*   /*                                                               */ 04094000
*   /*****************************************************************/ 04095000
*                                                                  1190 04096000
*   IF RECXSYSF=OFF THEN                                           1190 04097000
         TM    RECXSYSF,B'00010000'                                1190 04098000
         BNZ   @RF01190                                            1190 04099000
*     CRPPTS=ON;                    /* NOT FLUSH ... WRITE TO PTS    */ 04100000
         OI    CRPPTS,B'00100000'                                  1191 04101000
*   ELSE                                                           1192 04102000
*     CRPPTS=OFF;                   /* FLUSH ... DO NOT WRITE TO PTS */ 04103000
         B     @RC01190                                            1192 04104000
@RF01190 NI    CRPPTS,B'11011111'                                  1192 04105000
*   IF PRTFLG^=SMCNTRL THEN                                        1193 04106000
@RC01190 L     @15,@PC00018                                        1193 04107000
         CLI   PRTFLG(@15),C'C'                                    1193 04108000
         BE    @RF01193                                            1193 04109000
*     CRPPRINT=OFF;                 /* DO NOT WRITE TO SMPOUT        */ 04110000
         NI    CRPPRINT,B'11110111'                                1194 04111000
*   ELSE                                                           1195 04112000
*     DO;                                                          1195 04113000
         B     @RC01193                                            1195 04114000
@RF01193 DS    0H                                                  1196 04115000
*       CALL SKIP(1);               /* PUT A BLANK LINE TO SMPOUT    */ 04116000
         LA    @01,@AL01196                                        1196 04117000
         BAL   @14,SKIP                                            1196 04118000
*       CRPPRINT=ON;                /* WRITE TO SMPOUT               */ 04119000
         OI    CRPPRINT,B'00001000'                                1197 04120000
*     END;                                                         1198 04121000
*                                                                  1198 04122000
*   /*****************************************************************/ 04123000
*   /*                                                               */ 04124000
*   /* WRITE RECORD TO PTS MCS ENTRY AND/OR SMPOUT                   */ 04125000
*   /*                                                               */ 04126000
*   /*****************************************************************/ 04127000
*                                                                  1199 04128000
*   IF CRPPRINT=ON|CRPPTS=ON THEN                                  1199 04129000
@RC01193 TM    CRPPRINT,B'00101000'                                1199 04130000
         BZ    @RF01199                                            1199 04131000
*     DO;                                                          1200 04132000
*       CALL HMASMCRD(HMASMCRP);                                   1201 04133000
         L     @15,@CV01708                                        1201 04134000
         LA    @01,@AL01201                                        1201 04135000
         BALR  @14,@15                                             1201 04136000
*       IF CRPRETRN^=CRPGOOD THEN                                  1202 04137000
         CLI   CRPRETRN,0                                          1202 04138000
         BE    @RF01202                                            1202 04139000
*         DO;                                                      1203 04140000
*           IF CRPRETRN=CRPTPTF THEN                               1204 04141000
         CLI   CRPRETRN,8                                          1204 04142000
         BNE   @RF01204                                            1204 04143000
*             RECXSYSF=ON;          /* FLUSH THIS SYSMOD             */ 04144000
         OI    RECXSYSF,B'00010000'                                1205 04145000
*           RECXMAX=MAX(RECXMAX,CRPRETRN);                         1206 04146000
@RF01204 L     @15,RECXMAX                                         1206 04147000
         SLR   @14,@14                                             1206 04148000
         IC    @14,CRPRETRN                                        1206 04149000
         CR    @15,@14                                             1206 04150000
         BNL   *+6                                                      04151000
         LR    @15,@14                                             1206 04152000
         ST    @15,RECXMAX                                         1206 04153000
*         END;                                                     1207 04154000
*     END;                                                         1208 04155000
*   RETURN;                                                        1209 04156000
@EL00018 DS    0H                                                  1209 04157000
@EF00018 DS    0H                                                  1209 04158000
@ER00018 LM    @14,@12,@SA00018                                    1209 04159000
         BR    @14                                                 1209 04160000
*   END WRITEPTS;                                                  1210 04161000
         B     @EL00018                                            1210 04162000
*                                                                  1211 04163000
*/********************************************************************/ 04164000
*/*                                                                  */ 04165000
*/*    UPDCHK1 - CHECK FOR VALID UPDATE INPUT TEXT                   */ 04166000
*/*                                                                  */ 04167000
*/*            - THIS PROCEDURE IS CALLED WHEN PROCESSING IN-LINE    */ 04168000
*/*              TEXT FOR ++UPDTE AND ++SRCUPD MODIFICATIONS         */ 04169000
*/*                                                                  */ 04170000
*/*        1. CALL UPDCHK2 TO SCAN THE INPUT TEXT (CRPBUFFR).        */ 04171000
*/*                                                                  */ 04172000
*/*        2.  INSURE THAT ONLY ./ CHANGE AND ./ ENDUP IEBUPDTE      */ 04173000
*/*            CONTROL STATEMENTS ARE FOUND.                         */ 04174000
*/*                                                                  */ 04175000
*/********************************************************************/ 04176000
*                                                                  1211 04177000
*UPDCHK1:                                                          1211 04178000
*   PROC;                                                          1211 04179000
UPDCHK1  STM   @14,@12,@SA00019                                    1211 04180000
*   DCL                                                            1212 04181000
*     LASTUPD# CHAR(8);             /* SEQUENCE # OF LAST UPDTE STMT.*/ 04182000
*                                                                  1213 04183000
*   /*****************************************************************/ 04184000
*   /*                                                               */ 04185000
*   /* PROCESSING TEXT RECORDS FOR ++UPDTE OR ++SRCUPD               */ 04186000
*   /*                                                               */ 04187000
*   /*****************************************************************/ 04188000
*                                                                  1213 04189000
*   IF UPDEND=ON                    /* "./ ENDUP" ALREADY FOUND      */ 04190000
*       &DUP362=OFF                 /* HMA362 HAS NOT BEEN ISSUED    */ 04191000
*     THEN                                                         1213 04192000
         TM    UPDEND,B'01000000'                                  1213 04193000
         BNO   @RF01213                                            1213 04194000
         TM    DUP362,B'00000100'                                  1213 04195000
         BNZ   @RF01213                                            1213 04196000
*     DO;                                                          1214 04197000
*                                                                  1214 04198000
*       /*************************************************************/ 04199000
*       /*                                                           */ 04200000
*       /* ./ ENDUP ALREADY ENCOUNTERED ... ISSUE HMA362I            */ 04201000
*       /*                                                           */ 04202000
*       /*************************************************************/ 04203000
*                                                                  1215 04204000
*       RECXSYSF=ON;                /* FLUSH CURRENT SYSMOD          */ 04205000
         OI    RECXSYSF,B'00010000'                                1215 04206000
*       CALL WRITEPTS(SMCNTRL);     /* WRITE STMT TO SMPOUT          */ 04207000
         LA    @01,@AL01216                                        1216 04208000
         BAL   @14,WRITEPTS                                        1216 04209000
*       MGPTYPE=MGPERR;             /* STOP-SYSMOD ERROR             */ 04210000
         MVI   MGPTYPE,X'03'                                       1217 04211000
*       CALL ERRMSG(HMA362I,NOPART,NOPART);                        1218 04212000
         LA    @01,@AL01218                                        1218 04213000
         BAL   @14,ERRMSG                                          1218 04214000
*       DUP362=ON;                  /* HMA362 HAS BEEN ISSUED        */ 04215000
         OI    DUP362,B'00000100'                                  1219 04216000
*       GSMSYNTX=ON;                /* SYNTAX/CONSTRUCTION ERROR     */ 04217000
         LA    @15,GTASM                                           1220 04218000
         OI    GSMSYNTX(@15),B'01000000'                           1220 04219000
*     END;                                                         1221 04220000
*   ELSE                                                           1222 04221000
*     DO;                                                          1222 04222000
         B     @RC01213                                            1222 04223000
@RF01213 DS    0H                                                  1223 04224000
*       ANSWER=UPDNONE;             /* INITIALIZE SWITCH             */ 04225000
         MVI   ANSWER,C'N'                                         1223 04226000
*       IF CRPBUFFR(1:2)='./'       /* BUFFER CONTAINS UPDTE STMT    */ 04227000
*         THEN                                                     1224 04228000
         CLC   CRPBUFFR(2),@CC02002                                1224 04229000
         BNE   @RF01224                                            1224 04230000
*         CALL UPDCHK2(ANSWER);     /* SCAN IEBUPDTE CNTRL STMT      */ 04231000
         LA    @01,@AL01225                                        1225 04232000
         BAL   @14,UPDCHK2                                         1225 04233000
*       IF ANSWER=UPDENDUP          /* ./ ENDUP STATEMENT            */ 04234000
*         THEN                                                     1226 04235000
@RF01224 CLI   ANSWER,C'E'                                         1226 04236000
         BNE   @RF01226                                            1226 04237000
*         UPDEND=ON;                /* ./ ENDUP FOUND                */ 04238000
         OI    UPDEND,B'01000000'                                  1227 04239000
*       IF ANSWER=UPDCHANG THEN                                    1228 04240000
@RF01226 CLI   ANSWER,C'C'                                         1228 04241000
         BNE   @RF01228                                            1228 04242000
*         DO;                                                      1229 04243000
*                                                                  1229 04244000
*           /*********************************************************/ 04245000
*           /*                                                       */ 04246000
*           /* ./ CHANGE STMT ENCOUNTERED                            */ 04247000
*           /*                                                       */ 04248000
*           /*********************************************************/ 04249000
*                                                                  1230 04250000
*           LASTUPD#=''B;           /* CLEAR "LAST" SEQ # FOUND      */ 04251000
         XC    LASTUPD#(8),LASTUPD#                                1230 04252000
*           IF UPDCHG=ON            /* ./ CHANGE ALREADY FOUND       */ 04253000
*               &DUP362=OFF         /* HMA362 HAS NOT BEEN ISSUED    */ 04254000
*             THEN                                                 1231 04255000
         TM    UPDCHG,B'10000000'                                  1231 04256000
         BNO   @RF01231                                            1231 04257000
         TM    DUP362,B'00000100'                                  1231 04258000
         BNZ   @RF01231                                            1231 04259000
*             DO;                                                  1232 04260000
*                                                                  1232 04261000
*               /*****************************************************/ 04262000
*               /*                                                   */ 04263000
*               /* MORE THAN ONE ./ CHANGE ... ISSUE HMA362I         */ 04264000
*               /*                                                   */ 04265000
*               /*****************************************************/ 04266000
*                                                                  1233 04267000
*               RECXSYSF=ON;        /* FLUSH CURRENT SYSMOD          */ 04268000
         OI    RECXSYSF,B'00010000'                                1233 04269000
*               CALL WRITEPTS(SMCNTRL);/* WRITE STMT SMPOUT          */ 04270000
         LA    @01,@AL01234                                        1234 04271000
         BAL   @14,WRITEPTS                                        1234 04272000
*               MGPTYPE=MGPERR;     /* STOP-SYSMOD ERROR             */ 04273000
         MVI   MGPTYPE,X'03'                                       1235 04274000
*               CALL ERRMSG(HMA362I,NOPART,NOPART);                1236 04275000
         LA    @01,@AL01236                                        1236 04276000
         BAL   @14,ERRMSG                                          1236 04277000
*               DUP362=ON;          /* HMA362 HAS BEEN ISSUED        */ 04278000
         OI    DUP362,B'00000100'                                  1237 04279000
*               GSMSYNTX=ON;        /* SYNTAX/CONSTRUCTION ERROR     */ 04280000
         LA    @15,GTASM                                           1238 04281000
         OI    GSMSYNTX(@15),B'01000000'                           1238 04282000
*             END;                                                 1239 04283000
*           ELSE                                                   1240 04284000
*             DO;                                                  1240 04285000
         B     @RC01231                                            1240 04286000
@RF01231 DS    0H                                                  1241 04287000
*               IF CHNGMEM^=MCBENAME/* NAMES UNEQUAL ?               */ 04288000
*                 THEN                                             1241 04289000
         L     @01,RECXMCB                                         1241 04290000
         CLC   CHNGMEM(8),MCBENAME(@01)                            1241 04291000
         BE    @RF01241                                            1241 04292000
*                 DO;                                              1242 04293000
*                                                                  1242 04294000
*                   /*************************************************/ 04295000
*                   /*                                               */ 04296000
*                   /* ./ CHANGE NAME INCORRECT ... ISSUE HMA292I    */ 04297000
*                   /*                                               */ 04298000
*                   /*************************************************/ 04299000
*                                                                  1243 04300000
*                   RECXSYSF=ON;    /* FLUSH CURRENT SYSMOD          */ 04301000
         OI    RECXSYSF,B'00010000'                                1243 04302000
*                   CALL WRITEPTS(SMCNTRL);/* WRITE STMT SMPOUT      */ 04303000
         LA    @01,@AL01244                                        1244 04304000
         BAL   @14,WRITEPTS                                        1244 04305000
*                   MGPTYPE=MGPERR; /* STOP-SYSMOD ERROR             */ 04306000
         MVI   MGPTYPE,X'03'                                       1245 04307000
*                   CALL ERRMSG(HMA292I,NOPART,NOPART);            1246 04308000
         LA    @01,@AL01246                                        1246 04309000
         BAL   @14,ERRMSG                                          1246 04310000
*                   GSMSYNTX=ON;    /* SYNTAX/CONSTRUCTION ERROR     */ 04311000
         LA    @15,GTASM                                           1247 04312000
         OI    GSMSYNTX(@15),B'01000000'                           1247 04313000
*                 END;                                             1248 04314000
*             END;                                                 1249 04315000
@RF01241 DS    0H                                                  1250 04316000
*           UPDCHG=ON;              /* ./ CHANGE FOUND               */ 04317000
@RC01231 OI    UPDCHG,B'10000000'                                  1250 04318000
*         END;                                                     1251 04319000
*       IF ANSWER=UPDOTHER          /* INVALID IEBUPDTE CNTRL STMT   */ 04320000
*         THEN                                                     1252 04321000
@RF01228 CLI   ANSWER,C'O'                                         1252 04322000
         BNE   @RF01252                                            1252 04323000
*         DO;                                                      1253 04324000
*                                                                  1253 04325000
*           /*********************************************************/ 04326000
*           /*                                                       */ 04327000
*           /* INVALID IEBUPDTE CONTROL STATEMENTS ... ISSUE HMA346I */ 04328000
*           /*                                                       */ 04329000
*           /*********************************************************/ 04330000
*                                                                  1254 04331000
*           RECXSYSF=ON;            /* FLUSH THE CURRENT SYSMOD      */ 04332000
         OI    RECXSYSF,B'00010000'                                1254 04333000
*           CALL WRITEPTS(SMCNTRL); /* WRITE STATEMENT TO SMPOUT     */ 04334000
         LA    @01,@AL01255                                        1255 04335000
         BAL   @14,WRITEPTS                                        1255 04336000
*           MGPTYPE=MGPERR;         /* STOP-SYSMOD ERROR             */ 04337000
         MVI   MGPTYPE,X'03'                                       1256 04338000
*           CALL ERRMSG(HMA346I,NOPART,NOPART);                    1257 04339000
         LA    @01,@AL01257                                        1257 04340000
         BAL   @14,ERRMSG                                          1257 04341000
*           GSMSYNTX=ON;            /* SYNTAX/CONSTRUCTION ERROR     */ 04342000
         LA    @15,GTASM                                           1258 04343000
         OI    GSMSYNTX(@15),B'01000000'                           1258 04344000
*         END;                                                     1259 04345000
*       IF(ANSWER=UPDNONE           /* NON-IEBUPTDE CNTRL STMT       */ 04346000
*           |ANSWER=UPDENDUP)       /* "./ ENDUP" STMT               */ 04347000
*           &UPDCHG=OFF             /* "./ CHANGE" NOT ENCOUNTERED   */ 04348000
*           &DUP362=OFF             /* HMA362 HAS NOT BEEN ISSUED    */ 04349000
*         THEN                                                     1260 04350000
@RF01252 CLI   ANSWER,C'N'                                         1260 04351000
         BE    @GL00034                                            1260 04352000
         CLI   ANSWER,C'E'                                         1260 04353000
         BNE   @RF01260                                            1260 04354000
@GL00034 TM    UPDCHG,B'10000100'                                  1260 04355000
         BNZ   @RF01260                                            1260 04356000
*         DO;                                                      1261 04357000
*                                                                  1261 04358000
*           /*********************************************************/ 04359000
*           /*                                                       */ 04360000
*           /* "./ CHANGE" NOT FOUND ... ISSUE HMA362I               */ 04361000
*           /*                                                       */ 04362000
*           /*********************************************************/ 04363000
*                                                                  1262 04364000
*           RECXSYSF=ON;            /* FLUSH THE CURRENT SYSMOD      */ 04365000
         OI    RECXSYSF,B'00010000'                                1262 04366000
*           CALL WRITEPTS(SMCNTRL); /* WRITE STATEMENT TO SMPOUT     */ 04367000
         LA    @01,@AL01263                                        1263 04368000
         BAL   @14,WRITEPTS                                        1263 04369000
*           MGPTYPE=MGPERR;         /* STOP-SYSMOD ERROR             */ 04370000
         MVI   MGPTYPE,X'03'                                       1264 04371000
*           CALL ERRMSG(HMA362I,NOPART,NOPART);                    1265 04372000
         LA    @01,@AL01265                                        1265 04373000
         BAL   @14,ERRMSG                                          1265 04374000
*           DUP362=ON;              /* HMA362 HAS BEEN ISSUED        */ 04375000
         OI    DUP362,B'00000100'                                  1266 04376000
*           GSMSYNTX=ON;            /* SYNTAX/CONSTRUCTION ERROR     */ 04377000
         LA    @15,GTASM                                           1267 04378000
         OI    GSMSYNTX(@15),B'01000000'                           1267 04379000
*         END;                                                     1268 04380000
*       IF ANSWER=UPDNONE           /* NON-IEBUPTDE CNTRL STMT       */ 04381000
*           &CRPBFSEQ<LASTUPD#      /* SEQ # LESS THAN LAST ONE FOUND*/ 04382000
*           &DUP362=OFF             /* HMA362 HAS NOT BEEN ISSUED    */ 04383000
*         THEN                                                     1269 04384000
@RF01260 CLI   ANSWER,C'N'                                         1269 04385000
         BNE   @RF01269                                            1269 04386000
         CLC   CRPBFSEQ(8),LASTUPD#                                1269 04387000
         BNL   @RF01269                                            1269 04388000
         TM    DUP362,B'00000100'                                  1269 04389000
         BNZ   @RF01269                                            1269 04390000
*         DO;                                                      1270 04391000
*                                                                  1270 04392000
*           /*********************************************************/ 04393000
*           /*                                                       */ 04394000
*           /* SEQUENCE NUMBER ERROR ... ISSUE HMA362I               */ 04395000
*           /*                                                       */ 04396000
*           /*********************************************************/ 04397000
*                                                                  1271 04398000
*           RECXSYSF=ON;            /* FLUSH THE CURRENT SYSMOD      */ 04399000
         OI    RECXSYSF,B'00010000'                                1271 04400000
*           CALL WRITEPTS(SMCNTRL); /* WRITE STATEMENT TO SMPOUT     */ 04401000
         LA    @01,@AL01272                                        1272 04402000
         BAL   @14,WRITEPTS                                        1272 04403000
*           MGPTYPE=MGPERR;         /* STOP-SYSMOD ERROR             */ 04404000
         MVI   MGPTYPE,X'03'                                       1273 04405000
*           CALL ERRMSG(HMA362I,NOPART,NOPART);                    1274 04406000
         LA    @01,@AL01274                                        1274 04407000
         BAL   @14,ERRMSG                                          1274 04408000
*           DUP362=ON;              /* HMA362 HAS BEEN ISSUED        */ 04409000
         OI    DUP362,B'00000100'                                  1275 04410000
*           GSMSYNTX=ON;            /* SYNTAX/CONSTRUCTION ERROR     */ 04411000
         LA    @15,GTASM                                           1276 04412000
         OI    GSMSYNTX(@15),B'01000000'                           1276 04413000
*         END;                                                     1277 04414000
*       IF ANSWER=UPDNONE           /* NON-IEBUPTDE CNTRL STMT       */ 04415000
*         THEN                                                     1278 04416000
@RF01269 CLI   ANSWER,C'N'                                         1278 04417000
         BNE   @RF01278                                            1278 04418000
*         LASTUPD#=CRPBFSEQ;        /* SAVE LAST SEQ # ENCOUNTERED   */ 04419000
         MVC   LASTUPD#(8),CRPBFSEQ                                1279 04420000
*     END;                                                         1280 04421000
*   RETURN;                                                        1281 04422000
@EL00019 DS    0H                                                  1281 04423000
@EF00019 DS    0H                                                  1281 04424000
@ER00019 LM    @14,@12,@SA00019                                    1281 04425000
         BR    @14                                                 1281 04426000
*   END UPDCHK1;                                                   1282 04427000
         B     @EL00019                                            1282 04428000
*                                                                  1283 04429000
*/********************************************************************/ 04430000
*/*                                                                  */ 04431000
*/*    UPDCHK2 - SCAN IEBUPDTE CONTROL STATEMENT IN CRPBUFFR AND     */ 04432000
*/*              RETURN TO THE CALLER WITH THE TYPE OF IEBUPDTE      */ 04433000
*/*              CONTROL STATEMENT ENCOUNTERED.                      */ 04434000
*/*                                                                  */ 04435000
*/*              UPDCK                             CHNGMEM           */ 04436000
*/*              -----                          -------------------  */ 04437000
*/*               'C'   - ./ CHANGE              "NAME=" OPERAND     */ 04438000
*/*               'E'   - ./ ENDUPD                  N/A             */ 04439000
*/*               'O'   - "OTHER" THAN ABOVE         N/A             */ 04440000
*/*                                                                  */ 04441000
*/********************************************************************/ 04442000
*                                                                  1283 04443000
*UPDCHK2:                                                          1283 04444000
*   PROC(UPDCK);                                                   1283 04445000
UPDCHK2  STM   @14,@12,@SA00020                                    1283 04446000
         MVC   @PC00020(4),0(@01)                                  1283 04447000
*   DCL                                                            1284 04448000
*     UPDCK CHAR(1);                /* RETURN PARAMETER (SEE ABOVE)  */ 04449000
*   UPDCK=UPDOTHER;                 /* INITIALIZE RETURNED PARAMETER    04450000
*                                      ... WILL BE CHANGED BY SCAN 1285 04451000
*                                      ROUTES IF "CHANGE" OR "ENDUP"    04452000
*                                      STATEMENTS ARE ENCOUNTERED    */ 04453000
*                                                                  1285 04454000
         L     @15,@PC00020                                        1285 04455000
         MVI   UPDCK(@15),C'O'                                     1285 04456000
*   /*****************************************************************/ 04457000
*   /*                                                               */ 04458000
*   /* HMASMSCN PARAMETER INITIALIZATION (HMASMSCP)                  */ 04459000
*   /*                                                               */ 04460000
*   /*****************************************************************/ 04461000
*                                                                  1286 04462000
*   SCPCHAR=ADDR(CRPBUFFR);         /* BEGINNING OF RECORD (WILL BE A   04463000
*                                      './')                         */ 04464000
         L     @15,SCPPTR                                          1286 04465000
         LA    @14,CRPBUFFR                                        1286 04466000
         ST    @14,SCPCHAR(,@15)                                   1286 04467000
*   SCPSRCH=ADDR(UPDDSCAN);         /* DSCANS                        */ 04468000
         LA    @14,UPDDSCAN                                        1287 04469000
         ST    @14,SCPSRCH(,@15)                                   1287 04470000
*   SCPINLN=LENGTH(CRPBUFFR);       /* BUFFER IN CRD PARM LIST       */ 04471000
         MVC   SCPINLN(2,@15),@CH00429                             1288 04472000
*   SCPIORTN=ADDR(HMASMCRD);        /* FOR ADDITIONAL RECORDS DURING    04473000
*                                      SCAN GO HERE                  */ 04474000
         L     @14,@CV01708                                        1289 04475000
         ST    @14,SCPIORTN(,@15)                                  1289 04476000
*   SCPEOR=ZERO;                    /* CLEAR END OF RECORD FLAG      */ 04477000
         MVI   SCPEOR(@15),X'00'                                   1290 04478000
*   SCPCONT=ON;                     /* CHK CONTINUATION IN COL 71    */ 04479000
*   SCPCOMNT=OFF;                   /* COMMENTS ARE NOT APPLICABLE   */ 04480000
*                                                                  1292 04481000
         OI    SCPCONT(@15),B'10000000'                            1292 04482000
         NI    SCPCOMNT(@15),B'11011111'                           1292 04483000
*   /*****************************************************************/ 04484000
*   /*                                                               */ 04485000
*   /* HMASMCRP PARAMETER INITIALIZATION                             */ 04486000
*   /*                                                               */ 04487000
*   /*****************************************************************/ 04488000
*                                                                  1293 04489000
*   CRPUXNUM=UXPUX001;              /* SET RECEIVE USER EXIT         */ 04490000
         MVI   CRPUXNUM,X'01'                                      1293 04491000
*   CRPSCPAD=SCPPTR;                /* SCP ADDRESS                   */ 04492000
         ST    @15,CRPSCPAD                                        1294 04493000
*   CRPINDS=IOPPTFIN;               /* INPUT DATASET (SMPPTFIN)      */ 04494000
         MVI   CRPINDS,X'0A'                                       1295 04495000
*   CRPBFPRM=OFF;                   /* THE BUFFER IS PRIMED NOW BUT     04496000
*                                      WILL NOT BE IF CALLED BY SCN  */ 04497000
*   CRPPTS=ON;                      /* WRITE RECORDS TO SMPPTS       */ 04498000
*   CRPLOG=OFF;                     /* DO NOT WRITE TO SMPLOG        */ 04499000
*   CRPPRINT=OFF;                   /* DO NOT WRITE TO SMPOUT        */ 04500000
*   CRPOTHER=OFF;                   /* DO NOT WRITE TO CRDOUTDS      */ 04501000
*                                                                  1300 04502000
         OI    CRPPTS,B'00100000'                                  1300 04503000
         NI    CRPBFPRM,B'01100011'                                1300 04504000
*   /*****************************************************************/ 04505000
*   /*                                                               */ 04506000
*   /* CALL HMASMSCN TO SCAN FOR INVALID IEBUPDTE STATEMENTS.        */ 04507000
*   /* HMASMCRD WILL BE CALLED FOR IEBUPDTE STATEMENT CONTINUATIONS  */ 04508000
*   /* AND EACH RECORD WILL BE WRITTEN TO SMPPTS, SMPLOG AND SMPOUT. */ 04509000
*   /*                                                               */ 04510000
*   /*****************************************************************/ 04511000
*                                                                  1301 04512000
*   CALL HMASMSCN(HMASMSCP);        /* SCAN STATEMENT                */ 04513000
         ST    @15,@AL00001                                        1301 04514000
         L     @15,@CV01705                                        1301 04515000
         LA    @01,@AL00001                                        1301 04516000
         BALR  @14,@15                                             1301 04517000
*   IF SCPRET>SCPEXC THEN                                          1302 04518000
         L     @15,SCPPTR                                          1302 04519000
         CLI   SCPRET(@15),12                                      1302 04520000
         BNH   @RF01302                                            1302 04521000
*     DO;                                                          1303 04522000
*                                                                  1303 04523000
*       /*************************************************************/ 04524000
*       /*                                                           */ 04525000
*       /* TERMINAL ERROR DURING SCAN                                */ 04526000
*       /*                                                           */ 04527000
*       /*************************************************************/ 04528000
*                                                                  1304 04529000
*       RECXSYSF=ON;                /* FLUSH SYSMOD                  */ 04530000
         OI    RECXSYSF,B'00010000'                                1304 04531000
*       RECXMAX=MAX(RECXMAX,SCPRET);                               1305 04532000
         L     @14,RECXMAX                                         1305 04533000
         SLR   @07,@07                                             1305 04534000
         IC    @07,SCPRET(,@15)                                    1305 04535000
         CR    @14,@07                                             1305 04536000
         BNL   *+6                                                      04537000
         LR    @14,@07                                             1305 04538000
         ST    @14,RECXMAX                                         1305 04539000
*     END;                                                         1306 04540000
*   RETURN;                                                        1307 04541000
@EL00020 DS    0H                                                  1307 04542000
@EF00020 DS    0H                                                  1307 04543000
@ER00020 LM    @14,@12,@SA00020                                    1307 04544000
         BR    @14                                                 1307 04545000
*                                                                  1308 04546000
*   /*****************************************************************/ 04547000
*   /*                                                               */ 04548000
*   /* DSCANS FOR IEBUPDTE CONTROL STATEMENTS                        */ 04549000
*   /*                                                               */ 04550000
*   /*****************************************************************/ 04551000
*                                                                  1308 04552000
*   GEN DATA DEFS(UPDDSCAN) REFS(UPDDCHNG,UPDDENDU,UPDDNAME,UPDDSKIP);  04553000
*                                                                  1308 04554000
*   /*****************************************************************/ 04555000
*   /*                                                               */ 04556000
*   /* DSCAN EXITS FOR IEBUPDTE CONTROL STATEMENTS                   */ 04557000
*   /*                                                               */ 04558000
*   /*****************************************************************/ 04559000
*                                                                  1309 04560000
*   RESPECIFY                                                      1309 04561000
*    (REG1,                                                        1309 04562000
*     REG14) RSTD;                                                 1309 04563000
*                                                                  1309 04564000
*   /*****************************************************************/ 04565000
*   /*                                                               */ 04566000
*   /* IEBUPDTE "./ CHANGE" FOUND                                    */ 04567000
*   /*                                                               */ 04568000
*   /*****************************************************************/ 04569000
*                                                                  1310 04570000
*UPDDCHNG:                                                         1310 04571000
*   PROC;                                                          1310 04572000
         B     @PB00021                                            1310 04573000
UPDDCHNG STM   @14,@12,12(@13)                                     1310 04574000
*   UPDCK=UPDCHANG;                 /* SET RETURNED PARAMETER        */ 04575000
         L     @15,@PC00020                                        1311 04576000
         MVI   UPDCK(@15),C'C'                                     1311 04577000
*   CHNGMEM='        ';             /* BLANK "NAME=" VARIABLE        */ 04578000
         MVC   CHNGMEM(8),@CC02018                                 1312 04579000
*   RETURN;                                                        1313 04580000
@EL00021 DS    0H                                                  1313 04581000
@EF00021 DS    0H                                                  1313 04582000
@ER00021 LM    @14,@12,12(@13)                                     1313 04583000
         BR    @14                                                 1313 04584000
*   END UPDDCHNG;                                                  1314 04585000
*                                                                  1314 04586000
*   /*****************************************************************/ 04587000
*   /*                                                               */ 04588000
*   /* IEBUPDTE "NAME= " FOUND                                       */ 04589000
*   /*                                                               */ 04590000
*   /*****************************************************************/ 04591000
*                                                                  1315 04592000
*UPDDNAME:                                                         1315 04593000
*   PROC;                                                          1315 04594000
UPDDNAME STM   @14,@12,12(@13)                                     1315 04595000
*   CHNGMEM(1:SCPPMLN)=SCPSTRNG(1:SCPPMLN);/* SAVE OPERAND OF "NAME="   04596000
*                                      KEYWORD                       */ 04597000
         L     @15,SCPPTR                                          1316 04598000
         LH    @07,SCPPMLN(,@15)                                   1316 04599000
         BCTR  @07,0                                               1316 04600000
         L     @06,SCPCHAR(,@15)                                   1316 04601000
         EX    @07,@SM02176                                        1316 04602000
*   SCPRET=SCPNDSCN;                /* STOP SCAN ... RETURN TO CALLER*/ 04603000
         MVI   SCPRET(@15),X'04'                                   1317 04604000
*   RETURN;                                                        1318 04605000
@EL00022 DS    0H                                                  1318 04606000
@EF00022 DS    0H                                                  1318 04607000
@ER00022 LM    @14,@12,12(@13)                                     1318 04608000
         BR    @14                                                 1318 04609000
*   END UPDDNAME;                                                  1319 04610000
*                                                                  1319 04611000
*   /*****************************************************************/ 04612000
*   /*                                                               */ 04613000
*   /* KEYWORD OTHER THAN " NAME= " FOUND ON "./ CHANGE"             */ 04614000
*   /*                                                               */ 04615000
*   /*****************************************************************/ 04616000
*                                                                  1320 04617000
*UPDDSKIP:                                                         1320 04618000
*   PROC;                                                          1320 04619000
UPDDSKIP STM   @14,@12,12(@13)                                     1320 04620000
*   IF SCPPMLN=0                    /* ZERO LENGTH ... EQUAL SIGN    */ 04621000
*     THEN                                                         1321 04622000
         L     @15,SCPPTR                                          1321 04623000
         LH    @00,SCPPMLN(,@15)                                   1321 04624000
         LTR   @00,@00                                             1321 04625000
         BNZ   @RF01321                                            1321 04626000
*     SCPPMLN=1;                    /* MAKE SCN THINK LENGTH IS 1    */ 04627000
         MVC   SCPPMLN(2,@15),@CH00041                             1322 04628000
*   RETURN;                                                        1323 04629000
@EL00023 DS    0H                                                  1323 04630000
@EF00023 DS    0H                                                  1323 04631000
@ER00023 LM    @14,@12,12(@13)                                     1323 04632000
         BR    @14                                                 1323 04633000
*   END UPDDSKIP;                                                  1324 04634000
*                                                                  1324 04635000
         B     @EL00023                                            1324 04636000
*   /*****************************************************************/ 04637000
*   /*                                                               */ 04638000
*   /* IEBUPDTE "./ ENDUP " FOUND                                    */ 04639000
*   /*                                                               */ 04640000
*   /*****************************************************************/ 04641000
*                                                                  1325 04642000
*UPDDENDU:                                                         1325 04643000
*   PROC;                                                          1325 04644000
UPDDENDU STM   @14,@12,12(@13)                                     1325 04645000
*   UPDCK=UPDENDUP;                 /* SET RETURNED PARAMETER        */ 04646000
         L     @15,@PC00020                                        1326 04647000
         MVI   UPDCK(@15),C'E'                                     1326 04648000
*   SCPRET=SCPNDSCN;                /* STOP SCAN ... RETURN TO CALLER*/ 04649000
         L     @15,SCPPTR                                          1327 04650000
         MVI   SCPRET(@15),X'04'                                   1327 04651000
*   RETURN;                                                        1328 04652000
@EL00024 DS    0H                                                  1328 04653000
@EF00024 DS    0H                                                  1328 04654000
@ER00024 LM    @14,@12,12(@13)                                     1328 04655000
         BR    @14                                                 1328 04656000
*   END UPDDENDU;                                                  1329 04657000
*   RESPECIFY                                                      1330 04658000
*    (REG1,                                                        1330 04659000
*     REG14) UNRSTD;                                               1330 04660000
*   END UPDCHK2;                                                   1331 04661000
         B     @EL00020                                            1331 04662000
*                                                                  1332 04663000
*/********************************************************************/ 04664000
*/*                                                                  */ 04665000
*/*    RCTPROC - PROCESS RELFILE KEYWORD FOUND ON ++JCLIN AND        */ 04666000
*/*              ELEMENT MODIFICATION CONTROL STATEMENTS.            */ 04667000
*/*                                                                  */ 04668000
*/*        1. CHECK THAT THE RELFILE IS NOT GREATER THAT THE NUMBER  */ 04669000
*/*           OF FILES ON THE CURRENT SYSMOD.                        */ 04670000
*/*                                                                  */ 04671000
*/*        2. PUT THE ELEMENT NAME, TYPE AND ABSOLUTE FILE SEQUENCE  */ 04672000
*/*           NUMBER IN THE RELFILE GTA FILE.                        */ 04673000
*/*                                                                  */ 04674000
*/*                                                                  */ 04675000
*/********************************************************************/ 04676000
*                                                                  1332 04677000
*RCTPROC:                                                          1332 04678000
*   PROC;                                                          1332 04679000
*                                                                  1332 04680000
RCTPROC  STM   @14,@12,@SA00025                                    1332 04681000
*   /*****************************************************************/ 04682000
*   /*                                                               */ 04683000
*   /* CONVERT RELFILE KEYWORD FROM CHARACTER TO BINARY              */ 04684000
*   /*                                                               */ 04685000
*   /*****************************************************************/ 04686000
*                                                                  1333 04687000
*   RADJ=ZEROS;                     /* INIT WORK AREA TO RECEIVE   1333 04688000
*                                      RIGHT-ADJUSTED RELFILE NUMBER */ 04689000
         MVC   RADJ(8),@CC01742                                    1333 04690000
*   JJ=LENGTH(RADJ);                /* INDEX SET TO RIGHT-HAND BYTE  */ 04691000
         MVC   JJ(4),@CF00033                                      1334 04692000
*   DO II=LENGTH(MCBERLF) TO 1 BY-1;/* MOVE THRU MCBERLF FROM RIGHT     04693000
*                                      TO LEFT                       */ 04694000
         LA    @15,4                                               1335 04695000
         ST    @15,II                                              1335 04696000
@DL01335 DS    0H                                                  1336 04697000
*     IF MCBERLF(II)^=' ' THEN      /* IGNORE BLANKS IN MCBERLF      */ 04698000
         L     @14,RECXMCB                                         1336 04699000
         ALR   @15,@14                                             1336 04700000
         CLI   MCBERLF-1(@15),C' '                                 1336 04701000
         BE    @RF01336                                            1336 04702000
*       DO;                                                        1337 04703000
*         RADJ(JJ)=MCBERLF(II);     /* PUT CHAR IN WK AREA           */ 04704000
         L     @15,JJ                                              1338 04705000
         LA    @01,RADJ-1(@15)                                     1338 04706000
         L     @07,II                                              1338 04707000
         ALR   @14,@07                                             1338 04708000
         MVC   0(1,@01),MCBERLF-1(@14)                             1338 04709000
*         JJ=JJ-1;                  /* MOVE WK AREA INDEX 1 TO LEFT  */ 04710000
         BCTR  @15,0                                               1339 04711000
         ST    @15,JJ                                              1339 04712000
*       END;                                                       1340 04713000
*   END;                                                           1341 04714000
@RF01336 SLR   @15,@15                                             1341 04715000
         BCTR  @15,0                                               1341 04716000
         AL    @15,II                                              1341 04717000
         ST    @15,II                                              1341 04718000
         LTR   @15,@15                                             1341 04719000
         BP    @DL01335                                            1341 04720000
*   PACK(PKDEC,RADJ);               /* CONVERT CHAR TO PACKED DECIMAL*/ 04721000
         PACK  PKDEC(8),RADJ(8)                                    1342 04722000
*   CVB(FIX31,PKDEC);               /* CONVERT PACKED DECIMAL TO   1343 04723000
*                                      BINARY                        */ 04724000
         CVB   @15,PKDEC                                           1343 04725000
         ST    @15,FIX31                                           1343 04726000
*   RECXRELM=FIX31;                 /* SET CURRENT ELEMENT'S RELFILE */ 04727000
         STH   @15,RECXRELM                                        1344 04728000
*   IF FIX31>RECXRFLE THEN                                         1345 04729000
         CH    @15,RECXRFLE                                        1345 04730000
         BNH   @RF01345                                            1345 04731000
*     DO;                                                          1346 04732000
*                                                                  1346 04733000
*       /*************************************************************/ 04734000
*       /*                                                           */ 04735000
*       /* RELFILE > FILES                                           */ 04736000
*       /*                                                           */ 04737000
*       /*************************************************************/ 04738000
*                                                                  1347 04739000
*       MGPTYPE=MGPSEV;             /* SEVERE ERROR ... STOP RECEIVE */ 04740000
         MVI   MGPTYPE,X'04'                                       1347 04741000
*       RECXSYSF=ON;                /* STOP THIS SYSMOD              */ 04742000
         OI    RECXSYSF,B'00010000'                                1348 04743000
*       GSMSYNTX=ON;                /* SYNTAX ERROR                  */ 04744000
         LA    @15,GTASM                                           1349 04745000
         OI    GSMSYNTX(@15),B'01000000'                           1349 04746000
*       CALL ERRMSG(HMA350I,NOPART,NOPART);                        1350 04747000
         LA    @01,@AL01350                                        1350 04748000
         BAL   @14,ERRMSG                                          1350 04749000
*     END;                                                         1351 04750000
*   ELSE                                                           1352 04751000
*     DO;                                                          1352 04752000
*                                                                  1352 04753000
         B     @RC01345                                            1352 04754000
@RF01345 DS    0H                                                  1353 04755000
*       /*************************************************************/ 04756000
*       /*                                                           */ 04757000
*       /* SET RELFILE DATA IN RELFILE GTA FILE                      */ 04758000
*       /*                                                           */ 04759000
*       /*************************************************************/ 04760000
*                                                                  1353 04761000
*       RESPECIFY                                                  1353 04762000
*         HMASMGTP BASED(RECXGRFP); /* RELFILE GTP                   */ 04763000
*       IF RECXRELM^=0              /* RELFILE NON-ZERO ?            */ 04764000
*           &RECXSYSF=OFF           /* SYSMOD NOT BEING FLUSHED ?    */ 04765000
*         THEN                                                     1354 04766000
         LH    @15,RECXRELM                                        1354 04767000
         LTR   @15,@15                                             1354 04768000
         BZ    @RF01354                                            1354 04769000
         TM    RECXSYSF,B'00010000'                                1354 04770000
         BNZ   @RF01354                                            1354 04771000
*         DO;                                                      1355 04772000
*           GRFFSEQ=RECXRCUR+RECXRELM-1;/* ABSOLUTE FILE SEQ. NO.    */ 04773000
         LA    @14,GTARF                                           1356 04774000
         AH    @15,RECXRCUR                                        1356 04775000
         BCTR  @15,0                                               1356 04776000
         ST    @15,@TF00001                                        1356 04777000
         MVC   GRFFSEQ(2,@14),@TF00001+2                           1356 04778000
*           IF MCBTYPE^=MCBJCLTP THEN                              1357 04779000
         L     @15,RECXMCB                                         1357 04780000
         CLI   MCBTYPE(@15),10                                     1357 04781000
         BE    @RF01357                                            1357 04782000
*             GRFELEM=MCBENAME;     /* MOD, MAC, SRC MEMBER          */ 04783000
         MVC   GRFELEM(8,@14),MCBENAME(@15)                        1358 04784000
*           ELSE                                                   1359 04785000
*             GRFELEM=RECXIOPP->IOPNAM17;/* JCLIN MEMBER             */ 04786000
         B     @RC01357                                            1359 04787000
@RF01357 LA    @15,GTARF                                           1359 04788000
         MVI   GRFELEM+7(@15),C' '                                 1359 04789000
         L     @14,RECXIOPP                                        1359 04790000
         MVC   GRFELEM(7,@15),IOPNAM17(@14)                        1359 04791000
*           GRFELTY=MCBTYPE;        /* TYPE                          */ 04792000
@RC01357 LA    @15,GTARF                                           1360 04793000
         L     @14,RECXMCB                                         1360 04794000
         MVC   GRFELTY(1,@15),MCBTYPE(@14)                         1360 04795000
*           GRFSM#=RECXIOPP->IOPNAM17;/* SYSMOD NAME                 */ 04796000
         L     @07,RECXIOPP                                        1361 04797000
         MVC   GRFSM#(7,@15),IOPNAM17(@07)                         1361 04798000
*           GRFSTY=RECXIOPP->IOPPTYPE;/* SYSMOD TYPE                 */ 04799000
         MVC   GRFSTY(1,@15),IOPPTYPE(@07)                         1362 04800000
*           GRFFLGS=''B;            /* CLEAR FLAGS                   */ 04801000
         MVI   GRFFLGS(@15),X'00'                                  1363 04802000
*           GRFRELF=MCBERLF;        /* RELFILE KEYWORD CHAR STRING 1364 04803000
*                                      FOR TAPE DSN FORMATION        */ 04804000
         MVC   GRFRELF(4,@15),MCBERLF(@14)                         1364 04805000
*           GRFRELF#=RECXRELM;      /* RELFILE VALUE (BINARY) FOR  1365 04806000
*                                      DASD DSN FORMATION)           */ 04807000
         MVC   GRFRELF#(2,@15),RECXRELM                            1365 04808000
*           GTPFUNCT=GTPADD;        /* ADD TO GTA FILE               */ 04809000
         L     @15,RECXGRFP                                        1366 04810000
         MVI   GTPFUNCT(@15),X'04'                                 1366 04811000
*           CALL HMASMGTA(HMASMGTP);                               1367 04812000
         ST    @15,@AL00001                                        1367 04813000
         L     @15,@CV01706                                        1367 04814000
         LA    @01,@AL00001                                        1367 04815000
         BALR  @14,@15                                             1367 04816000
*           RECXMAX=MAX(RECXMAX,GTPRETRN);                         1368 04817000
*                                                                  1368 04818000
         L     @15,RECXGRFP                                        1368 04819000
         L     @14,RECXMAX                                         1368 04820000
         SLR   @07,@07                                             1368 04821000
         IC    @07,GTPRETRN(,@15)                                  1368 04822000
         CR    @14,@07                                             1368 04823000
         BNL   *+6                                                      04824000
         LR    @14,@07                                             1368 04825000
         ST    @14,RECXMAX                                         1368 04826000
*           /*********************************************************/ 04827000
*           /*                                                       */ 04828000
*           /* SET RELFILE PRESENT IN SUMMARY RECORD                 */ 04829000
*           /*                                                       */ 04830000
*           /*********************************************************/ 04831000
*                                                                  1369 04832000
*           GSMRLFP=ON;             /* RELFILE ELEMENTS PRESENT      */ 04833000
*                                                                  1369 04834000
         LA    @07,GTASM                                           1369 04835000
         OI    GSMRLFP(@07),B'01000000'                            1369 04836000
*           /*********************************************************/ 04837000
*           /*                                                       */ 04838000
*           /* PUT ANY ALIAS NAMES FOR THE ELEMENT INTO THE RELFILE  */ 04839000
*           /* GTA FILE                                              */ 04840000
*           /*                                                       */ 04841000
*           /*********************************************************/ 04842000
*                                                                  1370 04843000
*           IF RECXMAX<STOPFUNC&MCBTYPE^=MCBJCLTP THEN             1370 04844000
         CH    @14,@CH00036                                        1370 04845000
         BNL   @RF01370                                            1370 04846000
         L     @14,RECXMCB                                         1370 04847000
         CLI   MCBTYPE(@14),10                                     1370 04848000
         BE    @RF01370                                            1370 04849000
*             DO;                                                  1371 04850000
*                                                                  1371 04851000
*               /*****************************************************/ 04852000
*               /*                                                   */ 04853000
*               /* FOR NON-JCLIN ELEMENT TYPES, THERE MAY BE ALIAS   */ 04854000
*               /* NAMES IN THE MCB                                  */ 04855000
*               /*                                                   */ 04856000
*               /*****************************************************/ 04857000
*                                                                  1372 04858000
*               IF MCBEDALS(1)^=' ' THEN                           1372 04859000
         CLI   MCBEDALS(@14),C' '                                  1372 04860000
         BE    @RF01372                                            1372 04861000
*                 DO;                                              1373 04862000
*                                                                  1373 04863000
*                   /*************************************************/ 04864000
*                   /*                                               */ 04865000
*                   /* DALIAS ... PUT IT INTO RELFILE GTA FILE       */ 04866000
*                   /*                                               */ 04867000
*                   /*************************************************/ 04868000
*                                                                  1374 04869000
*                   GRFELEM=MCBEDALS;/* ALIAS NAME                   */ 04870000
         LA    @07,GTARF                                           1374 04871000
         MVC   GRFELEM(8,@07),MCBEDALS(@14)                        1374 04872000
*                   CALL HMASMGTA(HMASMGTP);                       1375 04873000
         ST    @15,@AL00001                                        1375 04874000
         L     @15,@CV01706                                        1375 04875000
         LA    @01,@AL00001                                        1375 04876000
         BALR  @14,@15                                             1375 04877000
*                   RECXMAX=MAX(RECXMAX,GTPRETRN);/* IN CASE GTA HAD    04878000
*                                      AN ERROR                      */ 04879000
         L     @15,RECXMAX                                         1376 04880000
         L     @14,RECXGRFP                                        1376 04881000
         SLR   @07,@07                                             1376 04882000
         IC    @07,GTPRETRN(,@14)                                  1376 04883000
         CR    @15,@07                                             1376 04884000
         BNL   *+6                                                      04885000
         LR    @15,@07                                             1376 04886000
         ST    @15,RECXMAX                                         1376 04887000
*                 END;                                             1377 04888000
*                                                                  1377 04889000
*               /*****************************************************/ 04890000
*               /*                                                   */ 04891000
*               /* GO THRU MCB SUB-ENTRIES FOR MALIAS AND TALIAS     */ 04892000
*               /*                                                   */ 04893000
*               /*****************************************************/ 04894000
*                                                                  1378 04895000
*               DO II=1 BY 1 WHILE MCBEND(II)^=IOPEOLST&RECXMAX<   1378 04896000
*                     STOPFUNC;                                    1378 04897000
@RF01372 LA    @15,1                                               1378 04898000
         ST    @15,II                                              1378 04899000
         B     @DE01378                                            1378 04900000
@DL01378 DS    0H                                                  1379 04901000
*                 IF MCBEIND(II)=MCBEALIS THEN                     1379 04902000
         L     @15,RECXMCB                                         1379 04903000
         L     @14,II                                              1379 04904000
         MH    @14,@CH00034                                        1379 04905000
         SLR   @07,@07                                             1379 04906000
         IC    @07,MCBEIND-9(@14,@15)                              1379 04907000
         CH    @07,@CH00232                                        1379 04908000
         BNE   @RF01379                                            1379 04909000
*                   DO;                                            1380 04910000
*                                                                  1380 04911000
*                     /***********************************************/ 04912000
*                     /*                                             */ 04913000
*                     /* MALIAS OR TALIAS ... PUT IT INTO RELFILE GTA*/ 04914000
*                     /*                                             */ 04915000
*                     /***********************************************/ 04916000
*                                                                  1381 04917000
*                     GRFELEM=MCBENTRY(II);/* ALIAS NAME             */ 04918000
         LA    @07,GTARF                                           1381 04919000
         ALR   @15,@14                                             1381 04920000
         MVC   GRFELEM(8,@07),MCBENTRY-9(@15)                      1381 04921000
*                     CALL HMASMGTA(HMASMGTP);                     1382 04922000
         L     @01,RECXGRFP                                        1382 04923000
         ST    @01,@AL00001                                        1382 04924000
         L     @15,@CV01706                                        1382 04925000
         LA    @01,@AL00001                                        1382 04926000
         BALR  @14,@15                                             1382 04927000
*                     RECXMAX=MAX(RECXMAX,GTPRETRN);/* IN CASE GTA 1383 04928000
*                                      HAD AN ERROR                  */ 04929000
         L     @15,RECXMAX                                         1383 04930000
         L     @14,RECXGRFP                                        1383 04931000
         SLR   @07,@07                                             1383 04932000
         IC    @07,GTPRETRN(,@14)                                  1383 04933000
         CR    @15,@07                                             1383 04934000
         BNL   *+6                                                      04935000
         LR    @15,@07                                             1383 04936000
         ST    @15,RECXMAX                                         1383 04937000
*                   END;                                           1384 04938000
*               END;                                               1385 04939000
@RF01379 LA    @15,1                                               1385 04940000
         AL    @15,II                                              1385 04941000
         ST    @15,II                                              1385 04942000
@DE01378 L     @15,II                                              1385 04943000
         MH    @15,@CH00034                                        1385 04944000
         L     @01,RECXMCB                                         1385 04945000
         SLR   @14,@14                                             1385 04946000
         IC    @14,MCBEND-9(@15,@01)                               1385 04947000
         CH    @14,@CH00766                                        1385 04948000
         BE    @DC01378                                            1385 04949000
         L     @15,RECXMAX                                         1385 04950000
         CH    @15,@CH00036                                        1385 04951000
         BL    @DL01378                                            1385 04952000
@DC01378 DS    0H                                                  1386 04953000
*             END;                                                 1386 04954000
*         END;                                                     1387 04955000
*     END;                                                         1388 04956000
*   RETURN;                                                        1389 04957000
@EL00025 DS    0H                                                  1389 04958000
@EF00025 DS    0H                                                  1389 04959000
@ER00025 LM    @14,@12,@SA00025                                    1389 04960000
         BR    @14                                                 1389 04961000
*   END RCTPROC;                                                   1390 04962000
         B     @EL00025                                            1390 04963000
*                                                                  1391 04964000
*/********************************************************************/ 04965000
*/*                                                                  */ 04966000
*/*    SECHK  - DETERMINE WHETHER THE SYSMOD (FOUND IN GSMS#) SHOULD */ 04967000
*/*             BE EXCLUDED FROM RECEIVE PROCESSING.                 */ 04968000
*/*                                                                  */ 04969000
*/*           - ON ENTY:                                             */ 04970000
*/*                                                                  */ 04971000
*/*              - GSMS# IN SUMMARY GTA RECORD SHOULD BE INITIALIZED */ 04972000
*/*                WITH THE SYSMOD-ID TO BE CHECKED FOR EXCLUSION.   */ 04973000
*/*                                                                  */ 04974000
*/*           - ON EXIT:                                             */ 04975000
*/*                                                                  */ 04976000
*/*              -  RECX AND GTA SUMMARY FLAGS SET APPROPRIATELY     */ 04977000
*/*                                                                  */ 04978000
*/********************************************************************/ 04979000
*                                                                  1391 04980000
*SECHK:                                                            1391 04981000
*   PROC;                                                          1391 04982000
*                                                                  1391 04983000
SECHK    STM   @14,@12,@SA00026                                    1391 04984000
*   /*****************************************************************/ 04985000
*   /*                                                               */ 04986000
*   /* CHECK FOR SELECT/EXCLUDE MODE PROCESSING                      */ 04987000
*   /*                                                               */ 04988000
*   /*****************************************************************/ 04989000
*                                                                  1392 04990000
*   IF RECSEL=ON|RECEXC=ON THEN                                    1392 04991000
         L     @15,@PC00001                                        1392 04992000
         TM    RECSEL(@15),B'11000000'                             1392 04993000
         BZ    @RF01392                                            1392 04994000
*     DO;                                                          1393 04995000
*                                                                  1393 04996000
*       /*************************************************************/ 04997000
*       /*                                                           */ 04998000
*       /* SELECT OR EXCLUDE SPECIFIED ... CHECK THE SET FOR THE     */ 04999000
*       /* PRESENCE OF THIS SYSMOD.                                  */ 05000000
*       /*                                                           */ 05001000
*       /*************************************************************/ 05002000
*                                                                  1394 05003000
*       RESPECIFY                                                  1394 05004000
*         HMASMGTP BASED(CCASETAD); /* SET GTP                       */ 05005000
*       HMASMSET=''B;               /* CLEAR SET RECORD              */ 05006000
         XC    HMASMSET(12),HMASMSET                               1395 05007000
*       SENAME=' ';                 /* BLANK NAME FIELD IN RECORD    */ 05008000
         MVI   SENAME+1,C' '                                       1396 05009000
         MVC   SENAME+2(6),SENAME+1                                1396 05010000
         MVI   SENAME,C' '                                         1396 05011000
*       SESMD=ON;                   /* SYSMOD NAME ENTRY IN SET      */ 05012000
         OI    SESMD,B'00000001'                                   1397 05013000
*       SESMDNO=GSMS#;              /* SYSMOD NAME INTO SET          */ 05014000
         LA    @15,GTASM                                           1398 05015000
         MVC   SESMDNO(7),GSMS#(@15)                               1398 05016000
*       GTPBUFAD=ADDR(HMASMSET);    /* POINT TO SET                  */ 05017000
         L     @15,CCASETAD(,CCAPTR)                               1399 05018000
         LA    @14,HMASMSET                                        1399 05019000
         ST    @14,GTPBUFAD(,@15)                                  1399 05020000
*       GTPKEYLN=LENGTH(SELSTENT);  /* KEY LENGTH                    */ 05021000
         MVC   GTPKEYLN(2,@15),@CH00035                            1400 05022000
*       GTPFUNCT=GTPLOC;            /* LOCATE FUNCTION               */ 05023000
         MVI   GTPFUNCT(@15),X'03'                                 1401 05024000
*       CALL HMASMGTA(HMASMGTP);    /* SEE IF SYSMOD IS IN SET       */ 05025000
         ST    @15,@AL00001                                        1402 05026000
         L     @15,@CV01706                                        1402 05027000
         LA    @01,@AL00001                                        1402 05028000
         BALR  @14,@15                                             1402 05029000
*       IF GTPRETRN=GTPGOOD THEN                                   1403 05030000
         L     @01,CCASETAD(,CCAPTR)                               1403 05031000
         CLI   GTPRETRN(@01),0                                     1403 05032000
         BNE   @RF01403                                            1403 05033000
*         DO;                                                      1404 05034000
*                                                                  1404 05035000
*           /*********************************************************/ 05036000
*           /*                                                       */ 05037000
*           /* SYSMOD FOUND IN SET                                   */ 05038000
*           /*                                                       */ 05039000
*           /*********************************************************/ 05040000
*                                                                  1405 05041000
*           IF RECEXC=ON THEN                                      1405 05042000
         L     @15,@PC00001                                        1405 05043000
         TM    RECEXC(@15),B'01000000'                             1405 05044000
         BNO   @RF01405                                            1405 05045000
*             DO;                                                  1406 05046000
*                                                                  1406 05047000
*               /*****************************************************/ 05048000
*               /*                                                   */ 05049000
*               /* EXCLUDE MODE ... STOP THIS SYSMOD                 */ 05050000
*               /*                                                   */ 05051000
*               /*****************************************************/ 05052000
*                                                                  1407 05053000
*               RECXSYSF=ON;        /* FLUSH SYSMOD                  */ 05054000
         OI    RECXSYSF,B'00010000'                                1407 05055000
*               GSMEXCL=ON;         /* EXCLUDED                      */ 05056000
         LA    @15,GTASM                                           1408 05057000
         OI    GSMEXCL(@15),B'00010000'                            1408 05058000
*               MCSCHECK=OFF;       /* SUPPRESS MOD.CNTL.STMT. CHECKS*/ 05059000
         NI    MCSCHECK,B'11111101'                                1409 05060000
*             END;                                                 1410 05061000
*           ELSE                                                   1411 05062000
*             DO;                                                  1411 05063000
*                                                                  1411 05064000
         B     @RC01405                                            1411 05065000
@RF01405 DS    0H                                                  1412 05066000
*               /*****************************************************/ 05067000
*               /*                                                   */ 05068000
*               /* SELECT MODE ... CONTINUE PROCESSING THIS SYSMOD   */ 05069000
*               /*                                                   */ 05070000
*               /*****************************************************/ 05071000
*                                                                  1412 05072000
*               GSMSEL=ON;          /* SELECTED                      */ 05073000
         LA    @15,GTASM                                           1412 05074000
         OI    GSMSEL(@15),B'00010000'                             1412 05075000
*               IF SEFOUND=OFF      /* FOUND BEFORE DURING RECEIVE?  */ 05076000
*                 THEN              /*                               */ 05077000
         TM    SEFOUND,B'00000001'                                 1413 05078000
         BNZ   @RF01413                                            1413 05079000
*                 DO;                                              1414 05080000
*                   RECXSCNT=RECXSCNT-1;/* NO ... DECREMENT SELECT 1415 05081000
*                                      COUNT                         */ 05082000
*                                                                  1415 05083000
         LH    @15,RECXSCNT                                        1415 05084000
         BCTR  @15,0                                               1415 05085000
         STH   @15,RECXSCNT                                        1415 05086000
*                   /*************************************************/ 05087000
*                   /*                                               */ 05088000
*                   /* PUT SET RECORD BACK TO GTA FILE WITH SEFOUND  */ 05089000
*                   /* SET                                           */ 05090000
*                   /*                                               */ 05091000
*                   /*************************************************/ 05092000
*                                                                  1416 05093000
*                   SEFOUND=ON;     /* SELECTED SYSMOD FOUND         */ 05094000
         OI    SEFOUND,B'00000001'                                 1416 05095000
*                   GTPFUNCT=GTPADD;/* ADD FUNCTION                  */ 05096000
         L     @15,CCASETAD(,CCAPTR)                               1417 05097000
         MVI   GTPFUNCT(@15),X'04'                                 1417 05098000
*                   CALL HMASMGTA(HMASMGTP);/* PUT BACK IN GTA FILE  */ 05099000
         ST    @15,@AL00001                                        1418 05100000
         L     @15,@CV01706                                        1418 05101000
         LA    @01,@AL00001                                        1418 05102000
         BALR  @14,@15                                             1418 05103000
*                 END;                                             1419 05104000
*             END;                                                 1420 05105000
*         END;                                                     1421 05106000
*       ELSE                                                       1422 05107000
*         DO;                                                      1422 05108000
*                                                                  1422 05109000
         B     @RC01403                                            1422 05110000
@RF01403 DS    0H                                                  1423 05111000
*           /*********************************************************/ 05112000
*           /*                                                       */ 05113000
*           /* SYSMOD NOT FOUND IN SET                               */ 05114000
*           /*                                                       */ 05115000
*           /*********************************************************/ 05116000
*                                                                  1423 05117000
*           IF RECSEL=ON THEN                                      1423 05118000
         L     @15,@PC00001                                        1423 05119000
         TM    RECSEL(@15),B'10000000'                             1423 05120000
         BNO   @RF01423                                            1423 05121000
*             DO;                                                  1424 05122000
*                                                                  1424 05123000
*               /*****************************************************/ 05124000
*               /*                                                   */ 05125000
*               /* SELECT MODE ... STOP THIS SYSMOD                  */ 05126000
*               /*                                                   */ 05127000
*               /*****************************************************/ 05128000
*                                                                  1425 05129000
*               RECXSYSF=ON;        /* FLUSH SYSMOD                  */ 05130000
         OI    RECXSYSF,B'00010000'                                1425 05131000
*               GSMEXCL=ON;         /* NOT SELECTED                  */ 05132000
         LA    @15,GTASM                                           1426 05133000
         OI    GSMEXCL(@15),B'00010000'                            1426 05134000
*               MCSCHECK=OFF;       /* SUPPRESS MOD.CNTL.STMT. CHECKS*/ 05135000
         NI    MCSCHECK,B'11111101'                                1427 05136000
*             END;                                                 1428 05137000
*         END;                                                     1429 05138000
*     END;                                                         1430 05139000
*   END SECHK;                                                     1431 05140000
@EL00026 DS    0H                                                  1431 05141000
@EF00026 DS    0H                                                  1431 05142000
@ER00026 LM    @14,@12,@SA00026                                    1431 05143000
         BR    @14                                                 1431 05144000
*                                                                  1432 05145000
*/********************************************************************/ 05146000
*/*                                                                  */ 05147000
*/*    DUPCHK - CHECK THE GTA SUMMARY FILE TO DETERMINE WHETHER THE  */ 05148000
*/*             CURRENT SYSMOD (FOUND IN GTA SUMMARY RECORD BUFFER)  */ 05149000
*/*             HAS ALREADY BEEN PROCESSED BY THIS INVOCATION OF     */ 05150000
*/*             RECEIVE                                              */ 05151000
*/*                                                                  */ 05152000
*/********************************************************************/ 05153000
*                                                                  1432 05154000
*DUPCHK:                                                           1432 05155000
*   PROC;                                                          1432 05156000
DUPCHK   STM   @14,@12,@SA00027                                    1432 05157000
*   DCL                                                            1433 05158000
*     GSMBKUP CHAR(LENGTH(GSMREC)); /* SAVES CURRENT SUMMARY RECORD  */ 05159000
*   RESPECIFY                                                      1434 05160000
*     HMASMGTP BASED(RECXGSMP);     /* ADDRESS SUMMARY GTP           */ 05161000
*   GSMRDUP=OFF;                    /* CLEAR DUPLICATE SYSMOD FLAG   */ 05162000
         LA    @15,GTASM                                           1435 05163000
         NI    GSMRDUP(@15),B'11111110'                            1435 05164000
*   GSMBKUP=GSMREC;                 /* BACKUP CURRENT SUMMARY RECORD */ 05165000
         MVC   GSMBKUP(18),GSMREC(@15)                             1436 05166000
*   IF GSMS#^=NULLPTF# THEN                                        1437 05167000
         CLC   GSMS#(7,@15),@CC01733                               1437 05168000
         BE    @RF01437                                            1437 05169000
*     DO;                                                          1438 05170000
*       GTPKEYLN=LENGTH(GSMS#);     /* KEY LENGTH IS ONLY SYSMOD NAME   05171000
*                                      LENGTH                        */ 05172000
         L     @15,RECXGSMP                                        1439 05173000
         MVC   GTPKEYLN(2,@15),@CH00088                            1439 05174000
*       GTPFUNCT=GTPLOC;            /* LOCATE FUNCTION               */ 05175000
         MVI   GTPFUNCT(@15),X'03'                                 1440 05176000
*       CALL HMASMGTA(HMASMGTP);    /*                               */ 05177000
         ST    @15,@AL00001                                        1441 05178000
         L     @15,@CV01706                                        1441 05179000
         LA    @01,@AL00001                                        1441 05180000
         BALR  @14,@15                                             1441 05181000
*       GSMREC=GSMBKUP;             /* RESTORE CURRENT SUMMARY RECORD*/ 05182000
         LA    @15,GTASM                                           1442 05183000
         MVC   GSMREC(18,@15),GSMBKUP                              1442 05184000
*       IF GTPRETRN=GTPGOOD         /* SYSMOD FOUND IN SUMMARY FILE  */ 05185000
*           &GSMEXCL=OFF            /* SYSMOD NOT EXCLUDED           */ 05186000
*         THEN                                                     1443 05187000
         L     @01,RECXGSMP                                        1443 05188000
         CLI   GTPRETRN(@01),0                                     1443 05189000
         BNE   @RF01443                                            1443 05190000
         TM    GSMEXCL(@15),B'00010000'                            1443 05191000
         BNZ   @RF01443                                            1443 05192000
*         DO;                                                      1444 05193000
*                                                                  1444 05194000
*           /*********************************************************/ 05195000
*           /*                                                       */ 05196000
*           /* THIS SYSMOD FOUND TO BE PREVIOUSLY PROCESSED          */ 05197000
*           /*                                                       */ 05198000
*           /*********************************************************/ 05199000
*                                                                  1445 05200000
*           RECXSYSF=ON;            /* SET FLUSH FLAG                */ 05201000
         OI    RECXSYSF,B'00010000'                                1445 05202000
*           GSMRDUP=ON;             /* SET DUPLICATE SYSMOD FLAG     */ 05203000
         OI    GSMRDUP(@15),B'00000001'                            1446 05204000
*         END;                                                     1447 05205000
*       GTPKEYLN=LENGTH(GSMKEY);    /* RESET SUMMARY RECORD KEY    1448 05206000
*                                      LENGTH                        */ 05207000
@RF01443 L     @01,RECXGSMP                                        1448 05208000
         MVC   GTPKEYLN(2,@01),@CH00033                            1448 05209000
*     END;                                                         1449 05210000
*   RETURN;                                                        1450 05211000
@EL00027 DS    0H                                                  1450 05212000
@EF00027 DS    0H                                                  1450 05213000
@ER00027 LM    @14,@12,@SA00027                                    1450 05214000
         BR    @14                                                 1450 05215000
*   END DUPCHK;                                                    1451 05216000
         B     @EL00027                                            1451 05217000
*                                                                  1452 05218000
*/********************************************************************/ 05219000
*/*                                                                  */ 05220000
*/*    VERCHK - ++VER VALIDITY CHECK PROCEDURE                       */ 05221000
*/*                                                                  */ 05222000
*/********************************************************************/ 05223000
*                                                                  1452 05224000
*VERCHK:                                                           1452 05225000
*   PROC(VERCK);                                                   1452 05226000
VERCHK   STM   @14,@12,@SA00028                                    1452 05227000
         MVC   @PC00028(4),0(@01)                                  1452 05228000
*   DCL                                                            1453 05229000
*     VERCK CHAR(1);                /* RETURNED TO CALLER AS: ......    05230000
*                                      'Y' FOR ++VER "OK" ..........    05231000
*                                      'N' FOR ++VER NOT "OK" ...... */ 05232000
*   DCL                                                            1454 05233000
*     1 VERCHKF BIT(8),             /* VERCHK FLAGS                  */ 05234000
*       3 VALIDVER BIT(1),          /* ++VER APPLICABLE TO SMP R4    */ 05235000
*       3 VERCKERR BIT(1),          /* ERROR DETECTED                */ 05236000
*       3 * BIT(6);                 /* UNUSED                        */ 05237000
*   DCL                                                            1455 05238000
*     1 NXTSUBCB BDY(WORD),         /* NEXTSUB PROC VARIABLES/FLAGS  */ 05239000
*      2 SUBINDX FIXED(15),         /* MCB ENTRY INDEX               */ 05240000
*      2 SUBFLGS BIT(8),            /* FLAGS                         */ 05241000
*       3 SUBEFND BIT(1),           /* MCB SUB-ENTRY FOUND           */ 05242000
*       3 * BIT(7),                 /* UNUSED                        */ 05243000
*      2 SUBNTSM# CHAR(7);          /* MCB SUB-ENTRY DATA (SYSMOD #) */ 05244000
*   DCL                                                            1456 05245000
*     PREINDX1 FIXED(31);           /* INDEX 1ST PREREQ SUB-ENTRY    */ 05246000
*   DCL                                                            1457 05247000
*     NPRINDX1 FIXED(31);           /* INDEX 1ST NPRE SUB-ENTRY      */ 05248000
*   DCL                                                            1458 05249000
*     SUPINDX1 FIXED(31);           /* INDEX 1ST SUP SUB-ENTRY       */ 05250000
*   DCL                                                            1459 05251000
*     REQINDX1 FIXED(31);           /* INDEX 1ST REQ SUB-ENTRY       */ 05252000
*   DCL                                                            1460 05253000
*     FIDINDX1 FIXED(31);           /* INDEX FMID SUB-ENTRY          */ 05254000
*   DCL                                                            1461 05255000
*     DELINDX1 FIXED(31);           /* INDEX 1ST DELETE SUB-ENTRY    */ 05256000
*   DCL                                                            1462 05257000
*     VRSINDX1 FIXED(31);           /* INDEX 1ST VERSION SUB-ENTRY   */ 05258000
*   RESPECIFY                                                      1463 05259000
*     HMASMIOP BASED(RECXIOPP);     /* PTS SYSMOD IOP                */ 05260000
*   VERCK=YES;                      /* SET RETURNED PARAMETER        */ 05261000
         L     @15,@PC00028                                        1464 05262000
         MVI   VERCK(@15),C'Y'                                     1464 05263000
*   VERCHKF=''B;                    /* CLEAR LOCAL FLAGS             */ 05264000
*                                                                  1465 05265000
         MVI   VERCHKF,X'00'                                       1465 05266000
*   /*****************************************************************/ 05267000
*   /*                                                               */ 05268000
*   /* CHECK FOR ++VER APPLICABILITY                                 */ 05269000
*   /*                                                               */ 05270000
*   /*****************************************************************/ 05271000
*                                                                  1466 05272000
*   IF IOPPTYPE^=IOPPFUNC           /* NON-FUNCTION SYSMOD           */ 05273000
*       &MCBSFMID=NULLPTF#          /* ... NO FMID OPERAND           */ 05274000
*       &CCAFMID=NULLPTF#           /* ... NO FMID PARM SUPPLIED     */ 05275000
*     THEN                                                         1466 05276000
         L     @01,RECXIOPP                                        1466 05277000
         CLI   IOPPTYPE(@01),4                                     1466 05278000
         BE    @RF01466                                            1466 05279000
         L     @01,RECXMCB                                         1466 05280000
         CLC   MCBSFMID(7,@01),@CC01733                            1466 05281000
         BNE   @RF01466                                            1466 05282000
         CLC   CCAFMID(7,CCAPTR),@CC01733                          1466 05283000
         BNE   @RF01466                                            1466 05284000
*     VERCK=NO;                     /* SET SWITCH - DO NOT PERFORM 1467 05285000
*                                      SUBSEQUENT CHECKS             */ 05286000
*                                                                  1467 05287000
         MVI   VERCK(@15),C'N'                                     1467 05288000
*   /*****************************************************************/ 05289000
*   /*                                                               */ 05290000
*   /* CHECK FOR ++VER CONSISTENCY - FUNCTION-TYPE SYSMODS           */ 05291000
*   /*                                                               */ 05292000
*   /*****************************************************************/ 05293000
*                                                                  1468 05294000
*   IF VERCK=YES                    /* VALID ++VER                   */ 05295000
*       &IOPPTYPE=IOPPFUNC          /* FUNCTION-TYPE SYSMOD          */ 05296000
*       &REL4VER=ON                 /* NOT FIRST VALID ++VER         */ 05297000
*     THEN                                                         1468 05298000
@RF01466 L     @15,@PC00028                                        1468 05299000
         CLI   VERCK(@15),C'Y'                                     1468 05300000
         BNE   @RF01468                                            1468 05301000
         L     @15,RECXIOPP                                        1468 05302000
         CLI   IOPPTYPE(@15),4                                     1468 05303000
         BNE   @RF01468                                            1468 05304000
         TM    REL4VER,B'00100000'                                 1468 05305000
         BNO   @RF01468                                            1468 05306000
*     DO;                                                          1469 05307000
*       IF(MCBSFMID=NULLPTF#        /* NO FMID SPECIFIED             */ 05308000
*           &IOPFLF=OFF)            /* ... NOT FIRST-LEVEL FUNCTION  */ 05309000
*           |(MCBSFMID^=NULLPTF#    /* FMID SPECIFIED                */ 05310000
*           &IOPFLF=ON)             /* ... FIRST-LEVEL-FUNCTION      */ 05311000
*         THEN                                                     1470 05312000
         L     @01,RECXMCB                                         1470 05313000
         CLC   MCBSFMID(7,@01),@CC01733                            1470 05314000
         BNE   @GL00046                                            1470 05315000
         TM    IOPFLF(@15),B'00100000'                             1470 05316000
         BZ    @RT01470                                            1470 05317000
@GL00046 L     @01,RECXMCB                                         1470 05318000
         CLC   MCBSFMID(7,@01),@CC01733                            1470 05319000
         BE    @RF01470                                            1470 05320000
         L     @01,RECXIOPP                                        1470 05321000
         TM    IOPFLF(@01),B'00100000'                             1470 05322000
         BNO   @RF01470                                            1470 05323000
@RT01470 DS    0H                                                  1471 05324000
*         DO;                                                      1471 05325000
*                                                                  1471 05326000
*           /*********************************************************/ 05327000
*           /*                                                       */ 05328000
*           /* THIS ++VER AND PREVIOUSLY ENCOUNTERED ++VERS ARE      */ 05329000
*           /* INCONSISTENT                                          */ 05330000
*           /*                                                       */ 05331000
*           /*********************************************************/ 05332000
*                                                                  1472 05333000
*           VERCKERR=ON;            /* SET ERROR FLAG                */ 05334000
         OI    VERCKERR,B'01000000'                                1472 05335000
*           MGPTYPE=MGPERR;         /* STOP-SYSMOD ERROR             */ 05336000
         MVI   MGPTYPE,X'03'                                       1473 05337000
*           CALL ERRMSG(HMA363I,PART097,NOPART);/* ISSUE MSG         */ 05338000
         LA    @01,@AL01474                                        1474 05339000
         BAL   @14,ERRMSG                                          1474 05340000
*         END;                                                     1475 05341000
*     END;                                                         1476 05342000
*                                                                  1476 05343000
@RF01470 DS    0H                                                  1477 05344000
*   /*****************************************************************/ 05345000
*   /*                                                               */ 05346000
*   /* DETERMINE THE SETTING OF THE "FIRST-LEVEL-FUNCTION" FLAG      */ 05347000
*   /*                                                               */ 05348000
*   /*****************************************************************/ 05349000
*                                                                  1477 05350000
*   IF VERCK=YES                    /* VALID ++VER                   */ 05351000
*       &IOPPTYPE=IOPPFUNC          /* FUNCTION-TYPE SYSMOD          */ 05352000
*       &REL4VER=OFF                /* FIRST VALID ++VER             */ 05353000
*     THEN                                                         1477 05354000
@RF01468 L     @15,@PC00028                                        1477 05355000
         CLI   VERCK(@15),C'Y'                                     1477 05356000
         BNE   @RF01477                                            1477 05357000
         L     @15,RECXIOPP                                        1477 05358000
         CLI   IOPPTYPE(@15),4                                     1477 05359000
         BNE   @RF01477                                            1477 05360000
         TM    REL4VER,B'00100000'                                 1477 05361000
         BNZ   @RF01477                                            1477 05362000
*     DO;                                                          1478 05363000
*       REL4VER=ON;                 /* FIRST VALID REL4 ++VER FOUND  */ 05364000
         OI    REL4VER,B'00100000'                                 1479 05365000
*       IF MCBSFMID=NULLPTF#        /* NO FMID SPECIFIED             */ 05366000
*         THEN                                                     1480 05367000
         L     @01,RECXMCB                                         1480 05368000
         CLC   MCBSFMID(7,@01),@CC01733                            1480 05369000
         BNE   @RF01480                                            1480 05370000
*         IOPFLF=ON;                /* FIRST-LEVEL-FUNCTION          */ 05371000
         OI    IOPFLF(@15),B'00100000'                             1481 05372000
*       ELSE                                                       1482 05373000
*         IOPFLF=OFF;               /* NOT FIRST-LEVEL-FUNCTION      */ 05374000
         B     @RC01480                                            1482 05375000
@RF01480 L     @01,RECXIOPP                                        1482 05376000
         NI    IOPFLF(@01),B'11011111'                             1482 05377000
*     END;                                                         1483 05378000
@RC01480 DS    0H                                                  1484 05379000
*   IF VERCK=YES                    /* VALID ++VER                   */ 05380000
*     THEN                                                         1484 05381000
@RF01477 L     @15,@PC00028                                        1484 05382000
         CLI   VERCK(@15),C'Y'                                     1484 05383000
         BNE   @RF01484                                            1484 05384000
*     DO;                                                          1485 05385000
*                                                                  1485 05386000
*       /*************************************************************/ 05387000
*       /*                                                           */ 05388000
*       /* FIND ++VER OPERANDS IN MCB SUB-ENTRIES                    */ 05389000
*       /*                                                           */ 05390000
*       /*************************************************************/ 05391000
*                                                                  1486 05392000
*       PREINDX1=0;                 /* NO PREREQ OPERANDS FOUND      */ 05393000
         SLR   @15,@15                                             1486 05394000
         ST    @15,PREINDX1                                        1486 05395000
*       NPRINDX1=0;                 /* NO NPRE OPERANDS FOUND        */ 05396000
         ST    @15,NPRINDX1                                        1487 05397000
*       SUPINDX1=0;                 /* NO SUP OPERANDS FOUND         */ 05398000
         ST    @15,SUPINDX1                                        1488 05399000
*       REQINDX1=0;                 /* NO REQ OPERANDS FOUND         */ 05400000
         ST    @15,REQINDX1                                        1489 05401000
*       FIDINDX1=0;                 /* NO FMID OPERANDS FOUND        */ 05402000
         ST    @15,FIDINDX1                                        1490 05403000
*       DELINDX1=0;                 /* NO DELETE OPERANDS FOUND      */ 05404000
         ST    @15,DELINDX1                                        1491 05405000
*       VRSINDX1=0;                 /* NO VERSION OPERANDS FOUND     */ 05406000
         ST    @15,VRSINDX1                                        1492 05407000
*       SUBINDX=1;                  /* INIT. START INDEX FOR NEXTSUB */ 05408000
         MVC   SUBINDX(2),@CH00041                                 1493 05409000
*       CALL NEXTSUB(IOPPPRE);      /* SERACH FOR 1ST PREREQ         */ 05410000
         LA    @01,@AL01494                                        1494 05411000
         BAL   @14,NEXTSUB                                         1494 05412000
*       IF SUBEFND=ON THEN                                         1495 05413000
         TM    SUBEFND,B'10000000'                                 1495 05414000
         BNO   @RF01495                                            1495 05415000
*         PREINDX1=SUBINDX;         /* 1ST PREREQ FOUND              */ 05416000
         LH    @15,SUBINDX                                         1496 05417000
         ST    @15,PREINDX1                                        1496 05418000
*       SUBINDX=1;                  /* INIT. START INDEX FOR NEXTSUB */ 05419000
@RF01495 MVC   SUBINDX(2),@CH00041                                 1497 05420000
*       CALL NEXTSUB(IOPPNPR);      /* SERACH FOR 1ST NPRE           */ 05421000
         LA    @01,@AL01498                                        1498 05422000
         BAL   @14,NEXTSUB                                         1498 05423000
*       IF SUBEFND=ON THEN                                         1499 05424000
         TM    SUBEFND,B'10000000'                                 1499 05425000
         BNO   @RF01499                                            1499 05426000
*         NPRINDX1=SUBINDX;         /* 1ST NPRE FOUND                */ 05427000
         LH    @15,SUBINDX                                         1500 05428000
         ST    @15,NPRINDX1                                        1500 05429000
*       SUBINDX=1;                  /* INIT. START INDEX FOR NEXTSUB */ 05430000
@RF01499 MVC   SUBINDX(2),@CH00041                                 1501 05431000
*       CALL NEXTSUB(IOPPSUPV);     /* SERACH FOR 1ST SUP            */ 05432000
         LA    @01,@AL01502                                        1502 05433000
         BAL   @14,NEXTSUB                                         1502 05434000
*       IF SUBEFND=ON THEN                                         1503 05435000
         TM    SUBEFND,B'10000000'                                 1503 05436000
         BNO   @RF01503                                            1503 05437000
*         SUPINDX1=SUBINDX;         /* 1ST SUP FOUND                 */ 05438000
         LH    @15,SUBINDX                                         1504 05439000
         ST    @15,SUPINDX1                                        1504 05440000
*       SUBINDX=1;                  /* INIT. START INDEX FOR NEXTSUB */ 05441000
@RF01503 MVC   SUBINDX(2),@CH00041                                 1505 05442000
*       CALL NEXTSUB(IOPPREQ);      /* SERACH FOR 1ST REQ            */ 05443000
         LA    @01,@AL01506                                        1506 05444000
         BAL   @14,NEXTSUB                                         1506 05445000
*       IF SUBEFND=ON THEN                                         1507 05446000
         TM    SUBEFND,B'10000000'                                 1507 05447000
         BNO   @RF01507                                            1507 05448000
*         REQINDX1=SUBINDX;         /* 1ST REQ FOUND                 */ 05449000
         LH    @15,SUBINDX                                         1508 05450000
         ST    @15,REQINDX1                                        1508 05451000
*       SUBINDX=1;                  /* INIT. START INDEX FOR NEXTSUB */ 05452000
@RF01507 MVC   SUBINDX(2),@CH00041                                 1509 05453000
*       CALL NEXTSUB(IOPPFID);      /* SERACH FOR FMID OPERAND       */ 05454000
         LA    @01,@AL01510                                        1510 05455000
         BAL   @14,NEXTSUB                                         1510 05456000
*       IF SUBEFND=ON THEN                                         1511 05457000
         TM    SUBEFND,B'10000000'                                 1511 05458000
         BNO   @RF01511                                            1511 05459000
*         FIDINDX1=SUBINDX;         /* FMID FOUND                    */ 05460000
         LH    @15,SUBINDX                                         1512 05461000
         ST    @15,FIDINDX1                                        1512 05462000
*       CALL NEXTSUB(IOPPDEL);      /* SERACH FOR 1ST DELETE         */ 05463000
@RF01511 LA    @01,@AL01513                                        1513 05464000
         BAL   @14,NEXTSUB                                         1513 05465000
*       IF SUBEFND=ON THEN                                         1514 05466000
         TM    SUBEFND,B'10000000'                                 1514 05467000
         BNO   @RF01514                                            1514 05468000
*         DELINDX1=SUBINDX;         /* 1ST DELETE FOUND              */ 05469000
         LH    @15,SUBINDX                                         1515 05470000
         ST    @15,DELINDX1                                        1515 05471000
*       SUBINDX=1;                  /* INIT. START INDEX FOR NEXTSUB */ 05472000
@RF01514 MVC   SUBINDX(2),@CH00041                                 1516 05473000
*       CALL NEXTSUB(IOPPVER);      /* SERACH FOR 1ST VERSION        */ 05474000
         LA    @01,@AL01517                                        1517 05475000
         BAL   @14,NEXTSUB                                         1517 05476000
*       IF SUBEFND=ON THEN                                         1518 05477000
         TM    SUBEFND,B'10000000'                                 1518 05478000
         BNO   @RF01518                                            1518 05479000
*         VRSINDX1=SUBINDX;         /* 1ST VERSION FOUND             */ 05480000
         LH    @15,SUBINDX                                         1519 05481000
         ST    @15,VRSINDX1                                        1519 05482000
*                                                                  1520 05483000
*       /*************************************************************/ 05484000
*       /*                                                           */ 05485000
*       /* CHECK FOR INVALID KEYWORDS ON NON-FUNCTION ++VER STMTS    */ 05486000
*       /*                                                           */ 05487000
*       /*************************************************************/ 05488000
*                                                                  1520 05489000
*       IF IOPPTYPE^=IOPPFUNC       /* NON-FUNCTION SYSMOD           */ 05490000
*         THEN                                                     1520 05491000
@RF01518 L     @01,RECXIOPP                                        1520 05492000
         CLI   IOPPTYPE(@01),4                                     1520 05493000
         BE    @RF01520                                            1520 05494000
*         DO;                                                      1521 05495000
*           IF DELINDX1^=0          /* DELETE KEYWORD FOUND          */ 05496000
*             THEN                                                 1522 05497000
         L     @15,DELINDX1                                        1522 05498000
         LTR   @15,@15                                             1522 05499000
         BZ    @RF01522                                            1522 05500000
*             DO;                                                  1523 05501000
*               VERCKERR=ON;        /* SET VC3 ERROR FLAG            */ 05502000
         OI    VERCKERR,B'01000000'                                1524 05503000
*               VPART#1=MSGDEL;     /* SET UP FOR ERRMSG - 'DELETE'  */ 05504000
         MVC   VPART#1(8),MSGDEL                                   1525 05505000
*               MGPTYPE=MGPERR;     /* STOP-SYSMOD ERROR             */ 05506000
         MVI   MGPTYPE,X'03'                                       1526 05507000
*               CALL ERRMSG(HMA363I,PART098,NOPART);/* ISSUE HMA363I */ 05508000
         LA    @01,@AL01527                                        1527 05509000
         BAL   @14,ERRMSG                                          1527 05510000
*             END;                                                 1528 05511000
*           IF VERCK=YES            /* VALID ++VER                   */ 05512000
*               &NPRINDX1^=0        /* NPRE KEYWORD FOUND            */ 05513000
*             THEN                                                 1529 05514000
@RF01522 L     @15,@PC00028                                        1529 05515000
         CLI   VERCK(@15),C'Y'                                     1529 05516000
         BNE   @RF01529                                            1529 05517000
         L     @15,NPRINDX1                                        1529 05518000
         LTR   @15,@15                                             1529 05519000
         BZ    @RF01529                                            1529 05520000
*             DO;                                                  1530 05521000
*               VERCKERR=ON;        /* SET VC3 ERROR FLAG            */ 05522000
         OI    VERCKERR,B'01000000'                                1531 05523000
*               VPART#1=MSGNPRE;    /* SET UP FOR ERRMSG - 'NPRE'    */ 05524000
         MVC   VPART#1(8),MSGNPRE                                  1532 05525000
*               MGPTYPE=MGPERR;     /* STOP-SYSMOD ERROR             */ 05526000
         MVI   MGPTYPE,X'03'                                       1533 05527000
*               CALL ERRMSG(HMA363I,PART098,NOPART);/* ISSUE HMA363I */ 05528000
         LA    @01,@AL01534                                        1534 05529000
         BAL   @14,ERRMSG                                          1534 05530000
*             END;                                                 1535 05531000
*         END;                      /* END NON-FUNCTION SYSMOD CHECKS*/ 05532000
*                                                                  1536 05533000
@RF01529 DS    0H                                                  1537 05534000
*       /*************************************************************/ 05535000
*       /*                                                           */ 05536000
*       /* COMPARE PREREQ OPERANDS AGAINST SYSMOD-ID                 */ 05537000
*       /*                                                           */ 05538000
*       /*************************************************************/ 05539000
*                                                                  1537 05540000
*       CALL OPRNDSMI(PREINDX1,IOPPPRE);                           1537 05541000
*                                                                  1537 05542000
@RF01520 LA    @01,@AL01537                                        1537 05543000
         BAL   @14,OPRNDSMI                                        1537 05544000
*       /*************************************************************/ 05545000
*       /*                                                           */ 05546000
*       /* COMPARE NPRE OPERANDS AGAINST SYSMOD-ID                   */ 05547000
*       /*                                                           */ 05548000
*       /*************************************************************/ 05549000
*                                                                  1538 05550000
*       CALL OPRNDSMI(NPRINDX1,IOPPNPR);                           1538 05551000
*                                                                  1538 05552000
         LA    @01,@AL01538                                        1538 05553000
         BAL   @14,OPRNDSMI                                        1538 05554000
*       /*************************************************************/ 05555000
*       /*                                                           */ 05556000
*       /* COMPARE FMID OPERAND AGAINST SYSMOD-ID                    */ 05557000
*       /*                                                           */ 05558000
*       /*************************************************************/ 05559000
*                                                                  1539 05560000
*       CALL OPRNDSMI(FIDINDX1,IOPPFID);                           1539 05561000
*                                                                  1539 05562000
         LA    @01,@AL01539                                        1539 05563000
         BAL   @14,OPRNDSMI                                        1539 05564000
*       /*************************************************************/ 05565000
*       /*                                                           */ 05566000
*       /* COMPARE DELETE OPERAND AGAINST SYSMOD-ID                  */ 05567000
*       /*                                                           */ 05568000
*       /*************************************************************/ 05569000
*                                                                  1540 05570000
*       CALL OPRNDSMI(DELINDX1,IOPPDEL);                           1540 05571000
*                                                                  1540 05572000
         LA    @01,@AL01540                                        1540 05573000
         BAL   @14,OPRNDSMI                                        1540 05574000
*       /*************************************************************/ 05575000
*       /*                                                           */ 05576000
*       /* COMPARE SUP OPERAND AGAINST SYSMOD-ID                     */ 05577000
*       /*                                                           */ 05578000
*       /*************************************************************/ 05579000
*                                                                  1541 05580000
*       CALL OPRNDSMI(SUPINDX1,IOPPSUPV);                          1541 05581000
*                                                                  1541 05582000
         LA    @01,@AL01541                                        1541 05583000
         BAL   @14,OPRNDSMI                                        1541 05584000
*       /*************************************************************/ 05585000
*       /*                                                           */ 05586000
*       /* COMPARE PREREQ OPERANDS AGAINST NPRE OPERANDS             */ 05587000
*       /*                                                           */ 05588000
*       /*************************************************************/ 05589000
*                                                                  1542 05590000
*       CALL OPRNDCHK(PREINDX1,IOPPPRE,NPRINDX1,IOPPNPR);          1542 05591000
*                                                                  1542 05592000
         LA    @01,@AL01542                                        1542 05593000
         BAL   @14,OPRNDCHK                                        1542 05594000
*       /*************************************************************/ 05595000
*       /*                                                           */ 05596000
*       /* COMPARE PREREQ OPERANDS AGAINST SUP OPERANDS              */ 05597000
*       /*                                                           */ 05598000
*       /*************************************************************/ 05599000
*                                                                  1543 05600000
*       CALL OPRNDCHK(PREINDX1,IOPPPRE,SUPINDX1,IOPPSUPV);         1543 05601000
*                                                                  1543 05602000
         LA    @01,@AL01543                                        1543 05603000
         BAL   @14,OPRNDCHK                                        1543 05604000
*       /*************************************************************/ 05605000
*       /*                                                           */ 05606000
*       /* COMPARE PREREQ OPERANDS AGAINST REQ OPERANDS              */ 05607000
*       /*                                                           */ 05608000
*       /*************************************************************/ 05609000
*                                                                  1544 05610000
*       CALL OPRNDCHK(PREINDX1,IOPPPRE,REQINDX1,IOPPREQ);          1544 05611000
*                                                                  1544 05612000
         LA    @01,@AL01544                                        1544 05613000
         BAL   @14,OPRNDCHK                                        1544 05614000
*       /*************************************************************/ 05615000
*       /*                                                           */ 05616000
*       /* COMPARE PREREQ OPERANDS AGAINST FMID OPERAND              */ 05617000
*       /*                                                           */ 05618000
*       /*************************************************************/ 05619000
*                                                                  1545 05620000
*       CALL OPRNDCHK(PREINDX1,IOPPPRE,FIDINDX1,IOPPFID);          1545 05621000
*                                                                  1545 05622000
         LA    @01,@AL01545                                        1545 05623000
         BAL   @14,OPRNDCHK                                        1545 05624000
*       /*************************************************************/ 05625000
*       /*                                                           */ 05626000
*       /* COMPARE PREREQ OPERANDS AGAINST DELETE OPERANDS           */ 05627000
*       /*                                                           */ 05628000
*       /*************************************************************/ 05629000
*                                                                  1546 05630000
*       CALL OPRNDCHK(PREINDX1,IOPPPRE,DELINDX1,IOPPDEL);          1546 05631000
*                                                                  1546 05632000
         LA    @01,@AL01546                                        1546 05633000
         BAL   @14,OPRNDCHK                                        1546 05634000
*       /*************************************************************/ 05635000
*       /*                                                           */ 05636000
*       /* COMPARE NPRE OPERANDS AGAINST SUP OPERANDS                */ 05637000
*       /*                                                           */ 05638000
*       /*************************************************************/ 05639000
*                                                                  1547 05640000
*       CALL OPRNDCHK(NPRINDX1,IOPPNPR,SUPINDX1,IOPPSUPV);         1547 05641000
*                                                                  1547 05642000
         LA    @01,@AL01547                                        1547 05643000
         BAL   @14,OPRNDCHK                                        1547 05644000
*       /*************************************************************/ 05645000
*       /*                                                           */ 05646000
*       /* COMPARE NPRE OPERANDS AGAINST REQ OPERANDS                */ 05647000
*       /*                                                           */ 05648000
*       /*************************************************************/ 05649000
*                                                                  1548 05650000
*       CALL OPRNDCHK(NPRINDX1,IOPPNPR,REQINDX1,IOPPREQ);          1548 05651000
*                                                                  1548 05652000
         LA    @01,@AL01548                                        1548 05653000
         BAL   @14,OPRNDCHK                                        1548 05654000
*       /*************************************************************/ 05655000
*       /*                                                           */ 05656000
*       /* COMPARE NPRE OPERANDS AGAINST FMID OPERAND                */ 05657000
*       /*                                                           */ 05658000
*       /*************************************************************/ 05659000
*                                                                  1549 05660000
*       CALL OPRNDCHK(NPRINDX1,IOPPNPR,FIDINDX1,IOPPFID);          1549 05661000
*                                                                  1549 05662000
         LA    @01,@AL01549                                        1549 05663000
         BAL   @14,OPRNDCHK                                        1549 05664000
*       /*************************************************************/ 05665000
*       /*                                                           */ 05666000
*       /* COMPARE NPRE OPERANDS AGAINST DELETE OPERANDS             */ 05667000
*       /*                                                           */ 05668000
*       /*************************************************************/ 05669000
*                                                                  1550 05670000
*       CALL OPRNDCHK(NPRINDX1,IOPPNPR,DELINDX1,IOPPDEL);          1550 05671000
*                                                                  1550 05672000
         LA    @01,@AL01550                                        1550 05673000
         BAL   @14,OPRNDCHK                                        1550 05674000
*       /*************************************************************/ 05675000
*       /*                                                           */ 05676000
*       /* COMPARE SUP OPERANDS AGAINST REQ OPERANDS                 */ 05677000
*       /*                                                           */ 05678000
*       /*************************************************************/ 05679000
*                                                                  1551 05680000
*       CALL OPRNDCHK(SUPINDX1,IOPPSUPV,REQINDX1,IOPPREQ);         1551 05681000
*                                                                  1551 05682000
         LA    @01,@AL01551                                        1551 05683000
         BAL   @14,OPRNDCHK                                        1551 05684000
*       /*************************************************************/ 05685000
*       /*                                                           */ 05686000
*       /* COMPARE SUP OPERANDS AGAINST FMID OPERAND                 */ 05687000
*       /*                                                           */ 05688000
*       /*************************************************************/ 05689000
*                                                                  1552 05690000
*       CALL OPRNDCHK(SUPINDX1,IOPPSUPV,FIDINDX1,IOPPFID);         1552 05691000
*                                                                  1552 05692000
         LA    @01,@AL01552                                        1552 05693000
         BAL   @14,OPRNDCHK                                        1552 05694000
*       /*************************************************************/ 05695000
*       /*                                                           */ 05696000
*       /* COMPARE SUP OPERANDS AGAINST DELETE OPERANDS              */ 05697000
*       /*                                                           */ 05698000
*       /*************************************************************/ 05699000
*                                                                  1553 05700000
*       CALL OPRNDCHK(SUPINDX1,IOPPSUPV,DELINDX1,IOPPDEL);         1553 05701000
*                                                                  1553 05702000
         LA    @01,@AL01553                                        1553 05703000
         BAL   @14,OPRNDCHK                                        1553 05704000
*       /*************************************************************/ 05705000
*       /*                                                           */ 05706000
*       /* COMPARE REQ OPERANDS AGAINST FMID OPERAND                 */ 05707000
*       /*                                                           */ 05708000
*       /*************************************************************/ 05709000
*                                                                  1554 05710000
*       CALL OPRNDCHK(REQINDX1,IOPPREQ,FIDINDX1,IOPPFID);          1554 05711000
*                                                                  1554 05712000
         LA    @01,@AL01554                                        1554 05713000
         BAL   @14,OPRNDCHK                                        1554 05714000
*       /*************************************************************/ 05715000
*       /*                                                           */ 05716000
*       /* COMPARE REQ OPERANDS AGAINST DELETE OPERANDS              */ 05717000
*       /*                                                           */ 05718000
*       /*************************************************************/ 05719000
*                                                                  1555 05720000
*       CALL OPRNDCHK(REQINDX1,IOPPREQ,DELINDX1,IOPPDEL);          1555 05721000
*                                                                  1555 05722000
         LA    @01,@AL01555                                        1555 05723000
         BAL   @14,OPRNDCHK                                        1555 05724000
*       /*************************************************************/ 05725000
*       /*                                                           */ 05726000
*       /* COMPARE FMID OPERAND AGAINST DELETE OPERANDS              */ 05727000
*       /*                                                           */ 05728000
*       /*************************************************************/ 05729000
*                                                                  1556 05730000
*       CALL OPRNDCHK(FIDINDX1,IOPPFID,DELINDX1,IOPPDEL);          1556 05731000
*                                                                  1556 05732000
         LA    @01,@AL01556                                        1556 05733000
         BAL   @14,OPRNDCHK                                        1556 05734000
*       /*************************************************************/ 05735000
*       /*                                                           */ 05736000
*       /* COMPARE VERSION OPERANDS AGAINST FMID OPERAND             */ 05737000
*       /*                                                           */ 05738000
*       /*************************************************************/ 05739000
*                                                                  1557 05740000
*       CALL OPRNDCHK(FIDINDX1,IOPPFID,VRSINDX1,IOPPVER);          1557 05741000
         LA    @01,@AL01557                                        1557 05742000
         BAL   @14,OPRNDCHK                                        1557 05743000
*     END;                                                         1558 05744000
*                                                                  1559 05745000
*   /*****************************************************************/ 05746000
*   /*                                                               */ 05747000
*   /* GO THRU ALL SRELS IN MCB AND CHECK THE SRELFMID GTA FILE TO   */ 05748000
*   /* DETERMINE WHETHER ANOTHER ++VER IN THIS SYSMOD SPECIFIED THE  */ 05749000
*   /* SAME SREL-FMID PAIR AS THIS ++VER                             */ 05750000
*   /*                                                               */ 05751000
*   /*****************************************************************/ 05752000
*                                                                  1559 05753000
*   DO II=1 BY 1 WHILE(MCBVND(II)^=IOPEOLST/* NOT END OF MCB         */ 05754000
*         &VERCK=YES);              /* VALID ++VER                   */ 05755000
@RF01484 LA    @15,1                                               1559 05756000
         ST    @15,II                                              1559 05757000
         B     @DE01559                                            1559 05758000
@DL01559 DS    0H                                                  1560 05759000
*     RESPECIFY                                                    1560 05760000
*       HMASMGTP BASED(RECXGSRP);   /* SRELFMID GTP                  */ 05761000
*     IF MCBVIND(II)=IOPPSREL THEN                                 1561 05762000
         L     @15,RECXMCB                                         1561 05763000
         L     @14,II                                              1561 05764000
         MH    @14,@CH00034                                        1561 05765000
         SLR   @07,@07                                             1561 05766000
         IC    @07,MCBVIND-9(@14,@15)                              1561 05767000
         CH    @07,@CH01190                                        1561 05768000
         BNE   @RF01561                                            1561 05769000
*       DO;                                                        1562 05770000
*                                                                  1562 05771000
*         /***********************************************************/ 05772000
*         /*                                                         */ 05773000
*         /* SREL FOUND IN MCB                                       */ 05774000
*         /*                                                         */ 05775000
*         /***********************************************************/ 05776000
*                                                                  1563 05777000
*         GSRSREL(1:4)=MCBVNUM(II,1:4);/* PUT SREL IN SRELFMID RECORD*/ 05778000
         LA    @07,GTASR                                           1563 05779000
         ALR   @14,@15                                             1563 05780000
         BCTR  @14,0                                               1563 05781000
         MVC   GSRSREL(4,@07),MCBVNUM-8(@14)                       1563 05782000
*         GSRFMID=MCBSFMID;         /* PUT FMID IN SRELFMID RECORD 1564 05783000
*                                      KEY                           */ 05784000
         MVC   GSRFMID(7,@07),MCBSFMID(@15)                        1564 05785000
*         GTPFUNCT=GTPLOC;          /* LOCATE FUNCTION               */ 05786000
         L     @15,RECXGSRP                                        1565 05787000
         MVI   GTPFUNCT(@15),X'03'                                 1565 05788000
*         CALL HMASMGTA(HMASMGTP);  /* SEE IF THERE IS A MATCH       */ 05789000
         ST    @15,@AL00001                                        1566 05790000
         L     @15,@CV01706                                        1566 05791000
         LA    @01,@AL00001                                        1566 05792000
         BALR  @14,@15                                             1566 05793000
*         IF GTPRETRN=GTPGOOD THEN                                 1567 05794000
         L     @01,RECXGSRP                                        1567 05795000
         CLI   GTPRETRN(@01),0                                     1567 05796000
         BNE   @RF01567                                            1567 05797000
*           DO;                                                    1568 05798000
*                                                                  1568 05799000
*             /*******************************************************/ 05800000
*             /*                                                     */ 05801000
*             /* MATCH FOUND ... MORE THAN ONE VERIFY FOR THE SAME   */ 05802000
*             /* SREL-FMID PAIR ... ISSUE HMA348I                    */ 05803000
*             /*                                                     */ 05804000
*             /*******************************************************/ 05805000
*                                                                  1569 05806000
*             VERCK=NO;             /* RESET SWITCH TO STOP        1569 05807000
*                                      SUBSEQUENT CHECKS             */ 05808000
         L     @15,@PC00028                                        1569 05809000
         MVI   VERCK(@15),C'N'                                     1569 05810000
*             VERCKERR=ON;          /* SET ERROR SWITCH              */ 05811000
         OI    VERCKERR,B'01000000'                                1570 05812000
*             MGPTYPE=MGPERR;       /* STOP-SYSMOD ERROR             */ 05813000
         MVI   MGPTYPE,X'03'                                       1571 05814000
*             CALL ERRMSG(HMA348I,NOPART,NOPART);                  1572 05815000
         LA    @01,@AL01572                                        1572 05816000
         BAL   @14,ERRMSG                                          1572 05817000
*           END;                                                   1573 05818000
*       END;                                                       1574 05819000
@RF01567 DS    0H                                                  1575 05820000
*   END;                                                           1575 05821000
@RF01561 LA    @15,1                                               1575 05822000
         AL    @15,II                                              1575 05823000
         ST    @15,II                                              1575 05824000
@DE01559 L     @15,II                                              1575 05825000
         MH    @15,@CH00034                                        1575 05826000
         L     @01,RECXMCB                                         1575 05827000
         BCTR  @01,0                                               1575 05828000
         SLR   @14,@14                                             1575 05829000
         IC    @14,MCBVND-8(@15,@01)                               1575 05830000
         CH    @14,@CH00766                                        1575 05831000
         BE    @DC01559                                            1575 05832000
         L     @15,@PC00028                                        1575 05833000
         CLI   VERCK(@15),C'Y'                                     1575 05834000
         BE    @DL01559                                            1575 05835000
@DC01559 DS    0H                                                  1576 05836000
*                                                                  1576 05837000
*   /*****************************************************************/ 05838000
*   /*                                                               */ 05839000
*   /* PUT THE SREL-FMID PAIRS FROM THIS ++VER INTO THE SRELFMID GTA */ 05840000
*   /* FILE                                                          */ 05841000
*   /*                                                               */ 05842000
*   /*****************************************************************/ 05843000
*                                                                  1576 05844000
*   IF VERCK=YES                    /* VALID ++VER                   */ 05845000
*       &VERCKERR=OFF               /* NO ERROR(S) DETECTED          */ 05846000
*     THEN                                                         1576 05847000
         L     @15,@PC00028                                        1576 05848000
         CLI   VERCK(@15),C'Y'                                     1576 05849000
         BNE   @RF01576                                            1576 05850000
         TM    VERCKERR,B'01000000'                                1576 05851000
         BNZ   @RF01576                                            1576 05852000
*     DO;                                                          1577 05853000
*                                                                  1577 05854000
*       /*************************************************************/ 05855000
*       /*                                                           */ 05856000
*       /* GO THRU ALL SRELS IN MCB                                  */ 05857000
*       /*                                                           */ 05858000
*       /*************************************************************/ 05859000
*                                                                  1578 05860000
*       DO II=1 BY 1 WHILE MCBVND(II)^=IOPEOLST&RECXMAX<STOPFUNC;  1578 05861000
         LA    @15,1                                               1578 05862000
         ST    @15,II                                              1578 05863000
         B     @DE01578                                            1578 05864000
@DL01578 DS    0H                                                  1579 05865000
*         IF MCBVIND(II)=IOPPSREL THEN                             1579 05866000
         L     @15,RECXMCB                                         1579 05867000
         L     @14,II                                              1579 05868000
         MH    @14,@CH00034                                        1579 05869000
         SLR   @07,@07                                             1579 05870000
         IC    @07,MCBVIND-9(@14,@15)                              1579 05871000
         CH    @07,@CH01190                                        1579 05872000
         BNE   @RF01579                                            1579 05873000
*           DO;                                                    1580 05874000
*                                                                  1580 05875000
*             /*******************************************************/ 05876000
*             /*                                                     */ 05877000
*             /* SREL FOUND IN MCB                                   */ 05878000
*             /*                                                     */ 05879000
*             /*******************************************************/ 05880000
*                                                                  1581 05881000
*             GSRSREL=MCBVNUM(II,1:4);/* PUT SREL IN SRELFMID RECORD */ 05882000
         LA    @07,GTASR                                           1581 05883000
         ALR   @14,@15                                             1581 05884000
         BCTR  @14,0                                               1581 05885000
         MVC   GSRSREL(4,@07),MCBVNUM-8(@14)                       1581 05886000
*             GSRFMID=MCBSFMID;     /* PUT FMID IN SRELFMID RECORD 1582 05887000
*                                      KEY                           */ 05888000
         MVC   GSRFMID(7,@07),MCBSFMID(@15)                        1582 05889000
*             GTPFUNCT=GTPADD;      /* ADD FUNCTION                  */ 05890000
         L     @15,RECXGSRP                                        1583 05891000
         MVI   GTPFUNCT(@15),X'04'                                 1583 05892000
*             CALL HMASMGTA(HMASMGTP);/* ADD RECORD TO FILE          */ 05893000
         ST    @15,@AL00001                                        1584 05894000
         L     @15,@CV01706                                        1584 05895000
         LA    @01,@AL00001                                        1584 05896000
         BALR  @14,@15                                             1584 05897000
*             IF GTPRETRN>GTPGOOD THEN                             1585 05898000
*                                                                  1585 05899000
         L     @15,RECXGSRP                                        1585 05900000
         CLI   GTPRETRN(@15),0                                     1585 05901000
         BNH   @RF01585                                            1585 05902000
*               /*****************************************************/ 05903000
*               /*                                                   */ 05904000
*               /* ERROR ADDING TO GTA FILE ... OUT OF STORAGE       */ 05905000
*               /*                                                   */ 05906000
*               /*****************************************************/ 05907000
*                                                                  1586 05908000
*               RECXMAX=MAX(RECXMAX,GTPRETRN);                     1586 05909000
         L     @14,RECXMAX                                         1586 05910000
         SLR   @07,@07                                             1586 05911000
         IC    @07,GTPRETRN(,@15)                                  1586 05912000
         CR    @14,@07                                             1586 05913000
         BNL   *+6                                                      05914000
         LR    @14,@07                                             1586 05915000
         ST    @14,RECXMAX                                         1586 05916000
*           END;                                                   1587 05917000
@RF01585 DS    0H                                                  1588 05918000
*       END;                                                       1588 05919000
@RF01579 LA    @15,1                                               1588 05920000
         AL    @15,II                                              1588 05921000
         ST    @15,II                                              1588 05922000
@DE01578 L     @15,II                                              1588 05923000
         MH    @15,@CH00034                                        1588 05924000
         L     @01,RECXMCB                                         1588 05925000
         BCTR  @01,0                                               1588 05926000
         SLR   @14,@14                                             1588 05927000
         IC    @14,MCBVND-8(@15,@01)                               1588 05928000
         CH    @14,@CH00766                                        1588 05929000
         BE    @DC01578                                            1588 05930000
         L     @15,RECXMAX                                         1588 05931000
         CH    @15,@CH00036                                        1588 05932000
         BL    @DL01578                                            1588 05933000
@DC01578 DS    0H                                                  1589 05934000
*     END;                                                         1589 05935000
*                                                                  1590 05936000
*   /*****************************************************************/ 05937000
*   /*                                                               */ 05938000
*   /* VERCHK PROCESSING COMPLETE ... RETURN TO CALLER               */ 05939000
*   /*                                                               */ 05940000
*   /*****************************************************************/ 05941000
*                                                                  1590 05942000
*   IF VERCKERR=OFF                 /* NO ERRORS DETECTED            */ 05943000
*     THEN                                                         1590 05944000
@RF01576 TM    VERCKERR,B'01000000'                                1590 05945000
         BNZ   @RF01590                                            1590 05946000
*     VERCK=YES;                    /* SET PARM RETURNED TO CALLER   */ 05947000
         L     @15,@PC00028                                        1591 05948000
         MVI   VERCK(@15),C'Y'                                     1591 05949000
*   ELSE                                                           1592 05950000
*     DO;                                                          1592 05951000
*                                                                  1592 05952000
         B     @RC01590                                            1592 05953000
@RF01590 DS    0H                                                  1593 05954000
*       /*************************************************************/ 05955000
*       /*                                                           */ 05956000
*       /* ++VER STATEMENT CONSTRUCTION ERROR ... FLUSH SYSMOD       */ 05957000
*       /*                                                           */ 05958000
*       /*************************************************************/ 05959000
*                                                                  1593 05960000
*       VERCK=NO;                   /* SET PARM RETURNED TO CALLER   */ 05961000
         L     @15,@PC00028                                        1593 05962000
         MVI   VERCK(@15),C'N'                                     1593 05963000
*       RECXSYSF=ON;                /* FLUSH SYSMOD                  */ 05964000
         OI    RECXSYSF,B'00010000'                                1594 05965000
*       RECXGSMP->GTPBUFAD->GSMSYNTX=ON;/* SET SYNTAX IN SUMMARY   1595 05966000
*                                      RECORD                        */ 05967000
         L     @01,RECXGSMP                                        1595 05968000
         L     @01,GTPBUFAD(,@01)                                  1595 05969000
         OI    GSMSYNTX(@01),B'01000000'                           1595 05970000
*     END;                                                         1596 05971000
*                                                                  1597 05972000
*/********************************************************************/ 05973000
*/*                                                                  */ 05974000
*/*    OPRNDCHK - ++VER OPERAND CHECK                                */ 05975000
*/*                                                                  */ 05976000
*/*               FOR THE CURRENT ++VER, COMPARE ALL OPERANDS OF     */ 05977000
*/*               THE FIRST KEYWORD TYPE (OPR1TYPE) WITH ALL OPERANDS*/ 05978000
*/*               OF THE SECOND KEYWORD TYPE (OPR2TYPE)              */ 05979000
*/*                                                                  */ 05980000
*/********************************************************************/ 05981000
*                                                                  1597 05982000
*OPRNDCHK:                                                         1597 05983000
*   PROC(OPR1INDX,OPR1TYPE,OPR2INDX,OPR2TYPE);                     1597 05984000
         B     @PB00029                                            1597 05985000
OPRNDCHK STM   @14,@12,@SA00029                                    1597 05986000
         MVC   @PC00029(16),0(@01)                                 1597 05987000
*   DCL                                                            1598 05988000
*     OPR1INDX FIXED(31);           /* INDEX OF FIRST SUB-ENTRY FOR     05989000
*                                      OPERAND 1                     */ 05990000
*   DCL                                                            1599 05991000
*     OPR1TYPE CHAR(1);             /* OPERAND 1 TYPE (KEYWORD)      */ 05992000
*   DCL                                                            1600 05993000
*     OPR2INDX FIXED(31);           /* INDEX OF FIRST SUB-ENTRY FOR     05994000
*                                      OPERAND 2                     */ 05995000
*   DCL                                                            1601 05996000
*     OPR2TYPE CHAR(1);             /* OPERAND 2 TYPE (KEYWORD)      */ 05997000
*   DCL                                                            1602 05998000
*     LOCAL1X FIXED(31);            /* LOCAL INDEX FOR OPERAND 1   1602 05999000
*                                      KEYWORD SUB-ENTRIES           */ 06000000
*   DCL                                                            1603 06001000
*     LOCAL2X FIXED(31);            /* LOCAL INDEX FOR OPERAND 2   1603 06002000
*                                      KEYWORD SUB-ENTRIES           */ 06003000
*   IF OPR1INDX^=0&OPR2INDX^=0 THEN                                1604 06004000
         SLR   @15,@15                                             1604 06005000
         L     @14,@PC00029                                        1604 06006000
         L     @14,OPR1INDX(,@14)                                  1604 06007000
         CR    @14,@15                                             1604 06008000
         BE    @RF01604                                            1604 06009000
         L     @07,@PC00029+8                                      1604 06010000
         C     @15,OPR2INDX(,@07)                                  1604 06011000
         BE    @RF01604                                            1604 06012000
*     DO;                                                          1605 06013000
*       LOCAL1X=OPR1INDX;           /* START WITH FIRST KEYWORD 1  1606 06014000
*                                      OPERAND                       */ 06015000
*                                                                  1606 06016000
         ST    @14,LOCAL1X                                         1606 06017000
*       /*************************************************************/ 06018000
*       /*                                                           */ 06019000
*       /* GO THRU ALL KEYWORD 1 OPERANDS                            */ 06020000
*       /*                                                           */ 06021000
*       /*************************************************************/ 06022000
*                                                                  1607 06023000
*       DO WHILE LOCAL1X^=0;                                       1607 06024000
         B     @DE01607                                            1607 06025000
@DL01607 DS    0H                                                  1608 06026000
*         LOCAL2X=OPR2INDX;         /* FIRST KEYWORD 2 OPERAND       */ 06027000
*                                                                  1608 06028000
         L     @15,@PC00029+8                                      1608 06029000
         MVC   LOCAL2X(4),OPR2INDX(@15)                            1608 06030000
*         /***********************************************************/ 06031000
*         /*                                                         */ 06032000
*         /* GO THRU ALL KEYWORD 2 OPERANDS                          */ 06033000
*         /*                                                         */ 06034000
*         /***********************************************************/ 06035000
*                                                                  1609 06036000
*         DO WHILE LOCAL2X^=0;                                     1609 06037000
         B     @DE01609                                            1609 06038000
@DL01609 DS    0H                                                  1610 06039000
*           IF MCBVNTRY(LOCAL2X)=MCBVNTRY(LOCAL1X) THEN            1610 06040000
         L     @15,RECXMCB                                         1610 06041000
         LA    @14,9                                               1610 06042000
         L     @01,LOCAL2X                                         1610 06043000
         MR    @00,@14                                             1610 06044000
         LR    @03,@14                                             1610 06045000
         M     @02,LOCAL1X                                         1610 06046000
         ST    @01,@TF00001                                        1610 06047000
         ALR   @01,@15                                             1610 06048000
         BCTR  @01,0                                               1610 06049000
         ALR   @03,@15                                             1610 06050000
         BCTR  @03,0                                               1610 06051000
         CLC   MCBVNTRY-8(8,@01),MCBVNTRY-8(@03)                   1610 06052000
         BNE   @RF01610                                            1610 06053000
*             DO;                                                  1611 06054000
*                                                                  1611 06055000
*               /*****************************************************/ 06056000
*               /*                                                   */ 06057000
*               /* KWRD 1 OPERAND APPEARS AS AN KWRD 2 OPERAND       */ 06058000
*               /*                                                   */ 06059000
*               /*****************************************************/ 06060000
*                                                                  1612 06061000
*               VERCKERR=ON;        /* SET VERCHK2 ERROR FLAG        */ 06062000
         OI    VERCKERR,B'01000000'                                1612 06063000
*               VPARTS=' ';                                        1613 06064000
         MVI   VPARTS+1,C' '                                       1613 06065000
         MVC   VPARTS+2(22),VPARTS+1                               1613 06066000
         MVI   VPARTS,C' '                                         1613 06067000
*               VPART#1=MCBVNUM(LOCAL2X);/* OPERAND VALUE            */ 06068000
         MVI   VPART#1+7,C' '                                      1614 06069000
         AL    @15,@TF00001                                        1614 06070000
         BCTR  @15,0                                               1614 06071000
         MVC   VPART#1(7),MCBVNUM-8(@15)                           1614 06072000
*               CALL OPRNDKEY(OPR1TYPE,VPART#2);/* KEYWORD           */ 06073000
         L     @15,@PC00029+4                                      1615 06074000
         ST    @15,@AL00001                                        1615 06075000
         LA    @15,VPART#2                                         1615 06076000
         ST    @15,@AL00001+4                                      1615 06077000
         LA    @01,@AL00001                                        1615 06078000
         BAL   @14,OPRNDKEY                                        1615 06079000
*               CALL OPRNDKEY(OPR2TYPE,VPART#3);/* KEYWORD           */ 06080000
         L     @15,@PC00029+12                                     1616 06081000
         ST    @15,@AL00001                                        1616 06082000
         LA    @15,VPART#3                                         1616 06083000
         ST    @15,@AL00001+4                                      1616 06084000
         LA    @01,@AL00001                                        1616 06085000
         BAL   @14,OPRNDKEY                                        1616 06086000
*               MGPTYPE=MGPERR;     /* SET MESSAGE SEVERITY          */ 06087000
         MVI   MGPTYPE,X'03'                                       1617 06088000
*               CALL ERRMSG(HMA363I,PART094,NOPART);/* ISSUE HMA363I */ 06089000
         LA    @01,@AL01618                                        1618 06090000
         BAL   @14,ERRMSG                                          1618 06091000
*             END;                                                 1619 06092000
*           SUBINDX=LOCAL2X+1;      /* SET UP TO SEARCH FOR NEXT OPR2*/ 06093000
@RF01610 L     @01,LOCAL2X                                         1620 06094000
         LA    @01,1(,@01)                                         1620 06095000
         STH   @01,SUBINDX                                         1620 06096000
*           CALL NEXTSUB(OPR2TYPE); /* SERACH FOR OPR2 SUB-ENTRY     */ 06097000
         L     @15,@PC00029+12                                     1621 06098000
         ST    @15,@AL00001                                        1621 06099000
         LA    @01,@AL00001                                        1621 06100000
         BAL   @14,NEXTSUB                                         1621 06101000
*           IF SUBEFND=OFF THEN                                    1622 06102000
         TM    SUBEFND,B'10000000'                                 1622 06103000
         BNZ   @RF01622                                            1622 06104000
*             LOCAL2X=0;            /* NO MORE KEYWORD 2 OPERANDS    */ 06105000
         SLR   @15,@15                                             1623 06106000
         ST    @15,LOCAL2X                                         1623 06107000
*           ELSE                                                   1624 06108000
*             LOCAL2X=SUBINDX;      /* INDEX OF NEXT KWRD 2 OPERAND  */ 06109000
         B     @RC01622                                            1624 06110000
@RF01622 LH    @15,SUBINDX                                         1624 06111000
         ST    @15,LOCAL2X                                         1624 06112000
*         END;                      /* END LOOP THRU ALL KEYWORD 2 1625 06113000
*                                      OPERANDS                      */ 06114000
@RC01622 DS    0H                                                  1625 06115000
@DE01609 L     @15,LOCAL2X                                         1625 06116000
         LTR   @15,@15                                             1625 06117000
         BNZ   @DL01609                                            1625 06118000
*         SUBINDX=LOCAL1X+1;        /* SET UP TO SEARCH FOR NEXT OPR1*/ 06119000
         L     @01,LOCAL1X                                         1626 06120000
         LA    @01,1(,@01)                                         1626 06121000
         STH   @01,SUBINDX                                         1626 06122000
*         CALL NEXTSUB(OPR1TYPE);   /* SERACH FOR OPR1 SUB-ENTRY     */ 06123000
         L     @15,@PC00029+4                                      1627 06124000
         ST    @15,@AL00001                                        1627 06125000
         LA    @01,@AL00001                                        1627 06126000
         BAL   @14,NEXTSUB                                         1627 06127000
*         IF SUBEFND=OFF THEN                                      1628 06128000
         TM    SUBEFND,B'10000000'                                 1628 06129000
         BNZ   @RF01628                                            1628 06130000
*           LOCAL1X=0;              /* NO MORE KEYWORD 1 OPERANDS  1629 06131000
*                                      FOUND                         */ 06132000
         SLR   @15,@15                                             1629 06133000
         ST    @15,LOCAL1X                                         1629 06134000
*         ELSE                                                     1630 06135000
*           LOCAL1X=SUBINDX;        /* INDEX OF NEXT KWRD 1 OPERAND  */ 06136000
         B     @RC01628                                            1630 06137000
@RF01628 LH    @15,SUBINDX                                         1630 06138000
         ST    @15,LOCAL1X                                         1630 06139000
*       END;                        /* END LOOP THRU ALL KEYWORD 1 1631 06140000
*                                      OPERANDS                      */ 06141000
@RC01628 DS    0H                                                  1631 06142000
@DE01607 L     @15,LOCAL1X                                         1631 06143000
         LTR   @15,@15                                             1631 06144000
         BNZ   @DL01607                                            1631 06145000
*     END;                                                         1632 06146000
*   RETURN;                                                        1633 06147000
@EL00029 DS    0H                                                  1633 06148000
@EF00029 DS    0H                                                  1633 06149000
@ER00029 LM    @14,@12,@SA00029                                    1633 06150000
         BR    @14                                                 1633 06151000
*   END OPRNDCHK;                                                  1634 06152000
         B     @EL00029                                            1634 06153000
*                                                                  1635 06154000
*/********************************************************************/ 06155000
*/*                                                                  */ 06156000
*/*    OPRNDSMI - ++VER OPERAND CHECK                                */ 06157000
*/*                                                                  */ 06158000
*/*               FOR THE CURRENT ++VER, COMPARE ALL OPERANDS OF     */ 06159000
*/*               THE FIRST KEYWORD TYPE (OPR1TYP)  WITH THE SYSMOD  */ 06160000
*/*               ID IN THE SYSMOD ENTRY IOP (RECXIOPP->HMASMIOP).   */ 06161000
*/*                                                                  */ 06162000
*/********************************************************************/ 06163000
*                                                                  1635 06164000
*OPRNDSMI:                                                         1635 06165000
*   PROC(OPR1INX,OPR1TYP);                                         1635 06166000
OPRNDSMI STM   @14,@12,@SA00030                                    1635 06167000
         MVC   @PC00030(8),0(@01)                                  1635 06168000
*   DCL                                                            1636 06169000
*     OPR1INX FIXED(31);            /* INDEX OF FIRST SUB-ENTRY FOR     06170000
*                                      OPERAND 1                     */ 06171000
*   DCL                                                            1637 06172000
*     OPR1TYP CHAR(1);              /* OPERAND 1 TYPE (KEYWORD)      */ 06173000
*   RESPECIFY                                                      1638 06174000
*     HMASMIOP BASED(RECXIOPP);     /* ADDRESS SYSMOD ENTRY IOP      */ 06175000
*   DCL                                                            1639 06176000
*     LOC1X FIXED(31);              /* LOCAL INDEX FOR OPERAND 1   1639 06177000
*                                      KEYWORD SUB-ENTRIES           */ 06178000
*   IF OPR1INX^=0 THEN                                             1640 06179000
         L     @15,@PC00030                                        1640 06180000
         L     @15,OPR1INX(,@15)                                   1640 06181000
         LTR   @15,@15                                             1640 06182000
         BZ    @RF01640                                            1640 06183000
*     DO;                                                          1641 06184000
*       LOC1X=OPR1INX;              /* START WITH FIRST KEYWORD 1  1642 06185000
*                                      OPERAND                       */ 06186000
*                                                                  1642 06187000
         ST    @15,LOC1X                                           1642 06188000
*       /*************************************************************/ 06189000
*       /*                                                           */ 06190000
*       /* GO THRU ALL KEYWORD 1 OPERANDS                            */ 06191000
*       /*                                                           */ 06192000
*       /*************************************************************/ 06193000
*                                                                  1643 06194000
*       DO WHILE LOC1X^=0;                                         1643 06195000
         B     @DE01643                                            1643 06196000
@DL01643 DS    0H                                                  1644 06197000
*         IF MCBVNUM(LOC1X)=IOPNAM17/* OPERAND IS SAME AS SYSMOD-ID  */ 06198000
*           THEN                                                   1644 06199000
         L     @15,RECXMCB                                         1644 06200000
         L     @14,LOC1X                                           1644 06201000
         MH    @14,@CH00034                                        1644 06202000
         L     @07,RECXIOPP                                        1644 06203000
         ST    @14,@TF00001                                        1644 06204000
         ALR   @14,@15                                             1644 06205000
         BCTR  @14,0                                               1644 06206000
         CLC   MCBVNUM-8(7,@14),IOPNAM17(@07)                      1644 06207000
         BNE   @RF01644                                            1644 06208000
*           DO;                                                    1645 06209000
*                                                                  1645 06210000
*             /*******************************************************/ 06211000
*             /*                                                     */ 06212000
*             /* OPERAND IS SAME AS SYSMOD-ID - ISSUE HMA363         */ 06213000
*             /*                                                     */ 06214000
*             /*******************************************************/ 06215000
*                                                                  1646 06216000
*             VERCKERR=ON;          /* VERIFY STATEMENT ERROR        */ 06217000
         OI    VERCKERR,B'01000000'                                1646 06218000
*             VPARTS=' ';                                          1647 06219000
         MVI   VPARTS+1,C' '                                       1647 06220000
         MVC   VPARTS+2(22),VPARTS+1                               1647 06221000
         MVI   VPARTS,C' '                                         1647 06222000
*             VPART#1=MCBVNTRY(LOC1X);/* INVALID OPERAND VALUE       */ 06223000
         AL    @15,@TF00001                                        1648 06224000
         BCTR  @15,0                                               1648 06225000
         MVC   VPART#1(8),MCBVNTRY-8(@15)                          1648 06226000
*             IF IOPPTYPE=IOPPFUNC THEN                            1649 06227000
         CLI   IOPPTYPE(@07),4                                     1649 06228000
         BNE   @RF01649                                            1649 06229000
*               VPART#2=MSGFUNC;    /* ++FUNCTION                    */ 06230000
         MVC   VPART#2(8),MSGFUNC                                  1650 06231000
*             ELSE                                                 1651 06232000
*               IF IOPPTYPE=IOPPPTF THEN                           1651 06233000
         B     @RC01649                                            1651 06234000
@RF01649 L     @01,RECXIOPP                                        1651 06235000
         CLI   IOPPTYPE(@01),3                                     1651 06236000
         BNE   @RF01651                                            1651 06237000
*                 VPART#2=MSGPTF;   /* ++PTF                         */ 06238000
         MVC   VPART#2(8),MSGPTF                                   1652 06239000
*               ELSE                                               1653 06240000
*                 IF IOPPTYPE=IOPPAPAR THEN                        1653 06241000
         B     @RC01651                                            1653 06242000
@RF01651 L     @01,RECXIOPP                                        1653 06243000
         CLI   IOPPTYPE(@01),2                                     1653 06244000
         BNE   @RF01653                                            1653 06245000
*                   VPART#2=MSGAPAR;/* ++APAR                        */ 06246000
         MVC   VPART#2(8),MSGAPAR                                  1654 06247000
*                 ELSE                                             1655 06248000
*                   IF IOPPTYPE=IOPPUSER THEN                      1655 06249000
         B     @RC01653                                            1655 06250000
@RF01653 L     @01,RECXIOPP                                        1655 06251000
         CLI   IOPPTYPE(@01),1                                     1655 06252000
         BNE   @RF01655                                            1655 06253000
*                     VPART#2=MSGUSER;/* ++USERMOD                   */ 06254000
         MVC   VPART#2(8),MSGUSER                                  1656 06255000
*             CALL OPRNDKEY(OPR1TYP,VPART#3);/* KEYWORD              */ 06256000
@RF01655 DS    0H                                                  1657 06257000
@RC01653 DS    0H                                                  1657 06258000
@RC01651 DS    0H                                                  1657 06259000
@RC01649 L     @15,@PC00030+4                                      1657 06260000
         ST    @15,@AL00001                                        1657 06261000
         LA    @15,VPART#3                                         1657 06262000
         ST    @15,@AL00001+4                                      1657 06263000
         LA    @01,@AL00001                                        1657 06264000
         BAL   @14,OPRNDKEY                                        1657 06265000
*             MGPTYPE=MGPERR;       /* STOP-SYSMOD ERROR             */ 06266000
         MVI   MGPTYPE,X'03'                                       1658 06267000
*             CALL ERRMSG(HMA363I,PART094,NOPART);/* ISSUE HMA363I   */ 06268000
         LA    @01,@AL01659                                        1659 06269000
         BAL   @14,ERRMSG                                          1659 06270000
*           END;                                                   1660 06271000
*         SUBINDX=LOC1X+1;          /* SET UP TO SEARCH FOR NEXT OPR1*/ 06272000
@RF01644 L     @01,LOC1X                                           1661 06273000
         LA    @01,1(,@01)                                         1661 06274000
         STH   @01,SUBINDX                                         1661 06275000
*         CALL NEXTSUB(OPR1TYP);    /* SERACH FOR OPR1 SUB-ENTRY     */ 06276000
         L     @15,@PC00030+4                                      1662 06277000
         ST    @15,@AL00001                                        1662 06278000
         LA    @01,@AL00001                                        1662 06279000
         BAL   @14,NEXTSUB                                         1662 06280000
*         IF SUBEFND=OFF THEN                                      1663 06281000
         TM    SUBEFND,B'10000000'                                 1663 06282000
         BNZ   @RF01663                                            1663 06283000
*           LOC1X=0;                /* NO MORE KEYWORD 1 OPERANDS  1664 06284000
*                                      FOUND                         */ 06285000
         SLR   @15,@15                                             1664 06286000
         ST    @15,LOC1X                                           1664 06287000
*         ELSE                                                     1665 06288000
*           LOC1X=SUBINDX;          /* INDEX OF NEXT KWRD 1 OPERAND  */ 06289000
         B     @RC01663                                            1665 06290000
@RF01663 LH    @15,SUBINDX                                         1665 06291000
         ST    @15,LOC1X                                           1665 06292000
*       END;                        /* END LOOP THRU ALL KEYWORD 1 1666 06293000
*                                      OPERANDS                      */ 06294000
@RC01663 DS    0H                                                  1666 06295000
@DE01643 L     @15,LOC1X                                           1666 06296000
         LTR   @15,@15                                             1666 06297000
         BNZ   @DL01643                                            1666 06298000
*     END;                                                         1667 06299000
*   RETURN;                                                        1668 06300000
@EL00030 DS    0H                                                  1668 06301000
@EF00030 DS    0H                                                  1668 06302000
@ER00030 LM    @14,@12,@SA00030                                    1668 06303000
         BR    @14                                                 1668 06304000
*   END OPRNDSMI;                                                  1669 06305000
         B     @EL00030                                            1669 06306000
*                                                                  1670 06307000
*/********************************************************************/ 06308000
*/*                                                                  */ 06309000
*/*    NEXTSUB - FIND THE NEXT OCCURRENCE OF THE CALLER-SPECIFIED    */ 06310000
*/*              SUB-ENTRY TYPE IN THE MCB                           */ 06311000
*/*                                                                  */ 06312000
*/*            - ON ENTRY:                                           */ 06313000
*/*                                                                  */ 06314000
*/*              * SUBINDX IS SET TO THE SUB-ENTRY INDEX FROM WHICH  */ 06315000
*/*                THE SEARCH IS TO START.                           */ 06316000
*/*                                                                  */ 06317000
*/*            - ON EXIT:                                            */ 06318000
*/*                                                                  */ 06319000
*/*              * SUBEFND IS SET IF THE SPECIFIED ENTRY-TYPE FOUND. */ 06320000
*/*                                                                  */ 06321000
*/*              * SUBINDX IS SET TO THE SUB-ENTRY INDEX FOR THE     */ 06322000
*/*                ENTRY FOUND (IF ANY).                             */ 06323000
*/*                                                                  */ 06324000
*/*              * SUBNTSM# IS SET TO THE VALUE IN THE SUB-ENTRY     */ 06325000
*/*                FOUND (IF ANY).                                   */ 06326000
*/*                                                                  */ 06327000
*/********************************************************************/ 06328000
*                                                                  1670 06329000
*NEXTSUB:                                                          1670 06330000
*   PROC(SUBTYPE);                                                 1670 06331000
NEXTSUB  STM   @14,@12,12(@13)                                     1670 06332000
         MVC   @PC00031(4),0(@01)                                  1670 06333000
*   DCL                                                            1671 06334000
*     SUBTYPE CHAR(1);              /* SUB-ENTRY TYPE - SAME VALUES     06335000
*                                      AS SPECIFIED FOR IOPPIND      */ 06336000
*   DCL                                                            1672 06337000
*     UU FIXED(15);                 /* LOCAL SUB-ENTRY INDEX         */ 06338000
*   SUBEFND=OFF;                    /* CLEAR SUB-ENTRY FOUND FLAG    */ 06339000
         NI    SUBEFND,B'01111111'                                 1673 06340000
*   SUBNTSM#=NULLPTF#;              /* CLEAR SYSMOD NAME             */ 06341000
         MVC   SUBNTSM#(7),@CC01733                                1674 06342000
*   UU=SUBINDX;                     /* SUB-ENTRY STARTING INDEX      */ 06343000
*                                                                  1675 06344000
         MVC   UU(2),SUBINDX                                       1675 06345000
*   /*****************************************************************/ 06346000
*   /*                                                               */ 06347000
*   /* GO THUR ALL MCB SUB-ENTRIES STARTING FROM SUBINDX             */ 06348000
*   /*                                                               */ 06349000
*   /*****************************************************************/ 06350000
*                                                                  1676 06351000
*   DO UU=UU BY 1 WHILE MCBVND(UU)^=IOPEOLST&SUBEFND=OFF;          1676 06352000
         B     @DE01676                                            1676 06353000
@DL01676 DS    0H                                                  1677 06354000
*     IF MCBVIND(UU)=SUBTYPE        /* SUBENTRY TYPE MATCH ?         */ 06355000
*       THEN                                                       1677 06356000
         L     @15,RECXMCB                                         1677 06357000
         LH    @14,UU                                              1677 06358000
         LR    @07,@14                                             1677 06359000
         MH    @07,@CH00034                                        1677 06360000
         L     @06,@PC00031                                        1677 06361000
         SLR   @05,@05                                             1677 06362000
         IC    @05,MCBVIND-9(@07,@15)                              1677 06363000
         MVC   @ZT00003+3(1),SUBTYPE(@06)                          1677 06364000
         C     @05,@ZT00003                                        1677 06365000
         BNE   @RF01677                                            1677 06366000
*       DO;                                                        1678 06367000
*                                                                  1678 06368000
*         /***********************************************************/ 06369000
*         /*                                                         */ 06370000
*         /* THE NEXT SUBENTRY OF THE SPECIFIED TYPE FOUND           */ 06371000
*         /*                                                         */ 06372000
*         /***********************************************************/ 06373000
*                                                                  1679 06374000
*         SUBEFND=ON;               /* SET SUB-ENTRY FOUND FLAG      */ 06375000
         OI    SUBEFND,B'10000000'                                 1679 06376000
*         SUBINDX=UU;               /* SET SUB-ENTRY INDEX           */ 06377000
         STH   @14,SUBINDX                                         1680 06378000
*         SUBNTSM#=MCBVNUM(UU);     /* SET SYSMOD NAME FROM SUB-ENTRY*/ 06379000
         ALR   @15,@07                                             1681 06380000
         BCTR  @15,0                                               1681 06381000
         MVC   SUBNTSM#(7),MCBVNUM-8(@15)                          1681 06382000
*       END;                                                       1682 06383000
*   END;                            /* END OF LOOP THRU MCB        1683 06384000
*                                      SUB-ENTRIES                   */ 06385000
@RF01677 LA    @15,1                                               1683 06386000
         AH    @15,UU                                              1683 06387000
         STH   @15,UU                                              1683 06388000
@DE01676 LH    @15,UU                                              1683 06389000
         MH    @15,@CH00034                                        1683 06390000
         L     @01,RECXMCB                                         1683 06391000
         BCTR  @01,0                                               1683 06392000
         SLR   @14,@14                                             1683 06393000
         IC    @14,MCBVND-8(@15,@01)                               1683 06394000
         CH    @14,@CH00766                                        1683 06395000
         BE    @DC01676                                            1683 06396000
         TM    SUBEFND,B'10000000'                                 1683 06397000
         BZ    @DL01676                                            1683 06398000
@DC01676 DS    0H                                                  1684 06399000
*   RETURN;                                                        1684 06400000
@EL00031 DS    0H                                                  1684 06401000
@EF00031 DS    0H                                                  1684 06402000
@ER00031 LM    @14,@12,12(@13)                                     1684 06403000
         BR    @14                                                 1684 06404000
*   END NEXTSUB;                                                   1685 06405000
*   END VERCHK;                                                    1686 06406000
@EL00028 DS    0H                                                  1686 06407000
@EF00028 DS    0H                                                  1686 06408000
@ER00028 LM    @14,@12,@SA00028                                    1686 06409000
         BR    @14                                                 1686 06410000
*                                                                  1687 06411000
*/********************************************************************/ 06412000
*/*                                                                  */ 06413000
*/*    OPRNDKEY - TRANSLATE IOPPIND VALUES INTO THE EBCDIC CHARACTER */ 06414000
*/*               STRING WHICH THEY REPRESENT                        */ 06415000
*/*                                                                  */ 06416000
*/********************************************************************/ 06417000
*                                                                  1687 06418000
*OPRNDKEY:                                                         1687 06419000
*   PROC(PINDCODE,CHARVAL);                                        1687 06420000
OPRNDKEY STM   @14,@12,12(@13)                                     1687 06421000
         MVC   @PC00032(8),0(@01)                                  1687 06422000
*   DCL                                                            1688 06423000
*     PINDCODE CHAR(1);             /* IOPPIND VALUE                 */ 06424000
*   DCL                                                            1689 06425000
*     CHARVAL CHAR(8);              /* IOPPIND VALUE - PRINTABLE   1689 06426000
*                                      CHARACTER STRING            1689 06427000
*                                      REPRESENTATION                */ 06428000
*   CHARVAL=' ';                    /* BLANK CHAR STRING RETURNED    */ 06429000
*                                                                  1690 06430000
         L     @15,@PC00032+4                                      1690 06431000
         MVI   CHARVAL+1(@15),C' '                                 1690 06432000
         MVC   CHARVAL+2(6,@15),CHARVAL+1(@15)                     1690 06433000
         MVI   CHARVAL(@15),C' '                                   1690 06434000
*   /*****************************************************************/ 06435000
*   /*                                                               */ 06436000
*   /* ELEMENT IOPPIND VALUES                                        */ 06437000
*   /*                                                               */ 06438000
*   /*****************************************************************/ 06439000
*                                                                  1691 06440000
*   IF PINDCODE=IOPPMOD             /* ++MOD ?                       */ 06441000
*     THEN                                                         1691 06442000
         L     @14,@PC00032                                        1691 06443000
         CLI   PINDCODE(@14),1                                     1691 06444000
         BNE   @RF01691                                            1691 06445000
*     CHARVAL=MSGMOD;                                              1692 06446000
         MVC   CHARVAL(8,@15),MSGMOD                               1692 06447000
*   IF PINDCODE=IOPPZAP             /* ++ZAP ?                       */ 06448000
*     THEN                                                         1693 06449000
@RF01691 L     @15,@PC00032                                        1693 06450000
         CLI   PINDCODE(@15),2                                     1693 06451000
         BNE   @RF01693                                            1693 06452000
*     CHARVAL=MSGZAP;                                              1694 06453000
         L     @15,@PC00032+4                                      1694 06454000
         MVC   CHARVAL(8,@15),MSGZAP                               1694 06455000
*   IF PINDCODE=IOPPMACR            /* ++MAC ?                       */ 06456000
*     THEN                                                         1695 06457000
@RF01693 L     @15,@PC00032                                        1695 06458000
         CLI   PINDCODE(@15),4                                     1695 06459000
         BNE   @RF01695                                            1695 06460000
*     CHARVAL=MSGMACR;                                             1696 06461000
         L     @15,@PC00032+4                                      1696 06462000
         MVC   CHARVAL(8,@15),MSGMACR                              1696 06463000
*   IF PINDCODE=IOPPMACU            /* ++MACUPD ?                    */ 06464000
*     THEN                                                         1697 06465000
@RF01695 L     @15,@PC00032                                        1697 06466000
         CLI   PINDCODE(@15),5                                     1697 06467000
         BNE   @RF01697                                            1697 06468000
*     CHARVAL=MSGMACU;                                             1698 06469000
         L     @15,@PC00032+4                                      1698 06470000
         MVC   CHARVAL(8,@15),MSGMACU                              1698 06471000
*   IF PINDCODE=IOPPSRCR            /* ++SRC ?                       */ 06472000
*     THEN                                                         1699 06473000
@RF01697 L     @15,@PC00032                                        1699 06474000
         CLI   PINDCODE(@15),6                                     1699 06475000
         BNE   @RF01699                                            1699 06476000
*     CHARVAL=MSGSRCR;                                             1700 06477000
         L     @15,@PC00032+4                                      1700 06478000
         MVC   CHARVAL(8,@15),MSGSRCR                              1700 06479000
*   IF PINDCODE=IOPPSRCU            /* ++SRCUPD ?                    */ 06480000
*     THEN                                                         1701 06481000
@RF01699 L     @15,@PC00032                                        1701 06482000
         CLI   PINDCODE(@15),7                                     1701 06483000
         BNE   @RF01701                                            1701 06484000
*     CHARVAL=MSGSRCU;                                             1702 06485000
*                                                                  1702 06486000
         L     @15,@PC00032+4                                      1702 06487000
         MVC   CHARVAL(8,@15),MSGSRCU                              1702 06488000
*   /*****************************************************************/ 06489000
*   /*                                                               */ 06490000
*   /* ++VER STATEMENT IOPPIND VALUES                                */ 06491000
*   /*                                                               */ 06492000
*   /*****************************************************************/ 06493000
*                                                                  1703 06494000
*   IF PINDCODE=IOPPPRE             /* PREREQ ?                      */ 06495000
*     THEN                                                         1703 06496000
@RF01701 L     @15,@PC00032                                        1703 06497000
         CLI   PINDCODE(@15),162                                   1703 06498000
         BNE   @RF01703                                            1703 06499000
*     CHARVAL=MSGPRE;                                              1704 06500000
         L     @15,@PC00032+4                                      1704 06501000
         MVC   CHARVAL(8,@15),MSGPRE                               1704 06502000
*   IF PINDCODE=IOPPNPR             /* NPRE ?                        */ 06503000
*     THEN                                                         1705 06504000
@RF01703 L     @15,@PC00032                                        1705 06505000
         CLI   PINDCODE(@15),163                                   1705 06506000
         BNE   @RF01705                                            1705 06507000
*     CHARVAL=MSGNPRE;                                             1706 06508000
         L     @15,@PC00032+4                                      1706 06509000
         MVC   CHARVAL(8,@15),MSGNPRE                              1706 06510000
*   IF PINDCODE=IOPPSUPV            /* SUP ?                         */ 06511000
*     THEN                                                         1707 06512000
@RF01705 L     @15,@PC00032                                        1707 06513000
         CLI   PINDCODE(@15),164                                   1707 06514000
         BNE   @RF01707                                            1707 06515000
*     CHARVAL=MSGSUP;                                              1708 06516000
         L     @15,@PC00032+4                                      1708 06517000
         MVC   CHARVAL(8,@15),MSGSUP                               1708 06518000
*   IF PINDCODE=IOPPREQ             /* REQ ?                         */ 06519000
*     THEN                                                         1709 06520000
@RF01707 L     @15,@PC00032                                        1709 06521000
         CLI   PINDCODE(@15),165                                   1709 06522000
         BNE   @RF01709                                            1709 06523000
*     CHARVAL=MSGREQ;                                              1710 06524000
         L     @15,@PC00032+4                                      1710 06525000
         MVC   CHARVAL(8,@15),MSGREQ                               1710 06526000
*   IF PINDCODE=IOPPFID             /* FMID ?                        */ 06527000
*     THEN                                                         1711 06528000
@RF01709 L     @15,@PC00032                                        1711 06529000
         CLI   PINDCODE(@15),167                                   1711 06530000
         BNE   @RF01711                                            1711 06531000
*     CHARVAL=MSGFMID;                                             1712 06532000
         L     @15,@PC00032+4                                      1712 06533000
         MVC   CHARVAL(8,@15),MSGFMID                              1712 06534000
*   IF PINDCODE=IOPPDEL             /* DELETE ?                      */ 06535000
*     THEN                                                         1713 06536000
@RF01711 L     @15,@PC00032                                        1713 06537000
         CLI   PINDCODE(@15),168                                   1713 06538000
         BNE   @RF01713                                            1713 06539000
*     CHARVAL=MSGDEL;                                              1714 06540000
         L     @15,@PC00032+4                                      1714 06541000
         MVC   CHARVAL(8,@15),MSGDEL                               1714 06542000
*   IF PINDCODE=IOPPVER             /* VERSION?                      */ 06543000
*     THEN                                                         1715 06544000
@RF01713 L     @15,@PC00032                                        1715 06545000
         CLI   PINDCODE(@15),169                                   1715 06546000
         BNE   @RF01715                                            1715 06547000
*     CHARVAL=MSGVERS;                                             1716 06548000
         L     @15,@PC00032+4                                      1716 06549000
         MVC   CHARVAL(8,@15),MSGVERS                              1716 06550000
*   RETURN;                                                        1717 06551000
@EL00032 DS    0H                                                  1717 06552000
@EF00032 DS    0H                                                  1717 06553000
@ER00032 LM    @14,@12,12(@13)                                     1717 06554000
         BR    @14                                                 1717 06555000
*   END OPRNDKEY;                                                  1718 06556000
         B     @EL00032                                            1718 06557000
*                                                                  1719 06558000
*/********************************************************************/ 06559000
*/*                                                                  */ 06560000
*/*    ADDNFND - ADD A RECORD TO GTA SUMMARY FILE FOR SELECTED       */ 06561000
*/*    SYSMODS WHICH WERE NOT FOUND ON SMPPTFIN                      */ 06562000
*/*                                                                  */ 06563000
*/********************************************************************/ 06564000
*                                                                  1719 06565000
*ADDNFND:                                                          1719 06566000
*   PROC(NFNDSMD#);                                                1719 06567000
ADDNFND  STM   @14,@12,@SA00033                                    1719 06568000
         MVC   @PC00033(4),0(@01)                                  1719 06569000
*   DCL                                                            1720 06570000
*     NFNDSMD# CHAR(7);             /* SYSMOD-ID                     */ 06571000
*   RESPECIFY                                                      1721 06572000
*     HMASMGTP BASED(RECXGSMP);     /* ADDRESS SUMMARY GTP           */ 06573000
*   GSMREC=''B;                     /* CLEAR RECORD                  */ 06574000
         LA    @15,GTASM                                           1722 06575000
         XC    GSMREC(18,@15),GSMREC(@15)                          1722 06576000
*   GSMFMID=NULLPTF#;               /* BLANK FMID FIELD              */ 06577000
         MVC   GSMFMID(7,@15),@CC01733                             1723 06578000
*   GSMS#=NFNDSMD#;                 /* FILL IN SYSMOD-ID PASSED      */ 06579000
         L     @14,@PC00033                                        1724 06580000
         MVC   GSMS#(7,@15),NFNDSMD#(@14)                          1724 06581000
*   GSMNFND=ON;                     /* SET "NOT FOUND" INDICATOR     */ 06582000
         OI    GSMNFND(@15),B'00100000'                            1725 06583000
*   GSMSEL=ON;                      /* SET "SELECTED" INDICATOR      */ 06584000
         OI    GSMSEL(@15),B'00010000'                             1726 06585000
*   GSMSTY=MCBERRTP;                /* SYSMOD TYPE IS UN-KNOWN       */ 06586000
         MVI   GSMSTY(@15),X'FF'                                   1727 06587000
*   GTPFUNCT=GTPADD;                /* ADD TO GTA FILE FUNCTION      */ 06588000
         L     @15,RECXGSMP                                        1728 06589000
         MVI   GTPFUNCT(@15),X'04'                                 1728 06590000
*   CALL HMASMGTA(HMASMGTP);        /* ADD RECORD                    */ 06591000
         ST    @15,@AL00001                                        1729 06592000
         L     @15,@CV01706                                        1729 06593000
         LA    @01,@AL00001                                        1729 06594000
         BALR  @14,@15                                             1729 06595000
*   RECXMAX=MAX(RECXMAX,GTPRETRN);  /* MAINTAIN RETURN CODE          */ 06596000
         L     @15,RECXMAX                                         1730 06597000
         L     @14,RECXGSMP                                        1730 06598000
         SLR   @07,@07                                             1730 06599000
         IC    @07,GTPRETRN(,@14)                                  1730 06600000
         CR    @15,@07                                             1730 06601000
         BNL   *+6                                                      06602000
         LR    @15,@07                                             1730 06603000
         ST    @15,RECXMAX                                         1730 06604000
*   RETURN;                                                        1731 06605000
@EL00033 DS    0H                                                  1731 06606000
@EF00033 DS    0H                                                  1731 06607000
@ER00033 LM    @14,@12,@SA00033                                    1731 06608000
         BR    @14                                                 1731 06609000
*   END ADDNFND;                                                   1732 06610000
*                                                                  1733 06611000
*/********************************************************************/ 06612000
*/*                                                                  */ 06613000
*/*    SKIP  - SKIP "N" LINES ON SMPOUT TO DELIMIT ONE SYSMOD FROM   */ 06614000
*/*            ANOTHER AND ONE MODIFICTION CONTROL STATEMENT FROM    */ 06615000
*/*            ANOTHER.                                              */ 06616000
*/*                                                                  */ 06617000
*/********************************************************************/ 06618000
*                                                                  1733 06619000
*SKIP:                                                             1733 06620000
*   PROC(SKPN);                                                    1733 06621000
SKIP     STM   @14,@12,@SA00034                                    1733 06622000
         MVC   @PC00034(4),0(@01)                                  1733 06623000
*   DCL                                                            1734 06624000
*     SKPN FIXED(31);               /* NUMBER OF LINES TO SKIP       */ 06625000
*   DCL                                                            1735 06626000
*     XPRL CHAR(LENGTH(HMASMPRL));  /* AREA FOR PRL (HMASMPRL)       */ 06627000
*   RESPECIFY                                                      1736 06628000
*     HMASMIOP BASED(RECXIOPG);     /* IOP FOR SMPPRINT              */ 06629000
*   IOPFUNCT=IOPWRITE;              /* FUNCTION IS WRITE             */ 06630000
         L     @15,RECXIOPG                                        1737 06631000
         MVI   IOPFUNCT(@15),X'51'                                 1737 06632000
*   IOPDSID=IOPPRINT;               /* DATASET IS SMPOUT             */ 06633000
         MVI   IOPDSID(@15),X'0B'                                  1738 06634000
*   IOPBUFAD=ADDR(XPRL);            /* BUFFER TO WRITE IS A PRL    1739 06635000
*                                      (HMASMPRL)                    */ 06636000
         LA    @14,XPRL                                            1739 06637000
         ST    @14,IOPBUFAD(,@15)                                  1739 06638000
*   PRLFLGS=''B;                    /* CLEAR FLAGS                   */ 06639000
         MVI   PRLFLGS(@14),X'00'                                  1740 06640000
*   PRLBLANK=ON;                    /* BLANK LINE PRINT              */ 06641000
         OI    PRLBLANK(@14),B'00100000'                           1741 06642000
*   IOPRETRN=IOPGOOD;                                              1742 06643000
         MVI   IOPRETRN(@15),X'00'                                 1742 06644000
*   DO II=1 TO SKPN WHILE IOPRETRN=IOPGOOD;                        1743 06645000
         LA    @15,1                                               1743 06646000
         B     @DE01743                                            1743 06647000
@DL01743 L     @15,RECXIOPG                                        1743 06648000
         CLI   IOPRETRN(@15),0                                     1743 06649000
         BNE   @DC01743                                            1743 06650000
*     CALL HMASMIO(HMASMIOP);                                      1744 06651000
         ST    @15,@AL00001                                        1744 06652000
         L     @15,@CV01703                                        1744 06653000
         LA    @01,@AL00001                                        1744 06654000
         BALR  @14,@15                                             1744 06655000
*   END;                                                           1745 06656000
         LA    @15,1                                               1745 06657000
         AL    @15,II                                              1745 06658000
@DE01743 ST    @15,II                                              1745 06659000
         L     @14,@PC00034                                        1745 06660000
         C     @15,SKPN(,@14)                                      1745 06661000
         BNH   @DL01743                                            1745 06662000
@DC01743 DS    0H                                                  1746 06663000
*   RECXMAX=MAX(RECXMAX,IOPRETRN);  /* IN CASE ANYTHING WENT WRONG   */ 06664000
         L     @15,RECXMAX                                         1746 06665000
         L     @14,RECXIOPG                                        1746 06666000
         SLR   @07,@07                                             1746 06667000
         IC    @07,IOPRETRN(,@14)                                  1746 06668000
         CR    @15,@07                                             1746 06669000
         BNL   *+6                                                      06670000
         LR    @15,@07                                             1746 06671000
         ST    @15,RECXMAX                                         1746 06672000
*   RETURN;                                                        1747 06673000
@EL00034 DS    0H                                                  1747 06674000
@EF00034 DS    0H                                                  1747 06675000
@ER00034 LM    @14,@12,@SA00034                                    1747 06676000
         BR    @14                                                 1747 06677000
*   END SKIP;                                                      1748 06678000
*   END HMASMREC                                                   1749 06679000
*                                                                  1749 06680000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 06681000
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */ 06682000
*/*%INCLUDE SYSLIB  (HMASMCRP)                                       */ 06683000
*/*%INCLUDE SYSLIB  (HMASMGTP)                                       */ 06684000
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */ 06685000
*/*%INCLUDE SYSLIB  (HMASMMCB)                                       */ 06686000
*/*%INCLUDE SYSLIB  (HMASMMGP)                                       */ 06687000
*/*%INCLUDE SYSLIB  (HMASMPRL)                                       */ 06688000
*/*%INCLUDE SYSLIB  (HMASMSCP)                                       */ 06689000
*/*%INCLUDE SYSLIB  (HMASMSET)                                       */ 06690000
*/*%INCLUDE SYSLIB  (HMASMSPL)                                       */ 06691000
*/*%INCLUDE SYSLIB  (HMASMUXP)                                       */ 06692000
*                                                                  1749 06693000
*       ;                                                          1749 06694000
@DATA    DS    0H                                                       06695000
@CH00298 DC    H'0'                                                     06696000
@CH00232 DC    H'2'                                                     06697000
@CH00092 DC    H'4'                                                     06698000
@CH00088 DC    H'7'                                                     06699000
@CH00034 DC    H'9'                                                     06700000
@CH00035 DC    H'10'                                                    06701000
@CH00593 DC    H'18'                                                    06702000
@CH00608 DC    H'26'                                                    06703000
@CH01785 DC    H'47'                                                    06704000
@CH01787 DC    H'49'                                                    06705000
@CH00949 DC    H'60'                                                    06706000
@CH00431 DC    H'72'                                                    06707000
@CH00372 DC    H'74'                                                    06708000
@CH00429 DC    H'80'                                                    06709000
@CH01791 DC    H'93'                                                    06710000
@CH01813 DC    H'94'                                                    06711000
@CH01815 DC    H'95'                                                    06712000
@CH01817 DC    H'96'                                                    06713000
@CH01819 DC    H'97'                                                    06714000
@CH01821 DC    H'98'                                                    06715000
@CH01793 DC    H'128'                                                   06716000
@CH01795 DC    H'146'                                                   06717000
@CH01797 DC    H'147'                                                   06718000
@CH01799 DC    H'148'                                                   06719000
@CH01801 DC    H'149'                                                   06720000
@CH01803 DC    H'150'                                                   06721000
@CH01805 DC    H'151'                                                   06722000
@CH01190 DC    H'161'                                                   06723000
@CH01192 DC    H'162'                                                   06724000
@CH01194 DC    H'163'                                                   06725000
@CH01196 DC    H'164'                                                   06726000
@CH01198 DC    H'165'                                                   06727000
@CH01202 DC    H'167'                                                   06728000
@CH01204 DC    H'168'                                                   06729000
@CH01206 DC    H'169'                                                   06730000
@CH01208 DC    H'170'                                                   06731000
@CH01810 DC    H'179'                                                   06732000
@CH00766 DC    H'255'                                                   06733000
@SM02176 MVC   CHNGMEM(0),SCPSTRNG(@06)                                 06734000
         DS    0F                                                       06735000
@AL00336 EQU   *                       LIST WITH   1 ARGUMENT(S)        06736000
@AL00356 EQU   *                       LIST WITH   1 ARGUMENT(S)        06737000
@AL00380 EQU   *                       LIST WITH   1 ARGUMENT(S)        06738000
@AL00596 EQU   *                       LIST WITH   1 ARGUMENT(S)        06739000
@AL00602 EQU   *                       LIST WITH   1 ARGUMENT(S)        06740000
@AL00608 DC    A(HMASMSPL)             LIST WITH   1 ARGUMENT(S)        06741000
@AL00435 DC    A(@CH01785+1)           LIST WITH   3 ARGUMENT(S)        06742000
         DC    A(@CH00298+1)                                            06743000
         DC    A(@CH00298+1)                                            06744000
@AL00502 EQU   *                       LIST WITH   1 ARGUMENT(S)        06745000
@AL00541 EQU   *                       LIST WITH   1 ARGUMENT(S)        06746000
@AL01196 DC    A(@CF00041)             LIST WITH   1 ARGUMENT(S)        06747000
@AL00506 EQU   *                       LIST WITH   1 ARGUMENT(S)        06748000
@AL00507 EQU   *                       LIST WITH   1 ARGUMENT(S)        06749000
@AL00543 EQU   *                       LIST WITH   1 ARGUMENT(S)        06750000
@AL00544 EQU   *                       LIST WITH   1 ARGUMENT(S)        06751000
@AL00561 EQU   *                       LIST WITH   1 ARGUMENT(S)        06752000
@AL00591 DC    A(RECXPARM)             LIST WITH   1 ARGUMENT(S)        06753000
@AL00546 EQU   *                       LIST WITH   1 ARGUMENT(S)        06754000
@AL00681 DC    A(@CF00043)             LIST WITH   1 ARGUMENT(S)        06755000
@AL00577 DC    A(SESMDNO)              LIST WITH   1 ARGUMENT(S)        06756000
@AL00580 DC    A(@CH01208+1)           LIST WITH   3 ARGUMENT(S)        06757000
         DC    A(@CH00298+1)                                            06758000
         DC    A(@CH00298+1)                                            06759000
@AL00589 DC    A(@CH01787+1)           LIST WITH   3 ARGUMENT(S)        06760000
         DC    A(@CH00298+1)                                            06761000
         DC    A(@CH00298+1)                                            06762000
@AL00682 EQU   *                       LIST WITH   1 ARGUMENT(S)        06763000
@AL00727 EQU   *                       LIST WITH   1 ARGUMENT(S)        06764000
@AL00983 EQU   *                       LIST WITH   1 ARGUMENT(S)        06765000
@AL01216 EQU   *                       LIST WITH   1 ARGUMENT(S)        06766000
@AL01234 EQU   *                       LIST WITH   1 ARGUMENT(S)        06767000
@AL01244 EQU   *                       LIST WITH   1 ARGUMENT(S)        06768000
@AL01255 EQU   *                       LIST WITH   1 ARGUMENT(S)        06769000
@AL01263 EQU   *                       LIST WITH   1 ARGUMENT(S)        06770000
@AL01272 DC    A(@CC01730)             LIST WITH   1 ARGUMENT(S)        06771000
@AL00699 EQU   *                       LIST WITH   1 ARGUMENT(S)        06772000
@AL00747 DC    A(MPPPARM)              LIST WITH   1 ARGUMENT(S)        06773000
@AL00723 DC    A(@CH00372+1)           LIST WITH   3 ARGUMENT(S)        06774000
         DC    A(@CH00298+1)                                            06775000
         DC    A(@CH00298+1)                                            06776000
@AL00731 EQU   *                       LIST WITH   3 ARGUMENT(S)        06777000
@AL00784 EQU   *                       LIST WITH   3 ARGUMENT(S)        06778000
@AL01079 DC    A(@CH01795+1)           LIST WITH   3 ARGUMENT(S)        06779000
         DC    A(@CH00298+1)                                            06780000
         DC    A(@CH00298+1)                                            06781000
@AL00823 DC    A(VEROK)                LIST WITH   1 ARGUMENT(S)        06782000
@AL00834 DC    A(@CH01803+1)           LIST WITH   3 ARGUMENT(S)        06783000
         DC    A(@CH00298+1)                                            06784000
         DC    A(@CH00298+1)                                            06785000
@AL00842 DC    A(@CH01196+1)           LIST WITH   3 ARGUMENT(S)        06786000
         DC    A(@CH01815+1)                                            06787000
         DC    A(@CH00298+1)                                            06788000
@AL00849 DC    A(@CH01196+1)           LIST WITH   3 ARGUMENT(S)        06789000
         DC    A(@CH01817+1)                                            06790000
         DC    A(@CH00298+1)                                            06791000
@AL00961 DC    A(@CH01810+1)           LIST WITH   3 ARGUMENT(S)        06792000
         DC    A(@CH00298+1)                                            06793000
         DC    A(@CH00298+1)                                            06794000
@AL00974 DC    A(@CC01724)             LIST WITH   1 ARGUMENT(S)        06795000
@AL00986 DC    A(@CH01799+1)           LIST WITH   3 ARGUMENT(S)        06796000
         DC    A(@CH00298+1)                                            06797000
         DC    A(@CH00298+1)                                            06798000
@AL00987 DC    A(@CH01793+1)           LIST WITH   3 ARGUMENT(S)        06799000
         DC    A(@CH00298+1)                                            06800000
         DC    A(@CH00298+1)                                            06801000
@AL01030 EQU   *                       LIST WITH   1 ARGUMENT(S)        06802000
@AL01073 EQU   *                       LIST WITH   1 ARGUMENT(S)        06803000
@AL01201 DC    A(HMASMCRP)             LIST WITH   1 ARGUMENT(S)        06804000
@AL01151 DC    A(HMASMMGP)             LIST WITH   1 ARGUMENT(S)        06805000
@AL01218 EQU   *                       LIST WITH   3 ARGUMENT(S)        06806000
@AL01236 EQU   *                       LIST WITH   3 ARGUMENT(S)        06807000
@AL01265 EQU   *                       LIST WITH   3 ARGUMENT(S)        06808000
@AL01274 DC    A(@CH01194+1)           LIST WITH   3 ARGUMENT(S)        06809000
         DC    A(@CH00298+1)                                            06810000
         DC    A(@CH00298+1)                                            06811000
@AL01225 DC    A(ANSWER)               LIST WITH   1 ARGUMENT(S)        06812000
@AL01246 DC    A(@CH01791+1)           LIST WITH   3 ARGUMENT(S)        06813000
         DC    A(@CH00298+1)                                            06814000
         DC    A(@CH00298+1)                                            06815000
@AL01257 DC    A(@CH01797+1)           LIST WITH   3 ARGUMENT(S)        06816000
         DC    A(@CH00298+1)                                            06817000
         DC    A(@CH00298+1)                                            06818000
@AL01350 DC    A(@CH01805+1)           LIST WITH   3 ARGUMENT(S)        06819000
         DC    A(@CH00298+1)                                            06820000
         DC    A(@CH00298+1)                                            06821000
@AL01474 DC    A(@CH01196+1)           LIST WITH   3 ARGUMENT(S)        06822000
         DC    A(@CH01819+1)                                            06823000
         DC    A(@CH00298+1)                                            06824000
@AL01527 EQU   *                       LIST WITH   3 ARGUMENT(S)        06825000
@AL01534 DC    A(@CH01196+1)           LIST WITH   3 ARGUMENT(S)        06826000
         DC    A(@CH01821+1)                                            06827000
         DC    A(@CH00298+1)                                            06828000
@AL01542 DC    A(PREINDX1)             LIST WITH   4 ARGUMENT(S)        06829000
         DC    A(@CH01192+1)                                            06830000
@AL01549 DC    A(NPRINDX1)             LIST WITH   4 ARGUMENT(S)        06831000
         DC    A(@CH01194+1)                                            06832000
@AL01556 DC    A(FIDINDX1)             LIST WITH   4 ARGUMENT(S)        06833000
         DC    A(@CH01202+1)                                            06834000
         DC    A(DELINDX1)                                              06835000
         DC    A(@CH01204+1)                                            06836000
@AL01543 DC    A(PREINDX1)             LIST WITH   4 ARGUMENT(S)        06837000
         DC    A(@CH01192+1)                                            06838000
         DC    A(SUPINDX1)                                              06839000
         DC    A(@CH01196+1)                                            06840000
@AL01544 DC    A(PREINDX1)             LIST WITH   4 ARGUMENT(S)        06841000
         DC    A(@CH01192+1)                                            06842000
         DC    A(REQINDX1)                                              06843000
         DC    A(@CH01198+1)                                            06844000
@AL01545 DC    A(PREINDX1)             LIST WITH   4 ARGUMENT(S)        06845000
         DC    A(@CH01192+1)                                            06846000
         DC    A(FIDINDX1)                                              06847000
         DC    A(@CH01202+1)                                            06848000
@AL01546 EQU   *                       LIST WITH   4 ARGUMENT(S)        06849000
@AL01537 DC    A(PREINDX1)             LIST WITH   2 ARGUMENT(S)        06850000
@AL01494 DC    A(@CH01192+1)           LIST WITH   1 ARGUMENT(S)        06851000
         DC    A(DELINDX1)                                              06852000
         DC    A(@CH01204+1)                                            06853000
@AL01547 DC    A(NPRINDX1)             LIST WITH   4 ARGUMENT(S)        06854000
         DC    A(@CH01194+1)                                            06855000
         DC    A(SUPINDX1)                                              06856000
         DC    A(@CH01196+1)                                            06857000
@AL01548 DC    A(NPRINDX1)             LIST WITH   4 ARGUMENT(S)        06858000
         DC    A(@CH01194+1)                                            06859000
         DC    A(REQINDX1)                                              06860000
         DC    A(@CH01198+1)                                            06861000
@AL01550 EQU   *                       LIST WITH   4 ARGUMENT(S)        06862000
@AL01538 DC    A(NPRINDX1)             LIST WITH   2 ARGUMENT(S)        06863000
@AL01498 DC    A(@CH01194+1)           LIST WITH   1 ARGUMENT(S)        06864000
         DC    A(DELINDX1)                                              06865000
         DC    A(@CH01204+1)                                            06866000
@AL01551 DC    A(SUPINDX1)             LIST WITH   4 ARGUMENT(S)        06867000
         DC    A(@CH01196+1)                                            06868000
         DC    A(REQINDX1)                                              06869000
         DC    A(@CH01198+1)                                            06870000
@AL01552 DC    A(SUPINDX1)             LIST WITH   4 ARGUMENT(S)        06871000
         DC    A(@CH01196+1)                                            06872000
         DC    A(FIDINDX1)                                              06873000
         DC    A(@CH01202+1)                                            06874000
@AL01553 EQU   *                       LIST WITH   4 ARGUMENT(S)        06875000
@AL01541 DC    A(SUPINDX1)             LIST WITH   2 ARGUMENT(S)        06876000
         DC    A(@CH01196+1)                                            06877000
         DC    A(DELINDX1)                                              06878000
         DC    A(@CH01204+1)                                            06879000
@AL01554 DC    A(REQINDX1)             LIST WITH   4 ARGUMENT(S)        06880000
         DC    A(@CH01198+1)                                            06881000
         DC    A(FIDINDX1)                                              06882000
         DC    A(@CH01202+1)                                            06883000
@AL01555 DC    A(REQINDX1)             LIST WITH   4 ARGUMENT(S)        06884000
@AL01506 DC    A(@CH01198+1)           LIST WITH   1 ARGUMENT(S)        06885000
@AL01540 DC    A(DELINDX1)             LIST WITH   2 ARGUMENT(S)        06886000
@AL01513 DC    A(@CH01204+1)           LIST WITH   1 ARGUMENT(S)        06887000
@AL01557 EQU   *                       LIST WITH   4 ARGUMENT(S)        06888000
@AL01539 DC    A(FIDINDX1)             LIST WITH   2 ARGUMENT(S)        06889000
@AL01510 DC    A(@CH01202+1)           LIST WITH   1 ARGUMENT(S)        06890000
         DC    A(VRSINDX1)                                              06891000
@AL01517 DC    A(@CH01206+1)           LIST WITH   1 ARGUMENT(S)        06892000
@AL01572 DC    A(@CH01801+1)           LIST WITH   3 ARGUMENT(S)        06893000
         DC    A(@CH00298+1)                                            06894000
         DC    A(@CH00298+1)                                            06895000
@AL01618 EQU   *                       LIST WITH   3 ARGUMENT(S)        06896000
@AL01659 EQU   *                       LIST WITH   3 ARGUMENT(S)        06897000
@AL01502 DC    A(@CH01196+1)           LIST WITH   1 ARGUMENT(S)        06898000
         DC    A(@CH01813+1)                                            06899000
         DC    A(@CH00298+1)                                            06900000
         DS    0F                                                       06901000
@SA00001 DS    18F                                                      06902000
@PC00001 DS    1F                                                       06903000
@SA00012 DS    15F                                                      06904000
@SA00003 DS    15F                                                      06905000
@SA00004 DS    15F                                                      06906000
@SA00009 DS    15F                                                      06907000
@SA00018 DS    15F                                                      06908000
@PC00018 DS    1F                                                       06909000
@SA00005 DS    15F                                                      06910000
@SA00006 DS    15F                                                      06911000
@SA00007 DS    15F                                                      06912000
@SA00008 DS    15F                                                      06913000
@SA00028 DS    15F                                                      06914000
@PC00028 DS    1F                                                       06915000
@SA00025 DS    15F                                                      06916000
@PC00032 DS    2F                                                       06917000
@SA00019 DS    15F                                                      06918000
@SA00020 DS    15F                                                      06919000
@PC00020 DS    1F                                                       06920000
@PC00031 DS    1F                                                       06921000
@SA00030 DS    15F                                                      06922000
@PC00030 DS    2F                                                       06923000
@SA00029 DS    15F                                                      06924000
@PC00029 DS    4F                                                       06925000
@SA00027 DS    0F                                                       06926000
@SA00010 DS    0F                                                       06927000
@PC00010 EQU   @SA00010+60                                              06928000
@SA00026 DS    0F                                                       06929000
@SA00033 DS    0F                                                       06930000
@PC00033 EQU   @SA00033+60                                              06931000
@SA00002 DS    0F                                                       06932000
@SA00034 DS    0F                                                       06933000
@PC00034 EQU   @SA00034+60                                              06934000
@SA00011 DS    0F                                                       06935000
@SA00016 DS    0F                                                       06936000
@PC00016 EQU   @SA00016+60                                              06937000
         DS    18F                                                      06938000
@AL00001 DS    2A                                                       06939000
@TF00001 DS    F                                                        06940000
@ZTEMPS  DS    0F                                                       06941000
@ZT00003 DC    F'0'                                                     06942000
@ZTEMPND EQU   *                                                        06943000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         06944000
         DS    0F                                                       06945000
@CF00041 DC    F'1'                                                     06946000
@CH00041 EQU   @CF00041+2                                               06947000
@CF00043 DC    F'3'                                                     06948000
@CH00043 EQU   @CF00043+2                                               06949000
@CF00033 DC    F'8'                                                     06950000
@CH00033 EQU   @CF00033+2                                               06951000
@CF00036 DC    F'12'                                                    06952000
@CH00036 EQU   @CF00036+2                                               06953000
@CV01703 DC    V(HMASMIO)                                               06954000
@CV01704 DC    V(HMASMMSG)                                              06955000
@CV01705 DC    V(HMASMSCN)                                              06956000
@CV01706 DC    V(HMASMGTA)                                              06957000
@CV01707 DC    V(HMASMMPD)                                              06958000
@CV01708 DC    V(HMASMCRD)                                              06959000
@CV01709 DC    V(HMASMSUB)                                              06960000
@CV01710 DC    V(HMASMRCC)                                              06961000
@CV01711 DC    V(HMASMRCF)                                              06962000
@CV01712 DC    V(HMASMRCL)                                              06963000
@CV01713 DC    V(HMASMRCD)                                              06964000
         DS    0D                                                       06965000
IOPPTR   DS    A                                                        06966000
SCPPTR   DS    A                                                        06967000
MPDRETRN DS    F                                                        06968000
READRTN  DS    F                                                        06969000
SAVBUFAD DS    A                                                        06970000
I        DS    F                                                        06971000
II       DS    F                                                        06972000
JJ       DS    F                                                        06973000
FIX31    DS    F                                                        06974000
PREINDX1 DS    F                                                        06975000
NPRINDX1 DS    F                                                        06976000
SUPINDX1 DS    F                                                        06977000
REQINDX1 DS    F                                                        06978000
FIDINDX1 DS    F                                                        06979000
DELINDX1 DS    F                                                        06980000
VRSINDX1 DS    F                                                        06981000
LOCAL1X  DS    F                                                        06982000
LOCAL2X  DS    F                                                        06983000
LOC1X    DS    F                                                        06984000
MM       DS    H                                                        06985000
NN       DS    H                                                        06986000
UU       DS    H                                                        06987000
@CC01742 DC    C'00000000'                                              06988000
@CC02018 DC    C'        '                                              06989000
@CC01733 EQU   @CC02018                                                 06990000
@CC01735 DC    C'   ?   '                                               06991000
@CC01964 DC    C'++'                                                    06992000
@CC02002 DC    C'./'                                                    06993000
@CC01724 DC    C'N'                                                     06994000
@CC01730 DC    C'C'                                                     06995000
         DS    CL1                                                      06996000
HMASMCRP DS    CL106                                                    06997000
         ORG   HMASMCRP                                                 06998000
CRPUXNUM DS    FL1                                                      06999000
@NM00050 DS    CL3                                                      07000000
CRPSCPAD DS    AL4                                                      07001000
CRPINDS  DS    FL1                                                      07002000
CRPOUTDS DS    FL1                                                      07003000
CRPRETRN DS    FL1                                                      07004000
@NM00051 DS    CL3                                                      07005000
CRPFLG1  DS    BL2                                                      07006000
         ORG   CRPFLG1                                                  07007000
CRPBFPRM DS    BL1                                                      07008000
CRPLOGCK EQU   CRPFLG1+0                                                07009000
CRPPTS   EQU   CRPFLG1+0                                                07010000
CRPLOG   EQU   CRPFLG1+0                                                07011000
CRPPRINT EQU   CRPFLG1+0                                                07012000
CRPOTHER EQU   CRPFLG1+0                                                07013000
CRPOFFST EQU   CRPFLG1+0                                                07014000
CRPSCNCL EQU   CRPFLG1+0                                                07015000
CRPEOFEN DS    BL1                                                      07016000
CRPTRMEX EQU   CRPFLG1+1                                                07017000
CRPNOWPP EQU   CRPFLG1+1                                                07018000
CRPLIST  EQU   CRPFLG1+1                                                07019000
CRPRPT   EQU   CRPFLG1+1                                                07020000
@NM00052 EQU   CRPFLG1+1                                                07021000
         ORG   HMASMCRP+16                                              07022000
CRPFLG2  DS    BL2                                                      07023000
         ORG   CRPFLG2                                                  07024000
CRPINSW0 DS    BL1                                                      07025000
         ORG   CRPINSW0                                                 07026000
CRPEOFSW DS    BL1                                                      07027000
         ORG   CRPFLG2+0                                                07028000
CRPINSW1 EQU   CRPFLG2+0                                                07029000
         ORG   CRPINSW1                                                 07030000
CRPEXADD EQU   CRPINSW1+0                                               07031000
         ORG   CRPFLG2+0                                                07032000
CRPINSW2 EQU   CRPFLG2+0                                                07033000
         ORG   CRPINSW2                                                 07034000
CRPWRTLG EQU   CRPINSW2+0                                               07035000
         ORG   CRPFLG2+0                                                07036000
CRPINSW3 EQU   CRPFLG2+0                                                07037000
         ORG   CRPINSW3                                                 07038000
CRPEOF1  EQU   CRPINSW3+0                                               07039000
         ORG   CRPFLG2+0                                                07040000
CRPINSW4 EQU   CRPFLG2+0                                                07041000
CRPINSW5 EQU   CRPFLG2+0                                                07042000
CRPINSW6 EQU   CRPFLG2+0                                                07043000
CRPINSW7 EQU   CRPFLG2+0                                                07044000
         DS    CL1                                                      07045000
CRPINSW8 DS    BL1                                                      07046000
CRPINSW9 EQU   CRPFLG2+1                                                07047000
CRPINSWA EQU   CRPFLG2+1                                                07048000
CRPINSWB EQU   CRPFLG2+1                                                07049000
CRPINSWC EQU   CRPFLG2+1                                                07050000
CRPINSWD EQU   CRPFLG2+1                                                07051000
CRPINSWE EQU   CRPFLG2+1                                                07052000
CRPINSWF EQU   CRPFLG2+1                                                07053000
         ORG   HMASMCRP+18                                              07054000
CRPBUFFR DS    CL80                                                     07055000
         ORG   CRPBUFFR                                                 07056000
CRPBFCTL DS    CL72                                                     07057000
         ORG   CRPBFCTL                                                 07058000
CRPBFDTA DS    CL71                                                     07059000
CRPBFCNT DS    CL1                                                      07060000
         ORG   CRPBUFFR+72                                              07061000
CRPBFSEQ DS    CL8                                                      07062000
         ORG   HMASMCRP+98                                              07063000
CRPDDNAM DS    CL8                                                      07064000
         ORG   HMASMCRP+106                                             07065000
         DS    CL2                                                      07066000
HMASMMGP DS    CL28                                                     07067000
         ORG   HMASMMGP                                                 07068000
MGPFIXED DS    CL12                                                     07069000
         ORG   MGPFIXED                                                 07070000
MGPCLEAR DS    CL6                                                      07071000
         ORG   MGPCLEAR                                                 07072000
MGPMGNO1 DS    FL2                                                      07073000
MGPMGNO2 DS    FL2                                                      07074000
MGPMGNO3 DS    FL2                                                      07075000
         ORG   MGPFIXED+6                                               07076000
MGPFLAGS DS    BL2                                                      07077000
         ORG   MGPFLAGS                                                 07078000
MGPPRINT DS    BL1                                                      07079000
MGPLIST  EQU   MGPFLAGS+0                                               07080000
MGPRPT   EQU   MGPFLAGS+0                                               07081000
MGPHLDS  EQU   MGPFLAGS+0                                               07082000
MGPWTOR  EQU   MGPFLAGS+0                                               07083000
MGPWTO   EQU   MGPFLAGS+0                                               07084000
MGPWTP   EQU   MGPFLAGS+0                                               07085000
@NM00195 EQU   MGPFLAGS+0                                               07086000
         ORG   MGPFIXED+8                                               07087000
MGPTYPE  DS    FL1                                                      07088000
@NM00196 DS    CL3                                                      07089000
         ORG   HMASMMGP+12                                              07090000
MGPVAR   DS    CL16                                                     07091000
         ORG   MGPVAR                                                   07092000
MGPVARPT DS    4A                                                       07093000
         ORG   HMASMMGP+28                                              07094000
MPPPARM  DS    CL23                                                     07095000
         ORG   MPPPARM                                                  07096000
MPPIOPAD DS    AL4                                                      07097000
MPPMCBAD DS    AL4                                                      07098000
MPPCRDAD DS    AL4                                                      07099000
MPPCRDPM DS    AL4                                                      07100000
MPPSMDNM DS    CL7                                                      07101000
         ORG   MPPPARM+23                                               07102000
         DS    CL1                                                      07103000
RECXPARM DS    CL80                                                     07104000
         ORG   RECXPARM                                                 07105000
@NM00199 DS    CL8                                                      07106000
RECXFLGS DS    CL4                                                      07107000
         ORG   RECXFLGS                                                 07108000
RECXFLG1 DS    BL1                                                      07109000
         ORG   RECXFLG1                                                 07110000
RECXPROC DS    BL1                                                      07111000
RECXSYSM EQU   RECXFLG1+0                                               07112000
RECXPEOF EQU   RECXFLG1+0                                               07113000
RECXSYSF EQU   RECXFLG1+0                                               07114000
RECXSYSS EQU   RECXFLG1+0                                               07115000
RECXSEL  EQU   RECXFLG1+0                                               07116000
RECXEXC  EQU   RECXFLG1+0                                               07117000
@NM00200 EQU   RECXFLG1+0                                               07118000
         ORG   RECXFLGS+1                                               07119000
RECXFLG2 DS    BL1                                                      07120000
         ORG   RECXFLG2                                                 07121000
RECXVERF DS    BL1                                                      07122000
RECXAVER EQU   RECXFLG2+0                                               07123000
RECXJCLF EQU   RECXFLG2+0                                               07124000
RECXELEF EQU   RECXFLG2+0                                               07125000
@NM00201 EQU   RECXFLG2+0                                               07126000
         ORG   RECXFLGS+2                                               07127000
RECXFLG3 DS    BL1                                                      07128000
         ORG   RECXFLG3                                                 07129000
RECXPVER DS    BL1                                                      07130000
RECXPIFS EQU   RECXFLG3+0                                               07131000
RECXPTXT EQU   RECXFLG3+0                                               07132000
RECXTXTF EQU   RECXFLG3+0                                               07133000
RECXPUPD EQU   RECXFLG3+0                                               07134000
RECXPELM EQU   RECXFLG3+0                                               07135000
@NM00202 EQU   RECXFLG3+0                                               07136000
         ORG   RECXFLGS+3                                               07137000
RECXFLG4 DS    BL1                                                      07138000
         ORG   RECXFLG4                                                 07139000
@NM00203 DS    BL1                                                      07140000
         ORG   RECXPARM+12                                              07141000
RECXIOPS DS    CL12                                                     07142000
         ORG   RECXIOPS                                                 07143000
RECXIOPT DS    AL4                                                      07144000
RECXIOPP DS    AL4                                                      07145000
RECXIOPG DS    AL4                                                      07146000
         ORG   RECXPARM+24                                              07147000
RECXLAST DS    FL4                                                      07148000
RECXMAX  DS    FL4                                                      07149000
RECXMCB  DS    AL4                                                      07150000
RECXPPTR DS    AL4                                                      07151000
RECXGSMP DS    AL4                                                      07152000
RECXGSRP DS    AL4                                                      07153000
RECXGRFP DS    AL4                                                      07154000
RECXGPSP DS    AL4                                                      07155000
RECXMNDX DS    FL4                                                      07156000
RECXCNT  DS    FL2                                                      07157000
RECXSCNT DS    FL2                                                      07158000
RECXSEQ# DS    FL2                                                      07159000
RECXRFLE DS    FL2                                                      07160000
RECXRNXT DS    FL2                                                      07161000
RECXRCUR DS    FL2                                                      07162000
RECXRELM DS    FL2                                                      07163000
RECXDSPC DS    CL6                                                      07164000
         ORG   RECXPARM+80                                              07165000
HMASMSET DS    CL12                                                     07166000
         ORG   HMASMSET                                                 07167000
SELSTENT DS    CL10                                                     07168000
         ORG   SELSTENT                                                 07169000
SELSTFLG DS    BL2                                                      07170000
         ORG   SELSTFLG                                                 07171000
@NM00208 DS    BL1                                                      07172000
SEMCS    EQU   SELSTFLG+0                                               07173000
SESMD    EQU   SELSTFLG+0                                               07174000
SESRC    DS    BL1                                                      07175000
SEDLB    EQU   SELSTFLG+1                                               07176000
SEMOD    EQU   SELSTFLG+1                                               07177000
SEMAC    EQU   SELSTFLG+1                                               07178000
SELMD    EQU   SELSTFLG+1                                               07179000
SEASM    EQU   SELSTFLG+1                                               07180000
SEFMD    EQU   SELSTFLG+1                                               07181000
SESYS    EQU   SELSTFLG+1                                               07182000
         ORG   SELSTENT+2                                               07183000
SENAME   DS    CL8                                                      07184000
         ORG   SENAME                                                   07185000
SESMDNO  DS    CL7                                                      07186000
         ORG   SESMDNO                                                  07187000
SEPTFNO  DS    CL7                                                      07188000
         ORG   SENAME+7                                                 07189000
@NM00209 DS    CL1                                                      07190000
         ORG   HMASMSET+10                                              07191000
SEFLAGS  DS    BL1                                                      07192000
         ORG   SEFLAGS                                                  07193000
SEGROUP  DS    BL1                                                      07194000
SESELECT EQU   SEFLAGS+0                                                07195000
SEEXCLUD EQU   SEFLAGS+0                                                07196000
SENOJCL  EQU   SEFLAGS+0                                                07197000
SEFMID   EQU   SEFLAGS+0                                                07198000
@NM00210 EQU   SEFLAGS+0                                                07199000
SEFOUND  EQU   SEFLAGS+0                                                07200000
         ORG   HMASMSET+11                                              07201000
SEFLAG2  DS    BL1                                                      07202000
         ORG   SEFLAG2                                                  07203000
SEFLAG2A DS    BL1                                                      07204000
SEFLAG2B EQU   SEFLAG2+0                                                07205000
SEFLAG2C EQU   SEFLAG2+0                                                07206000
SEFLAG2D EQU   SEFLAG2+0                                                07207000
SEFLAG2E EQU   SEFLAG2+0                                                07208000
SEFLAG2F EQU   SEFLAG2+0                                                07209000
SEFLAG2G EQU   SEFLAG2+0                                                07210000
SEFLAG2H EQU   SEFLAG2+0                                                07211000
         ORG   HMASMSET+12                                              07212000
HMASMSPL DS    CL5                                                      07213000
         ORG   HMASMSPL                                                 07214000
SPLPMAD  DS    AL4                                                      07215000
SPLFUNCT DS    FL1                                                      07216000
         ORG   HMASMSPL+5                                               07217000
RECLFLGS DS    BL1                                                      07218000
         ORG   RECLFLGS                                                 07219000
UPDCHG   DS    BL1                                                      07220000
UPDEND   EQU   RECLFLGS+0                                               07221000
REL4VER  EQU   RECLFLGS+0                                               07222000
PTFINOPN EQU   RECLFLGS+0                                               07223000
DUP347   EQU   RECLFLGS+0                                               07224000
DUP362   EQU   RECLFLGS+0                                               07225000
MCSCHECK EQU   RECLFLGS+0                                               07226000
@NM00214 EQU   RECLFLGS+0                                               07227000
         ORG   RECLFLGS+1                                               07228000
RECDSPFX DS    CL26                                                     07229000
VERFMID  DS    CL7                                                      07230000
CHKSMDID DS    CL7                                                      07231000
CHNGMEM  DS    CL8                                                      07232000
ANSWER   DS    CL1                                                      07233000
CHKTYPE  DS    CL1                                                      07234000
CHKSMD#  DS    CL1                                                      07235000
CHKKEY   DS    CL1                                                      07236000
RADJ     DS    CL8                                                      07237000
         DS    CL2                                                      07238000
PKDEC    DS    CL8                                                      07239000
MSGSMDNM DS    CL7                                                      07240000
VPARTS   DS    CL24                                                     07241000
         ORG   VPARTS                                                   07242000
VPART#1  DS    CL8                                                      07243000
VPART#2  DS    CL8                                                      07244000
VPART#3  DS    CL8                                                      07245000
         ORG   VPARTS+24                                                07246000
         DS    CL1                                                      07247000
SCPSTORE DS    CL26                                                     07248000
         DS    CL2                                                      07249000
GTPSM    DS    CL28                                                     07250000
GTASM    DS    CL18                                                     07251000
         DS    CL2                                                      07252000
GTPSR    DS    CL28                                                     07253000
GTASR    DS    CL11                                                     07254000
         DS    CL1                                                      07255000
GTPRF    DS    CL28                                                     07256000
GTARF    DS    CL26                                                     07257000
         DS    CL2                                                      07258000
GTPPS    DS    CL28                                                     07259000
GTAPS    DS    CL8                                                      07260000
MSGSYS   DC    CL8'SYSTEM  '                                            07261000
MSGENT   DC    CL8'ENTRY   '                                            07262000
MSGPTS   DC    CL8'SMPPTS  '                                            07263000
MSGREC   DC    CL7'RECEIVE'                                             07264000
MSGMOD   DC    CL8'MOD     '                                            07265000
MSGZAP   DC    CL8'ZAP     '                                            07266000
MSGMACR  DC    CL8'MAC     '                                            07267000
MSGMACU  DC    CL8'MACUPD  '                                            07268000
MSGSRCR  DC    CL8'SRC     '                                            07269000
MSGSRCU  DC    CL8'SRCUPD  '                                            07270000
MSGDEL   DC    CL8'DELETE  '                                            07271000
MSGNPRE  DC    CL8'NPRE    '                                            07272000
MSGPRE   DC    CL8'PRE     '                                            07273000
MSGSUP   DC    CL8'SUP     '                                            07274000
MSGREQ   DC    CL8'REQ     '                                            07275000
MSGFMID  DC    CL8'FMID    '                                            07276000
MSGVERS  DC    CL8'VERSION '                                            07277000
MSGAPAR  DC    CL8'APAR    '                                            07278000
MSGPTF   DC    CL8'PTF     '                                            07279000
MSGFUNC  DC    CL8'FUNCTION'                                            07280000
MSGUSER  DC    CL8'USERMOD '                                            07281000
         DS    CL1                                                      07282000
PATCHREC DS    CL80                                                     07283000
         ORG   PATCHREC                                                 07284000
@NM00215 DC    80X'FF'                                                  07285000
         ORG   PATCHREC+80                                              07286000
VEROK    DS    CL1                                                      07287000
VERFLGS  DS    BL1                                                      07288000
         ORG   VERFLGS                                                  07289000
SRELCHK  DS    BL1                                                      07290000
FMIDCHK  EQU   VERFLGS+0                                                07291000
@NM00216 EQU   VERFLGS+0                                                07292000
         ORG   VERFLGS+1                                                07293000
LASTUPD# DS    CL8                                                      07294000
GSMBKUP  DS    CL18                                                     07295000
VERCHKF  DS    BL1                                                      07296000
         ORG   VERCHKF                                                  07297000
VALIDVER DS    BL1                                                      07298000
VERCKERR EQU   VERCHKF+0                                                07299000
@NM00218 EQU   VERCHKF+0                                                07300000
         ORG   VERCHKF+1                                                07301000
         DS    CL3                                                      07302000
NXTSUBCB DS    CL10                                                     07303000
         ORG   NXTSUBCB                                                 07304000
SUBINDX  DS    FL2                                                      07305000
SUBFLGS  DS    BL1                                                      07306000
         ORG   SUBFLGS                                                  07307000
SUBEFND  DS    BL1                                                      07308000
@NM00219 EQU   SUBFLGS+0                                                07309000
         ORG   NXTSUBCB+3                                               07310000
SUBNTSM# DS    CL7                                                      07311000
         ORG   NXTSUBCB+10                                              07312000
XPRL     DS    CL10                                                     07313000
INVELMN  DS    3AL1                                                     07314000
HMASMREC CSECT                                                          07315000
SYSMSCAN DSCAN KEY='++',SUCC=PTFKEY,BLANKS=ON                           07316000
PTFKEY   DSCAN KEY='PTF',ALT=FUNCTKEY,ROUT=SMHDTYPE,SUCC=IDLPAR         07317000
FUNCTKEY DSCAN KEY='FUNCTION',ALT=APARKEY,ROUT=SMHDTYPE,SUCC=IDLPAR     07318000
APARKEY  DSCAN KEY='APAR',ALT=USERKEY,ROUT=SMHDTYPE,SUCC=IDLPAR         07319000
USERKEY  DSCAN KEY='USERMOD',ALT=NOTSMHDR,ROUT=SMHDTYPE,SUCC=IDLPAR     07320000
NOTSMHDR DSCAN ROUT=SMCTTYPE                                            07321000
*                                                                       07322000
IDLPAR   DSCAN KEY='(',SUCC=IDVAL1                                      07323000
IDVAL1   DSCAN MINLEN=7,MAXLEN=7,TYPE=AN,ROUT=SM#VALUE                  07324000
HMASMREC CSECT                                                          07325000
UPDDSCAN DSCAN KEY='./ ',SUCC=UPDDS2,ALT=UPDDS1,BLANKS=ON,IO=NO         07326000
UPDDS1   DSCAN KEY='./',SUCC=UPDDS1A,BLANKS=ON,IO=NO                    07327000
UPDDS1A  DSCAN MAXLEN=8,SUCC=UPDDS2,IO=NO                               07328000
UPDDS2   DSCAN KEY='CHANGE',ALT=UPDDS3,ROUT=UPDDCHNG,SUCC=UPDDN1,IO=NO  07329000
UPDDN1   DSCAN KEY='NAME=',SUCC=UPDDN2,ALT=UPDDSKP,IO=NO                07330000
UPDDN2   DSCAN MINLEN=1,MAXLEN=8,TYPE=AN,ROUT=UPDDNAME,IO=NO            07331000
UPDDS3   DSCAN KEY='ENDUP',ROUT=UPDDENDU,IO=NO                          07332000
UPDDSKP  DSCAN MINLEN=0,SUCC=UPDDN1,ROUT=UPDDSKIP,COMMA=NO,IO=NO        07333000
HMASMREC CSECT                                                          07334000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       07335000
@01      EQU   01                                                       07336000
@02      EQU   02                                                       07337000
@03      EQU   03                                                       07338000
@04      EQU   04                                                       07339000
@05      EQU   05                                                       07340000
@06      EQU   06                                                       07341000
@07      EQU   07                                                       07342000
@08      EQU   08                                                       07343000
@09      EQU   09                                                       07344000
@10      EQU   10                                                       07345000
@11      EQU   11                                                       07346000
@12      EQU   12                                                       07347000
@13      EQU   13                                                       07348000
@14      EQU   14                                                       07349000
@15      EQU   15                                                       07350000
CCAPTR   EQU   @11                                                      07351000
REG1     EQU   @01                                                      07352000
REG14    EQU   @14                                                      07353000
REG15    EQU   @15                                                      07354000
RTNCODE  EQU   @15                                                      07355000
RTNREG   EQU   @14                                                      07356000
HMASMCCA EQU   0                                                        07357000
CCAFBUFR EQU   HMASMCCA+4                                               07358000
CCADSAD  EQU   CCAFBUFR+124                                             07359000
CCATPAD  EQU   CCAFBUFR+128                                             07360000
CCAFLAG7 EQU   CCAFBUFR+132                                             07361000
CCAFIOP  EQU   HMASMCCA+140                                             07362000
CCAIOPTR EQU   CCAFIOP                                                  07363000
CCAFSYS  EQU   HMASMCCA+148                                             07364000
CCASREL  EQU   CCAFSYS+12                                               07365000
CCAFLAGA EQU   CCAFSYS+21                                               07366000
CCAFSTA  EQU   HMASMCCA+188                                             07367000
CCARVAD  EQU   CCAFSTA                                                  07368000
CCAFICT  EQU   HMASMCCA+192                                             07369000
CCAFPGM  EQU   HMASMCCA+208                                             07370000
CCABLDLP EQU   CCAFPGM                                                  07371000
CCADBLDL EQU   CCAFPGM+4                                                07372000
CCAFGTP  EQU   HMASMCCA+224                                             07373000
CCASEGTP EQU   CCAFGTP                                                  07374000
CCASETAD EQU   CCASEGTP                                                 07375000
@NM00016 EQU   HMASMCCA+244                                             07376000
CCAFFUNC EQU   HMASMCCA+264                                             07377000
CCAFLAG1 EQU   CCAFFUNC+8                                               07378000
CCAFLAG2 EQU   CCAFFUNC+11                                              07379000
CCAFPROC EQU   HMASMCCA+276                                             07380000
CCAFLAG3 EQU   CCAFPROC                                                 07381000
CCAFDIS  EQU   HMASMCCA+278                                             07382000
CCAFLAG4 EQU   CCAFDIS                                                  07383000
CCAFLAG5 EQU   CCAFDIS+1                                                07384000
CCAFLAG6 EQU   CCAFDIS+2                                                07385000
CCAFCNV  EQU   HMASMCCA+281                                             07386000
CCAFLAG8 EQU   CCAFCNV                                                  07387000
CCAFCTL  EQU   HMASMCCA+282                                             07388000
CCAFLAG9 EQU   CCAFCTL                                                  07389000
CCAFMID  EQU   HMASMCCA+291                                             07390000
CCAFDSNG EQU   HMASMCCA+298                                             07391000
CCAFLAGB EQU   CCAFDSNG                                                 07392000
CCABLDLA EQU   0                                                        07393000
@NM00032 EQU   CCABLDLA                                                 07394000
CCABLDLL EQU   0                                                        07395000
@NM00034 EQU   CCABLDLL                                                 07396000
CCALKDRC EQU   @NM00034+20                                              07397000
@NM00036 EQU   CCABLDLL+124                                             07398000
CCAASMRC EQU   @NM00036+20                                              07399000
@NM00038 EQU   CCABLDLL+248                                             07400000
CCACPYRC EQU   @NM00038+20                                              07401000
@NM00040 EQU   CCABLDLL+372                                             07402000
CCACOMRC EQU   @NM00040+20                                              07403000
@NM00042 EQU   CCABLDLL+496                                             07404000
CCAZAPRC EQU   @NM00042+20                                              07405000
@NM00044 EQU   CCABLDLL+620                                             07406000
CCASUPRC EQU   @NM00044+20                                              07407000
@NM00046 EQU   CCABLDLL+744                                             07408000
CCAUPDRC EQU   @NM00046+20                                              07409000
CCABLDLM EQU   0                                                        07410000
CCABELMT EQU   CCABLDLM+4                                               07411000
CCABMPOS EQU   CCABELMT                                                 07412000
HMASMGTP EQU   0                                                        07413000
GTPFUNCT EQU   HMASMGTP                                                 07414000
GTPRETRN EQU   HMASMGTP+1                                               07415000
GTPRCDLN EQU   HMASMGTP+4                                               07416000
GTPKEYLN EQU   HMASMGTP+6                                               07417000
GTPWKAD  EQU   HMASMGTP+8                                               07418000
GTPBUFAD EQU   HMASMGTP+12                                              07419000
GTPRESTR EQU   HMASMGTP+16                                              07420000
GTPFLGS1 EQU   HMASMGTP+26                                              07421000
HMASMIOP EQU   0                                                        07422000
IOPDSID  EQU   HMASMIOP                                                 07423000
IOPFUNCT EQU   HMASMIOP+1                                               07424000
IOPRETRN EQU   HMASMIOP+2                                               07425000
IOPTYPE  EQU   HMASMIOP+3                                               07426000
IOPNAME  EQU   HMASMIOP+4                                               07427000
IOPNAM17 EQU   IOPNAME                                                  07428000
@NM00056 EQU   HMASMIOP+12                                              07429000
@NM00057 EQU   @NM00056                                                 07430000
IOPSEQNO EQU   @NM00056+8                                               07431000
IOPDDNAM EQU   HMASMIOP+24                                              07432000
IOPBUFAD EQU   HMASMIOP+52                                              07433000
IOPDRMAP EQU   HMASMIOP+56                                              07434000
IOPINAME EQU   IOPDRMAP                                                 07435000
IOPINAM  EQU   IOPINAME                                                 07436000
IOPITYP  EQU   IOPINAM                                                  07437000
IOPUSERL EQU   IOPDRMAP+11                                              07438000
IOPEND   EQU   IOPDRMAP+12                                              07439000
IOPLMCTL EQU   0                                                        07440000
IOPQSMIF EQU   0                                                        07441000
@NM00167 EQU   IOPQSMIF                                                 07442000
IOPQSMLS EQU   IOPQSMIF+8                                               07443000
IOPQSMNM EQU   IOPQSMLS                                                 07444000
IOPBS02  EQU   0                                                        07445000
IOPBS04  EQU   0                                                        07446000
IOPBAPF  EQU   IOPBS04                                                  07447000
MCBPTFMP EQU   0                                                        07448000
MCBTYPE  EQU   MCBPTFMP                                                 07449000
MCBPNO   EQU   MCBPTFMP+1                                               07450000
MCBPRELN EQU   MCBPTFMP+8                                               07451000
MCBPTP   EQU   MCBPTFMP+10                                              07452000
MCBVERMP EQU   0                                                        07453000
MCBSFMID EQU   MCBVERMP+1                                               07454000
MCBVEND  EQU   MCBVERMP+8                                               07455000
MCBIFMP  EQU   0                                                        07456000
MCBIFENV EQU   MCBIFMP+1                                                07457000
MCBIEND  EQU   MCBIFMP+8                                                07458000
MCBELEMP EQU   0                                                        07459000
MCBENAME EQU   MCBELEMP+1                                               07460000
MCBETXLB EQU   MCBELEMP+33                                              07461000
MCBELKLB EQU   MCBELEMP+41                                              07462000
MCBEDALS EQU   MCBELEMP+57                                              07463000
MCBERLF  EQU   MCBELEMP+73                                              07464000
MCBELEPM EQU   MCBELEMP+136                                             07465000
MCBEFLG1 EQU   MCBELEPM                                                 07466000
MCBEFLG2 EQU   MCBELEPM+1                                               07467000
MCBEFLG3 EQU   MCBELEPM+2                                               07468000
MCBEFLG4 EQU   MCBELEPM+3                                               07469000
MCBEFLG5 EQU   MCBELEMP+140                                             07470000
MCBEDEL  EQU   MCBEFLG5                                                 07471000
MCBEEND  EQU   MCBELEMP+141                                             07472000
HMASMPRL EQU   0                                                        07473000
PRLSPAN  EQU   HMASMPRL+2                                               07474000
PRLFLGS  EQU   PRLSPAN                                                  07475000
PRLBLANK EQU   PRLFLGS                                                  07476000
PRLDATE  EQU   HMASMPRL+4                                               07477000
PRLTIME  EQU   HMASMPRL+7                                               07478000
PRLEND   EQU   HMASMPRL+10                                              07479000
GSMREC   EQU   0                                                        07480000
GSMKEY   EQU   GSMREC                                                   07481000
GSMS#    EQU   GSMKEY                                                   07482000
GSMSTY   EQU   GSMKEY+7                                                 07483000
GSMFMID  EQU   GSMREC+8                                                 07484000
GSMSTAT1 EQU   GSMREC+15                                                07485000
GSMUSR   EQU   GSMSTAT1                                                 07486000
GSMSYNTX EQU   GSMSTAT1                                                 07487000
GSMRCVD  EQU   GSMSTAT1                                                 07488000
GSMEXCL  EQU   GSMSTAT1                                                 07489000
GSMNAVER EQU   GSMSTAT1                                                 07490000
GSMSIOE  EQU   GSMSTAT1                                                 07491000
GSMRDUP  EQU   GSMSTAT1                                                 07492000
GSMNFND  EQU   GSMSTAT1+1                                               07493000
GSMHPRT  EQU   GSMSTAT1+1                                               07494000
GSMSTAT2 EQU   GSMREC+17                                                07495000
GSMRLFP  EQU   GSMSTAT2                                                 07496000
GSMSEL   EQU   GSMSTAT2                                                 07497000
GSRREC   EQU   0                                                        07498000
GSRKEY   EQU   GSRREC                                                   07499000
GSRSREL  EQU   GSRKEY                                                   07500000
GSRFMID  EQU   GSRKEY+4                                                 07501000
GRFREC   EQU   0                                                        07502000
GRFKEY   EQU   GRFREC                                                   07503000
GRFFSEQ  EQU   GRFKEY                                                   07504000
GRFELEM  EQU   GRFKEY+2                                                 07505000
GRFELTY  EQU   GRFKEY+10                                                07506000
GRFSM#   EQU   GRFREC+11                                                07507000
GRFSTY   EQU   GRFREC+18                                                07508000
GRFFLGS  EQU   GRFREC+19                                                07509000
GRFRELF# EQU   GRFREC+20                                                07510000
GRFRELF  EQU   GRFREC+22                                                07511000
GPSREC   EQU   0                                                        07512000
GPSKEY   EQU   GPSREC                                                   07513000
GPSTYPE  EQU   GPSKEY                                                   07514000
GPSENT   EQU   GPSKEY+1                                                 07515000
HMASMSCP EQU   0                                                        07516000
SCPCHAR  EQU   HMASMSCP                                                 07517000
SCPSRCH  EQU   HMASMSCP+4                                               07518000
SCPIORTN EQU   HMASMSCP+12                                              07519000
SCPIOPAD EQU   HMASMSCP+16                                              07520000
SCPINLN  EQU   HMASMSCP+20                                              07521000
SCPPMLN  EQU   HMASMSCP+22                                              07522000
SCPEOR   EQU   HMASMSCP+24                                              07523000
SCPCONT  EQU   SCPEOR                                                   07524000
SCPCOMNT EQU   SCPEOR                                                   07525000
SCPRETRN EQU   HMASMSCP+25                                              07526000
SCPRET   EQU   SCPRETRN                                                 07527000
SCPSTRNG EQU   0                                                        07528000
SPLPPACK EQU   0                                                        07529000
SPLPUNPK EQU   0                                                        07530000
SPLPDSN  EQU   0                                                        07531000
SPLODSN  EQU   SPLPDSN                                                  07532000
UX001PRM EQU   0                                                        07533000
RVAPARM  EQU   0                                                        07534000
RVAINFO  EQU   RVAPARM                                                  07535000
RVAPASS  EQU   RVAPARM+12                                               07536000
RVAREC   EQU   RVAPASS+4                                                07537000
RVASTAE  EQU   RVAPARM+20                                               07538000
@NM00211 EQU   RVASTAE+16                                               07539000
@NM00212 EQU   RVASTAE+20                                               07540000
RVAFLAGS EQU   RVASTAE+24                                               07541000
@NM00217 EQU   0                                                        07542000
SM#ID    EQU   @NM00217                                                 07543000
CCADSIDA EQU   0                                                        07544000
CCATYPEA EQU   0                                                        07545000
IOPBS01  EQU   0                                                        07546000
IOPBS03  EQU   0                                                        07547000
SCPIOPRM EQU   0                                                        07548000
RECPARM  EQU   0                                                        07549000
RECFLAGS EQU   RECPARM+8                                                07550000
RECFLG1  EQU   RECFLAGS                                                 07551000
RECFLG2  EQU   RECFLAGS+2                                               07552000
RECSEL   EQU   RECFLG2                                                  07553000
RECEXC   EQU   RECFLG2                                                  07554000
RECFLG3  EQU   RECFLAGS+3                                               07555000
RECFLG4  EQU   RECFLAGS+5                                               07556000
RECBPFM  EQU   RECFLG4                                                  07557000
RECFLG5  EQU   RECFLAGS+7                                               07558000
SYSMNAME EQU   0                                                        07559000
MSGCODE1 EQU   0                                                        07560000
MSGCODE2 EQU   0                                                        07561000
MSGCODE3 EQU   0                                                        07562000
PRTFLG   EQU   0                                                        07563000
UPDCK    EQU   0                                                        07564000
VERCK    EQU   0                                                        07565000
OPR1INDX EQU   0                                                        07566000
OPR1TYPE EQU   0                                                        07567000
OPR2INDX EQU   0                                                        07568000
OPR2TYPE EQU   0                                                        07569000
OPR1INX  EQU   0                                                        07570000
OPR1TYP  EQU   0                                                        07571000
SUBTYPE  EQU   0                                                        07572000
PINDCODE EQU   0                                                        07573000
CHARVAL  EQU   0                                                        07574000
NFNDSMD# EQU   0                                                        07575000
SKPN     EQU   0                                                        07576000
IOPUDATA EQU   IOPEND                                                   07577000
IOPINAM3 EQU   IOPINAME                                                 07578000
@NM00063 EQU   IOPINAM3                                                 07579000
IOPSTCMP EQU   IOPUDATA                                                 07580000
IOPDYNDT EQU   IOPUDATA                                                 07581000
IOPSPACE EQU   IOPDYNDT+44                                              07582000
IOPDTYPE EQU   IOPDYNDT+50                                              07583000
IOPNTMAX EQU   IOPDRMAP                                                 07584000
IOPNTMAP EQU   IOPDRMAP                                                 07585000
IOPCDMAP EQU   IOPNTMAP                                                 07586000
IOPPTMAP EQU   IOPCDMAP                                                 07587000
IOPSCMAP EQU   IOPPTMAP                                                 07588000
IOPDIRCT EQU   IOPSCMAP+12                                              07589000
IOPCDMAX EQU   IOPDIRCT                                                 07590000
IOPCQMAP EQU   IOPDRMAP                                                 07591000
@NM00074 EQU   IOPUDATA                                                 07592000
IOPTPSEQ EQU   @NM00074+8                                               07593000
@NM00075 EQU   IOPUDATA                                                 07594000
IOPASMNT EQU   IOPUDATA                                                 07595000
IOPASMDR EQU   IOPASMNT                                                 07596000
IOPNTLVL EQU   IOPASMDR                                                 07597000
IOPABUNT EQU   IOPASMDR+1                                               07598000
IOPLMDNT EQU   IOPUDATA                                                 07599000
IOPLMDDR EQU   IOPLMDNT                                                 07600000
IOPLMLEP EQU   IOPLMDDR+1                                               07601000
IOPLMDF1 EQU   IOPLMLEP                                                 07602000
IOPFLGS2 EQU   IOPLMDF1                                                 07603000
IOPLMDF2 EQU   IOPLMLEP+1                                               07604000
IOPLMDF3 EQU   IOPLMLEP+2                                               07605000
IOPLMDF4 EQU   IOPLMLEP+3                                               07606000
IOPLMDF5 EQU   IOPLMDDR+5                                               07607000
IOPFLGS3 EQU   IOPLMDF5                                                 07608000
IOPLMDFX EQU   IOPLMDNT+24                                              07609000
@NM00084 EQU   IOPLMDFX                                                 07610000
IOPLNTRY EQU   IOPLMDFX+8                                               07611000
IOPLSYS  EQU   IOPLNTRY                                                 07612000
IOPSYSLB EQU   IOPLSYS                                                  07613000
IOPMACNT EQU   IOPUDATA                                                 07614000
IOPMACDR EQU   IOPMACNT                                                 07615000
IOPRMIDE EQU   IOPMACDR+1                                               07616000
IOPRMST  EQU   IOPRMIDE+7                                               07617000
IOPFMIDE EQU   IOPMACDR+9                                               07618000
IOPMACFX EQU   IOPMACNT+24                                              07619000
IOPBUNT  EQU   IOPMACFX                                                 07620000
IOPMCEND EQU   IOPMACNT+104                                             07621000
IOPMACVR EQU   IOPMCEND                                                 07622000
IOPMCENT EQU   IOPMACVR                                                 07623000
IOPMCDTA EQU   IOPMCENT                                                 07624000
IOPMCASM EQU   IOPMCDTA                                                 07625000
IOPMACID EQU   IOPMCASM                                                 07626000
IOPMACST EQU   IOPMCASM+7                                               07627000
IOPMCIND EQU   IOPMCENT+8                                               07628000
IOPEOFNT EQU   IOPUDATA                                                 07629000
IOPSRCNT EQU   IOPUDATA                                                 07630000
IOPSRCDR EQU   IOPSRCNT                                                 07631000
@NM00095 EQU   IOPSRCDR+1                                               07632000
@NM00097 EQU   @NM00095+7                                               07633000
@NM00101 EQU   IOPSRCDR+9                                               07634000
IOPSRCFX EQU   IOPSRCNT+24                                              07635000
@NM00105 EQU   IOPSRCFX                                                 07636000
IOPSREND EQU   IOPSRCNT+104                                             07637000
IOPSRCVR EQU   IOPSREND                                                 07638000
IOPSNTRY EQU   IOPSRCVR                                                 07639000
IOPSRDTA EQU   IOPSNTRY                                                 07640000
IOPSRCID EQU   IOPSRDTA                                                 07641000
IOPSRCST EQU   IOPSRDTA+7                                               07642000
IOPMODNT EQU   IOPUDATA                                                 07643000
IOPMODDR EQU   IOPMODNT                                                 07644000
@NM00111 EQU   IOPMODDR+1                                               07645000
@NM00113 EQU   @NM00111+7                                               07646000
@NM00117 EQU   IOPMODDR+9                                               07647000
IOPMODFX EQU   IOPMODNT+24                                              07648000
@NM00121 EQU   IOPMODFX                                                 07649000
IOPMDLEP EQU   IOPMODFX+8                                               07650000
IOPMODF1 EQU   IOPMDLEP                                                 07651000
IOPMODF2 EQU   IOPMDLEP+1                                               07652000
IOPMODF3 EQU   IOPMDLEP+2                                               07653000
IOPMODF4 EQU   IOPMDLEP+3                                               07654000
IOPMDEND EQU   IOPMODNT+104                                             07655000
IOPMODVR EQU   IOPMDEND                                                 07656000
IOPMNTRY EQU   IOPMODVR                                                 07657000
IOPMDDTA EQU   IOPMNTRY                                                 07658000
IOPLMODS EQU   IOPMDDTA                                                 07659000
IOPMODID EQU   IOPLMODS                                                 07660000
IOPMODST EQU   IOPLMODS+7                                               07661000
IOPDLBNT EQU   IOPUDATA                                                 07662000
IOPDLBDR EQU   IOPDLBNT                                                 07663000
IOPDLBFX EQU   IOPDLBNT+24                                              07664000
@NM00132 EQU   IOPDLBFX                                                 07665000
IOPDLEND EQU   IOPDLBNT+104                                             07666000
IOPDLBVR EQU   IOPDLEND                                                 07667000
IOPDNTRY EQU   IOPDLBVR                                                 07668000
IOPDSYS  EQU   IOPDNTRY                                                 07669000
IOPSYSNT EQU   IOPUDATA                                                 07670000
IOPSYSDR EQU   IOPSYSNT                                                 07671000
IOPSYSF1 EQU   IOPSYSDR+4                                               07672000
IOPFLGS7 EQU   IOPSYSF1                                                 07673000
IOPSYSFX EQU   IOPSYSNT+24                                              07674000
@NM00139 EQU   IOPSYSFX                                                 07675000
IOPSYEND EQU   IOPSYSNT+184                                             07676000
IOPSYSVR EQU   IOPSYEND                                                 07677000
IOPSYSTR EQU   IOPSYSVR                                                 07678000
IOPSYNTR EQU   IOPSYSTR                                                 07679000
IOPPTFNT EQU   IOPUDATA                                                 07680000
IOPPTFDR EQU   IOPPTFNT                                                 07681000
IOPPTYPE EQU   IOPPTFDR+1                                               07682000
IOPPSTAT EQU   IOPPTFDR+2                                               07683000
IOPPTFF1 EQU   IOPPSTAT                                                 07684000
IOPFLGS5 EQU   IOPPTFF1                                                 07685000
IOPERROR EQU   IOPFLGS5                                                 07686000
IOPPTFF2 EQU   IOPPSTAT+1                                               07687000
IOPPTFF3 EQU   IOPPSTAT+3                                               07688000
IOPFLF   EQU   IOPPTFF3                                                 07689000
IOPPTFFX EQU   IOPPTFNT+24                                              07690000
@NM00148 EQU   IOPPTFFX                                                 07691000
@NM00149 EQU   @NM00148                                                 07692000
IOPPDTES EQU   IOPPTFFX+41                                              07693000
@NM00152 EQU   IOPPDTES                                                 07694000
IOPPTPFX EQU   IOPPDTES+6                                               07695000
IOPDATES EQU   IOPPTPFX                                                 07696000
IOPPTEND EQU   IOPPTFNT+104                                             07697000
IOPPTFVR EQU   IOPPTEND                                                 07698000
IOPPNTRY EQU   IOPPTFVR                                                 07699000
IOPPMODS EQU   IOPPNTRY                                                 07700000
IOPPTFND EQU   IOPPMODS                                                 07701000
IOPPIND  EQU   IOPPNTRY+8                                               07702000
IOPENTNT EQU   IOPUDATA+104                                             07703000
IOPSRLNT EQU   IOPUDATA+104                                             07704000
IOPPRENT EQU   IOPUDATA+104                                             07705000
IOPNPRNT EQU   IOPUDATA+104                                             07706000
IOPSUPNT EQU   IOPUDATA+104                                             07707000
IOPREQNT EQU   IOPUDATA+104                                             07708000
IOPIRQNT EQU   IOPUDATA+104                                             07709000
IOPFIDNT EQU   IOPUDATA+104                                             07710000
IOPDELNT EQU   IOPUDATA+104                                             07711000
IOPVERNT EQU   IOPUDATA+104                                             07712000
IOPSBYNT EQU   IOPUDATA+104                                             07713000
IOPQSMNT EQU   IOPUDATA                                                 07714000
IOPQSMDR EQU   IOPQSMNT                                                 07715000
IOPQFMNT EQU   IOPUDATA                                                 07716000
IOPQFMDR EQU   IOPQFMNT                                                 07717000
IOPQFEND EQU   IOPQFMNT+2                                               07718000
IOPQFMVR EQU   IOPQFEND                                                 07719000
IOPQFMLS EQU   IOPQFMVR                                                 07720000
IOPQFMNM EQU   IOPQFMLS                                                 07721000
IOPPTSYS EQU   IOPUDATA                                                 07722000
IOPPTSDR EQU   IOPPTSYS                                                 07723000
IOPPTSFX EQU   IOPPTSYS+24                                              07724000
IOPDSSPC EQU   IOPPTSFX                                                 07725000
IOPDSPFX EQU   IOPPTSFX+6                                               07726000
IOPPTFG1 EQU   IOPPTSFX+34                                              07727000
IOPPSEND EQU   IOPPTSYS+1064                                            07728000
IOPPTSVR EQU   IOPPSEND                                                 07729000
IOPPTNTR EQU   IOPPTSVR                                                 07730000
@NM00177 EQU   IOPPTNTR                                                 07731000
IOPPTFMD EQU   @NM00177                                                 07732000
IOPPTREL EQU   IOPPTFMD                                                 07733000
IOPPTSND EQU   IOPPTREL                                                 07734000
IOPPTIND EQU   IOPPTNTR+8                                               07735000
IOPBPDS  EQU   IOPUDATA                                                 07736000
IOPBLEP1 EQU   IOPBPDS+8                                                07737000
IOPBLEP2 EQU   IOPBPDS+9                                                07738000
@NM00181 EQU   IOPBPDS+18                                               07739000
IOPBFTB0 EQU   @NM00181                                                 07740000
IOPBFTB1 EQU   IOPBFTB0                                                 07741000
MCBVVLST EQU   MCBVEND                                                  07742000
MCBVNTRY EQU   MCBVVLST                                                 07743000
MCBVNUM  EQU   MCBVNTRY                                                 07744000
MCBVND   EQU   MCBVNUM                                                  07745000
MCBVIND  EQU   MCBVVLST+8                                               07746000
MCBIVLST EQU   MCBIEND                                                  07747000
MCBINTRY EQU   MCBIVLST                                                 07748000
MCBINUM  EQU   MCBINTRY                                                 07749000
MCBEVLST EQU   MCBEEND                                                  07750000
MCBENTRY EQU   MCBEVLST                                                 07751000
MCBENUM  EQU   MCBENTRY                                                 07752000
MCBEND   EQU   MCBENUM                                                  07753000
MCBEIND  EQU   MCBEVLST+8                                               07754000
PRLDATA  EQU   PRLEND                                                   07755000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    07756000
@NM00194 EQU   MCBENTRY+7                                               07757000
MCBIIND  EQU   MCBIVLST+8                                               07758000
@NM00187 EQU   MCBINTRY+7                                               07759000
MCBIND   EQU   MCBINUM                                                  07760000
@NM00185 EQU   MCBVNTRY+7                                               07761000
IOPBCEND EQU   IOPBPDS+21                                               07762000
IOPBFTB3 EQU   IOPBFTB0+2                                               07763000
IOPBFTB2 EQU   IOPBFTB0+1                                               07764000
@NM00183 EQU   IOPBFTB1                                                 07765000
IOPBAPFP EQU   IOPBFTB1                                                 07766000
IOPBSSI  EQU   IOPBFTB1                                                 07767000
IOPBPAGA EQU   IOPBFTB1                                                 07768000
@NM00182 EQU   IOPBFTB1                                                 07769000
IOPBAOSL EQU   IOPBFTB1                                                 07770000
IOPBSEPA EQU   IOPBPDS+15                                               07771000
IOPBFTBL EQU   IOPBPDS+13                                               07772000
IOPBSTOR EQU   IOPBPDS+10                                               07773000
IOPBREFR EQU   IOPBLEP2                                                 07774000
IOPBLEF  EQU   IOPBLEP2                                                 07775000
IOPBTEST EQU   IOPBLEP2                                                 07776000
IOPBNE   EQU   IOPBLEP2                                                 07777000
@NM00180 EQU   IOPBLEP2                                                 07778000
IOPBDC   EQU   IOPBLEP2                                                 07779000
@NM00179 EQU   IOPBLEP1                                                 07780000
IOPBSCTR EQU   IOPBLEP1                                                 07781000
IOPBOL   EQU   IOPBLEP1                                                 07782000
@NM00178 EQU   IOPBLEP1                                                 07783000
IOPBOVLY EQU   IOPBLEP1                                                 07784000
IOPBREUS EQU   IOPBLEP1                                                 07785000
IOPBRENT EQU   IOPBLEP1                                                 07786000
IOPBNL   EQU   IOPBPDS+7                                                07787000
IOPBTTRN EQU   IOPBPDS+4                                                07788000
IOPBZERO EQU   IOPBPDS+3                                                07789000
IOPBTTRT EQU   IOPBPDS                                                  07790000
@NM00176 EQU   IOPPTSFX+872                                             07791000
IOPSYZPP EQU   IOPPTSFX+772                                             07792000
IOPSYZPR EQU   IOPPTSFX+771                                             07793000
IOPSYZPS EQU   IOPPTSFX+763                                             07794000
IOPSYZAP EQU   IOPPTSFX+755                                             07795000
IOPSYUPP EQU   IOPPTSFX+655                                             07796000
IOPSYUPR EQU   IOPPTSFX+654                                             07797000
IOPSYUPS EQU   IOPPTSFX+646                                             07798000
IOPSYUPD EQU   IOPPTSFX+638                                             07799000
IOPSYSPP EQU   IOPPTSFX+538                                             07800000
IOPSYSPR EQU   IOPPTSFX+537                                             07801000
IOPSYSPS EQU   IOPPTSFX+529                                             07802000
IOPSYSUP EQU   IOPPTSFX+521                                             07803000
IOPSYLKP EQU   IOPPTSFX+421                                             07804000
IOPSYLKR EQU   IOPPTSFX+420                                             07805000
IOPSYLKS EQU   IOPPTSFX+412                                             07806000
IOPSYLKD EQU   IOPPTSFX+404                                             07807000
IOPSYCPP EQU   IOPPTSFX+304                                             07808000
IOPSYCPR EQU   IOPPTSFX+303                                             07809000
IOPSYCPS EQU   IOPPTSFX+295                                             07810000
IOPSYCPY EQU   IOPPTSFX+287                                             07811000
IOPSYCOP EQU   IOPPTSFX+187                                             07812000
IOPSYCOR EQU   IOPPTSFX+186                                             07813000
IOPSYCOS EQU   IOPPTSFX+178                                             07814000
IOPSYCOM EQU   IOPPTSFX+170                                             07815000
IOPSYASP EQU   IOPPTSFX+70                                              07816000
IOPSYASR EQU   IOPPTSFX+69                                              07817000
IOPSYASS EQU   IOPPTSFX+61                                              07818000
IOPSYASM EQU   IOPPTSFX+53                                              07819000
@NM00175 EQU   IOPPTSFX+35                                              07820000
@NM00174 EQU   IOPPTFG1                                                 07821000
IOPPTSNJ EQU   IOPPTFG1                                                 07822000
IOPPTSNP EQU   IOPPTFG1                                                 07823000
IOPSYPLN EQU   IOPPTSFX+32                                              07824000
IOPDSDIR EQU   IOPDSSPC+4                                               07825000
IOPDSSEC EQU   IOPDSSPC+2                                               07826000
IOPDSPRM EQU   IOPDSSPC                                                 07827000
@NM00173 EQU   IOPPTSDR+4                                               07828000
IOPPTPEM EQU   IOPPTSDR+2                                               07829000
IOPPCNVL EQU   IOPPTSDR+1                                               07830000
@NM00172 EQU   IOPPTSDR                                                 07831000
IOPQFMTP EQU   IOPQFMLS+8                                               07832000
@NM00171 EQU   IOPQFMLS+7                                               07833000
IOPQFMND EQU   IOPQFMNM                                                 07834000
@NM00170 EQU   IOPQFMDR                                                 07835000
@NM00166 EQU   IOPQSMDR                                                 07836000
@NM00165 EQU   IOPSBYNT+8                                               07837000
IOPSBYST EQU   IOPSBYNT+7                                               07838000
IOPSBYNM EQU   IOPSBYNT                                                 07839000
@NM00164 EQU   IOPVERNT+8                                               07840000
IOPVERST EQU   IOPVERNT+7                                               07841000
IOPVERNM EQU   IOPVERNT                                                 07842000
@NM00163 EQU   IOPDELNT+8                                               07843000
IOPDELST EQU   IOPDELNT+7                                               07844000
IOPDELNM EQU   IOPDELNT                                                 07845000
@NM00162 EQU   IOPFIDNT+8                                               07846000
IOPFIDST EQU   IOPFIDNT+7                                               07847000
IOPFIDNM EQU   IOPFIDNT                                                 07848000
@NM00161 EQU   IOPIRQNT+8                                               07849000
IOPIRQST EQU   IOPIRQNT+7                                               07850000
IOPIRQNM EQU   IOPIRQNT                                                 07851000
@NM00160 EQU   IOPREQNT+8                                               07852000
IOPREQST EQU   IOPREQNT+7                                               07853000
IOPREQNM EQU   IOPREQNT                                                 07854000
@NM00159 EQU   IOPSUPNT+8                                               07855000
IOPSUPST EQU   IOPSUPNT+7                                               07856000
IOPSUPNM EQU   IOPSUPNT                                                 07857000
@NM00158 EQU   IOPNPRNT+8                                               07858000
IOPNPRST EQU   IOPNPRNT+7                                               07859000
IOPNPRNM EQU   IOPNPRNT                                                 07860000
@NM00157 EQU   IOPPRENT+8                                               07861000
IOPPREST EQU   IOPPRENT+7                                               07862000
IOPPRENM EQU   IOPPRENT                                                 07863000
@NM00156 EQU   IOPSRLNT+8                                               07864000
IOPSRLST EQU   IOPSRLNT+7                                               07865000
@NM00155 EQU   IOPSRLNT+4                                               07866000
IOPSRLNM EQU   IOPSRLNT                                                 07867000
@NM00154 EQU   IOPENTNT+8                                               07868000
IOPENTST EQU   IOPENTNT+7                                               07869000
IOPENTNM EQU   IOPENTNT                                                 07870000
IOPPFMID EQU   IOPPTFFX+73                                              07871000
@NM00153 EQU   IOPPTPFX+24                                              07872000
IOPUCLT  EQU   IOPDATES+21                                              07873000
IOPUCLD  EQU   IOPDATES+18                                              07874000
IOPACCT  EQU   IOPDATES+15                                              07875000
IOPACCD  EQU   IOPDATES+12                                              07876000
IOPRSTT  EQU   IOPDATES+9                                               07877000
IOPRSTD  EQU   IOPDATES+6                                               07878000
IOPAPPT  EQU   IOPDATES+3                                               07879000
IOPAPPD  EQU   IOPDATES                                                 07880000
IOPRECT  EQU   @NM00152+3                                               07881000
IOPRECD  EQU   @NM00152                                                 07882000
@NM00151 EQU   IOPPTFFX+8                                               07883000
@NM00150 EQU   @NM00148+7                                               07884000
IOPPRELN EQU   @NM00149                                                 07885000
@NM00147 EQU   IOPPTFDR+20                                              07886000
IOPSBYNO EQU   IOPPTFDR+13                                              07887000
IOPDBYNO EQU   IOPPTFDR+6                                               07888000
@NM00146 EQU   IOPPTFF3                                                 07889000
IOPDBYP  EQU   IOPPTFF3                                                 07890000
IOPSBYP  EQU   IOPPTFF3                                                 07891000
IOPPMDLP EQU   IOPPTFF2+1                                               07892000
IOPPADDP EQU   IOPPTFF2+1                                               07893000
@NM00145 EQU   IOPPTFF2+1                                               07894000
IOPLRFP  EQU   IOPPTFF2                                                 07895000
IOPJCLP  EQU   IOPPTFF2                                                 07896000
IOPSUPP  EQU   IOPPTFF2                                                 07897000
IOPREQP  EQU   IOPPTFF2                                                 07898000
IOPPREP  EQU   IOPPTFF2                                                 07899000
IOPNPRP  EQU   IOPPTFF2                                                 07900000
IOPIRQP  EQU   IOPPTFF2                                                 07901000
IOPDELP  EQU   IOPPTFF2                                                 07902000
IOPREGEN EQU   IOPFLGS5                                                 07903000
IOPBYP   EQU   IOPFLGS5                                                 07904000
IOPDUMMP EQU   IOPFLGS5                                                 07905000
@NM00144 EQU   IOPFLGS5                                                 07906000
IOPACC   EQU   IOPFLGS5                                                 07907000
IOPRES   EQU   IOPFLGS5                                                 07908000
IOPAPP   EQU   IOPFLGS5                                                 07909000
@NM00143 EQU   IOPPTFDR                                                 07910000
IOPSYSTP EQU   IOPSYSTR+8                                               07911000
IOPSYSND EQU   IOPSYNTR                                                 07912000
@NM00142 EQU   IOPSYSFX+21                                              07913000
IOPSYSID EQU   IOPSYSFX+13                                              07914000
IOPNUCID EQU   IOPSYSFX+12                                              07915000
IOPSREL  EQU   IOPSYSFX+8                                               07916000
@NM00141 EQU   @NM00139+7                                               07917000
@NM00140 EQU   @NM00139                                                 07918000
@NM00138 EQU   IOPSYSDR+5                                               07919000
@NM00137 EQU   IOPFLGS7                                                 07920000
IOPSYNG  EQU   IOPFLGS7                                                 07921000
IOPSYDL  EQU   IOPFLGS7                                                 07922000
IOPSTSNP EQU   IOPFLGS7                                                 07923000
IOPMTSNP EQU   IOPFLGS7                                                 07924000
IOPPEMAX EQU   IOPSYSDR+2                                               07925000
IOPSCNVL EQU   IOPSYSDR+1                                               07926000
@NM00136 EQU   IOPSYSDR                                                 07927000
IOPDLIND EQU   IOPDNTRY+8                                               07928000
IOPDLBND EQU   IOPDSYS                                                  07929000
@NM00135 EQU   IOPDLBFX+8                                               07930000
@NM00134 EQU   @NM00132+7                                               07931000
@NM00133 EQU   @NM00132                                                 07932000
@NM00131 EQU   IOPDLBDR+1                                               07933000
@NM00130 EQU   IOPDLBDR                                                 07934000
IOPMDIND EQU   IOPMNTRY+8                                               07935000
@NM00129 EQU   IOPMODST                                                 07936000
IOPMODND EQU   IOPMODID                                                 07937000
IOPDLIB  EQU   IOPMODFX+72                                              07938000
@NM00128 EQU   IOPMODFX+12                                              07939000
@NM00127 EQU   IOPMODF4                                                 07940000
@NM00126 EQU   IOPMODF3                                                 07941000
@NM00125 EQU   IOPMODF2                                                 07942000
IOPMPAGA EQU   IOPMODF2                                                 07943000
IOPMNE   EQU   IOPMODF2                                                 07944000
@NM00124 EQU   IOPMODF1                                                 07945000
IOPMDC   EQU   IOPMODF1                                                 07946000
IOPMREFR EQU   IOPMODF1                                                 07947000
IOPMOVLY EQU   IOPMODF1                                                 07948000
IOPMSCTR EQU   IOPMODF1                                                 07949000
IOPMREUS EQU   IOPMODF1                                                 07950000
IOPMRENT EQU   IOPMODF1                                                 07951000
IOPMAPF  EQU   IOPMODF1                                                 07952000
@NM00123 EQU   @NM00121+7                                               07953000
@NM00122 EQU   @NM00121                                                 07954000
@NM00120 EQU   IOPMODDR+17                                              07955000
@NM00119 EQU   @NM00117+7                                               07956000
@NM00118 EQU   @NM00117                                                 07957000
@NM00116 EQU   @NM00113                                                 07958000
@NM00115 EQU   @NM00113                                                 07959000
@NM00114 EQU   @NM00113                                                 07960000
@NM00112 EQU   @NM00111                                                 07961000
@NM00110 EQU   IOPMODDR                                                 07962000
IOPSRIND EQU   IOPSNTRY+8                                               07963000
@NM00109 EQU   IOPSRCST                                                 07964000
IOPSRCND EQU   IOPSRCID                                                 07965000
IOPSRDLB EQU   IOPSRCFX+72                                              07966000
IOPSRSYS EQU   IOPSRCFX+64                                              07967000
@NM00108 EQU   IOPSRCFX+8                                               07968000
@NM00107 EQU   @NM00105+7                                               07969000
@NM00106 EQU   @NM00105                                                 07970000
@NM00104 EQU   IOPSRCDR+18                                              07971000
IOPSRLNG EQU   IOPSRCDR+17                                              07972000
@NM00103 EQU   @NM00101+7                                               07973000
@NM00102 EQU   @NM00101                                                 07974000
@NM00100 EQU   @NM00097                                                 07975000
@NM00099 EQU   @NM00097                                                 07976000
@NM00098 EQU   @NM00097                                                 07977000
@NM00096 EQU   @NM00095                                                 07978000
@NM00094 EQU   IOPSRCDR                                                 07979000
IOPEOFND EQU   IOPEOFNT                                                 07980000
IOPMCTYP EQU   IOPMCIND                                                 07981000
@NM00093 EQU   IOPMACST                                                 07982000
IOPMACND EQU   IOPMACID                                                 07983000
IOPMCDLB EQU   IOPMACFX+72                                              07984000
IOPMCSYS EQU   IOPMACFX+64                                              07985000
@NM00092 EQU   IOPMACFX+8                                               07986000
IOPBUTYP EQU   IOPBUNT+7                                                07987000
IOPBUSMD EQU   IOPBUNT                                                  07988000
@NM00091 EQU   IOPMACDR+18                                              07989000
IOPMCLNG EQU   IOPMACDR+17                                              07990000
IOPFMST  EQU   IOPFMIDE+7                                               07991000
IOPFMID  EQU   IOPFMIDE                                                 07992000
@NM00090 EQU   IOPRMST                                                  07993000
IOPRMASM EQU   IOPRMST                                                  07994000
@NM00089 EQU   IOPRMST                                                  07995000
IOPRMID  EQU   IOPRMIDE                                                 07996000
@NM00088 EQU   IOPMACDR                                                 07997000
IOPLMIND EQU   IOPLNTRY+8                                               07998000
IOPLMDND EQU   IOPSYSLB                                                 07999000
@NM00086 EQU   @NM00084+7                                               08000000
@NM00085 EQU   @NM00084                                                 08001000
@NM00083 EQU   IOPLMDDR+6                                               08002000
@NM00082 EQU   IOPFLGS3                                                 08003000
IOPCHREP EQU   IOPFLGS3                                                 08004000
IOPLINK  EQU   IOPFLGS3                                                 08005000
IOPCOPY  EQU   IOPFLGS3                                                 08006000
@NM00081 EQU   IOPLMDF4                                                 08007000
@NM00080 EQU   IOPLMDF3                                                 08008000
@NM00079 EQU   IOPLMDF2                                                 08009000
IOPPAGA  EQU   IOPLMDF2                                                 08010000
IOPNE    EQU   IOPLMDF2                                                 08011000
@NM00078 EQU   IOPFLGS2                                                 08012000
IOPDC    EQU   IOPFLGS2                                                 08013000
IOPREFR  EQU   IOPFLGS2                                                 08014000
IOPOVLY  EQU   IOPFLGS2                                                 08015000
IOPSCTR  EQU   IOPFLGS2                                                 08016000
IOPREUS  EQU   IOPFLGS2                                                 08017000
IOPRENT  EQU   IOPFLGS2                                                 08018000
IOPAPF   EQU   IOPFLGS2                                                 08019000
@NM00077 EQU   IOPLMDDR                                                 08020000
@NM00076 EQU   IOPASMDR+9                                               08021000
IOPABUTP EQU   IOPABUNT+7                                               08022000
IOPABUPT EQU   IOPABUNT                                                 08023000
IOPALLOC EQU   @NM00075+4                                               08024000
IOPUSED  EQU   @NM00075                                                 08025000
IOPVLSER EQU   @NM00074+2                                               08026000
IOPBLKSI EQU   @NM00074                                                 08027000
IOPCQMAX EQU   IOPCQMAP+12                                              08028000
@NM00073 EQU   IOPCQMAP+11                                              08029000
@NM00072 EQU   IOPCQMAP+8                                               08030000
@NM00071 EQU   IOPCQMAP                                                 08031000
IOPPTMAX EQU   IOPCDMAX                                                 08032000
@NM00070 EQU   IOPSCMAP+11                                              08033000
@NM00069 EQU   IOPSCMAP+8                                               08034000
@NM00068 EQU   IOPSCMAP                                                 08035000
IOPDIRMX EQU   IOPNTMAX+12                                              08036000
@NM00067 EQU   IOPNTMAX+11                                              08037000
@NM00066 EQU   IOPNTMAX+8                                               08038000
@NM00065 EQU   IOPNTMAX                                                 08039000
@NM00064 EQU   IOPDTYPE                                                 08040000
IOPDMOD  EQU   IOPDTYPE                                                 08041000
IOPDJCL  EQU   IOPDTYPE                                                 08042000
IOPDSRC  EQU   IOPDTYPE                                                 08043000
IOPDMAC  EQU   IOPDTYPE                                                 08044000
IOPSDIR  EQU   IOPSPACE+4                                               08045000
IOPSSCND EQU   IOPSPACE+2                                               08046000
IOPSPRIM EQU   IOPSPACE                                                 08047000
IOPDSN   EQU   IOPDYNDT                                                 08048000
IOPNTYPE EQU   IOPSTCMP+17                                              08049000
IOPNNAME EQU   IOPSTCMP+9                                               08050000
IOPOTYPE EQU   IOPSTCMP+8                                               08051000
IOPONAME EQU   IOPSTCMP                                                 08052000
IOPISEQ3 EQU   IOPINAM3+6                                               08053000
IOPITYP3 EQU   @NM00063+5                                               08054000
IOPIPTF3 EQU   @NM00063                                                 08055000
@NM00007 EQU   RECFLG5                                                  08056000
RECICTOK EQU   RECFLG5                                                  08057000
@NM00006 EQU   RECFLG4                                                  08058000
@NM00005 EQU   RECFLG4                                                  08059000
RECBPIRQ EQU   RECFLG4                                                  08060000
RECBPREQ EQU   RECFLG4                                                  08061000
RECBPPRE EQU   RECFLG4                                                  08062000
RECBPID  EQU   RECFLG4                                                  08063000
@NM00004 EQU   RECFLG3+1                                                08064000
RECSTS   EQU   RECFLG3                                                  08065000
RECMTS   EQU   RECFLG3                                                  08066000
RECPTS   EQU   RECFLG3                                                  08067000
RECACRQ  EQU   RECFLG3                                                  08068000
RECCRQ   EQU   RECFLG3                                                  08069000
RECSCDS  EQU   RECFLG3                                                  08070000
RECACDS  EQU   RECFLG3                                                  08071000
RECCDS   EQU   RECFLG3                                                  08072000
RECMASS  EQU   RECFLG2                                                  08073000
@NM00003 EQU   RECFLG2                                                  08074000
RECFMID  EQU   RECFLG2                                                  08075000
RECGROUP EQU   RECFLG2                                                  08076000
@NM00002 EQU   RECFLG1+1                                                08077000
RECDISW  EQU   RECFLG1+1                                                08078000
RECDISR  EQU   RECFLG1+1                                                08079000
RECDISN  EQU   RECFLG1+1                                                08080000
RECNOJCL EQU   RECFLG1                                                  08081000
RECFLUSH EQU   RECFLG1                                                  08082000
RECUSER  EQU   RECFLG1                                                  08083000
RECAPAR  EQU   RECFLG1                                                  08084000
RECCOMP  EQU   RECFLG1                                                  08085000
RECASSEM EQU   RECFLG1                                                  08086000
RECCHECK EQU   RECFLG1                                                  08087000
RECNOAPP EQU   RECFLG1                                                  08088000
@NM00001 EQU   RECPARM+5                                                08089000
RECNUCID EQU   RECPARM+4                                                08090000
RECJCLGT EQU   RECPARM                                                  08091000
RVAEND   EQU   RVASTAE+25                                               08092000
@NM00213 EQU   RVAFLAGS                                                 08093000
RVASDWFD EQU   RVAFLAGS                                                 08094000
RVAVS1   EQU   RVAFLAGS                                                 08095000
RVAMVS   EQU   RVAFLAGS                                                 08096000
RVAUSRCH EQU   @NM00212+2                                               08097000
RVASYSCH EQU   @NM00212                                                 08098000
RVAUSRCD EQU   @NM00211+2                                               08099000
RVASYSCD EQU   @NM00211                                                 08100000
RVAABNDC EQU   RVASTAE+12                                               08101000
RVAEPRNM EQU   RVASTAE+4                                                08102000
RVASDWAP EQU   RVASTAE                                                  08103000
RVATBL   EQU   RVAPASS                                                  08104000
RVAMAJNM EQU   RVAINFO+8                                                08105000
RVACCAP  EQU   RVAINFO+4                                                08106000
RVAHDR   EQU   RVAINFO                                                  08107000
UX001RCD EQU   UX001PRM+1                                               08108000
UX001RC  EQU   UX001PRM                                                 08109000
SPLIFIL  EQU   SPLODSN+33                                               08110000
SPLISMD  EQU   SPLODSN+26                                               08111000
SPLIPFX  EQU   SPLODSN                                                  08112000
SPLIUNPK EQU   SPLPUNPK+8                                               08113000
SPLOUNPK EQU   SPLPUNPK                                                 08114000
SPLOPACK EQU   SPLPPACK+8                                               08115000
SPLIPACK EQU   SPLPPACK                                                 08116000
@NM00207 EQU   SCPEOR                                                   08117000
SCPNORT  EQU   SCPEOR                                                   08118000
SCPNOSUC EQU   SCPEOR                                                   08119000
SCPRTERR EQU   SCPEOR                                                   08120000
SCPNOCT  EQU   SCPEOR                                                   08121000
SCPWKAR  EQU   HMASMSCP+8                                               08122000
@NM00206 EQU   GRFFLGS                                                  08123000
GRFLOADD EQU   GRFFLGS                                                  08124000
GRFFLUSH EQU   GRFFLGS                                                  08125000
@NM00205 EQU   GSMSTAT2                                                 08126000
GSMRLFL  EQU   GSMSTAT2                                                 08127000
GSMRECVD EQU   GSMSTAT2                                                 08128000
@NM00204 EQU   GSMSTAT1+1                                               08129000
GSMCERR  EQU   GSMSTAT1+1                                               08130000
GSMRERR  EQU   GSMSTAT1+1                                               08131000
GSMLERR  EQU   GSMSTAT1                                                 08132000
PRLCONC  EQU   PRLTIME+2                                                08133000
@NM00198 EQU   PRLTIME                                                  08134000
PRLHDADR EQU   PRLDATE                                                  08135000
@NM00197 EQU   PRLFLGS                                                  08136000
PRLHEADO EQU   PRLFLGS                                                  08137000
PRLHEAD  EQU   PRLFLGS                                                  08138000
PRLRLEN  EQU   HMASMPRL                                                 08139000
@NM00193 EQU   MCBEFLG5                                                 08140000
MCBESTD  EQU   MCBEFLG5                                                 08141000
@NM00192 EQU   MCBEFLG4                                                 08142000
@NM00191 EQU   MCBEFLG3                                                 08143000
@NM00190 EQU   MCBEFLG2                                                 08144000
MCBEPAGA EQU   MCBEFLG2                                                 08145000
MCBENE   EQU   MCBEFLG2                                                 08146000
@NM00189 EQU   MCBEFLG1                                                 08147000
MCBEDC   EQU   MCBEFLG1                                                 08148000
MCBEREFR EQU   MCBEFLG1                                                 08149000
MCBEOVLY EQU   MCBEFLG1                                                 08150000
MCBESCTR EQU   MCBEFLG1                                                 08151000
MCBEREUS EQU   MCBEFLG1                                                 08152000
MCBERENT EQU   MCBEFLG1                                                 08153000
MCBEAPF  EQU   MCBEFLG1                                                 08154000
MCBERMID EQU   MCBELEMP+129                                             08155000
MCBELLKD EQU   MCBELEMP+128                                             08156000
MCBEJLKD EQU   MCBELEMP+116                                             08157000
MCBELUPI EQU   MCBELEMP+115                                             08158000
MCBEJUPI EQU   MCBELEMP+103                                             08159000
MCBELCPY EQU   MCBELEMP+102                                             08160000
MCBEJCPY EQU   MCBELEMP+90                                              08161000
MCBELASM EQU   MCBELEMP+89                                              08162000
MCBEJASM EQU   MCBELEMP+77                                              08163000
MCBESSI  EQU   MCBELEMP+65                                              08164000
MCBEASLB EQU   MCBELEMP+49                                              08165000
MCBESYS  EQU   MCBELEMP+25                                              08166000
MCBEDOBJ EQU   MCBELEMP+17                                              08167000
MCBEDIST EQU   MCBELEMP+9                                               08168000
@NM00188 EQU   MCBELEMP                                                 08169000
@NM00186 EQU   MCBIFMP                                                  08170000
@NM00184 EQU   MCBVERMP                                                 08171000
IOPBS04E EQU   IOPBS04+2                                                08172000
IOPBAPFC EQU   IOPBAPF+1                                                08173000
IOPBAPFL EQU   IOPBAPF                                                  08174000
IOPBS2NM EQU   IOPBS02+3                                                08175000
IOPBS2EP EQU   IOPBS02                                                  08176000
IOPQSMTP EQU   IOPQSMLS+8                                               08177000
@NM00169 EQU   IOPQSMLS+7                                               08178000
IOPQSMND EQU   IOPQSMNM                                                 08179000
@NM00168 EQU   @NM00167+7                                               08180000
IOPQSMFM EQU   @NM00167                                                 08181000
@NM00087 EQU   IOPLMCTL+17                                              08182000
IOPLMCRD EQU   IOPLMCTL+9                                               08183000
IOPLMCRN EQU   IOPLMCTL+1                                               08184000
IOPLMCC  EQU   IOPLMCTL                                                 08185000
@NM00062 EQU   IOPUSERL                                                 08186000
@NM00061 EQU   IOPUSERL                                                 08187000
IOPALIS  EQU   IOPUSERL                                                 08188000
IOPTTR   EQU   IOPDRMAP+8                                               08189000
IOPINAM2 EQU   IOPINAM+1                                                08190000
IOPITYP2 EQU   IOPITYP                                                  08191000
@NM00060 EQU   HMASMIOP+32                                              08192000
IOPDELDD EQU   IOPDDNAM                                                 08193000
@NM00059 EQU   @NM00056+10                                              08194000
@NM00058 EQU   @NM00057+7                                               08195000
IOPPTFNM EQU   @NM00057                                                 08196000
@NM00055 EQU   HMASMGTP+27                                              08197000
GTPPSIZE EQU   GTPFLGS1                                                 08198000
@NM00054 EQU   GTPFLGS1                                                 08199000
GTPRCDNF EQU   GTPFLGS1                                                 08200000
GTPNOSPM EQU   GTPFLGS1                                                 08201000
GTPPOS   EQU   GTPRESTR+8                                               08202000
GTPRCD   EQU   GTPRESTR+4                                               08203000
GTPPAG   EQU   GTPRESTR                                                 08204000
@NM00053 EQU   HMASMGTP+2                                               08205000
CCABMREC EQU   CCABELMT+10                                              08206000
CCABPOS  EQU   CCABMPOS+8                                               08207000
CCABNAME EQU   CCABMPOS                                                 08208000
@NM00049 EQU   CCABLDLM+2                                               08209000
@NM00048 EQU   CCABLDLM                                                 08210000
CCAUPDPM EQU   @NM00046+24                                              08211000
@NM00047 EQU   @NM00046+21                                              08212000
CCARUPDT EQU   CCAUPDRC                                                 08213000
CCAUPDSP EQU   @NM00046+12                                              08214000
CCAUPDTE EQU   @NM00046+8                                               08215000
CCAUPDNM EQU   @NM00046                                                 08216000
CCASUPPM EQU   @NM00044+24                                              08217000
@NM00045 EQU   @NM00044+21                                              08218000
CCARSUP  EQU   CCASUPRC                                                 08219000
CCASUPSP EQU   @NM00044+12                                              08220000
CCAIOSUP EQU   @NM00044+8                                               08221000
CCASUPNM EQU   @NM00044                                                 08222000
CCAZAPPM EQU   @NM00042+24                                              08223000
@NM00043 EQU   @NM00042+21                                              08224000
CCARZAP  EQU   CCAZAPRC                                                 08225000
CCAZAPSP EQU   @NM00042+12                                              08226000
CCASPZAP EQU   @NM00042+8                                               08227000
CCAZAPNM EQU   @NM00042                                                 08228000
CCACOMPM EQU   @NM00040+24                                              08229000
@NM00041 EQU   @NM00040+21                                              08230000
CCARCOMP EQU   CCACOMRC                                                 08231000
CCACOMSP EQU   @NM00040+12                                              08232000
CCACOMRS EQU   @NM00040+8                                               08233000
CCACOMNM EQU   @NM00040                                                 08234000
CCACPYPM EQU   @NM00038+24                                              08235000
@NM00039 EQU   @NM00038+21                                              08236000
CCARCOPY EQU   CCACPYRC                                                 08237000
CCACPYSP EQU   @NM00038+12                                              08238000
CCACOPY  EQU   @NM00038+8                                               08239000
CCACPYNM EQU   @NM00038                                                 08240000
CCAASMPM EQU   @NM00036+24                                              08241000
@NM00037 EQU   @NM00036+21                                              08242000
CCARASM  EQU   CCAASMRC                                                 08243000
CCAASMSP EQU   @NM00036+12                                              08244000
CCAASM   EQU   @NM00036+8                                               08245000
CCAASMNM EQU   @NM00036                                                 08246000
CCALKDPM EQU   @NM00034+24                                              08247000
@NM00035 EQU   @NM00034+21                                              08248000
CCARLINK EQU   CCALKDRC                                                 08249000
CCALKDSP EQU   @NM00034+12                                              08250000
CCALKED  EQU   @NM00034+8                                               08251000
CCALKDNM EQU   @NM00034                                                 08252000
CCAPGMPM EQU   @NM00032+24                                              08253000
@NM00033 EQU   @NM00032+21                                              08254000
CCABPGRC EQU   @NM00032+20                                              08255000
CCABPGSP EQU   @NM00032+12                                              08256000
CCABPGAD EQU   @NM00032+8                                               08257000
CCABPGNM EQU   @NM00032                                                 08258000
CCAEND   EQU   HMASMCCA+371                                             08259000
@NM00031 EQU   HMASMCCA+309                                             08260000
CCACURDD EQU   CCAFDSNG+3                                               08261000
CCACURDS EQU   CCAFDSNG+2                                               08262000
@NM00030 EQU   CCAFLAGB                                                 08263000
CCAOUTNG EQU   CCAFLAGB                                                 08264000
CCALOGNG EQU   CCAFLAGB                                                 08265000
CCALSTDS EQU   CCAFCTL+8                                                08266000
CCARPTDS EQU   CCAFCTL+7                                                08267000
CCATIME  EQU   CCAFCTL+4                                                08268000
CCADATE  EQU   CCAFCTL+1                                                08269000
@NM00029 EQU   CCAFLAG9                                                 08270000
CCARVCAN EQU   CCAFLAG9                                                 08271000
CCARVEST EQU   CCAFLAG9                                                 08272000
CCAPTSNJ EQU   CCAFLAG9                                                 08273000
CCASTSNP EQU   CCAFLAG9                                                 08274000
CCAMTSNP EQU   CCAFLAG9                                                 08275000
CCAPTSNP EQU   CCAFLAG9                                                 08276000
@NM00028 EQU   CCAFLAG8                                                 08277000
CCAACDSC EQU   CCAFLAG8                                                 08278000
CCACDSC  EQU   CCAFLAG8                                                 08279000
@NM00027 EQU   CCAFLAG6                                                 08280000
CCAACRUP EQU   CCAFLAG6                                                 08281000
CCACRQUP EQU   CCAFLAG6                                                 08282000
CCAACDUP EQU   CCAFLAG6                                                 08283000
CCACDSUP EQU   CCAFLAG6                                                 08284000
@NM00026 EQU   CCAFLAG5                                                 08285000
CCAACROS EQU   CCAFLAG5                                                 08286000
CCACRQOS EQU   CCAFLAG5                                                 08287000
CCAACDOS EQU   CCAFLAG5                                                 08288000
CCACDSOS EQU   CCAFLAG5                                                 08289000
@NM00025 EQU   CCAFLAG4                                                 08290000
CCAACRIS EQU   CCAFLAG4                                                 08291000
CCACRQIS EQU   CCAFLAG4                                                 08292000
CCAACDIS EQU   CCAFLAG4                                                 08293000
CCACDSIS EQU   CCAFLAG4                                                 08294000
@NM00024 EQU   CCAFLAG3+1                                               08295000
CCARGNP  EQU   CCAFLAG3+1                                               08296000
CCADISRQ EQU   CCAFLAG3+1                                               08297000
CCAICTOK EQU   CCAFLAG3                                                 08298000
CCADELP  EQU   CCAFLAG3                                                 08299000
CCACMPRS EQU   CCAFLAG3                                                 08300000
CCAZAPP  EQU   CCAFLAG3                                                 08301000
CCALINKP EQU   CCAFLAG3                                                 08302000
CCACOPYP EQU   CCAFLAG3                                                 08303000
CCAASIP  EQU   CCAFLAG3                                                 08304000
CCAUPDP  EQU   CCAFLAG3                                                 08305000
CCAEOSMP EQU   CCAFLAG2                                                 08306000
CCAEOFNC EQU   CCAFLAG2                                                 08307000
@NM00023 EQU   CCAFLAG2                                                 08308000
CCACHECK EQU   CCAFLAG2                                                 08309000
CCATERM  EQU   CCAFLAG2                                                 08310000
CCASVCLB EQU   CCAFLAG2                                                 08311000
CCANCPTF EQU   CCAFLAG2                                                 08312000
@NM00022 EQU   CCAFLAG1+1                                               08313000
CCAUNL   EQU   CCAFLAG1+1                                               08314000
CCARESET EQU   CCAFLAG1+1                                               08315000
CCALOG   EQU   CCAFLAG1+1                                               08316000
CCACNV   EQU   CCAFLAG1+1                                               08317000
CCALIST  EQU   CCAFLAG1                                                 08318000
CCAUPDU  EQU   CCAFLAG1                                                 08319000
CCAUPDJ  EQU   CCAFLAG1                                                 08320000
CCARES   EQU   CCAFLAG1                                                 08321000
CCAREJ   EQU   CCAFLAG1                                                 08322000
CCAACCPT EQU   CCAFLAG1                                                 08323000
CCAAPPLY EQU   CCAFLAG1                                                 08324000
CCAREC   EQU   CCAFLAG1                                                 08325000
CCAFUNCT EQU   CCAFFUNC                                                 08326000
@NM00021 EQU   @NM00016+18                                              08327000
@NM00020 EQU   @NM00016+16                                              08328000
CCATBLPA EQU   @NM00016+12                                              08329000
@NM00019 EQU   @NM00016+8                                               08330000
@NM00018 EQU   @NM00016+4                                               08331000
@NM00017 EQU   @NM00016                                                 08332000
CCAIFGTP EQU   CCAFGTP+16                                               08333000
CCAGTP3  EQU   CCAFGTP+12                                               08334000
CCAGTP2  EQU   CCAFGTP+8                                                08335000
CCAGTP1  EQU   CCAFGTP+4                                                08336000
CCACLST  EQU   CCAFPGM+12                                               08337000
CCASPDCB EQU   CCAFPGM+8                                                08338000
CCAICLMD EQU   CCAFICT+12                                               08339000
CCAICMOD EQU   CCAFICT+8                                                08340000
CCAICPTF EQU   CCAFICT+4                                                08341000
CCAICT   EQU   CCAFICT                                                  08342000
CCAACDID EQU   CCAFSYS+32                                               08343000
CCACDSID EQU   CCAFSYS+24                                               08344000
CCALNLEN EQU   CCAFSYS+22                                               08345000
@NM00015 EQU   CCAFLAGA                                                 08346000
CCAPSYSF EQU   CCAFLAGA                                                 08347000
CCAASYSF EQU   CCAFLAGA                                                 08348000
CCACSYSF EQU   CCAFLAGA                                                 08349000
CCANUCID EQU   CCAFSYS+20                                               08350000
CCAASREL EQU   CCAFSYS+16                                               08351000
CCACSREL EQU   CCASREL                                                  08352000
CCAPEMAX EQU   CCAFSYS+10                                               08353000
CCAPGLEN EQU   CCAFSYS+8                                                08354000
CCAIOPAS EQU   CCAFSYS+4                                                08355000
CCAIOPCS EQU   CCAFSYS                                                  08356000
CCAPESIZ EQU   CCAFIOP+4                                                08357000
@NM00014 EQU   CCAFLAG7+3                                               08358000
CCALOGP  EQU   CCAFLAG7+2                                               08359000
CCAOUTP  EQU   CCAFLAG7+2                                               08360000
CCASLBP  EQU   CCAFLAG7+2                                               08361000
CCARPTP  EQU   CCAFLAG7+2                                               08362000
CCALISTP EQU   CCAFLAG7+2                                               08363000
CCAJCLP  EQU   CCAFLAG7+2                                               08364000
CCAPTFP  EQU   CCAFLAG7+2                                               08365000
CCATLBP  EQU   CCAFLAG7+2                                               08366000
CCAUT3P  EQU   CCAFLAG7+1                                               08367000
CCAUT2P  EQU   CCAFLAG7+1                                               08368000
CCAUT1P  EQU   CCAFLAG7+1                                               08369000
CCAWK5P  EQU   CCAFLAG7+1                                               08370000
CCAWK4P  EQU   CCAFLAG7+1                                               08371000
CCAWK3P  EQU   CCAFLAG7+1                                               08372000
CCAWK2P  EQU   CCAFLAG7+1                                               08373000
CCAWK1P  EQU   CCAFLAG7+1                                               08374000
CCAACRQP EQU   CCAFLAG7                                                 08375000
CCACRQP  EQU   CCAFLAG7                                                 08376000
CCASTSP  EQU   CCAFLAG7                                                 08377000
CCAMTSP  EQU   CCAFLAG7                                                 08378000
CCAPTSP  EQU   CCAFLAG7                                                 08379000
CCASCDSP EQU   CCAFLAG7                                                 08380000
CCAACDSP EQU   CCAFLAG7                                                 08381000
CCACDSP  EQU   CCAFLAG7                                                 08382000
@NM00013 EQU   CCAFBUFR+122                                             08383000
@NM00012 EQU   CCAFBUFR+120                                             08384000
@NM00011 EQU   CCAFBUFR+118                                             08385000
CCATBFMX EQU   CCAFBUFR+116                                             08386000
CCA4BFMX EQU   CCAFBUFR+114                                             08387000
CCA3BFMX EQU   CCAFBUFR+112                                             08388000
CCA2BFMX EQU   CCAFBUFR+110                                             08389000
CCA1BFMX EQU   CCAFBUFR+108                                             08390000
CCAXBFMX EQU   CCAFBUFR+106                                             08391000
CCAQBFMX EQU   CCAFBUFR+104                                             08392000
CCASBFMX EQU   CCAFBUFR+102                                             08393000
CCAMBFMX EQU   CCAFBUFR+100                                             08394000
CCAPBFMX EQU   CCAFBUFR+98                                              08395000
CCAVBFMX EQU   CCAFBUFR+96                                              08396000
CCAABFMX EQU   CCAFBUFR+94                                              08397000
CCACBFMX EQU   CCAFBUFR+92                                              08398000
@NM00010 EQU   CCAFBUFR+88                                              08399000
@NM00009 EQU   CCAFBUFR+84                                              08400000
CCA4BFSZ EQU   CCAFBUFR+80                                              08401000
CCATBFSZ EQU   CCAFBUFR+76                                              08402000
CCAWBFSZ EQU   CCAFBUFR+72                                              08403000
CCAQBFSZ EQU   CCAFBUFR+68                                              08404000
CCAPBFSZ EQU   CCAFBUFR+64                                              08405000
CCAVBFSZ EQU   CCAFBUFR+60                                              08406000
CCACBFSZ EQU   CCAFBUFR+56                                              08407000
@NM00008 EQU   CCAFBUFR+52                                              08408000
CCA4BFOA EQU   CCAFBUFR+48                                              08409000
CCA4BFIA EQU   CCAFBUFR+44                                              08410000
CCATBFIA EQU   CCAFBUFR+40                                              08411000
CCAWBFOA EQU   CCAFBUFR+36                                              08412000
CCAWBFIA EQU   CCAFBUFR+32                                              08413000
CCAQBFOA EQU   CCAFBUFR+28                                              08414000
CCAQBFIA EQU   CCAFBUFR+24                                              08415000
CCAPBFOA EQU   CCAFBUFR+20                                              08416000
CCAPBFIA EQU   CCAFBUFR+16                                              08417000
CCAVBFOA EQU   CCAFBUFR+12                                              08418000
CCAVBFIA EQU   CCAFBUFR+8                                               08419000
CCACBFOA EQU   CCAFBUFR+4                                               08420000
CCACBFIA EQU   CCAFBUFR                                                 08421000
CCAID    EQU   HMASMCCA                                                 08422000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      08423000
@RF00736 EQU   @EL00004                                                 08424000
@RC00751 EQU   @EL00004                                                 08425000
@RC00760 EQU   @EL00004                                                 08426000
@RC00758 EQU   @EL00004                                                 08427000
@RC00756 EQU   @EL00004                                                 08428000
@RC00754 EQU   @EL00004                                                 08429000
@RF00800 EQU   @RC00792                                                 08430000
@RF00824 EQU   @EL00005                                                 08431000
@RC00829 EQU   @EL00006                                                 08432000
@RF00844 EQU   @EL00006                                                 08433000
@RC00971 EQU   @EL00009                                                 08434000
@RF01011 EQU   @EL00010                                                 08435000
@RF01020 EQU   @EL00011                                                 08436000
@RF01036 EQU   @EL00011                                                 08437000
@RC01048 EQU   @EL00012                                                 08438000
@RF01065 EQU   @EL00012                                                 08439000
@PB00015 EQU   @EL00012                                                 08440000
@RF01161 EQU   @EL00016                                                 08441000
@RC01159 EQU   @EL00016                                                 08442000
@RC01157 EQU   @EL00016                                                 08443000
@RC01155 EQU   @EL00016                                                 08444000
@RC01170 EQU   @EL00017                                                 08445000
@RC01176 EQU   @EL00017                                                 08446000
@RF01199 EQU   @EL00018                                                 08447000
@RF01202 EQU   @EL00018                                                 08448000
@RC01213 EQU   @EL00019                                                 08449000
@RF01278 EQU   @EL00019                                                 08450000
@RF01302 EQU   @EL00020                                                 08451000
@RF01321 EQU   @EL00023                                                 08452000
@PB00024 EQU   @EL00020                                                 08453000
@RC01345 EQU   @EL00025                                                 08454000
@RF01354 EQU   @EL00025                                                 08455000
@RF01370 EQU   @EL00025                                                 08456000
@RF01392 EQU   @EL00026                                                 08457000
@RC01403 EQU   @EL00026                                                 08458000
@RF01423 EQU   @EL00026                                                 08459000
@RF01437 EQU   @EL00027                                                 08460000
@RF01604 EQU   @EL00029                                                 08461000
@RF01640 EQU   @EL00030                                                 08462000
@PB00031 EQU   @EL00028                                                 08463000
@RF01715 EQU   @EL00032                                                 08464000
@RF00975 EQU   @RC00971                                                 08465000
@PB00014 EQU   @PB00015                                                 08466000
@PB00023 EQU   @PB00024                                                 08467000
@RC01405 EQU   @RC01403                                                 08468000
@RF01413 EQU   @RC01403                                                 08469000
@PB00030 EQU   @PB00031                                                 08470000
@PB00013 EQU   @PB00014                                                 08471000
@PB00022 EQU   @PB00023                                                 08472000
@PB00029 EQU   @PB00030                                                 08473000
@PB00021 EQU   @PB00022                                                 08474000
@RC01590 EQU   @PB00029                                                 08475000
@ENDDATA EQU   *                                                        08476000
         END   HMASMREC,(C'PLS2111',0802,78334)                         08477000
