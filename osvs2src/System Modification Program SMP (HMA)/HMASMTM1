         TITLE 'HMASMTM1-ICT MOD SECTION BUILD (INIT ENTRY FOR ++MOD/++*00001000
               ZAP)'                                                    00002000
HMASMTM1 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'HMASMTM1  78.334'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  LA    @10,4095(,@12)                                      0001 00012000
         LA    @09,4095(,@10)                                      0001 00013000
         USING @PSTART,@12                                         0001 00014000
         USING @PSTART+4095,@10                                    0001 00015000
         USING @PSTART+8190,@09                                    0001 00016000
         ST    @13,@SA00001+4                                      0001 00017000
         LA    @14,@SA00001                                        0001 00018000
         ST    @14,8(,@13)                                         0001 00019000
         LR    @13,@14                                             0001 00020000
         MVC   @PC00001(16),0(@01)                                 0001 00021000
*   IOPPTR=CCAIOPTR;                /* SET UP BASE IOP ADDRESS       */ 00022000
         L     IOPPTR,CCAIOPTR(,CCAPTR)                            0208 00023000
*   TM1HIRC=ZERO;                   /* INITIALIZE HIGHEST RC       0209 00024000
*                                      COLLECTOR                     */ 00025000
         SLR   TM1HIRC,TM1HIRC                                     0209 00026000
*   TM1SWCH1=OFF;                   /* INITIALIZE LOCAL SWITCHES     */ 00027000
         MVI   TM1SWCH1,B'00000000'                                0210 00028000
*   TM1SWCH2=OFF;                   /* INITIALIZE LOCAL SWITCHES     */ 00029000
         MVI   TM1SWCH2,B'00000000'                                0211 00030000
*   ICTMDSTL(1)=BLANKS;             /* INITIALIZE FIELD TO BLANKS    */ 00031000
*                                                                  0212 00032000
         L     @08,@PC00001+4                                      0212 00033000
         L     @08,ICMODPTR(,@08)                                  0212 00034000
         MVC   ICTMDSTL(8,@08),BLANKS                              0212 00035000
*   /*****************************************************************/ 00036000
*   /*                                                               */ 00037000
*   /* FILL IN ICT MOD VALUES FROM PTF ENTRY PASSED AND OTHER FIELDS */ 00038000
*   /*                                                               */ 00039000
*   /*****************************************************************/ 00040000
*                                                                  0213 00041000
*   ICTMMOD(1)=ON;                  /* MODULE REPLACEMENT "FOR NOW"--   00042000
*                                      MIGHT BE SET TO ZAP IN PROC2. */ 00043000
         OI    ICTMMOD(@08),B'10000000'                            0213 00044000
*   ICTPPTR(1)=ICPTFPTR;            /* PTR TO ICT PTF ENTRY          */ 00045000
         L     @15,@PC00001+8                                      0214 00046000
         MVC   ICTPPTR(4,@08),ICPTFPTR(@15)                        0214 00047000
*   ICTMCHN(1)=TBLXNULL;            /* INIT LMOD CHAIN PTR           */ 00048000
*                                                                  0215 00049000
         L     @15,@PC00001                                        0215 00050000
         MVC   ICTMCHN(4,@08),TBLXNULL(@15)                        0215 00051000
*   /*****************************************************************/ 00052000
*   /*                                                               */ 00053000
*   /* ATTEMPT TO LOCATE THE ELEMENT ENTRY FOR THE CURRENT ELEMENT ON*/ 00054000
*   /* THE (A)CDS DATASET, DEPENDING ON THE FUNCTION BEING RUN SO    */ 00055000
*   /* THAT THE DISTLIB ENTRY FOR THIS ELEMENT CAN BE RETRIEVED      */ 00056000
*   /*                                                               */ 00057000
*   /*****************************************************************/ 00058000
*                                                                  0216 00059000
*   CALL TM1PROC1;                  /* CALL PROC TO DO LOCATE        */ 00060000
         BAL   @14,TM1PROC1                                        0216 00061000
*   TM1HIRC=MAX(TM1HIRC,IOPRETRN);  /* PICK UP HIGHEST RETURN CODE   */ 00062000
         SLR   @08,@08                                             0217 00063000
         IC    @08,IOPRETRN(,IOPPTR)                               0217 00064000
         CR    TM1HIRC,@08                                         0217 00065000
         BNL   *+6                                                      00066000
         LR    TM1HIRC,@08                                         0217 00067000
*   IF TM1HIRC=IOPGOOD              /* WAS THE RETURN FROM HMASMIO IN   00068000
*                                      TM1PROC1 =0 OR NOT          0218 00069000
*                                      FOUND(RESET) TO 0?            */ 00070000
*       &ELMCBPTR^=ZERO THEN        /* WAS AN ELEMENT MCB PTR PASSED?*/ 00071000
*                                                                  0218 00072000
         SLR   @08,@08                                             0218 00073000
         CR    TM1HIRC,@08                                         0218 00074000
         BNE   @RF00218                                            0218 00075000
         L     @15,@PC00001+12                                     0218 00076000
         C     @08,ELMCBPTR(,@15)                                  0218 00077000
         BE    @RF00218                                            0218 00078000
*     /***************************************************************/ 00079000
*     /*                                                             */ 00080000
*     /* INITIALIZE THE ICT MODULE MAPPING FROM THE MCB PASSED FROM  */ 00081000
*     /* THE CALLING MODULE                                          */ 00082000
*     /*                                                             */ 00083000
*     /***************************************************************/ 00084000
*                                                                  0219 00085000
*     CALL TM1PROC2;                /* CALL PROCEDURE TO FILL IN ICT    00086000
*                                      MOD ENTRY FIELDS FROM MCB     */ 00087000
         BAL   @14,TM1PROC2                                        0219 00088000
*   IF TM1HIRC=IOPGOOD              /* PREVIOUS PROCEDURE SUCCESSFUL?*/ 00089000
*       &LMODADD=ON THEN            /* LMOD SUBENTRY ADDED TO IOP?   */ 00090000
*                                                                  0220 00091000
@RF00218 CH    TM1HIRC,@CH00088                                    0220 00092000
         BNE   @RF00220                                            0220 00093000
         TM    LMODADD,B'10000000'                                 0220 00094000
         BNO   @RF00220                                            0220 00095000
*     /***************************************************************/ 00096000
*     /*                                                             */ 00097000
*     /* DETERMINE IF A LMOD SUBENTRY WAS ADDED TO THE IOP FROM THE  */ 00098000
*     /* MCB SUBENTRIES, AND IF SO A NEED EXISTS TO STOW REPLACE THE */ 00099000
*     /* UPDATED MOD ENTRY.                                          */ 00100000
*     /*                                                             */ 00101000
*     /***************************************************************/ 00102000
*                                                                  0221 00103000
*     DO;                           /*                               */ 00104000
*       IOPFUNCT=IOPSTOWR;          /* INDICATE STOW REPLACE FUNCTION*/ 00105000
         MVI   IOPFUNCT(IOPPTR),X'54'                              0222 00106000
*       CALL HMASMIO(HMASMIOP);     /* CALL SMP IO INTERFACE MOD     */ 00107000
         ST    IOPPTR,@AL00001                                     0223 00108000
         L     @15,@CV01853                                        0223 00109000
         LA    @01,@AL00001                                        0223 00110000
         BALR  @14,@15                                             0223 00111000
*       TM1HIRC=MAX(TM1HIRC,IOPRETRN);/* PICK UP HIGHEST RC          */ 00112000
         SLR   @08,@08                                             0224 00113000
         IC    @08,IOPRETRN(,IOPPTR)                               0224 00114000
         CR    TM1HIRC,@08                                         0224 00115000
         BNL   *+6                                                      00116000
         LR    TM1HIRC,@08                                         0224 00117000
*     END;                          /*                               */ 00118000
*   IF TM1HIRC=IOPGOOD THEN         /* PREVIOUS PROCEDURE SUCCESSFUL?*/ 00119000
*                                                                  0226 00120000
@RF00220 CH    TM1HIRC,@CH00088                                    0226 00121000
         BNE   @RF00226                                            0226 00122000
*     /***************************************************************/ 00123000
*     /*                                                             */ 00124000
*     /* DETERMINE IF THE DISTLIB VALUE HAS BEEN FOUND FOR THE       */ 00125000
*     /* CURRENT ELEMENT. THIS IS REQUIRED FOR ALL FUNCTION          */ 00126000
*     /* PROCESSING. IF ONE IS NOT DETERMINED THEN ISSUE MSG HMA431I */ 00127000
*     /* AND SET RC=STOPPTF.                                         */ 00128000
*     /*                                                             */ 00129000
*     /***************************************************************/ 00130000
*                                                                  0227 00131000
*     CALL TM1PROC3;                /* CALL PROCEDURE TO CHECK IF A     00132000
*                                      DLIB VALUE HAS BEEN FOUND     */ 00133000
         BAL   @14,TM1PROC3                                        0227 00134000
*   TM1HIRC=MAX(TM1HIRC,IOPRETRN);  /* PICK UP HIGHEST RC            */ 00135000
@RF00226 SLR   @08,@08                                             0228 00136000
         IC    @08,IOPRETRN(,IOPPTR)                               0228 00137000
         CR    TM1HIRC,@08                                         0228 00138000
         BNL   *+6                                                      00139000
         LR    TM1HIRC,@08                                         0228 00140000
*   IF TM1HIRC=IOPGOOD THEN         /* PREVIOUS PROCEDURE SUCCESSFUL?*/ 00141000
*                                                                  0229 00142000
         CH    TM1HIRC,@CH00088                                    0229 00143000
         BNE   @RF00229                                            0229 00144000
*     /***************************************************************/ 00145000
*     /*                                                             */ 00146000
*     /* COMPARE THE DISTLIB OPERAND ON THE CDS MOD ENTRY AGAINST THE*/ 00147000
*     /* VALUE IN THE MCB FOR APPLY. IF DIFFERENT VALUES THEN SET THE*/ 00148000
*     /* DISTLIB CONFLICT BIT (ICTMDSTE) ON.                         */ 00149000
*     /*                                                             */ 00150000
*     /***************************************************************/ 00151000
*                                                                  0230 00152000
*     CALL TM1PROC4;                /* CALL PROCEDURE TO CHECK IF A     00153000
*                                      DLIB CONFLICT EXISTS          */ 00154000
         BAL   @14,TM1PROC4                                        0230 00155000
*   TM1HIRC=MAX(TM1HIRC,IOPRETRN);  /* PICK UP HIGHEST RC            */ 00156000
@RF00229 SLR   @08,@08                                             0231 00157000
         IC    @08,IOPRETRN(,IOPPTR)                               0231 00158000
         CR    TM1HIRC,@08                                         0231 00159000
         BNL   *+6                                                      00160000
         LR    TM1HIRC,@08                                         0231 00161000
*   IF TM1HIRC=IOPGOOD THEN         /* PREVIOUS PROCEDURE SUCCESSFUL?*/ 00162000
*                                                                  0232 00163000
         CH    TM1HIRC,@CH00088                                    0232 00164000
         BNE   @RF00232                                            0232 00165000
*     /***************************************************************/ 00166000
*     /*                                                             */ 00167000
*     /* DETERMINE IF THE DLIB VALUE IN THE ACDS MOD ENTRY IS NOT    */ 00168000
*     /* EQUAL TO THE MCB VALUE FOR ACCEPT PROCESSING. IF DIFFERENT, */ 00169000
*     /* THEN DETERMINE IF THE ACDS DLIB VALUE SHOULD BE UPDATED OR  */ 00170000
*     /* IF THE DISTLIB CONFLICT BIT (ICTMDSTE) SHOULD BE SET ON, IF */ 00171000
*     /* CHECKS (1-4) ARE NOT TRUE.                                  */ 00172000
*     /*                                                             */ 00173000
*     /***************************************************************/ 00174000
*                                                                  0233 00175000
*     CALL TM1PROC5;                /* CALL PROCEDURE TO CHECK IF A     00176000
*                                      DLIB SHOULD BE UPDATED WITH 0233 00177000
*                                      DLIB VALUE FROM THE MCB       */ 00178000
         BAL   @14,TM1PROC5                                        0233 00179000
*   TM1HIRC=MAX(TM1HIRC,IOPRETRN);  /* PICK UP HIGHEST RC            */ 00180000
@RF00232 SLR   @08,@08                                             0234 00181000
         IC    @08,IOPRETRN(,IOPPTR)                               0234 00182000
         CR    TM1HIRC,@08                                         0234 00183000
         BNL   *+6                                                      00184000
         LR    TM1HIRC,@08                                         0234 00185000
*   IF TM1HIRC=IOPGOOD              /* PREVIOUS PROCEDURE SUCCESSFUL?*/ 00186000
*       &CCAAPPLY=ON                /* FUNCTION EQUAL TO APPLY?      */ 00187000
*       &ICTMDSTE(1)=OFF THEN       /* NO DISTLIB CONFLICT?          */ 00188000
*                                                                  0235 00189000
         CH    TM1HIRC,@CH00088                                    0235 00190000
         BNE   @RF00235                                            0235 00191000
         TM    CCAAPPLY(CCAPTR),B'01000000'                        0235 00192000
         BNO   @RF00235                                            0235 00193000
         L     @08,@PC00001+4                                      0235 00194000
         L     @08,ICMODPTR(,@08)                                  0235 00195000
         TM    ICTMDSTE(@08),B'00000100'                           0235 00196000
         BNZ   @RF00235                                            0235 00197000
*     /***************************************************************/ 00198000
*     /*                                                             */ 00199000
*     /* FOR APPLY WITH NO DISTLIB CONFLICT ERROR BIT ON, CHECK TO   */ 00200000
*     /* SEE IF ANY CDS ENTRIES (EITHER MOD OR LMOD) NEED TO BE      */ 00201000
*     /* CREATED OR MODIFIED FOR ELEMENTS THAT ARE IN A DISTLIB TOTAL*/ 00202000
*     /* COPY.                                                       */ 00203000
*     /*                                                             */ 00204000
*     /***************************************************************/ 00205000
*                                                                  0236 00206000
*     CALL TM1PROC6;                /* CALL PROCEDURE TO CHECK IF ANY   00207000
*                                      CDS ENTRIES MUST BE CREATED OR   00208000
*                                      MODIFIED                      */ 00209000
         BAL   @14,TM1PROC6                                        0236 00210000
*   TM1HIRC=MAX(TM1HIRC,IOPRETRN);  /* PICK UP HIGHEST RC            */ 00211000
@RF00235 SLR   @08,@08                                             0237 00212000
         IC    @08,IOPRETRN(,IOPPTR)                               0237 00213000
         CR    TM1HIRC,@08                                         0237 00214000
         BNL   *+6                                                      00215000
         LR    TM1HIRC,@08                                         0237 00216000
*   IF TM1HIRC=IOPGOOD              /* PREVIOUS PROCESSING OK, AND A */ 00217000
*       &BLDACDSM=ON THEN           /* (A)CDS MOD ENTRY MUST BE BUILT*/ 00218000
         CH    TM1HIRC,@CH00088                                    0238 00219000
         BNE   @RF00238                                            0238 00220000
         TM    BLDACDSM,B'00000100'                                0238 00221000
         BNO   @RF00238                                            0238 00222000
*     DO;                           /* BUILD AND ADD A MOD ENTRY     */ 00223000
*                                                                  0239 00224000
*       /*************************************************************/ 00225000
*       /*                                                           */ 00226000
*       /* IF NO (A)CDS MOD ENTRY WAS FOUND, THEN CREATE A (A)CDS MOD*/ 00227000
*       /* ENTRY FOR THIS ELEMENT INDICATING A LMOD SUBENTRY NAME    */ 00228000
*       /* EQUAL TO THE ELEMENT NAME BEING PROCESSED AND DISTLIB FROM*/ 00229000
*       /* MCB.                                                      */ 00230000
*       /*                                                           */ 00231000
*       /*************************************************************/ 00232000
*                                                                  0240 00233000
*       IOPNAME=ICTMNAME(1);        /* MOD ENTRY NAME TO ADD         */ 00234000
         L     @08,@PC00001+4                                      0240 00235000
         L     @08,ICMODPTR(,@08)                                  0240 00236000
         MVC   IOPNAME(8,IOPPTR),ICTMNAME(@08)                     0240 00237000
*       IOPTYPE=IOPMOD;             /* MOD TYPE ENTRY                */ 00238000
         MVI   IOPTYPE(IOPPTR),X'05'                               0241 00239000
*       IOPMODDR=' ';               /* INIT MOD ENTRY DIRECTORY      */ 00240000
         MVI   IOPMODDR+1(IOPPTR),C' '                             0242 00241000
         MVC   IOPMODDR+2(22,IOPPTR),IOPMODDR+1(IOPPTR)            0242 00242000
         MVI   IOPMODDR(IOPPTR),C' '                               0242 00243000
*       IOPNTLVL=IOPMODLC;          /* CURENT LEVEL                  */ 00244000
         MVI   IOPNTLVL(IOPPTR),X'02'                              0243 00245000
*       IOPRMID=' ';                /* BLANK RMID FIELD              */ 00246000
         MVI   IOPRMID+1(IOPPTR),C' '                              0244 00247000
         MVC   IOPRMID+2(5,IOPPTR),IOPRMID+1(IOPPTR)               0244 00248000
         MVI   IOPRMID(IOPPTR),C' '                                0244 00249000
*       IOPRMST=IOPRMST&&IOPRMST;   /* ZERO OUT RMID STATUS FIELD    */ 00250000
         XC    IOPRMST(1,IOPPTR),IOPRMST(IOPPTR)                   0245 00251000
*       IOPFMID=' ';                /* BLANK FMID FIELD              */ 00252000
         MVI   IOPFMID+1(IOPPTR),C' '                              0246 00253000
         MVC   IOPFMID+2(5,IOPPTR),IOPFMID+1(IOPPTR)               0246 00254000
         MVI   IOPFMID(IOPPTR),C' '                                0246 00255000
*       IOPFMST=IOPFMST&&IOPFMST;   /* ZERO OUT FMID STATUS FIELD    */ 00256000
         XC    IOPFMST(1,IOPPTR),IOPFMST(IOPPTR)                   0247 00257000
*       IOPMODFX=' ';               /* INIT MOD ENTRY DATA FIELDS    */ 00258000
         MVI   IOPMODFX+1(IOPPTR),C' '                             0248 00259000
         MVC   IOPMODFX+2(78,IOPPTR),IOPMODFX+1(IOPPTR)            0248 00260000
         MVI   IOPMODFX(IOPPTR),C' '                               0248 00261000
*       IOPBUSMD=ICTPTFS(1);        /* SYSMOD CAUSING ADD OF ENTRY   */ 00262000
         L     @15,@PC00001+8                                      0249 00263000
         L     @01,ICPTFPTR(,@15)                                  0249 00264000
         MVC   IOPBUSMD(7,IOPPTR),ICTPTFS(@01)                     0249 00265000
*       IOPBUTYP=IOPBUADD;          /* INDICATE ADD OPERATION        */ 00266000
         MVI   IOPBUTYP(IOPPTR),X'01'                              0250 00267000
*       IOPMODF1=ICTMLEP1(1);       /* FIRST BYTE OF LEPARMS FROM ICT*/ 00268000
         MVC   IOPMODF1(1,IOPPTR),ICTMLEP1(@08)                    0251 00269000
*       IOPMODF2=ICTMLEP2(1);       /* LAST BYTE OF LEPARMS FROM ICT */ 00270000
         MVC   IOPMODF2(1,IOPPTR),ICTMLEP2(@08)                    0252 00271000
*       IOPMODF3=IOPMODF3&&IOPMODF3;/* ZERO OUT FIELD                */ 00272000
         XC    IOPMODF3(1,IOPPTR),IOPMODF3(IOPPTR)                 0253 00273000
*       IOPMODF4=IOPMODF4&&IOPMODF4;/* ZERO OUT FIELD                */ 00274000
         XC    IOPMODF4(1,IOPPTR),IOPMODF4(IOPPTR)                 0254 00275000
*       IOPDLIB=MCBEDIST;           /* DISTRIBUTION LIB FROM MCB     */ 00276000
         L     @08,@PC00001+12                                     0255 00277000
         L     @08,ELMCBPTR(,@08)                                  0255 00278000
         MVC   IOPDLIB(8,IOPPTR),MCBEDIST(@08)                     0255 00279000
*       IOPMODND(1)=IOPEOLST;       /* SET END OF LIST MARKER        */ 00280000
         MVI   IOPMODND(IOPPTR),X'FF'                              0256 00281000
*       CALL TM1LMOD;               /* TO PROCESS MCB LMOD SUBENTRYS */ 00282000
         BAL   @14,TM1LMOD                                         0257 00283000
*       IOPFUNCT=IOPSTOWR;          /* INDICATE STOW REPLACE FUNCTION*/ 00284000
*                                                                  0258 00285000
         MVI   IOPFUNCT(IOPPTR),X'54'                              0258 00286000
*       /*************************************************************/ 00287000
*       /*                                                           */ 00288000
*       /* ADD NEW MOD ENTRY TO THE CDS FOR THIS ELEMENT             */ 00289000
*       /*                                                           */ 00290000
*       /*************************************************************/ 00291000
*                                                                  0259 00292000
*       CALL HMASMIO(HMASMIOP);     /* CALL SMP IO INTERFACE MODULE  */ 00293000
         ST    IOPPTR,@AL00001                                     0259 00294000
         L     @15,@CV01853                                        0259 00295000
         LA    @01,@AL00001                                        0259 00296000
         BALR  @14,@15                                             0259 00297000
*     END;                          /*                               */ 00298000
*   TM1HIRC=MAX(TM1HIRC,IOPRETRN);  /* PICK UP HIGHEST RC            */ 00299000
*                                                                  0261 00300000
@RF00238 SLR   @08,@08                                             0261 00301000
         IC    @08,IOPRETRN(,IOPPTR)                               0261 00302000
         CR    TM1HIRC,@08                                         0261 00303000
         BNL   *+6                                                      00304000
         LR    TM1HIRC,@08                                         0261 00305000
*   /*****************************************************************/ 00306000
*   /*                                                               */ 00307000
*   /* SET FROMLIB FOR RESTORE PROCESSING                            */ 00308000
*   /*                                                               */ 00309000
*   /*****************************************************************/ 00310000
*                                                                  0262 00311000
*   IF TM1HIRC=IOPGOOD              /* PREVIOUS PROCEDURE SUCCESSFUL?*/ 00312000
*       &CCARES=ON                  /* IS FUNCTION RESTORE AND,      */ 00313000
*       &ICTMDSTE(1)=OFF THEN       /* NO DISTLIB CONFLICT ERROR?    */ 00314000
         CH    TM1HIRC,@CH00088                                    0262 00315000
         BNE   @RF00262                                            0262 00316000
         TM    CCARES(CCAPTR),B'00001000'                          0262 00317000
         BNO   @RF00262                                            0262 00318000
         L     @08,@PC00001+4                                      0262 00319000
         L     @08,ICMODPTR(,@08)                                  0262 00320000
         TM    ICTMDSTE(@08),B'00000100'                           0262 00321000
         BNZ   @RF00262                                            0262 00322000
*     ICTFMLIB(1)=ICTMDSTL(1);      /* FOR RESTORE FROMLIB IS DISTLIB*/ 00323000
         MVC   ICTFMLIB(8,@08),ICTMDSTL(@08)                       0263 00324000
*   IF TM1HIRC=IOPGOOD THEN         /* PREVIOUS PROCEDURE SUCCESSFUL?*/ 00325000
*                                                                  0264 00326000
@RF00262 CH    TM1HIRC,@CH00088                                    0264 00327000
         BNE   @RF00264                                            0264 00328000
*     /***************************************************************/ 00329000
*     /*                                                             */ 00330000
*     /* IF DELETE WAS NOT SPECIFIED ON THE ++MOD FOR THIS ELEMENT   */ 00331000
*     /* (I.E. - ICTMIDEL=OFF, WILL BE SET ON IN TM1PROC2 IF DELETE  */ 00332000
*     /* WAS ENTERED), THEN CALL TM1PROC7 TO DO THE FOLLOWING FOR THE*/ 00333000
*     /* FUNCTION SPECIFIED, OTHERWISE SKIP CALL AND CONTINUE. FOR   */ 00334000
*     /* APPLY OR RESTORE PROCESSING, ADD THE LOAD MODULE NAMES      */ 00335000
*     /* AFFECTED BY THIS ELEMENT TO A GTA FILE INDICATING THE       */ 00336000
*     /* ELEMENT. FOR ACCEPT PROCESSING, ADD THE ELEMENT NAME TO A   */ 00337000
*     /* GTA FILE.                                                   */ 00338000
*     /*                                                             */ 00339000
*     /***************************************************************/ 00340000
*                                                                  0265 00341000
*     IF ICTMIDEL(1)=OFF THEN       /* CALL IF DELETE NOT SPECIFIED     00342000
*                                      ON ++MOD FOR THIS ELEMENT     */ 00343000
         L     @08,@PC00001+4                                      0265 00344000
         L     @08,ICMODPTR(,@08)                                  0265 00345000
         TM    ICTMIDEL(@08),B'01000000'                           0265 00346000
         BNZ   @RF00265                                            0265 00347000
*       CALL TM1PROC7;              /* CALL PROCEDURE TO ADD ENTRIES    00348000
*                                      TO GTA FILES FOR CURRENT MOD  */ 00349000
         BAL   @14,TM1PROC7                                        0266 00350000
*   TM1HIRC=MAX(TM1HIRC,IOPRETRN);  /* PICK UP HIGHEST RC            */ 00351000
@RF00265 DS    0H                                                  0267 00352000
@RF00264 SLR   @08,@08                                             0267 00353000
         IC    @08,IOPRETRN(,IOPPTR)                               0267 00354000
         CR    TM1HIRC,@08                                         0267 00355000
         BNL   *+6                                                      00356000
         LR    TM1HIRC,@08                                         0267 00357000
*   IF TM1HIRC=IOPGOOD THEN         /* PREVIOUS PROCEDURE SUCCESSFUL?*/ 00358000
*                                                                  0268 00359000
         CH    TM1HIRC,@CH00088                                    0268 00360000
         BNE   @RF00268                                            0268 00361000
*     /***************************************************************/ 00362000
*     /*                                                             */ 00363000
*     /* INITIALIZE THE MODID LIST FOR THIS ELEMENT. IF A MODID LIST */ 00364000
*     /* EXIST FOR ANOTHER VERSION OF THIS ELEMENT, THEN POINT THE   */ 00365000
*     /* CHAIN POINTER FOR THIS ENTRY TO THAT VERSION'S MODID LIST.  */ 00366000
*     /* IF NO MODID LIST CAN BE FOUND, THEN CALL HMASMTID TO BUILD A*/ 00367000
*     /* MODID LIST FOR THIS ELEMENT.                                */ 00368000
*     /*                                                             */ 00369000
*     /***************************************************************/ 00370000
*                                                                  0269 00371000
*     CALL TM1PROC8;                /* CALL PROCEDURE TO BUILD MODID    00372000
*                                      LIST OR CHAIN TO IF PRESENT   */ 00373000
         BAL   @14,TM1PROC8                                        0269 00374000
*   TM1HIRC=MAX(TM1HIRC,IOPRETRN);  /* PICK UP HIGHEST RC            */ 00375000
*                                                                  0270 00376000
@RF00268 SLR   @08,@08                                             0270 00377000
         IC    @08,IOPRETRN(,IOPPTR)                               0270 00378000
         CR    TM1HIRC,@08                                         0270 00379000
         BNL   *+6                                                      00380000
         LR    TM1HIRC,@08                                         0270 00381000
*   /*****************************************************************/ 00382000
*   /*                                                               */ 00383000
*   /* END OF HMASMTM1 PROCESSING. RETURN TO CALLER WITH HIGHEST     */ 00384000
*   /* RETURN CODE ENCOUNTERED DURING PROCESSING.                    */ 00385000
*   /*                                                               */ 00386000
*   /*****************************************************************/ 00387000
*                                                                  0271 00388000
*   RETURN CODE(TM1HIRC);           /* RETURN TO CALLER WITH MAX RC  */ 00389000
         LR    @15,TM1HIRC                                         0271 00390000
         L     @13,4(,@13)                                         0271 00391000
         L     @14,12(,@13)                                        0271 00392000
         LM    @00,@12,20(@13)                                     0271 00393000
         BR    @14                                                 0271 00394000
*TM1PROC1:                                                         0272 00395000
*   PROC;                           /*                               */ 00396000
*                                                                  0272 00397000
@EL00001 L     @13,4(,@13)                                         0272 00398000
@EF00001 DS    0H                                                  0272 00399000
@ER00001 LM    @14,@12,12(@13)                                     0272 00400000
         BR    @14                                                 0272 00401000
TM1PROC1 STM   @14,@02,@SA00002                                    0272 00402000
         STM   @04,@12,@SA00002+20                                 0272 00403000
*   /*****************************************************************/ 00404000
*   /*                                                               */ 00405000
*   /* SET UP PARAMETER LIST FOR CALL TO HMASMIO                     */ 00406000
*   /*                                                               */ 00407000
*   /*****************************************************************/ 00408000
*                                                                  0273 00409000
*   IOPFUNCT=IOPLOC;                /* INDICATE LOCATE OPERATION     */ 00410000
         MVI   IOPFUNCT(IOPPTR),X'03'                              0273 00411000
*   IOPTYPE=IOPMOD;                 /* INDICATE (A)CDS MOD ENTRY     */ 00412000
         MVI   IOPTYPE(IOPPTR),X'05'                               0274 00413000
*   IOPNAME=ICTMNAME(1);            /* ELEMENT ENTRY BEING PROCESSED */ 00414000
*                                                                  0275 00415000
         L     @08,@PC00001+4                                      0275 00416000
         L     @08,ICMODPTR(,@08)                                  0275 00417000
         MVC   IOPNAME(8,IOPPTR),ICTMNAME(@08)                     0275 00418000
*   /*****************************************************************/ 00419000
*   /*                                                               */ 00420000
*   /* DETERMINE FUNCTION BEING RUN SO DATASET CAN BE SET            */ 00421000
*   /*                                                               */ 00422000
*   /*****************************************************************/ 00423000
*                                                                  0276 00424000
*   IF CCAACCPT=ON                  /* IS FUNCTION = ACCEPT?         */ 00425000
*     THEN                                                         0276 00426000
         TM    CCAACCPT(CCAPTR),B'00100000'                        0276 00427000
         BNO   @RF00276                                            0276 00428000
*     IOPDSID=IOPACDS;              /* YES- USE ACDS DATASET         */ 00429000
         MVI   IOPDSID(IOPPTR),X'0C'                               0277 00430000
*   ELSE                                                           0278 00431000
*     IOPDSID=IOPCDS;               /* NO- USE CDS DATASET           */ 00432000
         B     @RC00276                                            0278 00433000
@RF00276 MVI   IOPDSID(IOPPTR),X'02'                               0278 00434000
*   CALL HMASMIO(HMASMIOP);         /* CALL SMP IO INTERFACE MODULE  */ 00435000
@RC00276 ST    IOPPTR,@AL00001                                     0279 00436000
         L     @15,@CV01853                                        0279 00437000
         LA    @01,@AL00001                                        0279 00438000
         BALR  @14,@15                                             0279 00439000
*   IF IOPRETRN=IOPNOTFD THEN       /* ENTRY NOT FOUND FOR ELEMENT   */ 00440000
         CLI   IOPRETRN(IOPPTR),4                                  0280 00441000
         BNE   @RF00280                                            0280 00442000
*     DO;                           /*                               */ 00443000
*                                                                  0281 00444000
*       /*************************************************************/ 00445000
*       /*                                                           */ 00446000
*       /* IF ENTRY NOT FOUND, THEN LOOK FOR ENTRY UNDER DALIAS NAME */ 00447000
*       /* IF MCB ENTRY POINTER WAS PASSED                           */ 00448000
*       /*                                                           */ 00449000
*       /*************************************************************/ 00450000
*                                                                  0282 00451000
*       IF ELMCBPTR^=ZERO           /* IF MCB ENTRY WAS PASSED, AND  */ 00452000
*           &MCBEDALS^=BLANKS THEN  /* DALIAS WAS ENTERED THEN       */ 00453000
         L     @08,@PC00001+12                                     0282 00454000
         L     @08,ELMCBPTR(,@08)                                  0282 00455000
         LTR   @08,@08                                             0282 00456000
         BZ    @RF00282                                            0282 00457000
         CLC   MCBEDALS(8,@08),BLANKS                              0282 00458000
         BE    @RF00282                                            0282 00459000
*         DO;                       /* LOOK FOR UNDER DALIAS NAME    */ 00460000
*           IOPNAME=MCBEDALS;       /* SET UP PARM WITH DALIAS NAME  */ 00461000
         MVC   IOPNAME(8,IOPPTR),MCBEDALS(@08)                     0284 00462000
*           CALL HMASMIO(HMASMIOP); /* CALL SMP IO INTERFACE MODULE  */ 00463000
         ST    IOPPTR,@AL00001                                     0285 00464000
         L     @15,@CV01853                                        0285 00465000
         LA    @01,@AL00001                                        0285 00466000
         BALR  @14,@15                                             0285 00467000
*           IF IOPRETRN=IOPGOOD THEN/* IF ENTRY FOUND FOR DALIAS,    */ 00468000
*                                                                  0286 00469000
         CLI   IOPRETRN(IOPPTR),0                                  0286 00470000
         BNE   @RF00286                                            0286 00471000
*             /*******************************************************/ 00472000
*             /*                                                     */ 00473000
*             /* IF ENTRY WAS FOUND AS A DALIAS, THEN ADD A MOD ENTRY*/ 00474000
*             /* FOR THE CURRENT ELEMENT WITH THE DATA FROM THE      */ 00475000
*             /* DALIAS ENTRY.                                       */ 00476000
*             /*                                                     */ 00477000
*             /*******************************************************/ 00478000
*                                                                  0287 00479000
*             DO;                   /* ADD ENTRY FROM DALIAS ENTRY   */ 00480000
*               IOPFUNCT=IOPSTOWC;  /* TO RENAME MEMBER              */ 00481000
         MVI   IOPFUNCT(IOPPTR),X'52'                              0288 00482000
*               IOPONAME=MCBEDALS;  /* DALIAS ENTRY NAME             */ 00483000
         L     @08,@PC00001+12                                     0289 00484000
         L     @08,ELMCBPTR(,@08)                                  0289 00485000
         MVC   IOPONAME(8,IOPPTR),MCBEDALS(@08)                    0289 00486000
*               IOPOTYPE=IOPMOD;    /* MOD TYPE ENTRY                */ 00487000
         MVI   IOPOTYPE(IOPPTR),X'05'                              0290 00488000
*               IOPNNAME=ICTMNAME(1);/* CURRENT ENTRY NAME           */ 00489000
         L     @08,@PC00001+4                                      0291 00490000
         L     @08,ICMODPTR(,@08)                                  0291 00491000
         MVC   IOPNNAME(8,IOPPTR),ICTMNAME(@08)                    0291 00492000
*               IOPNTYPE=IOPMOD;    /* MOD TYPE ENTRY                */ 00493000
         MVI   IOPNTYPE(IOPPTR),X'05'                              0292 00494000
*               CALL HMASMIO(HMASMIOP);/* CALL SMP IO INTERFACE    0293 00495000
*                                      MODULE                        */ 00496000
         ST    IOPPTR,@AL00001                                     0293 00497000
         L     @15,@CV01853                                        0293 00498000
         LA    @01,@AL00001                                        0293 00499000
         BALR  @14,@15                                             0293 00500000
*             END;                  /*                               */ 00501000
*         END;                      /*                               */ 00502000
@RF00286 DS    0H                                                  0296 00503000
*     END;                          /*                               */ 00504000
@RF00282 DS    0H                                                  0297 00505000
*   IF IOPRETRN=IOPNOTFD            /* ENTRY STILL NOT FOUND/ADDED,  */ 00506000
*       &(CCAACCPT=ON               /* FUNCTION IS ACCEPT, OR THE    */ 00507000
*       |CCAAPPLY=ON)               /* FUNCTION IS APPLY, AND A MCB  */ 00508000
*       &ELMCBPTR^=ZERO             /* WAS PASSED AS A PARAMETER,    */ 00509000
*       &MCBEDIST^=BLANKS THEN      /* AND A DISTLIB VALUE ENTERED   */ 00510000
*                                                                  0297 00511000
@RF00280 CLI   IOPRETRN(IOPPTR),4                                  0297 00512000
         BNE   @RF00297                                            0297 00513000
         TM    CCAACCPT(CCAPTR),B'01100000'                        0297 00514000
         BZ    @RF00297                                            0297 00515000
         L     @08,@PC00001+12                                     0297 00516000
         L     @08,ELMCBPTR(,@08)                                  0297 00517000
         LTR   @08,@08                                             0297 00518000
         BZ    @RF00297                                            0297 00519000
         CLC   MCBEDIST(8,@08),BLANKS                              0297 00520000
         BE    @RF00297                                            0297 00521000
*     /***************************************************************/ 00522000
*     /*                                                             */ 00523000
*     /* FOR A NOT FOUND MOD ENTRY (EITHER AS THE CURRENT ELEMENT OR */ 00524000
*     /* AS A DALIAS), AND THE FUNCTION IS APPLY/ACCEPT, AND MCB WAS */ 00525000
*     /* INPUT AND A DISTLIB VALUE EXISTS IN THE MCB, INDICATE THE   */ 00526000
*     /* NEED FOR A (A)CDS MOD ENTRY TO BE BUILT FOR THIS ELEMENT. IT*/ 00527000
*     /* WILL BE BUILT AFTER THE ICT ENTRY HAS BEEN BUILT FROM THE   */ 00528000
*     /* INPUTS.                                                     */ 00529000
*     /*                                                             */ 00530000
*     /***************************************************************/ 00531000
*                                                                  0298 00532000
*     BLDACDSM=ON;                  /* SET BIT TO BUILD (A)CDS MOD 0298 00533000
*                                      ENTRY                         */ 00534000
         OI    BLDACDSM,B'00000100'                                0298 00535000
*   IF IOPRETRN=IOPGOOD THEN        /* WAS AN ENTRY WAS FOUND EITHER    00536000
*                                      AS THE ENTRY NAME OR DALIAS?  */ 00537000
@RF00297 CLI   IOPRETRN(IOPPTR),0                                  0299 00538000
         BNE   @RF00299                                            0299 00539000
*     DO;                           /*                               */ 00540000
*       ICTMDSTL(1)=IOPDLIB;        /* YES- FILL IN ENTRY FROM (A)CDS   00541000
*                                      FOR ENTRY FOUND EITHER AS THE    00542000
*                                      ENTRY OR DALIAS               */ 00543000
         L     @08,@PC00001+4                                      0301 00544000
         L     @08,ICMODPTR(,@08)                                  0301 00545000
         MVC   ICTMDSTL(8,@08),IOPDLIB(IOPPTR)                     0301 00546000
*       DLIBBIT=ON;                 /* INDICATE DLIB VALUE FOUND     */ 00547000
         OI    DLIBBIT,B'10000000'                                 0302 00548000
*       IF ELMCBPTR^=ZERO THEN      /* WAS A MCB PASSED AS INPUT?    */ 00549000
         L     @08,@PC00001+12                                     0303 00550000
         ICM   @15,15,ELMCBPTR(@08)                                0303 00551000
         BZ    @RF00303                                            0303 00552000
*         MODFND=ON;                /* SET UP FOR CALL TO TM1LMOD    */ 00553000
         OI    MODFND,B'01000000'                                  0304 00554000
*     END;                          /*                               */ 00555000
@RF00303 DS    0H                                                  0306 00556000
*                                                                  0306 00557000
*   /*****************************************************************/ 00558000
*   /*                                                               */ 00559000
*   /* ALIAS NAMES INTO THE ICT ENTRY.                               */ 00560000
*   /*                                                               */ 00561000
*   /*****************************************************************/ 00562000
*                                                                  0306 00563000
*   IF TM1HIRC=ZERO                 /* IF MCB NOT PRESENT THEN GET   */ 00564000
*       &ELMCBPTR=ZERO THEN         /* ...ALIAS NAMES FROM IOP       */ 00565000
@RF00299 SLR   @08,@08                                             0306 00566000
         CR    TM1HIRC,@08                                         0306 00567000
         BNE   @RF00306                                            0306 00568000
         L     @15,@PC00001+12                                     0306 00569000
         C     @08,ELMCBPTR(,@15)                                  0306 00570000
         BNE   @RF00306                                            0306 00571000
*     CALL ALASPROC;                /*                               */ 00572000
*                                                                  0307 00573000
         BAL   @14,ALASPROC                                        0307 00574000
*   /*****************************************************************/ 00575000
*   /*                                                               */ 00576000
*   /* SET ERROR CODE                                                */ 00577000
*   /*                                                               */ 00578000
*   /*****************************************************************/ 00579000
*                                                                  0308 00580000
*   IF IOPRETRN=IOPNOTFD THEN       /* IF ENTRY NOT FOUND THEN RESET    00581000
*                                      RETURN CODE TO ZERO           */ 00582000
@RF00306 CLI   IOPRETRN(IOPPTR),4                                  0308 00583000
         BNE   @RF00308                                            0308 00584000
*     IOPRETRN=IOPGOOD;             /* SET RC=0                      */ 00585000
         MVI   IOPRETRN(IOPPTR),X'00'                              0309 00586000
*   END TM1PROC1;                   /*                               */ 00587000
@EL00002 DS    0H                                                  0310 00588000
@EF00002 DS    0H                                                  0310 00589000
@ER00002 LM    @14,@02,@SA00002                                    0310 00590000
         LM    @04,@12,@SA00002+20                                 0310 00591000
         BR    @14                                                 0310 00592000
*TM1PROC2:                                                         0311 00593000
*   PROC;                           /*                               */ 00594000
*                                                                  0311 00595000
TM1PROC2 STM   @14,@02,@SA00003                                    0311 00596000
         STM   @04,@12,@SA00003+20                                 0311 00597000
*   /*****************************************************************/ 00598000
*   /*                                                               */ 00599000
*   /* FILL IN ICT MOD VALUES FROM MCB ELEMENT PASSED                */ 00600000
*   /*                                                               */ 00601000
*   /*****************************************************************/ 00602000
*                                                                  0312 00603000
*                                                                  0312 00604000
*   /*****************************************************************/ 00605000
*   /*                                                               */ 00606000
*   /* DALIAS ON ++MOD/++ZAP CONTROL STATEMENT                       */ 00607000
*   /*                                                               */ 00608000
*   /*****************************************************************/ 00609000
*                                                                  0312 00610000
*   IF MCBEDALS^=BLANKS             /* DALIAS ENTERED ON ++MOD?      */ 00611000
*       &CCAACCPT=ON THEN           /* DO ONLY FOR ACCEPT FUNCTION   */ 00612000
         L     @08,@PC00001+12                                     0312 00613000
         L     @08,ELMCBPTR(,@08)                                  0312 00614000
         CLC   MCBEDALS(8,@08),BLANKS                              0312 00615000
         BE    @RF00312                                            0312 00616000
         TM    CCAACCPT(CCAPTR),B'00100000'                        0312 00617000
         BNO   @RF00312                                            0312 00618000
*     DO;                           /* ADD TO ICTTCHN LIST           */ 00619000
*       CALL HMASMTAI(TBLXPARM,     /* PARAMETER FOR TABLE MODULES   */ 00620000
*           ICTMTCHN(1),            /* CHAIN TO BE BUILT             */ 00621000
*           ADDR(MCBEDALS),         /* DATA TO BE CHAINED            */ 00622000
*           LENGTH(ICTTALLS(1)));   /* DATA TO CHAIN LENGTH          */ 00623000
         L     @15,@PC00001                                        0314 00624000
         ST    @15,@AL00001                                        0314 00625000
         L     @15,@PC00001+4                                      0314 00626000
         L     @01,ICMODPTR(,@15)                                  0314 00627000
         LA    @15,ICTMTCHN(,@01)                                  0314 00628000
         ST    @15,@AL00001+4                                      0314 00629000
         LA    @08,MCBEDALS(,@08)                                  0314 00630000
         ST    @08,@TF00001                                        0314 00631000
         LA    @08,@TF00001                                        0314 00632000
         ST    @08,@AL00001+8                                      0314 00633000
         LA    @08,@CF00062                                        0314 00634000
         ST    @08,@AL00001+12                                     0314 00635000
         L     @15,@CV01856                                        0314 00636000
         LA    @01,@AL00001                                        0314 00637000
         BALR  @14,@15                                             0314 00638000
*       RFY                                                        0315 00639000
*         RTNCODE RSTD;             /* RESTRICT REG 15 USAGE         */ 00640000
*       IF RTNCODE^=IOPGOOD THEN    /* WAS HMASMTAI SUCCESSFULL?     */ 00641000
         LTR   RTNCODE,RTNCODE                                     0316 00642000
         BZ    @RF00316                                            0316 00643000
*         TM1HIRC=MAX(TM1HIRC,RTNCODE);/* NO- PICK UP HIGHEST RC     */ 00644000
         CR    TM1HIRC,RTNCODE                                     0317 00645000
         BNL   *+6                                                      00646000
         LR    TM1HIRC,RTNCODE                                     0317 00647000
*       RFY                                                        0318 00648000
*         RTNCODE UNRSTD;           /* RELEASE REG 15                */ 00649000
@RF00316 DS    0H                                                  0319 00650000
*       IF TM1HIRC^=IOPGOOD THEN    /* WAS HMASMTAI SUCCESSFULL?     */ 00651000
         CH    TM1HIRC,@CH00088                                    0319 00652000
         BNE   @RT00319                                            0319 00653000
*         RETURN;                   /* NO- RETURN                    */ 00654000
*       ICTMALIS(1)=ON;             /* INDICATE ALIAS ENTRY EXISTS   */ 00655000
         L     @08,@PC00001+4                                      0321 00656000
         L     @08,ICMODPTR(,@08)                                  0321 00657000
         OI    ICTMALIS(@08),B'00000100'                           0321 00658000
*     END;                          /*                               */ 00659000
*                                                                  0322 00660000
*   /*****************************************************************/ 00661000
*   /*                                                               */ 00662000
*   /* DELETE ON ++MOD CONTROL STATEMENT                             */ 00663000
*   /*                                                               */ 00664000
*   /*****************************************************************/ 00665000
*                                                                  0323 00666000
*   IF MCBEDEL=ON THEN              /* WAS DELETE ENTERED ON ++MOD?  */ 00667000
@RF00312 L     @08,@PC00001+12                                     0323 00668000
         L     @08,ELMCBPTR(,@08)                                  0323 00669000
         TM    MCBEDEL(@08),B'01000000'                            0323 00670000
         BNO   @RF00323                                            0323 00671000
*     ICTMIDEL(1)=ON;               /* YES- SET ON ICT DELETE FLAG   */ 00672000
*                                                                  0324 00673000
         L     @08,@PC00001+4                                      0324 00674000
         L     @08,ICMODPTR(,@08)                                  0324 00675000
         OI    ICTMIDEL(@08),B'01000000'                           0324 00676000
*   /*****************************************************************/ 00677000
*   /*                                                               */ 00678000
*   /* DISTLIB ON ++MOD/++ZAP CONTROL STATEMENT                      */ 00679000
*   /*                                                               */ 00680000
*   /*****************************************************************/ 00681000
*                                                                  0325 00682000
*   IF MCBEDIST^=BLANKS THEN        /* DISTLIB ENTERED ON ++MOD?     */ 00683000
@RF00323 L     @08,@PC00001+12                                     0325 00684000
         L     @08,ELMCBPTR(,@08)                                  0325 00685000
         CLC   MCBEDIST(8,@08),BLANKS                              0325 00686000
         BE    @RF00325                                            0325 00687000
*     ICTMDSTL(1)=MCBEDIST;         /* PICK UP MCB DISTLIB VALUE     */ 00688000
         L     @15,@PC00001+4                                      0326 00689000
         L     @01,ICMODPTR(,@15)                                  0326 00690000
         MVC   ICTMDSTL(8,@01),MCBEDIST(@08)                       0326 00691000
*                                                                  0327 00692000
*   /*****************************************************************/ 00693000
*   /*                                                               */ 00694000
*   /* LEPARMS ON ++MOD CONTROL STATEMENT                            */ 00695000
*   /*                                                               */ 00696000
*   /*****************************************************************/ 00697000
*                                                                  0327 00698000
*   IF MCBEFLG1^=ALLOFF             /* ANY LINK EDIT PARMS ENTERED,  */ 00699000
*       |MCBEFLG2^=ALLOFF THEN      /* IN EITHER LE PARM BYTE?       */ 00700000
@RF00325 L     @08,@PC00001+12                                     0327 00701000
         L     @08,ELMCBPTR(,@08)                                  0327 00702000
         CLI   MCBEFLG1(@08),B'00000000'                           0327 00703000
         BNE   @RT00327                                            0327 00704000
         CLI   MCBEFLG2(@08),B'00000000'                           0327 00705000
         BE    @RF00327                                            0327 00706000
@RT00327 DS    0H                                                  0328 00707000
*     ICTMPRMS(1)=ON;               /* MOD LE PARMS OBTAINED IN MCB  */ 00708000
         L     @08,@PC00001+4                                      0328 00709000
         L     @08,ICMODPTR(,@08)                                  0328 00710000
         OI    ICTMPRMS(@08),B'00000010'                           0328 00711000
*   ICTMLEP1(1)=MCBEFLG1;           /* PICK UP FIRST BYTE MCB LEPARMS*/ 00712000
@RF00327 L     @08,@PC00001+4                                      0329 00713000
         L     @08,ICMODPTR(,@08)                                  0329 00714000
         L     @15,@PC00001+12                                     0329 00715000
         L     @15,ELMCBPTR(,@15)                                  0329 00716000
         MVC   ICTMLEP1(1,@08),MCBEFLG1(@15)                       0329 00717000
*   ICTMLEP2(1)=MCBEFLG2;           /* PICK UP REST OF MCB LEPARMS   */ 00718000
*                                                                  0330 00719000
         MVC   ICTMLEP2(1,@08),MCBEFLG2(@15)                       0330 00720000
*   /*****************************************************************/ 00721000
*   /*                                                               */ 00722000
*   /* LKLIB | TXLIB | RELFILE ON ++MOD CONTROL STATEMENT MOVE TO    */ 00723000
*   /* FROMLIB FOR APPLY/ACCEPT. NOTE: KEYWORDS MUTUALLY EXCLUSIVE.  */ 00724000
*   /*                                                               */ 00725000
*   /*****************************************************************/ 00726000
*                                                                  0331 00727000
*   IF CCAAPPLY=ON                  /* IS FUNCTION APPLY OR ACCEPT?  */ 00728000
*       |CCAACCPT=ON THEN           /*                               */ 00729000
         TM    CCAAPPLY(CCAPTR),B'01100000'                        0331 00730000
         BZ    @RF00331                                            0331 00731000
*     DO;                           /*                               */ 00732000
*       IF MCBELKLB^=BLANKS THEN    /* WAS LKLIB ENTERED ON ++MOD?   */ 00733000
         CLC   MCBELKLB(8,@15),BLANKS                              0333 00734000
         BE    @RF00333                                            0333 00735000
*         DO;                       /*                               */ 00736000
*           ICTFMLIB(1)=MCBELKLB;   /* YES- SET FROMLIB TO MCBELKLB  */ 00737000
         MVC   ICTFMLIB(8,@08),MCBELKLB(@15)                       0335 00738000
*           ICTLIBLK(1)=ON;         /* INDICATE LKLIB                */ 00739000
         OI    ICTLIBLK(@08),B'10000000'                           0336 00740000
*         END;                      /*                               */ 00741000
*       ELSE                                                       0338 00742000
*         IF MCBETXLB^=BLANKS THEN  /* WAS TXLIB ENTERED ON ++MOD?   */ 00743000
         B     @RC00333                                            0338 00744000
@RF00333 L     @08,@PC00001+12                                     0338 00745000
         L     @08,ELMCBPTR(,@08)                                  0338 00746000
         CLC   MCBETXLB(8,@08),BLANKS                              0338 00747000
         BE    @RF00338                                            0338 00748000
*           DO;                     /*                               */ 00749000
*             ICTFMLIB(1)=MCBETXLB; /* YES- SET FROMLIB TO MCBETXLB  */ 00750000
         L     @15,@PC00001+4                                      0340 00751000
         L     @15,ICMODPTR(,@15)                                  0340 00752000
         MVC   ICTFMLIB(8,@15),MCBETXLB(@08)                       0340 00753000
*             ICTLIBTX(1)=ON;       /* INDICATE TXLIB                */ 00754000
         OI    ICTLIBTX(@15),B'01000000'                           0341 00755000
*           END;                    /*                               */ 00756000
*         ELSE                                                     0343 00757000
*           IF MCBERLF^=BLANKS(1:4) THEN/* RELFILE ENTERED ON ++MOD? */ 00758000
         B     @RC00338                                            0343 00759000
@RF00338 L     @08,@PC00001+12                                     0343 00760000
         L     @08,ELMCBPTR(,@08)                                  0343 00761000
         CLC   MCBERLF(4,@08),BLANKS                               0343 00762000
         BE    @RF00343                                            0343 00763000
*             DO;                   /* YES- PROCESS FOR RELFILE      */ 00764000
*               ICTMRELF(1)=ON;     /* SET BIT TO INDICATE RELF      */ 00765000
         L     @08,@PC00001+4                                      0345 00766000
         L     @08,ICMODPTR(,@08)                                  0345 00767000
         OI    ICTMRELF(@08),B'00100000'                           0345 00768000
*               ICTFMLIB(1)=CSMPTLIB;/* SET FROMLIB TO SMPTLIB       */ 00769000
*                                                                  0346 00770000
         MVC   ICTFMLIB(8,@08),@CC01864                            0346 00771000
*               /*****************************************************/ 00772000
*               /*                                                   */ 00773000
*               /* CONVERT RELFILE TO HEX AND MOVE INTO ICTMRELN(1)  */ 00774000
*               /*                                                   */ 00775000
*               /*****************************************************/ 00776000
*                                                                  0347 00777000
*               RADJ=CZEROS;        /* INIT WORKAREA TO RECEIVE RIGHT   00778000
*                                      ADJUSTED RELFILE NUMBER       */ 00779000
         MVC   RADJ(8),@CC01868                                    0347 00780000
*               S=LENGTH(RADJ);     /* INDEX SET TO RIGHT HAND BYTE  */ 00781000
         LA    S,8                                                 0348 00782000
*               DO T=LENGTH(MCBERLF) TO 1 BY-1;/* MOVE THROUGH     0349 00783000
*                                      MCBERLF FROM RIGHT TO LEFT    */ 00784000
         LA    T,4                                                 0349 00785000
@DL00349 DS    0H                                                  0350 00786000
*                 IF MCBERLF(T)^=' ' THEN/* IGNORE BLANKS IN FIELD   */ 00787000
         L     @08,@PC00001+12                                     0350 00788000
         L     @08,ELMCBPTR(,@08)                                  0350 00789000
         LR    @01,@08                                             0350 00790000
         ALR   @01,T                                               0350 00791000
         CLI   MCBERLF-1(@01),C' '                                 0350 00792000
         BE    @RF00350                                            0350 00793000
*                   DO;             /*                               */ 00794000
*                     RADJ(S)=MCBERLF(T);/* PUT CHAR IN WORKAREA     */ 00795000
         LA    @01,RADJ-1(S)                                       0352 00796000
         ALR   @08,T                                               0352 00797000
         MVC   0(1,@01),MCBERLF-1(@08)                             0352 00798000
*                     S=S-1;        /* MOVE INDEX 1 TO LEFT          */ 00799000
         BCTR  S,0                                                 0353 00800000
*                   END;            /*                               */ 00801000
*               END;                /*                               */ 00802000
@RF00350 BCTR  T,0                                                 0355 00803000
         CH    T,@CH00070                                          0355 00804000
         BNL   @DL00349                                            0355 00805000
*               PACK(PKDEC,RADJ);   /* CONVERT CHAR TO PACKED DECIMAL*/ 00806000
         PACK  PKDEC(8),RADJ(8)                                    0356 00807000
*               CVB(FIX31,PKDEC);   /* CONVERT PACKED DECIMAL->BINARY*/ 00808000
         CVB   FIX31,PKDEC                                         0357 00809000
*               ICTMRELN(1)=FIX31;  /* SET CURRENT ELEMENT RELFILE#  */ 00810000
         L     @08,@PC00001+4                                      0358 00811000
         L     @08,ICMODPTR(,@08)                                  0358 00812000
         STH   FIX31,ICTMRELN(,@08)                                0358 00813000
*             END;                  /*                               */ 00814000
*           ELSE                                                   0360 00815000
*             ICTFMLIB(1)=CSMPWRK3; /* YES- SET FROMLIB TO SMPWRK3   */ 00816000
         B     @RC00343                                            0360 00817000
@RF00343 L     @08,@PC00001+4                                      0360 00818000
         L     @08,ICMODPTR(,@08)                                  0360 00819000
         MVC   ICTFMLIB(8,@08),@CC01866                            0360 00820000
*     END;                          /*                               */ 00821000
*                                                                  0361 00822000
@RC00343 DS    0H                                                  0361 00823000
@RC00338 DS    0H                                                  0361 00824000
@RC00333 DS    0H                                                  0362 00825000
*   /*****************************************************************/ 00826000
*   /*                                                               */ 00827000
*   /* BUILD VERSION LIST FOR ++MOD CONTROL STATEMENT                */ 00828000
*   /*                                                               */ 00829000
*   /*****************************************************************/ 00830000
*                                                                  0362 00831000
*   ICTMVCHN(1)=0;                  /* CLEAR VERSION LIST POINTER    */ 00832000
@RF00331 L     @08,@PC00001+4                                      0362 00833000
         L     @08,ICMODPTR(,@08)                                  0362 00834000
         SLR   @15,@15                                             0362 00835000
         ST    @15,ICTMVCHN(,@08)                                  0362 00836000
*   DO S=1 BY 1 WHILE MCBEND(S)^=IOPEOLST/* PROCESS ALL MCB        0363 00837000
*                                      SUBENTRIES                    */ 00838000
*         &TM1HIRC=IOPGOOD;         /* WHILE RETURN CODE = ZERO      */ 00839000
         LA    S,1                                                 0363 00840000
         B     @DE00363                                            0363 00841000
@DL00363 DS    0H                                                  0364 00842000
*     IF MCBEIND(S)=MCBEVERS THEN   /* SUBENTRY A VERSION NUMBER?    */ 00843000
         LR    @08,S                                               0364 00844000
         MH    @08,@CH00038                                        0364 00845000
         L     @05,@PC00001+12                                     0364 00846000
         L     @05,ELMCBPTR(,@05)                                  0364 00847000
         SLR   @15,@15                                             0364 00848000
         IC    @15,MCBEIND-9(@08,@05)                              0364 00849000
         CH    @15,@CH00070                                        0364 00850000
         BNE   @RF00364                                            0364 00851000
*       DO;                         /*                               */ 00852000
*         CALL HMASMTAI(TBLXPARM,   /* PARAMETER FOR TABLE MODULES   */ 00853000
*             ICTMVCHN(1),          /* CHAIN TO BE BUILT             */ 00854000
*             ADDR(MCBEVLST(S)),    /* DATA TO BE CHAINED            */ 00855000
*             LENGTH(ICTMVRLS(1))); /* DATA TO CHAIN LENGTH          */ 00856000
         L     @15,@PC00001                                        0366 00857000
         ST    @15,@AL00001                                        0366 00858000
         L     @15,@PC00001+4                                      0366 00859000
         L     @01,ICMODPTR(,@15)                                  0366 00860000
         LA    @15,ICTMVCHN(,@01)                                  0366 00861000
         ST    @15,@AL00001+4                                      0366 00862000
         LA    @08,MCBEVLST-9(@08,@05)                             0366 00863000
         ST    @08,@TF00001                                        0366 00864000
         LA    @08,@TF00001                                        0366 00865000
         ST    @08,@AL00001+8                                      0366 00866000
         LA    @08,@CF00062                                        0366 00867000
         ST    @08,@AL00001+12                                     0366 00868000
         L     @15,@CV01856                                        0366 00869000
         LA    @01,@AL00001                                        0366 00870000
         BALR  @14,@15                                             0366 00871000
*         RFY                                                      0367 00872000
*           RTNCODE RSTD;           /* RESTRICT REG 15 USAGE         */ 00873000
*         IF RTNCODE^=IOPGOOD THEN  /* WAS HMASMTAI SUCCESSFULL?     */ 00874000
         LTR   RTNCODE,RTNCODE                                     0368 00875000
         BZ    @RF00368                                            0368 00876000
*           TM1HIRC=MAX(TM1HIRC,RTNCODE);/* NO- PICK UP HIGHEST RC   */ 00877000
         CR    TM1HIRC,RTNCODE                                     0369 00878000
         BNL   *+6                                                      00879000
         LR    TM1HIRC,RTNCODE                                     0369 00880000
*         RFY                                                      0370 00881000
*           RTNCODE UNRSTD;         /* RELEASE REG 15                */ 00882000
@RF00368 DS    0H                                                  0371 00883000
*       END;                        /*                               */ 00884000
*   END;                                                           0372 00885000
@RF00364 AH    S,@CH00070                                          0372 00886000
@DE00363 LR    @08,S                                               0372 00887000
         MH    @08,@CH00038                                        0372 00888000
         L     @05,@PC00001+12                                     0372 00889000
         L     @05,ELMCBPTR(,@05)                                  0372 00890000
         SLR   @15,@15                                             0372 00891000
         IC    @15,MCBEND-9(@08,@05)                               0372 00892000
         CH    @15,@CH00714                                        0372 00893000
         BE    @DC00363                                            0372 00894000
         CH    TM1HIRC,@CH00088                                    0372 00895000
         BE    @DL00363                                            0372 00896000
@DC00363 DS    0H                                                  0373 00897000
*   IF ICTMVCHN(1)=0                /* NO VERSION LIST BUILT         */ 00898000
*     THEN                                                         0373 00899000
         L     @08,@PC00001+4                                      0373 00900000
         L     @08,ICMODPTR(,@08)                                  0373 00901000
         ICM   @15,15,ICTMVCHN(@08)                                0373 00902000
         BNZ   @RF00373                                            0373 00903000
*     ICTMVCHN(1)=TBLXNULL;         /* POINT TO EMPTY LIST           */ 00904000
*                                                                  0374 00905000
         L     @15,@PC00001                                        0374 00906000
         MVC   ICTMVCHN(4,@08),TBLXNULL(@15)                       0374 00907000
*   /*****************************************************************/ 00908000
*   /*                                                               */ 00909000
*   /* BUILD ALIAS LIST FOR ++MOD AND ++ZAP CONTROL STATEMENTS       */ 00910000
*   /*                                                               */ 00911000
*   /*****************************************************************/ 00912000
*                                                                  0375 00913000
*   CALL ALASPROC;                  /*                               */ 00914000
*                                                                  0375 00915000
@RF00373 BAL   @14,ALASPROC                                        0375 00916000
*   /*****************************************************************/ 00917000
*   /*                                                               */ 00918000
*   /* IF A MOD ENTRY WAS FOUND, THEN CALL TM1LMOD TO SEARCH THE MCB */ 00919000
*   /* FOR LMOD SUBENTRIES TO ADD TO THE MOD ENTRY.                  */ 00920000
*   /*                                                               */ 00921000
*   /*****************************************************************/ 00922000
*                                                                  0376 00923000
*   IF MODFND=ON THEN               /* WAS A MOD ENTRY FOUND?        */ 00924000
         TM    MODFND,B'01000000'                                  0376 00925000
         BNO   @RF00376                                            0376 00926000
*     DO;                           /*                               */ 00927000
*       CALL TM1LMOD;               /* TO PROCESS MCB LMOD SUBENTRIES*/ 00928000
         BAL   @14,TM1LMOD                                         0378 00929000
*       TM1HIRC=MAX(TM1HIRC,IOPRETRN);/* PICK UP HIGHEST RC          */ 00930000
         SLR   @08,@08                                             0379 00931000
         IC    @08,IOPRETRN(,IOPPTR)                               0379 00932000
         CR    TM1HIRC,@08                                         0379 00933000
         BNL   *+6                                                      00934000
         LR    TM1HIRC,@08                                         0379 00935000
*     END;                          /*                               */ 00936000
*                                                                  0380 00937000
*   /*****************************************************************/ 00938000
*   /*                                                               */ 00939000
*   /* IF THE MCBTYPE PASSED IS A ZAP, THEN TURN OFF THE MOD TYPE BIT*/ 00940000
*   /* AND TURN ON THE ZAP TYPE BIT.                                 */ 00941000
*   /*                                                               */ 00942000
*   /*****************************************************************/ 00943000
*                                                                  0381 00944000
*   IF MCBTYPE=MCBZAPTP THEN        /* IS MCB A ZAP TYPE?            */ 00945000
@RF00376 L     @08,@PC00001+12                                     0381 00946000
         L     @08,ELMCBPTR(,@08)                                  0381 00947000
         CLI   MCBTYPE(@08),7                                      0381 00948000
         BNE   @RF00381                                            0381 00949000
*     DO;                           /*                               */ 00950000
*       ICTMMOD(1)=OFF;             /* TURN OFF MOD BIT              */ 00951000
*       ICTMZAP(1)=ON;              /* TURN ON ZAP BIT               */ 00952000
         L     @08,@PC00001+4                                      0384 00953000
         L     @08,ICMODPTR(,@08)                                  0384 00954000
         OI    ICTMZAP(@08),B'00100000'                            0384 00955000
         NI    ICTMMOD(@08),B'01111111'                            0384 00956000
*     END;                          /*                               */ 00957000
*   END TM1PROC2;                   /*                               */ 00958000
@EL00003 DS    0H                                                  0386 00959000
@EF00003 DS    0H                                                  0386 00960000
@ER00003 LM    @14,@02,@SA00003                                    0386 00961000
         LM    @04,@12,@SA00003+20                                 0386 00962000
         BR    @14                                                 0386 00963000
*ALASPROC:                                                         0387 00964000
*   PROC;                           /*                               */ 00965000
*                                                                  0387 00966000
ALASPROC STM   @14,@02,@SA00004                                    0387 00967000
         STM   @04,@12,@SA00004+20                                 0387 00968000
*   /*****************************************************************/ 00969000
*   /*                                                               */ 00970000
*   /* ALIAS NAMES ARE PUT INTO THE ICT ENTRY. IF AN MCB HAS BEEN    */ 00971000
*   /* SUPPLIED THEN THE IT IS SEARCHED FOR THE NAMES. IF NONE ARE   */ 00972000
*   /* FOUND THE THE (A)CDS ELEMENT ENTRY IS USED FOR THE NAMES.     */ 00973000
*   /*                                                               */ 00974000
*   /*****************************************************************/ 00975000
*                                                                  0388 00976000
*   IF ELMCBPTR^=ZERO THEN          /*                               */ 00977000
         L     @08,@PC00001+12                                     0388 00978000
         ICM   @15,15,ELMCBPTR(@08)                                0388 00979000
         BZ    @RF00388                                            0388 00980000
*     DO S=1 BY 1 WHILE MCBEND(S)^=IOPEOLST/* PROCESS ALL MCB      0389 00981000
*                                      SUBENTRIES                    */ 00982000
*           &TM1HIRC=IOPGOOD;       /* WHILE RETURN CODE = ZERO      */ 00983000
         LA    S,1                                                 0389 00984000
         B     @DE00389                                            0389 00985000
@DL00389 DS    0H                                                  0390 00986000
*       IF MCBEIND(S)=MCBEALIS THEN /* SUBENTRY A TALIAS NAME?       */ 00987000
         LR    @08,S                                               0390 00988000
         MH    @08,@CH00038                                        0390 00989000
         L     @05,@PC00001+12                                     0390 00990000
         L     @05,ELMCBPTR(,@05)                                  0390 00991000
         SLR   @15,@15                                             0390 00992000
         IC    @15,MCBEIND-9(@08,@05)                              0390 00993000
         CH    @15,@CH00279                                        0390 00994000
         BNE   @RF00390                                            0390 00995000
*         DO;                       /*                               */ 00996000
*           CALL HMASMTAI(TBLXPARM, /* PARAMETER FOR TABLE MODULES   */ 00997000
*               ICTMTCHN(1),        /* CHAIN TO BE BUILT             */ 00998000
*               ADDR(MCBEVLST(S)),  /* DATA TO BE CHAINED            */ 00999000
*               LENGTH(ICTTALLS(1)));/* DATA TO CHAIN LENGTH         */ 01000000
         L     @15,@PC00001                                        0392 01001000
         ST    @15,@AL00001                                        0392 01002000
         L     @15,@PC00001+4                                      0392 01003000
         L     @01,ICMODPTR(,@15)                                  0392 01004000
         LA    @15,ICTMTCHN(,@01)                                  0392 01005000
         ST    @15,@AL00001+4                                      0392 01006000
         LA    @08,MCBEVLST-9(@08,@05)                             0392 01007000
         ST    @08,@TF00001                                        0392 01008000
         LA    @08,@TF00001                                        0392 01009000
         ST    @08,@AL00001+8                                      0392 01010000
         LA    @08,@CF00062                                        0392 01011000
         ST    @08,@AL00001+12                                     0392 01012000
         L     @15,@CV01856                                        0392 01013000
         LA    @01,@AL00001                                        0392 01014000
         BALR  @14,@15                                             0392 01015000
*           RFY                                                    0393 01016000
*             RTNCODE RSTD;         /* RESTRICT REG 15 USAGE         */ 01017000
*           IF RTNCODE^=IOPGOOD THEN/* WAS HMASMTAI SUCCESSFULL?     */ 01018000
         LTR   RTNCODE,RTNCODE                                     0394 01019000
         BZ    @RF00394                                            0394 01020000
*             TM1HIRC=MAX(TM1HIRC,RTNCODE);/* NO- PICK UP HIGHEST RC */ 01021000
         CR    TM1HIRC,RTNCODE                                     0395 01022000
         BNL   *+6                                                      01023000
         LR    TM1HIRC,RTNCODE                                     0395 01024000
*           ELSE                                                   0396 01025000
*             ICTMALIS(1)=ON;       /* INDICATE ALIAS ENTRY EXISTS   */ 01026000
         B     @RC00394                                            0396 01027000
@RF00394 L     @14,@PC00001+4                                      0396 01028000
         L     @14,ICMODPTR(,@14)                                  0396 01029000
         OI    ICTMALIS(@14),B'00000100'                           0396 01030000
*           RFY                                                    0397 01031000
*             RTNCODE UNRSTD;       /* RELEASE REG 15                */ 01032000
@RC00394 DS    0H                                                  0398 01033000
*         END;                      /*                               */ 01034000
*     END;                          /*                               */ 01035000
*                                                                  0399 01036000
@RF00390 AH    S,@CH00070                                          0399 01037000
@DE00389 LR    @08,S                                               0399 01038000
         MH    @08,@CH00038                                        0399 01039000
         L     @05,@PC00001+12                                     0399 01040000
         L     @05,ELMCBPTR(,@05)                                  0399 01041000
         SLR   @15,@15                                             0399 01042000
         IC    @15,MCBEND-9(@08,@05)                               0399 01043000
         CH    @15,@CH00714                                        0399 01044000
         BE    @DC00389                                            0399 01045000
         CH    TM1HIRC,@CH00088                                    0399 01046000
         BE    @DL00389                                            0399 01047000
@DC00389 DS    0H                                                  0400 01048000
*   /*****************************************************************/ 01049000
*   /*                                                               */ 01050000
*   /* IF NO ALIAS FROM MCB NOW CHECK FOR IOP VALUES                 */ 01051000
*   /*                                                               */ 01052000
*   /*****************************************************************/ 01053000
*                                                                  0400 01054000
*   IF DLIBBIT=ON                   /* IOP PRESENT                   */ 01055000
*       &ICTMALIS(1)=OFF THEN       /* ... AND NO ALIAS NAMES YET    */ 01056000
@RF00388 TM    DLIBBIT,B'10000000'                                 0400 01057000
         BNO   @RF00400                                            0400 01058000
         L     @08,@PC00001+4                                      0400 01059000
         L     @08,ICMODPTR(,@08)                                  0400 01060000
         TM    ICTMALIS(@08),B'00000100'                           0400 01061000
         BNZ   @RF00400                                            0400 01062000
*     DO S=1 BY 1 WHILE IOPMODND(S)^=IOPEOLST/* PROCESS ALL        0401 01063000
*                                      SUBENTRIES                    */ 01064000
*           &TM1HIRC=IOPGOOD;       /* WHILE RETURN CODE = ZERO      */ 01065000
         LA    S,1                                                 0401 01066000
         B     @DE00401                                            0401 01067000
@DL00401 DS    0H                                                  0402 01068000
*       IF IOPMDIND(S)=IOPMDTAL     /* SUBENTRY A ALIAS NAME?        */ 01069000
*           |IOPMDIND(S)=IOPMDDAL THEN/*                             */ 01070000
         LR    @08,S                                               0402 01071000
         MH    @08,@CH00038                                        0402 01072000
         SLR   @05,@05                                             0402 01073000
         IC    @05,IOPMDIND-9(@08,IOPPTR)                          0402 01074000
         CH    @05,@CH00279                                        0402 01075000
         BE    @RT00402                                            0402 01076000
         CH    @05,@CH00093                                        0402 01077000
         BNE   @RF00402                                            0402 01078000
@RT00402 DS    0H                                                  0403 01079000
*         DO;                       /*                               */ 01080000
*           CALL HMASMTAI(TBLXPARM, /* PARAMETER FOR TABLE MODULES   */ 01081000
*               ICTMTCHN(1),        /* CHAIN TO BE BUILT             */ 01082000
*               ADDR(IOPMDDTA(S)),  /* DATA TO BE CHAINED            */ 01083000
*               LENGTH(ICTTALLS(1)));/* DATA TO CHAIN LENGTH         */ 01084000
         L     @08,@PC00001                                        0404 01085000
         ST    @08,@AL00001                                        0404 01086000
         L     @08,@PC00001+4                                      0404 01087000
         L     @08,ICMODPTR(,@08)                                  0404 01088000
         LA    @08,ICTMTCHN(,@08)                                  0404 01089000
         ST    @08,@AL00001+4                                      0404 01090000
         LR    @08,S                                               0404 01091000
         MH    @08,@CH00038                                        0404 01092000
         LA    @08,IOPMDDTA-9(@08,IOPPTR)                          0404 01093000
         ST    @08,@TF00001                                        0404 01094000
         LA    @08,@TF00001                                        0404 01095000
         ST    @08,@AL00001+8                                      0404 01096000
         LA    @08,@CF00062                                        0404 01097000
         ST    @08,@AL00001+12                                     0404 01098000
         L     @15,@CV01856                                        0404 01099000
         LA    @01,@AL00001                                        0404 01100000
         BALR  @14,@15                                             0404 01101000
*           RFY                                                    0405 01102000
*             RTNCODE RSTD;         /* RESTRICT REG 15 USAGE         */ 01103000
*           IF RTNCODE^=IOPGOOD THEN/* WAS HMASMTAI SUCCESSFULL?     */ 01104000
         LTR   RTNCODE,RTNCODE                                     0406 01105000
         BZ    @RF00406                                            0406 01106000
*             TM1HIRC=MAX(TM1HIRC,RTNCODE);/* NO- PICK UP HIGHEST RC */ 01107000
         CR    TM1HIRC,RTNCODE                                     0407 01108000
         BNL   *+6                                                      01109000
         LR    TM1HIRC,RTNCODE                                     0407 01110000
*           ELSE                                                   0408 01111000
*             ICTMALIS(1)=ON;       /* INDICATE ALIAS ENTRY EXISTS   */ 01112000
         B     @RC00406                                            0408 01113000
@RF00406 L     @14,@PC00001+4                                      0408 01114000
         L     @14,ICMODPTR(,@14)                                  0408 01115000
         OI    ICTMALIS(@14),B'00000100'                           0408 01116000
*           RFY                                                    0409 01117000
*             RTNCODE UNRSTD;       /* RELEASE REG 15                */ 01118000
@RC00406 DS    0H                                                  0410 01119000
*         END;                      /*                               */ 01120000
*     END;                          /*                               */ 01121000
@RF00402 AH    S,@CH00070                                          0411 01122000
@DE00401 LR    @08,S                                               0411 01123000
         MH    @08,@CH00038                                        0411 01124000
         SLR   @05,@05                                             0411 01125000
         IC    @05,IOPMODND-9(@08,IOPPTR)                          0411 01126000
         CH    @05,@CH00714                                        0411 01127000
         BE    @DC00401                                            0411 01128000
         CH    TM1HIRC,@CH00088                                    0411 01129000
         BE    @DL00401                                            0411 01130000
@DC00401 DS    0H                                                  0412 01131000
*   END ALASPROC;                   /*                               */ 01132000
@EL00004 DS    0H                                                  0412 01133000
@EF00004 DS    0H                                                  0412 01134000
@ER00004 LM    @14,@02,@SA00004                                    0412 01135000
         LM    @04,@12,@SA00004+20                                 0412 01136000
         BR    @14                                                 0412 01137000
*TM1PROC3:                                                         0413 01138000
*   PROC;                           /*                               */ 01139000
*                                                                  0413 01140000
TM1PROC3 STM   @14,@02,@SA00005                                    0413 01141000
         STM   @04,@12,@SA00005+20                                 0413 01142000
*   /*****************************************************************/ 01143000
*   /*                                                               */ 01144000
*   /* CHECK FOR A DISTLIB VALUE FOUND. FOR ANY FUNCTION, IF ONE NOT */ 01145000
*   /* FOUND THEN SEND ERROR MESSAGE HMA431I (INSUFFICIENT INFOR-    */ 01146000
*   /* MATION AVAILABLE FOR SYSMOD PROCESSING) AND SET THE RETURN    */ 01147000
*   /* CODE TO STOPPTF (RC=8).                                       */ 01148000
*   /*                                                               */ 01149000
*   /*****************************************************************/ 01150000
*                                                                  0414 01151000
*   IF ICTMDSTL(1)=BLANKS THEN      /* HAS A DISTLIB VALUE BEEN FOUND*/ 01152000
         L     @08,@PC00001+4                                      0414 01153000
         L     @08,ICMODPTR(,@08)                                  0414 01154000
         CLC   ICTMDSTL(8,@08),BLANKS                              0414 01155000
         BNE   @RF00414                                            0414 01156000
*     DO;                           /* NO- THEN SEND ERROR MESSAGE   */ 01157000
*       ICTMCPL(1)=ON;              /* SET COMPLETE BIT ON           */ 01158000
*       ICTMNOGO(1)=ON;             /* SET NOGO BIT ON               */ 01159000
*       ICTMMSG(1)=ON;              /* SET MESSAGE SENT BIT ON       */ 01160000
*                                                                  0418 01161000
         OI    ICTMCPL(@08),B'01110000'                            0418 01162000
*       /*************************************************************/ 01163000
*       /*                                                           */ 01164000
*       /* GENERATE ERROR MSG HMA431                                 */ 01165000
*       /*                                                           */ 01166000
*       /*************************************************************/ 01167000
*                                                                  0419 01168000
*       ETYPE='MOD     ';           /* ELEMENT TYPE FOR MSG          */ 01169000
         MVC   ETYPE(8),@CC01929                                   0419 01170000
*       HMASMMGP=''B;               /* ZERO PARAMETER FIELD          */ 01171000
         XC    HMASMMGP(24),HMASMMGP                               0420 01172000
*       MGPTYPE=MGPERR;             /* SET FOR RETURN CODE=8         */ 01173000
         MVI   MGPTYPE,X'03'                                       0421 01174000
*       MGPPRINT=ON;                /* SEND TO SMPOUT                */ 01175000
*       MGPHLDS=ON;                 /* SEND TO SMPLOG                */ 01176000
         OI    MGPPRINT,B'10010000'                                0423 01177000
*       MGPMGNO1=HMA431I;           /* INSUFFICIENT INFORMATION MSG  */ 01178000
         MVC   MGPMGNO1(2),@CH01859                                0424 01179000
*       MGPVARPT(1)=ADDR(ETYPE);    /* MOD ELEMENT                   */ 01180000
         LA    @02,ETYPE                                           0425 01181000
         ST    @02,MGPVARPT                                        0425 01182000
*       MGPVARPT(2)=ADDR(ICTMNAME(1));/* ITS NAME                    */ 01183000
         ST    @08,MGPVARPT+4                                      0426 01184000
*       MGPVARPT(3)=ADDR(ICTPTFS(1));/* OUNER SYSMOD                 */ 01185000
         L     @08,@PC00001+8                                      0427 01186000
         L     @08,ICPTFPTR(,@08)                                  0427 01187000
         ST    @08,MGPVARPT+8                                      0427 01188000
*       CALL HMASMMSG(HMASMMGP);    /* SEND ERROR MESSAGE            */ 01189000
*                                                                  0428 01190000
         L     @15,@CV01854                                        0428 01191000
         LA    @01,@AL00428                                        0428 01192000
         BALR  @14,@15                                             0428 01193000
*       /*************************************************************/ 01194000
*       /*                                                           */ 01195000
*       /* SET RETURN CODE TO STOPPTF (RC=8)                         */ 01196000
*       /*                                                           */ 01197000
*       /*************************************************************/ 01198000
*                                                                  0429 01199000
*       TM1HIRC=MAX(TM1HIRC,STOPPTF);/*                              */ 01200000
         LA    @08,8                                               0429 01201000
         CR    TM1HIRC,@08                                         0429 01202000
         BNL   *+6                                                      01203000
         LR    TM1HIRC,@08                                         0429 01204000
*     END;                          /*                               */ 01205000
*   END TM1PROC3;                   /*                               */ 01206000
@EL00005 DS    0H                                                  0431 01207000
@EF00005 DS    0H                                                  0431 01208000
@ER00005 LM    @14,@02,@SA00005                                    0431 01209000
         LM    @04,@12,@SA00005+20                                 0431 01210000
         BR    @14                                                 0431 01211000
*TM1PROC4:                                                         0432 01212000
*   PROC;                           /*                               */ 01213000
*                                                                  0432 01214000
TM1PROC4 STM   @14,@12,12(@13)                                     0432 01215000
*   /*****************************************************************/ 01216000
*   /*                                                               */ 01217000
*   /* IF A DLIB VALUE WAS FOUND ON THE CDS, AND APPLY FUNCTION IS   */ 01218000
*   /* BEING EXECUTED, AND A MCB WAS PASSED, AND MCB DISTLIB VALUE   */ 01219000
*   /* WAS ENTERED, THEN COMPARE THE CDS DISTLIB AND THE MCB DISTLIB */ 01220000
*   /* VALUES. IF DIFFERENT DLIB VALUES ARE FOUND, THEN BLANK OUT THE*/ 01221000
*   /* ICTMOD ENTRY AND SET THE DISTLIB CONFLICT BIT (ICTMDSTE) ON.  */ 01222000
*   /*                                                               */ 01223000
*   /*****************************************************************/ 01224000
*                                                                  0433 01225000
*   IF DLIBBIT=ON                   /* WAS A DLIB VALUE FOUND, AND   */ 01226000
*       &CCAAPPLY=ON                /* IS THE FUNCTION APPLY, AND    */ 01227000
*       &ELMCBPTR^=ZERO             /* WAS A MCB PASSED, AND         */ 01228000
*       &MCBEDIST^=BLANKS           /* MCB DISTLIB WAS ENTERED, AND  */ 01229000
*       &MCBEDIST^=IOPDLIB THEN     /* MCB DISTLIB ^= IOPDLIB?       */ 01230000
         TM    DLIBBIT,B'10000000'                                 0433 01231000
         BNO   @RF00433                                            0433 01232000
         TM    CCAAPPLY(CCAPTR),B'01000000'                        0433 01233000
         BNO   @RF00433                                            0433 01234000
         L     @08,@PC00001+12                                     0433 01235000
         L     @08,ELMCBPTR(,@08)                                  0433 01236000
         LTR   @08,@08                                             0433 01237000
         BZ    @RF00433                                            0433 01238000
         CLC   MCBEDIST(8,@08),BLANKS                              0433 01239000
         BE    @RF00433                                            0433 01240000
         CLC   MCBEDIST(8,@08),IOPDLIB(IOPPTR)                     0433 01241000
         BE    @RF00433                                            0433 01242000
*     DO;                           /*                               */ 01243000
*       ICTMDSTL(1)=BLANKS;         /* BLANK OUT THE ICT DISTLIB     */ 01244000
         L     @08,@PC00001+4                                      0435 01245000
         L     @08,ICMODPTR(,@08)                                  0435 01246000
         MVC   ICTMDSTL(8,@08),BLANKS                              0435 01247000
*       ICTMDSTE(1)=ON;             /* INDICATE A DLIB CONFLICT      */ 01248000
         OI    ICTMDSTE(@08),B'00000100'                           0436 01249000
*     END;                          /*                               */ 01250000
*   END TM1PROC4;                   /*                               */ 01251000
@EL00006 DS    0H                                                  0438 01252000
@EF00006 DS    0H                                                  0438 01253000
@ER00006 LM    @14,@12,12(@13)                                     0438 01254000
         BR    @14                                                 0438 01255000
*TM1PROC5:                                                         0439 01256000
*   PROC;                           /*                               */ 01257000
*                                                                  0439 01258000
TM1PROC5 STM   @14,@12,@SA00007                                    0439 01259000
*   /*****************************************************************/ 01260000
*   /*                                                               */ 01261000
*   /* IF ACCEPT FUNCTION, AND A DLIB VALUE WAS FOUND IN THE ACDS,   */ 01262000
*   /* AND A MCB WAS PASSED, AND THE VALUES ARE DIFFERENT, THEN CHECK*/ 01263000
*   /* 1) IF NOAPPLY WAS NOT SPECIFIED 2) IF SYSMOD OWNING THE       */ 01264000
*   /* ELEMENT IS APPLIED ON THE CDS 3) IF THE SYSMOD OWNING THE     */ 01265000
*   /* ELEMENT APPEARS AS AN FMID,RMID OR UMID VALUE IN THE ELEMENT  */ 01266000
*   /* CDS ENTRY 4) IF THE CDS ENTRY DISTLIB VALUE IS THE SAME AS THE*/ 01267000
*   /* VALUE IN THE MCB. IF ALL CHECKS (1-4) ARE TRUE THEN THE ICT,  */ 01268000
*   /* AND ACDS ELEMENT VALUES ARE SET TO THE MCB VALUE, OTHERWISE   */ 01269000
*   /* THE DLIB CONFLICT BIT (ICTMDSTE)IS SET ON.                    */ 01270000
*   /*                                                               */ 01271000
*   /*****************************************************************/ 01272000
*                                                                  0440 01273000
*   IF CCAACCPT=ON                  /* IS FUNCTION ACCEPT, AND       */ 01274000
*       &DLIBBIT=ON                 /* WAS A DLIB VALUE FOUND, AND   */ 01275000
*       &ELMCBPTR^=ZERO             /* WAS A MCB PASSED, AND         */ 01276000
*       &MCBEDIST^=BLANKS           /* DLIB VALUE SUPPLIED IN MCB    */ 01277000
*       &MCBEDIST^=IOPDLIB THEN     /* ARE MCB & IOP DLIB VALUES ^=? */ 01278000
         TM    CCAACCPT(CCAPTR),B'00100000'                        0440 01279000
         BNO   @RF00440                                            0440 01280000
         TM    DLIBBIT,B'10000000'                                 0440 01281000
         BNO   @RF00440                                            0440 01282000
         L     @08,@PC00001+12                                     0440 01283000
         L     @08,ELMCBPTR(,@08)                                  0440 01284000
         LTR   @08,@08                                             0440 01285000
         BZ    @RF00440                                            0440 01286000
         CLC   MCBEDIST(8,@08),BLANKS                              0440 01287000
         BE    @RF00440                                            0440 01288000
         CLC   MCBEDIST(8,@08),IOPDLIB(IOPPTR)                     0440 01289000
         BE    @RF00440                                            0440 01290000
*     DO;                           /*                               */ 01291000
*                                                                  0441 01292000
*       /*************************************************************/ 01293000
*       /*                                                           */ 01294000
*       /* DETERMINE IF CHECK 1 IS SUCCESSFULL                       */ 01295000
*       /*                                                           */ 01296000
*       /*************************************************************/ 01297000
*                                                                  0442 01298000
*       IF TBLNOAPP=OFF THEN        /* NOAPPLY NOT SPECIFIED?        */ 01299000
         L     @08,@PC00001                                        0442 01300000
         L     @08,TBLXTBL(,@08)                                   0442 01301000
         TM    TBLNOAPP(@08),B'10000000'                           0442 01302000
         BNZ   @RF00442                                            0442 01303000
*         DO;                       /*                               */ 01304000
*           SAVADLIB=IOPDLIB;       /* SAVE ACDS DLIB VALUE          */ 01305000
         MVC   SAVADLIB(8),IOPDLIB(IOPPTR)                         0444 01306000
*           IOPFUNCT=IOPLOC;        /* SET UP TO LOCATE OWNER        */ 01307000
         MVI   IOPFUNCT(IOPPTR),X'03'                              0445 01308000
*           IOPDSID=IOPCDS;         /* SET DATASET TO CDS            */ 01309000
         MVI   IOPDSID(IOPPTR),X'02'                               0446 01310000
*           IOPTYPE=IOPSMD;         /* SYSMOD TYPE ENTRY             */ 01311000
         MVI   IOPTYPE(IOPPTR),X'0B'                               0447 01312000
*           IOPNAME=ICTPTFS(1);     /* OWNER OF ELEMENT              */ 01313000
*                                                                  0448 01314000
         MVI   IOPNAME+7(IOPPTR),C' '                              0448 01315000
         L     @08,@PC00001+8                                      0448 01316000
         L     @08,ICPTFPTR(,@08)                                  0448 01317000
         MVC   IOPNAME(7,IOPPTR),ICTPTFS(@08)                      0448 01318000
*           /*********************************************************/ 01319000
*           /*                                                       */ 01320000
*           /* LOCATE SYSMOD ON CDS DATASET                          */ 01321000
*           /*                                                       */ 01322000
*           /*********************************************************/ 01323000
*                                                                  0449 01324000
*           CALL HMASMIO(HMASMIOP); /* CALL SMP IO INTERFACE MODULE  */ 01325000
         ST    IOPPTR,@AL00001                                     0449 01326000
         L     @15,@CV01853                                        0449 01327000
         LA    @01,@AL00001                                        0449 01328000
         BALR  @14,@15                                             0449 01329000
*           IF IOPRETRN=IOPGOOD THEN/* IS OWNER APPLIED ON CDS?      */ 01330000
         CLI   IOPRETRN(IOPPTR),0                                  0450 01331000
         BNE   @RF00450                                            0450 01332000
*             DO;                   /*                               */ 01333000
*               SMDAPPLY=ON;        /* INDICATE SYSMOD IS APPLIED    */ 01334000
         OI    SMDAPPLY,B'01000000'                                0452 01335000
*               IOPTYPE=IOPMOD;     /* INDICATE MOD TYPE ENTRY       */ 01336000
         MVI   IOPTYPE(IOPPTR),X'05'                               0453 01337000
*               IOPFUNCT=IOPLOC;    /* LOCATE ELEMENT ON CDS         */ 01338000
         MVI   IOPFUNCT(IOPPTR),X'03'                              0454 01339000
*               IOPNAME=ICTMNAME(1);/* FILL IN ELEMENT NAME          */ 01340000
         L     @08,@PC00001+4                                      0455 01341000
         L     @08,ICMODPTR(,@08)                                  0455 01342000
         MVC   IOPNAME(8,IOPPTR),ICTMNAME(@08)                     0455 01343000
*                                                                  0456 01344000
*               /*****************************************************/ 01345000
*               /*                                                   */ 01346000
*               /* LOCATE MOD ENTRY ON CDS DATASET                   */ 01347000
*               /*                                                   */ 01348000
*               /*****************************************************/ 01349000
*                                                                  0456 01350000
*               CALL HMASMIO(HMASMIOP);/* CALL SMP IO INTERFACE    0456 01351000
*                                      MODULE                        */ 01352000
         ST    IOPPTR,@AL00001                                     0456 01353000
         L     @15,@CV01853                                        0456 01354000
         LA    @01,@AL00001                                        0456 01355000
         BALR  @14,@15                                             0456 01356000
*               IF IOPRETRN=IOPGOOD THEN/* IS ELEMENT ALSO ON CDS?   */ 01357000
*                                                                  0457 01358000
         CLI   IOPRETRN(IOPPTR),0                                  0457 01359000
         BNE   @RF00457                                            0457 01360000
*                 /***************************************************/ 01361000
*                 /*                                                 */ 01362000
*                 /* CHECK IF SYSMOD OWNING ELEMENT IS FMID/RMID/UMID*/ 01363000
*                 /* IN ENTRY                                        */ 01364000
*                 /*                                                 */ 01365000
*                 /***************************************************/ 01366000
*                                                                  0458 01367000
*                 DO;               /*                               */ 01368000
*                   IF IOPFMID=ICTPTFS(1)/* DOES FMID MATCH OWNER, OR*/ 01369000
*                       |IOPRMID=ICTPTFS(1) THEN/* DOES RMID MATCH 0459 01370000
*                                      OWNER?                        */ 01371000
         L     @08,@PC00001+8                                      0459 01372000
         L     @08,ICPTFPTR(,@08)                                  0459 01373000
         CLC   IOPFMID(7,IOPPTR),ICTPTFS(@08)                      0459 01374000
         BE    @RT00459                                            0459 01375000
         CLC   IOPRMID(7,IOPPTR),ICTPTFS(@08)                      0459 01376000
         BNE   @RF00459                                            0459 01377000
@RT00459 DS    0H                                                  0460 01378000
*                     XMID=ON;      /* INDICATE RMID/FMID MATCH      */ 01379000
         OI    XMID,B'00100000'                                    0460 01380000
*                   ELSE                                           0461 01381000
*                     DO L=1 BY 1 WHILE IOPMODND(L)^=IOPEOLST/* TO 0461 01382000
*                                      EOF,                          */ 01383000
*                           &XMID=OFF;/* OR TILL HIT FOUND           */ 01384000
         B     @RC00459                                            0461 01385000
@RF00459 LA    L,1                                                 0461 01386000
         B     @DE00461                                            0461 01387000
@DL00461 DS    0H                                                  0462 01388000
*                       IF IOPMODID(L)=ICTPTFS(1) THEN/* UMID MATCH? */ 01389000
         LR    @08,L                                               0462 01390000
         MH    @08,@CH00038                                        0462 01391000
         L     @05,@PC00001+8                                      0462 01392000
         L     @05,ICPTFPTR(,@05)                                  0462 01393000
         ALR   @08,IOPPTR                                          0462 01394000
         CLC   IOPMODID-9(7,@08),ICTPTFS(@05)                      0462 01395000
         BNE   @RF00462                                            0462 01396000
*                         XMID=ON;  /* INDICATE UMID MATCH           */ 01397000
         OI    XMID,B'00100000'                                    0463 01398000
*                     END;          /*                               */ 01399000
@RF00462 AH    L,@CH00070                                          0464 01400000
@DE00461 LR    @08,L                                               0464 01401000
         MH    @08,@CH00038                                        0464 01402000
         SLR   @05,@05                                             0464 01403000
         IC    @05,IOPMODND-9(@08,IOPPTR)                          0464 01404000
         CH    @05,@CH00714                                        0464 01405000
         BE    @DC00461                                            0464 01406000
         TM    XMID,B'00100000'                                    0464 01407000
         BZ    @DL00461                                            0464 01408000
@DC00461 DS    0H                                                  0465 01409000
*                 END;              /*                               */ 01410000
@RC00459 DS    0H                                                  0466 01411000
*             END;                  /*                               */ 01412000
*                                                                  0466 01413000
@RF00457 DS    0H                                                  0467 01414000
*           /*********************************************************/ 01415000
*           /*                                                       */ 01416000
*           /* DETERMINE IF CHECKS (2-4) ARE SUCCESSFULL             */ 01417000
*           /*                                                       */ 01418000
*           /*********************************************************/ 01419000
*                                                                  0467 01420000
*           IF IOPRETRN=IOPGOOD     /* NO ERRORS FROM HMASMIO        */ 01421000
*               &SMDAPPLY=ON        /* OWNER SYSMOD IS APPLIED       */ 01422000
*               &XMID=ON            /* EITHER FMID/RMID/UMID MATCH   */ 01423000
*               &IOPDLIB=MCBEDIST THEN/* CDS DLIB MATCHES MCB DLIB   */ 01424000
@RF00450 CLI   IOPRETRN(IOPPTR),0                                  0467 01425000
         BNE   @RF00467                                            0467 01426000
         TM    SMDAPPLY,B'01100000'                                0467 01427000
         BNO   @RF00467                                            0467 01428000
         L     @08,@PC00001+12                                     0467 01429000
         L     @08,ELMCBPTR(,@08)                                  0467 01430000
         CLC   IOPDLIB(8,IOPPTR),MCBEDIST(@08)                     0467 01431000
         BNE   @RF00467                                            0467 01432000
*             DO;                   /*                               */ 01433000
*                                                                  0468 01434000
*               /*****************************************************/ 01435000
*               /*                                                   */ 01436000
*               /* UPDATE ELEMENT ENTRY IN ACDS DLIB = CDS AND MCB   */ 01437000
*               /* DLIB VALUES AND MAKE ICT DLIB VALUE EQUAL TO MCB  */ 01438000
*               /* DLIB VALUE                                        */ 01439000
*               /*                                                   */ 01440000
*               /*****************************************************/ 01441000
*                                                                  0469 01442000
*               ICTMDSTL(1)=MCBEDIST;/* SET ICT VALUE = MCB VALUE    */ 01443000
         L     @03,@PC00001+4                                      0469 01444000
         L     @03,ICMODPTR(,@03)                                  0469 01445000
         MVC   ICTMDSTL(8,@03),MCBEDIST(@08)                       0469 01446000
*               IOPFUNCT=IOPLOC;    /* LOCATE FUNCTION               */ 01447000
         MVI   IOPFUNCT(IOPPTR),X'03'                              0470 01448000
*               IOPDSID=IOPACDS;    /* ACDS DATASET                  */ 01449000
         MVI   IOPDSID(IOPPTR),X'0C'                               0471 01450000
*               IOPNAME=ICTMNAME(1);/* ELEMENT NAME                  */ 01451000
         MVC   IOPNAME(8,IOPPTR),ICTMNAME(@03)                     0472 01452000
*               IOPTYPE=IOPMOD;     /* MOD TYPE ENTRY                */ 01453000
*                                                                  0473 01454000
         MVI   IOPTYPE(IOPPTR),X'05'                               0473 01455000
*               /*****************************************************/ 01456000
*               /*                                                   */ 01457000
*               /* RE LOCATE ACDS MOD ENTRY TO BUFFER FOR UPDATE     */ 01458000
*               /*                                                   */ 01459000
*               /*****************************************************/ 01460000
*                                                                  0474 01461000
*               CALL HMASMIO(HMASMIOP);/* CALL SMP IO INTERFACE    0474 01462000
*                                      MODULE                        */ 01463000
         ST    IOPPTR,@AL00001                                     0474 01464000
         L     @15,@CV01853                                        0474 01465000
         LA    @01,@AL00001                                        0474 01466000
         BALR  @14,@15                                             0474 01467000
*               IF IOPRETRN=IOPGOOD THEN/* ELEMENT MOD ENTRY FOUND?  */ 01468000
         CLI   IOPRETRN(IOPPTR),0                                  0475 01469000
         BNE   @RF00475                                            0475 01470000
*                 DO;               /*                               */ 01471000
*                   SAVADLIB=MCBEDIST;/* UPDATE TO MCB DISTLIB VALUE */ 01472000
         L     @08,@PC00001+12                                     0477 01473000
         L     @08,ELMCBPTR(,@08)                                  0477 01474000
         MVC   SAVADLIB(8),MCBEDIST(@08)                           0477 01475000
*                   IOPDLIB=MCBEDIST;/* UPDATE TO CDS/MCB DISTLIB    */ 01476000
         MVC   IOPDLIB(8,IOPPTR),MCBEDIST(@08)                     0478 01477000
*                   IOPFUNCT=IOPSTOWR;/* INDICATE STOW REPLACE       */ 01478000
*                                                                  0479 01479000
         MVI   IOPFUNCT(IOPPTR),X'54'                              0479 01480000
*                   /*************************************************/ 01481000
*                   /*                                               */ 01482000
*                   /* REPLACE WITH UPDATED DLIB VALUE FROM MCB      */ 01483000
*                   /*                                               */ 01484000
*                   /*************************************************/ 01485000
*                                                                  0480 01486000
*                   CALL HMASMIO(HMASMIOP);/* CALL IO INTERFACE    0480 01487000
*                                      MODULE                        */ 01488000
         ST    IOPPTR,@AL00001                                     0480 01489000
         L     @15,@CV01853                                        0480 01490000
         LA    @01,@AL00001                                        0480 01491000
         BALR  @14,@15                                             0480 01492000
*                 END;              /*                               */ 01493000
*             END;                  /*                               */ 01494000
*           ELSE                                                   0483 01495000
*             ICTMDSTE(1)=ON;       /* SET ON DLIB CONFLICT BIT      */ 01496000
         B     @RC00467                                            0483 01497000
@RF00467 L     @08,@PC00001+4                                      0483 01498000
         L     @08,ICMODPTR(,@08)                                  0483 01499000
         OI    ICTMDSTE(@08),B'00000100'                           0483 01500000
*           IOPDLIB=SAVADLIB;       /* RESTORE DLIB VALUE IF CHANGED */ 01501000
@RC00467 MVC   IOPDLIB(8,IOPPTR),SAVADLIB                          0484 01502000
*         END;                      /*                               */ 01503000
*       ELSE                                                       0486 01504000
*         ICTMDSTE(1)=ON;           /* SET ON DLIB CONFLICT BIT      */ 01505000
         B     @RC00442                                            0486 01506000
@RF00442 L     @08,@PC00001+4                                      0486 01507000
         L     @08,ICMODPTR(,@08)                                  0486 01508000
         OI    ICTMDSTE(@08),B'00000100'                           0486 01509000
*     END;                          /*                               */ 01510000
@RC00442 DS    0H                                                  0488 01511000
*   IF IOPRETRN=IOPNOTFD THEN       /* IF ENTRY NOT FOUND THEN RESET    01512000
*                                      RETURN CODE TO ZERO           */ 01513000
@RF00440 CLI   IOPRETRN(IOPPTR),4                                  0488 01514000
         BNE   @RF00488                                            0488 01515000
*     IOPRETRN=IOPGOOD;             /* SET RC=0                      */ 01516000
         MVI   IOPRETRN(IOPPTR),X'00'                              0489 01517000
*   END TM1PROC5;                   /*                               */ 01518000
@EL00007 DS    0H                                                  0490 01519000
@EF00007 DS    0H                                                  0490 01520000
@ER00007 LM    @14,@12,@SA00007                                    0490 01521000
         BR    @14                                                 0490 01522000
*TM1PROC6:                                                         0491 01523000
*   PROC;                           /*                               */ 01524000
TM1PROC6 STM   @14,@12,@SA00008                                    0491 01525000
*   IOPFUNCT=IOPLOC;                /* SET FUNCTION TO LOCATE        */ 01526000
         MVI   IOPFUNCT(IOPPTR),X'03'                              0492 01527000
*   IOPTYPE=IOPDLB;                 /* INDICATE DLIB ENTRY           */ 01528000
         MVI   IOPTYPE(IOPPTR),X'06'                               0493 01529000
*   IOPNAME=ICTMDSTL(1);            /* DISTLIB ENTRY NAME            */ 01530000
*                                                                  0494 01531000
         L     @08,@PC00001+4                                      0494 01532000
         L     @08,ICMODPTR(,@08)                                  0494 01533000
         MVC   IOPNAME(8,IOPPTR),ICTMDSTL(@08)                     0494 01534000
*   /*****************************************************************/ 01535000
*   /*                                                               */ 01536000
*   /* DETERMINE IF THIS ELEMENTS DISTLIB IS A TOTAL COPY (I.E.- IF A*/ 01537000
*   /* CDS DLIB ENTRY EXISTS, IT IS A TOTAL COPY DISTLIB)            */ 01538000
*   /*                                                               */ 01539000
*   /*****************************************************************/ 01540000
*                                                                  0495 01541000
*   CALL HMASMIO(HMASMIOP);         /* CALL SMP IO INTERFACE MODULE  */ 01542000
         ST    IOPPTR,@AL00001                                     0495 01543000
         L     @15,@CV01853                                        0495 01544000
         LA    @01,@AL00001                                        0495 01545000
         BALR  @14,@15                                             0495 01546000
*   IF IOPRETRN=IOPGOOD THEN        /* TOTAL COPY DLIB (IE.-FOUND)   */ 01547000
         CLI   IOPRETRN(IOPPTR),0                                  0496 01548000
         BNE   @RF00496                                            0496 01549000
*     DO;                           /*                               */ 01550000
*                                                                  0497 01551000
*       /*************************************************************/ 01552000
*       /*                                                           */ 01553000
*       /* SAVE THE TARGET SYSLIB SUBENTRIES FROM THE DLIB ENTRY FOR */ 01554000
*       /* USE LATER IN THE EVENT THAT A CDS LMOD ENTRY NEEDS TO BE  */ 01555000
*       /* CREATED                                                   */ 01556000
*       /*                                                           */ 01557000
*       /*************************************************************/ 01558000
*                                                                  0498 01559000
*       SYSLIBS(1)=BLANKS;          /* BLANK OUT FIRST SYSLIB SAVE   */ 01560000
         MVC   SYSLIBS(8),BLANKS                                   0498 01561000
*       SYSLIBS(2)=BLANKS;          /* BLANK OUT LAST SYSLIB SAVE    */ 01562000
         MVC   SYSLIBS+8(8),BLANKS                                 0499 01563000
*       DO L=1 BY 1 WHILE IOPDLBND(L)^=IOPEOLST;/* DO TO END OF LIST */ 01564000
         LA    L,1                                                 0500 01565000
         B     @DE00500                                            0500 01566000
@DL00500 DS    0H                                                  0501 01567000
*         IF IOPDLIND(L)=IOPDLSYS THEN/* SYSLIB TYPE ENTRY?          */ 01568000
         LR    @08,L                                               0501 01569000
         MH    @08,@CH00038                                        0501 01570000
         SLR   @05,@05                                             0501 01571000
         IC    @05,IOPDLIND-9(@08,IOPPTR)                          0501 01572000
         CH    @05,@CH00070                                        0501 01573000
         BNE   @RF00501                                            0501 01574000
*           SYSLIBS(L)=IOPDSYS(L);  /* SAVE SYSLIB ENTRIES (MAX=2)   */ 01575000
         LR    @05,L                                               0502 01576000
         SLA   @05,3                                               0502 01577000
         LA    @03,SYSLIBS-8(@05)                                  0502 01578000
         ALR   @08,IOPPTR                                          0502 01579000
         MVC   0(8,@03),IOPDSYS-9(@08)                             0502 01580000
*       END;                        /*                               */ 01581000
@RF00501 AH    L,@CH00070                                          0503 01582000
@DE00500 LR    @08,L                                               0503 01583000
         MH    @08,@CH00038                                        0503 01584000
         SLR   @05,@05                                             0503 01585000
         IC    @05,IOPDLBND-9(@08,IOPPTR)                          0503 01586000
         CH    @05,@CH00714                                        0503 01587000
         BNE   @DL00500                                            0503 01588000
*       IOPTYPE=IOPMOD;             /* INDICATE MOD ENTRY            */ 01589000
         MVI   IOPTYPE(IOPPTR),X'05'                               0504 01590000
*       IOPNAME=ICTMNAME(1);        /* MOD NAME BEING PROCESSED      */ 01591000
*                                                                  0505 01592000
         L     @08,@PC00001+4                                      0505 01593000
         L     @08,ICMODPTR(,@08)                                  0505 01594000
         MVC   IOPNAME(8,IOPPTR),ICTMNAME(@08)                     0505 01595000
*       /*************************************************************/ 01596000
*       /*                                                           */ 01597000
*       /* ATTEMPT TO LOCATE A CDS MOD ENTRY FOR THIS ELEMENT        */ 01598000
*       /*                                                           */ 01599000
*       /*************************************************************/ 01600000
*                                                                  0506 01601000
*       CALL HMASMIO(HMASMIOP);     /* CALL SMP IO INTERFACE MODULE  */ 01602000
         ST    IOPPTR,@AL00001                                     0506 01603000
         L     @15,@CV01853                                        0506 01604000
         LA    @01,@AL00001                                        0506 01605000
         BALR  @14,@15                                             0506 01606000
*       IF IOPRETRN=IOPGOOD THEN    /* WAS A MOD ENTRY FOUND?        */ 01607000
         CLI   IOPRETRN(IOPPTR),0                                  0507 01608000
         BNE   @RF00507                                            0507 01609000
*         DO;                       /*                               */ 01610000
*                                                                  0509 01611000
*           /*********************************************************/ 01612000
*           /*                                                       */ 01613000
*           /* FOR A LOCATED ENTRY, ATTEMPT TO FIND A LMOD SUBENTRY  */ 01614000
*           /* EQUAL TO THIS ELEMENT                                 */ 01615000
*           /*                                                       */ 01616000
*           /*********************************************************/ 01617000
*                                                                  0509 01618000
*           DO S=1 BY 1 TO CCAPEMAX WHILE IOPMODND(S)^=IOPEOLST/*  0509 01619000
*                                      TILL                          */ 01620000
*                 &MODALMOD=OFF;    /* END OR A MATCH FOUND          */ 01621000
         LA    S,1                                                 0509 01622000
         B     @DE00509                                            0509 01623000
@DL00509 LR    @08,S                                               0509 01624000
         MH    @08,@CH00038                                        0509 01625000
         SLR   @05,@05                                             0509 01626000
         IC    @05,IOPMODND-9(@08,IOPPTR)                          0509 01627000
         CH    @05,@CH00714                                        0509 01628000
         BE    @DC00509                                            0509 01629000
         TM    MODALMOD,B'00010000'                                0509 01630000
         BNZ   @DC00509                                            0509 01631000
*             IF IOPLMODS(S)=ICTMNAME(1)/* MOD NAME FOUND AND TYPE IS   01632000
*                                      A                             */ 01633000
*                 &IOPMDIND(S)=IOPMDLMD THEN/* LMOD?                 */ 01634000
         L     @05,@PC00001+4                                      0510 01635000
         L     @05,ICMODPTR(,@05)                                  0510 01636000
         ST    @08,@TF00001                                        0510 01637000
         ALR   @08,IOPPTR                                          0510 01638000
         CLC   IOPLMODS-9(8,@08),ICTMNAME(@05)                     0510 01639000
         BNE   @RF00510                                            0510 01640000
         L     @08,@TF00001                                        0510 01641000
         SLR   @05,@05                                             0510 01642000
         IC    @05,IOPMDIND-9(@08,IOPPTR)                          0510 01643000
         CH    @05,@CH00070                                        0510 01644000
         BNE   @RF00510                                            0510 01645000
*               MODALMOD=ON;        /* INDICATE MOD FOUND AS LMOD    */ 01646000
         OI    MODALMOD,B'00010000'                                0511 01647000
*           END;                    /*                               */ 01648000
@RF00510 AH    S,@CH00070                                          0512 01649000
@DE00509 CH    S,CCAPEMAX(,CCAPTR)                                 0512 01650000
         BNH   @DL00509                                            0512 01651000
@DC00509 DS    0H                                                  0513 01652000
*           IF MODALMOD=OFF THEN    /* WAS ENTRY FOUND AS A LMOD?    */ 01653000
         TM    MODALMOD,B'00010000'                                0513 01654000
         BNZ   @RF00513                                            0513 01655000
*             DO;                   /* NO- THEN ADD IT AS A LMOD     */ 01656000
*               IF S+1^>CCAPEMAX THEN/*                              */ 01657000
         LA    @08,1                                               0515 01658000
         LR    @05,S                                               0515 01659000
         ALR   @05,@08                                             0515 01660000
         CH    @05,CCAPEMAX(,CCAPTR)                               0515 01661000
         BH    @RF00515                                            0515 01662000
*                 DO;               /*                               */ 01663000
*                                                                  0516 01664000
*                   /*************************************************/ 01665000
*                   /*                                               */ 01666000
*                   /* IF NOT FOUND AS A LMOD SUBENTRY ON THE LOCATED*/ 01667000
*                   /* CDS MOD ENTRY, THEN ADD IT IF SPACE ALLOWS    */ 01668000
*                   /*                                               */ 01669000
*                   /*************************************************/ 01670000
*                                                                  0517 01671000
*                   IOPLMODS(S)=ICTMNAME(1);/* ADD MOD NAME TO LIST     01672000
*                                      OF LMODS                      */ 01673000
         LR    @05,S                                               0517 01674000
         MH    @05,@CH00038                                        0517 01675000
         ST    @05,@TF00001                                        0517 01676000
         ALR   @05,IOPPTR                                          0517 01677000
         L     @03,@PC00001+4                                      0517 01678000
         L     @03,ICMODPTR(,@03)                                  0517 01679000
         MVC   IOPLMODS-9(8,@05),ICTMNAME(@03)                     0517 01680000
*                   IOPMDIND(S)=IOPMDLMD;/* INDICATE LMOD SUBENTRY 0518 01681000
*                                      TYPE                          */ 01682000
         L     @05,@TF00001                                        0518 01683000
         STC   @08,IOPMDIND-9(@05,IOPPTR)                          0518 01684000
*                   IOPMODND(S+1)=IOPEOLST;/* SET NEW END OF LIST  0519 01685000
*                                      MARKER                        */ 01686000
         LA    @08,255                                             0519 01687000
         L     @05,@TF00001                                        0519 01688000
         STC   @08,IOPMODND(@05,IOPPTR)                            0519 01689000
*                   IOPFUNCT=IOPSTOWR;/* INDICATE STOW REPLACE     0520 01690000
*                                      FUNCTION                      */ 01691000
         MVI   IOPFUNCT(IOPPTR),X'54'                              0520 01692000
*                                                                  0521 01693000
*                   /*************************************************/ 01694000
*                   /*                                               */ 01695000
*                   /* REPLACE THE UPDATED CDS MOD ENTRY             */ 01696000
*                   /*                                               */ 01697000
*                   /*************************************************/ 01698000
*                                                                  0521 01699000
*                   CALL HMASMIO(HMASMIOP);/* CALL SMP IO INTERFACE     01700000
*                                      MODULE                        */ 01701000
         ST    IOPPTR,@AL00001                                     0521 01702000
         L     @15,@CV01853                                        0521 01703000
         LA    @01,@AL00001                                        0521 01704000
         BALR  @14,@15                                             0521 01705000
*                 END;              /*                               */ 01706000
*               ELSE                                               0523 01707000
*                 IOPRETRN=IOPEXC;  /* IOPSPACE EXCEEDED- CAN'T ADD  */ 01708000
         B     @RC00515                                            0523 01709000
@RF00515 MVI   IOPRETRN(IOPPTR),X'08'                              0523 01710000
*             END;                  /*                               */ 01711000
*         END;                      /*                               */ 01712000
*       ELSE                                                       0526 01713000
*         IF IOPRETRN=IOPNTFND THEN /* IF NO MOD ENTRY FOUND THEN ADD*/ 01714000
         B     @RC00507                                            0526 01715000
@RF00507 CLI   IOPRETRN(IOPPTR),4                                  0526 01716000
         BNE   @RF00526                                            0526 01717000
*           DO;                     /*                               */ 01718000
*                                                                  0527 01719000
*             /*******************************************************/ 01720000
*             /*                                                     */ 01721000
*             /* IF NO CDS MOD ENTRY WAS FOUND, THEN CREATE A CDS MOD*/ 01722000
*             /* ENTRY FOR THIS ELEMENT INDICATING A LMOD SUBENTRY   */ 01723000
*             /* NAME EQUAL TO THE ELEMENT NAME BEING PROCESSED      */ 01724000
*             /*                                                     */ 01725000
*             /*******************************************************/ 01726000
*                                                                  0528 01727000
*             BLDACDSM=OFF;         /* PREVENT ANOTHER STOW          */ 01728000
         NI    BLDACDSM,B'11111011'                                0528 01729000
*             IOPMODDR=' ';         /* INIT MOD ENTRY DIRECTORY      */ 01730000
         MVI   IOPMODDR+1(IOPPTR),C' '                             0529 01731000
         MVC   IOPMODDR+2(22,IOPPTR),IOPMODDR+1(IOPPTR)            0529 01732000
         MVI   IOPMODDR(IOPPTR),C' '                               0529 01733000
*             IOPNTLVL=IOPMODLC;    /* CURENT LEVEL                  */ 01734000
         MVI   IOPNTLVL(IOPPTR),X'02'                              0530 01735000
*             IOPRMST=IOPRMST&&IOPRMST;/* ZERO OUT FIELD             */ 01736000
         XC    IOPRMST(1,IOPPTR),IOPRMST(IOPPTR)                   0531 01737000
*             IOPFMST=IOPFMST&&IOPFMST;/* ZERO OUT FIELD             */ 01738000
         XC    IOPFMST(1,IOPPTR),IOPFMST(IOPPTR)                   0532 01739000
*             IOPMODFX=' ';         /* INIT MOD ENTRY DATA FIELDS    */ 01740000
         MVI   IOPMODFX+1(IOPPTR),C' '                             0533 01741000
         MVC   IOPMODFX+2(78,IOPPTR),IOPMODFX+1(IOPPTR)            0533 01742000
         MVI   IOPMODFX(IOPPTR),C' '                               0533 01743000
*             IOPBUSMD=ICTPTFS(1);  /* SYSMOD CAUSING ADD OF ENTRY   */ 01744000
         L     @08,@PC00001+8                                      0534 01745000
         L     @08,ICPTFPTR(,@08)                                  0534 01746000
         MVC   IOPBUSMD(7,IOPPTR),ICTPTFS(@08)                     0534 01747000
*             IOPBUTYP=IOPBUADD;    /* INDICATE ADD OPERATION        */ 01748000
         MVI   IOPBUTYP(IOPPTR),X'01'                              0535 01749000
*             IOPMODF1=ICTMLEP1(1); /* FIRST BYTE OF LEPARMS FROM ICT*/ 01750000
         L     @08,@PC00001+4                                      0536 01751000
         L     @08,ICMODPTR(,@08)                                  0536 01752000
         MVC   IOPMODF1(1,IOPPTR),ICTMLEP1(@08)                    0536 01753000
*             IOPMODF2=ICTMLEP2(1); /* LAST BYTE OF LEPARMS FROM ICT */ 01754000
         MVC   IOPMODF2(1,IOPPTR),ICTMLEP2(@08)                    0537 01755000
*             IOPMODF3=IOPMODF3&&IOPMODF3;/* ZERO OUT FIELD          */ 01756000
         XC    IOPMODF3(1,IOPPTR),IOPMODF3(IOPPTR)                 0538 01757000
*             IOPMODF4=IOPMODF4&&IOPMODF4;/* ZERO OUT FIELD          */ 01758000
         XC    IOPMODF4(1,IOPPTR),IOPMODF4(IOPPTR)                 0539 01759000
*             IOPDLIB=MCBEDIST;     /* DISTRIBUTION LIB FROM MCB     */ 01760000
         L     @03,@PC00001+12                                     0540 01761000
         L     @03,ELMCBPTR(,@03)                                  0540 01762000
         MVC   IOPDLIB(8,IOPPTR),MCBEDIST(@03)                     0540 01763000
*             IOPLMODS(1)=ICTMNAME(1);/* MOD NAME AS LMOD SUBENTRY   */ 01764000
         MVC   IOPLMODS(8,IOPPTR),ICTMNAME(@08)                    0541 01765000
*             IOPMDIND(1)=IOPMDLMD; /* LOAD MOD TYPE ENTRY           */ 01766000
         MVI   IOPMDIND(IOPPTR),X'01'                              0542 01767000
*             IOPMODND(2)=IOPEOLST; /* SET END OF LIST MARKER        */ 01768000
         MVI   IOPMODND+9(IOPPTR),X'FF'                            0543 01769000
*             IOPFUNCT=IOPSTOWR;    /* INDICATE STOW REPLACE FUNCTION*/ 01770000
*                                                                  0544 01771000
         MVI   IOPFUNCT(IOPPTR),X'54'                              0544 01772000
*             /*******************************************************/ 01773000
*             /*                                                     */ 01774000
*             /* ADD NEW MOD ENTRY TO THE CDS FOR THIS ELEMENT       */ 01775000
*             /*                                                     */ 01776000
*             /*******************************************************/ 01777000
*                                                                  0545 01778000
*             CALL HMASMIO(HMASMIOP);/* CALL SMP IO INTERFACE MODULE */ 01779000
         ST    IOPPTR,@AL00001                                     0545 01780000
         L     @15,@CV01853                                        0545 01781000
         LA    @01,@AL00001                                        0545 01782000
         BALR  @14,@15                                             0545 01783000
*           END;                    /*                               */ 01784000
*       IF IOPRETRN=IOPGOOD THEN    /*                               */ 01785000
@RF00526 DS    0H                                                  0547 01786000
@RC00507 CLI   IOPRETRN(IOPPTR),0                                  0547 01787000
         BNE   @RF00547                                            0547 01788000
*         DO;                       /*                               */ 01789000
*           IOPFUNCT=IOPLOC;        /* INDICATE LOCATE FUNCTION      */ 01790000
         MVI   IOPFUNCT(IOPPTR),X'03'                              0549 01791000
*           IOPTYPE=IOPLMD;         /* INDICATE LMOD TYPE ENTRY      */ 01792000
         MVI   IOPTYPE(IOPPTR),X'02'                               0550 01793000
*           IOPNAME=ICTMNAME(1);    /* MOD NAME BEING PROCESSED      */ 01794000
*                                                                  0551 01795000
         L     @08,@PC00001+4                                      0551 01796000
         L     @08,ICMODPTR(,@08)                                  0551 01797000
         MVC   IOPNAME(8,IOPPTR),ICTMNAME(@08)                     0551 01798000
*           /*********************************************************/ 01799000
*           /*                                                       */ 01800000
*           /* ATTEMPT TO LOCATE A CDS LMOD ENTRY FOR THIS ELEMENT   */ 01801000
*           /*                                                       */ 01802000
*           /*********************************************************/ 01803000
*                                                                  0552 01804000
*           CALL HMASMIO(HMASMIOP); /* CALL SMP IO INTERFACE MODULE  */ 01805000
         ST    IOPPTR,@AL00001                                     0552 01806000
         L     @15,@CV01853                                        0552 01807000
         LA    @01,@AL00001                                        0552 01808000
         BALR  @14,@15                                             0552 01809000
*           IF IOPRETRN=IOPNTFND THEN/* WAS A LMOD ENTRY FOUND FOR 0553 01810000
*                                      MOD                           */ 01811000
         CLI   IOPRETRN(IOPPTR),4                                  0553 01812000
         BNE   @RF00553                                            0553 01813000
*             DO;                   /*                               */ 01814000
*                                                                  0554 01815000
*               /*****************************************************/ 01816000
*               /*                                                   */ 01817000
*               /* IF NO CDS LMOD ENTRY WAS FOUND, THEN CREATE A CDS */ 01818000
*               /* LMOD ENTRY FOR THIS ELEMENT INDICATING A LMOD     */ 01819000
*               /* SUBENTRY NAME EQUAL TO THE ELEMENT NAME BEING     */ 01820000
*               /* PROCESSED                                         */ 01821000
*               /*                                                   */ 01822000
*               /*****************************************************/ 01823000
*                                                                  0555 01824000
*               IOPLMDNT=IOPLMDNT&&IOPLMDNT;/* CLEAR FIELD           */ 01825000
         XC    IOPLMDNT(104,IOPPTR),IOPLMDNT(IOPPTR)               0555 01826000
*               IOPLMDFX=' ';       /* CLEAR FIELD                   */ 01827000
         MVI   IOPLMDFX+1(IOPPTR),C' '                             0556 01828000
         MVC   IOPLMDFX+2(78,IOPPTR),IOPLMDFX+1(IOPPTR)            0556 01829000
         MVI   IOPLMDFX(IOPPTR),C' '                               0556 01830000
*               IOPNTLVL=IOPLMDLC;  /* CURRENT                       */ 01831000
         MVI   IOPNTLVL(IOPPTR),X'02'                              0557 01832000
*               IOPBUSMD=ICTPTFS(1);/* SYSMOD CAUSING ADD OF ENTRY   */ 01833000
         L     @08,@PC00001+8                                      0558 01834000
         L     @08,ICPTFPTR(,@08)                                  0558 01835000
         MVC   IOPBUSMD(7,IOPPTR),ICTPTFS(@08)                     0558 01836000
*               IOPBUTYP=IOPBUADD;  /* INDICATE ADD OPERATION        */ 01837000
         MVI   IOPBUTYP(IOPPTR),X'01'                              0559 01838000
*               IOPLMDF1=ICTMLEP1(1);/* FIRST BYTE OF LEPARM FROM ICT*/ 01839000
         L     @08,@PC00001+4                                      0560 01840000
         L     @08,ICMODPTR(,@08)                                  0560 01841000
         MVC   IOPLMDF1(1,IOPPTR),ICTMLEP1(@08)                    0560 01842000
*               IOPLMDF2=ICTMLEP2(1);/* LAST BYTE OF LEPARMS FROM ICT*/ 01843000
         MVC   IOPLMDF2(1,IOPPTR),ICTMLEP2(@08)                    0561 01844000
*               IF IOPLMDF1^=ALLOFF /* ANY LEPARMS ENTERED ON ++MOD? */ 01845000
*                   |IOPLMDF2^=ALLOFF THEN/* YES- SET BIT ON         */ 01846000
         CLI   IOPLMDF1(IOPPTR),B'00000000'                        0562 01847000
         BNE   @RT00562                                            0562 01848000
         CLI   IOPLMDF2(IOPPTR),B'00000000'                        0562 01849000
         BE    @RF00562                                            0562 01850000
@RT00562 DS    0H                                                  0563 01851000
*                 IOPLINK=ON;       /* LINK-EDIT PARMS OBTAINED      */ 01852000
         OI    IOPLINK(IOPPTR),B'01000000'                         0563 01853000
*               IOPCOPY=ON;         /* COPIED AT SYSGEN              */ 01854000
@RF00562 OI    IOPCOPY(IOPPTR),B'10000000'                         0564 01855000
*                                                                  0565 01856000
*               /*****************************************************/ 01857000
*               /*                                                   */ 01858000
*               /* INDICATE THE TARGET SYSLIB SUBENTRIES SAVED ABOVE */ 01859000
*               /* FROM THE CDS DLIB ENTRY                           */ 01860000
*               /*                                                   */ 01861000
*               /*****************************************************/ 01862000
*                                                                  0565 01863000
*               IF SYSLIBS(1)=BLANKS THEN/* ANY SYSLIB NAMES SAVED?  */ 01864000
         CLC   SYSLIBS(8),BLANKS                                   0565 01865000
         BNE   @RF00565                                            0565 01866000
*                 IOPLMDND(1)=IOPEOLST;/* NO-SET END OF LIST MARKER  */ 01867000
         MVI   IOPLMDND(IOPPTR),X'FF'                              0566 01868000
*               ELSE                /*                               */ 01869000
*                 DO;               /*                               */ 01870000
         B     @RC00565                                            0567 01871000
@RF00565 DS    0H                                                  0568 01872000
*                   IOPLSYS(1)=SYSLIBS(1);/* PUT IN FIRST SYSLIB NAME*/ 01873000
         MVC   IOPLSYS(8,IOPPTR),SYSLIBS                           0568 01874000
*                   IOPLMIND(1)=IOPLMSYS;/* INDICATE SYSLIB NAME     */ 01875000
         MVI   IOPLMIND(IOPPTR),X'01'                              0569 01876000
*                 END;              /*                               */ 01877000
*               IF SYSLIBS(2)=BLANKS THEN/* ANY SECOND SYSLIB NAME?  */ 01878000
@RC00565 CLC   SYSLIBS+8(8),BLANKS                                 0571 01879000
         BNE   @RF00571                                            0571 01880000
*                 IOPLMDND(2)=IOPEOLST;/* NO-SET END OF LIST MARKER  */ 01881000
         MVI   IOPLMDND+9(IOPPTR),X'FF'                            0572 01882000
*               ELSE                /*                               */ 01883000
*                 DO;               /*                               */ 01884000
         B     @RC00571                                            0573 01885000
@RF00571 DS    0H                                                  0574 01886000
*                   IOPLSYS(2)=SYSLIBS(2);/* PUT IN SECOND SYSLIB  0574 01887000
*                                      NAME                          */ 01888000
         MVC   IOPLSYS+9(8,IOPPTR),SYSLIBS+8                       0574 01889000
*                   IOPLMIND(2)=IOPLMSYS;/* INDICATE SYSLIB NAME     */ 01890000
         MVI   IOPLMIND+9(IOPPTR),X'01'                            0575 01891000
*                   IOPLMDND(3)=IOPEOLST;/* SET END OF LIST MARKER   */ 01892000
         MVI   IOPLMDND+18(IOPPTR),X'FF'                           0576 01893000
*                 END;              /*                               */ 01894000
*                                                                  0577 01895000
*               /*****************************************************/ 01896000
*               /*                                                   */ 01897000
*               /* NOTE: THE TARGET SYSLIB SUBENTRIES APPEAR IN THE  */ 01898000
*               /* FIRST DATA RECORD OF THE MEMBER. POINT TO THIS    */ 01899000
*               /* AREA IN THE IOP AND DO A WRITE OF THIS RECORD.    */ 01900000
*               /*                                                   */ 01901000
*               /*****************************************************/ 01902000
*                                                                  0578 01903000
*               SAVBUFAD=IOPBUFAD;  /* SAVE BUFFER ADDRESS           */ 01904000
@RC00571 L     SAVBUFAD,IOPBUFAD(,IOPPTR)                          0578 01905000
*               IOPBUFAD=ADDR(IOPLMDFX);/* POINT TO FIRST RECORD OF     01906000
*                                      MEM                           */ 01907000
         LA    @08,IOPLMDFX(,IOPPTR)                               0579 01908000
         ST    @08,IOPBUFAD(,IOPPTR)                               0579 01909000
*               IOPFUNCT=IOPWRITE;  /* INDICATE WRITE OPERATION      */ 01910000
         MVI   IOPFUNCT(IOPPTR),X'51'                              0580 01911000
*                                                                  0581 01912000
*               /*****************************************************/ 01913000
*               /*                                                   */ 01914000
*               /* WRITE THE FIRST DATA RECORD WITH THE TARGET SYSLIB*/ 01915000
*               /* SUBENTRIES                                        */ 01916000
*               /*                                                   */ 01917000
*               /*****************************************************/ 01918000
*                                                                  0581 01919000
*               CALL HMASMIO(HMASMIOP);/* CALL SMP IO INTERFACE    0581 01920000
*                                      MODULE                        */ 01921000
         ST    IOPPTR,@AL00001                                     0581 01922000
         L     @15,@CV01853                                        0581 01923000
         LA    @01,@AL00001                                        0581 01924000
         BALR  @14,@15                                             0581 01925000
*               IOPBUFAD=SAVBUFAD;  /* RESTORE SAVED BUFFER ADDRESS  */ 01926000
         ST    SAVBUFAD,IOPBUFAD(,IOPPTR)                          0582 01927000
*               IF IOPRETRN=IOPGOOD THEN/* WRITE OF DATA RECORD OK?  */ 01928000
         CLI   IOPRETRN(IOPPTR),0                                  0583 01929000
         BNE   @RF00583                                            0583 01930000
*                 DO;               /*                               */ 01931000
*                   IOPFUNCT=IOPSTOWR;/* INDICATE STOW REPLACE     0585 01932000
*                                      FUNCTION                      */ 01933000
*                                                                  0585 01934000
         MVI   IOPFUNCT(IOPPTR),X'54'                              0585 01935000
*                   /*************************************************/ 01936000
*                   /*                                               */ 01937000
*                   /* ADD THE DIRECTORY ENTRY FOR THE NEW CDS LMOD  */ 01938000
*                   /* ENTRY                                         */ 01939000
*                   /*                                               */ 01940000
*                   /*************************************************/ 01941000
*                                                                  0586 01942000
*                   CALL HMASMIO(HMASMIOP);/* CALL SMP IO INTERFACE     01943000
*                                      MODULE                        */ 01944000
         ST    IOPPTR,@AL00001                                     0586 01945000
         L     @15,@CV01853                                        0586 01946000
         LA    @01,@AL00001                                        0586 01947000
         BALR  @14,@15                                             0586 01948000
*                 END;              /*                               */ 01949000
*             END;                  /*                               */ 01950000
@RF00583 DS    0H                                                  0589 01951000
*         END;                      /*                               */ 01952000
@RF00553 DS    0H                                                  0590 01953000
*     END;                          /*                               */ 01954000
@RF00547 DS    0H                                                  0591 01955000
*   IF IOPRETRN=IOPNTFND THEN       /* IF ENTRY NOT FOUND THEN SET TO*/ 01956000
@RF00496 CLI   IOPRETRN(IOPPTR),4                                  0591 01957000
         BNE   @RF00591                                            0591 01958000
*     IOPRETRN=IOPGOOD;             /* CONTINUE PROCESSING           */ 01959000
         MVI   IOPRETRN(IOPPTR),X'00'                              0592 01960000
*   END TM1PROC6;                   /*                               */ 01961000
@EL00008 DS    0H                                                  0593 01962000
@EF00008 DS    0H                                                  0593 01963000
@ER00008 LM    @14,@12,@SA00008                                    0593 01964000
         BR    @14                                                 0593 01965000
*TM1PROC7:                                                         0594 01966000
*   PROC;                           /*                               */ 01967000
TM1PROC7 STM   @14,@02,@SA00009                                    0594 01968000
         STM   @04,@12,@SA00009+20                                 0594 01969000
*   RFY                                                            0595 01970000
*     HMASMGTP BASED(TBLXLMGT);     /*                               */ 01971000
*   RFY                                                            0596 01972000
*     LMMRECRD BASED(GTPBUFAD);     /*                               */ 01973000
*                                                                  0596 01974000
*   /*****************************************************************/ 01975000
*   /*                                                               */ 01976000
*   /* FILL IN GTP FUNCTION AND BUILD ENTRY TO ADD BY GTA            */ 01977000
*   /*                                                               */ 01978000
*   /*****************************************************************/ 01979000
*                                                                  0597 01980000
*   GTPFUNCT=GTPADD;                /* INDICATE ADD OPERATION        */ 01981000
         L     @08,@PC00001                                        0597 01982000
         L     @08,TBLXLMGT(,@08)                                  0597 01983000
         MVI   GTPFUNCT(@08),X'04'                                 0597 01984000
*   LMMSMD=ICTPTFS(1);              /* FILL IN CAUSING SYSMOD        */ 01985000
         L     @15,GTPBUFAD(,@08)                                  0598 01986000
         L     @14,@PC00001+8                                      0598 01987000
         L     @01,ICPTFPTR(,@14)                                  0598 01988000
         MVC   LMMSMD(7,@15),ICTPTFS(@01)                          0598 01989000
*   LMMMNAME=ICTMNAME(1);           /* MOD WHICH REQUIRES LMOD       */ 01990000
*                                                                  0599 01991000
         L     @14,@PC00001+4                                      0599 01992000
         L     @14,ICMODPTR(,@14)                                  0599 01993000
         MVC   LMMMNAME(8,@15),ICTMNAME(@14)                       0599 01994000
*   /*****************************************************************/ 01995000
*   /*                                                               */ 01996000
*   /* DETERMINE FUNCTION BEING EXECUTED                             */ 01997000
*   /*                                                               */ 01998000
*   /*****************************************************************/ 01999000
*                                                                  0600 02000000
*   IF CCAACCPT=ON THEN             /* DO FOR ACCEPT FUNCTION        */ 02001000
*                                                                  0600 02002000
         TM    CCAACCPT(CCAPTR),B'00100000'                        0600 02003000
         BNO   @RF00600                                            0600 02004000
*     /***************************************************************/ 02005000
*     /*                                                             */ 02006000
*     /* DO FOR ACCEPT FUNCTION                                      */ 02007000
*     /*                                                             */ 02008000
*     /***************************************************************/ 02009000
*                                                                  0601 02010000
*     DO;                           /*                               */ 02011000
*       LMMLNAME=ICTMNAME(1);       /* MOD NAME IS ALSO LMOD NAME    */ 02012000
         MVC   LMMLNAME(8,@15),ICTMNAME(@14)                       0602 02013000
*       CALL HMASMGTA(HMASMGTP);    /* CALL GENERAL TABLE BUILD MOD  */ 02014000
         ST    @08,@AL00001                                        0603 02015000
         L     @15,@CV01857                                        0603 02016000
         LA    @01,@AL00001                                        0603 02017000
         BALR  @14,@15                                             0603 02018000
*       TM1HIRC=MAX(TM1HIRC,GTPRETRN);/* PICK UP HIGHEST RETURN CODE */ 02019000
         L     @08,@PC00001                                        0604 02020000
         L     @08,TBLXLMGT(,@08)                                  0604 02021000
         SLR   @15,@15                                             0604 02022000
         IC    @15,GTPRETRN(,@08)                                  0604 02023000
         CR    TM1HIRC,@15                                         0604 02024000
         BNL   *+6                                                      02025000
         LR    TM1HIRC,@15                                         0604 02026000
*     END;                          /*                               */ 02027000
*   ELSE                            /* DO FOR APPLY OR RESTORE       */ 02028000
*                                                                  0606 02029000
*     /***************************************************************/ 02030000
*     /*                                                             */ 02031000
*     /* DO FOR APPLY OR RESTORE FUNCTION                            */ 02032000
*     /*                                                             */ 02033000
*     /***************************************************************/ 02034000
*                                                                  0606 02035000
*     DO;                           /*                               */ 02036000
         B     @RC00600                                            0606 02037000
@RF00600 DS    0H                                                  0607 02038000
*       IOPFUNCT=IOPLOC;            /*                               */ 02039000
         MVI   IOPFUNCT(IOPPTR),X'03'                              0607 02040000
*       IOPTYPE=IOPMOD;             /*                               */ 02041000
         MVI   IOPTYPE(IOPPTR),X'05'                               0608 02042000
*       IOPNAME=ICTMNAME(1);        /*                               */ 02043000
         L     @08,@PC00001+4                                      0609 02044000
         L     @08,ICMODPTR(,@08)                                  0609 02045000
         MVC   IOPNAME(8,IOPPTR),ICTMNAME(@08)                     0609 02046000
*                                                                  0610 02047000
*       /*************************************************************/ 02048000
*       /*                                                           */ 02049000
*       /* REREAD THE CDS MOD ENTRY FOR THIS ELEMENT                 */ 02050000
*       /*                                                           */ 02051000
*       /*************************************************************/ 02052000
*                                                                  0610 02053000
*       CALL HMASMIO(HMASMIOP);     /* CALL SMP IO INTERFACE MODULE  */ 02054000
         ST    IOPPTR,@AL00001                                     0610 02055000
         L     @15,@CV01853                                        0610 02056000
         LA    @01,@AL00001                                        0610 02057000
         BALR  @14,@15                                             0610 02058000
*       IF IOPRETRN=IOPGOOD THEN    /*                               */ 02059000
         CLI   IOPRETRN(IOPPTR),0                                  0611 02060000
         BNE   @RF00611                                            0611 02061000
*         DO;                       /*                               */ 02062000
*                                                                  0612 02063000
*           /*********************************************************/ 02064000
*           /*                                                       */ 02065000
*           /* ADD A RECORD TO THE GTA FILE FOR EACH LMOD SUBENTRY IN*/ 02066000
*           /* THE CDS MOD ENTRY FOR THIS ELEMENT.                   */ 02067000
*           /*                                                       */ 02068000
*           /*********************************************************/ 02069000
*                                                                  0613 02070000
*           DO L=1 BY 1 WHILE IOPMODND(L)^=IOPEOLST/* TO END OF LIST    02071000
*                                      OR                            */ 02072000
*                 &TM1HIRC=IOPGOOD; /* ERROR ENCOUNTERED             */ 02073000
         LA    L,1                                                 0613 02074000
         B     @DE00613                                            0613 02075000
@DL00613 DS    0H                                                  0614 02076000
*             IF IOPMDIND(L)=IOPMDLMD THEN/* IS TYPE LMOD ENTRY TYPE?*/ 02077000
         LR    @08,L                                               0614 02078000
         MH    @08,@CH00038                                        0614 02079000
         SLR   @05,@05                                             0614 02080000
         IC    @05,IOPMDIND-9(@08,IOPPTR)                          0614 02081000
         CH    @05,@CH00070                                        0614 02082000
         BNE   @RF00614                                            0614 02083000
*               DO;                 /* YES- DO FOR LMOD TYPES ONLY   */ 02084000
*                 LMMLNAME=IOPLMODS(L);/* FILL IN LMOD NAME          */ 02085000
*                                                                  0616 02086000
         L     @05,@PC00001                                        0616 02087000
         L     @05,TBLXLMGT(,@05)                                  0616 02088000
         L     @01,GTPBUFAD(,@05)                                  0616 02089000
         ALR   @08,IOPPTR                                          0616 02090000
         MVC   LMMLNAME(8,@01),IOPLMODS-9(@08)                     0616 02091000
*                 /***************************************************/ 02092000
*                 /*                                                 */ 02093000
*                 /* ADD A GTA FILE ENTRY FOR THE LMOD SUBENTRY      */ 02094000
*                 /*                                                 */ 02095000
*                 /***************************************************/ 02096000
*                                                                  0617 02097000
*                 CALL HMASMGTA(HMASMGTP);/* CALL TABLE BUILD MOD    */ 02098000
         ST    @05,@AL00001                                        0617 02099000
         L     @15,@CV01857                                        0617 02100000
         LA    @01,@AL00001                                        0617 02101000
         BALR  @14,@15                                             0617 02102000
*                 TM1HIRC=MAX(TM1HIRC,GTPRETRN);/* PICK UP HIGEST RC */ 02103000
         L     @08,@PC00001                                        0618 02104000
         L     @08,TBLXLMGT(,@08)                                  0618 02105000
         SLR   @05,@05                                             0618 02106000
         IC    @05,GTPRETRN(,@08)                                  0618 02107000
         CR    TM1HIRC,@05                                         0618 02108000
         BNL   *+6                                                      02109000
         LR    TM1HIRC,@05                                         0618 02110000
*               END;                /*                               */ 02111000
*           END;                    /*                               */ 02112000
@RF00614 AH    L,@CH00070                                          0620 02113000
@DE00613 LR    @08,L                                               0620 02114000
         MH    @08,@CH00038                                        0620 02115000
         SLR   @05,@05                                             0620 02116000
         IC    @05,IOPMODND-9(@08,IOPPTR)                          0620 02117000
         CH    @05,@CH00714                                        0620 02118000
         BE    @DC00613                                            0620 02119000
         CH    TM1HIRC,@CH00088                                    0620 02120000
         BE    @DL00613                                            0620 02121000
@DC00613 DS    0H                                                  0621 02122000
*         END;                      /*                               */ 02123000
*     END;                          /*                               */ 02124000
@RF00611 DS    0H                                                  0623 02125000
*   IF IOPRETRN=IOPNOTFD THEN       /*                               */ 02126000
@RC00600 CLI   IOPRETRN(IOPPTR),4                                  0623 02127000
         BNE   @RF00623                                            0623 02128000
*     IOPRETRN=IOPGOOD;             /*                               */ 02129000
         MVI   IOPRETRN(IOPPTR),X'00'                              0624 02130000
*   END TM1PROC7;                   /*                               */ 02131000
@EL00009 DS    0H                                                  0625 02132000
@EF00009 DS    0H                                                  0625 02133000
@ER00009 LM    @14,@02,@SA00009                                    0625 02134000
         LM    @04,@12,@SA00009+20                                 0625 02135000
         BR    @14                                                 0625 02136000
*TM1PROC8:                                                         0626 02137000
*   PROC;                                                          0626 02138000
TM1PROC8 STM   @14,@02,@SA00010                                    0626 02139000
         STM   @04,@12,@SA00010+20                                 0626 02140000
*   IOPRETRN=IOPGOOD;               /* CLEAR FIELD CALLER CHECKS UPON   02141000
*                                      RETURN                        */ 02142000
*                                                                  0627 02143000
         MVI   IOPRETRN(IOPPTR),X'00'                              0627 02144000
*   /*****************************************************************/ 02145000
*   /*                                                               */ 02146000
*   /* SEARCH THE ICT MODULE SECTION FOR ANOTHER VERSION OF THIS     */ 02147000
*   /* MODULE WHICH ALREADY HAS A MODID LIST BUILT. IF FOUND, THEN   */ 02148000
*   /* CHAIN THIS ICT MOD ENTRY TO THAT ENTRY'S MODID LIST.          */ 02149000
*   /*                                                               */ 02150000
*   /*****************************************************************/ 02151000
*                                                                  0628 02152000
*   ICMODPTR->ICTMICHN(1)=ZERO;     /* ZERO CURRENT ENTRY POINTER    */ 02153000
         L     @08,@PC00001+4                                      0628 02154000
         L     @08,ICMODPTR(,@08)                                  0628 02155000
         SLR   @15,@15                                             0628 02156000
         ST    @15,ICTMICHN(,@08)                                  0628 02157000
*   RFY                                                            0629 02158000
*     ICTMOD BASED(CCAICMOD);       /* BASE TO FULL ICT MOD SECTION  */ 02159000
*   DO L=1 BY 1 WHILE ICTMEND(L)^=ICTENDNT/* TILL END OF ICT MOD     */ 02160000
*         &ICTMATCH=OFF;            /* SECTION OR MATCH FOUND        */ 02161000
         LA    L,1                                                 0630 02162000
         B     @DE00630                                            0630 02163000
@DL00630 DS    0H                                                  0631 02164000
*     IF ICTMNAME(L)=ICMODPTR->ICTMNAME(1)/* SAME ELEMENT NAMES      */ 02165000
*         &ICTMICHN(L)^=ZERO        /* AND NOT SAME ENTRY            */ 02166000
*         &((ICTMMOD(L)=ON&ICMODPTR->ICTMMOD(1)=ON)/* BOTH MODS      */ 02167000
*         |(ICTMZAP(L)=ON&ICMODPTR->ICTMZAP(1)=ON)/* BOTH ZAPS       */ 02168000
*         |(ICTMZAP(L)=ON&ICMODPTR->ICTMMOD(1)=ON)/* ZAP - MOD       */ 02169000
*         |(ICTMMOD(L)=ON&ICMODPTR->ICTMZAP(1)=ON))/* MOD - ZAP      */ 02170000
*       THEN                                                       0631 02171000
         LR    @08,L                                               0631 02172000
         MH    @08,@CH01952                                        0631 02173000
         L     @05,CCAICMOD(,CCAPTR)                               0631 02174000
         L     @15,@PC00001+4                                      0631 02175000
         L     @15,ICMODPTR(,@15)                                  0631 02176000
         ST    @08,@TF00001                                        0631 02177000
         ALR   @08,@05                                             0631 02178000
         AL    @08,@CF01965                                        0631 02179000
         CLC   ICTMNAME(8,@08),ICTMNAME(@15)                       0631 02180000
         BNE   @RF00631                                            0631 02181000
         L     @08,@TF00001                                        0631 02182000
         AL    @08,@CF01966                                        0631 02183000
         L     @08,ICTMICHN-104(@08,@05)                           0631 02184000
         LTR   @08,@08                                             0631 02185000
         BZ    @RF00631                                            0631 02186000
         AL    @05,@TF00001                                        0631 02187000
         AL    @05,@CF01967                                        0631 02188000
         TM    ICTMMOD-9(@05),B'10000000'                          0631 02189000
         BNO   @GL00040                                            0631 02190000
         TM    ICTMMOD(@15),B'10000000'                            0631 02191000
         BO    @RT00631                                            0631 02192000
@GL00040 LR    @08,L                                               0631 02193000
         MH    @08,@CH01952                                        0631 02194000
         L     @05,CCAICMOD(,CCAPTR)                               0631 02195000
         ALR   @05,@08                                             0631 02196000
         AL    @05,@CF01967                                        0631 02197000
         TM    ICTMZAP-9(@05),B'00100000'                          0631 02198000
         BNO   @GL00039                                            0631 02199000
         L     @08,@PC00001+4                                      0631 02200000
         L     @08,ICMODPTR(,@08)                                  0631 02201000
         TM    ICTMZAP(@08),B'00100000'                            0631 02202000
         BO    @RT00631                                            0631 02203000
@GL00039 LR    @08,L                                               0631 02204000
         MH    @08,@CH01952                                        0631 02205000
         L     @05,CCAICMOD(,CCAPTR)                               0631 02206000
         ALR   @05,@08                                             0631 02207000
         AL    @05,@CF01967                                        0631 02208000
         TM    ICTMZAP-9(@05),B'00100000'                          0631 02209000
         BNO   @GL00038                                            0631 02210000
         L     @08,@PC00001+4                                      0631 02211000
         L     @08,ICMODPTR(,@08)                                  0631 02212000
         TM    ICTMMOD(@08),B'10000000'                            0631 02213000
         BO    @RT00631                                            0631 02214000
@GL00038 LR    @08,L                                               0631 02215000
         MH    @08,@CH01952                                        0631 02216000
         L     @05,CCAICMOD(,CCAPTR)                               0631 02217000
         ALR   @05,@08                                             0631 02218000
         AL    @05,@CF01967                                        0631 02219000
         TM    ICTMMOD-9(@05),B'10000000'                          0631 02220000
         BNO   @RF00631                                            0631 02221000
         L     @08,@PC00001+4                                      0631 02222000
         L     @08,ICMODPTR(,@08)                                  0631 02223000
         TM    ICTMZAP(@08),B'00100000'                            0631 02224000
         BNO   @RF00631                                            0631 02225000
@RT00631 DS    0H                                                  0632 02226000
*       DO;                         /*                               */ 02227000
*         ICTMATCH=ON;              /* INDICATE ANOTHER ENTRY FOUND  */ 02228000
         OI    ICTMATCH,B'00001000'                                0633 02229000
*         ICMODPTR->ICTMICHN(1)=ICTMICHN(L);/* CHAIN TO EXISTING   0634 02230000
*                                      MODID LIST POINTER            */ 02231000
         L     @08,@PC00001+4                                      0634 02232000
         L     @08,ICMODPTR(,@08)                                  0634 02233000
         LR    @05,L                                               0634 02234000
         MH    @05,@CH01952                                        0634 02235000
         L     @15,CCAICMOD(,CCAPTR)                               0634 02236000
         LA    @01,0(@05,@15)                                      0634 02237000
         AL    @01,@CF01966                                        0634 02238000
         L     @14,ICTMICHN-104(,@01)                              0634 02239000
         ST    @14,ICTMICHN(,@08)                                  0634 02240000
*         ICMODPTR->ICTMICHA(1)=ICTMICHA(L);/* CHAIN TO EXISTING   0635 02241000
*                                      MODID LIST POINTER            */ 02242000
         AL    @15,@CF01969                                        0635 02243000
         L     @05,ICTMICHA-108(@05,@15)                           0635 02244000
         ST    @05,ICTMICHA(,@08)                                  0635 02245000
*       END;                                                       0636 02246000
*   END;                                                           0637 02247000
*                                                                  0637 02248000
@RF00631 AH    L,@CH00070                                          0637 02249000
@DE00630 LR    @08,L                                               0637 02250000
         MH    @08,@CH01952                                        0637 02251000
         L     @05,CCAICMOD(,CCAPTR)                               0637 02252000
         AL    @05,@CF01965                                        0637 02253000
         L     @08,ICTMEND(@08,@05)                                0637 02254000
         CL    @08,ICTENDNT                                        0637 02255000
         BE    @DC00630                                            0637 02256000
         TM    ICTMATCH,B'00001000'                                0637 02257000
         BZ    @DL00630                                            0637 02258000
@DC00630 DS    0H                                                  0638 02259000
*   /*****************************************************************/ 02260000
*   /*                                                               */ 02261000
*   /* IF NO CHAIN WAS AVAILABLE FROM ANOTHER VERSION TO HOOK ON TO, */ 02262000
*   /* THEN CALL HMASMIO TO READ THE (A)CDS MODULE ENTRY FOR THIS    */ 02263000
*   /* ELEMENT SO THAT HMASMTID CAN BE CALLED TO BUILD A MODID LIST  */ 02264000
*   /* FOR THIS ELEMENT.                                             */ 02265000
*   /*                                                               */ 02266000
*   /*****************************************************************/ 02267000
*                                                                  0638 02268000
*   IF ICTMATCH=OFF THEN            /* WAS A CHAIN HOOKED ON TO?     */ 02269000
         TM    ICTMATCH,B'00001000'                                0638 02270000
         BNZ   @RF00638                                            0638 02271000
*     DO;                           /*                               */ 02272000
*       IOPFUNCT=IOPLOC;            /* INDICATE LOCATE FUNCTION      */ 02273000
         MVI   IOPFUNCT(IOPPTR),X'03'                              0640 02274000
*       IOPTYPE=IOPMOD;             /* MODULE TYPE ENTRY             */ 02275000
*                                                                  0641 02276000
         MVI   IOPTYPE(IOPPTR),X'05'                               0641 02277000
*       /*************************************************************/ 02278000
*       /*                                                           */ 02279000
*       /* DETERMINE FUNCTION TO SET UP DATASET (A)CDS               */ 02280000
*       /*                                                           */ 02281000
*       /*************************************************************/ 02282000
*                                                                  0642 02283000
*       IF CCAACCPT=ON THEN         /* ACCEPT FUNCTION?              */ 02284000
         TM    CCAACCPT(CCAPTR),B'00100000'                        0642 02285000
         BNO   @RF00642                                            0642 02286000
*         IOPDSID=IOPACDS;          /* YES- ACDS DATASET             */ 02287000
         MVI   IOPDSID(IOPPTR),X'0C'                               0643 02288000
*       ELSE                                                       0644 02289000
*         IOPDSID=IOPCDS;           /* INDICATE CDS DATASET          */ 02290000
         B     @RC00642                                            0644 02291000
@RF00642 MVI   IOPDSID(IOPPTR),X'02'                               0644 02292000
*       IOPNAME=ICMODPTR->ICTMNAME(1);/* MODULE ELEMENT ENTRY        */ 02293000
@RC00642 L     @08,@PC00001+4                                      0645 02294000
         L     @08,ICMODPTR(,@08)                                  0645 02295000
         MVC   IOPNAME(8,IOPPTR),ICTMNAME(@08)                     0645 02296000
*                                                                  0646 02297000
*       /*************************************************************/ 02298000
*       /*                                                           */ 02299000
*       /* LOCATE THE MODULE ELEMENT ON THE (A)CDS                   */ 02300000
*       /*                                                           */ 02301000
*       /*************************************************************/ 02302000
*                                                                  0646 02303000
*       CALL HMASMIO(HMASMIOP);     /* CALL SMP IO INTERFACE MODULE  */ 02304000
         ST    IOPPTR,@AL00001                                     0646 02305000
         L     @15,@CV01853                                        0646 02306000
         LA    @01,@AL00001                                        0646 02307000
         BALR  @14,@15                                             0646 02308000
*       IF IOPRETRN=IOPGOOD THEN    /* WAS MODULE ENTRY FOUND        */ 02309000
         CLI   IOPRETRN(IOPPTR),0                                  0647 02310000
         BNE   @RF00647                                            0647 02311000
*         DO;                       /*                               */ 02312000
*                                                                  0648 02313000
*           /*********************************************************/ 02314000
*           /*                                                       */ 02315000
*           /* CALL HMASMTID TO BUILD A ICT MODID LIST FOR THIS ICT  */ 02316000
*           /* MOD ENTRY WITH THE FMID,RMID, AND UMID DATA.          */ 02317000
*           /*                                                       */ 02318000
*           /*********************************************************/ 02319000
*                                                                  0649 02320000
*           CALL HMASMTID(TBLXPARM, /*                               */ 02321000
*               ICMODPTR,           /* ICT MOD SECT ENTRY            */ 02322000
*               ICMODPTR->ICTMICHN(1),/* (A)CDS MODID LIST   @Z67SP00*/ 02323000
*               HMASMIOP);          /* (A)CDS ELEMENT ENTRY IOP ...     02324000
*                                      BUILD MODID LIST FOR THIS   0649 02325000
*                                      ELEMENT               @Z67SP00*/ 02326000
         L     @08,@PC00001                                        0649 02327000
         ST    @08,@AL00001                                        0649 02328000
         L     @08,@PC00001+4                                      0649 02329000
         ST    @08,@AL00001+4                                      0649 02330000
         L     @08,ICMODPTR(,@08)                                  0649 02331000
         LA    @08,ICTMICHN(,@08)                                  0649 02332000
         ST    @08,@AL00001+8                                      0649 02333000
         ST    IOPPTR,@AL00001+12                                  0649 02334000
         L     @15,@CV01855                                        0649 02335000
         LA    @01,@AL00001                                        0649 02336000
         BALR  @14,@15                                             0649 02337000
*           RFY                                                    0650 02338000
*             RTNCODE RSTD;         /* RESTRICT REG 15 USAGE         */ 02339000
*           IF RTNCODE^=IOPGOOD THEN/* WAS HMASMTID SUCCESSFULL?     */ 02340000
         LTR   RTNCODE,RTNCODE                                     0651 02341000
         BZ    @RF00651                                            0651 02342000
*             TM1HIRC=MAX(TM1HIRC,RTNCODE);/* NO- PICK UP HIGHEST RC */ 02343000
         CR    TM1HIRC,RTNCODE                                     0652 02344000
         BNL   *+6                                                      02345000
         LR    TM1HIRC,RTNCODE                                     0652 02346000
*           RFY                                                    0653 02347000
*             RTNCODE UNRSTD;       /* RELEASE REG 15                */ 02348000
@RF00651 DS    0H                                                  0654 02349000
*         END;                      /*                               */ 02350000
*       ELSE                                                       0655 02351000
*         IF IOPRETRN=IOPNOTFD THEN /* WAS SYSMOD FOUND?             */ 02352000
         B     @RC00647                                            0655 02353000
@RF00647 CLI   IOPRETRN(IOPPTR),4                                  0655 02354000
         BNE   @RF00655                                            0655 02355000
*           DO;                     /* NO- SET CHAINS TO NULL LIST   */ 02356000
*             ICMODPTR->ICTMICHN(1)=TBLXNULL;/* CHAIN TO EXISTING  0657 02357000
*                                      NULL LIST POINTER             */ 02358000
         L     @08,@PC00001+4                                      0657 02359000
         L     @08,ICMODPTR(,@08)                                  0657 02360000
         L     @15,@PC00001                                        0657 02361000
         L     @15,TBLXNULL(,@15)                                  0657 02362000
         ST    @15,ICTMICHN(,@08)                                  0657 02363000
*             ICMODPTR->ICTMICHA(1)=TBLXNULL;/* CHAIN TO EXISTING  0658 02364000
*                                      NULL LIST POINTER             */ 02365000
         ST    @15,ICTMICHA(,@08)                                  0658 02366000
*           END;                    /* END- SET CHAINS TO NULL LIST  */ 02367000
*       TM1HIRC=MAX(TM1HIRC,IOPRETRN);/* PICK UP HIGHEST RC          */ 02368000
@RF00655 DS    0H                                                  0660 02369000
@RC00647 SLR   @08,@08                                             0660 02370000
         IC    @08,IOPRETRN(,IOPPTR)                               0660 02371000
         CR    TM1HIRC,@08                                         0660 02372000
         BNL   *+6                                                      02373000
         LR    TM1HIRC,@08                                         0660 02374000
*     END;                          /*                               */ 02375000
*   IF IOPRETRN=IOPNOTFD THEN       /* IF ENTRY NOT FOUND THEN RESET    02376000
*                                      RETURN CODE TO ZERO           */ 02377000
@RF00638 CLI   IOPRETRN(IOPPTR),4                                  0662 02378000
         BNE   @RF00662                                            0662 02379000
*     IOPRETRN=IOPGOOD;             /* SET RC=0                      */ 02380000
         MVI   IOPRETRN(IOPPTR),X'00'                              0663 02381000
*   END TM1PROC8;                   /*                               */ 02382000
@EL00010 DS    0H                                                  0664 02383000
@EF00010 DS    0H                                                  0664 02384000
@ER00010 LM    @14,@02,@SA00010                                    0664 02385000
         LM    @04,@12,@SA00010+20                                 0664 02386000
         BR    @14                                                 0664 02387000
*TM1LMOD:                                                          0665 02388000
*   PROC;                           /*                               */ 02389000
*                                                                  0665 02390000
TM1LMOD  STM   @14,@02,12(@13)                                     0665 02391000
         STM   @04,@12,36(@13)                                     0665 02392000
*   /*****************************************************************/ 02393000
*   /*                                                               */ 02394000
*   /* WHEN A MOD ENTRY WAS FOUND OR IS BEING ADDED, AND A MCB WAS   */ 02395000
*   /* PASSED AS INPUT, THE MCB SUBENTRY DATA MUST BE CHECKED FOR    */ 02396000
*   /* LMOD SUBENTRY TYPES. IF FOUND THEN THEY MUST BE COMPARED TO   */ 02397000
*   /* THE EXISTING ENTRIES TO DETERMINE IF THEY MUST BE INSERTED    */ 02398000
*   /* INTO THE IOP AREA SO THE UPDATED MOD ENTRY CAN BE STOW        */ 02399000
*   /* REPLACED WITH THE NEW LMOD SUBENTRIES.                        */ 02400000
*   /*                                                               */ 02401000
*   /*****************************************************************/ 02402000
*                                                                  0666 02403000
*   DO S=1 BY 1 TO CCAPEMAX WHILE MCBEND(S)^=IOPEOLST/* LOOP ALL MCB    02404000
*                                      SUBENTRIES TO END OF LIST ,   */ 02405000
*         &TM1HIRC=IOPGOOD;         /* WHILE SPACE FOR ADD EXISTS    */ 02406000
         LA    S,1                                                 0666 02407000
         B     @DE00666                                            0666 02408000
@DL00666 LR    @08,S                                               0666 02409000
         MH    @08,@CH00038                                        0666 02410000
         L     @05,@PC00001+12                                     0666 02411000
         L     @05,ELMCBPTR(,@05)                                  0666 02412000
         SLR   @15,@15                                             0666 02413000
         IC    @15,MCBEND-9(@08,@05)                               0666 02414000
         CH    @15,@CH00714                                        0666 02415000
         BE    @DC00666                                            0666 02416000
         CH    TM1HIRC,@CH00088                                    0666 02417000
         BNE   @DC00666                                            0666 02418000
*     IF MCBEIND(S)=MCBELMOD THEN   /* MCB SUBENTRY A LMOD TYPE?     */ 02419000
         SLR   @15,@15                                             0667 02420000
         IC    @15,MCBEIND-9(@08,@05)                              0667 02421000
         CH    @15,@CH00044                                        0667 02422000
         BNE   @RF00667                                            0667 02423000
*       DO;                         /* YES- DO PROCESS               */ 02424000
*         LMODFND=OFF;              /* RESET FOR NEXT PASS           */ 02425000
         NI    LMODFND,B'11011111'                                 0669 02426000
*         DO T=1 BY 1 TO CCAPEMAX WHILE/* LOOP ALL IOP SUBENTRIES TO */ 02427000
*               IOPMODND(T)^=IOPEOLST/* END OF SUBENTRIES ON MOD , IF*/ 02428000
*               &LMODFND=OFF;       /* NO MATCH IS FOUND             */ 02429000
         LA    T,1                                                 0670 02430000
         B     @DE00670                                            0670 02431000
@DL00670 LA    @08,9                                               0670 02432000
         LR    @01,T                                               0670 02433000
         MR    @00,@08                                             0670 02434000
         SLR   @00,@00                                             0670 02435000
         IC    @00,IOPMODND-9(@01,IOPPTR)                          0670 02436000
         CH    @00,@CH00714                                        0670 02437000
         BE    @DC00670                                            0670 02438000
         TM    LMODFND,B'00100000'                                 0670 02439000
         BNZ   @DC00670                                            0670 02440000
*           IF IOPLMODS(T)=MCBENTRY(S)/* DO ENTRIES MATCH AND        */ 02441000
*               &IOPMDIND(T)=IOPMDLMD THEN/* IS ENTRY ALSO LMOD?     */ 02442000
         LR    @07,@08                                             0671 02443000
         MR    @06,S                                               0671 02444000
         L     @08,@PC00001+12                                     0671 02445000
         L     @08,ELMCBPTR(,@08)                                  0671 02446000
         ST    @01,@TF00001                                        0671 02447000
         ALR   @01,IOPPTR                                          0671 02448000
         ALR   @08,@07                                             0671 02449000
         CLC   IOPLMODS-9(8,@01),MCBENTRY-9(@08)                   0671 02450000
         BNE   @RF00671                                            0671 02451000
         L     @08,@TF00001                                        0671 02452000
         SLR   @15,@15                                             0671 02453000
         IC    @15,IOPMDIND-9(@08,IOPPTR)                          0671 02454000
         CH    @15,@CH00070                                        0671 02455000
         BNE   @RF00671                                            0671 02456000
*             LMODFND=ON;           /* YES-SET UP TO EXIT LOOP       */ 02457000
         OI    LMODFND,B'00100000'                                 0672 02458000
*         END;                      /* END OF IOP SEARCH LOOP        */ 02459000
@RF00671 AH    T,@CH00070                                          0673 02460000
@DE00670 CH    T,CCAPEMAX(,CCAPTR)                                 0673 02461000
         BNH   @DL00670                                            0673 02462000
@DC00670 DS    0H                                                  0674 02463000
*         IF LMODFND=OFF THEN       /* DOES ENTRY EXIST IN IOP?      */ 02464000
         TM    LMODFND,B'00100000'                                 0674 02465000
         BNZ   @RF00674                                            0674 02466000
*           DO;                     /* NO- THEN BUILD ONE            */ 02467000
*             IF T+1^>CCAPEMAX THEN /* IS THERE SPACE TO BUILD ENTRY?*/ 02468000
         LA    @08,1                                               0676 02469000
         LR    @15,T                                               0676 02470000
         ALR   @15,@08                                             0676 02471000
         CH    @15,CCAPEMAX(,CCAPTR)                               0676 02472000
         BH    @RF00676                                            0676 02473000
*               DO;                 /* YES- BUILD LMOD SUBENTRY      */ 02474000
*                 IOPLMODS(T)=MCBENTRY(S);/* LMOD NAME TO IOP        */ 02475000
         LA    @15,9                                               0678 02476000
         LR    @01,T                                               0678 02477000
         MR    @00,@15                                             0678 02478000
         ST    @01,@TF00001                                        0678 02479000
         ALR   @01,IOPPTR                                          0678 02480000
         MR    @14,S                                               0678 02481000
         L     @14,@PC00001+12                                     0678 02482000
         L     @14,ELMCBPTR(,@14)                                  0678 02483000
         ALR   @14,@15                                             0678 02484000
         MVC   IOPLMODS-9(8,@01),MCBENTRY-9(@14)                   0678 02485000
*                 IOPMDIND(T)=IOPMDLMD;/* INDICATE LMOD TYPE ENTRY   */ 02486000
         L     @01,@TF00001                                        0679 02487000
         STC   @08,IOPMDIND-9(@01,IOPPTR)                          0679 02488000
*                 IOPMODND(T+1)=IOPEOLST;/* SET NEW END OF LIST      */ 02489000
         LA    @08,255                                             0680 02490000
         L     @01,@TF00001                                        0680 02491000
         STC   @08,IOPMODND(@01,IOPPTR)                            0680 02492000
*                 LMODADD=ON;       /* INDICATE NEED FOR STOW REPLACE*/ 02493000
         OI    LMODADD,B'10000000'                                 0681 02494000
*               END;                /* END- BUILD LMOD SUBENTRY      */ 02495000
*             ELSE                                                 0683 02496000
*               TM1HIRC=IOPEXC;     /* SET RETURN CODE TO NO SPACE   */ 02497000
         B     @RC00676                                            0683 02498000
@RF00676 LA    TM1HIRC,8                                           0683 02499000
*           END;                    /* END ENTRY NOT EXIST IN IOP    */ 02500000
@RC00676 DS    0H                                                  0685 02501000
*       END;                        /* END OF LMOD SUBENTRY LOOP     */ 02502000
@RF00674 DS    0H                                                  0686 02503000
*   END;                            /* END OF MCB SUBENTRY LOOP      */ 02504000
@RF00667 AH    S,@CH00070                                          0686 02505000
@DE00666 CH    S,CCAPEMAX(,CCAPTR)                                 0686 02506000
         BNH   @DL00666                                            0686 02507000
@DC00666 DS    0H                                                  0687 02508000
*   END TM1LMOD;                    /*                               */ 02509000
@EL00011 DS    0H                                                  0687 02510000
@EF00011 DS    0H                                                  0687 02511000
@ER00011 LM    @14,@02,12(@13)                                     0687 02512000
         LM    @04,@12,36(@13)                                     0687 02513000
         BR    @14                                                 0687 02514000
*   END HMASMTM1                    /*                               */ 02515000
*                                                                  0688 02516000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 02517000
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */ 02518000
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */ 02519000
*/*%INCLUDE SYSLIB  (HMASMICT)                                       */ 02520000
*/*%INCLUDE SYSLIB  (HMASMMCB)                                       */ 02521000
*/*%INCLUDE SYSLIB  (HMASMMGP)                                       */ 02522000
*/*%INCLUDE SYSLIB  (HMASMGTP)                                       */ 02523000
*                                                                  0688 02524000
*       ;                                                          0688 02525000
@DATA    DS    0H                                                       02526000
@CH00088 DC    H'0'                                                     02527000
@CH00070 DC    H'1'                                                     02528000
@CH00279 DC    H'2'                                                     02529000
@CH00093 DC    H'3'                                                     02530000
@CH00044 DC    H'4'                                                     02531000
@CH00038 DC    H'9'                                                     02532000
@CH01952 DC    H'144'                                                   02533000
@CH01859 DC    H'232'                                                   02534000
@CH00714 DC    H'255'                                                   02535000
         DS    0F                                                       02536000
@AL00428 DC    A(HMASMMGP)             LIST WITH   1 ARGUMENT(S)        02537000
         DS    0F                                                       02538000
@SA00001 DS    18F                                                      02539000
@PC00001 DS    4F                                                       02540000
@SA00002 DS    14F                                                      02541000
@SA00003 DS    14F                                                      02542000
@SA00004 DS    0F                                                       02543000
@SA00010 DS    0F                                                       02544000
@SA00009 DS    0F                                                       02545000
@SA00008 DS    0F                                                       02546000
@SA00007 DS    0F                                                       02547000
@SA00005 DS    0F                                                       02548000
         DS    15F                                                      02549000
@AL00001 DS    4A                                                       02550000
@TF00001 DS    F                                                        02551000
         DS    0F                                                       02552000
@CF00062 DC    F'8'                                                     02553000
@CF01965 DC    F'-144'                                                  02554000
@CF01967 DC    F'-135'                                                  02555000
@CF01966 DC    F'-40'                                                   02556000
@CF01969 DC    F'-36'                                                   02557000
@CV01853 DC    V(HMASMIO)                                               02558000
@CV01854 DC    V(HMASMMSG)                                              02559000
@CV01855 DC    V(HMASMTID)                                              02560000
@CV01856 DC    V(HMASMTAI)                                              02561000
@CV01857 DC    V(HMASMGTA)                                              02562000
         DS    0D                                                       02563000
@CC01864 DC    C'SMPTLIB '                                              02564000
@CC01866 DC    C'SMPWRK3 '                                              02565000
@CC01868 DC    C'00000000'                                              02566000
@CC01929 DC    C'MOD     '                                              02567000
ICTENDCH DC    X'FFFFFFFF'                                              02568000
HMASMMGP DS    CL24                                                     02569000
         ORG   HMASMMGP                                                 02570000
MGPFIXED DS    CL12                                                     02571000
         ORG   MGPFIXED                                                 02572000
MGPCLEAR DS    CL6                                                      02573000
         ORG   MGPCLEAR                                                 02574000
MGPMGNO1 DS    FL2                                                      02575000
MGPMGNO2 DS    FL2                                                      02576000
MGPMGNO3 DS    FL2                                                      02577000
         ORG   MGPFIXED+6                                               02578000
MGPFLAGS DS    BL2                                                      02579000
         ORG   MGPFLAGS                                                 02580000
MGPPRINT DS    BL1                                                      02581000
MGPLIST  EQU   MGPFLAGS+0                                               02582000
MGPRPT   EQU   MGPFLAGS+0                                               02583000
MGPHLDS  EQU   MGPFLAGS+0                                               02584000
MGPWTOR  EQU   MGPFLAGS+0                                               02585000
MGPWTO   EQU   MGPFLAGS+0                                               02586000
MGPWTP   EQU   MGPFLAGS+0                                               02587000
@NM00250 EQU   MGPFLAGS+0                                               02588000
         ORG   MGPFIXED+8                                               02589000
MGPTYPE  DS    FL1                                                      02590000
@NM00251 DS    CL3                                                      02591000
         ORG   HMASMMGP+12                                              02592000
MGPVAR   DS    CL12                                                     02593000
         ORG   MGPVAR                                                   02594000
MGPVARPT DS    3A                                                       02595000
         ORG   HMASMMGP+24                                              02596000
ETYPE    DS    CL8                                                      02597000
TM1SWCH1 DS    BL1                                                      02598000
         ORG   TM1SWCH1                                                 02599000
DLIBBIT  DS    BL1                                                      02600000
SMDAPPLY EQU   TM1SWCH1+0                                               02601000
XMID     EQU   TM1SWCH1+0                                               02602000
MODALMOD EQU   TM1SWCH1+0                                               02603000
ICTMATCH EQU   TM1SWCH1+0                                               02604000
BLDACDSM EQU   TM1SWCH1+0                                               02605000
@NM00255 EQU   TM1SWCH1+0                                               02606000
         ORG   TM1SWCH1+1                                               02607000
TM1SWCH2 DS    BL1                                                      02608000
         ORG   TM1SWCH2                                                 02609000
LMODADD  DS    BL1                                                      02610000
MODFND   EQU   TM1SWCH2+0                                               02611000
LMODFND  EQU   TM1SWCH2+0                                               02612000
@NM00256 EQU   TM1SWCH2+0                                               02613000
         ORG   TM1SWCH2+1                                               02614000
SAVADLIB DS    CL8                                                      02615000
         DS    CL2                                                      02616000
PKDEC    DS    CL8                                                      02617000
RADJ     DS    CL8                                                      02618000
BLANKS   DC    CL8'        '                                            02619000
PATCHTM1 DS    CL80                                                     02620000
         ORG   PATCHTM1                                                 02621000
@NM00257 DC    80X'FF'                                                  02622000
         ORG   PATCHTM1+80                                              02623000
SYSLIBS  DS    2CL8                                                     02624000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02625000
@01      EQU   01                                                       02626000
@02      EQU   02                                                       02627000
@03      EQU   03                                                       02628000
@04      EQU   04                                                       02629000
@05      EQU   05                                                       02630000
@06      EQU   06                                                       02631000
@07      EQU   07                                                       02632000
@08      EQU   08                                                       02633000
@09      EQU   09                                                       02634000
@10      EQU   10                                                       02635000
@11      EQU   11                                                       02636000
@12      EQU   12                                                       02637000
@13      EQU   13                                                       02638000
@14      EQU   14                                                       02639000
@15      EQU   15                                                       02640000
T        EQU   @05                                                      02641000
S        EQU   @04                                                      02642000
L        EQU   @04                                                      02643000
FIX31    EQU   @04                                                      02644000
SAVBUFAD EQU   @03                                                      02645000
TM1HIRC  EQU   @03                                                      02646000
IOPPTR   EQU   @02                                                      02647000
CCAPTR   EQU   @11                                                      02648000
RTNCODE  EQU   @15                                                      02649000
RTNREG   EQU   @14                                                      02650000
TBLXOPTS EQU   0                                                        02651000
TBLFLAGS EQU   TBLXOPTS+8                                               02652000
TBLFLG1  EQU   TBLFLAGS                                                 02653000
TBLNOAPP EQU   TBLFLG1                                                  02654000
TBLFLG2  EQU   TBLFLAGS+2                                               02655000
TBLFLG3  EQU   TBLFLAGS+3                                               02656000
TBLFLG4  EQU   TBLFLAGS+5                                               02657000
TBLFLG5  EQU   TBLFLAGS+7                                               02658000
HMASMCCA EQU   0                                                        02659000
CCAFBUFR EQU   HMASMCCA+4                                               02660000
CCADSAD  EQU   CCAFBUFR+124                                             02661000
CCATPAD  EQU   CCAFBUFR+128                                             02662000
CCAFLAG7 EQU   CCAFBUFR+132                                             02663000
CCAFIOP  EQU   HMASMCCA+140                                             02664000
CCAIOPTR EQU   CCAFIOP                                                  02665000
CCAFSYS  EQU   HMASMCCA+148                                             02666000
CCAPEMAX EQU   CCAFSYS+10                                               02667000
CCASREL  EQU   CCAFSYS+12                                               02668000
CCAFLAGA EQU   CCAFSYS+21                                               02669000
CCAFSTA  EQU   HMASMCCA+188                                             02670000
CCAFICT  EQU   HMASMCCA+192                                             02671000
CCAICT   EQU   CCAFICT                                                  02672000
CCAICPTF EQU   CCAFICT+4                                                02673000
CCAICMOD EQU   CCAFICT+8                                                02674000
CCAICLMD EQU   CCAFICT+12                                               02675000
CCAFPGM  EQU   HMASMCCA+208                                             02676000
CCABLDLP EQU   CCAFPGM                                                  02677000
CCADBLDL EQU   CCAFPGM+4                                                02678000
CCAFGTP  EQU   HMASMCCA+224                                             02679000
CCASEGTP EQU   CCAFGTP                                                  02680000
@NM00023 EQU   HMASMCCA+244                                             02681000
CCAFFUNC EQU   HMASMCCA+264                                             02682000
CCAFLAG1 EQU   CCAFFUNC+8                                               02683000
CCAAPPLY EQU   CCAFLAG1                                                 02684000
CCAACCPT EQU   CCAFLAG1                                                 02685000
CCARES   EQU   CCAFLAG1                                                 02686000
CCAFLAG2 EQU   CCAFFUNC+11                                              02687000
CCAFPROC EQU   HMASMCCA+276                                             02688000
CCAFLAG3 EQU   CCAFPROC                                                 02689000
CCAFDIS  EQU   HMASMCCA+278                                             02690000
CCAFLAG4 EQU   CCAFDIS                                                  02691000
CCAFLAG5 EQU   CCAFDIS+1                                                02692000
CCAFLAG6 EQU   CCAFDIS+2                                                02693000
CCAFCNV  EQU   HMASMCCA+281                                             02694000
CCAFLAG8 EQU   CCAFCNV                                                  02695000
CCAFCTL  EQU   HMASMCCA+282                                             02696000
CCAFLAG9 EQU   CCAFCTL                                                  02697000
CCAFDSNG EQU   HMASMCCA+298                                             02698000
CCAFLAGB EQU   CCAFDSNG                                                 02699000
CCABLDLA EQU   0                                                        02700000
@NM00039 EQU   CCABLDLA                                                 02701000
CCABLDLL EQU   0                                                        02702000
@NM00041 EQU   CCABLDLL                                                 02703000
CCALKDRC EQU   @NM00041+20                                              02704000
@NM00043 EQU   CCABLDLL+124                                             02705000
CCAASMRC EQU   @NM00043+20                                              02706000
@NM00045 EQU   CCABLDLL+248                                             02707000
CCACPYRC EQU   @NM00045+20                                              02708000
@NM00047 EQU   CCABLDLL+372                                             02709000
CCACOMRC EQU   @NM00047+20                                              02710000
@NM00049 EQU   CCABLDLL+496                                             02711000
CCAZAPRC EQU   @NM00049+20                                              02712000
@NM00051 EQU   CCABLDLL+620                                             02713000
CCASUPRC EQU   @NM00051+20                                              02714000
@NM00053 EQU   CCABLDLL+744                                             02715000
CCAUPDRC EQU   @NM00053+20                                              02716000
CCABLDLM EQU   0                                                        02717000
CCABELMT EQU   CCABLDLM+4                                               02718000
CCABMPOS EQU   CCABELMT                                                 02719000
HMASMIOP EQU   0                                                        02720000
IOPDSID  EQU   HMASMIOP                                                 02721000
IOPFUNCT EQU   HMASMIOP+1                                               02722000
IOPRETRN EQU   HMASMIOP+2                                               02723000
IOPTYPE  EQU   HMASMIOP+3                                               02724000
IOPNAME  EQU   HMASMIOP+4                                               02725000
@NM00057 EQU   HMASMIOP+12                                              02726000
@NM00058 EQU   @NM00057                                                 02727000
IOPDDNAM EQU   HMASMIOP+24                                              02728000
IOPBUFAD EQU   HMASMIOP+52                                              02729000
IOPDRMAP EQU   HMASMIOP+56                                              02730000
IOPINAME EQU   IOPDRMAP                                                 02731000
IOPINAM  EQU   IOPINAME                                                 02732000
IOPITYP  EQU   IOPINAM                                                  02733000
IOPUSERL EQU   IOPDRMAP+11                                              02734000
IOPEND   EQU   IOPDRMAP+12                                              02735000
IOPLMCTL EQU   0                                                        02736000
IOPQSMIF EQU   0                                                        02737000
@NM00168 EQU   IOPQSMIF                                                 02738000
IOPQSMLS EQU   IOPQSMIF+8                                               02739000
IOPQSMNM EQU   IOPQSMLS                                                 02740000
IOPBS02  EQU   0                                                        02741000
IOPBS04  EQU   0                                                        02742000
IOPBAPF  EQU   IOPBS04                                                  02743000
HMASMICT EQU   0                                                        02744000
ICTCORE  EQU   HMASMICT                                                 02745000
ICTPSPLN EQU   ICTCORE                                                  02746000
ICTMSPLN EQU   ICTCORE+4                                                02747000
ICTLSPLN EQU   ICTCORE+8                                                02748000
ICTGMSPL EQU   0                                                        02749000
ICTPTF   EQU   0                                                        02750000
ICTPTFS  EQU   ICTPTF                                                   02751000
ICTPFLG1 EQU   ICTPTF+7                                                 02752000
ICTPFLG3 EQU   ICTPTF+8                                                 02753000
ICTPPROC EQU   ICTPFLG3                                                 02754000
ICTPFLG5 EQU   ICTPTF+9                                                 02755000
ICTPFLG6 EQU   ICTPTF+11                                                02756000
ICTPFLF  EQU   ICTPFLG6                                                 02757000
ICTPFLG2 EQU   ICTPTF+12                                                02758000
ICTPFLG4 EQU   ICTPTF+13                                                02759000
ICTPFLG8 EQU   ICTPTF+14                                                02760000
ICTPFLG9 EQU   ICTPTF+15                                                02761000
@NM00195 EQU   ICTPFLG9                                                 02762000
ICTPFLGA EQU   ICTPTF+16                                                02763000
ICTPUSR1 EQU   ICTPFLGA                                                 02764000
ICTPCHN  EQU   ICTPTF+64                                                02765000
ICTPRCHN EQU   ICTPTF+68                                                02766000
ICTPSCHN EQU   ICTPTF+72                                                02767000
ICTPPCHN EQU   ICTPTF+76                                                02768000
ICTPICHN EQU   ICTPTF+80                                                02769000
ICTPNCHN EQU   ICTPTF+84                                                02770000
ICTPVCHN EQU   ICTPTF+88                                                02771000
ICTPDCHN EQU   ICTPTF+92                                                02772000
ICTPBCHN EQU   ICTPTF+96                                                02773000
ICTIXPF  EQU   0                                                        02774000
ICTENTLS EQU   0                                                        02775000
ICTENTNT EQU   ICTENTLS                                                 02776000
ICTENTNM EQU   ICTENTNT                                                 02777000
ICTENTST EQU   ICTENTNT+7                                               02778000
ICTREQLS EQU   0                                                        02779000
ICTREQNT EQU   ICTREQLS                                                 02780000
ICTREQNM EQU   ICTREQNT                                                 02781000
ICTREQST EQU   ICTREQNT+7                                               02782000
ICTSUPLS EQU   0                                                        02783000
ICTSUPNT EQU   ICTSUPLS                                                 02784000
ICTSUPNM EQU   ICTSUPNT                                                 02785000
ICTPRELS EQU   0                                                        02786000
ICTPRENT EQU   ICTPRELS                                                 02787000
ICTPRENM EQU   ICTPRENT                                                 02788000
ICTPREST EQU   ICTPRENT+7                                               02789000
ICTIRQLS EQU   0                                                        02790000
ICTIRQNT EQU   ICTIRQLS                                                 02791000
ICTIRQNM EQU   ICTIRQNT                                                 02792000
ICTIRQST EQU   ICTIRQNT+7                                               02793000
ICTCSRST EQU   ICTIRQNT+15                                              02794000
ICTNPRLS EQU   0                                                        02795000
ICTNPRNT EQU   ICTNPRLS                                                 02796000
ICTNPRNM EQU   ICTNPRNT                                                 02797000
ICTVRSLS EQU   0                                                        02798000
ICTVRSNT EQU   ICTVRSLS                                                 02799000
ICTVRSNM EQU   ICTVRSNT                                                 02800000
ICTDELLS EQU   0                                                        02801000
ICTDELNT EQU   ICTDELLS                                                 02802000
ICTDELNM EQU   ICTDELNT                                                 02803000
ICTDELST EQU   ICTDELNT+7                                               02804000
ICTSBYLS EQU   0                                                        02805000
ICTSBYNT EQU   ICTSBYLS                                                 02806000
ICTSBYNM EQU   ICTSBYNT                                                 02807000
ICTMOD   EQU   0                                                        02808000
ICTMNAME EQU   ICTMOD                                                   02809000
ICTMEND  EQU   ICTMNAME                                                 02810000
ICTMFLG2 EQU   ICTMOD+8                                                 02811000
ICTMNOGO EQU   ICTMFLG2                                                 02812000
ICTMCPL  EQU   ICTMFLG2                                                 02813000
ICTMMSG  EQU   ICTMFLG2                                                 02814000
ICTMFLG1 EQU   ICTMOD+9                                                 02815000
ICTMMODR EQU   ICTMFLG1                                                 02816000
ICTMMOD  EQU   ICTMMODR                                                 02817000
ICTMZAP  EQU   ICTMFLG1                                                 02818000
ICTMFLG3 EQU   ICTMOD+10                                                02819000
ICTLIBLK EQU   ICTMFLG3                                                 02820000
ICTLIBTX EQU   ICTMFLG3                                                 02821000
ICTMRELF EQU   ICTMFLG3                                                 02822000
ICTMALIS EQU   ICTMFLG3                                                 02823000
ICTMPRMS EQU   ICTMFLG3                                                 02824000
ICTMFLG4 EQU   ICTMOD+11                                                02825000
ICTMIDEL EQU   ICTMFLG4                                                 02826000
ICTMDSTE EQU   ICTMFLG4                                                 02827000
ICTMFLG5 EQU   ICTMOD+12                                                02828000
ICTMODF4 EQU   ICTMOD+13                                                02829000
ICTMLEP1 EQU   ICTMODF4                                                 02830000
ICTMODF5 EQU   ICTMOD+14                                                02831000
ICTMLEP2 EQU   ICTMODF5                                                 02832000
ICTMODF6 EQU   ICTMOD+15                                                02833000
ICTMLEP3 EQU   ICTMODF6                                                 02834000
ICTMODF7 EQU   ICTMOD+16                                                02835000
ICTMLEP4 EQU   ICTMODF7                                                 02836000
ICTMACF4 EQU   ICTMOD+17                                                02837000
ICTMRELN EQU   ICTMOD+22                                                02838000
ICTFMLIB EQU   ICTMOD+24                                                02839000
ICTMDSTL EQU   ICTMOD+48                                                02840000
ICTPPTR  EQU   ICTMOD+96                                                02841000
ICTMCHN  EQU   ICTMOD+100                                               02842000
ICTMICHN EQU   ICTMOD+104                                               02843000
ICTMICHA EQU   ICTMOD+108                                               02844000
ICTMACHN EQU   ICTMOD+112                                               02845000
ICTMTCHN EQU   ICTMOD+116                                               02846000
ICTMVCHN EQU   ICTMOD+120                                               02847000
ICTMUCHN EQU   ICTMOD+124                                               02848000
ICTIXMF  EQU   0                                                        02849000
ICTMIDLS EQU   0                                                        02850000
ICTMID   EQU   ICTMIDLS                                                 02851000
ICTMODID EQU   ICTMID                                                   02852000
ICTMODST EQU   ICTMID+7                                                 02853000
ICTASMLS EQU   0                                                        02854000
ICTASMAD EQU   ICTASMLS                                                 02855000
ICTTALLS EQU   0                                                        02856000
ICTTALNM EQU   ICTTALLS                                                 02857000
ICTMVRLS EQU   0                                                        02858000
ICTMVRNT EQU   ICTMVRLS                                                 02859000
ICTMVRNM EQU   ICTMVRNT                                                 02860000
ICTMUMLS EQU   0                                                        02861000
ICTMUMNT EQU   ICTMUMLS                                                 02862000
ICTMUMNM EQU   ICTMUMNT                                                 02863000
ICTLMOD  EQU   0                                                        02864000
ICTLMNAM EQU   ICTLMOD                                                  02865000
ICTLNAME EQU   ICTLMNAM                                                 02866000
ICTLFLG4 EQU   ICTLMOD+8                                                02867000
ICTLFLG1 EQU   ICTLMOD+9                                                02868000
ICTLFLG5 EQU   ICTLMOD+10                                               02869000
ICTLFLG6 EQU   ICTLMOD+11                                               02870000
ICTLFLG7 EQU   ICTLMOD+12                                               02871000
ICTLFLG2 EQU   ICTLMOD+13                                               02872000
ICTLFLG3 EQU   ICTLMOD+14                                               02873000
ICTLCHN  EQU   ICTLMOD+34                                               02874000
ICTIXLF  EQU   0                                                        02875000
MCBPTFMP EQU   0                                                        02876000
MCBTYPE  EQU   MCBPTFMP                                                 02877000
MCBVERMP EQU   0                                                        02878000
MCBVEND  EQU   MCBVERMP+8                                               02879000
MCBIFMP  EQU   0                                                        02880000
MCBIEND  EQU   MCBIFMP+8                                                02881000
MCBELEMP EQU   0                                                        02882000
MCBEDIST EQU   MCBELEMP+9                                               02883000
MCBETXLB EQU   MCBELEMP+33                                              02884000
MCBELKLB EQU   MCBELEMP+41                                              02885000
MCBEDALS EQU   MCBELEMP+57                                              02886000
MCBERLF  EQU   MCBELEMP+73                                              02887000
MCBELEPM EQU   MCBELEMP+136                                             02888000
MCBEFLG1 EQU   MCBELEPM                                                 02889000
MCBEFLG2 EQU   MCBELEPM+1                                               02890000
MCBEFLG3 EQU   MCBELEPM+2                                               02891000
MCBEFLG4 EQU   MCBELEPM+3                                               02892000
MCBEFLG5 EQU   MCBELEMP+140                                             02893000
MCBEDEL  EQU   MCBEFLG5                                                 02894000
MCBEEND  EQU   MCBELEMP+141                                             02895000
HMASMGTP EQU   0                                                        02896000
GTPFUNCT EQU   HMASMGTP                                                 02897000
GTPRETRN EQU   HMASMGTP+1                                               02898000
GTPBUFAD EQU   HMASMGTP+12                                              02899000
GTPRESTR EQU   HMASMGTP+16                                              02900000
GTPFLGS1 EQU   HMASMGTP+26                                              02901000
LMMRECRD EQU   0                                                        02902000
LMMKEY   EQU   LMMRECRD                                                 02903000
LMMSMD   EQU   LMMKEY                                                   02904000
LMMMNAME EQU   LMMKEY+7                                                 02905000
LMMLNAME EQU   LMMKEY+15                                                02906000
CCADSIDA EQU   0                                                        02907000
CCATYPEA EQU   0                                                        02908000
IOPBS01  EQU   0                                                        02909000
IOPBS03  EQU   0                                                        02910000
TBLXPARM EQU   0                                                        02911000
TBLXINDX EQU   TBLXPARM+4                                               02912000
TBLXTBL  EQU   TBLXPARM+28                                              02913000
TBLXNULL EQU   TBLXPARM+36                                              02914000
TBLXLMGT EQU   TBLXPARM+56                                              02915000
TBLXFLG1 EQU   TBLXPARM+80                                              02916000
TBLXRC   EQU   TBLXPARM+92                                              02917000
ICMODPTR EQU   0                                                        02918000
ICPTFPTR EQU   0                                                        02919000
ELMCBPTR EQU   0                                                        02920000
IOPUDATA EQU   IOPEND                                                   02921000
IOPINAM3 EQU   IOPINAME                                                 02922000
@NM00064 EQU   IOPINAM3                                                 02923000
IOPSTCMP EQU   IOPUDATA                                                 02924000
IOPONAME EQU   IOPSTCMP                                                 02925000
IOPOTYPE EQU   IOPSTCMP+8                                               02926000
IOPNNAME EQU   IOPSTCMP+9                                               02927000
IOPNTYPE EQU   IOPSTCMP+17                                              02928000
IOPDYNDT EQU   IOPUDATA                                                 02929000
IOPSPACE EQU   IOPDYNDT+44                                              02930000
IOPDTYPE EQU   IOPDYNDT+50                                              02931000
IOPNTMAX EQU   IOPDRMAP                                                 02932000
IOPNTMAP EQU   IOPDRMAP                                                 02933000
IOPCDMAP EQU   IOPNTMAP                                                 02934000
IOPPTMAP EQU   IOPCDMAP                                                 02935000
IOPSCMAP EQU   IOPPTMAP                                                 02936000
IOPDIRCT EQU   IOPSCMAP+12                                              02937000
IOPCDMAX EQU   IOPDIRCT                                                 02938000
IOPCQMAP EQU   IOPDRMAP                                                 02939000
@NM00075 EQU   IOPUDATA                                                 02940000
@NM00076 EQU   IOPUDATA                                                 02941000
IOPASMNT EQU   IOPUDATA                                                 02942000
IOPASMDR EQU   IOPASMNT                                                 02943000
IOPNTLVL EQU   IOPASMDR                                                 02944000
IOPABUNT EQU   IOPASMDR+1                                               02945000
IOPLMDNT EQU   IOPUDATA                                                 02946000
IOPLMDDR EQU   IOPLMDNT                                                 02947000
IOPLMLEP EQU   IOPLMDDR+1                                               02948000
IOPLMDF1 EQU   IOPLMLEP                                                 02949000
IOPFLGS2 EQU   IOPLMDF1                                                 02950000
IOPLMDF2 EQU   IOPLMLEP+1                                               02951000
IOPLMDF3 EQU   IOPLMLEP+2                                               02952000
IOPLMDF4 EQU   IOPLMLEP+3                                               02953000
IOPLMDF5 EQU   IOPLMDDR+5                                               02954000
IOPFLGS3 EQU   IOPLMDF5                                                 02955000
IOPCOPY  EQU   IOPFLGS3                                                 02956000
IOPLINK  EQU   IOPFLGS3                                                 02957000
IOPLMDFX EQU   IOPLMDNT+24                                              02958000
@NM00085 EQU   IOPLMDFX                                                 02959000
IOPLNTRY EQU   IOPLMDFX+8                                               02960000
IOPLSYS  EQU   IOPLNTRY                                                 02961000
IOPSYSLB EQU   IOPLSYS                                                  02962000
IOPLMDND EQU   IOPSYSLB                                                 02963000
IOPLMIND EQU   IOPLNTRY+8                                               02964000
IOPMACNT EQU   IOPUDATA                                                 02965000
IOPMACDR EQU   IOPMACNT                                                 02966000
IOPRMIDE EQU   IOPMACDR+1                                               02967000
IOPRMID  EQU   IOPRMIDE                                                 02968000
IOPRMST  EQU   IOPRMIDE+7                                               02969000
IOPFMIDE EQU   IOPMACDR+9                                               02970000
IOPFMID  EQU   IOPFMIDE                                                 02971000
IOPFMST  EQU   IOPFMIDE+7                                               02972000
IOPMACFX EQU   IOPMACNT+24                                              02973000
IOPBUNT  EQU   IOPMACFX                                                 02974000
IOPBUSMD EQU   IOPBUNT                                                  02975000
IOPBUTYP EQU   IOPBUNT+7                                                02976000
IOPMCEND EQU   IOPMACNT+104                                             02977000
IOPMACVR EQU   IOPMCEND                                                 02978000
IOPMCENT EQU   IOPMACVR                                                 02979000
IOPMCDTA EQU   IOPMCENT                                                 02980000
IOPMCASM EQU   IOPMCDTA                                                 02981000
IOPMACID EQU   IOPMCASM                                                 02982000
IOPMACST EQU   IOPMCASM+7                                               02983000
IOPMCIND EQU   IOPMCENT+8                                               02984000
IOPEOFNT EQU   IOPUDATA                                                 02985000
IOPSRCNT EQU   IOPUDATA                                                 02986000
IOPSRCDR EQU   IOPSRCNT                                                 02987000
@NM00096 EQU   IOPSRCDR+1                                               02988000
@NM00098 EQU   @NM00096+7                                               02989000
@NM00102 EQU   IOPSRCDR+9                                               02990000
IOPSRCFX EQU   IOPSRCNT+24                                              02991000
@NM00106 EQU   IOPSRCFX                                                 02992000
IOPSREND EQU   IOPSRCNT+104                                             02993000
IOPSRCVR EQU   IOPSREND                                                 02994000
IOPSNTRY EQU   IOPSRCVR                                                 02995000
IOPSRDTA EQU   IOPSNTRY                                                 02996000
IOPSRCID EQU   IOPSRDTA                                                 02997000
IOPSRCST EQU   IOPSRDTA+7                                               02998000
IOPMODNT EQU   IOPUDATA                                                 02999000
IOPMODDR EQU   IOPMODNT                                                 03000000
@NM00112 EQU   IOPMODDR+1                                               03001000
@NM00114 EQU   @NM00112+7                                               03002000
@NM00118 EQU   IOPMODDR+9                                               03003000
IOPMODFX EQU   IOPMODNT+24                                              03004000
@NM00122 EQU   IOPMODFX                                                 03005000
IOPMDLEP EQU   IOPMODFX+8                                               03006000
IOPMODF1 EQU   IOPMDLEP                                                 03007000
IOPMODF2 EQU   IOPMDLEP+1                                               03008000
IOPMODF3 EQU   IOPMDLEP+2                                               03009000
IOPMODF4 EQU   IOPMDLEP+3                                               03010000
IOPDLIB  EQU   IOPMODFX+72                                              03011000
IOPMDEND EQU   IOPMODNT+104                                             03012000
IOPMODVR EQU   IOPMDEND                                                 03013000
IOPMNTRY EQU   IOPMODVR                                                 03014000
IOPMDDTA EQU   IOPMNTRY                                                 03015000
IOPLMODS EQU   IOPMDDTA                                                 03016000
IOPMODID EQU   IOPLMODS                                                 03017000
IOPMODND EQU   IOPMODID                                                 03018000
IOPMODST EQU   IOPLMODS+7                                               03019000
IOPMDIND EQU   IOPMNTRY+8                                               03020000
IOPDLBNT EQU   IOPUDATA                                                 03021000
IOPDLBDR EQU   IOPDLBNT                                                 03022000
IOPDLBFX EQU   IOPDLBNT+24                                              03023000
@NM00133 EQU   IOPDLBFX                                                 03024000
IOPDLEND EQU   IOPDLBNT+104                                             03025000
IOPDLBVR EQU   IOPDLEND                                                 03026000
IOPDNTRY EQU   IOPDLBVR                                                 03027000
IOPDSYS  EQU   IOPDNTRY                                                 03028000
IOPDLBND EQU   IOPDSYS                                                  03029000
IOPDLIND EQU   IOPDNTRY+8                                               03030000
IOPSYSNT EQU   IOPUDATA                                                 03031000
IOPSYSDR EQU   IOPSYSNT                                                 03032000
IOPSYSF1 EQU   IOPSYSDR+4                                               03033000
IOPFLGS7 EQU   IOPSYSF1                                                 03034000
IOPSYSFX EQU   IOPSYSNT+24                                              03035000
@NM00140 EQU   IOPSYSFX                                                 03036000
IOPSYEND EQU   IOPSYSNT+184                                             03037000
IOPSYSVR EQU   IOPSYEND                                                 03038000
IOPSYSTR EQU   IOPSYSVR                                                 03039000
IOPSYNTR EQU   IOPSYSTR                                                 03040000
IOPPTFNT EQU   IOPUDATA                                                 03041000
IOPPTFDR EQU   IOPPTFNT                                                 03042000
IOPPSTAT EQU   IOPPTFDR+2                                               03043000
IOPPTFF1 EQU   IOPPSTAT                                                 03044000
IOPFLGS5 EQU   IOPPTFF1                                                 03045000
IOPPTFF2 EQU   IOPPSTAT+1                                               03046000
IOPPTFF3 EQU   IOPPSTAT+3                                               03047000
IOPPTFFX EQU   IOPPTFNT+24                                              03048000
@NM00149 EQU   IOPPTFFX                                                 03049000
@NM00150 EQU   @NM00149                                                 03050000
IOPPDTES EQU   IOPPTFFX+41                                              03051000
@NM00153 EQU   IOPPDTES                                                 03052000
IOPPTPFX EQU   IOPPDTES+6                                               03053000
IOPDATES EQU   IOPPTPFX                                                 03054000
IOPPTEND EQU   IOPPTFNT+104                                             03055000
IOPPTFVR EQU   IOPPTEND                                                 03056000
IOPPNTRY EQU   IOPPTFVR                                                 03057000
IOPPMODS EQU   IOPPNTRY                                                 03058000
IOPENTNT EQU   IOPUDATA+104                                             03059000
IOPSRLNT EQU   IOPUDATA+104                                             03060000
IOPPRENT EQU   IOPUDATA+104                                             03061000
IOPNPRNT EQU   IOPUDATA+104                                             03062000
IOPSUPNT EQU   IOPUDATA+104                                             03063000
IOPREQNT EQU   IOPUDATA+104                                             03064000
IOPIRQNT EQU   IOPUDATA+104                                             03065000
IOPFIDNT EQU   IOPUDATA+104                                             03066000
IOPDELNT EQU   IOPUDATA+104                                             03067000
IOPVERNT EQU   IOPUDATA+104                                             03068000
IOPSBYNT EQU   IOPUDATA+104                                             03069000
IOPQSMNT EQU   IOPUDATA                                                 03070000
IOPQSMDR EQU   IOPQSMNT                                                 03071000
IOPQFMNT EQU   IOPUDATA                                                 03072000
IOPQFMDR EQU   IOPQFMNT                                                 03073000
IOPQFEND EQU   IOPQFMNT+2                                               03074000
IOPQFMVR EQU   IOPQFEND                                                 03075000
IOPQFMLS EQU   IOPQFMVR                                                 03076000
IOPQFMNM EQU   IOPQFMLS                                                 03077000
IOPPTSYS EQU   IOPUDATA                                                 03078000
IOPPTSDR EQU   IOPPTSYS                                                 03079000
IOPPTSFX EQU   IOPPTSYS+24                                              03080000
IOPDSSPC EQU   IOPPTSFX                                                 03081000
IOPPTFG1 EQU   IOPPTSFX+34                                              03082000
IOPPSEND EQU   IOPPTSYS+1064                                            03083000
IOPPTSVR EQU   IOPPSEND                                                 03084000
IOPPTNTR EQU   IOPPTSVR                                                 03085000
@NM00178 EQU   IOPPTNTR                                                 03086000
IOPPTFMD EQU   @NM00178                                                 03087000
IOPPTREL EQU   IOPPTFMD                                                 03088000
IOPBPDS  EQU   IOPUDATA                                                 03089000
IOPBLEP1 EQU   IOPBPDS+8                                                03090000
IOPBLEP2 EQU   IOPBPDS+9                                                03091000
@NM00182 EQU   IOPBPDS+18                                               03092000
IOPBFTB0 EQU   @NM00182                                                 03093000
IOPBFTB1 EQU   IOPBFTB0                                                 03094000
ICTENDNT EQU   ICTENDCH                                                 03095000
MCBVVLST EQU   MCBVEND                                                  03096000
MCBVNTRY EQU   MCBVVLST                                                 03097000
MCBVNUM  EQU   MCBVNTRY                                                 03098000
MCBIVLST EQU   MCBIEND                                                  03099000
MCBINTRY EQU   MCBIVLST                                                 03100000
MCBINUM  EQU   MCBINTRY                                                 03101000
MCBEVLST EQU   MCBEEND                                                  03102000
MCBENTRY EQU   MCBEVLST                                                 03103000
MCBENUM  EQU   MCBENTRY                                                 03104000
MCBEND   EQU   MCBENUM                                                  03105000
MCBEIND  EQU   MCBEVLST+8                                               03106000
ICTENDIX EQU   ICTENDCH                                                 03107000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    03108000
@NM00249 EQU   MCBENTRY+7                                               03109000
MCBIIND  EQU   MCBIVLST+8                                               03110000
@NM00242 EQU   MCBINTRY+7                                               03111000
MCBIND   EQU   MCBINUM                                                  03112000
MCBVIND  EQU   MCBVVLST+8                                               03113000
@NM00240 EQU   MCBVNTRY+7                                               03114000
MCBVND   EQU   MCBVNUM                                                  03115000
IOPBCEND EQU   IOPBPDS+21                                               03116000
IOPBFTB3 EQU   IOPBFTB0+2                                               03117000
IOPBFTB2 EQU   IOPBFTB0+1                                               03118000
@NM00184 EQU   IOPBFTB1                                                 03119000
IOPBAPFP EQU   IOPBFTB1                                                 03120000
IOPBSSI  EQU   IOPBFTB1                                                 03121000
IOPBPAGA EQU   IOPBFTB1                                                 03122000
@NM00183 EQU   IOPBFTB1                                                 03123000
IOPBAOSL EQU   IOPBFTB1                                                 03124000
IOPBSEPA EQU   IOPBPDS+15                                               03125000
IOPBFTBL EQU   IOPBPDS+13                                               03126000
IOPBSTOR EQU   IOPBPDS+10                                               03127000
IOPBREFR EQU   IOPBLEP2                                                 03128000
IOPBLEF  EQU   IOPBLEP2                                                 03129000
IOPBTEST EQU   IOPBLEP2                                                 03130000
IOPBNE   EQU   IOPBLEP2                                                 03131000
@NM00181 EQU   IOPBLEP2                                                 03132000
IOPBDC   EQU   IOPBLEP2                                                 03133000
@NM00180 EQU   IOPBLEP1                                                 03134000
IOPBSCTR EQU   IOPBLEP1                                                 03135000
IOPBOL   EQU   IOPBLEP1                                                 03136000
@NM00179 EQU   IOPBLEP1                                                 03137000
IOPBOVLY EQU   IOPBLEP1                                                 03138000
IOPBREUS EQU   IOPBLEP1                                                 03139000
IOPBRENT EQU   IOPBLEP1                                                 03140000
IOPBNL   EQU   IOPBPDS+7                                                03141000
IOPBTTRN EQU   IOPBPDS+4                                                03142000
IOPBZERO EQU   IOPBPDS+3                                                03143000
IOPBTTRT EQU   IOPBPDS                                                  03144000
IOPPTIND EQU   IOPPTNTR+8                                               03145000
IOPPTSND EQU   IOPPTREL                                                 03146000
@NM00177 EQU   IOPPTSFX+872                                             03147000
IOPSYZPP EQU   IOPPTSFX+772                                             03148000
IOPSYZPR EQU   IOPPTSFX+771                                             03149000
IOPSYZPS EQU   IOPPTSFX+763                                             03150000
IOPSYZAP EQU   IOPPTSFX+755                                             03151000
IOPSYUPP EQU   IOPPTSFX+655                                             03152000
IOPSYUPR EQU   IOPPTSFX+654                                             03153000
IOPSYUPS EQU   IOPPTSFX+646                                             03154000
IOPSYUPD EQU   IOPPTSFX+638                                             03155000
IOPSYSPP EQU   IOPPTSFX+538                                             03156000
IOPSYSPR EQU   IOPPTSFX+537                                             03157000
IOPSYSPS EQU   IOPPTSFX+529                                             03158000
IOPSYSUP EQU   IOPPTSFX+521                                             03159000
IOPSYLKP EQU   IOPPTSFX+421                                             03160000
IOPSYLKR EQU   IOPPTSFX+420                                             03161000
IOPSYLKS EQU   IOPPTSFX+412                                             03162000
IOPSYLKD EQU   IOPPTSFX+404                                             03163000
IOPSYCPP EQU   IOPPTSFX+304                                             03164000
IOPSYCPR EQU   IOPPTSFX+303                                             03165000
IOPSYCPS EQU   IOPPTSFX+295                                             03166000
IOPSYCPY EQU   IOPPTSFX+287                                             03167000
IOPSYCOP EQU   IOPPTSFX+187                                             03168000
IOPSYCOR EQU   IOPPTSFX+186                                             03169000
IOPSYCOS EQU   IOPPTSFX+178                                             03170000
IOPSYCOM EQU   IOPPTSFX+170                                             03171000
IOPSYASP EQU   IOPPTSFX+70                                              03172000
IOPSYASR EQU   IOPPTSFX+69                                              03173000
IOPSYASS EQU   IOPPTSFX+61                                              03174000
IOPSYASM EQU   IOPPTSFX+53                                              03175000
@NM00176 EQU   IOPPTSFX+35                                              03176000
@NM00175 EQU   IOPPTFG1                                                 03177000
IOPPTSNJ EQU   IOPPTFG1                                                 03178000
IOPPTSNP EQU   IOPPTFG1                                                 03179000
IOPSYPLN EQU   IOPPTSFX+32                                              03180000
IOPDSPFX EQU   IOPPTSFX+6                                               03181000
IOPDSDIR EQU   IOPDSSPC+4                                               03182000
IOPDSSEC EQU   IOPDSSPC+2                                               03183000
IOPDSPRM EQU   IOPDSSPC                                                 03184000
@NM00174 EQU   IOPPTSDR+4                                               03185000
IOPPTPEM EQU   IOPPTSDR+2                                               03186000
IOPPCNVL EQU   IOPPTSDR+1                                               03187000
@NM00173 EQU   IOPPTSDR                                                 03188000
IOPQFMTP EQU   IOPQFMLS+8                                               03189000
@NM00172 EQU   IOPQFMLS+7                                               03190000
IOPQFMND EQU   IOPQFMNM                                                 03191000
@NM00171 EQU   IOPQFMDR                                                 03192000
@NM00167 EQU   IOPQSMDR                                                 03193000
@NM00166 EQU   IOPSBYNT+8                                               03194000
IOPSBYST EQU   IOPSBYNT+7                                               03195000
IOPSBYNM EQU   IOPSBYNT                                                 03196000
@NM00165 EQU   IOPVERNT+8                                               03197000
IOPVERST EQU   IOPVERNT+7                                               03198000
IOPVERNM EQU   IOPVERNT                                                 03199000
@NM00164 EQU   IOPDELNT+8                                               03200000
IOPDELST EQU   IOPDELNT+7                                               03201000
IOPDELNM EQU   IOPDELNT                                                 03202000
@NM00163 EQU   IOPFIDNT+8                                               03203000
IOPFIDST EQU   IOPFIDNT+7                                               03204000
IOPFIDNM EQU   IOPFIDNT                                                 03205000
@NM00162 EQU   IOPIRQNT+8                                               03206000
IOPIRQST EQU   IOPIRQNT+7                                               03207000
IOPIRQNM EQU   IOPIRQNT                                                 03208000
@NM00161 EQU   IOPREQNT+8                                               03209000
IOPREQST EQU   IOPREQNT+7                                               03210000
IOPREQNM EQU   IOPREQNT                                                 03211000
@NM00160 EQU   IOPSUPNT+8                                               03212000
IOPSUPST EQU   IOPSUPNT+7                                               03213000
IOPSUPNM EQU   IOPSUPNT                                                 03214000
@NM00159 EQU   IOPNPRNT+8                                               03215000
IOPNPRST EQU   IOPNPRNT+7                                               03216000
IOPNPRNM EQU   IOPNPRNT                                                 03217000
@NM00158 EQU   IOPPRENT+8                                               03218000
IOPPREST EQU   IOPPRENT+7                                               03219000
IOPPRENM EQU   IOPPRENT                                                 03220000
@NM00157 EQU   IOPSRLNT+8                                               03221000
IOPSRLST EQU   IOPSRLNT+7                                               03222000
@NM00156 EQU   IOPSRLNT+4                                               03223000
IOPSRLNM EQU   IOPSRLNT                                                 03224000
@NM00155 EQU   IOPENTNT+8                                               03225000
IOPENTST EQU   IOPENTNT+7                                               03226000
IOPENTNM EQU   IOPENTNT                                                 03227000
IOPPIND  EQU   IOPPNTRY+8                                               03228000
IOPPTFND EQU   IOPPMODS                                                 03229000
IOPPFMID EQU   IOPPTFFX+73                                              03230000
@NM00154 EQU   IOPPTPFX+24                                              03231000
IOPUCLT  EQU   IOPDATES+21                                              03232000
IOPUCLD  EQU   IOPDATES+18                                              03233000
IOPACCT  EQU   IOPDATES+15                                              03234000
IOPACCD  EQU   IOPDATES+12                                              03235000
IOPRSTT  EQU   IOPDATES+9                                               03236000
IOPRSTD  EQU   IOPDATES+6                                               03237000
IOPAPPT  EQU   IOPDATES+3                                               03238000
IOPAPPD  EQU   IOPDATES                                                 03239000
IOPRECT  EQU   @NM00153+3                                               03240000
IOPRECD  EQU   @NM00153                                                 03241000
@NM00152 EQU   IOPPTFFX+8                                               03242000
@NM00151 EQU   @NM00149+7                                               03243000
IOPPRELN EQU   @NM00150                                                 03244000
@NM00148 EQU   IOPPTFDR+20                                              03245000
IOPSBYNO EQU   IOPPTFDR+13                                              03246000
IOPDBYNO EQU   IOPPTFDR+6                                               03247000
@NM00147 EQU   IOPPTFF3                                                 03248000
IOPFLF   EQU   IOPPTFF3                                                 03249000
IOPDBYP  EQU   IOPPTFF3                                                 03250000
IOPSBYP  EQU   IOPPTFF3                                                 03251000
IOPPMDLP EQU   IOPPTFF2+1                                               03252000
IOPPADDP EQU   IOPPTFF2+1                                               03253000
@NM00146 EQU   IOPPTFF2+1                                               03254000
IOPLRFP  EQU   IOPPTFF2                                                 03255000
IOPJCLP  EQU   IOPPTFF2                                                 03256000
IOPSUPP  EQU   IOPPTFF2                                                 03257000
IOPREQP  EQU   IOPPTFF2                                                 03258000
IOPPREP  EQU   IOPPTFF2                                                 03259000
IOPNPRP  EQU   IOPPTFF2                                                 03260000
IOPIRQP  EQU   IOPPTFF2                                                 03261000
IOPDELP  EQU   IOPPTFF2                                                 03262000
IOPREGEN EQU   IOPFLGS5                                                 03263000
IOPBYP   EQU   IOPFLGS5                                                 03264000
IOPDUMMP EQU   IOPFLGS5                                                 03265000
@NM00145 EQU   IOPFLGS5                                                 03266000
IOPERROR EQU   IOPFLGS5                                                 03267000
IOPACC   EQU   IOPFLGS5                                                 03268000
IOPRES   EQU   IOPFLGS5                                                 03269000
IOPAPP   EQU   IOPFLGS5                                                 03270000
IOPPTYPE EQU   IOPPTFDR+1                                               03271000
@NM00144 EQU   IOPPTFDR                                                 03272000
IOPSYSTP EQU   IOPSYSTR+8                                               03273000
IOPSYSND EQU   IOPSYNTR                                                 03274000
@NM00143 EQU   IOPSYSFX+21                                              03275000
IOPSYSID EQU   IOPSYSFX+13                                              03276000
IOPNUCID EQU   IOPSYSFX+12                                              03277000
IOPSREL  EQU   IOPSYSFX+8                                               03278000
@NM00142 EQU   @NM00140+7                                               03279000
@NM00141 EQU   @NM00140                                                 03280000
@NM00139 EQU   IOPSYSDR+5                                               03281000
@NM00138 EQU   IOPFLGS7                                                 03282000
IOPSYNG  EQU   IOPFLGS7                                                 03283000
IOPSYDL  EQU   IOPFLGS7                                                 03284000
IOPSTSNP EQU   IOPFLGS7                                                 03285000
IOPMTSNP EQU   IOPFLGS7                                                 03286000
IOPPEMAX EQU   IOPSYSDR+2                                               03287000
IOPSCNVL EQU   IOPSYSDR+1                                               03288000
@NM00137 EQU   IOPSYSDR                                                 03289000
@NM00136 EQU   IOPDLBFX+8                                               03290000
@NM00135 EQU   @NM00133+7                                               03291000
@NM00134 EQU   @NM00133                                                 03292000
@NM00132 EQU   IOPDLBDR+1                                               03293000
@NM00131 EQU   IOPDLBDR                                                 03294000
@NM00130 EQU   IOPMODST                                                 03295000
@NM00129 EQU   IOPMODFX+12                                              03296000
@NM00128 EQU   IOPMODF4                                                 03297000
@NM00127 EQU   IOPMODF3                                                 03298000
@NM00126 EQU   IOPMODF2                                                 03299000
IOPMPAGA EQU   IOPMODF2                                                 03300000
IOPMNE   EQU   IOPMODF2                                                 03301000
@NM00125 EQU   IOPMODF1                                                 03302000
IOPMDC   EQU   IOPMODF1                                                 03303000
IOPMREFR EQU   IOPMODF1                                                 03304000
IOPMOVLY EQU   IOPMODF1                                                 03305000
IOPMSCTR EQU   IOPMODF1                                                 03306000
IOPMREUS EQU   IOPMODF1                                                 03307000
IOPMRENT EQU   IOPMODF1                                                 03308000
IOPMAPF  EQU   IOPMODF1                                                 03309000
@NM00124 EQU   @NM00122+7                                               03310000
@NM00123 EQU   @NM00122                                                 03311000
@NM00121 EQU   IOPMODDR+17                                              03312000
@NM00120 EQU   @NM00118+7                                               03313000
@NM00119 EQU   @NM00118                                                 03314000
@NM00117 EQU   @NM00114                                                 03315000
@NM00116 EQU   @NM00114                                                 03316000
@NM00115 EQU   @NM00114                                                 03317000
@NM00113 EQU   @NM00112                                                 03318000
@NM00111 EQU   IOPMODDR                                                 03319000
IOPSRIND EQU   IOPSNTRY+8                                               03320000
@NM00110 EQU   IOPSRCST                                                 03321000
IOPSRCND EQU   IOPSRCID                                                 03322000
IOPSRDLB EQU   IOPSRCFX+72                                              03323000
IOPSRSYS EQU   IOPSRCFX+64                                              03324000
@NM00109 EQU   IOPSRCFX+8                                               03325000
@NM00108 EQU   @NM00106+7                                               03326000
@NM00107 EQU   @NM00106                                                 03327000
@NM00105 EQU   IOPSRCDR+18                                              03328000
IOPSRLNG EQU   IOPSRCDR+17                                              03329000
@NM00104 EQU   @NM00102+7                                               03330000
@NM00103 EQU   @NM00102                                                 03331000
@NM00101 EQU   @NM00098                                                 03332000
@NM00100 EQU   @NM00098                                                 03333000
@NM00099 EQU   @NM00098                                                 03334000
@NM00097 EQU   @NM00096                                                 03335000
@NM00095 EQU   IOPSRCDR                                                 03336000
IOPEOFND EQU   IOPEOFNT                                                 03337000
IOPMCTYP EQU   IOPMCIND                                                 03338000
@NM00094 EQU   IOPMACST                                                 03339000
IOPMACND EQU   IOPMACID                                                 03340000
IOPMCDLB EQU   IOPMACFX+72                                              03341000
IOPMCSYS EQU   IOPMACFX+64                                              03342000
@NM00093 EQU   IOPMACFX+8                                               03343000
@NM00092 EQU   IOPMACDR+18                                              03344000
IOPMCLNG EQU   IOPMACDR+17                                              03345000
@NM00091 EQU   IOPRMST                                                  03346000
IOPRMASM EQU   IOPRMST                                                  03347000
@NM00090 EQU   IOPRMST                                                  03348000
@NM00089 EQU   IOPMACDR                                                 03349000
@NM00087 EQU   @NM00085+7                                               03350000
@NM00086 EQU   @NM00085                                                 03351000
@NM00084 EQU   IOPLMDDR+6                                               03352000
@NM00083 EQU   IOPFLGS3                                                 03353000
IOPCHREP EQU   IOPFLGS3                                                 03354000
@NM00082 EQU   IOPLMDF4                                                 03355000
@NM00081 EQU   IOPLMDF3                                                 03356000
@NM00080 EQU   IOPLMDF2                                                 03357000
IOPPAGA  EQU   IOPLMDF2                                                 03358000
IOPNE    EQU   IOPLMDF2                                                 03359000
@NM00079 EQU   IOPFLGS2                                                 03360000
IOPDC    EQU   IOPFLGS2                                                 03361000
IOPREFR  EQU   IOPFLGS2                                                 03362000
IOPOVLY  EQU   IOPFLGS2                                                 03363000
IOPSCTR  EQU   IOPFLGS2                                                 03364000
IOPREUS  EQU   IOPFLGS2                                                 03365000
IOPRENT  EQU   IOPFLGS2                                                 03366000
IOPAPF   EQU   IOPFLGS2                                                 03367000
@NM00078 EQU   IOPLMDDR                                                 03368000
@NM00077 EQU   IOPASMDR+9                                               03369000
IOPABUTP EQU   IOPABUNT+7                                               03370000
IOPABUPT EQU   IOPABUNT                                                 03371000
IOPALLOC EQU   @NM00076+4                                               03372000
IOPUSED  EQU   @NM00076                                                 03373000
IOPTPSEQ EQU   @NM00075+8                                               03374000
IOPVLSER EQU   @NM00075+2                                               03375000
IOPBLKSI EQU   @NM00075                                                 03376000
IOPCQMAX EQU   IOPCQMAP+12                                              03377000
@NM00074 EQU   IOPCQMAP+11                                              03378000
@NM00073 EQU   IOPCQMAP+8                                               03379000
@NM00072 EQU   IOPCQMAP                                                 03380000
IOPPTMAX EQU   IOPCDMAX                                                 03381000
@NM00071 EQU   IOPSCMAP+11                                              03382000
@NM00070 EQU   IOPSCMAP+8                                               03383000
@NM00069 EQU   IOPSCMAP                                                 03384000
IOPDIRMX EQU   IOPNTMAX+12                                              03385000
@NM00068 EQU   IOPNTMAX+11                                              03386000
@NM00067 EQU   IOPNTMAX+8                                               03387000
@NM00066 EQU   IOPNTMAX                                                 03388000
@NM00065 EQU   IOPDTYPE                                                 03389000
IOPDMOD  EQU   IOPDTYPE                                                 03390000
IOPDJCL  EQU   IOPDTYPE                                                 03391000
IOPDSRC  EQU   IOPDTYPE                                                 03392000
IOPDMAC  EQU   IOPDTYPE                                                 03393000
IOPSDIR  EQU   IOPSPACE+4                                               03394000
IOPSSCND EQU   IOPSPACE+2                                               03395000
IOPSPRIM EQU   IOPSPACE                                                 03396000
IOPDSN   EQU   IOPDYNDT                                                 03397000
IOPISEQ3 EQU   IOPINAM3+6                                               03398000
IOPITYP3 EQU   @NM00064+5                                               03399000
IOPIPTF3 EQU   @NM00064                                                 03400000
TBLXEND0 EQU   TBLXPARM+124                                             03401000
@NM00007 EQU   TBLXPARM+108                                             03402000
TBLXIOP3 EQU   TBLXPARM+104                                             03403000
TBLXD2GT EQU   TBLXPARM+100                                             03404000
TBLXDLGT EQU   TBLXPARM+96                                              03405000
@NM00006 EQU   TBLXRC+3                                                 03406000
TBLXIRC  EQU   TBLXRC+2                                                 03407000
TBLXLRC  EQU   TBLXRC+1                                                 03408000
TBLXTRC  EQU   TBLXRC                                                   03409000
TBLXIBGN EQU   TBLXPARM+88                                              03410000
TBLXTSLP EQU   TBLXPARM+84                                              03411000
@NM00005 EQU   TBLXPARM+83                                              03412000
@NM00004 EQU   TBLXPARM+82                                              03413000
@NM00003 EQU   TBLXPARM+81                                              03414000
@NM00002 EQU   TBLXFLG1                                                 03415000
TBLXTCRC EQU   TBLXFLG1                                                 03416000
TBLXFUND EQU   TBLXPARM+72                                              03417000
TBLXFUNC EQU   TBLXPARM+64                                              03418000
@NM00001 EQU   TBLXPARM+62                                              03419000
TBLXCRQI EQU   TBLXPARM+61                                              03420000
TBLXCDSI EQU   TBLXPARM+60                                              03421000
TBLXSCGT EQU   TBLXPARM+52                                              03422000
TBLXSREL EQU   TBLXPARM+48                                              03423000
TBLXASGT EQU   TBLXPARM+44                                              03424000
TBLXIFGT EQU   TBLXPARM+40                                              03425000
TBLXTOP  EQU   TBLXPARM+32                                              03426000
TBLXSEGT EQU   TBLXPARM+24                                              03427000
TBLXIOPF EQU   TBLXPARM+20                                              03428000
TBLXIOP2 EQU   TBLXPARM+16                                              03429000
TBLXEND  EQU   TBLXINDX+8                                               03430000
TBLXSTRT EQU   TBLXINDX+4                                               03431000
TBLXCUR  EQU   TBLXINDX                                                 03432000
TBLXHDR  EQU   TBLXPARM                                                 03433000
@NM00254 EQU   HMASMGTP+27                                              03434000
GTPPSIZE EQU   GTPFLGS1                                                 03435000
@NM00253 EQU   GTPFLGS1                                                 03436000
GTPRCDNF EQU   GTPFLGS1                                                 03437000
GTPNOSPM EQU   GTPFLGS1                                                 03438000
GTPPOS   EQU   GTPRESTR+8                                               03439000
GTPRCD   EQU   GTPRESTR+4                                               03440000
GTPPAG   EQU   GTPRESTR                                                 03441000
GTPWKAD  EQU   HMASMGTP+8                                               03442000
GTPKEYLN EQU   HMASMGTP+6                                               03443000
GTPRCDLN EQU   HMASMGTP+4                                               03444000
@NM00252 EQU   HMASMGTP+2                                               03445000
@NM00248 EQU   MCBEFLG5                                                 03446000
MCBESTD  EQU   MCBEFLG5                                                 03447000
@NM00247 EQU   MCBEFLG4                                                 03448000
@NM00246 EQU   MCBEFLG3                                                 03449000
@NM00245 EQU   MCBEFLG2                                                 03450000
MCBEPAGA EQU   MCBEFLG2                                                 03451000
MCBENE   EQU   MCBEFLG2                                                 03452000
@NM00244 EQU   MCBEFLG1                                                 03453000
MCBEDC   EQU   MCBEFLG1                                                 03454000
MCBEREFR EQU   MCBEFLG1                                                 03455000
MCBEOVLY EQU   MCBEFLG1                                                 03456000
MCBESCTR EQU   MCBEFLG1                                                 03457000
MCBEREUS EQU   MCBEFLG1                                                 03458000
MCBERENT EQU   MCBEFLG1                                                 03459000
MCBEAPF  EQU   MCBEFLG1                                                 03460000
MCBERMID EQU   MCBELEMP+129                                             03461000
MCBELLKD EQU   MCBELEMP+128                                             03462000
MCBEJLKD EQU   MCBELEMP+116                                             03463000
MCBELUPI EQU   MCBELEMP+115                                             03464000
MCBEJUPI EQU   MCBELEMP+103                                             03465000
MCBELCPY EQU   MCBELEMP+102                                             03466000
MCBEJCPY EQU   MCBELEMP+90                                              03467000
MCBELASM EQU   MCBELEMP+89                                              03468000
MCBEJASM EQU   MCBELEMP+77                                              03469000
MCBESSI  EQU   MCBELEMP+65                                              03470000
MCBEASLB EQU   MCBELEMP+49                                              03471000
MCBESYS  EQU   MCBELEMP+25                                              03472000
MCBEDOBJ EQU   MCBELEMP+17                                              03473000
MCBENAME EQU   MCBELEMP+1                                               03474000
@NM00243 EQU   MCBELEMP                                                 03475000
MCBIFENV EQU   MCBIFMP+1                                                03476000
@NM00241 EQU   MCBIFMP                                                  03477000
MCBSFMID EQU   MCBVERMP+1                                               03478000
@NM00239 EQU   MCBVERMP                                                 03479000
MCBPTP   EQU   MCBPTFMP+10                                              03480000
MCBPRELN EQU   MCBPTFMP+8                                               03481000
MCBPNO   EQU   MCBPTFMP+1                                               03482000
ICTIXL   EQU   ICTIXLF                                                  03483000
@NM00238 EQU   ICTLMOD+38                                               03484000
ICTLTTR  EQU   ICTLMOD+31                                               03485000
ICTTG2   EQU   ICTLMOD+23                                               03486000
ICTTG1   EQU   ICTLMOD+15                                               03487000
@NM00237 EQU   ICTLFLG3                                                 03488000
ICTLZAP  EQU   ICTLFLG3                                                 03489000
ICTLLKD  EQU   ICTLFLG3                                                 03490000
ICTLCPY  EQU   ICTLFLG3                                                 03491000
ICTLXPND EQU   ICTLFLG3                                                 03492000
ICTTIND2 EQU   ICTLFLG3                                                 03493000
ICTTIND1 EQU   ICTLFLG3                                                 03494000
@NM00236 EQU   ICTLFLG2                                                 03495000
ICTLDEL  EQU   ICTLFLG2                                                 03496000
@NM00235 EQU   ICTLFLG2                                                 03497000
ICTLTDEL EQU   ICTLFLG2                                                 03498000
ICTLINK  EQU   ICTLFLG2                                                 03499000
ICTCOPY  EQU   ICTLFLG2                                                 03500000
@NM00234 EQU   ICTLFLG7                                                 03501000
@NM00233 EQU   ICTLFLG6                                                 03502000
@NM00232 EQU   ICTLFLG5                                                 03503000
ICTLPAGA EQU   ICTLFLG5                                                 03504000
ICTLNE   EQU   ICTLFLG5                                                 03505000
@NM00231 EQU   ICTLFLG1                                                 03506000
ICTLDC   EQU   ICTLFLG1                                                 03507000
ICTLREFR EQU   ICTLFLG1                                                 03508000
ICTLOVLY EQU   ICTLFLG1                                                 03509000
ICTLSCTR EQU   ICTLFLG1                                                 03510000
ICTLREUS EQU   ICTLFLG1                                                 03511000
ICTLRENT EQU   ICTLFLG1                                                 03512000
ICTLAPF  EQU   ICTLFLG1                                                 03513000
@NM00230 EQU   ICTLFLG4                                                 03514000
ICTLPASS EQU   ICTLFLG4                                                 03515000
ICTLDDCK EQU   ICTLFLG4                                                 03516000
ICTLMSG  EQU   ICTLFLG4                                                 03517000
ICTLCPL  EQU   ICTLFLG4                                                 03518000
ICTLNOGO EQU   ICTLFLG4                                                 03519000
ICTLPROC EQU   ICTLFLG4                                                 03520000
ICTLEND  EQU   ICTLNAME                                                 03521000
@NM00229 EQU   ICTMUMNT+7                                               03522000
ICTMUMND EQU   ICTMUMNM                                                 03523000
@NM00228 EQU   ICTMVRNT+7                                               03524000
ICTMVRND EQU   ICTMVRNM                                                 03525000
ICTTALND EQU   ICTTALNM                                                 03526000
ICTASMND EQU   ICTASMAD                                                 03527000
ICTMIDTY EQU   ICTMODST                                                 03528000
ICTMIDAM EQU   ICTMODST                                                 03529000
ICTMIDRG EQU   ICTMODST                                                 03530000
ICTMIDF1 EQU   ICTMODST                                                 03531000
ICTMIDPL EQU   ICTMODST                                                 03532000
ICTMIDPS EQU   ICTMODST                                                 03533000
@NM00227 EQU   ICTMODST                                                 03534000
ICTMIDND EQU   ICTMODID                                                 03535000
ICTIXM   EQU   ICTIXMF                                                  03536000
@NM00226 EQU   ICTMOD+128                                               03537000
@NM00225 EQU   ICTMOD+95                                                03538000
ICTMFMID EQU   ICTMOD+88                                                03539000
@NM00224 EQU   ICTMOD+87                                                03540000
ICTMRMID EQU   ICTMOD+80                                                03541000
ICTMSSI  EQU   ICTMOD+72                                                03542000
ICTMDOBJ EQU   ICTMOD+64                                                03543000
ICTMSYSL EQU   ICTMOD+56                                                03544000
ICTMASLB EQU   ICTMOD+40                                                03545000
ICTTOLIB EQU   ICTMOD+32                                                03546000
@NM00223 EQU   ICTMOD+21                                                03547000
ICTMLANG EQU   ICTMOD+20                                                03548000
@NM00222 EQU   ICTMOD+19                                                03549000
ICTMACF5 EQU   ICTMOD+18                                                03550000
ICTMZMPR EQU   ICTMACF4                                                 03551000
ICTMZOMZ EQU   ICTMACF4                                                 03552000
ICTMDOAS EQU   ICTMACF4                                                 03553000
ICTMXUPD EQU   ICTMACF4                                                 03554000
ICTMFXC  EQU   ICTMACF4                                                 03555000
ICTMFXBS EQU   ICTMACF4                                                 03556000
ICTMHASM EQU   ICTMACF4                                                 03557000
ICTMACDL EQU   ICTMACF4                                                 03558000
@NM00221 EQU   ICTMLEP4                                                 03559000
@NM00220 EQU   ICTMLEP3                                                 03560000
@NM00219 EQU   ICTMLEP2                                                 03561000
ICTMPAGA EQU   ICTMLEP2                                                 03562000
ICTMNE   EQU   ICTMLEP2                                                 03563000
@NM00218 EQU   ICTMLEP1                                                 03564000
ICTMDC   EQU   ICTMLEP1                                                 03565000
ICTMREFR EQU   ICTMLEP1                                                 03566000
ICTMOVLY EQU   ICTMLEP1                                                 03567000
ICTMSCTR EQU   ICTMLEP1                                                 03568000
ICTMREUS EQU   ICTMLEP1                                                 03569000
ICTMRENT EQU   ICTMLEP1                                                 03570000
ICTMAPF  EQU   ICTMLEP1                                                 03571000
@NM00217 EQU   ICTMFLG5                                                 03572000
ICTMNORL EQU   ICTMFLG5                                                 03573000
ICTMELCK EQU   ICTMFLG5                                                 03574000
ICTMCOPY EQU   ICTMFLG5                                                 03575000
ICTMPASS EQU   ICTMFLG5                                                 03576000
@NM00216 EQU   ICTMFLG4                                                 03577000
ICTMTSEL EQU   ICTMFLG4                                                 03578000
ICTMMIDE EQU   ICTMFLG4                                                 03579000
ICTMASOC EQU   ICTMFLG4                                                 03580000
ICTMSELM EQU   ICTMFLG4                                                 03581000
ICTMISEL EQU   ICTMFLG4                                                 03582000
@NM00215 EQU   ICTMFLG3                                                 03583000
ICTMWRK  EQU   ICTMFLG3                                                 03584000
ICTMTRX  EQU   ICTMFLG3                                                 03585000
ICTMSRCU EQU   ICTMFLG1                                                 03586000
ICTMSRCR EQU   ICTMFLG1                                                 03587000
ICTMMACU EQU   ICTMFLG1                                                 03588000
ICTMMACR EQU   ICTMFLG1                                                 03589000
ICTMXPND EQU   ICTMFLG1                                                 03590000
ICTMASM  EQU   ICTMMODR                                                 03591000
@NM00214 EQU   ICTMFLG2                                                 03592000
@NM00213 EQU   ICTMFLG2                                                 03593000
ICTMMIDU EQU   ICTMFLG2                                                 03594000
ICTMDEL  EQU   ICTMFLG2                                                 03595000
ICTMPROC EQU   ICTMFLG2                                                 03596000
@NM00212 EQU   ICTSBYNT+7                                               03597000
ICTSBYND EQU   ICTSBYNM                                                 03598000
ICTDELEX EQU   ICTDELST                                                 03599000
ICTDELND EQU   ICTDELNM                                                 03600000
@NM00211 EQU   ICTVRSNT+7                                               03601000
ICTVRSND EQU   ICTVRSNM                                                 03602000
@NM00210 EQU   ICTNPRNT+7                                               03603000
ICTNPRND EQU   ICTNPRNM                                                 03604000
@NM00209 EQU   ICTCSRST                                                 03605000
@NM00208 EQU   ICTCSRST                                                 03606000
ICTCSRF  EQU   ICTCSRST                                                 03607000
@NM00207 EQU   ICTCSRST                                                 03608000
ICTCSRNM EQU   ICTIRQNT+8                                               03609000
@NM00206 EQU   ICTIRQST                                                 03610000
ICTIREQT EQU   ICTIRQST                                                 03611000
ICTIREQI EQU   ICTIRQST                                                 03612000
ICTIREQB EQU   ICTIRQST                                                 03613000
ICTIREQS EQU   ICTIRQST                                                 03614000
@NM00205 EQU   ICTIRQST                                                 03615000
ICTIRQND EQU   ICTIRQNM                                                 03616000
@NM00204 EQU   ICTPREST                                                 03617000
ICTPREQT EQU   ICTPREST                                                 03618000
ICTPREQI EQU   ICTPREST                                                 03619000
ICTPREQB EQU   ICTPREST                                                 03620000
ICTPREQS EQU   ICTPREST                                                 03621000
@NM00203 EQU   ICTPREST                                                 03622000
ICTPREND EQU   ICTPRENM                                                 03623000
@NM00202 EQU   ICTSUPNT+7                                               03624000
ICTSUPND EQU   ICTSUPNM                                                 03625000
@NM00201 EQU   ICTREQST                                                 03626000
ICTRREQT EQU   ICTREQST                                                 03627000
ICTRREQI EQU   ICTREQST                                                 03628000
ICTRREQB EQU   ICTREQST                                                 03629000
ICTRREQS EQU   ICTREQST                                                 03630000
@NM00200 EQU   ICTREQST                                                 03631000
ICTREQND EQU   ICTREQNM                                                 03632000
@NM00199 EQU   ICTENTST                                                 03633000
ICTEREQT EQU   ICTENTST                                                 03634000
ICTEREQI EQU   ICTENTST                                                 03635000
ICTEREQB EQU   ICTENTST                                                 03636000
ICTEREQS EQU   ICTENTST                                                 03637000
@NM00198 EQU   ICTENTST                                                 03638000
ICTENTND EQU   ICTENTNM                                                 03639000
ICTIXP   EQU   ICTIXPF                                                  03640000
@NM00197 EQU   ICTPTF+100                                               03641000
ICTPTPFX EQU   ICTPTF+38                                                03642000
ICTPRELN EQU   ICTPTF+36                                                03643000
ICTPRECT EQU   ICTPTF+33                                                03644000
ICTPRECD EQU   ICTPTF+30                                                03645000
ICTPVERN EQU   ICTPTF+29                                                03646000
ICTPFMID EQU   ICTPTF+22                                                03647000
ICTPSUPN EQU   ICTPTF+20                                                03648000
ICTPONUM EQU   ICTPTF+18                                                03649000
ICTPTYPE EQU   ICTPTF+17                                                03650000
ICTPUSR8 EQU   ICTPFLGA                                                 03651000
ICTPUSR7 EQU   ICTPFLGA                                                 03652000
ICTPUSR6 EQU   ICTPFLGA                                                 03653000
ICTPUSR5 EQU   ICTPFLGA                                                 03654000
ICTPUSR4 EQU   ICTPFLGA                                                 03655000
ICTPUSR3 EQU   ICTPFLGA                                                 03656000
ICTPUSR2 EQU   ICTPFLGA                                                 03657000
ICTPPASS EQU   ICTPUSR1                                                 03658000
@NM00196 EQU   @NM00195                                                 03659000
ICTPRQBY EQU   @NM00195                                                 03660000
ICTPRQOK EQU   @NM00195                                                 03661000
ICTPRQCK EQU   @NM00195                                                 03662000
@NM00194 EQU   ICTPFLG9                                                 03663000
ICTPPDEL EQU   ICTPFLG9                                                 03664000
ICTPWRKO EQU   ICTPFLG9                                                 03665000
ICTPMSL  EQU   ICTPFLG9                                                 03666000
@NM00193 EQU   ICTPFLG8                                                 03667000
ICTPDCPL EQU   ICTPFLG8                                                 03668000
ICTPECPL EQU   ICTPFLG8                                                 03669000
ICTPGCPL EQU   ICTPFLG8                                                 03670000
@NM00192 EQU   ICTPFLG4                                                 03671000
@NM00191 EQU   ICTPFLG4                                                 03672000
@NM00190 EQU   ICTPFLG4                                                 03673000
ICTPGELM EQU   ICTPFLG4                                                 03674000
ICTPDIMP EQU   ICTPFLG4                                                 03675000
ICTPDEXP EQU   ICTPFLG4                                                 03676000
ICTPREDO EQU   ICTPFLG4                                                 03677000
ICTPCDSE EQU   ICTPFLG4                                                 03678000
@NM00189 EQU   ICTPFLG2                                                 03679000
ICTPRCND EQU   ICTPFLG2                                                 03680000
ICTPTPS  EQU   ICTPFLG2                                                 03681000
ICTPTR1  EQU   ICTPFLG2                                                 03682000
ICTPVRSP EQU   ICTPFLG2                                                 03683000
@NM00188 EQU   ICTPFLG6                                                 03684000
ICTFLF   EQU   ICTPFLF                                                  03685000
ICTPDBYP EQU   ICTPFLG6                                                 03686000
ICTPSBYP EQU   ICTPFLG6                                                 03687000
ICTPMDLP EQU   ICTPFLG5+1                                               03688000
ICTPADDP EQU   ICTPFLG5+1                                               03689000
@NM00187 EQU   ICTPFLG5+1                                               03690000
ICTPLRFP EQU   ICTPFLG5                                                 03691000
ICTPJCLP EQU   ICTPFLG5                                                 03692000
ICTPSUPP EQU   ICTPFLG5                                                 03693000
ICTPREQP EQU   ICTPFLG5                                                 03694000
ICTPPREP EQU   ICTPFLG5                                                 03695000
ICTPNPRP EQU   ICTPFLG5                                                 03696000
ICTPIRQP EQU   ICTPFLG5                                                 03697000
ICTPDELP EQU   ICTPFLG5                                                 03698000
@NM00186 EQU   ICTPFLG3                                                 03699000
ICTPSLST EQU   ICTPFLG3                                                 03700000
ICTPNOLB EQU   ICTPFLG3                                                 03701000
ICTPVERJ EQU   ICTPFLG3                                                 03702000
ICTPMSG  EQU   ICTPFLG3                                                 03703000
ICTPCPL  EQU   ICTPFLG3                                                 03704000
ICTPNOGO EQU   ICTPFLG3                                                 03705000
ICTPROCS EQU   ICTPPROC                                                 03706000
ICTREGEN EQU   ICTPFLG1                                                 03707000
ICTBYP   EQU   ICTPFLG1                                                 03708000
ICTDUMMP EQU   ICTPFLG1                                                 03709000
@NM00185 EQU   ICTPFLG1                                                 03710000
ICTERROR EQU   ICTPFLG1                                                 03711000
ICTACC   EQU   ICTPFLG1                                                 03712000
ICTRES   EQU   ICTPFLG1                                                 03713000
ICTAPP   EQU   ICTPFLG1                                                 03714000
ICTPEND  EQU   ICTPTFS                                                  03715000
ICTLEN   EQU   ICTGMSPL+1                                               03716000
ICTSP    EQU   ICTGMSPL                                                 03717000
ICTLLEN  EQU   ICTLSPLN+1                                               03718000
ICTLSP   EQU   ICTLSPLN                                                 03719000
ICTMLEN  EQU   ICTMSPLN+1                                               03720000
ICTMSP   EQU   ICTMSPLN                                                 03721000
ICTPLEN  EQU   ICTPSPLN+1                                               03722000
ICTPSP   EQU   ICTPSPLN                                                 03723000
IOPBS04E EQU   IOPBS04+2                                                03724000
IOPBAPFC EQU   IOPBAPF+1                                                03725000
IOPBAPFL EQU   IOPBAPF                                                  03726000
IOPBS2NM EQU   IOPBS02+3                                                03727000
IOPBS2EP EQU   IOPBS02                                                  03728000
IOPQSMTP EQU   IOPQSMLS+8                                               03729000
@NM00170 EQU   IOPQSMLS+7                                               03730000
IOPQSMND EQU   IOPQSMNM                                                 03731000
@NM00169 EQU   @NM00168+7                                               03732000
IOPQSMFM EQU   @NM00168                                                 03733000
@NM00088 EQU   IOPLMCTL+17                                              03734000
IOPLMCRD EQU   IOPLMCTL+9                                               03735000
IOPLMCRN EQU   IOPLMCTL+1                                               03736000
IOPLMCC  EQU   IOPLMCTL                                                 03737000
@NM00063 EQU   IOPUSERL                                                 03738000
@NM00062 EQU   IOPUSERL                                                 03739000
IOPALIS  EQU   IOPUSERL                                                 03740000
IOPTTR   EQU   IOPDRMAP+8                                               03741000
IOPINAM2 EQU   IOPINAM+1                                                03742000
IOPITYP2 EQU   IOPITYP                                                  03743000
@NM00061 EQU   HMASMIOP+32                                              03744000
IOPDELDD EQU   IOPDDNAM                                                 03745000
@NM00060 EQU   @NM00057+10                                              03746000
IOPSEQNO EQU   @NM00057+8                                               03747000
@NM00059 EQU   @NM00058+7                                               03748000
IOPPTFNM EQU   @NM00058                                                 03749000
IOPNAM17 EQU   IOPNAME                                                  03750000
CCABMREC EQU   CCABELMT+10                                              03751000
CCABPOS  EQU   CCABMPOS+8                                               03752000
CCABNAME EQU   CCABMPOS                                                 03753000
@NM00056 EQU   CCABLDLM+2                                               03754000
@NM00055 EQU   CCABLDLM                                                 03755000
CCAUPDPM EQU   @NM00053+24                                              03756000
@NM00054 EQU   @NM00053+21                                              03757000
CCARUPDT EQU   CCAUPDRC                                                 03758000
CCAUPDSP EQU   @NM00053+12                                              03759000
CCAUPDTE EQU   @NM00053+8                                               03760000
CCAUPDNM EQU   @NM00053                                                 03761000
CCASUPPM EQU   @NM00051+24                                              03762000
@NM00052 EQU   @NM00051+21                                              03763000
CCARSUP  EQU   CCASUPRC                                                 03764000
CCASUPSP EQU   @NM00051+12                                              03765000
CCAIOSUP EQU   @NM00051+8                                               03766000
CCASUPNM EQU   @NM00051                                                 03767000
CCAZAPPM EQU   @NM00049+24                                              03768000
@NM00050 EQU   @NM00049+21                                              03769000
CCARZAP  EQU   CCAZAPRC                                                 03770000
CCAZAPSP EQU   @NM00049+12                                              03771000
CCASPZAP EQU   @NM00049+8                                               03772000
CCAZAPNM EQU   @NM00049                                                 03773000
CCACOMPM EQU   @NM00047+24                                              03774000
@NM00048 EQU   @NM00047+21                                              03775000
CCARCOMP EQU   CCACOMRC                                                 03776000
CCACOMSP EQU   @NM00047+12                                              03777000
CCACOMRS EQU   @NM00047+8                                               03778000
CCACOMNM EQU   @NM00047                                                 03779000
CCACPYPM EQU   @NM00045+24                                              03780000
@NM00046 EQU   @NM00045+21                                              03781000
CCARCOPY EQU   CCACPYRC                                                 03782000
CCACPYSP EQU   @NM00045+12                                              03783000
CCACOPY  EQU   @NM00045+8                                               03784000
CCACPYNM EQU   @NM00045                                                 03785000
CCAASMPM EQU   @NM00043+24                                              03786000
@NM00044 EQU   @NM00043+21                                              03787000
CCARASM  EQU   CCAASMRC                                                 03788000
CCAASMSP EQU   @NM00043+12                                              03789000
CCAASM   EQU   @NM00043+8                                               03790000
CCAASMNM EQU   @NM00043                                                 03791000
CCALKDPM EQU   @NM00041+24                                              03792000
@NM00042 EQU   @NM00041+21                                              03793000
CCARLINK EQU   CCALKDRC                                                 03794000
CCALKDSP EQU   @NM00041+12                                              03795000
CCALKED  EQU   @NM00041+8                                               03796000
CCALKDNM EQU   @NM00041                                                 03797000
CCAPGMPM EQU   @NM00039+24                                              03798000
@NM00040 EQU   @NM00039+21                                              03799000
CCABPGRC EQU   @NM00039+20                                              03800000
CCABPGSP EQU   @NM00039+12                                              03801000
CCABPGAD EQU   @NM00039+8                                               03802000
CCABPGNM EQU   @NM00039                                                 03803000
CCAEND   EQU   HMASMCCA+371                                             03804000
@NM00038 EQU   HMASMCCA+309                                             03805000
CCACURDD EQU   CCAFDSNG+3                                               03806000
CCACURDS EQU   CCAFDSNG+2                                               03807000
@NM00037 EQU   CCAFLAGB                                                 03808000
CCAOUTNG EQU   CCAFLAGB                                                 03809000
CCALOGNG EQU   CCAFLAGB                                                 03810000
CCAFMID  EQU   HMASMCCA+291                                             03811000
CCALSTDS EQU   CCAFCTL+8                                                03812000
CCARPTDS EQU   CCAFCTL+7                                                03813000
CCATIME  EQU   CCAFCTL+4                                                03814000
CCADATE  EQU   CCAFCTL+1                                                03815000
@NM00036 EQU   CCAFLAG9                                                 03816000
CCARVCAN EQU   CCAFLAG9                                                 03817000
CCARVEST EQU   CCAFLAG9                                                 03818000
CCAPTSNJ EQU   CCAFLAG9                                                 03819000
CCASTSNP EQU   CCAFLAG9                                                 03820000
CCAMTSNP EQU   CCAFLAG9                                                 03821000
CCAPTSNP EQU   CCAFLAG9                                                 03822000
@NM00035 EQU   CCAFLAG8                                                 03823000
CCAACDSC EQU   CCAFLAG8                                                 03824000
CCACDSC  EQU   CCAFLAG8                                                 03825000
@NM00034 EQU   CCAFLAG6                                                 03826000
CCAACRUP EQU   CCAFLAG6                                                 03827000
CCACRQUP EQU   CCAFLAG6                                                 03828000
CCAACDUP EQU   CCAFLAG6                                                 03829000
CCACDSUP EQU   CCAFLAG6                                                 03830000
@NM00033 EQU   CCAFLAG5                                                 03831000
CCAACROS EQU   CCAFLAG5                                                 03832000
CCACRQOS EQU   CCAFLAG5                                                 03833000
CCAACDOS EQU   CCAFLAG5                                                 03834000
CCACDSOS EQU   CCAFLAG5                                                 03835000
@NM00032 EQU   CCAFLAG4                                                 03836000
CCAACRIS EQU   CCAFLAG4                                                 03837000
CCACRQIS EQU   CCAFLAG4                                                 03838000
CCAACDIS EQU   CCAFLAG4                                                 03839000
CCACDSIS EQU   CCAFLAG4                                                 03840000
@NM00031 EQU   CCAFLAG3+1                                               03841000
CCARGNP  EQU   CCAFLAG3+1                                               03842000
CCADISRQ EQU   CCAFLAG3+1                                               03843000
CCAICTOK EQU   CCAFLAG3                                                 03844000
CCADELP  EQU   CCAFLAG3                                                 03845000
CCACMPRS EQU   CCAFLAG3                                                 03846000
CCAZAPP  EQU   CCAFLAG3                                                 03847000
CCALINKP EQU   CCAFLAG3                                                 03848000
CCACOPYP EQU   CCAFLAG3                                                 03849000
CCAASIP  EQU   CCAFLAG3                                                 03850000
CCAUPDP  EQU   CCAFLAG3                                                 03851000
CCAEOSMP EQU   CCAFLAG2                                                 03852000
CCAEOFNC EQU   CCAFLAG2                                                 03853000
@NM00030 EQU   CCAFLAG2                                                 03854000
CCACHECK EQU   CCAFLAG2                                                 03855000
CCATERM  EQU   CCAFLAG2                                                 03856000
CCASVCLB EQU   CCAFLAG2                                                 03857000
CCANCPTF EQU   CCAFLAG2                                                 03858000
@NM00029 EQU   CCAFLAG1+1                                               03859000
CCAUNL   EQU   CCAFLAG1+1                                               03860000
CCARESET EQU   CCAFLAG1+1                                               03861000
CCALOG   EQU   CCAFLAG1+1                                               03862000
CCACNV   EQU   CCAFLAG1+1                                               03863000
CCALIST  EQU   CCAFLAG1                                                 03864000
CCAUPDU  EQU   CCAFLAG1                                                 03865000
CCAUPDJ  EQU   CCAFLAG1                                                 03866000
CCAREJ   EQU   CCAFLAG1                                                 03867000
CCAREC   EQU   CCAFLAG1                                                 03868000
CCAFUNCT EQU   CCAFFUNC                                                 03869000
@NM00028 EQU   @NM00023+18                                              03870000
@NM00027 EQU   @NM00023+16                                              03871000
CCATBLPA EQU   @NM00023+12                                              03872000
@NM00026 EQU   @NM00023+8                                               03873000
@NM00025 EQU   @NM00023+4                                               03874000
@NM00024 EQU   @NM00023                                                 03875000
CCAIFGTP EQU   CCAFGTP+16                                               03876000
CCAGTP3  EQU   CCAFGTP+12                                               03877000
CCAGTP2  EQU   CCAFGTP+8                                                03878000
CCAGTP1  EQU   CCAFGTP+4                                                03879000
CCASETAD EQU   CCASEGTP                                                 03880000
CCACLST  EQU   CCAFPGM+12                                               03881000
CCASPDCB EQU   CCAFPGM+8                                                03882000
CCARVAD  EQU   CCAFSTA                                                  03883000
CCAACDID EQU   CCAFSYS+32                                               03884000
CCACDSID EQU   CCAFSYS+24                                               03885000
CCALNLEN EQU   CCAFSYS+22                                               03886000
@NM00022 EQU   CCAFLAGA                                                 03887000
CCAPSYSF EQU   CCAFLAGA                                                 03888000
CCAASYSF EQU   CCAFLAGA                                                 03889000
CCACSYSF EQU   CCAFLAGA                                                 03890000
CCANUCID EQU   CCAFSYS+20                                               03891000
CCAASREL EQU   CCAFSYS+16                                               03892000
CCACSREL EQU   CCASREL                                                  03893000
CCAPGLEN EQU   CCAFSYS+8                                                03894000
CCAIOPAS EQU   CCAFSYS+4                                                03895000
CCAIOPCS EQU   CCAFSYS                                                  03896000
CCAPESIZ EQU   CCAFIOP+4                                                03897000
@NM00021 EQU   CCAFLAG7+3                                               03898000
CCALOGP  EQU   CCAFLAG7+2                                               03899000
CCAOUTP  EQU   CCAFLAG7+2                                               03900000
CCASLBP  EQU   CCAFLAG7+2                                               03901000
CCARPTP  EQU   CCAFLAG7+2                                               03902000
CCALISTP EQU   CCAFLAG7+2                                               03903000
CCAJCLP  EQU   CCAFLAG7+2                                               03904000
CCAPTFP  EQU   CCAFLAG7+2                                               03905000
CCATLBP  EQU   CCAFLAG7+2                                               03906000
CCAUT3P  EQU   CCAFLAG7+1                                               03907000
CCAUT2P  EQU   CCAFLAG7+1                                               03908000
CCAUT1P  EQU   CCAFLAG7+1                                               03909000
CCAWK5P  EQU   CCAFLAG7+1                                               03910000
CCAWK4P  EQU   CCAFLAG7+1                                               03911000
CCAWK3P  EQU   CCAFLAG7+1                                               03912000
CCAWK2P  EQU   CCAFLAG7+1                                               03913000
CCAWK1P  EQU   CCAFLAG7+1                                               03914000
CCAACRQP EQU   CCAFLAG7                                                 03915000
CCACRQP  EQU   CCAFLAG7                                                 03916000
CCASTSP  EQU   CCAFLAG7                                                 03917000
CCAMTSP  EQU   CCAFLAG7                                                 03918000
CCAPTSP  EQU   CCAFLAG7                                                 03919000
CCASCDSP EQU   CCAFLAG7                                                 03920000
CCAACDSP EQU   CCAFLAG7                                                 03921000
CCACDSP  EQU   CCAFLAG7                                                 03922000
@NM00020 EQU   CCAFBUFR+122                                             03923000
@NM00019 EQU   CCAFBUFR+120                                             03924000
@NM00018 EQU   CCAFBUFR+118                                             03925000
CCATBFMX EQU   CCAFBUFR+116                                             03926000
CCA4BFMX EQU   CCAFBUFR+114                                             03927000
CCA3BFMX EQU   CCAFBUFR+112                                             03928000
CCA2BFMX EQU   CCAFBUFR+110                                             03929000
CCA1BFMX EQU   CCAFBUFR+108                                             03930000
CCAXBFMX EQU   CCAFBUFR+106                                             03931000
CCAQBFMX EQU   CCAFBUFR+104                                             03932000
CCASBFMX EQU   CCAFBUFR+102                                             03933000
CCAMBFMX EQU   CCAFBUFR+100                                             03934000
CCAPBFMX EQU   CCAFBUFR+98                                              03935000
CCAVBFMX EQU   CCAFBUFR+96                                              03936000
CCAABFMX EQU   CCAFBUFR+94                                              03937000
CCACBFMX EQU   CCAFBUFR+92                                              03938000
@NM00017 EQU   CCAFBUFR+88                                              03939000
@NM00016 EQU   CCAFBUFR+84                                              03940000
CCA4BFSZ EQU   CCAFBUFR+80                                              03941000
CCATBFSZ EQU   CCAFBUFR+76                                              03942000
CCAWBFSZ EQU   CCAFBUFR+72                                              03943000
CCAQBFSZ EQU   CCAFBUFR+68                                              03944000
CCAPBFSZ EQU   CCAFBUFR+64                                              03945000
CCAVBFSZ EQU   CCAFBUFR+60                                              03946000
CCACBFSZ EQU   CCAFBUFR+56                                              03947000
@NM00015 EQU   CCAFBUFR+52                                              03948000
CCA4BFOA EQU   CCAFBUFR+48                                              03949000
CCA4BFIA EQU   CCAFBUFR+44                                              03950000
CCATBFIA EQU   CCAFBUFR+40                                              03951000
CCAWBFOA EQU   CCAFBUFR+36                                              03952000
CCAWBFIA EQU   CCAFBUFR+32                                              03953000
CCAQBFOA EQU   CCAFBUFR+28                                              03954000
CCAQBFIA EQU   CCAFBUFR+24                                              03955000
CCAPBFOA EQU   CCAFBUFR+20                                              03956000
CCAPBFIA EQU   CCAFBUFR+16                                              03957000
CCAVBFOA EQU   CCAFBUFR+12                                              03958000
CCAVBFIA EQU   CCAFBUFR+8                                               03959000
CCACBFOA EQU   CCAFBUFR+4                                               03960000
CCACBFIA EQU   CCAFBUFR                                                 03961000
CCAID    EQU   HMASMCCA                                                 03962000
@NM00014 EQU   TBLFLG5                                                  03963000
TBLICTOK EQU   TBLFLG5                                                  03964000
@NM00013 EQU   TBLFLG4                                                  03965000
TBLBPFM  EQU   TBLFLG4                                                  03966000
@NM00012 EQU   TBLFLG4                                                  03967000
TBLBPIRQ EQU   TBLFLG4                                                  03968000
TBLBPREQ EQU   TBLFLG4                                                  03969000
TBLBPPRE EQU   TBLFLG4                                                  03970000
TBLBPID  EQU   TBLFLG4                                                  03971000
@NM00011 EQU   TBLFLG3+1                                                03972000
TBLSTS   EQU   TBLFLG3                                                  03973000
TBLMTS   EQU   TBLFLG3                                                  03974000
TBLPTS   EQU   TBLFLG3                                                  03975000
TBLACRQ  EQU   TBLFLG3                                                  03976000
TBLCRQ   EQU   TBLFLG3                                                  03977000
TBLSCDS  EQU   TBLFLG3                                                  03978000
TBLACDS  EQU   TBLFLG3                                                  03979000
TBLCDS   EQU   TBLFLG3                                                  03980000
TBLMASS  EQU   TBLFLG2                                                  03981000
@NM00010 EQU   TBLFLG2                                                  03982000
TBLFMID  EQU   TBLFLG2                                                  03983000
TBLGROUP EQU   TBLFLG2                                                  03984000
TBLEXC   EQU   TBLFLG2                                                  03985000
TBLSEL   EQU   TBLFLG2                                                  03986000
@NM00009 EQU   TBLFLG1+1                                                03987000
TBLDISW  EQU   TBLFLG1+1                                                03988000
TBLDISR  EQU   TBLFLG1+1                                                03989000
TBLDISN  EQU   TBLFLG1+1                                                03990000
TBLNOJCL EQU   TBLFLG1                                                  03991000
TBLFLUSH EQU   TBLFLG1                                                  03992000
TBLUSER  EQU   TBLFLG1                                                  03993000
TBLAPAR  EQU   TBLFLG1                                                  03994000
TBLCOMP  EQU   TBLFLG1                                                  03995000
TBLASSEM EQU   TBLFLG1                                                  03996000
TBLCHECK EQU   TBLFLG1                                                  03997000
@NM00008 EQU   TBLXOPTS+5                                               03998000
TBLNUCID EQU   TBLXOPTS+4                                               03999000
TBLJCLGT EQU   TBLXOPTS                                                 04000000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      04001000
@RF00308 EQU   @EL00002                                                 04002000
@RT00319 EQU   @EL00003                                                 04003000
@RF00381 EQU   @EL00003                                                 04004000
@RF00400 EQU   @EL00004                                                 04005000
@RF00414 EQU   @EL00005                                                 04006000
@RF00433 EQU   @EL00006                                                 04007000
@RF00475 EQU   @RC00467                                                 04008000
@RF00488 EQU   @EL00007                                                 04009000
@RF00513 EQU   @RC00507                                                 04010000
@RC00515 EQU   @RC00507                                                 04011000
@RF00591 EQU   @EL00008                                                 04012000
@RF00623 EQU   @EL00009                                                 04013000
@RF00662 EQU   @EL00010                                                 04014000
@ENDDATA EQU   *                                                        04015000
         END   HMASMTM1,(C'PLS2155',0802,78334)                         04016000
